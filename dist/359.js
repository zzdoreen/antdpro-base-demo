var i0=Math.pow;(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[359],{67154:function(Xt){function Nt(){return Xt.exports=Nt=Object.assign?Object.assign.bind():function(pt){for(var ut=1;ut<arguments.length;ut++){var le=arguments[ut];for(var Ze in le)Object.prototype.hasOwnProperty.call(le,Ze)&&(pt[Ze]=le[Ze])}return pt},Xt.exports.__esModule=!0,Xt.exports.default=Xt.exports,Nt.apply(this,arguments)}Xt.exports=Nt,Xt.exports.__esModule=!0,Xt.exports.default=Xt.exports},74020:function(Xt,Nt,pt){var ut=pt(34155);(function(Ze,Ee){Xt.exports=Ee()})(self,function(){return function(){var le={"./node_modules/es6-promise/dist/es6-promise.js":function(Le,ve,re){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */(function(ie,J){Le.exports=J()})(this,function(){"use strict";function ie(Ye){var De=typeof Ye;return Ye!==null&&(De==="object"||De==="function")}function J(Ye){return typeof Ye=="function"}var D=void 0;Array.isArray?D=Array.isArray:D=function(De){return Object.prototype.toString.call(De)==="[object Array]"};var v=D,$=0,I=void 0,H=void 0,X=function(De,yt){Ae[$]=De,Ae[$+1]=yt,$+=2,$===2&&(H?H(Re):we())};function O(Ye){H=Ye}function G(Ye){X=Ye}var j=typeof window!="undefined"?window:void 0,V=j||{},S=V.MutationObserver||V.WebKitMutationObserver,ee=typeof self=="undefined"&&typeof ut!="undefined"&&{}.toString.call(ut)==="[object process]",se=typeof Uint8ClampedArray!="undefined"&&typeof importScripts!="undefined"&&typeof MessageChannel!="undefined";function ue(){return function(){return ut.nextTick(Re)}}function U(){return typeof I!="undefined"?function(){I(Re)}:fe()}function Y(){var Ye=0,De=new S(Re),yt=document.createTextNode("");return De.observe(yt,{characterData:!0}),function(){yt.data=Ye=++Ye%2}}function ae(){var Ye=new MessageChannel;return Ye.port1.onmessage=Re,function(){return Ye.port2.postMessage(0)}}function fe(){var Ye=setTimeout;return function(){return Ye(Re,1)}}var Ae=new Array(1e3);function Re(){for(var Ye=0;Ye<$;Ye+=2){var De=Ae[Ye],yt=Ae[Ye+1];De(yt),Ae[Ye]=void 0,Ae[Ye+1]=void 0}$=0}function Ce(){try{var Ye=Function("return this")().require("vertx");return I=Ye.runOnLoop||Ye.runOnContext,U()}catch(De){return fe()}}var we=void 0;ee?we=ue():S?we=Y():se?we=ae():j===void 0?we=Ce():we=fe();function Fe(Ye,De){var yt=this,Ct=new this.constructor(Oe);Ct[$e]===void 0&&ln(Ct);var wt=yt._state;if(wt){var Dt=arguments[wt-1];X(function(){return zi(wt,Ct,Dt,yt._result)})}else oi(yt,Ct,Ye,De);return Ct}function Ie(Ye){var De=this;if(Ye&&typeof Ye=="object"&&Ye.constructor===De)return Ye;var yt=new De(Oe);return ei(yt,Ye),yt}var $e=Math.random().toString(36).substring(2);function Oe(){}var ht=void 0,kt=1,Rt=2;function mt(){return new TypeError("You cannot resolve a promise with itself")}function rt(){return new TypeError("A promises callback cannot return that same promise.")}function Kt(Ye,De,yt,Ct){try{Ye.call(De,yt,Ct)}catch(wt){return wt}}function _t(Ye,De,yt){X(function(Ct){var wt=!1,Dt=Kt(yt,De,function(Ni){wt||(wt=!0,De!==Ni?ei(Ct,Ni):vi(Ct,Ni))},function(Ni){wt||(wt=!0,Et(Ct,Ni))},"Settle: "+(Ct._label||" unknown promise"));!wt&&Dt&&(wt=!0,Et(Ct,Dt))},Ye)}function Gt(Ye,De){De._state===kt?vi(Ye,De._result):De._state===Rt?Et(Ye,De._result):oi(De,void 0,function(yt){return ei(Ye,yt)},function(yt){return Et(Ye,yt)})}function li(Ye,De,yt){De.constructor===Ye.constructor&&yt===Fe&&De.constructor.resolve===Ie?Gt(Ye,De):yt===void 0?vi(Ye,De):J(yt)?_t(Ye,De,yt):vi(Ye,De)}function ei(Ye,De){if(Ye===De)Et(Ye,mt());else if(ie(De)){var yt=void 0;try{yt=De.then}catch(Ct){Et(Ye,Ct);return}li(Ye,De,yt)}else vi(Ye,De)}function Ti(Ye){Ye._onerror&&Ye._onerror(Ye._result),ai(Ye)}function vi(Ye,De){Ye._state===ht&&(Ye._result=De,Ye._state=kt,Ye._subscribers.length!==0&&X(ai,Ye))}function Et(Ye,De){Ye._state===ht&&(Ye._state=Rt,Ye._result=De,X(Ti,Ye))}function oi(Ye,De,yt,Ct){var wt=Ye._subscribers,Dt=wt.length;Ye._onerror=null,wt[Dt]=De,wt[Dt+kt]=yt,wt[Dt+Rt]=Ct,Dt===0&&Ye._state&&X(ai,Ye)}function ai(Ye){var De=Ye._subscribers,yt=Ye._state;if(De.length!==0){for(var Ct=void 0,wt=void 0,Dt=Ye._result,Ni=0;Ni<De.length;Ni+=3)Ct=De[Ni],wt=De[Ni+yt],Ct?zi(yt,Ct,wt,Dt):wt(Dt);Ye._subscribers.length=0}}function zi(Ye,De,yt,Ct){var wt=J(yt),Dt=void 0,Ni=void 0,fi=!0;if(wt){try{Dt=yt(Ct)}catch(Dn){fi=!1,Ni=Dn}if(De===Dt){Et(De,rt());return}}else Dt=Ct;De._state!==ht||(wt&&fi?ei(De,Dt):fi===!1?Et(De,Ni):Ye===kt?vi(De,Dt):Ye===Rt&&Et(De,Dt))}function mn(Ye,De){try{De(function(Ct){ei(Ye,Ct)},function(Ct){Et(Ye,Ct)})}catch(yt){Et(Ye,yt)}}var Gi=0;function en(){return Gi++}function ln(Ye){Ye[$e]=Gi++,Ye._state=void 0,Ye._result=void 0,Ye._subscribers=[]}function gt(){return new Error("Array Methods must be provided an Array")}var Ai=function(){function Ye(De,yt){this._instanceConstructor=De,this.promise=new De(Oe),this.promise[$e]||ln(this.promise),v(yt)?(this.length=yt.length,this._remaining=yt.length,this._result=new Array(this.length),this.length===0?vi(this.promise,this._result):(this.length=this.length||0,this._enumerate(yt),this._remaining===0&&vi(this.promise,this._result))):Et(this.promise,gt())}return Ye.prototype._enumerate=function(yt){for(var Ct=0;this._state===ht&&Ct<yt.length;Ct++)this._eachEntry(yt[Ct],Ct)},Ye.prototype._eachEntry=function(yt,Ct){var wt=this._instanceConstructor,Dt=wt.resolve;if(Dt===Ie){var Ni=void 0,fi=void 0,Dn=!1;try{Ni=yt.then}catch(Xn){Dn=!0,fi=Xn}if(Ni===Fe&&yt._state!==ht)this._settledAt(yt._state,Ct,yt._result);else if(typeof Ni!="function")this._remaining--,this._result[Ct]=yt;else if(wt===rn){var Ut=new wt(Oe);Dn?Et(Ut,fi):li(Ut,yt,Ni),this._willSettleAt(Ut,Ct)}else this._willSettleAt(new wt(function(Xn){return Xn(yt)}),Ct)}else this._willSettleAt(Dt(yt),Ct)},Ye.prototype._settledAt=function(yt,Ct,wt){var Dt=this.promise;Dt._state===ht&&(this._remaining--,yt===Rt?Et(Dt,wt):this._result[Ct]=wt),this._remaining===0&&vi(Dt,this._result)},Ye.prototype._willSettleAt=function(yt,Ct){var wt=this;oi(yt,void 0,function(Dt){return wt._settledAt(kt,Ct,Dt)},function(Dt){return wt._settledAt(Rt,Ct,Dt)})},Ye}();function ki(Ye){return new Ai(this,Ye).promise}function ui(Ye){var De=this;return v(Ye)?new De(function(yt,Ct){for(var wt=Ye.length,Dt=0;Dt<wt;Dt++)De.resolve(Ye[Dt]).then(yt,Ct)}):new De(function(yt,Ct){return Ct(new TypeError("You must pass an array to race."))})}function Ln(Ye){var De=this,yt=new De(Oe);return Et(yt,Ye),yt}function Kr(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function Is(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var rn=function(){function Ye(De){this[$e]=en(),this._result=this._state=void 0,this._subscribers=[],Oe!==De&&(typeof De!="function"&&Kr(),this instanceof Ye?mn(this,De):Is())}return Ye.prototype.catch=function(yt){return this.then(null,yt)},Ye.prototype.finally=function(yt){var Ct=this,wt=Ct.constructor;return J(yt)?Ct.then(function(Dt){return wt.resolve(yt()).then(function(){return Dt})},function(Dt){return wt.resolve(yt()).then(function(){throw Dt})}):Ct.then(yt,yt)},Ye}();rn.prototype.then=Fe,rn.all=ki,rn.race=ui,rn.resolve=Ie,rn.reject=Ln,rn._setScheduler=O,rn._setAsap=G,rn._asap=X;function Rs(){var Ye=void 0;if(typeof re.g!="undefined")Ye=re.g;else if(typeof self!="undefined")Ye=self;else try{Ye=Function("return this")()}catch(Ct){throw new Error("polyfill failed because global object is unavailable in this environment")}var De=Ye.Promise;if(De){var yt=null;try{yt=Object.prototype.toString.call(De.resolve())}catch(Ct){}if(yt==="[object Promise]"&&!De.cast)return}Ye.Promise=rn}return rn.polyfill=Rs,rn.Promise=rn,rn})},"./node_modules/events/events.js":function(Le){"use strict";var ve=typeof Reflect=="object"?Reflect:null,re=ve&&typeof ve.apply=="function"?ve.apply:function(fe,Ae,Re){return Function.prototype.apply.call(fe,Ae,Re)},ie;ve&&typeof ve.ownKeys=="function"?ie=ve.ownKeys:Object.getOwnPropertySymbols?ie=function(fe){return Object.getOwnPropertyNames(fe).concat(Object.getOwnPropertySymbols(fe))}:ie=function(fe){return Object.getOwnPropertyNames(fe)};function J(ae){console&&console.warn&&console.warn(ae)}var D=Number.isNaN||function(fe){return fe!==fe};function v(){v.init.call(this)}Le.exports=v,Le.exports.once=ue,v.EventEmitter=v,v.prototype._events=void 0,v.prototype._eventsCount=0,v.prototype._maxListeners=void 0;var $=10;function I(ae){if(typeof ae!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof ae)}Object.defineProperty(v,"defaultMaxListeners",{enumerable:!0,get:function(){return $},set:function(fe){if(typeof fe!="number"||fe<0||D(fe))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+fe+".");$=fe}}),v.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},v.prototype.setMaxListeners=function(fe){if(typeof fe!="number"||fe<0||D(fe))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+fe+".");return this._maxListeners=fe,this};function H(ae){return ae._maxListeners===void 0?v.defaultMaxListeners:ae._maxListeners}v.prototype.getMaxListeners=function(){return H(this)},v.prototype.emit=function(fe){for(var Ae=[],Re=1;Re<arguments.length;Re++)Ae.push(arguments[Re]);var Ce=fe==="error",we=this._events;if(we!==void 0)Ce=Ce&&we.error===void 0;else if(!Ce)return!1;if(Ce){var Fe;if(Ae.length>0&&(Fe=Ae[0]),Fe instanceof Error)throw Fe;var Ie=new Error("Unhandled error."+(Fe?" ("+Fe.message+")":""));throw Ie.context=Fe,Ie}var $e=we[fe];if($e===void 0)return!1;if(typeof $e=="function")re($e,this,Ae);else for(var Oe=$e.length,ht=S($e,Oe),Re=0;Re<Oe;++Re)re(ht[Re],this,Ae);return!0};function X(ae,fe,Ae,Re){var Ce,we,Fe;if(I(Ae),we=ae._events,we===void 0?(we=ae._events=Object.create(null),ae._eventsCount=0):(we.newListener!==void 0&&(ae.emit("newListener",fe,Ae.listener?Ae.listener:Ae),we=ae._events),Fe=we[fe]),Fe===void 0)Fe=we[fe]=Ae,++ae._eventsCount;else if(typeof Fe=="function"?Fe=we[fe]=Re?[Ae,Fe]:[Fe,Ae]:Re?Fe.unshift(Ae):Fe.push(Ae),Ce=H(ae),Ce>0&&Fe.length>Ce&&!Fe.warned){Fe.warned=!0;var Ie=new Error("Possible EventEmitter memory leak detected. "+Fe.length+" "+String(fe)+" listeners added. Use emitter.setMaxListeners() to increase limit");Ie.name="MaxListenersExceededWarning",Ie.emitter=ae,Ie.type=fe,Ie.count=Fe.length,J(Ie)}return ae}v.prototype.addListener=function(fe,Ae){return X(this,fe,Ae,!1)},v.prototype.on=v.prototype.addListener,v.prototype.prependListener=function(fe,Ae){return X(this,fe,Ae,!0)};function O(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function G(ae,fe,Ae){var Re={fired:!1,wrapFn:void 0,target:ae,type:fe,listener:Ae},Ce=O.bind(Re);return Ce.listener=Ae,Re.wrapFn=Ce,Ce}v.prototype.once=function(fe,Ae){return I(Ae),this.on(fe,G(this,fe,Ae)),this},v.prototype.prependOnceListener=function(fe,Ae){return I(Ae),this.prependListener(fe,G(this,fe,Ae)),this},v.prototype.removeListener=function(fe,Ae){var Re,Ce,we,Fe,Ie;if(I(Ae),Ce=this._events,Ce===void 0)return this;if(Re=Ce[fe],Re===void 0)return this;if(Re===Ae||Re.listener===Ae)--this._eventsCount==0?this._events=Object.create(null):(delete Ce[fe],Ce.removeListener&&this.emit("removeListener",fe,Re.listener||Ae));else if(typeof Re!="function"){for(we=-1,Fe=Re.length-1;Fe>=0;Fe--)if(Re[Fe]===Ae||Re[Fe].listener===Ae){Ie=Re[Fe].listener,we=Fe;break}if(we<0)return this;we===0?Re.shift():ee(Re,we),Re.length===1&&(Ce[fe]=Re[0]),Ce.removeListener!==void 0&&this.emit("removeListener",fe,Ie||Ae)}return this},v.prototype.off=v.prototype.removeListener,v.prototype.removeAllListeners=function(fe){var Ae,Re,Ce;if(Re=this._events,Re===void 0)return this;if(Re.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):Re[fe]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete Re[fe]),this;if(arguments.length===0){var we=Object.keys(Re),Fe;for(Ce=0;Ce<we.length;++Ce)Fe=we[Ce],Fe!=="removeListener"&&this.removeAllListeners(Fe);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(Ae=Re[fe],typeof Ae=="function")this.removeListener(fe,Ae);else if(Ae!==void 0)for(Ce=Ae.length-1;Ce>=0;Ce--)this.removeListener(fe,Ae[Ce]);return this};function j(ae,fe,Ae){var Re=ae._events;if(Re===void 0)return[];var Ce=Re[fe];return Ce===void 0?[]:typeof Ce=="function"?Ae?[Ce.listener||Ce]:[Ce]:Ae?se(Ce):S(Ce,Ce.length)}v.prototype.listeners=function(fe){return j(this,fe,!0)},v.prototype.rawListeners=function(fe){return j(this,fe,!1)},v.listenerCount=function(ae,fe){return typeof ae.listenerCount=="function"?ae.listenerCount(fe):V.call(ae,fe)},v.prototype.listenerCount=V;function V(ae){var fe=this._events;if(fe!==void 0){var Ae=fe[ae];if(typeof Ae=="function")return 1;if(Ae!==void 0)return Ae.length}return 0}v.prototype.eventNames=function(){return this._eventsCount>0?ie(this._events):[]};function S(ae,fe){for(var Ae=new Array(fe),Re=0;Re<fe;++Re)Ae[Re]=ae[Re];return Ae}function ee(ae,fe){for(;fe+1<ae.length;fe++)ae[fe]=ae[fe+1];ae.pop()}function se(ae){for(var fe=new Array(ae.length),Ae=0;Ae<fe.length;++Ae)fe[Ae]=ae[Ae].listener||ae[Ae];return fe}function ue(ae,fe){return new Promise(function(Ae,Re){function Ce(Fe){ae.removeListener(fe,we),Re(Fe)}function we(){typeof ae.removeListener=="function"&&ae.removeListener("error",Ce),Ae([].slice.call(arguments))}Y(ae,fe,we,{once:!0}),fe!=="error"&&U(ae,Ce,{once:!0})})}function U(ae,fe,Ae){typeof ae.on=="function"&&Y(ae,"error",fe,Ae)}function Y(ae,fe,Ae,Re){if(typeof ae.on=="function")Re.once?ae.once(fe,Ae):ae.on(fe,Ae);else if(typeof ae.addEventListener=="function")ae.addEventListener(fe,function Ce(we){Re.once&&ae.removeEventListener(fe,Ce),Ae(we)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof ae)}},"./node_modules/webworkify-webpack/index.js":function(Le,ve,re){function ie(O){var G={};function j(S){if(G[S])return G[S].exports;var ee=G[S]={i:S,l:!1,exports:{}};return O[S].call(ee.exports,ee,ee.exports,j),ee.l=!0,ee.exports}j.m=O,j.c=G,j.i=function(S){return S},j.d=function(S,ee,se){j.o(S,ee)||Object.defineProperty(S,ee,{configurable:!1,enumerable:!0,get:se})},j.r=function(S){Object.defineProperty(S,"__esModule",{value:!0})},j.n=function(S){var ee=S&&S.__esModule?function(){return S.default}:function(){return S};return j.d(ee,"a",ee),ee},j.o=function(S,ee){return Object.prototype.hasOwnProperty.call(S,ee)},j.p="/",j.oe=function(S){throw console.error(S),S};var V=j(j.s=ENTRY_MODULE);return V.default||V}var J="[\\.|\\-|\\+|\\w|/|@]+",D="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+J+").*?\\)";function v(O){return(O+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function $(O){return!isNaN(1*O)}function I(O,G,j){var V={};V[j]=[];var S=G.toString(),ee=S.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!ee)return V;for(var se=ee[1],ue=new RegExp("(\\\\n|\\W)"+v(se)+D,"g"),U;U=ue.exec(S);)U[3]!=="dll-reference"&&V[j].push(U[3]);for(ue=new RegExp("\\("+v(se)+'\\("(dll-reference\\s('+J+'))"\\)\\)'+D,"g");U=ue.exec(S);)O[U[2]]||(V[j].push(U[1]),O[U[2]]=re(U[1]).m),V[U[2]]=V[U[2]]||[],V[U[2]].push(U[4]);for(var Y=Object.keys(V),ae=0;ae<Y.length;ae++)for(var fe=0;fe<V[Y[ae]].length;fe++)$(V[Y[ae]][fe])&&(V[Y[ae]][fe]=1*V[Y[ae]][fe]);return V}function H(O){var G=Object.keys(O);return G.reduce(function(j,V){return j||O[V].length>0},!1)}function X(O,G){for(var j={main:[G]},V={main:[]},S={main:{}};H(j);)for(var ee=Object.keys(j),se=0;se<ee.length;se++){var ue=ee[se],U=j[ue],Y=U.pop();if(S[ue]=S[ue]||{},!(S[ue][Y]||!O[ue][Y])){S[ue][Y]=!0,V[ue]=V[ue]||[],V[ue].push(Y);for(var ae=I(O,O[ue][Y],ue),fe=Object.keys(ae),Ae=0;Ae<fe.length;Ae++)j[fe[Ae]]=j[fe[Ae]]||[],j[fe[Ae]]=j[fe[Ae]].concat(ae[fe[Ae]])}}return V}Le.exports=function(O,G){G=G||{};var j={main:re.m},V=G.all?{main:Object.keys(j.main)}:X(j,O),S="";Object.keys(V).filter(function(Y){return Y!=="main"}).forEach(function(Y){for(var ae=0;V[Y][ae];)ae++;V[Y].push(ae),j[Y][ae]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",S=S+"var "+Y+" = ("+ie.toString().replace("ENTRY_MODULE",JSON.stringify(ae))+")({"+V[Y].map(function(fe){return""+JSON.stringify(fe)+": "+j[Y][fe].toString()}).join(",")+`});
`}),S=S+"new (("+ie.toString().replace("ENTRY_MODULE",JSON.stringify(O))+")({"+V.main.map(function(Y){return""+JSON.stringify(Y)+": "+j.main[Y].toString()}).join(",")+"}))(self);";var ee=new window.Blob([S],{type:"text/javascript"});if(G.bare)return ee;var se=window.URL||window.webkitURL||window.mozURL||window.msURL,ue=se.createObjectURL(ee),U=new window.Worker(ue);return U.objectURL=ue,U}},"./src/config.js":function(Le,ve,re){"use strict";re.r(ve),re.d(ve,{defaultConfig:function(){return ie},createDefaultConfig:function(){return J}});var ie={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,lazyLoad:!0,lazyLoadMaxDuration:3*60,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:3*60,autoCleanupMinBackwardDuration:2*60,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function J(){return Object.assign({},ie)}},"./src/core/features.js":function(Le,ve,re){"use strict";re.r(ve);var ie=re("./src/io/io-controller.js"),J=re("./src/config.js"),D=function(){function v(){}return v.supportMSEH264Playback=function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')},v.supportNetworkStreamIO=function(){var $=new ie.default({},(0,J.createDefaultConfig)()),I=$.loaderType;return $.destroy(),I=="fetch-stream-loader"||I=="xhr-moz-chunked-loader"},v.getNetworkLoaderTypeName=function(){var $=new ie.default({},(0,J.createDefaultConfig)()),I=$.loaderType;return $.destroy(),I},v.supportNativeMediaPlayback=function($){v.videoElement==null&&(v.videoElement=window.document.createElement("video"));var I=v.videoElement.canPlayType($);return I==="probably"||I=="maybe"},v.getFeatureList=function(){var $={mseFlvPlayback:!1,mseLiveFlvPlayback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return $.mseFlvPlayback=v.supportMSEH264Playback(),$.networkStreamIO=v.supportNetworkStreamIO(),$.networkLoaderName=v.getNetworkLoaderTypeName(),$.mseLiveFlvPlayback=$.mseFlvPlayback&&$.networkStreamIO,$.nativeMP4H264Playback=v.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),$.nativeWebmVP8Playback=v.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),$.nativeWebmVP9Playback=v.supportNativeMediaPlayback('video/webm; codecs="vp9"'),$},v}();ve.default=D},"./src/core/media-info.js":function(Le,ve,re){"use strict";re.r(ve);var ie=function(){function J(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return J.prototype.isComplete=function(){var D=this.hasAudio===!1||this.hasAudio===!0&&this.audioCodec!=null&&this.audioSampleRate!=null&&this.audioChannelCount!=null,v=this.hasVideo===!1||this.hasVideo===!0&&this.videoCodec!=null&&this.width!=null&&this.height!=null&&this.fps!=null&&this.profile!=null&&this.level!=null&&this.refFrames!=null&&this.chromaFormat!=null&&this.sarNum!=null&&this.sarDen!=null;return this.mimeType!=null&&this.duration!=null&&this.metadata!=null&&this.hasKeyframesIndex!=null&&D&&v},J.prototype.isSeekable=function(){return this.hasKeyframesIndex===!0},J.prototype.getNearestKeyframe=function(D){if(this.keyframesIndex==null)return null;var v=this.keyframesIndex,$=this._search(v.times,D);return{index:$,milliseconds:v.times[$],fileposition:v.filepositions[$]}},J.prototype._search=function(D,v){var $=0,I=D.length-1,H=0,X=0,O=I;for(v<D[0]&&($=0,X=O+1);X<=O;)if(H=X+Math.floor((O-X)/2),H===I||v>=D[H]&&v<D[H+1]){$=H;break}else D[H]<v?X=H+1:O=H-1;return $},J}();ve.default=ie},"./src/core/media-segment-info.js":function(Le,ve,re){"use strict";re.r(ve),re.d(ve,{SampleInfo:function(){return ie},MediaSegmentInfo:function(){return J},IDRSampleList:function(){return D},MediaSegmentInfoList:function(){return v}});var ie=function(){function $(I,H,X,O,G){this.dts=I,this.pts=H,this.duration=X,this.originalDts=O,this.isSyncPoint=G,this.fileposition=null}return $}(),J=function(){function $(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return $.prototype.appendSyncPoint=function(I){I.isSyncPoint=!0,this.syncPoints.push(I)},$}(),D=function(){function $(){this._list=[]}return $.prototype.clear=function(){this._list=[]},$.prototype.appendArray=function(I){var H=this._list;I.length!==0&&(H.length>0&&I[0].originalDts<H[H.length-1].originalDts&&this.clear(),Array.prototype.push.apply(H,I))},$.prototype.getLastSyncPointBeforeDts=function(I){if(this._list.length==0)return null;var H=this._list,X=0,O=H.length-1,G=0,j=0,V=O;for(I<H[0].dts&&(X=0,j=V+1);j<=V;)if(G=j+Math.floor((V-j)/2),G===O||I>=H[G].dts&&I<H[G+1].dts){X=G;break}else H[G].dts<I?j=G+1:V=G-1;return this._list[X]},$}(),v=function(){function $(I){this._type=I,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty($.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),$.prototype.isEmpty=function(){return this._list.length===0},$.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},$.prototype._searchNearestSegmentBefore=function(I){var H=this._list;if(H.length===0)return-2;var X=H.length-1,O=0,G=0,j=X,V=0;if(I<H[0].originalBeginDts)return V=-1,V;for(;G<=j;)if(O=G+Math.floor((j-G)/2),O===X||I>H[O].lastSample.originalDts&&I<H[O+1].originalBeginDts){V=O;break}else H[O].originalBeginDts<I?G=O+1:j=O-1;return V},$.prototype._searchNearestSegmentAfter=function(I){return this._searchNearestSegmentBefore(I)+1},$.prototype.append=function(I){var H=this._list,X=I,O=this._lastAppendLocation,G=0;O!==-1&&O<H.length&&X.originalBeginDts>=H[O].lastSample.originalDts&&(O===H.length-1||O<H.length-1&&X.originalBeginDts<H[O+1].originalBeginDts)?G=O+1:H.length>0&&(G=this._searchNearestSegmentBefore(X.originalBeginDts)+1),this._lastAppendLocation=G,this._list.splice(G,0,X)},$.prototype.getLastSegmentBefore=function(I){var H=this._searchNearestSegmentBefore(I);return H>=0?this._list[H]:null},$.prototype.getLastSampleBefore=function(I){var H=this.getLastSegmentBefore(I);return H!=null?H.lastSample:null},$.prototype.getLastSyncPointBefore=function(I){for(var H=this._searchNearestSegmentBefore(I),X=this._list[H].syncPoints;X.length===0&&H>0;)H--,X=this._list[H].syncPoints;return X.length>0?X[X.length-1]:null},$}()},"./src/core/mse-controller.js":function(Le,ve,re){"use strict";re.r(ve);var ie=re("./node_modules/events/events.js"),J=re.n(ie),D=re("./src/utils/logger.js"),v=re("./src/utils/browser.js"),$=re("./src/core/mse-events.js"),I=re("./src/core/media-segment-info.js"),H=re("./src/utils/exception.js"),X=function(){function O(G){this.TAG="MSEController",this._config=G,this._emitter=new(J()),this._config.isLive&&this._config.autoCleanupSourceBuffer==null&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new I.IDRSampleList}return O.prototype.destroy=function(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},O.prototype.on=function(G,j){this._emitter.addListener(G,j)},O.prototype.off=function(G,j){this._emitter.removeListener(G,j)},O.prototype.attachMediaElement=function(G){if(this._mediaSource)throw new H.IllegalStateException("MediaSource has been attached to an HTMLMediaElement!");var j=this._mediaSource=new window.MediaSource;j.addEventListener("sourceopen",this.e.onSourceOpen),j.addEventListener("sourceended",this.e.onSourceEnded),j.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=G,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),G.src=this._mediaSourceObjectURL},O.prototype.detachMediaElement=function(){if(this._mediaSource){var G=this._mediaSource;for(var j in this._sourceBuffers){var V=this._pendingSegments[j];V.splice(0,V.length),this._pendingSegments[j]=null,this._pendingRemoveRanges[j]=null,this._lastInitSegments[j]=null;var S=this._sourceBuffers[j];if(S){if(G.readyState!=="closed"){try{G.removeSourceBuffer(S)}catch(ee){D.default.e(this.TAG,ee.message)}S.removeEventListener("error",this.e.onSourceBufferError),S.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[j]=null,this._sourceBuffers[j]=null}}if(G.readyState==="open")try{G.endOfStream()}catch(ee){D.default.e(this.TAG,ee.message)}G.removeEventListener("sourceopen",this.e.onSourceOpen),G.removeEventListener("sourceended",this.e.onSourceEnded),G.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},O.prototype.appendInitSegment=function(G,j){if(!this._mediaSource||this._mediaSource.readyState!=="open"){this._pendingSourceBufferInit.push(G),this._pendingSegments[G.type].push(G);return}var V=G,S=""+V.container;V.codec&&V.codec.length>0&&(S+=";codecs="+V.codec);var ee=!1;if(D.default.v(this.TAG,"Received Initialization Segment, mimeType: "+S),this._lastInitSegments[V.type]=V,S!==this._mimeTypes[V.type]){if(this._mimeTypes[V.type])D.default.v(this.TAG,"Notice: "+V.type+" mimeType changed, origin: "+this._mimeTypes[V.type]+", target: "+S);else{ee=!0;try{var se=this._sourceBuffers[V.type]=this._mediaSource.addSourceBuffer(S);se.addEventListener("error",this.e.onSourceBufferError),se.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(ue){D.default.e(this.TAG,ue.message),this._emitter.emit($.default.ERROR,{code:ue.code,msg:ue.message});return}}this._mimeTypes[V.type]=S}j||this._pendingSegments[V.type].push(V),ee||this._sourceBuffers[V.type]&&!this._sourceBuffers[V.type].updating&&this._doAppendSegments(),v.default.safari&&V.container==="audio/mpeg"&&V.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=V.mediaDuration/1e3,this._updateMediaSourceDuration())},O.prototype.appendMediaSegment=function(G){var j=G;this._pendingSegments[j.type].push(j),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var V=this._sourceBuffers[j.type];V&&!V.updating&&!this._hasPendingRemoveRanges()&&this._doAppendSegments()},O.prototype.seek=function(G){for(var j in this._sourceBuffers)if(!!this._sourceBuffers[j]){var V=this._sourceBuffers[j];if(this._mediaSource.readyState==="open")try{V.abort()}catch(Y){D.default.e(this.TAG,Y.message)}this._idrList.clear();var S=this._pendingSegments[j];if(S.splice(0,S.length),this._mediaSource.readyState!=="closed"){for(var ee=0;ee<V.buffered.length;ee++){var se=V.buffered.start(ee),ue=V.buffered.end(ee);this._pendingRemoveRanges[j].push({start:se,end:ue})}if(V.updating||this._doRemoveRanges(),v.default.safari){var U=this._lastInitSegments[j];U&&(this._pendingSegments[j].push(U),V.updating||this._doAppendSegments())}}}},O.prototype.endOfStream=function(){var G=this._mediaSource,j=this._sourceBuffers;if(!G||G.readyState!=="open"){G&&G.readyState==="closed"&&this._hasPendingSegments()&&(this._hasPendingEos=!0);return}j.video&&j.video.updating||j.audio&&j.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,G.endOfStream())},O.prototype.getNearestKeyframe=function(G){return this._idrList.getLastSyncPointBeforeDts(G)},O.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var G=this._mediaElement.currentTime;for(var j in this._sourceBuffers){var V=this._sourceBuffers[j];if(V){var S=V.buffered;if(S.length>=1&&G-S.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},O.prototype._doCleanupSourceBuffer=function(){var G=this._mediaElement.currentTime;for(var j in this._sourceBuffers){var V=this._sourceBuffers[j];if(V){for(var S=V.buffered,ee=!1,se=0;se<S.length;se++){var ue=S.start(se),U=S.end(se);if(ue<=G&&G<U+3){if(G-ue>=this._config.autoCleanupMaxBackwardDuration){ee=!0;var Y=G-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[j].push({start:ue,end:Y})}}else U<G&&(ee=!0,this._pendingRemoveRanges[j].push({start:ue,end:U}))}ee&&!V.updating&&this._doRemoveRanges()}}},O.prototype._updateMediaSourceDuration=function(){var G=this._sourceBuffers;if(!(this._mediaElement.readyState===0||this._mediaSource.readyState!=="open")&&!(G.video&&G.video.updating||G.audio&&G.audio.updating)){var j=this._mediaSource.duration,V=this._pendingMediaDuration;V>0&&(isNaN(j)||V>j)&&(D.default.v(this.TAG,"Update MediaSource duration from "+j+" to "+V),this._mediaSource.duration=V),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},O.prototype._doRemoveRanges=function(){for(var G in this._pendingRemoveRanges)if(!(!this._sourceBuffers[G]||this._sourceBuffers[G].updating))for(var j=this._sourceBuffers[G],V=this._pendingRemoveRanges[G];V.length&&!j.updating;){var S=V.shift();j.remove(S.start,S.end)}},O.prototype._doAppendSegments=function(){var G=this._pendingSegments;for(var j in G)if(!(!this._sourceBuffers[j]||this._sourceBuffers[j].updating)&&G[j].length>0){var V=G[j].shift();if(V.timestampOffset){var S=this._sourceBuffers[j].timestampOffset,ee=V.timestampOffset/1e3,se=Math.abs(S-ee);se>.1&&(D.default.v(this.TAG,"Update MPEG audio timestampOffset from "+S+" to "+ee),this._sourceBuffers[j].timestampOffset=ee),delete V.timestampOffset}if(!V.data||V.data.byteLength===0)continue;try{this._sourceBuffers[j].appendBuffer(V.data),this._isBufferFull=!1,j==="video"&&V.hasOwnProperty("info")&&this._idrList.appendArray(V.info.syncPoints)}catch(ue){this._pendingSegments[j].unshift(V),ue.code===22?(this._isBufferFull||this._emitter.emit($.default.BUFFER_FULL),this._isBufferFull=!0):(D.default.e(this.TAG,ue.message),this._emitter.emit($.default.ERROR,{code:ue.code,msg:ue.message}))}}},O.prototype._onSourceOpen=function(){if(D.default.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var G=this._pendingSourceBufferInit;G.length;){var j=G.shift();this.appendInitSegment(j,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit($.default.SOURCE_OPEN)},O.prototype._onSourceEnded=function(){D.default.v(this.TAG,"MediaSource onSourceEnded")},O.prototype._onSourceClose=function(){D.default.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&this.e!=null&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))},O.prototype._hasPendingSegments=function(){var G=this._pendingSegments;return G.video.length>0||G.audio.length>0},O.prototype._hasPendingRemoveRanges=function(){var G=this._pendingRemoveRanges;return G.video.length>0||G.audio.length>0},O.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit($.default.UPDATE_END)},O.prototype._onSourceBufferError=function(G){D.default.e(this.TAG,"SourceBuffer Error: "+G)},O}();ve.default=X},"./src/core/mse-events.js":function(Le,ve,re){"use strict";re.r(ve);var ie={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"};ve.default=ie},"./src/core/transmuxer.js":function(Le,ve,re){"use strict";re.r(ve);var ie=re("./node_modules/events/events.js"),J=re.n(ie),D=re("./node_modules/webworkify-webpack/index.js"),v=re.n(D),$=re("./src/utils/logger.js"),I=re("./src/utils/logging-control.js"),H=re("./src/core/transmuxing-controller.js"),X=re("./src/core/transmuxing-events.js"),O=re("./src/core/media-info.js"),G=function(){function j(V,S){if(this.TAG="Transmuxer",this._emitter=new(J()),S.enableWorker&&typeof Worker!="undefined")try{this._worker=v()("./src/core/transmuxing-worker.js"),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[V,S]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},I.default.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:I.default.getConfig()})}catch(se){$.default.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new H.default(V,S)}else this._controller=new H.default(V,S);if(this._controller){var ee=this._controller;ee.on(X.default.IO_ERROR,this._onIOError.bind(this)),ee.on(X.default.DEMUX_ERROR,this._onDemuxError.bind(this)),ee.on(X.default.INIT_SEGMENT,this._onInitSegment.bind(this)),ee.on(X.default.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),ee.on(X.default.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),ee.on(X.default.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),ee.on(X.default.MEDIA_INFO,this._onMediaInfo.bind(this)),ee.on(X.default.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),ee.on(X.default.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),ee.on(X.default.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),ee.on(X.default.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return j.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),I.default.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},j.prototype.on=function(V,S){this._emitter.addListener(V,S)},j.prototype.off=function(V,S){this._emitter.removeListener(V,S)},j.prototype.hasWorker=function(){return this._worker!=null},j.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},j.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},j.prototype.seek=function(V){this._worker?this._worker.postMessage({cmd:"seek",param:V}):this._controller.seek(V)},j.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},j.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},j.prototype._onInitSegment=function(V,S){var ee=this;Promise.resolve().then(function(){ee._emitter.emit(X.default.INIT_SEGMENT,V,S)})},j.prototype._onMediaSegment=function(V,S){var ee=this;Promise.resolve().then(function(){ee._emitter.emit(X.default.MEDIA_SEGMENT,V,S)})},j.prototype._onLoadingComplete=function(){var V=this;Promise.resolve().then(function(){V._emitter.emit(X.default.LOADING_COMPLETE)})},j.prototype._onRecoveredEarlyEof=function(){var V=this;Promise.resolve().then(function(){V._emitter.emit(X.default.RECOVERED_EARLY_EOF)})},j.prototype._onMediaInfo=function(V){var S=this;Promise.resolve().then(function(){S._emitter.emit(X.default.MEDIA_INFO,V)})},j.prototype._onMetaDataArrived=function(V){var S=this;Promise.resolve().then(function(){S._emitter.emit(X.default.METADATA_ARRIVED,V)})},j.prototype._onScriptDataArrived=function(V){var S=this;Promise.resolve().then(function(){S._emitter.emit(X.default.SCRIPTDATA_ARRIVED,V)})},j.prototype._onStatisticsInfo=function(V){var S=this;Promise.resolve().then(function(){S._emitter.emit(X.default.STATISTICS_INFO,V)})},j.prototype._onIOError=function(V,S){var ee=this;Promise.resolve().then(function(){ee._emitter.emit(X.default.IO_ERROR,V,S)})},j.prototype._onDemuxError=function(V,S){var ee=this;Promise.resolve().then(function(){ee._emitter.emit(X.default.DEMUX_ERROR,V,S)})},j.prototype._onRecommendSeekpoint=function(V){var S=this;Promise.resolve().then(function(){S._emitter.emit(X.default.RECOMMEND_SEEKPOINT,V)})},j.prototype._onLoggingConfigChanged=function(V){this._worker&&this._worker.postMessage({cmd:"logging_config",param:V})},j.prototype._onWorkerMessage=function(V){var S=V.data,ee=S.data;if(S.msg==="destroyed"||this._workerDestroying){this._workerDestroying=!1,this._worker.terminate(),this._worker=null;return}switch(S.msg){case X.default.INIT_SEGMENT:case X.default.MEDIA_SEGMENT:this._emitter.emit(S.msg,ee.type,ee.data);break;case X.default.LOADING_COMPLETE:case X.default.RECOVERED_EARLY_EOF:this._emitter.emit(S.msg);break;case X.default.MEDIA_INFO:Object.setPrototypeOf(ee,O.default.prototype),this._emitter.emit(S.msg,ee);break;case X.default.METADATA_ARRIVED:case X.default.SCRIPTDATA_ARRIVED:case X.default.STATISTICS_INFO:this._emitter.emit(S.msg,ee);break;case X.default.IO_ERROR:case X.default.DEMUX_ERROR:this._emitter.emit(S.msg,ee.type,ee.info);break;case X.default.RECOMMEND_SEEKPOINT:this._emitter.emit(S.msg,ee);break;case"logcat_callback":$.default.emitter.emit("log",ee.type,ee.logcat);break;default:break}},j}();ve.default=G},"./src/core/transmuxing-controller.js":function(Le,ve,re){"use strict";re.r(ve);var ie=re("./node_modules/events/events.js"),J=re.n(ie),D=re("./src/utils/logger.js"),v=re("./src/utils/browser.js"),$=re("./src/core/media-info.js"),I=re("./src/demux/flv-demuxer.js"),H=re("./src/remux/mp4-remuxer.js"),X=re("./src/demux/demux-errors.js"),O=re("./src/io/io-controller.js"),G=re("./src/core/transmuxing-events.js"),j=function(){function V(S,ee){this.TAG="TransmuxingController",this._emitter=new(J()),this._config=ee,S.segments||(S.segments=[{duration:S.duration,filesize:S.filesize,url:S.url}]),typeof S.cors!="boolean"&&(S.cors=!0),typeof S.withCredentials!="boolean"&&(S.withCredentials=!1),this._mediaDataSource=S,this._currentSegmentIndex=0;var se=0;this._mediaDataSource.segments.forEach(function(ue){ue.timestampBase=se,se+=ue.duration,ue.cors=S.cors,ue.withCredentials=S.withCredentials,ee.referrerPolicy&&(ue.referrerPolicy=ee.referrerPolicy)}),!isNaN(se)&&this._mediaDataSource.duration!==se&&(this._mediaDataSource.duration=se),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return V.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},V.prototype.on=function(S,ee){this._emitter.addListener(S,ee)},V.prototype.off=function(S,ee){this._emitter.removeListener(S,ee)},V.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},V.prototype._loadSegment=function(S,ee){this._currentSegmentIndex=S;var se=this._mediaDataSource.segments[S],ue=this._ioctl=new O.default(se,this._config,S);ue.onError=this._onIOException.bind(this),ue.onSeeked=this._onIOSeeked.bind(this),ue.onComplete=this._onIOComplete.bind(this),ue.onRedirect=this._onIORedirect.bind(this),ue.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),ee?this._demuxer.bindDataSource(this._ioctl):ue.onDataArrival=this._onInitChunkArrival.bind(this),ue.open(ee)},V.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},V.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},V.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},V.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},V.prototype.seek=function(S){if(!(this._mediaInfo==null||!this._mediaInfo.isSeekable())){var ee=this._searchSegmentIndexContains(S);if(ee===this._currentSegmentIndex){var se=this._mediaInfo.segments[ee];if(se==null)this._pendingSeekTime=S;else{var ue=se.getNearestKeyframe(S);this._remuxer.seek(ue.milliseconds),this._ioctl.seek(ue.fileposition),this._pendingResolveSeekPoint=ue.milliseconds}}else{var U=this._mediaInfo.segments[ee];if(U==null)this._pendingSeekTime=S,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(ee);else{var ue=U.getNearestKeyframe(S);this._internalAbort(),this._remuxer.seek(S),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[ee].timestampBase,this._loadSegment(ee,ue.fileposition),this._pendingResolveSeekPoint=ue.milliseconds,this._reportSegmentMediaInfo(ee)}}this._enableStatisticsReporter()}},V.prototype._searchSegmentIndexContains=function(S){for(var ee=this._mediaDataSource.segments,se=ee.length-1,ue=0;ue<ee.length;ue++)if(S<ee[ue].timestampBase){se=ue-1;break}return se},V.prototype._onInitChunkArrival=function(S,ee){var se=this,ue=null,U=0;if(ee>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,U=this._demuxer.parseChunks(S,ee);else if((ue=I.default.probe(S)).match){this._demuxer=new I.default(ue,this._config),this._remuxer||(this._remuxer=new H.default(this._config));var Y=this._mediaDataSource;Y.duration!=null&&!isNaN(Y.duration)&&(this._demuxer.overridedDuration=Y.duration),typeof Y.hasAudio=="boolean"&&(this._demuxer.overridedHasAudio=Y.hasAudio),typeof Y.hasVideo=="boolean"&&(this._demuxer.overridedHasVideo=Y.hasVideo),this._demuxer.timestampBase=Y.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this),U=this._demuxer.parseChunks(S,ee)}else ue=null,D.default.e(this.TAG,"Non-FLV, Unsupported media type!"),Promise.resolve().then(function(){se._internalAbort()}),this._emitter.emit(G.default.DEMUX_ERROR,X.default.FORMAT_UNSUPPORTED,"Non-FLV, Unsupported media type"),U=0;return U},V.prototype._onMediaInfo=function(S){var ee=this;this._mediaInfo==null&&(this._mediaInfo=Object.assign({},S),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,$.default.prototype));var se=Object.assign({},S);Object.setPrototypeOf(se,$.default.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=se,this._reportSegmentMediaInfo(this._currentSegmentIndex),this._pendingSeekTime!=null&&Promise.resolve().then(function(){var ue=ee._pendingSeekTime;ee._pendingSeekTime=null,ee.seek(ue)})},V.prototype._onMetaDataArrived=function(S){this._emitter.emit(G.default.METADATA_ARRIVED,S)},V.prototype._onScriptDataArrived=function(S){this._emitter.emit(G.default.SCRIPTDATA_ARRIVED,S)},V.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},V.prototype._onIOComplete=function(S){var ee=S,se=ee+1;se<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer.flushStashedSamples(),this._loadSegment(se)):(this._remuxer.flushStashedSamples(),this._emitter.emit(G.default.LOADING_COMPLETE),this._disableStatisticsReporter())},V.prototype._onIORedirect=function(S){var ee=this._ioctl.extraData;this._mediaDataSource.segments[ee].redirectedURL=S},V.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(G.default.RECOVERED_EARLY_EOF)},V.prototype._onIOException=function(S,ee){D.default.e(this.TAG,"IOException: type = "+S+", code = "+ee.code+", msg = "+ee.msg),this._emitter.emit(G.default.IO_ERROR,S,ee),this._disableStatisticsReporter()},V.prototype._onDemuxException=function(S,ee){D.default.e(this.TAG,"DemuxException: type = "+S+", info = "+ee),this._emitter.emit(G.default.DEMUX_ERROR,S,ee)},V.prototype._onRemuxerInitSegmentArrival=function(S,ee){this._emitter.emit(G.default.INIT_SEGMENT,S,ee)},V.prototype._onRemuxerMediaSegmentArrival=function(S,ee){if(this._pendingSeekTime==null&&(this._emitter.emit(G.default.MEDIA_SEGMENT,S,ee),this._pendingResolveSeekPoint!=null&&S==="video")){var se=ee.info.syncPoints,ue=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,v.default.safari&&se.length>0&&se[0].originalDts===ue&&(ue=se[0].pts),this._emitter.emit(G.default.RECOMMEND_SEEKPOINT,ue)}},V.prototype._enableStatisticsReporter=function(){this._statisticsReporter==null&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},V.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},V.prototype._reportSegmentMediaInfo=function(S){var ee=this._mediaInfo.segments[S],se=Object.assign({},ee);se.duration=this._mediaInfo.duration,se.segmentCount=this._mediaInfo.segmentCount,delete se.segments,delete se.keyframesIndex,this._emitter.emit(G.default.MEDIA_INFO,se)},V.prototype._reportStatisticsInfo=function(){var S={};S.url=this._ioctl.currentURL,S.hasRedirect=this._ioctl.hasRedirect,S.hasRedirect&&(S.redirectedURL=this._ioctl.currentRedirectedURL),S.speed=this._ioctl.currentSpeed,S.loaderType=this._ioctl.loaderType,S.currentSegmentIndex=this._currentSegmentIndex,S.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(G.default.STATISTICS_INFO,S)},V}();ve.default=j},"./src/core/transmuxing-events.js":function(Le,ve,re){"use strict";re.r(ve);var ie={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint"};ve.default=ie},"./src/core/transmuxing-worker.js":function(Le,ve,re){"use strict";re.r(ve);var ie=re("./src/utils/logging-control.js"),J=re("./src/utils/polyfill.js"),D=re("./src/core/transmuxing-controller.js"),v=re("./src/core/transmuxing-events.js"),$=function(H){var X="TransmuxingWorker",O=null,G=Re.bind(this);J.default.install(),H.addEventListener("message",function(Ce){switch(Ce.data.cmd){case"init":O=new D.default(Ce.data.param[0],Ce.data.param[1]),O.on(v.default.IO_ERROR,ae.bind(this)),O.on(v.default.DEMUX_ERROR,fe.bind(this)),O.on(v.default.INIT_SEGMENT,j.bind(this)),O.on(v.default.MEDIA_SEGMENT,V.bind(this)),O.on(v.default.LOADING_COMPLETE,S.bind(this)),O.on(v.default.RECOVERED_EARLY_EOF,ee.bind(this)),O.on(v.default.MEDIA_INFO,se.bind(this)),O.on(v.default.METADATA_ARRIVED,ue.bind(this)),O.on(v.default.SCRIPTDATA_ARRIVED,U.bind(this)),O.on(v.default.STATISTICS_INFO,Y.bind(this)),O.on(v.default.RECOMMEND_SEEKPOINT,Ae.bind(this));break;case"destroy":O&&(O.destroy(),O=null),H.postMessage({msg:"destroyed"});break;case"start":O.start();break;case"stop":O.stop();break;case"seek":O.seek(Ce.data.param);break;case"pause":O.pause();break;case"resume":O.resume();break;case"logging_config":{var we=Ce.data.param;ie.default.applyConfig(we),we.enableCallback===!0?ie.default.addLogListener(G):ie.default.removeLogListener(G);break}}});function j(Ce,we){var Fe={msg:v.default.INIT_SEGMENT,data:{type:Ce,data:we}};H.postMessage(Fe,[we.data])}function V(Ce,we){var Fe={msg:v.default.MEDIA_SEGMENT,data:{type:Ce,data:we}};H.postMessage(Fe,[we.data])}function S(){var Ce={msg:v.default.LOADING_COMPLETE};H.postMessage(Ce)}function ee(){var Ce={msg:v.default.RECOVERED_EARLY_EOF};H.postMessage(Ce)}function se(Ce){var we={msg:v.default.MEDIA_INFO,data:Ce};H.postMessage(we)}function ue(Ce){var we={msg:v.default.METADATA_ARRIVED,data:Ce};H.postMessage(we)}function U(Ce){var we={msg:v.default.SCRIPTDATA_ARRIVED,data:Ce};H.postMessage(we)}function Y(Ce){var we={msg:v.default.STATISTICS_INFO,data:Ce};H.postMessage(we)}function ae(Ce,we){H.postMessage({msg:v.default.IO_ERROR,data:{type:Ce,info:we}})}function fe(Ce,we){H.postMessage({msg:v.default.DEMUX_ERROR,data:{type:Ce,info:we}})}function Ae(Ce){H.postMessage({msg:v.default.RECOMMEND_SEEKPOINT,data:Ce})}function Re(Ce,we){H.postMessage({msg:"logcat_callback",data:{type:Ce,logcat:we}})}};ve.default=$},"./src/demux/amf-parser.js":function(Le,ve,re){"use strict";re.r(ve);var ie=re("./src/utils/logger.js"),J=re("./src/utils/utf8-conv.js"),D=re("./src/utils/exception.js"),v=function(){var I=new ArrayBuffer(2);return new DataView(I).setInt16(0,256,!0),new Int16Array(I)[0]===256}(),$=function(){function I(){}return I.parseScriptData=function(H,X,O){var G={};try{var j=I.parseValue(H,X,O),V=I.parseValue(H,X+j.size,O-j.size);G[j.data]=V.data}catch(S){ie.default.e("AMF",S.toString())}return G},I.parseObject=function(H,X,O){if(O<3)throw new D.IllegalStateException("Data not enough when parse ScriptDataObject");var G=I.parseString(H,X,O),j=I.parseValue(H,X+G.size,O-G.size),V=j.objectEnd;return{data:{name:G.data,value:j.data},size:G.size+j.size,objectEnd:V}},I.parseVariable=function(H,X,O){return I.parseObject(H,X,O)},I.parseString=function(H,X,O){if(O<2)throw new D.IllegalStateException("Data not enough when parse String");var G=new DataView(H,X,O),j=G.getUint16(0,!v),V;return j>0?V=(0,J.default)(new Uint8Array(H,X+2,j)):V="",{data:V,size:2+j}},I.parseLongString=function(H,X,O){if(O<4)throw new D.IllegalStateException("Data not enough when parse LongString");var G=new DataView(H,X,O),j=G.getUint32(0,!v),V;return j>0?V=(0,J.default)(new Uint8Array(H,X+4,j)):V="",{data:V,size:4+j}},I.parseDate=function(H,X,O){if(O<10)throw new D.IllegalStateException("Data size invalid when parse Date");var G=new DataView(H,X,O),j=G.getFloat64(0,!v),V=G.getInt16(8,!v);return j+=V*60*1e3,{data:new Date(j),size:8+2}},I.parseValue=function(H,X,O){if(O<1)throw new D.IllegalStateException("Data not enough when parse Value");var G=new DataView(H,X,O),j=1,V=G.getUint8(0),S,ee=!1;try{switch(V){case 0:S=G.getFloat64(1,!v),j+=8;break;case 1:{var se=G.getUint8(1);S=!!se,j+=1;break}case 2:{var ue=I.parseString(H,X+1,O-1);S=ue.data,j+=ue.size;break}case 3:{S={};var U=0;for((G.getUint32(O-4,!v)&16777215)==9&&(U=3);j<O-4;){var Y=I.parseObject(H,X+j,O-j-U);if(Y.objectEnd)break;S[Y.data.name]=Y.data.value,j+=Y.size}if(j<=O-3){var ae=G.getUint32(j-1,!v)&16777215;ae===9&&(j+=3)}break}case 8:{S={},j+=4;var U=0;for((G.getUint32(O-4,!v)&16777215)==9&&(U=3);j<O-8;){var fe=I.parseVariable(H,X+j,O-j-U);if(fe.objectEnd)break;S[fe.data.name]=fe.data.value,j+=fe.size}if(j<=O-3){var ae=G.getUint32(j-1,!v)&16777215;ae===9&&(j+=3)}break}case 9:S=void 0,j=1,ee=!0;break;case 10:{S=[];var Ae=G.getUint32(1,!v);j+=4;for(var Re=0;Re<Ae;Re++){var Ce=I.parseValue(H,X+j,O-j);S.push(Ce.data),j+=Ce.size}break}case 11:{var we=I.parseDate(H,X+1,O-1);S=we.data,j+=we.size;break}case 12:{var Fe=I.parseString(H,X+1,O-1);S=Fe.data,j+=Fe.size;break}default:j=O,ie.default.w("AMF","Unsupported AMF value type "+V)}}catch(Ie){ie.default.e("AMF",Ie.toString())}return{data:S,size:j,objectEnd:ee}},I}();ve.default=$},"./src/demux/demux-errors.js":function(Le,ve,re){"use strict";re.r(ve);var ie={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"};ve.default=ie},"./src/demux/exp-golomb.js":function(Le,ve,re){"use strict";re.r(ve);var ie=re("./src/utils/exception.js"),J=function(){function D(v){this.TAG="ExpGolomb",this._buffer=v,this._buffer_index=0,this._total_bytes=v.byteLength,this._total_bits=v.byteLength*8,this._current_word=0,this._current_word_bits_left=0}return D.prototype.destroy=function(){this._buffer=null},D.prototype._fillCurrentWord=function(){var v=this._total_bytes-this._buffer_index;if(v<=0)throw new ie.IllegalStateException("ExpGolomb: _fillCurrentWord() but no bytes available");var $=Math.min(4,v),I=new Uint8Array(4);I.set(this._buffer.subarray(this._buffer_index,this._buffer_index+$)),this._current_word=new DataView(I.buffer).getUint32(0,!1),this._buffer_index+=$,this._current_word_bits_left=$*8},D.prototype.readBits=function(v){if(v>32)throw new ie.InvalidArgumentException("ExpGolomb: readBits() bits exceeded max 32bits!");if(v<=this._current_word_bits_left){var $=this._current_word>>>32-v;return this._current_word<<=v,this._current_word_bits_left-=v,$}var I=this._current_word_bits_left?this._current_word:0;I=I>>>32-this._current_word_bits_left;var H=v-this._current_word_bits_left;this._fillCurrentWord();var X=Math.min(H,this._current_word_bits_left),O=this._current_word>>>32-X;return this._current_word<<=X,this._current_word_bits_left-=X,I=I<<X|O,I},D.prototype.readBool=function(){return this.readBits(1)===1},D.prototype.readByte=function(){return this.readBits(8)},D.prototype._skipLeadingZero=function(){var v;for(v=0;v<this._current_word_bits_left;v++)if((this._current_word&2147483648>>>v)!=0)return this._current_word<<=v,this._current_word_bits_left-=v,v;return this._fillCurrentWord(),v+this._skipLeadingZero()},D.prototype.readUEG=function(){var v=this._skipLeadingZero();return this.readBits(v+1)-1},D.prototype.readSEG=function(){var v=this.readUEG();return v&1?v+1>>>1:-1*(v>>>1)},D}();ve.default=J},"./src/demux/flv-demuxer.js":function(Le,ve,re){"use strict";re.r(ve);var ie=re("./src/utils/logger.js"),J=re("./src/demux/amf-parser.js"),D=re("./src/demux/sps-parser.js"),v=re("./src/demux/demux-errors.js"),$=re("./src/core/media-info.js"),I=re("./src/utils/exception.js");function H(j){return j>>>8&255|(j&255)<<8}function X(j){return(j&4278190080)>>>24|(j&16711680)>>>8|(j&65280)<<8|(j&255)<<24}function O(j,V){return j[V]<<24|j[V+1]<<16|j[V+2]<<8|j[V+3]}var G=function(){function j(V,S){this.TAG="FLVDemuxer",this._config=S,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=V.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=V.hasAudioTrack,this._hasVideo=V.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new $.default,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var ee=new ArrayBuffer(2);return new DataView(ee).setInt16(0,256,!0),new Int16Array(ee)[0]===256}()}return j.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},j.probe=function(V){var S=new Uint8Array(V),ee={match:!1};if(S[0]!==70||S[1]!==76||S[2]!==86||S[3]!==1)return ee;var se=(S[4]&4)>>>2!=0,ue=(S[4]&1)!=0,U=O(S,5);return U<9?ee:{match:!0,consumed:U,dataOffset:U,hasAudioTrack:se,hasVideoTrack:ue}},j.prototype.bindDataSource=function(V){return V.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(j.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(S){this._onTrackMetadata=S},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(S){this._onMediaInfo=S},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(S){this._onMetaDataArrived=S},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(S){this._onScriptDataArrived=S},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"onError",{get:function(){return this._onError},set:function(S){this._onError=S},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(S){this._onDataAvailable=S},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(S){this._timestampBase=S},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"overridedDuration",{get:function(){return this._duration},set:function(S){this._durationOverrided=!0,this._duration=S,this._mediaInfo.duration=S},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"overridedHasAudio",{set:function(S){this._hasAudioFlagOverrided=!0,this._hasAudio=S,this._mediaInfo.hasAudio=S},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"overridedHasVideo",{set:function(S){this._hasVideoFlagOverrided=!0,this._hasVideo=S,this._mediaInfo.hasVideo=S},enumerable:!1,configurable:!0}),j.prototype.resetMediaInfo=function(){this._mediaInfo=new $.default},j.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!this._hasAudio&&this._hasVideo?this._videoInitialMetadataDispatched:!1},j.prototype.parseChunks=function(V,S){if(!this._onError||!this._onMediaInfo||!this._onTrackMetadata||!this._onDataAvailable)throw new I.IllegalStateException("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var ee=0,se=this._littleEndian;if(S===0)if(V.byteLength>13){var ue=j.probe(V);ee=ue.dataOffset}else return 0;if(this._firstParse){this._firstParse=!1,S+ee!==this._dataOffset&&ie.default.w(this.TAG,"First time parsing but chunk byteStart invalid!");var U=new DataView(V,ee),Y=U.getUint32(0,!se);Y!==0&&ie.default.w(this.TAG,"PrevTagSize0 !== 0 !!!"),ee+=4}for(;ee<V.byteLength;){this._dispatch=!0;var U=new DataView(V,ee);if(ee+11+4>V.byteLength)break;var ae=U.getUint8(0),fe=U.getUint32(0,!se)&16777215;if(ee+11+fe+4>V.byteLength)break;if(ae!==8&&ae!==9&&ae!==18){ie.default.w(this.TAG,"Unsupported tag type "+ae+", skipped"),ee+=11+fe+4;continue}var Ae=U.getUint8(4),Re=U.getUint8(5),Ce=U.getUint8(6),we=U.getUint8(7),Fe=Ce|Re<<8|Ae<<16|we<<24,Ie=U.getUint32(7,!se)&16777215;Ie!==0&&ie.default.w(this.TAG,"Meet tag which has StreamID != 0!");var $e=ee+11;switch(ae){case 8:this._parseAudioData(V,$e,fe,Fe);break;case 9:this._parseVideoData(V,$e,fe,Fe,S+ee);break;case 18:this._parseScriptData(V,$e,fe);break}var Oe=U.getUint32(11+fe,!se);Oe!==11+fe&&ie.default.w(this.TAG,"Invalid PrevTagSize "+Oe),ee+=11+fe+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),ee},j.prototype._parseScriptData=function(V,S,ee){var se=J.default.parseScriptData(V,S,ee);if(se.hasOwnProperty("onMetaData")){if(se.onMetaData==null||typeof se.onMetaData!="object"){ie.default.w(this.TAG,"Invalid onMetaData structure!");return}this._metadata&&ie.default.w(this.TAG,"Found another onMetaData tag!"),this._metadata=se;var ue=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},ue)),typeof ue.hasAudio=="boolean"&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=ue.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),typeof ue.hasVideo=="boolean"&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=ue.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),typeof ue.audiodatarate=="number"&&(this._mediaInfo.audioDataRate=ue.audiodatarate),typeof ue.videodatarate=="number"&&(this._mediaInfo.videoDataRate=ue.videodatarate),typeof ue.width=="number"&&(this._mediaInfo.width=ue.width),typeof ue.height=="number"&&(this._mediaInfo.height=ue.height),typeof ue.duration=="number"){if(!this._durationOverrided){var U=Math.floor(ue.duration*this._timescale);this._duration=U,this._mediaInfo.duration=U}}else this._mediaInfo.duration=0;if(typeof ue.framerate=="number"){var Y=Math.floor(ue.framerate*1e3);if(Y>0){var ae=Y/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=ae,this._referenceFrameRate.fps_num=Y,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=ae}}if(typeof ue.keyframes=="object"){this._mediaInfo.hasKeyframesIndex=!0;var fe=ue.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(fe),ue.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=ue,ie.default.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(se).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},se))},j.prototype._parseKeyframesIndex=function(V){for(var S=[],ee=[],se=1;se<V.times.length;se++){var ue=this._timestampBase+Math.floor(V.times[se]*1e3);S.push(ue),ee.push(V.filepositions[se])}return{times:S,filepositions:ee}},j.prototype._parseAudioData=function(V,S,ee,se){if(ee<=1){ie.default.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");return}if(!(this._hasAudioFlagOverrided===!0&&this._hasAudio===!1)){var ue=this._littleEndian,U=new DataView(V,S,ee),Y=U.getUint8(0),ae=Y>>>4;if(ae!==2&&ae!==10){this._onError(v.default.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+ae);return}var fe=0,Ae=(Y&12)>>>2;if(Ae>=0&&Ae<=4)fe=this._flvSoundRateTable[Ae];else{this._onError(v.default.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+Ae);return}var Re=(Y&2)>>>1,Ce=Y&1,we=this._audioMetadata,Fe=this._audioTrack;if(we||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),we=this._audioMetadata={},we.type="audio",we.id=Fe.id,we.timescale=this._timescale,we.duration=this._duration,we.audioSampleRate=fe,we.channelCount=Ce===0?1:2),ae===10){var Ie=this._parseAACAudioData(V,S+1,ee-1);if(Ie==null)return;if(Ie.packetType===0){we.config&&ie.default.w(this.TAG,"Found another AudioSpecificConfig!");var $e=Ie.data;we.audioSampleRate=$e.samplingRate,we.channelCount=$e.channelCount,we.codec=$e.codec,we.originalCodec=$e.originalCodec,we.config=$e.config,we.refSampleDuration=1024/we.audioSampleRate*we.timescale,ie.default.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",we);var Oe=this._mediaInfo;Oe.audioCodec=we.originalCodec,Oe.audioSampleRate=we.audioSampleRate,Oe.audioChannelCount=we.channelCount,Oe.hasVideo?Oe.videoCodec!=null&&(Oe.mimeType='video/x-flv; codecs="'+Oe.videoCodec+","+Oe.audioCodec+'"'):Oe.mimeType='video/x-flv; codecs="'+Oe.audioCodec+'"',Oe.isComplete()&&this._onMediaInfo(Oe)}else if(Ie.packetType===1){var ht=this._timestampBase+se,kt={unit:Ie.data,length:Ie.data.byteLength,dts:ht,pts:ht};Fe.samples.push(kt),Fe.length+=Ie.data.length}else ie.default.e(this.TAG,"Flv: Unsupported AAC data type "+Ie.packetType)}else if(ae===2){if(!we.codec){var $e=this._parseMP3AudioData(V,S+1,ee-1,!0);if($e==null)return;we.audioSampleRate=$e.samplingRate,we.channelCount=$e.channelCount,we.codec=$e.codec,we.originalCodec=$e.originalCodec,we.refSampleDuration=1152/we.audioSampleRate*we.timescale,ie.default.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",we);var Oe=this._mediaInfo;Oe.audioCodec=we.codec,Oe.audioSampleRate=we.audioSampleRate,Oe.audioChannelCount=we.channelCount,Oe.audioDataRate=$e.bitRate,Oe.hasVideo?Oe.videoCodec!=null&&(Oe.mimeType='video/x-flv; codecs="'+Oe.videoCodec+","+Oe.audioCodec+'"'):Oe.mimeType='video/x-flv; codecs="'+Oe.audioCodec+'"',Oe.isComplete()&&this._onMediaInfo(Oe)}var Rt=this._parseMP3AudioData(V,S+1,ee-1,!1);if(Rt==null)return;var ht=this._timestampBase+se,mt={unit:Rt,length:Rt.byteLength,dts:ht,pts:ht};Fe.samples.push(mt),Fe.length+=Rt.length}}},j.prototype._parseAACAudioData=function(V,S,ee){if(ee<=1){ie.default.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!");return}var se={},ue=new Uint8Array(V,S,ee);return se.packetType=ue[0],ue[0]===0?se.data=this._parseAACAudioSpecificConfig(V,S+1,ee-1):se.data=ue.subarray(1),se},j.prototype._parseAACAudioSpecificConfig=function(V,S,ee){var se=new Uint8Array(V,S,ee),ue=null,U=0,Y=0,ae=null,fe=0,Ae=null;if(U=Y=se[0]>>>3,fe=(se[0]&7)<<1|se[1]>>>7,fe<0||fe>=this._mpegSamplingRates.length){this._onError(v.default.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");return}var Re=this._mpegSamplingRates[fe],Ce=(se[1]&120)>>>3;if(Ce<0||Ce>=8){this._onError(v.default.FORMAT_ERROR,"Flv: AAC invalid channel configuration");return}U===5&&(Ae=(se[1]&7)<<1|se[2]>>>7,ae=(se[2]&124)>>>2);var we=self.navigator.userAgent.toLowerCase();return we.indexOf("firefox")!==-1?fe>=6?(U=5,ue=new Array(4),Ae=fe-3):(U=2,ue=new Array(2),Ae=fe):we.indexOf("android")!==-1?(U=2,ue=new Array(2),Ae=fe):(U=5,Ae=fe,ue=new Array(4),fe>=6?Ae=fe-3:Ce===1&&(U=2,ue=new Array(2),Ae=fe)),ue[0]=U<<3,ue[0]|=(fe&15)>>>1,ue[1]=(fe&15)<<7,ue[1]|=(Ce&15)<<3,U===5&&(ue[1]|=(Ae&15)>>>1,ue[2]=(Ae&1)<<7,ue[2]|=2<<2,ue[3]=0),{config:ue,samplingRate:Re,channelCount:Ce,codec:"mp4a.40."+U,originalCodec:"mp4a.40."+Y}},j.prototype._parseMP3AudioData=function(V,S,ee,se){if(ee<4){ie.default.w(this.TAG,"Flv: Invalid MP3 packet, header missing!");return}var ue=this._littleEndian,U=new Uint8Array(V,S,ee),Y=null;if(se){if(U[0]!==255)return;var ae=U[1]>>>3&3,fe=(U[1]&6)>>1,Ae=(U[2]&240)>>>4,Re=(U[2]&12)>>>2,Ce=U[3]>>>6&3,we=Ce!==3?2:1,Fe=0,Ie=0,$e=34,Oe="mp3";switch(ae){case 0:Fe=this._mpegAudioV25SampleRateTable[Re];break;case 2:Fe=this._mpegAudioV20SampleRateTable[Re];break;case 3:Fe=this._mpegAudioV10SampleRateTable[Re];break}switch(fe){case 1:$e=34,Ae<this._mpegAudioL3BitRateTable.length&&(Ie=this._mpegAudioL3BitRateTable[Ae]);break;case 2:$e=33,Ae<this._mpegAudioL2BitRateTable.length&&(Ie=this._mpegAudioL2BitRateTable[Ae]);break;case 3:$e=32,Ae<this._mpegAudioL1BitRateTable.length&&(Ie=this._mpegAudioL1BitRateTable[Ae]);break}Y={bitRate:Ie,samplingRate:Fe,channelCount:we,codec:Oe,originalCodec:Oe}}else Y=U;return Y},j.prototype._parseVideoData=function(V,S,ee,se,ue){if(ee<=1){ie.default.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");return}if(!(this._hasVideoFlagOverrided===!0&&this._hasVideo===!1)){var U=new Uint8Array(V,S,ee)[0],Y=(U&240)>>>4,ae=U&15;if(ae!==7){this._onError(v.default.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+ae);return}this._parseAVCVideoPacket(V,S+1,ee-1,se,ue,Y)}},j.prototype._parseAVCVideoPacket=function(V,S,ee,se,ue,U){if(ee<4){ie.default.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");return}var Y=this._littleEndian,ae=new DataView(V,S,ee),fe=ae.getUint8(0),Ae=ae.getUint32(0,!Y)&16777215,Re=Ae<<8>>8;if(fe===0)this._parseAVCDecoderConfigurationRecord(V,S+4,ee-4);else if(fe===1)this._parseAVCVideoData(V,S+4,ee-4,se,ue,U,Re);else if(fe!==2){this._onError(v.default.FORMAT_ERROR,"Flv: Invalid video packet type "+fe);return}},j.prototype._parseAVCDecoderConfigurationRecord=function(V,S,ee){if(ee<7){ie.default.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");return}var se=this._videoMetadata,ue=this._videoTrack,U=this._littleEndian,Y=new DataView(V,S,ee);se?typeof se.avcc!="undefined"&&ie.default.w(this.TAG,"Found another AVCDecoderConfigurationRecord!"):(this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),se=this._videoMetadata={},se.type="video",se.id=ue.id,se.timescale=this._timescale,se.duration=this._duration);var ae=Y.getUint8(0),fe=Y.getUint8(1),Ae=Y.getUint8(2),Re=Y.getUint8(3);if(ae!==1||fe===0){this._onError(v.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord");return}if(this._naluLengthSize=(Y.getUint8(4)&3)+1,this._naluLengthSize!==3&&this._naluLengthSize!==4){this._onError(v.default.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));return}var Ce=Y.getUint8(5)&31;if(Ce===0){this._onError(v.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS");return}else Ce>1&&ie.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+Ce);for(var we=6,Fe=0;Fe<Ce;Fe++){var Ie=Y.getUint16(we,!U);if(we+=2,Ie!==0){var $e=new Uint8Array(V,S+we,Ie);we+=Ie;var Oe=D.default.parseSPS($e);if(Fe===0){se.codecWidth=Oe.codec_size.width,se.codecHeight=Oe.codec_size.height,se.presentWidth=Oe.present_size.width,se.presentHeight=Oe.present_size.height,se.profile=Oe.profile_string,se.level=Oe.level_string,se.bitDepth=Oe.bit_depth,se.chromaFormat=Oe.chroma_format,se.sarRatio=Oe.sar_ratio,se.frameRate=Oe.frame_rate,(Oe.frame_rate.fixed===!1||Oe.frame_rate.fps_num===0||Oe.frame_rate.fps_den===0)&&(se.frameRate=this._referenceFrameRate);var ht=se.frameRate.fps_den,kt=se.frameRate.fps_num;se.refSampleDuration=se.timescale*(ht/kt);for(var Rt=$e.subarray(1,4),mt="avc1.",rt=0;rt<3;rt++){var Kt=Rt[rt].toString(16);Kt.length<2&&(Kt="0"+Kt),mt+=Kt}se.codec=mt;var _t=this._mediaInfo;_t.width=se.codecWidth,_t.height=se.codecHeight,_t.fps=se.frameRate.fps,_t.profile=se.profile,_t.level=se.level,_t.refFrames=Oe.ref_frames,_t.chromaFormat=Oe.chroma_format_string,_t.sarNum=se.sarRatio.width,_t.sarDen=se.sarRatio.height,_t.videoCodec=mt,_t.hasAudio?_t.audioCodec!=null&&(_t.mimeType='video/x-flv; codecs="'+_t.videoCodec+","+_t.audioCodec+'"'):_t.mimeType='video/x-flv; codecs="'+_t.videoCodec+'"',_t.isComplete()&&this._onMediaInfo(_t)}}}var Gt=Y.getUint8(we);if(Gt===0){this._onError(v.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS");return}else Gt>1&&ie.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = "+Gt);we++;for(var Fe=0;Fe<Gt;Fe++){var Ie=Y.getUint16(we,!U);we+=2,Ie!==0&&(we+=Ie)}se.avcc=new Uint8Array(ee),se.avcc.set(new Uint8Array(V,S,ee),0),ie.default.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",se)},j.prototype._parseAVCVideoData=function(V,S,ee,se,ue,U,Y){for(var ae=this._littleEndian,fe=new DataView(V,S,ee),Ae=[],Re=0,Ce=0,we=this._naluLengthSize,Fe=this._timestampBase+se,Ie=U===1;Ce<ee;){if(Ce+4>=ee){ie.default.w(this.TAG,"Malformed Nalu near timestamp "+Fe+", offset = "+Ce+", dataSize = "+ee);break}var $e=fe.getUint32(Ce,!ae);if(we===3&&($e>>>=8),$e>ee-we){ie.default.w(this.TAG,"Malformed Nalus near timestamp "+Fe+", NaluSize > DataSize!");return}var Oe=fe.getUint8(Ce+we)&31;Oe===5&&(Ie=!0);var ht=new Uint8Array(V,S+Ce,we+$e),kt={type:Oe,data:ht};Ae.push(kt),Re+=ht.byteLength,Ce+=we+$e}if(Ae.length){var Rt=this._videoTrack,mt={units:Ae,length:Re,isKeyframe:Ie,dts:Fe,cts:Y,pts:Fe+Y};Ie&&(mt.fileposition=ue),Rt.samples.push(mt),Rt.length+=Re}},j}();ve.default=G},"./src/demux/sps-parser.js":function(Le,ve,re){"use strict";re.r(ve);var ie=re("./src/demux/exp-golomb.js"),J=function(){function D(){}return D._ebsp2rbsp=function(v){for(var $=v,I=$.byteLength,H=new Uint8Array(I),X=0,O=0;O<I;O++)O>=2&&$[O]===3&&$[O-1]===0&&$[O-2]===0||(H[X]=$[O],X++);return new Uint8Array(H.buffer,0,X)},D.parseSPS=function(v){var $=D._ebsp2rbsp(v),I=new ie.default($);I.readByte();var H=I.readByte();I.readByte();var X=I.readByte();I.readUEG();var O=D.getProfileString(H),G=D.getLevelString(X),j=1,V=420,S=[0,420,422,444],ee=8;if((H===100||H===110||H===122||H===244||H===44||H===83||H===86||H===118||H===128||H===138||H===144)&&(j=I.readUEG(),j===3&&I.readBits(1),j<=3&&(V=S[j]),ee=I.readUEG()+8,I.readUEG(),I.readBits(1),I.readBool()))for(var se=j!==3?8:12,ue=0;ue<se;ue++)I.readBool()&&(ue<6?D._skipScalingList(I,16):D._skipScalingList(I,64));I.readUEG();var U=I.readUEG();if(U===0)I.readUEG();else if(U===1){I.readBits(1),I.readSEG(),I.readSEG();for(var Y=I.readUEG(),ue=0;ue<Y;ue++)I.readSEG()}var ae=I.readUEG();I.readBits(1);var fe=I.readUEG(),Ae=I.readUEG(),Re=I.readBits(1);Re===0&&I.readBits(1),I.readBits(1);var Ce=0,we=0,Fe=0,Ie=0,$e=I.readBool();$e&&(Ce=I.readUEG(),we=I.readUEG(),Fe=I.readUEG(),Ie=I.readUEG());var Oe=1,ht=1,kt=0,Rt=!0,mt=0,rt=0,Kt=I.readBool();if(Kt){if(I.readBool()){var _t=I.readByte(),Gt=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],li=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];_t>0&&_t<16?(Oe=Gt[_t-1],ht=li[_t-1]):_t===255&&(Oe=I.readByte()<<8|I.readByte(),ht=I.readByte()<<8|I.readByte())}if(I.readBool()&&I.readBool(),I.readBool()&&(I.readBits(4),I.readBool()&&I.readBits(24)),I.readBool()&&(I.readUEG(),I.readUEG()),I.readBool()){var ei=I.readBits(32),Ti=I.readBits(32);Rt=I.readBool(),mt=Ti,rt=ei*2,kt=mt/rt}}var vi=1;(Oe!==1||ht!==1)&&(vi=Oe/ht);var Et=0,oi=0;if(j===0)Et=1,oi=2-Re;else{var ai=j===3?1:2,zi=j===1?2:1;Et=ai,oi=zi*(2-Re)}var mn=(fe+1)*16,Gi=(2-Re)*((Ae+1)*16);mn-=(Ce+we)*Et,Gi-=(Fe+Ie)*oi;var en=Math.ceil(mn*vi);return I.destroy(),I=null,{profile_string:O,level_string:G,bit_depth:ee,ref_frames:ae,chroma_format:V,chroma_format_string:D.getChromaFormatString(V),frame_rate:{fixed:Rt,fps:kt,fps_den:rt,fps_num:mt},sar_ratio:{width:Oe,height:ht},codec_size:{width:mn,height:Gi},present_size:{width:en,height:Gi}}},D._skipScalingList=function(v,$){for(var I=8,H=8,X=0,O=0;O<$;O++)H!==0&&(X=v.readSEG(),H=(I+X+256)%256),I=H===0?I:H},D.getProfileString=function(v){switch(v){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},D.getLevelString=function(v){return(v/10).toFixed(1)},D.getChromaFormatString=function(v){switch(v){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},D}();ve.default=J},"./src/flv.js":function(Le,ve,re){"use strict";re.r(ve);var ie=re("./src/utils/polyfill.js"),J=re("./src/core/features.js"),D=re("./src/io/loader.js"),v=re("./src/player/flv-player.js"),$=re("./src/player/native-player.js"),I=re("./src/player/player-events.js"),H=re("./src/player/player-errors.js"),X=re("./src/utils/logging-control.js"),O=re("./src/utils/exception.js");ie.default.install();function G(ee,se){var ue=ee;if(ue==null||typeof ue!="object")throw new O.InvalidArgumentException("MediaDataSource must be an javascript object!");if(!ue.hasOwnProperty("type"))throw new O.InvalidArgumentException("MediaDataSource must has type field to indicate video file type!");switch(ue.type){case"flv":return new v.default(ue,se);default:return new $.default(ue,se)}}function j(){return J.default.supportMSEH264Playback()}function V(){return J.default.getFeatureList()}var S={};S.createPlayer=G,S.isSupported=j,S.getFeatureList=V,S.BaseLoader=D.BaseLoader,S.LoaderStatus=D.LoaderStatus,S.LoaderErrors=D.LoaderErrors,S.Events=I.default,S.ErrorTypes=H.ErrorTypes,S.ErrorDetails=H.ErrorDetails,S.FlvPlayer=v.default,S.NativePlayer=$.default,S.LoggingControl=X.default,Object.defineProperty(S,"version",{enumerable:!0,get:function(){return"1.6.2"}}),ve.default=S},"./src/index.js":function(Le,ve,re){Le.exports=re("./src/flv.js").default},"./src/io/fetch-stream-loader.js":function(Le,ve,re){"use strict";re.r(ve);var ie=re("./src/utils/browser.js"),J=re("./src/io/loader.js"),D=re("./src/utils/exception.js"),v=function(){var I=function(X,O){return I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(G,j){G.__proto__=j}||function(G,j){for(var V in j)Object.prototype.hasOwnProperty.call(j,V)&&(G[V]=j[V])},I(X,O)};return function(H,X){if(typeof X!="function"&&X!==null)throw new TypeError("Class extends value "+String(X)+" is not a constructor or null");I(H,X);function O(){this.constructor=H}H.prototype=X===null?Object.create(X):(O.prototype=X.prototype,new O)}}(),$=function(I){v(H,I);function H(X,O){var G=I.call(this,"fetch-stream-loader")||this;return G.TAG="FetchStreamLoader",G._seekHandler=X,G._config=O,G._needStash=!0,G._requestAbort=!1,G._contentLength=null,G._receivedLength=0,G}return H.isSupported=function(){try{var X=ie.default.msedge&&ie.default.version.minor>=15048,O=ie.default.msedge?X:!0;return self.fetch&&self.ReadableStream&&O}catch(G){return!1}},H.prototype.destroy=function(){this.isWorking()&&this.abort(),I.prototype.destroy.call(this)},H.prototype.open=function(X,O){var G=this;this._dataSource=X,this._range=O;var j=X.url;this._config.reuseRedirectedURL&&X.redirectedURL!=null&&(j=X.redirectedURL);var V=this._seekHandler.getConfig(j,O),S=new self.Headers;if(typeof V.headers=="object"){var ee=V.headers;for(var se in ee)ee.hasOwnProperty(se)&&S.append(se,ee[se])}var ue={method:"GET",headers:S,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(typeof this._config.headers=="object")for(var se in this._config.headers)S.append(se,this._config.headers[se]);X.cors===!1&&(ue.mode="same-origin"),X.withCredentials&&(ue.credentials="include"),X.referrerPolicy&&(ue.referrerPolicy=X.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,ue.signal=this._abortController.signal),this._status=J.LoaderStatus.kConnecting,self.fetch(V.url,ue).then(function(U){if(G._requestAbort){G._status=J.LoaderStatus.kIdle,U.body.cancel();return}if(U.ok&&U.status>=200&&U.status<=299){if(U.url!==V.url&&G._onURLRedirect){var Y=G._seekHandler.removeURLParameters(U.url);G._onURLRedirect(Y)}var ae=U.headers.get("Content-Length");return ae!=null&&(G._contentLength=parseInt(ae),G._contentLength!==0&&G._onContentLengthKnown&&G._onContentLengthKnown(G._contentLength)),G._pump.call(G,U.body.getReader())}else if(G._status=J.LoaderStatus.kError,G._onError)G._onError(J.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:U.status,msg:U.statusText});else throw new D.RuntimeException("FetchStreamLoader: Http code invalid, "+U.status+" "+U.statusText)}).catch(function(U){if(!(G._abortController&&G._abortController.signal.aborted))if(G._status=J.LoaderStatus.kError,G._onError)G._onError(J.LoaderErrors.EXCEPTION,{code:-1,msg:U.message});else throw U})},H.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==J.LoaderStatus.kBuffering||!ie.default.chrome)&&this._abortController)try{this._abortController.abort()}catch(X){}},H.prototype._pump=function(X){var O=this;return X.read().then(function(G){if(G.done)if(O._contentLength!==null&&O._receivedLength<O._contentLength){O._status=J.LoaderStatus.kError;var j=J.LoaderErrors.EARLY_EOF,V={code:-1,msg:"Fetch stream meet Early-EOF"};if(O._onError)O._onError(j,V);else throw new D.RuntimeException(V.msg)}else O._status=J.LoaderStatus.kComplete,O._onComplete&&O._onComplete(O._range.from,O._range.from+O._receivedLength-1);else{if(O._abortController&&O._abortController.signal.aborted){O._status=J.LoaderStatus.kComplete;return}else if(O._requestAbort===!0)return O._status=J.LoaderStatus.kComplete,X.cancel();O._status=J.LoaderStatus.kBuffering;var S=G.value.buffer,ee=O._range.from+O._receivedLength;O._receivedLength+=S.byteLength,O._onDataArrival&&O._onDataArrival(S,ee,O._receivedLength),O._pump(X)}}).catch(function(G){if(O._abortController&&O._abortController.signal.aborted){O._status=J.LoaderStatus.kComplete;return}if(!(G.code===11&&ie.default.msedge)){O._status=J.LoaderStatus.kError;var j=0,V=null;if((G.code===19||G.message==="network error")&&(O._contentLength===null||O._contentLength!==null&&O._receivedLength<O._contentLength)?(j=J.LoaderErrors.EARLY_EOF,V={code:G.code,msg:"Fetch stream meet Early-EOF"}):(j=J.LoaderErrors.EXCEPTION,V={code:G.code,msg:G.message}),O._onError)O._onError(j,V);else throw new D.RuntimeException(V.msg)}})},H}(J.BaseLoader);ve.default=$},"./src/io/io-controller.js":function(Le,ve,re){"use strict";re.r(ve);var ie=re("./src/utils/logger.js"),J=re("./src/io/speed-sampler.js"),D=re("./src/io/loader.js"),v=re("./src/io/fetch-stream-loader.js"),$=re("./src/io/xhr-moz-chunked-loader.js"),I=re("./src/io/xhr-range-loader.js"),H=re("./src/io/websocket-loader.js"),X=re("./src/io/range-seek-handler.js"),O=re("./src/io/param-seek-handler.js"),G=re("./src/utils/exception.js"),j=function(){function V(S,ee,se){this.TAG="IOController",this._config=ee,this._extraData=se,this._stashInitialSize=1024*384,ee.stashInitialSize!=null&&ee.stashInitialSize>0&&(this._stashInitialSize=ee.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=1024*1024*3,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,ee.enableStashBuffer===!1&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=S,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(S.url),this._refTotalLength=S.filesize?S.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new J.default,this._speedNormalizeList=[64,128,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return V.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},V.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},V.prototype.isPaused=function(){return this._paused},Object.defineProperty(V.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"extraData",{get:function(){return this._extraData},set:function(ee){this._extraData=ee},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(ee){this._onDataArrival=ee},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(ee){this._onSeeked=ee},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"onError",{get:function(){return this._onError},set:function(ee){this._onError=ee},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"onComplete",{get:function(){return this._onComplete},set:function(ee){this._onComplete=ee},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(ee){this._onRedirect=ee},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(ee){this._onRecoveredEarlyEof=ee},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"hasRedirect",{get:function(){return this._redirectedURL!=null||this._dataSource.redirectedURL!=null},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"currentSpeed",{get:function(){return this._loaderClass===I.default?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),V.prototype._selectSeekHandler=function(){var S=this._config;if(S.seekType==="range")this._seekHandler=new X.default(this._config.rangeLoadZeroStart);else if(S.seekType==="param"){var ee=S.seekParamStart||"bstart",se=S.seekParamEnd||"bend";this._seekHandler=new O.default(ee,se)}else if(S.seekType==="custom"){if(typeof S.customSeekHandler!="function")throw new G.InvalidArgumentException("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new S.customSeekHandler}else throw new G.InvalidArgumentException("Invalid seekType in config: "+S.seekType)},V.prototype._selectLoader=function(){if(this._config.customLoader!=null)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=H.default;else if(v.default.isSupported())this._loaderClass=v.default;else if($.default.isSupported())this._loaderClass=$.default;else if(I.default.isSupported())this._loaderClass=I.default;else throw new G.RuntimeException("Your browser doesn't support xhr with arraybuffer responseType!")},V.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),this._loader.needStashBuffer===!1&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},V.prototype.open=function(S){this._currentRange={from:0,to:-1},S&&(this._currentRange.from=S),this._speedSampler.reset(),S||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},V.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},V.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),this._stashUsed!==0?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},V.prototype.resume=function(){if(this._paused){this._paused=!1;var S=this._resumeFrom;this._resumeFrom=0,this._internalSeek(S,!0)}},V.prototype.seek=function(S){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(S,!0)},V.prototype._internalSeek=function(S,ee){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(ee),this._loader.destroy(),this._loader=null;var se={from:S,to:-1};this._currentRange={from:se.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,se),this._onSeeked&&this._onSeeked()},V.prototype.updateUrl=function(S){if(!S||typeof S!="string"||S.length===0)throw new G.InvalidArgumentException("Url must be a non-empty string!");this._dataSource.url=S},V.prototype._expandBuffer=function(S){for(var ee=this._stashSize;ee+1024*1024*1<S;)ee*=2;if(ee+=1024*1024*1,ee!==this._bufferSize){var se=new ArrayBuffer(ee);if(this._stashUsed>0){var ue=new Uint8Array(this._stashBuffer,0,this._stashUsed),U=new Uint8Array(se,0,ee);U.set(ue,0)}this._stashBuffer=se,this._bufferSize=ee}},V.prototype._normalizeSpeed=function(S){var ee=this._speedNormalizeList,se=ee.length-1,ue=0,U=0,Y=se;if(S<ee[0])return ee[0];for(;U<=Y;){if(ue=U+Math.floor((Y-U)/2),ue===se||S>=ee[ue]&&S<ee[ue+1])return ee[ue];ee[ue]<S?U=ue+1:Y=ue-1}},V.prototype._adjustStashSize=function(S){var ee=0;this._config.isLive||S<512?ee=S:S>=512&&S<=1024?ee=Math.floor(S*1.5):ee=S*2,ee>8192&&(ee=8192);var se=ee*1024+1024*1024*1;this._bufferSize<se&&this._expandBuffer(se),this._stashSize=ee*1024},V.prototype._dispatchChunks=function(S,ee){return this._currentRange.to=ee+S.byteLength-1,this._onDataArrival(S,ee)},V.prototype._onURLRedirect=function(S){this._redirectedURL=S,this._onRedirect&&this._onRedirect(S)},V.prototype._onContentLengthKnown=function(S){S&&this._fullRequestFlag&&(this._totalLength=S,this._fullRequestFlag=!1)},V.prototype._onLoaderChunkArrival=function(S,ee,se){if(!this._onDataArrival)throw new G.IllegalStateException("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(S.byteLength);var ue=this._speedSampler.lastSecondKBps;if(ue!==0){var U=this._normalizeSpeed(ue);this._speedNormalized!==U&&(this._speedNormalized=U,this._adjustStashSize(U))}if(this._enableStash)if(this._stashUsed===0&&this._stashByteStart===0&&(this._stashByteStart=ee),this._stashUsed+S.byteLength<=this._stashSize){var fe=new Uint8Array(this._stashBuffer,0,this._stashSize);fe.set(new Uint8Array(S),this._stashUsed),this._stashUsed+=S.byteLength}else{var fe=new Uint8Array(this._stashBuffer,0,this._bufferSize);if(this._stashUsed>0){var Re=this._stashBuffer.slice(0,this._stashUsed),Y=this._dispatchChunks(Re,this._stashByteStart);if(Y<Re.byteLength){if(Y>0){var Ae=new Uint8Array(Re,Y);fe.set(Ae,0),this._stashUsed=Ae.byteLength,this._stashByteStart+=Y}}else this._stashUsed=0,this._stashByteStart+=Y;this._stashUsed+S.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+S.byteLength),fe=new Uint8Array(this._stashBuffer,0,this._bufferSize)),fe.set(new Uint8Array(S),this._stashUsed),this._stashUsed+=S.byteLength}else{var Y=this._dispatchChunks(S,ee);if(Y<S.byteLength){var ae=S.byteLength-Y;ae>this._bufferSize&&(this._expandBuffer(ae),fe=new Uint8Array(this._stashBuffer,0,this._bufferSize)),fe.set(new Uint8Array(S,Y),0),this._stashUsed+=ae,this._stashByteStart=ee+Y}}}else if(this._stashUsed===0){var Y=this._dispatchChunks(S,ee);if(Y<S.byteLength){var ae=S.byteLength-Y;ae>this._bufferSize&&this._expandBuffer(ae);var fe=new Uint8Array(this._stashBuffer,0,this._bufferSize);fe.set(new Uint8Array(S,Y),0),this._stashUsed+=ae,this._stashByteStart=ee+Y}}else{this._stashUsed+S.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+S.byteLength);var fe=new Uint8Array(this._stashBuffer,0,this._bufferSize);fe.set(new Uint8Array(S),this._stashUsed),this._stashUsed+=S.byteLength;var Y=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart);if(Y<this._stashUsed&&Y>0){var Ae=new Uint8Array(this._stashBuffer,Y);fe.set(Ae,0)}this._stashUsed-=Y,this._stashByteStart+=Y}}},V.prototype._flushStashBuffer=function(S){if(this._stashUsed>0){var ee=this._stashBuffer.slice(0,this._stashUsed),se=this._dispatchChunks(ee,this._stashByteStart),ue=ee.byteLength-se;if(se<ee.byteLength)if(S)ie.default.w(this.TAG,ue+" bytes unconsumed data remain when flush buffer, dropped");else{if(se>0){var U=new Uint8Array(this._stashBuffer,0,this._bufferSize),Y=new Uint8Array(ee,se);U.set(Y,0),this._stashUsed=Y.byteLength,this._stashByteStart+=se}return 0}return this._stashUsed=0,this._stashByteStart=0,ue}return 0},V.prototype._onLoaderComplete=function(S,ee){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},V.prototype._onLoaderError=function(S,ee){switch(ie.default.e(this.TAG,"Loader error, code = "+ee.code+", msg = "+ee.msg),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,S=D.LoaderErrors.UNRECOVERABLE_EARLY_EOF),S){case D.LoaderErrors.EARLY_EOF:{if(!this._config.isLive&&this._totalLength){var se=this._currentRange.to+1;se<this._totalLength&&(ie.default.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(se,!1));return}S=D.LoaderErrors.UNRECOVERABLE_EARLY_EOF;break}case D.LoaderErrors.UNRECOVERABLE_EARLY_EOF:case D.LoaderErrors.CONNECTING_TIMEOUT:case D.LoaderErrors.HTTP_STATUS_CODE_INVALID:case D.LoaderErrors.EXCEPTION:break}if(this._onError)this._onError(S,ee);else throw new G.RuntimeException("IOException: "+ee.msg)},V}();ve.default=j},"./src/io/loader.js":function(Le,ve,re){"use strict";re.r(ve),re.d(ve,{LoaderStatus:function(){return J},LoaderErrors:function(){return D},BaseLoader:function(){return v}});var ie=re("./src/utils/exception.js"),J={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},D={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},v=function(){function $(I){this._type=I||"undefined",this._status=J.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return $.prototype.destroy=function(){this._status=J.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},$.prototype.isWorking=function(){return this._status===J.kConnecting||this._status===J.kBuffering},Object.defineProperty($.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(H){this._onContentLengthKnown=H},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(H){this._onURLRedirect=H},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(H){this._onDataArrival=H},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"onError",{get:function(){return this._onError},set:function(H){this._onError=H},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"onComplete",{get:function(){return this._onComplete},set:function(H){this._onComplete=H},enumerable:!1,configurable:!0}),$.prototype.open=function(I,H){throw new ie.NotImplementedException("Unimplemented abstract function!")},$.prototype.abort=function(){throw new ie.NotImplementedException("Unimplemented abstract function!")},$}()},"./src/io/param-seek-handler.js":function(Le,ve,re){"use strict";re.r(ve);var ie=function(){function J(D,v){this._startName=D,this._endName=v}return J.prototype.getConfig=function(D,v){var $=D;if(v.from!==0||v.to!==-1){var I=!0;$.indexOf("?")===-1&&($+="?",I=!1),I&&($+="&"),$+=this._startName+"="+v.from.toString(),v.to!==-1&&($+="&"+this._endName+"="+v.to.toString())}return{url:$,headers:{}}},J.prototype.removeURLParameters=function(D){var v=D.split("?")[0],$=void 0,I=D.indexOf("?");I!==-1&&($=D.substring(I+1));var H="";if($!=null&&$.length>0)for(var X=$.split("&"),O=0;O<X.length;O++){var G=X[O].split("="),j=O>0;G[0]!==this._startName&&G[0]!==this._endName&&(j&&(H+="&"),H+=X[O])}return H.length===0?v:v+"?"+H},J}();ve.default=ie},"./src/io/range-seek-handler.js":function(Le,ve,re){"use strict";re.r(ve);var ie=function(){function J(D){this._zeroStart=D||!1}return J.prototype.getConfig=function(D,v){var $={};if(v.from!==0||v.to!==-1){var I=void 0;v.to!==-1?I="bytes="+v.from.toString()+"-"+v.to.toString():I="bytes="+v.from.toString()+"-",$.Range=I}else this._zeroStart&&($.Range="bytes=0-");return{url:D,headers:$}},J.prototype.removeURLParameters=function(D){return D},J}();ve.default=ie},"./src/io/speed-sampler.js":function(Le,ve,re){"use strict";re.r(ve);var ie=function(){function J(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return J.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},J.prototype.addBytes=function(D){this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=D,this._totalBytes+=D):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=D,this._totalBytes+=D):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=D,this._totalBytes+=D,this._lastCheckpoint=this._now())},Object.defineProperty(J.prototype,"currentKBps",{get:function(){this.addBytes(0);var v=(this._now()-this._lastCheckpoint)/1e3;return v==0&&(v=1),this._intervalBytes/v/1024},enumerable:!1,configurable:!0}),Object.defineProperty(J.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),this._lastSecondBytes!==0?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(J.prototype,"averageKBps",{get:function(){var v=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/v/1024},enumerable:!1,configurable:!0}),J}();ve.default=ie},"./src/io/websocket-loader.js":function(Le,ve,re){"use strict";re.r(ve);var ie=re("./src/io/loader.js"),J=re("./src/utils/exception.js"),D=function(){var $=function(H,X){return $=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,G){O.__proto__=G}||function(O,G){for(var j in G)Object.prototype.hasOwnProperty.call(G,j)&&(O[j]=G[j])},$(H,X)};return function(I,H){if(typeof H!="function"&&H!==null)throw new TypeError("Class extends value "+String(H)+" is not a constructor or null");$(I,H);function X(){this.constructor=I}I.prototype=H===null?Object.create(H):(X.prototype=H.prototype,new X)}}(),v=function($){D(I,$);function I(){var H=$.call(this,"websocket-loader")||this;return H.TAG="WebSocketLoader",H._needStash=!0,H._ws=null,H._requestAbort=!1,H._receivedLength=0,H}return I.isSupported=function(){try{return typeof self.WebSocket!="undefined"}catch(H){return!1}},I.prototype.destroy=function(){this._ws&&this.abort(),$.prototype.destroy.call(this)},I.prototype.open=function(H){try{var X=this._ws=new self.WebSocket(H.url);X.binaryType="arraybuffer",X.onopen=this._onWebSocketOpen.bind(this),X.onclose=this._onWebSocketClose.bind(this),X.onmessage=this._onWebSocketMessage.bind(this),X.onerror=this._onWebSocketError.bind(this),this._status=ie.LoaderStatus.kConnecting}catch(G){this._status=ie.LoaderStatus.kError;var O={code:G.code,msg:G.message};if(this._onError)this._onError(ie.LoaderErrors.EXCEPTION,O);else throw new J.RuntimeException(O.msg)}},I.prototype.abort=function(){var H=this._ws;H&&(H.readyState===0||H.readyState===1)&&(this._requestAbort=!0,H.close()),this._ws=null,this._status=ie.LoaderStatus.kComplete},I.prototype._onWebSocketOpen=function(H){this._status=ie.LoaderStatus.kBuffering},I.prototype._onWebSocketClose=function(H){if(this._requestAbort===!0){this._requestAbort=!1;return}this._status=ie.LoaderStatus.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)},I.prototype._onWebSocketMessage=function(H){var X=this;if(H.data instanceof ArrayBuffer)this._dispatchArrayBuffer(H.data);else if(H.data instanceof Blob){var O=new FileReader;O.onload=function(){X._dispatchArrayBuffer(O.result)},O.readAsArrayBuffer(H.data)}else{this._status=ie.LoaderStatus.kError;var G={code:-1,msg:"Unsupported WebSocket message type: "+H.data.constructor.name};if(this._onError)this._onError(ie.LoaderErrors.EXCEPTION,G);else throw new J.RuntimeException(G.msg)}},I.prototype._dispatchArrayBuffer=function(H){var X=H,O=this._receivedLength;this._receivedLength+=X.byteLength,this._onDataArrival&&this._onDataArrival(X,O,this._receivedLength)},I.prototype._onWebSocketError=function(H){this._status=ie.LoaderStatus.kError;var X={code:H.code,msg:H.message};if(this._onError)this._onError(ie.LoaderErrors.EXCEPTION,X);else throw new J.RuntimeException(X.msg)},I}(ie.BaseLoader);ve.default=v},"./src/io/xhr-moz-chunked-loader.js":function(Le,ve,re){"use strict";re.r(ve);var ie=re("./src/utils/logger.js"),J=re("./src/io/loader.js"),D=re("./src/utils/exception.js"),v=function(){var I=function(X,O){return I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(G,j){G.__proto__=j}||function(G,j){for(var V in j)Object.prototype.hasOwnProperty.call(j,V)&&(G[V]=j[V])},I(X,O)};return function(H,X){if(typeof X!="function"&&X!==null)throw new TypeError("Class extends value "+String(X)+" is not a constructor or null");I(H,X);function O(){this.constructor=H}H.prototype=X===null?Object.create(X):(O.prototype=X.prototype,new O)}}(),$=function(I){v(H,I);function H(X,O){var G=I.call(this,"xhr-moz-chunked-loader")||this;return G.TAG="MozChunkedLoader",G._seekHandler=X,G._config=O,G._needStash=!0,G._xhr=null,G._requestAbort=!1,G._contentLength=null,G._receivedLength=0,G}return H.isSupported=function(){try{var X=new XMLHttpRequest;return X.open("GET","https://example.com",!0),X.responseType="moz-chunked-arraybuffer",X.responseType==="moz-chunked-arraybuffer"}catch(O){return ie.default.w("MozChunkedLoader",O.message),!1}},H.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),I.prototype.destroy.call(this)},H.prototype.open=function(X,O){this._dataSource=X,this._range=O;var G=X.url;this._config.reuseRedirectedURL&&X.redirectedURL!=null&&(G=X.redirectedURL);var j=this._seekHandler.getConfig(G,O);this._requestURL=j.url;var V=this._xhr=new XMLHttpRequest;if(V.open("GET",j.url,!0),V.responseType="moz-chunked-arraybuffer",V.onreadystatechange=this._onReadyStateChange.bind(this),V.onprogress=this._onProgress.bind(this),V.onloadend=this._onLoadEnd.bind(this),V.onerror=this._onXhrError.bind(this),X.withCredentials&&(V.withCredentials=!0),typeof j.headers=="object"){var S=j.headers;for(var ee in S)S.hasOwnProperty(ee)&&V.setRequestHeader(ee,S[ee])}if(typeof this._config.headers=="object"){var S=this._config.headers;for(var ee in S)S.hasOwnProperty(ee)&&V.setRequestHeader(ee,S[ee])}this._status=J.LoaderStatus.kConnecting,V.send()},H.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=J.LoaderStatus.kComplete},H.prototype._onReadyStateChange=function(X){var O=X.target;if(O.readyState===2){if(O.responseURL!=null&&O.responseURL!==this._requestURL&&this._onURLRedirect){var G=this._seekHandler.removeURLParameters(O.responseURL);this._onURLRedirect(G)}if(O.status!==0&&(O.status<200||O.status>299))if(this._status=J.LoaderStatus.kError,this._onError)this._onError(J.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:O.status,msg:O.statusText});else throw new D.RuntimeException("MozChunkedLoader: Http code invalid, "+O.status+" "+O.statusText);else this._status=J.LoaderStatus.kBuffering}},H.prototype._onProgress=function(X){if(this._status!==J.LoaderStatus.kError){this._contentLength===null&&X.total!==null&&X.total!==0&&(this._contentLength=X.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var O=X.target.response,G=this._range.from+this._receivedLength;this._receivedLength+=O.byteLength,this._onDataArrival&&this._onDataArrival(O,G,this._receivedLength)}},H.prototype._onLoadEnd=function(X){if(this._requestAbort===!0){this._requestAbort=!1;return}else if(this._status===J.LoaderStatus.kError)return;this._status=J.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)},H.prototype._onXhrError=function(X){this._status=J.LoaderStatus.kError;var O=0,G=null;if(this._contentLength&&X.loaded<this._contentLength?(O=J.LoaderErrors.EARLY_EOF,G={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(O=J.LoaderErrors.EXCEPTION,G={code:-1,msg:X.constructor.name+" "+X.type}),this._onError)this._onError(O,G);else throw new D.RuntimeException(G.msg)},H}(J.BaseLoader);ve.default=$},"./src/io/xhr-range-loader.js":function(Le,ve,re){"use strict";re.r(ve);var ie=re("./src/utils/logger.js"),J=re("./src/io/speed-sampler.js"),D=re("./src/io/loader.js"),v=re("./src/utils/exception.js"),$=function(){var H=function(O,G){return H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(j,V){j.__proto__=V}||function(j,V){for(var S in V)Object.prototype.hasOwnProperty.call(V,S)&&(j[S]=V[S])},H(O,G)};return function(X,O){if(typeof O!="function"&&O!==null)throw new TypeError("Class extends value "+String(O)+" is not a constructor or null");H(X,O);function G(){this.constructor=X}X.prototype=O===null?Object.create(O):(G.prototype=O.prototype,new G)}}(),I=function(H){$(X,H);function X(O,G){var j=H.call(this,"xhr-range-loader")||this;return j.TAG="RangeLoader",j._seekHandler=O,j._config=G,j._needStash=!1,j._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],j._currentChunkSizeKB=384,j._currentSpeedNormalized=0,j._zeroSpeedChunkCount=0,j._xhr=null,j._speedSampler=new J.default,j._requestAbort=!1,j._waitForTotalLength=!1,j._totalLengthReceived=!1,j._currentRequestURL=null,j._currentRedirectedURL=null,j._currentRequestRange=null,j._totalLength=null,j._contentLength=null,j._receivedLength=0,j._lastTimeLoaded=0,j}return X.isSupported=function(){try{var O=new XMLHttpRequest;return O.open("GET","https://example.com",!0),O.responseType="arraybuffer",O.responseType==="arraybuffer"}catch(G){return ie.default.w("RangeLoader",G.message),!1}},X.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),H.prototype.destroy.call(this)},Object.defineProperty(X.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),X.prototype.open=function(O,G){this._dataSource=O,this._range=G,this._status=D.LoaderStatus.kConnecting;var j=!1;this._dataSource.filesize!=null&&this._dataSource.filesize!==0&&(j=!0,this._totalLength=this._dataSource.filesize),!this._totalLengthReceived&&!j?(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1})):this._openSubRange()},X.prototype._openSubRange=function(){var O=this._currentChunkSizeKB*1024,G=this._range.from+this._receivedLength,j=G+O;this._contentLength!=null&&j-this._range.from>=this._contentLength&&(j=this._range.from+this._contentLength-1),this._currentRequestRange={from:G,to:j},this._internalOpen(this._dataSource,this._currentRequestRange)},X.prototype._internalOpen=function(O,G){this._lastTimeLoaded=0;var j=O.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?j=this._currentRedirectedURL:O.redirectedURL!=null&&(j=O.redirectedURL));var V=this._seekHandler.getConfig(j,G);this._currentRequestURL=V.url;var S=this._xhr=new XMLHttpRequest;if(S.open("GET",V.url,!0),S.responseType="arraybuffer",S.onreadystatechange=this._onReadyStateChange.bind(this),S.onprogress=this._onProgress.bind(this),S.onload=this._onLoad.bind(this),S.onerror=this._onXhrError.bind(this),O.withCredentials&&(S.withCredentials=!0),typeof V.headers=="object"){var ee=V.headers;for(var se in ee)ee.hasOwnProperty(se)&&S.setRequestHeader(se,ee[se])}if(typeof this._config.headers=="object"){var ee=this._config.headers;for(var se in ee)ee.hasOwnProperty(se)&&S.setRequestHeader(se,ee[se])}S.send()},X.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=D.LoaderStatus.kComplete},X.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},X.prototype._onReadyStateChange=function(O){var G=O.target;if(G.readyState===2){if(G.responseURL!=null){var j=this._seekHandler.removeURLParameters(G.responseURL);G.responseURL!==this._currentRequestURL&&j!==this._currentRedirectedURL&&(this._currentRedirectedURL=j,this._onURLRedirect&&this._onURLRedirect(j))}if(G.status>=200&&G.status<=299){if(this._waitForTotalLength)return;this._status=D.LoaderStatus.kBuffering}else if(this._status=D.LoaderStatus.kError,this._onError)this._onError(D.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:G.status,msg:G.statusText});else throw new v.RuntimeException("RangeLoader: Http code invalid, "+G.status+" "+G.statusText)}},X.prototype._onProgress=function(O){if(this._status!==D.LoaderStatus.kError){if(this._contentLength===null){var G=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,G=!0;var j=O.total;this._internalAbort(),j!=null&j!==0&&(this._totalLength=j)}if(this._range.to===-1?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,G){this._openSubRange();return}this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var V=O.loaded-this._lastTimeLoaded;this._lastTimeLoaded=O.loaded,this._speedSampler.addBytes(V)}},X.prototype._normalizeSpeed=function(O){var G=this._chunkSizeKBList,j=G.length-1,V=0,S=0,ee=j;if(O<G[0])return G[0];for(;S<=ee;){if(V=S+Math.floor((ee-S)/2),V===j||O>=G[V]&&O<G[V+1])return G[V];G[V]<O?S=V+1:ee=V-1}},X.prototype._onLoad=function(O){if(this._status!==D.LoaderStatus.kError){if(this._waitForTotalLength){this._waitForTotalLength=!1;return}this._lastTimeLoaded=0;var G=this._speedSampler.lastSecondKBps;if(G===0&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(G=this._speedSampler.currentKBps)),G!==0){var j=this._normalizeSpeed(G);this._currentSpeedNormalized!==j&&(this._currentSpeedNormalized=j,this._currentChunkSizeKB=j)}var V=O.target.response,S=this._range.from+this._receivedLength;this._receivedLength+=V.byteLength;var ee=!1;this._contentLength!=null&&this._receivedLength<this._contentLength?this._openSubRange():ee=!0,this._onDataArrival&&this._onDataArrival(V,S,this._receivedLength),ee&&(this._status=D.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},X.prototype._onXhrError=function(O){this._status=D.LoaderStatus.kError;var G=0,j=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(G=D.LoaderErrors.EARLY_EOF,j={code:-1,msg:"RangeLoader meet Early-Eof"}):(G=D.LoaderErrors.EXCEPTION,j={code:-1,msg:O.constructor.name+" "+O.type}),this._onError)this._onError(G,j);else throw new v.RuntimeException(j.msg)},X}(D.BaseLoader);ve.default=I},"./src/player/flv-player.js":function(Le,ve,re){"use strict";re.r(ve);var ie=re("./node_modules/events/events.js"),J=re.n(ie),D=re("./src/utils/logger.js"),v=re("./src/utils/browser.js"),$=re("./src/player/player-events.js"),I=re("./src/core/transmuxer.js"),H=re("./src/core/transmuxing-events.js"),X=re("./src/core/mse-controller.js"),O=re("./src/core/mse-events.js"),G=re("./src/player/player-errors.js"),j=re("./src/config.js"),V=re("./src/utils/exception.js"),S=function(){function ee(se,ue){if(this.TAG="FlvPlayer",this._type="FlvPlayer",this._emitter=new(J()),this._config=(0,j.createDefaultConfig)(),typeof ue=="object"&&Object.assign(this._config,ue),se.type.toLowerCase()!=="flv")throw new V.InvalidArgumentException("FlvPlayer requires an flv MediaDataSource input!");se.isLive===!0&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=se,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;var U=v.default.chrome&&(v.default.version.major<50||v.default.version.major===50&&v.default.version.build<2661);this._alwaysSeekKeyframe=!!(U||v.default.msedge||v.default.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}return ee.prototype.destroy=function(){this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},ee.prototype.on=function(se,ue){var U=this;se===$.default.MEDIA_INFO?this._mediaInfo!=null&&Promise.resolve().then(function(){U._emitter.emit($.default.MEDIA_INFO,U.mediaInfo)}):se===$.default.STATISTICS_INFO&&this._statisticsInfo!=null&&Promise.resolve().then(function(){U._emitter.emit($.default.STATISTICS_INFO,U.statisticsInfo)}),this._emitter.addListener(se,ue)},ee.prototype.off=function(se,ue){this._emitter.removeListener(se,ue)},ee.prototype.attachMediaElement=function(se){var ue=this;if(this._mediaElement=se,se.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),se.addEventListener("seeking",this.e.onvSeeking),se.addEventListener("canplay",this.e.onvCanPlay),se.addEventListener("stalled",this.e.onvStalled),se.addEventListener("progress",this.e.onvProgress),this._msectl=new X.default(this._config),this._msectl.on(O.default.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(O.default.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(O.default.SOURCE_OPEN,function(){ue._mseSourceOpened=!0,ue._hasPendingLoad&&(ue._hasPendingLoad=!1,ue.load())}),this._msectl.on(O.default.ERROR,function(U){ue._emitter.emit($.default.ERROR,G.ErrorTypes.MEDIA_ERROR,G.ErrorDetails.MEDIA_MSE_ERROR,U)}),this._msectl.attachMediaElement(se),this._pendingSeekTime!=null)try{se.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(U){}},ee.prototype.detachMediaElement=function(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)},ee.prototype.load=function(){var se=this;if(!this._mediaElement)throw new V.IllegalStateException("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new V.IllegalStateException("FlvPlayer.load() has been called, please call unload() first!");if(!this._hasPendingLoad){if(this._config.deferLoadAfterSourceOpen&&this._mseSourceOpened===!1){this._hasPendingLoad=!0;return}this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new I.default(this._mediaDataSource,this._config),this._transmuxer.on(H.default.INIT_SEGMENT,function(ue,U){se._msectl.appendInitSegment(U)}),this._transmuxer.on(H.default.MEDIA_SEGMENT,function(ue,U){if(se._msectl.appendMediaSegment(U),se._config.lazyLoad&&!se._config.isLive){var Y=se._mediaElement.currentTime;U.info.endDts>=(Y+se._config.lazyLoadMaxDuration)*1e3&&se._progressChecker==null&&(D.default.v(se.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),se._suspendTransmuxer())}}),this._transmuxer.on(H.default.LOADING_COMPLETE,function(){se._msectl.endOfStream(),se._emitter.emit($.default.LOADING_COMPLETE)}),this._transmuxer.on(H.default.RECOVERED_EARLY_EOF,function(){se._emitter.emit($.default.RECOVERED_EARLY_EOF)}),this._transmuxer.on(H.default.IO_ERROR,function(ue,U){se._emitter.emit($.default.ERROR,G.ErrorTypes.NETWORK_ERROR,ue,U)}),this._transmuxer.on(H.default.DEMUX_ERROR,function(ue,U){se._emitter.emit($.default.ERROR,G.ErrorTypes.MEDIA_ERROR,ue,{code:-1,msg:U})}),this._transmuxer.on(H.default.MEDIA_INFO,function(ue){se._mediaInfo=ue,se._emitter.emit($.default.MEDIA_INFO,Object.assign({},ue))}),this._transmuxer.on(H.default.METADATA_ARRIVED,function(ue){se._emitter.emit($.default.METADATA_ARRIVED,ue)}),this._transmuxer.on(H.default.SCRIPTDATA_ARRIVED,function(ue){se._emitter.emit($.default.SCRIPTDATA_ARRIVED,ue)}),this._transmuxer.on(H.default.STATISTICS_INFO,function(ue){se._statisticsInfo=se._fillStatisticsInfo(ue),se._emitter.emit($.default.STATISTICS_INFO,Object.assign({},se._statisticsInfo))}),this._transmuxer.on(H.default.RECOMMEND_SEEKPOINT,function(ue){se._mediaElement&&!se._config.accurateSeek&&(se._requestSetTime=!0,se._mediaElement.currentTime=ue/1e3)}),this._transmuxer.open()}},ee.prototype.unload=function(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)},ee.prototype.play=function(){return this._mediaElement.play()},ee.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(ee.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(ue){this._mediaElement.volume=ue},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(ue){this._mediaElement.muted=ue},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(ue){this._mediaElement?this._internalSeek(ue):this._pendingSeekTime=ue},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"mediaInfo",{get:function(){return Object.assign({},this._mediaInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(ee.prototype,"statisticsInfo",{get:function(){return this._statisticsInfo==null&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)},enumerable:!1,configurable:!0}),ee.prototype._fillStatisticsInfo=function(se){if(se.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return se;var ue=!0,U=0,Y=0;if(this._mediaElement.getVideoPlaybackQuality){var ae=this._mediaElement.getVideoPlaybackQuality();U=ae.totalVideoFrames,Y=ae.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(U=this._mediaElement.webkitDecodedFrameCount,Y=this._mediaElement.webkitDroppedFrameCount):ue=!1;return ue&&(se.decodedFrames=U,se.droppedFrames=Y),se},ee.prototype._onmseUpdateEnd=function(){if(!(!this._config.lazyLoad||this._config.isLive)){for(var se=this._mediaElement.buffered,ue=this._mediaElement.currentTime,U=0,Y=0,ae=0;ae<se.length;ae++){var fe=se.start(ae),Ae=se.end(ae);if(fe<=ue&&ue<Ae){U=fe,Y=Ae;break}}Y>=ue+this._config.lazyLoadMaxDuration&&this._progressChecker==null&&(D.default.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}},ee.prototype._onmseBufferFull=function(){D.default.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._progressChecker==null&&this._suspendTransmuxer()},ee.prototype._suspendTransmuxer=function(){this._transmuxer&&(this._transmuxer.pause(),this._progressChecker==null&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))},ee.prototype._checkProgressAndResume=function(){for(var se=this._mediaElement.currentTime,ue=this._mediaElement.buffered,U=!1,Y=0;Y<ue.length;Y++){var ae=ue.start(Y),fe=ue.end(Y);if(se>=ae&&se<fe){se>=fe-this._config.lazyLoadRecoverDuration&&(U=!0);break}}U&&(window.clearInterval(this._progressChecker),this._progressChecker=null,U&&(D.default.v(this.TAG,"Continue loading from paused position"),this._transmuxer.resume()))},ee.prototype._isTimepointBuffered=function(se){for(var ue=this._mediaElement.buffered,U=0;U<ue.length;U++){var Y=ue.start(U),ae=ue.end(U);if(se>=Y&&se<ae)return!0}return!1},ee.prototype._internalSeek=function(se){var ue=this._isTimepointBuffered(se),U=!1,Y=0;if(se<1&&this._mediaElement.buffered.length>0){var ae=this._mediaElement.buffered.start(0);(ae<1&&se<ae||v.default.safari)&&(U=!0,Y=v.default.safari?.1:ae)}if(U)this._requestSetTime=!0,this._mediaElement.currentTime=Y;else if(ue){if(!this._alwaysSeekKeyframe)this._requestSetTime=!0,this._mediaElement.currentTime=se;else{var fe=this._msectl.getNearestKeyframe(Math.floor(se*1e3));this._requestSetTime=!0,fe!=null?this._mediaElement.currentTime=fe.dts/1e3:this._mediaElement.currentTime=se}this._progressChecker!=null&&this._checkProgressAndResume()}else this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(se),this._transmuxer.seek(Math.floor(se*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=se)},ee.prototype._checkAndApplyUnbufferedSeekpoint=function(){if(this._seekpointRecord)if(this._seekpointRecord.recordTime<=this._now()-100){var se=this._mediaElement.currentTime;this._seekpointRecord=null,this._isTimepointBuffered(se)||(this._progressChecker!=null&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(se),this._transmuxer.seek(Math.floor(se*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=se))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},ee.prototype._checkAndResumeStuckPlayback=function(se){var ue=this._mediaElement;if(se||!this._receivedCanPlay||ue.readyState<2){var U=ue.buffered;U.length>0&&ue.currentTime<U.start(0)&&(D.default.w(this.TAG,"Playback seems stuck at "+ue.currentTime+", seek to "+U.start(0)),this._requestSetTime=!0,this._mediaElement.currentTime=U.start(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress))}else this._mediaElement.removeEventListener("progress",this.e.onvProgress)},ee.prototype._onvLoadedMetadata=function(se){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)},ee.prototype._onvSeeking=function(se){var ue=this._mediaElement.currentTime,U=this._mediaElement.buffered;if(this._requestSetTime){this._requestSetTime=!1;return}if(ue<1&&U.length>0){var Y=U.start(0);if(Y<1&&ue<Y||v.default.safari){this._requestSetTime=!0,this._mediaElement.currentTime=v.default.safari?.1:Y;return}}if(this._isTimepointBuffered(ue)){if(this._alwaysSeekKeyframe){var ae=this._msectl.getNearestKeyframe(Math.floor(ue*1e3));ae!=null&&(this._requestSetTime=!0,this._mediaElement.currentTime=ae.dts/1e3)}this._progressChecker!=null&&this._checkProgressAndResume();return}this._seekpointRecord={seekPoint:ue,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},ee.prototype._onvCanPlay=function(se){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)},ee.prototype._onvStalled=function(se){this._checkAndResumeStuckPlayback(!0)},ee.prototype._onvProgress=function(se){this._checkAndResumeStuckPlayback()},ee}();ve.default=S},"./src/player/native-player.js":function(Le,ve,re){"use strict";re.r(ve);var ie=re("./node_modules/events/events.js"),J=re.n(ie),D=re("./src/player/player-events.js"),v=re("./src/config.js"),$=re("./src/utils/exception.js"),I=function(){function H(X,O){if(this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new(J()),this._config=(0,v.createDefaultConfig)(),typeof O=="object"&&Object.assign(this._config,O),X.type.toLowerCase()==="flv")throw new $.InvalidArgumentException("NativePlayer does't support flv MediaDataSource input!");if(X.hasOwnProperty("segments"))throw new $.InvalidArgumentException("NativePlayer("+X.type+") doesn't support multipart playback!");this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=X,this._mediaElement=null}return H.prototype.destroy=function(){this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},H.prototype.on=function(X,O){var G=this;X===D.default.MEDIA_INFO?this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){G._emitter.emit(D.default.MEDIA_INFO,G.mediaInfo)}):X===D.default.STATISTICS_INFO&&this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){G._emitter.emit(D.default.STATISTICS_INFO,G.statisticsInfo)}),this._emitter.addListener(X,O)},H.prototype.off=function(X,O){this._emitter.removeListener(X,O)},H.prototype.attachMediaElement=function(X){if(this._mediaElement=X,X.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._pendingSeekTime!=null)try{X.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(O){}},H.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},H.prototype.load=function(){if(!this._mediaElement)throw new $.IllegalStateException("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},H.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},H.prototype.play=function(){return this._mediaElement.play()},H.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(H.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(O){this._mediaElement.volume=O},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(O){this._mediaElement.muted=O},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(O){this._mediaElement?this._mediaElement.currentTime=O:this._pendingSeekTime=O},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"mediaInfo",{get:function(){var O=this._mediaElement instanceof HTMLAudioElement?"audio/":"video/",G={mimeType:O+this._mediaDataSource.type};return this._mediaElement&&(G.duration=Math.floor(this._mediaElement.duration*1e3),this._mediaElement instanceof HTMLVideoElement&&(G.width=this._mediaElement.videoWidth,G.height=this._mediaElement.videoHeight)),G},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"statisticsInfo",{get:function(){var O={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return O;var G=!0,j=0,V=0;if(this._mediaElement.getVideoPlaybackQuality){var S=this._mediaElement.getVideoPlaybackQuality();j=S.totalVideoFrames,V=S.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(j=this._mediaElement.webkitDecodedFrameCount,V=this._mediaElement.webkitDroppedFrameCount):G=!1;return G&&(O.decodedFrames=j,O.droppedFrames=V),O},enumerable:!1,configurable:!0}),H.prototype._onvLoadedMetadata=function(X){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(D.default.MEDIA_INFO,this.mediaInfo)},H.prototype._reportStatisticsInfo=function(){this._emitter.emit(D.default.STATISTICS_INFO,this.statisticsInfo)},H}();ve.default=I},"./src/player/player-errors.js":function(Le,ve,re){"use strict";re.r(ve),re.d(ve,{ErrorTypes:function(){return D},ErrorDetails:function(){return v}});var ie=re("./src/io/loader.js"),J=re("./src/demux/demux-errors.js"),D={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},v={NETWORK_EXCEPTION:ie.LoaderErrors.EXCEPTION,NETWORK_STATUS_CODE_INVALID:ie.LoaderErrors.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:ie.LoaderErrors.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:ie.LoaderErrors.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:J.default.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:J.default.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:J.default.CODEC_UNSUPPORTED}},"./src/player/player-events.js":function(Le,ve,re){"use strict";re.r(ve);var ie={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info"};ve.default=ie},"./src/remux/aac-silent.js":function(Le,ve,re){"use strict";re.r(ve);var ie=function(){function J(){}return J.getSilentFrame=function(D,v){if(D==="mp4a.40.2"){if(v===1)return new Uint8Array([0,200,0,128,35,128]);if(v===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(v===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(v===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(v===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(v===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(v===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(v===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(v===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},J}();ve.default=ie},"./src/remux/mp4-generator.js":function(Le,ve,re){"use strict";re.r(ve);var ie=function(){function J(){}return J.init=function(){J.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[]};for(var D in J.types)J.types.hasOwnProperty(D)&&(J.types[D]=[D.charCodeAt(0),D.charCodeAt(1),D.charCodeAt(2),D.charCodeAt(3)]);var v=J.constants={};v.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),v.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),v.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),v.STSC=v.STCO=v.STTS,v.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),v.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),v.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),v.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),v.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),v.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},J.box=function(D){for(var v=8,$=null,I=Array.prototype.slice.call(arguments,1),H=I.length,X=0;X<H;X++)v+=I[X].byteLength;$=new Uint8Array(v),$[0]=v>>>24&255,$[1]=v>>>16&255,$[2]=v>>>8&255,$[3]=v&255,$.set(D,4);for(var O=8,X=0;X<H;X++)$.set(I[X],O),O+=I[X].byteLength;return $},J.generateInitSegment=function(D){var v=J.box(J.types.ftyp,J.constants.FTYP),$=J.moov(D),I=new Uint8Array(v.byteLength+$.byteLength);return I.set(v,0),I.set($,v.byteLength),I},J.moov=function(D){var v=J.mvhd(D.timescale,D.duration),$=J.trak(D),I=J.mvex(D);return J.box(J.types.moov,v,$,I)},J.mvhd=function(D,v){return J.box(J.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,D>>>24&255,D>>>16&255,D>>>8&255,D&255,v>>>24&255,v>>>16&255,v>>>8&255,v&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},J.trak=function(D){return J.box(J.types.trak,J.tkhd(D),J.mdia(D))},J.tkhd=function(D){var v=D.id,$=D.duration,I=D.presentWidth,H=D.presentHeight;return J.box(J.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,v>>>24&255,v>>>16&255,v>>>8&255,v&255,0,0,0,0,$>>>24&255,$>>>16&255,$>>>8&255,$&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,I>>>8&255,I&255,0,0,H>>>8&255,H&255,0,0]))},J.mdia=function(D){return J.box(J.types.mdia,J.mdhd(D),J.hdlr(D),J.minf(D))},J.mdhd=function(D){var v=D.timescale,$=D.duration;return J.box(J.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,v>>>24&255,v>>>16&255,v>>>8&255,v&255,$>>>24&255,$>>>16&255,$>>>8&255,$&255,85,196,0,0]))},J.hdlr=function(D){var v=null;return D.type==="audio"?v=J.constants.HDLR_AUDIO:v=J.constants.HDLR_VIDEO,J.box(J.types.hdlr,v)},J.minf=function(D){var v=null;return D.type==="audio"?v=J.box(J.types.smhd,J.constants.SMHD):v=J.box(J.types.vmhd,J.constants.VMHD),J.box(J.types.minf,v,J.dinf(),J.stbl(D))},J.dinf=function(){var D=J.box(J.types.dinf,J.box(J.types.dref,J.constants.DREF));return D},J.stbl=function(D){var v=J.box(J.types.stbl,J.stsd(D),J.box(J.types.stts,J.constants.STTS),J.box(J.types.stsc,J.constants.STSC),J.box(J.types.stsz,J.constants.STSZ),J.box(J.types.stco,J.constants.STCO));return v},J.stsd=function(D){return D.type==="audio"?D.codec==="mp3"?J.box(J.types.stsd,J.constants.STSD_PREFIX,J.mp3(D)):J.box(J.types.stsd,J.constants.STSD_PREFIX,J.mp4a(D)):J.box(J.types.stsd,J.constants.STSD_PREFIX,J.avc1(D))},J.mp3=function(D){var v=D.channelCount,$=D.audioSampleRate,I=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,v,0,16,0,0,0,0,$>>>8&255,$&255,0,0]);return J.box(J.types[".mp3"],I)},J.mp4a=function(D){var v=D.channelCount,$=D.audioSampleRate,I=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,v,0,16,0,0,0,0,$>>>8&255,$&255,0,0]);return J.box(J.types.mp4a,I,J.esds(D))},J.esds=function(D){var v=D.config||[],$=v.length,I=new Uint8Array([0,0,0,0,3,23+$,0,1,0,4,15+$,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([$]).concat(v).concat([6,1,2]));return J.box(J.types.esds,I)},J.avc1=function(D){var v=D.avcc,$=D.codecWidth,I=D.codecHeight,H=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,$>>>8&255,$&255,I>>>8&255,I&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return J.box(J.types.avc1,H,J.box(J.types.avcC,v))},J.mvex=function(D){return J.box(J.types.mvex,J.trex(D))},J.trex=function(D){var v=D.id,$=new Uint8Array([0,0,0,0,v>>>24&255,v>>>16&255,v>>>8&255,v&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return J.box(J.types.trex,$)},J.moof=function(D,v){return J.box(J.types.moof,J.mfhd(D.sequenceNumber),J.traf(D,v))},J.mfhd=function(D){var v=new Uint8Array([0,0,0,0,D>>>24&255,D>>>16&255,D>>>8&255,D&255]);return J.box(J.types.mfhd,v)},J.traf=function(D,v){var $=D.id,I=J.box(J.types.tfhd,new Uint8Array([0,0,0,0,$>>>24&255,$>>>16&255,$>>>8&255,$&255])),H=J.box(J.types.tfdt,new Uint8Array([0,0,0,0,v>>>24&255,v>>>16&255,v>>>8&255,v&255])),X=J.sdtp(D),O=J.trun(D,X.byteLength+16+16+8+16+8+8);return J.box(J.types.traf,I,H,O,X)},J.sdtp=function(D){for(var v=D.samples||[],$=v.length,I=new Uint8Array(4+$),H=0;H<$;H++){var X=v[H].flags;I[H+4]=X.isLeading<<6|X.dependsOn<<4|X.isDependedOn<<2|X.hasRedundancy}return J.box(J.types.sdtp,I)},J.trun=function(D,v){var $=D.samples||[],I=$.length,H=12+16*I,X=new Uint8Array(H);v+=8+H,X.set([0,0,15,1,I>>>24&255,I>>>16&255,I>>>8&255,I&255,v>>>24&255,v>>>16&255,v>>>8&255,v&255],0);for(var O=0;O<I;O++){var G=$[O].duration,j=$[O].size,V=$[O].flags,S=$[O].cts;X.set([G>>>24&255,G>>>16&255,G>>>8&255,G&255,j>>>24&255,j>>>16&255,j>>>8&255,j&255,V.isLeading<<2|V.dependsOn,V.isDependedOn<<6|V.hasRedundancy<<4|V.isNonSync,0,0,S>>>24&255,S>>>16&255,S>>>8&255,S&255],12+16*O)}return J.box(J.types.trun,X)},J.mdat=function(D){return J.box(J.types.mdat,D)},J}();ie.init(),ve.default=ie},"./src/remux/mp4-remuxer.js":function(Le,ve,re){"use strict";re.r(ve);var ie=re("./src/utils/logger.js"),J=re("./src/remux/mp4-generator.js"),D=re("./src/remux/aac-silent.js"),v=re("./src/utils/browser.js"),$=re("./src/core/media-segment-info.js"),I=re("./src/utils/exception.js"),H=function(){function X(O){this.TAG="MP4Remuxer",this._config=O,this._isLive=O.isLive===!0,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=Infinity,this._videoDtsBase=Infinity,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new $.MediaSegmentInfoList("audio"),this._videoSegmentInfoList=new $.MediaSegmentInfoList("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!!(v.default.chrome&&(v.default.version.major<50||v.default.version.major===50&&v.default.version.build<2661)),this._fillSilentAfterSeek=v.default.msedge||v.default.msie,this._mp3UseMpegAudio=!v.default.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return X.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},X.prototype.bindDataSource=function(O){return O.onDataAvailable=this.remux.bind(this),O.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(X.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(G){this._onInitSegment=G},enumerable:!1,configurable:!0}),Object.defineProperty(X.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(G){this._onMediaSegment=G},enumerable:!1,configurable:!0}),X.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},X.prototype.seek=function(O){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},X.prototype.remux=function(O,G){if(!this._onMediaSegment)throw new I.IllegalStateException("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(O,G),this._remuxVideo(G),this._remuxAudio(O)},X.prototype._onTrackMetadataReceived=function(O,G){var j=null,V="mp4",S=G.codec;if(O==="audio")this._audioMeta=G,G.codec==="mp3"&&this._mp3UseMpegAudio?(V="mpeg",S="",j=new Uint8Array):j=J.default.generateInitSegment(G);else if(O==="video")this._videoMeta=G,j=J.default.generateInitSegment(G);else return;if(!this._onInitSegment)throw new I.IllegalStateException("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(O,{type:O,data:j.buffer,codec:S,container:O+"/"+V,mediaDuration:G.duration})},X.prototype._calculateDtsBase=function(O,G){this._dtsBaseInited||(O.samples&&O.samples.length&&(this._audioDtsBase=O.samples[0].dts),G.samples&&G.samples.length&&(this._videoDtsBase=G.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},X.prototype.flushStashedSamples=function(){var O=this._videoStashedLastSample,G=this._audioStashedLastSample,j={type:"video",id:1,sequenceNumber:0,samples:[],length:0};O!=null&&(j.samples.push(O),j.length=O.length);var V={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};G!=null&&(V.samples.push(G),V.length=G.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(j,!0),this._remuxAudio(V,!0)},X.prototype._remuxAudio=function(O,G){if(this._audioMeta!=null){var j=O,V=j.samples,S=void 0,ee=-1,se=-1,ue=-1,U=this._audioMeta.refSampleDuration,Y=this._audioMeta.codec==="mp3"&&this._mp3UseMpegAudio,ae=this._dtsBaseInited&&this._audioNextDts===void 0,fe=!1;if(!(!V||V.length===0)&&!(V.length===1&&!G)){var Ae=0,Re=null,Ce=0;Y?(Ae=0,Ce=j.length):(Ae=8,Ce=8+j.length);var we=null;if(V.length>1&&(we=V.pop(),Ce-=we.length),this._audioStashedLastSample!=null){var Fe=this._audioStashedLastSample;this._audioStashedLastSample=null,V.unshift(Fe),Ce+=Fe.length}we!=null&&(this._audioStashedLastSample=we);var Ie=V[0].dts-this._dtsBase;if(this._audioNextDts)S=Ie-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())S=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&this._audioMeta.originalCodec!=="mp3"&&(fe=!0);else{var $e=this._audioSegmentInfoList.getLastSampleBefore(Ie);if($e!=null){var Oe=Ie-($e.originalDts+$e.duration);Oe<=3&&(Oe=0);var ht=$e.dts+$e.duration+Oe;S=Ie-ht}else S=0}if(fe){var kt=Ie-S,Rt=this._videoSegmentInfoList.getLastSegmentBefore(Ie);if(Rt!=null&&Rt.beginDts<kt){var mt=D.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);if(mt){var rt=Rt.beginDts,Kt=kt-Rt.beginDts;ie.default.v(this.TAG,"InsertPrefixSilentAudio: dts: "+rt+", duration: "+Kt),V.unshift({unit:mt,dts:rt,pts:rt}),Ce+=mt.byteLength}}else fe=!1}for(var _t=[],Gt=0;Gt<V.length;Gt++){var Fe=V[Gt],li=Fe.unit,ei=Fe.dts-this._dtsBase,rt=ei,Ti=!1,vi=null,Et=0;if(!(ei<-.001)){if(this._audioMeta.codec!=="mp3"){var oi=ei,ai=3;if(this._audioNextDts&&(oi=this._audioNextDts),S=ei-oi,S<=-ai*U){ie.default.w(this.TAG,"Dropping 1 audio frame (originalDts: "+ei+" ms ,curRefDts: "+oi+" ms)  due to dtsCorrection: "+S+" ms overlap.");continue}else if(S>=ai*U&&this._fillAudioTimestampGap&&!v.default.safari){Ti=!0;var zi=Math.floor(S/U);ie.default.w(this.TAG,`Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.
`+("originalDts: "+ei+" ms, curRefDts: "+oi+" ms, ")+("dtsCorrection: "+Math.round(S)+" ms, generate: "+zi+" frames")),rt=Math.floor(oi),Et=Math.floor(oi+U)-rt;var mt=D.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);mt==null&&(ie.default.w(this.TAG,"Unable to generate silent frame for "+(this._audioMeta.originalCodec+" with "+this._audioMeta.channelCount+" channels, repeat last frame")),mt=li),vi=[];for(var mn=0;mn<zi;mn++){oi=oi+U;var Gi=Math.floor(oi),en=Math.floor(oi+U)-Gi,ln={dts:Gi,pts:Gi,cts:0,unit:mt,size:mt.byteLength,duration:en,originalDts:ei,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};vi.push(ln),Ce+=ln.size}this._audioNextDts=oi+U}else rt=Math.floor(oi),Et=Math.floor(oi+U)-rt,this._audioNextDts=oi+U}else{if(rt=ei-S,Gt!==V.length-1){var gt=V[Gt+1].dts-this._dtsBase-S;Et=gt-rt}else if(we!=null){var gt=we.dts-this._dtsBase-S;Et=gt-rt}else _t.length>=1?Et=_t[_t.length-1].duration:Et=Math.floor(U);this._audioNextDts=rt+Et}ee===-1&&(ee=rt),_t.push({dts:rt,pts:rt,cts:0,unit:Fe.unit,size:Fe.unit.byteLength,duration:Et,originalDts:ei,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),Ti&&_t.push.apply(_t,vi)}}if(_t.length===0){j.samples=[],j.length=0;return}Y?Re=new Uint8Array(Ce):(Re=new Uint8Array(Ce),Re[0]=Ce>>>24&255,Re[1]=Ce>>>16&255,Re[2]=Ce>>>8&255,Re[3]=Ce&255,Re.set(J.default.types.mdat,4));for(var Gt=0;Gt<_t.length;Gt++){var li=_t[Gt].unit;Re.set(li,Ae),Ae+=li.byteLength}var Ai=_t[_t.length-1];se=Ai.dts+Ai.duration;var ki=new $.MediaSegmentInfo;ki.beginDts=ee,ki.endDts=se,ki.beginPts=ee,ki.endPts=se,ki.originalBeginDts=_t[0].originalDts,ki.originalEndDts=Ai.originalDts+Ai.duration,ki.firstSample=new $.SampleInfo(_t[0].dts,_t[0].pts,_t[0].duration,_t[0].originalDts,!1),ki.lastSample=new $.SampleInfo(Ai.dts,Ai.pts,Ai.duration,Ai.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(ki),j.samples=_t,j.sequenceNumber++;var ui=null;Y?ui=new Uint8Array:ui=J.default.moof(j,ee),j.samples=[],j.length=0;var Ln={type:"audio",data:this._mergeBoxes(ui,Re).buffer,sampleCount:_t.length,info:ki};Y&&ae&&(Ln.timestampOffset=ee),this._onMediaSegment("audio",Ln)}}},X.prototype._remuxVideo=function(O,G){if(this._videoMeta!=null){var j=O,V=j.samples,S=void 0,ee=-1,se=-1,ue=-1,U=-1;if(!(!V||V.length===0)&&!(V.length===1&&!G)){var Y=8,ae=null,fe=8+O.length,Ae=null;if(V.length>1&&(Ae=V.pop(),fe-=Ae.length),this._videoStashedLastSample!=null){var Re=this._videoStashedLastSample;this._videoStashedLastSample=null,V.unshift(Re),fe+=Re.length}Ae!=null&&(this._videoStashedLastSample=Ae);var Ce=V[0].dts-this._dtsBase;if(this._videoNextDts)S=Ce-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())S=0;else{var we=this._videoSegmentInfoList.getLastSampleBefore(Ce);if(we!=null){var Fe=Ce-(we.originalDts+we.duration);Fe<=3&&(Fe=0);var Ie=we.dts+we.duration+Fe;S=Ce-Ie}else S=0}for(var $e=new $.MediaSegmentInfo,Oe=[],ht=0;ht<V.length;ht++){var Re=V[ht],kt=Re.dts-this._dtsBase,Rt=Re.isKeyframe,mt=kt-S,rt=Re.cts,Kt=mt+rt;ee===-1&&(ee=mt,ue=Kt);var _t=0;if(ht!==V.length-1){var Gt=V[ht+1].dts-this._dtsBase-S;_t=Gt-mt}else if(Ae!=null){var Gt=Ae.dts-this._dtsBase-S;_t=Gt-mt}else Oe.length>=1?_t=Oe[Oe.length-1].duration:_t=Math.floor(this._videoMeta.refSampleDuration);if(Rt){var li=new $.SampleInfo(mt,Kt,_t,Re.dts,!0);li.fileposition=Re.fileposition,$e.appendSyncPoint(li)}Oe.push({dts:mt,pts:Kt,cts:rt,units:Re.units,size:Re.length,isKeyframe:Rt,duration:_t,originalDts:kt,flags:{isLeading:0,dependsOn:Rt?2:1,isDependedOn:Rt?1:0,hasRedundancy:0,isNonSync:Rt?0:1}})}ae=new Uint8Array(fe),ae[0]=fe>>>24&255,ae[1]=fe>>>16&255,ae[2]=fe>>>8&255,ae[3]=fe&255,ae.set(J.default.types.mdat,4);for(var ht=0;ht<Oe.length;ht++)for(var ei=Oe[ht].units;ei.length;){var Ti=ei.shift(),vi=Ti.data;ae.set(vi,Y),Y+=vi.byteLength}var Et=Oe[Oe.length-1];if(se=Et.dts+Et.duration,U=Et.pts+Et.duration,this._videoNextDts=se,$e.beginDts=ee,$e.endDts=se,$e.beginPts=ue,$e.endPts=U,$e.originalBeginDts=Oe[0].originalDts,$e.originalEndDts=Et.originalDts+Et.duration,$e.firstSample=new $.SampleInfo(Oe[0].dts,Oe[0].pts,Oe[0].duration,Oe[0].originalDts,Oe[0].isKeyframe),$e.lastSample=new $.SampleInfo(Et.dts,Et.pts,Et.duration,Et.originalDts,Et.isKeyframe),this._isLive||this._videoSegmentInfoList.append($e),j.samples=Oe,j.sequenceNumber++,this._forceFirstIDR){var oi=Oe[0].flags;oi.dependsOn=2,oi.isNonSync=0}var ai=J.default.moof(j,ee);j.samples=[],j.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(ai,ae).buffer,sampleCount:Oe.length,info:$e})}}},X.prototype._mergeBoxes=function(O,G){var j=new Uint8Array(O.byteLength+G.byteLength);return j.set(O,0),j.set(G,O.byteLength),j},X}();ve.default=H},"./src/utils/browser.js":function(Le,ve,re){"use strict";re.r(ve);var ie={};function J(){var D=self.navigator.userAgent.toLowerCase(),v=/(edge)\/([\w.]+)/.exec(D)||/(opr)[\/]([\w.]+)/.exec(D)||/(chrome)[ \/]([\w.]+)/.exec(D)||/(iemobile)[\/]([\w.]+)/.exec(D)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(D)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(D)||/(webkit)[ \/]([\w.]+)/.exec(D)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(D)||/(msie) ([\w.]+)/.exec(D)||D.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(D)||D.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(D)||[],$=/(ipad)/.exec(D)||/(ipod)/.exec(D)||/(windows phone)/.exec(D)||/(iphone)/.exec(D)||/(kindle)/.exec(D)||/(android)/.exec(D)||/(windows)/.exec(D)||/(mac)/.exec(D)||/(linux)/.exec(D)||/(cros)/.exec(D)||[],I={browser:v[5]||v[3]||v[1]||"",version:v[2]||v[4]||"0",majorVersion:v[4]||v[2]||"0",platform:$[0]||""},H={};if(I.browser){H[I.browser]=!0;var X=I.majorVersion.split(".");H.version={major:parseInt(I.majorVersion,10),string:I.version},X.length>1&&(H.version.minor=parseInt(X[1],10)),X.length>2&&(H.version.build=parseInt(X[2],10))}if(I.platform&&(H[I.platform]=!0),(H.chrome||H.opr||H.safari)&&(H.webkit=!0),H.rv||H.iemobile){H.rv&&delete H.rv;var O="msie";I.browser=O,H[O]=!0}if(H.edge){delete H.edge;var G="msedge";I.browser=G,H[G]=!0}if(H.opr){var j="opera";I.browser=j,H[j]=!0}if(H.safari&&H.android){var V="android";I.browser=V,H[V]=!0}H.name=I.browser,H.platform=I.platform;for(var S in ie)ie.hasOwnProperty(S)&&delete ie[S];Object.assign(ie,H)}J(),ve.default=ie},"./src/utils/exception.js":function(Le,ve,re){"use strict";re.r(ve),re.d(ve,{RuntimeException:function(){return J},IllegalStateException:function(){return D},InvalidArgumentException:function(){return v},NotImplementedException:function(){return $}});var ie=function(){var I=function(X,O){return I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(G,j){G.__proto__=j}||function(G,j){for(var V in j)Object.prototype.hasOwnProperty.call(j,V)&&(G[V]=j[V])},I(X,O)};return function(H,X){if(typeof X!="function"&&X!==null)throw new TypeError("Class extends value "+String(X)+" is not a constructor or null");I(H,X);function O(){this.constructor=H}H.prototype=X===null?Object.create(X):(O.prototype=X.prototype,new O)}}(),J=function(){function I(H){this._message=H}return Object.defineProperty(I.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),I.prototype.toString=function(){return this.name+": "+this.message},I}(),D=function(I){ie(H,I);function H(X){return I.call(this,X)||this}return Object.defineProperty(H.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),H}(J),v=function(I){ie(H,I);function H(X){return I.call(this,X)||this}return Object.defineProperty(H.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),H}(J),$=function(I){ie(H,I);function H(X){return I.call(this,X)||this}return Object.defineProperty(H.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),H}(J)},"./src/utils/logger.js":function(Le,ve,re){"use strict";re.r(ve);var ie=re("./node_modules/events/events.js"),J=re.n(ie),D=function(){function v(){}return v.e=function($,I){(!$||v.FORCE_GLOBAL_TAG)&&($=v.GLOBAL_TAG);var H="["+$+"] > "+I;v.ENABLE_CALLBACK&&v.emitter.emit("log","error",H),!!v.ENABLE_ERROR&&(console.error?console.error(H):console.warn?console.warn(H):console.log(H))},v.i=function($,I){(!$||v.FORCE_GLOBAL_TAG)&&($=v.GLOBAL_TAG);var H="["+$+"] > "+I;v.ENABLE_CALLBACK&&v.emitter.emit("log","info",H),!!v.ENABLE_INFO&&(console.info?console.info(H):console.log(H))},v.w=function($,I){(!$||v.FORCE_GLOBAL_TAG)&&($=v.GLOBAL_TAG);var H="["+$+"] > "+I;v.ENABLE_CALLBACK&&v.emitter.emit("log","warn",H),!!v.ENABLE_WARN&&(console.warn?console.warn(H):console.log(H))},v.d=function($,I){(!$||v.FORCE_GLOBAL_TAG)&&($=v.GLOBAL_TAG);var H="["+$+"] > "+I;v.ENABLE_CALLBACK&&v.emitter.emit("log","debug",H),!!v.ENABLE_DEBUG&&(console.debug?console.debug(H):console.log(H))},v.v=function($,I){(!$||v.FORCE_GLOBAL_TAG)&&($=v.GLOBAL_TAG);var H="["+$+"] > "+I;v.ENABLE_CALLBACK&&v.emitter.emit("log","verbose",H),!!v.ENABLE_VERBOSE&&console.log(H)},v}();D.GLOBAL_TAG="flv.js",D.FORCE_GLOBAL_TAG=!1,D.ENABLE_ERROR=!0,D.ENABLE_INFO=!0,D.ENABLE_WARN=!0,D.ENABLE_DEBUG=!0,D.ENABLE_VERBOSE=!0,D.ENABLE_CALLBACK=!1,D.emitter=new(J()),ve.default=D},"./src/utils/logging-control.js":function(Le,ve,re){"use strict";re.r(ve);var ie=re("./node_modules/events/events.js"),J=re.n(ie),D=re("./src/utils/logger.js"),v=function(){function $(){}return Object.defineProperty($,"forceGlobalTag",{get:function(){return D.default.FORCE_GLOBAL_TAG},set:function(H){D.default.FORCE_GLOBAL_TAG=H,$._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty($,"globalTag",{get:function(){return D.default.GLOBAL_TAG},set:function(H){D.default.GLOBAL_TAG=H,$._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty($,"enableAll",{get:function(){return D.default.ENABLE_VERBOSE&&D.default.ENABLE_DEBUG&&D.default.ENABLE_INFO&&D.default.ENABLE_WARN&&D.default.ENABLE_ERROR},set:function(H){D.default.ENABLE_VERBOSE=H,D.default.ENABLE_DEBUG=H,D.default.ENABLE_INFO=H,D.default.ENABLE_WARN=H,D.default.ENABLE_ERROR=H,$._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty($,"enableDebug",{get:function(){return D.default.ENABLE_DEBUG},set:function(H){D.default.ENABLE_DEBUG=H,$._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty($,"enableVerbose",{get:function(){return D.default.ENABLE_VERBOSE},set:function(H){D.default.ENABLE_VERBOSE=H,$._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty($,"enableInfo",{get:function(){return D.default.ENABLE_INFO},set:function(H){D.default.ENABLE_INFO=H,$._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty($,"enableWarn",{get:function(){return D.default.ENABLE_WARN},set:function(H){D.default.ENABLE_WARN=H,$._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty($,"enableError",{get:function(){return D.default.ENABLE_ERROR},set:function(H){D.default.ENABLE_ERROR=H,$._notifyChange()},enumerable:!1,configurable:!0}),$.getConfig=function(){return{globalTag:D.default.GLOBAL_TAG,forceGlobalTag:D.default.FORCE_GLOBAL_TAG,enableVerbose:D.default.ENABLE_VERBOSE,enableDebug:D.default.ENABLE_DEBUG,enableInfo:D.default.ENABLE_INFO,enableWarn:D.default.ENABLE_WARN,enableError:D.default.ENABLE_ERROR,enableCallback:D.default.ENABLE_CALLBACK}},$.applyConfig=function(I){D.default.GLOBAL_TAG=I.globalTag,D.default.FORCE_GLOBAL_TAG=I.forceGlobalTag,D.default.ENABLE_VERBOSE=I.enableVerbose,D.default.ENABLE_DEBUG=I.enableDebug,D.default.ENABLE_INFO=I.enableInfo,D.default.ENABLE_WARN=I.enableWarn,D.default.ENABLE_ERROR=I.enableError,D.default.ENABLE_CALLBACK=I.enableCallback},$._notifyChange=function(){var I=$.emitter;if(I.listenerCount("change")>0){var H=$.getConfig();I.emit("change",H)}},$.registerListener=function(I){$.emitter.addListener("change",I)},$.removeListener=function(I){$.emitter.removeListener("change",I)},$.addLogListener=function(I){D.default.emitter.addListener("log",I),D.default.emitter.listenerCount("log")>0&&(D.default.ENABLE_CALLBACK=!0,$._notifyChange())},$.removeLogListener=function(I){D.default.emitter.removeListener("log",I),D.default.emitter.listenerCount("log")===0&&(D.default.ENABLE_CALLBACK=!1,$._notifyChange())},$}();v.emitter=new(J()),ve.default=v},"./src/utils/polyfill.js":function(Le,ve,re){"use strict";re.r(ve);var ie=function(){function J(){}return J.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(D,v){return D.__proto__=v,D},Object.assign=Object.assign||function(D){if(D==null)throw new TypeError("Cannot convert undefined or null to object");for(var v=Object(D),$=1;$<arguments.length;$++){var I=arguments[$];if(I!=null)for(var H in I)I.hasOwnProperty(H)&&(v[H]=I[H])}return v},typeof self.Promise!="function"&&re("./node_modules/es6-promise/dist/es6-promise.js").polyfill()},J}();ie.install(),ve.default=ie},"./src/utils/utf8-conv.js":function(Le,ve,re){"use strict";re.r(ve);function ie(D,v,$){var I=D;if(v+$<I.length){for(;$--;)if((I[++v]&192)!=128)return!1;return!0}else return!1}function J(D){for(var v=[],$=D,I=0,H=D.length;I<H;){if($[I]<128){v.push(String.fromCharCode($[I])),++I;continue}else if(!($[I]<192)){if($[I]<224){if(ie($,I,1)){var X=($[I]&31)<<6|$[I+1]&63;if(X>=128){v.push(String.fromCharCode(X&65535)),I+=2;continue}}}else if($[I]<240){if(ie($,I,2)){var X=($[I]&15)<<12|($[I+1]&63)<<6|$[I+2]&63;if(X>=2048&&(X&63488)!=55296){v.push(String.fromCharCode(X&65535)),I+=3;continue}}}else if($[I]<248&&ie($,I,3)){var X=($[I]&7)<<18|($[I+1]&63)<<12|($[I+2]&63)<<6|$[I+3]&63;if(X>65536&&X<1114112){X-=65536,v.push(String.fromCharCode(X>>>10|55296)),v.push(String.fromCharCode(X&1023|56320)),I+=4;continue}}}v.push(String.fromCharCode(65533)),++I}return v.join("")}ve.default=J}},Ze={};function Ee(me){var Le=Ze[me];if(Le!==void 0)return Le.exports;var ve=Ze[me]={exports:{}};return le[me].call(ve.exports,ve,ve.exports,Ee),ve.exports}Ee.m=le,function(){Ee.n=function(me){var Le=me&&me.__esModule?function(){return me.default}:function(){return me};return Ee.d(Le,{a:Le}),Le}}(),function(){Ee.d=function(me,Le){for(var ve in Le)Ee.o(Le,ve)&&!Ee.o(me,ve)&&Object.defineProperty(me,ve,{enumerable:!0,get:Le[ve]})}}(),function(){Ee.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(me){if(typeof window=="object")return window}}()}(),function(){Ee.o=function(me,Le){return Object.prototype.hasOwnProperty.call(me,Le)}}(),function(){Ee.r=function(me){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(me,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(me,"__esModule",{value:!0})}}();var nt=Ee("./src/index.js");return nt}()})},13490:function(Xt,Nt,pt){"use strict";var ut=pt(58908),le=function(nt,me){return me===void 0&&(me=!1),function(Le,ve,re){if(Le){nt(Le);return}if(ve.statusCode>=400&&ve.statusCode<=599){var ie=re;if(me)if(ut.TextDecoder){var J=Ze(ve.headers&&ve.headers["content-type"]);try{ie=new TextDecoder(J).decode(re)}catch(D){}}else ie=String.fromCharCode.apply(null,new Uint8Array(re));nt({cause:ie});return}nt(null,re)}};function Ze(Ee){return Ee===void 0&&(Ee=""),Ee.toLowerCase().split(";").reduce(function(nt,me){var Le=me.split("="),ve=Le[0],re=Le[1];return ve.trim()==="charset"?re.trim():nt},"utf-8")}Xt.exports=le},9603:function(Xt,Nt,pt){"use strict";var ut=pt(58908),le=pt(67154),Ze=pt(27376);ve.httpHandler=pt(13490);/**
 * @license
 * slighly modified parse-headers 2.0.2 <https://github.com/kesla/parse-headers/>
 * Copyright (c) 2014 David Bjrklund
 * Available under the MIT license
 * <https://github.com/kesla/parse-headers/blob/master/LICENCE>
 */var Ee=function(v){var $={};return v&&v.trim().split(`
`).forEach(function(I){var H=I.indexOf(":"),X=I.slice(0,H).trim().toLowerCase(),O=I.slice(H+1).trim();typeof $[X]=="undefined"?$[X]=O:Array.isArray($[X])?$[X].push(O):$[X]=[$[X],O]}),$};Xt.exports=ve,Xt.exports.default=ve,ve.XMLHttpRequest=ut.XMLHttpRequest||J,ve.XDomainRequest="withCredentials"in new ve.XMLHttpRequest?ve.XMLHttpRequest:ut.XDomainRequest,nt(["get","put","post","patch","head","delete"],function(D){ve[D==="delete"?"del":D]=function(v,$,I){return $=Le(v,$,I),$.method=D.toUpperCase(),re($)}});function nt(D,v){for(var $=0;$<D.length;$++)v(D[$])}function me(D){for(var v in D)if(D.hasOwnProperty(v))return!1;return!0}function Le(D,v,$){var I=D;return Ze(v)?($=v,typeof D=="string"&&(I={uri:D})):I=le({},v,{uri:D}),I.callback=$,I}function ve(D,v,$){return v=Le(D,v,$),re(v)}function re(D){if(typeof D.callback=="undefined")throw new Error("callback argument missing");var v=!1,$=function(Re,Ce,we){v||(v=!0,D.callback(Re,Ce,we))};function I(){G.readyState===4&&setTimeout(O,0)}function H(){var Ae=void 0;if(G.response?Ae=G.response:Ae=G.responseText||ie(G),Y)try{Ae=JSON.parse(Ae)}catch(Re){}return Ae}function X(Ae){return clearTimeout(ae),Ae instanceof Error||(Ae=new Error(""+(Ae||"Unknown XMLHttpRequest Error"))),Ae.statusCode=0,$(Ae,fe)}function O(){if(!V){var Ae;clearTimeout(ae),D.useXDR&&G.status===void 0?Ae=200:Ae=G.status===1223?204:G.status;var Re=fe,Ce=null;return Ae!==0?(Re={body:H(),statusCode:Ae,method:ee,headers:{},url:S,rawRequest:G},G.getAllResponseHeaders&&(Re.headers=Ee(G.getAllResponseHeaders()))):Ce=new Error("Internal XMLHttpRequest Error"),$(Ce,Re,Re.body)}}var G=D.xhr||null;G||(D.cors||D.useXDR?G=new ve.XDomainRequest:G=new ve.XMLHttpRequest);var j,V,S=G.url=D.uri||D.url,ee=G.method=D.method||"GET",se=D.body||D.data,ue=G.headers=D.headers||{},U=!!D.sync,Y=!1,ae,fe={body:void 0,headers:{},statusCode:0,method:ee,url:S,rawRequest:G};if("json"in D&&D.json!==!1&&(Y=!0,ue.accept||ue.Accept||(ue.Accept="application/json"),ee!=="GET"&&ee!=="HEAD"&&(ue["content-type"]||ue["Content-Type"]||(ue["Content-Type"]="application/json"),se=JSON.stringify(D.json===!0?se:D.json))),G.onreadystatechange=I,G.onload=O,G.onerror=X,G.onprogress=function(){},G.onabort=function(){V=!0},G.ontimeout=X,G.open(ee,S,!U,D.username,D.password),U||(G.withCredentials=!!D.withCredentials),!U&&D.timeout>0&&(ae=setTimeout(function(){if(!V){V=!0,G.abort("timeout");var Ae=new Error("XMLHttpRequest timeout");Ae.code="ETIMEDOUT",X(Ae)}},D.timeout)),G.setRequestHeader)for(j in ue)ue.hasOwnProperty(j)&&G.setRequestHeader(j,ue[j]);else if(D.headers&&!me(D.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in D&&(G.responseType=D.responseType),"beforeSend"in D&&typeof D.beforeSend=="function"&&D.beforeSend(G),G.send(se||null),G}function ie(D){try{if(D.responseType==="document")return D.responseXML;var v=D.responseXML&&D.responseXML.documentElement.nodeName==="parsererror";if(D.responseType===""&&!v)return D.responseXML}catch($){}return null}function J(){}},72167:function(Xt,Nt){"use strict";function pt(nt,me,Le){if(Le===void 0&&(Le=Array.prototype),nt&&typeof Le.find=="function")return Le.find.call(nt,me);for(var ve=0;ve<nt.length;ve++)if(Object.prototype.hasOwnProperty.call(nt,ve)){var re=nt[ve];if(me.call(void 0,re,ve,nt))return re}}function ut(nt,me){return me===void 0&&(me=Object),me&&typeof me.freeze=="function"?me.freeze(nt):nt}function le(nt,me){if(nt===null||typeof nt!="object")throw new TypeError("target is not an object");for(var Le in me)Object.prototype.hasOwnProperty.call(me,Le)&&(nt[Le]=me[Le]);return nt}var Ze=ut({HTML:"text/html",isHTML:function(nt){return nt===Ze.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),Ee=ut({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(nt){return nt===Ee.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});Nt.assign=le,Nt.find=pt,Nt.freeze=ut,Nt.MIME_TYPE=Ze,Nt.NAMESPACE=Ee},86129:function(Xt,Nt,pt){var ut,le=pt(72167),Ze=pt(41146),Ee=pt(31045),nt=pt(76925),me=Ze.DOMImplementation,Le=le.NAMESPACE,ve=nt.ParseError,re=nt.XMLReader;function ie(O){return O.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028]/g,`
`)}function J(O){this.options=O||{locator:{}}}J.prototype.parseFromString=function(O,G){var j=this.options,V=new re,S=j.domBuilder||new v,ee=j.errorHandler,se=j.locator,ue=j.xmlns||{},U=/\/x?html?$/.test(G),Y=U?Ee.HTML_ENTITIES:Ee.XML_ENTITIES;se&&S.setDocumentLocator(se),V.errorHandler=D(ee,S,se),V.domBuilder=j.domBuilder||S,U&&(ue[""]=Le.HTML),ue.xml=ue.xml||Le.XML;var ae=j.normalizeLineEndings||ie;return O&&typeof O=="string"?V.parse(ae(O),ue,Y):V.errorHandler.error("invalid doc source"),S.doc};function D(O,G,j){if(!O){if(G instanceof v)return G;O=G}var V={},S=O instanceof Function;j=j||{};function ee(se){var ue=O[se];!ue&&S&&(ue=O.length==2?function(U){O(se,U)}:O),V[se]=ue&&function(U){ue("[xmldom "+se+"]	"+U+I(j))}||function(){}}return ee("warning"),ee("error"),ee("fatalError"),V}function v(){this.cdata=!1}function $(O,G){G.lineNumber=O.lineNumber,G.columnNumber=O.columnNumber}v.prototype={startDocument:function(){this.doc=new me().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(O,G,j,V){var S=this.doc,ee=S.createElementNS(O,j||G),se=V.length;X(this,ee),this.currentElement=ee,this.locator&&$(this.locator,ee);for(var ue=0;ue<se;ue++){var O=V.getURI(ue),U=V.getValue(ue),j=V.getQName(ue),Y=S.createAttributeNS(O,j);this.locator&&$(V.getLocator(ue),Y),Y.value=Y.nodeValue=U,ee.setAttributeNode(Y)}},endElement:function(O,G,j){var V=this.currentElement,S=V.tagName;this.currentElement=V.parentNode},startPrefixMapping:function(O,G){},endPrefixMapping:function(O){},processingInstruction:function(O,G){var j=this.doc.createProcessingInstruction(O,G);this.locator&&$(this.locator,j),X(this,j)},ignorableWhitespace:function(O,G,j){},characters:function(O,G,j){if(O=H.apply(this,arguments),O){if(this.cdata)var V=this.doc.createCDATASection(O);else var V=this.doc.createTextNode(O);this.currentElement?this.currentElement.appendChild(V):/^\s*$/.test(O)&&this.doc.appendChild(V),this.locator&&$(this.locator,V)}},skippedEntity:function(O){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(O){(this.locator=O)&&(O.lineNumber=0)},comment:function(O,G,j){O=H.apply(this,arguments);var V=this.doc.createComment(O);this.locator&&$(this.locator,V),X(this,V)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(O,G,j){var V=this.doc.implementation;if(V&&V.createDocumentType){var S=V.createDocumentType(O,G,j);this.locator&&$(this.locator,S),X(this,S),this.doc.doctype=S}},warning:function(O){console.warn("[xmldom warning]	"+O,I(this.locator))},error:function(O){console.error("[xmldom error]	"+O,I(this.locator))},fatalError:function(O){throw new ve(O,this.locator)}};function I(O){if(O)return`
@`+(O.systemId||"")+"#[line:"+O.lineNumber+",col:"+O.columnNumber+"]"}function H(O,G,j){return typeof O=="string"?O.substr(G,j):O.length>=G+j||G?new java.lang.String(O,G,j)+"":O}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(O){v.prototype[O]=function(){return null}});function X(O,G){O.currentElement?O.currentElement.appendChild(G):O.doc.appendChild(G)}ut=v,ut=ie,Nt.DOMParser=J},41146:function(Xt,Nt,pt){var ut=pt(72167),le=ut.find,Ze=ut.NAMESPACE;function Ee(te){return te!==""}function nt(te){return te?te.split(/[\t\n\f\r ]+/).filter(Ee):[]}function me(te,oe){return te.hasOwnProperty(oe)||(te[oe]=!0),te}function Le(te){if(!te)return[];var oe=nt(te);return Object.keys(oe.reduce(me,{}))}function ve(te){return function(oe){return te&&te.indexOf(oe)!==-1}}function re(te,oe){for(var Se in te)Object.prototype.hasOwnProperty.call(te,Se)&&(oe[Se]=te[Se])}function ie(te,oe){var Se=te.prototype;if(!(Se instanceof oe)){let ft=function(){};var qe=ft;ft.prototype=oe.prototype,ft=new ft,re(Se,ft),te.prototype=Se=ft}Se.constructor!=te&&(typeof te!="function"&&console.error("unknown Class:"+te),Se.constructor=te)}var J={},D=J.ELEMENT_NODE=1,v=J.ATTRIBUTE_NODE=2,$=J.TEXT_NODE=3,I=J.CDATA_SECTION_NODE=4,H=J.ENTITY_REFERENCE_NODE=5,X=J.ENTITY_NODE=6,O=J.PROCESSING_INSTRUCTION_NODE=7,G=J.COMMENT_NODE=8,j=J.DOCUMENT_NODE=9,V=J.DOCUMENT_TYPE_NODE=10,S=J.DOCUMENT_FRAGMENT_NODE=11,ee=J.NOTATION_NODE=12,se={},ue={},U=se.INDEX_SIZE_ERR=(ue[1]="Index size error",1),Y=se.DOMSTRING_SIZE_ERR=(ue[2]="DOMString size error",2),ae=se.HIERARCHY_REQUEST_ERR=(ue[3]="Hierarchy request error",3),fe=se.WRONG_DOCUMENT_ERR=(ue[4]="Wrong document",4),Ae=se.INVALID_CHARACTER_ERR=(ue[5]="Invalid character",5),Re=se.NO_DATA_ALLOWED_ERR=(ue[6]="No data allowed",6),Ce=se.NO_MODIFICATION_ALLOWED_ERR=(ue[7]="No modification allowed",7),we=se.NOT_FOUND_ERR=(ue[8]="Not found",8),Fe=se.NOT_SUPPORTED_ERR=(ue[9]="Not supported",9),Ie=se.INUSE_ATTRIBUTE_ERR=(ue[10]="Attribute in use",10),$e=se.INVALID_STATE_ERR=(ue[11]="Invalid state",11),Oe=se.SYNTAX_ERR=(ue[12]="Syntax error",12),ht=se.INVALID_MODIFICATION_ERR=(ue[13]="Invalid modification",13),kt=se.NAMESPACE_ERR=(ue[14]="Invalid namespace",14),Rt=se.INVALID_ACCESS_ERR=(ue[15]="Invalid access",15);function mt(te,oe){if(oe instanceof Error)var Se=oe;else Se=this,Error.call(this,ue[te]),this.message=ue[te],Error.captureStackTrace&&Error.captureStackTrace(this,mt);return Se.code=te,oe&&(this.message=this.message+": "+oe),Se}mt.prototype=Error.prototype,re(se,mt);function rt(){}rt.prototype={length:0,item:function(te){return te>=0&&te<this.length?this[te]:null},toString:function(te,oe){for(var Se=[],qe=0;qe<this.length;qe++)vn(this[qe],Se,te,oe);return Se.join("")},filter:function(te){return Array.prototype.filter.call(this,te)},indexOf:function(te){return Array.prototype.indexOf.call(this,te)}};function Kt(te,oe){this._node=te,this._refresh=oe,_t(this)}function _t(te){var oe=te._node._inc||te._node.ownerDocument._inc;if(te._inc!==oe){var Se=te._refresh(te._node);if(Jn(te,"length",Se.length),!te.$$length||Se.length<te.$$length)for(var qe=Se.length;qe in te;qe++)Object.prototype.hasOwnProperty.call(te,qe)&&delete te[qe];re(Se,te),te._inc=oe}}Kt.prototype.item=function(te){return _t(this),this[te]||null},ie(Kt,rt);function Gt(){}function li(te,oe){for(var Se=te.length;Se--;)if(te[Se]===oe)return Se}function ei(te,oe,Se,qe){if(qe?oe[li(oe,qe)]=Se:oe[oe.length++]=Se,te){Se.ownerElement=te;var ft=te.ownerDocument;ft&&(qe&&Gi(ft,te,qe),mn(ft,te,Se))}}function Ti(te,oe,Se){var qe=li(oe,Se);if(qe>=0){for(var ft=oe.length-1;qe<ft;)oe[qe]=oe[++qe];if(oe.length=ft,te){var jt=te.ownerDocument;jt&&(Gi(jt,te,Se),Se.ownerElement=null)}}else throw new mt(we,new Error(te.tagName+"@"+Se))}Gt.prototype={length:0,item:rt.prototype.item,getNamedItem:function(te){for(var oe=this.length;oe--;){var Se=this[oe];if(Se.nodeName==te)return Se}},setNamedItem:function(te){var oe=te.ownerElement;if(oe&&oe!=this._ownerElement)throw new mt(Ie);var Se=this.getNamedItem(te.nodeName);return ei(this._ownerElement,this,te,Se),Se},setNamedItemNS:function(te){var oe=te.ownerElement,Se;if(oe&&oe!=this._ownerElement)throw new mt(Ie);return Se=this.getNamedItemNS(te.namespaceURI,te.localName),ei(this._ownerElement,this,te,Se),Se},removeNamedItem:function(te){var oe=this.getNamedItem(te);return Ti(this._ownerElement,this,oe),oe},removeNamedItemNS:function(te,oe){var Se=this.getNamedItemNS(te,oe);return Ti(this._ownerElement,this,Se),Se},getNamedItemNS:function(te,oe){for(var Se=this.length;Se--;){var qe=this[Se];if(qe.localName==oe&&qe.namespaceURI==te)return qe}return null}};function vi(){}vi.prototype={hasFeature:function(te,oe){return!0},createDocument:function(te,oe,Se){var qe=new zi;if(qe.implementation=this,qe.childNodes=new rt,qe.doctype=Se||null,Se&&qe.appendChild(Se),oe){var ft=qe.createElementNS(te,oe);qe.appendChild(ft)}return qe},createDocumentType:function(te,oe,Se){var qe=new Ut;return qe.name=te,qe.nodeName=te,qe.publicId=oe||"",qe.systemId=Se||"",qe}};function Et(){}Et.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(te,oe){return De(this,te,oe)},replaceChild:function(te,oe){De(this,te,oe,Ye),oe&&this.removeChild(oe)},removeChild:function(te){return ln(this,te)},appendChild:function(te){return this.insertBefore(te,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(te){return Qn(this.ownerDocument||this,this,te)},normalize:function(){for(var te=this.firstChild;te;){var oe=te.nextSibling;oe&&oe.nodeType==$&&te.nodeType==$?(this.removeChild(oe),te.appendData(oe.data)):(te.normalize(),te=oe)}},isSupported:function(te,oe){return this.ownerDocument.implementation.hasFeature(te,oe)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(te){for(var oe=this;oe;){var Se=oe._nsMap;if(Se){for(var qe in Se)if(Object.prototype.hasOwnProperty.call(Se,qe)&&Se[qe]===te)return qe}oe=oe.nodeType==v?oe.ownerDocument:oe.parentNode}return null},lookupNamespaceURI:function(te){for(var oe=this;oe;){var Se=oe._nsMap;if(Se&&Object.prototype.hasOwnProperty.call(Se,te))return Se[te];oe=oe.nodeType==v?oe.ownerDocument:oe.parentNode}return null},isDefaultNamespace:function(te){var oe=this.lookupPrefix(te);return oe==null}};function oi(te){return te=="<"&&"&lt;"||te==">"&&"&gt;"||te=="&"&&"&amp;"||te=='"'&&"&quot;"||"&#"+te.charCodeAt()+";"}re(J,Et),re(J,Et.prototype);function ai(te,oe){if(oe(te))return!0;if(te=te.firstChild)do if(ai(te,oe))return!0;while(te=te.nextSibling)}function zi(){this.ownerDocument=this}function mn(te,oe,Se){te&&te._inc++;var qe=Se.namespaceURI;qe===Ze.XMLNS&&(oe._nsMap[Se.prefix?Se.localName:""]=Se.value)}function Gi(te,oe,Se,qe){te&&te._inc++;var ft=Se.namespaceURI;ft===Ze.XMLNS&&delete oe._nsMap[Se.prefix?Se.localName:""]}function en(te,oe,Se){if(te&&te._inc){te._inc++;var qe=oe.childNodes;if(Se)qe[qe.length++]=Se;else{for(var ft=oe.firstChild,jt=0;ft;)qe[jt++]=ft,ft=ft.nextSibling;qe.length=jt,delete qe[qe.length]}}}function ln(te,oe){var Se=oe.previousSibling,qe=oe.nextSibling;return Se?Se.nextSibling=qe:te.firstChild=qe,qe?qe.previousSibling=Se:te.lastChild=Se,oe.parentNode=null,oe.previousSibling=null,oe.nextSibling=null,en(te.ownerDocument,te),oe}function gt(te){return te&&(te.nodeType===Et.DOCUMENT_NODE||te.nodeType===Et.DOCUMENT_FRAGMENT_NODE||te.nodeType===Et.ELEMENT_NODE)}function Ai(te){return te&&(ui(te)||Ln(te)||ki(te)||te.nodeType===Et.DOCUMENT_FRAGMENT_NODE||te.nodeType===Et.COMMENT_NODE||te.nodeType===Et.PROCESSING_INSTRUCTION_NODE)}function ki(te){return te&&te.nodeType===Et.DOCUMENT_TYPE_NODE}function ui(te){return te&&te.nodeType===Et.ELEMENT_NODE}function Ln(te){return te&&te.nodeType===Et.TEXT_NODE}function Kr(te,oe){var Se=te.childNodes||[];if(le(Se,ui)||ki(oe))return!1;var qe=le(Se,ki);return!(oe&&qe&&Se.indexOf(qe)>Se.indexOf(oe))}function Is(te,oe){var Se=te.childNodes||[];function qe(jt){return ui(jt)&&jt!==oe}if(le(Se,qe))return!1;var ft=le(Se,ki);return!(oe&&ft&&Se.indexOf(ft)>Se.indexOf(oe))}function rn(te,oe,Se){if(!gt(te))throw new mt(ae,"Unexpected parent node type "+te.nodeType);if(Se&&Se.parentNode!==te)throw new mt(we,"child not in parent");if(!Ai(oe)||ki(oe)&&te.nodeType!==Et.DOCUMENT_NODE)throw new mt(ae,"Unexpected node type "+oe.nodeType+" for parent node type "+te.nodeType)}function Rs(te,oe,Se){var qe=te.childNodes||[],ft=oe.childNodes||[];if(oe.nodeType===Et.DOCUMENT_FRAGMENT_NODE){var jt=ft.filter(ui);if(jt.length>1||le(ft,Ln))throw new mt(ae,"More than one element or text in fragment");if(jt.length===1&&!Kr(te,Se))throw new mt(ae,"Element in fragment can not be inserted before doctype")}if(ui(oe)&&!Kr(te,Se))throw new mt(ae,"Only one element can be added and only after doctype");if(ki(oe)){if(le(qe,ki))throw new mt(ae,"Only one doctype is allowed");var Si=le(qe,ui);if(Se&&qe.indexOf(Si)<qe.indexOf(Se))throw new mt(ae,"Doctype can only be inserted before an element");if(!Se&&Si)throw new mt(ae,"Doctype can not be appended since element is present")}}function Ye(te,oe,Se){var qe=te.childNodes||[],ft=oe.childNodes||[];if(oe.nodeType===Et.DOCUMENT_FRAGMENT_NODE){var jt=ft.filter(ui);if(jt.length>1||le(ft,Ln))throw new mt(ae,"More than one element or text in fragment");if(jt.length===1&&!Is(te,Se))throw new mt(ae,"Element in fragment can not be inserted before doctype")}if(ui(oe)&&!Is(te,Se))throw new mt(ae,"Only one element can be added and only after doctype");if(ki(oe)){let un=function(gn){return ki(gn)&&gn!==Se};var Ii=un;if(le(qe,un))throw new mt(ae,"Only one doctype is allowed");var Si=le(qe,ui);if(Se&&qe.indexOf(Si)<qe.indexOf(Se))throw new mt(ae,"Doctype can only be inserted before an element")}}function De(te,oe,Se,qe){rn(te,oe,Se),te.nodeType===Et.DOCUMENT_NODE&&(qe||Rs)(te,oe,Se);var ft=oe.parentNode;if(ft&&ft.removeChild(oe),oe.nodeType===S){var jt=oe.firstChild;if(jt==null)return oe;var Si=oe.lastChild}else jt=Si=oe;var Ii=Se?Se.previousSibling:te.lastChild;jt.previousSibling=Ii,Si.nextSibling=Se,Ii?Ii.nextSibling=jt:te.firstChild=jt,Se==null?te.lastChild=Si:Se.previousSibling=Si;do jt.parentNode=te;while(jt!==Si&&(jt=jt.nextSibling));return en(te.ownerDocument||te,te),oe.nodeType==S&&(oe.firstChild=oe.lastChild=null),oe}function yt(te,oe){return oe.parentNode&&oe.parentNode.removeChild(oe),oe.parentNode=te,oe.previousSibling=te.lastChild,oe.nextSibling=null,oe.previousSibling?oe.previousSibling.nextSibling=oe:te.firstChild=oe,te.lastChild=oe,en(te.ownerDocument,te,oe),oe}zi.prototype={nodeName:"#document",nodeType:j,doctype:null,documentElement:null,_inc:1,insertBefore:function(te,oe){if(te.nodeType==S){for(var Se=te.firstChild;Se;){var qe=Se.nextSibling;this.insertBefore(Se,oe),Se=qe}return te}return De(this,te,oe),te.ownerDocument=this,this.documentElement===null&&te.nodeType===D&&(this.documentElement=te),te},removeChild:function(te){return this.documentElement==te&&(this.documentElement=null),ln(this,te)},replaceChild:function(te,oe){De(this,te,oe,Ye),te.ownerDocument=this,oe&&this.removeChild(oe),ui(te)&&(this.documentElement=te)},importNode:function(te,oe){return kn(this,te,oe)},getElementById:function(te){var oe=null;return ai(this.documentElement,function(Se){if(Se.nodeType==D&&Se.getAttribute("id")==te)return oe=Se,!0}),oe},getElementsByClassName:function(te){var oe=Le(te);return new Kt(this,function(Se){var qe=[];return oe.length>0&&ai(Se.documentElement,function(ft){if(ft!==Se&&ft.nodeType===D){var jt=ft.getAttribute("class");if(jt){var Si=te===jt;if(!Si){var Ii=Le(jt);Si=oe.every(ve(Ii))}Si&&qe.push(ft)}}}),qe})},createElement:function(te){var oe=new Ct;oe.ownerDocument=this,oe.nodeName=te,oe.tagName=te,oe.localName=te,oe.childNodes=new rt;var Se=oe.attributes=new Gt;return Se._ownerElement=oe,oe},createDocumentFragment:function(){var te=new Lr;return te.ownerDocument=this,te.childNodes=new rt,te},createTextNode:function(te){var oe=new Ni;return oe.ownerDocument=this,oe.appendData(te),oe},createComment:function(te){var oe=new fi;return oe.ownerDocument=this,oe.appendData(te),oe},createCDATASection:function(te){var oe=new Dn;return oe.ownerDocument=this,oe.appendData(te),oe},createProcessingInstruction:function(te,oe){var Se=new Mt;return Se.ownerDocument=this,Se.tagName=Se.nodeName=Se.target=te,Se.nodeValue=Se.data=oe,Se},createAttribute:function(te){var oe=new wt;return oe.ownerDocument=this,oe.name=te,oe.nodeName=te,oe.localName=te,oe.specified=!0,oe},createEntityReference:function(te){var oe=new ur;return oe.ownerDocument=this,oe.nodeName=te,oe},createElementNS:function(te,oe){var Se=new Ct,qe=oe.split(":"),ft=Se.attributes=new Gt;return Se.childNodes=new rt,Se.ownerDocument=this,Se.nodeName=oe,Se.tagName=oe,Se.namespaceURI=te,qe.length==2?(Se.prefix=qe[0],Se.localName=qe[1]):Se.localName=oe,ft._ownerElement=Se,Se},createAttributeNS:function(te,oe){var Se=new wt,qe=oe.split(":");return Se.ownerDocument=this,Se.nodeName=oe,Se.name=oe,Se.namespaceURI=te,Se.specified=!0,qe.length==2?(Se.prefix=qe[0],Se.localName=qe[1]):Se.localName=oe,Se}},ie(zi,Et);function Ct(){this._nsMap={}}Ct.prototype={nodeType:D,hasAttribute:function(te){return this.getAttributeNode(te)!=null},getAttribute:function(te){var oe=this.getAttributeNode(te);return oe&&oe.value||""},getAttributeNode:function(te){return this.attributes.getNamedItem(te)},setAttribute:function(te,oe){var Se=this.ownerDocument.createAttribute(te);Se.value=Se.nodeValue=""+oe,this.setAttributeNode(Se)},removeAttribute:function(te){var oe=this.getAttributeNode(te);oe&&this.removeAttributeNode(oe)},appendChild:function(te){return te.nodeType===S?this.insertBefore(te,null):yt(this,te)},setAttributeNode:function(te){return this.attributes.setNamedItem(te)},setAttributeNodeNS:function(te){return this.attributes.setNamedItemNS(te)},removeAttributeNode:function(te){return this.attributes.removeNamedItem(te.nodeName)},removeAttributeNS:function(te,oe){var Se=this.getAttributeNodeNS(te,oe);Se&&this.removeAttributeNode(Se)},hasAttributeNS:function(te,oe){return this.getAttributeNodeNS(te,oe)!=null},getAttributeNS:function(te,oe){var Se=this.getAttributeNodeNS(te,oe);return Se&&Se.value||""},setAttributeNS:function(te,oe,Se){var qe=this.ownerDocument.createAttributeNS(te,oe);qe.value=qe.nodeValue=""+Se,this.setAttributeNode(qe)},getAttributeNodeNS:function(te,oe){return this.attributes.getNamedItemNS(te,oe)},getElementsByTagName:function(te){return new Kt(this,function(oe){var Se=[];return ai(oe,function(qe){qe!==oe&&qe.nodeType==D&&(te==="*"||qe.tagName==te)&&Se.push(qe)}),Se})},getElementsByTagNameNS:function(te,oe){return new Kt(this,function(Se){var qe=[];return ai(Se,function(ft){ft!==Se&&ft.nodeType===D&&(te==="*"||ft.namespaceURI===te)&&(oe==="*"||ft.localName==oe)&&qe.push(ft)}),qe})}},zi.prototype.getElementsByTagName=Ct.prototype.getElementsByTagName,zi.prototype.getElementsByTagNameNS=Ct.prototype.getElementsByTagNameNS,ie(Ct,Et);function wt(){}wt.prototype.nodeType=v,ie(wt,Et);function Dt(){}Dt.prototype={data:"",substringData:function(te,oe){return this.data.substring(te,te+oe)},appendData:function(te){te=this.data+te,this.nodeValue=this.data=te,this.length=te.length},insertData:function(te,oe){this.replaceData(te,0,oe)},appendChild:function(te){throw new Error(ue[ae])},deleteData:function(te,oe){this.replaceData(te,oe,"")},replaceData:function(te,oe,Se){var qe=this.data.substring(0,te),ft=this.data.substring(te+oe);Se=qe+Se+ft,this.nodeValue=this.data=Se,this.length=Se.length}},ie(Dt,Et);function Ni(){}Ni.prototype={nodeName:"#text",nodeType:$,splitText:function(te){var oe=this.data,Se=oe.substring(te);oe=oe.substring(0,te),this.data=this.nodeValue=oe,this.length=oe.length;var qe=this.ownerDocument.createTextNode(Se);return this.parentNode&&this.parentNode.insertBefore(qe,this.nextSibling),qe}},ie(Ni,Dt);function fi(){}fi.prototype={nodeName:"#comment",nodeType:G},ie(fi,Dt);function Dn(){}Dn.prototype={nodeName:"#cdata-section",nodeType:I},ie(Dn,Dt);function Ut(){}Ut.prototype.nodeType=V,ie(Ut,Et);function Xn(){}Xn.prototype.nodeType=ee,ie(Xn,Et);function Ps(){}Ps.prototype.nodeType=X,ie(Ps,Et);function ur(){}ur.prototype.nodeType=H,ie(ur,Et);function Lr(){}Lr.prototype.nodeName="#document-fragment",Lr.prototype.nodeType=S,ie(Lr,Et);function Mt(){}Mt.prototype.nodeType=O,ie(Mt,Et);function ls(){}ls.prototype.serializeToString=function(te,oe,Se){return us.call(te,oe,Se)},Et.prototype.toString=us;function us(te,oe){var Se=[],qe=this.nodeType==9&&this.documentElement||this,ft=qe.prefix,jt=qe.namespaceURI;if(jt&&ft==null){var ft=qe.lookupPrefix(jt);if(ft==null)var Si=[{namespace:jt,prefix:null}]}return vn(this,Se,te,oe,Si),Se.join("")}function dr(te,oe,Se){var qe=te.prefix||"",ft=te.namespaceURI;if(!ft||qe==="xml"&&ft===Ze.XML||ft===Ze.XMLNS)return!1;for(var jt=Se.length;jt--;){var Si=Se[jt];if(Si.prefix===qe)return Si.namespace!==ft}return!0}function cr(te,oe,Se){te.push(" ",oe,'="',Se.replace(/[<>&"\t\n\r]/g,oi),'"')}function vn(te,oe,Se,qe,ft){if(ft||(ft=[]),qe)if(te=qe(te),te){if(typeof te=="string"){oe.push(te);return}}else return;switch(te.nodeType){case D:var jt=te.attributes,Si=jt.length,Ii=te.firstChild,un=te.tagName;Se=Ze.isHTML(te.namespaceURI)||Se;var gn=un;if(!Se&&!te.prefix&&te.namespaceURI){for(var In,jn=0;jn<jt.length;jn++)if(jt.item(jn).name==="xmlns"){In=jt.item(jn).value;break}if(!In)for(var Zn=ft.length-1;Zn>=0;Zn--){var er=ft[Zn];if(er.prefix===""&&er.namespace===te.namespaceURI){In=er.namespace;break}}if(In!==te.namespaceURI)for(var Zn=ft.length-1;Zn>=0;Zn--){var er=ft[Zn];if(er.namespace===te.namespaceURI){er.prefix&&(gn=er.prefix+":"+un);break}}}oe.push("<",gn);for(var yn=0;yn<Si;yn++){var Hi=jt.item(yn);Hi.prefix=="xmlns"?ft.push({prefix:Hi.localName,namespace:Hi.value}):Hi.nodeName=="xmlns"&&ft.push({prefix:"",namespace:Hi.value})}for(var yn=0;yn<Si;yn++){var Hi=jt.item(yn);if(dr(Hi,Se,ft)){var Tn=Hi.prefix||"",hr=Hi.namespaceURI;cr(oe,Tn?"xmlns:"+Tn:"xmlns",hr),ft.push({prefix:Tn,namespace:hr})}vn(Hi,oe,Se,qe,ft)}if(un===gn&&dr(te,Se,ft)){var Tn=te.prefix||"",hr=te.namespaceURI;cr(oe,Tn?"xmlns:"+Tn:"xmlns",hr),ft.push({prefix:Tn,namespace:hr})}if(Ii||Se&&!/^(?:meta|link|img|br|hr|input)$/i.test(un)){if(oe.push(">"),Se&&/^script$/i.test(un))for(;Ii;)Ii.data?oe.push(Ii.data):vn(Ii,oe,Se,qe,ft.slice()),Ii=Ii.nextSibling;else for(;Ii;)vn(Ii,oe,Se,qe,ft.slice()),Ii=Ii.nextSibling;oe.push("</",gn,">")}else oe.push("/>");return;case j:case S:for(var Ii=te.firstChild;Ii;)vn(Ii,oe,Se,qe,ft.slice()),Ii=Ii.nextSibling;return;case v:return cr(oe,te.name,te.value);case $:return oe.push(te.data.replace(/[<&>]/g,oi));case I:return oe.push("<![CDATA[",te.data,"]]>");case G:return oe.push("<!--",te.data,"-->");case V:var Dr=te.publicId,bi=te.systemId;if(oe.push("<!DOCTYPE ",te.name),Dr)oe.push(" PUBLIC ",Dr),bi&&bi!="."&&oe.push(" ",bi),oe.push(">");else if(bi&&bi!=".")oe.push(" SYSTEM ",bi,">");else{var kr=te.internalSubset;kr&&oe.push(" [",kr,"]"),oe.push(">")}return;case O:return oe.push("<?",te.target," ",te.data,"?>");case H:return oe.push("&",te.nodeName,";");default:oe.push("??",te.nodeName)}}function kn(te,oe,Se){var qe;switch(oe.nodeType){case D:qe=oe.cloneNode(!1),qe.ownerDocument=te;case S:break;case v:Se=!0;break}if(qe||(qe=oe.cloneNode(!1)),qe.ownerDocument=te,qe.parentNode=null,Se)for(var ft=oe.firstChild;ft;)qe.appendChild(kn(te,ft,Se)),ft=ft.nextSibling;return qe}function Qn(te,oe,Se){var qe=new oe.constructor;for(var ft in oe)if(Object.prototype.hasOwnProperty.call(oe,ft)){var jt=oe[ft];typeof jt!="object"&&jt!=qe[ft]&&(qe[ft]=jt)}switch(oe.childNodes&&(qe.childNodes=new rt),qe.ownerDocument=te,qe.nodeType){case D:var Si=oe.attributes,Ii=qe.attributes=new Gt,un=Si.length;Ii._ownerElement=qe;for(var gn=0;gn<un;gn++)qe.setAttributeNode(Qn(te,Si.item(gn),!0));break;case v:Se=!0}if(Se)for(var In=oe.firstChild;In;)qe.appendChild(Qn(te,In,Se)),In=In.nextSibling;return qe}function Jn(te,oe,Se){te[oe]=Se}try{if(Object.defineProperty){let te=function(oe){switch(oe.nodeType){case D:case S:var Se=[];for(oe=oe.firstChild;oe;)oe.nodeType!==7&&oe.nodeType!==8&&Se.push(te(oe)),oe=oe.nextSibling;return Se.join("");default:return oe.nodeValue}};var Ao=te;Object.defineProperty(Kt.prototype,"length",{get:function(){return _t(this),this.$$length}}),Object.defineProperty(Et.prototype,"textContent",{get:function(){return te(this)},set:function(oe){switch(this.nodeType){case D:case S:for(;this.firstChild;)this.removeChild(this.firstChild);(oe||String(oe))&&this.appendChild(this.ownerDocument.createTextNode(oe));break;default:this.data=oe,this.value=oe,this.nodeValue=oe}}}),Jn=function(oe,Se,qe){oe["$$"+Se]=qe}}}catch(te){}Nt.DocumentType=Ut,Nt.DOMException=mt,Nt.DOMImplementation=vi,Nt.Element=Ct,Nt.Node=Et,Nt.NodeList=rt,Nt.XMLSerializer=ls},31045:function(Xt,Nt,pt){"use strict";var ut=pt(72167).freeze;Nt.XML_ENTITIES=ut({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),Nt.HTML_ENTITIES=ut({Aacute:"\xC1",aacute:"\xE1",Abreve:"\u0102",abreve:"\u0103",ac:"\u223E",acd:"\u223F",acE:"\u223E\u0333",Acirc:"\xC2",acirc:"\xE2",acute:"\xB4",Acy:"\u0410",acy:"\u0430",AElig:"\xC6",aelig:"\xE6",af:"\u2061",Afr:"\u{1D504}",afr:"\u{1D51E}",Agrave:"\xC0",agrave:"\xE0",alefsym:"\u2135",aleph:"\u2135",Alpha:"\u0391",alpha:"\u03B1",Amacr:"\u0100",amacr:"\u0101",amalg:"\u2A3F",AMP:"&",amp:"&",And:"\u2A53",and:"\u2227",andand:"\u2A55",andd:"\u2A5C",andslope:"\u2A58",andv:"\u2A5A",ang:"\u2220",ange:"\u29A4",angle:"\u2220",angmsd:"\u2221",angmsdaa:"\u29A8",angmsdab:"\u29A9",angmsdac:"\u29AA",angmsdad:"\u29AB",angmsdae:"\u29AC",angmsdaf:"\u29AD",angmsdag:"\u29AE",angmsdah:"\u29AF",angrt:"\u221F",angrtvb:"\u22BE",angrtvbd:"\u299D",angsph:"\u2222",angst:"\xC5",angzarr:"\u237C",Aogon:"\u0104",aogon:"\u0105",Aopf:"\u{1D538}",aopf:"\u{1D552}",ap:"\u2248",apacir:"\u2A6F",apE:"\u2A70",ape:"\u224A",apid:"\u224B",apos:"'",ApplyFunction:"\u2061",approx:"\u2248",approxeq:"\u224A",Aring:"\xC5",aring:"\xE5",Ascr:"\u{1D49C}",ascr:"\u{1D4B6}",Assign:"\u2254",ast:"*",asymp:"\u2248",asympeq:"\u224D",Atilde:"\xC3",atilde:"\xE3",Auml:"\xC4",auml:"\xE4",awconint:"\u2233",awint:"\u2A11",backcong:"\u224C",backepsilon:"\u03F6",backprime:"\u2035",backsim:"\u223D",backsimeq:"\u22CD",Backslash:"\u2216",Barv:"\u2AE7",barvee:"\u22BD",Barwed:"\u2306",barwed:"\u2305",barwedge:"\u2305",bbrk:"\u23B5",bbrktbrk:"\u23B6",bcong:"\u224C",Bcy:"\u0411",bcy:"\u0431",bdquo:"\u201E",becaus:"\u2235",Because:"\u2235",because:"\u2235",bemptyv:"\u29B0",bepsi:"\u03F6",bernou:"\u212C",Bernoullis:"\u212C",Beta:"\u0392",beta:"\u03B2",beth:"\u2136",between:"\u226C",Bfr:"\u{1D505}",bfr:"\u{1D51F}",bigcap:"\u22C2",bigcirc:"\u25EF",bigcup:"\u22C3",bigodot:"\u2A00",bigoplus:"\u2A01",bigotimes:"\u2A02",bigsqcup:"\u2A06",bigstar:"\u2605",bigtriangledown:"\u25BD",bigtriangleup:"\u25B3",biguplus:"\u2A04",bigvee:"\u22C1",bigwedge:"\u22C0",bkarow:"\u290D",blacklozenge:"\u29EB",blacksquare:"\u25AA",blacktriangle:"\u25B4",blacktriangledown:"\u25BE",blacktriangleleft:"\u25C2",blacktriangleright:"\u25B8",blank:"\u2423",blk12:"\u2592",blk14:"\u2591",blk34:"\u2593",block:"\u2588",bne:"=\u20E5",bnequiv:"\u2261\u20E5",bNot:"\u2AED",bnot:"\u2310",Bopf:"\u{1D539}",bopf:"\u{1D553}",bot:"\u22A5",bottom:"\u22A5",bowtie:"\u22C8",boxbox:"\u29C9",boxDL:"\u2557",boxDl:"\u2556",boxdL:"\u2555",boxdl:"\u2510",boxDR:"\u2554",boxDr:"\u2553",boxdR:"\u2552",boxdr:"\u250C",boxH:"\u2550",boxh:"\u2500",boxHD:"\u2566",boxHd:"\u2564",boxhD:"\u2565",boxhd:"\u252C",boxHU:"\u2569",boxHu:"\u2567",boxhU:"\u2568",boxhu:"\u2534",boxminus:"\u229F",boxplus:"\u229E",boxtimes:"\u22A0",boxUL:"\u255D",boxUl:"\u255C",boxuL:"\u255B",boxul:"\u2518",boxUR:"\u255A",boxUr:"\u2559",boxuR:"\u2558",boxur:"\u2514",boxV:"\u2551",boxv:"\u2502",boxVH:"\u256C",boxVh:"\u256B",boxvH:"\u256A",boxvh:"\u253C",boxVL:"\u2563",boxVl:"\u2562",boxvL:"\u2561",boxvl:"\u2524",boxVR:"\u2560",boxVr:"\u255F",boxvR:"\u255E",boxvr:"\u251C",bprime:"\u2035",Breve:"\u02D8",breve:"\u02D8",brvbar:"\xA6",Bscr:"\u212C",bscr:"\u{1D4B7}",bsemi:"\u204F",bsim:"\u223D",bsime:"\u22CD",bsol:"\\",bsolb:"\u29C5",bsolhsub:"\u27C8",bull:"\u2022",bullet:"\u2022",bump:"\u224E",bumpE:"\u2AAE",bumpe:"\u224F",Bumpeq:"\u224E",bumpeq:"\u224F",Cacute:"\u0106",cacute:"\u0107",Cap:"\u22D2",cap:"\u2229",capand:"\u2A44",capbrcup:"\u2A49",capcap:"\u2A4B",capcup:"\u2A47",capdot:"\u2A40",CapitalDifferentialD:"\u2145",caps:"\u2229\uFE00",caret:"\u2041",caron:"\u02C7",Cayleys:"\u212D",ccaps:"\u2A4D",Ccaron:"\u010C",ccaron:"\u010D",Ccedil:"\xC7",ccedil:"\xE7",Ccirc:"\u0108",ccirc:"\u0109",Cconint:"\u2230",ccups:"\u2A4C",ccupssm:"\u2A50",Cdot:"\u010A",cdot:"\u010B",cedil:"\xB8",Cedilla:"\xB8",cemptyv:"\u29B2",cent:"\xA2",CenterDot:"\xB7",centerdot:"\xB7",Cfr:"\u212D",cfr:"\u{1D520}",CHcy:"\u0427",chcy:"\u0447",check:"\u2713",checkmark:"\u2713",Chi:"\u03A7",chi:"\u03C7",cir:"\u25CB",circ:"\u02C6",circeq:"\u2257",circlearrowleft:"\u21BA",circlearrowright:"\u21BB",circledast:"\u229B",circledcirc:"\u229A",circleddash:"\u229D",CircleDot:"\u2299",circledR:"\xAE",circledS:"\u24C8",CircleMinus:"\u2296",CirclePlus:"\u2295",CircleTimes:"\u2297",cirE:"\u29C3",cire:"\u2257",cirfnint:"\u2A10",cirmid:"\u2AEF",cirscir:"\u29C2",ClockwiseContourIntegral:"\u2232",CloseCurlyDoubleQuote:"\u201D",CloseCurlyQuote:"\u2019",clubs:"\u2663",clubsuit:"\u2663",Colon:"\u2237",colon:":",Colone:"\u2A74",colone:"\u2254",coloneq:"\u2254",comma:",",commat:"@",comp:"\u2201",compfn:"\u2218",complement:"\u2201",complexes:"\u2102",cong:"\u2245",congdot:"\u2A6D",Congruent:"\u2261",Conint:"\u222F",conint:"\u222E",ContourIntegral:"\u222E",Copf:"\u2102",copf:"\u{1D554}",coprod:"\u2210",Coproduct:"\u2210",COPY:"\xA9",copy:"\xA9",copysr:"\u2117",CounterClockwiseContourIntegral:"\u2233",crarr:"\u21B5",Cross:"\u2A2F",cross:"\u2717",Cscr:"\u{1D49E}",cscr:"\u{1D4B8}",csub:"\u2ACF",csube:"\u2AD1",csup:"\u2AD0",csupe:"\u2AD2",ctdot:"\u22EF",cudarrl:"\u2938",cudarrr:"\u2935",cuepr:"\u22DE",cuesc:"\u22DF",cularr:"\u21B6",cularrp:"\u293D",Cup:"\u22D3",cup:"\u222A",cupbrcap:"\u2A48",CupCap:"\u224D",cupcap:"\u2A46",cupcup:"\u2A4A",cupdot:"\u228D",cupor:"\u2A45",cups:"\u222A\uFE00",curarr:"\u21B7",curarrm:"\u293C",curlyeqprec:"\u22DE",curlyeqsucc:"\u22DF",curlyvee:"\u22CE",curlywedge:"\u22CF",curren:"\xA4",curvearrowleft:"\u21B6",curvearrowright:"\u21B7",cuvee:"\u22CE",cuwed:"\u22CF",cwconint:"\u2232",cwint:"\u2231",cylcty:"\u232D",Dagger:"\u2021",dagger:"\u2020",daleth:"\u2138",Darr:"\u21A1",dArr:"\u21D3",darr:"\u2193",dash:"\u2010",Dashv:"\u2AE4",dashv:"\u22A3",dbkarow:"\u290F",dblac:"\u02DD",Dcaron:"\u010E",dcaron:"\u010F",Dcy:"\u0414",dcy:"\u0434",DD:"\u2145",dd:"\u2146",ddagger:"\u2021",ddarr:"\u21CA",DDotrahd:"\u2911",ddotseq:"\u2A77",deg:"\xB0",Del:"\u2207",Delta:"\u0394",delta:"\u03B4",demptyv:"\u29B1",dfisht:"\u297F",Dfr:"\u{1D507}",dfr:"\u{1D521}",dHar:"\u2965",dharl:"\u21C3",dharr:"\u21C2",DiacriticalAcute:"\xB4",DiacriticalDot:"\u02D9",DiacriticalDoubleAcute:"\u02DD",DiacriticalGrave:"`",DiacriticalTilde:"\u02DC",diam:"\u22C4",Diamond:"\u22C4",diamond:"\u22C4",diamondsuit:"\u2666",diams:"\u2666",die:"\xA8",DifferentialD:"\u2146",digamma:"\u03DD",disin:"\u22F2",div:"\xF7",divide:"\xF7",divideontimes:"\u22C7",divonx:"\u22C7",DJcy:"\u0402",djcy:"\u0452",dlcorn:"\u231E",dlcrop:"\u230D",dollar:"$",Dopf:"\u{1D53B}",dopf:"\u{1D555}",Dot:"\xA8",dot:"\u02D9",DotDot:"\u20DC",doteq:"\u2250",doteqdot:"\u2251",DotEqual:"\u2250",dotminus:"\u2238",dotplus:"\u2214",dotsquare:"\u22A1",doublebarwedge:"\u2306",DoubleContourIntegral:"\u222F",DoubleDot:"\xA8",DoubleDownArrow:"\u21D3",DoubleLeftArrow:"\u21D0",DoubleLeftRightArrow:"\u21D4",DoubleLeftTee:"\u2AE4",DoubleLongLeftArrow:"\u27F8",DoubleLongLeftRightArrow:"\u27FA",DoubleLongRightArrow:"\u27F9",DoubleRightArrow:"\u21D2",DoubleRightTee:"\u22A8",DoubleUpArrow:"\u21D1",DoubleUpDownArrow:"\u21D5",DoubleVerticalBar:"\u2225",DownArrow:"\u2193",Downarrow:"\u21D3",downarrow:"\u2193",DownArrowBar:"\u2913",DownArrowUpArrow:"\u21F5",DownBreve:"\u0311",downdownarrows:"\u21CA",downharpoonleft:"\u21C3",downharpoonright:"\u21C2",DownLeftRightVector:"\u2950",DownLeftTeeVector:"\u295E",DownLeftVector:"\u21BD",DownLeftVectorBar:"\u2956",DownRightTeeVector:"\u295F",DownRightVector:"\u21C1",DownRightVectorBar:"\u2957",DownTee:"\u22A4",DownTeeArrow:"\u21A7",drbkarow:"\u2910",drcorn:"\u231F",drcrop:"\u230C",Dscr:"\u{1D49F}",dscr:"\u{1D4B9}",DScy:"\u0405",dscy:"\u0455",dsol:"\u29F6",Dstrok:"\u0110",dstrok:"\u0111",dtdot:"\u22F1",dtri:"\u25BF",dtrif:"\u25BE",duarr:"\u21F5",duhar:"\u296F",dwangle:"\u29A6",DZcy:"\u040F",dzcy:"\u045F",dzigrarr:"\u27FF",Eacute:"\xC9",eacute:"\xE9",easter:"\u2A6E",Ecaron:"\u011A",ecaron:"\u011B",ecir:"\u2256",Ecirc:"\xCA",ecirc:"\xEA",ecolon:"\u2255",Ecy:"\u042D",ecy:"\u044D",eDDot:"\u2A77",Edot:"\u0116",eDot:"\u2251",edot:"\u0117",ee:"\u2147",efDot:"\u2252",Efr:"\u{1D508}",efr:"\u{1D522}",eg:"\u2A9A",Egrave:"\xC8",egrave:"\xE8",egs:"\u2A96",egsdot:"\u2A98",el:"\u2A99",Element:"\u2208",elinters:"\u23E7",ell:"\u2113",els:"\u2A95",elsdot:"\u2A97",Emacr:"\u0112",emacr:"\u0113",empty:"\u2205",emptyset:"\u2205",EmptySmallSquare:"\u25FB",emptyv:"\u2205",EmptyVerySmallSquare:"\u25AB",emsp:"\u2003",emsp13:"\u2004",emsp14:"\u2005",ENG:"\u014A",eng:"\u014B",ensp:"\u2002",Eogon:"\u0118",eogon:"\u0119",Eopf:"\u{1D53C}",eopf:"\u{1D556}",epar:"\u22D5",eparsl:"\u29E3",eplus:"\u2A71",epsi:"\u03B5",Epsilon:"\u0395",epsilon:"\u03B5",epsiv:"\u03F5",eqcirc:"\u2256",eqcolon:"\u2255",eqsim:"\u2242",eqslantgtr:"\u2A96",eqslantless:"\u2A95",Equal:"\u2A75",equals:"=",EqualTilde:"\u2242",equest:"\u225F",Equilibrium:"\u21CC",equiv:"\u2261",equivDD:"\u2A78",eqvparsl:"\u29E5",erarr:"\u2971",erDot:"\u2253",Escr:"\u2130",escr:"\u212F",esdot:"\u2250",Esim:"\u2A73",esim:"\u2242",Eta:"\u0397",eta:"\u03B7",ETH:"\xD0",eth:"\xF0",Euml:"\xCB",euml:"\xEB",euro:"\u20AC",excl:"!",exist:"\u2203",Exists:"\u2203",expectation:"\u2130",ExponentialE:"\u2147",exponentiale:"\u2147",fallingdotseq:"\u2252",Fcy:"\u0424",fcy:"\u0444",female:"\u2640",ffilig:"\uFB03",fflig:"\uFB00",ffllig:"\uFB04",Ffr:"\u{1D509}",ffr:"\u{1D523}",filig:"\uFB01",FilledSmallSquare:"\u25FC",FilledVerySmallSquare:"\u25AA",fjlig:"fj",flat:"\u266D",fllig:"\uFB02",fltns:"\u25B1",fnof:"\u0192",Fopf:"\u{1D53D}",fopf:"\u{1D557}",ForAll:"\u2200",forall:"\u2200",fork:"\u22D4",forkv:"\u2AD9",Fouriertrf:"\u2131",fpartint:"\u2A0D",frac12:"\xBD",frac13:"\u2153",frac14:"\xBC",frac15:"\u2155",frac16:"\u2159",frac18:"\u215B",frac23:"\u2154",frac25:"\u2156",frac34:"\xBE",frac35:"\u2157",frac38:"\u215C",frac45:"\u2158",frac56:"\u215A",frac58:"\u215D",frac78:"\u215E",frasl:"\u2044",frown:"\u2322",Fscr:"\u2131",fscr:"\u{1D4BB}",gacute:"\u01F5",Gamma:"\u0393",gamma:"\u03B3",Gammad:"\u03DC",gammad:"\u03DD",gap:"\u2A86",Gbreve:"\u011E",gbreve:"\u011F",Gcedil:"\u0122",Gcirc:"\u011C",gcirc:"\u011D",Gcy:"\u0413",gcy:"\u0433",Gdot:"\u0120",gdot:"\u0121",gE:"\u2267",ge:"\u2265",gEl:"\u2A8C",gel:"\u22DB",geq:"\u2265",geqq:"\u2267",geqslant:"\u2A7E",ges:"\u2A7E",gescc:"\u2AA9",gesdot:"\u2A80",gesdoto:"\u2A82",gesdotol:"\u2A84",gesl:"\u22DB\uFE00",gesles:"\u2A94",Gfr:"\u{1D50A}",gfr:"\u{1D524}",Gg:"\u22D9",gg:"\u226B",ggg:"\u22D9",gimel:"\u2137",GJcy:"\u0403",gjcy:"\u0453",gl:"\u2277",gla:"\u2AA5",glE:"\u2A92",glj:"\u2AA4",gnap:"\u2A8A",gnapprox:"\u2A8A",gnE:"\u2269",gne:"\u2A88",gneq:"\u2A88",gneqq:"\u2269",gnsim:"\u22E7",Gopf:"\u{1D53E}",gopf:"\u{1D558}",grave:"`",GreaterEqual:"\u2265",GreaterEqualLess:"\u22DB",GreaterFullEqual:"\u2267",GreaterGreater:"\u2AA2",GreaterLess:"\u2277",GreaterSlantEqual:"\u2A7E",GreaterTilde:"\u2273",Gscr:"\u{1D4A2}",gscr:"\u210A",gsim:"\u2273",gsime:"\u2A8E",gsiml:"\u2A90",Gt:"\u226B",GT:">",gt:">",gtcc:"\u2AA7",gtcir:"\u2A7A",gtdot:"\u22D7",gtlPar:"\u2995",gtquest:"\u2A7C",gtrapprox:"\u2A86",gtrarr:"\u2978",gtrdot:"\u22D7",gtreqless:"\u22DB",gtreqqless:"\u2A8C",gtrless:"\u2277",gtrsim:"\u2273",gvertneqq:"\u2269\uFE00",gvnE:"\u2269\uFE00",Hacek:"\u02C7",hairsp:"\u200A",half:"\xBD",hamilt:"\u210B",HARDcy:"\u042A",hardcy:"\u044A",hArr:"\u21D4",harr:"\u2194",harrcir:"\u2948",harrw:"\u21AD",Hat:"^",hbar:"\u210F",Hcirc:"\u0124",hcirc:"\u0125",hearts:"\u2665",heartsuit:"\u2665",hellip:"\u2026",hercon:"\u22B9",Hfr:"\u210C",hfr:"\u{1D525}",HilbertSpace:"\u210B",hksearow:"\u2925",hkswarow:"\u2926",hoarr:"\u21FF",homtht:"\u223B",hookleftarrow:"\u21A9",hookrightarrow:"\u21AA",Hopf:"\u210D",hopf:"\u{1D559}",horbar:"\u2015",HorizontalLine:"\u2500",Hscr:"\u210B",hscr:"\u{1D4BD}",hslash:"\u210F",Hstrok:"\u0126",hstrok:"\u0127",HumpDownHump:"\u224E",HumpEqual:"\u224F",hybull:"\u2043",hyphen:"\u2010",Iacute:"\xCD",iacute:"\xED",ic:"\u2063",Icirc:"\xCE",icirc:"\xEE",Icy:"\u0418",icy:"\u0438",Idot:"\u0130",IEcy:"\u0415",iecy:"\u0435",iexcl:"\xA1",iff:"\u21D4",Ifr:"\u2111",ifr:"\u{1D526}",Igrave:"\xCC",igrave:"\xEC",ii:"\u2148",iiiint:"\u2A0C",iiint:"\u222D",iinfin:"\u29DC",iiota:"\u2129",IJlig:"\u0132",ijlig:"\u0133",Im:"\u2111",Imacr:"\u012A",imacr:"\u012B",image:"\u2111",ImaginaryI:"\u2148",imagline:"\u2110",imagpart:"\u2111",imath:"\u0131",imof:"\u22B7",imped:"\u01B5",Implies:"\u21D2",in:"\u2208",incare:"\u2105",infin:"\u221E",infintie:"\u29DD",inodot:"\u0131",Int:"\u222C",int:"\u222B",intcal:"\u22BA",integers:"\u2124",Integral:"\u222B",intercal:"\u22BA",Intersection:"\u22C2",intlarhk:"\u2A17",intprod:"\u2A3C",InvisibleComma:"\u2063",InvisibleTimes:"\u2062",IOcy:"\u0401",iocy:"\u0451",Iogon:"\u012E",iogon:"\u012F",Iopf:"\u{1D540}",iopf:"\u{1D55A}",Iota:"\u0399",iota:"\u03B9",iprod:"\u2A3C",iquest:"\xBF",Iscr:"\u2110",iscr:"\u{1D4BE}",isin:"\u2208",isindot:"\u22F5",isinE:"\u22F9",isins:"\u22F4",isinsv:"\u22F3",isinv:"\u2208",it:"\u2062",Itilde:"\u0128",itilde:"\u0129",Iukcy:"\u0406",iukcy:"\u0456",Iuml:"\xCF",iuml:"\xEF",Jcirc:"\u0134",jcirc:"\u0135",Jcy:"\u0419",jcy:"\u0439",Jfr:"\u{1D50D}",jfr:"\u{1D527}",jmath:"\u0237",Jopf:"\u{1D541}",jopf:"\u{1D55B}",Jscr:"\u{1D4A5}",jscr:"\u{1D4BF}",Jsercy:"\u0408",jsercy:"\u0458",Jukcy:"\u0404",jukcy:"\u0454",Kappa:"\u039A",kappa:"\u03BA",kappav:"\u03F0",Kcedil:"\u0136",kcedil:"\u0137",Kcy:"\u041A",kcy:"\u043A",Kfr:"\u{1D50E}",kfr:"\u{1D528}",kgreen:"\u0138",KHcy:"\u0425",khcy:"\u0445",KJcy:"\u040C",kjcy:"\u045C",Kopf:"\u{1D542}",kopf:"\u{1D55C}",Kscr:"\u{1D4A6}",kscr:"\u{1D4C0}",lAarr:"\u21DA",Lacute:"\u0139",lacute:"\u013A",laemptyv:"\u29B4",lagran:"\u2112",Lambda:"\u039B",lambda:"\u03BB",Lang:"\u27EA",lang:"\u27E8",langd:"\u2991",langle:"\u27E8",lap:"\u2A85",Laplacetrf:"\u2112",laquo:"\xAB",Larr:"\u219E",lArr:"\u21D0",larr:"\u2190",larrb:"\u21E4",larrbfs:"\u291F",larrfs:"\u291D",larrhk:"\u21A9",larrlp:"\u21AB",larrpl:"\u2939",larrsim:"\u2973",larrtl:"\u21A2",lat:"\u2AAB",lAtail:"\u291B",latail:"\u2919",late:"\u2AAD",lates:"\u2AAD\uFE00",lBarr:"\u290E",lbarr:"\u290C",lbbrk:"\u2772",lbrace:"{",lbrack:"[",lbrke:"\u298B",lbrksld:"\u298F",lbrkslu:"\u298D",Lcaron:"\u013D",lcaron:"\u013E",Lcedil:"\u013B",lcedil:"\u013C",lceil:"\u2308",lcub:"{",Lcy:"\u041B",lcy:"\u043B",ldca:"\u2936",ldquo:"\u201C",ldquor:"\u201E",ldrdhar:"\u2967",ldrushar:"\u294B",ldsh:"\u21B2",lE:"\u2266",le:"\u2264",LeftAngleBracket:"\u27E8",LeftArrow:"\u2190",Leftarrow:"\u21D0",leftarrow:"\u2190",LeftArrowBar:"\u21E4",LeftArrowRightArrow:"\u21C6",leftarrowtail:"\u21A2",LeftCeiling:"\u2308",LeftDoubleBracket:"\u27E6",LeftDownTeeVector:"\u2961",LeftDownVector:"\u21C3",LeftDownVectorBar:"\u2959",LeftFloor:"\u230A",leftharpoondown:"\u21BD",leftharpoonup:"\u21BC",leftleftarrows:"\u21C7",LeftRightArrow:"\u2194",Leftrightarrow:"\u21D4",leftrightarrow:"\u2194",leftrightarrows:"\u21C6",leftrightharpoons:"\u21CB",leftrightsquigarrow:"\u21AD",LeftRightVector:"\u294E",LeftTee:"\u22A3",LeftTeeArrow:"\u21A4",LeftTeeVector:"\u295A",leftthreetimes:"\u22CB",LeftTriangle:"\u22B2",LeftTriangleBar:"\u29CF",LeftTriangleEqual:"\u22B4",LeftUpDownVector:"\u2951",LeftUpTeeVector:"\u2960",LeftUpVector:"\u21BF",LeftUpVectorBar:"\u2958",LeftVector:"\u21BC",LeftVectorBar:"\u2952",lEg:"\u2A8B",leg:"\u22DA",leq:"\u2264",leqq:"\u2266",leqslant:"\u2A7D",les:"\u2A7D",lescc:"\u2AA8",lesdot:"\u2A7F",lesdoto:"\u2A81",lesdotor:"\u2A83",lesg:"\u22DA\uFE00",lesges:"\u2A93",lessapprox:"\u2A85",lessdot:"\u22D6",lesseqgtr:"\u22DA",lesseqqgtr:"\u2A8B",LessEqualGreater:"\u22DA",LessFullEqual:"\u2266",LessGreater:"\u2276",lessgtr:"\u2276",LessLess:"\u2AA1",lesssim:"\u2272",LessSlantEqual:"\u2A7D",LessTilde:"\u2272",lfisht:"\u297C",lfloor:"\u230A",Lfr:"\u{1D50F}",lfr:"\u{1D529}",lg:"\u2276",lgE:"\u2A91",lHar:"\u2962",lhard:"\u21BD",lharu:"\u21BC",lharul:"\u296A",lhblk:"\u2584",LJcy:"\u0409",ljcy:"\u0459",Ll:"\u22D8",ll:"\u226A",llarr:"\u21C7",llcorner:"\u231E",Lleftarrow:"\u21DA",llhard:"\u296B",lltri:"\u25FA",Lmidot:"\u013F",lmidot:"\u0140",lmoust:"\u23B0",lmoustache:"\u23B0",lnap:"\u2A89",lnapprox:"\u2A89",lnE:"\u2268",lne:"\u2A87",lneq:"\u2A87",lneqq:"\u2268",lnsim:"\u22E6",loang:"\u27EC",loarr:"\u21FD",lobrk:"\u27E6",LongLeftArrow:"\u27F5",Longleftarrow:"\u27F8",longleftarrow:"\u27F5",LongLeftRightArrow:"\u27F7",Longleftrightarrow:"\u27FA",longleftrightarrow:"\u27F7",longmapsto:"\u27FC",LongRightArrow:"\u27F6",Longrightarrow:"\u27F9",longrightarrow:"\u27F6",looparrowleft:"\u21AB",looparrowright:"\u21AC",lopar:"\u2985",Lopf:"\u{1D543}",lopf:"\u{1D55D}",loplus:"\u2A2D",lotimes:"\u2A34",lowast:"\u2217",lowbar:"_",LowerLeftArrow:"\u2199",LowerRightArrow:"\u2198",loz:"\u25CA",lozenge:"\u25CA",lozf:"\u29EB",lpar:"(",lparlt:"\u2993",lrarr:"\u21C6",lrcorner:"\u231F",lrhar:"\u21CB",lrhard:"\u296D",lrm:"\u200E",lrtri:"\u22BF",lsaquo:"\u2039",Lscr:"\u2112",lscr:"\u{1D4C1}",Lsh:"\u21B0",lsh:"\u21B0",lsim:"\u2272",lsime:"\u2A8D",lsimg:"\u2A8F",lsqb:"[",lsquo:"\u2018",lsquor:"\u201A",Lstrok:"\u0141",lstrok:"\u0142",Lt:"\u226A",LT:"<",lt:"<",ltcc:"\u2AA6",ltcir:"\u2A79",ltdot:"\u22D6",lthree:"\u22CB",ltimes:"\u22C9",ltlarr:"\u2976",ltquest:"\u2A7B",ltri:"\u25C3",ltrie:"\u22B4",ltrif:"\u25C2",ltrPar:"\u2996",lurdshar:"\u294A",luruhar:"\u2966",lvertneqq:"\u2268\uFE00",lvnE:"\u2268\uFE00",macr:"\xAF",male:"\u2642",malt:"\u2720",maltese:"\u2720",Map:"\u2905",map:"\u21A6",mapsto:"\u21A6",mapstodown:"\u21A7",mapstoleft:"\u21A4",mapstoup:"\u21A5",marker:"\u25AE",mcomma:"\u2A29",Mcy:"\u041C",mcy:"\u043C",mdash:"\u2014",mDDot:"\u223A",measuredangle:"\u2221",MediumSpace:"\u205F",Mellintrf:"\u2133",Mfr:"\u{1D510}",mfr:"\u{1D52A}",mho:"\u2127",micro:"\xB5",mid:"\u2223",midast:"*",midcir:"\u2AF0",middot:"\xB7",minus:"\u2212",minusb:"\u229F",minusd:"\u2238",minusdu:"\u2A2A",MinusPlus:"\u2213",mlcp:"\u2ADB",mldr:"\u2026",mnplus:"\u2213",models:"\u22A7",Mopf:"\u{1D544}",mopf:"\u{1D55E}",mp:"\u2213",Mscr:"\u2133",mscr:"\u{1D4C2}",mstpos:"\u223E",Mu:"\u039C",mu:"\u03BC",multimap:"\u22B8",mumap:"\u22B8",nabla:"\u2207",Nacute:"\u0143",nacute:"\u0144",nang:"\u2220\u20D2",nap:"\u2249",napE:"\u2A70\u0338",napid:"\u224B\u0338",napos:"\u0149",napprox:"\u2249",natur:"\u266E",natural:"\u266E",naturals:"\u2115",nbsp:"\xA0",nbump:"\u224E\u0338",nbumpe:"\u224F\u0338",ncap:"\u2A43",Ncaron:"\u0147",ncaron:"\u0148",Ncedil:"\u0145",ncedil:"\u0146",ncong:"\u2247",ncongdot:"\u2A6D\u0338",ncup:"\u2A42",Ncy:"\u041D",ncy:"\u043D",ndash:"\u2013",ne:"\u2260",nearhk:"\u2924",neArr:"\u21D7",nearr:"\u2197",nearrow:"\u2197",nedot:"\u2250\u0338",NegativeMediumSpace:"\u200B",NegativeThickSpace:"\u200B",NegativeThinSpace:"\u200B",NegativeVeryThinSpace:"\u200B",nequiv:"\u2262",nesear:"\u2928",nesim:"\u2242\u0338",NestedGreaterGreater:"\u226B",NestedLessLess:"\u226A",NewLine:`
`,nexist:"\u2204",nexists:"\u2204",Nfr:"\u{1D511}",nfr:"\u{1D52B}",ngE:"\u2267\u0338",nge:"\u2271",ngeq:"\u2271",ngeqq:"\u2267\u0338",ngeqslant:"\u2A7E\u0338",nges:"\u2A7E\u0338",nGg:"\u22D9\u0338",ngsim:"\u2275",nGt:"\u226B\u20D2",ngt:"\u226F",ngtr:"\u226F",nGtv:"\u226B\u0338",nhArr:"\u21CE",nharr:"\u21AE",nhpar:"\u2AF2",ni:"\u220B",nis:"\u22FC",nisd:"\u22FA",niv:"\u220B",NJcy:"\u040A",njcy:"\u045A",nlArr:"\u21CD",nlarr:"\u219A",nldr:"\u2025",nlE:"\u2266\u0338",nle:"\u2270",nLeftarrow:"\u21CD",nleftarrow:"\u219A",nLeftrightarrow:"\u21CE",nleftrightarrow:"\u21AE",nleq:"\u2270",nleqq:"\u2266\u0338",nleqslant:"\u2A7D\u0338",nles:"\u2A7D\u0338",nless:"\u226E",nLl:"\u22D8\u0338",nlsim:"\u2274",nLt:"\u226A\u20D2",nlt:"\u226E",nltri:"\u22EA",nltrie:"\u22EC",nLtv:"\u226A\u0338",nmid:"\u2224",NoBreak:"\u2060",NonBreakingSpace:"\xA0",Nopf:"\u2115",nopf:"\u{1D55F}",Not:"\u2AEC",not:"\xAC",NotCongruent:"\u2262",NotCupCap:"\u226D",NotDoubleVerticalBar:"\u2226",NotElement:"\u2209",NotEqual:"\u2260",NotEqualTilde:"\u2242\u0338",NotExists:"\u2204",NotGreater:"\u226F",NotGreaterEqual:"\u2271",NotGreaterFullEqual:"\u2267\u0338",NotGreaterGreater:"\u226B\u0338",NotGreaterLess:"\u2279",NotGreaterSlantEqual:"\u2A7E\u0338",NotGreaterTilde:"\u2275",NotHumpDownHump:"\u224E\u0338",NotHumpEqual:"\u224F\u0338",notin:"\u2209",notindot:"\u22F5\u0338",notinE:"\u22F9\u0338",notinva:"\u2209",notinvb:"\u22F7",notinvc:"\u22F6",NotLeftTriangle:"\u22EA",NotLeftTriangleBar:"\u29CF\u0338",NotLeftTriangleEqual:"\u22EC",NotLess:"\u226E",NotLessEqual:"\u2270",NotLessGreater:"\u2278",NotLessLess:"\u226A\u0338",NotLessSlantEqual:"\u2A7D\u0338",NotLessTilde:"\u2274",NotNestedGreaterGreater:"\u2AA2\u0338",NotNestedLessLess:"\u2AA1\u0338",notni:"\u220C",notniva:"\u220C",notnivb:"\u22FE",notnivc:"\u22FD",NotPrecedes:"\u2280",NotPrecedesEqual:"\u2AAF\u0338",NotPrecedesSlantEqual:"\u22E0",NotReverseElement:"\u220C",NotRightTriangle:"\u22EB",NotRightTriangleBar:"\u29D0\u0338",NotRightTriangleEqual:"\u22ED",NotSquareSubset:"\u228F\u0338",NotSquareSubsetEqual:"\u22E2",NotSquareSuperset:"\u2290\u0338",NotSquareSupersetEqual:"\u22E3",NotSubset:"\u2282\u20D2",NotSubsetEqual:"\u2288",NotSucceeds:"\u2281",NotSucceedsEqual:"\u2AB0\u0338",NotSucceedsSlantEqual:"\u22E1",NotSucceedsTilde:"\u227F\u0338",NotSuperset:"\u2283\u20D2",NotSupersetEqual:"\u2289",NotTilde:"\u2241",NotTildeEqual:"\u2244",NotTildeFullEqual:"\u2247",NotTildeTilde:"\u2249",NotVerticalBar:"\u2224",npar:"\u2226",nparallel:"\u2226",nparsl:"\u2AFD\u20E5",npart:"\u2202\u0338",npolint:"\u2A14",npr:"\u2280",nprcue:"\u22E0",npre:"\u2AAF\u0338",nprec:"\u2280",npreceq:"\u2AAF\u0338",nrArr:"\u21CF",nrarr:"\u219B",nrarrc:"\u2933\u0338",nrarrw:"\u219D\u0338",nRightarrow:"\u21CF",nrightarrow:"\u219B",nrtri:"\u22EB",nrtrie:"\u22ED",nsc:"\u2281",nsccue:"\u22E1",nsce:"\u2AB0\u0338",Nscr:"\u{1D4A9}",nscr:"\u{1D4C3}",nshortmid:"\u2224",nshortparallel:"\u2226",nsim:"\u2241",nsime:"\u2244",nsimeq:"\u2244",nsmid:"\u2224",nspar:"\u2226",nsqsube:"\u22E2",nsqsupe:"\u22E3",nsub:"\u2284",nsubE:"\u2AC5\u0338",nsube:"\u2288",nsubset:"\u2282\u20D2",nsubseteq:"\u2288",nsubseteqq:"\u2AC5\u0338",nsucc:"\u2281",nsucceq:"\u2AB0\u0338",nsup:"\u2285",nsupE:"\u2AC6\u0338",nsupe:"\u2289",nsupset:"\u2283\u20D2",nsupseteq:"\u2289",nsupseteqq:"\u2AC6\u0338",ntgl:"\u2279",Ntilde:"\xD1",ntilde:"\xF1",ntlg:"\u2278",ntriangleleft:"\u22EA",ntrianglelefteq:"\u22EC",ntriangleright:"\u22EB",ntrianglerighteq:"\u22ED",Nu:"\u039D",nu:"\u03BD",num:"#",numero:"\u2116",numsp:"\u2007",nvap:"\u224D\u20D2",nVDash:"\u22AF",nVdash:"\u22AE",nvDash:"\u22AD",nvdash:"\u22AC",nvge:"\u2265\u20D2",nvgt:">\u20D2",nvHarr:"\u2904",nvinfin:"\u29DE",nvlArr:"\u2902",nvle:"\u2264\u20D2",nvlt:"<\u20D2",nvltrie:"\u22B4\u20D2",nvrArr:"\u2903",nvrtrie:"\u22B5\u20D2",nvsim:"\u223C\u20D2",nwarhk:"\u2923",nwArr:"\u21D6",nwarr:"\u2196",nwarrow:"\u2196",nwnear:"\u2927",Oacute:"\xD3",oacute:"\xF3",oast:"\u229B",ocir:"\u229A",Ocirc:"\xD4",ocirc:"\xF4",Ocy:"\u041E",ocy:"\u043E",odash:"\u229D",Odblac:"\u0150",odblac:"\u0151",odiv:"\u2A38",odot:"\u2299",odsold:"\u29BC",OElig:"\u0152",oelig:"\u0153",ofcir:"\u29BF",Ofr:"\u{1D512}",ofr:"\u{1D52C}",ogon:"\u02DB",Ograve:"\xD2",ograve:"\xF2",ogt:"\u29C1",ohbar:"\u29B5",ohm:"\u03A9",oint:"\u222E",olarr:"\u21BA",olcir:"\u29BE",olcross:"\u29BB",oline:"\u203E",olt:"\u29C0",Omacr:"\u014C",omacr:"\u014D",Omega:"\u03A9",omega:"\u03C9",Omicron:"\u039F",omicron:"\u03BF",omid:"\u29B6",ominus:"\u2296",Oopf:"\u{1D546}",oopf:"\u{1D560}",opar:"\u29B7",OpenCurlyDoubleQuote:"\u201C",OpenCurlyQuote:"\u2018",operp:"\u29B9",oplus:"\u2295",Or:"\u2A54",or:"\u2228",orarr:"\u21BB",ord:"\u2A5D",order:"\u2134",orderof:"\u2134",ordf:"\xAA",ordm:"\xBA",origof:"\u22B6",oror:"\u2A56",orslope:"\u2A57",orv:"\u2A5B",oS:"\u24C8",Oscr:"\u{1D4AA}",oscr:"\u2134",Oslash:"\xD8",oslash:"\xF8",osol:"\u2298",Otilde:"\xD5",otilde:"\xF5",Otimes:"\u2A37",otimes:"\u2297",otimesas:"\u2A36",Ouml:"\xD6",ouml:"\xF6",ovbar:"\u233D",OverBar:"\u203E",OverBrace:"\u23DE",OverBracket:"\u23B4",OverParenthesis:"\u23DC",par:"\u2225",para:"\xB6",parallel:"\u2225",parsim:"\u2AF3",parsl:"\u2AFD",part:"\u2202",PartialD:"\u2202",Pcy:"\u041F",pcy:"\u043F",percnt:"%",period:".",permil:"\u2030",perp:"\u22A5",pertenk:"\u2031",Pfr:"\u{1D513}",pfr:"\u{1D52D}",Phi:"\u03A6",phi:"\u03C6",phiv:"\u03D5",phmmat:"\u2133",phone:"\u260E",Pi:"\u03A0",pi:"\u03C0",pitchfork:"\u22D4",piv:"\u03D6",planck:"\u210F",planckh:"\u210E",plankv:"\u210F",plus:"+",plusacir:"\u2A23",plusb:"\u229E",pluscir:"\u2A22",plusdo:"\u2214",plusdu:"\u2A25",pluse:"\u2A72",PlusMinus:"\xB1",plusmn:"\xB1",plussim:"\u2A26",plustwo:"\u2A27",pm:"\xB1",Poincareplane:"\u210C",pointint:"\u2A15",Popf:"\u2119",popf:"\u{1D561}",pound:"\xA3",Pr:"\u2ABB",pr:"\u227A",prap:"\u2AB7",prcue:"\u227C",prE:"\u2AB3",pre:"\u2AAF",prec:"\u227A",precapprox:"\u2AB7",preccurlyeq:"\u227C",Precedes:"\u227A",PrecedesEqual:"\u2AAF",PrecedesSlantEqual:"\u227C",PrecedesTilde:"\u227E",preceq:"\u2AAF",precnapprox:"\u2AB9",precneqq:"\u2AB5",precnsim:"\u22E8",precsim:"\u227E",Prime:"\u2033",prime:"\u2032",primes:"\u2119",prnap:"\u2AB9",prnE:"\u2AB5",prnsim:"\u22E8",prod:"\u220F",Product:"\u220F",profalar:"\u232E",profline:"\u2312",profsurf:"\u2313",prop:"\u221D",Proportion:"\u2237",Proportional:"\u221D",propto:"\u221D",prsim:"\u227E",prurel:"\u22B0",Pscr:"\u{1D4AB}",pscr:"\u{1D4C5}",Psi:"\u03A8",psi:"\u03C8",puncsp:"\u2008",Qfr:"\u{1D514}",qfr:"\u{1D52E}",qint:"\u2A0C",Qopf:"\u211A",qopf:"\u{1D562}",qprime:"\u2057",Qscr:"\u{1D4AC}",qscr:"\u{1D4C6}",quaternions:"\u210D",quatint:"\u2A16",quest:"?",questeq:"\u225F",QUOT:'"',quot:'"',rAarr:"\u21DB",race:"\u223D\u0331",Racute:"\u0154",racute:"\u0155",radic:"\u221A",raemptyv:"\u29B3",Rang:"\u27EB",rang:"\u27E9",rangd:"\u2992",range:"\u29A5",rangle:"\u27E9",raquo:"\xBB",Rarr:"\u21A0",rArr:"\u21D2",rarr:"\u2192",rarrap:"\u2975",rarrb:"\u21E5",rarrbfs:"\u2920",rarrc:"\u2933",rarrfs:"\u291E",rarrhk:"\u21AA",rarrlp:"\u21AC",rarrpl:"\u2945",rarrsim:"\u2974",Rarrtl:"\u2916",rarrtl:"\u21A3",rarrw:"\u219D",rAtail:"\u291C",ratail:"\u291A",ratio:"\u2236",rationals:"\u211A",RBarr:"\u2910",rBarr:"\u290F",rbarr:"\u290D",rbbrk:"\u2773",rbrace:"}",rbrack:"]",rbrke:"\u298C",rbrksld:"\u298E",rbrkslu:"\u2990",Rcaron:"\u0158",rcaron:"\u0159",Rcedil:"\u0156",rcedil:"\u0157",rceil:"\u2309",rcub:"}",Rcy:"\u0420",rcy:"\u0440",rdca:"\u2937",rdldhar:"\u2969",rdquo:"\u201D",rdquor:"\u201D",rdsh:"\u21B3",Re:"\u211C",real:"\u211C",realine:"\u211B",realpart:"\u211C",reals:"\u211D",rect:"\u25AD",REG:"\xAE",reg:"\xAE",ReverseElement:"\u220B",ReverseEquilibrium:"\u21CB",ReverseUpEquilibrium:"\u296F",rfisht:"\u297D",rfloor:"\u230B",Rfr:"\u211C",rfr:"\u{1D52F}",rHar:"\u2964",rhard:"\u21C1",rharu:"\u21C0",rharul:"\u296C",Rho:"\u03A1",rho:"\u03C1",rhov:"\u03F1",RightAngleBracket:"\u27E9",RightArrow:"\u2192",Rightarrow:"\u21D2",rightarrow:"\u2192",RightArrowBar:"\u21E5",RightArrowLeftArrow:"\u21C4",rightarrowtail:"\u21A3",RightCeiling:"\u2309",RightDoubleBracket:"\u27E7",RightDownTeeVector:"\u295D",RightDownVector:"\u21C2",RightDownVectorBar:"\u2955",RightFloor:"\u230B",rightharpoondown:"\u21C1",rightharpoonup:"\u21C0",rightleftarrows:"\u21C4",rightleftharpoons:"\u21CC",rightrightarrows:"\u21C9",rightsquigarrow:"\u219D",RightTee:"\u22A2",RightTeeArrow:"\u21A6",RightTeeVector:"\u295B",rightthreetimes:"\u22CC",RightTriangle:"\u22B3",RightTriangleBar:"\u29D0",RightTriangleEqual:"\u22B5",RightUpDownVector:"\u294F",RightUpTeeVector:"\u295C",RightUpVector:"\u21BE",RightUpVectorBar:"\u2954",RightVector:"\u21C0",RightVectorBar:"\u2953",ring:"\u02DA",risingdotseq:"\u2253",rlarr:"\u21C4",rlhar:"\u21CC",rlm:"\u200F",rmoust:"\u23B1",rmoustache:"\u23B1",rnmid:"\u2AEE",roang:"\u27ED",roarr:"\u21FE",robrk:"\u27E7",ropar:"\u2986",Ropf:"\u211D",ropf:"\u{1D563}",roplus:"\u2A2E",rotimes:"\u2A35",RoundImplies:"\u2970",rpar:")",rpargt:"\u2994",rppolint:"\u2A12",rrarr:"\u21C9",Rrightarrow:"\u21DB",rsaquo:"\u203A",Rscr:"\u211B",rscr:"\u{1D4C7}",Rsh:"\u21B1",rsh:"\u21B1",rsqb:"]",rsquo:"\u2019",rsquor:"\u2019",rthree:"\u22CC",rtimes:"\u22CA",rtri:"\u25B9",rtrie:"\u22B5",rtrif:"\u25B8",rtriltri:"\u29CE",RuleDelayed:"\u29F4",ruluhar:"\u2968",rx:"\u211E",Sacute:"\u015A",sacute:"\u015B",sbquo:"\u201A",Sc:"\u2ABC",sc:"\u227B",scap:"\u2AB8",Scaron:"\u0160",scaron:"\u0161",sccue:"\u227D",scE:"\u2AB4",sce:"\u2AB0",Scedil:"\u015E",scedil:"\u015F",Scirc:"\u015C",scirc:"\u015D",scnap:"\u2ABA",scnE:"\u2AB6",scnsim:"\u22E9",scpolint:"\u2A13",scsim:"\u227F",Scy:"\u0421",scy:"\u0441",sdot:"\u22C5",sdotb:"\u22A1",sdote:"\u2A66",searhk:"\u2925",seArr:"\u21D8",searr:"\u2198",searrow:"\u2198",sect:"\xA7",semi:";",seswar:"\u2929",setminus:"\u2216",setmn:"\u2216",sext:"\u2736",Sfr:"\u{1D516}",sfr:"\u{1D530}",sfrown:"\u2322",sharp:"\u266F",SHCHcy:"\u0429",shchcy:"\u0449",SHcy:"\u0428",shcy:"\u0448",ShortDownArrow:"\u2193",ShortLeftArrow:"\u2190",shortmid:"\u2223",shortparallel:"\u2225",ShortRightArrow:"\u2192",ShortUpArrow:"\u2191",shy:"\xAD",Sigma:"\u03A3",sigma:"\u03C3",sigmaf:"\u03C2",sigmav:"\u03C2",sim:"\u223C",simdot:"\u2A6A",sime:"\u2243",simeq:"\u2243",simg:"\u2A9E",simgE:"\u2AA0",siml:"\u2A9D",simlE:"\u2A9F",simne:"\u2246",simplus:"\u2A24",simrarr:"\u2972",slarr:"\u2190",SmallCircle:"\u2218",smallsetminus:"\u2216",smashp:"\u2A33",smeparsl:"\u29E4",smid:"\u2223",smile:"\u2323",smt:"\u2AAA",smte:"\u2AAC",smtes:"\u2AAC\uFE00",SOFTcy:"\u042C",softcy:"\u044C",sol:"/",solb:"\u29C4",solbar:"\u233F",Sopf:"\u{1D54A}",sopf:"\u{1D564}",spades:"\u2660",spadesuit:"\u2660",spar:"\u2225",sqcap:"\u2293",sqcaps:"\u2293\uFE00",sqcup:"\u2294",sqcups:"\u2294\uFE00",Sqrt:"\u221A",sqsub:"\u228F",sqsube:"\u2291",sqsubset:"\u228F",sqsubseteq:"\u2291",sqsup:"\u2290",sqsupe:"\u2292",sqsupset:"\u2290",sqsupseteq:"\u2292",squ:"\u25A1",Square:"\u25A1",square:"\u25A1",SquareIntersection:"\u2293",SquareSubset:"\u228F",SquareSubsetEqual:"\u2291",SquareSuperset:"\u2290",SquareSupersetEqual:"\u2292",SquareUnion:"\u2294",squarf:"\u25AA",squf:"\u25AA",srarr:"\u2192",Sscr:"\u{1D4AE}",sscr:"\u{1D4C8}",ssetmn:"\u2216",ssmile:"\u2323",sstarf:"\u22C6",Star:"\u22C6",star:"\u2606",starf:"\u2605",straightepsilon:"\u03F5",straightphi:"\u03D5",strns:"\xAF",Sub:"\u22D0",sub:"\u2282",subdot:"\u2ABD",subE:"\u2AC5",sube:"\u2286",subedot:"\u2AC3",submult:"\u2AC1",subnE:"\u2ACB",subne:"\u228A",subplus:"\u2ABF",subrarr:"\u2979",Subset:"\u22D0",subset:"\u2282",subseteq:"\u2286",subseteqq:"\u2AC5",SubsetEqual:"\u2286",subsetneq:"\u228A",subsetneqq:"\u2ACB",subsim:"\u2AC7",subsub:"\u2AD5",subsup:"\u2AD3",succ:"\u227B",succapprox:"\u2AB8",succcurlyeq:"\u227D",Succeeds:"\u227B",SucceedsEqual:"\u2AB0",SucceedsSlantEqual:"\u227D",SucceedsTilde:"\u227F",succeq:"\u2AB0",succnapprox:"\u2ABA",succneqq:"\u2AB6",succnsim:"\u22E9",succsim:"\u227F",SuchThat:"\u220B",Sum:"\u2211",sum:"\u2211",sung:"\u266A",Sup:"\u22D1",sup:"\u2283",sup1:"\xB9",sup2:"\xB2",sup3:"\xB3",supdot:"\u2ABE",supdsub:"\u2AD8",supE:"\u2AC6",supe:"\u2287",supedot:"\u2AC4",Superset:"\u2283",SupersetEqual:"\u2287",suphsol:"\u27C9",suphsub:"\u2AD7",suplarr:"\u297B",supmult:"\u2AC2",supnE:"\u2ACC",supne:"\u228B",supplus:"\u2AC0",Supset:"\u22D1",supset:"\u2283",supseteq:"\u2287",supseteqq:"\u2AC6",supsetneq:"\u228B",supsetneqq:"\u2ACC",supsim:"\u2AC8",supsub:"\u2AD4",supsup:"\u2AD6",swarhk:"\u2926",swArr:"\u21D9",swarr:"\u2199",swarrow:"\u2199",swnwar:"\u292A",szlig:"\xDF",Tab:"	",target:"\u2316",Tau:"\u03A4",tau:"\u03C4",tbrk:"\u23B4",Tcaron:"\u0164",tcaron:"\u0165",Tcedil:"\u0162",tcedil:"\u0163",Tcy:"\u0422",tcy:"\u0442",tdot:"\u20DB",telrec:"\u2315",Tfr:"\u{1D517}",tfr:"\u{1D531}",there4:"\u2234",Therefore:"\u2234",therefore:"\u2234",Theta:"\u0398",theta:"\u03B8",thetasym:"\u03D1",thetav:"\u03D1",thickapprox:"\u2248",thicksim:"\u223C",ThickSpace:"\u205F\u200A",thinsp:"\u2009",ThinSpace:"\u2009",thkap:"\u2248",thksim:"\u223C",THORN:"\xDE",thorn:"\xFE",Tilde:"\u223C",tilde:"\u02DC",TildeEqual:"\u2243",TildeFullEqual:"\u2245",TildeTilde:"\u2248",times:"\xD7",timesb:"\u22A0",timesbar:"\u2A31",timesd:"\u2A30",tint:"\u222D",toea:"\u2928",top:"\u22A4",topbot:"\u2336",topcir:"\u2AF1",Topf:"\u{1D54B}",topf:"\u{1D565}",topfork:"\u2ADA",tosa:"\u2929",tprime:"\u2034",TRADE:"\u2122",trade:"\u2122",triangle:"\u25B5",triangledown:"\u25BF",triangleleft:"\u25C3",trianglelefteq:"\u22B4",triangleq:"\u225C",triangleright:"\u25B9",trianglerighteq:"\u22B5",tridot:"\u25EC",trie:"\u225C",triminus:"\u2A3A",TripleDot:"\u20DB",triplus:"\u2A39",trisb:"\u29CD",tritime:"\u2A3B",trpezium:"\u23E2",Tscr:"\u{1D4AF}",tscr:"\u{1D4C9}",TScy:"\u0426",tscy:"\u0446",TSHcy:"\u040B",tshcy:"\u045B",Tstrok:"\u0166",tstrok:"\u0167",twixt:"\u226C",twoheadleftarrow:"\u219E",twoheadrightarrow:"\u21A0",Uacute:"\xDA",uacute:"\xFA",Uarr:"\u219F",uArr:"\u21D1",uarr:"\u2191",Uarrocir:"\u2949",Ubrcy:"\u040E",ubrcy:"\u045E",Ubreve:"\u016C",ubreve:"\u016D",Ucirc:"\xDB",ucirc:"\xFB",Ucy:"\u0423",ucy:"\u0443",udarr:"\u21C5",Udblac:"\u0170",udblac:"\u0171",udhar:"\u296E",ufisht:"\u297E",Ufr:"\u{1D518}",ufr:"\u{1D532}",Ugrave:"\xD9",ugrave:"\xF9",uHar:"\u2963",uharl:"\u21BF",uharr:"\u21BE",uhblk:"\u2580",ulcorn:"\u231C",ulcorner:"\u231C",ulcrop:"\u230F",ultri:"\u25F8",Umacr:"\u016A",umacr:"\u016B",uml:"\xA8",UnderBar:"_",UnderBrace:"\u23DF",UnderBracket:"\u23B5",UnderParenthesis:"\u23DD",Union:"\u22C3",UnionPlus:"\u228E",Uogon:"\u0172",uogon:"\u0173",Uopf:"\u{1D54C}",uopf:"\u{1D566}",UpArrow:"\u2191",Uparrow:"\u21D1",uparrow:"\u2191",UpArrowBar:"\u2912",UpArrowDownArrow:"\u21C5",UpDownArrow:"\u2195",Updownarrow:"\u21D5",updownarrow:"\u2195",UpEquilibrium:"\u296E",upharpoonleft:"\u21BF",upharpoonright:"\u21BE",uplus:"\u228E",UpperLeftArrow:"\u2196",UpperRightArrow:"\u2197",Upsi:"\u03D2",upsi:"\u03C5",upsih:"\u03D2",Upsilon:"\u03A5",upsilon:"\u03C5",UpTee:"\u22A5",UpTeeArrow:"\u21A5",upuparrows:"\u21C8",urcorn:"\u231D",urcorner:"\u231D",urcrop:"\u230E",Uring:"\u016E",uring:"\u016F",urtri:"\u25F9",Uscr:"\u{1D4B0}",uscr:"\u{1D4CA}",utdot:"\u22F0",Utilde:"\u0168",utilde:"\u0169",utri:"\u25B5",utrif:"\u25B4",uuarr:"\u21C8",Uuml:"\xDC",uuml:"\xFC",uwangle:"\u29A7",vangrt:"\u299C",varepsilon:"\u03F5",varkappa:"\u03F0",varnothing:"\u2205",varphi:"\u03D5",varpi:"\u03D6",varpropto:"\u221D",vArr:"\u21D5",varr:"\u2195",varrho:"\u03F1",varsigma:"\u03C2",varsubsetneq:"\u228A\uFE00",varsubsetneqq:"\u2ACB\uFE00",varsupsetneq:"\u228B\uFE00",varsupsetneqq:"\u2ACC\uFE00",vartheta:"\u03D1",vartriangleleft:"\u22B2",vartriangleright:"\u22B3",Vbar:"\u2AEB",vBar:"\u2AE8",vBarv:"\u2AE9",Vcy:"\u0412",vcy:"\u0432",VDash:"\u22AB",Vdash:"\u22A9",vDash:"\u22A8",vdash:"\u22A2",Vdashl:"\u2AE6",Vee:"\u22C1",vee:"\u2228",veebar:"\u22BB",veeeq:"\u225A",vellip:"\u22EE",Verbar:"\u2016",verbar:"|",Vert:"\u2016",vert:"|",VerticalBar:"\u2223",VerticalLine:"|",VerticalSeparator:"\u2758",VerticalTilde:"\u2240",VeryThinSpace:"\u200A",Vfr:"\u{1D519}",vfr:"\u{1D533}",vltri:"\u22B2",vnsub:"\u2282\u20D2",vnsup:"\u2283\u20D2",Vopf:"\u{1D54D}",vopf:"\u{1D567}",vprop:"\u221D",vrtri:"\u22B3",Vscr:"\u{1D4B1}",vscr:"\u{1D4CB}",vsubnE:"\u2ACB\uFE00",vsubne:"\u228A\uFE00",vsupnE:"\u2ACC\uFE00",vsupne:"\u228B\uFE00",Vvdash:"\u22AA",vzigzag:"\u299A",Wcirc:"\u0174",wcirc:"\u0175",wedbar:"\u2A5F",Wedge:"\u22C0",wedge:"\u2227",wedgeq:"\u2259",weierp:"\u2118",Wfr:"\u{1D51A}",wfr:"\u{1D534}",Wopf:"\u{1D54E}",wopf:"\u{1D568}",wp:"\u2118",wr:"\u2240",wreath:"\u2240",Wscr:"\u{1D4B2}",wscr:"\u{1D4CC}",xcap:"\u22C2",xcirc:"\u25EF",xcup:"\u22C3",xdtri:"\u25BD",Xfr:"\u{1D51B}",xfr:"\u{1D535}",xhArr:"\u27FA",xharr:"\u27F7",Xi:"\u039E",xi:"\u03BE",xlArr:"\u27F8",xlarr:"\u27F5",xmap:"\u27FC",xnis:"\u22FB",xodot:"\u2A00",Xopf:"\u{1D54F}",xopf:"\u{1D569}",xoplus:"\u2A01",xotime:"\u2A02",xrArr:"\u27F9",xrarr:"\u27F6",Xscr:"\u{1D4B3}",xscr:"\u{1D4CD}",xsqcup:"\u2A06",xuplus:"\u2A04",xutri:"\u25B3",xvee:"\u22C1",xwedge:"\u22C0",Yacute:"\xDD",yacute:"\xFD",YAcy:"\u042F",yacy:"\u044F",Ycirc:"\u0176",ycirc:"\u0177",Ycy:"\u042B",ycy:"\u044B",yen:"\xA5",Yfr:"\u{1D51C}",yfr:"\u{1D536}",YIcy:"\u0407",yicy:"\u0457",Yopf:"\u{1D550}",yopf:"\u{1D56A}",Yscr:"\u{1D4B4}",yscr:"\u{1D4CE}",YUcy:"\u042E",yucy:"\u044E",Yuml:"\u0178",yuml:"\xFF",Zacute:"\u0179",zacute:"\u017A",Zcaron:"\u017D",zcaron:"\u017E",Zcy:"\u0417",zcy:"\u0437",Zdot:"\u017B",zdot:"\u017C",zeetrf:"\u2128",ZeroWidthSpace:"\u200B",Zeta:"\u0396",zeta:"\u03B6",Zfr:"\u2128",zfr:"\u{1D537}",ZHcy:"\u0416",zhcy:"\u0436",zigrarr:"\u21DD",Zopf:"\u2124",zopf:"\u{1D56B}",Zscr:"\u{1D4B5}",zscr:"\u{1D4CF}",zwj:"\u200D",zwnj:"\u200C"}),Nt.entityMap=Nt.HTML_ENTITIES},3969:function(Xt,Nt,pt){var ut,le=pt(41146);ut=le.DOMImplementation,ut=le.XMLSerializer,Nt.DOMParser=pt(86129).DOMParser},76925:function(Xt,Nt,pt){var ut=pt(72167).NAMESPACE,le=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Ze=new RegExp("[\\-\\.0-9"+le.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),Ee=new RegExp("^"+le.source+Ze.source+"*(?::"+le.source+Ze.source+"*)?$"),nt=0,me=1,Le=2,ve=3,re=4,ie=5,J=6,D=7;function v(U,Y){this.message=U,this.locator=Y,Error.captureStackTrace&&Error.captureStackTrace(this,v)}v.prototype=new Error,v.prototype.name=v.name;function $(){}$.prototype={parse:function(U,Y,ae){var fe=this.domBuilder;fe.startDocument(),V(Y,Y={}),I(U,Y,ae,fe,this.errorHandler),fe.endDocument()}};function I(U,Y,ae,fe,Ae){function Re(gt){if(gt>65535){gt-=65536;var Ai=55296+(gt>>10),ki=56320+(gt&1023);return String.fromCharCode(Ai,ki)}else return String.fromCharCode(gt)}function Ce(gt){var Ai=gt.slice(1,-1);return Object.hasOwnProperty.call(ae,Ai)?ae[Ai]:Ai.charAt(0)==="#"?Re(parseInt(Ai.substr(1).replace("x","0x"))):(Ae.error("entity not found:"+gt),gt)}function we(gt){if(gt>mt){var Ai=U.substring(mt,gt).replace(/&#?\w+;/g,Ce);ht&&Fe(mt),fe.characters(Ai,0,gt-mt),mt=gt}}function Fe(gt,Ai){for(;gt>=$e&&(Ai=Oe.exec(U));)Ie=Ai.index,$e=Ie+Ai[0].length,ht.lineNumber++;ht.columnNumber=gt-Ie+1}for(var Ie=0,$e=0,Oe=/.*(?:\r\n?|\n)|.*$/g,ht=fe.locator,kt=[{currentNSMap:Y}],Rt={},mt=0;;){try{var rt=U.indexOf("<",mt);if(rt<0){if(!U.substr(mt).match(/^\s*$/)){var Kt=fe.doc,_t=Kt.createTextNode(U.substr(mt));Kt.appendChild(_t),fe.currentElement=_t}return}switch(rt>mt&&we(rt),U.charAt(rt+1)){case"/":var Gt=U.indexOf(">",rt+3),li=U.substring(rt+2,Gt).replace(/[ \t\n\r]+$/g,""),ei=kt.pop();Gt<0?(li=U.substring(rt+2).replace(/[\s<].*/,""),Ae.error("end tag name: "+li+" is not complete:"+ei.tagName),Gt=rt+1+li.length):li.match(/\s</)&&(li=li.replace(/[\s<].*/,""),Ae.error("end tag name: "+li+" maybe not complete"),Gt=rt+1+li.length);var Ti=ei.localNSMap,vi=ei.tagName==li,Et=vi||ei.tagName&&ei.tagName.toLowerCase()==li.toLowerCase();if(Et){if(fe.endElement(ei.uri,ei.localName,li),Ti)for(var oi in Ti)Object.prototype.hasOwnProperty.call(Ti,oi)&&fe.endPrefixMapping(oi);vi||Ae.fatalError("end tag name: "+li+" is not match the current start tagName:"+ei.tagName)}else kt.push(ei);Gt++;break;case"?":ht&&Fe(rt),Gt=ee(U,rt,fe);break;case"!":ht&&Fe(rt),Gt=S(U,rt,fe,Ae);break;default:ht&&Fe(rt);var ai=new se,zi=kt[kt.length-1].currentNSMap,Gt=X(U,rt,ai,zi,Ce,Ae),mn=ai.length;if(!ai.closed&&j(U,Gt,ai.tagName,Rt)&&(ai.closed=!0,ae.nbsp||Ae.warning("unclosed xml attribute")),ht&&mn){for(var Gi=H(ht,{}),en=0;en<mn;en++){var ln=ai[en];Fe(ln.offset),ln.locator=H(ht,{})}fe.locator=Gi,O(ai,fe,zi)&&kt.push(ai),fe.locator=ht}else O(ai,fe,zi)&&kt.push(ai);ut.isHTML(ai.uri)&&!ai.closed?Gt=G(U,Gt,ai.tagName,Ce,fe):Gt++}}catch(gt){if(gt instanceof v)throw gt;Ae.error("element parse error: "+gt),Gt=-1}Gt>mt?mt=Gt:we(Math.max(rt,mt)+1)}}function H(U,Y){return Y.lineNumber=U.lineNumber,Y.columnNumber=U.columnNumber,Y}function X(U,Y,ae,fe,Ae,Re){function Ce(kt,Rt,mt){ae.attributeNames.hasOwnProperty(kt)&&Re.fatalError("Attribute "+kt+" redefined"),ae.addValue(kt,Rt.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,Ae),mt)}for(var we,Fe,Ie=++Y,$e=nt;;){var Oe=U.charAt(Ie);switch(Oe){case"=":if($e===me)we=U.slice(Y,Ie),$e=ve;else if($e===Le)$e=ve;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if($e===ve||$e===me)if($e===me&&(Re.warning('attribute value must after "="'),we=U.slice(Y,Ie)),Y=Ie+1,Ie=U.indexOf(Oe,Y),Ie>0)Fe=U.slice(Y,Ie),Ce(we,Fe,Y-1),$e=ie;else throw new Error("attribute value no end '"+Oe+"' match");else if($e==re)Fe=U.slice(Y,Ie),Ce(we,Fe,Y),Re.warning('attribute "'+we+'" missed start quot('+Oe+")!!"),Y=Ie+1,$e=ie;else throw new Error('attribute value must after "="');break;case"/":switch($e){case nt:ae.setTagName(U.slice(Y,Ie));case ie:case J:case D:$e=D,ae.closed=!0;case re:case me:break;case Le:ae.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return Re.error("unexpected end of input"),$e==nt&&ae.setTagName(U.slice(Y,Ie)),Ie;case">":switch($e){case nt:ae.setTagName(U.slice(Y,Ie));case ie:case J:case D:break;case re:case me:Fe=U.slice(Y,Ie),Fe.slice(-1)==="/"&&(ae.closed=!0,Fe=Fe.slice(0,-1));case Le:$e===Le&&(Fe=we),$e==re?(Re.warning('attribute "'+Fe+'" missed quot(")!'),Ce(we,Fe,Y)):((!ut.isHTML(fe[""])||!Fe.match(/^(?:disabled|checked|selected)$/i))&&Re.warning('attribute "'+Fe+'" missed value!! "'+Fe+'" instead!!'),Ce(Fe,Fe,Y));break;case ve:throw new Error("attribute value missed!!")}return Ie;case"\x80":Oe=" ";default:if(Oe<=" ")switch($e){case nt:ae.setTagName(U.slice(Y,Ie)),$e=J;break;case me:we=U.slice(Y,Ie),$e=Le;break;case re:var Fe=U.slice(Y,Ie);Re.warning('attribute "'+Fe+'" missed quot(")!!'),Ce(we,Fe,Y);case ie:$e=J;break}else switch($e){case Le:var ht=ae.tagName;(!ut.isHTML(fe[""])||!we.match(/^(?:disabled|checked|selected)$/i))&&Re.warning('attribute "'+we+'" missed value!! "'+we+'" instead2!!'),Ce(we,we,Y),Y=Ie,$e=me;break;case ie:Re.warning('attribute space is required"'+we+'"!!');case J:$e=me,Y=Ie;break;case ve:$e=re,Y=Ie;break;case D:throw new Error("elements closed character '/' and '>' must be connected to")}}Ie++}}function O(U,Y,ae){for(var fe=U.tagName,Ae=null,Re=U.length;Re--;){var Ce=U[Re],we=Ce.qName,Fe=Ce.value,ht=we.indexOf(":");if(ht>0)var Ie=Ce.prefix=we.slice(0,ht),$e=we.slice(ht+1),Oe=Ie==="xmlns"&&$e;else $e=we,Ie=null,Oe=we==="xmlns"&&"";Ce.localName=$e,Oe!==!1&&(Ae==null&&(Ae={},V(ae,ae={})),ae[Oe]=Ae[Oe]=Fe,Ce.uri=ut.XMLNS,Y.startPrefixMapping(Oe,Fe))}for(var Re=U.length;Re--;){Ce=U[Re];var Ie=Ce.prefix;Ie&&(Ie==="xml"&&(Ce.uri=ut.XML),Ie!=="xmlns"&&(Ce.uri=ae[Ie||""]))}var ht=fe.indexOf(":");ht>0?(Ie=U.prefix=fe.slice(0,ht),$e=U.localName=fe.slice(ht+1)):(Ie=null,$e=U.localName=fe);var kt=U.uri=ae[Ie||""];if(Y.startElement(kt,$e,fe,U),U.closed){if(Y.endElement(kt,$e,fe),Ae)for(Ie in Ae)Object.prototype.hasOwnProperty.call(Ae,Ie)&&Y.endPrefixMapping(Ie)}else return U.currentNSMap=ae,U.localNSMap=Ae,!0}function G(U,Y,ae,fe,Ae){if(/^(?:script|textarea)$/i.test(ae)){var Re=U.indexOf("</"+ae+">",Y),Ce=U.substring(Y+1,Re);if(/[&<]/.test(Ce))return/^script$/i.test(ae)?(Ae.characters(Ce,0,Ce.length),Re):(Ce=Ce.replace(/&#?\w+;/g,fe),Ae.characters(Ce,0,Ce.length),Re)}return Y+1}function j(U,Y,ae,fe){var Ae=fe[ae];return Ae==null&&(Ae=U.lastIndexOf("</"+ae+">"),Ae<Y&&(Ae=U.lastIndexOf("</"+ae)),fe[ae]=Ae),Ae<Y}function V(U,Y){for(var ae in U)Object.prototype.hasOwnProperty.call(U,ae)&&(Y[ae]=U[ae])}function S(U,Y,ae,fe){var Ae=U.charAt(Y+2);switch(Ae){case"-":if(U.charAt(Y+3)==="-"){var Re=U.indexOf("-->",Y+4);return Re>Y?(ae.comment(U,Y+4,Re-Y-4),Re+3):(fe.error("Unclosed comment"),-1)}else return-1;default:if(U.substr(Y+3,6)=="CDATA["){var Re=U.indexOf("]]>",Y+9);return ae.startCDATA(),ae.characters(U,Y+9,Re-Y-9),ae.endCDATA(),Re+3}var Ce=ue(U,Y),we=Ce.length;if(we>1&&/!doctype/i.test(Ce[0][0])){var Fe=Ce[1][0],Ie=!1,$e=!1;we>3&&(/^public$/i.test(Ce[2][0])?(Ie=Ce[3][0],$e=we>4&&Ce[4][0]):/^system$/i.test(Ce[2][0])&&($e=Ce[3][0]));var Oe=Ce[we-1];return ae.startDTD(Fe,Ie,$e),ae.endDTD(),Oe.index+Oe[0].length}}return-1}function ee(U,Y,ae){var fe=U.indexOf("?>",Y);if(fe){var Ae=U.substring(Y,fe).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(Ae){var Re=Ae[0].length;return ae.processingInstruction(Ae[1],Ae[2]),fe+2}else return-1}return-1}function se(){this.attributeNames={}}se.prototype={setTagName:function(U){if(!Ee.test(U))throw new Error("invalid tagName:"+U);this.tagName=U},addValue:function(U,Y,ae){if(!Ee.test(U))throw new Error("invalid attribute:"+U);this.attributeNames[U]=this.length,this[this.length++]={qName:U,value:Y,offset:ae}},length:0,getLocalName:function(U){return this[U].localName},getLocator:function(U){return this[U].locator},getQName:function(U){return this[U].qName},getURI:function(U){return this[U].uri},getValue:function(U){return this[U].value}};function ue(U,Y){var ae,fe=[],Ae=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(Ae.lastIndex=Y,Ae.exec(U);ae=Ae.exec(U);)if(fe.push(ae),ae[1])return fe}Nt.XMLReader=$,Nt.ParseError=v},5953:function(Xt,Nt,pt){var ut=pt(48764).Buffer;(function(le,Ze){Xt.exports=Ze()})(self,()=>(()=>{var le={916:(me,Le,ve)=>{var re=ve(471);me.exports=function(ie){"use strict";var J,D="",v=(ie=ie||{}).video,$=ie.options,I=re.$escape,H=ie.tran,X=ie.icons,O=ie.index,G=re.$each;return ie.$value,ie.$index,D+=`<div class="dplayer-mask"></div>
<div class="dplayer-video-wrap">
    `,J=ve(568)(v),D+=J,D+=`
    `,$.logo&&(D+=`
    <div class="dplayer-logo">
        <img src="`,D+=I($.logo),D+=`">
    </div>
    `),D+=`
    <div class="dplayer-danmaku"`,$.danmaku&&$.danmaku.bottom&&(D+=' style="margin-bottom:',D+=I($.danmaku.bottom),D+='"'),D+=`>
        <div class="dplayer-danmaku-item dplayer-danmaku-item--demo"></div>
    </div>
    <div class="dplayer-subtitle"></div>
    <div class="dplayer-bezel">
        <span class="dplayer-bezel-icon"></span>
        `,$.danmaku&&(D+=`
        <span class="dplayer-danloading">`,D+=I(H("danmaku-loading")),D+=`</span>
        `),D+=`
        <span class="diplayer-loading-icon">`,D+=X.loading,D+=`</span>
    </div>
</div>
<div class="dplayer-controller-mask"></div>
<div class="dplayer-controller">
    <div class="dplayer-icons dplayer-comment-box">
        <button class="dplayer-icon dplayer-comment-setting-icon" data-balloon="`,D+=I(H("setting")),D+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,D+=X.pallette,D+=`</span>
        </button>
        <div class="dplayer-comment-setting-box">
            <div class="dplayer-comment-setting-color">
                <div class="dplayer-comment-setting-title">`,D+=I(H("set-danmaku-color")),D+=`</div>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,D+=I(O),D+=`" value="#fff" checked>
                    <span style="background: #fff;"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,D+=I(O),D+=`" value="#e54256">
                    <span style="background: #e54256"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,D+=I(O),D+=`" value="#ffe133">
                    <span style="background: #ffe133"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,D+=I(O),D+=`" value="#64DD17">
                    <span style="background: #64DD17"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,D+=I(O),D+=`" value="#39ccff">
                    <span style="background: #39ccff"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,D+=I(O),D+=`" value="#D500F9">
                    <span style="background: #D500F9"></span>
                </label>
            </div>
            <div class="dplayer-comment-setting-type">
                <div class="dplayer-comment-setting-title">`,D+=I(H("set-danmaku-type")),D+=`</div>
                <label>
                    <input type="radio" name="dplayer-danmaku-type-`,D+=I(O),D+=`" value="1">
                    <span>`,D+=I(H("top")),D+=`</span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-type-`,D+=I(O),D+=`" value="0" checked>
                    <span>`,D+=I(H("rolling")),D+=`</span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-type-`,D+=I(O),D+=`" value="2">
                    <span>`,D+=I(H("bottom")),D+=`</span>
                </label>
            </div>
        </div>
        <input class="dplayer-comment-input" type="text" placeholder="`,D+=I(H("input-danmaku-enter")),D+=`" maxlength="30">
        <button class="dplayer-icon dplayer-send-icon" data-balloon="`,D+=I(H("send")),D+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,D+=X.send,D+=`</span>
        </button>
    </div>
    <div class="dplayer-icons dplayer-icons-left">
        <button class="dplayer-icon dplayer-play-icon">
            <span class="dplayer-icon-content">`,D+=X.play,D+=`</span>
        </button>
        <div class="dplayer-volume">
            <button class="dplayer-icon dplayer-volume-icon">
                <span class="dplayer-icon-content">`,D+=X.volumeDown,D+=`</span>
            </button>
            <div class="dplayer-volume-bar-wrap" data-balloon-pos="up">
                <div class="dplayer-volume-bar">
                    <div class="dplayer-volume-bar-inner" style="background: `,D+=I($.theme),D+=`;">
                        <span class="dplayer-thumb" style="background: `,D+=I($.theme),D+=`"></span>
                    </div>
                </div>
            </div>
        </div>
        <span class="dplayer-time">
            <span class="dplayer-ptime">0:00</span> /
            <span class="dplayer-dtime">0:00</span>
        </span>
        `,$.live&&(D+=`
        <span class="dplayer-live-badge"><span class="dplayer-live-dot" style="background: `,D+=I($.theme),D+=';"></span>',D+=I(H("live")),D+=`</span>
        `),D+=`
    </div>
    <div class="dplayer-icons dplayer-icons-right">
        `,$.video.quality&&(D+=`
        <div class="dplayer-quality">
            <button class="dplayer-icon dplayer-quality-icon">`,D+=I($.video.quality[$.video.defaultQuality].name),D+=`</button>
            <div class="dplayer-quality-mask">
                <div class="dplayer-quality-list">
                `,G($.video.quality,function(j,V){D+=`
                    <div class="dplayer-quality-item" data-index="`,D+=I(V),D+='">',D+=I(j.name),D+=`</div>
                `}),D+=`
                </div>
            </div>
        </div>
        `),D+=`
        `,$.screenshot&&(D+=`
        <div class="dplayer-icon dplayer-camera-icon" data-balloon="`,D+=I(H("screenshot")),D+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,D+=X.camera,D+=`</span>
        </div>
        `),D+=`
        `,$.airplay&&(D+=`
        <div class="dplayer-icon dplayer-airplay-icon" data-balloon="`,D+=I(H("airplay")),D+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,D+=X.airplay,D+=`</span>
        </div>
        `),D+=`
        `,$.chromecast&&(D+=`
        <div class="dplayer-icon dplayer-chromecast-icon" data-balloon="`,D+=I(H("chromecast")),D+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,D+=X.chromecast,D+=`</span>
        </div>
        `),D+=`
        <div class="dplayer-comment">
            <button class="dplayer-icon dplayer-comment-icon" data-balloon="`,D+=I(H("send-danmaku")),D+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,D+=X.comment,D+=`</span>
            </button>
        </div>
        `,$.subtitle&&(D+=`
        `,typeof $.subtitle.url=="string"?(D+=`
        <div class="dplayer-subtitle-btn">
            <button class="dplayer-icon dplayer-subtitle-icon" data-balloon="`,D+=I(H("hide-subs")),D+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,D+=X.subtitle,D+=`</span>
            </button>
        </div>
        `):(D+=`
        <div class="dplayer-subtitles">
            <button class="dplayer-icon dplayer-subtitles-icon" data-balloon="`,D+=I(H("subtitle")),D+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,D+=X.subtitle,D+=`</span>
            </button>
            <div class="dplayer-subtitles-box">
                <div class="dplayer-subtitles-panel">
                    `,G($.subtitle.url,function(j,V){D+=`
                        <div class="dplayer-subtitles-item" data-subtitle="`,D+=I(j.url),D+=`">
                            <!-- if lang, show tran(lang). if lang and name, show name + (tran(lang)). if name, show name. off option use lang for translation. -->
                            <span class="dplayer-label">`,D+=I(j.lang?j.name?j.name+" ("+H(j.lang)+")":H(j.lang):j.name),D+=`</span>
                        </div>
                    `}),D+=`
                </div>
            </div>
        </div>
        `),D+=`
        `),D+=`
        <div class="dplayer-setting">
            <button class="dplayer-icon dplayer-setting-icon" data-balloon="`,D+=I(H("setting")),D+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,D+=X.setting,D+=`</span>
            </button>
            <div class="dplayer-setting-box">
                <div class="dplayer-setting-origin-panel">
                    <div class="dplayer-setting-item dplayer-setting-speed">
                        <span class="dplayer-label">`,D+=I(H("speed")),D+=`</span>
                        <div class="dplayer-toggle">`,D+=X.right,D+=`</div>
                    </div>
                    <div class="dplayer-setting-item dplayer-setting-loop">
                        <span class="dplayer-label">`,D+=I(H("loop")),D+=`</span>
                        <div class="dplayer-toggle">
                            <input class="dplayer-toggle-setting-input" type="checkbox" name="dplayer-toggle">
                            <label for="dplayer-toggle"></label>
                        </div>
                    </div>
                    <div class="dplayer-setting-item dplayer-setting-showdan">
                        <span class="dplayer-label">`,D+=I(H("show-danmaku")),D+=`</span>
                        <div class="dplayer-toggle">
                            <input class="dplayer-showdan-setting-input" type="checkbox" name="dplayer-toggle-dan">
                            <label for="dplayer-toggle-dan"></label>
                        </div>
                    </div>
                    <div class="dplayer-setting-item dplayer-setting-danunlimit">
                        <span class="dplayer-label">`,D+=I(H("unlimited-danmaku")),D+=`</span>
                        <div class="dplayer-toggle">
                            <input class="dplayer-danunlimit-setting-input" type="checkbox" name="dplayer-toggle-danunlimit">
                            <label for="dplayer-toggle-danunlimit"></label>
                        </div>
                    </div>
                    <div class="dplayer-setting-item dplayer-setting-danmaku">
                        <span class="dplayer-label">`,D+=I(H("opacity-danmaku")),D+=`</span>
                        <div class="dplayer-danmaku-bar-wrap">
                            <div class="dplayer-danmaku-bar">
                                <div class="dplayer-danmaku-bar-inner">
                                    <span class="dplayer-thumb"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="dplayer-setting-speed-panel">
                    `,G($.playbackSpeed,function(j,V){D+=`
                        <div class="dplayer-setting-speed-item" data-speed="`,D+=I(j),D+=`">
                            <span class="dplayer-label">`,D+=I(j===1?H("normal"):j),D+=`</span>
                        </div>
                    `}),D+=`
                </div>
            </div>
        </div>
        <div class="dplayer-full">
            <button class="dplayer-icon dplayer-full-in-icon" data-balloon="`,D+=I(H("web-fullscreen")),D+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,D+=X.fullWeb,D+=`</span>
            </button>
            <button class="dplayer-icon dplayer-full-icon" data-balloon="`,D+=I(H("fullscreen")),D+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,D+=X.full,D+=`</span>
            </button>
        </div>
    </div>
    <div class="dplayer-bar-wrap">
        <div class="dplayer-bar-time hidden">00:00</div>
        <div class="dplayer-bar-preview"></div>
        <div class="dplayer-bar">
            <div class="dplayer-loaded" style="width: 0;"></div>
            <div class="dplayer-played" style="width: 0; background: `,D+=I($.theme),D+=`">
                <span class="dplayer-thumb" style="background: `,D+=I($.theme),D+=`"></span>
            </div>
        </div>
    </div>
</div>
<div class="dplayer-info-panel dplayer-info-panel-hide">
    <div class="dplayer-info-panel-close">[x]</div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-version">
        <span class="dplayer-info-panel-item-title">Player version</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-fps">
        <span class="dplayer-info-panel-item-title">Player FPS</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-type">
        <span class="dplayer-info-panel-item-title">Video type</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-url">
        <span class="dplayer-info-panel-item-title">Video url</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-resolution">
        <span class="dplayer-info-panel-item-title">Video resolution</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-duration">
        <span class="dplayer-info-panel-item-title">Video duration</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    `,$.danmaku&&(D+=`
    <div class="dplayer-info-panel-item dplayer-info-panel-item-danmaku-id">
        <span class="dplayer-info-panel-item-title">Danmaku id</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-danmaku-api">
        <span class="dplayer-info-panel-item-title">Danmaku api</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-danmaku-amount">
        <span class="dplayer-info-panel-item-title">Danmaku amount</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    `),D+=`
</div>
<div class="dplayer-menu">
    `,G($.contextmenu,function(j,V){D+=`
        <div class="dplayer-menu-item">
            <a`,j.link&&(D+=' target="_blank"'),D+=' href="',D+=I(j.link||"javascript:void(0);"),D+='">',j.key&&(D+=" ",D+=I(H(j.key))),j.text&&(D+=" ",D+=I(j.text)),D+=`</a>
        </div>
    `}),D+=`
</div>
<div class="dplayer-notice-list"></div>
<button class="dplayer-mobile-play">
    `,D+=X.play,D+=`
</button>`}},568:(me,Le,ve)=>{var re=ve(471);me.exports=function(ie){"use strict";var J="",D=(ie=ie||{}).enableSubtitle,v=ie.subtitle,$=ie.current,I=ie.airplay,H=ie.pic,X=re.$escape,O=ie.screenshot,G=ie.preload,j=ie.url;return D=v&&v.type==="webvtt",J+=`
<video
    class="dplayer-video `,$&&(J+="dplayer-video-current"),J+=`"
    webkit-playsinline
    `,I&&(J+=' x-webkit-airplay="allow" '),J+=`
    playsinline
    `,H&&(J+='poster="',J+=X(H),J+='"'),J+=`
    `,(O||D)&&(J+='crossorigin="anonymous"'),J+=`
    `,G&&(J+='preload="',J+=X(G),J+='"'),J+=`
    `,I?J+=`
    nosrc
    `:j&&(J+=`
    src="`,J+=X(j),J+=`"
    `),J+=`
    >
    `,I&&(J+=`
    <source src="`,J+=X(j),J+=`">
    `),J+=`
    `,D&&(J+=`
    <track class="dplayer-subtrack" kind="metadata" default src="`,J+=X(typeof v.url=="string"?v.url:v.url[v.index].url),J+=`"></track>
    `),J+`
</video>`}},49:(me,Le,ve)=>{"use strict";ve.d(Le,{Z:()=>v});var re=ve(415),ie=ve.n(re),J=ve(352),D=ve.n(J)()(ie());D.push([me.id,`:root {
  --balloon-border-radius: 2px;
  --balloon-color: rgba(16, 16, 16, 0.95);
  --balloon-text-color: #fff;
  --balloon-font-size: 12px;
  --balloon-move: 4px; }

button[aria-label][data-balloon-pos] {
  overflow: visible; }

[aria-label][data-balloon-pos] {
  position: relative;
  cursor: pointer; }
  [aria-label][data-balloon-pos]:after {
    opacity: 0;
    pointer-events: none;
    transition: all 0.18s ease-out 0.18s;
    text-indent: 0;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
    font-weight: normal;
    font-style: normal;
    text-shadow: none;
    font-size: 12px;
    font-size: var(--balloon-font-size);
    background: rgba(16, 16, 16, 0.95);
    background: var(--balloon-color);
    border-radius: 2px;
    color: #fff;
    color: var(--balloon-text-color);
    border-radius: var(--balloon-border-radius);
    content: attr(aria-label);
    padding: .5em 1em;
    position: absolute;
    white-space: nowrap;
    z-index: 10; }
  [aria-label][data-balloon-pos]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-top-color: rgba(16, 16, 16, 0.95);
    border-top-color: var(--balloon-color);
    opacity: 0;
    pointer-events: none;
    transition: all 0.18s ease-out 0.18s;
    content: "";
    position: absolute;
    z-index: 10; }
  [aria-label][data-balloon-pos]:hover:before, [aria-label][data-balloon-pos]:hover:after, [aria-label][data-balloon-pos][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-visible]:after, [aria-label][data-balloon-pos]:not([data-balloon-nofocus]):focus:before, [aria-label][data-balloon-pos]:not([data-balloon-nofocus]):focus:after {
    opacity: 1;
    pointer-events: none; }
  [aria-label][data-balloon-pos].font-awesome:after {
    font-family: FontAwesome, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; }
  [aria-label][data-balloon-pos][data-balloon-break]:after {
    white-space: pre; }
  [aria-label][data-balloon-pos][data-balloon-break][data-balloon-length]:after {
    white-space: pre-line;
    word-break: break-word; }
  [aria-label][data-balloon-pos][data-balloon-blunt]:before, [aria-label][data-balloon-pos][data-balloon-blunt]:after {
    transition: none; }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="up"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos="down"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="down"][data-balloon-visible]:after {
    transform: translate(-50%, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="up"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos="down"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="down"][data-balloon-visible]:before {
    transform: translate(-50%, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos*="-left"]:after {
    left: 0; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-left"]:before {
    left: 5px; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:after {
    right: 0; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:before {
    right: 5px; }
  [aria-label][data-balloon-pos][data-balloon-po*="-left"]:hover:after, [aria-label][data-balloon-pos][data-balloon-po*="-left"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos*="-right"][data-balloon-visible]:after {
    transform: translate(0, 0); }
  [aria-label][data-balloon-pos][data-balloon-po*="-left"]:hover:before, [aria-label][data-balloon-pos][data-balloon-po*="-left"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos*="-right"][data-balloon-visible]:before {
    transform: translate(0, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos^="up"]:before, [aria-label][data-balloon-pos][data-balloon-pos^="up"]:after {
    bottom: 100%;
    transform-origin: top;
    transform: translate(0, 4px);
    transform: translate(0, var(--balloon-move)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="up"]:after {
    margin-bottom: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:before, [aria-label][data-balloon-pos][data-balloon-pos="up"]:after {
    left: 50%;
    transform: translate(-50%, 4px);
    transform: translate(-50%, var(--balloon-move)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:before, [aria-label][data-balloon-pos][data-balloon-pos^="down"]:after {
    top: 100%;
    transform: translate(0, calc(4px * -1));
    transform: translate(0, calc(var(--balloon-move) * -1)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:after {
    margin-top: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-bottom-color: rgba(16, 16, 16, 0.95);
    border-bottom-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-pos="down"]:after, [aria-label][data-balloon-pos][data-balloon-pos="down"]:before {
    left: 50%;
    transform: translate(-50%, calc(4px * -1));
    transform: translate(-50%, calc(var(--balloon-move) * -1)); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="left"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos="right"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="right"][data-balloon-visible]:after {
    transform: translate(0, -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="left"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos="right"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="right"][data-balloon-visible]:before {
    transform: translate(0, -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:after, [aria-label][data-balloon-pos][data-balloon-pos="left"]:before {
    right: 100%;
    top: 50%;
    transform: translate(4px, -50%);
    transform: translate(var(--balloon-move), -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:after {
    margin-right: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-left-color: rgba(16, 16, 16, 0.95);
    border-left-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:after, [aria-label][data-balloon-pos][data-balloon-pos="right"]:before {
    left: 100%;
    top: 50%;
    transform: translate(calc(4px * -1), -50%);
    transform: translate(calc(var(--balloon-move) * -1), -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:after {
    margin-left: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-right-color: rgba(16, 16, 16, 0.95);
    border-right-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-length]:after {
    white-space: normal; }
  [aria-label][data-balloon-pos][data-balloon-length="small"]:after {
    width: 80px; }
  [aria-label][data-balloon-pos][data-balloon-length="medium"]:after {
    width: 150px; }
  [aria-label][data-balloon-pos][data-balloon-length="large"]:after {
    width: 260px; }
  [aria-label][data-balloon-pos][data-balloon-length="xlarge"]:after {
    width: 380px; }
    @media screen and (max-width: 768px) {
      [aria-label][data-balloon-pos][data-balloon-length="xlarge"]:after {
        width: 90vw; } }
  [aria-label][data-balloon-pos][data-balloon-length="fit"]:after {
    width: 100%; }
`,"",{version:3,sources:["webpack://./node_modules/.pnpm/balloon-css@1.2.0/node_modules/balloon-css/balloon.css"],names:[],mappings:"AAAA;EACE,4BAA4B;EAC5B,uCAAuC;EACvC,0BAA0B;EAC1B,yBAAyB;EACzB,mBAAmB,EAAE;;AAEvB;EACE,iBAAiB,EAAE;;AAErB;EACE,kBAAkB;EAClB,eAAe,EAAE;EACjB;IACE,UAAU;IACV,oBAAoB;IACpB,oCAAoC;IACpC,cAAc;IACd,wIAAwI;IACxI,mBAAmB;IACnB,kBAAkB;IAClB,iBAAiB;IACjB,eAAmC;IAAnC,mCAAmC;IACnC,kCAAgC;IAAhC,gCAAgC;IAChC,kBAAkB;IAClB,WAAgC;IAAhC,gCAAgC;IAChC,2CAA2C;IAC3C,yBAAyB;IACzB,iBAAiB;IACjB,kBAAkB;IAClB,mBAAmB;IACnB,WAAW,EAAE;EACf;IACE,QAAQ;IACR,SAAS;IACT,6BAA6B;IAC7B,wCAAsC;IAAtC,sCAAsC;IACtC,UAAU;IACV,oBAAoB;IACpB,oCAAoC;IACpC,WAAW;IACX,kBAAkB;IAClB,WAAW,EAAE;EACf;IACE,UAAU;IACV,oBAAoB,EAAE;EACxB;IACE,qJAAqJ,EAAE;EACzJ;IACE,gBAAgB,EAAE;EACpB;IACE,qBAAqB;IACrB,sBAAsB,EAAE;EAC1B;IACE,gBAAgB,EAAE;EACpB;IACE,6BAA6B,EAAE;EACjC;IACE,6BAA6B,EAAE;EACjC;IACE,OAAO,EAAE;EACX;IACE,SAAS,EAAE;EACb;IACE,QAAQ,EAAE;EACZ;IACE,UAAU,EAAE;EACd;IACE,0BAA0B,EAAE;EAC9B;IACE,0BAA0B,EAAE;EAC9B;IACE,YAAY;IACZ,qBAAqB;IACrB,4BAA4C;IAA5C,4CAA4C,EAAE;EAChD;IACE,mBAAmB,EAAE;EACvB;IACE,SAAS;IACT,+BAA+C;IAA/C,+CAA+C,EAAE;EACnD;IACE,SAAS;IACT,uCAAuD;IAAvD,uDAAuD,EAAE;EAC3D;IACE,gBAAgB,EAAE;EACpB;IACE,QAAQ;IACR,SAAS;IACT,6BAA6B;IAC7B,2CAAyC;IAAzC,yCAAyC,EAAE;EAC7C;IACE,SAAS;IACT,0CAA0D;IAA1D,0DAA0D,EAAE;EAC9D;IACE,6BAA6B,EAAE;EACjC;IACE,6BAA6B,EAAE;EACjC;IACE,WAAW;IACX,QAAQ;IACR,+BAA+C;IAA/C,+CAA+C,EAAE;EACnD;IACE,kBAAkB,EAAE;EACtB;IACE,QAAQ;IACR,SAAS;IACT,6BAA6B;IAC7B,yCAAuC;IAAvC,uCAAuC,EAAE;EAC3C;IACE,UAAU;IACV,QAAQ;IACR,0CAA0D;IAA1D,0DAA0D,EAAE;EAC9D;IACE,iBAAiB,EAAE;EACrB;IACE,QAAQ;IACR,SAAS;IACT,6BAA6B;IAC7B,0CAAwC;IAAxC,wCAAwC,EAAE;EAC5C;IACE,mBAAmB,EAAE;EACvB;IACE,WAAW,EAAE;EACf;IACE,YAAY,EAAE;EAChB;IACE,YAAY,EAAE;EAChB;IACE,YAAY,EAAE;IACd;MACE;QACE,WAAW,EAAE,EAAE;EACrB;IACE,WAAW,EAAE",sourcesContent:[`:root {
  --balloon-border-radius: 2px;
  --balloon-color: rgba(16, 16, 16, 0.95);
  --balloon-text-color: #fff;
  --balloon-font-size: 12px;
  --balloon-move: 4px; }

button[aria-label][data-balloon-pos] {
  overflow: visible; }

[aria-label][data-balloon-pos] {
  position: relative;
  cursor: pointer; }
  [aria-label][data-balloon-pos]:after {
    opacity: 0;
    pointer-events: none;
    transition: all 0.18s ease-out 0.18s;
    text-indent: 0;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
    font-weight: normal;
    font-style: normal;
    text-shadow: none;
    font-size: var(--balloon-font-size);
    background: var(--balloon-color);
    border-radius: 2px;
    color: var(--balloon-text-color);
    border-radius: var(--balloon-border-radius);
    content: attr(aria-label);
    padding: .5em 1em;
    position: absolute;
    white-space: nowrap;
    z-index: 10; }
  [aria-label][data-balloon-pos]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-top-color: var(--balloon-color);
    opacity: 0;
    pointer-events: none;
    transition: all 0.18s ease-out 0.18s;
    content: "";
    position: absolute;
    z-index: 10; }
  [aria-label][data-balloon-pos]:hover:before, [aria-label][data-balloon-pos]:hover:after, [aria-label][data-balloon-pos][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-visible]:after, [aria-label][data-balloon-pos]:not([data-balloon-nofocus]):focus:before, [aria-label][data-balloon-pos]:not([data-balloon-nofocus]):focus:after {
    opacity: 1;
    pointer-events: none; }
  [aria-label][data-balloon-pos].font-awesome:after {
    font-family: FontAwesome, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; }
  [aria-label][data-balloon-pos][data-balloon-break]:after {
    white-space: pre; }
  [aria-label][data-balloon-pos][data-balloon-break][data-balloon-length]:after {
    white-space: pre-line;
    word-break: break-word; }
  [aria-label][data-balloon-pos][data-balloon-blunt]:before, [aria-label][data-balloon-pos][data-balloon-blunt]:after {
    transition: none; }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="up"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos="down"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="down"][data-balloon-visible]:after {
    transform: translate(-50%, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="up"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos="down"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="down"][data-balloon-visible]:before {
    transform: translate(-50%, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos*="-left"]:after {
    left: 0; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-left"]:before {
    left: 5px; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:after {
    right: 0; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:before {
    right: 5px; }
  [aria-label][data-balloon-pos][data-balloon-po*="-left"]:hover:after, [aria-label][data-balloon-pos][data-balloon-po*="-left"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos*="-right"][data-balloon-visible]:after {
    transform: translate(0, 0); }
  [aria-label][data-balloon-pos][data-balloon-po*="-left"]:hover:before, [aria-label][data-balloon-pos][data-balloon-po*="-left"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos*="-right"][data-balloon-visible]:before {
    transform: translate(0, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos^="up"]:before, [aria-label][data-balloon-pos][data-balloon-pos^="up"]:after {
    bottom: 100%;
    transform-origin: top;
    transform: translate(0, var(--balloon-move)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="up"]:after {
    margin-bottom: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:before, [aria-label][data-balloon-pos][data-balloon-pos="up"]:after {
    left: 50%;
    transform: translate(-50%, var(--balloon-move)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:before, [aria-label][data-balloon-pos][data-balloon-pos^="down"]:after {
    top: 100%;
    transform: translate(0, calc(var(--balloon-move) * -1)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:after {
    margin-top: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-bottom-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-pos="down"]:after, [aria-label][data-balloon-pos][data-balloon-pos="down"]:before {
    left: 50%;
    transform: translate(-50%, calc(var(--balloon-move) * -1)); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="left"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos="right"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="right"][data-balloon-visible]:after {
    transform: translate(0, -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="left"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos="right"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="right"][data-balloon-visible]:before {
    transform: translate(0, -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:after, [aria-label][data-balloon-pos][data-balloon-pos="left"]:before {
    right: 100%;
    top: 50%;
    transform: translate(var(--balloon-move), -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:after {
    margin-right: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-left-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:after, [aria-label][data-balloon-pos][data-balloon-pos="right"]:before {
    left: 100%;
    top: 50%;
    transform: translate(calc(var(--balloon-move) * -1), -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:after {
    margin-left: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-right-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-length]:after {
    white-space: normal; }
  [aria-label][data-balloon-pos][data-balloon-length="small"]:after {
    width: 80px; }
  [aria-label][data-balloon-pos][data-balloon-length="medium"]:after {
    width: 150px; }
  [aria-label][data-balloon-pos][data-balloon-length="large"]:after {
    width: 260px; }
  [aria-label][data-balloon-pos][data-balloon-length="xlarge"]:after {
    width: 380px; }
    @media screen and (max-width: 768px) {
      [aria-label][data-balloon-pos][data-balloon-length="xlarge"]:after {
        width: 90vw; } }
  [aria-label][data-balloon-pos][data-balloon-length="fit"]:after {
    width: 100%; }
`],sourceRoot:""}]);const v=D},685:(me,Le,ve)=>{"use strict";ve.d(Le,{Z:()=>G});var re=ve(415),ie=ve.n(re),J=ve(352),D=ve.n(J),v=ve(49),$=ve(80),I=ve.n($),H=new URL(ve(831),ve.b),X=D()(ie());X.i(v.Z);var O=I()(H);X.push([me.id,`@keyframes my-face {
  2% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  4% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  6% {
    transform: translate(0, 1.5px) rotate(-1.5deg);
  }
  8% {
    transform: translate(0, -1.5px) rotate(-1.5deg);
  }
  10% {
    transform: translate(0, 2.5px) rotate(1.5deg);
  }
  12% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  14% {
    transform: translate(0, -1.5px) rotate(1.5deg);
  }
  16% {
    transform: translate(0, -0.5px) rotate(-1.5deg);
  }
  18% {
    transform: translate(0, 0.5px) rotate(-1.5deg);
  }
  20% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  22% {
    transform: translate(0, 0.5px) rotate(-1.5deg);
  }
  24% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  26% {
    transform: translate(0, 0.5px) rotate(0.5deg);
  }
  28% {
    transform: translate(0, 0.5px) rotate(1.5deg);
  }
  30% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  32% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  34% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  36% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  38% {
    transform: translate(0, 1.5px) rotate(-1.5deg);
  }
  40% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  42% {
    transform: translate(0, 2.5px) rotate(-1.5deg);
  }
  44% {
    transform: translate(0, 1.5px) rotate(0.5deg);
  }
  46% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  48% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  50% {
    transform: translate(0, 0.5px) rotate(0.5deg);
  }
  52% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  54% {
    transform: translate(0, -1.5px) rotate(1.5deg);
  }
  56% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  58% {
    transform: translate(0, 0.5px) rotate(2.5deg);
  }
  60% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  62% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  64% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  66% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  68% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  70% {
    transform: translate(0, 1.5px) rotate(0.5deg);
  }
  72% {
    transform: translate(0, 2.5px) rotate(1.5deg);
  }
  74% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  76% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  78% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  80% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  82% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  84% {
    transform: translate(0, 1.5px) rotate(2.5deg);
  }
  86% {
    transform: translate(0, -1.5px) rotate(-1.5deg);
  }
  88% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  90% {
    transform: translate(0, 2.5px) rotate(-0.5deg);
  }
  92% {
    transform: translate(0, 0.5px) rotate(-0.5deg);
  }
  94% {
    transform: translate(0, 2.5px) rotate(0.5deg);
  }
  96% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  98% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  0%,
  100% {
    transform: translate(0, 0) rotate(0deg);
  }
}
.dplayer {
  position: relative;
  overflow: hidden;
  -webkit-user-select: none;
     -moz-user-select: none;
          user-select: none;
  line-height: 1;
}
.dplayer * {
  box-sizing: content-box;
}
.dplayer svg {
  width: 100%;
  height: 100%;
}
.dplayer svg path,
.dplayer svg circle {
  fill: #fff;
}
.dplayer:-webkit-full-screen {
  width: 100%;
  height: 100%;
  background: #000;
  position: fixed;
  z-index: 100000;
  left: 0;
  top: 0;
  margin: 0;
  padding: 0;
  transform: translate(0, 0);
}
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-showdan,
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-danmaku,
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-danunlimit {
  display: none;
}
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-comment {
  display: none;
}
.dplayer.dplayer-no-danmaku .dplayer-danmaku {
  display: none;
}
.dplayer.dplayer-live .dplayer-time {
  display: none;
}
.dplayer.dplayer-live .dplayer-bar-wrap {
  display: none;
}
.dplayer.dplayer-live .dplayer-setting-speed {
  display: none;
}
.dplayer.dplayer-live .dplayer-setting-loop {
  display: none;
}
.dplayer.dplayer-live.dplayer-no-danmaku .dplayer-setting {
  display: none;
}
.dplayer.dplayer-arrow .dplayer-danmaku {
  font-size: 18px;
}
.dplayer.dplayer-arrow .dplayer-icon {
  margin: 0 -3px;
}
.dplayer.dplayer-playing .dplayer-danmaku .dplayer-danmaku-move {
  animation-play-state: running;
}
@media (min-width: 900px) {
  .dplayer.dplayer-playing .dplayer-controller-mask {
    opacity: 0;
  }
  .dplayer.dplayer-playing .dplayer-controller {
    opacity: 0;
  }
  .dplayer.dplayer-playing:hover .dplayer-controller-mask {
    opacity: 1;
  }
  .dplayer.dplayer-playing:hover .dplayer-controller {
    opacity: 1;
  }
}
.dplayer.dplayer-loading .dplayer-bezel .diplayer-loading-icon {
  display: block;
}
.dplayer.dplayer-loading .dplayer-danmaku,
.dplayer.dplayer-paused .dplayer-danmaku,
.dplayer.dplayer-loading .dplayer-danmaku-move,
.dplayer.dplayer-paused .dplayer-danmaku-move {
  animation-play-state: paused;
}
.dplayer.dplayer-hide-controller {
  cursor: none;
}
.dplayer.dplayer-hide-controller .dplayer-controller-mask {
  opacity: 0;
  transform: translateY(100%);
}
.dplayer.dplayer-hide-controller .dplayer-controller {
  opacity: 0;
  transform: translateY(100%);
}
.dplayer.dplayer-show-controller .dplayer-controller-mask {
  opacity: 1;
}
.dplayer.dplayer-show-controller .dplayer-controller {
  opacity: 1;
}
.dplayer.dplayer-fulled {
  width: 100% !important;
  height: 100% !important;
}
.dplayer.dplayer-fulled {
  position: fixed;
  z-index: 100000;
  left: 0;
  top: 0;
}
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-volume,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-camera-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-airplay-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-chromecast-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-play-icon {
  display: none;
}
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-full .dplayer-full-in-icon {
  position: static;
  display: inline-block;
}
.dplayer.dplayer-mobile .dplayer-bar-time {
  display: none;
}
.dplayer.dplayer-mobile.dplayer-hide-controller .dplayer-mobile-play {
  display: none;
}
.dplayer.dplayer-mobile .dplayer-mobile-play {
  display: block;
}
.dplayer-web-fullscreen-fix {
  position: fixed;
  top: 0;
  left: 0;
  margin: 0;
  padding: 0;
}
[data-balloon]:before {
  display: none;
}
[data-balloon]:after {
  padding: 0.3em 0.7em;
  background: rgba(17, 17, 17, 0.7);
}
[data-balloon][data-balloon-pos="up"]:after {
  margin-bottom: 0;
}
.dplayer-bezel {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  font-size: 22px;
  color: #fff;
  pointer-events: none;
}
.dplayer-bezel .dplayer-bezel-icon {
  position: absolute;
  top: 50%;
  left: 50%;
  margin: -26px 0 0 -26px;
  height: 52px;
  width: 52px;
  padding: 12px;
  box-sizing: border-box;
  background: rgba(0, 0, 0, 0.5);
  border-radius: 50%;
  opacity: 0;
  pointer-events: none;
}
.dplayer-bezel .dplayer-bezel-icon.dplayer-bezel-transition {
  animation: bezel-hide 0.5s linear;
}
@keyframes bezel-hide {
  from {
    opacity: 1;
    transform: scale(1);
  }
  to {
    opacity: 0;
    transform: scale(2);
  }
}
.dplayer-bezel .dplayer-danloading {
  position: absolute;
  top: 50%;
  margin-top: -7px;
  width: 100%;
  text-align: center;
  font-size: 14px;
  line-height: 14px;
  animation: my-face 5s infinite ease-in-out;
}
.dplayer-bezel .diplayer-loading-icon {
  display: none;
  position: absolute;
  top: 50%;
  left: 50%;
  margin: -18px 0 0 -18px;
  height: 36px;
  width: 36px;
  pointer-events: none;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-hide {
  display: none;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot {
  animation: diplayer-loading-dot-fade 0.8s ease infinite;
  opacity: 0;
  transform-origin: 4px 4px;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-1 {
  animation-delay: 0.1s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-2 {
  animation-delay: 0.2s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-3 {
  animation-delay: 0.3s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-4 {
  animation-delay: 0.4s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-5 {
  animation-delay: 0.5s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-6 {
  animation-delay: 0.6s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-7 {
  animation-delay: 0.7s;
}
@keyframes diplayer-loading-dot-fade {
  0% {
    opacity: 0.7;
    transform: scale(1.2, 1.2);
  }
  50% {
    opacity: 0.25;
    transform: scale(0.9, 0.9);
  }
  to {
    opacity: 0.25;
    transform: scale(0.85, 0.85);
  }
}
.dplayer-controller-mask {
  background: url(`+O+`) repeat-x bottom;
  height: 98px;
  width: 100%;
  position: absolute;
  bottom: 0;
  transition: all 0.3s ease;
}
.dplayer-controller {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 41px;
  padding: 0 20px;
  -webkit-user-select: none;
     -moz-user-select: none;
          user-select: none;
  transition: all 0.3s ease;
}
.dplayer-controller.dplayer-controller-comment .dplayer-icons {
  display: none;
}
.dplayer-controller.dplayer-controller-comment .dplayer-icons.dplayer-comment-box {
  display: block;
}
.dplayer-controller .dplayer-bar-wrap {
  padding: 5px 0;
  cursor: pointer;
  position: absolute;
  bottom: 33px;
  width: calc(100% - 40px);
  height: 3px;
}
.dplayer-controller .dplayer-bar-wrap:hover .dplayer-bar .dplayer-played .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-bar-wrap:hover .dplayer-highlight {
  display: block;
  width: 8px;
  transform: translateX(-4px);
  top: 4px;
  height: 40%;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight {
  z-index: 12;
  position: absolute;
  top: 5px;
  width: 6px;
  height: 20%;
  border-radius: 6px;
  background-color: #fff;
  text-align: center;
  transform: translateX(-3px);
  transition: all 0.2s ease-in-out;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover .dplayer-highlight-text {
  display: block;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover ~ .dplayer-bar-preview {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover ~ .dplayer-bar-time {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight .dplayer-highlight-text {
  display: none;
  position: absolute;
  left: 50%;
  top: -24px;
  padding: 5px 8px;
  background-color: rgba(0, 0, 0, 0.62);
  color: #fff;
  border-radius: 4px;
  font-size: 12px;
  white-space: nowrap;
  transform: translateX(-50%);
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-preview {
  position: absolute;
  background: #fff;
  pointer-events: none;
  display: none;
  background-size: 16000px 100%;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-preview-canvas {
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: 1;
  pointer-events: none;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-time {
  position: absolute;
  left: 0px;
  top: -20px;
  border-radius: 4px;
  padding: 5px 7px;
  background-color: rgba(0, 0, 0, 0.62);
  color: #fff;
  font-size: 12px;
  text-align: center;
  opacity: 1;
  transition: opacity 0.1s ease-in-out;
  word-wrap: normal;
  word-break: normal;
  z-index: 2;
  pointer-events: none;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-time.hidden {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar {
  position: relative;
  height: 3px;
  width: 100%;
  background: rgba(255, 255, 255, 0.2);
  cursor: pointer;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-loaded {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  background: rgba(255, 255, 255, 0.4);
  height: 3px;
  transition: all 0.5s ease;
  will-change: width;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-played {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  height: 3px;
  will-change: width;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-played .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons {
  height: 38px;
  position: absolute;
  bottom: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box {
  display: none;
  position: absolute;
  transition: all 0.3s ease-in-out;
  z-index: 2;
  height: 38px;
  bottom: 0;
  left: 20px;
  right: 20px;
  color: #fff;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-icon {
  padding: 7px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-icon {
  position: absolute;
  left: 0;
  top: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-send-icon {
  position: absolute;
  right: 0;
  top: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box {
  position: absolute;
  background: rgba(28, 28, 28, 0.9);
  bottom: 41px;
  left: 0;
  box-shadow: 0 0 25px rgba(0, 0, 0, 0.3);
  border-radius: 4px;
  padding: 10px 10px 16px;
  font-size: 14px;
  width: 204px;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box.dplayer-comment-setting-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box input[type=radio] {
  display: none;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box label {
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-title {
  font-size: 13px;
  color: #fff;
  line-height: 30px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type {
  font-size: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type .dplayer-comment-setting-title {
  margin-bottom: 6px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type label:nth-child(2) span {
  border-radius: 4px 0 0 4px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type label:nth-child(4) span {
  border-radius: 0 4px 4px 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type span {
  width: 33%;
  padding: 4px 6px;
  line-height: 16px;
  display: inline-block;
  font-size: 12px;
  color: #fff;
  border: 1px solid #fff;
  margin-right: -1px;
  box-sizing: border-box;
  text-align: center;
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type input:checked + span {
  background: #E4E4E6;
  color: #1c1c1c;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color {
  font-size: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color label {
  font-size: 0;
  padding: 6px;
  display: inline-block;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color span {
  width: 22px;
  height: 22px;
  display: inline-block;
  border-radius: 50%;
  box-sizing: border-box;
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color span:hover {
  animation: my-face 5s infinite ease-in-out;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input {
  outline: none;
  border: none;
  padding: 8px 31px;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  border-radius: 4px;
  background: none;
  margin: 0;
  height: 100%;
  box-sizing: border-box;
  width: 100%;
  color: #fff;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::-moz-placeholder {
  color: #fff;
  opacity: 0.8;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::placeholder {
  color: #fff;
  opacity: 0.8;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::-ms-clear {
  display: none;
}
.dplayer-controller .dplayer-icons.dplayer-icons-left .dplayer-icon {
  padding: 7px;
}
.dplayer-controller .dplayer-icons.dplayer-icons-right {
  right: 20px;
}
.dplayer-controller .dplayer-icons.dplayer-icons-right .dplayer-icon {
  padding: 8px;
}
.dplayer-controller .dplayer-icons .dplayer-time,
.dplayer-controller .dplayer-icons .dplayer-live-badge {
  line-height: 38px;
  color: #eee;
  text-shadow: 0 0 2px rgba(0, 0, 0, 0.5);
  vertical-align: middle;
  font-size: 13px;
  cursor: default;
}
.dplayer-controller .dplayer-icons .dplayer-live-dot {
  display: inline-block;
  width: 6px;
  height: 6px;
  vertical-align: 4%;
  margin-right: 5px;
  content: '';
  border-radius: 6px;
}
.dplayer-controller .dplayer-icons .dplayer-icon {
  width: 40px;
  height: 100%;
  border: none;
  background-color: transparent;
  outline: none;
  cursor: pointer;
  vertical-align: middle;
  box-sizing: border-box;
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-icon .dplayer-icon-content {
  transition: all 0.2s ease-in-out;
  opacity: 0.8;
}
.dplayer-controller .dplayer-icons .dplayer-icon:hover .dplayer-icon-content {
  opacity: 1;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-quality-icon {
  color: #fff;
  width: auto;
  line-height: 22px;
  font-size: 14px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-comment-icon {
  padding: 10px 9px 9px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-setting-icon {
  padding-top: 8.5px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-volume-icon {
  width: 43px;
}
.dplayer-controller .dplayer-icons .dplayer-volume {
  position: relative;
  display: inline-block;
  cursor: pointer;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-volume:hover .dplayer-volume-bar-wrap .dplayer-volume-bar {
  width: 45px;
}
.dplayer-controller .dplayer-icons .dplayer-volume:hover .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-volume.dplayer-volume-active .dplayer-volume-bar-wrap .dplayer-volume-bar {
  width: 45px;
}
.dplayer-controller .dplayer-icons .dplayer-volume.dplayer-volume-active .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap {
  display: inline-block;
  margin: 0 10px 0 -5px;
  vertical-align: middle;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar {
  position: relative;
  top: 17px;
  width: 0;
  height: 3px;
  background: #aaa;
  transition: all 0.3s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 100%;
  transition: all 0.1s ease;
  will-change: width;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons .dplayer-subtitle-btn {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box {
  position: absolute;
  right: 0;
  bottom: 50px;
  transform: scale(0);
  width: -moz-fit-content;
  width: fit-content;
  max-width: 240px;
  min-width: 120px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 7px 0;
  transition: all 0.3s ease-in-out;
  overflow: auto;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box.dplayer-subtitles-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box.dplayer-subtitles-box-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-item {
  height: 30px;
  padding: 5px 10px;
  box-sizing: border-box;
  cursor: pointer;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-setting {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box {
  position: absolute;
  right: 0;
  bottom: 50px;
  transform: scale(0);
  width: 150px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 7px 0;
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box > div {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box > div.dplayer-setting-origin-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-narrow {
  width: 70px;
  text-align: center;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-speed .dplayer-setting-origin-panel {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-speed .dplayer-setting-speed-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-item,
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-speed-item {
  height: 30px;
  padding: 5px 10px;
  box-sizing: border-box;
  cursor: pointer;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-item:hover,
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-speed-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku {
  padding: 5px 0;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-label {
  padding: 0 10px;
  display: inline;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku:hover .dplayer-label {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku:hover .dplayer-danmaku-bar-wrap {
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-label {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-danmaku-bar-wrap {
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap {
  padding: 0 10px;
  box-sizing: border-box;
  display: none;
  vertical-align: middle;
  height: 100%;
  width: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar {
  position: relative;
  top: 8.5px;
  width: 100%;
  height: 3px;
  background: #fff;
  transition: all 0.3s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar .dplayer-danmaku-bar-inner {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 100%;
  transition: all 0.1s ease;
  background: #aaa;
  will-change: width;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar .dplayer-danmaku-bar-inner .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  background: #aaa;
}
.dplayer-controller .dplayer-icons .dplayer-full {
  display: inline-block;
  height: 100%;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-full:hover .dplayer-full-in-icon {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-full .dplayer-full-in-icon {
  position: absolute;
  top: -30px;
  z-index: 1;
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-quality {
  position: relative;
  display: inline-block;
  height: 100%;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-quality:hover .dplayer-quality-list {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-quality:hover .dplayer-quality-mask {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-mask {
  display: none;
  position: absolute;
  bottom: 38px;
  left: -18px;
  width: 80px;
  padding-bottom: 12px;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-list {
  display: none;
  font-size: 12px;
  width: 80px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 5px 0;
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  color: #fff;
  text-align: center;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-item {
  height: 25px;
  box-sizing: border-box;
  cursor: pointer;
  line-height: 25px;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-comment {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-label {
  color: #eee;
  font-size: 13px;
  display: inline-block;
  vertical-align: middle;
  white-space: nowrap;
}
.dplayer-controller .dplayer-icons .dplayer-toggle {
  width: 32px;
  height: 20px;
  text-align: center;
  font-size: 0;
  vertical-align: middle;
  position: absolute;
  top: 5px;
  right: 10px;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input {
  max-height: 0;
  max-width: 0;
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label {
  display: inline-block;
  position: relative;
  box-shadow: #dfdfdf 0 0 0 0 inset;
  border: 1px solid #dfdfdf;
  height: 20px;
  width: 32px;
  border-radius: 10px;
  box-sizing: border-box;
  cursor: pointer;
  transition: 0.2s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label:before {
  content: "";
  position: absolute;
  display: block;
  height: 18px;
  width: 18px;
  top: 0;
  left: 0;
  border-radius: 15px;
  transition: 0.2s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label:after {
  content: "";
  position: absolute;
  display: block;
  left: 0;
  top: 0;
  border-radius: 15px;
  background: #fff;
  transition: 0.2s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
  height: 18px;
  width: 18px;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label {
  border-color: rgba(255, 255, 255, 0.5);
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label:before {
  width: 30px;
  background: rgba(255, 255, 255, 0.5);
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label:after {
  left: 12px;
}
.dplayer-mobile-play {
  display: none;
  width: 50px;
  height: 50px;
  border: none;
  background-color: transparent;
  outline: none;
  cursor: pointer;
  box-sizing: border-box;
  bottom: 0;
  opacity: 0.8;
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
}
.dplayer-danmaku {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  font-size: 22px;
  color: #fff;
}
.dplayer-danmaku .dplayer-danmaku-item {
  display: inline-block;
  pointer-events: none;
  -webkit-user-select: none;
     -moz-user-select: none;
          user-select: none;
  cursor: default;
  white-space: nowrap;
  text-shadow: 0.5px 0.5px 0.5px rgba(0, 0, 0, 0.5);
}
.dplayer-danmaku .dplayer-danmaku-item--demo {
  position: absolute;
  visibility: hidden;
}
.dplayer-danmaku .dplayer-danmaku-right {
  position: absolute;
  right: 0;
  transform: translateX(100%);
}
.dplayer-danmaku .dplayer-danmaku-right.dplayer-danmaku-move {
  will-change: transform;
  animation-name: 'danmaku';
  animation-timing-function: linear;
  animation-play-state: paused;
}
@keyframes danmaku {
  from {
    transform: translateX(100%);
  }
}
.dplayer-danmaku .dplayer-danmaku-top,
.dplayer-danmaku .dplayer-danmaku-bottom {
  position: absolute;
  width: 100%;
  text-align: center;
  visibility: hidden;
}
.dplayer-danmaku .dplayer-danmaku-top.dplayer-danmaku-move,
.dplayer-danmaku .dplayer-danmaku-bottom.dplayer-danmaku-move {
  will-change: visibility;
  animation-name: 'danmaku-center';
  animation-timing-function: linear;
  animation-play-state: paused;
}
@keyframes danmaku-center {
  from {
    visibility: visible;
  }
  to {
    visibility: visible;
  }
}
.dplayer-logo {
  pointer-events: none;
  position: absolute;
  left: 20px;
  top: 20px;
  max-width: 50px;
  max-height: 50px;
}
.dplayer-logo img {
  max-width: 100%;
  max-height: 100%;
  background: none;
}
.dplayer-menu {
  position: absolute;
  width: 170px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.85);
  padding: 5px 0;
  overflow: hidden;
  z-index: 3;
  display: none;
}
.dplayer-menu.dplayer-menu-show {
  display: block;
}
.dplayer-menu .dplayer-menu-item {
  height: 30px;
  box-sizing: border-box;
  cursor: pointer;
}
.dplayer-menu .dplayer-menu-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-menu .dplayer-menu-item a {
  padding: 0 10px;
  line-height: 30px;
  color: #eee;
  font-size: 13px;
  display: inline-block;
  vertical-align: middle;
  width: 100%;
  box-sizing: border-box;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
.dplayer-menu .dplayer-menu-item a:hover {
  text-decoration: none;
}
.dplayer-notice-list {
  position: absolute;
  bottom: 60px;
  left: 20px;
}
.dplayer-notice-list .dplayer-notice {
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  color: #fff;
  display: table;
  pointer-events: none;
  animation: showNotice 0.3s ease 1 forwards;
}
.dplayer-notice-list .remove-notice {
  animation: removeNotice 0.3s ease 1 forwards;
}
@keyframes showNotice {
  from {
    padding: 0;
    font-size: 0;
    margin-top: 0;
  }
  to {
    padding: 7px 20px;
    font-size: 14px;
    margin-top: 5px;
  }
}
@keyframes removeNotice {
  0% {
    padding: 7px 20px;
    font-size: 14px;
    margin-top: 5px;
  }
  20% {
    font-size: 12px;
  }
  21% {
    font-size: 0;
    padding: 7px 10px;
  }
  100% {
    padding: 0;
    margin-top: 0;
    font-size: 0;
  }
}
.dplayer-subtitle {
  position: absolute;
  bottom: 40px;
  width: 90%;
  left: 5%;
  text-align: center;
  color: #fff;
  text-shadow: 0.5px 0.5px 0.5px rgba(0, 0, 0, 0.5);
  font-size: 20px;
}
.dplayer-subtitle.dplayer-subtitle-hide {
  display: none;
}
.dplayer-mask {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 1;
  display: none;
}
.dplayer-mask.dplayer-mask-show {
  display: block;
}
.dplayer-video-wrap {
  position: relative;
  background: #000;
  font-size: 0;
  width: 100%;
  height: 100%;
}
.dplayer-video-wrap .dplayer-video {
  width: 100%;
  height: 100%;
  display: none;
}
.dplayer-video-wrap .dplayer-video-current {
  display: block;
}
.dplayer-video-wrap .dplayer-video-prepare {
  display: none;
}
.dplayer-info-panel {
  position: absolute;
  top: 10px;
  left: 10px;
  width: 400px;
  background: rgba(28, 28, 28, 0.8);
  padding: 10px;
  color: #fff;
  font-size: 12px;
  border-radius: 2px;
}
.dplayer-info-panel-hide {
  display: none;
}
.dplayer-info-panel .dplayer-info-panel-close {
  cursor: pointer;
  position: absolute;
  right: 10px;
  top: 10px;
}
.dplayer-info-panel .dplayer-info-panel-item > span {
  display: inline-block;
  vertical-align: middle;
  line-height: 15px;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
.dplayer-info-panel .dplayer-info-panel-item-title {
  width: 100px;
  text-align: right;
  margin-right: 10px;
}
.dplayer-info-panel .dplayer-info-panel-item-data {
  width: 260px;
}
`,"",{version:3,sources:["webpack://./src/css/global.less","webpack://./src/css/index.less","webpack://./src/css/player.less","webpack://./src/css/balloon.less","webpack://./src/css/bezel.less","webpack://./src/css/notice.less","webpack://./src/css/controller.less","webpack://./src/css/danmaku.less","webpack://./src/css/logo.less","webpack://./src/css/menu.less","webpack://./src/css/subtitle.less","webpack://./src/css/video.less","webpack://./src/css/info-panel.less"],names:[],mappings:"AAAA;EACI;IACI,6CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;;IAEI,uCAAA;ECEN;AACF;ACzJA;EACI,kBAAA;EACA,gBAAA;EACA,yBAAA;KAAA,sBAAA;UAAA,iBAAA;EACA,cAAA;AD2JJ;AC/JA;EAOQ,uBAAA;AD2JR;AClKA;EAWQ,WAAA;EACA,YAAA;AD0JR;ACtKA;;EAgBY,UAAA;AD0JZ;ACtJI;EACI,WAAA;EACA,YAAA;EACA,gBAAA;EACA,eAAA;EACA,eAAA;EACA,OAAA;EACA,MAAA;EACA,SAAA;EACA,UAAA;EACA,0BAAA;ADwJR;ACpJI;;;EAKY,aAAA;ADoJhB;ACzJI;EAUQ,aAAA;ADkJZ;AC5JI;EAcQ,aAAA;ADiJZ;AC7II;EAEQ,aAAA;AD8IZ;AChJI;EAKQ,aAAA;AD8IZ;ACnJI;EAQQ,aAAA;AD8IZ;ACtJI;EAWQ,aAAA;AD8IZ;AC3IQ;EAEQ,aAAA;AD4IhB;ACvII;EAEQ,eAAA;ADwIZ;AC1II;EAKQ,cAAA;ADwIZ;ACpII;EAEQ,6BAAA;ADqIZ;AClIQ;EAAA;IAEQ,UAAA;EDoId;ECtIM;IAKQ,UAAA;EDoId;ECjIU;IAEQ,UAAA;EDkIlB;ECpIU;IAKQ,UAAA;EDkIlB;AACF;AC7HI;EAEQ,cAAA;AD8HZ;AC1HI;;;;EAIQ,4BAAA;AD4HZ;ACxHI;EACI,YAAA;AD0HR;AC3HI;EAIQ,UAAA;EACA,2BAAA;AD0HZ;AC/HI;EAQQ,UAAA;EACA,2BAAA;AD0HZ;ACvHI;EAEQ,UAAA;ADwHZ;AC1HI;EAKQ,UAAA;ADwHZ;ACrHI;EAKI,sBAAA;EACA,uBAAA;ADuHR;AC7HI;EACI,eAAA;EACA,eAAA;EACA,OAAA;EACA,MAAA;ADyHR;ACrHI;;;;;EAOY,aAAA;ADqHhB;AC5HI;EAUY,gBAAA;EACA,qBAAA;ADqHhB;AChII;EAgBQ,aAAA;ADmHZ;AChHQ;EAEQ,aAAA;ADiHhB;ACtII;EA0BQ,cAAA;AD+GZ;ACzGA;EACI,eAAA;EACA,MAAA;EACA,OAAA;EACA,SAAA;EACA,UAAA;AD2GJ;AElSA;EACI,aAAA;AFoSJ;AEjSA;EACI,oBAAA;EACA,iCAAA;AFmSJ;AEhSA;EACI,gBAAA;AFkSJ;AG9SA;EACI,kBAAA;EACA,OAAA;EACA,QAAA;EACA,MAAA;EACA,SAAA;EACA,eAAA;EACA,WAAA;EACA,oBAAA;AHgTJ;AGxTA;EAUQ,kBAAA;EACA,QAAA;EACA,SAAA;EACA,uBAAA;EACA,YAAA;EACA,WAAA;EACA,aAAA;EACA,sBAAA;EACA,8BAAA;EACA,kBAAA;EACA,UAAA;EACA,oBAAA;AHiTR;AGhTQ;EACI,iCAAA;AHkTZ;AGhTQ;EACI;IACI,UAAA;IACA,mBAAA;EHkTd;EGhTU;IACI,UAAA;IACA,mBAAA;EHkTd;AACF;AGnVA;EAqCQ,kBAAA;EACA,QAAA;EACA,gBAAA;EACA,WAAA;EACA,kBAAA;EACA,eAAA;EACA,iBAAA;EACA,0CAAA;AHiTR;AG7VA;EA+CQ,aAAA;EACA,kBAAA;EACA,QAAA;EACA,SAAA;EACA,uBAAA;EACA,YAAA;EACA,WAAA;EACA,oBAAA;AHiTR;AGvWA;EAwDY,aAAA;AHkTZ;AG1WA;EA2DY,uDAAA;EACA,UAAA;EACA,yBAAA;AHkTZ;AI/WC;EDgEmB,qBAAA;AHkTpB;AIlXC;EDgEmB,qBAAA;AHqTpB;AIrXC;EDgEmB,qBAAA;AHwTpB;AIxXC;EDgEmB,qBAAA;AH2TpB;AI3XC;EDgEmB,qBAAA;AH8TpB;AI9XC;EDgEmB,qBAAA;AHiUpB;AIjYC;EDgEmB,qBAAA;AHoUpB;AGhUQ;EACI;IACI,YAAA;IACA,0BAAA;EHkUd;EGhUU;IACI,aAAA;IACA,0BAAA;EHkUd;EGhUU;IACI,aAAA;IACA,4BAAA;EHkUd;AACF;AKlZA;EACI,mEAAA;EACA,YAAA;EACA,WAAA;EACA,kBAAA;EACA,SAAA;EACA,yBAAA;ALoZJ;AKjZA;EACI,kBAAA;EACA,SAAA;EACA,OAAA;EACA,QAAA;EACA,YAAA;EACA,eAAA;EACA,yBAAA;KAAA,sBAAA;UAAA,iBAAA;EACA,yBAAA;ALmZJ;AKlZI;EAEQ,aAAA;ALmZZ;AKrZI;EAKQ,cAAA;ALmZZ;AKjaA;EAkBQ,cAAA;EACA,eAAA;EACA,kBAAA;EACA,YAAA;EACA,wBAAA;EACA,WAAA;ALkZR;AKjZQ;EAEQ,mBAAA;ALkZhB;AKpZQ;EAKQ,cAAA;EACA,UAAA;EACA,2BAAA;EACA,QAAA;EACA,WAAA;ALkZhB;AKnbA;EAqCY,WAAA;EACA,kBAAA;EACA,QAAA;EACA,UAAA;EACA,WAAA;EACA,kBAAA;EACA,sBAAA;EACA,kBAAA;EACA,2BAAA;EACA,gCAAA;ALiZZ;AKhZY;EAEQ,cAAA;ALiZpB;AK/YgB;EACI,UAAA;ALiZpB;AK/YgB;EACI,UAAA;ALiZpB;AKxcA;EA2DgB,aAAA;EACA,kBAAA;EACA,SAAA;EACA,UAAA;EACA,gBAAA;EACA,qCAAA;EACA,WAAA;EACA,kBAAA;EACA,eAAA;EACA,mBAAA;EACA,2BAAA;ALgZhB;AKrdA;EAyEY,kBAAA;EACA,gBAAA;EACA,oBAAA;EACA,aAAA;EACA,6BAAA;AL+YZ;AK5dA;EAgFY,kBAAA;EACA,WAAA;EACA,YAAA;EACA,UAAA;EACA,oBAAA;AL+YZ;AKneA;EA0FY,kBAAA;EACA,SAAA;EACA,UAAA;EACA,kBAAA;EACA,gBAAA;EACA,qCAAA;EACA,WAAA;EACA,eAAA;EACA,kBAAA;EACA,UAAA;EACA,oCAAA;EACA,iBAAA;EACA,kBAAA;EACA,UAAA;EACA,oBAAA;AL4YZ;AK7ZY;EACI,UAAA;AL+ZhB;AKvfA;EA2GY,kBAAA;EACA,WAAA;EACA,WAAA;EACA,oCAAA;EACA,eAAA;AL+YZ;AK9fA;EAiHgB,kBAAA;EACA,OAAA;EACA,MAAA;EACA,SAAA;EACA,oCAAA;EACA,WAAA;EACA,yBAAA;EACA,kBAAA;ALgZhB;AKxgBA;EA2HgB,kBAAA;EACA,OAAA;EACA,MAAA;EACA,SAAA;EACA,WAAA;EACA,kBAAA;ALgZhB;AKhhBA;EAkIoB,kBAAA;EACA,MAAA;EACA,UAAA;EACA,gBAAA;EACA,mBAAA;EACA,YAAA;EACA,WAAA;EACA,kBAAA;EACA,eAAA;EACA,gCAAA;EACA,mBAAA;ALiZpB;AK7hBA;EAkJQ,YAAA;EACA,kBAAA;EACA,SAAA;AL8YR;AK7YQ;EACI,aAAA;EACA,kBAAA;EACA,gCAAA;EACA,UAAA;EACA,YAAA;EACA,SAAA;EACA,UAAA;EACA,WAAA;EACA,WAAA;AL+YZ;AKxZQ;EAWQ,YAAA;ALgZhB;AK3ZQ;EAcQ,kBAAA;EACA,OAAA;EACA,MAAA;ALgZhB;AKhaQ;EAmBQ,kBAAA;EACA,QAAA;EACA,MAAA;ALgZhB;AKraQ;EAwBQ,kBAAA;EACA,iCAAA;EACA,YAAA;EACA,OAAA;EACA,uCAAA;EACA,kBAAA;EACA,uBAAA;EACA,eAAA;EACA,YAAA;EACA,gCAAA;EACA,mBAAA;ALgZhB;AK/YgB;EACI,mBAAA;ALiZpB;AKrbQ;EAuCY,aAAA;ALiZpB;AKxbQ;EA0CY,eAAA;ALiZpB;AK3bQ;EA6CY,eAAA;EACA,WAAA;EACA,iBAAA;ALiZpB;AKhcQ;EAkDY,YAAA;ALiZpB;AKncQ;EAoDgB,kBAAA;ALkZxB;AK/YwB;EAEQ,0BAAA;ALgZhC;AK7YwB;EAEQ,0BAAA;AL8YhC;AK5cQ;EAmEgB,UAAA;EACA,gBAAA;EACA,iBAAA;EACA,qBAAA;EACA,eAAA;EACA,WAAA;EACA,sBAAA;EACA,kBAAA;EACA,sBAAA;EACA,kBAAA;EACA,eAAA;AL4YxB;AKzdQ;EAgFgB,mBAAA;EACA,cAAA;AL4YxB;AK7dQ;EAqFY,YAAA;AL2YpB;AKheQ;EAuFgB,YAAA;EACA,YAAA;EACA,qBAAA;AL4YxB;AKreQ;EA4FgB,WAAA;EACA,YAAA;EACA,qBAAA;EACA,kBAAA;EACA,sBAAA;EACA,eAAA;AL4YxB;AK3YwB;EACI,0CAAA;AL6Y5B;AKhfQ;EAyGQ,aAAA;EACA,YAAA;EACA,iBAAA;EACA,eAAA;EACA,iBAAA;EACA,kBAAA;EACA,kBAAA;EACA,gBAAA;EACA,SAAA;EACA,YAAA;EACA,sBAAA;EACA,WAAA;EACA,WAAA;AL0YhB;AKzYgB;EACI,WAAA;EACA,YAAA;AL2YpB;AK7YgB;EACI,WAAA;EACA,YAAA;AL2YpB;AKzYgB;EACI,aAAA;AL2YpB;AKvYQ;EAEQ,YAAA;ALwYhB;AKrYQ;EACI,WAAA;ALuYZ;AKxYQ;EAGQ,YAAA;ALwYhB;AKpqBA;;EAiSY,iBAAA;EACA,WAAA;EACA,uCAAA;EACA,sBAAA;EACA,eAAA;EACA,eAAA;ALuYZ;AK7qBA;EAySY,qBAAA;EACA,UAAA;EACA,WAAA;EACA,kBAAA;EACA,iBAAA;EACA,WAAA;EACA,kBAAA;ALuYZ;AKtrBA;EAkTY,WAAA;EACA,YAAA;EACA,YAAA;EACA,6BAAA;EACA,aAAA;EACA,eAAA;EACA,sBAAA;EACA,sBAAA;EACA,qBAAA;ALuYZ;AKjsBA;EA4TgB,gCAAA;EACA,YAAA;ALwYhB;AKtYY;EAEQ,UAAA;ALuYpB;AKpYY;EACI,WAAA;EACA,WAAA;EACA,iBAAA;EACA,eAAA;ALsYhB;AKpYY;EACI,qBAAA;ALsYhB;AKpYY;EACI,kBAAA;ALsYhB;AKpYY;EACI,WAAA;ALsYhB;AKvtBA;EAqVY,kBAAA;EACA,qBAAA;EACA,eAAA;EACA,YAAA;ALqYZ;AKpYY;EAEQ,WAAA;ALqYpB;AKvYY;EAKQ,mBAAA;ALqYpB;AKlYY;EAEQ,WAAA;ALmYpB;AKrYY;EAKQ,mBAAA;ALmYpB;AKzuBA;EA0WgB,qBAAA;EACA,qBAAA;EACA,sBAAA;EACA,YAAA;ALkYhB;AK/uBA;EA+WoB,kBAAA;EACA,SAAA;EACA,QAAA;EACA,WAAA;EACA,gBAAA;EACA,gCAAA;ALmYpB;AKvvBA;EAsXwB,kBAAA;EACA,SAAA;EACA,OAAA;EACA,YAAA;EACA,yBAAA;EACA,kBAAA;ALoYxB;AK/vBA;EA6X4B,kBAAA;EACA,MAAA;EACA,UAAA;EACA,gBAAA;EACA,mBAAA;EACA,YAAA;EACA,WAAA;EACA,kBAAA;EACA,eAAA;EACA,gCAAA;EACA,mBAAA;ALqY5B;AK5wBA;EA8YY,qBAAA;EACA,YAAA;ALiYZ;AKhxBA;EAkZY,qBAAA;EACA,YAAA;ALiYZ;AKpxBA;EAqZgB,kBAAA;EACA,QAAA;EACA,YAAA;EACA,mBAAA;EACA,uBAAA;EAAA,kBAAA;EACA,gBAAA;EACA,gBAAA;EACA,kBAAA;EACA,iCAAA;EACA,cAAA;EACA,gCAAA;EACA,cAAA;EACA,UAAA;ALkYhB;AKjYgB;EACI,cAAA;ALmYpB;AKjYgB;EACI,mBAAA;ALmYpB;AKzyBA;EA0agB,YAAA;EACA,iBAAA;EACA,sBAAA;EACA,eAAA;EACA,kBAAA;ALkYhB;AKjYgB;EACI,0CAAA;ALmYpB;AKnzBA;EAqbY,qBAAA;EACA,YAAA;ALiYZ;AKvzBA;EAwbgB,kBAAA;EACA,QAAA;EACA,YAAA;EACA,mBAAA;EACA,YAAA;EACA,kBAAA;EACA,iCAAA;EACA,cAAA;EACA,gCAAA;EACA,gBAAA;EACA,UAAA;ALkYhB;AKjYgB;EACI,aAAA;ALmYpB;AKlYoB;EACI,cAAA;ALoYxB;AKjYgB;EACI,mBAAA;ALmYpB;AKjYgB;EACI,WAAA;EACA,kBAAA;ALmYpB;AKjYgB;EAEQ,aAAA;ALkYxB;AKpYgB;EAKQ,cAAA;ALkYxB;AKv1BA;;EA2dgB,YAAA;EACA,iBAAA;EACA,sBAAA;EACA,eAAA;EACA,kBAAA;ALgYhB;AK/XgB;;EACI,0CAAA;ALkYpB;AKn2BA;EAqegB,cAAA;ALiYhB;AKt2BA;EAueoB,eAAA;EACA,eAAA;ALkYpB;AKhYgB;EAEQ,aAAA;ALiYxB;AKnYgB;EAKQ,qBAAA;ALiYxB;AK9XgB;EAEQ,aAAA;AL+XxB;AKjYgB;EAKQ,qBAAA;AL+XxB;AKt3BA;EA2foB,eAAA;EACA,sBAAA;EACA,aAAA;EACA,sBAAA;EACA,YAAA;EACA,WAAA;AL8XpB;AK93BA;EAkgBwB,kBAAA;EACA,UAAA;EACA,WAAA;EACA,WAAA;EACA,gBAAA;EACA,gCAAA;AL+XxB;AKt4BA;EAygB4B,kBAAA;EACA,SAAA;EACA,OAAA;EACA,YAAA;EACA,yBAAA;EACA,gBAAA;EACA,kBAAA;ALgY5B;AK/4BA;EAihBgC,kBAAA;EACA,MAAA;EACA,UAAA;EACA,gBAAA;EACA,mBAAA;EACA,YAAA;EACA,WAAA;EACA,kBAAA;EACA,eAAA;EACA,gCAAA;EACA,gBAAA;ALiYhC;AK55BA;EAmiBY,qBAAA;EACA,YAAA;EACA,kBAAA;AL4XZ;AK3XY;EAEQ,cAAA;AL4XpB;AKp6BA;EA4iBgB,kBAAA;EACA,UAAA;EACA,UAAA;EACA,aAAA;AL2XhB;AK16BA;EAmjBY,kBAAA;EACA,qBAAA;EACA,YAAA;EACA,UAAA;AL0XZ;AKzXY;EAEQ,cAAA;AL0XpB;AK5XY;EAKQ,cAAA;AL0XpB;AKt7BA;EAgkBgB,aAAA;EACA,kBAAA;EACA,YAAA;EACA,WAAA;EACA,WAAA;EACA,oBAAA;ALyXhB;AK97BA;EAwkBgB,aAAA;EACA,eAAA;EACA,WAAA;EACA,kBAAA;EACA,iCAAA;EACA,cAAA;EACA,gCAAA;EACA,gBAAA;EACA,WAAA;EACA,kBAAA;ALyXhB;AK18BA;EAolBgB,YAAA;EACA,sBAAA;EACA,eAAA;EACA,iBAAA;ALyXhB;AKxXgB;EACI,0CAAA;AL0XpB;AKn9BA;EA8lBY,qBAAA;EACA,YAAA;ALwXZ;AKv9BA;EAkmBY,WAAA;EACA,eAAA;EACA,qBAAA;EACA,sBAAA;EACA,mBAAA;ALwXZ;AK99BA;EAymBY,WAAA;EACA,YAAA;EACA,kBAAA;EACA,YAAA;EACA,sBAAA;EACA,kBAAA;EACA,QAAA;EACA,WAAA;ALwXZ;AKx+BA;EAknBgB,aAAA;EACA,YAAA;EACA,aAAA;ALyXhB;AK7+BA;EAunBgB,qBAAA;EACA,kBAAA;EACA,iCAAA;EACA,yBAAA;EACA,YAAA;EACA,WAAA;EACA,mBAAA;EACA,sBAAA;EACA,eAAA;EACA,4BAAA;ALyXhB;AKz/BA;EAmoBgB,WAAA;EACA,kBAAA;EACA,cAAA;EACA,YAAA;EACA,WAAA;EACA,MAAA;EACA,OAAA;EACA,mBAAA;EACA,4BAAA;ALyXhB;AKpgCA;EA8oBgB,WAAA;EACA,kBAAA;EACA,cAAA;EACA,OAAA;EACA,MAAA;EACA,mBAAA;EACA,gBAAA;EACA,4BAAA;EACA,wCAAA;EACA,YAAA;EACA,WAAA;ALyXhB;AKjhCA;EA2pBgB,sCAAA;ALyXhB;AKphCA;EA8pBgB,WAAA;EACA,oCAAA;ALyXhB;AKxhCA;EAkqBgB,UAAA;ALyXhB;AKnXA;EACI,aAAA;EACA,WAAA;EACA,YAAA;EACA,YAAA;EACA,6BAAA;EACA,aAAA;EACA,eAAA;EACA,sBAAA;EAEA,SAAA;EACA,YAAA;EACA,kBAAA;EACA,SAAA;EACA,QAAA;EACA,gCAAA;ALoXJ;AMpjCA;EACI,kBAAA;EACA,OAAA;EACA,QAAA;EACA,MAAA;EACA,SAAA;EACA,eAAA;EACA,WAAA;ANsjCJ;AM7jCA;EASQ,qBAAA;EACA,oBAAA;EACA,yBAAA;KAAA,sBAAA;UAAA,iBAAA;EACA,eAAA;EACA,mBAAA;EACA,iDAAA;ANujCR;AMtjCQ;EACI,kBAAA;EACA,kBAAA;ANwjCZ;AMzkCA;EAqBQ,kBAAA;EACA,QAAA;EACA,2BAAA;ANujCR;AMtjCQ;EACI,sBAAA;EACA,yBAAA;EACA,iCAAA;EACA,4BAAA;ANwjCZ;AMrjCI;EACI;IACI,2BAAA;ENujCV;AACF;AMzlCA;;EAsCQ,kBAAA;EACA,WAAA;EACA,kBAAA;EACA,kBAAA;ANujCR;AMtjCQ;;EACI,uBAAA;EACA,gCAAA;EACA,iCAAA;EACA,4BAAA;ANyjCZ;AMtjCI;EACI;IACI,mBAAA;ENwjCV;EMtjCM;IACI,mBAAA;ENwjCV;AACF;AO/mCA;EACI,oBAAA;EACA,kBAAA;EACA,UAAA;EACA,SAAA;EACA,eAAA;EACA,gBAAA;APinCJ;AOvnCA;EAQQ,eAAA;EACA,gBAAA;EACA,gBAAA;APknCR;AQ5nCA;EACI,kBAAA;EACA,YAAA;EACA,kBAAA;EACA,kCAAA;EACA,cAAA;EACA,gBAAA;EACA,UAAA;EACA,aAAA;AR8nCJ;AQ7nCI;EACI,cAAA;AR+nCR;AQzoCA;EAaQ,YAAA;EACA,sBAAA;EACA,eAAA;AR+nCR;AQ9nCQ;EACI,0CAAA;ARgoCZ;AQjpCA;EAqBY,eAAA;EACA,iBAAA;EACA,WAAA;EACA,eAAA;EACA,qBAAA;EACA,sBAAA;EACA,WAAA;EACA,sBAAA;EACA,mBAAA;EACA,uBAAA;EACA,gBAAA;AR+nCZ;AQ9nCY;EACI,qBAAA;ARgoChB;AIjqCA;EACI,kBAAA;EACA,YAAA;EACA,UAAA;AJmqCJ;AItqCA;EAMQ,kBAAA;EACA,iCAAA;EACA,gCAAA;EACA,gBAAA;EACA,WAAA;EACA,cAAA;EACA,oBAAA;EACA,0CAAA;AJmqCR;AIhrCA;EAiBQ,4CAAA;AJkqCR;AI9pCA;EACI;IACI,UAAA;IACA,YAAA;IACA,aAAA;EJgqCN;EI9pCE;IACI,iBAAA;IACA,eAAA;IACA,eAAA;EJgqCN;AACF;AI7pCA;EACI;IACI,iBAAA;IACA,eAAA;IACA,eAAA;EJ+pCN;EI7pCE;IACI,eAAA;EJ+pCN;EI7pCE;IACI,YAAA;IACA,iBAAA;EJ+pCN;EI7pCE;IACI,UAAA;IACA,aAAA;IACA,YAAA;EJ+pCN;AACF;ASltCA;EACI,kBAAA;EACA,YAAA;EACA,UAAA;EACA,QAAA;EACA,kBAAA;EACA,WAAA;EACA,iDAAA;EACA,eAAA;ATotCJ;ASntCI;EACI,aAAA;ATqtCR;AU/tCA;EACI,kBAAA;EACA,MAAA;EACA,SAAA;EACA,OAAA;EACA,QAAA;EACA,UAAA;EACA,aAAA;AViuCJ;AUhuCI;EACI,cAAA;AVkuCR;AU9tCA;EACI,kBAAA;EACA,gBAAA;EACA,YAAA;EACA,WAAA;EACA,YAAA;AVguCJ;AUruCA;EAOQ,WAAA;EACA,YAAA;EACA,aAAA;AViuCR;AU1uCA;EAYQ,cAAA;AViuCR;AU7uCA;EAeQ,aAAA;AViuCR;AW7vCA;EACI,kBAAA;EACA,SAAA;EACA,UAAA;EACA,YAAA;EACA,iCAAA;EACA,aAAA;EACA,WAAA;EACA,eAAA;EACA,kBAAA;AX+vCJ;AW7vCI;EACI,aAAA;AX+vCR;AW3wCA;EAgBQ,eAAA;EACA,kBAAA;EACA,WAAA;EACA,SAAA;AX8vCR;AW1vCQ;EACI,qBAAA;EACA,sBAAA;EACA,iBAAA;EACA,mBAAA;EACA,uBAAA;EACA,gBAAA;AX4vCZ;AWzxCA;EAkCQ,YAAA;EACA,iBAAA;EACA,kBAAA;AX0vCR;AW9xCA;EAwCQ,YAAA;AXyvCR",sourcesContent:[`@keyframes my-face {
    2% {
        transform: translate(0, 1.5px) rotate(1.5deg);
    }
    4% {
        transform: translate(0, -1.5px) rotate(-0.5deg);
    }
    6% {
        transform: translate(0, 1.5px) rotate(-1.5deg);
    }
    8% {
        transform: translate(0, -1.5px) rotate(-1.5deg);
    }
    10% {
        transform: translate(0, 2.5px) rotate(1.5deg);
    }
    12% {
        transform: translate(0, -0.5px) rotate(1.5deg);
    }
    14% {
        transform: translate(0, -1.5px) rotate(1.5deg);
    }
    16% {
        transform: translate(0, -0.5px) rotate(-1.5deg);
    }
    18% {
        transform: translate(0, 0.5px) rotate(-1.5deg);
    }
    20% {
        transform: translate(0, -1.5px) rotate(2.5deg);
    }
    22% {
        transform: translate(0, 0.5px) rotate(-1.5deg);
    }
    24% {
        transform: translate(0, 1.5px) rotate(1.5deg);
    }
    26% {
        transform: translate(0, 0.5px) rotate(0.5deg);
    }
    28% {
        transform: translate(0, 0.5px) rotate(1.5deg);
    }
    30% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    32% {
        transform: translate(0, 1.5px) rotate(-0.5deg);
    }
    34% {
        transform: translate(0, 1.5px) rotate(-0.5deg);
    }
    36% {
        transform: translate(0, -1.5px) rotate(2.5deg);
    }
    38% {
        transform: translate(0, 1.5px) rotate(-1.5deg);
    }
    40% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    42% {
        transform: translate(0, 2.5px) rotate(-1.5deg);
    }
    44% {
        transform: translate(0, 1.5px) rotate(0.5deg);
    }
    46% {
        transform: translate(0, -1.5px) rotate(2.5deg);
    }
    48% {
        transform: translate(0, -0.5px) rotate(0.5deg);
    }
    50% {
        transform: translate(0, 0.5px) rotate(0.5deg);
    }
    52% {
        transform: translate(0, 2.5px) rotate(2.5deg);
    }
    54% {
        transform: translate(0, -1.5px) rotate(1.5deg);
    }
    56% {
        transform: translate(0, 2.5px) rotate(2.5deg);
    }
    58% {
        transform: translate(0, 0.5px) rotate(2.5deg);
    }
    60% {
        transform: translate(0, 2.5px) rotate(2.5deg);
    }
    62% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    64% {
        transform: translate(0, -0.5px) rotate(1.5deg);
    }
    66% {
        transform: translate(0, 1.5px) rotate(-0.5deg);
    }
    68% {
        transform: translate(0, -1.5px) rotate(-0.5deg);
    }
    70% {
        transform: translate(0, 1.5px) rotate(0.5deg);
    }
    72% {
        transform: translate(0, 2.5px) rotate(1.5deg);
    }
    74% {
        transform: translate(0, -0.5px) rotate(0.5deg);
    }
    76% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    78% {
        transform: translate(0, -0.5px) rotate(1.5deg);
    }
    80% {
        transform: translate(0, 1.5px) rotate(1.5deg);
    }
    82% {
        transform: translate(0, -0.5px) rotate(0.5deg);
    }
    84% {
        transform: translate(0, 1.5px) rotate(2.5deg);
    }
    86% {
        transform: translate(0, -1.5px) rotate(-1.5deg);
    }
    88% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    90% {
        transform: translate(0, 2.5px) rotate(-0.5deg);
    }
    92% {
        transform: translate(0, 0.5px) rotate(-0.5deg);
    }
    94% {
        transform: translate(0, 2.5px) rotate(0.5deg);
    }
    96% {
        transform: translate(0, -0.5px) rotate(1.5deg);
    }
    98% {
        transform: translate(0, -1.5px) rotate(-0.5deg);
    }
    0%,
    100% {
        transform: translate(0, 0) rotate(0deg);
    }
}`,`@import '../../node_modules/balloon-css/balloon.css';
@keyframes my-face {
  2% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  4% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  6% {
    transform: translate(0, 1.5px) rotate(-1.5deg);
  }
  8% {
    transform: translate(0, -1.5px) rotate(-1.5deg);
  }
  10% {
    transform: translate(0, 2.5px) rotate(1.5deg);
  }
  12% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  14% {
    transform: translate(0, -1.5px) rotate(1.5deg);
  }
  16% {
    transform: translate(0, -0.5px) rotate(-1.5deg);
  }
  18% {
    transform: translate(0, 0.5px) rotate(-1.5deg);
  }
  20% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  22% {
    transform: translate(0, 0.5px) rotate(-1.5deg);
  }
  24% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  26% {
    transform: translate(0, 0.5px) rotate(0.5deg);
  }
  28% {
    transform: translate(0, 0.5px) rotate(1.5deg);
  }
  30% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  32% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  34% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  36% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  38% {
    transform: translate(0, 1.5px) rotate(-1.5deg);
  }
  40% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  42% {
    transform: translate(0, 2.5px) rotate(-1.5deg);
  }
  44% {
    transform: translate(0, 1.5px) rotate(0.5deg);
  }
  46% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  48% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  50% {
    transform: translate(0, 0.5px) rotate(0.5deg);
  }
  52% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  54% {
    transform: translate(0, -1.5px) rotate(1.5deg);
  }
  56% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  58% {
    transform: translate(0, 0.5px) rotate(2.5deg);
  }
  60% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  62% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  64% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  66% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  68% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  70% {
    transform: translate(0, 1.5px) rotate(0.5deg);
  }
  72% {
    transform: translate(0, 2.5px) rotate(1.5deg);
  }
  74% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  76% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  78% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  80% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  82% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  84% {
    transform: translate(0, 1.5px) rotate(2.5deg);
  }
  86% {
    transform: translate(0, -1.5px) rotate(-1.5deg);
  }
  88% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  90% {
    transform: translate(0, 2.5px) rotate(-0.5deg);
  }
  92% {
    transform: translate(0, 0.5px) rotate(-0.5deg);
  }
  94% {
    transform: translate(0, 2.5px) rotate(0.5deg);
  }
  96% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  98% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  0%,
  100% {
    transform: translate(0, 0) rotate(0deg);
  }
}
.dplayer {
  position: relative;
  overflow: hidden;
  user-select: none;
  line-height: 1;
}
.dplayer * {
  box-sizing: content-box;
}
.dplayer svg {
  width: 100%;
  height: 100%;
}
.dplayer svg path,
.dplayer svg circle {
  fill: #fff;
}
.dplayer:-webkit-full-screen {
  width: 100%;
  height: 100%;
  background: #000;
  position: fixed;
  z-index: 100000;
  left: 0;
  top: 0;
  margin: 0;
  padding: 0;
  transform: translate(0, 0);
}
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-showdan,
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-danmaku,
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-danunlimit {
  display: none;
}
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-comment {
  display: none;
}
.dplayer.dplayer-no-danmaku .dplayer-danmaku {
  display: none;
}
.dplayer.dplayer-live .dplayer-time {
  display: none;
}
.dplayer.dplayer-live .dplayer-bar-wrap {
  display: none;
}
.dplayer.dplayer-live .dplayer-setting-speed {
  display: none;
}
.dplayer.dplayer-live .dplayer-setting-loop {
  display: none;
}
.dplayer.dplayer-live.dplayer-no-danmaku .dplayer-setting {
  display: none;
}
.dplayer.dplayer-arrow .dplayer-danmaku {
  font-size: 18px;
}
.dplayer.dplayer-arrow .dplayer-icon {
  margin: 0 -3px;
}
.dplayer.dplayer-playing .dplayer-danmaku .dplayer-danmaku-move {
  animation-play-state: running;
}
@media (min-width: 900px) {
  .dplayer.dplayer-playing .dplayer-controller-mask {
    opacity: 0;
  }
  .dplayer.dplayer-playing .dplayer-controller {
    opacity: 0;
  }
  .dplayer.dplayer-playing:hover .dplayer-controller-mask {
    opacity: 1;
  }
  .dplayer.dplayer-playing:hover .dplayer-controller {
    opacity: 1;
  }
}
.dplayer.dplayer-loading .dplayer-bezel .diplayer-loading-icon {
  display: block;
}
.dplayer.dplayer-loading .dplayer-danmaku,
.dplayer.dplayer-paused .dplayer-danmaku,
.dplayer.dplayer-loading .dplayer-danmaku-move,
.dplayer.dplayer-paused .dplayer-danmaku-move {
  animation-play-state: paused;
}
.dplayer.dplayer-hide-controller {
  cursor: none;
}
.dplayer.dplayer-hide-controller .dplayer-controller-mask {
  opacity: 0;
  transform: translateY(100%);
}
.dplayer.dplayer-hide-controller .dplayer-controller {
  opacity: 0;
  transform: translateY(100%);
}
.dplayer.dplayer-show-controller .dplayer-controller-mask {
  opacity: 1;
}
.dplayer.dplayer-show-controller .dplayer-controller {
  opacity: 1;
}
.dplayer.dplayer-fulled {
  position: fixed;
  z-index: 100000;
  left: 0;
  top: 0;
  width: 100% !important;
  height: 100% !important;
}
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-volume,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-camera-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-airplay-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-chromecast-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-play-icon {
  display: none;
}
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-full .dplayer-full-in-icon {
  position: static;
  display: inline-block;
}
.dplayer.dplayer-mobile .dplayer-bar-time {
  display: none;
}
.dplayer.dplayer-mobile.dplayer-hide-controller .dplayer-mobile-play {
  display: none;
}
.dplayer.dplayer-mobile .dplayer-mobile-play {
  display: block;
}
.dplayer-web-fullscreen-fix {
  position: fixed;
  top: 0;
  left: 0;
  margin: 0;
  padding: 0;
}
[data-balloon]:before {
  display: none;
}
[data-balloon]:after {
  padding: 0.3em 0.7em;
  background: rgba(17, 17, 17, 0.7);
}
[data-balloon][data-balloon-pos="up"]:after {
  margin-bottom: 0;
}
.dplayer-bezel {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  font-size: 22px;
  color: #fff;
  pointer-events: none;
}
.dplayer-bezel .dplayer-bezel-icon {
  position: absolute;
  top: 50%;
  left: 50%;
  margin: -26px 0 0 -26px;
  height: 52px;
  width: 52px;
  padding: 12px;
  box-sizing: border-box;
  background: rgba(0, 0, 0, 0.5);
  border-radius: 50%;
  opacity: 0;
  pointer-events: none;
}
.dplayer-bezel .dplayer-bezel-icon.dplayer-bezel-transition {
  animation: bezel-hide 0.5s linear;
}
@keyframes bezel-hide {
  from {
    opacity: 1;
    transform: scale(1);
  }
  to {
    opacity: 0;
    transform: scale(2);
  }
}
.dplayer-bezel .dplayer-danloading {
  position: absolute;
  top: 50%;
  margin-top: -7px;
  width: 100%;
  text-align: center;
  font-size: 14px;
  line-height: 14px;
  animation: my-face 5s infinite ease-in-out;
}
.dplayer-bezel .diplayer-loading-icon {
  display: none;
  position: absolute;
  top: 50%;
  left: 50%;
  margin: -18px 0 0 -18px;
  height: 36px;
  width: 36px;
  pointer-events: none;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-hide {
  display: none;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot {
  animation: diplayer-loading-dot-fade 0.8s ease infinite;
  opacity: 0;
  transform-origin: 4px 4px;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-1 {
  animation-delay: 0.1s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-2 {
  animation-delay: 0.2s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-3 {
  animation-delay: 0.3s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-4 {
  animation-delay: 0.4s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-5 {
  animation-delay: 0.5s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-6 {
  animation-delay: 0.6s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-7 {
  animation-delay: 0.7s;
}
@keyframes diplayer-loading-dot-fade {
  0% {
    opacity: 0.7;
    transform: scale(1.2, 1.2);
  }
  50% {
    opacity: 0.25;
    transform: scale(0.9, 0.9);
  }
  to {
    opacity: 0.25;
    transform: scale(0.85, 0.85);
  }
}
.dplayer-controller-mask {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAADGCAYAAAAT+OqFAAAAdklEQVQoz42QQQ7AIAgEF/T/D+kbq/RWAlnQyyazA4aoAB4FsBSA/bFjuF1EOL7VbrIrBuusmrt4ZZORfb6ehbWdnRHEIiITaEUKa5EJqUakRSaEYBJSCY2dEstQY7AuxahwXFrvZmWl2rh4JZ07z9dLtesfNj5q0FU3A5ObbwAAAABJRU5ErkJggg==) repeat-x bottom;
  height: 98px;
  width: 100%;
  position: absolute;
  bottom: 0;
  transition: all 0.3s ease;
}
.dplayer-controller {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 41px;
  padding: 0 20px;
  user-select: none;
  transition: all 0.3s ease;
}
.dplayer-controller.dplayer-controller-comment .dplayer-icons {
  display: none;
}
.dplayer-controller.dplayer-controller-comment .dplayer-icons.dplayer-comment-box {
  display: block;
}
.dplayer-controller .dplayer-bar-wrap {
  padding: 5px 0;
  cursor: pointer;
  position: absolute;
  bottom: 33px;
  width: calc(100% - 40px);
  height: 3px;
}
.dplayer-controller .dplayer-bar-wrap:hover .dplayer-bar .dplayer-played .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-bar-wrap:hover .dplayer-highlight {
  display: block;
  width: 8px;
  transform: translateX(-4px);
  top: 4px;
  height: 40%;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight {
  z-index: 12;
  position: absolute;
  top: 5px;
  width: 6px;
  height: 20%;
  border-radius: 6px;
  background-color: #fff;
  text-align: center;
  transform: translateX(-3px);
  transition: all 0.2s ease-in-out;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover .dplayer-highlight-text {
  display: block;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover ~ .dplayer-bar-preview {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover ~ .dplayer-bar-time {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight .dplayer-highlight-text {
  display: none;
  position: absolute;
  left: 50%;
  top: -24px;
  padding: 5px 8px;
  background-color: rgba(0, 0, 0, 0.62);
  color: #fff;
  border-radius: 4px;
  font-size: 12px;
  white-space: nowrap;
  transform: translateX(-50%);
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-preview {
  position: absolute;
  background: #fff;
  pointer-events: none;
  display: none;
  background-size: 16000px 100%;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-preview-canvas {
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: 1;
  pointer-events: none;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-time {
  position: absolute;
  left: 0px;
  top: -20px;
  border-radius: 4px;
  padding: 5px 7px;
  background-color: rgba(0, 0, 0, 0.62);
  color: #fff;
  font-size: 12px;
  text-align: center;
  opacity: 1;
  transition: opacity 0.1s ease-in-out;
  word-wrap: normal;
  word-break: normal;
  z-index: 2;
  pointer-events: none;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-time.hidden {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar {
  position: relative;
  height: 3px;
  width: 100%;
  background: rgba(255, 255, 255, 0.2);
  cursor: pointer;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-loaded {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  background: rgba(255, 255, 255, 0.4);
  height: 3px;
  transition: all 0.5s ease;
  will-change: width;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-played {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  height: 3px;
  will-change: width;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-played .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons {
  height: 38px;
  position: absolute;
  bottom: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box {
  display: none;
  position: absolute;
  transition: all 0.3s ease-in-out;
  z-index: 2;
  height: 38px;
  bottom: 0;
  left: 20px;
  right: 20px;
  color: #fff;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-icon {
  padding: 7px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-icon {
  position: absolute;
  left: 0;
  top: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-send-icon {
  position: absolute;
  right: 0;
  top: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box {
  position: absolute;
  background: rgba(28, 28, 28, 0.9);
  bottom: 41px;
  left: 0;
  box-shadow: 0 0 25px rgba(0, 0, 0, 0.3);
  border-radius: 4px;
  padding: 10px 10px 16px;
  font-size: 14px;
  width: 204px;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box.dplayer-comment-setting-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box input[type=radio] {
  display: none;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box label {
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-title {
  font-size: 13px;
  color: #fff;
  line-height: 30px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type {
  font-size: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type .dplayer-comment-setting-title {
  margin-bottom: 6px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type label:nth-child(2) span {
  border-radius: 4px 0 0 4px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type label:nth-child(4) span {
  border-radius: 0 4px 4px 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type span {
  width: 33%;
  padding: 4px 6px;
  line-height: 16px;
  display: inline-block;
  font-size: 12px;
  color: #fff;
  border: 1px solid #fff;
  margin-right: -1px;
  box-sizing: border-box;
  text-align: center;
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type input:checked + span {
  background: #E4E4E6;
  color: #1c1c1c;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color {
  font-size: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color label {
  font-size: 0;
  padding: 6px;
  display: inline-block;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color span {
  width: 22px;
  height: 22px;
  display: inline-block;
  border-radius: 50%;
  box-sizing: border-box;
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color span:hover {
  animation: my-face 5s infinite ease-in-out;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input {
  outline: none;
  border: none;
  padding: 8px 31px;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  border-radius: 4px;
  background: none;
  margin: 0;
  height: 100%;
  box-sizing: border-box;
  width: 100%;
  color: #fff;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::placeholder {
  color: #fff;
  opacity: 0.8;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::-ms-clear {
  display: none;
}
.dplayer-controller .dplayer-icons.dplayer-icons-left .dplayer-icon {
  padding: 7px;
}
.dplayer-controller .dplayer-icons.dplayer-icons-right {
  right: 20px;
}
.dplayer-controller .dplayer-icons.dplayer-icons-right .dplayer-icon {
  padding: 8px;
}
.dplayer-controller .dplayer-icons .dplayer-time,
.dplayer-controller .dplayer-icons .dplayer-live-badge {
  line-height: 38px;
  color: #eee;
  text-shadow: 0 0 2px rgba(0, 0, 0, 0.5);
  vertical-align: middle;
  font-size: 13px;
  cursor: default;
}
.dplayer-controller .dplayer-icons .dplayer-live-dot {
  display: inline-block;
  width: 6px;
  height: 6px;
  vertical-align: 4%;
  margin-right: 5px;
  content: '';
  border-radius: 6px;
}
.dplayer-controller .dplayer-icons .dplayer-icon {
  width: 40px;
  height: 100%;
  border: none;
  background-color: transparent;
  outline: none;
  cursor: pointer;
  vertical-align: middle;
  box-sizing: border-box;
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-icon .dplayer-icon-content {
  transition: all 0.2s ease-in-out;
  opacity: 0.8;
}
.dplayer-controller .dplayer-icons .dplayer-icon:hover .dplayer-icon-content {
  opacity: 1;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-quality-icon {
  color: #fff;
  width: auto;
  line-height: 22px;
  font-size: 14px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-comment-icon {
  padding: 10px 9px 9px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-setting-icon {
  padding-top: 8.5px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-volume-icon {
  width: 43px;
}
.dplayer-controller .dplayer-icons .dplayer-volume {
  position: relative;
  display: inline-block;
  cursor: pointer;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-volume:hover .dplayer-volume-bar-wrap .dplayer-volume-bar {
  width: 45px;
}
.dplayer-controller .dplayer-icons .dplayer-volume:hover .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-volume.dplayer-volume-active .dplayer-volume-bar-wrap .dplayer-volume-bar {
  width: 45px;
}
.dplayer-controller .dplayer-icons .dplayer-volume.dplayer-volume-active .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap {
  display: inline-block;
  margin: 0 10px 0 -5px;
  vertical-align: middle;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar {
  position: relative;
  top: 17px;
  width: 0;
  height: 3px;
  background: #aaa;
  transition: all 0.3s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 100%;
  transition: all 0.1s ease;
  will-change: width;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons .dplayer-subtitle-btn {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box {
  position: absolute;
  right: 0;
  bottom: 50px;
  transform: scale(0);
  width: fit-content;
  max-width: 240px;
  min-width: 120px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 7px 0;
  transition: all 0.3s ease-in-out;
  overflow: auto;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box.dplayer-subtitles-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box.dplayer-subtitles-box-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-item {
  height: 30px;
  padding: 5px 10px;
  box-sizing: border-box;
  cursor: pointer;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-setting {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box {
  position: absolute;
  right: 0;
  bottom: 50px;
  transform: scale(0);
  width: 150px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 7px 0;
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box > div {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box > div.dplayer-setting-origin-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-narrow {
  width: 70px;
  text-align: center;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-speed .dplayer-setting-origin-panel {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-speed .dplayer-setting-speed-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-item,
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-speed-item {
  height: 30px;
  padding: 5px 10px;
  box-sizing: border-box;
  cursor: pointer;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-item:hover,
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-speed-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku {
  padding: 5px 0;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-label {
  padding: 0 10px;
  display: inline;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku:hover .dplayer-label {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku:hover .dplayer-danmaku-bar-wrap {
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-label {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-danmaku-bar-wrap {
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap {
  padding: 0 10px;
  box-sizing: border-box;
  display: none;
  vertical-align: middle;
  height: 100%;
  width: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar {
  position: relative;
  top: 8.5px;
  width: 100%;
  height: 3px;
  background: #fff;
  transition: all 0.3s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar .dplayer-danmaku-bar-inner {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 100%;
  transition: all 0.1s ease;
  background: #aaa;
  will-change: width;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar .dplayer-danmaku-bar-inner .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  background: #aaa;
}
.dplayer-controller .dplayer-icons .dplayer-full {
  display: inline-block;
  height: 100%;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-full:hover .dplayer-full-in-icon {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-full .dplayer-full-in-icon {
  position: absolute;
  top: -30px;
  z-index: 1;
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-quality {
  position: relative;
  display: inline-block;
  height: 100%;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-quality:hover .dplayer-quality-list {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-quality:hover .dplayer-quality-mask {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-mask {
  display: none;
  position: absolute;
  bottom: 38px;
  left: -18px;
  width: 80px;
  padding-bottom: 12px;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-list {
  display: none;
  font-size: 12px;
  width: 80px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 5px 0;
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  color: #fff;
  text-align: center;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-item {
  height: 25px;
  box-sizing: border-box;
  cursor: pointer;
  line-height: 25px;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-comment {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-label {
  color: #eee;
  font-size: 13px;
  display: inline-block;
  vertical-align: middle;
  white-space: nowrap;
}
.dplayer-controller .dplayer-icons .dplayer-toggle {
  width: 32px;
  height: 20px;
  text-align: center;
  font-size: 0;
  vertical-align: middle;
  position: absolute;
  top: 5px;
  right: 10px;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input {
  max-height: 0;
  max-width: 0;
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label {
  display: inline-block;
  position: relative;
  box-shadow: #dfdfdf 0 0 0 0 inset;
  border: 1px solid #dfdfdf;
  height: 20px;
  width: 32px;
  border-radius: 10px;
  box-sizing: border-box;
  cursor: pointer;
  transition: 0.2s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label:before {
  content: "";
  position: absolute;
  display: block;
  height: 18px;
  width: 18px;
  top: 0;
  left: 0;
  border-radius: 15px;
  transition: 0.2s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label:after {
  content: "";
  position: absolute;
  display: block;
  left: 0;
  top: 0;
  border-radius: 15px;
  background: #fff;
  transition: 0.2s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
  height: 18px;
  width: 18px;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label {
  border-color: rgba(255, 255, 255, 0.5);
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label:before {
  width: 30px;
  background: rgba(255, 255, 255, 0.5);
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label:after {
  left: 12px;
}
.dplayer-mobile-play {
  display: none;
  width: 50px;
  height: 50px;
  border: none;
  background-color: transparent;
  outline: none;
  cursor: pointer;
  box-sizing: border-box;
  bottom: 0;
  opacity: 0.8;
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
}
.dplayer-danmaku {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  font-size: 22px;
  color: #fff;
}
.dplayer-danmaku .dplayer-danmaku-item {
  display: inline-block;
  pointer-events: none;
  user-select: none;
  cursor: default;
  white-space: nowrap;
  text-shadow: 0.5px 0.5px 0.5px rgba(0, 0, 0, 0.5);
}
.dplayer-danmaku .dplayer-danmaku-item--demo {
  position: absolute;
  visibility: hidden;
}
.dplayer-danmaku .dplayer-danmaku-right {
  position: absolute;
  right: 0;
  transform: translateX(100%);
}
.dplayer-danmaku .dplayer-danmaku-right.dplayer-danmaku-move {
  will-change: transform;
  animation-name: 'danmaku';
  animation-timing-function: linear;
  animation-play-state: paused;
}
@keyframes danmaku {
  from {
    transform: translateX(100%);
  }
}
.dplayer-danmaku .dplayer-danmaku-top,
.dplayer-danmaku .dplayer-danmaku-bottom {
  position: absolute;
  width: 100%;
  text-align: center;
  visibility: hidden;
}
.dplayer-danmaku .dplayer-danmaku-top.dplayer-danmaku-move,
.dplayer-danmaku .dplayer-danmaku-bottom.dplayer-danmaku-move {
  will-change: visibility;
  animation-name: 'danmaku-center';
  animation-timing-function: linear;
  animation-play-state: paused;
}
@keyframes danmaku-center {
  from {
    visibility: visible;
  }
  to {
    visibility: visible;
  }
}
.dplayer-logo {
  pointer-events: none;
  position: absolute;
  left: 20px;
  top: 20px;
  max-width: 50px;
  max-height: 50px;
}
.dplayer-logo img {
  max-width: 100%;
  max-height: 100%;
  background: none;
}
.dplayer-menu {
  position: absolute;
  width: 170px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.85);
  padding: 5px 0;
  overflow: hidden;
  z-index: 3;
  display: none;
}
.dplayer-menu.dplayer-menu-show {
  display: block;
}
.dplayer-menu .dplayer-menu-item {
  height: 30px;
  box-sizing: border-box;
  cursor: pointer;
}
.dplayer-menu .dplayer-menu-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-menu .dplayer-menu-item a {
  padding: 0 10px;
  line-height: 30px;
  color: #eee;
  font-size: 13px;
  display: inline-block;
  vertical-align: middle;
  width: 100%;
  box-sizing: border-box;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
.dplayer-menu .dplayer-menu-item a:hover {
  text-decoration: none;
}
.dplayer-notice-list {
  position: absolute;
  bottom: 60px;
  left: 20px;
}
.dplayer-notice-list .dplayer-notice {
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  color: #fff;
  display: table;
  pointer-events: none;
  animation: showNotice 0.3s ease 1 forwards;
}
.dplayer-notice-list .remove-notice {
  animation: removeNotice 0.3s ease 1 forwards;
}
@keyframes showNotice {
  from {
    padding: 0;
    font-size: 0;
    margin-top: 0;
  }
  to {
    padding: 7px 20px;
    font-size: 14px;
    margin-top: 5px;
  }
}
@keyframes removeNotice {
  0% {
    padding: 7px 20px;
    font-size: 14px;
    margin-top: 5px;
  }
  20% {
    font-size: 12px;
  }
  21% {
    font-size: 0;
    padding: 7px 10px;
  }
  100% {
    padding: 0;
    margin-top: 0;
    font-size: 0;
  }
}
.dplayer-subtitle {
  position: absolute;
  bottom: 40px;
  width: 90%;
  left: 5%;
  text-align: center;
  color: #fff;
  text-shadow: 0.5px 0.5px 0.5px rgba(0, 0, 0, 0.5);
  font-size: 20px;
}
.dplayer-subtitle.dplayer-subtitle-hide {
  display: none;
}
.dplayer-mask {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 1;
  display: none;
}
.dplayer-mask.dplayer-mask-show {
  display: block;
}
.dplayer-video-wrap {
  position: relative;
  background: #000;
  font-size: 0;
  width: 100%;
  height: 100%;
}
.dplayer-video-wrap .dplayer-video {
  width: 100%;
  height: 100%;
  display: none;
}
.dplayer-video-wrap .dplayer-video-current {
  display: block;
}
.dplayer-video-wrap .dplayer-video-prepare {
  display: none;
}
.dplayer-info-panel {
  position: absolute;
  top: 10px;
  left: 10px;
  width: 400px;
  background: rgba(28, 28, 28, 0.8);
  padding: 10px;
  color: #fff;
  font-size: 12px;
  border-radius: 2px;
}
.dplayer-info-panel-hide {
  display: none;
}
.dplayer-info-panel .dplayer-info-panel-close {
  cursor: pointer;
  position: absolute;
  right: 10px;
  top: 10px;
}
.dplayer-info-panel .dplayer-info-panel-item > span {
  display: inline-block;
  vertical-align: middle;
  line-height: 15px;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
.dplayer-info-panel .dplayer-info-panel-item-title {
  width: 100px;
  text-align: right;
  margin-right: 10px;
}
.dplayer-info-panel .dplayer-info-panel-item-data {
  width: 260px;
}
`,`.dplayer {
    position: relative;
    overflow: hidden;
    user-select: none;
    line-height: 1;

    * {
        box-sizing: content-box;
    }

    svg {
        width: 100%;
        height: 100%;

        path,
        circle {
            fill: #fff;
        }
    }

    &:-webkit-full-screen {
        width: 100%;
        height: 100%;
        background: #000;
        position: fixed;
        z-index: 100000;
        left: 0;
        top: 0;
        margin: 0;
        padding: 0;
        transform: translate(0, 0);
        
    }

    &.dplayer-no-danmaku {
        .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box {
            .dplayer-setting-showdan,
            .dplayer-setting-danmaku,
            .dplayer-setting-danunlimit {
                display: none;
            }
        }

        .dplayer-controller .dplayer-icons .dplayer-comment {
            display: none;
        }

        .dplayer-danmaku {
            display: none;
        }
    }

    &.dplayer-live {
        .dplayer-time {
            display: none;
        }
        .dplayer-bar-wrap {
            display: none;
        }
        .dplayer-setting-speed {
            display: none;
        }
        .dplayer-setting-loop {
            display: none;
        }

        &.dplayer-no-danmaku {
            .dplayer-setting {
                display: none;
            }
        }
    }

    &.dplayer-arrow {
        .dplayer-danmaku {
            font-size: 18px;
        }
        .dplayer-icon {
            margin: 0 -3px;
        }
    }

    &.dplayer-playing {
        .dplayer-danmaku .dplayer-danmaku-move {
            animation-play-state: running;
        }

        @media (min-width: 900px) {
            .dplayer-controller-mask {
                opacity: 0;
            }
            .dplayer-controller {
                opacity: 0;
            }

            &:hover {
                .dplayer-controller-mask {
                    opacity: 1;
                }
                .dplayer-controller {
                    opacity: 1;
                }
            }
        }
    }

    &.dplayer-loading {
        .dplayer-bezel .diplayer-loading-icon {
            display: block;
        }
    }

    &.dplayer-loading,
    &.dplayer-paused {
        .dplayer-danmaku,
        .dplayer-danmaku-move {
            animation-play-state: paused;
        }
    }

    &.dplayer-hide-controller {
        cursor: none;

        .dplayer-controller-mask {
            opacity: 0;
            transform: translateY(100%);
        }
        .dplayer-controller {
            opacity: 0;
            transform: translateY(100%);
        }
    }
    &.dplayer-show-controller {
        .dplayer-controller-mask {
            opacity: 1;
        }
        .dplayer-controller {
            opacity: 1;
        }
    }
    &.dplayer-fulled {
        position: fixed;
        z-index: 100000;
        left: 0;
        top: 0;
        width: 100% !important;
        height: 100% !important;
    }
    &.dplayer-mobile {
        .dplayer-controller .dplayer-icons {
            .dplayer-volume,
            .dplayer-camera-icon,
            .dplayer-airplay-icon,
            .dplayer-chromecast-icon,
            .dplayer-play-icon {
                display: none;
            }
            .dplayer-full .dplayer-full-in-icon {
                position: static;
                display: inline-block;
            }
        }

        .dplayer-bar-time {
            display: none;
        }

        &.dplayer-hide-controller {
            .dplayer-mobile-play {
                display: none;
            }
        }

        .dplayer-mobile-play {
            display: block;
        }
    }
}

// To hide scroll bar, apply this class to <body>
.dplayer-web-fullscreen-fix {
    position: fixed;
    top: 0;
    left: 0;
    margin: 0;
    padding: 0;
}
`,`@import '../../node_modules/balloon-css/balloon.css';

[data-balloon]:before {
    display: none;
}

[data-balloon]:after {
    padding: 0.3em 0.7em;
    background: rgba(17, 17, 17, 0.7);
}

[data-balloon][data-balloon-pos="up"]:after {
    margin-bottom: 0;
}`,`.dplayer-bezel {
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    font-size: 22px;
    color: #fff;
    pointer-events: none;
    .dplayer-bezel-icon {
        position: absolute;
        top: 50%;
        left: 50%;
        margin: -26px 0 0 -26px;
        height: 52px;
        width: 52px;
        padding: 12px;
        box-sizing: border-box;
        background: rgba(0, 0, 0, .5);
        border-radius: 50%;
        opacity: 0;
        pointer-events: none;
        &.dplayer-bezel-transition {
            animation: bezel-hide .5s linear;
        }
        @keyframes bezel-hide {
            from {
                opacity: 1;
                transform: scale(1);
            }
            to {
                opacity: 0;
                transform: scale(2);
            }
        }
    }
    .dplayer-danloading {
        position: absolute;
        top: 50%;
        margin-top: -7px;
        width: 100%;
        text-align: center;
        font-size: 14px;
        line-height: 14px;
        animation: my-face 5s infinite ease-in-out;
    }
    .diplayer-loading-icon {
        display: none;
        position: absolute;
        top: 50%;
        left: 50%;
        margin: -18px 0 0 -18px;
        height: 36px;
        width: 36px;
        pointer-events: none;
        .diplayer-loading-hide {
            display: none;
        }
        .diplayer-loading-dot {
            animation: diplayer-loading-dot-fade .8s ease infinite;
            opacity: 0;
            transform-origin: 4px 4px;
            each(range(7), {
                &.diplayer-loading-dot-@{value} {
                    animation-delay: (@value * 0.1s);
                }
            });
        }
        @keyframes diplayer-loading-dot-fade {
            0% {
                opacity: .7;
                transform: scale(1.2, 1.2)
            }
            50% {
                opacity: .25;
                transform: scale(.9, .9)
            }
            to {
                opacity: .25;
                transform: scale(.85, .85)
            }
        }
    }
}`,`.dplayer-notice-list{
    position: absolute;
    bottom: 60px;
    left: 20px;

    .dplayer-notice {
        border-radius: 2px;
        background: rgba(28, 28, 28, 0.9);
        transition: all .3s ease-in-out;
        overflow: hidden;
        color: #fff;
        display: table;
        pointer-events: none;
        animation: showNotice .3s ease 1 forwards;
    }

    .remove-notice{
        animation: removeNotice .3s ease 1 forwards;
    }
}

@keyframes showNotice {
    from {
        padding: 0;
        font-size: 0;
        margin-top: 0;
    }
    to {
        padding: 7px 20px;
        font-size: 14px;
        margin-top: 5px;
    }
}

@keyframes removeNotice {
    0%{
        padding: 7px 20px;
        font-size: 14px;
        margin-top: 5px;
    }
    20%{
        font-size: 12px;
    }
    21%{
        font-size: 0;
        padding: 7px 10px;
    }
    100%{
        padding: 0;
        margin-top: 0;
        font-size: 0;
    }
}
`,`.dplayer-controller-mask {
    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAADGCAYAAAAT+OqFAAAAdklEQVQoz42QQQ7AIAgEF/T/D+kbq/RWAlnQyyazA4aoAB4FsBSA/bFjuF1EOL7VbrIrBuusmrt4ZZORfb6ehbWdnRHEIiITaEUKa5EJqUakRSaEYBJSCY2dEstQY7AuxahwXFrvZmWl2rh4JZ07z9dLtesfNj5q0FU3A5ObbwAAAABJRU5ErkJggg==) repeat-x bottom;
    height: 98px;
    width: 100%;
    position: absolute;
    bottom: 0;
    transition: all 0.3s ease;
}

.dplayer-controller {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 41px;
    padding: 0 20px;
    user-select: none;
    transition: all 0.3s ease;
    &.dplayer-controller-comment {
        .dplayer-icons {
            display: none;
        }
        .dplayer-icons.dplayer-comment-box {
            display: block;
        }
    }
    .dplayer-bar-wrap {
        padding: 5px 0;
        cursor: pointer;
        position: absolute;
        bottom: 33px;
        width: calc(100% - 40px);
        height: 3px;
        &:hover {
            .dplayer-bar .dplayer-played .dplayer-thumb {
                transform: scale(1);
            }
            .dplayer-highlight {
                display: block;
                width: 8px;
                transform: translateX(-4px);
                top: 4px;
                height: 40%;
            }
        }
        .dplayer-highlight {
            z-index: 12;
            position: absolute;
            top: 5px;
            width: 6px;
            height: 20%;
            border-radius: 6px;
            background-color: #fff;
            text-align: center;
            transform: translateX(-3px);
            transition: all .2s ease-in-out;
            &:hover {
                .dplayer-highlight-text {
                    display: block;
                }
                &~.dplayer-bar-preview {
                    opacity: 0;
                }
                &~.dplayer-bar-time {
                    opacity: 0;
                }
            }
            .dplayer-highlight-text {
                display: none;
                position: absolute;
                left: 50%;
                top: -24px;
                padding: 5px 8px;
                background-color: rgba(0, 0, 0, .62);
                color: #fff;
                border-radius: 4px;
                font-size: 12px;
                white-space: nowrap;
                transform: translateX(-50%);
            }
        }
        .dplayer-bar-preview {
            position: absolute;
            background: #fff;
            pointer-events: none;
            display: none;
            background-size: 16000px 100%;
        }
        .dplayer-bar-preview-canvas {
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }
        .dplayer-bar-time {
            &.hidden {
                opacity: 0;
            }
            position: absolute;
            left: 0px;
            top: -20px;
            border-radius: 4px;
            padding: 5px 7px;
            background-color: rgba(0, 0, 0, 0.62);
            color: #fff;
            font-size: 12px;
            text-align: center;
            opacity: 1;
            transition: opacity .1s ease-in-out;
            word-wrap: normal;
            word-break: normal;
            z-index: 2;
            pointer-events: none;
        }
        .dplayer-bar {
            position: relative;
            height: 3px;
            width: 100%;
            background: rgba(255, 255, 255, .2);
            cursor: pointer;
            .dplayer-loaded {
                position: absolute;
                left: 0;
                top: 0;
                bottom: 0;
                background: rgba(255, 255, 255, .4);
                height: 3px;
                transition: all 0.5s ease;
                will-change: width;
            }
            .dplayer-played {
                position: absolute;
                left: 0;
                top: 0;
                bottom: 0;
                height: 3px;
                will-change: width;
                .dplayer-thumb {
                    position: absolute;
                    top: 0;
                    right: 5px;
                    margin-top: -4px;
                    margin-right: -10px;
                    height: 11px;
                    width: 11px;
                    border-radius: 50%;
                    cursor: pointer;
                    transition: all .3s ease-in-out;
                    transform: scale(0);
                }
            }
        }
    }
    .dplayer-icons {
        height: 38px;
        position: absolute;
        bottom: 0;
        &.dplayer-comment-box {
            display: none;
            position: absolute;
            transition: all .3s ease-in-out;
            z-index: 2;
            height: 38px;
            bottom: 0;
            left: 20px;
            right: 20px;
            color: #fff;
            .dplayer-icon {
                padding: 7px;
            }
            .dplayer-comment-setting-icon {
                position: absolute;
                left: 0;
                top: 0;
            }
            .dplayer-send-icon {
                position: absolute;
                right: 0;
                top: 0;
            }
            .dplayer-comment-setting-box {
                position: absolute;
                background: rgba(28, 28, 28, 0.9);
                bottom: 41px;
                left: 0;
                box-shadow: 0 0 25px rgba(0, 0, 0, .3);
                border-radius: 4px;
                padding: 10px 10px 16px;
                font-size: 14px;
                width: 204px;
                transition: all .3s ease-in-out;
                transform: scale(0);
                &.dplayer-comment-setting-open {
                    transform: scale(1);
                }
                input[type=radio] {
                    display: none;
                }
                label {
                    cursor: pointer;
                }
                .dplayer-comment-setting-title {
                    font-size: 13px;
                    color: #fff;
                    line-height: 30px;
                }
                .dplayer-comment-setting-type {
                    font-size: 0;
                    .dplayer-comment-setting-title {
                        margin-bottom: 6px;
                    }
                    label {
                        &:nth-child(2) {
                            span {
                                border-radius: 4px 0 0 4px;
                            }
                        }
                        &:nth-child(4) {
                            span {
                                border-radius: 0 4px 4px 0;
                            }
                        }
                    }
                    span {
                        width: 33%;
                        padding: 4px 6px;
                        line-height: 16px;
                        display: inline-block;
                        font-size: 12px;
                        color: #fff;
                        border: 1px solid #fff;
                        margin-right: -1px;
                        box-sizing: border-box;
                        text-align: center;
                        cursor: pointer;
                    }
                    input:checked+span {
                        background: #E4E4E6;
                        color: #1c1c1c;
                    }
                }
                .dplayer-comment-setting-color {
                    font-size: 0;
                    label {
                        font-size: 0;
                        padding: 6px;
                        display: inline-block;
                    }
                    span {
                        width: 22px;
                        height: 22px;
                        display: inline-block;
                        border-radius: 50%;
                        box-sizing: border-box;
                        cursor: pointer;
                        &:hover {
                            animation: my-face 5s infinite ease-in-out;
                        }
                    }
                }
            }
            .dplayer-comment-input {
                outline: none;
                border: none;
                padding: 8px 31px;
                font-size: 14px;
                line-height: 18px;
                text-align: center;
                border-radius: 4px;
                background: none;
                margin: 0;
                height: 100%;
                box-sizing: border-box;
                width: 100%;
                color: #fff;
                &::placeholder {
                    color: #fff;
                    opacity: 0.8;
                }
                &::-ms-clear {
                    display: none;
                }
            }
        }
        &.dplayer-icons-left {
            .dplayer-icon {
                padding: 7px;
            }
        }
        &.dplayer-icons-right {
            right: 20px;
            .dplayer-icon {
                padding: 8px;
            }
        }
        .dplayer-time,
        .dplayer-live-badge {
            line-height: 38px;
            color: #eee;
            text-shadow: 0 0 2px rgba(0, 0, 0, .5);
            vertical-align: middle;
            font-size: 13px;
            cursor: default;
        }
        .dplayer-live-dot {
            display: inline-block;
            width: 6px;
            height: 6px;
            vertical-align: 4%;
            margin-right: 5px;
            content: '';
            border-radius: 6px;
        }
        .dplayer-icon {
            width: 40px;
            height: 100%;
            border: none;
            background-color: transparent;
            outline: none;
            cursor: pointer;
            vertical-align: middle;
            box-sizing: border-box;
            display: inline-block;
            .dplayer-icon-content {
                transition: all .2s ease-in-out;
                opacity: .8;
            }
            &:hover {
                .dplayer-icon-content {
                    opacity: 1;
                }
            }
            &.dplayer-quality-icon {
                color: #fff;
                width: auto;
                line-height: 22px;
                font-size: 14px;
            }
            &.dplayer-comment-icon {
                padding: 10px 9px 9px;
            }
            &.dplayer-setting-icon {
                padding-top: 8.5px;
            }
            &.dplayer-volume-icon {
                width: 43px;
            }
        }
        .dplayer-volume {
            position: relative;
            display: inline-block;
            cursor: pointer;
            height: 100%;
            &:hover {
                .dplayer-volume-bar-wrap .dplayer-volume-bar {
                    width: 45px;
                }
                .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
                    transform: scale(1);
                }
            }
            &.dplayer-volume-active {
                .dplayer-volume-bar-wrap .dplayer-volume-bar {
                    width: 45px;
                }
                .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
                    transform: scale(1);
                }
            }
            .dplayer-volume-bar-wrap {
                display: inline-block;
                margin: 0 10px 0 -5px;
                vertical-align: middle;
                height: 100%;
                .dplayer-volume-bar {
                    position: relative;
                    top: 17px;
                    width: 0;
                    height: 3px;
                    background: #aaa;
                    transition: all 0.3s ease-in-out;
                    .dplayer-volume-bar-inner {
                        position: absolute;
                        bottom: 0;
                        left: 0;
                        height: 100%;
                        transition: all 0.1s ease;
                        will-change: width;
                        .dplayer-thumb {
                            position: absolute;
                            top: 0;
                            right: 5px;
                            margin-top: -4px;
                            margin-right: -10px;
                            height: 11px;
                            width: 11px;
                            border-radius: 50%;
                            cursor: pointer;
                            transition: all .3s ease-in-out;
                            transform: scale(0);
                        }
                    }
                }
            }
        }
        .dplayer-subtitle-btn {
            display: inline-block;
            height: 100%;
        }
        .dplayer-subtitles {
            display: inline-block;
            height: 100%;
            .dplayer-subtitles-box {
                position: absolute;
                right: 0;
                bottom: 50px;
                transform: scale(0);
                width: fit-content;
                max-width: 240px;
                min-width: 120px;
                border-radius: 2px;
                background: rgba(28, 28, 28, 0.9);
                padding: 7px 0;
                transition: all .3s ease-in-out;
                overflow: auto;
                z-index: 2;
                &.dplayer-subtitles-panel {
                    display: block;
                }
                &.dplayer-subtitles-box-open {
                    transform: scale(1);
                }
            }
            .dplayer-subtitles-item {
                height: 30px;
                padding: 5px 10px;
                box-sizing: border-box;
                cursor: pointer;
                position: relative;
                &:hover {
                    background-color: rgba(255, 255, 255, .1);
                }
            }
        }
        .dplayer-setting {
            display: inline-block;
            height: 100%;
            .dplayer-setting-box {
                position: absolute;
                right: 0;
                bottom: 50px;
                transform: scale(0);
                width: 150px;
                border-radius: 2px;
                background: rgba(28, 28, 28, 0.9);
                padding: 7px 0;
                transition: all .3s ease-in-out;
                overflow: hidden;
                z-index: 2;
                &>div {
                    display: none;
                    &.dplayer-setting-origin-panel {
                        display: block;
                    }
                }
                &.dplayer-setting-box-open {
                    transform: scale(1);
                }
                &.dplayer-setting-box-narrow {
                    width: 70px;
                    text-align: center;
                }
                &.dplayer-setting-box-speed {
                    .dplayer-setting-origin-panel {
                        display: none;
                    }
                    .dplayer-setting-speed-panel {
                        display: block;
                    }
                }
            }
            .dplayer-setting-item,
            .dplayer-setting-speed-item {
                height: 30px;
                padding: 5px 10px;
                box-sizing: border-box;
                cursor: pointer;
                position: relative;
                &:hover {
                    background-color: rgba(255, 255, 255, .1);
                }
            }
            .dplayer-setting-danmaku {
                padding: 5px 0;
                .dplayer-label {
                    padding: 0 10px;
                    display: inline;
                }
                &:hover {
                    .dplayer-label {
                        display: none;
                    }
                    .dplayer-danmaku-bar-wrap {
                        display: inline-block;
                    }
                }
                &.dplayer-setting-danmaku-active {
                    .dplayer-label {
                        display: none;
                    }
                    .dplayer-danmaku-bar-wrap {
                        display: inline-block;
                    }
                }
                .dplayer-danmaku-bar-wrap {
                    padding: 0 10px;
                    box-sizing: border-box;
                    display: none;
                    vertical-align: middle;
                    height: 100%;
                    width: 100%;
                    .dplayer-danmaku-bar {
                        position: relative;
                        top: 8.5px;
                        width: 100%;
                        height: 3px;
                        background: #fff;
                        transition: all 0.3s ease-in-out;
                        .dplayer-danmaku-bar-inner {
                            position: absolute;
                            bottom: 0;
                            left: 0;
                            height: 100%;
                            transition: all 0.1s ease;
                            background: #aaa;
                            will-change: width;
                            .dplayer-thumb {
                                position: absolute;
                                top: 0;
                                right: 5px;
                                margin-top: -4px;
                                margin-right: -10px;
                                height: 11px;
                                width: 11px;
                                border-radius: 50%;
                                cursor: pointer;
                                transition: all .3s ease-in-out;
                                background: #aaa;
                            }
                        }
                    }
                }
            }
        }
        .dplayer-full {
            display: inline-block;
            height: 100%;
            position: relative;
            &:hover {
                .dplayer-full-in-icon {
                    display: block;
                }
            }
            .dplayer-full-in-icon {
                position: absolute;
                top: -30px;
                z-index: 1;
                display: none;
            }
        }
        .dplayer-quality {
            position: relative;
            display: inline-block;
            height: 100%;
            z-index: 2;
            &:hover {
                .dplayer-quality-list {
                    display: block;
                }
                .dplayer-quality-mask {
                    display: block;
                }
            }
            .dplayer-quality-mask {
                display: none;
                position: absolute;
                bottom: 38px;
                left: -18px;
                width: 80px;
                padding-bottom: 12px;
            }
            .dplayer-quality-list {
                display: none;
                font-size: 12px;
                width: 80px;
                border-radius: 2px;
                background: rgba(28, 28, 28, 0.9);
                padding: 5px 0;
                transition: all .3s ease-in-out;
                overflow: hidden;
                color: #fff;
                text-align: center;
            }
            .dplayer-quality-item {
                height: 25px;
                box-sizing: border-box;
                cursor: pointer;
                line-height: 25px;
                &:hover {
                    background-color: rgba(255, 255, 255, .1);
                }
            }
        }
        .dplayer-comment {
            display: inline-block;
            height: 100%;
        }
        .dplayer-label {
            color: #eee;
            font-size: 13px;
            display: inline-block;
            vertical-align: middle;
            white-space: nowrap;
        }
        .dplayer-toggle {
            width: 32px;
            height: 20px;
            text-align: center;
            font-size: 0;
            vertical-align: middle;
            position: absolute;
            top: 5px;
            right: 10px;
            input {
                max-height: 0;
                max-width: 0;
                display: none;
            }
            input+label {
                display: inline-block;
                position: relative;
                box-shadow: rgb(223, 223, 223) 0 0 0 0 inset;
                border: 1px solid rgb(223, 223, 223);
                height: 20px;
                width: 32px;
                border-radius: 10px;
                box-sizing: border-box;
                cursor: pointer;
                transition: .2s ease-in-out;
            }
            input+label:before {
                content: "";
                position: absolute;
                display: block;
                height: 18px;
                width: 18px;
                top: 0;
                left: 0;
                border-radius: 15px;
                transition: .2s ease-in-out;
            }
            input+label:after {
                content: "";
                position: absolute;
                display: block;
                left: 0;
                top: 0;
                border-radius: 15px;
                background: #fff;
                transition: .2s ease-in-out;
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
                height: 18px;
                width: 18px;
            }
            input:checked+label {
                border-color: rgba(255, 255, 255, 0.5);
            }
            input:checked+label:before {
                width: 30px;
                background: rgba(255, 255, 255, 0.5);
            }
            input:checked+label:after {
                left: 12px;
            }
        }
    }
}

.dplayer-mobile-play {
    display: none;
    width: 50px;
    height: 50px;
    border: none;
    background-color: transparent;
    outline: none;
    cursor: pointer;
    box-sizing: border-box;
    position: absolute;
    bottom: 0;
    opacity: 0.8;
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
}`,`.dplayer-danmaku {
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    font-size: 22px;
    color: #fff;
    .dplayer-danmaku-item {
        display: inline-block;
        pointer-events: none;
        user-select: none;
        cursor: default;
        white-space: nowrap;
        text-shadow: .5px .5px .5px rgba(0, 0, 0, .5);
        &--demo {
            position: absolute;
            visibility: hidden;
        }
    }
    .dplayer-danmaku-right {
        position: absolute;
        right: 0;
        transform: translateX(100%);
        &.dplayer-danmaku-move {
            will-change: transform;
            animation-name: 'danmaku';
            animation-timing-function: linear;
            animation-play-state: paused;
        }
    }
    @keyframes danmaku {
        from {
            transform: translateX(100%);
        }
    }
    .dplayer-danmaku-top,
    .dplayer-danmaku-bottom {
        position: absolute;
        width: 100%;
        text-align: center;
        visibility: hidden;
        &.dplayer-danmaku-move {
            will-change: visibility;
            animation-name: 'danmaku-center';
            animation-timing-function: linear;
            animation-play-state: paused;
        }
    }
    @keyframes danmaku-center {
        from {
            visibility: visible;
        }
        to {
            visibility: visible;
        }
    }
}`,`.dplayer-logo {
    pointer-events: none;
    position: absolute;
    left: 20px;
    top: 20px;
    max-width: 50px;
    max-height: 50px;
    img {
        max-width: 100%;
        max-height: 100%;
        background: none;
    }
}`,`.dplayer-menu {
    position: absolute;
    width: 170px;
    border-radius: 2px;
    background: rgba(28, 28, 28, 0.85);
    padding: 5px 0;
    overflow: hidden;
    z-index: 3;
    display: none;
    &.dplayer-menu-show {
        display: block;
    }
    .dplayer-menu-item {
        height: 30px;
        box-sizing: border-box;
        cursor: pointer;
        &:hover {
            background-color: rgba(255, 255, 255, .1);
        }
        a {
            display: inline-block;
            padding: 0 10px;
            line-height: 30px;
            color: #eee;
            font-size: 13px;
            display: inline-block;
            vertical-align: middle;
            width: 100%;
            box-sizing: border-box;
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
            &:hover {
                text-decoration: none;
            }
        }
    }
}`,`.dplayer-subtitle {
    position: absolute;
    bottom: 40px;
    width: 90%;
    left: 5%;
    text-align: center;
    color: #fff;
    text-shadow: 0.5px 0.5px 0.5px rgba(0, 0, 0, 0.5);
    font-size: 20px;
    &.dplayer-subtitle-hide {
        display: none;
    }
}`,`.dplayer-mask {
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 1;
    display: none;
    &.dplayer-mask-show {
        display: block;
    }
}

.dplayer-video-wrap {
    position: relative;
    background: #000;
    font-size: 0;
    width: 100%;
    height: 100%;
    .dplayer-video {
        width: 100%;
        height: 100%;
        display: none;
    }
    .dplayer-video-current {
        display: block;
    }
    .dplayer-video-prepare {
        display: none;
    }
}`,`.dplayer-info-panel {
    position: absolute;
    top: 10px;
    left: 10px;
    width: 400px;
    background: rgba(28, 28, 28, 0.8);
    padding: 10px;
    color: #fff;
    font-size: 12px;
    border-radius: 2px;

    &-hide {
        display: none;
    }

    .dplayer-info-panel-close {
        cursor: pointer;
        position: absolute;
        right: 10px;
        top: 10px;
    }

    .dplayer-info-panel-item {
        & > span {
            display: inline-block;
            vertical-align: middle;
            line-height: 15px;
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
        }
    }

    .dplayer-info-panel-item-title {
        width: 100px;
        text-align: right;
        margin-right: 10px;
    }
    
    .dplayer-info-panel-item-data {
        width: 260px;
    }
}`],sourceRoot:""}]);const G=X},856:me=>{"use strict";var Le=[];function ve(J){for(var D=-1,v=0;v<Le.length;v++)if(Le[v].identifier===J){D=v;break}return D}function re(J,D){for(var v={},$=[],I=0;I<J.length;I++){var H=J[I],X=D.base?H[0]+D.base:H[0],O=v[X]||0,G="".concat(X," ").concat(O);v[X]=O+1;var j=ve(G),V={css:H[1],media:H[2],sourceMap:H[3],supports:H[4],layer:H[5]};if(j!==-1)Le[j].references++,Le[j].updater(V);else{var S=ie(V,D);D.byIndex=I,Le.splice(I,0,{identifier:G,updater:S,references:1})}$.push(G)}return $}function ie(J,D){var v=D.domAPI(D);return v.update(J),function($){if($){if($.css===J.css&&$.media===J.media&&$.sourceMap===J.sourceMap&&$.supports===J.supports&&$.layer===J.layer)return;v.update(J=$)}else v.remove()}}me.exports=function(J,D){var v=re(J=J||[],D=D||{});return function($){$=$||[];for(var I=0;I<v.length;I++){var H=ve(v[I]);Le[H].references--}for(var X=re($,D),O=0;O<v.length;O++){var G=ve(v[O]);Le[G].references===0&&(Le[G].updater(),Le.splice(G,1))}v=X}}},370:me=>{"use strict";var Le={};me.exports=function(ve,re){var ie=function(J){if(Le[J]===void 0){var D=document.querySelector(J);if(window.HTMLIFrameElement&&D instanceof window.HTMLIFrameElement)try{D=D.contentDocument.head}catch(v){D=null}Le[J]=D}return Le[J]}(ve);if(!ie)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");ie.appendChild(re)}},278:me=>{"use strict";me.exports=function(Le){var ve=document.createElement("style");return Le.setAttributes(ve,Le.attributes),Le.insert(ve,Le.options),ve}},458:(me,Le,ve)=>{"use strict";me.exports=function(re){var ie=ve.nc;ie&&re.setAttribute("nonce",ie)}},470:me=>{"use strict";me.exports=function(Le){var ve=Le.insertStyleElement(Le);return{update:function(re){(function(ie,J,D){var v="";D.supports&&(v+="@supports (".concat(D.supports,") {")),D.media&&(v+="@media ".concat(D.media," {"));var $=D.layer!==void 0;$&&(v+="@layer".concat(D.layer.length>0?" ".concat(D.layer):""," {")),v+=D.css,$&&(v+="}"),D.media&&(v+="}"),D.supports&&(v+="}");var I=D.sourceMap;I&&typeof btoa!="undefined"&&(v+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(I))))," */")),J.styleTagTransform(v,ie,J.options)})(ve,Le,re)},remove:function(){(function(re){if(re.parentNode===null)return!1;re.parentNode.removeChild(re)})(ve)}}}},488:me=>{"use strict";me.exports=function(Le,ve){if(ve.styleSheet)ve.styleSheet.cssText=Le;else{for(;ve.firstChild;)ve.removeChild(ve.firstChild);ve.appendChild(document.createTextNode(Le))}}},251:me=>{me.exports='<svg viewBox="0 0 288 288" xmlns="http://www.w3.org/2000/svg"><path d="M288 90v96c0 20-16 36-36 36h-10c-16 0-16-24 0-24h10c7 0 12-5 12-12V90c0-7-5-12-12-12H36c-7 0-12 5-12 12v96c0 7 5 12 12 12h10c16 0 16 24 0 24H36c-20 0-36-16-36-36V90c0-20 16-36 36-36h216c20 0 36 16 36 36zm-120 62l48 68c14 20 1 38-20 38H92c-21 0-34-18-20-38l48-68c13-18 35-18 48 0z"></path></svg>'},113:me=>{me.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M16 23c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6zM16 13c-2.206 0-4 1.794-4 4s1.794 4 4 4c2.206 0 4-1.794 4-4s-1.794-4-4-4zM27 28h-22c-1.654 0-3-1.346-3-3v-16c0-1.654 1.346-3 3-3h3c0.552 0 1 0.448 1 1s-0.448 1-1 1h-3c-0.551 0-1 0.449-1 1v16c0 0.552 0.449 1 1 1h22c0.552 0 1-0.448 1-1v-16c0-0.551-0.448-1-1-1h-11c-0.552 0-1-0.448-1-1s0.448-1 1-1h11c1.654 0 3 1.346 3 3v16c0 1.654-1.346 3-3 3zM24 10.5c0 0.828 0.672 1.5 1.5 1.5s1.5-0.672 1.5-1.5c0-0.828-0.672-1.5-1.5-1.5s-1.5 0.672-1.5 1.5zM15 4c0 0.552-0.448 1-1 1h-4c-0.552 0-1-0.448-1-1v0c0-0.552 0.448-1 1-1h4c0.552 0 1 0.448 1 1v0z"></path></svg>'},193:me=>{me.exports='<svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="chromecast" class="svg-inline--fa fa-chromecast fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M447.8,64H64c-23.6,0-42.7,19.1-42.7,42.7v63.9H64v-63.9h383.8v298.6H298.6V448H448c23.6,0,42.7-19.1,42.7-42.7V106.7 C490.7,83.1,471.4,64,447.8,64z M21.3,383.6L21.3,383.6l0,63.9h63.9C85.2,412.2,56.6,383.6,21.3,383.6L21.3,383.6z M21.3,298.6V341 c58.9,0,106.6,48.1,106.6,107h42.7C170.7,365.6,103.7,298.7,21.3,298.6z M213.4,448h42.7c-0.5-129.5-105.3-234.3-234.8-234.6l0,42.4 C127.3,255.6,213.3,342,213.4,448z"></path></svg>'},338:me=>{me.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M27.090 0.131h-22.731c-2.354 0-4.262 1.839-4.262 4.109v16.401c0 2.269 1.908 4.109 4.262 4.109h4.262v-2.706h8.469l-8.853 8.135 1.579 1.451 7.487-6.88h9.787c2.353 0 4.262-1.84 4.262-4.109v-16.401c0-2.27-1.909-4.109-4.262-4.109v0zM28.511 19.304c0 1.512-1.272 2.738-2.841 2.738h-8.425l-0.076-0.070-0.076 0.070h-11.311c-1.569 0-2.841-1.226-2.841-2.738v-13.696c0-1.513 1.272-2.739 2.841-2.739h19.889c1.569 0 2.841-0.142 2.841 1.37v15.064z"></path></svg>'},807:me=>{me.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M27.128 0.38h-22.553c-2.336 0-4.229 1.825-4.229 4.076v16.273c0 2.251 1.893 4.076 4.229 4.076h4.229v-2.685h8.403l-8.784 8.072 1.566 1.44 7.429-6.827h9.71c2.335 0 4.229-1.825 4.229-4.076v-16.273c0-2.252-1.894-4.076-4.229-4.076zM28.538 19.403c0 1.5-1.262 2.717-2.819 2.717h-8.36l-0.076-0.070-0.076 0.070h-11.223c-1.557 0-2.819-1.217-2.819-2.717v-13.589c0-1.501 1.262-2.718 2.819-2.718h19.734c1.557 0 2.819-0.141 2.819 1.359v14.947zM9.206 10.557c-1.222 0-2.215 0.911-2.215 2.036s0.992 2.035 2.215 2.035c1.224 0 2.216-0.911 2.216-2.035s-0.992-2.036-2.216-2.036zM22.496 10.557c-1.224 0-2.215 0.911-2.215 2.036s0.991 2.035 2.215 2.035c1.224 0 2.215-0.911 2.215-2.035s-0.991-2.036-2.215-2.036zM15.852 10.557c-1.224 0-2.215 0.911-2.215 2.036s0.991 2.035 2.215 2.035c1.222 0 2.215-0.911 2.215-2.035s-0.992-2.036-2.215-2.036z"></path></svg>'},300:me=>{me.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 33"><path d="M24.965 24.38h-18.132c-1.366 0-2.478-1.113-2.478-2.478v-11.806c0-1.364 1.111-2.478 2.478-2.478h18.132c1.366 0 2.478 1.113 2.478 2.478v11.806c0 1.364-1.11 2.478-2.478 2.478zM6.833 10.097v11.806h18.134l-0.002-11.806h-18.132zM2.478 28.928h5.952c0.684 0 1.238-0.554 1.238-1.239 0-0.684-0.554-1.238-1.238-1.238h-5.952v-5.802c0-0.684-0.554-1.239-1.238-1.239s-1.239 0.556-1.239 1.239v5.802c0 1.365 1.111 2.478 2.478 2.478zM30.761 19.412c-0.684 0-1.238 0.554-1.238 1.238v5.801h-5.951c-0.686 0-1.239 0.554-1.239 1.238 0 0.686 0.554 1.239 1.239 1.239h5.951c1.366 0 2.478-1.111 2.478-2.478v-5.801c0-0.683-0.554-1.238-1.239-1.238zM0 5.55v5.802c0 0.683 0.554 1.238 1.238 1.238s1.238-0.555 1.238-1.238v-5.802h5.952c0.684 0 1.238-0.554 1.238-1.238s-0.554-1.238-1.238-1.238h-5.951c-1.366-0.001-2.478 1.111-2.478 2.476zM32 11.35v-5.801c0-1.365-1.11-2.478-2.478-2.478h-5.951c-0.686 0-1.239 0.554-1.239 1.238s0.554 1.238 1.239 1.238h5.951v5.801c0 0.683 0.554 1.237 1.238 1.237 0.686 0.002 1.239-0.553 1.239-1.236z"></path></svg>'},574:me=>{me.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 33"><path d="M6.667 28h-5.333c-0.8 0-1.333-0.533-1.333-1.333v-5.333c0-0.8 0.533-1.333 1.333-1.333s1.333 0.533 1.333 1.333v4h4c0.8 0 1.333 0.533 1.333 1.333s-0.533 1.333-1.333 1.333zM30.667 28h-5.333c-0.8 0-1.333-0.533-1.333-1.333s0.533-1.333 1.333-1.333h4v-4c0-0.8 0.533-1.333 1.333-1.333s1.333 0.533 1.333 1.333v5.333c0 0.8-0.533 1.333-1.333 1.333zM30.667 12c-0.8 0-1.333-0.533-1.333-1.333v-4h-4c-0.8 0-1.333-0.533-1.333-1.333s0.533-1.333 1.333-1.333h5.333c0.8 0 1.333 0.533 1.333 1.333v5.333c0 0.8-0.533 1.333-1.333 1.333zM1.333 12c-0.8 0-1.333-0.533-1.333-1.333v-5.333c0-0.8 0.533-1.333 1.333-1.333h5.333c0.8 0 1.333 0.533 1.333 1.333s-0.533 1.333-1.333 1.333h-4v4c0 0.8-0.533 1.333-1.333 1.333z"></path></svg>'},182:me=>{me.exports='<svg version="1.1" viewBox="0 0 22 22"><svg x="7" y="1"><circle class="diplayer-loading-dot diplayer-loading-dot-0" cx="4" cy="4" r="2"></circle></svg><svg x="11" y="3"><circle class="diplayer-loading-dot diplayer-loading-dot-1" cx="4" cy="4" r="2"></circle></svg><svg x="13" y="7"><circle class="diplayer-loading-dot diplayer-loading-dot-2" cx="4" cy="4" r="2"></circle></svg><svg x="11" y="11"><circle class="diplayer-loading-dot diplayer-loading-dot-3" cx="4" cy="4" r="2"></circle></svg><svg x="7" y="13"><circle class="diplayer-loading-dot diplayer-loading-dot-4" cx="4" cy="4" r="2"></circle></svg><svg x="3" y="11"><circle class="diplayer-loading-dot diplayer-loading-dot-5" cx="4" cy="4" r="2"></circle></svg><svg x="1" y="7"><circle class="diplayer-loading-dot diplayer-loading-dot-6" cx="4" cy="4" r="2"></circle></svg><svg x="3" y="3"><circle class="diplayer-loading-dot diplayer-loading-dot-7" cx="4" cy="4" r="2"></circle></svg></svg>'},965:me=>{me.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M19.357 2.88c1.749 0 3.366 0.316 4.851 0.946 1.485 0.632 2.768 1.474 3.845 2.533s1.922 2.279 2.532 3.661c0.611 1.383 0.915 2.829 0.915 4.334 0 1.425-0.304 2.847-0.915 4.271-0.611 1.425-1.587 2.767-2.928 4.028-0.855 0.813-1.811 1.607-2.869 2.38s-2.136 1.465-3.233 2.075c-1.099 0.61-2.198 1.098-3.296 1.465-1.098 0.366-2.115 0.549-3.051 0.549-1.343 0-2.441-0.438-3.296-1.311-0.854-0.876-1.281-2.41-1.281-4.608 0-0.366 0.020-0.773 0.060-1.221s0.062-0.895 0.062-1.343c0-0.773-0.183-1.353-0.55-1.738-0.366-0.387-0.793-0.58-1.281-0.58-0.652 0-1.21 0.295-1.678 0.886s-0.926 1.23-1.373 1.921c-0.447 0.693-0.905 1.334-1.372 1.923s-1.028 0.886-1.679 0.886c-0.529 0-1.048-0.427-1.556-1.282s-0.763-2.259-0.763-4.212c0-2.197 0.529-4.241 1.587-6.133s2.462-3.529 4.21-4.912c1.75-1.383 3.762-2.471 6.041-3.264 2.277-0.796 4.617-1.212 7.018-1.253zM7.334 15.817c0.569 0 1.047-0.204 1.434-0.611s0.579-0.875 0.579-1.404c0-0.569-0.193-1.047-0.579-1.434s-0.864-0.579-1.434-0.579c-0.529 0-0.987 0.193-1.373 0.579s-0.58 0.864-0.58 1.434c0 0.53 0.194 0.998 0.58 1.404 0.388 0.407 0.845 0.611 1.373 0.611zM12.216 11.79c0.691 0 1.292-0.254 1.8-0.763s0.762-1.107 0.762-1.8c0-0.732-0.255-1.343-0.762-1.831-0.509-0.489-1.109-0.732-1.8-0.732-0.732 0-1.342 0.244-1.831 0.732-0.488 0.488-0.732 1.098-0.732 1.831 0 0.693 0.244 1.292 0.732 1.8s1.099 0.763 1.831 0.763zM16.366 25.947c0.692 0 1.282-0.214 1.77-0.64s0.732-0.987 0.732-1.678-0.244-1.261-0.732-1.709c-0.489-0.448-1.078-0.671-1.77-0.671-0.65 0-1.21 0.223-1.678 0.671s-0.702 1.018-0.702 1.709c0 0.692 0.234 1.25 0.702 1.678s1.027 0.64 1.678 0.64zM19.113 9.592c0.651 0 1.129-0.203 1.433-0.611 0.305-0.406 0.459-0.874 0.459-1.404 0-0.488-0.154-0.947-0.459-1.373-0.304-0.427-0.782-0.641-1.433-0.641-0.529 0-1.008 0.193-1.434 0.58s-0.64 0.865-0.64 1.434c0 0.571 0.213 1.049 0.64 1.434 0.427 0.389 0.905 0.581 1.434 0.581zM24.848 12.826c0.57 0 1.067-0.213 1.495-0.64 0.427-0.427 0.64-0.947 0.64-1.556 0-0.57-0.214-1.068-0.64-1.495-0.428-0.427-0.927-0.64-1.495-0.64-0.611 0-1.129 0.213-1.555 0.64-0.428 0.427-0.642 0.926-0.642 1.495 0 0.611 0.213 1.129 0.642 1.556s0.947 0.64 1.555 0.64z"></path></svg>'},74:me=>{me.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 17 32"><path d="M14.080 4.8q2.88 0 2.88 2.048v18.24q0 2.112-2.88 2.112t-2.88-2.112v-18.24q0-2.048 2.88-2.048zM2.88 4.8q2.88 0 2.88 2.048v18.24q0 2.112-2.88 2.112t-2.88-2.112v-18.24q0-2.048 2.88-2.048z"></path></svg>'},730:me=>{me.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 16 32"><path d="M15.552 15.168q0.448 0.32 0.448 0.832 0 0.448-0.448 0.768l-13.696 8.512q-0.768 0.512-1.312 0.192t-0.544-1.28v-16.448q0-0.96 0.544-1.28t1.312 0.192z"></path></svg>'},428:me=>{me.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M22 16l-10.105-10.6-1.895 1.987 8.211 8.613-8.211 8.612 1.895 1.988 8.211-8.613z"></path></svg>'},254:me=>{me.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M13.725 30l3.9-5.325-3.9-1.125v6.45zM0 17.5l11.050 3.35 13.6-11.55-10.55 12.425 11.8 3.65 6.1-23.375-32 15.5z"></path></svg>'},934:me=>{me.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 28"><path d="M28.633 17.104c0.035 0.21 0.026 0.463-0.026 0.76s-0.14 0.598-0.262 0.904c-0.122 0.306-0.271 0.581-0.445 0.825s-0.367 0.419-0.576 0.524c-0.209 0.105-0.393 0.157-0.55 0.157s-0.332-0.035-0.524-0.105c-0.175-0.052-0.393-0.1-0.655-0.144s-0.528-0.052-0.799-0.026c-0.271 0.026-0.541 0.083-0.812 0.17s-0.502 0.236-0.694 0.445c-0.419 0.437-0.664 0.934-0.734 1.493s0.009 1.092 0.236 1.598c0.175 0.349 0.148 0.699-0.079 1.048-0.105 0.14-0.271 0.284-0.498 0.432s-0.476 0.284-0.747 0.406-0.555 0.218-0.851 0.288c-0.297 0.070-0.559 0.105-0.786 0.105-0.157 0-0.306-0.061-0.445-0.183s-0.236-0.253-0.288-0.393h-0.026c-0.192-0.541-0.52-1.009-0.982-1.402s-1-0.589-1.611-0.589c-0.594 0-1.131 0.197-1.611 0.589s-0.816 0.851-1.009 1.375c-0.087 0.21-0.218 0.362-0.393 0.458s-0.367 0.144-0.576 0.144c-0.244 0-0.52-0.044-0.825-0.131s-0.611-0.197-0.917-0.327c-0.306-0.131-0.581-0.284-0.825-0.458s-0.428-0.349-0.55-0.524c-0.087-0.122-0.135-0.266-0.144-0.432s0.057-0.397 0.197-0.694c0.192-0.402 0.266-0.86 0.223-1.375s-0.266-0.991-0.668-1.428c-0.244-0.262-0.541-0.432-0.891-0.511s-0.681-0.109-0.995-0.092c-0.367 0.017-0.742 0.087-1.127 0.21-0.244 0.070-0.489 0.052-0.734-0.052-0.192-0.070-0.371-0.231-0.537-0.485s-0.314-0.533-0.445-0.838c-0.131-0.306-0.231-0.62-0.301-0.943s-0.087-0.59-0.052-0.799c0.052-0.384 0.227-0.629 0.524-0.734 0.524-0.21 0.995-0.555 1.415-1.035s0.629-1.017 0.629-1.611c0-0.611-0.21-1.144-0.629-1.598s-0.891-0.786-1.415-0.996c-0.157-0.052-0.288-0.179-0.393-0.38s-0.157-0.406-0.157-0.616c0-0.227 0.035-0.48 0.105-0.76s0.162-0.55 0.275-0.812 0.244-0.502 0.393-0.72c0.148-0.218 0.31-0.38 0.485-0.485 0.14-0.087 0.275-0.122 0.406-0.105s0.275 0.052 0.432 0.105c0.524 0.21 1.070 0.275 1.637 0.197s1.070-0.327 1.506-0.747c0.21-0.209 0.362-0.467 0.458-0.773s0.157-0.607 0.183-0.904c0.026-0.297 0.026-0.568 0-0.812s-0.048-0.419-0.065-0.524c-0.035-0.105-0.066-0.227-0.092-0.367s-0.013-0.262 0.039-0.367c0.105-0.244 0.293-0.458 0.563-0.642s0.563-0.336 0.878-0.458c0.314-0.122 0.62-0.214 0.917-0.275s0.533-0.092 0.707-0.092c0.227 0 0.406 0.074 0.537 0.223s0.223 0.301 0.275 0.458c0.192 0.471 0.507 0.886 0.943 1.244s0.952 0.537 1.546 0.537c0.611 0 1.153-0.17 1.624-0.511s0.803-0.773 0.996-1.297c0.070-0.14 0.179-0.284 0.327-0.432s0.301-0.223 0.458-0.223c0.244 0 0.511 0.035 0.799 0.105s0.572 0.166 0.851 0.288c0.279 0.122 0.537 0.279 0.773 0.472s0.423 0.402 0.563 0.629c0.087 0.14 0.113 0.293 0.079 0.458s-0.070 0.284-0.105 0.354c-0.227 0.506-0.297 1.039-0.21 1.598s0.341 1.048 0.76 1.467c0.419 0.419 0.934 0.651 1.546 0.694s1.179-0.057 1.703-0.301c0.14-0.087 0.31-0.122 0.511-0.105s0.371 0.096 0.511 0.236c0.262 0.244 0.493 0.616 0.694 1.113s0.336 1 0.406 1.506c0.035 0.297-0.013 0.528-0.144 0.694s-0.266 0.275-0.406 0.327c-0.542 0.192-1.004 0.528-1.388 1.009s-0.576 1.026-0.576 1.637c0 0.594 0.162 1.113 0.485 1.559s0.747 0.764 1.27 0.956c0.122 0.070 0.227 0.14 0.314 0.21 0.192 0.157 0.323 0.358 0.393 0.602v0zM16.451 19.462c0.786 0 1.528-0.149 2.227-0.445s1.305-0.707 1.821-1.231c0.515-0.524 0.921-1.131 1.218-1.821s0.445-1.428 0.445-2.214c0-0.786-0.148-1.524-0.445-2.214s-0.703-1.292-1.218-1.808c-0.515-0.515-1.122-0.921-1.821-1.218s-1.441-0.445-2.227-0.445c-0.786 0-1.524 0.148-2.214 0.445s-1.292 0.703-1.808 1.218c-0.515 0.515-0.921 1.118-1.218 1.808s-0.445 1.428-0.445 2.214c0 0.786 0.149 1.524 0.445 2.214s0.703 1.297 1.218 1.821c0.515 0.524 1.118 0.934 1.808 1.231s1.428 0.445 2.214 0.445v0z"></path></svg>'},410:me=>{me.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M26.667 5.333h-21.333c-0 0-0.001 0-0.001 0-1.472 0-2.666 1.194-2.666 2.666 0 0 0 0.001 0 0.001v-0 16c0 0 0 0.001 0 0.001 0 1.472 1.194 2.666 2.666 2.666 0 0 0.001 0 0.001 0h21.333c0 0 0.001 0 0.001 0 1.472 0 2.666-1.194 2.666-2.666 0-0 0-0.001 0-0.001v0-16c0-0 0-0.001 0-0.001 0-1.472-1.194-2.666-2.666-2.666-0 0-0.001 0-0.001 0h0zM5.333 16h5.333v2.667h-5.333v-2.667zM18.667 24h-13.333v-2.667h13.333v2.667zM26.667 24h-5.333v-2.667h5.333v2.667zM26.667 18.667h-13.333v-2.667h13.333v2.667z"></path></svg>'},644:me=>{me.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8zM20.576 16q0 1.344-0.768 2.528t-2.016 1.664q-0.16 0.096-0.448 0.096-0.448 0-0.8-0.32t-0.32-0.832q0-0.384 0.192-0.64t0.544-0.448 0.608-0.384 0.512-0.64 0.192-1.024-0.192-1.024-0.512-0.64-0.608-0.384-0.544-0.448-0.192-0.64q0-0.48 0.32-0.832t0.8-0.32q0.288 0 0.448 0.096 1.248 0.48 2.016 1.664t0.768 2.528z"></path></svg>'},324:me=>{me.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8z"></path></svg>'},437:me=>{me.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8zM20.576 16q0 1.344-0.768 2.528t-2.016 1.664q-0.16 0.096-0.448 0.096-0.448 0-0.8-0.32t-0.32-0.832q0-0.384 0.192-0.64t0.544-0.448 0.608-0.384 0.512-0.64 0.192-1.024-0.192-1.024-0.512-0.64-0.608-0.384-0.544-0.448-0.192-0.64q0-0.48 0.32-0.832t0.8-0.32q0.288 0 0.448 0.096 1.248 0.48 2.016 1.664t0.768 2.528zM25.152 16q0 2.72-1.536 5.056t-4 3.36q-0.256 0.096-0.448 0.096-0.48 0-0.832-0.352t-0.32-0.8q0-0.704 0.672-1.056 1.024-0.512 1.376-0.8 1.312-0.96 2.048-2.4t0.736-3.104-0.736-3.104-2.048-2.4q-0.352-0.288-1.376-0.8-0.672-0.352-0.672-1.056 0-0.448 0.32-0.8t0.8-0.352q0.224 0 0.48 0.096 2.496 1.056 4 3.36t1.536 5.056z"></path></svg>'},897:(me,Le,ve)=>{"use strict";var re=typeof self!="undefined"?self:typeof window!="undefined"?window:ve.g!==void 0?ve.g:{},ie=Object.create(re),J=/["&'<>]/;function D(v){return typeof v!="string"&&(v=v==null?"":typeof v=="function"?D(v.call(v)):JSON.stringify(v)),v}ie.$escape=function(v){return function($){var I=""+$,H=J.exec(I);if(!H)return $;var X="",O=void 0,G=void 0,j=void 0;for(O=H.index,G=0;O<I.length;O++){switch(I.charCodeAt(O)){case 34:j="&#34;";break;case 38:j="&#38;";break;case 39:j="&#39;";break;case 60:j="&#60;";break;case 62:j="&#62;";break;default:continue}G!==O&&(X+=I.substring(G,O)),G=O+1,X+=j}return G!==O?X+I.substring(G,O):X}(D(v))},ie.$each=function(v,$){if(Array.isArray(v))for(var I=0,H=v.length;I<H;I++)$(v[I],I);else for(var X in v)$(v[X],X)},me.exports=ie},471:(me,Le,ve)=>{"use strict";me.exports=ve(897)},352:me=>{"use strict";me.exports=function(Le){var ve=[];return ve.toString=function(){return this.map(function(re){var ie="",J=re[5]!==void 0;return re[4]&&(ie+="@supports (".concat(re[4],") {")),re[2]&&(ie+="@media ".concat(re[2]," {")),J&&(ie+="@layer".concat(re[5].length>0?" ".concat(re[5]):""," {")),ie+=Le(re),J&&(ie+="}"),re[2]&&(ie+="}"),re[4]&&(ie+="}"),ie}).join("")},ve.i=function(re,ie,J,D,v){typeof re=="string"&&(re=[[null,re,void 0]]);var $={};if(J)for(var I=0;I<this.length;I++){var H=this[I][0];H!=null&&($[H]=!0)}for(var X=0;X<re.length;X++){var O=[].concat(re[X]);J&&$[O[0]]||(v!==void 0&&(O[5]===void 0||(O[1]="@layer".concat(O[5].length>0?" ".concat(O[5]):""," {").concat(O[1],"}")),O[5]=v),ie&&(O[2]&&(O[1]="@media ".concat(O[2]," {").concat(O[1],"}")),O[2]=ie),D&&(O[4]?(O[1]="@supports (".concat(O[4],") {").concat(O[1],"}"),O[4]=D):O[4]="".concat(D)),ve.push(O))}},ve}},80:me=>{"use strict";me.exports=function(Le,ve){return ve||(ve={}),Le&&(Le=String(Le.__esModule?Le.default:Le),/^['"].*['"]$/.test(Le)&&(Le=Le.slice(1,-1)),ve.hash&&(Le+=ve.hash),/["'() \t\n]|(%20)/.test(Le)||ve.needQuotes?'"'.concat(Le.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):Le)}},415:me=>{"use strict";me.exports=function(Le){var ve=Le[1],re=Le[3];if(!re)return ve;if(typeof btoa=="function"){var ie=btoa(unescape(encodeURIComponent(JSON.stringify(re)))),J="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(ie),D="/*# ".concat(J," */");return[ve].concat([D]).join(`
`)}return[ve].join(`
`)}},937:me=>{function Le(ve){return Le=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(re){return typeof re}:function(re){return re&&typeof Symbol=="function"&&re.constructor===Symbol&&re!==Symbol.prototype?"symbol":typeof re},Le(ve)}me.exports=(typeof self=="undefined"?"undefined":Le(self))=="object"?self.FormData:window.FormData},831:me=>{"use strict";me.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAADGCAYAAAAT+OqFAAAAdklEQVQoz42QQQ7AIAgEF/T/D+kbq/RWAlnQyyazA4aoAB4FsBSA/bFjuF1EOL7VbrIrBuusmrt4ZZORfb6ehbWdnRHEIiITaEUKa5EJqUakRSaEYBJSCY2dEstQY7AuxahwXFrvZmWl2rh4JZ07z9dLtesfNj5q0FU3A5ObbwAAAABJRU5ErkJggg=="}},Ze={};function Ee(me){var Le=Ze[me];if(Le!==void 0)return Le.exports;var ve=Ze[me]={id:me,exports:{}};return le[me](ve,ve.exports,Ee),ve.exports}Ee.m=le,Ee.n=me=>{var Le=me&&me.__esModule?()=>me.default:()=>me;return Ee.d(Le,{a:Le}),Le},Ee.d=(me,Le)=>{for(var ve in Le)Ee.o(Le,ve)&&!Ee.o(me,ve)&&Object.defineProperty(me,ve,{enumerable:!0,get:Le[ve]})},Ee.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(me){if(typeof window=="object")return window}}(),Ee.o=(me,Le)=>Object.prototype.hasOwnProperty.call(me,Le),Ee.b=document.baseURI||self.location.href,Ee.nc=void 0;var nt={};return(()=>{"use strict";Ee.d(nt,{default:()=>jo});var me=Ee(856),Le=Ee.n(me),ve=Ee(470),re=Ee.n(ve),ie=Ee(370),J=Ee.n(ie),D=Ee(458),v=Ee.n(D),$=Ee(278),I=Ee.n($),H=Ee(488),X=Ee.n(H),O=Ee(685),G={};G.styleTagTransform=X(),G.setAttributes=v(),G.insert=J().bind(null,"head"),G.domAPI=re(),G.insertStyleElement=I(),Le()(O.Z,G),O.Z&&O.Z.locals&&O.Z.locals;function j(T){return j=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},j(T)}function V(T,k){this.name="AggregateError",this.errors=T,this.message=k||""}V.prototype=Error.prototype;function S(T){return S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},S(T)}var ee=setTimeout;function se(T){return Boolean(T&&T.length!==void 0)}function ue(){}function U(T){if(!(this instanceof U))throw new TypeError("Promises must be constructed via new");if(typeof T!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],Ce(T,this)}function Y(T,k){for(;T._state===3;)T=T._value;T._state!==0?(T._handled=!0,U._immediateFn(function(){var q=T._state===1?k.onFulfilled:k.onRejected;if(q!==null){var x;try{x=q(T._value)}catch(P){return void fe(k.promise,P)}ae(k.promise,x)}else(T._state===1?ae:fe)(k.promise,T._value)})):T._deferreds.push(k)}function ae(T,k){try{if(k===T)throw new TypeError("A promise cannot be resolved with itself.");if(k&&(S(k)==="object"||typeof k=="function")){var q=k.then;if(k instanceof U)return T._state=3,T._value=k,void Ae(T);if(typeof q=="function")return void Ce((x=q,P=k,function(){x.apply(P,arguments)}),T)}T._state=1,T._value=k,Ae(T)}catch(F){fe(T,F)}var x,P}function fe(T,k){T._state=2,T._value=k,Ae(T)}function Ae(T){T._state===2&&T._deferreds.length===0&&U._immediateFn(function(){T._handled||U._unhandledRejectionFn(T._value)});for(var k=0,q=T._deferreds.length;k<q;k++)Y(T,T._deferreds[k]);T._deferreds=null}function Re(T,k,q){this.onFulfilled=typeof T=="function"?T:null,this.onRejected=typeof k=="function"?k:null,this.promise=q}function Ce(T,k){var q=!1;try{T(function(x){q||(q=!0,ae(k,x))},function(x){q||(q=!0,fe(k,x))})}catch(x){if(q)return;q=!0,fe(k,x)}}U.prototype.catch=function(T){return this.then(null,T)},U.prototype.then=function(T,k){var q=new this.constructor(ue);return Y(this,new Re(T,k,q)),q},U.prototype.finally=function(T){var k=this.constructor;return this.then(function(q){return k.resolve(T()).then(function(){return q})},function(q){return k.resolve(T()).then(function(){return k.reject(q)})})},U.all=function(T){return new U(function(k,q){if(!se(T))return q(new TypeError("Promise.all accepts an array"));var x=Array.prototype.slice.call(T);if(x.length===0)return k([]);var P=x.length;function F(pe,ge){try{if(ge&&(S(ge)==="object"||typeof ge=="function")){var Ve=ge.then;if(typeof Ve=="function")return void Ve.call(ge,function(Ke){F(pe,Ke)},q)}x[pe]=ge,--P==0&&k(x)}catch(Ke){q(Ke)}}for(var Q=0;Q<x.length;Q++)F(Q,x[Q])})},U.any=function(T){var k=this;return new k(function(q,x){if(!T||T.length===void 0)return x(new TypeError("Promise.any accepts an array"));var P=Array.prototype.slice.call(T);if(P.length===0)return x();for(var F=[],Q=0;Q<P.length;Q++)try{k.resolve(P[Q]).then(q).catch(function(pe){F.push(pe),F.length===P.length&&x(new V(F,"All promises were rejected"))})}catch(pe){x(pe)}})},U.allSettled=function(T){return new this(function(k,q){if(!T||T.length===void 0)return q(new TypeError(j(T)+" "+T+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var x=Array.prototype.slice.call(T);if(x.length===0)return k([]);var P=x.length;function F(pe,ge){if(ge&&(j(ge)==="object"||typeof ge=="function")){var Ve=ge.then;if(typeof Ve=="function")return void Ve.call(ge,function(Ke){F(pe,Ke)},function(Ke){x[pe]={status:"rejected",reason:Ke},--P==0&&k(x)})}x[pe]={status:"fulfilled",value:ge},--P==0&&k(x)}for(var Q=0;Q<x.length;Q++)F(Q,x[Q])})},U.resolve=function(T){return T&&S(T)==="object"&&T.constructor===U?T:new U(function(k){k(T)})},U.reject=function(T){return new U(function(k,q){q(T)})},U.race=function(T){return new U(function(k,q){if(!se(T))return q(new TypeError("Promise.race accepts an array"));for(var x=0,P=T.length;x<P;x++)U.resolve(T[x]).then(k,q)})},U._immediateFn=typeof setImmediate=="function"&&function(T){setImmediate(T)}||function(T){ee(T,0)},U._unhandledRejectionFn=function(T){typeof console!="undefined"&&console&&console.warn("Possible Unhandled Promise Rejection:",T)};const we=U;var Fe=/mobile/i.test(window.navigator.userAgent);const Ie={secondToTime:function(T){if((T=T||0)===0||T===1/0||T.toString()==="NaN")return"00:00";var k=Math.floor(T/3600),q=Math.floor((T-3600*k)/60),x=Math.floor(T-3600*k-60*q);return(k>0?[k,q,x]:[q,x]).map(function(P){return P<10?"0"+P:""+P}).join(":")},getElementViewLeft:function(T){var k=T.offsetLeft,q=T.offsetParent,x=document.body.scrollLeft+document.documentElement.scrollLeft;if(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement)for(;q!==null&&q!==T;)k+=q.offsetLeft,q=q.offsetParent;else for(;q!==null;)k+=q.offsetLeft,q=q.offsetParent;return k-x},getBoundingClientRectViewLeft:function(T){var k=window.scrollY||window.pageYOffset||document.body.scrollTop+(document.documentElement&&document.documentElement.scrollTop||0);if(T.getBoundingClientRect){if(typeof this.getBoundingClientRectViewLeft.offset!="number"){var q=document.createElement("div");q.style.cssText="position:absolute;top:0;left:0;",document.body.appendChild(q),this.getBoundingClientRectViewLeft.offset=-q.getBoundingClientRect().top-k,document.body.removeChild(q),q=null}var x=T.getBoundingClientRect(),P=this.getBoundingClientRectViewLeft.offset;return x.left+P}return this.getElementViewLeft(T)},getScrollPosition:function(){return{left:window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0,top:window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0}},setScrollPosition:function(T){var k=T.left,q=k===void 0?0:k,x=T.top,P=x===void 0?0:x;this.isFirefox?(document.documentElement.scrollLeft=q,document.documentElement.scrollTop=P):window.scrollTo(q,P)},isMobile:Fe,isFirefox:/firefox/i.test(window.navigator.userAgent),isChrome:/chrome/i.test(window.navigator.userAgent),isSafari:/safari/i.test(window.navigator.userAgent),storage:{set:function(T,k){localStorage.setItem(T,k)},get:function(T){return localStorage.getItem(T)}},nameMap:{dragStart:Fe?"touchstart":"mousedown",dragMove:Fe?"touchmove":"mousemove",dragEnd:Fe?"touchend":"mouseup"},color2Number:function(T){return T[0]==="#"&&(T=T.substr(1)),T.length===3&&(T="".concat(T[0]).concat(T[0]).concat(T[1]).concat(T[1]).concat(T[2]).concat(T[2])),parseInt(T,16)+0&16777215},number2Color:function(T){return"#"+("00000"+T.toString(16)).slice(-6)},number2Type:function(T){switch(T){case 0:default:return"right";case 1:return"top";case 2:return"bottom"}}};function $e(T,k){return function(){return T.apply(k,arguments)}}function Oe(T){return Oe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},Oe(T)}var ht,kt=Object.prototype.toString,Rt=Object.getPrototypeOf,mt=(ht=Object.create(null),function(T){var k=kt.call(T);return ht[k]||(ht[k]=k.slice(8,-1).toLowerCase())}),rt=function(T){return T=T.toLowerCase(),function(k){return mt(k)===T}},Kt=function(T){return function(k){return Oe(k)===T}},_t=Array.isArray,Gt=Kt("undefined"),li=rt("ArrayBuffer"),ei=Kt("string"),Ti=Kt("function"),vi=Kt("number"),Et=function(T){return T!==null&&Oe(T)==="object"},oi=function(T){if(mt(T)!=="object")return!1;var k=Rt(T);return!(k!==null&&k!==Object.prototype&&Object.getPrototypeOf(k)!==null||Symbol.toStringTag in T||Symbol.iterator in T)},ai=rt("Date"),zi=rt("File"),mn=rt("Blob"),Gi=rt("FileList"),en=rt("URLSearchParams");function ln(T,k){var q,x,P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},F=P.allOwnKeys,Q=F!==void 0&&F;if(T!=null)if(Oe(T)!=="object"&&(T=[T]),_t(T))for(q=0,x=T.length;q<x;q++)k.call(null,T[q],q,T);else{var pe,ge=Q?Object.getOwnPropertyNames(T):Object.keys(T),Ve=ge.length;for(q=0;q<Ve;q++)pe=ge[q],k.call(null,T[pe],pe,T)}}function gt(T,k){k=k.toLowerCase();for(var q,x=Object.keys(T),P=x.length;P-- >0;)if(k===(q=x[P]).toLowerCase())return q;return null}var Ai,ki,ui=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:pt.g,Ln=function(T){return!Gt(T)&&T!==ui},Kr=(Ai=typeof Uint8Array!="undefined"&&Rt(Uint8Array),function(T){return Ai&&T instanceof Ai}),Is=rt("HTMLFormElement"),rn=(ki=Object.prototype.hasOwnProperty,function(T,k){return ki.call(T,k)}),Rs=rt("RegExp"),Ye=function(T,k){var q=Object.getOwnPropertyDescriptors(T),x={};ln(q,function(P,F){k(P,F,T)!==!1&&(x[F]=P)}),Object.defineProperties(T,x)};const De={isArray:_t,isArrayBuffer:li,isBuffer:function(T){return T!==null&&!Gt(T)&&T.constructor!==null&&!Gt(T.constructor)&&Ti(T.constructor.isBuffer)&&T.constructor.isBuffer(T)},isFormData:function(T){var k="[object FormData]";return T&&(typeof FormData=="function"&&T instanceof FormData||kt.call(T)===k||Ti(T.toString)&&T.toString()===k)},isArrayBufferView:function(T){return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?ArrayBuffer.isView(T):T&&T.buffer&&li(T.buffer)},isString:ei,isNumber:vi,isBoolean:function(T){return T===!0||T===!1},isObject:Et,isPlainObject:oi,isUndefined:Gt,isDate:ai,isFile:zi,isBlob:mn,isRegExp:Rs,isFunction:Ti,isStream:function(T){return Et(T)&&Ti(T.pipe)},isURLSearchParams:en,isTypedArray:Kr,isFileList:Gi,forEach:ln,merge:function T(){for(var k=Ln(this)&&this||{},q=k.caseless,x={},P=function(pe,ge){var Ve=q&&gt(x,ge)||ge;oi(x[Ve])&&oi(pe)?x[Ve]=T(x[Ve],pe):oi(pe)?x[Ve]=T({},pe):_t(pe)?x[Ve]=pe.slice():x[Ve]=pe},F=0,Q=arguments.length;F<Q;F++)arguments[F]&&ln(arguments[F],P);return x},extend:function(T,k,q){var x=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},P=x.allOwnKeys;return ln(k,function(F,Q){q&&Ti(F)?T[Q]=$e(F,q):T[Q]=F},{allOwnKeys:P}),T},trim:function(T){return T.trim?T.trim():T.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},stripBOM:function(T){return T.charCodeAt(0)===65279&&(T=T.slice(1)),T},inherits:function(T,k,q,x){T.prototype=Object.create(k.prototype,x),T.prototype.constructor=T,Object.defineProperty(T,"super",{value:k.prototype}),q&&Object.assign(T.prototype,q)},toFlatObject:function(T,k,q,x){var P,F,Q,pe={};if(k=k||{},T==null)return k;do{for(F=(P=Object.getOwnPropertyNames(T)).length;F-- >0;)Q=P[F],x&&!x(Q,T,k)||pe[Q]||(k[Q]=T[Q],pe[Q]=!0);T=q!==!1&&Rt(T)}while(T&&(!q||q(T,k))&&T!==Object.prototype);return k},kindOf:mt,kindOfTest:rt,endsWith:function(T,k,q){T=String(T),(q===void 0||q>T.length)&&(q=T.length),q-=k.length;var x=T.indexOf(k,q);return x!==-1&&x===q},toArray:function(T){if(!T)return null;if(_t(T))return T;var k=T.length;if(!vi(k))return null;for(var q=new Array(k);k-- >0;)q[k]=T[k];return q},forEachEntry:function(T,k){for(var q,x=(T&&T[Symbol.iterator]).call(T);(q=x.next())&&!q.done;){var P=q.value;k.call(T,P[0],P[1])}},matchAll:function(T,k){for(var q,x=[];(q=T.exec(k))!==null;)x.push(q);return x},isHTMLForm:Is,hasOwnProperty:rn,hasOwnProp:rn,reduceDescriptors:Ye,freezeMethods:function(T){Ye(T,function(k,q){if(Ti(T)&&["arguments","caller","callee"].indexOf(q)!==-1)return!1;var x=T[q];Ti(x)&&(k.enumerable=!1,"writable"in k?k.writable=!1:k.set||(k.set=function(){throw Error("Can not rewrite read-only method '"+q+"'")}))})},toObjectSet:function(T,k){var q={},x=function(P){P.forEach(function(F){q[F]=!0})};return _t(T)?x(T):x(String(T).split(k)),q},toCamelCase:function(T){return T.toLowerCase().replace(/[_-\s]([a-z\d])(\w*)/g,function(k,q,x){return q.toUpperCase()+x})},noop:function(){},toFiniteNumber:function(T,k){return T=+T,Number.isFinite(T)?T:k},findKey:gt,global:ui,isContextDefined:Ln,toJSONObject:function(T){var k=new Array(10);return function q(x,P){if(Et(x)){if(k.indexOf(x)>=0)return;if(!("toJSON"in x)){k[P]=x;var F=_t(x)?[]:{};return ln(x,function(Q,pe){var ge=q(Q,P+1);!Gt(ge)&&(F[pe]=ge)}),k[P]=void 0,F}}return x}(T,0)}};function yt(T,k,q,x,P){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=T,this.name="AxiosError",k&&(this.code=k),q&&(this.config=q),x&&(this.request=x),P&&(this.response=P)}De.inherits(yt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:De.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var Ct=yt.prototype,wt={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(function(T){wt[T]={value:T}}),Object.defineProperties(yt,wt),Object.defineProperty(Ct,"isAxiosError",{value:!0}),yt.from=function(T,k,q,x,P,F){var Q=Object.create(Ct);return De.toFlatObject(T,Q,function(pe){return pe!==Error.prototype},function(pe){return pe!=="isAxiosError"}),yt.call(Q,T.message,k,q,x,P),Q.cause=T,Q.name=T.name,F&&Object.assign(Q,F),Q};const Dt=yt,Ni=Ee(937);function fi(T){return fi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},fi(T)}function Dn(T){return De.isPlainObject(T)||De.isArray(T)}function Ut(T){return De.endsWith(T,"[]")?T.slice(0,-2):T}function Xn(T,k,q){return T?T.concat(k).map(function(x,P){return x=Ut(x),!q&&P?"["+x+"]":x}).join(q?".":""):k}var Ps=De.toFlatObject(De,{},null,function(T){return/^is[A-Z]/.test(T)});const ur=function(T,k,q){if(!De.isObject(T))throw new TypeError("target must be an object");k=k||new(Ni||FormData);var x,P=(q=De.toFlatObject(q,{metaTokens:!0,dots:!1,indexes:!1},!1,function(Ot,Tt){return!De.isUndefined(Tt[Ot])})).metaTokens,F=q.visitor||Ke,Q=q.dots,pe=q.indexes,ge=(q.Blob||typeof Blob!="undefined"&&Blob)&&(x=k)&&De.isFunction(x.append)&&x[Symbol.toStringTag]==="FormData"&&x[Symbol.iterator];if(!De.isFunction(F))throw new TypeError("visitor must be a function");function Ve(Ot){if(Ot===null)return"";if(De.isDate(Ot))return Ot.toISOString();if(!ge&&De.isBlob(Ot))throw new Dt("Blob is not supported. Use a Buffer instead.");return De.isArrayBuffer(Ot)||De.isTypedArray(Ot)?ge&&typeof Blob=="function"?new Blob([Ot]):ut.from(Ot):Ot}function Ke(Ot,Tt,At){var Ft=Ot;if(Ot&&!At&&fi(Ot)==="object"){if(De.endsWith(Tt,"{}"))Tt=P?Tt:Tt.slice(0,-2),Ot=JSON.stringify(Ot);else if(De.isArray(Ot)&&function(Jt){return De.isArray(Jt)&&!Jt.some(Dn)}(Ot)||De.isFileList(Ot)||De.endsWith(Tt,"[]")&&(Ft=De.toArray(Ot)))return Tt=Ut(Tt),Ft.forEach(function(Jt,Ki){!De.isUndefined(Jt)&&Jt!==null&&k.append(pe===!0?Xn([Tt],Ki,Q):pe===null?Tt:Tt+"[]",Ve(Jt))}),!1}return!!Dn(Ot)||(k.append(Xn(At,Tt,Q),Ve(Ot)),!1)}var vt=[],bt=Object.assign(Ps,{defaultVisitor:Ke,convertValue:Ve,isVisitable:Dn});if(!De.isObject(T))throw new TypeError("data must be an object");return function Ot(Tt,At){if(!De.isUndefined(Tt)){if(vt.indexOf(Tt)!==-1)throw Error("Circular reference detected in "+At.join("."));vt.push(Tt),De.forEach(Tt,function(Ft,Jt){(!(De.isUndefined(Ft)||Ft===null)&&F.call(k,Ft,De.isString(Jt)?Jt.trim():Jt,At,bt))===!0&&Ot(Ft,At?At.concat(Jt):[Jt])}),vt.pop()}}(T),k};function Lr(T){var k={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(T).replace(/[!'()~]|%20|%00/g,function(q){return k[q]})}function Mt(T,k){this._pairs=[],T&&ur(T,this,k)}var ls=Mt.prototype;ls.append=function(T,k){this._pairs.push([T,k])},ls.toString=function(T){var k=T?function(q){return T.call(this,q,Lr)}:Lr;return this._pairs.map(function(q){return k(q[0])+"="+k(q[1])},"").join("&")};const us=Mt;function dr(T){return encodeURIComponent(T).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function cr(T,k,q){if(!k)return T;var x,P=q&&q.encode||dr,F=q&&q.serialize;if(x=F?F(k,q):De.isURLSearchParams(k)?k.toString():new us(k,q).toString(P)){var Q=T.indexOf("#");Q!==-1&&(T=T.slice(0,Q)),T+=(T.indexOf("?")===-1?"?":"&")+x}return T}function vn(T){return vn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},vn(T)}function kn(T,k){for(var q=0;q<k.length;q++){var x=k[q];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(T,(P=function(F,Q){if(vn(F)!=="object"||F===null)return F;var pe=F[Symbol.toPrimitive];if(pe!==void 0){var ge=pe.call(F,"string");if(vn(ge)!=="object")return ge;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(x.key),vn(P)==="symbol"?P:String(P)),x)}var P}var Qn=function(){function T(){(function(x,P){if(!(x instanceof P))throw new TypeError("Cannot call a class as a function")})(this,T),this.handlers=[]}var k,q;return k=T,q=[{key:"use",value:function(x,P,F){return this.handlers.push({fulfilled:x,rejected:P,synchronous:!!F&&F.synchronous,runWhen:F?F.runWhen:null}),this.handlers.length-1}},{key:"eject",value:function(x){this.handlers[x]&&(this.handlers[x]=null)}},{key:"clear",value:function(){this.handlers&&(this.handlers=[])}},{key:"forEach",value:function(x){De.forEach(this.handlers,function(P){P!==null&&x(P)})}}],q&&kn(k.prototype,q),Object.defineProperty(k,"prototype",{writable:!1}),T}();const Jn=Qn,Ao={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},te=typeof URLSearchParams!="undefined"?URLSearchParams:us,oe=FormData;var Se,qe=(typeof navigator=="undefined"||(Se=navigator.product)!=="ReactNative"&&Se!=="NativeScript"&&Se!=="NS")&&typeof window!="undefined"&&typeof document!="undefined",ft=typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function";const jt={isBrowser:!0,classes:{URLSearchParams:te,FormData:oe,Blob},isStandardBrowserEnv:qe,isStandardBrowserWebWorkerEnv:ft,protocols:["http","https","file","blob","url","data"]},Si=function(T){function k(x,P,F,Q){var pe=x[Q++],ge=Number.isFinite(+pe),Ve=Q>=x.length;return pe=!pe&&De.isArray(F)?F.length:pe,Ve?(De.hasOwnProp(F,pe)?F[pe]=[F[pe],P]:F[pe]=P,!ge):(F[pe]&&De.isObject(F[pe])||(F[pe]=[]),k(x,P,F[pe],Q)&&De.isArray(F[pe])&&(F[pe]=function(Ke){var vt,bt,Ot={},Tt=Object.keys(Ke),At=Tt.length;for(vt=0;vt<At;vt++)Ot[bt=Tt[vt]]=Ke[bt];return Ot}(F[pe])),!ge)}if(De.isFormData(T)&&De.isFunction(T.entries)){var q={};return De.forEachEntry(T,function(x,P){k(function(F){return De.matchAll(/\w+|\[(\w*)]/g,F).map(function(Q){return Q[0]==="[]"?"":Q[1]||Q[0]})}(x),P,q,0)}),q}return null};var Ii={"Content-Type":void 0},un={transitional:Ao,adapter:["xhr","http"],transformRequest:[function(T,k){var q,x=k.getContentType()||"",P=x.indexOf("application/json")>-1,F=De.isObject(T);if(F&&De.isHTMLForm(T)&&(T=new FormData(T)),De.isFormData(T))return P&&P?JSON.stringify(Si(T)):T;if(De.isArrayBuffer(T)||De.isBuffer(T)||De.isStream(T)||De.isFile(T)||De.isBlob(T))return T;if(De.isArrayBufferView(T))return T.buffer;if(De.isURLSearchParams(T))return k.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),T.toString();if(F){if(x.indexOf("application/x-www-form-urlencoded")>-1)return function(pe,ge){return ur(pe,new jt.classes.URLSearchParams,Object.assign({visitor:function(Ve,Ke,vt,bt){return jt.isNode&&De.isBuffer(Ve)?(this.append(Ke,Ve.toString("base64")),!1):bt.defaultVisitor.apply(this,arguments)}},ge))}(T,this.formSerializer).toString();if((q=De.isFileList(T))||x.indexOf("multipart/form-data")>-1){var Q=this.env&&this.env.FormData;return ur(q?{"files[]":T}:T,Q&&new Q,this.formSerializer)}}return F||P?(k.setContentType("application/json",!1),function(pe,ge,Ve){if(De.isString(pe))try{return(0,JSON.parse)(pe),De.trim(pe)}catch(Ke){if(Ke.name!=="SyntaxError")throw Ke}return(0,JSON.stringify)(pe)}(T)):T}],transformResponse:[function(T){var k=this.transitional||un.transitional,q=k&&k.forcedJSONParsing,x=this.responseType==="json";if(T&&De.isString(T)&&(q&&!this.responseType||x)){var P=!(k&&k.silentJSONParsing)&&x;try{return JSON.parse(T)}catch(F){if(P)throw F.name==="SyntaxError"?Dt.from(F,Dt.ERR_BAD_RESPONSE,this,null,this.response):F}}return T}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:jt.classes.FormData,Blob:jt.classes.Blob},validateStatus:function(T){return T>=200&&T<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};De.forEach(["delete","get","head"],function(T){un.headers[T]={}}),De.forEach(["post","put","patch"],function(T){un.headers[T]=De.merge(Ii)});const gn=un;var In=De.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]);function jn(T){return jn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},jn(T)}function Zn(T,k){(k==null||k>T.length)&&(k=T.length);for(var q=0,x=new Array(k);q<k;q++)x[q]=T[q];return x}function er(T,k){for(var q=0;q<k.length;q++){var x=k[q];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(T,(P=function(F,Q){if(jn(F)!=="object"||F===null)return F;var pe=F[Symbol.toPrimitive];if(pe!==void 0){var ge=pe.call(F,"string");if(jn(ge)!=="object")return ge;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(x.key),jn(P)==="symbol"?P:String(P)),x)}var P}var yn=Symbol("internals");function Hi(T){return T&&String(T).trim().toLowerCase()}function Tn(T){return T===!1||T==null?T:De.isArray(T)?T.map(Tn):String(T)}function hr(T,k,q,x){return De.isFunction(x)?x.call(this,k,q):De.isString(k)?De.isString(x)?k.indexOf(x)!==-1:De.isRegExp(x)?x.test(k):void 0:void 0}var Dr=function(T,k){function q(Q){(function(pe,ge){if(!(pe instanceof ge))throw new TypeError("Cannot call a class as a function")})(this,q),Q&&this.set(Q)}var x,P,F;return x=q,P=[{key:"set",value:function(Q,pe,ge){var Ve=this;function Ke(Jt,Ki,ji){var gi=Hi(Ki);if(!gi)throw new Error("header name must be a non-empty string");var br=De.findKey(Ve,gi);(!br||Ve[br]===void 0||ji===!0||ji===void 0&&Ve[br]!==!1)&&(Ve[br||Ki]=Tn(Jt))}var vt,bt,Ot,Tt,At,Ft=function(Jt,Ki){return De.forEach(Jt,function(ji,gi){return Ke(ji,gi,Ki)})};return De.isPlainObject(Q)||Q instanceof this.constructor?Ft(Q,pe):De.isString(Q)&&(Q=Q.trim())&&!/^[-_a-zA-Z]+$/.test(Q.trim())?Ft((At={},(vt=Q)&&vt.split(`
`).forEach(function(Jt){Tt=Jt.indexOf(":"),bt=Jt.substring(0,Tt).trim().toLowerCase(),Ot=Jt.substring(Tt+1).trim(),!bt||At[bt]&&In[bt]||(bt==="set-cookie"?At[bt]?At[bt].push(Ot):At[bt]=[Ot]:At[bt]=At[bt]?At[bt]+", "+Ot:Ot)}),At),pe):Q!=null&&Ke(pe,Q,ge),this}},{key:"get",value:function(Q,pe){if(Q=Hi(Q)){var ge=De.findKey(this,Q);if(ge){var Ve=this[ge];if(!pe)return Ve;if(pe===!0)return function(Ke){for(var vt,bt=Object.create(null),Ot=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;vt=Ot.exec(Ke);)bt[vt[1]]=vt[2];return bt}(Ve);if(De.isFunction(pe))return pe.call(this,Ve,ge);if(De.isRegExp(pe))return pe.exec(Ve);throw new TypeError("parser must be boolean|regexp|function")}}}},{key:"has",value:function(Q,pe){if(Q=Hi(Q)){var ge=De.findKey(this,Q);return!(!ge||pe&&!hr(0,this[ge],ge,pe))}return!1}},{key:"delete",value:function(Q,pe){var ge=this,Ve=!1;function Ke(vt){if(vt=Hi(vt)){var bt=De.findKey(ge,vt);!bt||pe&&!hr(0,ge[bt],bt,pe)||(delete ge[bt],Ve=!0)}}return De.isArray(Q)?Q.forEach(Ke):Ke(Q),Ve}},{key:"clear",value:function(){return Object.keys(this).forEach(this.delete.bind(this))}},{key:"normalize",value:function(Q){var pe=this,ge={};return De.forEach(this,function(Ve,Ke){var vt=De.findKey(ge,Ke);if(vt)return pe[vt]=Tn(Ve),void delete pe[Ke];var bt=Q?function(Ot){return Ot.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,function(Tt,At,Ft){return At.toUpperCase()+Ft})}(Ke):String(Ke).trim();bt!==Ke&&delete pe[Ke],pe[bt]=Tn(Ve),ge[bt]=!0}),this}},{key:"concat",value:function(){for(var Q,pe=arguments.length,ge=new Array(pe),Ve=0;Ve<pe;Ve++)ge[Ve]=arguments[Ve];return(Q=this.constructor).concat.apply(Q,[this].concat(ge))}},{key:"toJSON",value:function(Q){var pe=Object.create(null);return De.forEach(this,function(ge,Ve){ge!=null&&ge!==!1&&(pe[Ve]=Q&&De.isArray(ge)?ge.join(", "):ge)}),pe}},{key:Symbol.iterator,value:function(){return Object.entries(this.toJSON())[Symbol.iterator]()}},{key:"toString",value:function(){return Object.entries(this.toJSON()).map(function(Q){var pe,ge,Ve=(ge=2,function(Ke){if(Array.isArray(Ke))return Ke}(pe=Q)||function(Ke,vt){var bt=Ke==null?null:typeof Symbol!="undefined"&&Ke[Symbol.iterator]||Ke["@@iterator"];if(bt!=null){var Ot,Tt,At,Ft,Jt=[],Ki=!0,ji=!1;try{if(At=(bt=bt.call(Ke)).next,vt===0){if(Object(bt)!==bt)return;Ki=!1}else for(;!(Ki=(Ot=At.call(bt)).done)&&(Jt.push(Ot.value),Jt.length!==vt);Ki=!0);}catch(gi){ji=!0,Tt=gi}finally{try{if(!Ki&&bt.return!=null&&(Ft=bt.return(),Object(Ft)!==Ft))return}finally{if(ji)throw Tt}}return Jt}}(pe,ge)||function(Ke,vt){if(Ke){if(typeof Ke=="string")return Zn(Ke,vt);var bt=Object.prototype.toString.call(Ke).slice(8,-1);return bt==="Object"&&Ke.constructor&&(bt=Ke.constructor.name),bt==="Map"||bt==="Set"?Array.from(Ke):bt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(bt)?Zn(Ke,vt):void 0}}(pe,ge)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}());return Ve[0]+": "+Ve[1]}).join(`
`)}},{key:Symbol.toStringTag,get:function(){return"AxiosHeaders"}}],F=[{key:"from",value:function(Q){return Q instanceof this?Q:new this(Q)}},{key:"concat",value:function(Q){for(var pe=new this(Q),ge=arguments.length,Ve=new Array(ge>1?ge-1:0),Ke=1;Ke<ge;Ke++)Ve[Ke-1]=arguments[Ke];return Ve.forEach(function(vt){return pe.set(vt)}),pe}},{key:"accessor",value:function(Q){var pe=(this[yn]=this[yn]={accessors:{}}).accessors,ge=this.prototype;function Ve(Ke){var vt=Hi(Ke);pe[vt]||(function(bt,Ot){var Tt=De.toCamelCase(" "+Ot);["get","set","has"].forEach(function(At){Object.defineProperty(bt,At+Tt,{value:function(Ft,Jt,Ki){return this[At].call(this,Ot,Ft,Jt,Ki)},configurable:!0})})}(ge,Ke),pe[vt]=!0)}return De.isArray(Q)?Q.forEach(Ve):Ve(Q),this}}],P&&er(x.prototype,P),F&&er(x,F),Object.defineProperty(x,"prototype",{writable:!1}),q}();Dr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent"]),De.freezeMethods(Dr.prototype),De.freezeMethods(Dr);const bi=Dr;function kr(T,k){var q=this||gn,x=k||q,P=bi.from(x.headers),F=x.data;return De.forEach(T,function(Q){F=Q.call(q,F,P.normalize(),k?k.status:void 0)}),P.normalize(),F}function Ia(T){return!(!T||!T.__CANCEL__)}function bo(T,k,q){Dt.call(this,T==null?"canceled":T,Dt.ERR_CANCELED,k,q),this.name="CanceledError"}De.inherits(bo,Dt,{__CANCEL__:!0});const fr=bo,sa=jt.isStandardBrowserEnv?{write:function(T,k,q,x,P,F){var Q=[];Q.push(T+"="+encodeURIComponent(k)),De.isNumber(q)&&Q.push("expires="+new Date(q).toGMTString()),De.isString(x)&&Q.push("path="+x),De.isString(P)&&Q.push("domain="+P),F===!0&&Q.push("secure"),document.cookie=Q.join("; ")},read:function(T){var k=document.cookie.match(new RegExp("(^|;\\s*)("+T+")=([^;]*)"));return k?decodeURIComponent(k[3]):null},remove:function(T){this.write(T,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}};function _o(T,k){return T&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(k)?function(q,x){return x?q.replace(/\/+$/,"")+"/"+x.replace(/^\/+/,""):q}(T,k):k}const Ra=jt.isStandardBrowserEnv?function(){var T,k=/(msie|trident)/i.test(navigator.userAgent),q=document.createElement("a");function x(P){var F=P;return k&&(q.setAttribute("href",F),F=q.href),q.setAttribute("href",F),{href:q.href,protocol:q.protocol?q.protocol.replace(/:$/,""):"",host:q.host,search:q.search?q.search.replace(/^\?/,""):"",hash:q.hash?q.hash.replace(/^#/,""):"",hostname:q.hostname,port:q.port,pathname:q.pathname.charAt(0)==="/"?q.pathname:"/"+q.pathname}}return T=x(window.location.href),function(P){var F=De.isString(P)?x(P):P;return F.protocol===T.protocol&&F.host===T.host}}():function(){return!0};function Pa(T,k){var q=0,x=function(P,F){P=P||10;var Q,pe=new Array(P),ge=new Array(P),Ve=0,Ke=0;return F=F!==void 0?F:1e3,function(vt){var bt=Date.now(),Ot=ge[Ke];Q||(Q=bt),pe[Ve]=vt,ge[Ve]=bt;for(var Tt=Ke,At=0;Tt!==Ve;)At+=pe[Tt++],Tt%=P;if((Ve=(Ve+1)%P)===Ke&&(Ke=(Ke+1)%P),!(bt-Q<F)){var Ft=Ot&&bt-Ot;return Ft?Math.round(1e3*At/Ft):void 0}}}(50,250);return function(P){var F=P.loaded,Q=P.lengthComputable?P.total:void 0,pe=F-q,ge=x(pe);q=F;var Ve={loaded:F,total:Q,progress:Q?F/Q:void 0,bytes:pe,rate:ge||void 0,estimated:ge&&Q&&F<=Q?(Q-F)/ge:void 0,event:P};Ve[k?"download":"upload"]=!0,T(Ve)}}const ds=typeof XMLHttpRequest!="undefined"&&function(T){return new Promise(function(k,q){var x,P=T.data,F=bi.from(T.headers).normalize(),Q=T.responseType;function pe(){T.cancelToken&&T.cancelToken.unsubscribe(x),T.signal&&T.signal.removeEventListener("abort",x)}De.isFormData(P)&&(jt.isStandardBrowserEnv||jt.isStandardBrowserWebWorkerEnv)&&F.setContentType(!1);var ge=new XMLHttpRequest;if(T.auth){var Ve=T.auth.username||"",Ke=T.auth.password?unescape(encodeURIComponent(T.auth.password)):"";F.set("Authorization","Basic "+btoa(Ve+":"+Ke))}var vt=_o(T.baseURL,T.url);function bt(){if(ge){var Ft=bi.from("getAllResponseHeaders"in ge&&ge.getAllResponseHeaders());(function(Jt,Ki,ji){var gi=ji.config.validateStatus;ji.status&&gi&&!gi(ji.status)?Ki(new Dt("Request failed with status code "+ji.status,[Dt.ERR_BAD_REQUEST,Dt.ERR_BAD_RESPONSE][Math.floor(ji.status/100)-4],ji.config,ji.request,ji)):Jt(ji)})(function(Jt){k(Jt),pe()},function(Jt){q(Jt),pe()},{data:Q&&Q!=="text"&&Q!=="json"?ge.response:ge.responseText,status:ge.status,statusText:ge.statusText,headers:Ft,config:T,request:ge}),ge=null}}if(ge.open(T.method.toUpperCase(),cr(vt,T.params,T.paramsSerializer),!0),ge.timeout=T.timeout,"onloadend"in ge?ge.onloadend=bt:ge.onreadystatechange=function(){ge&&ge.readyState===4&&(ge.status!==0||ge.responseURL&&ge.responseURL.indexOf("file:")===0)&&setTimeout(bt)},ge.onabort=function(){ge&&(q(new Dt("Request aborted",Dt.ECONNABORTED,T,ge)),ge=null)},ge.onerror=function(){q(new Dt("Network Error",Dt.ERR_NETWORK,T,ge)),ge=null},ge.ontimeout=function(){var Ft=T.timeout?"timeout of "+T.timeout+"ms exceeded":"timeout exceeded",Jt=T.transitional||Ao;T.timeoutErrorMessage&&(Ft=T.timeoutErrorMessage),q(new Dt(Ft,Jt.clarifyTimeoutError?Dt.ETIMEDOUT:Dt.ECONNABORTED,T,ge)),ge=null},jt.isStandardBrowserEnv){var Ot=(T.withCredentials||Ra(vt))&&T.xsrfCookieName&&sa.read(T.xsrfCookieName);Ot&&F.set(T.xsrfHeaderName,Ot)}P===void 0&&F.setContentType(null),"setRequestHeader"in ge&&De.forEach(F.toJSON(),function(Ft,Jt){ge.setRequestHeader(Jt,Ft)}),De.isUndefined(T.withCredentials)||(ge.withCredentials=!!T.withCredentials),Q&&Q!=="json"&&(ge.responseType=T.responseType),typeof T.onDownloadProgress=="function"&&ge.addEventListener("progress",Pa(T.onDownloadProgress,!0)),typeof T.onUploadProgress=="function"&&ge.upload&&ge.upload.addEventListener("progress",Pa(T.onUploadProgress)),(T.cancelToken||T.signal)&&(x=function(Ft){ge&&(q(!Ft||Ft.type?new fr(null,T,ge):Ft),ge.abort(),ge=null)},T.cancelToken&&T.cancelToken.subscribe(x),T.signal&&(T.signal.aborted?x():T.signal.addEventListener("abort",x)));var Tt,At=(Tt=/^([-+\w]{1,25})(:?\/\/|:)/.exec(vt))&&Tt[1]||"";At&&jt.protocols.indexOf(At)===-1?q(new Dt("Unsupported protocol "+At+":",Dt.ERR_BAD_REQUEST,T)):ge.send(P||null)})};var aa={http:null,xhr:ds};De.forEach(aa,function(T,k){if(T){try{Object.defineProperty(T,"name",{value:k})}catch(q){}Object.defineProperty(T,"adapterName",{value:k})}});function cs(T){if(T.cancelToken&&T.cancelToken.throwIfRequested(),T.signal&&T.signal.aborted)throw new fr(null,T)}function Os(T){return cs(T),T.headers=bi.from(T.headers),T.data=kr.call(T,T.transformRequest),["post","put","patch"].indexOf(T.method)!==-1&&T.headers.setContentType("application/x-www-form-urlencoded",!1),function(k){for(var q,x,P=(k=De.isArray(k)?k:[k]).length,F=0;F<P&&(q=k[F],!(x=De.isString(q)?aa[q.toLowerCase()]:q));F++);if(!x)throw x===!1?new Dt("Adapter ".concat(q," is not supported by the environment"),"ERR_NOT_SUPPORT"):new Error(De.hasOwnProp(aa,q)?"Adapter '".concat(q,"' is not available in the build"):"Unknown adapter '".concat(q,"'"));if(!De.isFunction(x))throw new TypeError("adapter is not a function");return x}(T.adapter||gn.adapter)(T).then(function(k){return cs(T),k.data=kr.call(T,T.transformResponse,k),k.headers=bi.from(k.headers),k},function(k){return Ia(k)||(cs(T),k&&k.response&&(k.response.data=kr.call(T,T.transformResponse,k.response),k.response.headers=bi.from(k.response.headers))),Promise.reject(k)})}var xo=function(T){return T instanceof bi?T.toJSON():T};function hs(T,k){k=k||{};var q={};function x(Ve,Ke,vt){return De.isPlainObject(Ve)&&De.isPlainObject(Ke)?De.merge.call({caseless:vt},Ve,Ke):De.isPlainObject(Ke)?De.merge({},Ke):De.isArray(Ke)?Ke.slice():Ke}function P(Ve,Ke,vt){return De.isUndefined(Ke)?De.isUndefined(Ve)?void 0:x(void 0,Ve,vt):x(Ve,Ke,vt)}function F(Ve,Ke){if(!De.isUndefined(Ke))return x(void 0,Ke)}function Q(Ve,Ke){return De.isUndefined(Ke)?De.isUndefined(Ve)?void 0:x(void 0,Ve):x(void 0,Ke)}function pe(Ve,Ke,vt){return vt in k?x(Ve,Ke):vt in T?x(void 0,Ve):void 0}var ge={url:F,method:F,data:F,baseURL:Q,transformRequest:Q,transformResponse:Q,paramsSerializer:Q,timeout:Q,timeoutMessage:Q,withCredentials:Q,adapter:Q,responseType:Q,xsrfCookieName:Q,xsrfHeaderName:Q,onUploadProgress:Q,onDownloadProgress:Q,decompress:Q,maxContentLength:Q,maxBodyLength:Q,beforeRedirect:Q,transport:Q,httpAgent:Q,httpsAgent:Q,cancelToken:Q,socketPath:Q,responseEncoding:Q,validateStatus:pe,headers:function(Ve,Ke){return P(xo(Ve),xo(Ke),!0)}};return De.forEach(Object.keys(T).concat(Object.keys(k)),function(Ve){var Ke=ge[Ve]||P,vt=Ke(T[Ve],k[Ve],Ve);De.isUndefined(vt)&&Ke!==pe||(q[Ve]=vt)}),q}function Ir(T){return Ir=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},Ir(T)}var oa={};["object","boolean","number","function","string","symbol"].forEach(function(T,k){oa[T]=function(q){return Ir(q)===T||"a"+(k<1?"n ":" ")+T}});var Eo={};oa.transitional=function(T,k,q){function x(P,F){return"[Axios v1.2.3] Transitional option '"+P+"'"+F+(q?". "+q:"")}return function(P,F,Q){if(T===!1)throw new Dt(x(F," has been removed"+(k?" in "+k:"")),Dt.ERR_DEPRECATED);return k&&!Eo[F]&&(Eo[F]=!0,console.warn(x(F," has been deprecated since v"+k+" and will be removed in the near future"))),!T||T(P,F,Q)}};const la={assertOptions:function(T,k,q){if(Ir(T)!=="object")throw new Dt("options must be an object",Dt.ERR_BAD_OPTION_VALUE);for(var x=Object.keys(T),P=x.length;P-- >0;){var F=x[P],Q=k[F];if(Q){var pe=T[F],ge=pe===void 0||Q(pe,F,T);if(ge!==!0)throw new Dt("option "+F+" must be "+ge,Dt.ERR_BAD_OPTION_VALUE)}else if(q!==!0)throw new Dt("Unknown option "+F,Dt.ERR_BAD_OPTION)}},validators:oa};function fs(T){return fs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},fs(T)}function Dl(T,k){for(var q=0;q<k.length;q++){var x=k[q];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(T,(P=function(F,Q){if(fs(F)!=="object"||F===null)return F;var pe=F[Symbol.toPrimitive];if(pe!==void 0){var ge=pe.call(F,"string");if(fs(ge)!=="object")return ge;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(x.key),fs(P)==="symbol"?P:String(P)),x)}var P}var pr=la.validators,wi=function(){function T(x){(function(P,F){if(!(P instanceof F))throw new TypeError("Cannot call a class as a function")})(this,T),this.defaults=x,this.interceptors={request:new Jn,response:new Jn}}var k,q;return k=T,(q=[{key:"request",value:function(x,P){typeof x=="string"?(P=P||{}).url=x:P=x||{};var F,Q=P=hs(this.defaults,P),pe=Q.transitional,ge=Q.paramsSerializer,Ve=Q.headers;pe!==void 0&&la.assertOptions(pe,{silentJSONParsing:pr.transitional(pr.boolean),forcedJSONParsing:pr.transitional(pr.boolean),clarifyTimeoutError:pr.transitional(pr.boolean)},!1),ge!==void 0&&la.assertOptions(ge,{encode:pr.function,serialize:pr.function},!0),P.method=(P.method||this.defaults.method||"get").toLowerCase(),(F=Ve&&De.merge(Ve.common,Ve[P.method]))&&De.forEach(["delete","get","head","post","put","patch","common"],function(gi){delete Ve[gi]}),P.headers=bi.concat(F,Ve);var Ke=[],vt=!0;this.interceptors.request.forEach(function(gi){typeof gi.runWhen=="function"&&gi.runWhen(P)===!1||(vt=vt&&gi.synchronous,Ke.unshift(gi.fulfilled,gi.rejected))});var bt,Ot=[];this.interceptors.response.forEach(function(gi){Ot.push(gi.fulfilled,gi.rejected)});var Tt,At=0;if(!vt){var Ft=[Os.bind(this),void 0];for(Ft.unshift.apply(Ft,Ke),Ft.push.apply(Ft,Ot),Tt=Ft.length,bt=Promise.resolve(P);At<Tt;)bt=bt.then(Ft[At++],Ft[At++]);return bt}Tt=Ke.length;var Jt=P;for(At=0;At<Tt;){var Ki=Ke[At++],ji=Ke[At++];try{Jt=Ki(Jt)}catch(gi){ji.call(this,gi);break}}try{bt=Os.call(this,Jt)}catch(gi){return Promise.reject(gi)}for(At=0,Tt=Ot.length;At<Tt;)bt=bt.then(Ot[At++],Ot[At++]);return bt}},{key:"getUri",value:function(x){return cr(_o((x=hs(this.defaults,x)).baseURL,x.url),x.params,x.paramsSerializer)}}])&&Dl(k.prototype,q),Object.defineProperty(k,"prototype",{writable:!1}),T}();De.forEach(["delete","get","head","options"],function(T){wi.prototype[T]=function(k,q){return this.request(hs(q||{},{method:T,url:k,data:(q||{}).data}))}}),De.forEach(["post","put","patch"],function(T){function k(q){return function(x,P,F){return this.request(hs(F||{},{method:T,headers:q?{"Content-Type":"multipart/form-data"}:{},url:x,data:P}))}}wi.prototype[T]=k(),wi.prototype[T+"Form"]=k(!0)});const dn=wi;function ps(T){return ps=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},ps(T)}function Rr(T,k){for(var q=0;q<k.length;q++){var x=k[q];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(T,(P=function(F,Q){if(ps(F)!=="object"||F===null)return F;var pe=F[Symbol.toPrimitive];if(pe!==void 0){var ge=pe.call(F,"string");if(ps(ge)!=="object")return ge;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(x.key),ps(P)==="symbol"?P:String(P)),x)}var P}var kl=function(){function T(P){if(function(pe,ge){if(!(pe instanceof ge))throw new TypeError("Cannot call a class as a function")}(this,T),typeof P!="function")throw new TypeError("executor must be a function.");var F;this.promise=new Promise(function(pe){F=pe});var Q=this;this.promise.then(function(pe){if(Q._listeners){for(var ge=Q._listeners.length;ge-- >0;)Q._listeners[ge](pe);Q._listeners=null}}),this.promise.then=function(pe){var ge,Ve=new Promise(function(Ke){Q.subscribe(Ke),ge=Ke}).then(pe);return Ve.cancel=function(){Q.unsubscribe(ge)},Ve},P(function(pe,ge,Ve){Q.reason||(Q.reason=new fr(pe,ge,Ve),F(Q.reason))})}var k,q,x;return k=T,q=[{key:"throwIfRequested",value:function(){if(this.reason)throw this.reason}},{key:"subscribe",value:function(P){this.reason?P(this.reason):this._listeners?this._listeners.push(P):this._listeners=[P]}},{key:"unsubscribe",value:function(P){if(this._listeners){var F=this._listeners.indexOf(P);F!==-1&&this._listeners.splice(F,1)}}}],x=[{key:"source",value:function(){var P;return{token:new T(function(F){P=F}),cancel:P}}}],q&&Rr(k.prototype,q),x&&Rr(k,x),Object.defineProperty(k,"prototype",{writable:!1}),T}();const Oa=kl;function Yi(T,k){(k==null||k>T.length)&&(k=T.length);for(var q=0,x=new Array(k);q<k;q++)x[q]=T[q];return x}var ua={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ua).forEach(function(T){var k,q,x=(q=2,function(Q){if(Array.isArray(Q))return Q}(k=T)||function(Q,pe){var ge=Q==null?null:typeof Symbol!="undefined"&&Q[Symbol.iterator]||Q["@@iterator"];if(ge!=null){var Ve,Ke,vt,bt,Ot=[],Tt=!0,At=!1;try{if(vt=(ge=ge.call(Q)).next,pe===0){if(Object(ge)!==ge)return;Tt=!1}else for(;!(Tt=(Ve=vt.call(ge)).done)&&(Ot.push(Ve.value),Ot.length!==pe);Tt=!0);}catch(Ft){At=!0,Ke=Ft}finally{try{if(!Tt&&ge.return!=null&&(bt=ge.return(),Object(bt)!==bt))return}finally{if(At)throw Ke}}return Ot}}(k,q)||function(Q,pe){if(Q){if(typeof Q=="string")return Yi(Q,pe);var ge=Object.prototype.toString.call(Q).slice(8,-1);return ge==="Object"&&Q.constructor&&(ge=Q.constructor.name),ge==="Map"||ge==="Set"?Array.from(Q):ge==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ge)?Yi(Q,pe):void 0}}(k,q)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()),P=x[0],F=x[1];ua[F]=P});const Bs=ua;var qi=function T(k){var q=new dn(k),x=$e(dn.prototype.request,q);return De.extend(x,dn.prototype,q,{allOwnKeys:!0}),De.extend(x,q,null,{allOwnKeys:!0}),x.create=function(P){return T(hs(k,P))},x}(gn);qi.Axios=dn,qi.CanceledError=fr,qi.CancelToken=Oa,qi.isCancel=Ia,qi.VERSION="1.2.3",qi.toFormData=ur,qi.AxiosError=Dt,qi.Cancel=qi.CanceledError,qi.all=function(T){return Promise.all(T)},qi.spread=function(T){return function(k){return T.apply(null,k)}},qi.isAxiosError=function(T){return De.isObject(T)&&T.isAxiosError===!0},qi.mergeConfig=hs,qi.AxiosHeaders=bi,qi.formToJSON=function(T){return Si(De.isHTMLForm(T)?new FormData(T):T)},qi.HttpStatusCode=Bs,qi.default=qi;const di=qi,Wt={send:function(T){di.post(T.url,T.data).then(function(k){var q=k.data;q&&q.code===0?T.success&&T.success(q):T.error&&T.error(q&&q.msg)}).catch(function(k){console.error(k),T.error&&T.error()})},read:function(T){di.get(T.url).then(function(k){var q=k.data;q&&q.code===0?T.success&&T.success(q.data.map(function(x){return{time:x[0],type:x[1],color:x[2],author:x[3],text:x[4]}})):T.error&&T.error(q&&q.msg)}).catch(function(k){console.error(k),T.error&&T.error()})}};function da(T){return da=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},da(T)}function Ba(T){var k=this;this.lang=T,this.fallbackLang=this.lang.includes("-")?this.lang.split("-")[0]:this.lang,this.tran=function(q){return q=q.toLowerCase(),Wr[k.lang]&&Wr[k.lang][q]?Wr[k.lang][q]:Wr[k.fallbackLang]&&Wr[k.fallbackLang][q]?Wr[k.fallbackLang][q]:Ma[q]?Ma[q]:q}}var Ma={"danmaku-loading":"Danmaku is loading",top:"Top",bottom:"Bottom",rolling:"Rolling","input-danmaku-enter":"Input danmaku, hit Enter","about-author":"About author","dplayer-feedback":"DPlayer feedback","about-dplayer":"About DPlayer",loop:"Loop",speed:"Speed","opacity-danmaku":"Opacity for danmaku",normal:"Normal","please-input-danmaku":"Please input danmaku content!","set-danmaku-color":"Set danmaku color","set-danmaku-type":"Set danmaku type","show-danmaku":"Show danmaku","video-failed":"Video load failed","danmaku-failed":"Danmaku load failed","danmaku-send-failed":"Danmaku send failed","switching-quality":"Switching to %q quality","switched-quality":"Switched to %q quality",ff:"FF %s s",rew:"REW %s s","unlimited-danmaku":"Unlimited danmaku","send-danmaku":"Send danmaku",setting:"Setting",fullscreen:"Full screen","web-fullscreen":"Web full screen",send:"Send",screenshot:"Screenshot",airplay:"AirPlay",chromecast:"ChromeCast",subtitle:"Subtitle",off:"Off","show-subs":"Show subtitle","hide-subs":"Hide subtitle",volume:"Volume",live:"Live","video-info":"Video info"},Wr={en:Ma,"zh-cn":{"danmaku-loading":"\u5F39\u5E55\u52A0\u8F7D\u4E2D",top:"\u9876\u90E8",bottom:"\u5E95\u90E8",rolling:"\u6EDA\u52A8","input-danmaku-enter":"\u8F93\u5165\u5F39\u5E55\uFF0C\u56DE\u8F66\u53D1\u9001","about-author":"\u5173\u4E8E\u4F5C\u8005","dplayer-feedback":"\u64AD\u653E\u5668\u610F\u89C1\u53CD\u9988","about-dplayer":"\u5173\u4E8E DPlayer \u64AD\u653E\u5668",loop:"\u6D17\u8111\u5FAA\u73AF",speed:"\u901F\u5EA6","opacity-danmaku":"\u5F39\u5E55\u900F\u660E\u5EA6",normal:"\u6B63\u5E38","please-input-danmaku":"\u8981\u8F93\u5165\u5F39\u5E55\u5185\u5BB9\u554A\u5582\uFF01","set-danmaku-color":"\u8BBE\u7F6E\u5F39\u5E55\u989C\u8272","set-danmaku-type":"\u8BBE\u7F6E\u5F39\u5E55\u7C7B\u578B","show-danmaku":"\u663E\u793A\u5F39\u5E55","video-failed":"\u89C6\u9891\u52A0\u8F7D\u5931\u8D25","danmaku-failed":"\u5F39\u5E55\u52A0\u8F7D\u5931\u8D25","danmaku-send-failed":"\u5F39\u5E55\u53D1\u9001\u5931\u8D25","switching-quality":"\u6B63\u5728\u5207\u6362\u81F3 %q \u753B\u8D28","switched-quality":"\u5DF2\u7ECF\u5207\u6362\u81F3 %q \u753B\u8D28",ff:"\u5FEB\u8FDB %s \u79D2",rew:"\u5FEB\u9000 %s \u79D2","unlimited-danmaku":"\u6D77\u91CF\u5F39\u5E55","send-danmaku":"\u53D1\u9001\u5F39\u5E55",setting:"\u8BBE\u7F6E",fullscreen:"\u5168\u5C4F","web-fullscreen":"\u9875\u9762\u5168\u5C4F",send:"\u53D1\u9001",screenshot:"\u622A\u56FE",airplay:"\u65E0\u7EBF\u6295\u5C4F",chromecast:"ChromeCast",subtitle:"\u5B57\u5E55",off:"\u5173\u95ED","show-subs":"\u663E\u793A\u5B57\u5E55","hide-subs":"\u9690\u85CF\u5B57\u5E55",volume:"\u97F3\u91CF",live:"\u76F4\u64AD","video-info":"\u89C6\u9891\u7EDF\u8BA1\u4FE1\u606F"},"zh-tw":{"danmaku-loading":"\u5F48\u5E55\u8F09\u5165\u4E2D",top:"\u9802\u90E8",bottom:"\u5E95\u90E8",rolling:"\u6EFE\u52D5","input-danmaku-enter":"\u8F38\u5165\u5F48\u5E55\uFF0CEnter \u767C\u9001","about-author":"\u95DC\u65BC\u4F5C\u8005","dplayer-feedback":"\u64AD\u653E\u5668\u610F\u898B\u56DE\u994B","about-dplayer":"\u95DC\u65BC DPlayer \u64AD\u653E\u5668",loop:"\u5FAA\u74B0\u64AD\u653E",speed:"\u901F\u5EA6","opacity-danmaku":"\u5F48\u5E55\u900F\u660E\u5EA6",normal:"\u6B63\u5E38","please-input-danmaku":"\u8ACB\u8F38\u5165\u5F48\u5E55\u5167\u5BB9\u554A\uFF01","set-danmaku-color":"\u8A2D\u5B9A\u5F48\u5E55\u984F\u8272","set-danmaku-type":"\u8A2D\u5B9A\u5F48\u5E55\u985E\u578B","show-danmaku":"\u986F\u793A\u5F48\u5E55","video-failed":"\u5F71\u7247\u8F09\u5165\u5931\u6557","danmaku-failed":"\u5F48\u5E55\u8F09\u5165\u5931\u6557","danmaku-send-failed":"\u5F48\u5E55\u767C\u9001\u5931\u6557","switching-quality":"\u6B63\u5728\u5207\u63DB\u81F3 %q \u756B\u8CEA","switched-quality":"\u5DF2\u7D93\u5207\u63DB\u81F3 %q \u756B\u8CEA",ff:"\u5FEB\u9032 %s \u79D2",rew:"\u5FEB\u9000 %s \u79D2","unlimited-danmaku":"\u5DE8\u91CF\u5F48\u5E55","send-danmaku":"\u767C\u9001\u5F48\u5E55",setting:"\u8A2D\u5B9A",fullscreen:"\u5168\u87A2\u5E55","web-fullscreen":"\u9801\u9762\u5168\u87A2\u5E55",send:"\u767C\u9001",screenshot:"\u622A\u5716",airplay:"\u7121\u7DDA\u6295\u5C4F",chromecast:"ChromeCast",subtitle:"\u5B57\u5E55",off:"\u95DC\u9589","show-subs":"\u986F\u793A\u5B57\u5E55","hide-subs":"\u96B1\u85CF\u5B57\u5E55",volume:"\u97F3\u91CF",live:"\u76F4\u64AD","video-info":"\u5F71\u7247\u7D71\u8A08\u8A0A\u606F"},"ko-kr":{"danmaku-loading":"Danmaku\uB97C \uBD88\uB7EC\uC624\uB294 \uC911\uC785\uB2C8\uB2E4.",top:"Top",bottom:"Bottom",rolling:"Rolling","input-danmaku-enter":"Danmaku\uB97C \uC785\uB825\uD558\uACE0 Enter\uB97C \uB204\uB974\uC138\uC694.","about-author":"\uB9CC\uB4E0\uC774","dplayer-feedback":"\uD53C\uB4DC\uBC31 \uBCF4\uB0B4\uAE30","about-dplayer":"DPlayer \uC815\uBCF4",loop:"\uBC18\uBCF5",speed:"\uBC30\uC18D","opacity-danmaku":"Danmaku \uBD88\uD22C\uBA85\uB3C4",normal:"\uD45C\uC900","please-input-danmaku":"Danmaku\uB97C \uC785\uB825\uD558\uC138\uC694!","set-danmaku-color":"Danmaku \uC0C9\uC0C1","set-danmaku-type":"Danmaku \uC124\uC815","show-danmaku":"Danmaku \uD45C\uC2DC","video-failed":"\uBE44\uB514\uC624\uB97C \uBD88\uB7EC\uC624\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4.","danmaku-failed":"Danmaku\uB97C \uBD88\uB7EC\uC624\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4.","danmaku-send-failed":"Danmaku \uC804\uC1A1\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.","Switching to":"","Switched to":"","switching-quality":"\uC804\uD658 %q \uD654\uC9C8","switched-quality":"\uC804\uD658 \uB428 %q \uD654\uC9C8",ff:"\uC55E\uC73C\uB85C %s \uCD08",rew:"\uB4A4\uB85C %s \uCD08","unlimited-danmaku":"\uB05D\uC5C6\uB294 Danmaku","send-danmaku":"Danmaku \uBCF4\uB0B4\uAE30",setting:"\uC124\uC815",fullscreen:"\uC804\uCCB4 \uD654\uBA74","web-fullscreen":"\uC6F9 \uB0B4 \uC804\uCCB4\uD654\uBA74",send:"\uBCF4\uB0B4\uAE30",screenshot:"\uD654\uBA74 \uCEA1\uCCD0",airplay:"\uC5D0\uC5B4\uD50C\uB808\uC774",chromecast:"ChromeCast",subtitle:"\uBD80\uC81C",off:"\uB044\uB2E4","show-subs":"\uC790\uB9C9 \uBCF4\uC774\uAE30","hide-subs":"\uC790\uB9C9 \uC228\uAE30\uAE30",Volume:"\uBCFC\uB968",live:"\uC0DD\uBC29\uC1A1","video-info":"\uBE44\uB514\uC624 \uC815\uBCF4"},de:{"danmaku-loading":"Danmaku l\xE4dt...",top:"Oben",bottom:"Unten",rolling:"Rollend","input-danmaku-enter":"Dr\xFCcke Enter nach dem Einf\xFCgen vom Danmaku","about-author":"\xDCber den Autor","dplayer-feedback":"DPlayer Feedback","about-dplayer":"\xDCber DPlayer",loop:"Wiederholen",speed:"Geschwindigkeit","opacity-danmaku":"Transparenz f\xFCr Danmaku",normal:"Normal","please-input-danmaku":"Bitte Danmaku Inhalt eingeben!","set-danmaku-color":"Danmaku Farbe festlegen","set-danmaku-type":"Danmaku Typ festlegen","show-danmaku":"Zeige Danmaku","video-failed":"Das Video konnte nicht geladen werden","danmaku-failed":"Danmaku konnte nicht geladen werden","danmaku-send-failed":"Das senden von Danmaku ist fehgeschlagen","switching-quality":"Wechsle zur %q Qualit\xE4t","switched-quality":"Zur %q Qualit\xE4t gewechselt",ff:"%s s Vorw\xE4rts",rew:"%s s Zur\xFCck","unlimited-danmaku":"Unlimitiertes Danmaku","send-danmaku":"Sende Danmaku",setting:"Einstellungen",fullscreen:"Vollbild","web-fullscreen":"Browser Vollbild",send:"Senden",screenshot:"Screenshot",airplay:"AirPlay","show-subs":"Zeige Untertitel",chromecast:"ChromeCast",subtitle:"Untertitel",off:"Schlie\xDFung","hide-subs":"Verstecke Untertitel",volume:"Lautst\xE4rke",live:"Live","video-info":"Video Info"}},To=Ee(730),ms=Ee.n(To),Fa=Ee(74),So=Ee.n(Fa),Il=Ee(437),Na=Ee.n(Il),$n=Ee(644),Rl=Ee.n($n),Ua=Ee(324),Co=Ee.n(Ua),ca=Ee(574),ja=Ee.n(ca),Ms=Ee(300),ed=Ee.n(Ms),td=Ee(934),wo=Ee.n(td),id=Ee(428),$a=Ee.n(id),nd=Ee(807),zr=Ee.n(nd),Pl=Ee(338),ha=Ee.n(Pl),Pr=Ee(254),An=Ee.n(Pr),Or=Ee(965),gs=Ee.n(Or),Ol=Ee(113),Bl=Ee.n(Ol),rd=Ee(251),sd=Ee.n(rd),Ri=Ee(410),Fs=Ee.n(Ri),Ml=Ee(182),Yr=Ee.n(Ml),Va=Ee(193),Lo=Ee.n(Va);const Rn={play:ms(),pause:So(),volumeUp:Na(),volumeDown:Rl(),volumeOff:Co(),full:ja(),fullWeb:ed(),setting:wo(),right:$a(),comment:zr(),commentOff:ha(),send:An(),pallette:gs(),camera:Bl(),subtitle:Fs(),loading:Yr(),airplay:sd(),chromecast:Lo()};var Pi=Ee(916),Do=Ee.n(Pi);function Xr(T){return Xr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},Xr(T)}function Ga(T,k){for(var q=0;q<k.length;q++){var x=k[q];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(T,(P=function(F,Q){if(Xr(F)!=="object"||F===null)return F;var pe=F[Symbol.toPrimitive];if(pe!==void 0){var ge=pe.call(F,"string");if(Xr(ge)!=="object")return ge;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(x.key),Xr(P)==="symbol"?P:String(P)),x)}var P}var Ha=function(){function T(P){(function(F,Q){if(!(F instanceof Q))throw new TypeError("Cannot call a class as a function")})(this,T),this.container=P.container,this.options=P.options,this.index=P.index,this.tran=P.tran,this.init()}var k,q,x;return k=T,x=[{key:"NewNotice",value:function(P,F,Q){var pe=document.createElement("div");return pe.classList.add("dplayer-notice"),pe.style.opacity=F,pe.innerText=P,Q&&(pe.id="dplayer-notice-".concat(Q)),pe}}],(q=[{key:"init",value:function(){this.container.innerHTML=Do()({options:this.options,index:this.index,tran:this.tran,icons:Rn,mobile:Ie.isMobile,video:{current:!0,pic:this.options.video.pic,screenshot:this.options.screenshot,airplay:!(!Ie.isSafari||Ie.isChrome)&&this.options.airplay,chromecast:this.options.chromecast,preload:this.options.preload,url:this.options.video.url,subtitle:this.options.subtitle}}),this.volumeBar=this.container.querySelector(".dplayer-volume-bar-inner"),this.volumeBarWrap=this.container.querySelector(".dplayer-volume-bar"),this.volumeBarWrapWrap=this.container.querySelector(".dplayer-volume-bar-wrap"),this.volumeButton=this.container.querySelector(".dplayer-volume"),this.volumeButtonIcon=this.container.querySelector(".dplayer-volume-icon"),this.volumeIcon=this.container.querySelector(".dplayer-volume-icon .dplayer-icon-content"),this.playedBar=this.container.querySelector(".dplayer-played"),this.loadedBar=this.container.querySelector(".dplayer-loaded"),this.playedBarWrap=this.container.querySelector(".dplayer-bar-wrap"),this.playedBarTime=this.container.querySelector(".dplayer-bar-time"),this.danmaku=this.container.querySelector(".dplayer-danmaku"),this.danmakuLoading=this.container.querySelector(".dplayer-danloading"),this.video=this.container.querySelector(".dplayer-video-current"),this.bezel=this.container.querySelector(".dplayer-bezel-icon"),this.playButton=this.container.querySelector(".dplayer-play-icon"),this.mobilePlayButton=this.container.querySelector(".dplayer-mobile-play"),this.videoWrap=this.container.querySelector(".dplayer-video-wrap"),this.controllerMask=this.container.querySelector(".dplayer-controller-mask"),this.ptime=this.container.querySelector(".dplayer-ptime"),this.settingButton=this.container.querySelector(".dplayer-setting-icon"),this.settingBox=this.container.querySelector(".dplayer-setting-box"),this.mask=this.container.querySelector(".dplayer-mask"),this.loop=this.container.querySelector(".dplayer-setting-loop"),this.loopToggle=this.container.querySelector(".dplayer-setting-loop .dplayer-toggle-setting-input"),this.showDanmaku=this.container.querySelector(".dplayer-setting-showdan"),this.showDanmakuToggle=this.container.querySelector(".dplayer-showdan-setting-input"),this.unlimitDanmaku=this.container.querySelector(".dplayer-setting-danunlimit"),this.unlimitDanmakuToggle=this.container.querySelector(".dplayer-danunlimit-setting-input"),this.speed=this.container.querySelector(".dplayer-setting-speed"),this.speedItem=this.container.querySelectorAll(".dplayer-setting-speed-item"),this.danmakuOpacityBar=this.container.querySelector(".dplayer-danmaku-bar-inner"),this.danmakuOpacityBarWrap=this.container.querySelector(".dplayer-danmaku-bar"),this.danmakuOpacityBarWrapWrap=this.container.querySelector(".dplayer-danmaku-bar-wrap"),this.danmakuOpacityBox=this.container.querySelector(".dplayer-setting-danmaku"),this.dtime=this.container.querySelector(".dplayer-dtime"),this.controller=this.container.querySelector(".dplayer-controller"),this.commentInput=this.container.querySelector(".dplayer-comment-input"),this.commentButton=this.container.querySelector(".dplayer-comment-icon"),this.commentSettingBox=this.container.querySelector(".dplayer-comment-setting-box"),this.commentSettingButton=this.container.querySelector(".dplayer-comment-setting-icon"),this.commentSettingFill=this.container.querySelector(".dplayer-comment-setting-icon path"),this.commentSendButton=this.container.querySelector(".dplayer-send-icon"),this.commentSendFill=this.container.querySelector(".dplayer-send-icon path"),this.commentColorSettingBox=this.container.querySelector(".dplayer-comment-setting-color"),this.browserFullButton=this.container.querySelector(".dplayer-full-icon"),this.webFullButton=this.container.querySelector(".dplayer-full-in-icon"),this.menu=this.container.querySelector(".dplayer-menu"),this.menuItem=this.container.querySelectorAll(".dplayer-menu-item"),this.qualityList=this.container.querySelector(".dplayer-quality-list"),this.camareButton=this.container.querySelector(".dplayer-camera-icon"),this.airplayButton=this.container.querySelector(".dplayer-airplay-icon"),this.chromecastButton=this.container.querySelector(".dplayer-chromecast-icon"),this.subtitleButton=this.container.querySelector(".dplayer-subtitle-icon"),this.subtitleButtonInner=this.container.querySelector(".dplayer-subtitle-icon .dplayer-icon-content"),this.subtitlesButton=this.container.querySelector(".dplayer-subtitles-icon"),this.subtitlesBox=this.container.querySelector(".dplayer-subtitles-box"),this.subtitlesItem=this.container.querySelectorAll(".dplayer-subtitles-item"),this.subtitle=this.container.querySelector(".dplayer-subtitle"),this.subtrack=this.container.querySelector(".dplayer-subtrack"),this.qualityButton=this.container.querySelector(".dplayer-quality-icon"),this.barPreview=this.container.querySelector(".dplayer-bar-preview"),this.barWrap=this.container.querySelector(".dplayer-bar-wrap"),this.noticeList=this.container.querySelector(".dplayer-notice-list"),this.infoPanel=this.container.querySelector(".dplayer-info-panel"),this.infoPanelClose=this.container.querySelector(".dplayer-info-panel-close"),this.infoVersion=this.container.querySelector(".dplayer-info-panel-item-version .dplayer-info-panel-item-data"),this.infoFPS=this.container.querySelector(".dplayer-info-panel-item-fps .dplayer-info-panel-item-data"),this.infoType=this.container.querySelector(".dplayer-info-panel-item-type .dplayer-info-panel-item-data"),this.infoUrl=this.container.querySelector(".dplayer-info-panel-item-url .dplayer-info-panel-item-data"),this.infoResolution=this.container.querySelector(".dplayer-info-panel-item-resolution .dplayer-info-panel-item-data"),this.infoDuration=this.container.querySelector(".dplayer-info-panel-item-duration .dplayer-info-panel-item-data"),this.infoDanmakuId=this.container.querySelector(".dplayer-info-panel-item-danmaku-id .dplayer-info-panel-item-data"),this.infoDanmakuApi=this.container.querySelector(".dplayer-info-panel-item-danmaku-api .dplayer-info-panel-item-data"),this.infoDanmakuAmount=this.container.querySelector(".dplayer-info-panel-item-danmaku-amount .dplayer-info-panel-item-data")}}])&&Ga(k.prototype,q),x&&Ga(k,x),Object.defineProperty(k,"prototype",{writable:!1}),T}();const ko=Ha;function Qr(T){return Qr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},Qr(T)}function Fl(T,k){for(var q=0;q<k.length;q++){var x=k[q];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(T,(P=function(F,Q){if(Qr(F)!=="object"||F===null)return F;var pe=F[Symbol.toPrimitive];if(pe!==void 0){var ge=pe.call(F,"string");if(Qr(ge)!=="object")return ge;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(x.key),Qr(P)==="symbol"?P:String(P)),x)}var P}var fa=function(){function T(x){(function(P,F){if(!(P instanceof F))throw new TypeError("Cannot call a class as a function")})(this,T),this.options=x,this.player=this.options.player,this.container=this.options.container,this.danTunnel={right:{},top:{},bottom:{}},this.danIndex=0,this.dan=[],this.showing=!0,this._opacity=this.options.opacity,this.events=this.options.events,this.unlimited=this.options.unlimited,this._measure(""),this.load()}var k,q;return k=T,q=[{key:"load",value:function(){var x,P=this;x=this.options.api.maximum?"".concat(this.options.api.address,"v3/?id=").concat(this.options.api.id,"&max=").concat(this.options.api.maximum):"".concat(this.options.api.address,"v3/?id=").concat(this.options.api.id);var F=(this.options.api.addition||[]).slice(0);F.push(x),this.events&&this.events.trigger("danmaku_load_start",F),this._readAllEndpoints(F,function(Q){P.dan=[].concat.apply([],Q).sort(function(pe,ge){return pe.time-ge.time}),window.requestAnimationFrame(function(){P.frame()}),P.options.callback(),P.events&&P.events.trigger("danmaku_load_end")})}},{key:"reload",value:function(x){this.options.api=x,this.dan=[],this.clear(),this.load()}},{key:"_readAllEndpoints",value:function(x,P){for(var F=this,Q=[],pe=0,ge=function(Ke){F.options.apiBackend.read({url:x[Ke],success:function(vt){Q[Ke]=vt,++pe===x.length&&P(Q)},error:function(vt){F.options.error(vt||F.options.tran("danmaku-failed")),Q[Ke]=[],++pe===x.length&&P(Q)}})},Ve=0;Ve<x.length;++Ve)ge(Ve)}},{key:"send",value:function(x,P){var F=this,Q={token:this.options.api.token,id:this.options.api.id,author:this.options.api.user,time:this.options.time(),text:x.text,color:x.color,type:x.type};this.options.apiBackend.send({url:this.options.api.address+"v3/",data:Q,success:P,error:function(ge){F.options.error(ge||F.options.tran("danmaku-failed"))}}),this.dan.splice(this.danIndex,0,Q),this.danIndex++;var pe={text:this.htmlEncode(Q.text),color:Q.color,type:Q.type,border:"2px solid ".concat(this.options.borderColor)};this.draw(pe),this.events&&this.events.trigger("danmaku_send",Q)}},{key:"frame",value:function(){var x=this;if(this.dan.length&&!this.paused&&this.showing){for(var P=this.dan[this.danIndex],F=[];P&&this.options.time()>parseFloat(P.time);)F.push(P),P=this.dan[++this.danIndex];this.draw(F)}window.requestAnimationFrame(function(){x.frame()})}},{key:"opacity",value:function(x){if(x!==void 0){for(var P=this.container.getElementsByClassName("dplayer-danmaku-item"),F=0;F<P.length;F++)P[F].style.opacity=x;this._opacity=x,this.events&&this.events.trigger("danmaku_opacity",this._opacity)}return this._opacity}},{key:"draw",value:function(x){var P=this;if(this.showing){var F=this.options.height,Q=this.container.offsetWidth,pe=this.container.offsetHeight,ge=parseInt(pe/F),Ve=function(At){var Ft=At.offsetWidth||parseInt(At.style.width),Jt=At.getBoundingClientRect().right||P.container.getBoundingClientRect().right+Ft;return P.container.getBoundingClientRect().right-Jt},Ke=function(At){return(Q+At)/5},vt=function(At,Ft,Jt){for(var Ki=Q/Ke(Jt),ji=function(Wi){var qs=P.danTunnel[Ft][Wi+""];if(!qs||!qs.length)return P.danTunnel[Ft][Wi+""]=[At],At.addEventListener("animationend",function(){P.danTunnel[Ft][Wi+""].splice(0,1)}),{v:Wi%ge};if(Ft!=="right")return"continue";for(var Ks=0;Ks<qs.length;Ks++){var xi=Ve(qs[Ks])-10;if(xi<=Q-Ki*Ke(parseInt(qs[Ks].style.width))||xi<=0)break;if(Ks===qs.length-1)return P.danTunnel[Ft][Wi+""].push(At),At.addEventListener("animationend",function(){P.danTunnel[Ft][Wi+""].splice(0,1)}),{v:Wi%ge}}},gi=0;P.unlimited||gi<ge;gi++){var br=ji(gi);if(br!=="continue"&&Qr(br)==="object")return br.v}return-1};Object.prototype.toString.call(x)!=="[object Array]"&&(x=[x]);for(var bt=document.createDocumentFragment(),Ot=function(){x[Tt].type=Ie.number2Type(x[Tt].type),x[Tt].color||(x[Tt].color=16777215);var At=document.createElement("div");At.classList.add("dplayer-danmaku-item"),At.classList.add("dplayer-danmaku-".concat(x[Tt].type)),x[Tt].border?At.innerHTML='<span style="border:'.concat(x[Tt].border,'">').concat(x[Tt].text,"</span>"):At.innerHTML=x[Tt].text,At.style.opacity=P._opacity,At.style.color=Ie.number2Color(x[Tt].color),At.addEventListener("animationend",function(){P.container.removeChild(At)});var Ft,Jt=P._measure(x[Tt].text);switch(x[Tt].type){case"right":(Ft=vt(At,x[Tt].type,Jt))>=0&&(At.style.width=Jt+1+"px",At.style.top=F*Ft+"px",At.style.transform="translateX(-".concat(Q,"px)"));break;case"top":(Ft=vt(At,x[Tt].type))>=0&&(At.style.top=F*Ft+"px");break;case"bottom":(Ft=vt(At,x[Tt].type))>=0&&(At.style.bottom=F*Ft+"px");break;default:console.error("Can't handled danmaku type: ".concat(x[Tt].type))}Ft>=0&&(At.classList.add("dplayer-danmaku-move"),At.style.animationDuration=P._danAnimation(x[Tt].type),bt.appendChild(At))},Tt=0;Tt<x.length;Tt++)Ot();return this.container.appendChild(bt),bt}}},{key:"play",value:function(){this.paused=!1}},{key:"pause",value:function(){this.paused=!0}},{key:"_measure",value:function(x){if(!this.context){var P=getComputedStyle(this.container.getElementsByClassName("dplayer-danmaku-item")[0],null);this.context=document.createElement("canvas").getContext("2d"),this.context.font=P.getPropertyValue("font")}return this.context.measureText(x).width}},{key:"seek",value:function(){this.clear();for(var x=0;x<this.dan.length;x++){if(this.dan[x].time>=this.options.time()){this.danIndex=x;break}this.danIndex=this.dan.length}}},{key:"clear",value:function(){this.danTunnel={right:{},top:{},bottom:{}},this.danIndex=0,this.options.container.innerHTML="",this.events&&this.events.trigger("danmaku_clear")}},{key:"htmlEncode",value:function(x){return x.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2f;")}},{key:"resize",value:function(){for(var x=this.container.offsetWidth,P=this.container.getElementsByClassName("dplayer-danmaku-item"),F=0;F<P.length;F++)P[F].style.transform="translateX(-".concat(x,"px)")}},{key:"hide",value:function(){this.showing=!1,this.pause(),this.clear(),this.events&&this.events.trigger("danmaku_hide")}},{key:"show",value:function(){this.seek(),this.showing=!0,this.play(),this.events&&this.events.trigger("danmaku_show")}},{key:"unlimit",value:function(x){this.unlimited=x}},{key:"speed",value:function(x){this.options.api.speedRate=x}},{key:"_danAnimation",value:function(x){var P=this.options.api.speedRate||1,F=!!this.player.fullScreen.isFullScreen();return{top:"".concat((F?6:4)/P,"s"),right:"".concat((F?8:5)/P,"s"),bottom:"".concat((F?6:4)/P,"s")}[x]}}],q&&Fl(k.prototype,q),Object.defineProperty(k,"prototype",{writable:!1}),T}();const pa=fa;function Ns(T){return Ns=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},Ns(T)}function Nl(T,k){for(var q=0;q<k.length;q++){var x=k[q];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(T,(P=function(F,Q){if(Ns(F)!=="object"||F===null)return F;var pe=F[Symbol.toPrimitive];if(pe!==void 0){var ge=pe.call(F,"string");if(Ns(ge)!=="object")return ge;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(x.key),Ns(P)==="symbol"?P:String(P)),x)}var P}const pi=function(){function T(){(function(x,P){if(!(x instanceof P))throw new TypeError("Cannot call a class as a function")})(this,T),this.events={},this.videoEvents=["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","mozaudioavailable","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],this.playerEvents=["screenshot","thumbnails_show","thumbnails_hide","danmaku_show","danmaku_hide","danmaku_clear","danmaku_loaded","danmaku_send","danmaku_opacity","contextmenu_show","contextmenu_hide","notice_show","notice_hide","quality_start","quality_end","destroy","resize","fullscreen","fullscreen_cancel","webfullscreen","webfullscreen_cancel","subtitle_show","subtitle_hide","subtitle_change"]}var k,q;return k=T,(q=[{key:"on",value:function(x,P){this.type(x)&&typeof P=="function"&&(this.events[x]||(this.events[x]=[]),this.events[x].push(P))}},{key:"trigger",value:function(x,P){if(this.events[x]&&this.events[x].length)for(var F=0;F<this.events[x].length;F++)this.events[x][F](P)}},{key:"type",value:function(x){return this.playerEvents.indexOf(x)!==-1?"player":this.videoEvents.indexOf(x)!==-1?"video":(console.error("Unknown event name: ".concat(x)),null)}}])&&Nl(k.prototype,q),Object.defineProperty(k,"prototype",{writable:!1}),T}();function Qi(T){return Qi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},Qi(T)}function qa(T,k){for(var q=0;q<k.length;q++){var x=k[q];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(T,(P=function(F,Q){if(Qi(F)!=="object"||F===null)return F;var pe=F[Symbol.toPrimitive];if(pe!==void 0){var ge=pe.call(F,"string");if(Qi(ge)!=="object")return ge;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(x.key),Qi(P)==="symbol"?P:String(P)),x)}var P}var Ka=function(){function T(x){var P=this;(function(F,Q){if(!(F instanceof Q))throw new TypeError("Cannot call a class as a function")})(this,T),this.player=x,this.lastScrollPosition={left:0,top:0},this.player.events.on("webfullscreen",function(){P.player.resize()}),this.player.events.on("webfullscreen_cancel",function(){P.player.resize(),Ie.setScrollPosition(P.lastScrollPosition)}),this.fullscreenchange=function(){P.player.resize(),P.isFullScreen("browser")?P.player.events.trigger("fullscreen"):(Ie.setScrollPosition(P.lastScrollPosition),P.player.events.trigger("fullscreen_cancel"))},this.docfullscreenchange=function(){var F=document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;F&&F!==P.player.container||(P.player.resize(),F?P.player.events.trigger("fullscreen"):(Ie.setScrollPosition(P.lastScrollPosition),P.player.events.trigger("fullscreen_cancel")))},/Firefox/.test(navigator.userAgent)?(document.addEventListener("mozfullscreenchange",this.docfullscreenchange),document.addEventListener("fullscreenchange",this.docfullscreenchange)):(this.player.container.addEventListener("fullscreenchange",this.fullscreenchange),this.player.container.addEventListener("webkitfullscreenchange",this.fullscreenchange),document.addEventListener("msfullscreenchange",this.docfullscreenchange),document.addEventListener("MSFullscreenChange",this.docfullscreenchange))}var k,q;return k=T,q=[{key:"isFullScreen",value:function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"browser";switch(x){case"browser":return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;case"web":return this.player.container.classList.contains("dplayer-fulled")}}},{key:"request",value:function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"browser",P=x==="browser"?"web":"browser",F=this.isFullScreen(P);switch(F||(this.lastScrollPosition=Ie.getScrollPosition()),x){case"browser":this.player.container.requestFullscreen?this.player.container.requestFullscreen():this.player.container.mozRequestFullScreen?this.player.container.mozRequestFullScreen():this.player.container.webkitRequestFullscreen?this.player.container.webkitRequestFullscreen():this.player.video.webkitEnterFullscreen?this.player.video.webkitEnterFullscreen():this.player.video.webkitEnterFullScreen?this.player.video.webkitEnterFullScreen():this.player.container.msRequestFullscreen&&this.player.container.msRequestFullscreen();break;case"web":this.player.container.classList.add("dplayer-fulled"),document.body.classList.add("dplayer-web-fullscreen-fix"),this.player.events.trigger("webfullscreen")}F&&this.cancel(P)}},{key:"cancel",value:function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"browser";switch(x){case"browser":document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.webkitCancelFullscreen?document.webkitCancelFullscreen():document.msCancelFullScreen?document.msCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen();break;case"web":this.player.container.classList.remove("dplayer-fulled"),document.body.classList.remove("dplayer-web-fullscreen-fix"),this.player.events.trigger("webfullscreen_cancel")}}},{key:"toggle",value:function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"browser";this.isFullScreen(x)?this.cancel(x):this.request(x)}},{key:"destroy",value:function(){/Firefox/.test(navigator.userAgent)?(document.removeEventListener("mozfullscreenchange",this.docfullscreenchange),document.removeEventListener("fullscreenchange",this.docfullscreenchange)):(this.player.container.removeEventListener("fullscreenchange",this.fullscreenchange),this.player.container.removeEventListener("webkitfullscreenchange",this.fullscreenchange),document.removeEventListener("msfullscreenchange",this.docfullscreenchange),document.removeEventListener("MSFullscreenChange",this.docfullscreenchange))}}],q&&qa(k.prototype,q),Object.defineProperty(k,"prototype",{writable:!1}),T}();const Br=Ka;function Us(T){return Us=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},Us(T)}function Mr(T,k){for(var q=0;q<k.length;q++){var x=k[q];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(T,(P=function(F,Q){if(Us(F)!=="object"||F===null)return F;var pe=F[Symbol.toPrimitive];if(pe!==void 0){var ge=pe.call(F,"string");if(Us(ge)!=="object")return ge;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(x.key),Us(P)==="symbol"?P:String(P)),x)}var P}var ma=function(){function T(x){(function(P,F){if(!(P instanceof F))throw new TypeError("Cannot call a class as a function")})(this,T),this.storageName={opacity:"dplayer-danmaku-opacity",volume:"dplayer-volume",unlimited:"dplayer-danmaku-unlimited",danmaku:"dplayer-danmaku-show",subtitle:"dplayer-subtitle-show"},this.default={opacity:.7,volume:x.options.hasOwnProperty("volume")?x.options.volume:.7,unlimited:(x.options.danmaku&&x.options.danmaku.unlimited?1:0)||0,danmaku:1,subtitle:1},this.data={},this.init()}var k,q;return k=T,(q=[{key:"init",value:function(){for(var x in this.storageName){var P=this.storageName[x];this.data[x]=parseFloat(Ie.storage.get(P)||this.default[x])}}},{key:"get",value:function(x){return this.data[x]}},{key:"set",value:function(x,P){this.data[x]=P,Ie.storage.set(this.storageName[x],P)}}])&&Mr(k.prototype,q),Object.defineProperty(k,"prototype",{writable:!1}),T}();const mr=ma;function Pn(T){return Pn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},Pn(T)}function Ul(T,k){for(var q=0;q<k.length;q++){var x=k[q];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(T,(P=function(F,Q){if(Pn(F)!=="object"||F===null)return F;var pe=F[Symbol.toPrimitive];if(pe!==void 0){var ge=pe.call(F,"string");if(Pn(ge)!=="object")return ge;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(x.key),Pn(P)==="symbol"?P:String(P)),x)}var P}var Io=function(){function T(x,P,F,Q){(function(pe,ge){if(!(pe instanceof ge))throw new TypeError("Cannot call a class as a function")})(this,T),this.container=x,this.video=P,this.options=F,this.events=Q,this.init()}var k,q;return k=T,q=[{key:"init",value:function(){var x=this;if(this.container.style.fontSize=this.options.fontSize,this.container.style.bottom=this.options.bottom,this.container.style.color=this.options.color,this.video.textTracks&&this.video.textTracks[0]){var P=this.video.textTracks[0];P.oncuechange=function(){var F=P.activeCues[P.activeCues.length-1];if(x.container.innerHTML="",F){var Q=document.createElement("div");Q.appendChild(F.getCueAsHTML());var pe=Q.innerHTML.split(/\r?\n/).map(function(ge){return"<p>".concat(ge,"</p>")}).join("");x.container.innerHTML=pe}x.events.trigger("subtitle_change")}}}},{key:"show",value:function(){this.container.classList.remove("dplayer-subtitle-hide"),this.events.trigger("subtitle_show")}},{key:"hide",value:function(){this.container.classList.add("dplayer-subtitle-hide"),this.events.trigger("subtitle_hide")}},{key:"toggle",value:function(){this.container.classList.contains("dplayer-subtitle-hide")?this.show():this.hide()}}],q&&Ul(k.prototype,q),Object.defineProperty(k,"prototype",{writable:!1}),T}();const jl=Io;function Fr(T){return Fr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},Fr(T)}function On(T,k){for(var q=0;q<k.length;q++){var x=k[q];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(T,(P=function(F,Q){if(Fr(F)!=="object"||F===null)return F;var pe=F[Symbol.toPrimitive];if(pe!==void 0){var ge=pe.call(F,"string");if(Fr(ge)!=="object")return ge;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(x.key),Fr(P)==="symbol"?P:String(P)),x)}var P}var Ro=function(){function T(x){var P=this;(function(ge,Ve){if(!(ge instanceof Ve))throw new TypeError("Cannot call a class as a function")})(this,T),this.player=x,this.player.template.mask.addEventListener("click",function(){P.hide()}),this.player.template.subtitlesButton.addEventListener("click",function(){P.adaptiveHeight(),P.show()});for(var F=this.player.template.subtitlesItem.length-1,Q=function(ge){P.player.template.subtitlesItem[ge].addEventListener("click",function(){P.hide(),P.player.options.subtitle.index!==ge&&(P.player.template.subtitle.innerHTML="<p></p>",P.player.template.subtrack.src=P.player.template.subtitlesItem[ge].dataset.subtitle,P.player.options.subtitle.index=ge,P.player.template.subtitle.classList.contains("dplayer-subtitle-hide")&&P.subContainerShow())})},pe=0;pe<F;pe++)Q(pe);this.player.template.subtitlesItem[F].addEventListener("click",function(){P.hide(),P.player.options.subtitle.index!==F&&(P.player.template.subtitle.innerHTML="<p></p>",P.player.template.subtrack.src="",P.player.options.subtitle.index=F,P.subContainerHide())})}var k,q;return k=T,(q=[{key:"subContainerShow",value:function(){this.player.template.subtitle.classList.remove("dplayer-subtitle-hide"),this.player.events.trigger("subtitle_show")}},{key:"subContainerHide",value:function(){this.player.template.subtitle.classList.add("dplayer-subtitle-hide"),this.player.events.trigger("subtitle_hide")}},{key:"hide",value:function(){this.player.template.subtitlesBox.classList.remove("dplayer-subtitles-box-open"),this.player.template.mask.classList.remove("dplayer-mask-show"),this.player.controller.disableAutoHide=!1}},{key:"show",value:function(){this.player.template.subtitlesBox.classList.add("dplayer-subtitles-box-open"),this.player.template.mask.classList.add("dplayer-mask-show"),this.player.controller.disableAutoHide=!0}},{key:"adaptiveHeight",value:function(){var x=30*this.player.template.subtitlesItem.length+14,P=.8*this.player.template.videoWrap.offsetHeight;x>=P-50?(this.player.template.subtitlesBox.style.bottom="8px",this.player.template.subtitlesBox.style["max-height"]=P-8+"px"):(this.player.template.subtitlesBox.style.bottom="50px",this.player.template.subtitlesBox.style["max-height"]=P-50+"px")}}])&&On(k.prototype,q),Object.defineProperty(k,"prototype",{writable:!1}),T}();const js=Ro;function Li(T){return Li=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},Li(T)}function ys(T,k){for(var q=0;q<k.length;q++){var x=k[q];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(T,(P=function(F,Q){if(Li(F)!=="object"||F===null)return F;var pe=F[Symbol.toPrimitive];if(pe!==void 0){var ge=pe.call(F,"string");if(Li(ge)!=="object")return ge;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(x.key),Li(P)==="symbol"?P:String(P)),x)}var P}var Wa=function(){function T(x){(function(P,F){if(!(P instanceof F))throw new TypeError("Cannot call a class as a function")})(this,T),this.elements={},this.elements.volume=x.volumeBar,this.elements.played=x.playedBar,this.elements.loaded=x.loadedBar,this.elements.danmaku=x.danmakuOpacityBar}var k,q;return k=T,(q=[{key:"set",value:function(x,P,F){P=Math.max(P,0),P=Math.min(P,1),this.elements[x].style[F]=100*P+"%"}},{key:"get",value:function(x){return parseFloat(this.elements[x].style.width)/100}}])&&ys(k.prototype,q),Object.defineProperty(k,"prototype",{writable:!1}),T}();const ni=Wa;function vs(T){return vs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},vs(T)}function Po(T,k){for(var q=0;q<k.length;q++){var x=k[q];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(T,(P=function(F,Q){if(vs(F)!=="object"||F===null)return F;var pe=F[Symbol.toPrimitive];if(pe!==void 0){var ge=pe.call(F,"string");if(vs(ge)!=="object")return ge;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(x.key),vs(P)==="symbol"?P:String(P)),x)}var P}var Oo=function(){function T(x){(function(P,F){if(!(P instanceof F))throw new TypeError("Cannot call a class as a function")})(this,T),this.player=x,window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(P){window.setTimeout(P,1e3/60)},this.types=["loading","info","fps"],this.init()}var k,q;return k=T,(q=[{key:"init",value:function(){var x=this;this.types.map(function(P){return P!=="fps"&&x["init".concat(P,"Checker")](),P})}},{key:"initloadingChecker",value:function(){var x=this,P=0,F=0,Q=!1;this.loadingChecker=setInterval(function(){x.enableloadingChecker&&(F=x.player.video.currentTime,Q||F!==P||x.player.video.paused||(x.player.container.classList.add("dplayer-loading"),Q=!0),Q&&F>P&&!x.player.video.paused&&(x.player.container.classList.remove("dplayer-loading"),Q=!1),P=F)},100)}},{key:"initfpsChecker",value:function(){var x=this;window.requestAnimationFrame(function(){if(x.enablefpsChecker)if(x.initfpsChecker(),x.fpsStart){x.fpsIndex++;var P=new Date;P-x.fpsStart>1e3&&(x.player.infoPanel.fps(x.fpsIndex/(P-x.fpsStart)*1e3),x.fpsStart=new Date,x.fpsIndex=0)}else x.fpsStart=new Date,x.fpsIndex=0;else x.fpsStart=0,x.fpsIndex=0})}},{key:"initinfoChecker",value:function(){var x=this;this.infoChecker=setInterval(function(){x.enableinfoChecker&&x.player.infoPanel.update()},1e3)}},{key:"enable",value:function(x){this["enable".concat(x,"Checker")]=!0,x==="fps"&&this.initfpsChecker()}},{key:"disable",value:function(x){this["enable".concat(x,"Checker")]=!1}},{key:"destroy",value:function(){var x=this;this.types.map(function(P){return x["enable".concat(P,"Checker")]=!1,x["".concat(P,"Checker")]&&clearInterval(x["".concat(P,"Checker")]),P})}}])&&Po(k.prototype,q),Object.defineProperty(k,"prototype",{writable:!1}),T}();const As=Oo;function Ui(T){return Ui=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},Ui(T)}function tr(T,k){for(var q=0;q<k.length;q++){var x=k[q];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(T,(P=function(F,Q){if(Ui(F)!=="object"||F===null)return F;var pe=F[Symbol.toPrimitive];if(pe!==void 0){var ge=pe.call(F,"string");if(Ui(ge)!=="object")return ge;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(x.key),Ui(P)==="symbol"?P:String(P)),x)}var P}const gr=function(){function T(x){var P=this;(function(F,Q){if(!(F instanceof Q))throw new TypeError("Cannot call a class as a function")})(this,T),this.container=x,this.container.addEventListener("animationend",function(){P.container.classList.remove("dplayer-bezel-transition")})}var k,q;return k=T,(q=[{key:"switch",value:function(x){this.container.innerHTML=x,this.container.classList.add("dplayer-bezel-transition")}}])&&tr(k.prototype,q),Object.defineProperty(k,"prototype",{writable:!1}),T}();function ci(T){return ci=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},ci(T)}function Bo(T,k){for(var q=0;q<k.length;q++){var x=k[q];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(T,(P=function(F,Q){if(ci(F)!=="object"||F===null)return F;var pe=F[Symbol.toPrimitive];if(pe!==void 0){var ge=pe.call(F,"string");if(ci(ge)!=="object")return ge;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(x.key),ci(P)==="symbol"?P:String(P)),x)}var P}var _i=function(){function T(x){(function(P,F){if(!(P instanceof F))throw new TypeError("Cannot call a class as a function")})(this,T),this.container=x.container,this.barWidth=x.barWidth,this.container.style.backgroundImage="url('".concat(x.url,"')"),this.events=x.events}var k,q;return k=T,(q=[{key:"resize",value:function(x,P,F){this.container.style.width="".concat(x,"px"),this.container.style.height="".concat(P,"px"),this.container.style.top="".concat(2-P,"px"),this.barWidth=F}},{key:"show",value:function(){this.container.style.display="block",this.events&&this.events.trigger("thumbnails_show")}},{key:"move",value:function(x){this.container.style.backgroundPosition="-".concat(160*(Math.ceil(x/this.barWidth*100)-1),"px 0"),this.container.style.left="".concat(Math.min(Math.max(x-this.container.offsetWidth/2,-10),this.barWidth-150),"px")}},{key:"hide",value:function(){this.container.style.display="none",this.events&&this.events.trigger("thumbnails_hide")}}])&&Bo(k.prototype,q),Object.defineProperty(k,"prototype",{writable:!1}),T}();const za=_i;function ir(T){return ir=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},ir(T)}function $s(T,k){for(var q=0;q<k.length;q++){var x=k[q];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(T,(P=function(F,Q){if(ir(F)!=="object"||F===null)return F;var pe=F[Symbol.toPrimitive];if(pe!==void 0){var ge=pe.call(F,"string");if(ir(ge)!=="object")return ge;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(x.key),ir(P)==="symbol"?P:String(P)),x)}var P}var cn,Ya=!0,Vs=!1,Jr=function(){function T(x){(function(P,F){if(!(P instanceof F))throw new TypeError("Cannot call a class as a function")})(this,T),this.player=x,this.autoHideTimer=0,Ie.isMobile||(this.setAutoHideHandler=this.setAutoHide.bind(this),this.player.container.addEventListener("mousemove",this.setAutoHideHandler),this.player.container.addEventListener("click",this.setAutoHideHandler),this.player.on("play",this.setAutoHideHandler),this.player.on("pause",this.setAutoHideHandler)),this.initPlayButton(),this.initThumbnails(),this.initPlayedBar(),this.initFullButton(),this.initQualityButton(),this.initScreenshotButton(),this.player.options.subtitle&&typeof this.player.options.subtitle.url=="string"&&this.initSubtitleButton(),this.initHighlights(),this.initAirplayButton(),this.initChromecastButton(),Ie.isMobile||this.initVolumeButton()}var k,q;return k=T,(q=[{key:"initPlayButton",value:function(){var x=this;this.player.template.playButton.addEventListener("click",function(){x.player.toggle()}),this.player.template.mobilePlayButton.addEventListener("click",function(){x.player.toggle()}),Ie.isMobile?(this.player.template.videoWrap.addEventListener("click",function(){x.toggle()}),this.player.template.controllerMask.addEventListener("click",function(){x.toggle()})):this.player.options.preventClickToggle||(this.player.template.videoWrap.addEventListener("click",function(){x.player.toggle()}),this.player.template.controllerMask.addEventListener("click",function(){x.player.toggle()}))}},{key:"initHighlights",value:function(){var x=this;this.player.on("durationchange",function(){if(x.player.video.duration!==1&&x.player.video.duration!==1/0&&x.player.options.highlight){var P=x.player.template.playedBarWrap.querySelectorAll(".dplayer-highlight");[].slice.call(P,0).forEach(function(pe){x.player.template.playedBarWrap.removeChild(pe)});for(var F=0;F<x.player.options.highlight.length;F++)if(x.player.options.highlight[F].text&&x.player.options.highlight[F].time){var Q=document.createElement("div");Q.classList.add("dplayer-highlight"),Q.style.left=x.player.options.highlight[F].time/x.player.video.duration*100+"%",Q.innerHTML='<span class="dplayer-highlight-text">'+x.player.options.highlight[F].text+"</span>",x.player.template.playedBarWrap.insertBefore(Q,x.player.template.playedBarTime)}}})}},{key:"initThumbnails",value:function(){var x=this;this.player.options.video.thumbnails&&(this.thumbnails=new za({container:this.player.template.barPreview,barWidth:this.player.template.barWrap.offsetWidth,url:this.player.options.video.thumbnails,events:this.player.events}),this.player.on("loadedmetadata",function(){x.thumbnails.resize(160,x.player.video.videoHeight/x.player.video.videoWidth*160,x.player.template.barWrap.offsetWidth)}))}},{key:"initPlayedBar",value:function(){var x=this,P=function(Q){var pe=((Q.clientX||Q.changedTouches[0].clientX)-Ie.getBoundingClientRectViewLeft(x.player.template.playedBarWrap))/x.player.template.playedBarWrap.clientWidth;pe=Math.max(pe,0),pe=Math.min(pe,1),x.player.bar.set("played",pe,"width"),x.player.template.ptime.innerHTML=Ie.secondToTime(pe*x.player.video.duration)},F=function Q(pe){document.removeEventListener(Ie.nameMap.dragEnd,Q),document.removeEventListener(Ie.nameMap.dragMove,P);var ge=((pe.clientX||pe.changedTouches[0].clientX)-Ie.getBoundingClientRectViewLeft(x.player.template.playedBarWrap))/x.player.template.playedBarWrap.clientWidth;ge=Math.max(ge,0),ge=Math.min(ge,1),x.player.bar.set("played",ge,"width"),x.player.seek(x.player.bar.get("played")*x.player.video.duration),x.player.timer.enable("progress")};this.player.template.playedBarWrap.addEventListener(Ie.nameMap.dragStart,function(){x.player.timer.disable("progress"),document.addEventListener(Ie.nameMap.dragMove,P),document.addEventListener(Ie.nameMap.dragEnd,F)}),this.player.template.playedBarWrap.addEventListener(Ie.nameMap.dragMove,function(Q){if(x.player.video.duration){var pe=x.player.template.playedBarWrap.getBoundingClientRect().left,ge=(Q.clientX||Q.changedTouches[0].clientX)-pe;if(ge<0||ge>x.player.template.playedBarWrap.offsetWidth)return;var Ve=x.player.video.duration*(ge/x.player.template.playedBarWrap.offsetWidth);Ie.isMobile&&x.thumbnails&&x.thumbnails.show(),x.thumbnails&&x.thumbnails.move(ge),x.player.template.playedBarTime.style.left="".concat(ge-(Ve>=3600?25:20),"px"),x.player.template.playedBarTime.innerText=Ie.secondToTime(Ve),x.player.template.playedBarTime.classList.remove("hidden")}}),this.player.template.playedBarWrap.addEventListener(Ie.nameMap.dragEnd,function(){Ie.isMobile&&x.thumbnails&&x.thumbnails.hide()}),Ie.isMobile||(this.player.template.playedBarWrap.addEventListener("mouseenter",function(){x.player.video.duration&&(x.thumbnails&&x.thumbnails.show(),x.player.template.playedBarTime.classList.remove("hidden"))}),this.player.template.playedBarWrap.addEventListener("mouseleave",function(){x.player.video.duration&&(x.thumbnails&&x.thumbnails.hide(),x.player.template.playedBarTime.classList.add("hidden"))}))}},{key:"initFullButton",value:function(){var x=this;this.player.template.browserFullButton.addEventListener("click",function(){x.player.fullScreen.toggle("browser")}),this.player.template.webFullButton.addEventListener("click",function(){x.player.fullScreen.toggle("web")})}},{key:"initVolumeButton",value:function(){var x=this,P=function(Q){var pe=Q||window.event,ge=((pe.clientX||pe.changedTouches[0].clientX)-Ie.getBoundingClientRectViewLeft(x.player.template.volumeBarWrap)-5.5)/35;x.player.volume(ge)},F=function Q(){document.removeEventListener(Ie.nameMap.dragEnd,Q),document.removeEventListener(Ie.nameMap.dragMove,P),x.player.template.volumeButton.classList.remove("dplayer-volume-active")};this.player.template.volumeBarWrapWrap.addEventListener("click",function(Q){var pe=Q||window.event,ge=((pe.clientX||pe.changedTouches[0].clientX)-Ie.getBoundingClientRectViewLeft(x.player.template.volumeBarWrap)-5.5)/35;x.player.volume(ge)}),this.player.template.volumeBarWrapWrap.addEventListener(Ie.nameMap.dragStart,function(){document.addEventListener(Ie.nameMap.dragMove,P),document.addEventListener(Ie.nameMap.dragEnd,F),x.player.template.volumeButton.classList.add("dplayer-volume-active")}),this.player.template.volumeButtonIcon.addEventListener("click",function(){x.player.video.muted?(x.player.video.muted=!1,x.player.switchVolumeIcon(),x.player.bar.set("volume",x.player.volume(),"width")):(x.player.video.muted=!0,x.player.template.volumeIcon.innerHTML=Rn.volumeOff,x.player.bar.set("volume",0,"width"))})}},{key:"initQualityButton",value:function(){var x=this;this.player.options.video.quality&&this.player.template.qualityList.addEventListener("click",function(P){P.target.classList.contains("dplayer-quality-item")&&x.player.switchQuality(P.target.dataset.index)})}},{key:"initScreenshotButton",value:function(){var x=this;this.player.options.screenshot&&this.player.template.camareButton.addEventListener("click",function(){var P,F=document.createElement("canvas");F.width=x.player.video.videoWidth,F.height=x.player.video.videoHeight,F.getContext("2d").drawImage(x.player.video,0,0,F.width,F.height),F.toBlob(function(Q){P=URL.createObjectURL(Q);var pe=document.createElement("a");pe.href=P,pe.download="DPlayer.png",pe.style.display="none",document.body.appendChild(pe),pe.click(),document.body.removeChild(pe),URL.revokeObjectURL(P),x.player.events.trigger("screenshot",P)})})}},{key:"initAirplayButton",value:function(){this.player.options.airplay&&(window.WebKitPlaybackTargetAvailabilityEvent?this.player.video.addEventListener("webkitplaybacktargetavailabilitychanged",function(x){x.availability==="available"?this.template.airplayButton.disable=!1:this.template.airplayButton.disable=!0,this.template.airplayButton.addEventListener("click",function(){this.video.webkitShowPlaybackTargetPicker()}.bind(this))}.bind(this.player)):this.player.template.airplayButton.style.display="none")}},{key:"initChromecast",value:function(){var x=window.document.createElement("script");x.setAttribute("type","text/javascript"),x.setAttribute("src","https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1"),window.document.body.appendChild(x),window.__onGCastApiAvailable=function(P){if(P){var F=new(cn=window.chrome.cast).SessionRequest(cn.media.DEFAULT_MEDIA_RECEIVER_APP_ID),Q=new cn.ApiConfig(F,function(){},function(pe){pe===cn.ReceiverAvailability.AVAILABLE&&console.log("chromecast: ",pe)});cn.initialize(Q,function(){})}}}},{key:"initChromecastButton",value:function(){var x=this;if(this.player.options.chromecast){Ya&&(Ya=!1,this.initChromecast());var P=function(Q,pe){x.currentMedia=pe},F=function(Q){console.error("Error launching media",Q)};this.player.template.chromecastButton.addEventListener("click",function(){Vs?(Vs=!1,x.currentMedia.stop(),x.session.stop(),x.initChromecast()):(Vs=!0,cn.requestSession(function(Q){var pe,ge,Ve;x.session=Q,pe=x.player.options.video.url,ge=new cn.media.MediaInfo(pe),Ve=new cn.media.LoadRequest(ge),x.session?x.session.loadMedia(Ve,P.bind(x,"loadMedia"),F).play():window.open(pe)},function(Q){Q.code==="cancel"?x.session=void 0:console.error("Error selecting a cast device",Q)}))})}}},{key:"initSubtitleButton",value:function(){var x=this;this.player.events.on("subtitle_show",function(){x.player.template.subtitleButton.dataset.balloon=x.player.tran("hide-subs"),x.player.template.subtitleButtonInner.style.opacity="",x.player.user.set("subtitle",1)}),this.player.events.on("subtitle_hide",function(){x.player.template.subtitleButton.dataset.balloon=x.player.tran("show-subs"),x.player.template.subtitleButtonInner.style.opacity="0.4",x.player.user.set("subtitle",0)}),this.player.template.subtitleButton.addEventListener("click",function(){x.player.subtitle.toggle()})}},{key:"setAutoHide",value:function(){var x=this;this.show(),clearTimeout(this.autoHideTimer),this.autoHideTimer=setTimeout(function(){!x.player.video.played.length||x.player.paused||x.disableAutoHide||x.hide()},3e3)}},{key:"show",value:function(){this.player.container.classList.remove("dplayer-hide-controller")}},{key:"hide",value:function(){this.player.container.classList.add("dplayer-hide-controller"),this.player.setting.hide(),this.player.comment&&this.player.comment.hide()}},{key:"isShow",value:function(){return!this.player.container.classList.contains("dplayer-hide-controller")}},{key:"toggle",value:function(){this.isShow()?this.hide():this.show()}},{key:"destroy",value:function(){Ie.isMobile||(this.player.container.removeEventListener("mousemove",this.setAutoHideHandler),this.player.container.removeEventListener("click",this.setAutoHideHandler)),clearTimeout(this.autoHideTimer)}}])&&$s(k.prototype,q),Object.defineProperty(k,"prototype",{writable:!1}),T}();const bs=Jr;function Sn(T){return Sn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},Sn(T)}function _s(T,k){for(var q=0;q<k.length;q++){var x=k[q];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(T,(P=function(F,Q){if(Sn(F)!=="object"||F===null)return F;var pe=F[Symbol.toPrimitive];if(pe!==void 0){var ge=pe.call(F,"string");if(Sn(ge)!=="object")return ge;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(x.key),Sn(P)==="symbol"?P:String(P)),x)}var P}var Gs=function(){function T(x){var P=this;(function(Ve,Ke){if(!(Ve instanceof Ke))throw new TypeError("Cannot call a class as a function")})(this,T),this.player=x,this.player.template.mask.addEventListener("click",function(){P.hide()}),this.player.template.settingButton.addEventListener("click",function(){P.show()}),this.loop=this.player.options.loop,this.player.template.loopToggle.checked=this.loop,this.player.template.loop.addEventListener("click",function(){P.player.template.loopToggle.checked=!P.player.template.loopToggle.checked,P.player.template.loopToggle.checked?P.loop=!0:P.loop=!1,P.hide()}),this.showDanmaku=this.player.user.get("danmaku"),this.showDanmaku||this.player.danmaku&&this.player.danmaku.hide(),this.player.template.showDanmakuToggle.checked=this.showDanmaku,this.player.template.showDanmaku.addEventListener("click",function(){P.player.template.showDanmakuToggle.checked=!P.player.template.showDanmakuToggle.checked,P.player.template.showDanmakuToggle.checked?(P.showDanmaku=!0,P.player.danmaku.show()):(P.showDanmaku=!1,P.player.danmaku.hide()),P.player.user.set("danmaku",P.showDanmaku?1:0),P.hide()}),this.unlimitDanmaku=this.player.user.get("unlimited"),this.player.template.unlimitDanmakuToggle.checked=this.unlimitDanmaku,this.player.template.unlimitDanmaku.addEventListener("click",function(){P.player.template.unlimitDanmakuToggle.checked=!P.player.template.unlimitDanmakuToggle.checked,P.player.template.unlimitDanmakuToggle.checked?(P.unlimitDanmaku=!0,P.player.danmaku.unlimit(!0)):(P.unlimitDanmaku=!1,P.player.danmaku.unlimit(!1)),P.player.user.set("unlimited",P.unlimitDanmaku?1:0),P.hide()}),this.player.template.speed.addEventListener("click",function(){P.player.template.settingBox.classList.add("dplayer-setting-box-narrow"),P.player.template.settingBox.classList.add("dplayer-setting-box-speed")});for(var F=function(Ve){P.player.template.speedItem[Ve].addEventListener("click",function(){P.player.speed(P.player.template.speedItem[Ve].dataset.speed),P.hide()})},Q=0;Q<this.player.template.speedItem.length;Q++)F(Q);if(this.player.danmaku){this.player.on("danmaku_opacity",function(Ve){P.player.bar.set("danmaku",Ve,"width"),P.player.user.set("opacity",Ve)}),this.player.danmaku.opacity(this.player.user.get("opacity"));var pe=function(Ve){var Ke=Ve||window.event,vt=((Ke.clientX||Ke.changedTouches[0].clientX)-Ie.getBoundingClientRectViewLeft(P.player.template.danmakuOpacityBarWrap))/130;vt=Math.max(vt,0),vt=Math.min(vt,1),P.player.danmaku.opacity(vt)},ge=function Ve(){document.removeEventListener(Ie.nameMap.dragEnd,Ve),document.removeEventListener(Ie.nameMap.dragMove,pe),P.player.template.danmakuOpacityBox.classList.remove("dplayer-setting-danmaku-active")};this.player.template.danmakuOpacityBarWrapWrap.addEventListener("click",function(Ve){var Ke=Ve||window.event,vt=((Ke.clientX||Ke.changedTouches[0].clientX)-Ie.getBoundingClientRectViewLeft(P.player.template.danmakuOpacityBarWrap))/130;vt=Math.max(vt,0),vt=Math.min(vt,1),P.player.danmaku.opacity(vt)}),this.player.template.danmakuOpacityBarWrapWrap.addEventListener(Ie.nameMap.dragStart,function(){document.addEventListener(Ie.nameMap.dragMove,pe),document.addEventListener(Ie.nameMap.dragEnd,ge),P.player.template.danmakuOpacityBox.classList.add("dplayer-setting-danmaku-active")})}}var k,q;return k=T,(q=[{key:"hide",value:function(){var x=this;this.player.template.settingBox.classList.remove("dplayer-setting-box-open"),this.player.template.mask.classList.remove("dplayer-mask-show"),setTimeout(function(){x.player.template.settingBox.classList.remove("dplayer-setting-box-narrow"),x.player.template.settingBox.classList.remove("dplayer-setting-box-speed")},300),this.player.controller.disableAutoHide=!1}},{key:"show",value:function(){this.player.template.settingBox.classList.add("dplayer-setting-box-open"),this.player.template.mask.classList.add("dplayer-mask-show"),this.player.controller.disableAutoHide=!0}}])&&_s(k.prototype,q),Object.defineProperty(k,"prototype",{writable:!1}),T}();const Mo=Gs;function yr(T){return yr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},yr(T)}function Hs(T,k){for(var q=0;q<k.length;q++){var x=k[q];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(T,(P=function(F,Q){if(yr(F)!=="object"||F===null)return F;var pe=F[Symbol.toPrimitive];if(pe!==void 0){var ge=pe.call(F,"string");if(yr(ge)!=="object")return ge;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(x.key),yr(P)==="symbol"?P:String(P)),x)}var P}var Bn=function(){function T(x){var P=this;(function(F,Q){if(!(F instanceof Q))throw new TypeError("Cannot call a class as a function")})(this,T),this.player=x,this.player.template.mask.addEventListener("click",function(){P.hide()}),this.player.template.commentButton.addEventListener("click",function(){P.show()}),this.player.template.commentSettingButton.addEventListener("click",function(){P.toggleSetting()}),this.player.template.commentColorSettingBox.addEventListener("click",function(){if(P.player.template.commentColorSettingBox.querySelector("input:checked+span")){var F=P.player.template.commentColorSettingBox.querySelector("input:checked").value;P.player.template.commentSettingFill.style.fill=F,P.player.template.commentInput.style.color=F,P.player.template.commentSendFill.style.fill=F}}),this.player.template.commentInput.addEventListener("click",function(){P.hideSetting()}),this.player.template.commentInput.addEventListener("keydown",function(F){(F||window.event).keyCode===13&&P.send()}),this.player.template.commentSendButton.addEventListener("click",function(){P.send()})}var k,q;return k=T,(q=[{key:"show",value:function(){this.player.controller.disableAutoHide=!0,this.player.template.controller.classList.add("dplayer-controller-comment"),this.player.template.mask.classList.add("dplayer-mask-show"),this.player.container.classList.add("dplayer-show-controller"),this.player.template.commentInput.focus()}},{key:"hide",value:function(){this.player.template.controller.classList.remove("dplayer-controller-comment"),this.player.template.mask.classList.remove("dplayer-mask-show"),this.player.container.classList.remove("dplayer-show-controller"),this.player.controller.disableAutoHide=!1,this.hideSetting()}},{key:"showSetting",value:function(){this.player.template.commentSettingBox.classList.add("dplayer-comment-setting-open")}},{key:"hideSetting",value:function(){this.player.template.commentSettingBox.classList.remove("dplayer-comment-setting-open")}},{key:"toggleSetting",value:function(){this.player.template.commentSettingBox.classList.contains("dplayer-comment-setting-open")?this.hideSetting():this.showSetting()}},{key:"send",value:function(){var x=this;this.player.template.commentInput.blur(),this.player.template.commentInput.value.replace(/^\s+|\s+$/g,"")?this.player.danmaku.send({text:this.player.template.commentInput.value,color:Ie.color2Number(this.player.container.querySelector(".dplayer-comment-setting-color input:checked").value),type:parseInt(this.player.container.querySelector(".dplayer-comment-setting-type input:checked").value)},function(){x.player.template.commentInput.value="",x.hide()}):this.player.notice(this.player.tran("please-input-danmaku"))}}])&&Hs(k.prototype,q),Object.defineProperty(k,"prototype",{writable:!1}),T}();const ga=Bn;function vr(T){return vr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},vr(T)}function Nr(T,k){for(var q=0;q<k.length;q++){var x=k[q];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(T,(P=function(F,Q){if(vr(F)!=="object"||F===null)return F;var pe=F[Symbol.toPrimitive];if(pe!==void 0){var ge=pe.call(F,"string");if(vr(ge)!=="object")return ge;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(x.key),vr(P)==="symbol"?P:String(P)),x)}var P}var bn=function(){function T(x){(function(P,F){if(!(P instanceof F))throw new TypeError("Cannot call a class as a function")})(this,T),this.player=x,this.doHotKeyHandler=this.doHotKey.bind(this),this.cancelFullScreenHandler=this.cancelFullScreen.bind(this),this.player.options.hotkey&&document.addEventListener("keydown",this.doHotKeyHandler),document.addEventListener("keydown",this.cancelFullScreenHandler)}var k,q;return k=T,(q=[{key:"doHotKey",value:function(x){if(this.player.focus){var P=document.activeElement.tagName.toUpperCase(),F=document.activeElement.getAttribute("contenteditable");if(P!=="INPUT"&&P!=="TEXTAREA"&&F!==""&&F!=="true"){var Q,pe=x||window.event;switch(pe.keyCode){case 32:pe.preventDefault(),this.player.toggle();break;case 37:if(pe.preventDefault(),this.player.options.live)break;this.player.seek(this.player.video.currentTime-5),this.player.controller.setAutoHide();break;case 39:if(pe.preventDefault(),this.player.options.live)break;this.player.seek(this.player.video.currentTime+5),this.player.controller.setAutoHide();break;case 38:pe.preventDefault(),Q=this.player.volume()+.1,this.player.volume(Q);break;case 40:pe.preventDefault(),Q=this.player.volume()-.1,this.player.volume(Q)}}}}},{key:"cancelFullScreen",value:function(x){(x||window.event).keyCode===27&&this.player.fullScreen.isFullScreen("web")&&this.player.fullScreen.cancel("web")}},{key:"destroy",value:function(){this.player.options.hotkey&&document.removeEventListener("keydown",this.doHotKeyHandler),document.removeEventListener("keydown",this.cancelFullScreenHandler)}}])&&Nr(k.prototype,q),Object.defineProperty(k,"prototype",{writable:!1}),T}();const ya=bn;function Zr(T){return Zr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},Zr(T)}function Fo(T,k){for(var q=0;q<k.length;q++){var x=k[q];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(T,(P=function(F,Q){if(Zr(F)!=="object"||F===null)return F;var pe=F[Symbol.toPrimitive];if(pe!==void 0){var ge=pe.call(F,"string");if(Zr(ge)!=="object")return ge;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(x.key),Zr(P)==="symbol"?P:String(P)),x)}var P}var ot=function(){function T(x){var P=this;(function(F,Q){if(!(F instanceof Q))throw new TypeError("Cannot call a class as a function")})(this,T),this.player=x,this.shown=!1,Array.prototype.slice.call(this.player.template.menuItem).forEach(function(F,Q){P.player.options.contextmenu[Q].click&&F.addEventListener("click",function(){P.player.options.contextmenu[Q].click(P.player),P.hide()})}),this.contextmenuHandler=function(F){if(P.shown)P.hide();else{var Q=F||window.event;Q.preventDefault();var pe=P.player.container.getBoundingClientRect();P.show(Q.clientX-pe.left,Q.clientY-pe.top),P.player.template.mask.addEventListener("click",function(){P.hide()})}},this.player.container.addEventListener("contextmenu",this.contextmenuHandler)}var k,q;return k=T,(q=[{key:"show",value:function(x,P){this.player.template.menu.classList.add("dplayer-menu-show");var F=this.player.container.getBoundingClientRect();x+this.player.template.menu.offsetWidth>=F.width?(this.player.template.menu.style.right=F.width-x+"px",this.player.template.menu.style.left="initial"):(this.player.template.menu.style.left=x+"px",this.player.template.menu.style.right="initial"),P+this.player.template.menu.offsetHeight>=F.height?(this.player.template.menu.style.bottom=F.height-P+"px",this.player.template.menu.style.top="initial"):(this.player.template.menu.style.top=P+"px",this.player.template.menu.style.bottom="initial"),this.player.template.mask.classList.add("dplayer-mask-show"),this.shown=!0,this.player.events.trigger("contextmenu_show")}},{key:"hide",value:function(){this.player.template.mask.classList.remove("dplayer-mask-show"),this.player.template.menu.classList.remove("dplayer-menu-show"),this.shown=!1,this.player.events.trigger("contextmenu_hide")}},{key:"destroy",value:function(){this.player.container.removeEventListener("contextmenu",this.contextmenuHandler)}}])&&Fo(k.prototype,q),Object.defineProperty(k,"prototype",{writable:!1}),T}();const Ur=ot;function Vn(T){return Vn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},Vn(T)}function No(T,k){for(var q=0;q<k.length;q++){var x=k[q];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(T,(P=function(F,Q){if(Vn(F)!=="object"||F===null)return F;var pe=F[Symbol.toPrimitive];if(pe!==void 0){var ge=pe.call(F,"string");if(Vn(ge)!=="object")return ge;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(F)}(x.key),Vn(P)==="symbol"?P:String(P)),x)}var P}var Uo=function(){function T(x){var P=this;(function(F,Q){if(!(F instanceof Q))throw new TypeError("Cannot call a class as a function")})(this,T),this.container=x.template.infoPanel,this.template=x.template,this.video=x.video,this.player=x,this.template.infoPanelClose.addEventListener("click",function(){P.hide()})}var k,q;return k=T,(q=[{key:"show",value:function(){this.beginTime=Date.now(),this.update(),this.player.timer.enable("info"),this.player.timer.enable("fps"),this.container.classList.remove("dplayer-info-panel-hide")}},{key:"hide",value:function(){this.player.timer.disable("info"),this.player.timer.disable("fps"),this.container.classList.add("dplayer-info-panel-hide")}},{key:"triggle",value:function(){this.container.classList.contains("dplayer-info-panel-hide")?this.show():this.hide()}},{key:"update",value:function(){this.template.infoVersion.innerHTML="v".concat("1.27.1"," ").concat("v1.27.0-12-g4f61091"),this.template.infoType.innerHTML=this.player.type,this.template.infoUrl.innerHTML=this.player.options.video.url,this.template.infoResolution.innerHTML="".concat(this.player.video.videoWidth," x ").concat(this.player.video.videoHeight),this.template.infoDuration.innerHTML=this.player.video.duration,this.player.options.danmaku&&(this.template.infoDanmakuId.innerHTML=this.player.options.danmaku.id,this.template.infoDanmakuApi.innerHTML=this.player.options.danmaku.api,this.template.infoDanmakuAmount.innerHTML=this.player.danmaku.dan.length)}},{key:"fps",value:function(x){this.template.infoFPS.innerHTML="".concat(x.toFixed(1))}}])&&No(k.prototype,q),Object.defineProperty(k,"prototype",{writable:!1}),T}();const ri=Uo;var jr=Ee(568),Mn=Ee.n(jr);function Gn(T){return Gn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},Gn(T)}function $r(T,k){var q=Object.keys(T);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(T);k&&(x=x.filter(function(P){return Object.getOwnPropertyDescriptor(T,P).enumerable})),q.push.apply(q,x)}return q}function va(T,k,q){return(k=ba(k))in T?Object.defineProperty(T,k,{value:q,enumerable:!0,configurable:!0,writable:!0}):T[k]=q,T}function Aa(T,k){for(var q=0;q<k.length;q++){var x=k[q];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(T,ba(x.key),x)}}function ba(T){var k=function(q,x){if(Gn(q)!=="object"||q===null)return q;var P=q[Symbol.toPrimitive];if(P!==void 0){var F=P.call(q,"string");if(Gn(F)!=="object")return F;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(q)}(T);return Gn(k)==="symbol"?k:String(k)}var Hn=0,es=[],Ar=function(){function T(P){var F=this;(function(Q,pe){if(!(Q instanceof pe))throw new TypeError("Cannot call a class as a function")})(this,T),this.options=function(Q){var pe={container:Q.element||document.getElementsByClassName("dplayer")[0],live:!1,autoplay:!1,theme:"#b7daff",loop:!1,lang:(navigator.language||navigator.browserLanguage).toLowerCase(),screenshot:!1,airplay:!0,chromecast:!1,hotkey:!0,preload:"metadata",volume:.7,playbackSpeed:[.5,.75,1,1.25,1.5,2],apiBackend:Wt,video:{},contextmenu:[],mutex:!0,pluginOptions:{hls:{},flv:{},dash:{},webtorrent:{}},preventClickToggle:!1};for(var ge in pe)pe.hasOwnProperty(ge)&&!Q.hasOwnProperty(ge)&&(Q[ge]=pe[ge]);return Q.video&&!Q.video.type&&(Q.video.type="auto"),da(Q.danmaku)==="object"&&Q.danmaku&&!Q.danmaku.user&&(Q.danmaku.user="DIYgod"),Q.subtitle&&(!Q.subtitle.type&&(Q.subtitle.type="webvtt"),!Q.subtitle.fontSize&&(Q.subtitle.fontSize="20px"),!Q.subtitle.bottom&&(Q.subtitle.bottom="40px"),!Q.subtitle.color&&(Q.subtitle.color="#fff")),Q.video.quality&&(Q.video.url=Q.video.quality[Q.video.defaultQuality].url),Q.lang&&(Q.lang=Q.lang.toLowerCase()),Q.contextmenu=Q.contextmenu.concat([{key:"video-info",click:function(Ve){Ve.infoPanel.triggle()}},{key:"about-author",link:"https://diygod.me"},{text:"DPlayer v".concat("1.27.1"),link:"https://github.com/MoePlayer/DPlayer"}]),Q}(function(Q){for(var pe=1;pe<arguments.length;pe++){var ge=arguments[pe]!=null?arguments[pe]:{};pe%2?$r(Object(ge),!0).forEach(function(Ve){va(Q,Ve,ge[Ve])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Q,Object.getOwnPropertyDescriptors(ge)):$r(Object(ge)).forEach(function(Ve){Object.defineProperty(Q,Ve,Object.getOwnPropertyDescriptor(ge,Ve))})}return Q}({preload:P.video.type==="webtorrent"?"none":"metadata"},P)),this.options.video.quality&&(this.qualityIndex=this.options.video.defaultQuality,this.quality=this.options.video.quality[this.options.video.defaultQuality]),this.tran=new Ba(this.options.lang).tran,this.events=new pi,this.user=new mr(this),this.container=this.options.container,this.noticeList={},this.container.classList.add("dplayer"),this.options.danmaku||this.container.classList.add("dplayer-no-danmaku"),this.options.live?this.container.classList.add("dplayer-live"):this.container.classList.remove("dplayer-live"),Ie.isMobile&&this.container.classList.add("dplayer-mobile"),this.arrow=this.container.offsetWidth<=500,this.arrow&&this.container.classList.add("dplayer-arrow"),this.options.subtitle&&Array.isArray(this.options.subtitle.url)&&(this.options.subtitle.url.push({subtitle:"",lang:"off"}),this.options.subtitle.defaultSubtitle&&(typeof this.options.subtitle.defaultSubtitle=="string"?this.options.subtitle.index=this.options.subtitle.url.findIndex(function(Q){return Q.lang===F.options.subtitle.defaultSubtitle||Q.name===F.options.subtitle.defaultSubtitle}):typeof this.options.subtitle.defaultSubtitle=="number"&&(this.options.subtitle.index=this.options.subtitle.defaultSubtitle)),(this.options.subtitle.index===-1||!this.options.subtitle.index||this.options.subtitle.index>this.options.subtitle.url.length-1)&&(this.options.subtitle.index=this.options.subtitle.url.findIndex(function(Q){return Q.lang===F.options.lang})),this.options.subtitle.index===-1&&(this.options.subtitle.index=this.options.subtitle.url.length-1)),this.template=new ko({container:this.container,options:this.options,index:Hn,tran:this.tran}),this.video=this.template.video,this.bar=new ni(this.template),this.bezel=new gr(this.template.bezel),this.fullScreen=new Br(this),this.controller=new bs(this),this.options.danmaku&&(this.danmaku=new pa({player:this,container:this.template.danmaku,opacity:this.user.get("opacity"),callback:function(){setTimeout(function(){F.template.danmakuLoading.style.display="none",F.options.autoplay&&F.play()},0)},error:function(Q){F.notice(Q)},apiBackend:this.options.apiBackend,borderColor:this.options.theme,height:this.arrow?24:30,time:function(){return F.video.currentTime},unlimited:this.user.get("unlimited"),api:{id:this.options.danmaku.id,address:this.options.danmaku.api,token:this.options.danmaku.token,maximum:this.options.danmaku.maximum,addition:this.options.danmaku.addition,user:this.options.danmaku.user,speedRate:this.options.danmaku.speedRate},events:this.events,tran:function(Q){return F.tran(Q)}}),this.comment=new ga(this)),this.setting=new Mo(this),this.plugins={},this.docClickFun=function(){F.focus=!1},this.containerClickFun=function(){F.focus=!0},document.addEventListener("click",this.docClickFun,!0),this.container.addEventListener("click",this.containerClickFun,!0),this.paused=!0,this.timer=new As(this),this.hotkey=new ya(this),this.contextmenu=new Ur(this),this.initVideo(this.video,this.quality&&this.quality.type||this.options.video.type),this.infoPanel=new ri(this),!this.danmaku&&this.options.autoplay&&this.play(),Hn++,es.push(this)}var k,q,x;return k=T,q=[{key:"seek",value:function(P){P=Math.max(P,0),this.video.duration&&(P=Math.min(P,this.video.duration)),this.video.currentTime<P?this.notice("".concat(this.tran("ff").replace("%s",(P-this.video.currentTime).toFixed(0)))):this.video.currentTime>P&&this.notice("".concat(this.tran("rew").replace("%s",(this.video.currentTime-P).toFixed(0)))),this.video.currentTime=P,this.danmaku&&this.danmaku.seek(),this.bar.set("played",P/this.video.duration,"width"),this.template.ptime.innerHTML=Ie.secondToTime(P)}},{key:"play",value:function(P){var F=this;if(this.paused=!1,this.video.paused&&!Ie.isMobile&&this.bezel.switch(Rn.play),this.template.playButton.innerHTML=Rn.pause,this.template.mobilePlayButton.innerHTML=Rn.pause,P||we.resolve(this.video.play()).catch(function(){F.pause()}).then(function(){}),this.timer.enable("loading"),this.container.classList.remove("dplayer-paused"),this.container.classList.add("dplayer-playing"),this.danmaku&&this.danmaku.play(),this.options.mutex)for(var Q=0;Q<es.length;Q++)this!==es[Q]&&es[Q].pause()}},{key:"pause",value:function(P){this.paused=!0,this.container.classList.remove("dplayer-loading"),this.video.paused||Ie.isMobile||this.bezel.switch(Rn.pause),this.template.playButton.innerHTML=Rn.play,this.template.mobilePlayButton.innerHTML=Rn.play,P||this.video.pause(),this.timer.disable("loading"),this.container.classList.remove("dplayer-playing"),this.container.classList.add("dplayer-paused"),this.danmaku&&this.danmaku.pause()}},{key:"switchVolumeIcon",value:function(){this.volume()>=.95?this.template.volumeIcon.innerHTML=Rn.volumeUp:this.volume()>0?this.template.volumeIcon.innerHTML=Rn.volumeDown:this.template.volumeIcon.innerHTML=Rn.volumeOff}},{key:"volume",value:function(P,F,Q){if(P=parseFloat(P),!isNaN(P)){P=Math.max(P,0),P=Math.min(P,1),this.bar.set("volume",P,"width");var pe="".concat((100*P).toFixed(0),"%");this.template.volumeBarWrapWrap.dataset.balloon=pe,F||this.user.set("volume",P),Q||this.notice("".concat(this.tran("volume")," ").concat((100*P).toFixed(0),"%"),void 0,void 0,"volume"),this.video.volume=P,this.video.muted&&(this.video.muted=!1),this.switchVolumeIcon()}return this.video.volume}},{key:"toggle",value:function(){this.video.paused?this.play():this.pause()}},{key:"on",value:function(P,F){this.events.on(P,F)}},{key:"switchVideo",value:function(P,F){this.pause(),this.video.poster=P.pic?P.pic:"",this.video.src=P.url,this.initMSE(this.video,P.type||"auto"),F&&(this.template.danmakuLoading.style.display="block",this.bar.set("played",0,"width"),this.bar.set("loaded",0,"width"),this.template.ptime.innerHTML="00:00",this.template.danmaku.innerHTML="",this.danmaku&&this.danmaku.reload({id:F.id,address:F.api,token:F.token,maximum:F.maximum,addition:F.addition,user:F.user}))}},{key:"initMSE",value:function(P,F){var Q=this;if(this.type=F,this.options.video.customType&&this.options.video.customType[F])Object.prototype.toString.call(this.options.video.customType[F])==="[object Function]"?this.options.video.customType[F](this.video,this):console.error("Illegal customType: ".concat(F));else switch(this.type==="auto"&&(/m3u8(#|\?|$)/i.exec(P.src)?this.type="hls":/.flv(#|\?|$)/i.exec(P.src)?this.type="flv":/.mpd(#|\?|$)/i.exec(P.src)?this.type="dash":this.type="normal"),this.type==="hls"&&(P.canPlayType("application/x-mpegURL")||P.canPlayType("application/vnd.apple.mpegURL"))&&(this.type="normal"),this.type){case"hls":if(window.Hls)if(window.Hls.isSupported()){var pe=this.options.pluginOptions.hls,ge=new window.Hls(pe);this.plugins.hls=ge,ge.loadSource(P.src),ge.attachMedia(P),this.events.on("destroy",function(){ge.destroy(),delete Q.plugins.hls})}else this.notice("Error: Hls is not supported.");else this.notice("Error: Can't find Hls.");break;case"flv":if(window.flvjs)if(window.flvjs.isSupported()){var Ve=window.flvjs.createPlayer(Object.assign(this.options.pluginOptions.flv.mediaDataSource||{},{type:"flv",url:P.src}),this.options.pluginOptions.flv.config);this.plugins.flvjs=Ve,Ve.attachMediaElement(P),Ve.load(),this.events.on("destroy",function(){Ve.unload(),Ve.detachMediaElement(),Ve.destroy(),delete Q.plugins.flvjs})}else this.notice("Error: flvjs is not supported.");else this.notice("Error: Can't find flvjs.");break;case"dash":if(window.dashjs){var Ke=window.dashjs.MediaPlayer().create().initialize(P,P.src,!1),vt=this.options.pluginOptions.dash;Ke.updateSettings(vt),this.plugins.dash=Ke,this.events.on("destroy",function(){window.dashjs.MediaPlayer().reset(),delete Q.plugins.dash})}else this.notice("Error: Can't find dashjs.");break;case"webtorrent":if(window.WebTorrent)if(window.WebTorrent.WEBRTC_SUPPORT){this.container.classList.add("dplayer-loading");var bt=this.options.pluginOptions.webtorrent,Ot=new window.WebTorrent(bt);this.plugins.webtorrent=Ot;var Tt=P.src;P.src="",P.preload="metadata",P.addEventListener("durationchange",function(){return Q.container.classList.remove("dplayer-loading")},{once:!0}),Ot.add(Tt,function(At){At.files.find(function(Ft){return Ft.name.endsWith(".mp4")}).renderTo(Q.video,{autoplay:Q.options.autoplay,controls:!1})}),this.events.on("destroy",function(){Ot.remove(Tt),Ot.destroy(),delete Q.plugins.webtorrent})}else this.notice("Error: Webtorrent is not supported.");else this.notice("Error: Can't find Webtorrent.")}}},{key:"initVideo",value:function(P,F){var Q=this;this.initMSE(P,F),this.on("durationchange",function(){P.duration!==1&&P.duration!==1/0&&(Q.template.dtime.innerHTML=Ie.secondToTime(P.duration))}),this.on("progress",function(){var Ve=P.buffered.length?P.buffered.end(P.buffered.length-1)/P.duration:0;Q.bar.set("loaded",Ve,"width")}),this.on("error",function(){Q.video.error&&Q.tran&&Q.notice&&Q.type!=="webtorrent"&&Q.notice(Q.tran("video-failed"))}),this.on("ended",function(){Q.bar.set("played",1,"width"),Q.setting.loop?(Q.seek(0),Q.play()):Q.pause(),Q.danmaku&&(Q.danmaku.danIndex=0)}),this.on("play",function(){Q.paused&&Q.play(!0)}),this.on("pause",function(){Q.paused||Q.pause(!0)}),this.on("timeupdate",function(){Q.bar.set("played",Q.video.currentTime/Q.video.duration,"width");var Ve=Ie.secondToTime(Q.video.currentTime);Q.template.ptime.innerHTML!==Ve&&(Q.template.ptime.innerHTML=Ve)});for(var pe=function(Ve){P.addEventListener(Q.events.videoEvents[Ve],function(Ke){Q.events.trigger(Q.events.videoEvents[Ve],Ke)})},ge=0;ge<this.events.videoEvents.length;ge++)pe(ge);this.volume(this.user.get("volume"),!0,!0),this.options.subtitle&&(this.subtitle=new jl(this.template.subtitle,this.video,this.options.subtitle,this.events),Array.isArray(this.options.subtitle.url)&&(this.subtitles=new js(this)),this.user.get("subtitle")||this.subtitle.hide())}},{key:"switchQuality",value:function(P){var F=this;if(P=typeof P=="string"?parseInt(P):P,this.qualityIndex!==P&&!this.switchingQuality){this.prevIndex=this.qualityIndex,this.qualityIndex=P,this.switchingQuality=!0,this.quality=this.options.video.quality[P],this.template.qualityButton.innerHTML=this.quality.name;var Q=this.video.paused;this.video.pause();var pe=Mn()({current:!1,pic:null,screenshot:this.options.screenshot,preload:"auto",url:this.quality.url,subtitle:this.options.subtitle}),ge=new DOMParser().parseFromString(pe,"text/html").body.firstChild;this.template.videoWrap.insertBefore(ge,this.template.videoWrap.getElementsByTagName("div")[0]),this.prevVideo=this.video,this.video=ge,this.initVideo(this.video,this.quality.type||this.options.video.type),this.seek(this.prevVideo.currentTime),this.notice("".concat(this.tran("switching-quality").replace("%q",this.quality.name)),-1,void 0,"switch-quality"),this.events.trigger("quality_start",this.quality),this.on("canplay",function(){if(F.prevVideo){if(F.video.currentTime!==F.prevVideo.currentTime)return void F.seek(F.prevVideo.currentTime);F.template.videoWrap.removeChild(F.prevVideo),F.video.classList.add("dplayer-video-current"),Q||F.video.play(),F.prevVideo=null,F.notice("".concat(F.tran("switched-quality").replace("%q",F.quality.name)),void 0,void 0,"switch-quality"),F.switchingQuality=!1,F.events.trigger("quality_end")}}),this.on("error",function(){F.video.error&&F.prevVideo&&(F.template.videoWrap.removeChild(F.video),F.video=F.prevVideo,Q||F.video.play(),F.qualityIndex=F.prevIndex,F.quality=F.options.video.quality[F.qualityIndex],F.noticeTime=setTimeout(function(){F.template.notice.style.opacity=0,F.events.trigger("notice_hide")},3e3),F.prevVideo=null,F.switchingQuality=!1)})}}},{key:"notice",value:function(P){var F,Q,pe,ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2e3,Ve=arguments.length>2&&arguments[2]!==void 0?arguments[2]:.8,Ke=arguments.length>3?arguments[3]:void 0;if(Ke&&((F=document.getElementById("dplayer-notice-".concat(Ke)))&&(F.innerHTML=P),this.noticeList[Ke]&&(clearTimeout(this.noticeList[Ke]),this.noticeList[Ke]=null)),!F){var vt=ko.NewNotice(P,Ve,Ke);this.template.noticeList.appendChild(vt),F=vt}this.events.trigger("notice_show",F),ge>0&&(this.noticeList[Ke]=setTimeout((Q=F,pe=this,function(){Q.addEventListener("animationend",function(){pe.template.noticeList.removeChild(Q)}),Q.classList.add("remove-notice"),pe.events.trigger("notice_hide"),pe.noticeList[Ke]=null}),ge))}},{key:"resize",value:function(){this.danmaku&&this.danmaku.resize(),this.controller.thumbnails&&this.controller.thumbnails.resize(160,this.video.videoHeight/this.video.videoWidth*160,this.template.barWrap.offsetWidth),this.events.trigger("resize")}},{key:"speed",value:function(P){this.video.playbackRate=P}},{key:"destroy",value:function(){es.splice(es.indexOf(this),1),this.pause(),document.removeEventListener("click",this.docClickFun,!0),this.container.removeEventListener("click",this.containerClickFun,!0),this.fullScreen.destroy(),this.hotkey.destroy(),this.contextmenu.destroy(),this.controller.destroy(),this.timer.destroy(),this.video.src="",this.container.innerHTML="",this.events.trigger("destroy")}}],x=[{key:"version",get:function(){return"1.27.1"}}],q&&Aa(k.prototype,q),x&&Aa(k,x),Object.defineProperty(k,"prototype",{writable:!1}),T}();const _a=Ar;console.log(`
`.concat(" %c DPlayer v","1.27.1"," ").concat("v1.27.0-12-g4f61091"," %c https://dplayer.diygod.dev ",`
`,`
`),"color: #fadfa3; background: #030307; padding:5px 0;","background: #fadfa3; padding:5px 0;");const jo=_a})(),nt.default})())},89144:function(Xt,Nt,pt){var ut=typeof pt.g!="undefined"?pt.g:typeof window!="undefined"?window:{},le=pt(25893),Ze;typeof document!="undefined"?Ze=document:(Ze=ut["__GLOBAL_DOCUMENT_CACHE@4"],Ze||(Ze=ut["__GLOBAL_DOCUMENT_CACHE@4"]=le)),Xt.exports=Ze},58908:function(Xt,Nt,pt){var ut;typeof window!="undefined"?ut=window:typeof pt.g!="undefined"?ut=pt.g:typeof self!="undefined"?ut=self:ut={},Xt.exports=ut},44756:function(Xt,Nt,pt){"use strict";pt.d(Nt,{ZP:function(){return ss}});function ut(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var le={exports:{}};(function(h,t){(function(n){var a=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,o=/^(?=([^\/?#]*))\1([^]*)$/,u=/(?:\/|^)\.(?=\/)/g,c=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,p={buildAbsoluteURL:function(g,A,_){if(_=_||{},g=g.trim(),A=A.trim(),!A){if(!_.alwaysNormalize)return g;var w=p.parseURL(g);if(!w)throw new Error("Error trying to parse base URL.");return w.path=p.normalizePath(w.path),p.buildURLFromParts(w)}var M=p.parseURL(A);if(!M)throw new Error("Error trying to parse relative URL.");if(M.scheme)return _.alwaysNormalize?(M.path=p.normalizePath(M.path),p.buildURLFromParts(M)):A;var z=p.parseURL(g);if(!z)throw new Error("Error trying to parse base URL.");if(!z.netLoc&&z.path&&z.path[0]!=="/"){var K=o.exec(z.path);z.netLoc=K[1],z.path=K[2]}z.netLoc&&!z.path&&(z.path="/");var Z={scheme:z.scheme,netLoc:M.netLoc,path:null,params:M.params,query:M.query,fragment:M.fragment};if(!M.netLoc&&(Z.netLoc=z.netLoc,M.path[0]!=="/"))if(!M.path)Z.path=z.path,M.params||(Z.params=z.params,M.query||(Z.query=z.query));else{var ne=z.path,xe=ne.substring(0,ne.lastIndexOf("/")+1)+M.path;Z.path=p.normalizePath(xe)}return Z.path===null&&(Z.path=_.alwaysNormalize?p.normalizePath(M.path):M.path),p.buildURLFromParts(Z)},parseURL:function(g){var A=a.exec(g);return A?{scheme:A[1]||"",netLoc:A[2]||"",path:A[3]||"",params:A[4]||"",query:A[5]||"",fragment:A[6]||""}:null},normalizePath:function(g){for(g=g.split("").reverse().join("").replace(u,"");g.length!==(g=g.replace(c,"")).length;);return g.split("").reverse().join("")},buildURLFromParts:function(g){return g.scheme+g.netLoc+g.path+g.params+g.query+g.fragment}};h.exports=p})()})(le);var Ze=le.exports;function Ee(h,t){var n=Object.keys(h);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(h);t&&(a=a.filter(function(o){return Object.getOwnPropertyDescriptor(h,o).enumerable})),n.push.apply(n,a)}return n}function nt(h){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ee(Object(n),!0).forEach(function(a){ve(h,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach(function(a){Object.defineProperty(h,a,Object.getOwnPropertyDescriptor(n,a))})}return h}function me(h,t){if(typeof h!="object"||!h)return h;var n=h[Symbol.toPrimitive];if(n!==void 0){var a=n.call(h,t||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(h)}function Le(h){var t=me(h,"string");return typeof t=="symbol"?t:String(t)}function ve(h,t,n){return t=Le(t),t in h?Object.defineProperty(h,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):h[t]=n,h}function re(){return re=Object.assign?Object.assign.bind():function(h){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(h[a]=n[a])}return h},re.apply(this,arguments)}const ie=Number.isFinite||function(h){return typeof h=="number"&&isFinite(h)},J=Number.isSafeInteger||function(h){return typeof h=="number"&&Math.abs(h)<=D},D=Number.MAX_SAFE_INTEGER||9007199254740991;let v=function(h){return h.MEDIA_ATTACHING="hlsMediaAttaching",h.MEDIA_ATTACHED="hlsMediaAttached",h.MEDIA_DETACHING="hlsMediaDetaching",h.MEDIA_DETACHED="hlsMediaDetached",h.BUFFER_RESET="hlsBufferReset",h.BUFFER_CODECS="hlsBufferCodecs",h.BUFFER_CREATED="hlsBufferCreated",h.BUFFER_APPENDING="hlsBufferAppending",h.BUFFER_APPENDED="hlsBufferAppended",h.BUFFER_EOS="hlsBufferEos",h.BUFFER_FLUSHING="hlsBufferFlushing",h.BUFFER_FLUSHED="hlsBufferFlushed",h.MANIFEST_LOADING="hlsManifestLoading",h.MANIFEST_LOADED="hlsManifestLoaded",h.MANIFEST_PARSED="hlsManifestParsed",h.LEVEL_SWITCHING="hlsLevelSwitching",h.LEVEL_SWITCHED="hlsLevelSwitched",h.LEVEL_LOADING="hlsLevelLoading",h.LEVEL_LOADED="hlsLevelLoaded",h.LEVEL_UPDATED="hlsLevelUpdated",h.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",h.LEVELS_UPDATED="hlsLevelsUpdated",h.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",h.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",h.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",h.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",h.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",h.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",h.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",h.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",h.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",h.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",h.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",h.CUES_PARSED="hlsCuesParsed",h.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",h.INIT_PTS_FOUND="hlsInitPtsFound",h.FRAG_LOADING="hlsFragLoading",h.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",h.FRAG_LOADED="hlsFragLoaded",h.FRAG_DECRYPTED="hlsFragDecrypted",h.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",h.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",h.FRAG_PARSING_METADATA="hlsFragParsingMetadata",h.FRAG_PARSED="hlsFragParsed",h.FRAG_BUFFERED="hlsFragBuffered",h.FRAG_CHANGED="hlsFragChanged",h.FPS_DROP="hlsFpsDrop",h.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",h.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",h.ERROR="hlsError",h.DESTROYING="hlsDestroying",h.KEY_LOADING="hlsKeyLoading",h.KEY_LOADED="hlsKeyLoaded",h.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",h.BACK_BUFFER_REACHED="hlsBackBufferReached",h.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",h}({}),$=function(h){return h.NETWORK_ERROR="networkError",h.MEDIA_ERROR="mediaError",h.KEY_SYSTEM_ERROR="keySystemError",h.MUX_ERROR="muxError",h.OTHER_ERROR="otherError",h}({}),I=function(h){return h.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",h.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",h.KEY_SYSTEM_NO_SESSION="keySystemNoSession",h.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",h.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",h.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",h.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",h.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",h.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",h.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",h.MANIFEST_LOAD_ERROR="manifestLoadError",h.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",h.MANIFEST_PARSING_ERROR="manifestParsingError",h.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",h.LEVEL_EMPTY_ERROR="levelEmptyError",h.LEVEL_LOAD_ERROR="levelLoadError",h.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",h.LEVEL_PARSING_ERROR="levelParsingError",h.LEVEL_SWITCH_ERROR="levelSwitchError",h.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",h.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",h.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",h.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",h.FRAG_LOAD_ERROR="fragLoadError",h.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",h.FRAG_DECRYPT_ERROR="fragDecryptError",h.FRAG_PARSING_ERROR="fragParsingError",h.FRAG_GAP="fragGap",h.REMUX_ALLOC_ERROR="remuxAllocError",h.KEY_LOAD_ERROR="keyLoadError",h.KEY_LOAD_TIMEOUT="keyLoadTimeOut",h.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",h.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",h.BUFFER_APPEND_ERROR="bufferAppendError",h.BUFFER_APPENDING_ERROR="bufferAppendingError",h.BUFFER_STALLED_ERROR="bufferStalledError",h.BUFFER_FULL_ERROR="bufferFullError",h.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",h.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",h.INTERNAL_EXCEPTION="internalException",h.INTERNAL_ABORTED="aborted",h.UNKNOWN="unknown",h}({});const H=function(){},X={trace:H,debug:H,log:H,warn:H,info:H,error:H};let O=X;function G(h){const t=self.console[h];return t?t.bind(self.console,`[${h}] >`):H}function j(h,...t){t.forEach(function(n){O[n]=h[n]?h[n].bind(h):G(n)})}function V(h,t){if(typeof console=="object"&&h===!0||typeof h=="object"){j(h,"debug","log","info","warn","error");try{O.log(`Debug logs enabled for "${t}" in hls.js version 1.5.7`)}catch(n){O=X}}else O=X}const S=O,ee=/^(\d+)x(\d+)$/,se=/(.+?)=(".*?"|.*?)(?:,|$)/g;class ue{constructor(t){typeof t=="string"&&(t=ue.parseAttrList(t)),re(this,t)}get clientAttrs(){return Object.keys(this).filter(t=>t.substring(0,2)==="X-")}decimalInteger(t){const n=parseInt(this[t],10);return n>Number.MAX_SAFE_INTEGER?Infinity:n}hexadecimalInteger(t){if(this[t]){let n=(this[t]||"0x").slice(2);n=(n.length&1?"0":"")+n;const a=new Uint8Array(n.length/2);for(let o=0;o<n.length/2;o++)a[o]=parseInt(n.slice(o*2,o*2+2),16);return a}else return null}hexadecimalIntegerAsNumber(t){const n=parseInt(this[t],16);return n>Number.MAX_SAFE_INTEGER?Infinity:n}decimalFloatingPoint(t){return parseFloat(this[t])}optionalFloat(t,n){const a=this[t];return a?parseFloat(a):n}enumeratedString(t){return this[t]}bool(t){return this[t]==="YES"}decimalResolution(t){const n=ee.exec(this[t]);if(n!==null)return{width:parseInt(n[1],10),height:parseInt(n[2],10)}}static parseAttrList(t){let n;const a={},o='"';for(se.lastIndex=0;(n=se.exec(t))!==null;){let u=n[2];u.indexOf(o)===0&&u.lastIndexOf(o)===u.length-1&&(u=u.slice(1,-1));const c=n[1].trim();a[c]=u}return a}}function U(h){return h!=="ID"&&h!=="CLASS"&&h!=="START-DATE"&&h!=="DURATION"&&h!=="END-DATE"&&h!=="END-ON-NEXT"}function Y(h){return h==="SCTE35-OUT"||h==="SCTE35-IN"}class ae{constructor(t,n){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,n){const a=n.attr;for(const o in a)if(Object.prototype.hasOwnProperty.call(t,o)&&t[o]!==a[o]){S.warn(`DATERANGE tag attribute: "${o}" does not match for tags with ID: "${t.ID}"`),this._badValueForSameId=o;break}t=re(new ue({}),a,t)}if(this.attr=t,this._startDate=new Date(t["START-DATE"]),"END-DATE"in this.attr){const a=new Date(this.attr["END-DATE"]);ie(a.getTime())&&(this._endDate=a)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const t=this.duration;return t!==null?new Date(this._startDate.getTime()+t*1e3):null}get duration(){if("DURATION"in this.attr){const t=this.attr.decimalFloatingPoint("DURATION");if(ie(t))return t}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&ie(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class fe{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var Ae={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class Re{constructor(t){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[Ae.AUDIO]:null,[Ae.VIDEO]:null,[Ae.AUDIOVIDEO]:null},this.baseurl=t}setByteRange(t,n){const a=t.split("@",2);let o;a.length===1?o=(n==null?void 0:n.byteRangeEndOffset)||0:o=parseInt(a[1]),this._byteRange=[o,parseInt(a[0])+o]}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Ze.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(t){this._url=t}}class Ce extends Re{constructor(t,n){super(n);this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new fe,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=t}get decryptdata(){const{levelkeys:t}=this;if(!t&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const n=this.levelkeys.identity;if(n)this._decryptdata=n.getDecryptData(this.sn);else{const a=Object.keys(this.levelkeys);if(a.length===1)return this._decryptdata=this.levelkeys[a[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null||!ie(this.programDateTime))return null;const t=ie(this.duration)?this.duration:0;return this.programDateTime+t*1e3}get encrypted(){var t;if((t=this._decryptdata)!=null&&t.encrypted)return!0;if(this.levelkeys){const n=Object.keys(this.levelkeys),a=n.length;if(a>1||a===1&&this.levelkeys[n[0]].encrypted)return!0}return!1}setKeyFormat(t){if(this.levelkeys){const n=this.levelkeys[t];n&&!this._decryptdata&&(this._decryptdata=n.getDecryptData(this.sn))}}abortRequests(){var t,n;(t=this.loader)==null||t.abort(),(n=this.keyLoader)==null||n.abort()}setElementaryStreamInfo(t,n,a,o,u,c=!1){const{elementaryStreams:p}=this,g=p[t];if(!g){p[t]={startPTS:n,endPTS:a,startDTS:o,endDTS:u,partial:c};return}g.startPTS=Math.min(g.startPTS,n),g.endPTS=Math.max(g.endPTS,a),g.startDTS=Math.min(g.startDTS,o),g.endDTS=Math.max(g.endDTS,u)}clearElementaryStreamInfo(){const{elementaryStreams:t}=this;t[Ae.AUDIO]=null,t[Ae.VIDEO]=null,t[Ae.AUDIOVIDEO]=null}}class we extends Re{constructor(t,n,a,o,u){super(a);this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new fe,this.duration=t.decimalFloatingPoint("DURATION"),this.gap=t.bool("GAP"),this.independent=t.bool("INDEPENDENT"),this.relurl=t.enumeratedString("URI"),this.fragment=n,this.index=o;const c=t.enumeratedString("BYTERANGE");c&&this.setByteRange(c,u),u&&(this.fragOffset=u.fragOffset+u.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:t}=this;return!!(t.audio||t.video||t.audiovideo)}}const Fe=10;class Ie{constructor(t){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=t}reloaded(t){if(!t){this.advanced=!0,this.updated=!0;return}const n=this.lastPartSn-t.lastPartSn,a=this.lastPartIndex-t.lastPartIndex;this.updated=this.endSN!==t.endSN||!!a||!!n||!this.live,this.advanced=this.endSN>t.endSN||n>0||n===0&&a>0,this.updated||this.advanced?this.misses=Math.floor(t.misses*.6):this.misses=t.misses+1,this.availabilityDelay=t.availabilityDelay}get hasProgramDateTime(){return this.fragments.length?ie(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||Fe}get drift(){const t=this.driftEndTime-this.driftStartTime;return t>0?(this.driftEnd-this.driftStart)*1e3/t:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var t;return(t=this.partList)!=null&&t.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var t;return(t=this.fragments)!=null&&t.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var t;return(t=this.partList)!=null&&t.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var t;return(t=this.partList)!=null&&t.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function $e(h){return Uint8Array.from(atob(h),t=>t.charCodeAt(0))}function Oe(h){const t=Rt(h).subarray(0,16),n=new Uint8Array(16);return n.set(t,16-t.length),n}function ht(h){const t=function(a,o,u){const c=a[o];a[o]=a[u],a[u]=c};t(h,0,3),t(h,1,2),t(h,4,5),t(h,6,7)}function kt(h){const t=h.split(":");let n=null;if(t[0]==="data"&&t.length===2){const a=t[1].split(";"),o=a[a.length-1].split(",");if(o.length===2){const u=o[0]==="base64",c=o[1];u?(a.splice(-1,1),n=$e(c)):n=Oe(c)}}return n}function Rt(h){return Uint8Array.from(unescape(encodeURIComponent(h)),t=>t.charCodeAt(0))}const mt=typeof self!="undefined"?self:void 0;var rt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Kt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function _t(h){switch(h){case Kt.FAIRPLAY:return rt.FAIRPLAY;case Kt.PLAYREADY:return rt.PLAYREADY;case Kt.WIDEVINE:return rt.WIDEVINE;case Kt.CLEARKEY:return rt.CLEARKEY}}var Gt={WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function li(h){if(h===Gt.WIDEVINE)return rt.WIDEVINE}function ei(h){switch(h){case rt.FAIRPLAY:return Kt.FAIRPLAY;case rt.PLAYREADY:return Kt.PLAYREADY;case rt.WIDEVINE:return Kt.WIDEVINE;case rt.CLEARKEY:return Kt.CLEARKEY}}function Ti(h){const{drmSystems:t,widevineLicenseUrl:n}=h,a=t?[rt.FAIRPLAY,rt.WIDEVINE,rt.PLAYREADY,rt.CLEARKEY].filter(o=>!!t[o]):[];return!a[rt.WIDEVINE]&&n&&a.push(rt.WIDEVINE),a}const vi=function(h){return mt!=null&&(h=mt.navigator)!=null&&h.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function Et(h,t,n,a){let o;switch(h){case rt.FAIRPLAY:o=["cenc","sinf"];break;case rt.WIDEVINE:case rt.PLAYREADY:o=["cenc"];break;case rt.CLEARKEY:o=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${h}`)}return oi(o,t,n,a)}function oi(h,t,n,a){return[{initDataTypes:h,persistentState:a.persistentState||"optional",distinctiveIdentifier:a.distinctiveIdentifier||"optional",sessionTypes:a.sessionTypes||[a.sessionType||"temporary"],audioCapabilities:t.map(u=>({contentType:`audio/mp4; codecs="${u}"`,robustness:a.audioRobustness||"",encryptionScheme:a.audioEncryptionScheme||null})),videoCapabilities:n.map(u=>({contentType:`video/mp4; codecs="${u}"`,robustness:a.videoRobustness||"",encryptionScheme:a.videoEncryptionScheme||null}))}]}function ai(h,t,n){return Uint8Array.prototype.slice?h.slice(t,n):new Uint8Array(Array.prototype.slice.call(h,t,n))}const zi=(h,t)=>t+10<=h.length&&h[t]===73&&h[t+1]===68&&h[t+2]===51&&h[t+3]<255&&h[t+4]<255&&h[t+6]<128&&h[t+7]<128&&h[t+8]<128&&h[t+9]<128,mn=(h,t)=>t+10<=h.length&&h[t]===51&&h[t+1]===68&&h[t+2]===73&&h[t+3]<255&&h[t+4]<255&&h[t+6]<128&&h[t+7]<128&&h[t+8]<128&&h[t+9]<128,Gi=(h,t)=>{const n=t;let a=0;for(;zi(h,t);)a+=10,a+=en(h,t+6),mn(h,t+10)&&(a+=10),t+=a;if(a>0)return h.subarray(n,n+a)},en=(h,t)=>{let n=0;return n=(h[t]&127)<<21,n|=(h[t+1]&127)<<14,n|=(h[t+2]&127)<<7,n|=h[t+3]&127,n},ln=(h,t)=>zi(h,t)&&en(h,t+6)+10<=h.length-t,gt=h=>{const t=ui(h);for(let n=0;n<t.length;n++){const a=t[n];if(Ai(a))return Rs(a)}},Ai=h=>h&&h.key==="PRIV"&&h.info==="com.apple.streaming.transportStreamTimestamp",ki=h=>{const t=String.fromCharCode(h[0],h[1],h[2],h[3]),n=en(h,4),a=10;return{type:t,size:n,data:h.subarray(a,a+n)}},ui=h=>{let t=0;const n=[];for(;zi(h,t);){const a=en(h,t+6);t+=10;const o=t+a;for(;t+8<o;){const u=ki(h.subarray(t)),c=Ln(u);c&&n.push(c),t+=u.size+10}mn(h,t)&&(t+=10)}return n},Ln=h=>h.type==="PRIV"?Kr(h):h.type[0]==="W"?rn(h):Is(h),Kr=h=>{if(h.size<2)return;const t=Ye(h.data,!0),n=new Uint8Array(h.data.subarray(t.length+1));return{key:h.type,info:t,data:n.buffer}},Is=h=>{if(h.size<2)return;if(h.type==="TXXX"){let n=1;const a=Ye(h.data.subarray(n),!0);n+=a.length+1;const o=Ye(h.data.subarray(n));return{key:h.type,info:a,data:o}}const t=Ye(h.data.subarray(1));return{key:h.type,data:t}},rn=h=>{if(h.type==="WXXX"){if(h.size<2)return;let n=1;const a=Ye(h.data.subarray(n),!0);n+=a.length+1;const o=Ye(h.data.subarray(n));return{key:h.type,info:a,data:o}}const t=Ye(h.data);return{key:h.type,data:t}},Rs=h=>{if(h.data.byteLength===8){const t=new Uint8Array(h.data),n=t[3]&1;let a=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return a/=45,n&&(a+=4772185884e-2),Math.round(a)}},Ye=(h,t=!1)=>{const n=yt();if(n){const A=n.decode(h);if(t){const _=A.indexOf("\0");return _!==-1?A.substring(0,_):A}return A.replace(/\0/g,"")}const a=h.length;let o,u,c,p="",g=0;for(;g<a;){if(o=h[g++],o===0&&t)return p;if(o===0||o===3)continue;switch(o>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:p+=String.fromCharCode(o);break;case 12:case 13:u=h[g++],p+=String.fromCharCode((o&31)<<6|u&63);break;case 14:u=h[g++],c=h[g++],p+=String.fromCharCode((o&15)<<12|(u&63)<<6|(c&63)<<0);break}}return p};let De;function yt(){if(!navigator.userAgent.includes("PlayStation 4"))return!De&&typeof self.TextDecoder!="undefined"&&(De=new self.TextDecoder("utf-8")),De}const Ct={hexDump:function(h){let t="";for(let n=0;n<h.length;n++){let a=h[n].toString(16);a.length<2&&(a="0"+a),t+=a}return t}},wt=Math.pow(2,32)-1,Dt=[].push,Ni={video:1,audio:2,id3:3,text:4};function fi(h){return String.fromCharCode.apply(null,h)}function Dn(h,t){const n=h[t]<<8|h[t+1];return n<0?65536+n:n}function Ut(h,t){const n=Ps(h,t);return n<0?4294967296+n:n}function Xn(h,t){let n=Ut(h,t);return n*=Math.pow(2,32),n+=Ut(h,t+4),n}function Ps(h,t){return h[t]<<24|h[t+1]<<16|h[t+2]<<8|h[t+3]}function ur(h,t,n){h[t]=n>>24,h[t+1]=n>>16&255,h[t+2]=n>>8&255,h[t+3]=n&255}function Lr(h){const t=h.byteLength;for(let n=0;n<t;){const a=Ut(h,n);if(a>8&&h[n+4]===109&&h[n+5]===111&&h[n+6]===111&&h[n+7]===102)return!0;n=a>1?n+a:t}return!1}function Mt(h,t){const n=[];if(!t.length)return n;const a=h.byteLength;for(let o=0;o<a;){const u=Ut(h,o),c=fi(h.subarray(o+4,o+8)),p=u>1?o+u:a;if(c===t[0])if(t.length===1)n.push(h.subarray(o+8,p));else{const g=Mt(h.subarray(o+8,p),t.slice(1));g.length&&Dt.apply(n,g)}o=p}return n}function ls(h){const t=[],n=h[0];let a=8;const o=Ut(h,a);a+=4;let u=0,c=0;n===0?(u=Ut(h,a),c=Ut(h,a+4),a+=8):(u=Xn(h,a),c=Xn(h,a+8),a+=16),a+=2;let p=h.length+c;const g=Dn(h,a);a+=2;for(let A=0;A<g;A++){let _=a;const w=Ut(h,_);_+=4;const M=w&2147483647;if((w&2147483648)>>>31===1)return S.warn("SIDX has hierarchical references (not supported)"),null;const K=Ut(h,_);_+=4,t.push({referenceSize:M,subsegmentDuration:K,info:{duration:K/o,start:p,end:p+M-1}}),p+=M,_+=4,a=_}return{earliestPresentationTime:u,timescale:o,version:n,referencesCount:g,references:t}}function us(h){const t=[],n=Mt(h,["moov","trak"]);for(let o=0;o<n.length;o++){const u=n[o],c=Mt(u,["tkhd"])[0];if(c){let p=c[0];const g=Ut(c,p===0?12:20),A=Mt(u,["mdia","mdhd"])[0];if(A){p=A[0];const _=Ut(A,p===0?12:20),w=Mt(u,["mdia","hdlr"])[0];if(w){const M=fi(w.subarray(8,12)),z={soun:Ae.AUDIO,vide:Ae.VIDEO}[M];if(z){const K=Mt(u,["mdia","minf","stbl","stsd"])[0],Z=dr(K);t[g]={timescale:_,type:z},t[z]=nt({timescale:_,id:g},Z)}}}}}return Mt(h,["moov","mvex","trex"]).forEach(o=>{const u=Ut(o,4),c=t[u];c&&(c.default={duration:Ut(o,12),flags:Ut(o,20)})}),t}function dr(h){const t=h.subarray(8),n=t.subarray(8+78),a=fi(t.subarray(4,8));let o=a;const u=a==="enca"||a==="encv";if(u){const p=Mt(t,[a])[0].subarray(a==="enca"?28:78);Mt(p,["sinf"]).forEach(A=>{const _=Mt(A,["schm"])[0];if(_){const w=fi(_.subarray(4,8));if(w==="cbcs"||w==="cenc"){const M=Mt(A,["frma"])[0];M&&(o=fi(M))}}})}switch(o){case"avc1":case"avc2":case"avc3":case"avc4":{const c=Mt(n,["avcC"])[0];o+="."+vn(c[1])+vn(c[2])+vn(c[3]);break}case"mp4a":{const c=Mt(t,[a])[0],p=Mt(c.subarray(28),["esds"])[0];if(p&&p.length>12){let g=4;if(p[g++]!==3)break;g=cr(p,g),g+=2;const A=p[g++];if(A&128&&(g+=2),A&64&&(g+=p[g++]),p[g++]!==4)break;g=cr(p,g);const _=p[g++];if(_===64)o+="."+vn(_);else break;if(g+=12,p[g++]!==5)break;g=cr(p,g);const w=p[g++];let M=(w&248)>>3;M===31&&(M+=1+((w&7)<<3)+((p[g]&224)>>5)),o+="."+M}break}case"hvc1":case"hev1":{const c=Mt(n,["hvcC"])[0],p=c[1],g=["","A","B","C"][p>>6],A=p&31,_=Ut(c,2),w=(p&32)>>5?"H":"L",M=c[12],z=c.subarray(6,12);o+="."+g+A,o+="."+_.toString(16).toUpperCase(),o+="."+w+M;let K="";for(let Z=z.length;Z--;){const ne=z[Z];if(ne||K){const xe=ne.toString(16).toUpperCase();K="."+xe+K}}o+=K;break}case"dvh1":case"dvhe":{const c=Mt(n,["dvcC"])[0],p=c[2]>>1&127,g=c[2]<<5&32|c[3]>>3&31;o+="."+kn(p)+"."+kn(g);break}case"vp09":{const c=Mt(n,["vpcC"])[0],p=c[4],g=c[5],A=c[6]>>4&15;o+="."+kn(p)+"."+kn(g)+"."+kn(A);break}case"av01":{const c=Mt(n,["av1C"])[0],p=c[1]>>>5,g=c[1]&31,A=c[2]>>>7?"H":"M",_=(c[2]&64)>>6,w=(c[2]&32)>>5,M=p===2&&_?w?12:10:_?10:8,z=(c[2]&16)>>4,K=(c[2]&8)>>3,Z=(c[2]&4)>>2,ne=c[2]&3,xe=1,de=1,Be=1,Qe=0;o+="."+p+"."+kn(g)+A+"."+kn(M)+"."+z+"."+K+Z+ne+"."+kn(xe)+"."+kn(de)+"."+kn(Be)+"."+Qe;break}}return{codec:o,encrypted:u}}function cr(h,t){const n=t+5;for(;h[t++]&128&&t<n;);return t}function vn(h){return("0"+h.toString(16).toUpperCase()).slice(-2)}function kn(h){return(h<10?"0":"")+h}function Qn(h,t){if(!h||!t)return h;const n=t.keyId;return n&&t.isCommonEncryption&&Mt(h,["moov","trak"]).forEach(o=>{const c=Mt(o,["mdia","minf","stbl","stsd"])[0].subarray(8);let p=Mt(c,["enca"]);const g=p.length>0;g||(p=Mt(c,["encv"])),p.forEach(A=>{const _=g?A.subarray(28):A.subarray(78);Mt(_,["sinf"]).forEach(M=>{const z=Jn(M);if(z){const K=z.subarray(8,24);K.some(Z=>Z!==0)||(S.log(`[eme] Patching keyId in 'enc${g?"a":"v"}>sinf>>tenc' box: ${Ct.hexDump(K)} -> ${Ct.hexDump(n)}`),z.set(n,8))}})})}),h}function Jn(h){const t=Mt(h,["schm"])[0];if(t){const n=fi(t.subarray(4,8));if(n==="cbcs"||n==="cenc")return Mt(h,["schi","tenc"])[0]}return S.error("[eme] missing 'schm' box"),null}function Ao(h,t){return Mt(t,["moof","traf"]).reduce((n,a)=>{const o=Mt(a,["tfdt"])[0],u=o[0],c=Mt(a,["tfhd"]).reduce((p,g)=>{const A=Ut(g,4),_=h[A];if(_){let w=Ut(o,4);if(u===1){if(w===wt)return S.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),p;w*=wt+1,w+=Ut(o,8)}const M=_.timescale||9e4,z=w/M;if(ie(z)&&(p===null||z<p))return z}return p},null);return c!==null&&ie(c)&&(n===null||c<n)?c:n},null)}function te(h,t){let n=0,a=0,o=0;const u=Mt(h,["moof","traf"]);for(let c=0;c<u.length;c++){const p=u[c],g=Mt(p,["tfhd"])[0],A=Ut(g,4),_=t[A];if(!_)continue;const w=_.default,M=Ut(g,0)|(w==null?void 0:w.flags);let z=w==null?void 0:w.duration;M&8&&(M&2?z=Ut(g,12):z=Ut(g,8));const K=_.timescale||9e4,Z=Mt(p,["trun"]);for(let ne=0;ne<Z.length;ne++){if(n=oe(Z[ne]),!n&&z){const xe=Ut(Z[ne],4);n=z*xe}_.type===Ae.VIDEO?a+=n/K:_.type===Ae.AUDIO&&(o+=n/K)}}if(a===0&&o===0){let c=Infinity,p=0,g=0;const A=Mt(h,["sidx"]);for(let _=0;_<A.length;_++){const w=ls(A[_]);if(w!=null&&w.references){c=Math.min(c,w.earliestPresentationTime/w.timescale);const M=w.references.reduce((z,K)=>z+K.info.duration||0,0);p=Math.max(p,M+w.earliestPresentationTime/w.timescale),g=p-c}}if(g&&ie(g))return g}return a||o}function oe(h){const t=Ut(h,0);let n=8;t&1&&(n+=4),t&4&&(n+=4);let a=0;const o=Ut(h,4);for(let u=0;u<o;u++)t&256&&(a+=Ut(h,n),n+=4),t&512&&(n+=4),t&1024&&(n+=4),t&2048&&(n+=4);return a}function Se(h,t,n){Mt(t,["moof","traf"]).forEach(a=>{Mt(a,["tfhd"]).forEach(o=>{const u=Ut(o,4),c=h[u];if(!c)return;const p=c.timescale||9e4;Mt(a,["tfdt"]).forEach(g=>{const A=g[0],_=n*p;if(_){let w=Ut(g,4);if(A===0)w-=_,w=Math.max(w,0),ur(g,4,w);else{w*=Math.pow(2,32),w+=Ut(g,8),w-=_,w=Math.max(w,0);const M=Math.floor(w/(wt+1)),z=Math.floor(w%(wt+1));ur(g,4,M),ur(g,8,z)}}})})})}function qe(h){const t={valid:null,remainder:null},n=Mt(h,["moof"]);if(n.length<2)return t.remainder=h,t;const a=n[n.length-1];return t.valid=ai(h,0,a.byteOffset-8),t.remainder=ai(h,a.byteOffset-8),t}function ft(h,t){const n=new Uint8Array(h.length+t.length);return n.set(h),n.set(t,h.length),n}function jt(h,t){const n=[],a=t.samples,o=t.timescale,u=t.id;let c=!1;return Mt(a,["moof"]).map(g=>{const A=g.byteOffset-8;Mt(g,["traf"]).map(w=>{const M=Mt(w,["tfdt"]).map(z=>{const K=z[0];let Z=Ut(z,4);return K===1&&(Z*=Math.pow(2,32),Z+=Ut(z,8)),Z/o})[0];return M!==void 0&&(h=M),Mt(w,["tfhd"]).map(z=>{const K=Ut(z,4),Z=Ut(z,0)&16777215,ne=(Z&1)!=0,xe=(Z&2)!=0,de=(Z&8)!=0;let Be=0;const Qe=(Z&16)!=0;let Ne=0;const lt=(Z&32)!=0;let Xe=8;K===u&&(ne&&(Xe+=8),xe&&(Xe+=4),de&&(Be=Ut(z,Xe),Xe+=4),Qe&&(Ne=Ut(z,Xe),Xe+=4),lt&&(Xe+=4),t.type==="video"&&(c=Si(t.codec)),Mt(w,["trun"]).map(ct=>{const Lt=ct[0],et=Ut(ct,0)&16777215,st=(et&1)!=0;let Ht=0;const St=(et&4)!=0,zt=(et&256)!=0;let Zt=0;const qt=(et&512)!=0;let hi=0;const Bi=(et&1024)!=0,$t=(et&2048)!=0;let Bt=0;const Ei=Ut(ct,4);let ti=8;st&&(Ht=Ut(ct,ti),ti+=4),St&&(ti+=4);let Di=Ht+A;for(let tn=0;tn<Ei;tn++){if(zt?(Zt=Ut(ct,ti),ti+=4):Zt=Be,qt?(hi=Ut(ct,ti),ti+=4):hi=Ne,Bi&&(ti+=4),$t&&(Lt===0?Bt=Ut(ct,ti):Bt=Ps(ct,ti),ti+=4),t.type===Ae.VIDEO){let sn=0;for(;sn<hi;){const hn=Ut(a,Di);if(Di+=4,Ii(c,a[Di])){const Nn=a.subarray(Di,Di+hn);un(Nn,c?2:1,h+Bt/o,n)}Di+=hn,sn+=hn+4}}h+=Zt/o}}))})})}),n}function Si(h){if(!h)return!1;const t=h.indexOf("."),n=t<0?h:h.substring(0,t);return n==="hvc1"||n==="hev1"||n==="dvh1"||n==="dvhe"}function Ii(h,t){if(h){const n=t>>1&63;return n===39||n===40}else return(t&31)===6}function un(h,t,n,a){const o=gn(h);let u=0;u+=t;let c=0,p=0,g=0;for(;u<o.length;){c=0;do{if(u>=o.length)break;g=o[u++],c+=g}while(g===255);p=0;do{if(u>=o.length)break;g=o[u++],p+=g}while(g===255);const A=o.length-u;let _=u;if(p<A)u+=p;else if(p>A){S.error(`Malformed SEI payload. ${p} is too small, only ${A} bytes left to parse.`);break}if(c===4){if(o[_++]===181){const M=Dn(o,_);if(_+=2,M===49){const z=Ut(o,_);if(_+=4,z===1195456820){const K=o[_++];if(K===3){const Z=o[_++],ne=31&Z,xe=64&Z,de=xe?2+ne*3:0,Be=new Uint8Array(de);if(xe){Be[0]=Z;for(let Qe=1;Qe<de;Qe++)Be[Qe]=o[_++]}a.push({type:K,payloadType:c,pts:n,bytes:Be})}}}}}else if(c===5&&p>16){const w=[];for(let K=0;K<16;K++){const Z=o[_++].toString(16);w.push(Z.length==1?"0"+Z:Z),(K===3||K===5||K===7||K===9)&&w.push("-")}const M=p-16,z=new Uint8Array(M);for(let K=0;K<M;K++)z[K]=o[_++];a.push({payloadType:c,pts:n,uuid:w.join(""),userData:Ye(z),userDataBytes:z})}}}function gn(h){const t=h.byteLength,n=[];let a=1;for(;a<t-2;)h[a]===0&&h[a+1]===0&&h[a+2]===3?(n.push(a+2),a+=2):a++;if(n.length===0)return h;const o=t-n.length,u=new Uint8Array(o);let c=0;for(a=0;a<o;c++,a++)c===n[0]&&(c++,n.shift()),u[a]=h[c];return u}function In(h){const t=h[0];let n="",a="",o=0,u=0,c=0,p=0,g=0,A=0;if(t===0){for(;fi(h.subarray(A,A+1))!=="\0";)n+=fi(h.subarray(A,A+1)),A+=1;for(n+=fi(h.subarray(A,A+1)),A+=1;fi(h.subarray(A,A+1))!=="\0";)a+=fi(h.subarray(A,A+1)),A+=1;a+=fi(h.subarray(A,A+1)),A+=1,o=Ut(h,12),u=Ut(h,16),p=Ut(h,20),g=Ut(h,24),A=28}else if(t===1){A+=4,o=Ut(h,A),A+=4;const w=Ut(h,A);A+=4;const M=Ut(h,A);for(A+=4,c=i0(2,32)*w+M,J(c)||(c=Number.MAX_SAFE_INTEGER,S.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),p=Ut(h,A),A+=4,g=Ut(h,A),A+=4;fi(h.subarray(A,A+1))!=="\0";)n+=fi(h.subarray(A,A+1)),A+=1;for(n+=fi(h.subarray(A,A+1)),A+=1;fi(h.subarray(A,A+1))!=="\0";)a+=fi(h.subarray(A,A+1)),A+=1;a+=fi(h.subarray(A,A+1)),A+=1}const _=h.subarray(A,h.byteLength);return{schemeIdUri:n,value:a,timeScale:o,presentationTime:c,presentationTimeDelta:u,eventDuration:p,id:g,payload:_}}function jn(h,...t){const n=t.length;let a=8,o=n;for(;o--;)a+=t[o].byteLength;const u=new Uint8Array(a);for(u[0]=a>>24&255,u[1]=a>>16&255,u[2]=a>>8&255,u[3]=a&255,u.set(h,4),o=0,a=8;o<n;o++)u.set(t[o],a),a+=t[o].byteLength;return u}function Zn(h,t,n){if(h.byteLength!==16)throw new RangeError("Invalid system id");let a,o;if(t){a=1,o=new Uint8Array(t.length*16);for(let p=0;p<t.length;p++){const g=t[p];if(g.byteLength!==16)throw new RangeError("Invalid key");o.set(g,p*16)}}else a=0,o=new Uint8Array;let u;a>0?(u=new Uint8Array(4),t.length>0&&new DataView(u.buffer).setUint32(0,t.length,!1)):u=new Uint8Array;const c=new Uint8Array(4);return n&&n.byteLength>0&&new DataView(c.buffer).setUint32(0,n.byteLength,!1),jn([112,115,115,104],new Uint8Array([a,0,0,0]),h,u,o,c,n||new Uint8Array)}function er(h){if(!(h instanceof ArrayBuffer)||h.byteLength<32)return null;const t={version:0,systemId:"",kids:null,data:null},n=new DataView(h),a=n.getUint32(0);if(h.byteLength!==a&&a>44||n.getUint32(4)!==1886614376||(t.version=n.getUint32(8)>>>24,t.version>1))return null;t.systemId=Ct.hexDump(new Uint8Array(h,12,16));const u=n.getUint32(28);if(t.version===0){if(a-32<u)return null;t.data=new Uint8Array(h,32,u)}else if(t.version===1){t.kids=[];for(let c=0;c<u;c++)t.kids.push(new Uint8Array(h,32+c*16,16))}return t}let yn={};class Hi{static clearKeyUriToKeyIdMap(){yn={}}constructor(t,n,a,o=[1],u=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=t,this.uri=n,this.keyFormat=a,this.keyFormatVersions=o,this.iv=u,this.encrypted=t?t!=="NONE":!1,this.isCommonEncryption=this.encrypted&&t!=="AES-128"}isSupported(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Kt.FAIRPLAY:case Kt.WIDEVINE:case Kt.PLAYREADY:case Kt.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(t){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof t!="number"&&(this.method==="AES-128"&&!this.iv&&S.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),t=0);const a=Tn(t);return new Hi(this.method,this.uri,"identity",this.keyFormatVersions,a)}const n=kt(this.uri);if(n)switch(this.keyFormat){case Kt.WIDEVINE:this.pssh=n,n.length>=22&&(this.keyId=n.subarray(n.length-22,n.length-6));break;case Kt.PLAYREADY:{const a=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=Zn(a,null,n);const o=new Uint16Array(n.buffer,n.byteOffset,n.byteLength/2),u=String.fromCharCode.apply(null,Array.from(o)),c=u.substring(u.indexOf("<"),u.length),A=new DOMParser().parseFromString(c,"text/xml").getElementsByTagName("KID")[0];if(A){const _=A.childNodes[0]?A.childNodes[0].nodeValue:A.getAttribute("VALUE");if(_){const w=$e(_).subarray(0,16);ht(w),this.keyId=w}}break}default:{let a=n.subarray(0,16);if(a.length!==16){const o=new Uint8Array(16);o.set(a,16-a.length),a=o}this.keyId=a;break}}if(!this.keyId||this.keyId.byteLength!==16){let a=yn[this.uri];if(!a){const o=Object.keys(yn).length%Number.MAX_SAFE_INTEGER;a=new Uint8Array(16),new DataView(a.buffer,12,4).setUint32(0,o),yn[this.uri]=a}this.keyId=a}return this}}function Tn(h){const t=new Uint8Array(16);for(let n=12;n<16;n++)t[n]=h>>8*(15-n)&255;return t}const hr=/\{\$([a-zA-Z0-9-_]+)\}/g;function Dr(h){return hr.test(h)}function bi(h,t,n){if(h.variableList!==null||h.hasVariableRefs)for(let a=n.length;a--;){const o=n[a],u=t[o];u&&(t[o]=kr(h,u))}}function kr(h,t){if(h.variableList!==null||h.hasVariableRefs){const n=h.variableList;return t.replace(hr,a=>{const o=a.substring(2,a.length-1),u=n==null?void 0:n[o];return u===void 0?(h.playlistParsingError||(h.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${o}"`)),a):u})}return t}function Ia(h,t,n){let a=h.variableList;a||(h.variableList=a={});let o,u;if("QUERYPARAM"in t){o=t.QUERYPARAM;try{const c=new self.URL(n).searchParams;if(c.has(o))u=c.get(o);else throw new Error(`"${o}" does not match any query parameter in URI: "${n}"`)}catch(c){h.playlistParsingError||(h.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${c.message}`))}}else o=t.NAME,u=t.VALUE;o in a?h.playlistParsingError||(h.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${o}"`)):a[o]=u||""}function bo(h,t,n){const a=t.IMPORT;if(n&&a in n){let o=h.variableList;o||(h.variableList=o={}),o[a]=n[a]}else h.playlistParsingError||(h.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${a}"`))}function fr(h=!0){return typeof self=="undefined"?void 0:(h||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}const sa={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function _o(h,t){const n=sa[t];return!!n&&!!n[h.slice(0,4)]}function Ra(h,t,n=!0){return!h.split(",").some(a=>!Pa(a,t,n))}function Pa(h,t,n=!0){var a;const o=fr(n);return(a=o==null?void 0:o.isTypeSupported(ds(h,t)))!=null?a:!1}function ds(h,t){return`${t}/mp4;codecs="${h}"`}function aa(h){if(h){const t=h.substring(0,4);return sa.video[t]}return 2}function cs(h){return h.split(",").reduce((t,n)=>{const a=sa.video[n];return a?(a*2+t)/(t?3:2):(sa.audio[n]+t)/(t?2:1)},0)}const Os={};function xo(h,t=!0){if(Os[h])return Os[h];const n={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"]}[h];for(let a=0;a<n.length;a++)if(Pa(n[a],"audio",t))return Os[h]=n[a],n[a];return h}const hs=/flac|opus/i;function Ir(h,t=!0){return h.replace(hs,n=>xo(n.toLowerCase(),t))}function oa(h,t){return h&&h!=="mp4a"?h:t}function Eo(h){const t=h.split(".");if(t.length>2){let n=t.shift()+".";return n+=parseInt(t.shift()).toString(16),n+=("000"+parseInt(t.shift()).toString(16)).slice(-4),n}return h}const la=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,fs=/#EXT-X-MEDIA:(.*)/g,Dl=/^#EXT(?:INF|-X-TARGETDURATION):/m,pr=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),wi=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class dn{static findGroup(t,n){for(let a=0;a<t.length;a++){const o=t[a];if(o.id===n)return o}}static resolve(t,n){return Ze.buildAbsoluteURL(n,t,{alwaysNormalize:!0})}static isMediaPlaylist(t){return Dl.test(t)}static parseMasterPlaylist(t,n){const a=Dr(t),o={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:a},u=[];la.lastIndex=0;let c;for(;(c=la.exec(t))!=null;)if(c[1]){var p;const A=new ue(c[1]);bi(o,A,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const _=kr(o,c[2]),w={attrs:A,bitrate:A.decimalInteger("BANDWIDTH")||A.decimalInteger("AVERAGE-BANDWIDTH"),name:A.NAME,url:dn.resolve(_,n)},M=A.decimalResolution("RESOLUTION");M&&(w.width=M.width,w.height=M.height),kl(A.CODECS,w),(p=w.unknownCodecs)!=null&&p.length||u.push(w),o.levels.push(w)}else if(c[3]){const A=c[3],_=c[4];switch(A){case"SESSION-DATA":{const w=new ue(_);bi(o,w,["DATA-ID","LANGUAGE","VALUE","URI"]);const M=w["DATA-ID"];M&&(o.sessionData===null&&(o.sessionData={}),o.sessionData[M]=w);break}case"SESSION-KEY":{const w=ps(_,n,o);w.encrypted&&w.isSupported()?(o.sessionKeys===null&&(o.sessionKeys=[]),o.sessionKeys.push(w)):S.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${_}"`);break}case"DEFINE":{{const w=new ue(_);bi(o,w,["NAME","VALUE","QUERYPARAM"]),Ia(o,w,n)}break}case"CONTENT-STEERING":{const w=new ue(_);bi(o,w,["SERVER-URI","PATHWAY-ID"]),o.contentSteering={uri:dn.resolve(w["SERVER-URI"],n),pathwayId:w["PATHWAY-ID"]||"."};break}case"START":{o.startTimeOffset=Rr(_);break}}}const g=u.length>0&&u.length<o.levels.length;return o.levels=g?u:o.levels,o.levels.length===0&&(o.playlistParsingError=new Error("no levels found in manifest")),o}static parseMasterPlaylistMedia(t,n,a){let o;const u={},c=a.levels,p={AUDIO:c.map(A=>({id:A.attrs.AUDIO,audioCodec:A.audioCodec})),SUBTITLES:c.map(A=>({id:A.attrs.SUBTITLES,textCodec:A.textCodec})),"CLOSED-CAPTIONS":[]};let g=0;for(fs.lastIndex=0;(o=fs.exec(t))!==null;){const A=new ue(o[1]),_=A.TYPE;if(_){const w=p[_],M=u[_]||[];u[_]=M,bi(a,A,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const z=A.LANGUAGE,K=A["ASSOC-LANGUAGE"],Z=A.CHANNELS,ne=A.CHARACTERISTICS,xe=A["INSTREAM-ID"],de={attrs:A,bitrate:0,id:g++,groupId:A["GROUP-ID"]||"",name:A.NAME||z||"",type:_,default:A.bool("DEFAULT"),autoselect:A.bool("AUTOSELECT"),forced:A.bool("FORCED"),lang:z,url:A.URI?dn.resolve(A.URI,n):""};if(K&&(de.assocLang=K),Z&&(de.channels=Z),ne&&(de.characteristics=ne),xe&&(de.instreamId=xe),w!=null&&w.length){const Be=dn.findGroup(w,de.groupId)||w[0];Oa(de,Be,"audioCodec"),Oa(de,Be,"textCodec")}M.push(de)}}return u}static parseLevelPlaylist(t,n,a,o,u,c){const p=new Ie(n),g=p.fragments;let A=null,_=0,w=0,M=0,z=0,K=null,Z=new Ce(o,n),ne,xe,de,Be=-1,Qe=!1,Ne=null;for(pr.lastIndex=0,p.m3u8=t,p.hasVariableRefs=Dr(t);(ne=pr.exec(t))!==null;){Qe&&(Qe=!1,Z=new Ce(o,n),Z.start=M,Z.sn=_,Z.cc=z,Z.level=a,A&&(Z.initSegment=A,Z.rawProgramDateTime=A.rawProgramDateTime,A.rawProgramDateTime=null,Ne&&(Z.setByteRange(Ne),Ne=null)));const Lt=ne[1];if(Lt){Z.duration=parseFloat(Lt);const et=(" "+ne[2]).slice(1);Z.title=et||null,Z.tagList.push(et?["INF",Lt,et]:["INF",Lt])}else if(ne[3]){if(ie(Z.duration)){Z.start=M,de&&qi(Z,de,p),Z.sn=_,Z.level=a,Z.cc=z,g.push(Z);const et=(" "+ne[3]).slice(1);Z.relurl=kr(p,et),ua(Z,K),K=Z,M+=Z.duration,_++,w=0,Qe=!0}}else if(ne[4]){const et=(" "+ne[4]).slice(1);K?Z.setByteRange(et,K):Z.setByteRange(et)}else if(ne[5])Z.rawProgramDateTime=(" "+ne[5]).slice(1),Z.tagList.push(["PROGRAM-DATE-TIME",Z.rawProgramDateTime]),Be===-1&&(Be=g.length);else{if(ne=ne[0].match(wi),!ne){S.warn("No matches on slow regex match for level playlist!");continue}for(xe=1;xe<ne.length&&typeof ne[xe]=="undefined";xe++);const et=(" "+ne[xe]).slice(1),st=(" "+ne[xe+1]).slice(1),Ht=ne[xe+2]?(" "+ne[xe+2]).slice(1):"";switch(et){case"PLAYLIST-TYPE":p.type=st.toUpperCase();break;case"MEDIA-SEQUENCE":_=p.startSN=parseInt(st);break;case"SKIP":{const St=new ue(st);bi(p,St,["RECENTLY-REMOVED-DATERANGES"]);const zt=St.decimalInteger("SKIPPED-SEGMENTS");if(ie(zt)){p.skippedSegments=zt;for(let qt=zt;qt--;)g.unshift(null);_+=zt}const Zt=St.enumeratedString("RECENTLY-REMOVED-DATERANGES");Zt&&(p.recentlyRemovedDateranges=Zt.split("	"));break}case"TARGETDURATION":p.targetduration=Math.max(parseInt(st),1);break;case"VERSION":p.version=parseInt(st);break;case"INDEPENDENT-SEGMENTS":case"EXTM3U":break;case"ENDLIST":p.live=!1;break;case"#":(st||Ht)&&Z.tagList.push(Ht?[st,Ht]:[st]);break;case"DISCONTINUITY":z++,Z.tagList.push(["DIS"]);break;case"GAP":Z.gap=!0,Z.tagList.push([et]);break;case"BITRATE":Z.tagList.push([et,st]);break;case"DATERANGE":{const St=new ue(st);bi(p,St,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),bi(p,St,St.clientAttrs);const zt=new ae(St,p.dateRanges[St.ID]);zt.isValid||p.skippedSegments?p.dateRanges[zt.id]=zt:S.warn(`Ignoring invalid DATERANGE tag: "${st}"`),Z.tagList.push(["EXT-X-DATERANGE",st]);break}case"DEFINE":{{const St=new ue(st);bi(p,St,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in St?bo(p,St,c):Ia(p,St,n)}break}case"DISCONTINUITY-SEQUENCE":z=parseInt(st);break;case"KEY":{const St=ps(st,n,p);if(St.isSupported()){if(St.method==="NONE"){de=void 0;break}de||(de={}),de[St.keyFormat]&&(de=re({},de)),de[St.keyFormat]=St}else S.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${st}"`);break}case"START":p.startTimeOffset=Rr(st);break;case"MAP":{const St=new ue(st);if(bi(p,St,["BYTERANGE","URI"]),Z.duration){const zt=new Ce(o,n);Bs(zt,St,a,de),A=zt,Z.initSegment=A,A.rawProgramDateTime&&!Z.rawProgramDateTime&&(Z.rawProgramDateTime=A.rawProgramDateTime)}else{const zt=Z.byteRangeEndOffset;if(zt){const Zt=Z.byteRangeStartOffset;Ne=`${zt-Zt}@${Zt}`}else Ne=null;Bs(Z,St,a,de),A=Z,Qe=!0}break}case"SERVER-CONTROL":{const St=new ue(st);p.canBlockReload=St.bool("CAN-BLOCK-RELOAD"),p.canSkipUntil=St.optionalFloat("CAN-SKIP-UNTIL",0),p.canSkipDateRanges=p.canSkipUntil>0&&St.bool("CAN-SKIP-DATERANGES"),p.partHoldBack=St.optionalFloat("PART-HOLD-BACK",0),p.holdBack=St.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const St=new ue(st);p.partTarget=St.decimalFloatingPoint("PART-TARGET");break}case"PART":{let St=p.partList;St||(St=p.partList=[]);const zt=w>0?St[St.length-1]:void 0,Zt=w++,qt=new ue(st);bi(p,qt,["BYTERANGE","URI"]);const hi=new we(qt,Z,n,Zt,zt);St.push(hi),Z.duration+=hi.duration;break}case"PRELOAD-HINT":{const St=new ue(st);bi(p,St,["URI"]),p.preloadHint=St;break}case"RENDITION-REPORT":{const St=new ue(st);bi(p,St,["URI"]),p.renditionReports=p.renditionReports||[],p.renditionReports.push(St);break}default:S.warn(`line parsed but not handled: ${ne}`);break}}}K&&!K.relurl?(g.pop(),M-=K.duration,p.partList&&(p.fragmentHint=K)):p.partList&&(ua(Z,K),Z.cc=z,p.fragmentHint=Z,de&&qi(Z,de,p));const lt=g.length,Xe=g[0],ct=g[lt-1];if(M+=p.skippedSegments*p.targetduration,M>0&&lt&&ct){p.averagetargetduration=M/lt;const Lt=ct.sn;p.endSN=Lt!=="initSegment"?Lt:0,p.live||(ct.endList=!0),Xe&&(p.startCC=Xe.cc)}else p.endSN=0,p.startCC=0;return p.fragmentHint&&(M+=p.fragmentHint.duration),p.totalduration=M,p.endCC=z,Be>0&&Yi(g,Be),p}}function ps(h,t,n){var a,o;const u=new ue(h);bi(n,u,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const c=(a=u.METHOD)!=null?a:"",p=u.URI,g=u.hexadecimalInteger("IV"),A=u.KEYFORMATVERSIONS,_=(o=u.KEYFORMAT)!=null?o:"identity";p&&u.IV&&!g&&S.error(`Invalid IV: ${u.IV}`);const w=p?dn.resolve(p,t):"",M=(A||"1").split("/").map(Number).filter(Number.isFinite);return new Hi(c,w,_,M,g)}function Rr(h){const n=new ue(h).decimalFloatingPoint("TIME-OFFSET");return ie(n)?n:null}function kl(h,t){let n=(h||"").split(/[ ,]+/).filter(a=>a);["video","audio","text"].forEach(a=>{const o=n.filter(u=>_o(u,a));o.length&&(t[`${a}Codec`]=o.join(","),n=n.filter(u=>o.indexOf(u)===-1))}),t.unknownCodecs=n}function Oa(h,t,n){const a=t[n];a&&(h[n]=a)}function Yi(h,t){let n=h[t];for(let a=t;a--;){const o=h[a];if(!o)return;o.programDateTime=n.programDateTime-o.duration*1e3,n=o}}function ua(h,t){h.rawProgramDateTime?h.programDateTime=Date.parse(h.rawProgramDateTime):t!=null&&t.programDateTime&&(h.programDateTime=t.endProgramDateTime),ie(h.programDateTime)||(h.programDateTime=null,h.rawProgramDateTime=null)}function Bs(h,t,n,a){h.relurl=t.URI,t.BYTERANGE&&h.setByteRange(t.BYTERANGE),h.level=n,h.sn="initSegment",a&&(h.levelkeys=a),h.initSegment=null}function qi(h,t,n){h.levelkeys=t;const{encryptedFragments:a}=n;(!a.length||a[a.length-1].levelkeys!==t)&&Object.keys(t).some(o=>t[o].isCommonEncryption)&&a.push(h)}var di={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},Wt={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function da(h){const{type:t}=h;switch(t){case di.AUDIO_TRACK:return Wt.AUDIO;case di.SUBTITLE_TRACK:return Wt.SUBTITLE;default:return Wt.MAIN}}function Ba(h,t){let n=h.url;return(n===void 0||n.indexOf("data:")===0)&&(n=t.url),n}class Ma{constructor(t){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=t,this.registerListeners()}startLoad(t){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:t}=this;t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.LEVEL_LOADING,this.onLevelLoading,this),t.on(v.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.on(v.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:t}=this;t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.LEVEL_LOADING,this.onLevelLoading,this),t.off(v.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.off(v.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(t){const n=this.hls.config,a=n.pLoader,o=n.loader,u=a||o,c=new u(n);return this.loaders[t.type]=c,c}getInternalLoader(t){return this.loaders[t.type]}resetInternalLoader(t){this.loaders[t]&&delete this.loaders[t]}destroyInternalLoaders(){for(const t in this.loaders){const n=this.loaders[t];n&&n.destroy(),this.resetInternalLoader(t)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(t,n){const{url:a}=n;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:di.MANIFEST,url:a,deliveryDirectives:null})}onLevelLoading(t,n){const{id:a,level:o,pathwayId:u,url:c,deliveryDirectives:p}=n;this.load({id:a,level:o,pathwayId:u,responseType:"text",type:di.LEVEL,url:c,deliveryDirectives:p})}onAudioTrackLoading(t,n){const{id:a,groupId:o,url:u,deliveryDirectives:c}=n;this.load({id:a,groupId:o,level:null,responseType:"text",type:di.AUDIO_TRACK,url:u,deliveryDirectives:c})}onSubtitleTrackLoading(t,n){const{id:a,groupId:o,url:u,deliveryDirectives:c}=n;this.load({id:a,groupId:o,level:null,responseType:"text",type:di.SUBTITLE_TRACK,url:u,deliveryDirectives:c})}load(t){var n;const a=this.hls.config;let o=this.getInternalLoader(t);if(o){const A=o.context;if(A&&A.url===t.url&&A.level===t.level){S.trace("[playlist-loader]: playlist request ongoing");return}S.log(`[playlist-loader]: aborting previous loader for type: ${t.type}`),o.abort()}let u;if(t.type===di.MANIFEST?u=a.manifestLoadPolicy.default:u=re({},a.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),o=this.createInternalLoader(t),ie((n=t.deliveryDirectives)==null?void 0:n.part)){let A;if(t.type===di.LEVEL&&t.level!==null?A=this.hls.levels[t.level].details:t.type===di.AUDIO_TRACK&&t.id!==null?A=this.hls.audioTracks[t.id].details:t.type===di.SUBTITLE_TRACK&&t.id!==null&&(A=this.hls.subtitleTracks[t.id].details),A){const _=A.partTarget,w=A.targetduration;if(_&&w){const M=Math.max(_*3,w*.8)*1e3;u=re({},u,{maxTimeToFirstByteMs:Math.min(M,u.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(M,u.maxTimeToFirstByteMs)})}}}const c=u.errorRetry||u.timeoutRetry||{},p={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:c.maxNumRetry||0,retryDelay:c.retryDelayMs||0,maxRetryDelay:c.maxRetryDelayMs||0},g={onSuccess:(A,_,w,M)=>{const z=this.getInternalLoader(w);this.resetInternalLoader(w.type);const K=A.data;if(K.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(A,w,new Error("no EXTM3U delimiter"),M||null,_);return}_.parsing.start=performance.now(),dn.isMediaPlaylist(K)?this.handleTrackOrLevelPlaylist(A,_,w,M||null,z):this.handleMasterPlaylist(A,_,w,M)},onError:(A,_,w,M)=>{this.handleNetworkError(_,w,!1,A,M)},onTimeout:(A,_,w)=>{this.handleNetworkError(_,w,!0,void 0,A)}};o.load(t,p,g)}handleMasterPlaylist(t,n,a,o){const u=this.hls,c=t.data,p=Ba(t,a),g=dn.parseMasterPlaylist(c,p);if(g.playlistParsingError){this.handleManifestParsingError(t,a,g.playlistParsingError,o,n);return}const{contentSteering:A,levels:_,sessionData:w,sessionKeys:M,startTimeOffset:z,variableList:K}=g;this.variableList=K;const{AUDIO:Z=[],SUBTITLES:ne,"CLOSED-CAPTIONS":xe}=dn.parseMasterPlaylistMedia(c,p,g);Z.length&&!Z.some(Be=>!Be.url)&&_[0].audioCodec&&!_[0].attrs.AUDIO&&(S.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),Z.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new ue({}),bitrate:0,url:""})),u.trigger(v.MANIFEST_LOADED,{levels:_,audioTracks:Z,subtitles:ne,captions:xe,contentSteering:A,url:p,stats:n,networkDetails:o,sessionData:w,sessionKeys:M,startTimeOffset:z,variableList:K})}handleTrackOrLevelPlaylist(t,n,a,o,u){const c=this.hls,{id:p,level:g,type:A}=a,_=Ba(t,a),w=0,M=ie(g)?g:ie(p)?p:0,z=da(a),K=dn.parseLevelPlaylist(t.data,_,M,z,w,this.variableList);if(A===di.MANIFEST){const Z={attrs:new ue({}),bitrate:0,details:K,name:"",url:_};c.trigger(v.MANIFEST_LOADED,{levels:[Z],audioTracks:[],url:_,stats:n,networkDetails:o,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}n.parsing.end=performance.now(),a.levelDetails=K,this.handlePlaylistLoaded(K,t,n,a,o,u)}handleManifestParsingError(t,n,a,o,u){this.hls.trigger(v.ERROR,{type:$.NETWORK_ERROR,details:I.MANIFEST_PARSING_ERROR,fatal:n.type===di.MANIFEST,url:t.url,err:a,error:a,reason:a.message,response:t,context:n,networkDetails:o,stats:u})}handleNetworkError(t,n,a=!1,o,u){let c=`A network ${a?"timeout":"error"+(o?" (status "+o.code+")":"")} occurred while loading ${t.type}`;t.type===di.LEVEL?c+=`: ${t.level} id: ${t.id}`:(t.type===di.AUDIO_TRACK||t.type===di.SUBTITLE_TRACK)&&(c+=` id: ${t.id} group-id: "${t.groupId}"`);const p=new Error(c);S.warn(`[playlist-loader]: ${c}`);let g=I.UNKNOWN,A=!1;const _=this.getInternalLoader(t);switch(t.type){case di.MANIFEST:g=a?I.MANIFEST_LOAD_TIMEOUT:I.MANIFEST_LOAD_ERROR,A=!0;break;case di.LEVEL:g=a?I.LEVEL_LOAD_TIMEOUT:I.LEVEL_LOAD_ERROR,A=!1;break;case di.AUDIO_TRACK:g=a?I.AUDIO_TRACK_LOAD_TIMEOUT:I.AUDIO_TRACK_LOAD_ERROR,A=!1;break;case di.SUBTITLE_TRACK:g=a?I.SUBTITLE_TRACK_LOAD_TIMEOUT:I.SUBTITLE_LOAD_ERROR,A=!1;break}_&&this.resetInternalLoader(t.type);const w={type:$.NETWORK_ERROR,details:g,fatal:A,url:t.url,loader:_,context:t,error:p,networkDetails:n,stats:u};if(o){const M=(n==null?void 0:n.url)||t.url;w.response=nt({url:M,data:void 0},o)}this.hls.trigger(v.ERROR,w)}handlePlaylistLoaded(t,n,a,o,u,c){const p=this.hls,{type:g,level:A,id:_,groupId:w,deliveryDirectives:M}=o,z=Ba(n,o),K=da(o),Z=typeof o.level=="number"&&K===Wt.MAIN?A:void 0;if(!t.fragments.length){const xe=new Error("No Segments found in Playlist");p.trigger(v.ERROR,{type:$.NETWORK_ERROR,details:I.LEVEL_EMPTY_ERROR,fatal:!1,url:z,error:xe,reason:xe.message,response:n,context:o,level:Z,parent:K,networkDetails:u,stats:a});return}t.targetduration||(t.playlistParsingError=new Error("Missing Target Duration"));const ne=t.playlistParsingError;if(ne){p.trigger(v.ERROR,{type:$.NETWORK_ERROR,details:I.LEVEL_PARSING_ERROR,fatal:!1,url:z,error:ne,reason:ne.message,response:n,context:o,level:Z,parent:K,networkDetails:u,stats:a});return}switch(t.live&&c&&(c.getCacheAge&&(t.ageHeader=c.getCacheAge()||0),(!c.getCacheAge||isNaN(t.ageHeader))&&(t.ageHeader=0)),g){case di.MANIFEST:case di.LEVEL:p.trigger(v.LEVEL_LOADED,{details:t,level:Z||0,id:_||0,stats:a,networkDetails:u,deliveryDirectives:M});break;case di.AUDIO_TRACK:p.trigger(v.AUDIO_TRACK_LOADED,{details:t,id:_||0,groupId:w||"",stats:a,networkDetails:u,deliveryDirectives:M});break;case di.SUBTITLE_TRACK:p.trigger(v.SUBTITLE_TRACK_LOADED,{details:t,id:_||0,groupId:w||"",stats:a,networkDetails:u,deliveryDirectives:M});break}}}function Wr(h,t){let n;try{n=new Event("addtrack")}catch(a){n=document.createEvent("Event"),n.initEvent("addtrack",!1,!1)}n.track=h,t.dispatchEvent(n)}function To(h,t){const n=h.mode;if(n==="disabled"&&(h.mode="hidden"),h.cues&&!h.cues.getCueById(t.id))try{if(h.addCue(t),!h.cues.getCueById(t.id))throw new Error(`addCue is failed for: ${t}`)}catch(a){S.debug(`[texttrack-utils]: ${a}`);try{const o=new self.TextTrackCue(t.startTime,t.endTime,t.text);o.id=t.id,h.addCue(o)}catch(o){S.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${o}`)}}n==="disabled"&&(h.mode=n)}function ms(h){const t=h.mode;if(t==="disabled"&&(h.mode="hidden"),h.cues)for(let n=h.cues.length;n--;)h.removeCue(h.cues[n]);t==="disabled"&&(h.mode=t)}function Fa(h,t,n,a){const o=h.mode;if(o==="disabled"&&(h.mode="hidden"),h.cues&&h.cues.length>0){const u=Il(h.cues,t,n);for(let c=0;c<u.length;c++)(!a||a(u[c]))&&h.removeCue(u[c])}o==="disabled"&&(h.mode=o)}function So(h,t){if(t<h[0].startTime)return 0;const n=h.length-1;if(t>h[n].endTime)return-1;let a=0,o=n;for(;a<=o;){const u=Math.floor((o+a)/2);if(t<h[u].startTime)o=u-1;else if(t>h[u].startTime&&a<n)a=u+1;else return u}return h[a].startTime-t<t-h[o].startTime?a:o}function Il(h,t,n){const a=[],o=So(h,t);if(o>-1)for(let u=o,c=h.length;u<c;u++){const p=h[u];if(p.startTime>=t&&p.endTime<=n)a.push(p);else if(p.startTime>n)return a}return a}function Na(h){const t=[];for(let n=0;n<h.length;n++){const a=h[n];(a.kind==="subtitles"||a.kind==="captions")&&a.label&&t.push(h[n])}return t}var $n={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};const Rl=.25;function Ua(){if(typeof self!="undefined")return self.VTTCue||self.TextTrackCue}function Co(h,t,n,a,o){let u=new h(t,n,"");try{u.value=a,o&&(u.type=o)}catch(c){u=new h(t,n,JSON.stringify(o?nt({type:o},a):a))}return u}const ca=(()=>{const h=Ua();try{h&&new h(0,Number.POSITIVE_INFINITY,"")}catch(t){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function ja(h,t){return h.getTime()/1e3-t}function Ms(h){return Uint8Array.from(h.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class ed{constructor(t){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=t,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:t}=this;t.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.on(v.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(v.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:t}=this;t.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.off(v.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(v.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(t,n){this.media=n.media}onMediaDetaching(){!this.id3Track||(ms(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(t){const n=this.getID3Track(t.textTracks);return n.mode="hidden",n}getID3Track(t){if(!!this.media){for(let n=0;n<t.length;n++){const a=t[n];if(a.kind==="metadata"&&a.label==="id3")return Wr(a,this.media),a}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(t,n){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:a,enableID3MetadataCues:o}}}=this;if(!a&&!o)return;const{samples:u}=n;this.id3Track||(this.id3Track=this.createTrack(this.media));const c=Ua();if(!!c)for(let p=0;p<u.length;p++){const g=u[p].type;if(g===$n.emsg&&!a||!o)continue;const A=ui(u[p].data);if(A){const _=u[p].pts;let w=_+u[p].duration;w>ca&&(w=ca),w-_<=0&&(w=_+Rl);for(let z=0;z<A.length;z++){const K=A[z];if(!Ai(K)){this.updateId3CueEnds(_,g);const Z=Co(c,_,w,K,g);Z&&this.id3Track.addCue(Z)}}}}}updateId3CueEnds(t,n){var a;const o=(a=this.id3Track)==null?void 0:a.cues;if(o)for(let u=o.length;u--;){const c=o[u];c.type===n&&c.startTime<t&&c.endTime===ca&&(c.endTime=t)}}onBufferFlushing(t,{startOffset:n,endOffset:a,type:o}){const{id3Track:u,hls:c}=this;if(!c)return;const{config:{enableEmsgMetadataCues:p,enableID3MetadataCues:g}}=c;if(u&&(p||g)){let A;o==="audio"?A=_=>_.type===$n.audioId3&&g:o==="video"?A=_=>_.type===$n.emsg&&p:A=_=>_.type===$n.audioId3&&g||_.type===$n.emsg&&p,Fa(u,n,a,A)}}onLevelUpdated(t,{details:n}){if(!this.media||!n.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:a,id3Track:o}=this,{dateRanges:u}=n,c=Object.keys(u);if(o){const _=Object.keys(a).filter(w=>!c.includes(w));for(let w=_.length;w--;){const M=_[w];Object.keys(a[M].cues).forEach(z=>{o.removeCue(a[M].cues[z])}),delete a[M]}}const p=n.fragments[n.fragments.length-1];if(c.length===0||!ie(p==null?void 0:p.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const g=p.programDateTime/1e3-p.start,A=Ua();for(let _=0;_<c.length;_++){const w=c[_],M=u[w],z=ja(M.startDate,g),K=a[w],Z=(K==null?void 0:K.cues)||{};let ne=(K==null?void 0:K.durationKnown)||!1,xe=ca;const de=M.endDate;if(de)xe=ja(de,g),ne=!0;else if(M.endOnNext&&!ne){const Qe=c.reduce((Ne,lt)=>{if(lt!==M.id){const Xe=u[lt];if(Xe.class===M.class&&Xe.startDate>M.startDate&&(!Ne||M.startDate<Ne.startDate))return Xe}return Ne},null);Qe&&(xe=ja(Qe.startDate,g),ne=!0)}const Be=Object.keys(M.attr);for(let Qe=0;Qe<Be.length;Qe++){const Ne=Be[Qe];if(!U(Ne))continue;const lt=Z[Ne];if(lt)ne&&!K.durationKnown&&(lt.endTime=xe);else if(A){let Xe=M.attr[Ne];Y(Ne)&&(Xe=Ms(Xe));const ct=Co(A,z,xe,{key:Ne,data:Xe},$n.dateRange);ct&&(ct.id=w,this.id3Track.addCue(ct),Z[Ne]=ct)}}a[w]={cues:Z,dateRange:M,durationKnown:ne}}}}class td{constructor(t){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=t,this.config=t.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:t,levelDetails:n}=this;return t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:n?t.liveMaxLatencyDurationCount*n.targetduration:0}get targetLatency(){const{levelDetails:t}=this;if(t===null)return null;const{holdBack:n,partHoldBack:a,targetduration:o}=t,{liveSyncDuration:u,liveSyncDurationCount:c,lowLatencyMode:p}=this.config,g=this.hls.userConfig;let A=p&&a||n;(g.liveSyncDuration||g.liveSyncDurationCount||A===0)&&(A=u!==void 0?u:c*o);const _=o,w=1;return A+Math.min(this.stallCount*w,_)}get liveSyncPosition(){const t=this.estimateLiveEdge(),n=this.targetLatency,a=this.levelDetails;if(t===null||n===null||a===null)return null;const o=a.edge,u=t-n-this.edgeStalled,c=o-a.totalduration,p=o-(this.config.lowLatencyMode&&a.partTarget||a.targetduration);return Math.min(Math.max(c,u),p)}get drift(){const{levelDetails:t}=this;return t===null?1:t.drift}get edgeStalled(){const{levelDetails:t}=this;if(t===null)return 0;const n=(this.config.lowLatencyMode&&t.partTarget||t.targetduration)*3;return Math.max(t.age-n,0)}get forwardBufferLength(){const{media:t,levelDetails:n}=this;if(!t||!n)return 0;const a=t.buffered.length;return(a?t.buffered.end(a-1):n.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(v.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(v.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(v.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(v.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(v.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(v.ERROR,this.onError,this)}onMediaAttached(t,n){this.media=n.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(t,{details:n}){this.levelDetails=n,n.advanced&&this.timeupdate(),!n.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(t,n){var a;n.details===I.BUFFER_STALLED_ERROR&&(this.stallCount++,(a=this.levelDetails)!=null&&a.live&&S.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:t,levelDetails:n}=this;if(!t||!n)return;this.currentTime=t.currentTime;const a=this.computeLatency();if(a===null)return;this._latency=a;const{lowLatencyMode:o,maxLiveSyncPlaybackRate:u}=this.config;if(!o||u===1||!n.live)return;const c=this.targetLatency;if(c===null)return;const p=a-c,g=Math.min(this.maxLatency,c+n.targetduration);if(p<g&&p>.05&&this.forwardBufferLength>1){const _=Math.min(2,Math.max(1,u)),w=Math.round(2/(1+Math.exp(-.75*p-this.edgeStalled))*20)/20;t.playbackRate=Math.min(_,Math.max(1,w))}else t.playbackRate!==1&&t.playbackRate!==0&&(t.playbackRate=1)}estimateLiveEdge(){const{levelDetails:t}=this;return t===null?null:t.edge+t.age}computeLatency(){const t=this.estimateLiveEdge();return t===null?null:t-this.currentTime}}const wo=["NONE","TYPE-0","TYPE-1",null];function id(h){return wo.indexOf(h)>-1}const $a=["SDR","PQ","HLG"];function nd(h){return!!h&&$a.indexOf(h)>-1}var zr={No:"",Yes:"YES",v2:"v2"};function Pl(h,t){const{canSkipUntil:n,canSkipDateRanges:a,endSN:o}=h,u=t!==void 0?t-o:0;return n&&u<n?a?zr.v2:zr.Yes:zr.No}class ha{constructor(t,n,a){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=t,this.part=n,this.skip=a}addDirectives(t){const n=new self.URL(t);return this.msn!==void 0&&n.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&n.searchParams.set("_HLS_part",this.part.toString()),this.skip&&n.searchParams.set("_HLS_skip",this.skip),n.href}}class Pr{constructor(t){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[t.url],this._attrs=[t.attrs],this.bitrate=t.bitrate,t.details&&(this.details=t.details),this.id=t.id||0,this.name=t.name,this.width=t.width||0,this.height=t.height||0,this.frameRate=t.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=t.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=t.audioCodec,this.videoCodec=t.videoCodec,this.codecSet=[t.videoCodec,t.audioCodec].filter(n=>!!n).map(n=>n.substring(0,4)).join(","),this.addGroupId("audio",t.attrs.AUDIO),this.addGroupId("text",t.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(t){return An(this._audioGroups,t)}hasSubtitleGroup(t){return An(this._subtitleGroups,t)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(t,n){if(!!n){if(t==="audio"){let a=this._audioGroups;a||(a=this._audioGroups=[]),a.indexOf(n)===-1&&a.push(n)}else if(t==="text"){let a=this._subtitleGroups;a||(a=this._subtitleGroups=[]),a.indexOf(n)===-1&&a.push(n)}}}get urlId(){return 0}set urlId(t){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var t;return(t=this.audioGroups)==null?void 0:t[0]}get textGroupId(){var t;return(t=this.subtitleGroups)==null?void 0:t[0]}addFallback(){}}function An(h,t){return!t||!h?!1:h.indexOf(t)!==-1}function Or(h,t){const n=t.startPTS;if(ie(n)){let a=0,o;t.sn>h.sn?(a=n-h.start,o=h):(a=h.start-n,o=t),o.duration!==a&&(o.duration=a)}else t.sn>h.sn?h.cc===t.cc&&h.minEndPTS?t.start=h.start+(h.minEndPTS-h.start):t.start=h.start+h.duration:t.start=Math.max(h.start-t.duration,0)}function gs(h,t,n,a,o,u){a-n<=0&&(S.warn("Fragment should have a positive duration",t),a=n+t.duration,u=o+t.duration);let p=n,g=a;const A=t.startPTS,_=t.endPTS;if(ie(A)){const ne=Math.abs(A-n);ie(t.deltaPTS)?t.deltaPTS=Math.max(ne,t.deltaPTS):t.deltaPTS=ne,p=Math.max(n,A),n=Math.min(n,A),o=Math.min(o,t.startDTS),g=Math.min(a,_),a=Math.max(a,_),u=Math.max(u,t.endDTS)}const w=n-t.start;t.start!==0&&(t.start=n),t.duration=a-t.start,t.startPTS=n,t.maxStartPTS=p,t.startDTS=o,t.endPTS=a,t.minEndPTS=g,t.endDTS=u;const M=t.sn;if(!h||M<h.startSN||M>h.endSN)return 0;let z;const K=M-h.startSN,Z=h.fragments;for(Z[K]=t,z=K;z>0;z--)Or(Z[z],Z[z-1]);for(z=K;z<Z.length-1;z++)Or(Z[z],Z[z+1]);return h.fragmentHint&&Or(Z[Z.length-1],h.fragmentHint),h.PTSKnown=h.alignedSliding=!0,w}function Ol(h,t){let n=null;const a=h.fragments;for(let g=a.length-1;g>=0;g--){const A=a[g].initSegment;if(A){n=A;break}}h.fragmentHint&&delete h.fragmentHint.endPTS;let o=0,u;if(sd(h,t,(g,A)=>{g.relurl&&(o=g.cc-A.cc),ie(g.startPTS)&&ie(g.endPTS)&&(A.start=A.startPTS=g.startPTS,A.startDTS=g.startDTS,A.maxStartPTS=g.maxStartPTS,A.endPTS=g.endPTS,A.endDTS=g.endDTS,A.minEndPTS=g.minEndPTS,A.duration=g.endPTS-g.startPTS,A.duration&&(u=A),t.PTSKnown=t.alignedSliding=!0),A.elementaryStreams=g.elementaryStreams,A.loader=g.loader,A.stats=g.stats,g.initSegment&&(A.initSegment=g.initSegment,n=g.initSegment)}),n&&(t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments).forEach(A=>{var _;A&&(!A.initSegment||A.initSegment.relurl===((_=n)==null?void 0:_.relurl))&&(A.initSegment=n)}),t.skippedSegments)if(t.deltaUpdateFailed=t.fragments.some(g=>!g),t.deltaUpdateFailed){S.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let g=t.skippedSegments;g--;)t.fragments.shift();t.startSN=t.fragments[0].sn,t.startCC=t.fragments[0].cc}else t.canSkipDateRanges&&(t.dateRanges=Bl(h.dateRanges,t.dateRanges,t.recentlyRemovedDateranges));const c=t.fragments;if(o){S.warn("discontinuity sliding from playlist, take drift into account");for(let g=0;g<c.length;g++)c[g].cc+=o}t.skippedSegments&&(t.startCC=t.fragments[0].cc),rd(h.partList,t.partList,(g,A)=>{A.elementaryStreams=g.elementaryStreams,A.stats=g.stats}),u?gs(t,u,u.startPTS,u.endPTS,u.startDTS,u.endDTS):Ri(h,t),c.length&&(t.totalduration=t.edge-c[0].start),t.driftStartTime=h.driftStartTime,t.driftStart=h.driftStart;const p=t.advancedDateTime;if(t.advanced&&p){const g=t.edge;t.driftStart||(t.driftStartTime=p,t.driftStart=g),t.driftEndTime=p,t.driftEnd=g}else t.driftEndTime=h.driftEndTime,t.driftEnd=h.driftEnd,t.advancedDateTime=h.advancedDateTime}function Bl(h,t,n){const a=re({},h);return n&&n.forEach(o=>{delete a[o]}),Object.keys(t).forEach(o=>{const u=new ae(t[o].attr,a[o]);u.isValid?a[o]=u:S.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(t[o].attr)}"`)}),a}function rd(h,t,n){if(h&&t){let a=0;for(let o=0,u=h.length;o<=u;o++){const c=h[o],p=t[o+a];c&&p&&c.index===p.index&&c.fragment.sn===p.fragment.sn?n(c,p):a--}}}function sd(h,t,n){const a=t.skippedSegments,o=Math.max(h.startSN,t.startSN)-t.startSN,u=(h.fragmentHint?1:0)+(a?t.endSN:Math.min(h.endSN,t.endSN))-t.startSN,c=t.startSN-h.startSN,p=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,g=h.fragmentHint?h.fragments.concat(h.fragmentHint):h.fragments;for(let A=o;A<=u;A++){const _=g[c+A];let w=p[A];a&&!w&&A<a&&(w=t.fragments[A]=_),_&&w&&n(_,w)}}function Ri(h,t){const n=t.startSN+t.skippedSegments-h.startSN,a=h.fragments;n<0||n>=a.length||Fs(t,a[n].start)}function Fs(h,t){if(t){const n=h.fragments;for(let a=h.skippedSegments;a<n.length;a++)n[a].start+=t;h.fragmentHint&&(h.fragmentHint.start+=t)}}function Ml(h,t=Infinity){let n=1e3*h.targetduration;if(h.updated){const a=h.fragments,o=4;if(a.length&&n*o>t){const u=a[a.length-1].duration*1e3;u<n&&(n=u)}}else n/=2;return Math.round(n)}function Yr(h,t,n){if(!(h!=null&&h.details))return null;const a=h.details;let o=a.fragments[t-a.startSN];return o||(o=a.fragmentHint,o&&o.sn===t)?o:t<a.startSN&&n&&n.sn===t?n:null}function Va(h,t,n){var a;return h!=null&&h.details?Lo((a=h.details)==null?void 0:a.partList,t,n):null}function Lo(h,t,n){if(h)for(let a=h.length;a--;){const o=h[a];if(o.index===n&&o.fragment.sn===t)return o}return null}function Rn(h){h.forEach((t,n)=>{const{details:a}=t;a!=null&&a.fragments&&a.fragments.forEach(o=>{o.level=n})})}function Pi(h){switch(h.details){case I.FRAG_LOAD_TIMEOUT:case I.KEY_LOAD_TIMEOUT:case I.LEVEL_LOAD_TIMEOUT:case I.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Do(h,t){const n=Pi(t);return h.default[`${n?"timeout":"error"}Retry`]}function Xr(h,t){const n=h.backoff==="linear"?1:Math.pow(2,t);return Math.min(n*h.retryDelayMs,h.maxRetryDelayMs)}function Ga(h){return nt(nt({},h),{errorRetry:null,timeoutRetry:null})}function Ha(h,t,n,a){if(!h)return!1;const o=a==null?void 0:a.code,u=t<h.maxNumRetry&&(ko(o)||!!n);return h.shouldRetry?h.shouldRetry(h,t,n,a,u):u}function ko(h){return h===0&&navigator.onLine===!1||!!h&&(h<400||h>499)}const Qr={search:function(h,t){let n=0,a=h.length-1,o=null,u=null;for(;n<=a;){o=(n+a)/2|0,u=h[o];const c=t(u);if(c>0)n=o+1;else if(c<0)a=o-1;else return u}return null}};function Fl(h,t,n){if(t===null||!Array.isArray(h)||!h.length||!ie(t))return null;const a=h[0].programDateTime;if(t<(a||0))return null;const o=h[h.length-1].endProgramDateTime;if(t>=(o||0))return null;n=n||0;for(let u=0;u<h.length;++u){const c=h[u];if(Ns(t,n,c))return c}return null}function fa(h,t,n=0,a=0){let o=null;if(h){o=t[h.sn-t[0].sn+1]||null;const c=h.endDTS-n;c>0&&c<15e-7&&(n+=15e-7)}else n===0&&t[0].start===0&&(o=t[0]);if(o&&(!h||h.level===o.level)&&pa(n,a,o)===0)return o;const u=Qr.search(t,pa.bind(null,n,a));return u&&(u!==h||!o)?u:o}function pa(h=0,t=0,n){if(n.start<=h&&n.start+n.duration>h)return 0;const a=Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return n.start+n.duration-a<=h?1:n.start-a>h&&n.start?-1:0}function Ns(h,t,n){const a=Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0))*1e3;return(n.endProgramDateTime||0)-a>h}function Nl(h,t){return Qr.search(h,n=>n.cc<t?1:n.cc>t?-1:0)}var pi={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},Qi={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4};class qa{constructor(t){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=t,this.log=S.log.bind(S,"[info]:"),this.warn=S.warn.bind(S,"[warning]:"),this.error=S.error.bind(S,"[error]:"),this.registerListeners()}registerListeners(){const t=this.hls;t.on(v.ERROR,this.onError,this),t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const t=this.hls;!t||(t.off(v.ERROR,this.onError,this),t.off(v.ERROR,this.onErrorOut,this),t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(t){}stopLoad(){this.playlistError=0}getVariantLevelIndex(t){return(t==null?void 0:t.type)===Wt.MAIN?t.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(t,n){var a,o;if(n.fatal)return;const u=this.hls,c=n.context;switch(n.details){case I.FRAG_LOAD_ERROR:case I.FRAG_LOAD_TIMEOUT:case I.KEY_LOAD_ERROR:case I.KEY_LOAD_TIMEOUT:n.errorAction=this.getFragRetryOrSwitchAction(n);return;case I.FRAG_PARSING_ERROR:if((a=n.frag)!=null&&a.gap){n.errorAction={action:pi.DoNothing,flags:Qi.None};return}case I.FRAG_GAP:case I.FRAG_DECRYPT_ERROR:{n.errorAction=this.getFragRetryOrSwitchAction(n),n.errorAction.action=pi.SendAlternateToPenaltyBox;return}case I.LEVEL_EMPTY_ERROR:case I.LEVEL_PARSING_ERROR:{var p,g;const A=n.parent===Wt.MAIN?n.level:u.loadLevel;n.details===I.LEVEL_EMPTY_ERROR&&!!((p=n.context)!=null&&(g=p.levelDetails)!=null&&g.live)?n.errorAction=this.getPlaylistRetryOrSwitchAction(n,A):(n.levelRetry=!1,n.errorAction=this.getLevelSwitchAction(n,A))}return;case I.LEVEL_LOAD_ERROR:case I.LEVEL_LOAD_TIMEOUT:typeof(c==null?void 0:c.level)=="number"&&(n.errorAction=this.getPlaylistRetryOrSwitchAction(n,c.level));return;case I.AUDIO_TRACK_LOAD_ERROR:case I.AUDIO_TRACK_LOAD_TIMEOUT:case I.SUBTITLE_LOAD_ERROR:case I.SUBTITLE_TRACK_LOAD_TIMEOUT:if(c){const A=u.levels[u.loadLevel];if(A&&(c.type===di.AUDIO_TRACK&&A.hasAudioGroup(c.groupId)||c.type===di.SUBTITLE_TRACK&&A.hasSubtitleGroup(c.groupId))){n.errorAction=this.getPlaylistRetryOrSwitchAction(n,u.loadLevel),n.errorAction.action=pi.SendAlternateToPenaltyBox,n.errorAction.flags=Qi.MoveAllAlternatesMatchingHost;return}}return;case I.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const A=u.levels[u.loadLevel],_=A==null?void 0:A.attrs["HDCP-LEVEL"];_?n.errorAction={action:pi.SendAlternateToPenaltyBox,flags:Qi.MoveAllAlternatesMatchingHDCP,hdcpLevel:_}:this.keySystemError(n)}return;case I.BUFFER_ADD_CODEC_ERROR:case I.REMUX_ALLOC_ERROR:case I.BUFFER_APPEND_ERROR:n.errorAction=this.getLevelSwitchAction(n,(o=n.level)!=null?o:u.loadLevel);return;case I.INTERNAL_EXCEPTION:case I.BUFFER_APPENDING_ERROR:case I.BUFFER_FULL_ERROR:case I.LEVEL_SWITCH_ERROR:case I.BUFFER_STALLED_ERROR:case I.BUFFER_SEEK_OVER_HOLE:case I.BUFFER_NUDGE_ON_STALL:n.errorAction={action:pi.DoNothing,flags:Qi.None};return}n.type===$.KEY_SYSTEM_ERROR&&this.keySystemError(n)}keySystemError(t){const n=this.getVariantLevelIndex(t.frag);t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,n)}getPlaylistRetryOrSwitchAction(t,n){const a=this.hls,o=Do(a.config.playlistLoadPolicy,t),u=this.playlistError++;if(Ha(o,u,Pi(t),t.response))return{action:pi.RetryRequest,flags:Qi.None,retryConfig:o,retryCount:u};const p=this.getLevelSwitchAction(t,n);return o&&(p.retryConfig=o,p.retryCount=u),p}getFragRetryOrSwitchAction(t){const n=this.hls,a=this.getVariantLevelIndex(t.frag),o=n.levels[a],{fragLoadPolicy:u,keyLoadPolicy:c}=n.config,p=Do(t.details.startsWith("key")?c:u,t),g=n.levels.reduce((_,w)=>_+w.fragmentError,0);if(o&&(t.details!==I.FRAG_GAP&&o.fragmentError++,Ha(p,g,Pi(t),t.response)))return{action:pi.RetryRequest,flags:Qi.None,retryConfig:p,retryCount:g};const A=this.getLevelSwitchAction(t,a);return p&&(A.retryConfig=p,A.retryCount=g),A}getLevelSwitchAction(t,n){const a=this.hls;n==null&&(n=a.loadLevel);const o=this.hls.levels[n];if(o){var u,c;const A=t.details;o.loadError++,A===I.BUFFER_APPEND_ERROR&&o.fragmentError++;let _=-1;const{levels:w,loadLevel:M,minAutoLevel:z,maxAutoLevel:K}=a;a.autoLevelEnabled||(a.loadLevel=-1);const Z=(u=t.frag)==null?void 0:u.type,xe=(Z===Wt.AUDIO&&A===I.FRAG_PARSING_ERROR||t.sourceBufferName==="audio"&&(A===I.BUFFER_ADD_CODEC_ERROR||A===I.BUFFER_APPEND_ERROR))&&w.some(({audioCodec:lt})=>o.audioCodec!==lt),Be=t.sourceBufferName==="video"&&(A===I.BUFFER_ADD_CODEC_ERROR||A===I.BUFFER_APPEND_ERROR)&&w.some(({codecSet:lt,audioCodec:Xe})=>o.codecSet!==lt&&o.audioCodec===Xe),{type:Qe,groupId:Ne}=(c=t.context)!=null?c:{};for(let lt=w.length;lt--;){const Xe=(lt+M)%w.length;if(Xe!==M&&Xe>=z&&Xe<=K&&w[Xe].loadError===0){var p,g;const ct=w[Xe];if(A===I.FRAG_GAP&&t.frag){const Lt=w[Xe].details;if(Lt){const et=fa(t.frag,Lt.fragments,t.frag.start);if(et!=null&&et.gap)continue}}else{if(Qe===di.AUDIO_TRACK&&ct.hasAudioGroup(Ne)||Qe===di.SUBTITLE_TRACK&&ct.hasSubtitleGroup(Ne))continue;if(Z===Wt.AUDIO&&(p=o.audioGroups)!=null&&p.some(Lt=>ct.hasAudioGroup(Lt))||Z===Wt.SUBTITLE&&(g=o.subtitleGroups)!=null&&g.some(Lt=>ct.hasSubtitleGroup(Lt))||xe&&o.audioCodec===ct.audioCodec||!xe&&o.audioCodec!==ct.audioCodec||Be&&o.codecSet===ct.codecSet)continue}_=Xe;break}}if(_>-1&&a.loadLevel!==_)return t.levelRetry=!0,this.playlistError=0,{action:pi.SendAlternateToPenaltyBox,flags:Qi.None,nextAutoLevel:_}}return{action:pi.SendAlternateToPenaltyBox,flags:Qi.MoveAllAlternatesMatchingHost}}onErrorOut(t,n){var a;switch((a=n.errorAction)==null?void 0:a.action){case pi.DoNothing:break;case pi.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(n),!n.errorAction.resolved&&n.details!==I.FRAG_GAP?n.fatal=!0:/MediaSource readyState: ended/.test(n.error.message)&&(this.warn(`MediaSource ended after "${n.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break;case pi.RetryRequest:break}if(n.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(t){const n=this.hls,a=t.errorAction;if(!a)return;const{flags:o,hdcpLevel:u,nextAutoLevel:c}=a;switch(o){case Qi.None:this.switchLevel(t,c);break;case Qi.MoveAllAlternatesMatchingHDCP:u&&(n.maxHdcpLevel=wo[wo.indexOf(u)-1],a.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${n.maxHdcpLevel}" or lower`);break}a.resolved||this.switchLevel(t,c)}switchLevel(t,n){n!==void 0&&t.errorAction&&(this.warn(`switching to level ${n} after ${t.details}`),this.hls.nextAutoLevel=n,t.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}}class Ka{constructor(t,n){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=S.log.bind(S,`${n}:`),this.warn=S.warn.bind(S,`${n}:`),this.hls=t}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(t,n){const a=n==null?void 0:n.renditionReports;if(a){let o=-1;for(let u=0;u<a.length;u++){const c=a[u];let p;try{p=new self.URL(c.URI,n.url).href}catch(g){S.warn(`Could not construct new URL for Rendition Report: ${g}`),p=c.URI||""}if(p===t){o=u;break}else p===t.substring(0,p.length)&&(o=u)}if(o!==-1){const u=a[o],c=parseInt(u["LAST-MSN"])||(n==null?void 0:n.lastPartSn);let p=parseInt(u["LAST-PART"])||(n==null?void 0:n.lastPartIndex);if(this.hls.config.lowLatencyMode){const g=Math.min(n.age-n.partTarget,n.targetduration);p>=0&&g>n.partTarget&&(p+=1)}return new ha(c,p>=0?p:void 0,zr.No)}}}loadPlaylist(t){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(t){return this.canLoad&&!!t&&!!t.url&&(!t.details||t.details.live)}shouldReloadPlaylist(t){return this.timer===-1&&this.requestScheduled===-1&&this.shouldLoadPlaylist(t)}playlistLoaded(t,n,a){const{details:o,stats:u}=n,c=self.performance.now(),p=u.loading.first?Math.max(0,c-u.loading.first):0;if(o.advancedDateTime=Date.now()-p,o.live||a!=null&&a.live){if(o.reloaded(a),a&&this.log(`live playlist ${t} ${o.advanced?"REFRESHED "+o.lastPartSn+"-"+o.lastPartIndex:o.updated?"UPDATED":"MISSED"}`),a&&o.fragments.length>0&&Ol(a,o),!this.canLoad||!o.live)return;let g,A,_;if(o.canBlockReload&&o.endSN&&o.advanced){const ne=this.hls.config.lowLatencyMode,xe=o.lastPartSn,de=o.endSN,Be=o.lastPartIndex,Qe=Be!==-1,Ne=xe===de,lt=ne?0:Be;Qe?(A=Ne?de+1:xe,_=Ne?lt:Be+1):A=de+1;const Xe=o.age,ct=Xe+o.ageHeader;let Lt=Math.min(ct-o.partTarget,o.targetduration*1.5);if(Lt>0){if(a&&Lt>a.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${a.tuneInGoal} to: ${Lt} with playlist age: ${o.age}`),Lt=0;else{const et=Math.floor(Lt/o.targetduration);A+=et,_!==void 0&&(_+=Math.round(Lt%o.targetduration/o.partTarget)),this.log(`CDN Tune-in age: ${o.ageHeader}s last advanced ${Xe.toFixed(2)}s goal: ${Lt} skip sn ${et} to part ${_}`)}o.tuneInGoal=Lt}if(g=this.getDeliveryDirectives(o,n.deliveryDirectives,A,_),ne||!Ne){this.loadPlaylist(g);return}}else(o.canBlockReload||o.canSkipUntil)&&(g=this.getDeliveryDirectives(o,n.deliveryDirectives,A,_));const w=this.hls.mainForwardBufferInfo,M=w?w.end-w.len:0,z=(o.edge-M)*1e3,K=Ml(o,z);o.updated&&c>this.requestScheduled+K&&(this.requestScheduled=u.loading.start),A!==void 0&&o.canBlockReload?this.requestScheduled=u.loading.first+K-(o.partTarget*1e3||1e3):this.requestScheduled===-1||this.requestScheduled+K<c?this.requestScheduled=c:this.requestScheduled-c<=0&&(this.requestScheduled+=K);let Z=this.requestScheduled-c;Z=Math.max(0,Z),this.log(`reload live playlist ${t} in ${Math.round(Z)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(g),Z)}else this.clearTimer()}getDeliveryDirectives(t,n,a,o){let u=Pl(t,a);return n!=null&&n.skip&&t.deltaUpdateFailed&&(a=n.msn,o=n.part,u=zr.No),new ha(a,o,u)}checkRetry(t){const n=t.details,a=Pi(t),o=t.errorAction,{action:u,retryCount:c=0,retryConfig:p}=o||{},g=!!o&&!!p&&(u===pi.RetryRequest||!o.resolved&&u===pi.SendAlternateToPenaltyBox);if(g){var A;if(this.requestScheduled=-1,c>=p.maxNumRetry)return!1;if(a&&(A=t.context)!=null&&A.deliveryDirectives)this.warn(`Retrying playlist loading ${c+1}/${p.maxNumRetry} after "${n}" without delivery-directives`),this.loadPlaylist();else{const _=Xr(p,c);this.timer=self.setTimeout(()=>this.loadPlaylist(),_),this.warn(`Retrying playlist loading ${c+1}/${p.maxNumRetry} after "${n}" in ${_}ms`)}t.levelRetry=!0,o.resolved=!0}return g}}class Br{constructor(t,n=0,a=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=t,this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=n,this.totalWeight_=a}sample(t,n){const a=Math.pow(this.alpha_,t);this.estimate_=n*(1-a)+a*this.estimate_,this.totalWeight_+=t}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const t=1-Math.pow(this.alpha_,this.totalWeight_);if(t)return this.estimate_/t}return this.estimate_}}class Us{constructor(t,n,a,o=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=a,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Br(t),this.fast_=new Br(n),this.defaultTTFB_=o,this.ttfb_=new Br(t)}update(t,n){const{slow_:a,fast_:o,ttfb_:u}=this;a.halfLife!==t&&(this.slow_=new Br(t,a.getEstimate(),a.getTotalWeight())),o.halfLife!==n&&(this.fast_=new Br(n,o.getEstimate(),o.getTotalWeight())),u.halfLife!==t&&(this.ttfb_=new Br(t,u.getEstimate(),u.getTotalWeight()))}sample(t,n){t=Math.max(t,this.minDelayMs_);const a=8*n,o=t/1e3,u=a/o;this.fast_.sample(o,u),this.slow_.sample(o,u)}sampleTTFB(t){const n=t/1e3,a=Math.sqrt(2)*Math.exp(-Math.pow(n,2)/2);this.ttfb_.sample(a,Math.max(t,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}const Mr={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},ma={};function mr(h,t,n,a,o,u){const c=h.audioCodec?h.audioGroups:null,p=u==null?void 0:u.audioCodec,g=u==null?void 0:u.channels,A=g?parseInt(g):p?Infinity:2;let _=null;if(c!=null&&c.length)try{c.length===1&&c[0]?_=t.groups[c[0]].channels:_=c.reduce((w,M)=>{if(M){const z=t.groups[M];if(!z)throw new Error(`Audio track group ${M} not found`);Object.keys(z.channels).forEach(K=>{w[K]=(w[K]||0)+z.channels[K]})}return w},{2:0})}catch(w){return!0}return h.videoCodec!==void 0&&(h.width>1920&&h.height>1088||h.height>1920&&h.width>1088||h.frameRate>Math.max(a,30)||h.videoRange!=="SDR"&&h.videoRange!==n||h.bitrate>Math.max(o,8e6))||!!_&&ie(A)&&Object.keys(_).some(w=>parseInt(w)>A)}function Pn(h,t,n){const a=h.videoCodec,o=h.audioCodec;if(!a||!o||!n)return Promise.resolve(Mr);const u={width:h.width,height:h.height,bitrate:Math.ceil(Math.max(h.bitrate*.9,h.averageBitrate)),framerate:h.frameRate||30},c=h.videoRange;c!=="SDR"&&(u.transferFunction=c.toLowerCase());const p=a.split(",").map(g=>({type:"media-source",video:nt(nt({},u),{},{contentType:ds(g,"video")})}));return o&&h.audioGroups&&h.audioGroups.forEach(g=>{var A;!g||(A=t.groups[g])==null||A.tracks.forEach(_=>{if(_.groupId===g){const w=_.channels||"",M=parseFloat(w);ie(M)&&M>2&&p.push.apply(p,o.split(",").map(z=>({type:"media-source",audio:{contentType:ds(z,"audio"),channels:""+M}})))}})}),Promise.all(p.map(g=>{const A=Ul(g);return ma[A]||(ma[A]=n.decodingInfo(g))})).then(g=>({supported:!g.some(A=>!A.supported),configurations:p,decodingInfoResults:g})).catch(g=>({supported:!1,configurations:p,decodingInfoResults:[],error:g}))}function Ul(h){const{audio:t,video:n}=h,a=n||t;if(a){const o=a.contentType.split('"')[1];if(n)return`r${n.height}x${n.width}f${Math.ceil(n.framerate)}${n.transferFunction||"sd"}_${o}_${Math.ceil(n.bitrate/1e5)}`;if(t)return`c${t.channels}${t.spatialRendering?"s":"n"}_${o}`}return""}function Io(){if(typeof matchMedia=="function"){const h=matchMedia("(dynamic-range: high)"),t=matchMedia("bad query");if(h.media!==t.media)return h.matches===!0}return!1}function jl(h,t){let n=!1,a=[];return h&&(n=h!=="SDR",a=[h]),t&&(a=t.allowedVideoRanges||$a.slice(0),n=t.preferHDR!==void 0?t.preferHDR:Io(),n?a=a.filter(o=>o!=="SDR"):a=["SDR"]),{preferHDR:n,allowedVideoRanges:a}}function Fr(h,t,n,a,o){const u=Object.keys(h),c=a==null?void 0:a.channels,p=a==null?void 0:a.audioCodec,g=c&&parseInt(c)===2;let A=!0,_=!1,w=Infinity,M=Infinity,z=Infinity,K=0,Z=[];const{preferHDR:ne,allowedVideoRanges:xe}=jl(t,o);for(let Ne=u.length;Ne--;){const lt=h[u[Ne]];A=lt.channels[2]>0,w=Math.min(w,lt.minHeight),M=Math.min(M,lt.minFramerate),z=Math.min(z,lt.minBitrate);const Xe=xe.filter(ct=>lt.videoRanges[ct]>0);Xe.length>0&&(_=!0,Z=Xe)}w=ie(w)?w:0,M=ie(M)?M:0;const de=Math.max(1080,w),Be=Math.max(30,M);return z=ie(z)?z:n,n=Math.max(z,n),_||(t=void 0,Z=[]),{codecSet:u.reduce((Ne,lt)=>{const Xe=h[lt];if(lt===Ne)return Ne;if(Xe.minBitrate>n)return On(lt,`min bitrate of ${Xe.minBitrate} > current estimate of ${n}`),Ne;if(!Xe.hasDefaultAudio)return On(lt,"no renditions with default or auto-select sound found"),Ne;if(p&&lt.indexOf(p.substring(0,4))%5!=0)return On(lt,`audio codec preference "${p}" not found`),Ne;if(c&&!g){if(!Xe.channels[c])return On(lt,`no renditions with ${c} channel sound found (channels options: ${Object.keys(Xe.channels)})`),Ne}else if((!p||g)&&A&&Xe.channels["2"]===0)return On(lt,"no renditions with stereo sound found"),Ne;return Xe.minHeight>de?(On(lt,`min resolution of ${Xe.minHeight} > maximum of ${de}`),Ne):Xe.minFramerate>Be?(On(lt,`min framerate of ${Xe.minFramerate} > maximum of ${Be}`),Ne):Z.some(ct=>Xe.videoRanges[ct]>0)?Xe.maxScore<K?(On(lt,`max score of ${Xe.maxScore} < selected max of ${K}`),Ne):Ne&&(cs(lt)>=cs(Ne)||Xe.fragmentError>h[Ne].fragmentError)?Ne:(K=Xe.maxScore,lt):(On(lt,`no variants with VIDEO-RANGE of ${JSON.stringify(Z)} found`),Ne)},void 0),videoRanges:Z,preferHDR:ne,minFramerate:M,minBitrate:z}}function On(h,t){S.log(`[abr] start candidates with "${h}" ignored because ${t}`)}function Ro(h){return h.reduce((t,n)=>{let a=t.groups[n.groupId];a||(a=t.groups[n.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),a.tracks.push(n);const o=n.channels||"2";return a.channels[o]=(a.channels[o]||0)+1,a.hasDefault=a.hasDefault||n.default,a.hasAutoSelect=a.hasAutoSelect||n.autoselect,a.hasDefault&&(t.hasDefaultAudio=!0),a.hasAutoSelect&&(t.hasAutoSelectAudio=!0),t},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function js(h,t,n,a){return h.slice(n,a+1).reduce((o,u)=>{if(!u.codecSet)return o;const c=u.audioGroups;let p=o[u.codecSet];p||(o[u.codecSet]=p={minBitrate:Infinity,minHeight:Infinity,minFramerate:Infinity,maxScore:0,videoRanges:{SDR:0},channels:{"2":0},hasDefaultAudio:!c,fragmentError:0}),p.minBitrate=Math.min(p.minBitrate,u.bitrate);const g=Math.min(u.height,u.width);return p.minHeight=Math.min(p.minHeight,g),p.minFramerate=Math.min(p.minFramerate,u.frameRate),p.maxScore=Math.max(p.maxScore,u.score),p.fragmentError+=u.fragmentError,p.videoRanges[u.videoRange]=(p.videoRanges[u.videoRange]||0)+1,c&&c.forEach(A=>{if(!A)return;const _=t.groups[A];p.hasDefaultAudio=p.hasDefaultAudio||t.hasDefaultAudio?_.hasDefault:_.hasAutoSelect||!t.hasDefaultAudio&&!t.hasAutoSelectAudio,Object.keys(_.channels).forEach(w=>{p.channels[w]=(p.channels[w]||0)+_.channels[w]})}),o},{})}function Li(h,t,n){if("attrs"in h){const a=t.indexOf(h);if(a!==-1)return a}for(let a=0;a<t.length;a++){const o=t[a];if(ys(h,o,n))return a}return-1}function ys(h,t,n){const{groupId:a,name:o,lang:u,assocLang:c,characteristics:p,default:g}=h,A=h.forced;return(a===void 0||t.groupId===a)&&(o===void 0||t.name===o)&&(u===void 0||t.lang===u)&&(u===void 0||t.assocLang===c)&&(g===void 0||t.default===g)&&(A===void 0||t.forced===A)&&(p===void 0||Wa(p,t.characteristics))&&(n===void 0||n(h,t))}function Wa(h,t=""){const n=h.split(","),a=t.split(",");return n.length===a.length&&!n.some(o=>a.indexOf(o)===-1)}function ni(h,t){const{audioCodec:n,channels:a}=h;return(n===void 0||(t.audioCodec||"").substring(0,4)===n.substring(0,4))&&(a===void 0||a===(t.channels||"2"))}function vs(h,t,n,a,o){const u=t[a],p=t.reduce((M,z,K)=>{const Z=z.uri;return(M[Z]||(M[Z]=[])).push(K),M},{})[u.uri];p.length>1&&(a=Math.max.apply(Math,p));const g=u.videoRange,A=u.frameRate,_=u.codecSet.substring(0,4),w=Po(t,a,M=>{if(M.videoRange!==g||M.frameRate!==A||M.codecSet.substring(0,4)!==_)return!1;const z=M.audioGroups,K=n.filter(Z=>!z||z.indexOf(Z.groupId)!==-1);return Li(h,K,o)>-1});return w>-1?w:Po(t,a,M=>{const z=M.audioGroups,K=n.filter(Z=>!z||z.indexOf(Z.groupId)!==-1);return Li(h,K,o)>-1})}function Po(h,t,n){for(let a=t;a;a--)if(n(h[a]))return a;for(let a=t+1;a<h.length;a++)if(n(h[a]))return a;return-1}class Oo{constructor(t){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this._abandonRulesCheck=()=>{const{fragCurrent:n,partCurrent:a,hls:o}=this,{autoLevelEnabled:u,media:c}=o;if(!n||!c)return;const p=performance.now(),g=a?a.stats:n.stats,A=a?a.duration:n.duration,_=p-g.loading.start,w=o.minAutoLevel;if(g.aborted||g.loaded&&g.loaded===g.total||n.level<=w){this.clearTimer(),this._nextAutoLevel=-1;return}if(!u||c.paused||!c.playbackRate||!c.readyState)return;const M=o.mainForwardBufferInfo;if(M===null)return;const z=this.bwEstimator.getEstimateTTFB(),K=Math.abs(c.playbackRate);if(_<=Math.max(z,1e3*(A/(K*2))))return;const Z=M.len/K,ne=g.loading.first?g.loading.first-g.loading.start:-1,xe=g.loaded&&ne>-1,de=this.getBwEstimate(),Be=o.levels,Qe=Be[n.level],Ne=g.total||Math.max(g.loaded,Math.round(A*Qe.averageBitrate/8));let lt=xe?_-ne:_;lt<1&&xe&&(lt=Math.min(_,g.loaded*8/de));const Xe=xe?g.loaded*1e3/lt:0,ct=Xe?(Ne-g.loaded)/Xe:Ne*8/de+z/1e3;if(ct<=Z)return;const Lt=Xe?Xe*8:de;let et=Number.POSITIVE_INFINITY,st;for(st=n.level-1;st>w;st--){const St=Be[st].maxBitrate;if(et=this.getTimeToLoadFrag(z/1e3,Lt,A*St,!Be[st].details),et<Z)break}if(et>=ct||et>A*10)return;o.nextLoadLevel=o.nextAutoLevel=st,xe?this.bwEstimator.sample(_-Math.min(z,ne),g.loaded):this.bwEstimator.sampleTTFB(_);const Ht=Be[st].maxBitrate;this.getBwEstimate()*this.hls.config.abrBandWidthUpFactor>Ht&&this.resetEstimator(Ht),this.clearTimer(),S.warn(`[abr] Fragment ${n.sn}${a?" part "+a.index:""} of level ${n.level} is loading too slowly;
      Time to underbuffer: ${Z.toFixed(3)} s
      Estimated load time for current fragment: ${ct.toFixed(3)} s
      Estimated load time for down switch fragment: ${et.toFixed(3)} s
      TTFB estimate: ${ne|0} ms
      Current BW estimate: ${ie(de)?de|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${st} @ ${Ht|0} bps`),o.trigger(v.FRAG_LOAD_EMERGENCY_ABORTED,{frag:n,part:a,stats:g})},this.hls=t,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(t){t&&(S.log(`setting initial bwe to ${t}`),this.hls.config.abrEwmaDefaultEstimate=t),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const t=this.hls.config;return new Us(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate)}registerListeners(){const{hls:t}=this;t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.FRAG_LOADING,this.onFragLoading,this),t.on(v.FRAG_LOADED,this.onFragLoaded,this),t.on(v.FRAG_BUFFERED,this.onFragBuffered,this),t.on(v.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(v.LEVEL_LOADED,this.onLevelLoaded,this),t.on(v.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(v.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),t.on(v.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;!t||(t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.FRAG_LOADING,this.onFragLoading,this),t.off(v.FRAG_LOADED,this.onFragLoaded,this),t.off(v.FRAG_BUFFERED,this.onFragBuffered,this),t.off(v.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(v.LEVEL_LOADED,this.onLevelLoaded,this),t.off(v.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(v.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),t.off(v.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(t,n){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(t,n){const a=n.frag;if(!this.ignoreFragment(a)){if(!a.bitrateTest){var o;this.fragCurrent=a,this.partCurrent=(o=n.part)!=null?o:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(t,n){this.clearTimer()}onError(t,n){if(!n.fatal)switch(n.details){case I.BUFFER_ADD_CODEC_ERROR:case I.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case I.FRAG_LOAD_TIMEOUT:{const a=n.frag,{fragCurrent:o,partCurrent:u}=this;if(a&&o&&a.sn===o.sn&&a.level===o.level){const c=performance.now(),p=u?u.stats:a.stats,g=c-p.loading.start,A=p.loading.first?p.loading.first-p.loading.start:-1;if(p.loaded&&A>-1){const w=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(g-Math.min(w,A),p.loaded)}else this.bwEstimator.sampleTTFB(g)}break}}}getTimeToLoadFrag(t,n,a,o){const u=t+a/n,c=o?this.lastLevelLoadSec:0;return u+c}onLevelLoaded(t,n){const a=this.hls.config,{loading:o}=n.stats,u=o.end-o.start;ie(u)&&(this.lastLevelLoadSec=u/1e3),n.details.live?this.bwEstimator.update(a.abrEwmaSlowLive,a.abrEwmaFastLive):this.bwEstimator.update(a.abrEwmaSlowVoD,a.abrEwmaFastVoD)}onFragLoaded(t,{frag:n,part:a}){const o=a?a.stats:n.stats;if(n.type===Wt.MAIN&&this.bwEstimator.sampleTTFB(o.loading.first-o.loading.start),!this.ignoreFragment(n)){if(this.clearTimer(),n.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const u=a?a.duration:n.duration,c=this.hls.levels[n.level],p=(c.loaded?c.loaded.bytes:0)+o.loaded,g=(c.loaded?c.loaded.duration:0)+u;c.loaded={bytes:p,duration:g},c.realBitrate=Math.round(8*p/g)}if(n.bitrateTest){const u={stats:o,frag:n,part:a,id:n.type};this.onFragBuffered(v.FRAG_BUFFERED,u),n.bitrateTest=!1}else this.lastLoadedFragLevel=n.level}}onFragBuffered(t,n){const{frag:a,part:o}=n,u=o!=null&&o.stats.loaded?o.stats:a.stats;if(u.aborted||this.ignoreFragment(a))return;const c=u.parsing.end-u.loading.start-Math.min(u.loading.first-u.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(c,u.loaded),u.bwEstimate=this.getBwEstimate(),a.bitrateTest?this.bitrateTestDelay=c/1e3:this.bitrateTestDelay=0}ignoreFragment(t){return t.type!==Wt.MAIN||t.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:t,minAutoLevel:n}=this.hls,a=this.getBwEstimate(),o=this.hls.config.maxStarvationDelay,u=this.findBestLevel(a,n,t,0,o,1,1);if(u>-1)return u;const c=this.hls.firstLevel,p=Math.min(Math.max(c,n),t);return S.warn(`[abr] Could not find best starting auto level. Defaulting to first in playlist ${c} clamped to ${p}`),p}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const t=this.forcedAutoLevel,a=this.bwEstimator.canEstimate(),o=this.lastLoadedFragLevel>-1;if(t!==-1&&(!a||!o||this.nextAutoLevelKey===this.getAutoLevelKey()))return t;const u=a&&o?this.getNextABRAutoLevel():this.firstAutoLevel;if(t!==-1){const c=this.hls.levels;if(c.length>Math.max(t,u)&&c[t].loadError<=c[u].loadError)return t}return this._nextAutoLevel=u,this.nextAutoLevelKey=this.getAutoLevelKey(),u}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:t,partCurrent:n,hls:a}=this,{maxAutoLevel:o,config:u,minAutoLevel:c}=a,p=n?n.duration:t?t.duration:0,g=this.getBwEstimate(),A=this.getStarvationDelay();let _=u.abrBandWidthFactor,w=u.abrBandWidthUpFactor;if(A){const ne=this.findBestLevel(g,c,o,A,0,_,w);if(ne>=0)return ne}let M=p?Math.min(p,u.maxStarvationDelay):u.maxStarvationDelay;if(!A){const ne=this.bitrateTestDelay;ne&&(M=(p?Math.min(p,u.maxLoadingDelay):u.maxLoadingDelay)-ne,S.info(`[abr] bitrate test took ${Math.round(1e3*ne)}ms, set first fragment max fetchDuration to ${Math.round(1e3*M)} ms`),_=w=1)}const z=this.findBestLevel(g,c,o,A,M,_,w);if(S.info(`[abr] ${A?"rebuffering expected":"buffer is empty"}, optimal quality level ${z}`),z>-1)return z;const K=a.levels[c],Z=a.levels[a.loadLevel];return(K==null?void 0:K.bitrate)<(Z==null?void 0:Z.bitrate)?c:a.loadLevel}getStarvationDelay(){const t=this.hls,n=t.media;if(!n)return Infinity;const a=n&&n.playbackRate!==0?Math.abs(n.playbackRate):1,o=t.mainForwardBufferInfo;return(o?o.len:0)/a}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(t,n,a,o,u,c,p){var g;const A=o+u,_=this.lastLoadedFragLevel,w=_===-1?this.hls.firstLevel:_,{fragCurrent:M,partCurrent:z}=this,{levels:K,allAudioTracks:Z,loadLevel:ne,config:xe}=this.hls;if(K.length===1)return 0;const de=K[w],Be=!!(de!=null&&(g=de.details)!=null&&g.live),Qe=ne===-1||_===-1;let Ne,lt="SDR",Xe=(de==null?void 0:de.frameRate)||0;const{audioPreference:ct,videoPreference:Lt}=xe,et=this.audioTracksByGroup||(this.audioTracksByGroup=Ro(Z));if(Qe){if(this.firstSelection!==-1)return this.firstSelection;const Zt=this.codecTiers||(this.codecTiers=js(K,et,n,a)),qt=Fr(Zt,lt,t,ct,Lt),{codecSet:hi,videoRanges:Bi,minFramerate:$t,minBitrate:Bt,preferHDR:Ei}=qt;Ne=hi,lt=Ei?Bi[Bi.length-1]:Bi[0],Xe=$t,t=Math.max(t,Bt),S.log(`[abr] picked start tier ${JSON.stringify(qt)}`)}else Ne=de==null?void 0:de.codecSet,lt=de==null?void 0:de.videoRange;const st=z?z.duration:M?M.duration:0,Ht=this.bwEstimator.getEstimateTTFB()/1e3,St=[];for(let Zt=a;Zt>=n;Zt--){var zt;const qt=K[Zt],hi=Zt>w;if(!qt)continue;if(xe.useMediaCapabilities&&!qt.supportedResult&&!qt.supportedPromise){const tn=navigator.mediaCapabilities;typeof(tn==null?void 0:tn.decodingInfo)=="function"&&mr(qt,et,lt,Xe,t,ct)?(qt.supportedPromise=Pn(qt,et,tn),qt.supportedPromise.then(sn=>{if(!this.hls)return;qt.supportedResult=sn;const hn=this.hls.levels,Nn=hn.indexOf(qt);sn.error?S.warn(`[abr] MediaCapabilities decodingInfo error: "${sn.error}" for level ${Nn} ${JSON.stringify(sn)}`):sn.supported||(S.warn(`[abr] Unsupported MediaCapabilities decodingInfo result for level ${Nn} ${JSON.stringify(sn)}`),Nn>-1&&hn.length>1&&(S.log(`[abr] Removing unsupported level ${Nn}`),this.hls.removeLevel(Nn)))})):qt.supportedResult=Mr}if(Ne&&qt.codecSet!==Ne||lt&&qt.videoRange!==lt||hi&&Xe>qt.frameRate||!hi&&Xe>0&&Xe<qt.frameRate||qt.supportedResult&&!((zt=qt.supportedResult.decodingInfoResults)!=null&&zt[0].smooth)){St.push(Zt);continue}const Bi=qt.details,$t=(z?Bi==null?void 0:Bi.partTarget:Bi==null?void 0:Bi.averagetargetduration)||st;let Bt;hi?Bt=p*t:Bt=c*t;const Ei=st&&o>=st*2&&u===0?K[Zt].averageBitrate:K[Zt].maxBitrate,ti=this.getTimeToLoadFrag(Ht,Bt,Ei*$t,Bi===void 0);if(Bt>=Ei&&(Zt===_||qt.loadError===0&&qt.fragmentError===0)&&(ti<=Ht||!ie(ti)||Be&&!this.bitrateTestDelay||ti<A)){const tn=this.forcedAutoLevel;return Zt!==ne&&(tn===-1||tn!==ne)&&(St.length&&S.trace(`[abr] Skipped level(s) ${St.join(",")} of ${a} max with CODECS and VIDEO-RANGE:"${K[St[0]].codecs}" ${K[St[0]].videoRange}; not compatible with "${de.codecs}" ${lt}`),S.info(`[abr] switch candidate:${w}->${Zt} adjustedbw(${Math.round(Bt)})-bitrate=${Math.round(Bt-Ei)} ttfb:${Ht.toFixed(1)} avgDuration:${$t.toFixed(1)} maxFetchDuration:${A.toFixed(1)} fetchDuration:${ti.toFixed(1)} firstSelection:${Qe} codecSet:${Ne} videoRange:${lt} hls.loadLevel:${ne}`)),Qe&&(this.firstSelection=Zt),Zt}}return-1}set nextAutoLevel(t){const{maxAutoLevel:n,minAutoLevel:a}=this.hls,o=Math.min(Math.max(t,a),n);this._nextAutoLevel!==o&&(this.nextAutoLevelKey="",this._nextAutoLevel=o)}}class As{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(t){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,t),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}var Ui={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class tr{constructor(t){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=t,this._registerListeners()}_registerListeners(){const{hls:t}=this;t.on(v.BUFFER_APPENDED,this.onBufferAppended,this),t.on(v.FRAG_BUFFERED,this.onFragBuffered,this),t.on(v.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:t}=this;t.off(v.BUFFER_APPENDED,this.onBufferAppended,this),t.off(v.FRAG_BUFFERED,this.onFragBuffered,this),t.off(v.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(t,n){const a=this.activePartLists[n];if(a)for(let o=a.length;o--;){const u=a[o];if(!u)break;const c=u.end;if(u.start<=t&&c!==null&&t<=c)return u}return this.getBufferedFrag(t,n)}getBufferedFrag(t,n){const{fragments:a}=this,o=Object.keys(a);for(let u=o.length;u--;){const c=a[o[u]];if((c==null?void 0:c.body.type)===n&&c.buffered){const p=c.body;if(p.start<=t&&t<=p.end)return p}}return null}detectEvictedFragments(t,n,a,o){this.timeRanges&&(this.timeRanges[t]=n);const u=(o==null?void 0:o.fragment.sn)||-1;Object.keys(this.fragments).forEach(c=>{const p=this.fragments[c];if(!p||u>=p.body.sn)return;if(!p.buffered&&!p.loaded){p.body.type===a&&this.removeFragment(p.body);return}const g=p.range[t];!g||g.time.some(A=>{const _=!this.isTimeBuffered(A.startPTS,A.endPTS,n);return _&&this.removeFragment(p.body),_})})}detectPartialFragments(t){const n=this.timeRanges,{frag:a,part:o}=t;if(!n||a.sn==="initSegment")return;const u=ci(a),c=this.fragments[u];if(!c||c.buffered&&a.gap)return;const p=!a.relurl;Object.keys(n).forEach(g=>{const A=a.elementaryStreams[g];if(!A)return;const _=n[g],w=p||A.partial===!0;c.range[g]=this.getBufferedTimes(a,o,w,_)}),c.loaded=null,Object.keys(c.range).length?(c.buffered=!0,(c.body.endList=a.endList||c.body.endList)&&(this.endListFragments[c.body.type]=c),gr(c)||this.removeParts(a.sn-1,a.type)):this.removeFragment(c.body)}removeParts(t,n){const a=this.activePartLists[n];!a||(this.activePartLists[n]=a.filter(o=>o.fragment.sn>=t))}fragBuffered(t,n){const a=ci(t);let o=this.fragments[a];!o&&n&&(o=this.fragments[a]={body:t,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},t.gap&&(this.hasGaps=!0)),o&&(o.loaded=null,o.buffered=!0)}getBufferedTimes(t,n,a,o){const u={time:[],partial:a},c=t.start,p=t.end,g=t.minEndPTS||p,A=t.maxStartPTS||c;for(let _=0;_<o.length;_++){const w=o.start(_)-this.bufferPadding,M=o.end(_)+this.bufferPadding;if(A>=w&&g<=M){u.time.push({startPTS:Math.max(c,o.start(_)),endPTS:Math.min(p,o.end(_))});break}else if(c<M&&p>w){const z=Math.max(c,o.start(_)),K=Math.min(p,o.end(_));K>z&&(u.partial=!0,u.time.push({startPTS:z,endPTS:K}))}else if(p<=w)break}return u}getPartialFragment(t){let n=null,a,o,u,c=0;const{bufferPadding:p,fragments:g}=this;return Object.keys(g).forEach(A=>{const _=g[A];!_||gr(_)&&(o=_.body.start-p,u=_.body.end+p,t>=o&&t<=u&&(a=Math.min(t-o,u-t),c<=a&&(n=_.body,c=a)))}),n}isEndListAppended(t){const n=this.endListFragments[t];return n!==void 0&&(n.buffered||gr(n))}getState(t){const n=ci(t),a=this.fragments[n];return a?a.buffered?gr(a)?Ui.PARTIAL:Ui.OK:Ui.APPENDING:Ui.NOT_LOADED}isTimeBuffered(t,n,a){let o,u;for(let c=0;c<a.length;c++){if(o=a.start(c)-this.bufferPadding,u=a.end(c)+this.bufferPadding,t>=o&&n<=u)return!0;if(n<=o)return!1}return!1}onFragLoaded(t,n){const{frag:a,part:o}=n;if(a.sn==="initSegment"||a.bitrateTest)return;const u=o?null:n,c=ci(a);this.fragments[c]={body:a,appendedPTS:null,loaded:u,buffered:!1,range:Object.create(null)}}onBufferAppended(t,n){const{frag:a,part:o,timeRanges:u}=n;if(a.sn==="initSegment")return;const c=a.type;if(o){let p=this.activePartLists[c];p||(this.activePartLists[c]=p=[]),p.push(o)}this.timeRanges=u,Object.keys(u).forEach(p=>{const g=u[p];this.detectEvictedFragments(p,g,c,o)})}onFragBuffered(t,n){this.detectPartialFragments(n)}hasFragment(t){const n=ci(t);return!!this.fragments[n]}hasParts(t){var n;return!!((n=this.activePartLists[t])!=null&&n.length)}removeFragmentsInRange(t,n,a,o,u){o&&!this.hasGaps||Object.keys(this.fragments).forEach(c=>{const p=this.fragments[c];if(!p)return;const g=p.body;g.type!==a||o&&!g.gap||g.start<n&&g.end>t&&(p.buffered||u)&&this.removeFragment(g)})}removeFragment(t){const n=ci(t);t.stats.loaded=0,t.clearElementaryStreamInfo();const a=this.activePartLists[t.type];if(a){const o=t.sn;this.activePartLists[t.type]=a.filter(u=>u.fragment.sn!==o)}delete this.fragments[n],t.endList&&delete this.endListFragments[t.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function gr(h){var t,n,a;return h.buffered&&(h.body.gap||((t=h.range.video)==null?void 0:t.partial)||((n=h.range.audio)==null?void 0:n.partial)||((a=h.range.audiovideo)==null?void 0:a.partial))}function ci(h){return`${h.type}_${h.level}_${h.sn}`}const Bo={length:0,start:()=>0,end:()=>0};class _i{static isBuffered(t,n){try{if(t){const a=_i.getBuffered(t);for(let o=0;o<a.length;o++)if(n>=a.start(o)&&n<=a.end(o))return!0}}catch(a){}return!1}static bufferInfo(t,n,a){try{if(t){const o=_i.getBuffered(t),u=[];let c;for(c=0;c<o.length;c++)u.push({start:o.start(c),end:o.end(c)});return this.bufferedInfo(u,n,a)}}catch(o){}return{len:0,start:n,end:n,nextStart:void 0}}static bufferedInfo(t,n,a){n=Math.max(0,n),t.sort(function(A,_){const w=A.start-_.start;return w||_.end-A.end});let o=[];if(a)for(let A=0;A<t.length;A++){const _=o.length;if(_){const w=o[_-1].end;t[A].start-w<a?t[A].end>w&&(o[_-1].end=t[A].end):o.push(t[A])}else o.push(t[A])}else o=t;let u=0,c,p=n,g=n;for(let A=0;A<o.length;A++){const _=o[A].start,w=o[A].end;if(n+a>=_&&n<w)p=_,g=w,u=g-n;else if(n+a<_){c=_;break}}return{len:u,start:p||0,end:g||0,nextStart:c}}static getBuffered(t){try{return t.buffered}catch(n){return S.log("failed to get media.buffered",n),Bo}}}class za{constructor(t,n,a,o=0,u=-1,c=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=ir(),this.buffering={audio:ir(),video:ir(),audiovideo:ir()},this.level=t,this.sn=n,this.id=a,this.size=o,this.part=u,this.partial=c}}function ir(){return{start:0,executeStart:0,executeEnd:0,end:0}}function $s(h,t){for(let a=0,o=h.length;a<o;a++){var n;if(((n=h[a])==null?void 0:n.cc)===t)return h[a]}return null}function cn(h,t,n){return!!(t&&(n.endCC>n.startCC||h&&h.cc<n.startCC))}function Ya(h,t){const n=h.fragments,a=t.fragments;if(!a.length||!n.length){S.log("No fragments to align");return}const o=$s(n,a[0].cc);if(!o||o&&!o.startPTS){S.log("No frag in previous level to align on");return}return o}function Vs(h,t){if(h){const n=h.start+t;h.start=h.startPTS=n,h.endPTS=n+h.duration}}function Jr(h,t){const n=t.fragments;for(let a=0,o=n.length;a<o;a++)Vs(n[a],h);t.fragmentHint&&Vs(t.fragmentHint,h),t.alignedSliding=!0}function bs(h,t,n){!t||(Sn(h,n,t),!n.alignedSliding&&t&&_s(n,t),!n.alignedSliding&&t&&!n.skippedSegments&&Ri(t,n))}function Sn(h,t,n){if(cn(h,n,t)){const a=Ya(n,t);a&&ie(a.start)&&(S.log(`Adjusting PTS using last level due to CC increase within current level ${t.url}`),Jr(a.start,t))}}function _s(h,t){if(!h.hasProgramDateTime||!t.hasProgramDateTime)return;const n=h.fragments,a=t.fragments;if(!n.length||!a.length)return;let o,u;const c=Math.min(t.endCC,h.endCC);t.startCC<c&&h.startCC<c&&(o=$s(a,c),u=$s(n,c)),(!o||!u)&&(o=a[Math.floor(a.length/2)],u=$s(n,o.cc)||n[Math.floor(n.length/2)]);const p=o.programDateTime,g=u.programDateTime;if(!p||!g)return;const A=(g-p)/1e3-(u.start-o.start);Jr(A,h)}const Gs=Math.pow(2,17);class Mo{constructor(t){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=t}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(t,n){const a=t.url;if(!a)return Promise.reject(new Bn({type:$.NETWORK_ERROR,details:I.FRAG_LOAD_ERROR,fatal:!1,frag:t,error:new Error(`Fragment does not have a ${a?"part list":"url"}`),networkDetails:null}));this.abort();const o=this.config,u=o.fLoader,c=o.loader;return new Promise((p,g)=>{if(this.loader&&this.loader.destroy(),t.gap)if(t.tagList.some(z=>z[0]==="GAP")){g(Hs(t));return}else t.gap=!1;const A=this.loader=t.loader=u?new u(o):new c(o),_=yr(t),w=Ga(o.fragLoadPolicy.default),M={loadPolicy:w,timeout:w.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:t.sn==="initSegment"?Infinity:Gs};t.stats=A.stats,A.load(_,M,{onSuccess:(z,K,Z,ne)=>{this.resetLoader(t,A);let xe=z.data;Z.resetIV&&t.decryptdata&&(t.decryptdata.iv=new Uint8Array(xe.slice(0,16)),xe=xe.slice(16)),p({frag:t,part:null,payload:xe,networkDetails:ne})},onError:(z,K,Z,ne)=>{this.resetLoader(t,A),g(new Bn({type:$.NETWORK_ERROR,details:I.FRAG_LOAD_ERROR,fatal:!1,frag:t,response:nt({url:a,data:void 0},z),error:new Error(`HTTP Error ${z.code} ${z.text}`),networkDetails:Z,stats:ne}))},onAbort:(z,K,Z)=>{this.resetLoader(t,A),g(new Bn({type:$.NETWORK_ERROR,details:I.INTERNAL_ABORTED,fatal:!1,frag:t,error:new Error("Aborted"),networkDetails:Z,stats:z}))},onTimeout:(z,K,Z)=>{this.resetLoader(t,A),g(new Bn({type:$.NETWORK_ERROR,details:I.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,error:new Error(`Timeout after ${M.timeout}ms`),networkDetails:Z,stats:z}))},onProgress:(z,K,Z,ne)=>{n&&n({frag:t,part:null,payload:Z,networkDetails:ne})}})})}loadPart(t,n,a){this.abort();const o=this.config,u=o.fLoader,c=o.loader;return new Promise((p,g)=>{if(this.loader&&this.loader.destroy(),t.gap||n.gap){g(Hs(t,n));return}const A=this.loader=t.loader=u?new u(o):new c(o),_=yr(t,n),w=Ga(o.fragLoadPolicy.default),M={loadPolicy:w,timeout:w.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Gs};n.stats=A.stats,A.load(_,M,{onSuccess:(z,K,Z,ne)=>{this.resetLoader(t,A),this.updateStatsFromPart(t,n);const xe={frag:t,part:n,payload:z.data,networkDetails:ne};a(xe),p(xe)},onError:(z,K,Z,ne)=>{this.resetLoader(t,A),g(new Bn({type:$.NETWORK_ERROR,details:I.FRAG_LOAD_ERROR,fatal:!1,frag:t,part:n,response:nt({url:_.url,data:void 0},z),error:new Error(`HTTP Error ${z.code} ${z.text}`),networkDetails:Z,stats:ne}))},onAbort:(z,K,Z)=>{t.stats.aborted=n.stats.aborted,this.resetLoader(t,A),g(new Bn({type:$.NETWORK_ERROR,details:I.INTERNAL_ABORTED,fatal:!1,frag:t,part:n,error:new Error("Aborted"),networkDetails:Z,stats:z}))},onTimeout:(z,K,Z)=>{this.resetLoader(t,A),g(new Bn({type:$.NETWORK_ERROR,details:I.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,part:n,error:new Error(`Timeout after ${M.timeout}ms`),networkDetails:Z,stats:z}))}})})}updateStatsFromPart(t,n){const a=t.stats,o=n.stats,u=o.total;if(a.loaded+=o.loaded,u){const g=Math.round(t.duration/n.duration),A=Math.min(Math.round(a.loaded/u),g),w=(g-A)*Math.round(a.loaded/A);a.total=a.loaded+w}else a.total=Math.max(a.loaded,a.total);const c=a.loading,p=o.loading;c.start?c.first+=p.first-p.start:(c.start=p.start,c.first=p.first),c.end=p.end}resetLoader(t,n){t.loader=null,this.loader===n&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),n.destroy()}}function yr(h,t=null){const n=t||h,a={frag:h,part:t,responseType:"arraybuffer",url:n.url,headers:{},rangeStart:0,rangeEnd:0},o=n.byteRangeStartOffset,u=n.byteRangeEndOffset;if(ie(o)&&ie(u)){var c;let p=o,g=u;if(h.sn==="initSegment"&&((c=h.decryptdata)==null?void 0:c.method)==="AES-128"){const A=u-o;A%16&&(g=u+(16-A%16)),o!==0&&(a.resetIV=!0,p=o-16)}a.rangeStart=p,a.rangeEnd=g}return a}function Hs(h,t){const n=new Error(`GAP ${h.gap?"tag":"attribute"} found`),a={type:$.MEDIA_ERROR,details:I.FRAG_GAP,fatal:!1,frag:h,error:n,networkDetails:null};return t&&(a.part=t),(t||h).stats.aborted=!0,new Bn(a)}class Bn extends Error{constructor(t){super(t.error.message);this.data=void 0,this.data=t}}class ga{constructor(t,n){this.subtle=void 0,this.aesIV=void 0,this.subtle=t,this.aesIV=n}decrypt(t,n){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},n,t)}}class vr{constructor(t,n){this.subtle=void 0,this.key=void 0,this.subtle=t,this.key=n}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}function Nr(h){const t=h.byteLength,n=t&&new DataView(h.buffer).getUint8(t-1);return n?ai(h,0,t-n):h}class bn{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(t){const n=new DataView(t),a=new Uint32Array(4);for(let o=0;o<4;o++)a[o]=n.getUint32(o*4);return a}initTable(){const t=this.sBox,n=this.invSBox,a=this.subMix,o=a[0],u=a[1],c=a[2],p=a[3],g=this.invSubMix,A=g[0],_=g[1],w=g[2],M=g[3],z=new Uint32Array(256);let K=0,Z=0,ne=0;for(ne=0;ne<256;ne++)ne<128?z[ne]=ne<<1:z[ne]=ne<<1^283;for(ne=0;ne<256;ne++){let xe=Z^Z<<1^Z<<2^Z<<3^Z<<4;xe=xe>>>8^xe&255^99,t[K]=xe,n[xe]=K;const de=z[K],Be=z[de],Qe=z[Be];let Ne=z[xe]*257^xe*16843008;o[K]=Ne<<24|Ne>>>8,u[K]=Ne<<16|Ne>>>16,c[K]=Ne<<8|Ne>>>24,p[K]=Ne,Ne=Qe*16843009^Be*65537^de*257^K*16843008,A[xe]=Ne<<24|Ne>>>8,_[xe]=Ne<<16|Ne>>>16,w[xe]=Ne<<8|Ne>>>24,M[xe]=Ne,K?(K=de^z[z[z[Qe^de]]],Z^=z[z[Z]]):K=Z=1}}expandKey(t){const n=this.uint8ArrayToUint32Array_(t);let a=!0,o=0;for(;o<n.length&&a;)a=n[o]===this.key[o],o++;if(a)return;this.key=n;const u=this.keySize=n.length;if(u!==4&&u!==6&&u!==8)throw new Error("Invalid aes key size="+u);const c=this.ksRows=(u+6+1)*4;let p,g;const A=this.keySchedule=new Uint32Array(c),_=this.invKeySchedule=new Uint32Array(c),w=this.sBox,M=this.rcon,z=this.invSubMix,K=z[0],Z=z[1],ne=z[2],xe=z[3];let de,Be;for(p=0;p<c;p++){if(p<u){de=A[p]=n[p];continue}Be=de,p%u==0?(Be=Be<<8|Be>>>24,Be=w[Be>>>24]<<24|w[Be>>>16&255]<<16|w[Be>>>8&255]<<8|w[Be&255],Be^=M[p/u|0]<<24):u>6&&p%u==4&&(Be=w[Be>>>24]<<24|w[Be>>>16&255]<<16|w[Be>>>8&255]<<8|w[Be&255]),A[p]=de=(A[p-u]^Be)>>>0}for(g=0;g<c;g++)p=c-g,g&3?Be=A[p]:Be=A[p-4],g<4||p<=4?_[g]=Be:_[g]=K[w[Be>>>24]]^Z[w[Be>>>16&255]]^ne[w[Be>>>8&255]]^xe[w[Be&255]],_[g]=_[g]>>>0}networkToHostOrderSwap(t){return t<<24|(t&65280)<<8|(t&16711680)>>8|t>>>24}decrypt(t,n,a){const o=this.keySize+6,u=this.invKeySchedule,c=this.invSBox,p=this.invSubMix,g=p[0],A=p[1],_=p[2],w=p[3],M=this.uint8ArrayToUint32Array_(a);let z=M[0],K=M[1],Z=M[2],ne=M[3];const xe=new Int32Array(t),de=new Int32Array(xe.length);let Be,Qe,Ne,lt,Xe,ct,Lt,et,st,Ht,St,zt,Zt,qt;const hi=this.networkToHostOrderSwap;for(;n<xe.length;){for(st=hi(xe[n]),Ht=hi(xe[n+1]),St=hi(xe[n+2]),zt=hi(xe[n+3]),Xe=st^u[0],ct=zt^u[1],Lt=St^u[2],et=Ht^u[3],Zt=4,qt=1;qt<o;qt++)Be=g[Xe>>>24]^A[ct>>16&255]^_[Lt>>8&255]^w[et&255]^u[Zt],Qe=g[ct>>>24]^A[Lt>>16&255]^_[et>>8&255]^w[Xe&255]^u[Zt+1],Ne=g[Lt>>>24]^A[et>>16&255]^_[Xe>>8&255]^w[ct&255]^u[Zt+2],lt=g[et>>>24]^A[Xe>>16&255]^_[ct>>8&255]^w[Lt&255]^u[Zt+3],Xe=Be,ct=Qe,Lt=Ne,et=lt,Zt=Zt+4;Be=c[Xe>>>24]<<24^c[ct>>16&255]<<16^c[Lt>>8&255]<<8^c[et&255]^u[Zt],Qe=c[ct>>>24]<<24^c[Lt>>16&255]<<16^c[et>>8&255]<<8^c[Xe&255]^u[Zt+1],Ne=c[Lt>>>24]<<24^c[et>>16&255]<<16^c[Xe>>8&255]<<8^c[ct&255]^u[Zt+2],lt=c[et>>>24]<<24^c[Xe>>16&255]<<16^c[ct>>8&255]<<8^c[Lt&255]^u[Zt+3],de[n]=hi(Be^z),de[n+1]=hi(lt^K),de[n+2]=hi(Ne^Z),de[n+3]=hi(Qe^ne),z=st,K=Ht,Z=St,ne=zt,n=n+4}return de.buffer}}const ya=16;class Zr{constructor(t,{removePKCS7Padding:n=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=t.enableSoftwareAES,this.removePKCS7Padding=n,n)try{const a=self.crypto;a&&(this.subtle=a.subtle||a.webkitSubtle)}catch(a){}this.subtle===null&&(this.useSoftware=!0)}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:t,remainderData:n}=this;if(!t||n)return this.reset(),null;const a=new Uint8Array(t);return this.reset(),this.removePKCS7Padding?Nr(a):a}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(t,n,a){return this.useSoftware?new Promise((o,u)=>{this.softwareDecrypt(new Uint8Array(t),n,a);const c=this.flush();c?o(c.buffer):u(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(t),n,a)}softwareDecrypt(t,n,a){const{currentIV:o,currentResult:u,remainderData:c}=this;this.logOnce("JS AES decrypt"),c&&(t=ft(c,t),this.remainderData=null);const p=this.getValidChunk(t);if(!p.length)return null;o&&(a=o);let g=this.softwareDecrypter;g||(g=this.softwareDecrypter=new bn),g.expandKey(n);const A=u;return this.currentResult=g.decrypt(p.buffer,0,a),this.currentIV=ai(p,-16).buffer,A||null}webCryptoDecrypt(t,n,a){const o=this.subtle;return(this.key!==n||!this.fastAesKey)&&(this.key=n,this.fastAesKey=new vr(o,n)),this.fastAesKey.expandKey().then(u=>o?(this.logOnce("WebCrypto AES decrypt"),new ga(o,new Uint8Array(a)).decrypt(t.buffer,u)):Promise.reject(new Error("web crypto not initialized"))).catch(u=>(S.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${u.name}: ${u.message}`),this.onWebCryptoError(t,n,a)))}onWebCryptoError(t,n,a){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(t,n,a);const o=this.flush();if(o)return o.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(t){let n=t;const a=t.length-t.length%ya;return a!==t.length&&(n=ai(t,0,a),this.remainderData=ai(t,a)),n}logOnce(t){!this.logEnabled||(S.log(`[decrypter]: ${t}`),this.logEnabled=!1)}}const Fo={toString:function(h){let t="";const n=h.length;for(let a=0;a<n;a++)t+=`[${h.start(a).toFixed(3)}-${h.end(a).toFixed(3)}]`;return t}},ot={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Ur extends As{constructor(t,n,a,o,u){super();this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=ot.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=u,this.logPrefix=o,this.log=S.log.bind(S,`${o}:`),this.warn=S.warn.bind(S,`${o}:`),this.hls=t,this.fragmentLoader=new Mo(t.config),this.keyLoader=a,this.fragmentTracker=n,this.config=t.config,this.decrypter=new Zr(t.config),t.on(v.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(t){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const t=this.fragCurrent;t!=null&&t.loader&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=ot.STOPPED}_streamEnded(t,n){if(n.live||t.nextStart||!t.end||!this.media)return!1;const a=n.partList;if(a!=null&&a.length){const u=a[a.length-1];return _i.isBuffered(this.media,u.start+u.duration/2)}const o=n.fragments[n.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(o)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var t;return(t=this.levelLastLoaded)==null?void 0:t.details}}onMediaAttached(t,n){const a=this.media=this.mediaBuffer=n.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),a.addEventListener("seeking",this.onvseeking),a.addEventListener("ended",this.onvended);const o=this.config;this.levels&&o.autoStartLoad&&this.state===ot.STOPPED&&this.startLoad(o.startPosition)}onMediaDetaching(){const t=this.media;t!=null&&t.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),t&&this.onvseeking&&this.onvended&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:t,fragCurrent:n,media:a,mediaBuffer:o,state:u}=this,c=a?a.currentTime:0,p=_i.bufferInfo(o||a,c,t.maxBufferHole);if(this.log(`media seeking to ${ie(c)?c.toFixed(3):c}, state: ${u}`),this.state===ot.ENDED)this.resetLoadingState();else if(n){const g=t.maxFragLookUpTolerance,A=n.start-g,_=n.start+n.duration+g;if(!p.len||_<p.start||A>p.end){const w=c>_;(c<A||w)&&(w&&n.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),n.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}a&&(this.fragmentTracker.removeFragmentsInRange(c,Infinity,this.playlistType,!0),this.lastCurrentTime=c),!this.loadedmetadata&&!p.len&&(this.nextLoadPosition=this.startPosition=c),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(t,n){this.startTimeOffset=n.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.hls.off(v.MANIFEST_LOADED,this.onManifestLoaded,this),this.stopLoad(),super.onHandlerDestroying(),this.hls=null}onHandlerDestroyed(){this.state=ot.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(t,n,a){this._loadFragForPlayback(t,n,a)}_loadFragForPlayback(t,n,a){const o=u=>{if(this.fragContextChanged(t)){this.warn(`Fragment ${t.sn}${u.part?" p: "+u.part.index:""} of level ${t.level} was dropped during download.`),this.fragmentTracker.removeFragment(t);return}t.stats.chunkCount++,this._handleFragmentLoadProgress(u)};this._doFragLoad(t,n,a,o).then(u=>{if(!u)return;const c=this.state;if(this.fragContextChanged(t)){(c===ot.FRAG_LOADING||!this.fragCurrent&&c===ot.PARSING)&&(this.fragmentTracker.removeFragment(t),this.state=ot.IDLE);return}"payload"in u&&(this.log(`Loaded fragment ${t.sn} of level ${t.level}`),this.hls.trigger(v.FRAG_LOADED,u)),this._handleFragmentLoadComplete(u)}).catch(u=>{this.state===ot.STOPPED||this.state===ot.ERROR||(this.warn(u),this.resetFragmentLoading(t))})}clearTrackerIfNeeded(t){var n;const{fragmentTracker:a}=this;if(a.getState(t)===Ui.APPENDING){const u=t.type,c=this.getFwdBufferInfo(this.mediaBuffer,u),p=Math.max(t.duration,c?c.len:this.config.maxBufferLength);this.reduceMaxBufferLength(p)&&a.removeFragment(t)}else((n=this.mediaBuffer)==null?void 0:n.buffered.length)===0?a.removeAllFragments():a.hasParts(t.type)&&(a.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type}),a.getState(t)===Ui.PARTIAL&&a.removeFragment(t))}checkLiveUpdate(t){if(t.updated&&!t.live){const n=t.fragments[t.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:n,part:null,stats:n.stats,id:n.type})}t.fragments[0]||(t.deltaUpdateFailed=!0)}flushMainBuffer(t,n,a=null){if(!(t-n))return;const o={startOffset:t,endOffset:n,type:a};this.hls.trigger(v.BUFFER_FLUSHING,o)}_loadInitSegment(t,n){this._doFragLoad(t,n).then(a=>{if(!a||this.fragContextChanged(t)||!this.levels)throw new Error("init load aborted");return a}).then(a=>{const{hls:o}=this,{payload:u}=a,c=t.decryptdata;if(u&&u.byteLength>0&&c!=null&&c.key&&c.iv&&c.method==="AES-128"){const p=self.performance.now();return this.decrypter.decrypt(new Uint8Array(u),c.key.buffer,c.iv.buffer).catch(g=>{throw o.trigger(v.ERROR,{type:$.MEDIA_ERROR,details:I.FRAG_DECRYPT_ERROR,fatal:!1,error:g,reason:g.message,frag:t}),g}).then(g=>{const A=self.performance.now();return o.trigger(v.FRAG_DECRYPTED,{frag:t,payload:g,stats:{tstart:p,tdecrypt:A}}),a.payload=g,this.completeInitSegmentLoad(a)})}return this.completeInitSegmentLoad(a)}).catch(a=>{this.state===ot.STOPPED||this.state===ot.ERROR||(this.warn(a),this.resetFragmentLoading(t))})}completeInitSegmentLoad(t){const{levels:n}=this;if(!n)throw new Error("init load aborted, missing levels");const a=t.frag.stats;this.state=ot.IDLE,t.frag.data=new Uint8Array(t.payload),a.parsing.start=a.buffering.start=self.performance.now(),a.parsing.end=a.buffering.end=self.performance.now(),this.tick()}fragContextChanged(t){const{fragCurrent:n}=this;return!t||!n||t.sn!==n.sn||t.level!==n.level}fragBufferedComplete(t,n){var a,o,u,c;const p=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${t.type} sn: ${t.sn}${n?" part: "+n.index:""} of ${this.playlistType===Wt.MAIN?"level":"track"} ${t.level} (frag:[${((a=t.startPTS)!=null?a:NaN).toFixed(3)}-${((o=t.endPTS)!=null?o:NaN).toFixed(3)}] > buffer:${p?Fo.toString(_i.getBuffered(p)):"(detached)"})`),t.sn!=="initSegment"){var g;if(t.type!==Wt.SUBTITLE){const _=t.elementaryStreams;if(!Object.keys(_).some(w=>!!_[w])){this.state=ot.IDLE;return}}const A=(g=this.levels)==null?void 0:g[t.level];A!=null&&A.fragmentError&&(this.log(`Resetting level fragment error count of ${A.fragmentError} on frag buffered`),A.fragmentError=0)}this.state=ot.IDLE,!!p&&(!this.loadedmetadata&&t.type==Wt.MAIN&&p.buffered.length&&((u=this.fragCurrent)==null?void 0:u.sn)===((c=this.fragPrevious)==null?void 0:c.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(t){const{transmuxer:n}=this;if(!n)return;const{frag:a,part:o,partsLoaded:u}=t,c=!u||u.length===0||u.some(g=>!g),p=new za(a.level,a.sn,a.stats.chunkCount+1,0,o?o.index:-1,!c);n.flush(p)}_handleFragmentLoadProgress(t){}_doFragLoad(t,n,a=null,o){var u;const c=n==null?void 0:n.details;if(!this.levels||!c)throw new Error(`frag load aborted, missing level${c?"":" detail"}s`);let p=null;if(t.encrypted&&!((u=t.decryptdata)!=null&&u.key)?(this.log(`Loading key for ${t.sn} of [${c.startSN}-${c.endSN}], ${this.logPrefix==="[stream-controller]"?"level":"track"} ${t.level}`),this.state=ot.KEY_LOADING,this.fragCurrent=t,p=this.keyLoader.load(t).then(_=>{if(!this.fragContextChanged(_.frag))return this.hls.trigger(v.KEY_LOADED,_),this.state===ot.KEY_LOADING&&(this.state=ot.IDLE),_}),this.hls.trigger(v.KEY_LOADING,{frag:t}),this.fragCurrent===null&&(p=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!t.encrypted&&c.encryptedFragments.length&&this.keyLoader.loadClear(t,c.encryptedFragments),a=Math.max(t.start,a||0),this.config.lowLatencyMode&&t.sn!=="initSegment"){const _=c.partList;if(_&&o){a>t.end&&c.fragmentHint&&(t=c.fragmentHint);const w=this.getNextPart(_,t,a);if(w>-1){const M=_[w];this.log(`Loading part sn: ${t.sn} p: ${M.index} cc: ${t.cc} of playlist [${c.startSN}-${c.endSN}] parts [0-${w}-${_.length-1}] ${this.logPrefix==="[stream-controller]"?"level":"track"}: ${t.level}, target: ${parseFloat(a.toFixed(3))}`),this.nextLoadPosition=M.start+M.duration,this.state=ot.FRAG_LOADING;let z;return p?z=p.then(K=>!K||this.fragContextChanged(K.frag)?null:this.doFragPartsLoad(t,M,n,o)).catch(K=>this.handleFragLoadError(K)):z=this.doFragPartsLoad(t,M,n,o).catch(K=>this.handleFragLoadError(K)),this.hls.trigger(v.FRAG_LOADING,{frag:t,part:M,targetBufferTime:a}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):z}else if(!t.url||this.loadedEndOfParts(_,a))return Promise.resolve(null)}}this.log(`Loading fragment ${t.sn} cc: ${t.cc} ${c?"of ["+c.startSN+"-"+c.endSN+"] ":""}${this.logPrefix==="[stream-controller]"?"level":"track"}: ${t.level}, target: ${parseFloat(a.toFixed(3))}`),ie(t.sn)&&!this.bitrateTest&&(this.nextLoadPosition=t.start+t.duration),this.state=ot.FRAG_LOADING;const g=this.config.progressive;let A;return g&&p?A=p.then(_=>!_||this.fragContextChanged(_==null?void 0:_.frag)?null:this.fragmentLoader.load(t,o)).catch(_=>this.handleFragLoadError(_)):A=Promise.all([this.fragmentLoader.load(t,g?o:void 0),p]).then(([_])=>(!g&&_&&o&&o(_),_)).catch(_=>this.handleFragLoadError(_)),this.hls.trigger(v.FRAG_LOADING,{frag:t,targetBufferTime:a}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):A}doFragPartsLoad(t,n,a,o){return new Promise((u,c)=>{var p;const g=[],A=(p=a.details)==null?void 0:p.partList,_=w=>{this.fragmentLoader.loadPart(t,w,o).then(M=>{g[w.index]=M;const z=M.part;this.hls.trigger(v.FRAG_LOADED,M);const K=Va(a,t.sn,w.index+1)||Lo(A,t.sn,w.index+1);if(K)_(K);else return u({frag:t,part:z,partsLoaded:g})}).catch(c)};_(n)})}handleFragLoadError(t){if("data"in t){const n=t.data;t.data&&n.details===I.INTERNAL_ABORTED?this.handleFragLoadAborted(n.frag,n.part):this.hls.trigger(v.ERROR,n)}else this.hls.trigger(v.ERROR,{type:$.OTHER_ERROR,details:I.INTERNAL_EXCEPTION,err:t,error:t,fatal:!0});return null}_handleTransmuxerFlush(t){const n=this.getCurrentContext(t);if(!n||this.state!==ot.PARSING){!this.fragCurrent&&this.state!==ot.STOPPED&&this.state!==ot.ERROR&&(this.state=ot.IDLE);return}const{frag:a,part:o,level:u}=n,c=self.performance.now();a.stats.parsing.end=c,o&&(o.stats.parsing.end=c),this.updateLevelTiming(a,o,u,t.partial)}getCurrentContext(t){const{levels:n,fragCurrent:a}=this,{level:o,sn:u,part:c}=t;if(!(n!=null&&n[o]))return this.warn(`Levels object was unset while buffering fragment ${u} of level ${o}. The current chunk will not be buffered.`),null;const p=n[o],g=c>-1?Va(p,u,c):null,A=g?g.fragment:Yr(p,u,a);return A?(a&&a!==A&&(A.stats=a.stats),{frag:A,part:g,level:p}):null}bufferFragmentData(t,n,a,o,u){var c;if(!t||this.state!==ot.PARSING)return;const{data1:p,data2:g}=t;let A=p;if(p&&g&&(A=ft(p,g)),!((c=A)!=null&&c.length))return;const _={type:t.type,frag:n,part:a,chunkMeta:o,parent:n.type,data:A};if(this.hls.trigger(v.BUFFER_APPENDING,_),t.dropped&&t.independent&&!a){if(u)return;this.flushBufferGap(n)}}flushBufferGap(t){const n=this.media;if(!n)return;if(!_i.isBuffered(n,n.currentTime)){this.flushMainBuffer(0,t.start);return}const a=n.currentTime,o=_i.bufferInfo(n,a,0),u=t.duration,c=Math.min(this.config.maxFragLookUpTolerance*2,u*.25),p=Math.max(Math.min(t.start-c,o.end-c),a+c);t.start-p>c&&this.flushMainBuffer(p,t.start)}getFwdBufferInfo(t,n){const a=this.getLoadPosition();return ie(a)?this.getFwdBufferInfoAtPos(t,a,n):null}getFwdBufferInfoAtPos(t,n,a){const{config:{maxBufferHole:o}}=this,u=_i.bufferInfo(t,n,o);if(u.len===0&&u.nextStart!==void 0){const c=this.fragmentTracker.getBufferedFrag(n,a);if(c&&u.nextStart<c.end)return _i.bufferInfo(t,n,Math.max(u.nextStart,o))}return u}getMaxBufferLength(t){const{config:n}=this;let a;return t?a=Math.max(8*n.maxBufferSize/t,n.maxBufferLength):a=n.maxBufferLength,Math.min(a,n.maxMaxBufferLength)}reduceMaxBufferLength(t){const n=this.config,a=t||n.maxBufferLength;return n.maxMaxBufferLength>=a?(n.maxMaxBufferLength/=2,this.warn(`Reduce max buffer length to ${n.maxMaxBufferLength}s`),!0):!1}getAppendedFrag(t,n=Wt.MAIN){const a=this.fragmentTracker.getAppendedFrag(t,Wt.MAIN);return a&&"fragment"in a?a.fragment:a}getNextFragment(t,n){const a=n.fragments,o=a.length;if(!o)return null;const{config:u}=this,c=a[0].start;let p;if(n.live){const g=u.initialLiveManifestSize;if(o<g)return this.warn(`Not enough fragments to start playback (have: ${o}, need: ${g})`),null;(!n.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||t<c)&&(p=this.getInitialLiveFragment(n,a),this.startPosition=this.nextLoadPosition=p?this.hls.liveSyncPosition||p.start:t)}else t<=c&&(p=a[0]);if(!p){const g=u.lowLatencyMode?n.partEnd:n.fragmentEnd;p=this.getFragmentAtPosition(t,g,n)}return this.mapToInitFragWhenRequired(p)}isLoopLoading(t,n){const a=this.fragmentTracker.getState(t);return(a===Ui.OK||a===Ui.PARTIAL&&!!t.gap)&&this.nextLoadPosition>n}getNextFragmentLoopLoading(t,n,a,o,u){const c=t.gap,p=this.getNextFragment(this.nextLoadPosition,n);if(p===null)return p;if(t=p,c&&t&&!t.gap&&a.nextStart){const g=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,a.nextStart,o);if(g!==null&&a.len+g.len>=u)return this.log(`buffer full after gaps in "${o}" playlist starting at sn: ${t.sn}`),null}return t}mapToInitFragWhenRequired(t){return t!=null&&t.initSegment&&!(t!=null&&t.initSegment.data)&&!this.bitrateTest?t.initSegment:t}getNextPart(t,n,a){let o=-1,u=!1,c=!0;for(let p=0,g=t.length;p<g;p++){const A=t[p];if(c=c&&!A.independent,o>-1&&a<A.start)break;const _=A.loaded;_?o=-1:(u||A.independent||c)&&A.fragment===n&&(o=p),u=_}return o}loadedEndOfParts(t,n){const a=t[t.length-1];return a&&n>a.start&&a.loaded}getInitialLiveFragment(t,n){const a=this.fragPrevious;let o=null;if(a){if(t.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${a.programDateTime}`),o=Fl(n,a.endProgramDateTime,this.config.maxFragLookUpTolerance)),!o){const u=a.sn+1;if(u>=t.startSN&&u<=t.endSN){const c=n[u-t.startSN];a.cc===c.cc&&(o=c,this.log(`Live playlist, switching playlist, load frag with next SN: ${o.sn}`))}o||(o=Nl(n,a.cc),o&&this.log(`Live playlist, switching playlist, load frag with same CC: ${o.sn}`))}}else{const u=this.hls.liveSyncPosition;u!==null&&(o=this.getFragmentAtPosition(u,this.bitrateTest?t.fragmentEnd:t.edge,t))}return o}getFragmentAtPosition(t,n,a){const{config:o}=this;let{fragPrevious:u}=this,{fragments:c,endSN:p}=a;const{fragmentHint:g}=a,A=o.maxFragLookUpTolerance,_=a.partList,w=!!(o.lowLatencyMode&&_!=null&&_.length&&g);w&&g&&!this.bitrateTest&&(c=c.concat(g),p=g.sn);let M;if(t<n){const z=t>n-A?0:A;M=fa(u,c,t,z)}else M=c[c.length-1];if(M){const z=M.sn-a.startSN,K=this.fragmentTracker.getState(M);if((K===Ui.OK||K===Ui.PARTIAL&&M.gap)&&(u=M),u&&M.sn===u.sn&&(!w||_[0].fragment.sn>M.sn)&&u&&M.level===u.level){const ne=c[z+1];M.sn<p&&this.fragmentTracker.getState(ne)!==Ui.OK?M=ne:M=null}}return M}synchronizeToLiveEdge(t){const{config:n,media:a}=this;if(!a)return;const o=this.hls.liveSyncPosition,u=a.currentTime,c=t.fragments[0].start,p=t.edge,g=u>=c-n.maxFragLookUpTolerance&&u<=p;if(o!==null&&a.duration>o&&(u<o||!g)){const A=n.liveMaxLatencyDuration!==void 0?n.liveMaxLatencyDuration:n.liveMaxLatencyDurationCount*t.targetduration;(!g&&a.readyState<4||u<p-A)&&(this.loadedmetadata||(this.nextLoadPosition=o),a.readyState&&(this.warn(`Playback: ${u.toFixed(3)} is located too far from the end of live sliding playlist: ${p}, reset currentTime to : ${o.toFixed(3)}`),a.currentTime=o))}}alignPlaylists(t,n,a){const o=t.fragments.length;if(!o)return this.warn("No fragments in live playlist"),0;const u=t.fragments[0].start,c=!n,p=t.alignedSliding&&ie(u);if(c||!p&&!u){const{fragPrevious:g}=this;bs(g,a,t);const A=t.fragments[0].start;return this.log(`Live playlist sliding: ${A.toFixed(2)} start-sn: ${n?n.startSN:"na"}->${t.startSN} prev-sn: ${g?g.sn:"na"} fragments: ${o}`),A}return u}waitForCdnTuneIn(t){const n=3;return t.live&&t.canBlockReload&&t.partTarget&&t.tuneInGoal>Math.max(t.partHoldBack,t.partTarget*n)}setStartPosition(t,n){let a=this.startPosition;if(a<n&&(a=-1),a===-1||this.lastCurrentTime===-1){const o=this.startTimeOffset!==null,u=o?this.startTimeOffset:t.startTimeOffset;u!==null&&ie(u)?(a=n+u,u<0&&(a+=t.totalduration),a=Math.min(Math.max(n,a),n+t.totalduration),this.log(`Start time offset ${u} found in ${o?"multivariant":"media"} playlist, adjust startPosition to ${a}`),this.startPosition=a):t.live?a=this.hls.liveSyncPosition||n:this.startPosition=a=0,this.lastCurrentTime=a}this.nextLoadPosition=a}getLoadPosition(){const{media:t}=this;let n=0;return this.loadedmetadata&&t?n=t.currentTime:this.nextLoadPosition&&(n=this.nextLoadPosition),n}handleFragLoadAborted(t,n){this.transmuxer&&t.sn!=="initSegment"&&t.stats.aborted&&(this.warn(`Fragment ${t.sn}${n?" part "+n.index:""} of level ${t.level} was aborted`),this.resetFragmentLoading(t))}resetFragmentLoading(t){(!this.fragCurrent||!this.fragContextChanged(t)&&this.state!==ot.FRAG_LOADING_WAITING_RETRY)&&(this.state=ot.IDLE)}onFragmentOrKeyLoadError(t,n){if(n.chunkMeta&&!n.frag){const _=this.getCurrentContext(n.chunkMeta);_&&(n.frag=_.frag)}const a=n.frag;if(!a||a.type!==t||!this.levels)return;if(this.fragContextChanged(a)){var o;this.warn(`Frag load error must match current frag to retry ${a.url} > ${(o=this.fragCurrent)==null?void 0:o.url}`);return}const u=n.details===I.FRAG_GAP;u&&this.fragmentTracker.fragBuffered(a,!0);const c=n.errorAction,{action:p,retryCount:g=0,retryConfig:A}=c||{};if(c&&p===pi.RetryRequest&&A){this.resetStartWhenNotLoaded(this.levelLastLoaded);const _=Xr(A,g);this.warn(`Fragment ${a.sn} of ${t} ${a.level} errored with ${n.details}, retrying loading ${g+1}/${A.maxNumRetry} in ${_}ms`),c.resolved=!0,this.retryDate=self.performance.now()+_,this.state=ot.FRAG_LOADING_WAITING_RETRY}else if(A&&c)if(this.resetFragmentErrors(t),g<A.maxNumRetry)!u&&p!==pi.RemoveAlternatePermanently&&(c.resolved=!0);else{S.warn(`${n.details} reached or exceeded max retry (${g})`);return}else(c==null?void 0:c.action)===pi.SendAlternateToPenaltyBox?this.state=ot.WAITING_LEVEL:this.state=ot.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(t){if(this.state===ot.PARSING||this.state===ot.PARSED){const n=t.parent,a=this.getFwdBufferInfo(this.mediaBuffer,n),o=a&&a.len>.5;o&&this.reduceMaxBufferLength(a.len);const u=!o;return u&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${n} buffer`),t.frag&&(this.fragmentTracker.removeFragment(t.frag),this.nextLoadPosition=t.frag.start),this.resetLoadingState(),u}return!1}resetFragmentErrors(t){t===Wt.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==ot.STOPPED&&(this.state=ot.IDLE)}afterBufferFlushed(t,n,a){if(!t)return;const o=_i.getBuffered(t);this.fragmentTracker.detectEvictedFragments(n,o,a),this.state===ot.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=ot.IDLE}resetStartWhenNotLoaded(t){if(!this.loadedmetadata){this.startFragRequested=!1;const n=t?t.details:null;n!=null&&n.live?(this.startPosition=-1,this.setStartPosition(n,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(t){this.warn(`The loading context changed while buffering fragment ${t.sn} of level ${t.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(t=0){this.fragmentTracker.removeFragmentsInRange(t,Infinity,this.playlistType,!1,!0)}updateLevelTiming(t,n,a,o){var u;const c=a.details;if(!c){this.warn("level.details undefined");return}if(!Object.keys(t.elementaryStreams).reduce((g,A)=>{const _=t.elementaryStreams[A];if(_){const w=_.endPTS-_.startPTS;if(w<=0)return this.warn(`Could not parse fragment ${t.sn} ${A} duration reliably (${w})`),g||!1;const M=o?0:gs(c,t,_.startPTS,_.endPTS,_.startDTS,_.endDTS);return this.hls.trigger(v.LEVEL_PTS_UPDATED,{details:c,level:a,drift:M,type:A,frag:t,start:_.startPTS,end:_.endPTS}),!0}return g},!1)&&((u=this.transmuxer)==null?void 0:u.error)===null){const g=new Error(`Found no media in fragment ${t.sn} of level ${t.level} resetting transmuxer to fallback to playlist timing`);if(a.fragmentError===0&&(a.fragmentError++,t.gap=!0,this.fragmentTracker.removeFragment(t),this.fragmentTracker.fragBuffered(t,!0)),this.warn(g.message),this.hls.trigger(v.ERROR,{type:$.MEDIA_ERROR,details:I.FRAG_PARSING_ERROR,fatal:!1,error:g,frag:t,reason:`Found no media in msn ${t.sn} of level "${a.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=ot.PARSED,this.hls.trigger(v.FRAG_PARSED,{frag:t,part:n})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(t){t.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(t){const n=this._state;n!==t&&(this._state=t,this.log(`${n}->${t}`))}get state(){return this._state}}class Vn{constructor(){this.chunks=[],this.dataLength=0}push(t){this.chunks.push(t),this.dataLength+=t.length}flush(){const{chunks:t,dataLength:n}=this;let a;if(t.length)t.length===1?a=t[0]:a=No(t,n);else return new Uint8Array(0);return this.reset(),a}reset(){this.chunks.length=0,this.dataLength=0}}function No(h,t){const n=new Uint8Array(t);let a=0;for(let o=0;o<h.length;o++){const u=h[o];n.set(u,a),a+=u.length}return n}function Uo(){return typeof __HLS_WORKER_BUNDLE__=="function"}function ri(){const h=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(h);return{worker:new self.Worker(t),objectURL:t}}function jr(h){const t=new self.URL(h,self.location.href).href;return{worker:new self.Worker(t),scriptURL:t}}function Mn(h="",t=9e4){return{type:h,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}class Gn{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(t,n,a,o){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(t){this.initPTS=t,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(t,n){return!1}appendFrame(t,n,a){}demux(t,n){this.cachedData&&(t=ft(this.cachedData,t),this.cachedData=null);let a=Gi(t,0),o=a?a.length:0,u;const c=this._audioTrack,p=this._id3Track,g=a?gt(a):void 0,A=t.length;for((this.basePTS===null||this.frameIndex===0&&ie(g))&&(this.basePTS=$r(g,n,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),a&&a.length>0&&p.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:a,type:$n.audioId3,duration:Number.POSITIVE_INFINITY});o<A;){if(this.canParse(t,o)){const _=this.appendFrame(c,t,o);_?(this.frameIndex++,this.lastPTS=_.sample.pts,o+=_.length,u=o):o=A}else ln(t,o)?(a=Gi(t,o),p.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:a,type:$n.audioId3,duration:Number.POSITIVE_INFINITY}),o+=a.length,u=o):o++;if(o===A&&u!==A){const _=ai(t,u);this.cachedData?this.cachedData=ft(this.cachedData,_):this.cachedData=_}}return{audioTrack:c,videoTrack:Mn(),id3Track:p,textTrack:Mn()}}demuxSampleAes(t,n,a){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(t){const n=this.cachedData;return n&&(this.cachedData=null,this.demux(n,0)),{audioTrack:this._audioTrack,videoTrack:Mn(),id3Track:this._id3Track,textTrack:Mn()}}destroy(){}}const $r=(h,t,n)=>{if(ie(h))return h*90;const a=n?n.baseTime*9e4/n.timescale:0;return t*9e4+a};function va(h,t,n,a){let o,u,c,p;const g=navigator.userAgent.toLowerCase(),A=a,_=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];o=((t[n+2]&192)>>>6)+1;const w=(t[n+2]&60)>>>2;if(w>_.length-1){const M=new Error(`invalid ADTS sampling index:${w}`);h.emit(v.ERROR,v.ERROR,{type:$.MEDIA_ERROR,details:I.FRAG_PARSING_ERROR,fatal:!0,error:M,reason:M.message});return}return c=(t[n+2]&1)<<2,c|=(t[n+3]&192)>>>6,S.log(`manifest codec:${a}, ADTS type:${o}, samplingIndex:${w}`),/firefox/i.test(g)?w>=6?(o=5,p=new Array(4),u=w-3):(o=2,p=new Array(2),u=w):g.indexOf("android")!==-1?(o=2,p=new Array(2),u=w):(o=5,p=new Array(4),a&&(a.indexOf("mp4a.40.29")!==-1||a.indexOf("mp4a.40.5")!==-1)||!a&&w>=6?u=w-3:((a&&a.indexOf("mp4a.40.2")!==-1&&(w>=6&&c===1||/vivaldi/i.test(g))||!a&&c===1)&&(o=2,p=new Array(2)),u=w)),p[0]=o<<3,p[0]|=(w&14)>>1,p[1]|=(w&1)<<7,p[1]|=c<<3,o===5&&(p[1]|=(u&14)>>1,p[2]=(u&1)<<7,p[2]|=2<<2,p[3]=0),{config:p,samplerate:_[w],channelCount:c,codec:"mp4a.40."+o,manifestCodec:A}}function Aa(h,t){return h[t]===255&&(h[t+1]&246)==240}function ba(h,t){return h[t+1]&1?7:9}function Hn(h,t){return(h[t+3]&3)<<11|h[t+4]<<3|(h[t+5]&224)>>>5}function es(h,t){return t+5<h.length}function Ar(h,t){return t+1<h.length&&Aa(h,t)}function _a(h,t){return es(h,t)&&Aa(h,t)&&Hn(h,t)<=h.length-t}function jo(h,t){if(Ar(h,t)){const n=ba(h,t);if(t+n>=h.length)return!1;const a=Hn(h,t);if(a<=n)return!1;const o=t+a;return o===h.length||Ar(h,o)}return!1}function T(h,t,n,a,o){if(!h.samplerate){const u=va(t,n,a,o);if(!u)return;h.config=u.config,h.samplerate=u.samplerate,h.channelCount=u.channelCount,h.codec=u.codec,h.manifestCodec=u.manifestCodec,S.log(`parsed codec:${h.codec}, rate:${u.samplerate}, channels:${u.channelCount}`)}}function k(h){return 1024*9e4/h}function q(h,t){const n=ba(h,t);if(t+n<=h.length){const a=Hn(h,t)-n;if(a>0)return{headerLength:n,frameLength:a}}}function x(h,t,n,a,o){const u=k(h.samplerate),c=a+o*u,p=q(t,n);let g;if(p){const{frameLength:w,headerLength:M}=p,z=M+w,K=Math.max(0,n+z-t.length);K?(g=new Uint8Array(z-M),g.set(t.subarray(n+M,t.length),0)):g=t.subarray(n+M,n+z);const Z={unit:g,pts:c};return K||h.samples.push(Z),{sample:Z,length:z,missing:K}}const A=t.length-n;return g=new Uint8Array(A),g.set(t.subarray(n,t.length),0),{sample:{unit:g,pts:c},length:A,missing:-1}}let P=null;const F=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],Q=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],pe=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],ge=[0,1,1,4];function Ve(h,t,n,a,o){if(n+24>t.length)return;const u=Ke(t,n);if(u&&n+u.frameLength<=t.length){const c=u.samplesPerFrame*9e4/u.sampleRate,p=a+o*c,g={unit:t.subarray(n,n+u.frameLength),pts:p,dts:p};return h.config=[],h.channelCount=u.channelCount,h.samplerate=u.sampleRate,h.samples.push(g),{sample:g,length:u.frameLength,missing:0}}}function Ke(h,t){const n=h[t+1]>>3&3,a=h[t+1]>>1&3,o=h[t+2]>>4&15,u=h[t+2]>>2&3;if(n!==1&&o!==0&&o!==15&&u!==3){const c=h[t+2]>>1&1,p=h[t+3]>>6,g=n===3?3-a:a===3?3:4,A=F[g*14+o-1]*1e3,w=Q[(n===3?0:n===2?1:2)*3+u],M=p===3?1:2,z=pe[n][a],K=ge[a],Z=z*8*K,ne=Math.floor(z*A/w+c)*K;if(P===null){const Be=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);P=Be?parseInt(Be[1]):0}return!!P&&P<=87&&a===2&&A>=224e3&&p===0&&(h[t+3]=h[t+3]|128),{sampleRate:w,channelCount:M,frameLength:ne,samplesPerFrame:Z}}}function vt(h,t){return h[t]===255&&(h[t+1]&224)==224&&(h[t+1]&6)!=0}function bt(h,t){return t+1<h.length&&vt(h,t)}function Ot(h,t){const n=4;return vt(h,t)&&n<=h.length-t}function Tt(h,t){if(t+1<h.length&&vt(h,t)){const n=4,a=Ke(h,t);let o=n;a!=null&&a.frameLength&&(o=a.frameLength);const u=t+o;return u===h.length||bt(h,u)}return!1}class At extends Gn{constructor(t,n){super();this.observer=void 0,this.config=void 0,this.observer=t,this.config=n}resetInitSegment(t,n,a,o){super.resetInitSegment(t,n,a,o),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:n,duration:o,inputTimeScale:9e4,dropped:0}}static probe(t){if(!t)return!1;const n=Gi(t,0);let a=(n==null?void 0:n.length)||0;if(Tt(t,a))return!1;for(let o=t.length;a<o;a++)if(jo(t,a))return S.log("ADTS sync word found !"),!0;return!1}canParse(t,n){return _a(t,n)}appendFrame(t,n,a){T(t,this.observer,n,a,t.manifestCodec);const o=x(t,n,a,this.basePTS,this.frameIndex);if(o&&o.missing===0)return o}}const Ft=/\/emsg[-/]ID3/i;class Jt{constructor(t,n){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=n}resetTimeStamp(){}resetInitSegment(t,n,a,o){const u=this.videoTrack=Mn("video",1),c=this.audioTrack=Mn("audio",1),p=this.txtTrack=Mn("text",1);if(this.id3Track=Mn("id3",1),this.timeOffset=0,!(t!=null&&t.byteLength))return;const g=us(t);if(g.video){const{id:A,timescale:_,codec:w}=g.video;u.id=A,u.timescale=p.timescale=_,u.codec=w}if(g.audio){const{id:A,timescale:_,codec:w}=g.audio;c.id=A,c.timescale=_,c.codec=w}p.id=Ni.text,u.sampleDuration=0,u.duration=c.duration=o}resetContiguity(){this.remainderData=null}static probe(t){return Lr(t)}demux(t,n){this.timeOffset=n;let a=t;const o=this.videoTrack,u=this.txtTrack;if(this.config.progressive){this.remainderData&&(a=ft(this.remainderData,t));const p=qe(a);this.remainderData=p.remainder,o.samples=p.valid||new Uint8Array}else o.samples=a;const c=this.extractID3Track(o,n);return u.samples=jt(n,o),{videoTrack:o,audioTrack:this.audioTrack,id3Track:c,textTrack:this.txtTrack}}flush(){const t=this.timeOffset,n=this.videoTrack,a=this.txtTrack;n.samples=this.remainderData||new Uint8Array,this.remainderData=null;const o=this.extractID3Track(n,this.timeOffset);return a.samples=jt(t,n),{videoTrack:n,audioTrack:Mn(),id3Track:o,textTrack:Mn()}}extractID3Track(t,n){const a=this.id3Track;if(t.samples.length){const o=Mt(t.samples,["emsg"]);o&&o.forEach(u=>{const c=In(u);if(Ft.test(c.schemeIdUri)){const p=ie(c.presentationTime)?c.presentationTime/c.timeScale:n+c.presentationTimeDelta/c.timeScale;let g=c.eventDuration===4294967295?Number.POSITIVE_INFINITY:c.eventDuration/c.timeScale;g<=.001&&(g=Number.POSITIVE_INFINITY);const A=c.payload;a.samples.push({data:A,len:A.byteLength,dts:p,pts:p,type:$n.emsg,duration:g})}})}return a}demuxSampleAes(t,n,a){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}}const Ki=(h,t)=>{let n=0,a=5;t+=a;const o=new Uint32Array(1),u=new Uint32Array(1),c=new Uint8Array(1);for(;a>0;){c[0]=h[t];const p=Math.min(a,8),g=8-p;u[0]=4278190080>>>24+g<<g,o[0]=(c[0]&u[0])>>g,n=n?n<<p|o[0]:o[0],t+=1,a-=p}return n};class ji extends Gn{constructor(t){super();this.observer=void 0,this.observer=t}resetInitSegment(t,n,a,o){super.resetInitSegment(t,n,a,o),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:n,duration:o,inputTimeScale:9e4,dropped:0}}canParse(t,n){return n+64<t.length}appendFrame(t,n,a){const o=gi(t,n,a,this.basePTS,this.frameIndex);if(o!==-1)return{sample:t.samples[t.samples.length-1],length:o,missing:0}}static probe(t){if(!t)return!1;const n=Gi(t,0);if(!n)return!1;const a=n.length;return t[a]===11&&t[a+1]===119&&gt(n)!==void 0&&Ki(t,a)<16}}function gi(h,t,n,a,o){if(n+8>t.length||t[n]!==11||t[n+1]!==119)return-1;const u=t[n+4]>>6;if(u>=3)return-1;const p=[48e3,44100,32e3][u],g=t[n+4]&63,_=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][g*3+u]*2;if(n+_>t.length)return-1;const w=t[n+6]>>5;let M=0;w===2?M+=2:(w&1&&w!==1&&(M+=2),w&4&&(M+=2));const z=(t[n+6]<<8|t[n+7])>>12-M&1,Z=[2,1,2,3,3,4,4,5][w]+z,ne=t[n+5]>>3,xe=t[n+5]&7,de=new Uint8Array([u<<6|ne<<1|xe>>2,(xe&3)<<6|w<<3|z<<2|g>>4,g<<4&224]),Be=1536/p*9e4,Qe=a+o*Be,Ne=t.subarray(n,n+_);return h.config=de,h.channelCount=Z,h.samplerate=p,h.samples.push({unit:Ne,pts:Qe}),_}class br{constructor(){this.VideoSample=null}createVideoSample(t,n,a,o){return{key:t,frame:!1,pts:n,dts:a,units:[],debug:o,length:0}}getLastNalUnit(t){var n;let a=this.VideoSample,o;if((!a||a.units.length===0)&&(a=t[t.length-1]),(n=a)!=null&&n.units){const u=a.units;o=u[u.length-1]}return o}pushAccessUnit(t,n){if(t.units.length&&t.frame){if(t.pts===void 0){const a=n.samples,o=a.length;if(o){const u=a[o-1];t.pts=u.pts,t.dts=u.dts}else{n.dropped++;return}}n.samples.push(t)}t.debug.length&&S.log(t.pts+"/"+t.dts+":"+t.debug)}}class Wi{constructor(t){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const t=this.data,n=this.bytesAvailable,a=t.byteLength-n,o=new Uint8Array(4),u=Math.min(4,n);if(u===0)throw new Error("no bytes available");o.set(t.subarray(a,a+u)),this.word=new DataView(o.buffer).getUint32(0),this.bitsAvailable=u*8,this.bytesAvailable-=u}skipBits(t){let n;t=Math.min(t,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>t?(this.word<<=t,this.bitsAvailable-=t):(t-=this.bitsAvailable,n=t>>3,t-=n<<3,this.bytesAvailable-=n,this.loadWord(),this.word<<=t,this.bitsAvailable-=t)}readBits(t){let n=Math.min(this.bitsAvailable,t);const a=this.word>>>32-n;if(t>32&&S.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=n,this.bitsAvailable>0)this.word<<=n;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return n=t-n,n>0&&this.bitsAvailable?a<<n|this.readBits(n):a}skipLZ(){let t;for(t=0;t<this.bitsAvailable;++t)if((this.word&2147483648>>>t)!=0)return this.word<<=t,this.bitsAvailable-=t,t;return this.loadWord(),t+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const t=this.skipLZ();return this.readBits(t+1)-1}readEG(){const t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(t){let n=8,a=8,o;for(let u=0;u<t;u++)a!==0&&(o=this.readEG(),a=(n+o+256)%256),n=a===0?n:a}readSPS(){let t=0,n=0,a=0,o=0,u,c,p;const g=this.readUByte.bind(this),A=this.readBits.bind(this),_=this.readUEG.bind(this),w=this.readBoolean.bind(this),M=this.skipBits.bind(this),z=this.skipEG.bind(this),K=this.skipUEG.bind(this),Z=this.skipScalingList.bind(this);g();const ne=g();if(A(5),M(3),g(),K(),ne===100||ne===110||ne===122||ne===244||ne===44||ne===83||ne===86||ne===118||ne===128){const lt=_();if(lt===3&&M(1),K(),K(),M(1),w())for(c=lt!==3?8:12,p=0;p<c;p++)w()&&(p<6?Z(16):Z(64))}K();const xe=_();if(xe===0)_();else if(xe===1)for(M(1),z(),z(),u=_(),p=0;p<u;p++)z();K(),M(1);const de=_(),Be=_(),Qe=A(1);Qe===0&&M(1),M(1),w()&&(t=_(),n=_(),a=_(),o=_());let Ne=[1,1];if(w()&&w())switch(g()){case 1:Ne=[1,1];break;case 2:Ne=[12,11];break;case 3:Ne=[10,11];break;case 4:Ne=[16,11];break;case 5:Ne=[40,33];break;case 6:Ne=[24,11];break;case 7:Ne=[20,11];break;case 8:Ne=[32,11];break;case 9:Ne=[80,33];break;case 10:Ne=[18,11];break;case 11:Ne=[15,11];break;case 12:Ne=[64,33];break;case 13:Ne=[160,99];break;case 14:Ne=[4,3];break;case 15:Ne=[3,2];break;case 16:Ne=[2,1];break;case 255:{Ne=[g()<<8|g(),g()<<8|g()];break}}return{width:Math.ceil((de+1)*16-t*2-n*2),height:(2-Qe)*(Be+1)*16-(Qe?2:4)*(a+o),pixelRatio:Ne}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class qs extends br{parseAVCPES(t,n,a,o,u){const c=this.parseAVCNALu(t,a.data);let p=this.VideoSample,g,A=!1;a.data=null,p&&c.length&&!t.audFound&&(this.pushAccessUnit(p,t),p=this.VideoSample=this.createVideoSample(!1,a.pts,a.dts,"")),c.forEach(_=>{var w;switch(_.type){case 1:{let Z=!1;g=!0;const ne=_.data;if(A&&ne.length>4){const xe=new Wi(ne).readSliceType();(xe===2||xe===4||xe===7||xe===9)&&(Z=!0)}if(Z){var M;(M=p)!=null&&M.frame&&!p.key&&(this.pushAccessUnit(p,t),p=this.VideoSample=null)}p||(p=this.VideoSample=this.createVideoSample(!0,a.pts,a.dts,"")),p.frame=!0,p.key=Z;break}case 5:g=!0,(w=p)!=null&&w.frame&&!p.key&&(this.pushAccessUnit(p,t),p=this.VideoSample=null),p||(p=this.VideoSample=this.createVideoSample(!0,a.pts,a.dts,"")),p.key=!0,p.frame=!0;break;case 6:{g=!0,un(_.data,1,a.pts,n.samples);break}case 7:{var z,K;g=!0,A=!0;const Z=_.data,xe=new Wi(Z).readSPS();if(!t.sps||t.width!==xe.width||t.height!==xe.height||((z=t.pixelRatio)==null?void 0:z[0])!==xe.pixelRatio[0]||((K=t.pixelRatio)==null?void 0:K[1])!==xe.pixelRatio[1]){t.width=xe.width,t.height=xe.height,t.pixelRatio=xe.pixelRatio,t.sps=[Z],t.duration=u;const de=Z.subarray(1,4);let Be="avc1.";for(let Qe=0;Qe<3;Qe++){let Ne=de[Qe].toString(16);Ne.length<2&&(Ne="0"+Ne),Be+=Ne}t.codec=Be}break}case 8:g=!0,t.pps=[_.data];break;case 9:g=!0,t.audFound=!0,p&&this.pushAccessUnit(p,t),p=this.VideoSample=this.createVideoSample(!1,a.pts,a.dts,"");break;case 12:g=!0;break;default:g=!1,p&&(p.debug+="unknown NAL "+_.type+" ");break}p&&g&&p.units.push(_)}),o&&p&&(this.pushAccessUnit(p,t),this.VideoSample=null)}parseAVCNALu(t,n){const a=n.byteLength;let o=t.naluState||0;const u=o,c=[];let p=0,g,A,_,w=-1,M=0;for(o===-1&&(w=0,M=n[0]&31,o=0,p=1);p<a;){if(g=n[p++],!o){o=g?0:1;continue}if(o===1){o=g?0:2;continue}if(!g)o=3;else if(g===1){if(A=p-o-1,w>=0){const z={data:n.subarray(w,A),type:M};c.push(z)}else{const z=this.getLastNalUnit(t.samples);z&&(u&&p<=4-u&&z.state&&(z.data=z.data.subarray(0,z.data.byteLength-u)),A>0&&(z.data=ft(z.data,n.subarray(0,A)),z.state=0))}p<a?(_=n[p]&31,w=p,M=_,o=0):o=-1}else o=0}if(w>=0&&o>=0){const z={data:n.subarray(w,a),type:M,state:o};c.push(z)}if(c.length===0){const z=this.getLastNalUnit(t.samples);z&&(z.data=ft(z.data,n))}return t.naluState=o,c}}class Ks{constructor(t,n,a){this.keyData=void 0,this.decrypter=void 0,this.keyData=a,this.decrypter=new Zr(n,{removePKCS7Padding:!1})}decryptBuffer(t){return this.decrypter.decrypt(t,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(t,n,a){const o=t[n].unit;if(o.length<=16)return;const u=o.subarray(16,o.length-o.length%16),c=u.buffer.slice(u.byteOffset,u.byteOffset+u.length);this.decryptBuffer(c).then(p=>{const g=new Uint8Array(p);o.set(g,16),this.decrypter.isSync()||this.decryptAacSamples(t,n+1,a)})}decryptAacSamples(t,n,a){for(;;n++){if(n>=t.length){a();return}if(!(t[n].unit.length<32)&&(this.decryptAacSample(t,n,a),!this.decrypter.isSync()))return}}getAvcEncryptedData(t){const n=Math.floor((t.length-48)/160)*16+16,a=new Int8Array(n);let o=0;for(let u=32;u<t.length-16;u+=160,o+=16)a.set(t.subarray(u,u+16),o);return a}getAvcDecryptedUnit(t,n){const a=new Uint8Array(n);let o=0;for(let u=32;u<t.length-16;u+=160,o+=16)t.set(a.subarray(o,o+16),u);return t}decryptAvcSample(t,n,a,o,u){const c=gn(u.data),p=this.getAvcEncryptedData(c);this.decryptBuffer(p.buffer).then(g=>{u.data=this.getAvcDecryptedUnit(c,g),this.decrypter.isSync()||this.decryptAvcSamples(t,n,a+1,o)})}decryptAvcSamples(t,n,a,o){if(t instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;n++,a=0){if(n>=t.length){o();return}const u=t[n].units;for(;!(a>=u.length);a++){const c=u[a];if(!(c.data.length<=48||c.type!==1&&c.type!==5)&&(this.decryptAvcSample(t,n,a,o,c),!this.decrypter.isSync()))return}}}}const xi=188;class ts{constructor(t,n,a){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=t,this.config=n,this.typeSupported=a,this.videoParser=new qs}static probe(t){const n=ts.syncOffset(t);return n>0&&S.warn(`MPEG2-TS detected but first sync word found @ offset ${n}`),n!==-1}static syncOffset(t){const n=t.length;let a=Math.min(xi*5,n-xi)+1,o=0;for(;o<a;){let u=!1,c=-1,p=0;for(let g=o;g<n;g+=xi)if(t[g]===71&&(n-g===xi||t[g+xi]===71)){if(p++,c===-1&&(c=g,c!==0&&(a=Math.min(c+xi*99,t.length-xi)+1)),u||(u=Xa(t,g)===0),u&&p>1&&(c===0&&p>2||g+xi>a))return c}else{if(p)return-1;break}o++}return-1}static createTrack(t,n){return{container:t==="video"||t==="audio"?"video/mp2t":void 0,type:t,id:Ni[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:t==="audio"?n:void 0}}resetInitSegment(t,n,a,o){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=ts.createTrack("video"),this._audioTrack=ts.createTrack("audio",o),this._id3Track=ts.createTrack("id3"),this._txtTrack=ts.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=n,this.videoCodec=a,this._duration=o}resetTimeStamp(){}resetContiguity(){const{_audioTrack:t,_videoTrack:n,_id3Track:a}=this;t&&(t.pesData=null),n&&(n.pesData=null),a&&(a.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(t,n,a=!1,o=!1){a||(this.sampleAes=null);let u;const c=this._videoTrack,p=this._audioTrack,g=this._id3Track,A=this._txtTrack;let _=c.pid,w=c.pesData,M=p.pid,z=g.pid,K=p.pesData,Z=g.pesData,ne=null,xe=this.pmtParsed,de=this._pmtId,Be=t.length;if(this.remainderData&&(t=ft(this.remainderData,t),Be=t.length,this.remainderData=null),Be<xi&&!o)return this.remainderData=t,{audioTrack:p,videoTrack:c,id3Track:g,textTrack:A};const Qe=Math.max(0,ts.syncOffset(t));Be-=(Be-Qe)%xi,Be<t.byteLength&&!o&&(this.remainderData=new Uint8Array(t.buffer,Be,t.buffer.byteLength-Be));let Ne=0;for(let Xe=Qe;Xe<Be;Xe+=xi)if(t[Xe]===71){const ct=!!(t[Xe+1]&64),Lt=Xa(t,Xe),et=(t[Xe+3]&48)>>4;let st;if(et>1){if(st=Xe+5+t[Xe+4],st===Xe+xi)continue}else st=Xe+4;switch(Lt){case _:ct&&(w&&(u=xa(w))&&this.videoParser.parseAVCPES(c,A,u,!1,this._duration),w={data:[],size:0}),w&&(w.data.push(t.subarray(st,Xe+xi)),w.size+=Xe+xi-st);break;case M:if(ct){if(K&&(u=xa(K)))switch(p.segmentCodec){case"aac":this.parseAACPES(p,u);break;case"mp3":this.parseMPEGPES(p,u);break;case"ac3":this.parseAC3PES(p,u);break}K={data:[],size:0}}K&&(K.data.push(t.subarray(st,Xe+xi)),K.size+=Xe+xi-st);break;case z:ct&&(Z&&(u=xa(Z))&&this.parseID3PES(g,u),Z={data:[],size:0}),Z&&(Z.data.push(t.subarray(st,Xe+xi)),Z.size+=Xe+xi-st);break;case 0:ct&&(st+=t[st]+1),de=this._pmtId=$o(t,st);break;case de:{ct&&(st+=t[st]+1);const Ht=Vo(t,st,this.typeSupported,a);_=Ht.videoPid,_>0&&(c.pid=_,c.segmentCodec=Ht.segmentVideoCodec),M=Ht.audioPid,M>0&&(p.pid=M,p.segmentCodec=Ht.segmentAudioCodec),z=Ht.id3Pid,z>0&&(g.pid=z),ne!==null&&!xe&&(S.warn(`MPEG-TS PMT found at ${Xe} after unknown PID '${ne}'. Backtracking to sync byte @${Qe} to parse all TS packets.`),ne=null,Xe=Qe-188),xe=this.pmtParsed=!0;break}case 17:case 8191:break;default:ne=Lt;break}}else Ne++;if(Ne>0){const Xe=new Error(`Found ${Ne} TS packet/s that do not start with 0x47`);this.observer.emit(v.ERROR,v.ERROR,{type:$.MEDIA_ERROR,details:I.FRAG_PARSING_ERROR,fatal:!1,error:Xe,reason:Xe.message})}c.pesData=w,p.pesData=K,g.pesData=Z;const lt={audioTrack:p,videoTrack:c,id3Track:g,textTrack:A};return o&&this.extractRemainingSamples(lt),lt}flush(){const{remainderData:t}=this;this.remainderData=null;let n;return t?n=this.demux(t,-1,!1,!0):n={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(n),this.sampleAes?this.decrypt(n,this.sampleAes):n}extractRemainingSamples(t){const{audioTrack:n,videoTrack:a,id3Track:o,textTrack:u}=t,c=a.pesData,p=n.pesData,g=o.pesData;let A;if(c&&(A=xa(c))?(this.videoParser.parseAVCPES(a,u,A,!0,this._duration),a.pesData=null):a.pesData=c,p&&(A=xa(p))){switch(n.segmentCodec){case"aac":this.parseAACPES(n,A);break;case"mp3":this.parseMPEGPES(n,A);break;case"ac3":this.parseAC3PES(n,A);break}n.pesData=null}else p!=null&&p.size&&S.log("last AAC PES packet truncated,might overlap between fragments"),n.pesData=p;g&&(A=xa(g))?(this.parseID3PES(o,A),o.pesData=null):o.pesData=g}demuxSampleAes(t,n,a){const o=this.demux(t,a,!0,!this.config.progressive),u=this.sampleAes=new Ks(this.observer,this.config,n);return this.decrypt(o,u)}decrypt(t,n){return new Promise(a=>{const{audioTrack:o,videoTrack:u}=t;o.samples&&o.segmentCodec==="aac"?n.decryptAacSamples(o.samples,0,()=>{u.samples?n.decryptAvcSamples(u.samples,0,0,()=>{a(t)}):a(t)}):u.samples&&n.decryptAvcSamples(u.samples,0,0,()=>{a(t)})})}destroy(){this._duration=0}parseAACPES(t,n){let a=0;const o=this.aacOverFlow;let u=n.data;if(o){this.aacOverFlow=null;const w=o.missing,M=o.sample.unit.byteLength;if(w===-1)u=ft(o.sample.unit,u);else{const z=M-w;o.sample.unit.set(u.subarray(0,w),z),t.samples.push(o.sample),a=o.missing}}let c,p;for(c=a,p=u.length;c<p-1&&!Ar(u,c);c++);if(c!==a){let w;const M=c<p-1;M?w=`AAC PES did not start with ADTS header,offset:${c}`:w="No ADTS header found in AAC PES";const z=new Error(w);if(S.warn(`parsing error: ${w}`),this.observer.emit(v.ERROR,v.ERROR,{type:$.MEDIA_ERROR,details:I.FRAG_PARSING_ERROR,fatal:!1,levelRetry:M,error:z,reason:w}),!M)return}T(t,this.observer,u,c,this.audioCodec);let g;if(n.pts!==void 0)g=n.pts;else if(o){const w=k(t.samplerate);g=o.sample.pts+w}else{S.warn("[tsdemuxer]: AAC PES unknown PTS");return}let A=0,_;for(;c<p;)if(_=x(t,u,c,g,A),c+=_.length,_.missing){this.aacOverFlow=_;break}else for(A++;c<p-1&&!Ar(u,c);c++);}parseMPEGPES(t,n){const a=n.data,o=a.length;let u=0,c=0;const p=n.pts;if(p===void 0){S.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;c<o;)if(bt(a,c)){const g=Ve(t,a,c,p,u);if(g)c+=g.length,u++;else break}else c++}parseAC3PES(t,n){{const a=n.data,o=n.pts;if(o===void 0){S.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const u=a.length;let c=0,p=0,g;for(;p<u&&(g=gi(t,a,p,o,c++))>0;)p+=g}}parseID3PES(t,n){if(n.pts===void 0){S.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const a=re({},n,{type:this._videoTrack?$n.emsg:$n.audioId3,duration:Number.POSITIVE_INFINITY});t.samples.push(a)}}function Xa(h,t){return((h[t+1]&31)<<8)+h[t+2]}function $o(h,t){return(h[t+10]&31)<<8|h[t+11]}function Vo(h,t,n,a){const o={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},u=(h[t+1]&15)<<8|h[t+2],c=t+3+u-4,p=(h[t+10]&15)<<8|h[t+11];for(t+=12+p;t<c;){const g=Xa(h,t),A=(h[t+3]&15)<<8|h[t+4];switch(h[t]){case 207:if(!a){$l("ADTS AAC");break}case 15:o.audioPid===-1&&(o.audioPid=g);break;case 21:o.id3Pid===-1&&(o.id3Pid=g);break;case 219:if(!a){$l("H.264");break}case 27:o.videoPid===-1&&(o.videoPid=g,o.segmentVideoCodec="avc");break;case 3:case 4:!n.mpeg&&!n.mp3?S.log("MPEG audio found, not supported in this browser"):o.audioPid===-1&&(o.audioPid=g,o.segmentAudioCodec="mp3");break;case 193:if(!a){$l("AC-3");break}case 129:n.ac3?o.audioPid===-1&&(o.audioPid=g,o.segmentAudioCodec="ac3"):S.log("AC-3 audio found, not supported in this browser");break;case 6:if(o.audioPid===-1&&A>0){let _=t+5,w=A;for(;w>2;){switch(h[_]){case 106:n.ac3!==!0?S.log("AC-3 audio found, not supported in this browser for now"):(o.audioPid=g,o.segmentAudioCodec="ac3");break}const z=h[_+1]+2;_+=z,w-=z}}break;case 194:case 135:S.warn("Unsupported EC-3 in M2TS found");break;case 36:S.warn("Unsupported HEVC in M2TS found");break}t+=A+5}return o}function $l(h){S.log(`${h} with AES-128-CBC encryption found in unencrypted stream`)}function xa(h){let t=0,n,a,o,u,c;const p=h.data;if(!h||h.size===0)return null;for(;p[0].length<19&&p.length>1;)p[0]=ft(p[0],p[1]),p.splice(1,1);if(n=p[0],(n[0]<<16)+(n[1]<<8)+n[2]===1){if(a=(n[4]<<8)+n[5],a&&a>h.size-6)return null;const A=n[7];A&192&&(u=(n[9]&14)*536870912+(n[10]&255)*4194304+(n[11]&254)*16384+(n[12]&255)*128+(n[13]&254)/2,A&64?(c=(n[14]&14)*536870912+(n[15]&255)*4194304+(n[16]&254)*16384+(n[17]&255)*128+(n[18]&254)/2,u-c>60*9e4&&(S.warn(`${Math.round((u-c)/9e4)}s delta between PTS and DTS, align them`),u=c)):c=u),o=n[8];let _=o+9;if(h.size<=_)return null;h.size-=_;const w=new Uint8Array(h.size);for(let M=0,z=p.length;M<z;M++){n=p[M];let K=n.byteLength;if(_)if(_>K){_-=K;continue}else n=n.subarray(_),K-=_,_=0;w.set(n,t),t+=K}return a&&(a-=o+3),{data:w,pts:u,dts:c,len:a}}return null}class qn extends Gn{resetInitSegment(t,n,a,o){super.resetInitSegment(t,n,a,o),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:n,duration:o,inputTimeScale:9e4,dropped:0}}static probe(t){if(!t)return!1;const n=Gi(t,0);let a=(n==null?void 0:n.length)||0;if(n&&t[a]===11&&t[a+1]===119&&gt(n)!==void 0&&Ki(t,a)<=16)return!1;for(let o=t.length;a<o;a++)if(Tt(t,a))return S.log("MPEG Audio sync word found !"),!0;return!1}canParse(t,n){return Ot(t,n)}appendFrame(t,n,a){if(this.basePTS!==null)return Ve(t,n,a,this.basePTS,this.frameIndex)}}class _n{static getSilentFrame(t,n){switch(t){case"mp4a.40.2":if(n===1)return new Uint8Array([0,200,0,128,35,128]);if(n===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(n===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(n===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(n===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(n===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(n===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(n===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(n===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const Kn=Math.pow(2,32)-1;class Ge{static init(){Ge.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let t;for(t in Ge.types)Ge.types.hasOwnProperty(t)&&(Ge.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);const n=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),a=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);Ge.HDLR_TYPES={video:n,audio:a};const o=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),u=new Uint8Array([0,0,0,0,0,0,0,0]);Ge.STTS=Ge.STSC=Ge.STCO=u,Ge.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Ge.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Ge.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Ge.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const c=new Uint8Array([105,115,111,109]),p=new Uint8Array([97,118,99,49]),g=new Uint8Array([0,0,0,1]);Ge.FTYP=Ge.box(Ge.types.ftyp,c,g,c,p),Ge.DINF=Ge.box(Ge.types.dinf,Ge.box(Ge.types.dref,o))}static box(t,...n){let a=8,o=n.length;const u=o;for(;o--;)a+=n[o].byteLength;const c=new Uint8Array(a);for(c[0]=a>>24&255,c[1]=a>>16&255,c[2]=a>>8&255,c[3]=a&255,c.set(t,4),o=0,a=8;o<u;o++)c.set(n[o],a),a+=n[o].byteLength;return c}static hdlr(t){return Ge.box(Ge.types.hdlr,Ge.HDLR_TYPES[t])}static mdat(t){return Ge.box(Ge.types.mdat,t)}static mdhd(t,n){n*=t;const a=Math.floor(n/(Kn+1)),o=Math.floor(n%(Kn+1));return Ge.box(Ge.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,a>>24,a>>16&255,a>>8&255,a&255,o>>24,o>>16&255,o>>8&255,o&255,85,196,0,0]))}static mdia(t){return Ge.box(Ge.types.mdia,Ge.mdhd(t.timescale,t.duration),Ge.hdlr(t.type),Ge.minf(t))}static mfhd(t){return Ge.box(Ge.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255]))}static minf(t){return t.type==="audio"?Ge.box(Ge.types.minf,Ge.box(Ge.types.smhd,Ge.SMHD),Ge.DINF,Ge.stbl(t)):Ge.box(Ge.types.minf,Ge.box(Ge.types.vmhd,Ge.VMHD),Ge.DINF,Ge.stbl(t))}static moof(t,n,a){return Ge.box(Ge.types.moof,Ge.mfhd(t),Ge.traf(a,n))}static moov(t){let n=t.length;const a=[];for(;n--;)a[n]=Ge.trak(t[n]);return Ge.box.apply(null,[Ge.types.moov,Ge.mvhd(t[0].timescale,t[0].duration)].concat(a).concat(Ge.mvex(t)))}static mvex(t){let n=t.length;const a=[];for(;n--;)a[n]=Ge.trex(t[n]);return Ge.box.apply(null,[Ge.types.mvex,...a])}static mvhd(t,n){n*=t;const a=Math.floor(n/(Kn+1)),o=Math.floor(n%(Kn+1)),u=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,a>>24,a>>16&255,a>>8&255,a&255,o>>24,o>>16&255,o>>8&255,o&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Ge.box(Ge.types.mvhd,u)}static sdtp(t){const n=t.samples||[],a=new Uint8Array(4+n.length);let o,u;for(o=0;o<n.length;o++)u=n[o].flags,a[o+4]=u.dependsOn<<4|u.isDependedOn<<2|u.hasRedundancy;return Ge.box(Ge.types.sdtp,a)}static stbl(t){return Ge.box(Ge.types.stbl,Ge.stsd(t),Ge.box(Ge.types.stts,Ge.STTS),Ge.box(Ge.types.stsc,Ge.STSC),Ge.box(Ge.types.stsz,Ge.STSZ),Ge.box(Ge.types.stco,Ge.STCO))}static avc1(t){let n=[],a=[],o,u,c;for(o=0;o<t.sps.length;o++)u=t.sps[o],c=u.byteLength,n.push(c>>>8&255),n.push(c&255),n=n.concat(Array.prototype.slice.call(u));for(o=0;o<t.pps.length;o++)u=t.pps[o],c=u.byteLength,a.push(c>>>8&255),a.push(c&255),a=a.concat(Array.prototype.slice.call(u));const p=Ge.box(Ge.types.avcC,new Uint8Array([1,n[3],n[4],n[5],252|3,224|t.sps.length].concat(n).concat([t.pps.length]).concat(a))),g=t.width,A=t.height,_=t.pixelRatio[0],w=t.pixelRatio[1];return Ge.box(Ge.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,g>>8&255,g&255,A>>8&255,A&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),p,Ge.box(Ge.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Ge.box(Ge.types.pasp,new Uint8Array([_>>24,_>>16&255,_>>8&255,_&255,w>>24,w>>16&255,w>>8&255,w&255])))}static esds(t){const n=t.config.length;return new Uint8Array([0,0,0,0,3,23+n,0,1,0,4,15+n,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([n]).concat(t.config).concat([6,1,2]))}static audioStsd(t){const n=t.samplerate;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,n>>8&255,n&255,0,0])}static mp4a(t){return Ge.box(Ge.types.mp4a,Ge.audioStsd(t),Ge.box(Ge.types.esds,Ge.esds(t)))}static mp3(t){return Ge.box(Ge.types[".mp3"],Ge.audioStsd(t))}static ac3(t){return Ge.box(Ge.types["ac-3"],Ge.audioStsd(t),Ge.box(Ge.types.dac3,t.config))}static stsd(t){return t.type==="audio"?t.segmentCodec==="mp3"&&t.codec==="mp3"?Ge.box(Ge.types.stsd,Ge.STSD,Ge.mp3(t)):t.segmentCodec==="ac3"?Ge.box(Ge.types.stsd,Ge.STSD,Ge.ac3(t)):Ge.box(Ge.types.stsd,Ge.STSD,Ge.mp4a(t)):Ge.box(Ge.types.stsd,Ge.STSD,Ge.avc1(t))}static tkhd(t){const n=t.id,a=t.duration*t.timescale,o=t.width,u=t.height,c=Math.floor(a/(Kn+1)),p=Math.floor(a%(Kn+1));return Ge.box(Ge.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,n>>24&255,n>>16&255,n>>8&255,n&255,0,0,0,0,c>>24,c>>16&255,c>>8&255,c&255,p>>24,p>>16&255,p>>8&255,p&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,o>>8&255,o&255,0,0,u>>8&255,u&255,0,0]))}static traf(t,n){const a=Ge.sdtp(t),o=t.id,u=Math.floor(n/(Kn+1)),c=Math.floor(n%(Kn+1));return Ge.box(Ge.types.traf,Ge.box(Ge.types.tfhd,new Uint8Array([0,0,0,0,o>>24,o>>16&255,o>>8&255,o&255])),Ge.box(Ge.types.tfdt,new Uint8Array([1,0,0,0,u>>24,u>>16&255,u>>8&255,u&255,c>>24,c>>16&255,c>>8&255,c&255])),Ge.trun(t,a.length+16+20+8+16+8+8),a)}static trak(t){return t.duration=t.duration||4294967295,Ge.box(Ge.types.trak,Ge.tkhd(t),Ge.mdia(t))}static trex(t){const n=t.id;return Ge.box(Ge.types.trex,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,n&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(t,n){const a=t.samples||[],o=a.length,u=12+16*o,c=new Uint8Array(u);let p,g,A,_,w,M;for(n+=8+u,c.set([t.type==="video"?1:0,0,15,1,o>>>24&255,o>>>16&255,o>>>8&255,o&255,n>>>24&255,n>>>16&255,n>>>8&255,n&255],0),p=0;p<o;p++)g=a[p],A=g.duration,_=g.size,w=g.flags,M=g.cts,c.set([A>>>24&255,A>>>16&255,A>>>8&255,A&255,_>>>24&255,_>>>16&255,_>>>8&255,_&255,w.isLeading<<2|w.dependsOn,w.isDependedOn<<6|w.hasRedundancy<<4|w.paddingValue<<1|w.isNonSync,w.degradPrio&240<<8,w.degradPrio&15,M>>>24&255,M>>>16&255,M>>>8&255,M&255],12+16*p);return Ge.box(Ge.types.trun,c)}static initSegment(t){Ge.types||Ge.init();const n=Ge.moov(t);return ft(Ge.FTYP,n)}}Ge.types=void 0,Ge.HDLR_TYPES=void 0,Ge.STTS=void 0,Ge.STSC=void 0,Ge.STCO=void 0,Ge.STSZ=void 0,Ge.VMHD=void 0,Ge.SMHD=void 0,Ge.STSD=void 0,Ge.FTYP=void 0,Ge.DINF=void 0;const Go=9e4;function Vl(h,t,n=1,a=!1){const o=h*t*n;return a?Math.round(o):o}function nr(h,t,n=1,a=!1){return Vl(h,t,1/n,a)}function Ci(h,t=!1){return Vl(h,1e3,1/Go,t)}function Vr(h,t=1){return Vl(h,Go,1/t)}const ad=10*1e3,od=1024,Qa=1152,rr=1536;let is=null,_r=null;class Ho{constructor(t,n,a,o=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=t,this.config=n,this.typeSupported=a,this.ISGenerated=!1,is===null){const c=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);is=c?parseInt(c[1]):0}if(_r===null){const u=navigator.userAgent.match(/Safari\/(\d+)/i);_r=u?parseInt(u[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(t){S.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=t}resetNextTimestamp(){S.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){S.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(t){let n=!1;const a=t.reduce((o,u)=>{const c=u.pts-o;return c<-4294967296?(n=!0,Fn(o,u.pts)):c>0?o:u.pts},t[0].pts);return n&&S.debug("PTS rollover detected"),a}remux(t,n,a,o,u,c,p,g){let A,_,w,M,z,K,Z=u,ne=u;const xe=t.pid>-1,de=n.pid>-1,Be=n.samples.length,Qe=t.samples.length>0,Ne=p&&Be>0||Be>1;if((!xe||Qe)&&(!de||Ne)||this.ISGenerated||p){if(this.ISGenerated){var Xe,ct,Lt,et;const zt=this.videoTrackConfig;zt&&(n.width!==zt.width||n.height!==zt.height||((Xe=n.pixelRatio)==null?void 0:Xe[0])!==((ct=zt.pixelRatio)==null?void 0:ct[0])||((Lt=n.pixelRatio)==null?void 0:Lt[1])!==((et=zt.pixelRatio)==null?void 0:et[1]))&&this.resetInitSegment()}else w=this.generateIS(t,n,u,c);const st=this.isVideoContiguous;let Ht=-1,St;if(Ne&&(Ht=qo(n.samples),!st&&this.config.forceKeyFrameOnDiscontinuity))if(K=!0,Ht>0){S.warn(`[mp4-remuxer]: Dropped ${Ht} out of ${Be} video samples due to a missing keyframe`);const zt=this.getVideoStartPts(n.samples);n.samples=n.samples.slice(Ht),n.dropped+=Ht,ne+=(n.samples[0].pts-zt)/n.inputTimeScale,St=ne}else Ht===-1&&(S.warn(`[mp4-remuxer]: No keyframe found out of ${Be} video samples`),K=!1);if(this.ISGenerated){if(Qe&&Ne){const zt=this.getVideoStartPts(n.samples),qt=(Fn(t.samples[0].pts,zt)-zt)/n.inputTimeScale;Z+=Math.max(0,qt),ne+=Math.max(0,-qt)}if(Qe){if(t.samplerate||(S.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),w=this.generateIS(t,n,u,c)),_=this.remuxAudio(t,Z,this.isAudioContiguous,c,de||Ne||g===Wt.AUDIO?ne:void 0),Ne){const zt=_?_.endPTS-_.startPTS:0;n.inputTimeScale||(S.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),w=this.generateIS(t,n,u,c)),A=this.remuxVideo(n,ne,st,zt)}}else Ne&&(A=this.remuxVideo(n,ne,st,0));A&&(A.firstKeyFrame=Ht,A.independent=Ht!==-1,A.firstKeyFramePTS=St)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(a.samples.length&&(z=Gl(a,u,this._initPTS,this._initDTS)),o.samples.length&&(M=Hl(o,u,this._initPTS))),{audio:_,video:A,initSegment:w,independent:K,text:M,id3:z}}generateIS(t,n,a,o){const u=t.samples,c=n.samples,p=this.typeSupported,g={},A=this._initPTS;let _=!A||o,w="audio/mp4",M,z,K;if(_&&(M=z=Infinity),t.config&&u.length){switch(t.timescale=t.samplerate,t.segmentCodec){case"mp3":p.mpeg?(w="audio/mpeg",t.codec=""):p.mp3&&(t.codec="mp3");break;case"ac3":t.codec="ac-3";break}g.audio={id:"audio",container:w,codec:t.codec,initSegment:t.segmentCodec==="mp3"&&p.mpeg?new Uint8Array(0):Ge.initSegment([t]),metadata:{channelCount:t.channelCount}},_&&(K=t.inputTimeScale,!A||K!==A.timescale?M=z=u[0].pts-Math.round(K*a):_=!1)}if(n.sps&&n.pps&&c.length){if(n.timescale=n.inputTimeScale,g.video={id:"main",container:"video/mp4",codec:n.codec,initSegment:Ge.initSegment([n]),metadata:{width:n.width,height:n.height}},_)if(K=n.inputTimeScale,!A||K!==A.timescale){const Z=this.getVideoStartPts(c),ne=Math.round(K*a);z=Math.min(z,Fn(c[0].dts,Z)-ne),M=Math.min(M,Z-ne)}else _=!1;this.videoTrackConfig={width:n.width,height:n.height,pixelRatio:n.pixelRatio}}if(Object.keys(g).length)return this.ISGenerated=!0,_?(this._initPTS={baseTime:M,timescale:K},this._initDTS={baseTime:z,timescale:K}):M=K=void 0,{tracks:g,initPTS:M,timescale:K}}remuxVideo(t,n,a,o){const u=t.inputTimeScale,c=t.samples,p=[],g=c.length,A=this._initPTS;let _=this.nextAvcDts,w=8,M=this.videoSampleDuration,z,K,Z=Number.POSITIVE_INFINITY,ne=Number.NEGATIVE_INFINITY,xe=!1;if(!a||_===null){const $t=n*u,Bt=c[0].pts-Fn(c[0].dts,c[0].pts);is&&_!==null&&Math.abs($t-Bt-_)<15e3?a=!0:_=$t-Bt}const de=A.baseTime*u/A.timescale;for(let $t=0;$t<g;$t++){const Bt=c[$t];Bt.pts=Fn(Bt.pts-de,_),Bt.dts=Fn(Bt.dts-de,_),Bt.dts<c[$t>0?$t-1:$t].dts&&(xe=!0)}xe&&c.sort(function($t,Bt){const Ei=$t.dts-Bt.dts,ti=$t.pts-Bt.pts;return Ei||ti}),z=c[0].dts,K=c[c.length-1].dts;const Be=K-z,Qe=Be?Math.round(Be/(g-1)):M||t.inputTimeScale/30;if(a){const $t=z-_,Bt=$t>Qe,Ei=$t<-1;if((Bt||Ei)&&(Bt?S.warn(`AVC: ${Ci($t,!0)} ms (${$t}dts) hole between fragments detected at ${n.toFixed(3)}`):S.warn(`AVC: ${Ci(-$t,!0)} ms (${$t}dts) overlapping between fragments detected at ${n.toFixed(3)}`),!Ei||_>=c[0].pts||is)){z=_;const ti=c[0].pts-$t;if(Bt)c[0].dts=z,c[0].pts=ti;else for(let Di=0;Di<c.length&&!(c[Di].dts>ti);Di++)c[Di].dts-=$t,c[Di].pts-=$t;S.log(`Video: Initial PTS/DTS adjusted: ${Ci(ti,!0)}/${Ci(z,!0)}, delta: ${Ci($t,!0)} ms`)}}z=Math.max(0,z);let Ne=0,lt=0,Xe=z;for(let $t=0;$t<g;$t++){const Bt=c[$t],Ei=Bt.units,ti=Ei.length;let Di=0;for(let tn=0;tn<ti;tn++)Di+=Ei[tn].data.length;lt+=Di,Ne+=ti,Bt.length=Di,Bt.dts<Xe?(Bt.dts=Xe,Xe+=Qe/4|0||1):Xe=Bt.dts,Z=Math.min(Bt.pts,Z),ne=Math.max(Bt.pts,ne)}K=c[g-1].dts;const ct=lt+4*Ne+8;let Lt;try{Lt=new Uint8Array(ct)}catch($t){this.observer.emit(v.ERROR,v.ERROR,{type:$.MUX_ERROR,details:I.REMUX_ALLOC_ERROR,fatal:!1,error:$t,bytes:ct,reason:`fail allocating video mdat ${ct}`});return}const et=new DataView(Lt.buffer);et.setUint32(0,ct),Lt.set(Ge.types.mdat,4);let st=!1,Ht=Number.POSITIVE_INFINITY,St=Number.POSITIVE_INFINITY,zt=Number.NEGATIVE_INFINITY,Zt=Number.NEGATIVE_INFINITY;for(let $t=0;$t<g;$t++){const Bt=c[$t],Ei=Bt.units;let ti=0;for(let sn=0,hn=Ei.length;sn<hn;sn++){const Nn=Ei[sn],wa=Nn.data,vl=Nn.data.byteLength;et.setUint32(w,vl),w+=4,Lt.set(wa,w),w+=vl,ti+=4+vl}let Di;if($t<g-1)M=c[$t+1].dts-Bt.dts,Di=c[$t+1].pts-Bt.pts;else{const sn=this.config,hn=$t>0?Bt.dts-c[$t-1].dts:Qe;if(Di=$t>0?Bt.pts-c[$t-1].pts:Qe,sn.stretchShortVideoTrack&&this.nextAudioPts!==null){const Nn=Math.floor(sn.maxBufferHole*u),wa=(o?Z+o*u:this.nextAudioPts)-Bt.pts;wa>Nn?(M=wa-hn,M<0?M=hn:st=!0,S.log(`[mp4-remuxer]: It is approximately ${wa/90} ms to the next segment; using duration ${M/90} ms for the last video frame.`)):M=hn}else M=hn}const tn=Math.round(Bt.pts-Bt.dts);Ht=Math.min(Ht,M),zt=Math.max(zt,M),St=Math.min(St,Di),Zt=Math.max(Zt,Di),p.push(new Ko(Bt.key,M,ti,tn))}if(p.length){if(is){if(is<70){const $t=p[0].flags;$t.dependsOn=2,$t.isNonSync=0}}else if(_r&&Zt-St<zt-Ht&&Qe/zt<.025&&p[0].cts===0){S.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let $t=z;for(let Bt=0,Ei=p.length;Bt<Ei;Bt++){const ti=$t+p[Bt].duration,Di=$t+p[Bt].cts;if(Bt<Ei-1){const tn=ti+p[Bt+1].cts;p[Bt].duration=tn-Di}else p[Bt].duration=Bt?p[Bt-1].duration:Qe;p[Bt].cts=0,$t=ti}}}M=st||!M?Qe:M,this.nextAvcDts=_=K+M,this.videoSampleDuration=M,this.isVideoContiguous=!0;const qt=Ge.moof(t.sequenceNumber++,z,re({},t,{samples:p})),hi="video",Bi={data1:qt,data2:Lt,startPTS:Z/u,endPTS:(ne+M)/u,startDTS:z/u,endDTS:_/u,type:hi,hasAudio:!1,hasVideo:!0,nb:p.length,dropped:t.dropped};return t.samples=[],t.dropped=0,Bi}getSamplesPerFrame(t){switch(t.segmentCodec){case"mp3":return Qa;case"ac3":return rr;default:return od}}remuxAudio(t,n,a,o,u){const c=t.inputTimeScale,p=t.samplerate?t.samplerate:c,g=c/p,A=this.getSamplesPerFrame(t),_=A*g,w=this._initPTS,M=t.segmentCodec==="mp3"&&this.typeSupported.mpeg,z=[],K=u!==void 0;let Z=t.samples,ne=M?0:8,xe=this.nextAudioPts||-1;const de=n*c,Be=w.baseTime*c/w.timescale;if(this.isAudioContiguous=a=a||Z.length&&xe>0&&(o&&Math.abs(de-xe)<9e3||Math.abs(Fn(Z[0].pts-Be,de)-xe)<20*_),Z.forEach(function(qt){qt.pts=Fn(qt.pts-Be,de)}),!a||xe<0){if(Z=Z.filter(qt=>qt.pts>=0),!Z.length)return;u===0?xe=0:o&&!K?xe=Math.max(0,de):xe=Z[0].pts}if(t.segmentCodec==="aac"){const qt=this.config.maxAudioFramesDrift;for(let hi=0,Bi=xe;hi<Z.length;hi++){const $t=Z[hi],Bt=$t.pts,Ei=Bt-Bi,ti=Math.abs(1e3*Ei/c);if(Ei<=-qt*_&&K)hi===0&&(S.warn(`Audio frame @ ${(Bt/c).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*Ei/c)} ms.`),this.nextAudioPts=xe=Bi=Bt);else if(Ei>=qt*_&&ti<ad&&K){let Di=Math.round(Ei/_);Bi=Bt-Di*_,Bi<0&&(Di--,Bi+=_),hi===0&&(this.nextAudioPts=xe=Bi),S.warn(`[mp4-remuxer]: Injecting ${Di} audio frame @ ${(Bi/c).toFixed(3)}s due to ${Math.round(1e3*Ei/c)} ms gap.`);for(let tn=0;tn<Di;tn++){const sn=Math.max(Bi,0);let hn=_n.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);hn||(S.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),hn=$t.unit.subarray()),Z.splice(hi,0,{unit:hn,pts:sn}),Bi+=_,hi++}}$t.pts=Bi,Bi+=_}}let Qe=null,Ne=null,lt,Xe=0,ct=Z.length;for(;ct--;)Xe+=Z[ct].unit.byteLength;for(let qt=0,hi=Z.length;qt<hi;qt++){const Bi=Z[qt],$t=Bi.unit;let Bt=Bi.pts;if(Ne!==null){const ti=z[qt-1];ti.duration=Math.round((Bt-Ne)/g)}else if(a&&t.segmentCodec==="aac"&&(Bt=xe),Qe=Bt,Xe>0){Xe+=ne;try{lt=new Uint8Array(Xe)}catch(ti){this.observer.emit(v.ERROR,v.ERROR,{type:$.MUX_ERROR,details:I.REMUX_ALLOC_ERROR,fatal:!1,error:ti,bytes:Xe,reason:`fail allocating audio mdat ${Xe}`});return}M||(new DataView(lt.buffer).setUint32(0,Xe),lt.set(Ge.types.mdat,4))}else return;lt.set($t,ne);const Ei=$t.byteLength;ne+=Ei,z.push(new Ko(!0,A,Ei,0)),Ne=Bt}const Lt=z.length;if(!Lt)return;const et=z[z.length-1];this.nextAudioPts=xe=Ne+g*et.duration;const st=M?new Uint8Array(0):Ge.moof(t.sequenceNumber++,Qe/g,re({},t,{samples:z}));t.samples=[];const Ht=Qe/c,St=xe/c,Zt={data1:st,data2:lt,startPTS:Ht,endPTS:St,startDTS:Ht,endDTS:St,type:"audio",hasAudio:!0,hasVideo:!1,nb:Lt};return this.isAudioContiguous=!0,Zt}remuxEmptyAudio(t,n,a,o){const u=t.inputTimeScale,c=t.samplerate?t.samplerate:u,p=u/c,g=this.nextAudioPts,A=this._initDTS,_=A.baseTime*9e4/A.timescale,w=(g!==null?g:o.startDTS*u)+_,M=o.endDTS*u+_,z=p*od,K=Math.ceil((M-w)/z),Z=_n.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(S.warn("[mp4-remuxer]: remux empty Audio"),!Z){S.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}const ne=[];for(let xe=0;xe<K;xe++){const de=w+xe*z;ne.push({unit:Z,pts:de,dts:de})}return t.samples=ne,this.remuxAudio(t,n,a,!1)}}function Fn(h,t){let n;if(t===null)return h;for(t<h?n=-8589934592:n=8589934592;Math.abs(h-t)>4294967296;)h+=n;return h}function qo(h){for(let t=0;t<h.length;t++)if(h[t].key)return t;return-1}function Gl(h,t,n,a){const o=h.samples.length;if(!o)return;const u=h.inputTimeScale;for(let p=0;p<o;p++){const g=h.samples[p];g.pts=Fn(g.pts-n.baseTime*u/n.timescale,t*u)/u,g.dts=Fn(g.dts-a.baseTime*u/a.timescale,t*u)/u}const c=h.samples;return h.samples=[],{samples:c}}function Hl(h,t,n){const a=h.samples.length;if(!a)return;const o=h.inputTimeScale;for(let c=0;c<a;c++){const p=h.samples[c];p.pts=Fn(p.pts-n.baseTime*o/n.timescale,t*o)/o}h.samples.sort((c,p)=>c.pts-p.pts);const u=h.samples;return h.samples=[],{samples:u}}class Ko{constructor(t,n,a,o){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=n,this.size=a,this.cts=o,this.flags={isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:t?2:1,isNonSync:t?0:1}}}class Ws{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(t){this.initPTS=t,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(t,n,a,o){this.audioCodec=n,this.videoCodec=a,this.generateInitSegment(Qn(t,o)),this.emitInitSegment=!0}generateInitSegment(t){let{audioCodec:n,videoCodec:a}=this;if(!(t!=null&&t.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const o=this.initData=us(t);o.audio&&(n=Wo(o.audio,Ae.AUDIO)),o.video&&(a=Wo(o.video,Ae.VIDEO));const u={};o.audio&&o.video?u.audiovideo={container:"video/mp4",codec:n+","+a,initSegment:t,id:"main"}:o.audio?u.audio={container:"audio/mp4",codec:n,initSegment:t,id:"audio"}:o.video?u.video={container:"video/mp4",codec:a,initSegment:t,id:"main"}:S.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=u}remux(t,n,a,o,u,c){var p,g;let{initPTS:A,lastEndTime:_}=this;const w={audio:void 0,video:void 0,text:o,id3:a,initSegment:void 0};ie(_)||(_=this.lastEndTime=u||0);const M=n.samples;if(!(M!=null&&M.length))return w;const z={initPTS:void 0,timescale:1};let K=this.initData;if((p=K)!=null&&p.length||(this.generateInitSegment(M),K=this.initData),!((g=K)!=null&&g.length))return S.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),w;this.emitInitSegment&&(z.tracks=this.initTracks,this.emitInitSegment=!1);const Z=te(M,K),ne=Ao(K,M),xe=ne===null?u:ne;(wc(A,xe,u,Z)||z.timescale!==A.timescale&&c)&&(z.initPTS=xe-u,A&&A.timescale===1&&S.warn(`Adjusting initPTS by ${z.initPTS-A.baseTime}`),this.initPTS=A={baseTime:z.initPTS,timescale:1});const de=t?xe-A.baseTime/A.timescale:_,Be=de+Z;Se(K,M,A.baseTime/A.timescale),Z>0?this.lastEndTime=Be:(S.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const Qe=!!K.audio,Ne=!!K.video;let lt="";Qe&&(lt+="audio"),Ne&&(lt+="video");const Xe={data1:M,startPTS:de,startDTS:de,endPTS:Be,endDTS:Be,type:lt,hasAudio:Qe,hasVideo:Ne,nb:1,dropped:0};return w.audio=Xe.type==="audio"?Xe:void 0,w.video=Xe.type!=="audio"?Xe:void 0,w.initSegment=z,w.id3=Gl(a,u,A,A),o.samples.length&&(w.text=Hl(o,u,A)),w}}function wc(h,t,n,a){if(h===null)return!0;const o=Math.max(a,1),u=t-h.baseTime/h.timescale;return Math.abs(u-n)>o}function Wo(h,t){const n=h==null?void 0:h.codec;if(n&&n.length>4)return n;if(t===Ae.AUDIO){if(n==="ec-3"||n==="ac-3"||n==="alac")return n;if(n==="fLaC"||n==="Opus")return Ir(n,!1);const a="mp4a.40.5";return S.info(`Parsed audio codec "${n}" or audio object type not handled. Using "${a}"`),a}return S.warn(`Unhandled video codec "${n}"`),n==="hvc1"||n==="hev1"?"hvc1.1.6.L120.90":n==="av01"?"av01.0.04M.08":"avc1.42e01e"}let ns;try{ns=self.performance.now.bind(self.performance)}catch(h){S.debug("Unable to use Performance API on this environment"),ns=mt==null?void 0:mt.Date.now}const Ja=[{demux:Jt,remux:Ws},{demux:ts,remux:Ho},{demux:At,remux:Ho},{demux:qn,remux:Ho}];Ja.splice(2,0,{demux:ji,remux:Ho});class Ea{constructor(t,n,a,o,u){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=t,this.typeSupported=n,this.config=a,this.vendor=o,this.id=u}configure(t){this.transmuxConfig=t,this.decrypter&&this.decrypter.reset()}push(t,n,a,o){const u=a.transmuxing;u.executeStart=ns();let c=new Uint8Array(t);const{currentTransmuxState:p,transmuxConfig:g}=this;o&&(this.currentTransmuxState=o);const{contiguous:A,discontinuity:_,trackSwitch:w,accurateTimeOffset:M,timeOffset:z,initSegmentChange:K}=o||p,{audioCodec:Z,videoCodec:ne,defaultInitPts:xe,duration:de,initSegmentData:Be}=g,Qe=Ji(c,n);if(Qe&&Qe.method==="AES-128"){const ct=this.getDecrypter();if(ct.isSync()){let Lt=ct.softwareDecrypt(c,Qe.key.buffer,Qe.iv.buffer);if(a.part>-1&&(Lt=ct.flush()),!Lt)return u.executeEnd=ns(),zo(a);c=new Uint8Array(Lt)}else return this.decryptionPromise=ct.webCryptoDecrypt(c,Qe.key.buffer,Qe.iv.buffer).then(Lt=>{const et=this.push(Lt,null,a);return this.decryptionPromise=null,et}),this.decryptionPromise}const Ne=this.needsProbing(_,w);if(Ne){const ct=this.configureTransmuxer(c);if(ct)return S.warn(`[transmuxer] ${ct.message}`),this.observer.emit(v.ERROR,v.ERROR,{type:$.MEDIA_ERROR,details:I.FRAG_PARSING_ERROR,fatal:!1,error:ct,reason:ct.message}),u.executeEnd=ns(),zo(a)}(_||w||K||Ne)&&this.resetInitSegment(Be,Z,ne,de,n),(_||K||Ne)&&this.resetInitialTimestamp(xe),A||this.resetContiguity();const lt=this.transmux(c,Qe,z,M,a),Xe=this.currentTransmuxState;return Xe.contiguous=!0,Xe.discontinuity=!1,Xe.trackSwitch=!1,u.executeEnd=ns(),lt}flush(t){const n=t.transmuxing;n.executeStart=ns();const{decrypter:a,currentTransmuxState:o,decryptionPromise:u}=this;if(u)return u.then(()=>this.flush(t));const c=[],{timeOffset:p}=o;if(a){const w=a.flush();w&&c.push(this.push(w,null,t))}const{demuxer:g,remuxer:A}=this;if(!g||!A)return n.executeEnd=ns(),[zo(t)];const _=g.flush(p);return Yo(_)?_.then(w=>(this.flushRemux(c,w,t),c)):(this.flushRemux(c,_,t),c)}flushRemux(t,n,a){const{audioTrack:o,videoTrack:u,id3Track:c,textTrack:p}=n,{accurateTimeOffset:g,timeOffset:A}=this.currentTransmuxState;S.log(`[transmuxer.ts]: Flushed fragment ${a.sn}${a.part>-1?" p: "+a.part:""} of level ${a.level}`);const _=this.remuxer.remux(o,u,c,p,A,g,!0,this.id);t.push({remuxResult:_,chunkMeta:a}),a.transmuxing.executeEnd=ns()}resetInitialTimestamp(t){const{demuxer:n,remuxer:a}=this;!n||!a||(n.resetTimeStamp(t),a.resetTimeStamp(t))}resetContiguity(){const{demuxer:t,remuxer:n}=this;!t||!n||(t.resetContiguity(),n.resetNextTimestamp())}resetInitSegment(t,n,a,o,u){const{demuxer:c,remuxer:p}=this;!c||!p||(c.resetInitSegment(t,n,a,o),p.resetInitSegment(t,n,a,u))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(t,n,a,o,u){let c;return n&&n.method==="SAMPLE-AES"?c=this.transmuxSampleAes(t,n,a,o,u):c=this.transmuxUnencrypted(t,a,o,u),c}transmuxUnencrypted(t,n,a,o){const{audioTrack:u,videoTrack:c,id3Track:p,textTrack:g}=this.demuxer.demux(t,n,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(u,c,p,g,n,a,!1,this.id),chunkMeta:o}}transmuxSampleAes(t,n,a,o,u){return this.demuxer.demuxSampleAes(t,n,a).then(c=>({remuxResult:this.remuxer.remux(c.audioTrack,c.videoTrack,c.id3Track,c.textTrack,a,o,!1,this.id),chunkMeta:u}))}configureTransmuxer(t){const{config:n,observer:a,typeSupported:o,vendor:u}=this;let c;for(let M=0,z=Ja.length;M<z;M++){var p;if((p=Ja[M].demux)!=null&&p.probe(t)){c=Ja[M];break}}if(!c)return new Error("Failed to find demuxer by probing fragment data");const g=this.demuxer,A=this.remuxer,_=c.remux,w=c.demux;(!A||!(A instanceof _))&&(this.remuxer=new _(a,n,o,u)),(!g||!(g instanceof w))&&(this.demuxer=new w(a,n,o),this.probe=w.probe)}needsProbing(t,n){return!this.demuxer||!this.remuxer||t||n}getDecrypter(){let t=this.decrypter;return t||(t=this.decrypter=new Zr(this.config)),t}}function Ji(h,t){let n=null;return h.byteLength>0&&(t==null?void 0:t.key)!=null&&t.iv!==null&&t.method!=null&&(n=t),n}const zo=h=>({remuxResult:{},chunkMeta:h});function Yo(h){return"then"in h&&h.then instanceof Function}class it{constructor(t,n,a,o,u){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=t,this.videoCodec=n,this.initSegmentData=a,this.duration=o,this.defaultInitPts=u||null}}class Lc{constructor(t,n,a,o,u,c){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=t,this.contiguous=n,this.accurateTimeOffset=a,this.trackSwitch=o,this.timeOffset=u,this.initSegmentChange=c}}var ql={exports:{}};(function(h){var t=Object.prototype.hasOwnProperty,n="~";function a(){}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(n=!1));function o(g,A,_){this.fn=g,this.context=A,this.once=_||!1}function u(g,A,_,w,M){if(typeof _!="function")throw new TypeError("The listener must be a function");var z=new o(_,w||g,M),K=n?n+A:A;return g._events[K]?g._events[K].fn?g._events[K]=[g._events[K],z]:g._events[K].push(z):(g._events[K]=z,g._eventsCount++),g}function c(g,A){--g._eventsCount==0?g._events=new a:delete g._events[A]}function p(){this._events=new a,this._eventsCount=0}p.prototype.eventNames=function(){var A=[],_,w;if(this._eventsCount===0)return A;for(w in _=this._events)t.call(_,w)&&A.push(n?w.slice(1):w);return Object.getOwnPropertySymbols?A.concat(Object.getOwnPropertySymbols(_)):A},p.prototype.listeners=function(A){var _=n?n+A:A,w=this._events[_];if(!w)return[];if(w.fn)return[w.fn];for(var M=0,z=w.length,K=new Array(z);M<z;M++)K[M]=w[M].fn;return K},p.prototype.listenerCount=function(A){var _=n?n+A:A,w=this._events[_];return w?w.fn?1:w.length:0},p.prototype.emit=function(A,_,w,M,z,K){var Z=n?n+A:A;if(!this._events[Z])return!1;var ne=this._events[Z],xe=arguments.length,de,Be;if(ne.fn){switch(ne.once&&this.removeListener(A,ne.fn,void 0,!0),xe){case 1:return ne.fn.call(ne.context),!0;case 2:return ne.fn.call(ne.context,_),!0;case 3:return ne.fn.call(ne.context,_,w),!0;case 4:return ne.fn.call(ne.context,_,w,M),!0;case 5:return ne.fn.call(ne.context,_,w,M,z),!0;case 6:return ne.fn.call(ne.context,_,w,M,z,K),!0}for(Be=1,de=new Array(xe-1);Be<xe;Be++)de[Be-1]=arguments[Be];ne.fn.apply(ne.context,de)}else{var Qe=ne.length,Ne;for(Be=0;Be<Qe;Be++)switch(ne[Be].once&&this.removeListener(A,ne[Be].fn,void 0,!0),xe){case 1:ne[Be].fn.call(ne[Be].context);break;case 2:ne[Be].fn.call(ne[Be].context,_);break;case 3:ne[Be].fn.call(ne[Be].context,_,w);break;case 4:ne[Be].fn.call(ne[Be].context,_,w,M);break;default:if(!de)for(Ne=1,de=new Array(xe-1);Ne<xe;Ne++)de[Ne-1]=arguments[Ne];ne[Be].fn.apply(ne[Be].context,de)}}return!0},p.prototype.on=function(A,_,w){return u(this,A,_,w,!1)},p.prototype.once=function(A,_,w){return u(this,A,_,w,!0)},p.prototype.removeListener=function(A,_,w,M){var z=n?n+A:A;if(!this._events[z])return this;if(!_)return c(this,z),this;var K=this._events[z];if(K.fn)K.fn===_&&(!M||K.once)&&(!w||K.context===w)&&c(this,z);else{for(var Z=0,ne=[],xe=K.length;Z<xe;Z++)(K[Z].fn!==_||M&&!K[Z].once||w&&K[Z].context!==w)&&ne.push(K[Z]);ne.length?this._events[z]=ne.length===1?ne[0]:ne:c(this,z)}return this},p.prototype.removeAllListeners=function(A){var _;return A?(_=n?n+A:A,this._events[_]&&c(this,_)):(this._events=new a,this._eventsCount=0),this},p.prototype.off=p.prototype.removeListener,p.prototype.addListener=p.prototype.on,p.prefixed=n,p.EventEmitter=p,h.exports=p})(ql);var Kl=ql.exports,Wn=ut(Kl);class Wl{constructor(t,n,a,o){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const u=t.config;this.hls=t,this.id=n,this.useWorker=!!u.enableWorker,this.onTransmuxComplete=a,this.onFlush=o;const c=(_,w)=>{w=w||{},w.frag=this.frag,w.id=this.id,_===v.ERROR&&(this.error=w.error),this.hls.trigger(_,w)};this.observer=new Wn,this.observer.on(v.FRAG_DECRYPTED,c),this.observer.on(v.ERROR,c);const p=fr(u.preferManagedMediaSource)||{isTypeSupported:()=>!1},g={mpeg:p.isTypeSupported("audio/mpeg"),mp3:p.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:p.isTypeSupported('audio/mp4; codecs="ac-3"')},A=navigator.vendor;if(this.useWorker&&typeof Worker!="undefined"&&(u.workerPath||Uo())){try{u.workerPath?(S.log(`loading Web Worker ${u.workerPath} for "${n}"`),this.workerContext=jr(u.workerPath)):(S.log(`injecting Web Worker for "${n}"`),this.workerContext=ri()),this.onwmsg=M=>this.onWorkerMessage(M);const{worker:w}=this.workerContext;w.addEventListener("message",this.onwmsg),w.onerror=M=>{const z=new Error(`${M.message}  (${M.filename}:${M.lineno})`);u.enableWorker=!1,S.warn(`Error in "${n}" Web Worker, fallback to inline`),this.hls.trigger(v.ERROR,{type:$.OTHER_ERROR,details:I.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:z})},w.postMessage({cmd:"init",typeSupported:g,vendor:A,id:n,config:JSON.stringify(u)})}catch(w){S.warn(`Error setting up "${n}" Web Worker, fallback to inline`,w),this.resetWorker(),this.error=null,this.transmuxer=new Ea(this.observer,g,u,A,n)}return}this.transmuxer=new Ea(this.observer,g,u,A,n)}resetWorker(){if(this.workerContext){const{worker:t,objectURL:n}=this.workerContext;n&&self.URL.revokeObjectURL(n),t.removeEventListener("message",this.onwmsg),t.onerror=null,t.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const n=this.transmuxer;n&&(n.destroy(),this.transmuxer=null)}const t=this.observer;t&&t.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(t,n,a,o,u,c,p,g,A,_){var w,M;A.transmuxing.start=self.performance.now();const{transmuxer:z}=this,K=c?c.start:u.start,Z=u.decryptdata,ne=this.frag,xe=!(ne&&u.cc===ne.cc),de=!(ne&&A.level===ne.level),Be=ne?A.sn-ne.sn:-1,Qe=this.part?A.part-this.part.index:-1,Ne=Be===0&&A.id>1&&A.id===(ne==null?void 0:ne.stats.chunkCount),lt=!de&&(Be===1||Be===0&&(Qe===1||Ne&&Qe<=0)),Xe=self.performance.now();(de||Be||u.stats.parsing.start===0)&&(u.stats.parsing.start=Xe),c&&(Qe||!lt)&&(c.stats.parsing.start=Xe);const ct=!(ne&&((w=u.initSegment)==null?void 0:w.url)===((M=ne.initSegment)==null?void 0:M.url)),Lt=new Lc(xe,lt,g,de,K,ct);if(!lt||xe||ct){S.log(`[transmuxer-interface, ${u.type}]: Starting new transmux session for sn: ${A.sn} p: ${A.part} level: ${A.level} id: ${A.id}
        discontinuity: ${xe}
        trackSwitch: ${de}
        contiguous: ${lt}
        accurateTimeOffset: ${g}
        timeOffset: ${K}
        initSegmentChange: ${ct}`);const et=new it(a,o,n,p,_);this.configureTransmuxer(et)}if(this.frag=u,this.part=c,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:t,decryptdata:Z,chunkMeta:A,state:Lt},t instanceof ArrayBuffer?[t]:[]);else if(z){const et=z.push(t,Z,A,Lt);Yo(et)?(z.async=!0,et.then(st=>{this.handleTransmuxComplete(st)}).catch(st=>{this.transmuxerError(st,A,"transmuxer-interface push error")})):(z.async=!1,this.handleTransmuxComplete(et))}}flush(t){t.transmuxing.start=self.performance.now();const{transmuxer:n}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:t});else if(n){let a=n.flush(t);Yo(a)||n.async?(Yo(a)||(a=Promise.resolve(a)),a.then(u=>{this.handleFlushResult(u,t)}).catch(u=>{this.transmuxerError(u,t,"transmuxer-interface flush error")})):this.handleFlushResult(a,t)}}transmuxerError(t,n,a){!this.hls||(this.error=t,this.hls.trigger(v.ERROR,{type:$.MEDIA_ERROR,details:I.FRAG_PARSING_ERROR,chunkMeta:n,fatal:!1,error:t,err:t,reason:a}))}handleFlushResult(t,n){t.forEach(a=>{this.handleTransmuxComplete(a)}),this.onFlush(n)}onWorkerMessage(t){const n=t.data,a=this.hls;switch(n.event){case"init":{var o;const u=(o=this.workerContext)==null?void 0:o.objectURL;u&&self.URL.revokeObjectURL(u);break}case"transmuxComplete":{this.handleTransmuxComplete(n.data);break}case"flush":{this.onFlush(n.data);break}case"workerLog":S[n.data.logType]&&S[n.data.logType](n.data.message);break;default:{n.data=n.data||{},n.data.frag=this.frag,n.data.id=this.id,a.trigger(n.event,n.data);break}}}configureTransmuxer(t){const{transmuxer:n}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:t}):n&&n.configure(t)}handleTransmuxComplete(t){t.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(t)}}function Xo(h,t){if(h.length!==t.length)return!1;for(let n=0;n<h.length;n++)if(!zs(h[n].attrs,t[n].attrs))return!1;return!0}function zs(h,t,n){const a=h["STABLE-RENDITION-ID"];return a&&!n?a===t["STABLE-RENDITION-ID"]:!(n||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(o=>h[o]!==t[o])}function Qo(h,t){return t.label.toLowerCase()===h.name.toLowerCase()&&(!t.language||t.language.toLowerCase()===(h.lang||"").toLowerCase())}const xs=100;class Dc extends Ur{constructor(t,n,a){super(t,n,a,"[audio-stream-controller]",Wt.AUDIO);this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:t}=this;t.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.LEVEL_LOADED,this.onLevelLoaded,this),t.on(v.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.on(v.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(v.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(v.ERROR,this.onError,this),t.on(v.BUFFER_RESET,this.onBufferReset,this),t.on(v.BUFFER_CREATED,this.onBufferCreated,this),t.on(v.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(v.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(v.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(v.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:t}=this;t.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.LEVEL_LOADED,this.onLevelLoaded,this),t.off(v.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.off(v.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(v.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(v.ERROR,this.onError,this),t.off(v.BUFFER_RESET,this.onBufferReset,this),t.off(v.BUFFER_CREATED,this.onBufferCreated,this),t.off(v.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(v.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(v.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(v.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(t,{frag:n,id:a,initPTS:o,timescale:u}){if(a==="main"){const c=n.cc;this.initPTS[n.cc]={baseTime:o,timescale:u},this.log(`InitPTS for cc: ${c} found from main: ${o}`),this.videoTrackCC=c,this.state===ot.WAITING_INIT_PTS&&this.tick()}}startLoad(t){if(!this.levels){this.startPosition=t,this.state=ot.STOPPED;return}const n=this.lastCurrentTime;this.stopLoad(),this.setInterval(xs),n>0&&t===-1?(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),t=n,this.state=ot.IDLE):(this.loadedmetadata=!1,this.state=ot.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}doTick(){switch(this.state){case ot.IDLE:this.doTickIdle();break;case ot.WAITING_TRACK:{var t;const{levels:a,trackId:o}=this,u=a==null||(t=a[o])==null?void 0:t.details;if(u){if(this.waitForCdnTuneIn(u))break;this.state=ot.WAITING_INIT_PTS}break}case ot.FRAG_LOADING_WAITING_RETRY:{var n;const a=performance.now(),o=this.retryDate;if(!o||a>=o||(n=this.media)!=null&&n.seeking){const{levels:u,trackId:c}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((u==null?void 0:u[c])||null),this.state=ot.IDLE}break}case ot.WAITING_INIT_PTS:{const a=this.waitingData;if(a){const{frag:o,part:u,cache:c,complete:p}=a;if(this.initPTS[o.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=ot.FRAG_LOADING;const g=c.flush(),A={frag:o,part:u,payload:g,networkDetails:null};this._handleFragmentLoadProgress(A),p&&super._handleFragmentLoadComplete(A)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${o.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const g=this.getLoadPosition(),A=_i.bufferInfo(this.mediaBuffer,g,this.config.maxBufferHole);pa(A.end,this.config.maxFragLookUpTolerance,o)<0&&(this.log(`Waiting fragment cc (${o.cc}) @ ${o.start} cancelled because another fragment at ${A.end} is needed`),this.clearWaitingFragment())}}else this.state=ot.IDLE}}this.onTickEnd()}clearWaitingFragment(){const t=this.waitingData;t&&(this.fragmentTracker.removeFragment(t.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=ot.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:t}=this;!(t!=null&&t.readyState)||(this.lastCurrentTime=t.currentTime)}doTickIdle(){const{hls:t,levels:n,media:a,trackId:o}=this,u=t.config;if(!a&&(this.startFragRequested||!u.startFragPrefetch)||!(n!=null&&n[o]))return;const c=n[o],p=c.details;if(!p||p.live&&this.levelLastLoaded!==c||this.waitForCdnTuneIn(p)){this.state=ot.WAITING_TRACK;return}const g=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&g&&(this.bufferFlushed=!1,this.afterBufferFlushed(g,Ae.AUDIO,Wt.AUDIO));const A=this.getFwdBufferInfo(g,Wt.AUDIO);if(A===null)return;const{bufferedTrack:_,switchingTrack:w}=this;if(!w&&this._streamEnded(A,p)){t.trigger(v.BUFFER_EOS,{type:"audio"}),this.state=ot.ENDED;return}const M=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,Wt.MAIN),z=A.len,K=this.getMaxBufferLength(M==null?void 0:M.len),Z=p.fragments,ne=Z[0].start;let xe=this.flushing?this.getLoadPosition():A.end;if(w&&a){const Ne=this.getLoadPosition();_&&!zs(w.attrs,_.attrs)&&(xe=Ne),p.PTSKnown&&Ne<ne&&(A.end>ne||A.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),a.currentTime=ne+.05)}if(z>=K&&!w&&xe<Z[Z.length-1].start)return;let de=this.getNextFragment(xe,p),Be=!1;if(de&&this.isLoopLoading(de,xe)&&(Be=!!de.gap,de=this.getNextFragmentLoopLoading(de,p,A,Wt.MAIN,K)),!de){this.bufferFlushed=!0;return}const Qe=M&&de.start>M.end+p.targetduration;if(Qe||!(M!=null&&M.len)&&A.len){const Ne=this.getAppendedFrag(de.start,Wt.MAIN);if(Ne===null||(Be||(Be=!!Ne.gap||!!Qe&&M.len===0),Qe&&!Be||Be&&A.nextStart&&A.nextStart<Ne.end))return}this.loadFragment(de,c,xe)}getMaxBufferLength(t){const n=super.getMaxBufferLength();return t?Math.min(Math.max(n,t),this.config.maxMaxBufferLength):n}onMediaDetaching(){this.videoBuffer=null,this.bufferFlushed=this.flushing=!1,super.onMediaDetaching()}onAudioTracksUpdated(t,{audioTracks:n}){this.resetTransmuxer(),this.levels=n.map(a=>new Pr(a))}onAudioTrackSwitching(t,n){const a=!!n.url;this.trackId=n.id;const{fragCurrent:o}=this;o&&(o.abortRequests(),this.removeUnbufferedFrags(o.start)),this.resetLoadingState(),a?this.setInterval(xs):this.resetTransmuxer(),a?(this.switchingTrack=n,this.state=ot.IDLE,this.flushAudioIfNeeded(n)):(this.switchingTrack=null,this.bufferedTrack=n,this.state=ot.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=this.flushing=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(t,n){this.mainDetails=n.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(v.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(t,n){var a;if(this.mainDetails==null){this.cachedTrackLoadedData=n;return}const{levels:o}=this,{details:u,id:c}=n;if(!o){this.warn(`Audio tracks were reset while loading level ${c}`);return}this.log(`Audio track ${c} loaded [${u.startSN},${u.endSN}]${u.lastPartSn?`[part-${u.lastPartSn}-${u.lastPartIndex}]`:""},duration:${u.totalduration}`);const p=o[c];let g=0;if(u.live||(a=p.details)!=null&&a.live){this.checkLiveUpdate(u);const _=this.mainDetails;if(u.deltaUpdateFailed||!_)return;if(!p.details&&u.hasProgramDateTime&&_.hasProgramDateTime)_s(u,_),g=u.fragments[0].start;else{var A;g=this.alignPlaylists(u,p.details,(A=this.levelLastLoaded)==null?void 0:A.details)}}p.details=u,this.levelLastLoaded=p,!this.startFragRequested&&(this.mainDetails||!u.live)&&this.setStartPosition(this.mainDetails||u,g),this.state===ot.WAITING_TRACK&&!this.waitForCdnTuneIn(u)&&(this.state=ot.IDLE),this.tick()}_handleFragmentLoadProgress(t){var n;const{frag:a,part:o,payload:u}=t,{config:c,trackId:p,levels:g}=this;if(!g){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${a.sn} of level ${a.level} will not be buffered`);return}const A=g[p];if(!A){this.warn("Audio track is undefined on fragment load progress");return}const _=A.details;if(!_){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(a.start);return}const w=c.defaultAudioCodec||A.audioCodec||"mp4a.40.2";let M=this.transmuxer;M||(M=this.transmuxer=new Wl(this.hls,Wt.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const z=this.initPTS[a.cc],K=(n=a.initSegment)==null?void 0:n.data;if(z!==void 0){const Z=!1,ne=o?o.index:-1,xe=ne!==-1,de=new za(a.level,a.sn,a.stats.chunkCount,u.byteLength,ne,xe);M.push(u,K,w,"",a,o,_.totalduration,Z,de,z)}else{this.log(`Unknown video PTS for cc ${a.cc}, waiting for video PTS before demuxing audio frag ${a.sn} of [${_.startSN} ,${_.endSN}],track ${p}`);const{cache:Z}=this.waitingData=this.waitingData||{frag:a,part:o,cache:new Vn,complete:!1};Z.push(new Uint8Array(u)),this.waitingVideoCC=this.videoTrackCC,this.state=ot.WAITING_INIT_PTS}}_handleFragmentLoadComplete(t){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(t)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(t,n){const a=n.tracks.audio;a&&(this.mediaBuffer=a.buffer||null),n.tracks.video&&(this.videoBuffer=n.tracks.video.buffer||null)}onFragBuffered(t,n){const{frag:a,part:o}=n;if(a.type!==Wt.AUDIO){if(!this.loadedmetadata&&a.type===Wt.MAIN){const u=this.videoBuffer||this.media;u&&_i.getBuffered(u).length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(a)){this.warn(`Fragment ${a.sn}${o?" p: "+o.index:""} of level ${a.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(a.sn!=="initSegment"){this.fragPrevious=a;const u=this.switchingTrack;u&&(this.bufferedTrack=u,this.switchingTrack=null,this.hls.trigger(v.AUDIO_TRACK_SWITCHED,nt({},u)))}this.fragBufferedComplete(a,o)}onError(t,n){var a;if(n.fatal){this.state=ot.ERROR;return}switch(n.details){case I.FRAG_GAP:case I.FRAG_PARSING_ERROR:case I.FRAG_DECRYPT_ERROR:case I.FRAG_LOAD_ERROR:case I.FRAG_LOAD_TIMEOUT:case I.KEY_LOAD_ERROR:case I.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Wt.AUDIO,n);break;case I.AUDIO_TRACK_LOAD_ERROR:case I.AUDIO_TRACK_LOAD_TIMEOUT:case I.LEVEL_PARSING_ERROR:!n.levelRetry&&this.state===ot.WAITING_TRACK&&((a=n.context)==null?void 0:a.type)===di.AUDIO_TRACK&&(this.state=ot.IDLE);break;case I.BUFFER_APPEND_ERROR:case I.BUFFER_FULL_ERROR:if(!n.parent||n.parent!=="audio")return;if(n.details===I.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(n)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case I.INTERNAL_EXCEPTION:this.recoverWorkerError(n);break}}onBufferFlushing(t,{type:n}){n!==Ae.VIDEO&&(this.flushing=!0)}onBufferFlushed(t,{type:n}){if(n!==Ae.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===ot.ENDED&&(this.state=ot.IDLE);const a=this.mediaBuffer||this.media;a&&(this.afterBufferFlushed(a,n,Wt.AUDIO),this.tick())}}_handleTransmuxComplete(t){var n;const a="audio",{hls:o}=this,{remuxResult:u,chunkMeta:c}=t,p=this.getCurrentContext(c);if(!p){this.resetWhenMissingContext(c);return}const{frag:g,part:A,level:_}=p,{details:w}=_,{audio:M,text:z,id3:K,initSegment:Z}=u;if(this.fragContextChanged(g)||!w){this.fragmentTracker.removeFragment(g);return}if(this.state=ot.PARSING,this.switchingTrack&&M&&this.completeAudioSwitch(this.switchingTrack),Z!=null&&Z.tracks){const ne=g.initSegment||g;this._bufferInitSegment(_,Z.tracks,ne,c),o.trigger(v.FRAG_PARSING_INIT_SEGMENT,{frag:ne,id:a,tracks:Z.tracks})}if(M){const{startPTS:ne,endPTS:xe,startDTS:de,endDTS:Be}=M;A&&(A.elementaryStreams[Ae.AUDIO]={startPTS:ne,endPTS:xe,startDTS:de,endDTS:Be}),g.setElementaryStreamInfo(Ae.AUDIO,ne,xe,de,Be),this.bufferFragmentData(M,g,A,c)}if(K!=null&&(n=K.samples)!=null&&n.length){const ne=re({id:a,frag:g,details:w},K);o.trigger(v.FRAG_PARSING_METADATA,ne)}if(z){const ne=re({id:a,frag:g,details:w},z);o.trigger(v.FRAG_PARSING_USERDATA,ne)}}_bufferInitSegment(t,n,a,o){if(this.state!==ot.PARSING)return;n.video&&delete n.video;const u=n.audio;if(!u)return;u.id="audio";const c=t.audioCodec;this.log(`Init audio buffer, container:${u.container}, codecs[level/parsed]=[${c}/${u.codec}]`),c&&c.split(",").length===1&&(u.levelCodec=c),this.hls.trigger(v.BUFFER_CODECS,n);const p=u.initSegment;if(p!=null&&p.byteLength){const g={type:"audio",frag:a,part:null,chunkMeta:o,parent:a.type,data:p};this.hls.trigger(v.BUFFER_APPENDING,g)}this.tickImmediate()}loadFragment(t,n,a){const o=this.fragmentTracker.getState(t);if(this.fragCurrent=t,this.switchingTrack||o===Ui.NOT_LOADED||o===Ui.PARTIAL){var u;if(t.sn==="initSegment")this._loadInitSegment(t,n);else if((u=n.details)!=null&&u.live&&!this.initPTS[t.cc]){this.log(`Waiting for video PTS in continuity counter ${t.cc} of live stream before loading audio fragment ${t.sn} of level ${this.trackId}`),this.state=ot.WAITING_INIT_PTS;const c=this.mainDetails;c&&c.fragments[0].start!==n.details.fragments[0].start&&_s(n.details,c)}else this.startFragRequested=!0,super.loadFragment(t,n,a)}else this.clearTrackerIfNeeded(t)}flushAudioIfNeeded(t){const{media:n,bufferedTrack:a}=this,o=a==null?void 0:a.attrs,u=t.attrs;n&&o&&(o.CHANNELS!==u.CHANNELS||a.name!==t.name||a.lang!==t.lang)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null)}completeAudioSwitch(t){const{hls:n}=this;this.flushAudioIfNeeded(t),this.bufferedTrack=t,this.switchingTrack=null,n.trigger(v.AUDIO_TRACK_SWITCHED,nt({},t))}}class ld extends Ka{constructor(t){super(t,"[audio-track-controller]");this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:t}=this;t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.MANIFEST_PARSED,this.onManifestParsed,this),t.on(v.LEVEL_LOADING,this.onLevelLoading,this),t.on(v.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(v.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(v.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.MANIFEST_PARSED,this.onManifestParsed,this),t.off(v.LEVEL_LOADING,this.onLevelLoading,this),t.off(v.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(v.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(v.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(t,n){this.tracks=n.audioTracks||[]}onAudioTrackLoaded(t,n){const{id:a,groupId:o,details:u}=n,c=this.tracksInGroup[a];if(!c||c.groupId!==o){this.warn(`Audio track with id:${a} and group:${o} not found in active group ${c==null?void 0:c.groupId}`);return}const p=c.details;c.details=n.details,this.log(`Audio track ${a} "${c.name}" lang:${c.lang} group:${o} loaded [${u.startSN}-${u.endSN}]`),a===this.trackId&&this.playlistLoaded(a,n,p)}onLevelLoading(t,n){this.switchLevel(n.level)}onLevelSwitching(t,n){this.switchLevel(n.level)}switchLevel(t){const n=this.hls.levels[t];if(!n)return;const a=n.audioGroups||null,o=this.groupIds;let u=this.currentTrack;if(!a||(o==null?void 0:o.length)!==(a==null?void 0:a.length)||a!=null&&a.some(p=>(o==null?void 0:o.indexOf(p))===-1)){this.groupIds=a,this.trackId=-1,this.currentTrack=null;const p=this.tracks.filter(M=>!a||a.indexOf(M.groupId)!==-1);if(p.length)this.selectDefaultTrack&&!p.some(M=>M.default)&&(this.selectDefaultTrack=!1),p.forEach((M,z)=>{M.id=z});else if(!u&&!this.tracksInGroup.length)return;this.tracksInGroup=p;const g=this.hls.config.audioPreference;if(!u&&g){const M=Li(g,p,ni);if(M>-1)u=p[M];else{const z=Li(g,this.tracks);u=this.tracks[z]}}let A=this.findTrackId(u);A===-1&&u&&(A=this.findTrackId(null));const _={audioTracks:p};this.log(`Updating audio tracks, ${p.length} track(s) found in group(s): ${a==null?void 0:a.join(",")}`),this.hls.trigger(v.AUDIO_TRACKS_UPDATED,_);const w=this.trackId;if(A!==-1&&w===-1)this.setAudioTrack(A);else if(p.length&&w===-1){var c;const M=new Error(`No audio track selected for current audio group-ID(s): ${(c=this.groupIds)==null?void 0:c.join(",")} track count: ${p.length}`);this.warn(M.message),this.hls.trigger(v.ERROR,{type:$.MEDIA_ERROR,details:I.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:M})}}else this.shouldReloadPlaylist(u)&&this.setAudioTrack(this.trackId)}onError(t,n){n.fatal||!n.context||n.context.type===di.AUDIO_TRACK&&n.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(n.context.groupId)!==-1)&&(this.requestScheduled=-1,this.checkRetry(n))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(t){this.selectDefaultTrack=!1,this.setAudioTrack(t)}setAudioOption(t){const n=this.hls;if(n.config.audioPreference=t,t){const a=this.allAudioTracks;if(this.selectDefaultTrack=!1,a.length){const o=this.currentTrack;if(o&&ys(t,o,ni))return o;const u=Li(t,this.tracksInGroup,ni);if(u>-1){const c=this.tracksInGroup[u];return this.setAudioTrack(u),c}else if(o){let c=n.loadLevel;c===-1&&(c=n.firstAutoLevel);const p=vs(t,n.levels,a,c,ni);if(p===-1)return null;n.nextLoadLevel=p}if(t.channels||t.audioCodec){const c=Li(t,a);if(c>-1)return a[c]}}}return null}setAudioTrack(t){const n=this.tracksInGroup;if(t<0||t>=n.length){this.warn(`Invalid audio track id: ${t}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const a=this.currentTrack,o=n[t],u=o.details&&!o.details.live;if(t===this.trackId&&o===a&&u||(this.log(`Switching to audio-track ${t} "${o.name}" lang:${o.lang} group:${o.groupId} channels:${o.channels}`),this.trackId=t,this.currentTrack=o,this.hls.trigger(v.AUDIO_TRACK_SWITCHING,nt({},o)),u))return;const c=this.switchParams(o.url,a==null?void 0:a.details);this.loadPlaylist(c)}findTrackId(t){const n=this.tracksInGroup;for(let a=0;a<n.length;a++){const o=n[a];if(!(this.selectDefaultTrack&&!o.default)&&(!t||ys(t,o,ni)))return a}if(t){const{name:a,lang:o,assocLang:u,characteristics:c,audioCodec:p,channels:g}=t;for(let A=0;A<n.length;A++){const _=n[A];if(ys({name:a,lang:o,assocLang:u,characteristics:c,audioCodec:p,channels:g},_,ni))return A}for(let A=0;A<n.length;A++){const _=n[A];if(zs(t.attrs,_.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return A}for(let A=0;A<n.length;A++){const _=n[A];if(zs(t.attrs,_.attrs,["LANGUAGE"]))return A}}return-1}loadPlaylist(t){const n=this.currentTrack;if(this.shouldLoadPlaylist(n)&&n){super.loadPlaylist();const a=n.id,o=n.groupId;let u=n.url;if(t)try{u=t.addDirectives(u)}catch(c){this.warn(`Could not construct new URL with HLS Delivery Directives: ${c}`)}this.log(`loading audio-track playlist ${a} "${n.name}" lang:${n.lang} group:${o}`),this.clearTimer(),this.hls.trigger(v.AUDIO_TRACK_LOADING,{url:u,id:a,groupId:o,deliveryDirectives:t||null})}}}const Cn=500;class Za extends Ur{constructor(t,n,a){super(t,n,a,"[subtitle-stream-controller]",Wt.SUBTITLE);this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}_registerListeners(){const{hls:t}=this;t.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.LEVEL_LOADED,this.onLevelLoaded,this),t.on(v.ERROR,this.onError,this),t.on(v.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(v.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.on(v.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(v.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.on(v.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(v.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:t}=this;t.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.LEVEL_LOADED,this.onLevelLoaded,this),t.off(v.ERROR,this.onError,this),t.off(v.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(v.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.off(v.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(v.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.off(v.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(v.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(t){this.stopLoad(),this.state=ot.IDLE,this.setInterval(Cn),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(t,n){this.mainDetails=n.details}onSubtitleFragProcessed(t,n){const{frag:a,success:o}=n;if(this.fragPrevious=a,this.state=ot.IDLE,!o)return;const u=this.tracksBuffered[this.currentTrackId];if(!u)return;let c;const p=a.start;for(let A=0;A<u.length;A++)if(p>=u[A].start&&p<=u[A].end){c=u[A];break}const g=a.start+a.duration;c?c.end=g:(c={start:p,end:g},u.push(c)),this.fragmentTracker.fragBuffered(a),this.fragBufferedComplete(a,null)}onBufferFlushing(t,n){const{startOffset:a,endOffset:o}=n;if(a===0&&o!==Number.POSITIVE_INFINITY){const u=o-1;if(u<=0)return;n.endOffsetSubtitles=Math.max(0,u),this.tracksBuffered.forEach(c=>{for(let p=0;p<c.length;){if(c[p].end<=u){c.shift();continue}else if(c[p].start<u)c[p].start=u;else break;p++}}),this.fragmentTracker.removeFragmentsInRange(a,u,Wt.SUBTITLE)}}onFragBuffered(t,n){if(!this.loadedmetadata&&n.frag.type===Wt.MAIN){var a;(a=this.media)!=null&&a.buffered.length&&(this.loadedmetadata=!0)}}onError(t,n){const a=n.frag;(a==null?void 0:a.type)===Wt.SUBTITLE&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==ot.STOPPED&&(this.state=ot.IDLE))}onSubtitleTracksUpdated(t,{subtitleTracks:n}){if(this.levels&&Xo(this.levels,n)){this.levels=n.map(a=>new Pr(a));return}this.tracksBuffered=[],this.levels=n.map(a=>{const o=new Pr(a);return this.tracksBuffered[o.id]=[],o}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Wt.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(t,n){var a;if(this.currentTrackId=n.id,!((a=this.levels)!=null&&a.length)||this.currentTrackId===-1){this.clearInterval();return}const o=this.levels[this.currentTrackId];o!=null&&o.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,o&&this.setInterval(Cn)}onSubtitleTrackLoaded(t,n){var a;const{currentTrackId:o,levels:u}=this,{details:c,id:p}=n;if(!u){this.warn(`Subtitle tracks were reset while loading level ${p}`);return}const g=u[o];if(p>=u.length||p!==o||!g)return;this.log(`Subtitle track ${p} loaded [${c.startSN},${c.endSN}]${c.lastPartSn?`[part-${c.lastPartSn}-${c.lastPartIndex}]`:""},duration:${c.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let A=0;if(c.live||(a=g.details)!=null&&a.live){const w=this.mainDetails;if(c.deltaUpdateFailed||!w)return;const M=w.fragments[0];if(!g.details)c.hasProgramDateTime&&w.hasProgramDateTime?(_s(c,w),A=c.fragments[0].start):M&&(A=M.start,Fs(c,A));else{var _;A=this.alignPlaylists(c,g.details,(_=this.levelLastLoaded)==null?void 0:_.details),A===0&&M&&(A=M.start,Fs(c,A))}}g.details=c,this.levelLastLoaded=g,!this.startFragRequested&&(this.mainDetails||!c.live)&&this.setStartPosition(this.mainDetails||c,A),this.tick(),c.live&&!this.fragCurrent&&this.media&&this.state===ot.IDLE&&(fa(null,c.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),g.details=void 0))}_handleFragmentLoadComplete(t){const{frag:n,payload:a}=t,o=n.decryptdata,u=this.hls;if(!this.fragContextChanged(n)&&a&&a.byteLength>0&&o!=null&&o.key&&o.iv&&o.method==="AES-128"){const c=performance.now();this.decrypter.decrypt(new Uint8Array(a),o.key.buffer,o.iv.buffer).catch(p=>{throw u.trigger(v.ERROR,{type:$.MEDIA_ERROR,details:I.FRAG_DECRYPT_ERROR,fatal:!1,error:p,reason:p.message,frag:n}),p}).then(p=>{const g=performance.now();u.trigger(v.FRAG_DECRYPTED,{frag:n,payload:p,stats:{tstart:c,tdecrypt:g}})}).catch(p=>{this.warn(`${p.name}: ${p.message}`),this.state=ot.IDLE})}}doTick(){if(!this.media){this.state=ot.IDLE;return}if(this.state===ot.IDLE){const{currentTrackId:t,levels:n}=this,a=n==null?void 0:n[t];if(!a||!n.length||!a.details)return;const{config:o}=this,u=this.getLoadPosition(),c=_i.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],u,o.maxBufferHole),{end:p,len:g}=c,A=this.getFwdBufferInfo(this.media,Wt.MAIN),_=a.details,w=this.getMaxBufferLength(A==null?void 0:A.len)+_.levelTargetDuration;if(g>w)return;const M=_.fragments,z=M.length,K=_.edge;let Z=null;const ne=this.fragPrevious;if(p<K){const xe=o.maxFragLookUpTolerance,de=p>K-xe?0:xe;Z=fa(ne,M,Math.max(M[0].start,p),de),!Z&&ne&&ne.start<M[0].start&&(Z=M[0])}else Z=M[z-1];if(!Z)return;if(Z=this.mapToInitFragWhenRequired(Z),Z.sn!=="initSegment"){const xe=Z.sn-_.startSN,de=M[xe-1];de&&de.cc===Z.cc&&this.fragmentTracker.getState(de)===Ui.NOT_LOADED&&(Z=de)}this.fragmentTracker.getState(Z)===Ui.NOT_LOADED&&this.loadFragment(Z,a,p)}}getMaxBufferLength(t){const n=super.getMaxBufferLength();return t?Math.max(n,t):n}loadFragment(t,n,a){this.fragCurrent=t,t.sn==="initSegment"?this._loadInitSegment(t,n):(this.startFragRequested=!0,super.loadFragment(t,n,a))}get mediaBufferTimeRanges(){return new Gr(this.tracksBuffered[this.currentTrackId]||[])}}class Gr{constructor(t){this.buffered=void 0;const n=(a,o,u)=>{if(o=o>>>0,o>u-1)throw new DOMException(`Failed to execute '${a}' on 'TimeRanges': The index provided (${o}) is greater than the maximum bound (${u})`);return t[o][a]};this.buffered={get length(){return t.length},end(a){return n("end",a,t.length)},start(a){return n("start",a,t.length)}}}}class zl extends Ka{constructor(t){super(t,"[subtitle-track-controller]");this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let n=null;const a=Na(this.media.textTracks);for(let u=0;u<a.length;u++)if(a[u].mode==="hidden")n=a[u];else if(a[u].mode==="showing"){n=a[u];break}const o=this.findTrackForTextTrack(n);this.subtitleTrack!==o&&this.setSubtitleTrack(o)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(t){this._subtitleDisplay=t,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:t}=this;t.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.MANIFEST_PARSED,this.onManifestParsed,this),t.on(v.LEVEL_LOADING,this.onLevelLoading,this),t.on(v.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(v.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(v.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.MANIFEST_PARSED,this.onManifestParsed,this),t.off(v.LEVEL_LOADING,this.onLevelLoading,this),t.off(v.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(v.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(v.ERROR,this.onError,this)}onMediaAttached(t,n){this.media=n.media,!!this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(t){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,t)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),Na(this.media.textTracks).forEach(n=>{ms(n)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(t,n){this.tracks=n.subtitleTracks}onSubtitleTrackLoaded(t,n){const{id:a,groupId:o,details:u}=n,c=this.tracksInGroup[a];if(!c||c.groupId!==o){this.warn(`Subtitle track with id:${a} and group:${o} not found in active group ${c==null?void 0:c.groupId}`);return}const p=c.details;c.details=n.details,this.log(`Subtitle track ${a} "${c.name}" lang:${c.lang} group:${o} loaded [${u.startSN}-${u.endSN}]`),a===this.trackId&&this.playlistLoaded(a,n,p)}onLevelLoading(t,n){this.switchLevel(n.level)}onLevelSwitching(t,n){this.switchLevel(n.level)}switchLevel(t){const n=this.hls.levels[t];if(!n)return;const a=n.subtitleGroups||null,o=this.groupIds;let u=this.currentTrack;if(!a||(o==null?void 0:o.length)!==(a==null?void 0:a.length)||a!=null&&a.some(c=>(o==null?void 0:o.indexOf(c))===-1)){this.groupIds=a,this.trackId=-1,this.currentTrack=null;const c=this.tracks.filter(_=>!a||a.indexOf(_.groupId)!==-1);if(c.length)this.selectDefaultTrack&&!c.some(_=>_.default)&&(this.selectDefaultTrack=!1),c.forEach((_,w)=>{_.id=w});else if(!u&&!this.tracksInGroup.length)return;this.tracksInGroup=c;const p=this.hls.config.subtitlePreference;if(!u&&p){this.selectDefaultTrack=!1;const _=Li(p,c);if(_>-1)u=c[_];else{const w=Li(p,this.tracks);u=this.tracks[w]}}let g=this.findTrackId(u);g===-1&&u&&(g=this.findTrackId(null));const A={subtitleTracks:c};this.log(`Updating subtitle tracks, ${c.length} track(s) found in "${a==null?void 0:a.join(",")}" group-id`),this.hls.trigger(v.SUBTITLE_TRACKS_UPDATED,A),g!==-1&&this.trackId===-1&&this.setSubtitleTrack(g)}else this.shouldReloadPlaylist(u)&&this.setSubtitleTrack(this.trackId)}findTrackId(t){const n=this.tracksInGroup,a=this.selectDefaultTrack;for(let o=0;o<n.length;o++){const u=n[o];if(!(a&&!u.default||!a&&!t)&&(!t||ys(u,t)))return o}if(t){for(let o=0;o<n.length;o++){const u=n[o];if(zs(t.attrs,u.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return o}for(let o=0;o<n.length;o++){const u=n[o];if(zs(t.attrs,u.attrs,["LANGUAGE"]))return o}}return-1}findTrackForTextTrack(t){if(t){const n=this.tracksInGroup;for(let a=0;a<n.length;a++){const o=n[a];if(Qo(o,t))return a}}return-1}onError(t,n){n.fatal||!n.context||n.context.type===di.SUBTITLE_TRACK&&n.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(n.context.groupId)!==-1)&&this.checkRetry(n)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(t){this.selectDefaultTrack=!1,this.setSubtitleTrack(t)}setSubtitleOption(t){if(this.hls.config.subtitlePreference=t,t){const n=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,n.length){const a=this.currentTrack;if(a&&ys(t,a))return a;const o=Li(t,this.tracksInGroup);if(o>-1){const u=this.tracksInGroup[o];return this.setSubtitleTrack(o),u}else{if(a)return null;{const u=Li(t,n);if(u>-1)return n[u]}}}}return null}loadPlaylist(t){super.loadPlaylist();const n=this.currentTrack;if(this.shouldLoadPlaylist(n)&&n){const a=n.id,o=n.groupId;let u=n.url;if(t)try{u=t.addDirectives(u)}catch(c){this.warn(`Could not construct new URL with HLS Delivery Directives: ${c}`)}this.log(`Loading subtitle playlist for id ${a}`),this.hls.trigger(v.SUBTITLE_TRACK_LOADING,{url:u,id:a,groupId:o,deliveryDirectives:t||null})}}toggleTrackModes(){const{media:t}=this;if(!t)return;const n=Na(t.textTracks),a=this.currentTrack;let o;if(a&&(o=n.filter(u=>Qo(a,u))[0],o||this.warn(`Unable to find subtitle TextTrack with name "${a.name}" and language "${a.lang}"`)),[].slice.call(n).forEach(u=>{u.mode!=="disabled"&&u!==o&&(u.mode="disabled")}),o){const u=this.subtitleDisplay?"showing":"hidden";o.mode!==u&&(o.mode=u)}}setSubtitleTrack(t){const n=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=t;return}if(t<-1||t>=n.length||!ie(t)){this.warn(`Invalid subtitle track id: ${t}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const a=this.currentTrack,o=n[t]||null;if(this.trackId=t,this.currentTrack=o,this.toggleTrackModes(),!o){this.hls.trigger(v.SUBTITLE_TRACK_SWITCH,{id:t});return}const u=!!o.details&&!o.details.live;if(t===this.trackId&&o===a&&u)return;this.log(`Switching to subtitle-track ${t}`+(o?` "${o.name}" lang:${o.lang} group:${o.groupId}`:""));const{id:c,groupId:p="",name:g,type:A,url:_}=o;this.hls.trigger(v.SUBTITLE_TRACK_SWITCH,{id:c,groupId:p,name:g,type:A,url:_});const w=this.switchParams(o.url,a==null?void 0:a.details);this.loadPlaylist(w)}}class Gh{constructor(t){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=t}append(t,n,a){const o=this.queues[n];o.push(t),o.length===1&&!a&&this.executeNext(n)}insertAbort(t,n){this.queues[n].unshift(t),this.executeNext(n)}appendBlocker(t){let n;const a=new Promise(u=>{n=u}),o={execute:n,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(o,t),a}executeNext(t){const n=this.queues[t];if(n.length){const a=n[0];try{a.execute()}catch(o){S.warn(`[buffer-operation-queue]: Exception executing "${t}" SourceBuffer operation: ${o}`),a.onError(o);const u=this.buffers[t];u!=null&&u.updating||this.shiftAndExecuteNext(t)}}}shiftAndExecuteNext(t){this.queues[t].shift(),this.executeNext(t)}current(t){return this.queues[t][0]}}const kc=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/;class ud{constructor(t){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendSource=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this.log=void 0,this.warn=void 0,this.error=void 0,this._onEndStreaming=a=>{!this.hls||this.hls.pauseBuffering()},this._onStartStreaming=a=>{!this.hls||this.hls.resumeBuffering()},this._onMediaSourceOpen=()=>{const{media:a,mediaSource:o}=this;this.log("Media source opened"),a&&(a.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(v.MEDIA_ATTACHED,{media:a,mediaSource:o})),o&&o.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:a,_objectUrl:o}=this;a!==o&&S.error(`Media element src was set while attaching MediaSource (${o} > ${a})`)},this.hls=t;const n="[buffer-controller]";this.appendSource=t.config.preferManagedMediaSource&&typeof self!="undefined"&&self.ManagedMediaSource,this.log=S.log.bind(S,n),this.warn=S.warn.bind(S,n),this.error=S.error.bind(S,n),this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null,this.hls=null}registerListeners(){const{hls:t}=this;t.on(v.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.MANIFEST_PARSED,this.onManifestParsed,this),t.on(v.BUFFER_RESET,this.onBufferReset,this),t.on(v.BUFFER_APPENDING,this.onBufferAppending,this),t.on(v.BUFFER_CODECS,this.onBufferCodecs,this),t.on(v.BUFFER_EOS,this.onBufferEos,this),t.on(v.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(v.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(v.FRAG_PARSED,this.onFragParsed,this),t.on(v.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:t}=this;t.off(v.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.MANIFEST_PARSED,this.onManifestParsed,this),t.off(v.BUFFER_RESET,this.onBufferReset,this),t.off(v.BUFFER_APPENDING,this.onBufferAppending,this),t.off(v.BUFFER_CODECS,this.onBufferCodecs,this),t.off(v.BUFFER_EOS,this.onBufferEos,this),t.off(v.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(v.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(v.FRAG_PARSED,this.onFragParsed,this),t.off(v.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new Gh(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.appendErrors={audio:0,video:0,audiovideo:0},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(t,n){let a=2;(n.audio&&!n.video||!n.altAudio)&&(a=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=a,this.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(t,n){const a=this.media=n.media,o=fr(this.appendSource);if(a&&o){var u;const c=this.mediaSource=new o;this.log(`created media source: ${(u=c.constructor)==null?void 0:u.name}`),c.addEventListener("sourceopen",this._onMediaSourceOpen),c.addEventListener("sourceended",this._onMediaSourceEnded),c.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(c.addEventListener("startstreaming",this._onStartStreaming),c.addEventListener("endstreaming",this._onEndStreaming));const p=this._objectUrl=self.URL.createObjectURL(c);if(this.appendSource)try{a.removeAttribute("src");const g=self.ManagedMediaSource;a.disableRemotePlayback=a.disableRemotePlayback||g&&c instanceof g,Jo(a),Ta(a,p),a.load()}catch(g){a.src=p}else a.src=p;a.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:t,mediaSource:n,_objectUrl:a}=this;if(n){if(this.log("media source detaching"),n.readyState==="open")try{n.endOfStream()}catch(o){this.warn(`onMediaDetaching: ${o.message} while calling endOfStream`)}this.onBufferReset(),n.removeEventListener("sourceopen",this._onMediaSourceOpen),n.removeEventListener("sourceended",this._onMediaSourceEnded),n.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(n.removeEventListener("startstreaming",this._onStartStreaming),n.removeEventListener("endstreaming",this._onEndStreaming)),t&&(t.removeEventListener("emptied",this._onMediaEmptied),a&&self.URL.revokeObjectURL(a),this.mediaSrc===a?(t.removeAttribute("src"),this.appendSource&&Jo(t),t.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(v.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(t=>{this.resetBuffer(t)}),this._initSourceBuffer()}resetBuffer(t){const n=this.sourceBuffer[t];try{if(n){var a;this.removeBufferListeners(t),this.sourceBuffer[t]=void 0,(a=this.mediaSource)!=null&&a.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(n)}}catch(o){this.warn(`onBufferReset ${t}`,o)}}onBufferCodecs(t,n){const a=this.getSourceBufferTypes().length,o=Object.keys(n);if(o.forEach(c=>{if(a){const g=this.tracks[c];if(g&&typeof g.buffer.changeType=="function"){var p;const{id:A,codec:_,levelCodec:w,container:M,metadata:z}=n[c],K=oa(g.codec,g.levelCodec),Z=K==null?void 0:K.replace(kc,"$1");let ne=oa(_,w);const xe=(p=ne)==null?void 0:p.replace(kc,"$1");if(ne&&Z!==xe){c.slice(0,5)==="audio"&&(ne=Ir(ne,this.appendSource));const de=`${M};codecs=${ne}`;this.appendChangeType(c,de),this.log(`switching codec ${K} to ${ne}`),this.tracks[c]={buffer:g.buffer,codec:_,container:M,levelCodec:w,metadata:z,id:A}}}}else this.pendingTracks[c]=n[c]}),a)return;const u=Math.max(this.bufferCodecEventsExpected-1,0);this.bufferCodecEventsExpected!==u&&(this.log(`${u} bufferCodec event(s) expected ${o.join(",")}`),this.bufferCodecEventsExpected=u),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks()}appendChangeType(t,n){const{operationQueue:a}=this,o={execute:()=>{const u=this.sourceBuffer[t];u&&(this.log(`changing ${t} sourceBuffer type to ${n}`),u.changeType(n)),a.shiftAndExecuteNext(t)},onStart:()=>{},onComplete:()=>{},onError:u=>{this.warn(`Failed to change ${t} SourceBuffer type`,u)}};a.append(o,t,!!this.pendingTracks[t])}onBufferAppending(t,n){const{hls:a,operationQueue:o,tracks:u}=this,{data:c,type:p,frag:g,part:A,chunkMeta:_}=n,w=_.buffering[p],M=self.performance.now();w.start=M;const z=g.stats.buffering,K=A?A.stats.buffering:null;z.start===0&&(z.start=M),K&&K.start===0&&(K.start=M);const Z=u.audio;let ne=!1;p==="audio"&&(Z==null?void 0:Z.container)==="audio/mpeg"&&(ne=!this.lastMpegAudioChunk||_.id===1||this.lastMpegAudioChunk.sn!==_.sn,this.lastMpegAudioChunk=_);const xe=g.start,de={execute:()=>{if(w.executeStart=self.performance.now(),ne){const Be=this.sourceBuffer[p];if(Be){const Qe=xe-Be.timestampOffset;Math.abs(Qe)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${xe} (delta: ${Qe}) sn: ${g.sn})`),Be.timestampOffset=xe)}}this.appendExecutor(c,p)},onStart:()=>{},onComplete:()=>{const Be=self.performance.now();w.executeEnd=w.end=Be,z.first===0&&(z.first=Be),K&&K.first===0&&(K.first=Be);const{sourceBuffer:Qe}=this,Ne={};for(const lt in Qe)Ne[lt]=_i.getBuffered(Qe[lt]);this.appendErrors[p]=0,p==="audio"||p==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(v.BUFFER_APPENDED,{type:p,frag:g,part:A,chunkMeta:_,parent:g.type,timeRanges:Ne})},onError:Be=>{const Qe={type:$.MEDIA_ERROR,parent:g.type,details:I.BUFFER_APPEND_ERROR,sourceBufferName:p,frag:g,part:A,chunkMeta:_,error:Be,err:Be,fatal:!1};if(Be.code===DOMException.QUOTA_EXCEEDED_ERR)Qe.details=I.BUFFER_FULL_ERROR;else{const Ne=++this.appendErrors[p];Qe.details=I.BUFFER_APPEND_ERROR,this.warn(`Failed ${Ne}/${a.config.appendErrorMaxRetry} times to append segment in "${p}" sourceBuffer`),Ne>=a.config.appendErrorMaxRetry&&(Qe.fatal=!0)}a.trigger(v.ERROR,Qe)}};o.append(de,p,!!this.pendingTracks[p])}onBufferFlushing(t,n){const{operationQueue:a}=this,o=u=>({execute:this.removeExecutor.bind(this,u,n.startOffset,n.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(v.BUFFER_FLUSHED,{type:u})},onError:c=>{this.warn(`Failed to remove from ${u} SourceBuffer`,c)}});n.type?a.append(o(n.type),n.type):this.getSourceBufferTypes().forEach(u=>{a.append(o(u),u)})}onFragParsed(t,n){const{frag:a,part:o}=n,u=[],c=o?o.elementaryStreams:a.elementaryStreams;c[Ae.AUDIOVIDEO]?u.push("audiovideo"):(c[Ae.AUDIO]&&u.push("audio"),c[Ae.VIDEO]&&u.push("video"));const p=()=>{const g=self.performance.now();a.stats.buffering.end=g,o&&(o.stats.buffering.end=g);const A=o?o.stats:a.stats;this.hls.trigger(v.FRAG_BUFFERED,{frag:a,part:o,stats:A,id:a.type})};u.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${a.type} level: ${a.level} sn: ${a.sn}`),this.blockBuffers(p,u)}onFragChanged(t,n){this.trimBuffers()}onBufferEos(t,n){this.getSourceBufferTypes().reduce((o,u)=>{const c=this.sourceBuffer[u];return c&&(!n.type||n.type===u)&&(c.ending=!0,c.ended||(c.ended=!0,this.log(`${u} sourceBuffer now EOS`))),o&&!!(!c||c.ended)},!0)&&(this.log("Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(u=>{const c=this.sourceBuffer[u];c&&(c.ending=!1)});const{mediaSource:o}=this;if(!o||o.readyState!=="open"){o&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${o.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),o.endOfStream()}))}onLevelUpdated(t,{details:n}){!n.fragments.length||(this.details=n,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}trimBuffers(){const{hls:t,details:n,media:a}=this;if(!a||n===null||!this.getSourceBufferTypes().length)return;const u=t.config,c=a.currentTime,p=n.levelTargetDuration,g=n.live&&u.liveBackBufferLength!==null?u.liveBackBufferLength:u.backBufferLength;if(ie(g)&&g>0){const A=Math.max(g,p),_=Math.floor(c/p)*p-A;this.flushBackBuffer(c,p,_)}if(ie(u.frontBufferFlushThreshold)&&u.frontBufferFlushThreshold>0){const A=Math.max(u.maxBufferLength,u.frontBufferFlushThreshold),_=Math.max(A,p),w=Math.floor(c/p)*p+_;this.flushFrontBuffer(c,p,w)}}flushBackBuffer(t,n,a){const{details:o,sourceBuffer:u}=this;this.getSourceBufferTypes().forEach(p=>{const g=u[p];if(g){const A=_i.getBuffered(g);if(A.length>0&&a>A.start(0)){if(this.hls.trigger(v.BACK_BUFFER_REACHED,{bufferEnd:a}),o!=null&&o.live)this.hls.trigger(v.LIVE_BACK_BUFFER_REACHED,{bufferEnd:a});else if(g.ended&&A.end(A.length-1)-t<n*2){this.log(`Cannot flush ${p} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(v.BUFFER_FLUSHING,{startOffset:0,endOffset:a,type:p})}}})}flushFrontBuffer(t,n,a){const{sourceBuffer:o}=this;this.getSourceBufferTypes().forEach(c=>{const p=o[c];if(p){const g=_i.getBuffered(p),A=g.length;if(A<2)return;const _=g.start(A-1),w=g.end(A-1);if(a>_||t>=_&&t<=w)return;if(p.ended&&t-w<2*n){this.log(`Cannot flush ${c} front buffer while SourceBuffer is in ended state`);return}this.hls.trigger(v.BUFFER_FLUSHING,{startOffset:_,endOffset:Infinity,type:c})}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")return;const{details:t,hls:n,media:a,mediaSource:o}=this,u=t.fragments[0].start+t.totalduration,c=a.duration,p=ie(o.duration)?o.duration:0;t.live&&n.config.liveDurationInfinity?(o.duration=Infinity,this.updateSeekableRange(t)):(u>p&&u>c||!ie(c))&&(this.log(`Updating Media Source duration to ${u.toFixed(3)}`),o.duration=u)}updateSeekableRange(t){const n=this.mediaSource,a=t.fragments;if(a.length&&t.live&&n!=null&&n.setLiveSeekableRange){const u=Math.max(0,a[0].start),c=Math.max(u,u+t.totalduration);this.log(`Media Source duration is set to ${n.duration}. Setting seekable range to ${u}-${c}.`),n.setLiveSeekableRange(u,c)}}checkPendingTracks(){const{bufferCodecEventsExpected:t,operationQueue:n,pendingTracks:a}=this,o=Object.keys(a).length;if(o&&(!t||o===2||"audiovideo"in a)){this.createSourceBuffers(a),this.pendingTracks={};const u=this.getSourceBufferTypes();if(u.length)this.hls.trigger(v.BUFFER_CREATED,{tracks:this.tracks}),u.forEach(c=>{n.executeNext(c)});else{const c=new Error("could not create source buffer for media codec(s)");this.hls.trigger(v.ERROR,{type:$.MEDIA_ERROR,details:I.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:c,reason:c.message})}}}createSourceBuffers(t){const{sourceBuffer:n,mediaSource:a}=this;if(!a)throw Error("createSourceBuffers called when mediaSource was null");for(const o in t)if(!n[o]){const u=t[o];if(!u)throw Error(`source buffer exists for track ${o}, however track does not`);let c=u.levelCodec||u.codec;c&&o.slice(0,5)==="audio"&&(c=Ir(c,this.appendSource));const p=`${u.container};codecs=${c}`;this.log(`creating sourceBuffer(${p})`);try{const g=n[o]=a.addSourceBuffer(p),A=o;this.addBufferListener(A,"updatestart",this._onSBUpdateStart),this.addBufferListener(A,"updateend",this._onSBUpdateEnd),this.addBufferListener(A,"error",this._onSBUpdateError),this.appendSource&&this.addBufferListener(A,"bufferedchange",(_,w)=>{const M=w.removedRanges;M!=null&&M.length&&this.hls.trigger(v.BUFFER_FLUSHED,{type:o})}),this.tracks[o]={buffer:g,codec:c,container:u.container,levelCodec:u.levelCodec,metadata:u.metadata,id:u.id}}catch(g){this.error(`error while trying to add sourceBuffer: ${g.message}`),this.hls.trigger(v.ERROR,{type:$.MEDIA_ERROR,details:I.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:g,sourceBufferName:o,mimeType:p})}}}get mediaSrc(){var t;const n=((t=this.media)==null?void 0:t.firstChild)||this.media;return n==null?void 0:n.src}_onSBUpdateStart(t){const{operationQueue:n}=this;n.current(t).onStart()}_onSBUpdateEnd(t){var n;if(((n=this.mediaSource)==null?void 0:n.readyState)==="closed"){this.resetBuffer(t);return}const{operationQueue:a}=this;a.current(t).onComplete(),a.shiftAndExecuteNext(t)}_onSBUpdateError(t,n){var a;const o=new Error(`${t} SourceBuffer error. MediaSource readyState: ${(a=this.mediaSource)==null?void 0:a.readyState}`);this.error(`${o}`,n),this.hls.trigger(v.ERROR,{type:$.MEDIA_ERROR,details:I.BUFFER_APPENDING_ERROR,sourceBufferName:t,error:o,fatal:!1});const u=this.operationQueue.current(t);u&&u.onError(o)}removeExecutor(t,n,a){const{media:o,mediaSource:u,operationQueue:c,sourceBuffer:p}=this,g=p[t];if(!o||!u||!g){this.warn(`Attempting to remove from the ${t} SourceBuffer, but it does not exist`),c.shiftAndExecuteNext(t);return}const A=ie(o.duration)?o.duration:Infinity,_=ie(u.duration)?u.duration:Infinity,w=Math.max(0,n),M=Math.min(a,A,_);M>w&&(!g.ending||g.ended)?(g.ended=!1,this.log(`Removing [${w},${M}] from the ${t} SourceBuffer`),g.remove(w,M)):c.shiftAndExecuteNext(t)}appendExecutor(t,n){const a=this.sourceBuffer[n];if(!a){if(!this.pendingTracks[n])throw new Error(`Attempting to append to the ${n} SourceBuffer, but it does not exist`);return}a.ended=!1,a.appendBuffer(t)}blockBuffers(t,n=this.getSourceBufferTypes()){if(!n.length){this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(t);return}const{operationQueue:a}=this,o=n.map(u=>a.appendBlocker(u));Promise.all(o).then(()=>{t(),n.forEach(u=>{const c=this.sourceBuffer[u];c!=null&&c.updating||a.shiftAndExecuteNext(u)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(t,n,a){const o=this.sourceBuffer[t];if(!o)return;const u=a.bind(this,t);this.listeners[t].push({event:n,listener:u}),o.addEventListener(n,u)}removeBufferListeners(t){const n=this.sourceBuffer[t];!n||this.listeners[t].forEach(a=>{n.removeEventListener(a.event,a.listener)})}}function Jo(h){const t=h.querySelectorAll("source");[].slice.call(t).forEach(n=>{h.removeChild(n)})}function Ta(h,t){const n=self.document.createElement("source");n.type="video/mp4",n.src=t,h.appendChild(n)}const Ys={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Zo=function(t){let n=t;return Ys.hasOwnProperty(t)&&(n=Ys[t]),String.fromCharCode(n)},xr=15,Er=100,Ic={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},dd={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Rc={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},el={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Pc=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class Oc{constructor(){this.time=null,this.verboseLevel=0}log(t,n){if(this.verboseLevel>=t){const a=typeof n=="function"?n():n;S.log(`${this.time} [${t}] ${a}`)}}}const Xs=function(t){const n=[];for(let a=0;a<t.length;a++)n.push(t[a].toString(16));return n};class Yl{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(t){const n=["foreground","underline","italics","background","flash"];for(let a=0;a<n.length;a++){const o=n[a];t.hasOwnProperty(o)&&(this[o]=t[o])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash}copy(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class Xl{constructor(){this.uchar=" ",this.penState=new Yl}reset(){this.uchar=" ",this.penState.reset()}setChar(t,n){this.uchar=t,this.penState.copy(n)}setPenState(t){this.penState.copy(t)}equals(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)}copy(t){this.uchar=t.uchar,this.penState.copy(t.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class Ql{constructor(t){this.chars=[],this.pos=0,this.currPenState=new Yl,this.cueStartTime=null,this.logger=void 0;for(let n=0;n<Er;n++)this.chars.push(new Xl);this.logger=t}equals(t){for(let n=0;n<Er;n++)if(!this.chars[n].equals(t.chars[n]))return!1;return!0}copy(t){for(let n=0;n<Er;n++)this.chars[n].copy(t.chars[n])}isEmpty(){let t=!0;for(let n=0;n<Er;n++)if(!this.chars[n].isEmpty()){t=!1;break}return t}setCursor(t){this.pos!==t&&(this.pos=t),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Er&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Er)}moveCursor(t){const n=this.pos+t;if(t>1)for(let a=this.pos+1;a<n+1;a++)this.chars[a].setPenState(this.currPenState);this.setCursor(n)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(t){t>=144&&this.backSpace();const n=Zo(t);if(this.pos>=Er){this.logger.log(0,()=>"Cannot insert "+t.toString(16)+" ("+n+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(n,this.currPenState),this.moveCursor(1)}clearFromPos(t){let n;for(n=t;n<Er;n++)this.chars[n].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const t=[];let n=!0;for(let a=0;a<Er;a++){const o=this.chars[a].uchar;o!==" "&&(n=!1),t.push(o)}return n?"":t.join("")}setPenStyles(t){this.currPenState.setStyles(t),this.chars[this.pos].setPenState(this.currPenState)}}class tl{constructor(t){this.rows=[],this.currRow=xr-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let n=0;n<xr;n++)this.rows.push(new Ql(t));this.logger=t}reset(){for(let t=0;t<xr;t++)this.rows[t].clear();this.currRow=xr-1}equals(t){let n=!0;for(let a=0;a<xr;a++)if(!this.rows[a].equals(t.rows[a])){n=!1;break}return n}copy(t){for(let n=0;n<xr;n++)this.rows[n].copy(t.rows[n])}isEmpty(){let t=!0;for(let n=0;n<xr;n++)if(!this.rows[n].isEmpty()){t=!1;break}return t}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(t){this.rows[this.currRow].insertChar(t)}setPen(t){this.rows[this.currRow].setPenStyles(t)}moveCursor(t){this.rows[this.currRow].moveCursor(t)}setCursor(t){this.logger.log(2,"setCursor: "+t),this.rows[this.currRow].setCursor(t)}setPAC(t){this.logger.log(2,()=>"pacData = "+JSON.stringify(t));let n=t.row-1;if(this.nrRollUpRows&&n<this.nrRollUpRows-1&&(n=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==n){for(let p=0;p<xr;p++)this.rows[p].clear();const u=this.currRow+1-this.nrRollUpRows,c=this.lastOutputScreen;if(c){const p=c.rows[u].cueStartTime,g=this.logger.time;if(p!==null&&g!==null&&p<g)for(let A=0;A<this.nrRollUpRows;A++)this.rows[n-this.nrRollUpRows+A+1].copy(c.rows[u+A])}}this.currRow=n;const a=this.rows[this.currRow];if(t.indent!==null){const u=t.indent,c=Math.max(u-1,0);a.setCursor(t.indent),t.color=a.chars[c].penState.foreground}const o={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1};this.setPen(o)}setBkgData(t){this.logger.log(2,()=>"bkgData = "+JSON.stringify(t)),this.backSpace(),this.setPen(t),this.insertChar(32)}setRollUpRows(t){this.nrRollUpRows=t}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const t=this.currRow+1-this.nrRollUpRows,n=this.rows.splice(t,1)[0];n.clear(),this.rows.splice(this.currRow,0,n),this.logger.log(2,"Rolling up")}getDisplayText(t){t=t||!1;const n=[];let a="",o=-1;for(let u=0;u<xr;u++){const c=this.rows[u].getTextString();c&&(o=u+1,t?n.push("Row "+o+": '"+c+"'"):n.push(c.trim()))}return n.length>0&&(t?a="["+n.join(" | ")+"]":a=n.join(`
`)),a}getTextAndFormat(){return this.rows}}class il{constructor(t,n,a){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=t,this.outputFilter=n,this.mode=null,this.verbose=0,this.displayedMemory=new tl(a),this.nonDisplayedMemory=new tl(a),this.lastOutputScreen=new tl(a),this.currRollUpRow=this.displayedMemory.rows[xr-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=a}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[xr-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(t){this.outputFilter=t}setPAC(t){this.writeScreen.setPAC(t)}setBkgData(t){this.writeScreen.setBkgData(t)}setMode(t){t!==this.mode&&(this.mode=t,this.logger.log(2,()=>"MODE="+t),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)}insertChars(t){for(let a=0;a<t.length;a++)this.writeScreen.insertChar(t[a]);const n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>n+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(t){this.logger.log(2,"RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(t){this.logger.log(2,"TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)}ccMIDROW(t){const n={flash:!1};if(n.underline=t%2==1,n.italics=t>=46,n.italics)n.foreground="white";else{const a=Math.floor(t/2)-16,o=["white","green","blue","cyan","red","yellow","magenta"];n.foreground=o[a]}this.logger.log(2,"MIDROW: "+JSON.stringify(n)),this.writeScreen.setPen(n)}outputDataUpdate(t=!1){const n=this.logger.time;n!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=n:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,n,this.lastOutputScreen),t&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:n),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))}}class eo{constructor(t,n,a){this.channels=void 0,this.currentChannel=0,this.cmdHistory=Zl(),this.logger=void 0;const o=this.logger=new Oc;this.channels=[null,new il(t,n,o),new il(t+1,a,o)]}getHandler(t){return this.channels[t].getHandler()}setHandler(t,n){this.channels[t].setHandler(n)}addData(t,n){let a,o,u,c=!1;this.logger.time=t;for(let p=0;p<n.length;p+=2)if(o=n[p]&127,u=n[p+1]&127,!(o===0&&u===0)){if(this.logger.log(3,"["+Xs([n[p],n[p+1]])+"] -> ("+Xs([o,u])+")"),a=this.parseCmd(o,u),a||(a=this.parseMidrow(o,u)),a||(a=this.parsePAC(o,u)),a||(a=this.parseBackgroundAttributes(o,u)),!a&&(c=this.parseChars(o,u),c)){const g=this.currentChannel;g&&g>0?this.channels[g].insertChars(c):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!a&&!c&&this.logger.log(2,"Couldn't parse cleaned data "+Xs([o,u])+" orig: "+Xs([n[p],n[p+1]]))}}parseCmd(t,n){const{cmdHistory:a}=this,o=(t===20||t===28||t===21||t===29)&&n>=32&&n<=47,u=(t===23||t===31)&&n>=33&&n<=35;if(!(o||u))return!1;if(Jl(t,n,a))return Sa(null,null,a),this.logger.log(3,"Repeated command ("+Xs([t,n])+") is dropped"),!0;const c=t===20||t===21||t===23?1:2,p=this.channels[c];return t===20||t===21||t===28||t===29?n===32?p.ccRCL():n===33?p.ccBS():n===34?p.ccAOF():n===35?p.ccAON():n===36?p.ccDER():n===37?p.ccRU(2):n===38?p.ccRU(3):n===39?p.ccRU(4):n===40?p.ccFON():n===41?p.ccRDC():n===42?p.ccTR():n===43?p.ccRTD():n===44?p.ccEDM():n===45?p.ccCR():n===46?p.ccENM():n===47&&p.ccEOC():p.ccTO(n-32),Sa(t,n,a),this.currentChannel=c,!0}parseMidrow(t,n){let a=0;if((t===17||t===25)&&n>=32&&n<=47){if(t===17?a=1:a=2,a!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const o=this.channels[a];return o?(o.ccMIDROW(n),this.logger.log(3,"MIDROW ("+Xs([t,n])+")"),!0):!1}return!1}parsePAC(t,n){let a;const o=this.cmdHistory,u=(t>=17&&t<=23||t>=25&&t<=31)&&n>=64&&n<=127,c=(t===16||t===24)&&n>=64&&n<=95;if(!(u||c))return!1;if(Jl(t,n,o))return Sa(null,null,o),!0;const p=t<=23?1:2;n>=64&&n<=95?a=p===1?Ic[t]:Rc[t]:a=p===1?dd[t]:el[t];const g=this.channels[p];return g?(g.setPAC(this.interpretPAC(a,n)),Sa(t,n,o),this.currentChannel=p,!0):!1}interpretPAC(t,n){let a;const o={color:null,italics:!1,indent:null,underline:!1,row:t};return n>95?a=n-96:a=n-64,o.underline=(a&1)==1,a<=13?o.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(a/2)]:a<=15?(o.italics=!0,o.color="white"):o.indent=Math.floor((a-16)/2)*4,o}parseChars(t,n){let a,o=null,u=null;if(t>=25?(a=2,u=t-8):(a=1,u=t),u>=17&&u<=19){let c;u===17?c=n+80:u===18?c=n+112:c=n+144,this.logger.log(2,"Special char '"+Zo(c)+"' in channel "+a),o=[c]}else t>=32&&t<=127&&(o=n===0?[t]:[t,n]);if(o){const c=Xs(o);this.logger.log(3,"Char codes =  "+c.join(",")),Sa(t,n,this.cmdHistory)}return o}parseBackgroundAttributes(t,n){const a=(t===16||t===24)&&n>=32&&n<=47,o=(t===23||t===31)&&n>=45&&n<=47;if(!(a||o))return!1;let u;const c={};t===16||t===24?(u=Math.floor((n-32)/2),c.background=Pc[u],n%2==1&&(c.background=c.background+"_semi")):n===45?c.background="transparent":(c.foreground="black",n===47&&(c.underline=!0));const p=t<=23?1:2;return this.channels[p].setBkgData(c),Sa(t,n,this.cmdHistory),!0}reset(){for(let t=0;t<Object.keys(this.channels).length;t++){const n=this.channels[t];n&&n.reset()}this.cmdHistory=Zl()}cueSplitAtTime(t){for(let n=0;n<this.channels.length;n++){const a=this.channels[n];a&&a.cueSplitAtTime(t)}}}function Sa(h,t,n){n.a=h,n.b=t}function Jl(h,t,n){return n.a===h&&n.b===t}function Zl(){return{a:null,b:null}}class Es{constructor(t,n){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=t,this.trackName=n}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(t,n,a){(this.startTime===null||this.startTime>t)&&(this.startTime=t),this.endTime=n,this.screen=a,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var nl=function(){if(mt!=null&&mt.VTTCue)return self.VTTCue;const h=["","lr","rl"],t=["start","middle","end","left","right"];function n(p,g){if(typeof g!="string"||!Array.isArray(p))return!1;const A=g.toLowerCase();return~p.indexOf(A)?A:!1}function a(p){return n(h,p)}function o(p){return n(t,p)}function u(p,...g){let A=1;for(;A<arguments.length;A++){const _=arguments[A];for(const w in _)p[w]=_[w]}return p}function c(p,g,A){const _=this,w={enumerable:!0};_.hasBeenReset=!1;let M="",z=!1,K=p,Z=g,ne=A,xe=null,de="",Be=!0,Qe="auto",Ne="start",lt=50,Xe="middle",ct=50,Lt="middle";Object.defineProperty(_,"id",u({},w,{get:function(){return M},set:function(et){M=""+et}})),Object.defineProperty(_,"pauseOnExit",u({},w,{get:function(){return z},set:function(et){z=!!et}})),Object.defineProperty(_,"startTime",u({},w,{get:function(){return K},set:function(et){if(typeof et!="number")throw new TypeError("Start time must be set to a number.");K=et,this.hasBeenReset=!0}})),Object.defineProperty(_,"endTime",u({},w,{get:function(){return Z},set:function(et){if(typeof et!="number")throw new TypeError("End time must be set to a number.");Z=et,this.hasBeenReset=!0}})),Object.defineProperty(_,"text",u({},w,{get:function(){return ne},set:function(et){ne=""+et,this.hasBeenReset=!0}})),Object.defineProperty(_,"region",u({},w,{get:function(){return xe},set:function(et){xe=et,this.hasBeenReset=!0}})),Object.defineProperty(_,"vertical",u({},w,{get:function(){return de},set:function(et){const st=a(et);if(st===!1)throw new SyntaxError("An invalid or illegal string was specified.");de=st,this.hasBeenReset=!0}})),Object.defineProperty(_,"snapToLines",u({},w,{get:function(){return Be},set:function(et){Be=!!et,this.hasBeenReset=!0}})),Object.defineProperty(_,"line",u({},w,{get:function(){return Qe},set:function(et){if(typeof et!="number"&&et!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");Qe=et,this.hasBeenReset=!0}})),Object.defineProperty(_,"lineAlign",u({},w,{get:function(){return Ne},set:function(et){const st=o(et);if(!st)throw new SyntaxError("An invalid or illegal string was specified.");Ne=st,this.hasBeenReset=!0}})),Object.defineProperty(_,"position",u({},w,{get:function(){return lt},set:function(et){if(et<0||et>100)throw new Error("Position must be between 0 and 100.");lt=et,this.hasBeenReset=!0}})),Object.defineProperty(_,"positionAlign",u({},w,{get:function(){return Xe},set:function(et){const st=o(et);if(!st)throw new SyntaxError("An invalid or illegal string was specified.");Xe=st,this.hasBeenReset=!0}})),Object.defineProperty(_,"size",u({},w,{get:function(){return ct},set:function(et){if(et<0||et>100)throw new Error("Size must be between 0 and 100.");ct=et,this.hasBeenReset=!0}})),Object.defineProperty(_,"align",u({},w,{get:function(){return Lt},set:function(et){const st=o(et);if(!st)throw new SyntaxError("An invalid or illegal string was specified.");Lt=st,this.hasBeenReset=!0}})),_.displayState=void 0}return c.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},c}();class cd{decode(t,n){if(!t)return"";if(typeof t!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}function Hr(h){function t(a,o,u,c){return(a|0)*3600+(o|0)*60+(u|0)+parseFloat(c||0)}const n=h.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return n?parseFloat(n[2])>59?t(n[2],n[3],0,n[4]):t(n[1],n[2],n[3],n[4]):null}class sr{constructor(){this.values=Object.create(null)}set(t,n){!this.get(t)&&n!==""&&(this.values[t]=n)}get(t,n,a){return a?this.has(t)?this.values[t]:n[a]:this.has(t)?this.values[t]:n}has(t){return t in this.values}alt(t,n,a){for(let o=0;o<a.length;++o)if(n===a[o]){this.set(t,n);break}}integer(t,n){/^-?\d+$/.test(n)&&this.set(t,parseInt(n,10))}percent(t,n){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(n)){const a=parseFloat(n);if(a>=0&&a<=100)return this.set(t,a),!0}return!1}}function Qs(h,t,n,a){const o=a?h.split(a):[h];for(const u in o){if(typeof o[u]!="string")continue;const c=o[u].split(n);if(c.length!==2)continue;const p=c[0],g=c[1];t(p,g)}}const xn=new nl(0,0,""),rl=xn.align==="middle"?"middle":"center";function si(h,t,n){const a=h;function o(){const p=Hr(h);if(p===null)throw new Error("Malformed timestamp: "+a);return h=h.replace(/^[^\sa-zA-Z-]+/,""),p}function u(p,g){const A=new sr;Qs(p,function(M,z){let K;switch(M){case"region":for(let Z=n.length-1;Z>=0;Z--)if(n[Z].id===z){A.set(M,n[Z].region);break}break;case"vertical":A.alt(M,z,["rl","lr"]);break;case"line":K=z.split(","),A.integer(M,K[0]),A.percent(M,K[0])&&A.set("snapToLines",!1),A.alt(M,K[0],["auto"]),K.length===2&&A.alt("lineAlign",K[1],["start",rl,"end"]);break;case"position":K=z.split(","),A.percent(M,K[0]),K.length===2&&A.alt("positionAlign",K[1],["start",rl,"end","line-left","line-right","auto"]);break;case"size":A.percent(M,z);break;case"align":A.alt(M,z,["start",rl,"end","left","right"]);break}},/:/,/\s/),g.region=A.get("region",null),g.vertical=A.get("vertical","");let _=A.get("line","auto");_==="auto"&&xn.line===-1&&(_=-1),g.line=_,g.lineAlign=A.get("lineAlign","start"),g.snapToLines=A.get("snapToLines",!0),g.size=A.get("size",100),g.align=A.get("align",rl);let w=A.get("position","auto");w==="auto"&&xn.position===50&&(w=g.align==="start"||g.align==="left"?0:g.align==="end"||g.align==="right"?100:50),g.position=w}function c(){h=h.replace(/^\s+/,"")}if(c(),t.startTime=o(),c(),h.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+a);h=h.slice(3),c(),t.endTime=o(),c(),u(h,t)}function Ts(h){return h.replace(/<br(?: \/)?>/gi,`
`)}class eu{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new cd,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(t){const n=this;t&&(n.buffer+=n.decoder.decode(t,{stream:!0}));function a(){let u=n.buffer,c=0;for(u=Ts(u);c<u.length&&u[c]!=="\r"&&u[c]!==`
`;)++c;const p=u.slice(0,c);return u[c]==="\r"&&++c,u[c]===`
`&&++c,n.buffer=u.slice(c),p}function o(u){Qs(u,function(c,p){},/:/)}try{let u="";if(n.state==="INITIAL"){if(!/\r\n|\n/.test(n.buffer))return this;u=a();const p=u.match(/^()?WEBVTT([ \t].*)?$/);if(!(p!=null&&p[0]))throw new Error("Malformed WebVTT signature.");n.state="HEADER"}let c=!1;for(;n.buffer;){if(!/\r\n|\n/.test(n.buffer))return this;switch(c?c=!1:u=a(),n.state){case"HEADER":/:/.test(u)?o(u):u||(n.state="ID");continue;case"NOTE":u||(n.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(u)){n.state="NOTE";break}if(!u)continue;if(n.cue=new nl(0,0,""),n.state="CUE",u.indexOf("-->")===-1){n.cue.id=u;continue}case"CUE":if(!n.cue){n.state="BADCUE";continue}try{si(u,n.cue,n.regionList)}catch(p){n.cue=null,n.state="BADCUE";continue}n.state="CUETEXT";continue;case"CUETEXT":{const p=u.indexOf("-->")!==-1;if(!u||p&&(c=!0)){n.oncue&&n.cue&&n.oncue(n.cue),n.cue=null,n.state="ID";continue}if(n.cue===null)continue;n.cue.text&&(n.cue.text+=`
`),n.cue.text+=u}continue;case"BADCUE":u||(n.state="ID")}}}catch(u){n.state==="CUETEXT"&&n.cue&&n.oncue&&n.oncue(n.cue),n.cue=null,n.state=n.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const t=this;try{if((t.cue||t.state==="HEADER")&&(t.buffer+=`

`,t.parse()),t.state==="INITIAL"||t.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(n){t.onparsingerror&&t.onparsingerror(n)}return t.onflush&&t.onflush(),this}}const sl=/\r\n|\n\r|\n|\r/g,tu=function(t,n,a=0){return t.slice(a,a+n.length)===n},Bc=function(t){let n=parseInt(t.slice(-3));const a=parseInt(t.slice(-6,-4)),o=parseInt(t.slice(-9,-7)),u=t.length>9?parseInt(t.substring(0,t.indexOf(":"))):0;if(!ie(n)||!ie(a)||!ie(o)||!ie(u))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${t}`);return n+=1e3*a,n+=60*1e3*o,n+=60*60*1e3*u,n},iu=function(t){let n=5381,a=t.length;for(;a;)n=n*33^t.charCodeAt(--a);return(n>>>0).toString()};function nu(h,t,n){return iu(h.toString())+iu(t.toString())+iu(n)}const Mc=function(t,n,a){let o=t[n],u=t[o.prevCC];if(!u||!u.new&&o.new){t.ccOffset=t.presentationOffset=o.start,o.new=!1;return}for(;(c=u)!=null&&c.new;){var c;t.ccOffset+=o.start-u.start,o.new=!1,o=u,u=t[o.prevCC]}t.presentationOffset=a};function hd(h,t,n,a,o,u,c){const p=new eu,g=Ye(new Uint8Array(h)).trim().replace(sl,`
`).split(`
`),A=[],_=t?Vr(t.baseTime,t.timescale):0;let w="00:00.000",M=0,z=0,K,Z=!0;p.oncue=function(ne){const xe=n[a];let de=n.ccOffset;const Be=(M-_)/9e4;if(xe!=null&&xe.new&&(z!==void 0?de=n.ccOffset=xe.start:Mc(n,a,Be)),Be){if(!t){K=new Error("Missing initPTS for VTT MPEGTS");return}de=Be-n.presentationOffset}const Qe=ne.endTime-ne.startTime,Ne=Fn((ne.startTime+de-z)*9e4,o*9e4)/9e4;ne.startTime=Math.max(Ne,0),ne.endTime=Math.max(Ne+Qe,0);const lt=ne.text.trim();ne.text=decodeURIComponent(encodeURIComponent(lt)),ne.id||(ne.id=nu(ne.startTime,ne.endTime,lt)),ne.endTime>0&&A.push(ne)},p.onparsingerror=function(ne){K=ne},p.onflush=function(){if(K){c(K);return}u(A)},g.forEach(ne=>{if(Z)if(tu(ne,"X-TIMESTAMP-MAP=")){Z=!1,ne.slice(16).split(",").forEach(xe=>{tu(xe,"LOCAL:")?w=xe.slice(6):tu(xe,"MPEGTS:")&&(M=parseInt(xe.slice(7)))});try{z=Bc(w)/1e3}catch(xe){K=xe}return}else ne===""&&(Z=!1);p.parse(ne+`
`)}),p.flush()}const ru="stpp.ttml.im1t",fd=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,su=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,au={left:"start",center:"center",right:"end",start:"start",end:"end"};function pd(h,t,n,a){const o=Mt(new Uint8Array(h),["mdat"]);if(o.length===0){a(new Error("Could not parse IMSC1 mdat"));return}const u=o.map(p=>Ye(p)),c=nr(t.baseTime,1,t.timescale);try{u.forEach(p=>n(Fc(p,c)))}catch(p){a(p)}}function Fc(h,t){const o=new DOMParser().parseFromString(h,"text/xml").getElementsByTagName("tt")[0];if(!o)throw new Error("Invalid ttml");const u={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},c=Object.keys(u).reduce((w,M)=>(w[M]=o.getAttribute(`ttp:${M}`)||u[M],w),{}),p=o.getAttribute("xml:space")!=="preserve",g=Ss(ou(o,"styling","style")),A=Ss(ou(o,"layout","region")),_=ou(o,"body","[begin]");return[].map.call(_,w=>{const M=md(w,p);if(!M||!w.hasAttribute("begin"))return null;const z=ol(w.getAttribute("begin"),c),K=ol(w.getAttribute("dur"),c);let Z=ol(w.getAttribute("end"),c);if(z===null)throw uu(w);if(Z===null){if(K===null)throw uu(w);Z=z+K}const ne=new nl(z-t,Z-t,M);ne.id=nu(ne.startTime,ne.endTime,ne.text);const xe=A[w.getAttribute("region")],de=g[w.getAttribute("style")],Be=al(xe,de,g),{textAlign:Qe}=Be;if(Qe){const Ne=au[Qe];Ne&&(ne.lineAlign=Ne),ne.align=Qe}return re(ne,Be),ne}).filter(w=>w!==null)}function ou(h,t,n){const a=h.getElementsByTagName(t)[0];return a?[].slice.call(a.querySelectorAll(n)):[]}function Ss(h){return h.reduce((t,n)=>{const a=n.getAttribute("xml:id");return a&&(t[a]=n),t},{})}function md(h,t){return[].slice.call(h.childNodes).reduce((n,a,o)=>{var u;return a.nodeName==="br"&&o?n+`
`:(u=a.childNodes)!=null&&u.length?md(a,t):t?n+a.textContent.trim().replace(/\s+/g," "):n+a.textContent},"")}function al(h,t,n){const a="http://www.w3.org/ns/ttml#styling";let o=null;const u=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],c=h!=null&&h.hasAttribute("style")?h.getAttribute("style"):null;return c&&n.hasOwnProperty(c)&&(o=n[c]),u.reduce((p,g)=>{const A=lu(t,a,g)||lu(h,a,g)||lu(o,a,g);return A&&(p[g]=A),p},{})}function lu(h,t,n){return h&&h.hasAttributeNS(t,n)?h.getAttributeNS(t,n):null}function uu(h){return new Error(`Could not parse ttml timestamp ${h}`)}function ol(h,t){if(!h)return null;let n=Hr(h);return n===null&&(fd.test(h)?n=Nc(h,t):su.test(h)&&(n=Uc(h,t))),n}function Nc(h,t){const n=fd.exec(h),a=(n[4]|0)+(n[5]|0)/t.subFrameRate;return(n[1]|0)*3600+(n[2]|0)*60+(n[3]|0)+a/t.frameRate}function Uc(h,t){const n=su.exec(h),a=Number(n[1]);switch(n[2]){case"h":return a*3600;case"m":return a*60;case"ms":return a*1e3;case"f":return a/t.frameRate;case"t":return a/t.tickRate}return a}class ll{constructor(t){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=yd(),this.captionsProperties=void 0,this.hls=t,this.config=t.config,this.Cues=t.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},t.on(v.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(v.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(v.FRAG_LOADING,this.onFragLoading,this),t.on(v.FRAG_LOADED,this.onFragLoaded,this),t.on(v.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.on(v.FRAG_DECRYPTED,this.onFragDecrypted,this),t.on(v.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(v.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.on(v.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:t}=this;t.off(v.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(v.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(v.FRAG_LOADING,this.onFragLoading,this),t.off(v.FRAG_LOADED,this.onFragLoaded,this),t.off(v.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.off(v.FRAG_DECRYPTED,this.onFragDecrypted,this),t.off(v.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(v.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.off(v.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){if(this.config.enableCEA708Captions&&(!this.cea608Parser1||!this.cea608Parser2)){const t=new Es(this,"textTrack1"),n=new Es(this,"textTrack2"),a=new Es(this,"textTrack3"),o=new Es(this,"textTrack4");this.cea608Parser1=new eo(1,t,n),this.cea608Parser2=new eo(3,a,o)}}addCues(t,n,a,o,u){let c=!1;for(let p=u.length;p--;){const g=u[p],A=gd(g[0],g[1],n,a);if(A>=0&&(g[0]=Math.min(g[0],n),g[1]=Math.max(g[1],a),c=!0,A/(a-n)>.5))return}if(c||u.push([n,a]),this.config.renderTextTracksNatively){const p=this.captionsTracks[t];this.Cues.newCue(p,n,a,o)}else{const p=this.Cues.newCue(null,n,a,o);this.hls.trigger(v.CUES_PARSED,{type:"captions",cues:p,track:t})}}onInitPtsFound(t,{frag:n,id:a,initPTS:o,timescale:u}){const{unparsedVttFrags:c}=this;a==="main"&&(this.initPTS[n.cc]={baseTime:o,timescale:u}),c.length&&(this.unparsedVttFrags=[],c.forEach(p=>{this.onFragLoaded(v.FRAG_LOADED,p)}))}getExistingTrack(t,n){const{media:a}=this;if(a)for(let o=0;o<a.textTracks.length;o++){const u=a.textTracks[o];if(zn(u,{name:t,lang:n,attrs:{}}))return u}return null}createCaptionsTrack(t){this.config.renderTextTracksNatively?this.createNativeTrack(t):this.createNonNativeTrack(t)}createNativeTrack(t){if(this.captionsTracks[t])return;const{captionsProperties:n,captionsTracks:a,media:o}=this,{label:u,languageCode:c}=n[t],p=this.getExistingTrack(u,c);if(p)a[t]=p,ms(a[t]),Wr(a[t],o);else{const g=this.createTextTrack("captions",u,c);g&&(g[t]=!0,a[t]=g)}}createNonNativeTrack(t){if(this.nonNativeCaptionsTracks[t])return;const n=this.captionsProperties[t];if(!n)return;const a=n.label,o={_id:t,label:a,kind:"captions",default:n.media?!!n.media.default:!1,closedCaptions:n.media};this.nonNativeCaptionsTracks[t]=o,this.hls.trigger(v.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[o]})}createTextTrack(t,n,a){const o=this.media;if(!!o)return o.addTextTrack(t,n,a)}onMediaAttaching(t,n){this.media=n.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:t}=this;Object.keys(t).forEach(n=>{ms(t[n]),delete t[n]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=yd(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:t}=this;if(!t)return;const n=t.textTracks;if(n)for(let a=0;a<n.length;a++)ms(n[a])}onSubtitleTracksUpdated(t,n){const a=n.subtitleTracks||[],o=a.some(u=>u.textCodec===ru);if(this.config.enableWebVTT||o&&this.config.enableIMSC1){if(Xo(this.tracks,a)){this.tracks=a;return}if(this.textTracks=[],this.tracks=a,this.config.renderTextTracksNatively){const c=this.media,p=c?Na(c.textTracks):null;if(this.tracks.forEach((g,A)=>{let _;if(p){let w=null;for(let M=0;M<p.length;M++)if(p[M]&&zn(p[M],g)){w=p[M],p[M]=null;break}w&&(_=w)}if(_)ms(_);else{const w=ul(g);_=this.createTextTrack(w,g.name,g.lang),_&&(_.mode="disabled")}_&&this.textTracks.push(_)}),p!=null&&p.length){const g=p.filter(A=>A!==null).map(A=>A.label);g.length&&S.warn(`Media element contains unused subtitle tracks: ${g.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const c=this.tracks.map(p=>({label:p.name,kind:p.type.toLowerCase(),default:p.default,subtitleTrack:p}));this.hls.trigger(v.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:c})}}}onManifestLoaded(t,n){this.config.enableCEA708Captions&&n.captions&&n.captions.forEach(a=>{const o=/(?:CC|SERVICE)([1-4])/.exec(a.instreamId);if(!o)return;const u=`textTrack${o[1]}`,c=this.captionsProperties[u];!c||(c.label=a.name,a.lang&&(c.languageCode=a.lang),c.media=a)})}closedCaptionsForLevel(t){const n=this.hls.levels[t.level];return n==null?void 0:n.attrs["CLOSED-CAPTIONS"]}onFragLoading(t,n){this.initCea608Parsers();const{cea608Parser1:a,cea608Parser2:o,lastCc:u,lastSn:c,lastPartIndex:p}=this;if(!(!this.enabled||!a||!o)&&n.frag.type===Wt.MAIN){var g,A;const{cc:_,sn:w}=n.frag,M=(g=n==null||(A=n.part)==null?void 0:A.index)!=null?g:-1;w===c+1||w===c&&M===p+1||_===u||(a.reset(),o.reset()),this.lastCc=_,this.lastSn=w,this.lastPartIndex=M}}onFragLoaded(t,n){const{frag:a,payload:o}=n;if(a.type===Wt.SUBTITLE)if(o.byteLength){const u=a.decryptdata,c="stats"in n;if(u==null||!u.encrypted||c){const p=this.tracks[a.level],g=this.vttCCs;g[a.cc]||(g[a.cc]={start:a.start,prevCC:this.prevCC,new:!0},this.prevCC=a.cc),p&&p.textCodec===ru?this._parseIMSC1(a,o):this._parseVTTs(n)}}else this.hls.trigger(v.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:a,error:new Error("Empty subtitle payload")})}_parseIMSC1(t,n){const a=this.hls;pd(n,this.initPTS[t.cc],o=>{this._appendCues(o,t.level),a.trigger(v.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})},o=>{S.log(`Failed to parse IMSC1: ${o}`),a.trigger(v.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t,error:o})})}_parseVTTs(t){var n;const{frag:a,payload:o}=t,{initPTS:u,unparsedVttFrags:c}=this,p=u.length-1;if(!u[a.cc]&&p===-1){c.push(t);return}const g=this.hls,A=(n=a.initSegment)!=null&&n.data?ft(a.initSegment.data,new Uint8Array(o)):o;hd(A,this.initPTS[a.cc],this.vttCCs,a.cc,a.start,_=>{this._appendCues(_,a.level),g.trigger(v.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:a})},_=>{const w=_.message==="Missing initPTS for VTT MPEGTS";w?c.push(t):this._fallbackToIMSC1(a,o),S.log(`Failed to parse VTT cue: ${_}`),!(w&&p>a.cc)&&g.trigger(v.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:a,error:_})})}_fallbackToIMSC1(t,n){const a=this.tracks[t.level];a.textCodec||pd(n,this.initPTS[t.cc],()=>{a.textCodec=ru,this._parseIMSC1(t,n)},()=>{a.textCodec="wvtt"})}_appendCues(t,n){const a=this.hls;if(this.config.renderTextTracksNatively){const o=this.textTracks[n];if(!o||o.mode==="disabled")return;t.forEach(u=>To(o,u))}else{const o=this.tracks[n];if(!o)return;const u=o.default?"default":"subtitles"+n;a.trigger(v.CUES_PARSED,{type:"subtitles",cues:t,track:u})}}onFragDecrypted(t,n){const{frag:a}=n;a.type===Wt.SUBTITLE&&this.onFragLoaded(v.FRAG_LOADED,n)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(t,n){this.initCea608Parsers();const{cea608Parser1:a,cea608Parser2:o}=this;if(!this.enabled||!a||!o)return;const{frag:u,samples:c}=n;if(!(u.type===Wt.MAIN&&this.closedCaptionsForLevel(u)==="NONE"))for(let p=0;p<c.length;p++){const g=c[p].bytes;if(g){const A=this.extractCea608Data(g);a.addData(c[p].pts,A[0]),o.addData(c[p].pts,A[1])}}}onBufferFlushing(t,{startOffset:n,endOffset:a,endOffsetSubtitles:o,type:u}){const{media:c}=this;if(!(!c||c.currentTime<a)){if(!u||u==="video"){const{captionsTracks:p}=this;Object.keys(p).forEach(g=>Fa(p[g],n,a))}if(this.config.renderTextTracksNatively&&n===0&&o!==void 0){const{textTracks:p}=this;Object.keys(p).forEach(g=>Fa(p[g],n,o))}}}extractCea608Data(t){const n=[[],[]],a=t[0]&31;let o=2;for(let u=0;u<a;u++){const c=t[o++],p=127&t[o++],g=127&t[o++];if(p===0&&g===0)continue;if((4&c)!=0){const _=3&c;(_===0||_===1)&&(n[_].push(p),n[_].push(g))}}return n}}function ul(h){return h.characteristics&&/transcribes-spoken-dialog/gi.test(h.characteristics)&&/describes-music-and-sound/gi.test(h.characteristics)?"captions":"subtitles"}function zn(h,t){return!!h&&h.kind===ul(t)&&Qo(t,h)}function gd(h,t,n,a){return Math.min(t,a)-Math.max(h,n)}function yd(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class to{constructor(t){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=t,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(t){this.streamController=t}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:t}=this;t.on(v.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.on(v.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(v.MANIFEST_PARSED,this.onManifestParsed,this),t.on(v.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(v.BUFFER_CODECS,this.onBufferCodecs,this),t.on(v.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:t}=this;t.off(v.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.off(v.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(v.MANIFEST_PARSED,this.onManifestParsed,this),t.off(v.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(v.BUFFER_CODECS,this.onBufferCodecs,this),t.off(v.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(t,n){const a=this.hls.levels[n.droppedLevel];this.isLevelAllowed(a)&&this.restrictedLevels.push({bitrate:a.bitrate,height:a.height,width:a.width})}onMediaAttaching(t,n){this.media=n.media instanceof HTMLVideoElement?n.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(t,n){const a=this.hls;this.restrictedLevels=[],this.firstLevel=n.firstLevel,a.config.capLevelToPlayerSize&&n.video&&this.startCapping()}onLevelsUpdated(t,n){this.timer&&ie(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(t,n){this.hls.config.capLevelToPlayerSize&&n.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const t=this.hls.levels;if(t.length){const n=this.hls,a=this.getMaxLevel(t.length-1);a!==this.autoLevelCapping&&S.log(`Setting autoLevelCapping to ${a}: ${t[a].height}p@${t[a].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),n.autoLevelCapping=a,n.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=n.autoLevelCapping}}}getMaxLevel(t){const n=this.hls.levels;if(!n.length)return-1;const a=n.filter((o,u)=>this.isLevelAllowed(o)&&u<=t);return this.clientRect=null,to.getMaxLevelByMediaSize(a,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const t=this.media,n={width:0,height:0};if(t){const a=t.getBoundingClientRect();n.width=a.width,n.height=a.height,!n.width&&!n.height&&(n.width=a.right-a.left||t.width||0,n.height=a.bottom-a.top||t.height||0)}return this.clientRect=n,n}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let t=1;if(!this.hls.config.ignoreDevicePixelRatio)try{t=self.devicePixelRatio}catch(n){}return t}isLevelAllowed(t){return!this.restrictedLevels.some(a=>t.bitrate===a.bitrate&&t.width===a.width&&t.height===a.height)}static getMaxLevelByMediaSize(t,n,a){if(!(t!=null&&t.length))return-1;const o=(p,g)=>g?p.width!==g.width||p.height!==g.height:!0;let u=t.length-1;const c=Math.max(n,a);for(let p=0;p<t.length;p+=1){const g=t[p];if((g.width>=c||g.height>=c)&&o(g,t[p+1])){u=p;break}}return u}}class io{constructor(t){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=t,this.registerListeners()}setStreamController(t){this.streamController=t}registerListeners(){this.hls.on(v.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(v.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(t,n){const a=this.hls.config;if(a.capLevelOnFPSDrop){const o=n.media instanceof self.HTMLVideoElement?n.media:null;this.media=o,o&&typeof o.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),a.fpsDroppedMonitoringPeriod)}}checkFPS(t,n,a){const o=performance.now();if(n){if(this.lastTime){const u=o-this.lastTime,c=a-this.lastDroppedFrames,p=n-this.lastDecodedFrames,g=1e3*c/u,A=this.hls;if(A.trigger(v.FPS_DROP,{currentDropped:c,currentDecoded:p,totalDroppedFrames:a}),g>0&&c>A.config.fpsDroppedMonitoringThreshold*p){let _=A.currentLevel;S.warn("drop FPS ratio greater than max allowed value for currentLevel: "+_),_>0&&(A.autoLevelCapping===-1||A.autoLevelCapping>=_)&&(_=_-1,A.trigger(v.FPS_DROP_LEVEL_CAPPING,{level:_,droppedLevel:A.currentLevel}),A.autoLevelCapping=_,this.streamController.nextLevelSwitch())}}this.lastTime=o,this.lastDroppedFrames=a,this.lastDecodedFrames=n}}checkFPSInterval(){const t=this.media;if(t)if(this.isVideoPlaybackQualityAvailable){const n=t.getVideoPlaybackQuality();this.checkFPS(t,n.totalVideoFrames,n.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)}}const no="[eme]";class Ca{constructor(t){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=Ca.CDMCleanupPromise?[Ca.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=S.debug.bind(S,no),this.log=S.log.bind(S,no),this.warn=S.warn.bind(S,no),this.error=S.error.bind(S,no),this.hls=t,this.config=t.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const t=this.config;t.requestMediaKeySystemAccessFunc=null,t.licenseXhrSetup=t.licenseResponseCallback=void 0,t.drmSystems=t.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(v.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(v.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(v.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(v.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(v.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(v.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(t){const{drmSystems:n,widevineLicenseUrl:a}=this.config,o=n[t];if(o)return o.licenseUrl;if(t===rt.WIDEVINE&&a)return a;throw new Error(`no license server URL configured for key-system "${t}"`)}getServerCertificateUrl(t){const{drmSystems:n}=this.config,a=n[t];if(a)return a.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${t}"]`)}attemptKeySystemAccess(t){const n=this.hls.levels,a=(c,p,g)=>!!c&&g.indexOf(c)===p,o=n.map(c=>c.audioCodec).filter(a),u=n.map(c=>c.videoCodec).filter(a);return o.length+u.length===0&&u.push("avc1.42e01e"),new Promise((c,p)=>{const g=A=>{const _=A.shift();this.getMediaKeysPromise(_,o,u).then(w=>c({keySystem:_,mediaKeys:w})).catch(w=>{A.length?g(A):w instanceof ar?p(w):p(new ar({type:$.KEY_SYSTEM_ERROR,details:I.KEY_SYSTEM_NO_ACCESS,error:w,fatal:!0},w.message))})};g(t)})}requestMediaKeySystemAccess(t,n){const{requestMediaKeySystemAccessFunc:a}=this.config;if(typeof a!="function"){let o=`Configured requestMediaKeySystemAccess is not a function ${a}`;return vi===null&&self.location.protocol==="http:"&&(o=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(o))}return a(t,n)}getMediaKeysPromise(t,n,a){const o=Et(t,n,a,this.config.drmSystemOptions),u=this.keySystemAccessPromises[t];let c=u==null?void 0:u.keySystemAccess;if(!c){this.log(`Requesting encrypted media "${t}" key-system access with config: ${JSON.stringify(o)}`),c=this.requestMediaKeySystemAccess(t,o);const p=this.keySystemAccessPromises[t]={keySystemAccess:c};return c.catch(g=>{this.log(`Failed to obtain access to key-system "${t}": ${g}`)}),c.then(g=>{this.log(`Access for key-system "${g.keySystem}" obtained`);const A=this.fetchServerCertificate(t);return this.log(`Create media-keys for "${t}"`),p.mediaKeys=g.createMediaKeys().then(_=>(this.log(`Media-keys created for "${t}"`),A.then(w=>w?this.setMediaKeysServerCertificate(_,t,w):_))),p.mediaKeys.catch(_=>{this.error(`Failed to create media-keys for "${t}"}: ${_}`)}),p.mediaKeys})}return c.then(()=>u.mediaKeys)}createMediaKeySessionContext({decryptdata:t,keySystem:n,mediaKeys:a}){this.log(`Creating key-system session "${n}" keyId: ${Ct.hexDump(t.keyId||[])}`);const o=a.createSession(),u={decryptdata:t,keySystem:n,mediaKeys:a,mediaKeysSession:o,keyStatus:"status-pending"};return this.mediaKeySessions.push(u),u}renewKeySession(t){const n=t.decryptdata;if(n.pssh){const a=this.createMediaKeySessionContext(t),o=this.getKeyIdString(n),u="cenc";this.keyIdToKeySessionPromise[o]=this.generateRequestWithPreferredKeySession(a,u,n.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(t)}getKeyIdString(t){if(!t)throw new Error("Could not read keyId of undefined decryptdata");if(t.keyId===null)throw new Error("keyId is null");return Ct.hexDump(t.keyId)}updateKeySession(t,n){var a;const o=t.mediaKeysSession;return this.log(`Updating key-session "${o.sessionId}" for keyID ${Ct.hexDump(((a=t.decryptdata)==null?void 0:a.keyId)||[])}
      } (data length: ${n&&n.byteLength})`),o.update(n)}selectKeySystemFormat(t){const n=Object.keys(t.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${t.sn} ${t.type}: ${t.level}) key formats ${n.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(n)),this.keyFormatPromise}getKeyFormatPromise(t){return new Promise((n,a)=>{const o=Ti(this.config),u=t.map(_t).filter(c=>!!c&&o.indexOf(c)!==-1);return this.getKeySystemSelectionPromise(u).then(({keySystem:c})=>{const p=ei(c);p?n(p):a(new Error(`Unable to find format for key-system "${c}"`))}).catch(a)})}loadKey(t){const n=t.keyInfo.decryptdata,a=this.getKeyIdString(n),o=`(keyId: ${a} format: "${n.keyFormat}" method: ${n.method} uri: ${n.uri})`;this.log(`Starting session for key ${o}`);let u=this.keyIdToKeySessionPromise[a];return u||(u=this.keyIdToKeySessionPromise[a]=this.getKeySystemForKeyPromise(n).then(({keySystem:c,mediaKeys:p})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${t.frag.sn} ${t.frag.type}: ${t.frag.level} using key ${o}`),this.attemptSetMediaKeys(c,p).then(()=>{this.throwIfDestroyed();const g=this.createMediaKeySessionContext({keySystem:c,mediaKeys:p,decryptdata:n}),A="cenc";return this.generateRequestWithPreferredKeySession(g,A,n.pssh,"playlist-key")}))),u.catch(c=>this.handleError(c))),u}throwIfDestroyed(t="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(t){!this.hls||(this.error(t.message),t instanceof ar?this.hls.trigger(v.ERROR,t.data):this.hls.trigger(v.ERROR,{type:$.KEY_SYSTEM_ERROR,details:I.KEY_SYSTEM_NO_KEYS,error:t,fatal:!0}))}getKeySystemForKeyPromise(t){const n=this.getKeyIdString(t),a=this.keyIdToKeySessionPromise[n];if(!a){const o=_t(t.keyFormat),u=o?[o]:Ti(this.config);return this.attemptKeySystemAccess(u)}return a}getKeySystemSelectionPromise(t){if(t.length||(t=Ti(this.config)),t.length===0)throw new ar({type:$.KEY_SYSTEM_ERROR,details:I.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(t)}_onMediaEncrypted(t){const{initDataType:n,initData:a}=t;if(this.debug(`"${t.type}" event: init data type: "${n}"`),a===null)return;let o,u;if(n==="sinf"&&this.config.drmSystems[rt.FAIRPLAY]){const _=fi(new Uint8Array(a));try{const w=$e(JSON.parse(_).sinf),M=Jn(new Uint8Array(w));if(!M)return;o=M.subarray(8,24),u=rt.FAIRPLAY}catch(w){this.warn('Failed to parse sinf "encrypted" event message initData');return}}else{const _=er(a);if(_===null)return;_.version===0&&_.systemId===Gt.WIDEVINE&&_.data&&(o=_.data.subarray(8,24)),u=li(_.systemId)}if(!u||!o)return;const c=Ct.hexDump(o),{keyIdToKeySessionPromise:p,mediaKeySessions:g}=this;let A=p[c];for(let _=0;_<g.length;_++){const w=g[_],M=w.decryptdata;if(M.pssh||!M.keyId)continue;const z=Ct.hexDump(M.keyId);if(c===z||M.uri.replace(/-/g,"").indexOf(c)!==-1){A=p[z],delete p[z],M.pssh=new Uint8Array(a),M.keyId=o,A=p[c]=A.then(()=>this.generateRequestWithPreferredKeySession(w,n,a,"encrypted-event-key-match"));break}}A||(A=p[c]=this.getKeySystemSelectionPromise([u]).then(({keySystem:_,mediaKeys:w})=>{var M;this.throwIfDestroyed();const z=new Hi("ISO-23001-7",c,(M=ei(_))!=null?M:"");return z.pssh=new Uint8Array(a),z.keyId=o,this.attemptSetMediaKeys(_,w).then(()=>{this.throwIfDestroyed();const K=this.createMediaKeySessionContext({decryptdata:z,keySystem:_,mediaKeys:w});return this.generateRequestWithPreferredKeySession(K,n,a,"encrypted-event-no-match")})})),A.catch(_=>this.handleError(_))}_onWaitingForKey(t){this.log(`"${t.type}" event`)}attemptSetMediaKeys(t,n){const a=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${t}"`);const o=Promise.all(a).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(n)});return this.setMediaKeysQueue.push(o),o.then(()=>{this.log(`Media-keys set for "${t}"`),a.push(o),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(u=>a.indexOf(u)===-1)})}generateRequestWithPreferredKeySession(t,n,a,o){var u,c;const p=(u=this.config.drmSystems)==null||(c=u[t.keySystem])==null?void 0:c.generateRequest;if(p)try{const K=p.call(this.hls,n,a,t);if(!K)throw new Error("Invalid response from configured generateRequest filter");n=K.initDataType,a=t.decryptdata.pssh=K.initData?new Uint8Array(K.initData):null}catch(K){var g;if(this.warn(K.message),(g=this.hls)!=null&&g.config.debug)throw K}if(a===null)return this.log(`Skipping key-session request for "${o}" (no initData)`),Promise.resolve(t);const A=this.getKeyIdString(t.decryptdata);this.log(`Generating key-session request for "${o}": ${A} (init data type: ${n} length: ${a?a.byteLength:null})`);const _=new Wn,w=t._onmessage=K=>{const Z=t.mediaKeysSession;if(!Z){_.emit("error",new Error("invalid state"));return}const{messageType:ne,message:xe}=K;this.log(`"${ne}" message event for session "${Z.sessionId}" message size: ${xe.byteLength}`),ne==="license-request"||ne==="license-renewal"?this.renewLicense(t,xe).catch(de=>{this.handleError(de),_.emit("error",de)}):ne==="license-release"?t.keySystem===rt.FAIRPLAY&&(this.updateKeySession(t,Rt("acknowledged")),this.removeSession(t)):this.warn(`unhandled media key message type "${ne}"`)},M=t._onkeystatuseschange=K=>{if(!t.mediaKeysSession){_.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(t);const ne=t.keyStatus;_.emit("keyStatus",ne),ne==="expired"&&(this.warn(`${t.keySystem} expired for key ${A}`),this.renewKeySession(t))};t.mediaKeysSession.addEventListener("message",w),t.mediaKeysSession.addEventListener("keystatuseschange",M);const z=new Promise((K,Z)=>{_.on("error",Z),_.on("keyStatus",ne=>{ne.startsWith("usable")?K():ne==="output-restricted"?Z(new ar({type:$.KEY_SYSTEM_ERROR,details:I.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):ne==="internal-error"?Z(new ar({type:$.KEY_SYSTEM_ERROR,details:I.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${ne}"`)):ne==="expired"?Z(new Error("key expired while generating request")):this.warn(`unhandled key status change "${ne}"`)})});return t.mediaKeysSession.generateRequest(n,a).then(()=>{var K;this.log(`Request generated for key-session "${(K=t.mediaKeysSession)==null?void 0:K.sessionId}" keyId: ${A}`)}).catch(K=>{throw new ar({type:$.KEY_SYSTEM_ERROR,details:I.KEY_SYSTEM_NO_SESSION,error:K,fatal:!1},`Error generating key-session request: ${K}`)}).then(()=>z).catch(K=>{throw _.removeAllListeners(),this.removeSession(t),K}).then(()=>(_.removeAllListeners(),t))}onKeyStatusChange(t){t.mediaKeysSession.keyStatuses.forEach((n,a)=>{this.log(`key status change "${n}" for keyStatuses keyId: ${Ct.hexDump("buffer"in a?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):new Uint8Array(a))} session keyId: ${Ct.hexDump(new Uint8Array(t.decryptdata.keyId||[]))} uri: ${t.decryptdata.uri}`),t.keyStatus=n})}fetchServerCertificate(t){const n=this.config,a=n.loader,o=new a(n),u=this.getServerCertificateUrl(t);return u?(this.log(`Fetching server certificate for "${t}"`),new Promise((c,p)=>{const g={responseType:"arraybuffer",url:u},A=n.certLoadPolicy.default,_={loadPolicy:A,timeout:A.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},w={onSuccess:(M,z,K,Z)=>{c(M.data)},onError:(M,z,K,Z)=>{p(new ar({type:$.KEY_SYSTEM_ERROR,details:I.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:K,response:nt({url:g.url,data:void 0},M)},`"${t}" certificate request failed (${u}). Status: ${M.code} (${M.text})`))},onTimeout:(M,z,K)=>{p(new ar({type:$.KEY_SYSTEM_ERROR,details:I.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:K,response:{url:g.url,data:void 0}},`"${t}" certificate request timed out (${u})`))},onAbort:(M,z,K)=>{p(new Error("aborted"))}};o.load(g,_,w)})):Promise.resolve()}setMediaKeysServerCertificate(t,n,a){return new Promise((o,u)=>{t.setServerCertificate(a).then(c=>{this.log(`setServerCertificate ${c?"success":"not supported by CDM"} (${a==null?void 0:a.byteLength}) on "${n}"`),o(t)}).catch(c=>{u(new ar({type:$.KEY_SYSTEM_ERROR,details:I.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:c,fatal:!0},c.message))})})}renewLicense(t,n){return this.requestLicense(t,new Uint8Array(n)).then(a=>this.updateKeySession(t,new Uint8Array(a)).catch(o=>{throw new ar({type:$.KEY_SYSTEM_ERROR,details:I.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:o,fatal:!0},o.message)}))}unpackPlayReadyKeyMessage(t,n){const a=String.fromCharCode.apply(null,new Uint16Array(n.buffer));if(!a.includes("PlayReadyKeyMessage"))return t.setRequestHeader("Content-Type","text/xml; charset=utf-8"),n;const o=new DOMParser().parseFromString(a,"application/xml"),u=o.querySelectorAll("HttpHeader");if(u.length>0){let _;for(let w=0,M=u.length;w<M;w++){var c,p;_=u[w];const z=(c=_.querySelector("name"))==null?void 0:c.textContent,K=(p=_.querySelector("value"))==null?void 0:p.textContent;z&&K&&t.setRequestHeader(z,K)}}const g=o.querySelector("Challenge"),A=g==null?void 0:g.textContent;if(!A)throw new Error("Cannot find <Challenge> in key message");return Rt(atob(A))}setupLicenseXHR(t,n,a,o){const u=this.config.licenseXhrSetup;return u?Promise.resolve().then(()=>{if(!a.decryptdata)throw new Error("Key removed");return u.call(this.hls,t,n,a,o)}).catch(c=>{if(!a.decryptdata)throw c;return t.open("POST",n,!0),u.call(this.hls,t,n,a,o)}).then(c=>(t.readyState||t.open("POST",n,!0),{xhr:t,licenseChallenge:c||o})):(t.open("POST",n,!0),Promise.resolve({xhr:t,licenseChallenge:o}))}requestLicense(t,n){const a=this.config.keyLoadPolicy.default;return new Promise((o,u)=>{const c=this.getLicenseServerUrl(t.keySystem);this.log(`Sending license request to URL: ${c}`);const p=new XMLHttpRequest;p.responseType="arraybuffer",p.onreadystatechange=()=>{if(!this.hls||!t.mediaKeysSession)return u(new Error("invalid state"));if(p.readyState===4)if(p.status===200){this._requestLicenseFailureCount=0;let g=p.response;this.log(`License received ${g instanceof ArrayBuffer?g.byteLength:g}`);const A=this.config.licenseResponseCallback;if(A)try{g=A.call(this.hls,p,c,t)}catch(_){this.error(_)}o(g)}else{const g=a.errorRetry,A=g?g.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>A||p.status>=400&&p.status<500)u(new ar({type:$.KEY_SYSTEM_ERROR,details:I.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:p,response:{url:c,data:void 0,code:p.status,text:p.statusText}},`License Request XHR failed (${c}). Status: ${p.status} (${p.statusText})`));else{const _=A-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${_} attempts left`),this.requestLicense(t,n).then(o,u)}}},t.licenseXhr&&t.licenseXhr.readyState!==XMLHttpRequest.DONE&&t.licenseXhr.abort(),t.licenseXhr=p,this.setupLicenseXHR(p,c,t,n).then(({xhr:g,licenseChallenge:A})=>{t.keySystem==rt.PLAYREADY&&(A=this.unpackPlayReadyKeyMessage(g,A)),g.send(A)})})}onMediaAttached(t,n){if(!this.config.emeEnabled)return;const a=n.media;this.media=a,a.addEventListener("encrypted",this.onMediaEncrypted),a.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const t=this.media,n=this.mediaKeySessions;t&&(t.removeEventListener("encrypted",this.onMediaEncrypted),t.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},Hi.clearKeyUriToKeyIdMap();const a=n.length;Ca.CDMCleanupPromise=Promise.all(n.map(o=>this.removeSession(o)).concat(t==null?void 0:t.setMediaKeys(null).catch(o=>{this.log(`Could not clear media keys: ${o}`)}))).then(()=>{a&&(this.log("finished closing key sessions and clearing media keys"),n.length=0)}).catch(o=>{this.log(`Could not close sessions and clear media keys: ${o}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(t,{sessionKeys:n}){if(!(!n||!this.config.emeEnabled)&&!this.keyFormatPromise){const a=n.reduce((o,u)=>(o.indexOf(u.keyFormat)===-1&&o.push(u.keyFormat),o),[]);this.log(`Selecting key-system from session-keys ${a.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(a)}}removeSession(t){const{mediaKeysSession:n,licenseXhr:a}=t;if(n){this.log(`Remove licenses and keys and close session ${n.sessionId}`),t._onmessage&&(n.removeEventListener("message",t._onmessage),t._onmessage=void 0),t._onkeystatuseschange&&(n.removeEventListener("keystatuseschange",t._onkeystatuseschange),t._onkeystatuseschange=void 0),a&&a.readyState!==XMLHttpRequest.DONE&&a.abort(),t.mediaKeysSession=t.decryptdata=t.licenseXhr=void 0;const o=this.mediaKeySessions.indexOf(t);return o>-1&&this.mediaKeySessions.splice(o,1),n.remove().catch(u=>{this.log(`Could not remove session: ${u}`)}).then(()=>n.close()).catch(u=>{this.log(`Could not close session: ${u}`)})}}}Ca.CDMCleanupPromise=void 0;class ar extends Error{constructor(t,n){super(n);this.data=void 0,t.error||(t.error=new Error(n)),this.data=t,t.err=t.error}}var Oi;(function(h){h.MANIFEST="m",h.AUDIO="a",h.VIDEO="v",h.MUXED="av",h.INIT="i",h.CAPTION="c",h.TIMED_TEXT="tt",h.KEY="k",h.OTHER="o"})(Oi||(Oi={}));var dl;(function(h){h.DASH="d",h.HLS="h",h.SMOOTH="s",h.OTHER="o"})(dl||(dl={}));var Js;(function(h){h.OBJECT="CMCD-Object",h.REQUEST="CMCD-Request",h.SESSION="CMCD-Session",h.STATUS="CMCD-Status"})(Js||(Js={}));const vd={[Js.OBJECT]:["br","d","ot","tb"],[Js.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[Js.SESSION]:["cid","pr","sf","sid","st","v"],[Js.STATUS]:["bs","rtp"]};class Tr{constructor(t,n){this.value=void 0,this.params=void 0,Array.isArray(t)&&(t=t.map(a=>a instanceof Tr?a:new Tr(a))),this.value=t,this.params=n}}class cl{constructor(t){this.description=void 0,this.description=t}}const du="Dict";function jc(h){return Array.isArray(h)?JSON.stringify(h):h instanceof Map?"Map{}":h instanceof Set?"Set{}":typeof h=="object"?JSON.stringify(h):String(h)}function cu(h,t,n,a){return new Error(`failed to ${h} "${jc(t)}" as ${n}`,{cause:a})}const Ad="Bare Item",bd="Boolean",ro="Byte Sequence",$c="Decimal",hu="Integer";function fu(h){return h<-999999999999999||999999999999999<h}const Vc=/[\x00-\x1f\x7f]+/,Gc="Token",pu="Key";function Sr(h,t,n){return cu("serialize",h,t,n)}function hl(h){if(typeof h!="boolean")throw Sr(h,bd);return h?"?1":"?0"}function _d(h){return btoa(String.fromCharCode(...h))}function mu(h){if(ArrayBuffer.isView(h)===!1)throw Sr(h,ro);return`:${_d(h)}:`}function gu(h){if(fu(h))throw Sr(h,hu);return h.toString()}function xd(h){return`@${gu(h.getTime()/1e3)}`}function yu(h,t){if(h<0)return-yu(-h,t);const n=Math.pow(10,t);if(Math.abs(h*n%1-.5)<Number.EPSILON){const o=Math.floor(h*n);return(o%2==0?o:o+1)/n}else return Math.round(h*n)/n}function Hc(h){const t=yu(h,3);if(Math.floor(Math.abs(t)).toString().length>12)throw Sr(h,$c);const n=t.toString();return n.includes(".")?n:`${n}.0`}const qc="String";function Kc(h){if(Vc.test(h))throw Sr(h,qc);return`"${h.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function Ed(h){return h.description||h.toString().slice(7,-1)}function so(h){const t=Ed(h);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(t)===!1)throw Sr(t,Gc);return t}function fl(h){switch(typeof h){case"number":if(!ie(h))throw Sr(h,Ad);return Number.isInteger(h)?gu(h):Hc(h);case"string":return Kc(h);case"symbol":return so(h);case"boolean":return hl(h);case"object":if(h instanceof Date)return xd(h);if(h instanceof Uint8Array)return mu(h);if(h instanceof cl)return so(h);default:throw Sr(h,Ad)}}function vu(h){if(/^[a-z*][a-z0-9\-_.*]*$/.test(h)===!1)throw Sr(h,pu);return h}function pl(h){return h==null?"":Object.entries(h).map(([t,n])=>n===!0?`;${vu(t)}`:`;${vu(t)}=${fl(n)}`).join("")}function Au(h){return h instanceof Tr?`${fl(h.value)}${pl(h.params)}`:fl(h)}function Td(h){return`(${h.value.map(Au).join(" ")})${pl(h.params)}`}function Sd(h,t={whitespace:!0}){if(typeof h!="object")throw Sr(h,du);const n=h instanceof Map?h.entries():Object.entries(h),a=t!=null&&t.whitespace?" ":"";return Array.from(n).map(([o,u])=>{u instanceof Tr||(u=new Tr(u));let c=vu(o);return u.value===!0?c+=pl(u.params):(c+="=",Array.isArray(u.value)?c+=Td(u):c+=Au(u)),c}).join(`,${a}`)}function Cd(h,t){return Sd(h,t)}const bu=h=>h==="ot"||h==="sf"||h==="st",_u=h=>typeof h=="number"?ie(h):h!=null&&h!==""&&h!==!1;function Wc(h,t){const n=new URL(h),a=new URL(t);if(n.origin!==a.origin)return h;const o=n.pathname.split("/").slice(1),u=a.pathname.split("/").slice(1,-1);for(;o[0]===u[0];)o.shift(),u.shift();for(;u.length;)u.shift(),o.unshift("..");return o.join("/")}function ao(){try{return crypto.randomUUID()}catch(h){try{const t=URL.createObjectURL(new Blob),n=t.toString();return URL.revokeObjectURL(t),n.slice(n.lastIndexOf("/")+1)}catch(t){let n=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,o=>{const u=(n+Math.random()*16)%16|0;return n=Math.floor(n/16),(o=="x"?u:u&3|8).toString(16)})}}}const Cs=h=>Math.round(h),wd=(h,t)=>(t!=null&&t.baseUrl&&(h=Wc(h,t.baseUrl)),encodeURIComponent(h)),rs=h=>Cs(h/100)*100,Ld={br:Cs,d:Cs,bl:rs,dl:rs,mtp:rs,nor:wd,rtp:rs,tb:Cs};function xu(h,t){const n={};if(h==null||typeof h!="object")return n;const a=Object.keys(h).sort(),o=re({},Ld,t==null?void 0:t.formatters),u=t==null?void 0:t.filter;return a.forEach(c=>{if(u!=null&&u(c))return;let p=h[c];const g=o[c];g&&(p=g(p,t)),!(c==="v"&&p===1)&&(c=="pr"&&p===1||!_u(p)||(bu(c)&&typeof p=="string"&&(p=new cl(p)),n[c]=p))}),n}function ml(h,t={}){return h?Cd(xu(h,t),re({whitespace:!1},t)):""}function Eu(h,t={}){if(!h)return{};const n=Object.entries(h),a=Object.entries(vd).concat(Object.entries((t==null?void 0:t.customHeaderMap)||{})),o=n.reduce((u,c)=>{var p,g;const[A,_]=c,w=((p=a.find(M=>M[1].includes(A)))==null?void 0:p[0])||Js.REQUEST;return(g=u[w])!=null||(u[w]={}),u[w][A]=_,u},{});return Object.entries(o).reduce((u,[c,p])=>(u[c]=ml(p,t),u),{})}function Tu(h,t,n){return re(h,Eu(t,n))}const Su="CMCD";function Dd(h,t={}){if(!h)return"";const n=ml(h,t);return`${Su}=${encodeURIComponent(n)}`}const gl=/CMCD=[^&#]+/;function kd(h,t,n){const a=Dd(t,n);if(!a)return h;if(gl.test(h))return h.replace(gl,a);const o=h.includes("?")?"&":"?";return`${h}${o}${a}`}class Id{constructor(t){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=o=>{try{this.apply(o,{ot:Oi.MANIFEST,su:!this.initialized})}catch(u){S.warn("Could not generate manifest CMCD data.",u)}},this.applyFragmentData=o=>{try{const u=o.frag,c=this.hls.levels[u.level],p=this.getObjectType(u),g={d:u.duration*1e3,ot:p};(p===Oi.VIDEO||p===Oi.AUDIO||p==Oi.MUXED)&&(g.br=c.bitrate/1e3,g.tb=this.getTopBandwidth(p)/1e3,g.bl=this.getBufferLength(p)),this.apply(o,g)}catch(u){S.warn("Could not generate segment CMCD data.",u)}},this.hls=t;const n=this.config=t.config,{cmcd:a}=n;a!=null&&(n.pLoader=this.createPlaylistLoader(),n.fLoader=this.createFragmentLoader(),this.sid=a.sessionId||ao(),this.cid=a.contentId,this.useHeaders=a.useHeaders===!0,this.includeKeys=a.includeKeys,this.registerListeners())}registerListeners(){const t=this.hls;t.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(v.MEDIA_DETACHED,this.onMediaDetached,this),t.on(v.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const t=this.hls;t.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(v.MEDIA_DETACHED,this.onMediaDetached,this),t.off(v.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=null}onMediaAttached(t,n){this.media=n.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){!this.media||(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(t,n){var a,o;this.audioBuffer=(a=n.tracks.audio)==null?void 0:a.buffer,this.videoBuffer=(o=n.tracks.video)==null?void 0:o.buffer}createData(){var t;return{v:1,sf:dl.HLS,sid:this.sid,cid:this.cid,pr:(t=this.media)==null?void 0:t.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(t,n={}){re(n,this.createData());const a=n.ot===Oi.INIT||n.ot===Oi.VIDEO||n.ot===Oi.MUXED;this.starved&&a&&(n.bs=!0,n.su=!0,this.starved=!1),n.su==null&&(n.su=this.buffering);const{includeKeys:o}=this;o&&(n=Object.keys(n).reduce((u,c)=>(o.includes(c)&&(u[c]=n[c]),u),{})),this.useHeaders?(t.headers||(t.headers={}),Tu(t.headers,n)):t.url=kd(t.url,n)}getObjectType(t){const{type:n}=t;if(n==="subtitle")return Oi.TIMED_TEXT;if(t.sn==="initSegment")return Oi.INIT;if(n==="audio")return Oi.AUDIO;if(n==="main")return this.hls.audioTracks.length?Oi.VIDEO:Oi.MUXED}getTopBandwidth(t){let n=0,a;const o=this.hls;if(t===Oi.AUDIO)a=o.audioTracks;else{const u=o.maxAutoLevel,c=u>-1?u+1:o.levels.length;a=o.levels.slice(0,c)}for(const u of a)u.bitrate>n&&(n=u.bitrate);return n>0?n:NaN}getBufferLength(t){const n=this.hls.media,a=t===Oi.AUDIO?this.audioBuffer:this.videoBuffer;return!a||!n?NaN:_i.bufferInfo(a,n.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:t}=this.config,n=this.applyPlaylistData,a=t||this.config.loader;return class{constructor(u){this.loader=void 0,this.loader=new a(u)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(u,c,p){n(u),this.loader.load(u,c,p)}}}createFragmentLoader(){const{fLoader:t}=this.config,n=this.applyFragmentData,a=t||this.config.loader;return class{constructor(u){this.loader=void 0,this.loader=new a(u)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(u,c,p){n(u),this.loader.load(u,c,p)}}}}const Cu=3e5;class Rd{constructor(t){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=t,this.log=S.log.bind(S,"[content-steering]:"),this.registerListeners()}registerListeners(){const t=this.hls;t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(v.MANIFEST_PARSED,this.onManifestParsed,this),t.on(v.ERROR,this.onError,this)}unregisterListeners(){const t=this.hls;!t||(t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(v.MANIFEST_PARSED,this.onManifestParsed,this),t.off(v.ERROR,this.onError,this))}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const t=this.timeToLoad*1e3-(performance.now()-this.updated);if(t>0){this.scheduleRefresh(this.uri,t);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(t){const n=this.levels;n&&(this.levels=n.filter(a=>a!==t))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(t,n){const{contentSteering:a}=n;a!==null&&(this.pathwayId=a.pathwayId,this.uri=a.uri,this.started&&this.startLoad())}onManifestParsed(t,n){this.audioTracks=n.audioTracks,this.subtitleTracks=n.subtitleTracks}onError(t,n){const{errorAction:a}=n;if((a==null?void 0:a.action)===pi.SendAlternateToPenaltyBox&&a.flags===Qi.MoveAllAlternatesMatchingHost){const o=this.levels;let u=this.pathwayPriority,c=this.pathwayId;if(n.context){const{groupId:p,pathwayId:g,type:A}=n.context;p&&o?c=this.getPathwayForGroupId(p,A,c):g&&(c=g)}c in this.penalizedPathways||(this.penalizedPathways[c]=performance.now()),!u&&o&&(u=o.reduce((p,g)=>(p.indexOf(g.pathwayId)===-1&&p.push(g.pathwayId),p),[])),u&&u.length>1&&(this.updatePathwayPriority(u),a.resolved=this.pathwayId!==c),a.resolved||S.warn(`Could not resolve ${n.details} ("${n.error.message}") with content-steering for Pathway: ${c} levels: ${o&&o.length} priorities: ${JSON.stringify(u)} penalized: ${JSON.stringify(this.penalizedPathways)}`)}}filterParsedLevels(t){this.levels=t;let n=this.getLevelsForPathway(this.pathwayId);if(n.length===0){const a=t[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${a}"`),n=this.getLevelsForPathway(a),this.pathwayId=a}return n.length!==t.length?(this.log(`Found ${n.length}/${t.length} levels in Pathway "${this.pathwayId}"`),n):t}getLevelsForPathway(t){return this.levels===null?[]:this.levels.filter(n=>t===n.pathwayId)}updatePathwayPriority(t){this.pathwayPriority=t;let n;const a=this.penalizedPathways,o=performance.now();Object.keys(a).forEach(u=>{o-a[u]>Cu&&delete a[u]});for(let u=0;u<t.length;u++){const c=t[u];if(c in a)continue;if(c===this.pathwayId)return;const p=this.hls.nextLoadLevel,g=this.hls.levels[p];if(n=this.getLevelsForPathway(c),n.length>0){this.log(`Setting Pathway to "${c}"`),this.pathwayId=c,Rn(n),this.hls.trigger(v.LEVELS_UPDATED,{levels:n});const A=this.hls.levels[p];g&&A&&this.levels&&(A.attrs["STABLE-VARIANT-ID"]!==g.attrs["STABLE-VARIANT-ID"]&&A.bitrate!==g.bitrate&&this.log(`Unstable Pathways change from bitrate ${g.bitrate} to ${A.bitrate}`),this.hls.nextLoadLevel=p);break}}}getPathwayForGroupId(t,n,a){const o=this.getLevelsForPathway(a).concat(this.levels||[]);for(let u=0;u<o.length;u++)if(n===di.AUDIO_TRACK&&o[u].hasAudioGroup(t)||n===di.SUBTITLE_TRACK&&o[u].hasSubtitleGroup(t))return o[u].pathwayId;return a}clonePathways(t){const n=this.levels;if(!n)return;const a={},o={};t.forEach(u=>{const{ID:c,"BASE-ID":p,"URI-REPLACEMENT":g}=u;if(n.some(_=>_.pathwayId===c))return;const A=this.getLevelsForPathway(p).map(_=>{const w=new ue(_.attrs);w["PATHWAY-ID"]=c;const M=w.AUDIO&&`${w.AUDIO}_clone_${c}`,z=w.SUBTITLES&&`${w.SUBTITLES}_clone_${c}`;M&&(a[w.AUDIO]=M,w.AUDIO=M),z&&(o[w.SUBTITLES]=z,w.SUBTITLES=z);const K=Pd(_.uri,w["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",g),Z=new Pr({attrs:w,audioCodec:_.audioCodec,bitrate:_.bitrate,height:_.height,name:_.name,url:K,videoCodec:_.videoCodec,width:_.width});if(_.audioGroups)for(let ne=1;ne<_.audioGroups.length;ne++)Z.addGroupId("audio",`${_.audioGroups[ne]}_clone_${c}`);if(_.subtitleGroups)for(let ne=1;ne<_.subtitleGroups.length;ne++)Z.addGroupId("text",`${_.subtitleGroups[ne]}_clone_${c}`);return Z});n.push(...A),wu(this.audioTracks,a,g,c),wu(this.subtitleTracks,o,g,c)})}loadSteeringManifest(t){const n=this.hls.config,a=n.loader;this.loader&&this.loader.destroy(),this.loader=new a(n);let o;try{o=new self.URL(t)}catch(_){this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${t}`);return}if(o.protocol!=="data:"){const _=(this.hls.bandwidthEstimate||n.abrEwmaDefaultEstimate)|0;o.searchParams.set("_HLS_pathway",this.pathwayId),o.searchParams.set("_HLS_throughput",""+_)}const u={responseType:"json",url:o.href},c=n.steeringManifestLoadPolicy.default,p=c.errorRetry||c.timeoutRetry||{},g={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:p.maxNumRetry||0,retryDelay:p.retryDelayMs||0,maxRetryDelay:p.maxRetryDelayMs||0},A={onSuccess:(_,w,M,z)=>{this.log(`Loaded steering manifest: "${o}"`);const K=_.data;if(K.VERSION!==1){this.log(`Steering VERSION ${K.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=K.TTL;const{"RELOAD-URI":Z,"PATHWAY-CLONES":ne,"PATHWAY-PRIORITY":xe}=K;if(Z)try{this.uri=new self.URL(Z,o).href}catch(Be){this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${Z}`);return}this.scheduleRefresh(this.uri||M.url),ne&&this.clonePathways(ne);const de={steeringManifest:K,url:o.toString()};this.hls.trigger(v.STEERING_MANIFEST_LOADED,de),xe&&this.updatePathwayPriority(xe)},onError:(_,w,M,z)=>{if(this.log(`Error loading steering manifest: ${_.code} ${_.text} (${w.url})`),this.stopLoad(),_.code===410){this.enabled=!1,this.log(`Steering manifest ${w.url} no longer available`);return}let K=this.timeToLoad*1e3;if(_.code===429){const Z=this.loader;if(typeof(Z==null?void 0:Z.getResponseHeader)=="function"){const ne=Z.getResponseHeader("Retry-After");ne&&(K=parseFloat(ne)*1e3)}this.log(`Steering manifest ${w.url} rate limited`);return}this.scheduleRefresh(this.uri||w.url,K)},onTimeout:(_,w,M)=>{this.log(`Timeout loading steering manifest (${w.url})`),this.scheduleRefresh(this.uri||w.url)}};this.log(`Requesting steering manifest: ${o}`),this.loader.load(u,g,A)}scheduleRefresh(t,n=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var a;const o=(a=this.hls)==null?void 0:a.media;if(o&&!o.ended){this.loadSteeringManifest(t);return}this.scheduleRefresh(t,this.timeToLoad*1e3)},n)}}function wu(h,t,n,a){!h||Object.keys(t).forEach(o=>{const u=h.filter(c=>c.groupId===o).map(c=>{const p=re({},c);return p.details=void 0,p.attrs=new ue(p.attrs),p.url=p.attrs.URI=Pd(c.url,c.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",n),p.groupId=p.attrs["GROUP-ID"]=t[o],p.attrs["PATHWAY-ID"]=a,p});h.push(...u)})}function Pd(h,t,n,a){const{HOST:o,PARAMS:u,[n]:c}=a;let p;t&&(p=c==null?void 0:c[t],p&&(h=p));const g=new self.URL(h);return o&&!p&&(g.host=o),u&&Object.keys(u).sort().forEach(A=>{A&&g.searchParams.set(A,u[A])}),g.href}const Od=/^age:\s*[\d.]+\s*$/im;class Lu{constructor(t){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=t&&t.xhrSetup||null,this.stats=new fe,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null,this.stats=null}abortInternal(){const t=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),t&&(t.onreadystatechange=null,t.onprogress=null,t.readyState!==4&&(this.stats.aborted=!0,t.abort()))}abort(){var t;this.abortInternal(),(t=this.callbacks)!=null&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(t,n,a){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=t,this.config=n,this.callbacks=a,this.loadInternal()}loadInternal(){const{config:t,context:n}=this;if(!t||!n)return;const a=this.loader=new self.XMLHttpRequest,o=this.stats;o.loading.first=0,o.loaded=0,o.aborted=!1;const u=this.xhrSetup;u?Promise.resolve().then(()=>{if(!this.stats.aborted)return u(a,n.url)}).catch(c=>(a.open("GET",n.url,!0),u(a,n.url))).then(()=>{this.stats.aborted||this.openAndSendXhr(a,n,t)}).catch(c=>{this.callbacks.onError({code:a.status,text:c.message},n,a,o)}):this.openAndSendXhr(a,n,t)}openAndSendXhr(t,n,a){t.readyState||t.open("GET",n.url,!0);const o=n.headers,{maxTimeToFirstByteMs:u,maxLoadTimeMs:c}=a.loadPolicy;if(o)for(const p in o)t.setRequestHeader(p,o[p]);n.rangeEnd&&t.setRequestHeader("Range","bytes="+n.rangeStart+"-"+(n.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=n.responseType,self.clearTimeout(this.requestTimeout),a.timeout=u&&ie(u)?u:c,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),a.timeout),t.send()}readystatechange(){const{context:t,loader:n,stats:a}=this;if(!t||!n)return;const o=n.readyState,u=this.config;if(!a.aborted&&o>=2&&(a.loading.first===0&&(a.loading.first=Math.max(self.performance.now(),a.loading.start),u.timeout!==u.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),u.timeout=u.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),u.loadPolicy.maxLoadTimeMs-(a.loading.first-a.loading.start)))),o===4)){self.clearTimeout(this.requestTimeout),n.onreadystatechange=null,n.onprogress=null;const c=n.status,p=n.responseType!=="text";if(c>=200&&c<300&&(p&&n.response||n.responseText!==null)){a.loading.end=Math.max(self.performance.now(),a.loading.first);const g=p?n.response:n.responseText,A=n.responseType==="arraybuffer"?g.byteLength:g.length;if(a.loaded=a.total=A,a.bwEstimate=a.total*8e3/(a.loading.end-a.loading.first),!this.callbacks)return;const _=this.callbacks.onProgress;if(_&&_(a,t,g,n),!this.callbacks)return;const w={url:n.responseURL,data:g,code:c};this.callbacks.onSuccess(w,a,t,n)}else{const g=u.loadPolicy.errorRetry,A=a.retry,_={url:t.url,data:void 0,code:c};Ha(g,A,!1,_)?this.retry(g):(S.error(`${c} while loading ${t.url}`),this.callbacks.onError({code:c,text:n.statusText},t,n,a))}}}loadtimeout(){var t;const n=(t=this.config)==null?void 0:t.loadPolicy.timeoutRetry,a=this.stats.retry;if(Ha(n,a,!0))this.retry(n);else{var o;S.warn(`timeout while loading ${(o=this.context)==null?void 0:o.url}`);const u=this.callbacks;u&&(this.abortInternal(),u.onTimeout(this.stats,this.context,this.loader))}}retry(t){const{context:n,stats:a}=this;this.retryDelay=Xr(t,a.retry),a.retry++,S.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${n==null?void 0:n.url}, retrying ${a.retry}/${t.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(t){const n=this.stats;n.loaded=t.loaded,t.lengthComputable&&(n.total=t.total)}getCacheAge(){let t=null;if(this.loader&&Od.test(this.loader.getAllResponseHeaders())){const n=this.loader.getResponseHeader("age");t=n?parseFloat(n):null}return t}getResponseHeader(t){return this.loader&&new RegExp(`^${t}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(t):null}}function Du(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(h){}return!1}const Bd=/(\d+)-(\d+)\/(\d+)/;class ku{constructor(t){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=t.fetchSetup||Ud,this.controller=new self.AbortController,this.stats=new fe}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var t;this.abortInternal(),(t=this.callbacks)!=null&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(t,n,a){const o=this.stats;if(o.loading.start)throw new Error("Loader can only be used once.");o.loading.start=self.performance.now();const u=Md(t,this.controller.signal),c=a.onProgress,p=t.responseType==="arraybuffer",g=p?"byteLength":"length",{maxTimeToFirstByteMs:A,maxLoadTimeMs:_}=n.loadPolicy;this.context=t,this.config=n,this.callbacks=a,this.request=this.fetchSetup(t,u),self.clearTimeout(this.requestTimeout),n.timeout=A&&ie(A)?A:_,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),a.onTimeout(o,t,this.response)},n.timeout),self.fetch(this.request).then(w=>{this.response=this.loader=w;const M=Math.max(self.performance.now(),o.loading.start);if(self.clearTimeout(this.requestTimeout),n.timeout=_,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),a.onTimeout(o,t,this.response)},_-(M-o.loading.start)),!w.ok){const{status:z,statusText:K}=w;throw new jd(K||"fetch, bad network response",z,w)}return o.loading.first=M,o.total=Nd(w.headers)||o.total,c&&ie(n.highWaterMark)?this.loadProgressively(w,o,t,n.highWaterMark,c):p?w.arrayBuffer():t.responseType==="json"?w.json():w.text()}).then(w=>{const M=this.response;if(!M)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),o.loading.end=Math.max(self.performance.now(),o.loading.first);const z=w[g];z&&(o.loaded=o.total=z);const K={url:M.url,data:w,code:M.status};c&&!ie(n.highWaterMark)&&c(o,t,w,M),a.onSuccess(K,o,t,M)}).catch(w=>{if(self.clearTimeout(this.requestTimeout),o.aborted)return;const M=w&&w.code||0,z=w?w.message:null;a.onError({code:M,text:z},t,w?w.details:null,o)})}getCacheAge(){let t=null;if(this.response){const n=this.response.headers.get("age");t=n?parseFloat(n):null}return t}getResponseHeader(t){return this.response?this.response.headers.get(t):null}loadProgressively(t,n,a,o=0,u){const c=new Vn,p=t.body.getReader(),g=()=>p.read().then(A=>{if(A.done)return c.dataLength&&u(n,a,c.flush(),t),Promise.resolve(new ArrayBuffer(0));const _=A.value,w=_.length;return n.loaded+=w,w<o||c.dataLength?(c.push(_),c.dataLength>=o&&u(n,a,c.flush(),t)):u(n,a,_,t),g()}).catch(()=>Promise.reject());return g()}}function Md(h,t){const n={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(re({},h.headers))};return h.rangeEnd&&n.headers.set("Range","bytes="+h.rangeStart+"-"+String(h.rangeEnd-1)),n}function Fd(h){const t=Bd.exec(h);if(t)return parseInt(t[2])-parseInt(t[1])+1}function Nd(h){const t=h.get("Content-Range");if(t){const a=Fd(t);if(ie(a))return a}const n=h.get("Content-Length");if(n)return parseInt(n)}function Ud(h,t){return new self.Request(h.url,t)}class jd extends Error{constructor(t,n,a){super(t);this.code=void 0,this.details=void 0,this.code=n,this.details=a}}const $d=/\s/,Iu={newCue(h,t,n,a){const o=[];let u,c,p,g,A;const _=self.VTTCue||self.TextTrackCue;for(let M=0;M<a.rows.length;M++)if(u=a.rows[M],p=!0,g=0,A="",!u.isEmpty()){var w;for(let Z=0;Z<u.chars.length;Z++)$d.test(u.chars[Z].uchar)&&p?g++:(A+=u.chars[Z].uchar,p=!1);u.cueStartTime=t,t===n&&(n+=1e-4),g>=16?g--:g++;const z=Ts(A.trim()),K=nu(t,n,z);h!=null&&(w=h.cues)!=null&&w.getCueById(K)||(c=new _(t,n,z),c.id=K,c.line=M+1,c.align="left",c.position=10+Math.min(80,Math.floor(g*8/32)*10),o.push(c))}return h&&o.length&&(o.sort((M,z)=>M.line==="auto"||z.line==="auto"?0:M.line>8&&z.line>8?z.line-M.line:M.line-z.line),o.forEach(M=>To(h,M))),o}},Ru={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},Pu=nt(nt({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:Infinity,frontBufferFlushThreshold:Infinity,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:Infinity,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Lu,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:Oo,bufferController:ud,capLevelController:to,errorController:qa,fpsController:io,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:vi,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,useMediaCapabilities:!0,certLoadPolicy:{default:Ru},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:Infinity,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},Zs()),{},{subtitleStreamController:Za,subtitleTrackController:zl,timelineController:ll,audioStreamController:Dc,audioTrackController:ld,emeController:Ca,cmcdController:Id,contentSteeringController:Rd});function Zs(){return{cueHandler:Iu,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function Vd(h,t){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(t.liveMaxLatencyDurationCount!==void 0&&(t.liveSyncDurationCount===void 0||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(t.liveMaxLatencyDuration!==void 0&&(t.liveSyncDuration===void 0||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const n=Ou(h),a=["manifest","level","frag"],o=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return a.forEach(u=>{const c=`${u==="level"?"playlist":u}LoadPolicy`,p=t[c]===void 0,g=[];o.forEach(A=>{const _=`${u}Loading${A}`,w=t[_];if(w!==void 0&&p){g.push(_);const M=n[c].default;switch(t[c]={default:M},A){case"TimeOut":M.maxLoadTimeMs=w,M.maxTimeToFirstByteMs=w;break;case"MaxRetry":M.errorRetry.maxNumRetry=w,M.timeoutRetry.maxNumRetry=w;break;case"RetryDelay":M.errorRetry.retryDelayMs=w,M.timeoutRetry.retryDelayMs=w;break;case"MaxRetryTimeout":M.errorRetry.maxRetryDelayMs=w,M.timeoutRetry.maxRetryDelayMs=w;break}}}),g.length&&S.warn(`hls.js config: "${g.join('", "')}" setting(s) are deprecated, use "${c}": ${JSON.stringify(t[c])}`)}),nt(nt({},n),t)}function Ou(h){return h&&typeof h=="object"?Array.isArray(h)?h.map(Ou):Object.keys(h).reduce((t,n)=>(t[n]=Ou(h[n]),t),{}):h}function zc(h){const t=h.loader;t!==ku&&t!==Lu?(S.log("[config]: Custom loader detected, cannot enable progressive streaming"),h.progressive=!1):Du()&&(h.loader=ku,h.progressive=!0,h.enableSoftwareAES=!0,S.log("[config]: Progressive streaming enabled, using FetchLoader"))}let Bu;class Yc extends Ka{constructor(t,n){super(t,"[level-controller]");this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=n,this._registerListeners()}_registerListeners(){const{hls:t}=this;t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(v.LEVEL_LOADED,this.onLevelLoaded,this),t.on(v.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(v.FRAG_BUFFERED,this.onFragBuffered,this),t.on(v.ERROR,this.onError,this)}_unregisterListeners(){const{hls:t}=this;t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(v.LEVEL_LOADED,this.onLevelLoaded,this),t.off(v.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(v.FRAG_BUFFERED,this.onFragBuffered,this),t.off(v.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(n=>{n.loadError=0,n.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(t,n){this.resetLevels()}onManifestLoaded(t,n){const a=this.hls.config.preferManagedMediaSource,o=[],u={},c={};let p=!1,g=!1,A=!1;n.levels.forEach(_=>{var w,M;const z=_.attrs;let{audioCodec:K,videoCodec:Z}=_;((w=K)==null?void 0:w.indexOf("mp4a.40.34"))!==-1&&(Bu||(Bu=/chrome|firefox/i.test(navigator.userAgent)),Bu&&(_.audioCodec=K=void 0)),K&&(_.audioCodec=K=Ir(K,a)),((M=Z)==null?void 0:M.indexOf("avc1"))===0&&(Z=_.videoCodec=Eo(Z));const{width:ne,height:xe,unknownCodecs:de}=_;if(p||(p=!!(ne&&xe)),g||(g=!!Z),A||(A=!!K),de!=null&&de.length||K&&!Ra(K,"audio",a)||Z&&!Ra(Z,"video",a))return;const{CODECS:Be,"FRAME-RATE":Qe,"HDCP-LEVEL":Ne,"PATHWAY-ID":lt,RESOLUTION:Xe,"VIDEO-RANGE":ct}=z,et=`${`${lt||"."}-`}${_.bitrate}-${Xe}-${Qe}-${Be}-${ct}-${Ne}`;if(u[et])if(u[et].uri!==_.url&&!_.attrs["PATHWAY-ID"]){const st=c[et]+=1;_.attrs["PATHWAY-ID"]=new Array(st+1).join(".");const Ht=new Pr(_);u[et]=Ht,o.push(Ht)}else u[et].addGroupId("audio",z.AUDIO),u[et].addGroupId("text",z.SUBTITLES);else{const st=new Pr(_);u[et]=st,c[et]=1,o.push(st)}}),this.filterAndSortMediaOptions(o,n,p,g,A)}filterAndSortMediaOptions(t,n,a,o,u){let c=[],p=[],g=t;if((a||o)&&u&&(g=g.filter(({videoCodec:K,videoRange:Z,width:ne,height:xe})=>(!!K||!!(ne&&xe))&&nd(Z))),g.length===0){Promise.resolve().then(()=>{if(this.hls){n.levels.length&&this.warn(`One or more CODECS in variant not supported: ${JSON.stringify(n.levels[0].attrs)}`);const K=new Error("no level with compatible codecs found in manifest");this.hls.trigger(v.ERROR,{type:$.MEDIA_ERROR,details:I.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:n.url,error:K,reason:K.message})}});return}if(n.audioTracks){const{preferManagedMediaSource:K}=this.hls.config;c=n.audioTracks.filter(Z=>!Z.audioCodec||Ra(Z.audioCodec,"audio",K)),Gd(c)}n.subtitles&&(p=n.subtitles,Gd(p));const A=g.slice(0);g.sort((K,Z)=>{if(K.attrs["HDCP-LEVEL"]!==Z.attrs["HDCP-LEVEL"])return(K.attrs["HDCP-LEVEL"]||"")>(Z.attrs["HDCP-LEVEL"]||"")?1:-1;if(a&&K.height!==Z.height)return K.height-Z.height;if(K.frameRate!==Z.frameRate)return K.frameRate-Z.frameRate;if(K.videoRange!==Z.videoRange)return $a.indexOf(K.videoRange)-$a.indexOf(Z.videoRange);if(K.videoCodec!==Z.videoCodec){const ne=aa(K.videoCodec),xe=aa(Z.videoCodec);if(ne!==xe)return xe-ne}if(K.uri===Z.uri&&K.codecSet!==Z.codecSet){const ne=cs(K.codecSet),xe=cs(Z.codecSet);if(ne!==xe)return xe-ne}return K.averageBitrate!==Z.averageBitrate?K.averageBitrate-Z.averageBitrate:0});let _=A[0];if(this.steering&&(g=this.steering.filterParsedLevels(g),g.length!==A.length)){for(let K=0;K<A.length;K++)if(A[K].pathwayId===g[0].pathwayId){_=A[K];break}}this._levels=g;for(let K=0;K<g.length;K++)if(g[K]===_){var w;this._firstLevel=K;const Z=_.bitrate,ne=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${g.length} level(s) found, first bitrate: ${Z}`),((w=this.hls.userConfig)==null?void 0:w.abrEwmaDefaultEstimate)===void 0){const xe=Math.min(Z,this.hls.config.abrEwmaDefaultEstimateMax);xe>ne&&ne===Pu.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=xe)}break}const M=u&&!o,z={levels:g,audioTracks:c,subtitleTracks:p,sessionData:n.sessionData,sessionKeys:n.sessionKeys,firstLevel:this._firstLevel,stats:n.stats,audio:u,video:o,altAudio:!M&&c.some(K=>!!K.url)};this.hls.trigger(v.MANIFEST_PARSED,z),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return this._levels.length===0?null:this._levels}get level(){return this.currentLevelIndex}set level(t){const n=this._levels;if(n.length===0)return;if(t<0||t>=n.length){const _=new Error("invalid level idx"),w=t<0;if(this.hls.trigger(v.ERROR,{type:$.OTHER_ERROR,details:I.LEVEL_SWITCH_ERROR,level:t,fatal:w,error:_,reason:_.message}),w)return;t=Math.min(t,n.length-1)}const a=this.currentLevelIndex,o=this.currentLevel,u=o?o.attrs["PATHWAY-ID"]:void 0,c=n[t],p=c.attrs["PATHWAY-ID"];if(this.currentLevelIndex=t,this.currentLevel=c,a===t&&c.details&&o&&u===p)return;this.log(`Switching to level ${t} (${c.height?c.height+"p ":""}${c.videoRange?c.videoRange+" ":""}${c.codecSet?c.codecSet+" ":""}@${c.bitrate})${p?" with Pathway "+p:""} from level ${a}${u?" with Pathway "+u:""}`);const g={level:t,attrs:c.attrs,details:c.details,bitrate:c.bitrate,averageBitrate:c.averageBitrate,maxBitrate:c.maxBitrate,realBitrate:c.realBitrate,width:c.width,height:c.height,codecSet:c.codecSet,audioCodec:c.audioCodec,videoCodec:c.videoCodec,audioGroups:c.audioGroups,subtitleGroups:c.subtitleGroups,loaded:c.loaded,loadError:c.loadError,fragmentError:c.fragmentError,name:c.name,id:c.id,uri:c.uri,url:c.url,urlId:0,audioGroupIds:c.audioGroupIds,textGroupIds:c.textGroupIds};this.hls.trigger(v.LEVEL_SWITCHING,g);const A=c.details;if(!A||A.live){const _=this.switchParams(c.uri,o==null?void 0:o.details);this.loadPlaylist(_)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(t){this.manualLevelIndex=t,this._startLevel===void 0&&(this._startLevel=t),t!==-1&&(this.level=t)}get firstLevel(){return this._firstLevel}set firstLevel(t){this._firstLevel=t}get startLevel(){if(this._startLevel===void 0){const t=this.hls.config.startLevel;return t!==void 0?t:this.hls.firstAutoLevel}return this._startLevel}set startLevel(t){this._startLevel=t}onError(t,n){n.fatal||!n.context||n.context.type===di.LEVEL&&n.context.level===this.level&&this.checkRetry(n)}onFragBuffered(t,{frag:n}){if(n!==void 0&&n.type===Wt.MAIN){const a=n.elementaryStreams;if(!Object.keys(a).some(u=>!!a[u]))return;const o=this._levels[n.level];o!=null&&o.loadError&&(this.log(`Resetting level error count of ${o.loadError} on frag buffered`),o.loadError=0)}}onLevelLoaded(t,n){var a;const{level:o,details:u}=n,c=this._levels[o];if(!c){var p;this.warn(`Invalid level index ${o}`),(p=n.deliveryDirectives)!=null&&p.skip&&(u.deltaUpdateFailed=!0);return}o===this.currentLevelIndex?(c.fragmentError===0&&(c.loadError=0),this.playlistLoaded(o,n,c.details)):(a=n.deliveryDirectives)!=null&&a.skip&&(u.deltaUpdateFailed=!0)}loadPlaylist(t){super.loadPlaylist();const n=this.currentLevelIndex,a=this.currentLevel;if(a&&this.shouldLoadPlaylist(a)){let o=a.uri;if(t)try{o=t.addDirectives(o)}catch(c){this.warn(`Could not construct new URL with HLS Delivery Directives: ${c}`)}const u=a.attrs["PATHWAY-ID"];this.log(`Loading level index ${n}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""} with${u?" Pathway "+u:""} ${o}`),this.clearTimer(),this.hls.trigger(v.LEVEL_LOADING,{url:o,level:n,pathwayId:a.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(t){this.level=t,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=t)}removeLevel(t){var n;const a=this._levels.filter((o,u)=>u!==t?!0:(this.steering&&this.steering.removeLevel(o),o===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,o.details&&o.details.fragments.forEach(c=>c.level=-1)),!1));Rn(a),this._levels=a,this.currentLevelIndex>-1&&(n=this.currentLevel)!=null&&n.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.hls.trigger(v.LEVELS_UPDATED,{levels:a})}onLevelsUpdated(t,{levels:n}){this._levels=n}checkMaxAutoUpdated(){const{autoLevelCapping:t,maxAutoLevel:n,maxHdcpLevel:a}=this.hls;this._maxAutoLevel!==n&&(this._maxAutoLevel=n,this.hls.trigger(v.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:t,levels:this.levels,maxAutoLevel:n,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:a}))}}function Gd(h){const t={};h.forEach(n=>{const a=n.groupId||"";n.id=t[a]=t[a]||0,t[a]++})}class Xc{constructor(t){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=t}abort(t){for(const a in this.keyUriToKeyInfo){const o=this.keyUriToKeyInfo[a].loader;if(o){var n;if(t&&t!==((n=o.context)==null?void 0:n.frag.type))return;o.abort()}}}detach(){for(const t in this.keyUriToKeyInfo){const n=this.keyUriToKeyInfo[t];(n.mediaKeySessionContext||n.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[t]}}destroy(){this.detach();for(const t in this.keyUriToKeyInfo){const n=this.keyUriToKeyInfo[t].loader;n&&n.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(t,n=I.KEY_LOAD_ERROR,a,o,u){return new Bn({type:$.NETWORK_ERROR,details:n,fatal:!1,frag:t,response:u,error:a,networkDetails:o})}loadClear(t,n){if(this.emeController&&this.config.emeEnabled){const{sn:a,cc:o}=t;for(let u=0;u<n.length;u++){const c=n[u];if(o<=c.cc&&(a==="initSegment"||c.sn==="initSegment"||a<c.sn)){this.emeController.selectKeySystemFormat(c).then(p=>{c.setKeyFormat(p)});break}}}}load(t){return!t.decryptdata&&t.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(t).then(n=>this.loadInternal(t,n)):this.loadInternal(t)}loadInternal(t,n){var a,o;n&&t.setKeyFormat(n);const u=t.decryptdata;if(!u){const A=new Error(n?`Expected frag.decryptdata to be defined after setting format ${n}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(t,I.KEY_LOAD_ERROR,A))}const c=u.uri;if(!c)return Promise.reject(this.createKeyLoadError(t,I.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${c}"`)));let p=this.keyUriToKeyInfo[c];if((a=p)!=null&&a.decryptdata.key)return u.key=p.decryptdata.key,Promise.resolve({frag:t,keyInfo:p});if((o=p)!=null&&o.keyLoadPromise){var g;switch((g=p.mediaKeySessionContext)==null?void 0:g.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return p.keyLoadPromise.then(A=>(u.key=A.keyInfo.decryptdata.key,{frag:t,keyInfo:p}))}}switch(p=this.keyUriToKeyInfo[c]={decryptdata:u,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},u.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return u.keyFormat==="identity"?this.loadKeyHTTP(p,t):this.loadKeyEME(p,t);case"AES-128":return this.loadKeyHTTP(p,t);default:return Promise.reject(this.createKeyLoadError(t,I.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${u.method}"`)))}}loadKeyEME(t,n){const a={frag:n,keyInfo:t};if(this.emeController&&this.config.emeEnabled){const o=this.emeController.loadKey(a);if(o)return(t.keyLoadPromise=o.then(u=>(t.mediaKeySessionContext=u,a))).catch(u=>{throw t.keyLoadPromise=null,u})}return Promise.resolve(a)}loadKeyHTTP(t,n){const a=this.config,o=a.loader,u=new o(a);return n.keyLoader=t.loader=u,t.keyLoadPromise=new Promise((c,p)=>{const g={keyInfo:t,frag:n,responseType:"arraybuffer",url:t.decryptdata.uri},A=a.keyLoadPolicy.default,_={loadPolicy:A,timeout:A.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},w={onSuccess:(M,z,K,Z)=>{const{frag:ne,keyInfo:xe,url:de}=K;if(!ne.decryptdata||xe!==this.keyUriToKeyInfo[de])return p(this.createKeyLoadError(ne,I.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),Z));xe.decryptdata.key=ne.decryptdata.key=new Uint8Array(M.data),ne.keyLoader=null,xe.loader=null,c({frag:ne,keyInfo:xe})},onError:(M,z,K,Z)=>{this.resetLoader(z),p(this.createKeyLoadError(n,I.KEY_LOAD_ERROR,new Error(`HTTP Error ${M.code} loading key ${M.text}`),K,nt({url:g.url,data:void 0},M)))},onTimeout:(M,z,K)=>{this.resetLoader(z),p(this.createKeyLoadError(n,I.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),K))},onAbort:(M,z,K)=>{this.resetLoader(z),p(this.createKeyLoadError(n,I.INTERNAL_ABORTED,new Error("key loading aborted"),K))}};u.load(g,_,w)})}resetLoader(t){const{frag:n,keyInfo:a,url:o}=t,u=a.loader;n.keyLoader===u&&(n.keyLoader=null,a.loader=null),delete this.keyUriToKeyInfo[o],u&&u.destroy()}}function Hd(){return self.SourceBuffer||self.WebKitSourceBuffer}function yl(){if(!fr())return!1;const t=Hd();return!t||t.prototype&&typeof t.prototype.appendBuffer=="function"&&typeof t.prototype.remove=="function"}function Qc(){if(!yl())return!1;const h=fr();return typeof(h==null?void 0:h.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(t=>h.isTypeSupported(ds(t,"video")))||["mp4a.40.2","fLaC"].some(t=>h.isTypeSupported(ds(t,"audio"))))}function qd(){var h;const t=Hd();return typeof(t==null||(h=t.prototype)==null?void 0:h.changeType)=="function"}const Jc=250,oo=2,Zc=.1,eh=.05;class th{constructor(t,n,a,o){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=t,this.media=n,this.fragmentTracker=a,this.hls=o}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(t,n){const{config:a,media:o,stalled:u}=this;if(o===null)return;const{currentTime:c,seeking:p}=o,g=this.seeking&&!p,A=!this.seeking&&p;if(this.seeking=p,c!==t){if(this.moved=!0,p||(this.nudgeRetry=0),u!==null){if(this.stallReported){const ne=self.performance.now()-u;S.warn(`playback not stuck anymore @${c}, after ${Math.round(ne)}ms`),this.stallReported=!1}this.stalled=null}return}if(A||g){this.stalled=null;return}if(o.paused&&!p||o.ended||o.playbackRate===0||!_i.getBuffered(o).length){this.nudgeRetry=0;return}const _=_i.bufferInfo(o,c,0),w=_.nextStart||0;if(p){const ne=_.len>oo,xe=!w||n&&n.start<=c||w-c>oo&&!this.fragmentTracker.getPartialFragment(c);if(ne||xe)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var M;if(!(_.len>0)&&!w)return;const xe=Math.max(w,_.start||0)-c,de=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,Qe=(de==null||(M=de.details)==null?void 0:M.live)?de.details.targetduration*2:oo,Ne=this.fragmentTracker.getPartialFragment(c);if(xe>0&&(xe<=Qe||Ne)){o.paused||this._trySkipBufferHole(Ne);return}}const z=self.performance.now();if(u===null){this.stalled=z;return}const K=z-u;if(!p&&K>=Jc&&(this._reportStall(_),!this.media))return;const Z=_i.bufferInfo(o,c,a.maxBufferHole);this._tryFixBufferStall(Z,K)}_tryFixBufferStall(t,n){const{config:a,fragmentTracker:o,media:u}=this;if(u===null)return;const c=u.currentTime,p=o.getPartialFragment(c);p&&(this._trySkipBufferHole(p)||!this.media)||(t.len>a.maxBufferHole||t.nextStart&&t.nextStart-c<a.maxBufferHole)&&n>a.highBufferWatchdogPeriod*1e3&&(S.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(t){const{hls:n,media:a,stallReported:o}=this;if(!o&&a){this.stallReported=!0;const u=new Error(`Playback stalling at @${a.currentTime} due to low buffer (${JSON.stringify(t)})`);S.warn(u.message),n.trigger(v.ERROR,{type:$.MEDIA_ERROR,details:I.BUFFER_STALLED_ERROR,fatal:!1,error:u,buffer:t.len})}}_trySkipBufferHole(t){const{config:n,hls:a,media:o}=this;if(o===null)return 0;const u=o.currentTime,c=_i.bufferInfo(o,u,0),p=u<c.start?c.start:c.nextStart;if(p){const g=c.len<=n.maxBufferHole,A=c.len>0&&c.len<1&&o.readyState<3,_=p-u;if(_>0&&(g||A)){if(_>n.maxBufferHole){const{fragmentTracker:M}=this;let z=!1;if(u===0){const K=M.getAppendedFrag(0,Wt.MAIN);K&&p<K.end&&(z=!0)}if(!z){const K=t||M.getAppendedFrag(u,Wt.MAIN);if(K){let Z=!1,ne=K.end;for(;ne<p;){const xe=M.getPartialFragment(ne);if(xe)ne+=xe.duration;else{Z=!0;break}}if(Z)return 0}}}const w=Math.max(p+eh,u+Zc);if(S.warn(`skipping hole, adjusting currentTime from ${u} to ${w}`),this.moved=!0,this.stalled=null,o.currentTime=w,t&&!t.gap){const M=new Error(`fragment loaded with buffer holes, seeking from ${u} to ${w}`);a.trigger(v.ERROR,{type:$.MEDIA_ERROR,details:I.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:M,reason:M.message,frag:t})}return w}}return 0}_tryNudgeBuffer(){const{config:t,hls:n,media:a,nudgeRetry:o}=this;if(a===null)return;const u=a.currentTime;if(this.nudgeRetry++,o<t.nudgeMaxRetry){const c=u+(o+1)*t.nudgeOffset,p=new Error(`Nudging 'currentTime' from ${u} to ${c}`);S.warn(p.message),a.currentTime=c,n.trigger(v.ERROR,{type:$.MEDIA_ERROR,details:I.BUFFER_NUDGE_ON_STALL,error:p,fatal:!1})}else{const c=new Error(`Playhead still not moving while enough data buffered @${u} after ${t.nudgeMaxRetry} nudges`);S.error(c.message),n.trigger(v.ERROR,{type:$.MEDIA_ERROR,details:I.BUFFER_STALLED_ERROR,error:c,fatal:!0})}}}const Pt=100;class Kd extends Ur{constructor(t,n,a){super(t,n,a,"[stream-controller]",Wt.MAIN);this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:t}=this;t.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(v.MANIFEST_LOADING,this.onManifestLoading,this),t.on(v.MANIFEST_PARSED,this.onManifestParsed,this),t.on(v.LEVEL_LOADING,this.onLevelLoading,this),t.on(v.LEVEL_LOADED,this.onLevelLoaded,this),t.on(v.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.on(v.ERROR,this.onError,this),t.on(v.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(v.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.on(v.BUFFER_CREATED,this.onBufferCreated,this),t.on(v.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(v.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(v.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:t}=this;t.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(v.MANIFEST_LOADING,this.onManifestLoading,this),t.off(v.MANIFEST_PARSED,this.onManifestParsed,this),t.off(v.LEVEL_LOADED,this.onLevelLoaded,this),t.off(v.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.off(v.ERROR,this.onError,this),t.off(v.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(v.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.off(v.BUFFER_CREATED,this.onBufferCreated,this),t.off(v.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(v.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(v.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying()}startLoad(t){if(this.levels){const{lastCurrentTime:n,hls:a}=this;if(this.stopLoad(),this.setInterval(Pt),this.level=-1,!this.startFragRequested){let o=a.startLevel;o===-1&&(a.config.testBandwidth&&this.levels.length>1?(o=0,this.bitrateTest=!0):o=a.firstAutoLevel),a.nextLoadLevel=o,this.level=a.loadLevel,this.loadedmetadata=!1}n>0&&t===-1&&(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),t=n),this.state=ot.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}else this._forceStartLoad=!0,this.state=ot.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case ot.WAITING_LEVEL:{const{levels:n,level:a}=this,o=n==null?void 0:n[a],u=o==null?void 0:o.details;if(u&&(!u.live||this.levelLastLoaded===o)){if(this.waitForCdnTuneIn(u))break;this.state=ot.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=ot.IDLE;break}break}case ot.FRAG_LOADING_WAITING_RETRY:{var t;const n=self.performance.now(),a=this.retryDate;if(!a||n>=a||(t=this.media)!=null&&t.seeking){const{levels:o,level:u}=this,c=o==null?void 0:o[u];this.resetStartWhenNotLoaded(c||null),this.state=ot.IDLE}}break}this.state===ot.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:t,levelLastLoaded:n,levels:a,media:o}=this;if(n===null||!o&&(this.startFragRequested||!t.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const u=t.nextLoadLevel;if(!(a!=null&&a[u]))return;const c=a[u],p=this.getMainFwdBufferInfo();if(p===null)return;const g=this.getLevelDetails();if(g&&this._streamEnded(p,g)){const Z={};this.altAudio&&(Z.type="video"),this.hls.trigger(v.BUFFER_EOS,Z),this.state=ot.ENDED;return}t.loadLevel!==u&&t.manualLevel===-1&&this.log(`Adapting to level ${u} from level ${this.level}`),this.level=t.nextLoadLevel=u;const A=c.details;if(!A||this.state===ot.WAITING_LEVEL||A.live&&this.levelLastLoaded!==c){this.level=u,this.state=ot.WAITING_LEVEL;return}const _=p.len,w=this.getMaxBufferLength(c.maxBitrate);if(_>=w)return;this.backtrackFragment&&this.backtrackFragment.start>p.end&&(this.backtrackFragment=null);const M=this.backtrackFragment?this.backtrackFragment.start:p.end;let z=this.getNextFragment(M,A);if(this.couldBacktrack&&!this.fragPrevious&&z&&z.sn!=="initSegment"&&this.fragmentTracker.getState(z)!==Ui.OK){var K;const ne=((K=this.backtrackFragment)!=null?K:z).sn-A.startSN,xe=A.fragments[ne-1];xe&&z.cc===xe.cc&&(z=xe,this.fragmentTracker.removeFragment(xe))}else this.backtrackFragment&&p.len&&(this.backtrackFragment=null);if(z&&this.isLoopLoading(z,M)){if(!z.gap){const ne=this.audioOnly&&!this.altAudio?Ae.AUDIO:Ae.VIDEO,xe=(ne===Ae.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;xe&&this.afterBufferFlushed(xe,ne,Wt.MAIN)}z=this.getNextFragmentLoopLoading(z,A,p,Wt.MAIN,w)}!z||(z.initSegment&&!z.initSegment.data&&!this.bitrateTest&&(z=z.initSegment),this.loadFragment(z,c,M))}loadFragment(t,n,a){const o=this.fragmentTracker.getState(t);this.fragCurrent=t,o===Ui.NOT_LOADED||o===Ui.PARTIAL?t.sn==="initSegment"?this._loadInitSegment(t,n):this.bitrateTest?(this.log(`Fragment ${t.sn} of level ${t.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(t,n)):(this.startFragRequested=!0,super.loadFragment(t,n,a)):this.clearTrackerIfNeeded(t)}getBufferedFrag(t){return this.fragmentTracker.getBufferedFrag(t,Wt.MAIN)}followingBufferedFrag(t){return t?this.getBufferedFrag(t.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:t,media:n}=this;if(n!=null&&n.readyState){let a;const o=this.getAppendedFrag(n.currentTime);o&&o.start>1&&this.flushMainBuffer(0,o.start-1);const u=this.getLevelDetails();if(u!=null&&u.live){const p=this.getMainFwdBufferInfo();if(!p||p.len<u.targetduration*2)return}if(!n.paused&&t){const p=this.hls.nextLoadLevel,g=t[p],A=this.fragLastKbps;A&&this.fragCurrent?a=this.fragCurrent.duration*g.maxBitrate/(1e3*A)+1:a=0}else a=0;const c=this.getBufferedFrag(n.currentTime+a);if(c){const p=this.followingBufferedFrag(c);if(p){this.abortCurrentFrag();const g=p.maxStartPTS?p.maxStartPTS:p.start,A=p.duration,_=Math.max(c.end,g+Math.min(Math.max(A-this.config.maxFragLookUpTolerance,A*(this.couldBacktrack?.5:.125)),A*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(_,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const t=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,t&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.state){case ot.KEY_LOADING:case ot.FRAG_LOADING:case ot.FRAG_LOADING_WAITING_RETRY:case ot.PARSING:case ot.PARSED:this.state=ot.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(t,n){super.flushMainBuffer(t,n,this.altAudio?"video":null)}onMediaAttached(t,n){super.onMediaAttached(t,n);const a=n.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),a.addEventListener("playing",this.onvplaying),a.addEventListener("seeked",this.onvseeked),this.gapController=new th(this.config,a,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:t}=this;t&&this.onvplaying&&this.onvseeked&&(t.removeEventListener("playing",this.onvplaying),t.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const t=this.media,n=t?t.currentTime:null;ie(n)&&this.log(`Media seeked to ${n.toFixed(3)}`);const a=this.getMainFwdBufferInfo();if(a===null||a.len===0){this.warn(`Main forward buffer length on "seeked" event ${a?a.len:"empty"})`);return}this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(v.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=this.fragLastKbps=0,this.levels=this.fragPlaying=this.backtrackFragment=this.levelLastLoaded=null,this.altAudio=this.audioOnly=this.startFragRequested=!1}onManifestParsed(t,n){let a=!1,o=!1;n.levels.forEach(u=>{const c=u.audioCodec;c&&(a=a||c.indexOf("mp4a.40.2")!==-1,o=o||c.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=a&&o&&!qd(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=n.levels,this.startFragRequested=!1}onLevelLoading(t,n){const{levels:a}=this;if(!a||this.state!==ot.IDLE)return;const o=a[n.level];(!o.details||o.details.live&&this.levelLastLoaded!==o||this.waitForCdnTuneIn(o.details))&&(this.state=ot.WAITING_LEVEL)}onLevelLoaded(t,n){var a;const{levels:o}=this,u=n.level,c=n.details,p=c.totalduration;if(!o){this.warn(`Levels were reset while loading level ${u}`);return}this.log(`Level ${u} loaded [${c.startSN},${c.endSN}]${c.lastPartSn?`[part-${c.lastPartSn}-${c.lastPartIndex}]`:""}, cc [${c.startCC}, ${c.endCC}] duration:${p}`);const g=o[u],A=this.fragCurrent;A&&(this.state===ot.FRAG_LOADING||this.state===ot.FRAG_LOADING_WAITING_RETRY)&&A.level!==n.level&&A.loader&&this.abortCurrentFrag();let _=0;if(c.live||(a=g.details)!=null&&a.live){var w;if(this.checkLiveUpdate(c),c.deltaUpdateFailed)return;_=this.alignPlaylists(c,g.details,(w=this.levelLastLoaded)==null?void 0:w.details)}if(g.details=c,this.levelLastLoaded=g,this.hls.trigger(v.LEVEL_UPDATED,{details:c,level:u}),this.state===ot.WAITING_LEVEL){if(this.waitForCdnTuneIn(c))return;this.state=ot.IDLE}this.startFragRequested?c.live&&this.synchronizeToLiveEdge(c):this.setStartPosition(c,_),this.tick()}_handleFragmentLoadProgress(t){var n;const{frag:a,part:o,payload:u}=t,{levels:c}=this;if(!c){this.warn(`Levels were reset while fragment load was in progress. Fragment ${a.sn} of level ${a.level} will not be buffered`);return}const p=c[a.level],g=p.details;if(!g){this.warn(`Dropping fragment ${a.sn} of level ${a.level} after level details were reset`),this.fragmentTracker.removeFragment(a);return}const A=p.videoCodec,_=g.PTSKnown||!g.live,w=(n=a.initSegment)==null?void 0:n.data,M=this._getAudioCodec(p),z=this.transmuxer=this.transmuxer||new Wl(this.hls,Wt.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),K=o?o.index:-1,Z=K!==-1,ne=new za(a.level,a.sn,a.stats.chunkCount,u.byteLength,K,Z),xe=this.initPTS[a.cc];z.push(u,w,M,A,a,o,g.totalduration,_,ne,xe)}onAudioTrackSwitching(t,n){const a=this.altAudio;if(!!!n.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const c=this.fragCurrent;c&&(this.log("Switching to main audio track, cancel main fragment load"),c.abortRequests(),this.fragmentTracker.removeFragment(c)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const u=this.hls;a&&(u.trigger(v.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),u.trigger(v.AUDIO_TRACK_SWITCHED,n)}}onAudioTrackSwitched(t,n){const a=n.id,o=!!this.hls.audioTracks[a].url;if(o){const u=this.videoBuffer;u&&this.mediaBuffer!==u&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=u)}this.altAudio=o,this.tick()}onBufferCreated(t,n){const a=n.tracks;let o,u,c=!1;for(const p in a){const g=a[p];if(g.id==="main"){if(u=p,o=g,p==="video"){const A=a[p];A&&(this.videoBuffer=A.buffer)}}else c=!0}c&&o?(this.log(`Alternate track found, use ${u}.buffered to schedule main fragment loading`),this.mediaBuffer=o.buffer):this.mediaBuffer=this.media}onFragBuffered(t,n){const{frag:a,part:o}=n;if(a&&a.type!==Wt.MAIN)return;if(this.fragContextChanged(a)){this.warn(`Fragment ${a.sn}${o?" p: "+o.index:""} of level ${a.level} finished buffering, but was aborted. state: ${this.state}`),this.state===ot.PARSED&&(this.state=ot.IDLE);return}const u=o?o.stats:a.stats;this.fragLastKbps=Math.round(8*u.total/(u.buffering.end-u.loading.first)),a.sn!=="initSegment"&&(this.fragPrevious=a),this.fragBufferedComplete(a,o)}onError(t,n){var a;if(n.fatal){this.state=ot.ERROR;return}switch(n.details){case I.FRAG_GAP:case I.FRAG_PARSING_ERROR:case I.FRAG_DECRYPT_ERROR:case I.FRAG_LOAD_ERROR:case I.FRAG_LOAD_TIMEOUT:case I.KEY_LOAD_ERROR:case I.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Wt.MAIN,n);break;case I.LEVEL_LOAD_ERROR:case I.LEVEL_LOAD_TIMEOUT:case I.LEVEL_PARSING_ERROR:!n.levelRetry&&this.state===ot.WAITING_LEVEL&&((a=n.context)==null?void 0:a.type)===di.LEVEL&&(this.state=ot.IDLE);break;case I.BUFFER_APPEND_ERROR:case I.BUFFER_FULL_ERROR:if(!n.parent||n.parent!=="main")return;if(n.details===I.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(n)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case I.INTERNAL_EXCEPTION:this.recoverWorkerError(n);break}}checkBuffer(){const{media:t,gapController:n}=this;if(!(!t||!n||!t.readyState)){if(this.loadedmetadata||!_i.getBuffered(t).length){const a=this.state!==ot.IDLE?this.fragCurrent:null;n.poll(this.lastCurrentTime,a)}this.lastCurrentTime=t.currentTime}}onFragLoadEmergencyAborted(){this.state=ot.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(t,{type:n}){if(n!==Ae.AUDIO||this.audioOnly&&!this.altAudio){const a=(n===Ae.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(a,n,Wt.MAIN),this.tick()}}onLevelsUpdated(t,n){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level),this.levels=n.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:t}=this;if(!t)return;const n=t.currentTime;let a=this.startPosition;if(a>=0&&n<a){if(t.seeking){this.log(`could not seek to ${a}, already seeking at ${n}`);return}const o=_i.getBuffered(t),c=(o.length?o.start(0):0)-a;c>0&&(c<this.config.maxBufferHole||c<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${c} to match buffer start`),a+=c,this.startPosition=a),this.log(`seek to target start position ${a} from current time ${n}`),t.currentTime=a}}_getAudioCodec(t){let n=this.config.defaultAudioCodec||t.audioCodec;return this.audioCodecSwap&&n&&(this.log("Swapping audio codec"),n.indexOf("mp4a.40.5")!==-1?n="mp4a.40.2":n="mp4a.40.5"),n}_loadBitrateTestFrag(t,n){t.bitrateTest=!0,this._doFragLoad(t,n).then(a=>{const{hls:o}=this;if(!a||this.fragContextChanged(t))return;n.fragmentError=0,this.state=ot.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const u=t.stats;u.parsing.start=u.parsing.end=u.buffering.start=u.buffering.end=self.performance.now(),o.trigger(v.FRAG_LOADED,a),t.bitrateTest=!1})}_handleTransmuxComplete(t){var n;const a="main",{hls:o}=this,{remuxResult:u,chunkMeta:c}=t,p=this.getCurrentContext(c);if(!p){this.resetWhenMissingContext(c);return}const{frag:g,part:A,level:_}=p,{video:w,text:M,id3:z,initSegment:K}=u,{details:Z}=_,ne=this.altAudio?void 0:u.audio;if(this.fragContextChanged(g)){this.fragmentTracker.removeFragment(g);return}if(this.state=ot.PARSING,K){if(K!=null&&K.tracks){const Be=g.initSegment||g;this._bufferInitSegment(_,K.tracks,Be,c),o.trigger(v.FRAG_PARSING_INIT_SEGMENT,{frag:Be,id:a,tracks:K.tracks})}const xe=K.initPTS,de=K.timescale;ie(xe)&&(this.initPTS[g.cc]={baseTime:xe,timescale:de},o.trigger(v.INIT_PTS_FOUND,{frag:g,id:a,initPTS:xe,timescale:de}))}if(w&&Z&&g.sn!=="initSegment"){const xe=Z.fragments[g.sn-1-Z.startSN],de=g.sn===Z.startSN,Be=!xe||g.cc>xe.cc;if(u.independent!==!1){const{startPTS:Qe,endPTS:Ne,startDTS:lt,endDTS:Xe}=w;if(A)A.elementaryStreams[w.type]={startPTS:Qe,endPTS:Ne,startDTS:lt,endDTS:Xe};else if(w.firstKeyFrame&&w.independent&&c.id===1&&!Be&&(this.couldBacktrack=!0),w.dropped&&w.independent){const ct=this.getMainFwdBufferInfo(),Lt=(ct?ct.end:this.getLoadPosition())+this.config.maxBufferHole,et=w.firstKeyFramePTS?w.firstKeyFramePTS:Qe;if(!de&&Lt<et-this.config.maxBufferHole&&!Be){this.backtrack(g);return}else Be&&(g.gap=!0);g.setElementaryStreamInfo(w.type,g.start,Ne,g.start,Xe,!0)}else de&&Qe>oo&&(g.gap=!0);g.setElementaryStreamInfo(w.type,Qe,Ne,lt,Xe),this.backtrackFragment&&(this.backtrackFragment=g),this.bufferFragmentData(w,g,A,c,de||Be)}else if(de||Be)g.gap=!0;else{this.backtrack(g);return}}if(ne){const{startPTS:xe,endPTS:de,startDTS:Be,endDTS:Qe}=ne;A&&(A.elementaryStreams[Ae.AUDIO]={startPTS:xe,endPTS:de,startDTS:Be,endDTS:Qe}),g.setElementaryStreamInfo(Ae.AUDIO,xe,de,Be,Qe),this.bufferFragmentData(ne,g,A,c)}if(Z&&z!=null&&(n=z.samples)!=null&&n.length){const xe={id:a,frag:g,details:Z,samples:z.samples};o.trigger(v.FRAG_PARSING_METADATA,xe)}if(Z&&M){const xe={id:a,frag:g,details:Z,samples:M.samples};o.trigger(v.FRAG_PARSING_USERDATA,xe)}}_bufferInitSegment(t,n,a,o){if(this.state!==ot.PARSING)return;this.audioOnly=!!n.audio&&!n.video,this.altAudio&&!this.audioOnly&&delete n.audio;const{audio:u,video:c,audiovideo:p}=n;if(u){let g=t.audioCodec;const A=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(g&&(g.indexOf("mp4a.40.5")!==-1?g="mp4a.40.2":g="mp4a.40.5"),u.metadata.channelCount!==1&&A.indexOf("firefox")===-1&&(g="mp4a.40.5")),g&&g.indexOf("mp4a.40.5")!==-1&&A.indexOf("android")!==-1&&u.container!=="audio/mpeg"&&(g="mp4a.40.2",this.log(`Android: force audio codec to ${g}`)),t.audioCodec&&t.audioCodec!==g&&this.log(`Swapping manifest audio codec "${t.audioCodec}" for "${g}"`),u.levelCodec=g,u.id="main",this.log(`Init audio buffer, container:${u.container}, codecs[selected/level/parsed]=[${g||""}/${t.audioCodec||""}/${u.codec}]`)}c&&(c.levelCodec=t.videoCodec,c.id="main",this.log(`Init video buffer, container:${c.container}, codecs[level/parsed]=[${t.videoCodec||""}/${c.codec}]`)),p&&this.log(`Init audiovideo buffer, container:${p.container}, codecs[level/parsed]=[${t.codecs}/${p.codec}]`),this.hls.trigger(v.BUFFER_CODECS,n),Object.keys(n).forEach(g=>{const _=n[g].initSegment;_!=null&&_.byteLength&&this.hls.trigger(v.BUFFER_APPENDING,{type:g,data:_,frag:a,part:null,chunkMeta:o,parent:a.type})}),this.tickImmediate()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,Wt.MAIN)}backtrack(t){this.couldBacktrack=!0,this.backtrackFragment=t,this.resetTransmuxer(),this.flushBufferGap(t),this.fragmentTracker.removeFragment(t),this.fragPrevious=null,this.nextLoadPosition=t.start,this.state=ot.IDLE}checkFragmentChanged(){const t=this.media;let n=null;if(t&&t.readyState>1&&t.seeking===!1){const a=t.currentTime;if(_i.isBuffered(t,a)?n=this.getAppendedFrag(a):_i.isBuffered(t,a+.1)&&(n=this.getAppendedFrag(a+.1)),n){this.backtrackFragment=null;const o=this.fragPlaying,u=n.level;(!o||n.sn!==o.sn||o.level!==u)&&(this.fragPlaying=n,this.hls.trigger(v.FRAG_CHANGED,{frag:n}),(!o||o.level!==u)&&this.hls.trigger(v.LEVEL_SWITCHED,{level:u}))}}}get nextLevel(){const t=this.nextBufferedFrag;return t?t.level:-1}get currentFrag(){const t=this.media;return t?this.fragPlaying||this.getAppendedFrag(t.currentTime):null}get currentProgramDateTime(){const t=this.media;if(t){const n=t.currentTime,a=this.currentFrag;if(a&&ie(n)&&ie(a.programDateTime)){const o=a.programDateTime+(n-a.start)*1e3;return new Date(o)}}return null}get currentLevel(){const t=this.currentFrag;return t?t.level:-1}get nextBufferedFrag(){const t=this.currentFrag;return t?this.followingBufferedFrag(t):null}get forceStartLoad(){return this._forceStartLoad}}class ss{static get version(){return"1.5.7"}static isMSESupported(){return yl()}static isSupported(){return Qc()}static getMediaSource(){return fr()}static get Events(){return v}static get ErrorTypes(){return $}static get ErrorDetails(){return I}static get DefaultConfig(){return ss.defaultConfig?ss.defaultConfig:Pu}static set DefaultConfig(t){ss.defaultConfig=t}constructor(t={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this.started=!1,this._emitter=new Wn,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,this.triggeringException=void 0,V(t.debug||!1,"Hls instance");const n=this.config=Vd(ss.DefaultConfig,t);this.userConfig=t,n.progressive&&zc(n);const{abrController:a,bufferController:o,capLevelController:u,errorController:c,fpsController:p}=n,g=new c(this),A=this.abrController=new a(this),_=this.bufferController=new o(this),w=this.capLevelController=new u(this),M=new p(this),z=new Ma(this),K=new ed(this),Z=n.contentSteeringController,ne=Z?new Z(this):null,xe=this.levelController=new Yc(this,ne),de=new tr(this),Be=new Xc(this.config),Qe=this.streamController=new Kd(this,de,Be);w.setStreamController(Qe),M.setStreamController(Qe);const Ne=[z,xe,Qe];ne&&Ne.splice(1,0,ne),this.networkControllers=Ne;const lt=[A,_,w,M,K,de];this.audioTrackController=this.createController(n.audioTrackController,Ne);const Xe=n.audioStreamController;Xe&&Ne.push(new Xe(this,de,Be)),this.subtitleTrackController=this.createController(n.subtitleTrackController,Ne);const ct=n.subtitleStreamController;ct&&Ne.push(new ct(this,de,Be)),this.createController(n.timelineController,lt),Be.emeController=this.emeController=this.createController(n.emeController,lt),this.cmcdController=this.createController(n.cmcdController,lt),this.latencyController=this.createController(td,lt),this.coreComponents=lt,Ne.push(g);const Lt=g.onErrorOut;typeof Lt=="function"&&this.on(v.ERROR,Lt,g)}createController(t,n){if(t){const a=new t(this);return n&&n.push(a),a}return null}on(t,n,a=this){this._emitter.on(t,n,a)}once(t,n,a=this){this._emitter.once(t,n,a)}removeAllListeners(t){this._emitter.removeAllListeners(t)}off(t,n,a=this,o){this._emitter.off(t,n,a,o)}listeners(t){return this._emitter.listeners(t)}emit(t,n,a){return this._emitter.emit(t,n,a)}trigger(t,n){if(this.config.debug)return this.emit(t,t,n);try{return this.emit(t,t,n)}catch(a){if(S.error("An internal error happened while handling event "+t+'. Error message: "'+a.message+'". Here is a stacktrace:',a),!this.triggeringException){this.triggeringException=!0;const o=t===v.ERROR;this.trigger(v.ERROR,{type:$.OTHER_ERROR,details:I.INTERNAL_EXCEPTION,fatal:o,event:t,error:a}),this.triggeringException=!1}}return!1}listenerCount(t){return this._emitter.listenerCount(t)}destroy(){S.log("destroy"),this.trigger(v.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(n=>n.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(n=>n.destroy()),this.coreComponents.length=0;const t=this.config;t.xhrSetup=t.fetchSetup=void 0,this.userConfig=null}attachMedia(t){S.log("attachMedia"),this._media=t,this.trigger(v.MEDIA_ATTACHING,{media:t})}detachMedia(){S.log("detachMedia"),this.trigger(v.MEDIA_DETACHING,void 0),this._media=null}loadSource(t){this.stopLoad();const n=this.media,a=this.url,o=this.url=Ze.buildAbsoluteURL(self.location.href,t,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,S.log(`loadSource:${o}`),n&&a&&(a!==o||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(n)),this.trigger(v.MANIFEST_LOADING,{url:t})}startLoad(t=-1){S.log(`startLoad(${t})`),this.started=!0,this.networkControllers.forEach(n=>{n.startLoad(t)})}stopLoad(){S.log("stopLoad"),this.started=!1,this.networkControllers.forEach(t=>{t.stopLoad()})}resumeBuffering(){this.started&&this.networkControllers.forEach(t=>{"fragmentLoader"in t&&t.startLoad(-1)})}pauseBuffering(){this.networkControllers.forEach(t=>{"fragmentLoader"in t&&t.stopLoad()})}swapAudioCodec(){S.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){S.log("recoverMediaError");const t=this._media;this.detachMedia(),t&&this.attachMedia(t)}removeLevel(t){this.levelController.removeLevel(t)}get levels(){const t=this.levelController.levels;return t||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(t){S.log(`set currentLevel:${t}`),this.levelController.manualLevel=t,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(t){S.log(`set nextLevel:${t}`),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(t){S.log(`set loadLevel:${t}`),this.levelController.manualLevel=t}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(t){this.levelController.nextLoadLevel=t}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(t){S.log(`set firstLevel:${t}`),this.levelController.firstLevel=t}get startLevel(){const t=this.levelController.startLevel;return t===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:t}set startLevel(t){S.log(`set startLevel:${t}`),t!==-1&&(t=Math.max(t,this.minAutoLevel)),this.levelController.startLevel=t}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(t){const n=!!t;n!==this.config.capLevelToPlayerSize&&(n?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=n)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimate():NaN}set bandwidthEstimate(t){this.abrController.resetEstimator(t)}get ttfbEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimateTTFB():NaN}set autoLevelCapping(t){this._autoLevelCapping!==t&&(S.log(`set autoLevelCapping:${t}`),this._autoLevelCapping=t,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(t){id(t)&&this._maxHdcpLevel!==t&&(this._maxHdcpLevel=t,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:t,config:{minAutoBitrate:n}}=this;if(!t)return 0;const a=t.length;for(let o=0;o<a;o++)if(t[o].maxBitrate>=n)return o;return 0}get maxAutoLevel(){const{levels:t,autoLevelCapping:n,maxHdcpLevel:a}=this;let o;if(n===-1&&t!=null&&t.length?o=t.length-1:o=n,a)for(let u=o;u--;){const c=t[u].attrs["HDCP-LEVEL"];if(c&&c<=a)return u}return o}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(t){this.abrController.nextAutoLevel=t}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}setAudioOption(t){var n;return(n=this.audioTrackController)==null?void 0:n.setAudioOption(t)}setSubtitleOption(t){var n;return(n=this.subtitleTrackController)==null||n.setSubtitleOption(t),null}get allAudioTracks(){const t=this.audioTrackController;return t?t.allAudioTracks:[]}get audioTracks(){const t=this.audioTrackController;return t?t.audioTracks:[]}get audioTrack(){const t=this.audioTrackController;return t?t.audioTrack:-1}set audioTrack(t){const n=this.audioTrackController;n&&(n.audioTrack=t)}get allSubtitleTracks(){const t=this.subtitleTrackController;return t?t.allSubtitleTracks:[]}get subtitleTracks(){const t=this.subtitleTrackController;return t?t.subtitleTracks:[]}get subtitleTrack(){const t=this.subtitleTrackController;return t?t.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(t){const n=this.subtitleTrackController;n&&(n.subtitleTrack=t)}get subtitleDisplay(){const t=this.subtitleTrackController;return t?t.subtitleDisplay:!1}set subtitleDisplay(t){const n=this.subtitleTrackController;n&&(n.subtitleDisplay=t)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(t){this.config.lowLatencyMode=t}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}ss.defaultConfig=void 0},27376:function(Xt){Xt.exports=pt;var Nt=Object.prototype.toString;function pt(ut){if(!ut)return!1;var le=Nt.call(ut);return le==="[object Function]"||typeof ut=="function"&&le!=="[object RegExp]"||typeof window!="undefined"&&(ut===window.setTimeout||ut===window.alert||ut===window.confirm||ut===window.prompt)}},27537:function(Xt,Nt){function pt(me){if(me&&typeof me=="object"){var Le=me.which||me.keyCode||me.charCode;Le&&(me=Le)}if(typeof me=="number")return Ee[me];var ve=String(me),re=ut[ve.toLowerCase()];if(re)return re;var re=le[ve.toLowerCase()];if(re)return re;if(ve.length===1)return ve.charCodeAt(0)}pt.isEventKey=function(Le,ve){if(Le&&typeof Le=="object"){var re=Le.which||Le.keyCode||Le.charCode;if(re==null)return!1;if(typeof ve=="string"){var ie=ut[ve.toLowerCase()];if(ie)return ie===re;var ie=le[ve.toLowerCase()];if(ie)return ie===re}else if(typeof ve=="number")return ve===re;return!1}},Nt=Xt.exports=pt;var ut=Nt.code=Nt.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},le=Nt.aliases={windows:91,"\u21E7":16,"\u2325":18,"\u2303":17,"\u2318":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};/*!
 * Programatically add the following
 */for(Ze=97;Ze<123;Ze++)ut[String.fromCharCode(Ze)]=Ze-32;for(var Ze=48;Ze<58;Ze++)ut[Ze-48]=Ze;for(Ze=1;Ze<13;Ze++)ut["f"+Ze]=Ze+111;for(Ze=0;Ze<10;Ze++)ut["numpad "+Ze]=Ze+96;var Ee=Nt.names=Nt.title={};for(Ze in ut)Ee[ut[Ze]]=Ze;for(var nt in le)ut[nt]=le[nt]},84221:function(Xt,Nt,pt){var ut=pt(46894).getUint64,le=function(Ze){var Ee=new DataView(Ze.buffer,Ze.byteOffset,Ze.byteLength),nt={version:Ze[0],flags:new Uint8Array(Ze.subarray(1,4)),references:[],referenceId:Ee.getUint32(4),timescale:Ee.getUint32(8)},me=12;nt.version===0?(nt.earliestPresentationTime=Ee.getUint32(me),nt.firstOffset=Ee.getUint32(me+4),me+=8):(nt.earliestPresentationTime=ut(Ze.subarray(me)),nt.firstOffset=ut(Ze.subarray(me+8)),me+=16),me+=2;var Le=Ee.getUint16(me);for(me+=2;Le>0;me+=12,Le--)nt.references.push({referenceType:(Ze[me]&128)>>>7,referencedSize:Ee.getUint32(me)&2147483647,subsegmentDuration:Ee.getUint32(me+4),startsWithSap:!!(Ze[me+8]&128),sapType:(Ze[me+8]&112)>>>4,sapDeltaTime:Ee.getUint32(me+8)&268435455});return nt};Xt.exports=le},51489:function(Xt){var Nt=9e4,pt,ut,le,Ze,Ee,nt,me;pt=function(Le){return Le*Nt},ut=function(Le,ve){return Le*ve},le=function(Le){return Le/Nt},Ze=function(Le,ve){return Le/ve},Ee=function(Le,ve){return pt(Ze(Le,ve))},nt=function(Le,ve){return ut(le(Le),ve)},me=function(Le,ve,re){return le(re?Le:Le-ve)},Xt.exports={ONE_SECOND_IN_TS:Nt,secondsToVideoTs:pt,secondsToAudioTs:ut,videoTsToSeconds:le,audioTsToSeconds:Ze,audioTsToVideoTs:Ee,videoTsToAudioTs:nt,metadataTsToSeconds:me}},46894:function(Xt){var Nt=Math.pow(2,32),pt=function(ut){var le=new DataView(ut.buffer,ut.byteOffset,ut.byteLength),Ze;return le.getBigUint64?(Ze=le.getBigUint64(0),Ze<Number.MAX_SAFE_INTEGER?Number(Ze):Ze):le.getUint32(0)*Nt+le.getUint32(4)};Xt.exports={getUint64:pt,MAX_UINT32:Nt}},75974:function(Xt){Xt.exports=Nt;function Nt(pt,ut){var le,Ze=null;try{le=JSON.parse(pt,ut)}catch(Ee){Ze=Ee}return[Ze,le]}},49945:function(Xt){(function(Nt){var pt=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,ut=/^(?=([^\/?#]*))\1([^]*)$/,le=/(?:\/|^)\.(?=\/)/g,Ze=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,Ee={buildAbsoluteURL:function(nt,me,Le){if(Le=Le||{},nt=nt.trim(),me=me.trim(),!me){if(!Le.alwaysNormalize)return nt;var ve=Ee.parseURL(nt);if(!ve)throw new Error("Error trying to parse base URL.");return ve.path=Ee.normalizePath(ve.path),Ee.buildURLFromParts(ve)}var re=Ee.parseURL(me);if(!re)throw new Error("Error trying to parse relative URL.");if(re.scheme)return Le.alwaysNormalize?(re.path=Ee.normalizePath(re.path),Ee.buildURLFromParts(re)):me;var ie=Ee.parseURL(nt);if(!ie)throw new Error("Error trying to parse base URL.");if(!ie.netLoc&&ie.path&&ie.path[0]!=="/"){var J=ut.exec(ie.path);ie.netLoc=J[1],ie.path=J[2]}ie.netLoc&&!ie.path&&(ie.path="/");var D={scheme:ie.scheme,netLoc:re.netLoc,path:null,params:re.params,query:re.query,fragment:re.fragment};if(!re.netLoc&&(D.netLoc=ie.netLoc,re.path[0]!=="/"))if(!re.path)D.path=ie.path,re.params||(D.params=ie.params,re.query||(D.query=ie.query));else{var v=ie.path,$=v.substring(0,v.lastIndexOf("/")+1)+re.path;D.path=Ee.normalizePath($)}return D.path===null&&(D.path=Le.alwaysNormalize?Ee.normalizePath(re.path):re.path),Ee.buildURLFromParts(D)},parseURL:function(nt){var me=pt.exec(nt);return me?{scheme:me[1]||"",netLoc:me[2]||"",path:me[3]||"",params:me[4]||"",query:me[5]||"",fragment:me[6]||""}:null},normalizePath:function(nt){for(nt=nt.split("").reverse().join("").replace(le,"");nt.length!==(nt=nt.replace(Ze,"")).length;);return nt.split("").reverse().join("")},buildURLFromParts:function(nt){return nt.scheme+nt.netLoc+nt.path+nt.params+nt.query+nt.fragment}};Xt.exports=Ee})(this)},43033:function(Xt,Nt,pt){"use strict";pt.d(Nt,{Z:function(){return de}});var ut=pt(58908),le=pt.n(ut),Ze=pt(89144),Ee=pt.n(Ze),nt=pt(27537),me=pt.n(nt),Le=pt(75974),ve=pt.n(Le),re=pt(9603),ie=pt.n(re),J=pt(13407),D=pt.n(J),v=pt(22122),$=pt(49945),I=pt.n($),H="http://example.com",X=function(e,i){if(/^[a-z]+:/i.test(i))return i;/^data:/.test(e)&&(e=le().location&&le().location.href||"");var r=typeof le().URL=="function",l=/^\/\//.test(e),d=!le().location&&!/\/\//i.test(e);if(r?e=new(le()).URL(e,le().location||H):/\/\//i.test(e)||(e=I().buildAbsoluteURL(le().location&&le().location.href||"",e)),r){var f=new URL(i,e);return d?f.href.slice(H.length):l?f.href.slice(f.protocol.length):f.href}return I().buildAbsoluteURL(e,i)},O=X,G=function(){function s(){this.listeners={}}var e=s.prototype;return e.on=function(r,l){this.listeners[r]||(this.listeners[r]=[]),this.listeners[r].push(l)},e.off=function(r,l){if(!this.listeners[r])return!1;var d=this.listeners[r].indexOf(l);return this.listeners[r]=this.listeners[r].slice(0),this.listeners[r].splice(d,1),d>-1},e.trigger=function(r){var l=this.listeners[r];if(!!l)if(arguments.length===2)for(var d=l.length,f=0;f<d;++f)l[f].call(this,arguments[1]);else for(var y=Array.prototype.slice.call(arguments,1),L=l.length,B=0;B<L;++B)l[B].apply(this,y)},e.dispose=function(){this.listeners={}},e.pipe=function(r){this.on("data",function(l){r.push(l)})},s}(),j=pt(48764).Buffer,V=function(e){return le().atob?le().atob(e):j.from(e,"base64").toString("binary")};function S(s){for(var e=V(s),i=new Uint8Array(e.length),r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return i}/*! @name m3u8-parser @version 7.1.0 @license Apache-2.0 */class ee extends G{constructor(){super();this.buffer=""}push(e){let i;for(this.buffer+=e,i=this.buffer.indexOf(`
`);i>-1;i=this.buffer.indexOf(`
`))this.trigger("data",this.buffer.substring(0,i)),this.buffer=this.buffer.substring(i+1)}}const se=String.fromCharCode(9),ue=function(s){const e=/([0-9.]*)?@?([0-9.]*)?/.exec(s||""),i={};return e[1]&&(i.length=parseInt(e[1],10)),e[2]&&(i.offset=parseInt(e[2],10)),i},U=function(){const s="[^=]*",e='"[^"]*"|[^,]*',i="(?:"+s+")=(?:"+e+")";return new RegExp("(?:^|,)("+i+")")},Y=function(s){const e={};if(!s)return e;const i=s.split(U());let r=i.length,l;for(;r--;)i[r]!==""&&(l=/([^=]*)=(.*)/.exec(i[r]).slice(1),l[0]=l[0].replace(/^\s+|\s+$/g,""),l[1]=l[1].replace(/^\s+|\s+$/g,""),l[1]=l[1].replace(/^['"](.*)['"]$/g,"$1"),e[l[0]]=l[1]);return e};class ae extends G{constructor(){super();this.customParsers=[],this.tagMappers=[]}push(e){let i,r;if(e=e.trim(),e.length===0)return;if(e[0]!=="#"){this.trigger("data",{type:"uri",uri:e});return}this.tagMappers.reduce((d,f)=>{const y=f(e);return y===e?d:d.concat([y])},[e]).forEach(d=>{for(let f=0;f<this.customParsers.length;f++)if(this.customParsers[f].call(this,d))return;if(d.indexOf("#EXT")!==0){this.trigger("data",{type:"comment",text:d.slice(1)});return}if(d=d.replace("\r",""),i=/^#EXTM3U/.exec(d),i){this.trigger("data",{type:"tag",tagType:"m3u"});return}if(i=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(d),i){r={type:"tag",tagType:"inf"},i[1]&&(r.duration=parseFloat(i[1])),i[2]&&(r.title=i[2]),this.trigger("data",r);return}if(i=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(d),i){r={type:"tag",tagType:"targetduration"},i[1]&&(r.duration=parseInt(i[1],10)),this.trigger("data",r);return}if(i=/^#EXT-X-VERSION:([0-9.]*)?/.exec(d),i){r={type:"tag",tagType:"version"},i[1]&&(r.version=parseInt(i[1],10)),this.trigger("data",r);return}if(i=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(d),i){r={type:"tag",tagType:"media-sequence"},i[1]&&(r.number=parseInt(i[1],10)),this.trigger("data",r);return}if(i=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(d),i){r={type:"tag",tagType:"discontinuity-sequence"},i[1]&&(r.number=parseInt(i[1],10)),this.trigger("data",r);return}if(i=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(d),i){r={type:"tag",tagType:"playlist-type"},i[1]&&(r.playlistType=i[1]),this.trigger("data",r);return}if(i=/^#EXT-X-BYTERANGE:(.*)?$/.exec(d),i){r=(0,v.Z)(ue(i[1]),{type:"tag",tagType:"byterange"}),this.trigger("data",r);return}if(i=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(d),i){r={type:"tag",tagType:"allow-cache"},i[1]&&(r.allowed=!/NO/.test(i[1])),this.trigger("data",r);return}if(i=/^#EXT-X-MAP:(.*)$/.exec(d),i){if(r={type:"tag",tagType:"map"},i[1]){const f=Y(i[1]);f.URI&&(r.uri=f.URI),f.BYTERANGE&&(r.byterange=ue(f.BYTERANGE))}this.trigger("data",r);return}if(i=/^#EXT-X-STREAM-INF:(.*)$/.exec(d),i){if(r={type:"tag",tagType:"stream-inf"},i[1]){if(r.attributes=Y(i[1]),r.attributes.RESOLUTION){const f=r.attributes.RESOLUTION.split("x"),y={};f[0]&&(y.width=parseInt(f[0],10)),f[1]&&(y.height=parseInt(f[1],10)),r.attributes.RESOLUTION=y}r.attributes.BANDWIDTH&&(r.attributes.BANDWIDTH=parseInt(r.attributes.BANDWIDTH,10)),r.attributes["FRAME-RATE"]&&(r.attributes["FRAME-RATE"]=parseFloat(r.attributes["FRAME-RATE"])),r.attributes["PROGRAM-ID"]&&(r.attributes["PROGRAM-ID"]=parseInt(r.attributes["PROGRAM-ID"],10))}this.trigger("data",r);return}if(i=/^#EXT-X-MEDIA:(.*)$/.exec(d),i){r={type:"tag",tagType:"media"},i[1]&&(r.attributes=Y(i[1])),this.trigger("data",r);return}if(i=/^#EXT-X-ENDLIST/.exec(d),i){this.trigger("data",{type:"tag",tagType:"endlist"});return}if(i=/^#EXT-X-DISCONTINUITY/.exec(d),i){this.trigger("data",{type:"tag",tagType:"discontinuity"});return}if(i=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(d),i){r={type:"tag",tagType:"program-date-time"},i[1]&&(r.dateTimeString=i[1],r.dateTimeObject=new Date(i[1])),this.trigger("data",r);return}if(i=/^#EXT-X-KEY:(.*)$/.exec(d),i){r={type:"tag",tagType:"key"},i[1]&&(r.attributes=Y(i[1]),r.attributes.IV&&(r.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(r.attributes.IV=r.attributes.IV.substring(2)),r.attributes.IV=r.attributes.IV.match(/.{8}/g),r.attributes.IV[0]=parseInt(r.attributes.IV[0],16),r.attributes.IV[1]=parseInt(r.attributes.IV[1],16),r.attributes.IV[2]=parseInt(r.attributes.IV[2],16),r.attributes.IV[3]=parseInt(r.attributes.IV[3],16),r.attributes.IV=new Uint32Array(r.attributes.IV))),this.trigger("data",r);return}if(i=/^#EXT-X-START:(.*)$/.exec(d),i){r={type:"tag",tagType:"start"},i[1]&&(r.attributes=Y(i[1]),r.attributes["TIME-OFFSET"]=parseFloat(r.attributes["TIME-OFFSET"]),r.attributes.PRECISE=/YES/.test(r.attributes.PRECISE)),this.trigger("data",r);return}if(i=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(d),i){r={type:"tag",tagType:"cue-out-cont"},i[1]?r.data=i[1]:r.data="",this.trigger("data",r);return}if(i=/^#EXT-X-CUE-OUT:(.*)?$/.exec(d),i){r={type:"tag",tagType:"cue-out"},i[1]?r.data=i[1]:r.data="",this.trigger("data",r);return}if(i=/^#EXT-X-CUE-IN:(.*)?$/.exec(d),i){r={type:"tag",tagType:"cue-in"},i[1]?r.data=i[1]:r.data="",this.trigger("data",r);return}if(i=/^#EXT-X-SKIP:(.*)$/.exec(d),i&&i[1]){r={type:"tag",tagType:"skip"},r.attributes=Y(i[1]),r.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(r.attributes["SKIPPED-SEGMENTS"]=parseInt(r.attributes["SKIPPED-SEGMENTS"],10)),r.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(r.attributes["RECENTLY-REMOVED-DATERANGES"]=r.attributes["RECENTLY-REMOVED-DATERANGES"].split(se)),this.trigger("data",r);return}if(i=/^#EXT-X-PART:(.*)$/.exec(d),i&&i[1]){r={type:"tag",tagType:"part"},r.attributes=Y(i[1]),["DURATION"].forEach(function(f){r.attributes.hasOwnProperty(f)&&(r.attributes[f]=parseFloat(r.attributes[f]))}),["INDEPENDENT","GAP"].forEach(function(f){r.attributes.hasOwnProperty(f)&&(r.attributes[f]=/YES/.test(r.attributes[f]))}),r.attributes.hasOwnProperty("BYTERANGE")&&(r.attributes.byterange=ue(r.attributes.BYTERANGE)),this.trigger("data",r);return}if(i=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(d),i&&i[1]){r={type:"tag",tagType:"server-control"},r.attributes=Y(i[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(f){r.attributes.hasOwnProperty(f)&&(r.attributes[f]=parseFloat(r.attributes[f]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(f){r.attributes.hasOwnProperty(f)&&(r.attributes[f]=/YES/.test(r.attributes[f]))}),this.trigger("data",r);return}if(i=/^#EXT-X-PART-INF:(.*)$/.exec(d),i&&i[1]){r={type:"tag",tagType:"part-inf"},r.attributes=Y(i[1]),["PART-TARGET"].forEach(function(f){r.attributes.hasOwnProperty(f)&&(r.attributes[f]=parseFloat(r.attributes[f]))}),this.trigger("data",r);return}if(i=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(d),i&&i[1]){r={type:"tag",tagType:"preload-hint"},r.attributes=Y(i[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(f){if(r.attributes.hasOwnProperty(f)){r.attributes[f]=parseInt(r.attributes[f],10);const y=f==="BYTERANGE-LENGTH"?"length":"offset";r.attributes.byterange=r.attributes.byterange||{},r.attributes.byterange[y]=r.attributes[f],delete r.attributes[f]}}),this.trigger("data",r);return}if(i=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(d),i&&i[1]){r={type:"tag",tagType:"rendition-report"},r.attributes=Y(i[1]),["LAST-MSN","LAST-PART"].forEach(function(f){r.attributes.hasOwnProperty(f)&&(r.attributes[f]=parseInt(r.attributes[f],10))}),this.trigger("data",r);return}if(i=/^#EXT-X-DATERANGE:(.*)$/.exec(d),i&&i[1]){r={type:"tag",tagType:"daterange"},r.attributes=Y(i[1]),["ID","CLASS"].forEach(function(y){r.attributes.hasOwnProperty(y)&&(r.attributes[y]=String(r.attributes[y]))}),["START-DATE","END-DATE"].forEach(function(y){r.attributes.hasOwnProperty(y)&&(r.attributes[y]=new Date(r.attributes[y]))}),["DURATION","PLANNED-DURATION"].forEach(function(y){r.attributes.hasOwnProperty(y)&&(r.attributes[y]=parseFloat(r.attributes[y]))}),["END-ON-NEXT"].forEach(function(y){r.attributes.hasOwnProperty(y)&&(r.attributes[y]=/YES/i.test(r.attributes[y]))}),["SCTE35-CMD"," SCTE35-OUT","SCTE35-IN"].forEach(function(y){r.attributes.hasOwnProperty(y)&&(r.attributes[y]=r.attributes[y].toString(16))});const f=/^X-([A-Z]+-)+[A-Z]+$/;for(const y in r.attributes){if(!f.test(y))continue;const L=/[0-9A-Fa-f]{6}/g.test(r.attributes[y]),B=/^\d+(\.\d+)?$/.test(r.attributes[y]);r.attributes[y]=L?r.attributes[y].toString(16):B?parseFloat(r.attributes[y]):String(r.attributes[y])}this.trigger("data",r);return}if(i=/^#EXT-X-INDEPENDENT-SEGMENTS/.exec(d),i){this.trigger("data",{type:"tag",tagType:"independent-segments"});return}if(i=/^#EXT-X-CONTENT-STEERING:(.*)$/.exec(d),i){r={type:"tag",tagType:"content-steering"},r.attributes=Y(i[1]),this.trigger("data",r);return}this.trigger("data",{type:"tag",data:d.slice(4)})})}addParser({expression:e,customType:i,dataParser:r,segment:l}){typeof r!="function"&&(r=d=>d),this.customParsers.push(d=>{if(e.exec(d))return this.trigger("data",{type:"custom",data:r(d),customType:i,segment:l}),!0})}addTagMapper({expression:e,map:i}){const r=l=>e.test(l)?i(l):l;this.tagMappers.push(r)}}const fe=s=>s.toLowerCase().replace(/-(\w)/g,e=>e[1].toUpperCase()),Ae=function(s){const e={};return Object.keys(s).forEach(function(i){e[fe(i)]=s[i]}),e},Re=function(s){const{serverControl:e,targetDuration:i,partTargetDuration:r}=s;if(!e)return;const l="#EXT-X-SERVER-CONTROL",d="holdBack",f="partHoldBack",y=i&&i*3,L=r&&r*2;i&&!e.hasOwnProperty(d)&&(e[d]=y,this.trigger("info",{message:`${l} defaulting HOLD-BACK to targetDuration * 3 (${y}).`})),y&&e[d]<y&&(this.trigger("warn",{message:`${l} clamping HOLD-BACK (${e[d]}) to targetDuration * 3 (${y})`}),e[d]=y),r&&!e.hasOwnProperty(f)&&(e[f]=r*3,this.trigger("info",{message:`${l} defaulting PART-HOLD-BACK to partTargetDuration * 3 (${e[f]}).`})),r&&e[f]<L&&(this.trigger("warn",{message:`${l} clamping PART-HOLD-BACK (${e[f]}) to partTargetDuration * 2 (${L}).`}),e[f]=L)};class Ce extends G{constructor(){super();this.lineStream=new ee,this.parseStream=new ae,this.lineStream.pipe(this.parseStream),this.lastProgramDateTime=null;const e=this,i=[];let r={},l,d,f=!1;const y=function(){},L={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},B="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";let W=0;this.manifest={allowCache:!0,discontinuityStarts:[],dateRanges:[],segments:[]};let ce=0,ke=0;const Pe={};this.on("end",()=>{r.uri||!r.parts&&!r.preloadHints||(!r.map&&l&&(r.map=l),!r.key&&d&&(r.key=d),!r.timeline&&typeof W=="number"&&(r.timeline=W),this.manifest.preloadSegment=r)}),this.parseStream.on("data",function(be){let je,We;({tag(){({version(){be.version&&(this.manifest.version=be.version)},"allow-cache"(){this.manifest.allowCache=be.allowed,"allowed"in be||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){const Je={};"length"in be&&(r.byterange=Je,Je.length=be.length,"offset"in be||(be.offset=ce)),"offset"in be&&(r.byterange=Je,Je.offset=be.offset),ce=Je.offset+Je.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),be.title&&(r.title=be.title),be.duration>0&&(r.duration=be.duration),be.duration===0&&(r.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=i},key(){if(!be.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(be.attributes.METHOD==="NONE"){d=null;return}if(!be.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(be.attributes.KEYFORMAT==="com.apple.streamingkeydelivery"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:be.attributes};return}if(be.attributes.KEYFORMAT==="com.microsoft.playready"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:be.attributes.URI};return}if(be.attributes.KEYFORMAT===B){if(["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(be.attributes.METHOD)===-1){this.trigger("warn",{message:"invalid key method provided for Widevine"});return}if(be.attributes.METHOD==="SAMPLE-AES-CENC"&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),be.attributes.URI.substring(0,23)!=="data:text/plain;base64,"){this.trigger("warn",{message:"invalid key URI provided for Widevine"});return}if(!(be.attributes.KEYID&&be.attributes.KEYID.substring(0,2)==="0x")){this.trigger("warn",{message:"invalid key ID provided for Widevine"});return}this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:be.attributes.KEYFORMAT,keyId:be.attributes.KEYID.substring(2)},pssh:S(be.attributes.URI.split(",")[1])};return}be.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),d={method:be.attributes.METHOD||"AES-128",uri:be.attributes.URI},typeof be.attributes.IV!="undefined"&&(d.iv=be.attributes.IV)},"media-sequence"(){if(!isFinite(be.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+be.number});return}this.manifest.mediaSequence=be.number},"discontinuity-sequence"(){if(!isFinite(be.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+be.number});return}this.manifest.discontinuitySequence=be.number,W=be.number},"playlist-type"(){if(!/VOD|EVENT/.test(be.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+be.playlist});return}this.manifest.playlistType=be.playlistType},map(){l={},be.uri&&(l.uri=be.uri),be.byterange&&(l.byterange=be.byterange),d&&(l.key=d)},"stream-inf"(){if(this.manifest.playlists=i,this.manifest.mediaGroups=this.manifest.mediaGroups||L,!be.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}r.attributes||(r.attributes={}),(0,v.Z)(r.attributes,be.attributes)},media(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||L,!(be.attributes&&be.attributes.TYPE&&be.attributes["GROUP-ID"]&&be.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}const Je=this.manifest.mediaGroups[be.attributes.TYPE];Je[be.attributes["GROUP-ID"]]=Je[be.attributes["GROUP-ID"]]||{},je=Je[be.attributes["GROUP-ID"]],We={default:/yes/i.test(be.attributes.DEFAULT)},We.default?We.autoselect=!0:We.autoselect=/yes/i.test(be.attributes.AUTOSELECT),be.attributes.LANGUAGE&&(We.language=be.attributes.LANGUAGE),be.attributes.URI&&(We.uri=be.attributes.URI),be.attributes["INSTREAM-ID"]&&(We.instreamId=be.attributes["INSTREAM-ID"]),be.attributes.CHARACTERISTICS&&(We.characteristics=be.attributes.CHARACTERISTICS),be.attributes.FORCED&&(We.forced=/yes/i.test(be.attributes.FORCED)),je[be.attributes.NAME]=We},discontinuity(){W+=1,r.discontinuity=!0,this.manifest.discontinuityStarts.push(i.length)},"program-date-time"(){typeof this.manifest.dateTimeString=="undefined"&&(this.manifest.dateTimeString=be.dateTimeString,this.manifest.dateTimeObject=be.dateTimeObject),r.dateTimeString=be.dateTimeString,r.dateTimeObject=be.dateTimeObject;const{lastProgramDateTime:Je}=this;this.lastProgramDateTime=new Date(be.dateTimeString).getTime(),Je===null&&this.manifest.segments.reduceRight((He,dt)=>(dt.programDateTime=He-dt.duration*1e3,dt.programDateTime),this.lastProgramDateTime)},targetduration(){if(!isFinite(be.duration)||be.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+be.duration});return}this.manifest.targetDuration=be.duration,Re.call(this,this.manifest)},start(){if(!be.attributes||isNaN(be.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:be.attributes["TIME-OFFSET"],precise:be.attributes.PRECISE}},"cue-out"(){r.cueOut=be.data},"cue-out-cont"(){r.cueOutCont=be.data},"cue-in"(){r.cueIn=be.data},skip(){this.manifest.skip=Ae(be.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",be.attributes,["SKIPPED-SEGMENTS"])},part(){f=!0;const Je=this.manifest.segments.length,He=Ae(be.attributes);r.parts=r.parts||[],r.parts.push(He),He.byterange&&(He.byterange.hasOwnProperty("offset")||(He.byterange.offset=ke),ke=He.byterange.offset+He.byterange.length);const dt=r.parts.length-1;this.warnOnMissingAttributes_(`#EXT-X-PART #${dt} for segment #${Je}`,be.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((tt,Ue)=>{tt.hasOwnProperty("lastPart")||this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${Ue} lacks required attribute(s): LAST-PART`})})},"server-control"(){const Je=this.manifest.serverControl=Ae(be.attributes);Je.hasOwnProperty("canBlockReload")||(Je.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),Re.call(this,this.manifest),Je.canSkipDateranges&&!Je.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){const Je=this.manifest.segments.length,He=Ae(be.attributes),dt=He.type&&He.type==="PART";r.preloadHints=r.preloadHints||[],r.preloadHints.push(He),He.byterange&&(He.byterange.hasOwnProperty("offset")||(He.byterange.offset=dt?ke:0,dt&&(ke=He.byterange.offset+He.byterange.length)));const tt=r.preloadHints.length-1;if(this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${tt} for segment #${Je}`,be.attributes,["TYPE","URI"]),!!He.type)for(let Ue=0;Ue<r.preloadHints.length-1;Ue++){const xt=r.preloadHints[Ue];!xt.type||xt.type===He.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${tt} for segment #${Je} has the same TYPE ${He.type} as preload hint #${Ue}`})}},"rendition-report"(){const Je=Ae(be.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(Je);const He=this.manifest.renditionReports.length-1,dt=["LAST-MSN","URI"];f&&dt.push("LAST-PART"),this.warnOnMissingAttributes_(`#EXT-X-RENDITION-REPORT #${He}`,be.attributes,dt)},"part-inf"(){this.manifest.partInf=Ae(be.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",be.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),Re.call(this,this.manifest)},daterange(){this.manifest.dateRanges.push(Ae(be.attributes));const Je=this.manifest.dateRanges.length-1;this.warnOnMissingAttributes_(`#EXT-X-DATERANGE #${Je}`,be.attributes,["ID","START-DATE"]);const He=this.manifest.dateRanges[Je];He.endDate&&He.startDate&&new Date(He.endDate)<new Date(He.startDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE END-DATE must be equal to or later than the value of the START-DATE"}),He.duration&&He.duration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE DURATION must not be negative"}),He.plannedDuration&&He.plannedDuration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE PLANNED-DURATION must not be negative"});const dt=!!He.endOnNext;if(dt&&!He.class&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must have a CLASS attribute"}),dt&&(He.duration||He.endDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must not contain DURATION or END-DATE attributes"}),He.duration&&He.endDate){const Ue=He.startDate.getTime()+He.duration*1e3;this.manifest.dateRanges[Je].endDate=new Date(Ue)}if(!Pe[He.id])Pe[He.id]=He;else{for(const Ue in Pe[He.id])if(!!He[Ue]&&JSON.stringify(Pe[He.id][Ue])!==JSON.stringify(He[Ue])){this.trigger("warn",{message:"EXT-X-DATERANGE tags with the same ID in a playlist must have the same attributes values"});break}const tt=this.manifest.dateRanges.findIndex(Ue=>Ue.id===He.id);this.manifest.dateRanges[tt]=(0,v.Z)(this.manifest.dateRanges[tt],He),Pe[He.id]=(0,v.Z)(Pe[He.id],He),this.manifest.dateRanges.pop()}},"independent-segments"(){this.manifest.independentSegments=!0},"content-steering"(){this.manifest.contentSteering=Ae(be.attributes),this.warnOnMissingAttributes_("#EXT-X-CONTENT-STEERING",be.attributes,["SERVER-URI"])}}[be.tagType]||y).call(e)},uri(){r.uri=be.uri,i.push(r),this.manifest.targetDuration&&!("duration"in r)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),r.duration=this.manifest.targetDuration),d&&(r.key=d),r.timeline=W,l&&(r.map=l),ke=0,this.lastProgramDateTime!==null&&(r.programDateTime=this.lastProgramDateTime,this.lastProgramDateTime+=r.duration*1e3),r={}},comment(){},custom(){be.segment?(r.custom=r.custom||{},r.custom[be.customType]=be.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[be.customType]=be.data)}})[be.type].call(e)})}warnOnMissingAttributes_(e,i,r){const l=[];r.forEach(function(d){i.hasOwnProperty(d)||l.push(d)}),l.length&&this.trigger("warn",{message:`${e} lacks required attribute(s): ${l.join(", ")}`})}push(e){this.lineStream.push(e)}end(){this.lineStream.push(`
`),this.manifest.dateRanges.length&&this.lastProgramDateTime===null&&this.trigger("warn",{message:"A playlist with EXT-X-DATERANGE tag must contain atleast one EXT-X-PROGRAM-DATE-TIME tag"}),this.lastProgramDateTime=null,this.trigger("end")}addParser(e){this.parseStream.addParser(e)}addTagMapper(e){this.parseStream.addTagMapper(e)}}var we={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},Fe=["video","audio","text"],Ie=["Video","Audio","Text"],$e=function(e){return e&&e.replace(/avc1\.(\d+)\.(\d+)/i,function(i,r,l){var d=("00"+Number(r).toString(16)).slice(-2),f=("00"+Number(l).toString(16)).slice(-2);return"avc1."+d+"00"+f})},Oe=function(e){return e.map($e)},ht=function(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,function(i){return Oe([i])[0]})},kt=function(e){e===void 0&&(e="");var i=e.split(","),r=[];return i.forEach(function(l){l=l.trim();var d;Fe.forEach(function(f){var y=we[f].exec(l.toLowerCase());if(!(!y||y.length<=1)){d=f;var L=l.substring(0,y[1].length),B=l.replace(L,"");r.push({type:L,details:B,mediaType:f})}}),d||r.push({type:l,details:"",mediaType:"unknown"})}),r},Rt=function(e,i){if(!e.mediaGroups.AUDIO||!i)return null;var r=e.mediaGroups.AUDIO[i];if(!r)return null;for(var l in r){var d=r[l];if(d.default&&d.playlists)return kt(d.playlists[0].attributes.CODECS)}return null},mt=function(e){return e===void 0&&(e=""),we.video.test(e.trim().toLowerCase())},rt=function(e){return e===void 0&&(e=""),we.audio.test(e.trim().toLowerCase())},Kt=function(e){return e===void 0&&(e=""),we.text.test(e.trim().toLowerCase())},_t=function(e){if(!(!e||typeof e!="string")){var i=e.toLowerCase().split(",").map(function(d){return $e(d.trim())}),r="video";i.length===1&&rt(i[0])?r="audio":i.length===1&&Kt(i[0])&&(r="application");var l="mp4";return i.every(function(d){return we.mp4.test(d)})?l="mp4":i.every(function(d){return we.webm.test(d)})?l="webm":i.every(function(d){return we.ogg.test(d)})&&(l="ogg"),r+"/"+l+';codecs="'+e+'"'}},Gt=function(e){return e===void 0&&(e=""),le().MediaSource&&le().MediaSource.isTypeSupported&&le().MediaSource.isTypeSupported(_t(e))||!1},li=function(e){return e===void 0&&(e=""),e.toLowerCase().split(",").every(function(i){i=i.trim();for(var r=0;r<Ie.length;r++){var l=Ie[r];if(we["muxer"+l].test(i))return!0}return!1})},ei="mp4a.40.2",Ti="avc1.4d400d",vi=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,Et=/^application\/dash\+xml/i,oi=function(e){return vi.test(e)?"hls":Et.test(e)?"dash":e==="application/vnd.videojs.vhs+json"?"vhs-json":null},ai=function(e,i){for(var r="";i--;)r+=e;return r},zi=function(e){return e.toString(2).length},mn=function(e){return Math.ceil(zi(e)/8)},Gi=function(e,i,r){return r===void 0&&(r=" "),(ai(r,i)+e.toString()).slice(-i)},en=function(e){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer},ln=function(e){return en(e)},gt=function(e){return e instanceof Uint8Array?e:(!Array.isArray(e)&&!ln(e)&&!(e instanceof ArrayBuffer)&&(typeof e!="number"||typeof e=="number"&&e!==e?e=0:e=[e]),new Uint8Array(e&&e.buffer||e,e&&e.byteOffset||0,e&&e.byteLength||0))},Ai=function(e){e=gt(e);for(var i="",r=0;r<e.length;r++)i+=Gi(e[r].toString(16),2,"0");return i},ki=function(e){e=gt(e);for(var i="",r=0;r<e.length;r++)i+=Gi(e[r].toString(2),8,"0");return i},ui=le().BigInt||Number,Ln=[ui("0x1"),ui("0x100"),ui("0x10000"),ui("0x1000000"),ui("0x100000000"),ui("0x10000000000"),ui("0x1000000000000"),ui("0x100000000000000"),ui("0x10000000000000000")],Kr=function(){var s=new Uint16Array([65484]),e=new Uint8Array(s.buffer,s.byteOffset,s.byteLength);return e[0]===255?"big":e[0]===204?"little":"unknown"}(),Is=Kr==="big",rn=Kr==="little",Rs=function(e,i){var r=i===void 0?{}:i,l=r.signed,d=l===void 0?!1:l,f=r.le,y=f===void 0?!1:f;e=gt(e);var L=y?"reduce":"reduceRight",B=e[L]?e[L]:Array.prototype[L],W=B.call(e,function(ke,Pe,be){var je=y?be:Math.abs(be+1-e.length);return ke+ui(Pe)*Ln[je]},ui(0));if(d){var ce=Ln[e.length]/ui(2)-ui(1);W=ui(W),W>ce&&(W-=ce,W-=ce,W-=ui(2))}return Number(W)},Ye=function(e,i){var r=i===void 0?{}:i,l=r.le,d=l===void 0?!1:l;(typeof e!="bigint"&&typeof e!="number"||typeof e=="number"&&e!==e)&&(e=0),e=ui(e);for(var f=mn(e),y=new Uint8Array(new ArrayBuffer(f)),L=0;L<f;L++){var B=d?L:Math.abs(L+1-y.length);y[B]=Number(e/Ln[L]&ui(255)),e<0&&(y[B]=Math.abs(~y[B]),y[B]-=L===0?1:2)}return y},De=function(e){if(!e)return"";e=Array.prototype.slice.call(e);var i=String.fromCharCode.apply(null,gt(e));try{return decodeURIComponent(escape(i))}catch(r){}return i},yt=function(e,i){if(typeof e!="string"&&e&&typeof e.toString=="function"&&(e=e.toString()),typeof e!="string")return new Uint8Array;i||(e=unescape(encodeURIComponent(e)));for(var r=new Uint8Array(e.length),l=0;l<e.length;l++)r[l]=e.charCodeAt(l);return r},Ct=function(){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];if(i=i.filter(function(y){return y&&(y.byteLength||y.length)&&typeof y!="string"}),i.length<=1)return gt(i[0]);var l=i.reduce(function(y,L,B){return y+(L.byteLength||L.length)},0),d=new Uint8Array(l),f=0;return i.forEach(function(y){y=gt(y),d.set(y,f),f+=y.byteLength}),d},wt=function(e,i,r){var l=r===void 0?{}:r,d=l.offset,f=d===void 0?0:d,y=l.mask,L=y===void 0?[]:y;e=gt(e),i=gt(i);var B=i.every?i.every:Array.prototype.every;return i.length&&e.length-f>=i.length&&B.call(i,function(W,ce){var ke=L[ce]?L[ce]&e[f+ce]:e[f+ce];return W===ke})},Dt=function(e,i,r){return Uint8Array.prototype.slice?Uint8Array.prototype.slice.call(e,i,r):new Uint8Array(Array.prototype.slice.call(e,i,r))},Ni=function(e){return e.reverse?e.reverse():Array.prototype.reverse.call(e)},fi=function(e,i,r){i.forEach(function(l){for(var d in e.mediaGroups[l])for(var f in e.mediaGroups[l][d]){var y=e.mediaGroups[l][d][f];r(y,l,d,f)}})},Dn=pt(48764).Buffer,Ut=function(e){return le().atob?le().atob(e):Dn.from(e,"base64").toString("binary")};function Xn(s){for(var e=Ut(s),i=new Uint8Array(e.length),r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return i}var Ps=pt(3969);/*! @name mpd-parser @version 1.3.0 @license Apache-2.0 */var ur="1.3.0";const Lr=s=>!!s&&typeof s=="object",Mt=(...s)=>s.reduce((e,i)=>(typeof i!="object"||Object.keys(i).forEach(r=>{Array.isArray(e[r])&&Array.isArray(i[r])?e[r]=e[r].concat(i[r]):Lr(e[r])&&Lr(i[r])?e[r]=Mt(e[r],i[r]):e[r]=i[r]}),e),{}),ls=s=>Object.keys(s).map(e=>s[e]),us=(s,e)=>{const i=[];for(let r=s;r<e;r++)i.push(r);return i},dr=s=>s.reduce((e,i)=>e.concat(i),[]),cr=s=>{if(!s.length)return[];const e=[];for(let i=0;i<s.length;i++)e.push(s[i]);return e},vn=(s,e)=>s.reduce((i,r,l)=>(r[e]&&i.push(l),i),[]),kn=(s,e)=>ls(s.reduce((i,r)=>(r.forEach(l=>{i[e(l)]=l}),i),{}));var Qn={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",INVALID_NUMBER_OF_CONTENT_STEERING:"INVALID_NUMBER_OF_CONTENT_STEERING",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",MISSING_SEGMENT_INFORMATION:"MISSING_SEGMENT_INFORMATION",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"};const Jn=({baseUrl:s="",source:e="",range:i="",indexRange:r=""})=>{const l={uri:e,resolvedUri:O(s||"",e)};if(i||r){const f=(i||r).split("-");let y=le().BigInt?le().BigInt(f[0]):parseInt(f[0],10),L=le().BigInt?le().BigInt(f[1]):parseInt(f[1],10);y<Number.MAX_SAFE_INTEGER&&typeof y=="bigint"&&(y=Number(y)),L<Number.MAX_SAFE_INTEGER&&typeof L=="bigint"&&(L=Number(L));let B;typeof L=="bigint"||typeof y=="bigint"?B=le().BigInt(L)-le().BigInt(y)+le().BigInt(1):B=L-y+1,typeof B=="bigint"&&B<Number.MAX_SAFE_INTEGER&&(B=Number(B)),l.byterange={length:B,offset:y}}return l},Ao=s=>{let e;return typeof s.offset=="bigint"||typeof s.length=="bigint"?e=le().BigInt(s.offset)+le().BigInt(s.length)-le().BigInt(1):e=s.offset+s.length-1,`${s.offset}-${e}`},te=s=>(s&&typeof s!="number"&&(s=parseInt(s,10)),isNaN(s)?null:s),oe={static(s){const{duration:e,timescale:i=1,sourceDuration:r,periodDuration:l}=s,d=te(s.endNumber),f=e/i;return typeof d=="number"?{start:0,end:d}:typeof l=="number"?{start:0,end:l/f}:{start:0,end:r/f}},dynamic(s){const{NOW:e,clientOffset:i,availabilityStartTime:r,timescale:l=1,duration:d,periodStart:f=0,minimumUpdatePeriod:y=0,timeShiftBufferDepth:L=Infinity}=s,B=te(s.endNumber),W=(e+i)/1e3,ce=r+f,Pe=W+y-ce,be=Math.ceil(Pe*l/d),je=Math.floor((W-ce-L)*l/d),We=Math.floor((W-ce)*l/d);return{start:Math.max(0,je),end:typeof B=="number"?B:Math.min(be,We)}}},Se=s=>e=>{const{duration:i,timescale:r=1,periodStart:l,startNumber:d=1}=s;return{number:d+e,duration:i/r,timeline:l,time:e*i}},qe=s=>{const{type:e,duration:i,timescale:r=1,periodDuration:l,sourceDuration:d}=s,{start:f,end:y}=oe[e](s),L=us(f,y).map(Se(s));if(e==="static"){const B=L.length-1,W=typeof l=="number"?l:d;L[B].duration=W-i/r*B}return L},ft=s=>{const{baseUrl:e,initialization:i={},sourceDuration:r,indexRange:l="",periodStart:d,presentationTime:f,number:y=0,duration:L}=s;if(!e)throw new Error(Qn.NO_BASE_URL);const B=Jn({baseUrl:e,source:i.sourceURL,range:i.range}),W=Jn({baseUrl:e,source:e,indexRange:l});if(W.map=B,L){const ce=qe(s);ce.length&&(W.duration=ce[0].duration,W.timeline=ce[0].timeline)}else r&&(W.duration=r,W.timeline=d);return W.presentationTime=f||d,W.number=y,[W]},jt=(s,e,i)=>{const r=s.sidx.map?s.sidx.map:null,l=s.sidx.duration,d=s.timeline||0,f=s.sidx.byterange,y=f.offset+f.length,L=e.timescale,B=e.references.filter(We=>We.referenceType!==1),W=[],ce=s.endList?"static":"dynamic",ke=s.sidx.timeline;let Pe=ke,be=s.mediaSequence||0,je;typeof e.firstOffset=="bigint"?je=le().BigInt(y)+e.firstOffset:je=y+e.firstOffset;for(let We=0;We<B.length;We++){const Je=e.references[We],He=Je.referencedSize,dt=Je.subsegmentDuration;let tt;typeof je=="bigint"?tt=je+le().BigInt(He)-le().BigInt(1):tt=je+He-1;const Ue=`${je}-${tt}`,Vt=ft({baseUrl:i,timescale:L,timeline:d,periodStart:ke,presentationTime:Pe,number:be,duration:dt,sourceDuration:l,indexRange:Ue,type:ce})[0];r&&(Vt.map=r),W.push(Vt),typeof je=="bigint"?je+=le().BigInt(He):je+=He,Pe+=dt/L,be++}return s.segments=W,s},Si=["AUDIO","SUBTITLES"],Ii=1/60,un=s=>kn(s,({timeline:e})=>e).sort((e,i)=>e.timeline>i.timeline?1:-1),gn=(s,e)=>{for(let i=0;i<s.length;i++)if(s[i].attributes.NAME===e)return s[i];return null},In=s=>{let e=[];return fi(s,Si,(i,r,l,d)=>{e=e.concat(i.playlists||[])}),e},jn=({playlist:s,mediaSequence:e})=>{s.mediaSequence=e,s.segments.forEach((i,r)=>{i.number=s.mediaSequence+r})},Zn=({oldPlaylists:s,newPlaylists:e,timelineStarts:i})=>{e.forEach(r=>{r.discontinuitySequence=i.findIndex(function({timeline:L}){return L===r.timeline});const l=gn(s,r.attributes.NAME);if(!l||r.sidx)return;const d=r.segments[0],f=l.segments.findIndex(function(L){return Math.abs(L.presentationTime-d.presentationTime)<Ii});if(f===-1){jn({playlist:r,mediaSequence:l.mediaSequence+l.segments.length}),r.segments[0].discontinuity=!0,r.discontinuityStarts.unshift(0),(!l.segments.length&&r.timeline>l.timeline||l.segments.length&&r.timeline>l.segments[l.segments.length-1].timeline)&&r.discontinuitySequence--;return}l.segments[f].discontinuity&&!d.discontinuity&&(d.discontinuity=!0,r.discontinuityStarts.unshift(0),r.discontinuitySequence--),jn({playlist:r,mediaSequence:l.segments[f].number})})},er=({oldManifest:s,newManifest:e})=>{const i=s.playlists.concat(In(s)),r=e.playlists.concat(In(e));return e.timelineStarts=un([s.timelineStarts,e.timelineStarts]),Zn({oldPlaylists:i,newPlaylists:r,timelineStarts:e.timelineStarts}),e},yn=s=>s&&s.uri+"-"+Ao(s.byterange),Hi=s=>{const e=s.reduce(function(r,l){return r[l.attributes.baseUrl]||(r[l.attributes.baseUrl]=[]),r[l.attributes.baseUrl].push(l),r},{});let i=[];return Object.values(e).forEach(r=>{const l=ls(r.reduce((d,f)=>{const y=f.attributes.id+(f.attributes.lang||"");return d[y]?(f.segments&&(f.segments[0]&&(f.segments[0].discontinuity=!0),d[y].segments.push(...f.segments)),f.attributes.contentProtection&&(d[y].attributes.contentProtection=f.attributes.contentProtection)):(d[y]=f,d[y].attributes.timelineStarts=[]),d[y].attributes.timelineStarts.push({start:f.attributes.periodStart,timeline:f.attributes.periodStart}),d},{}));i=i.concat(l)}),i.map(r=>(r.discontinuityStarts=vn(r.segments||[],"discontinuity"),r))},Tn=(s,e)=>{const i=yn(s.sidx),r=i&&e[i]&&e[i].sidx;return r&&jt(s,r,s.sidx.resolvedUri),s},hr=(s,e={})=>{if(!Object.keys(e).length)return s;for(const i in s)s[i]=Tn(s[i],e);return s},Dr=({attributes:s,segments:e,sidx:i,mediaSequence:r,discontinuitySequence:l,discontinuityStarts:d},f)=>{const y={attributes:{NAME:s.id,BANDWIDTH:s.bandwidth,CODECS:s.codecs,["PROGRAM-ID"]:1},uri:"",endList:s.type==="static",timeline:s.periodStart,resolvedUri:s.baseUrl||"",targetDuration:s.duration,discontinuitySequence:l,discontinuityStarts:d,timelineStarts:s.timelineStarts,mediaSequence:r,segments:e};return s.contentProtection&&(y.contentProtection=s.contentProtection),s.serviceLocation&&(y.attributes.serviceLocation=s.serviceLocation),i&&(y.sidx=i),f&&(y.attributes.AUDIO="audio",y.attributes.SUBTITLES="subs"),y},bi=({attributes:s,segments:e,mediaSequence:i,discontinuityStarts:r,discontinuitySequence:l})=>{typeof e=="undefined"&&(e=[{uri:s.baseUrl,timeline:s.periodStart,resolvedUri:s.baseUrl||"",duration:s.sourceDuration,number:0}],s.duration=s.sourceDuration);const d={NAME:s.id,BANDWIDTH:s.bandwidth,["PROGRAM-ID"]:1};s.codecs&&(d.CODECS=s.codecs);const f={attributes:d,uri:"",endList:s.type==="static",timeline:s.periodStart,resolvedUri:s.baseUrl||"",targetDuration:s.duration,timelineStarts:s.timelineStarts,discontinuityStarts:r,discontinuitySequence:l,mediaSequence:i,segments:e};return s.serviceLocation&&(f.attributes.serviceLocation=s.serviceLocation),f},kr=(s,e={},i=!1)=>{let r;const l=s.reduce((d,f)=>{const y=f.attributes.role&&f.attributes.role.value||"",L=f.attributes.lang||"";let B=f.attributes.label||"main";if(L&&!f.attributes.label){const ce=y?` (${y})`:"";B=`${f.attributes.lang}${ce}`}d[B]||(d[B]={language:L,autoselect:!0,default:y==="main",playlists:[],uri:""});const W=Tn(Dr(f,i),e);return d[B].playlists.push(W),typeof r=="undefined"&&y==="main"&&(r=f,r.default=!0),d},{});if(!r){const d=Object.keys(l)[0];l[d].default=!0}return l},Ia=(s,e={})=>s.reduce((i,r)=>{const l=r.attributes.label||r.attributes.lang||"text";return i[l]||(i[l]={language:l,default:!1,autoselect:!1,playlists:[],uri:""}),i[l].playlists.push(Tn(bi(r),e)),i},{}),bo=s=>s.reduce((e,i)=>(i&&i.forEach(r=>{const{channel:l,language:d}=r;e[d]={autoselect:!1,default:!1,instreamId:l,language:d},r.hasOwnProperty("aspectRatio")&&(e[d].aspectRatio=r.aspectRatio),r.hasOwnProperty("easyReader")&&(e[d].easyReader=r.easyReader),r.hasOwnProperty("3D")&&(e[d]["3D"]=r["3D"])}),e),{}),fr=({attributes:s,segments:e,sidx:i,discontinuityStarts:r})=>{const l={attributes:{NAME:s.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:s.width,height:s.height},CODECS:s.codecs,BANDWIDTH:s.bandwidth,["PROGRAM-ID"]:1},uri:"",endList:s.type==="static",timeline:s.periodStart,resolvedUri:s.baseUrl||"",targetDuration:s.duration,discontinuityStarts:r,timelineStarts:s.timelineStarts,segments:e};return s.frameRate&&(l.attributes["FRAME-RATE"]=s.frameRate),s.contentProtection&&(l.contentProtection=s.contentProtection),s.serviceLocation&&(l.attributes.serviceLocation=s.serviceLocation),i&&(l.sidx=i),l},sa=({attributes:s})=>s.mimeType==="video/mp4"||s.mimeType==="video/webm"||s.contentType==="video",_o=({attributes:s})=>s.mimeType==="audio/mp4"||s.mimeType==="audio/webm"||s.contentType==="audio",Ra=({attributes:s})=>s.mimeType==="text/vtt"||s.contentType==="text",Pa=(s,e)=>{s.forEach(i=>{i.mediaSequence=0,i.discontinuitySequence=e.findIndex(function({timeline:r}){return r===i.timeline}),!!i.segments&&i.segments.forEach((r,l)=>{r.number=l})})},ds=s=>s?Object.keys(s).reduce((e,i)=>{const r=s[i];return e.concat(r.playlists)},[]):[],aa=({dashPlaylists:s,locations:e,contentSteering:i,sidxMapping:r={},previousManifest:l,eventStream:d})=>{if(!s.length)return{};const{sourceDuration:f,type:y,suggestedPresentationDelay:L,minimumUpdatePeriod:B}=s[0].attributes,W=Hi(s.filter(sa)).map(fr),ce=Hi(s.filter(_o)),ke=Hi(s.filter(Ra)),Pe=s.map(tt=>tt.attributes.captionServices).filter(Boolean),be={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:{AUDIO:{},VIDEO:{},["CLOSED-CAPTIONS"]:{},SUBTITLES:{}},uri:"",duration:f,playlists:hr(W,r)};B>=0&&(be.minimumUpdatePeriod=B*1e3),e&&(be.locations=e),i&&(be.contentSteering=i),y==="dynamic"&&(be.suggestedPresentationDelay=L),d&&d.length>0&&(be.eventStream=d);const je=be.playlists.length===0,We=ce.length?kr(ce,r,je):null,Je=ke.length?Ia(ke,r):null,He=W.concat(ds(We),ds(Je)),dt=He.map(({timelineStarts:tt})=>tt);return be.timelineStarts=un(dt),Pa(He,be.timelineStarts),We&&(be.mediaGroups.AUDIO.audio=We),Je&&(be.mediaGroups.SUBTITLES.subs=Je),Pe.length&&(be.mediaGroups["CLOSED-CAPTIONS"].cc=bo(Pe)),l?er({oldManifest:l,newManifest:be}):be},cs=(s,e,i)=>{const{NOW:r,clientOffset:l,availabilityStartTime:d,timescale:f=1,periodStart:y=0,minimumUpdatePeriod:L=0}=s,B=(r+l)/1e3,W=d+y,ke=B+L-W;return Math.ceil((ke*f-e)/i)},Os=(s,e)=>{const{type:i,minimumUpdatePeriod:r=0,media:l="",sourceDuration:d,timescale:f=1,startNumber:y=1,periodStart:L}=s,B=[];let W=-1;for(let ce=0;ce<e.length;ce++){const ke=e[ce],Pe=ke.d,be=ke.r||0,je=ke.t||0;W<0&&(W=je),je&&je>W&&(W=je);let We;if(be<0){const dt=ce+1;dt===e.length?i==="dynamic"&&r>0&&l.indexOf("$Number$")>0?We=cs(s,W,Pe):We=(d*f-W)/Pe:We=(e[dt].t-W)/Pe}else We=be+1;const Je=y+B.length+We;let He=y+B.length;for(;He<Je;)B.push({number:He,duration:Pe/f,time:W,timeline:L}),W+=Pe,He++}return B},xo=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,hs=s=>(e,i,r,l)=>{if(e==="$$")return"$";if(typeof s[i]=="undefined")return e;const d=""+s[i];return i==="RepresentationID"||(r?l=parseInt(l,10):l=1,d.length>=l)?d:`${new Array(l-d.length+1).join("0")}${d}`},Ir=(s,e)=>s.replace(xo,hs(e)),oa=(s,e)=>!s.duration&&!e?[{number:s.startNumber||1,duration:s.sourceDuration,time:0,timeline:s.periodStart}]:s.duration?qe(s):Os(s,e),Eo=(s,e)=>{const i={RepresentationID:s.id,Bandwidth:s.bandwidth||0},{initialization:r={sourceURL:"",range:""}}=s,l=Jn({baseUrl:s.baseUrl,source:Ir(r.sourceURL,i),range:r.range});return oa(s,e).map(f=>{i.Number=f.number,i.Time=f.time;const y=Ir(s.media||"",i),L=s.timescale||1,B=s.presentationTimeOffset||0,W=s.periodStart+(f.time-B)/L;return{uri:y,timeline:f.timeline,duration:f.duration,resolvedUri:O(s.baseUrl||"",y),map:l,number:f.number,presentationTime:W}})},la=(s,e)=>{const{baseUrl:i,initialization:r={}}=s,l=Jn({baseUrl:i,source:r.sourceURL,range:r.range}),d=Jn({baseUrl:i,source:e.media,range:e.mediaRange});return d.map=l,d},fs=(s,e)=>{const{duration:i,segmentUrls:r=[],periodStart:l}=s;if(!i&&!e||i&&e)throw new Error(Qn.SEGMENT_TIME_UNSPECIFIED);const d=r.map(L=>la(s,L));let f;return i&&(f=qe(s)),e&&(f=Os(s,e)),f.map((L,B)=>{if(d[B]){const W=d[B],ce=s.timescale||1,ke=s.presentationTimeOffset||0;return W.timeline=L.timeline,W.duration=L.duration,W.number=L.number,W.presentationTime=l+(L.time-ke)/ce,W}}).filter(L=>L)},Dl=({attributes:s,segmentInfo:e})=>{let i,r;e.template?(r=Eo,i=Mt(s,e.template)):e.base?(r=ft,i=Mt(s,e.base)):e.list&&(r=fs,i=Mt(s,e.list));const l={attributes:s};if(!r)return l;const d=r(i,e.segmentTimeline);if(i.duration){const{duration:f,timescale:y=1}=i;i.duration=f/y}else d.length?i.duration=d.reduce((f,y)=>Math.max(f,Math.ceil(y.duration)),0):i.duration=0;return l.attributes=i,l.segments=d,e.base&&i.indexRange&&(l.sidx=d[0],l.segments=[]),l},pr=s=>s.map(Dl),wi=(s,e)=>cr(s.childNodes).filter(({tagName:i})=>i===e),dn=s=>s.textContent.trim(),ps=s=>parseFloat(s.split("/").reduce((e,i)=>e/i)),Rr=s=>{const e=365*24*60*60,i=30*24*60*60,r=24*60*60,l=60*60,d=60,y=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(s);if(!y)return 0;const[L,B,W,ce,ke,Pe]=y.slice(1);return parseFloat(L||0)*e+parseFloat(B||0)*i+parseFloat(W||0)*r+parseFloat(ce||0)*l+parseFloat(ke||0)*d+parseFloat(Pe||0)},kl=s=>(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(s)&&(s+="Z"),Date.parse(s)),Oa={mediaPresentationDuration(s){return Rr(s)},availabilityStartTime(s){return kl(s)/1e3},minimumUpdatePeriod(s){return Rr(s)},suggestedPresentationDelay(s){return Rr(s)},type(s){return s},timeShiftBufferDepth(s){return Rr(s)},start(s){return Rr(s)},width(s){return parseInt(s,10)},height(s){return parseInt(s,10)},bandwidth(s){return parseInt(s,10)},frameRate(s){return ps(s)},startNumber(s){return parseInt(s,10)},timescale(s){return parseInt(s,10)},presentationTimeOffset(s){return parseInt(s,10)},duration(s){const e=parseInt(s,10);return isNaN(e)?Rr(s):e},d(s){return parseInt(s,10)},t(s){return parseInt(s,10)},r(s){return parseInt(s,10)},presentationTime(s){return parseInt(s,10)},DEFAULT(s){return s}},Yi=s=>s&&s.attributes?cr(s.attributes).reduce((e,i)=>{const r=Oa[i.name]||Oa.DEFAULT;return e[i.name]=r(i.value),e},{}):{},ua={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime","urn:mpeg:dash:mp4protection:2011":"mp4protection"},Bs=(s,e)=>e.length?dr(s.map(function(i){return e.map(function(r){const l=dn(r),d=O(i.baseUrl,l),f=Mt(Yi(r),{baseUrl:d});return d!==l&&!f.serviceLocation&&i.serviceLocation&&(f.serviceLocation=i.serviceLocation),f})})):s,qi=s=>{const e=wi(s,"SegmentTemplate")[0],i=wi(s,"SegmentList")[0],r=i&&wi(i,"SegmentURL").map(ce=>Mt({tag:"SegmentURL"},Yi(ce))),l=wi(s,"SegmentBase")[0],d=i||e,f=d&&wi(d,"SegmentTimeline")[0],y=i||l||e,L=y&&wi(y,"Initialization")[0],B=e&&Yi(e);B&&L?B.initialization=L&&Yi(L):B&&B.initialization&&(B.initialization={sourceURL:B.initialization});const W={template:B,segmentTimeline:f&&wi(f,"S").map(ce=>Yi(ce)),list:i&&Mt(Yi(i),{segmentUrls:r,initialization:Yi(L)}),base:l&&Mt(Yi(l),{initialization:Yi(L)})};return Object.keys(W).forEach(ce=>{W[ce]||delete W[ce]}),W},di=(s,e,i)=>r=>{const l=wi(r,"BaseURL"),d=Bs(e,l),f=Mt(s,Yi(r)),y=qi(r);return d.map(L=>({segmentInfo:Mt(i,y),attributes:Mt(f,L)}))},Wt=s=>s.reduce((e,i)=>{const r=Yi(i);r.schemeIdUri&&(r.schemeIdUri=r.schemeIdUri.toLowerCase());const l=ua[r.schemeIdUri];if(l){e[l]={attributes:r};const d=wi(i,"cenc:pssh")[0];if(d){const f=dn(d);e[l].pssh=f&&Xn(f)}}return e},{}),da=s=>{if(s.schemeIdUri==="urn:scte:dash:cc:cea-608:2015")return(typeof s.value!="string"?[]:s.value.split(";")).map(i=>{let r,l;return l=i,/^CC\d=/.test(i)?[r,l]=i.split("="):/^CC\d$/.test(i)&&(r=i),{channel:r,language:l}});if(s.schemeIdUri==="urn:scte:dash:cc:cea-708:2015")return(typeof s.value!="string"?[]:s.value.split(";")).map(i=>{const r={channel:void 0,language:void 0,aspectRatio:1,easyReader:0,"3D":0};if(/=/.test(i)){const[l,d=""]=i.split("=");r.channel=l,r.language=i,d.split(",").forEach(f=>{const[y,L]=f.split(":");y==="lang"?r.language=L:y==="er"?r.easyReader=Number(L):y==="war"?r.aspectRatio=Number(L):y==="3D"&&(r["3D"]=Number(L))})}else r.language=i;return r.channel&&(r.channel="SERVICE"+r.channel),r})},Ba=s=>dr(wi(s.node,"EventStream").map(e=>{const i=Yi(e),r=i.schemeIdUri;return wi(e,"Event").map(l=>{const d=Yi(l),f=d.presentationTime||0,y=i.timescale||1,L=d.duration||0,B=f/y+s.attributes.start;return{schemeIdUri:r,value:i.value,id:d.id,start:B,end:B+L/y,messageData:dn(l)||d.messageData,contentEncoding:i.contentEncoding,presentationTimeOffset:i.presentationTimeOffset||0}})})),Ma=(s,e,i)=>r=>{const l=Yi(r),d=Bs(e,wi(r,"BaseURL")),f=wi(r,"Role")[0],y={role:Yi(f)};let L=Mt(s,l,y);const B=wi(r,"Accessibility")[0],W=da(Yi(B));W&&(L=Mt(L,{captionServices:W}));const ce=wi(r,"Label")[0];if(ce&&ce.childNodes.length){const We=ce.childNodes[0].nodeValue.trim();L=Mt(L,{label:We})}const ke=Wt(wi(r,"ContentProtection"));Object.keys(ke).length&&(L=Mt(L,{contentProtection:ke}));const Pe=qi(r),be=wi(r,"Representation"),je=Mt(i,Pe);return dr(be.map(di(L,d,je)))},Wr=(s,e)=>(i,r)=>{const l=Bs(e,wi(i.node,"BaseURL")),d=Mt(s,{periodStart:i.attributes.start});typeof i.attributes.duration=="number"&&(d.periodDuration=i.attributes.duration);const f=wi(i.node,"AdaptationSet"),y=qi(i.node);return dr(f.map(Ma(d,l,y)))},To=(s,e)=>{if(s.length>1&&e({type:"warn",message:"The MPD manifest should contain no more than one ContentSteering tag"}),!s.length)return null;const i=Mt({serverURL:dn(s[0])},Yi(s[0]));return i.queryBeforeStart=i.queryBeforeStart==="true",i},ms=({attributes:s,priorPeriodAttributes:e,mpdType:i})=>typeof s.start=="number"?s.start:e&&typeof e.start=="number"&&typeof e.duration=="number"?e.start+e.duration:!e&&i==="static"?0:null,Fa=(s,e={})=>{const{manifestUri:i="",NOW:r=Date.now(),clientOffset:l=0,eventHandler:d=function(){}}=e,f=wi(s,"Period");if(!f.length)throw new Error(Qn.INVALID_NUMBER_OF_PERIOD);const y=wi(s,"Location"),L=Yi(s),B=Bs([{baseUrl:i}],wi(s,"BaseURL")),W=wi(s,"ContentSteering");L.type=L.type||"static",L.sourceDuration=L.mediaPresentationDuration||0,L.NOW=r,L.clientOffset=l,y.length&&(L.locations=y.map(dn));const ce=[];return f.forEach((ke,Pe)=>{const be=Yi(ke),je=ce[Pe-1];be.start=ms({attributes:be,priorPeriodAttributes:je?je.attributes:null,mpdType:L.type}),ce.push({node:ke,attributes:be})}),{locations:L.locations,contentSteeringInfo:To(W,d),representationInfo:dr(ce.map(Wr(L,B))),eventStream:dr(ce.map(Ba))}},So=s=>{if(s==="")throw new Error(Qn.DASH_EMPTY_MANIFEST);const e=new Ps.DOMParser;let i,r;try{i=e.parseFromString(s,"application/xml"),r=i&&i.documentElement.tagName==="MPD"?i.documentElement:null}catch(l){}if(!r||r&&r.getElementsByTagName("parsererror").length>0)throw new Error(Qn.DASH_INVALID_XML);return r},Il=s=>{const e=wi(s,"UTCTiming")[0];if(!e)return null;const i=Yi(e);switch(i.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":i.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":i.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":i.method="DIRECT",i.value=Date.parse(i.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(Qn.UNSUPPORTED_UTC_TIMING_SCHEME)}return i},Na=null,$n=(s,e={})=>{const i=Fa(So(s),e),r=pr(i.representationInfo);return aa({dashPlaylists:r,locations:i.locations,contentSteering:i.contentSteeringInfo,sidxMapping:e.sidxMapping,previousManifest:e.previousManifest,eventStream:i.eventStream})},Rl=s=>Il(So(s));var Ua=pt(84221),Co=pt.n(Ua),ca=gt([73,68,51]),ja=function(e,i){i===void 0&&(i=0),e=gt(e);var r=e[i+5],l=e[i+6]<<21|e[i+7]<<14|e[i+8]<<7|e[i+9],d=(r&16)>>4;return d?l+20:l+10},Ms=function s(e,i){return i===void 0&&(i=0),e=gt(e),e.length-i<10||!wt(e,ca,{offset:i})?i:(i+=ja(e,i),s(e,i))},ed=function(e){var i="",r=e[1]>>>3,l=e[1]&31,d=e[2]>>>7,f=(e[2]&64)>>6,y=(e[2]&32)>>5,L=(e[2]&16)>>4,B=(e[2]&8)>>3,W=(e[2]&4)>>2,ce=e[2]&3;i+=r+"."+padStart(l,2,"0"),d===0?i+="M":d===1&&(i+="H");var ke;return r===2&&f?ke=y?12:10:ke=f?10:8,i+="."+padStart(ke,2,"0"),i+="."+L,i+="."+B+W+ce,i},td=function(e){var i=toHexString(e[1]),r=toHexString(e[2]&252),l=toHexString(e[3]);return""+i+r+l},wo=function(e){var i="",r=e[1]>>6,l=e[1]&31,d=(e[1]&32)>>5,f=e.subarray(2,6),y=e.subarray(6,12),L=e[12];r===1?i+="A":r===2?i+="B":r===3&&(i+="C"),i+=l+".";var B=parseInt(toBinaryString(f).split("").reverse().join(""),2);B>255&&(B=parseInt(toBinaryString(f),2)),i+=B.toString(16)+".",d===0?i+="L":i+="H",i+=L;for(var W="",ce=0;ce<y.length;ce++){var ke=y[ce];ke&&(W&&(W+="."),W+=ke.toString(16))}return W&&(i+="."+W),i},id=new Uint8Array([79,112,117,115,72,101,97,100]),$a=function(e){var i=new DataView(e.buffer,e.byteOffset,e.byteLength),r=i.getUint8(0),l=r!==0,d={version:r,channels:i.getUint8(1),preSkip:i.getUint16(2,l),sampleRate:i.getUint32(4,l),outputGain:i.getUint16(8,l),channelMappingFamily:i.getUint8(10)};if(d.channelMappingFamily>0&&e.length>10){d.streamCount=i.getUint8(11),d.twoChannelStreamCount=i.getUint8(12),d.channelMapping=[];for(var f=0;f<d.channels;f++)d.channelMapping.push(i.getUint8(13+f))}return d},nd=function(e){var i=e.channelMappingFamily<=0?11:12+e.channels,r=new DataView(new ArrayBuffer(i)),l=e.version!==0;return r.setUint8(0,e.version),r.setUint8(1,e.channels),r.setUint16(2,e.preSkip,l),r.setUint32(4,e.sampleRate,l),r.setUint16(8,e.outputGain,l),r.setUint8(10,e.channelMappingFamily),e.channelMappingFamily>0&&(r.setUint8(11,e.streamCount),e.channelMapping.foreach(function(d,f){r.setUint8(12+f,d)})),new Uint8Array(r.buffer)},zr=function(e){return typeof e=="string"?yt(e):(typeof e=="number",e)},Pl=function(e){return Array.isArray(e)?e.map(function(i){return zr(i)}):[zr(e)]},ha,Pr=function(e){e=gt(e);for(var i=[],r=0;e.length>r;){var l=e[r],d=0,f=0;f++;var y=e[f];for(f++;y&128;)d=(y&127)<<7,y=e[f],f++;d+=y&127;for(var L=0;L<ha.length;L++){var B=ha[L],W=B.id,ce=B.parser;if(l===W){i.push(ce(e.subarray(f,f+d)));break}}r+=d+f}return i};ha=[{id:3,parser:function(e){var i={tag:3,id:e[0]<<8|e[1],flags:e[2],size:3,dependsOnEsId:0,ocrEsId:0,descriptors:[],url:""};if(i.flags&128&&(i.dependsOnEsId=e[i.size]<<8|e[i.size+1],i.size+=2),i.flags&64){var r=e[i.size];i.url=De(e.subarray(i.size+1,i.size+1+r)),i.size+=r}return i.flags&32&&(i.ocrEsId=e[i.size]<<8|e[i.size+1],i.size+=2),i.descriptors=Pr(e.subarray(i.size))||[],i}},{id:4,parser:function(e){var i={tag:4,oti:e[0],streamType:e[1],bufferSize:e[2]<<16|e[3]<<8|e[4],maxBitrate:e[5]<<24|e[6]<<16|e[7]<<8|e[8],avgBitrate:e[9]<<24|e[10]<<16|e[11]<<8|e[12],descriptors:Pr(e.subarray(13))};return i}},{id:5,parser:function(e){return{tag:5,bytes:e}}},{id:6,parser:function(e){return{tag:6,bytes:e}}}];var An=function s(e,i,r){r===void 0&&(r=!1),i=Pl(i),e=gt(e);var l=[];if(!i.length)return l;for(var d=0;d<e.length;){var f=(e[d]<<24|e[d+1]<<16|e[d+2]<<8|e[d+3])>>>0,y=e.subarray(d+4,d+8);if(f===0)break;var L=d+f;if(L>e.length){if(r)break;L=e.length}var B=e.subarray(d+8,L);wt(y,i[0])&&(i.length===1?l.push(B):l.push.apply(l,s(B,i.slice(1),r))),d=L}return l},Or=function(e,i){if(i=zr(i),!i.length)return e.subarray(e.length);for(var r=0;r<e.length;){if(bytesMatch(e.subarray(r,r+i.length),i)){var l=(e[r-4]<<24|e[r-3]<<16|e[r-2]<<8|e[r-1])>>>0,d=l>1?r+l:e.byteLength;return e.subarray(r+4,d)}r++}return e.subarray(e.length)},gs=function(e,i,r){i===void 0&&(i=4),r===void 0&&(r=function(L){return bytesToNumber(L)});var l=[];if(!e||!e.length)return l;for(var d=bytesToNumber(e.subarray(4,8)),f=8;d;f+=i,d--)l.push(r(e.subarray(f,f+i)));return l},Ol=function(e,i){for(var r=gs(An(e,["stss"])[0]),l=gs(An(e,["stco"])[0]),d=gs(An(e,["stts"])[0],8,function(yi){return{sampleCount:bytesToNumber(yi.subarray(0,4)),sampleDelta:bytesToNumber(yi.subarray(4,8))}}),f=gs(An(e,["stsc"])[0],12,function(yi){return{firstChunk:bytesToNumber(yi.subarray(0,4)),samplesPerChunk:bytesToNumber(yi.subarray(4,8)),sampleDescriptionIndex:bytesToNumber(yi.subarray(8,12))}}),y=An(e,["stsz"])[0],L=gs(y&&y.length&&y.subarray(4)||null),B=[],W=0;W<l.length;W++){for(var ce=void 0,ke=0;ke<f.length;ke++){var Pe=f[ke],be=W+1>=Pe.firstChunk&&(ke+1>=f.length||W+1<f[ke+1].firstChunk);if(be){ce=Pe.samplesPerChunk;break}}for(var je=l[W],We=0;We<ce;We++){var Je=L[B.length],He=!r.length;r.length&&r.indexOf(B.length+1)!==-1&&(He=!0);for(var dt={keyframe:He,start:je,end:je+Je},tt=0;tt<d.length;tt++){var Ue=d[tt],xt=Ue.sampleCount,Vt=Ue.sampleDelta;if(B.length<=xt){var mi=B.length?B[B.length-1].timestamp:0;dt.timestamp=mi+Vt/i*1e3,dt.duration=Vt;break}}B.push(dt),je+=Je}}return B},Bl=function(e,i){var r=bytesToString(i.subarray(0,4));if(e.type==="video"?(e.info=e.info||{},e.info.width=i[28]<<8|i[29],e.info.height=i[30]<<8|i[31]):e.type==="audio"&&(e.info=e.info||{},e.info.channels=i[20]<<8|i[21],e.info.bitDepth=i[22]<<8|i[23],e.info.sampleRate=i[28]<<8|i[29]),r==="avc1"){var l=Or(i,"avcC");r+="."+getAvcCodec(l),e.info.avcC=l}else if(r==="hvc1"||r==="hev1")r+="."+getHvcCodec(Or(i,"hvcC"));else if(r==="mp4a"||r==="mp4v"){var d=Or(i,"esds"),f=Pr(d.subarray(4))[0],y=f&&f.descriptors.filter(function(He){var dt=He.tag;return dt===4})[0];y?(r+="."+toHexString(y.oti),y.oti===64?r+="."+(y.descriptors[0].bytes[0]>>3).toString():y.oti===32?r+="."+y.descriptors[0].bytes[4].toString():y.oti===221&&(r="vorbis")):e.type==="audio"?r+=".40.2":r+=".20.9"}else if(r==="av01")r+="."+getAv1Codec(Or(i,"av1C"));else if(r==="vp09"){var L=Or(i,"vpcC"),B=L[0],W=L[1],ce=L[2]>>4,ke=(L[2]&15)>>1,Pe=(L[2]&15)>>3,be=L[3],je=L[4],We=L[5];r+="."+padStart(B,2,"0"),r+="."+padStart(W,2,"0"),r+="."+padStart(ce,2,"0"),r+="."+padStart(ke,2,"0"),r+="."+padStart(be,2,"0"),r+="."+padStart(je,2,"0"),r+="."+padStart(We,2,"0"),r+="."+padStart(Pe,2,"0")}else if(r==="theo")r="theora";else if(r==="spex")r="speex";else if(r===".mp3")r="mp4a.40.34";else if(r==="msVo")r="vorbis";else if(r==="Opus"){r="opus";var Je=Or(i,"dOps");e.info.opus=parseOpusHead(Je),e.info.codecDelay=65e5}else r=r.toLowerCase();e.codec=r},rd=function(e,i){i===void 0&&(i=!0),e=toUint8(e);var r=An(e,["moov","trak"],!0),l=[];return r.forEach(function(d){var f={bytes:d},y=An(d,["mdia"])[0],L=An(y,["hdlr"])[0],B=bytesToString(L.subarray(8,12));B==="soun"?f.type="audio":B==="vide"?f.type="video":f.type=B;var W=An(d,["tkhd"])[0];if(W){var ce=new DataView(W.buffer,W.byteOffset,W.byteLength),ke=ce.getUint8(0);f.number=ke===0?ce.getUint32(12):ce.getUint32(20)}var Pe=An(y,["mdhd"])[0];if(Pe){var be=Pe[0],je=be===0?12:20;f.timescale=(Pe[je]<<24|Pe[je+1]<<16|Pe[je+2]<<8|Pe[je+3])>>>0}for(var We=An(y,["minf","stbl"])[0],Je=An(We,["stsd"])[0],He=bytesToNumber(Je.subarray(4,8)),dt=8;He--;){var tt=bytesToNumber(Je.subarray(dt,dt+4)),Ue=Je.subarray(dt+4,dt+4+tt);Bl(f,Ue),dt+=4+tt}i&&(f.frameTable=Ol(We,f.timescale)),l.push(f)}),l},sd=function(e){var i=An(e,["moov","mvhd"],!0)[0];if(!(!i||!i.length)){var r={};return i[0]===1?(r.timestampScale=bytesToNumber(i.subarray(20,24)),r.duration=bytesToNumber(i.subarray(24,32))):(r.timestampScale=bytesToNumber(i.subarray(12,16)),r.duration=bytesToNumber(i.subarray(16,20))),r.bytes=i,r}},Ri={EBML:gt([26,69,223,163]),DocType:gt([66,130]),Segment:gt([24,83,128,103]),SegmentInfo:gt([21,73,169,102]),Tracks:gt([22,84,174,107]),Track:gt([174]),TrackNumber:gt([215]),DefaultDuration:gt([35,227,131]),TrackEntry:gt([174]),TrackType:gt([131]),FlagDefault:gt([136]),CodecID:gt([134]),CodecPrivate:gt([99,162]),VideoTrack:gt([224]),AudioTrack:gt([225]),Cluster:gt([31,67,182,117]),Timestamp:gt([231]),TimestampScale:gt([42,215,177]),BlockGroup:gt([160]),BlockDuration:gt([155]),Block:gt([161]),SimpleBlock:gt([163])},Fs=[128,64,32,16,8,4,2,1],Ml=function(e){for(var i=1,r=0;r<Fs.length&&!(e&Fs[r]);r++)i++;return i},Yr=function(e,i,r,l){r===void 0&&(r=!0),l===void 0&&(l=!1);var d=Ml(e[i]),f=e.subarray(i,i+d);return r&&(f=Array.prototype.slice.call(e,i,i+d),f[0]^=Fs[d-1]),{length:d,value:Rs(f,{signed:l}),bytes:f}},Va=function s(e){return typeof e=="string"?e.match(/.{1,2}/g).map(function(i){return s(i)}):typeof e=="number"?Ye(e):e},Lo=function(e){return Array.isArray(e)?e.map(function(i){return Va(i)}):[Va(e)]},Rn=function s(e,i,r){if(r>=i.length)return i.length;var l=Yr(i,r,!1);if(wt(e.bytes,l.bytes))return r;var d=Yr(i,r+l.length);return s(e,i,r+d.length+d.value+l.length)},Pi=function s(e,i){i=Lo(i),e=gt(e);var r=[];if(!i.length)return r;for(var l=0;l<e.length;){var d=Yr(e,l,!1),f=Yr(e,l+d.length),y=l+d.length+f.length;f.value===127&&(f.value=Rn(d,e,y),f.value!==e.length&&(f.value-=y));var L=y+f.value>e.length?e.length:y+f.value,B=e.subarray(y,L);wt(i[0],d.bytes)&&(i.length===1?r.push(B):r=r.concat(s(B,i.slice(1))));var W=d.length+f.length+B.length;l+=W}return r},Do=function(e,i,r,l){var d;i==="group"&&(d=Pi(e,[Ri.BlockDuration])[0],d&&(d=bytesToNumber(d),d=1/r*d*r/1e3),e=Pi(e,[Ri.Block])[0],i="block");var f=new DataView(e.buffer,e.byteOffset,e.byteLength),y=Yr(e,0),L=f.getInt16(y.length,!1),B=e[y.length+2],W=e.subarray(y.length+3),ce=1/r*(l+L)*r/1e3,ke={duration:d,trackNumber:y.value,keyframe:i==="simple"&&B>>7==1,invisible:(B&8)>>3==1,lacing:(B&6)>>1,discardable:i==="simple"&&(B&1)==1,frames:[],pts:ce,dts:ce,timestamp:L};if(!ke.lacing)return ke.frames.push(W),ke;var Pe=W[0]+1,be=[],je=1;if(ke.lacing===2)for(var We=(W.length-je)/Pe,Je=0;Je<Pe;Je++)be.push(We);if(ke.lacing===1)for(var He=0;He<Pe-1;He++){var dt=0;do dt+=W[je],je++;while(W[je-1]===255);be.push(dt)}if(ke.lacing===3)for(var tt=0,Ue=0;Ue<Pe-1;Ue++){var xt=Ue===0?Yr(W,je):Yr(W,je,!0,!0);tt+=xt.value,be.push(tt),je+=xt.length}return be.forEach(function(Vt){ke.frames.push(W.subarray(je,je+Vt)),je+=Vt}),ke},Xr=function(e){for(var i=0,r={};i<e.length;){var l=e[i]&127,d=e[i+1],f=void 0;d===1?f=e[i+2]:f=e.subarray(i+2,i+2+d),l===1?r.profile=f:l===2?r.level=f:l===3?r.bitDepth=f:l===4?r.chromaSubsampling=f:r[l]=f,i+=2+d}return r},Ga=function(e){e=toUint8(e);var i=[],r=Pi(e,[Ri.Segment,Ri.Tracks,Ri.Track]);return r.length||(r=Pi(e,[Ri.Tracks,Ri.Track])),r.length||(r=Pi(e,[Ri.Track])),r.length?(r.forEach(function(l){var d=Pi(l,Ri.TrackType)[0];if(!(!d||!d.length)){if(d[0]===1)d="video";else if(d[0]===2)d="audio";else if(d[0]===17)d="subtitle";else return;var f={rawCodec:bytesToString(Pi(l,[Ri.CodecID])[0]),type:d,codecPrivate:Pi(l,[Ri.CodecPrivate])[0],number:bytesToNumber(Pi(l,[Ri.TrackNumber])[0]),defaultDuration:bytesToNumber(Pi(l,[Ri.DefaultDuration])[0]),default:Pi(l,[Ri.FlagDefault])[0],rawData:l},y="";if(/V_MPEG4\/ISO\/AVC/.test(f.rawCodec))y="avc1."+getAvcCodec(f.codecPrivate);else if(/V_MPEGH\/ISO\/HEVC/.test(f.rawCodec))y="hev1."+getHvcCodec(f.codecPrivate);else if(/V_MPEG4\/ISO\/ASP/.test(f.rawCodec))f.codecPrivate?y="mp4v.20."+f.codecPrivate[4].toString():y="mp4v.20.9";else if(/^V_THEORA/.test(f.rawCodec))y="theora";else if(/^V_VP8/.test(f.rawCodec))y="vp8";else if(/^V_VP9/.test(f.rawCodec))if(f.codecPrivate){var L=Xr(f.codecPrivate),B=L.profile,W=L.level,ce=L.bitDepth,ke=L.chromaSubsampling;y="vp09.",y+=padStart(B,2,"0")+".",y+=padStart(W,2,"0")+".",y+=padStart(ce,2,"0")+".",y+=""+padStart(ke,2,"0");var Pe=Pi(l,[224,[85,176],[85,177]])[0]||[],be=Pi(l,[224,[85,176],[85,185]])[0]||[],je=Pi(l,[224,[85,176],[85,186]])[0]||[],We=Pi(l,[224,[85,176],[85,187]])[0]||[];(Pe.length||be.length||je.length||We.length)&&(y+="."+padStart(We[0],2,"0"),y+="."+padStart(je[0],2,"0"),y+="."+padStart(Pe[0],2,"0"),y+="."+padStart(be[0],2,"0"))}else y="vp9";else/^V_AV1/.test(f.rawCodec)?y="av01."+getAv1Codec(f.codecPrivate):/A_ALAC/.test(f.rawCodec)?y="alac":/A_MPEG\/L2/.test(f.rawCodec)?y="mp2":/A_MPEG\/L3/.test(f.rawCodec)?y="mp3":/^A_AAC/.test(f.rawCodec)?f.codecPrivate?y="mp4a.40."+(f.codecPrivate[0]>>>3).toString():y="mp4a.40.2":/^A_AC3/.test(f.rawCodec)?y="ac-3":/^A_PCM/.test(f.rawCodec)?y="pcm":/^A_MS\/ACM/.test(f.rawCodec)?y="speex":/^A_EAC3/.test(f.rawCodec)?y="ec-3":/^A_VORBIS/.test(f.rawCodec)?y="vorbis":/^A_FLAC/.test(f.rawCodec)?y="flac":/^A_OPUS/.test(f.rawCodec)&&(y="opus");f.codec=y,i.push(f)}}),i.sort(function(l,d){return l.number-d.number})):i},Ha=function(e,i){var r=[],l=Pi(e,[Ri.Segment])[0],d=Pi(l,[Ri.SegmentInfo,Ri.TimestampScale])[0];d&&d.length?d=bytesToNumber(d):d=1e6;var f=Pi(l,[Ri.Cluster]);return i||(i=Ga(l)),f.forEach(function(y,L){var B=Pi(y,[Ri.SimpleBlock]).map(function(Pe){return{type:"simple",data:Pe}}),W=Pi(y,[Ri.BlockGroup]).map(function(Pe){return{type:"group",data:Pe}}),ce=Pi(y,[Ri.Timestamp])[0]||0;ce&&ce.length&&(ce=bytesToNumber(ce));var ke=B.concat(W).sort(function(Pe,be){return Pe.data.byteOffset-be.data.byteOffset});ke.forEach(function(Pe,be){var je=Do(Pe.data,Pe.type,d,ce);r.push(je)})}),{tracks:i,blocks:r}},ko=gt([0,0,0,1]),Qr=gt([0,0,1]),Fl=gt([0,0,3]),fa=function(e){for(var i=[],r=1;r<e.length-2;)wt(e.subarray(r,r+3),Fl)&&(i.push(r+2),r++),r++;if(i.length===0)return e;var l=e.length-i.length,d=new Uint8Array(l),f=0;for(r=0;r<l;f++,r++)f===i[0]&&(f++,i.shift()),d[r]=e[f];return d},pa=function(e,i,r,l){l===void 0&&(l=Infinity),e=gt(e),r=[].concat(r);for(var d=0,f,y=0;d<e.length&&(y<l||f);){var L=void 0;if(wt(e.subarray(d),ko)?L=4:wt(e.subarray(d),Qr)&&(L=3),!L){d++;continue}if(y++,f)return fa(e.subarray(f,d));var B=void 0;i==="h264"?B=e[d+L]&31:i==="h265"&&(B=e[d+L]>>1&63),r.indexOf(B)!==-1&&(f=d+L),d+=L+(i==="h264"?1:2)}return e.subarray(0,0)},Ns=function(e,i,r){return pa(e,"h264",i,r)},Nl=function(e,i,r){return pa(e,"h265",i,r)},pi={webm:gt([119,101,98,109]),matroska:gt([109,97,116,114,111,115,107,97]),flac:gt([102,76,97,67]),ogg:gt([79,103,103,83]),ac3:gt([11,119]),riff:gt([82,73,70,70]),avi:gt([65,86,73]),wav:gt([87,65,86,69]),"3gp":gt([102,116,121,112,51,103]),mp4:gt([102,116,121,112]),fmp4:gt([115,116,121,112]),mov:gt([102,116,121,112,113,116]),moov:gt([109,111,111,118]),moof:gt([109,111,111,102])},Qi={aac:function(e){var i=Ms(e);return wt(e,[255,16],{offset:i,mask:[255,22]})},mp3:function(e){var i=Ms(e);return wt(e,[255,2],{offset:i,mask:[255,6]})},webm:function(e){var i=Pi(e,[Ri.EBML,Ri.DocType])[0];return wt(i,pi.webm)},mkv:function(e){var i=Pi(e,[Ri.EBML,Ri.DocType])[0];return wt(i,pi.matroska)},mp4:function(e){if(Qi["3gp"](e)||Qi.mov(e))return!1;if(wt(e,pi.mp4,{offset:4})||wt(e,pi.fmp4,{offset:4})||wt(e,pi.moof,{offset:4})||wt(e,pi.moov,{offset:4}))return!0},mov:function(e){return wt(e,pi.mov,{offset:4})},"3gp":function(e){return wt(e,pi["3gp"],{offset:4})},ac3:function(e){var i=Ms(e);return wt(e,pi.ac3,{offset:i})},ts:function(e){if(e.length<189&&e.length>=1)return e[0]===71;for(var i=0;i+188<e.length&&i<188;){if(e[i]===71&&e[i+188]===71)return!0;i+=1}return!1},flac:function(e){var i=Ms(e);return wt(e,pi.flac,{offset:i})},ogg:function(e){return wt(e,pi.ogg)},avi:function(e){return wt(e,pi.riff)&&wt(e,pi.avi,{offset:8})},wav:function(e){return wt(e,pi.riff)&&wt(e,pi.wav,{offset:8})},h264:function(e){return Ns(e,7,3).length},h265:function(e){return Nl(e,[32,33],3).length}},qa=Object.keys(Qi).filter(function(s){return s!=="ts"&&s!=="h264"&&s!=="h265"}).concat(["ts","h264","h265"]);qa.forEach(function(s){var e=Qi[s];Qi[s]=function(i){return e(gt(i))}});var Ka=Qi,Br=function(e){e=gt(e);for(var i=0;i<qa.length;i++){var r=qa[i];if(Ka[r](e))return r}return""},Us=function(e){return An(e,["moof"]).length>0},Mr=pt(51489);/**
 * @license
 * Video.js 8.10.0 <http://videojs.com/>
 * Copyright Brightcove, Inc. <https://www.brightcove.com/>
 * Available under Apache License Version 2.0
 * <https://github.com/videojs/video.js/blob/main/LICENSE>
 *
 * Includes vtt.js <https://github.com/mozilla/vtt.js>
 * Available under Apache License Version 2.0
 * <https://github.com/mozilla/vtt.js/blob/main/LICENSE>
 */var ma="8.10.0";const mr={},Pn=function(s,e){return mr[s]=mr[s]||[],e&&(mr[s]=mr[s].concat(e)),mr[s]},Ul=function(s,e){Pn(s,e)},Io=function(s,e){const i=Pn(s).indexOf(e);return i<=-1?!1:(mr[s]=mr[s].slice(),mr[s].splice(i,1),!0)},jl=function(s,e){Pn(s,[].concat(e).map(i=>{const r=(...l)=>(Io(s,r),i(...l));return r}))},Fr={prefixed:!0},On=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"]],Ro=On[0];let js;for(let s=0;s<On.length;s++)if(On[s][1]in Ee()){js=On[s];break}if(js){for(let s=0;s<js.length;s++)Fr[Ro[s]]=js[s];Fr.prefixed=js[0]!==Ro[0]}let Li=[];const ys=(s,e,i)=>(r,l,d)=>{const f=e.levels[l],y=new RegExp(`^(${f})$`);let L=s;if(r!=="log"&&d.unshift(r.toUpperCase()+":"),i&&(L=`%c${s}`,d.unshift(i)),d.unshift(L+":"),Li){Li.push([].concat(d));const W=Li.length-1e3;Li.splice(0,W>0?W:0)}if(!le().console)return;let B=le().console[r];!B&&r==="debug"&&(B=le().console.info||le().console.log),!(!B||!f||!y.test(r))&&B[Array.isArray(d)?"apply":"call"](le().console,d)};function Wa(s,e=":",i=""){let r="info",l;const d=function(...f){l("log",r,f)};return l=ys(s,d,i),d.createLogger=(f,y,L)=>{const B=y!==void 0?y:e,W=L!==void 0?L:i,ce=`${s} ${B} ${f}`;return Wa(ce,B,W)},d.createNewLogger=(f,y,L)=>Wa(f,y,L),d.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:r},d.level=f=>{if(typeof f=="string"){if(!d.levels.hasOwnProperty(f))throw new Error(`"${f}" in not a valid log level`);r=f}return r},d.history=()=>Li?[].concat(Li):[],d.history.filter=f=>(Li||[]).filter(y=>new RegExp(`.*${f}.*`).test(y[0])),d.history.clear=()=>{Li&&(Li.length=0)},d.history.disable=()=>{Li!==null&&(Li.length=0,Li=null)},d.history.enable=()=>{Li===null&&(Li=[])},d.error=(...f)=>l("error",r,f),d.warn=(...f)=>l("warn",r,f),d.debug=(...f)=>l("debug",r,f),d}const ni=Wa("VIDEOJS"),vs=ni.createLogger,Po=Object.prototype.toString,Oo=function(s){return tr(s)?Object.keys(s):[]};function As(s,e){Oo(s).forEach(i=>e(s[i],i))}function Ui(s,e,i=0){return Oo(s).reduce((r,l)=>e(r,s[l],l),i)}function tr(s){return!!s&&typeof s=="object"}function gr(s){return tr(s)&&Po.call(s)==="[object Object]"&&s.constructor===Object}function ci(...s){const e={};return s.forEach(i=>{!i||As(i,(r,l)=>{if(!gr(r)){e[l]=r;return}gr(e[l])||(e[l]={}),e[l]=ci(e[l],r)})}),e}function Bo(s={}){const e=[];for(const i in s)if(s.hasOwnProperty(i)){const r=s[i];e.push(r)}return e}function _i(s,e,i,r=!0){const l=f=>Object.defineProperty(s,e,{value:f,enumerable:!0,writable:!0}),d={configurable:!0,enumerable:!0,get(){const f=i();return l(f),f}};return r&&(d.set=l),Object.defineProperty(s,e,d)}var za=Object.freeze({__proto__:null,each:As,reduce:Ui,isObject:tr,isPlain:gr,merge:ci,values:Bo,defineLazyProperty:_i});let ir=!1,$s=null,cn=!1,Ya,Vs=!1,Jr=!1,bs=!1,Sn=!1,_s=null,Gs=null,Mo=null,yr=!1,Hs=!1,Bn=!1,ga=!1;const vr=Boolean(Ur()&&("ontouchstart"in le()||le().navigator.maxTouchPoints||le().DocumentTouch&&le().document instanceof le().DocumentTouch)),Nr=le().navigator&&le().navigator.userAgentData;if(Nr&&Nr.platform&&Nr.brands&&(cn=Nr.platform==="Android",Jr=Boolean(Nr.brands.find(s=>s.brand==="Microsoft Edge")),bs=Boolean(Nr.brands.find(s=>s.brand==="Chromium")),Sn=!Jr&&bs,_s=Gs=(Nr.brands.find(s=>s.brand==="Chromium")||{}).version||null,Hs=Nr.platform==="Windows"),!bs){const s=le().navigator&&le().navigator.userAgent||"";ir=/iPod/i.test(s),$s=function(){const e=s.match(/OS (\d+)_/i);return e&&e[1]?e[1]:null}(),cn=/Android/i.test(s),Ya=function(){const e=s.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;const i=e[1]&&parseFloat(e[1]),r=e[2]&&parseFloat(e[2]);return i&&r?parseFloat(e[1]+"."+e[2]):i||null}(),Vs=/Firefox/i.test(s),Jr=/Edg/i.test(s),bs=/Chrome/i.test(s)||/CriOS/i.test(s),Sn=!Jr&&bs,_s=Gs=function(){const e=s.match(/(Chrome|CriOS)\/(\d+)/);return e&&e[2]?parseFloat(e[2]):null}(),Mo=function(){const e=/MSIE\s(\d+)\.\d/.exec(s);let i=e&&parseFloat(e[1]);return!i&&/Trident\/7.0/i.test(s)&&/rv:11.0/.test(s)&&(i=11),i}(),yr=/Safari/i.test(s)&&!Sn&&!cn&&!Jr,Hs=/Windows/i.test(s),Bn=/iPad/i.test(s)||yr&&vr&&!/iPhone/i.test(s),ga=/iPhone/i.test(s)&&!Bn}const bn=ga||Bn||ir,ya=(yr||bn)&&!Sn;var Zr=Object.freeze({__proto__:null,get IS_IPOD(){return ir},get IOS_VERSION(){return $s},get IS_ANDROID(){return cn},get ANDROID_VERSION(){return Ya},get IS_FIREFOX(){return Vs},get IS_EDGE(){return Jr},get IS_CHROMIUM(){return bs},get IS_CHROME(){return Sn},get CHROMIUM_VERSION(){return _s},get CHROME_VERSION(){return Gs},get IE_VERSION(){return Mo},get IS_SAFARI(){return yr},get IS_WINDOWS(){return Hs},get IS_IPAD(){return Bn},get IS_IPHONE(){return ga},TOUCH_ENABLED:vr,IS_IOS:bn,IS_ANY_SAFARI:ya});function Fo(s){return typeof s=="string"&&Boolean(s.trim())}function ot(s){if(s.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}function Ur(){return Ee()===le().document}function Vn(s){return tr(s)&&s.nodeType===1}function No(){try{return le().parent!==le().self}catch(s){return!0}}function Uo(s){return function(e,i){if(!Fo(e))return Ee()[s](null);Fo(i)&&(i=Ee().querySelector(i));const r=Vn(i)?i:Ee();return r[s]&&r[s](e)}}function ri(s="div",e={},i={},r){const l=Ee().createElement(s);return Object.getOwnPropertyNames(e).forEach(function(d){const f=e[d];d==="textContent"?jr(l,f):(l[d]!==f||d==="tabIndex")&&(l[d]=f)}),Object.getOwnPropertyNames(i).forEach(function(d){l.setAttribute(d,i[d])}),r&&pe(l,r),l}function jr(s,e){return typeof s.textContent=="undefined"?s.innerText=e:s.textContent=e,s}function Mn(s,e){e.firstChild?e.insertBefore(s,e.firstChild):e.appendChild(s)}function Gn(s,e){return ot(e),s.classList.contains(e)}function $r(s,...e){return s.classList.add(...e.reduce((i,r)=>i.concat(r.split(/\s+/)),[])),s}function va(s,...e){return s?(s.classList.remove(...e.reduce((i,r)=>i.concat(r.split(/\s+/)),[])),s):(ni.warn("removeClass was called with an element that doesn't exist"),null)}function Aa(s,e,i){return typeof i=="function"&&(i=i(s,e)),typeof i!="boolean"&&(i=void 0),e.split(/\s+/).forEach(r=>s.classList.toggle(r,i)),s}function ba(s,e){Object.getOwnPropertyNames(e).forEach(function(i){const r=e[i];r===null||typeof r=="undefined"||r===!1?s.removeAttribute(i):s.setAttribute(i,r===!0?"":r)})}function Hn(s){const e={},i=["autoplay","controls","playsinline","loop","muted","default","defaultMuted"];if(s&&s.attributes&&s.attributes.length>0){const r=s.attributes;for(let l=r.length-1;l>=0;l--){const d=r[l].name;let f=r[l].value;i.includes(d)&&(f=f!==null),e[d]=f}}return e}function es(s,e){return s.getAttribute(e)}function Ar(s,e,i){s.setAttribute(e,i)}function _a(s,e){s.removeAttribute(e)}function jo(){Ee().body.focus(),Ee().onselectstart=function(){return!1}}function T(){Ee().onselectstart=function(){return!0}}function k(s){if(s&&s.getBoundingClientRect&&s.parentNode){const e=s.getBoundingClientRect(),i={};return["bottom","height","left","right","top","width"].forEach(r=>{e[r]!==void 0&&(i[r]=e[r])}),i.height||(i.height=parseFloat(bt(s,"height"))),i.width||(i.width=parseFloat(bt(s,"width"))),i}}function q(s){if(!s||s&&!s.offsetParent)return{left:0,top:0,width:0,height:0};const e=s.offsetWidth,i=s.offsetHeight;let r=0,l=0;for(;s.offsetParent&&s!==Ee()[Fr.fullscreenElement];)r+=s.offsetLeft,l+=s.offsetTop,s=s.offsetParent;return{left:r,top:l,width:e,height:i}}function x(s,e){const i={x:0,y:0};if(bn){let W=s;for(;W&&W.nodeName.toLowerCase()!=="html";){const ce=bt(W,"transform");if(/^matrix/.test(ce)){const ke=ce.slice(7,-1).split(/,\s/).map(Number);i.x+=ke[4],i.y+=ke[5]}else if(/^matrix3d/.test(ce)){const ke=ce.slice(9,-1).split(/,\s/).map(Number);i.x+=ke[12],i.y+=ke[13]}W=W.parentNode}}const r={},l=q(e.target),d=q(s),f=d.width,y=d.height;let L=e.offsetY-(d.top-l.top),B=e.offsetX-(d.left-l.left);return e.changedTouches&&(B=e.changedTouches[0].pageX-d.left,L=e.changedTouches[0].pageY+d.top,bn&&(B-=i.x,L-=i.y)),r.y=1-Math.max(0,Math.min(1,L/y)),r.x=Math.max(0,Math.min(1,B/f)),r}function P(s){return tr(s)&&s.nodeType===3}function F(s){for(;s.firstChild;)s.removeChild(s.firstChild);return s}function Q(s){return typeof s=="function"&&(s=s()),(Array.isArray(s)?s:[s]).map(e=>{if(typeof e=="function"&&(e=e()),Vn(e)||P(e))return e;if(typeof e=="string"&&/\S/.test(e))return Ee().createTextNode(e)}).filter(e=>e)}function pe(s,e){return Q(e).forEach(i=>s.appendChild(i)),s}function ge(s,e){return pe(F(s),e)}function Ve(s){return s.button===void 0&&s.buttons===void 0||s.button===0&&s.buttons===void 0||s.type==="mouseup"&&s.button===0&&s.buttons===0?!0:!(s.button!==0||s.buttons!==1)}const Ke=Uo("querySelector"),vt=Uo("querySelectorAll");function bt(s,e){if(!s||!e)return"";if(typeof le().getComputedStyle=="function"){let i;try{i=le().getComputedStyle(s)}catch(r){return""}return i?i.getPropertyValue(e)||i[e]:""}return""}function Ot(s){[...Ee().styleSheets].forEach(e=>{try{const i=[...e.cssRules].map(l=>l.cssText).join(""),r=Ee().createElement("style");r.textContent=i,s.document.head.appendChild(r)}catch(i){const r=Ee().createElement("link");r.rel="stylesheet",r.type=e.type,r.media=e.media.mediaText,r.href=e.href,s.document.head.appendChild(r)}})}var Tt=Object.freeze({__proto__:null,isReal:Ur,isEl:Vn,isInFrame:No,createEl:ri,textContent:jr,prependTo:Mn,hasClass:Gn,addClass:$r,removeClass:va,toggleClass:Aa,setAttributes:ba,getAttributes:Hn,getAttribute:es,setAttribute:Ar,removeAttribute:_a,blockTextSelection:jo,unblockTextSelection:T,getBoundingClientRect:k,findPosition:q,getPointerPosition:x,isTextNode:P,emptyEl:F,normalizeContent:Q,appendContent:pe,insertContent:ge,isSingleLeftClick:Ve,$:Ke,$$:vt,computedStyle:bt,copyStyleSheetsToWindow:Ot});let At=!1,Ft;const Jt=function(){if(Ft.options.autoSetup===!1)return;const s=Array.prototype.slice.call(Ee().getElementsByTagName("video")),e=Array.prototype.slice.call(Ee().getElementsByTagName("audio")),i=Array.prototype.slice.call(Ee().getElementsByTagName("video-js")),r=s.concat(e,i);if(r&&r.length>0)for(let l=0,d=r.length;l<d;l++){const f=r[l];if(f&&f.getAttribute)f.player===void 0&&f.getAttribute("data-setup")!==null&&Ft(f);else{Ki(1);break}}else At||Ki(1)};function Ki(s,e){!Ur()||(e&&(Ft=e),le().setTimeout(Jt,s))}function ji(){At=!0,le().removeEventListener("load",ji)}Ur()&&(Ee().readyState==="complete"?ji():le().addEventListener("load",ji));const gi=function(s){const e=Ee().createElement("style");return e.className=s,e},br=function(s,e){s.styleSheet?s.styleSheet.cssText=e:s.textContent=e};var Wi=new WeakMap;let Ks=3;function xi(){return Ks++}function ts(s,e){if(!Wi.has(s))return;const i=Wi.get(s);i.handlers[e].length===0&&(delete i.handlers[e],s.removeEventListener?s.removeEventListener(e,i.dispatcher,!1):s.detachEvent&&s.detachEvent("on"+e,i.dispatcher)),Object.getOwnPropertyNames(i.handlers).length<=0&&(delete i.handlers,delete i.dispatcher,delete i.disabled),Object.getOwnPropertyNames(i).length===0&&Wi.delete(s)}function Xa(s,e,i,r){i.forEach(function(l){s(e,l,r)})}function $o(s){if(s.fixed_)return s;function e(){return!0}function i(){return!1}if(!s||!s.isPropagationStopped||!s.isImmediatePropagationStopped){const r=s||le().event;s={};for(const l in r)l!=="layerX"&&l!=="layerY"&&l!=="keyLocation"&&l!=="webkitMovementX"&&l!=="webkitMovementY"&&l!=="path"&&(l==="returnValue"&&r.preventDefault||(s[l]=r[l]));if(s.target||(s.target=s.srcElement||Ee()),s.relatedTarget||(s.relatedTarget=s.fromElement===s.target?s.toElement:s.fromElement),s.preventDefault=function(){r.preventDefault&&r.preventDefault(),s.returnValue=!1,r.returnValue=!1,s.defaultPrevented=!0},s.defaultPrevented=!1,s.stopPropagation=function(){r.stopPropagation&&r.stopPropagation(),s.cancelBubble=!0,r.cancelBubble=!0,s.isPropagationStopped=e},s.isPropagationStopped=i,s.stopImmediatePropagation=function(){r.stopImmediatePropagation&&r.stopImmediatePropagation(),s.isImmediatePropagationStopped=e,s.stopPropagation()},s.isImmediatePropagationStopped=i,s.clientX!==null&&s.clientX!==void 0){const l=Ee().documentElement,d=Ee().body;s.pageX=s.clientX+(l&&l.scrollLeft||d&&d.scrollLeft||0)-(l&&l.clientLeft||d&&d.clientLeft||0),s.pageY=s.clientY+(l&&l.scrollTop||d&&d.scrollTop||0)-(l&&l.clientTop||d&&d.clientTop||0)}s.which=s.charCode||s.keyCode,s.button!==null&&s.button!==void 0&&(s.button=s.button&1?0:s.button&4?1:s.button&2?2:0)}return s.fixed_=!0,s}let Vo;const $l=function(){if(typeof Vo!="boolean"){Vo=!1;try{const s=Object.defineProperty({},"passive",{get(){Vo=!0}});le().addEventListener("test",null,s),le().removeEventListener("test",null,s)}catch(s){}}return Vo},xa=["touchstart","touchmove"];function qn(s,e,i){if(Array.isArray(e))return Xa(qn,s,e,i);Wi.has(s)||Wi.set(s,{});const r=Wi.get(s);if(r.handlers||(r.handlers={}),r.handlers[e]||(r.handlers[e]=[]),i.guid||(i.guid=xi()),r.handlers[e].push(i),r.dispatcher||(r.disabled=!1,r.dispatcher=function(l,d){if(r.disabled)return;l=$o(l);const f=r.handlers[l.type];if(f){const y=f.slice(0);for(let L=0,B=y.length;L<B&&!l.isImmediatePropagationStopped();L++)try{y[L].call(s,l,d)}catch(W){ni.error(W)}}}),r.handlers[e].length===1)if(s.addEventListener){let l=!1;$l()&&xa.indexOf(e)>-1&&(l={passive:!0}),s.addEventListener(e,r.dispatcher,l)}else s.attachEvent&&s.attachEvent("on"+e,r.dispatcher)}function _n(s,e,i){if(!Wi.has(s))return;const r=Wi.get(s);if(!r.handlers)return;if(Array.isArray(e))return Xa(_n,s,e,i);const l=function(f,y){r.handlers[y]=[],ts(f,y)};if(e===void 0){for(const f in r.handlers)Object.prototype.hasOwnProperty.call(r.handlers||{},f)&&l(s,f);return}const d=r.handlers[e];if(!!d){if(!i){l(s,e);return}if(i.guid)for(let f=0;f<d.length;f++)d[f].guid===i.guid&&d.splice(f--,1);ts(s,e)}}function Kn(s,e,i){const r=Wi.has(s)?Wi.get(s):{},l=s.parentNode||s.ownerDocument;if(typeof e=="string"?e={type:e,target:s}:e.target||(e.target=s),e=$o(e),r.dispatcher&&r.dispatcher.call(s,e,i),l&&!e.isPropagationStopped()&&e.bubbles===!0)Kn.call(null,l,e,i);else if(!l&&!e.defaultPrevented&&e.target&&e.target[e.type]){Wi.has(e.target)||Wi.set(e.target,{});const d=Wi.get(e.target);e.target[e.type]&&(d.disabled=!0,typeof e.target[e.type]=="function"&&e.target[e.type](),d.disabled=!1)}return!e.defaultPrevented}function Ge(s,e,i){if(Array.isArray(e))return Xa(Ge,s,e,i);const r=function(){_n(s,e,r),i.apply(this,arguments)};r.guid=i.guid=i.guid||xi(),qn(s,e,r)}function Go(s,e,i){const r=function(){_n(s,e,r),i.apply(this,arguments)};r.guid=i.guid=i.guid||xi(),qn(s,e,r)}var Vl=Object.freeze({__proto__:null,fixEvent:$o,on:qn,off:_n,trigger:Kn,one:Ge,any:Go});const nr=30,Ci=function(s,e,i){e.guid||(e.guid=xi());const r=e.bind(s);return r.guid=i?i+"_"+e.guid:e.guid,r},Vr=function(s,e){let i=le().performance.now();return function(...l){const d=le().performance.now();d-i>=e&&(s(...l),i=d)}},ad=function(s,e,i,r=le()){let l;const d=()=>{r.clearTimeout(l),l=null},f=function(){const y=this,L=arguments;let B=function(){l=null,B=null,i||s.apply(y,L)};!l&&i&&s.apply(y,L),r.clearTimeout(l),l=r.setTimeout(B,e)};return f.cancel=d,f};var od=Object.freeze({__proto__:null,UPDATE_REFRESH_INTERVAL:nr,bind_:Ci,throttle:Vr,debounce:ad});let Qa;class rr{on(e,i){const r=this.addEventListener;this.addEventListener=()=>{},qn(this,e,i),this.addEventListener=r}off(e,i){_n(this,e,i)}one(e,i){const r=this.addEventListener;this.addEventListener=()=>{},Ge(this,e,i),this.addEventListener=r}any(e,i){const r=this.addEventListener;this.addEventListener=()=>{},Go(this,e,i),this.addEventListener=r}trigger(e){const i=e.type||e;typeof e=="string"&&(e={type:i}),e=$o(e),this.allowedEvents_[i]&&this["on"+i]&&this["on"+i](e),Kn(this,e)}queueTrigger(e){Qa||(Qa=new Map);const i=e.type||e;let r=Qa.get(this);r||(r=new Map,Qa.set(this,r));const l=r.get(i);r.delete(i),le().clearTimeout(l);const d=le().setTimeout(()=>{r.delete(i),r.size===0&&(r=null,Qa.delete(this)),this.trigger(e)},0);r.set(i,d)}}rr.prototype.allowedEvents_={},rr.prototype.addEventListener=rr.prototype.on,rr.prototype.removeEventListener=rr.prototype.off,rr.prototype.dispatchEvent=rr.prototype.trigger;const is=s=>typeof s.name=="function"?s.name():typeof s.name=="string"?s.name:s.name_?s.name_:s.constructor&&s.constructor.name?s.constructor.name:typeof s,_r=s=>s instanceof rr||!!s.eventBusEl_&&["on","one","off","trigger"].every(e=>typeof s[e]=="function"),Ho=(s,e)=>{_r(s)?e():(s.eventedCallbacks||(s.eventedCallbacks=[]),s.eventedCallbacks.push(e))},Fn=s=>typeof s=="string"&&/\S/.test(s)||Array.isArray(s)&&!!s.length,qo=(s,e,i)=>{if(!s||!s.nodeName&&!_r(s))throw new Error(`Invalid target for ${is(e)}#${i}; must be a DOM node or evented object.`)},Gl=(s,e,i)=>{if(!Fn(s))throw new Error(`Invalid event type for ${is(e)}#${i}; must be a non-empty string or array.`)},Hl=(s,e,i)=>{if(typeof s!="function")throw new Error(`Invalid listener for ${is(e)}#${i}; must be a function.`)},Ko=(s,e,i)=>{const r=e.length<3||e[0]===s||e[0]===s.eventBusEl_;let l,d,f;return r?(l=s.eventBusEl_,e.length>=3&&e.shift(),[d,f]=e):[l,d,f]=e,qo(l,s,i),Gl(d,s,i),Hl(f,s,i),f=Ci(s,f),{isTargetingSelf:r,target:l,type:d,listener:f}},Ws=(s,e,i,r)=>{qo(s,s,e),s.nodeName?Vl[e](s,i,r):s[e](i,r)},wc={on(...s){const{isTargetingSelf:e,target:i,type:r,listener:l}=Ko(this,s,"on");if(Ws(i,"on",r,l),!e){const d=()=>this.off(i,r,l);d.guid=l.guid;const f=()=>this.off("dispose",d);f.guid=l.guid,Ws(this,"on","dispose",d),Ws(i,"on","dispose",f)}},one(...s){const{isTargetingSelf:e,target:i,type:r,listener:l}=Ko(this,s,"one");if(e)Ws(i,"one",r,l);else{const d=(...f)=>{this.off(i,r,d),l.apply(null,f)};d.guid=l.guid,Ws(i,"one",r,d)}},any(...s){const{isTargetingSelf:e,target:i,type:r,listener:l}=Ko(this,s,"any");if(e)Ws(i,"any",r,l);else{const d=(...f)=>{this.off(i,r,d),l.apply(null,f)};d.guid=l.guid,Ws(i,"any",r,d)}},off(s,e,i){if(!s||Fn(s))_n(this.eventBusEl_,s,e);else{const r=s,l=e;qo(r,this,"off"),Gl(l,this,"off"),Hl(i,this,"off"),i=Ci(this,i),this.off("dispose",i),r.nodeName?(_n(r,l,i),_n(r,"dispose",i)):_r(r)&&(r.off(l,i),r.off("dispose",i))}},trigger(s,e){qo(this.eventBusEl_,this,"trigger");const i=s&&typeof s!="string"?s.type:s;if(!Fn(i))throw new Error(`Invalid event type for ${is(this)}#trigger; must be a non-empty string or object with a type key that has a non-empty value.`);return Kn(this.eventBusEl_,s,e)}};function Wo(s,e={}){const{eventBusKey:i}=e;if(i){if(!s[i].nodeName)throw new Error(`The eventBusKey "${i}" does not refer to an element.`);s.eventBusEl_=s[i]}else s.eventBusEl_=ri("span",{className:"vjs-event-bus"});return Object.assign(s,wc),s.eventedCallbacks&&s.eventedCallbacks.forEach(r=>{r()}),s.on("dispose",()=>{s.off(),[s,s.el_,s.eventBusEl_].forEach(function(r){r&&Wi.has(r)&&Wi.delete(r)}),le().setTimeout(()=>{s.eventBusEl_=null},0)}),s}const ns={state:{},setState(s){typeof s=="function"&&(s=s());let e;return As(s,(i,r)=>{this.state[r]!==i&&(e=e||{},e[r]={from:this.state[r],to:i}),this.state[r]=i}),e&&_r(this)&&this.trigger({changes:e,type:"statechanged"}),e}};function Ja(s,e){return Object.assign(s,ns),s.state=Object.assign({},s.state,e),typeof s.handleStateChanged=="function"&&_r(s)&&s.on("statechanged",s.handleStateChanged),s}const Ea=function(s){return typeof s!="string"?s:s.replace(/./,e=>e.toLowerCase())},Ji=function(s){return typeof s!="string"?s:s.replace(/./,e=>e.toUpperCase())},zo=function(s,e){return Ji(s)===Ji(e)};var Yo=Object.freeze({__proto__:null,toLowerCase:Ea,toTitleCase:Ji,titleCaseEquals:zo});class it{constructor(e,i,r){if(!e&&this.play?this.player_=e=this:this.player_=e,this.isDisposed_=!1,this.parentComponent_=null,this.options_=ci({},this.options_),i=this.options_=ci(this.options_,i),this.id_=i.id||i.el&&i.el.id,!this.id_){const l=e&&e.id&&e.id()||"no_player";this.id_=`${l}_component_${xi()}`}this.name_=i.name||null,i.el?this.el_=i.el:i.createEl!==!1&&(this.el_=this.createEl()),i.className&&this.el_&&i.className.split(" ").forEach(l=>this.addClass(l)),["on","off","one","any","trigger"].forEach(l=>{this[l]=void 0}),i.evented!==!1&&(Wo(this,{eventBusKey:this.el_?"el_":null}),this.handleLanguagechange=this.handleLanguagechange.bind(this),this.on(this.player_,"languagechange",this.handleLanguagechange)),Ja(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Set,this.setIntervalIds_=new Set,this.rafIds_=new Set,this.namedRafs_=new Map,this.clearingTimersOnDispose_=!1,i.initChildren!==!1&&this.initChildren(),this.ready(r),i.reportTouchActivity!==!1&&this.enableTouchActivity()}on(e,i){}off(e,i){}one(e,i){}any(e,i){}trigger(e,i){}dispose(e={}){if(!this.isDisposed_){if(this.readyQueue_&&(this.readyQueue_.length=0),this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(let i=this.children_.length-1;i>=0;i--)this.children_[i].dispose&&this.children_[i].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&(e.restoreEl?this.el_.parentNode.replaceChild(e.restoreEl,this.el_):this.el_.parentNode.removeChild(this.el_)),this.el_=null),this.player_=null}}isDisposed(){return Boolean(this.isDisposed_)}player(){return this.player_}options(e){return e?(this.options_=ci(this.options_,e),this.options_):this.options_}el(){return this.el_}createEl(e,i,r){return ri(e,i,r)}localize(e,i,r=e){const l=this.player_.language&&this.player_.language(),d=this.player_.languages&&this.player_.languages(),f=d&&d[l],y=l&&l.split("-")[0],L=d&&d[y];let B=r;return f&&f[e]?B=f[e]:L&&L[e]&&(B=L[e]),i&&(B=B.replace(/\{(\d+)\}/g,function(W,ce){const ke=i[ce-1];let Pe=ke;return typeof ke=="undefined"&&(Pe=W),Pe})),B}handleLanguagechange(){}contentEl(){return this.contentEl_||this.el_}id(){return this.id_}name(){return this.name_}children(){return this.children_}getChildById(e){return this.childIndex_[e]}getChild(e){if(!!e)return this.childNameIndex_[e]}getDescendant(...e){e=e.reduce((r,l)=>r.concat(l),[]);let i=this;for(let r=0;r<e.length;r++)if(i=i.getChild(e[r]),!i||!i.getChild)return;return i}setIcon(e,i=this.el()){if(!this.player_.options_.experimentalSvgIcons)return;const r="http://www.w3.org/2000/svg",l=ri("span",{className:"vjs-icon-placeholder vjs-svg-icon"},{"aria-hidden":"true"}),d=Ee().createElementNS(r,"svg");d.setAttributeNS(null,"viewBox","0 0 512 512");const f=Ee().createElementNS(r,"use");return d.appendChild(f),f.setAttributeNS(null,"href",`#vjs-icon-${e}`),l.appendChild(d),this.iconIsSet_?i.replaceChild(l,i.querySelector(".vjs-icon-placeholder")):i.appendChild(l),this.iconIsSet_=!0,l}addChild(e,i={},r=this.children_.length){let l,d;if(typeof e=="string"){d=Ji(e);const f=i.componentClass||d;i.name=d;const y=it.getComponent(f);if(!y)throw new Error(`Component ${f} does not exist`);if(typeof y!="function")return null;l=new y(this.player_||this,i)}else l=e;if(l.parentComponent_&&l.parentComponent_.removeChild(l),this.children_.splice(r,0,l),l.parentComponent_=this,typeof l.id=="function"&&(this.childIndex_[l.id()]=l),d=d||l.name&&Ji(l.name()),d&&(this.childNameIndex_[d]=l,this.childNameIndex_[Ea(d)]=l),typeof l.el=="function"&&l.el()){let f=null;this.children_[r+1]&&(this.children_[r+1].el_?f=this.children_[r+1].el_:Vn(this.children_[r+1])&&(f=this.children_[r+1])),this.contentEl().insertBefore(l.el(),f)}return l}removeChild(e){if(typeof e=="string"&&(e=this.getChild(e)),!e||!this.children_)return;let i=!1;for(let l=this.children_.length-1;l>=0;l--)if(this.children_[l]===e){i=!0,this.children_.splice(l,1);break}if(!i)return;e.parentComponent_=null,this.childIndex_[e.id()]=null,this.childNameIndex_[Ji(e.name())]=null,this.childNameIndex_[Ea(e.name())]=null;const r=e.el();r&&r.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}initChildren(){const e=this.options_.children;if(e){const i=this.options_,r=f=>{const y=f.name;let L=f.opts;if(i[y]!==void 0&&(L=i[y]),L===!1)return;L===!0&&(L={}),L.playerOptions=this.options_.playerOptions;const B=this.addChild(y,L);B&&(this[y]=B)};let l;const d=it.getComponent("Tech");Array.isArray(e)?l=e:l=Object.keys(e),l.concat(Object.keys(this.options_).filter(function(f){return!l.some(function(y){return typeof y=="string"?f===y:f===y.name})})).map(f=>{let y,L;return typeof f=="string"?(y=f,L=e[y]||this.options_[y]||{}):(y=f.name,L=f),{name:y,opts:L}}).filter(f=>{const y=it.getComponent(f.opts.componentClass||Ji(f.name));return y&&!d.isTech(y)}).forEach(r)}}buildCSSClass(){return""}ready(e,i=!1){if(!!e){if(!this.isReady_){this.readyQueue_=this.readyQueue_||[],this.readyQueue_.push(e);return}i?e.call(this):this.setTimeout(e,1)}}triggerReady(){this.isReady_=!0,this.setTimeout(function(){const e=this.readyQueue_;this.readyQueue_=[],e&&e.length>0&&e.forEach(function(i){i.call(this)},this),this.trigger("ready")},1)}$(e,i){return Ke(e,i||this.contentEl())}$$(e,i){return vt(e,i||this.contentEl())}hasClass(e){return Gn(this.el_,e)}addClass(...e){$r(this.el_,...e)}removeClass(...e){va(this.el_,...e)}toggleClass(e,i){Aa(this.el_,e,i)}show(){this.removeClass("vjs-hidden")}hide(){this.addClass("vjs-hidden")}lockShowing(){this.addClass("vjs-lock-showing")}unlockShowing(){this.removeClass("vjs-lock-showing")}getAttribute(e){return es(this.el_,e)}setAttribute(e,i){Ar(this.el_,e,i)}removeAttribute(e){_a(this.el_,e)}width(e,i){return this.dimension("width",e,i)}height(e,i){return this.dimension("height",e,i)}dimensions(e,i){this.width(e,!0),this.height(i)}dimension(e,i,r){if(i!==void 0){(i===null||i!==i)&&(i=0),(""+i).indexOf("%")!==-1||(""+i).indexOf("px")!==-1?this.el_.style[e]=i:i==="auto"?this.el_.style[e]="":this.el_.style[e]=i+"px",r||this.trigger("componentresize");return}if(!this.el_)return 0;const l=this.el_.style[e],d=l.indexOf("px");return parseInt(d!==-1?l.slice(0,d):this.el_["offset"+Ji(e)],10)}currentDimension(e){let i=0;if(e!=="width"&&e!=="height")throw new Error("currentDimension only accepts width or height value");if(i=bt(this.el_,e),i=parseFloat(i),i===0||isNaN(i)){const r=`offset${Ji(e)}`;i=this.el_[r]}return i}currentDimensions(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}}currentWidth(){return this.currentDimension("width")}currentHeight(){return this.currentDimension("height")}focus(){this.el_.focus()}blur(){this.el_.blur()}handleKeyDown(e){this.player_&&(me().isEventKey(e,"Tab")||e.stopPropagation(),this.player_.handleKeyDown(e))}handleKeyPress(e){this.handleKeyDown(e)}emitTapEvents(){let e=0,i=null;const r=10,l=200;let d;this.on("touchstart",function(y){y.touches.length===1&&(i={pageX:y.touches[0].pageX,pageY:y.touches[0].pageY},e=le().performance.now(),d=!0)}),this.on("touchmove",function(y){if(y.touches.length>1)d=!1;else if(i){const L=y.touches[0].pageX-i.pageX,B=y.touches[0].pageY-i.pageY;Math.sqrt(L*L+B*B)>r&&(d=!1)}});const f=function(){d=!1};this.on("touchleave",f),this.on("touchcancel",f),this.on("touchend",function(y){i=null,d===!0&&le().performance.now()-e<l&&(y.preventDefault(),this.trigger("tap"))})}enableTouchActivity(){if(!this.player()||!this.player().reportUserActivity)return;const e=Ci(this.player(),this.player().reportUserActivity);let i;this.on("touchstart",function(){e(),this.clearInterval(i),i=this.setInterval(e,250)});const r=function(l){e(),this.clearInterval(i)};this.on("touchmove",e),this.on("touchend",r),this.on("touchcancel",r)}setTimeout(e,i){var r;return e=Ci(this,e),this.clearTimersOnDispose_(),r=le().setTimeout(()=>{this.setTimeoutIds_.has(r)&&this.setTimeoutIds_.delete(r),e()},i),this.setTimeoutIds_.add(r),r}clearTimeout(e){return this.setTimeoutIds_.has(e)&&(this.setTimeoutIds_.delete(e),le().clearTimeout(e)),e}setInterval(e,i){e=Ci(this,e),this.clearTimersOnDispose_();const r=le().setInterval(e,i);return this.setIntervalIds_.add(r),r}clearInterval(e){return this.setIntervalIds_.has(e)&&(this.setIntervalIds_.delete(e),le().clearInterval(e)),e}requestAnimationFrame(e){this.clearTimersOnDispose_();var i;return e=Ci(this,e),i=le().requestAnimationFrame(()=>{this.rafIds_.has(i)&&this.rafIds_.delete(i),e()}),this.rafIds_.add(i),i}requestNamedAnimationFrame(e,i){if(this.namedRafs_.has(e))return;this.clearTimersOnDispose_(),i=Ci(this,i);const r=this.requestAnimationFrame(()=>{i(),this.namedRafs_.has(e)&&this.namedRafs_.delete(e)});return this.namedRafs_.set(e,r),e}cancelNamedAnimationFrame(e){!this.namedRafs_.has(e)||(this.cancelAnimationFrame(this.namedRafs_.get(e)),this.namedRafs_.delete(e))}cancelAnimationFrame(e){return this.rafIds_.has(e)&&(this.rafIds_.delete(e),le().cancelAnimationFrame(e)),e}clearTimersOnDispose_(){this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",()=>{[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(([e,i])=>{this[e].forEach((r,l)=>this[i](l))}),this.clearingTimersOnDispose_=!1}))}static registerComponent(e,i){if(typeof e!="string"||!e)throw new Error(`Illegal component name, "${e}"; must be a non-empty string.`);const r=it.getComponent("Tech"),l=r&&r.isTech(i),d=it===i||it.prototype.isPrototypeOf(i.prototype);if(l||!d){let y;throw l?y="techs must be registered using Tech.registerTech()":y="must be a Component subclass",new Error(`Illegal component, "${e}"; ${y}.`)}e=Ji(e),it.components_||(it.components_={});const f=it.getComponent("Player");if(e==="Player"&&f&&f.players){const y=f.players,L=Object.keys(y);if(y&&L.length>0&&L.map(B=>y[B]).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return it.components_[e]=i,it.components_[Ea(e)]=i,i}static getComponent(e){if(!(!e||!it.components_))return it.components_[e]}}it.registerComponent("Component",it);function Lc(s,e,i){if(typeof e!="number"||e<0||e>i)throw new Error(`Failed to execute '${s}' on 'TimeRanges': The index provided (${e}) is non-numeric or out of bounds (0-${i}).`)}function ql(s,e,i,r){return Lc(s,r,i.length-1),i[r][e]}function Kl(s){let e;return s===void 0||s.length===0?e={length:0,start(){throw new Error("This TimeRanges object is empty")},end(){throw new Error("This TimeRanges object is empty")}}:e={length:s.length,start:ql.bind(null,"start",0,s),end:ql.bind(null,"end",1,s)},le().Symbol&&le().Symbol.iterator&&(e[le().Symbol.iterator]=()=>(s||[]).values()),e}function Wn(s,e){return Array.isArray(s)?Kl(s):s===void 0||e===void 0?Kl():Kl([[s,e]])}const Wl=function(s,e){s=s<0?0:s;let i=Math.floor(s%60),r=Math.floor(s/60%60),l=Math.floor(s/3600);const d=Math.floor(e/60%60),f=Math.floor(e/3600);return(isNaN(s)||s===Infinity)&&(l=r=i="-"),l=l>0||f>0?l+":":"",r=((l||d>=10)&&r<10?"0"+r:r)+":",i=i<10?"0"+i:i,l+r+i};let Xo=Wl;function zs(s){Xo=s}function Qo(){Xo=Wl}function xs(s,e=s){return Xo(s,e)}var Dc=Object.freeze({__proto__:null,createTimeRanges:Wn,createTimeRange:Wn,setFormatTime:zs,resetFormatTime:Qo,formatTime:xs});function ld(s,e){let i=0,r,l;if(!e)return 0;(!s||!s.length)&&(s=Wn(0,0));for(let d=0;d<s.length;d++)r=s.start(d),l=s.end(d),l>e&&(l=e),i+=l-r;return i/e}function Cn(s){if(s instanceof Cn)return s;typeof s=="number"?this.code=s:typeof s=="string"?this.message=s:tr(s)&&(typeof s.code=="number"&&(this.code=s.code),Object.assign(this,s)),this.message||(this.message=Cn.defaultMessages[this.code]||"")}Cn.prototype.code=0,Cn.prototype.message="",Cn.prototype.status=null,Cn.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],Cn.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(let s=0;s<Cn.errorTypes.length;s++)Cn[Cn.errorTypes[s]]=s,Cn.prototype[Cn.errorTypes[s]]=s;function Za(s){return s!=null&&typeof s.then=="function"}function Gr(s){Za(s)&&s.then(null,e=>{})}const zl=function(s){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce((i,r,l)=>(s[r]&&(i[r]=s[r]),i),{cues:s.cues&&Array.prototype.map.call(s.cues,function(i){return{startTime:i.startTime,endTime:i.endTime,text:i.text,id:i.id}})})};var ud={textTracksToJson:function(s){const e=s.$$("track"),i=Array.prototype.map.call(e,l=>l.track);return Array.prototype.map.call(e,function(l){const d=zl(l.track);return l.src&&(d.src=l.src),d}).concat(Array.prototype.filter.call(s.textTracks(),function(l){return i.indexOf(l)===-1}).map(zl))},jsonToTextTracks:function(s,e){return s.forEach(function(i){const r=e.addRemoteTextTrack(i).track;!i.src&&i.cues&&i.cues.forEach(l=>r.addCue(l))}),e.textTracks()},trackToJson_:zl};const Jo="vjs-modal-dialog";class Ta extends it{constructor(e,i){super(e,i);this.handleKeyDown_=r=>this.handleKeyDown(r),this.close_=r=>this.close(r),this.opened_=this.hasBeenOpened_=this.hasBeenFilled_=!1,this.closeable(!this.options_.uncloseable),this.content(this.options_.content),this.contentEl_=ri("div",{className:`${Jo}-content`},{role:"document"}),this.descEl_=ri("p",{className:`${Jo}-description vjs-control-text`,id:this.el().getAttribute("aria-describedby")}),jr(this.descEl_,this.description()),this.el_.appendChild(this.descEl_),this.el_.appendChild(this.contentEl_)}createEl(){return super.createEl("div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":`${this.id()}_description`,"aria-hidden":"true","aria-label":this.label(),role:"dialog"})}dispose(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,super.dispose()}buildCSSClass(){return`${Jo} vjs-hidden ${super.buildCSSClass()}`}label(){return this.localize(this.options_.label||"Modal Window")}description(){let e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e}open(){if(!this.opened_){const e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.on("keydown",this.handleKeyDown_),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}}opened(e){return typeof e=="boolean"&&this[e?"open":"close"](),this.opened_}close(){if(!this.opened_)return;const e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.off("keydown",this.handleKeyDown_),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}closeable(e){if(typeof e=="boolean"){const i=this.closeable_=!!e;let r=this.getChild("closeButton");if(i&&!r){const l=this.contentEl_;this.contentEl_=this.el_,r=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=l,this.on(r,"close",this.close_)}!i&&r&&(this.off(r,"close",this.close_),this.removeChild(r),r.dispose())}return this.closeable_}fill(){this.fillWith(this.content())}fillWith(e){const i=this.contentEl(),r=i.parentNode,l=i.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,r.removeChild(i),this.empty(),ge(i,e),this.trigger("modalfill"),l?r.insertBefore(i,l):r.appendChild(i);const d=this.getChild("closeButton");d&&r.appendChild(d.el_)}empty(){this.trigger("beforemodalempty"),F(this.contentEl()),this.trigger("modalempty")}content(e){return typeof e!="undefined"&&(this.content_=e),this.content_}conditionalFocus_(){const e=Ee().activeElement,i=this.player_.el_;this.previouslyActiveEl_=null,(i.contains(e)||i===e)&&(this.previouslyActiveEl_=e,this.focus())}conditionalBlur_(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)}handleKeyDown(e){if(e.stopPropagation(),me().isEventKey(e,"Escape")&&this.closeable()){e.preventDefault(),this.close();return}if(!me().isEventKey(e,"Tab"))return;const i=this.focusableEls_(),r=this.el_.querySelector(":focus");let l;for(let d=0;d<i.length;d++)if(r===i[d]){l=d;break}Ee().activeElement===this.el_&&(l=0),e.shiftKey&&l===0?(i[i.length-1].focus(),e.preventDefault()):!e.shiftKey&&l===i.length-1&&(i[0].focus(),e.preventDefault())}focusableEls_(){const e=this.el_.querySelectorAll("*");return Array.prototype.filter.call(e,i=>(i instanceof le().HTMLAnchorElement||i instanceof le().HTMLAreaElement)&&i.hasAttribute("href")||(i instanceof le().HTMLInputElement||i instanceof le().HTMLSelectElement||i instanceof le().HTMLTextAreaElement||i instanceof le().HTMLButtonElement)&&!i.hasAttribute("disabled")||i instanceof le().HTMLIFrameElement||i instanceof le().HTMLObjectElement||i instanceof le().HTMLEmbedElement||i.hasAttribute("tabindex")&&i.getAttribute("tabindex")!==-1||i.hasAttribute("contenteditable"))}}Ta.prototype.options_={pauseOnOpen:!0,temporary:!0},it.registerComponent("ModalDialog",Ta);class Ys extends rr{constructor(e=[]){super();this.tracks_=[],Object.defineProperty(this,"length",{get(){return this.tracks_.length}});for(let i=0;i<e.length;i++)this.addTrack(e[i])}addTrack(e){const i=this.tracks_.length;""+i in this||Object.defineProperty(this,i,{get(){return this.tracks_[i]}}),this.tracks_.indexOf(e)===-1&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack",target:this})),e.labelchange_=()=>{this.trigger({track:e,type:"labelchange",target:this})},_r(e)&&e.addEventListener("labelchange",e.labelchange_)}removeTrack(e){let i;for(let r=0,l=this.length;r<l;r++)if(this[r]===e){i=this[r],i.off&&i.off(),this.tracks_.splice(r,1);break}!i||this.trigger({track:i,type:"removetrack",target:this})}getTrackById(e){let i=null;for(let r=0,l=this.length;r<l;r++){const d=this[r];if(d.id===e){i=d;break}}return i}}Ys.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"};for(const s in Ys.prototype.allowedEvents_)Ys.prototype["on"+s]=null;const Zo=function(s,e){for(let i=0;i<s.length;i++)!Object.keys(s[i]).length||e.id===s[i].id||(s[i].enabled=!1)};class xr extends Ys{constructor(e=[]){for(let i=e.length-1;i>=0;i--)if(e[i].enabled){Zo(e,e[i]);break}super(e);this.changing_=!1}addTrack(e){e.enabled&&Zo(this,e),super.addTrack(e),!!e.addEventListener&&(e.enabledChange_=()=>{this.changing_||(this.changing_=!0,Zo(this,e),this.changing_=!1,this.trigger("change"))},e.addEventListener("enabledchange",e.enabledChange_))}removeTrack(e){super.removeTrack(e),e.removeEventListener&&e.enabledChange_&&(e.removeEventListener("enabledchange",e.enabledChange_),e.enabledChange_=null)}}const Er=function(s,e){for(let i=0;i<s.length;i++)!Object.keys(s[i]).length||e.id===s[i].id||(s[i].selected=!1)};class Ic extends Ys{constructor(e=[]){for(let i=e.length-1;i>=0;i--)if(e[i].selected){Er(e,e[i]);break}super(e);this.changing_=!1,Object.defineProperty(this,"selectedIndex",{get(){for(let i=0;i<this.length;i++)if(this[i].selected)return i;return-1},set(){}})}addTrack(e){e.selected&&Er(this,e),super.addTrack(e),!!e.addEventListener&&(e.selectedChange_=()=>{this.changing_||(this.changing_=!0,Er(this,e),this.changing_=!1,this.trigger("change"))},e.addEventListener("selectedchange",e.selectedChange_))}removeTrack(e){super.removeTrack(e),e.removeEventListener&&e.selectedChange_&&(e.removeEventListener("selectedchange",e.selectedChange_),e.selectedChange_=null)}}class dd extends Ys{addTrack(e){super.addTrack(e),this.queueChange_||(this.queueChange_=()=>this.queueTrigger("change")),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=()=>this.trigger("selectedlanguagechange")),e.addEventListener("modechange",this.queueChange_),["metadata","chapters"].indexOf(e.kind)===-1&&e.addEventListener("modechange",this.triggerSelectedlanguagechange_)}removeTrack(e){super.removeTrack(e),e.removeEventListener&&(this.queueChange_&&e.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&e.removeEventListener("modechange",this.triggerSelectedlanguagechange_))}}class Rc{constructor(e=[]){this.trackElements_=[],Object.defineProperty(this,"length",{get(){return this.trackElements_.length}});for(let i=0,r=e.length;i<r;i++)this.addTrackElement_(e[i])}addTrackElement_(e){const i=this.trackElements_.length;""+i in this||Object.defineProperty(this,i,{get(){return this.trackElements_[i]}}),this.trackElements_.indexOf(e)===-1&&this.trackElements_.push(e)}getTrackElementByTrack_(e){let i;for(let r=0,l=this.trackElements_.length;r<l;r++)if(e===this.trackElements_[r].track){i=this.trackElements_[r];break}return i}removeTrackElement_(e){for(let i=0,r=this.trackElements_.length;i<r;i++)if(e===this.trackElements_[i]){this.trackElements_[i].track&&typeof this.trackElements_[i].track.off=="function"&&this.trackElements_[i].track.off(),typeof this.trackElements_[i].off=="function"&&this.trackElements_[i].off(),this.trackElements_.splice(i,1);break}}}class el{constructor(e){el.prototype.setCues_.call(this,e),Object.defineProperty(this,"length",{get(){return this.length_}})}setCues_(e){const i=this.length||0;let r=0;const l=e.length;this.cues_=e,this.length_=e.length;const d=function(f){""+f in this||Object.defineProperty(this,""+f,{get(){return this.cues_[f]}})};if(i<l)for(r=i;r<l;r++)d.call(this,r)}getCueById(e){let i=null;for(let r=0,l=this.length;r<l;r++){const d=this[r];if(d.id===e){i=d;break}}return i}}const Pc={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},Oc={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},Xs={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},Yl={disabled:"disabled",hidden:"hidden",showing:"showing"};class Xl extends rr{constructor(e={}){super();const i={id:e.id||"vjs_track_"+xi(),kind:e.kind||"",language:e.language||""};let r=e.label||"";for(const l in i)Object.defineProperty(this,l,{get(){return i[l]},set(){}});Object.defineProperty(this,"label",{get(){return r},set(l){l!==r&&(r=l,this.trigger("labelchange"))}})}}const Ql=function(s){const e=["protocol","hostname","port","pathname","search","hash","host"],i=Ee().createElement("a");i.href=s;const r={};for(let l=0;l<e.length;l++)r[e[l]]=i[e[l]];return r.protocol==="http:"&&(r.host=r.host.replace(/:80$/,"")),r.protocol==="https:"&&(r.host=r.host.replace(/:443$/,"")),r.protocol||(r.protocol=le().location.protocol),r.host||(r.host=le().location.host),r},tl=function(s){if(!s.match(/^https?:\/\//)){const e=Ee().createElement("a");e.href=s,s=e.href}return s},il=function(s){if(typeof s=="string"){const i=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(s);if(i)return i.pop().toLowerCase()}return""},eo=function(s,e=le().location){const i=Ql(s);return(i.protocol===":"?e.protocol:i.protocol)+i.host!==e.protocol+e.host};var Sa=Object.freeze({__proto__:null,parseUrl:Ql,getAbsoluteURL:tl,getFileExtension:il,isCrossOrigin:eo});const Jl=function(s,e){const i=new(le()).WebVTT.Parser(le(),le().vttjs,le().WebVTT.StringDecoder()),r=[];i.oncue=function(l){e.addCue(l)},i.onparsingerror=function(l){r.push(l)},i.onflush=function(){e.trigger({type:"loadeddata",target:e})},i.parse(s),r.length>0&&(le().console&&le().console.groupCollapsed&&le().console.groupCollapsed(`Text Track parsing errors for ${e.src}`),r.forEach(l=>ni.error(l)),le().console&&le().console.groupEnd&&le().console.groupEnd()),i.flush()},Zl=function(s,e){const i={uri:s},r=eo(s);r&&(i.cors=r);const l=e.tech_.crossOrigin()==="use-credentials";l&&(i.withCredentials=l),ie()(i,Ci(this,function(d,f,y){if(d)return ni.error(d,f);e.loaded_=!0,typeof le().WebVTT!="function"?e.tech_&&e.tech_.any(["vttjsloaded","vttjserror"],L=>{if(L.type==="vttjserror"){ni.error(`vttjs failed to load, stopping trying to process ${e.src}`);return}return Jl(y,e)}):Jl(y,e)}))};class Es extends Xl{constructor(e={}){if(!e.tech)throw new Error("A tech was not provided.");const i=ci(e,{kind:Xs[e.kind]||"subtitles",language:e.language||e.srclang||""});let r=Yl[i.mode]||"disabled";const l=i.default;(i.kind==="metadata"||i.kind==="chapters")&&(r="hidden"),super(i),this.tech_=i.tech,this.cues_=[],this.activeCues_=[],this.preload_=this.tech_.preloadTextTracks!==!1;const d=new el(this.cues_),f=new el(this.activeCues_);let y=!1;this.timeupdateHandler=Ci(this,function(B={}){if(!this.tech_.isDisposed()){if(!this.tech_.isReady_){B.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler));return}this.activeCues=this.activeCues,y&&(this.trigger("cuechange"),y=!1),B.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler))}});const L=()=>{this.stopTracking()};this.tech_.one("dispose",L),r!=="disabled"&&this.startTracking(),Object.defineProperties(this,{default:{get(){return l},set(){}},mode:{get(){return r},set(B){!Yl[B]||r!==B&&(r=B,!this.preload_&&r!=="disabled"&&this.cues.length===0&&Zl(this.src,this),this.stopTracking(),r!=="disabled"&&this.startTracking(),this.trigger("modechange"))}},cues:{get(){return this.loaded_?d:null},set(){}},activeCues:{get(){if(!this.loaded_)return null;if(this.cues.length===0)return f;const B=this.tech_.currentTime(),W=[];for(let ce=0,ke=this.cues.length;ce<ke;ce++){const Pe=this.cues[ce];Pe.startTime<=B&&Pe.endTime>=B&&W.push(Pe)}if(y=!1,W.length!==this.activeCues_.length)y=!0;else for(let ce=0;ce<W.length;ce++)this.activeCues_.indexOf(W[ce])===-1&&(y=!0);return this.activeCues_=W,f.setCues_(this.activeCues_),f},set(){}}}),i.src?(this.src=i.src,this.preload_||(this.loaded_=!0),(this.preload_||i.kind!=="subtitles"&&i.kind!=="captions")&&Zl(this.src,this)):this.loaded_=!0}startTracking(){this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler),this.tech_.on("timeupdate",this.timeupdateHandler)}stopTracking(){this.rvf_&&(this.tech_.cancelVideoFrameCallback(this.rvf_),this.rvf_=void 0),this.tech_.off("timeupdate",this.timeupdateHandler)}addCue(e){let i=e;if(!("getCueAsHTML"in i)){i=new(le()).vttjs.VTTCue(e.startTime,e.endTime,e.text);for(const l in e)l in i||(i[l]=e[l]);i.id=e.id,i.originalCue_=e}const r=this.tech_.textTracks();for(let l=0;l<r.length;l++)r[l]!==this&&r[l].removeCue(i);this.cues_.push(i),this.cues.setCues_(this.cues_)}removeCue(e){let i=this.cues_.length;for(;i--;){const r=this.cues_[i];if(r===e||r.originalCue_&&r.originalCue_===e){this.cues_.splice(i,1),this.cues.setCues_(this.cues_);break}}}}Es.prototype.allowedEvents_={cuechange:"cuechange"};class nl extends Xl{constructor(e={}){const i=ci(e,{kind:Oc[e.kind]||""});super(i);let r=!1;Object.defineProperty(this,"enabled",{get(){return r},set(l){typeof l!="boolean"||l===r||(r=l,this.trigger("enabledchange"))}}),i.enabled&&(this.enabled=i.enabled),this.loaded_=!0}}class cd extends Xl{constructor(e={}){const i=ci(e,{kind:Pc[e.kind]||""});super(i);let r=!1;Object.defineProperty(this,"selected",{get(){return r},set(l){typeof l!="boolean"||l===r||(r=l,this.trigger("selectedchange"))}}),i.selected&&(this.selected=i.selected)}}class Hr extends rr{constructor(e={}){super();let i;const r=new Es(e);this.kind=r.kind,this.src=r.src,this.srclang=r.language,this.label=r.label,this.default=r.default,Object.defineProperties(this,{readyState:{get(){return i}},track:{get(){return r}}}),i=Hr.NONE,r.addEventListener("loadeddata",()=>{i=Hr.LOADED,this.trigger({type:"load",target:this})})}}Hr.prototype.allowedEvents_={load:"load"},Hr.NONE=0,Hr.LOADING=1,Hr.LOADED=2,Hr.ERROR=3;const sr={audio:{ListClass:xr,TrackClass:nl,capitalName:"Audio"},video:{ListClass:Ic,TrackClass:cd,capitalName:"Video"},text:{ListClass:dd,TrackClass:Es,capitalName:"Text"}};Object.keys(sr).forEach(function(s){sr[s].getterName=`${s}Tracks`,sr[s].privateName=`${s}Tracks_`});const Qs={remoteText:{ListClass:dd,TrackClass:Es,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:Rc,TrackClass:Hr,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},xn=Object.assign({},sr,Qs);Qs.names=Object.keys(Qs),sr.names=Object.keys(sr),xn.names=[].concat(Qs.names).concat(sr.names);function rl(s,e,i,r,l={}){const d=s.textTracks();l.kind=e,i&&(l.label=i),r&&(l.language=r),l.tech=s;const f=new xn.text.TrackClass(l);return d.addTrack(f),f}class si extends it{constructor(e={},i=function(){}){e.reportTouchActivity=!1,super(null,e,i),this.onDurationChange_=r=>this.onDurationChange(r),this.trackProgress_=r=>this.trackProgress(r),this.trackCurrentTime_=r=>this.trackCurrentTime(r),this.stopTrackingCurrentTime_=r=>this.stopTrackingCurrentTime(r),this.disposeSourceHandler_=r=>this.disposeSourceHandler(r),this.queuedHanders_=new Set,this.hasStarted_=!1,this.on("playing",function(){this.hasStarted_=!0}),this.on("loadstart",function(){this.hasStarted_=!1}),xn.names.forEach(r=>{const l=xn[r];e&&e[l.getterName]&&(this[l.privateName]=e[l.getterName])}),this.featuresProgressEvents||this.manualProgressOn(),this.featuresTimeupdateEvents||this.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(r=>{e[`native${r}Tracks`]===!1&&(this[`featuresNative${r}Tracks`]=!1)}),e.nativeCaptions===!1||e.nativeTextTracks===!1?this.featuresNativeTextTracks=!1:(e.nativeCaptions===!0||e.nativeTextTracks===!0)&&(this.featuresNativeTextTracks=!0),this.featuresNativeTextTracks||this.emulateTextTracks(),this.preloadTextTracks=e.preloadTextTracks!==!1,this.autoRemoteTextTracks_=new xn.text.ListClass,this.initTrackListeners(),e.nativeControlsForTouch||this.emitTapEvents(),this.constructor&&(this.name_=this.constructor.name||"Unknown Tech")}triggerSourceset(e){this.isReady_||this.one("ready",()=>this.setTimeout(()=>this.triggerSourceset(e),1)),this.trigger({src:e,type:"sourceset"})}manualProgressOn(){this.on("durationchange",this.onDurationChange_),this.manualProgress=!0,this.one("ready",this.trackProgress_)}manualProgressOff(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange_)}trackProgress(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(Ci(this,function(){const i=this.bufferedPercent();this.bufferedPercent_!==i&&this.trigger("progress"),this.bufferedPercent_=i,i===1&&this.stopTrackingProgress()}),500)}onDurationChange(e){this.duration_=this.duration()}buffered(){return Wn(0,0)}bufferedPercent(){return ld(this.buffered(),this.duration_)}stopTrackingProgress(){this.clearInterval(this.progressInterval)}manualTimeUpdatesOn(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime_),this.on("pause",this.stopTrackingCurrentTime_)}manualTimeUpdatesOff(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime_),this.off("pause",this.stopTrackingCurrentTime_)}trackCurrentTime(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)}stopTrackingCurrentTime(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}dispose(){this.clearTracks(sr.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),super.dispose()}clearTracks(e){e=[].concat(e),e.forEach(i=>{const r=this[`${i}Tracks`]()||[];let l=r.length;for(;l--;){const d=r[l];i==="text"&&this.removeRemoteTextTrack(d),r.removeTrack(d)}})}cleanupAutoTextTracks(){const e=this.autoRemoteTextTracks_||[];let i=e.length;for(;i--;){const r=e[i];this.removeRemoteTextTrack(r)}}reset(){}crossOrigin(){}setCrossOrigin(){}error(e){return e!==void 0&&(this.error_=new Cn(e),this.trigger("error")),this.error_}played(){return this.hasStarted_?Wn(0,0):Wn()}play(){}setScrubbing(e){}scrubbing(){}setCurrentTime(e){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}initTrackListeners(){sr.names.forEach(e=>{const i=sr[e],r=()=>{this.trigger(`${e}trackchange`)},l=this[i.getterName]();l.addEventListener("removetrack",r),l.addEventListener("addtrack",r),this.on("dispose",()=>{l.removeEventListener("removetrack",r),l.removeEventListener("addtrack",r)})})}addWebVttScript_(){if(!le().WebVTT)if(Ee().body.contains(this.el())){if(!this.options_["vtt.js"]&&gr(D())&&Object.keys(D()).length>0){this.trigger("vttjsloaded");return}const e=Ee().createElement("script");e.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",e.onload=()=>{this.trigger("vttjsloaded")},e.onerror=()=>{this.trigger("vttjserror")},this.on("dispose",()=>{e.onload=null,e.onerror=null}),le().WebVTT=!0,this.el().parentNode.appendChild(e)}else this.ready(this.addWebVttScript_)}emulateTextTracks(){const e=this.textTracks(),i=this.remoteTextTracks(),r=y=>e.addTrack(y.track),l=y=>e.removeTrack(y.track);i.on("addtrack",r),i.on("removetrack",l),this.addWebVttScript_();const d=()=>this.trigger("texttrackchange"),f=()=>{d();for(let y=0;y<e.length;y++){const L=e[y];L.removeEventListener("cuechange",d),L.mode==="showing"&&L.addEventListener("cuechange",d)}};f(),e.addEventListener("change",f),e.addEventListener("addtrack",f),e.addEventListener("removetrack",f),this.on("dispose",function(){i.off("addtrack",r),i.off("removetrack",l),e.removeEventListener("change",f),e.removeEventListener("addtrack",f),e.removeEventListener("removetrack",f);for(let y=0;y<e.length;y++)e[y].removeEventListener("cuechange",d)})}addTextTrack(e,i,r){if(!e)throw new Error("TextTrack kind is required but was not provided");return rl(this,e,i,r)}createRemoteTextTrack(e){const i=ci(e,{tech:this});return new Qs.remoteTextEl.TrackClass(i)}addRemoteTextTrack(e={},i){const r=this.createRemoteTextTrack(e);return typeof i!="boolean"&&(i=!1),this.remoteTextTrackEls().addTrackElement_(r),this.remoteTextTracks().addTrack(r.track),i===!1&&this.ready(()=>this.autoRemoteTextTracks_.addTrack(r.track)),r}removeRemoteTextTrack(e){const i=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(i),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)}getVideoPlaybackQuality(){return{}}requestPictureInPicture(){return Promise.reject()}disablePictureInPicture(){return!0}setDisablePictureInPicture(){}requestVideoFrameCallback(e){const i=xi();return!this.isReady_||this.paused()?(this.queuedHanders_.add(i),this.one("playing",()=>{this.queuedHanders_.has(i)&&(this.queuedHanders_.delete(i),e())})):this.requestNamedAnimationFrame(i,e),i}cancelVideoFrameCallback(e){this.queuedHanders_.has(e)?this.queuedHanders_.delete(e):this.cancelNamedAnimationFrame(e)}setPoster(){}playsinline(){}setPlaysinline(){}overrideNativeAudioTracks(e){}overrideNativeVideoTracks(e){}canPlayType(e){return""}static canPlayType(e){return""}static canPlaySource(e,i){return si.canPlayType(e.type)}static isTech(e){return e.prototype instanceof si||e instanceof si||e===si}static registerTech(e,i){if(si.techs_||(si.techs_={}),!si.isTech(i))throw new Error(`Tech ${e} must be a Tech`);if(!si.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!si.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=Ji(e),si.techs_[e]=i,si.techs_[Ea(e)]=i,e!=="Tech"&&si.defaultTechOrder_.push(e),i}static getTech(e){if(!!e){if(si.techs_&&si.techs_[e])return si.techs_[e];if(e=Ji(e),le()&&le().videojs&&le().videojs[e])return ni.warn(`The ${e} tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)`),le().videojs[e]}}}xn.names.forEach(function(s){const e=xn[s];si.prototype[e.getterName]=function(){return this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName]}}),si.prototype.featuresVolumeControl=!0,si.prototype.featuresMuteControl=!0,si.prototype.featuresFullscreenResize=!1,si.prototype.featuresPlaybackRate=!1,si.prototype.featuresProgressEvents=!1,si.prototype.featuresSourceset=!1,si.prototype.featuresTimeupdateEvents=!1,si.prototype.featuresNativeTextTracks=!1,si.prototype.featuresVideoFrameCallback=!1,si.withSourceHandlers=function(s){s.registerSourceHandler=function(i,r){let l=s.sourceHandlers;l||(l=s.sourceHandlers=[]),r===void 0&&(r=l.length),l.splice(r,0,i)},s.canPlayType=function(i){const r=s.sourceHandlers||[];let l;for(let d=0;d<r.length;d++)if(l=r[d].canPlayType(i),l)return l;return""},s.selectSourceHandler=function(i,r){const l=s.sourceHandlers||[];let d;for(let f=0;f<l.length;f++)if(d=l[f].canHandleSource(i,r),d)return l[f];return null},s.canPlaySource=function(i,r){const l=s.selectSourceHandler(i,r);return l?l.canHandleSource(i,r):""},["seekable","seeking","duration"].forEach(function(i){const r=this[i];typeof r=="function"&&(this[i]=function(){return this.sourceHandler_&&this.sourceHandler_[i]?this.sourceHandler_[i].apply(this.sourceHandler_,arguments):r.apply(this,arguments)})},s.prototype),s.prototype.setSource=function(i){let r=s.selectSourceHandler(i,this.options_);r||(s.nativeSourceHandler?r=s.nativeSourceHandler:ni.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler_),r!==s.nativeSourceHandler&&(this.currentSource_=i),this.sourceHandler_=r.handleSource(i,this,this.options_),this.one("dispose",this.disposeSourceHandler_)},s.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},it.registerComponent("Tech",si),si.registerTech("Tech",si),si.defaultTechOrder_=[];const Ts={},eu={},sl={};function tu(s,e){Ts[s]=Ts[s]||[],Ts[s].push(e)}function Bc(s,e,i){s.setTimeout(()=>Ss(e,Ts[e.type],i,s),1)}function iu(s,e){s.forEach(i=>i.setTech&&i.setTech(e))}function nu(s,e,i){return s.reduceRight(au(i),e[i]())}function Mc(s,e,i,r){return e[i](s.reduce(au(i),r))}function hd(s,e,i,r=null){const l="call"+Ji(i),d=s.reduce(au(l),r),f=d===sl,y=f?null:e[i](d);return pd(s,i,y,f),y}const ru={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1,ended:1},fd={setCurrentTime:1,setMuted:1,setVolume:1},su={play:1,pause:1};function au(s){return(e,i)=>e===sl?sl:i[s]?i[s](e):e}function pd(s,e,i,r){for(let l=s.length-1;l>=0;l--){const d=s[l];d[e]&&d[e](r,i)}}function Fc(s){eu[s.id()]=null}function ou(s,e){const i=eu[s.id()];let r=null;if(i==null)return r=e(s),eu[s.id()]=[[e,r]],r;for(let l=0;l<i.length;l++){const[d,f]=i[l];d===e&&(r=f)}return r===null&&(r=e(s),i.push([e,r])),r}function Ss(s={},e=[],i,r,l=[],d=!1){const[f,...y]=e;if(typeof f=="string")Ss(s,Ts[f],i,r,l,d);else if(f){const L=ou(r,f);if(!L.setSource)return l.push(L),Ss(s,y,i,r,l,d);L.setSource(Object.assign({},s),function(B,W){if(B)return Ss(s,y,i,r,l,d);l.push(L),Ss(W,s.type===W.type?y:Ts[W.type],i,r,l,d)})}else y.length?Ss(s,y,i,r,l,d):d?i(s,l):Ss(s,Ts["*"],i,r,l,!0)}const md={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",mpd:"application/dash+xml",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},al=function(s=""){const e=il(s);return md[e.toLowerCase()]||""},lu=(s,e)=>{if(!e)return"";if(s.cache_.source.src===e&&s.cache_.source.type)return s.cache_.source.type;const i=s.cache_.sources.filter(l=>l.src===e);if(i.length)return i[0].type;const r=s.$$("source");for(let l=0;l<r.length;l++){const d=r[l];if(d.type&&d.src&&d.src===e)return d.type}return al(e)},uu=function(s){if(Array.isArray(s)){let e=[];s.forEach(function(i){i=uu(i),Array.isArray(i)?e=e.concat(i):tr(i)&&e.push(i)}),s=e}else typeof s=="string"&&s.trim()?s=[ol({src:s})]:tr(s)&&typeof s.src=="string"&&s.src&&s.src.trim()?s=[ol(s)]:s=[];return s};function ol(s){if(!s.type){const e=al(s.src);e&&(s.type=e)}return s}var Nc=`<svg xmlns="http://www.w3.org/2000/svg">
  <defs>
    <symbol viewBox="0 0 48 48" id="vjs-icon-play">
      <path d="M16 10v28l22-14z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-pause">
      <path d="M12 38h8V10h-8v28zm16-28v28h8V10h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-audio">
      <path d="M24 2C14.06 2 6 10.06 6 20v14c0 3.31 2.69 6 6 6h6V24h-8v-4c0-7.73 6.27-14 14-14s14 6.27 14 14v4h-8v16h6c3.31 0 6-2.69 6-6V20c0-9.94-8.06-18-18-18z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-captions">
      <path d="M38 8H10c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h28c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM22 22h-3v-1h-4v6h4v-1h3v2a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2zm14 0h-3v-1h-4v6h4v-1h3v2a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-subtitles">
      <path d="M40 8H8c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h32c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM8 24h8v4H8v-4zm20 12H8v-4h20v4zm12 0h-8v-4h8v4zm0-8H20v-4h20v4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-fullscreen-enter">
      <path d="M14 28h-4v10h10v-4h-6v-6zm-4-8h4v-6h6v-4H10v10zm24 14h-6v4h10V28h-4v6zm-6-24v4h6v6h4V10H28z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-fullscreen-exit">
      <path d="M10 32h6v6h4V28H10v4zm6-16h-6v4h10V10h-4v6zm12 22h4v-6h6v-4H28v10zm4-22v-6h-4v10h10v-4h-6z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-play-circle">
      <path d="M20 33l12-9-12-9v18zm4-29C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-mute">
      <path d="M33 24c0-3.53-2.04-6.58-5-8.05v4.42l4.91 4.91c.06-.42.09-.85.09-1.28zm5 0c0 1.88-.41 3.65-1.08 5.28l3.03 3.03C41.25 29.82 42 27 42 24c0-8.56-5.99-15.72-14-17.54v4.13c5.78 1.72 10 7.07 10 13.41zM8.55 6L6 8.55 15.45 18H6v12h8l10 10V26.55l8.51 8.51c-1.34 1.03-2.85 1.86-4.51 2.36v4.13a17.94 17.94 0 0 0 7.37-3.62L39.45 42 42 39.45l-18-18L8.55 6zM24 8l-4.18 4.18L24 16.36V8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-low">
      <path d="M14 18v12h8l10 10V8L22 18h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-medium">
      <path d="M37 24c0-3.53-2.04-6.58-5-8.05v16.11c2.96-1.48 5-4.53 5-8.06zm-27-6v12h8l10 10V8L18 18h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-high">
      <path d="M6 18v12h8l10 10V8L14 18H6zm27 6c0-3.53-2.04-6.58-5-8.05v16.11c2.96-1.48 5-4.53 5-8.06zM28 6.46v4.13c5.78 1.72 10 7.07 10 13.41s-4.22 11.69-10 13.41v4.13c8.01-1.82 14-8.97 14-17.54S36.01 8.28 28 6.46z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-spinner">
      <path d="M18.8 21l9.53-16.51C26.94 4.18 25.49 4 24 4c-4.8 0-9.19 1.69-12.64 4.51l7.33 12.69.11-.2zm24.28-3c-1.84-5.85-6.3-10.52-11.99-12.68L23.77 18h19.31zm.52 2H28.62l.58 1 9.53 16.5C41.99 33.94 44 29.21 44 24c0-1.37-.14-2.71-.4-4zm-26.53 4l-7.8-13.5C6.01 14.06 4 18.79 4 24c0 1.37.14 2.71.4 4h14.98l-2.31-4zM4.92 30c1.84 5.85 6.3 10.52 11.99 12.68L24.23 30H4.92zm22.54 0l-7.8 13.51c1.4.31 2.85.49 4.34.49 4.8 0 9.19-1.69 12.64-4.51L29.31 26.8 27.46 30z"></path>
    </symbol>
    <symbol viewBox="0 0 24 24" id="vjs-icon-hd">
      <path d="M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-8 12H9.5v-2h-2v2H6V9h1.5v2.5h2V9H11v6zm2-6h4c.55 0 1 .45 1 1v4c0 .55-.45 1-1 1h-4V9zm1.5 4.5h2v-3h-2v3z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-chapters">
      <path d="M6 26h4v-4H6v4zm0 8h4v-4H6v4zm0-16h4v-4H6v4zm8 8h28v-4H14v4zm0 8h28v-4H14v4zm0-20v4h28v-4H14z"></path>
    </symbol>
    <symbol viewBox="0 0 40 40" id="vjs-icon-downloading">
      <path d="M18.208 36.875q-3.208-.292-5.979-1.729-2.771-1.438-4.812-3.729-2.042-2.292-3.188-5.229-1.146-2.938-1.146-6.23 0-6.583 4.334-11.416 4.333-4.834 10.833-5.5v3.166q-5.167.75-8.583 4.646Q6.25 14.75 6.25 19.958q0 5.209 3.396 9.104 3.396 3.896 8.562 4.646zM20 28.417L11.542 20l2.083-2.083 4.917 4.916v-11.25h2.916v11.25l4.875-4.916L28.417 20zm1.792 8.458v-3.167q1.833-.25 3.541-.958 1.709-.708 3.167-1.875l2.333 2.292q-1.958 1.583-4.25 2.541-2.291.959-4.791 1.167zm6.791-27.792q-1.541-1.125-3.25-1.854-1.708-.729-3.541-1.021V3.042q2.5.25 4.77 1.208 2.271.958 4.271 2.5zm4.584 21.584l-2.25-2.25q1.166-1.5 1.854-3.209.687-1.708.937-3.541h3.209q-.292 2.5-1.229 4.791-.938 2.292-2.521 4.209zm.541-12.417q-.291-1.833-.958-3.562-.667-1.73-1.833-3.188l2.375-2.208q1.541 1.916 2.458 4.208.917 2.292 1.167 4.75z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download">
      <path d="M10.8 40.55q-1.35 0-2.375-1T7.4 37.15v-7.7h3.4v7.7h26.35v-7.7h3.4v7.7q0 1.4-1 2.4t-2.4 1zM24 32.1L13.9 22.05l2.45-2.45 5.95 5.95V7.15h3.4v18.4l5.95-5.95 2.45 2.45z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download-done">
      <path d="M9.8 40.5v-3.45h28.4v3.45zm9.2-9.05L7.4 19.85l2.45-2.35L19 26.65l19.2-19.2 2.4 2.4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download-off">
      <path d="M4.9 4.75L43.25 43.1 41 45.3l-4.75-4.75q-.05.05-.075.025-.025-.025-.075-.025H10.8q-1.35 0-2.375-1T7.4 37.15v-7.7h3.4v7.7h22.05l-7-7-1.85 1.8L13.9 21.9l1.85-1.85L2.7 7zm26.75 14.7l2.45 2.45-3.75 3.8-2.45-2.5zM25.7 7.15V21.1l-3.4-3.45V7.15z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-share">
      <path d="M36 32.17c-1.52 0-2.89.59-3.93 1.54L17.82 25.4c.11-.45.18-.92.18-1.4s-.07-.95-.18-1.4l14.1-8.23c1.07 1 2.5 1.62 4.08 1.62 3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6c0 .48.07.95.18 1.4l-14.1 8.23c-1.07-1-2.5-1.62-4.08-1.62-3.31 0-6 2.69-6 6s2.69 6 6 6c1.58 0 3.01-.62 4.08-1.62l14.25 8.31c-.1.42-.16.86-.16 1.31A5.83 5.83 0 1 0 36 32.17z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cog">
      <path d="M38.86 25.95c.08-.64.14-1.29.14-1.95s-.06-1.31-.14-1.95l4.23-3.31c.38-.3.49-.84.24-1.28l-4-6.93c-.25-.43-.77-.61-1.22-.43l-4.98 2.01c-1.03-.79-2.16-1.46-3.38-1.97L29 4.84c-.09-.47-.5-.84-1-.84h-8c-.5 0-.91.37-.99.84l-.75 5.3a14.8 14.8 0 0 0-3.38 1.97L9.9 10.1a1 1 0 0 0-1.22.43l-4 6.93c-.25.43-.14.97.24 1.28l4.22 3.31C9.06 22.69 9 23.34 9 24s.06 1.31.14 1.95l-4.22 3.31c-.38.3-.49.84-.24 1.28l4 6.93c.25.43.77.61 1.22.43l4.98-2.01c1.03.79 2.16 1.46 3.38 1.97l.75 5.3c.08.47.49.84.99.84h8c.5 0 .91-.37.99-.84l.75-5.3a14.8 14.8 0 0 0 3.38-1.97l4.98 2.01a1 1 0 0 0 1.22-.43l4-6.93c.25-.43.14-.97-.24-1.28l-4.22-3.31zM24 31c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-square">
      <path d="M36 8H12c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h24c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zm0 28H12V12h24v24z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle">
      <circle cx="24" cy="24" r="20"></circle>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle-outline">
      <path d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle-inner-circle">
      <path d="M24 4C12.97 4 4 12.97 4 24s8.97 20 20 20 20-8.97 20-20S35.03 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16zm6-16c0 3.31-2.69 6-6 6s-6-2.69-6-6 2.69-6 6-6 6 2.69 6 6z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cancel">
      <path d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm10 27.17L31.17 34 24 26.83 16.83 34 14 31.17 21.17 24 14 16.83 16.83 14 24 21.17 31.17 14 34 16.83 26.83 24 34 31.17z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-replay">
      <path d="M24 10V2L14 12l10 10v-8c6.63 0 12 5.37 12 12s-5.37 12-12 12-12-5.37-12-12H8c0 8.84 7.16 16 16 16s16-7.16 16-16-7.16-16-16-16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-repeat">
      <path d="M14 14h20v6l8-8-8-8v6H10v12h4v-8zm20 20H14v-6l-8 8 8 8v-6h24V26h-4v8z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-5">
      <path d="M17.689 98l-8.697 8.696 8.697 8.697 2.486-2.485-4.32-4.319h1.302c4.93 0 9.071 1.722 12.424 5.165 3.352 3.443 5.029 7.638 5.029 12.584h3.55c0-2.958-.553-5.73-1.658-8.313-1.104-2.583-2.622-4.841-4.555-6.774-1.932-1.932-4.19-3.45-6.773-4.555-2.584-1.104-5.355-1.657-8.313-1.657H15.5l4.615-4.615zm-8.08 21.659v13.861h11.357v5.008H9.609V143h12.7c.834 0 1.55-.298 2.146-.894.596-.597.895-1.31.895-2.145v-7.781c0-.835-.299-1.55-.895-2.147a2.929 2.929 0 0 0-2.147-.894h-8.227v-5.096H25.35v-4.384z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-10">
      <path d="M42.315 125.63c0-4.997-1.694-9.235-5.08-12.713-3.388-3.479-7.571-5.218-12.552-5.218h-1.315l4.363 4.363-2.51 2.51-8.787-8.786L25.221 97l2.45 2.45-4.662 4.663h1.375c2.988 0 5.788.557 8.397 1.673 2.61 1.116 4.892 2.65 6.844 4.602 1.953 1.953 3.487 4.234 4.602 6.844 1.116 2.61 1.674 5.41 1.674 8.398zM8.183 142v-19.657H3.176V117.8h9.643V142zm13.63 0c-1.156 0-2.127-.393-2.912-1.178-.778-.778-1.168-1.746-1.168-2.902v-16.04c0-1.156.393-2.127 1.178-2.912.779-.779 1.746-1.168 2.902-1.168h7.696c1.156 0 2.126.392 2.911 1.177.779.78 1.168 1.747 1.168 2.903v16.04c0 1.156-.392 2.127-1.177 2.912-.779.779-1.746 1.168-2.902 1.168zm.556-4.636h6.583v-15.02H22.37z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-30">
      <path d="M26.047 97l-8.733 8.732 8.733 8.733 2.496-2.494-4.336-4.338h1.307c4.95 0 9.108 1.73 12.474 5.187 3.367 3.458 5.051 7.668 5.051 12.635h3.565c0-2.97-.556-5.751-1.665-8.346-1.109-2.594-2.633-4.862-4.574-6.802-1.94-1.941-4.208-3.466-6.803-4.575-2.594-1.109-5.375-1.664-8.345-1.664H23.85l4.634-4.634zM2.555 117.531v4.688h10.297v5.25H5.873v4.687h6.979v5.156H2.555V142H13.36c1.061 0 1.95-.395 2.668-1.186.718-.79 1.076-1.772 1.076-2.94v-16.218c0-1.168-.358-2.149-1.076-2.94-.717-.79-1.607-1.185-2.668-1.185zm22.482.14c-1.149 0-2.11.39-2.885 1.165-.78.78-1.172 1.744-1.172 2.893v15.943c0 1.149.388 2.11 1.163 2.885.78.78 1.745 1.172 2.894 1.172h7.649c1.148 0 2.11-.388 2.884-1.163.78-.78 1.17-1.745 1.17-2.894v-15.943c0-1.15-.386-2.111-1.16-2.885-.78-.78-1.746-1.172-2.894-1.172zm.553 4.518h6.545v14.93H25.59z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-5">
      <path d="M29.508 97l-2.431 2.43 4.625 4.625h-1.364c-2.965 0-5.742.554-8.332 1.66-2.589 1.107-4.851 2.629-6.788 4.566-1.937 1.937-3.458 4.2-4.565 6.788-1.107 2.59-1.66 5.367-1.66 8.331h3.557c0-4.957 1.68-9.16 5.04-12.611 3.36-3.45 7.51-5.177 12.451-5.177h1.304l-4.326 4.33 2.49 2.49 8.715-8.716zm-9.783 21.61v13.89h11.382v5.018H19.725V142h12.727a2.93 2.93 0 0 0 2.15-.896 2.93 2.93 0 0 0 .896-2.15v-7.798c0-.837-.299-1.554-.896-2.152a2.93 2.93 0 0 0-2.15-.896h-8.245V123h11.29v-4.392z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-10">
      <path d="M23.119 97l-2.386 2.383 4.538 4.538h-1.339c-2.908 0-5.633.543-8.173 1.63-2.54 1.085-4.76 2.577-6.66 4.478-1.9 1.9-3.392 4.12-4.478 6.66-1.085 2.54-1.629 5.264-1.629 8.172h3.49c0-4.863 1.648-8.986 4.944-12.372 3.297-3.385 7.368-5.078 12.216-5.078h1.279l-4.245 4.247 2.443 2.442 8.55-8.55zm-9.52 21.45v4.42h4.871V142h4.513v-23.55zm18.136 0c-1.125 0-2.066.377-2.824 1.135-.764.764-1.148 1.709-1.148 2.834v15.612c0 1.124.38 2.066 1.139 2.824.764.764 1.708 1.145 2.833 1.145h7.489c1.125 0 2.066-.378 2.824-1.136.764-.764 1.145-1.709 1.145-2.833v-15.612c0-1.125-.378-2.067-1.136-2.825-.764-.764-1.708-1.145-2.833-1.145zm.54 4.42h6.408v14.617h-6.407z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-30">
      <path d="M25.549 97l-2.437 2.434 4.634 4.635H26.38c-2.97 0-5.753.555-8.347 1.664-2.594 1.109-4.861 2.633-6.802 4.574-1.94 1.94-3.465 4.207-4.574 6.802-1.109 2.594-1.664 5.377-1.664 8.347h3.565c0-4.967 1.683-9.178 5.05-12.636 3.366-3.458 7.525-5.187 12.475-5.187h1.307l-4.335 4.338 2.495 2.494 8.732-8.732zm-11.553 20.53v4.689h10.297v5.249h-6.978v4.688h6.978v5.156H13.996V142h10.808c1.06 0 1.948-.395 2.666-1.186.718-.79 1.077-1.771 1.077-2.94v-16.217c0-1.169-.36-2.15-1.077-2.94-.718-.79-1.605-1.186-2.666-1.186zm21.174.168c-1.149 0-2.11.389-2.884 1.163-.78.78-1.172 1.745-1.172 2.894v15.942c0 1.15.388 2.11 1.162 2.885.78.78 1.745 1.17 2.894 1.17h7.649c1.149 0 2.11-.386 2.885-1.16.78-.78 1.17-1.746 1.17-2.895v-15.942c0-1.15-.387-2.11-1.161-2.885-.78-.78-1.745-1.172-2.894-1.172zm.552 4.516h6.542v14.931h-6.542z"></path>
    </symbol>
    <symbol viewBox="0 0 512 512" id="vjs-icon-audio-description">
      <g fill-rule="evenodd"><path d="M227.29 381.351V162.993c50.38-1.017 89.108-3.028 117.631 17.126 27.374 19.342 48.734 56.965 44.89 105.325-4.067 51.155-41.335 94.139-89.776 98.475-24.085 2.155-71.972 0-71.972 0s-.84-1.352-.773-2.568m48.755-54.804c31.43 1.26 53.208-16.633 56.495-45.386 4.403-38.51-21.188-63.552-58.041-60.796v103.612c-.036 1.466.575 2.22 1.546 2.57"></path><path d="M383.78 381.328c13.336 3.71 17.387-11.06 23.215-21.408 12.722-22.571 22.294-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.51c-.587 3.874 2.226 7.315 3.865 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894"></path><path d="M425.154 381.328c13.336 3.71 17.384-11.061 23.215-21.408 12.721-22.571 22.291-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.511c-.586 3.874 2.226 7.315 3.866 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894"></path><path d="M466.26 381.328c13.337 3.71 17.385-11.061 23.216-21.408 12.722-22.571 22.292-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.51c-.587 3.874 2.225 7.315 3.865 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894M4.477 383.005H72.58l18.573-28.484 64.169-.135s.065 19.413.065 28.62h48.756V160.307h-58.816c-5.653 9.537-140.85 222.697-140.85 222.697zm152.667-145.282v71.158l-40.453-.27 40.453-70.888z"></path></g>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-next-item">
      <path d="M12 36l17-12-17-12v24zm20-24v24h4V12h-4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-previous-item">
      <path d="M12 12h4v24h-4zm7 12l17 12V12z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-shuffle">
      <path d="M21.17 18.34L10.83 8 8 10.83l10.34 10.34 2.83-2.83zM29 8l4.09 4.09L8 37.17 10.83 40l25.09-25.09L40 19V8H29zm.66 18.83l-2.83 2.83 6.26 6.26L29 40h11V29l-4.09 4.09-6.25-6.26z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cast">
      <path d="M42 6H6c-2.21 0-4 1.79-4 4v6h4v-6h36v28H28v4h14c2.21 0 4-1.79 4-4V10c0-2.21-1.79-4-4-4zM2 36v6h6c0-3.31-2.69-6-6-6zm0-8v4c5.52 0 10 4.48 10 10h4c0-7.73-6.27-14-14-14zm0-8v4c9.94 0 18 8.06 18 18h4c0-12.15-9.85-22-22-22z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-picture-in-picture-enter">
      <path d="M38 22H22v11.99h16V22zm8 16V9.96C46 7.76 44.2 6 42 6H6C3.8 6 2 7.76 2 9.96V38c0 2.2 1.8 4 4 4h36c2.2 0 4-1.8 4-4zm-4 .04H6V9.94h36v28.1z"></path>
    </symbol>
    <symbol viewBox="0 0 22 18" id="vjs-icon-picture-in-picture-exit">
      <path d="M18 4H4v10h14V4zm4 12V1.98C22 .88 21.1 0 20 0H2C.9 0 0 .88 0 1.98V16c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2zm-2 .02H2V1.97h18v14.05z"></path>
      <path fill="none" d="M-1-3h24v24H-1z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-facebook">
      <path d="M1343 12v264h-157q-86 0-116 36t-30 108v189h293l-39 296h-254v759H734V905H479V609h255V391q0-186 104-288.5T1115 0q147 0 228 12z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-linkedin">
      <path d="M477 625v991H147V625h330zm21-306q1 73-50.5 122T312 490h-2q-82 0-132-49t-50-122q0-74 51.5-122.5T314 148t133 48.5T498 319zm1166 729v568h-329v-530q0-105-40.5-164.5T1168 862q-63 0-105.5 34.5T999 982q-11 30-11 81v553H659q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5T1285 602q171 0 275 113.5t104 332.5z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-twitter">
      <path d="M1684 408q-67 98-162 167 1 14 1 42 0 130-38 259.5T1369.5 1125 1185 1335.5t-258 146-323 54.5q-271 0-496-145 35 4 78 4 225 0 401-138-105-2-188-64.5T285 1033q33 5 61 5 43 0 85-11-112-23-185.5-111.5T172 710v-4q68 38 146 41-66-44-105-115t-39-154q0-88 44-163 121 149 294.5 238.5T884 653q-8-38-8-74 0-134 94.5-228.5T1199 256q140 0 236 102 109-21 205-78-37 115-142 178 93-10 186-50z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-tumblr">
      <path d="M1328 1329l80 237q-23 35-111 66t-177 32q-104 2-190.5-26T787 1564t-95-106-55.5-120-16.5-118V676H452V461q72-26 129-69.5t91-90 58-102 34-99T779 12q1-5 4.5-8.5T791 0h244v424h333v252h-334v518q0 30 6.5 56t22.5 52.5 49.5 41.5 81.5 14q78-2 134-29z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-pinterest">
      <path d="M1664 896q0 209-103 385.5T1281.5 1561 896 1664q-111 0-218-32 59-93 78-164 9-34 54-211 20 39 73 67.5t114 28.5q121 0 216-68.5t147-188.5 52-270q0-114-59.5-214T1180 449t-255-63q-105 0-196 29t-154.5 77-109 110.5-67 129.5T377 866q0 104 40 183t117 111q30 12 38-20 2-7 8-31t8-30q6-23-11-43-51-61-51-151 0-151 104.5-259.5T904 517q151 0 235.5 82t84.5 213q0 170-68.5 289T980 1220q-61 0-98-43.5T859 1072q8-35 26.5-93.5t30-103T927 800q0-50-27-83t-77-33q-62 0-105 57t-43 142q0 73 25 122l-99 418q-17 70-13 177-206-91-333-281T128 896q0-209 103-385.5T510.5 231 896 128t385.5 103T1561 510.5 1664 896z"></path>
    </symbol>
  </defs>
</svg>`;class Uc extends it{constructor(e,i,r){const l=ci({createEl:!1},i);super(e,l,r);if(!i.playerOptions.sources||i.playerOptions.sources.length===0)for(let d=0,f=i.playerOptions.techOrder;d<f.length;d++){const y=Ji(f[d]);let L=si.getTech(y);if(y||(L=it.getComponent(y)),L&&L.isSupported()){e.loadTech_(y);break}}else e.src(i.playerOptions.sources)}}it.registerComponent("MediaLoader",Uc);class ll extends it{constructor(e,i){super(e,i);this.options_.controlText&&this.controlText(this.options_.controlText),this.handleMouseOver_=r=>this.handleMouseOver(r),this.handleMouseOut_=r=>this.handleMouseOut(r),this.handleClick_=r=>this.handleClick(r),this.handleKeyDown_=r=>this.handleKeyDown(r),this.emitTapEvents(),this.enable()}createEl(e="div",i={},r={}){i=Object.assign({className:this.buildCSSClass(),tabIndex:0},i),e==="button"&&ni.error(`Creating a ClickableComponent with an HTML element of ${e} is not supported; use a Button instead.`),r=Object.assign({role:"button"},r),this.tabIndex_=i.tabIndex;const l=ri(e,i,r);return this.player_.options_.experimentalSvgIcons||l.appendChild(ri("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(l),l}dispose(){this.controlTextEl_=null,super.dispose()}createControlTextEl(e){return this.controlTextEl_=ri("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_}controlText(e,i=this.el()){if(e===void 0)return this.controlText_||"Need Text";const r=this.localize(e);this.controlText_=e,jr(this.controlTextEl_,r),!this.nonIconControl&&!this.player_.options_.noUITitleAttributes&&i.setAttribute("title",r)}buildCSSClass(){return`vjs-control vjs-button ${super.buildCSSClass()}`}enable(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),typeof this.tabIndex_!="undefined"&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick_),this.on("keydown",this.handleKeyDown_))}disable(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),typeof this.tabIndex_!="undefined"&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver_),this.off("mouseout",this.handleMouseOut_),this.off(["tap","click"],this.handleClick_),this.off("keydown",this.handleKeyDown_)}handleLanguagechange(){this.controlText(this.controlText_)}handleClick(e){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)}handleKeyDown(e){me().isEventKey(e,"Space")||me().isEventKey(e,"Enter")?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):super.handleKeyDown(e)}}it.registerComponent("ClickableComponent",ll);class ul extends ll{constructor(e,i){super(e,i);this.update(),this.update_=r=>this.update(r),e.on("posterchange",this.update_)}dispose(){this.player().off("posterchange",this.update_),super.dispose()}createEl(){return ri("div",{className:"vjs-poster"})}crossOrigin(e){if(typeof e=="undefined")return this.$("img")?this.$("img").crossOrigin:this.player_.tech_&&this.player_.tech_.isReady_?this.player_.crossOrigin():this.player_.options_.crossOrigin||this.player_.options_.crossorigin||null;if(e!==null&&e!=="anonymous"&&e!=="use-credentials"){this.player_.log.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${e}"`);return}this.$("img")&&(this.$("img").crossOrigin=e)}update(e){const i=this.player().poster();this.setSrc(i),i?this.show():this.hide()}setSrc(e){if(!e){this.el_.textContent="";return}this.$("img")||this.el_.appendChild(ri("picture",{className:"vjs-poster",tabIndex:-1},{},ri("img",{loading:"lazy",crossOrigin:this.crossOrigin()},{alt:""}))),this.$("img").src=e}handleClick(e){!this.player_.controls()||(this.player_.tech(!0)&&this.player_.tech(!0).focus(),this.player_.paused()?Gr(this.player_.play()):this.player_.pause())}}ul.prototype.crossorigin=ul.prototype.crossOrigin,it.registerComponent("PosterImage",ul);const zn="#222",gd="#ccc",yd={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function to(s,e){let i;if(s.length===4)i=s[1]+s[1]+s[2]+s[2]+s[3]+s[3];else if(s.length===7)i=s.slice(1);else throw new Error("Invalid color code provided, "+s+"; must be formatted as e.g. #f0e or #f604e2.");return"rgba("+parseInt(i.slice(0,2),16)+","+parseInt(i.slice(2,4),16)+","+parseInt(i.slice(4,6),16)+","+e+")"}function io(s,e,i){try{s.style[e]=i}catch(r){return}}function no(s){return s?`${s}px`:""}class Ca extends it{constructor(e,i,r){super(e,i,r);const l=f=>this.updateDisplay(f),d=f=>{this.updateDisplayOverlay(),this.updateDisplay(f)};e.on("loadstart",f=>this.toggleDisplay(f)),e.on("texttrackchange",l),e.on("loadedmetadata",f=>{this.updateDisplayOverlay(),this.preselectTrack(f)}),e.ready(Ci(this,function(){if(e.tech_&&e.tech_.featuresNativeTextTracks){this.hide();return}e.on("fullscreenchange",d),e.on("playerresize",d);const f=le().screen.orientation||le(),y=le().screen.orientation?"change":"orientationchange";f.addEventListener(y,d),e.on("dispose",()=>f.removeEventListener(y,d));const L=this.options_.playerOptions.tracks||[];for(let B=0;B<L.length;B++)this.player_.addRemoteTextTrack(L[B],!0);this.preselectTrack()}))}preselectTrack(){const e={captions:1,subtitles:1},i=this.player_.textTracks(),r=this.player_.cache_.selectedLanguage;let l,d,f;for(let y=0;y<i.length;y++){const L=i[y];r&&r.enabled&&r.language&&r.language===L.language&&L.kind in e?L.kind===r.kind?f=L:f||(f=L):r&&!r.enabled?(f=null,l=null,d=null):L.default&&(L.kind==="descriptions"&&!l?l=L:L.kind in e&&!d&&(d=L))}f?f.mode="showing":d?d.mode="showing":l&&(l.mode="showing")}toggleDisplay(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()}createEl(){return super.createEl("div",{className:"vjs-text-track-display"},{translate:"yes","aria-live":"off","aria-atomic":"true"})}clearDisplay(){typeof le().WebVTT=="function"&&le().WebVTT.processCues(le(),[],this.el_)}updateDisplay(){const e=this.player_.textTracks(),i=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),i){const f=[];for(let y=0;y<e.length;++y){const L=e[y];L.mode==="showing"&&f.push(L)}this.updateForTrack(f);return}let r=null,l=null,d=e.length;for(;d--;){const f=e[d];f.mode==="showing"&&(f.kind==="descriptions"?r=f:l=f)}l?(this.getAttribute("aria-live")!=="off"&&this.setAttribute("aria-live","off"),this.updateForTrack(l)):r&&(this.getAttribute("aria-live")!=="assertive"&&this.setAttribute("aria-live","assertive"),this.updateForTrack(r))}updateDisplayOverlay(){if(!this.player_.videoHeight()||!le().CSS.supports("inset-inline: 10px"))return;const e=this.player_.currentWidth(),i=this.player_.currentHeight(),r=e/i,l=this.player_.videoWidth()/this.player_.videoHeight();let d=0,f=0;Math.abs(r-l)>.1&&(r>l?d=Math.round((e-i*l)/2):f=Math.round((i-e/l)/2)),io(this.el_,"insetInline",no(d)),io(this.el_,"insetBlock",no(f))}updateDisplayState(e){const i=this.player_.textTrackSettings.getValues(),r=e.activeCues;let l=r.length;for(;l--;){const d=r[l];if(!d)continue;const f=d.displayState;if(i.color&&(f.firstChild.style.color=i.color),i.textOpacity&&io(f.firstChild,"color",to(i.color||"#fff",i.textOpacity)),i.backgroundColor&&(f.firstChild.style.backgroundColor=i.backgroundColor),i.backgroundOpacity&&io(f.firstChild,"backgroundColor",to(i.backgroundColor||"#000",i.backgroundOpacity)),i.windowColor&&(i.windowOpacity?io(f,"backgroundColor",to(i.windowColor,i.windowOpacity)):f.style.backgroundColor=i.windowColor),i.edgeStyle&&(i.edgeStyle==="dropshadow"?f.firstChild.style.textShadow=`2px 2px 3px ${zn}, 2px 2px 4px ${zn}, 2px 2px 5px ${zn}`:i.edgeStyle==="raised"?f.firstChild.style.textShadow=`1px 1px ${zn}, 2px 2px ${zn}, 3px 3px ${zn}`:i.edgeStyle==="depressed"?f.firstChild.style.textShadow=`1px 1px ${gd}, 0 1px ${gd}, -1px -1px ${zn}, 0 -1px ${zn}`:i.edgeStyle==="uniform"&&(f.firstChild.style.textShadow=`0 0 4px ${zn}, 0 0 4px ${zn}, 0 0 4px ${zn}, 0 0 4px ${zn}`)),i.fontPercent&&i.fontPercent!==1){const y=le().parseFloat(f.style.fontSize);f.style.fontSize=y*i.fontPercent+"px",f.style.height="auto",f.style.top="auto"}i.fontFamily&&i.fontFamily!=="default"&&(i.fontFamily==="small-caps"?f.firstChild.style.fontVariant="small-caps":f.firstChild.style.fontFamily=yd[i.fontFamily])}}updateForTrack(e){if(Array.isArray(e)||(e=[e]),typeof le().WebVTT!="function"||e.every(r=>!r.activeCues))return;const i=[];for(let r=0;r<e.length;++r){const l=e[r];for(let d=0;d<l.activeCues.length;++d)i.push(l.activeCues[d])}le().WebVTT.processCues(le(),i,this.el_);for(let r=0;r<e.length;++r){const l=e[r];for(let d=0;d<l.activeCues.length;++d){const f=l.activeCues[d].displayState;$r(f,"vjs-text-track-cue","vjs-text-track-cue-"+(l.language?l.language:r)),l.language&&Ar(f,"lang",l.language)}this.player_.textTrackSettings&&this.updateDisplayState(l)}}}it.registerComponent("TextTrackDisplay",Ca);class ar extends it{createEl(){const e=this.player_.isAudio(),i=this.localize(e?"Audio Player":"Video Player"),r=ri("span",{className:"vjs-control-text",textContent:this.localize("{1} is loading.",[i])}),l=super.createEl("div",{className:"vjs-loading-spinner",dir:"ltr"});return l.appendChild(r),l}handleLanguagechange(){this.$(".vjs-control-text").textContent=this.localize("{1} is loading.",[this.player_.isAudio()?"Audio Player":"Video Player"])}}it.registerComponent("LoadingSpinner",ar);class Oi extends ll{createEl(e,i={},r={}){e="button",i=Object.assign({className:this.buildCSSClass()},i),r=Object.assign({type:"button"},r);const l=ri(e,i,r);return this.player_.options_.experimentalSvgIcons||l.appendChild(ri("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(l),l}addChild(e,i={}){const r=this.constructor.name;return ni.warn(`Adding an actionable (user controllable) child to a Button (${r}) is not supported; use a ClickableComponent instead.`),it.prototype.addChild.call(this,e,i)}enable(){super.enable(),this.el_.removeAttribute("disabled")}disable(){super.disable(),this.el_.setAttribute("disabled","disabled")}handleKeyDown(e){if(me().isEventKey(e,"Space")||me().isEventKey(e,"Enter")){e.stopPropagation();return}super.handleKeyDown(e)}}it.registerComponent("Button",Oi);class dl extends Oi{constructor(e,i){super(e,i);this.mouseused_=!1,this.setIcon("play"),this.on("mousedown",r=>this.handleMouseDown(r))}buildCSSClass(){return"vjs-big-play-button"}handleClick(e){const i=this.player_.play();if(this.mouseused_&&"clientX"in e&&"clientY"in e){Gr(i),this.player_.tech(!0)&&this.player_.tech(!0).focus();return}const r=this.player_.getChild("controlBar"),l=r&&r.getChild("playToggle");if(!l){this.player_.tech(!0).focus();return}const d=()=>l.focus();Za(i)?i.then(d,()=>{}):this.setTimeout(d,1)}handleKeyDown(e){this.mouseused_=!1,super.handleKeyDown(e)}handleMouseDown(e){this.mouseused_=!0}}dl.prototype.controlText_="Play Video",it.registerComponent("BigPlayButton",dl);class Js extends Oi{constructor(e,i){super(e,i);this.setIcon("cancel"),this.controlText(i&&i.controlText||this.localize("Close"))}buildCSSClass(){return`vjs-close-button ${super.buildCSSClass()}`}handleClick(e){this.trigger({type:"close",bubbles:!1})}handleKeyDown(e){me().isEventKey(e,"Esc")?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):super.handleKeyDown(e)}}it.registerComponent("CloseButton",Js);class vd extends Oi{constructor(e,i={}){super(e,i);i.replay=i.replay===void 0||i.replay,this.setIcon("play"),this.on(e,"play",r=>this.handlePlay(r)),this.on(e,"pause",r=>this.handlePause(r)),i.replay&&this.on(e,"ended",r=>this.handleEnded(r))}buildCSSClass(){return`vjs-play-control ${super.buildCSSClass()}`}handleClick(e){this.player_.paused()?Gr(this.player_.play()):this.player_.pause()}handleSeeked(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)}handlePlay(e){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.setIcon("pause"),this.controlText("Pause")}handlePause(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.setIcon("play"),this.controlText("Play")}handleEnded(e){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.setIcon("replay"),this.controlText("Replay"),this.one(this.player_,"seeked",i=>this.handleSeeked(i))}}vd.prototype.controlText_="Play",it.registerComponent("PlayToggle",vd);class Tr extends it{constructor(e,i){super(e,i);this.on(e,["timeupdate","ended","seeking"],r=>this.update(r)),this.updateTextNode_()}createEl(){const e=this.buildCSSClass(),i=super.createEl("div",{className:`${e} vjs-time-control vjs-control`}),r=ri("span",{className:"vjs-control-text",textContent:`${this.localize(this.labelText_)}\xA0`},{role:"presentation"});return i.appendChild(r),this.contentEl_=ri("span",{className:`${e}-display`},{role:"presentation"}),i.appendChild(this.contentEl_),i}dispose(){this.contentEl_=null,this.textNode_=null,super.dispose()}update(e){!this.player_.options_.enableSmoothSeeking&&e.type==="seeking"||this.updateContent(e)}updateTextNode_(e=0){e=xs(e),this.formattedTime_!==e&&(this.formattedTime_=e,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",()=>{if(!this.contentEl_)return;let i=this.textNode_;i&&this.contentEl_.firstChild!==i&&(i=null,ni.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")),this.textNode_=Ee().createTextNode(this.formattedTime_),!!this.textNode_&&(i?this.contentEl_.replaceChild(this.textNode_,i):this.contentEl_.appendChild(this.textNode_))}))}updateContent(e){}}Tr.prototype.labelText_="Time",Tr.prototype.controlText_="Time",it.registerComponent("TimeDisplay",Tr);class cl extends Tr{buildCSSClass(){return"vjs-current-time"}updateContent(e){let i;this.player_.ended()?i=this.player_.duration():i=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(i)}}cl.prototype.labelText_="Current Time",cl.prototype.controlText_="Current Time",it.registerComponent("CurrentTimeDisplay",cl);class du extends Tr{constructor(e,i){super(e,i);const r=l=>this.updateContent(l);this.on(e,"durationchange",r),this.on(e,"loadstart",r),this.on(e,"loadedmetadata",r)}buildCSSClass(){return"vjs-duration"}updateContent(e){const i=this.player_.duration();this.updateTextNode_(i)}}du.prototype.labelText_="Duration",du.prototype.controlText_="Duration",it.registerComponent("DurationDisplay",du);class jc extends it{createEl(){const e=super.createEl("div",{className:"vjs-time-control vjs-time-divider"},{"aria-hidden":!0}),i=super.createEl("div"),r=super.createEl("span",{textContent:"/"});return i.appendChild(r),e.appendChild(i),e}}it.registerComponent("TimeDivider",jc);class cu extends Tr{constructor(e,i){super(e,i);this.on(e,"durationchange",r=>this.updateContent(r))}buildCSSClass(){return"vjs-remaining-time"}createEl(){const e=super.createEl();return this.options_.displayNegative!==!1&&e.insertBefore(ri("span",{},{"aria-hidden":!0},"-"),this.contentEl_),e}updateContent(e){if(typeof this.player_.duration()!="number")return;let i;this.player_.ended()?i=0:this.player_.remainingTimeDisplay?i=this.player_.remainingTimeDisplay():i=this.player_.remainingTime(),this.updateTextNode_(i)}}cu.prototype.labelText_="Remaining Time",cu.prototype.controlText_="Remaining Time",it.registerComponent("RemainingTimeDisplay",cu);class Ad extends it{constructor(e,i){super(e,i);this.updateShowing(),this.on(this.player(),"durationchange",r=>this.updateShowing(r))}createEl(){const e=super.createEl("div",{className:"vjs-live-control vjs-control"});return this.contentEl_=ri("div",{className:"vjs-live-display"},{"aria-live":"off"}),this.contentEl_.appendChild(ri("span",{className:"vjs-control-text",textContent:`${this.localize("Stream Type")}\xA0`})),this.contentEl_.appendChild(Ee().createTextNode(this.localize("LIVE"))),e.appendChild(this.contentEl_),e}dispose(){this.contentEl_=null,super.dispose()}updateShowing(e){this.player().duration()===Infinity?this.show():this.hide()}}it.registerComponent("LiveDisplay",Ad);class bd extends Oi{constructor(e,i){super(e,i);this.updateLiveEdgeStatus(),this.player_.liveTracker&&(this.updateLiveEdgeStatusHandler_=r=>this.updateLiveEdgeStatus(r),this.on(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_))}createEl(){const e=super.createEl("button",{className:"vjs-seek-to-live-control vjs-control"});return this.setIcon("circle",e),this.textEl_=ri("span",{className:"vjs-seek-to-live-text",textContent:this.localize("LIVE")},{"aria-hidden":"true"}),e.appendChild(this.textEl_),e}updateLiveEdgeStatus(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))}handleClick(){this.player_.liveTracker.seekToLiveEdge()}dispose(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_),this.textEl_=null,super.dispose()}}bd.prototype.controlText_="Seek to live, currently playing live",it.registerComponent("SeekToLive",bd);function ro(s,e,i){return s=Number(s),Math.min(i,Math.max(e,isNaN(s)?e:s))}var $c=Object.freeze({__proto__:null,clamp:ro});class hu extends it{constructor(e,i){super(e,i);this.handleMouseDown_=r=>this.handleMouseDown(r),this.handleMouseUp_=r=>this.handleMouseUp(r),this.handleKeyDown_=r=>this.handleKeyDown(r),this.handleClick_=r=>this.handleClick(r),this.handleMouseMove_=r=>this.handleMouseMove(r),this.update_=r=>this.update(r),this.bar=this.getChild(this.options_.barName),this.vertical(!!this.options_.vertical),this.enable()}enabled(){return this.enabled_}enable(){this.enabled()||(this.on("mousedown",this.handleMouseDown_),this.on("touchstart",this.handleMouseDown_),this.on("keydown",this.handleKeyDown_),this.on("click",this.handleClick_),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)}disable(){if(!this.enabled())return;const e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown_),this.off("touchstart",this.handleMouseDown_),this.off("keydown",this.handleKeyDown_),this.off("click",this.handleClick_),this.off(this.player_,"controlsvisible",this.update_),this.off(e,"mousemove",this.handleMouseMove_),this.off(e,"mouseup",this.handleMouseUp_),this.off(e,"touchmove",this.handleMouseMove_),this.off(e,"touchend",this.handleMouseUp_),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}createEl(e,i={},r={}){return i.className=i.className+" vjs-slider",i=Object.assign({tabIndex:0},i),r=Object.assign({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100},r),super.createEl(e,i,r)}handleMouseDown(e){const i=this.bar.el_.ownerDocument;e.type==="mousedown"&&e.preventDefault(),e.type==="touchstart"&&!Sn&&e.preventDefault(),jo(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(i,"mousemove",this.handleMouseMove_),this.on(i,"mouseup",this.handleMouseUp_),this.on(i,"touchmove",this.handleMouseMove_),this.on(i,"touchend",this.handleMouseUp_),this.handleMouseMove(e,!0)}handleMouseMove(e){}handleMouseUp(e){const i=this.bar.el_.ownerDocument;T(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(i,"mousemove",this.handleMouseMove_),this.off(i,"mouseup",this.handleMouseUp_),this.off(i,"touchmove",this.handleMouseMove_),this.off(i,"touchend",this.handleMouseUp_),this.update()}update(){if(!this.el_||!this.bar)return;const e=this.getProgress();return e===this.progress_||(this.progress_=e,this.requestNamedAnimationFrame("Slider#update",()=>{const i=this.vertical()?"height":"width";this.bar.el().style[i]=(e*100).toFixed(2)+"%"})),e}getProgress(){return Number(ro(this.getPercent(),0,1).toFixed(4))}calculateDistance(e){const i=x(this.el_,e);return this.vertical()?i.y:i.x}handleKeyDown(e){me().isEventKey(e,"Left")||me().isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepBack()):me().isEventKey(e,"Right")||me().isEventKey(e,"Up")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):super.handleKeyDown(e)}handleClick(e){e.stopPropagation(),e.preventDefault()}vertical(e){if(e===void 0)return this.vertical_||!1;this.vertical_=!!e,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")}}it.registerComponent("Slider",hu);const fu=(s,e)=>ro(s/e*100,0,100).toFixed(2)+"%";class Vc extends it{constructor(e,i){super(e,i);this.partEls_=[],this.on(e,"progress",r=>this.update(r))}createEl(){const e=super.createEl("div",{className:"vjs-load-progress"}),i=ri("span",{className:"vjs-control-text"}),r=ri("span",{textContent:this.localize("Loaded")}),l=Ee().createTextNode(": ");return this.percentageEl_=ri("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),e.appendChild(i),i.appendChild(r),i.appendChild(l),i.appendChild(this.percentageEl_),e}dispose(){this.partEls_=null,this.percentageEl_=null,super.dispose()}update(e){this.requestNamedAnimationFrame("LoadProgressBar#update",()=>{const i=this.player_.liveTracker,r=this.player_.buffered(),l=i&&i.isLive()?i.seekableEnd():this.player_.duration(),d=this.player_.bufferedEnd(),f=this.partEls_,y=fu(d,l);this.percent_!==y&&(this.el_.style.width=y,jr(this.percentageEl_,y),this.percent_=y);for(let L=0;L<r.length;L++){const B=r.start(L),W=r.end(L);let ce=f[L];ce||(ce=this.el_.appendChild(ri()),f[L]=ce),!(ce.dataset.start===B&&ce.dataset.end===W)&&(ce.dataset.start=B,ce.dataset.end=W,ce.style.left=fu(B,d),ce.style.width=fu(W-B,d))}for(let L=f.length;L>r.length;L--)this.el_.removeChild(f[L-1]);f.length=r.length})}}it.registerComponent("LoadProgressBar",Vc);class Gc extends it{constructor(e,i){super(e,i);this.update=Vr(Ci(this,this.update),nr)}createEl(){return super.createEl("div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})}update(e,i,r){const l=q(this.el_),d=k(this.player_.el()),f=e.width*i;if(!d||!l)return;const y=e.left-d.left+f,L=e.width-f+(d.right-e.right);let B=l.width/2;y<B?B+=B-y:L<B&&(B=L),B<0?B=0:B>l.width&&(B=l.width),B=Math.round(B),this.el_.style.right=`-${B}px`,this.write(r)}write(e){jr(this.el_,e)}updateTime(e,i,r,l){this.requestNamedAnimationFrame("TimeTooltip#updateTime",()=>{let d;const f=this.player_.duration();if(this.player_.liveTracker&&this.player_.liveTracker.isLive()){const y=this.player_.liveTracker.liveWindow(),L=y-i*y;d=(L<1?"":"-")+xs(L,y)}else d=xs(r,f);this.update(e,i,d),l&&l()})}}it.registerComponent("TimeTooltip",Gc);class pu extends it{constructor(e,i){super(e,i);this.setIcon("circle"),this.update=Vr(Ci(this,this.update),nr)}createEl(){return super.createEl("div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})}update(e,i){const r=this.getChild("timeTooltip");if(!r)return;const l=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();r.updateTime(e,i,l)}}pu.prototype.options_={children:[]},!bn&&!cn&&pu.prototype.options_.children.push("timeTooltip"),it.registerComponent("PlayProgressBar",pu);class Sr extends it{constructor(e,i){super(e,i);this.update=Vr(Ci(this,this.update),nr)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(e,i){const r=i*this.player_.duration();this.getChild("timeTooltip").updateTime(e,i,r,()=>{this.el_.style.left=`${e.width*i}px`})}}Sr.prototype.options_={children:["timeTooltip"]},it.registerComponent("MouseTimeDisplay",Sr);const hl=5,_d=12;class mu extends hu{constructor(e,i){super(e,i);this.setEventHandlers_()}setEventHandlers_(){this.update_=Ci(this,this.update),this.update=Vr(this.update_,nr),this.on(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.enableIntervalHandler_=e=>this.enableInterval_(e),this.disableIntervalHandler_=e=>this.disableInterval_(e),this.on(this.player_,["playing"],this.enableIntervalHandler_),this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in Ee()&&"visibilityState"in Ee()&&this.on(Ee(),"visibilitychange",this.toggleVisibility_)}toggleVisibility_(e){Ee().visibilityState==="hidden"?(this.cancelNamedAnimationFrame("SeekBar#update"),this.cancelNamedAnimationFrame("Slider#update"),this.disableInterval_(e)):(!this.player_.ended()&&!this.player_.paused()&&this.enableInterval_(),this.update())}enableInterval_(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,nr))}disableInterval_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&e&&e.type!=="ended"||!this.updateInterval||(this.clearInterval(this.updateInterval),this.updateInterval=null)}createEl(){return super.createEl("div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})}update(e){if(Ee().visibilityState==="hidden")return;const i=super.update();return this.requestNamedAnimationFrame("SeekBar#update",()=>{const r=this.player_.ended()?this.player_.duration():this.getCurrentTime_(),l=this.player_.liveTracker;let d=this.player_.duration();l&&l.isLive()&&(d=this.player_.liveTracker.liveCurrentTime()),this.percent_!==i&&(this.el_.setAttribute("aria-valuenow",(i*100).toFixed(2)),this.percent_=i),(this.currentTime_!==r||this.duration_!==d)&&(this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[xs(r,d),xs(d,d)],"{1} of {2}")),this.currentTime_=r,this.duration_=d),this.bar&&this.bar.update(k(this.el()),this.getProgress())}),i}userSeek_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(e)}getCurrentTime_(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()}getPercent(){const e=this.getCurrentTime_();let i;const r=this.player_.liveTracker;return r&&r.isLive()?(i=(e-r.seekableStart())/r.liveWindow(),r.atLiveEdge()&&(i=1)):i=e/this.player_.duration(),i}handleMouseDown(e){!Ve(e)||(e.stopPropagation(),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),super.handleMouseDown(e))}handleMouseMove(e,i=!1){if(!Ve(e)||isNaN(this.player_.duration()))return;!i&&!this.player_.scrubbing()&&this.player_.scrubbing(!0);let r;const l=this.calculateDistance(e),d=this.player_.liveTracker;if(!d||!d.isLive())r=l*this.player_.duration(),r===this.player_.duration()&&(r=r-.1);else{if(l>=.99){d.seekToLiveEdge();return}const f=d.seekableStart(),y=d.liveCurrentTime();if(r=f+l*d.liveWindow(),r>=y&&(r=y),r<=f&&(r=f+.1),r===Infinity)return}this.userSeek_(r),this.player_.options_.enableSmoothSeeking&&this.update()}enable(){super.enable();const e=this.getChild("mouseTimeDisplay");!e||e.show()}disable(){super.disable();const e=this.getChild("mouseTimeDisplay");!e||e.hide()}handleMouseUp(e){super.handleMouseUp(e),e&&e.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?Gr(this.player_.play()):this.update_()}stepForward(){this.userSeek_(this.player_.currentTime()+hl)}stepBack(){this.userSeek_(this.player_.currentTime()-hl)}handleAction(e){this.player_.paused()?this.player_.play():this.player_.pause()}handleKeyDown(e){const i=this.player_.liveTracker;if(me().isEventKey(e,"Space")||me().isEventKey(e,"Enter"))e.preventDefault(),e.stopPropagation(),this.handleAction(e);else if(me().isEventKey(e,"Home"))e.preventDefault(),e.stopPropagation(),this.userSeek_(0);else if(me().isEventKey(e,"End"))e.preventDefault(),e.stopPropagation(),i&&i.isLive()?this.userSeek_(i.liveCurrentTime()):this.userSeek_(this.player_.duration());else if(/^[0-9]$/.test(me()(e))){e.preventDefault(),e.stopPropagation();const r=(me().codes[me()(e)]-me().codes[0])*10/100;i&&i.isLive()?this.userSeek_(i.seekableStart()+i.liveWindow()*r):this.userSeek_(this.player_.duration()*r)}else me().isEventKey(e,"PgDn")?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()-hl*_d)):me().isEventKey(e,"PgUp")?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()+hl*_d)):super.handleKeyDown(e)}dispose(){this.disableInterval_(),this.off(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableIntervalHandler_),this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in Ee()&&"visibilityState"in Ee()&&this.off(Ee(),"visibilitychange",this.toggleVisibility_),super.dispose()}}mu.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},!bn&&!cn&&mu.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),it.registerComponent("SeekBar",mu);class gu extends it{constructor(e,i){super(e,i);this.handleMouseMove=Vr(Ci(this,this.handleMouseMove),nr),this.throttledHandleMouseSeek=Vr(Ci(this,this.handleMouseSeek),nr),this.handleMouseUpHandler_=r=>this.handleMouseUp(r),this.handleMouseDownHandler_=r=>this.handleMouseDown(r),this.enable()}createEl(){return super.createEl("div",{className:"vjs-progress-control vjs-control"})}handleMouseMove(e){const i=this.getChild("seekBar");if(!i)return;const r=i.getChild("playProgressBar"),l=i.getChild("mouseTimeDisplay");if(!r&&!l)return;const d=i.el(),f=q(d);let y=x(d,e).x;y=ro(y,0,1),l&&l.update(f,y),r&&r.update(f,i.getProgress())}handleMouseSeek(e){const i=this.getChild("seekBar");i&&i.handleMouseMove(e)}enabled(){return this.enabled_}disable(){if(this.children().forEach(e=>e.disable&&e.disable()),!!this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDownHandler_),this.off(this.el_,"mousemove",this.handleMouseMove),this.removeListenersAddedOnMousedownAndTouchstart(),this.addClass("disabled"),this.enabled_=!1,this.player_.scrubbing())){const e=this.getChild("seekBar");this.player_.scrubbing(!1),e.videoWasPlaying&&Gr(this.player_.play())}}enable(){this.children().forEach(e=>e.enable&&e.enable()),!this.enabled()&&(this.on(["mousedown","touchstart"],this.handleMouseDownHandler_),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)}removeListenersAddedOnMousedownAndTouchstart(){const e=this.el_.ownerDocument;this.off(e,"mousemove",this.throttledHandleMouseSeek),this.off(e,"touchmove",this.throttledHandleMouseSeek),this.off(e,"mouseup",this.handleMouseUpHandler_),this.off(e,"touchend",this.handleMouseUpHandler_)}handleMouseDown(e){const i=this.el_.ownerDocument,r=this.getChild("seekBar");r&&r.handleMouseDown(e),this.on(i,"mousemove",this.throttledHandleMouseSeek),this.on(i,"touchmove",this.throttledHandleMouseSeek),this.on(i,"mouseup",this.handleMouseUpHandler_),this.on(i,"touchend",this.handleMouseUpHandler_)}handleMouseUp(e){const i=this.getChild("seekBar");i&&i.handleMouseUp(e),this.removeListenersAddedOnMousedownAndTouchstart()}}gu.prototype.options_={children:["seekBar"]},it.registerComponent("ProgressControl",gu);class xd extends Oi{constructor(e,i){super(e,i);this.setIcon("picture-in-picture-enter"),this.on(e,["enterpictureinpicture","leavepictureinpicture"],r=>this.handlePictureInPictureChange(r)),this.on(e,["disablepictureinpicturechanged","loadedmetadata"],r=>this.handlePictureInPictureEnabledChange(r)),this.on(e,["loadedmetadata","audioonlymodechange","audiopostermodechange"],()=>this.handlePictureInPictureAudioModeChange()),this.disable()}buildCSSClass(){return`vjs-picture-in-picture-control vjs-hidden ${super.buildCSSClass()}`}handlePictureInPictureAudioModeChange(){if(!(this.player_.currentType().substring(0,5)==="audio"||this.player_.audioPosterMode()||this.player_.audioOnlyMode())){this.show();return}this.player_.isInPictureInPicture()&&this.player_.exitPictureInPicture(),this.hide()}handlePictureInPictureEnabledChange(){Ee().pictureInPictureEnabled&&this.player_.disablePictureInPicture()===!1||this.player_.options_.enableDocumentPictureInPicture&&"documentPictureInPicture"in le()?this.enable():this.disable()}handlePictureInPictureChange(e){this.player_.isInPictureInPicture()?(this.setIcon("picture-in-picture-exit"),this.controlText("Exit Picture-in-Picture")):(this.setIcon("picture-in-picture-enter"),this.controlText("Picture-in-Picture")),this.handlePictureInPictureEnabledChange()}handleClick(e){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()}show(){typeof Ee().exitPictureInPicture=="function"&&super.show()}}xd.prototype.controlText_="Picture-in-Picture",it.registerComponent("PictureInPictureToggle",xd);class yu extends Oi{constructor(e,i){super(e,i);this.setIcon("fullscreen-enter"),this.on(e,"fullscreenchange",r=>this.handleFullscreenChange(r)),Ee()[e.fsApi_.fullscreenEnabled]===!1&&this.disable()}buildCSSClass(){return`vjs-fullscreen-control ${super.buildCSSClass()}`}handleFullscreenChange(e){this.player_.isFullscreen()?(this.controlText("Exit Fullscreen"),this.setIcon("fullscreen-exit")):(this.controlText("Fullscreen"),this.setIcon("fullscreen-enter"))}handleClick(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()}}yu.prototype.controlText_="Fullscreen",it.registerComponent("FullscreenToggle",yu);const Hc=function(s,e){e.tech_&&!e.tech_.featuresVolumeControl&&s.addClass("vjs-hidden"),s.on(e,"loadstart",function(){e.tech_.featuresVolumeControl?s.removeClass("vjs-hidden"):s.addClass("vjs-hidden")})};class qc extends it{createEl(){const e=super.createEl("div",{className:"vjs-volume-level"});return this.setIcon("circle",e),e.appendChild(super.createEl("span",{className:"vjs-control-text"})),e}}it.registerComponent("VolumeLevel",qc);class Kc extends it{constructor(e,i){super(e,i);this.update=Vr(Ci(this,this.update),nr)}createEl(){return super.createEl("div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})}update(e,i,r,l){if(!r){const d=k(this.el_),f=k(this.player_.el()),y=e.width*i;if(!f||!d)return;const L=e.left-f.left+y,B=e.width-y+(f.right-e.right);let W=d.width/2;L<W?W+=W-L:B<W&&(W=B),W<0?W=0:W>d.width&&(W=d.width),this.el_.style.right=`-${W}px`}this.write(`${l}%`)}write(e){jr(this.el_,e)}updateVolume(e,i,r,l,d){this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",()=>{this.update(e,i,r,l.toFixed(0)),d&&d()})}}it.registerComponent("VolumeLevelTooltip",Kc);class Ed extends it{constructor(e,i){super(e,i);this.update=Vr(Ci(this,this.update),nr)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(e,i,r){const l=100*i;this.getChild("volumeLevelTooltip").updateVolume(e,i,r,l,()=>{r?this.el_.style.bottom=`${e.height*i}px`:this.el_.style.left=`${e.width*i}px`})}}Ed.prototype.options_={children:["volumeLevelTooltip"]},it.registerComponent("MouseVolumeLevelDisplay",Ed);class so extends hu{constructor(e,i){super(e,i);this.on("slideractive",r=>this.updateLastVolume_(r)),this.on(e,"volumechange",r=>this.updateARIAAttributes(r)),e.ready(()=>this.updateARIAAttributes())}createEl(){return super.createEl("div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})}handleMouseDown(e){!Ve(e)||super.handleMouseDown(e)}handleMouseMove(e){const i=this.getChild("mouseVolumeLevelDisplay");if(i){const r=this.el(),l=k(r),d=this.vertical();let f=x(r,e);f=d?f.y:f.x,f=ro(f,0,1),i.update(l,f,d)}!Ve(e)||(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))}checkMuted(){this.player_.muted()&&this.player_.muted(!1)}getPercent(){return this.player_.muted()?0:this.player_.volume()}stepForward(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)}stepBack(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)}updateARIAAttributes(e){const i=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",i),this.el_.setAttribute("aria-valuetext",i+"%")}volumeAsPercentage_(){return Math.round(this.player_.volume()*100)}updateLastVolume_(){const e=this.player_.volume();this.one("sliderinactive",()=>{this.player_.volume()===0&&this.player_.lastVolume_(e)})}}so.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},!bn&&!cn&&so.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay"),so.prototype.playerEvent="volumechange",it.registerComponent("VolumeBar",so);class fl extends it{constructor(e,i={}){i.vertical=i.vertical||!1,(typeof i.volumeBar=="undefined"||gr(i.volumeBar))&&(i.volumeBar=i.volumeBar||{},i.volumeBar.vertical=i.vertical),super(e,i),Hc(this,e),this.throttledHandleMouseMove=Vr(Ci(this,this.handleMouseMove),nr),this.handleMouseUpHandler_=r=>this.handleMouseUp(r),this.on("mousedown",r=>this.handleMouseDown(r)),this.on("touchstart",r=>this.handleMouseDown(r)),this.on("mousemove",r=>this.handleMouseMove(r)),this.on(this.volumeBar,["focus","slideractive"],()=>{this.volumeBar.addClass("vjs-slider-active"),this.addClass("vjs-slider-active"),this.trigger("slideractive")}),this.on(this.volumeBar,["blur","sliderinactive"],()=>{this.volumeBar.removeClass("vjs-slider-active"),this.removeClass("vjs-slider-active"),this.trigger("sliderinactive")})}createEl(){let e="vjs-volume-horizontal";return this.options_.vertical&&(e="vjs-volume-vertical"),super.createEl("div",{className:`vjs-volume-control vjs-control ${e}`})}handleMouseDown(e){const i=this.el_.ownerDocument;this.on(i,"mousemove",this.throttledHandleMouseMove),this.on(i,"touchmove",this.throttledHandleMouseMove),this.on(i,"mouseup",this.handleMouseUpHandler_),this.on(i,"touchend",this.handleMouseUpHandler_)}handleMouseUp(e){const i=this.el_.ownerDocument;this.off(i,"mousemove",this.throttledHandleMouseMove),this.off(i,"touchmove",this.throttledHandleMouseMove),this.off(i,"mouseup",this.handleMouseUpHandler_),this.off(i,"touchend",this.handleMouseUpHandler_)}handleMouseMove(e){this.volumeBar.handleMouseMove(e)}}fl.prototype.options_={children:["volumeBar"]},it.registerComponent("VolumeControl",fl);const vu=function(s,e){e.tech_&&!e.tech_.featuresMuteControl&&s.addClass("vjs-hidden"),s.on(e,"loadstart",function(){e.tech_.featuresMuteControl?s.removeClass("vjs-hidden"):s.addClass("vjs-hidden")})};class pl extends Oi{constructor(e,i){super(e,i);vu(this,e),this.on(e,["loadstart","volumechange"],r=>this.update(r))}buildCSSClass(){return`vjs-mute-control ${super.buildCSSClass()}`}handleClick(e){const i=this.player_.volume(),r=this.player_.lastVolume_();if(i===0){const l=r<.1?.1:r;this.player_.volume(l),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())}update(e){this.updateIcon_(),this.updateControlText_()}updateIcon_(){const e=this.player_.volume();let i=3;this.setIcon("volume-high"),bn&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),e===0||this.player_.muted()?(this.setIcon("volume-mute"),i=0):e<.33?(this.setIcon("volume-low"),i=1):e<.67&&(this.setIcon("volume-medium"),i=2),va(this.el_,[0,1,2,3].reduce((r,l)=>r+`${l?" ":""}vjs-vol-${l}`,"")),$r(this.el_,`vjs-vol-${i}`)}updateControlText_(){const i=this.player_.muted()||this.player_.volume()===0?"Unmute":"Mute";this.controlText()!==i&&this.controlText(i)}}pl.prototype.controlText_="Mute",it.registerComponent("MuteToggle",pl);class Au extends it{constructor(e,i={}){typeof i.inline!="undefined"?i.inline=i.inline:i.inline=!0,(typeof i.volumeControl=="undefined"||gr(i.volumeControl))&&(i.volumeControl=i.volumeControl||{},i.volumeControl.vertical=!i.inline),super(e,i),this.handleKeyPressHandler_=r=>this.handleKeyPress(r),this.on(e,["loadstart"],r=>this.volumePanelState_(r)),this.on(this.muteToggle,"keyup",r=>this.handleKeyPress(r)),this.on(this.volumeControl,"keyup",r=>this.handleVolumeControlKeyUp(r)),this.on("keydown",r=>this.handleKeyPress(r)),this.on("mouseover",r=>this.handleMouseOver(r)),this.on("mouseout",r=>this.handleMouseOut(r)),this.on(this.volumeControl,["slideractive"],this.sliderActive_),this.on(this.volumeControl,["sliderinactive"],this.sliderInactive_)}sliderActive_(){this.addClass("vjs-slider-active")}sliderInactive_(){this.removeClass("vjs-slider-active")}volumePanelState_(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")}createEl(){let e="vjs-volume-panel-horizontal";return this.options_.inline||(e="vjs-volume-panel-vertical"),super.createEl("div",{className:`vjs-volume-panel vjs-control ${e}`})}dispose(){this.handleMouseOut(),super.dispose()}handleVolumeControlKeyUp(e){me().isEventKey(e,"Esc")&&this.muteToggle.focus()}handleMouseOver(e){this.addClass("vjs-hover"),qn(Ee(),"keyup",this.handleKeyPressHandler_)}handleMouseOut(e){this.removeClass("vjs-hover"),_n(Ee(),"keyup",this.handleKeyPressHandler_)}handleKeyPress(e){me().isEventKey(e,"Esc")&&this.handleMouseOut()}}Au.prototype.options_={children:["muteToggle","volumeControl"]},it.registerComponent("VolumePanel",Au);class Td extends Oi{constructor(e,i){super(e,i);this.validOptions=[5,10,30],this.skipTime=this.getSkipForwardTime(),this.skipTime&&this.validOptions.includes(this.skipTime)?(this.setIcon(`forward-${this.skipTime}`),this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime])),this.show()):this.hide()}getSkipForwardTime(){const e=this.options_.playerOptions;return e.controlBar&&e.controlBar.skipButtons&&e.controlBar.skipButtons.forward}buildCSSClass(){return`vjs-skip-forward-${this.getSkipForwardTime()} ${super.buildCSSClass()}`}handleClick(e){if(isNaN(this.player_.duration()))return;const i=this.player_.currentTime(),r=this.player_.liveTracker,l=r&&r.isLive()?r.seekableEnd():this.player_.duration();let d;i+this.skipTime<=l?d=i+this.skipTime:d=l,this.player_.currentTime(d)}handleLanguagechange(){this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime]))}}Td.prototype.controlText_="Skip Forward",it.registerComponent("SkipForward",Td);class Sd extends Oi{constructor(e,i){super(e,i);this.validOptions=[5,10,30],this.skipTime=this.getSkipBackwardTime(),this.skipTime&&this.validOptions.includes(this.skipTime)?(this.setIcon(`replay-${this.skipTime}`),this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime])),this.show()):this.hide()}getSkipBackwardTime(){const e=this.options_.playerOptions;return e.controlBar&&e.controlBar.skipButtons&&e.controlBar.skipButtons.backward}buildCSSClass(){return`vjs-skip-backward-${this.getSkipBackwardTime()} ${super.buildCSSClass()}`}handleClick(e){const i=this.player_.currentTime(),r=this.player_.liveTracker,l=r&&r.isLive()&&r.seekableStart();let d;l&&i-this.skipTime<=l?d=l:i>=this.skipTime?d=i-this.skipTime:d=0,this.player_.currentTime(d)}handleLanguagechange(){this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime]))}}Sd.prototype.controlText_="Skip Backward",it.registerComponent("SkipBackward",Sd);class Cd extends it{constructor(e,i){super(e,i);i&&(this.menuButton_=i.menuButton),this.focusedChild_=-1,this.on("keydown",r=>this.handleKeyDown(r)),this.boundHandleBlur_=r=>this.handleBlur(r),this.boundHandleTapClick_=r=>this.handleTapClick(r)}addEventListenerForItem(e){e instanceof it&&(this.on(e,"blur",this.boundHandleBlur_),this.on(e,["tap","click"],this.boundHandleTapClick_))}removeEventListenerForItem(e){e instanceof it&&(this.off(e,"blur",this.boundHandleBlur_),this.off(e,["tap","click"],this.boundHandleTapClick_))}removeChild(e){typeof e=="string"&&(e=this.getChild(e)),this.removeEventListenerForItem(e),super.removeChild(e)}addItem(e){const i=this.addChild(e);i&&this.addEventListenerForItem(i)}createEl(){const e=this.options_.contentElType||"ul";this.contentEl_=ri(e,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");const i=super.createEl("div",{append:this.contentEl_,className:"vjs-menu"});return i.appendChild(this.contentEl_),qn(i,"click",function(r){r.preventDefault(),r.stopImmediatePropagation()}),i}dispose(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,super.dispose()}handleBlur(e){const i=e.relatedTarget||Ee().activeElement;if(!this.children().some(r=>r.el()===i)){const r=this.menuButton_;r&&r.buttonPressed_&&i!==r.el().firstChild&&r.unpressButton()}}handleTapClick(e){if(this.menuButton_){this.menuButton_.unpressButton();const i=this.children();if(!Array.isArray(i))return;const r=i.filter(l=>l.el()===e.target)[0];if(!r)return;r.name()!=="CaptionSettingsMenuItem"&&this.menuButton_.focus()}}handleKeyDown(e){me().isEventKey(e,"Left")||me().isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(me().isEventKey(e,"Right")||me().isEventKey(e,"Up"))&&(e.preventDefault(),e.stopPropagation(),this.stepBack())}stepForward(){let e=0;this.focusedChild_!==void 0&&(e=this.focusedChild_+1),this.focus(e)}stepBack(){let e=0;this.focusedChild_!==void 0&&(e=this.focusedChild_-1),this.focus(e)}focus(e=0){const i=this.children().slice();i.length&&i[0].hasClass("vjs-menu-title")&&i.shift(),i.length>0&&(e<0?e=0:e>=i.length&&(e=i.length-1),this.focusedChild_=e,i[e].el_.focus())}}it.registerComponent("Menu",Cd);class bu extends it{constructor(e,i={}){super(e,i);this.menuButton_=new Oi(e,i),this.menuButton_.controlText(this.controlText_),this.menuButton_.el_.setAttribute("aria-haspopup","true");const r=Oi.prototype.buildCSSClass();this.menuButton_.el_.className=this.buildCSSClass()+" "+r,this.menuButton_.removeClass("vjs-control"),this.addChild(this.menuButton_),this.update(),this.enabled_=!0;const l=d=>this.handleClick(d);this.handleMenuKeyUp_=d=>this.handleMenuKeyUp(d),this.on(this.menuButton_,"tap",l),this.on(this.menuButton_,"click",l),this.on(this.menuButton_,"keydown",d=>this.handleKeyDown(d)),this.on(this.menuButton_,"mouseenter",()=>{this.addClass("vjs-hover"),this.menu.show(),qn(Ee(),"keyup",this.handleMenuKeyUp_)}),this.on("mouseleave",d=>this.handleMouseLeave(d)),this.on("keydown",d=>this.handleSubmenuKeyDown(d))}update(){const e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?(this.hide(),this.menu.contentEl_.removeAttribute("role")):(this.show(),this.menu.contentEl_.setAttribute("role","menu"))}createMenu(){const e=new Cd(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){const i=ri("li",{className:"vjs-menu-title",textContent:Ji(this.options_.title),tabIndex:-1}),r=new it(this.player_,{el:i});e.addItem(r)}if(this.items=this.createItems(),this.items)for(let i=0;i<this.items.length;i++)e.addItem(this.items[i]);return e}createItems(){}createEl(){return super.createEl("div",{className:this.buildWrapperCSSClass()},{})}setIcon(e){super.setIcon(e,this.menuButton_.el_)}buildWrapperCSSClass(){let e="vjs-menu-button";this.options_.inline===!0?e+="-inline":e+="-popup";const i=Oi.prototype.buildCSSClass();return`vjs-menu-button ${e} ${i} ${super.buildCSSClass()}`}buildCSSClass(){let e="vjs-menu-button";return this.options_.inline===!0?e+="-inline":e+="-popup",`vjs-menu-button ${e} ${super.buildCSSClass()}`}controlText(e,i=this.menuButton_.el()){return this.menuButton_.controlText(e,i)}dispose(){this.handleMouseLeave(),super.dispose()}handleClick(e){this.buttonPressed_?this.unpressButton():this.pressButton()}handleMouseLeave(e){this.removeClass("vjs-hover"),_n(Ee(),"keyup",this.handleMenuKeyUp_)}focus(){this.menuButton_.focus()}blur(){this.menuButton_.blur()}handleKeyDown(e){me().isEventKey(e,"Esc")||me().isEventKey(e,"Tab")?(this.buttonPressed_&&this.unpressButton(),me().isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus())):(me().isEventKey(e,"Up")||me().isEventKey(e,"Down"))&&(this.buttonPressed_||(e.preventDefault(),this.pressButton()))}handleMenuKeyUp(e){(me().isEventKey(e,"Esc")||me().isEventKey(e,"Tab"))&&this.removeClass("vjs-hover")}handleSubmenuKeyPress(e){this.handleSubmenuKeyDown(e)}handleSubmenuKeyDown(e){(me().isEventKey(e,"Esc")||me().isEventKey(e,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),me().isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus()))}pressButton(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),bn&&No())return;this.menu.focus()}}unpressButton(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))}disable(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()}enable(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()}}it.registerComponent("MenuButton",bu);class _u extends bu{constructor(e,i){const r=i.tracks;super(e,i);if(this.items.length<=1&&this.hide(),!r)return;const l=Ci(this,this.update);r.addEventListener("removetrack",l),r.addEventListener("addtrack",l),r.addEventListener("labelchange",l),this.player_.on("ready",l),this.player_.on("dispose",function(){r.removeEventListener("removetrack",l),r.removeEventListener("addtrack",l),r.removeEventListener("labelchange",l)})}}it.registerComponent("TrackButton",_u);const Wc=["Tab","Esc","Up","Down","Right","Left"];class ao extends ll{constructor(e,i){super(e,i);this.selectable=i.selectable,this.isSelected_=i.selected||!1,this.multiSelectable=i.multiSelectable,this.selected(this.isSelected_),this.selectable?this.multiSelectable?this.el_.setAttribute("role","menuitemcheckbox"):this.el_.setAttribute("role","menuitemradio"):this.el_.setAttribute("role","menuitem")}createEl(e,i,r){this.nonIconControl=!0;const l=super.createEl("li",Object.assign({className:"vjs-menu-item",tabIndex:-1},i),r),d=ri("span",{className:"vjs-menu-item-text",textContent:this.localize(this.options_.label)});return this.player_.options_.experimentalSvgIcons?l.appendChild(d):l.replaceChild(d,l.querySelector(".vjs-icon-placeholder")),l}handleKeyDown(e){Wc.some(i=>me().isEventKey(e,i))||super.handleKeyDown(e)}handleClick(e){this.selected(!0)}selected(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))}}it.registerComponent("MenuItem",ao);class Cs extends ao{constructor(e,i){const r=i.track,l=e.textTracks();i.label=r.label||r.language||"Unknown",i.selected=r.mode==="showing",super(e,i),this.track=r,this.kinds=(i.kinds||[i.kind||this.track.kind]).filter(Boolean);const d=(...y)=>{this.handleTracksChange.apply(this,y)},f=(...y)=>{this.handleSelectedLanguageChange.apply(this,y)};if(e.on(["loadstart","texttrackchange"],d),l.addEventListener("change",d),l.addEventListener("selectedlanguagechange",f),this.on("dispose",function(){e.off(["loadstart","texttrackchange"],d),l.removeEventListener("change",d),l.removeEventListener("selectedlanguagechange",f)}),l.onchange===void 0){let y;this.on(["tap","click"],function(){if(typeof le().Event!="object")try{y=new(le()).Event("change")}catch(L){}y||(y=Ee().createEvent("Event"),y.initEvent("change",!0,!0)),l.dispatchEvent(y)})}this.handleTracksChange()}handleClick(e){const i=this.track,r=this.player_.textTracks();if(super.handleClick(e),!!r)for(let l=0;l<r.length;l++){const d=r[l];this.kinds.indexOf(d.kind)!==-1&&(d===i?d.mode!=="showing"&&(d.mode="showing"):d.mode!=="disabled"&&(d.mode="disabled"))}}handleTracksChange(e){const i=this.track.mode==="showing";i!==this.isSelected_&&this.selected(i)}handleSelectedLanguageChange(e){if(this.track.mode==="showing"){const i=this.player_.cache_.selectedLanguage;if(i&&i.enabled&&i.language===this.track.language&&i.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}}dispose(){this.track=null,super.dispose()}}it.registerComponent("TextTrackMenuItem",Cs);class wd extends Cs{constructor(e,i){i.track={player:e,kind:i.kind,kinds:i.kinds,default:!1,mode:"disabled"},i.kinds||(i.kinds=[i.kind]),i.label?i.track.label=i.label:i.track.label=i.kinds.join(" and ")+" off",i.selectable=!0,i.multiSelectable=!1,super(e,i)}handleTracksChange(e){const i=this.player().textTracks();let r=!0;for(let l=0,d=i.length;l<d;l++){const f=i[l];if(this.options_.kinds.indexOf(f.kind)>-1&&f.mode==="showing"){r=!1;break}}r!==this.isSelected_&&this.selected(r)}handleSelectedLanguageChange(e){const i=this.player().textTracks();let r=!0;for(let l=0,d=i.length;l<d;l++){const f=i[l];if(["captions","descriptions","subtitles"].indexOf(f.kind)>-1&&f.mode==="showing"){r=!1;break}}r&&(this.player_.cache_.selectedLanguage={enabled:!1})}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.label),super.handleLanguagechange()}}it.registerComponent("OffTextTrackMenuItem",wd);class rs extends _u{constructor(e,i={}){i.tracks=e.textTracks(),super(e,i)}createItems(e=[],i=Cs){let r;this.label_&&(r=`${this.label_} off`),e.push(new wd(this.player_,{kinds:this.kinds_,kind:this.kind_,label:r})),this.hideThreshold_+=1;const l=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(let d=0;d<l.length;d++){const f=l[d];if(this.kinds_.indexOf(f.kind)>-1){const y=new i(this.player_,{track:f,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});y.addClass(`vjs-${f.kind}-menu-item`),e.push(y)}}return e}}it.registerComponent("TextTrackButton",rs);class Ld extends ao{constructor(e,i){const r=i.track,l=i.cue,d=e.currentTime();i.selectable=!0,i.multiSelectable=!1,i.label=l.text,i.selected=l.startTime<=d&&d<l.endTime,super(e,i),this.track=r,this.cue=l}handleClick(e){super.handleClick(),this.player_.currentTime(this.cue.startTime)}}it.registerComponent("ChaptersTrackMenuItem",Ld);class xu extends rs{constructor(e,i,r){super(e,i,r);this.setIcon("chapters"),this.selectCurrentItem_=()=>{this.items.forEach(l=>{l.selected(this.track_.activeCues[0]===l.cue)})}}buildCSSClass(){return`vjs-chapters-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-chapters-button ${super.buildWrapperCSSClass()}`}update(e){if(e&&e.track&&e.track.kind!=="chapters")return;const i=this.findChaptersTrack();i!==this.track_?(this.setTrack(i),super.update()):(!this.items||i&&i.cues&&i.cues.length!==this.items.length)&&super.update()}setTrack(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){const i=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);i&&i.removeEventListener("load",this.updateHandler_),this.track_.removeEventListener("cuechange",this.selectCurrentItem_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";const i=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);i&&i.addEventListener("load",this.updateHandler_),this.track_.addEventListener("cuechange",this.selectCurrentItem_)}}}findChaptersTrack(){const e=this.player_.textTracks()||[];for(let i=e.length-1;i>=0;i--){const r=e[i];if(r.kind===this.kind_)return r}}getMenuCaption(){return this.track_&&this.track_.label?this.track_.label:this.localize(Ji(this.kind_))}createMenu(){return this.options_.title=this.getMenuCaption(),super.createMenu()}createItems(){const e=[];if(!this.track_)return e;const i=this.track_.cues;if(!i)return e;for(let r=0,l=i.length;r<l;r++){const d=i[r],f=new Ld(this.player_,{track:this.track_,cue:d});e.push(f)}return e}}xu.prototype.kind_="chapters",xu.prototype.controlText_="Chapters",it.registerComponent("ChaptersButton",xu);class ml extends rs{constructor(e,i,r){super(e,i,r);this.setIcon("audio-description");const l=e.textTracks(),d=Ci(this,this.handleTracksChange);l.addEventListener("change",d),this.on("dispose",function(){l.removeEventListener("change",d)})}handleTracksChange(e){const i=this.player().textTracks();let r=!1;for(let l=0,d=i.length;l<d;l++){const f=i[l];if(f.kind!==this.kind_&&f.mode==="showing"){r=!0;break}}r?this.disable():this.enable()}buildCSSClass(){return`vjs-descriptions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-descriptions-button ${super.buildWrapperCSSClass()}`}}ml.prototype.kind_="descriptions",ml.prototype.controlText_="Descriptions",it.registerComponent("DescriptionsButton",ml);class Eu extends rs{constructor(e,i,r){super(e,i,r);this.setIcon("subtitles")}buildCSSClass(){return`vjs-subtitles-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subtitles-button ${super.buildWrapperCSSClass()}`}}Eu.prototype.kind_="subtitles",Eu.prototype.controlText_="Subtitles",it.registerComponent("SubtitlesButton",Eu);class Tu extends Cs{constructor(e,i){i.track={player:e,kind:i.kind,label:i.kind+" settings",selectable:!1,default:!1,mode:"disabled"},i.selectable=!1,i.name="CaptionSettingsMenuItem",super(e,i),this.addClass("vjs-texttrack-settings"),this.controlText(", opens "+i.kind+" settings dialog")}handleClick(e){this.player().getChild("textTrackSettings").open()}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.kind+" settings"),super.handleLanguagechange()}}it.registerComponent("CaptionSettingsMenuItem",Tu);class Su extends rs{constructor(e,i,r){super(e,i,r);this.setIcon("captions")}buildCSSClass(){return`vjs-captions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-captions-button ${super.buildWrapperCSSClass()}`}createItems(){const e=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(e.push(new Tu(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),super.createItems(e)}}Su.prototype.kind_="captions",Su.prototype.controlText_="Captions",it.registerComponent("CaptionsButton",Su);class Dd extends Cs{createEl(e,i,r){const l=super.createEl(e,i,r),d=l.querySelector(".vjs-menu-item-text");return this.options_.track.kind==="captions"&&(this.player_.options_.experimentalSvgIcons?this.setIcon("captions",l):d.appendChild(ri("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),d.appendChild(ri("span",{className:"vjs-control-text",textContent:` ${this.localize("Captions")}`}))),l}}it.registerComponent("SubsCapsMenuItem",Dd);class gl extends rs{constructor(e,i={}){super(e,i);this.label_="subtitles",this.setIcon("subtitles"),["en","en-us","en-ca","fr-ca"].indexOf(this.player_.language_)>-1&&(this.label_="captions",this.setIcon("captions")),this.menuButton_.controlText(Ji(this.label_))}buildCSSClass(){return`vjs-subs-caps-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subs-caps-button ${super.buildWrapperCSSClass()}`}createItems(){let e=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(e.push(new Tu(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e=super.createItems(e,Dd),e}}gl.prototype.kinds_=["captions","subtitles"],gl.prototype.controlText_="Subtitles",it.registerComponent("SubsCapsButton",gl);class kd extends ao{constructor(e,i){const r=i.track,l=e.audioTracks();i.label=r.label||r.language||"Unknown",i.selected=r.enabled,super(e,i),this.track=r,this.addClass(`vjs-${r.kind}-menu-item`);const d=(...f)=>{this.handleTracksChange.apply(this,f)};l.addEventListener("change",d),this.on("dispose",()=>{l.removeEventListener("change",d)})}createEl(e,i,r){const l=super.createEl(e,i,r),d=l.querySelector(".vjs-menu-item-text");return["main-desc","description"].indexOf(this.options_.track.kind)>=0&&(d.appendChild(ri("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),d.appendChild(ri("span",{className:"vjs-control-text",textContent:" "+this.localize("Descriptions")}))),l}handleClick(e){if(super.handleClick(e),this.track.enabled=!0,this.player_.tech_.featuresNativeAudioTracks){const i=this.player_.audioTracks();for(let r=0;r<i.length;r++){const l=i[r];l!==this.track&&(l.enabled=l===this.track)}}}handleTracksChange(e){this.selected(this.track.enabled)}}it.registerComponent("AudioTrackMenuItem",kd);class Id extends _u{constructor(e,i={}){i.tracks=e.audioTracks(),super(e,i),this.setIcon("audio")}buildCSSClass(){return`vjs-audio-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-audio-button ${super.buildWrapperCSSClass()}`}createItems(e=[]){this.hideThreshold_=1;const i=this.player_.audioTracks();for(let r=0;r<i.length;r++){const l=i[r];e.push(new kd(this.player_,{track:l,selectable:!0,multiSelectable:!1}))}return e}}Id.prototype.controlText_="Audio Track",it.registerComponent("AudioTrackButton",Id);class Cu extends ao{constructor(e,i){const r=i.rate,l=parseFloat(r,10);i.label=r,i.selected=l===e.playbackRate(),i.selectable=!0,i.multiSelectable=!1,super(e,i),this.label=r,this.rate=l,this.on(e,"ratechange",d=>this.update(d))}handleClick(e){super.handleClick(),this.player().playbackRate(this.rate)}update(e){this.selected(this.player().playbackRate()===this.rate)}}Cu.prototype.contentElType="button",it.registerComponent("PlaybackRateMenuItem",Cu);class Rd extends bu{constructor(e,i){super(e,i);this.menuButton_.el_.setAttribute("aria-describedby",this.labelElId_),this.updateVisibility(),this.updateLabel(),this.on(e,"loadstart",r=>this.updateVisibility(r)),this.on(e,"ratechange",r=>this.updateLabel(r)),this.on(e,"playbackrateschange",r=>this.handlePlaybackRateschange(r))}createEl(){const e=super.createEl();return this.labelElId_="vjs-playback-rate-value-label-"+this.id_,this.labelEl_=ri("div",{className:"vjs-playback-rate-value",id:this.labelElId_,textContent:"1x"}),e.appendChild(this.labelEl_),e}dispose(){this.labelEl_=null,super.dispose()}buildCSSClass(){return`vjs-playback-rate ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-playback-rate ${super.buildWrapperCSSClass()}`}createItems(){const e=this.playbackRates(),i=[];for(let r=e.length-1;r>=0;r--)i.push(new Cu(this.player(),{rate:e[r]+"x"}));return i}handlePlaybackRateschange(e){this.update()}playbackRates(){const e=this.player();return e.playbackRates&&e.playbackRates()||[]}playbackRateSupported(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0}updateVisibility(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")}updateLabel(e){this.playbackRateSupported()&&(this.labelEl_.textContent=this.player().playbackRate()+"x")}}Rd.prototype.controlText_="Playback Rate",it.registerComponent("PlaybackRateMenuButton",Rd);class wu extends it{buildCSSClass(){return`vjs-spacer ${super.buildCSSClass()}`}createEl(e="div",i={},r={}){return i.className||(i.className=this.buildCSSClass()),super.createEl(e,i,r)}}it.registerComponent("Spacer",wu);class Pd extends wu{buildCSSClass(){return`vjs-custom-control-spacer ${super.buildCSSClass()}`}createEl(){return super.createEl("div",{className:this.buildCSSClass(),textContent:"\xA0"})}}it.registerComponent("CustomControlSpacer",Pd);class Od extends it{createEl(){return super.createEl("div",{className:"vjs-control-bar",dir:"ltr"})}}Od.prototype.options_={children:["playToggle","skipBackward","skipForward","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","pictureInPictureToggle","fullscreenToggle"]},it.registerComponent("ControlBar",Od);class Lu extends Ta{constructor(e,i){super(e,i);this.on(e,"error",r=>{this.close(),this.open(r)})}buildCSSClass(){return`vjs-error-display ${super.buildCSSClass()}`}content(){const e=this.player().error();return e?this.localize(e.message):""}}Lu.prototype.options_=Object.assign({},Ta.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),it.registerComponent("ErrorDisplay",Lu);const Du="vjs-text-track-settings",Bd=["#000","Black"],ku=["#00F","Blue"],Md=["#0FF","Cyan"],Fd=["#0F0","Green"],Nd=["#F0F","Magenta"],Ud=["#F00","Red"],jd=["#FFF","White"],$d=["#FF0","Yellow"],Iu=["1","Opaque"],Ru=["0.5","Semi-Transparent"],Pu=["0","Transparent"],Zs={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[Bd,jd,Ud,Fd,ku,$d,Nd,Md]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Opacity",options:[Iu,Ru,Pu]},color:{selector:".vjs-text-color > select",id:"captions-foreground-color-%s",label:"Color",options:[jd,Bd,Ud,Fd,ku,$d,Nd,Md]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Drop shadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:s=>s==="1.00"?null:Number(s)},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Opacity",options:[Iu,Ru]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Opacity",options:[Pu,Ru,Iu]}};Zs.windowColor.options=Zs.backgroundColor.options;function Vd(s,e){if(e&&(s=e(s)),s&&s!=="none")return s}function Ou(s,e){const i=s.options[s.options.selectedIndex].value;return Vd(i,e)}function zc(s,e,i){if(!!e){for(let r=0;r<s.options.length;r++)if(Vd(s.options[r].value,i)===e){s.selectedIndex=r;break}}}class Bu extends Ta{constructor(e,i){i.temporary=!1,super(e,i),this.updateDisplay=this.updateDisplay.bind(this),this.fill(),this.hasBeenOpened_=this.hasBeenFilled_=!0,this.endDialog=ri("p",{className:"vjs-control-text",textContent:this.localize("End of dialog window.")}),this.el().appendChild(this.endDialog),this.setDefaults(),i.persistTextTrackSettings===void 0&&(this.options_.persistTextTrackSettings=this.options_.playerOptions.persistTextTrackSettings),this.on(this.$(".vjs-done-button"),"click",()=>{this.saveSettings(),this.close()}),this.on(this.$(".vjs-default-button"),"click",()=>{this.setDefaults(),this.updateDisplay()}),As(Zs,r=>{this.on(this.$(r.selector),"change",this.updateDisplay)}),this.options_.persistTextTrackSettings&&this.restoreSettings()}dispose(){this.endDialog=null,super.dispose()}createElSelect_(e,i="",r="label"){const l=Zs[e],d=l.id.replace("%s",this.id_),f=[i,d].join(" ").trim(),y=`vjs_select_${xi()}`;return[`<${r} id="${d}"${r==="label"?` for="${y}" class="vjs-label"`:""}>`,this.localize(l.label),`</${r}>`,`<select aria-labelledby="${f}" id="${y}">`].concat(l.options.map(L=>{const B=d+"-"+L[1].replace(/\W+/g,"");return[`<option id="${B}" value="${L[0]}" `,`aria-labelledby="${f} ${B}">`,this.localize(L[1]),"</option>"].join("")})).concat("</select>").join("")}createElFgColor_(){const e=`captions-text-legend-${this.id_}`;return['<fieldset class="vjs-fg vjs-track-setting">',`<legend id="${e}">`,this.localize("Text"),"</legend>",'<span class="vjs-text-color">',this.createElSelect_("color",e),"</span>",'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")}createElBgColor_(){const e=`captions-background-${this.id_}`;return['<fieldset class="vjs-bg vjs-track-setting">',`<legend id="${e}">`,this.localize("Text Background"),"</legend>",'<span class="vjs-bg-color">',this.createElSelect_("backgroundColor",e),"</span>",'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")}createElWinColor_(){const e=`captions-window-${this.id_}`;return['<fieldset class="vjs-window vjs-track-setting">',`<legend id="${e}">`,this.localize("Caption Area Background"),"</legend>",'<span class="vjs-window-color">',this.createElSelect_("windowColor",e),"</span>",'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")}createElColors_(){return ri("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})}createElFont_(){return ri("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})}createElControls_(){const e=this.localize("restore all settings to the default values");return ri("div",{className:"vjs-track-settings-controls",innerHTML:[`<button type="button" class="vjs-default-button" title="${e}">`,this.localize("Reset"),`<span class="vjs-control-text"> ${e}</span>`,"</button>",`<button type="button" class="vjs-done-button">${this.localize("Done")}</button>`].join("")})}content(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]}label(){return this.localize("Caption Settings Dialog")}description(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")}buildCSSClass(){return super.buildCSSClass()+" vjs-text-track-settings"}getValues(){return Ui(Zs,(e,i,r)=>{const l=Ou(this.$(i.selector),i.parser);return l!==void 0&&(e[r]=l),e},{})}setValues(e){As(Zs,(i,r)=>{zc(this.$(i.selector),e[r],i.parser)})}setDefaults(){As(Zs,e=>{const i=e.hasOwnProperty("default")?e.default:0;this.$(e.selector).selectedIndex=i})}restoreSettings(){let e;try{e=JSON.parse(le().localStorage.getItem(Du))}catch(i){ni.warn(i)}e&&this.setValues(e)}saveSettings(){if(!this.options_.persistTextTrackSettings)return;const e=this.getValues();try{Object.keys(e).length?le().localStorage.setItem(Du,JSON.stringify(e)):le().localStorage.removeItem(Du)}catch(i){ni.warn(i)}}updateDisplay(){const e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()}conditionalBlur_(){this.previouslyActiveEl_=null;const e=this.player_.controlBar,i=e&&e.subsCapsButton,r=e&&e.captionsButton;i?i.focus():r&&r.focus()}handleLanguagechange(){this.fill()}}it.registerComponent("TextTrackSettings",Bu);class Yc extends it{constructor(e,i){let r=i.ResizeObserver||le().ResizeObserver;i.ResizeObserver===null&&(r=!1);const l=ci({createEl:!r,reportTouchActivity:!1},i);super(e,l);this.ResizeObserver=i.ResizeObserver||le().ResizeObserver,this.loadListener_=null,this.resizeObserver_=null,this.debouncedHandler_=ad(()=>{this.resizeHandler()},100,!1,this),r?(this.resizeObserver_=new this.ResizeObserver(this.debouncedHandler_),this.resizeObserver_.observe(e.el())):(this.loadListener_=()=>{if(!this.el_||!this.el_.contentWindow)return;const d=this.debouncedHandler_;let f=this.unloadListener_=function(){_n(this,"resize",d),_n(this,"unload",f),f=null};qn(this.el_.contentWindow,"unload",f),qn(this.el_.contentWindow,"resize",d)},this.one("load",this.loadListener_))}createEl(){return super.createEl("iframe",{className:"vjs-resize-manager",tabIndex:-1,title:this.localize("No content")},{"aria-hidden":"true"})}resizeHandler(){!this.player_||!this.player_.trigger||this.player_.trigger("playerresize")}dispose(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,super.dispose()}}it.registerComponent("ResizeManager",Yc);const Gd={trackingThreshold:20,liveTolerance:15};class Xc extends it{constructor(e,i){const r=ci(Gd,i,{createEl:!1});super(e,r);this.trackLiveHandler_=()=>this.trackLive_(),this.handlePlay_=l=>this.handlePlay(l),this.handleFirstTimeupdate_=l=>this.handleFirstTimeupdate(l),this.handleSeeked_=l=>this.handleSeeked(l),this.seekToLiveEdge_=l=>this.seekToLiveEdge(l),this.reset_(),this.on(this.player_,"durationchange",l=>this.handleDurationchange(l)),this.on(this.player_,"canplay",()=>this.toggleTracking())}trackLive_(){const e=this.player_.seekable();if(!e||!e.length)return;const i=Number(le().performance.now().toFixed(4)),r=this.lastTime_===-1?0:(i-this.lastTime_)/1e3;this.lastTime_=i,this.pastSeekEnd_=this.pastSeekEnd()+r;const l=this.liveCurrentTime(),d=this.player_.currentTime();let f=this.player_.paused()||this.seekedBehindLive_||Math.abs(l-d)>this.options_.liveTolerance;(!this.timeupdateSeen_||l===Infinity)&&(f=!1),f!==this.behindLiveEdge_&&(this.behindLiveEdge_=f,this.trigger("liveedgechange"))}handleDurationchange(){this.toggleTracking()}toggleTracking(){this.player_.duration()===Infinity&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())}startTracking(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLiveHandler_,nr),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLiveHandler_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked_):(this.one(this.player_,"play",this.handlePlay_),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)))}handleFirstTimeupdate(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked_)}handleSeeked(){const e=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&e>2,this.nextSeekedFromUser_=!1,this.trackLive_()}handlePlay(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)}reset_(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.nextSeekedFromUser_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLiveHandler_),this.off(this.player_,"seeked",this.handleSeeked_),this.off(this.player_,"play",this.handlePlay_),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_),this.off(this.player_,"timeupdate",this.seekToLiveEdge_)}nextSeekedFromUser(){this.nextSeekedFromUser_=!0}stopTracking(){!this.isTracking()||(this.reset_(),this.trigger("liveedgechange"))}seekableEnd(){const e=this.player_.seekable(),i=[];let r=e?e.length:0;for(;r--;)i.push(e.end(r));return i.length?i.sort()[i.length-1]:Infinity}seekableStart(){const e=this.player_.seekable(),i=[];let r=e?e.length:0;for(;r--;)i.push(e.start(r));return i.length?i.sort()[0]:0}liveWindow(){const e=this.liveCurrentTime();return e===Infinity?0:e-this.seekableStart()}isLive(){return this.isTracking()}atLiveEdge(){return!this.behindLiveEdge()}liveCurrentTime(){return this.pastSeekEnd()+this.seekableEnd()}pastSeekEnd(){const e=this.seekableEnd();return this.lastSeekEnd_!==-1&&e!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=e,this.pastSeekEnd_}behindLiveEdge(){return this.behindLiveEdge_}isTracking(){return typeof this.trackingInterval_=="number"}seekToLiveEdge(){this.seekedBehindLive_=!1,!this.atLiveEdge()&&(this.nextSeekedFromUser_=!1,this.player_.currentTime(this.liveCurrentTime()))}dispose(){this.stopTracking(),super.dispose()}}it.registerComponent("LiveTracker",Xc);class Hd extends it{constructor(e,i){super(e,i);this.on("statechanged",r=>this.updateDom_()),this.updateDom_()}createEl(){return this.els={title:ri("div",{className:"vjs-title-bar-title",id:`vjs-title-bar-title-${xi()}`}),description:ri("div",{className:"vjs-title-bar-description",id:`vjs-title-bar-description-${xi()}`})},ri("div",{className:"vjs-title-bar"},{},Bo(this.els))}updateDom_(){const e=this.player_.tech_,i=e&&e.el_,r={title:"aria-labelledby",description:"aria-describedby"};["title","description"].forEach(l=>{const d=this.state[l],f=this.els[l],y=r[l];F(f),d&&jr(f,d),i&&(i.removeAttribute(y),d&&i.setAttribute(y,f.id))}),this.state.title||this.state.description?this.show():this.hide()}update(e){this.setState(e)}dispose(){const e=this.player_.tech_,i=e&&e.el_;i&&(i.removeAttribute("aria-labelledby"),i.removeAttribute("aria-describedby")),super.dispose(),this.els=null}}it.registerComponent("TitleBar",Hd);const yl=s=>{const e=s.el();if(e.hasAttribute("src"))return s.triggerSourceset(e.src),!0;const i=s.$$("source"),r=[];let l="";if(!i.length)return!1;for(let d=0;d<i.length;d++){const f=i[d].src;f&&r.indexOf(f)===-1&&r.push(f)}return r.length?(r.length===1&&(l=r[0]),s.triggerSourceset(l),!0):!1},Qc=Object.defineProperty({},"innerHTML",{get(){return this.cloneNode(!0).innerHTML},set(s){const e=Ee().createElement(this.nodeName.toLowerCase());e.innerHTML=s;const i=Ee().createDocumentFragment();for(;e.childNodes.length;)i.appendChild(e.childNodes[0]);return this.innerText="",le().Element.prototype.appendChild.call(this,i),this.innerHTML}}),qd=(s,e)=>{let i={};for(let r=0;r<s.length&&(i=Object.getOwnPropertyDescriptor(s[r],e),!(i&&i.set&&i.get));r++);return i.enumerable=!0,i.configurable=!0,i},Jc=s=>qd([s.el(),le().HTMLMediaElement.prototype,le().Element.prototype,Qc],"innerHTML"),oo=function(s){const e=s.el();if(e.resetSourceWatch_)return;const i={},r=Jc(s),l=d=>(...f)=>{const y=d.apply(e,f);return yl(s),y};["append","appendChild","insertAdjacentHTML"].forEach(d=>{!e[d]||(i[d]=e[d],e[d]=l(i[d]))}),Object.defineProperty(e,"innerHTML",ci(r,{set:l(r.set)})),e.resetSourceWatch_=()=>{e.resetSourceWatch_=null,Object.keys(i).forEach(d=>{e[d]=i[d]}),Object.defineProperty(e,"innerHTML",r)},s.one("sourceset",e.resetSourceWatch_)},Zc=Object.defineProperty({},"src",{get(){return this.hasAttribute("src")?tl(le().Element.prototype.getAttribute.call(this,"src")):""},set(s){return le().Element.prototype.setAttribute.call(this,"src",s),s}}),eh=s=>qd([s.el(),le().HTMLMediaElement.prototype,Zc],"src"),th=function(s){if(!s.featuresSourceset)return;const e=s.el();if(e.resetSourceset_)return;const i=eh(s),r=e.setAttribute,l=e.load;Object.defineProperty(e,"src",ci(i,{set:d=>{const f=i.set.call(e,d);return s.triggerSourceset(e.src),f}})),e.setAttribute=(d,f)=>{const y=r.call(e,d,f);return/src/i.test(d)&&s.triggerSourceset(e.src),y},e.load=()=>{const d=l.call(e);return yl(s)||(s.triggerSourceset(""),oo(s)),d},e.currentSrc?s.triggerSourceset(e.currentSrc):yl(s)||oo(s),e.resetSourceset_=()=>{e.resetSourceset_=null,e.load=l,e.setAttribute=r,Object.defineProperty(e,"src",i),e.resetSourceWatch_&&e.resetSourceWatch_()}};class Pt extends si{constructor(e,i){super(e,i);const r=e.source;let l=!1;if(this.featuresVideoFrameCallback=this.featuresVideoFrameCallback&&this.el_.tagName==="VIDEO",r&&(this.el_.currentSrc!==r.src||e.tag&&e.tag.initNetworkState_===3)?this.setSource(r):this.handleLateInit_(this.el_),e.enableSourceset&&this.setupSourcesetHandling_(),this.isScrubbing_=!1,this.el_.hasChildNodes()){const d=this.el_.childNodes;let f=d.length;const y=[];for(;f--;){const L=d[f];L.nodeName.toLowerCase()==="track"&&(this.featuresNativeTextTracks?(this.remoteTextTrackEls().addTrackElement_(L),this.remoteTextTracks().addTrack(L.track),this.textTracks().addTrack(L.track),!l&&!this.el_.hasAttribute("crossorigin")&&eo(L.src)&&(l=!0)):y.push(L))}for(let L=0;L<y.length;L++)this.el_.removeChild(y[L])}this.proxyNativeTracks_(),this.featuresNativeTextTracks&&l&&ni.warn(`Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.
This may prevent text tracks from loading.`),this.restoreMetadataTracksInIOSNativePlayer_(),(vr||ga)&&e.nativeControlsForTouch===!0&&this.setControls(!0),this.proxyWebkitFullscreen_(),this.triggerReady()}dispose(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),Pt.disposeMediaElement(this.el_),this.options_=null,super.dispose()}setupSourcesetHandling_(){th(this)}restoreMetadataTracksInIOSNativePlayer_(){const e=this.textTracks();let i;const r=()=>{i=[];for(let d=0;d<e.length;d++){const f=e[d];f.kind==="metadata"&&i.push({track:f,storedMode:f.mode})}};r(),e.addEventListener("change",r),this.on("dispose",()=>e.removeEventListener("change",r));const l=()=>{for(let d=0;d<i.length;d++){const f=i[d];f.track.mode==="disabled"&&f.track.mode!==f.storedMode&&(f.track.mode=f.storedMode)}e.removeEventListener("change",l)};this.on("webkitbeginfullscreen",()=>{e.removeEventListener("change",r),e.removeEventListener("change",l),e.addEventListener("change",l)}),this.on("webkitendfullscreen",()=>{e.removeEventListener("change",r),e.addEventListener("change",r),e.removeEventListener("change",l)})}overrideNative_(e,i){if(i!==this[`featuresNative${e}Tracks`])return;const r=e.toLowerCase();this[`${r}TracksListeners_`]&&Object.keys(this[`${r}TracksListeners_`]).forEach(l=>{this.el()[`${r}Tracks`].removeEventListener(l,this[`${r}TracksListeners_`][l])}),this[`featuresNative${e}Tracks`]=!i,this[`${r}TracksListeners_`]=null,this.proxyNativeTracksForType_(r)}overrideNativeAudioTracks(e){this.overrideNative_("Audio",e)}overrideNativeVideoTracks(e){this.overrideNative_("Video",e)}proxyNativeTracksForType_(e){const i=sr[e],r=this.el()[i.getterName],l=this[i.getterName]();if(!this[`featuresNative${i.capitalName}Tracks`]||!r||!r.addEventListener)return;const d={change:y=>{const L={type:"change",target:l,currentTarget:l,srcElement:l};l.trigger(L),e==="text"&&this[Qs.remoteText.getterName]().trigger(L)},addtrack(y){l.addTrack(y.track)},removetrack(y){l.removeTrack(y.track)}},f=function(){const y=[];for(let L=0;L<l.length;L++){let B=!1;for(let W=0;W<r.length;W++)if(r[W]===l[L]){B=!0;break}B||y.push(l[L])}for(;y.length;)l.removeTrack(y.shift())};this[i.getterName+"Listeners_"]=d,Object.keys(d).forEach(y=>{const L=d[y];r.addEventListener(y,L),this.on("dispose",B=>r.removeEventListener(y,L))}),this.on("loadstart",f),this.on("dispose",y=>this.off("loadstart",f))}proxyNativeTracks_(){sr.names.forEach(e=>{this.proxyNativeTracksForType_(e)})}createEl(){let e=this.options_.tag;if(!e||!(this.options_.playerElIngest||this.movingMediaElementInDOM)){if(e){const r=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(r,e),Pt.disposeMediaElement(e),e=r}else{e=Ee().createElement("video");const r=this.options_.tag&&Hn(this.options_.tag),l=ci({},r);(!vr||this.options_.nativeControlsForTouch!==!0)&&delete l.controls,ba(e,Object.assign(l,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}typeof this.options_.preload!="undefined"&&Ar(e,"preload",this.options_.preload),this.options_.disablePictureInPicture!==void 0&&(e.disablePictureInPicture=this.options_.disablePictureInPicture);const i=["loop","muted","playsinline","autoplay"];for(let r=0;r<i.length;r++){const l=i[r],d=this.options_[l];typeof d!="undefined"&&(d?Ar(e,l,l):_a(e,l),e[l]=d)}return e}handleLateInit_(e){if(e.networkState===0||e.networkState===3)return;if(e.readyState===0){let r=!1;const l=function(){r=!0};this.on("loadstart",l);const d=function(){r||this.trigger("loadstart")};this.on("loadedmetadata",d),this.ready(function(){this.off("loadstart",l),this.off("loadedmetadata",d),r||this.trigger("loadstart")});return}const i=["loadstart"];i.push("loadedmetadata"),e.readyState>=2&&i.push("loadeddata"),e.readyState>=3&&i.push("canplay"),e.readyState>=4&&i.push("canplaythrough"),this.ready(function(){i.forEach(function(r){this.trigger(r)},this)})}setScrubbing(e){this.isScrubbing_=e}scrubbing(){return this.isScrubbing_}setCurrentTime(e){try{this.isScrubbing_&&this.el_.fastSeek&&ya?this.el_.fastSeek(e):this.el_.currentTime=e}catch(i){ni(i,"Video is not ready. (Video.js)")}}duration(){if(this.el_.duration===Infinity&&cn&&Sn&&this.el_.currentTime===0){const e=()=>{this.el_.currentTime>0&&(this.el_.duration===Infinity&&this.trigger("durationchange"),this.off("timeupdate",e))};return this.on("timeupdate",e),NaN}return this.el_.duration||NaN}width(){return this.el_.offsetWidth}height(){return this.el_.offsetHeight}proxyWebkitFullscreen_(){if(!("webkitDisplayingFullscreen"in this.el_))return;const e=function(){this.trigger("fullscreenchange",{isFullscreen:!1}),this.el_.controls&&!this.options_.nativeControlsForTouch&&this.controls()&&(this.el_.controls=!1)},i=function(){"webkitPresentationMode"in this.el_&&this.el_.webkitPresentationMode!=="picture-in-picture"&&(this.one("webkitendfullscreen",e),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",i),this.on("dispose",()=>{this.off("webkitbeginfullscreen",i),this.off("webkitendfullscreen",e)})}supportsFullScreen(){return typeof this.el_.webkitEnterFullScreen=="function"}enterFullScreen(){const e=this.el_;if(e.paused&&e.networkState<=e.HAVE_METADATA)Gr(this.el_.play()),this.setTimeout(function(){e.pause();try{e.webkitEnterFullScreen()}catch(i){this.trigger("fullscreenerror",i)}},0);else try{e.webkitEnterFullScreen()}catch(i){this.trigger("fullscreenerror",i)}}exitFullScreen(){if(!this.el_.webkitDisplayingFullscreen){this.trigger("fullscreenerror",new Error("The video is not fullscreen"));return}this.el_.webkitExitFullScreen()}requestPictureInPicture(){return this.el_.requestPictureInPicture()}requestVideoFrameCallback(e){return this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.requestVideoFrameCallback(e):super.requestVideoFrameCallback(e)}cancelVideoFrameCallback(e){this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.cancelVideoFrameCallback(e):super.cancelVideoFrameCallback(e)}src(e){if(e===void 0)return this.el_.src;this.setSrc(e)}reset(){Pt.resetMediaElement(this.el_)}currentSrc(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc}setControls(e){this.el_.controls=!!e}addTextTrack(e,i,r){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,i,r):super.addTextTrack(e,i,r)}createRemoteTextTrack(e){if(!this.featuresNativeTextTracks)return super.createRemoteTextTrack(e);const i=Ee().createElement("track");return e.kind&&(i.kind=e.kind),e.label&&(i.label=e.label),(e.language||e.srclang)&&(i.srclang=e.language||e.srclang),e.default&&(i.default=e.default),e.id&&(i.id=e.id),e.src&&(i.src=e.src),i}addRemoteTextTrack(e,i){const r=super.addRemoteTextTrack(e,i);return this.featuresNativeTextTracks&&this.el().appendChild(r),r}removeRemoteTextTrack(e){if(super.removeRemoteTextTrack(e),this.featuresNativeTextTracks){const i=this.$$("track");let r=i.length;for(;r--;)(e===i[r]||e===i[r].track)&&this.el().removeChild(i[r])}}getVideoPlaybackQuality(){if(typeof this.el().getVideoPlaybackQuality=="function")return this.el().getVideoPlaybackQuality();const e={};return typeof this.el().webkitDroppedFrameCount!="undefined"&&typeof this.el().webkitDecodedFrameCount!="undefined"&&(e.droppedVideoFrames=this.el().webkitDroppedFrameCount,e.totalVideoFrames=this.el().webkitDecodedFrameCount),le().performance&&(e.creationTime=le().performance.now()),e}}_i(Pt,"TEST_VID",function(){if(!Ur())return;const s=Ee().createElement("video"),e=Ee().createElement("track");return e.kind="captions",e.srclang="en",e.label="English",s.appendChild(e),s}),Pt.isSupported=function(){try{Pt.TEST_VID.volume=.5}catch(s){return!1}return!!(Pt.TEST_VID&&Pt.TEST_VID.canPlayType)},Pt.canPlayType=function(s){return Pt.TEST_VID.canPlayType(s)},Pt.canPlaySource=function(s,e){return Pt.canPlayType(s.type)},Pt.canControlVolume=function(){try{const s=Pt.TEST_VID.volume;Pt.TEST_VID.volume=s/2+.1;const e=s!==Pt.TEST_VID.volume;return e&&bn?(le().setTimeout(()=>{Pt&&Pt.prototype&&(Pt.prototype.featuresVolumeControl=s!==Pt.TEST_VID.volume)}),!1):e}catch(s){return!1}},Pt.canMuteVolume=function(){try{const s=Pt.TEST_VID.muted;return Pt.TEST_VID.muted=!s,Pt.TEST_VID.muted?Ar(Pt.TEST_VID,"muted","muted"):_a(Pt.TEST_VID,"muted","muted"),s!==Pt.TEST_VID.muted}catch(s){return!1}},Pt.canControlPlaybackRate=function(){if(cn&&Sn&&Gs<58)return!1;try{const s=Pt.TEST_VID.playbackRate;return Pt.TEST_VID.playbackRate=s/2+.1,s!==Pt.TEST_VID.playbackRate}catch(s){return!1}},Pt.canOverrideAttributes=function(){try{const s=()=>{};Object.defineProperty(Ee().createElement("video"),"src",{get:s,set:s}),Object.defineProperty(Ee().createElement("audio"),"src",{get:s,set:s}),Object.defineProperty(Ee().createElement("video"),"innerHTML",{get:s,set:s}),Object.defineProperty(Ee().createElement("audio"),"innerHTML",{get:s,set:s})}catch(s){return!1}return!0},Pt.supportsNativeTextTracks=function(){return ya||bn&&Sn},Pt.supportsNativeVideoTracks=function(){return!!(Pt.TEST_VID&&Pt.TEST_VID.videoTracks)},Pt.supportsNativeAudioTracks=function(){return!!(Pt.TEST_VID&&Pt.TEST_VID.audioTracks)},Pt.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],[["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach(function([s,e]){_i(Pt.prototype,s,()=>Pt[e](),!0)}),Pt.prototype.featuresVolumeControl=Pt.canControlVolume(),Pt.prototype.movingMediaElementInDOM=!bn,Pt.prototype.featuresFullscreenResize=!0,Pt.prototype.featuresProgressEvents=!0,Pt.prototype.featuresTimeupdateEvents=!0,Pt.prototype.featuresVideoFrameCallback=!!(Pt.TEST_VID&&Pt.TEST_VID.requestVideoFrameCallback),Pt.disposeMediaElement=function(s){if(!!s){for(s.parentNode&&s.parentNode.removeChild(s);s.hasChildNodes();)s.removeChild(s.firstChild);s.removeAttribute("src"),typeof s.load=="function"&&function(){try{s.load()}catch(e){}}()}},Pt.resetMediaElement=function(s){if(!s)return;const e=s.querySelectorAll("source");let i=e.length;for(;i--;)s.removeChild(e[i]);s.removeAttribute("src"),typeof s.load=="function"&&function(){try{s.load()}catch(r){}}()},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(s){Pt.prototype[s]=function(){return this.el_[s]||this.el_.hasAttribute(s)}}),["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(s){Pt.prototype["set"+Ji(s)]=function(e){this.el_[s]=e,e?this.el_.setAttribute(s,s):this.el_.removeAttribute(s)}}),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach(function(s){Pt.prototype[s]=function(){return this.el_[s]}}),["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach(function(s){Pt.prototype["set"+Ji(s)]=function(e){this.el_[s]=e}}),["pause","load","play"].forEach(function(s){Pt.prototype[s]=function(){return this.el_[s]()}}),si.withSourceHandlers(Pt),Pt.nativeSourceHandler={},Pt.nativeSourceHandler.canPlayType=function(s){try{return Pt.TEST_VID.canPlayType(s)}catch(e){return""}},Pt.nativeSourceHandler.canHandleSource=function(s,e){if(s.type)return Pt.nativeSourceHandler.canPlayType(s.type);if(s.src){const i=il(s.src);return Pt.nativeSourceHandler.canPlayType(`video/${i}`)}return""},Pt.nativeSourceHandler.handleSource=function(s,e,i){e.setSrc(s.src)},Pt.nativeSourceHandler.dispose=function(){},Pt.registerSourceHandler(Pt.nativeSourceHandler),si.registerTech("Html5",Pt);const Kd=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],ss={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},h=["tiny","xsmall","small","medium","large","xlarge","huge"],t={};h.forEach(s=>{const e=s.charAt(0)==="x"?`x-${s.substring(1)}`:s;t[s]=`vjs-layout-${e}`});const n={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:Infinity};class a extends it{constructor(e,i,r){if(e.id=e.id||i.id||`vjs_video_${xi()}`,i=Object.assign(a.getTagSettings(e),i),i.initChildren=!1,i.createEl=!1,i.evented=!1,i.reportTouchActivity=!1,!i.language){const f=e.closest("[lang]");f&&(i.language=f.getAttribute("lang"))}super(null,i,r);if(this.boundDocumentFullscreenChange_=f=>this.documentFullscreenChange_(f),this.boundFullWindowOnEscKey_=f=>this.fullWindowOnEscKey(f),this.boundUpdateStyleEl_=f=>this.updateStyleEl_(f),this.boundApplyInitTime_=f=>this.applyInitTime_(f),this.boundUpdateCurrentBreakpoint_=f=>this.updateCurrentBreakpoint_(f),this.boundHandleTechClick_=f=>this.handleTechClick_(f),this.boundHandleTechDoubleClick_=f=>this.handleTechDoubleClick_(f),this.boundHandleTechTouchStart_=f=>this.handleTechTouchStart_(f),this.boundHandleTechTouchMove_=f=>this.handleTechTouchMove_(f),this.boundHandleTechTouchEnd_=f=>this.handleTechTouchEnd_(f),this.boundHandleTechTap_=f=>this.handleTechTap_(f),this.isFullscreen_=!1,this.log=vs(this.id_),this.fsApi_=Fr,this.isPosterFromTech_=!1,this.queuedCallbacks_=[],this.isReady_=!1,this.hasStarted_=!1,this.userActive_=!1,this.debugEnabled_=!1,this.audioOnlyMode_=!1,this.audioPosterMode_=!1,this.audioOnlyCache_={playerHeight:null,hiddenChildren:[]},!this.options_||!this.options_.techOrder||!this.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(this.tag=e,this.tagAttributes=e&&Hn(e),this.language(this.options_.language),i.languages){const f={};Object.getOwnPropertyNames(i.languages).forEach(function(y){f[y.toLowerCase()]=i.languages[y]}),this.languages_=f}else this.languages_=a.prototype.options_.languages;this.resetCache_(),this.poster_=i.poster||"",this.controls_=!!i.controls,e.controls=!1,e.removeAttribute("controls"),this.changingSrc_=!1,this.playCallbacks_=[],this.playTerminatedQueue_=[],e.hasAttribute("autoplay")?this.autoplay(!0):this.autoplay(this.options_.autoplay),i.plugins&&Object.keys(i.plugins).forEach(f=>{if(typeof this[f]!="function")throw new Error(`plugin "${f}" does not exist`)}),this.scrubbing_=!1,this.el_=this.createEl(),Wo(this,{eventBusKey:"el_"}),this.fsApi_.requestFullscreen&&(qn(Ee(),this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.on(this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_)),this.fluid_&&this.on(["playerreset","resize"],this.boundUpdateStyleEl_);const l=ci(this.options_);if(i.plugins&&Object.keys(i.plugins).forEach(f=>{this[f](i.plugins[f])}),i.debug&&this.debug(!0),this.options_.playerOptions=l,this.middleware_=[],this.playbackRates(i.playbackRates),i.experimentalSvgIcons){const y=new(le()).DOMParser().parseFromString(Nc,"image/svg+xml");if(y.querySelector("parsererror"))ni.warn("Failed to load SVG Icons. Falling back to Font Icons."),this.options_.experimentalSvgIcons=null;else{const B=y.documentElement;B.style.display="none",this.el_.appendChild(B),this.addClass("vjs-svg-icons-enabled")}}this.initChildren(),this.isAudio(e.nodeName.toLowerCase()==="audio"),this.controls()?this.addClass("vjs-controls-enabled"):this.addClass("vjs-controls-disabled"),this.el_.setAttribute("role","region"),this.isAudio()?this.el_.setAttribute("aria-label",this.localize("Audio Player")):this.el_.setAttribute("aria-label",this.localize("Video Player")),this.isAudio()&&this.addClass("vjs-audio"),vr&&this.addClass("vjs-touch-enabled"),bn||this.addClass("vjs-workinghover"),a.players[this.id_]=this;const d=ma.split(".")[0];this.addClass(`vjs-v${d}`),this.userActive(!0),this.reportUserActivity(),this.one("play",f=>this.listenForUserActivity_(f)),this.on("keydown",f=>this.handleKeyDown(f)),this.on("languagechange",f=>this.handleLanguagechange(f)),this.breakpoints(this.options_.breakpoints),this.responsive(this.options_.responsive),this.on("ready",()=>{this.audioPosterMode(this.options_.audioPosterMode),this.audioOnlyMode(this.options_.audioOnlyMode)})}dispose(){this.trigger("dispose"),this.off("dispose"),_n(Ee(),this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),_n(Ee(),"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),a.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),Fc(this),xn.names.forEach(e=>{const i=xn[e],r=this[i.getterName]();r&&r.off&&r.off()}),super.dispose({restoreEl:this.options_.restoreEl})}createEl(){let e=this.tag,i,r=this.playerElIngest_=e.parentNode&&e.parentNode.hasAttribute&&e.parentNode.hasAttribute("data-vjs-player");const l=this.tag.tagName.toLowerCase()==="video-js";r?i=this.el_=e.parentNode:l||(i=this.el_=super.createEl("div"));const d=Hn(e);if(l){for(i=this.el_=e,e=this.tag=Ee().createElement("video");i.children.length;)e.appendChild(i.firstChild);Gn(i,"video-js")||$r(i,"video-js"),i.appendChild(e),r=this.playerElIngest_=i,Object.keys(i).forEach(y=>{try{e[y]=i[y]}catch(L){}})}if(e.setAttribute("tabindex","-1"),d.tabindex="-1",Sn&&Hs&&(e.setAttribute("role","application"),d.role="application"),e.removeAttribute("width"),e.removeAttribute("height"),"width"in d&&delete d.width,"height"in d&&delete d.height,Object.getOwnPropertyNames(d).forEach(function(y){l&&y==="class"||i.setAttribute(y,d[y]),l&&e.setAttribute(y,d[y])}),e.playerId=e.id,e.id+="_html5_api",e.className="vjs-tech",e.player=i.player=this,this.addClass("vjs-paused"),le().VIDEOJS_NO_DYNAMIC_STYLE!==!0){this.styleEl_=gi("vjs-styles-dimensions");const y=Ke(".vjs-styles-defaults"),L=Ke("head");L.insertBefore(this.styleEl_,y?y.nextSibling:L.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);const f=e.getElementsByTagName("a");for(let y=0;y<f.length;y++){const L=f.item(y);$r(L,"vjs-hidden"),L.setAttribute("hidden","hidden")}return e.initNetworkState_=e.networkState,e.parentNode&&!r&&e.parentNode.insertBefore(i,e),Mn(e,i),this.children_.unshift(e),this.el_.setAttribute("lang",this.language_),this.el_.setAttribute("translate","no"),this.el_=i,i}crossOrigin(e){if(typeof e=="undefined")return this.techGet_("crossOrigin");if(e!==null&&e!=="anonymous"&&e!=="use-credentials"){ni.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${e}"`);return}this.techCall_("setCrossOrigin",e),this.posterImage&&this.posterImage.crossOrigin(e)}width(e){return this.dimension("width",e)}height(e){return this.dimension("height",e)}dimension(e,i){const r=e+"_";if(i===void 0)return this[r]||0;if(i===""||i==="auto"){this[r]=void 0,this.updateStyleEl_();return}const l=parseFloat(i);if(isNaN(l)){ni.error(`Improper value "${i}" supplied for for ${e}`);return}this[r]=l,this.updateStyleEl_()}fluid(e){if(e===void 0)return!!this.fluid_;this.fluid_=!!e,_r(this)&&this.off(["playerreset","resize"],this.boundUpdateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),Ho(this,()=>{this.on(["playerreset","resize"],this.boundUpdateStyleEl_)})):this.removeClass("vjs-fluid"),this.updateStyleEl_()}fill(e){if(e===void 0)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")}aspectRatio(e){if(e===void 0)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()}updateStyleEl_(){if(le().VIDEOJS_NO_DYNAMIC_STYLE===!0){const y=typeof this.width_=="number"?this.width_:this.options_.width,L=typeof this.height_=="number"?this.height_:this.options_.height,B=this.tech_&&this.tech_.el();B&&(y>=0&&(B.width=y),L>=0&&(B.height=L));return}let e,i,r,l;this.aspectRatio_!==void 0&&this.aspectRatio_!=="auto"?r=this.aspectRatio_:this.videoWidth()>0?r=this.videoWidth()+":"+this.videoHeight():r="16:9";const d=r.split(":"),f=d[1]/d[0];this.width_!==void 0?e=this.width_:this.height_!==void 0?e=this.height_/f:e=this.videoWidth()||300,this.height_!==void 0?i=this.height_:i=e*f,/^[^a-zA-Z]/.test(this.id())?l="dimensions-"+this.id():l=this.id()+"-dimensions",this.addClass(l),br(this.styleEl_,`
      .${l} {
        width: ${e}px;
        height: ${i}px;
      }

      .${l}.vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: ${f*100}%;
      }
    `)}loadTech_(e,i){this.tech_&&this.unloadTech_();const r=Ji(e),l=e.charAt(0).toLowerCase()+e.slice(1);r!=="Html5"&&this.tag&&(si.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=r,this.isReady_=!1;let d=this.autoplay();(typeof this.autoplay()=="string"||this.autoplay()===!0&&this.options_.normalizeAutoplay)&&(d=!1);const f={source:i,autoplay:d,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:`${this.id()}_${l}_api`,playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};xn.names.forEach(L=>{const B=xn[L];f[B.getterName]=this[B.privateName]}),Object.assign(f,this.options_[r]),Object.assign(f,this.options_[l]),Object.assign(f,this.options_[e.toLowerCase()]),this.tag&&(f.tag=this.tag),i&&i.src===this.cache_.src&&this.cache_.currentTime>0&&(f.startTime=this.cache_.currentTime);const y=si.getTech(e);if(!y)throw new Error(`No Tech named '${r}' exists! '${r}' should be registered using videojs.registerTech()'`);this.tech_=new y(f),this.tech_.ready(Ci(this,this.handleTechReady_),!0),ud.jsonToTextTracks(this.textTracksJson_||[],this.tech_),Kd.forEach(L=>{this.on(this.tech_,L,B=>this[`handleTech${Ji(L)}_`](B))}),Object.keys(ss).forEach(L=>{this.on(this.tech_,L,B=>{if(this.tech_.playbackRate()===0&&this.tech_.seeking()){this.queuedCallbacks_.push({callback:this[`handleTech${ss[L]}_`].bind(this),event:B});return}this[`handleTech${ss[L]}_`](B)})}),this.on(this.tech_,"loadstart",L=>this.handleTechLoadStart_(L)),this.on(this.tech_,"sourceset",L=>this.handleTechSourceset_(L)),this.on(this.tech_,"waiting",L=>this.handleTechWaiting_(L)),this.on(this.tech_,"ended",L=>this.handleTechEnded_(L)),this.on(this.tech_,"seeking",L=>this.handleTechSeeking_(L)),this.on(this.tech_,"play",L=>this.handleTechPlay_(L)),this.on(this.tech_,"pause",L=>this.handleTechPause_(L)),this.on(this.tech_,"durationchange",L=>this.handleTechDurationChange_(L)),this.on(this.tech_,"fullscreenchange",(L,B)=>this.handleTechFullscreenChange_(L,B)),this.on(this.tech_,"fullscreenerror",(L,B)=>this.handleTechFullscreenError_(L,B)),this.on(this.tech_,"enterpictureinpicture",L=>this.handleTechEnterPictureInPicture_(L)),this.on(this.tech_,"leavepictureinpicture",L=>this.handleTechLeavePictureInPicture_(L)),this.on(this.tech_,"error",L=>this.handleTechError_(L)),this.on(this.tech_,"posterchange",L=>this.handleTechPosterChange_(L)),this.on(this.tech_,"textdata",L=>this.handleTechTextData_(L)),this.on(this.tech_,"ratechange",L=>this.handleTechRateChange_(L)),this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode!==this.el()&&(r!=="Html5"||!this.tag)&&Mn(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)}unloadTech_(){xn.names.forEach(e=>{const i=xn[e];this[i.privateName]=this[i.getterName]()}),this.textTracksJson_=ud.textTracksToJson(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1}tech(e){return e===void 0&&ni.warn(`Using the tech directly can be dangerous. I hope you know what you're doing.
See https://github.com/videojs/video.js/issues/2617 for more info.
`),this.tech_}version(){return{"video.js":ma}}addTechControlsListeners_(){this.removeTechControlsListeners_(),this.on(this.tech_,"click",this.boundHandleTechClick_),this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_),this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.on(this.tech_,"tap",this.boundHandleTechTap_)}removeTechControlsListeners_(){this.off(this.tech_,"tap",this.boundHandleTechTap_),this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.off(this.tech_,"click",this.boundHandleTechClick_),this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)}handleTechReady_(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()}handleTechLoadStart_(){this.removeClass("vjs-ended","vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):this.trigger("loadstart"),this.manualAutoplay_(this.autoplay()===!0&&this.options_.normalizeAutoplay?"play":this.autoplay())}manualAutoplay_(e){if(!this.tech_||typeof e!="string")return;const i=()=>{const l=this.muted();this.muted(!0);const d=()=>{this.muted(l)};this.playTerminatedQueue_.push(d);const f=this.play();if(!!Za(f))return f.catch(y=>{throw d(),new Error(`Rejection at manualAutoplay. Restoring muted value. ${y||""}`)})};let r;if(e==="any"&&!this.muted()?(r=this.play(),Za(r)&&(r=r.catch(i))):e==="muted"&&!this.muted()?r=i():r=this.play(),!!Za(r))return r.then(()=>{this.trigger({type:"autoplay-success",autoplay:e})}).catch(()=>{this.trigger({type:"autoplay-failure",autoplay:e})})}updateSourceCaches_(e=""){let i=e,r="";typeof i!="string"&&(i=e.src,r=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],i&&!r&&(r=lu(this,i)),this.cache_.source=ci({},e,{src:i,type:r});const l=this.cache_.sources.filter(L=>L.src&&L.src===i),d=[],f=this.$$("source"),y=[];for(let L=0;L<f.length;L++){const B=Hn(f[L]);d.push(B),B.src&&B.src===i&&y.push(B.src)}y.length&&!l.length?this.cache_.sources=d:l.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=i}handleTechSourceset_(e){if(!this.changingSrc_){let i=d=>this.updateSourceCaches_(d);const r=this.currentSource().src,l=e.src;r&&!/^blob:/.test(r)&&/^blob:/.test(l)&&(!this.lastSource_||this.lastSource_.tech!==l&&this.lastSource_.player!==r)&&(i=()=>{}),i(l),e.src||this.tech_.any(["sourceset","loadstart"],d=>{if(d.type==="sourceset")return;const f=this.techGet_("currentSrc");this.lastSource_.tech=f,this.updateSourceCaches_(f)})}this.lastSource_={player:this.currentSource().src,tech:e.src},this.trigger({src:e.src,type:"sourceset"})}hasStarted(e){if(e===void 0)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?this.addClass("vjs-has-started"):this.removeClass("vjs-has-started"))}handleTechPlay_(){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")}handleTechRateChange_(){this.tech_.playbackRate()>0&&this.cache_.lastPlaybackRate===0&&(this.queuedCallbacks_.forEach(e=>e.callback(e.event)),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")}handleTechWaiting_(){this.addClass("vjs-waiting"),this.trigger("waiting");const e=this.currentTime(),i=()=>{e!==this.currentTime()&&(this.removeClass("vjs-waiting"),this.off("timeupdate",i))};this.on("timeupdate",i)}handleTechCanPlay_(){this.removeClass("vjs-waiting"),this.trigger("canplay")}handleTechCanPlayThrough_(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")}handleTechPlaying_(){this.removeClass("vjs-waiting"),this.trigger("playing")}handleTechSeeking_(){this.addClass("vjs-seeking"),this.trigger("seeking")}handleTechSeeked_(){this.removeClass("vjs-seeking","vjs-ended"),this.trigger("seeked")}handleTechPause_(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")}handleTechEnded_(){this.addClass("vjs-ended"),this.removeClass("vjs-waiting"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")}handleTechDurationChange_(){this.duration(this.techGet_("duration"))}handleTechClick_(e){!this.controls_||(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.click===void 0||this.options_.userActions.click!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.click=="function"?this.options_.userActions.click.call(this,e):this.paused()?Gr(this.play()):this.pause())}handleTechDoubleClick_(e){if(!this.controls_)return;Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),r=>r.contains(e.target))||(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.doubleClick===void 0||this.options_.userActions.doubleClick!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.doubleClick=="function"?this.options_.userActions.doubleClick.call(this,e):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen())}handleTechTap_(){this.userActive(!this.userActive())}handleTechTouchStart_(){this.userWasActive=this.userActive()}handleTechTouchMove_(){this.userWasActive&&this.reportUserActivity()}handleTechTouchEnd_(e){e.cancelable&&e.preventDefault()}toggleFullscreenClass_(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")}documentFullscreenChange_(e){const i=e.target.player;if(i&&i!==this)return;const r=this.el();let l=Ee()[this.fsApi_.fullscreenElement]===r;!l&&r.matches&&(l=r.matches(":"+this.fsApi_.fullscreen)),this.isFullscreen(l)}handleTechFullscreenChange_(e,i){i&&(i.nativeIOSFullscreen&&(this.addClass("vjs-ios-native-fs"),this.tech_.one("webkitendfullscreen",()=>{this.removeClass("vjs-ios-native-fs")})),this.isFullscreen(i.isFullscreen))}handleTechFullscreenError_(e,i){this.trigger("fullscreenerror",i)}togglePictureInPictureClass_(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")}handleTechEnterPictureInPicture_(e){this.isInPictureInPicture(!0)}handleTechLeavePictureInPicture_(e){this.isInPictureInPicture(!1)}handleTechError_(){const e=this.tech_.error();e&&this.error(e)}handleTechTextData_(){let e=null;arguments.length>1&&(e=arguments[1]),this.trigger("textdata",e)}getCache(){return this.cache_}resetCache_(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}}techCall_(e,i){this.ready(function(){if(e in fd)return Mc(this.middleware_,this.tech_,e,i);if(e in su)return hd(this.middleware_,this.tech_,e,i);try{this.tech_&&this.tech_[e](i)}catch(r){throw ni(r),r}},!0)}techGet_(e){if(!(!this.tech_||!this.tech_.isReady_)){if(e in ru)return nu(this.middleware_,this.tech_,e);if(e in su)return hd(this.middleware_,this.tech_,e);try{return this.tech_[e]()}catch(i){throw this.tech_[e]===void 0?(ni(`Video.js: ${e} method not defined for ${this.techName_} playback technology.`,i),i):i.name==="TypeError"?(ni(`Video.js: ${e} unavailable on ${this.techName_} playback technology element.`,i),this.tech_.isReady_=!1,i):(ni(i),i)}}}play(){return new Promise(e=>{this.play_(e)})}play_(e=Gr){this.playCallbacks_.push(e);const i=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc())),r=Boolean(ya||bn);if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!i){this.waitToPlay_=f=>{this.play_()},this.one(["ready","loadstart"],this.waitToPlay_),!i&&r&&this.load();return}const l=this.techGet_("play");r&&this.hasClass("vjs-ended")&&this.resetProgressBar_(),l===null?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(l)}runPlayTerminatedQueue_(){const e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],e.forEach(function(i){i()})}runPlayCallbacks_(e){const i=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],i.forEach(function(r){r(e)})}pause(){this.techCall_("pause")}paused(){return this.techGet_("paused")!==!1}played(){return this.techGet_("played")||Wn(0,0)}scrubbing(e){if(typeof e=="undefined")return this.scrubbing_;this.scrubbing_=!!e,this.techCall_("setScrubbing",this.scrubbing_),e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")}currentTime(e){if(e===void 0)return this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime;if(e<0&&(e=0),!this.isReady_||this.changingSrc_||!this.tech_||!this.tech_.isReady_){this.cache_.initTime=e,this.off("canplay",this.boundApplyInitTime_),this.one("canplay",this.boundApplyInitTime_);return}this.techCall_("setCurrentTime",e),this.cache_.initTime=0,isFinite(e)&&(this.cache_.currentTime=Number(e))}applyInitTime_(){this.currentTime(this.cache_.initTime)}duration(e){if(e===void 0)return this.cache_.duration!==void 0?this.cache_.duration:NaN;e=parseFloat(e),e<0&&(e=Infinity),e!==this.cache_.duration&&(this.cache_.duration=e,e===Infinity?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(e)||this.trigger("durationchange"))}remainingTime(){return this.duration()-this.currentTime()}remainingTimeDisplay(){return Math.floor(this.duration())-Math.floor(this.currentTime())}buffered(){let e=this.techGet_("buffered");return(!e||!e.length)&&(e=Wn(0,0)),e}seekable(){let e=this.techGet_("seekable");return(!e||!e.length)&&(e=Wn(0,0)),e}seeking(){return this.techGet_("seeking")}ended(){return this.techGet_("ended")}networkState(){return this.techGet_("networkState")}readyState(){return this.techGet_("readyState")}bufferedPercent(){return ld(this.buffered(),this.duration())}bufferedEnd(){const e=this.buffered(),i=this.duration();let r=e.end(e.length-1);return r>i&&(r=i),r}volume(e){let i;if(e!==void 0){i=Math.max(0,Math.min(1,e)),this.cache_.volume=i,this.techCall_("setVolume",i),i>0&&this.lastVolume_(i);return}return i=parseFloat(this.techGet_("volume")),isNaN(i)?1:i}muted(e){if(e!==void 0){this.techCall_("setMuted",e);return}return this.techGet_("muted")||!1}defaultMuted(e){return e!==void 0&&this.techCall_("setDefaultMuted",e),this.techGet_("defaultMuted")||!1}lastVolume_(e){if(e!==void 0&&e!==0){this.cache_.lastVolume=e;return}return this.cache_.lastVolume}supportsFullScreen(){return this.techGet_("supportsFullScreen")||!1}isFullscreen(e){if(e!==void 0){const i=this.isFullscreen_;this.isFullscreen_=Boolean(e),this.isFullscreen_!==i&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),this.toggleFullscreenClass_();return}return this.isFullscreen_}requestFullscreen(e){this.isInPictureInPicture()&&this.exitPictureInPicture();const i=this;return new Promise((r,l)=>{function d(){i.off("fullscreenerror",y),i.off("fullscreenchange",f)}function f(){d(),r()}function y(B,W){d(),l(W)}i.one("fullscreenchange",f),i.one("fullscreenerror",y);const L=i.requestFullscreenHelper_(e);L&&(L.then(d,d),L.then(r,l))})}requestFullscreenHelper_(e){let i;if(this.fsApi_.prefixed||(i=this.options_.fullscreen&&this.options_.fullscreen.options||{},e!==void 0&&(i=e)),this.fsApi_.requestFullscreen){const r=this.el_[this.fsApi_.requestFullscreen](i);return r&&r.then(()=>this.isFullscreen(!0),()=>this.isFullscreen(!1)),r}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("enterFullScreen"):this.enterFullWindow()}exitFullscreen(){const e=this;return new Promise((i,r)=>{function l(){e.off("fullscreenerror",f),e.off("fullscreenchange",d)}function d(){l(),i()}function f(L,B){l(),r(B)}e.one("fullscreenchange",d),e.one("fullscreenerror",f);const y=e.exitFullscreenHelper_();y&&(y.then(l,l),y.then(i,r))})}exitFullscreenHelper_(){if(this.fsApi_.requestFullscreen){const e=Ee()[this.fsApi_.exitFullscreen]();return e&&Gr(e.then(()=>this.isFullscreen(!1))),e}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("exitFullScreen"):this.exitFullWindow()}enterFullWindow(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=Ee().documentElement.style.overflow,qn(Ee(),"keydown",this.boundFullWindowOnEscKey_),Ee().documentElement.style.overflow="hidden",$r(Ee().body,"vjs-full-window"),this.trigger("enterFullWindow")}fullWindowOnEscKey(e){me().isEventKey(e,"Esc")&&this.isFullscreen()===!0&&(this.isFullWindow?this.exitFullWindow():this.exitFullscreen())}exitFullWindow(){this.isFullscreen(!1),this.isFullWindow=!1,_n(Ee(),"keydown",this.boundFullWindowOnEscKey_),Ee().documentElement.style.overflow=this.docOrigOverflow,va(Ee().body,"vjs-full-window"),this.trigger("exitFullWindow")}disablePictureInPicture(e){if(e===void 0)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",e),this.options_.disablePictureInPicture=e,this.trigger("disablepictureinpicturechanged")}isInPictureInPicture(e){if(e!==void 0){this.isInPictureInPicture_=!!e,this.togglePictureInPictureClass_();return}return!!this.isInPictureInPicture_}requestPictureInPicture(){if(this.options_.enableDocumentPictureInPicture&&le().documentPictureInPicture){const e=Ee().createElement(this.el().tagName);return e.classList=this.el().classList,e.classList.add("vjs-pip-container"),this.posterImage&&e.appendChild(this.posterImage.el().cloneNode(!0)),this.titleBar&&e.appendChild(this.titleBar.el().cloneNode(!0)),e.appendChild(ri("p",{className:"vjs-pip-text"},{},this.localize("Playing in picture-in-picture"))),le().documentPictureInPicture.requestWindow({width:this.videoWidth(),height:this.videoHeight()}).then(i=>(Ot(i),this.el_.parentNode.insertBefore(e,this.el_),i.document.body.appendChild(this.el_),i.document.body.classList.add("vjs-pip-window"),this.player_.isInPictureInPicture(!0),this.player_.trigger("enterpictureinpicture"),i.addEventListener("pagehide",r=>{const l=r.target.querySelector(".video-js");e.parentNode.replaceChild(l,e),this.player_.isInPictureInPicture(!1),this.player_.trigger("leavepictureinpicture")}),i))}return"pictureInPictureEnabled"in Ee()&&this.disablePictureInPicture()===!1?this.techGet_("requestPictureInPicture"):Promise.reject("No PiP mode is available")}exitPictureInPicture(){if(le().documentPictureInPicture&&le().documentPictureInPicture.window)return le().documentPictureInPicture.window.close(),Promise.resolve();if("pictureInPictureEnabled"in Ee())return Ee().exitPictureInPicture()}handleKeyDown(e){const{userActions:i}=this.options_;!i||!i.hotkeys||(l=>{const d=l.tagName.toLowerCase();if(l.isContentEditable)return!0;const f=["button","checkbox","hidden","radio","reset","submit"];return d==="input"?f.indexOf(l.type)===-1:["textarea"].indexOf(d)!==-1})(this.el_.ownerDocument.activeElement)||(typeof i.hotkeys=="function"?i.hotkeys.call(this,e):this.handleHotkeys(e))}handleHotkeys(e){const i=this.options_.userActions?this.options_.userActions.hotkeys:{},{fullscreenKey:r=f=>me().isEventKey(f,"f"),muteKey:l=f=>me().isEventKey(f,"m"),playPauseKey:d=f=>me().isEventKey(f,"k")||me().isEventKey(f,"Space")}=i;if(r.call(this,e)){e.preventDefault(),e.stopPropagation();const f=it.getComponent("FullscreenToggle");Ee()[this.fsApi_.fullscreenEnabled]!==!1&&f.prototype.handleClick.call(this,e)}else l.call(this,e)?(e.preventDefault(),e.stopPropagation(),it.getComponent("MuteToggle").prototype.handleClick.call(this,e)):d.call(this,e)&&(e.preventDefault(),e.stopPropagation(),it.getComponent("PlayToggle").prototype.handleClick.call(this,e))}canPlayType(e){let i;for(let r=0,l=this.options_.techOrder;r<l.length;r++){const d=l[r];let f=si.getTech(d);if(f||(f=it.getComponent(d)),!f){ni.error(`The "${d}" tech is undefined. Skipped browser support check for that tech.`);continue}if(f.isSupported()&&(i=f.canPlayType(e),i))return i}return""}selectSource(e){const i=this.options_.techOrder.map(y=>[y,si.getTech(y)]).filter(([y,L])=>L?L.isSupported():(ni.error(`The "${y}" tech is undefined. Skipped browser support check for that tech.`),!1)),r=function(y,L,B){let W;return y.some(ce=>L.some(ke=>{if(W=B(ce,ke),W)return!0})),W};let l;const d=y=>(L,B)=>y(B,L),f=([y,L],B)=>{if(L.canPlaySource(B,this.options_[y.toLowerCase()]))return{source:B,tech:y}};return this.options_.sourceOrder?l=r(e,i,d(f)):l=r(i,e,f),l||!1}handleSrc_(e,i){if(typeof e=="undefined")return this.cache_.src||"";this.resetRetryOnError_&&this.resetRetryOnError_();const r=uu(e);if(!r.length){this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0);return}if(this.changingSrc_=!0,i||(this.cache_.sources=r),this.updateSourceCaches_(r[0]),Bc(this,r[0],(l,d)=>{if(this.middleware_=d,i||(this.cache_.sources=r),this.updateSourceCaches_(l),this.src_(l)){if(r.length>1)return this.handleSrc_(r.slice(1));this.changingSrc_=!1,this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0),this.triggerReady();return}iu(d,this.tech_)}),r.length>1){const l=()=>{this.error(null),this.handleSrc_(r.slice(1),!0)},d=()=>{this.off("error",l)};this.one("error",l),this.one("playing",d),this.resetRetryOnError_=()=>{this.off("error",l),this.off("playing",d)}}}src(e){return this.handleSrc_(e,!1)}src_(e){const i=this.selectSource([e]);return i?zo(i.tech,this.techName_)?(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1},!0),!1):(this.changingSrc_=!0,this.loadTech_(i.tech,i.source),this.tech_.ready(()=>{this.changingSrc_=!1}),!1):!0}load(){if(this.tech_&&this.tech_.vhs){this.src(this.currentSource());return}this.techCall_("load")}reset(){if(this.paused())this.doReset_();else{const e=this.play();Gr(e.then(()=>this.doReset_()))}}doReset_(){this.tech_&&this.tech_.clearTracks("text"),this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),this.error(null),this.titleBar&&this.titleBar.update({title:void 0,description:void 0}),_r(this)&&this.trigger("playerreset")}resetControlBarUI_(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()}resetProgressBar_(){this.currentTime(0);const{currentTimeDisplay:e,durationDisplay:i,progressControl:r,remainingTimeDisplay:l}=this.controlBar||{},{seekBar:d}=r||{};e&&e.updateContent(),i&&i.updateContent(),l&&l.updateContent(),d&&(d.update(),d.loadProgressBar&&d.loadProgressBar.update())}resetPlaybackRate_(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()}resetVolumeBar_(){this.volume(1),this.trigger("volumechange")}currentSources(){const e=this.currentSource(),i=[];return Object.keys(e).length!==0&&i.push(e),this.cache_.sources||i}currentSource(){return this.cache_.source||{}}currentSrc(){return this.currentSource()&&this.currentSource().src||""}currentType(){return this.currentSource()&&this.currentSource().type||""}preload(e){if(e!==void 0){this.techCall_("setPreload",e),this.options_.preload=e;return}return this.techGet_("preload")}autoplay(e){if(e===void 0)return this.options_.autoplay||!1;let i;typeof e=="string"&&/(any|play|muted)/.test(e)||e===!0&&this.options_.normalizeAutoplay?(this.options_.autoplay=e,this.manualAutoplay_(typeof e=="string"?e:"play"),i=!1):e?this.options_.autoplay=!0:this.options_.autoplay=!1,i=typeof i=="undefined"?this.options_.autoplay:i,this.tech_&&this.techCall_("setAutoplay",i)}playsinline(e){return e!==void 0&&(this.techCall_("setPlaysinline",e),this.options_.playsinline=e),this.techGet_("playsinline")}loop(e){if(e!==void 0){this.techCall_("setLoop",e),this.options_.loop=e;return}return this.techGet_("loop")}poster(e){if(e===void 0)return this.poster_;e||(e=""),e!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))}handleTechPosterChange_(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){const e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}}controls(e){if(e===void 0)return!!this.controls_;e=!!e,this.controls_!==e&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))}usingNativeControls(e){if(e===void 0)return!!this.usingNativeControls_;e=!!e,this.usingNativeControls_!==e&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))}error(e){if(e===void 0)return this.error_||null;if(Pn("beforeerror").forEach(i=>{const r=i(this,e);if(!(tr(r)&&!Array.isArray(r)||typeof r=="string"||typeof r=="number"||r===null)){this.log.error("please return a value that MediaError expects in beforeerror hooks");return}e=r}),this.options_.suppressNotSupportedError&&e&&e.code===4){const i=function(){this.error(e)};this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],i),this.one("loadstart",function(){this.off(["click","touchstart"],i)});return}if(e===null){this.error_=null,this.removeClass("vjs-error"),this.errorDisplay&&this.errorDisplay.close();return}this.error_=new Cn(e),this.addClass("vjs-error"),ni.error(`(CODE:${this.error_.code} ${Cn.errorTypes[this.error_.code]})`,this.error_.message,this.error_),this.trigger("error"),Pn("error").forEach(i=>i(this,this.error_))}reportUserActivity(e){this.userActivity_=!0}userActive(e){if(e===void 0)return this.userActive_;if(e=!!e,e!==this.userActive_){if(this.userActive_=e,this.userActive_){this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive");return}this.tech_&&this.tech_.one("mousemove",function(i){i.stopPropagation(),i.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}}listenForUserActivity_(){let e,i,r;const l=Ci(this,this.reportUserActivity),d=function(ce){(ce.screenX!==i||ce.screenY!==r)&&(i=ce.screenX,r=ce.screenY,l())},f=function(){l(),this.clearInterval(e),e=this.setInterval(l,250)},y=function(ce){l(),this.clearInterval(e)};this.on("mousedown",f),this.on("mousemove",d),this.on("mouseup",y),this.on("mouseleave",y);const L=this.getChild("controlBar");L&&!bn&&!cn&&(L.on("mouseenter",function(ce){this.player().options_.inactivityTimeout!==0&&(this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout),this.player().options_.inactivityTimeout=0}),L.on("mouseleave",function(ce){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",l),this.on("keyup",l);let B;const W=function(){if(!this.userActivity_)return;this.userActivity_=!1,this.userActive(!0),this.clearTimeout(B);const ce=this.options_.inactivityTimeout;ce<=0||(B=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},ce))};this.setInterval(W,250)}playbackRate(e){if(e!==void 0){this.techCall_("setPlaybackRate",e);return}return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1}defaultPlaybackRate(e){return e!==void 0?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1}isAudio(e){if(e!==void 0){this.isAudio_=!!e;return}return!!this.isAudio_}enableAudioOnlyUI_(){this.addClass("vjs-audio-only-mode");const e=this.children(),i=this.getChild("ControlBar"),r=i&&i.currentHeight();e.forEach(l=>{l!==i&&l.el_&&!l.hasClass("vjs-hidden")&&(l.hide(),this.audioOnlyCache_.hiddenChildren.push(l))}),this.audioOnlyCache_.playerHeight=this.currentHeight(),this.height(r),this.trigger("audioonlymodechange")}disableAudioOnlyUI_(){this.removeClass("vjs-audio-only-mode"),this.audioOnlyCache_.hiddenChildren.forEach(e=>e.show()),this.height(this.audioOnlyCache_.playerHeight),this.trigger("audioonlymodechange")}audioOnlyMode(e){if(typeof e!="boolean"||e===this.audioOnlyMode_)return this.audioOnlyMode_;if(this.audioOnlyMode_=e,e){const i=[];return this.isInPictureInPicture()&&i.push(this.exitPictureInPicture()),this.isFullscreen()&&i.push(this.exitFullscreen()),this.audioPosterMode()&&i.push(this.audioPosterMode(!1)),Promise.all(i).then(()=>this.enableAudioOnlyUI_())}return Promise.resolve().then(()=>this.disableAudioOnlyUI_())}enablePosterModeUI_(){(this.tech_&&this.tech_).hide(),this.addClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}disablePosterModeUI_(){(this.tech_&&this.tech_).show(),this.removeClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}audioPosterMode(e){return typeof e!="boolean"||e===this.audioPosterMode_?this.audioPosterMode_:(this.audioPosterMode_=e,e?this.audioOnlyMode()?this.audioOnlyMode(!1).then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.disablePosterModeUI_()}))}addTextTrack(e,i,r){if(this.tech_)return this.tech_.addTextTrack(e,i,r)}addRemoteTextTrack(e,i){if(this.tech_)return this.tech_.addRemoteTextTrack(e,i)}removeRemoteTextTrack(e={}){let{track:i}=e;if(i||(i=e),this.tech_)return this.tech_.removeRemoteTextTrack(i)}getVideoPlaybackQuality(){return this.techGet_("getVideoPlaybackQuality")}videoWidth(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0}videoHeight(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0}language(e){if(e===void 0)return this.language_;this.language_!==String(e).toLowerCase()&&(this.language_=String(e).toLowerCase(),_r(this)&&this.trigger("languagechange"))}languages(){return ci(a.prototype.options_.languages,this.languages_)}toJSON(){const e=ci(this.options_),i=e.tracks;e.tracks=[];for(let r=0;r<i.length;r++){let l=i[r];l=ci(l),l.player=void 0,e.tracks[r]=l}return e}createModal(e,i){i=i||{},i.content=e||"";const r=new Ta(this,i);return this.addChild(r),r.on("dispose",()=>{this.removeChild(r)}),r.open(),r}updateCurrentBreakpoint_(){if(!this.responsive())return;const e=this.currentBreakpoint(),i=this.currentWidth();for(let r=0;r<h.length;r++){const l=h[r],d=this.breakpoints_[l];if(i<=d){if(e===l)return;e&&this.removeClass(t[e]),this.addClass(t[l]),this.breakpoint_=l;break}}}removeCurrentBreakpoint_(){const e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)}breakpoints(e){return e===void 0?Object.assign(this.breakpoints_):(this.breakpoint_="",this.breakpoints_=Object.assign({},n,e),this.updateCurrentBreakpoint_(),Object.assign(this.breakpoints_))}responsive(e){if(e===void 0)return this.responsive_;e=Boolean(e);const i=this.responsive_;if(e!==i)return this.responsive_=e,e?(this.on("playerresize",this.boundUpdateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.boundUpdateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e}currentBreakpoint(){return this.breakpoint_}currentBreakpointClass(){return t[this.breakpoint_]||""}loadMedia(e,i){if(!e||typeof e!="object")return;const r=this.crossOrigin();this.reset(),this.cache_.media=ci(e);const{artist:l,artwork:d,description:f,poster:y,src:L,textTracks:B,title:W}=this.cache_.media;!d&&y&&(this.cache_.media.artwork=[{src:y,type:al(y)}]),r&&this.crossOrigin(r),L&&this.src(L),y&&this.poster(y),Array.isArray(B)&&B.forEach(ce=>this.addRemoteTextTrack(ce,!1)),this.titleBar&&this.titleBar.update({title:W,description:f||l||""}),this.ready(i)}getMedia(){if(!this.cache_.media){const e=this.poster(),i=this.currentSources(),r=Array.prototype.map.call(this.remoteTextTracks(),d=>({kind:d.kind,label:d.label,language:d.language,src:d.src})),l={src:i,textTracks:r};return e&&(l.poster=e,l.artwork=[{src:l.poster,type:al(l.poster)}]),l}return ci(this.cache_.media)}static getTagSettings(e){const i={sources:[],tracks:[]},r=Hn(e),l=r["data-setup"];if(Gn(e,"vjs-fill")&&(r.fill=!0),Gn(e,"vjs-fluid")&&(r.fluid=!0),l!==null){const[d,f]=ve()(l||"{}");d&&ni.error(d),Object.assign(r,f)}if(Object.assign(i,r),e.hasChildNodes()){const d=e.childNodes;for(let f=0,y=d.length;f<y;f++){const L=d[f],B=L.nodeName.toLowerCase();B==="source"?i.sources.push(Hn(L)):B==="track"&&i.tracks.push(Hn(L))}}return i}debug(e){if(e===void 0)return this.debugEnabled_;e?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)}playbackRates(e){if(e===void 0)return this.cache_.playbackRates;!Array.isArray(e)||!e.every(i=>typeof i=="number")||(this.cache_.playbackRates=e,this.trigger("playbackrateschange"))}}xn.names.forEach(function(s){const e=xn[s];a.prototype[e.getterName]=function(){return this.tech_?this.tech_[e.getterName]():(this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName])}}),a.prototype.crossorigin=a.prototype.crossOrigin,a.players={};const o=le().navigator;a.prototype.options_={techOrder:si.defaultTechOrder_,html5:{},enableSourceset:!0,inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","titleBar","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:o&&(o.languages&&o.languages[0]||o.userLanguage||o.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",normalizeAutoplay:!1,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1,audioOnlyMode:!1,audioPosterMode:!1,enableSmoothSeeking:!1},Kd.forEach(function(s){a.prototype[`handleTech${Ji(s)}_`]=function(){return this.trigger(s)}}),it.registerComponent("Player",a);const u="plugin",c="activePlugins_",p={},g=s=>p.hasOwnProperty(s),A=s=>g(s)?p[s]:void 0,_=(s,e)=>{s[c]=s[c]||{},s[c][e]=!0},w=(s,e,i)=>{const r=(i?"before":"")+"pluginsetup";s.trigger(r,e),s.trigger(r+":"+e.name,e)},M=function(s,e){const i=function(){w(this,{name:s,plugin:e,instance:null},!0);const r=e.apply(this,arguments);return _(this,s),w(this,{name:s,plugin:e,instance:r}),r};return Object.keys(e).forEach(function(r){i[r]=e[r]}),i},z=(s,e)=>(e.prototype.name=s,function(...i){w(this,{name:s,plugin:e,instance:null},!0);const r=new e(...[this,...i]);return this[s]=()=>r,w(this,r.getEventHash()),r});class K{constructor(e){if(this.constructor===K)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=e,this.log||(this.log=this.player.log.createLogger(this.name)),Wo(this),delete this.trigger,Ja(this,this.constructor.defaultState),_(e,this.name),this.dispose=this.dispose.bind(this),e.on("dispose",this.dispose)}version(){return this.constructor.VERSION}getEventHash(e={}){return e.name=this.name,e.plugin=this.constructor,e.instance=this,e}trigger(e,i={}){return Kn(this.eventBusEl_,e,this.getEventHash(i))}handleStateChanged(e){}dispose(){const{name:e,player:i}=this;this.trigger("dispose"),this.off(),i.off("dispose",this.dispose),i[c][e]=!1,this.player=this.state=null,i[e]=z(e,p[e])}static isBasic(e){const i=typeof e=="string"?A(e):e;return typeof i=="function"&&!K.prototype.isPrototypeOf(i.prototype)}static registerPlugin(e,i){if(typeof e!="string")throw new Error(`Illegal plugin name, "${e}", must be a string, was ${typeof e}.`);if(g(e))ni.warn(`A plugin named "${e}" already exists. You may want to avoid re-registering plugins!`);else if(a.prototype.hasOwnProperty(e))throw new Error(`Illegal plugin name, "${e}", cannot share a name with an existing player method!`);if(typeof i!="function")throw new Error(`Illegal plugin for "${e}", must be a function, was ${typeof i}.`);return p[e]=i,e!==u&&(K.isBasic(i)?a.prototype[e]=M(e,i):a.prototype[e]=z(e,i)),i}static deregisterPlugin(e){if(e===u)throw new Error("Cannot de-register base plugin.");g(e)&&(delete p[e],delete a.prototype[e])}static getPlugins(e=Object.keys(p)){let i;return e.forEach(r=>{const l=A(r);l&&(i=i||{},i[r]=l)}),i}static getPluginVersion(e){const i=A(e);return i&&i.VERSION||""}}K.getPlugin=A,K.BASE_PLUGIN_NAME=u,K.registerPlugin(u,K),a.prototype.usingPlugin=function(s){return!!this[c]&&this[c][s]===!0},a.prototype.hasPlugin=function(s){return!!g(s)};function Z(s,e){let i=!1;return function(...r){return i||ni.warn(s),i=!0,e.apply(this,r)}}function ne(s,e,i,r){return Z(`${e} is deprecated and will be removed in ${s}.0; please use ${i} instead.`,r)}const xe=s=>s.indexOf("#")===0?s.slice(1):s;function de(s,e,i){let r=de.getPlayer(s);if(r)return e&&ni.warn(`Player "${s}" is already initialised. Options will not be applied.`),i&&r.ready(i),r;const l=typeof s=="string"?Ke("#"+xe(s)):s;if(!Vn(l))throw new TypeError("The element or ID supplied is not valid. (videojs)");const f=("getRootNode"in l?l.getRootNode()instanceof le().ShadowRoot:!1)?l.getRootNode():l.ownerDocument.body;(!l.ownerDocument.defaultView||!f.contains(l))&&ni.warn("The element supplied is not included in the DOM"),e=e||{},e.restoreEl===!0&&(e.restoreEl=(l.parentNode&&l.parentNode.hasAttribute("data-vjs-player")?l.parentNode:l).cloneNode(!0)),Pn("beforesetup").forEach(L=>{const B=L(l,ci(e));if(!tr(B)||Array.isArray(B)){ni.error("please return an object in beforesetup hooks");return}e=ci(e,B)});const y=it.getComponent("Player");return r=new y(l,e,i),Pn("setup").forEach(L=>L(r)),r}if(de.hooks_=mr,de.hooks=Pn,de.hook=Ul,de.hookOnce=jl,de.removeHook=Io,le().VIDEOJS_NO_DYNAMIC_STYLE!==!0&&Ur()){let s=Ke(".vjs-styles-defaults");if(!s){s=gi("vjs-styles-defaults");const e=Ke("head");e&&e.insertBefore(s,e.firstChild),br(s,`
      .video-js {
        width: 300px;
        height: 150px;
      }

      .vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: 56.25%
      }
    `)}}Ki(1,de),de.VERSION=ma,de.options=a.prototype.options_,de.getPlayers=()=>a.players,de.getPlayer=s=>{const e=a.players;let i;if(typeof s=="string"){const r=xe(s),l=e[r];if(l)return l;i=Ke("#"+r)}else i=s;if(Vn(i)){const{player:r,playerId:l}=i;if(r||e[l])return r||e[l]}},de.getAllPlayers=()=>Object.keys(a.players).map(s=>a.players[s]).filter(Boolean),de.players=a.players,de.getComponent=it.getComponent,de.registerComponent=(s,e)=>(si.isTech(e)&&ni.warn(`The ${s} tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)`),it.registerComponent.call(it,s,e)),de.getTech=si.getTech,de.registerTech=si.registerTech,de.use=tu,Object.defineProperty(de,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(de.middleware,"TERMINATOR",{value:sl,writeable:!1,enumerable:!0}),de.browser=Zr,de.obj=za,de.mergeOptions=ne(9,"videojs.mergeOptions","videojs.obj.merge",ci),de.defineLazyProperty=ne(9,"videojs.defineLazyProperty","videojs.obj.defineLazyProperty",_i),de.bind=ne(9,"videojs.bind","native Function.prototype.bind",Ci),de.registerPlugin=K.registerPlugin,de.deregisterPlugin=K.deregisterPlugin,de.plugin=(s,e)=>(ni.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),K.registerPlugin(s,e)),de.getPlugins=K.getPlugins,de.getPlugin=K.getPlugin,de.getPluginVersion=K.getPluginVersion,de.addLanguage=function(s,e){return s=(""+s).toLowerCase(),de.options.languages=ci(de.options.languages,{[s]:e}),de.options.languages[s]},de.log=ni,de.createLogger=vs,de.time=Dc,de.createTimeRange=ne(9,"videojs.createTimeRange","videojs.time.createTimeRanges",Wn),de.createTimeRanges=ne(9,"videojs.createTimeRanges","videojs.time.createTimeRanges",Wn),de.formatTime=ne(9,"videojs.formatTime","videojs.time.formatTime",xs),de.setFormatTime=ne(9,"videojs.setFormatTime","videojs.time.setFormatTime",zs),de.resetFormatTime=ne(9,"videojs.resetFormatTime","videojs.time.resetFormatTime",Qo),de.parseUrl=ne(9,"videojs.parseUrl","videojs.url.parseUrl",Ql),de.isCrossOrigin=ne(9,"videojs.isCrossOrigin","videojs.url.isCrossOrigin",eo),de.EventTarget=rr,de.any=Go,de.on=qn,de.one=Ge,de.off=_n,de.trigger=Kn,de.xhr=ie(),de.TextTrack=Es,de.AudioTrack=nl,de.VideoTrack=cd,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(s=>{de[s]=function(){return ni.warn(`videojs.${s}() is deprecated; use videojs.dom.${s}() instead`),Tt[s].apply(null,arguments)}}),de.computedStyle=ne(9,"videojs.computedStyle","videojs.dom.computedStyle",bt),de.dom=Tt,de.fn=od,de.num=$c,de.str=Yo,de.url=Sa;/*! @name videojs-contrib-quality-levels @version 4.0.0 @license Apache-2.0 */class Be{constructor(e){let i=this;return i.id=e.id,i.label=i.id,i.width=e.width,i.height=e.height,i.bitrate=e.bandwidth,i.frameRate=e.frameRate,i.enabled_=e.enabled,Object.defineProperty(i,"enabled",{get(){return i.enabled_()},set(r){i.enabled_(r)}}),i}}class Qe extends de.EventTarget{constructor(){super();let e=this;return e.levels_=[],e.selectedIndex_=-1,Object.defineProperty(e,"selectedIndex",{get(){return e.selectedIndex_}}),Object.defineProperty(e,"length",{get(){return e.levels_.length}}),e[Symbol.iterator]=()=>e.levels_.values(),e}addQualityLevel(e){let i=this.getQualityLevelById(e.id);if(i)return i;const r=this.levels_.length;return i=new Be(e),""+r in this||Object.defineProperty(this,r,{get(){return this.levels_[r]}}),this.levels_.push(i),this.trigger({qualityLevel:i,type:"addqualitylevel"}),i}removeQualityLevel(e){let i=null;for(let r=0,l=this.length;r<l;r++)if(this[r]===e){i=this.levels_.splice(r,1)[0],this.selectedIndex_===r?this.selectedIndex_=-1:this.selectedIndex_>r&&this.selectedIndex_--;break}return i&&this.trigger({qualityLevel:e,type:"removequalitylevel"}),i}getQualityLevelById(e){for(let i=0,r=this.length;i<r;i++){const l=this[i];if(l.id===e)return l}return null}dispose(){this.selectedIndex_=-1,this.levels_.length=0}}Qe.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"};for(const s in Qe.prototype.allowedEvents_)Qe.prototype["on"+s]=null;var Ne="4.0.0";const lt=function(s,e){const i=s.qualityLevels,r=new Qe,l=function(){r.dispose(),s.qualityLevels=i,s.off("dispose",l)};return s.on("dispose",l),s.qualityLevels=()=>r,s.qualityLevels.VERSION=Ne,r},Xe=function(s){return lt(this,de.obj.merge({},s))};de.registerPlugin("qualityLevels",Xe),Xe.VERSION=Ne;/*! @name @videojs/http-streaming @version 3.10.0 @license Apache-2.0 */const ct=O,Lt=(s,e)=>e&&e.responseURL&&s!==e.responseURL?e.responseURL:s,et=s=>de.log.debug?de.log.debug.bind(de,"VHS:",`${s} >`):function(){};function st(...s){const e=de.obj||de;return(e.merge||e.mergeOptions).apply(e,s)}function Ht(...s){const e=de.time||de;return(e.createTimeRanges||e.createTimeRanges).apply(e,s)}const St=1/30,zt=St*3,Zt=function(s,e){const i=[];let r;if(s&&s.length)for(r=0;r<s.length;r++)e(s.start(r),s.end(r))&&i.push([s.start(r),s.end(r)]);return Ht(i)},qt=function(s,e){return Zt(s,function(i,r){return i-zt<=e&&r+zt>=e})},hi=function(s,e){return Zt(s,function(i){return i-St>=e})},Bi=function(s){if(s.length<2)return Ht();const e=[];for(let i=1;i<s.length;i++){const r=s.end(i-1),l=s.start(i);e.push([r,l])}return Ht(e)},$t=function(s,e){let i=null,r=null,l=0;const d=[],f=[];if(!s||!s.length||!e||!e.length)return Ht();let y=s.length;for(;y--;)d.push({time:s.start(y),type:"start"}),d.push({time:s.end(y),type:"end"});for(y=e.length;y--;)d.push({time:e.start(y),type:"start"}),d.push({time:e.end(y),type:"end"});for(d.sort(function(L,B){return L.time-B.time}),y=0;y<d.length;y++)d[y].type==="start"?(l++,l===2&&(i=d[y].time)):d[y].type==="end"&&(l--,l===1&&(r=d[y].time)),i!==null&&r!==null&&(f.push([i,r]),i=null,r=null);return Ht(f)},Bt=s=>{const e=[];if(!s||!s.length)return"";for(let i=0;i<s.length;i++)e.push(s.start(i)+" => "+s.end(i));return e.join(", ")},Ei=function(s,e,i=1){return((s.length?s.end(s.length-1):0)-e)/i},ti=s=>{const e=[];for(let i=0;i<s.length;i++)e.push({start:s.start(i),end:s.end(i)});return e},Di=function(s,e){if(s===e)return!1;if(!s&&e||!e&&s||s.length!==e.length)return!0;for(let i=0;i<s.length;i++)if(s.start(i)!==e.start(i)||s.end(i)!==e.end(i))return!0;return!1},tn=function(s){if(!(!s||!s.length||!s.end))return s.end(s.length-1)},sn=function(s,e){let i=0;if(!s||!s.length)return i;for(let r=0;r<s.length;r++){const l=s.start(r),d=s.end(r);if(!(e>d)){if(e>l&&e<=d){i+=d-e;continue}i+=d-l}}return i},hn=(s,e)=>{if(!e.preload)return e.duration;let i=0;return(e.parts||[]).forEach(function(r){i+=r.duration}),(e.preloadHints||[]).forEach(function(r){r.type==="PART"&&(i+=s.partTargetDuration)}),i},Nn=s=>(s.segments||[]).reduce((e,i,r)=>(i.parts?i.parts.forEach(function(l,d){e.push({duration:l.duration,segmentIndex:r,partIndex:d,part:l,segment:i})}):e.push({duration:i.duration,segmentIndex:r,partIndex:null,segment:i,part:null}),e),[]),wa=s=>{const e=s.segments&&s.segments.length&&s.segments[s.segments.length-1];return e&&e.parts||[]},vl=({preloadSegment:s})=>{if(!s)return;const{parts:e,preloadHints:i}=s;let r=(i||[]).reduce((l,d)=>l+(d.type==="PART"?1:0),0);return r+=e&&e.length?e.length:0,r},Hh=(s,e)=>{if(e.endList)return 0;if(s&&s.suggestedPresentationDelay)return s.suggestedPresentationDelay;const i=wa(e).length>0;return i&&e.serverControl&&e.serverControl.partHoldBack?e.serverControl.partHoldBack:i&&e.partTargetDuration?e.partTargetDuration*3:e.serverControl&&e.serverControl.holdBack?e.serverControl.holdBack:e.targetDuration?e.targetDuration*3:0},n0=function(s,e){let i=0,r=e-s.mediaSequence,l=s.segments[r];if(l){if(typeof l.start!="undefined")return{result:l.start,precise:!0};if(typeof l.end!="undefined")return{result:l.end-l.duration,precise:!0}}for(;r--;){if(l=s.segments[r],typeof l.end!="undefined")return{result:i+l.end,precise:!0};if(i+=hn(s,l),typeof l.start!="undefined")return{result:i+l.start,precise:!0}}return{result:i,precise:!1}},r0=function(s,e){let i=0,r,l=e-s.mediaSequence;for(;l<s.segments.length;l++){if(r=s.segments[l],typeof r.start!="undefined")return{result:r.start-i,precise:!0};if(i+=hn(s,r),typeof r.end!="undefined")return{result:r.end-i,precise:!0}}return{result:-1,precise:!1}},qh=function(s,e,i){if(typeof e=="undefined"&&(e=s.mediaSequence+s.segments.length),e<s.mediaSequence)return 0;const r=n0(s,e);if(r.precise)return r.result;const l=r0(s,e);return l.precise?l.result:r.result+i},Kh=function(s,e,i){if(!s)return 0;if(typeof i!="number"&&(i=0),typeof e=="undefined"){if(s.totalDuration)return s.totalDuration;if(!s.endList)return le()[Infinity]}return qh(s,e,i)},Mu=function({defaultDuration:s,durationList:e,startIndex:i,endIndex:r}){let l=0;if(i>r&&([i,r]=[r,i]),i<0){for(let d=i;d<Math.min(0,r);d++)l+=s;i=0}for(let d=i;d<r;d++)l+=e[d].duration;return l},Wh=function(s,e,i,r){if(!s||!s.segments)return null;if(s.endList)return Kh(s);if(e===null)return null;e=e||0;let l=qh(s,s.mediaSequence+s.segments.length,e);return i&&(r=typeof r=="number"?r:Hh(null,s),l-=r),Math.max(0,l)},s0=function(s,e,i){const r=!0,l=e||0;let d=Wh(s,e,r,i);return d===null?Ht():(d<l&&(d=l),Ht(l,d))},a0=function({playlist:s,currentTime:e,startingSegmentIndex:i,startingPartIndex:r,startTime:l,exactManifestTimings:d}){let f=e-l;const y=Nn(s);let L=0;for(let B=0;B<y.length;B++){const W=y[B];if(i===W.segmentIndex&&!(typeof r=="number"&&typeof W.partIndex=="number"&&r!==W.partIndex)){L=B;break}}if(f<0){if(L>0)for(let B=L-1;B>=0;B--){const W=y[B];if(f+=W.duration,d){if(f<0)continue}else if(f+St<=0)continue;return{partIndex:W.partIndex,segmentIndex:W.segmentIndex,startTime:l-Mu({defaultDuration:s.targetDuration,durationList:y,startIndex:L,endIndex:B})}}return{partIndex:y[0]&&y[0].partIndex||null,segmentIndex:y[0]&&y[0].segmentIndex||0,startTime:e}}if(L<0){for(let B=L;B<0;B++)if(f-=s.targetDuration,f<0)return{partIndex:y[0]&&y[0].partIndex||null,segmentIndex:y[0]&&y[0].segmentIndex||0,startTime:e};L=0}for(let B=L;B<y.length;B++){const W=y[B];f-=W.duration;const ce=W.duration>St,ke=f===0,Pe=ce&&f+St>=0;if(!((ke||Pe)&&B!==y.length-1)){if(d){if(f>0)continue}else if(f-St>=0)continue;return{partIndex:W.partIndex,segmentIndex:W.segmentIndex,startTime:l+Mu({defaultDuration:s.targetDuration,durationList:y,startIndex:L,endIndex:B})}}}return{segmentIndex:y[y.length-1].segmentIndex,partIndex:y[y.length-1].partIndex,startTime:e}},zh=function(s){return s.excludeUntil&&s.excludeUntil>Date.now()},ih=function(s){return s.excludeUntil&&s.excludeUntil===Infinity},Wd=function(s){const e=zh(s);return!s.disabled&&!e},o0=function(s){return s.disabled},l0=function(s){for(let e=0;e<s.segments.length;e++)if(s.segments[e].key)return!0;return!1},Yh=function(s,e){return e.attributes&&e.attributes[s]},u0=function(s,e,i,r=0){return Yh("BANDWIDTH",i)?(s*i.attributes.BANDWIDTH-r*8)/e:NaN},nh=(s,e)=>{if(s.playlists.length===1)return!0;const i=e.attributes.BANDWIDTH||Number.MAX_VALUE;return s.playlists.filter(r=>Wd(r)?(r.attributes.BANDWIDTH||0)<i:!1).length===0},rh=(s,e)=>!s&&!e||!s&&e||s&&!e?!1:!!(s===e||s.id&&e.id&&s.id===e.id||s.resolvedUri&&e.resolvedUri&&s.resolvedUri===e.resolvedUri||s.uri&&e.uri&&s.uri===e.uri),Xh=function(s,e){const i=s&&s.mediaGroups&&s.mediaGroups.AUDIO||{};let r=!1;for(const l in i){for(const d in i[l])if(r=e(i[l][d]),r)break;if(r)break}return!!r},Fu=s=>{if(!s||!s.playlists||!s.playlists.length)return Xh(s,i=>i.playlists&&i.playlists.length||i.uri);for(let e=0;e<s.playlists.length;e++){const i=s.playlists[e],r=i.attributes&&i.attributes.CODECS;if(!(r&&r.split(",").every(d=>rt(d))||Xh(s,d=>rh(i,d))))return!1}return!0};var or={liveEdgeDelay:Hh,duration:Kh,seekable:s0,getMediaInfoForTime:a0,isEnabled:Wd,isDisabled:o0,isExcluded:zh,isIncompatible:ih,playlistEnd:Wh,isAes:l0,hasAttribute:Yh,estimateSegmentRequestTime:u0,isLowestEnabledRendition:nh,isAudioOnly:Fu,playlistMatch:rh,segmentDurationWithParts:hn};const{log:Qh}=de,Al=(s,e)=>`${s}-${e}`,Jh=(s,e,i)=>`placeholder-uri-${s}-${e}-${i}`,d0=({onwarn:s,oninfo:e,manifestString:i,customTagParsers:r=[],customTagMappers:l=[],llhls:d})=>{const f=new Ce;s&&f.on("warn",s),e&&f.on("info",e),r.forEach(B=>f.addParser(B)),l.forEach(B=>f.addTagMapper(B)),f.push(i),f.end();const y=f.manifest;if(d||(["preloadSegment","skip","serverControl","renditionReports","partInf","partTargetDuration"].forEach(function(B){y.hasOwnProperty(B)&&delete y[B]}),y.segments&&y.segments.forEach(function(B){["parts","preloadHints"].forEach(function(W){B.hasOwnProperty(W)&&delete B[W]})})),!y.targetDuration){let B=10;y.segments&&y.segments.length&&(B=y.segments.reduce((W,ce)=>Math.max(W,ce.duration),0)),s&&s({message:`manifest has no targetDuration defaulting to ${B}`}),y.targetDuration=B}const L=wa(y);if(L.length&&!y.partTargetDuration){const B=L.reduce((W,ce)=>Math.max(W,ce.duration),0);s&&(s({message:`manifest has no partTargetDuration defaulting to ${B}`}),Qh.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")),y.partTargetDuration=B}return y},bl=(s,e)=>{!s.mediaGroups||["AUDIO","SUBTITLES"].forEach(i=>{if(!!s.mediaGroups[i])for(const r in s.mediaGroups[i])for(const l in s.mediaGroups[i][r]){const d=s.mediaGroups[i][r][l];e(d,i,r,l)}})},Zh=({playlist:s,uri:e,id:i})=>{s.id=i,s.playlistErrors_=0,e&&(s.uri=e),s.attributes=s.attributes||{}},c0=s=>{let e=s.playlists.length;for(;e--;){const i=s.playlists[e];Zh({playlist:i,id:Al(e,i.uri)}),i.resolvedUri=ct(s.uri,i.uri),s.playlists[i.id]=i,s.playlists[i.uri]=i,i.attributes.BANDWIDTH||Qh.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}},h0=s=>{bl(s,e=>{e.uri&&(e.resolvedUri=ct(s.uri,e.uri))})},f0=(s,e)=>{const i=Al(0,e),r={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:le().location.href,resolvedUri:le().location.href,playlists:[{uri:e,id:i,resolvedUri:e,attributes:{}}]};return r.playlists[i]=r.playlists[0],r.playlists[e]=r.playlists[0],r},ef=(s,e,i=Jh)=>{s.uri=e;for(let l=0;l<s.playlists.length;l++)if(!s.playlists[l].uri){const d=`placeholder-uri-${l}`;s.playlists[l].uri=d}const r=Fu(s);bl(s,(l,d,f,y)=>{if(!l.playlists||!l.playlists.length){if(r&&d==="AUDIO"&&!l.uri)for(let L=0;L<s.playlists.length;L++){const B=s.playlists[L];if(B.attributes&&B.attributes.AUDIO&&B.attributes.AUDIO===f)return}l.playlists=[(0,v.Z)({},l)]}l.playlists.forEach(function(L,B){const W=i(d,f,y,L),ce=Al(B,W);L.uri?L.resolvedUri=L.resolvedUri||ct(s.uri,L.uri):(L.uri=B===0?W:ce,L.resolvedUri=L.uri),L.id=L.id||ce,L.attributes=L.attributes||{},s.playlists[L.id]=L,s.playlists[L.uri]=L})}),c0(s),h0(s)};class tf{constructor(){this.offset_=null,this.pendingDateRanges_=new Map,this.processedDateRanges_=new Map}setOffset(e=[]){if(this.offset_!==null||!e.length)return;const[i]=e;i.programDateTime!==void 0&&(this.offset_=i.programDateTime/1e3)}setPendingDateRanges(e=[]){if(!e.length)return;const[i]=e,r=i.startDate.getTime();this.trimProcessedDateRanges_(r),this.pendingDateRanges_=e.reduce((l,d)=>(l.set(d.id,d),l),new Map)}processDateRange(e){this.pendingDateRanges_.delete(e.id),this.processedDateRanges_.set(e.id,e)}getDateRangesToProcess(){if(this.offset_===null)return[];const e={},i=[];this.pendingDateRanges_.forEach((r,l)=>{if(!this.processedDateRanges_.has(l)&&(r.startTime=r.startDate.getTime()/1e3-this.offset_,r.processDateRange=()=>this.processDateRange(r),i.push(r),!!r.class))if(e[r.class]){const d=e[r.class].push(r);r.classListIndex=d-1}else e[r.class]=[r],r.classListIndex=0});for(const r of i){const l=e[r.class]||[];r.endDate?r.endTime=r.endDate.getTime()/1e3-this.offset_:r.endOnNext&&l[r.classListIndex+1]?r.endTime=l[r.classListIndex+1].startTime:r.duration?r.endTime=r.startTime+r.duration:r.plannedDuration?r.endTime=r.startTime+r.plannedDuration:r.endTime=r.startTime}return i}trimProcessedDateRanges_(e){new Map(this.processedDateRanges_).forEach((r,l)=>{r.startDate.getTime()<e&&this.processedDateRanges_.delete(l)})}}const{EventTarget:p0}=de,m0=(s,e)=>{if(e.endList||!e.serverControl)return s;const i={};if(e.serverControl.canBlockReload){const{preloadSegment:r}=e;let l=e.mediaSequence+e.segments.length;if(r){const d=r.parts||[],f=vl(e)-1;f>-1&&f!==d.length-1&&(i._HLS_part=f),(f>-1||d.length)&&l--}i._HLS_msn=l}if(e.serverControl&&e.serverControl.canSkipUntil&&(i._HLS_skip=e.serverControl.canSkipDateranges?"v2":"YES"),Object.keys(i).length){const r=new(le()).URL(s);["_HLS_skip","_HLS_msn","_HLS_part"].forEach(function(l){!i.hasOwnProperty(l)||r.searchParams.set(l,i[l])}),s=r.toString()}return s},g0=(s,e)=>{if(!s)return e;const i=st(s,e);if(s.preloadHints&&!e.preloadHints&&delete i.preloadHints,s.parts&&!e.parts)delete i.parts;else if(s.parts&&e.parts)for(let r=0;r<e.parts.length;r++)s.parts&&s.parts[r]&&(i.parts[r]=st(s.parts[r],e.parts[r]));return!s.skipped&&e.skipped&&(i.skipped=!1),s.preload&&!e.preload&&(i.preload=!1),i},y0=(s,e,i)=>{const r=s.slice(),l=e.slice();i=i||0;const d=[];let f;for(let y=0;y<l.length;y++){const L=r[y+i],B=l[y];L?(f=L.map||f,d.push(g0(L,B))):(f&&!B.map&&(B.map=f),d.push(B))}return d},nf=(s,e)=>{!s.resolvedUri&&s.uri&&(s.resolvedUri=ct(e,s.uri)),s.key&&!s.key.resolvedUri&&(s.key.resolvedUri=ct(e,s.key.uri)),s.map&&!s.map.resolvedUri&&(s.map.resolvedUri=ct(e,s.map.uri)),s.map&&s.map.key&&!s.map.key.resolvedUri&&(s.map.key.resolvedUri=ct(e,s.map.key.uri)),s.parts&&s.parts.length&&s.parts.forEach(i=>{i.resolvedUri||(i.resolvedUri=ct(e,i.uri))}),s.preloadHints&&s.preloadHints.length&&s.preloadHints.forEach(i=>{i.resolvedUri||(i.resolvedUri=ct(e,i.uri))})},rf=function(s){const e=s.segments||[],i=s.preloadSegment;if(i&&i.parts&&i.parts.length){if(i.preloadHints){for(let r=0;r<i.preloadHints.length;r++)if(i.preloadHints[r].type==="MAP")return e}i.duration=s.targetDuration,i.preload=!0,e.push(i)}return e},sf=(s,e)=>s===e||s.segments&&e.segments&&s.segments.length===e.segments.length&&s.endList===e.endList&&s.mediaSequence===e.mediaSequence&&s.preloadSegment===e.preloadSegment,sh=(s,e,i=sf)=>{const r=st(s,{}),l=r.playlists[e.id];if(!l||i(l,e))return null;e.segments=rf(e);const d=st(l,e);if(d.preloadSegment&&!e.preloadSegment&&delete d.preloadSegment,l.segments){if(e.skip){e.segments=e.segments||[];for(let f=0;f<e.skip.skippedSegments;f++)e.segments.unshift({skipped:!0})}d.segments=y0(l.segments,e.segments,e.mediaSequence-l.mediaSequence)}d.segments.forEach(f=>{nf(f,d.resolvedUri)});for(let f=0;f<r.playlists.length;f++)r.playlists[f].id===e.id&&(r.playlists[f]=d);return r.playlists[e.id]=d,r.playlists[e.uri]=d,bl(s,(f,y,L,B)=>{if(!!f.playlists)for(let W=0;W<f.playlists.length;W++)e.id===f.playlists[W].id&&(f.playlists[W]=d)}),r},ah=(s,e)=>{const i=s.segments||[],r=i[i.length-1],l=r&&r.parts&&r.parts[r.parts.length-1],d=l&&l.duration||r&&r.duration;return e&&d?d*1e3:(s.partTargetDuration||s.targetDuration||10)*500};class _l extends p0{constructor(e,i,r={}){super();if(!e)throw new Error("A non-empty playlist URL or object is required");this.logger_=et("PlaylistLoader");const{withCredentials:l=!1}=r;this.src=e,this.vhs_=i,this.withCredentials=l,this.addDateRangesToTextTrack_=r.addDateRangesToTextTrack;const d=i.options_;this.customTagParsers=d&&d.customTagParsers||[],this.customTagMappers=d&&d.customTagMappers||[],this.llhls=d&&d.llhls,this.dateRangesStorage_=new tf,this.state="HAVE_NOTHING",this.handleMediaupdatetimeout_=this.handleMediaupdatetimeout_.bind(this),this.on("mediaupdatetimeout",this.handleMediaupdatetimeout_),this.on("loadedplaylist",this.handleLoadedPlaylist_.bind(this))}handleLoadedPlaylist_(){const e=this.media();if(!e)return;this.dateRangesStorage_.setOffset(e.segments),this.dateRangesStorage_.setPendingDateRanges(e.dateRanges);const i=this.dateRangesStorage_.getDateRangesToProcess();!i.length||!this.addDateRangesToTextTrack_||this.addDateRangesToTextTrack_(i)}handleMediaupdatetimeout_(){if(this.state!=="HAVE_METADATA")return;const e=this.media();let i=ct(this.main.uri,e.uri);this.llhls&&(i=m0(i,e)),this.state="HAVE_CURRENT_METADATA",this.request=this.vhs_.xhr({uri:i,withCredentials:this.withCredentials},(r,l)=>{if(!!this.request){if(r)return this.playlistRequestError(this.request,this.media(),"HAVE_METADATA");this.haveMetadata({playlistString:this.request.responseText,url:this.media().uri,id:this.media().id})}})}playlistRequestError(e,i,r){const{uri:l,id:d}=i;this.request=null,r&&(this.state=r),this.error={playlist:this.main.playlists[d],status:e.status,message:`HLS playlist request error at URL: ${l}.`,responseText:e.responseText,code:e.status>=500?4:2},this.trigger("error")}parseManifest_({url:e,manifestString:i}){return d0({onwarn:({message:r})=>this.logger_(`m3u8-parser warn for ${e}: ${r}`),oninfo:({message:r})=>this.logger_(`m3u8-parser info for ${e}: ${r}`),manifestString:i,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,llhls:this.llhls})}haveMetadata({playlistString:e,playlistObject:i,url:r,id:l}){this.request=null,this.state="HAVE_METADATA";const d=i||this.parseManifest_({url:r,manifestString:e});d.lastRequest=Date.now(),Zh({playlist:d,uri:r,id:l});const f=sh(this.main,d);this.targetDuration=d.partTargetDuration||d.targetDuration,this.pendingMedia_=null,f?(this.main=f,this.media_=this.main.playlists[l]):this.trigger("playlistunchanged"),this.updateMediaUpdateTimeout_(ah(this.media(),!!f)),this.trigger("loadedplaylist")}dispose(){this.trigger("dispose"),this.stopRequest(),le().clearTimeout(this.mediaUpdateTimeout),le().clearTimeout(this.finalRenditionTimeout),this.dateRangesStorage_=new tf,this.off()}stopRequest(){if(this.request){const e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}media(e,i){if(!e)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);if(typeof e=="string"){if(!this.main.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.main.playlists[e]}if(le().clearTimeout(this.finalRenditionTimeout),i){const f=(e.partTargetDuration||e.targetDuration)/2*1e3||5*1e3;this.finalRenditionTimeout=le().setTimeout(this.media.bind(this,e,!1),f);return}const r=this.state,l=!this.media_||e.id!==this.media_.id,d=this.main.playlists[e.id];if(d&&d.endList||e.endList&&e.segments.length){this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=e,l&&(this.trigger("mediachanging"),r==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange"));return}if(this.updateMediaUpdateTimeout_(ah(e,!0)),!!l){if(this.state="SWITCHING_MEDIA",this.request){if(e.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.pendingMedia_=e,this.request=this.vhs_.xhr({uri:e.resolvedUri,withCredentials:this.withCredentials},(f,y)=>{if(!!this.request){if(e.lastRequest=Date.now(),e.resolvedUri=Lt(e.resolvedUri,y),f)return this.playlistRequestError(this.request,e,r);this.haveMetadata({playlistString:y.responseText,url:e.uri,id:e.id}),r==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange")}})}}pause(){this.mediaUpdateTimeout&&(le().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.stopRequest(),this.state==="HAVE_NOTHING"&&(this.started=!1),this.state==="SWITCHING_MEDIA"?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MAIN_MANIFEST":this.state==="HAVE_CURRENT_METADATA"&&(this.state="HAVE_METADATA")}load(e){this.mediaUpdateTimeout&&(le().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null);const i=this.media();if(e){const r=i?(i.partTargetDuration||i.targetDuration)/2*1e3:5*1e3;this.mediaUpdateTimeout=le().setTimeout(()=>{this.mediaUpdateTimeout=null,this.load()},r);return}if(!this.started){this.start();return}i&&!i.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist")}updateMediaUpdateTimeout_(e){this.mediaUpdateTimeout&&(le().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),!(!this.media()||this.media().endList)&&(this.mediaUpdateTimeout=le().setTimeout(()=>{this.mediaUpdateTimeout=null,this.trigger("mediaupdatetimeout"),this.updateMediaUpdateTimeout_(e)},e))}start(){if(this.started=!0,typeof this.src=="object"){this.src.uri||(this.src.uri=le().location.href),this.src.resolvedUri=this.src.uri,setTimeout(()=>{this.setupInitialPlaylist(this.src)},0);return}this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials},(e,i)=>{if(!this.request)return;if(this.request=null,e)return this.error={status:i.status,message:`HLS playlist request error at URL: ${this.src}.`,responseText:i.responseText,code:2},this.state==="HAVE_NOTHING"&&(this.started=!1),this.trigger("error");this.src=Lt(this.src,i);const r=this.parseManifest_({manifestString:i.responseText,url:this.src});this.setupInitialPlaylist(r)})}srcUri(){return typeof this.src=="string"?this.src:this.src.uri}setupInitialPlaylist(e){if(this.state="HAVE_MAIN_MANIFEST",e.playlists){this.main=e,ef(this.main,this.srcUri()),e.playlists.forEach(r=>{r.segments=rf(r),r.segments.forEach(l=>{nf(l,r.resolvedUri)})}),this.trigger("loadedplaylist"),this.request||this.media(this.main.playlists[0]);return}const i=this.srcUri()||le().location.href;this.main=f0(e,i),this.haveMetadata({playlistObject:e,url:i,id:this.main.playlists[0].id}),this.trigger("loadedmetadata")}updateOrDeleteClone(e,i){const r=this.main,l=e.ID;let d=r.playlists.length;for(;d--;){const f=r.playlists[d];if(f.attributes["PATHWAY-ID"]===l){const y=f.resolvedUri,L=f.id;if(i){const B=this.createCloneURI_(f.resolvedUri,e),W=Al(l,B),ce=this.createCloneAttributes_(l,f.attributes),ke=this.createClonePlaylist_(f,W,e,ce);r.playlists[d]=ke,r.playlists[W]=ke,r.playlists[B]=ke}else r.playlists.splice(d,1);delete r.playlists[L],delete r.playlists[y]}}this.updateOrDeleteCloneMedia(e,i)}updateOrDeleteCloneMedia(e,i){const r=this.main,l=e.ID;["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(d=>{if(!(!r.mediaGroups[d]||!r.mediaGroups[d][l])){for(const f in r.mediaGroups[d])if(f===l){for(const y in r.mediaGroups[d][f])r.mediaGroups[d][f][y].playlists.forEach((B,W)=>{const ce=r.playlists[B.id],ke=ce.id,Pe=ce.resolvedUri;delete r.playlists[ke],delete r.playlists[Pe]});delete r.mediaGroups[d][f]}}}),i&&this.createClonedMediaGroups_(e)}addClonePathway(e,i={}){const r=this.main,l=r.playlists.length,d=this.createCloneURI_(i.resolvedUri,e),f=Al(e.ID,d),y=this.createCloneAttributes_(e.ID,i.attributes),L=this.createClonePlaylist_(i,f,e,y);r.playlists[l]=L,r.playlists[f]=L,r.playlists[d]=L,this.createClonedMediaGroups_(e)}createClonedMediaGroups_(e){const i=e.ID,r=e["BASE-ID"],l=this.main;["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(d=>{if(!(!l.mediaGroups[d]||l.mediaGroups[d][i]))for(const f in l.mediaGroups[d]){if(f===r)l.mediaGroups[d][i]={};else continue;for(const y in l.mediaGroups[d][f]){const L=l.mediaGroups[d][f][y];l.mediaGroups[d][i][y]=(0,v.Z)({},L);const B=l.mediaGroups[d][i][y],W=this.createCloneURI_(L.resolvedUri,e);B.resolvedUri=W,B.uri=W,B.playlists=[],L.playlists.forEach((ce,ke)=>{const Pe=l.playlists[ce.id],be=Jh(d,i,y),je=Al(i,be);if(Pe&&!l.playlists[je]){const We=this.createClonePlaylist_(Pe,je,e),Je=We.resolvedUri;l.playlists[je]=We,l.playlists[Je]=We}B.playlists[ke]=this.createClonePlaylist_(ce,je,e)})}}})}createClonePlaylist_(e,i,r,l){const d=this.createCloneURI_(e.resolvedUri,r),f={resolvedUri:d,uri:d,id:i};return e.segments&&(f.segments=[]),l&&(f.attributes=l),st(e,f)}createCloneURI_(e,i){const r=new URL(e);r.hostname=i["URI-REPLACEMENT"].HOST;const l=i["URI-REPLACEMENT"].PARAMS;for(const d of Object.keys(l))r.searchParams.set(d,l[d]);return r.href}createCloneAttributes_(e,i){const r={["PATHWAY-ID"]:e};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(l=>{i[l]&&(r[l]=e)}),r}getKeyIdSet(e){if(e.contentProtection){const i=new Set;for(const r in e.contentProtection){const l=e.contentProtection[r].attributes.keyId;l&&i.add(l.toLowerCase())}return i}}}const{xhr:v0}=de,oh=function(s,e,i,r){const l=s.responseType==="arraybuffer"?s.response:s.responseText;!e&&l&&(s.responseTime=Date.now(),s.roundTripTime=s.responseTime-s.requestTime,s.bytesReceived=l.byteLength||l.length,s.bandwidth||(s.bandwidth=Math.floor(s.bytesReceived/s.roundTripTime*8*1e3))),i.headers&&(s.responseHeaders=i.headers),e&&e.code==="ETIMEDOUT"&&(s.timedout=!0),!e&&!s.aborted&&i.statusCode!==200&&i.statusCode!==206&&i.statusCode!==0&&(e=new Error("XHR Failed with a response of: "+(s&&(l||s.responseText)))),r(e,s)},A0=(s,e)=>{if(!s||!s.size)return;let i=e;return s.forEach(r=>{i=r(i)}),i},b0=(s,e,i,r)=>{!s||!s.size||s.forEach(l=>{l(e,i,r)})},af=function(){const s=function e(i,r){i=st({timeout:45e3},i);const l=e.beforeRequest||de.Vhs.xhr.beforeRequest,d=e._requestCallbackSet||de.Vhs.xhr._requestCallbackSet||new Set,f=e._responseCallbackSet||de.Vhs.xhr._responseCallbackSet;l&&typeof l=="function"&&(de.log.warn("beforeRequest is deprecated, use onRequest instead."),d.add(l));const y=de.Vhs.xhr.original===!0?v0:de.Vhs.xhr,L=A0(d,i);d.delete(l);const B=y(L||i,function(ce,ke){return b0(f,B,ce,ke),oh(B,ce,ke,r)}),W=B.abort;return B.abort=function(){return B.aborted=!0,W.apply(B,arguments)},B.uri=i.uri,B.requestTime=Date.now(),B};return s.original=!0,s},_0=function(s){let e;const i=s.offset;return typeof s.offset=="bigint"||typeof s.length=="bigint"?e=le().BigInt(s.offset)+le().BigInt(s.length)-le().BigInt(1):e=s.offset+s.length-1,"bytes="+i+"-"+e},lh=function(s){const e={};return s.byterange&&(e.Range=_0(s.byterange)),e},x0=function(s,e){return s.start(e)+"-"+s.end(e)},E0=function(s,e){const i=s.toString(16);return"00".substring(0,2-i.length)+i+(e%2?" ":"")},T0=function(s){return s>=32&&s<126?String.fromCharCode(s):"."},of=function(s){const e={};return Object.keys(s).forEach(i=>{const r=s[i];en(r)?e[i]={bytes:r.buffer,byteOffset:r.byteOffset,byteLength:r.byteLength}:e[i]=r}),e},zd=function(s){const e=s.byterange||{length:Infinity,offset:0};return[e.length,e.offset,s.resolvedUri].join(",")},lf=function(s){return s.resolvedUri},uf=s=>{const e=Array.prototype.slice.call(s),i=16;let r="",l,d;for(let f=0;f<e.length/i;f++)l=e.slice(f*i,f*i+i).map(E0).join(""),d=e.slice(f*i,f*i+i).map(T0).join(""),r+=l+" "+d+`
`;return r};var S0=Object.freeze({__proto__:null,createTransferableMessage:of,initSegmentId:zd,segmentKeyId:lf,hexDump:uf,tagDump:({bytes:s})=>uf(s),textRanges:s=>{let e="",i;for(i=0;i<s.length;i++)e+=x0(s,i)+" ";return e}});const df=.25,C0=(s,e)=>{if(!e.dateTimeObject)return null;const i=e.videoTimingInfo.transmuxerPrependedSeconds,l=e.videoTimingInfo.transmuxedPresentationStart+i,d=s-l;return new Date(e.dateTimeObject.getTime()+d*1e3)},w0=s=>s.transmuxedPresentationEnd-s.transmuxedPresentationStart-s.transmuxerPrependedSeconds,L0=(s,e)=>{let i;try{i=new Date(s)}catch(L){return null}if(!e||!e.segments||e.segments.length===0)return null;let r=e.segments[0];if(i<new Date(r.dateTimeObject))return null;for(let L=0;L<e.segments.length-1;L++){r=e.segments[L];const B=new Date(e.segments[L+1].dateTimeObject);if(i<B)break}const l=e.segments[e.segments.length-1],d=l.dateTimeObject,f=l.videoTimingInfo?w0(l.videoTimingInfo):l.duration+l.duration*df,y=new Date(d.getTime()+f*1e3);return i>y?null:(i>new Date(d)&&(r=l),{segment:r,estimatedStart:r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationStart:or.duration(e,e.mediaSequence+e.segments.indexOf(r)),type:r.videoTimingInfo?"accurate":"estimate"})},D0=(s,e)=>{if(!e||!e.segments||e.segments.length===0)return null;let i=0,r;for(let d=0;d<e.segments.length&&(r=e.segments[d],i=r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationEnd:i+r.duration,!(s<=i));d++);const l=e.segments[e.segments.length-1];if(l.videoTimingInfo&&l.videoTimingInfo.transmuxedPresentationEnd<s)return null;if(s>i){if(s>i+l.duration*df)return null;r=l}return{segment:r,estimatedStart:r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationStart:i-r.duration,type:r.videoTimingInfo?"accurate":"estimate"}},k0=(s,e)=>{let i,r;try{i=new Date(s),r=new Date(e)}catch(f){}const l=i.getTime();return(r.getTime()-l)/1e3},I0=s=>{if(!s.segments||s.segments.length===0)return!1;for(let e=0;e<s.segments.length;e++)if(!s.segments[e].dateTimeObject)return!1;return!0},R0=({playlist:s,time:e=void 0,callback:i})=>{if(!i)throw new Error("getProgramTime: callback must be provided");if(!s||e===void 0)return i({message:"getProgramTime: playlist and time must be provided"});const r=D0(e,s);if(!r)return i({message:"valid programTime was not found"});if(r.type==="estimate")return i({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:r.estimatedStart});const l={mediaSeconds:e},d=C0(e,r.segment);return d&&(l.programDateTime=d.toISOString()),i(null,l)},cf=({programTime:s,playlist:e,retryCount:i=2,seekTo:r,pauseAfterSeek:l=!0,tech:d,callback:f})=>{if(!f)throw new Error("seekToProgramTime: callback must be provided");if(typeof s=="undefined"||!e||!r)return f({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!e.endList&&!d.hasStarted_)return f({message:"player must be playing a live stream to start buffering"});if(!I0(e))return f({message:"programDateTime tags must be provided in the manifest "+e.resolvedUri});const y=L0(s,e);if(!y)return f({message:`${s} was not found in the stream`});const L=y.segment,B=k0(L.dateTimeObject,s);if(y.type==="estimate"){if(i===0)return f({message:`${s} is not buffered yet. Try again`});r(y.estimatedStart+B),d.one("seeked",()=>{cf({programTime:s,playlist:e,retryCount:i-1,seekTo:r,pauseAfterSeek:l,tech:d,callback:f})});return}const W=L.start+B,ce=()=>f(null,d.currentTime());d.one("seeked",ce),l&&d.pause(),r(W)},uh=(s,e)=>{if(s.readyState===4)return e()},P0=(s,e,i)=>{let r=[],l,d=!1;const f=function(W,ce,ke,Pe){return ce.abort(),d=!0,i(W,ce,ke,Pe)},y=function(W,ce){if(d)return;if(W)return f(W,ce,"",r);const ke=ce.responseText.substring(r&&r.byteLength||0,ce.responseText.length);if(r=Ct(r,yt(ke,!0)),l=l||Ms(r),r.length<10||l&&r.length<l+2)return uh(ce,()=>f(W,ce,"",r));const Pe=Br(r);return Pe==="ts"&&r.length<188?uh(ce,()=>f(W,ce,"",r)):!Pe&&r.length<376?uh(ce,()=>f(W,ce,"",r)):f(null,ce,Pe,r)},B=e({uri:s,beforeSend(W){W.overrideMimeType("text/plain; charset=x-user-defined"),W.addEventListener("progress",function({total:ce,loaded:ke}){return oh(W,null,{statusCode:W.status},y)})}},function(W,ce){return oh(B,W,ce,y)});return B},{EventTarget:O0}=de,hf=function(s,e){if(!sf(s,e)||s.sidx&&e.sidx&&(s.sidx.offset!==e.sidx.offset||s.sidx.length!==e.sidx.length))return!1;if(!s.sidx&&e.sidx||s.sidx&&!e.sidx||s.segments&&!e.segments||!s.segments&&e.segments)return!1;if(!s.segments&&!e.segments)return!0;for(let i=0;i<s.segments.length;i++){const r=s.segments[i],l=e.segments[i];if(r.uri!==l.uri)return!1;if(!r.byterange&&!l.byterange)continue;const d=r.byterange,f=l.byterange;if(d&&!f||!d&&f||d.offset!==f.offset||d.length!==f.length)return!1}return!0},B0=(s,e,i,r)=>{const l=r.attributes.NAME||i;return`placeholder-uri-${s}-${e}-${l}`},M0=({mainXml:s,srcUrl:e,clientOffset:i,sidxMapping:r,previousManifest:l})=>{const d=$n(s,{manifestUri:e,clientOffset:i,sidxMapping:r,previousManifest:l});return ef(d,e,B0),d},F0=(s,e)=>{bl(s,(i,r,l,d)=>{d in e.mediaGroups[r][l]||delete s.mediaGroups[r][l][d]})},N0=(s,e,i)=>{let r=!0,l=st(s,{duration:e.duration,minimumUpdatePeriod:e.minimumUpdatePeriod,timelineStarts:e.timelineStarts});for(let d=0;d<e.playlists.length;d++){const f=e.playlists[d];if(f.sidx){const L=yn(f.sidx);i&&i[L]&&i[L].sidx&&jt(f,i[L].sidx,f.sidx.resolvedUri)}const y=sh(l,f,hf);y&&(l=y,r=!1)}return bl(e,(d,f,y,L)=>{if(d.playlists&&d.playlists.length){const B=d.playlists[0].id,W=sh(l,d.playlists[0],hf);W&&(l=W,L in l.mediaGroups[f][y]||(l.mediaGroups[f][y][L]=d),l.mediaGroups[f][y][L].playlists[0]=l.playlists[B],r=!1)}}),F0(l,e),e.minimumUpdatePeriod!==s.minimumUpdatePeriod&&(r=!1),r?null:l},U0=(s,e)=>(Boolean(!s.map&&!e.map)||Boolean(s.map&&e.map&&s.map.byterange.offset===e.map.byterange.offset&&s.map.byterange.length===e.map.byterange.length))&&s.uri===e.uri&&s.byterange.offset===e.byterange.offset&&s.byterange.length===e.byterange.length,ff=(s,e)=>{const i={};for(const r in s){const d=s[r].sidx;if(d){const f=yn(d);if(!e[f])break;const y=e[f].sidxInfo;U0(y,d)&&(i[f]=e[f])}}return i},j0=(s,e)=>{let r=ff(s.playlists,e);return bl(s,(l,d,f,y)=>{if(l.playlists&&l.playlists.length){const L=l.playlists;r=st(r,ff(L,e))}}),r};class dh extends O0{constructor(e,i,r={},l){super();this.mainPlaylistLoader_=l||this,l||(this.isMain_=!0);const{withCredentials:d=!1}=r;if(this.vhs_=i,this.withCredentials=d,this.addMetadataToTextTrack=r.addMetadataToTextTrack,!e)throw new Error("A non-empty playlist URL or object is required");this.on("minimumUpdatePeriod",()=>{this.refreshXml_()}),this.on("mediaupdatetimeout",()=>{this.refreshMedia_(this.media().id)}),this.state="HAVE_NOTHING",this.loadedPlaylists_={},this.logger_=et("DashPlaylistLoader"),this.isMain_?(this.mainPlaylistLoader_.srcUrl=e,this.mainPlaylistLoader_.sidxMapping_={}):this.childPlaylist_=e}requestErrored_(e,i,r){if(!this.request)return!0;if(this.request=null,e)return this.error=typeof e=="object"&&!(e instanceof Error)?e:{status:i.status,message:"DASH request error at URL: "+i.uri,response:i.response,code:2},r&&(this.state=r),this.trigger("error"),!0}addSidxSegments_(e,i,r){const l=e.sidx&&yn(e.sidx);if(!e.sidx||!l||this.mainPlaylistLoader_.sidxMapping_[l]){this.mediaRequest_=le().setTimeout(()=>r(!1),0);return}const d=Lt(e.sidx.resolvedUri),f=(y,L)=>{if(this.requestErrored_(y,L,i))return;const B=this.mainPlaylistLoader_.sidxMapping_;let W;try{W=Co()(gt(L.response).subarray(8))}catch(ce){this.requestErrored_(ce,L,i);return}return B[l]={sidxInfo:e.sidx,sidx:W},jt(e,W,e.sidx.resolvedUri),r(!0)};this.request=P0(d,this.vhs_.xhr,(y,L,B,W)=>{if(y)return f(y,L);if(!B||B!=="mp4")return f({status:L.status,message:`Unsupported ${B||"unknown"} container type for sidx segment at URL: ${d}`,response:"",playlist:e,internal:!0,playlistExclusionDuration:Infinity,code:2},L);const{offset:ce,length:ke}=e.sidx.byterange;if(W.length>=ke+ce)return f(y,{response:W.subarray(ce,ce+ke),status:L.status,uri:L.uri});this.request=this.vhs_.xhr({uri:d,responseType:"arraybuffer",headers:lh({byterange:e.sidx.byterange})},f)})}dispose(){this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},le().clearTimeout(this.minimumUpdatePeriodTimeout_),le().clearTimeout(this.mediaRequest_),le().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.mediaRequest_=null,this.minimumUpdatePeriodTimeout_=null,this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.off()}hasPendingRequest(){return this.request||this.mediaRequest_}stopRequest(){if(this.request){const e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}media(e){if(!e)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);const i=this.state;if(typeof e=="string"){if(!this.mainPlaylistLoader_.main.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.mainPlaylistLoader_.main.playlists[e]}const r=!this.media_||e.id!==this.media_.id;if(r&&this.loadedPlaylists_[e.id]&&this.loadedPlaylists_[e.id].endList){this.state="HAVE_METADATA",this.media_=e,r&&(this.trigger("mediachanging"),this.trigger("mediachange"));return}!r||(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(e,i,l=>{this.haveMetadata({startingState:i,playlist:e})}))}haveMetadata({startingState:e,playlist:i}){this.state="HAVE_METADATA",this.loadedPlaylists_[i.id]=i,this.mediaRequest_=null,this.refreshMedia_(i.id),e==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange")}pause(){this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.stopRequest(),le().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.isMain_&&(le().clearTimeout(this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_),this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_=null),this.state==="HAVE_NOTHING"&&(this.started=!1)}load(e){le().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null;const i=this.media();if(e){const r=i?i.targetDuration/2*1e3:5*1e3;this.mediaUpdateTimeout=le().setTimeout(()=>this.load(),r);return}if(!this.started){this.start();return}i&&!i.endList?(this.isMain_&&!this.minimumUpdatePeriodTimeout_&&(this.trigger("minimumUpdatePeriod"),this.updateMinimumUpdatePeriodTimeout_()),this.trigger("mediaupdatetimeout")):this.trigger("loadedplaylist")}start(){if(this.started=!0,!this.isMain_){this.mediaRequest_=le().setTimeout(()=>this.haveMain_(),0);return}this.requestMain_((e,i)=>{this.haveMain_(),!this.hasPendingRequest()&&!this.media_&&this.media(this.mainPlaylistLoader_.main.playlists[0])})}requestMain_(e){this.request=this.vhs_.xhr({uri:this.mainPlaylistLoader_.srcUrl,withCredentials:this.withCredentials},(i,r)=>{if(this.requestErrored_(i,r)){this.state==="HAVE_NOTHING"&&(this.started=!1);return}const l=r.responseText!==this.mainPlaylistLoader_.mainXml_;if(this.mainPlaylistLoader_.mainXml_=r.responseText,r.responseHeaders&&r.responseHeaders.date?this.mainLoaded_=Date.parse(r.responseHeaders.date):this.mainLoaded_=Date.now(),this.mainPlaylistLoader_.srcUrl=Lt(this.mainPlaylistLoader_.srcUrl,r),l){this.handleMain_(),this.syncClientServerClock_(()=>e(r,l));return}return e(r,l)})}syncClientServerClock_(e){const i=Rl(this.mainPlaylistLoader_.mainXml_);if(i===null)return this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),e();if(i.method==="DIRECT")return this.mainPlaylistLoader_.clientOffset_=i.value-Date.now(),e();this.request=this.vhs_.xhr({uri:ct(this.mainPlaylistLoader_.srcUrl,i.value),method:i.method,withCredentials:this.withCredentials},(r,l)=>{if(!this.request)return;if(r)return this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),e();let d;i.method==="HEAD"?!l.responseHeaders||!l.responseHeaders.date?d=this.mainLoaded_:d=Date.parse(l.responseHeaders.date):d=Date.parse(l.responseText),this.mainPlaylistLoader_.clientOffset_=d-Date.now(),e()})}haveMain_(){this.state="HAVE_MAIN_MANIFEST",this.isMain_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)}handleMain_(){this.mediaRequest_=null;const e=this.mainPlaylistLoader_.main;let i=M0({mainXml:this.mainPlaylistLoader_.mainXml_,srcUrl:this.mainPlaylistLoader_.srcUrl,clientOffset:this.mainPlaylistLoader_.clientOffset_,sidxMapping:this.mainPlaylistLoader_.sidxMapping_,previousManifest:e});e&&(i=N0(e,i,this.mainPlaylistLoader_.sidxMapping_)),this.mainPlaylistLoader_.main=i||e;const r=this.mainPlaylistLoader_.main.locations&&this.mainPlaylistLoader_.main.locations[0];return r&&r!==this.mainPlaylistLoader_.srcUrl&&(this.mainPlaylistLoader_.srcUrl=r),(!e||i&&i.minimumUpdatePeriod!==e.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_(),this.addEventStreamToMetadataTrack_(i),Boolean(i)}updateMinimumUpdatePeriodTimeout_(){const e=this.mainPlaylistLoader_;e.createMupOnMedia_&&(e.off("loadedmetadata",e.createMupOnMedia_),e.createMupOnMedia_=null),e.minimumUpdatePeriodTimeout_&&(le().clearTimeout(e.minimumUpdatePeriodTimeout_),e.minimumUpdatePeriodTimeout_=null);let i=e.main&&e.main.minimumUpdatePeriod;if(i===0&&(e.media()?i=e.media().targetDuration*1e3:(e.createMupOnMedia_=e.updateMinimumUpdatePeriodTimeout_,e.one("loadedmetadata",e.createMupOnMedia_))),typeof i!="number"||i<=0){i<0&&this.logger_(`found invalid minimumUpdatePeriod of ${i}, not setting a timeout`);return}this.createMUPTimeout_(i)}createMUPTimeout_(e){const i=this.mainPlaylistLoader_;i.minimumUpdatePeriodTimeout_=le().setTimeout(()=>{i.minimumUpdatePeriodTimeout_=null,i.trigger("minimumUpdatePeriod"),i.createMUPTimeout_(e)},e)}refreshXml_(){this.requestMain_((e,i)=>{!i||(this.media_&&(this.media_=this.mainPlaylistLoader_.main.playlists[this.media_.id]),this.mainPlaylistLoader_.sidxMapping_=j0(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.sidxMapping_),this.addSidxSegments_(this.media(),this.state,r=>{this.refreshMedia_(this.media().id)}))})}refreshMedia_(e){if(!e)throw new Error("refreshMedia_ must take a media id");this.media_&&this.isMain_&&this.handleMain_();const i=this.mainPlaylistLoader_.main.playlists,r=!this.media_||this.media_!==i[e];if(r?this.media_=i[e]:this.trigger("playlistunchanged"),!this.mediaUpdateTimeout){const l=()=>{this.media().endList||(this.mediaUpdateTimeout=le().setTimeout(()=>{this.trigger("mediaupdatetimeout"),l()},ah(this.media(),Boolean(r))))};l()}this.trigger("loadedplaylist")}addEventStreamToMetadataTrack_(e){if(e&&this.mainPlaylistLoader_.main.eventStream){const i=this.mainPlaylistLoader_.main.eventStream.map(r=>({cueTime:r.start,frames:[{data:r.messageData}]}));this.addMetadataToTextTrack("EventStream",i,this.mainPlaylistLoader_.main.duration)}}getKeyIdSet(e){if(e.contentProtection){const i=new Set;for(const r in e.contentProtection){const l=e.contentProtection[r].attributes["cenc:default_KID"];l&&i.add(l.replace(/-/g,"").toLowerCase())}return i}}}var wn={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30};const $0=s=>{const e=new Uint8Array(new ArrayBuffer(s.length));for(let i=0;i<s.length;i++)e[i]=s.charCodeAt(i);return e.buffer},pf=function(s){return s.on=s.addEventListener,s.off=s.removeEventListener,s},V0=function(s){try{return URL.createObjectURL(new Blob([s],{type:"application/javascript"}))}catch(e){const i=new BlobBuilder;return i.append(s),URL.createObjectURL(i.getBlob())}},mf=function(s){return function(){const e=V0(s),i=pf(new Worker(e));i.objURL=e;const r=i.terminate;return i.on=i.addEventListener,i.off=i.removeEventListener,i.terminate=function(){return URL.revokeObjectURL(e),r.call(this)},i}},gf=function(s){return`var browserWorkerPolyFill = ${pf.toString()};
browserWorkerPolyFill(self);
`+s},yf=function(s){return s.toString().replace(/^function.+?{/,"").slice(0,-1)},G0=gf(yf(function(){var s=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof pt.g!="undefined"?pt.g:typeof self!="undefined"?self:{},e=function(){this.init=function(){var m={};this.on=function(b,C){m[b]||(m[b]=[]),m[b]=m[b].concat(C)},this.off=function(b,C){var E;return m[b]?(E=m[b].indexOf(C),m[b]=m[b].slice(),m[b].splice(E,1),E>-1):!1},this.trigger=function(b){var C,E,R,N;if(C=m[b],!!C)if(arguments.length===2)for(R=C.length,E=0;E<R;++E)C[E].call(this,arguments[1]);else{for(N=[],E=arguments.length,E=1;E<arguments.length;++E)N.push(arguments[E]);for(R=C.length,E=0;E<R;++E)C[E].apply(this,N)}},this.dispose=function(){m={}}}};e.prototype.pipe=function(m){return this.on("data",function(b){m.push(b)}),this.on("done",function(b){m.flush(b)}),this.on("partialdone",function(b){m.partialFlush(b)}),this.on("endedtimeline",function(b){m.endTimeline(b)}),this.on("reset",function(b){m.reset(b)}),m},e.prototype.push=function(m){this.trigger("data",m)},e.prototype.flush=function(m){this.trigger("done",m)},e.prototype.partialFlush=function(m){this.trigger("partialdone",m)},e.prototype.endTimeline=function(m){this.trigger("endedtimeline",m)},e.prototype.reset=function(m){this.trigger("reset",m)};var i=e,r=Math.pow(2,32),l=function(m){var b=new DataView(m.buffer,m.byteOffset,m.byteLength),C;return b.getBigUint64?(C=b.getBigUint64(0),C<Number.MAX_SAFE_INTEGER?Number(C):C):b.getUint32(0)*r+b.getUint32(4)},d={getUint64:l,MAX_UINT32:r},f=d.MAX_UINT32,y,L,B,W,ce,ke,Pe,be,je,We,Je,He,dt,tt,Ue,xt,Vt,mi,yi,an,Un,on,Yt,$i,Ds,ia,La,lo,uo,co,ho,fo,tc,sp,ap,op;(function(){var m;if(Yt={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},typeof Uint8Array!="undefined"){for(m in Yt)Yt.hasOwnProperty(m)&&(Yt[m]=[m.charCodeAt(0),m.charCodeAt(1),m.charCodeAt(2),m.charCodeAt(3)]);$i=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),ia=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),Ds=new Uint8Array([0,0,0,1]),La=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),lo=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),uo={video:La,audio:lo},fo=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),ho=new Uint8Array([0,0,0,0,0,0,0,0]),tc=new Uint8Array([0,0,0,0,0,0,0,0]),sp=tc,ap=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),op=tc,co=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})(),y=function(m){var b=[],C=0,E,R,N;for(E=1;E<arguments.length;E++)b.push(arguments[E]);for(E=b.length;E--;)C+=b[E].byteLength;for(R=new Uint8Array(C+8),N=new DataView(R.buffer,R.byteOffset,R.byteLength),N.setUint32(0,R.byteLength),R.set(m,4),E=0,C=8;E<b.length;E++)R.set(b[E],C),C+=b[E].byteLength;return R},L=function(){return y(Yt.dinf,y(Yt.dref,fo))},B=function(m){return y(Yt.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,m.audioobjecttype<<3|m.samplingfrequencyindex>>>1,m.samplingfrequencyindex<<7|m.channelcount<<3,6,1,2]))},W=function(){return y(Yt.ftyp,$i,Ds,$i,ia)},xt=function(m){return y(Yt.hdlr,uo[m])},ce=function(m){return y(Yt.mdat,m)},Ue=function(m){var b=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,m.duration>>>24&255,m.duration>>>16&255,m.duration>>>8&255,m.duration&255,85,196,0,0]);return m.samplerate&&(b[12]=m.samplerate>>>24&255,b[13]=m.samplerate>>>16&255,b[14]=m.samplerate>>>8&255,b[15]=m.samplerate&255),y(Yt.mdhd,b)},tt=function(m){return y(Yt.mdia,Ue(m),xt(m.type),Pe(m))},ke=function(m){return y(Yt.mfhd,new Uint8Array([0,0,0,0,(m&4278190080)>>24,(m&16711680)>>16,(m&65280)>>8,m&255]))},Pe=function(m){return y(Yt.minf,m.type==="video"?y(Yt.vmhd,co):y(Yt.smhd,ho),L(),mi(m))},be=function(m,b){for(var C=[],E=b.length;E--;)C[E]=an(b[E]);return y.apply(null,[Yt.moof,ke(m)].concat(C))},je=function(m){for(var b=m.length,C=[];b--;)C[b]=He(m[b]);return y.apply(null,[Yt.moov,Je(4294967295)].concat(C).concat(We(m)))},We=function(m){for(var b=m.length,C=[];b--;)C[b]=Un(m[b]);return y.apply(null,[Yt.mvex].concat(C))},Je=function(m){var b=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(m&4278190080)>>24,(m&16711680)>>16,(m&65280)>>8,m&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return y(Yt.mvhd,b)},Vt=function(m){var b=m.samples||[],C=new Uint8Array(4+b.length),E,R;for(R=0;R<b.length;R++)E=b[R].flags,C[R+4]=E.dependsOn<<4|E.isDependedOn<<2|E.hasRedundancy;return y(Yt.sdtp,C)},mi=function(m){return y(Yt.stbl,yi(m),y(Yt.stts,op),y(Yt.stsc,sp),y(Yt.stsz,ap),y(Yt.stco,tc))},function(){var m,b;yi=function(C){return y(Yt.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),C.type==="video"?m(C):b(C))},m=function(C){var E=C.sps||[],R=C.pps||[],N=[],he=[],ye,_e;for(ye=0;ye<E.length;ye++)N.push((E[ye].byteLength&65280)>>>8),N.push(E[ye].byteLength&255),N=N.concat(Array.prototype.slice.call(E[ye]));for(ye=0;ye<R.length;ye++)he.push((R[ye].byteLength&65280)>>>8),he.push(R[ye].byteLength&255),he=he.concat(Array.prototype.slice.call(R[ye]));if(_e=[Yt.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(C.width&65280)>>8,C.width&255,(C.height&65280)>>8,C.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),y(Yt.avcC,new Uint8Array([1,C.profileIdc,C.profileCompatibility,C.levelIdc,255].concat([E.length],N,[R.length],he))),y(Yt.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],C.sarRatio){var Te=C.sarRatio[0],Me=C.sarRatio[1];_e.push(y(Yt.pasp,new Uint8Array([(Te&4278190080)>>24,(Te&16711680)>>16,(Te&65280)>>8,Te&255,(Me&4278190080)>>24,(Me&16711680)>>16,(Me&65280)>>8,Me&255])))}return y.apply(null,_e)},b=function(C){return y(Yt.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(C.channelcount&65280)>>8,C.channelcount&255,(C.samplesize&65280)>>8,C.samplesize&255,0,0,0,0,(C.samplerate&65280)>>8,C.samplerate&255,0,0]),B(C))}}(),dt=function(m){var b=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(m.id&4278190080)>>24,(m.id&16711680)>>16,(m.id&65280)>>8,m.id&255,0,0,0,0,(m.duration&4278190080)>>24,(m.duration&16711680)>>16,(m.duration&65280)>>8,m.duration&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(m.width&65280)>>8,m.width&255,0,0,(m.height&65280)>>8,m.height&255,0,0]);return y(Yt.tkhd,b)},an=function(m){var b,C,E,R,N,he,ye;return b=y(Yt.tfhd,new Uint8Array([0,0,0,58,(m.id&4278190080)>>24,(m.id&16711680)>>16,(m.id&65280)>>8,m.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),he=Math.floor(m.baseMediaDecodeTime/f),ye=Math.floor(m.baseMediaDecodeTime%f),C=y(Yt.tfdt,new Uint8Array([1,0,0,0,he>>>24&255,he>>>16&255,he>>>8&255,he&255,ye>>>24&255,ye>>>16&255,ye>>>8&255,ye&255])),N=32+20+8+16+8+8,m.type==="audio"?(E=on(m,N),y(Yt.traf,b,C,E)):(R=Vt(m),E=on(m,R.length+N),y(Yt.traf,b,C,E,R))},He=function(m){return m.duration=m.duration||4294967295,y(Yt.trak,dt(m),tt(m))},Un=function(m){var b=new Uint8Array([0,0,0,0,(m.id&4278190080)>>24,(m.id&16711680)>>16,(m.id&65280)>>8,m.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return m.type!=="video"&&(b[b.length-1]=0),y(Yt.trex,b)},function(){var m,b,C;C=function(E,R){var N=0,he=0,ye=0,_e=0;return E.length&&(E[0].duration!==void 0&&(N=1),E[0].size!==void 0&&(he=2),E[0].flags!==void 0&&(ye=4),E[0].compositionTimeOffset!==void 0&&(_e=8)),[0,0,N|he|ye|_e,1,(E.length&4278190080)>>>24,(E.length&16711680)>>>16,(E.length&65280)>>>8,E.length&255,(R&4278190080)>>>24,(R&16711680)>>>16,(R&65280)>>>8,R&255]},b=function(E,R){var N,he,ye,_e,Te,Me;for(_e=E.samples||[],R+=8+12+16*_e.length,ye=C(_e,R),he=new Uint8Array(ye.length+_e.length*16),he.set(ye),N=ye.length,Me=0;Me<_e.length;Me++)Te=_e[Me],he[N++]=(Te.duration&4278190080)>>>24,he[N++]=(Te.duration&16711680)>>>16,he[N++]=(Te.duration&65280)>>>8,he[N++]=Te.duration&255,he[N++]=(Te.size&4278190080)>>>24,he[N++]=(Te.size&16711680)>>>16,he[N++]=(Te.size&65280)>>>8,he[N++]=Te.size&255,he[N++]=Te.flags.isLeading<<2|Te.flags.dependsOn,he[N++]=Te.flags.isDependedOn<<6|Te.flags.hasRedundancy<<4|Te.flags.paddingValue<<1|Te.flags.isNonSyncSample,he[N++]=Te.flags.degradationPriority&240<<8,he[N++]=Te.flags.degradationPriority&15,he[N++]=(Te.compositionTimeOffset&4278190080)>>>24,he[N++]=(Te.compositionTimeOffset&16711680)>>>16,he[N++]=(Te.compositionTimeOffset&65280)>>>8,he[N++]=Te.compositionTimeOffset&255;return y(Yt.trun,he)},m=function(E,R){var N,he,ye,_e,Te,Me;for(_e=E.samples||[],R+=8+12+8*_e.length,ye=C(_e,R),N=new Uint8Array(ye.length+_e.length*8),N.set(ye),he=ye.length,Me=0;Me<_e.length;Me++)Te=_e[Me],N[he++]=(Te.duration&4278190080)>>>24,N[he++]=(Te.duration&16711680)>>>16,N[he++]=(Te.duration&65280)>>>8,N[he++]=Te.duration&255,N[he++]=(Te.size&4278190080)>>>24,N[he++]=(Te.size&16711680)>>>16,N[he++]=(Te.size&65280)>>>8,N[he++]=Te.size&255;return y(Yt.trun,N)},on=function(E,R){return E.type==="audio"?m(E,R):b(E,R)}}();var Sg={ftyp:W,mdat:ce,moof:be,moov:je,initSegment:function(m){var b=W(),C=je(m),E;return E=new Uint8Array(b.byteLength+C.byteLength),E.set(b),E.set(C,b.byteLength),E}},Cg=function(m){var b,C,E=[],R=[];for(R.byteLength=0,R.nalCount=0,R.duration=0,E.byteLength=0,b=0;b<m.length;b++)C=m[b],C.nalUnitType==="access_unit_delimiter_rbsp"?(E.length&&(E.duration=C.dts-E.dts,R.byteLength+=E.byteLength,R.nalCount+=E.length,R.duration+=E.duration,R.push(E)),E=[C],E.byteLength=C.data.byteLength,E.pts=C.pts,E.dts=C.dts):(C.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"&&(E.keyFrame=!0),E.duration=C.dts-E.dts,E.byteLength+=C.data.byteLength,E.push(C));return R.length&&(!E.duration||E.duration<=0)&&(E.duration=R[R.length-1].duration),R.byteLength+=E.byteLength,R.nalCount+=E.length,R.duration+=E.duration,R.push(E),R},wg=function(m){var b,C,E=[],R=[];for(E.byteLength=0,E.nalCount=0,E.duration=0,E.pts=m[0].pts,E.dts=m[0].dts,R.byteLength=0,R.nalCount=0,R.duration=0,R.pts=m[0].pts,R.dts=m[0].dts,b=0;b<m.length;b++)C=m[b],C.keyFrame?(E.length&&(R.push(E),R.byteLength+=E.byteLength,R.nalCount+=E.nalCount,R.duration+=E.duration),E=[C],E.nalCount=C.length,E.byteLength=C.byteLength,E.pts=C.pts,E.dts=C.dts,E.duration=C.duration):(E.duration+=C.duration,E.nalCount+=C.length,E.byteLength+=C.byteLength,E.push(C));return R.length&&E.duration<=0&&(E.duration=R[R.length-1].duration),R.byteLength+=E.byteLength,R.nalCount+=E.nalCount,R.duration+=E.duration,R.push(E),R},Lg=function(m){var b;return!m[0][0].keyFrame&&m.length>1&&(b=m.shift(),m.byteLength-=b.byteLength,m.nalCount-=b.nalCount,m[0][0].dts=b.dts,m[0][0].pts=b.pts,m[0][0].duration+=b.duration),m},Dg=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},lp=function(m,b){var C=Dg();return C.dataOffset=b,C.compositionTimeOffset=m.pts-m.dts,C.duration=m.duration,C.size=4*m.length,C.size+=m.byteLength,m.keyFrame&&(C.flags.dependsOn=2,C.flags.isNonSyncSample=0),C},kg=function(m,b){var C,E,R,N,he,ye=b||0,_e=[];for(C=0;C<m.length;C++)for(N=m[C],E=0;E<N.length;E++)he=N[E],R=lp(he,ye),ye+=R.size,_e.push(R);return _e},Ig=function(m){var b,C,E,R,N,he,ye=0,_e=m.byteLength,Te=m.nalCount,Me=_e+4*Te,ze=new Uint8Array(Me),It=new DataView(ze.buffer);for(b=0;b<m.length;b++)for(R=m[b],C=0;C<R.length;C++)for(N=R[C],E=0;E<N.length;E++)he=N[E],It.setUint32(ye,he.data.byteLength),ye+=4,ze.set(he.data,ye),ye+=he.data.byteLength;return ze},Rg=function(m,b){var C,E=b||0,R=[];return C=lp(m,E),R.push(C),R},Pg=function(m){var b,C,E=0,R=m.byteLength,N=m.length,he=R+4*N,ye=new Uint8Array(he),_e=new DataView(ye.buffer);for(b=0;b<m.length;b++)C=m[b],_e.setUint32(E,C.data.byteLength),E+=4,ye.set(C.data,E),E+=C.data.byteLength;return ye},Og={groupNalsIntoFrames:Cg,groupFramesIntoGops:wg,extendFirstKeyFrame:Lg,generateSampleTable:kg,concatenateNalData:Ig,generateSampleTableForFrame:Rg,concatenateNalDataForFrame:Pg},Da=[33,16,5,32,164,27],Ah=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],Mi=function(m){for(var b=[];m--;)b.push(0);return b},Bg=function(m){return Object.keys(m).reduce(function(b,C){return b[C]=new Uint8Array(m[C].reduce(function(E,R){return E.concat(R)},[])),b},{})},bh,Mg=function(){if(!bh){var m={96e3:[Da,[227,64],Mi(154),[56]],88200:[Da,[231],Mi(170),[56]],64e3:[Da,[248,192],Mi(240),[56]],48e3:[Da,[255,192],Mi(268),[55,148,128],Mi(54),[112]],44100:[Da,[255,192],Mi(268),[55,163,128],Mi(84),[112]],32e3:[Da,[255,192],Mi(268),[55,234],Mi(226),[112]],24e3:[Da,[255,192],Mi(268),[55,255,128],Mi(268),[111,112],Mi(126),[224]],16e3:[Da,[255,192],Mi(268),[55,255,128],Mi(268),[111,255],Mi(269),[223,108],Mi(195),[1,192]],12e3:[Ah,Mi(268),[3,127,248],Mi(268),[6,255,240],Mi(268),[13,255,224],Mi(268),[27,253,128],Mi(259),[56]],11025:[Ah,Mi(268),[3,127,248],Mi(268),[6,255,240],Mi(268),[13,255,224],Mi(268),[27,255,192],Mi(268),[55,175,128],Mi(108),[112]],8e3:[Ah,Mi(268),[3,121,16],Mi(47),[7]]};bh=Bg(m)}return bh},_h=9e4,xh,Eh,ic,Th,up,dp,cp;xh=function(m){return m*_h},Eh=function(m,b){return m*b},ic=function(m){return m/_h},Th=function(m,b){return m/b},up=function(m,b){return xh(Th(m,b))},dp=function(m,b){return Eh(ic(m),b)},cp=function(m,b,C){return ic(C?m:m-b)};var Xi={ONE_SECOND_IN_TS:_h,secondsToVideoTs:xh,secondsToAudioTs:Eh,videoTsToSeconds:ic,audioTsToSeconds:Th,audioTsToVideoTs:up,videoTsToAudioTs:dp,metadataTsToSeconds:cp},Fg=Mg,nc=Xi,Ng=function(m){var b,C,E=0;for(b=0;b<m.length;b++)C=m[b],E+=C.data.byteLength;return E},Ug=function(m,b,C,E){var R,N=0,he=0,ye=0,_e=0,Te,Me,ze;if(!!b.length&&(R=nc.audioTsToVideoTs(m.baseMediaDecodeTime,m.samplerate),N=Math.ceil(nc.ONE_SECOND_IN_TS/(m.samplerate/1024)),C&&E&&(he=R-Math.max(C,E),ye=Math.floor(he/N),_e=ye*N),!(ye<1||_e>nc.ONE_SECOND_IN_TS/2))){for(Te=Fg()[m.samplerate],Te||(Te=b[0].data),Me=0;Me<ye;Me++)ze=b[0],b.splice(0,0,{data:Te,dts:ze.dts-N,pts:ze.pts-N});return m.baseMediaDecodeTime-=Math.floor(nc.videoTsToAudioTs(_e,m.samplerate)),_e}},jg=function(m,b,C){return b.minSegmentDts>=C?m:(b.minSegmentDts=Infinity,m.filter(function(E){return E.dts>=C?(b.minSegmentDts=Math.min(b.minSegmentDts,E.dts),b.minSegmentPts=b.minSegmentDts,!0):!1}))},$g=function(m){var b,C,E=[];for(b=0;b<m.length;b++)C=m[b],E.push({size:C.data.byteLength,duration:1024});return E},Vg=function(m){var b,C,E=0,R=new Uint8Array(Ng(m));for(b=0;b<m.length;b++)C=m[b],R.set(C.data,E),E+=C.data.byteLength;return R},Gg={prefixWithSilence:Ug,trimAdtsFramesByEarliestDts:jg,generateSampleTable:$g,concatenateFrameData:Vg},Hg=Xi.ONE_SECOND_IN_TS,qg=function(m,b){typeof b.pts=="number"&&(m.timelineStartInfo.pts===void 0&&(m.timelineStartInfo.pts=b.pts),m.minSegmentPts===void 0?m.minSegmentPts=b.pts:m.minSegmentPts=Math.min(m.minSegmentPts,b.pts),m.maxSegmentPts===void 0?m.maxSegmentPts=b.pts:m.maxSegmentPts=Math.max(m.maxSegmentPts,b.pts)),typeof b.dts=="number"&&(m.timelineStartInfo.dts===void 0&&(m.timelineStartInfo.dts=b.dts),m.minSegmentDts===void 0?m.minSegmentDts=b.dts:m.minSegmentDts=Math.min(m.minSegmentDts,b.dts),m.maxSegmentDts===void 0?m.maxSegmentDts=b.dts:m.maxSegmentDts=Math.max(m.maxSegmentDts,b.dts))},Kg=function(m){delete m.minSegmentDts,delete m.maxSegmentDts,delete m.minSegmentPts,delete m.maxSegmentPts},Wg=function(m,b){var C,E,R=m.minSegmentDts;return b||(R-=m.timelineStartInfo.dts),C=m.timelineStartInfo.baseMediaDecodeTime,C+=R,C=Math.max(0,C),m.type==="audio"&&(E=m.samplerate/Hg,C*=E,C=Math.floor(C)),C},zg={clearDtsInfo:Kg,calculateTrackBaseMediaDecodeTime:Wg,collectDtsInfo:qg},hp=4,Yg=128,Xg=function(m){for(var b=0,C={payloadType:-1,payloadSize:0},E=0,R=0;b<m.byteLength&&m[b]!==Yg;){for(;m[b]===255;)E+=255,b++;for(E+=m[b++];m[b]===255;)R+=255,b++;if(R+=m[b++],!C.payload&&E===hp){var N=String.fromCharCode(m[b+3],m[b+4],m[b+5],m[b+6]);if(N==="GA94"){C.payloadType=E,C.payloadSize=R,C.payload=m.subarray(b,b+R);break}else C.payload=void 0}b+=R,E=0,R=0}return C},Qg=function(m){return m.payload[0]!==181||(m.payload[1]<<8|m.payload[2])!=49||String.fromCharCode(m.payload[3],m.payload[4],m.payload[5],m.payload[6])!=="GA94"||m.payload[7]!==3?null:m.payload.subarray(8,m.payload.length-1)},Jg=function(m,b){var C=[],E,R,N,he;if(!(b[0]&64))return C;for(R=b[0]&31,E=0;E<R;E++)N=E*3,he={type:b[N+2]&3,pts:m},b[N+2]&4&&(he.ccData=b[N+3]<<8|b[N+4],C.push(he));return C},Zg=function(m){for(var b=m.byteLength,C=[],E=1,R,N;E<b-2;)m[E]===0&&m[E+1]===0&&m[E+2]===3?(C.push(E+2),E+=2):E++;if(C.length===0)return m;R=b-C.length,N=new Uint8Array(R);var he=0;for(E=0;E<R;he++,E++)he===C[0]&&(he++,C.shift()),N[E]=m[he];return N},fp={parseSei:Xg,parseUserData:Qg,parseCaptionPackets:Jg,discardEmulationPreventionBytes:Zg,USER_DATA_REGISTERED_ITU_T_T35:hp},Sh=i,rc=fp,lr=function(m){m=m||{},lr.prototype.init.call(this),this.parse708captions_=typeof m.parse708captions=="boolean"?m.parse708captions:!0,this.captionPackets_=[],this.ccStreams_=[new Zi(0,0),new Zi(0,1),new Zi(1,0),new Zi(1,1)],this.parse708captions_&&(this.cc708Stream_=new Vi({captionServices:m.captionServices})),this.reset(),this.ccStreams_.forEach(function(b){b.on("data",this.trigger.bind(this,"data")),b.on("partialdone",this.trigger.bind(this,"partialdone")),b.on("done",this.trigger.bind(this,"done"))},this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))};lr.prototype=new Sh,lr.prototype.push=function(m){var b,C,E;if(m.nalUnitType==="sei_rbsp"&&(b=rc.parseSei(m.escapedRBSP),!!b.payload&&b.payloadType===rc.USER_DATA_REGISTERED_ITU_T_T35&&(C=rc.parseUserData(b),!!C))){if(m.dts<this.latestDts_){this.ignoreNextEqualDts_=!0;return}else if(m.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--,this.numSameDts_||(this.ignoreNextEqualDts_=!1);return}E=rc.parseCaptionPackets(m.pts,C),this.captionPackets_=this.captionPackets_.concat(E),this.latestDts_!==m.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=m.dts}},lr.prototype.flushCCStreams=function(m){this.ccStreams_.forEach(function(b){return m==="flush"?b.flush():b.partialFlush()},this)},lr.prototype.flushStream=function(m){if(!this.captionPackets_.length){this.flushCCStreams(m);return}this.captionPackets_.forEach(function(b,C){b.presortIndex=C}),this.captionPackets_.sort(function(b,C){return b.pts===C.pts?b.presortIndex-C.presortIndex:b.pts-C.pts}),this.captionPackets_.forEach(function(b){b.type<2?this.dispatchCea608Packet(b):this.dispatchCea708Packet(b)},this),this.captionPackets_.length=0,this.flushCCStreams(m)},lr.prototype.flush=function(){return this.flushStream("flush")},lr.prototype.partialFlush=function(){return this.flushStream("partialFlush")},lr.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(m){m.reset()})},lr.prototype.dispatchCea608Packet=function(m){this.setsTextOrXDSActive(m)?this.activeCea608Channel_[m.type]=null:this.setsChannel1Active(m)?this.activeCea608Channel_[m.type]=0:this.setsChannel2Active(m)&&(this.activeCea608Channel_[m.type]=1),this.activeCea608Channel_[m.type]!==null&&this.ccStreams_[(m.type<<1)+this.activeCea608Channel_[m.type]].push(m)},lr.prototype.setsChannel1Active=function(m){return(m.ccData&30720)==4096},lr.prototype.setsChannel2Active=function(m){return(m.ccData&30720)==6144},lr.prototype.setsTextOrXDSActive=function(m){return(m.ccData&28928)==256||(m.ccData&30974)==4138||(m.ccData&30974)==6186},lr.prototype.dispatchCea708Packet=function(m){this.parse708captions_&&this.cc708Stream_.push(m)};var ey={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},ty=function(m){var b=ey[m]||m;return m&4096&&m===b?"":String.fromCharCode(b)},sc=function(m){return 32<=m&&m<=127||160<=m&&m<=255},na=function(m){this.windowNum=m,this.reset()};na.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},na.prototype.getText=function(){return this.rows.join(`
`)},na.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},na.prototype.newLine=function(m){for(this.rows.length>=this.virtualRowCount&&typeof this.beforeRowOverflow=="function"&&this.beforeRowOverflow(m),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},na.prototype.isEmpty=function(){return this.rows.length===0?!0:this.rows.length===1?this.rows[0]==="":!1},na.prototype.addText=function(m){this.rows[this.rowIdx]+=m},na.prototype.backspace=function(){if(!this.isEmpty()){var m=this.rows[this.rowIdx];this.rows[this.rowIdx]=m.substr(0,m.length-1)}};var ac=function(m,b,C){this.serviceNum=m,this.text="",this.currentWindow=new na(-1),this.windows=[],this.stream=C,typeof b=="string"&&this.createTextDecoder(b)};ac.prototype.init=function(m,b){this.startPts=m;for(var C=0;C<8;C++)this.windows[C]=new na(C),typeof b=="function"&&(this.windows[C].beforeRowOverflow=b)},ac.prototype.setCurrentWindow=function(m){this.currentWindow=this.windows[m]},ac.prototype.createTextDecoder=function(m){if(typeof TextDecoder=="undefined")this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(m)}catch(b){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+m+" encoding. "+b})}};var Vi=function(m){m=m||{},Vi.prototype.init.call(this);var b=this,C=m.captionServices||{},E={},R;Object.keys(C).forEach(N=>{R=C[N],/^SERVICE/.test(N)&&(E[N]=R.encoding)}),this.serviceEncodings=E,this.current708Packet=null,this.services={},this.push=function(N){N.type===3?(b.new708Packet(),b.add708Bytes(N)):(b.current708Packet===null&&b.new708Packet(),b.add708Bytes(N))}};Vi.prototype=new Sh,Vi.prototype.new708Packet=function(){this.current708Packet!==null&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},Vi.prototype.add708Bytes=function(m){var b=m.ccData,C=b>>>8,E=b&255;this.current708Packet.ptsVals.push(m.pts),this.current708Packet.data.push(C),this.current708Packet.data.push(E)},Vi.prototype.push708Packet=function(){var m=this.current708Packet,b=m.data,C=null,E=null,R=0,N=b[R++];for(m.seq=N>>6,m.sizeCode=N&63;R<b.length;R++)N=b[R++],C=N>>5,E=N&31,C===7&&E>0&&(N=b[R++],C=N),this.pushServiceBlock(C,R,E),E>0&&(R+=E-1)},Vi.prototype.pushServiceBlock=function(m,b,C){var E,R=b,N=this.current708Packet.data,he=this.services[m];for(he||(he=this.initService(m,R));R<b+C&&R<N.length;R++)E=N[R],sc(E)?R=this.handleText(R,he):E===24?R=this.multiByteCharacter(R,he):E===16?R=this.extendedCommands(R,he):128<=E&&E<=135?R=this.setCurrentWindow(R,he):152<=E&&E<=159?R=this.defineWindow(R,he):E===136?R=this.clearWindows(R,he):E===140?R=this.deleteWindows(R,he):E===137?R=this.displayWindows(R,he):E===138?R=this.hideWindows(R,he):E===139?R=this.toggleWindows(R,he):E===151?R=this.setWindowAttributes(R,he):E===144?R=this.setPenAttributes(R,he):E===145?R=this.setPenColor(R,he):E===146?R=this.setPenLocation(R,he):E===143?he=this.reset(R,he):E===8?he.currentWindow.backspace():E===12?he.currentWindow.clearText():E===13?he.currentWindow.pendingNewLine=!0:E===14?he.currentWindow.clearText():E===141&&R++},Vi.prototype.extendedCommands=function(m,b){var C=this.current708Packet.data,E=C[++m];return sc(E)&&(m=this.handleText(m,b,{isExtended:!0})),m},Vi.prototype.getPts=function(m){return this.current708Packet.ptsVals[Math.floor(m/2)]},Vi.prototype.initService=function(m,b){var C="SERVICE"+m,E=this,C,R;return C in this.serviceEncodings&&(R=this.serviceEncodings[C]),this.services[m]=new ac(m,R,E),this.services[m].init(this.getPts(b),function(N){E.flushDisplayed(N,E.services[m])}),this.services[m]},Vi.prototype.handleText=function(m,b,C){var E=C&&C.isExtended,R=C&&C.isMultiByte,N=this.current708Packet.data,he=E?4096:0,ye=N[m],_e=N[m+1],Te=b.currentWindow,Me,ze;function It(at){return at.map(Qt=>("0"+(Qt&255).toString(16)).slice(-2)).join("")}if(R?(ze=[ye,_e],m++):ze=[ye],b.textDecoder_&&!E)Me=b.textDecoder_.decode(new Uint8Array(ze));else if(R){const at=It(ze);Me=String.fromCharCode(parseInt(at,16))}else Me=ty(he|ye);return Te.pendingNewLine&&!Te.isEmpty()&&Te.newLine(this.getPts(m)),Te.pendingNewLine=!1,Te.addText(Me),m},Vi.prototype.multiByteCharacter=function(m,b){var C=this.current708Packet.data,E=C[m+1],R=C[m+2];return sc(E)&&sc(R)&&(m=this.handleText(++m,b,{isMultiByte:!0})),m},Vi.prototype.setCurrentWindow=function(m,b){var C=this.current708Packet.data,E=C[m],R=E&7;return b.setCurrentWindow(R),m},Vi.prototype.defineWindow=function(m,b){var C=this.current708Packet.data,E=C[m],R=E&7;b.setCurrentWindow(R);var N=b.currentWindow;return E=C[++m],N.visible=(E&32)>>5,N.rowLock=(E&16)>>4,N.columnLock=(E&8)>>3,N.priority=E&7,E=C[++m],N.relativePositioning=(E&128)>>7,N.anchorVertical=E&127,E=C[++m],N.anchorHorizontal=E,E=C[++m],N.anchorPoint=(E&240)>>4,N.rowCount=E&15,E=C[++m],N.columnCount=E&63,E=C[++m],N.windowStyle=(E&56)>>3,N.penStyle=E&7,N.virtualRowCount=N.rowCount+1,m},Vi.prototype.setWindowAttributes=function(m,b){var C=this.current708Packet.data,E=C[m],R=b.currentWindow.winAttr;return E=C[++m],R.fillOpacity=(E&192)>>6,R.fillRed=(E&48)>>4,R.fillGreen=(E&12)>>2,R.fillBlue=E&3,E=C[++m],R.borderType=(E&192)>>6,R.borderRed=(E&48)>>4,R.borderGreen=(E&12)>>2,R.borderBlue=E&3,E=C[++m],R.borderType+=(E&128)>>5,R.wordWrap=(E&64)>>6,R.printDirection=(E&48)>>4,R.scrollDirection=(E&12)>>2,R.justify=E&3,E=C[++m],R.effectSpeed=(E&240)>>4,R.effectDirection=(E&12)>>2,R.displayEffect=E&3,m},Vi.prototype.flushDisplayed=function(m,b){for(var C=[],E=0;E<8;E++)b.windows[E].visible&&!b.windows[E].isEmpty()&&C.push(b.windows[E].getText());b.endPts=m,b.text=C.join(`

`),this.pushCaption(b),b.startPts=m},Vi.prototype.pushCaption=function(m){m.text!==""&&(this.trigger("data",{startPts:m.startPts,endPts:m.endPts,text:m.text,stream:"cc708_"+m.serviceNum}),m.text="",m.startPts=m.endPts)},Vi.prototype.displayWindows=function(m,b){var C=this.current708Packet.data,E=C[++m],R=this.getPts(m);this.flushDisplayed(R,b);for(var N=0;N<8;N++)E&1<<N&&(b.windows[N].visible=1);return m},Vi.prototype.hideWindows=function(m,b){var C=this.current708Packet.data,E=C[++m],R=this.getPts(m);this.flushDisplayed(R,b);for(var N=0;N<8;N++)E&1<<N&&(b.windows[N].visible=0);return m},Vi.prototype.toggleWindows=function(m,b){var C=this.current708Packet.data,E=C[++m],R=this.getPts(m);this.flushDisplayed(R,b);for(var N=0;N<8;N++)E&1<<N&&(b.windows[N].visible^=1);return m},Vi.prototype.clearWindows=function(m,b){var C=this.current708Packet.data,E=C[++m],R=this.getPts(m);this.flushDisplayed(R,b);for(var N=0;N<8;N++)E&1<<N&&b.windows[N].clearText();return m},Vi.prototype.deleteWindows=function(m,b){var C=this.current708Packet.data,E=C[++m],R=this.getPts(m);this.flushDisplayed(R,b);for(var N=0;N<8;N++)E&1<<N&&b.windows[N].reset();return m},Vi.prototype.setPenAttributes=function(m,b){var C=this.current708Packet.data,E=C[m],R=b.currentWindow.penAttr;return E=C[++m],R.textTag=(E&240)>>4,R.offset=(E&12)>>2,R.penSize=E&3,E=C[++m],R.italics=(E&128)>>7,R.underline=(E&64)>>6,R.edgeType=(E&56)>>3,R.fontStyle=E&7,m},Vi.prototype.setPenColor=function(m,b){var C=this.current708Packet.data,E=C[m],R=b.currentWindow.penColor;return E=C[++m],R.fgOpacity=(E&192)>>6,R.fgRed=(E&48)>>4,R.fgGreen=(E&12)>>2,R.fgBlue=E&3,E=C[++m],R.bgOpacity=(E&192)>>6,R.bgRed=(E&48)>>4,R.bgGreen=(E&12)>>2,R.bgBlue=E&3,E=C[++m],R.edgeRed=(E&48)>>4,R.edgeGreen=(E&12)>>2,R.edgeBlue=E&3,m},Vi.prototype.setPenLocation=function(m,b){var C=this.current708Packet.data,E=C[m],R=b.currentWindow.penLoc;return b.currentWindow.pendingNewLine=!0,E=C[++m],R.row=E&15,E=C[++m],R.column=E&63,m},Vi.prototype.reset=function(m,b){var C=this.getPts(m);return this.flushDisplayed(C,b),this.initService(b.serviceNum,m)};var iy={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},oc=function(m){return m===null?"":(m=iy[m]||m,String.fromCharCode(m))},lc=14,ny=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],po=function(){for(var m=[],b=lc+1;b--;)m.push({text:"",indent:0,offset:0});return m},Zi=function(m,b){Zi.prototype.init.call(this),this.field_=m||0,this.dataChannel_=b||0,this.name_="CC"+((this.field_<<1|this.dataChannel_)+1),this.setConstants(),this.reset(),this.push=function(C){var E,R,N,he,ye;if(E=C.ccData&32639,E===this.lastControlCode_){this.lastControlCode_=null;return}if((E&61440)==4096?this.lastControlCode_=E:E!==this.PADDING_&&(this.lastControlCode_=null),N=E>>>8,he=E&255,E!==this.PADDING_)if(E===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(E===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(C.pts),this.flushDisplayed(C.pts),R=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=R,this.startPts_=C.pts;else if(E===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(C.pts);else if(E===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(C.pts);else if(E===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(C.pts);else if(E===this.CARRIAGE_RETURN_)this.clearFormatting(C.pts),this.flushDisplayed(C.pts),this.shiftRowsUp_(),this.startPts_=C.pts;else if(E===this.BACKSPACE_)this.mode_==="popOn"?this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1):this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1);else if(E===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(C.pts),this.displayed_=po();else if(E===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=po();else if(E===this.RESUME_DIRECT_CAPTIONING_)this.mode_!=="paintOn"&&(this.flushDisplayed(C.pts),this.displayed_=po()),this.mode_="paintOn",this.startPts_=C.pts;else if(this.isSpecialCharacter(N,he))N=(N&3)<<8,ye=oc(N|he),this[this.mode_](C.pts,ye),this.column_++;else if(this.isExtCharacter(N,he))this.mode_==="popOn"?this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1):this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1),N=(N&3)<<8,ye=oc(N|he),this[this.mode_](C.pts,ye),this.column_++;else if(this.isMidRowCode(N,he))this.clearFormatting(C.pts),this[this.mode_](C.pts," "),this.column_++,(he&14)==14&&this.addFormatting(C.pts,["i"]),(he&1)==1&&this.addFormatting(C.pts,["u"]);else if(this.isOffsetControlCode(N,he)){const Te=he&3;this.nonDisplayed_[this.row_].offset=Te,this.column_+=Te}else if(this.isPAC(N,he)){var _e=ny.indexOf(E&7968);if(this.mode_==="rollUp"&&(_e-this.rollUpRows_+1<0&&(_e=this.rollUpRows_-1),this.setRollUp(C.pts,_e)),_e!==this.row_&&(this.clearFormatting(C.pts),this.row_=_e),he&1&&this.formatting_.indexOf("u")===-1&&this.addFormatting(C.pts,["u"]),(E&16)==16){const Te=(E&14)>>1;this.column_=Te*4,this.nonDisplayed_[this.row_].indent+=Te}this.isColorPAC(he)&&(he&14)==14&&this.addFormatting(C.pts,["i"])}else this.isNormalChar(N)&&(he===0&&(he=null),ye=oc(N),ye+=oc(he),this[this.mode_](C.pts,ye),this.column_+=ye.length)}};Zi.prototype=new Sh,Zi.prototype.flushDisplayed=function(m){const b=E=>{this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+E+"."})},C=[];this.displayed_.forEach((E,R)=>{if(E&&E.text&&E.text.length){try{E.text=E.text.trim()}catch(N){b(R)}E.text.length&&C.push({text:E.text,line:R+1,position:10+Math.min(70,E.indent*10)+E.offset*2.5})}else E==null&&b(R)}),C.length&&this.trigger("data",{startPts:this.startPts_,endPts:m,content:C,stream:this.name_})},Zi.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=po(),this.nonDisplayed_=po(),this.lastControlCode_=null,this.column_=0,this.row_=lc,this.rollUpRows_=2,this.formatting_=[]},Zi.prototype.setConstants=function(){this.dataChannel_===0?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):this.dataChannel_===1&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=this.CONTROL_|32,this.END_OF_CAPTION_=this.CONTROL_|47,this.ROLL_UP_2_ROWS_=this.CONTROL_|37,this.ROLL_UP_3_ROWS_=this.CONTROL_|38,this.ROLL_UP_4_ROWS_=this.CONTROL_|39,this.CARRIAGE_RETURN_=this.CONTROL_|45,this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|41,this.BACKSPACE_=this.CONTROL_|33,this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44,this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46},Zi.prototype.isSpecialCharacter=function(m,b){return m===this.EXT_&&b>=48&&b<=63},Zi.prototype.isExtCharacter=function(m,b){return(m===this.EXT_+1||m===this.EXT_+2)&&b>=32&&b<=63},Zi.prototype.isMidRowCode=function(m,b){return m===this.EXT_&&b>=32&&b<=47},Zi.prototype.isOffsetControlCode=function(m,b){return m===this.OFFSET_&&b>=33&&b<=35},Zi.prototype.isPAC=function(m,b){return m>=this.BASE_&&m<this.BASE_+8&&b>=64&&b<=127},Zi.prototype.isColorPAC=function(m){return m>=64&&m<=79||m>=96&&m<=127},Zi.prototype.isNormalChar=function(m){return m>=32&&m<=127},Zi.prototype.setRollUp=function(m,b){if(this.mode_!=="rollUp"&&(this.row_=lc,this.mode_="rollUp",this.flushDisplayed(m),this.nonDisplayed_=po(),this.displayed_=po()),b!==void 0&&b!==this.row_)for(var C=0;C<this.rollUpRows_;C++)this.displayed_[b-C]=this.displayed_[this.row_-C],this.displayed_[this.row_-C]={text:"",indent:0,offset:0};b===void 0&&(b=this.row_),this.topRow_=b-this.rollUpRows_+1},Zi.prototype.addFormatting=function(m,b){this.formatting_=this.formatting_.concat(b);var C=b.reduce(function(E,R){return E+"<"+R+">"},"");this[this.mode_](m,C)},Zi.prototype.clearFormatting=function(m){if(!!this.formatting_.length){var b=this.formatting_.reverse().reduce(function(C,E){return C+"</"+E+">"},"");this.formatting_=[],this[this.mode_](m,b)}},Zi.prototype.popOn=function(m,b){var C=this.nonDisplayed_[this.row_].text;C+=b,this.nonDisplayed_[this.row_].text=C},Zi.prototype.rollUp=function(m,b){var C=this.displayed_[this.row_].text;C+=b,this.displayed_[this.row_].text=C},Zi.prototype.shiftRowsUp_=function(){var m;for(m=0;m<this.topRow_;m++)this.displayed_[m]={text:"",indent:0,offset:0};for(m=this.row_+1;m<lc+1;m++)this.displayed_[m]={text:"",indent:0,offset:0};for(m=this.topRow_;m<this.row_;m++)this.displayed_[m]=this.displayed_[m+1];this.displayed_[this.row_]={text:"",indent:0,offset:0}},Zi.prototype.paintOn=function(m,b){var C=this.displayed_[this.row_].text;C+=b,this.displayed_[this.row_].text=C};var pp={CaptionStream:lr,Cea608Stream:Zi,Cea708Stream:Vi},uc={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},ry=i,sy=8589934592,ay=4294967296,mp="shared",Ch=function(m,b){var C=1;for(m>b&&(C=-1);Math.abs(b-m)>ay;)m+=C*sy;return m},wh=function(m){var b,C;wh.prototype.init.call(this),this.type_=m||mp,this.push=function(E){if(E.type==="metadata"){this.trigger("data",E);return}this.type_!==mp&&E.type!==this.type_||(C===void 0&&(C=E.dts),E.dts=Ch(E.dts,C),E.pts=Ch(E.pts,C),b=E.dts,this.trigger("data",E))},this.flush=function(){C=b,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){C=void 0,b=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};wh.prototype=new ry;var gp={TimestampRolloverStream:wh,handleRollover:Ch},oy=(m,b,C)=>{if(!m)return-1;for(var E=C;E<m.length;E++)if(m[E]===b)return E;return-1},ly={typedArrayIndexOf:oy},dc=ly.typedArrayIndexOf,cc={Iso88591:0,Utf16:1,Utf16be:2,Utf8:3},yp=function(m,b,C){var E,R="";for(E=b;E<C;E++)R+="%"+("00"+m[E].toString(16)).slice(-2);return R},Vu=function(m,b,C){return decodeURIComponent(yp(m,b,C))},Gu=function(m,b,C){return unescape(yp(m,b,C))},Hu=function(m){return m[0]<<21|m[1]<<14|m[2]<<7|m[3]},qu={APIC:function(m){var b=1,C,E,R="-->";m.data[0]===cc.Utf8&&(C=dc(m.data,0,b),!(C<0)&&(m.mimeType=Gu(m.data,b,C),b=C+1,m.pictureType=m.data[b],b++,E=dc(m.data,0,b),!(E<0)&&(m.description=Vu(m.data,b,E),b=E+1,m.mimeType===R?m.url=Gu(m.data,b,m.data.length):m.pictureData=m.data.subarray(b,m.data.length))))},"T*":function(m){m.data[0]===cc.Utf8&&(m.value=Vu(m.data,1,m.data.length).replace(/\0*$/,""),m.values=m.value.split("\0"))},TXXX:function(m){var b;m.data[0]===cc.Utf8&&(b=dc(m.data,0,1),b!==-1&&(m.description=Vu(m.data,1,b),m.value=Vu(m.data,b+1,m.data.length).replace(/\0*$/,""),m.data=m.value))},"W*":function(m){m.url=Gu(m.data,0,m.data.length).replace(/\0.*$/,"")},WXXX:function(m){var b;m.data[0]===cc.Utf8&&(b=dc(m.data,0,1),b!==-1&&(m.description=Vu(m.data,1,b),m.url=Gu(m.data,b+1,m.data.length).replace(/\0.*$/,"")))},PRIV:function(m){var b;for(b=0;b<m.data.length;b++)if(m.data[b]===0){m.owner=Gu(m.data,0,b);break}m.privateData=m.data.subarray(b+1),m.data=m.privateData}},uy=function(m){var b,C,E=10,R=0,N=[];if(!(m.length<10||m[0]!=="I".charCodeAt(0)||m[1]!=="D".charCodeAt(0)||m[2]!=="3".charCodeAt(0))){R=Hu(m.subarray(6,10)),R+=10;var he=m[5]&64;he&&(E+=4,E+=Hu(m.subarray(10,14)),R-=Hu(m.subarray(16,20)));do{if(b=Hu(m.subarray(E+4,E+8)),b<1)break;C=String.fromCharCode(m[E],m[E+1],m[E+2],m[E+3]);var ye={id:C,data:m.subarray(E+10,E+b+10)};ye.key=ye.id,qu[ye.id]?qu[ye.id](ye):ye.id[0]==="T"?qu["T*"](ye):ye.id[0]==="W"&&qu["W*"](ye),N.push(ye),E+=10,E+=b}while(E<R);return N}},vp={parseId3Frames:uy,parseSyncSafeInteger:Hu,frameParsers:qu},dy=i,cy=uc,ka=vp,hc;hc=function(m){var b={descriptor:m&&m.descriptor},C=0,E=[],R=0,N;if(hc.prototype.init.call(this),this.dispatchType=cy.METADATA_STREAM_TYPE.toString(16),b.descriptor)for(N=0;N<b.descriptor.length;N++)this.dispatchType+=("00"+b.descriptor[N].toString(16)).slice(-2);this.push=function(he){var ye,_e,Te,Me,ze,It;if(he.type==="timed-metadata"){if(he.dataAlignmentIndicator&&(R=0,E.length=0),E.length===0&&(he.data.length<10||he.data[0]!=="I".charCodeAt(0)||he.data[1]!=="D".charCodeAt(0)||he.data[2]!=="3".charCodeAt(0))){this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});return}if(E.push(he),R+=he.data.byteLength,E.length===1&&(C=ka.parseSyncSafeInteger(he.data.subarray(6,10)),C+=10),!(R<C)){for(ye={data:new Uint8Array(C),frames:[],pts:E[0].pts,dts:E[0].dts},ze=0;ze<C;)ye.data.set(E[0].data.subarray(0,C-ze),ze),ze+=E[0].data.byteLength,R-=E[0].data.byteLength,E.shift();_e=10,ye.data[5]&64&&(_e+=4,_e+=ka.parseSyncSafeInteger(ye.data.subarray(10,14)),C-=ka.parseSyncSafeInteger(ye.data.subarray(16,20)));do{if(Te=ka.parseSyncSafeInteger(ye.data.subarray(_e+4,_e+8)),Te<1){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping remaining metadata parsing."});break}if(It=String.fromCharCode(ye.data[_e],ye.data[_e+1],ye.data[_e+2],ye.data[_e+3]),Me={id:It,data:ye.data.subarray(_e+10,_e+Te+10)},Me.key=Me.id,ka.frameParsers[Me.id]?ka.frameParsers[Me.id](Me):Me.id[0]==="T"?ka.frameParsers["T*"](Me):Me.id[0]==="W"&&ka.frameParsers["W*"](Me),Me.owner==="com.apple.streaming.transportStreamTimestamp"){var at=Me.data,Qt=(at[3]&1)<<30|at[4]<<22|at[5]<<14|at[6]<<6|at[7]>>>2;Qt*=4,Qt+=at[7]&3,Me.timeStamp=Qt,ye.pts===void 0&&ye.dts===void 0&&(ye.pts=Me.timeStamp,ye.dts=Me.timeStamp),this.trigger("timestamp",Me)}ye.frames.push(Me),_e+=10,_e+=Te}while(_e<C);this.trigger("data",ye)}}}},hc.prototype=new dy;var hy=hc,Lh=i,Dh=pp,as=uc,fy=gp.TimestampRolloverStream,fc,Ku,pc,Sl=188,kh=71;fc=function(){var m=new Uint8Array(Sl),b=0;fc.prototype.init.call(this),this.push=function(C){var E=0,R=Sl,N;for(b?(N=new Uint8Array(C.byteLength+b),N.set(m.subarray(0,b)),N.set(C,b),b=0):N=C;R<N.byteLength;){if(N[E]===kh&&N[R]===kh){this.trigger("data",N.subarray(E,R)),E+=Sl,R+=Sl;continue}E++,R++}E<N.byteLength&&(m.set(N.subarray(E),0),b=N.byteLength-E)},this.flush=function(){b===Sl&&m[0]===kh&&(this.trigger("data",m),b=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){b=0,this.trigger("reset")}},fc.prototype=new Lh,Ku=function(){var m,b,C,E;Ku.prototype.init.call(this),E=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,m=function(R,N){var he=0;N.payloadUnitStartIndicator&&(he+=R[he]+1),N.type==="pat"?b(R.subarray(he),N):C(R.subarray(he),N)},b=function(R,N){N.section_number=R[7],N.last_section_number=R[8],E.pmtPid=(R[10]&31)<<8|R[11],N.pmtPid=E.pmtPid},C=function(R,N){var he,ye,_e,Te;if(!!(R[5]&1)){for(E.programMapTable={video:null,audio:null,"timed-metadata":{}},he=(R[1]&15)<<8|R[2],ye=3+he-4,_e=(R[10]&15)<<8|R[11],Te=12+_e;Te<ye;){var Me=R[Te],ze=(R[Te+1]&31)<<8|R[Te+2];Me===as.H264_STREAM_TYPE&&E.programMapTable.video===null?E.programMapTable.video=ze:Me===as.ADTS_STREAM_TYPE&&E.programMapTable.audio===null?E.programMapTable.audio=ze:Me===as.METADATA_STREAM_TYPE&&(E.programMapTable["timed-metadata"][ze]=Me),Te+=((R[Te+3]&15)<<8|R[Te+4])+5}N.programMapTable=E.programMapTable}},this.push=function(R){var N={},he=4;if(N.payloadUnitStartIndicator=!!(R[1]&64),N.pid=R[1]&31,N.pid<<=8,N.pid|=R[2],(R[3]&48)>>>4>1&&(he+=R[he]+1),N.pid===0)N.type="pat",m(R.subarray(he),N),this.trigger("data",N);else if(N.pid===this.pmtPid)for(N.type="pmt",m(R.subarray(he),N),this.trigger("data",N);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else this.programMapTable===void 0?this.packetsWaitingForPmt.push([R,he,N]):this.processPes_(R,he,N)},this.processPes_=function(R,N,he){he.pid===this.programMapTable.video?he.streamType=as.H264_STREAM_TYPE:he.pid===this.programMapTable.audio?he.streamType=as.ADTS_STREAM_TYPE:he.streamType=this.programMapTable["timed-metadata"][he.pid],he.type="pes",he.data=R.subarray(N),this.trigger("data",he)}},Ku.prototype=new Lh,Ku.STREAM_TYPES={h264:27,adts:15},pc=function(){var m=this,b=!1,C={data:[],size:0},E={data:[],size:0},R={data:[],size:0},N,he=function(_e,Te){var Me;const ze=_e[0]<<16|_e[1]<<8|_e[2];Te.data=new Uint8Array,ze===1&&(Te.packetLength=6+(_e[4]<<8|_e[5]),Te.dataAlignmentIndicator=(_e[6]&4)!=0,Me=_e[7],Me&192&&(Te.pts=(_e[9]&14)<<27|(_e[10]&255)<<20|(_e[11]&254)<<12|(_e[12]&255)<<5|(_e[13]&254)>>>3,Te.pts*=4,Te.pts+=(_e[13]&6)>>>1,Te.dts=Te.pts,Me&64&&(Te.dts=(_e[14]&14)<<27|(_e[15]&255)<<20|(_e[16]&254)<<12|(_e[17]&255)<<5|(_e[18]&254)>>>3,Te.dts*=4,Te.dts+=(_e[18]&6)>>>1)),Te.data=_e.subarray(9+_e[8]))},ye=function(_e,Te,Me){var ze=new Uint8Array(_e.size),It={type:Te},at=0,Qt=0,ii=!1,En;if(!(!_e.data.length||_e.size<9)){for(It.trackId=_e.data[0].pid,at=0;at<_e.data.length;at++)En=_e.data[at],ze.set(En.data,Qt),Qt+=En.data.byteLength;he(ze,It),ii=Te==="video"||It.packetLength<=_e.size,(Me||ii)&&(_e.size=0,_e.data.length=0),ii&&m.trigger("data",It)}};pc.prototype.init.call(this),this.push=function(_e){({pat:function(){},pes:function(){var Te,Me;switch(_e.streamType){case as.H264_STREAM_TYPE:Te=C,Me="video";break;case as.ADTS_STREAM_TYPE:Te=E,Me="audio";break;case as.METADATA_STREAM_TYPE:Te=R,Me="timed-metadata";break;default:return}_e.payloadUnitStartIndicator&&ye(Te,Me,!0),Te.data.push(_e),Te.size+=_e.data.byteLength},pmt:function(){var Te={type:"metadata",tracks:[]};N=_e.programMapTable,N.video!==null&&Te.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+N.video,codec:"avc",type:"video"}),N.audio!==null&&Te.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+N.audio,codec:"adts",type:"audio"}),b=!0,m.trigger("data",Te)}})[_e.type]()},this.reset=function(){C.size=0,C.data.length=0,E.size=0,E.data.length=0,this.trigger("reset")},this.flushStreams_=function(){ye(C,"video"),ye(E,"audio"),ye(R,"timed-metadata")},this.flush=function(){if(!b&&N){var _e={type:"metadata",tracks:[]};N.video!==null&&_e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+N.video,codec:"avc",type:"video"}),N.audio!==null&&_e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+N.audio,codec:"adts",type:"audio"}),m.trigger("data",_e)}b=!1,this.flushStreams_(),this.trigger("done")}},pc.prototype=new Lh;var Ap={PAT_PID:0,MP2T_PACKET_LENGTH:Sl,TransportPacketStream:fc,TransportParseStream:Ku,ElementaryStream:pc,TimestampRolloverStream:fy,CaptionStream:Dh.CaptionStream,Cea608Stream:Dh.Cea608Stream,Cea708Stream:Dh.Cea708Stream,MetadataStream:hy};for(var Ih in as)as.hasOwnProperty(Ih)&&(Ap[Ih]=as[Ih]);var py=Ap,my=i,gy=Xi.ONE_SECOND_IN_TS,mc,bp=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];mc=function(m){var b,C=0;mc.prototype.init.call(this),this.skipWarn_=function(E,R){this.trigger("log",{level:"warn",message:`adts skiping bytes ${E} to ${R} in frame ${C} outside syncword`})},this.push=function(E){var R=0,N,he,ye,_e,Te;if(m||(C=0),E.type==="audio"){b&&b.length?(ye=b,b=new Uint8Array(ye.byteLength+E.data.byteLength),b.set(ye),b.set(E.data,ye.byteLength)):b=E.data;for(var Me;R+7<b.length;){if(b[R]!==255||(b[R+1]&246)!=240){typeof Me!="number"&&(Me=R),R++;continue}if(typeof Me=="number"&&(this.skipWarn_(Me,R),Me=null),he=(~b[R+1]&1)*2,N=(b[R+3]&3)<<11|b[R+4]<<3|(b[R+5]&224)>>5,_e=((b[R+6]&3)+1)*1024,Te=_e*gy/bp[(b[R+2]&60)>>>2],b.byteLength-R<N)break;this.trigger("data",{pts:E.pts+C*Te,dts:E.dts+C*Te,sampleCount:_e,audioobjecttype:(b[R+2]>>>6&3)+1,channelcount:(b[R+2]&1)<<2|(b[R+3]&192)>>>6,samplerate:bp[(b[R+2]&60)>>>2],samplingfrequencyindex:(b[R+2]&60)>>>2,samplesize:16,data:b.subarray(R+7+he,R+N)}),C++,R+=N}typeof Me=="number"&&(this.skipWarn_(Me,R),Me=null),b=b.subarray(R)}},this.flush=function(){C=0,this.trigger("done")},this.reset=function(){b=void 0,this.trigger("reset")},this.endTimeline=function(){b=void 0,this.trigger("endedtimeline")}},mc.prototype=new my;var yy=mc,_p;_p=function(m){var b=m.byteLength,C=0,E=0;this.length=function(){return 8*b},this.bitsAvailable=function(){return 8*b+E},this.loadWord=function(){var R=m.byteLength-b,N=new Uint8Array(4),he=Math.min(4,b);if(he===0)throw new Error("no bytes available");N.set(m.subarray(R,R+he)),C=new DataView(N.buffer).getUint32(0),E=he*8,b-=he},this.skipBits=function(R){var N;E>R?(C<<=R,E-=R):(R-=E,N=Math.floor(R/8),R-=N*8,b-=N,this.loadWord(),C<<=R,E-=R)},this.readBits=function(R){var N=Math.min(E,R),he=C>>>32-N;return E-=N,E>0?C<<=N:b>0&&this.loadWord(),N=R-N,N>0?he<<N|this.readBits(N):he},this.skipLeadingZeros=function(){var R;for(R=0;R<E;++R)if((C&2147483648>>>R)!=0)return C<<=R,E-=R,R;return this.loadWord(),R+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var R=this.skipLeadingZeros();return this.readBits(R+1)-1},this.readExpGolomb=function(){var R=this.readUnsignedExpGolomb();return 1&R?1+R>>>1:-1*(R>>>1)},this.readBoolean=function(){return this.readBits(1)===1},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};var vy=_p,xp=i,Ay=vy,gc,Wu,Ep;Wu=function(){var m=0,b,C;Wu.prototype.init.call(this),this.push=function(E){var R;C?(R=new Uint8Array(C.byteLength+E.data.byteLength),R.set(C),R.set(E.data,C.byteLength),C=R):C=E.data;for(var N=C.byteLength;m<N-3;m++)if(C[m+2]===1){b=m+5;break}for(;b<N;)switch(C[b]){case 0:if(C[b-1]!==0){b+=2;break}else if(C[b-2]!==0){b++;break}m+3!==b-2&&this.trigger("data",C.subarray(m+3,b-2));do b++;while(C[b]!==1&&b<N);m=b-2,b+=3;break;case 1:if(C[b-1]!==0||C[b-2]!==0){b+=3;break}this.trigger("data",C.subarray(m+3,b-2)),m=b-2,b+=3;break;default:b+=3;break}C=C.subarray(m),b-=m,m=0},this.reset=function(){C=null,m=0,this.trigger("reset")},this.flush=function(){C&&C.byteLength>3&&this.trigger("data",C.subarray(m+3)),C=null,m=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}},Wu.prototype=new xp,Ep={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},gc=function(){var m=new Wu,b,C,E,R,N,he,ye;gc.prototype.init.call(this),b=this,this.push=function(_e){_e.type==="video"&&(C=_e.trackId,E=_e.pts,R=_e.dts,m.push(_e))},m.on("data",function(_e){var Te={trackId:C,pts:E,dts:R,data:_e,nalUnitTypeCode:_e[0]&31};switch(Te.nalUnitTypeCode){case 5:Te.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:Te.nalUnitType="sei_rbsp",Te.escapedRBSP=N(_e.subarray(1));break;case 7:Te.nalUnitType="seq_parameter_set_rbsp",Te.escapedRBSP=N(_e.subarray(1)),Te.config=he(Te.escapedRBSP);break;case 8:Te.nalUnitType="pic_parameter_set_rbsp";break;case 9:Te.nalUnitType="access_unit_delimiter_rbsp";break}b.trigger("data",Te)}),m.on("done",function(){b.trigger("done")}),m.on("partialdone",function(){b.trigger("partialdone")}),m.on("reset",function(){b.trigger("reset")}),m.on("endedtimeline",function(){b.trigger("endedtimeline")}),this.flush=function(){m.flush()},this.partialFlush=function(){m.partialFlush()},this.reset=function(){m.reset()},this.endTimeline=function(){m.endTimeline()},ye=function(_e,Te){var Me=8,ze=8,It,at;for(It=0;It<_e;It++)ze!==0&&(at=Te.readExpGolomb(),ze=(Me+at+256)%256),Me=ze===0?Me:ze},N=function(_e){for(var Te=_e.byteLength,Me=[],ze=1,It,at;ze<Te-2;)_e[ze]===0&&_e[ze+1]===0&&_e[ze+2]===3?(Me.push(ze+2),ze+=2):ze++;if(Me.length===0)return _e;It=Te-Me.length,at=new Uint8Array(It);var Qt=0;for(ze=0;ze<It;Qt++,ze++)Qt===Me[0]&&(Qt++,Me.shift()),at[ze]=_e[Qt];return at},he=function(_e){var Te=0,Me=0,ze=0,It=0,at,Qt,ii,En,qr,yo,Qp,Jp,Zp,Vh,e0,pn=[1,1],t0,vo;if(at=new Ay(_e),Qt=at.readUnsignedByte(),En=at.readUnsignedByte(),ii=at.readUnsignedByte(),at.skipUnsignedExpGolomb(),Ep[Qt]&&(qr=at.readUnsignedExpGolomb(),qr===3&&at.skipBits(1),at.skipUnsignedExpGolomb(),at.skipUnsignedExpGolomb(),at.skipBits(1),at.readBoolean()))for(e0=qr!==3?8:12,vo=0;vo<e0;vo++)at.readBoolean()&&(vo<6?ye(16,at):ye(64,at));if(at.skipUnsignedExpGolomb(),yo=at.readUnsignedExpGolomb(),yo===0)at.readUnsignedExpGolomb();else if(yo===1)for(at.skipBits(1),at.skipExpGolomb(),at.skipExpGolomb(),Qp=at.readUnsignedExpGolomb(),vo=0;vo<Qp;vo++)at.skipExpGolomb();if(at.skipUnsignedExpGolomb(),at.skipBits(1),Jp=at.readUnsignedExpGolomb(),Zp=at.readUnsignedExpGolomb(),Vh=at.readBits(1),Vh===0&&at.skipBits(1),at.skipBits(1),at.readBoolean()&&(Te=at.readUnsignedExpGolomb(),Me=at.readUnsignedExpGolomb(),ze=at.readUnsignedExpGolomb(),It=at.readUnsignedExpGolomb()),at.readBoolean()&&at.readBoolean()){switch(t0=at.readUnsignedByte(),t0){case 1:pn=[1,1];break;case 2:pn=[12,11];break;case 3:pn=[10,11];break;case 4:pn=[16,11];break;case 5:pn=[40,33];break;case 6:pn=[24,11];break;case 7:pn=[20,11];break;case 8:pn=[32,11];break;case 9:pn=[80,33];break;case 10:pn=[18,11];break;case 11:pn=[15,11];break;case 12:pn=[64,33];break;case 13:pn=[160,99];break;case 14:pn=[4,3];break;case 15:pn=[3,2];break;case 16:pn=[2,1];break;case 255:{pn=[at.readUnsignedByte()<<8|at.readUnsignedByte(),at.readUnsignedByte()<<8|at.readUnsignedByte()];break}}pn&&pn[0]/pn[1]}return{profileIdc:Qt,levelIdc:ii,profileCompatibility:En,width:(Jp+1)*16-Te*2-Me*2,height:(2-Vh)*(Zp+1)*16-ze*2-It*2,sarRatio:pn}}},gc.prototype=new xp;var by={H264Stream:gc,NalByteStream:Wu},_y=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],Tp=function(m,b){var C=m[b+6]<<21|m[b+7]<<14|m[b+8]<<7|m[b+9],E=m[b+5],R=(E&16)>>4;return C=C>=0?C:0,R?C+20:C+10},Sp=function(m,b){return m.length-b<10||m[b]!=="I".charCodeAt(0)||m[b+1]!=="D".charCodeAt(0)||m[b+2]!=="3".charCodeAt(0)?b:(b+=Tp(m,b),Sp(m,b))},xy=function(m){var b=Sp(m,0);return m.length>=b+2&&(m[b]&255)==255&&(m[b+1]&240)==240&&(m[b+1]&22)==16},Cp=function(m){return m[0]<<21|m[1]<<14|m[2]<<7|m[3]},Ey=function(m,b,C){var E,R="";for(E=b;E<C;E++)R+="%"+("00"+m[E].toString(16)).slice(-2);return R},Ty=function(m,b,C){return unescape(Ey(m,b,C))},Sy=function(m,b){var C=(m[b+5]&224)>>5,E=m[b+4]<<3,R=m[b+3]&3<<11;return R|E|C},Cy=function(m,b){return m[b]==="I".charCodeAt(0)&&m[b+1]==="D".charCodeAt(0)&&m[b+2]==="3".charCodeAt(0)?"timed-metadata":m[b]&!0&&(m[b+1]&240)==240?"audio":null},wy=function(m){for(var b=0;b+5<m.length;){if(m[b]!==255||(m[b+1]&246)!=240){b++;continue}return _y[(m[b+2]&60)>>>2]}return null},Ly=function(m){var b,C,E,R;b=10,m[5]&64&&(b+=4,b+=Cp(m.subarray(10,14)));do{if(C=Cp(m.subarray(b+4,b+8)),C<1)return null;if(R=String.fromCharCode(m[b],m[b+1],m[b+2],m[b+3]),R==="PRIV"){E=m.subarray(b+10,b+C+10);for(var N=0;N<E.byteLength;N++)if(E[N]===0){var he=Ty(E,0,N);if(he==="com.apple.streaming.transportStreamTimestamp"){var ye=E.subarray(N+1),_e=(ye[3]&1)<<30|ye[4]<<22|ye[5]<<14|ye[6]<<6|ye[7]>>>2;return _e*=4,_e+=ye[7]&3,_e}break}}b+=10,b+=C}while(b<m.byteLength);return null},Rh={isLikelyAacData:xy,parseId3TagSize:Tp,parseAdtsSize:Sy,parseType:Cy,parseSampleRate:wy,parseAacTimestamp:Ly},Dy=i,wp=Rh,yc;yc=function(){var m=new Uint8Array,b=0;yc.prototype.init.call(this),this.setTimestamp=function(C){b=C},this.push=function(C){var E=0,R=0,N,he,ye,_e;for(m.length?(_e=m.length,m=new Uint8Array(C.byteLength+_e),m.set(m.subarray(0,_e)),m.set(C,_e)):m=C;m.length-R>=3;){if(m[R]==="I".charCodeAt(0)&&m[R+1]==="D".charCodeAt(0)&&m[R+2]==="3".charCodeAt(0)){if(m.length-R<10||(E=wp.parseId3TagSize(m,R),R+E>m.length))break;he={type:"timed-metadata",data:m.subarray(R,R+E)},this.trigger("data",he),R+=E;continue}else if((m[R]&255)==255&&(m[R+1]&240)==240){if(m.length-R<7||(E=wp.parseAdtsSize(m,R),R+E>m.length))break;ye={type:"audio",data:m.subarray(R,R+E),pts:b,dts:b},this.trigger("data",ye),R+=E;continue}R++}N=m.length-R,N>0?m=m.subarray(R):m=new Uint8Array},this.reset=function(){m=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){m=new Uint8Array,this.trigger("endedtimeline")}},yc.prototype=new Dy;var ky=yc,Iy=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],Ry=Iy,Py=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],Oy=Py,vc=i,zu=Sg,Yu=Og,Ac=Gg,os=zg,ra=py,bc=Xi,Lp=yy,By=by.H264Stream,My=ky,Fy=Rh.isLikelyAacData,Ny=Xi.ONE_SECOND_IN_TS,Ph=Ry,Oh=Oy,Xu,Cl,_c,mo,Uy=function(m,b){b.stream=m,this.trigger("log",b)},Dp=function(m,b){for(var C=Object.keys(b),E=0;E<C.length;E++){var R=C[E];R==="headOfPipeline"||!b[R].on||b[R].on("log",Uy.bind(m,R))}},kp=function(m,b){var C;if(m.length!==b.length)return!1;for(C=0;C<m.length;C++)if(m[C]!==b[C])return!1;return!0},Bh=function(m,b,C,E,R,N){var he=C-b,ye=E-b,_e=R-C;return{start:{dts:m,pts:m+he},end:{dts:m+ye,pts:m+_e},prependedContentDuration:N,baseMediaDecodeTime:m}};Cl=function(m,b){var C=[],E,R=0,N=0,he=Infinity;b=b||{},E=b.firstSequenceNumber||0,Cl.prototype.init.call(this),this.push=function(ye){os.collectDtsInfo(m,ye),m&&Ph.forEach(function(_e){m[_e]=ye[_e]}),C.push(ye)},this.setEarliestDts=function(ye){R=ye},this.setVideoBaseMediaDecodeTime=function(ye){he=ye},this.setAudioAppendStart=function(ye){N=ye},this.flush=function(){var ye,_e,Te,Me,ze,It,at;if(C.length===0){this.trigger("done","AudioSegmentStream");return}ye=Ac.trimAdtsFramesByEarliestDts(C,m,R),m.baseMediaDecodeTime=os.calculateTrackBaseMediaDecodeTime(m,b.keepOriginalTimestamps),at=Ac.prefixWithSilence(m,ye,N,he),m.samples=Ac.generateSampleTable(ye),Te=zu.mdat(Ac.concatenateFrameData(ye)),C=[],_e=zu.moof(E,[m]),Me=new Uint8Array(_e.byteLength+Te.byteLength),E++,Me.set(_e),Me.set(Te,_e.byteLength),os.clearDtsInfo(m),ze=Math.ceil(Ny*1024/m.samplerate),ye.length&&(It=ye.length*ze,this.trigger("segmentTimingInfo",Bh(bc.audioTsToVideoTs(m.baseMediaDecodeTime,m.samplerate),ye[0].dts,ye[0].pts,ye[0].dts+It,ye[0].pts+It,at||0)),this.trigger("timingInfo",{start:ye[0].pts,end:ye[0].pts+It})),this.trigger("data",{track:m,boxes:Me}),this.trigger("done","AudioSegmentStream")},this.reset=function(){os.clearDtsInfo(m),C=[],this.trigger("reset")}},Cl.prototype=new vc,Xu=function(m,b){var C,E=[],R=[],N,he;b=b||{},C=b.firstSequenceNumber||0,Xu.prototype.init.call(this),delete m.minPTS,this.gopCache_=[],this.push=function(ye){os.collectDtsInfo(m,ye),ye.nalUnitType==="seq_parameter_set_rbsp"&&!N&&(N=ye.config,m.sps=[ye.data],Oh.forEach(function(_e){m[_e]=N[_e]},this)),ye.nalUnitType==="pic_parameter_set_rbsp"&&!he&&(he=ye.data,m.pps=[ye.data]),E.push(ye)},this.flush=function(){for(var ye,_e,Te,Me,ze,It,at=0,Qt,ii;E.length&&E[0].nalUnitType!=="access_unit_delimiter_rbsp";)E.shift();if(E.length===0){this.resetStream_(),this.trigger("done","VideoSegmentStream");return}if(ye=Yu.groupNalsIntoFrames(E),Te=Yu.groupFramesIntoGops(ye),Te[0][0].keyFrame||(_e=this.getGopForFusion_(E[0],m),_e?(at=_e.duration,Te.unshift(_e),Te.byteLength+=_e.byteLength,Te.nalCount+=_e.nalCount,Te.pts=_e.pts,Te.dts=_e.dts,Te.duration+=_e.duration):Te=Yu.extendFirstKeyFrame(Te)),R.length){var En;if(b.alignGopsAtEnd?En=this.alignGopsAtEnd_(Te):En=this.alignGopsAtStart_(Te),!En){this.gopCache_.unshift({gop:Te.pop(),pps:m.pps,sps:m.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),E=[],this.resetStream_(),this.trigger("done","VideoSegmentStream");return}os.clearDtsInfo(m),Te=En}os.collectDtsInfo(m,Te),m.samples=Yu.generateSampleTable(Te),ze=zu.mdat(Yu.concatenateNalData(Te)),m.baseMediaDecodeTime=os.calculateTrackBaseMediaDecodeTime(m,b.keepOriginalTimestamps),this.trigger("processedGopsInfo",Te.map(function(qr){return{pts:qr.pts,dts:qr.dts,byteLength:qr.byteLength}})),Qt=Te[0],ii=Te[Te.length-1],this.trigger("segmentTimingInfo",Bh(m.baseMediaDecodeTime,Qt.dts,Qt.pts,ii.dts+ii.duration,ii.pts+ii.duration,at)),this.trigger("timingInfo",{start:Te[0].pts,end:Te[Te.length-1].pts+Te[Te.length-1].duration}),this.gopCache_.unshift({gop:Te.pop(),pps:m.pps,sps:m.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),E=[],this.trigger("baseMediaDecodeTime",m.baseMediaDecodeTime),this.trigger("timelineStartInfo",m.timelineStartInfo),Me=zu.moof(C,[m]),It=new Uint8Array(Me.byteLength+ze.byteLength),C++,It.set(Me),It.set(ze,Me.byteLength),this.trigger("data",{track:m,boxes:It}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),E=[],this.gopCache_.length=0,R.length=0,this.trigger("reset")},this.resetStream_=function(){os.clearDtsInfo(m),N=void 0,he=void 0},this.getGopForFusion_=function(ye){var _e=45e3,Te=1e4,Me=Infinity,ze,It,at,Qt,ii;for(ii=0;ii<this.gopCache_.length;ii++)Qt=this.gopCache_[ii],at=Qt.gop,!(!(m.pps&&kp(m.pps[0],Qt.pps[0]))||!(m.sps&&kp(m.sps[0],Qt.sps[0])))&&(at.dts<m.timelineStartInfo.dts||(ze=ye.dts-at.dts-at.duration,ze>=-Te&&ze<=_e&&(!It||Me>ze)&&(It=Qt,Me=ze)));return It?It.gop:null},this.alignGopsAtStart_=function(ye){var _e,Te,Me,ze,It,at,Qt,ii;for(It=ye.byteLength,at=ye.nalCount,Qt=ye.duration,_e=Te=0;_e<R.length&&Te<ye.length&&(Me=R[_e],ze=ye[Te],Me.pts!==ze.pts);){if(ze.pts>Me.pts){_e++;continue}Te++,It-=ze.byteLength,at-=ze.nalCount,Qt-=ze.duration}return Te===0?ye:Te===ye.length?null:(ii=ye.slice(Te),ii.byteLength=It,ii.duration=Qt,ii.nalCount=at,ii.pts=ii[0].pts,ii.dts=ii[0].dts,ii)},this.alignGopsAtEnd_=function(ye){var _e,Te,Me,ze,It,at;for(_e=R.length-1,Te=ye.length-1,It=null,at=!1;_e>=0&&Te>=0;){if(Me=R[_e],ze=ye[Te],Me.pts===ze.pts){at=!0;break}if(Me.pts>ze.pts){_e--;continue}_e===R.length-1&&(It=Te),Te--}if(!at&&It===null)return null;var Qt;if(at?Qt=Te:Qt=It,Qt===0)return ye;var ii=ye.slice(Qt),En=ii.reduce(function(qr,yo){return qr.byteLength+=yo.byteLength,qr.duration+=yo.duration,qr.nalCount+=yo.nalCount,qr},{byteLength:0,duration:0,nalCount:0});return ii.byteLength=En.byteLength,ii.duration=En.duration,ii.nalCount=En.nalCount,ii.pts=ii[0].pts,ii.dts=ii[0].dts,ii},this.alignGopsWith=function(ye){R=ye}},Xu.prototype=new vc,mo=function(m,b){this.numberOfTracks=0,this.metadataStream=b,m=m||{},typeof m.remux!="undefined"?this.remuxTracks=!!m.remux:this.remuxTracks=!0,typeof m.keepOriginalTimestamps=="boolean"?this.keepOriginalTimestamps=m.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,mo.prototype.init.call(this),this.push=function(C){if(C.content||C.text)return this.pendingCaptions.push(C);if(C.frames)return this.pendingMetadata.push(C);this.pendingTracks.push(C.track),this.pendingBytes+=C.boxes.byteLength,C.track.type==="video"&&(this.videoTrack=C.track,this.pendingBoxes.push(C.boxes)),C.track.type==="audio"&&(this.audioTrack=C.track,this.pendingBoxes.unshift(C.boxes))}},mo.prototype=new vc,mo.prototype.flush=function(m){var b=0,C={captions:[],captionStreams:{},metadata:[],info:{}},E,R,N,he=0,ye;if(this.pendingTracks.length<this.numberOfTracks){if(m!=="VideoSegmentStream"&&m!=="AudioSegmentStream")return;if(this.remuxTracks)return;if(this.pendingTracks.length===0){this.emittedTracks++,this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0);return}}if(this.videoTrack?(he=this.videoTrack.timelineStartInfo.pts,Oh.forEach(function(_e){C.info[_e]=this.videoTrack[_e]},this)):this.audioTrack&&(he=this.audioTrack.timelineStartInfo.pts,Ph.forEach(function(_e){C.info[_e]=this.audioTrack[_e]},this)),this.videoTrack||this.audioTrack){for(this.pendingTracks.length===1?C.type=this.pendingTracks[0].type:C.type="combined",this.emittedTracks+=this.pendingTracks.length,N=zu.initSegment(this.pendingTracks),C.initSegment=new Uint8Array(N.byteLength),C.initSegment.set(N),C.data=new Uint8Array(this.pendingBytes),ye=0;ye<this.pendingBoxes.length;ye++)C.data.set(this.pendingBoxes[ye],b),b+=this.pendingBoxes[ye].byteLength;for(ye=0;ye<this.pendingCaptions.length;ye++)E=this.pendingCaptions[ye],E.startTime=bc.metadataTsToSeconds(E.startPts,he,this.keepOriginalTimestamps),E.endTime=bc.metadataTsToSeconds(E.endPts,he,this.keepOriginalTimestamps),C.captionStreams[E.stream]=!0,C.captions.push(E);for(ye=0;ye<this.pendingMetadata.length;ye++)R=this.pendingMetadata[ye],R.cueTime=bc.metadataTsToSeconds(R.pts,he,this.keepOriginalTimestamps),C.metadata.push(R);for(C.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",C),ye=0;ye<C.captions.length;ye++)E=C.captions[ye],this.trigger("caption",E);for(ye=0;ye<C.metadata.length;ye++)R=C.metadata[ye],this.trigger("id3Frame",R)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},mo.prototype.setRemux=function(m){this.remuxTracks=m},_c=function(m){var b=this,C=!0,E,R;_c.prototype.init.call(this),m=m||{},this.baseMediaDecodeTime=m.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var N={};this.transmuxPipeline_=N,N.type="aac",N.metadataStream=new ra.MetadataStream,N.aacStream=new My,N.audioTimestampRolloverStream=new ra.TimestampRolloverStream("audio"),N.timedMetadataTimestampRolloverStream=new ra.TimestampRolloverStream("timed-metadata"),N.adtsStream=new Lp,N.coalesceStream=new mo(m,N.metadataStream),N.headOfPipeline=N.aacStream,N.aacStream.pipe(N.audioTimestampRolloverStream).pipe(N.adtsStream),N.aacStream.pipe(N.timedMetadataTimestampRolloverStream).pipe(N.metadataStream).pipe(N.coalesceStream),N.metadataStream.on("timestamp",function(he){N.aacStream.setTimestamp(he.timeStamp)}),N.aacStream.on("data",function(he){he.type!=="timed-metadata"&&he.type!=="audio"||N.audioSegmentStream||(R=R||{timelineStartInfo:{baseMediaDecodeTime:b.baseMediaDecodeTime},codec:"adts",type:"audio"},N.coalesceStream.numberOfTracks++,N.audioSegmentStream=new Cl(R,m),N.audioSegmentStream.on("log",b.getLogTrigger_("audioSegmentStream")),N.audioSegmentStream.on("timingInfo",b.trigger.bind(b,"audioTimingInfo")),N.adtsStream.pipe(N.audioSegmentStream).pipe(N.coalesceStream),b.trigger("trackinfo",{hasAudio:!!R,hasVideo:!!E}))}),N.coalesceStream.on("data",this.trigger.bind(this,"data")),N.coalesceStream.on("done",this.trigger.bind(this,"done")),Dp(this,N)},this.setupTsPipeline=function(){var N={};this.transmuxPipeline_=N,N.type="ts",N.metadataStream=new ra.MetadataStream,N.packetStream=new ra.TransportPacketStream,N.parseStream=new ra.TransportParseStream,N.elementaryStream=new ra.ElementaryStream,N.timestampRolloverStream=new ra.TimestampRolloverStream,N.adtsStream=new Lp,N.h264Stream=new By,N.captionStream=new ra.CaptionStream(m),N.coalesceStream=new mo(m,N.metadataStream),N.headOfPipeline=N.packetStream,N.packetStream.pipe(N.parseStream).pipe(N.elementaryStream).pipe(N.timestampRolloverStream),N.timestampRolloverStream.pipe(N.h264Stream),N.timestampRolloverStream.pipe(N.adtsStream),N.timestampRolloverStream.pipe(N.metadataStream).pipe(N.coalesceStream),N.h264Stream.pipe(N.captionStream).pipe(N.coalesceStream),N.elementaryStream.on("data",function(he){var ye;if(he.type==="metadata"){for(ye=he.tracks.length;ye--;)!E&&he.tracks[ye].type==="video"?(E=he.tracks[ye],E.timelineStartInfo.baseMediaDecodeTime=b.baseMediaDecodeTime):!R&&he.tracks[ye].type==="audio"&&(R=he.tracks[ye],R.timelineStartInfo.baseMediaDecodeTime=b.baseMediaDecodeTime);E&&!N.videoSegmentStream&&(N.coalesceStream.numberOfTracks++,N.videoSegmentStream=new Xu(E,m),N.videoSegmentStream.on("log",b.getLogTrigger_("videoSegmentStream")),N.videoSegmentStream.on("timelineStartInfo",function(_e){R&&!m.keepOriginalTimestamps&&(R.timelineStartInfo=_e,N.audioSegmentStream.setEarliestDts(_e.dts-b.baseMediaDecodeTime))}),N.videoSegmentStream.on("processedGopsInfo",b.trigger.bind(b,"gopInfo")),N.videoSegmentStream.on("segmentTimingInfo",b.trigger.bind(b,"videoSegmentTimingInfo")),N.videoSegmentStream.on("baseMediaDecodeTime",function(_e){R&&N.audioSegmentStream.setVideoBaseMediaDecodeTime(_e)}),N.videoSegmentStream.on("timingInfo",b.trigger.bind(b,"videoTimingInfo")),N.h264Stream.pipe(N.videoSegmentStream).pipe(N.coalesceStream)),R&&!N.audioSegmentStream&&(N.coalesceStream.numberOfTracks++,N.audioSegmentStream=new Cl(R,m),N.audioSegmentStream.on("log",b.getLogTrigger_("audioSegmentStream")),N.audioSegmentStream.on("timingInfo",b.trigger.bind(b,"audioTimingInfo")),N.audioSegmentStream.on("segmentTimingInfo",b.trigger.bind(b,"audioSegmentTimingInfo")),N.adtsStream.pipe(N.audioSegmentStream).pipe(N.coalesceStream)),b.trigger("trackinfo",{hasAudio:!!R,hasVideo:!!E})}}),N.coalesceStream.on("data",this.trigger.bind(this,"data")),N.coalesceStream.on("id3Frame",function(he){he.dispatchType=N.metadataStream.dispatchType,b.trigger("id3Frame",he)}),N.coalesceStream.on("caption",this.trigger.bind(this,"caption")),N.coalesceStream.on("done",this.trigger.bind(this,"done")),Dp(this,N)},this.setBaseMediaDecodeTime=function(N){var he=this.transmuxPipeline_;m.keepOriginalTimestamps||(this.baseMediaDecodeTime=N),R&&(R.timelineStartInfo.dts=void 0,R.timelineStartInfo.pts=void 0,os.clearDtsInfo(R),he.audioTimestampRolloverStream&&he.audioTimestampRolloverStream.discontinuity()),E&&(he.videoSegmentStream&&(he.videoSegmentStream.gopCache_=[]),E.timelineStartInfo.dts=void 0,E.timelineStartInfo.pts=void 0,os.clearDtsInfo(E),he.captionStream.reset()),he.timestampRolloverStream&&he.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(N){R&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(N)},this.setRemux=function(N){var he=this.transmuxPipeline_;m.remux=N,he&&he.coalesceStream&&he.coalesceStream.setRemux(N)},this.alignGopsWith=function(N){E&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(N)},this.getLogTrigger_=function(N){var he=this;return function(ye){ye.stream=N,he.trigger("log",ye)}},this.push=function(N){if(C){var he=Fy(N);he&&this.transmuxPipeline_.type!=="aac"?this.setupAacPipeline():!he&&this.transmuxPipeline_.type!=="ts"&&this.setupTsPipeline(),C=!1}this.transmuxPipeline_.headOfPipeline.push(N)},this.flush=function(){C=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}},_c.prototype=new vc;var jy={Transmuxer:_c,VideoSegmentStream:Xu,AudioSegmentStream:Cl,AUDIO_PROPERTIES:Ph,VIDEO_PROPERTIES:Oh,generateSegmentTimingInfo:Bh},$y=function(m){return m>>>0},Vy=function(m){return("00"+m.toString(16)).slice(-2)},xc={toUnsigned:$y,toHexString:Vy},Gy=function(m){var b="";return b+=String.fromCharCode(m[0]),b+=String.fromCharCode(m[1]),b+=String.fromCharCode(m[2]),b+=String.fromCharCode(m[3]),b},Ip=Gy,Hy=xc.toUnsigned,qy=Ip,Rp=function(m,b){var C=[],E,R,N,he,ye;if(!b.length)return null;for(E=0;E<m.byteLength;)R=Hy(m[E]<<24|m[E+1]<<16|m[E+2]<<8|m[E+3]),N=qy(m.subarray(E+4,E+8)),he=R>1?E+R:m.byteLength,N===b[0]&&(b.length===1?C.push(m.subarray(E+8,he)):(ye=Rp(m.subarray(E+8,he),b.slice(1)),ye.length&&(C=C.concat(ye)))),E=he;return C},Pp=Rp,Ky=xc.toUnsigned,Wy=d.getUint64,zy=function(m){var b={version:m[0],flags:new Uint8Array(m.subarray(1,4))};return b.version===1?b.baseMediaDecodeTime=Wy(m.subarray(4)):b.baseMediaDecodeTime=Ky(m[4]<<24|m[5]<<16|m[6]<<8|m[7]),b},Op=zy,Yy=function(m){return{isLeading:(m[0]&12)>>>2,dependsOn:m[0]&3,isDependedOn:(m[1]&192)>>>6,hasRedundancy:(m[1]&48)>>>4,paddingValue:(m[1]&14)>>>1,isNonSyncSample:m[1]&1,degradationPriority:m[2]<<8|m[3]}},Xy=Yy,Bp=Xy,Qy=function(m){var b={version:m[0],flags:new Uint8Array(m.subarray(1,4)),samples:[]},C=new DataView(m.buffer,m.byteOffset,m.byteLength),E=b.flags[2]&1,R=b.flags[2]&4,N=b.flags[1]&1,he=b.flags[1]&2,ye=b.flags[1]&4,_e=b.flags[1]&8,Te=C.getUint32(4),Me=8,ze;for(E&&(b.dataOffset=C.getInt32(Me),Me+=4),R&&Te&&(ze={flags:Bp(m.subarray(Me,Me+4))},Me+=4,N&&(ze.duration=C.getUint32(Me),Me+=4),he&&(ze.size=C.getUint32(Me),Me+=4),_e&&(b.version===1?ze.compositionTimeOffset=C.getInt32(Me):ze.compositionTimeOffset=C.getUint32(Me),Me+=4),b.samples.push(ze),Te--);Te--;)ze={},N&&(ze.duration=C.getUint32(Me),Me+=4),he&&(ze.size=C.getUint32(Me),Me+=4),ye&&(ze.flags=Bp(m.subarray(Me,Me+4)),Me+=4),_e&&(b.version===1?ze.compositionTimeOffset=C.getInt32(Me):ze.compositionTimeOffset=C.getUint32(Me),Me+=4),b.samples.push(ze);return b},Mp=Qy,Jy=function(m){var b=new DataView(m.buffer,m.byteOffset,m.byteLength),C={version:m[0],flags:new Uint8Array(m.subarray(1,4)),trackId:b.getUint32(4)},E=C.flags[2]&1,R=C.flags[2]&2,N=C.flags[2]&8,he=C.flags[2]&16,ye=C.flags[2]&32,_e=C.flags[0]&65536,Te=C.flags[0]&131072,Me;return Me=8,E&&(Me+=4,C.baseDataOffset=b.getUint32(12),Me+=4),R&&(C.sampleDescriptionIndex=b.getUint32(Me),Me+=4),N&&(C.defaultSampleDuration=b.getUint32(Me),Me+=4),he&&(C.defaultSampleSize=b.getUint32(Me),Me+=4),ye&&(C.defaultSampleFlags=b.getUint32(Me)),_e&&(C.durationIsEmpty=!0),!E&&Te&&(C.baseDataOffsetIsMoof=!0),C},Fp=Jy,Qu;typeof window!="undefined"?Qu=window:typeof s!="undefined"?Qu=s:typeof self!="undefined"?Qu=self:Qu={};var Np=Qu,Zy=fp.discardEmulationPreventionBytes,ev=pp.CaptionStream,Ju=Pp,tv=Op,iv=Mp,nv=Fp,Up=Np,rv=function(m,b){for(var C=m,E=0;E<b.length;E++){var R=b[E];if(C<R.size)return R;C-=R.size}return null},sv=function(m,b,C){var E=new DataView(m.buffer,m.byteOffset,m.byteLength),R={logs:[],seiNals:[]},N,he,ye,_e;for(he=0;he+4<m.length;he+=ye)if(ye=E.getUint32(he),he+=4,!(ye<=0))switch(m[he]&31){case 6:var Te=m.subarray(he+1,he+1+ye),Me=rv(he,b);if(N={nalUnitType:"sei_rbsp",size:ye,data:Te,escapedRBSP:Zy(Te),trackId:C},Me)N.pts=Me.pts,N.dts=Me.dts,_e=Me;else if(_e)N.pts=_e.pts,N.dts=_e.dts;else{R.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+he+" for trackId "+C+". See mux.js#223."});break}R.seiNals.push(N);break}return R},av=function(m,b,C){var E=b,R=C.defaultSampleDuration||0,N=C.defaultSampleSize||0,he=C.trackId,ye=[];return m.forEach(function(_e){var Te=iv(_e),Me=Te.samples;Me.forEach(function(ze){ze.duration===void 0&&(ze.duration=R),ze.size===void 0&&(ze.size=N),ze.trackId=he,ze.dts=E,ze.compositionTimeOffset===void 0&&(ze.compositionTimeOffset=0),typeof E=="bigint"?(ze.pts=E+Up.BigInt(ze.compositionTimeOffset),E+=Up.BigInt(ze.duration)):(ze.pts=E+ze.compositionTimeOffset,E+=ze.duration)}),ye=ye.concat(Me)}),ye},ov=function(m,b){var C=Ju(m,["moof","traf"]),E=Ju(m,["mdat"]),R={},N=[];return E.forEach(function(he,ye){var _e=C[ye];N.push({mdat:he,traf:_e})}),N.forEach(function(he){var ye=he.mdat,_e=he.traf,Te=Ju(_e,["tfhd"]),Me=nv(Te[0]),ze=Me.trackId,It=Ju(_e,["tfdt"]),at=It.length>0?tv(It[0]).baseMediaDecodeTime:0,Qt=Ju(_e,["trun"]),ii,En;b===ze&&Qt.length>0&&(ii=av(Qt,at,Me),En=sv(ye,ii,ze),R[ze]||(R[ze]={seiNals:[],logs:[]}),R[ze].seiNals=R[ze].seiNals.concat(En.seiNals),R[ze].logs=R[ze].logs.concat(En.logs))}),R},lv=function(m,b,C){var E;if(b===null)return null;E=ov(m,b);var R=E[b]||{};return{seiNals:R.seiNals,logs:R.logs,timescale:C}},uv=function(){var m=!1,b,C,E,R,N,he;this.isInitialized=function(){return m},this.init=function(ye){b=new ev,m=!0,he=ye?ye.isPartial:!1,b.on("data",function(_e){_e.startTime=_e.startPts/R,_e.endTime=_e.endPts/R,N.captions.push(_e),N.captionStreams[_e.stream]=!0}),b.on("log",function(_e){N.logs.push(_e)})},this.isNewInit=function(ye,_e){return ye&&ye.length===0||_e&&typeof _e=="object"&&Object.keys(_e).length===0?!1:E!==ye[0]||R!==_e[E]},this.parse=function(ye,_e,Te){var Me;if(this.isInitialized()){if(!_e||!Te)return null;if(this.isNewInit(_e,Te))E=_e[0],R=Te[E];else if(E===null||!R)return C.push(ye),null}else return null;for(;C.length>0;){var ze=C.shift();this.parse(ze,_e,Te)}return Me=lv(ye,E,R),Me&&Me.logs&&(N.logs=N.logs.concat(Me.logs)),Me===null||!Me.seiNals?N.logs.length?{logs:N.logs,captions:[],captionStreams:[]}:null:(this.pushNals(Me.seiNals),this.flushStream(),N)},this.pushNals=function(ye){if(!this.isInitialized()||!ye||ye.length===0)return null;ye.forEach(function(_e){b.push(_e)})},this.flushStream=function(){if(!this.isInitialized())return null;he?b.partialFlush():b.flush()},this.clearParsedCaptions=function(){N.captions=[],N.captionStreams={},N.logs=[]},this.resetCaptionStream=function(){if(!this.isInitialized())return null;b.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){C=[],E=null,R=null,N?this.clearParsedCaptions():N={captions:[],captionStreams:{},logs:[]},this.resetCaptionStream()},this.reset()},dv=uv,cv=function(m){for(var b=0,C=String.fromCharCode(m[b]),E="";C!=="\0";)E+=C,b++,C=String.fromCharCode(m[b]);return E+=C,E},hv={uint8ToCString:cv},Ec=hv.uint8ToCString,fv=d.getUint64,pv=function(m){var b=4,C=m[0],E,R,N,he,ye,_e,Te,Me;if(C===0){E=Ec(m.subarray(b)),b+=E.length,R=Ec(m.subarray(b)),b+=R.length;var ze=new DataView(m.buffer);N=ze.getUint32(b),b+=4,ye=ze.getUint32(b),b+=4,_e=ze.getUint32(b),b+=4,Te=ze.getUint32(b),b+=4}else if(C===1){var ze=new DataView(m.buffer);N=ze.getUint32(b),b+=4,he=fv(m.subarray(b)),b+=8,_e=ze.getUint32(b),b+=4,Te=ze.getUint32(b),b+=4,E=Ec(m.subarray(b)),b+=E.length,R=Ec(m.subarray(b)),b+=R.length}Me=new Uint8Array(m.subarray(b,m.byteLength));var It={scheme_id_uri:E,value:R,timescale:N||1,presentation_time:he,presentation_time_delta:ye,event_duration:_e,id:Te,message_data:Me};return gv(C,It)?It:void 0},mv=function(m,b,C,E){return m||m===0?m/b:E+C/b},gv=function(m,b){var C=b.scheme_id_uri!=="\0",E=m===0&&jp(b.presentation_time_delta)&&C,R=m===1&&jp(b.presentation_time)&&C;return!(m>1)&&E||R},jp=function(m){return m!==void 0||m!==null},yv={parseEmsgBox:pv,scaleTime:mv},Tc=xc.toUnsigned,Zu=xc.toHexString,fn=Pp,wl=Ip,Mh=yv,vv=Fp,Av=Mp,bv=Op,_v=d.getUint64,$p,Vp,Gp,Hp,qp,Fh,Kp,Nh=Np,xv=vp.parseId3Frames;$p=function(m){var b={},C=fn(m,["moov","trak"]);return C.reduce(function(E,R){var N,he,ye,_e,Te;return N=fn(R,["tkhd"])[0],!N||(he=N[0],ye=he===0?12:20,_e=Tc(N[ye]<<24|N[ye+1]<<16|N[ye+2]<<8|N[ye+3]),Te=fn(R,["mdia","mdhd"])[0],!Te)?null:(he=Te[0],ye=he===0?12:20,E[_e]=Tc(Te[ye]<<24|Te[ye+1]<<16|Te[ye+2]<<8|Te[ye+3]),E)},b)},Vp=function(m,b){var C;C=fn(b,["moof","traf"]);var E=C.reduce(function(R,N){var he=fn(N,["tfhd"])[0],ye=Tc(he[4]<<24|he[5]<<16|he[6]<<8|he[7]),_e=m[ye]||9e4,Te=fn(N,["tfdt"])[0],Me=new DataView(Te.buffer,Te.byteOffset,Te.byteLength),ze;Te[0]===1?ze=_v(Te.subarray(4,12)):ze=Me.getUint32(4);let It;return typeof ze=="bigint"?It=ze/Nh.BigInt(_e):typeof ze=="number"&&!isNaN(ze)&&(It=ze/_e),It<Number.MAX_SAFE_INTEGER&&(It=Number(It)),It<R&&(R=It),R},Infinity);return typeof E=="bigint"||isFinite(E)?E:0},Gp=function(m,b){var C=fn(b,["moof","traf"]),E=0,R=0,N;if(C&&C.length){var he=fn(C[0],["tfhd"])[0],ye=fn(C[0],["trun"])[0],_e=fn(C[0],["tfdt"])[0];if(he){var Te=vv(he);N=Te.trackId}if(_e){var Me=bv(_e);E=Me.baseMediaDecodeTime}if(ye){var ze=Av(ye);ze.samples&&ze.samples.length&&(R=ze.samples[0].compositionTimeOffset||0)}}var It=m[N]||9e4;typeof E=="bigint"&&(R=Nh.BigInt(R),It=Nh.BigInt(It));var at=(E+R)/It;return typeof at=="bigint"&&at<Number.MAX_SAFE_INTEGER&&(at=Number(at)),at},Hp=function(m){var b=fn(m,["moov","trak"]),C=[];return b.forEach(function(E){var R=fn(E,["mdia","hdlr"]),N=fn(E,["tkhd"]);R.forEach(function(he,ye){var _e=wl(he.subarray(8,12)),Te=N[ye],Me,ze,It;_e==="vide"&&(Me=new DataView(Te.buffer,Te.byteOffset,Te.byteLength),ze=Me.getUint8(0),It=ze===0?Me.getUint32(12):Me.getUint32(20),C.push(It))})}),C},Fh=function(m){var b=m[0],C=b===0?12:20;return Tc(m[C]<<24|m[C+1]<<16|m[C+2]<<8|m[C+3])},qp=function(m){var b=fn(m,["moov","trak"]),C=[];return b.forEach(function(E){var R={},N=fn(E,["tkhd"])[0],he,ye;N&&(he=new DataView(N.buffer,N.byteOffset,N.byteLength),ye=he.getUint8(0),R.id=ye===0?he.getUint32(12):he.getUint32(20));var _e=fn(E,["mdia","hdlr"])[0];if(_e){var Te=wl(_e.subarray(8,12));Te==="vide"?R.type="video":Te==="soun"?R.type="audio":R.type=Te}var Me=fn(E,["mdia","minf","stbl","stsd"])[0];if(Me){var ze=Me.subarray(8);R.codec=wl(ze.subarray(4,8));var It=fn(ze,[R.codec])[0],at,Qt;It&&(/^[asm]vc[1-9]$/i.test(R.codec)?(at=It.subarray(78),Qt=wl(at.subarray(4,8)),Qt==="avcC"&&at.length>11?(R.codec+=".",R.codec+=Zu(at[9]),R.codec+=Zu(at[10]),R.codec+=Zu(at[11])):R.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(R.codec)?(at=It.subarray(28),Qt=wl(at.subarray(4,8)),Qt==="esds"&&at.length>20&&at[19]!==0?(R.codec+="."+Zu(at[19]),R.codec+="."+Zu(at[20]>>>2&63).replace(/^0/,"")):R.codec="mp4a.40.2"):R.codec=R.codec.toLowerCase())}var ii=fn(E,["mdia","mdhd"])[0];ii&&(R.timescale=Fh(ii)),C.push(R)}),C},Kp=function(m,b=0){var C=fn(m,["emsg"]);return C.map(E=>{var R=Mh.parseEmsgBox(new Uint8Array(E)),N=xv(R.message_data);return{cueTime:Mh.scaleTime(R.presentation_time,R.timescale,R.presentation_time_delta,b),duration:Mh.scaleTime(R.event_duration,R.timescale),frames:N}})};var Uh={findBox:fn,parseType:wl,timescale:$p,startTime:Vp,compositionStartTime:Gp,videoTrackIds:Hp,tracks:qp,getTimescaleFromMediaHeader:Fh,getEmsgID3:Kp},jh=uc,Wp=function(m){var b=m[1]&31;return b<<=8,b|=m[2],b},Sc=function(m){return!!(m[1]&64)},Cc=function(m){var b=0;return(m[3]&48)>>>4>1&&(b+=m[4]+1),b},Ev=function(m,b){var C=Wp(m);return C===0?"pat":C===b?"pmt":b?"pes":null},Tv=function(m){var b=Sc(m),C=4+Cc(m);return b&&(C+=m[C]+1),(m[C+10]&31)<<8|m[C+11]},Sv=function(m){var b={},C=Sc(m),E=4+Cc(m);if(C&&(E+=m[E]+1),!!(m[E+5]&1)){var R,N,he;R=(m[E+1]&15)<<8|m[E+2],N=3+R-4,he=(m[E+10]&15)<<8|m[E+11];for(var ye=12+he;ye<N;){var _e=E+ye;b[(m[_e+1]&31)<<8|m[_e+2]]=m[_e],ye+=((m[_e+3]&15)<<8|m[_e+4])+5}return b}},Cv=function(m,b){var C=Wp(m),E=b[C];switch(E){case jh.H264_STREAM_TYPE:return"video";case jh.ADTS_STREAM_TYPE:return"audio";case jh.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},wv=function(m){var b=Sc(m);if(!b)return null;var C=4+Cc(m);if(C>=m.byteLength)return null;var E=null,R;return R=m[C+7],R&192&&(E={},E.pts=(m[C+9]&14)<<27|(m[C+10]&255)<<20|(m[C+11]&254)<<12|(m[C+12]&255)<<5|(m[C+13]&254)>>>3,E.pts*=4,E.pts+=(m[C+13]&6)>>>1,E.dts=E.pts,R&64&&(E.dts=(m[C+14]&14)<<27|(m[C+15]&255)<<20|(m[C+16]&254)<<12|(m[C+17]&255)<<5|(m[C+18]&254)>>>3,E.dts*=4,E.dts+=(m[C+18]&6)>>>1)),E},$h=function(m){switch(m){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},Lv=function(m){for(var b=4+Cc(m),C=m.subarray(b),E=0,R=0,N=!1,he;R<C.byteLength-3;R++)if(C[R+2]===1){E=R+5;break}for(;E<C.byteLength;)switch(C[E]){case 0:if(C[E-1]!==0){E+=2;break}else if(C[E-2]!==0){E++;break}R+3!==E-2&&(he=$h(C[R+3]&31),he==="slice_layer_without_partitioning_rbsp_idr"&&(N=!0));do E++;while(C[E]!==1&&E<C.length);R=E-2,E+=3;break;case 1:if(C[E-1]!==0||C[E-2]!==0){E+=3;break}he=$h(C[R+3]&31),he==="slice_layer_without_partitioning_rbsp_idr"&&(N=!0),R=E-2,E+=3;break;default:E+=3;break}return C=C.subarray(R),E-=R,R=0,C&&C.byteLength>3&&(he=$h(C[R+3]&31),he==="slice_layer_without_partitioning_rbsp_idr"&&(N=!0)),N},Dv={parseType:Ev,parsePat:Tv,parsePmt:Sv,parsePayloadUnitStartIndicator:Sc,parsePesType:Cv,parsePesTime:wv,videoPacketContainsKeyFrame:Lv},zp=uc,Ll=gp.handleRollover,Fi={};Fi.ts=Dv,Fi.aac=Rh;var go=Xi.ONE_SECOND_IN_TS,Yn=188,ks=71,kv=function(m,b){for(var C=0,E=Yn,R,N;E<m.byteLength;){if(m[C]===ks&&m[E]===ks){switch(R=m.subarray(C,E),N=Fi.ts.parseType(R,b.pid),N){case"pat":b.pid=Fi.ts.parsePat(R);break;case"pmt":var he=Fi.ts.parsePmt(R);b.table=b.table||{},Object.keys(he).forEach(function(ye){b.table[ye]=he[ye]});break}C+=Yn,E+=Yn;continue}C++,E++}},Yp=function(m,b,C){for(var E=0,R=Yn,N,he,ye,_e,Te,Me=!1;R<=m.byteLength;){if(m[E]===ks&&(m[R]===ks||R===m.byteLength)){switch(N=m.subarray(E,R),he=Fi.ts.parseType(N,b.pid),he){case"pes":ye=Fi.ts.parsePesType(N,b.table),_e=Fi.ts.parsePayloadUnitStartIndicator(N),ye==="audio"&&_e&&(Te=Fi.ts.parsePesTime(N),Te&&(Te.type="audio",C.audio.push(Te),Me=!0));break}if(Me)break;E+=Yn,R+=Yn;continue}E++,R++}for(R=m.byteLength,E=R-Yn,Me=!1;E>=0;){if(m[E]===ks&&(m[R]===ks||R===m.byteLength)){switch(N=m.subarray(E,R),he=Fi.ts.parseType(N,b.pid),he){case"pes":ye=Fi.ts.parsePesType(N,b.table),_e=Fi.ts.parsePayloadUnitStartIndicator(N),ye==="audio"&&_e&&(Te=Fi.ts.parsePesTime(N),Te&&(Te.type="audio",C.audio.push(Te),Me=!0));break}if(Me)break;E-=Yn,R-=Yn;continue}E--,R--}},Iv=function(m,b,C){for(var E=0,R=Yn,N,he,ye,_e,Te,Me,ze,It,at=!1,Qt={data:[],size:0};R<m.byteLength;){if(m[E]===ks&&m[R]===ks){switch(N=m.subarray(E,R),he=Fi.ts.parseType(N,b.pid),he){case"pes":if(ye=Fi.ts.parsePesType(N,b.table),_e=Fi.ts.parsePayloadUnitStartIndicator(N),ye==="video"&&(_e&&!at&&(Te=Fi.ts.parsePesTime(N),Te&&(Te.type="video",C.video.push(Te),at=!0)),!C.firstKeyFrame)){if(_e&&Qt.size!==0){for(Me=new Uint8Array(Qt.size),ze=0;Qt.data.length;)It=Qt.data.shift(),Me.set(It,ze),ze+=It.byteLength;if(Fi.ts.videoPacketContainsKeyFrame(Me)){var ii=Fi.ts.parsePesTime(Me);ii?(C.firstKeyFrame=ii,C.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}Qt.size=0}Qt.data.push(N),Qt.size+=N.byteLength}break}if(at&&C.firstKeyFrame)break;E+=Yn,R+=Yn;continue}E++,R++}for(R=m.byteLength,E=R-Yn,at=!1;E>=0;){if(m[E]===ks&&m[R]===ks){switch(N=m.subarray(E,R),he=Fi.ts.parseType(N,b.pid),he){case"pes":ye=Fi.ts.parsePesType(N,b.table),_e=Fi.ts.parsePayloadUnitStartIndicator(N),ye==="video"&&_e&&(Te=Fi.ts.parsePesTime(N),Te&&(Te.type="video",C.video.push(Te),at=!0));break}if(at)break;E-=Yn,R-=Yn;continue}E--,R--}},Rv=function(m,b){if(m.audio&&m.audio.length){var C=b;(typeof C=="undefined"||isNaN(C))&&(C=m.audio[0].dts),m.audio.forEach(function(N){N.dts=Ll(N.dts,C),N.pts=Ll(N.pts,C),N.dtsTime=N.dts/go,N.ptsTime=N.pts/go})}if(m.video&&m.video.length){var E=b;if((typeof E=="undefined"||isNaN(E))&&(E=m.video[0].dts),m.video.forEach(function(N){N.dts=Ll(N.dts,E),N.pts=Ll(N.pts,E),N.dtsTime=N.dts/go,N.ptsTime=N.pts/go}),m.firstKeyFrame){var R=m.firstKeyFrame;R.dts=Ll(R.dts,E),R.pts=Ll(R.pts,E),R.dtsTime=R.dts/go,R.ptsTime=R.pts/go}}},Pv=function(m){for(var b=!1,C=0,E=null,R=null,N=0,he=0,ye;m.length-he>=3;){var _e=Fi.aac.parseType(m,he);switch(_e){case"timed-metadata":if(m.length-he<10){b=!0;break}if(N=Fi.aac.parseId3TagSize(m,he),N>m.length){b=!0;break}R===null&&(ye=m.subarray(he,he+N),R=Fi.aac.parseAacTimestamp(ye)),he+=N;break;case"audio":if(m.length-he<7){b=!0;break}if(N=Fi.aac.parseAdtsSize(m,he),N>m.length){b=!0;break}E===null&&(ye=m.subarray(he,he+N),E=Fi.aac.parseSampleRate(ye)),C++,he+=N;break;default:he++;break}if(b)return null}if(E===null||R===null)return null;var Te=go/E,Me={audio:[{type:"audio",dts:R,pts:R},{type:"audio",dts:R+C*1024*Te,pts:R+C*1024*Te}]};return Me},Ov=function(m){var b={pid:null,table:null},C={};kv(m,b);for(var E in b.table)if(b.table.hasOwnProperty(E)){var R=b.table[E];switch(R){case zp.H264_STREAM_TYPE:C.video=[],Iv(m,b,C),C.video.length===0&&delete C.video;break;case zp.ADTS_STREAM_TYPE:C.audio=[],Yp(m,b,C),C.audio.length===0&&delete C.audio;break}}return C},Bv=function(m,b){var C=Fi.aac.isLikelyAacData(m),E;return C?E=Pv(m):E=Ov(m),!E||!E.audio&&!E.video?null:(Rv(E,b),E)},Mv={inspect:Bv,parseAudioPes_:Yp};const Fv=function(m,b){b.on("data",function(C){const E=C.initSegment;C.initSegment={data:E.buffer,byteOffset:E.byteOffset,byteLength:E.byteLength};const R=C.data;C.data=R.buffer,m.postMessage({action:"data",segment:C,byteOffset:R.byteOffset,byteLength:R.byteLength},[C.data])}),b.on("done",function(C){m.postMessage({action:"done"})}),b.on("gopInfo",function(C){m.postMessage({action:"gopInfo",gopInfo:C})}),b.on("videoSegmentTimingInfo",function(C){const E={start:{decode:Xi.videoTsToSeconds(C.start.dts),presentation:Xi.videoTsToSeconds(C.start.pts)},end:{decode:Xi.videoTsToSeconds(C.end.dts),presentation:Xi.videoTsToSeconds(C.end.pts)},baseMediaDecodeTime:Xi.videoTsToSeconds(C.baseMediaDecodeTime)};C.prependedContentDuration&&(E.prependedContentDuration=Xi.videoTsToSeconds(C.prependedContentDuration)),m.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:E})}),b.on("audioSegmentTimingInfo",function(C){const E={start:{decode:Xi.videoTsToSeconds(C.start.dts),presentation:Xi.videoTsToSeconds(C.start.pts)},end:{decode:Xi.videoTsToSeconds(C.end.dts),presentation:Xi.videoTsToSeconds(C.end.pts)},baseMediaDecodeTime:Xi.videoTsToSeconds(C.baseMediaDecodeTime)};C.prependedContentDuration&&(E.prependedContentDuration=Xi.videoTsToSeconds(C.prependedContentDuration)),m.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:E})}),b.on("id3Frame",function(C){m.postMessage({action:"id3Frame",id3Frame:C})}),b.on("caption",function(C){m.postMessage({action:"caption",caption:C})}),b.on("trackinfo",function(C){m.postMessage({action:"trackinfo",trackInfo:C})}),b.on("audioTimingInfo",function(C){m.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:Xi.videoTsToSeconds(C.start),end:Xi.videoTsToSeconds(C.end)}})}),b.on("videoTimingInfo",function(C){m.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:Xi.videoTsToSeconds(C.start),end:Xi.videoTsToSeconds(C.end)}})}),b.on("log",function(C){m.postMessage({action:"log",log:C})})};class Xp{constructor(b,C){this.options=C||{},this.self=b,this.init()}init(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new jy.Transmuxer(this.options),Fv(this.self,this.transmuxer)}pushMp4Captions(b){this.captionParser||(this.captionParser=new dv,this.captionParser.init());const C=new Uint8Array(b.data,b.byteOffset,b.byteLength),E=this.captionParser.parse(C,b.trackIds,b.timescales);this.self.postMessage({action:"mp4Captions",captions:E&&E.captions||[],logs:E&&E.logs||[],data:C.buffer},[C.buffer])}probeMp4StartTime({timescales:b,data:C}){const E=Uh.startTime(b,C);this.self.postMessage({action:"probeMp4StartTime",startTime:E,data:C},[C.buffer])}probeMp4Tracks({data:b}){const C=Uh.tracks(b);this.self.postMessage({action:"probeMp4Tracks",tracks:C,data:b},[b.buffer])}probeEmsgID3({data:b,offset:C}){const E=Uh.getEmsgID3(b,C);this.self.postMessage({action:"probeEmsgID3",id3Frames:E,emsgData:b},[b.buffer])}probeTs({data:b,baseStartTime:C}){const E=typeof C=="number"&&!isNaN(C)?C*Xi.ONE_SECOND_IN_TS:void 0,R=Mv.inspect(b,E);let N=null;R&&(N={hasVideo:R.video&&R.video.length===2||!1,hasAudio:R.audio&&R.audio.length===2||!1},N.hasVideo&&(N.videoStart=R.video[0].ptsTime),N.hasAudio&&(N.audioStart=R.audio[0].ptsTime)),this.self.postMessage({action:"probeTs",result:N,data:b},[b.buffer])}clearAllMp4Captions(){this.captionParser&&this.captionParser.clearAllCaptions()}clearParsedMp4Captions(){this.captionParser&&this.captionParser.clearParsedCaptions()}push(b){const C=new Uint8Array(b.data,b.byteOffset,b.byteLength);this.transmuxer.push(C)}reset(){this.transmuxer.reset()}setTimestampOffset(b){const C=b.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(Xi.secondsToVideoTs(C)))}setAudioAppendStart(b){this.transmuxer.setAudioAppendStart(Math.ceil(Xi.secondsToVideoTs(b.appendStart)))}setRemux(b){this.transmuxer.setRemux(b.remux)}flush(b){this.transmuxer.flush(),self.postMessage({action:"done",type:"transmuxed"})}endTimeline(){this.transmuxer.endTimeline(),self.postMessage({action:"endedtimeline",type:"transmuxed"})}alignGopsWith(b){this.transmuxer.alignGopsWith(b.gopsToAlignWith.slice())}}self.onmessage=function(m){if(m.data.action==="init"&&m.data.options){this.messageHandlers=new Xp(self,m.data.options);return}this.messageHandlers||(this.messageHandlers=new Xp(self)),m.data&&m.data.action&&m.data.action!=="init"&&this.messageHandlers[m.data.action]&&this.messageHandlers[m.data.action](m.data)}}));var H0=mf(G0);const q0=(s,e,i)=>{const{type:r,initSegment:l,captions:d,captionStreams:f,metadata:y,videoFrameDtsTime:L,videoFramePtsTime:B}=s.data.segment;e.buffer.push({captions:d,captionStreams:f,metadata:y});const W=s.data.segment.boxes||{data:s.data.segment.data},ce={type:r,data:new Uint8Array(W.data,W.data.byteOffset,W.data.byteLength),initSegment:new Uint8Array(l.data,l.byteOffset,l.byteLength)};typeof L!="undefined"&&(ce.videoFrameDtsTime=L),typeof B!="undefined"&&(ce.videoFramePtsTime=B),i(ce)},K0=({transmuxedData:s,callback:e})=>{s.buffer=[],e(s)},W0=(s,e)=>{e.gopInfo=s.data.gopInfo},vf=s=>{const{transmuxer:e,bytes:i,audioAppendStart:r,gopsToAlignWith:l,remux:d,onData:f,onTrackInfo:y,onAudioTimingInfo:L,onVideoTimingInfo:B,onVideoSegmentTimingInfo:W,onAudioSegmentTimingInfo:ce,onId3:ke,onCaptions:Pe,onDone:be,onEndedTimeline:je,onTransmuxerLog:We,isEndOfTimeline:Je}=s,He={buffer:[]};let dt=Je;const tt=Ue=>{e.currentTransmux===s&&(Ue.data.action==="data"&&q0(Ue,He,f),Ue.data.action==="trackinfo"&&y(Ue.data.trackInfo),Ue.data.action==="gopInfo"&&W0(Ue,He),Ue.data.action==="audioTimingInfo"&&L(Ue.data.audioTimingInfo),Ue.data.action==="videoTimingInfo"&&B(Ue.data.videoTimingInfo),Ue.data.action==="videoSegmentTimingInfo"&&W(Ue.data.videoSegmentTimingInfo),Ue.data.action==="audioSegmentTimingInfo"&&ce(Ue.data.audioSegmentTimingInfo),Ue.data.action==="id3Frame"&&ke([Ue.data.id3Frame],Ue.data.id3Frame.dispatchType),Ue.data.action==="caption"&&Pe(Ue.data.caption),Ue.data.action==="endedtimeline"&&(dt=!1,je()),Ue.data.action==="log"&&We(Ue.data.log),Ue.data.type==="transmuxed"&&(dt||(e.onmessage=null,K0({transmuxedData:He,callback:be}),Af(e))))};if(e.onmessage=tt,r&&e.postMessage({action:"setAudioAppendStart",appendStart:r}),Array.isArray(l)&&e.postMessage({action:"alignGopsWith",gopsToAlignWith:l}),typeof d!="undefined"&&e.postMessage({action:"setRemux",remux:d}),i.byteLength){const Ue=i instanceof ArrayBuffer?i:i.buffer,xt=i instanceof ArrayBuffer?0:i.byteOffset;e.postMessage({action:"push",data:Ue,byteOffset:xt,byteLength:i.byteLength},[Ue])}Je&&e.postMessage({action:"endTimeline"}),e.postMessage({action:"flush"})},Af=s=>{s.currentTransmux=null,s.transmuxQueue.length&&(s.currentTransmux=s.transmuxQueue.shift(),typeof s.currentTransmux=="function"?s.currentTransmux():vf(s.currentTransmux))},bf=(s,e)=>{s.postMessage({action:e}),Af(s)},_f=(s,e)=>{if(!e.currentTransmux){e.currentTransmux=s,bf(e,s);return}e.transmuxQueue.push(bf.bind(null,e,s))},z0=s=>{_f("reset",s)},Y0=s=>{_f("endTimeline",s)},xf=s=>{if(!s.transmuxer.currentTransmux){s.transmuxer.currentTransmux=s,vf(s);return}s.transmuxer.transmuxQueue.push(s)};var ch={reset:z0,endTimeline:Y0,transmux:xf,createTransmuxer:s=>{const e=new H0;e.currentTransmux=null,e.transmuxQueue=[];const i=e.terminate;return e.terminate=()=>(e.currentTransmux=null,e.transmuxQueue.length=0,i.call(e)),e.postMessage({action:"init",options:s}),e}};const Nu=function(s){const e=s.transmuxer,i=s.endAction||s.action,r=s.callback,l=(0,v.Z)({},s,{endAction:null,transmuxer:null,callback:null}),d=f=>{f.data.action===i&&(e.removeEventListener("message",d),f.data.data&&(f.data.data=new Uint8Array(f.data.data,s.byteOffset||0,s.byteLength||f.data.data.byteLength),s.data&&(s.data=f.data.data)),r(f.data))};if(e.addEventListener("message",d),s.data){const f=s.data instanceof ArrayBuffer;l.byteOffset=f?0:s.data.byteOffset,l.byteLength=s.data.byteLength;const y=[f?s.data:s.data.buffer];e.postMessage(l,y)}else e.postMessage(l)},ws={FAILURE:2,TIMEOUT:-101,ABORTED:-102},hh=s=>{s.forEach(e=>{e.abort()})},X0=s=>({bandwidth:s.bandwidth,bytesReceived:s.bytesReceived||0,roundTripTime:s.roundTripTime||0}),Q0=s=>{const e=s.target,i=Date.now()-e.requestTime,r={bandwidth:Infinity,bytesReceived:0,roundTripTime:i||0};return r.bytesReceived=s.loaded,r.bandwidth=Math.floor(r.bytesReceived/r.roundTripTime*8*1e3),r},fh=(s,e)=>e.timedout?{status:e.status,message:"HLS request timed-out at URL: "+e.uri,code:ws.TIMEOUT,xhr:e}:e.aborted?{status:e.status,message:"HLS request aborted at URL: "+e.uri,code:ws.ABORTED,xhr:e}:s?{status:e.status,message:"HLS request errored at URL: "+e.uri,code:ws.FAILURE,xhr:e}:e.responseType==="arraybuffer"&&e.response.byteLength===0?{status:e.status,message:"Empty HLS response at URL: "+e.uri,code:ws.FAILURE,xhr:e}:null,Ef=(s,e,i)=>(r,l)=>{const d=l.response,f=fh(r,l);if(f)return i(f,s);if(d.byteLength!==16)return i({status:l.status,message:"Invalid HLS key at URL: "+l.uri,code:ws.FAILURE,xhr:l},s);const y=new DataView(d),L=new Uint32Array([y.getUint32(0),y.getUint32(4),y.getUint32(8),y.getUint32(12)]);for(let B=0;B<e.length;B++)e[B].bytes=L;return i(null,s)},Tf=(s,e)=>{const i=Br(s.map.bytes);if(i!=="mp4"){const r=s.map.resolvedUri||s.map.uri;return e({internal:!0,message:`Found unsupported ${i||"unknown"} container for initialization segment at URL: ${r}`,code:ws.FAILURE})}Nu({action:"probeMp4Tracks",data:s.map.bytes,transmuxer:s.transmuxer,callback:({tracks:r,data:l})=>(s.map.bytes=l,r.forEach(function(d){s.map.tracks=s.map.tracks||{},!s.map.tracks[d.type]&&(s.map.tracks[d.type]=d,typeof d.id=="number"&&d.timescale&&(s.map.timescales=s.map.timescales||{},s.map.timescales[d.id]=d.timescale))}),e(null))})},J0=({segment:s,finishProcessingFn:e})=>(i,r)=>{const l=fh(i,r);if(l)return e(l,s);const d=new Uint8Array(r.response);if(s.map.key)return s.map.encryptedBytes=d,e(null,s);s.map.bytes=d,Tf(s,function(f){if(f)return f.xhr=r,f.status=r.status,e(f,s);e(null,s)})},Z0=({segment:s,finishProcessingFn:e,responseType:i})=>(r,l)=>{const d=fh(r,l);if(d)return e(d,s);const f=i==="arraybuffer"||!l.responseText?l.response:$0(l.responseText.substring(s.lastReachedChar||0));return s.stats=X0(l),s.key?s.encryptedBytes=new Uint8Array(f):s.bytes=new Uint8Array(f),e(null,s)},em=({segment:s,bytes:e,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:d,id3Fn:f,captionsFn:y,isEndOfTimeline:L,endedTimelineFn:B,dataFn:W,doneFn:ce,onTransmuxerLog:ke})=>{const Pe=s.map&&s.map.tracks||{},be=Boolean(Pe.audio&&Pe.video);let je=r.bind(null,s,"audio","start");const We=r.bind(null,s,"audio","end");let Je=r.bind(null,s,"video","start");const He=r.bind(null,s,"video","end"),dt=()=>xf({bytes:e,transmuxer:s.transmuxer,audioAppendStart:s.audioAppendStart,gopsToAlignWith:s.gopsToAlignWith,remux:be,onData:tt=>{tt.type=tt.type==="combined"?"video":tt.type,W(s,tt)},onTrackInfo:tt=>{i&&(be&&(tt.isMuxed=!0),i(s,tt))},onAudioTimingInfo:tt=>{je&&typeof tt.start!="undefined"&&(je(tt.start),je=null),We&&typeof tt.end!="undefined"&&We(tt.end)},onVideoTimingInfo:tt=>{Je&&typeof tt.start!="undefined"&&(Je(tt.start),Je=null),He&&typeof tt.end!="undefined"&&He(tt.end)},onVideoSegmentTimingInfo:tt=>{l(tt)},onAudioSegmentTimingInfo:tt=>{d(tt)},onId3:(tt,Ue)=>{f(s,tt,Ue)},onCaptions:tt=>{y(s,[tt])},isEndOfTimeline:L,onEndedTimeline:()=>{B()},onTransmuxerLog:ke,onDone:tt=>{!ce||(tt.type=tt.type==="combined"?"video":tt.type,ce(null,s,tt))}});Nu({action:"probeTs",transmuxer:s.transmuxer,data:e,baseStartTime:s.baseStartTime,callback:tt=>{s.bytes=e=tt.data;const Ue=tt.result;Ue&&(i(s,{hasAudio:Ue.hasAudio,hasVideo:Ue.hasVideo,isMuxed:be}),i=null),dt()}})},Sf=({segment:s,bytes:e,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:d,id3Fn:f,captionsFn:y,isEndOfTimeline:L,endedTimelineFn:B,dataFn:W,doneFn:ce,onTransmuxerLog:ke})=>{let Pe=new Uint8Array(e);if(Us(Pe)){s.isFmp4=!0;const{tracks:be}=s.map,je={isFmp4:!0,hasVideo:!!be.video,hasAudio:!!be.audio};be.audio&&be.audio.codec&&be.audio.codec!=="enca"&&(je.audioCodec=be.audio.codec),be.video&&be.video.codec&&be.video.codec!=="encv"&&(je.videoCodec=be.video.codec),be.video&&be.audio&&(je.isMuxed=!0),i(s,je);const We=(Je,He)=>{W(s,{data:Pe,type:je.hasAudio&&!je.isMuxed?"audio":"video"}),He&&He.length&&f(s,He),Je&&Je.length&&y(s,Je),ce(null,s,{})};Nu({action:"probeMp4StartTime",timescales:s.map.timescales,data:Pe,transmuxer:s.transmuxer,callback:({data:Je,startTime:He})=>{e=Je.buffer,s.bytes=Pe=Je,je.hasAudio&&!je.isMuxed&&r(s,"audio","start",He),je.hasVideo&&r(s,"video","start",He),Nu({action:"probeEmsgID3",data:Pe,transmuxer:s.transmuxer,offset:He,callback:({emsgData:dt,id3Frames:tt})=>{if(e=dt.buffer,s.bytes=Pe=dt,!be.video||!dt.byteLength||!s.transmuxer){We(void 0,tt);return}Nu({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:s.transmuxer,data:Pe,timescales:s.map.timescales,trackIds:[be.video.id],callback:Ue=>{e=Ue.data.buffer,s.bytes=Pe=Ue.data,Ue.logs.forEach(function(xt){ke(st(xt,{stream:"mp4CaptionParser"}))}),We(Ue.captions,tt)}})}})}});return}if(!s.transmuxer){ce(null,s,{});return}if(typeof s.container=="undefined"&&(s.container=Br(Pe)),s.container!=="ts"&&s.container!=="aac"){i(s,{hasAudio:!1,hasVideo:!1}),ce(null,s,{});return}em({segment:s,bytes:e,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:d,id3Fn:f,captionsFn:y,isEndOfTimeline:L,endedTimelineFn:B,dataFn:W,doneFn:ce,onTransmuxerLog:ke})},Cf=function({id:s,key:e,encryptedBytes:i,decryptionWorker:r},l){const d=y=>{if(y.data.source===s){r.removeEventListener("message",d);const L=y.data.decrypted;l(new Uint8Array(L.bytes,L.byteOffset,L.byteLength))}};r.addEventListener("message",d);let f;e.bytes.slice?f=e.bytes.slice():f=new Uint32Array(Array.prototype.slice.call(e.bytes)),r.postMessage(of({source:s,encrypted:i,key:f,iv:e.iv}),[i.buffer,f.buffer])},tm=({decryptionWorker:s,segment:e,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:d,id3Fn:f,captionsFn:y,isEndOfTimeline:L,endedTimelineFn:B,dataFn:W,doneFn:ce,onTransmuxerLog:ke})=>{Cf({id:e.requestId,key:e.key,encryptedBytes:e.encryptedBytes,decryptionWorker:s},Pe=>{e.bytes=Pe,Sf({segment:e,bytes:e.bytes,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:d,id3Fn:f,captionsFn:y,isEndOfTimeline:L,endedTimelineFn:B,dataFn:W,doneFn:ce,onTransmuxerLog:ke})})},im=({activeXhrs:s,decryptionWorker:e,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:d,id3Fn:f,captionsFn:y,isEndOfTimeline:L,endedTimelineFn:B,dataFn:W,doneFn:ce,onTransmuxerLog:ke})=>{let Pe=0,be=!1;return(je,We)=>{if(!be){if(je)return be=!0,hh(s),ce(je,We);if(Pe+=1,Pe===s.length){const Je=function(){if(We.encryptedBytes)return tm({decryptionWorker:e,segment:We,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:d,id3Fn:f,captionsFn:y,isEndOfTimeline:L,endedTimelineFn:B,dataFn:W,doneFn:ce,onTransmuxerLog:ke});Sf({segment:We,bytes:We.bytes,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:d,id3Fn:f,captionsFn:y,isEndOfTimeline:L,endedTimelineFn:B,dataFn:W,doneFn:ce,onTransmuxerLog:ke})};if(We.endOfAllRequests=Date.now(),We.map&&We.map.encryptedBytes&&!We.map.bytes)return Cf({decryptionWorker:e,id:We.requestId+"-init",encryptedBytes:We.map.encryptedBytes,key:We.map.key},He=>{We.map.bytes=He,Tf(We,dt=>{if(dt)return hh(s),ce(dt,We);Je()})});Je()}}}},nm=({loadendState:s,abortFn:e})=>i=>{i.target.aborted&&e&&!s.calledAbortFn&&(e(),s.calledAbortFn=!0)},rm=({segment:s,progressFn:e,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:d,id3Fn:f,captionsFn:y,isEndOfTimeline:L,endedTimelineFn:B,dataFn:W})=>ce=>{if(!ce.target.aborted)return s.stats=st(s.stats,Q0(ce)),!s.stats.firstBytesReceivedAt&&s.stats.bytesReceived&&(s.stats.firstBytesReceivedAt=Date.now()),e(ce,s)},sm=({xhr:s,xhrOptions:e,decryptionWorker:i,segment:r,abortFn:l,progressFn:d,trackInfoFn:f,timingInfoFn:y,videoSegmentTimingInfoFn:L,audioSegmentTimingInfoFn:B,id3Fn:W,captionsFn:ce,isEndOfTimeline:ke,endedTimelineFn:Pe,dataFn:be,doneFn:je,onTransmuxerLog:We})=>{const Je=[],He=im({activeXhrs:Je,decryptionWorker:i,trackInfoFn:f,timingInfoFn:y,videoSegmentTimingInfoFn:L,audioSegmentTimingInfoFn:B,id3Fn:W,captionsFn:ce,isEndOfTimeline:ke,endedTimelineFn:Pe,dataFn:be,doneFn:je,onTransmuxerLog:We});if(r.key&&!r.key.bytes){const Vt=[r.key];r.map&&!r.map.bytes&&r.map.key&&r.map.key.resolvedUri===r.key.resolvedUri&&Vt.push(r.map.key);const mi=st(e,{uri:r.key.resolvedUri,responseType:"arraybuffer"}),yi=Ef(r,Vt,He),an=s(mi,yi);Je.push(an)}if(r.map&&!r.map.bytes){if(r.map.key&&(!r.key||r.key.resolvedUri!==r.map.key.resolvedUri)){const Un=st(e,{uri:r.map.key.resolvedUri,responseType:"arraybuffer"}),on=Ef(r,[r.map.key],He),Yt=s(Un,on);Je.push(Yt)}const mi=st(e,{uri:r.map.resolvedUri,responseType:"arraybuffer",headers:lh(r.map)}),yi=J0({segment:r,finishProcessingFn:He}),an=s(mi,yi);Je.push(an)}const dt=st(e,{uri:r.part&&r.part.resolvedUri||r.resolvedUri,responseType:"arraybuffer",headers:lh(r)}),tt=Z0({segment:r,finishProcessingFn:He,responseType:dt.responseType}),Ue=s(dt,tt);Ue.addEventListener("progress",rm({segment:r,progressFn:d,trackInfoFn:f,timingInfoFn:y,videoSegmentTimingInfoFn:L,audioSegmentTimingInfoFn:B,id3Fn:W,captionsFn:ce,isEndOfTimeline:ke,endedTimelineFn:Pe,dataFn:be})),Je.push(Ue);const xt={};return Je.forEach(Vt=>{Vt.addEventListener("loadend",nm({loadendState:xt,abortFn:l}))}),()=>hh(Je)},am=et("CodecUtils"),om=function(s){const e=s.attributes||{};if(e.CODECS)return kt(e.CODECS)},wf=(s,e)=>{const i=e.attributes||{};return s&&s.mediaGroups&&s.mediaGroups.AUDIO&&i.AUDIO&&s.mediaGroups.AUDIO[i.AUDIO]},lm=(s,e)=>{if(!wf(s,e))return!0;const i=e.attributes||{},r=s.mediaGroups.AUDIO[i.AUDIO];for(const l in r)if(!r[l].uri&&!r[l].playlists)return!0;return!1},Yd=function(s){const e={};return s.forEach(({mediaType:i,type:r,details:l})=>{e[i]=e[i]||[],e[i].push($e(`${r}${l}`))}),Object.keys(e).forEach(function(i){if(e[i].length>1){am(`multiple ${i} codecs found as attributes: ${e[i].join(", ")}. Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs.`),e[i]=null;return}e[i]=e[i][0]}),e},Lf=function(s){let e=0;return s.audio&&e++,s.video&&e++,e},Uu=function(s,e){const i=e.attributes||{},r=Yd(om(e)||[]);if(wf(s,e)&&!r.audio&&!lm(s,e)){const l=Yd(Rt(s,i.AUDIO)||[]);l.audio&&(r.audio=l.audio)}return r},Xd=et("PlaylistSelector"),Df=function(s){if(!s||!s.playlist)return;const e=s.playlist;return JSON.stringify({id:e.id,bandwidth:s.bandwidth,width:s.width,height:s.height,codecs:e.attributes&&e.attributes.CODECS||""})},Qd=function(s,e){if(!s)return"";const i=le().getComputedStyle(s);return i?i[e]:""},xl=function(s,e){const i=s.slice();s.sort(function(r,l){const d=e(r,l);return d===0?i.indexOf(r)-i.indexOf(l):d})},ph=function(s,e){let i,r;return s.attributes.BANDWIDTH&&(i=s.attributes.BANDWIDTH),i=i||le().Number.MAX_VALUE,e.attributes.BANDWIDTH&&(r=e.attributes.BANDWIDTH),r=r||le().Number.MAX_VALUE,i-r},um=function(s,e){let i,r;return s.attributes.RESOLUTION&&s.attributes.RESOLUTION.width&&(i=s.attributes.RESOLUTION.width),i=i||le().Number.MAX_VALUE,e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width&&(r=e.attributes.RESOLUTION.width),r=r||le().Number.MAX_VALUE,i===r&&s.attributes.BANDWIDTH&&e.attributes.BANDWIDTH?s.attributes.BANDWIDTH-e.attributes.BANDWIDTH:i-r};let kf=function(s,e,i,r,l,d){if(!s)return;const f={bandwidth:e,width:i,height:r,limitRenditionByPlayerDimensions:l};let y=s.playlists;or.isAudioOnly(s)&&(y=d.getAudioTrackPlaylists_(),f.audioOnly=!0);let L=y.map(Ue=>{let xt;const Vt=Ue.attributes&&Ue.attributes.RESOLUTION&&Ue.attributes.RESOLUTION.width,mi=Ue.attributes&&Ue.attributes.RESOLUTION&&Ue.attributes.RESOLUTION.height;return xt=Ue.attributes&&Ue.attributes.BANDWIDTH,xt=xt||le().Number.MAX_VALUE,{bandwidth:xt,width:Vt,height:mi,playlist:Ue}});xl(L,(Ue,xt)=>Ue.bandwidth-xt.bandwidth),L=L.filter(Ue=>!or.isIncompatible(Ue.playlist));let B=L.filter(Ue=>or.isEnabled(Ue.playlist));B.length||(B=L.filter(Ue=>!or.isDisabled(Ue.playlist)));const W=B.filter(Ue=>Ue.bandwidth*wn.BANDWIDTH_VARIANCE<e);let ce=W[W.length-1];const ke=W.filter(Ue=>Ue.bandwidth===ce.bandwidth)[0];if(l===!1){const Ue=ke||B[0]||L[0];if(Ue&&Ue.playlist){let xt="sortedPlaylistReps";return ke&&(xt="bandwidthBestRep"),B[0]&&(xt="enabledPlaylistReps"),Xd(`choosing ${Df(Ue)} using ${xt} with options`,f),Ue.playlist}return Xd("could not choose a playlist with options",f),null}const Pe=W.filter(Ue=>Ue.width&&Ue.height);xl(Pe,(Ue,xt)=>Ue.width-xt.width);const be=Pe.filter(Ue=>Ue.width===i&&Ue.height===r);ce=be[be.length-1];const je=be.filter(Ue=>Ue.bandwidth===ce.bandwidth)[0];let We,Je,He;je||(We=Pe.filter(Ue=>Ue.width>i||Ue.height>r),Je=We.filter(Ue=>Ue.width===We[0].width&&Ue.height===We[0].height),ce=Je[Je.length-1],He=Je.filter(Ue=>Ue.bandwidth===ce.bandwidth)[0]);let dt;if(d.leastPixelDiffSelector){const Ue=Pe.map(xt=>(xt.pixelDiff=Math.abs(xt.width-i)+Math.abs(xt.height-r),xt));xl(Ue,(xt,Vt)=>xt.pixelDiff===Vt.pixelDiff?Vt.bandwidth-xt.bandwidth:xt.pixelDiff-Vt.pixelDiff),dt=Ue[0]}const tt=dt||He||je||ke||B[0]||L[0];if(tt&&tt.playlist){let Ue="sortedPlaylistReps";return dt?Ue="leastPixelDiffRep":He?Ue="resolutionPlusOneRep":je?Ue="resolutionBestRep":ke?Ue="bandwidthBestRep":B[0]&&(Ue="enabledPlaylistReps"),Xd(`choosing ${Df(tt)} using ${Ue} with options`,f),tt.playlist}return Xd("could not choose a playlist with options",f),null};const If=function(){const s=this.useDevicePixelRatio&&le().devicePixelRatio||1;return kf(this.playlists.main,this.systemBandwidth,parseInt(Qd(this.tech_.el(),"width"),10)*s,parseInt(Qd(this.tech_.el(),"height"),10)*s,this.limitRenditionByPlayerDimensions,this.playlistController_)},dm=function(s){let e=-1,i=-1;if(s<0||s>1)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){const r=this.useDevicePixelRatio&&le().devicePixelRatio||1;return e<0&&(e=this.systemBandwidth,i=this.systemBandwidth),this.systemBandwidth>0&&this.systemBandwidth!==i&&(e=s*this.systemBandwidth+(1-s)*e,i=this.systemBandwidth),kf(this.playlists.main,e,parseInt(Qd(this.tech_.el(),"width"),10)*r,parseInt(Qd(this.tech_.el(),"height"),10)*r,this.limitRenditionByPlayerDimensions,this.playlistController_)}},cm=function(s){const{main:e,currentTime:i,bandwidth:r,duration:l,segmentDuration:d,timeUntilRebuffer:f,currentTimeline:y,syncController:L}=s,B=e.playlists.filter(be=>!or.isIncompatible(be));let W=B.filter(or.isEnabled);W.length||(W=B.filter(be=>!or.isDisabled(be)));const ke=W.filter(or.hasAttribute.bind(null,"BANDWIDTH")).map(be=>{const We=L.getSyncPoint(be,l,y,i)?1:2,He=or.estimateSegmentRequestTime(d,r,be)*We-f;return{playlist:be,rebufferingImpact:He}}),Pe=ke.filter(be=>be.rebufferingImpact<=0);return xl(Pe,(be,je)=>ph(je.playlist,be.playlist)),Pe.length?Pe[0]:(xl(ke,(be,je)=>be.rebufferingImpact-je.rebufferingImpact),ke[0]||null)},hm=function(){const s=this.playlists.main.playlists.filter(or.isEnabled);return xl(s,(i,r)=>ph(i,r)),s.filter(i=>!!Uu(this.playlists.main,i).video)[0]||null},fm=s=>{let e=0,i;return s.bytes&&(i=new Uint8Array(s.bytes),s.segments.forEach(r=>{i.set(r,e),e+=r.byteLength})),i},pm=function(s,e,i){if(!s[i]){e.trigger({type:"usage",name:"vhs-608"});let r=i;/^cc708_/.test(i)&&(r="SERVICE"+i.split("_")[1]);const l=e.textTracks().getTrackById(r);if(l)s[i]=l;else{const d=e.options_.vhs&&e.options_.vhs.captionServices||{};let f=i,y=i,L=!1;const B=d[r];B&&(f=B.label,y=B.language,L=B.default),s[i]=e.addRemoteTextTrack({kind:"captions",id:r,default:L,label:f,language:y},!1).track}}},mm=function({inbandTextTracks:s,captionArray:e,timestampOffset:i}){if(!e)return;const r=le().WebKitDataCue||le().VTTCue;e.forEach(l=>{const d=l.stream;l.content?l.content.forEach(f=>{const y=new r(l.startTime+i,l.endTime+i,f.text);y.line=f.line,y.align="left",y.position=f.position,y.positionAlign="line-left",s[d].addCue(y)}):s[d].addCue(new r(l.startTime+i,l.endTime+i,l.text))})},gm=function(s){Object.defineProperties(s.frame,{id:{get(){return de.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),s.value.key}},value:{get(){return de.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),s.value.data}},privateData:{get(){return de.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),s.value.data}}})},ym=({inbandTextTracks:s,metadataArray:e,timestampOffset:i,videoDuration:r})=>{if(!e)return;const l=le().WebKitDataCue||le().VTTCue,d=s.metadataTrack_;if(!d||(e.forEach(W=>{const ce=W.cueTime+i;typeof ce!="number"||le().isNaN(ce)||ce<0||!(ce<Infinity)||!W.frames||!W.frames.length||W.frames.forEach(ke=>{const Pe=new l(ce,ce,ke.value||ke.url||ke.data||"");Pe.frame=ke,Pe.value=ke,gm(Pe),d.addCue(Pe)})}),!d.cues||!d.cues.length))return;const f=d.cues,y=[];for(let W=0;W<f.length;W++)f[W]&&y.push(f[W]);const L=y.reduce((W,ce)=>{const ke=W[ce.startTime]||[];return ke.push(ce),W[ce.startTime]=ke,W},{}),B=Object.keys(L).sort((W,ce)=>Number(W)-Number(ce));B.forEach((W,ce)=>{const ke=L[W],Pe=isFinite(r)?r:W,be=Number(B[ce+1])||Pe;ke.forEach(je=>{je.endTime=be})})},vm={id:"ID",class:"CLASS",startDate:"START-DATE",duration:"DURATION",endDate:"END-DATE",endOnNext:"END-ON-NEXT",plannedDuration:"PLANNED-DURATION",scte35Out:"SCTE35-OUT",scte35In:"SCTE35-IN"},Am=new Set(["id","class","startDate","duration","endDate","endOnNext","startTime","endTime","processDateRange"]),bm=({inbandTextTracks:s,dateRanges:e})=>{const i=s.metadataTrack_;if(!i)return;const r=le().WebKitDataCue||le().VTTCue;e.forEach(l=>{for(const d of Object.keys(l)){if(Am.has(d))continue;const f=new r(l.startTime,l.endTime,"");f.id=l.id,f.type="com.apple.quicktime.HLS",f.value={key:vm[d],data:l[d]},(d==="scte35Out"||d==="scte35In")&&(f.value.data=new Uint8Array(f.value.data.match(/[\da-f]{2}/gi)).buffer),i.addCue(f)}l.processDateRange()})},Rf=(s,e,i)=>{s.metadataTrack_||(s.metadataTrack_=i.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,de.browser.IS_ANY_SAFARI||(s.metadataTrack_.inBandMetadataTrackDispatchType=e))},ju=function(s,e,i){let r,l;if(!!i&&!!i.cues)for(r=i.cues.length;r--;)l=i.cues[r],l.startTime>=s&&l.endTime<=e&&i.removeCue(l)},_m=function(s){const e=s.cues;if(!e)return;const i={};for(let r=e.length-1;r>=0;r--){const l=e[r],d=`${l.startTime}-${l.endTime}-${l.text}`;i[d]?s.removeCue(l):i[d]=l}},xm=(s,e,i)=>{if(typeof e=="undefined"||e===null||!s.length)return[];const r=Math.ceil((e-i+3)*Mr.ONE_SECOND_IN_TS);let l;for(l=0;l<s.length&&!(s[l].pts>r);l++);return s.slice(l)},Em=(s,e,i)=>{if(!e.length)return s;if(i)return e.slice();const r=e[0].pts;let l=0;for(l;l<s.length&&!(s[l].pts>=r);l++);return s.slice(0,l).concat(e)},Tm=(s,e,i,r)=>{const l=Math.ceil((e-r)*Mr.ONE_SECOND_IN_TS),d=Math.ceil((i-r)*Mr.ONE_SECOND_IN_TS),f=s.slice();let y=s.length;for(;y--&&!(s[y].pts<=d););if(y===-1)return f;let L=y+1;for(;L--&&!(s[L].pts<=l););return L=Math.max(L,0),f.splice(L,y-L+1),f},Sm=function(s,e){if(!s&&!e||!s&&e||s&&!e)return!1;if(s===e)return!0;const i=Object.keys(s).sort(),r=Object.keys(e).sort();if(i.length!==r.length)return!1;for(let l=0;l<i.length;l++){const d=i[l];if(d!==r[l]||s[d]!==e[d])return!1}return!0},Pf=22,Cm=function(s,e,i){e=e||[];const r=[];let l=0;for(let d=0;d<e.length;d++){const f=e[d];if(s===f.timeline&&(r.push(d),l+=f.duration,l>i))return d}return r.length===0?0:r[r.length-1]},$u=1,wm=500,Of=s=>typeof s=="number"&&isFinite(s),Jd=1/60,Lm=(s,e,i)=>s!=="main"||!e||!i?null:!i.hasAudio&&!i.hasVideo?"Neither audio nor video found in segment.":e.hasVideo&&!i.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!e.hasVideo&&i.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null,Dm=(s,e,i)=>{let r=e-wn.BACK_BUFFER_LENGTH;s.length&&(r=Math.max(r,s.start(0)));const l=e-i;return Math.min(l,r)},El=s=>{const{startOfSegment:e,duration:i,segment:r,part:l,playlist:{mediaSequence:d,id:f,segments:y=[]},mediaIndex:L,partIndex:B,timeline:W}=s,ce=y.length-1;let ke="mediaIndex/partIndex increment";s.getMediaInfoForTime?ke=`getMediaInfoForTime (${s.getMediaInfoForTime})`:s.isSyncRequest&&(ke="getSyncSegmentCandidate (isSyncRequest)"),s.independent&&(ke+=` with independent ${s.independent}`);const Pe=typeof B=="number",be=s.segment.uri?"segment":"pre-segment",je=Pe?vl({preloadSegment:r})-1:0;return`${be} [${d+L}/${d+ce}]`+(Pe?` part [${B}/${je}]`:"")+` segment start/end [${r.start} => ${r.end}]`+(Pe?` part start/end [${l.start} => ${l.end}]`:"")+` startOfSegment [${e}] duration [${i}] timeline [${W}] selected by [${ke}] playlist [${f}]`},Bf=s=>`${s}TimingInfo`,km=({segmentTimeline:s,currentTimeline:e,startOfSegment:i,buffered:r,overrideCheck:l})=>!l&&s===e?null:s<e?i:r.length?r.end(r.length-1):i,Mf=({timelineChangeController:s,currentTimeline:e,segmentTimeline:i,loaderType:r,audioDisabled:l})=>{if(e===i)return!1;if(r==="audio"){const d=s.lastTimelineChange({type:"main"});return!d||d.to!==i}if(r==="main"&&l){const d=s.pendingTimelineChange({type:"audio"});return!(d&&d.to===i)}return!1},Im=s=>{let e=0;return["video","audio"].forEach(function(i){const r=s[`${i}TimingInfo`];if(!r)return;const{start:l,end:d}=r;let f;typeof l=="bigint"||typeof d=="bigint"?f=le().BigInt(d)-le().BigInt(l):typeof l=="number"&&typeof d=="number"&&(f=d-l),typeof f!="undefined"&&f>e&&(e=f)}),typeof e=="bigint"&&e<Number.MAX_SAFE_INTEGER&&(e=Number(e)),e},Ff=({segmentDuration:s,maxDuration:e})=>s?Math.round(s)>e+St:!1,Rm=(s,e)=>{if(e!=="hls")return null;const i=Im({audioTimingInfo:s.audioTimingInfo,videoTimingInfo:s.videoTimingInfo});if(!i)return null;const r=s.playlist.targetDuration,l=Ff({segmentDuration:i,maxDuration:r*2}),d=Ff({segmentDuration:i,maxDuration:r}),f=`Segment with index ${s.mediaIndex} from playlist ${s.playlist.id} has a duration of ${i} when the reported duration is ${s.duration} and the target duration is ${r}. For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1`;return l||d?{severity:l?"warn":"info",message:f}:null};class mh extends de.EventTarget{constructor(e,i={}){super();if(!e)throw new TypeError("Initialization settings are required");if(typeof e.currentTime!="function")throw new TypeError("No currentTime getter specified");if(!e.mediaSource)throw new TypeError("No MediaSource specified");this.bandwidth=e.bandwidth,this.throughput={rate:0,count:0},this.roundTrip=NaN,this.resetStats_(),this.mediaIndex=null,this.partIndex=null,this.hasPlayed_=e.hasPlayed,this.currentTime_=e.currentTime,this.seekable_=e.seekable,this.seeking_=e.seeking,this.duration_=e.duration,this.mediaSource_=e.mediaSource,this.vhs_=e.vhs,this.loaderType_=e.loaderType,this.currentMediaInfo_=void 0,this.startingMediaInfo_=void 0,this.segmentMetadataTrack_=e.segmentMetadataTrack,this.goalBufferLength_=e.goalBufferLength,this.sourceType_=e.sourceType,this.sourceUpdater_=e.sourceUpdater,this.inbandTextTracks_=e.inbandTextTracks,this.state_="INIT",this.timelineChangeController_=e.timelineChangeController,this.shouldSaveSegmentTimingInfo_=!0,this.parse708captions_=e.parse708captions,this.useDtsForTimestampOffset_=e.useDtsForTimestampOffset,this.captionServices_=e.captionServices,this.exactManifestTimings=e.exactManifestTimings,this.addMetadataToTextTrack=e.addMetadataToTextTrack,this.checkBufferTimeout_=null,this.error_=void 0,this.currentTimeline_=-1,this.shouldForceTimestampOffsetAfterResync_=!1,this.pendingSegment_=null,this.xhrOptions_=null,this.pendingSegments_=[],this.audioDisabled_=!1,this.isPendingTimestampOffset_=!1,this.gopBuffer_=[],this.timeMapping_=0,this.safeAppend_=!1,this.appendInitSegment_={audio:!0,video:!0},this.playlistOfLastInitSegment_={audio:null,video:null},this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_={id3:[],caption:[]},this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=null,this.activeInitSegmentId_=null,this.initSegments_={},this.cacheEncryptionKeys_=e.cacheEncryptionKeys,this.keyCache_={},this.decrypter_=e.decrypter,this.syncController_=e.syncController,this.syncPoint_={segmentIndex:0,time:0},this.transmuxer_=this.createTransmuxer_(),this.triggerSyncInfoUpdate_=()=>this.trigger("syncinfoupdate"),this.syncController_.on("syncinfoupdate",this.triggerSyncInfoUpdate_),this.mediaSource_.addEventListener("sourceopen",()=>{this.isEndOfStream_()||(this.ended_=!1)}),this.fetchAtBuffer_=!1,this.logger_=et(`SegmentLoader[${this.loaderType_}]`),Object.defineProperty(this,"state",{get(){return this.state_},set(r){r!==this.state_&&(this.logger_(`${this.state_} -> ${r}`),this.state_=r,this.trigger("statechange"))}}),this.sourceUpdater_.on("ready",()=>{this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}),this.loaderType_==="main"&&this.timelineChangeController_.on("pendingtimelinechange",()=>{this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}),this.loaderType_==="audio"&&this.timelineChangeController_.on("timelinechange",()=>{this.hasEnoughInfoToLoad_()&&this.processLoadQueue_(),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()})}createTransmuxer_(){return ch.createTransmuxer({remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,parse708captions:this.parse708captions_,captionServices:this.captionServices_})}resetStats_(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0,this.mediaAppends=0}dispose(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&this.transmuxer_.terminate(),this.resetStats_(),this.checkBufferTimeout_&&le().clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()}setAudio(e){this.audioDisabled_=!e,e?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())}abort(){if(this.state!=="WAITING"){this.pendingSegment_&&(this.pendingSegment_=null);return}this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()}abort_(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_),this.waitingOnRemove_=!1,le().clearTimeout(this.quotaExceededErrorRetryTimeout_),this.quotaExceededErrorRetryTimeout_=null}checkForAbort_(e){return this.state==="APPENDING"&&!this.pendingSegment_?(this.state="READY",!0):!this.pendingSegment_||this.pendingSegment_.requestId!==e}error(e){return typeof e!="undefined"&&(this.logger_("error occurred:",e),this.error_=e),this.pendingSegment_=null,this.error_}endOfStream(){this.ended_=!0,this.transmuxer_&&ch.reset(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")}buffered_(){const e=this.getMediaInfo_();if(!this.sourceUpdater_||!e)return Ht();if(this.loaderType_==="main"){const{hasAudio:i,hasVideo:r,isMuxed:l}=e;if(r&&i&&!this.audioDisabled_&&!l)return this.sourceUpdater_.buffered();if(r)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()}initSegmentForMap(e,i=!1){if(!e)return null;const r=zd(e);let l=this.initSegments_[r];return i&&!l&&e.bytes&&(this.initSegments_[r]=l={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,tracks:e.tracks,timescales:e.timescales}),l||e}segmentKey(e,i=!1){if(!e)return null;const r=lf(e);let l=this.keyCache_[r];this.cacheEncryptionKeys_&&i&&!l&&e.bytes&&(this.keyCache_[r]=l={resolvedUri:e.resolvedUri,bytes:e.bytes});const d={resolvedUri:(l||e).resolvedUri};return l&&(d.bytes=l.bytes),d}couldBeginLoading_(){return this.playlist_&&!this.paused()}load(){if(this.monitorBuffer_(),!!this.playlist_){if(this.state==="INIT"&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||this.state!=="READY"&&this.state!=="INIT"||(this.state="READY")}}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}playlist(e,i={}){if(!e)return;const r=this.playlist_,l=this.pendingSegment_;this.playlist_=e,this.xhrOptions_=i,this.state==="INIT"&&(e.syncInfo={mediaSequence:e.mediaSequence,time:0},this.loaderType_==="main"&&this.syncController_.setDateTimeMappingForStart(e));let d=null;if(r&&(r.id?d=r.id:r.uri&&(d=r.uri)),this.logger_(`playlist update [${d} => ${e.id||e.uri}]`),this.syncController_.updateMediaSequenceMap(e,this.currentTime_(),this.loaderType_),this.trigger("syncinfoupdate"),this.state==="INIT"&&this.couldBeginLoading_())return this.init_();if(!r||r.uri!==e.uri){this.mediaIndex!==null&&(!e.endList&&typeof e.partTargetDuration=="number"?this.resetLoader():this.resyncLoader()),this.currentMediaInfo_=void 0,this.trigger("playlistupdate");return}const f=e.mediaSequence-r.mediaSequence;if(this.logger_(`live window shift [${f}]`),this.mediaIndex!==null)if(this.mediaIndex-=f,this.mediaIndex<0)this.mediaIndex=null,this.partIndex=null;else{const y=this.playlist_.segments[this.mediaIndex];if(this.partIndex&&(!y.parts||!y.parts.length||!y.parts[this.partIndex])){const L=this.mediaIndex;this.logger_(`currently processing part (index ${this.partIndex}) no longer exists.`),this.resetLoader(),this.mediaIndex=L}}l&&(l.mediaIndex-=f,l.mediaIndex<0?(l.mediaIndex=null,l.partIndex=null):(l.mediaIndex>=0&&(l.segment=e.segments[l.mediaIndex]),l.partIndex>=0&&l.segment.parts&&(l.part=l.segment.parts[l.partIndex]))),this.syncController_.saveExpiredSegmentInfo(r,e)}pause(){this.checkBufferTimeout_&&(le().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}paused(){return this.checkBufferTimeout_===null}resetEverything(e){this.ended_=!1,this.activeInitSegmentId_=null,this.appendInitSegment_={audio:!0,video:!0},this.resetLoader(),this.remove(0,Infinity,e),this.transmuxer_&&(this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.transmuxer_.postMessage({action:"reset"}))}resetLoader(){this.fetchAtBuffer_=!1,this.resyncLoader()}resyncLoader(){this.transmuxer_&&ch.reset(this.transmuxer_),this.mediaIndex=null,this.partIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1,this.shouldForceTimestampOffsetAfterResync_=!0,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}remove(e,i,r=()=>{},l=!1){if(i===Infinity&&(i=this.duration_()),i<=e){this.logger_("skipping remove because end ${end} is <= start ${start}");return}if(!this.sourceUpdater_||!this.getMediaInfo_()){this.logger_("skipping remove because no source updater or starting media info");return}let d=1;const f=()=>{d--,d===0&&r()};(l||!this.audioDisabled_)&&(d++,this.sourceUpdater_.removeAudio(e,i,f)),(l||this.loaderType_==="main")&&(this.gopBuffer_=Tm(this.gopBuffer_,e,i,this.timeMapping_),d++,this.sourceUpdater_.removeVideo(e,i,f));for(const y in this.inbandTextTracks_)ju(e,i,this.inbandTextTracks_[y]);ju(e,i,this.segmentMetadataTrack_),f()}monitorBuffer_(){this.checkBufferTimeout_&&le().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=le().setTimeout(this.monitorBufferTick_.bind(this),1)}monitorBufferTick_(){this.state==="READY"&&this.fillBuffer_(),this.checkBufferTimeout_&&le().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=le().setTimeout(this.monitorBufferTick_.bind(this),wm)}fillBuffer_(){if(this.sourceUpdater_.updating())return;const e=this.chooseNextRequest_();!e||(typeof e.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!1,this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline})),this.loadSegment_(e))}isEndOfStream_(e=this.mediaIndex,i=this.playlist_,r=this.partIndex){if(!i||!this.mediaSource_)return!1;const l=typeof e=="number"&&i.segments[e],d=e+1===i.segments.length,f=!l||!l.parts||r+1===l.parts.length;return i.endList&&this.mediaSource_.readyState==="open"&&d&&f}chooseNextRequest_(){const e=this.buffered_(),i=tn(e)||0,r=sn(e,this.currentTime_()),l=!this.hasPlayed_()&&r>=1,d=r>=this.goalBufferLength_(),f=this.playlist_.segments;if(!f.length||l||d)return null;this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_(),this.loaderType_);const y={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:Boolean(!this.syncPoint_)};if(y.isSyncRequest)y.mediaIndex=Cm(this.currentTimeline_,f,i),this.logger_(`choose next request. Can not find sync point. Fallback to media Index: ${y.mediaIndex}`);else if(this.mediaIndex!==null){const ke=f[this.mediaIndex],Pe=typeof this.partIndex=="number"?this.partIndex:-1;y.startOfSegment=ke.end?ke.end:i,ke.parts&&ke.parts[Pe+1]?(y.mediaIndex=this.mediaIndex,y.partIndex=Pe+1):y.mediaIndex=this.mediaIndex+1}else{const{segmentIndex:ke,startTime:Pe,partIndex:be}=or.getMediaInfoForTime({exactManifestTimings:this.exactManifestTimings,playlist:this.playlist_,currentTime:this.fetchAtBuffer_?i:this.currentTime_(),startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time});y.getMediaInfoForTime=this.fetchAtBuffer_?`bufferedEnd ${i}`:`currentTime ${this.currentTime_()}`,y.mediaIndex=ke,y.startOfSegment=Pe,y.partIndex=be,this.logger_(`choose next request. Playlist switched and we have a sync point. Media Index: ${y.mediaIndex} `)}const L=f[y.mediaIndex];let B=L&&typeof y.partIndex=="number"&&L.parts&&L.parts[y.partIndex];if(!L||typeof y.partIndex=="number"&&!B)return null;typeof y.partIndex!="number"&&L.parts&&(y.partIndex=0,B=L.parts[0]);const W=this.vhs_.playlists&&this.vhs_.playlists.main&&this.vhs_.playlists.main.independentSegments||this.playlist_.independentSegments;if(!r&&B&&!W&&!B.independent)if(y.partIndex===0){const ke=f[y.mediaIndex-1],Pe=ke.parts&&ke.parts.length&&ke.parts[ke.parts.length-1];Pe&&Pe.independent&&(y.mediaIndex-=1,y.partIndex=ke.parts.length-1,y.independent="previous segment")}else L.parts[y.partIndex-1].independent&&(y.partIndex-=1,y.independent="previous part");const ce=this.mediaSource_&&this.mediaSource_.readyState==="ended";return y.mediaIndex>=f.length-1&&ce&&!this.seeking_()?null:(this.shouldForceTimestampOffsetAfterResync_&&(this.shouldForceTimestampOffsetAfterResync_=!1,y.forceTimestampOffset=!0,this.logger_("choose next request. Force timestamp offset after loader resync")),this.generateSegmentInfo_(y))}generateSegmentInfo_(e){const{independent:i,playlist:r,mediaIndex:l,startOfSegment:d,isSyncRequest:f,partIndex:y,forceTimestampOffset:L,getMediaInfoForTime:B}=e,W=r.segments[l],ce=typeof y=="number"&&W.parts[y],ke={requestId:"segment-loader-"+Math.random(),uri:ce&&ce.resolvedUri||W.resolvedUri,mediaIndex:l,partIndex:ce?y:null,isSyncRequest:f,startOfSegment:d,playlist:r,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:W.timeline,duration:ce&&ce.duration||W.duration,segment:W,part:ce,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:B,independent:i},Pe=typeof L!="undefined"?L:this.isPendingTimestampOffset_;ke.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:W.timeline,currentTimeline:this.currentTimeline_,startOfSegment:d,buffered:this.buffered_(),overrideCheck:Pe});const be=tn(this.sourceUpdater_.audioBuffered());return typeof be=="number"&&(ke.audioAppendStart=be-this.sourceUpdater_.audioTimestampOffset()),this.sourceUpdater_.videoBuffered().length&&(ke.gopsToAlignWith=xm(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),ke}timestampOffsetForSegment_(e){return km(e)}earlyAbortWhenNeeded_(e){if(this.vhs_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH||Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)return;const i=this.currentTime_(),r=e.bandwidth,l=this.pendingSegment_.duration,d=or.estimateSegmentRequestTime(l,r,this.playlist_,e.bytesReceived),f=Ei(this.buffered_(),i,this.vhs_.tech_.playbackRate())-1;if(d<=f)return;const y=cm({main:this.vhs_.playlists.main,currentTime:i,bandwidth:r,duration:this.duration_(),segmentDuration:l,timeUntilRebuffer:f,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(!y)return;const B=d-f-y.rebufferingImpact;let W=.5;f<=St&&(W=1),!(!y.playlist||y.playlist.uri===this.playlist_.uri||B<W)&&(this.bandwidth=y.playlist.attributes.BANDWIDTH*wn.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort"))}handleAbort_(e){this.logger_(`Aborting ${El(e)}`),this.mediaRequestsAborted+=1}handleProgress_(e,i){this.earlyAbortWhenNeeded_(i.stats),!this.checkForAbort_(i.requestId)&&this.trigger("progress")}handleTrackInfo_(e,i){this.earlyAbortWhenNeeded_(e.stats),!this.checkForAbort_(e.requestId)&&(this.checkForIllegalMediaSwitch(i)||(i=i||{},Sm(this.currentMediaInfo_,i)||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=i,this.currentMediaInfo_=i,this.logger_("trackinfo update",i),this.trigger("trackinfo")),!this.checkForAbort_(e.requestId)&&(this.pendingSegment_.trackInfo=i,this.hasEnoughInfoToAppend_()&&this.processCallQueue_())))}handleTimingInfo_(e,i,r,l){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;const d=this.pendingSegment_,f=Bf(i);d[f]=d[f]||{},d[f][r]=l,this.logger_(`timinginfo: ${i} - ${r} - ${l}`),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}handleCaptions_(e,i){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(i.length===0){this.logger_("SegmentLoader received no captions from a caption event");return}if(!this.pendingSegment_.hasAppendedData_){this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,e,i));return}const l=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),d={};i.forEach(f=>{d[f.stream]=d[f.stream]||{startTime:Infinity,captions:[],endTime:0};const y=d[f.stream];y.startTime=Math.min(y.startTime,f.startTime+l),y.endTime=Math.max(y.endTime,f.endTime+l),y.captions.push(f)}),Object.keys(d).forEach(f=>{const{startTime:y,endTime:L,captions:B}=d[f],W=this.inbandTextTracks_;this.logger_(`adding cues from ${y} -> ${L} for ${f}`),pm(W,this.vhs_.tech_,f),ju(y,L,W[f]),mm({captionArray:B,inbandTextTracks:W,timestampOffset:l})}),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}handleId3_(e,i,r){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(!this.pendingSegment_.hasAppendedData_){this.metadataQueue_.id3.push(this.handleId3_.bind(this,e,i,r));return}this.addMetadataToTextTrack(r,i,this.duration_())}processMetadataQueue_(){this.metadataQueue_.id3.forEach(e=>e()),this.metadataQueue_.caption.forEach(e=>e()),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]}processCallQueue_(){const e=this.callQueue_;this.callQueue_=[],e.forEach(i=>i())}processLoadQueue_(){const e=this.loadQueue_;this.loadQueue_=[],e.forEach(i=>i())}hasEnoughInfoToLoad_(){if(this.loaderType_!=="audio")return!0;const e=this.pendingSegment_;return e?this.getCurrentMediaInfo_()?!Mf({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}):!0:!1}getCurrentMediaInfo_(e=this.pendingSegment_){return e&&e.trackInfo||this.currentMediaInfo_}getMediaInfo_(e=this.pendingSegment_){return this.getCurrentMediaInfo_(e)||this.startingMediaInfo_}getPendingSegmentPlaylist(){return this.pendingSegment_?this.pendingSegment_.playlist:null}hasEnoughInfoToAppend_(){if(!this.sourceUpdater_.ready()||this.waitingOnRemove_||this.quotaExceededErrorRetryTimeout_)return!1;const e=this.pendingSegment_,i=this.getCurrentMediaInfo_();if(!e||!i)return!1;const{hasAudio:r,hasVideo:l,isMuxed:d}=i;return!(l&&!e.videoTimingInfo||r&&!this.audioDisabled_&&!d&&!e.audioTimingInfo||Mf({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))}handleData_(e,i){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(this.callQueue_.length||!this.hasEnoughInfoToAppend_()){this.callQueue_.push(this.handleData_.bind(this,e,i));return}const r=this.pendingSegment_;if(this.setTimeMapping_(r.timeline),this.updateMediaSecondsLoaded_(r.part||r.segment),this.mediaSource_.readyState!=="closed"){if(e.map&&(e.map=this.initSegmentForMap(e.map,!0),r.segment.map=e.map),e.key&&this.segmentKey(e.key,!0),r.isFmp4=e.isFmp4,r.timingInfo=r.timingInfo||{},r.isFmp4)this.trigger("fmp4"),r.timingInfo.start=r[Bf(i.type)].start;else{const l=this.getCurrentMediaInfo_(),d=this.loaderType_==="main"&&l&&l.hasVideo;let f;d&&(f=r.videoTimingInfo.start),r.timingInfo.start=this.trueSegmentStart_({currentStart:r.timingInfo.start,playlist:r.playlist,mediaIndex:r.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:d,firstVideoFrameTimeForData:f,videoTimingInfo:r.videoTimingInfo,audioTimingInfo:r.audioTimingInfo})}if(this.updateAppendInitSegmentStatus(r,i.type),this.updateSourceBufferTimestampOffset_(r),r.isSyncRequest){this.updateTimingInfoEnd_(r),this.syncController_.saveSegmentTimingInfo({segmentInfo:r,shouldSaveTimelineMapping:this.loaderType_==="main"});const l=this.chooseNextRequest_();if(l.mediaIndex!==r.mediaIndex||l.partIndex!==r.partIndex){this.logger_("sync segment was incorrect, not appending");return}this.logger_("sync segment was correct, appending")}r.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(r,i)}}updateAppendInitSegmentStatus(e,i){this.loaderType_==="main"&&typeof e.timestampOffset=="number"&&!e.changedTimestampOffset&&(this.appendInitSegment_={audio:!0,video:!0}),this.playlistOfLastInitSegment_[i]!==e.playlist&&(this.appendInitSegment_[i]=!0)}getInitSegmentAndUpdateState_({type:e,initSegment:i,map:r,playlist:l}){if(r){const d=zd(r);if(this.activeInitSegmentId_===d)return null;i=this.initSegmentForMap(r,!0).bytes,this.activeInitSegmentId_=d}return i&&this.appendInitSegment_[e]?(this.playlistOfLastInitSegment_[e]=l,this.appendInitSegment_[e]=!1,this.activeInitSegmentId_=null,i):null}handleQuotaExceededError_({segmentInfo:e,type:i,bytes:r},l){const d=this.sourceUpdater_.audioBuffered(),f=this.sourceUpdater_.videoBuffered();d.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+ti(d).join(", ")),f.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+ti(f).join(", "));const y=d.length?d.start(0):0,L=d.length?d.end(d.length-1):0,B=f.length?f.start(0):0,W=f.length?f.end(f.length-1):0;if(L-y<=$u&&W-B<=$u){this.logger_(`On QUOTA_EXCEEDED_ERR, single segment too large to append to buffer, triggering an error. Appended byte length: ${r.byteLength}, audio buffer: ${ti(d).join(", ")}, video buffer: ${ti(f).join(", ")}, `),this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:Infinity}),this.trigger("error");return}this.waitingOnRemove_=!0,this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:e,type:i,bytes:r}));const ke=this.currentTime_()-$u;this.logger_(`On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to ${ke}`),this.remove(0,ke,()=>{this.logger_(`On QUOTA_EXCEEDED_ERR, retrying append in ${$u}s`),this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=le().setTimeout(()=>{this.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue"),this.quotaExceededErrorRetryTimeout_=null,this.processCallQueue_()},$u*1e3)},!0)}handleAppendError_({segmentInfo:e,type:i,bytes:r},l){if(!!l){if(l.code===Pf){this.handleQuotaExceededError_({segmentInfo:e,type:i,bytes:r});return}this.logger_("Received non QUOTA_EXCEEDED_ERR on append",l),this.error(`${i} append of ${r.length}b failed for segment #${e.mediaIndex} in playlist ${e.playlist.id}`),this.trigger("appenderror")}}appendToSourceBuffer_({segmentInfo:e,type:i,initSegment:r,data:l,bytes:d}){if(!d){const f=[l];let y=l.byteLength;r&&(f.unshift(r),y+=r.byteLength),d=fm({bytes:y,segments:f})}this.sourceUpdater_.appendBuffer({segmentInfo:e,type:i,bytes:d},this.handleAppendError_.bind(this,{segmentInfo:e,type:i,bytes:d}))}handleSegmentTimingInfo_(e,i,r){if(!this.pendingSegment_||i!==this.pendingSegment_.requestId)return;const l=this.pendingSegment_.segment,d=`${e}TimingInfo`;l[d]||(l[d]={}),l[d].transmuxerPrependedSeconds=r.prependedContentDuration||0,l[d].transmuxedPresentationStart=r.start.presentation,l[d].transmuxedDecodeStart=r.start.decode,l[d].transmuxedPresentationEnd=r.end.presentation,l[d].transmuxedDecodeEnd=r.end.decode,l[d].baseMediaDecodeTime=r.baseMediaDecodeTime}appendData_(e,i){const{type:r,data:l}=i;if(!l||!l.byteLength||r==="audio"&&this.audioDisabled_)return;const d=this.getInitSegmentAndUpdateState_({type:r,initSegment:i.initSegment,playlist:e.playlist,map:e.isFmp4?e.segment.map:null});this.appendToSourceBuffer_({segmentInfo:e,type:r,initSegment:d,data:l})}loadSegment_(e){if(this.state="WAITING",this.pendingSegment_=e,this.trimBackBuffer_(e),typeof e.timestampOffset=="number"&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),!this.hasEnoughInfoToLoad_()){this.loadQueue_.push(()=>{const i=(0,v.Z)({},e,{forceTimestampOffset:!0});(0,v.Z)(e,this.generateSegmentInfo_(i)),this.isPendingTimestampOffset_=!1,this.updateTransmuxerAndRequestSegment_(e)});return}this.updateTransmuxerAndRequestSegment_(e)}updateTransmuxerAndRequestSegment_(e){this.shouldUpdateTransmuxerTimestampOffset_(e.timestampOffset)&&(this.gopBuffer_.length=0,e.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e.timestampOffset}));const i=this.createSimplifiedSegmentObj_(e),r=this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex),l=this.mediaIndex!==null,d=e.timeline!==this.currentTimeline_&&e.timeline>0,f=r||l&&d;this.logger_(`Requesting ${El(e)}`),i.map&&!i.map.bytes&&(this.logger_("going to request init segment."),this.appendInitSegment_={video:!0,audio:!0}),e.abortRequests=sm({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:i,abortFn:this.handleAbort_.bind(this,e),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",e.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",e.requestId),captionsFn:this.handleCaptions_.bind(this),isEndOfTimeline:f,endedTimelineFn:()=>{this.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this),onTransmuxerLog:({message:y,level:L,stream:B})=>{this.logger_(`${El(e)} logged from transmuxer stream ${B} as a ${L}: ${y}`)}})}trimBackBuffer_(e){const i=Dm(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);i>0&&this.remove(0,i)}createSimplifiedSegmentObj_(e){const i=e.segment,r=e.part,l={resolvedUri:r?r.resolvedUri:i.resolvedUri,byterange:r?r.byterange:i.byterange,requestId:e.requestId,transmuxer:e.transmuxer,audioAppendStart:e.audioAppendStart,gopsToAlignWith:e.gopsToAlignWith,part:e.part},d=e.playlist.segments[e.mediaIndex-1];if(d&&d.timeline===i.timeline&&(d.videoTimingInfo?l.baseStartTime=d.videoTimingInfo.transmuxedDecodeEnd:d.audioTimingInfo&&(l.baseStartTime=d.audioTimingInfo.transmuxedDecodeEnd)),i.key){const f=i.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);l.key=this.segmentKey(i.key),l.key.iv=f}return i.map&&(l.map=this.initSegmentForMap(i.map)),l}saveTransferStats_(e){this.mediaRequests+=1,e&&(this.mediaBytesTransferred+=e.bytesReceived,this.mediaTransferDuration+=e.roundTripTime)}saveBandwidthRelatedStats_(e,i){if(this.pendingSegment_.byteLength=i.bytesReceived,e<Jd){this.logger_(`Ignoring segment's bandwidth because its duration of ${e} is less than the min to record ${Jd}`);return}this.bandwidth=i.bandwidth,this.roundTrip=i.roundTripTime}handleTimeout_(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate"),this.trigger("timeout")}segmentRequestFinished_(e,i,r){if(this.callQueue_.length){this.callQueue_.push(this.segmentRequestFinished_.bind(this,e,i,r));return}if(this.saveTransferStats_(i.stats),!this.pendingSegment_||i.requestId!==this.pendingSegment_.requestId)return;if(e){if(this.pendingSegment_=null,this.state="READY",e.code===ws.ABORTED)return;if(this.pause(),e.code===ws.TIMEOUT){this.handleTimeout_();return}this.mediaRequestsErrored+=1,this.error(e),this.trigger("error");return}const l=this.pendingSegment_;this.saveBandwidthRelatedStats_(l.duration,i.stats),l.endOfAllRequests=i.endOfAllRequests,r.gopInfo&&(this.gopBuffer_=Em(this.gopBuffer_,r.gopInfo,this.safeAppend_)),this.state="APPENDING",this.trigger("appending"),this.waitForAppendsToComplete_(l)}setTimeMapping_(e){const i=this.syncController_.mappingForTimeline(e);i!==null&&(this.timeMapping_=i)}updateMediaSecondsLoaded_(e){typeof e.start=="number"&&typeof e.end=="number"?this.mediaSecondsLoaded+=e.end-e.start:this.mediaSecondsLoaded+=e.duration}shouldUpdateTransmuxerTimestampOffset_(e){return e===null?!1:this.loaderType_==="main"&&e!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&e!==this.sourceUpdater_.audioTimestampOffset()}trueSegmentStart_({currentStart:e,playlist:i,mediaIndex:r,firstVideoFrameTimeForData:l,currentVideoTimestampOffset:d,useVideoTimingInfo:f,videoTimingInfo:y,audioTimingInfo:L}){if(typeof e!="undefined")return e;if(!f)return L.start;const B=i.segments[r-1];return r===0||!B||typeof B.start=="undefined"||B.end!==l+d?l:y.start}waitForAppendsToComplete_(e){const i=this.getCurrentMediaInfo_(e);if(!i){this.error({message:"No starting media returned, likely due to an unsupported media format.",playlistExclusionDuration:Infinity}),this.trigger("error");return}const{hasAudio:r,hasVideo:l,isMuxed:d}=i,f=this.loaderType_==="main"&&l,y=!this.audioDisabled_&&r&&!d;if(e.waitingOnAppends=0,!e.hasAppendedData_){!e.timingInfo&&typeof e.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!0),e.timingInfo={start:0},e.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(e),this.processMetadataQueue_()),this.checkAppendsDone_(e);return}f&&e.waitingOnAppends++,y&&e.waitingOnAppends++,f&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,e)),y&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,e))}checkAppendsDone_(e){this.checkForAbort_(e.requestId)||(e.waitingOnAppends--,e.waitingOnAppends===0&&this.handleAppendsDone_())}checkForIllegalMediaSwitch(e){const i=Lm(this.loaderType_,this.getCurrentMediaInfo_(),e);return i?(this.error({message:i,playlistExclusionDuration:Infinity}),this.trigger("error"),!0):!1}updateSourceBufferTimestampOffset_(e){if(e.timestampOffset===null||typeof e.timingInfo.start!="number"||e.changedTimestampOffset||this.loaderType_!=="main")return;let i=!1;e.timestampOffset-=this.getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:e.segment.videoTimingInfo,audioTimingInfo:e.segment.audioTimingInfo,timingInfo:e.timingInfo}),e.changedTimestampOffset=!0,e.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(e.timestampOffset),i=!0),e.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(e.timestampOffset),i=!0),i&&this.trigger("timestampoffset")}getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:e,audioTimingInfo:i,timingInfo:r}){return this.useDtsForTimestampOffset_?e&&typeof e.transmuxedDecodeStart=="number"?e.transmuxedDecodeStart:i&&typeof i.transmuxedDecodeStart=="number"?i.transmuxedDecodeStart:r.start:r.start}updateTimingInfoEnd_(e){e.timingInfo=e.timingInfo||{};const i=this.getMediaInfo_(),l=this.loaderType_==="main"&&i&&i.hasVideo&&e.videoTimingInfo?e.videoTimingInfo:e.audioTimingInfo;!l||(e.timingInfo.end=typeof l.end=="number"?l.end:l.start+e.duration)}handleAppendsDone_(){if(this.pendingSegment_&&this.trigger("appendsdone"),!this.pendingSegment_){this.state="READY",this.paused()||this.monitorBuffer_();return}const e=this.pendingSegment_;this.updateTimingInfoEnd_(e),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:this.loaderType_==="main"});const i=Rm(e,this.sourceType_);if(i&&(i.severity==="warn"?de.log.warn(i.message):this.logger_(i.message)),this.recordThroughput_(e),this.pendingSegment_=null,this.state="READY",e.isSyncRequest&&(this.trigger("syncinfoupdate"),!e.hasAppendedData_)){this.logger_(`Throwing away un-appended sync request ${El(e)}`);return}this.logger_(`Appended ${El(e)}`),this.addSegmentMetadataCue_(e),this.fetchAtBuffer_=!0,this.currentTimeline_!==e.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline}),this.loaderType_==="main"&&!this.audioDisabled_&&this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:e.timeline})),this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate");const r=e.segment,l=e.part,d=r.end&&this.currentTime_()-r.end>e.playlist.targetDuration*3,f=l&&l.end&&this.currentTime_()-l.end>e.playlist.partTargetDuration*3;if(d||f){this.logger_(`bad ${d?"segment":"part"} ${El(e)}`),this.resetEverything();return}this.mediaIndex!==null&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=e.mediaIndex,this.partIndex=e.partIndex,this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex)&&this.endOfStream(),this.trigger("appended"),e.hasAppendedData_&&this.mediaAppends++,this.paused()||this.monitorBuffer_()}recordThroughput_(e){if(e.duration<Jd){this.logger_(`Ignoring segment's throughput because its duration of ${e.duration} is less than the min to record ${Jd}`);return}const i=this.throughput.rate,r=Date.now()-e.endOfAllRequests+1,l=Math.floor(e.byteLength/r*8*1e3);this.throughput.rate+=(l-i)/++this.throughput.count}addSegmentMetadataCue_(e){if(!this.segmentMetadataTrack_)return;const i=e.segment,r=i.start,l=i.end;if(!Of(r)||!Of(l))return;ju(r,l,this.segmentMetadataTrack_);const d=le().WebKitDataCue||le().VTTCue,f={custom:i.custom,dateTimeObject:i.dateTimeObject,dateTimeString:i.dateTimeString,programDateTime:i.programDateTime,bandwidth:e.playlist.attributes.BANDWIDTH,resolution:e.playlist.attributes.RESOLUTION,codecs:e.playlist.attributes.CODECS,byteLength:e.byteLength,uri:e.uri,timeline:e.timeline,playlist:e.playlist.id,start:r,end:l},y=JSON.stringify(f),L=new d(r,l,y);L.value=f,this.segmentMetadataTrack_.addCue(L)}}function ea(){}const Nf=function(s){return typeof s!="string"?s:s.replace(/./,e=>e.toUpperCase())},Pm=["video","audio"],gh=(s,e)=>{const i=e[`${s}Buffer`];return i&&i.updating||e.queuePending[s]},Om=(s,e)=>{for(let i=0;i<e.length;i++){const r=e[i];if(r.type==="mediaSource")return null;if(r.type===s)return i}return null},Tl=(s,e)=>{if(e.queue.length===0)return;let i=0,r=e.queue[i];if(r.type==="mediaSource"){!e.updating()&&e.mediaSource.readyState!=="closed"&&(e.queue.shift(),r.action(e),r.doneFn&&r.doneFn(),Tl("audio",e),Tl("video",e));return}if(s!=="mediaSource"&&!(!e.ready()||e.mediaSource.readyState==="closed"||gh(s,e))){if(r.type!==s){if(i=Om(s,e.queue),i===null)return;r=e.queue[i]}if(e.queue.splice(i,1),e.queuePending[s]=r,r.action(s,e),!r.doneFn){e.queuePending[s]=null,Tl(s,e);return}}},Uf=(s,e)=>{const i=e[`${s}Buffer`],r=Nf(s);!i||(i.removeEventListener("updateend",e[`on${r}UpdateEnd_`]),i.removeEventListener("error",e[`on${r}Error_`]),e.codecs[s]=null,e[`${s}Buffer`]=null)},Ls=(s,e)=>s&&e&&Array.prototype.indexOf.call(s.sourceBuffers,e)!==-1,Cr={appendBuffer:(s,e,i)=>(r,l)=>{const d=l[`${r}Buffer`];if(!!Ls(l.mediaSource,d)){l.logger_(`Appending segment ${e.mediaIndex}'s ${s.length} bytes to ${r}Buffer`);try{d.appendBuffer(s)}catch(f){l.logger_(`Error with code ${f.code} `+(f.code===Pf?"(QUOTA_EXCEEDED_ERR) ":"")+`when appending segment ${e.mediaIndex} to ${r}Buffer`),l.queuePending[r]=null,i(f)}}},remove:(s,e)=>(i,r)=>{const l=r[`${i}Buffer`];if(!!Ls(r.mediaSource,l)){r.logger_(`Removing ${s} to ${e} from ${i}Buffer`);try{l.remove(s,e)}catch(d){r.logger_(`Remove ${s} to ${e} from ${i}Buffer failed`)}}},timestampOffset:s=>(e,i)=>{const r=i[`${e}Buffer`];!Ls(i.mediaSource,r)||(i.logger_(`Setting ${e}timestampOffset to ${s}`),r.timestampOffset=s)},callback:s=>(e,i)=>{s()},endOfStream:s=>e=>{if(e.mediaSource.readyState==="open"){e.logger_(`Calling mediaSource endOfStream(${s||""})`);try{e.mediaSource.endOfStream(s)}catch(i){de.log.warn("Failed to call media source endOfStream",i)}}},duration:s=>e=>{e.logger_(`Setting mediaSource duration to ${s}`);try{e.mediaSource.duration=s}catch(i){de.log.warn("Failed to set media source duration",i)}},abort:()=>(s,e)=>{if(e.mediaSource.readyState!=="open")return;const i=e[`${s}Buffer`];if(!!Ls(e.mediaSource,i)){e.logger_(`calling abort on ${s}Buffer`);try{i.abort()}catch(r){de.log.warn(`Failed to abort on ${s}Buffer`,r)}}},addSourceBuffer:(s,e)=>i=>{const r=Nf(s),l=_t(e);i.logger_(`Adding ${s}Buffer with codec ${e} to mediaSource`);const d=i.mediaSource.addSourceBuffer(l);d.addEventListener("updateend",i[`on${r}UpdateEnd_`]),d.addEventListener("error",i[`on${r}Error_`]),i.codecs[s]=e,i[`${s}Buffer`]=d},removeSourceBuffer:s=>e=>{const i=e[`${s}Buffer`];if(Uf(s,e),!!Ls(e.mediaSource,i)){e.logger_(`Removing ${s}Buffer with codec ${e.codecs[s]} from mediaSource`);try{e.mediaSource.removeSourceBuffer(i)}catch(r){de.log.warn(`Failed to removeSourceBuffer ${s}Buffer`,r)}}},changeType:s=>(e,i)=>{const r=i[`${e}Buffer`],l=_t(s);if(!!Ls(i.mediaSource,r)&&i.codecs[e]!==s){i.logger_(`changing ${e}Buffer codec from ${i.codecs[e]} to ${s}`);try{r.changeType(l),i.codecs[e]=s}catch(d){de.log.warn(`Failed to changeType on ${e}Buffer`,d)}}}},wr=({type:s,sourceUpdater:e,action:i,doneFn:r,name:l})=>{e.queue.push({type:s,action:i,doneFn:r,name:l}),Tl(s,e)},jf=(s,e)=>i=>{if(e.queuePending[s]){const r=e.queuePending[s].doneFn;e.queuePending[s]=null,r&&r(e[`${s}Error_`])}Tl(s,e)};class $f extends de.EventTarget{constructor(e){super();this.mediaSource=e,this.sourceopenListener_=()=>Tl("mediaSource",this),this.mediaSource.addEventListener("sourceopen",this.sourceopenListener_),this.logger_=et("SourceUpdater"),this.audioTimestampOffset_=0,this.videoTimestampOffset_=0,this.queue=[],this.queuePending={audio:null,video:null},this.delayedAudioAppendQueue_=[],this.videoAppendQueued_=!1,this.codecs={},this.onVideoUpdateEnd_=jf("video",this),this.onAudioUpdateEnd_=jf("audio",this),this.onVideoError_=i=>{this.videoError_=i},this.onAudioError_=i=>{this.audioError_=i},this.createdSourceBuffers_=!1,this.initializedEme_=!1,this.triggeredReady_=!1}initializedEme(){this.initializedEme_=!0,this.triggerReady()}hasCreatedSourceBuffers(){return this.createdSourceBuffers_}hasInitializedAnyEme(){return this.initializedEme_}ready(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()}createSourceBuffers(e){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(e),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())}triggerReady(){this.ready()&&!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))}addSourceBuffer(e,i){wr({type:"mediaSource",sourceUpdater:this,action:Cr.addSourceBuffer(e,i),name:"addSourceBuffer"})}abort(e){wr({type:e,sourceUpdater:this,action:Cr.abort(e),name:"abort"})}removeSourceBuffer(e){if(!this.canRemoveSourceBuffer()){de.log.error("removeSourceBuffer is not supported!");return}wr({type:"mediaSource",sourceUpdater:this,action:Cr.removeSourceBuffer(e),name:"removeSourceBuffer"})}canRemoveSourceBuffer(){return!de.browser.IS_FIREFOX&&le().MediaSource&&le().MediaSource.prototype&&typeof le().MediaSource.prototype.removeSourceBuffer=="function"}static canChangeType(){return le().SourceBuffer&&le().SourceBuffer.prototype&&typeof le().SourceBuffer.prototype.changeType=="function"}canChangeType(){return this.constructor.canChangeType()}changeType(e,i){if(!this.canChangeType()){de.log.error("changeType is not supported!");return}wr({type:e,sourceUpdater:this,action:Cr.changeType(i),name:"changeType"})}addOrChangeSourceBuffers(e){if(!e||typeof e!="object"||Object.keys(e).length===0)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(e).forEach(i=>{const r=e[i];if(!this.hasCreatedSourceBuffers())return this.addSourceBuffer(i,r);this.canChangeType()&&this.changeType(i,r)})}appendBuffer(e,i){const{segmentInfo:r,type:l,bytes:d}=e;if(this.processedAppend_=!0,l==="audio"&&this.videoBuffer&&!this.videoAppendQueued_){this.delayedAudioAppendQueue_.push([e,i]),this.logger_(`delayed audio append of ${d.length} until video append`);return}const f=i;if(wr({type:l,sourceUpdater:this,action:Cr.appendBuffer(d,r||{mediaIndex:-1},f),doneFn:i,name:"appendBuffer"}),l==="video"){if(this.videoAppendQueued_=!0,!this.delayedAudioAppendQueue_.length)return;const y=this.delayedAudioAppendQueue_.slice();this.logger_(`queuing delayed audio ${y.length} appendBuffers`),this.delayedAudioAppendQueue_.length=0,y.forEach(L=>{this.appendBuffer.apply(this,L)})}}audioBuffered(){return Ls(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered?this.audioBuffer.buffered:Ht()}videoBuffered(){return Ls(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered?this.videoBuffer.buffered:Ht()}buffered(){const e=Ls(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,i=Ls(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return i&&!e?this.audioBuffered():e&&!i?this.videoBuffered():$t(this.audioBuffered(),this.videoBuffered())}setDuration(e,i=ea){wr({type:"mediaSource",sourceUpdater:this,action:Cr.duration(e),name:"duration",doneFn:i})}endOfStream(e=null,i=ea){typeof e!="string"&&(e=void 0),wr({type:"mediaSource",sourceUpdater:this,action:Cr.endOfStream(e),name:"endOfStream",doneFn:i})}removeAudio(e,i,r=ea){if(!this.audioBuffered().length||this.audioBuffered().end(0)===0){r();return}wr({type:"audio",sourceUpdater:this,action:Cr.remove(e,i),doneFn:r,name:"remove"})}removeVideo(e,i,r=ea){if(!this.videoBuffered().length||this.videoBuffered().end(0)===0){r();return}wr({type:"video",sourceUpdater:this,action:Cr.remove(e,i),doneFn:r,name:"remove"})}updating(){return!!(gh("audio",this)||gh("video",this))}audioTimestampOffset(e){return typeof e!="undefined"&&this.audioBuffer&&this.audioTimestampOffset_!==e&&(wr({type:"audio",sourceUpdater:this,action:Cr.timestampOffset(e),name:"timestampOffset"}),this.audioTimestampOffset_=e),this.audioTimestampOffset_}videoTimestampOffset(e){return typeof e!="undefined"&&this.videoBuffer&&this.videoTimestampOffset!==e&&(wr({type:"video",sourceUpdater:this,action:Cr.timestampOffset(e),name:"timestampOffset"}),this.videoTimestampOffset_=e),this.videoTimestampOffset_}audioQueueCallback(e){!this.audioBuffer||wr({type:"audio",sourceUpdater:this,action:Cr.callback(e),name:"callback"})}videoQueueCallback(e){!this.videoBuffer||wr({type:"video",sourceUpdater:this,action:Cr.callback(e),name:"callback"})}dispose(){this.trigger("dispose"),Pm.forEach(e=>{this.abort(e),this.canRemoveSourceBuffer()?this.removeSourceBuffer(e):this[`${e}QueueCallback`](()=>Uf(e,this))}),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()}}const Vf=s=>decodeURIComponent(escape(String.fromCharCode.apply(null,s))),Bm=s=>{const e=new Uint8Array(s);return Array.from(e).map(i=>i.toString(16).padStart(2,"0")).join("")},Gf=new Uint8Array(`

`.split("").map(s=>s.charCodeAt(0)));class Mm extends Error{constructor(){super("Trying to parse received VTT cues, but there is no WebVTT. Make sure vtt.js is loaded.")}}class Fm extends mh{constructor(e,i={}){super(e,i);this.mediaSource_=null,this.subtitlesTrack_=null,this.loaderType_="subtitle",this.featuresNativeTextTracks_=e.featuresNativeTextTracks,this.loadVttJs=e.loadVttJs,this.shouldSaveSegmentTimingInfo_=!1}createTransmuxer_(){return null}buffered_(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues||!this.subtitlesTrack_.cues.length)return Ht();const e=this.subtitlesTrack_.cues,i=e[0].startTime,r=e[e.length-1].startTime;return Ht([[i,r]])}initSegmentForMap(e,i=!1){if(!e)return null;const r=zd(e);let l=this.initSegments_[r];if(i&&!l&&e.bytes){const d=Gf.byteLength+e.bytes.byteLength,f=new Uint8Array(d);f.set(e.bytes),f.set(Gf,e.bytes.byteLength),this.initSegments_[r]=l={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:f}}return l||e}couldBeginLoading_(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}track(e){return typeof e=="undefined"?this.subtitlesTrack_:(this.subtitlesTrack_=e,this.state==="INIT"&&this.couldBeginLoading_()&&this.init_(),this.subtitlesTrack_)}remove(e,i){ju(e,i,this.subtitlesTrack_)}fillBuffer_(){const e=this.chooseNextRequest_();if(!!e){if(this.syncController_.timestampOffsetForTimeline(e.timeline)===null){const i=()=>{this.state="READY",this.paused()||this.monitorBuffer_()};this.syncController_.one("timestampoffset",i),this.state="WAITING_ON_TIMELINE";return}this.loadSegment_(e)}}timestampOffsetForSegment_(){return null}chooseNextRequest_(){return this.skipEmptySegments_(super.chooseNextRequest_())}skipEmptySegments_(e){for(;e&&e.segment.empty;){if(e.mediaIndex+1>=e.playlist.segments.length){e=null;break}e=this.generateSegmentInfo_({playlist:e.playlist,mediaIndex:e.mediaIndex+1,startOfSegment:e.startOfSegment+e.duration,isSyncRequest:e.isSyncRequest})}return e}stopForError(e){this.error(e),this.state="READY",this.pause(),this.trigger("error")}segmentRequestFinished_(e,i,r){if(!this.subtitlesTrack_){this.state="READY";return}if(this.saveTransferStats_(i.stats),!this.pendingSegment_){this.state="READY",this.mediaRequestsAborted+=1;return}if(e){e.code===ws.TIMEOUT&&this.handleTimeout_(),e.code===ws.ABORTED?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,this.stopForError(e);return}const l=this.pendingSegment_;this.saveBandwidthRelatedStats_(l.duration,i.stats),i.key&&this.segmentKey(i.key,!0),this.state="APPENDING",this.trigger("appending");const d=l.segment;if(d.map&&(d.map.bytes=i.map.bytes),l.bytes=i.bytes,typeof le().WebVTT!="function"&&typeof this.loadVttJs=="function"){this.state="WAITING_ON_VTTJS",this.loadVttJs().then(()=>this.segmentRequestFinished_(e,i,r),()=>this.stopForError({message:"Error loading vtt.js"}));return}d.requested=!0;try{this.parseVTTCues_(l)}catch(f){this.stopForError({message:f.message});return}if(this.updateTimeMapping_(l,this.syncController_.timelines[l.timeline],this.playlist_),l.cues.length?l.timingInfo={start:l.cues[0].startTime,end:l.cues[l.cues.length-1].endTime}:l.timingInfo={start:l.startOfSegment,end:l.startOfSegment+l.duration},l.isSyncRequest){this.trigger("syncinfoupdate"),this.pendingSegment_=null,this.state="READY";return}l.byteLength=l.bytes.byteLength,this.mediaSecondsLoaded+=d.duration,l.cues.forEach(f=>{this.subtitlesTrack_.addCue(this.featuresNativeTextTracks_?new(le()).VTTCue(f.startTime,f.endTime,f.text):f)}),_m(this.subtitlesTrack_),this.handleAppendsDone_()}handleData_(){}updateTimingInfoEnd_(){}parseVTTCues_(e){let i,r=!1;if(typeof le().WebVTT!="function")throw new Mm;typeof le().TextDecoder=="function"?i=new(le()).TextDecoder("utf8"):(i=le().WebVTT.StringDecoder(),r=!0);const l=new(le()).WebVTT.Parser(le(),le().vttjs,i);if(e.cues=[],e.timestampmap={MPEGTS:0,LOCAL:0},l.oncue=e.cues.push.bind(e.cues),l.ontimestampmap=f=>{e.timestampmap=f},l.onparsingerror=f=>{de.log.warn("Error encountered when parsing cues: "+f.message)},e.segment.map){let f=e.segment.map.bytes;r&&(f=Vf(f)),l.parse(f)}let d=e.bytes;r&&(d=Vf(d)),l.parse(d),l.flush()}updateTimeMapping_(e,i,r){const l=e.segment;if(!i)return;if(!e.cues.length){l.empty=!0;return}const{MPEGTS:d,LOCAL:f}=e.timestampmap,L=d/Mr.ONE_SECOND_IN_TS-f+i.mapping;if(e.cues.forEach(B=>{const W=B.endTime-B.startTime,ce=d===0?B.startTime+L:this.handleRollover_(B.startTime+L,i.time);B.startTime=Math.max(ce,0),B.endTime=Math.max(ce+W,0)}),!r.syncInfo){const B=e.cues[0].startTime,W=e.cues[e.cues.length-1].startTime;r.syncInfo={mediaSequence:r.mediaSequence+e.mediaIndex,time:Math.min(B,W-l.duration)}}}handleRollover_(e,i){if(i===null)return e;let r=e*Mr.ONE_SECOND_IN_TS;const l=i*Mr.ONE_SECOND_IN_TS;let d;for(l<r?d=-8589934592:d=8589934592;Math.abs(r-l)>4294967296;)r+=d;return r/Mr.ONE_SECOND_IN_TS}}const Nm=function(s,e){const i=s.cues;for(let r=0;r<i.length;r++){const l=i[r];if(e>=l.adStartTime&&e<=l.adEndTime)return l}return null},Um=function(s,e,i=0){if(!s.segments)return;let r=i,l;for(let d=0;d<s.segments.length;d++){const f=s.segments[d];if(l||(l=Nm(e,r+f.duration/2)),l){if("cueIn"in f){l.endTime=r,l.adEndTime=r,r+=f.duration,l=null;continue}if(r<l.endTime){r+=f.duration;continue}l.endTime+=f.duration}else if("cueOut"in f&&(l=new(le()).VTTCue(r,r+f.duration,f.cueOut),l.adStartTime=r,l.adEndTime=r+parseFloat(f.cueOut),e.addCue(l)),"cueOutCont"in f){const[y,L]=f.cueOutCont.split("/").map(parseFloat);l=new(le()).VTTCue(r,r+f.duration,""),l.adStartTime=r-y,l.adEndTime=l.adStartTime+L,e.addCue(l)}r+=f.duration}},jm=86400,yh=[{name:"VOD",run:(s,e,i,r,l)=>i!==Infinity?{time:0,segmentIndex:0,partIndex:null}:null},{name:"MediaSequence",run:(s,e,i,r,l,d)=>{if(!d)return null;const f=s.getMediaSequenceMap(d);if(!f||f.size===0||e.mediaSequence===void 0||!Array.isArray(e.segments)||!e.segments.length)return null;let y=e.mediaSequence,L=0;for(const B of e.segments){const W=f.get(y);if(!W)break;if(l>=W.start&&l<W.end){if(Array.isArray(B.parts)&&B.parts.length){let ce=W.start,ke=0;for(const Pe of B.parts){const be=ce,je=be+Pe.duration;if(l>=be&&l<je)return{time:W.start,segmentIndex:L,partIndex:ke};ke++,ce=je}}return{time:W.start,segmentIndex:L,partIndex:null}}L++,y++}return null}},{name:"ProgramDateTime",run:(s,e,i,r,l)=>{if(!Object.keys(s.timelineToDatetimeMappings).length)return null;let d=null,f=null;const y=Nn(e);l=l||0;for(let L=0;L<y.length;L++){const B=e.endList||l===0?L:y.length-(L+1),W=y[B],ce=W.segment,ke=s.timelineToDatetimeMappings[ce.timeline];if(!ke||!ce.dateTimeObject)continue;let be=ce.dateTimeObject.getTime()/1e3+ke;if(ce.parts&&typeof W.partIndex=="number")for(let We=0;We<W.partIndex;We++)be+=ce.parts[We].duration;const je=Math.abs(l-be);if(f!==null&&(je===0||f<je))break;f=je,d={time:be,segmentIndex:W.segmentIndex,partIndex:W.partIndex}}return d}},{name:"Segment",run:(s,e,i,r,l)=>{let d=null,f=null;l=l||0;const y=Nn(e);for(let L=0;L<y.length;L++){const B=e.endList||l===0?L:y.length-(L+1),W=y[B],ce=W.segment,ke=W.part&&W.part.start||ce&&ce.start;if(ce.timeline===r&&typeof ke!="undefined"){const Pe=Math.abs(l-ke);if(f!==null&&f<Pe)break;(!d||f===null||f>=Pe)&&(f=Pe,d={time:ke,segmentIndex:W.segmentIndex,partIndex:W.partIndex})}}return d}},{name:"Discontinuity",run:(s,e,i,r,l)=>{let d=null;if(l=l||0,e.discontinuityStarts&&e.discontinuityStarts.length){let f=null;for(let y=0;y<e.discontinuityStarts.length;y++){const L=e.discontinuityStarts[y],B=e.discontinuitySequence+y+1,W=s.discontinuities[B];if(W){const ce=Math.abs(l-W.time);if(f!==null&&f<ce)break;(!d||f===null||f>=ce)&&(f=ce,d={time:W.time,segmentIndex:L,partIndex:null})}}}return d}},{name:"Playlist",run:(s,e,i,r,l)=>e.syncInfo?{time:e.syncInfo.time,segmentIndex:e.syncInfo.mediaSequence-e.mediaSequence,partIndex:null}:null}];class $m extends de.EventTarget{constructor(e={}){super();this.timelines=[],this.discontinuities=[],this.timelineToDatetimeMappings={},this.mediaSequenceStorage_=new Map,this.logger_=et("SyncController")}getMediaSequenceMap(e){return this.mediaSequenceStorage_.get(e)}updateMediaSequenceMap(e,i,r){if(e.mediaSequence===void 0||!Array.isArray(e.segments)||!e.segments.length)return;const l=this.getMediaSequenceMap(r),d=new Map;let f=e.mediaSequence,y;l?l.has(e.mediaSequence)?y=l.get(e.mediaSequence).start:(this.logger_(`MediaSequence sync for ${r} segment loader - received a gap between playlists.
Fallback base time to: ${i}.
Received media sequence: ${f}.
Current map: `,l),y=i):y=0,this.logger_(`MediaSequence sync for ${r} segment loader.
Received media sequence: ${f}.
base time is ${y}
Current map: `,l),e.segments.forEach(L=>{const B=y,W=B+L.duration,ce={start:B,end:W};d.set(f,ce),f++,y=W}),this.mediaSequenceStorage_.set(r,d)}getSyncPoint(e,i,r,l,d){if(i!==Infinity)return yh.find(({name:L})=>L==="VOD").run(this,e,i);const f=this.runStrategies_(e,i,r,l,d);if(!f.length)return null;for(const y of f){const{syncPoint:L,strategy:B}=y,{segmentIndex:W,time:ce}=L;if(W<0)continue;const ke=e.segments[W],Pe=ce,be=Pe+ke.duration;if(this.logger_(`Strategy: ${B}. Current time: ${l}. selected segment: ${W}. Time: [${Pe} -> ${be}]}`),l>=Pe&&l<be)return this.logger_("Found sync point with exact match: ",L),L}return this.selectSyncPoint_(f,{key:"time",value:l})}getExpiredTime(e,i){if(!e||!e.segments)return null;const r=this.runStrategies_(e,i,e.discontinuitySequence,0,"main");if(!r.length)return null;const l=this.selectSyncPoint_(r,{key:"segmentIndex",value:0});return l.segmentIndex>0&&(l.time*=-1),Math.abs(l.time+Mu({defaultDuration:e.targetDuration,durationList:e.segments,startIndex:l.segmentIndex,endIndex:0}))}runStrategies_(e,i,r,l,d){const f=[];for(let y=0;y<yh.length;y++){const L=yh[y],B=L.run(this,e,i,r,l,d);B&&(B.strategy=L.name,f.push({strategy:L.name,syncPoint:B}))}return f}selectSyncPoint_(e,i){let r=e[0].syncPoint,l=Math.abs(e[0].syncPoint[i.key]-i.value),d=e[0].strategy;for(let f=1;f<e.length;f++){const y=Math.abs(e[f].syncPoint[i.key]-i.value);y<l&&(l=y,r=e[f].syncPoint,d=e[f].strategy)}return this.logger_(`syncPoint for [${i.key}: ${i.value}] chosen with strategy [${d}]: [time:${r.time}, segmentIndex:${r.segmentIndex}`+(typeof r.partIndex=="number"?`,partIndex:${r.partIndex}`:"")+"]"),r}saveExpiredSegmentInfo(e,i){const r=i.mediaSequence-e.mediaSequence;if(r>jm){de.log.warn(`Not saving expired segment info. Media sequence gap ${r} is too large.`);return}for(let l=r-1;l>=0;l--){const d=e.segments[l];if(d&&typeof d.start!="undefined"){i.syncInfo={mediaSequence:e.mediaSequence+l,time:d.start},this.logger_(`playlist refresh sync: [time:${i.syncInfo.time}, mediaSequence: ${i.syncInfo.mediaSequence}]`),this.trigger("syncinfoupdate");break}}}setDateTimeMappingForStart(e){if(this.timelineToDatetimeMappings={},e.segments&&e.segments.length&&e.segments[0].dateTimeObject){const i=e.segments[0],r=i.dateTimeObject.getTime()/1e3;this.timelineToDatetimeMappings[i.timeline]=-r}}saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:i}){const r=this.calculateSegmentTimeMapping_(e,e.timingInfo,i),l=e.segment;r&&(this.saveDiscontinuitySyncInfo_(e),e.playlist.syncInfo||(e.playlist.syncInfo={mediaSequence:e.playlist.mediaSequence+e.mediaIndex,time:l.start}));const d=l.dateTimeObject;l.discontinuity&&i&&d&&(this.timelineToDatetimeMappings[l.timeline]=-(d.getTime()/1e3))}timestampOffsetForTimeline(e){return typeof this.timelines[e]=="undefined"?null:this.timelines[e].time}mappingForTimeline(e){return typeof this.timelines[e]=="undefined"?null:this.timelines[e].mapping}calculateSegmentTimeMapping_(e,i,r){const l=e.segment,d=e.part;let f=this.timelines[e.timeline],y,L;if(typeof e.timestampOffset=="number")f={time:e.startOfSegment,mapping:e.startOfSegment-i.start},r&&(this.timelines[e.timeline]=f,this.trigger("timestampoffset"),this.logger_(`time mapping for timeline ${e.timeline}: [time: ${f.time}] [mapping: ${f.mapping}]`)),y=e.startOfSegment,L=i.end+f.mapping;else if(f)y=i.start+f.mapping,L=i.end+f.mapping;else return!1;return d&&(d.start=y,d.end=L),(!l.start||y<l.start)&&(l.start=y),l.end=L,!0}saveDiscontinuitySyncInfo_(e){const i=e.playlist,r=e.segment;if(r.discontinuity)this.discontinuities[r.timeline]={time:r.start,accuracy:0};else if(i.discontinuityStarts&&i.discontinuityStarts.length)for(let l=0;l<i.discontinuityStarts.length;l++){const d=i.discontinuityStarts[l],f=i.discontinuitySequence+l+1,y=d-e.mediaIndex,L=Math.abs(y);if(!this.discontinuities[f]||this.discontinuities[f].accuracy>L){let B;y<0?B=r.start-Mu({defaultDuration:i.targetDuration,durationList:i.segments,startIndex:e.mediaIndex,endIndex:d}):B=r.end+Mu({defaultDuration:i.targetDuration,durationList:i.segments,startIndex:e.mediaIndex+1,endIndex:d}),this.discontinuities[f]={time:B,accuracy:L}}}}dispose(){this.trigger("dispose"),this.off()}}class Vm extends de.EventTarget{constructor(){super();this.pendingTimelineChanges_={},this.lastTimelineChanges_={}}clearPendingTimelineChange(e){this.pendingTimelineChanges_[e]=null,this.trigger("pendingtimelinechange")}pendingTimelineChange({type:e,from:i,to:r}){return typeof i=="number"&&typeof r=="number"&&(this.pendingTimelineChanges_[e]={type:e,from:i,to:r},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[e]}lastTimelineChange({type:e,from:i,to:r}){return typeof i=="number"&&typeof r=="number"&&(this.lastTimelineChanges_[e]={type:e,from:i,to:r},delete this.pendingTimelineChanges_[e],this.trigger("timelinechange")),this.lastTimelineChanges_[e]}dispose(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()}}const Gm=gf(yf(function(){var s=function(){function je(){this.listeners={}}var We=je.prototype;return We.on=function(He,dt){this.listeners[He]||(this.listeners[He]=[]),this.listeners[He].push(dt)},We.off=function(He,dt){if(!this.listeners[He])return!1;var tt=this.listeners[He].indexOf(dt);return this.listeners[He]=this.listeners[He].slice(0),this.listeners[He].splice(tt,1),tt>-1},We.trigger=function(He){var dt=this.listeners[He];if(!!dt)if(arguments.length===2)for(var tt=dt.length,Ue=0;Ue<tt;++Ue)dt[Ue].call(this,arguments[1]);else for(var xt=Array.prototype.slice.call(arguments,1),Vt=dt.length,mi=0;mi<Vt;++mi)dt[mi].apply(this,xt)},We.dispose=function(){this.listeners={}},We.pipe=function(He){this.on("data",function(dt){He.push(dt)})},je}();/*! @name pkcs7 @version 1.0.4 @license Apache-2.0 */function e(je){return je.subarray(0,je.byteLength-je[je.byteLength-1])}/*! @name aes-decrypter @version 4.0.1 @license Apache-2.0 */const i=function(){const je=[[[],[],[],[],[]],[[],[],[],[],[]]],We=je[0],Je=je[1],He=We[4],dt=Je[4];let tt,Ue,xt;const Vt=[],mi=[];let yi,an,Un,on,Yt,$i;for(tt=0;tt<256;tt++)mi[(Vt[tt]=tt<<1^(tt>>7)*283)^tt]=tt;for(Ue=xt=0;!He[Ue];Ue^=yi||1,xt=mi[xt]||1)for(on=xt^xt<<1^xt<<2^xt<<3^xt<<4,on=on>>8^on&255^99,He[Ue]=on,dt[on]=Ue,Un=Vt[an=Vt[yi=Vt[Ue]]],$i=Un*16843009^an*65537^yi*257^Ue*16843008,Yt=Vt[on]*257^on*16843008,tt=0;tt<4;tt++)We[tt][Ue]=Yt=Yt<<24^Yt>>>8,Je[tt][on]=$i=$i<<24^$i>>>8;for(tt=0;tt<5;tt++)We[tt]=We[tt].slice(0),Je[tt]=Je[tt].slice(0);return je};let r=null;class l{constructor(We){r||(r=i()),this._tables=[[r[0][0].slice(),r[0][1].slice(),r[0][2].slice(),r[0][3].slice(),r[0][4].slice()],[r[1][0].slice(),r[1][1].slice(),r[1][2].slice(),r[1][3].slice(),r[1][4].slice()]];let Je,He,dt;const tt=this._tables[0][4],Ue=this._tables[1],xt=We.length;let Vt=1;if(xt!==4&&xt!==6&&xt!==8)throw new Error("Invalid aes key size");const mi=We.slice(0),yi=[];for(this._key=[mi,yi],Je=xt;Je<4*xt+28;Je++)dt=mi[Je-1],(Je%xt==0||xt===8&&Je%xt==4)&&(dt=tt[dt>>>24]<<24^tt[dt>>16&255]<<16^tt[dt>>8&255]<<8^tt[dt&255],Je%xt==0&&(dt=dt<<8^dt>>>24^Vt<<24,Vt=Vt<<1^(Vt>>7)*283)),mi[Je]=mi[Je-xt]^dt;for(He=0;Je;He++,Je--)dt=mi[He&3?Je:Je-4],Je<=4||He<4?yi[He]=dt:yi[He]=Ue[0][tt[dt>>>24]]^Ue[1][tt[dt>>16&255]]^Ue[2][tt[dt>>8&255]]^Ue[3][tt[dt&255]]}decrypt(We,Je,He,dt,tt,Ue){const xt=this._key[1];let Vt=We^xt[0],mi=dt^xt[1],yi=He^xt[2],an=Je^xt[3],Un,on,Yt;const $i=xt.length/4-2;let Ds,ia=4;const La=this._tables[1],lo=La[0],uo=La[1],co=La[2],ho=La[3],fo=La[4];for(Ds=0;Ds<$i;Ds++)Un=lo[Vt>>>24]^uo[mi>>16&255]^co[yi>>8&255]^ho[an&255]^xt[ia],on=lo[mi>>>24]^uo[yi>>16&255]^co[an>>8&255]^ho[Vt&255]^xt[ia+1],Yt=lo[yi>>>24]^uo[an>>16&255]^co[Vt>>8&255]^ho[mi&255]^xt[ia+2],an=lo[an>>>24]^uo[Vt>>16&255]^co[mi>>8&255]^ho[yi&255]^xt[ia+3],ia+=4,Vt=Un,mi=on,yi=Yt;for(Ds=0;Ds<4;Ds++)tt[(3&-Ds)+Ue]=fo[Vt>>>24]<<24^fo[mi>>16&255]<<16^fo[yi>>8&255]<<8^fo[an&255]^xt[ia++],Un=Vt,Vt=mi,mi=yi,yi=an,an=Un}}class d extends s{constructor(){super(s);this.jobs=[],this.delay=1,this.timeout_=null}processJob_(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null}push(We){this.jobs.push(We),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))}}const f=function(je){return je<<24|(je&65280)<<8|(je&16711680)>>8|je>>>24},y=function(je,We,Je){const He=new Int32Array(je.buffer,je.byteOffset,je.byteLength>>2),dt=new l(Array.prototype.slice.call(We)),tt=new Uint8Array(je.byteLength),Ue=new Int32Array(tt.buffer);let xt,Vt,mi,yi,an,Un,on,Yt,$i;for(xt=Je[0],Vt=Je[1],mi=Je[2],yi=Je[3],$i=0;$i<He.length;$i+=4)an=f(He[$i]),Un=f(He[$i+1]),on=f(He[$i+2]),Yt=f(He[$i+3]),dt.decrypt(an,Un,on,Yt,Ue,$i),Ue[$i]=f(Ue[$i]^xt),Ue[$i+1]=f(Ue[$i+1]^Vt),Ue[$i+2]=f(Ue[$i+2]^mi),Ue[$i+3]=f(Ue[$i+3]^yi),xt=an,Vt=Un,mi=on,yi=Yt;return tt};class L{constructor(We,Je,He,dt){const tt=L.STEP,Ue=new Int32Array(We.buffer),xt=new Uint8Array(We.byteLength);let Vt=0;for(this.asyncStream_=new d,this.asyncStream_.push(this.decryptChunk_(Ue.subarray(Vt,Vt+tt),Je,He,xt)),Vt=tt;Vt<Ue.length;Vt+=tt)He=new Uint32Array([f(Ue[Vt-4]),f(Ue[Vt-3]),f(Ue[Vt-2]),f(Ue[Vt-1])]),this.asyncStream_.push(this.decryptChunk_(Ue.subarray(Vt,Vt+tt),Je,He,xt));this.asyncStream_.push(function(){dt(null,e(xt))})}static get STEP(){return 32e3}decryptChunk_(We,Je,He,dt){return function(){const tt=y(We,Je,He);dt.set(tt,We.byteOffset)}}}var B=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof pt.g!="undefined"?pt.g:typeof self!="undefined"?self:{},W;typeof window!="undefined"?W=window:typeof B!="undefined"?W=B:typeof self!="undefined"?W=self:W={};var ce=W,ke=function(We){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(We):We&&We.buffer instanceof ArrayBuffer},Pe=ce.BigInt||Number;Pe("0x1"),Pe("0x100"),Pe("0x10000"),Pe("0x1000000"),Pe("0x100000000"),Pe("0x10000000000"),Pe("0x1000000000000"),Pe("0x100000000000000"),Pe("0x10000000000000000"),function(){var je=new Uint16Array([65484]),We=new Uint8Array(je.buffer,je.byteOffset,je.byteLength);return We[0]===255?"big":We[0]===204?"little":"unknown"}();const be=function(je){const We={};return Object.keys(je).forEach(Je=>{const He=je[Je];ke(He)?We[Je]={bytes:He.buffer,byteOffset:He.byteOffset,byteLength:He.byteLength}:We[Je]=He}),We};self.onmessage=function(je){const We=je.data,Je=new Uint8Array(We.encrypted.bytes,We.encrypted.byteOffset,We.encrypted.byteLength),He=new Uint32Array(We.key.bytes,We.key.byteOffset,We.key.byteLength/4),dt=new Uint32Array(We.iv.bytes,We.iv.byteOffset,We.iv.byteLength/4);new L(Je,He,dt,function(tt,Ue){self.postMessage(be({source:We.source,decrypted:Ue}),[Ue.buffer])})}}));var Hm=mf(Gm);const qm=s=>{let e=s.default?"main":"alternative";return s.characteristics&&s.characteristics.indexOf("public.accessibility.describes-video")>=0&&(e="main-desc"),e},Hf=(s,e)=>{s.abort(),s.pause(),e&&e.activePlaylistLoader&&(e.activePlaylistLoader.pause(),e.activePlaylistLoader=null)},vh=(s,e)=>{e.activePlaylistLoader=s,s.load()},Km=(s,e)=>()=>{const{segmentLoaders:{[s]:i,main:r},mediaTypes:{[s]:l}}=e,d=l.activeTrack(),f=l.getActiveGroup(),y=l.activePlaylistLoader,L=l.lastGroup_;if(!(f&&L&&f.id===L.id)&&(l.lastGroup_=f,l.lastTrack_=d,Hf(i,l),!(!f||f.isMainPlaylist))){if(!f.playlistLoader){y&&r.resetEverything();return}i.resyncLoader(),vh(f.playlistLoader,l)}},Wm=(s,e)=>()=>{const{segmentLoaders:{[s]:i},mediaTypes:{[s]:r}}=e;r.lastGroup_=null,i.abort(),i.pause()},zm=(s,e)=>()=>{const{mainPlaylistLoader:i,segmentLoaders:{[s]:r,main:l},mediaTypes:{[s]:d}}=e,f=d.activeTrack(),y=d.getActiveGroup(),L=d.activePlaylistLoader,B=d.lastTrack_;if(!(B&&f&&B.id===f.id)&&(d.lastGroup_=y,d.lastTrack_=f,Hf(r,d),!!y)){if(y.isMainPlaylist){if(!f||!B||f.id===B.id)return;const W=e.vhs.playlistController_,ce=W.selectPlaylist();if(W.media()===ce)return;d.logger_(`track change. Switching main audio from ${B.id} to ${f.id}`),i.pause(),l.resetEverything(),W.fastQualityChange_(ce);return}if(s==="AUDIO"){if(!y.playlistLoader){l.setAudio(!0),l.resetEverything();return}r.setAudio(!0),l.setAudio(!1)}if(L===y.playlistLoader){vh(y.playlistLoader,d);return}r.track&&r.track(f),r.resetEverything(),vh(y.playlistLoader,d)}},Zd={AUDIO:(s,e)=>()=>{const{mediaTypes:{[s]:i},excludePlaylist:r}=e,l=i.activeTrack(),d=i.activeGroup(),f=(d.filter(L=>L.default)[0]||d[0]).id,y=i.tracks[f];if(l===y){r({error:{message:"Problem encountered loading the default audio track."}});return}de.log.warn("Problem encountered loading the alternate audio track.Switching back to default.");for(const L in i.tracks)i.tracks[L].enabled=i.tracks[L]===y;i.onTrackChanged()},SUBTITLES:(s,e)=>()=>{const{mediaTypes:{[s]:i}}=e;de.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track.");const r=i.activeTrack();r&&(r.mode="disabled"),i.onTrackChanged()}},qf={AUDIO:(s,e,i)=>{if(!e)return;const{tech:r,requestOptions:l,segmentLoaders:{[s]:d}}=i;e.on("loadedmetadata",()=>{const f=e.media();d.playlist(f,l),(!r.paused()||f.endList&&r.preload()!=="none")&&d.load()}),e.on("loadedplaylist",()=>{d.playlist(e.media(),l),r.paused()||d.load()}),e.on("error",Zd[s](s,i))},SUBTITLES:(s,e,i)=>{const{tech:r,requestOptions:l,segmentLoaders:{[s]:d},mediaTypes:{[s]:f}}=i;e.on("loadedmetadata",()=>{const y=e.media();d.playlist(y,l),d.track(f.activeTrack()),(!r.paused()||y.endList&&r.preload()!=="none")&&d.load()}),e.on("loadedplaylist",()=>{d.playlist(e.media(),l),r.paused()||d.load()}),e.on("error",Zd[s](s,i))}},Ym={AUDIO:(s,e)=>{const{vhs:i,sourceType:r,segmentLoaders:{[s]:l},requestOptions:d,main:{mediaGroups:f},mediaTypes:{[s]:{groups:y,tracks:L,logger_:B}},mainPlaylistLoader:W}=e,ce=Fu(W.main);(!f[s]||Object.keys(f[s]).length===0)&&(f[s]={main:{default:{default:!0}}},ce&&(f[s].main.default.playlists=W.main.playlists));for(const ke in f[s]){y[ke]||(y[ke]=[]);for(const Pe in f[s][ke]){let be=f[s][ke][Pe],je;if(ce?(B(`AUDIO group '${ke}' label '${Pe}' is a main playlist`),be.isMainPlaylist=!0,je=null):r==="vhs-json"&&be.playlists?je=new _l(be.playlists[0],i,d):be.resolvedUri?je=new _l(be.resolvedUri,i,d):be.playlists&&r==="dash"?je=new dh(be.playlists[0],i,d,W):je=null,be=st({id:Pe,playlistLoader:je},be),qf[s](s,be.playlistLoader,e),y[ke].push(be),typeof L[Pe]=="undefined"){const We=new de.AudioTrack({id:Pe,kind:qm(be),enabled:!1,language:be.language,default:be.default,label:Pe});L[Pe]=We}}}l.on("error",Zd[s](s,e))},SUBTITLES:(s,e)=>{const{tech:i,vhs:r,sourceType:l,segmentLoaders:{[s]:d},requestOptions:f,main:{mediaGroups:y},mediaTypes:{[s]:{groups:L,tracks:B}},mainPlaylistLoader:W}=e;for(const ce in y[s]){L[ce]||(L[ce]=[]);for(const ke in y[s][ce]){if(!r.options_.useForcedSubtitles&&y[s][ce][ke].forced)continue;let Pe=y[s][ce][ke],be;if(l==="hls")be=new _l(Pe.resolvedUri,r,f);else if(l==="dash"){if(!Pe.playlists.filter(We=>We.excludeUntil!==Infinity).length)return;be=new dh(Pe.playlists[0],r,f,W)}else l==="vhs-json"&&(be=new _l(Pe.playlists?Pe.playlists[0]:Pe.resolvedUri,r,f));if(Pe=st({id:ke,playlistLoader:be},Pe),qf[s](s,Pe.playlistLoader,e),L[ce].push(Pe),typeof B[ke]=="undefined"){const je=i.addRemoteTextTrack({id:ke,kind:"subtitles",default:Pe.default&&Pe.autoselect,language:Pe.language,label:ke},!1).track;B[ke]=je}}}d.on("error",Zd[s](s,e))},"CLOSED-CAPTIONS":(s,e)=>{const{tech:i,main:{mediaGroups:r},mediaTypes:{[s]:{groups:l,tracks:d}}}=e;for(const f in r[s]){l[f]||(l[f]=[]);for(const y in r[s][f]){const L=r[s][f][y];if(!/^(?:CC|SERVICE)/.test(L.instreamId))continue;const B=i.options_.vhs&&i.options_.vhs.captionServices||{};let W={label:y,language:L.language,instreamId:L.instreamId,default:L.default&&L.autoselect};if(B[W.instreamId]&&(W=st(W,B[W.instreamId])),W.default===void 0&&delete W.default,l[f].push(st({id:y},L)),typeof d[y]=="undefined"){const ce=i.addRemoteTextTrack({id:W.instreamId,kind:"captions",default:W.default,language:W.language,label:W.label},!1).track;d[y]=ce}}}}},Kf=(s,e)=>{for(let i=0;i<s.length;i++)if(rh(e,s[i])||s[i].playlists&&Kf(s[i].playlists,e))return!0;return!1},Xm=(s,e)=>i=>{const{mainPlaylistLoader:r,mediaTypes:{[s]:{groups:l}}}=e,d=r.media();if(!d)return null;let f=null;d.attributes[s]&&(f=l[d.attributes[s]]);const y=Object.keys(l);if(!f)if(s==="AUDIO"&&y.length>1&&Fu(e.main))for(let L=0;L<y.length;L++){const B=l[y[L]];if(Kf(B,d)){f=B;break}}else l.main?f=l.main:y.length===1&&(f=l[y[0]]);return typeof i=="undefined"?f:i===null||!f?null:f.filter(L=>L.id===i.id)[0]||null},Qm={AUDIO:(s,e)=>()=>{const{mediaTypes:{[s]:{tracks:i}}}=e;for(const r in i)if(i[r].enabled)return i[r];return null},SUBTITLES:(s,e)=>()=>{const{mediaTypes:{[s]:{tracks:i}}}=e;for(const r in i)if(i[r].mode==="showing"||i[r].mode==="hidden")return i[r];return null}},Jm=(s,{mediaTypes:e})=>()=>{const i=e[s].activeTrack();return i?e[s].activeGroup(i):null},Zm=s=>{["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(B=>{Ym[B](B,s)});const{mediaTypes:e,mainPlaylistLoader:i,tech:r,vhs:l,segmentLoaders:{["AUDIO"]:d,main:f}}=s;["AUDIO","SUBTITLES"].forEach(B=>{e[B].activeGroup=Xm(B,s),e[B].activeTrack=Qm[B](B,s),e[B].onGroupChanged=Km(B,s),e[B].onGroupChanging=Wm(B,s),e[B].onTrackChanged=zm(B,s),e[B].getActiveGroup=Jm(B,s)});const y=e.AUDIO.activeGroup();if(y){const B=(y.filter(ce=>ce.default)[0]||y[0]).id;e.AUDIO.tracks[B].enabled=!0,e.AUDIO.onGroupChanged(),e.AUDIO.onTrackChanged(),e.AUDIO.getActiveGroup().playlistLoader?(f.setAudio(!1),d.setAudio(!0)):f.setAudio(!0)}i.on("mediachange",()=>{["AUDIO","SUBTITLES"].forEach(B=>e[B].onGroupChanged())}),i.on("mediachanging",()=>{["AUDIO","SUBTITLES"].forEach(B=>e[B].onGroupChanging())});const L=()=>{e.AUDIO.onTrackChanged(),r.trigger({type:"usage",name:"vhs-audio-change"})};r.audioTracks().addEventListener("change",L),r.remoteTextTracks().addEventListener("change",e.SUBTITLES.onTrackChanged),l.on("dispose",()=>{r.audioTracks().removeEventListener("change",L),r.remoteTextTracks().removeEventListener("change",e.SUBTITLES.onTrackChanged)}),r.clearTracks("audio");for(const B in e.AUDIO.tracks)r.audioTracks().addTrack(e.AUDIO.tracks[B])},eg=()=>{const s={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(e=>{s[e]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:ea,activeTrack:ea,getActiveGroup:ea,onGroupChanged:ea,onTrackChanged:ea,lastTrack_:null,logger_:et(`MediaGroups[${e}]`)}}),s};class Wf{constructor(){this.priority_=[],this.pathwayClones_=new Map}set version(e){e===1&&(this.version_=e)}set ttl(e){this.ttl_=e||300}set reloadUri(e){e&&(this.reloadUri_=ct(this.reloadUri_,e))}set priority(e){e&&e.length&&(this.priority_=e)}set pathwayClones(e){e&&e.length&&(this.pathwayClones_=new Map(e.map(i=>[i.ID,i])))}get version(){return this.version_}get ttl(){return this.ttl_}get reloadUri(){return this.reloadUri_}get priority(){return this.priority_}get pathwayClones(){return this.pathwayClones_}}class tg extends de.EventTarget{constructor(e,i){super();this.currentPathway=null,this.defaultPathway=null,this.queryBeforeStart=!1,this.availablePathways_=new Set,this.steeringManifest=new Wf,this.proxyServerUrl_=null,this.manifestType_=null,this.ttlTimeout_=null,this.request_=null,this.currentPathwayClones=new Map,this.nextPathwayClones=new Map,this.excludedSteeringManifestURLs=new Set,this.logger_=et("Content Steering"),this.xhr_=e,this.getBandwidth_=i}assignTagProperties(e,i){this.manifestType_=i.serverUri?"HLS":"DASH";const r=i.serverUri||i.serverURL;if(!r){this.logger_(`steering manifest URL is ${r}, cannot request steering manifest.`),this.trigger("error");return}if(r.startsWith("data:")){this.decodeDataUriManifest_(r.substring(r.indexOf(",")+1));return}this.steeringManifest.reloadUri=ct(e,r),this.defaultPathway=i.pathwayId||i.defaultServiceLocation,this.queryBeforeStart=i.queryBeforeStart,this.proxyServerUrl_=i.proxyServerURL,this.defaultPathway&&!this.queryBeforeStart&&this.trigger("content-steering")}requestSteeringManifest(e){const i=this.steeringManifest.reloadUri;if(!i)return;const r=e?i:this.getRequestURI(i);if(!r){this.logger_("No valid content steering manifest URIs. Stopping content steering."),this.trigger("error"),this.dispose();return}this.request_=this.xhr_({uri:r},(l,d)=>{if(l){if(d.status===410){this.logger_(`manifest request 410 ${l}.`),this.logger_(`There will be no more content steering requests to ${r} this session.`),this.excludedSteeringManifestURLs.add(r);return}if(d.status===429){const y=d.responseHeaders["retry-after"];this.logger_(`manifest request 429 ${l}.`),this.logger_(`content steering will retry in ${y} seconds.`),this.startTTLTimeout_(parseInt(y,10));return}this.logger_(`manifest failed to load ${l}.`),this.startTTLTimeout_();return}const f=JSON.parse(this.request_.responseText);this.assignSteeringProperties_(f),this.startTTLTimeout_()})}setProxyServerUrl_(e){const i=new(le()).URL(e),r=new(le()).URL(this.proxyServerUrl_);return r.searchParams.set("url",encodeURI(i.toString())),this.setSteeringParams_(r.toString())}decodeDataUriManifest_(e){const i=JSON.parse(le().atob(e));this.assignSteeringProperties_(i)}setSteeringParams_(e){const i=new(le()).URL(e),r=this.getPathway(),l=this.getBandwidth_();if(r){const d=`_${this.manifestType_}_pathway`;i.searchParams.set(d,r)}if(l){const d=`_${this.manifestType_}_throughput`;i.searchParams.set(d,l)}return i.toString()}assignSteeringProperties_(e){if(this.steeringManifest.version=e.VERSION,!this.steeringManifest.version){this.logger_(`manifest version is ${e.VERSION}, which is not supported.`),this.trigger("error");return}this.steeringManifest.ttl=e.TTL,this.steeringManifest.reloadUri=e["RELOAD-URI"],this.steeringManifest.priority=e["PATHWAY-PRIORITY"]||e["SERVICE-LOCATION-PRIORITY"],this.steeringManifest.pathwayClones=e["PATHWAY-CLONES"],this.nextPathwayClones=this.steeringManifest.pathwayClones,this.availablePathways_.size||(this.logger_("There are no available pathways for content steering. Ending content steering."),this.trigger("error"),this.dispose());const r=(l=>{for(const d of l)if(this.availablePathways_.has(d))return d;return[...this.availablePathways_][0]})(this.steeringManifest.priority);this.currentPathway!==r&&(this.currentPathway=r,this.trigger("content-steering"))}getPathway(){return this.currentPathway||this.defaultPathway}getRequestURI(e){if(!e)return null;const i=l=>this.excludedSteeringManifestURLs.has(l);if(this.proxyServerUrl_){const l=this.setProxyServerUrl_(e);if(!i(l))return l}const r=this.setSteeringParams_(e);return i(r)?null:r}startTTLTimeout_(e=this.steeringManifest.ttl){const i=e*1e3;this.ttlTimeout_=le().setTimeout(()=>{this.requestSteeringManifest()},i)}clearTTLTimeout_(){le().clearTimeout(this.ttlTimeout_),this.ttlTimeout_=null}abort(){this.request_&&this.request_.abort(),this.request_=null}dispose(){this.off("content-steering"),this.off("error"),this.abort(),this.clearTTLTimeout_(),this.currentPathway=null,this.defaultPathway=null,this.queryBeforeStart=null,this.proxyServerUrl_=null,this.manifestType_=null,this.ttlTimeout_=null,this.request_=null,this.excludedSteeringManifestURLs=new Set,this.availablePathways_=new Set,this.steeringManifest=new Wf}addAvailablePathway(e){e&&this.availablePathways_.add(e)}clearAvailablePathways(){this.availablePathways_.clear()}excludePathway(e){return this.availablePathways_.delete(e)}didDASHTagChange(e,i){return!i&&this.steeringManifest.reloadUri||i&&(ct(e,i.serverURL)!==this.steeringManifest.reloadUri||i.defaultServiceLocation!==this.defaultPathway||i.queryBeforeStart!==this.queryBeforeStart||i.proxyServerURL!==this.proxyServerUrl_)}getAvailablePathways(){return this.availablePathways_}}const ig=10;let ta;const ng=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred","mediaAppends"],rg=function(s){return this.audioSegmentLoader_[s]+this.mainSegmentLoader_[s]},sg=function({currentPlaylist:s,buffered:e,currentTime:i,nextPlaylist:r,bufferLowWaterLine:l,bufferHighWaterLine:d,duration:f,bufferBasedABR:y,log:L}){if(!r)return de.log.warn("We received no playlist to switch to. Please check your stream."),!1;const B=`allowing switch ${s&&s.id||"null"} -> ${r.id}`;if(!s)return L(`${B} as current playlist is not set`),!0;if(r.id===s.id)return!1;const W=Boolean(qt(e,i).length);if(!s.endList)return!W&&typeof s.partTargetDuration=="number"?(L(`not ${B} as current playlist is live llhls, but currentTime isn't in buffered.`),!1):(L(`${B} as current playlist is live`),!0);const ce=sn(e,i),ke=y?wn.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:wn.MAX_BUFFER_LOW_WATER_LINE;if(f<ke)return L(`${B} as duration < max low water line (${f} < ${ke})`),!0;const Pe=r.attributes.BANDWIDTH,be=s.attributes.BANDWIDTH;if(Pe<be&&(!y||ce<d)){let je=`${B} as next bandwidth < current bandwidth (${Pe} < ${be})`;return y&&(je+=` and forwardBuffer < bufferHighWaterLine (${ce} < ${d})`),L(je),!0}if((!y||Pe>be)&&ce>=l){let je=`${B} as forwardBuffer >= bufferLowWaterLine (${ce} >= ${l})`;return y&&(je+=` and next bandwidth > current bandwidth (${Pe} > ${be})`),L(je),!0}return L(`not ${B} as no switching criteria met`),!1};class ag extends de.EventTarget{constructor(e){super();const{src:i,withCredentials:r,tech:l,bandwidth:d,externVhs:f,useCueTags:y,playlistExclusionDuration:L,enableLowInitialPlaylist:B,sourceType:W,cacheEncryptionKeys:ce,bufferBasedABR:ke,leastPixelDiffSelector:Pe,captionServices:be}=e;if(!i)throw new Error("A non-empty playlist URL or JSON manifest string is required");let{maxPlaylistRetries:je}=e;(je===null||typeof je=="undefined")&&(je=Infinity),ta=f,this.bufferBasedABR=Boolean(ke),this.leastPixelDiffSelector=Boolean(Pe),this.withCredentials=r,this.tech_=l,this.vhs_=l.vhs,this.sourceType_=W,this.useCueTags_=y,this.playlistExclusionDuration=L,this.maxPlaylistRetries=je,this.enableLowInitialPlaylist=B,this.useCueTags_&&(this.cueTagsTrack_=this.tech_.addTextTrack("metadata","ad-cues"),this.cueTagsTrack_.inBandMetadataTrackDispatchType=""),this.requestOptions_={withCredentials:r,maxPlaylistRetries:je,timeout:null},this.on("error",this.pauseLoading),this.mediaTypes_=eg(),this.mediaSource=new(le()).MediaSource,this.handleDurationChange_=this.handleDurationChange_.bind(this),this.handleSourceOpen_=this.handleSourceOpen_.bind(this),this.handleSourceEnded_=this.handleSourceEnded_.bind(this),this.mediaSource.addEventListener("durationchange",this.handleDurationChange_),this.mediaSource.addEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.addEventListener("sourceended",this.handleSourceEnded_),this.seekable_=Ht(),this.hasPlayed_=!1,this.syncController_=new $m(e),this.segmentMetadataTrack_=l.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,this.decrypter_=new Hm,this.sourceUpdater_=new $f(this.mediaSource),this.inbandTextTracks_={},this.timelineChangeController_=new Vm,this.keyStatusMap_=new Map;const We={vhs:this.vhs_,parse708captions:e.parse708captions,useDtsForTimestampOffset:e.useDtsForTimestampOffset,captionServices:be,mediaSource:this.mediaSource,currentTime:this.tech_.currentTime.bind(this.tech_),seekable:()=>this.seekable(),seeking:()=>this.tech_.seeking(),duration:()=>this.duration(),hasPlayed:()=>this.hasPlayed_,goalBufferLength:()=>this.goalBufferLength(),bandwidth:d,syncController:this.syncController_,decrypter:this.decrypter_,sourceType:this.sourceType_,inbandTextTracks:this.inbandTextTracks_,cacheEncryptionKeys:ce,sourceUpdater:this.sourceUpdater_,timelineChangeController:this.timelineChangeController_,exactManifestTimings:e.exactManifestTimings,addMetadataToTextTrack:this.addMetadataToTextTrack.bind(this)};this.mainPlaylistLoader_=this.sourceType_==="dash"?new dh(i,this.vhs_,st(this.requestOptions_,{addMetadataToTextTrack:this.addMetadataToTextTrack.bind(this)})):new _l(i,this.vhs_,st(this.requestOptions_,{addDateRangesToTextTrack:this.addDateRangesToTextTrack_.bind(this)})),this.setupMainPlaylistLoaderListeners_(),this.mainSegmentLoader_=new mh(st(We,{segmentMetadataTrack:this.segmentMetadataTrack_,loaderType:"main"}),e),this.audioSegmentLoader_=new mh(st(We,{loaderType:"audio"}),e),this.subtitleSegmentLoader_=new Fm(st(We,{loaderType:"vtt",featuresNativeTextTracks:this.tech_.featuresNativeTextTracks,loadVttJs:()=>new Promise((dt,tt)=>{function Ue(){l.off("vttjserror",xt),dt()}function xt(){l.off("vttjsloaded",Ue),tt()}l.one("vttjsloaded",Ue),l.one("vttjserror",xt),l.addWebVttScript_()})}),e);const Je=()=>this.mainSegmentLoader_.bandwidth;this.contentSteeringController_=new tg(this.vhs_.xhr,Je),this.setupSegmentLoaderListeners_(),this.bufferBasedABR&&(this.mainPlaylistLoader_.one("loadedplaylist",()=>this.startABRTimer_()),this.tech_.on("pause",()=>this.stopABRTimer_()),this.tech_.on("play",()=>this.startABRTimer_())),ng.forEach(dt=>{this[dt+"_"]=rg.bind(this,dt)}),this.logger_=et("pc"),this.triggeredFmp4Usage=!1,this.tech_.preload()==="none"?(this.loadOnPlay_=()=>{this.loadOnPlay_=null,this.mainPlaylistLoader_.load()},this.tech_.one("play",this.loadOnPlay_)):this.mainPlaylistLoader_.load(),this.timeToLoadedData__=-1,this.mainAppendsToLoadedData__=-1,this.audioAppendsToLoadedData__=-1;const He=this.tech_.preload()==="none"?"play":"loadstart";this.tech_.one(He,()=>{const dt=Date.now();this.tech_.one("loadeddata",()=>{this.timeToLoadedData__=Date.now()-dt,this.mainAppendsToLoadedData__=this.mainSegmentLoader_.mediaAppends,this.audioAppendsToLoadedData__=this.audioSegmentLoader_.mediaAppends})})}mainAppendsToLoadedData_(){return this.mainAppendsToLoadedData__}audioAppendsToLoadedData_(){return this.audioAppendsToLoadedData__}appendsToLoadedData_(){const e=this.mainAppendsToLoadedData_(),i=this.audioAppendsToLoadedData_();return e===-1||i===-1?-1:e+i}timeToLoadedData_(){return this.timeToLoadedData__}checkABR_(e="abr"){const i=this.selectPlaylist();i&&this.shouldSwitchToMedia_(i)&&this.switchMedia_(i,e)}switchMedia_(e,i,r){const l=this.media(),d=l&&(l.id||l.uri),f=e&&(e.id||e.uri);d&&d!==f&&(this.logger_(`switch media ${d} -> ${f} from ${i}`),this.tech_.trigger({type:"usage",name:`vhs-rendition-change-${i}`})),this.mainPlaylistLoader_.media(e,r)}switchMediaForDASHContentSteering_(){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(e=>{const i=this.mediaTypes_[e],r=i?i.activeGroup():null,l=this.contentSteeringController_.getPathway();if(r&&l){const f=(r.length?r[0].playlists:r.playlists).filter(y=>y.attributes.serviceLocation===l);f.length&&this.mediaTypes_[e].activePlaylistLoader.media(f[0])}})}startABRTimer_(){this.stopABRTimer_(),this.abrTimer_=le().setInterval(()=>this.checkABR_(),250)}stopABRTimer_(){this.tech_.scrubbing&&this.tech_.scrubbing()||(le().clearInterval(this.abrTimer_),this.abrTimer_=null)}getAudioTrackPlaylists_(){const e=this.main(),i=e&&e.playlists||[];if(!e||!e.mediaGroups||!e.mediaGroups.AUDIO)return i;const r=e.mediaGroups.AUDIO,l=Object.keys(r);let d;if(Object.keys(this.mediaTypes_.AUDIO.groups).length)d=this.mediaTypes_.AUDIO.activeTrack();else{const y=r.main||l.length&&r[l[0]];for(const L in y)if(y[L].default){d={label:L};break}}if(!d)return i;const f=[];for(const y in r)if(r[y][d.label]){const L=r[y][d.label];if(L.playlists&&L.playlists.length)f.push.apply(f,L.playlists);else if(L.uri)f.push(L);else if(e.playlists.length)for(let B=0;B<e.playlists.length;B++){const W=e.playlists[B];W.attributes&&W.attributes.AUDIO&&W.attributes.AUDIO===y&&f.push(W)}}return f.length?f:i}setupMainPlaylistLoaderListeners_(){this.mainPlaylistLoader_.on("loadedmetadata",()=>{const e=this.mainPlaylistLoader_.media(),i=e.targetDuration*1.5*1e3;nh(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=i,e.endList&&this.tech_.preload()!=="none"&&(this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.mainSegmentLoader_.load()),Zm({sourceType:this.sourceType_,segmentLoaders:{AUDIO:this.audioSegmentLoader_,SUBTITLES:this.subtitleSegmentLoader_,main:this.mainSegmentLoader_},tech:this.tech_,requestOptions:this.requestOptions_,mainPlaylistLoader:this.mainPlaylistLoader_,vhs:this.vhs_,main:this.main(),mediaTypes:this.mediaTypes_,excludePlaylist:this.excludePlaylist.bind(this)}),this.triggerPresenceUsage_(this.main(),e),this.setupFirstPlay(),!this.mediaTypes_.AUDIO.activePlaylistLoader||this.mediaTypes_.AUDIO.activePlaylistLoader.media()?this.trigger("selectedinitialmedia"):this.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",()=>{this.trigger("selectedinitialmedia")})}),this.mainPlaylistLoader_.on("loadedplaylist",()=>{this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_);let e=this.mainPlaylistLoader_.media();if(!e){this.attachContentSteeringListeners_(),this.initContentSteeringController_(),this.excludeUnsupportedVariants_();let i;if(this.enableLowInitialPlaylist&&(i=this.selectInitialPlaylist()),i||(i=this.selectPlaylist()),!i||!this.shouldSwitchToMedia_(i)||(this.initialMedia_=i,this.switchMedia_(this.initialMedia_,"initial"),!(this.sourceType_==="vhs-json"&&this.initialMedia_.segments)))return;e=this.initialMedia_}this.handleUpdatedMediaPlaylist(e)}),this.mainPlaylistLoader_.on("error",()=>{const e=this.mainPlaylistLoader_.error;this.excludePlaylist({playlistToExclude:e.playlist,error:e})}),this.mainPlaylistLoader_.on("mediachanging",()=>{this.mainSegmentLoader_.abort(),this.mainSegmentLoader_.pause()}),this.mainPlaylistLoader_.on("mediachange",()=>{const e=this.mainPlaylistLoader_.media(),i=e.targetDuration*1.5*1e3;nh(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=i,this.sourceType_==="dash"&&this.mainPlaylistLoader_.load(),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.waitingForFastQualityPlaylistReceived_?this.runFastQualitySwitch_():this.mainSegmentLoader_.load(),this.tech_.trigger({type:"mediachange",bubbles:!0})}),this.mainPlaylistLoader_.on("playlistunchanged",()=>{const e=this.mainPlaylistLoader_.media();if(e.lastExcludeReason_==="playlist-unchanged")return;this.stuckAtPlaylistEnd_(e)&&(this.excludePlaylist({error:{message:"Playlist no longer updating.",reason:"playlist-unchanged"}}),this.tech_.trigger("playliststuck"))}),this.mainPlaylistLoader_.on("renditiondisabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"})}),this.mainPlaylistLoader_.on("renditionenabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"})})}handleUpdatedMediaPlaylist(e){this.useCueTags_&&this.updateAdCues_(e),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.waitingForFastQualityPlaylistReceived_&&this.runFastQualitySwitch_(),this.updateDuration(!e.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())}triggerPresenceUsage_(e,i){const r=e.mediaGroups||{};let l=!0;const d=Object.keys(r.AUDIO);for(const f in r.AUDIO)for(const y in r.AUDIO[f])r.AUDIO[f][y].uri||(l=!1);l&&this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),Object.keys(r.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),ta.Playlist.isAes(i)&&this.tech_.trigger({type:"usage",name:"vhs-aes"}),d.length&&Object.keys(r.AUDIO[d[0]]).length>1&&this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"})}shouldSwitchToMedia_(e){const i=this.mainPlaylistLoader_.media()||this.mainPlaylistLoader_.pendingMedia_,r=this.tech_.currentTime(),l=this.bufferLowWaterLine(),d=this.bufferHighWaterLine(),f=this.tech_.buffered();return sg({buffered:f,currentTime:r,currentPlaylist:i,nextPlaylist:e,bufferLowWaterLine:l,bufferHighWaterLine:d,duration:this.duration(),bufferBasedABR:this.bufferBasedABR,log:this.logger_})}setupSegmentLoaderListeners_(){this.mainSegmentLoader_.on("bandwidthupdate",()=>{this.checkABR_("bandwidthupdate"),this.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("timeout",()=>{this.bufferBasedABR&&this.mainSegmentLoader_.load()}),this.bufferBasedABR||this.mainSegmentLoader_.on("progress",()=>{this.trigger("progress")}),this.mainSegmentLoader_.on("error",()=>{const i=this.mainSegmentLoader_.error();this.excludePlaylist({playlistToExclude:i.playlist,error:i})}),this.mainSegmentLoader_.on("appenderror",()=>{this.error=this.mainSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",()=>{this.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.audioSegmentLoader_.on("appenderror",()=>{this.error=this.audioSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("ended",()=>{this.logger_("main segment loader ended"),this.onEndOfStream()}),this.mainSegmentLoader_.on("earlyabort",i=>{this.bufferBasedABR||(this.delegateLoaders_("all",["abort"]),this.excludePlaylist({error:{message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},playlistExclusionDuration:ig}))});const e=()=>{if(!this.sourceUpdater_.hasCreatedSourceBuffers())return this.tryToCreateSourceBuffers_();const i=this.getCodecsOrExclude_();!i||this.sourceUpdater_.addOrChangeSourceBuffers(i)};this.mainSegmentLoader_.on("trackinfo",e),this.audioSegmentLoader_.on("trackinfo",e),this.mainSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("ended",()=>{this.logger_("audioSegmentLoader ended"),this.onEndOfStream()})}mediaSecondsLoaded_(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}load(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}fastQualityChange_(e=this.selectPlaylist()){if(e&&e===this.mainPlaylistLoader_.media()){this.logger_("skipping fastQualityChange because new media is same as old");return}this.switchMedia_(e,"fast-quality"),this.waitingForFastQualityPlaylistReceived_=!0}runFastQualitySwitch_(){this.waitingForFastQualityPlaylistReceived_=!1,this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(()=>{this.tech_.setCurrentTime(this.tech_.currentTime())})}play(){if(this.setupFirstPlay())return;this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();const e=this.tech_.seekable();if(this.tech_.duration()===Infinity&&this.tech_.currentTime()<e.start(0))return this.tech_.setCurrentTime(e.end(e.length-1))}setupFirstPlay(){const e=this.mainPlaylistLoader_.media();if(!e||this.tech_.paused()||this.hasPlayed_)return!1;if(!e.endList||e.start){const i=this.seekable();if(!i.length)return!1;const r=i.end(0);let l=r;if(e.start){const d=e.start.timeOffset;d<0?l=Math.max(r+d,i.start(0)):l=Math.min(r,d)}this.trigger("firstplay"),this.tech_.setCurrentTime(l)}return this.hasPlayed_=!0,this.load(),!0}handleSourceOpen_(){if(this.tryToCreateSourceBuffers_(),this.tech_.autoplay()){const e=this.tech_.play();typeof e!="undefined"&&typeof e.then=="function"&&e.then(null,i=>{})}this.trigger("sourceopen")}handleSourceEnded_(){if(!this.inbandTextTracks_.metadataTrack_)return;const e=this.inbandTextTracks_.metadataTrack_.cues;if(!e||!e.length)return;const i=this.duration();e[e.length-1].endTime=isNaN(i)||Math.abs(i)===Infinity?Number.MAX_VALUE:i}handleDurationChange_(){this.tech_.trigger("durationchange")}onEndOfStream(){let e=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){const i=this.mainSegmentLoader_.getCurrentMediaInfo_();!i||i.hasVideo?e=e&&this.audioSegmentLoader_.ended_:e=this.audioSegmentLoader_.ended_}!e||(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())}stuckAtPlaylistEnd_(e){if(!this.seekable().length)return!1;const r=this.syncController_.getExpiredTime(e,this.duration());if(r===null)return!1;const l=ta.Playlist.playlistEnd(e,r),d=this.tech_.currentTime(),f=this.tech_.buffered();if(!f.length)return l-d<=zt;const y=f.end(f.length-1);return y-d<=zt&&l-y<=zt}excludePlaylist({playlistToExclude:e=this.mainPlaylistLoader_.media(),error:i={},playlistExclusionDuration:r}){if(e=e||this.mainPlaylistLoader_.media(),r=r||i.playlistExclusionDuration||this.playlistExclusionDuration,!e){this.error=i,this.mediaSource.readyState!=="open"?this.trigger("error"):this.sourceUpdater_.endOfStream("network");return}e.playlistErrors_++;const l=this.mainPlaylistLoader_.main.playlists,d=l.filter(Wd),f=d.length===1&&d[0]===e;if(l.length===1&&r!==Infinity)return de.log.warn(`Problem encountered with playlist ${e.id}. Trying again since it is the only playlist.`),this.tech_.trigger("retryplaylist"),this.mainPlaylistLoader_.load(f);if(f){if(this.main().contentSteering){const be=this.pathwayAttribute_(e),je=this.contentSteeringController_.steeringManifest.ttl*1e3;this.contentSteeringController_.excludePathway(be),this.excludeThenChangePathway_(),setTimeout(()=>{this.contentSteeringController_.addAvailablePathway(be)},je);return}let Pe=!1;l.forEach(be=>{if(be===e)return;const je=be.excludeUntil;typeof je!="undefined"&&je!==Infinity&&(Pe=!0,delete be.excludeUntil)}),Pe&&(de.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}let y;e.playlistErrors_>this.maxPlaylistRetries?y=Infinity:y=Date.now()+r*1e3,e.excludeUntil=y,i.reason&&(e.lastExcludeReason_=i.reason),this.tech_.trigger("excludeplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-excluded"});const L=this.selectPlaylist();if(!L){this.error="Playback cannot continue. No available working or supported playlists.",this.trigger("error");return}const B=i.internal?this.logger_:de.log.warn,W=i.message?" "+i.message:"";B(`${i.internal?"Internal problem":"Problem"} encountered with playlist ${e.id}.${W} Switching to playlist ${L.id}.`),L.attributes.AUDIO!==e.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),L.attributes.SUBTITLES!==e.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]);const ce=L.targetDuration/2*1e3||5*1e3,ke=typeof L.lastRequest=="number"&&Date.now()-L.lastRequest<=ce;return this.switchMedia_(L,"exclude",f||ke)}pauseLoading(){this.delegateLoaders_("all",["abort","pause"]),this.stopABRTimer_()}delegateLoaders_(e,i){const r=[],l=e==="all";(l||e==="main")&&r.push(this.mainPlaylistLoader_);const d=[];(l||e==="audio")&&d.push("AUDIO"),(l||e==="subtitle")&&(d.push("CLOSED-CAPTIONS"),d.push("SUBTITLES")),d.forEach(f=>{const y=this.mediaTypes_[f]&&this.mediaTypes_[f].activePlaylistLoader;y&&r.push(y)}),["main","audio","subtitle"].forEach(f=>{const y=this[`${f}SegmentLoader_`];y&&(e===f||e==="all")&&r.push(y)}),r.forEach(f=>i.forEach(y=>{typeof f[y]=="function"&&f[y]()}))}setCurrentTime(e){const i=qt(this.tech_.buffered(),e);if(!(this.mainPlaylistLoader_&&this.mainPlaylistLoader_.media())||!this.mainPlaylistLoader_.media().segments)return 0;if(i&&i.length)return e;this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.pause(),this.audioSegmentLoader_.resetEverything()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.pause(),this.subtitleSegmentLoader_.resetEverything()),this.load()}duration(){if(!this.mainPlaylistLoader_)return 0;const e=this.mainPlaylistLoader_.media();return e?e.endList?this.mediaSource?this.mediaSource.duration:ta.Playlist.duration(e):Infinity:0}seekable(){return this.seekable_}onSyncInfoUpdate_(){let e;if(!this.mainPlaylistLoader_)return;let i=this.mainPlaylistLoader_.media();if(!i)return;let r=this.syncController_.getExpiredTime(i,this.duration());if(r===null)return;const l=this.mainPlaylistLoader_.main,d=ta.Playlist.seekable(i,r,ta.Playlist.liveEdgeDelay(l,i));if(d.length===0||this.mediaTypes_.AUDIO.activePlaylistLoader&&(i=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),r=this.syncController_.getExpiredTime(i,this.duration()),r===null||(e=ta.Playlist.seekable(i,r,ta.Playlist.liveEdgeDelay(l,i)),e.length===0)))return;let f,y;this.seekable_&&this.seekable_.length&&(f=this.seekable_.end(0),y=this.seekable_.start(0)),e?e.start(0)>d.end(0)||d.start(0)>e.end(0)?this.seekable_=d:this.seekable_=Ht([[e.start(0)>d.start(0)?e.start(0):d.start(0),e.end(0)<d.end(0)?e.end(0):d.end(0)]]):this.seekable_=d,!(this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===f&&this.seekable_.start(0)===y)&&(this.logger_(`seekable updated [${Bt(this.seekable_)}]`),this.tech_.trigger("seekablechanged"))}updateDuration(e){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),this.mediaSource.readyState!=="open"){this.updateDuration_=this.updateDuration.bind(this,e),this.mediaSource.addEventListener("sourceopen",this.updateDuration_);return}if(e){const l=this.seekable();if(!l.length)return;(isNaN(this.mediaSource.duration)||this.mediaSource.duration<l.end(l.length-1))&&this.sourceUpdater_.setDuration(l.end(l.length-1));return}const i=this.tech_.buffered();let r=ta.Playlist.duration(this.mainPlaylistLoader_.media());i.length>0&&(r=Math.max(r,i.end(i.length-1))),this.mediaSource.duration!==r&&this.sourceUpdater_.setDuration(r)}dispose(){this.trigger("dispose"),this.decrypter_.terminate(),this.mainPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),this.contentSteeringController_.dispose(),this.keyStatusMap_.clear(),this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_),["AUDIO","SUBTITLES"].forEach(e=>{const i=this.mediaTypes_[e].groups;for(const r in i)i[r].forEach(l=>{l.playlistLoader&&l.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.stopABRTimer_(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()}main(){return this.mainPlaylistLoader_.main}media(){return this.mainPlaylistLoader_.media()||this.initialMedia_}areMediaTypesKnown_(){const e=!!this.mediaTypes_.AUDIO.activePlaylistLoader,i=!!this.mainSegmentLoader_.getCurrentMediaInfo_(),r=e?!!this.audioSegmentLoader_.getCurrentMediaInfo_():!0;return!(!i||!r)}getCodecsOrExclude_(){const e={main:this.mainSegmentLoader_.getCurrentMediaInfo_()||{},audio:this.audioSegmentLoader_.getCurrentMediaInfo_()||{}},i=this.mainSegmentLoader_.getPendingSegmentPlaylist()||this.media();e.video=e.main;const r=Uu(this.main(),i),l={},d=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(e.main.hasVideo&&(l.video=r.video||e.main.videoCodec||Ti),e.main.isMuxed&&(l.video+=`,${r.audio||e.main.audioCodec||ei}`),(e.main.hasAudio&&!e.main.isMuxed||e.audio.hasAudio||d)&&(l.audio=r.audio||e.main.audioCodec||e.audio.audioCodec||ei,e.audio.isFmp4=e.main.hasAudio&&!e.main.isMuxed?e.main.isFmp4:e.audio.isFmp4),!l.audio&&!l.video){this.excludePlaylist({playlistToExclude:i,error:{message:"Could not determine codecs for playlist."},playlistExclusionDuration:Infinity});return}const f=(B,W)=>B?Gt(W):li(W),y={};let L;if(["video","audio"].forEach(function(B){if(l.hasOwnProperty(B)&&!f(e[B].isFmp4,l[B])){const W=e[B].isFmp4?"browser":"muxer";y[W]=y[W]||[],y[W].push(l[B]),B==="audio"&&(L=W)}}),d&&L&&i.attributes.AUDIO){const B=i.attributes.AUDIO;this.main().playlists.forEach(W=>{(W.attributes&&W.attributes.AUDIO)===B&&W!==i&&(W.excludeUntil=Infinity)}),this.logger_(`excluding audio group ${B} as ${L} does not support codec(s): "${l.audio}"`)}if(Object.keys(y).length){const B=Object.keys(y).reduce((W,ce)=>(W&&(W+=", "),W+=`${ce} does not support codec(s): "${y[ce].join(",")}"`,W),"")+".";this.excludePlaylist({playlistToExclude:i,error:{internal:!0,message:B},playlistExclusionDuration:Infinity});return}if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){const B=[];if(["video","audio"].forEach(W=>{const ce=(kt(this.sourceUpdater_.codecs[W]||"")[0]||{}).type,ke=(kt(l[W]||"")[0]||{}).type;ce&&ke&&ce.toLowerCase()!==ke.toLowerCase()&&B.push(`"${this.sourceUpdater_.codecs[W]}" -> "${l[W]}"`)}),B.length){this.excludePlaylist({playlistToExclude:i,error:{message:`Codec switching not supported: ${B.join(", ")}.`,internal:!0},playlistExclusionDuration:Infinity});return}}return l}tryToCreateSourceBuffers_(){if(this.mediaSource.readyState!=="open"||this.sourceUpdater_.hasCreatedSourceBuffers()||!this.areMediaTypesKnown_())return;const e=this.getCodecsOrExclude_();if(!e)return;this.sourceUpdater_.createSourceBuffers(e);const i=[e.video,e.audio].filter(Boolean).join(",");this.excludeIncompatibleVariants_(i)}excludeUnsupportedVariants_(){const e=this.main().playlists,i=[];Object.keys(e).forEach(r=>{const l=e[r];if(i.indexOf(l.id)!==-1)return;i.push(l.id);const d=Uu(this.main,l),f=[];d.audio&&!li(d.audio)&&!Gt(d.audio)&&f.push(`audio codec ${d.audio}`),d.video&&!li(d.video)&&!Gt(d.video)&&f.push(`video codec ${d.video}`),d.text&&d.text==="stpp.ttml.im1t"&&f.push(`text codec ${d.text}`),f.length&&(l.excludeUntil=Infinity,this.logger_(`excluding ${l.id} for unsupported: ${f.join(", ")}`))})}excludeIncompatibleVariants_(e){const i=[],r=this.main().playlists,l=Yd(kt(e)),d=Lf(l),f=l.video&&kt(l.video)[0]||null,y=l.audio&&kt(l.audio)[0]||null;Object.keys(r).forEach(L=>{const B=r[L];if(i.indexOf(B.id)!==-1||B.excludeUntil===Infinity)return;i.push(B.id);const W=[],ce=Uu(this.mainPlaylistLoader_.main,B),ke=Lf(ce);if(!(!ce.audio&&!ce.video)){if(ke!==d&&W.push(`codec count "${ke}" !== "${d}"`),!this.sourceUpdater_.canChangeType()){const Pe=ce.video&&kt(ce.video)[0]||null,be=ce.audio&&kt(ce.audio)[0]||null;Pe&&f&&Pe.type.toLowerCase()!==f.type.toLowerCase()&&W.push(`video codec "${Pe.type}" !== "${f.type}"`),be&&y&&be.type.toLowerCase()!==y.type.toLowerCase()&&W.push(`audio codec "${be.type}" !== "${y.type}"`)}W.length&&(B.excludeUntil=Infinity,this.logger_(`excluding ${B.id}: ${W.join(" && ")}`))}})}updateAdCues_(e){let i=0;const r=this.seekable();r.length&&(i=r.start(0)),Um(e,this.cueTagsTrack_,i)}goalBufferLength(){const e=this.tech_.currentTime(),i=wn.GOAL_BUFFER_LENGTH,r=wn.GOAL_BUFFER_LENGTH_RATE,l=Math.max(i,wn.MAX_GOAL_BUFFER_LENGTH);return Math.min(i+e*r,l)}bufferLowWaterLine(){const e=this.tech_.currentTime(),i=wn.BUFFER_LOW_WATER_LINE,r=wn.BUFFER_LOW_WATER_LINE_RATE,l=Math.max(i,wn.MAX_BUFFER_LOW_WATER_LINE),d=Math.max(i,wn.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(i+e*r,this.bufferBasedABR?d:l)}bufferHighWaterLine(){return wn.BUFFER_HIGH_WATER_LINE}addDateRangesToTextTrack_(e){Rf(this.inbandTextTracks_,"com.apple.streaming",this.tech_),bm({inbandTextTracks:this.inbandTextTracks_,dateRanges:e})}addMetadataToTextTrack(e,i,r){const l=this.sourceUpdater_.videoBuffer?this.sourceUpdater_.videoTimestampOffset():this.sourceUpdater_.audioTimestampOffset();Rf(this.inbandTextTracks_,e,this.tech_),ym({inbandTextTracks:this.inbandTextTracks_,metadataArray:i,timestampOffset:l,videoDuration:r})}pathwayAttribute_(e){return e.attributes["PATHWAY-ID"]||e.attributes.serviceLocation}initContentSteeringController_(){const e=this.main();if(!!e.contentSteering){for(const i of e.playlists)this.contentSteeringController_.addAvailablePathway(this.pathwayAttribute_(i));if(this.contentSteeringController_.assignTagProperties(e.uri,e.contentSteering),this.contentSteeringController_.queryBeforeStart){this.contentSteeringController_.requestSteeringManifest(!0);return}this.tech_.one("canplay",()=>{this.contentSteeringController_.requestSteeringManifest()})}}resetContentSteeringController_(){this.contentSteeringController_.clearAvailablePathways(),this.contentSteeringController_.dispose(),this.initContentSteeringController_()}attachContentSteeringListeners_(){this.contentSteeringController_.on("content-steering",this.excludeThenChangePathway_.bind(this)),this.sourceType_==="dash"&&this.mainPlaylistLoader_.on("loadedplaylist",()=>{const e=this.main();(this.contentSteeringController_.didDASHTagChange(e.uri,e.contentSteering)||(()=>{const l=this.contentSteeringController_.getAvailablePathways(),d=[];for(const f of e.playlists){const y=f.attributes.serviceLocation;if(y&&(d.push(y),!l.has(y)))return!0}return!!(!d.length&&l.size)})())&&this.resetContentSteeringController_()})}excludeThenChangePathway_(){const e=this.contentSteeringController_.getPathway();if(!e)return;this.handlePathwayClones_();const r=this.main().playlists,l=new Set;let d=!1;Object.keys(r).forEach(f=>{const y=r[f],L=this.pathwayAttribute_(y),B=L&&e!==L;y.excludeUntil===Infinity&&y.lastExcludeReason_==="content-steering"&&!B&&(delete y.excludeUntil,delete y.lastExcludeReason_,d=!0);const ce=!y.excludeUntil&&y.excludeUntil!==Infinity;!(!l.has(y.id)&&B&&ce)||(l.add(y.id),y.excludeUntil=Infinity,y.lastExcludeReason_="content-steering",this.logger_(`excluding ${y.id} for ${y.lastExcludeReason_}`))}),this.contentSteeringController_.manifestType_==="DASH"&&Object.keys(this.mediaTypes_).forEach(f=>{const y=this.mediaTypes_[f];if(y.activePlaylistLoader){const L=y.activePlaylistLoader.media_;L&&L.attributes.serviceLocation!==e&&(d=!0)}}),d&&this.changeSegmentPathway_()}handlePathwayClones_(){const i=this.main().playlists,r=this.contentSteeringController_.currentPathwayClones,l=this.contentSteeringController_.nextPathwayClones;if(!!(r&&r.size||l&&l.size)){for(const[f,y]of r.entries())l.get(f)||(this.mainPlaylistLoader_.updateOrDeleteClone(y),this.contentSteeringController_.excludePathway(f));for(const[f,y]of l.entries()){const L=r.get(f);if(!L){i.filter(W=>W.attributes["PATHWAY-ID"]===y["BASE-ID"]).forEach(W=>{this.mainPlaylistLoader_.addClonePathway(y,W)}),this.contentSteeringController_.addAvailablePathway(f);continue}this.equalPathwayClones_(L,y)||(this.mainPlaylistLoader_.updateOrDeleteClone(y,!0),this.contentSteeringController_.addAvailablePathway(f))}this.contentSteeringController_.currentPathwayClones=new Map(JSON.parse(JSON.stringify([...l])))}}equalPathwayClones_(e,i){if(e["BASE-ID"]!==i["BASE-ID"]||e.ID!==i.ID||e["URI-REPLACEMENT"].HOST!==i["URI-REPLACEMENT"].HOST)return!1;const r=e["URI-REPLACEMENT"].PARAMS,l=i["URI-REPLACEMENT"].PARAMS;for(const d in r)if(r[d]!==l[d])return!1;for(const d in l)if(r[d]!==l[d])return!1;return!0}changeSegmentPathway_(){const e=this.selectPlaylist();this.pauseLoading(),this.contentSteeringController_.manifestType_==="DASH"&&this.switchMediaForDASHContentSteering_(),this.switchMedia_(e,"content-steering")}excludeNonUsablePlaylistsByKeyId_(){if(!this.mainPlaylistLoader_||!this.mainPlaylistLoader_.main)return;let e=0;const i="non-usable";this.mainPlaylistLoader_.main.playlists.forEach(r=>{const l=this.mainPlaylistLoader_.getKeyIdSet(r);!l||!l.size||l.forEach(d=>{const f="usable",y=this.keyStatusMap_.has(d)&&this.keyStatusMap_.get(d)===f,L=r.lastExcludeReason_===i&&r.excludeUntil===Infinity;y?y&&L&&(delete r.excludeUntil,delete r.lastExcludeReason_,this.logger_(`enabling playlist ${r.id} because key ID ${d} is ${f}`)):(r.excludeUntil!==Infinity&&r.lastExcludeReason_!==i&&(r.excludeUntil=Infinity,r.lastExcludeReason_=i,this.logger_(`excluding playlist ${r.id} because the key ID ${d} doesn't exist in the keyStatusMap or is not ${f}`)),e++)})}),e>=this.mainPlaylistLoader_.main.playlists.length&&this.mainPlaylistLoader_.main.playlists.forEach(r=>{const l=r&&r.attributes&&r.attributes.RESOLUTION&&r.attributes.RESOLUTION.height<720,d=r.excludeUntil===Infinity&&r.lastExcludeReason_===i;l&&d&&(delete r.excludeUntil,de.log.warn(`enabling non-HD playlist ${r.id} because all playlists were excluded due to ${i} key IDs`))})}addKeyStatus_(e,i){const d=(typeof e=="string"?e:Bm(e)).slice(0,32).toLowerCase();this.logger_(`KeyStatus '${i}' with key ID ${d} added to the keyStatusMap`),this.keyStatusMap_.set(d,i)}updatePlaylistByKeyStatus(e,i){this.addKeyStatus_(e,i),this.waitingForFastQualityPlaylistReceived_||this.excludeNonUsableThenChangePlaylist_(),this.mainPlaylistLoader_.off("loadedplaylist",this.excludeNonUsableThenChangePlaylist_.bind(this)),this.mainPlaylistLoader_.on("loadedplaylist",this.excludeNonUsableThenChangePlaylist_.bind(this))}excludeNonUsableThenChangePlaylist_(){this.excludeNonUsablePlaylistsByKeyId_(),this.fastQualityChange_()}}const og=(s,e,i)=>r=>{const l=s.main.playlists[e],d=ih(l),f=Wd(l);return typeof r=="undefined"?f:(r?delete l.disabled:l.disabled=!0,r!==f&&!d&&(i(),r?s.trigger("renditionenabled"):s.trigger("renditiondisabled")),r)};class lg{constructor(e,i,r){const{playlistController_:l}=e,d=l.fastQualityChange_.bind(l);if(i.attributes){const f=i.attributes.RESOLUTION;this.width=f&&f.width,this.height=f&&f.height,this.bandwidth=i.attributes.BANDWIDTH,this.frameRate=i.attributes["FRAME-RATE"]}this.codecs=Uu(l.main(),i),this.playlist=i,this.id=r,this.enabled=og(e.playlists,i.id,d)}}const ug=function(s){s.representations=()=>{const e=s.playlistController_.main(),i=Fu(e)?s.playlistController_.getAudioTrackPlaylists_():e.playlists;return i?i.filter(r=>!ih(r)).map((r,l)=>new lg(s,r,r.id)):[]}},zf=["seeking","seeked","pause","playing","error"];class dg{constructor(e){this.playlistController_=e.playlistController,this.tech_=e.tech,this.seekable=e.seekable,this.allowSeeksWithinUnsafeLiveWindow=e.allowSeeksWithinUnsafeLiveWindow,this.liveRangeSafeTimeDelta=e.liveRangeSafeTimeDelta,this.media=e.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.checkCurrentTimeTimeout_=null,this.logger_=et("PlaybackWatcher"),this.logger_("initialize");const i=()=>this.monitorCurrentTime_(),r=()=>this.monitorCurrentTime_(),l=()=>this.techWaiting_(),d=()=>this.resetTimeUpdate_(),f=this.playlistController_,y=["main","subtitle","audio"],L={};y.forEach(W=>{L[W]={reset:()=>this.resetSegmentDownloads_(W),updateend:()=>this.checkSegmentDownloads_(W)},f[`${W}SegmentLoader_`].on("appendsdone",L[W].updateend),f[`${W}SegmentLoader_`].on("playlistupdate",L[W].reset),this.tech_.on(["seeked","seeking"],L[W].reset)});const B=W=>{["main","audio"].forEach(ce=>{f[`${ce}SegmentLoader_`][W]("appended",this.seekingAppendCheck_)})};this.seekingAppendCheck_=()=>{this.fixesBadSeeks_()&&(this.consecutiveUpdates=0,this.lastRecordedTime=this.tech_.currentTime(),B("off"))},this.clearSeekingAppendCheck_=()=>B("off"),this.watchForBadSeeking_=()=>{this.clearSeekingAppendCheck_(),B("on")},this.tech_.on("seeked",this.clearSeekingAppendCheck_),this.tech_.on("seeking",this.watchForBadSeeking_),this.tech_.on("waiting",l),this.tech_.on(zf,d),this.tech_.on("canplay",r),this.tech_.one("play",i),this.dispose=()=>{this.clearSeekingAppendCheck_(),this.logger_("dispose"),this.tech_.off("waiting",l),this.tech_.off(zf,d),this.tech_.off("canplay",r),this.tech_.off("play",i),this.tech_.off("seeking",this.watchForBadSeeking_),this.tech_.off("seeked",this.clearSeekingAppendCheck_),y.forEach(W=>{f[`${W}SegmentLoader_`].off("appendsdone",L[W].updateend),f[`${W}SegmentLoader_`].off("playlistupdate",L[W].reset),this.tech_.off(["seeked","seeking"],L[W].reset)}),this.checkCurrentTimeTimeout_&&le().clearTimeout(this.checkCurrentTimeTimeout_),this.resetTimeUpdate_()}}monitorCurrentTime_(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&le().clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=le().setTimeout(this.monitorCurrentTime_.bind(this),250)}resetSegmentDownloads_(e){const i=this.playlistController_[`${e}SegmentLoader_`];this[`${e}StalledDownloads_`]>0&&this.logger_(`resetting possible stalled download count for ${e} loader`),this[`${e}StalledDownloads_`]=0,this[`${e}Buffered_`]=i.buffered_()}checkSegmentDownloads_(e){const i=this.playlistController_,r=i[`${e}SegmentLoader_`],l=r.buffered_(),d=Di(this[`${e}Buffered_`],l);if(this[`${e}Buffered_`]=l,d){this.resetSegmentDownloads_(e);return}this[`${e}StalledDownloads_`]++,this.logger_(`found #${this[`${e}StalledDownloads_`]} ${e} appends that did not increase buffer (possible stalled download)`,{playlistId:r.playlist_&&r.playlist_.id,buffered:ti(l)}),!(this[`${e}StalledDownloads_`]<10)&&(this.logger_(`${e} loader stalled download exclusion`),this.resetSegmentDownloads_(e),this.tech_.trigger({type:"usage",name:`vhs-${e}-download-exclusion`}),e!=="subtitle"&&i.excludePlaylist({error:{message:`Excessive ${e} segment downloading detected.`},playlistExclusionDuration:Infinity}))}checkCurrentTime_(){if(this.tech_.paused()||this.tech_.seeking())return;const e=this.tech_.currentTime(),i=this.tech_.buffered();if(this.lastRecordedTime===e&&(!i.length||e+zt>=i.end(i.length-1)))return this.techWaiting_();this.consecutiveUpdates>=5&&e===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):e===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=e)}resetTimeUpdate_(){this.consecutiveUpdates=0}fixesBadSeeks_(){if(!this.tech_.seeking())return!1;const i=this.seekable(),r=this.tech_.currentTime(),l=this.afterSeekableWindow_(i,r,this.media(),this.allowSeeksWithinUnsafeLiveWindow);let d;if(l&&(d=i.end(i.length-1)),this.beforeSeekableWindow_(i,r)){const be=i.start(0);d=be+(be===i.end(0)?0:zt)}if(typeof d!="undefined")return this.logger_(`Trying to seek outside of seekable at time ${r} with seekable range ${Bt(i)}. Seeking to ${d}.`),this.tech_.setCurrentTime(d),!0;const f=this.playlistController_.sourceUpdater_,y=this.tech_.buffered(),L=f.audioBuffer?f.audioBuffered():null,B=f.videoBuffer?f.videoBuffered():null,W=this.media(),ce=W.partTargetDuration?W.partTargetDuration:(W.targetDuration-St)*2,ke=[L,B];for(let be=0;be<ke.length;be++){if(!ke[be])continue;if(sn(ke[be],r)<ce)return!1}const Pe=hi(y,r);return Pe.length===0?!1:(d=Pe.start(0)+zt,this.logger_(`Buffered region starts (${Pe.start(0)})  just beyond seek point (${r}). Seeking to ${d}.`),this.tech_.setCurrentTime(d),!0)}waiting_(){if(this.techWaiting_())return;const e=this.tech_.currentTime(),i=this.tech_.buffered(),r=qt(i,e);if(r.length&&e+3<=r.end(0)){this.resetTimeUpdate_(),this.tech_.setCurrentTime(e),this.logger_(`Stopped at ${e} while inside a buffered region [${r.start(0)} -> ${r.end(0)}]. Attempting to resume playback by seeking to the current time.`),this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"});return}}techWaiting_(){const e=this.seekable(),i=this.tech_.currentTime();if(this.tech_.seeking())return!0;if(this.beforeSeekableWindow_(e,i)){const y=e.end(e.length-1);return this.logger_(`Fell out of live window at time ${i}. Seeking to live point (seekable end) ${y}`),this.resetTimeUpdate_(),this.tech_.setCurrentTime(y),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),!0}const r=this.tech_.vhs.playlistController_.sourceUpdater_,l=this.tech_.buffered();if(this.videoUnderflow_({audioBuffered:r.audioBuffered(),videoBuffered:r.videoBuffered(),currentTime:i}))return this.resetTimeUpdate_(),this.tech_.setCurrentTime(i),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),!0;const f=hi(l,i);return f.length>0?(this.logger_(`Stopped at ${i} and seeking to ${f.start(0)}`),this.resetTimeUpdate_(),this.skipTheGap_(i),!0):!1}afterSeekableWindow_(e,i,r,l=!1){if(!e.length)return!1;let d=e.end(e.length-1)+zt;const f=!r.endList,y=typeof r.partTargetDuration=="number";return f&&(y||l)&&(d=e.end(e.length-1)+r.targetDuration*3),i>d}beforeSeekableWindow_(e,i){return!!(e.length&&e.start(0)>0&&i<e.start(0)-this.liveRangeSafeTimeDelta)}videoUnderflow_({videoBuffered:e,audioBuffered:i,currentTime:r}){if(!e)return;let l;if(e.length&&i.length){const d=qt(e,r-3),f=qt(e,r),y=qt(i,r);y.length&&!f.length&&d.length&&(l={start:d.end(0),end:y.end(0)})}else hi(e,r).length||(l=this.gapFromVideoUnderflow_(e,r));return l?(this.logger_(`Encountered a gap in video from ${l.start} to ${l.end}. Seeking to current time ${r}`),!0):!1}skipTheGap_(e){const i=this.tech_.buffered(),r=this.tech_.currentTime(),l=hi(i,r);this.resetTimeUpdate_(),!(l.length===0||r!==e)&&(this.logger_("skipTheGap_:","currentTime:",r,"scheduled currentTime:",e,"nextRange start:",l.start(0)),this.tech_.setCurrentTime(l.start(0)+St),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"}))}gapFromVideoUnderflow_(e,i){const r=Bi(e);for(let l=0;l<r.length;l++){const d=r.start(l),f=r.end(l);if(i-d<4&&i-d>2)return{start:d,end:f}}return null}}const cg={errorInterval:30,getSource(s){const i=this.tech({IWillNotUseThisInPlugins:!0}).currentSource_||this.currentSource();return s(i)}},Yf=function(s,e){let i=0,r=0;const l=st(cg,e);s.ready(()=>{s.trigger({type:"usage",name:"vhs-error-reload-initialized"})});const d=function(){r&&s.currentTime(r)},f=function(W){W!=null&&(r=s.duration()!==Infinity&&s.currentTime()||0,s.one("loadedmetadata",d),s.src(W),s.trigger({type:"usage",name:"vhs-error-reload"}),s.play())},y=function(){if(Date.now()-i<l.errorInterval*1e3){s.trigger({type:"usage",name:"vhs-error-reload-canceled"});return}if(!l.getSource||typeof l.getSource!="function"){de.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!");return}return i=Date.now(),l.getSource.call(s,f)},L=function(){s.off("loadedmetadata",d),s.off("error",y),s.off("dispose",L)},B=function(W){L(),Yf(s,W)};s.on("error",y),s.on("dispose",L),s.reloadSourceOnError=B},hg=function(s){Yf(this,s)};var Xf="3.10.0",fg="7.0.2",pg="1.3.0",mg="7.1.0",gg="4.0.1";const nn={PlaylistLoader:_l,Playlist:or,utils:S0,STANDARD_PLAYLIST_SELECTOR:If,INITIAL_PLAYLIST_SELECTOR:hm,lastBandwidthSelector:If,movingAverageBandwidthSelector:dm,comparePlaylistBandwidth:ph,comparePlaylistResolution:um,xhr:af()};Object.keys(wn).forEach(s=>{Object.defineProperty(nn,s,{get(){return de.log.warn(`using Vhs.${s} is UNSAFE be sure you know what you are doing`),wn[s]},set(e){if(de.log.warn(`using Vhs.${s} is UNSAFE be sure you know what you are doing`),typeof e!="number"||e<0){de.log.warn(`value of Vhs.${s} must be greater than or equal to 0`);return}wn[s]=e}})});const Qf="videojs-vhs",Jf=function(s,e){const i=e.media();let r=-1;for(let l=0;l<s.length;l++)if(s[l].id===i.id){r=l;break}s.selectedIndex_=r,s.trigger({selectedIndex:r,type:"change"})},yg=function(s,e){e.representations().forEach(i=>{s.addQualityLevel(i)}),Jf(s,e.playlists)};nn.canPlaySource=function(){return de.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")};const vg=(s,e,i)=>{if(!s)return s;let r={};e&&e.attributes&&e.attributes.CODECS&&(r=Yd(kt(e.attributes.CODECS))),i&&i.attributes&&i.attributes.CODECS&&(r.audio=i.attributes.CODECS);const l=_t(r.video),d=_t(r.audio),f={};for(const y in s)f[y]={},d&&(f[y].audioContentType=d),l&&(f[y].videoContentType=l),e.contentProtection&&e.contentProtection[y]&&e.contentProtection[y].pssh&&(f[y].pssh=e.contentProtection[y].pssh),typeof s[y]=="string"&&(f[y].url=s[y]);return st(s,f)},Ag=(s,e)=>s.reduce((i,r)=>{if(!r.contentProtection)return i;const l=e.reduce((d,f)=>{const y=r.contentProtection[f];return y&&y.pssh&&(d[f]={pssh:y.pssh}),d},{});return Object.keys(l).length&&i.push(l),i},[]),bg=({player:s,sourceKeySystems:e,audioMedia:i,mainPlaylists:r})=>{if(!s.eme.initializeMediaKeys)return Promise.resolve();const l=i?r.concat([i]):r,d=Ag(l,Object.keys(e)),f=[],y=[];return d.forEach(L=>{y.push(new Promise((B,W)=>{s.tech_.one("keysessioncreated",B)})),f.push(new Promise((B,W)=>{s.eme.initializeMediaKeys({keySystems:L},ce=>{if(ce){W(ce);return}B()})}))}),Promise.race([Promise.all(f),Promise.race(y)])},_g=({player:s,sourceKeySystems:e,media:i,audioMedia:r})=>{const l=vg(e,i,r);return l?(s.currentSource().keySystems=l,l&&!s.eme?(de.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),!1):!0):!1},Zf=()=>{if(!le().localStorage)return null;const s=le().localStorage.getItem(Qf);if(!s)return null;try{return JSON.parse(s)}catch(e){return null}},xg=s=>{if(!le().localStorage)return!1;let e=Zf();e=e?st(e,s):s;try{le().localStorage.setItem(Qf,JSON.stringify(e))}catch(i){return!1}return e},Eg=s=>s.toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")===0?JSON.parse(s.substring(s.indexOf(",")+1)):s,ep=(s,e)=>{s._requestCallbackSet||(s._requestCallbackSet=new Set),s._requestCallbackSet.add(e)},tp=(s,e)=>{s._responseCallbackSet||(s._responseCallbackSet=new Set),s._responseCallbackSet.add(e)},ip=(s,e)=>{!s._requestCallbackSet||(s._requestCallbackSet.delete(e),s._requestCallbackSet.size||delete s._requestCallbackSet)},np=(s,e)=>{!s._responseCallbackSet||(s._responseCallbackSet.delete(e),s._responseCallbackSet.size||delete s._responseCallbackSet)};nn.supportsNativeHls=function(){if(!Ee()||!Ee().createElement)return!1;const s=Ee().createElement("video");return de.getTech("Html5").isSupported()?["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(i){return/maybe|probably/i.test(s.canPlayType(i))}):!1}(),nn.supportsNativeDash=function(){return!Ee()||!Ee().createElement||!de.getTech("Html5").isSupported()?!1:/maybe|probably/i.test(Ee().createElement("video").canPlayType("application/dash+xml"))}(),nn.supportsTypeNatively=s=>s==="hls"?nn.supportsNativeHls:s==="dash"?nn.supportsNativeDash:!1,nn.isSupported=function(){return de.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")},nn.xhr.onRequest=function(s){ep(nn.xhr,s)},nn.xhr.onResponse=function(s){tp(nn.xhr,s)},nn.xhr.offRequest=function(s){ip(nn.xhr,s)},nn.xhr.offResponse=function(s){np(nn.xhr,s)};const Tg=de.getComponent("Component");class rp extends Tg{constructor(e,i,r){super(i,r.vhs);if(typeof r.initialBandwidth=="number"&&(this.options_.bandwidth=r.initialBandwidth),this.logger_=et("VhsHandler"),i.options_&&i.options_.playerId){const l=de.getPlayer(i.options_.playerId);this.player_=l}if(this.tech_=i,this.source_=e,this.stats={},this.ignoreNextSeekingEvent_=!1,this.setOptions_(),this.options_.overrideNative&&i.overrideNativeAudioTracks&&i.overrideNativeVideoTracks)i.overrideNativeAudioTracks(!0),i.overrideNativeVideoTracks(!0);else if(this.options_.overrideNative&&(i.featuresNativeVideoTracks||i.featuresNativeAudioTracks))throw new Error("Overriding native VHS requires emulated tracks. See https://git.io/vMpjB");this.on(Ee(),["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],l=>{const d=Ee().fullscreenElement||Ee().webkitFullscreenElement||Ee().mozFullScreenElement||Ee().msFullscreenElement;d&&d.contains(this.tech_.el())?this.playlistController_.fastQualityChange_():this.playlistController_.checkABR_()}),this.on(this.tech_,"seeking",function(){if(this.ignoreNextSeekingEvent_){this.ignoreNextSeekingEvent_=!1;return}this.setCurrentTime(this.tech_.currentTime())}),this.on(this.tech_,"error",function(){this.tech_.error()&&this.playlistController_&&this.playlistController_.pauseLoading()}),this.on(this.tech_,"play",this.play)}setOptions_(e={}){if(this.options_=st(this.options_,e),this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions!==!1,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.useBandwidthFromLocalStorage=typeof this.source_.useBandwidthFromLocalStorage!="undefined"?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.useForcedSubtitles=this.options_.useForcedSubtitles||!1,this.options_.useNetworkInformationApi=this.options_.useNetworkInformationApi||!1,this.options_.useDtsForTimestampOffset=this.options_.useDtsForTimestampOffset||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,this.options_.llhls=this.options_.llhls!==!1,this.options_.bufferBasedABR=this.options_.bufferBasedABR||!1,typeof this.options_.playlistExclusionDuration!="number"&&(this.options_.playlistExclusionDuration=60),typeof this.options_.bandwidth!="number"&&this.options_.useBandwidthFromLocalStorage){const i=Zf();i&&i.bandwidth&&(this.options_.bandwidth=i.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"})),i&&i.throughput&&(this.options_.throughput=i.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"}))}typeof this.options_.bandwidth!="number"&&(this.options_.bandwidth=wn.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===wn.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","limitRenditionByPlayerDimensions","bandwidth","customTagParsers","customTagMappers","cacheEncryptionKeys","playlistSelector","initialPlaylistSelector","bufferBasedABR","liveRangeSafeTimeDelta","llhls","useForcedSubtitles","useNetworkInformationApi","useDtsForTimestampOffset","exactManifestTimings","leastPixelDiffSelector"].forEach(i=>{typeof this.source_[i]!="undefined"&&(this.options_[i]=this.source_[i])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio}setOptions(e={}){this.setOptions_(e)}src(e,i){if(!e)return;this.setOptions_(),this.options_.src=Eg(this.source_.src),this.options_.tech=this.tech_,this.options_.externVhs=nn,this.options_.sourceType=oi(i),this.options_.seekTo=d=>{this.tech_.setCurrentTime(d)},this.playlistController_=new ag(this.options_);const r=st({liveRangeSafeTimeDelta:zt},this.options_,{seekable:()=>this.seekable(),media:()=>this.playlistController_.media(),playlistController:this.playlistController_});this.playbackWatcher_=new dg(r),this.playlistController_.on("error",()=>{const d=de.players[this.tech_.options_.playerId];let f=this.playlistController_.error;typeof f=="object"&&!f.code?f.code=3:typeof f=="string"&&(f={message:f,code:3}),d.error(f)});const l=this.options_.bufferBasedABR?nn.movingAverageBandwidthSelector(.55):nn.STANDARD_PLAYLIST_SELECTOR;this.playlistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):l.bind(this),this.playlistController_.selectInitialPlaylist=nn.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.playlistController_.mainPlaylistLoader_,this.mediaSource=this.playlistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get(){return this.playlistController_.selectPlaylist},set(d){this.playlistController_.selectPlaylist=d.bind(this)}},throughput:{get(){return this.playlistController_.mainSegmentLoader_.throughput.rate},set(d){this.playlistController_.mainSegmentLoader_.throughput.rate=d,this.playlistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get(){let d=this.playlistController_.mainSegmentLoader_.bandwidth;const f=le().navigator.connection||le().navigator.mozConnection||le().navigator.webkitConnection,y=1e7;if(this.options_.useNetworkInformationApi&&f){const L=f.downlink*1e3*1e3;L>=y&&d>=y?d=Math.max(d,L):d=L}return d},set(d){this.playlistController_.mainSegmentLoader_.bandwidth=d,this.playlistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get(){const d=1/(this.bandwidth||1);let f;return this.throughput>0?f=1/this.throughput:f=0,Math.floor(1/(d+f))},set(){de.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:()=>this.bandwidth||0,enumerable:!0},mediaRequests:{get:()=>this.playlistController_.mediaRequests_()||0,enumerable:!0},mediaRequestsAborted:{get:()=>this.playlistController_.mediaRequestsAborted_()||0,enumerable:!0},mediaRequestsTimedout:{get:()=>this.playlistController_.mediaRequestsTimedout_()||0,enumerable:!0},mediaRequestsErrored:{get:()=>this.playlistController_.mediaRequestsErrored_()||0,enumerable:!0},mediaTransferDuration:{get:()=>this.playlistController_.mediaTransferDuration_()||0,enumerable:!0},mediaBytesTransferred:{get:()=>this.playlistController_.mediaBytesTransferred_()||0,enumerable:!0},mediaSecondsLoaded:{get:()=>this.playlistController_.mediaSecondsLoaded_()||0,enumerable:!0},mediaAppends:{get:()=>this.playlistController_.mediaAppends_()||0,enumerable:!0},mainAppendsToLoadedData:{get:()=>this.playlistController_.mainAppendsToLoadedData_()||0,enumerable:!0},audioAppendsToLoadedData:{get:()=>this.playlistController_.audioAppendsToLoadedData_()||0,enumerable:!0},appendsToLoadedData:{get:()=>this.playlistController_.appendsToLoadedData_()||0,enumerable:!0},timeToLoadedData:{get:()=>this.playlistController_.timeToLoadedData_()||0,enumerable:!0},buffered:{get:()=>ti(this.tech_.buffered()),enumerable:!0},currentTime:{get:()=>this.tech_.currentTime(),enumerable:!0},currentSource:{get:()=>this.tech_.currentSource_,enumerable:!0},currentTech:{get:()=>this.tech_.name_,enumerable:!0},duration:{get:()=>this.tech_.duration(),enumerable:!0},main:{get:()=>this.playlists.main,enumerable:!0},playerDimensions:{get:()=>this.tech_.currentDimensions(),enumerable:!0},seekable:{get:()=>ti(this.tech_.seekable()),enumerable:!0},timestamp:{get:()=>Date.now(),enumerable:!0},videoPlaybackQuality:{get:()=>this.tech_.getVideoPlaybackQuality(),enumerable:!0}}),this.tech_.one("canplay",this.playlistController_.setupFirstPlay.bind(this.playlistController_)),this.tech_.on("bandwidthupdate",()=>{this.options_.useBandwidthFromLocalStorage&&xg({bandwidth:this.bandwidth,throughput:Math.round(this.throughput)})}),this.playlistController_.on("selectedinitialmedia",()=>{ug(this)}),this.playlistController_.sourceUpdater_.on("createdsourcebuffers",()=>{this.setupEme_()}),this.on(this.playlistController_,"progress",function(){this.tech_.trigger("progress")}),this.on(this.playlistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.setupQualityLevels_(),!!this.tech_.el()&&(this.mediaSourceUrl_=le().URL.createObjectURL(this.playlistController_.mediaSource),this.tech_.src(this.mediaSourceUrl_))}createKeySessions_(){const e=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader;this.logger_("waiting for EME key session creation"),bg({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:e&&e.media(),mainPlaylists:this.playlists.main.playlists}).then(()=>{this.logger_("created EME key session"),this.playlistController_.sourceUpdater_.initializedEme()}).catch(i=>{this.logger_("error while creating EME key session",i),this.player_.error({message:"Failed to initialize media keys for EME",code:3})})}handleWaitingForKey_(){this.logger_("waitingforkey fired, attempting to create any new key sessions"),this.createKeySessions_()}setupEme_(){const e=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader,i=_g({player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:e&&e.media()});if(this.player_.tech_.on("keystatuschange",r=>{this.playlistController_.updatePlaylistByKeyStatus(r.keyId,r.status)}),this.handleWaitingForKey_=this.handleWaitingForKey_.bind(this),this.player_.tech_.on("waitingforkey",this.handleWaitingForKey_),!i){this.playlistController_.sourceUpdater_.initializedEme();return}this.createKeySessions_()}setupQualityLevels_(){const e=de.players[this.tech_.options_.playerId];!e||!e.qualityLevels||this.qualityLevels_||(this.qualityLevels_=e.qualityLevels(),this.playlistController_.on("selectedinitialmedia",()=>{yg(this.qualityLevels_,this)}),this.playlists.on("mediachange",()=>{Jf(this.qualityLevels_,this.playlists)}))}static version(){return{"@videojs/http-streaming":Xf,"mux.js":fg,"mpd-parser":pg,"m3u8-parser":mg,"aes-decrypter":gg}}version(){return this.constructor.version()}canChangeType(){return $f.canChangeType()}play(){this.playlistController_.play()}setCurrentTime(e){this.playlistController_.setCurrentTime(e)}duration(){return this.playlistController_.duration()}seekable(){return this.playlistController_.seekable()}dispose(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.playlistController_&&this.playlistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.mediaSourceUrl_&&le().URL.revokeObjectURL&&(le().URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),this.tech_&&this.tech_.off("waitingforkey",this.handleWaitingForKey_),super.dispose()}convertToProgramTime(e,i){return R0({playlist:this.playlistController_.media(),time:e,callback:i})}seekToProgramTime(e,i,r=!0,l=2){return cf({programTime:e,playlist:this.playlistController_.media(),retryCount:l,pauseAfterSeek:r,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:i})}setupXhrHooks_(){this.xhr.onRequest=e=>{ep(this.xhr,e)},this.xhr.onResponse=e=>{tp(this.xhr,e)},this.xhr.offRequest=e=>{ip(this.xhr,e)},this.xhr.offResponse=e=>{np(this.xhr,e)},this.player_.trigger("xhr-hooks-ready")}}const ec={name:"videojs-http-streaming",VERSION:Xf,canHandleSource(s,e={}){const i=st(de.options,e);return ec.canPlayType(s.type,i)},handleSource(s,e,i={}){const r=st(de.options,i);return e.vhs=new rp(s,e,r),e.vhs.xhr=af(),e.vhs.setupXhrHooks_(),e.vhs.src(s.src,s.type),e.vhs},canPlayType(s,e){const i=oi(s);if(!i)return"";const r=ec.getOverrideNative(e);return!nn.supportsTypeNatively(i)||r?"maybe":""},getOverrideNative(s={}){const{vhs:e={}}=s,i=!(de.browser.IS_ANY_SAFARI||de.browser.IS_IOS),{overrideNative:r=i}=e;return r}};(()=>Gt("avc1.4d400d,mp4a.40.2"))()&&de.getTech("Html5").registerSourceHandler(ec,0),de.VhsHandler=rp,de.VhsSourceHandler=ec,de.Vhs=nn,de.use||de.registerComponent("Vhs",nn),de.options.vhs=de.options.vhs||{},(!de.getPlugin||!de.getPlugin("reloadSourceOnError"))&&de.registerPlugin("reloadSourceOnError",hg)},5956:function(Xt,Nt,pt){"use strict";var ut=pt(43033),le=pt(74020),Ze=pt.n(le);const Ee=ut.Z.getTech("Html5"),nt=ut.Z.mergeOptions||ut.Z.util.mergeOptions,me={mediaDataSource:{},config:{}};class Le extends Ee{constructor(ie,J){ie=nt(me,ie),super(ie,J)}setSrc(ie){this.flvPlayer&&(this.flvPlayer.detachMediaElement(),this.flvPlayer.destroy());const J=this.options_.mediaDataSource,D=this.options_.config;J.type=J.type===void 0?"flv":J.type,J.url=ie,this.flvPlayer=Ze().createPlayer(J,D),this.flvPlayer.attachMediaElement(this.el_),this.flvPlayer.load()}dispose(){this.flvPlayer&&(this.flvPlayer.detachMediaElement(),this.flvPlayer.destroy()),super.dispose()}}Le.isSupported=function(){return Ze()&&Ze().isSupported()},Le.formats={"video/flv":"FLV","video/x-flv":"FLV"},Le.canPlayType=function(re){return Le.isSupported()&&re in Le.formats?"maybe":""},Le.canPlaySource=function(re,ie){return Le.canPlayType(re.type)},Le.VERSION="__VERSION__",ut.Z.registerTech("Flvjs",Le);var ve=null},13407:function(Xt,Nt,pt){var ut=pt(58908),le=Xt.exports={WebVTT:pt(63706),VTTCue:pt(22230),VTTRegion:pt(13710)};ut.vttjs=le,ut.WebVTT=le.WebVTT;var Ze=le.VTTCue,Ee=le.VTTRegion,nt=ut.VTTCue,me=ut.VTTRegion;le.shim=function(){ut.VTTCue=Ze,ut.VTTRegion=Ee},le.restore=function(){ut.VTTCue=nt,ut.VTTRegion=me},ut.VTTCue||le.shim()},63706:function(Xt,Nt,pt){var ut=pt(89144),le=Object.create||function(){function U(){}return function(Y){if(arguments.length!==1)throw new Error("Object.create shim only accepts one parameter.");return U.prototype=Y,new U}}();function Ze(U,Y){this.name="ParsingError",this.code=U.code,this.message=Y||U.message}Ze.prototype=le(Error.prototype),Ze.prototype.constructor=Ze,Ze.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};function Ee(U){function Y(fe,Ae,Re,Ce){return(fe|0)*3600+(Ae|0)*60+(Re|0)+(Ce|0)/1e3}var ae=U.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return ae?ae[3]?Y(ae[1],ae[2],ae[3].replace(":",""),ae[4]):ae[1]>59?Y(ae[1],ae[2],0,ae[4]):Y(0,ae[1],ae[2],ae[4]):null}function nt(){this.values=le(null)}nt.prototype={set:function(U,Y){!this.get(U)&&Y!==""&&(this.values[U]=Y)},get:function(U,Y,ae){return ae?this.has(U)?this.values[U]:Y[ae]:this.has(U)?this.values[U]:Y},has:function(U){return U in this.values},alt:function(U,Y,ae){for(var fe=0;fe<ae.length;++fe)if(Y===ae[fe]){this.set(U,Y);break}},integer:function(U,Y){/^-?\d+$/.test(Y)&&this.set(U,parseInt(Y,10))},percent:function(U,Y){var ae;return(ae=Y.match(/^([\d]{1,3})(\.[\d]*)?%$/))&&(Y=parseFloat(Y),Y>=0&&Y<=100)?(this.set(U,Y),!0):!1}};function me(U,Y,ae,fe){var Ae=fe?U.split(fe):[U];for(var Re in Ae)if(typeof Ae[Re]=="string"){var Ce=Ae[Re].split(ae);if(Ce.length===2){var we=Ce[0].trim(),Fe=Ce[1].trim();Y(we,Fe)}}}function Le(U,Y,ae){var fe=U;function Ae(){var we=Ee(U);if(we===null)throw new Ze(Ze.Errors.BadTimeStamp,"Malformed timestamp: "+fe);return U=U.replace(/^[^\sa-zA-Z-]+/,""),we}function Re(we,Fe){var Ie=new nt;me(we,function($e,Oe){switch($e){case"region":for(var ht=ae.length-1;ht>=0;ht--)if(ae[ht].id===Oe){Ie.set($e,ae[ht].region);break}break;case"vertical":Ie.alt($e,Oe,["rl","lr"]);break;case"line":var kt=Oe.split(","),Rt=kt[0];Ie.integer($e,Rt),Ie.percent($e,Rt)&&Ie.set("snapToLines",!1),Ie.alt($e,Rt,["auto"]),kt.length===2&&Ie.alt("lineAlign",kt[1],["start","center","end"]);break;case"position":kt=Oe.split(","),Ie.percent($e,kt[0]),kt.length===2&&Ie.alt("positionAlign",kt[1],["start","center","end"]);break;case"size":Ie.percent($e,Oe);break;case"align":Ie.alt($e,Oe,["start","center","end","left","right"]);break}},/:/,/\s/),Fe.region=Ie.get("region",null),Fe.vertical=Ie.get("vertical","");try{Fe.line=Ie.get("line","auto")}catch($e){}Fe.lineAlign=Ie.get("lineAlign","start"),Fe.snapToLines=Ie.get("snapToLines",!0),Fe.size=Ie.get("size",100);try{Fe.align=Ie.get("align","center")}catch($e){Fe.align=Ie.get("align","middle")}try{Fe.position=Ie.get("position","auto")}catch($e){Fe.position=Ie.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},Fe.align)}Fe.positionAlign=Ie.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},Fe.align)}function Ce(){U=U.replace(/^\s+/,"")}if(Ce(),Y.startTime=Ae(),Ce(),U.substr(0,3)!=="-->")throw new Ze(Ze.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+fe);U=U.substr(3),Ce(),Y.endTime=Ae(),Ce(),Re(U,Y)}var ve=ut.createElement&&ut.createElement("textarea"),re={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},ie={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},J={v:"title",lang:"lang"},D={rt:"ruby"};function v(U,Y){function ae(){if(!Y)return null;function Rt(rt){return Y=Y.substr(rt.length),rt}var mt=Y.match(/^([^<]*)(<[^>]*>?)?/);return Rt(mt[1]?mt[1]:mt[2])}function fe(Rt){return ve.innerHTML=Rt,Rt=ve.textContent,ve.textContent="",Rt}function Ae(Rt,mt){return!D[mt.localName]||D[mt.localName]===Rt.localName}function Re(Rt,mt){var rt=re[Rt];if(!rt)return null;var Kt=U.document.createElement(rt),_t=J[Rt];return _t&&mt&&(Kt[_t]=mt.trim()),Kt}for(var Ce=U.document.createElement("div"),we=Ce,Fe,Ie=[];(Fe=ae())!==null;){if(Fe[0]==="<"){if(Fe[1]==="/"){Ie.length&&Ie[Ie.length-1]===Fe.substr(2).replace(">","")&&(Ie.pop(),we=we.parentNode);continue}var $e=Ee(Fe.substr(1,Fe.length-2)),Oe;if($e){Oe=U.document.createProcessingInstruction("timestamp",$e),we.appendChild(Oe);continue}var ht=Fe.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!ht||(Oe=Re(ht[1],ht[3]),!Oe)||!Ae(we,Oe))continue;if(ht[2]){var kt=ht[2].split(".");kt.forEach(function(Rt){var mt=/^bg_/.test(Rt),rt=mt?Rt.slice(3):Rt;if(ie.hasOwnProperty(rt)){var Kt=mt?"background-color":"color",_t=ie[rt];Oe.style[Kt]=_t}}),Oe.className=kt.join(" ")}Ie.push(ht[1]),we.appendChild(Oe),we=Oe;continue}we.appendChild(U.document.createTextNode(fe(Fe)))}return Ce}var $=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function I(U){for(var Y=0;Y<$.length;Y++){var ae=$[Y];if(U>=ae[0]&&U<=ae[1])return!0}return!1}function H(U){var Y=[],ae="",fe;if(!U||!U.childNodes)return"ltr";function Ae(we,Fe){for(var Ie=Fe.childNodes.length-1;Ie>=0;Ie--)we.push(Fe.childNodes[Ie])}function Re(we){if(!we||!we.length)return null;var Fe=we.pop(),Ie=Fe.textContent||Fe.innerText;if(Ie){var $e=Ie.match(/^.*(\n|\r)/);return $e?(we.length=0,$e[0]):Ie}if(Fe.tagName==="ruby")return Re(we);if(Fe.childNodes)return Ae(we,Fe),Re(we)}for(Ae(Y,U);ae=Re(Y);)for(var Ce=0;Ce<ae.length;Ce++)if(fe=ae.charCodeAt(Ce),I(fe))return"rtl";return"ltr"}function X(U){if(typeof U.line=="number"&&(U.snapToLines||U.line>=0&&U.line<=100))return U.line;if(!U.track||!U.track.textTrackList||!U.track.textTrackList.mediaElement)return-1;for(var Y=U.track,ae=Y.textTrackList,fe=0,Ae=0;Ae<ae.length&&ae[Ae]!==Y;Ae++)ae[Ae].mode==="showing"&&fe++;return++fe*-1}function O(){}O.prototype.applyStyles=function(U,Y){Y=Y||this.div;for(var ae in U)U.hasOwnProperty(ae)&&(Y.style[ae]=U[ae])},O.prototype.formatStyle=function(U,Y){return U===0?0:U+Y};function G(U,Y,ae){O.call(this),this.cue=Y,this.cueDiv=v(U,Y.text);var fe={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:Y.vertical===""?"horizontal-tb":Y.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(fe,this.cueDiv),this.div=U.document.createElement("div"),fe={direction:H(this.cueDiv),writingMode:Y.vertical===""?"horizontal-tb":Y.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:Y.align==="middle"?"center":Y.align,font:ae.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(fe),this.div.appendChild(this.cueDiv);var Ae=0;switch(Y.positionAlign){case"start":case"line-left":Ae=Y.position;break;case"center":Ae=Y.position-Y.size/2;break;case"end":case"line-right":Ae=Y.position-Y.size;break}Y.vertical===""?this.applyStyles({left:this.formatStyle(Ae,"%"),width:this.formatStyle(Y.size,"%")}):this.applyStyles({top:this.formatStyle(Ae,"%"),height:this.formatStyle(Y.size,"%")}),this.move=function(Re){this.applyStyles({top:this.formatStyle(Re.top,"px"),bottom:this.formatStyle(Re.bottom,"px"),left:this.formatStyle(Re.left,"px"),right:this.formatStyle(Re.right,"px"),height:this.formatStyle(Re.height,"px"),width:this.formatStyle(Re.width,"px")})}}G.prototype=le(O.prototype),G.prototype.constructor=G;function j(U){var Y,ae,fe,Ae;if(U.div){ae=U.div.offsetHeight,fe=U.div.offsetWidth,Ae=U.div.offsetTop;var Re=(Re=U.div.childNodes)&&(Re=Re[0])&&Re.getClientRects&&Re.getClientRects();U=U.div.getBoundingClientRect(),Y=Re?Math.max(Re[0]&&Re[0].height||0,U.height/Re.length):0}this.left=U.left,this.right=U.right,this.top=U.top||Ae,this.height=U.height||ae,this.bottom=U.bottom||Ae+(U.height||ae),this.width=U.width||fe,this.lineHeight=Y!==void 0?Y:U.lineHeight}j.prototype.move=function(U,Y){switch(Y=Y!==void 0?Y:this.lineHeight,U){case"+x":this.left+=Y,this.right+=Y;break;case"-x":this.left-=Y,this.right-=Y;break;case"+y":this.top+=Y,this.bottom+=Y;break;case"-y":this.top-=Y,this.bottom-=Y;break}},j.prototype.overlaps=function(U){return this.left<U.right&&this.right>U.left&&this.top<U.bottom&&this.bottom>U.top},j.prototype.overlapsAny=function(U){for(var Y=0;Y<U.length;Y++)if(this.overlaps(U[Y]))return!0;return!1},j.prototype.within=function(U){return this.top>=U.top&&this.bottom<=U.bottom&&this.left>=U.left&&this.right<=U.right},j.prototype.overlapsOppositeAxis=function(U,Y){switch(Y){case"+x":return this.left<U.left;case"-x":return this.right>U.right;case"+y":return this.top<U.top;case"-y":return this.bottom>U.bottom}},j.prototype.intersectPercentage=function(U){var Y=Math.max(0,Math.min(this.right,U.right)-Math.max(this.left,U.left)),ae=Math.max(0,Math.min(this.bottom,U.bottom)-Math.max(this.top,U.top)),fe=Y*ae;return fe/(this.height*this.width)},j.prototype.toCSSCompatValues=function(U){return{top:this.top-U.top,bottom:U.bottom-this.bottom,left:this.left-U.left,right:U.right-this.right,height:this.height,width:this.width}},j.getSimpleBoxPosition=function(U){var Y=U.div?U.div.offsetHeight:U.tagName?U.offsetHeight:0,ae=U.div?U.div.offsetWidth:U.tagName?U.offsetWidth:0,fe=U.div?U.div.offsetTop:U.tagName?U.offsetTop:0;U=U.div?U.div.getBoundingClientRect():U.tagName?U.getBoundingClientRect():U;var Ae={left:U.left,right:U.right,top:U.top||fe,height:U.height||Y,bottom:U.bottom||fe+(U.height||Y),width:U.width||ae};return Ae};function V(U,Y,ae,fe){function Ae(rt,Kt){for(var _t,Gt=new j(rt),li=1,ei=0;ei<Kt.length;ei++){for(;rt.overlapsOppositeAxis(ae,Kt[ei])||rt.within(ae)&&rt.overlapsAny(fe);)rt.move(Kt[ei]);if(rt.within(ae))return rt;var Ti=rt.intersectPercentage(ae);li>Ti&&(_t=new j(rt),li=Ti),rt=new j(Gt)}return _t||Gt}var Re=new j(Y),Ce=Y.cue,we=X(Ce),Fe=[];if(Ce.snapToLines){var Ie;switch(Ce.vertical){case"":Fe=["+y","-y"],Ie="height";break;case"rl":Fe=["+x","-x"],Ie="width";break;case"lr":Fe=["-x","+x"],Ie="width";break}var $e=Re.lineHeight,Oe=$e*Math.round(we),ht=ae[Ie]+$e,kt=Fe[0];Math.abs(Oe)>ht&&(Oe=Oe<0?-1:1,Oe*=Math.ceil(ht/$e)*$e),we<0&&(Oe+=Ce.vertical===""?ae.height:ae.width,Fe=Fe.reverse()),Re.move(kt,Oe)}else{var Rt=Re.lineHeight/ae.height*100;switch(Ce.lineAlign){case"center":we-=Rt/2;break;case"end":we-=Rt;break}switch(Ce.vertical){case"":Y.applyStyles({top:Y.formatStyle(we,"%")});break;case"rl":Y.applyStyles({left:Y.formatStyle(we,"%")});break;case"lr":Y.applyStyles({right:Y.formatStyle(we,"%")});break}Fe=["+y","-x","+x","-y"],Re=new j(Y)}var mt=Ae(Re,Fe);Y.move(mt.toCSSCompatValues(ae))}function S(){}S.StringDecoder=function(){return{decode:function(U){if(!U)return"";if(typeof U!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(U))}}},S.convertCueToDOMTree=function(U,Y){return!U||!Y?null:v(U,Y)};var ee=.05,se="sans-serif",ue="1.5%";S.processCues=function(U,Y,ae){if(!U||!Y||!ae)return null;for(;ae.firstChild;)ae.removeChild(ae.firstChild);var fe=U.document.createElement("div");fe.style.position="absolute",fe.style.left="0",fe.style.right="0",fe.style.top="0",fe.style.bottom="0",fe.style.margin=ue,ae.appendChild(fe);function Ae($e){for(var Oe=0;Oe<$e.length;Oe++)if($e[Oe].hasBeenReset||!$e[Oe].displayState)return!0;return!1}if(!Ae(Y)){for(var Re=0;Re<Y.length;Re++)fe.appendChild(Y[Re].displayState);return}var Ce=[],we=j.getSimpleBoxPosition(fe),Fe=Math.round(we.height*ee*100)/100,Ie={font:Fe+"px "+se};(function(){for(var $e,Oe,ht=0;ht<Y.length;ht++)Oe=Y[ht],$e=new G(U,Oe,Ie),fe.appendChild($e.div),V(U,$e,we,Ce),Oe.displayState=$e.div,Ce.push(j.getSimpleBoxPosition($e))})()},S.Parser=function(U,Y,ae){ae||(ae=Y,Y={}),Y||(Y={}),this.window=U,this.vttjs=Y,this.state="INITIAL",this.buffer="",this.decoder=ae||new TextDecoder("utf8"),this.regionList=[]},S.Parser.prototype={reportOrThrowError:function(U){if(U instanceof Ze)this.onparsingerror&&this.onparsingerror(U);else throw U},parse:function(U){var Y=this;U&&(Y.buffer+=Y.decoder.decode(U,{stream:!0}));function ae(){for(var $e=Y.buffer,Oe=0;Oe<$e.length&&$e[Oe]!=="\r"&&$e[Oe]!==`
`;)++Oe;var ht=$e.substr(0,Oe);return $e[Oe]==="\r"&&++Oe,$e[Oe]===`
`&&++Oe,Y.buffer=$e.substr(Oe),ht}function fe($e){var Oe=new nt;if(me($e,function(kt,Rt){switch(kt){case"id":Oe.set(kt,Rt);break;case"width":Oe.percent(kt,Rt);break;case"lines":Oe.integer(kt,Rt);break;case"regionanchor":case"viewportanchor":var mt=Rt.split(",");if(mt.length!==2)break;var rt=new nt;if(rt.percent("x",mt[0]),rt.percent("y",mt[1]),!rt.has("x")||!rt.has("y"))break;Oe.set(kt+"X",rt.get("x")),Oe.set(kt+"Y",rt.get("y"));break;case"scroll":Oe.alt(kt,Rt,["up"]);break}},/=/,/\s/),Oe.has("id")){var ht=new(Y.vttjs.VTTRegion||Y.window.VTTRegion);ht.width=Oe.get("width",100),ht.lines=Oe.get("lines",3),ht.regionAnchorX=Oe.get("regionanchorX",0),ht.regionAnchorY=Oe.get("regionanchorY",100),ht.viewportAnchorX=Oe.get("viewportanchorX",0),ht.viewportAnchorY=Oe.get("viewportanchorY",100),ht.scroll=Oe.get("scroll",""),Y.onregion&&Y.onregion(ht),Y.regionList.push({id:Oe.get("id"),region:ht})}}function Ae($e){var Oe=new nt;me($e,function(ht,kt){switch(ht){case"MPEGT":Oe.integer(ht+"S",kt);break;case"LOCA":Oe.set(ht+"L",Ee(kt));break}},/[^\d]:/,/,/),Y.ontimestampmap&&Y.ontimestampmap({MPEGTS:Oe.get("MPEGTS"),LOCAL:Oe.get("LOCAL")})}function Re($e){$e.match(/X-TIMESTAMP-MAP/)?me($e,function(Oe,ht){switch(Oe){case"X-TIMESTAMP-MAP":Ae(ht);break}},/=/):me($e,function(Oe,ht){switch(Oe){case"Region":fe(ht);break}},/:/)}try{var Ce;if(Y.state==="INITIAL"){if(!/\r\n|\n/.test(Y.buffer))return this;Ce=ae();var we=Ce.match(/^WEBVTT([ \t].*)?$/);if(!we||!we[0])throw new Ze(Ze.Errors.BadSignature);Y.state="HEADER"}for(var Fe=!1;Y.buffer;){if(!/\r\n|\n/.test(Y.buffer))return this;switch(Fe?Fe=!1:Ce=ae(),Y.state){case"HEADER":/:/.test(Ce)?Re(Ce):Ce||(Y.state="ID");continue;case"NOTE":Ce||(Y.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(Ce)){Y.state="NOTE";break}if(!Ce)continue;Y.cue=new(Y.vttjs.VTTCue||Y.window.VTTCue)(0,0,"");try{Y.cue.align="center"}catch($e){Y.cue.align="middle"}if(Y.state="CUE",Ce.indexOf("-->")===-1){Y.cue.id=Ce;continue}case"CUE":try{Le(Ce,Y.cue,Y.regionList)}catch($e){Y.reportOrThrowError($e),Y.cue=null,Y.state="BADCUE";continue}Y.state="CUETEXT";continue;case"CUETEXT":var Ie=Ce.indexOf("-->")!==-1;if(!Ce||Ie&&(Fe=!0)){Y.oncue&&Y.oncue(Y.cue),Y.cue=null,Y.state="ID";continue}Y.cue.text&&(Y.cue.text+=`
`),Y.cue.text+=Ce.replace(/\u2028/g,`
`).replace(/u2029/g,`
`);continue;case"BADCUE":Ce||(Y.state="ID");continue}}}catch($e){Y.reportOrThrowError($e),Y.state==="CUETEXT"&&Y.cue&&Y.oncue&&Y.oncue(Y.cue),Y.cue=null,Y.state=Y.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){var U=this;try{if(U.buffer+=U.decoder.decode(),(U.cue||U.state==="HEADER")&&(U.buffer+=`

`,U.parse()),U.state==="INITIAL")throw new Ze(Ze.Errors.BadSignature)}catch(Y){U.reportOrThrowError(Y)}return U.onflush&&U.onflush(),this}},Xt.exports=S},22230:function(Xt){var Nt="auto",pt={"":1,lr:1,rl:1},ut={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function le(nt){if(typeof nt!="string")return!1;var me=pt[nt.toLowerCase()];return me?nt.toLowerCase():!1}function Ze(nt){if(typeof nt!="string")return!1;var me=ut[nt.toLowerCase()];return me?nt.toLowerCase():!1}function Ee(nt,me,Le){this.hasBeenReset=!1;var ve="",re=!1,ie=nt,J=me,D=Le,v=null,$="",I=!0,H="auto",X="start",O="auto",G="auto",j=100,V="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return ve},set:function(S){ve=""+S}},pauseOnExit:{enumerable:!0,get:function(){return re},set:function(S){re=!!S}},startTime:{enumerable:!0,get:function(){return ie},set:function(S){if(typeof S!="number")throw new TypeError("Start time must be set to a number.");ie=S,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return J},set:function(S){if(typeof S!="number")throw new TypeError("End time must be set to a number.");J=S,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return D},set:function(S){D=""+S,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return v},set:function(S){v=S,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return $},set:function(S){var ee=le(S);if(ee===!1)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");$=ee,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return I},set:function(S){I=!!S,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return H},set:function(S){if(typeof S!="number"&&S!==Nt)throw new SyntaxError("Line: an invalid number or illegal string was specified.");H=S,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return X},set:function(S){var ee=Ze(S);ee?(X=ee,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return O},set:function(S){if(S<0||S>100)throw new Error("Position must be between 0 and 100.");O=S,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return G},set:function(S){var ee=Ze(S);ee?(G=ee,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return j},set:function(S){if(S<0||S>100)throw new Error("Size must be between 0 and 100.");j=S,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return V},set:function(S){var ee=Ze(S);if(!ee)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");V=ee,this.hasBeenReset=!0}}}),this.displayState=void 0}Ee.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},Xt.exports=Ee},13710:function(Xt){var Nt={"":!0,up:!0};function pt(Ze){if(typeof Ze!="string")return!1;var Ee=Nt[Ze.toLowerCase()];return Ee?Ze.toLowerCase():!1}function ut(Ze){return typeof Ze=="number"&&Ze>=0&&Ze<=100}function le(){var Ze=100,Ee=3,nt=0,me=100,Le=0,ve=100,re="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return Ze},set:function(ie){if(!ut(ie))throw new Error("Width must be between 0 and 100.");Ze=ie}},lines:{enumerable:!0,get:function(){return Ee},set:function(ie){if(typeof ie!="number")throw new TypeError("Lines must be set to a number.");Ee=ie}},regionAnchorY:{enumerable:!0,get:function(){return me},set:function(ie){if(!ut(ie))throw new Error("RegionAnchorX must be between 0 and 100.");me=ie}},regionAnchorX:{enumerable:!0,get:function(){return nt},set:function(ie){if(!ut(ie))throw new Error("RegionAnchorY must be between 0 and 100.");nt=ie}},viewportAnchorY:{enumerable:!0,get:function(){return ve},set:function(ie){if(!ut(ie))throw new Error("ViewportAnchorY must be between 0 and 100.");ve=ie}},viewportAnchorX:{enumerable:!0,get:function(){return Le},set:function(ie){if(!ut(ie))throw new Error("ViewportAnchorX must be between 0 and 100.");Le=ie}},scroll:{enumerable:!0,get:function(){return re},set:function(ie){var J=pt(ie);J===!1?console.warn("Scroll: an invalid or illegal string was specified."):re=J}}})}Xt.exports=le}}]);
