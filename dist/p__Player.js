(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[131],{68167:function(x,_,t){"use strict";t.r(_),t.d(_,{default:function(){return C}});var c=t(86582),h=t(2824),g=t(67294),M=t(2293),o=t(85893);function C(){var a=(0,M.Z)({list:[],path:""}),L=(0,g.useState)(!1),E=(0,h.Z)(L,2),k=E[0],m=E[1],l=(0,g.useRef)(null),f=(0,g.useRef)(null),n=(0,g.useRef)(null),s=function(){var e=document.getElementById("video");return new Promise(function(v,i){var d,P="",b=document.createElement("canvas"),w=e==null?void 0:e.width,R=e==null?void 0:e.height;b.width=w,b.height=R,(d=b.getContext("2d"))===null||d===void 0||d.drawImage(e,0,0,w,R),setTimeout(function(){P=b.toDataURL("image/jpeg"),console.log(P),document.getElementById("testImg").src=P,v(P)},0)})},r=function(e){var v=[];return e?v=e:v=a.list,v.length<1?"":v.map(function(i,d){return i?d===0?"M ".concat(i[0]," ").concat(i[1]):d===1?"L ".concat(i[0]," ").concat(i[1]):d===v.length-1?"".concat(i[0]," ").concat(i[1]," Z"):"".concat(i[0]," ").concat(i[1]):""}).join(",")},y=function(e){a.list.push([e.layerX,e.layerY]),a.path=r()},p=function(e){a.path=r([].concat((0,c.Z)(a.list),[[e.layerX,e.layerY]]))},j=function(e){a.list.push([e.offsetX,e.offsetY]),a.path=r()},O=function(){a.path=r()};return(0,g.useEffect)(function(){var u,e,v,i;if(!!l.current)return(u=l.current)===null||u===void 0||u.addEventListener("click",y),(e=l.current)===null||e===void 0||e.addEventListener("mousemove",p),(v=f.current)===null||v===void 0||v.addEventListener("click",j),(i=n.current)===null||i===void 0||i.addEventListener("mouseleave",O),function(){var d,P,b,w;(d=l.current)===null||d===void 0||d.removeEventListener("click",y),(P=l.current)===null||P===void 0||P.removeEventListener("mousemove",p),(b=f.current)===null||b===void 0||b.removeEventListener("click",j),(w=n.current)===null||w===void 0||w.removeEventListener("mouseleave",O)}},[]),(0,o.jsxs)("div",{children:[(0,o.jsx)("button",{onClick:s,children:"\u622A\u56FE"}),(0,o.jsx)("button",{onClick:function(){return m(!0)},children:"\u6807\u8BB0\u70B9"}),(0,o.jsx)("button",{onClick:function(){console.log(a.list),m(!1),a.list=[],a.path=""},children:"\u63D0\u4EA4"}),(0,o.jsx)("br",{}),(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"500",height:"300",ref:n,children:[(0,o.jsxs)("foreignObject",{x:"0",y:"0",width:"500",height:"300",children:[(0,o.jsx)("div",{ref:l,className:"video-marker-cover",style:{width:"500px",height:"300px",display:k?"block":"none"}}),(0,o.jsx)("video",{autoPlay:!0,muted:!0,src:"https://gitee.com/zzdoreen/test/raw/master/big_buck_bunny.mp4",width:500,height:300,id:"video",controls:!0})]}),(0,o.jsx)("path",{ref:f,fill:"none",stroke:"red",d:a.path})]}),(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"500",height:"300",children:[(0,o.jsx)("foreignObject",{x:"0",y:"0",width:"500",height:"300",children:(0,o.jsx)("div",{children:(0,o.jsx)("img",{src:"",width:"500",height:"300",id:"testImg",alt:""})})}),(0,o.jsx)("path",{fill:"none",stroke:"red",d:a.path})]})]})}},2293:function(x,_,t){"use strict";t.d(_,{Z:function(){return f}});var c=t(67294),h=t(68630),g=t.n(h);function M(n,s){if(n===s)return!0;for(var r=0;r<n.length;r++)if(!Object.is(n[r],s[r]))return!1;return!0}function o(n,s){var r=(0,c.useRef)({deps:s,obj:void 0,initialized:!1}).current;return(r.initialized===!1||!M(r.deps,s))&&(r.deps=s,r.obj=n(),r.initialized=!0),r.obj}var C=t(65353),a=function(){var n=(0,C.__read)((0,c.useState)({}),2),s=n[1];return(0,c.useCallback)(function(){return s({})},[])},L=a,E=new WeakMap,k=new WeakMap;function m(n,s){var r=E.get(n);if(r)return r;if(k.has(n))return n;var y=new Proxy(n,{get:function(p,j,O){var u=Reflect.get(p,j,O);return g()(u)||Array.isArray(u)?m(u,s):u},set:function(p,j,O){var u=Reflect.set(p,j,O);return s(),u},deleteProperty:function(p,j){var O=Reflect.deleteProperty(p,j);return s(),O}});return E.set(n,y),k.set(y,n),y}function l(n){var s=L(),r=(0,c.useRef)(n),y=o(function(){return m(r.current,function(){s()})},[]);return y}var f=l},85924:function(x,_,t){var c=t(5569),h=c(Object.getPrototypeOf,Object);x.exports=h},5569:function(x){function _(t,c){return function(h){return t(c(h))}}x.exports=_},68630:function(x,_,t){var c=t(44239),h=t(85924),g=t(37005),M="[object Object]",o=Function.prototype,C=Object.prototype,a=o.toString,L=C.hasOwnProperty,E=a.call(Object);function k(m){if(!g(m)||c(m)!=M)return!1;var l=h(m);if(l===null)return!0;var f=L.call(l,"constructor")&&l.constructor;return typeof f=="function"&&f instanceof f&&a.call(f)==E}x.exports=k}}]);
