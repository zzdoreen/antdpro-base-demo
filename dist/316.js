var Pp=Math.pow;(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[316],{61879:function(Kt){function Mt(){return Kt.exports=Mt=Object.assign?Object.assign.bind():function(ft){for(var lt=1;lt<arguments.length;lt++){var ae=arguments[lt];for(var Ze in ae)Object.prototype.hasOwnProperty.call(ae,Ze)&&(ft[Ze]=ae[Ze])}return ft},Kt.exports.__esModule=!0,Kt.exports.default=Kt.exports,Mt.apply(this,arguments)}Kt.exports=Mt,Kt.exports.__esModule=!0,Kt.exports.default=Kt.exports},42827:function(Kt,Mt,ft){var lt=ft(97671);(function(Ze,_e){Kt.exports=_e()})(self,function(){return function(){var ae={"./node_modules/es6-promise/dist/es6-promise.js":function(Ee,ye,se){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */(function(te,Q){Ee.exports=Q()})(this,function(){"use strict";function te(Xe){var Le=typeof Xe;return Xe!==null&&(Le==="object"||Le==="function")}function Q(Xe){return typeof Xe=="function"}var w=void 0;Array.isArray?w=Array.isArray:w=function(Le){return Object.prototype.toString.call(Le)==="[object Array]"};var y=w,$=0,D=void 0,G=void 0,z=function(Le,ht){ve[$]=Le,ve[$+1]=ht,$+=2,$===2&&(G?G(De):Ce())};function P(Xe){G=Xe}function H(Xe){z=Xe}var j=typeof window!="undefined"?window:void 0,V=j||{},T=V.MutationObserver||V.WebKitMutationObserver,Z=typeof self=="undefined"&&typeof lt!="undefined"&&{}.toString.call(lt)==="[object process]",ie=typeof Uint8ClampedArray!="undefined"&&typeof importScripts!="undefined"&&typeof MessageChannel!="undefined";function le(){return function(){return lt.nextTick(De)}}function F(){return typeof D!="undefined"?function(){D(De)}:de()}function K(){var Xe=0,Le=new T(De),ht=document.createTextNode("");return Le.observe(ht,{characterData:!0}),function(){ht.data=Xe=++Xe%2}}function ne(){var Xe=new MessageChannel;return Xe.port1.onmessage=De,function(){return Xe.port2.postMessage(0)}}function de(){var Xe=setTimeout;return function(){return Xe(De,1)}}var ve=new Array(1e3);function De(){for(var Xe=0;Xe<$;Xe+=2){var Le=ve[Xe],ht=ve[Xe+1];Le(ht),ve[Xe]=void 0,ve[Xe+1]=void 0}$=0}function Se(){try{var Xe=Function("return this")().require("vertx");return D=Xe.runOnLoop||Xe.runOnContext,F()}catch(Le){return de()}}var Ce=void 0;Z?Ce=le():T?Ce=K():ie?Ce=ne():j===void 0?Ce=Se():Ce=de();function Be(Xe,Le){var ht=this,Rt=new this.constructor(Re);Rt[Ne]===void 0&&sn(Rt);var Lt=ht._state;if(Lt){var Tt=arguments[Lt-1];z(function(){return Ki(Lt,Rt,Tt,ht._result)})}else Qt(ht,Rt,Xe,Le);return Rt}function ke(Xe){var Le=this;if(Xe&&typeof Xe=="object"&&Xe.constructor===Le)return Xe;var ht=new Le(Re);return Xt(ht,Xe),ht}var Ne=Math.random().toString(36).substring(2);function Re(){}var dt=void 0,wt=1,It=2;function nt(){return new TypeError("You cannot resolve a promise with itself")}function ot(){return new TypeError("A promises callback cannot return that same promise.")}function ti(Xe,Le,ht,Rt){try{Xe.call(Le,ht,Rt)}catch(Lt){return Lt}}function bt(Xe,Le,ht){z(function(Rt){var Lt=!1,Tt=ti(ht,Le,function(ii){Lt||(Lt=!0,Le!==ii?Xt(Rt,ii):yi(Rt,ii))},function(ii){Lt||(Lt=!0,xt(Rt,ii))},"Settle: "+(Rt._label||" unknown promise"));!Lt&&Tt&&(Lt=!0,xt(Rt,Tt))},Xe)}function Vt(Xe,Le){Le._state===wt?yi(Xe,Le._result):Le._state===It?xt(Xe,Le._result):Qt(Le,void 0,function(ht){return Xt(Xe,ht)},function(ht){return xt(Xe,ht)})}function si(Xe,Le,ht){Le.constructor===Xe.constructor&&ht===Be&&Le.constructor.resolve===ke?Vt(Xe,Le):ht===void 0?yi(Xe,Le):Q(ht)?bt(Xe,Le,ht):yi(Xe,Le)}function Xt(Xe,Le){if(Xe===Le)xt(Xe,nt());else if(te(Le)){var ht=void 0;try{ht=Le.then}catch(Rt){xt(Xe,Rt);return}si(Xe,Le,ht)}else yi(Xe,Le)}function _i(Xe){Xe._onerror&&Xe._onerror(Xe._result),li(Xe)}function yi(Xe,Le){Xe._state===dt&&(Xe._result=Le,Xe._state=wt,Xe._subscribers.length!==0&&z(li,Xe))}function xt(Xe,Le){Xe._state===dt&&(Xe._state=It,Xe._result=Le,z(_i,Xe))}function Qt(Xe,Le,ht,Rt){var Lt=Xe._subscribers,Tt=Lt.length;Xe._onerror=null,Lt[Tt]=Le,Lt[Tt+wt]=ht,Lt[Tt+It]=Rt,Tt===0&&Xe._state&&z(li,Xe)}function li(Xe){var Le=Xe._subscribers,ht=Xe._state;if(Le.length!==0){for(var Rt=void 0,Lt=void 0,Tt=Xe._result,ii=0;ii<Le.length;ii+=3)Rt=Le[ii],Lt=Le[ii+ht],Rt?Ki(ht,Rt,Lt,Tt):Lt(Tt);Xe._subscribers.length=0}}function Ki(Xe,Le,ht,Rt){var Lt=Q(ht),Tt=void 0,ii=void 0,mn=!0;if(Lt){try{Tt=ht(Rt)}catch(Ut){mn=!1,ii=Ut}if(Le===Tt){xt(Le,ot());return}}else Tt=Rt;Le._state!==dt||(Lt&&mn?Xt(Le,Tt):mn===!1?xt(Le,ii):Xe===wt?yi(Le,Tt):Xe===It&&xt(Le,Tt))}function Ji(Xe,Le){try{Le(function(Rt){Xt(Xe,Rt)},function(Rt){xt(Xe,Rt)})}catch(ht){xt(Xe,ht)}}var $i=0;function cn(){return $i++}function sn(Xe){Xe[Ne]=$i++,Xe._state=void 0,Xe._result=void 0,Xe._subscribers=[]}function pt(){return new Error("Array Methods must be provided an Array")}var vi=function(){function Xe(Le,ht){this._instanceConstructor=Le,this.promise=new Le(Re),this.promise[Ne]||sn(this.promise),y(ht)?(this.length=ht.length,this._remaining=ht.length,this._result=new Array(this.length),this.length===0?yi(this.promise,this._result):(this.length=this.length||0,this._enumerate(ht),this._remaining===0&&yi(this.promise,this._result))):xt(this.promise,pt())}return Xe.prototype._enumerate=function(ht){for(var Rt=0;this._state===dt&&Rt<ht.length;Rt++)this._eachEntry(ht[Rt],Rt)},Xe.prototype._eachEntry=function(ht,Rt){var Lt=this._instanceConstructor,Tt=Lt.resolve;if(Tt===ke){var ii=void 0,mn=void 0,Ut=!1;try{ii=ht.then}catch(Wn){Ut=!0,mn=Wn}if(ii===Be&&ht._state!==dt)this._settledAt(ht._state,Rt,ht._result);else if(typeof ii!="function")this._remaining--,this._result[Rt]=ht;else if(Lt===Zi){var Bn=new Lt(Re);Ut?xt(Bn,mn):si(Bn,ht,ii),this._willSettleAt(Bn,Rt)}else this._willSettleAt(new Lt(function(Wn){return Wn(ht)}),Rt)}else this._willSettleAt(Tt(ht),Rt)},Xe.prototype._settledAt=function(ht,Rt,Lt){var Tt=this.promise;Tt._state===dt&&(this._remaining--,ht===It?xt(Tt,Lt):this._result[Rt]=Lt),this._remaining===0&&yi(Tt,this._result)},Xe.prototype._willSettleAt=function(ht,Rt){var Lt=this;Qt(ht,void 0,function(Tt){return Lt._settledAt(wt,Rt,Tt)},function(Tt){return Lt._settledAt(It,Rt,Tt)})},Xe}();function xi(Xe){return new vi(this,Xe).promise}function oi(Xe){var Le=this;return y(Xe)?new Le(function(ht,Rt){for(var Lt=Xe.length,Tt=0;Tt<Lt;Tt++)Le.resolve(Xe[Tt]).then(ht,Rt)}):new Le(function(ht,Rt){return Rt(new TypeError("You must pass an array to race."))})}function kn(Xe){var Le=this,ht=new Le(Re);return xt(ht,Xe),ht}function Gr(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function Is(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var Zi=function(){function Xe(Le){this[Ne]=cn(),this._result=this._state=void 0,this._subscribers=[],Re!==Le&&(typeof Le!="function"&&Gr(),this instanceof Xe?Ji(this,Le):Is())}return Xe.prototype.catch=function(ht){return this.then(null,ht)},Xe.prototype.finally=function(ht){var Rt=this,Lt=Rt.constructor;return Q(ht)?Rt.then(function(Tt){return Lt.resolve(ht()).then(function(){return Tt})},function(Tt){return Lt.resolve(ht()).then(function(){throw Tt})}):Rt.then(ht,ht)},Xe}();Zi.prototype.then=Be,Zi.all=xi,Zi.race=oi,Zi.resolve=ke,Zi.reject=kn,Zi._setScheduler=P,Zi._setAsap=H,Zi._asap=z;function Tn(){var Xe=void 0;if(typeof se.g!="undefined")Xe=se.g;else if(typeof self!="undefined")Xe=self;else try{Xe=Function("return this")()}catch(Rt){throw new Error("polyfill failed because global object is unavailable in this environment")}var Le=Xe.Promise;if(Le){var ht=null;try{ht=Object.prototype.toString.call(Le.resolve())}catch(Rt){}if(ht==="[object Promise]"&&!Le.cast)return}Xe.Promise=Zi}return Zi.polyfill=Tn,Zi.Promise=Zi,Zi})},"./node_modules/events/events.js":function(Ee){"use strict";var ye=typeof Reflect=="object"?Reflect:null,se=ye&&typeof ye.apply=="function"?ye.apply:function(de,ve,De){return Function.prototype.apply.call(de,ve,De)},te;ye&&typeof ye.ownKeys=="function"?te=ye.ownKeys:Object.getOwnPropertySymbols?te=function(de){return Object.getOwnPropertyNames(de).concat(Object.getOwnPropertySymbols(de))}:te=function(de){return Object.getOwnPropertyNames(de)};function Q(ne){console&&console.warn&&console.warn(ne)}var w=Number.isNaN||function(de){return de!==de};function y(){y.init.call(this)}Ee.exports=y,Ee.exports.once=le,y.EventEmitter=y,y.prototype._events=void 0,y.prototype._eventsCount=0,y.prototype._maxListeners=void 0;var $=10;function D(ne){if(typeof ne!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof ne)}Object.defineProperty(y,"defaultMaxListeners",{enumerable:!0,get:function(){return $},set:function(de){if(typeof de!="number"||de<0||w(de))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+de+".");$=de}}),y.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},y.prototype.setMaxListeners=function(de){if(typeof de!="number"||de<0||w(de))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+de+".");return this._maxListeners=de,this};function G(ne){return ne._maxListeners===void 0?y.defaultMaxListeners:ne._maxListeners}y.prototype.getMaxListeners=function(){return G(this)},y.prototype.emit=function(de){for(var ve=[],De=1;De<arguments.length;De++)ve.push(arguments[De]);var Se=de==="error",Ce=this._events;if(Ce!==void 0)Se=Se&&Ce.error===void 0;else if(!Se)return!1;if(Se){var Be;if(ve.length>0&&(Be=ve[0]),Be instanceof Error)throw Be;var ke=new Error("Unhandled error."+(Be?" ("+Be.message+")":""));throw ke.context=Be,ke}var Ne=Ce[de];if(Ne===void 0)return!1;if(typeof Ne=="function")se(Ne,this,ve);else for(var Re=Ne.length,dt=T(Ne,Re),De=0;De<Re;++De)se(dt[De],this,ve);return!0};function z(ne,de,ve,De){var Se,Ce,Be;if(D(ve),Ce=ne._events,Ce===void 0?(Ce=ne._events=Object.create(null),ne._eventsCount=0):(Ce.newListener!==void 0&&(ne.emit("newListener",de,ve.listener?ve.listener:ve),Ce=ne._events),Be=Ce[de]),Be===void 0)Be=Ce[de]=ve,++ne._eventsCount;else if(typeof Be=="function"?Be=Ce[de]=De?[ve,Be]:[Be,ve]:De?Be.unshift(ve):Be.push(ve),Se=G(ne),Se>0&&Be.length>Se&&!Be.warned){Be.warned=!0;var ke=new Error("Possible EventEmitter memory leak detected. "+Be.length+" "+String(de)+" listeners added. Use emitter.setMaxListeners() to increase limit");ke.name="MaxListenersExceededWarning",ke.emitter=ne,ke.type=de,ke.count=Be.length,Q(ke)}return ne}y.prototype.addListener=function(de,ve){return z(this,de,ve,!1)},y.prototype.on=y.prototype.addListener,y.prototype.prependListener=function(de,ve){return z(this,de,ve,!0)};function P(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function H(ne,de,ve){var De={fired:!1,wrapFn:void 0,target:ne,type:de,listener:ve},Se=P.bind(De);return Se.listener=ve,De.wrapFn=Se,Se}y.prototype.once=function(de,ve){return D(ve),this.on(de,H(this,de,ve)),this},y.prototype.prependOnceListener=function(de,ve){return D(ve),this.prependListener(de,H(this,de,ve)),this},y.prototype.removeListener=function(de,ve){var De,Se,Ce,Be,ke;if(D(ve),Se=this._events,Se===void 0)return this;if(De=Se[de],De===void 0)return this;if(De===ve||De.listener===ve)--this._eventsCount==0?this._events=Object.create(null):(delete Se[de],Se.removeListener&&this.emit("removeListener",de,De.listener||ve));else if(typeof De!="function"){for(Ce=-1,Be=De.length-1;Be>=0;Be--)if(De[Be]===ve||De[Be].listener===ve){ke=De[Be].listener,Ce=Be;break}if(Ce<0)return this;Ce===0?De.shift():Z(De,Ce),De.length===1&&(Se[de]=De[0]),Se.removeListener!==void 0&&this.emit("removeListener",de,ke||ve)}return this},y.prototype.off=y.prototype.removeListener,y.prototype.removeAllListeners=function(de){var ve,De,Se;if(De=this._events,De===void 0)return this;if(De.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):De[de]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete De[de]),this;if(arguments.length===0){var Ce=Object.keys(De),Be;for(Se=0;Se<Ce.length;++Se)Be=Ce[Se],Be!=="removeListener"&&this.removeAllListeners(Be);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(ve=De[de],typeof ve=="function")this.removeListener(de,ve);else if(ve!==void 0)for(Se=ve.length-1;Se>=0;Se--)this.removeListener(de,ve[Se]);return this};function j(ne,de,ve){var De=ne._events;if(De===void 0)return[];var Se=De[de];return Se===void 0?[]:typeof Se=="function"?ve?[Se.listener||Se]:[Se]:ve?ie(Se):T(Se,Se.length)}y.prototype.listeners=function(de){return j(this,de,!0)},y.prototype.rawListeners=function(de){return j(this,de,!1)},y.listenerCount=function(ne,de){return typeof ne.listenerCount=="function"?ne.listenerCount(de):V.call(ne,de)},y.prototype.listenerCount=V;function V(ne){var de=this._events;if(de!==void 0){var ve=de[ne];if(typeof ve=="function")return 1;if(ve!==void 0)return ve.length}return 0}y.prototype.eventNames=function(){return this._eventsCount>0?te(this._events):[]};function T(ne,de){for(var ve=new Array(de),De=0;De<de;++De)ve[De]=ne[De];return ve}function Z(ne,de){for(;de+1<ne.length;de++)ne[de]=ne[de+1];ne.pop()}function ie(ne){for(var de=new Array(ne.length),ve=0;ve<de.length;++ve)de[ve]=ne[ve].listener||ne[ve];return de}function le(ne,de){return new Promise(function(ve,De){function Se(Be){ne.removeListener(de,Ce),De(Be)}function Ce(){typeof ne.removeListener=="function"&&ne.removeListener("error",Se),ve([].slice.call(arguments))}K(ne,de,Ce,{once:!0}),de!=="error"&&F(ne,Se,{once:!0})})}function F(ne,de,ve){typeof ne.on=="function"&&K(ne,"error",de,ve)}function K(ne,de,ve,De){if(typeof ne.on=="function")De.once?ne.once(de,ve):ne.on(de,ve);else if(typeof ne.addEventListener=="function")ne.addEventListener(de,function Se(Ce){De.once&&ne.removeEventListener(de,Se),ve(Ce)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof ne)}},"./node_modules/webworkify-webpack/index.js":function(Ee,ye,se){function te(P){var H={};function j(T){if(H[T])return H[T].exports;var Z=H[T]={i:T,l:!1,exports:{}};return P[T].call(Z.exports,Z,Z.exports,j),Z.l=!0,Z.exports}j.m=P,j.c=H,j.i=function(T){return T},j.d=function(T,Z,ie){j.o(T,Z)||Object.defineProperty(T,Z,{configurable:!1,enumerable:!0,get:ie})},j.r=function(T){Object.defineProperty(T,"__esModule",{value:!0})},j.n=function(T){var Z=T&&T.__esModule?function(){return T.default}:function(){return T};return j.d(Z,"a",Z),Z},j.o=function(T,Z){return Object.prototype.hasOwnProperty.call(T,Z)},j.p="/",j.oe=function(T){throw console.error(T),T};var V=j(j.s=ENTRY_MODULE);return V.default||V}var Q="[\\.|\\-|\\+|\\w|/|@]+",w="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+Q+").*?\\)";function y(P){return(P+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function $(P){return!isNaN(1*P)}function D(P,H,j){var V={};V[j]=[];var T=H.toString(),Z=T.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!Z)return V;for(var ie=Z[1],le=new RegExp("(\\\\n|\\W)"+y(ie)+w,"g"),F;F=le.exec(T);)F[3]!=="dll-reference"&&V[j].push(F[3]);for(le=new RegExp("\\("+y(ie)+'\\("(dll-reference\\s('+Q+'))"\\)\\)'+w,"g");F=le.exec(T);)P[F[2]]||(V[j].push(F[1]),P[F[2]]=se(F[1]).m),V[F[2]]=V[F[2]]||[],V[F[2]].push(F[4]);for(var K=Object.keys(V),ne=0;ne<K.length;ne++)for(var de=0;de<V[K[ne]].length;de++)$(V[K[ne]][de])&&(V[K[ne]][de]=1*V[K[ne]][de]);return V}function G(P){var H=Object.keys(P);return H.reduce(function(j,V){return j||P[V].length>0},!1)}function z(P,H){for(var j={main:[H]},V={main:[]},T={main:{}};G(j);)for(var Z=Object.keys(j),ie=0;ie<Z.length;ie++){var le=Z[ie],F=j[le],K=F.pop();if(T[le]=T[le]||{},!(T[le][K]||!P[le][K])){T[le][K]=!0,V[le]=V[le]||[],V[le].push(K);for(var ne=D(P,P[le][K],le),de=Object.keys(ne),ve=0;ve<de.length;ve++)j[de[ve]]=j[de[ve]]||[],j[de[ve]]=j[de[ve]].concat(ne[de[ve]])}}return V}Ee.exports=function(P,H){H=H||{};var j={main:se.m},V=H.all?{main:Object.keys(j.main)}:z(j,P),T="";Object.keys(V).filter(function(K){return K!=="main"}).forEach(function(K){for(var ne=0;V[K][ne];)ne++;V[K].push(ne),j[K][ne]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",T=T+"var "+K+" = ("+te.toString().replace("ENTRY_MODULE",JSON.stringify(ne))+")({"+V[K].map(function(de){return""+JSON.stringify(de)+": "+j[K][de].toString()}).join(",")+`});
`}),T=T+"new (("+te.toString().replace("ENTRY_MODULE",JSON.stringify(P))+")({"+V.main.map(function(K){return""+JSON.stringify(K)+": "+j.main[K].toString()}).join(",")+"}))(self);";var Z=new window.Blob([T],{type:"text/javascript"});if(H.bare)return Z;var ie=window.URL||window.webkitURL||window.mozURL||window.msURL,le=ie.createObjectURL(Z),F=new window.Worker(le);return F.objectURL=le,F}},"./src/config.js":function(Ee,ye,se){"use strict";se.r(ye),se.d(ye,{defaultConfig:function(){return te},createDefaultConfig:function(){return Q}});var te={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,lazyLoad:!0,lazyLoadMaxDuration:3*60,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:3*60,autoCleanupMinBackwardDuration:2*60,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function Q(){return Object.assign({},te)}},"./src/core/features.js":function(Ee,ye,se){"use strict";se.r(ye);var te=se("./src/io/io-controller.js"),Q=se("./src/config.js"),w=function(){function y(){}return y.supportMSEH264Playback=function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')},y.supportNetworkStreamIO=function(){var $=new te.default({},(0,Q.createDefaultConfig)()),D=$.loaderType;return $.destroy(),D=="fetch-stream-loader"||D=="xhr-moz-chunked-loader"},y.getNetworkLoaderTypeName=function(){var $=new te.default({},(0,Q.createDefaultConfig)()),D=$.loaderType;return $.destroy(),D},y.supportNativeMediaPlayback=function($){y.videoElement==null&&(y.videoElement=window.document.createElement("video"));var D=y.videoElement.canPlayType($);return D==="probably"||D=="maybe"},y.getFeatureList=function(){var $={mseFlvPlayback:!1,mseLiveFlvPlayback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return $.mseFlvPlayback=y.supportMSEH264Playback(),$.networkStreamIO=y.supportNetworkStreamIO(),$.networkLoaderName=y.getNetworkLoaderTypeName(),$.mseLiveFlvPlayback=$.mseFlvPlayback&&$.networkStreamIO,$.nativeMP4H264Playback=y.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),$.nativeWebmVP8Playback=y.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),$.nativeWebmVP9Playback=y.supportNativeMediaPlayback('video/webm; codecs="vp9"'),$},y}();ye.default=w},"./src/core/media-info.js":function(Ee,ye,se){"use strict";se.r(ye);var te=function(){function Q(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return Q.prototype.isComplete=function(){var w=this.hasAudio===!1||this.hasAudio===!0&&this.audioCodec!=null&&this.audioSampleRate!=null&&this.audioChannelCount!=null,y=this.hasVideo===!1||this.hasVideo===!0&&this.videoCodec!=null&&this.width!=null&&this.height!=null&&this.fps!=null&&this.profile!=null&&this.level!=null&&this.refFrames!=null&&this.chromaFormat!=null&&this.sarNum!=null&&this.sarDen!=null;return this.mimeType!=null&&this.duration!=null&&this.metadata!=null&&this.hasKeyframesIndex!=null&&w&&y},Q.prototype.isSeekable=function(){return this.hasKeyframesIndex===!0},Q.prototype.getNearestKeyframe=function(w){if(this.keyframesIndex==null)return null;var y=this.keyframesIndex,$=this._search(y.times,w);return{index:$,milliseconds:y.times[$],fileposition:y.filepositions[$]}},Q.prototype._search=function(w,y){var $=0,D=w.length-1,G=0,z=0,P=D;for(y<w[0]&&($=0,z=P+1);z<=P;)if(G=z+Math.floor((P-z)/2),G===D||y>=w[G]&&y<w[G+1]){$=G;break}else w[G]<y?z=G+1:P=G-1;return $},Q}();ye.default=te},"./src/core/media-segment-info.js":function(Ee,ye,se){"use strict";se.r(ye),se.d(ye,{SampleInfo:function(){return te},MediaSegmentInfo:function(){return Q},IDRSampleList:function(){return w},MediaSegmentInfoList:function(){return y}});var te=function(){function $(D,G,z,P,H){this.dts=D,this.pts=G,this.duration=z,this.originalDts=P,this.isSyncPoint=H,this.fileposition=null}return $}(),Q=function(){function $(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return $.prototype.appendSyncPoint=function(D){D.isSyncPoint=!0,this.syncPoints.push(D)},$}(),w=function(){function $(){this._list=[]}return $.prototype.clear=function(){this._list=[]},$.prototype.appendArray=function(D){var G=this._list;D.length!==0&&(G.length>0&&D[0].originalDts<G[G.length-1].originalDts&&this.clear(),Array.prototype.push.apply(G,D))},$.prototype.getLastSyncPointBeforeDts=function(D){if(this._list.length==0)return null;var G=this._list,z=0,P=G.length-1,H=0,j=0,V=P;for(D<G[0].dts&&(z=0,j=V+1);j<=V;)if(H=j+Math.floor((V-j)/2),H===P||D>=G[H].dts&&D<G[H+1].dts){z=H;break}else G[H].dts<D?j=H+1:V=H-1;return this._list[z]},$}(),y=function(){function $(D){this._type=D,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty($.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),$.prototype.isEmpty=function(){return this._list.length===0},$.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},$.prototype._searchNearestSegmentBefore=function(D){var G=this._list;if(G.length===0)return-2;var z=G.length-1,P=0,H=0,j=z,V=0;if(D<G[0].originalBeginDts)return V=-1,V;for(;H<=j;)if(P=H+Math.floor((j-H)/2),P===z||D>G[P].lastSample.originalDts&&D<G[P+1].originalBeginDts){V=P;break}else G[P].originalBeginDts<D?H=P+1:j=P-1;return V},$.prototype._searchNearestSegmentAfter=function(D){return this._searchNearestSegmentBefore(D)+1},$.prototype.append=function(D){var G=this._list,z=D,P=this._lastAppendLocation,H=0;P!==-1&&P<G.length&&z.originalBeginDts>=G[P].lastSample.originalDts&&(P===G.length-1||P<G.length-1&&z.originalBeginDts<G[P+1].originalBeginDts)?H=P+1:G.length>0&&(H=this._searchNearestSegmentBefore(z.originalBeginDts)+1),this._lastAppendLocation=H,this._list.splice(H,0,z)},$.prototype.getLastSegmentBefore=function(D){var G=this._searchNearestSegmentBefore(D);return G>=0?this._list[G]:null},$.prototype.getLastSampleBefore=function(D){var G=this.getLastSegmentBefore(D);return G!=null?G.lastSample:null},$.prototype.getLastSyncPointBefore=function(D){for(var G=this._searchNearestSegmentBefore(D),z=this._list[G].syncPoints;z.length===0&&G>0;)G--,z=this._list[G].syncPoints;return z.length>0?z[z.length-1]:null},$}()},"./src/core/mse-controller.js":function(Ee,ye,se){"use strict";se.r(ye);var te=se("./node_modules/events/events.js"),Q=se.n(te),w=se("./src/utils/logger.js"),y=se("./src/utils/browser.js"),$=se("./src/core/mse-events.js"),D=se("./src/core/media-segment-info.js"),G=se("./src/utils/exception.js"),z=function(){function P(H){this.TAG="MSEController",this._config=H,this._emitter=new(Q()),this._config.isLive&&this._config.autoCleanupSourceBuffer==null&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new D.IDRSampleList}return P.prototype.destroy=function(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},P.prototype.on=function(H,j){this._emitter.addListener(H,j)},P.prototype.off=function(H,j){this._emitter.removeListener(H,j)},P.prototype.attachMediaElement=function(H){if(this._mediaSource)throw new G.IllegalStateException("MediaSource has been attached to an HTMLMediaElement!");var j=this._mediaSource=new window.MediaSource;j.addEventListener("sourceopen",this.e.onSourceOpen),j.addEventListener("sourceended",this.e.onSourceEnded),j.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=H,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),H.src=this._mediaSourceObjectURL},P.prototype.detachMediaElement=function(){if(this._mediaSource){var H=this._mediaSource;for(var j in this._sourceBuffers){var V=this._pendingSegments[j];V.splice(0,V.length),this._pendingSegments[j]=null,this._pendingRemoveRanges[j]=null,this._lastInitSegments[j]=null;var T=this._sourceBuffers[j];if(T){if(H.readyState!=="closed"){try{H.removeSourceBuffer(T)}catch(Z){w.default.e(this.TAG,Z.message)}T.removeEventListener("error",this.e.onSourceBufferError),T.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[j]=null,this._sourceBuffers[j]=null}}if(H.readyState==="open")try{H.endOfStream()}catch(Z){w.default.e(this.TAG,Z.message)}H.removeEventListener("sourceopen",this.e.onSourceOpen),H.removeEventListener("sourceended",this.e.onSourceEnded),H.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},P.prototype.appendInitSegment=function(H,j){if(!this._mediaSource||this._mediaSource.readyState!=="open"){this._pendingSourceBufferInit.push(H),this._pendingSegments[H.type].push(H);return}var V=H,T=""+V.container;V.codec&&V.codec.length>0&&(T+=";codecs="+V.codec);var Z=!1;if(w.default.v(this.TAG,"Received Initialization Segment, mimeType: "+T),this._lastInitSegments[V.type]=V,T!==this._mimeTypes[V.type]){if(this._mimeTypes[V.type])w.default.v(this.TAG,"Notice: "+V.type+" mimeType changed, origin: "+this._mimeTypes[V.type]+", target: "+T);else{Z=!0;try{var ie=this._sourceBuffers[V.type]=this._mediaSource.addSourceBuffer(T);ie.addEventListener("error",this.e.onSourceBufferError),ie.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(le){w.default.e(this.TAG,le.message),this._emitter.emit($.default.ERROR,{code:le.code,msg:le.message});return}}this._mimeTypes[V.type]=T}j||this._pendingSegments[V.type].push(V),Z||this._sourceBuffers[V.type]&&!this._sourceBuffers[V.type].updating&&this._doAppendSegments(),y.default.safari&&V.container==="audio/mpeg"&&V.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=V.mediaDuration/1e3,this._updateMediaSourceDuration())},P.prototype.appendMediaSegment=function(H){var j=H;this._pendingSegments[j.type].push(j),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var V=this._sourceBuffers[j.type];V&&!V.updating&&!this._hasPendingRemoveRanges()&&this._doAppendSegments()},P.prototype.seek=function(H){for(var j in this._sourceBuffers)if(!!this._sourceBuffers[j]){var V=this._sourceBuffers[j];if(this._mediaSource.readyState==="open")try{V.abort()}catch(K){w.default.e(this.TAG,K.message)}this._idrList.clear();var T=this._pendingSegments[j];if(T.splice(0,T.length),this._mediaSource.readyState!=="closed"){for(var Z=0;Z<V.buffered.length;Z++){var ie=V.buffered.start(Z),le=V.buffered.end(Z);this._pendingRemoveRanges[j].push({start:ie,end:le})}if(V.updating||this._doRemoveRanges(),y.default.safari){var F=this._lastInitSegments[j];F&&(this._pendingSegments[j].push(F),V.updating||this._doAppendSegments())}}}},P.prototype.endOfStream=function(){var H=this._mediaSource,j=this._sourceBuffers;if(!H||H.readyState!=="open"){H&&H.readyState==="closed"&&this._hasPendingSegments()&&(this._hasPendingEos=!0);return}j.video&&j.video.updating||j.audio&&j.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,H.endOfStream())},P.prototype.getNearestKeyframe=function(H){return this._idrList.getLastSyncPointBeforeDts(H)},P.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var H=this._mediaElement.currentTime;for(var j in this._sourceBuffers){var V=this._sourceBuffers[j];if(V){var T=V.buffered;if(T.length>=1&&H-T.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},P.prototype._doCleanupSourceBuffer=function(){var H=this._mediaElement.currentTime;for(var j in this._sourceBuffers){var V=this._sourceBuffers[j];if(V){for(var T=V.buffered,Z=!1,ie=0;ie<T.length;ie++){var le=T.start(ie),F=T.end(ie);if(le<=H&&H<F+3){if(H-le>=this._config.autoCleanupMaxBackwardDuration){Z=!0;var K=H-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[j].push({start:le,end:K})}}else F<H&&(Z=!0,this._pendingRemoveRanges[j].push({start:le,end:F}))}Z&&!V.updating&&this._doRemoveRanges()}}},P.prototype._updateMediaSourceDuration=function(){var H=this._sourceBuffers;if(!(this._mediaElement.readyState===0||this._mediaSource.readyState!=="open")&&!(H.video&&H.video.updating||H.audio&&H.audio.updating)){var j=this._mediaSource.duration,V=this._pendingMediaDuration;V>0&&(isNaN(j)||V>j)&&(w.default.v(this.TAG,"Update MediaSource duration from "+j+" to "+V),this._mediaSource.duration=V),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},P.prototype._doRemoveRanges=function(){for(var H in this._pendingRemoveRanges)if(!(!this._sourceBuffers[H]||this._sourceBuffers[H].updating))for(var j=this._sourceBuffers[H],V=this._pendingRemoveRanges[H];V.length&&!j.updating;){var T=V.shift();j.remove(T.start,T.end)}},P.prototype._doAppendSegments=function(){var H=this._pendingSegments;for(var j in H)if(!(!this._sourceBuffers[j]||this._sourceBuffers[j].updating)&&H[j].length>0){var V=H[j].shift();if(V.timestampOffset){var T=this._sourceBuffers[j].timestampOffset,Z=V.timestampOffset/1e3,ie=Math.abs(T-Z);ie>.1&&(w.default.v(this.TAG,"Update MPEG audio timestampOffset from "+T+" to "+Z),this._sourceBuffers[j].timestampOffset=Z),delete V.timestampOffset}if(!V.data||V.data.byteLength===0)continue;try{this._sourceBuffers[j].appendBuffer(V.data),this._isBufferFull=!1,j==="video"&&V.hasOwnProperty("info")&&this._idrList.appendArray(V.info.syncPoints)}catch(le){this._pendingSegments[j].unshift(V),le.code===22?(this._isBufferFull||this._emitter.emit($.default.BUFFER_FULL),this._isBufferFull=!0):(w.default.e(this.TAG,le.message),this._emitter.emit($.default.ERROR,{code:le.code,msg:le.message}))}}},P.prototype._onSourceOpen=function(){if(w.default.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var H=this._pendingSourceBufferInit;H.length;){var j=H.shift();this.appendInitSegment(j,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit($.default.SOURCE_OPEN)},P.prototype._onSourceEnded=function(){w.default.v(this.TAG,"MediaSource onSourceEnded")},P.prototype._onSourceClose=function(){w.default.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&this.e!=null&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))},P.prototype._hasPendingSegments=function(){var H=this._pendingSegments;return H.video.length>0||H.audio.length>0},P.prototype._hasPendingRemoveRanges=function(){var H=this._pendingRemoveRanges;return H.video.length>0||H.audio.length>0},P.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit($.default.UPDATE_END)},P.prototype._onSourceBufferError=function(H){w.default.e(this.TAG,"SourceBuffer Error: "+H)},P}();ye.default=z},"./src/core/mse-events.js":function(Ee,ye,se){"use strict";se.r(ye);var te={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"};ye.default=te},"./src/core/transmuxer.js":function(Ee,ye,se){"use strict";se.r(ye);var te=se("./node_modules/events/events.js"),Q=se.n(te),w=se("./node_modules/webworkify-webpack/index.js"),y=se.n(w),$=se("./src/utils/logger.js"),D=se("./src/utils/logging-control.js"),G=se("./src/core/transmuxing-controller.js"),z=se("./src/core/transmuxing-events.js"),P=se("./src/core/media-info.js"),H=function(){function j(V,T){if(this.TAG="Transmuxer",this._emitter=new(Q()),T.enableWorker&&typeof Worker!="undefined")try{this._worker=y()("./src/core/transmuxing-worker.js"),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[V,T]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},D.default.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:D.default.getConfig()})}catch(ie){$.default.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new G.default(V,T)}else this._controller=new G.default(V,T);if(this._controller){var Z=this._controller;Z.on(z.default.IO_ERROR,this._onIOError.bind(this)),Z.on(z.default.DEMUX_ERROR,this._onDemuxError.bind(this)),Z.on(z.default.INIT_SEGMENT,this._onInitSegment.bind(this)),Z.on(z.default.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),Z.on(z.default.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),Z.on(z.default.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),Z.on(z.default.MEDIA_INFO,this._onMediaInfo.bind(this)),Z.on(z.default.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),Z.on(z.default.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),Z.on(z.default.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),Z.on(z.default.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return j.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),D.default.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},j.prototype.on=function(V,T){this._emitter.addListener(V,T)},j.prototype.off=function(V,T){this._emitter.removeListener(V,T)},j.prototype.hasWorker=function(){return this._worker!=null},j.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},j.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},j.prototype.seek=function(V){this._worker?this._worker.postMessage({cmd:"seek",param:V}):this._controller.seek(V)},j.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},j.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},j.prototype._onInitSegment=function(V,T){var Z=this;Promise.resolve().then(function(){Z._emitter.emit(z.default.INIT_SEGMENT,V,T)})},j.prototype._onMediaSegment=function(V,T){var Z=this;Promise.resolve().then(function(){Z._emitter.emit(z.default.MEDIA_SEGMENT,V,T)})},j.prototype._onLoadingComplete=function(){var V=this;Promise.resolve().then(function(){V._emitter.emit(z.default.LOADING_COMPLETE)})},j.prototype._onRecoveredEarlyEof=function(){var V=this;Promise.resolve().then(function(){V._emitter.emit(z.default.RECOVERED_EARLY_EOF)})},j.prototype._onMediaInfo=function(V){var T=this;Promise.resolve().then(function(){T._emitter.emit(z.default.MEDIA_INFO,V)})},j.prototype._onMetaDataArrived=function(V){var T=this;Promise.resolve().then(function(){T._emitter.emit(z.default.METADATA_ARRIVED,V)})},j.prototype._onScriptDataArrived=function(V){var T=this;Promise.resolve().then(function(){T._emitter.emit(z.default.SCRIPTDATA_ARRIVED,V)})},j.prototype._onStatisticsInfo=function(V){var T=this;Promise.resolve().then(function(){T._emitter.emit(z.default.STATISTICS_INFO,V)})},j.prototype._onIOError=function(V,T){var Z=this;Promise.resolve().then(function(){Z._emitter.emit(z.default.IO_ERROR,V,T)})},j.prototype._onDemuxError=function(V,T){var Z=this;Promise.resolve().then(function(){Z._emitter.emit(z.default.DEMUX_ERROR,V,T)})},j.prototype._onRecommendSeekpoint=function(V){var T=this;Promise.resolve().then(function(){T._emitter.emit(z.default.RECOMMEND_SEEKPOINT,V)})},j.prototype._onLoggingConfigChanged=function(V){this._worker&&this._worker.postMessage({cmd:"logging_config",param:V})},j.prototype._onWorkerMessage=function(V){var T=V.data,Z=T.data;if(T.msg==="destroyed"||this._workerDestroying){this._workerDestroying=!1,this._worker.terminate(),this._worker=null;return}switch(T.msg){case z.default.INIT_SEGMENT:case z.default.MEDIA_SEGMENT:this._emitter.emit(T.msg,Z.type,Z.data);break;case z.default.LOADING_COMPLETE:case z.default.RECOVERED_EARLY_EOF:this._emitter.emit(T.msg);break;case z.default.MEDIA_INFO:Object.setPrototypeOf(Z,P.default.prototype),this._emitter.emit(T.msg,Z);break;case z.default.METADATA_ARRIVED:case z.default.SCRIPTDATA_ARRIVED:case z.default.STATISTICS_INFO:this._emitter.emit(T.msg,Z);break;case z.default.IO_ERROR:case z.default.DEMUX_ERROR:this._emitter.emit(T.msg,Z.type,Z.info);break;case z.default.RECOMMEND_SEEKPOINT:this._emitter.emit(T.msg,Z);break;case"logcat_callback":$.default.emitter.emit("log",Z.type,Z.logcat);break;default:break}},j}();ye.default=H},"./src/core/transmuxing-controller.js":function(Ee,ye,se){"use strict";se.r(ye);var te=se("./node_modules/events/events.js"),Q=se.n(te),w=se("./src/utils/logger.js"),y=se("./src/utils/browser.js"),$=se("./src/core/media-info.js"),D=se("./src/demux/flv-demuxer.js"),G=se("./src/remux/mp4-remuxer.js"),z=se("./src/demux/demux-errors.js"),P=se("./src/io/io-controller.js"),H=se("./src/core/transmuxing-events.js"),j=function(){function V(T,Z){this.TAG="TransmuxingController",this._emitter=new(Q()),this._config=Z,T.segments||(T.segments=[{duration:T.duration,filesize:T.filesize,url:T.url}]),typeof T.cors!="boolean"&&(T.cors=!0),typeof T.withCredentials!="boolean"&&(T.withCredentials=!1),this._mediaDataSource=T,this._currentSegmentIndex=0;var ie=0;this._mediaDataSource.segments.forEach(function(le){le.timestampBase=ie,ie+=le.duration,le.cors=T.cors,le.withCredentials=T.withCredentials,Z.referrerPolicy&&(le.referrerPolicy=Z.referrerPolicy)}),!isNaN(ie)&&this._mediaDataSource.duration!==ie&&(this._mediaDataSource.duration=ie),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return V.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},V.prototype.on=function(T,Z){this._emitter.addListener(T,Z)},V.prototype.off=function(T,Z){this._emitter.removeListener(T,Z)},V.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},V.prototype._loadSegment=function(T,Z){this._currentSegmentIndex=T;var ie=this._mediaDataSource.segments[T],le=this._ioctl=new P.default(ie,this._config,T);le.onError=this._onIOException.bind(this),le.onSeeked=this._onIOSeeked.bind(this),le.onComplete=this._onIOComplete.bind(this),le.onRedirect=this._onIORedirect.bind(this),le.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),Z?this._demuxer.bindDataSource(this._ioctl):le.onDataArrival=this._onInitChunkArrival.bind(this),le.open(Z)},V.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},V.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},V.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},V.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},V.prototype.seek=function(T){if(!(this._mediaInfo==null||!this._mediaInfo.isSeekable())){var Z=this._searchSegmentIndexContains(T);if(Z===this._currentSegmentIndex){var ie=this._mediaInfo.segments[Z];if(ie==null)this._pendingSeekTime=T;else{var le=ie.getNearestKeyframe(T);this._remuxer.seek(le.milliseconds),this._ioctl.seek(le.fileposition),this._pendingResolveSeekPoint=le.milliseconds}}else{var F=this._mediaInfo.segments[Z];if(F==null)this._pendingSeekTime=T,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(Z);else{var le=F.getNearestKeyframe(T);this._internalAbort(),this._remuxer.seek(T),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[Z].timestampBase,this._loadSegment(Z,le.fileposition),this._pendingResolveSeekPoint=le.milliseconds,this._reportSegmentMediaInfo(Z)}}this._enableStatisticsReporter()}},V.prototype._searchSegmentIndexContains=function(T){for(var Z=this._mediaDataSource.segments,ie=Z.length-1,le=0;le<Z.length;le++)if(T<Z[le].timestampBase){ie=le-1;break}return ie},V.prototype._onInitChunkArrival=function(T,Z){var ie=this,le=null,F=0;if(Z>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,F=this._demuxer.parseChunks(T,Z);else if((le=D.default.probe(T)).match){this._demuxer=new D.default(le,this._config),this._remuxer||(this._remuxer=new G.default(this._config));var K=this._mediaDataSource;K.duration!=null&&!isNaN(K.duration)&&(this._demuxer.overridedDuration=K.duration),typeof K.hasAudio=="boolean"&&(this._demuxer.overridedHasAudio=K.hasAudio),typeof K.hasVideo=="boolean"&&(this._demuxer.overridedHasVideo=K.hasVideo),this._demuxer.timestampBase=K.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this),F=this._demuxer.parseChunks(T,Z)}else le=null,w.default.e(this.TAG,"Non-FLV, Unsupported media type!"),Promise.resolve().then(function(){ie._internalAbort()}),this._emitter.emit(H.default.DEMUX_ERROR,z.default.FORMAT_UNSUPPORTED,"Non-FLV, Unsupported media type"),F=0;return F},V.prototype._onMediaInfo=function(T){var Z=this;this._mediaInfo==null&&(this._mediaInfo=Object.assign({},T),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,$.default.prototype));var ie=Object.assign({},T);Object.setPrototypeOf(ie,$.default.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=ie,this._reportSegmentMediaInfo(this._currentSegmentIndex),this._pendingSeekTime!=null&&Promise.resolve().then(function(){var le=Z._pendingSeekTime;Z._pendingSeekTime=null,Z.seek(le)})},V.prototype._onMetaDataArrived=function(T){this._emitter.emit(H.default.METADATA_ARRIVED,T)},V.prototype._onScriptDataArrived=function(T){this._emitter.emit(H.default.SCRIPTDATA_ARRIVED,T)},V.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},V.prototype._onIOComplete=function(T){var Z=T,ie=Z+1;ie<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer.flushStashedSamples(),this._loadSegment(ie)):(this._remuxer.flushStashedSamples(),this._emitter.emit(H.default.LOADING_COMPLETE),this._disableStatisticsReporter())},V.prototype._onIORedirect=function(T){var Z=this._ioctl.extraData;this._mediaDataSource.segments[Z].redirectedURL=T},V.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(H.default.RECOVERED_EARLY_EOF)},V.prototype._onIOException=function(T,Z){w.default.e(this.TAG,"IOException: type = "+T+", code = "+Z.code+", msg = "+Z.msg),this._emitter.emit(H.default.IO_ERROR,T,Z),this._disableStatisticsReporter()},V.prototype._onDemuxException=function(T,Z){w.default.e(this.TAG,"DemuxException: type = "+T+", info = "+Z),this._emitter.emit(H.default.DEMUX_ERROR,T,Z)},V.prototype._onRemuxerInitSegmentArrival=function(T,Z){this._emitter.emit(H.default.INIT_SEGMENT,T,Z)},V.prototype._onRemuxerMediaSegmentArrival=function(T,Z){if(this._pendingSeekTime==null&&(this._emitter.emit(H.default.MEDIA_SEGMENT,T,Z),this._pendingResolveSeekPoint!=null&&T==="video")){var ie=Z.info.syncPoints,le=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,y.default.safari&&ie.length>0&&ie[0].originalDts===le&&(le=ie[0].pts),this._emitter.emit(H.default.RECOMMEND_SEEKPOINT,le)}},V.prototype._enableStatisticsReporter=function(){this._statisticsReporter==null&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},V.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},V.prototype._reportSegmentMediaInfo=function(T){var Z=this._mediaInfo.segments[T],ie=Object.assign({},Z);ie.duration=this._mediaInfo.duration,ie.segmentCount=this._mediaInfo.segmentCount,delete ie.segments,delete ie.keyframesIndex,this._emitter.emit(H.default.MEDIA_INFO,ie)},V.prototype._reportStatisticsInfo=function(){var T={};T.url=this._ioctl.currentURL,T.hasRedirect=this._ioctl.hasRedirect,T.hasRedirect&&(T.redirectedURL=this._ioctl.currentRedirectedURL),T.speed=this._ioctl.currentSpeed,T.loaderType=this._ioctl.loaderType,T.currentSegmentIndex=this._currentSegmentIndex,T.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(H.default.STATISTICS_INFO,T)},V}();ye.default=j},"./src/core/transmuxing-events.js":function(Ee,ye,se){"use strict";se.r(ye);var te={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint"};ye.default=te},"./src/core/transmuxing-worker.js":function(Ee,ye,se){"use strict";se.r(ye);var te=se("./src/utils/logging-control.js"),Q=se("./src/utils/polyfill.js"),w=se("./src/core/transmuxing-controller.js"),y=se("./src/core/transmuxing-events.js"),$=function(G){var z="TransmuxingWorker",P=null,H=De.bind(this);Q.default.install(),G.addEventListener("message",function(Se){switch(Se.data.cmd){case"init":P=new w.default(Se.data.param[0],Se.data.param[1]),P.on(y.default.IO_ERROR,ne.bind(this)),P.on(y.default.DEMUX_ERROR,de.bind(this)),P.on(y.default.INIT_SEGMENT,j.bind(this)),P.on(y.default.MEDIA_SEGMENT,V.bind(this)),P.on(y.default.LOADING_COMPLETE,T.bind(this)),P.on(y.default.RECOVERED_EARLY_EOF,Z.bind(this)),P.on(y.default.MEDIA_INFO,ie.bind(this)),P.on(y.default.METADATA_ARRIVED,le.bind(this)),P.on(y.default.SCRIPTDATA_ARRIVED,F.bind(this)),P.on(y.default.STATISTICS_INFO,K.bind(this)),P.on(y.default.RECOMMEND_SEEKPOINT,ve.bind(this));break;case"destroy":P&&(P.destroy(),P=null),G.postMessage({msg:"destroyed"});break;case"start":P.start();break;case"stop":P.stop();break;case"seek":P.seek(Se.data.param);break;case"pause":P.pause();break;case"resume":P.resume();break;case"logging_config":{var Ce=Se.data.param;te.default.applyConfig(Ce),Ce.enableCallback===!0?te.default.addLogListener(H):te.default.removeLogListener(H);break}}});function j(Se,Ce){var Be={msg:y.default.INIT_SEGMENT,data:{type:Se,data:Ce}};G.postMessage(Be,[Ce.data])}function V(Se,Ce){var Be={msg:y.default.MEDIA_SEGMENT,data:{type:Se,data:Ce}};G.postMessage(Be,[Ce.data])}function T(){var Se={msg:y.default.LOADING_COMPLETE};G.postMessage(Se)}function Z(){var Se={msg:y.default.RECOVERED_EARLY_EOF};G.postMessage(Se)}function ie(Se){var Ce={msg:y.default.MEDIA_INFO,data:Se};G.postMessage(Ce)}function le(Se){var Ce={msg:y.default.METADATA_ARRIVED,data:Se};G.postMessage(Ce)}function F(Se){var Ce={msg:y.default.SCRIPTDATA_ARRIVED,data:Se};G.postMessage(Ce)}function K(Se){var Ce={msg:y.default.STATISTICS_INFO,data:Se};G.postMessage(Ce)}function ne(Se,Ce){G.postMessage({msg:y.default.IO_ERROR,data:{type:Se,info:Ce}})}function de(Se,Ce){G.postMessage({msg:y.default.DEMUX_ERROR,data:{type:Se,info:Ce}})}function ve(Se){G.postMessage({msg:y.default.RECOMMEND_SEEKPOINT,data:Se})}function De(Se,Ce){G.postMessage({msg:"logcat_callback",data:{type:Se,logcat:Ce}})}};ye.default=$},"./src/demux/amf-parser.js":function(Ee,ye,se){"use strict";se.r(ye);var te=se("./src/utils/logger.js"),Q=se("./src/utils/utf8-conv.js"),w=se("./src/utils/exception.js"),y=function(){var D=new ArrayBuffer(2);return new DataView(D).setInt16(0,256,!0),new Int16Array(D)[0]===256}(),$=function(){function D(){}return D.parseScriptData=function(G,z,P){var H={};try{var j=D.parseValue(G,z,P),V=D.parseValue(G,z+j.size,P-j.size);H[j.data]=V.data}catch(T){te.default.e("AMF",T.toString())}return H},D.parseObject=function(G,z,P){if(P<3)throw new w.IllegalStateException("Data not enough when parse ScriptDataObject");var H=D.parseString(G,z,P),j=D.parseValue(G,z+H.size,P-H.size),V=j.objectEnd;return{data:{name:H.data,value:j.data},size:H.size+j.size,objectEnd:V}},D.parseVariable=function(G,z,P){return D.parseObject(G,z,P)},D.parseString=function(G,z,P){if(P<2)throw new w.IllegalStateException("Data not enough when parse String");var H=new DataView(G,z,P),j=H.getUint16(0,!y),V;return j>0?V=(0,Q.default)(new Uint8Array(G,z+2,j)):V="",{data:V,size:2+j}},D.parseLongString=function(G,z,P){if(P<4)throw new w.IllegalStateException("Data not enough when parse LongString");var H=new DataView(G,z,P),j=H.getUint32(0,!y),V;return j>0?V=(0,Q.default)(new Uint8Array(G,z+4,j)):V="",{data:V,size:4+j}},D.parseDate=function(G,z,P){if(P<10)throw new w.IllegalStateException("Data size invalid when parse Date");var H=new DataView(G,z,P),j=H.getFloat64(0,!y),V=H.getInt16(8,!y);return j+=V*60*1e3,{data:new Date(j),size:8+2}},D.parseValue=function(G,z,P){if(P<1)throw new w.IllegalStateException("Data not enough when parse Value");var H=new DataView(G,z,P),j=1,V=H.getUint8(0),T,Z=!1;try{switch(V){case 0:T=H.getFloat64(1,!y),j+=8;break;case 1:{var ie=H.getUint8(1);T=!!ie,j+=1;break}case 2:{var le=D.parseString(G,z+1,P-1);T=le.data,j+=le.size;break}case 3:{T={};var F=0;for((H.getUint32(P-4,!y)&16777215)==9&&(F=3);j<P-4;){var K=D.parseObject(G,z+j,P-j-F);if(K.objectEnd)break;T[K.data.name]=K.data.value,j+=K.size}if(j<=P-3){var ne=H.getUint32(j-1,!y)&16777215;ne===9&&(j+=3)}break}case 8:{T={},j+=4;var F=0;for((H.getUint32(P-4,!y)&16777215)==9&&(F=3);j<P-8;){var de=D.parseVariable(G,z+j,P-j-F);if(de.objectEnd)break;T[de.data.name]=de.data.value,j+=de.size}if(j<=P-3){var ne=H.getUint32(j-1,!y)&16777215;ne===9&&(j+=3)}break}case 9:T=void 0,j=1,Z=!0;break;case 10:{T=[];var ve=H.getUint32(1,!y);j+=4;for(var De=0;De<ve;De++){var Se=D.parseValue(G,z+j,P-j);T.push(Se.data),j+=Se.size}break}case 11:{var Ce=D.parseDate(G,z+1,P-1);T=Ce.data,j+=Ce.size;break}case 12:{var Be=D.parseString(G,z+1,P-1);T=Be.data,j+=Be.size;break}default:j=P,te.default.w("AMF","Unsupported AMF value type "+V)}}catch(ke){te.default.e("AMF",ke.toString())}return{data:T,size:j,objectEnd:Z}},D}();ye.default=$},"./src/demux/demux-errors.js":function(Ee,ye,se){"use strict";se.r(ye);var te={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"};ye.default=te},"./src/demux/exp-golomb.js":function(Ee,ye,se){"use strict";se.r(ye);var te=se("./src/utils/exception.js"),Q=function(){function w(y){this.TAG="ExpGolomb",this._buffer=y,this._buffer_index=0,this._total_bytes=y.byteLength,this._total_bits=y.byteLength*8,this._current_word=0,this._current_word_bits_left=0}return w.prototype.destroy=function(){this._buffer=null},w.prototype._fillCurrentWord=function(){var y=this._total_bytes-this._buffer_index;if(y<=0)throw new te.IllegalStateException("ExpGolomb: _fillCurrentWord() but no bytes available");var $=Math.min(4,y),D=new Uint8Array(4);D.set(this._buffer.subarray(this._buffer_index,this._buffer_index+$)),this._current_word=new DataView(D.buffer).getUint32(0,!1),this._buffer_index+=$,this._current_word_bits_left=$*8},w.prototype.readBits=function(y){if(y>32)throw new te.InvalidArgumentException("ExpGolomb: readBits() bits exceeded max 32bits!");if(y<=this._current_word_bits_left){var $=this._current_word>>>32-y;return this._current_word<<=y,this._current_word_bits_left-=y,$}var D=this._current_word_bits_left?this._current_word:0;D=D>>>32-this._current_word_bits_left;var G=y-this._current_word_bits_left;this._fillCurrentWord();var z=Math.min(G,this._current_word_bits_left),P=this._current_word>>>32-z;return this._current_word<<=z,this._current_word_bits_left-=z,D=D<<z|P,D},w.prototype.readBool=function(){return this.readBits(1)===1},w.prototype.readByte=function(){return this.readBits(8)},w.prototype._skipLeadingZero=function(){var y;for(y=0;y<this._current_word_bits_left;y++)if((this._current_word&2147483648>>>y)!=0)return this._current_word<<=y,this._current_word_bits_left-=y,y;return this._fillCurrentWord(),y+this._skipLeadingZero()},w.prototype.readUEG=function(){var y=this._skipLeadingZero();return this.readBits(y+1)-1},w.prototype.readSEG=function(){var y=this.readUEG();return y&1?y+1>>>1:-1*(y>>>1)},w}();ye.default=Q},"./src/demux/flv-demuxer.js":function(Ee,ye,se){"use strict";se.r(ye);var te=se("./src/utils/logger.js"),Q=se("./src/demux/amf-parser.js"),w=se("./src/demux/sps-parser.js"),y=se("./src/demux/demux-errors.js"),$=se("./src/core/media-info.js"),D=se("./src/utils/exception.js");function G(j){return j>>>8&255|(j&255)<<8}function z(j){return(j&4278190080)>>>24|(j&16711680)>>>8|(j&65280)<<8|(j&255)<<24}function P(j,V){return j[V]<<24|j[V+1]<<16|j[V+2]<<8|j[V+3]}var H=function(){function j(V,T){this.TAG="FLVDemuxer",this._config=T,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=V.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=V.hasAudioTrack,this._hasVideo=V.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new $.default,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var Z=new ArrayBuffer(2);return new DataView(Z).setInt16(0,256,!0),new Int16Array(Z)[0]===256}()}return j.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},j.probe=function(V){var T=new Uint8Array(V),Z={match:!1};if(T[0]!==70||T[1]!==76||T[2]!==86||T[3]!==1)return Z;var ie=(T[4]&4)>>>2!=0,le=(T[4]&1)!=0,F=P(T,5);return F<9?Z:{match:!0,consumed:F,dataOffset:F,hasAudioTrack:ie,hasVideoTrack:le}},j.prototype.bindDataSource=function(V){return V.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(j.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(T){this._onTrackMetadata=T},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(T){this._onMediaInfo=T},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(T){this._onMetaDataArrived=T},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(T){this._onScriptDataArrived=T},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"onError",{get:function(){return this._onError},set:function(T){this._onError=T},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(T){this._onDataAvailable=T},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(T){this._timestampBase=T},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"overridedDuration",{get:function(){return this._duration},set:function(T){this._durationOverrided=!0,this._duration=T,this._mediaInfo.duration=T},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"overridedHasAudio",{set:function(T){this._hasAudioFlagOverrided=!0,this._hasAudio=T,this._mediaInfo.hasAudio=T},enumerable:!1,configurable:!0}),Object.defineProperty(j.prototype,"overridedHasVideo",{set:function(T){this._hasVideoFlagOverrided=!0,this._hasVideo=T,this._mediaInfo.hasVideo=T},enumerable:!1,configurable:!0}),j.prototype.resetMediaInfo=function(){this._mediaInfo=new $.default},j.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!this._hasAudio&&this._hasVideo?this._videoInitialMetadataDispatched:!1},j.prototype.parseChunks=function(V,T){if(!this._onError||!this._onMediaInfo||!this._onTrackMetadata||!this._onDataAvailable)throw new D.IllegalStateException("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var Z=0,ie=this._littleEndian;if(T===0)if(V.byteLength>13){var le=j.probe(V);Z=le.dataOffset}else return 0;if(this._firstParse){this._firstParse=!1,T+Z!==this._dataOffset&&te.default.w(this.TAG,"First time parsing but chunk byteStart invalid!");var F=new DataView(V,Z),K=F.getUint32(0,!ie);K!==0&&te.default.w(this.TAG,"PrevTagSize0 !== 0 !!!"),Z+=4}for(;Z<V.byteLength;){this._dispatch=!0;var F=new DataView(V,Z);if(Z+11+4>V.byteLength)break;var ne=F.getUint8(0),de=F.getUint32(0,!ie)&16777215;if(Z+11+de+4>V.byteLength)break;if(ne!==8&&ne!==9&&ne!==18){te.default.w(this.TAG,"Unsupported tag type "+ne+", skipped"),Z+=11+de+4;continue}var ve=F.getUint8(4),De=F.getUint8(5),Se=F.getUint8(6),Ce=F.getUint8(7),Be=Se|De<<8|ve<<16|Ce<<24,ke=F.getUint32(7,!ie)&16777215;ke!==0&&te.default.w(this.TAG,"Meet tag which has StreamID != 0!");var Ne=Z+11;switch(ne){case 8:this._parseAudioData(V,Ne,de,Be);break;case 9:this._parseVideoData(V,Ne,de,Be,T+Z);break;case 18:this._parseScriptData(V,Ne,de);break}var Re=F.getUint32(11+de,!ie);Re!==11+de&&te.default.w(this.TAG,"Invalid PrevTagSize "+Re),Z+=11+de+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),Z},j.prototype._parseScriptData=function(V,T,Z){var ie=Q.default.parseScriptData(V,T,Z);if(ie.hasOwnProperty("onMetaData")){if(ie.onMetaData==null||typeof ie.onMetaData!="object"){te.default.w(this.TAG,"Invalid onMetaData structure!");return}this._metadata&&te.default.w(this.TAG,"Found another onMetaData tag!"),this._metadata=ie;var le=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},le)),typeof le.hasAudio=="boolean"&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=le.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),typeof le.hasVideo=="boolean"&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=le.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),typeof le.audiodatarate=="number"&&(this._mediaInfo.audioDataRate=le.audiodatarate),typeof le.videodatarate=="number"&&(this._mediaInfo.videoDataRate=le.videodatarate),typeof le.width=="number"&&(this._mediaInfo.width=le.width),typeof le.height=="number"&&(this._mediaInfo.height=le.height),typeof le.duration=="number"){if(!this._durationOverrided){var F=Math.floor(le.duration*this._timescale);this._duration=F,this._mediaInfo.duration=F}}else this._mediaInfo.duration=0;if(typeof le.framerate=="number"){var K=Math.floor(le.framerate*1e3);if(K>0){var ne=K/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=ne,this._referenceFrameRate.fps_num=K,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=ne}}if(typeof le.keyframes=="object"){this._mediaInfo.hasKeyframesIndex=!0;var de=le.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(de),le.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=le,te.default.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(ie).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},ie))},j.prototype._parseKeyframesIndex=function(V){for(var T=[],Z=[],ie=1;ie<V.times.length;ie++){var le=this._timestampBase+Math.floor(V.times[ie]*1e3);T.push(le),Z.push(V.filepositions[ie])}return{times:T,filepositions:Z}},j.prototype._parseAudioData=function(V,T,Z,ie){if(Z<=1){te.default.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");return}if(!(this._hasAudioFlagOverrided===!0&&this._hasAudio===!1)){var le=this._littleEndian,F=new DataView(V,T,Z),K=F.getUint8(0),ne=K>>>4;if(ne!==2&&ne!==10){this._onError(y.default.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+ne);return}var de=0,ve=(K&12)>>>2;if(ve>=0&&ve<=4)de=this._flvSoundRateTable[ve];else{this._onError(y.default.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+ve);return}var De=(K&2)>>>1,Se=K&1,Ce=this._audioMetadata,Be=this._audioTrack;if(Ce||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),Ce=this._audioMetadata={},Ce.type="audio",Ce.id=Be.id,Ce.timescale=this._timescale,Ce.duration=this._duration,Ce.audioSampleRate=de,Ce.channelCount=Se===0?1:2),ne===10){var ke=this._parseAACAudioData(V,T+1,Z-1);if(ke==null)return;if(ke.packetType===0){Ce.config&&te.default.w(this.TAG,"Found another AudioSpecificConfig!");var Ne=ke.data;Ce.audioSampleRate=Ne.samplingRate,Ce.channelCount=Ne.channelCount,Ce.codec=Ne.codec,Ce.originalCodec=Ne.originalCodec,Ce.config=Ne.config,Ce.refSampleDuration=1024/Ce.audioSampleRate*Ce.timescale,te.default.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",Ce);var Re=this._mediaInfo;Re.audioCodec=Ce.originalCodec,Re.audioSampleRate=Ce.audioSampleRate,Re.audioChannelCount=Ce.channelCount,Re.hasVideo?Re.videoCodec!=null&&(Re.mimeType='video/x-flv; codecs="'+Re.videoCodec+","+Re.audioCodec+'"'):Re.mimeType='video/x-flv; codecs="'+Re.audioCodec+'"',Re.isComplete()&&this._onMediaInfo(Re)}else if(ke.packetType===1){var dt=this._timestampBase+ie,wt={unit:ke.data,length:ke.data.byteLength,dts:dt,pts:dt};Be.samples.push(wt),Be.length+=ke.data.length}else te.default.e(this.TAG,"Flv: Unsupported AAC data type "+ke.packetType)}else if(ne===2){if(!Ce.codec){var Ne=this._parseMP3AudioData(V,T+1,Z-1,!0);if(Ne==null)return;Ce.audioSampleRate=Ne.samplingRate,Ce.channelCount=Ne.channelCount,Ce.codec=Ne.codec,Ce.originalCodec=Ne.originalCodec,Ce.refSampleDuration=1152/Ce.audioSampleRate*Ce.timescale,te.default.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",Ce);var Re=this._mediaInfo;Re.audioCodec=Ce.codec,Re.audioSampleRate=Ce.audioSampleRate,Re.audioChannelCount=Ce.channelCount,Re.audioDataRate=Ne.bitRate,Re.hasVideo?Re.videoCodec!=null&&(Re.mimeType='video/x-flv; codecs="'+Re.videoCodec+","+Re.audioCodec+'"'):Re.mimeType='video/x-flv; codecs="'+Re.audioCodec+'"',Re.isComplete()&&this._onMediaInfo(Re)}var It=this._parseMP3AudioData(V,T+1,Z-1,!1);if(It==null)return;var dt=this._timestampBase+ie,nt={unit:It,length:It.byteLength,dts:dt,pts:dt};Be.samples.push(nt),Be.length+=It.length}}},j.prototype._parseAACAudioData=function(V,T,Z){if(Z<=1){te.default.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!");return}var ie={},le=new Uint8Array(V,T,Z);return ie.packetType=le[0],le[0]===0?ie.data=this._parseAACAudioSpecificConfig(V,T+1,Z-1):ie.data=le.subarray(1),ie},j.prototype._parseAACAudioSpecificConfig=function(V,T,Z){var ie=new Uint8Array(V,T,Z),le=null,F=0,K=0,ne=null,de=0,ve=null;if(F=K=ie[0]>>>3,de=(ie[0]&7)<<1|ie[1]>>>7,de<0||de>=this._mpegSamplingRates.length){this._onError(y.default.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");return}var De=this._mpegSamplingRates[de],Se=(ie[1]&120)>>>3;if(Se<0||Se>=8){this._onError(y.default.FORMAT_ERROR,"Flv: AAC invalid channel configuration");return}F===5&&(ve=(ie[1]&7)<<1|ie[2]>>>7,ne=(ie[2]&124)>>>2);var Ce=self.navigator.userAgent.toLowerCase();return Ce.indexOf("firefox")!==-1?de>=6?(F=5,le=new Array(4),ve=de-3):(F=2,le=new Array(2),ve=de):Ce.indexOf("android")!==-1?(F=2,le=new Array(2),ve=de):(F=5,ve=de,le=new Array(4),de>=6?ve=de-3:Se===1&&(F=2,le=new Array(2),ve=de)),le[0]=F<<3,le[0]|=(de&15)>>>1,le[1]=(de&15)<<7,le[1]|=(Se&15)<<3,F===5&&(le[1]|=(ve&15)>>>1,le[2]=(ve&1)<<7,le[2]|=2<<2,le[3]=0),{config:le,samplingRate:De,channelCount:Se,codec:"mp4a.40."+F,originalCodec:"mp4a.40."+K}},j.prototype._parseMP3AudioData=function(V,T,Z,ie){if(Z<4){te.default.w(this.TAG,"Flv: Invalid MP3 packet, header missing!");return}var le=this._littleEndian,F=new Uint8Array(V,T,Z),K=null;if(ie){if(F[0]!==255)return;var ne=F[1]>>>3&3,de=(F[1]&6)>>1,ve=(F[2]&240)>>>4,De=(F[2]&12)>>>2,Se=F[3]>>>6&3,Ce=Se!==3?2:1,Be=0,ke=0,Ne=34,Re="mp3";switch(ne){case 0:Be=this._mpegAudioV25SampleRateTable[De];break;case 2:Be=this._mpegAudioV20SampleRateTable[De];break;case 3:Be=this._mpegAudioV10SampleRateTable[De];break}switch(de){case 1:Ne=34,ve<this._mpegAudioL3BitRateTable.length&&(ke=this._mpegAudioL3BitRateTable[ve]);break;case 2:Ne=33,ve<this._mpegAudioL2BitRateTable.length&&(ke=this._mpegAudioL2BitRateTable[ve]);break;case 3:Ne=32,ve<this._mpegAudioL1BitRateTable.length&&(ke=this._mpegAudioL1BitRateTable[ve]);break}K={bitRate:ke,samplingRate:Be,channelCount:Ce,codec:Re,originalCodec:Re}}else K=F;return K},j.prototype._parseVideoData=function(V,T,Z,ie,le){if(Z<=1){te.default.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");return}if(!(this._hasVideoFlagOverrided===!0&&this._hasVideo===!1)){var F=new Uint8Array(V,T,Z)[0],K=(F&240)>>>4,ne=F&15;if(ne!==7){this._onError(y.default.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+ne);return}this._parseAVCVideoPacket(V,T+1,Z-1,ie,le,K)}},j.prototype._parseAVCVideoPacket=function(V,T,Z,ie,le,F){if(Z<4){te.default.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");return}var K=this._littleEndian,ne=new DataView(V,T,Z),de=ne.getUint8(0),ve=ne.getUint32(0,!K)&16777215,De=ve<<8>>8;if(de===0)this._parseAVCDecoderConfigurationRecord(V,T+4,Z-4);else if(de===1)this._parseAVCVideoData(V,T+4,Z-4,ie,le,F,De);else if(de!==2){this._onError(y.default.FORMAT_ERROR,"Flv: Invalid video packet type "+de);return}},j.prototype._parseAVCDecoderConfigurationRecord=function(V,T,Z){if(Z<7){te.default.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");return}var ie=this._videoMetadata,le=this._videoTrack,F=this._littleEndian,K=new DataView(V,T,Z);ie?typeof ie.avcc!="undefined"&&te.default.w(this.TAG,"Found another AVCDecoderConfigurationRecord!"):(this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),ie=this._videoMetadata={},ie.type="video",ie.id=le.id,ie.timescale=this._timescale,ie.duration=this._duration);var ne=K.getUint8(0),de=K.getUint8(1),ve=K.getUint8(2),De=K.getUint8(3);if(ne!==1||de===0){this._onError(y.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord");return}if(this._naluLengthSize=(K.getUint8(4)&3)+1,this._naluLengthSize!==3&&this._naluLengthSize!==4){this._onError(y.default.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));return}var Se=K.getUint8(5)&31;if(Se===0){this._onError(y.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS");return}else Se>1&&te.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+Se);for(var Ce=6,Be=0;Be<Se;Be++){var ke=K.getUint16(Ce,!F);if(Ce+=2,ke!==0){var Ne=new Uint8Array(V,T+Ce,ke);Ce+=ke;var Re=w.default.parseSPS(Ne);if(Be===0){ie.codecWidth=Re.codec_size.width,ie.codecHeight=Re.codec_size.height,ie.presentWidth=Re.present_size.width,ie.presentHeight=Re.present_size.height,ie.profile=Re.profile_string,ie.level=Re.level_string,ie.bitDepth=Re.bit_depth,ie.chromaFormat=Re.chroma_format,ie.sarRatio=Re.sar_ratio,ie.frameRate=Re.frame_rate,(Re.frame_rate.fixed===!1||Re.frame_rate.fps_num===0||Re.frame_rate.fps_den===0)&&(ie.frameRate=this._referenceFrameRate);var dt=ie.frameRate.fps_den,wt=ie.frameRate.fps_num;ie.refSampleDuration=ie.timescale*(dt/wt);for(var It=Ne.subarray(1,4),nt="avc1.",ot=0;ot<3;ot++){var ti=It[ot].toString(16);ti.length<2&&(ti="0"+ti),nt+=ti}ie.codec=nt;var bt=this._mediaInfo;bt.width=ie.codecWidth,bt.height=ie.codecHeight,bt.fps=ie.frameRate.fps,bt.profile=ie.profile,bt.level=ie.level,bt.refFrames=Re.ref_frames,bt.chromaFormat=Re.chroma_format_string,bt.sarNum=ie.sarRatio.width,bt.sarDen=ie.sarRatio.height,bt.videoCodec=nt,bt.hasAudio?bt.audioCodec!=null&&(bt.mimeType='video/x-flv; codecs="'+bt.videoCodec+","+bt.audioCodec+'"'):bt.mimeType='video/x-flv; codecs="'+bt.videoCodec+'"',bt.isComplete()&&this._onMediaInfo(bt)}}}var Vt=K.getUint8(Ce);if(Vt===0){this._onError(y.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS");return}else Vt>1&&te.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = "+Vt);Ce++;for(var Be=0;Be<Vt;Be++){var ke=K.getUint16(Ce,!F);Ce+=2,ke!==0&&(Ce+=ke)}ie.avcc=new Uint8Array(Z),ie.avcc.set(new Uint8Array(V,T,Z),0),te.default.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",ie)},j.prototype._parseAVCVideoData=function(V,T,Z,ie,le,F,K){for(var ne=this._littleEndian,de=new DataView(V,T,Z),ve=[],De=0,Se=0,Ce=this._naluLengthSize,Be=this._timestampBase+ie,ke=F===1;Se<Z;){if(Se+4>=Z){te.default.w(this.TAG,"Malformed Nalu near timestamp "+Be+", offset = "+Se+", dataSize = "+Z);break}var Ne=de.getUint32(Se,!ne);if(Ce===3&&(Ne>>>=8),Ne>Z-Ce){te.default.w(this.TAG,"Malformed Nalus near timestamp "+Be+", NaluSize > DataSize!");return}var Re=de.getUint8(Se+Ce)&31;Re===5&&(ke=!0);var dt=new Uint8Array(V,T+Se,Ce+Ne),wt={type:Re,data:dt};ve.push(wt),De+=dt.byteLength,Se+=Ce+Ne}if(ve.length){var It=this._videoTrack,nt={units:ve,length:De,isKeyframe:ke,dts:Be,cts:K,pts:Be+K};ke&&(nt.fileposition=le),It.samples.push(nt),It.length+=De}},j}();ye.default=H},"./src/demux/sps-parser.js":function(Ee,ye,se){"use strict";se.r(ye);var te=se("./src/demux/exp-golomb.js"),Q=function(){function w(){}return w._ebsp2rbsp=function(y){for(var $=y,D=$.byteLength,G=new Uint8Array(D),z=0,P=0;P<D;P++)P>=2&&$[P]===3&&$[P-1]===0&&$[P-2]===0||(G[z]=$[P],z++);return new Uint8Array(G.buffer,0,z)},w.parseSPS=function(y){var $=w._ebsp2rbsp(y),D=new te.default($);D.readByte();var G=D.readByte();D.readByte();var z=D.readByte();D.readUEG();var P=w.getProfileString(G),H=w.getLevelString(z),j=1,V=420,T=[0,420,422,444],Z=8;if((G===100||G===110||G===122||G===244||G===44||G===83||G===86||G===118||G===128||G===138||G===144)&&(j=D.readUEG(),j===3&&D.readBits(1),j<=3&&(V=T[j]),Z=D.readUEG()+8,D.readUEG(),D.readBits(1),D.readBool()))for(var ie=j!==3?8:12,le=0;le<ie;le++)D.readBool()&&(le<6?w._skipScalingList(D,16):w._skipScalingList(D,64));D.readUEG();var F=D.readUEG();if(F===0)D.readUEG();else if(F===1){D.readBits(1),D.readSEG(),D.readSEG();for(var K=D.readUEG(),le=0;le<K;le++)D.readSEG()}var ne=D.readUEG();D.readBits(1);var de=D.readUEG(),ve=D.readUEG(),De=D.readBits(1);De===0&&D.readBits(1),D.readBits(1);var Se=0,Ce=0,Be=0,ke=0,Ne=D.readBool();Ne&&(Se=D.readUEG(),Ce=D.readUEG(),Be=D.readUEG(),ke=D.readUEG());var Re=1,dt=1,wt=0,It=!0,nt=0,ot=0,ti=D.readBool();if(ti){if(D.readBool()){var bt=D.readByte(),Vt=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],si=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];bt>0&&bt<16?(Re=Vt[bt-1],dt=si[bt-1]):bt===255&&(Re=D.readByte()<<8|D.readByte(),dt=D.readByte()<<8|D.readByte())}if(D.readBool()&&D.readBool(),D.readBool()&&(D.readBits(4),D.readBool()&&D.readBits(24)),D.readBool()&&(D.readUEG(),D.readUEG()),D.readBool()){var Xt=D.readBits(32),_i=D.readBits(32);It=D.readBool(),nt=_i,ot=Xt*2,wt=nt/ot}}var yi=1;(Re!==1||dt!==1)&&(yi=Re/dt);var xt=0,Qt=0;if(j===0)xt=1,Qt=2-De;else{var li=j===3?1:2,Ki=j===1?2:1;xt=li,Qt=Ki*(2-De)}var Ji=(de+1)*16,$i=(2-De)*((ve+1)*16);Ji-=(Se+Ce)*xt,$i-=(Be+ke)*Qt;var cn=Math.ceil(Ji*yi);return D.destroy(),D=null,{profile_string:P,level_string:H,bit_depth:Z,ref_frames:ne,chroma_format:V,chroma_format_string:w.getChromaFormatString(V),frame_rate:{fixed:It,fps:wt,fps_den:ot,fps_num:nt},sar_ratio:{width:Re,height:dt},codec_size:{width:Ji,height:$i},present_size:{width:cn,height:$i}}},w._skipScalingList=function(y,$){for(var D=8,G=8,z=0,P=0;P<$;P++)G!==0&&(z=y.readSEG(),G=(D+z+256)%256),D=G===0?D:G},w.getProfileString=function(y){switch(y){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},w.getLevelString=function(y){return(y/10).toFixed(1)},w.getChromaFormatString=function(y){switch(y){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},w}();ye.default=Q},"./src/flv.js":function(Ee,ye,se){"use strict";se.r(ye);var te=se("./src/utils/polyfill.js"),Q=se("./src/core/features.js"),w=se("./src/io/loader.js"),y=se("./src/player/flv-player.js"),$=se("./src/player/native-player.js"),D=se("./src/player/player-events.js"),G=se("./src/player/player-errors.js"),z=se("./src/utils/logging-control.js"),P=se("./src/utils/exception.js");te.default.install();function H(Z,ie){var le=Z;if(le==null||typeof le!="object")throw new P.InvalidArgumentException("MediaDataSource must be an javascript object!");if(!le.hasOwnProperty("type"))throw new P.InvalidArgumentException("MediaDataSource must has type field to indicate video file type!");switch(le.type){case"flv":return new y.default(le,ie);default:return new $.default(le,ie)}}function j(){return Q.default.supportMSEH264Playback()}function V(){return Q.default.getFeatureList()}var T={};T.createPlayer=H,T.isSupported=j,T.getFeatureList=V,T.BaseLoader=w.BaseLoader,T.LoaderStatus=w.LoaderStatus,T.LoaderErrors=w.LoaderErrors,T.Events=D.default,T.ErrorTypes=G.ErrorTypes,T.ErrorDetails=G.ErrorDetails,T.FlvPlayer=y.default,T.NativePlayer=$.default,T.LoggingControl=z.default,Object.defineProperty(T,"version",{enumerable:!0,get:function(){return"1.6.2"}}),ye.default=T},"./src/index.js":function(Ee,ye,se){Ee.exports=se("./src/flv.js").default},"./src/io/fetch-stream-loader.js":function(Ee,ye,se){"use strict";se.r(ye);var te=se("./src/utils/browser.js"),Q=se("./src/io/loader.js"),w=se("./src/utils/exception.js"),y=function(){var D=function(z,P){return D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(H,j){H.__proto__=j}||function(H,j){for(var V in j)Object.prototype.hasOwnProperty.call(j,V)&&(H[V]=j[V])},D(z,P)};return function(G,z){if(typeof z!="function"&&z!==null)throw new TypeError("Class extends value "+String(z)+" is not a constructor or null");D(G,z);function P(){this.constructor=G}G.prototype=z===null?Object.create(z):(P.prototype=z.prototype,new P)}}(),$=function(D){y(G,D);function G(z,P){var H=D.call(this,"fetch-stream-loader")||this;return H.TAG="FetchStreamLoader",H._seekHandler=z,H._config=P,H._needStash=!0,H._requestAbort=!1,H._contentLength=null,H._receivedLength=0,H}return G.isSupported=function(){try{var z=te.default.msedge&&te.default.version.minor>=15048,P=te.default.msedge?z:!0;return self.fetch&&self.ReadableStream&&P}catch(H){return!1}},G.prototype.destroy=function(){this.isWorking()&&this.abort(),D.prototype.destroy.call(this)},G.prototype.open=function(z,P){var H=this;this._dataSource=z,this._range=P;var j=z.url;this._config.reuseRedirectedURL&&z.redirectedURL!=null&&(j=z.redirectedURL);var V=this._seekHandler.getConfig(j,P),T=new self.Headers;if(typeof V.headers=="object"){var Z=V.headers;for(var ie in Z)Z.hasOwnProperty(ie)&&T.append(ie,Z[ie])}var le={method:"GET",headers:T,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(typeof this._config.headers=="object")for(var ie in this._config.headers)T.append(ie,this._config.headers[ie]);z.cors===!1&&(le.mode="same-origin"),z.withCredentials&&(le.credentials="include"),z.referrerPolicy&&(le.referrerPolicy=z.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,le.signal=this._abortController.signal),this._status=Q.LoaderStatus.kConnecting,self.fetch(V.url,le).then(function(F){if(H._requestAbort){H._status=Q.LoaderStatus.kIdle,F.body.cancel();return}if(F.ok&&F.status>=200&&F.status<=299){if(F.url!==V.url&&H._onURLRedirect){var K=H._seekHandler.removeURLParameters(F.url);H._onURLRedirect(K)}var ne=F.headers.get("Content-Length");return ne!=null&&(H._contentLength=parseInt(ne),H._contentLength!==0&&H._onContentLengthKnown&&H._onContentLengthKnown(H._contentLength)),H._pump.call(H,F.body.getReader())}else if(H._status=Q.LoaderStatus.kError,H._onError)H._onError(Q.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:F.status,msg:F.statusText});else throw new w.RuntimeException("FetchStreamLoader: Http code invalid, "+F.status+" "+F.statusText)}).catch(function(F){if(!(H._abortController&&H._abortController.signal.aborted))if(H._status=Q.LoaderStatus.kError,H._onError)H._onError(Q.LoaderErrors.EXCEPTION,{code:-1,msg:F.message});else throw F})},G.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==Q.LoaderStatus.kBuffering||!te.default.chrome)&&this._abortController)try{this._abortController.abort()}catch(z){}},G.prototype._pump=function(z){var P=this;return z.read().then(function(H){if(H.done)if(P._contentLength!==null&&P._receivedLength<P._contentLength){P._status=Q.LoaderStatus.kError;var j=Q.LoaderErrors.EARLY_EOF,V={code:-1,msg:"Fetch stream meet Early-EOF"};if(P._onError)P._onError(j,V);else throw new w.RuntimeException(V.msg)}else P._status=Q.LoaderStatus.kComplete,P._onComplete&&P._onComplete(P._range.from,P._range.from+P._receivedLength-1);else{if(P._abortController&&P._abortController.signal.aborted){P._status=Q.LoaderStatus.kComplete;return}else if(P._requestAbort===!0)return P._status=Q.LoaderStatus.kComplete,z.cancel();P._status=Q.LoaderStatus.kBuffering;var T=H.value.buffer,Z=P._range.from+P._receivedLength;P._receivedLength+=T.byteLength,P._onDataArrival&&P._onDataArrival(T,Z,P._receivedLength),P._pump(z)}}).catch(function(H){if(P._abortController&&P._abortController.signal.aborted){P._status=Q.LoaderStatus.kComplete;return}if(!(H.code===11&&te.default.msedge)){P._status=Q.LoaderStatus.kError;var j=0,V=null;if((H.code===19||H.message==="network error")&&(P._contentLength===null||P._contentLength!==null&&P._receivedLength<P._contentLength)?(j=Q.LoaderErrors.EARLY_EOF,V={code:H.code,msg:"Fetch stream meet Early-EOF"}):(j=Q.LoaderErrors.EXCEPTION,V={code:H.code,msg:H.message}),P._onError)P._onError(j,V);else throw new w.RuntimeException(V.msg)}})},G}(Q.BaseLoader);ye.default=$},"./src/io/io-controller.js":function(Ee,ye,se){"use strict";se.r(ye);var te=se("./src/utils/logger.js"),Q=se("./src/io/speed-sampler.js"),w=se("./src/io/loader.js"),y=se("./src/io/fetch-stream-loader.js"),$=se("./src/io/xhr-moz-chunked-loader.js"),D=se("./src/io/xhr-range-loader.js"),G=se("./src/io/websocket-loader.js"),z=se("./src/io/range-seek-handler.js"),P=se("./src/io/param-seek-handler.js"),H=se("./src/utils/exception.js"),j=function(){function V(T,Z,ie){this.TAG="IOController",this._config=Z,this._extraData=ie,this._stashInitialSize=1024*384,Z.stashInitialSize!=null&&Z.stashInitialSize>0&&(this._stashInitialSize=Z.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=1024*1024*3,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,Z.enableStashBuffer===!1&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=T,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(T.url),this._refTotalLength=T.filesize?T.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new Q.default,this._speedNormalizeList=[64,128,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return V.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},V.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},V.prototype.isPaused=function(){return this._paused},Object.defineProperty(V.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"extraData",{get:function(){return this._extraData},set:function(Z){this._extraData=Z},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(Z){this._onDataArrival=Z},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(Z){this._onSeeked=Z},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"onError",{get:function(){return this._onError},set:function(Z){this._onError=Z},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"onComplete",{get:function(){return this._onComplete},set:function(Z){this._onComplete=Z},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(Z){this._onRedirect=Z},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(Z){this._onRecoveredEarlyEof=Z},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"hasRedirect",{get:function(){return this._redirectedURL!=null||this._dataSource.redirectedURL!=null},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"currentSpeed",{get:function(){return this._loaderClass===D.default?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),V.prototype._selectSeekHandler=function(){var T=this._config;if(T.seekType==="range")this._seekHandler=new z.default(this._config.rangeLoadZeroStart);else if(T.seekType==="param"){var Z=T.seekParamStart||"bstart",ie=T.seekParamEnd||"bend";this._seekHandler=new P.default(Z,ie)}else if(T.seekType==="custom"){if(typeof T.customSeekHandler!="function")throw new H.InvalidArgumentException("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new T.customSeekHandler}else throw new H.InvalidArgumentException("Invalid seekType in config: "+T.seekType)},V.prototype._selectLoader=function(){if(this._config.customLoader!=null)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=G.default;else if(y.default.isSupported())this._loaderClass=y.default;else if($.default.isSupported())this._loaderClass=$.default;else if(D.default.isSupported())this._loaderClass=D.default;else throw new H.RuntimeException("Your browser doesn't support xhr with arraybuffer responseType!")},V.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),this._loader.needStashBuffer===!1&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},V.prototype.open=function(T){this._currentRange={from:0,to:-1},T&&(this._currentRange.from=T),this._speedSampler.reset(),T||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},V.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},V.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),this._stashUsed!==0?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},V.prototype.resume=function(){if(this._paused){this._paused=!1;var T=this._resumeFrom;this._resumeFrom=0,this._internalSeek(T,!0)}},V.prototype.seek=function(T){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(T,!0)},V.prototype._internalSeek=function(T,Z){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(Z),this._loader.destroy(),this._loader=null;var ie={from:T,to:-1};this._currentRange={from:ie.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,ie),this._onSeeked&&this._onSeeked()},V.prototype.updateUrl=function(T){if(!T||typeof T!="string"||T.length===0)throw new H.InvalidArgumentException("Url must be a non-empty string!");this._dataSource.url=T},V.prototype._expandBuffer=function(T){for(var Z=this._stashSize;Z+1024*1024*1<T;)Z*=2;if(Z+=1024*1024*1,Z!==this._bufferSize){var ie=new ArrayBuffer(Z);if(this._stashUsed>0){var le=new Uint8Array(this._stashBuffer,0,this._stashUsed),F=new Uint8Array(ie,0,Z);F.set(le,0)}this._stashBuffer=ie,this._bufferSize=Z}},V.prototype._normalizeSpeed=function(T){var Z=this._speedNormalizeList,ie=Z.length-1,le=0,F=0,K=ie;if(T<Z[0])return Z[0];for(;F<=K;){if(le=F+Math.floor((K-F)/2),le===ie||T>=Z[le]&&T<Z[le+1])return Z[le];Z[le]<T?F=le+1:K=le-1}},V.prototype._adjustStashSize=function(T){var Z=0;this._config.isLive||T<512?Z=T:T>=512&&T<=1024?Z=Math.floor(T*1.5):Z=T*2,Z>8192&&(Z=8192);var ie=Z*1024+1024*1024*1;this._bufferSize<ie&&this._expandBuffer(ie),this._stashSize=Z*1024},V.prototype._dispatchChunks=function(T,Z){return this._currentRange.to=Z+T.byteLength-1,this._onDataArrival(T,Z)},V.prototype._onURLRedirect=function(T){this._redirectedURL=T,this._onRedirect&&this._onRedirect(T)},V.prototype._onContentLengthKnown=function(T){T&&this._fullRequestFlag&&(this._totalLength=T,this._fullRequestFlag=!1)},V.prototype._onLoaderChunkArrival=function(T,Z,ie){if(!this._onDataArrival)throw new H.IllegalStateException("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(T.byteLength);var le=this._speedSampler.lastSecondKBps;if(le!==0){var F=this._normalizeSpeed(le);this._speedNormalized!==F&&(this._speedNormalized=F,this._adjustStashSize(F))}if(this._enableStash)if(this._stashUsed===0&&this._stashByteStart===0&&(this._stashByteStart=Z),this._stashUsed+T.byteLength<=this._stashSize){var de=new Uint8Array(this._stashBuffer,0,this._stashSize);de.set(new Uint8Array(T),this._stashUsed),this._stashUsed+=T.byteLength}else{var de=new Uint8Array(this._stashBuffer,0,this._bufferSize);if(this._stashUsed>0){var De=this._stashBuffer.slice(0,this._stashUsed),K=this._dispatchChunks(De,this._stashByteStart);if(K<De.byteLength){if(K>0){var ve=new Uint8Array(De,K);de.set(ve,0),this._stashUsed=ve.byteLength,this._stashByteStart+=K}}else this._stashUsed=0,this._stashByteStart+=K;this._stashUsed+T.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+T.byteLength),de=new Uint8Array(this._stashBuffer,0,this._bufferSize)),de.set(new Uint8Array(T),this._stashUsed),this._stashUsed+=T.byteLength}else{var K=this._dispatchChunks(T,Z);if(K<T.byteLength){var ne=T.byteLength-K;ne>this._bufferSize&&(this._expandBuffer(ne),de=new Uint8Array(this._stashBuffer,0,this._bufferSize)),de.set(new Uint8Array(T,K),0),this._stashUsed+=ne,this._stashByteStart=Z+K}}}else if(this._stashUsed===0){var K=this._dispatchChunks(T,Z);if(K<T.byteLength){var ne=T.byteLength-K;ne>this._bufferSize&&this._expandBuffer(ne);var de=new Uint8Array(this._stashBuffer,0,this._bufferSize);de.set(new Uint8Array(T,K),0),this._stashUsed+=ne,this._stashByteStart=Z+K}}else{this._stashUsed+T.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+T.byteLength);var de=new Uint8Array(this._stashBuffer,0,this._bufferSize);de.set(new Uint8Array(T),this._stashUsed),this._stashUsed+=T.byteLength;var K=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart);if(K<this._stashUsed&&K>0){var ve=new Uint8Array(this._stashBuffer,K);de.set(ve,0)}this._stashUsed-=K,this._stashByteStart+=K}}},V.prototype._flushStashBuffer=function(T){if(this._stashUsed>0){var Z=this._stashBuffer.slice(0,this._stashUsed),ie=this._dispatchChunks(Z,this._stashByteStart),le=Z.byteLength-ie;if(ie<Z.byteLength)if(T)te.default.w(this.TAG,le+" bytes unconsumed data remain when flush buffer, dropped");else{if(ie>0){var F=new Uint8Array(this._stashBuffer,0,this._bufferSize),K=new Uint8Array(Z,ie);F.set(K,0),this._stashUsed=K.byteLength,this._stashByteStart+=ie}return 0}return this._stashUsed=0,this._stashByteStart=0,le}return 0},V.prototype._onLoaderComplete=function(T,Z){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},V.prototype._onLoaderError=function(T,Z){switch(te.default.e(this.TAG,"Loader error, code = "+Z.code+", msg = "+Z.msg),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,T=w.LoaderErrors.UNRECOVERABLE_EARLY_EOF),T){case w.LoaderErrors.EARLY_EOF:{if(!this._config.isLive&&this._totalLength){var ie=this._currentRange.to+1;ie<this._totalLength&&(te.default.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(ie,!1));return}T=w.LoaderErrors.UNRECOVERABLE_EARLY_EOF;break}case w.LoaderErrors.UNRECOVERABLE_EARLY_EOF:case w.LoaderErrors.CONNECTING_TIMEOUT:case w.LoaderErrors.HTTP_STATUS_CODE_INVALID:case w.LoaderErrors.EXCEPTION:break}if(this._onError)this._onError(T,Z);else throw new H.RuntimeException("IOException: "+Z.msg)},V}();ye.default=j},"./src/io/loader.js":function(Ee,ye,se){"use strict";se.r(ye),se.d(ye,{LoaderStatus:function(){return Q},LoaderErrors:function(){return w},BaseLoader:function(){return y}});var te=se("./src/utils/exception.js"),Q={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},w={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},y=function(){function $(D){this._type=D||"undefined",this._status=Q.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return $.prototype.destroy=function(){this._status=Q.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},$.prototype.isWorking=function(){return this._status===Q.kConnecting||this._status===Q.kBuffering},Object.defineProperty($.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(G){this._onContentLengthKnown=G},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(G){this._onURLRedirect=G},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(G){this._onDataArrival=G},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"onError",{get:function(){return this._onError},set:function(G){this._onError=G},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"onComplete",{get:function(){return this._onComplete},set:function(G){this._onComplete=G},enumerable:!1,configurable:!0}),$.prototype.open=function(D,G){throw new te.NotImplementedException("Unimplemented abstract function!")},$.prototype.abort=function(){throw new te.NotImplementedException("Unimplemented abstract function!")},$}()},"./src/io/param-seek-handler.js":function(Ee,ye,se){"use strict";se.r(ye);var te=function(){function Q(w,y){this._startName=w,this._endName=y}return Q.prototype.getConfig=function(w,y){var $=w;if(y.from!==0||y.to!==-1){var D=!0;$.indexOf("?")===-1&&($+="?",D=!1),D&&($+="&"),$+=this._startName+"="+y.from.toString(),y.to!==-1&&($+="&"+this._endName+"="+y.to.toString())}return{url:$,headers:{}}},Q.prototype.removeURLParameters=function(w){var y=w.split("?")[0],$=void 0,D=w.indexOf("?");D!==-1&&($=w.substring(D+1));var G="";if($!=null&&$.length>0)for(var z=$.split("&"),P=0;P<z.length;P++){var H=z[P].split("="),j=P>0;H[0]!==this._startName&&H[0]!==this._endName&&(j&&(G+="&"),G+=z[P])}return G.length===0?y:y+"?"+G},Q}();ye.default=te},"./src/io/range-seek-handler.js":function(Ee,ye,se){"use strict";se.r(ye);var te=function(){function Q(w){this._zeroStart=w||!1}return Q.prototype.getConfig=function(w,y){var $={};if(y.from!==0||y.to!==-1){var D=void 0;y.to!==-1?D="bytes="+y.from.toString()+"-"+y.to.toString():D="bytes="+y.from.toString()+"-",$.Range=D}else this._zeroStart&&($.Range="bytes=0-");return{url:w,headers:$}},Q.prototype.removeURLParameters=function(w){return w},Q}();ye.default=te},"./src/io/speed-sampler.js":function(Ee,ye,se){"use strict";se.r(ye);var te=function(){function Q(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return Q.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},Q.prototype.addBytes=function(w){this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=w,this._totalBytes+=w):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=w,this._totalBytes+=w):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=w,this._totalBytes+=w,this._lastCheckpoint=this._now())},Object.defineProperty(Q.prototype,"currentKBps",{get:function(){this.addBytes(0);var y=(this._now()-this._lastCheckpoint)/1e3;return y==0&&(y=1),this._intervalBytes/y/1024},enumerable:!1,configurable:!0}),Object.defineProperty(Q.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),this._lastSecondBytes!==0?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(Q.prototype,"averageKBps",{get:function(){var y=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/y/1024},enumerable:!1,configurable:!0}),Q}();ye.default=te},"./src/io/websocket-loader.js":function(Ee,ye,se){"use strict";se.r(ye);var te=se("./src/io/loader.js"),Q=se("./src/utils/exception.js"),w=function(){var $=function(G,z){return $=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(P,H){P.__proto__=H}||function(P,H){for(var j in H)Object.prototype.hasOwnProperty.call(H,j)&&(P[j]=H[j])},$(G,z)};return function(D,G){if(typeof G!="function"&&G!==null)throw new TypeError("Class extends value "+String(G)+" is not a constructor or null");$(D,G);function z(){this.constructor=D}D.prototype=G===null?Object.create(G):(z.prototype=G.prototype,new z)}}(),y=function($){w(D,$);function D(){var G=$.call(this,"websocket-loader")||this;return G.TAG="WebSocketLoader",G._needStash=!0,G._ws=null,G._requestAbort=!1,G._receivedLength=0,G}return D.isSupported=function(){try{return typeof self.WebSocket!="undefined"}catch(G){return!1}},D.prototype.destroy=function(){this._ws&&this.abort(),$.prototype.destroy.call(this)},D.prototype.open=function(G){try{var z=this._ws=new self.WebSocket(G.url);z.binaryType="arraybuffer",z.onopen=this._onWebSocketOpen.bind(this),z.onclose=this._onWebSocketClose.bind(this),z.onmessage=this._onWebSocketMessage.bind(this),z.onerror=this._onWebSocketError.bind(this),this._status=te.LoaderStatus.kConnecting}catch(H){this._status=te.LoaderStatus.kError;var P={code:H.code,msg:H.message};if(this._onError)this._onError(te.LoaderErrors.EXCEPTION,P);else throw new Q.RuntimeException(P.msg)}},D.prototype.abort=function(){var G=this._ws;G&&(G.readyState===0||G.readyState===1)&&(this._requestAbort=!0,G.close()),this._ws=null,this._status=te.LoaderStatus.kComplete},D.prototype._onWebSocketOpen=function(G){this._status=te.LoaderStatus.kBuffering},D.prototype._onWebSocketClose=function(G){if(this._requestAbort===!0){this._requestAbort=!1;return}this._status=te.LoaderStatus.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)},D.prototype._onWebSocketMessage=function(G){var z=this;if(G.data instanceof ArrayBuffer)this._dispatchArrayBuffer(G.data);else if(G.data instanceof Blob){var P=new FileReader;P.onload=function(){z._dispatchArrayBuffer(P.result)},P.readAsArrayBuffer(G.data)}else{this._status=te.LoaderStatus.kError;var H={code:-1,msg:"Unsupported WebSocket message type: "+G.data.constructor.name};if(this._onError)this._onError(te.LoaderErrors.EXCEPTION,H);else throw new Q.RuntimeException(H.msg)}},D.prototype._dispatchArrayBuffer=function(G){var z=G,P=this._receivedLength;this._receivedLength+=z.byteLength,this._onDataArrival&&this._onDataArrival(z,P,this._receivedLength)},D.prototype._onWebSocketError=function(G){this._status=te.LoaderStatus.kError;var z={code:G.code,msg:G.message};if(this._onError)this._onError(te.LoaderErrors.EXCEPTION,z);else throw new Q.RuntimeException(z.msg)},D}(te.BaseLoader);ye.default=y},"./src/io/xhr-moz-chunked-loader.js":function(Ee,ye,se){"use strict";se.r(ye);var te=se("./src/utils/logger.js"),Q=se("./src/io/loader.js"),w=se("./src/utils/exception.js"),y=function(){var D=function(z,P){return D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(H,j){H.__proto__=j}||function(H,j){for(var V in j)Object.prototype.hasOwnProperty.call(j,V)&&(H[V]=j[V])},D(z,P)};return function(G,z){if(typeof z!="function"&&z!==null)throw new TypeError("Class extends value "+String(z)+" is not a constructor or null");D(G,z);function P(){this.constructor=G}G.prototype=z===null?Object.create(z):(P.prototype=z.prototype,new P)}}(),$=function(D){y(G,D);function G(z,P){var H=D.call(this,"xhr-moz-chunked-loader")||this;return H.TAG="MozChunkedLoader",H._seekHandler=z,H._config=P,H._needStash=!0,H._xhr=null,H._requestAbort=!1,H._contentLength=null,H._receivedLength=0,H}return G.isSupported=function(){try{var z=new XMLHttpRequest;return z.open("GET","https://example.com",!0),z.responseType="moz-chunked-arraybuffer",z.responseType==="moz-chunked-arraybuffer"}catch(P){return te.default.w("MozChunkedLoader",P.message),!1}},G.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),D.prototype.destroy.call(this)},G.prototype.open=function(z,P){this._dataSource=z,this._range=P;var H=z.url;this._config.reuseRedirectedURL&&z.redirectedURL!=null&&(H=z.redirectedURL);var j=this._seekHandler.getConfig(H,P);this._requestURL=j.url;var V=this._xhr=new XMLHttpRequest;if(V.open("GET",j.url,!0),V.responseType="moz-chunked-arraybuffer",V.onreadystatechange=this._onReadyStateChange.bind(this),V.onprogress=this._onProgress.bind(this),V.onloadend=this._onLoadEnd.bind(this),V.onerror=this._onXhrError.bind(this),z.withCredentials&&(V.withCredentials=!0),typeof j.headers=="object"){var T=j.headers;for(var Z in T)T.hasOwnProperty(Z)&&V.setRequestHeader(Z,T[Z])}if(typeof this._config.headers=="object"){var T=this._config.headers;for(var Z in T)T.hasOwnProperty(Z)&&V.setRequestHeader(Z,T[Z])}this._status=Q.LoaderStatus.kConnecting,V.send()},G.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=Q.LoaderStatus.kComplete},G.prototype._onReadyStateChange=function(z){var P=z.target;if(P.readyState===2){if(P.responseURL!=null&&P.responseURL!==this._requestURL&&this._onURLRedirect){var H=this._seekHandler.removeURLParameters(P.responseURL);this._onURLRedirect(H)}if(P.status!==0&&(P.status<200||P.status>299))if(this._status=Q.LoaderStatus.kError,this._onError)this._onError(Q.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:P.status,msg:P.statusText});else throw new w.RuntimeException("MozChunkedLoader: Http code invalid, "+P.status+" "+P.statusText);else this._status=Q.LoaderStatus.kBuffering}},G.prototype._onProgress=function(z){if(this._status!==Q.LoaderStatus.kError){this._contentLength===null&&z.total!==null&&z.total!==0&&(this._contentLength=z.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var P=z.target.response,H=this._range.from+this._receivedLength;this._receivedLength+=P.byteLength,this._onDataArrival&&this._onDataArrival(P,H,this._receivedLength)}},G.prototype._onLoadEnd=function(z){if(this._requestAbort===!0){this._requestAbort=!1;return}else if(this._status===Q.LoaderStatus.kError)return;this._status=Q.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)},G.prototype._onXhrError=function(z){this._status=Q.LoaderStatus.kError;var P=0,H=null;if(this._contentLength&&z.loaded<this._contentLength?(P=Q.LoaderErrors.EARLY_EOF,H={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(P=Q.LoaderErrors.EXCEPTION,H={code:-1,msg:z.constructor.name+" "+z.type}),this._onError)this._onError(P,H);else throw new w.RuntimeException(H.msg)},G}(Q.BaseLoader);ye.default=$},"./src/io/xhr-range-loader.js":function(Ee,ye,se){"use strict";se.r(ye);var te=se("./src/utils/logger.js"),Q=se("./src/io/speed-sampler.js"),w=se("./src/io/loader.js"),y=se("./src/utils/exception.js"),$=function(){var G=function(P,H){return G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(j,V){j.__proto__=V}||function(j,V){for(var T in V)Object.prototype.hasOwnProperty.call(V,T)&&(j[T]=V[T])},G(P,H)};return function(z,P){if(typeof P!="function"&&P!==null)throw new TypeError("Class extends value "+String(P)+" is not a constructor or null");G(z,P);function H(){this.constructor=z}z.prototype=P===null?Object.create(P):(H.prototype=P.prototype,new H)}}(),D=function(G){$(z,G);function z(P,H){var j=G.call(this,"xhr-range-loader")||this;return j.TAG="RangeLoader",j._seekHandler=P,j._config=H,j._needStash=!1,j._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],j._currentChunkSizeKB=384,j._currentSpeedNormalized=0,j._zeroSpeedChunkCount=0,j._xhr=null,j._speedSampler=new Q.default,j._requestAbort=!1,j._waitForTotalLength=!1,j._totalLengthReceived=!1,j._currentRequestURL=null,j._currentRedirectedURL=null,j._currentRequestRange=null,j._totalLength=null,j._contentLength=null,j._receivedLength=0,j._lastTimeLoaded=0,j}return z.isSupported=function(){try{var P=new XMLHttpRequest;return P.open("GET","https://example.com",!0),P.responseType="arraybuffer",P.responseType==="arraybuffer"}catch(H){return te.default.w("RangeLoader",H.message),!1}},z.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),G.prototype.destroy.call(this)},Object.defineProperty(z.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),z.prototype.open=function(P,H){this._dataSource=P,this._range=H,this._status=w.LoaderStatus.kConnecting;var j=!1;this._dataSource.filesize!=null&&this._dataSource.filesize!==0&&(j=!0,this._totalLength=this._dataSource.filesize),!this._totalLengthReceived&&!j?(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1})):this._openSubRange()},z.prototype._openSubRange=function(){var P=this._currentChunkSizeKB*1024,H=this._range.from+this._receivedLength,j=H+P;this._contentLength!=null&&j-this._range.from>=this._contentLength&&(j=this._range.from+this._contentLength-1),this._currentRequestRange={from:H,to:j},this._internalOpen(this._dataSource,this._currentRequestRange)},z.prototype._internalOpen=function(P,H){this._lastTimeLoaded=0;var j=P.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?j=this._currentRedirectedURL:P.redirectedURL!=null&&(j=P.redirectedURL));var V=this._seekHandler.getConfig(j,H);this._currentRequestURL=V.url;var T=this._xhr=new XMLHttpRequest;if(T.open("GET",V.url,!0),T.responseType="arraybuffer",T.onreadystatechange=this._onReadyStateChange.bind(this),T.onprogress=this._onProgress.bind(this),T.onload=this._onLoad.bind(this),T.onerror=this._onXhrError.bind(this),P.withCredentials&&(T.withCredentials=!0),typeof V.headers=="object"){var Z=V.headers;for(var ie in Z)Z.hasOwnProperty(ie)&&T.setRequestHeader(ie,Z[ie])}if(typeof this._config.headers=="object"){var Z=this._config.headers;for(var ie in Z)Z.hasOwnProperty(ie)&&T.setRequestHeader(ie,Z[ie])}T.send()},z.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=w.LoaderStatus.kComplete},z.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},z.prototype._onReadyStateChange=function(P){var H=P.target;if(H.readyState===2){if(H.responseURL!=null){var j=this._seekHandler.removeURLParameters(H.responseURL);H.responseURL!==this._currentRequestURL&&j!==this._currentRedirectedURL&&(this._currentRedirectedURL=j,this._onURLRedirect&&this._onURLRedirect(j))}if(H.status>=200&&H.status<=299){if(this._waitForTotalLength)return;this._status=w.LoaderStatus.kBuffering}else if(this._status=w.LoaderStatus.kError,this._onError)this._onError(w.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:H.status,msg:H.statusText});else throw new y.RuntimeException("RangeLoader: Http code invalid, "+H.status+" "+H.statusText)}},z.prototype._onProgress=function(P){if(this._status!==w.LoaderStatus.kError){if(this._contentLength===null){var H=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,H=!0;var j=P.total;this._internalAbort(),j!=null&j!==0&&(this._totalLength=j)}if(this._range.to===-1?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,H){this._openSubRange();return}this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var V=P.loaded-this._lastTimeLoaded;this._lastTimeLoaded=P.loaded,this._speedSampler.addBytes(V)}},z.prototype._normalizeSpeed=function(P){var H=this._chunkSizeKBList,j=H.length-1,V=0,T=0,Z=j;if(P<H[0])return H[0];for(;T<=Z;){if(V=T+Math.floor((Z-T)/2),V===j||P>=H[V]&&P<H[V+1])return H[V];H[V]<P?T=V+1:Z=V-1}},z.prototype._onLoad=function(P){if(this._status!==w.LoaderStatus.kError){if(this._waitForTotalLength){this._waitForTotalLength=!1;return}this._lastTimeLoaded=0;var H=this._speedSampler.lastSecondKBps;if(H===0&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(H=this._speedSampler.currentKBps)),H!==0){var j=this._normalizeSpeed(H);this._currentSpeedNormalized!==j&&(this._currentSpeedNormalized=j,this._currentChunkSizeKB=j)}var V=P.target.response,T=this._range.from+this._receivedLength;this._receivedLength+=V.byteLength;var Z=!1;this._contentLength!=null&&this._receivedLength<this._contentLength?this._openSubRange():Z=!0,this._onDataArrival&&this._onDataArrival(V,T,this._receivedLength),Z&&(this._status=w.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},z.prototype._onXhrError=function(P){this._status=w.LoaderStatus.kError;var H=0,j=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(H=w.LoaderErrors.EARLY_EOF,j={code:-1,msg:"RangeLoader meet Early-Eof"}):(H=w.LoaderErrors.EXCEPTION,j={code:-1,msg:P.constructor.name+" "+P.type}),this._onError)this._onError(H,j);else throw new y.RuntimeException(j.msg)},z}(w.BaseLoader);ye.default=D},"./src/player/flv-player.js":function(Ee,ye,se){"use strict";se.r(ye);var te=se("./node_modules/events/events.js"),Q=se.n(te),w=se("./src/utils/logger.js"),y=se("./src/utils/browser.js"),$=se("./src/player/player-events.js"),D=se("./src/core/transmuxer.js"),G=se("./src/core/transmuxing-events.js"),z=se("./src/core/mse-controller.js"),P=se("./src/core/mse-events.js"),H=se("./src/player/player-errors.js"),j=se("./src/config.js"),V=se("./src/utils/exception.js"),T=function(){function Z(ie,le){if(this.TAG="FlvPlayer",this._type="FlvPlayer",this._emitter=new(Q()),this._config=(0,j.createDefaultConfig)(),typeof le=="object"&&Object.assign(this._config,le),ie.type.toLowerCase()!=="flv")throw new V.InvalidArgumentException("FlvPlayer requires an flv MediaDataSource input!");ie.isLive===!0&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=ie,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;var F=y.default.chrome&&(y.default.version.major<50||y.default.version.major===50&&y.default.version.build<2661);this._alwaysSeekKeyframe=!!(F||y.default.msedge||y.default.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}return Z.prototype.destroy=function(){this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},Z.prototype.on=function(ie,le){var F=this;ie===$.default.MEDIA_INFO?this._mediaInfo!=null&&Promise.resolve().then(function(){F._emitter.emit($.default.MEDIA_INFO,F.mediaInfo)}):ie===$.default.STATISTICS_INFO&&this._statisticsInfo!=null&&Promise.resolve().then(function(){F._emitter.emit($.default.STATISTICS_INFO,F.statisticsInfo)}),this._emitter.addListener(ie,le)},Z.prototype.off=function(ie,le){this._emitter.removeListener(ie,le)},Z.prototype.attachMediaElement=function(ie){var le=this;if(this._mediaElement=ie,ie.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),ie.addEventListener("seeking",this.e.onvSeeking),ie.addEventListener("canplay",this.e.onvCanPlay),ie.addEventListener("stalled",this.e.onvStalled),ie.addEventListener("progress",this.e.onvProgress),this._msectl=new z.default(this._config),this._msectl.on(P.default.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(P.default.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(P.default.SOURCE_OPEN,function(){le._mseSourceOpened=!0,le._hasPendingLoad&&(le._hasPendingLoad=!1,le.load())}),this._msectl.on(P.default.ERROR,function(F){le._emitter.emit($.default.ERROR,H.ErrorTypes.MEDIA_ERROR,H.ErrorDetails.MEDIA_MSE_ERROR,F)}),this._msectl.attachMediaElement(ie),this._pendingSeekTime!=null)try{ie.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(F){}},Z.prototype.detachMediaElement=function(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)},Z.prototype.load=function(){var ie=this;if(!this._mediaElement)throw new V.IllegalStateException("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new V.IllegalStateException("FlvPlayer.load() has been called, please call unload() first!");if(!this._hasPendingLoad){if(this._config.deferLoadAfterSourceOpen&&this._mseSourceOpened===!1){this._hasPendingLoad=!0;return}this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new D.default(this._mediaDataSource,this._config),this._transmuxer.on(G.default.INIT_SEGMENT,function(le,F){ie._msectl.appendInitSegment(F)}),this._transmuxer.on(G.default.MEDIA_SEGMENT,function(le,F){if(ie._msectl.appendMediaSegment(F),ie._config.lazyLoad&&!ie._config.isLive){var K=ie._mediaElement.currentTime;F.info.endDts>=(K+ie._config.lazyLoadMaxDuration)*1e3&&ie._progressChecker==null&&(w.default.v(ie.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),ie._suspendTransmuxer())}}),this._transmuxer.on(G.default.LOADING_COMPLETE,function(){ie._msectl.endOfStream(),ie._emitter.emit($.default.LOADING_COMPLETE)}),this._transmuxer.on(G.default.RECOVERED_EARLY_EOF,function(){ie._emitter.emit($.default.RECOVERED_EARLY_EOF)}),this._transmuxer.on(G.default.IO_ERROR,function(le,F){ie._emitter.emit($.default.ERROR,H.ErrorTypes.NETWORK_ERROR,le,F)}),this._transmuxer.on(G.default.DEMUX_ERROR,function(le,F){ie._emitter.emit($.default.ERROR,H.ErrorTypes.MEDIA_ERROR,le,{code:-1,msg:F})}),this._transmuxer.on(G.default.MEDIA_INFO,function(le){ie._mediaInfo=le,ie._emitter.emit($.default.MEDIA_INFO,Object.assign({},le))}),this._transmuxer.on(G.default.METADATA_ARRIVED,function(le){ie._emitter.emit($.default.METADATA_ARRIVED,le)}),this._transmuxer.on(G.default.SCRIPTDATA_ARRIVED,function(le){ie._emitter.emit($.default.SCRIPTDATA_ARRIVED,le)}),this._transmuxer.on(G.default.STATISTICS_INFO,function(le){ie._statisticsInfo=ie._fillStatisticsInfo(le),ie._emitter.emit($.default.STATISTICS_INFO,Object.assign({},ie._statisticsInfo))}),this._transmuxer.on(G.default.RECOMMEND_SEEKPOINT,function(le){ie._mediaElement&&!ie._config.accurateSeek&&(ie._requestSetTime=!0,ie._mediaElement.currentTime=le/1e3)}),this._transmuxer.open()}},Z.prototype.unload=function(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)},Z.prototype.play=function(){return this._mediaElement.play()},Z.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(Z.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(Z.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(Z.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(Z.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(le){this._mediaElement.volume=le},enumerable:!1,configurable:!0}),Object.defineProperty(Z.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(le){this._mediaElement.muted=le},enumerable:!1,configurable:!0}),Object.defineProperty(Z.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(le){this._mediaElement?this._internalSeek(le):this._pendingSeekTime=le},enumerable:!1,configurable:!0}),Object.defineProperty(Z.prototype,"mediaInfo",{get:function(){return Object.assign({},this._mediaInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(Z.prototype,"statisticsInfo",{get:function(){return this._statisticsInfo==null&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)},enumerable:!1,configurable:!0}),Z.prototype._fillStatisticsInfo=function(ie){if(ie.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return ie;var le=!0,F=0,K=0;if(this._mediaElement.getVideoPlaybackQuality){var ne=this._mediaElement.getVideoPlaybackQuality();F=ne.totalVideoFrames,K=ne.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(F=this._mediaElement.webkitDecodedFrameCount,K=this._mediaElement.webkitDroppedFrameCount):le=!1;return le&&(ie.decodedFrames=F,ie.droppedFrames=K),ie},Z.prototype._onmseUpdateEnd=function(){if(!(!this._config.lazyLoad||this._config.isLive)){for(var ie=this._mediaElement.buffered,le=this._mediaElement.currentTime,F=0,K=0,ne=0;ne<ie.length;ne++){var de=ie.start(ne),ve=ie.end(ne);if(de<=le&&le<ve){F=de,K=ve;break}}K>=le+this._config.lazyLoadMaxDuration&&this._progressChecker==null&&(w.default.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}},Z.prototype._onmseBufferFull=function(){w.default.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._progressChecker==null&&this._suspendTransmuxer()},Z.prototype._suspendTransmuxer=function(){this._transmuxer&&(this._transmuxer.pause(),this._progressChecker==null&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))},Z.prototype._checkProgressAndResume=function(){for(var ie=this._mediaElement.currentTime,le=this._mediaElement.buffered,F=!1,K=0;K<le.length;K++){var ne=le.start(K),de=le.end(K);if(ie>=ne&&ie<de){ie>=de-this._config.lazyLoadRecoverDuration&&(F=!0);break}}F&&(window.clearInterval(this._progressChecker),this._progressChecker=null,F&&(w.default.v(this.TAG,"Continue loading from paused position"),this._transmuxer.resume()))},Z.prototype._isTimepointBuffered=function(ie){for(var le=this._mediaElement.buffered,F=0;F<le.length;F++){var K=le.start(F),ne=le.end(F);if(ie>=K&&ie<ne)return!0}return!1},Z.prototype._internalSeek=function(ie){var le=this._isTimepointBuffered(ie),F=!1,K=0;if(ie<1&&this._mediaElement.buffered.length>0){var ne=this._mediaElement.buffered.start(0);(ne<1&&ie<ne||y.default.safari)&&(F=!0,K=y.default.safari?.1:ne)}if(F)this._requestSetTime=!0,this._mediaElement.currentTime=K;else if(le){if(!this._alwaysSeekKeyframe)this._requestSetTime=!0,this._mediaElement.currentTime=ie;else{var de=this._msectl.getNearestKeyframe(Math.floor(ie*1e3));this._requestSetTime=!0,de!=null?this._mediaElement.currentTime=de.dts/1e3:this._mediaElement.currentTime=ie}this._progressChecker!=null&&this._checkProgressAndResume()}else this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(ie),this._transmuxer.seek(Math.floor(ie*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=ie)},Z.prototype._checkAndApplyUnbufferedSeekpoint=function(){if(this._seekpointRecord)if(this._seekpointRecord.recordTime<=this._now()-100){var ie=this._mediaElement.currentTime;this._seekpointRecord=null,this._isTimepointBuffered(ie)||(this._progressChecker!=null&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(ie),this._transmuxer.seek(Math.floor(ie*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=ie))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},Z.prototype._checkAndResumeStuckPlayback=function(ie){var le=this._mediaElement;if(ie||!this._receivedCanPlay||le.readyState<2){var F=le.buffered;F.length>0&&le.currentTime<F.start(0)&&(w.default.w(this.TAG,"Playback seems stuck at "+le.currentTime+", seek to "+F.start(0)),this._requestSetTime=!0,this._mediaElement.currentTime=F.start(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress))}else this._mediaElement.removeEventListener("progress",this.e.onvProgress)},Z.prototype._onvLoadedMetadata=function(ie){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)},Z.prototype._onvSeeking=function(ie){var le=this._mediaElement.currentTime,F=this._mediaElement.buffered;if(this._requestSetTime){this._requestSetTime=!1;return}if(le<1&&F.length>0){var K=F.start(0);if(K<1&&le<K||y.default.safari){this._requestSetTime=!0,this._mediaElement.currentTime=y.default.safari?.1:K;return}}if(this._isTimepointBuffered(le)){if(this._alwaysSeekKeyframe){var ne=this._msectl.getNearestKeyframe(Math.floor(le*1e3));ne!=null&&(this._requestSetTime=!0,this._mediaElement.currentTime=ne.dts/1e3)}this._progressChecker!=null&&this._checkProgressAndResume();return}this._seekpointRecord={seekPoint:le,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},Z.prototype._onvCanPlay=function(ie){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)},Z.prototype._onvStalled=function(ie){this._checkAndResumeStuckPlayback(!0)},Z.prototype._onvProgress=function(ie){this._checkAndResumeStuckPlayback()},Z}();ye.default=T},"./src/player/native-player.js":function(Ee,ye,se){"use strict";se.r(ye);var te=se("./node_modules/events/events.js"),Q=se.n(te),w=se("./src/player/player-events.js"),y=se("./src/config.js"),$=se("./src/utils/exception.js"),D=function(){function G(z,P){if(this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new(Q()),this._config=(0,y.createDefaultConfig)(),typeof P=="object"&&Object.assign(this._config,P),z.type.toLowerCase()==="flv")throw new $.InvalidArgumentException("NativePlayer does't support flv MediaDataSource input!");if(z.hasOwnProperty("segments"))throw new $.InvalidArgumentException("NativePlayer("+z.type+") doesn't support multipart playback!");this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=z,this._mediaElement=null}return G.prototype.destroy=function(){this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},G.prototype.on=function(z,P){var H=this;z===w.default.MEDIA_INFO?this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){H._emitter.emit(w.default.MEDIA_INFO,H.mediaInfo)}):z===w.default.STATISTICS_INFO&&this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){H._emitter.emit(w.default.STATISTICS_INFO,H.statisticsInfo)}),this._emitter.addListener(z,P)},G.prototype.off=function(z,P){this._emitter.removeListener(z,P)},G.prototype.attachMediaElement=function(z){if(this._mediaElement=z,z.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._pendingSeekTime!=null)try{z.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(P){}},G.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},G.prototype.load=function(){if(!this._mediaElement)throw new $.IllegalStateException("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},G.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},G.prototype.play=function(){return this._mediaElement.play()},G.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(G.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(G.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(G.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(G.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(P){this._mediaElement.volume=P},enumerable:!1,configurable:!0}),Object.defineProperty(G.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(P){this._mediaElement.muted=P},enumerable:!1,configurable:!0}),Object.defineProperty(G.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(P){this._mediaElement?this._mediaElement.currentTime=P:this._pendingSeekTime=P},enumerable:!1,configurable:!0}),Object.defineProperty(G.prototype,"mediaInfo",{get:function(){var P=this._mediaElement instanceof HTMLAudioElement?"audio/":"video/",H={mimeType:P+this._mediaDataSource.type};return this._mediaElement&&(H.duration=Math.floor(this._mediaElement.duration*1e3),this._mediaElement instanceof HTMLVideoElement&&(H.width=this._mediaElement.videoWidth,H.height=this._mediaElement.videoHeight)),H},enumerable:!1,configurable:!0}),Object.defineProperty(G.prototype,"statisticsInfo",{get:function(){var P={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return P;var H=!0,j=0,V=0;if(this._mediaElement.getVideoPlaybackQuality){var T=this._mediaElement.getVideoPlaybackQuality();j=T.totalVideoFrames,V=T.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(j=this._mediaElement.webkitDecodedFrameCount,V=this._mediaElement.webkitDroppedFrameCount):H=!1;return H&&(P.decodedFrames=j,P.droppedFrames=V),P},enumerable:!1,configurable:!0}),G.prototype._onvLoadedMetadata=function(z){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(w.default.MEDIA_INFO,this.mediaInfo)},G.prototype._reportStatisticsInfo=function(){this._emitter.emit(w.default.STATISTICS_INFO,this.statisticsInfo)},G}();ye.default=D},"./src/player/player-errors.js":function(Ee,ye,se){"use strict";se.r(ye),se.d(ye,{ErrorTypes:function(){return w},ErrorDetails:function(){return y}});var te=se("./src/io/loader.js"),Q=se("./src/demux/demux-errors.js"),w={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},y={NETWORK_EXCEPTION:te.LoaderErrors.EXCEPTION,NETWORK_STATUS_CODE_INVALID:te.LoaderErrors.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:te.LoaderErrors.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:te.LoaderErrors.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:Q.default.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:Q.default.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:Q.default.CODEC_UNSUPPORTED}},"./src/player/player-events.js":function(Ee,ye,se){"use strict";se.r(ye);var te={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info"};ye.default=te},"./src/remux/aac-silent.js":function(Ee,ye,se){"use strict";se.r(ye);var te=function(){function Q(){}return Q.getSilentFrame=function(w,y){if(w==="mp4a.40.2"){if(y===1)return new Uint8Array([0,200,0,128,35,128]);if(y===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(y===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(y===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(y===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(y===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(y===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(y===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(y===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},Q}();ye.default=te},"./src/remux/mp4-generator.js":function(Ee,ye,se){"use strict";se.r(ye);var te=function(){function Q(){}return Q.init=function(){Q.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[]};for(var w in Q.types)Q.types.hasOwnProperty(w)&&(Q.types[w]=[w.charCodeAt(0),w.charCodeAt(1),w.charCodeAt(2),w.charCodeAt(3)]);var y=Q.constants={};y.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),y.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),y.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),y.STSC=y.STCO=y.STTS,y.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),y.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),y.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),y.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),y.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),y.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},Q.box=function(w){for(var y=8,$=null,D=Array.prototype.slice.call(arguments,1),G=D.length,z=0;z<G;z++)y+=D[z].byteLength;$=new Uint8Array(y),$[0]=y>>>24&255,$[1]=y>>>16&255,$[2]=y>>>8&255,$[3]=y&255,$.set(w,4);for(var P=8,z=0;z<G;z++)$.set(D[z],P),P+=D[z].byteLength;return $},Q.generateInitSegment=function(w){var y=Q.box(Q.types.ftyp,Q.constants.FTYP),$=Q.moov(w),D=new Uint8Array(y.byteLength+$.byteLength);return D.set(y,0),D.set($,y.byteLength),D},Q.moov=function(w){var y=Q.mvhd(w.timescale,w.duration),$=Q.trak(w),D=Q.mvex(w);return Q.box(Q.types.moov,y,$,D)},Q.mvhd=function(w,y){return Q.box(Q.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,w>>>24&255,w>>>16&255,w>>>8&255,w&255,y>>>24&255,y>>>16&255,y>>>8&255,y&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},Q.trak=function(w){return Q.box(Q.types.trak,Q.tkhd(w),Q.mdia(w))},Q.tkhd=function(w){var y=w.id,$=w.duration,D=w.presentWidth,G=w.presentHeight;return Q.box(Q.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,y>>>24&255,y>>>16&255,y>>>8&255,y&255,0,0,0,0,$>>>24&255,$>>>16&255,$>>>8&255,$&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,D>>>8&255,D&255,0,0,G>>>8&255,G&255,0,0]))},Q.mdia=function(w){return Q.box(Q.types.mdia,Q.mdhd(w),Q.hdlr(w),Q.minf(w))},Q.mdhd=function(w){var y=w.timescale,$=w.duration;return Q.box(Q.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,y>>>24&255,y>>>16&255,y>>>8&255,y&255,$>>>24&255,$>>>16&255,$>>>8&255,$&255,85,196,0,0]))},Q.hdlr=function(w){var y=null;return w.type==="audio"?y=Q.constants.HDLR_AUDIO:y=Q.constants.HDLR_VIDEO,Q.box(Q.types.hdlr,y)},Q.minf=function(w){var y=null;return w.type==="audio"?y=Q.box(Q.types.smhd,Q.constants.SMHD):y=Q.box(Q.types.vmhd,Q.constants.VMHD),Q.box(Q.types.minf,y,Q.dinf(),Q.stbl(w))},Q.dinf=function(){var w=Q.box(Q.types.dinf,Q.box(Q.types.dref,Q.constants.DREF));return w},Q.stbl=function(w){var y=Q.box(Q.types.stbl,Q.stsd(w),Q.box(Q.types.stts,Q.constants.STTS),Q.box(Q.types.stsc,Q.constants.STSC),Q.box(Q.types.stsz,Q.constants.STSZ),Q.box(Q.types.stco,Q.constants.STCO));return y},Q.stsd=function(w){return w.type==="audio"?w.codec==="mp3"?Q.box(Q.types.stsd,Q.constants.STSD_PREFIX,Q.mp3(w)):Q.box(Q.types.stsd,Q.constants.STSD_PREFIX,Q.mp4a(w)):Q.box(Q.types.stsd,Q.constants.STSD_PREFIX,Q.avc1(w))},Q.mp3=function(w){var y=w.channelCount,$=w.audioSampleRate,D=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,y,0,16,0,0,0,0,$>>>8&255,$&255,0,0]);return Q.box(Q.types[".mp3"],D)},Q.mp4a=function(w){var y=w.channelCount,$=w.audioSampleRate,D=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,y,0,16,0,0,0,0,$>>>8&255,$&255,0,0]);return Q.box(Q.types.mp4a,D,Q.esds(w))},Q.esds=function(w){var y=w.config||[],$=y.length,D=new Uint8Array([0,0,0,0,3,23+$,0,1,0,4,15+$,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([$]).concat(y).concat([6,1,2]));return Q.box(Q.types.esds,D)},Q.avc1=function(w){var y=w.avcc,$=w.codecWidth,D=w.codecHeight,G=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,$>>>8&255,$&255,D>>>8&255,D&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return Q.box(Q.types.avc1,G,Q.box(Q.types.avcC,y))},Q.mvex=function(w){return Q.box(Q.types.mvex,Q.trex(w))},Q.trex=function(w){var y=w.id,$=new Uint8Array([0,0,0,0,y>>>24&255,y>>>16&255,y>>>8&255,y&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return Q.box(Q.types.trex,$)},Q.moof=function(w,y){return Q.box(Q.types.moof,Q.mfhd(w.sequenceNumber),Q.traf(w,y))},Q.mfhd=function(w){var y=new Uint8Array([0,0,0,0,w>>>24&255,w>>>16&255,w>>>8&255,w&255]);return Q.box(Q.types.mfhd,y)},Q.traf=function(w,y){var $=w.id,D=Q.box(Q.types.tfhd,new Uint8Array([0,0,0,0,$>>>24&255,$>>>16&255,$>>>8&255,$&255])),G=Q.box(Q.types.tfdt,new Uint8Array([0,0,0,0,y>>>24&255,y>>>16&255,y>>>8&255,y&255])),z=Q.sdtp(w),P=Q.trun(w,z.byteLength+16+16+8+16+8+8);return Q.box(Q.types.traf,D,G,P,z)},Q.sdtp=function(w){for(var y=w.samples||[],$=y.length,D=new Uint8Array(4+$),G=0;G<$;G++){var z=y[G].flags;D[G+4]=z.isLeading<<6|z.dependsOn<<4|z.isDependedOn<<2|z.hasRedundancy}return Q.box(Q.types.sdtp,D)},Q.trun=function(w,y){var $=w.samples||[],D=$.length,G=12+16*D,z=new Uint8Array(G);y+=8+G,z.set([0,0,15,1,D>>>24&255,D>>>16&255,D>>>8&255,D&255,y>>>24&255,y>>>16&255,y>>>8&255,y&255],0);for(var P=0;P<D;P++){var H=$[P].duration,j=$[P].size,V=$[P].flags,T=$[P].cts;z.set([H>>>24&255,H>>>16&255,H>>>8&255,H&255,j>>>24&255,j>>>16&255,j>>>8&255,j&255,V.isLeading<<2|V.dependsOn,V.isDependedOn<<6|V.hasRedundancy<<4|V.isNonSync,0,0,T>>>24&255,T>>>16&255,T>>>8&255,T&255],12+16*P)}return Q.box(Q.types.trun,z)},Q.mdat=function(w){return Q.box(Q.types.mdat,w)},Q}();te.init(),ye.default=te},"./src/remux/mp4-remuxer.js":function(Ee,ye,se){"use strict";se.r(ye);var te=se("./src/utils/logger.js"),Q=se("./src/remux/mp4-generator.js"),w=se("./src/remux/aac-silent.js"),y=se("./src/utils/browser.js"),$=se("./src/core/media-segment-info.js"),D=se("./src/utils/exception.js"),G=function(){function z(P){this.TAG="MP4Remuxer",this._config=P,this._isLive=P.isLive===!0,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=Infinity,this._videoDtsBase=Infinity,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new $.MediaSegmentInfoList("audio"),this._videoSegmentInfoList=new $.MediaSegmentInfoList("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!!(y.default.chrome&&(y.default.version.major<50||y.default.version.major===50&&y.default.version.build<2661)),this._fillSilentAfterSeek=y.default.msedge||y.default.msie,this._mp3UseMpegAudio=!y.default.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return z.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},z.prototype.bindDataSource=function(P){return P.onDataAvailable=this.remux.bind(this),P.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(z.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(H){this._onInitSegment=H},enumerable:!1,configurable:!0}),Object.defineProperty(z.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(H){this._onMediaSegment=H},enumerable:!1,configurable:!0}),z.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},z.prototype.seek=function(P){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},z.prototype.remux=function(P,H){if(!this._onMediaSegment)throw new D.IllegalStateException("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(P,H),this._remuxVideo(H),this._remuxAudio(P)},z.prototype._onTrackMetadataReceived=function(P,H){var j=null,V="mp4",T=H.codec;if(P==="audio")this._audioMeta=H,H.codec==="mp3"&&this._mp3UseMpegAudio?(V="mpeg",T="",j=new Uint8Array):j=Q.default.generateInitSegment(H);else if(P==="video")this._videoMeta=H,j=Q.default.generateInitSegment(H);else return;if(!this._onInitSegment)throw new D.IllegalStateException("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(P,{type:P,data:j.buffer,codec:T,container:P+"/"+V,mediaDuration:H.duration})},z.prototype._calculateDtsBase=function(P,H){this._dtsBaseInited||(P.samples&&P.samples.length&&(this._audioDtsBase=P.samples[0].dts),H.samples&&H.samples.length&&(this._videoDtsBase=H.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},z.prototype.flushStashedSamples=function(){var P=this._videoStashedLastSample,H=this._audioStashedLastSample,j={type:"video",id:1,sequenceNumber:0,samples:[],length:0};P!=null&&(j.samples.push(P),j.length=P.length);var V={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};H!=null&&(V.samples.push(H),V.length=H.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(j,!0),this._remuxAudio(V,!0)},z.prototype._remuxAudio=function(P,H){if(this._audioMeta!=null){var j=P,V=j.samples,T=void 0,Z=-1,ie=-1,le=-1,F=this._audioMeta.refSampleDuration,K=this._audioMeta.codec==="mp3"&&this._mp3UseMpegAudio,ne=this._dtsBaseInited&&this._audioNextDts===void 0,de=!1;if(!(!V||V.length===0)&&!(V.length===1&&!H)){var ve=0,De=null,Se=0;K?(ve=0,Se=j.length):(ve=8,Se=8+j.length);var Ce=null;if(V.length>1&&(Ce=V.pop(),Se-=Ce.length),this._audioStashedLastSample!=null){var Be=this._audioStashedLastSample;this._audioStashedLastSample=null,V.unshift(Be),Se+=Be.length}Ce!=null&&(this._audioStashedLastSample=Ce);var ke=V[0].dts-this._dtsBase;if(this._audioNextDts)T=ke-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())T=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&this._audioMeta.originalCodec!=="mp3"&&(de=!0);else{var Ne=this._audioSegmentInfoList.getLastSampleBefore(ke);if(Ne!=null){var Re=ke-(Ne.originalDts+Ne.duration);Re<=3&&(Re=0);var dt=Ne.dts+Ne.duration+Re;T=ke-dt}else T=0}if(de){var wt=ke-T,It=this._videoSegmentInfoList.getLastSegmentBefore(ke);if(It!=null&&It.beginDts<wt){var nt=w.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);if(nt){var ot=It.beginDts,ti=wt-It.beginDts;te.default.v(this.TAG,"InsertPrefixSilentAudio: dts: "+ot+", duration: "+ti),V.unshift({unit:nt,dts:ot,pts:ot}),Se+=nt.byteLength}}else de=!1}for(var bt=[],Vt=0;Vt<V.length;Vt++){var Be=V[Vt],si=Be.unit,Xt=Be.dts-this._dtsBase,ot=Xt,_i=!1,yi=null,xt=0;if(!(Xt<-.001)){if(this._audioMeta.codec!=="mp3"){var Qt=Xt,li=3;if(this._audioNextDts&&(Qt=this._audioNextDts),T=Xt-Qt,T<=-li*F){te.default.w(this.TAG,"Dropping 1 audio frame (originalDts: "+Xt+" ms ,curRefDts: "+Qt+" ms)  due to dtsCorrection: "+T+" ms overlap.");continue}else if(T>=li*F&&this._fillAudioTimestampGap&&!y.default.safari){_i=!0;var Ki=Math.floor(T/F);te.default.w(this.TAG,`Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.
`+("originalDts: "+Xt+" ms, curRefDts: "+Qt+" ms, ")+("dtsCorrection: "+Math.round(T)+" ms, generate: "+Ki+" frames")),ot=Math.floor(Qt),xt=Math.floor(Qt+F)-ot;var nt=w.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);nt==null&&(te.default.w(this.TAG,"Unable to generate silent frame for "+(this._audioMeta.originalCodec+" with "+this._audioMeta.channelCount+" channels, repeat last frame")),nt=si),yi=[];for(var Ji=0;Ji<Ki;Ji++){Qt=Qt+F;var $i=Math.floor(Qt),cn=Math.floor(Qt+F)-$i,sn={dts:$i,pts:$i,cts:0,unit:nt,size:nt.byteLength,duration:cn,originalDts:Xt,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};yi.push(sn),Se+=sn.size}this._audioNextDts=Qt+F}else ot=Math.floor(Qt),xt=Math.floor(Qt+F)-ot,this._audioNextDts=Qt+F}else{if(ot=Xt-T,Vt!==V.length-1){var pt=V[Vt+1].dts-this._dtsBase-T;xt=pt-ot}else if(Ce!=null){var pt=Ce.dts-this._dtsBase-T;xt=pt-ot}else bt.length>=1?xt=bt[bt.length-1].duration:xt=Math.floor(F);this._audioNextDts=ot+xt}Z===-1&&(Z=ot),bt.push({dts:ot,pts:ot,cts:0,unit:Be.unit,size:Be.unit.byteLength,duration:xt,originalDts:Xt,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),_i&&bt.push.apply(bt,yi)}}if(bt.length===0){j.samples=[],j.length=0;return}K?De=new Uint8Array(Se):(De=new Uint8Array(Se),De[0]=Se>>>24&255,De[1]=Se>>>16&255,De[2]=Se>>>8&255,De[3]=Se&255,De.set(Q.default.types.mdat,4));for(var Vt=0;Vt<bt.length;Vt++){var si=bt[Vt].unit;De.set(si,ve),ve+=si.byteLength}var vi=bt[bt.length-1];ie=vi.dts+vi.duration;var xi=new $.MediaSegmentInfo;xi.beginDts=Z,xi.endDts=ie,xi.beginPts=Z,xi.endPts=ie,xi.originalBeginDts=bt[0].originalDts,xi.originalEndDts=vi.originalDts+vi.duration,xi.firstSample=new $.SampleInfo(bt[0].dts,bt[0].pts,bt[0].duration,bt[0].originalDts,!1),xi.lastSample=new $.SampleInfo(vi.dts,vi.pts,vi.duration,vi.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(xi),j.samples=bt,j.sequenceNumber++;var oi=null;K?oi=new Uint8Array:oi=Q.default.moof(j,Z),j.samples=[],j.length=0;var kn={type:"audio",data:this._mergeBoxes(oi,De).buffer,sampleCount:bt.length,info:xi};K&&ne&&(kn.timestampOffset=Z),this._onMediaSegment("audio",kn)}}},z.prototype._remuxVideo=function(P,H){if(this._videoMeta!=null){var j=P,V=j.samples,T=void 0,Z=-1,ie=-1,le=-1,F=-1;if(!(!V||V.length===0)&&!(V.length===1&&!H)){var K=8,ne=null,de=8+P.length,ve=null;if(V.length>1&&(ve=V.pop(),de-=ve.length),this._videoStashedLastSample!=null){var De=this._videoStashedLastSample;this._videoStashedLastSample=null,V.unshift(De),de+=De.length}ve!=null&&(this._videoStashedLastSample=ve);var Se=V[0].dts-this._dtsBase;if(this._videoNextDts)T=Se-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())T=0;else{var Ce=this._videoSegmentInfoList.getLastSampleBefore(Se);if(Ce!=null){var Be=Se-(Ce.originalDts+Ce.duration);Be<=3&&(Be=0);var ke=Ce.dts+Ce.duration+Be;T=Se-ke}else T=0}for(var Ne=new $.MediaSegmentInfo,Re=[],dt=0;dt<V.length;dt++){var De=V[dt],wt=De.dts-this._dtsBase,It=De.isKeyframe,nt=wt-T,ot=De.cts,ti=nt+ot;Z===-1&&(Z=nt,le=ti);var bt=0;if(dt!==V.length-1){var Vt=V[dt+1].dts-this._dtsBase-T;bt=Vt-nt}else if(ve!=null){var Vt=ve.dts-this._dtsBase-T;bt=Vt-nt}else Re.length>=1?bt=Re[Re.length-1].duration:bt=Math.floor(this._videoMeta.refSampleDuration);if(It){var si=new $.SampleInfo(nt,ti,bt,De.dts,!0);si.fileposition=De.fileposition,Ne.appendSyncPoint(si)}Re.push({dts:nt,pts:ti,cts:ot,units:De.units,size:De.length,isKeyframe:It,duration:bt,originalDts:wt,flags:{isLeading:0,dependsOn:It?2:1,isDependedOn:It?1:0,hasRedundancy:0,isNonSync:It?0:1}})}ne=new Uint8Array(de),ne[0]=de>>>24&255,ne[1]=de>>>16&255,ne[2]=de>>>8&255,ne[3]=de&255,ne.set(Q.default.types.mdat,4);for(var dt=0;dt<Re.length;dt++)for(var Xt=Re[dt].units;Xt.length;){var _i=Xt.shift(),yi=_i.data;ne.set(yi,K),K+=yi.byteLength}var xt=Re[Re.length-1];if(ie=xt.dts+xt.duration,F=xt.pts+xt.duration,this._videoNextDts=ie,Ne.beginDts=Z,Ne.endDts=ie,Ne.beginPts=le,Ne.endPts=F,Ne.originalBeginDts=Re[0].originalDts,Ne.originalEndDts=xt.originalDts+xt.duration,Ne.firstSample=new $.SampleInfo(Re[0].dts,Re[0].pts,Re[0].duration,Re[0].originalDts,Re[0].isKeyframe),Ne.lastSample=new $.SampleInfo(xt.dts,xt.pts,xt.duration,xt.originalDts,xt.isKeyframe),this._isLive||this._videoSegmentInfoList.append(Ne),j.samples=Re,j.sequenceNumber++,this._forceFirstIDR){var Qt=Re[0].flags;Qt.dependsOn=2,Qt.isNonSync=0}var li=Q.default.moof(j,Z);j.samples=[],j.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(li,ne).buffer,sampleCount:Re.length,info:Ne})}}},z.prototype._mergeBoxes=function(P,H){var j=new Uint8Array(P.byteLength+H.byteLength);return j.set(P,0),j.set(H,P.byteLength),j},z}();ye.default=G},"./src/utils/browser.js":function(Ee,ye,se){"use strict";se.r(ye);var te={};function Q(){var w=self.navigator.userAgent.toLowerCase(),y=/(edge)\/([\w.]+)/.exec(w)||/(opr)[\/]([\w.]+)/.exec(w)||/(chrome)[ \/]([\w.]+)/.exec(w)||/(iemobile)[\/]([\w.]+)/.exec(w)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(w)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(w)||/(webkit)[ \/]([\w.]+)/.exec(w)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(w)||/(msie) ([\w.]+)/.exec(w)||w.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(w)||w.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(w)||[],$=/(ipad)/.exec(w)||/(ipod)/.exec(w)||/(windows phone)/.exec(w)||/(iphone)/.exec(w)||/(kindle)/.exec(w)||/(android)/.exec(w)||/(windows)/.exec(w)||/(mac)/.exec(w)||/(linux)/.exec(w)||/(cros)/.exec(w)||[],D={browser:y[5]||y[3]||y[1]||"",version:y[2]||y[4]||"0",majorVersion:y[4]||y[2]||"0",platform:$[0]||""},G={};if(D.browser){G[D.browser]=!0;var z=D.majorVersion.split(".");G.version={major:parseInt(D.majorVersion,10),string:D.version},z.length>1&&(G.version.minor=parseInt(z[1],10)),z.length>2&&(G.version.build=parseInt(z[2],10))}if(D.platform&&(G[D.platform]=!0),(G.chrome||G.opr||G.safari)&&(G.webkit=!0),G.rv||G.iemobile){G.rv&&delete G.rv;var P="msie";D.browser=P,G[P]=!0}if(G.edge){delete G.edge;var H="msedge";D.browser=H,G[H]=!0}if(G.opr){var j="opera";D.browser=j,G[j]=!0}if(G.safari&&G.android){var V="android";D.browser=V,G[V]=!0}G.name=D.browser,G.platform=D.platform;for(var T in te)te.hasOwnProperty(T)&&delete te[T];Object.assign(te,G)}Q(),ye.default=te},"./src/utils/exception.js":function(Ee,ye,se){"use strict";se.r(ye),se.d(ye,{RuntimeException:function(){return Q},IllegalStateException:function(){return w},InvalidArgumentException:function(){return y},NotImplementedException:function(){return $}});var te=function(){var D=function(z,P){return D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(H,j){H.__proto__=j}||function(H,j){for(var V in j)Object.prototype.hasOwnProperty.call(j,V)&&(H[V]=j[V])},D(z,P)};return function(G,z){if(typeof z!="function"&&z!==null)throw new TypeError("Class extends value "+String(z)+" is not a constructor or null");D(G,z);function P(){this.constructor=G}G.prototype=z===null?Object.create(z):(P.prototype=z.prototype,new P)}}(),Q=function(){function D(G){this._message=G}return Object.defineProperty(D.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),D.prototype.toString=function(){return this.name+": "+this.message},D}(),w=function(D){te(G,D);function G(z){return D.call(this,z)||this}return Object.defineProperty(G.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),G}(Q),y=function(D){te(G,D);function G(z){return D.call(this,z)||this}return Object.defineProperty(G.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),G}(Q),$=function(D){te(G,D);function G(z){return D.call(this,z)||this}return Object.defineProperty(G.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),G}(Q)},"./src/utils/logger.js":function(Ee,ye,se){"use strict";se.r(ye);var te=se("./node_modules/events/events.js"),Q=se.n(te),w=function(){function y(){}return y.e=function($,D){(!$||y.FORCE_GLOBAL_TAG)&&($=y.GLOBAL_TAG);var G="["+$+"] > "+D;y.ENABLE_CALLBACK&&y.emitter.emit("log","error",G),!!y.ENABLE_ERROR&&(console.error?console.error(G):console.warn?console.warn(G):console.log(G))},y.i=function($,D){(!$||y.FORCE_GLOBAL_TAG)&&($=y.GLOBAL_TAG);var G="["+$+"] > "+D;y.ENABLE_CALLBACK&&y.emitter.emit("log","info",G),!!y.ENABLE_INFO&&(console.info?console.info(G):console.log(G))},y.w=function($,D){(!$||y.FORCE_GLOBAL_TAG)&&($=y.GLOBAL_TAG);var G="["+$+"] > "+D;y.ENABLE_CALLBACK&&y.emitter.emit("log","warn",G),!!y.ENABLE_WARN&&(console.warn?console.warn(G):console.log(G))},y.d=function($,D){(!$||y.FORCE_GLOBAL_TAG)&&($=y.GLOBAL_TAG);var G="["+$+"] > "+D;y.ENABLE_CALLBACK&&y.emitter.emit("log","debug",G),!!y.ENABLE_DEBUG&&(console.debug?console.debug(G):console.log(G))},y.v=function($,D){(!$||y.FORCE_GLOBAL_TAG)&&($=y.GLOBAL_TAG);var G="["+$+"] > "+D;y.ENABLE_CALLBACK&&y.emitter.emit("log","verbose",G),!!y.ENABLE_VERBOSE&&console.log(G)},y}();w.GLOBAL_TAG="flv.js",w.FORCE_GLOBAL_TAG=!1,w.ENABLE_ERROR=!0,w.ENABLE_INFO=!0,w.ENABLE_WARN=!0,w.ENABLE_DEBUG=!0,w.ENABLE_VERBOSE=!0,w.ENABLE_CALLBACK=!1,w.emitter=new(Q()),ye.default=w},"./src/utils/logging-control.js":function(Ee,ye,se){"use strict";se.r(ye);var te=se("./node_modules/events/events.js"),Q=se.n(te),w=se("./src/utils/logger.js"),y=function(){function $(){}return Object.defineProperty($,"forceGlobalTag",{get:function(){return w.default.FORCE_GLOBAL_TAG},set:function(G){w.default.FORCE_GLOBAL_TAG=G,$._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty($,"globalTag",{get:function(){return w.default.GLOBAL_TAG},set:function(G){w.default.GLOBAL_TAG=G,$._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty($,"enableAll",{get:function(){return w.default.ENABLE_VERBOSE&&w.default.ENABLE_DEBUG&&w.default.ENABLE_INFO&&w.default.ENABLE_WARN&&w.default.ENABLE_ERROR},set:function(G){w.default.ENABLE_VERBOSE=G,w.default.ENABLE_DEBUG=G,w.default.ENABLE_INFO=G,w.default.ENABLE_WARN=G,w.default.ENABLE_ERROR=G,$._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty($,"enableDebug",{get:function(){return w.default.ENABLE_DEBUG},set:function(G){w.default.ENABLE_DEBUG=G,$._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty($,"enableVerbose",{get:function(){return w.default.ENABLE_VERBOSE},set:function(G){w.default.ENABLE_VERBOSE=G,$._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty($,"enableInfo",{get:function(){return w.default.ENABLE_INFO},set:function(G){w.default.ENABLE_INFO=G,$._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty($,"enableWarn",{get:function(){return w.default.ENABLE_WARN},set:function(G){w.default.ENABLE_WARN=G,$._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty($,"enableError",{get:function(){return w.default.ENABLE_ERROR},set:function(G){w.default.ENABLE_ERROR=G,$._notifyChange()},enumerable:!1,configurable:!0}),$.getConfig=function(){return{globalTag:w.default.GLOBAL_TAG,forceGlobalTag:w.default.FORCE_GLOBAL_TAG,enableVerbose:w.default.ENABLE_VERBOSE,enableDebug:w.default.ENABLE_DEBUG,enableInfo:w.default.ENABLE_INFO,enableWarn:w.default.ENABLE_WARN,enableError:w.default.ENABLE_ERROR,enableCallback:w.default.ENABLE_CALLBACK}},$.applyConfig=function(D){w.default.GLOBAL_TAG=D.globalTag,w.default.FORCE_GLOBAL_TAG=D.forceGlobalTag,w.default.ENABLE_VERBOSE=D.enableVerbose,w.default.ENABLE_DEBUG=D.enableDebug,w.default.ENABLE_INFO=D.enableInfo,w.default.ENABLE_WARN=D.enableWarn,w.default.ENABLE_ERROR=D.enableError,w.default.ENABLE_CALLBACK=D.enableCallback},$._notifyChange=function(){var D=$.emitter;if(D.listenerCount("change")>0){var G=$.getConfig();D.emit("change",G)}},$.registerListener=function(D){$.emitter.addListener("change",D)},$.removeListener=function(D){$.emitter.removeListener("change",D)},$.addLogListener=function(D){w.default.emitter.addListener("log",D),w.default.emitter.listenerCount("log")>0&&(w.default.ENABLE_CALLBACK=!0,$._notifyChange())},$.removeLogListener=function(D){w.default.emitter.removeListener("log",D),w.default.emitter.listenerCount("log")===0&&(w.default.ENABLE_CALLBACK=!1,$._notifyChange())},$}();y.emitter=new(Q()),ye.default=y},"./src/utils/polyfill.js":function(Ee,ye,se){"use strict";se.r(ye);var te=function(){function Q(){}return Q.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(w,y){return w.__proto__=y,w},Object.assign=Object.assign||function(w){if(w==null)throw new TypeError("Cannot convert undefined or null to object");for(var y=Object(w),$=1;$<arguments.length;$++){var D=arguments[$];if(D!=null)for(var G in D)D.hasOwnProperty(G)&&(y[G]=D[G])}return y},typeof self.Promise!="function"&&se("./node_modules/es6-promise/dist/es6-promise.js").polyfill()},Q}();te.install(),ye.default=te},"./src/utils/utf8-conv.js":function(Ee,ye,se){"use strict";se.r(ye);function te(w,y,$){var D=w;if(y+$<D.length){for(;$--;)if((D[++y]&192)!=128)return!1;return!0}else return!1}function Q(w){for(var y=[],$=w,D=0,G=w.length;D<G;){if($[D]<128){y.push(String.fromCharCode($[D])),++D;continue}else if(!($[D]<192)){if($[D]<224){if(te($,D,1)){var z=($[D]&31)<<6|$[D+1]&63;if(z>=128){y.push(String.fromCharCode(z&65535)),D+=2;continue}}}else if($[D]<240){if(te($,D,2)){var z=($[D]&15)<<12|($[D+1]&63)<<6|$[D+2]&63;if(z>=2048&&(z&63488)!=55296){y.push(String.fromCharCode(z&65535)),D+=3;continue}}}else if($[D]<248&&te($,D,3)){var z=($[D]&7)<<18|($[D+1]&63)<<12|($[D+2]&63)<<6|$[D+3]&63;if(z>65536&&z<1114112){z-=65536,y.push(String.fromCharCode(z>>>10|55296)),y.push(String.fromCharCode(z&1023|56320)),D+=4;continue}}}y.push(String.fromCharCode(65533)),++D}return y.join("")}ye.default=Q}},Ze={};function _e(fe){var Ee=Ze[fe];if(Ee!==void 0)return Ee.exports;var ye=Ze[fe]={exports:{}};return ae[fe].call(ye.exports,ye,ye.exports,_e),ye.exports}_e.m=ae,function(){_e.n=function(fe){var Ee=fe&&fe.__esModule?function(){return fe.default}:function(){return fe};return _e.d(Ee,{a:Ee}),Ee}}(),function(){_e.d=function(fe,Ee){for(var ye in Ee)_e.o(Ee,ye)&&!_e.o(fe,ye)&&Object.defineProperty(fe,ye,{enumerable:!0,get:Ee[ye]})}}(),function(){_e.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(fe){if(typeof window=="object")return window}}()}(),function(){_e.o=function(fe,Ee){return Object.prototype.hasOwnProperty.call(fe,Ee)}}(),function(){_e.r=function(fe){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(fe,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(fe,"__esModule",{value:!0})}}();var tt=_e("./src/index.js");return tt}()})},30232:function(Kt,Mt,ft){"use strict";var lt=ft(60288),ae=function(tt,fe){return fe===void 0&&(fe=!1),function(Ee,ye,se){if(Ee){tt(Ee);return}if(ye.statusCode>=400&&ye.statusCode<=599){var te=se;if(fe)if(lt.TextDecoder){var Q=Ze(ye.headers&&ye.headers["content-type"]);try{te=new TextDecoder(Q).decode(se)}catch(w){}}else te=String.fromCharCode.apply(null,new Uint8Array(se));tt({cause:te});return}tt(null,se)}};function Ze(_e){return _e===void 0&&(_e=""),_e.toLowerCase().split(";").reduce(function(tt,fe){var Ee=fe.split("="),ye=Ee[0],se=Ee[1];return ye.trim()==="charset"?se.trim():tt},"utf-8")}Kt.exports=ae},7441:function(Kt,Mt,ft){"use strict";var lt=ft(60288),ae=ft(61879),Ze=ft(70189);ye.httpHandler=ft(30232);/**
 * @license
 * slighly modified parse-headers 2.0.2 <https://github.com/kesla/parse-headers/>
 * Copyright (c) 2014 David Bjrklund
 * Available under the MIT license
 * <https://github.com/kesla/parse-headers/blob/master/LICENCE>
 */var _e=function(y){var $={};return y&&y.trim().split(`
`).forEach(function(D){var G=D.indexOf(":"),z=D.slice(0,G).trim().toLowerCase(),P=D.slice(G+1).trim();typeof $[z]=="undefined"?$[z]=P:Array.isArray($[z])?$[z].push(P):$[z]=[$[z],P]}),$};Kt.exports=ye,Kt.exports.default=ye,ye.XMLHttpRequest=lt.XMLHttpRequest||Q,ye.XDomainRequest="withCredentials"in new ye.XMLHttpRequest?ye.XMLHttpRequest:lt.XDomainRequest,tt(["get","put","post","patch","head","delete"],function(w){ye[w==="delete"?"del":w]=function(y,$,D){return $=Ee(y,$,D),$.method=w.toUpperCase(),se($)}});function tt(w,y){for(var $=0;$<w.length;$++)y(w[$])}function fe(w){for(var y in w)if(w.hasOwnProperty(y))return!1;return!0}function Ee(w,y,$){var D=w;return Ze(y)?($=y,typeof w=="string"&&(D={uri:w})):D=ae({},y,{uri:w}),D.callback=$,D}function ye(w,y,$){return y=Ee(w,y,$),se(y)}function se(w){if(typeof w.callback=="undefined")throw new Error("callback argument missing");var y=!1,$=function(De,Se,Ce){y||(y=!0,w.callback(De,Se,Ce))};function D(){H.readyState===4&&setTimeout(P,0)}function G(){var ve=void 0;if(H.response?ve=H.response:ve=H.responseText||te(H),K)try{ve=JSON.parse(ve)}catch(De){}return ve}function z(ve){return clearTimeout(ne),ve instanceof Error||(ve=new Error(""+(ve||"Unknown XMLHttpRequest Error"))),ve.statusCode=0,$(ve,de)}function P(){if(!V){var ve;clearTimeout(ne),w.useXDR&&H.status===void 0?ve=200:ve=H.status===1223?204:H.status;var De=de,Se=null;return ve!==0?(De={body:G(),statusCode:ve,method:Z,headers:{},url:T,rawRequest:H},H.getAllResponseHeaders&&(De.headers=_e(H.getAllResponseHeaders()))):Se=new Error("Internal XMLHttpRequest Error"),$(Se,De,De.body)}}var H=w.xhr||null;H||(w.cors||w.useXDR?H=new ye.XDomainRequest:H=new ye.XMLHttpRequest);var j,V,T=H.url=w.uri||w.url,Z=H.method=w.method||"GET",ie=w.body||w.data,le=H.headers=w.headers||{},F=!!w.sync,K=!1,ne,de={body:void 0,headers:{},statusCode:0,method:Z,url:T,rawRequest:H};if("json"in w&&w.json!==!1&&(K=!0,le.accept||le.Accept||(le.Accept="application/json"),Z!=="GET"&&Z!=="HEAD"&&(le["content-type"]||le["Content-Type"]||(le["Content-Type"]="application/json"),ie=JSON.stringify(w.json===!0?ie:w.json))),H.onreadystatechange=D,H.onload=P,H.onerror=z,H.onprogress=function(){},H.onabort=function(){V=!0},H.ontimeout=z,H.open(Z,T,!F,w.username,w.password),F||(H.withCredentials=!!w.withCredentials),!F&&w.timeout>0&&(ne=setTimeout(function(){if(!V){V=!0,H.abort("timeout");var ve=new Error("XMLHttpRequest timeout");ve.code="ETIMEDOUT",z(ve)}},w.timeout)),H.setRequestHeader)for(j in le)le.hasOwnProperty(j)&&H.setRequestHeader(j,le[j]);else if(w.headers&&!fe(w.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in w&&(H.responseType=w.responseType),"beforeSend"in w&&typeof w.beforeSend=="function"&&w.beforeSend(H),H.send(ie||null),H}function te(w){try{if(w.responseType==="document")return w.responseXML;var y=w.responseXML&&w.responseXML.documentElement.nodeName==="parsererror";if(w.responseType===""&&!y)return w.responseXML}catch($){}return null}function Q(){}},18859:function(Kt,Mt){"use strict";function ft(tt,fe,Ee){if(Ee===void 0&&(Ee=Array.prototype),tt&&typeof Ee.find=="function")return Ee.find.call(tt,fe);for(var ye=0;ye<tt.length;ye++)if(Object.prototype.hasOwnProperty.call(tt,ye)){var se=tt[ye];if(fe.call(void 0,se,ye,tt))return se}}function lt(tt,fe){return fe===void 0&&(fe=Object),fe&&typeof fe.freeze=="function"?fe.freeze(tt):tt}function ae(tt,fe){if(tt===null||typeof tt!="object")throw new TypeError("target is not an object");for(var Ee in fe)Object.prototype.hasOwnProperty.call(fe,Ee)&&(tt[Ee]=fe[Ee]);return tt}var Ze=lt({HTML:"text/html",isHTML:function(tt){return tt===Ze.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),_e=lt({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(tt){return tt===_e.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});Mt.assign=ae,Mt.find=ft,Mt.freeze=lt,Mt.MIME_TYPE=Ze,Mt.NAMESPACE=_e},16066:function(Kt,Mt,ft){var lt,ae=ft(18859),Ze=ft(42444),_e=ft(56277),tt=ft(12128),fe=Ze.DOMImplementation,Ee=ae.NAMESPACE,ye=tt.ParseError,se=tt.XMLReader;function te(P){return P.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028]/g,`
`)}function Q(P){this.options=P||{locator:{}}}Q.prototype.parseFromString=function(P,H){var j=this.options,V=new se,T=j.domBuilder||new y,Z=j.errorHandler,ie=j.locator,le=j.xmlns||{},F=/\/x?html?$/.test(H),K=F?_e.HTML_ENTITIES:_e.XML_ENTITIES;ie&&T.setDocumentLocator(ie),V.errorHandler=w(Z,T,ie),V.domBuilder=j.domBuilder||T,F&&(le[""]=Ee.HTML),le.xml=le.xml||Ee.XML;var ne=j.normalizeLineEndings||te;return P&&typeof P=="string"?V.parse(ne(P),le,K):V.errorHandler.error("invalid doc source"),T.doc};function w(P,H,j){if(!P){if(H instanceof y)return H;P=H}var V={},T=P instanceof Function;j=j||{};function Z(ie){var le=P[ie];!le&&T&&(le=P.length==2?function(F){P(ie,F)}:P),V[ie]=le&&function(F){le("[xmldom "+ie+"]	"+F+D(j))}||function(){}}return Z("warning"),Z("error"),Z("fatalError"),V}function y(){this.cdata=!1}function $(P,H){H.lineNumber=P.lineNumber,H.columnNumber=P.columnNumber}y.prototype={startDocument:function(){this.doc=new fe().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(P,H,j,V){var T=this.doc,Z=T.createElementNS(P,j||H),ie=V.length;z(this,Z),this.currentElement=Z,this.locator&&$(this.locator,Z);for(var le=0;le<ie;le++){var P=V.getURI(le),F=V.getValue(le),j=V.getQName(le),K=T.createAttributeNS(P,j);this.locator&&$(V.getLocator(le),K),K.value=K.nodeValue=F,Z.setAttributeNode(K)}},endElement:function(P,H,j){var V=this.currentElement,T=V.tagName;this.currentElement=V.parentNode},startPrefixMapping:function(P,H){},endPrefixMapping:function(P){},processingInstruction:function(P,H){var j=this.doc.createProcessingInstruction(P,H);this.locator&&$(this.locator,j),z(this,j)},ignorableWhitespace:function(P,H,j){},characters:function(P,H,j){if(P=G.apply(this,arguments),P){if(this.cdata)var V=this.doc.createCDATASection(P);else var V=this.doc.createTextNode(P);this.currentElement?this.currentElement.appendChild(V):/^\s*$/.test(P)&&this.doc.appendChild(V),this.locator&&$(this.locator,V)}},skippedEntity:function(P){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(P){(this.locator=P)&&(P.lineNumber=0)},comment:function(P,H,j){P=G.apply(this,arguments);var V=this.doc.createComment(P);this.locator&&$(this.locator,V),z(this,V)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(P,H,j){var V=this.doc.implementation;if(V&&V.createDocumentType){var T=V.createDocumentType(P,H,j);this.locator&&$(this.locator,T),z(this,T),this.doc.doctype=T}},warning:function(P){console.warn("[xmldom warning]	"+P,D(this.locator))},error:function(P){console.error("[xmldom error]	"+P,D(this.locator))},fatalError:function(P){throw new ye(P,this.locator)}};function D(P){if(P)return`
@`+(P.systemId||"")+"#[line:"+P.lineNumber+",col:"+P.columnNumber+"]"}function G(P,H,j){return typeof P=="string"?P.substr(H,j):P.length>=H+j||H?new java.lang.String(P,H,j)+"":P}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(P){y.prototype[P]=function(){return null}});function z(P,H){P.currentElement?P.currentElement.appendChild(H):P.doc.appendChild(H)}lt=y,lt=te,Mt.DOMParser=Q},42444:function(Kt,Mt,ft){var lt=ft(18859),ae=lt.find,Ze=lt.NAMESPACE;function _e(ee){return ee!==""}function tt(ee){return ee?ee.split(/[\t\n\f\r ]+/).filter(_e):[]}function fe(ee,re){return ee.hasOwnProperty(re)||(ee[re]=!0),ee}function Ee(ee){if(!ee)return[];var re=tt(ee);return Object.keys(re.reduce(fe,{}))}function ye(ee){return function(re){return ee&&ee.indexOf(re)!==-1}}function se(ee,re){for(var Te in ee)Object.prototype.hasOwnProperty.call(ee,Te)&&(re[Te]=ee[Te])}function te(ee,re){var Te=ee.prototype;if(!(Te instanceof re)){let mt=function(){};var Ge=mt;mt.prototype=re.prototype,mt=new mt,se(Te,mt),ee.prototype=Te=mt}Te.constructor!=ee&&(typeof ee!="function"&&console.error("unknown Class:"+ee),Te.constructor=ee)}var Q={},w=Q.ELEMENT_NODE=1,y=Q.ATTRIBUTE_NODE=2,$=Q.TEXT_NODE=3,D=Q.CDATA_SECTION_NODE=4,G=Q.ENTITY_REFERENCE_NODE=5,z=Q.ENTITY_NODE=6,P=Q.PROCESSING_INSTRUCTION_NODE=7,H=Q.COMMENT_NODE=8,j=Q.DOCUMENT_NODE=9,V=Q.DOCUMENT_TYPE_NODE=10,T=Q.DOCUMENT_FRAGMENT_NODE=11,Z=Q.NOTATION_NODE=12,ie={},le={},F=ie.INDEX_SIZE_ERR=(le[1]="Index size error",1),K=ie.DOMSTRING_SIZE_ERR=(le[2]="DOMString size error",2),ne=ie.HIERARCHY_REQUEST_ERR=(le[3]="Hierarchy request error",3),de=ie.WRONG_DOCUMENT_ERR=(le[4]="Wrong document",4),ve=ie.INVALID_CHARACTER_ERR=(le[5]="Invalid character",5),De=ie.NO_DATA_ALLOWED_ERR=(le[6]="No data allowed",6),Se=ie.NO_MODIFICATION_ALLOWED_ERR=(le[7]="No modification allowed",7),Ce=ie.NOT_FOUND_ERR=(le[8]="Not found",8),Be=ie.NOT_SUPPORTED_ERR=(le[9]="Not supported",9),ke=ie.INUSE_ATTRIBUTE_ERR=(le[10]="Attribute in use",10),Ne=ie.INVALID_STATE_ERR=(le[11]="Invalid state",11),Re=ie.SYNTAX_ERR=(le[12]="Syntax error",12),dt=ie.INVALID_MODIFICATION_ERR=(le[13]="Invalid modification",13),wt=ie.NAMESPACE_ERR=(le[14]="Invalid namespace",14),It=ie.INVALID_ACCESS_ERR=(le[15]="Invalid access",15);function nt(ee,re){if(re instanceof Error)var Te=re;else Te=this,Error.call(this,le[ee]),this.message=le[ee],Error.captureStackTrace&&Error.captureStackTrace(this,nt);return Te.code=ee,re&&(this.message=this.message+": "+re),Te}nt.prototype=Error.prototype,se(ie,nt);function ot(){}ot.prototype={length:0,item:function(ee){return ee>=0&&ee<this.length?this[ee]:null},toString:function(ee,re){for(var Te=[],Ge=0;Ge<this.length;Ge++)Mn(this[Ge],Te,ee,re);return Te.join("")},filter:function(ee){return Array.prototype.filter.call(this,ee)},indexOf:function(ee){return Array.prototype.indexOf.call(this,ee)}};function ti(ee,re){this._node=ee,this._refresh=re,bt(this)}function bt(ee){var re=ee._node._inc||ee._node.ownerDocument._inc;if(ee._inc!==re){var Te=ee._refresh(ee._node);if(tr(ee,"length",Te.length),!ee.$$length||Te.length<ee.$$length)for(var Ge=Te.length;Ge in ee;Ge++)Object.prototype.hasOwnProperty.call(ee,Ge)&&delete ee[Ge];se(Te,ee),ee._inc=re}}ti.prototype.item=function(ee){return bt(this),this[ee]||null},te(ti,ot);function Vt(){}function si(ee,re){for(var Te=ee.length;Te--;)if(ee[Te]===re)return Te}function Xt(ee,re,Te,Ge){if(Ge?re[si(re,Ge)]=Te:re[re.length++]=Te,ee){Te.ownerElement=ee;var mt=ee.ownerDocument;mt&&(Ge&&$i(mt,ee,Ge),Ji(mt,ee,Te))}}function _i(ee,re,Te){var Ge=si(re,Te);if(Ge>=0){for(var mt=re.length-1;Ge<mt;)re[Ge]=re[++Ge];if(re.length=mt,ee){var Nt=ee.ownerDocument;Nt&&($i(Nt,ee,Te),Te.ownerElement=null)}}else throw new nt(Ce,new Error(ee.tagName+"@"+Te))}Vt.prototype={length:0,item:ot.prototype.item,getNamedItem:function(ee){for(var re=this.length;re--;){var Te=this[re];if(Te.nodeName==ee)return Te}},setNamedItem:function(ee){var re=ee.ownerElement;if(re&&re!=this._ownerElement)throw new nt(ke);var Te=this.getNamedItem(ee.nodeName);return Xt(this._ownerElement,this,ee,Te),Te},setNamedItemNS:function(ee){var re=ee.ownerElement,Te;if(re&&re!=this._ownerElement)throw new nt(ke);return Te=this.getNamedItemNS(ee.namespaceURI,ee.localName),Xt(this._ownerElement,this,ee,Te),Te},removeNamedItem:function(ee){var re=this.getNamedItem(ee);return _i(this._ownerElement,this,re),re},removeNamedItemNS:function(ee,re){var Te=this.getNamedItemNS(ee,re);return _i(this._ownerElement,this,Te),Te},getNamedItemNS:function(ee,re){for(var Te=this.length;Te--;){var Ge=this[Te];if(Ge.localName==re&&Ge.namespaceURI==ee)return Ge}return null}};function yi(){}yi.prototype={hasFeature:function(ee,re){return!0},createDocument:function(ee,re,Te){var Ge=new Ki;if(Ge.implementation=this,Ge.childNodes=new ot,Ge.doctype=Te||null,Te&&Ge.appendChild(Te),re){var mt=Ge.createElementNS(ee,re);Ge.appendChild(mt)}return Ge},createDocumentType:function(ee,re,Te){var Ge=new Bn;return Ge.name=ee,Ge.nodeName=ee,Ge.publicId=re||"",Ge.systemId=Te||"",Ge}};function xt(){}xt.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(ee,re){return Le(this,ee,re)},replaceChild:function(ee,re){Le(this,ee,re,Xe),re&&this.removeChild(re)},removeChild:function(ee){return sn(this,ee)},appendChild:function(ee){return this.insertBefore(ee,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(ee){return hn(this.ownerDocument||this,this,ee)},normalize:function(){for(var ee=this.firstChild;ee;){var re=ee.nextSibling;re&&re.nodeType==$&&ee.nodeType==$?(this.removeChild(re),ee.appendData(re.data)):(ee.normalize(),ee=re)}},isSupported:function(ee,re){return this.ownerDocument.implementation.hasFeature(ee,re)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(ee){for(var re=this;re;){var Te=re._nsMap;if(Te){for(var Ge in Te)if(Object.prototype.hasOwnProperty.call(Te,Ge)&&Te[Ge]===ee)return Ge}re=re.nodeType==y?re.ownerDocument:re.parentNode}return null},lookupNamespaceURI:function(ee){for(var re=this;re;){var Te=re._nsMap;if(Te&&Object.prototype.hasOwnProperty.call(Te,ee))return Te[ee];re=re.nodeType==y?re.ownerDocument:re.parentNode}return null},isDefaultNamespace:function(ee){var re=this.lookupPrefix(ee);return re==null}};function Qt(ee){return ee=="<"&&"&lt;"||ee==">"&&"&gt;"||ee=="&"&&"&amp;"||ee=='"'&&"&quot;"||"&#"+ee.charCodeAt()+";"}se(Q,xt),se(Q,xt.prototype);function li(ee,re){if(re(ee))return!0;if(ee=ee.firstChild)do if(li(ee,re))return!0;while(ee=ee.nextSibling)}function Ki(){this.ownerDocument=this}function Ji(ee,re,Te){ee&&ee._inc++;var Ge=Te.namespaceURI;Ge===Ze.XMLNS&&(re._nsMap[Te.prefix?Te.localName:""]=Te.value)}function $i(ee,re,Te,Ge){ee&&ee._inc++;var mt=Te.namespaceURI;mt===Ze.XMLNS&&delete re._nsMap[Te.prefix?Te.localName:""]}function cn(ee,re,Te){if(ee&&ee._inc){ee._inc++;var Ge=re.childNodes;if(Te)Ge[Ge.length++]=Te;else{for(var mt=re.firstChild,Nt=0;mt;)Ge[Nt++]=mt,mt=mt.nextSibling;Ge.length=Nt,delete Ge[Ge.length]}}}function sn(ee,re){var Te=re.previousSibling,Ge=re.nextSibling;return Te?Te.nextSibling=Ge:ee.firstChild=Ge,Ge?Ge.previousSibling=Te:ee.lastChild=Te,re.parentNode=null,re.previousSibling=null,re.nextSibling=null,cn(ee.ownerDocument,ee),re}function pt(ee){return ee&&(ee.nodeType===xt.DOCUMENT_NODE||ee.nodeType===xt.DOCUMENT_FRAGMENT_NODE||ee.nodeType===xt.ELEMENT_NODE)}function vi(ee){return ee&&(oi(ee)||kn(ee)||xi(ee)||ee.nodeType===xt.DOCUMENT_FRAGMENT_NODE||ee.nodeType===xt.COMMENT_NODE||ee.nodeType===xt.PROCESSING_INSTRUCTION_NODE)}function xi(ee){return ee&&ee.nodeType===xt.DOCUMENT_TYPE_NODE}function oi(ee){return ee&&ee.nodeType===xt.ELEMENT_NODE}function kn(ee){return ee&&ee.nodeType===xt.TEXT_NODE}function Gr(ee,re){var Te=ee.childNodes||[];if(ae(Te,oi)||xi(re))return!1;var Ge=ae(Te,xi);return!(re&&Ge&&Te.indexOf(Ge)>Te.indexOf(re))}function Is(ee,re){var Te=ee.childNodes||[];function Ge(Nt){return oi(Nt)&&Nt!==re}if(ae(Te,Ge))return!1;var mt=ae(Te,xi);return!(re&&mt&&Te.indexOf(mt)>Te.indexOf(re))}function Zi(ee,re,Te){if(!pt(ee))throw new nt(ne,"Unexpected parent node type "+ee.nodeType);if(Te&&Te.parentNode!==ee)throw new nt(Ce,"child not in parent");if(!vi(re)||xi(re)&&ee.nodeType!==xt.DOCUMENT_NODE)throw new nt(ne,"Unexpected node type "+re.nodeType+" for parent node type "+ee.nodeType)}function Tn(ee,re,Te){var Ge=ee.childNodes||[],mt=re.childNodes||[];if(re.nodeType===xt.DOCUMENT_FRAGMENT_NODE){var Nt=mt.filter(oi);if(Nt.length>1||ae(mt,kn))throw new nt(ne,"More than one element or text in fragment");if(Nt.length===1&&!Gr(ee,Te))throw new nt(ne,"Element in fragment can not be inserted before doctype")}if(oi(re)&&!Gr(ee,Te))throw new nt(ne,"Only one element can be added and only after doctype");if(xi(re)){if(ae(Ge,xi))throw new nt(ne,"Only one doctype is allowed");var Ai=ae(Ge,oi);if(Te&&Ge.indexOf(Ai)<Ge.indexOf(Te))throw new nt(ne,"Doctype can only be inserted before an element");if(!Te&&Ai)throw new nt(ne,"Doctype can not be appended since element is present")}}function Xe(ee,re,Te){var Ge=ee.childNodes||[],mt=re.childNodes||[];if(re.nodeType===xt.DOCUMENT_FRAGMENT_NODE){var Nt=mt.filter(oi);if(Nt.length>1||ae(mt,kn))throw new nt(ne,"More than one element or text in fragment");if(Nt.length===1&&!Is(ee,Te))throw new nt(ne,"Element in fragment can not be inserted before doctype")}if(oi(re)&&!Is(ee,Te))throw new nt(ne,"Only one element can be added and only after doctype");if(xi(re)){let zi=function(gn){return xi(gn)&&gn!==Te};var mi=zi;if(ae(Ge,zi))throw new nt(ne,"Only one doctype is allowed");var Ai=ae(Ge,oi);if(Te&&Ge.indexOf(Ai)<Ge.indexOf(Te))throw new nt(ne,"Doctype can only be inserted before an element")}}function Le(ee,re,Te,Ge){Zi(ee,re,Te),ee.nodeType===xt.DOCUMENT_NODE&&(Ge||Tn)(ee,re,Te);var mt=re.parentNode;if(mt&&mt.removeChild(re),re.nodeType===T){var Nt=re.firstChild;if(Nt==null)return re;var Ai=re.lastChild}else Nt=Ai=re;var mi=Te?Te.previousSibling:ee.lastChild;Nt.previousSibling=mi,Ai.nextSibling=Te,mi?mi.nextSibling=Nt:ee.firstChild=Nt,Te==null?ee.lastChild=Ai:Te.previousSibling=Ai;do Nt.parentNode=ee;while(Nt!==Ai&&(Nt=Nt.nextSibling));return cn(ee.ownerDocument||ee,ee),re.nodeType==T&&(re.firstChild=re.lastChild=null),re}function ht(ee,re){return re.parentNode&&re.parentNode.removeChild(re),re.parentNode=ee,re.previousSibling=ee.lastChild,re.nextSibling=null,re.previousSibling?re.previousSibling.nextSibling=re:ee.firstChild=re,ee.lastChild=re,cn(ee.ownerDocument,ee,re),re}Ki.prototype={nodeName:"#document",nodeType:j,doctype:null,documentElement:null,_inc:1,insertBefore:function(ee,re){if(ee.nodeType==T){for(var Te=ee.firstChild;Te;){var Ge=Te.nextSibling;this.insertBefore(Te,re),Te=Ge}return ee}return Le(this,ee,re),ee.ownerDocument=this,this.documentElement===null&&ee.nodeType===w&&(this.documentElement=ee),ee},removeChild:function(ee){return this.documentElement==ee&&(this.documentElement=null),sn(this,ee)},replaceChild:function(ee,re){Le(this,ee,re,Xe),ee.ownerDocument=this,re&&this.removeChild(re),oi(ee)&&(this.documentElement=ee)},importNode:function(ee,re){return ea(this,ee,re)},getElementById:function(ee){var re=null;return li(this.documentElement,function(Te){if(Te.nodeType==w&&Te.getAttribute("id")==ee)return re=Te,!0}),re},getElementsByClassName:function(ee){var re=Ee(ee);return new ti(this,function(Te){var Ge=[];return re.length>0&&li(Te.documentElement,function(mt){if(mt!==Te&&mt.nodeType===w){var Nt=mt.getAttribute("class");if(Nt){var Ai=ee===Nt;if(!Ai){var mi=Ee(Nt);Ai=re.every(ye(mi))}Ai&&Ge.push(mt)}}}),Ge})},createElement:function(ee){var re=new Rt;re.ownerDocument=this,re.nodeName=ee,re.tagName=ee,re.localName=ee,re.childNodes=new ot;var Te=re.attributes=new Vt;return Te._ownerElement=re,re},createDocumentFragment:function(){var ee=new pr;return ee.ownerDocument=this,ee.childNodes=new ot,ee},createTextNode:function(ee){var re=new ii;return re.ownerDocument=this,re.appendData(ee),re},createComment:function(ee){var re=new mn;return re.ownerDocument=this,re.appendData(ee),re},createCDATASection:function(ee){var re=new Ut;return re.ownerDocument=this,re.appendData(ee),re},createProcessingInstruction:function(ee,re){var Te=new Ri;return Te.ownerDocument=this,Te.tagName=Te.nodeName=Te.target=ee,Te.nodeValue=Te.data=re,Te},createAttribute:function(ee){var re=new Lt;return re.ownerDocument=this,re.name=ee,re.nodeName=ee,re.localName=ee,re.specified=!0,re},createEntityReference:function(ee){var re=new qr;return re.ownerDocument=this,re.nodeName=ee,re},createElementNS:function(ee,re){var Te=new Rt,Ge=re.split(":"),mt=Te.attributes=new Vt;return Te.childNodes=new ot,Te.ownerDocument=this,Te.nodeName=re,Te.tagName=re,Te.namespaceURI=ee,Ge.length==2?(Te.prefix=Ge[0],Te.localName=Ge[1]):Te.localName=re,mt._ownerElement=Te,Te},createAttributeNS:function(ee,re){var Te=new Lt,Ge=re.split(":");return Te.ownerDocument=this,Te.nodeName=re,Te.name=re,Te.namespaceURI=ee,Te.specified=!0,Ge.length==2?(Te.prefix=Ge[0],Te.localName=Ge[1]):Te.localName=re,Te}},te(Ki,xt);function Rt(){this._nsMap={}}Rt.prototype={nodeType:w,hasAttribute:function(ee){return this.getAttributeNode(ee)!=null},getAttribute:function(ee){var re=this.getAttributeNode(ee);return re&&re.value||""},getAttributeNode:function(ee){return this.attributes.getNamedItem(ee)},setAttribute:function(ee,re){var Te=this.ownerDocument.createAttribute(ee);Te.value=Te.nodeValue=""+re,this.setAttributeNode(Te)},removeAttribute:function(ee){var re=this.getAttributeNode(ee);re&&this.removeAttributeNode(re)},appendChild:function(ee){return ee.nodeType===T?this.insertBefore(ee,null):ht(this,ee)},setAttributeNode:function(ee){return this.attributes.setNamedItem(ee)},setAttributeNodeNS:function(ee){return this.attributes.setNamedItemNS(ee)},removeAttributeNode:function(ee){return this.attributes.removeNamedItem(ee.nodeName)},removeAttributeNS:function(ee,re){var Te=this.getAttributeNodeNS(ee,re);Te&&this.removeAttributeNode(Te)},hasAttributeNS:function(ee,re){return this.getAttributeNodeNS(ee,re)!=null},getAttributeNS:function(ee,re){var Te=this.getAttributeNodeNS(ee,re);return Te&&Te.value||""},setAttributeNS:function(ee,re,Te){var Ge=this.ownerDocument.createAttributeNS(ee,re);Ge.value=Ge.nodeValue=""+Te,this.setAttributeNode(Ge)},getAttributeNodeNS:function(ee,re){return this.attributes.getNamedItemNS(ee,re)},getElementsByTagName:function(ee){return new ti(this,function(re){var Te=[];return li(re,function(Ge){Ge!==re&&Ge.nodeType==w&&(ee==="*"||Ge.tagName==ee)&&Te.push(Ge)}),Te})},getElementsByTagNameNS:function(ee,re){return new ti(this,function(Te){var Ge=[];return li(Te,function(mt){mt!==Te&&mt.nodeType===w&&(ee==="*"||mt.namespaceURI===ee)&&(re==="*"||mt.localName==re)&&Ge.push(mt)}),Ge})}},Ki.prototype.getElementsByTagName=Rt.prototype.getElementsByTagName,Ki.prototype.getElementsByTagNameNS=Rt.prototype.getElementsByTagNameNS,te(Rt,xt);function Lt(){}Lt.prototype.nodeType=y,te(Lt,xt);function Tt(){}Tt.prototype={data:"",substringData:function(ee,re){return this.data.substring(ee,ee+re)},appendData:function(ee){ee=this.data+ee,this.nodeValue=this.data=ee,this.length=ee.length},insertData:function(ee,re){this.replaceData(ee,0,re)},appendChild:function(ee){throw new Error(le[ne])},deleteData:function(ee,re){this.replaceData(ee,re,"")},replaceData:function(ee,re,Te){var Ge=this.data.substring(0,ee),mt=this.data.substring(ee+re);Te=Ge+Te+mt,this.nodeValue=this.data=Te,this.length=Te.length}},te(Tt,xt);function ii(){}ii.prototype={nodeName:"#text",nodeType:$,splitText:function(ee){var re=this.data,Te=re.substring(ee);re=re.substring(0,ee),this.data=this.nodeValue=re,this.length=re.length;var Ge=this.ownerDocument.createTextNode(Te);return this.parentNode&&this.parentNode.insertBefore(Ge,this.nextSibling),Ge}},te(ii,Tt);function mn(){}mn.prototype={nodeName:"#comment",nodeType:H},te(mn,Tt);function Ut(){}Ut.prototype={nodeName:"#cdata-section",nodeType:D},te(Ut,Tt);function Bn(){}Bn.prototype.nodeType=V,te(Bn,xt);function Wn(){}Wn.prototype.nodeType=Z,te(Wn,xt);function ai(){}ai.prototype.nodeType=z,te(ai,xt);function qr(){}qr.prototype.nodeType=G,te(qr,xt);function pr(){}pr.prototype.nodeName="#document-fragment",pr.prototype.nodeType=T,te(pr,xt);function Ri(){}Ri.prototype.nodeType=P,te(Ri,xt);function Wr(){}Wr.prototype.serializeToString=function(ee,re,Te){return Rs.call(ee,re,Te)},xt.prototype.toString=Rs;function Rs(ee,re){var Te=[],Ge=this.nodeType==9&&this.documentElement||this,mt=Ge.prefix,Nt=Ge.namespaceURI;if(Nt&&mt==null){var mt=Ge.lookupPrefix(Nt);if(mt==null)var Ai=[{namespace:Nt,prefix:null}]}return Mn(this,Te,ee,re,Ai),Te.join("")}function mr(ee,re,Te){var Ge=ee.prefix||"",mt=ee.namespaceURI;if(!mt||Ge==="xml"&&mt===Ze.XML||mt===Ze.XMLNS)return!1;for(var Nt=Te.length;Nt--;){var Ai=Te[Nt];if(Ai.prefix===Ge)return Ai.namespace!==mt}return!0}function Kr(ee,re,Te){ee.push(" ",re,'="',Te.replace(/[<>&"\t\n\r]/g,Qt),'"')}function Mn(ee,re,Te,Ge,mt){if(mt||(mt=[]),Ge)if(ee=Ge(ee),ee){if(typeof ee=="string"){re.push(ee);return}}else return;switch(ee.nodeType){case w:var Nt=ee.attributes,Ai=Nt.length,mi=ee.firstChild,zi=ee.tagName;Te=Ze.isHTML(ee.namespaceURI)||Te;var gn=zi;if(!Te&&!ee.prefix&&ee.namespaceURI){for(var Dn,Fn=0;Fn<Nt.length;Fn++)if(Nt.item(Fn).name==="xmlns"){Dn=Nt.item(Fn).value;break}if(!Dn)for(var Oi=mt.length-1;Oi>=0;Oi--){var Nn=mt[Oi];if(Nn.prefix===""&&Nn.namespace===ee.namespaceURI){Dn=Nn.namespace;break}}if(Dn!==ee.namespaceURI)for(var Oi=mt.length-1;Oi>=0;Oi--){var Nn=mt[Oi];if(Nn.namespace===ee.namespaceURI){Nn.prefix&&(gn=Nn.prefix+":"+zi);break}}}re.push("<",gn);for(var Sn=0;Sn<Ai;Sn++){var en=Nt.item(Sn);en.prefix=="xmlns"?mt.push({prefix:en.localName,namespace:en.value}):en.nodeName=="xmlns"&&mt.push({prefix:"",namespace:en.value})}for(var Sn=0;Sn<Ai;Sn++){var en=Nt.item(Sn);if(mr(en,Te,mt)){var an=en.prefix||"",wr=en.namespaceURI;Kr(re,an?"xmlns:"+an:"xmlns",wr),mt.push({prefix:an,namespace:wr})}Mn(en,re,Te,Ge,mt)}if(zi===gn&&mr(ee,Te,mt)){var an=ee.prefix||"",wr=ee.namespaceURI;Kr(re,an?"xmlns:"+an:"xmlns",wr),mt.push({prefix:an,namespace:wr})}if(mi||Te&&!/^(?:meta|link|img|br|hr|input)$/i.test(zi)){if(re.push(">"),Te&&/^script$/i.test(zi))for(;mi;)mi.data?re.push(mi.data):Mn(mi,re,Te,Ge,mt.slice()),mi=mi.nextSibling;else for(;mi;)Mn(mi,re,Te,Ge,mt.slice()),mi=mi.nextSibling;re.push("</",gn,">")}else re.push("/>");return;case j:case T:for(var mi=ee.firstChild;mi;)Mn(mi,re,Te,Ge,mt.slice()),mi=mi.nextSibling;return;case y:return Kr(re,ee.name,ee.value);case $:return re.push(ee.data.replace(/[<&>]/g,Qt));case D:return re.push("<![CDATA[",ee.data,"]]>");case H:return re.push("<!--",ee.data,"-->");case V:var Lr=ee.publicId,fn=ee.systemId;if(re.push("<!DOCTYPE ",ee.name),Lr)re.push(" PUBLIC ",Lr),fn&&fn!="."&&re.push(" ",fn),re.push(">");else if(fn&&fn!=".")re.push(" SYSTEM ",fn,">");else{var kr=ee.internalSubset;kr&&re.push(" [",kr,"]"),re.push(">")}return;case P:return re.push("<?",ee.target," ",ee.data,"?>");case G:return re.push("&",ee.nodeName,";");default:re.push("??",ee.nodeName)}}function ea(ee,re,Te){var Ge;switch(re.nodeType){case w:Ge=re.cloneNode(!1),Ge.ownerDocument=ee;case T:break;case y:Te=!0;break}if(Ge||(Ge=re.cloneNode(!1)),Ge.ownerDocument=ee,Ge.parentNode=null,Te)for(var mt=re.firstChild;mt;)Ge.appendChild(ea(ee,mt,Te)),mt=mt.nextSibling;return Ge}function hn(ee,re,Te){var Ge=new re.constructor;for(var mt in re)if(Object.prototype.hasOwnProperty.call(re,mt)){var Nt=re[mt];typeof Nt!="object"&&Nt!=Ge[mt]&&(Ge[mt]=Nt)}switch(re.childNodes&&(Ge.childNodes=new ot),Ge.ownerDocument=ee,Ge.nodeType){case w:var Ai=re.attributes,mi=Ge.attributes=new Vt,zi=Ai.length;mi._ownerElement=Ge;for(var gn=0;gn<zi;gn++)Ge.setAttributeNode(hn(ee,Ai.item(gn),!0));break;case y:Te=!0}if(Te)for(var Dn=re.firstChild;Dn;)Ge.appendChild(hn(ee,Dn,Te)),Dn=Dn.nextSibling;return Ge}function tr(ee,re,Te){ee[re]=Te}try{if(Object.defineProperty){let ee=function(re){switch(re.nodeType){case w:case T:var Te=[];for(re=re.firstChild;re;)re.nodeType!==7&&re.nodeType!==8&&Te.push(ee(re)),re=re.nextSibling;return Te.join("");default:return re.nodeValue}};var ho=ee;Object.defineProperty(ti.prototype,"length",{get:function(){return bt(this),this.$$length}}),Object.defineProperty(xt.prototype,"textContent",{get:function(){return ee(this)},set:function(re){switch(this.nodeType){case w:case T:for(;this.firstChild;)this.removeChild(this.firstChild);(re||String(re))&&this.appendChild(this.ownerDocument.createTextNode(re));break;default:this.data=re,this.value=re,this.nodeValue=re}}}),tr=function(re,Te,Ge){re["$$"+Te]=Ge}}}catch(ee){}Mt.DocumentType=Bn,Mt.DOMException=nt,Mt.DOMImplementation=yi,Mt.Element=Rt,Mt.Node=xt,Mt.NodeList=ot,Mt.XMLSerializer=Wr},56277:function(Kt,Mt,ft){"use strict";var lt=ft(18859).freeze;Mt.XML_ENTITIES=lt({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),Mt.HTML_ENTITIES=lt({Aacute:"\xC1",aacute:"\xE1",Abreve:"\u0102",abreve:"\u0103",ac:"\u223E",acd:"\u223F",acE:"\u223E\u0333",Acirc:"\xC2",acirc:"\xE2",acute:"\xB4",Acy:"\u0410",acy:"\u0430",AElig:"\xC6",aelig:"\xE6",af:"\u2061",Afr:"\u{1D504}",afr:"\u{1D51E}",Agrave:"\xC0",agrave:"\xE0",alefsym:"\u2135",aleph:"\u2135",Alpha:"\u0391",alpha:"\u03B1",Amacr:"\u0100",amacr:"\u0101",amalg:"\u2A3F",AMP:"&",amp:"&",And:"\u2A53",and:"\u2227",andand:"\u2A55",andd:"\u2A5C",andslope:"\u2A58",andv:"\u2A5A",ang:"\u2220",ange:"\u29A4",angle:"\u2220",angmsd:"\u2221",angmsdaa:"\u29A8",angmsdab:"\u29A9",angmsdac:"\u29AA",angmsdad:"\u29AB",angmsdae:"\u29AC",angmsdaf:"\u29AD",angmsdag:"\u29AE",angmsdah:"\u29AF",angrt:"\u221F",angrtvb:"\u22BE",angrtvbd:"\u299D",angsph:"\u2222",angst:"\xC5",angzarr:"\u237C",Aogon:"\u0104",aogon:"\u0105",Aopf:"\u{1D538}",aopf:"\u{1D552}",ap:"\u2248",apacir:"\u2A6F",apE:"\u2A70",ape:"\u224A",apid:"\u224B",apos:"'",ApplyFunction:"\u2061",approx:"\u2248",approxeq:"\u224A",Aring:"\xC5",aring:"\xE5",Ascr:"\u{1D49C}",ascr:"\u{1D4B6}",Assign:"\u2254",ast:"*",asymp:"\u2248",asympeq:"\u224D",Atilde:"\xC3",atilde:"\xE3",Auml:"\xC4",auml:"\xE4",awconint:"\u2233",awint:"\u2A11",backcong:"\u224C",backepsilon:"\u03F6",backprime:"\u2035",backsim:"\u223D",backsimeq:"\u22CD",Backslash:"\u2216",Barv:"\u2AE7",barvee:"\u22BD",Barwed:"\u2306",barwed:"\u2305",barwedge:"\u2305",bbrk:"\u23B5",bbrktbrk:"\u23B6",bcong:"\u224C",Bcy:"\u0411",bcy:"\u0431",bdquo:"\u201E",becaus:"\u2235",Because:"\u2235",because:"\u2235",bemptyv:"\u29B0",bepsi:"\u03F6",bernou:"\u212C",Bernoullis:"\u212C",Beta:"\u0392",beta:"\u03B2",beth:"\u2136",between:"\u226C",Bfr:"\u{1D505}",bfr:"\u{1D51F}",bigcap:"\u22C2",bigcirc:"\u25EF",bigcup:"\u22C3",bigodot:"\u2A00",bigoplus:"\u2A01",bigotimes:"\u2A02",bigsqcup:"\u2A06",bigstar:"\u2605",bigtriangledown:"\u25BD",bigtriangleup:"\u25B3",biguplus:"\u2A04",bigvee:"\u22C1",bigwedge:"\u22C0",bkarow:"\u290D",blacklozenge:"\u29EB",blacksquare:"\u25AA",blacktriangle:"\u25B4",blacktriangledown:"\u25BE",blacktriangleleft:"\u25C2",blacktriangleright:"\u25B8",blank:"\u2423",blk12:"\u2592",blk14:"\u2591",blk34:"\u2593",block:"\u2588",bne:"=\u20E5",bnequiv:"\u2261\u20E5",bNot:"\u2AED",bnot:"\u2310",Bopf:"\u{1D539}",bopf:"\u{1D553}",bot:"\u22A5",bottom:"\u22A5",bowtie:"\u22C8",boxbox:"\u29C9",boxDL:"\u2557",boxDl:"\u2556",boxdL:"\u2555",boxdl:"\u2510",boxDR:"\u2554",boxDr:"\u2553",boxdR:"\u2552",boxdr:"\u250C",boxH:"\u2550",boxh:"\u2500",boxHD:"\u2566",boxHd:"\u2564",boxhD:"\u2565",boxhd:"\u252C",boxHU:"\u2569",boxHu:"\u2567",boxhU:"\u2568",boxhu:"\u2534",boxminus:"\u229F",boxplus:"\u229E",boxtimes:"\u22A0",boxUL:"\u255D",boxUl:"\u255C",boxuL:"\u255B",boxul:"\u2518",boxUR:"\u255A",boxUr:"\u2559",boxuR:"\u2558",boxur:"\u2514",boxV:"\u2551",boxv:"\u2502",boxVH:"\u256C",boxVh:"\u256B",boxvH:"\u256A",boxvh:"\u253C",boxVL:"\u2563",boxVl:"\u2562",boxvL:"\u2561",boxvl:"\u2524",boxVR:"\u2560",boxVr:"\u255F",boxvR:"\u255E",boxvr:"\u251C",bprime:"\u2035",Breve:"\u02D8",breve:"\u02D8",brvbar:"\xA6",Bscr:"\u212C",bscr:"\u{1D4B7}",bsemi:"\u204F",bsim:"\u223D",bsime:"\u22CD",bsol:"\\",bsolb:"\u29C5",bsolhsub:"\u27C8",bull:"\u2022",bullet:"\u2022",bump:"\u224E",bumpE:"\u2AAE",bumpe:"\u224F",Bumpeq:"\u224E",bumpeq:"\u224F",Cacute:"\u0106",cacute:"\u0107",Cap:"\u22D2",cap:"\u2229",capand:"\u2A44",capbrcup:"\u2A49",capcap:"\u2A4B",capcup:"\u2A47",capdot:"\u2A40",CapitalDifferentialD:"\u2145",caps:"\u2229\uFE00",caret:"\u2041",caron:"\u02C7",Cayleys:"\u212D",ccaps:"\u2A4D",Ccaron:"\u010C",ccaron:"\u010D",Ccedil:"\xC7",ccedil:"\xE7",Ccirc:"\u0108",ccirc:"\u0109",Cconint:"\u2230",ccups:"\u2A4C",ccupssm:"\u2A50",Cdot:"\u010A",cdot:"\u010B",cedil:"\xB8",Cedilla:"\xB8",cemptyv:"\u29B2",cent:"\xA2",CenterDot:"\xB7",centerdot:"\xB7",Cfr:"\u212D",cfr:"\u{1D520}",CHcy:"\u0427",chcy:"\u0447",check:"\u2713",checkmark:"\u2713",Chi:"\u03A7",chi:"\u03C7",cir:"\u25CB",circ:"\u02C6",circeq:"\u2257",circlearrowleft:"\u21BA",circlearrowright:"\u21BB",circledast:"\u229B",circledcirc:"\u229A",circleddash:"\u229D",CircleDot:"\u2299",circledR:"\xAE",circledS:"\u24C8",CircleMinus:"\u2296",CirclePlus:"\u2295",CircleTimes:"\u2297",cirE:"\u29C3",cire:"\u2257",cirfnint:"\u2A10",cirmid:"\u2AEF",cirscir:"\u29C2",ClockwiseContourIntegral:"\u2232",CloseCurlyDoubleQuote:"\u201D",CloseCurlyQuote:"\u2019",clubs:"\u2663",clubsuit:"\u2663",Colon:"\u2237",colon:":",Colone:"\u2A74",colone:"\u2254",coloneq:"\u2254",comma:",",commat:"@",comp:"\u2201",compfn:"\u2218",complement:"\u2201",complexes:"\u2102",cong:"\u2245",congdot:"\u2A6D",Congruent:"\u2261",Conint:"\u222F",conint:"\u222E",ContourIntegral:"\u222E",Copf:"\u2102",copf:"\u{1D554}",coprod:"\u2210",Coproduct:"\u2210",COPY:"\xA9",copy:"\xA9",copysr:"\u2117",CounterClockwiseContourIntegral:"\u2233",crarr:"\u21B5",Cross:"\u2A2F",cross:"\u2717",Cscr:"\u{1D49E}",cscr:"\u{1D4B8}",csub:"\u2ACF",csube:"\u2AD1",csup:"\u2AD0",csupe:"\u2AD2",ctdot:"\u22EF",cudarrl:"\u2938",cudarrr:"\u2935",cuepr:"\u22DE",cuesc:"\u22DF",cularr:"\u21B6",cularrp:"\u293D",Cup:"\u22D3",cup:"\u222A",cupbrcap:"\u2A48",CupCap:"\u224D",cupcap:"\u2A46",cupcup:"\u2A4A",cupdot:"\u228D",cupor:"\u2A45",cups:"\u222A\uFE00",curarr:"\u21B7",curarrm:"\u293C",curlyeqprec:"\u22DE",curlyeqsucc:"\u22DF",curlyvee:"\u22CE",curlywedge:"\u22CF",curren:"\xA4",curvearrowleft:"\u21B6",curvearrowright:"\u21B7",cuvee:"\u22CE",cuwed:"\u22CF",cwconint:"\u2232",cwint:"\u2231",cylcty:"\u232D",Dagger:"\u2021",dagger:"\u2020",daleth:"\u2138",Darr:"\u21A1",dArr:"\u21D3",darr:"\u2193",dash:"\u2010",Dashv:"\u2AE4",dashv:"\u22A3",dbkarow:"\u290F",dblac:"\u02DD",Dcaron:"\u010E",dcaron:"\u010F",Dcy:"\u0414",dcy:"\u0434",DD:"\u2145",dd:"\u2146",ddagger:"\u2021",ddarr:"\u21CA",DDotrahd:"\u2911",ddotseq:"\u2A77",deg:"\xB0",Del:"\u2207",Delta:"\u0394",delta:"\u03B4",demptyv:"\u29B1",dfisht:"\u297F",Dfr:"\u{1D507}",dfr:"\u{1D521}",dHar:"\u2965",dharl:"\u21C3",dharr:"\u21C2",DiacriticalAcute:"\xB4",DiacriticalDot:"\u02D9",DiacriticalDoubleAcute:"\u02DD",DiacriticalGrave:"`",DiacriticalTilde:"\u02DC",diam:"\u22C4",Diamond:"\u22C4",diamond:"\u22C4",diamondsuit:"\u2666",diams:"\u2666",die:"\xA8",DifferentialD:"\u2146",digamma:"\u03DD",disin:"\u22F2",div:"\xF7",divide:"\xF7",divideontimes:"\u22C7",divonx:"\u22C7",DJcy:"\u0402",djcy:"\u0452",dlcorn:"\u231E",dlcrop:"\u230D",dollar:"$",Dopf:"\u{1D53B}",dopf:"\u{1D555}",Dot:"\xA8",dot:"\u02D9",DotDot:"\u20DC",doteq:"\u2250",doteqdot:"\u2251",DotEqual:"\u2250",dotminus:"\u2238",dotplus:"\u2214",dotsquare:"\u22A1",doublebarwedge:"\u2306",DoubleContourIntegral:"\u222F",DoubleDot:"\xA8",DoubleDownArrow:"\u21D3",DoubleLeftArrow:"\u21D0",DoubleLeftRightArrow:"\u21D4",DoubleLeftTee:"\u2AE4",DoubleLongLeftArrow:"\u27F8",DoubleLongLeftRightArrow:"\u27FA",DoubleLongRightArrow:"\u27F9",DoubleRightArrow:"\u21D2",DoubleRightTee:"\u22A8",DoubleUpArrow:"\u21D1",DoubleUpDownArrow:"\u21D5",DoubleVerticalBar:"\u2225",DownArrow:"\u2193",Downarrow:"\u21D3",downarrow:"\u2193",DownArrowBar:"\u2913",DownArrowUpArrow:"\u21F5",DownBreve:"\u0311",downdownarrows:"\u21CA",downharpoonleft:"\u21C3",downharpoonright:"\u21C2",DownLeftRightVector:"\u2950",DownLeftTeeVector:"\u295E",DownLeftVector:"\u21BD",DownLeftVectorBar:"\u2956",DownRightTeeVector:"\u295F",DownRightVector:"\u21C1",DownRightVectorBar:"\u2957",DownTee:"\u22A4",DownTeeArrow:"\u21A7",drbkarow:"\u2910",drcorn:"\u231F",drcrop:"\u230C",Dscr:"\u{1D49F}",dscr:"\u{1D4B9}",DScy:"\u0405",dscy:"\u0455",dsol:"\u29F6",Dstrok:"\u0110",dstrok:"\u0111",dtdot:"\u22F1",dtri:"\u25BF",dtrif:"\u25BE",duarr:"\u21F5",duhar:"\u296F",dwangle:"\u29A6",DZcy:"\u040F",dzcy:"\u045F",dzigrarr:"\u27FF",Eacute:"\xC9",eacute:"\xE9",easter:"\u2A6E",Ecaron:"\u011A",ecaron:"\u011B",ecir:"\u2256",Ecirc:"\xCA",ecirc:"\xEA",ecolon:"\u2255",Ecy:"\u042D",ecy:"\u044D",eDDot:"\u2A77",Edot:"\u0116",eDot:"\u2251",edot:"\u0117",ee:"\u2147",efDot:"\u2252",Efr:"\u{1D508}",efr:"\u{1D522}",eg:"\u2A9A",Egrave:"\xC8",egrave:"\xE8",egs:"\u2A96",egsdot:"\u2A98",el:"\u2A99",Element:"\u2208",elinters:"\u23E7",ell:"\u2113",els:"\u2A95",elsdot:"\u2A97",Emacr:"\u0112",emacr:"\u0113",empty:"\u2205",emptyset:"\u2205",EmptySmallSquare:"\u25FB",emptyv:"\u2205",EmptyVerySmallSquare:"\u25AB",emsp:"\u2003",emsp13:"\u2004",emsp14:"\u2005",ENG:"\u014A",eng:"\u014B",ensp:"\u2002",Eogon:"\u0118",eogon:"\u0119",Eopf:"\u{1D53C}",eopf:"\u{1D556}",epar:"\u22D5",eparsl:"\u29E3",eplus:"\u2A71",epsi:"\u03B5",Epsilon:"\u0395",epsilon:"\u03B5",epsiv:"\u03F5",eqcirc:"\u2256",eqcolon:"\u2255",eqsim:"\u2242",eqslantgtr:"\u2A96",eqslantless:"\u2A95",Equal:"\u2A75",equals:"=",EqualTilde:"\u2242",equest:"\u225F",Equilibrium:"\u21CC",equiv:"\u2261",equivDD:"\u2A78",eqvparsl:"\u29E5",erarr:"\u2971",erDot:"\u2253",Escr:"\u2130",escr:"\u212F",esdot:"\u2250",Esim:"\u2A73",esim:"\u2242",Eta:"\u0397",eta:"\u03B7",ETH:"\xD0",eth:"\xF0",Euml:"\xCB",euml:"\xEB",euro:"\u20AC",excl:"!",exist:"\u2203",Exists:"\u2203",expectation:"\u2130",ExponentialE:"\u2147",exponentiale:"\u2147",fallingdotseq:"\u2252",Fcy:"\u0424",fcy:"\u0444",female:"\u2640",ffilig:"\uFB03",fflig:"\uFB00",ffllig:"\uFB04",Ffr:"\u{1D509}",ffr:"\u{1D523}",filig:"\uFB01",FilledSmallSquare:"\u25FC",FilledVerySmallSquare:"\u25AA",fjlig:"fj",flat:"\u266D",fllig:"\uFB02",fltns:"\u25B1",fnof:"\u0192",Fopf:"\u{1D53D}",fopf:"\u{1D557}",ForAll:"\u2200",forall:"\u2200",fork:"\u22D4",forkv:"\u2AD9",Fouriertrf:"\u2131",fpartint:"\u2A0D",frac12:"\xBD",frac13:"\u2153",frac14:"\xBC",frac15:"\u2155",frac16:"\u2159",frac18:"\u215B",frac23:"\u2154",frac25:"\u2156",frac34:"\xBE",frac35:"\u2157",frac38:"\u215C",frac45:"\u2158",frac56:"\u215A",frac58:"\u215D",frac78:"\u215E",frasl:"\u2044",frown:"\u2322",Fscr:"\u2131",fscr:"\u{1D4BB}",gacute:"\u01F5",Gamma:"\u0393",gamma:"\u03B3",Gammad:"\u03DC",gammad:"\u03DD",gap:"\u2A86",Gbreve:"\u011E",gbreve:"\u011F",Gcedil:"\u0122",Gcirc:"\u011C",gcirc:"\u011D",Gcy:"\u0413",gcy:"\u0433",Gdot:"\u0120",gdot:"\u0121",gE:"\u2267",ge:"\u2265",gEl:"\u2A8C",gel:"\u22DB",geq:"\u2265",geqq:"\u2267",geqslant:"\u2A7E",ges:"\u2A7E",gescc:"\u2AA9",gesdot:"\u2A80",gesdoto:"\u2A82",gesdotol:"\u2A84",gesl:"\u22DB\uFE00",gesles:"\u2A94",Gfr:"\u{1D50A}",gfr:"\u{1D524}",Gg:"\u22D9",gg:"\u226B",ggg:"\u22D9",gimel:"\u2137",GJcy:"\u0403",gjcy:"\u0453",gl:"\u2277",gla:"\u2AA5",glE:"\u2A92",glj:"\u2AA4",gnap:"\u2A8A",gnapprox:"\u2A8A",gnE:"\u2269",gne:"\u2A88",gneq:"\u2A88",gneqq:"\u2269",gnsim:"\u22E7",Gopf:"\u{1D53E}",gopf:"\u{1D558}",grave:"`",GreaterEqual:"\u2265",GreaterEqualLess:"\u22DB",GreaterFullEqual:"\u2267",GreaterGreater:"\u2AA2",GreaterLess:"\u2277",GreaterSlantEqual:"\u2A7E",GreaterTilde:"\u2273",Gscr:"\u{1D4A2}",gscr:"\u210A",gsim:"\u2273",gsime:"\u2A8E",gsiml:"\u2A90",Gt:"\u226B",GT:">",gt:">",gtcc:"\u2AA7",gtcir:"\u2A7A",gtdot:"\u22D7",gtlPar:"\u2995",gtquest:"\u2A7C",gtrapprox:"\u2A86",gtrarr:"\u2978",gtrdot:"\u22D7",gtreqless:"\u22DB",gtreqqless:"\u2A8C",gtrless:"\u2277",gtrsim:"\u2273",gvertneqq:"\u2269\uFE00",gvnE:"\u2269\uFE00",Hacek:"\u02C7",hairsp:"\u200A",half:"\xBD",hamilt:"\u210B",HARDcy:"\u042A",hardcy:"\u044A",hArr:"\u21D4",harr:"\u2194",harrcir:"\u2948",harrw:"\u21AD",Hat:"^",hbar:"\u210F",Hcirc:"\u0124",hcirc:"\u0125",hearts:"\u2665",heartsuit:"\u2665",hellip:"\u2026",hercon:"\u22B9",Hfr:"\u210C",hfr:"\u{1D525}",HilbertSpace:"\u210B",hksearow:"\u2925",hkswarow:"\u2926",hoarr:"\u21FF",homtht:"\u223B",hookleftarrow:"\u21A9",hookrightarrow:"\u21AA",Hopf:"\u210D",hopf:"\u{1D559}",horbar:"\u2015",HorizontalLine:"\u2500",Hscr:"\u210B",hscr:"\u{1D4BD}",hslash:"\u210F",Hstrok:"\u0126",hstrok:"\u0127",HumpDownHump:"\u224E",HumpEqual:"\u224F",hybull:"\u2043",hyphen:"\u2010",Iacute:"\xCD",iacute:"\xED",ic:"\u2063",Icirc:"\xCE",icirc:"\xEE",Icy:"\u0418",icy:"\u0438",Idot:"\u0130",IEcy:"\u0415",iecy:"\u0435",iexcl:"\xA1",iff:"\u21D4",Ifr:"\u2111",ifr:"\u{1D526}",Igrave:"\xCC",igrave:"\xEC",ii:"\u2148",iiiint:"\u2A0C",iiint:"\u222D",iinfin:"\u29DC",iiota:"\u2129",IJlig:"\u0132",ijlig:"\u0133",Im:"\u2111",Imacr:"\u012A",imacr:"\u012B",image:"\u2111",ImaginaryI:"\u2148",imagline:"\u2110",imagpart:"\u2111",imath:"\u0131",imof:"\u22B7",imped:"\u01B5",Implies:"\u21D2",in:"\u2208",incare:"\u2105",infin:"\u221E",infintie:"\u29DD",inodot:"\u0131",Int:"\u222C",int:"\u222B",intcal:"\u22BA",integers:"\u2124",Integral:"\u222B",intercal:"\u22BA",Intersection:"\u22C2",intlarhk:"\u2A17",intprod:"\u2A3C",InvisibleComma:"\u2063",InvisibleTimes:"\u2062",IOcy:"\u0401",iocy:"\u0451",Iogon:"\u012E",iogon:"\u012F",Iopf:"\u{1D540}",iopf:"\u{1D55A}",Iota:"\u0399",iota:"\u03B9",iprod:"\u2A3C",iquest:"\xBF",Iscr:"\u2110",iscr:"\u{1D4BE}",isin:"\u2208",isindot:"\u22F5",isinE:"\u22F9",isins:"\u22F4",isinsv:"\u22F3",isinv:"\u2208",it:"\u2062",Itilde:"\u0128",itilde:"\u0129",Iukcy:"\u0406",iukcy:"\u0456",Iuml:"\xCF",iuml:"\xEF",Jcirc:"\u0134",jcirc:"\u0135",Jcy:"\u0419",jcy:"\u0439",Jfr:"\u{1D50D}",jfr:"\u{1D527}",jmath:"\u0237",Jopf:"\u{1D541}",jopf:"\u{1D55B}",Jscr:"\u{1D4A5}",jscr:"\u{1D4BF}",Jsercy:"\u0408",jsercy:"\u0458",Jukcy:"\u0404",jukcy:"\u0454",Kappa:"\u039A",kappa:"\u03BA",kappav:"\u03F0",Kcedil:"\u0136",kcedil:"\u0137",Kcy:"\u041A",kcy:"\u043A",Kfr:"\u{1D50E}",kfr:"\u{1D528}",kgreen:"\u0138",KHcy:"\u0425",khcy:"\u0445",KJcy:"\u040C",kjcy:"\u045C",Kopf:"\u{1D542}",kopf:"\u{1D55C}",Kscr:"\u{1D4A6}",kscr:"\u{1D4C0}",lAarr:"\u21DA",Lacute:"\u0139",lacute:"\u013A",laemptyv:"\u29B4",lagran:"\u2112",Lambda:"\u039B",lambda:"\u03BB",Lang:"\u27EA",lang:"\u27E8",langd:"\u2991",langle:"\u27E8",lap:"\u2A85",Laplacetrf:"\u2112",laquo:"\xAB",Larr:"\u219E",lArr:"\u21D0",larr:"\u2190",larrb:"\u21E4",larrbfs:"\u291F",larrfs:"\u291D",larrhk:"\u21A9",larrlp:"\u21AB",larrpl:"\u2939",larrsim:"\u2973",larrtl:"\u21A2",lat:"\u2AAB",lAtail:"\u291B",latail:"\u2919",late:"\u2AAD",lates:"\u2AAD\uFE00",lBarr:"\u290E",lbarr:"\u290C",lbbrk:"\u2772",lbrace:"{",lbrack:"[",lbrke:"\u298B",lbrksld:"\u298F",lbrkslu:"\u298D",Lcaron:"\u013D",lcaron:"\u013E",Lcedil:"\u013B",lcedil:"\u013C",lceil:"\u2308",lcub:"{",Lcy:"\u041B",lcy:"\u043B",ldca:"\u2936",ldquo:"\u201C",ldquor:"\u201E",ldrdhar:"\u2967",ldrushar:"\u294B",ldsh:"\u21B2",lE:"\u2266",le:"\u2264",LeftAngleBracket:"\u27E8",LeftArrow:"\u2190",Leftarrow:"\u21D0",leftarrow:"\u2190",LeftArrowBar:"\u21E4",LeftArrowRightArrow:"\u21C6",leftarrowtail:"\u21A2",LeftCeiling:"\u2308",LeftDoubleBracket:"\u27E6",LeftDownTeeVector:"\u2961",LeftDownVector:"\u21C3",LeftDownVectorBar:"\u2959",LeftFloor:"\u230A",leftharpoondown:"\u21BD",leftharpoonup:"\u21BC",leftleftarrows:"\u21C7",LeftRightArrow:"\u2194",Leftrightarrow:"\u21D4",leftrightarrow:"\u2194",leftrightarrows:"\u21C6",leftrightharpoons:"\u21CB",leftrightsquigarrow:"\u21AD",LeftRightVector:"\u294E",LeftTee:"\u22A3",LeftTeeArrow:"\u21A4",LeftTeeVector:"\u295A",leftthreetimes:"\u22CB",LeftTriangle:"\u22B2",LeftTriangleBar:"\u29CF",LeftTriangleEqual:"\u22B4",LeftUpDownVector:"\u2951",LeftUpTeeVector:"\u2960",LeftUpVector:"\u21BF",LeftUpVectorBar:"\u2958",LeftVector:"\u21BC",LeftVectorBar:"\u2952",lEg:"\u2A8B",leg:"\u22DA",leq:"\u2264",leqq:"\u2266",leqslant:"\u2A7D",les:"\u2A7D",lescc:"\u2AA8",lesdot:"\u2A7F",lesdoto:"\u2A81",lesdotor:"\u2A83",lesg:"\u22DA\uFE00",lesges:"\u2A93",lessapprox:"\u2A85",lessdot:"\u22D6",lesseqgtr:"\u22DA",lesseqqgtr:"\u2A8B",LessEqualGreater:"\u22DA",LessFullEqual:"\u2266",LessGreater:"\u2276",lessgtr:"\u2276",LessLess:"\u2AA1",lesssim:"\u2272",LessSlantEqual:"\u2A7D",LessTilde:"\u2272",lfisht:"\u297C",lfloor:"\u230A",Lfr:"\u{1D50F}",lfr:"\u{1D529}",lg:"\u2276",lgE:"\u2A91",lHar:"\u2962",lhard:"\u21BD",lharu:"\u21BC",lharul:"\u296A",lhblk:"\u2584",LJcy:"\u0409",ljcy:"\u0459",Ll:"\u22D8",ll:"\u226A",llarr:"\u21C7",llcorner:"\u231E",Lleftarrow:"\u21DA",llhard:"\u296B",lltri:"\u25FA",Lmidot:"\u013F",lmidot:"\u0140",lmoust:"\u23B0",lmoustache:"\u23B0",lnap:"\u2A89",lnapprox:"\u2A89",lnE:"\u2268",lne:"\u2A87",lneq:"\u2A87",lneqq:"\u2268",lnsim:"\u22E6",loang:"\u27EC",loarr:"\u21FD",lobrk:"\u27E6",LongLeftArrow:"\u27F5",Longleftarrow:"\u27F8",longleftarrow:"\u27F5",LongLeftRightArrow:"\u27F7",Longleftrightarrow:"\u27FA",longleftrightarrow:"\u27F7",longmapsto:"\u27FC",LongRightArrow:"\u27F6",Longrightarrow:"\u27F9",longrightarrow:"\u27F6",looparrowleft:"\u21AB",looparrowright:"\u21AC",lopar:"\u2985",Lopf:"\u{1D543}",lopf:"\u{1D55D}",loplus:"\u2A2D",lotimes:"\u2A34",lowast:"\u2217",lowbar:"_",LowerLeftArrow:"\u2199",LowerRightArrow:"\u2198",loz:"\u25CA",lozenge:"\u25CA",lozf:"\u29EB",lpar:"(",lparlt:"\u2993",lrarr:"\u21C6",lrcorner:"\u231F",lrhar:"\u21CB",lrhard:"\u296D",lrm:"\u200E",lrtri:"\u22BF",lsaquo:"\u2039",Lscr:"\u2112",lscr:"\u{1D4C1}",Lsh:"\u21B0",lsh:"\u21B0",lsim:"\u2272",lsime:"\u2A8D",lsimg:"\u2A8F",lsqb:"[",lsquo:"\u2018",lsquor:"\u201A",Lstrok:"\u0141",lstrok:"\u0142",Lt:"\u226A",LT:"<",lt:"<",ltcc:"\u2AA6",ltcir:"\u2A79",ltdot:"\u22D6",lthree:"\u22CB",ltimes:"\u22C9",ltlarr:"\u2976",ltquest:"\u2A7B",ltri:"\u25C3",ltrie:"\u22B4",ltrif:"\u25C2",ltrPar:"\u2996",lurdshar:"\u294A",luruhar:"\u2966",lvertneqq:"\u2268\uFE00",lvnE:"\u2268\uFE00",macr:"\xAF",male:"\u2642",malt:"\u2720",maltese:"\u2720",Map:"\u2905",map:"\u21A6",mapsto:"\u21A6",mapstodown:"\u21A7",mapstoleft:"\u21A4",mapstoup:"\u21A5",marker:"\u25AE",mcomma:"\u2A29",Mcy:"\u041C",mcy:"\u043C",mdash:"\u2014",mDDot:"\u223A",measuredangle:"\u2221",MediumSpace:"\u205F",Mellintrf:"\u2133",Mfr:"\u{1D510}",mfr:"\u{1D52A}",mho:"\u2127",micro:"\xB5",mid:"\u2223",midast:"*",midcir:"\u2AF0",middot:"\xB7",minus:"\u2212",minusb:"\u229F",minusd:"\u2238",minusdu:"\u2A2A",MinusPlus:"\u2213",mlcp:"\u2ADB",mldr:"\u2026",mnplus:"\u2213",models:"\u22A7",Mopf:"\u{1D544}",mopf:"\u{1D55E}",mp:"\u2213",Mscr:"\u2133",mscr:"\u{1D4C2}",mstpos:"\u223E",Mu:"\u039C",mu:"\u03BC",multimap:"\u22B8",mumap:"\u22B8",nabla:"\u2207",Nacute:"\u0143",nacute:"\u0144",nang:"\u2220\u20D2",nap:"\u2249",napE:"\u2A70\u0338",napid:"\u224B\u0338",napos:"\u0149",napprox:"\u2249",natur:"\u266E",natural:"\u266E",naturals:"\u2115",nbsp:"\xA0",nbump:"\u224E\u0338",nbumpe:"\u224F\u0338",ncap:"\u2A43",Ncaron:"\u0147",ncaron:"\u0148",Ncedil:"\u0145",ncedil:"\u0146",ncong:"\u2247",ncongdot:"\u2A6D\u0338",ncup:"\u2A42",Ncy:"\u041D",ncy:"\u043D",ndash:"\u2013",ne:"\u2260",nearhk:"\u2924",neArr:"\u21D7",nearr:"\u2197",nearrow:"\u2197",nedot:"\u2250\u0338",NegativeMediumSpace:"\u200B",NegativeThickSpace:"\u200B",NegativeThinSpace:"\u200B",NegativeVeryThinSpace:"\u200B",nequiv:"\u2262",nesear:"\u2928",nesim:"\u2242\u0338",NestedGreaterGreater:"\u226B",NestedLessLess:"\u226A",NewLine:`
`,nexist:"\u2204",nexists:"\u2204",Nfr:"\u{1D511}",nfr:"\u{1D52B}",ngE:"\u2267\u0338",nge:"\u2271",ngeq:"\u2271",ngeqq:"\u2267\u0338",ngeqslant:"\u2A7E\u0338",nges:"\u2A7E\u0338",nGg:"\u22D9\u0338",ngsim:"\u2275",nGt:"\u226B\u20D2",ngt:"\u226F",ngtr:"\u226F",nGtv:"\u226B\u0338",nhArr:"\u21CE",nharr:"\u21AE",nhpar:"\u2AF2",ni:"\u220B",nis:"\u22FC",nisd:"\u22FA",niv:"\u220B",NJcy:"\u040A",njcy:"\u045A",nlArr:"\u21CD",nlarr:"\u219A",nldr:"\u2025",nlE:"\u2266\u0338",nle:"\u2270",nLeftarrow:"\u21CD",nleftarrow:"\u219A",nLeftrightarrow:"\u21CE",nleftrightarrow:"\u21AE",nleq:"\u2270",nleqq:"\u2266\u0338",nleqslant:"\u2A7D\u0338",nles:"\u2A7D\u0338",nless:"\u226E",nLl:"\u22D8\u0338",nlsim:"\u2274",nLt:"\u226A\u20D2",nlt:"\u226E",nltri:"\u22EA",nltrie:"\u22EC",nLtv:"\u226A\u0338",nmid:"\u2224",NoBreak:"\u2060",NonBreakingSpace:"\xA0",Nopf:"\u2115",nopf:"\u{1D55F}",Not:"\u2AEC",not:"\xAC",NotCongruent:"\u2262",NotCupCap:"\u226D",NotDoubleVerticalBar:"\u2226",NotElement:"\u2209",NotEqual:"\u2260",NotEqualTilde:"\u2242\u0338",NotExists:"\u2204",NotGreater:"\u226F",NotGreaterEqual:"\u2271",NotGreaterFullEqual:"\u2267\u0338",NotGreaterGreater:"\u226B\u0338",NotGreaterLess:"\u2279",NotGreaterSlantEqual:"\u2A7E\u0338",NotGreaterTilde:"\u2275",NotHumpDownHump:"\u224E\u0338",NotHumpEqual:"\u224F\u0338",notin:"\u2209",notindot:"\u22F5\u0338",notinE:"\u22F9\u0338",notinva:"\u2209",notinvb:"\u22F7",notinvc:"\u22F6",NotLeftTriangle:"\u22EA",NotLeftTriangleBar:"\u29CF\u0338",NotLeftTriangleEqual:"\u22EC",NotLess:"\u226E",NotLessEqual:"\u2270",NotLessGreater:"\u2278",NotLessLess:"\u226A\u0338",NotLessSlantEqual:"\u2A7D\u0338",NotLessTilde:"\u2274",NotNestedGreaterGreater:"\u2AA2\u0338",NotNestedLessLess:"\u2AA1\u0338",notni:"\u220C",notniva:"\u220C",notnivb:"\u22FE",notnivc:"\u22FD",NotPrecedes:"\u2280",NotPrecedesEqual:"\u2AAF\u0338",NotPrecedesSlantEqual:"\u22E0",NotReverseElement:"\u220C",NotRightTriangle:"\u22EB",NotRightTriangleBar:"\u29D0\u0338",NotRightTriangleEqual:"\u22ED",NotSquareSubset:"\u228F\u0338",NotSquareSubsetEqual:"\u22E2",NotSquareSuperset:"\u2290\u0338",NotSquareSupersetEqual:"\u22E3",NotSubset:"\u2282\u20D2",NotSubsetEqual:"\u2288",NotSucceeds:"\u2281",NotSucceedsEqual:"\u2AB0\u0338",NotSucceedsSlantEqual:"\u22E1",NotSucceedsTilde:"\u227F\u0338",NotSuperset:"\u2283\u20D2",NotSupersetEqual:"\u2289",NotTilde:"\u2241",NotTildeEqual:"\u2244",NotTildeFullEqual:"\u2247",NotTildeTilde:"\u2249",NotVerticalBar:"\u2224",npar:"\u2226",nparallel:"\u2226",nparsl:"\u2AFD\u20E5",npart:"\u2202\u0338",npolint:"\u2A14",npr:"\u2280",nprcue:"\u22E0",npre:"\u2AAF\u0338",nprec:"\u2280",npreceq:"\u2AAF\u0338",nrArr:"\u21CF",nrarr:"\u219B",nrarrc:"\u2933\u0338",nrarrw:"\u219D\u0338",nRightarrow:"\u21CF",nrightarrow:"\u219B",nrtri:"\u22EB",nrtrie:"\u22ED",nsc:"\u2281",nsccue:"\u22E1",nsce:"\u2AB0\u0338",Nscr:"\u{1D4A9}",nscr:"\u{1D4C3}",nshortmid:"\u2224",nshortparallel:"\u2226",nsim:"\u2241",nsime:"\u2244",nsimeq:"\u2244",nsmid:"\u2224",nspar:"\u2226",nsqsube:"\u22E2",nsqsupe:"\u22E3",nsub:"\u2284",nsubE:"\u2AC5\u0338",nsube:"\u2288",nsubset:"\u2282\u20D2",nsubseteq:"\u2288",nsubseteqq:"\u2AC5\u0338",nsucc:"\u2281",nsucceq:"\u2AB0\u0338",nsup:"\u2285",nsupE:"\u2AC6\u0338",nsupe:"\u2289",nsupset:"\u2283\u20D2",nsupseteq:"\u2289",nsupseteqq:"\u2AC6\u0338",ntgl:"\u2279",Ntilde:"\xD1",ntilde:"\xF1",ntlg:"\u2278",ntriangleleft:"\u22EA",ntrianglelefteq:"\u22EC",ntriangleright:"\u22EB",ntrianglerighteq:"\u22ED",Nu:"\u039D",nu:"\u03BD",num:"#",numero:"\u2116",numsp:"\u2007",nvap:"\u224D\u20D2",nVDash:"\u22AF",nVdash:"\u22AE",nvDash:"\u22AD",nvdash:"\u22AC",nvge:"\u2265\u20D2",nvgt:">\u20D2",nvHarr:"\u2904",nvinfin:"\u29DE",nvlArr:"\u2902",nvle:"\u2264\u20D2",nvlt:"<\u20D2",nvltrie:"\u22B4\u20D2",nvrArr:"\u2903",nvrtrie:"\u22B5\u20D2",nvsim:"\u223C\u20D2",nwarhk:"\u2923",nwArr:"\u21D6",nwarr:"\u2196",nwarrow:"\u2196",nwnear:"\u2927",Oacute:"\xD3",oacute:"\xF3",oast:"\u229B",ocir:"\u229A",Ocirc:"\xD4",ocirc:"\xF4",Ocy:"\u041E",ocy:"\u043E",odash:"\u229D",Odblac:"\u0150",odblac:"\u0151",odiv:"\u2A38",odot:"\u2299",odsold:"\u29BC",OElig:"\u0152",oelig:"\u0153",ofcir:"\u29BF",Ofr:"\u{1D512}",ofr:"\u{1D52C}",ogon:"\u02DB",Ograve:"\xD2",ograve:"\xF2",ogt:"\u29C1",ohbar:"\u29B5",ohm:"\u03A9",oint:"\u222E",olarr:"\u21BA",olcir:"\u29BE",olcross:"\u29BB",oline:"\u203E",olt:"\u29C0",Omacr:"\u014C",omacr:"\u014D",Omega:"\u03A9",omega:"\u03C9",Omicron:"\u039F",omicron:"\u03BF",omid:"\u29B6",ominus:"\u2296",Oopf:"\u{1D546}",oopf:"\u{1D560}",opar:"\u29B7",OpenCurlyDoubleQuote:"\u201C",OpenCurlyQuote:"\u2018",operp:"\u29B9",oplus:"\u2295",Or:"\u2A54",or:"\u2228",orarr:"\u21BB",ord:"\u2A5D",order:"\u2134",orderof:"\u2134",ordf:"\xAA",ordm:"\xBA",origof:"\u22B6",oror:"\u2A56",orslope:"\u2A57",orv:"\u2A5B",oS:"\u24C8",Oscr:"\u{1D4AA}",oscr:"\u2134",Oslash:"\xD8",oslash:"\xF8",osol:"\u2298",Otilde:"\xD5",otilde:"\xF5",Otimes:"\u2A37",otimes:"\u2297",otimesas:"\u2A36",Ouml:"\xD6",ouml:"\xF6",ovbar:"\u233D",OverBar:"\u203E",OverBrace:"\u23DE",OverBracket:"\u23B4",OverParenthesis:"\u23DC",par:"\u2225",para:"\xB6",parallel:"\u2225",parsim:"\u2AF3",parsl:"\u2AFD",part:"\u2202",PartialD:"\u2202",Pcy:"\u041F",pcy:"\u043F",percnt:"%",period:".",permil:"\u2030",perp:"\u22A5",pertenk:"\u2031",Pfr:"\u{1D513}",pfr:"\u{1D52D}",Phi:"\u03A6",phi:"\u03C6",phiv:"\u03D5",phmmat:"\u2133",phone:"\u260E",Pi:"\u03A0",pi:"\u03C0",pitchfork:"\u22D4",piv:"\u03D6",planck:"\u210F",planckh:"\u210E",plankv:"\u210F",plus:"+",plusacir:"\u2A23",plusb:"\u229E",pluscir:"\u2A22",plusdo:"\u2214",plusdu:"\u2A25",pluse:"\u2A72",PlusMinus:"\xB1",plusmn:"\xB1",plussim:"\u2A26",plustwo:"\u2A27",pm:"\xB1",Poincareplane:"\u210C",pointint:"\u2A15",Popf:"\u2119",popf:"\u{1D561}",pound:"\xA3",Pr:"\u2ABB",pr:"\u227A",prap:"\u2AB7",prcue:"\u227C",prE:"\u2AB3",pre:"\u2AAF",prec:"\u227A",precapprox:"\u2AB7",preccurlyeq:"\u227C",Precedes:"\u227A",PrecedesEqual:"\u2AAF",PrecedesSlantEqual:"\u227C",PrecedesTilde:"\u227E",preceq:"\u2AAF",precnapprox:"\u2AB9",precneqq:"\u2AB5",precnsim:"\u22E8",precsim:"\u227E",Prime:"\u2033",prime:"\u2032",primes:"\u2119",prnap:"\u2AB9",prnE:"\u2AB5",prnsim:"\u22E8",prod:"\u220F",Product:"\u220F",profalar:"\u232E",profline:"\u2312",profsurf:"\u2313",prop:"\u221D",Proportion:"\u2237",Proportional:"\u221D",propto:"\u221D",prsim:"\u227E",prurel:"\u22B0",Pscr:"\u{1D4AB}",pscr:"\u{1D4C5}",Psi:"\u03A8",psi:"\u03C8",puncsp:"\u2008",Qfr:"\u{1D514}",qfr:"\u{1D52E}",qint:"\u2A0C",Qopf:"\u211A",qopf:"\u{1D562}",qprime:"\u2057",Qscr:"\u{1D4AC}",qscr:"\u{1D4C6}",quaternions:"\u210D",quatint:"\u2A16",quest:"?",questeq:"\u225F",QUOT:'"',quot:'"',rAarr:"\u21DB",race:"\u223D\u0331",Racute:"\u0154",racute:"\u0155",radic:"\u221A",raemptyv:"\u29B3",Rang:"\u27EB",rang:"\u27E9",rangd:"\u2992",range:"\u29A5",rangle:"\u27E9",raquo:"\xBB",Rarr:"\u21A0",rArr:"\u21D2",rarr:"\u2192",rarrap:"\u2975",rarrb:"\u21E5",rarrbfs:"\u2920",rarrc:"\u2933",rarrfs:"\u291E",rarrhk:"\u21AA",rarrlp:"\u21AC",rarrpl:"\u2945",rarrsim:"\u2974",Rarrtl:"\u2916",rarrtl:"\u21A3",rarrw:"\u219D",rAtail:"\u291C",ratail:"\u291A",ratio:"\u2236",rationals:"\u211A",RBarr:"\u2910",rBarr:"\u290F",rbarr:"\u290D",rbbrk:"\u2773",rbrace:"}",rbrack:"]",rbrke:"\u298C",rbrksld:"\u298E",rbrkslu:"\u2990",Rcaron:"\u0158",rcaron:"\u0159",Rcedil:"\u0156",rcedil:"\u0157",rceil:"\u2309",rcub:"}",Rcy:"\u0420",rcy:"\u0440",rdca:"\u2937",rdldhar:"\u2969",rdquo:"\u201D",rdquor:"\u201D",rdsh:"\u21B3",Re:"\u211C",real:"\u211C",realine:"\u211B",realpart:"\u211C",reals:"\u211D",rect:"\u25AD",REG:"\xAE",reg:"\xAE",ReverseElement:"\u220B",ReverseEquilibrium:"\u21CB",ReverseUpEquilibrium:"\u296F",rfisht:"\u297D",rfloor:"\u230B",Rfr:"\u211C",rfr:"\u{1D52F}",rHar:"\u2964",rhard:"\u21C1",rharu:"\u21C0",rharul:"\u296C",Rho:"\u03A1",rho:"\u03C1",rhov:"\u03F1",RightAngleBracket:"\u27E9",RightArrow:"\u2192",Rightarrow:"\u21D2",rightarrow:"\u2192",RightArrowBar:"\u21E5",RightArrowLeftArrow:"\u21C4",rightarrowtail:"\u21A3",RightCeiling:"\u2309",RightDoubleBracket:"\u27E7",RightDownTeeVector:"\u295D",RightDownVector:"\u21C2",RightDownVectorBar:"\u2955",RightFloor:"\u230B",rightharpoondown:"\u21C1",rightharpoonup:"\u21C0",rightleftarrows:"\u21C4",rightleftharpoons:"\u21CC",rightrightarrows:"\u21C9",rightsquigarrow:"\u219D",RightTee:"\u22A2",RightTeeArrow:"\u21A6",RightTeeVector:"\u295B",rightthreetimes:"\u22CC",RightTriangle:"\u22B3",RightTriangleBar:"\u29D0",RightTriangleEqual:"\u22B5",RightUpDownVector:"\u294F",RightUpTeeVector:"\u295C",RightUpVector:"\u21BE",RightUpVectorBar:"\u2954",RightVector:"\u21C0",RightVectorBar:"\u2953",ring:"\u02DA",risingdotseq:"\u2253",rlarr:"\u21C4",rlhar:"\u21CC",rlm:"\u200F",rmoust:"\u23B1",rmoustache:"\u23B1",rnmid:"\u2AEE",roang:"\u27ED",roarr:"\u21FE",robrk:"\u27E7",ropar:"\u2986",Ropf:"\u211D",ropf:"\u{1D563}",roplus:"\u2A2E",rotimes:"\u2A35",RoundImplies:"\u2970",rpar:")",rpargt:"\u2994",rppolint:"\u2A12",rrarr:"\u21C9",Rrightarrow:"\u21DB",rsaquo:"\u203A",Rscr:"\u211B",rscr:"\u{1D4C7}",Rsh:"\u21B1",rsh:"\u21B1",rsqb:"]",rsquo:"\u2019",rsquor:"\u2019",rthree:"\u22CC",rtimes:"\u22CA",rtri:"\u25B9",rtrie:"\u22B5",rtrif:"\u25B8",rtriltri:"\u29CE",RuleDelayed:"\u29F4",ruluhar:"\u2968",rx:"\u211E",Sacute:"\u015A",sacute:"\u015B",sbquo:"\u201A",Sc:"\u2ABC",sc:"\u227B",scap:"\u2AB8",Scaron:"\u0160",scaron:"\u0161",sccue:"\u227D",scE:"\u2AB4",sce:"\u2AB0",Scedil:"\u015E",scedil:"\u015F",Scirc:"\u015C",scirc:"\u015D",scnap:"\u2ABA",scnE:"\u2AB6",scnsim:"\u22E9",scpolint:"\u2A13",scsim:"\u227F",Scy:"\u0421",scy:"\u0441",sdot:"\u22C5",sdotb:"\u22A1",sdote:"\u2A66",searhk:"\u2925",seArr:"\u21D8",searr:"\u2198",searrow:"\u2198",sect:"\xA7",semi:";",seswar:"\u2929",setminus:"\u2216",setmn:"\u2216",sext:"\u2736",Sfr:"\u{1D516}",sfr:"\u{1D530}",sfrown:"\u2322",sharp:"\u266F",SHCHcy:"\u0429",shchcy:"\u0449",SHcy:"\u0428",shcy:"\u0448",ShortDownArrow:"\u2193",ShortLeftArrow:"\u2190",shortmid:"\u2223",shortparallel:"\u2225",ShortRightArrow:"\u2192",ShortUpArrow:"\u2191",shy:"\xAD",Sigma:"\u03A3",sigma:"\u03C3",sigmaf:"\u03C2",sigmav:"\u03C2",sim:"\u223C",simdot:"\u2A6A",sime:"\u2243",simeq:"\u2243",simg:"\u2A9E",simgE:"\u2AA0",siml:"\u2A9D",simlE:"\u2A9F",simne:"\u2246",simplus:"\u2A24",simrarr:"\u2972",slarr:"\u2190",SmallCircle:"\u2218",smallsetminus:"\u2216",smashp:"\u2A33",smeparsl:"\u29E4",smid:"\u2223",smile:"\u2323",smt:"\u2AAA",smte:"\u2AAC",smtes:"\u2AAC\uFE00",SOFTcy:"\u042C",softcy:"\u044C",sol:"/",solb:"\u29C4",solbar:"\u233F",Sopf:"\u{1D54A}",sopf:"\u{1D564}",spades:"\u2660",spadesuit:"\u2660",spar:"\u2225",sqcap:"\u2293",sqcaps:"\u2293\uFE00",sqcup:"\u2294",sqcups:"\u2294\uFE00",Sqrt:"\u221A",sqsub:"\u228F",sqsube:"\u2291",sqsubset:"\u228F",sqsubseteq:"\u2291",sqsup:"\u2290",sqsupe:"\u2292",sqsupset:"\u2290",sqsupseteq:"\u2292",squ:"\u25A1",Square:"\u25A1",square:"\u25A1",SquareIntersection:"\u2293",SquareSubset:"\u228F",SquareSubsetEqual:"\u2291",SquareSuperset:"\u2290",SquareSupersetEqual:"\u2292",SquareUnion:"\u2294",squarf:"\u25AA",squf:"\u25AA",srarr:"\u2192",Sscr:"\u{1D4AE}",sscr:"\u{1D4C8}",ssetmn:"\u2216",ssmile:"\u2323",sstarf:"\u22C6",Star:"\u22C6",star:"\u2606",starf:"\u2605",straightepsilon:"\u03F5",straightphi:"\u03D5",strns:"\xAF",Sub:"\u22D0",sub:"\u2282",subdot:"\u2ABD",subE:"\u2AC5",sube:"\u2286",subedot:"\u2AC3",submult:"\u2AC1",subnE:"\u2ACB",subne:"\u228A",subplus:"\u2ABF",subrarr:"\u2979",Subset:"\u22D0",subset:"\u2282",subseteq:"\u2286",subseteqq:"\u2AC5",SubsetEqual:"\u2286",subsetneq:"\u228A",subsetneqq:"\u2ACB",subsim:"\u2AC7",subsub:"\u2AD5",subsup:"\u2AD3",succ:"\u227B",succapprox:"\u2AB8",succcurlyeq:"\u227D",Succeeds:"\u227B",SucceedsEqual:"\u2AB0",SucceedsSlantEqual:"\u227D",SucceedsTilde:"\u227F",succeq:"\u2AB0",succnapprox:"\u2ABA",succneqq:"\u2AB6",succnsim:"\u22E9",succsim:"\u227F",SuchThat:"\u220B",Sum:"\u2211",sum:"\u2211",sung:"\u266A",Sup:"\u22D1",sup:"\u2283",sup1:"\xB9",sup2:"\xB2",sup3:"\xB3",supdot:"\u2ABE",supdsub:"\u2AD8",supE:"\u2AC6",supe:"\u2287",supedot:"\u2AC4",Superset:"\u2283",SupersetEqual:"\u2287",suphsol:"\u27C9",suphsub:"\u2AD7",suplarr:"\u297B",supmult:"\u2AC2",supnE:"\u2ACC",supne:"\u228B",supplus:"\u2AC0",Supset:"\u22D1",supset:"\u2283",supseteq:"\u2287",supseteqq:"\u2AC6",supsetneq:"\u228B",supsetneqq:"\u2ACC",supsim:"\u2AC8",supsub:"\u2AD4",supsup:"\u2AD6",swarhk:"\u2926",swArr:"\u21D9",swarr:"\u2199",swarrow:"\u2199",swnwar:"\u292A",szlig:"\xDF",Tab:"	",target:"\u2316",Tau:"\u03A4",tau:"\u03C4",tbrk:"\u23B4",Tcaron:"\u0164",tcaron:"\u0165",Tcedil:"\u0162",tcedil:"\u0163",Tcy:"\u0422",tcy:"\u0442",tdot:"\u20DB",telrec:"\u2315",Tfr:"\u{1D517}",tfr:"\u{1D531}",there4:"\u2234",Therefore:"\u2234",therefore:"\u2234",Theta:"\u0398",theta:"\u03B8",thetasym:"\u03D1",thetav:"\u03D1",thickapprox:"\u2248",thicksim:"\u223C",ThickSpace:"\u205F\u200A",thinsp:"\u2009",ThinSpace:"\u2009",thkap:"\u2248",thksim:"\u223C",THORN:"\xDE",thorn:"\xFE",Tilde:"\u223C",tilde:"\u02DC",TildeEqual:"\u2243",TildeFullEqual:"\u2245",TildeTilde:"\u2248",times:"\xD7",timesb:"\u22A0",timesbar:"\u2A31",timesd:"\u2A30",tint:"\u222D",toea:"\u2928",top:"\u22A4",topbot:"\u2336",topcir:"\u2AF1",Topf:"\u{1D54B}",topf:"\u{1D565}",topfork:"\u2ADA",tosa:"\u2929",tprime:"\u2034",TRADE:"\u2122",trade:"\u2122",triangle:"\u25B5",triangledown:"\u25BF",triangleleft:"\u25C3",trianglelefteq:"\u22B4",triangleq:"\u225C",triangleright:"\u25B9",trianglerighteq:"\u22B5",tridot:"\u25EC",trie:"\u225C",triminus:"\u2A3A",TripleDot:"\u20DB",triplus:"\u2A39",trisb:"\u29CD",tritime:"\u2A3B",trpezium:"\u23E2",Tscr:"\u{1D4AF}",tscr:"\u{1D4C9}",TScy:"\u0426",tscy:"\u0446",TSHcy:"\u040B",tshcy:"\u045B",Tstrok:"\u0166",tstrok:"\u0167",twixt:"\u226C",twoheadleftarrow:"\u219E",twoheadrightarrow:"\u21A0",Uacute:"\xDA",uacute:"\xFA",Uarr:"\u219F",uArr:"\u21D1",uarr:"\u2191",Uarrocir:"\u2949",Ubrcy:"\u040E",ubrcy:"\u045E",Ubreve:"\u016C",ubreve:"\u016D",Ucirc:"\xDB",ucirc:"\xFB",Ucy:"\u0423",ucy:"\u0443",udarr:"\u21C5",Udblac:"\u0170",udblac:"\u0171",udhar:"\u296E",ufisht:"\u297E",Ufr:"\u{1D518}",ufr:"\u{1D532}",Ugrave:"\xD9",ugrave:"\xF9",uHar:"\u2963",uharl:"\u21BF",uharr:"\u21BE",uhblk:"\u2580",ulcorn:"\u231C",ulcorner:"\u231C",ulcrop:"\u230F",ultri:"\u25F8",Umacr:"\u016A",umacr:"\u016B",uml:"\xA8",UnderBar:"_",UnderBrace:"\u23DF",UnderBracket:"\u23B5",UnderParenthesis:"\u23DD",Union:"\u22C3",UnionPlus:"\u228E",Uogon:"\u0172",uogon:"\u0173",Uopf:"\u{1D54C}",uopf:"\u{1D566}",UpArrow:"\u2191",Uparrow:"\u21D1",uparrow:"\u2191",UpArrowBar:"\u2912",UpArrowDownArrow:"\u21C5",UpDownArrow:"\u2195",Updownarrow:"\u21D5",updownarrow:"\u2195",UpEquilibrium:"\u296E",upharpoonleft:"\u21BF",upharpoonright:"\u21BE",uplus:"\u228E",UpperLeftArrow:"\u2196",UpperRightArrow:"\u2197",Upsi:"\u03D2",upsi:"\u03C5",upsih:"\u03D2",Upsilon:"\u03A5",upsilon:"\u03C5",UpTee:"\u22A5",UpTeeArrow:"\u21A5",upuparrows:"\u21C8",urcorn:"\u231D",urcorner:"\u231D",urcrop:"\u230E",Uring:"\u016E",uring:"\u016F",urtri:"\u25F9",Uscr:"\u{1D4B0}",uscr:"\u{1D4CA}",utdot:"\u22F0",Utilde:"\u0168",utilde:"\u0169",utri:"\u25B5",utrif:"\u25B4",uuarr:"\u21C8",Uuml:"\xDC",uuml:"\xFC",uwangle:"\u29A7",vangrt:"\u299C",varepsilon:"\u03F5",varkappa:"\u03F0",varnothing:"\u2205",varphi:"\u03D5",varpi:"\u03D6",varpropto:"\u221D",vArr:"\u21D5",varr:"\u2195",varrho:"\u03F1",varsigma:"\u03C2",varsubsetneq:"\u228A\uFE00",varsubsetneqq:"\u2ACB\uFE00",varsupsetneq:"\u228B\uFE00",varsupsetneqq:"\u2ACC\uFE00",vartheta:"\u03D1",vartriangleleft:"\u22B2",vartriangleright:"\u22B3",Vbar:"\u2AEB",vBar:"\u2AE8",vBarv:"\u2AE9",Vcy:"\u0412",vcy:"\u0432",VDash:"\u22AB",Vdash:"\u22A9",vDash:"\u22A8",vdash:"\u22A2",Vdashl:"\u2AE6",Vee:"\u22C1",vee:"\u2228",veebar:"\u22BB",veeeq:"\u225A",vellip:"\u22EE",Verbar:"\u2016",verbar:"|",Vert:"\u2016",vert:"|",VerticalBar:"\u2223",VerticalLine:"|",VerticalSeparator:"\u2758",VerticalTilde:"\u2240",VeryThinSpace:"\u200A",Vfr:"\u{1D519}",vfr:"\u{1D533}",vltri:"\u22B2",vnsub:"\u2282\u20D2",vnsup:"\u2283\u20D2",Vopf:"\u{1D54D}",vopf:"\u{1D567}",vprop:"\u221D",vrtri:"\u22B3",Vscr:"\u{1D4B1}",vscr:"\u{1D4CB}",vsubnE:"\u2ACB\uFE00",vsubne:"\u228A\uFE00",vsupnE:"\u2ACC\uFE00",vsupne:"\u228B\uFE00",Vvdash:"\u22AA",vzigzag:"\u299A",Wcirc:"\u0174",wcirc:"\u0175",wedbar:"\u2A5F",Wedge:"\u22C0",wedge:"\u2227",wedgeq:"\u2259",weierp:"\u2118",Wfr:"\u{1D51A}",wfr:"\u{1D534}",Wopf:"\u{1D54E}",wopf:"\u{1D568}",wp:"\u2118",wr:"\u2240",wreath:"\u2240",Wscr:"\u{1D4B2}",wscr:"\u{1D4CC}",xcap:"\u22C2",xcirc:"\u25EF",xcup:"\u22C3",xdtri:"\u25BD",Xfr:"\u{1D51B}",xfr:"\u{1D535}",xhArr:"\u27FA",xharr:"\u27F7",Xi:"\u039E",xi:"\u03BE",xlArr:"\u27F8",xlarr:"\u27F5",xmap:"\u27FC",xnis:"\u22FB",xodot:"\u2A00",Xopf:"\u{1D54F}",xopf:"\u{1D569}",xoplus:"\u2A01",xotime:"\u2A02",xrArr:"\u27F9",xrarr:"\u27F6",Xscr:"\u{1D4B3}",xscr:"\u{1D4CD}",xsqcup:"\u2A06",xuplus:"\u2A04",xutri:"\u25B3",xvee:"\u22C1",xwedge:"\u22C0",Yacute:"\xDD",yacute:"\xFD",YAcy:"\u042F",yacy:"\u044F",Ycirc:"\u0176",ycirc:"\u0177",Ycy:"\u042B",ycy:"\u044B",yen:"\xA5",Yfr:"\u{1D51C}",yfr:"\u{1D536}",YIcy:"\u0407",yicy:"\u0457",Yopf:"\u{1D550}",yopf:"\u{1D56A}",Yscr:"\u{1D4B4}",yscr:"\u{1D4CE}",YUcy:"\u042E",yucy:"\u044E",Yuml:"\u0178",yuml:"\xFF",Zacute:"\u0179",zacute:"\u017A",Zcaron:"\u017D",zcaron:"\u017E",Zcy:"\u0417",zcy:"\u0437",Zdot:"\u017B",zdot:"\u017C",zeetrf:"\u2128",ZeroWidthSpace:"\u200B",Zeta:"\u0396",zeta:"\u03B6",Zfr:"\u2128",zfr:"\u{1D537}",ZHcy:"\u0416",zhcy:"\u0436",zigrarr:"\u21DD",Zopf:"\u2124",zopf:"\u{1D56B}",Zscr:"\u{1D4B5}",zscr:"\u{1D4CF}",zwj:"\u200D",zwnj:"\u200C"}),Mt.entityMap=Mt.HTML_ENTITIES},65952:function(Kt,Mt,ft){var lt,ae=ft(42444);lt=ae.DOMImplementation,lt=ae.XMLSerializer,Mt.DOMParser=ft(16066).DOMParser},12128:function(Kt,Mt,ft){var lt=ft(18859).NAMESPACE,ae=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Ze=new RegExp("[\\-\\.0-9"+ae.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),_e=new RegExp("^"+ae.source+Ze.source+"*(?::"+ae.source+Ze.source+"*)?$"),tt=0,fe=1,Ee=2,ye=3,se=4,te=5,Q=6,w=7;function y(F,K){this.message=F,this.locator=K,Error.captureStackTrace&&Error.captureStackTrace(this,y)}y.prototype=new Error,y.prototype.name=y.name;function $(){}$.prototype={parse:function(F,K,ne){var de=this.domBuilder;de.startDocument(),V(K,K={}),D(F,K,ne,de,this.errorHandler),de.endDocument()}};function D(F,K,ne,de,ve){function De(pt){if(pt>65535){pt-=65536;var vi=55296+(pt>>10),xi=56320+(pt&1023);return String.fromCharCode(vi,xi)}else return String.fromCharCode(pt)}function Se(pt){var vi=pt.slice(1,-1);return Object.hasOwnProperty.call(ne,vi)?ne[vi]:vi.charAt(0)==="#"?De(parseInt(vi.substr(1).replace("x","0x"))):(ve.error("entity not found:"+pt),pt)}function Ce(pt){if(pt>nt){var vi=F.substring(nt,pt).replace(/&#?\w+;/g,Se);dt&&Be(nt),de.characters(vi,0,pt-nt),nt=pt}}function Be(pt,vi){for(;pt>=Ne&&(vi=Re.exec(F));)ke=vi.index,Ne=ke+vi[0].length,dt.lineNumber++;dt.columnNumber=pt-ke+1}for(var ke=0,Ne=0,Re=/.*(?:\r\n?|\n)|.*$/g,dt=de.locator,wt=[{currentNSMap:K}],It={},nt=0;;){try{var ot=F.indexOf("<",nt);if(ot<0){if(!F.substr(nt).match(/^\s*$/)){var ti=de.doc,bt=ti.createTextNode(F.substr(nt));ti.appendChild(bt),de.currentElement=bt}return}switch(ot>nt&&Ce(ot),F.charAt(ot+1)){case"/":var Vt=F.indexOf(">",ot+3),si=F.substring(ot+2,Vt).replace(/[ \t\n\r]+$/g,""),Xt=wt.pop();Vt<0?(si=F.substring(ot+2).replace(/[\s<].*/,""),ve.error("end tag name: "+si+" is not complete:"+Xt.tagName),Vt=ot+1+si.length):si.match(/\s</)&&(si=si.replace(/[\s<].*/,""),ve.error("end tag name: "+si+" maybe not complete"),Vt=ot+1+si.length);var _i=Xt.localNSMap,yi=Xt.tagName==si,xt=yi||Xt.tagName&&Xt.tagName.toLowerCase()==si.toLowerCase();if(xt){if(de.endElement(Xt.uri,Xt.localName,si),_i)for(var Qt in _i)Object.prototype.hasOwnProperty.call(_i,Qt)&&de.endPrefixMapping(Qt);yi||ve.fatalError("end tag name: "+si+" is not match the current start tagName:"+Xt.tagName)}else wt.push(Xt);Vt++;break;case"?":dt&&Be(ot),Vt=Z(F,ot,de);break;case"!":dt&&Be(ot),Vt=T(F,ot,de,ve);break;default:dt&&Be(ot);var li=new ie,Ki=wt[wt.length-1].currentNSMap,Vt=z(F,ot,li,Ki,Se,ve),Ji=li.length;if(!li.closed&&j(F,Vt,li.tagName,It)&&(li.closed=!0,ne.nbsp||ve.warning("unclosed xml attribute")),dt&&Ji){for(var $i=G(dt,{}),cn=0;cn<Ji;cn++){var sn=li[cn];Be(sn.offset),sn.locator=G(dt,{})}de.locator=$i,P(li,de,Ki)&&wt.push(li),de.locator=dt}else P(li,de,Ki)&&wt.push(li);lt.isHTML(li.uri)&&!li.closed?Vt=H(F,Vt,li.tagName,Se,de):Vt++}}catch(pt){if(pt instanceof y)throw pt;ve.error("element parse error: "+pt),Vt=-1}Vt>nt?nt=Vt:Ce(Math.max(ot,nt)+1)}}function G(F,K){return K.lineNumber=F.lineNumber,K.columnNumber=F.columnNumber,K}function z(F,K,ne,de,ve,De){function Se(wt,It,nt){ne.attributeNames.hasOwnProperty(wt)&&De.fatalError("Attribute "+wt+" redefined"),ne.addValue(wt,It.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,ve),nt)}for(var Ce,Be,ke=++K,Ne=tt;;){var Re=F.charAt(ke);switch(Re){case"=":if(Ne===fe)Ce=F.slice(K,ke),Ne=ye;else if(Ne===Ee)Ne=ye;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(Ne===ye||Ne===fe)if(Ne===fe&&(De.warning('attribute value must after "="'),Ce=F.slice(K,ke)),K=ke+1,ke=F.indexOf(Re,K),ke>0)Be=F.slice(K,ke),Se(Ce,Be,K-1),Ne=te;else throw new Error("attribute value no end '"+Re+"' match");else if(Ne==se)Be=F.slice(K,ke),Se(Ce,Be,K),De.warning('attribute "'+Ce+'" missed start quot('+Re+")!!"),K=ke+1,Ne=te;else throw new Error('attribute value must after "="');break;case"/":switch(Ne){case tt:ne.setTagName(F.slice(K,ke));case te:case Q:case w:Ne=w,ne.closed=!0;case se:case fe:break;case Ee:ne.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return De.error("unexpected end of input"),Ne==tt&&ne.setTagName(F.slice(K,ke)),ke;case">":switch(Ne){case tt:ne.setTagName(F.slice(K,ke));case te:case Q:case w:break;case se:case fe:Be=F.slice(K,ke),Be.slice(-1)==="/"&&(ne.closed=!0,Be=Be.slice(0,-1));case Ee:Ne===Ee&&(Be=Ce),Ne==se?(De.warning('attribute "'+Be+'" missed quot(")!'),Se(Ce,Be,K)):((!lt.isHTML(de[""])||!Be.match(/^(?:disabled|checked|selected)$/i))&&De.warning('attribute "'+Be+'" missed value!! "'+Be+'" instead!!'),Se(Be,Be,K));break;case ye:throw new Error("attribute value missed!!")}return ke;case"\x80":Re=" ";default:if(Re<=" ")switch(Ne){case tt:ne.setTagName(F.slice(K,ke)),Ne=Q;break;case fe:Ce=F.slice(K,ke),Ne=Ee;break;case se:var Be=F.slice(K,ke);De.warning('attribute "'+Be+'" missed quot(")!!'),Se(Ce,Be,K);case te:Ne=Q;break}else switch(Ne){case Ee:var dt=ne.tagName;(!lt.isHTML(de[""])||!Ce.match(/^(?:disabled|checked|selected)$/i))&&De.warning('attribute "'+Ce+'" missed value!! "'+Ce+'" instead2!!'),Se(Ce,Ce,K),K=ke,Ne=fe;break;case te:De.warning('attribute space is required"'+Ce+'"!!');case Q:Ne=fe,K=ke;break;case ye:Ne=se,K=ke;break;case w:throw new Error("elements closed character '/' and '>' must be connected to")}}ke++}}function P(F,K,ne){for(var de=F.tagName,ve=null,De=F.length;De--;){var Se=F[De],Ce=Se.qName,Be=Se.value,dt=Ce.indexOf(":");if(dt>0)var ke=Se.prefix=Ce.slice(0,dt),Ne=Ce.slice(dt+1),Re=ke==="xmlns"&&Ne;else Ne=Ce,ke=null,Re=Ce==="xmlns"&&"";Se.localName=Ne,Re!==!1&&(ve==null&&(ve={},V(ne,ne={})),ne[Re]=ve[Re]=Be,Se.uri=lt.XMLNS,K.startPrefixMapping(Re,Be))}for(var De=F.length;De--;){Se=F[De];var ke=Se.prefix;ke&&(ke==="xml"&&(Se.uri=lt.XML),ke!=="xmlns"&&(Se.uri=ne[ke||""]))}var dt=de.indexOf(":");dt>0?(ke=F.prefix=de.slice(0,dt),Ne=F.localName=de.slice(dt+1)):(ke=null,Ne=F.localName=de);var wt=F.uri=ne[ke||""];if(K.startElement(wt,Ne,de,F),F.closed){if(K.endElement(wt,Ne,de),ve)for(ke in ve)Object.prototype.hasOwnProperty.call(ve,ke)&&K.endPrefixMapping(ke)}else return F.currentNSMap=ne,F.localNSMap=ve,!0}function H(F,K,ne,de,ve){if(/^(?:script|textarea)$/i.test(ne)){var De=F.indexOf("</"+ne+">",K),Se=F.substring(K+1,De);if(/[&<]/.test(Se))return/^script$/i.test(ne)?(ve.characters(Se,0,Se.length),De):(Se=Se.replace(/&#?\w+;/g,de),ve.characters(Se,0,Se.length),De)}return K+1}function j(F,K,ne,de){var ve=de[ne];return ve==null&&(ve=F.lastIndexOf("</"+ne+">"),ve<K&&(ve=F.lastIndexOf("</"+ne)),de[ne]=ve),ve<K}function V(F,K){for(var ne in F)Object.prototype.hasOwnProperty.call(F,ne)&&(K[ne]=F[ne])}function T(F,K,ne,de){var ve=F.charAt(K+2);switch(ve){case"-":if(F.charAt(K+3)==="-"){var De=F.indexOf("-->",K+4);return De>K?(ne.comment(F,K+4,De-K-4),De+3):(de.error("Unclosed comment"),-1)}else return-1;default:if(F.substr(K+3,6)=="CDATA["){var De=F.indexOf("]]>",K+9);return ne.startCDATA(),ne.characters(F,K+9,De-K-9),ne.endCDATA(),De+3}var Se=le(F,K),Ce=Se.length;if(Ce>1&&/!doctype/i.test(Se[0][0])){var Be=Se[1][0],ke=!1,Ne=!1;Ce>3&&(/^public$/i.test(Se[2][0])?(ke=Se[3][0],Ne=Ce>4&&Se[4][0]):/^system$/i.test(Se[2][0])&&(Ne=Se[3][0]));var Re=Se[Ce-1];return ne.startDTD(Be,ke,Ne),ne.endDTD(),Re.index+Re[0].length}}return-1}function Z(F,K,ne){var de=F.indexOf("?>",K);if(de){var ve=F.substring(K,de).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(ve){var De=ve[0].length;return ne.processingInstruction(ve[1],ve[2]),de+2}else return-1}return-1}function ie(){this.attributeNames={}}ie.prototype={setTagName:function(F){if(!_e.test(F))throw new Error("invalid tagName:"+F);this.tagName=F},addValue:function(F,K,ne){if(!_e.test(F))throw new Error("invalid attribute:"+F);this.attributeNames[F]=this.length,this[this.length++]={qName:F,value:K,offset:ne}},length:0,getLocalName:function(F){return this[F].localName},getLocator:function(F){return this[F].locator},getQName:function(F){return this[F].qName},getURI:function(F){return this[F].uri},getValue:function(F){return this[F].value}};function le(F,K){var ne,de=[],ve=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(ve.lastIndex=K,ve.exec(F);ne=ve.exec(F);)if(de.push(ne),ne[1])return de}Mt.XMLReader=$,Mt.ParseError=y},62825:function(Kt,Mt,ft){var lt=ft(19208).Buffer;(function(ae,Ze){Kt.exports=Ze()})(self,()=>(()=>{var ae={916:(fe,Ee,ye)=>{var se=ye(471);fe.exports=function(te){"use strict";var Q,w="",y=(te=te||{}).video,$=te.options,D=se.$escape,G=te.tran,z=te.icons,P=te.index,H=se.$each;return te.$value,te.$index,w+=`<div class="dplayer-mask"></div>
<div class="dplayer-video-wrap">
    `,Q=ye(568)(y),w+=Q,w+=`
    `,$.logo&&(w+=`
    <div class="dplayer-logo">
        <img src="`,w+=D($.logo),w+=`">
    </div>
    `),w+=`
    <div class="dplayer-danmaku"`,$.danmaku&&$.danmaku.bottom&&(w+=' style="margin-bottom:',w+=D($.danmaku.bottom),w+='"'),w+=`>
        <div class="dplayer-danmaku-item dplayer-danmaku-item--demo"></div>
    </div>
    <div class="dplayer-subtitle"></div>
    <div class="dplayer-bezel">
        <span class="dplayer-bezel-icon"></span>
        `,$.danmaku&&(w+=`
        <span class="dplayer-danloading">`,w+=D(G("danmaku-loading")),w+=`</span>
        `),w+=`
        <span class="diplayer-loading-icon">`,w+=z.loading,w+=`</span>
    </div>
</div>
<div class="dplayer-controller-mask"></div>
<div class="dplayer-controller">
    <div class="dplayer-icons dplayer-comment-box">
        <button class="dplayer-icon dplayer-comment-setting-icon" data-balloon="`,w+=D(G("setting")),w+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,w+=z.pallette,w+=`</span>
        </button>
        <div class="dplayer-comment-setting-box">
            <div class="dplayer-comment-setting-color">
                <div class="dplayer-comment-setting-title">`,w+=D(G("set-danmaku-color")),w+=`</div>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,w+=D(P),w+=`" value="#fff" checked>
                    <span style="background: #fff;"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,w+=D(P),w+=`" value="#e54256">
                    <span style="background: #e54256"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,w+=D(P),w+=`" value="#ffe133">
                    <span style="background: #ffe133"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,w+=D(P),w+=`" value="#64DD17">
                    <span style="background: #64DD17"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,w+=D(P),w+=`" value="#39ccff">
                    <span style="background: #39ccff"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,w+=D(P),w+=`" value="#D500F9">
                    <span style="background: #D500F9"></span>
                </label>
            </div>
            <div class="dplayer-comment-setting-type">
                <div class="dplayer-comment-setting-title">`,w+=D(G("set-danmaku-type")),w+=`</div>
                <label>
                    <input type="radio" name="dplayer-danmaku-type-`,w+=D(P),w+=`" value="1">
                    <span>`,w+=D(G("top")),w+=`</span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-type-`,w+=D(P),w+=`" value="0" checked>
                    <span>`,w+=D(G("rolling")),w+=`</span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-type-`,w+=D(P),w+=`" value="2">
                    <span>`,w+=D(G("bottom")),w+=`</span>
                </label>
            </div>
        </div>
        <input class="dplayer-comment-input" type="text" placeholder="`,w+=D(G("input-danmaku-enter")),w+=`" maxlength="30">
        <button class="dplayer-icon dplayer-send-icon" data-balloon="`,w+=D(G("send")),w+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,w+=z.send,w+=`</span>
        </button>
    </div>
    <div class="dplayer-icons dplayer-icons-left">
        <button class="dplayer-icon dplayer-play-icon">
            <span class="dplayer-icon-content">`,w+=z.play,w+=`</span>
        </button>
        <div class="dplayer-volume">
            <button class="dplayer-icon dplayer-volume-icon">
                <span class="dplayer-icon-content">`,w+=z.volumeDown,w+=`</span>
            </button>
            <div class="dplayer-volume-bar-wrap" data-balloon-pos="up">
                <div class="dplayer-volume-bar">
                    <div class="dplayer-volume-bar-inner" style="background: `,w+=D($.theme),w+=`;">
                        <span class="dplayer-thumb" style="background: `,w+=D($.theme),w+=`"></span>
                    </div>
                </div>
            </div>
        </div>
        <span class="dplayer-time">
            <span class="dplayer-ptime">0:00</span> /
            <span class="dplayer-dtime">0:00</span>
        </span>
        `,$.live&&(w+=`
        <span class="dplayer-live-badge"><span class="dplayer-live-dot" style="background: `,w+=D($.theme),w+=';"></span>',w+=D(G("live")),w+=`</span>
        `),w+=`
    </div>
    <div class="dplayer-icons dplayer-icons-right">
        `,$.video.quality&&(w+=`
        <div class="dplayer-quality">
            <button class="dplayer-icon dplayer-quality-icon">`,w+=D($.video.quality[$.video.defaultQuality].name),w+=`</button>
            <div class="dplayer-quality-mask">
                <div class="dplayer-quality-list">
                `,H($.video.quality,function(j,V){w+=`
                    <div class="dplayer-quality-item" data-index="`,w+=D(V),w+='">',w+=D(j.name),w+=`</div>
                `}),w+=`
                </div>
            </div>
        </div>
        `),w+=`
        `,$.screenshot&&(w+=`
        <div class="dplayer-icon dplayer-camera-icon" data-balloon="`,w+=D(G("screenshot")),w+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,w+=z.camera,w+=`</span>
        </div>
        `),w+=`
        `,$.airplay&&(w+=`
        <div class="dplayer-icon dplayer-airplay-icon" data-balloon="`,w+=D(G("airplay")),w+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,w+=z.airplay,w+=`</span>
        </div>
        `),w+=`
        `,$.chromecast&&(w+=`
        <div class="dplayer-icon dplayer-chromecast-icon" data-balloon="`,w+=D(G("chromecast")),w+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,w+=z.chromecast,w+=`</span>
        </div>
        `),w+=`
        <div class="dplayer-comment">
            <button class="dplayer-icon dplayer-comment-icon" data-balloon="`,w+=D(G("send-danmaku")),w+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,w+=z.comment,w+=`</span>
            </button>
        </div>
        `,$.subtitle&&(w+=`
        `,typeof $.subtitle.url=="string"?(w+=`
        <div class="dplayer-subtitle-btn">
            <button class="dplayer-icon dplayer-subtitle-icon" data-balloon="`,w+=D(G("hide-subs")),w+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,w+=z.subtitle,w+=`</span>
            </button>
        </div>
        `):(w+=`
        <div class="dplayer-subtitles">
            <button class="dplayer-icon dplayer-subtitles-icon" data-balloon="`,w+=D(G("subtitle")),w+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,w+=z.subtitle,w+=`</span>
            </button>
            <div class="dplayer-subtitles-box">
                <div class="dplayer-subtitles-panel">
                    `,H($.subtitle.url,function(j,V){w+=`
                        <div class="dplayer-subtitles-item" data-subtitle="`,w+=D(j.url),w+=`">
                            <!-- if lang, show tran(lang). if lang and name, show name + (tran(lang)). if name, show name. off option use lang for translation. -->
                            <span class="dplayer-label">`,w+=D(j.lang?j.name?j.name+" ("+G(j.lang)+")":G(j.lang):j.name),w+=`</span>
                        </div>
                    `}),w+=`
                </div>
            </div>
        </div>
        `),w+=`
        `),w+=`
        <div class="dplayer-setting">
            <button class="dplayer-icon dplayer-setting-icon" data-balloon="`,w+=D(G("setting")),w+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,w+=z.setting,w+=`</span>
            </button>
            <div class="dplayer-setting-box">
                <div class="dplayer-setting-origin-panel">
                    <div class="dplayer-setting-item dplayer-setting-speed">
                        <span class="dplayer-label">`,w+=D(G("speed")),w+=`</span>
                        <div class="dplayer-toggle">`,w+=z.right,w+=`</div>
                    </div>
                    <div class="dplayer-setting-item dplayer-setting-loop">
                        <span class="dplayer-label">`,w+=D(G("loop")),w+=`</span>
                        <div class="dplayer-toggle">
                            <input class="dplayer-toggle-setting-input" type="checkbox" name="dplayer-toggle">
                            <label for="dplayer-toggle"></label>
                        </div>
                    </div>
                    <div class="dplayer-setting-item dplayer-setting-showdan">
                        <span class="dplayer-label">`,w+=D(G("show-danmaku")),w+=`</span>
                        <div class="dplayer-toggle">
                            <input class="dplayer-showdan-setting-input" type="checkbox" name="dplayer-toggle-dan">
                            <label for="dplayer-toggle-dan"></label>
                        </div>
                    </div>
                    <div class="dplayer-setting-item dplayer-setting-danunlimit">
                        <span class="dplayer-label">`,w+=D(G("unlimited-danmaku")),w+=`</span>
                        <div class="dplayer-toggle">
                            <input class="dplayer-danunlimit-setting-input" type="checkbox" name="dplayer-toggle-danunlimit">
                            <label for="dplayer-toggle-danunlimit"></label>
                        </div>
                    </div>
                    <div class="dplayer-setting-item dplayer-setting-danmaku">
                        <span class="dplayer-label">`,w+=D(G("opacity-danmaku")),w+=`</span>
                        <div class="dplayer-danmaku-bar-wrap">
                            <div class="dplayer-danmaku-bar">
                                <div class="dplayer-danmaku-bar-inner">
                                    <span class="dplayer-thumb"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="dplayer-setting-speed-panel">
                    `,H($.playbackSpeed,function(j,V){w+=`
                        <div class="dplayer-setting-speed-item" data-speed="`,w+=D(j),w+=`">
                            <span class="dplayer-label">`,w+=D(j===1?G("normal"):j),w+=`</span>
                        </div>
                    `}),w+=`
                </div>
            </div>
        </div>
        <div class="dplayer-full">
            <button class="dplayer-icon dplayer-full-in-icon" data-balloon="`,w+=D(G("web-fullscreen")),w+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,w+=z.fullWeb,w+=`</span>
            </button>
            <button class="dplayer-icon dplayer-full-icon" data-balloon="`,w+=D(G("fullscreen")),w+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,w+=z.full,w+=`</span>
            </button>
        </div>
    </div>
    <div class="dplayer-bar-wrap">
        <div class="dplayer-bar-time hidden">00:00</div>
        <div class="dplayer-bar-preview"></div>
        <div class="dplayer-bar">
            <div class="dplayer-loaded" style="width: 0;"></div>
            <div class="dplayer-played" style="width: 0; background: `,w+=D($.theme),w+=`">
                <span class="dplayer-thumb" style="background: `,w+=D($.theme),w+=`"></span>
            </div>
        </div>
    </div>
</div>
<div class="dplayer-info-panel dplayer-info-panel-hide">
    <div class="dplayer-info-panel-close">[x]</div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-version">
        <span class="dplayer-info-panel-item-title">Player version</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-fps">
        <span class="dplayer-info-panel-item-title">Player FPS</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-type">
        <span class="dplayer-info-panel-item-title">Video type</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-url">
        <span class="dplayer-info-panel-item-title">Video url</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-resolution">
        <span class="dplayer-info-panel-item-title">Video resolution</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-duration">
        <span class="dplayer-info-panel-item-title">Video duration</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    `,$.danmaku&&(w+=`
    <div class="dplayer-info-panel-item dplayer-info-panel-item-danmaku-id">
        <span class="dplayer-info-panel-item-title">Danmaku id</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-danmaku-api">
        <span class="dplayer-info-panel-item-title">Danmaku api</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-danmaku-amount">
        <span class="dplayer-info-panel-item-title">Danmaku amount</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    `),w+=`
</div>
<div class="dplayer-menu">
    `,H($.contextmenu,function(j,V){w+=`
        <div class="dplayer-menu-item">
            <a`,j.link&&(w+=' target="_blank"'),w+=' href="',w+=D(j.link||"javascript:void(0);"),w+='">',j.key&&(w+=" ",w+=D(G(j.key))),j.text&&(w+=" ",w+=D(j.text)),w+=`</a>
        </div>
    `}),w+=`
</div>
<div class="dplayer-notice-list"></div>
<button class="dplayer-mobile-play">
    `,w+=z.play,w+=`
</button>`}},568:(fe,Ee,ye)=>{var se=ye(471);fe.exports=function(te){"use strict";var Q="",w=(te=te||{}).enableSubtitle,y=te.subtitle,$=te.current,D=te.airplay,G=te.pic,z=se.$escape,P=te.screenshot,H=te.preload,j=te.url;return w=y&&y.type==="webvtt",Q+=`
<video
    class="dplayer-video `,$&&(Q+="dplayer-video-current"),Q+=`"
    webkit-playsinline
    `,D&&(Q+=' x-webkit-airplay="allow" '),Q+=`
    playsinline
    `,G&&(Q+='poster="',Q+=z(G),Q+='"'),Q+=`
    `,(P||w)&&(Q+='crossorigin="anonymous"'),Q+=`
    `,H&&(Q+='preload="',Q+=z(H),Q+='"'),Q+=`
    `,D?Q+=`
    nosrc
    `:j&&(Q+=`
    src="`,Q+=z(j),Q+=`"
    `),Q+=`
    >
    `,D&&(Q+=`
    <source src="`,Q+=z(j),Q+=`">
    `),Q+=`
    `,w&&(Q+=`
    <track class="dplayer-subtrack" kind="metadata" default src="`,Q+=z(typeof y.url=="string"?y.url:y.url[y.index].url),Q+=`"></track>
    `),Q+`
</video>`}},49:(fe,Ee,ye)=>{"use strict";ye.d(Ee,{Z:()=>y});var se=ye(415),te=ye.n(se),Q=ye(352),w=ye.n(Q)()(te());w.push([fe.id,`:root {
  --balloon-border-radius: 2px;
  --balloon-color: rgba(16, 16, 16, 0.95);
  --balloon-text-color: #fff;
  --balloon-font-size: 12px;
  --balloon-move: 4px; }

button[aria-label][data-balloon-pos] {
  overflow: visible; }

[aria-label][data-balloon-pos] {
  position: relative;
  cursor: pointer; }
  [aria-label][data-balloon-pos]:after {
    opacity: 0;
    pointer-events: none;
    transition: all 0.18s ease-out 0.18s;
    text-indent: 0;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
    font-weight: normal;
    font-style: normal;
    text-shadow: none;
    font-size: 12px;
    font-size: var(--balloon-font-size);
    background: rgba(16, 16, 16, 0.95);
    background: var(--balloon-color);
    border-radius: 2px;
    color: #fff;
    color: var(--balloon-text-color);
    border-radius: var(--balloon-border-radius);
    content: attr(aria-label);
    padding: .5em 1em;
    position: absolute;
    white-space: nowrap;
    z-index: 10; }
  [aria-label][data-balloon-pos]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-top-color: rgba(16, 16, 16, 0.95);
    border-top-color: var(--balloon-color);
    opacity: 0;
    pointer-events: none;
    transition: all 0.18s ease-out 0.18s;
    content: "";
    position: absolute;
    z-index: 10; }
  [aria-label][data-balloon-pos]:hover:before, [aria-label][data-balloon-pos]:hover:after, [aria-label][data-balloon-pos][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-visible]:after, [aria-label][data-balloon-pos]:not([data-balloon-nofocus]):focus:before, [aria-label][data-balloon-pos]:not([data-balloon-nofocus]):focus:after {
    opacity: 1;
    pointer-events: none; }
  [aria-label][data-balloon-pos].font-awesome:after {
    font-family: FontAwesome, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; }
  [aria-label][data-balloon-pos][data-balloon-break]:after {
    white-space: pre; }
  [aria-label][data-balloon-pos][data-balloon-break][data-balloon-length]:after {
    white-space: pre-line;
    word-break: break-word; }
  [aria-label][data-balloon-pos][data-balloon-blunt]:before, [aria-label][data-balloon-pos][data-balloon-blunt]:after {
    transition: none; }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="up"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos="down"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="down"][data-balloon-visible]:after {
    transform: translate(-50%, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="up"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos="down"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="down"][data-balloon-visible]:before {
    transform: translate(-50%, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos*="-left"]:after {
    left: 0; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-left"]:before {
    left: 5px; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:after {
    right: 0; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:before {
    right: 5px; }
  [aria-label][data-balloon-pos][data-balloon-po*="-left"]:hover:after, [aria-label][data-balloon-pos][data-balloon-po*="-left"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos*="-right"][data-balloon-visible]:after {
    transform: translate(0, 0); }
  [aria-label][data-balloon-pos][data-balloon-po*="-left"]:hover:before, [aria-label][data-balloon-pos][data-balloon-po*="-left"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos*="-right"][data-balloon-visible]:before {
    transform: translate(0, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos^="up"]:before, [aria-label][data-balloon-pos][data-balloon-pos^="up"]:after {
    bottom: 100%;
    transform-origin: top;
    transform: translate(0, 4px);
    transform: translate(0, var(--balloon-move)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="up"]:after {
    margin-bottom: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:before, [aria-label][data-balloon-pos][data-balloon-pos="up"]:after {
    left: 50%;
    transform: translate(-50%, 4px);
    transform: translate(-50%, var(--balloon-move)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:before, [aria-label][data-balloon-pos][data-balloon-pos^="down"]:after {
    top: 100%;
    transform: translate(0, calc(4px * -1));
    transform: translate(0, calc(var(--balloon-move) * -1)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:after {
    margin-top: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-bottom-color: rgba(16, 16, 16, 0.95);
    border-bottom-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-pos="down"]:after, [aria-label][data-balloon-pos][data-balloon-pos="down"]:before {
    left: 50%;
    transform: translate(-50%, calc(4px * -1));
    transform: translate(-50%, calc(var(--balloon-move) * -1)); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="left"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos="right"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="right"][data-balloon-visible]:after {
    transform: translate(0, -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="left"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos="right"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="right"][data-balloon-visible]:before {
    transform: translate(0, -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:after, [aria-label][data-balloon-pos][data-balloon-pos="left"]:before {
    right: 100%;
    top: 50%;
    transform: translate(4px, -50%);
    transform: translate(var(--balloon-move), -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:after {
    margin-right: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-left-color: rgba(16, 16, 16, 0.95);
    border-left-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:after, [aria-label][data-balloon-pos][data-balloon-pos="right"]:before {
    left: 100%;
    top: 50%;
    transform: translate(calc(4px * -1), -50%);
    transform: translate(calc(var(--balloon-move) * -1), -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:after {
    margin-left: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-right-color: rgba(16, 16, 16, 0.95);
    border-right-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-length]:after {
    white-space: normal; }
  [aria-label][data-balloon-pos][data-balloon-length="small"]:after {
    width: 80px; }
  [aria-label][data-balloon-pos][data-balloon-length="medium"]:after {
    width: 150px; }
  [aria-label][data-balloon-pos][data-balloon-length="large"]:after {
    width: 260px; }
  [aria-label][data-balloon-pos][data-balloon-length="xlarge"]:after {
    width: 380px; }
    @media screen and (max-width: 768px) {
      [aria-label][data-balloon-pos][data-balloon-length="xlarge"]:after {
        width: 90vw; } }
  [aria-label][data-balloon-pos][data-balloon-length="fit"]:after {
    width: 100%; }
`,"",{version:3,sources:["webpack://./node_modules/.pnpm/balloon-css@1.2.0/node_modules/balloon-css/balloon.css"],names:[],mappings:"AAAA;EACE,4BAA4B;EAC5B,uCAAuC;EACvC,0BAA0B;EAC1B,yBAAyB;EACzB,mBAAmB,EAAE;;AAEvB;EACE,iBAAiB,EAAE;;AAErB;EACE,kBAAkB;EAClB,eAAe,EAAE;EACjB;IACE,UAAU;IACV,oBAAoB;IACpB,oCAAoC;IACpC,cAAc;IACd,wIAAwI;IACxI,mBAAmB;IACnB,kBAAkB;IAClB,iBAAiB;IACjB,eAAmC;IAAnC,mCAAmC;IACnC,kCAAgC;IAAhC,gCAAgC;IAChC,kBAAkB;IAClB,WAAgC;IAAhC,gCAAgC;IAChC,2CAA2C;IAC3C,yBAAyB;IACzB,iBAAiB;IACjB,kBAAkB;IAClB,mBAAmB;IACnB,WAAW,EAAE;EACf;IACE,QAAQ;IACR,SAAS;IACT,6BAA6B;IAC7B,wCAAsC;IAAtC,sCAAsC;IACtC,UAAU;IACV,oBAAoB;IACpB,oCAAoC;IACpC,WAAW;IACX,kBAAkB;IAClB,WAAW,EAAE;EACf;IACE,UAAU;IACV,oBAAoB,EAAE;EACxB;IACE,qJAAqJ,EAAE;EACzJ;IACE,gBAAgB,EAAE;EACpB;IACE,qBAAqB;IACrB,sBAAsB,EAAE;EAC1B;IACE,gBAAgB,EAAE;EACpB;IACE,6BAA6B,EAAE;EACjC;IACE,6BAA6B,EAAE;EACjC;IACE,OAAO,EAAE;EACX;IACE,SAAS,EAAE;EACb;IACE,QAAQ,EAAE;EACZ;IACE,UAAU,EAAE;EACd;IACE,0BAA0B,EAAE;EAC9B;IACE,0BAA0B,EAAE;EAC9B;IACE,YAAY;IACZ,qBAAqB;IACrB,4BAA4C;IAA5C,4CAA4C,EAAE;EAChD;IACE,mBAAmB,EAAE;EACvB;IACE,SAAS;IACT,+BAA+C;IAA/C,+CAA+C,EAAE;EACnD;IACE,SAAS;IACT,uCAAuD;IAAvD,uDAAuD,EAAE;EAC3D;IACE,gBAAgB,EAAE;EACpB;IACE,QAAQ;IACR,SAAS;IACT,6BAA6B;IAC7B,2CAAyC;IAAzC,yCAAyC,EAAE;EAC7C;IACE,SAAS;IACT,0CAA0D;IAA1D,0DAA0D,EAAE;EAC9D;IACE,6BAA6B,EAAE;EACjC;IACE,6BAA6B,EAAE;EACjC;IACE,WAAW;IACX,QAAQ;IACR,+BAA+C;IAA/C,+CAA+C,EAAE;EACnD;IACE,kBAAkB,EAAE;EACtB;IACE,QAAQ;IACR,SAAS;IACT,6BAA6B;IAC7B,yCAAuC;IAAvC,uCAAuC,EAAE;EAC3C;IACE,UAAU;IACV,QAAQ;IACR,0CAA0D;IAA1D,0DAA0D,EAAE;EAC9D;IACE,iBAAiB,EAAE;EACrB;IACE,QAAQ;IACR,SAAS;IACT,6BAA6B;IAC7B,0CAAwC;IAAxC,wCAAwC,EAAE;EAC5C;IACE,mBAAmB,EAAE;EACvB;IACE,WAAW,EAAE;EACf;IACE,YAAY,EAAE;EAChB;IACE,YAAY,EAAE;EAChB;IACE,YAAY,EAAE;IACd;MACE;QACE,WAAW,EAAE,EAAE;EACrB;IACE,WAAW,EAAE",sourcesContent:[`:root {
  --balloon-border-radius: 2px;
  --balloon-color: rgba(16, 16, 16, 0.95);
  --balloon-text-color: #fff;
  --balloon-font-size: 12px;
  --balloon-move: 4px; }

button[aria-label][data-balloon-pos] {
  overflow: visible; }

[aria-label][data-balloon-pos] {
  position: relative;
  cursor: pointer; }
  [aria-label][data-balloon-pos]:after {
    opacity: 0;
    pointer-events: none;
    transition: all 0.18s ease-out 0.18s;
    text-indent: 0;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
    font-weight: normal;
    font-style: normal;
    text-shadow: none;
    font-size: var(--balloon-font-size);
    background: var(--balloon-color);
    border-radius: 2px;
    color: var(--balloon-text-color);
    border-radius: var(--balloon-border-radius);
    content: attr(aria-label);
    padding: .5em 1em;
    position: absolute;
    white-space: nowrap;
    z-index: 10; }
  [aria-label][data-balloon-pos]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-top-color: var(--balloon-color);
    opacity: 0;
    pointer-events: none;
    transition: all 0.18s ease-out 0.18s;
    content: "";
    position: absolute;
    z-index: 10; }
  [aria-label][data-balloon-pos]:hover:before, [aria-label][data-balloon-pos]:hover:after, [aria-label][data-balloon-pos][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-visible]:after, [aria-label][data-balloon-pos]:not([data-balloon-nofocus]):focus:before, [aria-label][data-balloon-pos]:not([data-balloon-nofocus]):focus:after {
    opacity: 1;
    pointer-events: none; }
  [aria-label][data-balloon-pos].font-awesome:after {
    font-family: FontAwesome, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; }
  [aria-label][data-balloon-pos][data-balloon-break]:after {
    white-space: pre; }
  [aria-label][data-balloon-pos][data-balloon-break][data-balloon-length]:after {
    white-space: pre-line;
    word-break: break-word; }
  [aria-label][data-balloon-pos][data-balloon-blunt]:before, [aria-label][data-balloon-pos][data-balloon-blunt]:after {
    transition: none; }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="up"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos="down"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="down"][data-balloon-visible]:after {
    transform: translate(-50%, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="up"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos="down"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="down"][data-balloon-visible]:before {
    transform: translate(-50%, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos*="-left"]:after {
    left: 0; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-left"]:before {
    left: 5px; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:after {
    right: 0; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:before {
    right: 5px; }
  [aria-label][data-balloon-pos][data-balloon-po*="-left"]:hover:after, [aria-label][data-balloon-pos][data-balloon-po*="-left"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos*="-right"][data-balloon-visible]:after {
    transform: translate(0, 0); }
  [aria-label][data-balloon-pos][data-balloon-po*="-left"]:hover:before, [aria-label][data-balloon-pos][data-balloon-po*="-left"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos*="-right"][data-balloon-visible]:before {
    transform: translate(0, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos^="up"]:before, [aria-label][data-balloon-pos][data-balloon-pos^="up"]:after {
    bottom: 100%;
    transform-origin: top;
    transform: translate(0, var(--balloon-move)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="up"]:after {
    margin-bottom: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:before, [aria-label][data-balloon-pos][data-balloon-pos="up"]:after {
    left: 50%;
    transform: translate(-50%, var(--balloon-move)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:before, [aria-label][data-balloon-pos][data-balloon-pos^="down"]:after {
    top: 100%;
    transform: translate(0, calc(var(--balloon-move) * -1)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:after {
    margin-top: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-bottom-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-pos="down"]:after, [aria-label][data-balloon-pos][data-balloon-pos="down"]:before {
    left: 50%;
    transform: translate(-50%, calc(var(--balloon-move) * -1)); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="left"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos="right"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="right"][data-balloon-visible]:after {
    transform: translate(0, -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="left"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos="right"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="right"][data-balloon-visible]:before {
    transform: translate(0, -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:after, [aria-label][data-balloon-pos][data-balloon-pos="left"]:before {
    right: 100%;
    top: 50%;
    transform: translate(var(--balloon-move), -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:after {
    margin-right: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-left-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:after, [aria-label][data-balloon-pos][data-balloon-pos="right"]:before {
    left: 100%;
    top: 50%;
    transform: translate(calc(var(--balloon-move) * -1), -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:after {
    margin-left: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-right-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-length]:after {
    white-space: normal; }
  [aria-label][data-balloon-pos][data-balloon-length="small"]:after {
    width: 80px; }
  [aria-label][data-balloon-pos][data-balloon-length="medium"]:after {
    width: 150px; }
  [aria-label][data-balloon-pos][data-balloon-length="large"]:after {
    width: 260px; }
  [aria-label][data-balloon-pos][data-balloon-length="xlarge"]:after {
    width: 380px; }
    @media screen and (max-width: 768px) {
      [aria-label][data-balloon-pos][data-balloon-length="xlarge"]:after {
        width: 90vw; } }
  [aria-label][data-balloon-pos][data-balloon-length="fit"]:after {
    width: 100%; }
`],sourceRoot:""}]);const y=w},685:(fe,Ee,ye)=>{"use strict";ye.d(Ee,{Z:()=>H});var se=ye(415),te=ye.n(se),Q=ye(352),w=ye.n(Q),y=ye(49),$=ye(80),D=ye.n($),G=new URL(ye(831),ye.b),z=w()(te());z.i(y.Z);var P=D()(G);z.push([fe.id,`@keyframes my-face {
  2% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  4% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  6% {
    transform: translate(0, 1.5px) rotate(-1.5deg);
  }
  8% {
    transform: translate(0, -1.5px) rotate(-1.5deg);
  }
  10% {
    transform: translate(0, 2.5px) rotate(1.5deg);
  }
  12% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  14% {
    transform: translate(0, -1.5px) rotate(1.5deg);
  }
  16% {
    transform: translate(0, -0.5px) rotate(-1.5deg);
  }
  18% {
    transform: translate(0, 0.5px) rotate(-1.5deg);
  }
  20% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  22% {
    transform: translate(0, 0.5px) rotate(-1.5deg);
  }
  24% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  26% {
    transform: translate(0, 0.5px) rotate(0.5deg);
  }
  28% {
    transform: translate(0, 0.5px) rotate(1.5deg);
  }
  30% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  32% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  34% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  36% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  38% {
    transform: translate(0, 1.5px) rotate(-1.5deg);
  }
  40% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  42% {
    transform: translate(0, 2.5px) rotate(-1.5deg);
  }
  44% {
    transform: translate(0, 1.5px) rotate(0.5deg);
  }
  46% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  48% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  50% {
    transform: translate(0, 0.5px) rotate(0.5deg);
  }
  52% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  54% {
    transform: translate(0, -1.5px) rotate(1.5deg);
  }
  56% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  58% {
    transform: translate(0, 0.5px) rotate(2.5deg);
  }
  60% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  62% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  64% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  66% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  68% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  70% {
    transform: translate(0, 1.5px) rotate(0.5deg);
  }
  72% {
    transform: translate(0, 2.5px) rotate(1.5deg);
  }
  74% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  76% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  78% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  80% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  82% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  84% {
    transform: translate(0, 1.5px) rotate(2.5deg);
  }
  86% {
    transform: translate(0, -1.5px) rotate(-1.5deg);
  }
  88% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  90% {
    transform: translate(0, 2.5px) rotate(-0.5deg);
  }
  92% {
    transform: translate(0, 0.5px) rotate(-0.5deg);
  }
  94% {
    transform: translate(0, 2.5px) rotate(0.5deg);
  }
  96% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  98% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  0%,
  100% {
    transform: translate(0, 0) rotate(0deg);
  }
}
.dplayer {
  position: relative;
  overflow: hidden;
  -webkit-user-select: none;
     -moz-user-select: none;
          user-select: none;
  line-height: 1;
}
.dplayer * {
  box-sizing: content-box;
}
.dplayer svg {
  width: 100%;
  height: 100%;
}
.dplayer svg path,
.dplayer svg circle {
  fill: #fff;
}
.dplayer:-webkit-full-screen {
  width: 100%;
  height: 100%;
  background: #000;
  position: fixed;
  z-index: 100000;
  left: 0;
  top: 0;
  margin: 0;
  padding: 0;
  transform: translate(0, 0);
}
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-showdan,
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-danmaku,
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-danunlimit {
  display: none;
}
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-comment {
  display: none;
}
.dplayer.dplayer-no-danmaku .dplayer-danmaku {
  display: none;
}
.dplayer.dplayer-live .dplayer-time {
  display: none;
}
.dplayer.dplayer-live .dplayer-bar-wrap {
  display: none;
}
.dplayer.dplayer-live .dplayer-setting-speed {
  display: none;
}
.dplayer.dplayer-live .dplayer-setting-loop {
  display: none;
}
.dplayer.dplayer-live.dplayer-no-danmaku .dplayer-setting {
  display: none;
}
.dplayer.dplayer-arrow .dplayer-danmaku {
  font-size: 18px;
}
.dplayer.dplayer-arrow .dplayer-icon {
  margin: 0 -3px;
}
.dplayer.dplayer-playing .dplayer-danmaku .dplayer-danmaku-move {
  animation-play-state: running;
}
@media (min-width: 900px) {
  .dplayer.dplayer-playing .dplayer-controller-mask {
    opacity: 0;
  }
  .dplayer.dplayer-playing .dplayer-controller {
    opacity: 0;
  }
  .dplayer.dplayer-playing:hover .dplayer-controller-mask {
    opacity: 1;
  }
  .dplayer.dplayer-playing:hover .dplayer-controller {
    opacity: 1;
  }
}
.dplayer.dplayer-loading .dplayer-bezel .diplayer-loading-icon {
  display: block;
}
.dplayer.dplayer-loading .dplayer-danmaku,
.dplayer.dplayer-paused .dplayer-danmaku,
.dplayer.dplayer-loading .dplayer-danmaku-move,
.dplayer.dplayer-paused .dplayer-danmaku-move {
  animation-play-state: paused;
}
.dplayer.dplayer-hide-controller {
  cursor: none;
}
.dplayer.dplayer-hide-controller .dplayer-controller-mask {
  opacity: 0;
  transform: translateY(100%);
}
.dplayer.dplayer-hide-controller .dplayer-controller {
  opacity: 0;
  transform: translateY(100%);
}
.dplayer.dplayer-show-controller .dplayer-controller-mask {
  opacity: 1;
}
.dplayer.dplayer-show-controller .dplayer-controller {
  opacity: 1;
}
.dplayer.dplayer-fulled {
  width: 100% !important;
  height: 100% !important;
}
.dplayer.dplayer-fulled {
  position: fixed;
  z-index: 100000;
  left: 0;
  top: 0;
}
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-volume,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-camera-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-airplay-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-chromecast-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-play-icon {
  display: none;
}
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-full .dplayer-full-in-icon {
  position: static;
  display: inline-block;
}
.dplayer.dplayer-mobile .dplayer-bar-time {
  display: none;
}
.dplayer.dplayer-mobile.dplayer-hide-controller .dplayer-mobile-play {
  display: none;
}
.dplayer.dplayer-mobile .dplayer-mobile-play {
  display: block;
}
.dplayer-web-fullscreen-fix {
  position: fixed;
  top: 0;
  left: 0;
  margin: 0;
  padding: 0;
}
[data-balloon]:before {
  display: none;
}
[data-balloon]:after {
  padding: 0.3em 0.7em;
  background: rgba(17, 17, 17, 0.7);
}
[data-balloon][data-balloon-pos="up"]:after {
  margin-bottom: 0;
}
.dplayer-bezel {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  font-size: 22px;
  color: #fff;
  pointer-events: none;
}
.dplayer-bezel .dplayer-bezel-icon {
  position: absolute;
  top: 50%;
  left: 50%;
  margin: -26px 0 0 -26px;
  height: 52px;
  width: 52px;
  padding: 12px;
  box-sizing: border-box;
  background: rgba(0, 0, 0, 0.5);
  border-radius: 50%;
  opacity: 0;
  pointer-events: none;
}
.dplayer-bezel .dplayer-bezel-icon.dplayer-bezel-transition {
  animation: bezel-hide 0.5s linear;
}
@keyframes bezel-hide {
  from {
    opacity: 1;
    transform: scale(1);
  }
  to {
    opacity: 0;
    transform: scale(2);
  }
}
.dplayer-bezel .dplayer-danloading {
  position: absolute;
  top: 50%;
  margin-top: -7px;
  width: 100%;
  text-align: center;
  font-size: 14px;
  line-height: 14px;
  animation: my-face 5s infinite ease-in-out;
}
.dplayer-bezel .diplayer-loading-icon {
  display: none;
  position: absolute;
  top: 50%;
  left: 50%;
  margin: -18px 0 0 -18px;
  height: 36px;
  width: 36px;
  pointer-events: none;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-hide {
  display: none;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot {
  animation: diplayer-loading-dot-fade 0.8s ease infinite;
  opacity: 0;
  transform-origin: 4px 4px;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-1 {
  animation-delay: 0.1s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-2 {
  animation-delay: 0.2s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-3 {
  animation-delay: 0.3s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-4 {
  animation-delay: 0.4s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-5 {
  animation-delay: 0.5s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-6 {
  animation-delay: 0.6s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-7 {
  animation-delay: 0.7s;
}
@keyframes diplayer-loading-dot-fade {
  0% {
    opacity: 0.7;
    transform: scale(1.2, 1.2);
  }
  50% {
    opacity: 0.25;
    transform: scale(0.9, 0.9);
  }
  to {
    opacity: 0.25;
    transform: scale(0.85, 0.85);
  }
}
.dplayer-controller-mask {
  background: url(`+P+`) repeat-x bottom;
  height: 98px;
  width: 100%;
  position: absolute;
  bottom: 0;
  transition: all 0.3s ease;
}
.dplayer-controller {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 41px;
  padding: 0 20px;
  -webkit-user-select: none;
     -moz-user-select: none;
          user-select: none;
  transition: all 0.3s ease;
}
.dplayer-controller.dplayer-controller-comment .dplayer-icons {
  display: none;
}
.dplayer-controller.dplayer-controller-comment .dplayer-icons.dplayer-comment-box {
  display: block;
}
.dplayer-controller .dplayer-bar-wrap {
  padding: 5px 0;
  cursor: pointer;
  position: absolute;
  bottom: 33px;
  width: calc(100% - 40px);
  height: 3px;
}
.dplayer-controller .dplayer-bar-wrap:hover .dplayer-bar .dplayer-played .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-bar-wrap:hover .dplayer-highlight {
  display: block;
  width: 8px;
  transform: translateX(-4px);
  top: 4px;
  height: 40%;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight {
  z-index: 12;
  position: absolute;
  top: 5px;
  width: 6px;
  height: 20%;
  border-radius: 6px;
  background-color: #fff;
  text-align: center;
  transform: translateX(-3px);
  transition: all 0.2s ease-in-out;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover .dplayer-highlight-text {
  display: block;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover ~ .dplayer-bar-preview {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover ~ .dplayer-bar-time {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight .dplayer-highlight-text {
  display: none;
  position: absolute;
  left: 50%;
  top: -24px;
  padding: 5px 8px;
  background-color: rgba(0, 0, 0, 0.62);
  color: #fff;
  border-radius: 4px;
  font-size: 12px;
  white-space: nowrap;
  transform: translateX(-50%);
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-preview {
  position: absolute;
  background: #fff;
  pointer-events: none;
  display: none;
  background-size: 16000px 100%;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-preview-canvas {
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: 1;
  pointer-events: none;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-time {
  position: absolute;
  left: 0px;
  top: -20px;
  border-radius: 4px;
  padding: 5px 7px;
  background-color: rgba(0, 0, 0, 0.62);
  color: #fff;
  font-size: 12px;
  text-align: center;
  opacity: 1;
  transition: opacity 0.1s ease-in-out;
  word-wrap: normal;
  word-break: normal;
  z-index: 2;
  pointer-events: none;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-time.hidden {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar {
  position: relative;
  height: 3px;
  width: 100%;
  background: rgba(255, 255, 255, 0.2);
  cursor: pointer;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-loaded {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  background: rgba(255, 255, 255, 0.4);
  height: 3px;
  transition: all 0.5s ease;
  will-change: width;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-played {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  height: 3px;
  will-change: width;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-played .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons {
  height: 38px;
  position: absolute;
  bottom: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box {
  display: none;
  position: absolute;
  transition: all 0.3s ease-in-out;
  z-index: 2;
  height: 38px;
  bottom: 0;
  left: 20px;
  right: 20px;
  color: #fff;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-icon {
  padding: 7px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-icon {
  position: absolute;
  left: 0;
  top: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-send-icon {
  position: absolute;
  right: 0;
  top: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box {
  position: absolute;
  background: rgba(28, 28, 28, 0.9);
  bottom: 41px;
  left: 0;
  box-shadow: 0 0 25px rgba(0, 0, 0, 0.3);
  border-radius: 4px;
  padding: 10px 10px 16px;
  font-size: 14px;
  width: 204px;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box.dplayer-comment-setting-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box input[type=radio] {
  display: none;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box label {
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-title {
  font-size: 13px;
  color: #fff;
  line-height: 30px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type {
  font-size: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type .dplayer-comment-setting-title {
  margin-bottom: 6px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type label:nth-child(2) span {
  border-radius: 4px 0 0 4px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type label:nth-child(4) span {
  border-radius: 0 4px 4px 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type span {
  width: 33%;
  padding: 4px 6px;
  line-height: 16px;
  display: inline-block;
  font-size: 12px;
  color: #fff;
  border: 1px solid #fff;
  margin-right: -1px;
  box-sizing: border-box;
  text-align: center;
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type input:checked + span {
  background: #E4E4E6;
  color: #1c1c1c;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color {
  font-size: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color label {
  font-size: 0;
  padding: 6px;
  display: inline-block;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color span {
  width: 22px;
  height: 22px;
  display: inline-block;
  border-radius: 50%;
  box-sizing: border-box;
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color span:hover {
  animation: my-face 5s infinite ease-in-out;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input {
  outline: none;
  border: none;
  padding: 8px 31px;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  border-radius: 4px;
  background: none;
  margin: 0;
  height: 100%;
  box-sizing: border-box;
  width: 100%;
  color: #fff;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::-moz-placeholder {
  color: #fff;
  opacity: 0.8;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::placeholder {
  color: #fff;
  opacity: 0.8;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::-ms-clear {
  display: none;
}
.dplayer-controller .dplayer-icons.dplayer-icons-left .dplayer-icon {
  padding: 7px;
}
.dplayer-controller .dplayer-icons.dplayer-icons-right {
  right: 20px;
}
.dplayer-controller .dplayer-icons.dplayer-icons-right .dplayer-icon {
  padding: 8px;
}
.dplayer-controller .dplayer-icons .dplayer-time,
.dplayer-controller .dplayer-icons .dplayer-live-badge {
  line-height: 38px;
  color: #eee;
  text-shadow: 0 0 2px rgba(0, 0, 0, 0.5);
  vertical-align: middle;
  font-size: 13px;
  cursor: default;
}
.dplayer-controller .dplayer-icons .dplayer-live-dot {
  display: inline-block;
  width: 6px;
  height: 6px;
  vertical-align: 4%;
  margin-right: 5px;
  content: '';
  border-radius: 6px;
}
.dplayer-controller .dplayer-icons .dplayer-icon {
  width: 40px;
  height: 100%;
  border: none;
  background-color: transparent;
  outline: none;
  cursor: pointer;
  vertical-align: middle;
  box-sizing: border-box;
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-icon .dplayer-icon-content {
  transition: all 0.2s ease-in-out;
  opacity: 0.8;
}
.dplayer-controller .dplayer-icons .dplayer-icon:hover .dplayer-icon-content {
  opacity: 1;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-quality-icon {
  color: #fff;
  width: auto;
  line-height: 22px;
  font-size: 14px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-comment-icon {
  padding: 10px 9px 9px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-setting-icon {
  padding-top: 8.5px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-volume-icon {
  width: 43px;
}
.dplayer-controller .dplayer-icons .dplayer-volume {
  position: relative;
  display: inline-block;
  cursor: pointer;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-volume:hover .dplayer-volume-bar-wrap .dplayer-volume-bar {
  width: 45px;
}
.dplayer-controller .dplayer-icons .dplayer-volume:hover .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-volume.dplayer-volume-active .dplayer-volume-bar-wrap .dplayer-volume-bar {
  width: 45px;
}
.dplayer-controller .dplayer-icons .dplayer-volume.dplayer-volume-active .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap {
  display: inline-block;
  margin: 0 10px 0 -5px;
  vertical-align: middle;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar {
  position: relative;
  top: 17px;
  width: 0;
  height: 3px;
  background: #aaa;
  transition: all 0.3s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 100%;
  transition: all 0.1s ease;
  will-change: width;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons .dplayer-subtitle-btn {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box {
  position: absolute;
  right: 0;
  bottom: 50px;
  transform: scale(0);
  width: -moz-fit-content;
  width: fit-content;
  max-width: 240px;
  min-width: 120px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 7px 0;
  transition: all 0.3s ease-in-out;
  overflow: auto;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box.dplayer-subtitles-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box.dplayer-subtitles-box-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-item {
  height: 30px;
  padding: 5px 10px;
  box-sizing: border-box;
  cursor: pointer;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-setting {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box {
  position: absolute;
  right: 0;
  bottom: 50px;
  transform: scale(0);
  width: 150px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 7px 0;
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box > div {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box > div.dplayer-setting-origin-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-narrow {
  width: 70px;
  text-align: center;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-speed .dplayer-setting-origin-panel {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-speed .dplayer-setting-speed-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-item,
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-speed-item {
  height: 30px;
  padding: 5px 10px;
  box-sizing: border-box;
  cursor: pointer;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-item:hover,
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-speed-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku {
  padding: 5px 0;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-label {
  padding: 0 10px;
  display: inline;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku:hover .dplayer-label {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku:hover .dplayer-danmaku-bar-wrap {
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-label {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-danmaku-bar-wrap {
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap {
  padding: 0 10px;
  box-sizing: border-box;
  display: none;
  vertical-align: middle;
  height: 100%;
  width: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar {
  position: relative;
  top: 8.5px;
  width: 100%;
  height: 3px;
  background: #fff;
  transition: all 0.3s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar .dplayer-danmaku-bar-inner {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 100%;
  transition: all 0.1s ease;
  background: #aaa;
  will-change: width;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar .dplayer-danmaku-bar-inner .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  background: #aaa;
}
.dplayer-controller .dplayer-icons .dplayer-full {
  display: inline-block;
  height: 100%;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-full:hover .dplayer-full-in-icon {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-full .dplayer-full-in-icon {
  position: absolute;
  top: -30px;
  z-index: 1;
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-quality {
  position: relative;
  display: inline-block;
  height: 100%;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-quality:hover .dplayer-quality-list {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-quality:hover .dplayer-quality-mask {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-mask {
  display: none;
  position: absolute;
  bottom: 38px;
  left: -18px;
  width: 80px;
  padding-bottom: 12px;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-list {
  display: none;
  font-size: 12px;
  width: 80px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 5px 0;
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  color: #fff;
  text-align: center;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-item {
  height: 25px;
  box-sizing: border-box;
  cursor: pointer;
  line-height: 25px;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-comment {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-label {
  color: #eee;
  font-size: 13px;
  display: inline-block;
  vertical-align: middle;
  white-space: nowrap;
}
.dplayer-controller .dplayer-icons .dplayer-toggle {
  width: 32px;
  height: 20px;
  text-align: center;
  font-size: 0;
  vertical-align: middle;
  position: absolute;
  top: 5px;
  right: 10px;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input {
  max-height: 0;
  max-width: 0;
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label {
  display: inline-block;
  position: relative;
  box-shadow: #dfdfdf 0 0 0 0 inset;
  border: 1px solid #dfdfdf;
  height: 20px;
  width: 32px;
  border-radius: 10px;
  box-sizing: border-box;
  cursor: pointer;
  transition: 0.2s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label:before {
  content: "";
  position: absolute;
  display: block;
  height: 18px;
  width: 18px;
  top: 0;
  left: 0;
  border-radius: 15px;
  transition: 0.2s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label:after {
  content: "";
  position: absolute;
  display: block;
  left: 0;
  top: 0;
  border-radius: 15px;
  background: #fff;
  transition: 0.2s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
  height: 18px;
  width: 18px;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label {
  border-color: rgba(255, 255, 255, 0.5);
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label:before {
  width: 30px;
  background: rgba(255, 255, 255, 0.5);
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label:after {
  left: 12px;
}
.dplayer-mobile-play {
  display: none;
  width: 50px;
  height: 50px;
  border: none;
  background-color: transparent;
  outline: none;
  cursor: pointer;
  box-sizing: border-box;
  bottom: 0;
  opacity: 0.8;
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
}
.dplayer-danmaku {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  font-size: 22px;
  color: #fff;
}
.dplayer-danmaku .dplayer-danmaku-item {
  display: inline-block;
  pointer-events: none;
  -webkit-user-select: none;
     -moz-user-select: none;
          user-select: none;
  cursor: default;
  white-space: nowrap;
  text-shadow: 0.5px 0.5px 0.5px rgba(0, 0, 0, 0.5);
}
.dplayer-danmaku .dplayer-danmaku-item--demo {
  position: absolute;
  visibility: hidden;
}
.dplayer-danmaku .dplayer-danmaku-right {
  position: absolute;
  right: 0;
  transform: translateX(100%);
}
.dplayer-danmaku .dplayer-danmaku-right.dplayer-danmaku-move {
  will-change: transform;
  animation-name: 'danmaku';
  animation-timing-function: linear;
  animation-play-state: paused;
}
@keyframes danmaku {
  from {
    transform: translateX(100%);
  }
}
.dplayer-danmaku .dplayer-danmaku-top,
.dplayer-danmaku .dplayer-danmaku-bottom {
  position: absolute;
  width: 100%;
  text-align: center;
  visibility: hidden;
}
.dplayer-danmaku .dplayer-danmaku-top.dplayer-danmaku-move,
.dplayer-danmaku .dplayer-danmaku-bottom.dplayer-danmaku-move {
  will-change: visibility;
  animation-name: 'danmaku-center';
  animation-timing-function: linear;
  animation-play-state: paused;
}
@keyframes danmaku-center {
  from {
    visibility: visible;
  }
  to {
    visibility: visible;
  }
}
.dplayer-logo {
  pointer-events: none;
  position: absolute;
  left: 20px;
  top: 20px;
  max-width: 50px;
  max-height: 50px;
}
.dplayer-logo img {
  max-width: 100%;
  max-height: 100%;
  background: none;
}
.dplayer-menu {
  position: absolute;
  width: 170px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.85);
  padding: 5px 0;
  overflow: hidden;
  z-index: 3;
  display: none;
}
.dplayer-menu.dplayer-menu-show {
  display: block;
}
.dplayer-menu .dplayer-menu-item {
  height: 30px;
  box-sizing: border-box;
  cursor: pointer;
}
.dplayer-menu .dplayer-menu-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-menu .dplayer-menu-item a {
  padding: 0 10px;
  line-height: 30px;
  color: #eee;
  font-size: 13px;
  display: inline-block;
  vertical-align: middle;
  width: 100%;
  box-sizing: border-box;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
.dplayer-menu .dplayer-menu-item a:hover {
  text-decoration: none;
}
.dplayer-notice-list {
  position: absolute;
  bottom: 60px;
  left: 20px;
}
.dplayer-notice-list .dplayer-notice {
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  color: #fff;
  display: table;
  pointer-events: none;
  animation: showNotice 0.3s ease 1 forwards;
}
.dplayer-notice-list .remove-notice {
  animation: removeNotice 0.3s ease 1 forwards;
}
@keyframes showNotice {
  from {
    padding: 0;
    font-size: 0;
    margin-top: 0;
  }
  to {
    padding: 7px 20px;
    font-size: 14px;
    margin-top: 5px;
  }
}
@keyframes removeNotice {
  0% {
    padding: 7px 20px;
    font-size: 14px;
    margin-top: 5px;
  }
  20% {
    font-size: 12px;
  }
  21% {
    font-size: 0;
    padding: 7px 10px;
  }
  100% {
    padding: 0;
    margin-top: 0;
    font-size: 0;
  }
}
.dplayer-subtitle {
  position: absolute;
  bottom: 40px;
  width: 90%;
  left: 5%;
  text-align: center;
  color: #fff;
  text-shadow: 0.5px 0.5px 0.5px rgba(0, 0, 0, 0.5);
  font-size: 20px;
}
.dplayer-subtitle.dplayer-subtitle-hide {
  display: none;
}
.dplayer-mask {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 1;
  display: none;
}
.dplayer-mask.dplayer-mask-show {
  display: block;
}
.dplayer-video-wrap {
  position: relative;
  background: #000;
  font-size: 0;
  width: 100%;
  height: 100%;
}
.dplayer-video-wrap .dplayer-video {
  width: 100%;
  height: 100%;
  display: none;
}
.dplayer-video-wrap .dplayer-video-current {
  display: block;
}
.dplayer-video-wrap .dplayer-video-prepare {
  display: none;
}
.dplayer-info-panel {
  position: absolute;
  top: 10px;
  left: 10px;
  width: 400px;
  background: rgba(28, 28, 28, 0.8);
  padding: 10px;
  color: #fff;
  font-size: 12px;
  border-radius: 2px;
}
.dplayer-info-panel-hide {
  display: none;
}
.dplayer-info-panel .dplayer-info-panel-close {
  cursor: pointer;
  position: absolute;
  right: 10px;
  top: 10px;
}
.dplayer-info-panel .dplayer-info-panel-item > span {
  display: inline-block;
  vertical-align: middle;
  line-height: 15px;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
.dplayer-info-panel .dplayer-info-panel-item-title {
  width: 100px;
  text-align: right;
  margin-right: 10px;
}
.dplayer-info-panel .dplayer-info-panel-item-data {
  width: 260px;
}
`,"",{version:3,sources:["webpack://./src/css/global.less","webpack://./src/css/index.less","webpack://./src/css/player.less","webpack://./src/css/balloon.less","webpack://./src/css/bezel.less","webpack://./src/css/notice.less","webpack://./src/css/controller.less","webpack://./src/css/danmaku.less","webpack://./src/css/logo.less","webpack://./src/css/menu.less","webpack://./src/css/subtitle.less","webpack://./src/css/video.less","webpack://./src/css/info-panel.less"],names:[],mappings:"AAAA;EACI;IACI,6CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;;IAEI,uCAAA;ECEN;AACF;ACzJA;EACI,kBAAA;EACA,gBAAA;EACA,yBAAA;KAAA,sBAAA;UAAA,iBAAA;EACA,cAAA;AD2JJ;AC/JA;EAOQ,uBAAA;AD2JR;AClKA;EAWQ,WAAA;EACA,YAAA;AD0JR;ACtKA;;EAgBY,UAAA;AD0JZ;ACtJI;EACI,WAAA;EACA,YAAA;EACA,gBAAA;EACA,eAAA;EACA,eAAA;EACA,OAAA;EACA,MAAA;EACA,SAAA;EACA,UAAA;EACA,0BAAA;ADwJR;ACpJI;;;EAKY,aAAA;ADoJhB;ACzJI;EAUQ,aAAA;ADkJZ;AC5JI;EAcQ,aAAA;ADiJZ;AC7II;EAEQ,aAAA;AD8IZ;AChJI;EAKQ,aAAA;AD8IZ;ACnJI;EAQQ,aAAA;AD8IZ;ACtJI;EAWQ,aAAA;AD8IZ;AC3IQ;EAEQ,aAAA;AD4IhB;ACvII;EAEQ,eAAA;ADwIZ;AC1II;EAKQ,cAAA;ADwIZ;ACpII;EAEQ,6BAAA;ADqIZ;AClIQ;EAAA;IAEQ,UAAA;EDoId;ECtIM;IAKQ,UAAA;EDoId;ECjIU;IAEQ,UAAA;EDkIlB;ECpIU;IAKQ,UAAA;EDkIlB;AACF;AC7HI;EAEQ,cAAA;AD8HZ;AC1HI;;;;EAIQ,4BAAA;AD4HZ;ACxHI;EACI,YAAA;AD0HR;AC3HI;EAIQ,UAAA;EACA,2BAAA;AD0HZ;AC/HI;EAQQ,UAAA;EACA,2BAAA;AD0HZ;ACvHI;EAEQ,UAAA;ADwHZ;AC1HI;EAKQ,UAAA;ADwHZ;ACrHI;EAKI,sBAAA;EACA,uBAAA;ADuHR;AC7HI;EACI,eAAA;EACA,eAAA;EACA,OAAA;EACA,MAAA;ADyHR;ACrHI;;;;;EAOY,aAAA;ADqHhB;AC5HI;EAUY,gBAAA;EACA,qBAAA;ADqHhB;AChII;EAgBQ,aAAA;ADmHZ;AChHQ;EAEQ,aAAA;ADiHhB;ACtII;EA0BQ,cAAA;AD+GZ;ACzGA;EACI,eAAA;EACA,MAAA;EACA,OAAA;EACA,SAAA;EACA,UAAA;AD2GJ;AElSA;EACI,aAAA;AFoSJ;AEjSA;EACI,oBAAA;EACA,iCAAA;AFmSJ;AEhSA;EACI,gBAAA;AFkSJ;AG9SA;EACI,kBAAA;EACA,OAAA;EACA,QAAA;EACA,MAAA;EACA,SAAA;EACA,eAAA;EACA,WAAA;EACA,oBAAA;AHgTJ;AGxTA;EAUQ,kBAAA;EACA,QAAA;EACA,SAAA;EACA,uBAAA;EACA,YAAA;EACA,WAAA;EACA,aAAA;EACA,sBAAA;EACA,8BAAA;EACA,kBAAA;EACA,UAAA;EACA,oBAAA;AHiTR;AGhTQ;EACI,iCAAA;AHkTZ;AGhTQ;EACI;IACI,UAAA;IACA,mBAAA;EHkTd;EGhTU;IACI,UAAA;IACA,mBAAA;EHkTd;AACF;AGnVA;EAqCQ,kBAAA;EACA,QAAA;EACA,gBAAA;EACA,WAAA;EACA,kBAAA;EACA,eAAA;EACA,iBAAA;EACA,0CAAA;AHiTR;AG7VA;EA+CQ,aAAA;EACA,kBAAA;EACA,QAAA;EACA,SAAA;EACA,uBAAA;EACA,YAAA;EACA,WAAA;EACA,oBAAA;AHiTR;AGvWA;EAwDY,aAAA;AHkTZ;AG1WA;EA2DY,uDAAA;EACA,UAAA;EACA,yBAAA;AHkTZ;AI/WC;EDgEmB,qBAAA;AHkTpB;AIlXC;EDgEmB,qBAAA;AHqTpB;AIrXC;EDgEmB,qBAAA;AHwTpB;AIxXC;EDgEmB,qBAAA;AH2TpB;AI3XC;EDgEmB,qBAAA;AH8TpB;AI9XC;EDgEmB,qBAAA;AHiUpB;AIjYC;EDgEmB,qBAAA;AHoUpB;AGhUQ;EACI;IACI,YAAA;IACA,0BAAA;EHkUd;EGhUU;IACI,aAAA;IACA,0BAAA;EHkUd;EGhUU;IACI,aAAA;IACA,4BAAA;EHkUd;AACF;AKlZA;EACI,mEAAA;EACA,YAAA;EACA,WAAA;EACA,kBAAA;EACA,SAAA;EACA,yBAAA;ALoZJ;AKjZA;EACI,kBAAA;EACA,SAAA;EACA,OAAA;EACA,QAAA;EACA,YAAA;EACA,eAAA;EACA,yBAAA;KAAA,sBAAA;UAAA,iBAAA;EACA,yBAAA;ALmZJ;AKlZI;EAEQ,aAAA;ALmZZ;AKrZI;EAKQ,cAAA;ALmZZ;AKjaA;EAkBQ,cAAA;EACA,eAAA;EACA,kBAAA;EACA,YAAA;EACA,wBAAA;EACA,WAAA;ALkZR;AKjZQ;EAEQ,mBAAA;ALkZhB;AKpZQ;EAKQ,cAAA;EACA,UAAA;EACA,2BAAA;EACA,QAAA;EACA,WAAA;ALkZhB;AKnbA;EAqCY,WAAA;EACA,kBAAA;EACA,QAAA;EACA,UAAA;EACA,WAAA;EACA,kBAAA;EACA,sBAAA;EACA,kBAAA;EACA,2BAAA;EACA,gCAAA;ALiZZ;AKhZY;EAEQ,cAAA;ALiZpB;AK/YgB;EACI,UAAA;ALiZpB;AK/YgB;EACI,UAAA;ALiZpB;AKxcA;EA2DgB,aAAA;EACA,kBAAA;EACA,SAAA;EACA,UAAA;EACA,gBAAA;EACA,qCAAA;EACA,WAAA;EACA,kBAAA;EACA,eAAA;EACA,mBAAA;EACA,2BAAA;ALgZhB;AKrdA;EAyEY,kBAAA;EACA,gBAAA;EACA,oBAAA;EACA,aAAA;EACA,6BAAA;AL+YZ;AK5dA;EAgFY,kBAAA;EACA,WAAA;EACA,YAAA;EACA,UAAA;EACA,oBAAA;AL+YZ;AKneA;EA0FY,kBAAA;EACA,SAAA;EACA,UAAA;EACA,kBAAA;EACA,gBAAA;EACA,qCAAA;EACA,WAAA;EACA,eAAA;EACA,kBAAA;EACA,UAAA;EACA,oCAAA;EACA,iBAAA;EACA,kBAAA;EACA,UAAA;EACA,oBAAA;AL4YZ;AK7ZY;EACI,UAAA;AL+ZhB;AKvfA;EA2GY,kBAAA;EACA,WAAA;EACA,WAAA;EACA,oCAAA;EACA,eAAA;AL+YZ;AK9fA;EAiHgB,kBAAA;EACA,OAAA;EACA,MAAA;EACA,SAAA;EACA,oCAAA;EACA,WAAA;EACA,yBAAA;EACA,kBAAA;ALgZhB;AKxgBA;EA2HgB,kBAAA;EACA,OAAA;EACA,MAAA;EACA,SAAA;EACA,WAAA;EACA,kBAAA;ALgZhB;AKhhBA;EAkIoB,kBAAA;EACA,MAAA;EACA,UAAA;EACA,gBAAA;EACA,mBAAA;EACA,YAAA;EACA,WAAA;EACA,kBAAA;EACA,eAAA;EACA,gCAAA;EACA,mBAAA;ALiZpB;AK7hBA;EAkJQ,YAAA;EACA,kBAAA;EACA,SAAA;AL8YR;AK7YQ;EACI,aAAA;EACA,kBAAA;EACA,gCAAA;EACA,UAAA;EACA,YAAA;EACA,SAAA;EACA,UAAA;EACA,WAAA;EACA,WAAA;AL+YZ;AKxZQ;EAWQ,YAAA;ALgZhB;AK3ZQ;EAcQ,kBAAA;EACA,OAAA;EACA,MAAA;ALgZhB;AKhaQ;EAmBQ,kBAAA;EACA,QAAA;EACA,MAAA;ALgZhB;AKraQ;EAwBQ,kBAAA;EACA,iCAAA;EACA,YAAA;EACA,OAAA;EACA,uCAAA;EACA,kBAAA;EACA,uBAAA;EACA,eAAA;EACA,YAAA;EACA,gCAAA;EACA,mBAAA;ALgZhB;AK/YgB;EACI,mBAAA;ALiZpB;AKrbQ;EAuCY,aAAA;ALiZpB;AKxbQ;EA0CY,eAAA;ALiZpB;AK3bQ;EA6CY,eAAA;EACA,WAAA;EACA,iBAAA;ALiZpB;AKhcQ;EAkDY,YAAA;ALiZpB;AKncQ;EAoDgB,kBAAA;ALkZxB;AK/YwB;EAEQ,0BAAA;ALgZhC;AK7YwB;EAEQ,0BAAA;AL8YhC;AK5cQ;EAmEgB,UAAA;EACA,gBAAA;EACA,iBAAA;EACA,qBAAA;EACA,eAAA;EACA,WAAA;EACA,sBAAA;EACA,kBAAA;EACA,sBAAA;EACA,kBAAA;EACA,eAAA;AL4YxB;AKzdQ;EAgFgB,mBAAA;EACA,cAAA;AL4YxB;AK7dQ;EAqFY,YAAA;AL2YpB;AKheQ;EAuFgB,YAAA;EACA,YAAA;EACA,qBAAA;AL4YxB;AKreQ;EA4FgB,WAAA;EACA,YAAA;EACA,qBAAA;EACA,kBAAA;EACA,sBAAA;EACA,eAAA;AL4YxB;AK3YwB;EACI,0CAAA;AL6Y5B;AKhfQ;EAyGQ,aAAA;EACA,YAAA;EACA,iBAAA;EACA,eAAA;EACA,iBAAA;EACA,kBAAA;EACA,kBAAA;EACA,gBAAA;EACA,SAAA;EACA,YAAA;EACA,sBAAA;EACA,WAAA;EACA,WAAA;AL0YhB;AKzYgB;EACI,WAAA;EACA,YAAA;AL2YpB;AK7YgB;EACI,WAAA;EACA,YAAA;AL2YpB;AKzYgB;EACI,aAAA;AL2YpB;AKvYQ;EAEQ,YAAA;ALwYhB;AKrYQ;EACI,WAAA;ALuYZ;AKxYQ;EAGQ,YAAA;ALwYhB;AKpqBA;;EAiSY,iBAAA;EACA,WAAA;EACA,uCAAA;EACA,sBAAA;EACA,eAAA;EACA,eAAA;ALuYZ;AK7qBA;EAySY,qBAAA;EACA,UAAA;EACA,WAAA;EACA,kBAAA;EACA,iBAAA;EACA,WAAA;EACA,kBAAA;ALuYZ;AKtrBA;EAkTY,WAAA;EACA,YAAA;EACA,YAAA;EACA,6BAAA;EACA,aAAA;EACA,eAAA;EACA,sBAAA;EACA,sBAAA;EACA,qBAAA;ALuYZ;AKjsBA;EA4TgB,gCAAA;EACA,YAAA;ALwYhB;AKtYY;EAEQ,UAAA;ALuYpB;AKpYY;EACI,WAAA;EACA,WAAA;EACA,iBAAA;EACA,eAAA;ALsYhB;AKpYY;EACI,qBAAA;ALsYhB;AKpYY;EACI,kBAAA;ALsYhB;AKpYY;EACI,WAAA;ALsYhB;AKvtBA;EAqVY,kBAAA;EACA,qBAAA;EACA,eAAA;EACA,YAAA;ALqYZ;AKpYY;EAEQ,WAAA;ALqYpB;AKvYY;EAKQ,mBAAA;ALqYpB;AKlYY;EAEQ,WAAA;ALmYpB;AKrYY;EAKQ,mBAAA;ALmYpB;AKzuBA;EA0WgB,qBAAA;EACA,qBAAA;EACA,sBAAA;EACA,YAAA;ALkYhB;AK/uBA;EA+WoB,kBAAA;EACA,SAAA;EACA,QAAA;EACA,WAAA;EACA,gBAAA;EACA,gCAAA;ALmYpB;AKvvBA;EAsXwB,kBAAA;EACA,SAAA;EACA,OAAA;EACA,YAAA;EACA,yBAAA;EACA,kBAAA;ALoYxB;AK/vBA;EA6X4B,kBAAA;EACA,MAAA;EACA,UAAA;EACA,gBAAA;EACA,mBAAA;EACA,YAAA;EACA,WAAA;EACA,kBAAA;EACA,eAAA;EACA,gCAAA;EACA,mBAAA;ALqY5B;AK5wBA;EA8YY,qBAAA;EACA,YAAA;ALiYZ;AKhxBA;EAkZY,qBAAA;EACA,YAAA;ALiYZ;AKpxBA;EAqZgB,kBAAA;EACA,QAAA;EACA,YAAA;EACA,mBAAA;EACA,uBAAA;EAAA,kBAAA;EACA,gBAAA;EACA,gBAAA;EACA,kBAAA;EACA,iCAAA;EACA,cAAA;EACA,gCAAA;EACA,cAAA;EACA,UAAA;ALkYhB;AKjYgB;EACI,cAAA;ALmYpB;AKjYgB;EACI,mBAAA;ALmYpB;AKzyBA;EA0agB,YAAA;EACA,iBAAA;EACA,sBAAA;EACA,eAAA;EACA,kBAAA;ALkYhB;AKjYgB;EACI,0CAAA;ALmYpB;AKnzBA;EAqbY,qBAAA;EACA,YAAA;ALiYZ;AKvzBA;EAwbgB,kBAAA;EACA,QAAA;EACA,YAAA;EACA,mBAAA;EACA,YAAA;EACA,kBAAA;EACA,iCAAA;EACA,cAAA;EACA,gCAAA;EACA,gBAAA;EACA,UAAA;ALkYhB;AKjYgB;EACI,aAAA;ALmYpB;AKlYoB;EACI,cAAA;ALoYxB;AKjYgB;EACI,mBAAA;ALmYpB;AKjYgB;EACI,WAAA;EACA,kBAAA;ALmYpB;AKjYgB;EAEQ,aAAA;ALkYxB;AKpYgB;EAKQ,cAAA;ALkYxB;AKv1BA;;EA2dgB,YAAA;EACA,iBAAA;EACA,sBAAA;EACA,eAAA;EACA,kBAAA;ALgYhB;AK/XgB;;EACI,0CAAA;ALkYpB;AKn2BA;EAqegB,cAAA;ALiYhB;AKt2BA;EAueoB,eAAA;EACA,eAAA;ALkYpB;AKhYgB;EAEQ,aAAA;ALiYxB;AKnYgB;EAKQ,qBAAA;ALiYxB;AK9XgB;EAEQ,aAAA;AL+XxB;AKjYgB;EAKQ,qBAAA;AL+XxB;AKt3BA;EA2foB,eAAA;EACA,sBAAA;EACA,aAAA;EACA,sBAAA;EACA,YAAA;EACA,WAAA;AL8XpB;AK93BA;EAkgBwB,kBAAA;EACA,UAAA;EACA,WAAA;EACA,WAAA;EACA,gBAAA;EACA,gCAAA;AL+XxB;AKt4BA;EAygB4B,kBAAA;EACA,SAAA;EACA,OAAA;EACA,YAAA;EACA,yBAAA;EACA,gBAAA;EACA,kBAAA;ALgY5B;AK/4BA;EAihBgC,kBAAA;EACA,MAAA;EACA,UAAA;EACA,gBAAA;EACA,mBAAA;EACA,YAAA;EACA,WAAA;EACA,kBAAA;EACA,eAAA;EACA,gCAAA;EACA,gBAAA;ALiYhC;AK55BA;EAmiBY,qBAAA;EACA,YAAA;EACA,kBAAA;AL4XZ;AK3XY;EAEQ,cAAA;AL4XpB;AKp6BA;EA4iBgB,kBAAA;EACA,UAAA;EACA,UAAA;EACA,aAAA;AL2XhB;AK16BA;EAmjBY,kBAAA;EACA,qBAAA;EACA,YAAA;EACA,UAAA;AL0XZ;AKzXY;EAEQ,cAAA;AL0XpB;AK5XY;EAKQ,cAAA;AL0XpB;AKt7BA;EAgkBgB,aAAA;EACA,kBAAA;EACA,YAAA;EACA,WAAA;EACA,WAAA;EACA,oBAAA;ALyXhB;AK97BA;EAwkBgB,aAAA;EACA,eAAA;EACA,WAAA;EACA,kBAAA;EACA,iCAAA;EACA,cAAA;EACA,gCAAA;EACA,gBAAA;EACA,WAAA;EACA,kBAAA;ALyXhB;AK18BA;EAolBgB,YAAA;EACA,sBAAA;EACA,eAAA;EACA,iBAAA;ALyXhB;AKxXgB;EACI,0CAAA;AL0XpB;AKn9BA;EA8lBY,qBAAA;EACA,YAAA;ALwXZ;AKv9BA;EAkmBY,WAAA;EACA,eAAA;EACA,qBAAA;EACA,sBAAA;EACA,mBAAA;ALwXZ;AK99BA;EAymBY,WAAA;EACA,YAAA;EACA,kBAAA;EACA,YAAA;EACA,sBAAA;EACA,kBAAA;EACA,QAAA;EACA,WAAA;ALwXZ;AKx+BA;EAknBgB,aAAA;EACA,YAAA;EACA,aAAA;ALyXhB;AK7+BA;EAunBgB,qBAAA;EACA,kBAAA;EACA,iCAAA;EACA,yBAAA;EACA,YAAA;EACA,WAAA;EACA,mBAAA;EACA,sBAAA;EACA,eAAA;EACA,4BAAA;ALyXhB;AKz/BA;EAmoBgB,WAAA;EACA,kBAAA;EACA,cAAA;EACA,YAAA;EACA,WAAA;EACA,MAAA;EACA,OAAA;EACA,mBAAA;EACA,4BAAA;ALyXhB;AKpgCA;EA8oBgB,WAAA;EACA,kBAAA;EACA,cAAA;EACA,OAAA;EACA,MAAA;EACA,mBAAA;EACA,gBAAA;EACA,4BAAA;EACA,wCAAA;EACA,YAAA;EACA,WAAA;ALyXhB;AKjhCA;EA2pBgB,sCAAA;ALyXhB;AKphCA;EA8pBgB,WAAA;EACA,oCAAA;ALyXhB;AKxhCA;EAkqBgB,UAAA;ALyXhB;AKnXA;EACI,aAAA;EACA,WAAA;EACA,YAAA;EACA,YAAA;EACA,6BAAA;EACA,aAAA;EACA,eAAA;EACA,sBAAA;EAEA,SAAA;EACA,YAAA;EACA,kBAAA;EACA,SAAA;EACA,QAAA;EACA,gCAAA;ALoXJ;AMpjCA;EACI,kBAAA;EACA,OAAA;EACA,QAAA;EACA,MAAA;EACA,SAAA;EACA,eAAA;EACA,WAAA;ANsjCJ;AM7jCA;EASQ,qBAAA;EACA,oBAAA;EACA,yBAAA;KAAA,sBAAA;UAAA,iBAAA;EACA,eAAA;EACA,mBAAA;EACA,iDAAA;ANujCR;AMtjCQ;EACI,kBAAA;EACA,kBAAA;ANwjCZ;AMzkCA;EAqBQ,kBAAA;EACA,QAAA;EACA,2BAAA;ANujCR;AMtjCQ;EACI,sBAAA;EACA,yBAAA;EACA,iCAAA;EACA,4BAAA;ANwjCZ;AMrjCI;EACI;IACI,2BAAA;ENujCV;AACF;AMzlCA;;EAsCQ,kBAAA;EACA,WAAA;EACA,kBAAA;EACA,kBAAA;ANujCR;AMtjCQ;;EACI,uBAAA;EACA,gCAAA;EACA,iCAAA;EACA,4BAAA;ANyjCZ;AMtjCI;EACI;IACI,mBAAA;ENwjCV;EMtjCM;IACI,mBAAA;ENwjCV;AACF;AO/mCA;EACI,oBAAA;EACA,kBAAA;EACA,UAAA;EACA,SAAA;EACA,eAAA;EACA,gBAAA;APinCJ;AOvnCA;EAQQ,eAAA;EACA,gBAAA;EACA,gBAAA;APknCR;AQ5nCA;EACI,kBAAA;EACA,YAAA;EACA,kBAAA;EACA,kCAAA;EACA,cAAA;EACA,gBAAA;EACA,UAAA;EACA,aAAA;AR8nCJ;AQ7nCI;EACI,cAAA;AR+nCR;AQzoCA;EAaQ,YAAA;EACA,sBAAA;EACA,eAAA;AR+nCR;AQ9nCQ;EACI,0CAAA;ARgoCZ;AQjpCA;EAqBY,eAAA;EACA,iBAAA;EACA,WAAA;EACA,eAAA;EACA,qBAAA;EACA,sBAAA;EACA,WAAA;EACA,sBAAA;EACA,mBAAA;EACA,uBAAA;EACA,gBAAA;AR+nCZ;AQ9nCY;EACI,qBAAA;ARgoChB;AIjqCA;EACI,kBAAA;EACA,YAAA;EACA,UAAA;AJmqCJ;AItqCA;EAMQ,kBAAA;EACA,iCAAA;EACA,gCAAA;EACA,gBAAA;EACA,WAAA;EACA,cAAA;EACA,oBAAA;EACA,0CAAA;AJmqCR;AIhrCA;EAiBQ,4CAAA;AJkqCR;AI9pCA;EACI;IACI,UAAA;IACA,YAAA;IACA,aAAA;EJgqCN;EI9pCE;IACI,iBAAA;IACA,eAAA;IACA,eAAA;EJgqCN;AACF;AI7pCA;EACI;IACI,iBAAA;IACA,eAAA;IACA,eAAA;EJ+pCN;EI7pCE;IACI,eAAA;EJ+pCN;EI7pCE;IACI,YAAA;IACA,iBAAA;EJ+pCN;EI7pCE;IACI,UAAA;IACA,aAAA;IACA,YAAA;EJ+pCN;AACF;ASltCA;EACI,kBAAA;EACA,YAAA;EACA,UAAA;EACA,QAAA;EACA,kBAAA;EACA,WAAA;EACA,iDAAA;EACA,eAAA;ATotCJ;ASntCI;EACI,aAAA;ATqtCR;AU/tCA;EACI,kBAAA;EACA,MAAA;EACA,SAAA;EACA,OAAA;EACA,QAAA;EACA,UAAA;EACA,aAAA;AViuCJ;AUhuCI;EACI,cAAA;AVkuCR;AU9tCA;EACI,kBAAA;EACA,gBAAA;EACA,YAAA;EACA,WAAA;EACA,YAAA;AVguCJ;AUruCA;EAOQ,WAAA;EACA,YAAA;EACA,aAAA;AViuCR;AU1uCA;EAYQ,cAAA;AViuCR;AU7uCA;EAeQ,aAAA;AViuCR;AW7vCA;EACI,kBAAA;EACA,SAAA;EACA,UAAA;EACA,YAAA;EACA,iCAAA;EACA,aAAA;EACA,WAAA;EACA,eAAA;EACA,kBAAA;AX+vCJ;AW7vCI;EACI,aAAA;AX+vCR;AW3wCA;EAgBQ,eAAA;EACA,kBAAA;EACA,WAAA;EACA,SAAA;AX8vCR;AW1vCQ;EACI,qBAAA;EACA,sBAAA;EACA,iBAAA;EACA,mBAAA;EACA,uBAAA;EACA,gBAAA;AX4vCZ;AWzxCA;EAkCQ,YAAA;EACA,iBAAA;EACA,kBAAA;AX0vCR;AW9xCA;EAwCQ,YAAA;AXyvCR",sourcesContent:[`@keyframes my-face {
    2% {
        transform: translate(0, 1.5px) rotate(1.5deg);
    }
    4% {
        transform: translate(0, -1.5px) rotate(-0.5deg);
    }
    6% {
        transform: translate(0, 1.5px) rotate(-1.5deg);
    }
    8% {
        transform: translate(0, -1.5px) rotate(-1.5deg);
    }
    10% {
        transform: translate(0, 2.5px) rotate(1.5deg);
    }
    12% {
        transform: translate(0, -0.5px) rotate(1.5deg);
    }
    14% {
        transform: translate(0, -1.5px) rotate(1.5deg);
    }
    16% {
        transform: translate(0, -0.5px) rotate(-1.5deg);
    }
    18% {
        transform: translate(0, 0.5px) rotate(-1.5deg);
    }
    20% {
        transform: translate(0, -1.5px) rotate(2.5deg);
    }
    22% {
        transform: translate(0, 0.5px) rotate(-1.5deg);
    }
    24% {
        transform: translate(0, 1.5px) rotate(1.5deg);
    }
    26% {
        transform: translate(0, 0.5px) rotate(0.5deg);
    }
    28% {
        transform: translate(0, 0.5px) rotate(1.5deg);
    }
    30% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    32% {
        transform: translate(0, 1.5px) rotate(-0.5deg);
    }
    34% {
        transform: translate(0, 1.5px) rotate(-0.5deg);
    }
    36% {
        transform: translate(0, -1.5px) rotate(2.5deg);
    }
    38% {
        transform: translate(0, 1.5px) rotate(-1.5deg);
    }
    40% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    42% {
        transform: translate(0, 2.5px) rotate(-1.5deg);
    }
    44% {
        transform: translate(0, 1.5px) rotate(0.5deg);
    }
    46% {
        transform: translate(0, -1.5px) rotate(2.5deg);
    }
    48% {
        transform: translate(0, -0.5px) rotate(0.5deg);
    }
    50% {
        transform: translate(0, 0.5px) rotate(0.5deg);
    }
    52% {
        transform: translate(0, 2.5px) rotate(2.5deg);
    }
    54% {
        transform: translate(0, -1.5px) rotate(1.5deg);
    }
    56% {
        transform: translate(0, 2.5px) rotate(2.5deg);
    }
    58% {
        transform: translate(0, 0.5px) rotate(2.5deg);
    }
    60% {
        transform: translate(0, 2.5px) rotate(2.5deg);
    }
    62% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    64% {
        transform: translate(0, -0.5px) rotate(1.5deg);
    }
    66% {
        transform: translate(0, 1.5px) rotate(-0.5deg);
    }
    68% {
        transform: translate(0, -1.5px) rotate(-0.5deg);
    }
    70% {
        transform: translate(0, 1.5px) rotate(0.5deg);
    }
    72% {
        transform: translate(0, 2.5px) rotate(1.5deg);
    }
    74% {
        transform: translate(0, -0.5px) rotate(0.5deg);
    }
    76% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    78% {
        transform: translate(0, -0.5px) rotate(1.5deg);
    }
    80% {
        transform: translate(0, 1.5px) rotate(1.5deg);
    }
    82% {
        transform: translate(0, -0.5px) rotate(0.5deg);
    }
    84% {
        transform: translate(0, 1.5px) rotate(2.5deg);
    }
    86% {
        transform: translate(0, -1.5px) rotate(-1.5deg);
    }
    88% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    90% {
        transform: translate(0, 2.5px) rotate(-0.5deg);
    }
    92% {
        transform: translate(0, 0.5px) rotate(-0.5deg);
    }
    94% {
        transform: translate(0, 2.5px) rotate(0.5deg);
    }
    96% {
        transform: translate(0, -0.5px) rotate(1.5deg);
    }
    98% {
        transform: translate(0, -1.5px) rotate(-0.5deg);
    }
    0%,
    100% {
        transform: translate(0, 0) rotate(0deg);
    }
}`,`@import '../../node_modules/balloon-css/balloon.css';
@keyframes my-face {
  2% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  4% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  6% {
    transform: translate(0, 1.5px) rotate(-1.5deg);
  }
  8% {
    transform: translate(0, -1.5px) rotate(-1.5deg);
  }
  10% {
    transform: translate(0, 2.5px) rotate(1.5deg);
  }
  12% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  14% {
    transform: translate(0, -1.5px) rotate(1.5deg);
  }
  16% {
    transform: translate(0, -0.5px) rotate(-1.5deg);
  }
  18% {
    transform: translate(0, 0.5px) rotate(-1.5deg);
  }
  20% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  22% {
    transform: translate(0, 0.5px) rotate(-1.5deg);
  }
  24% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  26% {
    transform: translate(0, 0.5px) rotate(0.5deg);
  }
  28% {
    transform: translate(0, 0.5px) rotate(1.5deg);
  }
  30% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  32% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  34% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  36% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  38% {
    transform: translate(0, 1.5px) rotate(-1.5deg);
  }
  40% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  42% {
    transform: translate(0, 2.5px) rotate(-1.5deg);
  }
  44% {
    transform: translate(0, 1.5px) rotate(0.5deg);
  }
  46% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  48% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  50% {
    transform: translate(0, 0.5px) rotate(0.5deg);
  }
  52% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  54% {
    transform: translate(0, -1.5px) rotate(1.5deg);
  }
  56% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  58% {
    transform: translate(0, 0.5px) rotate(2.5deg);
  }
  60% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  62% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  64% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  66% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  68% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  70% {
    transform: translate(0, 1.5px) rotate(0.5deg);
  }
  72% {
    transform: translate(0, 2.5px) rotate(1.5deg);
  }
  74% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  76% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  78% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  80% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  82% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  84% {
    transform: translate(0, 1.5px) rotate(2.5deg);
  }
  86% {
    transform: translate(0, -1.5px) rotate(-1.5deg);
  }
  88% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  90% {
    transform: translate(0, 2.5px) rotate(-0.5deg);
  }
  92% {
    transform: translate(0, 0.5px) rotate(-0.5deg);
  }
  94% {
    transform: translate(0, 2.5px) rotate(0.5deg);
  }
  96% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  98% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  0%,
  100% {
    transform: translate(0, 0) rotate(0deg);
  }
}
.dplayer {
  position: relative;
  overflow: hidden;
  user-select: none;
  line-height: 1;
}
.dplayer * {
  box-sizing: content-box;
}
.dplayer svg {
  width: 100%;
  height: 100%;
}
.dplayer svg path,
.dplayer svg circle {
  fill: #fff;
}
.dplayer:-webkit-full-screen {
  width: 100%;
  height: 100%;
  background: #000;
  position: fixed;
  z-index: 100000;
  left: 0;
  top: 0;
  margin: 0;
  padding: 0;
  transform: translate(0, 0);
}
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-showdan,
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-danmaku,
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-danunlimit {
  display: none;
}
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-comment {
  display: none;
}
.dplayer.dplayer-no-danmaku .dplayer-danmaku {
  display: none;
}
.dplayer.dplayer-live .dplayer-time {
  display: none;
}
.dplayer.dplayer-live .dplayer-bar-wrap {
  display: none;
}
.dplayer.dplayer-live .dplayer-setting-speed {
  display: none;
}
.dplayer.dplayer-live .dplayer-setting-loop {
  display: none;
}
.dplayer.dplayer-live.dplayer-no-danmaku .dplayer-setting {
  display: none;
}
.dplayer.dplayer-arrow .dplayer-danmaku {
  font-size: 18px;
}
.dplayer.dplayer-arrow .dplayer-icon {
  margin: 0 -3px;
}
.dplayer.dplayer-playing .dplayer-danmaku .dplayer-danmaku-move {
  animation-play-state: running;
}
@media (min-width: 900px) {
  .dplayer.dplayer-playing .dplayer-controller-mask {
    opacity: 0;
  }
  .dplayer.dplayer-playing .dplayer-controller {
    opacity: 0;
  }
  .dplayer.dplayer-playing:hover .dplayer-controller-mask {
    opacity: 1;
  }
  .dplayer.dplayer-playing:hover .dplayer-controller {
    opacity: 1;
  }
}
.dplayer.dplayer-loading .dplayer-bezel .diplayer-loading-icon {
  display: block;
}
.dplayer.dplayer-loading .dplayer-danmaku,
.dplayer.dplayer-paused .dplayer-danmaku,
.dplayer.dplayer-loading .dplayer-danmaku-move,
.dplayer.dplayer-paused .dplayer-danmaku-move {
  animation-play-state: paused;
}
.dplayer.dplayer-hide-controller {
  cursor: none;
}
.dplayer.dplayer-hide-controller .dplayer-controller-mask {
  opacity: 0;
  transform: translateY(100%);
}
.dplayer.dplayer-hide-controller .dplayer-controller {
  opacity: 0;
  transform: translateY(100%);
}
.dplayer.dplayer-show-controller .dplayer-controller-mask {
  opacity: 1;
}
.dplayer.dplayer-show-controller .dplayer-controller {
  opacity: 1;
}
.dplayer.dplayer-fulled {
  position: fixed;
  z-index: 100000;
  left: 0;
  top: 0;
  width: 100% !important;
  height: 100% !important;
}
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-volume,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-camera-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-airplay-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-chromecast-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-play-icon {
  display: none;
}
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-full .dplayer-full-in-icon {
  position: static;
  display: inline-block;
}
.dplayer.dplayer-mobile .dplayer-bar-time {
  display: none;
}
.dplayer.dplayer-mobile.dplayer-hide-controller .dplayer-mobile-play {
  display: none;
}
.dplayer.dplayer-mobile .dplayer-mobile-play {
  display: block;
}
.dplayer-web-fullscreen-fix {
  position: fixed;
  top: 0;
  left: 0;
  margin: 0;
  padding: 0;
}
[data-balloon]:before {
  display: none;
}
[data-balloon]:after {
  padding: 0.3em 0.7em;
  background: rgba(17, 17, 17, 0.7);
}
[data-balloon][data-balloon-pos="up"]:after {
  margin-bottom: 0;
}
.dplayer-bezel {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  font-size: 22px;
  color: #fff;
  pointer-events: none;
}
.dplayer-bezel .dplayer-bezel-icon {
  position: absolute;
  top: 50%;
  left: 50%;
  margin: -26px 0 0 -26px;
  height: 52px;
  width: 52px;
  padding: 12px;
  box-sizing: border-box;
  background: rgba(0, 0, 0, 0.5);
  border-radius: 50%;
  opacity: 0;
  pointer-events: none;
}
.dplayer-bezel .dplayer-bezel-icon.dplayer-bezel-transition {
  animation: bezel-hide 0.5s linear;
}
@keyframes bezel-hide {
  from {
    opacity: 1;
    transform: scale(1);
  }
  to {
    opacity: 0;
    transform: scale(2);
  }
}
.dplayer-bezel .dplayer-danloading {
  position: absolute;
  top: 50%;
  margin-top: -7px;
  width: 100%;
  text-align: center;
  font-size: 14px;
  line-height: 14px;
  animation: my-face 5s infinite ease-in-out;
}
.dplayer-bezel .diplayer-loading-icon {
  display: none;
  position: absolute;
  top: 50%;
  left: 50%;
  margin: -18px 0 0 -18px;
  height: 36px;
  width: 36px;
  pointer-events: none;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-hide {
  display: none;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot {
  animation: diplayer-loading-dot-fade 0.8s ease infinite;
  opacity: 0;
  transform-origin: 4px 4px;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-1 {
  animation-delay: 0.1s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-2 {
  animation-delay: 0.2s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-3 {
  animation-delay: 0.3s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-4 {
  animation-delay: 0.4s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-5 {
  animation-delay: 0.5s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-6 {
  animation-delay: 0.6s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-7 {
  animation-delay: 0.7s;
}
@keyframes diplayer-loading-dot-fade {
  0% {
    opacity: 0.7;
    transform: scale(1.2, 1.2);
  }
  50% {
    opacity: 0.25;
    transform: scale(0.9, 0.9);
  }
  to {
    opacity: 0.25;
    transform: scale(0.85, 0.85);
  }
}
.dplayer-controller-mask {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAADGCAYAAAAT+OqFAAAAdklEQVQoz42QQQ7AIAgEF/T/D+kbq/RWAlnQyyazA4aoAB4FsBSA/bFjuF1EOL7VbrIrBuusmrt4ZZORfb6ehbWdnRHEIiITaEUKa5EJqUakRSaEYBJSCY2dEstQY7AuxahwXFrvZmWl2rh4JZ07z9dLtesfNj5q0FU3A5ObbwAAAABJRU5ErkJggg==) repeat-x bottom;
  height: 98px;
  width: 100%;
  position: absolute;
  bottom: 0;
  transition: all 0.3s ease;
}
.dplayer-controller {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 41px;
  padding: 0 20px;
  user-select: none;
  transition: all 0.3s ease;
}
.dplayer-controller.dplayer-controller-comment .dplayer-icons {
  display: none;
}
.dplayer-controller.dplayer-controller-comment .dplayer-icons.dplayer-comment-box {
  display: block;
}
.dplayer-controller .dplayer-bar-wrap {
  padding: 5px 0;
  cursor: pointer;
  position: absolute;
  bottom: 33px;
  width: calc(100% - 40px);
  height: 3px;
}
.dplayer-controller .dplayer-bar-wrap:hover .dplayer-bar .dplayer-played .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-bar-wrap:hover .dplayer-highlight {
  display: block;
  width: 8px;
  transform: translateX(-4px);
  top: 4px;
  height: 40%;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight {
  z-index: 12;
  position: absolute;
  top: 5px;
  width: 6px;
  height: 20%;
  border-radius: 6px;
  background-color: #fff;
  text-align: center;
  transform: translateX(-3px);
  transition: all 0.2s ease-in-out;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover .dplayer-highlight-text {
  display: block;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover ~ .dplayer-bar-preview {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover ~ .dplayer-bar-time {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight .dplayer-highlight-text {
  display: none;
  position: absolute;
  left: 50%;
  top: -24px;
  padding: 5px 8px;
  background-color: rgba(0, 0, 0, 0.62);
  color: #fff;
  border-radius: 4px;
  font-size: 12px;
  white-space: nowrap;
  transform: translateX(-50%);
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-preview {
  position: absolute;
  background: #fff;
  pointer-events: none;
  display: none;
  background-size: 16000px 100%;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-preview-canvas {
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: 1;
  pointer-events: none;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-time {
  position: absolute;
  left: 0px;
  top: -20px;
  border-radius: 4px;
  padding: 5px 7px;
  background-color: rgba(0, 0, 0, 0.62);
  color: #fff;
  font-size: 12px;
  text-align: center;
  opacity: 1;
  transition: opacity 0.1s ease-in-out;
  word-wrap: normal;
  word-break: normal;
  z-index: 2;
  pointer-events: none;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-time.hidden {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar {
  position: relative;
  height: 3px;
  width: 100%;
  background: rgba(255, 255, 255, 0.2);
  cursor: pointer;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-loaded {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  background: rgba(255, 255, 255, 0.4);
  height: 3px;
  transition: all 0.5s ease;
  will-change: width;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-played {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  height: 3px;
  will-change: width;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-played .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons {
  height: 38px;
  position: absolute;
  bottom: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box {
  display: none;
  position: absolute;
  transition: all 0.3s ease-in-out;
  z-index: 2;
  height: 38px;
  bottom: 0;
  left: 20px;
  right: 20px;
  color: #fff;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-icon {
  padding: 7px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-icon {
  position: absolute;
  left: 0;
  top: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-send-icon {
  position: absolute;
  right: 0;
  top: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box {
  position: absolute;
  background: rgba(28, 28, 28, 0.9);
  bottom: 41px;
  left: 0;
  box-shadow: 0 0 25px rgba(0, 0, 0, 0.3);
  border-radius: 4px;
  padding: 10px 10px 16px;
  font-size: 14px;
  width: 204px;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box.dplayer-comment-setting-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box input[type=radio] {
  display: none;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box label {
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-title {
  font-size: 13px;
  color: #fff;
  line-height: 30px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type {
  font-size: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type .dplayer-comment-setting-title {
  margin-bottom: 6px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type label:nth-child(2) span {
  border-radius: 4px 0 0 4px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type label:nth-child(4) span {
  border-radius: 0 4px 4px 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type span {
  width: 33%;
  padding: 4px 6px;
  line-height: 16px;
  display: inline-block;
  font-size: 12px;
  color: #fff;
  border: 1px solid #fff;
  margin-right: -1px;
  box-sizing: border-box;
  text-align: center;
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type input:checked + span {
  background: #E4E4E6;
  color: #1c1c1c;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color {
  font-size: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color label {
  font-size: 0;
  padding: 6px;
  display: inline-block;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color span {
  width: 22px;
  height: 22px;
  display: inline-block;
  border-radius: 50%;
  box-sizing: border-box;
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color span:hover {
  animation: my-face 5s infinite ease-in-out;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input {
  outline: none;
  border: none;
  padding: 8px 31px;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  border-radius: 4px;
  background: none;
  margin: 0;
  height: 100%;
  box-sizing: border-box;
  width: 100%;
  color: #fff;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::placeholder {
  color: #fff;
  opacity: 0.8;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::-ms-clear {
  display: none;
}
.dplayer-controller .dplayer-icons.dplayer-icons-left .dplayer-icon {
  padding: 7px;
}
.dplayer-controller .dplayer-icons.dplayer-icons-right {
  right: 20px;
}
.dplayer-controller .dplayer-icons.dplayer-icons-right .dplayer-icon {
  padding: 8px;
}
.dplayer-controller .dplayer-icons .dplayer-time,
.dplayer-controller .dplayer-icons .dplayer-live-badge {
  line-height: 38px;
  color: #eee;
  text-shadow: 0 0 2px rgba(0, 0, 0, 0.5);
  vertical-align: middle;
  font-size: 13px;
  cursor: default;
}
.dplayer-controller .dplayer-icons .dplayer-live-dot {
  display: inline-block;
  width: 6px;
  height: 6px;
  vertical-align: 4%;
  margin-right: 5px;
  content: '';
  border-radius: 6px;
}
.dplayer-controller .dplayer-icons .dplayer-icon {
  width: 40px;
  height: 100%;
  border: none;
  background-color: transparent;
  outline: none;
  cursor: pointer;
  vertical-align: middle;
  box-sizing: border-box;
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-icon .dplayer-icon-content {
  transition: all 0.2s ease-in-out;
  opacity: 0.8;
}
.dplayer-controller .dplayer-icons .dplayer-icon:hover .dplayer-icon-content {
  opacity: 1;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-quality-icon {
  color: #fff;
  width: auto;
  line-height: 22px;
  font-size: 14px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-comment-icon {
  padding: 10px 9px 9px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-setting-icon {
  padding-top: 8.5px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-volume-icon {
  width: 43px;
}
.dplayer-controller .dplayer-icons .dplayer-volume {
  position: relative;
  display: inline-block;
  cursor: pointer;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-volume:hover .dplayer-volume-bar-wrap .dplayer-volume-bar {
  width: 45px;
}
.dplayer-controller .dplayer-icons .dplayer-volume:hover .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-volume.dplayer-volume-active .dplayer-volume-bar-wrap .dplayer-volume-bar {
  width: 45px;
}
.dplayer-controller .dplayer-icons .dplayer-volume.dplayer-volume-active .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap {
  display: inline-block;
  margin: 0 10px 0 -5px;
  vertical-align: middle;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar {
  position: relative;
  top: 17px;
  width: 0;
  height: 3px;
  background: #aaa;
  transition: all 0.3s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 100%;
  transition: all 0.1s ease;
  will-change: width;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons .dplayer-subtitle-btn {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box {
  position: absolute;
  right: 0;
  bottom: 50px;
  transform: scale(0);
  width: fit-content;
  max-width: 240px;
  min-width: 120px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 7px 0;
  transition: all 0.3s ease-in-out;
  overflow: auto;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box.dplayer-subtitles-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box.dplayer-subtitles-box-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-item {
  height: 30px;
  padding: 5px 10px;
  box-sizing: border-box;
  cursor: pointer;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-setting {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box {
  position: absolute;
  right: 0;
  bottom: 50px;
  transform: scale(0);
  width: 150px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 7px 0;
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box > div {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box > div.dplayer-setting-origin-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-narrow {
  width: 70px;
  text-align: center;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-speed .dplayer-setting-origin-panel {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-speed .dplayer-setting-speed-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-item,
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-speed-item {
  height: 30px;
  padding: 5px 10px;
  box-sizing: border-box;
  cursor: pointer;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-item:hover,
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-speed-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku {
  padding: 5px 0;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-label {
  padding: 0 10px;
  display: inline;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku:hover .dplayer-label {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku:hover .dplayer-danmaku-bar-wrap {
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-label {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-danmaku-bar-wrap {
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap {
  padding: 0 10px;
  box-sizing: border-box;
  display: none;
  vertical-align: middle;
  height: 100%;
  width: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar {
  position: relative;
  top: 8.5px;
  width: 100%;
  height: 3px;
  background: #fff;
  transition: all 0.3s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar .dplayer-danmaku-bar-inner {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 100%;
  transition: all 0.1s ease;
  background: #aaa;
  will-change: width;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar .dplayer-danmaku-bar-inner .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  background: #aaa;
}
.dplayer-controller .dplayer-icons .dplayer-full {
  display: inline-block;
  height: 100%;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-full:hover .dplayer-full-in-icon {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-full .dplayer-full-in-icon {
  position: absolute;
  top: -30px;
  z-index: 1;
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-quality {
  position: relative;
  display: inline-block;
  height: 100%;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-quality:hover .dplayer-quality-list {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-quality:hover .dplayer-quality-mask {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-mask {
  display: none;
  position: absolute;
  bottom: 38px;
  left: -18px;
  width: 80px;
  padding-bottom: 12px;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-list {
  display: none;
  font-size: 12px;
  width: 80px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 5px 0;
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  color: #fff;
  text-align: center;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-item {
  height: 25px;
  box-sizing: border-box;
  cursor: pointer;
  line-height: 25px;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-comment {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-label {
  color: #eee;
  font-size: 13px;
  display: inline-block;
  vertical-align: middle;
  white-space: nowrap;
}
.dplayer-controller .dplayer-icons .dplayer-toggle {
  width: 32px;
  height: 20px;
  text-align: center;
  font-size: 0;
  vertical-align: middle;
  position: absolute;
  top: 5px;
  right: 10px;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input {
  max-height: 0;
  max-width: 0;
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label {
  display: inline-block;
  position: relative;
  box-shadow: #dfdfdf 0 0 0 0 inset;
  border: 1px solid #dfdfdf;
  height: 20px;
  width: 32px;
  border-radius: 10px;
  box-sizing: border-box;
  cursor: pointer;
  transition: 0.2s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label:before {
  content: "";
  position: absolute;
  display: block;
  height: 18px;
  width: 18px;
  top: 0;
  left: 0;
  border-radius: 15px;
  transition: 0.2s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label:after {
  content: "";
  position: absolute;
  display: block;
  left: 0;
  top: 0;
  border-radius: 15px;
  background: #fff;
  transition: 0.2s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
  height: 18px;
  width: 18px;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label {
  border-color: rgba(255, 255, 255, 0.5);
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label:before {
  width: 30px;
  background: rgba(255, 255, 255, 0.5);
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label:after {
  left: 12px;
}
.dplayer-mobile-play {
  display: none;
  width: 50px;
  height: 50px;
  border: none;
  background-color: transparent;
  outline: none;
  cursor: pointer;
  box-sizing: border-box;
  bottom: 0;
  opacity: 0.8;
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
}
.dplayer-danmaku {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  font-size: 22px;
  color: #fff;
}
.dplayer-danmaku .dplayer-danmaku-item {
  display: inline-block;
  pointer-events: none;
  user-select: none;
  cursor: default;
  white-space: nowrap;
  text-shadow: 0.5px 0.5px 0.5px rgba(0, 0, 0, 0.5);
}
.dplayer-danmaku .dplayer-danmaku-item--demo {
  position: absolute;
  visibility: hidden;
}
.dplayer-danmaku .dplayer-danmaku-right {
  position: absolute;
  right: 0;
  transform: translateX(100%);
}
.dplayer-danmaku .dplayer-danmaku-right.dplayer-danmaku-move {
  will-change: transform;
  animation-name: 'danmaku';
  animation-timing-function: linear;
  animation-play-state: paused;
}
@keyframes danmaku {
  from {
    transform: translateX(100%);
  }
}
.dplayer-danmaku .dplayer-danmaku-top,
.dplayer-danmaku .dplayer-danmaku-bottom {
  position: absolute;
  width: 100%;
  text-align: center;
  visibility: hidden;
}
.dplayer-danmaku .dplayer-danmaku-top.dplayer-danmaku-move,
.dplayer-danmaku .dplayer-danmaku-bottom.dplayer-danmaku-move {
  will-change: visibility;
  animation-name: 'danmaku-center';
  animation-timing-function: linear;
  animation-play-state: paused;
}
@keyframes danmaku-center {
  from {
    visibility: visible;
  }
  to {
    visibility: visible;
  }
}
.dplayer-logo {
  pointer-events: none;
  position: absolute;
  left: 20px;
  top: 20px;
  max-width: 50px;
  max-height: 50px;
}
.dplayer-logo img {
  max-width: 100%;
  max-height: 100%;
  background: none;
}
.dplayer-menu {
  position: absolute;
  width: 170px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.85);
  padding: 5px 0;
  overflow: hidden;
  z-index: 3;
  display: none;
}
.dplayer-menu.dplayer-menu-show {
  display: block;
}
.dplayer-menu .dplayer-menu-item {
  height: 30px;
  box-sizing: border-box;
  cursor: pointer;
}
.dplayer-menu .dplayer-menu-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-menu .dplayer-menu-item a {
  padding: 0 10px;
  line-height: 30px;
  color: #eee;
  font-size: 13px;
  display: inline-block;
  vertical-align: middle;
  width: 100%;
  box-sizing: border-box;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
.dplayer-menu .dplayer-menu-item a:hover {
  text-decoration: none;
}
.dplayer-notice-list {
  position: absolute;
  bottom: 60px;
  left: 20px;
}
.dplayer-notice-list .dplayer-notice {
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  color: #fff;
  display: table;
  pointer-events: none;
  animation: showNotice 0.3s ease 1 forwards;
}
.dplayer-notice-list .remove-notice {
  animation: removeNotice 0.3s ease 1 forwards;
}
@keyframes showNotice {
  from {
    padding: 0;
    font-size: 0;
    margin-top: 0;
  }
  to {
    padding: 7px 20px;
    font-size: 14px;
    margin-top: 5px;
  }
}
@keyframes removeNotice {
  0% {
    padding: 7px 20px;
    font-size: 14px;
    margin-top: 5px;
  }
  20% {
    font-size: 12px;
  }
  21% {
    font-size: 0;
    padding: 7px 10px;
  }
  100% {
    padding: 0;
    margin-top: 0;
    font-size: 0;
  }
}
.dplayer-subtitle {
  position: absolute;
  bottom: 40px;
  width: 90%;
  left: 5%;
  text-align: center;
  color: #fff;
  text-shadow: 0.5px 0.5px 0.5px rgba(0, 0, 0, 0.5);
  font-size: 20px;
}
.dplayer-subtitle.dplayer-subtitle-hide {
  display: none;
}
.dplayer-mask {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 1;
  display: none;
}
.dplayer-mask.dplayer-mask-show {
  display: block;
}
.dplayer-video-wrap {
  position: relative;
  background: #000;
  font-size: 0;
  width: 100%;
  height: 100%;
}
.dplayer-video-wrap .dplayer-video {
  width: 100%;
  height: 100%;
  display: none;
}
.dplayer-video-wrap .dplayer-video-current {
  display: block;
}
.dplayer-video-wrap .dplayer-video-prepare {
  display: none;
}
.dplayer-info-panel {
  position: absolute;
  top: 10px;
  left: 10px;
  width: 400px;
  background: rgba(28, 28, 28, 0.8);
  padding: 10px;
  color: #fff;
  font-size: 12px;
  border-radius: 2px;
}
.dplayer-info-panel-hide {
  display: none;
}
.dplayer-info-panel .dplayer-info-panel-close {
  cursor: pointer;
  position: absolute;
  right: 10px;
  top: 10px;
}
.dplayer-info-panel .dplayer-info-panel-item > span {
  display: inline-block;
  vertical-align: middle;
  line-height: 15px;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
.dplayer-info-panel .dplayer-info-panel-item-title {
  width: 100px;
  text-align: right;
  margin-right: 10px;
}
.dplayer-info-panel .dplayer-info-panel-item-data {
  width: 260px;
}
`,`.dplayer {
    position: relative;
    overflow: hidden;
    user-select: none;
    line-height: 1;

    * {
        box-sizing: content-box;
    }

    svg {
        width: 100%;
        height: 100%;

        path,
        circle {
            fill: #fff;
        }
    }

    &:-webkit-full-screen {
        width: 100%;
        height: 100%;
        background: #000;
        position: fixed;
        z-index: 100000;
        left: 0;
        top: 0;
        margin: 0;
        padding: 0;
        transform: translate(0, 0);
        
    }

    &.dplayer-no-danmaku {
        .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box {
            .dplayer-setting-showdan,
            .dplayer-setting-danmaku,
            .dplayer-setting-danunlimit {
                display: none;
            }
        }

        .dplayer-controller .dplayer-icons .dplayer-comment {
            display: none;
        }

        .dplayer-danmaku {
            display: none;
        }
    }

    &.dplayer-live {
        .dplayer-time {
            display: none;
        }
        .dplayer-bar-wrap {
            display: none;
        }
        .dplayer-setting-speed {
            display: none;
        }
        .dplayer-setting-loop {
            display: none;
        }

        &.dplayer-no-danmaku {
            .dplayer-setting {
                display: none;
            }
        }
    }

    &.dplayer-arrow {
        .dplayer-danmaku {
            font-size: 18px;
        }
        .dplayer-icon {
            margin: 0 -3px;
        }
    }

    &.dplayer-playing {
        .dplayer-danmaku .dplayer-danmaku-move {
            animation-play-state: running;
        }

        @media (min-width: 900px) {
            .dplayer-controller-mask {
                opacity: 0;
            }
            .dplayer-controller {
                opacity: 0;
            }

            &:hover {
                .dplayer-controller-mask {
                    opacity: 1;
                }
                .dplayer-controller {
                    opacity: 1;
                }
            }
        }
    }

    &.dplayer-loading {
        .dplayer-bezel .diplayer-loading-icon {
            display: block;
        }
    }

    &.dplayer-loading,
    &.dplayer-paused {
        .dplayer-danmaku,
        .dplayer-danmaku-move {
            animation-play-state: paused;
        }
    }

    &.dplayer-hide-controller {
        cursor: none;

        .dplayer-controller-mask {
            opacity: 0;
            transform: translateY(100%);
        }
        .dplayer-controller {
            opacity: 0;
            transform: translateY(100%);
        }
    }
    &.dplayer-show-controller {
        .dplayer-controller-mask {
            opacity: 1;
        }
        .dplayer-controller {
            opacity: 1;
        }
    }
    &.dplayer-fulled {
        position: fixed;
        z-index: 100000;
        left: 0;
        top: 0;
        width: 100% !important;
        height: 100% !important;
    }
    &.dplayer-mobile {
        .dplayer-controller .dplayer-icons {
            .dplayer-volume,
            .dplayer-camera-icon,
            .dplayer-airplay-icon,
            .dplayer-chromecast-icon,
            .dplayer-play-icon {
                display: none;
            }
            .dplayer-full .dplayer-full-in-icon {
                position: static;
                display: inline-block;
            }
        }

        .dplayer-bar-time {
            display: none;
        }

        &.dplayer-hide-controller {
            .dplayer-mobile-play {
                display: none;
            }
        }

        .dplayer-mobile-play {
            display: block;
        }
    }
}

// To hide scroll bar, apply this class to <body>
.dplayer-web-fullscreen-fix {
    position: fixed;
    top: 0;
    left: 0;
    margin: 0;
    padding: 0;
}
`,`@import '../../node_modules/balloon-css/balloon.css';

[data-balloon]:before {
    display: none;
}

[data-balloon]:after {
    padding: 0.3em 0.7em;
    background: rgba(17, 17, 17, 0.7);
}

[data-balloon][data-balloon-pos="up"]:after {
    margin-bottom: 0;
}`,`.dplayer-bezel {
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    font-size: 22px;
    color: #fff;
    pointer-events: none;
    .dplayer-bezel-icon {
        position: absolute;
        top: 50%;
        left: 50%;
        margin: -26px 0 0 -26px;
        height: 52px;
        width: 52px;
        padding: 12px;
        box-sizing: border-box;
        background: rgba(0, 0, 0, .5);
        border-radius: 50%;
        opacity: 0;
        pointer-events: none;
        &.dplayer-bezel-transition {
            animation: bezel-hide .5s linear;
        }
        @keyframes bezel-hide {
            from {
                opacity: 1;
                transform: scale(1);
            }
            to {
                opacity: 0;
                transform: scale(2);
            }
        }
    }
    .dplayer-danloading {
        position: absolute;
        top: 50%;
        margin-top: -7px;
        width: 100%;
        text-align: center;
        font-size: 14px;
        line-height: 14px;
        animation: my-face 5s infinite ease-in-out;
    }
    .diplayer-loading-icon {
        display: none;
        position: absolute;
        top: 50%;
        left: 50%;
        margin: -18px 0 0 -18px;
        height: 36px;
        width: 36px;
        pointer-events: none;
        .diplayer-loading-hide {
            display: none;
        }
        .diplayer-loading-dot {
            animation: diplayer-loading-dot-fade .8s ease infinite;
            opacity: 0;
            transform-origin: 4px 4px;
            each(range(7), {
                &.diplayer-loading-dot-@{value} {
                    animation-delay: (@value * 0.1s);
                }
            });
        }
        @keyframes diplayer-loading-dot-fade {
            0% {
                opacity: .7;
                transform: scale(1.2, 1.2)
            }
            50% {
                opacity: .25;
                transform: scale(.9, .9)
            }
            to {
                opacity: .25;
                transform: scale(.85, .85)
            }
        }
    }
}`,`.dplayer-notice-list{
    position: absolute;
    bottom: 60px;
    left: 20px;

    .dplayer-notice {
        border-radius: 2px;
        background: rgba(28, 28, 28, 0.9);
        transition: all .3s ease-in-out;
        overflow: hidden;
        color: #fff;
        display: table;
        pointer-events: none;
        animation: showNotice .3s ease 1 forwards;
    }

    .remove-notice{
        animation: removeNotice .3s ease 1 forwards;
    }
}

@keyframes showNotice {
    from {
        padding: 0;
        font-size: 0;
        margin-top: 0;
    }
    to {
        padding: 7px 20px;
        font-size: 14px;
        margin-top: 5px;
    }
}

@keyframes removeNotice {
    0%{
        padding: 7px 20px;
        font-size: 14px;
        margin-top: 5px;
    }
    20%{
        font-size: 12px;
    }
    21%{
        font-size: 0;
        padding: 7px 10px;
    }
    100%{
        padding: 0;
        margin-top: 0;
        font-size: 0;
    }
}
`,`.dplayer-controller-mask {
    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAADGCAYAAAAT+OqFAAAAdklEQVQoz42QQQ7AIAgEF/T/D+kbq/RWAlnQyyazA4aoAB4FsBSA/bFjuF1EOL7VbrIrBuusmrt4ZZORfb6ehbWdnRHEIiITaEUKa5EJqUakRSaEYBJSCY2dEstQY7AuxahwXFrvZmWl2rh4JZ07z9dLtesfNj5q0FU3A5ObbwAAAABJRU5ErkJggg==) repeat-x bottom;
    height: 98px;
    width: 100%;
    position: absolute;
    bottom: 0;
    transition: all 0.3s ease;
}

.dplayer-controller {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 41px;
    padding: 0 20px;
    user-select: none;
    transition: all 0.3s ease;
    &.dplayer-controller-comment {
        .dplayer-icons {
            display: none;
        }
        .dplayer-icons.dplayer-comment-box {
            display: block;
        }
    }
    .dplayer-bar-wrap {
        padding: 5px 0;
        cursor: pointer;
        position: absolute;
        bottom: 33px;
        width: calc(100% - 40px);
        height: 3px;
        &:hover {
            .dplayer-bar .dplayer-played .dplayer-thumb {
                transform: scale(1);
            }
            .dplayer-highlight {
                display: block;
                width: 8px;
                transform: translateX(-4px);
                top: 4px;
                height: 40%;
            }
        }
        .dplayer-highlight {
            z-index: 12;
            position: absolute;
            top: 5px;
            width: 6px;
            height: 20%;
            border-radius: 6px;
            background-color: #fff;
            text-align: center;
            transform: translateX(-3px);
            transition: all .2s ease-in-out;
            &:hover {
                .dplayer-highlight-text {
                    display: block;
                }
                &~.dplayer-bar-preview {
                    opacity: 0;
                }
                &~.dplayer-bar-time {
                    opacity: 0;
                }
            }
            .dplayer-highlight-text {
                display: none;
                position: absolute;
                left: 50%;
                top: -24px;
                padding: 5px 8px;
                background-color: rgba(0, 0, 0, .62);
                color: #fff;
                border-radius: 4px;
                font-size: 12px;
                white-space: nowrap;
                transform: translateX(-50%);
            }
        }
        .dplayer-bar-preview {
            position: absolute;
            background: #fff;
            pointer-events: none;
            display: none;
            background-size: 16000px 100%;
        }
        .dplayer-bar-preview-canvas {
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }
        .dplayer-bar-time {
            &.hidden {
                opacity: 0;
            }
            position: absolute;
            left: 0px;
            top: -20px;
            border-radius: 4px;
            padding: 5px 7px;
            background-color: rgba(0, 0, 0, 0.62);
            color: #fff;
            font-size: 12px;
            text-align: center;
            opacity: 1;
            transition: opacity .1s ease-in-out;
            word-wrap: normal;
            word-break: normal;
            z-index: 2;
            pointer-events: none;
        }
        .dplayer-bar {
            position: relative;
            height: 3px;
            width: 100%;
            background: rgba(255, 255, 255, .2);
            cursor: pointer;
            .dplayer-loaded {
                position: absolute;
                left: 0;
                top: 0;
                bottom: 0;
                background: rgba(255, 255, 255, .4);
                height: 3px;
                transition: all 0.5s ease;
                will-change: width;
            }
            .dplayer-played {
                position: absolute;
                left: 0;
                top: 0;
                bottom: 0;
                height: 3px;
                will-change: width;
                .dplayer-thumb {
                    position: absolute;
                    top: 0;
                    right: 5px;
                    margin-top: -4px;
                    margin-right: -10px;
                    height: 11px;
                    width: 11px;
                    border-radius: 50%;
                    cursor: pointer;
                    transition: all .3s ease-in-out;
                    transform: scale(0);
                }
            }
        }
    }
    .dplayer-icons {
        height: 38px;
        position: absolute;
        bottom: 0;
        &.dplayer-comment-box {
            display: none;
            position: absolute;
            transition: all .3s ease-in-out;
            z-index: 2;
            height: 38px;
            bottom: 0;
            left: 20px;
            right: 20px;
            color: #fff;
            .dplayer-icon {
                padding: 7px;
            }
            .dplayer-comment-setting-icon {
                position: absolute;
                left: 0;
                top: 0;
            }
            .dplayer-send-icon {
                position: absolute;
                right: 0;
                top: 0;
            }
            .dplayer-comment-setting-box {
                position: absolute;
                background: rgba(28, 28, 28, 0.9);
                bottom: 41px;
                left: 0;
                box-shadow: 0 0 25px rgba(0, 0, 0, .3);
                border-radius: 4px;
                padding: 10px 10px 16px;
                font-size: 14px;
                width: 204px;
                transition: all .3s ease-in-out;
                transform: scale(0);
                &.dplayer-comment-setting-open {
                    transform: scale(1);
                }
                input[type=radio] {
                    display: none;
                }
                label {
                    cursor: pointer;
                }
                .dplayer-comment-setting-title {
                    font-size: 13px;
                    color: #fff;
                    line-height: 30px;
                }
                .dplayer-comment-setting-type {
                    font-size: 0;
                    .dplayer-comment-setting-title {
                        margin-bottom: 6px;
                    }
                    label {
                        &:nth-child(2) {
                            span {
                                border-radius: 4px 0 0 4px;
                            }
                        }
                        &:nth-child(4) {
                            span {
                                border-radius: 0 4px 4px 0;
                            }
                        }
                    }
                    span {
                        width: 33%;
                        padding: 4px 6px;
                        line-height: 16px;
                        display: inline-block;
                        font-size: 12px;
                        color: #fff;
                        border: 1px solid #fff;
                        margin-right: -1px;
                        box-sizing: border-box;
                        text-align: center;
                        cursor: pointer;
                    }
                    input:checked+span {
                        background: #E4E4E6;
                        color: #1c1c1c;
                    }
                }
                .dplayer-comment-setting-color {
                    font-size: 0;
                    label {
                        font-size: 0;
                        padding: 6px;
                        display: inline-block;
                    }
                    span {
                        width: 22px;
                        height: 22px;
                        display: inline-block;
                        border-radius: 50%;
                        box-sizing: border-box;
                        cursor: pointer;
                        &:hover {
                            animation: my-face 5s infinite ease-in-out;
                        }
                    }
                }
            }
            .dplayer-comment-input {
                outline: none;
                border: none;
                padding: 8px 31px;
                font-size: 14px;
                line-height: 18px;
                text-align: center;
                border-radius: 4px;
                background: none;
                margin: 0;
                height: 100%;
                box-sizing: border-box;
                width: 100%;
                color: #fff;
                &::placeholder {
                    color: #fff;
                    opacity: 0.8;
                }
                &::-ms-clear {
                    display: none;
                }
            }
        }
        &.dplayer-icons-left {
            .dplayer-icon {
                padding: 7px;
            }
        }
        &.dplayer-icons-right {
            right: 20px;
            .dplayer-icon {
                padding: 8px;
            }
        }
        .dplayer-time,
        .dplayer-live-badge {
            line-height: 38px;
            color: #eee;
            text-shadow: 0 0 2px rgba(0, 0, 0, .5);
            vertical-align: middle;
            font-size: 13px;
            cursor: default;
        }
        .dplayer-live-dot {
            display: inline-block;
            width: 6px;
            height: 6px;
            vertical-align: 4%;
            margin-right: 5px;
            content: '';
            border-radius: 6px;
        }
        .dplayer-icon {
            width: 40px;
            height: 100%;
            border: none;
            background-color: transparent;
            outline: none;
            cursor: pointer;
            vertical-align: middle;
            box-sizing: border-box;
            display: inline-block;
            .dplayer-icon-content {
                transition: all .2s ease-in-out;
                opacity: .8;
            }
            &:hover {
                .dplayer-icon-content {
                    opacity: 1;
                }
            }
            &.dplayer-quality-icon {
                color: #fff;
                width: auto;
                line-height: 22px;
                font-size: 14px;
            }
            &.dplayer-comment-icon {
                padding: 10px 9px 9px;
            }
            &.dplayer-setting-icon {
                padding-top: 8.5px;
            }
            &.dplayer-volume-icon {
                width: 43px;
            }
        }
        .dplayer-volume {
            position: relative;
            display: inline-block;
            cursor: pointer;
            height: 100%;
            &:hover {
                .dplayer-volume-bar-wrap .dplayer-volume-bar {
                    width: 45px;
                }
                .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
                    transform: scale(1);
                }
            }
            &.dplayer-volume-active {
                .dplayer-volume-bar-wrap .dplayer-volume-bar {
                    width: 45px;
                }
                .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
                    transform: scale(1);
                }
            }
            .dplayer-volume-bar-wrap {
                display: inline-block;
                margin: 0 10px 0 -5px;
                vertical-align: middle;
                height: 100%;
                .dplayer-volume-bar {
                    position: relative;
                    top: 17px;
                    width: 0;
                    height: 3px;
                    background: #aaa;
                    transition: all 0.3s ease-in-out;
                    .dplayer-volume-bar-inner {
                        position: absolute;
                        bottom: 0;
                        left: 0;
                        height: 100%;
                        transition: all 0.1s ease;
                        will-change: width;
                        .dplayer-thumb {
                            position: absolute;
                            top: 0;
                            right: 5px;
                            margin-top: -4px;
                            margin-right: -10px;
                            height: 11px;
                            width: 11px;
                            border-radius: 50%;
                            cursor: pointer;
                            transition: all .3s ease-in-out;
                            transform: scale(0);
                        }
                    }
                }
            }
        }
        .dplayer-subtitle-btn {
            display: inline-block;
            height: 100%;
        }
        .dplayer-subtitles {
            display: inline-block;
            height: 100%;
            .dplayer-subtitles-box {
                position: absolute;
                right: 0;
                bottom: 50px;
                transform: scale(0);
                width: fit-content;
                max-width: 240px;
                min-width: 120px;
                border-radius: 2px;
                background: rgba(28, 28, 28, 0.9);
                padding: 7px 0;
                transition: all .3s ease-in-out;
                overflow: auto;
                z-index: 2;
                &.dplayer-subtitles-panel {
                    display: block;
                }
                &.dplayer-subtitles-box-open {
                    transform: scale(1);
                }
            }
            .dplayer-subtitles-item {
                height: 30px;
                padding: 5px 10px;
                box-sizing: border-box;
                cursor: pointer;
                position: relative;
                &:hover {
                    background-color: rgba(255, 255, 255, .1);
                }
            }
        }
        .dplayer-setting {
            display: inline-block;
            height: 100%;
            .dplayer-setting-box {
                position: absolute;
                right: 0;
                bottom: 50px;
                transform: scale(0);
                width: 150px;
                border-radius: 2px;
                background: rgba(28, 28, 28, 0.9);
                padding: 7px 0;
                transition: all .3s ease-in-out;
                overflow: hidden;
                z-index: 2;
                &>div {
                    display: none;
                    &.dplayer-setting-origin-panel {
                        display: block;
                    }
                }
                &.dplayer-setting-box-open {
                    transform: scale(1);
                }
                &.dplayer-setting-box-narrow {
                    width: 70px;
                    text-align: center;
                }
                &.dplayer-setting-box-speed {
                    .dplayer-setting-origin-panel {
                        display: none;
                    }
                    .dplayer-setting-speed-panel {
                        display: block;
                    }
                }
            }
            .dplayer-setting-item,
            .dplayer-setting-speed-item {
                height: 30px;
                padding: 5px 10px;
                box-sizing: border-box;
                cursor: pointer;
                position: relative;
                &:hover {
                    background-color: rgba(255, 255, 255, .1);
                }
            }
            .dplayer-setting-danmaku {
                padding: 5px 0;
                .dplayer-label {
                    padding: 0 10px;
                    display: inline;
                }
                &:hover {
                    .dplayer-label {
                        display: none;
                    }
                    .dplayer-danmaku-bar-wrap {
                        display: inline-block;
                    }
                }
                &.dplayer-setting-danmaku-active {
                    .dplayer-label {
                        display: none;
                    }
                    .dplayer-danmaku-bar-wrap {
                        display: inline-block;
                    }
                }
                .dplayer-danmaku-bar-wrap {
                    padding: 0 10px;
                    box-sizing: border-box;
                    display: none;
                    vertical-align: middle;
                    height: 100%;
                    width: 100%;
                    .dplayer-danmaku-bar {
                        position: relative;
                        top: 8.5px;
                        width: 100%;
                        height: 3px;
                        background: #fff;
                        transition: all 0.3s ease-in-out;
                        .dplayer-danmaku-bar-inner {
                            position: absolute;
                            bottom: 0;
                            left: 0;
                            height: 100%;
                            transition: all 0.1s ease;
                            background: #aaa;
                            will-change: width;
                            .dplayer-thumb {
                                position: absolute;
                                top: 0;
                                right: 5px;
                                margin-top: -4px;
                                margin-right: -10px;
                                height: 11px;
                                width: 11px;
                                border-radius: 50%;
                                cursor: pointer;
                                transition: all .3s ease-in-out;
                                background: #aaa;
                            }
                        }
                    }
                }
            }
        }
        .dplayer-full {
            display: inline-block;
            height: 100%;
            position: relative;
            &:hover {
                .dplayer-full-in-icon {
                    display: block;
                }
            }
            .dplayer-full-in-icon {
                position: absolute;
                top: -30px;
                z-index: 1;
                display: none;
            }
        }
        .dplayer-quality {
            position: relative;
            display: inline-block;
            height: 100%;
            z-index: 2;
            &:hover {
                .dplayer-quality-list {
                    display: block;
                }
                .dplayer-quality-mask {
                    display: block;
                }
            }
            .dplayer-quality-mask {
                display: none;
                position: absolute;
                bottom: 38px;
                left: -18px;
                width: 80px;
                padding-bottom: 12px;
            }
            .dplayer-quality-list {
                display: none;
                font-size: 12px;
                width: 80px;
                border-radius: 2px;
                background: rgba(28, 28, 28, 0.9);
                padding: 5px 0;
                transition: all .3s ease-in-out;
                overflow: hidden;
                color: #fff;
                text-align: center;
            }
            .dplayer-quality-item {
                height: 25px;
                box-sizing: border-box;
                cursor: pointer;
                line-height: 25px;
                &:hover {
                    background-color: rgba(255, 255, 255, .1);
                }
            }
        }
        .dplayer-comment {
            display: inline-block;
            height: 100%;
        }
        .dplayer-label {
            color: #eee;
            font-size: 13px;
            display: inline-block;
            vertical-align: middle;
            white-space: nowrap;
        }
        .dplayer-toggle {
            width: 32px;
            height: 20px;
            text-align: center;
            font-size: 0;
            vertical-align: middle;
            position: absolute;
            top: 5px;
            right: 10px;
            input {
                max-height: 0;
                max-width: 0;
                display: none;
            }
            input+label {
                display: inline-block;
                position: relative;
                box-shadow: rgb(223, 223, 223) 0 0 0 0 inset;
                border: 1px solid rgb(223, 223, 223);
                height: 20px;
                width: 32px;
                border-radius: 10px;
                box-sizing: border-box;
                cursor: pointer;
                transition: .2s ease-in-out;
            }
            input+label:before {
                content: "";
                position: absolute;
                display: block;
                height: 18px;
                width: 18px;
                top: 0;
                left: 0;
                border-radius: 15px;
                transition: .2s ease-in-out;
            }
            input+label:after {
                content: "";
                position: absolute;
                display: block;
                left: 0;
                top: 0;
                border-radius: 15px;
                background: #fff;
                transition: .2s ease-in-out;
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
                height: 18px;
                width: 18px;
            }
            input:checked+label {
                border-color: rgba(255, 255, 255, 0.5);
            }
            input:checked+label:before {
                width: 30px;
                background: rgba(255, 255, 255, 0.5);
            }
            input:checked+label:after {
                left: 12px;
            }
        }
    }
}

.dplayer-mobile-play {
    display: none;
    width: 50px;
    height: 50px;
    border: none;
    background-color: transparent;
    outline: none;
    cursor: pointer;
    box-sizing: border-box;
    position: absolute;
    bottom: 0;
    opacity: 0.8;
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
}`,`.dplayer-danmaku {
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    font-size: 22px;
    color: #fff;
    .dplayer-danmaku-item {
        display: inline-block;
        pointer-events: none;
        user-select: none;
        cursor: default;
        white-space: nowrap;
        text-shadow: .5px .5px .5px rgba(0, 0, 0, .5);
        &--demo {
            position: absolute;
            visibility: hidden;
        }
    }
    .dplayer-danmaku-right {
        position: absolute;
        right: 0;
        transform: translateX(100%);
        &.dplayer-danmaku-move {
            will-change: transform;
            animation-name: 'danmaku';
            animation-timing-function: linear;
            animation-play-state: paused;
        }
    }
    @keyframes danmaku {
        from {
            transform: translateX(100%);
        }
    }
    .dplayer-danmaku-top,
    .dplayer-danmaku-bottom {
        position: absolute;
        width: 100%;
        text-align: center;
        visibility: hidden;
        &.dplayer-danmaku-move {
            will-change: visibility;
            animation-name: 'danmaku-center';
            animation-timing-function: linear;
            animation-play-state: paused;
        }
    }
    @keyframes danmaku-center {
        from {
            visibility: visible;
        }
        to {
            visibility: visible;
        }
    }
}`,`.dplayer-logo {
    pointer-events: none;
    position: absolute;
    left: 20px;
    top: 20px;
    max-width: 50px;
    max-height: 50px;
    img {
        max-width: 100%;
        max-height: 100%;
        background: none;
    }
}`,`.dplayer-menu {
    position: absolute;
    width: 170px;
    border-radius: 2px;
    background: rgba(28, 28, 28, 0.85);
    padding: 5px 0;
    overflow: hidden;
    z-index: 3;
    display: none;
    &.dplayer-menu-show {
        display: block;
    }
    .dplayer-menu-item {
        height: 30px;
        box-sizing: border-box;
        cursor: pointer;
        &:hover {
            background-color: rgba(255, 255, 255, .1);
        }
        a {
            display: inline-block;
            padding: 0 10px;
            line-height: 30px;
            color: #eee;
            font-size: 13px;
            display: inline-block;
            vertical-align: middle;
            width: 100%;
            box-sizing: border-box;
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
            &:hover {
                text-decoration: none;
            }
        }
    }
}`,`.dplayer-subtitle {
    position: absolute;
    bottom: 40px;
    width: 90%;
    left: 5%;
    text-align: center;
    color: #fff;
    text-shadow: 0.5px 0.5px 0.5px rgba(0, 0, 0, 0.5);
    font-size: 20px;
    &.dplayer-subtitle-hide {
        display: none;
    }
}`,`.dplayer-mask {
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 1;
    display: none;
    &.dplayer-mask-show {
        display: block;
    }
}

.dplayer-video-wrap {
    position: relative;
    background: #000;
    font-size: 0;
    width: 100%;
    height: 100%;
    .dplayer-video {
        width: 100%;
        height: 100%;
        display: none;
    }
    .dplayer-video-current {
        display: block;
    }
    .dplayer-video-prepare {
        display: none;
    }
}`,`.dplayer-info-panel {
    position: absolute;
    top: 10px;
    left: 10px;
    width: 400px;
    background: rgba(28, 28, 28, 0.8);
    padding: 10px;
    color: #fff;
    font-size: 12px;
    border-radius: 2px;

    &-hide {
        display: none;
    }

    .dplayer-info-panel-close {
        cursor: pointer;
        position: absolute;
        right: 10px;
        top: 10px;
    }

    .dplayer-info-panel-item {
        & > span {
            display: inline-block;
            vertical-align: middle;
            line-height: 15px;
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
        }
    }

    .dplayer-info-panel-item-title {
        width: 100px;
        text-align: right;
        margin-right: 10px;
    }
    
    .dplayer-info-panel-item-data {
        width: 260px;
    }
}`],sourceRoot:""}]);const H=z},856:fe=>{"use strict";var Ee=[];function ye(Q){for(var w=-1,y=0;y<Ee.length;y++)if(Ee[y].identifier===Q){w=y;break}return w}function se(Q,w){for(var y={},$=[],D=0;D<Q.length;D++){var G=Q[D],z=w.base?G[0]+w.base:G[0],P=y[z]||0,H="".concat(z," ").concat(P);y[z]=P+1;var j=ye(H),V={css:G[1],media:G[2],sourceMap:G[3],supports:G[4],layer:G[5]};if(j!==-1)Ee[j].references++,Ee[j].updater(V);else{var T=te(V,w);w.byIndex=D,Ee.splice(D,0,{identifier:H,updater:T,references:1})}$.push(H)}return $}function te(Q,w){var y=w.domAPI(w);return y.update(Q),function($){if($){if($.css===Q.css&&$.media===Q.media&&$.sourceMap===Q.sourceMap&&$.supports===Q.supports&&$.layer===Q.layer)return;y.update(Q=$)}else y.remove()}}fe.exports=function(Q,w){var y=se(Q=Q||[],w=w||{});return function($){$=$||[];for(var D=0;D<y.length;D++){var G=ye(y[D]);Ee[G].references--}for(var z=se($,w),P=0;P<y.length;P++){var H=ye(y[P]);Ee[H].references===0&&(Ee[H].updater(),Ee.splice(H,1))}y=z}}},370:fe=>{"use strict";var Ee={};fe.exports=function(ye,se){var te=function(Q){if(Ee[Q]===void 0){var w=document.querySelector(Q);if(window.HTMLIFrameElement&&w instanceof window.HTMLIFrameElement)try{w=w.contentDocument.head}catch(y){w=null}Ee[Q]=w}return Ee[Q]}(ye);if(!te)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");te.appendChild(se)}},278:fe=>{"use strict";fe.exports=function(Ee){var ye=document.createElement("style");return Ee.setAttributes(ye,Ee.attributes),Ee.insert(ye,Ee.options),ye}},458:(fe,Ee,ye)=>{"use strict";fe.exports=function(se){var te=ye.nc;te&&se.setAttribute("nonce",te)}},470:fe=>{"use strict";fe.exports=function(Ee){var ye=Ee.insertStyleElement(Ee);return{update:function(se){(function(te,Q,w){var y="";w.supports&&(y+="@supports (".concat(w.supports,") {")),w.media&&(y+="@media ".concat(w.media," {"));var $=w.layer!==void 0;$&&(y+="@layer".concat(w.layer.length>0?" ".concat(w.layer):""," {")),y+=w.css,$&&(y+="}"),w.media&&(y+="}"),w.supports&&(y+="}");var D=w.sourceMap;D&&typeof btoa!="undefined"&&(y+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(D))))," */")),Q.styleTagTransform(y,te,Q.options)})(ye,Ee,se)},remove:function(){(function(se){if(se.parentNode===null)return!1;se.parentNode.removeChild(se)})(ye)}}}},488:fe=>{"use strict";fe.exports=function(Ee,ye){if(ye.styleSheet)ye.styleSheet.cssText=Ee;else{for(;ye.firstChild;)ye.removeChild(ye.firstChild);ye.appendChild(document.createTextNode(Ee))}}},251:fe=>{fe.exports='<svg viewBox="0 0 288 288" xmlns="http://www.w3.org/2000/svg"><path d="M288 90v96c0 20-16 36-36 36h-10c-16 0-16-24 0-24h10c7 0 12-5 12-12V90c0-7-5-12-12-12H36c-7 0-12 5-12 12v96c0 7 5 12 12 12h10c16 0 16 24 0 24H36c-20 0-36-16-36-36V90c0-20 16-36 36-36h216c20 0 36 16 36 36zm-120 62l48 68c14 20 1 38-20 38H92c-21 0-34-18-20-38l48-68c13-18 35-18 48 0z"></path></svg>'},113:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M16 23c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6zM16 13c-2.206 0-4 1.794-4 4s1.794 4 4 4c2.206 0 4-1.794 4-4s-1.794-4-4-4zM27 28h-22c-1.654 0-3-1.346-3-3v-16c0-1.654 1.346-3 3-3h3c0.552 0 1 0.448 1 1s-0.448 1-1 1h-3c-0.551 0-1 0.449-1 1v16c0 0.552 0.449 1 1 1h22c0.552 0 1-0.448 1-1v-16c0-0.551-0.448-1-1-1h-11c-0.552 0-1-0.448-1-1s0.448-1 1-1h11c1.654 0 3 1.346 3 3v16c0 1.654-1.346 3-3 3zM24 10.5c0 0.828 0.672 1.5 1.5 1.5s1.5-0.672 1.5-1.5c0-0.828-0.672-1.5-1.5-1.5s-1.5 0.672-1.5 1.5zM15 4c0 0.552-0.448 1-1 1h-4c-0.552 0-1-0.448-1-1v0c0-0.552 0.448-1 1-1h4c0.552 0 1 0.448 1 1v0z"></path></svg>'},193:fe=>{fe.exports='<svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="chromecast" class="svg-inline--fa fa-chromecast fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M447.8,64H64c-23.6,0-42.7,19.1-42.7,42.7v63.9H64v-63.9h383.8v298.6H298.6V448H448c23.6,0,42.7-19.1,42.7-42.7V106.7 C490.7,83.1,471.4,64,447.8,64z M21.3,383.6L21.3,383.6l0,63.9h63.9C85.2,412.2,56.6,383.6,21.3,383.6L21.3,383.6z M21.3,298.6V341 c58.9,0,106.6,48.1,106.6,107h42.7C170.7,365.6,103.7,298.7,21.3,298.6z M213.4,448h42.7c-0.5-129.5-105.3-234.3-234.8-234.6l0,42.4 C127.3,255.6,213.3,342,213.4,448z"></path></svg>'},338:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M27.090 0.131h-22.731c-2.354 0-4.262 1.839-4.262 4.109v16.401c0 2.269 1.908 4.109 4.262 4.109h4.262v-2.706h8.469l-8.853 8.135 1.579 1.451 7.487-6.88h9.787c2.353 0 4.262-1.84 4.262-4.109v-16.401c0-2.27-1.909-4.109-4.262-4.109v0zM28.511 19.304c0 1.512-1.272 2.738-2.841 2.738h-8.425l-0.076-0.070-0.076 0.070h-11.311c-1.569 0-2.841-1.226-2.841-2.738v-13.696c0-1.513 1.272-2.739 2.841-2.739h19.889c1.569 0 2.841-0.142 2.841 1.37v15.064z"></path></svg>'},807:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M27.128 0.38h-22.553c-2.336 0-4.229 1.825-4.229 4.076v16.273c0 2.251 1.893 4.076 4.229 4.076h4.229v-2.685h8.403l-8.784 8.072 1.566 1.44 7.429-6.827h9.71c2.335 0 4.229-1.825 4.229-4.076v-16.273c0-2.252-1.894-4.076-4.229-4.076zM28.538 19.403c0 1.5-1.262 2.717-2.819 2.717h-8.36l-0.076-0.070-0.076 0.070h-11.223c-1.557 0-2.819-1.217-2.819-2.717v-13.589c0-1.501 1.262-2.718 2.819-2.718h19.734c1.557 0 2.819-0.141 2.819 1.359v14.947zM9.206 10.557c-1.222 0-2.215 0.911-2.215 2.036s0.992 2.035 2.215 2.035c1.224 0 2.216-0.911 2.216-2.035s-0.992-2.036-2.216-2.036zM22.496 10.557c-1.224 0-2.215 0.911-2.215 2.036s0.991 2.035 2.215 2.035c1.224 0 2.215-0.911 2.215-2.035s-0.991-2.036-2.215-2.036zM15.852 10.557c-1.224 0-2.215 0.911-2.215 2.036s0.991 2.035 2.215 2.035c1.222 0 2.215-0.911 2.215-2.035s-0.992-2.036-2.215-2.036z"></path></svg>'},300:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 33"><path d="M24.965 24.38h-18.132c-1.366 0-2.478-1.113-2.478-2.478v-11.806c0-1.364 1.111-2.478 2.478-2.478h18.132c1.366 0 2.478 1.113 2.478 2.478v11.806c0 1.364-1.11 2.478-2.478 2.478zM6.833 10.097v11.806h18.134l-0.002-11.806h-18.132zM2.478 28.928h5.952c0.684 0 1.238-0.554 1.238-1.239 0-0.684-0.554-1.238-1.238-1.238h-5.952v-5.802c0-0.684-0.554-1.239-1.238-1.239s-1.239 0.556-1.239 1.239v5.802c0 1.365 1.111 2.478 2.478 2.478zM30.761 19.412c-0.684 0-1.238 0.554-1.238 1.238v5.801h-5.951c-0.686 0-1.239 0.554-1.239 1.238 0 0.686 0.554 1.239 1.239 1.239h5.951c1.366 0 2.478-1.111 2.478-2.478v-5.801c0-0.683-0.554-1.238-1.239-1.238zM0 5.55v5.802c0 0.683 0.554 1.238 1.238 1.238s1.238-0.555 1.238-1.238v-5.802h5.952c0.684 0 1.238-0.554 1.238-1.238s-0.554-1.238-1.238-1.238h-5.951c-1.366-0.001-2.478 1.111-2.478 2.476zM32 11.35v-5.801c0-1.365-1.11-2.478-2.478-2.478h-5.951c-0.686 0-1.239 0.554-1.239 1.238s0.554 1.238 1.239 1.238h5.951v5.801c0 0.683 0.554 1.237 1.238 1.237 0.686 0.002 1.239-0.553 1.239-1.236z"></path></svg>'},574:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 33"><path d="M6.667 28h-5.333c-0.8 0-1.333-0.533-1.333-1.333v-5.333c0-0.8 0.533-1.333 1.333-1.333s1.333 0.533 1.333 1.333v4h4c0.8 0 1.333 0.533 1.333 1.333s-0.533 1.333-1.333 1.333zM30.667 28h-5.333c-0.8 0-1.333-0.533-1.333-1.333s0.533-1.333 1.333-1.333h4v-4c0-0.8 0.533-1.333 1.333-1.333s1.333 0.533 1.333 1.333v5.333c0 0.8-0.533 1.333-1.333 1.333zM30.667 12c-0.8 0-1.333-0.533-1.333-1.333v-4h-4c-0.8 0-1.333-0.533-1.333-1.333s0.533-1.333 1.333-1.333h5.333c0.8 0 1.333 0.533 1.333 1.333v5.333c0 0.8-0.533 1.333-1.333 1.333zM1.333 12c-0.8 0-1.333-0.533-1.333-1.333v-5.333c0-0.8 0.533-1.333 1.333-1.333h5.333c0.8 0 1.333 0.533 1.333 1.333s-0.533 1.333-1.333 1.333h-4v4c0 0.8-0.533 1.333-1.333 1.333z"></path></svg>'},182:fe=>{fe.exports='<svg version="1.1" viewBox="0 0 22 22"><svg x="7" y="1"><circle class="diplayer-loading-dot diplayer-loading-dot-0" cx="4" cy="4" r="2"></circle></svg><svg x="11" y="3"><circle class="diplayer-loading-dot diplayer-loading-dot-1" cx="4" cy="4" r="2"></circle></svg><svg x="13" y="7"><circle class="diplayer-loading-dot diplayer-loading-dot-2" cx="4" cy="4" r="2"></circle></svg><svg x="11" y="11"><circle class="diplayer-loading-dot diplayer-loading-dot-3" cx="4" cy="4" r="2"></circle></svg><svg x="7" y="13"><circle class="diplayer-loading-dot diplayer-loading-dot-4" cx="4" cy="4" r="2"></circle></svg><svg x="3" y="11"><circle class="diplayer-loading-dot diplayer-loading-dot-5" cx="4" cy="4" r="2"></circle></svg><svg x="1" y="7"><circle class="diplayer-loading-dot diplayer-loading-dot-6" cx="4" cy="4" r="2"></circle></svg><svg x="3" y="3"><circle class="diplayer-loading-dot diplayer-loading-dot-7" cx="4" cy="4" r="2"></circle></svg></svg>'},965:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M19.357 2.88c1.749 0 3.366 0.316 4.851 0.946 1.485 0.632 2.768 1.474 3.845 2.533s1.922 2.279 2.532 3.661c0.611 1.383 0.915 2.829 0.915 4.334 0 1.425-0.304 2.847-0.915 4.271-0.611 1.425-1.587 2.767-2.928 4.028-0.855 0.813-1.811 1.607-2.869 2.38s-2.136 1.465-3.233 2.075c-1.099 0.61-2.198 1.098-3.296 1.465-1.098 0.366-2.115 0.549-3.051 0.549-1.343 0-2.441-0.438-3.296-1.311-0.854-0.876-1.281-2.41-1.281-4.608 0-0.366 0.020-0.773 0.060-1.221s0.062-0.895 0.062-1.343c0-0.773-0.183-1.353-0.55-1.738-0.366-0.387-0.793-0.58-1.281-0.58-0.652 0-1.21 0.295-1.678 0.886s-0.926 1.23-1.373 1.921c-0.447 0.693-0.905 1.334-1.372 1.923s-1.028 0.886-1.679 0.886c-0.529 0-1.048-0.427-1.556-1.282s-0.763-2.259-0.763-4.212c0-2.197 0.529-4.241 1.587-6.133s2.462-3.529 4.21-4.912c1.75-1.383 3.762-2.471 6.041-3.264 2.277-0.796 4.617-1.212 7.018-1.253zM7.334 15.817c0.569 0 1.047-0.204 1.434-0.611s0.579-0.875 0.579-1.404c0-0.569-0.193-1.047-0.579-1.434s-0.864-0.579-1.434-0.579c-0.529 0-0.987 0.193-1.373 0.579s-0.58 0.864-0.58 1.434c0 0.53 0.194 0.998 0.58 1.404 0.388 0.407 0.845 0.611 1.373 0.611zM12.216 11.79c0.691 0 1.292-0.254 1.8-0.763s0.762-1.107 0.762-1.8c0-0.732-0.255-1.343-0.762-1.831-0.509-0.489-1.109-0.732-1.8-0.732-0.732 0-1.342 0.244-1.831 0.732-0.488 0.488-0.732 1.098-0.732 1.831 0 0.693 0.244 1.292 0.732 1.8s1.099 0.763 1.831 0.763zM16.366 25.947c0.692 0 1.282-0.214 1.77-0.64s0.732-0.987 0.732-1.678-0.244-1.261-0.732-1.709c-0.489-0.448-1.078-0.671-1.77-0.671-0.65 0-1.21 0.223-1.678 0.671s-0.702 1.018-0.702 1.709c0 0.692 0.234 1.25 0.702 1.678s1.027 0.64 1.678 0.64zM19.113 9.592c0.651 0 1.129-0.203 1.433-0.611 0.305-0.406 0.459-0.874 0.459-1.404 0-0.488-0.154-0.947-0.459-1.373-0.304-0.427-0.782-0.641-1.433-0.641-0.529 0-1.008 0.193-1.434 0.58s-0.64 0.865-0.64 1.434c0 0.571 0.213 1.049 0.64 1.434 0.427 0.389 0.905 0.581 1.434 0.581zM24.848 12.826c0.57 0 1.067-0.213 1.495-0.64 0.427-0.427 0.64-0.947 0.64-1.556 0-0.57-0.214-1.068-0.64-1.495-0.428-0.427-0.927-0.64-1.495-0.64-0.611 0-1.129 0.213-1.555 0.64-0.428 0.427-0.642 0.926-0.642 1.495 0 0.611 0.213 1.129 0.642 1.556s0.947 0.64 1.555 0.64z"></path></svg>'},74:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 17 32"><path d="M14.080 4.8q2.88 0 2.88 2.048v18.24q0 2.112-2.88 2.112t-2.88-2.112v-18.24q0-2.048 2.88-2.048zM2.88 4.8q2.88 0 2.88 2.048v18.24q0 2.112-2.88 2.112t-2.88-2.112v-18.24q0-2.048 2.88-2.048z"></path></svg>'},730:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 16 32"><path d="M15.552 15.168q0.448 0.32 0.448 0.832 0 0.448-0.448 0.768l-13.696 8.512q-0.768 0.512-1.312 0.192t-0.544-1.28v-16.448q0-0.96 0.544-1.28t1.312 0.192z"></path></svg>'},428:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M22 16l-10.105-10.6-1.895 1.987 8.211 8.613-8.211 8.612 1.895 1.988 8.211-8.613z"></path></svg>'},254:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M13.725 30l3.9-5.325-3.9-1.125v6.45zM0 17.5l11.050 3.35 13.6-11.55-10.55 12.425 11.8 3.65 6.1-23.375-32 15.5z"></path></svg>'},934:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 28"><path d="M28.633 17.104c0.035 0.21 0.026 0.463-0.026 0.76s-0.14 0.598-0.262 0.904c-0.122 0.306-0.271 0.581-0.445 0.825s-0.367 0.419-0.576 0.524c-0.209 0.105-0.393 0.157-0.55 0.157s-0.332-0.035-0.524-0.105c-0.175-0.052-0.393-0.1-0.655-0.144s-0.528-0.052-0.799-0.026c-0.271 0.026-0.541 0.083-0.812 0.17s-0.502 0.236-0.694 0.445c-0.419 0.437-0.664 0.934-0.734 1.493s0.009 1.092 0.236 1.598c0.175 0.349 0.148 0.699-0.079 1.048-0.105 0.14-0.271 0.284-0.498 0.432s-0.476 0.284-0.747 0.406-0.555 0.218-0.851 0.288c-0.297 0.070-0.559 0.105-0.786 0.105-0.157 0-0.306-0.061-0.445-0.183s-0.236-0.253-0.288-0.393h-0.026c-0.192-0.541-0.52-1.009-0.982-1.402s-1-0.589-1.611-0.589c-0.594 0-1.131 0.197-1.611 0.589s-0.816 0.851-1.009 1.375c-0.087 0.21-0.218 0.362-0.393 0.458s-0.367 0.144-0.576 0.144c-0.244 0-0.52-0.044-0.825-0.131s-0.611-0.197-0.917-0.327c-0.306-0.131-0.581-0.284-0.825-0.458s-0.428-0.349-0.55-0.524c-0.087-0.122-0.135-0.266-0.144-0.432s0.057-0.397 0.197-0.694c0.192-0.402 0.266-0.86 0.223-1.375s-0.266-0.991-0.668-1.428c-0.244-0.262-0.541-0.432-0.891-0.511s-0.681-0.109-0.995-0.092c-0.367 0.017-0.742 0.087-1.127 0.21-0.244 0.070-0.489 0.052-0.734-0.052-0.192-0.070-0.371-0.231-0.537-0.485s-0.314-0.533-0.445-0.838c-0.131-0.306-0.231-0.62-0.301-0.943s-0.087-0.59-0.052-0.799c0.052-0.384 0.227-0.629 0.524-0.734 0.524-0.21 0.995-0.555 1.415-1.035s0.629-1.017 0.629-1.611c0-0.611-0.21-1.144-0.629-1.598s-0.891-0.786-1.415-0.996c-0.157-0.052-0.288-0.179-0.393-0.38s-0.157-0.406-0.157-0.616c0-0.227 0.035-0.48 0.105-0.76s0.162-0.55 0.275-0.812 0.244-0.502 0.393-0.72c0.148-0.218 0.31-0.38 0.485-0.485 0.14-0.087 0.275-0.122 0.406-0.105s0.275 0.052 0.432 0.105c0.524 0.21 1.070 0.275 1.637 0.197s1.070-0.327 1.506-0.747c0.21-0.209 0.362-0.467 0.458-0.773s0.157-0.607 0.183-0.904c0.026-0.297 0.026-0.568 0-0.812s-0.048-0.419-0.065-0.524c-0.035-0.105-0.066-0.227-0.092-0.367s-0.013-0.262 0.039-0.367c0.105-0.244 0.293-0.458 0.563-0.642s0.563-0.336 0.878-0.458c0.314-0.122 0.62-0.214 0.917-0.275s0.533-0.092 0.707-0.092c0.227 0 0.406 0.074 0.537 0.223s0.223 0.301 0.275 0.458c0.192 0.471 0.507 0.886 0.943 1.244s0.952 0.537 1.546 0.537c0.611 0 1.153-0.17 1.624-0.511s0.803-0.773 0.996-1.297c0.070-0.14 0.179-0.284 0.327-0.432s0.301-0.223 0.458-0.223c0.244 0 0.511 0.035 0.799 0.105s0.572 0.166 0.851 0.288c0.279 0.122 0.537 0.279 0.773 0.472s0.423 0.402 0.563 0.629c0.087 0.14 0.113 0.293 0.079 0.458s-0.070 0.284-0.105 0.354c-0.227 0.506-0.297 1.039-0.21 1.598s0.341 1.048 0.76 1.467c0.419 0.419 0.934 0.651 1.546 0.694s1.179-0.057 1.703-0.301c0.14-0.087 0.31-0.122 0.511-0.105s0.371 0.096 0.511 0.236c0.262 0.244 0.493 0.616 0.694 1.113s0.336 1 0.406 1.506c0.035 0.297-0.013 0.528-0.144 0.694s-0.266 0.275-0.406 0.327c-0.542 0.192-1.004 0.528-1.388 1.009s-0.576 1.026-0.576 1.637c0 0.594 0.162 1.113 0.485 1.559s0.747 0.764 1.27 0.956c0.122 0.070 0.227 0.14 0.314 0.21 0.192 0.157 0.323 0.358 0.393 0.602v0zM16.451 19.462c0.786 0 1.528-0.149 2.227-0.445s1.305-0.707 1.821-1.231c0.515-0.524 0.921-1.131 1.218-1.821s0.445-1.428 0.445-2.214c0-0.786-0.148-1.524-0.445-2.214s-0.703-1.292-1.218-1.808c-0.515-0.515-1.122-0.921-1.821-1.218s-1.441-0.445-2.227-0.445c-0.786 0-1.524 0.148-2.214 0.445s-1.292 0.703-1.808 1.218c-0.515 0.515-0.921 1.118-1.218 1.808s-0.445 1.428-0.445 2.214c0 0.786 0.149 1.524 0.445 2.214s0.703 1.297 1.218 1.821c0.515 0.524 1.118 0.934 1.808 1.231s1.428 0.445 2.214 0.445v0z"></path></svg>'},410:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M26.667 5.333h-21.333c-0 0-0.001 0-0.001 0-1.472 0-2.666 1.194-2.666 2.666 0 0 0 0.001 0 0.001v-0 16c0 0 0 0.001 0 0.001 0 1.472 1.194 2.666 2.666 2.666 0 0 0.001 0 0.001 0h21.333c0 0 0.001 0 0.001 0 1.472 0 2.666-1.194 2.666-2.666 0-0 0-0.001 0-0.001v0-16c0-0 0-0.001 0-0.001 0-1.472-1.194-2.666-2.666-2.666-0 0-0.001 0-0.001 0h0zM5.333 16h5.333v2.667h-5.333v-2.667zM18.667 24h-13.333v-2.667h13.333v2.667zM26.667 24h-5.333v-2.667h5.333v2.667zM26.667 18.667h-13.333v-2.667h13.333v2.667z"></path></svg>'},644:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8zM20.576 16q0 1.344-0.768 2.528t-2.016 1.664q-0.16 0.096-0.448 0.096-0.448 0-0.8-0.32t-0.32-0.832q0-0.384 0.192-0.64t0.544-0.448 0.608-0.384 0.512-0.64 0.192-1.024-0.192-1.024-0.512-0.64-0.608-0.384-0.544-0.448-0.192-0.64q0-0.48 0.32-0.832t0.8-0.32q0.288 0 0.448 0.096 1.248 0.48 2.016 1.664t0.768 2.528z"></path></svg>'},324:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8z"></path></svg>'},437:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8zM20.576 16q0 1.344-0.768 2.528t-2.016 1.664q-0.16 0.096-0.448 0.096-0.448 0-0.8-0.32t-0.32-0.832q0-0.384 0.192-0.64t0.544-0.448 0.608-0.384 0.512-0.64 0.192-1.024-0.192-1.024-0.512-0.64-0.608-0.384-0.544-0.448-0.192-0.64q0-0.48 0.32-0.832t0.8-0.32q0.288 0 0.448 0.096 1.248 0.48 2.016 1.664t0.768 2.528zM25.152 16q0 2.72-1.536 5.056t-4 3.36q-0.256 0.096-0.448 0.096-0.48 0-0.832-0.352t-0.32-0.8q0-0.704 0.672-1.056 1.024-0.512 1.376-0.8 1.312-0.96 2.048-2.4t0.736-3.104-0.736-3.104-2.048-2.4q-0.352-0.288-1.376-0.8-0.672-0.352-0.672-1.056 0-0.448 0.32-0.8t0.8-0.352q0.224 0 0.48 0.096 2.496 1.056 4 3.36t1.536 5.056z"></path></svg>'},897:(fe,Ee,ye)=>{"use strict";var se=typeof self!="undefined"?self:typeof window!="undefined"?window:ye.g!==void 0?ye.g:{},te=Object.create(se),Q=/["&'<>]/;function w(y){return typeof y!="string"&&(y=y==null?"":typeof y=="function"?w(y.call(y)):JSON.stringify(y)),y}te.$escape=function(y){return function($){var D=""+$,G=Q.exec(D);if(!G)return $;var z="",P=void 0,H=void 0,j=void 0;for(P=G.index,H=0;P<D.length;P++){switch(D.charCodeAt(P)){case 34:j="&#34;";break;case 38:j="&#38;";break;case 39:j="&#39;";break;case 60:j="&#60;";break;case 62:j="&#62;";break;default:continue}H!==P&&(z+=D.substring(H,P)),H=P+1,z+=j}return H!==P?z+D.substring(H,P):z}(w(y))},te.$each=function(y,$){if(Array.isArray(y))for(var D=0,G=y.length;D<G;D++)$(y[D],D);else for(var z in y)$(y[z],z)},fe.exports=te},471:(fe,Ee,ye)=>{"use strict";fe.exports=ye(897)},352:fe=>{"use strict";fe.exports=function(Ee){var ye=[];return ye.toString=function(){return this.map(function(se){var te="",Q=se[5]!==void 0;return se[4]&&(te+="@supports (".concat(se[4],") {")),se[2]&&(te+="@media ".concat(se[2]," {")),Q&&(te+="@layer".concat(se[5].length>0?" ".concat(se[5]):""," {")),te+=Ee(se),Q&&(te+="}"),se[2]&&(te+="}"),se[4]&&(te+="}"),te}).join("")},ye.i=function(se,te,Q,w,y){typeof se=="string"&&(se=[[null,se,void 0]]);var $={};if(Q)for(var D=0;D<this.length;D++){var G=this[D][0];G!=null&&($[G]=!0)}for(var z=0;z<se.length;z++){var P=[].concat(se[z]);Q&&$[P[0]]||(y!==void 0&&(P[5]===void 0||(P[1]="@layer".concat(P[5].length>0?" ".concat(P[5]):""," {").concat(P[1],"}")),P[5]=y),te&&(P[2]&&(P[1]="@media ".concat(P[2]," {").concat(P[1],"}")),P[2]=te),w&&(P[4]?(P[1]="@supports (".concat(P[4],") {").concat(P[1],"}"),P[4]=w):P[4]="".concat(w)),ye.push(P))}},ye}},80:fe=>{"use strict";fe.exports=function(Ee,ye){return ye||(ye={}),Ee&&(Ee=String(Ee.__esModule?Ee.default:Ee),/^['"].*['"]$/.test(Ee)&&(Ee=Ee.slice(1,-1)),ye.hash&&(Ee+=ye.hash),/["'() \t\n]|(%20)/.test(Ee)||ye.needQuotes?'"'.concat(Ee.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):Ee)}},415:fe=>{"use strict";fe.exports=function(Ee){var ye=Ee[1],se=Ee[3];if(!se)return ye;if(typeof btoa=="function"){var te=btoa(unescape(encodeURIComponent(JSON.stringify(se)))),Q="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(te),w="/*# ".concat(Q," */");return[ye].concat([w]).join(`
`)}return[ye].join(`
`)}},937:fe=>{function Ee(ye){return Ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(se){return typeof se}:function(se){return se&&typeof Symbol=="function"&&se.constructor===Symbol&&se!==Symbol.prototype?"symbol":typeof se},Ee(ye)}fe.exports=(typeof self=="undefined"?"undefined":Ee(self))=="object"?self.FormData:window.FormData},831:fe=>{"use strict";fe.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAADGCAYAAAAT+OqFAAAAdklEQVQoz42QQQ7AIAgEF/T/D+kbq/RWAlnQyyazA4aoAB4FsBSA/bFjuF1EOL7VbrIrBuusmrt4ZZORfb6ehbWdnRHEIiITaEUKa5EJqUakRSaEYBJSCY2dEstQY7AuxahwXFrvZmWl2rh4JZ07z9dLtesfNj5q0FU3A5ObbwAAAABJRU5ErkJggg=="}},Ze={};function _e(fe){var Ee=Ze[fe];if(Ee!==void 0)return Ee.exports;var ye=Ze[fe]={id:fe,exports:{}};return ae[fe](ye,ye.exports,_e),ye.exports}_e.m=ae,_e.n=fe=>{var Ee=fe&&fe.__esModule?()=>fe.default:()=>fe;return _e.d(Ee,{a:Ee}),Ee},_e.d=(fe,Ee)=>{for(var ye in Ee)_e.o(Ee,ye)&&!_e.o(fe,ye)&&Object.defineProperty(fe,ye,{enumerable:!0,get:Ee[ye]})},_e.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(fe){if(typeof window=="object")return window}}(),_e.o=(fe,Ee)=>Object.prototype.hasOwnProperty.call(fe,Ee),_e.b=document.baseURI||self.location.href,_e.nc=void 0;var tt={};return(()=>{"use strict";_e.d(tt,{default:()=>qa});var fe=_e(856),Ee=_e.n(fe),ye=_e(470),se=_e.n(ye),te=_e(370),Q=_e.n(te),w=_e(458),y=_e.n(w),$=_e(278),D=_e.n($),G=_e(488),z=_e.n(G),P=_e(685),H={};H.styleTagTransform=z(),H.setAttributes=y(),H.insert=Q().bind(null,"head"),H.domAPI=se(),H.insertStyleElement=D(),Ee()(P.Z,H),P.Z&&P.Z.locals&&P.Z.locals;function j(x){return j=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},j(x)}function V(x,L){this.name="AggregateError",this.errors=x,this.message=L||""}V.prototype=Error.prototype;function T(x){return T=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},T(x)}var Z=setTimeout;function ie(x){return Boolean(x&&x.length!==void 0)}function le(){}function F(x){if(!(this instanceof F))throw new TypeError("Promises must be constructed via new");if(typeof x!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],Se(x,this)}function K(x,L){for(;x._state===3;)x=x._value;x._state!==0?(x._handled=!0,F._immediateFn(function(){var q=x._state===1?L.onFulfilled:L.onRejected;if(q!==null){var _;try{_=q(x._value)}catch(R){return void de(L.promise,R)}ne(L.promise,_)}else(x._state===1?ne:de)(L.promise,x._value)})):x._deferreds.push(L)}function ne(x,L){try{if(L===x)throw new TypeError("A promise cannot be resolved with itself.");if(L&&(T(L)==="object"||typeof L=="function")){var q=L.then;if(L instanceof F)return x._state=3,x._value=L,void ve(x);if(typeof q=="function")return void Se((_=q,R=L,function(){_.apply(R,arguments)}),x)}x._state=1,x._value=L,ve(x)}catch(B){de(x,B)}var _,R}function de(x,L){x._state=2,x._value=L,ve(x)}function ve(x){x._state===2&&x._deferreds.length===0&&F._immediateFn(function(){x._handled||F._unhandledRejectionFn(x._value)});for(var L=0,q=x._deferreds.length;L<q;L++)K(x,x._deferreds[L]);x._deferreds=null}function De(x,L,q){this.onFulfilled=typeof x=="function"?x:null,this.onRejected=typeof L=="function"?L:null,this.promise=q}function Se(x,L){var q=!1;try{x(function(_){q||(q=!0,ne(L,_))},function(_){q||(q=!0,de(L,_))})}catch(_){if(q)return;q=!0,de(L,_)}}F.prototype.catch=function(x){return this.then(null,x)},F.prototype.then=function(x,L){var q=new this.constructor(le);return K(this,new De(x,L,q)),q},F.prototype.finally=function(x){var L=this.constructor;return this.then(function(q){return L.resolve(x()).then(function(){return q})},function(q){return L.resolve(x()).then(function(){return L.reject(q)})})},F.all=function(x){return new F(function(L,q){if(!ie(x))return q(new TypeError("Promise.all accepts an array"));var _=Array.prototype.slice.call(x);if(_.length===0)return L([]);var R=_.length;function B(ce,pe){try{if(pe&&(T(pe)==="object"||typeof pe=="function")){var Ue=pe.then;if(typeof Ue=="function")return void Ue.call(pe,function(He){B(ce,He)},q)}_[ce]=pe,--R==0&&L(_)}catch(He){q(He)}}for(var X=0;X<_.length;X++)B(X,_[X])})},F.any=function(x){var L=this;return new L(function(q,_){if(!x||x.length===void 0)return _(new TypeError("Promise.any accepts an array"));var R=Array.prototype.slice.call(x);if(R.length===0)return _();for(var B=[],X=0;X<R.length;X++)try{L.resolve(R[X]).then(q).catch(function(ce){B.push(ce),B.length===R.length&&_(new V(B,"All promises were rejected"))})}catch(ce){_(ce)}})},F.allSettled=function(x){return new this(function(L,q){if(!x||x.length===void 0)return q(new TypeError(j(x)+" "+x+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var _=Array.prototype.slice.call(x);if(_.length===0)return L([]);var R=_.length;function B(ce,pe){if(pe&&(j(pe)==="object"||typeof pe=="function")){var Ue=pe.then;if(typeof Ue=="function")return void Ue.call(pe,function(He){B(ce,He)},function(He){_[ce]={status:"rejected",reason:He},--R==0&&L(_)})}_[ce]={status:"fulfilled",value:pe},--R==0&&L(_)}for(var X=0;X<_.length;X++)B(X,_[X])})},F.resolve=function(x){return x&&T(x)==="object"&&x.constructor===F?x:new F(function(L){L(x)})},F.reject=function(x){return new F(function(L,q){q(x)})},F.race=function(x){return new F(function(L,q){if(!ie(x))return q(new TypeError("Promise.race accepts an array"));for(var _=0,R=x.length;_<R;_++)F.resolve(x[_]).then(L,q)})},F._immediateFn=typeof setImmediate=="function"&&function(x){setImmediate(x)}||function(x){Z(x,0)},F._unhandledRejectionFn=function(x){typeof console!="undefined"&&console&&console.warn("Possible Unhandled Promise Rejection:",x)};const Ce=F;var Be=/mobile/i.test(window.navigator.userAgent);const ke={secondToTime:function(x){if((x=x||0)===0||x===1/0||x.toString()==="NaN")return"00:00";var L=Math.floor(x/3600),q=Math.floor((x-3600*L)/60),_=Math.floor(x-3600*L-60*q);return(L>0?[L,q,_]:[q,_]).map(function(R){return R<10?"0"+R:""+R}).join(":")},getElementViewLeft:function(x){var L=x.offsetLeft,q=x.offsetParent,_=document.body.scrollLeft+document.documentElement.scrollLeft;if(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement)for(;q!==null&&q!==x;)L+=q.offsetLeft,q=q.offsetParent;else for(;q!==null;)L+=q.offsetLeft,q=q.offsetParent;return L-_},getBoundingClientRectViewLeft:function(x){var L=window.scrollY||window.pageYOffset||document.body.scrollTop+(document.documentElement&&document.documentElement.scrollTop||0);if(x.getBoundingClientRect){if(typeof this.getBoundingClientRectViewLeft.offset!="number"){var q=document.createElement("div");q.style.cssText="position:absolute;top:0;left:0;",document.body.appendChild(q),this.getBoundingClientRectViewLeft.offset=-q.getBoundingClientRect().top-L,document.body.removeChild(q),q=null}var _=x.getBoundingClientRect(),R=this.getBoundingClientRectViewLeft.offset;return _.left+R}return this.getElementViewLeft(x)},getScrollPosition:function(){return{left:window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0,top:window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0}},setScrollPosition:function(x){var L=x.left,q=L===void 0?0:L,_=x.top,R=_===void 0?0:_;this.isFirefox?(document.documentElement.scrollLeft=q,document.documentElement.scrollTop=R):window.scrollTo(q,R)},isMobile:Be,isFirefox:/firefox/i.test(window.navigator.userAgent),isChrome:/chrome/i.test(window.navigator.userAgent),isSafari:/safari/i.test(window.navigator.userAgent),storage:{set:function(x,L){localStorage.setItem(x,L)},get:function(x){return localStorage.getItem(x)}},nameMap:{dragStart:Be?"touchstart":"mousedown",dragMove:Be?"touchmove":"mousemove",dragEnd:Be?"touchend":"mouseup"},color2Number:function(x){return x[0]==="#"&&(x=x.substr(1)),x.length===3&&(x="".concat(x[0]).concat(x[0]).concat(x[1]).concat(x[1]).concat(x[2]).concat(x[2])),parseInt(x,16)+0&16777215},number2Color:function(x){return"#"+("00000"+x.toString(16)).slice(-6)},number2Type:function(x){switch(x){case 0:default:return"right";case 1:return"top";case 2:return"bottom"}}};function Ne(x,L){return function(){return x.apply(L,arguments)}}function Re(x){return Re=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},Re(x)}var dt,wt=Object.prototype.toString,It=Object.getPrototypeOf,nt=(dt=Object.create(null),function(x){var L=wt.call(x);return dt[L]||(dt[L]=L.slice(8,-1).toLowerCase())}),ot=function(x){return x=x.toLowerCase(),function(L){return nt(L)===x}},ti=function(x){return function(L){return Re(L)===x}},bt=Array.isArray,Vt=ti("undefined"),si=ot("ArrayBuffer"),Xt=ti("string"),_i=ti("function"),yi=ti("number"),xt=function(x){return x!==null&&Re(x)==="object"},Qt=function(x){if(nt(x)!=="object")return!1;var L=It(x);return!(L!==null&&L!==Object.prototype&&Object.getPrototypeOf(L)!==null||Symbol.toStringTag in x||Symbol.iterator in x)},li=ot("Date"),Ki=ot("File"),Ji=ot("Blob"),$i=ot("FileList"),cn=ot("URLSearchParams");function sn(x,L){var q,_,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},B=R.allOwnKeys,X=B!==void 0&&B;if(x!=null)if(Re(x)!=="object"&&(x=[x]),bt(x))for(q=0,_=x.length;q<_;q++)L.call(null,x[q],q,x);else{var ce,pe=X?Object.getOwnPropertyNames(x):Object.keys(x),Ue=pe.length;for(q=0;q<Ue;q++)ce=pe[q],L.call(null,x[ce],ce,x)}}function pt(x,L){L=L.toLowerCase();for(var q,_=Object.keys(x),R=_.length;R-- >0;)if(L===(q=_[R]).toLowerCase())return q;return null}var vi,xi,oi=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:ft.g,kn=function(x){return!Vt(x)&&x!==oi},Gr=(vi=typeof Uint8Array!="undefined"&&It(Uint8Array),function(x){return vi&&x instanceof vi}),Is=ot("HTMLFormElement"),Zi=(xi=Object.prototype.hasOwnProperty,function(x,L){return xi.call(x,L)}),Tn=ot("RegExp"),Xe=function(x,L){var q=Object.getOwnPropertyDescriptors(x),_={};sn(q,function(R,B){L(R,B,x)!==!1&&(_[B]=R)}),Object.defineProperties(x,_)};const Le={isArray:bt,isArrayBuffer:si,isBuffer:function(x){return x!==null&&!Vt(x)&&x.constructor!==null&&!Vt(x.constructor)&&_i(x.constructor.isBuffer)&&x.constructor.isBuffer(x)},isFormData:function(x){var L="[object FormData]";return x&&(typeof FormData=="function"&&x instanceof FormData||wt.call(x)===L||_i(x.toString)&&x.toString()===L)},isArrayBufferView:function(x){return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?ArrayBuffer.isView(x):x&&x.buffer&&si(x.buffer)},isString:Xt,isNumber:yi,isBoolean:function(x){return x===!0||x===!1},isObject:xt,isPlainObject:Qt,isUndefined:Vt,isDate:li,isFile:Ki,isBlob:Ji,isRegExp:Tn,isFunction:_i,isStream:function(x){return xt(x)&&_i(x.pipe)},isURLSearchParams:cn,isTypedArray:Gr,isFileList:$i,forEach:sn,merge:function x(){for(var L=kn(this)&&this||{},q=L.caseless,_={},R=function(ce,pe){var Ue=q&&pt(_,pe)||pe;Qt(_[Ue])&&Qt(ce)?_[Ue]=x(_[Ue],ce):Qt(ce)?_[Ue]=x({},ce):bt(ce)?_[Ue]=ce.slice():_[Ue]=ce},B=0,X=arguments.length;B<X;B++)arguments[B]&&sn(arguments[B],R);return _},extend:function(x,L,q){var _=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},R=_.allOwnKeys;return sn(L,function(B,X){q&&_i(B)?x[X]=Ne(B,q):x[X]=B},{allOwnKeys:R}),x},trim:function(x){return x.trim?x.trim():x.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},stripBOM:function(x){return x.charCodeAt(0)===65279&&(x=x.slice(1)),x},inherits:function(x,L,q,_){x.prototype=Object.create(L.prototype,_),x.prototype.constructor=x,Object.defineProperty(x,"super",{value:L.prototype}),q&&Object.assign(x.prototype,q)},toFlatObject:function(x,L,q,_){var R,B,X,ce={};if(L=L||{},x==null)return L;do{for(B=(R=Object.getOwnPropertyNames(x)).length;B-- >0;)X=R[B],_&&!_(X,x,L)||ce[X]||(L[X]=x[X],ce[X]=!0);x=q!==!1&&It(x)}while(x&&(!q||q(x,L))&&x!==Object.prototype);return L},kindOf:nt,kindOfTest:ot,endsWith:function(x,L,q){x=String(x),(q===void 0||q>x.length)&&(q=x.length),q-=L.length;var _=x.indexOf(L,q);return _!==-1&&_===q},toArray:function(x){if(!x)return null;if(bt(x))return x;var L=x.length;if(!yi(L))return null;for(var q=new Array(L);L-- >0;)q[L]=x[L];return q},forEachEntry:function(x,L){for(var q,_=(x&&x[Symbol.iterator]).call(x);(q=_.next())&&!q.done;){var R=q.value;L.call(x,R[0],R[1])}},matchAll:function(x,L){for(var q,_=[];(q=x.exec(L))!==null;)_.push(q);return _},isHTMLForm:Is,hasOwnProperty:Zi,hasOwnProp:Zi,reduceDescriptors:Xe,freezeMethods:function(x){Xe(x,function(L,q){if(_i(x)&&["arguments","caller","callee"].indexOf(q)!==-1)return!1;var _=x[q];_i(_)&&(L.enumerable=!1,"writable"in L?L.writable=!1:L.set||(L.set=function(){throw Error("Can not rewrite read-only method '"+q+"'")}))})},toObjectSet:function(x,L){var q={},_=function(R){R.forEach(function(B){q[B]=!0})};return bt(x)?_(x):_(String(x).split(L)),q},toCamelCase:function(x){return x.toLowerCase().replace(/[_-\s]([a-z\d])(\w*)/g,function(L,q,_){return q.toUpperCase()+_})},noop:function(){},toFiniteNumber:function(x,L){return x=+x,Number.isFinite(x)?x:L},findKey:pt,global:oi,isContextDefined:kn,toJSONObject:function(x){var L=new Array(10);return function q(_,R){if(xt(_)){if(L.indexOf(_)>=0)return;if(!("toJSON"in _)){L[R]=_;var B=bt(_)?[]:{};return sn(_,function(X,ce){var pe=q(X,R+1);!Vt(pe)&&(B[ce]=pe)}),L[R]=void 0,B}}return _}(x,0)}};function ht(x,L,q,_,R){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=x,this.name="AxiosError",L&&(this.code=L),q&&(this.config=q),_&&(this.request=_),R&&(this.response=R)}Le.inherits(ht,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Le.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var Rt=ht.prototype,Lt={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(function(x){Lt[x]={value:x}}),Object.defineProperties(ht,Lt),Object.defineProperty(Rt,"isAxiosError",{value:!0}),ht.from=function(x,L,q,_,R,B){var X=Object.create(Rt);return Le.toFlatObject(x,X,function(ce){return ce!==Error.prototype},function(ce){return ce!=="isAxiosError"}),ht.call(X,x.message,L,q,_,R),X.cause=x,X.name=x.name,B&&Object.assign(X,B),X};const Tt=ht,ii=_e(937);function mn(x){return mn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},mn(x)}function Ut(x){return Le.isPlainObject(x)||Le.isArray(x)}function Bn(x){return Le.endsWith(x,"[]")?x.slice(0,-2):x}function Wn(x,L,q){return x?x.concat(L).map(function(_,R){return _=Bn(_),!q&&R?"["+_+"]":_}).join(q?".":""):L}var ai=Le.toFlatObject(Le,{},null,function(x){return/^is[A-Z]/.test(x)});const qr=function(x,L,q){if(!Le.isObject(x))throw new TypeError("target must be an object");L=L||new(ii||FormData);var _,R=(q=Le.toFlatObject(q,{metaTokens:!0,dots:!1,indexes:!1},!1,function(Dt,Et){return!Le.isUndefined(Et[Dt])})).metaTokens,B=q.visitor||He,X=q.dots,ce=q.indexes,pe=(q.Blob||typeof Blob!="undefined"&&Blob)&&(_=L)&&Le.isFunction(_.append)&&_[Symbol.toStringTag]==="FormData"&&_[Symbol.iterator];if(!Le.isFunction(B))throw new TypeError("visitor must be a function");function Ue(Dt){if(Dt===null)return"";if(Le.isDate(Dt))return Dt.toISOString();if(!pe&&Le.isBlob(Dt))throw new Tt("Blob is not supported. Use a Buffer instead.");return Le.isArrayBuffer(Dt)||Le.isTypedArray(Dt)?pe&&typeof Blob=="function"?new Blob([Dt]):lt.from(Dt):Dt}function He(Dt,Et,vt){var Bt=Dt;if(Dt&&!vt&&mn(Dt)==="object"){if(Le.endsWith(Et,"{}"))Et=R?Et:Et.slice(0,-2),Dt=JSON.stringify(Dt);else if(Le.isArray(Dt)&&function(Yt){return Le.isArray(Yt)&&!Yt.some(Ut)}(Dt)||Le.isFileList(Dt)||Le.endsWith(Et,"[]")&&(Bt=Le.toArray(Dt)))return Et=Bn(Et),Bt.forEach(function(Yt,Fi){!Le.isUndefined(Yt)&&Yt!==null&&L.append(ce===!0?Wn([Et],Fi,X):ce===null?Et:Et+"[]",Ue(Yt))}),!1}return!!Ut(Dt)||(L.append(Wn(vt,Et,X),Ue(Dt)),!1)}var yt=[],At=Object.assign(ai,{defaultVisitor:He,convertValue:Ue,isVisitable:Ut});if(!Le.isObject(x))throw new TypeError("data must be an object");return function Dt(Et,vt){if(!Le.isUndefined(Et)){if(yt.indexOf(Et)!==-1)throw Error("Circular reference detected in "+vt.join("."));yt.push(Et),Le.forEach(Et,function(Bt,Yt){(!(Le.isUndefined(Bt)||Bt===null)&&B.call(L,Bt,Le.isString(Yt)?Yt.trim():Yt,vt,At))===!0&&Dt(Bt,vt?vt.concat(Yt):[Yt])}),yt.pop()}}(x),L};function pr(x){var L={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(x).replace(/[!'()~]|%20|%00/g,function(q){return L[q]})}function Ri(x,L){this._pairs=[],x&&qr(x,this,L)}var Wr=Ri.prototype;Wr.append=function(x,L){this._pairs.push([x,L])},Wr.toString=function(x){var L=x?function(q){return x.call(this,q,pr)}:pr;return this._pairs.map(function(q){return L(q[0])+"="+L(q[1])},"").join("&")};const Rs=Ri;function mr(x){return encodeURIComponent(x).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Kr(x,L,q){if(!L)return x;var _,R=q&&q.encode||mr,B=q&&q.serialize;if(_=B?B(L,q):Le.isURLSearchParams(L)?L.toString():new Rs(L,q).toString(R)){var X=x.indexOf("#");X!==-1&&(x=x.slice(0,X)),x+=(x.indexOf("?")===-1?"?":"&")+_}return x}function Mn(x){return Mn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},Mn(x)}function ea(x,L){for(var q=0;q<L.length;q++){var _=L[q];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,(R=function(B,X){if(Mn(B)!=="object"||B===null)return B;var ce=B[Symbol.toPrimitive];if(ce!==void 0){var pe=ce.call(B,"string");if(Mn(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(B)}(_.key),Mn(R)==="symbol"?R:String(R)),_)}var R}var hn=function(){function x(){(function(_,R){if(!(_ instanceof R))throw new TypeError("Cannot call a class as a function")})(this,x),this.handlers=[]}var L,q;return L=x,q=[{key:"use",value:function(_,R,B){return this.handlers.push({fulfilled:_,rejected:R,synchronous:!!B&&B.synchronous,runWhen:B?B.runWhen:null}),this.handlers.length-1}},{key:"eject",value:function(_){this.handlers[_]&&(this.handlers[_]=null)}},{key:"clear",value:function(){this.handlers&&(this.handlers=[])}},{key:"forEach",value:function(_){Le.forEach(this.handlers,function(R){R!==null&&_(R)})}}],q&&ea(L.prototype,q),Object.defineProperty(L,"prototype",{writable:!1}),x}();const tr=hn,ho={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ee=typeof URLSearchParams!="undefined"?URLSearchParams:Rs,re=FormData;var Te,Ge=(typeof navigator=="undefined"||(Te=navigator.product)!=="ReactNative"&&Te!=="NativeScript"&&Te!=="NS")&&typeof window!="undefined"&&typeof document!="undefined",mt=typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function";const Nt={isBrowser:!0,classes:{URLSearchParams:ee,FormData:re,Blob},isStandardBrowserEnv:Ge,isStandardBrowserWebWorkerEnv:mt,protocols:["http","https","file","blob","url","data"]},Ai=function(x){function L(_,R,B,X){var ce=_[X++],pe=Number.isFinite(+ce),Ue=X>=_.length;return ce=!ce&&Le.isArray(B)?B.length:ce,Ue?(Le.hasOwnProp(B,ce)?B[ce]=[B[ce],R]:B[ce]=R,!pe):(B[ce]&&Le.isObject(B[ce])||(B[ce]=[]),L(_,R,B[ce],X)&&Le.isArray(B[ce])&&(B[ce]=function(He){var yt,At,Dt={},Et=Object.keys(He),vt=Et.length;for(yt=0;yt<vt;yt++)Dt[At=Et[yt]]=He[At];return Dt}(B[ce])),!pe)}if(Le.isFormData(x)&&Le.isFunction(x.entries)){var q={};return Le.forEachEntry(x,function(_,R){L(function(B){return Le.matchAll(/\w+|\[(\w*)]/g,B).map(function(X){return X[0]==="[]"?"":X[1]||X[0]})}(_),R,q,0)}),q}return null};var mi={"Content-Type":void 0},zi={transitional:ho,adapter:["xhr","http"],transformRequest:[function(x,L){var q,_=L.getContentType()||"",R=_.indexOf("application/json")>-1,B=Le.isObject(x);if(B&&Le.isHTMLForm(x)&&(x=new FormData(x)),Le.isFormData(x))return R&&R?JSON.stringify(Ai(x)):x;if(Le.isArrayBuffer(x)||Le.isBuffer(x)||Le.isStream(x)||Le.isFile(x)||Le.isBlob(x))return x;if(Le.isArrayBufferView(x))return x.buffer;if(Le.isURLSearchParams(x))return L.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),x.toString();if(B){if(_.indexOf("application/x-www-form-urlencoded")>-1)return function(ce,pe){return qr(ce,new Nt.classes.URLSearchParams,Object.assign({visitor:function(Ue,He,yt,At){return Nt.isNode&&Le.isBuffer(Ue)?(this.append(He,Ue.toString("base64")),!1):At.defaultVisitor.apply(this,arguments)}},pe))}(x,this.formSerializer).toString();if((q=Le.isFileList(x))||_.indexOf("multipart/form-data")>-1){var X=this.env&&this.env.FormData;return qr(q?{"files[]":x}:x,X&&new X,this.formSerializer)}}return B||R?(L.setContentType("application/json",!1),function(ce,pe,Ue){if(Le.isString(ce))try{return(0,JSON.parse)(ce),Le.trim(ce)}catch(He){if(He.name!=="SyntaxError")throw He}return(0,JSON.stringify)(ce)}(x)):x}],transformResponse:[function(x){var L=this.transitional||zi.transitional,q=L&&L.forcedJSONParsing,_=this.responseType==="json";if(x&&Le.isString(x)&&(q&&!this.responseType||_)){var R=!(L&&L.silentJSONParsing)&&_;try{return JSON.parse(x)}catch(B){if(R)throw B.name==="SyntaxError"?Tt.from(B,Tt.ERR_BAD_RESPONSE,this,null,this.response):B}}return x}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Nt.classes.FormData,Blob:Nt.classes.Blob},validateStatus:function(x){return x>=200&&x<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};Le.forEach(["delete","get","head"],function(x){zi.headers[x]={}}),Le.forEach(["post","put","patch"],function(x){zi.headers[x]=Le.merge(mi)});const gn=zi;var Dn=Le.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]);function Fn(x){return Fn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},Fn(x)}function Oi(x,L){(L==null||L>x.length)&&(L=x.length);for(var q=0,_=new Array(L);q<L;q++)_[q]=x[q];return _}function Nn(x,L){for(var q=0;q<L.length;q++){var _=L[q];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,(R=function(B,X){if(Fn(B)!=="object"||B===null)return B;var ce=B[Symbol.toPrimitive];if(ce!==void 0){var pe=ce.call(B,"string");if(Fn(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(B)}(_.key),Fn(R)==="symbol"?R:String(R)),_)}var R}var Sn=Symbol("internals");function en(x){return x&&String(x).trim().toLowerCase()}function an(x){return x===!1||x==null?x:Le.isArray(x)?x.map(an):String(x)}function wr(x,L,q,_){return Le.isFunction(_)?_.call(this,L,q):Le.isString(L)?Le.isString(_)?L.indexOf(_)!==-1:Le.isRegExp(_)?_.test(L):void 0:void 0}var Lr=function(x,L){function q(X){(function(ce,pe){if(!(ce instanceof pe))throw new TypeError("Cannot call a class as a function")})(this,q),X&&this.set(X)}var _,R,B;return _=q,R=[{key:"set",value:function(X,ce,pe){var Ue=this;function He(Yt,Fi,hi){var fi=en(Fi);if(!fi)throw new Error("header name must be a non-empty string");var sr=Le.findKey(Ue,fi);(!sr||Ue[sr]===void 0||hi===!0||hi===void 0&&Ue[sr]!==!1)&&(Ue[sr||Fi]=an(Yt))}var yt,At,Dt,Et,vt,Bt=function(Yt,Fi){return Le.forEach(Yt,function(hi,fi){return He(hi,fi,Fi)})};return Le.isPlainObject(X)||X instanceof this.constructor?Bt(X,ce):Le.isString(X)&&(X=X.trim())&&!/^[-_a-zA-Z]+$/.test(X.trim())?Bt((vt={},(yt=X)&&yt.split(`
`).forEach(function(Yt){Et=Yt.indexOf(":"),At=Yt.substring(0,Et).trim().toLowerCase(),Dt=Yt.substring(Et+1).trim(),!At||vt[At]&&Dn[At]||(At==="set-cookie"?vt[At]?vt[At].push(Dt):vt[At]=[Dt]:vt[At]=vt[At]?vt[At]+", "+Dt:Dt)}),vt),ce):X!=null&&He(ce,X,pe),this}},{key:"get",value:function(X,ce){if(X=en(X)){var pe=Le.findKey(this,X);if(pe){var Ue=this[pe];if(!ce)return Ue;if(ce===!0)return function(He){for(var yt,At=Object.create(null),Dt=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;yt=Dt.exec(He);)At[yt[1]]=yt[2];return At}(Ue);if(Le.isFunction(ce))return ce.call(this,Ue,pe);if(Le.isRegExp(ce))return ce.exec(Ue);throw new TypeError("parser must be boolean|regexp|function")}}}},{key:"has",value:function(X,ce){if(X=en(X)){var pe=Le.findKey(this,X);return!(!pe||ce&&!wr(0,this[pe],pe,ce))}return!1}},{key:"delete",value:function(X,ce){var pe=this,Ue=!1;function He(yt){if(yt=en(yt)){var At=Le.findKey(pe,yt);!At||ce&&!wr(0,pe[At],At,ce)||(delete pe[At],Ue=!0)}}return Le.isArray(X)?X.forEach(He):He(X),Ue}},{key:"clear",value:function(){return Object.keys(this).forEach(this.delete.bind(this))}},{key:"normalize",value:function(X){var ce=this,pe={};return Le.forEach(this,function(Ue,He){var yt=Le.findKey(pe,He);if(yt)return ce[yt]=an(Ue),void delete ce[He];var At=X?function(Dt){return Dt.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,function(Et,vt,Bt){return vt.toUpperCase()+Bt})}(He):String(He).trim();At!==He&&delete ce[He],ce[At]=an(Ue),pe[At]=!0}),this}},{key:"concat",value:function(){for(var X,ce=arguments.length,pe=new Array(ce),Ue=0;Ue<ce;Ue++)pe[Ue]=arguments[Ue];return(X=this.constructor).concat.apply(X,[this].concat(pe))}},{key:"toJSON",value:function(X){var ce=Object.create(null);return Le.forEach(this,function(pe,Ue){pe!=null&&pe!==!1&&(ce[Ue]=X&&Le.isArray(pe)?pe.join(", "):pe)}),ce}},{key:Symbol.iterator,value:function(){return Object.entries(this.toJSON())[Symbol.iterator]()}},{key:"toString",value:function(){return Object.entries(this.toJSON()).map(function(X){var ce,pe,Ue=(pe=2,function(He){if(Array.isArray(He))return He}(ce=X)||function(He,yt){var At=He==null?null:typeof Symbol!="undefined"&&He[Symbol.iterator]||He["@@iterator"];if(At!=null){var Dt,Et,vt,Bt,Yt=[],Fi=!0,hi=!1;try{if(vt=(At=At.call(He)).next,yt===0){if(Object(At)!==At)return;Fi=!1}else for(;!(Fi=(Dt=vt.call(At)).done)&&(Yt.push(Dt.value),Yt.length!==yt);Fi=!0);}catch(fi){hi=!0,Et=fi}finally{try{if(!Fi&&At.return!=null&&(Bt=At.return(),Object(Bt)!==Bt))return}finally{if(hi)throw Et}}return Yt}}(ce,pe)||function(He,yt){if(He){if(typeof He=="string")return Oi(He,yt);var At=Object.prototype.toString.call(He).slice(8,-1);return At==="Object"&&He.constructor&&(At=He.constructor.name),At==="Map"||At==="Set"?Array.from(He):At==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(At)?Oi(He,yt):void 0}}(ce,pe)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}());return Ue[0]+": "+Ue[1]}).join(`
`)}},{key:Symbol.toStringTag,get:function(){return"AxiosHeaders"}}],B=[{key:"from",value:function(X){return X instanceof this?X:new this(X)}},{key:"concat",value:function(X){for(var ce=new this(X),pe=arguments.length,Ue=new Array(pe>1?pe-1:0),He=1;He<pe;He++)Ue[He-1]=arguments[He];return Ue.forEach(function(yt){return ce.set(yt)}),ce}},{key:"accessor",value:function(X){var ce=(this[Sn]=this[Sn]={accessors:{}}).accessors,pe=this.prototype;function Ue(He){var yt=en(He);ce[yt]||(function(At,Dt){var Et=Le.toCamelCase(" "+Dt);["get","set","has"].forEach(function(vt){Object.defineProperty(At,vt+Et,{value:function(Bt,Yt,Fi){return this[vt].call(this,Dt,Bt,Yt,Fi)},configurable:!0})})}(pe,He),ce[yt]=!0)}return Le.isArray(X)?X.forEach(Ue):Ue(X),this}}],R&&Nn(_.prototype,R),B&&Nn(_,B),Object.defineProperty(_,"prototype",{writable:!1}),q}();Lr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent"]),Le.freezeMethods(Lr.prototype),Le.freezeMethods(Lr);const fn=Lr;function kr(x,L){var q=this||gn,_=L||q,R=fn.from(_.headers),B=_.data;return Le.forEach(x,function(X){B=X.call(q,B,R.normalize(),L?L.status:void 0)}),R.normalize(),B}function La(x){return!(!x||!x.__CANCEL__)}function ka(x,L,q){Tt.call(this,x==null?"canceled":x,Tt.ERR_CANCELED,L,q),this.name="CanceledError"}Le.inherits(ka,Tt,{__CANCEL__:!0});const ta=ka,fo=Nt.isStandardBrowserEnv?{write:function(x,L,q,_,R,B){var X=[];X.push(x+"="+encodeURIComponent(L)),Le.isNumber(q)&&X.push("expires="+new Date(q).toGMTString()),Le.isString(_)&&X.push("path="+_),Le.isString(R)&&X.push("domain="+R),B===!0&&X.push("secure"),document.cookie=X.join("; ")},read:function(x){var L=document.cookie.match(new RegExp("(^|;\\s*)("+x+")=([^;]*)"));return L?decodeURIComponent(L[3]):null},remove:function(x){this.write(x,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}};function po(x,L){return x&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(L)?function(q,_){return _?q.replace(/\/+$/,"")+"/"+_.replace(/^\/+/,""):q}(x,L):L}const Kn=Nt.isStandardBrowserEnv?function(){var x,L=/(msie|trident)/i.test(navigator.userAgent),q=document.createElement("a");function _(R){var B=R;return L&&(q.setAttribute("href",B),B=q.href),q.setAttribute("href",B),{href:q.href,protocol:q.protocol?q.protocol.replace(/:$/,""):"",host:q.host,search:q.search?q.search.replace(/^\?/,""):"",hash:q.hash?q.hash.replace(/^#/,""):"",hostname:q.hostname,port:q.port,pathname:q.pathname.charAt(0)==="/"?q.pathname:"/"+q.pathname}}return x=_(window.location.href),function(R){var B=Le.isString(R)?_(R):R;return B.protocol===x.protocol&&B.host===x.host}}():function(){return!0};function Da(x,L){var q=0,_=function(R,B){R=R||10;var X,ce=new Array(R),pe=new Array(R),Ue=0,He=0;return B=B!==void 0?B:1e3,function(yt){var At=Date.now(),Dt=pe[He];X||(X=At),ce[Ue]=yt,pe[Ue]=At;for(var Et=He,vt=0;Et!==Ue;)vt+=ce[Et++],Et%=R;if((Ue=(Ue+1)%R)===He&&(He=(He+1)%R),!(At-X<B)){var Bt=Dt&&At-Dt;return Bt?Math.round(1e3*vt/Bt):void 0}}}(50,250);return function(R){var B=R.loaded,X=R.lengthComputable?R.total:void 0,ce=B-q,pe=_(ce);q=B;var Ue={loaded:B,total:X,progress:X?B/X:void 0,bytes:ce,rate:pe||void 0,estimated:pe&&X&&B<=X?(X-B)/pe:void 0,event:R};Ue[L?"download":"upload"]=!0,x(Ue)}}const Ia=typeof XMLHttpRequest!="undefined"&&function(x){return new Promise(function(L,q){var _,R=x.data,B=fn.from(x.headers).normalize(),X=x.responseType;function ce(){x.cancelToken&&x.cancelToken.unsubscribe(_),x.signal&&x.signal.removeEventListener("abort",_)}Le.isFormData(R)&&(Nt.isStandardBrowserEnv||Nt.isStandardBrowserWebWorkerEnv)&&B.setContentType(!1);var pe=new XMLHttpRequest;if(x.auth){var Ue=x.auth.username||"",He=x.auth.password?unescape(encodeURIComponent(x.auth.password)):"";B.set("Authorization","Basic "+btoa(Ue+":"+He))}var yt=po(x.baseURL,x.url);function At(){if(pe){var Bt=fn.from("getAllResponseHeaders"in pe&&pe.getAllResponseHeaders());(function(Yt,Fi,hi){var fi=hi.config.validateStatus;hi.status&&fi&&!fi(hi.status)?Fi(new Tt("Request failed with status code "+hi.status,[Tt.ERR_BAD_REQUEST,Tt.ERR_BAD_RESPONSE][Math.floor(hi.status/100)-4],hi.config,hi.request,hi)):Yt(hi)})(function(Yt){L(Yt),ce()},function(Yt){q(Yt),ce()},{data:X&&X!=="text"&&X!=="json"?pe.response:pe.responseText,status:pe.status,statusText:pe.statusText,headers:Bt,config:x,request:pe}),pe=null}}if(pe.open(x.method.toUpperCase(),Kr(yt,x.params,x.paramsSerializer),!0),pe.timeout=x.timeout,"onloadend"in pe?pe.onloadend=At:pe.onreadystatechange=function(){pe&&pe.readyState===4&&(pe.status!==0||pe.responseURL&&pe.responseURL.indexOf("file:")===0)&&setTimeout(At)},pe.onabort=function(){pe&&(q(new Tt("Request aborted",Tt.ECONNABORTED,x,pe)),pe=null)},pe.onerror=function(){q(new Tt("Network Error",Tt.ERR_NETWORK,x,pe)),pe=null},pe.ontimeout=function(){var Bt=x.timeout?"timeout of "+x.timeout+"ms exceeded":"timeout exceeded",Yt=x.transitional||ho;x.timeoutErrorMessage&&(Bt=x.timeoutErrorMessage),q(new Tt(Bt,Yt.clarifyTimeoutError?Tt.ETIMEDOUT:Tt.ECONNABORTED,x,pe)),pe=null},Nt.isStandardBrowserEnv){var Dt=(x.withCredentials||Kn(yt))&&x.xsrfCookieName&&fo.read(x.xsrfCookieName);Dt&&B.set(x.xsrfHeaderName,Dt)}R===void 0&&B.setContentType(null),"setRequestHeader"in pe&&Le.forEach(B.toJSON(),function(Bt,Yt){pe.setRequestHeader(Yt,Bt)}),Le.isUndefined(x.withCredentials)||(pe.withCredentials=!!x.withCredentials),X&&X!=="json"&&(pe.responseType=x.responseType),typeof x.onDownloadProgress=="function"&&pe.addEventListener("progress",Da(x.onDownloadProgress,!0)),typeof x.onUploadProgress=="function"&&pe.upload&&pe.upload.addEventListener("progress",Da(x.onUploadProgress)),(x.cancelToken||x.signal)&&(_=function(Bt){pe&&(q(!Bt||Bt.type?new ta(null,x,pe):Bt),pe.abort(),pe=null)},x.cancelToken&&x.cancelToken.subscribe(_),x.signal&&(x.signal.aborted?_():x.signal.addEventListener("abort",_)));var Et,vt=(Et=/^([-+\w]{1,25})(:?\/\/|:)/.exec(yt))&&Et[1]||"";vt&&Nt.protocols.indexOf(vt)===-1?q(new Tt("Unsupported protocol "+vt+":",Tt.ERR_BAD_REQUEST,x)):pe.send(R||null)})};var Ra={http:null,xhr:Ia};Le.forEach(Ra,function(x,L){if(x){try{Object.defineProperty(x,"name",{value:L})}catch(q){}Object.defineProperty(x,"adapterName",{value:L})}});function ia(x){if(x.cancelToken&&x.cancelToken.throwIfRequested(),x.signal&&x.signal.aborted)throw new ta(null,x)}function Oa(x){return ia(x),x.headers=fn.from(x.headers),x.data=kr.call(x,x.transformRequest),["post","put","patch"].indexOf(x.method)!==-1&&x.headers.setContentType("application/x-www-form-urlencoded",!1),function(L){for(var q,_,R=(L=Le.isArray(L)?L:[L]).length,B=0;B<R&&(q=L[B],!(_=Le.isString(q)?Ra[q.toLowerCase()]:q));B++);if(!_)throw _===!1?new Tt("Adapter ".concat(q," is not supported by the environment"),"ERR_NOT_SUPPORT"):new Error(Le.hasOwnProp(Ra,q)?"Adapter '".concat(q,"' is not available in the build"):"Unknown adapter '".concat(q,"'"));if(!Le.isFunction(_))throw new TypeError("adapter is not a function");return _}(x.adapter||gn.adapter)(x).then(function(L){return ia(x),L.data=kr.call(x,x.transformResponse,L),L.headers=fn.from(L.headers),L},function(L){return La(L)||(ia(x),L&&L.response&&(L.response.data=kr.call(x,x.transformResponse,L.response),L.response.headers=fn.from(L.response.headers))),Promise.reject(L)})}var Pa=function(x){return x instanceof fn?x.toJSON():x};function zr(x,L){L=L||{};var q={};function _(Ue,He,yt){return Le.isPlainObject(Ue)&&Le.isPlainObject(He)?Le.merge.call({caseless:yt},Ue,He):Le.isPlainObject(He)?Le.merge({},He):Le.isArray(He)?He.slice():He}function R(Ue,He,yt){return Le.isUndefined(He)?Le.isUndefined(Ue)?void 0:_(void 0,Ue,yt):_(Ue,He,yt)}function B(Ue,He){if(!Le.isUndefined(He))return _(void 0,He)}function X(Ue,He){return Le.isUndefined(He)?Le.isUndefined(Ue)?void 0:_(void 0,Ue):_(void 0,He)}function ce(Ue,He,yt){return yt in L?_(Ue,He):yt in x?_(void 0,Ue):void 0}var pe={url:B,method:B,data:B,baseURL:X,transformRequest:X,transformResponse:X,paramsSerializer:X,timeout:X,timeoutMessage:X,withCredentials:X,adapter:X,responseType:X,xsrfCookieName:X,xsrfHeaderName:X,onUploadProgress:X,onDownloadProgress:X,decompress:X,maxContentLength:X,maxBodyLength:X,beforeRedirect:X,transport:X,httpAgent:X,httpsAgent:X,cancelToken:X,socketPath:X,responseEncoding:X,validateStatus:ce,headers:function(Ue,He){return R(Pa(Ue),Pa(He),!0)}};return Le.forEach(Object.keys(x).concat(Object.keys(L)),function(Ue){var He=pe[Ue]||R,yt=He(x[Ue],L[Ue],Ue);Le.isUndefined(yt)&&He!==ce||(q[Ue]=yt)}),q}function fs(x){return fs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},fs(x)}var ui={};["object","boolean","number","function","string","symbol"].forEach(function(x,L){ui[x]=function(q){return fs(q)===x||"a"+(L<1?"n ":" ")+x}});var Gt={};ui.transitional=function(x,L,q){function _(R,B){return"[Axios v1.2.3] Transitional option '"+R+"'"+B+(q?". "+q:"")}return function(R,B,X){if(x===!1)throw new Tt(_(B," has been removed"+(L?" in "+L:"")),Tt.ERR_DEPRECATED);return L&&!Gt[B]&&(Gt[B]=!0,console.warn(_(B," has been deprecated since v"+L+" and will be removed in the near future"))),!x||x(R,B,X)}};const na={assertOptions:function(x,L,q){if(fs(x)!=="object")throw new Tt("options must be an object",Tt.ERR_BAD_OPTION_VALUE);for(var _=Object.keys(x),R=_.length;R-- >0;){var B=_[R],X=L[B];if(X){var ce=x[B],pe=ce===void 0||X(ce,B,x);if(pe!==!0)throw new Tt("option "+B+" must be "+pe,Tt.ERR_BAD_OPTION_VALUE)}else if(q!==!0)throw new Tt("Unknown option "+B,Tt.ERR_BAD_OPTION)}},validators:ui};function Yr(x){return Yr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},Yr(x)}function nl(x,L){for(var q=0;q<L.length;q++){var _=L[q];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,(R=function(B,X){if(Yr(B)!=="object"||B===null)return B;var ce=B[Symbol.toPrimitive];if(ce!==void 0){var pe=ce.call(B,"string");if(Yr(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(B)}(_.key),Yr(R)==="symbol"?R:String(R)),_)}var R}var gr=na.validators,bi=function(){function x(_){(function(R,B){if(!(R instanceof B))throw new TypeError("Cannot call a class as a function")})(this,x),this.defaults=_,this.interceptors={request:new tr,response:new tr}}var L,q;return L=x,(q=[{key:"request",value:function(_,R){typeof _=="string"?(R=R||{}).url=_:R=_||{};var B,X=R=zr(this.defaults,R),ce=X.transitional,pe=X.paramsSerializer,Ue=X.headers;ce!==void 0&&na.assertOptions(ce,{silentJSONParsing:gr.transitional(gr.boolean),forcedJSONParsing:gr.transitional(gr.boolean),clarifyTimeoutError:gr.transitional(gr.boolean)},!1),pe!==void 0&&na.assertOptions(pe,{encode:gr.function,serialize:gr.function},!0),R.method=(R.method||this.defaults.method||"get").toLowerCase(),(B=Ue&&Le.merge(Ue.common,Ue[R.method]))&&Le.forEach(["delete","get","head","post","put","patch","common"],function(fi){delete Ue[fi]}),R.headers=fn.concat(B,Ue);var He=[],yt=!0;this.interceptors.request.forEach(function(fi){typeof fi.runWhen=="function"&&fi.runWhen(R)===!1||(yt=yt&&fi.synchronous,He.unshift(fi.fulfilled,fi.rejected))});var At,Dt=[];this.interceptors.response.forEach(function(fi){Dt.push(fi.fulfilled,fi.rejected)});var Et,vt=0;if(!yt){var Bt=[Oa.bind(this),void 0];for(Bt.unshift.apply(Bt,He),Bt.push.apply(Bt,Dt),Et=Bt.length,At=Promise.resolve(R);vt<Et;)At=At.then(Bt[vt++],Bt[vt++]);return At}Et=He.length;var Yt=R;for(vt=0;vt<Et;){var Fi=He[vt++],hi=He[vt++];try{Yt=Fi(Yt)}catch(fi){hi.call(this,fi);break}}try{At=Oa.call(this,Yt)}catch(fi){return Promise.reject(fi)}for(vt=0,Et=Dt.length;vt<Et;)At=At.then(Dt[vt++],Dt[vt++]);return At}},{key:"getUri",value:function(_){return Kr(po((_=zr(this.defaults,_)).baseURL,_.url),_.params,_.paramsSerializer)}}])&&nl(L.prototype,q),Object.defineProperty(L,"prototype",{writable:!1}),x}();Le.forEach(["delete","get","head","options"],function(x){bi.prototype[x]=function(L,q){return this.request(zr(q||{},{method:x,url:L,data:(q||{}).data}))}}),Le.forEach(["post","put","patch"],function(x){function L(q){return function(_,R,B){return this.request(zr(B||{},{method:x,headers:q?{"Content-Type":"multipart/form-data"}:{},url:_,data:R}))}}bi.prototype[x]=L(),bi.prototype[x+"Form"]=L(!0)});const In=bi;function Xr(x){return Xr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},Xr(x)}function Qr(x,L){for(var q=0;q<L.length;q++){var _=L[q];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,(R=function(B,X){if(Xr(B)!=="object"||B===null)return B;var ce=B[Symbol.toPrimitive];if(ce!==void 0){var pe=ce.call(B,"string");if(Xr(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(B)}(_.key),Xr(R)==="symbol"?R:String(R)),_)}var R}var rl=function(){function x(R){if(function(ce,pe){if(!(ce instanceof pe))throw new TypeError("Cannot call a class as a function")}(this,x),typeof R!="function")throw new TypeError("executor must be a function.");var B;this.promise=new Promise(function(ce){B=ce});var X=this;this.promise.then(function(ce){if(X._listeners){for(var pe=X._listeners.length;pe-- >0;)X._listeners[pe](ce);X._listeners=null}}),this.promise.then=function(ce){var pe,Ue=new Promise(function(He){X.subscribe(He),pe=He}).then(ce);return Ue.cancel=function(){X.unsubscribe(pe)},Ue},R(function(ce,pe,Ue){X.reason||(X.reason=new ta(ce,pe,Ue),B(X.reason))})}var L,q,_;return L=x,q=[{key:"throwIfRequested",value:function(){if(this.reason)throw this.reason}},{key:"subscribe",value:function(R){this.reason?R(this.reason):this._listeners?this._listeners.push(R):this._listeners=[R]}},{key:"unsubscribe",value:function(R){if(this._listeners){var B=this._listeners.indexOf(R);B!==-1&&this._listeners.splice(B,1)}}}],_=[{key:"source",value:function(){var R;return{token:new x(function(B){R=B}),cancel:R}}}],q&&Qr(L.prototype,q),_&&Qr(L,_),Object.defineProperty(L,"prototype",{writable:!1}),x}();const Un=rl;function Vi(x,L){(L==null||L>x.length)&&(L=x.length);for(var q=0,_=new Array(L);q<L;q++)_[q]=x[q];return _}var Os={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Os).forEach(function(x){var L,q,_=(q=2,function(X){if(Array.isArray(X))return X}(L=x)||function(X,ce){var pe=X==null?null:typeof Symbol!="undefined"&&X[Symbol.iterator]||X["@@iterator"];if(pe!=null){var Ue,He,yt,At,Dt=[],Et=!0,vt=!1;try{if(yt=(pe=pe.call(X)).next,ce===0){if(Object(pe)!==pe)return;Et=!1}else for(;!(Et=(Ue=yt.call(pe)).done)&&(Dt.push(Ue.value),Dt.length!==ce);Et=!0);}catch(Bt){vt=!0,He=Bt}finally{try{if(!Et&&pe.return!=null&&(At=pe.return(),Object(At)!==At))return}finally{if(vt)throw He}}return Dt}}(L,q)||function(X,ce){if(X){if(typeof X=="string")return Vi(X,ce);var pe=Object.prototype.toString.call(X).slice(8,-1);return pe==="Object"&&X.constructor&&(pe=X.constructor.name),pe==="Map"||pe==="Set"?Array.from(X):pe==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(pe)?Vi(X,ce):void 0}}(L,q)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()),R=_[0],B=_[1];Os[B]=R});const Ps=Os;var Di=function x(L){var q=new In(L),_=Ne(In.prototype.request,q);return Le.extend(_,In.prototype,q,{allOwnKeys:!0}),Le.extend(_,q,null,{allOwnKeys:!0}),_.create=function(R){return x(zr(L,R))},_}(gn);Di.Axios=In,Di.CanceledError=ta,Di.CancelToken=Un,Di.isCancel=La,Di.VERSION="1.2.3",Di.toFormData=qr,Di.AxiosError=Tt,Di.Cancel=Di.CanceledError,Di.all=function(x){return Promise.all(x)},Di.spread=function(x){return function(L){return x.apply(null,L)}},Di.isAxiosError=function(x){return Le.isObject(x)&&x.isAxiosError===!0},Di.mergeConfig=zr,Di.AxiosHeaders=fn,Di.formToJSON=function(x){return Ai(Le.isHTMLForm(x)?new FormData(x):x)},Di.HttpStatusCode=Ps,Di.default=Di;const ra=Di,sl={send:function(x){ra.post(x.url,x.data).then(function(L){var q=L.data;q&&q.code===0?x.success&&x.success(q):x.error&&x.error(q&&q.msg)}).catch(function(L){console.error(L),x.error&&x.error()})},read:function(x){ra.get(x.url).then(function(L){var q=L.data;q&&q.code===0?x.success&&x.success(q.data.map(function(_){return{time:_[0],type:_[1],color:_[2],author:_[3],text:_[4]}})):x.error&&x.error(q&&q.msg)}).catch(function(L){console.error(L),x.error&&x.error()})}};function Ba(x){return Ba=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},Ba(x)}function al(x){var L=this;this.lang=x,this.fallbackLang=this.lang.includes("-")?this.lang.split("-")[0]:this.lang,this.tran=function(q){return q=q.toLowerCase(),ir[L.lang]&&ir[L.lang][q]?ir[L.lang][q]:ir[L.fallbackLang]&&ir[L.fallbackLang][q]?ir[L.fallbackLang][q]:Bs[q]?Bs[q]:q}}var Bs={"danmaku-loading":"Danmaku is loading",top:"Top",bottom:"Bottom",rolling:"Rolling","input-danmaku-enter":"Input danmaku, hit Enter","about-author":"About author","dplayer-feedback":"DPlayer feedback","about-dplayer":"About DPlayer",loop:"Loop",speed:"Speed","opacity-danmaku":"Opacity for danmaku",normal:"Normal","please-input-danmaku":"Please input danmaku content!","set-danmaku-color":"Set danmaku color","set-danmaku-type":"Set danmaku type","show-danmaku":"Show danmaku","video-failed":"Video load failed","danmaku-failed":"Danmaku load failed","danmaku-send-failed":"Danmaku send failed","switching-quality":"Switching to %q quality","switched-quality":"Switched to %q quality",ff:"FF %s s",rew:"REW %s s","unlimited-danmaku":"Unlimited danmaku","send-danmaku":"Send danmaku",setting:"Setting",fullscreen:"Full screen","web-fullscreen":"Web full screen",send:"Send",screenshot:"Screenshot",airplay:"AirPlay",chromecast:"ChromeCast",subtitle:"Subtitle",off:"Off","show-subs":"Show subtitle","hide-subs":"Hide subtitle",volume:"Volume",live:"Live","video-info":"Video info"},ir={en:Bs,"zh-cn":{"danmaku-loading":"\u5F39\u5E55\u52A0\u8F7D\u4E2D",top:"\u9876\u90E8",bottom:"\u5E95\u90E8",rolling:"\u6EDA\u52A8","input-danmaku-enter":"\u8F93\u5165\u5F39\u5E55\uFF0C\u56DE\u8F66\u53D1\u9001","about-author":"\u5173\u4E8E\u4F5C\u8005","dplayer-feedback":"\u64AD\u653E\u5668\u610F\u89C1\u53CD\u9988","about-dplayer":"\u5173\u4E8E DPlayer \u64AD\u653E\u5668",loop:"\u6D17\u8111\u5FAA\u73AF",speed:"\u901F\u5EA6","opacity-danmaku":"\u5F39\u5E55\u900F\u660E\u5EA6",normal:"\u6B63\u5E38","please-input-danmaku":"\u8981\u8F93\u5165\u5F39\u5E55\u5185\u5BB9\u554A\u5582\uFF01","set-danmaku-color":"\u8BBE\u7F6E\u5F39\u5E55\u989C\u8272","set-danmaku-type":"\u8BBE\u7F6E\u5F39\u5E55\u7C7B\u578B","show-danmaku":"\u663E\u793A\u5F39\u5E55","video-failed":"\u89C6\u9891\u52A0\u8F7D\u5931\u8D25","danmaku-failed":"\u5F39\u5E55\u52A0\u8F7D\u5931\u8D25","danmaku-send-failed":"\u5F39\u5E55\u53D1\u9001\u5931\u8D25","switching-quality":"\u6B63\u5728\u5207\u6362\u81F3 %q \u753B\u8D28","switched-quality":"\u5DF2\u7ECF\u5207\u6362\u81F3 %q \u753B\u8D28",ff:"\u5FEB\u8FDB %s \u79D2",rew:"\u5FEB\u9000 %s \u79D2","unlimited-danmaku":"\u6D77\u91CF\u5F39\u5E55","send-danmaku":"\u53D1\u9001\u5F39\u5E55",setting:"\u8BBE\u7F6E",fullscreen:"\u5168\u5C4F","web-fullscreen":"\u9875\u9762\u5168\u5C4F",send:"\u53D1\u9001",screenshot:"\u622A\u56FE",airplay:"\u65E0\u7EBF\u6295\u5C4F",chromecast:"ChromeCast",subtitle:"\u5B57\u5E55",off:"\u5173\u95ED","show-subs":"\u663E\u793A\u5B57\u5E55","hide-subs":"\u9690\u85CF\u5B57\u5E55",volume:"\u97F3\u91CF",live:"\u76F4\u64AD","video-info":"\u89C6\u9891\u7EDF\u8BA1\u4FE1\u606F"},"zh-tw":{"danmaku-loading":"\u5F48\u5E55\u8F09\u5165\u4E2D",top:"\u9802\u90E8",bottom:"\u5E95\u90E8",rolling:"\u6EFE\u52D5","input-danmaku-enter":"\u8F38\u5165\u5F48\u5E55\uFF0CEnter \u767C\u9001","about-author":"\u95DC\u65BC\u4F5C\u8005","dplayer-feedback":"\u64AD\u653E\u5668\u610F\u898B\u56DE\u994B","about-dplayer":"\u95DC\u65BC DPlayer \u64AD\u653E\u5668",loop:"\u5FAA\u74B0\u64AD\u653E",speed:"\u901F\u5EA6","opacity-danmaku":"\u5F48\u5E55\u900F\u660E\u5EA6",normal:"\u6B63\u5E38","please-input-danmaku":"\u8ACB\u8F38\u5165\u5F48\u5E55\u5167\u5BB9\u554A\uFF01","set-danmaku-color":"\u8A2D\u5B9A\u5F48\u5E55\u984F\u8272","set-danmaku-type":"\u8A2D\u5B9A\u5F48\u5E55\u985E\u578B","show-danmaku":"\u986F\u793A\u5F48\u5E55","video-failed":"\u5F71\u7247\u8F09\u5165\u5931\u6557","danmaku-failed":"\u5F48\u5E55\u8F09\u5165\u5931\u6557","danmaku-send-failed":"\u5F48\u5E55\u767C\u9001\u5931\u6557","switching-quality":"\u6B63\u5728\u5207\u63DB\u81F3 %q \u756B\u8CEA","switched-quality":"\u5DF2\u7D93\u5207\u63DB\u81F3 %q \u756B\u8CEA",ff:"\u5FEB\u9032 %s \u79D2",rew:"\u5FEB\u9000 %s \u79D2","unlimited-danmaku":"\u5DE8\u91CF\u5F48\u5E55","send-danmaku":"\u767C\u9001\u5F48\u5E55",setting:"\u8A2D\u5B9A",fullscreen:"\u5168\u87A2\u5E55","web-fullscreen":"\u9801\u9762\u5168\u87A2\u5E55",send:"\u767C\u9001",screenshot:"\u622A\u5716",airplay:"\u7121\u7DDA\u6295\u5C4F",chromecast:"ChromeCast",subtitle:"\u5B57\u5E55",off:"\u95DC\u9589","show-subs":"\u986F\u793A\u5B57\u5E55","hide-subs":"\u96B1\u85CF\u5B57\u5E55",volume:"\u97F3\u91CF",live:"\u76F4\u64AD","video-info":"\u5F71\u7247\u7D71\u8A08\u8A0A\u606F"},"ko-kr":{"danmaku-loading":"Danmaku\uB97C \uBD88\uB7EC\uC624\uB294 \uC911\uC785\uB2C8\uB2E4.",top:"Top",bottom:"Bottom",rolling:"Rolling","input-danmaku-enter":"Danmaku\uB97C \uC785\uB825\uD558\uACE0 Enter\uB97C \uB204\uB974\uC138\uC694.","about-author":"\uB9CC\uB4E0\uC774","dplayer-feedback":"\uD53C\uB4DC\uBC31 \uBCF4\uB0B4\uAE30","about-dplayer":"DPlayer \uC815\uBCF4",loop:"\uBC18\uBCF5",speed:"\uBC30\uC18D","opacity-danmaku":"Danmaku \uBD88\uD22C\uBA85\uB3C4",normal:"\uD45C\uC900","please-input-danmaku":"Danmaku\uB97C \uC785\uB825\uD558\uC138\uC694!","set-danmaku-color":"Danmaku \uC0C9\uC0C1","set-danmaku-type":"Danmaku \uC124\uC815","show-danmaku":"Danmaku \uD45C\uC2DC","video-failed":"\uBE44\uB514\uC624\uB97C \uBD88\uB7EC\uC624\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4.","danmaku-failed":"Danmaku\uB97C \uBD88\uB7EC\uC624\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4.","danmaku-send-failed":"Danmaku \uC804\uC1A1\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.","Switching to":"","Switched to":"","switching-quality":"\uC804\uD658 %q \uD654\uC9C8","switched-quality":"\uC804\uD658 \uB428 %q \uD654\uC9C8",ff:"\uC55E\uC73C\uB85C %s \uCD08",rew:"\uB4A4\uB85C %s \uCD08","unlimited-danmaku":"\uB05D\uC5C6\uB294 Danmaku","send-danmaku":"Danmaku \uBCF4\uB0B4\uAE30",setting:"\uC124\uC815",fullscreen:"\uC804\uCCB4 \uD654\uBA74","web-fullscreen":"\uC6F9 \uB0B4 \uC804\uCCB4\uD654\uBA74",send:"\uBCF4\uB0B4\uAE30",screenshot:"\uD654\uBA74 \uCEA1\uCCD0",airplay:"\uC5D0\uC5B4\uD50C\uB808\uC774",chromecast:"ChromeCast",subtitle:"\uBD80\uC81C",off:"\uB044\uB2E4","show-subs":"\uC790\uB9C9 \uBCF4\uC774\uAE30","hide-subs":"\uC790\uB9C9 \uC228\uAE30\uAE30",Volume:"\uBCFC\uB968",live:"\uC0DD\uBC29\uC1A1","video-info":"\uBE44\uB514\uC624 \uC815\uBCF4"},de:{"danmaku-loading":"Danmaku l\xE4dt...",top:"Oben",bottom:"Unten",rolling:"Rollend","input-danmaku-enter":"Dr\xFCcke Enter nach dem Einf\xFCgen vom Danmaku","about-author":"\xDCber den Autor","dplayer-feedback":"DPlayer Feedback","about-dplayer":"\xDCber DPlayer",loop:"Wiederholen",speed:"Geschwindigkeit","opacity-danmaku":"Transparenz f\xFCr Danmaku",normal:"Normal","please-input-danmaku":"Bitte Danmaku Inhalt eingeben!","set-danmaku-color":"Danmaku Farbe festlegen","set-danmaku-type":"Danmaku Typ festlegen","show-danmaku":"Zeige Danmaku","video-failed":"Das Video konnte nicht geladen werden","danmaku-failed":"Danmaku konnte nicht geladen werden","danmaku-send-failed":"Das senden von Danmaku ist fehgeschlagen","switching-quality":"Wechsle zur %q Qualit\xE4t","switched-quality":"Zur %q Qualit\xE4t gewechselt",ff:"%s s Vorw\xE4rts",rew:"%s s Zur\xFCck","unlimited-danmaku":"Unlimitiertes Danmaku","send-danmaku":"Sende Danmaku",setting:"Einstellungen",fullscreen:"Vollbild","web-fullscreen":"Browser Vollbild",send:"Senden",screenshot:"Screenshot",airplay:"AirPlay","show-subs":"Zeige Untertitel",chromecast:"ChromeCast",subtitle:"Untertitel",off:"Schlie\xDFung","hide-subs":"Verstecke Untertitel",volume:"Lautst\xE4rke",live:"Live","video-info":"Video Info"}},ol=_e(730),mo=_e.n(ol),Ms=_e(74),sa=_e.n(Ms),go=_e(437),fu=_e.n(go),ll=_e(644),ul=_e.n(ll),dl=_e(324),yo=_e.n(dl),Ma=_e(574),cl=_e.n(Ma),Fs=_e(300),hl=_e.n(Fs),fl=_e(934),Fa=_e.n(fl),pl=_e(428),vo=_e.n(pl),ml=_e(807),ps=_e.n(ml),gl=_e(338),aa=_e.n(gl),Na=_e(254),tn=_e.n(Na),Dr=_e(965),Ns=_e.n(Dr),yl=_e(113),vl=_e.n(yl),yn=_e(251),zn=_e.n(yn),Ci=_e(410),Ua=_e.n(Ci),ja=_e(182),yr=_e.n(ja),Ao=_e(193),oa=_e.n(Ao);const jn={play:mo(),pause:sa(),volumeUp:fu(),volumeDown:ul(),volumeOff:yo(),full:cl(),fullWeb:hl(),setting:Fa(),right:vo(),comment:ps(),commentOff:aa(),send:tn(),pallette:Ns(),camera:vl(),subtitle:Ua(),loading:yr(),airplay:zn(),chromecast:oa()};var ei=_e(916),Al=_e.n(ei);function Ir(x){return Ir=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},Ir(x)}function Jr(x,L){for(var q=0;q<L.length;q++){var _=L[q];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,(R=function(B,X){if(Ir(B)!=="object"||B===null)return B;var ce=B[Symbol.toPrimitive];if(ce!==void 0){var pe=ce.call(B,"string");if(Ir(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(B)}(_.key),Ir(R)==="symbol"?R:String(R)),_)}var R}var bl=function(){function x(R){(function(B,X){if(!(B instanceof X))throw new TypeError("Cannot call a class as a function")})(this,x),this.container=R.container,this.options=R.options,this.index=R.index,this.tran=R.tran,this.init()}var L,q,_;return L=x,_=[{key:"NewNotice",value:function(R,B,X){var ce=document.createElement("div");return ce.classList.add("dplayer-notice"),ce.style.opacity=B,ce.innerText=R,X&&(ce.id="dplayer-notice-".concat(X)),ce}}],(q=[{key:"init",value:function(){this.container.innerHTML=Al()({options:this.options,index:this.index,tran:this.tran,icons:jn,mobile:ke.isMobile,video:{current:!0,pic:this.options.video.pic,screenshot:this.options.screenshot,airplay:!(!ke.isSafari||ke.isChrome)&&this.options.airplay,chromecast:this.options.chromecast,preload:this.options.preload,url:this.options.video.url,subtitle:this.options.subtitle}}),this.volumeBar=this.container.querySelector(".dplayer-volume-bar-inner"),this.volumeBarWrap=this.container.querySelector(".dplayer-volume-bar"),this.volumeBarWrapWrap=this.container.querySelector(".dplayer-volume-bar-wrap"),this.volumeButton=this.container.querySelector(".dplayer-volume"),this.volumeButtonIcon=this.container.querySelector(".dplayer-volume-icon"),this.volumeIcon=this.container.querySelector(".dplayer-volume-icon .dplayer-icon-content"),this.playedBar=this.container.querySelector(".dplayer-played"),this.loadedBar=this.container.querySelector(".dplayer-loaded"),this.playedBarWrap=this.container.querySelector(".dplayer-bar-wrap"),this.playedBarTime=this.container.querySelector(".dplayer-bar-time"),this.danmaku=this.container.querySelector(".dplayer-danmaku"),this.danmakuLoading=this.container.querySelector(".dplayer-danloading"),this.video=this.container.querySelector(".dplayer-video-current"),this.bezel=this.container.querySelector(".dplayer-bezel-icon"),this.playButton=this.container.querySelector(".dplayer-play-icon"),this.mobilePlayButton=this.container.querySelector(".dplayer-mobile-play"),this.videoWrap=this.container.querySelector(".dplayer-video-wrap"),this.controllerMask=this.container.querySelector(".dplayer-controller-mask"),this.ptime=this.container.querySelector(".dplayer-ptime"),this.settingButton=this.container.querySelector(".dplayer-setting-icon"),this.settingBox=this.container.querySelector(".dplayer-setting-box"),this.mask=this.container.querySelector(".dplayer-mask"),this.loop=this.container.querySelector(".dplayer-setting-loop"),this.loopToggle=this.container.querySelector(".dplayer-setting-loop .dplayer-toggle-setting-input"),this.showDanmaku=this.container.querySelector(".dplayer-setting-showdan"),this.showDanmakuToggle=this.container.querySelector(".dplayer-showdan-setting-input"),this.unlimitDanmaku=this.container.querySelector(".dplayer-setting-danunlimit"),this.unlimitDanmakuToggle=this.container.querySelector(".dplayer-danunlimit-setting-input"),this.speed=this.container.querySelector(".dplayer-setting-speed"),this.speedItem=this.container.querySelectorAll(".dplayer-setting-speed-item"),this.danmakuOpacityBar=this.container.querySelector(".dplayer-danmaku-bar-inner"),this.danmakuOpacityBarWrap=this.container.querySelector(".dplayer-danmaku-bar"),this.danmakuOpacityBarWrapWrap=this.container.querySelector(".dplayer-danmaku-bar-wrap"),this.danmakuOpacityBox=this.container.querySelector(".dplayer-setting-danmaku"),this.dtime=this.container.querySelector(".dplayer-dtime"),this.controller=this.container.querySelector(".dplayer-controller"),this.commentInput=this.container.querySelector(".dplayer-comment-input"),this.commentButton=this.container.querySelector(".dplayer-comment-icon"),this.commentSettingBox=this.container.querySelector(".dplayer-comment-setting-box"),this.commentSettingButton=this.container.querySelector(".dplayer-comment-setting-icon"),this.commentSettingFill=this.container.querySelector(".dplayer-comment-setting-icon path"),this.commentSendButton=this.container.querySelector(".dplayer-send-icon"),this.commentSendFill=this.container.querySelector(".dplayer-send-icon path"),this.commentColorSettingBox=this.container.querySelector(".dplayer-comment-setting-color"),this.browserFullButton=this.container.querySelector(".dplayer-full-icon"),this.webFullButton=this.container.querySelector(".dplayer-full-in-icon"),this.menu=this.container.querySelector(".dplayer-menu"),this.menuItem=this.container.querySelectorAll(".dplayer-menu-item"),this.qualityList=this.container.querySelector(".dplayer-quality-list"),this.camareButton=this.container.querySelector(".dplayer-camera-icon"),this.airplayButton=this.container.querySelector(".dplayer-airplay-icon"),this.chromecastButton=this.container.querySelector(".dplayer-chromecast-icon"),this.subtitleButton=this.container.querySelector(".dplayer-subtitle-icon"),this.subtitleButtonInner=this.container.querySelector(".dplayer-subtitle-icon .dplayer-icon-content"),this.subtitlesButton=this.container.querySelector(".dplayer-subtitles-icon"),this.subtitlesBox=this.container.querySelector(".dplayer-subtitles-box"),this.subtitlesItem=this.container.querySelectorAll(".dplayer-subtitles-item"),this.subtitle=this.container.querySelector(".dplayer-subtitle"),this.subtrack=this.container.querySelector(".dplayer-subtrack"),this.qualityButton=this.container.querySelector(".dplayer-quality-icon"),this.barPreview=this.container.querySelector(".dplayer-bar-preview"),this.barWrap=this.container.querySelector(".dplayer-bar-wrap"),this.noticeList=this.container.querySelector(".dplayer-notice-list"),this.infoPanel=this.container.querySelector(".dplayer-info-panel"),this.infoPanelClose=this.container.querySelector(".dplayer-info-panel-close"),this.infoVersion=this.container.querySelector(".dplayer-info-panel-item-version .dplayer-info-panel-item-data"),this.infoFPS=this.container.querySelector(".dplayer-info-panel-item-fps .dplayer-info-panel-item-data"),this.infoType=this.container.querySelector(".dplayer-info-panel-item-type .dplayer-info-panel-item-data"),this.infoUrl=this.container.querySelector(".dplayer-info-panel-item-url .dplayer-info-panel-item-data"),this.infoResolution=this.container.querySelector(".dplayer-info-panel-item-resolution .dplayer-info-panel-item-data"),this.infoDuration=this.container.querySelector(".dplayer-info-panel-item-duration .dplayer-info-panel-item-data"),this.infoDanmakuId=this.container.querySelector(".dplayer-info-panel-item-danmaku-id .dplayer-info-panel-item-data"),this.infoDanmakuApi=this.container.querySelector(".dplayer-info-panel-item-danmaku-api .dplayer-info-panel-item-data"),this.infoDanmakuAmount=this.container.querySelector(".dplayer-info-panel-item-danmaku-amount .dplayer-info-panel-item-data")}}])&&Jr(L.prototype,q),_&&Jr(L,_),Object.defineProperty(L,"prototype",{writable:!1}),x}();const bo=bl;function Zr(x){return Zr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},Zr(x)}function _o(x,L){for(var q=0;q<L.length;q++){var _=L[q];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,(R=function(B,X){if(Zr(B)!=="object"||B===null)return B;var ce=B[Symbol.toPrimitive];if(ce!==void 0){var pe=ce.call(B,"string");if(Zr(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(B)}(_.key),Zr(R)==="symbol"?R:String(R)),_)}var R}var vr=function(){function x(_){(function(R,B){if(!(R instanceof B))throw new TypeError("Cannot call a class as a function")})(this,x),this.options=_,this.player=this.options.player,this.container=this.options.container,this.danTunnel={right:{},top:{},bottom:{}},this.danIndex=0,this.dan=[],this.showing=!0,this._opacity=this.options.opacity,this.events=this.options.events,this.unlimited=this.options.unlimited,this._measure(""),this.load()}var L,q;return L=x,q=[{key:"load",value:function(){var _,R=this;_=this.options.api.maximum?"".concat(this.options.api.address,"v3/?id=").concat(this.options.api.id,"&max=").concat(this.options.api.maximum):"".concat(this.options.api.address,"v3/?id=").concat(this.options.api.id);var B=(this.options.api.addition||[]).slice(0);B.push(_),this.events&&this.events.trigger("danmaku_load_start",B),this._readAllEndpoints(B,function(X){R.dan=[].concat.apply([],X).sort(function(ce,pe){return ce.time-pe.time}),window.requestAnimationFrame(function(){R.frame()}),R.options.callback(),R.events&&R.events.trigger("danmaku_load_end")})}},{key:"reload",value:function(_){this.options.api=_,this.dan=[],this.clear(),this.load()}},{key:"_readAllEndpoints",value:function(_,R){for(var B=this,X=[],ce=0,pe=function(He){B.options.apiBackend.read({url:_[He],success:function(yt){X[He]=yt,++ce===_.length&&R(X)},error:function(yt){B.options.error(yt||B.options.tran("danmaku-failed")),X[He]=[],++ce===_.length&&R(X)}})},Ue=0;Ue<_.length;++Ue)pe(Ue)}},{key:"send",value:function(_,R){var B=this,X={token:this.options.api.token,id:this.options.api.id,author:this.options.api.user,time:this.options.time(),text:_.text,color:_.color,type:_.type};this.options.apiBackend.send({url:this.options.api.address+"v3/",data:X,success:R,error:function(pe){B.options.error(pe||B.options.tran("danmaku-failed"))}}),this.dan.splice(this.danIndex,0,X),this.danIndex++;var ce={text:this.htmlEncode(X.text),color:X.color,type:X.type,border:"2px solid ".concat(this.options.borderColor)};this.draw(ce),this.events&&this.events.trigger("danmaku_send",X)}},{key:"frame",value:function(){var _=this;if(this.dan.length&&!this.paused&&this.showing){for(var R=this.dan[this.danIndex],B=[];R&&this.options.time()>parseFloat(R.time);)B.push(R),R=this.dan[++this.danIndex];this.draw(B)}window.requestAnimationFrame(function(){_.frame()})}},{key:"opacity",value:function(_){if(_!==void 0){for(var R=this.container.getElementsByClassName("dplayer-danmaku-item"),B=0;B<R.length;B++)R[B].style.opacity=_;this._opacity=_,this.events&&this.events.trigger("danmaku_opacity",this._opacity)}return this._opacity}},{key:"draw",value:function(_){var R=this;if(this.showing){var B=this.options.height,X=this.container.offsetWidth,ce=this.container.offsetHeight,pe=parseInt(ce/B),Ue=function(vt){var Bt=vt.offsetWidth||parseInt(vt.style.width),Yt=vt.getBoundingClientRect().right||R.container.getBoundingClientRect().right+Bt;return R.container.getBoundingClientRect().right-Yt},He=function(vt){return(X+vt)/5},yt=function(vt,Bt,Yt){for(var Fi=X/He(Yt),hi=function(Hi){var rs=R.danTunnel[Bt][Hi+""];if(!rs||!rs.length)return R.danTunnel[Bt][Hi+""]=[vt],vt.addEventListener("animationend",function(){R.danTunnel[Bt][Hi+""].splice(0,1)}),{v:Hi%pe};if(Bt!=="right")return"continue";for(var Nr=0;Nr<rs.length;Nr++){var Xn=Ue(rs[Nr])-10;if(Xn<=X-Fi*He(parseInt(rs[Nr].style.width))||Xn<=0)break;if(Nr===rs.length-1)return R.danTunnel[Bt][Hi+""].push(vt),vt.addEventListener("animationend",function(){R.danTunnel[Bt][Hi+""].splice(0,1)}),{v:Hi%pe}}},fi=0;R.unlimited||fi<pe;fi++){var sr=hi(fi);if(sr!=="continue"&&Zr(sr)==="object")return sr.v}return-1};Object.prototype.toString.call(_)!=="[object Array]"&&(_=[_]);for(var At=document.createDocumentFragment(),Dt=function(){_[Et].type=ke.number2Type(_[Et].type),_[Et].color||(_[Et].color=16777215);var vt=document.createElement("div");vt.classList.add("dplayer-danmaku-item"),vt.classList.add("dplayer-danmaku-".concat(_[Et].type)),_[Et].border?vt.innerHTML='<span style="border:'.concat(_[Et].border,'">').concat(_[Et].text,"</span>"):vt.innerHTML=_[Et].text,vt.style.opacity=R._opacity,vt.style.color=ke.number2Color(_[Et].color),vt.addEventListener("animationend",function(){R.container.removeChild(vt)});var Bt,Yt=R._measure(_[Et].text);switch(_[Et].type){case"right":(Bt=yt(vt,_[Et].type,Yt))>=0&&(vt.style.width=Yt+1+"px",vt.style.top=B*Bt+"px",vt.style.transform="translateX(-".concat(X,"px)"));break;case"top":(Bt=yt(vt,_[Et].type))>=0&&(vt.style.top=B*Bt+"px");break;case"bottom":(Bt=yt(vt,_[Et].type))>=0&&(vt.style.bottom=B*Bt+"px");break;default:console.error("Can't handled danmaku type: ".concat(_[Et].type))}Bt>=0&&(vt.classList.add("dplayer-danmaku-move"),vt.style.animationDuration=R._danAnimation(_[Et].type),At.appendChild(vt))},Et=0;Et<_.length;Et++)Dt();return this.container.appendChild(At),At}}},{key:"play",value:function(){this.paused=!1}},{key:"pause",value:function(){this.paused=!0}},{key:"_measure",value:function(_){if(!this.context){var R=getComputedStyle(this.container.getElementsByClassName("dplayer-danmaku-item")[0],null);this.context=document.createElement("canvas").getContext("2d"),this.context.font=R.getPropertyValue("font")}return this.context.measureText(_).width}},{key:"seek",value:function(){this.clear();for(var _=0;_<this.dan.length;_++){if(this.dan[_].time>=this.options.time()){this.danIndex=_;break}this.danIndex=this.dan.length}}},{key:"clear",value:function(){this.danTunnel={right:{},top:{},bottom:{}},this.danIndex=0,this.options.container.innerHTML="",this.events&&this.events.trigger("danmaku_clear")}},{key:"htmlEncode",value:function(_){return _.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2f;")}},{key:"resize",value:function(){for(var _=this.container.offsetWidth,R=this.container.getElementsByClassName("dplayer-danmaku-item"),B=0;B<R.length;B++)R[B].style.transform="translateX(-".concat(_,"px)")}},{key:"hide",value:function(){this.showing=!1,this.pause(),this.clear(),this.events&&this.events.trigger("danmaku_hide")}},{key:"show",value:function(){this.seek(),this.showing=!0,this.play(),this.events&&this.events.trigger("danmaku_show")}},{key:"unlimit",value:function(_){this.unlimited=_}},{key:"speed",value:function(_){this.options.api.speedRate=_}},{key:"_danAnimation",value:function(_){var R=this.options.api.speedRate||1,B=!!this.player.fullScreen.isFullScreen();return{top:"".concat((B?6:4)/R,"s"),right:"".concat((B?8:5)/R,"s"),bottom:"".concat((B?6:4)/R,"s")}[_]}}],q&&_o(L.prototype,q),Object.defineProperty(L,"prototype",{writable:!1}),x}();const xo=vr;function Us(x){return Us=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},Us(x)}function _l(x,L){for(var q=0;q<L.length;q++){var _=L[q];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,(R=function(B,X){if(Us(B)!=="object"||B===null)return B;var ce=B[Symbol.toPrimitive];if(ce!==void 0){var pe=ce.call(B,"string");if(Us(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(B)}(_.key),Us(R)==="symbol"?R:String(R)),_)}var R}const ni=function(){function x(){(function(_,R){if(!(_ instanceof R))throw new TypeError("Cannot call a class as a function")})(this,x),this.events={},this.videoEvents=["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","mozaudioavailable","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],this.playerEvents=["screenshot","thumbnails_show","thumbnails_hide","danmaku_show","danmaku_hide","danmaku_clear","danmaku_loaded","danmaku_send","danmaku_opacity","contextmenu_show","contextmenu_hide","notice_show","notice_hide","quality_start","quality_end","destroy","resize","fullscreen","fullscreen_cancel","webfullscreen","webfullscreen_cancel","subtitle_show","subtitle_hide","subtitle_change"]}var L,q;return L=x,(q=[{key:"on",value:function(_,R){this.type(_)&&typeof R=="function"&&(this.events[_]||(this.events[_]=[]),this.events[_].push(R))}},{key:"trigger",value:function(_,R){if(this.events[_]&&this.events[_].length)for(var B=0;B<this.events[_].length;B++)this.events[_][B](R)}},{key:"type",value:function(_){return this.playerEvents.indexOf(_)!==-1?"player":this.videoEvents.indexOf(_)!==-1?"video":(console.error("Unknown event name: ".concat(_)),null)}}])&&_l(L.prototype,q),Object.defineProperty(L,"prototype",{writable:!1}),x}();function $n(x){return $n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},$n(x)}function ms(x,L){for(var q=0;q<L.length;q++){var _=L[q];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,(R=function(B,X){if($n(B)!=="object"||B===null)return B;var ce=B[Symbol.toPrimitive];if(ce!==void 0){var pe=ce.call(B,"string");if($n(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(B)}(_.key),$n(R)==="symbol"?R:String(R)),_)}var R}var Eo=function(){function x(_){var R=this;(function(B,X){if(!(B instanceof X))throw new TypeError("Cannot call a class as a function")})(this,x),this.player=_,this.lastScrollPosition={left:0,top:0},this.player.events.on("webfullscreen",function(){R.player.resize()}),this.player.events.on("webfullscreen_cancel",function(){R.player.resize(),ke.setScrollPosition(R.lastScrollPosition)}),this.fullscreenchange=function(){R.player.resize(),R.isFullScreen("browser")?R.player.events.trigger("fullscreen"):(ke.setScrollPosition(R.lastScrollPosition),R.player.events.trigger("fullscreen_cancel"))},this.docfullscreenchange=function(){var B=document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;B&&B!==R.player.container||(R.player.resize(),B?R.player.events.trigger("fullscreen"):(ke.setScrollPosition(R.lastScrollPosition),R.player.events.trigger("fullscreen_cancel")))},/Firefox/.test(navigator.userAgent)?(document.addEventListener("mozfullscreenchange",this.docfullscreenchange),document.addEventListener("fullscreenchange",this.docfullscreenchange)):(this.player.container.addEventListener("fullscreenchange",this.fullscreenchange),this.player.container.addEventListener("webkitfullscreenchange",this.fullscreenchange),document.addEventListener("msfullscreenchange",this.docfullscreenchange),document.addEventListener("MSFullscreenChange",this.docfullscreenchange))}var L,q;return L=x,q=[{key:"isFullScreen",value:function(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"browser";switch(_){case"browser":return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;case"web":return this.player.container.classList.contains("dplayer-fulled")}}},{key:"request",value:function(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"browser",R=_==="browser"?"web":"browser",B=this.isFullScreen(R);switch(B||(this.lastScrollPosition=ke.getScrollPosition()),_){case"browser":this.player.container.requestFullscreen?this.player.container.requestFullscreen():this.player.container.mozRequestFullScreen?this.player.container.mozRequestFullScreen():this.player.container.webkitRequestFullscreen?this.player.container.webkitRequestFullscreen():this.player.video.webkitEnterFullscreen?this.player.video.webkitEnterFullscreen():this.player.video.webkitEnterFullScreen?this.player.video.webkitEnterFullScreen():this.player.container.msRequestFullscreen&&this.player.container.msRequestFullscreen();break;case"web":this.player.container.classList.add("dplayer-fulled"),document.body.classList.add("dplayer-web-fullscreen-fix"),this.player.events.trigger("webfullscreen")}B&&this.cancel(R)}},{key:"cancel",value:function(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"browser";switch(_){case"browser":document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.webkitCancelFullscreen?document.webkitCancelFullscreen():document.msCancelFullScreen?document.msCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen();break;case"web":this.player.container.classList.remove("dplayer-fulled"),document.body.classList.remove("dplayer-web-fullscreen-fix"),this.player.events.trigger("webfullscreen_cancel")}}},{key:"toggle",value:function(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"browser";this.isFullScreen(_)?this.cancel(_):this.request(_)}},{key:"destroy",value:function(){/Firefox/.test(navigator.userAgent)?(document.removeEventListener("mozfullscreenchange",this.docfullscreenchange),document.removeEventListener("fullscreenchange",this.docfullscreenchange)):(this.player.container.removeEventListener("fullscreenchange",this.fullscreenchange),this.player.container.removeEventListener("webkitfullscreenchange",this.fullscreenchange),document.removeEventListener("msfullscreenchange",this.docfullscreenchange),document.removeEventListener("MSFullscreenChange",this.docfullscreenchange))}}],q&&ms(L.prototype,q),Object.defineProperty(L,"prototype",{writable:!1}),x}();const $a=Eo;function js(x){return js=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},js(x)}function $s(x,L){for(var q=0;q<L.length;q++){var _=L[q];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,(R=function(B,X){if(js(B)!=="object"||B===null)return B;var ce=B[Symbol.toPrimitive];if(ce!==void 0){var pe=ce.call(B,"string");if(js(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(B)}(_.key),js(R)==="symbol"?R:String(R)),_)}var R}var la=function(){function x(_){(function(R,B){if(!(R instanceof B))throw new TypeError("Cannot call a class as a function")})(this,x),this.storageName={opacity:"dplayer-danmaku-opacity",volume:"dplayer-volume",unlimited:"dplayer-danmaku-unlimited",danmaku:"dplayer-danmaku-show",subtitle:"dplayer-subtitle-show"},this.default={opacity:.7,volume:_.options.hasOwnProperty("volume")?_.options.volume:.7,unlimited:(_.options.danmaku&&_.options.danmaku.unlimited?1:0)||0,danmaku:1,subtitle:1},this.data={},this.init()}var L,q;return L=x,(q=[{key:"init",value:function(){for(var _ in this.storageName){var R=this.storageName[_];this.data[_]=parseFloat(ke.storage.get(R)||this.default[_])}}},{key:"get",value:function(_){return this.data[_]}},{key:"set",value:function(_,R){this.data[_]=R,ke.storage.set(this.storageName[_],R)}}])&&$s(L.prototype,q),Object.defineProperty(L,"prototype",{writable:!1}),x}();const Ar=la;function Vn(x){return Vn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},Vn(x)}function xl(x,L){for(var q=0;q<L.length;q++){var _=L[q];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,(R=function(B,X){if(Vn(B)!=="object"||B===null)return B;var ce=B[Symbol.toPrimitive];if(ce!==void 0){var pe=ce.call(B,"string");if(Vn(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(B)}(_.key),Vn(R)==="symbol"?R:String(R)),_)}var R}var Va=function(){function x(_,R,B,X){(function(ce,pe){if(!(ce instanceof pe))throw new TypeError("Cannot call a class as a function")})(this,x),this.container=_,this.video=R,this.options=B,this.events=X,this.init()}var L,q;return L=x,q=[{key:"init",value:function(){var _=this;if(this.container.style.fontSize=this.options.fontSize,this.container.style.bottom=this.options.bottom,this.container.style.color=this.options.color,this.video.textTracks&&this.video.textTracks[0]){var R=this.video.textTracks[0];R.oncuechange=function(){var B=R.activeCues[R.activeCues.length-1];if(_.container.innerHTML="",B){var X=document.createElement("div");X.appendChild(B.getCueAsHTML());var ce=X.innerHTML.split(/\r?\n/).map(function(pe){return"<p>".concat(pe,"</p>")}).join("");_.container.innerHTML=ce}_.events.trigger("subtitle_change")}}}},{key:"show",value:function(){this.container.classList.remove("dplayer-subtitle-hide"),this.events.trigger("subtitle_show")}},{key:"hide",value:function(){this.container.classList.add("dplayer-subtitle-hide"),this.events.trigger("subtitle_hide")}},{key:"toggle",value:function(){this.container.classList.contains("dplayer-subtitle-hide")?this.show():this.hide()}}],q&&xl(L.prototype,q),Object.defineProperty(L,"prototype",{writable:!1}),x}();const El=Va;function Rr(x){return Rr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},Rr(x)}function ua(x,L){for(var q=0;q<L.length;q++){var _=L[q];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,(R=function(B,X){if(Rr(B)!=="object"||B===null)return B;var ce=B[Symbol.toPrimitive];if(ce!==void 0){var pe=ce.call(B,"string");if(Rr(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(B)}(_.key),Rr(R)==="symbol"?R:String(R)),_)}var R}var To=function(){function x(_){var R=this;(function(pe,Ue){if(!(pe instanceof Ue))throw new TypeError("Cannot call a class as a function")})(this,x),this.player=_,this.player.template.mask.addEventListener("click",function(){R.hide()}),this.player.template.subtitlesButton.addEventListener("click",function(){R.adaptiveHeight(),R.show()});for(var B=this.player.template.subtitlesItem.length-1,X=function(pe){R.player.template.subtitlesItem[pe].addEventListener("click",function(){R.hide(),R.player.options.subtitle.index!==pe&&(R.player.template.subtitle.innerHTML="<p></p>",R.player.template.subtrack.src=R.player.template.subtitlesItem[pe].dataset.subtitle,R.player.options.subtitle.index=pe,R.player.template.subtitle.classList.contains("dplayer-subtitle-hide")&&R.subContainerShow())})},ce=0;ce<B;ce++)X(ce);this.player.template.subtitlesItem[B].addEventListener("click",function(){R.hide(),R.player.options.subtitle.index!==B&&(R.player.template.subtitle.innerHTML="<p></p>",R.player.template.subtrack.src="",R.player.options.subtitle.index=B,R.subContainerHide())})}var L,q;return L=x,(q=[{key:"subContainerShow",value:function(){this.player.template.subtitle.classList.remove("dplayer-subtitle-hide"),this.player.events.trigger("subtitle_show")}},{key:"subContainerHide",value:function(){this.player.template.subtitle.classList.add("dplayer-subtitle-hide"),this.player.events.trigger("subtitle_hide")}},{key:"hide",value:function(){this.player.template.subtitlesBox.classList.remove("dplayer-subtitles-box-open"),this.player.template.mask.classList.remove("dplayer-mask-show"),this.player.controller.disableAutoHide=!1}},{key:"show",value:function(){this.player.template.subtitlesBox.classList.add("dplayer-subtitles-box-open"),this.player.template.mask.classList.add("dplayer-mask-show"),this.player.controller.disableAutoHide=!0}},{key:"adaptiveHeight",value:function(){var _=30*this.player.template.subtitlesItem.length+14,R=.8*this.player.template.videoWrap.offsetHeight;_>=R-50?(this.player.template.subtitlesBox.style.bottom="8px",this.player.template.subtitlesBox.style["max-height"]=R-8+"px"):(this.player.template.subtitlesBox.style.bottom="50px",this.player.template.subtitlesBox.style["max-height"]=R-50+"px")}}])&&ua(L.prototype,q),Object.defineProperty(L,"prototype",{writable:!1}),x}();const Vs=To;function Yi(x){return Yi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},Yi(x)}function Tl(x,L){for(var q=0;q<L.length;q++){var _=L[q];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,(R=function(B,X){if(Yi(B)!=="object"||B===null)return B;var ce=B[Symbol.toPrimitive];if(ce!==void 0){var pe=ce.call(B,"string");if(Yi(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(B)}(_.key),Yi(R)==="symbol"?R:String(R)),_)}var R}var st=function(){function x(_){(function(R,B){if(!(R instanceof B))throw new TypeError("Cannot call a class as a function")})(this,x),this.elements={},this.elements.volume=_.volumeBar,this.elements.played=_.playedBar,this.elements.loaded=_.loadedBar,this.elements.danmaku=_.danmakuOpacityBar}var L,q;return L=x,(q=[{key:"set",value:function(_,R,B){R=Math.max(R,0),R=Math.min(R,1),this.elements[_].style[B]=100*R+"%"}},{key:"get",value:function(_){return parseFloat(this.elements[_].style.width)/100}}])&&Tl(L.prototype,q),Object.defineProperty(L,"prototype",{writable:!1}),x}();const ri=st;function es(x){return es=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},es(x)}function Sl(x,L){for(var q=0;q<L.length;q++){var _=L[q];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,(R=function(B,X){if(es(B)!=="object"||B===null)return B;var ce=B[Symbol.toPrimitive];if(ce!==void 0){var pe=ce.call(B,"string");if(es(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(B)}(_.key),es(R)==="symbol"?R:String(R)),_)}var R}var So=function(){function x(_){(function(R,B){if(!(R instanceof B))throw new TypeError("Cannot call a class as a function")})(this,x),this.player=_,window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(R){window.setTimeout(R,1e3/60)},this.types=["loading","info","fps"],this.init()}var L,q;return L=x,(q=[{key:"init",value:function(){var _=this;this.types.map(function(R){return R!=="fps"&&_["init".concat(R,"Checker")](),R})}},{key:"initloadingChecker",value:function(){var _=this,R=0,B=0,X=!1;this.loadingChecker=setInterval(function(){_.enableloadingChecker&&(B=_.player.video.currentTime,X||B!==R||_.player.video.paused||(_.player.container.classList.add("dplayer-loading"),X=!0),X&&B>R&&!_.player.video.paused&&(_.player.container.classList.remove("dplayer-loading"),X=!1),R=B)},100)}},{key:"initfpsChecker",value:function(){var _=this;window.requestAnimationFrame(function(){if(_.enablefpsChecker)if(_.initfpsChecker(),_.fpsStart){_.fpsIndex++;var R=new Date;R-_.fpsStart>1e3&&(_.player.infoPanel.fps(_.fpsIndex/(R-_.fpsStart)*1e3),_.fpsStart=new Date,_.fpsIndex=0)}else _.fpsStart=new Date,_.fpsIndex=0;else _.fpsStart=0,_.fpsIndex=0})}},{key:"initinfoChecker",value:function(){var _=this;this.infoChecker=setInterval(function(){_.enableinfoChecker&&_.player.infoPanel.update()},1e3)}},{key:"enable",value:function(_){this["enable".concat(_,"Checker")]=!0,_==="fps"&&this.initfpsChecker()}},{key:"disable",value:function(_){this["enable".concat(_,"Checker")]=!1}},{key:"destroy",value:function(){var _=this;this.types.map(function(R){return _["enable".concat(R,"Checker")]=!1,_["".concat(R,"Checker")]&&clearInterval(_["".concat(R,"Checker")]),R})}}])&&Sl(L.prototype,q),Object.defineProperty(L,"prototype",{writable:!1}),x}();const gs=So;function ys(x){return ys=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},ys(x)}function nr(x,L){for(var q=0;q<L.length;q++){var _=L[q];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,(R=function(B,X){if(ys(B)!=="object"||B===null)return B;var ce=B[Symbol.toPrimitive];if(ce!==void 0){var pe=ce.call(B,"string");if(ys(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(B)}(_.key),ys(R)==="symbol"?R:String(R)),_)}var R}const vn=function(){function x(_){var R=this;(function(B,X){if(!(B instanceof X))throw new TypeError("Cannot call a class as a function")})(this,x),this.container=_,this.container.addEventListener("animationend",function(){R.container.classList.remove("dplayer-bezel-transition")})}var L,q;return L=x,(q=[{key:"switch",value:function(_){this.container.innerHTML=_,this.container.classList.add("dplayer-bezel-transition")}}])&&nr(L.prototype,q),Object.defineProperty(L,"prototype",{writable:!1}),x}();function ci(x){return ci=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},ci(x)}function Co(x,L){for(var q=0;q<L.length;q++){var _=L[q];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,(R=function(B,X){if(ci(B)!=="object"||B===null)return B;var ce=B[Symbol.toPrimitive];if(ce!==void 0){var pe=ce.call(B,"string");if(ci(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(B)}(_.key),ci(R)==="symbol"?R:String(R)),_)}var R}var da=function(){function x(_){(function(R,B){if(!(R instanceof B))throw new TypeError("Cannot call a class as a function")})(this,x),this.container=_.container,this.barWidth=_.barWidth,this.container.style.backgroundImage="url('".concat(_.url,"')"),this.events=_.events}var L,q;return L=x,(q=[{key:"resize",value:function(_,R,B){this.container.style.width="".concat(_,"px"),this.container.style.height="".concat(R,"px"),this.container.style.top="".concat(2-R,"px"),this.barWidth=B}},{key:"show",value:function(){this.container.style.display="block",this.events&&this.events.trigger("thumbnails_show")}},{key:"move",value:function(_){this.container.style.backgroundPosition="-".concat(160*(Math.ceil(_/this.barWidth*100)-1),"px 0"),this.container.style.left="".concat(Math.min(Math.max(_-this.container.offsetWidth/2,-10),this.barWidth-150),"px")}},{key:"hide",value:function(){this.container.style.display="none",this.events&&this.events.trigger("thumbnails_hide")}}])&&Co(L.prototype,q),Object.defineProperty(L,"prototype",{writable:!1}),x}();const wo=da;function Or(x){return Or=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},Or(x)}function ca(x,L){for(var q=0;q<L.length;q++){var _=L[q];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,(R=function(B,X){if(Or(B)!=="object"||B===null)return B;var ce=B[Symbol.toPrimitive];if(ce!==void 0){var pe=ce.call(B,"string");if(Or(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(B)}(_.key),Or(R)==="symbol"?R:String(R)),_)}var R}var on,vs=!0,ha=!1,As=function(){function x(_){(function(R,B){if(!(R instanceof B))throw new TypeError("Cannot call a class as a function")})(this,x),this.player=_,this.autoHideTimer=0,ke.isMobile||(this.setAutoHideHandler=this.setAutoHide.bind(this),this.player.container.addEventListener("mousemove",this.setAutoHideHandler),this.player.container.addEventListener("click",this.setAutoHideHandler),this.player.on("play",this.setAutoHideHandler),this.player.on("pause",this.setAutoHideHandler)),this.initPlayButton(),this.initThumbnails(),this.initPlayedBar(),this.initFullButton(),this.initQualityButton(),this.initScreenshotButton(),this.player.options.subtitle&&typeof this.player.options.subtitle.url=="string"&&this.initSubtitleButton(),this.initHighlights(),this.initAirplayButton(),this.initChromecastButton(),ke.isMobile||this.initVolumeButton()}var L,q;return L=x,(q=[{key:"initPlayButton",value:function(){var _=this;this.player.template.playButton.addEventListener("click",function(){_.player.toggle()}),this.player.template.mobilePlayButton.addEventListener("click",function(){_.player.toggle()}),ke.isMobile?(this.player.template.videoWrap.addEventListener("click",function(){_.toggle()}),this.player.template.controllerMask.addEventListener("click",function(){_.toggle()})):this.player.options.preventClickToggle||(this.player.template.videoWrap.addEventListener("click",function(){_.player.toggle()}),this.player.template.controllerMask.addEventListener("click",function(){_.player.toggle()}))}},{key:"initHighlights",value:function(){var _=this;this.player.on("durationchange",function(){if(_.player.video.duration!==1&&_.player.video.duration!==1/0&&_.player.options.highlight){var R=_.player.template.playedBarWrap.querySelectorAll(".dplayer-highlight");[].slice.call(R,0).forEach(function(ce){_.player.template.playedBarWrap.removeChild(ce)});for(var B=0;B<_.player.options.highlight.length;B++)if(_.player.options.highlight[B].text&&_.player.options.highlight[B].time){var X=document.createElement("div");X.classList.add("dplayer-highlight"),X.style.left=_.player.options.highlight[B].time/_.player.video.duration*100+"%",X.innerHTML='<span class="dplayer-highlight-text">'+_.player.options.highlight[B].text+"</span>",_.player.template.playedBarWrap.insertBefore(X,_.player.template.playedBarTime)}}})}},{key:"initThumbnails",value:function(){var _=this;this.player.options.video.thumbnails&&(this.thumbnails=new wo({container:this.player.template.barPreview,barWidth:this.player.template.barWrap.offsetWidth,url:this.player.options.video.thumbnails,events:this.player.events}),this.player.on("loadedmetadata",function(){_.thumbnails.resize(160,_.player.video.videoHeight/_.player.video.videoWidth*160,_.player.template.barWrap.offsetWidth)}))}},{key:"initPlayedBar",value:function(){var _=this,R=function(X){var ce=((X.clientX||X.changedTouches[0].clientX)-ke.getBoundingClientRectViewLeft(_.player.template.playedBarWrap))/_.player.template.playedBarWrap.clientWidth;ce=Math.max(ce,0),ce=Math.min(ce,1),_.player.bar.set("played",ce,"width"),_.player.template.ptime.innerHTML=ke.secondToTime(ce*_.player.video.duration)},B=function X(ce){document.removeEventListener(ke.nameMap.dragEnd,X),document.removeEventListener(ke.nameMap.dragMove,R);var pe=((ce.clientX||ce.changedTouches[0].clientX)-ke.getBoundingClientRectViewLeft(_.player.template.playedBarWrap))/_.player.template.playedBarWrap.clientWidth;pe=Math.max(pe,0),pe=Math.min(pe,1),_.player.bar.set("played",pe,"width"),_.player.seek(_.player.bar.get("played")*_.player.video.duration),_.player.timer.enable("progress")};this.player.template.playedBarWrap.addEventListener(ke.nameMap.dragStart,function(){_.player.timer.disable("progress"),document.addEventListener(ke.nameMap.dragMove,R),document.addEventListener(ke.nameMap.dragEnd,B)}),this.player.template.playedBarWrap.addEventListener(ke.nameMap.dragMove,function(X){if(_.player.video.duration){var ce=_.player.template.playedBarWrap.getBoundingClientRect().left,pe=(X.clientX||X.changedTouches[0].clientX)-ce;if(pe<0||pe>_.player.template.playedBarWrap.offsetWidth)return;var Ue=_.player.video.duration*(pe/_.player.template.playedBarWrap.offsetWidth);ke.isMobile&&_.thumbnails&&_.thumbnails.show(),_.thumbnails&&_.thumbnails.move(pe),_.player.template.playedBarTime.style.left="".concat(pe-(Ue>=3600?25:20),"px"),_.player.template.playedBarTime.innerText=ke.secondToTime(Ue),_.player.template.playedBarTime.classList.remove("hidden")}}),this.player.template.playedBarWrap.addEventListener(ke.nameMap.dragEnd,function(){ke.isMobile&&_.thumbnails&&_.thumbnails.hide()}),ke.isMobile||(this.player.template.playedBarWrap.addEventListener("mouseenter",function(){_.player.video.duration&&(_.thumbnails&&_.thumbnails.show(),_.player.template.playedBarTime.classList.remove("hidden"))}),this.player.template.playedBarWrap.addEventListener("mouseleave",function(){_.player.video.duration&&(_.thumbnails&&_.thumbnails.hide(),_.player.template.playedBarTime.classList.add("hidden"))}))}},{key:"initFullButton",value:function(){var _=this;this.player.template.browserFullButton.addEventListener("click",function(){_.player.fullScreen.toggle("browser")}),this.player.template.webFullButton.addEventListener("click",function(){_.player.fullScreen.toggle("web")})}},{key:"initVolumeButton",value:function(){var _=this,R=function(X){var ce=X||window.event,pe=((ce.clientX||ce.changedTouches[0].clientX)-ke.getBoundingClientRectViewLeft(_.player.template.volumeBarWrap)-5.5)/35;_.player.volume(pe)},B=function X(){document.removeEventListener(ke.nameMap.dragEnd,X),document.removeEventListener(ke.nameMap.dragMove,R),_.player.template.volumeButton.classList.remove("dplayer-volume-active")};this.player.template.volumeBarWrapWrap.addEventListener("click",function(X){var ce=X||window.event,pe=((ce.clientX||ce.changedTouches[0].clientX)-ke.getBoundingClientRectViewLeft(_.player.template.volumeBarWrap)-5.5)/35;_.player.volume(pe)}),this.player.template.volumeBarWrapWrap.addEventListener(ke.nameMap.dragStart,function(){document.addEventListener(ke.nameMap.dragMove,R),document.addEventListener(ke.nameMap.dragEnd,B),_.player.template.volumeButton.classList.add("dplayer-volume-active")}),this.player.template.volumeButtonIcon.addEventListener("click",function(){_.player.video.muted?(_.player.video.muted=!1,_.player.switchVolumeIcon(),_.player.bar.set("volume",_.player.volume(),"width")):(_.player.video.muted=!0,_.player.template.volumeIcon.innerHTML=jn.volumeOff,_.player.bar.set("volume",0,"width"))})}},{key:"initQualityButton",value:function(){var _=this;this.player.options.video.quality&&this.player.template.qualityList.addEventListener("click",function(R){R.target.classList.contains("dplayer-quality-item")&&_.player.switchQuality(R.target.dataset.index)})}},{key:"initScreenshotButton",value:function(){var _=this;this.player.options.screenshot&&this.player.template.camareButton.addEventListener("click",function(){var R,B=document.createElement("canvas");B.width=_.player.video.videoWidth,B.height=_.player.video.videoHeight,B.getContext("2d").drawImage(_.player.video,0,0,B.width,B.height),B.toBlob(function(X){R=URL.createObjectURL(X);var ce=document.createElement("a");ce.href=R,ce.download="DPlayer.png",ce.style.display="none",document.body.appendChild(ce),ce.click(),document.body.removeChild(ce),URL.revokeObjectURL(R),_.player.events.trigger("screenshot",R)})})}},{key:"initAirplayButton",value:function(){this.player.options.airplay&&(window.WebKitPlaybackTargetAvailabilityEvent?this.player.video.addEventListener("webkitplaybacktargetavailabilitychanged",function(_){_.availability==="available"?this.template.airplayButton.disable=!1:this.template.airplayButton.disable=!0,this.template.airplayButton.addEventListener("click",function(){this.video.webkitShowPlaybackTargetPicker()}.bind(this))}.bind(this.player)):this.player.template.airplayButton.style.display="none")}},{key:"initChromecast",value:function(){var _=window.document.createElement("script");_.setAttribute("type","text/javascript"),_.setAttribute("src","https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1"),window.document.body.appendChild(_),window.__onGCastApiAvailable=function(R){if(R){var B=new(on=window.chrome.cast).SessionRequest(on.media.DEFAULT_MEDIA_RECEIVER_APP_ID),X=new on.ApiConfig(B,function(){},function(ce){ce===on.ReceiverAvailability.AVAILABLE&&console.log("chromecast: ",ce)});on.initialize(X,function(){})}}}},{key:"initChromecastButton",value:function(){var _=this;if(this.player.options.chromecast){vs&&(vs=!1,this.initChromecast());var R=function(X,ce){_.currentMedia=ce},B=function(X){console.error("Error launching media",X)};this.player.template.chromecastButton.addEventListener("click",function(){ha?(ha=!1,_.currentMedia.stop(),_.session.stop(),_.initChromecast()):(ha=!0,on.requestSession(function(X){var ce,pe,Ue;_.session=X,ce=_.player.options.video.url,pe=new on.media.MediaInfo(ce),Ue=new on.media.LoadRequest(pe),_.session?_.session.loadMedia(Ue,R.bind(_,"loadMedia"),B).play():window.open(ce)},function(X){X.code==="cancel"?_.session=void 0:console.error("Error selecting a cast device",X)}))})}}},{key:"initSubtitleButton",value:function(){var _=this;this.player.events.on("subtitle_show",function(){_.player.template.subtitleButton.dataset.balloon=_.player.tran("hide-subs"),_.player.template.subtitleButtonInner.style.opacity="",_.player.user.set("subtitle",1)}),this.player.events.on("subtitle_hide",function(){_.player.template.subtitleButton.dataset.balloon=_.player.tran("show-subs"),_.player.template.subtitleButtonInner.style.opacity="0.4",_.player.user.set("subtitle",0)}),this.player.template.subtitleButton.addEventListener("click",function(){_.player.subtitle.toggle()})}},{key:"setAutoHide",value:function(){var _=this;this.show(),clearTimeout(this.autoHideTimer),this.autoHideTimer=setTimeout(function(){!_.player.video.played.length||_.player.paused||_.disableAutoHide||_.hide()},3e3)}},{key:"show",value:function(){this.player.container.classList.remove("dplayer-hide-controller")}},{key:"hide",value:function(){this.player.container.classList.add("dplayer-hide-controller"),this.player.setting.hide(),this.player.comment&&this.player.comment.hide()}},{key:"isShow",value:function(){return!this.player.container.classList.contains("dplayer-hide-controller")}},{key:"toggle",value:function(){this.isShow()?this.hide():this.show()}},{key:"destroy",value:function(){ke.isMobile||(this.player.container.removeEventListener("mousemove",this.setAutoHideHandler),this.player.container.removeEventListener("click",this.setAutoHideHandler)),clearTimeout(this.autoHideTimer)}}])&&ca(L.prototype,q),Object.defineProperty(L,"prototype",{writable:!1}),x}();const ts=As;function An(x){return An=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},An(x)}function Ha(x,L){for(var q=0;q<L.length;q++){var _=L[q];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,(R=function(B,X){if(An(B)!=="object"||B===null)return B;var ce=B[Symbol.toPrimitive];if(ce!==void 0){var pe=ce.call(B,"string");if(An(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(B)}(_.key),An(R)==="symbol"?R:String(R)),_)}var R}var Hs=function(){function x(_){var R=this;(function(Ue,He){if(!(Ue instanceof He))throw new TypeError("Cannot call a class as a function")})(this,x),this.player=_,this.player.template.mask.addEventListener("click",function(){R.hide()}),this.player.template.settingButton.addEventListener("click",function(){R.show()}),this.loop=this.player.options.loop,this.player.template.loopToggle.checked=this.loop,this.player.template.loop.addEventListener("click",function(){R.player.template.loopToggle.checked=!R.player.template.loopToggle.checked,R.player.template.loopToggle.checked?R.loop=!0:R.loop=!1,R.hide()}),this.showDanmaku=this.player.user.get("danmaku"),this.showDanmaku||this.player.danmaku&&this.player.danmaku.hide(),this.player.template.showDanmakuToggle.checked=this.showDanmaku,this.player.template.showDanmaku.addEventListener("click",function(){R.player.template.showDanmakuToggle.checked=!R.player.template.showDanmakuToggle.checked,R.player.template.showDanmakuToggle.checked?(R.showDanmaku=!0,R.player.danmaku.show()):(R.showDanmaku=!1,R.player.danmaku.hide()),R.player.user.set("danmaku",R.showDanmaku?1:0),R.hide()}),this.unlimitDanmaku=this.player.user.get("unlimited"),this.player.template.unlimitDanmakuToggle.checked=this.unlimitDanmaku,this.player.template.unlimitDanmaku.addEventListener("click",function(){R.player.template.unlimitDanmakuToggle.checked=!R.player.template.unlimitDanmakuToggle.checked,R.player.template.unlimitDanmakuToggle.checked?(R.unlimitDanmaku=!0,R.player.danmaku.unlimit(!0)):(R.unlimitDanmaku=!1,R.player.danmaku.unlimit(!1)),R.player.user.set("unlimited",R.unlimitDanmaku?1:0),R.hide()}),this.player.template.speed.addEventListener("click",function(){R.player.template.settingBox.classList.add("dplayer-setting-box-narrow"),R.player.template.settingBox.classList.add("dplayer-setting-box-speed")});for(var B=function(Ue){R.player.template.speedItem[Ue].addEventListener("click",function(){R.player.speed(R.player.template.speedItem[Ue].dataset.speed),R.hide()})},X=0;X<this.player.template.speedItem.length;X++)B(X);if(this.player.danmaku){this.player.on("danmaku_opacity",function(Ue){R.player.bar.set("danmaku",Ue,"width"),R.player.user.set("opacity",Ue)}),this.player.danmaku.opacity(this.player.user.get("opacity"));var ce=function(Ue){var He=Ue||window.event,yt=((He.clientX||He.changedTouches[0].clientX)-ke.getBoundingClientRectViewLeft(R.player.template.danmakuOpacityBarWrap))/130;yt=Math.max(yt,0),yt=Math.min(yt,1),R.player.danmaku.opacity(yt)},pe=function Ue(){document.removeEventListener(ke.nameMap.dragEnd,Ue),document.removeEventListener(ke.nameMap.dragMove,ce),R.player.template.danmakuOpacityBox.classList.remove("dplayer-setting-danmaku-active")};this.player.template.danmakuOpacityBarWrapWrap.addEventListener("click",function(Ue){var He=Ue||window.event,yt=((He.clientX||He.changedTouches[0].clientX)-ke.getBoundingClientRectViewLeft(R.player.template.danmakuOpacityBarWrap))/130;yt=Math.max(yt,0),yt=Math.min(yt,1),R.player.danmaku.opacity(yt)}),this.player.template.danmakuOpacityBarWrapWrap.addEventListener(ke.nameMap.dragStart,function(){document.addEventListener(ke.nameMap.dragMove,ce),document.addEventListener(ke.nameMap.dragEnd,pe),R.player.template.danmakuOpacityBox.classList.add("dplayer-setting-danmaku-active")})}}var L,q;return L=x,(q=[{key:"hide",value:function(){var _=this;this.player.template.settingBox.classList.remove("dplayer-setting-box-open"),this.player.template.mask.classList.remove("dplayer-mask-show"),setTimeout(function(){_.player.template.settingBox.classList.remove("dplayer-setting-box-narrow"),_.player.template.settingBox.classList.remove("dplayer-setting-box-speed")},300),this.player.controller.disableAutoHide=!1}},{key:"show",value:function(){this.player.template.settingBox.classList.add("dplayer-setting-box-open"),this.player.template.mask.classList.add("dplayer-mask-show"),this.player.controller.disableAutoHide=!0}}])&&Ha(L.prototype,q),Object.defineProperty(L,"prototype",{writable:!1}),x}();const Lo=Hs;function Pr(x){return Pr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},Pr(x)}function fa(x,L){for(var q=0;q<L.length;q++){var _=L[q];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,(R=function(B,X){if(Pr(B)!=="object"||B===null)return B;var ce=B[Symbol.toPrimitive];if(ce!==void 0){var pe=ce.call(B,"string");if(Pr(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(B)}(_.key),Pr(R)==="symbol"?R:String(R)),_)}var R}var is=function(){function x(_){var R=this;(function(B,X){if(!(B instanceof X))throw new TypeError("Cannot call a class as a function")})(this,x),this.player=_,this.player.template.mask.addEventListener("click",function(){R.hide()}),this.player.template.commentButton.addEventListener("click",function(){R.show()}),this.player.template.commentSettingButton.addEventListener("click",function(){R.toggleSetting()}),this.player.template.commentColorSettingBox.addEventListener("click",function(){if(R.player.template.commentColorSettingBox.querySelector("input:checked+span")){var B=R.player.template.commentColorSettingBox.querySelector("input:checked").value;R.player.template.commentSettingFill.style.fill=B,R.player.template.commentInput.style.color=B,R.player.template.commentSendFill.style.fill=B}}),this.player.template.commentInput.addEventListener("click",function(){R.hideSetting()}),this.player.template.commentInput.addEventListener("keydown",function(B){(B||window.event).keyCode===13&&R.send()}),this.player.template.commentSendButton.addEventListener("click",function(){R.send()})}var L,q;return L=x,(q=[{key:"show",value:function(){this.player.controller.disableAutoHide=!0,this.player.template.controller.classList.add("dplayer-controller-comment"),this.player.template.mask.classList.add("dplayer-mask-show"),this.player.container.classList.add("dplayer-show-controller"),this.player.template.commentInput.focus()}},{key:"hide",value:function(){this.player.template.controller.classList.remove("dplayer-controller-comment"),this.player.template.mask.classList.remove("dplayer-mask-show"),this.player.container.classList.remove("dplayer-show-controller"),this.player.controller.disableAutoHide=!1,this.hideSetting()}},{key:"showSetting",value:function(){this.player.template.commentSettingBox.classList.add("dplayer-comment-setting-open")}},{key:"hideSetting",value:function(){this.player.template.commentSettingBox.classList.remove("dplayer-comment-setting-open")}},{key:"toggleSetting",value:function(){this.player.template.commentSettingBox.classList.contains("dplayer-comment-setting-open")?this.hideSetting():this.showSetting()}},{key:"send",value:function(){var _=this;this.player.template.commentInput.blur(),this.player.template.commentInput.value.replace(/^\s+|\s+$/g,"")?this.player.danmaku.send({text:this.player.template.commentInput.value,color:ke.color2Number(this.player.container.querySelector(".dplayer-comment-setting-color input:checked").value),type:parseInt(this.player.container.querySelector(".dplayer-comment-setting-type input:checked").value)},function(){_.player.template.commentInput.value="",_.hide()}):this.player.notice(this.player.tran("please-input-danmaku"))}}])&&fa(L.prototype,q),Object.defineProperty(L,"prototype",{writable:!1}),x}();const pa=is;function br(x){return br=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},br(x)}function bs(x,L){for(var q=0;q<L.length;q++){var _=L[q];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,(R=function(B,X){if(br(B)!=="object"||B===null)return B;var ce=B[Symbol.toPrimitive];if(ce!==void 0){var pe=ce.call(B,"string");if(br(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(B)}(_.key),br(R)==="symbol"?R:String(R)),_)}var R}var bn=function(){function x(_){(function(R,B){if(!(R instanceof B))throw new TypeError("Cannot call a class as a function")})(this,x),this.player=_,this.doHotKeyHandler=this.doHotKey.bind(this),this.cancelFullScreenHandler=this.cancelFullScreen.bind(this),this.player.options.hotkey&&document.addEventListener("keydown",this.doHotKeyHandler),document.addEventListener("keydown",this.cancelFullScreenHandler)}var L,q;return L=x,(q=[{key:"doHotKey",value:function(_){if(this.player.focus){var R=document.activeElement.tagName.toUpperCase(),B=document.activeElement.getAttribute("contenteditable");if(R!=="INPUT"&&R!=="TEXTAREA"&&B!==""&&B!=="true"){var X,ce=_||window.event;switch(ce.keyCode){case 32:ce.preventDefault(),this.player.toggle();break;case 37:if(ce.preventDefault(),this.player.options.live)break;this.player.seek(this.player.video.currentTime-5),this.player.controller.setAutoHide();break;case 39:if(ce.preventDefault(),this.player.options.live)break;this.player.seek(this.player.video.currentTime+5),this.player.controller.setAutoHide();break;case 38:ce.preventDefault(),X=this.player.volume()+.1,this.player.volume(X);break;case 40:ce.preventDefault(),X=this.player.volume()-.1,this.player.volume(X)}}}}},{key:"cancelFullScreen",value:function(_){(_||window.event).keyCode===27&&this.player.fullScreen.isFullScreen("web")&&this.player.fullScreen.cancel("web")}},{key:"destroy",value:function(){this.player.options.hotkey&&document.removeEventListener("keydown",this.doHotKeyHandler),document.removeEventListener("keydown",this.cancelFullScreenHandler)}}])&&bs(L.prototype,q),Object.defineProperty(L,"prototype",{writable:!1}),x}();const Gs=bn;function _s(x){return _s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},_s(x)}function ma(x,L){for(var q=0;q<L.length;q++){var _=L[q];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,(R=function(B,X){if(_s(B)!=="object"||B===null)return B;var ce=B[Symbol.toPrimitive];if(ce!==void 0){var pe=ce.call(B,"string");if(_s(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(B)}(_.key),_s(R)==="symbol"?R:String(R)),_)}var R}var ko=function(){function x(_){var R=this;(function(B,X){if(!(B instanceof X))throw new TypeError("Cannot call a class as a function")})(this,x),this.player=_,this.shown=!1,Array.prototype.slice.call(this.player.template.menuItem).forEach(function(B,X){R.player.options.contextmenu[X].click&&B.addEventListener("click",function(){R.player.options.contextmenu[X].click(R.player),R.hide()})}),this.contextmenuHandler=function(B){if(R.shown)R.hide();else{var X=B||window.event;X.preventDefault();var ce=R.player.container.getBoundingClientRect();R.show(X.clientX-ce.left,X.clientY-ce.top),R.player.template.mask.addEventListener("click",function(){R.hide()})}},this.player.container.addEventListener("contextmenu",this.contextmenuHandler)}var L,q;return L=x,(q=[{key:"show",value:function(_,R){this.player.template.menu.classList.add("dplayer-menu-show");var B=this.player.container.getBoundingClientRect();_+this.player.template.menu.offsetWidth>=B.width?(this.player.template.menu.style.right=B.width-_+"px",this.player.template.menu.style.left="initial"):(this.player.template.menu.style.left=_+"px",this.player.template.menu.style.right="initial"),R+this.player.template.menu.offsetHeight>=B.height?(this.player.template.menu.style.bottom=B.height-R+"px",this.player.template.menu.style.top="initial"):(this.player.template.menu.style.top=R+"px",this.player.template.menu.style.bottom="initial"),this.player.template.mask.classList.add("dplayer-mask-show"),this.shown=!0,this.player.events.trigger("contextmenu_show")}},{key:"hide",value:function(){this.player.template.mask.classList.remove("dplayer-mask-show"),this.player.template.menu.classList.remove("dplayer-menu-show"),this.shown=!1,this.player.events.trigger("contextmenu_hide")}},{key:"destroy",value:function(){this.player.container.removeEventListener("contextmenu",this.contextmenuHandler)}}])&&ma(L.prototype,q),Object.defineProperty(L,"prototype",{writable:!1}),x}();const xs=ko;function rr(x){return rr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},rr(x)}function Ga(x,L){for(var q=0;q<L.length;q++){var _=L[q];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,(R=function(B,X){if(rr(B)!=="object"||B===null)return B;var ce=B[Symbol.toPrimitive];if(ce!==void 0){var pe=ce.call(B,"string");if(rr(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(B)}(_.key),rr(R)==="symbol"?R:String(R)),_)}var R}var Do=function(){function x(_){var R=this;(function(B,X){if(!(B instanceof X))throw new TypeError("Cannot call a class as a function")})(this,x),this.container=_.template.infoPanel,this.template=_.template,this.video=_.video,this.player=_,this.template.infoPanelClose.addEventListener("click",function(){R.hide()})}var L,q;return L=x,(q=[{key:"show",value:function(){this.beginTime=Date.now(),this.update(),this.player.timer.enable("info"),this.player.timer.enable("fps"),this.container.classList.remove("dplayer-info-panel-hide")}},{key:"hide",value:function(){this.player.timer.disable("info"),this.player.timer.disable("fps"),this.container.classList.add("dplayer-info-panel-hide")}},{key:"triggle",value:function(){this.container.classList.contains("dplayer-info-panel-hide")?this.show():this.hide()}},{key:"update",value:function(){this.template.infoVersion.innerHTML="v".concat("1.27.1"," ").concat("v1.27.0-12-g4f61091"),this.template.infoType.innerHTML=this.player.type,this.template.infoUrl.innerHTML=this.player.options.video.url,this.template.infoResolution.innerHTML="".concat(this.player.video.videoWidth," x ").concat(this.player.video.videoHeight),this.template.infoDuration.innerHTML=this.player.video.duration,this.player.options.danmaku&&(this.template.infoDanmakuId.innerHTML=this.player.options.danmaku.id,this.template.infoDanmakuApi.innerHTML=this.player.options.danmaku.api,this.template.infoDanmakuAmount.innerHTML=this.player.danmaku.dan.length)}},{key:"fps",value:function(_){this.template.infoFPS.innerHTML="".concat(_.toFixed(1))}}])&&Ga(L.prototype,q),Object.defineProperty(L,"prototype",{writable:!1}),x}();const $t=Do;var _n=_e(568),Es=_e.n(_n);function Yn(x){return Yn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},Yn(x)}function Br(x,L){var q=Object.keys(x);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(x);L&&(_=_.filter(function(R){return Object.getOwnPropertyDescriptor(x,R).enumerable})),q.push.apply(q,_)}return q}function ga(x,L,q){return(L=ns(L))in x?Object.defineProperty(x,L,{value:q,enumerable:!0,configurable:!0,writable:!0}):x[L]=q,x}function Mr(x,L){for(var q=0;q<L.length;q++){var _=L[q];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(x,ns(_.key),_)}}function ns(x){var L=function(q,_){if(Yn(q)!=="object"||q===null)return q;var R=q[Symbol.toPrimitive];if(R!==void 0){var B=R.call(q,"string");if(Yn(B)!=="object")return B;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(q)}(x);return Yn(L)==="symbol"?L:String(L)}var _r=0,Fr=[],Rn=function(){function x(R){var B=this;(function(X,ce){if(!(X instanceof ce))throw new TypeError("Cannot call a class as a function")})(this,x),this.options=function(X){var ce={container:X.element||document.getElementsByClassName("dplayer")[0],live:!1,autoplay:!1,theme:"#b7daff",loop:!1,lang:(navigator.language||navigator.browserLanguage).toLowerCase(),screenshot:!1,airplay:!0,chromecast:!1,hotkey:!0,preload:"metadata",volume:.7,playbackSpeed:[.5,.75,1,1.25,1.5,2],apiBackend:sl,video:{},contextmenu:[],mutex:!0,pluginOptions:{hls:{},flv:{},dash:{},webtorrent:{}},preventClickToggle:!1};for(var pe in ce)ce.hasOwnProperty(pe)&&!X.hasOwnProperty(pe)&&(X[pe]=ce[pe]);return X.video&&!X.video.type&&(X.video.type="auto"),Ba(X.danmaku)==="object"&&X.danmaku&&!X.danmaku.user&&(X.danmaku.user="DIYgod"),X.subtitle&&(!X.subtitle.type&&(X.subtitle.type="webvtt"),!X.subtitle.fontSize&&(X.subtitle.fontSize="20px"),!X.subtitle.bottom&&(X.subtitle.bottom="40px"),!X.subtitle.color&&(X.subtitle.color="#fff")),X.video.quality&&(X.video.url=X.video.quality[X.video.defaultQuality].url),X.lang&&(X.lang=X.lang.toLowerCase()),X.contextmenu=X.contextmenu.concat([{key:"video-info",click:function(Ue){Ue.infoPanel.triggle()}},{key:"about-author",link:"https://diygod.me"},{text:"DPlayer v".concat("1.27.1"),link:"https://github.com/MoePlayer/DPlayer"}]),X}(function(X){for(var ce=1;ce<arguments.length;ce++){var pe=arguments[ce]!=null?arguments[ce]:{};ce%2?Br(Object(pe),!0).forEach(function(Ue){ga(X,Ue,pe[Ue])}):Object.getOwnPropertyDescriptors?Object.defineProperties(X,Object.getOwnPropertyDescriptors(pe)):Br(Object(pe)).forEach(function(Ue){Object.defineProperty(X,Ue,Object.getOwnPropertyDescriptor(pe,Ue))})}return X}({preload:R.video.type==="webtorrent"?"none":"metadata"},R)),this.options.video.quality&&(this.qualityIndex=this.options.video.defaultQuality,this.quality=this.options.video.quality[this.options.video.defaultQuality]),this.tran=new al(this.options.lang).tran,this.events=new ni,this.user=new Ar(this),this.container=this.options.container,this.noticeList={},this.container.classList.add("dplayer"),this.options.danmaku||this.container.classList.add("dplayer-no-danmaku"),this.options.live?this.container.classList.add("dplayer-live"):this.container.classList.remove("dplayer-live"),ke.isMobile&&this.container.classList.add("dplayer-mobile"),this.arrow=this.container.offsetWidth<=500,this.arrow&&this.container.classList.add("dplayer-arrow"),this.options.subtitle&&Array.isArray(this.options.subtitle.url)&&(this.options.subtitle.url.push({subtitle:"",lang:"off"}),this.options.subtitle.defaultSubtitle&&(typeof this.options.subtitle.defaultSubtitle=="string"?this.options.subtitle.index=this.options.subtitle.url.findIndex(function(X){return X.lang===B.options.subtitle.defaultSubtitle||X.name===B.options.subtitle.defaultSubtitle}):typeof this.options.subtitle.defaultSubtitle=="number"&&(this.options.subtitle.index=this.options.subtitle.defaultSubtitle)),(this.options.subtitle.index===-1||!this.options.subtitle.index||this.options.subtitle.index>this.options.subtitle.url.length-1)&&(this.options.subtitle.index=this.options.subtitle.url.findIndex(function(X){return X.lang===B.options.lang})),this.options.subtitle.index===-1&&(this.options.subtitle.index=this.options.subtitle.url.length-1)),this.template=new bo({container:this.container,options:this.options,index:_r,tran:this.tran}),this.video=this.template.video,this.bar=new ri(this.template),this.bezel=new vn(this.template.bezel),this.fullScreen=new $a(this),this.controller=new ts(this),this.options.danmaku&&(this.danmaku=new xo({player:this,container:this.template.danmaku,opacity:this.user.get("opacity"),callback:function(){setTimeout(function(){B.template.danmakuLoading.style.display="none",B.options.autoplay&&B.play()},0)},error:function(X){B.notice(X)},apiBackend:this.options.apiBackend,borderColor:this.options.theme,height:this.arrow?24:30,time:function(){return B.video.currentTime},unlimited:this.user.get("unlimited"),api:{id:this.options.danmaku.id,address:this.options.danmaku.api,token:this.options.danmaku.token,maximum:this.options.danmaku.maximum,addition:this.options.danmaku.addition,user:this.options.danmaku.user,speedRate:this.options.danmaku.speedRate},events:this.events,tran:function(X){return B.tran(X)}}),this.comment=new pa(this)),this.setting=new Lo(this),this.plugins={},this.docClickFun=function(){B.focus=!1},this.containerClickFun=function(){B.focus=!0},document.addEventListener("click",this.docClickFun,!0),this.container.addEventListener("click",this.containerClickFun,!0),this.paused=!0,this.timer=new gs(this),this.hotkey=new Gs(this),this.contextmenu=new xs(this),this.initVideo(this.video,this.quality&&this.quality.type||this.options.video.type),this.infoPanel=new $t(this),!this.danmaku&&this.options.autoplay&&this.play(),_r++,Fr.push(this)}var L,q,_;return L=x,q=[{key:"seek",value:function(R){R=Math.max(R,0),this.video.duration&&(R=Math.min(R,this.video.duration)),this.video.currentTime<R?this.notice("".concat(this.tran("ff").replace("%s",(R-this.video.currentTime).toFixed(0)))):this.video.currentTime>R&&this.notice("".concat(this.tran("rew").replace("%s",(this.video.currentTime-R).toFixed(0)))),this.video.currentTime=R,this.danmaku&&this.danmaku.seek(),this.bar.set("played",R/this.video.duration,"width"),this.template.ptime.innerHTML=ke.secondToTime(R)}},{key:"play",value:function(R){var B=this;if(this.paused=!1,this.video.paused&&!ke.isMobile&&this.bezel.switch(jn.play),this.template.playButton.innerHTML=jn.pause,this.template.mobilePlayButton.innerHTML=jn.pause,R||Ce.resolve(this.video.play()).catch(function(){B.pause()}).then(function(){}),this.timer.enable("loading"),this.container.classList.remove("dplayer-paused"),this.container.classList.add("dplayer-playing"),this.danmaku&&this.danmaku.play(),this.options.mutex)for(var X=0;X<Fr.length;X++)this!==Fr[X]&&Fr[X].pause()}},{key:"pause",value:function(R){this.paused=!0,this.container.classList.remove("dplayer-loading"),this.video.paused||ke.isMobile||this.bezel.switch(jn.pause),this.template.playButton.innerHTML=jn.play,this.template.mobilePlayButton.innerHTML=jn.play,R||this.video.pause(),this.timer.disable("loading"),this.container.classList.remove("dplayer-playing"),this.container.classList.add("dplayer-paused"),this.danmaku&&this.danmaku.pause()}},{key:"switchVolumeIcon",value:function(){this.volume()>=.95?this.template.volumeIcon.innerHTML=jn.volumeUp:this.volume()>0?this.template.volumeIcon.innerHTML=jn.volumeDown:this.template.volumeIcon.innerHTML=jn.volumeOff}},{key:"volume",value:function(R,B,X){if(R=parseFloat(R),!isNaN(R)){R=Math.max(R,0),R=Math.min(R,1),this.bar.set("volume",R,"width");var ce="".concat((100*R).toFixed(0),"%");this.template.volumeBarWrapWrap.dataset.balloon=ce,B||this.user.set("volume",R),X||this.notice("".concat(this.tran("volume")," ").concat((100*R).toFixed(0),"%"),void 0,void 0,"volume"),this.video.volume=R,this.video.muted&&(this.video.muted=!1),this.switchVolumeIcon()}return this.video.volume}},{key:"toggle",value:function(){this.video.paused?this.play():this.pause()}},{key:"on",value:function(R,B){this.events.on(R,B)}},{key:"switchVideo",value:function(R,B){this.pause(),this.video.poster=R.pic?R.pic:"",this.video.src=R.url,this.initMSE(this.video,R.type||"auto"),B&&(this.template.danmakuLoading.style.display="block",this.bar.set("played",0,"width"),this.bar.set("loaded",0,"width"),this.template.ptime.innerHTML="00:00",this.template.danmaku.innerHTML="",this.danmaku&&this.danmaku.reload({id:B.id,address:B.api,token:B.token,maximum:B.maximum,addition:B.addition,user:B.user}))}},{key:"initMSE",value:function(R,B){var X=this;if(this.type=B,this.options.video.customType&&this.options.video.customType[B])Object.prototype.toString.call(this.options.video.customType[B])==="[object Function]"?this.options.video.customType[B](this.video,this):console.error("Illegal customType: ".concat(B));else switch(this.type==="auto"&&(/m3u8(#|\?|$)/i.exec(R.src)?this.type="hls":/.flv(#|\?|$)/i.exec(R.src)?this.type="flv":/.mpd(#|\?|$)/i.exec(R.src)?this.type="dash":this.type="normal"),this.type==="hls"&&(R.canPlayType("application/x-mpegURL")||R.canPlayType("application/vnd.apple.mpegURL"))&&(this.type="normal"),this.type){case"hls":if(window.Hls)if(window.Hls.isSupported()){var ce=this.options.pluginOptions.hls,pe=new window.Hls(ce);this.plugins.hls=pe,pe.loadSource(R.src),pe.attachMedia(R),this.events.on("destroy",function(){pe.destroy(),delete X.plugins.hls})}else this.notice("Error: Hls is not supported.");else this.notice("Error: Can't find Hls.");break;case"flv":if(window.flvjs)if(window.flvjs.isSupported()){var Ue=window.flvjs.createPlayer(Object.assign(this.options.pluginOptions.flv.mediaDataSource||{},{type:"flv",url:R.src}),this.options.pluginOptions.flv.config);this.plugins.flvjs=Ue,Ue.attachMediaElement(R),Ue.load(),this.events.on("destroy",function(){Ue.unload(),Ue.detachMediaElement(),Ue.destroy(),delete X.plugins.flvjs})}else this.notice("Error: flvjs is not supported.");else this.notice("Error: Can't find flvjs.");break;case"dash":if(window.dashjs){var He=window.dashjs.MediaPlayer().create().initialize(R,R.src,!1),yt=this.options.pluginOptions.dash;He.updateSettings(yt),this.plugins.dash=He,this.events.on("destroy",function(){window.dashjs.MediaPlayer().reset(),delete X.plugins.dash})}else this.notice("Error: Can't find dashjs.");break;case"webtorrent":if(window.WebTorrent)if(window.WebTorrent.WEBRTC_SUPPORT){this.container.classList.add("dplayer-loading");var At=this.options.pluginOptions.webtorrent,Dt=new window.WebTorrent(At);this.plugins.webtorrent=Dt;var Et=R.src;R.src="",R.preload="metadata",R.addEventListener("durationchange",function(){return X.container.classList.remove("dplayer-loading")},{once:!0}),Dt.add(Et,function(vt){vt.files.find(function(Bt){return Bt.name.endsWith(".mp4")}).renderTo(X.video,{autoplay:X.options.autoplay,controls:!1})}),this.events.on("destroy",function(){Dt.remove(Et),Dt.destroy(),delete X.plugins.webtorrent})}else this.notice("Error: Webtorrent is not supported.");else this.notice("Error: Can't find Webtorrent.")}}},{key:"initVideo",value:function(R,B){var X=this;this.initMSE(R,B),this.on("durationchange",function(){R.duration!==1&&R.duration!==1/0&&(X.template.dtime.innerHTML=ke.secondToTime(R.duration))}),this.on("progress",function(){var Ue=R.buffered.length?R.buffered.end(R.buffered.length-1)/R.duration:0;X.bar.set("loaded",Ue,"width")}),this.on("error",function(){X.video.error&&X.tran&&X.notice&&X.type!=="webtorrent"&&X.notice(X.tran("video-failed"))}),this.on("ended",function(){X.bar.set("played",1,"width"),X.setting.loop?(X.seek(0),X.play()):X.pause(),X.danmaku&&(X.danmaku.danIndex=0)}),this.on("play",function(){X.paused&&X.play(!0)}),this.on("pause",function(){X.paused||X.pause(!0)}),this.on("timeupdate",function(){X.bar.set("played",X.video.currentTime/X.video.duration,"width");var Ue=ke.secondToTime(X.video.currentTime);X.template.ptime.innerHTML!==Ue&&(X.template.ptime.innerHTML=Ue)});for(var ce=function(Ue){R.addEventListener(X.events.videoEvents[Ue],function(He){X.events.trigger(X.events.videoEvents[Ue],He)})},pe=0;pe<this.events.videoEvents.length;pe++)ce(pe);this.volume(this.user.get("volume"),!0,!0),this.options.subtitle&&(this.subtitle=new El(this.template.subtitle,this.video,this.options.subtitle,this.events),Array.isArray(this.options.subtitle.url)&&(this.subtitles=new Vs(this)),this.user.get("subtitle")||this.subtitle.hide())}},{key:"switchQuality",value:function(R){var B=this;if(R=typeof R=="string"?parseInt(R):R,this.qualityIndex!==R&&!this.switchingQuality){this.prevIndex=this.qualityIndex,this.qualityIndex=R,this.switchingQuality=!0,this.quality=this.options.video.quality[R],this.template.qualityButton.innerHTML=this.quality.name;var X=this.video.paused;this.video.pause();var ce=Es()({current:!1,pic:null,screenshot:this.options.screenshot,preload:"auto",url:this.quality.url,subtitle:this.options.subtitle}),pe=new DOMParser().parseFromString(ce,"text/html").body.firstChild;this.template.videoWrap.insertBefore(pe,this.template.videoWrap.getElementsByTagName("div")[0]),this.prevVideo=this.video,this.video=pe,this.initVideo(this.video,this.quality.type||this.options.video.type),this.seek(this.prevVideo.currentTime),this.notice("".concat(this.tran("switching-quality").replace("%q",this.quality.name)),-1,void 0,"switch-quality"),this.events.trigger("quality_start",this.quality),this.on("canplay",function(){if(B.prevVideo){if(B.video.currentTime!==B.prevVideo.currentTime)return void B.seek(B.prevVideo.currentTime);B.template.videoWrap.removeChild(B.prevVideo),B.video.classList.add("dplayer-video-current"),X||B.video.play(),B.prevVideo=null,B.notice("".concat(B.tran("switched-quality").replace("%q",B.quality.name)),void 0,void 0,"switch-quality"),B.switchingQuality=!1,B.events.trigger("quality_end")}}),this.on("error",function(){B.video.error&&B.prevVideo&&(B.template.videoWrap.removeChild(B.video),B.video=B.prevVideo,X||B.video.play(),B.qualityIndex=B.prevIndex,B.quality=B.options.video.quality[B.qualityIndex],B.noticeTime=setTimeout(function(){B.template.notice.style.opacity=0,B.events.trigger("notice_hide")},3e3),B.prevVideo=null,B.switchingQuality=!1)})}}},{key:"notice",value:function(R){var B,X,ce,pe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2e3,Ue=arguments.length>2&&arguments[2]!==void 0?arguments[2]:.8,He=arguments.length>3?arguments[3]:void 0;if(He&&((B=document.getElementById("dplayer-notice-".concat(He)))&&(B.innerHTML=R),this.noticeList[He]&&(clearTimeout(this.noticeList[He]),this.noticeList[He]=null)),!B){var yt=bo.NewNotice(R,Ue,He);this.template.noticeList.appendChild(yt),B=yt}this.events.trigger("notice_show",B),pe>0&&(this.noticeList[He]=setTimeout((X=B,ce=this,function(){X.addEventListener("animationend",function(){ce.template.noticeList.removeChild(X)}),X.classList.add("remove-notice"),ce.events.trigger("notice_hide"),ce.noticeList[He]=null}),pe))}},{key:"resize",value:function(){this.danmaku&&this.danmaku.resize(),this.controller.thumbnails&&this.controller.thumbnails.resize(160,this.video.videoHeight/this.video.videoWidth*160,this.template.barWrap.offsetWidth),this.events.trigger("resize")}},{key:"speed",value:function(R){this.video.playbackRate=R}},{key:"destroy",value:function(){Fr.splice(Fr.indexOf(this),1),this.pause(),document.removeEventListener("click",this.docClickFun,!0),this.container.removeEventListener("click",this.containerClickFun,!0),this.fullScreen.destroy(),this.hotkey.destroy(),this.contextmenu.destroy(),this.controller.destroy(),this.timer.destroy(),this.video.src="",this.container.innerHTML="",this.events.trigger("destroy")}}],_=[{key:"version",get:function(){return"1.27.1"}}],q&&Mr(L.prototype,q),_&&Mr(L,_),Object.defineProperty(L,"prototype",{writable:!1}),x}();const Ve=Rn;console.log(`
`.concat(" %c DPlayer v","1.27.1"," ").concat("v1.27.0-12-g4f61091"," %c https://dplayer.diygod.dev ",`
`,`
`),"color: #fadfa3; background: #030307; padding:5px 0;","background: #fadfa3; padding:5px 0;");const qa=Ve})(),tt.default})())},70915:function(Kt,Mt,ft){var lt=typeof ft.g!="undefined"?ft.g:typeof window!="undefined"?window:{},ae=ft(67355),Ze;typeof document!="undefined"?Ze=document:(Ze=lt["__GLOBAL_DOCUMENT_CACHE@4"],Ze||(Ze=lt["__GLOBAL_DOCUMENT_CACHE@4"]=ae)),Kt.exports=Ze},60288:function(Kt,Mt,ft){var lt;typeof window!="undefined"?lt=window:typeof ft.g!="undefined"?lt=ft.g:typeof self!="undefined"?lt=self:lt={},Kt.exports=lt},37670:function(Kt,Mt,ft){"use strict";ft.d(Mt,{Z:function(){return ln}});function lt(f){return f&&f.__esModule&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f}var ae={exports:{}};(function(f,t){(function(n){var a=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,l=/^(?=([^\/?#]*))\1([^]*)$/,u=/(?:\/|^)\.(?=\/)/g,c=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,p={buildAbsoluteURL:function(v,A,C){if(C=C||{},v=v.trim(),A=A.trim(),!A){if(!C.alwaysNormalize)return v;var O=p.parseURL(v);if(!O)throw new Error("Error trying to parse base URL.");return O.path=p.normalizePath(O.path),p.buildURLFromParts(O)}var U=p.parseURL(A);if(!U)throw new Error("Error trying to parse relative URL.");if(U.scheme)return C.alwaysNormalize?(U.path=p.normalizePath(U.path),p.buildURLFromParts(U)):A;var W=p.parseURL(v);if(!W)throw new Error("Error trying to parse base URL.");if(!W.netLoc&&W.path&&W.path[0]!=="/"){var J=l.exec(W.path);W.netLoc=J[1],W.path=J[2]}W.netLoc&&!W.path&&(W.path="/");var oe={scheme:W.scheme,netLoc:U.netLoc,path:null,params:U.params,query:U.query,fragment:U.fragment};if(!U.netLoc&&(oe.netLoc=W.netLoc,U.path[0]!=="/"))if(!U.path)oe.path=W.path,U.params||(oe.params=W.params,U.query||(oe.query=W.query));else{var he=W.path,we=he.substring(0,he.lastIndexOf("/")+1)+U.path;oe.path=p.normalizePath(we)}return oe.path===null&&(oe.path=C.alwaysNormalize?p.normalizePath(U.path):U.path),p.buildURLFromParts(oe)},parseURL:function(v){var A=a.exec(v);return A?{scheme:A[1]||"",netLoc:A[2]||"",path:A[3]||"",params:A[4]||"",query:A[5]||"",fragment:A[6]||""}:null},normalizePath:function(v){for(v=v.split("").reverse().join("").replace(u,"");v.length!==(v=v.replace(c,"")).length;);return v.split("").reverse().join("")},buildURLFromParts:function(v){return v.scheme+v.netLoc+v.path+v.params+v.query+v.fragment}};f.exports=p})()})(ae);var Ze=ae.exports;function _e(f,t){var n=Object.keys(f);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(f);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(f,l).enumerable})),n.push.apply(n,a)}return n}function tt(f){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?_e(Object(n),!0).forEach(function(a){fe(f,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach(function(a){Object.defineProperty(f,a,Object.getOwnPropertyDescriptor(n,a))})}return f}function fe(f,t,n){return t=se(t),t in f?Object.defineProperty(f,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):f[t]=n,f}function Ee(){return Ee=Object.assign?Object.assign.bind():function(f){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(f[a]=n[a])}return f},Ee.apply(this,arguments)}function ye(f,t){if(typeof f!="object"||f===null)return f;var n=f[Symbol.toPrimitive];if(n!==void 0){var a=n.call(f,t||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(f)}function se(f){var t=ye(f,"string");return typeof t=="symbol"?t:String(t)}const te=Number.isFinite||function(f){return typeof f=="number"&&isFinite(f)},Q=Number.isSafeInteger||function(f){return typeof f=="number"&&Math.abs(f)<=w},w=Number.MAX_SAFE_INTEGER||9007199254740991;let y=function(f){return f.MEDIA_ATTACHING="hlsMediaAttaching",f.MEDIA_ATTACHED="hlsMediaAttached",f.MEDIA_DETACHING="hlsMediaDetaching",f.MEDIA_DETACHED="hlsMediaDetached",f.BUFFER_RESET="hlsBufferReset",f.BUFFER_CODECS="hlsBufferCodecs",f.BUFFER_CREATED="hlsBufferCreated",f.BUFFER_APPENDING="hlsBufferAppending",f.BUFFER_APPENDED="hlsBufferAppended",f.BUFFER_EOS="hlsBufferEos",f.BUFFER_FLUSHING="hlsBufferFlushing",f.BUFFER_FLUSHED="hlsBufferFlushed",f.MANIFEST_LOADING="hlsManifestLoading",f.MANIFEST_LOADED="hlsManifestLoaded",f.MANIFEST_PARSED="hlsManifestParsed",f.LEVEL_SWITCHING="hlsLevelSwitching",f.LEVEL_SWITCHED="hlsLevelSwitched",f.LEVEL_LOADING="hlsLevelLoading",f.LEVEL_LOADED="hlsLevelLoaded",f.LEVEL_UPDATED="hlsLevelUpdated",f.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",f.LEVELS_UPDATED="hlsLevelsUpdated",f.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",f.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",f.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",f.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",f.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",f.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",f.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",f.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",f.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",f.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",f.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",f.CUES_PARSED="hlsCuesParsed",f.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",f.INIT_PTS_FOUND="hlsInitPtsFound",f.FRAG_LOADING="hlsFragLoading",f.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",f.FRAG_LOADED="hlsFragLoaded",f.FRAG_DECRYPTED="hlsFragDecrypted",f.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",f.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",f.FRAG_PARSING_METADATA="hlsFragParsingMetadata",f.FRAG_PARSED="hlsFragParsed",f.FRAG_BUFFERED="hlsFragBuffered",f.FRAG_CHANGED="hlsFragChanged",f.FPS_DROP="hlsFpsDrop",f.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",f.ERROR="hlsError",f.DESTROYING="hlsDestroying",f.KEY_LOADING="hlsKeyLoading",f.KEY_LOADED="hlsKeyLoaded",f.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",f.BACK_BUFFER_REACHED="hlsBackBufferReached",f}({}),$=function(f){return f.NETWORK_ERROR="networkError",f.MEDIA_ERROR="mediaError",f.KEY_SYSTEM_ERROR="keySystemError",f.MUX_ERROR="muxError",f.OTHER_ERROR="otherError",f}({}),D=function(f){return f.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",f.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",f.KEY_SYSTEM_NO_SESSION="keySystemNoSession",f.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",f.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",f.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",f.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",f.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",f.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",f.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",f.MANIFEST_LOAD_ERROR="manifestLoadError",f.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",f.MANIFEST_PARSING_ERROR="manifestParsingError",f.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",f.LEVEL_EMPTY_ERROR="levelEmptyError",f.LEVEL_LOAD_ERROR="levelLoadError",f.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",f.LEVEL_PARSING_ERROR="levelParsingError",f.LEVEL_SWITCH_ERROR="levelSwitchError",f.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",f.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",f.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",f.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",f.FRAG_LOAD_ERROR="fragLoadError",f.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",f.FRAG_DECRYPT_ERROR="fragDecryptError",f.FRAG_PARSING_ERROR="fragParsingError",f.FRAG_GAP="fragGap",f.REMUX_ALLOC_ERROR="remuxAllocError",f.KEY_LOAD_ERROR="keyLoadError",f.KEY_LOAD_TIMEOUT="keyLoadTimeOut",f.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",f.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",f.BUFFER_APPEND_ERROR="bufferAppendError",f.BUFFER_APPENDING_ERROR="bufferAppendingError",f.BUFFER_STALLED_ERROR="bufferStalledError",f.BUFFER_FULL_ERROR="bufferFullError",f.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",f.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",f.INTERNAL_EXCEPTION="internalException",f.INTERNAL_ABORTED="aborted",f.UNKNOWN="unknown",f}({});const G=function(){},z={trace:G,debug:G,log:G,warn:G,info:G,error:G};let P=z;function H(f){const t=self.console[f];return t?t.bind(self.console,`[${f}] >`):G}function j(f,...t){t.forEach(function(n){P[n]=f[n]?f[n].bind(f):H(n)})}function V(f,t){if(self.console&&f===!0||typeof f=="object"){j(f,"debug","log","info","warn","error");try{P.log(`Debug logs enabled for "${t}" in hls.js version 1.4.13`)}catch(n){P=z}}else P=z}const T=P,Z=/^(\d+)x(\d+)$/,ie=/(.+?)=(".*?"|.*?)(?:,|$)/g;class le{constructor(t){typeof t=="string"&&(t=le.parseAttrList(t));for(const n in t)t.hasOwnProperty(n)&&(n.substring(0,2)==="X-"&&(this.clientAttrs=this.clientAttrs||[],this.clientAttrs.push(n)),this[n]=t[n])}decimalInteger(t){const n=parseInt(this[t],10);return n>Number.MAX_SAFE_INTEGER?Infinity:n}hexadecimalInteger(t){if(this[t]){let n=(this[t]||"0x").slice(2);n=(n.length&1?"0":"")+n;const a=new Uint8Array(n.length/2);for(let l=0;l<n.length/2;l++)a[l]=parseInt(n.slice(l*2,l*2+2),16);return a}else return null}hexadecimalIntegerAsNumber(t){const n=parseInt(this[t],16);return n>Number.MAX_SAFE_INTEGER?Infinity:n}decimalFloatingPoint(t){return parseFloat(this[t])}optionalFloat(t,n){const a=this[t];return a?parseFloat(a):n}enumeratedString(t){return this[t]}bool(t){return this[t]==="YES"}decimalResolution(t){const n=Z.exec(this[t]);if(n!==null)return{width:parseInt(n[1],10),height:parseInt(n[2],10)}}static parseAttrList(t){let n;const a={},l='"';for(ie.lastIndex=0;(n=ie.exec(t))!==null;){let u=n[2];u.indexOf(l)===0&&u.lastIndexOf(l)===u.length-1&&(u=u.slice(1,-1));const c=n[1].trim();a[c]=u}return a}}function F(f){return f!=="ID"&&f!=="CLASS"&&f!=="START-DATE"&&f!=="DURATION"&&f!=="END-DATE"&&f!=="END-ON-NEXT"}function K(f){return f==="SCTE35-OUT"||f==="SCTE35-IN"}class ne{constructor(t,n){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,n){const a=n.attr;for(const l in a)if(Object.prototype.hasOwnProperty.call(t,l)&&t[l]!==a[l]){T.warn(`DATERANGE tag attribute: "${l}" does not match for tags with ID: "${t.ID}"`),this._badValueForSameId=l;break}t=Ee(new le({}),a,t)}if(this.attr=t,this._startDate=new Date(t["START-DATE"]),"END-DATE"in this.attr){const a=new Date(this.attr["END-DATE"]);te(a.getTime())&&(this._endDate=a)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const t=this.duration;return t!==null?new Date(this._startDate.getTime()+t*1e3):null}get duration(){if("DURATION"in this.attr){const t=this.attr.decimalFloatingPoint("DURATION");if(te(t))return t}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&te(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class de{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var ve={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class De{constructor(t){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[ve.AUDIO]:null,[ve.VIDEO]:null,[ve.AUDIOVIDEO]:null},this.baseurl=t}setByteRange(t,n){const a=t.split("@",2),l=[];a.length===1?l[0]=n?n.byteRangeEndOffset:0:l[0]=parseInt(a[1]),l[1]=parseInt(a[0])+l[0],this._byteRange=l}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Ze.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(t){this._url=t}}class Se extends De{constructor(t,n){super(n);this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new de,this.urlId=0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.type=t}get decryptdata(){const{levelkeys:t}=this;if(!t&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const n=this.levelkeys.identity;if(n)this._decryptdata=n.getDecryptData(this.sn);else{const a=Object.keys(this.levelkeys);if(a.length===1)return this._decryptdata=this.levelkeys[a[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null||!te(this.programDateTime))return null;const t=te(this.duration)?this.duration:0;return this.programDateTime+t*1e3}get encrypted(){var t;if((t=this._decryptdata)!=null&&t.encrypted)return!0;if(this.levelkeys){const n=Object.keys(this.levelkeys),a=n.length;if(a>1||a===1&&this.levelkeys[n[0]].encrypted)return!0}return!1}setKeyFormat(t){if(this.levelkeys){const n=this.levelkeys[t];n&&!this._decryptdata&&(this._decryptdata=n.getDecryptData(this.sn))}}abortRequests(){var t,n;(t=this.loader)==null||t.abort(),(n=this.keyLoader)==null||n.abort()}setElementaryStreamInfo(t,n,a,l,u,c=!1){const{elementaryStreams:p}=this,v=p[t];if(!v){p[t]={startPTS:n,endPTS:a,startDTS:l,endDTS:u,partial:c};return}v.startPTS=Math.min(v.startPTS,n),v.endPTS=Math.max(v.endPTS,a),v.startDTS=Math.min(v.startDTS,l),v.endDTS=Math.max(v.endDTS,u)}clearElementaryStreamInfo(){const{elementaryStreams:t}=this;t[ve.AUDIO]=null,t[ve.VIDEO]=null,t[ve.AUDIOVIDEO]=null}}class Ce extends De{constructor(t,n,a,l,u){super(a);this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new de,this.duration=t.decimalFloatingPoint("DURATION"),this.gap=t.bool("GAP"),this.independent=t.bool("INDEPENDENT"),this.relurl=t.enumeratedString("URI"),this.fragment=n,this.index=l;const c=t.enumeratedString("BYTERANGE");c&&this.setByteRange(c,u),u&&(this.fragOffset=u.fragOffset+u.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:t}=this;return!!(t.audio||t.video||t.audiovideo)}}const Be=10;class ke{constructor(t){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=t}reloaded(t){if(!t){this.advanced=!0,this.updated=!0;return}const n=this.lastPartSn-t.lastPartSn,a=this.lastPartIndex-t.lastPartIndex;this.updated=this.endSN!==t.endSN||!!a||!!n||!this.live,this.advanced=this.endSN>t.endSN||n>0||n===0&&a>0,this.updated||this.advanced?this.misses=Math.floor(t.misses*.6):this.misses=t.misses+1,this.availabilityDelay=t.availabilityDelay}get hasProgramDateTime(){return this.fragments.length?te(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||Be}get drift(){const t=this.driftEndTime-this.driftStartTime;return t>0?(this.driftEnd-this.driftStart)*1e3/t:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var t;return(t=this.partList)!=null&&t.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var t;return(t=this.fragments)!=null&&t.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var t;return(t=this.partList)!=null&&t.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var t;return(t=this.partList)!=null&&t.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function Ne(f){return Uint8Array.from(atob(f),t=>t.charCodeAt(0))}function Re(f){const t=It(f).subarray(0,16),n=new Uint8Array(16);return n.set(t,16-t.length),n}function dt(f){const t=function(a,l,u){const c=a[l];a[l]=a[u],a[u]=c};t(f,0,3),t(f,1,2),t(f,4,5),t(f,6,7)}function wt(f){const t=f.split(":");let n=null;if(t[0]==="data"&&t.length===2){const a=t[1].split(";"),l=a[a.length-1].split(",");if(l.length===2){const u=l[0]==="base64",c=l[1];u?(a.splice(-1,1),n=Ne(c)):n=Re(c)}}return n}function It(f){return Uint8Array.from(unescape(encodeURIComponent(f)),t=>t.charCodeAt(0))}var nt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},ot={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function ti(f){switch(f){case ot.FAIRPLAY:return nt.FAIRPLAY;case ot.PLAYREADY:return nt.PLAYREADY;case ot.WIDEVINE:return nt.WIDEVINE;case ot.CLEARKEY:return nt.CLEARKEY}}var bt={WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function Vt(f){if(f===bt.WIDEVINE)return nt.WIDEVINE}function si(f){switch(f){case nt.FAIRPLAY:return ot.FAIRPLAY;case nt.PLAYREADY:return ot.PLAYREADY;case nt.WIDEVINE:return ot.WIDEVINE;case nt.CLEARKEY:return ot.CLEARKEY}}function Xt(f){const{drmSystems:t,widevineLicenseUrl:n}=f,a=t?[nt.FAIRPLAY,nt.WIDEVINE,nt.PLAYREADY,nt.CLEARKEY].filter(l=>!!t[l]):[];return!a[nt.WIDEVINE]&&n&&a.push(nt.WIDEVINE),a}const _i=function(){return typeof self!="undefined"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function yi(f,t,n,a){let l;switch(f){case nt.FAIRPLAY:l=["cenc","sinf"];break;case nt.WIDEVINE:case nt.PLAYREADY:l=["cenc"];break;case nt.CLEARKEY:l=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${f}`)}return xt(l,t,n,a)}function xt(f,t,n,a){return[{initDataTypes:f,persistentState:a.persistentState||"not-allowed",distinctiveIdentifier:a.distinctiveIdentifier||"not-allowed",sessionTypes:a.sessionTypes||[a.sessionType||"temporary"],audioCapabilities:t.map(u=>({contentType:`audio/mp4; codecs="${u}"`,robustness:a.audioRobustness||"",encryptionScheme:a.audioEncryptionScheme||null})),videoCapabilities:n.map(u=>({contentType:`video/mp4; codecs="${u}"`,robustness:a.videoRobustness||"",encryptionScheme:a.videoEncryptionScheme||null}))}]}function Qt(f,t,n){return Uint8Array.prototype.slice?f.slice(t,n):new Uint8Array(Array.prototype.slice.call(f,t,n))}const li=(f,t)=>t+10<=f.length&&f[t]===73&&f[t+1]===68&&f[t+2]===51&&f[t+3]<255&&f[t+4]<255&&f[t+6]<128&&f[t+7]<128&&f[t+8]<128&&f[t+9]<128,Ki=(f,t)=>t+10<=f.length&&f[t]===51&&f[t+1]===68&&f[t+2]===73&&f[t+3]<255&&f[t+4]<255&&f[t+6]<128&&f[t+7]<128&&f[t+8]<128&&f[t+9]<128,Ji=(f,t)=>{const n=t;let a=0;for(;li(f,t);)a+=10,a+=$i(f,t+6),Ki(f,t+10)&&(a+=10),t+=a;if(a>0)return f.subarray(n,n+a)},$i=(f,t)=>{let n=0;return n=(f[t]&127)<<21,n|=(f[t+1]&127)<<14,n|=(f[t+2]&127)<<7,n|=f[t+3]&127,n},cn=(f,t)=>li(f,t)&&$i(f,t+6)+10<=f.length-t,sn=f=>{const t=xi(f);for(let n=0;n<t.length;n++){const a=t[n];if(pt(a))return Zi(a)}},pt=f=>f&&f.key==="PRIV"&&f.info==="com.apple.streaming.transportStreamTimestamp",vi=f=>{const t=String.fromCharCode(f[0],f[1],f[2],f[3]),n=$i(f,4),a=10;return{type:t,size:n,data:f.subarray(a,a+n)}},xi=f=>{let t=0;const n=[];for(;li(f,t);){const a=$i(f,t+6);t+=10;const l=t+a;for(;t+8<l;){const u=vi(f.subarray(t)),c=oi(u);c&&n.push(c),t+=u.size+10}Ki(f,t)&&(t+=10)}return n},oi=f=>f.type==="PRIV"?kn(f):f.type[0]==="W"?Is(f):Gr(f),kn=f=>{if(f.size<2)return;const t=Tn(f.data,!0),n=new Uint8Array(f.data.subarray(t.length+1));return{key:f.type,info:t,data:n.buffer}},Gr=f=>{if(f.size<2)return;if(f.type==="TXXX"){let n=1;const a=Tn(f.data.subarray(n),!0);n+=a.length+1;const l=Tn(f.data.subarray(n));return{key:f.type,info:a,data:l}}const t=Tn(f.data.subarray(1));return{key:f.type,data:t}},Is=f=>{if(f.type==="WXXX"){if(f.size<2)return;let n=1;const a=Tn(f.data.subarray(n),!0);n+=a.length+1;const l=Tn(f.data.subarray(n));return{key:f.type,info:a,data:l}}const t=Tn(f.data);return{key:f.type,data:t}},Zi=f=>{if(f.data.byteLength===8){const t=new Uint8Array(f.data),n=t[3]&1;let a=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return a/=45,n&&(a+=4772185884e-2),Math.round(a)}},Tn=(f,t=!1)=>{const n=Le();if(n){const A=n.decode(f);if(t){const C=A.indexOf("\0");return C!==-1?A.substring(0,C):A}return A.replace(/\0/g,"")}const a=f.length;let l,u,c,p="",v=0;for(;v<a;){if(l=f[v++],l===0&&t)return p;if(l===0||l===3)continue;switch(l>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:p+=String.fromCharCode(l);break;case 12:case 13:u=f[v++],p+=String.fromCharCode((l&31)<<6|u&63);break;case 14:u=f[v++],c=f[v++],p+=String.fromCharCode((l&15)<<12|(u&63)<<6|(c&63)<<0);break}}return p};let Xe;function Le(){return!Xe&&typeof self.TextDecoder!="undefined"&&(Xe=new self.TextDecoder("utf-8")),Xe}const ht={hexDump:function(f){let t="";for(let n=0;n<f.length;n++){let a=f[n].toString(16);a.length<2&&(a="0"+a),t+=a}return t}},Rt=Math.pow(2,32)-1,Lt=[].push,Tt={video:1,audio:2,id3:3,text:4};function ii(f){return String.fromCharCode.apply(null,f)}function mn(f,t){const n=f[t]<<8|f[t+1];return n<0?65536+n:n}function Ut(f,t){const n=Bn(f,t);return n<0?4294967296+n:n}function Bn(f,t){return f[t]<<24|f[t+1]<<16|f[t+2]<<8|f[t+3]}function Wn(f,t,n){f[t]=n>>24,f[t+1]=n>>16&255,f[t+2]=n>>8&255,f[t+3]=n&255}function ai(f,t){const n=[];if(!t.length)return n;const a=f.byteLength;for(let l=0;l<a;){const u=Ut(f,l),c=ii(f.subarray(l+4,l+8)),p=u>1?l+u:a;if(c===t[0])if(t.length===1)n.push(f.subarray(l+8,p));else{const v=ai(f.subarray(l+8,p),t.slice(1));v.length&&Lt.apply(n,v)}l=p}return n}function qr(f){const t=[],n=f[0];let a=8;const l=Ut(f,a);a+=4;const u=0,c=0;n===0?a+=8:a+=16,a+=2;let p=f.length+c;const v=mn(f,a);a+=2;for(let A=0;A<v;A++){let C=a;const O=Ut(f,C);C+=4;const U=O&2147483647;if((O&2147483648)>>>31===1)return T.warn("SIDX has hierarchical references (not supported)"),null;const J=Ut(f,C);C+=4,t.push({referenceSize:U,subsegmentDuration:J,info:{duration:J/l,start:p,end:p+U-1}}),p+=U,C+=4,a=C}return{earliestPresentationTime:u,timescale:l,version:n,referencesCount:v,references:t}}function pr(f){const t=[],n=ai(f,["moov","trak"]);for(let l=0;l<n.length;l++){const u=n[l],c=ai(u,["tkhd"])[0];if(c){let p=c[0],v=p===0?12:20;const A=Ut(c,v),C=ai(u,["mdia","mdhd"])[0];if(C){p=C[0],v=p===0?12:20;const O=Ut(C,v),U=ai(u,["mdia","hdlr"])[0];if(U){const W=ii(U.subarray(8,12)),J={soun:ve.AUDIO,vide:ve.VIDEO}[W];if(J){const oe=ai(u,["mdia","minf","stbl","stsd"])[0];let he;oe&&(he=ii(oe.subarray(12,16))),t[A]={timescale:O,type:J},t[J]={timescale:O,id:A,codec:he}}}}}}return ai(f,["moov","mvex","trex"]).forEach(l=>{const u=Ut(l,4),c=t[u];c&&(c.default={duration:Ut(l,12),flags:Ut(l,20)})}),t}function Ri(f,t){if(!f||!t)return f;const n=t.keyId;return n&&t.isCommonEncryption&&ai(f,["moov","trak"]).forEach(l=>{const c=ai(l,["mdia","minf","stbl","stsd"])[0].subarray(8);let p=ai(c,["enca"]);const v=p.length>0;v||(p=ai(c,["encv"])),p.forEach(A=>{const C=v?A.subarray(28):A.subarray(78);ai(C,["sinf"]).forEach(U=>{const W=Wr(U);if(W){const J=W.subarray(8,24);J.some(oe=>oe!==0)||(T.log(`[eme] Patching keyId in 'enc${v?"a":"v"}>sinf>>tenc' box: ${ht.hexDump(J)} -> ${ht.hexDump(n)}`),W.set(n,8))}})})}),f}function Wr(f){const t=ai(f,["schm"])[0];if(t){const n=ii(t.subarray(4,8));if(n==="cbcs"||n==="cenc")return ai(f,["schi","tenc"])[0]}return T.error("[eme] missing 'schm' box"),null}function Rs(f,t){return ai(t,["moof","traf"]).reduce((n,a)=>{const l=ai(a,["tfdt"])[0],u=l[0],c=ai(a,["tfhd"]).reduce((p,v)=>{const A=Ut(v,4),C=f[A];if(C){let O=Ut(l,4);if(u===1){if(O===Rt)return T.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),p;O*=Rt+1,O+=Ut(l,8)}const U=C.timescale||9e4,W=O/U;if(te(W)&&(p===null||W<p))return W}return p},null);return c!==null&&te(c)&&(n===null||c<n)?c:n},null)}function mr(f,t){let n=0,a=0,l=0;const u=ai(f,["moof","traf"]);for(let c=0;c<u.length;c++){const p=u[c],v=ai(p,["tfhd"])[0],A=Ut(v,4),C=t[A];if(!C)continue;const O=C.default,U=Ut(v,0)|(O==null?void 0:O.flags);let W=O==null?void 0:O.duration;U&8&&(U&2?W=Ut(v,12):W=Ut(v,8));const J=C.timescale||9e4,oe=ai(p,["trun"]);for(let he=0;he<oe.length;he++){if(n=Kr(oe[he]),!n&&W){const we=Ut(oe[he],4);n=W*we}C.type===ve.VIDEO?a+=n/J:C.type===ve.AUDIO&&(l+=n/J)}}if(a===0&&l===0){let c=0;const p=ai(f,["sidx"]);for(let v=0;v<p.length;v++){const A=qr(p[v]);A!=null&&A.references&&(c+=A.references.reduce((C,O)=>C+O.info.duration||0,0))}return c}return a||l}function Kr(f){const t=Ut(f,0);let n=8;t&1&&(n+=4),t&4&&(n+=4);let a=0;const l=Ut(f,4);for(let u=0;u<l;u++)t&256&&(a+=Ut(f,n),n+=4),t&512&&(n+=4),t&1024&&(n+=4),t&2048&&(n+=4);return a}function Mn(f,t,n){ai(t,["moof","traf"]).forEach(a=>{ai(a,["tfhd"]).forEach(l=>{const u=Ut(l,4),c=f[u];if(!c)return;const p=c.timescale||9e4;ai(a,["tfdt"]).forEach(v=>{const A=v[0];let C=Ut(v,4);if(A===0)C-=n*p,C=Math.max(C,0),Wn(v,4,C);else{C*=Math.pow(2,32),C+=Ut(v,8),C-=n*p,C=Math.max(C,0);const O=Math.floor(C/(Rt+1)),U=Math.floor(C%(Rt+1));Wn(v,4,O),Wn(v,8,U)}})})})}function ea(f){const t={valid:null,remainder:null},n=ai(f,["moof"]);if(n){if(n.length<2)return t.remainder=f,t}else return t;const a=n[n.length-1];return t.valid=Qt(f,0,a.byteOffset-8),t.remainder=Qt(f,a.byteOffset-8),t}function hn(f,t){const n=new Uint8Array(f.length+t.length);return n.set(f),n.set(t,f.length),n}function tr(f,t){const n=[],a=t.samples,l=t.timescale,u=t.id;let c=!1;return ai(a,["moof"]).map(v=>{const A=v.byteOffset-8;ai(v,["traf"]).map(O=>{const U=ai(O,["tfdt"]).map(W=>{const J=W[0];let oe=Ut(W,4);return J===1&&(oe*=Math.pow(2,32),oe+=Ut(W,8)),oe/l})[0];return U!==void 0&&(f=U),ai(O,["tfhd"]).map(W=>{const J=Ut(W,4),oe=Ut(W,0)&16777215,he=(oe&1)!=0,we=(oe&2)!=0,Fe=(oe&8)!=0;let Me=0;const it=(oe&16)!=0;let We=0;const St=(oe&32)!=0;let ut=8;J===u&&(he&&(ut+=8),we&&(ut+=4),Fe&&(Me=Ut(W,ut),ut+=4),it&&(We=Ut(W,ut),ut+=4),St&&(ut+=4),t.type==="video"&&(c=ho(t.codec)),ai(O,["trun"]).map(gt=>{const Ct=gt[0],rt=Ut(gt,0)&16777215,qt=(rt&1)!=0;let Ot=0;const Si=(rt&4)!=0,Pn=(rt&256)!=0;let Pi=0;const Ni=(rt&512)!=0;let Ui=0;const Ft=(rt&1024)!=0,Wt=(rt&2048)!=0;let Ei=0;const wi=Ut(gt,4);let Ti=8;qt&&(Ot=Ut(gt,Ti),Ti+=4),Si&&(Ti+=4);let qi=Ot+A;for(let wn=0;wn<wi;wn++){if(Pn?(Pi=Ut(gt,Ti),Ti+=4):Pi=Me,Ni?(Ui=Ut(gt,Ti),Ti+=4):Ui=We,Ft&&(Ti+=4),Wt&&(Ct===0?Ei=Ut(gt,Ti):Ei=Bn(gt,Ti),Ti+=4),t.type===ve.VIDEO){let dr=0;for(;dr<Ui;){const xn=Ut(a,qi);if(qi+=4,ee(c,a[qi])){const Ss=a.subarray(qi,qi+xn);re(Ss,c?2:1,f+Ei/l,n)}qi+=xn,dr+=xn+4}}f+=Pi/l}}))})})}),n}function ho(f){if(!f)return!1;const t=f.indexOf("."),n=t<0?f:f.substring(0,t);return n==="hvc1"||n==="hev1"||n==="dvh1"||n==="dvhe"}function ee(f,t){if(f){const n=t>>1&63;return n===39||n===40}else return(t&31)===6}function re(f,t,n,a){const l=Te(f);let u=0;u+=t;let c=0,p=0,v=!1,A=0;for(;u<l.length;){c=0;do{if(u>=l.length)break;A=l[u++],c+=A}while(A===255);p=0;do{if(u>=l.length)break;A=l[u++],p+=A}while(A===255);const C=l.length-u;if(!v&&c===4&&u<l.length){if(v=!0,l[u++]===181){const U=mn(l,u);if(u+=2,U===49){const W=Ut(l,u);if(u+=4,W===1195456820){const J=l[u++];if(J===3){const oe=l[u++],he=31&oe,we=64&oe,Fe=we?2+he*3:0,Me=new Uint8Array(Fe);if(we){Me[0]=oe;for(let it=1;it<Fe;it++)Me[it]=l[u++]}a.push({type:J,payloadType:c,pts:n,bytes:Me})}}}}}else if(c===5&&p<C){if(v=!0,p>16){const O=[];for(let J=0;J<16;J++){const oe=l[u++].toString(16);O.push(oe.length==1?"0"+oe:oe),(J===3||J===5||J===7||J===9)&&O.push("-")}const U=p-16,W=new Uint8Array(U);for(let J=0;J<U;J++)W[J]=l[u++];a.push({payloadType:c,pts:n,uuid:O.join(""),userData:Tn(W),userDataBytes:W})}}else if(p<C)u+=p;else if(p>C)break}}function Te(f){const t=f.byteLength,n=[];let a=1;for(;a<t-2;)f[a]===0&&f[a+1]===0&&f[a+2]===3?(n.push(a+2),a+=2):a++;if(n.length===0)return f;const l=t-n.length,u=new Uint8Array(l);let c=0;for(a=0;a<l;c++,a++)c===n[0]&&(c++,n.shift()),u[a]=f[c];return u}function Ge(f){const t=f[0];let n="",a="",l=0,u=0,c=0,p=0,v=0,A=0;if(t===0){for(;ii(f.subarray(A,A+1))!=="\0";)n+=ii(f.subarray(A,A+1)),A+=1;for(n+=ii(f.subarray(A,A+1)),A+=1;ii(f.subarray(A,A+1))!=="\0";)a+=ii(f.subarray(A,A+1)),A+=1;a+=ii(f.subarray(A,A+1)),A+=1,l=Ut(f,12),u=Ut(f,16),p=Ut(f,20),v=Ut(f,24),A=28}else if(t===1){A+=4,l=Ut(f,A),A+=4;const O=Ut(f,A);A+=4;const U=Ut(f,A);for(A+=4,c=Pp(2,32)*O+U,Q(c)||(c=Number.MAX_SAFE_INTEGER,T.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),p=Ut(f,A),A+=4,v=Ut(f,A),A+=4;ii(f.subarray(A,A+1))!=="\0";)n+=ii(f.subarray(A,A+1)),A+=1;for(n+=ii(f.subarray(A,A+1)),A+=1;ii(f.subarray(A,A+1))!=="\0";)a+=ii(f.subarray(A,A+1)),A+=1;a+=ii(f.subarray(A,A+1)),A+=1}const C=f.subarray(A,f.byteLength);return{schemeIdUri:n,value:a,timeScale:l,presentationTime:c,presentationTimeDelta:u,eventDuration:p,id:v,payload:C}}function mt(f,...t){const n=t.length;let a=8,l=n;for(;l--;)a+=t[l].byteLength;const u=new Uint8Array(a);for(u[0]=a>>24&255,u[1]=a>>16&255,u[2]=a>>8&255,u[3]=a&255,u.set(f,4),l=0,a=8;l<n;l++)u.set(t[l],a),a+=t[l].byteLength;return u}function Nt(f,t,n){if(f.byteLength!==16)throw new RangeError("Invalid system id");let a,l;if(t){a=1,l=new Uint8Array(t.length*16);for(let p=0;p<t.length;p++){const v=t[p];if(v.byteLength!==16)throw new RangeError("Invalid key");l.set(v,p*16)}}else a=0,l=new Uint8Array;let u;a>0?(u=new Uint8Array(4),t.length>0&&new DataView(u.buffer).setUint32(0,t.length,!1)):u=new Uint8Array;const c=new Uint8Array(4);return n&&n.byteLength>0&&new DataView(c.buffer).setUint32(0,n.byteLength,!1),mt([112,115,115,104],new Uint8Array([a,0,0,0]),f,u,l,c,n||new Uint8Array)}function Ai(f){if(!(f instanceof ArrayBuffer)||f.byteLength<32)return null;const t={version:0,systemId:"",kids:null,data:null},n=new DataView(f),a=n.getUint32(0);if(f.byteLength!==a&&a>44||n.getUint32(4)!==1886614376||(t.version=n.getUint32(8)>>>24,t.version>1))return null;t.systemId=ht.hexDump(new Uint8Array(f,12,16));const u=n.getUint32(28);if(t.version===0){if(a-32<u)return null;t.data=new Uint8Array(f,32,u)}else if(t.version===1){t.kids=[];for(let c=0;c<u;c++)t.kids.push(new Uint8Array(f,32+c*16,16))}return t}let mi={};class zi{static clearKeyUriToKeyIdMap(){mi={}}constructor(t,n,a,l=[1],u=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=t,this.uri=n,this.keyFormat=a,this.keyFormatVersions=l,this.iv=u,this.encrypted=t?t!=="NONE":!1,this.isCommonEncryption=this.encrypted&&t!=="AES-128"}isSupported(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case ot.FAIRPLAY:case ot.WIDEVINE:case ot.PLAYREADY:case ot.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(t){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof t!="number"&&(this.method==="AES-128"&&!this.iv&&T.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),t=0);const a=gn(t);return new zi(this.method,this.uri,"identity",this.keyFormatVersions,a)}const n=wt(this.uri);if(n)switch(this.keyFormat){case ot.WIDEVINE:this.pssh=n,n.length>=22&&(this.keyId=n.subarray(n.length-22,n.length-6));break;case ot.PLAYREADY:{const a=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=Nt(a,null,n);const l=new Uint16Array(n.buffer,n.byteOffset,n.byteLength/2),u=String.fromCharCode.apply(null,Array.from(l)),c=u.substring(u.indexOf("<"),u.length),A=new DOMParser().parseFromString(c,"text/xml").getElementsByTagName("KID")[0];if(A){const C=A.childNodes[0]?A.childNodes[0].nodeValue:A.getAttribute("VALUE");if(C){const O=Ne(C).subarray(0,16);dt(O),this.keyId=O}}break}default:{let a=n.subarray(0,16);if(a.length!==16){const l=new Uint8Array(16);l.set(a,16-a.length),a=l}this.keyId=a;break}}if(!this.keyId||this.keyId.byteLength!==16){let a=mi[this.uri];if(!a){const l=Object.keys(mi).length%Number.MAX_SAFE_INTEGER;a=new Uint8Array(16),new DataView(a.buffer,12,4).setUint32(0,l),mi[this.uri]=a}this.keyId=a}return this}}function gn(f){const t=new Uint8Array(16);for(let n=12;n<16;n++)t[n]=f>>8*(15-n)&255;return t}const Dn=/\{\$([a-zA-Z0-9-_]+)\}/g;function Fn(f){return Dn.test(f)}function Oi(f,t,n){if(f.variableList!==null||f.hasVariableRefs)for(let a=n.length;a--;){const l=n[a],u=t[l];u&&(t[l]=Nn(f,u))}}function Nn(f,t){if(f.variableList!==null||f.hasVariableRefs){const n=f.variableList;return t.replace(Dn,a=>{const l=a.substring(2,a.length-1),u=n==null?void 0:n[l];return u===void 0?(f.playlistParsingError||(f.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${l}"`)),a):u})}return t}function Sn(f,t,n){let a=f.variableList;a||(f.variableList=a={});let l,u;if("QUERYPARAM"in t){l=t.QUERYPARAM;try{const c=new self.URL(n).searchParams;if(c.has(l))u=c.get(l);else throw new Error(`"${l}" does not match any query parameter in URI: "${n}"`)}catch(c){f.playlistParsingError||(f.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${c.message}`))}}else l=t.NAME,u=t.VALUE;l in a?f.playlistParsingError||(f.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${l}"`)):a[l]=u||""}function en(f,t,n){const a=t.IMPORT;if(n&&a in n){let l=f.variableList;l||(f.variableList=l={}),l[a]=n[a]}else f.playlistParsingError||(f.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${a}"`))}function an(){if(typeof self!="undefined")return self.MediaSource||self.WebKitMediaSource}const wr={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}},Lr=an();function fn(f,t){const n=wr[t];return!!n&&n[f.slice(0,4)]===!0}function kr(f,t){var n;return(n=Lr==null?void 0:Lr.isTypeSupported(`${t||"video"}/mp4;codecs="${f}"`))!=null?n:!1}const La=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,ka=/#EXT-X-MEDIA:(.*)/g,ta=/^#EXT(?:INF|-X-TARGETDURATION):/m,fo=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),po=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class Kn{static findGroup(t,n){for(let a=0;a<t.length;a++){const l=t[a];if(l.id===n)return l}}static convertAVC1ToAVCOTI(t){const n=t.split(".");if(n.length>2){let a=n.shift()+".";return a+=parseInt(n.shift()).toString(16),a+=("000"+parseInt(n.shift()).toString(16)).slice(-4),a}return t}static resolve(t,n){return Ze.buildAbsoluteURL(n,t,{alwaysNormalize:!0})}static isMediaPlaylist(t){return ta.test(t)}static parseMasterPlaylist(t,n){const a=Fn(t),l={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:a},u=[];La.lastIndex=0;let c;for(;(c=La.exec(t))!=null;)if(c[1]){var p;const A=new le(c[1]);Oi(l,A,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const C=Nn(l,c[2]),O={attrs:A,bitrate:A.decimalInteger("AVERAGE-BANDWIDTH")||A.decimalInteger("BANDWIDTH"),name:A.NAME,url:Kn.resolve(C,n)},U=A.decimalResolution("RESOLUTION");U&&(O.width=U.width,O.height=U.height),Ra((A.CODECS||"").split(/[ ,]+/).filter(W=>W),O),O.videoCodec&&O.videoCodec.indexOf("avc1")!==-1&&(O.videoCodec=Kn.convertAVC1ToAVCOTI(O.videoCodec)),(p=O.unknownCodecs)!=null&&p.length||u.push(O),l.levels.push(O)}else if(c[3]){const A=c[3],C=c[4];switch(A){case"SESSION-DATA":{const O=new le(C);Oi(l,O,["DATA-ID","LANGUAGE","VALUE","URI"]);const U=O["DATA-ID"];U&&(l.sessionData===null&&(l.sessionData={}),l.sessionData[U]=O);break}case"SESSION-KEY":{const O=Da(C,n,l);O.encrypted&&O.isSupported()?(l.sessionKeys===null&&(l.sessionKeys=[]),l.sessionKeys.push(O)):T.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${C}"`);break}case"DEFINE":{{const O=new le(C);Oi(l,O,["NAME","VALUE","QUERYPARAM"]),Sn(l,O,n)}break}case"CONTENT-STEERING":{const O=new le(C);Oi(l,O,["SERVER-URI","PATHWAY-ID"]),l.contentSteering={uri:Kn.resolve(O["SERVER-URI"],n),pathwayId:O["PATHWAY-ID"]||"."};break}case"START":{l.startTimeOffset=Ia(C);break}}}const v=u.length>0&&u.length<l.levels.length;return l.levels=v?u:l.levels,l.levels.length===0&&(l.playlistParsingError=new Error("no levels found in manifest")),l}static parseMasterPlaylistMedia(t,n,a){let l;const u={},c=a.levels,p={AUDIO:c.map(A=>({id:A.attrs.AUDIO,audioCodec:A.audioCodec})),SUBTITLES:c.map(A=>({id:A.attrs.SUBTITLES,textCodec:A.textCodec})),"CLOSED-CAPTIONS":[]};let v=0;for(ka.lastIndex=0;(l=ka.exec(t))!==null;){const A=new le(l[1]),C=A.TYPE;if(C){const O=p[C],U=u[C]||[];u[C]=U,Oi(a,A,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const W={attrs:A,bitrate:0,id:v++,groupId:A["GROUP-ID"]||"",instreamId:A["INSTREAM-ID"],name:A.NAME||A.LANGUAGE||"",type:C,default:A.bool("DEFAULT"),autoselect:A.bool("AUTOSELECT"),forced:A.bool("FORCED"),lang:A.LANGUAGE,url:A.URI?Kn.resolve(A.URI,n):""};if(O!=null&&O.length){const J=Kn.findGroup(O,W.groupId)||O[0];ia(W,J,"audioCodec"),ia(W,J,"textCodec")}U.push(W)}}return u}static parseLevelPlaylist(t,n,a,l,u,c){const p=new ke(n),v=p.fragments;let A=null,C=0,O=0,U=0,W=0,J=null,oe=new Se(l,n),he,we,Fe,Me=-1,it=!1;for(fo.lastIndex=0,p.m3u8=t,p.hasVariableRefs=Fn(t);(he=fo.exec(t))!==null;){it&&(it=!1,oe=new Se(l,n),oe.start=U,oe.sn=C,oe.cc=W,oe.level=a,A&&(oe.initSegment=A,oe.rawProgramDateTime=A.rawProgramDateTime,A.rawProgramDateTime=null));const gt=he[1];if(gt){oe.duration=parseFloat(gt);const Ct=(" "+he[2]).slice(1);oe.title=Ct||null,oe.tagList.push(Ct?["INF",gt,Ct]:["INF",gt])}else if(he[3]){if(te(oe.duration)){oe.start=U,Fe&&fs(oe,Fe,p),oe.sn=C,oe.level=a,oe.cc=W,oe.urlId=u,v.push(oe);const Ct=(" "+he[3]).slice(1);oe.relurl=Nn(p,Ct),Pa(oe,J),J=oe,U+=oe.duration,C++,O=0,it=!0}}else if(he[4]){const Ct=(" "+he[4]).slice(1);J?oe.setByteRange(Ct,J):oe.setByteRange(Ct)}else if(he[5])oe.rawProgramDateTime=(" "+he[5]).slice(1),oe.tagList.push(["PROGRAM-DATE-TIME",oe.rawProgramDateTime]),Me===-1&&(Me=v.length);else{if(he=he[0].match(po),!he){T.warn("No matches on slow regex match for level playlist!");continue}for(we=1;we<he.length&&typeof he[we]=="undefined";we++);const Ct=(" "+he[we]).slice(1),rt=(" "+he[we+1]).slice(1),qt=he[we+2]?(" "+he[we+2]).slice(1):"";switch(Ct){case"PLAYLIST-TYPE":p.type=rt.toUpperCase();break;case"MEDIA-SEQUENCE":C=p.startSN=parseInt(rt);break;case"SKIP":{const Ot=new le(rt);Oi(p,Ot,["RECENTLY-REMOVED-DATERANGES"]);const Si=Ot.decimalInteger("SKIPPED-SEGMENTS");if(te(Si)){p.skippedSegments=Si;for(let Pi=Si;Pi--;)v.unshift(null);C+=Si}const Pn=Ot.enumeratedString("RECENTLY-REMOVED-DATERANGES");Pn&&(p.recentlyRemovedDateranges=Pn.split("	"));break}case"TARGETDURATION":p.targetduration=Math.max(parseInt(rt),1);break;case"VERSION":p.version=parseInt(rt);break;case"EXTM3U":break;case"ENDLIST":p.live=!1;break;case"#":(rt||qt)&&oe.tagList.push(qt?[rt,qt]:[rt]);break;case"DISCONTINUITY":W++,oe.tagList.push(["DIS"]);break;case"GAP":oe.gap=!0,oe.tagList.push([Ct]);break;case"BITRATE":oe.tagList.push([Ct,rt]);break;case"DATERANGE":{const Ot=new le(rt);Oi(p,Ot,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),Oi(p,Ot,Ot.clientAttrs);const Si=new ne(Ot,p.dateRanges[Ot.ID]);Si.isValid||p.skippedSegments?p.dateRanges[Si.id]=Si:T.warn(`Ignoring invalid DATERANGE tag: "${rt}"`),oe.tagList.push(["EXT-X-DATERANGE",rt]);break}case"DEFINE":{{const Ot=new le(rt);Oi(p,Ot,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in Ot?en(p,Ot,c):Sn(p,Ot,n)}break}case"DISCONTINUITY-SEQUENCE":W=parseInt(rt);break;case"KEY":{const Ot=Da(rt,n,p);if(Ot.isSupported()){if(Ot.method==="NONE"){Fe=void 0;break}Fe||(Fe={}),Fe[Ot.keyFormat]&&(Fe=Ee({},Fe)),Fe[Ot.keyFormat]=Ot}else T.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${rt}"`);break}case"START":p.startTimeOffset=Ia(rt);break;case"MAP":{const Ot=new le(rt);if(Oi(p,Ot,["BYTERANGE","URI"]),oe.duration){const Si=new Se(l,n);zr(Si,Ot,a,Fe),A=Si,oe.initSegment=A,A.rawProgramDateTime&&!oe.rawProgramDateTime&&(oe.rawProgramDateTime=A.rawProgramDateTime)}else zr(oe,Ot,a,Fe),A=oe,it=!0;break}case"SERVER-CONTROL":{const Ot=new le(rt);p.canBlockReload=Ot.bool("CAN-BLOCK-RELOAD"),p.canSkipUntil=Ot.optionalFloat("CAN-SKIP-UNTIL",0),p.canSkipDateRanges=p.canSkipUntil>0&&Ot.bool("CAN-SKIP-DATERANGES"),p.partHoldBack=Ot.optionalFloat("PART-HOLD-BACK",0),p.holdBack=Ot.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const Ot=new le(rt);p.partTarget=Ot.decimalFloatingPoint("PART-TARGET");break}case"PART":{let Ot=p.partList;Ot||(Ot=p.partList=[]);const Si=O>0?Ot[Ot.length-1]:void 0,Pn=O++,Pi=new le(rt);Oi(p,Pi,["BYTERANGE","URI"]);const Ni=new Ce(Pi,oe,n,Pn,Si);Ot.push(Ni),oe.duration+=Ni.duration;break}case"PRELOAD-HINT":{const Ot=new le(rt);Oi(p,Ot,["URI"]),p.preloadHint=Ot;break}case"RENDITION-REPORT":{const Ot=new le(rt);Oi(p,Ot,["URI"]),p.renditionReports=p.renditionReports||[],p.renditionReports.push(Ot);break}default:T.warn(`line parsed but not handled: ${he}`);break}}}J&&!J.relurl?(v.pop(),U-=J.duration,p.partList&&(p.fragmentHint=J)):p.partList&&(Pa(oe,J),oe.cc=W,p.fragmentHint=oe,Fe&&fs(oe,Fe,p));const We=v.length,St=v[0],ut=v[We-1];if(U+=p.skippedSegments*p.targetduration,U>0&&We&&ut){p.averagetargetduration=U/We;const gt=ut.sn;p.endSN=gt!=="initSegment"?gt:0,p.live||(ut.endList=!0),St&&(p.startCC=St.cc)}else p.endSN=0,p.startCC=0;return p.fragmentHint&&(U+=p.fragmentHint.duration),p.totalduration=U,p.endCC=W,Me>0&&Oa(v,Me),p}}function Da(f,t,n){var a,l;const u=new le(f);Oi(n,u,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const c=(a=u.METHOD)!=null?a:"",p=u.URI,v=u.hexadecimalInteger("IV"),A=u.KEYFORMATVERSIONS,C=(l=u.KEYFORMAT)!=null?l:"identity";p&&u.IV&&!v&&T.error(`Invalid IV: ${u.IV}`);const O=p?Kn.resolve(p,t):"",U=(A||"1").split("/").map(Number).filter(Number.isFinite);return new zi(c,O,C,U,v)}function Ia(f){const n=new le(f).decimalFloatingPoint("TIME-OFFSET");return te(n)?n:null}function Ra(f,t){["video","audio","text"].forEach(n=>{const a=f.filter(l=>fn(l,n));if(a.length){const l=a.filter(u=>u.lastIndexOf("avc1",0)===0||u.lastIndexOf("mp4a",0)===0);t[`${n}Codec`]=l.length>0?l[0]:a[0],f=f.filter(u=>a.indexOf(u)===-1)}}),t.unknownCodecs=f}function ia(f,t,n){const a=t[n];a&&(f[n]=a)}function Oa(f,t){let n=f[t];for(let a=t;a--;){const l=f[a];if(!l)return;l.programDateTime=n.programDateTime-l.duration*1e3,n=l}}function Pa(f,t){f.rawProgramDateTime?f.programDateTime=Date.parse(f.rawProgramDateTime):t!=null&&t.programDateTime&&(f.programDateTime=t.endProgramDateTime),te(f.programDateTime)||(f.programDateTime=null,f.rawProgramDateTime=null)}function zr(f,t,n,a){f.relurl=t.URI,t.BYTERANGE&&f.setByteRange(t.BYTERANGE),f.level=n,f.sn="initSegment",a&&(f.levelkeys=a),f.initSegment=null}function fs(f,t,n){f.levelkeys=t;const{encryptedFragments:a}=n;(!a.length||a[a.length-1].levelkeys!==t)&&Object.keys(t).some(l=>t[l].isCommonEncryption)&&a.push(f)}var ui={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},Gt={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function na(f){const{type:t}=f;switch(t){case ui.AUDIO_TRACK:return Gt.AUDIO;case ui.SUBTITLE_TRACK:return Gt.SUBTITLE;default:return Gt.MAIN}}function Yr(f,t){let n=f.url;return(n===void 0||n.indexOf("data:")===0)&&(n=t.url),n}class nl{constructor(t){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=t,this.registerListeners()}startLoad(t){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:t}=this;t.on(y.MANIFEST_LOADING,this.onManifestLoading,this),t.on(y.LEVEL_LOADING,this.onLevelLoading,this),t.on(y.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.on(y.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:t}=this;t.off(y.MANIFEST_LOADING,this.onManifestLoading,this),t.off(y.LEVEL_LOADING,this.onLevelLoading,this),t.off(y.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.off(y.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(t){const n=this.hls.config,a=n.pLoader,l=n.loader,u=a||l,c=new u(n);return this.loaders[t.type]=c,c}getInternalLoader(t){return this.loaders[t.type]}resetInternalLoader(t){this.loaders[t]&&delete this.loaders[t]}destroyInternalLoaders(){for(const t in this.loaders){const n=this.loaders[t];n&&n.destroy(),this.resetInternalLoader(t)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(t,n){const{url:a}=n;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:ui.MANIFEST,url:a,deliveryDirectives:null})}onLevelLoading(t,n){const{id:a,level:l,url:u,deliveryDirectives:c}=n;this.load({id:a,level:l,responseType:"text",type:ui.LEVEL,url:u,deliveryDirectives:c})}onAudioTrackLoading(t,n){const{id:a,groupId:l,url:u,deliveryDirectives:c}=n;this.load({id:a,groupId:l,level:null,responseType:"text",type:ui.AUDIO_TRACK,url:u,deliveryDirectives:c})}onSubtitleTrackLoading(t,n){const{id:a,groupId:l,url:u,deliveryDirectives:c}=n;this.load({id:a,groupId:l,level:null,responseType:"text",type:ui.SUBTITLE_TRACK,url:u,deliveryDirectives:c})}load(t){var n;const a=this.hls.config;let l=this.getInternalLoader(t);if(l){const A=l.context;if(A&&A.url===t.url){T.trace("[playlist-loader]: playlist request ongoing");return}T.log(`[playlist-loader]: aborting previous loader for type: ${t.type}`),l.abort()}let u;if(t.type===ui.MANIFEST?u=a.manifestLoadPolicy.default:u=Ee({},a.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),l=this.createInternalLoader(t),(n=t.deliveryDirectives)!=null&&n.part){let A;if(t.type===ui.LEVEL&&t.level!==null?A=this.hls.levels[t.level].details:t.type===ui.AUDIO_TRACK&&t.id!==null?A=this.hls.audioTracks[t.id].details:t.type===ui.SUBTITLE_TRACK&&t.id!==null&&(A=this.hls.subtitleTracks[t.id].details),A){const C=A.partTarget,O=A.targetduration;if(C&&O){const U=Math.max(C*3,O*.8)*1e3;u=Ee({},u,{maxTimeToFirstByteMs:Math.min(U,u.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(U,u.maxTimeToFirstByteMs)})}}}const c=u.errorRetry||u.timeoutRetry||{},p={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:c.maxNumRetry||0,retryDelay:c.retryDelayMs||0,maxRetryDelay:c.maxRetryDelayMs||0},v={onSuccess:(A,C,O,U)=>{const W=this.getInternalLoader(O);this.resetInternalLoader(O.type);const J=A.data;if(J.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(A,O,new Error("no EXTM3U delimiter"),U||null,C);return}C.parsing.start=performance.now(),Kn.isMediaPlaylist(J)?this.handleTrackOrLevelPlaylist(A,C,O,U||null,W):this.handleMasterPlaylist(A,C,O,U)},onError:(A,C,O,U)=>{this.handleNetworkError(C,O,!1,A,U)},onTimeout:(A,C,O)=>{this.handleNetworkError(C,O,!0,void 0,A)}};l.load(t,p,v)}handleMasterPlaylist(t,n,a,l){const u=this.hls,c=t.data,p=Yr(t,a),v=Kn.parseMasterPlaylist(c,p);if(v.playlistParsingError){this.handleManifestParsingError(t,a,v.playlistParsingError,l,n);return}const{contentSteering:A,levels:C,sessionData:O,sessionKeys:U,startTimeOffset:W,variableList:J}=v;this.variableList=J;const{AUDIO:oe=[],SUBTITLES:he,"CLOSED-CAPTIONS":we}=Kn.parseMasterPlaylistMedia(c,p,v);oe.length&&!oe.some(Me=>!Me.url)&&C[0].audioCodec&&!C[0].attrs.AUDIO&&(T.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),oe.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new le({}),bitrate:0,url:""})),u.trigger(y.MANIFEST_LOADED,{levels:C,audioTracks:oe,subtitles:he,captions:we,contentSteering:A,url:p,stats:n,networkDetails:l,sessionData:O,sessionKeys:U,startTimeOffset:W,variableList:J})}handleTrackOrLevelPlaylist(t,n,a,l,u){const c=this.hls,{id:p,level:v,type:A}=a,C=Yr(t,a),O=te(p)?p:0,U=te(v)?v:O,W=na(a),J=Kn.parseLevelPlaylist(t.data,C,U,W,O,this.variableList);if(A===ui.MANIFEST){const oe={attrs:new le({}),bitrate:0,details:J,name:"",url:C};c.trigger(y.MANIFEST_LOADED,{levels:[oe],audioTracks:[],url:C,stats:n,networkDetails:l,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}n.parsing.end=performance.now(),a.levelDetails=J,this.handlePlaylistLoaded(J,t,n,a,l,u)}handleManifestParsingError(t,n,a,l,u){this.hls.trigger(y.ERROR,{type:$.NETWORK_ERROR,details:D.MANIFEST_PARSING_ERROR,fatal:n.type===ui.MANIFEST,url:t.url,err:a,error:a,reason:a.message,response:t,context:n,networkDetails:l,stats:u})}handleNetworkError(t,n,a=!1,l,u){let c=`A network ${a?"timeout":"error"+(l?" (status "+l.code+")":"")} occurred while loading ${t.type}`;t.type===ui.LEVEL?c+=`: ${t.level} id: ${t.id}`:(t.type===ui.AUDIO_TRACK||t.type===ui.SUBTITLE_TRACK)&&(c+=` id: ${t.id} group-id: "${t.groupId}"`);const p=new Error(c);T.warn(`[playlist-loader]: ${c}`);let v=D.UNKNOWN,A=!1;const C=this.getInternalLoader(t);switch(t.type){case ui.MANIFEST:v=a?D.MANIFEST_LOAD_TIMEOUT:D.MANIFEST_LOAD_ERROR,A=!0;break;case ui.LEVEL:v=a?D.LEVEL_LOAD_TIMEOUT:D.LEVEL_LOAD_ERROR,A=!1;break;case ui.AUDIO_TRACK:v=a?D.AUDIO_TRACK_LOAD_TIMEOUT:D.AUDIO_TRACK_LOAD_ERROR,A=!1;break;case ui.SUBTITLE_TRACK:v=a?D.SUBTITLE_TRACK_LOAD_TIMEOUT:D.SUBTITLE_LOAD_ERROR,A=!1;break}C&&this.resetInternalLoader(t.type);const O={type:$.NETWORK_ERROR,details:v,fatal:A,url:t.url,loader:C,context:t,error:p,networkDetails:n,stats:u};if(l){const U=(n==null?void 0:n.url)||t.url;O.response=tt({url:U,data:void 0},l)}this.hls.trigger(y.ERROR,O)}handlePlaylistLoaded(t,n,a,l,u,c){const p=this.hls,{type:v,level:A,id:C,groupId:O,deliveryDirectives:U}=l,W=Yr(n,l),J=na(l),oe=typeof l.level=="number"&&J===Gt.MAIN?A:void 0;if(!t.fragments.length){const we=new Error("No Segments found in Playlist");p.trigger(y.ERROR,{type:$.NETWORK_ERROR,details:D.LEVEL_EMPTY_ERROR,fatal:!1,url:W,error:we,reason:we.message,response:n,context:l,level:oe,parent:J,networkDetails:u,stats:a});return}t.targetduration||(t.playlistParsingError=new Error("Missing Target Duration"));const he=t.playlistParsingError;if(he){p.trigger(y.ERROR,{type:$.NETWORK_ERROR,details:D.LEVEL_PARSING_ERROR,fatal:!1,url:W,error:he,reason:he.message,response:n,context:l,level:oe,parent:J,networkDetails:u,stats:a});return}switch(t.live&&c&&(c.getCacheAge&&(t.ageHeader=c.getCacheAge()||0),(!c.getCacheAge||isNaN(t.ageHeader))&&(t.ageHeader=0)),v){case ui.MANIFEST:case ui.LEVEL:p.trigger(y.LEVEL_LOADED,{details:t,level:oe||0,id:C||0,stats:a,networkDetails:u,deliveryDirectives:U});break;case ui.AUDIO_TRACK:p.trigger(y.AUDIO_TRACK_LOADED,{details:t,id:C||0,groupId:O||"",stats:a,networkDetails:u,deliveryDirectives:U});break;case ui.SUBTITLE_TRACK:p.trigger(y.SUBTITLE_TRACK_LOADED,{details:t,id:C||0,groupId:O||"",stats:a,networkDetails:u,deliveryDirectives:U});break}}}function gr(f,t){let n;try{n=new Event("addtrack")}catch(a){n=document.createEvent("Event"),n.initEvent("addtrack",!1,!1)}n.track=f,t.dispatchEvent(n)}function bi(f,t){const n=f.mode;if(n==="disabled"&&(f.mode="hidden"),f.cues&&!f.cues.getCueById(t.id))try{if(f.addCue(t),!f.cues.getCueById(t.id))throw new Error(`addCue is failed for: ${t}`)}catch(a){T.debug(`[texttrack-utils]: ${a}`);try{const l=new self.TextTrackCue(t.startTime,t.endTime,t.text);l.id=t.id,f.addCue(l)}catch(l){T.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${l}`)}}n==="disabled"&&(f.mode=n)}function In(f){const t=f.mode;if(t==="disabled"&&(f.mode="hidden"),f.cues)for(let n=f.cues.length;n--;)f.removeCue(f.cues[n]);t==="disabled"&&(f.mode=t)}function Xr(f,t,n,a){const l=f.mode;if(l==="disabled"&&(f.mode="hidden"),f.cues&&f.cues.length>0){const u=rl(f.cues,t,n);for(let c=0;c<u.length;c++)(!a||a(u[c]))&&f.removeCue(u[c])}l==="disabled"&&(f.mode=l)}function Qr(f,t){if(t<f[0].startTime)return 0;const n=f.length-1;if(t>f[n].endTime)return-1;let a=0,l=n;for(;a<=l;){const u=Math.floor((l+a)/2);if(t<f[u].startTime)l=u-1;else if(t>f[u].startTime&&a<n)a=u+1;else return u}return f[a].startTime-t<t-f[l].startTime?a:l}function rl(f,t,n){const a=[],l=Qr(f,t);if(l>-1)for(let u=l,c=f.length;u<c;u++){const p=f[u];if(p.startTime>=t&&p.endTime<=n)a.push(p);else if(p.startTime>n)return a}return a}var Un={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};const Vi=.25;function Os(){if(typeof self!="undefined")return self.VTTCue||self.TextTrackCue}function Ps(f,t,n,a,l){let u=new f(t,n,"");try{u.value=a,l&&(u.type=l)}catch(c){u=new f(t,n,JSON.stringify(l?tt({type:l},a):a))}return u}const Di=(()=>{const f=Os();try{f&&new f(0,Number.POSITIVE_INFINITY,"")}catch(t){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function ra(f,t){return f.getTime()/1e3-t}function sl(f){return Uint8Array.from(f.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class Ba{constructor(t){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=t,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:t}=this;t.on(y.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(y.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(y.MANIFEST_LOADING,this.onManifestLoading,this),t.on(y.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.on(y.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(y.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:t}=this;t.off(y.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(y.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(y.MANIFEST_LOADING,this.onManifestLoading,this),t.off(y.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.off(y.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(y.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(t,n){this.media=n.media}onMediaDetaching(){!this.id3Track||(In(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(t){const n=this.getID3Track(t.textTracks);return n.mode="hidden",n}getID3Track(t){if(!!this.media){for(let n=0;n<t.length;n++){const a=t[n];if(a.kind==="metadata"&&a.label==="id3")return gr(a,this.media),a}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(t,n){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:a,enableID3MetadataCues:l}}}=this;if(!a&&!l)return;const{samples:u}=n;this.id3Track||(this.id3Track=this.createTrack(this.media));const c=Os();if(!!c)for(let p=0;p<u.length;p++){const v=u[p].type;if(v===Un.emsg&&!a||!l)continue;const A=xi(u[p].data);if(A){const C=u[p].pts;let O=C+u[p].duration;O>Di&&(O=Di),O-C<=0&&(O=C+Vi);for(let W=0;W<A.length;W++){const J=A[W];if(!pt(J)){this.updateId3CueEnds(C,v);const oe=Ps(c,C,O,J,v);oe&&this.id3Track.addCue(oe)}}}}}updateId3CueEnds(t,n){var a;const l=(a=this.id3Track)==null?void 0:a.cues;if(l)for(let u=l.length;u--;){const c=l[u];c.type===n&&c.startTime<t&&c.endTime===Di&&(c.endTime=t)}}onBufferFlushing(t,{startOffset:n,endOffset:a,type:l}){const{id3Track:u,hls:c}=this;if(!c)return;const{config:{enableEmsgMetadataCues:p,enableID3MetadataCues:v}}=c;if(u&&(p||v)){let A;l==="audio"?A=C=>C.type===Un.audioId3&&v:l==="video"?A=C=>C.type===Un.emsg&&p:A=C=>C.type===Un.audioId3&&v||C.type===Un.emsg&&p,Xr(u,n,a,A)}}onLevelUpdated(t,{details:n}){if(!this.media||!n.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:a,id3Track:l}=this,{dateRanges:u}=n,c=Object.keys(u);if(l){const C=Object.keys(a).filter(O=>!c.includes(O));for(let O=C.length;O--;){const U=C[O];Object.keys(a[U].cues).forEach(W=>{l.removeCue(a[U].cues[W])}),delete a[U]}}const p=n.fragments[n.fragments.length-1];if(c.length===0||!te(p==null?void 0:p.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const v=p.programDateTime/1e3-p.start,A=Os();for(let C=0;C<c.length;C++){const O=c[C],U=u[O],W=a[O],J=(W==null?void 0:W.cues)||{};let oe=(W==null?void 0:W.durationKnown)||!1;const he=ra(U.startDate,v);let we=Di;const Fe=U.endDate;if(Fe)we=ra(Fe,v),oe=!0;else if(U.endOnNext&&!oe){const it=c.reduce((We,St)=>{const ut=u[St];return ut.class===U.class&&ut.id!==St&&ut.startDate>U.startDate&&We.push(ut),We},[]).sort((We,St)=>We.startDate.getTime()-St.startDate.getTime())[0];it&&(we=ra(it.startDate,v),oe=!0)}const Me=Object.keys(U.attr);for(let it=0;it<Me.length;it++){const We=Me[it];if(!F(We))continue;const St=J[We];if(St)oe&&!W.durationKnown&&(St.endTime=we);else if(A){let ut=U.attr[We];K(We)&&(ut=sl(ut));const gt=Ps(A,he,we,{key:We,data:ut},Un.dateRange);gt&&(gt.id=O,this.id3Track.addCue(gt),J[We]=gt)}}a[O]={cues:J,dateRange:U,durationKnown:oe}}}}class al{constructor(t){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=t,this.config=t.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:t,levelDetails:n}=this;return t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:n?t.liveMaxLatencyDurationCount*n.targetduration:0}get targetLatency(){const{levelDetails:t}=this;if(t===null)return null;const{holdBack:n,partHoldBack:a,targetduration:l}=t,{liveSyncDuration:u,liveSyncDurationCount:c,lowLatencyMode:p}=this.config,v=this.hls.userConfig;let A=p&&a||n;(v.liveSyncDuration||v.liveSyncDurationCount||A===0)&&(A=u!==void 0?u:c*l);const C=l,O=1;return A+Math.min(this.stallCount*O,C)}get liveSyncPosition(){const t=this.estimateLiveEdge(),n=this.targetLatency,a=this.levelDetails;if(t===null||n===null||a===null)return null;const l=a.edge,u=t-n-this.edgeStalled,c=l-a.totalduration,p=l-(this.config.lowLatencyMode&&a.partTarget||a.targetduration);return Math.min(Math.max(c,u),p)}get drift(){const{levelDetails:t}=this;return t===null?1:t.drift}get edgeStalled(){const{levelDetails:t}=this;if(t===null)return 0;const n=(this.config.lowLatencyMode&&t.partTarget||t.targetduration)*3;return Math.max(t.age-n,0)}get forwardBufferLength(){const{media:t,levelDetails:n}=this;if(!t||!n)return 0;const a=t.buffered.length;return(a?t.buffered.end(a-1):n.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(y.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(y.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(y.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(y.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(y.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(y.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(y.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(y.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(y.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(y.ERROR,this.onError,this)}onMediaAttached(t,n){this.media=n.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(t,{details:n}){this.levelDetails=n,n.advanced&&this.timeupdate(),!n.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(t,n){var a;n.details===D.BUFFER_STALLED_ERROR&&(this.stallCount++,(a=this.levelDetails)!=null&&a.live&&T.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:t,levelDetails:n}=this;if(!t||!n)return;this.currentTime=t.currentTime;const a=this.computeLatency();if(a===null)return;this._latency=a;const{lowLatencyMode:l,maxLiveSyncPlaybackRate:u}=this.config;if(!l||u===1)return;const c=this.targetLatency;if(c===null)return;const p=a-c,v=Math.min(this.maxLatency,c+n.targetduration),A=p<v;if(n.live&&A&&p>.05&&this.forwardBufferLength>1){const C=Math.min(2,Math.max(1,u)),O=Math.round(2/(1+Math.exp(-.75*p-this.edgeStalled))*20)/20;t.playbackRate=Math.min(C,Math.max(1,O))}else t.playbackRate!==1&&t.playbackRate!==0&&(t.playbackRate=1)}estimateLiveEdge(){const{levelDetails:t}=this;return t===null?null:t.edge+t.age}computeLatency(){const t=this.estimateLiveEdge();return t===null?null:t-this.currentTime}}const Bs=["NONE","TYPE-0","TYPE-1",null];var ir={No:"",Yes:"YES",v2:"v2"};function ol(f,t){const{canSkipUntil:n,canSkipDateRanges:a,endSN:l}=f,u=t!==void 0?t-l:0;return n&&u<n?a?ir.v2:ir.Yes:ir.No}class mo{constructor(t,n,a){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=t,this.part=n,this.skip=a}addDirectives(t){const n=new self.URL(t);return this.msn!==void 0&&n.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&n.searchParams.set("_HLS_part",this.part.toString()),this.skip&&n.searchParams.set("_HLS_skip",this.skip),n.href}}class Ms{constructor(t){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[t.url],this._attrs=[t.attrs],this.bitrate=t.bitrate,t.details&&(this.details=t.details),this.id=t.id||0,this.name=t.name,this.width=t.width||0,this.height=t.height||0,this.audioCodec=t.audioCodec,this.videoCodec=t.videoCodec,this.unknownCodecs=t.unknownCodecs,this.codecSet=[t.videoCodec,t.audioCodec].filter(n=>n).join(",").replace(/\.[^.,]+/g,"")}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get attrs(){return this._attrs[this._urlId]}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get uri(){return this.url[this._urlId]||""}get urlId(){return this._urlId}set urlId(t){const n=t%this.url.length;this._urlId!==n&&(this.fragmentError=0,this.loadError=0,this.details=void 0,this._urlId=n)}get audioGroupId(){var t;return(t=this.audioGroupIds)==null?void 0:t[this.urlId]}get textGroupId(){var t;return(t=this.textGroupIds)==null?void 0:t[this.urlId]}addFallback(t){this.url.push(t.url),this._attrs.push(t.attrs)}}function sa(f,t){const n=t.startPTS;if(te(n)){let a=0,l;t.sn>f.sn?(a=n-f.start,l=f):(a=f.start-n,l=t),l.duration!==a&&(l.duration=a)}else t.sn>f.sn?f.cc===t.cc&&f.minEndPTS?t.start=f.start+(f.minEndPTS-f.start):t.start=f.start+f.duration:t.start=Math.max(f.start-t.duration,0)}function go(f,t,n,a,l,u){a-n<=0&&(T.warn("Fragment should have a positive duration",t),a=n+t.duration,u=l+t.duration);let p=n,v=a;const A=t.startPTS,C=t.endPTS;if(te(A)){const he=Math.abs(A-n);te(t.deltaPTS)?t.deltaPTS=Math.max(he,t.deltaPTS):t.deltaPTS=he,p=Math.max(n,A),n=Math.min(n,A),l=Math.min(l,t.startDTS),v=Math.min(a,C),a=Math.max(a,C),u=Math.max(u,t.endDTS)}const O=n-t.start;t.start!==0&&(t.start=n),t.duration=a-t.start,t.startPTS=n,t.maxStartPTS=p,t.startDTS=l,t.endPTS=a,t.minEndPTS=v,t.endDTS=u;const U=t.sn;if(!f||U<f.startSN||U>f.endSN)return 0;let W;const J=U-f.startSN,oe=f.fragments;for(oe[J]=t,W=J;W>0;W--)sa(oe[W],oe[W-1]);for(W=J;W<oe.length-1;W++)sa(oe[W],oe[W+1]);return f.fragmentHint&&sa(oe[oe.length-1],f.fragmentHint),f.PTSKnown=f.alignedSliding=!0,O}function fu(f,t){let n=null;const a=f.fragments;for(let v=a.length-1;v>=0;v--){const A=a[v].initSegment;if(A){n=A;break}}f.fragmentHint&&delete f.fragmentHint.endPTS;let l=0,u;if(dl(f,t,(v,A)=>{v.relurl&&(l=v.cc-A.cc),te(v.startPTS)&&te(v.endPTS)&&(A.start=A.startPTS=v.startPTS,A.startDTS=v.startDTS,A.maxStartPTS=v.maxStartPTS,A.endPTS=v.endPTS,A.endDTS=v.endDTS,A.minEndPTS=v.minEndPTS,A.duration=v.endPTS-v.startPTS,A.duration&&(u=A),t.PTSKnown=t.alignedSliding=!0),A.elementaryStreams=v.elementaryStreams,A.loader=v.loader,A.stats=v.stats,A.urlId=v.urlId,v.initSegment&&(A.initSegment=v.initSegment,n=v.initSegment)}),n&&(t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments).forEach(A=>{var C;(!A.initSegment||A.initSegment.relurl===((C=n)==null?void 0:C.relurl))&&(A.initSegment=n)}),t.skippedSegments)if(t.deltaUpdateFailed=t.fragments.some(v=>!v),t.deltaUpdateFailed){T.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let v=t.skippedSegments;v--;)t.fragments.shift();t.startSN=t.fragments[0].sn,t.startCC=t.fragments[0].cc}else t.canSkipDateRanges&&(t.dateRanges=ll(f.dateRanges,t.dateRanges,t.recentlyRemovedDateranges));const c=t.fragments;if(l){T.warn("discontinuity sliding from playlist, take drift into account");for(let v=0;v<c.length;v++)c[v].cc+=l}t.skippedSegments&&(t.startCC=t.fragments[0].cc),ul(f.partList,t.partList,(v,A)=>{A.elementaryStreams=v.elementaryStreams,A.stats=v.stats}),u?go(t,u,u.startPTS,u.endPTS,u.startDTS,u.endDTS):yo(f,t),c.length&&(t.totalduration=t.edge-c[0].start),t.driftStartTime=f.driftStartTime,t.driftStart=f.driftStart;const p=t.advancedDateTime;if(t.advanced&&p){const v=t.edge;t.driftStart||(t.driftStartTime=p,t.driftStart=v),t.driftEndTime=p,t.driftEnd=v}else t.driftEndTime=f.driftEndTime,t.driftEnd=f.driftEnd,t.advancedDateTime=f.advancedDateTime}function ll(f,t,n){const a=Ee({},f);return n&&n.forEach(l=>{delete a[l]}),Object.keys(t).forEach(l=>{const u=new ne(t[l].attr,a[l]);u.isValid?a[l]=u:T.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(t[l].attr)}"`)}),a}function ul(f,t,n){if(f&&t){let a=0;for(let l=0,u=f.length;l<=u;l++){const c=f[l],p=t[l+a];c&&p&&c.index===p.index&&c.fragment.sn===p.fragment.sn?n(c,p):a--}}}function dl(f,t,n){const a=t.skippedSegments,l=Math.max(f.startSN,t.startSN)-t.startSN,u=(f.fragmentHint?1:0)+(a?t.endSN:Math.min(f.endSN,t.endSN))-t.startSN,c=t.startSN-f.startSN,p=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,v=f.fragmentHint?f.fragments.concat(f.fragmentHint):f.fragments;for(let A=l;A<=u;A++){const C=v[c+A];let O=p[A];a&&!O&&A<a&&(O=t.fragments[A]=C),C&&O&&n(C,O)}}function yo(f,t){const n=t.startSN+t.skippedSegments-f.startSN,a=f.fragments;n<0||n>=a.length||Ma(t,a[n].start)}function Ma(f,t){if(t){const n=f.fragments;for(let a=f.skippedSegments;a<n.length;a++)n[a].start+=t;f.fragmentHint&&(f.fragmentHint.start+=t)}}function cl(f,t=Infinity){let n=1e3*f.targetduration;if(f.updated){const a=f.fragments,l=4;if(a.length&&n*l>t){const u=a[a.length-1].duration*1e3;u<n&&(n=u)}}else n/=2;return Math.round(n)}function Fs(f,t,n){if(!(f!=null&&f.details))return null;const a=f.details;let l=a.fragments[t-a.startSN];return l||(l=a.fragmentHint,l&&l.sn===t)?l:t<a.startSN&&n&&n.sn===t?n:null}function hl(f,t,n){var a;return f!=null&&f.details?fl((a=f.details)==null?void 0:a.partList,t,n):null}function fl(f,t,n){if(f)for(let a=f.length;a--;){const l=f[a];if(l.index===n&&l.fragment.sn===t)return l}return null}function Fa(f){switch(f.details){case D.FRAG_LOAD_TIMEOUT:case D.KEY_LOAD_TIMEOUT:case D.LEVEL_LOAD_TIMEOUT:case D.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function pl(f,t){const n=Fa(t);return f.default[`${n?"timeout":"error"}Retry`]}function vo(f,t){const n=f.backoff==="linear"?1:Math.pow(2,t);return Math.min(n*f.retryDelayMs,f.maxRetryDelayMs)}function ml(f){return tt(tt({},f),{errorRetry:null,timeoutRetry:null})}function ps(f,t,n,a){return!!f&&t<f.maxNumRetry&&(gl(a)||!!n)}function gl(f){return f===0&&navigator.onLine===!1||!!f&&(f<400||f>499)}const aa={search:function(f,t){let n=0,a=f.length-1,l=null,u=null;for(;n<=a;){l=(n+a)/2|0,u=f[l];const c=t(u);if(c>0)n=l+1;else if(c<0)a=l-1;else return u}return null}};function Na(f,t,n){if(t===null||!Array.isArray(f)||!f.length||!te(t))return null;const a=f[0].programDateTime;if(t<(a||0))return null;const l=f[f.length-1].endProgramDateTime;if(t>=(l||0))return null;n=n||0;for(let u=0;u<f.length;++u){const c=f[u];if(Ns(t,n,c))return c}return null}function tn(f,t,n=0,a=0){let l=null;if(f?l=t[f.sn-t[0].sn+1]||null:n===0&&t[0].start===0&&(l=t[0]),l&&Dr(n,a,l)===0)return l;const u=aa.search(t,Dr.bind(null,n,a));return u&&(u!==f||!l)?u:l}function Dr(f=0,t=0,n){if(n.start<=f&&n.start+n.duration>f)return 0;const a=Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return n.start+n.duration-a<=f?1:n.start-a>f&&n.start?-1:0}function Ns(f,t,n){const a=Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0))*1e3;return(n.endProgramDateTime||0)-a>f}function yl(f,t){return aa.search(f,n=>n.cc<t?1:n.cc>t?-1:0)}const vl=3e5;var yn={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},zn={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4};class Ci{constructor(t){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=t,this.log=T.log.bind(T,"[info]:"),this.warn=T.warn.bind(T,"[warning]:"),this.error=T.error.bind(T,"[error]:"),this.registerListeners()}registerListeners(){const t=this.hls;t.on(y.ERROR,this.onError,this),t.on(y.MANIFEST_LOADING,this.onManifestLoading,this),t.on(y.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const t=this.hls;!t||(t.off(y.ERROR,this.onError,this),t.off(y.ERROR,this.onErrorOut,this),t.off(y.MANIFEST_LOADING,this.onManifestLoading,this),t.off(y.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(t){this.playlistError=0}stopLoad(){}getVariantLevelIndex(t){return(t==null?void 0:t.type)===Gt.MAIN?t.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(t,n){var a,l;if(n.fatal)return;const u=this.hls,c=n.context;switch(n.details){case D.FRAG_LOAD_ERROR:case D.FRAG_LOAD_TIMEOUT:case D.KEY_LOAD_ERROR:case D.KEY_LOAD_TIMEOUT:n.errorAction=this.getFragRetryOrSwitchAction(n);return;case D.FRAG_PARSING_ERROR:if((a=n.frag)!=null&&a.gap){n.errorAction={action:yn.DoNothing,flags:zn.None};return}case D.FRAG_GAP:case D.FRAG_DECRYPT_ERROR:{n.errorAction=this.getFragRetryOrSwitchAction(n),n.errorAction.action=yn.SendAlternateToPenaltyBox;return}case D.LEVEL_EMPTY_ERROR:case D.LEVEL_PARSING_ERROR:{var p,v;const A=n.parent===Gt.MAIN?n.level:u.loadLevel;n.details===D.LEVEL_EMPTY_ERROR&&!!((p=n.context)!=null&&(v=p.levelDetails)!=null&&v.live)?n.errorAction=this.getPlaylistRetryOrSwitchAction(n,A):(n.levelRetry=!1,n.errorAction=this.getLevelSwitchAction(n,A))}return;case D.LEVEL_LOAD_ERROR:case D.LEVEL_LOAD_TIMEOUT:typeof(c==null?void 0:c.level)=="number"&&(n.errorAction=this.getPlaylistRetryOrSwitchAction(n,c.level));return;case D.AUDIO_TRACK_LOAD_ERROR:case D.AUDIO_TRACK_LOAD_TIMEOUT:case D.SUBTITLE_LOAD_ERROR:case D.SUBTITLE_TRACK_LOAD_TIMEOUT:if(c){const A=u.levels[u.loadLevel];if(A&&(c.type===ui.AUDIO_TRACK&&c.groupId===A.audioGroupId||c.type===ui.SUBTITLE_TRACK&&c.groupId===A.textGroupId)){n.errorAction=this.getPlaylistRetryOrSwitchAction(n,u.loadLevel),n.errorAction.action=yn.SendAlternateToPenaltyBox,n.errorAction.flags=zn.MoveAllAlternatesMatchingHost;return}}return;case D.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const A=u.levels[u.loadLevel],C=A==null?void 0:A.attrs["HDCP-LEVEL"];C&&(n.errorAction={action:yn.SendAlternateToPenaltyBox,flags:zn.MoveAllAlternatesMatchingHDCP,hdcpLevel:C})}return;case D.BUFFER_ADD_CODEC_ERROR:case D.REMUX_ALLOC_ERROR:n.errorAction=this.getLevelSwitchAction(n,(l=n.level)!=null?l:u.loadLevel);return;case D.INTERNAL_EXCEPTION:case D.BUFFER_APPENDING_ERROR:case D.BUFFER_APPEND_ERROR:case D.BUFFER_FULL_ERROR:case D.LEVEL_SWITCH_ERROR:case D.BUFFER_STALLED_ERROR:case D.BUFFER_SEEK_OVER_HOLE:case D.BUFFER_NUDGE_ON_STALL:n.errorAction={action:yn.DoNothing,flags:zn.None};return}if(n.type===$.KEY_SYSTEM_ERROR){const A=this.getVariantLevelIndex(n.frag);n.levelRetry=!1,n.errorAction=this.getLevelSwitchAction(n,A);return}}getPlaylistRetryOrSwitchAction(t,n){var a;const l=this.hls,u=pl(l.config.playlistLoadPolicy,t),c=this.playlistError++,p=(a=t.response)==null?void 0:a.code;if(ps(u,c,Fa(t),p))return{action:yn.RetryRequest,flags:zn.None,retryConfig:u,retryCount:c};const A=this.getLevelSwitchAction(t,n);return u&&(A.retryConfig=u,A.retryCount=c),A}getFragRetryOrSwitchAction(t){const n=this.hls,a=this.getVariantLevelIndex(t.frag),l=n.levels[a],{fragLoadPolicy:u,keyLoadPolicy:c}=n.config,p=pl(t.details.startsWith("key")?c:u,t),v=n.levels.reduce((O,U)=>O+U.fragmentError,0);if(l){var A;t.details!==D.FRAG_GAP&&l.fragmentError++;const O=(A=t.response)==null?void 0:A.code;if(ps(p,v,Fa(t),O))return{action:yn.RetryRequest,flags:zn.None,retryConfig:p,retryCount:v}}const C=this.getLevelSwitchAction(t,a);return p&&(C.retryConfig=p,C.retryCount=v),C}getLevelSwitchAction(t,n){const a=this.hls;n==null&&(n=a.loadLevel);const l=this.hls.levels[n];if(l&&(l.loadError++,a.autoLevelEnabled)){var u,c;let p=-1;const{levels:v,loadLevel:A,minAutoLevel:C,maxAutoLevel:O}=a,U=(u=t.frag)==null?void 0:u.type,{type:W,groupId:J}=(c=t.context)!=null?c:{};for(let oe=v.length;oe--;){const he=(oe+A)%v.length;if(he!==A&&he>=C&&he<=O&&v[he].loadError===0){const we=v[he];if(t.details===D.FRAG_GAP&&t.frag){const Fe=v[he].details;if(Fe){const Me=tn(t.frag,Fe.fragments,t.frag.start);if(Me!=null&&Me.gap)continue}}else{if(W===ui.AUDIO_TRACK&&J===we.audioGroupId||W===ui.SUBTITLE_TRACK&&J===we.textGroupId)continue;if(U===Gt.AUDIO&&l.audioGroupId===we.audioGroupId||U===Gt.SUBTITLE&&l.textGroupId===we.textGroupId)continue}p=he;break}}if(p>-1&&a.loadLevel!==p)return t.levelRetry=!0,this.playlistError=0,{action:yn.SendAlternateToPenaltyBox,flags:zn.None,nextAutoLevel:p}}return{action:yn.SendAlternateToPenaltyBox,flags:zn.MoveAllAlternatesMatchingHost}}onErrorOut(t,n){var a;switch((a=n.errorAction)==null?void 0:a.action){case yn.DoNothing:break;case yn.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(n),!n.errorAction.resolved&&n.details!==D.FRAG_GAP&&(n.fatal=!0);break}if(n.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(t){const n=this.hls,a=t.errorAction;if(!a)return;const{flags:l,hdcpLevel:u,nextAutoLevel:c}=a;switch(l){case zn.None:this.switchLevel(t,c);break;case zn.MoveAllAlternatesMatchingHost:a.resolved||(a.resolved=this.redundantFailover(t));break;case zn.MoveAllAlternatesMatchingHDCP:u&&(n.maxHdcpLevel=Bs[Bs.indexOf(u)-1],a.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${n.maxHdcpLevel}" or lower`);break}a.resolved||this.switchLevel(t,c)}switchLevel(t,n){n!==void 0&&t.errorAction&&(this.warn(`switching to level ${n} after ${t.details}`),this.hls.nextAutoLevel=n,t.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}redundantFailover(t){const{hls:n,penalizedRenditions:a}=this,l=t.parent===Gt.MAIN?t.level:n.loadLevel,u=n.levels[l],c=u.url.length,p=t.frag?t.frag.urlId:u.urlId;u.urlId===p&&(!t.frag||u.details)&&this.penalizeRendition(u,t);for(let v=1;v<c;v++){const A=(p+v)%c,C=a[A];if(!C||Ua(C,t,a[p]))return this.warn(`Switching to Redundant Stream ${A+1}/${c}: "${u.url[A]}" after ${t.details}`),this.playlistError=0,n.levels.forEach(O=>{O.urlId=A}),n.nextLoadLevel=l,!0}return!1}penalizeRendition(t,n){const{penalizedRenditions:a}=this,l=a[t.urlId]||{lastErrorPerfMs:0,errors:[],details:void 0};l.lastErrorPerfMs=performance.now(),l.errors.push(n),l.details=t.details,a[t.urlId]=l}}function Ua(f,t,n){if(performance.now()-f.lastErrorPerfMs>vl)return!0;const a=f.details;if(t.details===D.FRAG_GAP&&a&&t.frag){const l=t.frag.start,u=tn(null,a.fragments,l);if(u&&!u.gap)return!0}if(n&&f.errors.length<n.errors.length){const l=f.errors[f.errors.length-1];if(a&&l.frag&&t.frag&&Math.abs(l.frag.start-t.frag.start)>a.targetduration*3)return!0}return!1}class ja{constructor(t,n){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=T.log.bind(T,`${n}:`),this.warn=T.warn.bind(T,`${n}:`),this.hls=t}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){clearTimeout(this.timer),this.timer=-1}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(t,n){const a=n==null?void 0:n.renditionReports;if(a){let l=-1;for(let u=0;u<a.length;u++){const c=a[u];let p;try{p=new self.URL(c.URI,n.url).href}catch(v){T.warn(`Could not construct new URL for Rendition Report: ${v}`),p=c.URI||""}if(p===t){l=u;break}else p===t.substring(0,p.length)&&(l=u)}if(l!==-1){const u=a[l],c=parseInt(u["LAST-MSN"])||(n==null?void 0:n.lastPartSn);let p=parseInt(u["LAST-PART"])||(n==null?void 0:n.lastPartIndex);if(this.hls.config.lowLatencyMode){const v=Math.min(n.age-n.partTarget,n.targetduration);p>=0&&v>n.partTarget&&(p+=1)}return new mo(c,p>=0?p:void 0,ir.No)}}}loadPlaylist(t){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(t){return this.canLoad&&!!t&&!!t.url&&(!t.details||t.details.live)}shouldReloadPlaylist(t){return this.timer===-1&&this.requestScheduled===-1&&this.shouldLoadPlaylist(t)}playlistLoaded(t,n,a){const{details:l,stats:u}=n,c=self.performance.now(),p=u.loading.first?Math.max(0,c-u.loading.first):0;if(l.advancedDateTime=Date.now()-p,l.live||a!=null&&a.live){if(l.reloaded(a),a&&this.log(`live playlist ${t} ${l.advanced?"REFRESHED "+l.lastPartSn+"-"+l.lastPartIndex:l.updated?"UPDATED":"MISSED"}`),a&&l.fragments.length>0&&fu(a,l),!this.canLoad||!l.live)return;let v,A,C;if(l.canBlockReload&&l.endSN&&l.advanced){const he=this.hls.config.lowLatencyMode,we=l.lastPartSn,Fe=l.endSN,Me=l.lastPartIndex,it=Me!==-1,We=we===Fe,St=he?0:Me;it?(A=We?Fe+1:we,C=We?St:Me+1):A=Fe+1;const ut=l.age,gt=ut+l.ageHeader;let Ct=Math.min(gt-l.partTarget,l.targetduration*1.5);if(Ct>0){if(a&&Ct>a.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${a.tuneInGoal} to: ${Ct} with playlist age: ${l.age}`),Ct=0;else{const rt=Math.floor(Ct/l.targetduration);A+=rt,C!==void 0&&(C+=Math.round(Ct%l.targetduration/l.partTarget)),this.log(`CDN Tune-in age: ${l.ageHeader}s last advanced ${ut.toFixed(2)}s goal: ${Ct} skip sn ${rt} to part ${C}`)}l.tuneInGoal=Ct}if(v=this.getDeliveryDirectives(l,n.deliveryDirectives,A,C),he||!We){this.loadPlaylist(v);return}}else(l.canBlockReload||l.canSkipUntil)&&(v=this.getDeliveryDirectives(l,n.deliveryDirectives,A,C));const O=this.hls.mainForwardBufferInfo,U=O?O.end-O.len:0,W=(l.edge-U)*1e3,J=cl(l,W);l.updated&&c>this.requestScheduled+J&&(this.requestScheduled=u.loading.start),A!==void 0&&l.canBlockReload?this.requestScheduled=u.loading.first+J-(l.partTarget*1e3||1e3):this.requestScheduled===-1||this.requestScheduled+J<c?this.requestScheduled=c:this.requestScheduled-c<=0&&(this.requestScheduled+=J);let oe=this.requestScheduled-c;oe=Math.max(0,oe),this.log(`reload live playlist ${t} in ${Math.round(oe)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(v),oe)}else this.clearTimer()}getDeliveryDirectives(t,n,a,l){let u=ol(t,a);return n!=null&&n.skip&&t.deltaUpdateFailed&&(a=n.msn,l=n.part,u=ir.No),new mo(a,l,u)}checkRetry(t){const n=t.details,a=Fa(t),l=t.errorAction,{action:u,retryCount:c=0,retryConfig:p}=l||{},v=!!l&&!!p&&(u===yn.RetryRequest||!l.resolved&&u===yn.SendAlternateToPenaltyBox);if(v){var A;if(this.requestScheduled=-1,c>=p.maxNumRetry)return!1;if(a&&(A=t.context)!=null&&A.deliveryDirectives)this.warn(`Retrying playlist loading ${c+1}/${p.maxNumRetry} after "${n}" without delivery-directives`),this.loadPlaylist();else{const C=vo(p,c);this.timer=self.setTimeout(()=>this.loadPlaylist(),C),this.warn(`Retrying playlist loading ${c+1}/${p.maxNumRetry} after "${n}" in ${C}ms`)}t.levelRetry=!0,l.resolved=!0}return v}}let yr;class Ao extends ja{constructor(t,n){super(t,"[level-controller]");this._levels=[],this._firstLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=n,this._registerListeners()}_registerListeners(){const{hls:t}=this;t.on(y.MANIFEST_LOADING,this.onManifestLoading,this),t.on(y.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(y.LEVEL_LOADED,this.onLevelLoaded,this),t.on(y.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(y.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.on(y.FRAG_LOADED,this.onFragLoaded,this),t.on(y.ERROR,this.onError,this)}_unregisterListeners(){const{hls:t}=this;t.off(y.MANIFEST_LOADING,this.onManifestLoading,this),t.off(y.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(y.LEVEL_LOADED,this.onLevelLoaded,this),t.off(y.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(y.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.off(y.FRAG_LOADED,this.onFragLoaded,this),t.off(y.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}startLoad(){this._levels.forEach(n=>{n.loadError=0,n.fragmentError=0}),super.startLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[]}onManifestLoading(t,n){this.resetLevels()}onManifestLoaded(t,n){const a=[],l={};let u;n.levels.forEach(c=>{var p;const v=c.attrs;((p=c.audioCodec)==null?void 0:p.indexOf("mp4a.40.34"))!==-1&&(yr||(yr=/chrome|firefox/i.test(navigator.userAgent)),yr&&(c.audioCodec=void 0));const{AUDIO:A,CODECS:C,"FRAME-RATE":O,"PATHWAY-ID":U,RESOLUTION:W,SUBTITLES:J}=v,he=`${`${U||"."}-`}${c.bitrate}-${W}-${O}-${C}`;u=l[he],u?u.addFallback(c):(u=new Ms(c),l[he]=u,a.push(u)),oa(u,"audio",A),oa(u,"text",J)}),this.filterAndSortMediaOptions(a,n)}filterAndSortMediaOptions(t,n){let a=[],l=[],u=!1,c=!1,p=!1,v=t.filter(({audioCodec:W,videoCodec:J,width:oe,height:he,unknownCodecs:we})=>(u||(u=!!(oe&&he)),c||(c=!!J),p||(p=!!W),!(we!=null&&we.length)&&(!W||kr(W,"audio"))&&(!J||kr(J,"video"))));if((u||c)&&p&&(v=v.filter(({videoCodec:W,width:J,height:oe})=>!!W||!!(J&&oe))),v.length===0){Promise.resolve().then(()=>{if(this.hls){const W=new Error("no level with compatible codecs found in manifest");this.hls.trigger(y.ERROR,{type:$.MEDIA_ERROR,details:D.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:n.url,error:W,reason:W.message})}});return}n.audioTracks&&(a=n.audioTracks.filter(W=>!W.audioCodec||kr(W.audioCodec,"audio")),jn(a)),n.subtitles&&(l=n.subtitles,jn(l));const A=v.slice(0);v.sort((W,J)=>W.attrs["HDCP-LEVEL"]!==J.attrs["HDCP-LEVEL"]?(W.attrs["HDCP-LEVEL"]||"")>(J.attrs["HDCP-LEVEL"]||"")?1:-1:W.bitrate!==J.bitrate?W.bitrate-J.bitrate:W.attrs["FRAME-RATE"]!==J.attrs["FRAME-RATE"]?W.attrs.decimalFloatingPoint("FRAME-RATE")-J.attrs.decimalFloatingPoint("FRAME-RATE"):W.attrs.SCORE!==J.attrs.SCORE?W.attrs.decimalFloatingPoint("SCORE")-J.attrs.decimalFloatingPoint("SCORE"):u&&W.height!==J.height?W.height-J.height:0);let C=A[0];if(this.steering&&(v=this.steering.filterParsedLevels(v),v.length!==A.length)){for(let W=0;W<A.length;W++)if(A[W].pathwayId===v[0].pathwayId){C=A[W];break}}this._levels=v;for(let W=0;W<v.length;W++)if(v[W]===C){this._firstLevel=W,this.log(`manifest loaded, ${v.length} level(s) found, first bitrate: ${C.bitrate}`);break}const O=p&&!c,U={levels:v,audioTracks:a,subtitleTracks:l,sessionData:n.sessionData,sessionKeys:n.sessionKeys,firstLevel:this._firstLevel,stats:n.stats,audio:p,video:c,altAudio:!O&&a.some(W=>!!W.url)};this.hls.trigger(y.MANIFEST_PARSED,U),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return this._levels.length===0?null:this._levels}get level(){return this.currentLevelIndex}set level(t){const n=this._levels;if(n.length===0)return;if(t<0||t>=n.length){const C=new Error("invalid level idx"),O=t<0;if(this.hls.trigger(y.ERROR,{type:$.OTHER_ERROR,details:D.LEVEL_SWITCH_ERROR,level:t,fatal:O,error:C,reason:C.message}),O)return;t=Math.min(t,n.length-1)}const a=this.currentLevelIndex,l=this.currentLevel,u=l?l.attrs["PATHWAY-ID"]:void 0,c=n[t],p=c.attrs["PATHWAY-ID"];if(this.currentLevelIndex=t,this.currentLevel=c,a===t&&c.details&&l&&u===p)return;this.log(`Switching to level ${t}${p?" with Pathway "+p:""} from level ${a}${u?" with Pathway "+u:""}`);const v=Ee({},c,{level:t,maxBitrate:c.maxBitrate,attrs:c.attrs,uri:c.uri,urlId:c.urlId});delete v._attrs,delete v._urlId,this.hls.trigger(y.LEVEL_SWITCHING,v);const A=c.details;if(!A||A.live){const C=this.switchParams(c.uri,l==null?void 0:l.details);this.loadPlaylist(C)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(t){this.manualLevelIndex=t,this._startLevel===void 0&&(this._startLevel=t),t!==-1&&(this.level=t)}get firstLevel(){return this._firstLevel}set firstLevel(t){this._firstLevel=t}get startLevel(){if(this._startLevel===void 0){const t=this.hls.config.startLevel;return t!==void 0?t:this._firstLevel}else return this._startLevel}set startLevel(t){this._startLevel=t}onError(t,n){n.fatal||!n.context||n.context.type===ui.LEVEL&&n.context.level===this.level&&this.checkRetry(n)}onFragLoaded(t,{frag:n}){if(n!==void 0&&n.type===Gt.MAIN){const a=this._levels[n.level];a!==void 0&&(a.loadError=0)}}onLevelLoaded(t,n){var a;const{level:l,details:u}=n,c=this._levels[l];if(!c){var p;this.warn(`Invalid level index ${l}`),(p=n.deliveryDirectives)!=null&&p.skip&&(u.deltaUpdateFailed=!0);return}l===this.currentLevelIndex?(c.fragmentError===0&&(c.loadError=0),this.playlistLoaded(l,n,c.details)):(a=n.deliveryDirectives)!=null&&a.skip&&(u.deltaUpdateFailed=!0)}onAudioTrackSwitched(t,n){const a=this.currentLevel;if(!a)return;const l=this.hls.audioTracks[n.id].groupId;if(a.audioGroupIds&&a.audioGroupId!==l){let u=-1;for(let c=0;c<a.audioGroupIds.length;c++)if(a.audioGroupIds[c]===l){u=c;break}u!==-1&&u!==a.urlId&&(a.urlId=u,this.canLoad&&this.startLoad())}}loadPlaylist(t){super.loadPlaylist();const n=this.currentLevelIndex,a=this.currentLevel;if(a&&this.shouldLoadPlaylist(a)){const l=a.urlId;let u=a.uri;if(t)try{u=t.addDirectives(u)}catch(p){this.warn(`Could not construct new URL with HLS Delivery Directives: ${p}`)}const c=a.attrs["PATHWAY-ID"];this.log(`Loading level index ${n}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""} with${c?" Pathway "+c:""} URI ${l+1}/${a.url.length} ${u}`),this.clearTimer(),this.hls.trigger(y.LEVEL_LOADING,{url:u,level:n,id:l,deliveryDirectives:t||null})}}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(t){this.level=t,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=t)}removeLevel(t,n){const a=(u,c)=>c!==n,l=this._levels.filter((u,c)=>c!==t?!0:u.url.length>1&&n!==void 0?(u.url=u.url.filter(a),u.audioGroupIds&&(u.audioGroupIds=u.audioGroupIds.filter(a)),u.textGroupIds&&(u.textGroupIds=u.textGroupIds.filter(a)),u.urlId=0,!0):(this.steering&&this.steering.removeLevel(u),!1));this.hls.trigger(y.LEVELS_UPDATED,{levels:l})}onLevelsUpdated(t,{levels:n}){n.forEach((a,l)=>{const{details:u}=a;u!=null&&u.fragments&&u.fragments.forEach(c=>{c.level=l})}),this._levels=n}}function oa(f,t,n){!n||(t==="audio"?(f.audioGroupIds||(f.audioGroupIds=[]),f.audioGroupIds[f.url.length-1]=n):t==="text"&&(f.textGroupIds||(f.textGroupIds=[]),f.textGroupIds[f.url.length-1]=n))}function jn(f){const t={};f.forEach(n=>{const a=n.groupId||"";n.id=t[a]=t[a]||0,t[a]++})}var ei={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class Al{constructor(t){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=t,this._registerListeners()}_registerListeners(){const{hls:t}=this;t.on(y.BUFFER_APPENDED,this.onBufferAppended,this),t.on(y.FRAG_BUFFERED,this.onFragBuffered,this),t.on(y.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:t}=this;t.off(y.BUFFER_APPENDED,this.onBufferAppended,this),t.off(y.FRAG_BUFFERED,this.onFragBuffered,this),t.off(y.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(t,n){const a=this.activePartLists[n];if(a)for(let l=a.length;l--;){const u=a[l];if(!u)break;const c=u.end;if(u.start<=t&&c!==null&&t<=c)return u}return this.getBufferedFrag(t,n)}getBufferedFrag(t,n){const{fragments:a}=this,l=Object.keys(a);for(let u=l.length;u--;){const c=a[l[u]];if((c==null?void 0:c.body.type)===n&&c.buffered){const p=c.body;if(p.start<=t&&t<=p.end)return p}}return null}detectEvictedFragments(t,n,a,l){this.timeRanges&&(this.timeRanges[t]=n);const u=(l==null?void 0:l.fragment.sn)||-1;Object.keys(this.fragments).forEach(c=>{const p=this.fragments[c];if(!p||u>=p.body.sn)return;if(!p.buffered&&!p.loaded){p.body.type===a&&this.removeFragment(p.body);return}const v=p.range[t];!v||v.time.some(A=>{const C=!this.isTimeBuffered(A.startPTS,A.endPTS,n);return C&&this.removeFragment(p.body),C})})}detectPartialFragments(t){const n=this.timeRanges,{frag:a,part:l}=t;if(!n||a.sn==="initSegment")return;const u=Jr(a),c=this.fragments[u];if(!c||c.buffered&&a.gap)return;const p=!a.relurl;Object.keys(n).forEach(v=>{const A=a.elementaryStreams[v];if(!A)return;const C=n[v],O=p||A.partial===!0;c.range[v]=this.getBufferedTimes(a,l,O,C)}),c.loaded=null,Object.keys(c.range).length?(c.buffered=!0,(c.body.endList=a.endList||c.body.endList)&&(this.endListFragments[c.body.type]=c),Ir(c)||this.removeParts(a.sn-1,a.type)):this.removeFragment(c.body)}removeParts(t,n){const a=this.activePartLists[n];!a||(this.activePartLists[n]=a.filter(l=>l.fragment.sn>=t))}fragBuffered(t,n){const a=Jr(t);let l=this.fragments[a];!l&&n&&(l=this.fragments[a]={body:t,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},t.gap&&(this.hasGaps=!0)),l&&(l.loaded=null,l.buffered=!0)}getBufferedTimes(t,n,a,l){const u={time:[],partial:a},c=t.start,p=t.end,v=t.minEndPTS||p,A=t.maxStartPTS||c;for(let C=0;C<l.length;C++){const O=l.start(C)-this.bufferPadding,U=l.end(C)+this.bufferPadding;if(A>=O&&v<=U){u.time.push({startPTS:Math.max(c,l.start(C)),endPTS:Math.min(p,l.end(C))});break}else if(c<U&&p>O)u.partial=!0,u.time.push({startPTS:Math.max(c,l.start(C)),endPTS:Math.min(p,l.end(C))});else if(p<=O)break}return u}getPartialFragment(t){let n=null,a,l,u,c=0;const{bufferPadding:p,fragments:v}=this;return Object.keys(v).forEach(A=>{const C=v[A];!C||Ir(C)&&(l=C.body.start-p,u=C.body.end+p,t>=l&&t<=u&&(a=Math.min(t-l,u-t),c<=a&&(n=C.body,c=a)))}),n}isEndListAppended(t){const n=this.endListFragments[t];return n!==void 0&&(n.buffered||Ir(n))}getState(t){const n=Jr(t),a=this.fragments[n];return a?a.buffered?Ir(a)?ei.PARTIAL:ei.OK:ei.APPENDING:ei.NOT_LOADED}isTimeBuffered(t,n,a){let l,u;for(let c=0;c<a.length;c++){if(l=a.start(c)-this.bufferPadding,u=a.end(c)+this.bufferPadding,t>=l&&n<=u)return!0;if(n<=l)return!1}return!1}onFragLoaded(t,n){const{frag:a,part:l}=n;if(a.sn==="initSegment"||a.bitrateTest)return;const u=l?null:n,c=Jr(a);this.fragments[c]={body:a,appendedPTS:null,loaded:u,buffered:!1,range:Object.create(null)}}onBufferAppended(t,n){const{frag:a,part:l,timeRanges:u}=n;if(a.sn==="initSegment")return;const c=a.type;if(l){let p=this.activePartLists[c];p||(this.activePartLists[c]=p=[]),p.push(l)}this.timeRanges=u,Object.keys(u).forEach(p=>{const v=u[p];this.detectEvictedFragments(p,v,c,l)})}onFragBuffered(t,n){this.detectPartialFragments(n)}hasFragment(t){const n=Jr(t);return!!this.fragments[n]}hasParts(t){var n;return!!((n=this.activePartLists[t])!=null&&n.length)}removeFragmentsInRange(t,n,a,l,u){l&&!this.hasGaps||Object.keys(this.fragments).forEach(c=>{const p=this.fragments[c];if(!p)return;const v=p.body;v.type!==a||l&&!v.gap||v.start<n&&v.end>t&&(p.buffered||u)&&this.removeFragment(v)})}removeFragment(t){const n=Jr(t);t.stats.loaded=0,t.clearElementaryStreamInfo();const a=this.activePartLists[t.type];if(a){const l=t.sn;this.activePartLists[t.type]=a.filter(u=>u.fragment.sn!==l)}delete this.fragments[n],t.endList&&delete this.endListFragments[t.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function Ir(f){var t,n,a;return f.buffered&&(f.body.gap||((t=f.range.video)==null?void 0:t.partial)||((n=f.range.audio)==null?void 0:n.partial)||((a=f.range.audiovideo)==null?void 0:a.partial))}function Jr(f){return`${f.type}_${f.level}_${f.urlId}_${f.sn}`}const bl=Math.pow(2,17);class bo{constructor(t){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=t}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(t,n){const a=t.url;if(!a)return Promise.reject(new vr({type:$.NETWORK_ERROR,details:D.FRAG_LOAD_ERROR,fatal:!1,frag:t,error:new Error(`Fragment does not have a ${a?"part list":"url"}`),networkDetails:null}));this.abort();const l=this.config,u=l.fLoader,c=l.loader;return new Promise((p,v)=>{if(this.loader&&this.loader.destroy(),t.gap)if(t.tagList.some(W=>W[0]==="GAP")){v(_o(t));return}else t.gap=!1;const A=this.loader=t.loader=u?new u(l):new c(l),C=Zr(t),O=ml(l.fragLoadPolicy.default),U={loadPolicy:O,timeout:O.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:t.sn==="initSegment"?Infinity:bl};t.stats=A.stats,A.load(C,U,{onSuccess:(W,J,oe,he)=>{this.resetLoader(t,A);let we=W.data;oe.resetIV&&t.decryptdata&&(t.decryptdata.iv=new Uint8Array(we.slice(0,16)),we=we.slice(16)),p({frag:t,part:null,payload:we,networkDetails:he})},onError:(W,J,oe,he)=>{this.resetLoader(t,A),v(new vr({type:$.NETWORK_ERROR,details:D.FRAG_LOAD_ERROR,fatal:!1,frag:t,response:tt({url:a,data:void 0},W),error:new Error(`HTTP Error ${W.code} ${W.text}`),networkDetails:oe,stats:he}))},onAbort:(W,J,oe)=>{this.resetLoader(t,A),v(new vr({type:$.NETWORK_ERROR,details:D.INTERNAL_ABORTED,fatal:!1,frag:t,error:new Error("Aborted"),networkDetails:oe,stats:W}))},onTimeout:(W,J,oe)=>{this.resetLoader(t,A),v(new vr({type:$.NETWORK_ERROR,details:D.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,error:new Error(`Timeout after ${U.timeout}ms`),networkDetails:oe,stats:W}))},onProgress:(W,J,oe,he)=>{n&&n({frag:t,part:null,payload:oe,networkDetails:he})}})})}loadPart(t,n,a){this.abort();const l=this.config,u=l.fLoader,c=l.loader;return new Promise((p,v)=>{if(this.loader&&this.loader.destroy(),t.gap||n.gap){v(_o(t,n));return}const A=this.loader=t.loader=u?new u(l):new c(l),C=Zr(t,n),O=ml(l.fragLoadPolicy.default),U={loadPolicy:O,timeout:O.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:bl};n.stats=A.stats,A.load(C,U,{onSuccess:(W,J,oe,he)=>{this.resetLoader(t,A),this.updateStatsFromPart(t,n);const we={frag:t,part:n,payload:W.data,networkDetails:he};a(we),p(we)},onError:(W,J,oe,he)=>{this.resetLoader(t,A),v(new vr({type:$.NETWORK_ERROR,details:D.FRAG_LOAD_ERROR,fatal:!1,frag:t,part:n,response:tt({url:C.url,data:void 0},W),error:new Error(`HTTP Error ${W.code} ${W.text}`),networkDetails:oe,stats:he}))},onAbort:(W,J,oe)=>{t.stats.aborted=n.stats.aborted,this.resetLoader(t,A),v(new vr({type:$.NETWORK_ERROR,details:D.INTERNAL_ABORTED,fatal:!1,frag:t,part:n,error:new Error("Aborted"),networkDetails:oe,stats:W}))},onTimeout:(W,J,oe)=>{this.resetLoader(t,A),v(new vr({type:$.NETWORK_ERROR,details:D.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,part:n,error:new Error(`Timeout after ${U.timeout}ms`),networkDetails:oe,stats:W}))}})})}updateStatsFromPart(t,n){const a=t.stats,l=n.stats,u=l.total;if(a.loaded+=l.loaded,u){const v=Math.round(t.duration/n.duration),A=Math.min(Math.round(a.loaded/u),v),O=(v-A)*Math.round(a.loaded/A);a.total=a.loaded+O}else a.total=Math.max(a.loaded,a.total);const c=a.loading,p=l.loading;c.start?c.first+=p.first-p.start:(c.start=p.start,c.first=p.first),c.end=p.end}resetLoader(t,n){t.loader=null,this.loader===n&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),n.destroy()}}function Zr(f,t=null){const n=t||f,a={frag:f,part:t,responseType:"arraybuffer",url:n.url,headers:{},rangeStart:0,rangeEnd:0},l=n.byteRangeStartOffset,u=n.byteRangeEndOffset;if(te(l)&&te(u)){var c;let p=l,v=u;if(f.sn==="initSegment"&&((c=f.decryptdata)==null?void 0:c.method)==="AES-128"){const A=u-l;A%16&&(v=u+(16-A%16)),l!==0&&(a.resetIV=!0,p=l-16)}a.rangeStart=p,a.rangeEnd=v}return a}function _o(f,t){const n=new Error(`GAP ${f.gap?"tag":"attribute"} found`),a={type:$.MEDIA_ERROR,details:D.FRAG_GAP,fatal:!1,frag:f,error:n,networkDetails:null};return t&&(a.part=t),(t||f).stats.aborted=!0,new vr(a)}class vr extends Error{constructor(t){super(t.error.message);this.data=void 0,this.data=t}}class xo{constructor(t){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=t}abort(t){for(const n in this.keyUriToKeyInfo){const a=this.keyUriToKeyInfo[n].loader;if(a){if(t&&t!==a.context.frag.type)return;a.abort()}}}detach(){for(const t in this.keyUriToKeyInfo){const n=this.keyUriToKeyInfo[t];(n.mediaKeySessionContext||n.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[t]}}destroy(){this.detach();for(const t in this.keyUriToKeyInfo){const n=this.keyUriToKeyInfo[t].loader;n&&n.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(t,n=D.KEY_LOAD_ERROR,a,l,u){return new vr({type:$.NETWORK_ERROR,details:n,fatal:!1,frag:t,response:u,error:a,networkDetails:l})}loadClear(t,n){if(this.emeController&&this.config.emeEnabled){const{sn:a,cc:l}=t;for(let u=0;u<n.length;u++){const c=n[u];if(l<=c.cc&&(a==="initSegment"||c.sn==="initSegment"||a<c.sn)){this.emeController.selectKeySystemFormat(c).then(p=>{c.setKeyFormat(p)});break}}}}load(t){return!t.decryptdata&&t.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(t).then(n=>this.loadInternal(t,n)):this.loadInternal(t)}loadInternal(t,n){var a,l;n&&t.setKeyFormat(n);const u=t.decryptdata;if(!u){const A=new Error(n?`Expected frag.decryptdata to be defined after setting format ${n}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(t,D.KEY_LOAD_ERROR,A))}const c=u.uri;if(!c)return Promise.reject(this.createKeyLoadError(t,D.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${c}"`)));let p=this.keyUriToKeyInfo[c];if((a=p)!=null&&a.decryptdata.key)return u.key=p.decryptdata.key,Promise.resolve({frag:t,keyInfo:p});if((l=p)!=null&&l.keyLoadPromise){var v;switch((v=p.mediaKeySessionContext)==null?void 0:v.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return p.keyLoadPromise.then(A=>(u.key=A.keyInfo.decryptdata.key,{frag:t,keyInfo:p}))}}switch(p=this.keyUriToKeyInfo[c]={decryptdata:u,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},u.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return u.keyFormat==="identity"?this.loadKeyHTTP(p,t):this.loadKeyEME(p,t);case"AES-128":return this.loadKeyHTTP(p,t);default:return Promise.reject(this.createKeyLoadError(t,D.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${u.method}"`)))}}loadKeyEME(t,n){const a={frag:n,keyInfo:t};if(this.emeController&&this.config.emeEnabled){const l=this.emeController.loadKey(a);if(l)return(t.keyLoadPromise=l.then(u=>(t.mediaKeySessionContext=u,a))).catch(u=>{throw t.keyLoadPromise=null,u})}return Promise.resolve(a)}loadKeyHTTP(t,n){const a=this.config,l=a.loader,u=new l(a);return n.keyLoader=t.loader=u,t.keyLoadPromise=new Promise((c,p)=>{const v={keyInfo:t,frag:n,responseType:"arraybuffer",url:t.decryptdata.uri},A=a.keyLoadPolicy.default,C={loadPolicy:A,timeout:A.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},O={onSuccess:(U,W,J,oe)=>{const{frag:he,keyInfo:we,url:Fe}=J;if(!he.decryptdata||we!==this.keyUriToKeyInfo[Fe])return p(this.createKeyLoadError(he,D.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),oe));we.decryptdata.key=he.decryptdata.key=new Uint8Array(U.data),he.keyLoader=null,we.loader=null,c({frag:he,keyInfo:we})},onError:(U,W,J,oe)=>{this.resetLoader(W),p(this.createKeyLoadError(n,D.KEY_LOAD_ERROR,new Error(`HTTP Error ${U.code} loading key ${U.text}`),J,tt({url:v.url,data:void 0},U)))},onTimeout:(U,W,J)=>{this.resetLoader(W),p(this.createKeyLoadError(n,D.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),J))},onAbort:(U,W,J)=>{this.resetLoader(W),p(this.createKeyLoadError(n,D.INTERNAL_ABORTED,new Error("key loading aborted"),J))}};u.load(v,C,O)})}resetLoader(t){const{frag:n,keyInfo:a,url:l}=t,u=a.loader;n.keyLoader===u&&(n.keyLoader=null,a.loader=null),delete this.keyUriToKeyInfo[l],u&&u.destroy()}}class Us{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(t){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,t),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}const _l={length:0,start:()=>0,end:()=>0};class ni{static isBuffered(t,n){try{if(t){const a=ni.getBuffered(t);for(let l=0;l<a.length;l++)if(n>=a.start(l)&&n<=a.end(l))return!0}}catch(a){}return!1}static bufferInfo(t,n,a){try{if(t){const l=ni.getBuffered(t),u=[];let c;for(c=0;c<l.length;c++)u.push({start:l.start(c),end:l.end(c)});return this.bufferedInfo(u,n,a)}}catch(l){}return{len:0,start:n,end:n,nextStart:void 0}}static bufferedInfo(t,n,a){n=Math.max(0,n),t.sort(function(A,C){const O=A.start-C.start;return O||C.end-A.end});let l=[];if(a)for(let A=0;A<t.length;A++){const C=l.length;if(C){const O=l[C-1].end;t[A].start-O<a?t[A].end>O&&(l[C-1].end=t[A].end):l.push(t[A])}else l.push(t[A])}else l=t;let u=0,c,p=n,v=n;for(let A=0;A<l.length;A++){const C=l[A].start,O=l[A].end;if(n+a>=C&&n<O)p=C,v=O,u=v-n;else if(n+a<C){c=C;break}}return{len:u,start:p||0,end:v||0,nextStart:c}}static getBuffered(t){try{return t.buffered}catch(n){return T.log("failed to get media.buffered",n),_l}}}class $n{constructor(t,n,a,l=0,u=-1,c=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=ms(),this.buffering={audio:ms(),video:ms(),audiovideo:ms()},this.level=t,this.sn=n,this.id=a,this.size=l,this.part=u,this.partial=c}}function ms(){return{start:0,executeStart:0,executeEnd:0,end:0}}function Eo(f,t){let n=null;for(let a=0,l=f.length;a<l;a++){const u=f[a];if(u&&u.cc===t){n=u;break}}return n}function $a(f,t,n){return!!(t.details&&(n.endCC>n.startCC||f&&f.cc<n.startCC))}function js(f,t,n=0){const a=f.fragments,l=t.fragments;if(!l.length||!a.length){T.log("No fragments to align");return}const u=Eo(a,l[0].cc);if(!u||u&&!u.startPTS){T.log("No frag in previous level to align on");return}return u}function $s(f,t){if(f){const n=f.start+t;f.start=f.startPTS=n,f.endPTS=n+f.duration}}function la(f,t){const n=t.fragments;for(let a=0,l=n.length;a<l;a++)$s(n[a],f);t.fragmentHint&&$s(t.fragmentHint,f),t.alignedSliding=!0}function Ar(f,t,n){!t||(Vn(f,n,t),!n.alignedSliding&&t.details&&xl(n,t.details),!n.alignedSliding&&t.details&&!n.skippedSegments&&yo(t.details,n))}function Vn(f,t,n){if($a(f,n,t)){const a=js(n.details,t);a&&te(a.start)&&(T.log(`Adjusting PTS using last level due to CC increase within current level ${t.url}`),la(a.start,t))}}function xl(f,t){if(!t.fragments.length||!f.hasProgramDateTime||!t.hasProgramDateTime)return;const n=t.fragments[0].programDateTime,a=f.fragments[0].programDateTime,l=(a-n)/1e3+t.fragments[0].start;l&&te(l)&&(T.log(`Adjusting PTS using programDateTime delta ${a-n}ms, sliding:${l.toFixed(3)} ${f.url} `),la(l,f))}function Va(f,t){if(!f.hasProgramDateTime||!t.hasProgramDateTime)return;const n=f.fragments,a=t.fragments;if(!n.length||!a.length)return;const l=Math.round(a.length/2)-1,u=a[l],c=Eo(n,u.cc)||n[Math.round(n.length/2)-1],p=u.programDateTime,v=c.programDateTime;if(p===null||v===null)return;const A=(v-p)/1e3-(c.start-u.start);la(A,f)}class El{constructor(t,n){this.subtle=void 0,this.aesIV=void 0,this.subtle=t,this.aesIV=n}decrypt(t,n){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},n,t)}}class Rr{constructor(t,n){this.subtle=void 0,this.key=void 0,this.subtle=t,this.key=n}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}function ua(f){const t=f.byteLength,n=t&&new DataView(f.buffer).getUint8(t-1);return n?Qt(f,0,t-n):f}class To{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(t){const n=new DataView(t),a=new Uint32Array(4);for(let l=0;l<4;l++)a[l]=n.getUint32(l*4);return a}initTable(){const t=this.sBox,n=this.invSBox,a=this.subMix,l=a[0],u=a[1],c=a[2],p=a[3],v=this.invSubMix,A=v[0],C=v[1],O=v[2],U=v[3],W=new Uint32Array(256);let J=0,oe=0,he=0;for(he=0;he<256;he++)he<128?W[he]=he<<1:W[he]=he<<1^283;for(he=0;he<256;he++){let we=oe^oe<<1^oe<<2^oe<<3^oe<<4;we=we>>>8^we&255^99,t[J]=we,n[we]=J;const Fe=W[J],Me=W[Fe],it=W[Me];let We=W[we]*257^we*16843008;l[J]=We<<24|We>>>8,u[J]=We<<16|We>>>16,c[J]=We<<8|We>>>24,p[J]=We,We=it*16843009^Me*65537^Fe*257^J*16843008,A[we]=We<<24|We>>>8,C[we]=We<<16|We>>>16,O[we]=We<<8|We>>>24,U[we]=We,J?(J=Fe^W[W[W[it^Fe]]],oe^=W[W[oe]]):J=oe=1}}expandKey(t){const n=this.uint8ArrayToUint32Array_(t);let a=!0,l=0;for(;l<n.length&&a;)a=n[l]===this.key[l],l++;if(a)return;this.key=n;const u=this.keySize=n.length;if(u!==4&&u!==6&&u!==8)throw new Error("Invalid aes key size="+u);const c=this.ksRows=(u+6+1)*4;let p,v;const A=this.keySchedule=new Uint32Array(c),C=this.invKeySchedule=new Uint32Array(c),O=this.sBox,U=this.rcon,W=this.invSubMix,J=W[0],oe=W[1],he=W[2],we=W[3];let Fe,Me;for(p=0;p<c;p++){if(p<u){Fe=A[p]=n[p];continue}Me=Fe,p%u==0?(Me=Me<<8|Me>>>24,Me=O[Me>>>24]<<24|O[Me>>>16&255]<<16|O[Me>>>8&255]<<8|O[Me&255],Me^=U[p/u|0]<<24):u>6&&p%u==4&&(Me=O[Me>>>24]<<24|O[Me>>>16&255]<<16|O[Me>>>8&255]<<8|O[Me&255]),A[p]=Fe=(A[p-u]^Me)>>>0}for(v=0;v<c;v++)p=c-v,v&3?Me=A[p]:Me=A[p-4],v<4||p<=4?C[v]=Me:C[v]=J[O[Me>>>24]]^oe[O[Me>>>16&255]]^he[O[Me>>>8&255]]^we[O[Me&255]],C[v]=C[v]>>>0}networkToHostOrderSwap(t){return t<<24|(t&65280)<<8|(t&16711680)>>8|t>>>24}decrypt(t,n,a){const l=this.keySize+6,u=this.invKeySchedule,c=this.invSBox,p=this.invSubMix,v=p[0],A=p[1],C=p[2],O=p[3],U=this.uint8ArrayToUint32Array_(a);let W=U[0],J=U[1],oe=U[2],he=U[3];const we=new Int32Array(t),Fe=new Int32Array(we.length);let Me,it,We,St,ut,gt,Ct,rt,qt,Ot,Si,Pn,Pi,Ni;const Ui=this.networkToHostOrderSwap;for(;n<we.length;){for(qt=Ui(we[n]),Ot=Ui(we[n+1]),Si=Ui(we[n+2]),Pn=Ui(we[n+3]),ut=qt^u[0],gt=Pn^u[1],Ct=Si^u[2],rt=Ot^u[3],Pi=4,Ni=1;Ni<l;Ni++)Me=v[ut>>>24]^A[gt>>16&255]^C[Ct>>8&255]^O[rt&255]^u[Pi],it=v[gt>>>24]^A[Ct>>16&255]^C[rt>>8&255]^O[ut&255]^u[Pi+1],We=v[Ct>>>24]^A[rt>>16&255]^C[ut>>8&255]^O[gt&255]^u[Pi+2],St=v[rt>>>24]^A[ut>>16&255]^C[gt>>8&255]^O[Ct&255]^u[Pi+3],ut=Me,gt=it,Ct=We,rt=St,Pi=Pi+4;Me=c[ut>>>24]<<24^c[gt>>16&255]<<16^c[Ct>>8&255]<<8^c[rt&255]^u[Pi],it=c[gt>>>24]<<24^c[Ct>>16&255]<<16^c[rt>>8&255]<<8^c[ut&255]^u[Pi+1],We=c[Ct>>>24]<<24^c[rt>>16&255]<<16^c[ut>>8&255]<<8^c[gt&255]^u[Pi+2],St=c[rt>>>24]<<24^c[ut>>16&255]<<16^c[gt>>8&255]<<8^c[Ct&255]^u[Pi+3],Fe[n]=Ui(Me^W),Fe[n+1]=Ui(St^J),Fe[n+2]=Ui(We^oe),Fe[n+3]=Ui(it^he),W=qt,J=Ot,oe=Si,he=Pn,n=n+4}return Fe.buffer}}const Vs=16;class Yi{constructor(t,{removePKCS7Padding:n=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=t.enableSoftwareAES,this.removePKCS7Padding=n,n)try{const a=self.crypto;a&&(this.subtle=a.subtle||a.webkitSubtle)}catch(a){}this.subtle===null&&(this.useSoftware=!0)}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:t,remainderData:n}=this;if(!t||n)return this.reset(),null;const a=new Uint8Array(t);return this.reset(),this.removePKCS7Padding?ua(a):a}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(t,n,a){return this.useSoftware?new Promise((l,u)=>{this.softwareDecrypt(new Uint8Array(t),n,a);const c=this.flush();c?l(c.buffer):u(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(t),n,a)}softwareDecrypt(t,n,a){const{currentIV:l,currentResult:u,remainderData:c}=this;this.logOnce("JS AES decrypt"),c&&(t=hn(c,t),this.remainderData=null);const p=this.getValidChunk(t);if(!p.length)return null;l&&(a=l);let v=this.softwareDecrypter;v||(v=this.softwareDecrypter=new To),v.expandKey(n);const A=u;return this.currentResult=v.decrypt(p.buffer,0,a),this.currentIV=Qt(p,-16).buffer,A||null}webCryptoDecrypt(t,n,a){const l=this.subtle;return(this.key!==n||!this.fastAesKey)&&(this.key=n,this.fastAesKey=new Rr(l,n)),this.fastAesKey.expandKey().then(u=>l?(this.logOnce("WebCrypto AES decrypt"),new El(l,new Uint8Array(a)).decrypt(t.buffer,u)):Promise.reject(new Error("web crypto not initialized"))).catch(u=>(T.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${u.name}: ${u.message}`),this.onWebCryptoError(t,n,a)))}onWebCryptoError(t,n,a){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(t,n,a);const l=this.flush();if(l)return l.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(t){let n=t;const a=t.length-t.length%Vs;return a!==t.length&&(n=Qt(t,0,a),this.remainderData=Qt(t,a)),n}logOnce(t){!this.logEnabled||(T.log(`[decrypter]: ${t}`),this.logEnabled=!1)}}const Tl={toString:function(f){let t="";const n=f.length;for(let a=0;a<n;a++)t+=`[${f.start(a).toFixed(3)}-${f.end(a).toFixed(3)}]`;return t}},st={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class ri extends Us{constructor(t,n,a,l,u){super();this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=st.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=u,this.logPrefix=l,this.log=T.log.bind(T,`${l}:`),this.warn=T.warn.bind(T,`${l}:`),this.hls=t,this.fragmentLoader=new bo(t.config),this.keyLoader=a,this.fragmentTracker=n,this.config=t.config,this.decrypter=new Yi(t.config),t.on(y.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(t){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const t=this.fragCurrent;t!=null&&t.loader&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=st.STOPPED}_streamEnded(t,n){if(n.live||t.nextStart||!t.end||!this.media)return!1;const a=n.partList;if(a!=null&&a.length){const u=a[a.length-1];return ni.isBuffered(this.media,u.start+u.duration/2)}const l=n.fragments[n.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(l)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var t;return(t=this.levels[this.levelLastLoaded])==null?void 0:t.details}}onMediaAttached(t,n){const a=this.media=this.mediaBuffer=n.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),a.addEventListener("seeking",this.onvseeking),a.addEventListener("ended",this.onvended);const l=this.config;this.levels&&l.autoStartLoad&&this.state===st.STOPPED&&this.startLoad(l.startPosition)}onMediaDetaching(){const t=this.media;t!=null&&t.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),t&&this.onvseeking&&this.onvended&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:t,fragCurrent:n,media:a,mediaBuffer:l,state:u}=this,c=a?a.currentTime:0,p=ni.bufferInfo(l||a,c,t.maxBufferHole);if(this.log(`media seeking to ${te(c)?c.toFixed(3):c}, state: ${u}`),this.state===st.ENDED)this.resetLoadingState();else if(n){const v=t.maxFragLookUpTolerance,A=n.start-v,C=n.start+n.duration+v;if(!p.len||C<p.start||A>p.end){const O=c>C;(c<A||O)&&(O&&n.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),n.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}a&&(this.fragmentTracker.removeFragmentsInRange(c,Infinity,this.playlistType,!0),this.lastCurrentTime=c),!this.loadedmetadata&&!p.len&&(this.nextLoadPosition=this.startPosition=c),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(t,n){this.startTimeOffset=n.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.stopLoad(),super.onHandlerDestroying()}onHandlerDestroyed(){this.state=st.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(t,n,a){this._loadFragForPlayback(t,n,a)}_loadFragForPlayback(t,n,a){const l=u=>{if(this.fragContextChanged(t)){this.warn(`Fragment ${t.sn}${u.part?" p: "+u.part.index:""} of level ${t.level} was dropped during download.`),this.fragmentTracker.removeFragment(t);return}t.stats.chunkCount++,this._handleFragmentLoadProgress(u)};this._doFragLoad(t,n,a,l).then(u=>{if(!u)return;const c=this.state;if(this.fragContextChanged(t)){(c===st.FRAG_LOADING||!this.fragCurrent&&c===st.PARSING)&&(this.fragmentTracker.removeFragment(t),this.state=st.IDLE);return}"payload"in u&&(this.log(`Loaded fragment ${t.sn} of level ${t.level}`),this.hls.trigger(y.FRAG_LOADED,u)),this._handleFragmentLoadComplete(u)}).catch(u=>{this.state===st.STOPPED||this.state===st.ERROR||(this.warn(u),this.resetFragmentLoading(t))})}clearTrackerIfNeeded(t){var n;const{fragmentTracker:a}=this;if(a.getState(t)===ei.APPENDING){const u=t.type,c=this.getFwdBufferInfo(this.mediaBuffer,u),p=Math.max(t.duration,c?c.len:this.config.maxBufferLength);this.reduceMaxBufferLength(p)&&a.removeFragment(t)}else((n=this.mediaBuffer)==null?void 0:n.buffered.length)===0?a.removeAllFragments():a.hasParts(t.type)&&(a.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type}),a.getState(t)===ei.PARTIAL&&a.removeFragment(t))}checkLiveUpdate(t){if(t.updated&&!t.live){const n=t.fragments[t.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:n,part:null,stats:n.stats,id:n.type})}t.fragments[0]||(t.deltaUpdateFailed=!0)}flushMainBuffer(t,n,a=null){if(!(t-n))return;const l={startOffset:t,endOffset:n,type:a};this.hls.trigger(y.BUFFER_FLUSHING,l)}_loadInitSegment(t,n){this._doFragLoad(t,n).then(a=>{if(!a||this.fragContextChanged(t)||!this.levels)throw new Error("init load aborted");return a}).then(a=>{const{hls:l}=this,{payload:u}=a,c=t.decryptdata;if(u&&u.byteLength>0&&c&&c.key&&c.iv&&c.method==="AES-128"){const p=self.performance.now();return this.decrypter.decrypt(new Uint8Array(u),c.key.buffer,c.iv.buffer).catch(v=>{throw l.trigger(y.ERROR,{type:$.MEDIA_ERROR,details:D.FRAG_DECRYPT_ERROR,fatal:!1,error:v,reason:v.message,frag:t}),v}).then(v=>{const A=self.performance.now();return l.trigger(y.FRAG_DECRYPTED,{frag:t,payload:v,stats:{tstart:p,tdecrypt:A}}),a.payload=v,a})}return a}).then(a=>{const{fragCurrent:l,hls:u,levels:c}=this;if(!c)throw new Error("init load aborted, missing levels");const p=t.stats;this.state=st.IDLE,n.fragmentError=0,t.data=new Uint8Array(a.payload),p.parsing.start=p.buffering.start=self.performance.now(),p.parsing.end=p.buffering.end=self.performance.now(),a.frag===l&&u.trigger(y.FRAG_BUFFERED,{stats:p,frag:l,part:null,id:t.type}),this.tick()}).catch(a=>{this.state===st.STOPPED||this.state===st.ERROR||(this.warn(a),this.resetFragmentLoading(t))})}fragContextChanged(t){const{fragCurrent:n}=this;return!t||!n||t.level!==n.level||t.sn!==n.sn||t.urlId!==n.urlId}fragBufferedComplete(t,n){var a,l,u,c;const p=this.mediaBuffer?this.mediaBuffer:this.media;this.log(`Buffered ${t.type} sn: ${t.sn}${n?" part: "+n.index:""} of ${this.playlistType===Gt.MAIN?"level":"track"} ${t.level} (frag:[${((a=t.startPTS)!=null?a:NaN).toFixed(3)}-${((l=t.endPTS)!=null?l:NaN).toFixed(3)}] > buffer:${p?Tl.toString(ni.getBuffered(p)):"(detached)"})`),this.state=st.IDLE,!!p&&(!this.loadedmetadata&&t.type==Gt.MAIN&&p.buffered.length&&((u=this.fragCurrent)==null?void 0:u.sn)===((c=this.fragPrevious)==null?void 0:c.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(t){const{transmuxer:n}=this;if(!n)return;const{frag:a,part:l,partsLoaded:u}=t,c=!u||u.length===0||u.some(v=>!v),p=new $n(a.level,a.sn,a.stats.chunkCount+1,0,l?l.index:-1,!c);n.flush(p)}_handleFragmentLoadProgress(t){}_doFragLoad(t,n,a=null,l){var u;const c=n==null?void 0:n.details;if(!this.levels||!c)throw new Error(`frag load aborted, missing level${c?"":" detail"}s`);let p=null;if(t.encrypted&&!((u=t.decryptdata)!=null&&u.key)?(this.log(`Loading key for ${t.sn} of [${c.startSN}-${c.endSN}], ${this.logPrefix==="[stream-controller]"?"level":"track"} ${t.level}`),this.state=st.KEY_LOADING,this.fragCurrent=t,p=this.keyLoader.load(t).then(C=>{if(!this.fragContextChanged(C.frag))return this.hls.trigger(y.KEY_LOADED,C),this.state===st.KEY_LOADING&&(this.state=st.IDLE),C}),this.hls.trigger(y.KEY_LOADING,{frag:t}),this.fragCurrent===null&&(p=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!t.encrypted&&c.encryptedFragments.length&&this.keyLoader.loadClear(t,c.encryptedFragments),a=Math.max(t.start,a||0),this.config.lowLatencyMode&&t.sn!=="initSegment"){const C=c.partList;if(C&&l){a>t.end&&c.fragmentHint&&(t=c.fragmentHint);const O=this.getNextPart(C,t,a);if(O>-1){const U=C[O];this.log(`Loading part sn: ${t.sn} p: ${U.index} cc: ${t.cc} of playlist [${c.startSN}-${c.endSN}] parts [0-${O}-${C.length-1}] ${this.logPrefix==="[stream-controller]"?"level":"track"}: ${t.level}, target: ${parseFloat(a.toFixed(3))}`),this.nextLoadPosition=U.start+U.duration,this.state=st.FRAG_LOADING;let W;return p?W=p.then(J=>!J||this.fragContextChanged(J.frag)?null:this.doFragPartsLoad(t,U,n,l)).catch(J=>this.handleFragLoadError(J)):W=this.doFragPartsLoad(t,U,n,l).catch(J=>this.handleFragLoadError(J)),this.hls.trigger(y.FRAG_LOADING,{frag:t,part:U,targetBufferTime:a}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):W}else if(!t.url||this.loadedEndOfParts(C,a))return Promise.resolve(null)}}this.log(`Loading fragment ${t.sn} cc: ${t.cc} ${c?"of ["+c.startSN+"-"+c.endSN+"] ":""}${this.logPrefix==="[stream-controller]"?"level":"track"}: ${t.level}, target: ${parseFloat(a.toFixed(3))}`),te(t.sn)&&!this.bitrateTest&&(this.nextLoadPosition=t.start+t.duration),this.state=st.FRAG_LOADING;const v=this.config.progressive;let A;return v&&p?A=p.then(C=>!C||this.fragContextChanged(C==null?void 0:C.frag)?null:this.fragmentLoader.load(t,l)).catch(C=>this.handleFragLoadError(C)):A=Promise.all([this.fragmentLoader.load(t,v?l:void 0),p]).then(([C])=>(!v&&C&&l&&l(C),C)).catch(C=>this.handleFragLoadError(C)),this.hls.trigger(y.FRAG_LOADING,{frag:t,targetBufferTime:a}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):A}doFragPartsLoad(t,n,a,l){return new Promise((u,c)=>{var p;const v=[],A=(p=a.details)==null?void 0:p.partList,C=O=>{this.fragmentLoader.loadPart(t,O,l).then(U=>{v[O.index]=U;const W=U.part;this.hls.trigger(y.FRAG_LOADED,U);const J=hl(a,t.sn,O.index+1)||fl(A,t.sn,O.index+1);if(J)C(J);else return u({frag:t,part:W,partsLoaded:v})}).catch(c)};C(n)})}handleFragLoadError(t){if("data"in t){const n=t.data;t.data&&n.details===D.INTERNAL_ABORTED?this.handleFragLoadAborted(n.frag,n.part):this.hls.trigger(y.ERROR,n)}else this.hls.trigger(y.ERROR,{type:$.OTHER_ERROR,details:D.INTERNAL_EXCEPTION,err:t,error:t,fatal:!0});return null}_handleTransmuxerFlush(t){const n=this.getCurrentContext(t);if(!n||this.state!==st.PARSING){!this.fragCurrent&&this.state!==st.STOPPED&&this.state!==st.ERROR&&(this.state=st.IDLE);return}const{frag:a,part:l,level:u}=n,c=self.performance.now();a.stats.parsing.end=c,l&&(l.stats.parsing.end=c),this.updateLevelTiming(a,l,u,t.partial)}getCurrentContext(t){const{levels:n,fragCurrent:a}=this,{level:l,sn:u,part:c}=t;if(!(n!=null&&n[l]))return this.warn(`Levels object was unset while buffering fragment ${u} of level ${l}. The current chunk will not be buffered.`),null;const p=n[l],v=c>-1?hl(p,u,c):null,A=v?v.fragment:Fs(p,u,a);return A?(a&&a!==A&&(A.stats=a.stats),{frag:A,part:v,level:p}):null}bufferFragmentData(t,n,a,l,u){var c;if(!t||this.state!==st.PARSING)return;const{data1:p,data2:v}=t;let A=p;if(p&&v&&(A=hn(p,v)),!((c=A)!=null&&c.length))return;const C={type:t.type,frag:n,part:a,chunkMeta:l,parent:n.type,data:A};if(this.hls.trigger(y.BUFFER_APPENDING,C),t.dropped&&t.independent&&!a){if(u)return;this.flushBufferGap(n)}}flushBufferGap(t){const n=this.media;if(!n)return;if(!ni.isBuffered(n,n.currentTime)){this.flushMainBuffer(0,t.start);return}const a=n.currentTime,l=ni.bufferInfo(n,a,0),u=t.duration,c=Math.min(this.config.maxFragLookUpTolerance*2,u*.25),p=Math.max(Math.min(t.start-c,l.end-c),a+c);t.start-p>c&&this.flushMainBuffer(p,t.start)}getFwdBufferInfo(t,n){const a=this.getLoadPosition();return te(a)?this.getFwdBufferInfoAtPos(t,a,n):null}getFwdBufferInfoAtPos(t,n,a){const{config:{maxBufferHole:l}}=this,u=ni.bufferInfo(t,n,l);if(u.len===0&&u.nextStart!==void 0){const c=this.fragmentTracker.getBufferedFrag(n,a);if(c&&u.nextStart<c.end)return ni.bufferInfo(t,n,Math.max(u.nextStart,l))}return u}getMaxBufferLength(t){const{config:n}=this;let a;return t?a=Math.max(8*n.maxBufferSize/t,n.maxBufferLength):a=n.maxBufferLength,Math.min(a,n.maxMaxBufferLength)}reduceMaxBufferLength(t){const n=this.config,a=t||n.maxBufferLength;return n.maxMaxBufferLength>=a?(n.maxMaxBufferLength/=2,this.warn(`Reduce max buffer length to ${n.maxMaxBufferLength}s`),!0):!1}getAppendedFrag(t,n=Gt.MAIN){const a=this.fragmentTracker.getAppendedFrag(t,Gt.MAIN);return a&&"fragment"in a?a.fragment:a}getNextFragment(t,n){const a=n.fragments,l=a.length;if(!l)return null;const{config:u}=this,c=a[0].start;let p;if(n.live){const v=u.initialLiveManifestSize;if(l<v)return this.warn(`Not enough fragments to start playback (have: ${l}, need: ${v})`),null;!n.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&(p=this.getInitialLiveFragment(n,a),this.startPosition=p?this.hls.liveSyncPosition||p.start:t)}else t<=c&&(p=a[0]);if(!p){const v=u.lowLatencyMode?n.partEnd:n.fragmentEnd;p=this.getFragmentAtPosition(t,v,n)}return this.mapToInitFragWhenRequired(p)}isLoopLoading(t,n){const a=this.fragmentTracker.getState(t);return(a===ei.OK||a===ei.PARTIAL&&!!t.gap)&&this.nextLoadPosition>n}getNextFragmentLoopLoading(t,n,a,l,u){const c=t.gap,p=this.getNextFragment(this.nextLoadPosition,n);if(p===null)return p;if(t=p,c&&t&&!t.gap&&a.nextStart){const v=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,a.nextStart,l);if(v!==null&&a.len+v.len>=u)return this.log(`buffer full after gaps in "${l}" playlist starting at sn: ${t.sn}`),null}return t}mapToInitFragWhenRequired(t){return t!=null&&t.initSegment&&!(t!=null&&t.initSegment.data)&&!this.bitrateTest?t.initSegment:t}getNextPart(t,n,a){let l=-1,u=!1,c=!0;for(let p=0,v=t.length;p<v;p++){const A=t[p];if(c=c&&!A.independent,l>-1&&a<A.start)break;const C=A.loaded;C?l=-1:(u||A.independent||c)&&A.fragment===n&&(l=p),u=C}return l}loadedEndOfParts(t,n){const a=t[t.length-1];return a&&n>a.start&&a.loaded}getInitialLiveFragment(t,n){const a=this.fragPrevious;let l=null;if(a){if(t.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${a.programDateTime}`),l=Na(n,a.endProgramDateTime,this.config.maxFragLookUpTolerance)),!l){const u=a.sn+1;if(u>=t.startSN&&u<=t.endSN){const c=n[u-t.startSN];a.cc===c.cc&&(l=c,this.log(`Live playlist, switching playlist, load frag with next SN: ${l.sn}`))}l||(l=yl(n,a.cc),l&&this.log(`Live playlist, switching playlist, load frag with same CC: ${l.sn}`))}}else{const u=this.hls.liveSyncPosition;u!==null&&(l=this.getFragmentAtPosition(u,this.bitrateTest?t.fragmentEnd:t.edge,t))}return l}getFragmentAtPosition(t,n,a){const{config:l}=this;let{fragPrevious:u}=this,{fragments:c,endSN:p}=a;const{fragmentHint:v}=a,A=l.maxFragLookUpTolerance,C=a.partList,O=!!(l.lowLatencyMode&&C!=null&&C.length&&v);O&&v&&!this.bitrateTest&&(c=c.concat(v),p=v.sn);let U;if(t<n){const W=t>n-A?0:A;U=tn(u,c,t,W)}else U=c[c.length-1];if(U){const W=U.sn-a.startSN,J=this.fragmentTracker.getState(U);if((J===ei.OK||J===ei.PARTIAL&&U.gap)&&(u=U),u&&U.sn===u.sn&&(!O||C[0].fragment.sn>U.sn)&&u&&U.level===u.level){const he=c[W+1];U.sn<p&&this.fragmentTracker.getState(he)!==ei.OK?U=he:U=null}}return U}synchronizeToLiveEdge(t){const{config:n,media:a}=this;if(!a)return;const l=this.hls.liveSyncPosition,u=a.currentTime,c=t.fragments[0].start,p=t.edge,v=u>=c-n.maxFragLookUpTolerance&&u<=p;if(l!==null&&a.duration>l&&(u<l||!v)){const A=n.liveMaxLatencyDuration!==void 0?n.liveMaxLatencyDuration:n.liveMaxLatencyDurationCount*t.targetduration;(!v&&a.readyState<4||u<p-A)&&(this.loadedmetadata||(this.nextLoadPosition=l),a.readyState&&(this.warn(`Playback: ${u.toFixed(3)} is located too far from the end of live sliding playlist: ${p}, reset currentTime to : ${l.toFixed(3)}`),a.currentTime=l))}}alignPlaylists(t,n){const{levels:a,levelLastLoaded:l,fragPrevious:u}=this,c=l!==null?a[l]:null,p=t.fragments.length;if(!p)return this.warn("No fragments in live playlist"),0;const v=t.fragments[0].start,A=!n,C=t.alignedSliding&&te(v);if(A||!C&&!v){Ar(u,c,t);const O=t.fragments[0].start;return this.log(`Live playlist sliding: ${O.toFixed(2)} start-sn: ${n?n.startSN:"na"}->${t.startSN} prev-sn: ${u?u.sn:"na"} fragments: ${p}`),O}return v}waitForCdnTuneIn(t){const n=3;return t.live&&t.canBlockReload&&t.partTarget&&t.tuneInGoal>Math.max(t.partHoldBack,t.partTarget*n)}setStartPosition(t,n){let a=this.startPosition;if(a<n&&(a=-1),a===-1||this.lastCurrentTime===-1){const l=this.startTimeOffset!==null,u=l?this.startTimeOffset:t.startTimeOffset;u!==null&&te(u)?(a=n+u,u<0&&(a+=t.totalduration),a=Math.min(Math.max(n,a),n+t.totalduration),this.log(`Start time offset ${u} found in ${l?"multivariant":"media"} playlist, adjust startPosition to ${a}`),this.startPosition=a):t.live?a=this.hls.liveSyncPosition||n:this.startPosition=a=0,this.lastCurrentTime=a}this.nextLoadPosition=a}getLoadPosition(){const{media:t}=this;let n=0;return this.loadedmetadata&&t?n=t.currentTime:this.nextLoadPosition&&(n=this.nextLoadPosition),n}handleFragLoadAborted(t,n){this.transmuxer&&t.sn!=="initSegment"&&t.stats.aborted&&(this.warn(`Fragment ${t.sn}${n?" part "+n.index:""} of level ${t.level} was aborted`),this.resetFragmentLoading(t))}resetFragmentLoading(t){(!this.fragCurrent||!this.fragContextChanged(t)&&this.state!==st.FRAG_LOADING_WAITING_RETRY)&&(this.state=st.IDLE)}onFragmentOrKeyLoadError(t,n){if(n.chunkMeta&&!n.frag){const O=this.getCurrentContext(n.chunkMeta);O&&(n.frag=O.frag)}const a=n.frag;if(!a||a.type!==t||!this.levels)return;if(this.fragContextChanged(a)){var l;this.warn(`Frag load error must match current frag to retry ${a.url} > ${(l=this.fragCurrent)==null?void 0:l.url}`);return}const u=n.details===D.FRAG_GAP;u&&this.fragmentTracker.fragBuffered(a,!0);const c=n.errorAction,{action:p,retryCount:v=0,retryConfig:A}=c||{};if(c&&p===yn.RetryRequest&&A){var C;this.resetStartWhenNotLoaded((C=this.levelLastLoaded)!=null?C:a.level);const O=vo(A,v);this.warn(`Fragment ${a.sn} of ${t} ${a.level} errored with ${n.details}, retrying loading ${v+1}/${A.maxNumRetry} in ${O}ms`),c.resolved=!0,this.retryDate=self.performance.now()+O,this.state=st.FRAG_LOADING_WAITING_RETRY}else A&&c?(this.resetFragmentErrors(t),v<A.maxNumRetry?u||(c.resolved=!0):T.warn(`${n.details} reached or exceeded max retry (${v})`)):(c==null?void 0:c.action)===yn.SendAlternateToPenaltyBox?this.state=st.WAITING_LEVEL:this.state=st.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(t){if(this.state===st.PARSING||this.state===st.PARSED){const n=t.parent,a=this.getFwdBufferInfo(this.mediaBuffer,n),l=a&&a.len>.5;l&&this.reduceMaxBufferLength(a.len);const u=!l;return u&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${n} buffer`),t.frag&&(this.fragmentTracker.removeFragment(t.frag),this.nextLoadPosition=t.frag.start),this.resetLoadingState(),u}return!1}resetFragmentErrors(t){t===Gt.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==st.STOPPED&&(this.state=st.IDLE)}afterBufferFlushed(t,n,a){if(!t)return;const l=ni.getBuffered(t);this.fragmentTracker.detectEvictedFragments(n,l,a),this.state===st.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=st.IDLE}resetStartWhenNotLoaded(t){if(!this.loadedmetadata){this.startFragRequested=!1;const n=this.levels?this.levels[t].details:null;n!=null&&n.live?(this.startPosition=-1,this.setStartPosition(n,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(t){var n;this.warn(`The loading context changed while buffering fragment ${t.sn} of level ${t.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded((n=this.levelLastLoaded)!=null?n:t.level),this.resetLoadingState()}removeUnbufferedFrags(t=0){this.fragmentTracker.removeFragmentsInRange(t,Infinity,this.playlistType,!1,!0)}updateLevelTiming(t,n,a,l){var u;const c=a.details;if(!c){this.warn("level.details undefined");return}if(Object.keys(t.elementaryStreams).reduce((v,A)=>{const C=t.elementaryStreams[A];if(C){const O=C.endPTS-C.startPTS;if(O<=0)return this.warn(`Could not parse fragment ${t.sn} ${A} duration reliably (${O})`),v||!1;const U=l?0:go(c,t,C.startPTS,C.endPTS,C.startDTS,C.endDTS);return this.hls.trigger(y.LEVEL_PTS_UPDATED,{details:c,level:a,drift:U,type:A,frag:t,start:C.startPTS,end:C.endPTS}),!0}return v},!1))a.fragmentError=0;else if(((u=this.transmuxer)==null?void 0:u.error)===null){const v=new Error(`Found no media in fragment ${t.sn} of level ${t.level} resetting transmuxer to fallback to playlist timing`);if(a.fragmentError===0&&(a.fragmentError++,t.gap=!0,this.fragmentTracker.removeFragment(t),this.fragmentTracker.fragBuffered(t,!0)),this.warn(v.message),this.hls.trigger(y.ERROR,{type:$.MEDIA_ERROR,details:D.FRAG_PARSING_ERROR,fatal:!1,error:v,frag:t,reason:`Found no media in msn ${t.sn} of level "${a.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=st.PARSED,this.hls.trigger(y.FRAG_PARSED,{frag:t,part:n})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(t){if(t.event==="demuxerWorker"){var n,a,l;this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded((n=(a=this.levelLastLoaded)!=null?a:(l=this.fragCurrent)==null?void 0:l.level)!=null?n:0),this.resetLoadingState()}}set state(t){const n=this._state;n!==t&&(this._state=t,this.log(`${n}->${t}`))}get state(){return this._state}}function es(){return self.SourceBuffer||self.WebKitSourceBuffer}function Sl(){const f=an();if(!f)return!1;const t=es(),n=f&&typeof f.isTypeSupported=="function"&&f.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),a=!t||t.prototype&&typeof t.prototype.appendBuffer=="function"&&typeof t.prototype.remove=="function";return!!n&&!!a}function So(){var f;const t=es();return typeof(t==null||(f=t.prototype)==null?void 0:f.changeType)=="function"}function gs(){return typeof __HLS_WORKER_BUNDLE__=="function"}function ys(){const f=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(f);return{worker:new self.Worker(t),objectURL:t}}function nr(f){const t=new self.URL(f,self.location.href).href;return{worker:new self.Worker(t),scriptURL:t}}function vn(f="",t=9e4){return{type:f,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}class ci{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(t,n,a,l){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(t){this.initPTS=t,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(t,n){return!1}appendFrame(t,n,a){}demux(t,n){this.cachedData&&(t=hn(this.cachedData,t),this.cachedData=null);let a=Ji(t,0),l=a?a.length:0,u;const c=this._audioTrack,p=this._id3Track,v=a?sn(a):void 0,A=t.length;for((this.basePTS===null||this.frameIndex===0&&te(v))&&(this.basePTS=Co(v,n,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),a&&a.length>0&&p.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:a,type:Un.audioId3,duration:Number.POSITIVE_INFINITY});l<A;){if(this.canParse(t,l)){const C=this.appendFrame(c,t,l);C?(this.frameIndex++,this.lastPTS=C.sample.pts,l+=C.length,u=l):l=A}else cn(t,l)?(a=Ji(t,l),p.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:a,type:Un.audioId3,duration:Number.POSITIVE_INFINITY}),l+=a.length,u=l):l++;if(l===A&&u!==A){const C=Qt(t,u);this.cachedData?this.cachedData=hn(this.cachedData,C):this.cachedData=C}}return{audioTrack:c,videoTrack:vn(),id3Track:p,textTrack:vn()}}demuxSampleAes(t,n,a){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(t){const n=this.cachedData;return n&&(this.cachedData=null,this.demux(n,0)),{audioTrack:this._audioTrack,videoTrack:vn(),id3Track:this._id3Track,textTrack:vn()}}destroy(){}}const Co=(f,t,n)=>{if(te(f))return f*90;const a=n?n.baseTime*9e4/n.timescale:0;return t*9e4+a};function da(f,t,n,a){let l,u,c,p;const v=navigator.userAgent.toLowerCase(),A=a,C=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];l=((t[n+2]&192)>>>6)+1;const O=(t[n+2]&60)>>>2;if(O>C.length-1){f.trigger(y.ERROR,{type:$.MEDIA_ERROR,details:D.FRAG_PARSING_ERROR,fatal:!0,reason:`invalid ADTS sampling index:${O}`});return}return c=(t[n+2]&1)<<2,c|=(t[n+3]&192)>>>6,T.log(`manifest codec:${a}, ADTS type:${l}, samplingIndex:${O}`),/firefox/i.test(v)?O>=6?(l=5,p=new Array(4),u=O-3):(l=2,p=new Array(2),u=O):v.indexOf("android")!==-1?(l=2,p=new Array(2),u=O):(l=5,p=new Array(4),a&&(a.indexOf("mp4a.40.29")!==-1||a.indexOf("mp4a.40.5")!==-1)||!a&&O>=6?u=O-3:((a&&a.indexOf("mp4a.40.2")!==-1&&(O>=6&&c===1||/vivaldi/i.test(v))||!a&&c===1)&&(l=2,p=new Array(2)),u=O)),p[0]=l<<3,p[0]|=(O&14)>>1,p[1]|=(O&1)<<7,p[1]|=c<<3,l===5&&(p[1]|=(u&14)>>1,p[2]=(u&1)<<7,p[2]|=2<<2,p[3]=0),{config:p,samplerate:C[O],channelCount:c,codec:"mp4a.40."+l,manifestCodec:A}}function wo(f,t){return f[t]===255&&(f[t+1]&246)==240}function Or(f,t){return f[t+1]&1?7:9}function ca(f,t){return(f[t+3]&3)<<11|f[t+4]<<3|(f[t+5]&224)>>>5}function on(f,t){return t+5<f.length}function vs(f,t){return t+1<f.length&&wo(f,t)}function ha(f,t){return on(f,t)&&wo(f,t)&&ca(f,t)<=f.length-t}function As(f,t){if(vs(f,t)){const n=Or(f,t);if(t+n>=f.length)return!1;const a=ca(f,t);if(a<=n)return!1;const l=t+a;return l===f.length||vs(f,l)}return!1}function ts(f,t,n,a,l){if(!f.samplerate){const u=da(t,n,a,l);if(!u)return;f.config=u.config,f.samplerate=u.samplerate,f.channelCount=u.channelCount,f.codec=u.codec,f.manifestCodec=u.manifestCodec,T.log(`parsed codec:${f.codec}, rate:${u.samplerate}, channels:${u.channelCount}`)}}function An(f){return 1024*9e4/f}function Ha(f,t){const n=Or(f,t);if(t+n<=f.length){const a=ca(f,t)-n;if(a>0)return{headerLength:n,frameLength:a}}}function Hs(f,t,n,a,l){const u=An(f.samplerate),c=a+l*u,p=Ha(t,n);let v;if(p){const{frameLength:O,headerLength:U}=p,W=U+O,J=Math.max(0,n+W-t.length);J?(v=new Uint8Array(W-U),v.set(t.subarray(n+U,t.length),0)):v=t.subarray(n+U,n+W);const oe={unit:v,pts:c};return J||f.samples.push(oe),{sample:oe,length:W,missing:J}}const A=t.length-n;return v=new Uint8Array(A),v.set(t.subarray(n,t.length),0),{sample:{unit:v,pts:c},length:A,missing:-1}}class Lo extends ci{constructor(t,n){super();this.observer=void 0,this.config=void 0,this.observer=t,this.config=n}resetInitSegment(t,n,a,l){super.resetInitSegment(t,n,a,l),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:n,duration:l,inputTimeScale:9e4,dropped:0}}static probe(t){if(!t)return!1;let a=(Ji(t,0)||[]).length;for(let l=t.length;a<l;a++)if(As(t,a))return T.log("ADTS sync word found !"),!0;return!1}canParse(t,n){return ha(t,n)}appendFrame(t,n,a){ts(t,this.observer,n,a,t.manifestCodec);const l=Hs(t,n,a,this.basePTS,this.frameIndex);if(l&&l.missing===0)return l}}const Pr=/\/emsg[-/]ID3/i;class fa{constructor(t,n){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=n}resetTimeStamp(){}resetInitSegment(t,n,a,l){const u=this.videoTrack=vn("video",1),c=this.audioTrack=vn("audio",1),p=this.txtTrack=vn("text",1);if(this.id3Track=vn("id3",1),this.timeOffset=0,!(t!=null&&t.byteLength))return;const v=pr(t);if(v.video){const{id:A,timescale:C,codec:O}=v.video;u.id=A,u.timescale=p.timescale=C,u.codec=O}if(v.audio){const{id:A,timescale:C,codec:O}=v.audio;c.id=A,c.timescale=C,c.codec=O}p.id=Tt.text,u.sampleDuration=0,u.duration=c.duration=l}resetContiguity(){this.remainderData=null}static probe(t){return t=t.length>16384?t.subarray(0,16384):t,ai(t,["moof"]).length>0}demux(t,n){this.timeOffset=n;let a=t;const l=this.videoTrack,u=this.txtTrack;if(this.config.progressive){this.remainderData&&(a=hn(this.remainderData,t));const p=ea(a);this.remainderData=p.remainder,l.samples=p.valid||new Uint8Array}else l.samples=a;const c=this.extractID3Track(l,n);return u.samples=tr(n,l),{videoTrack:l,audioTrack:this.audioTrack,id3Track:c,textTrack:this.txtTrack}}flush(){const t=this.timeOffset,n=this.videoTrack,a=this.txtTrack;n.samples=this.remainderData||new Uint8Array,this.remainderData=null;const l=this.extractID3Track(n,this.timeOffset);return a.samples=tr(t,n),{videoTrack:n,audioTrack:vn(),id3Track:l,textTrack:vn()}}extractID3Track(t,n){const a=this.id3Track;if(t.samples.length){const l=ai(t.samples,["emsg"]);l&&l.forEach(u=>{const c=Ge(u);if(Pr.test(c.schemeIdUri)){const p=te(c.presentationTime)?c.presentationTime/c.timeScale:n+c.presentationTimeDelta/c.timeScale;let v=c.eventDuration===4294967295?Number.POSITIVE_INFINITY:c.eventDuration/c.timeScale;v<=.001&&(v=Number.POSITIVE_INFINITY);const A=c.payload;a.samples.push({data:A,len:A.byteLength,dts:p,pts:p,type:Un.emsg,duration:v})}})}return a}demuxSampleAes(t,n,a){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}}let is=null;const pa=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],br=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],bs=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],bn=[0,1,1,4];function Gs(f,t,n,a,l){if(n+24>t.length)return;const u=_s(t,n);if(u&&n+u.frameLength<=t.length){const c=u.samplesPerFrame*9e4/u.sampleRate,p=a+l*c,v={unit:t.subarray(n,n+u.frameLength),pts:p,dts:p};return f.config=[],f.channelCount=u.channelCount,f.samplerate=u.sampleRate,f.samples.push(v),{sample:v,length:u.frameLength,missing:0}}}function _s(f,t){const n=f[t+1]>>3&3,a=f[t+1]>>1&3,l=f[t+2]>>4&15,u=f[t+2]>>2&3;if(n!==1&&l!==0&&l!==15&&u!==3){const c=f[t+2]>>1&1,p=f[t+3]>>6,v=n===3?3-a:a===3?3:4,A=pa[v*14+l-1]*1e3,O=br[(n===3?0:n===2?1:2)*3+u],U=p===3?1:2,W=bs[n][a],J=bn[a],oe=W*8*J,he=Math.floor(W*A/O+c)*J;if(is===null){const Me=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);is=Me?parseInt(Me[1]):0}return!!is&&is<=87&&a===2&&A>=224e3&&p===0&&(f[t+3]=f[t+3]|128),{sampleRate:O,channelCount:U,frameLength:he,samplesPerFrame:oe}}}function ma(f,t){return f[t]===255&&(f[t+1]&224)==224&&(f[t+1]&6)!=0}function ko(f,t){return t+1<f.length&&ma(f,t)}function xs(f,t){const n=4;return ma(f,t)&&n<=f.length-t}function rr(f,t){if(t+1<f.length&&ma(f,t)){const n=4,a=_s(f,t);let l=n;a!=null&&a.frameLength&&(l=a.frameLength);const u=t+l;return u===f.length||ko(f,u)}return!1}class Ga{constructor(t){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const t=this.data,n=this.bytesAvailable,a=t.byteLength-n,l=new Uint8Array(4),u=Math.min(4,n);if(u===0)throw new Error("no bytes available");l.set(t.subarray(a,a+u)),this.word=new DataView(l.buffer).getUint32(0),this.bitsAvailable=u*8,this.bytesAvailable-=u}skipBits(t){let n;t=Math.min(t,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>t?(this.word<<=t,this.bitsAvailable-=t):(t-=this.bitsAvailable,n=t>>3,t-=n<<3,this.bytesAvailable-=n,this.loadWord(),this.word<<=t,this.bitsAvailable-=t)}readBits(t){let n=Math.min(this.bitsAvailable,t);const a=this.word>>>32-n;if(t>32&&T.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=n,this.bitsAvailable>0)this.word<<=n;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return n=t-n,n>0&&this.bitsAvailable?a<<n|this.readBits(n):a}skipLZ(){let t;for(t=0;t<this.bitsAvailable;++t)if((this.word&2147483648>>>t)!=0)return this.word<<=t,this.bitsAvailable-=t,t;return this.loadWord(),t+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const t=this.skipLZ();return this.readBits(t+1)-1}readEG(){const t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(t){let n=8,a=8,l;for(let u=0;u<t;u++)a!==0&&(l=this.readEG(),a=(n+l+256)%256),n=a===0?n:a}readSPS(){let t=0,n=0,a=0,l=0,u,c,p;const v=this.readUByte.bind(this),A=this.readBits.bind(this),C=this.readUEG.bind(this),O=this.readBoolean.bind(this),U=this.skipBits.bind(this),W=this.skipEG.bind(this),J=this.skipUEG.bind(this),oe=this.skipScalingList.bind(this);v();const he=v();if(A(5),U(3),v(),J(),he===100||he===110||he===122||he===244||he===44||he===83||he===86||he===118||he===128){const St=C();if(St===3&&U(1),J(),J(),U(1),O())for(c=St!==3?8:12,p=0;p<c;p++)O()&&(p<6?oe(16):oe(64))}J();const we=C();if(we===0)C();else if(we===1)for(U(1),W(),W(),u=C(),p=0;p<u;p++)W();J(),U(1);const Fe=C(),Me=C(),it=A(1);it===0&&U(1),U(1),O()&&(t=C(),n=C(),a=C(),l=C());let We=[1,1];if(O()&&O())switch(v()){case 1:We=[1,1];break;case 2:We=[12,11];break;case 3:We=[10,11];break;case 4:We=[16,11];break;case 5:We=[40,33];break;case 6:We=[24,11];break;case 7:We=[20,11];break;case 8:We=[32,11];break;case 9:We=[80,33];break;case 10:We=[18,11];break;case 11:We=[15,11];break;case 12:We=[64,33];break;case 13:We=[160,99];break;case 14:We=[4,3];break;case 15:We=[3,2];break;case 16:We=[2,1];break;case 255:{We=[v()<<8|v(),v()<<8|v()];break}}return{width:Math.ceil((Fe+1)*16-t*2-n*2),height:(2-it)*(Me+1)*16-(it?2:4)*(a+l),pixelRatio:We}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class Do{constructor(t,n,a){this.keyData=void 0,this.decrypter=void 0,this.keyData=a,this.decrypter=new Yi(n,{removePKCS7Padding:!1})}decryptBuffer(t){return this.decrypter.decrypt(t,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(t,n,a){const l=t[n].unit;if(l.length<=16)return;const u=l.subarray(16,l.length-l.length%16),c=u.buffer.slice(u.byteOffset,u.byteOffset+u.length);this.decryptBuffer(c).then(p=>{const v=new Uint8Array(p);l.set(v,16),this.decrypter.isSync()||this.decryptAacSamples(t,n+1,a)})}decryptAacSamples(t,n,a){for(;;n++){if(n>=t.length){a();return}if(!(t[n].unit.length<32)&&(this.decryptAacSample(t,n,a),!this.decrypter.isSync()))return}}getAvcEncryptedData(t){const n=Math.floor((t.length-48)/160)*16+16,a=new Int8Array(n);let l=0;for(let u=32;u<t.length-16;u+=160,l+=16)a.set(t.subarray(u,u+16),l);return a}getAvcDecryptedUnit(t,n){const a=new Uint8Array(n);let l=0;for(let u=32;u<t.length-16;u+=160,l+=16)t.set(a.subarray(l,l+16),u);return t}decryptAvcSample(t,n,a,l,u){const c=Te(u.data),p=this.getAvcEncryptedData(c);this.decryptBuffer(p.buffer).then(v=>{u.data=this.getAvcDecryptedUnit(c,v),this.decrypter.isSync()||this.decryptAvcSamples(t,n,a+1,l)})}decryptAvcSamples(t,n,a,l){if(t instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;n++,a=0){if(n>=t.length){l();return}const u=t[n].units;for(;!(a>=u.length);a++){const c=u[a];if(!(c.data.length<=48||c.type!==1&&c.type!==5)&&(this.decryptAvcSample(t,n,a,l,c),!this.decrypter.isSync()))return}}}}const $t=188;class _n{constructor(t,n,a){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=t,this.config=n,this.typeSupported=a}static probe(t){const n=_n.syncOffset(t);return n>0&&T.warn(`MPEG2-TS detected but first sync word found @ offset ${n}`),n!==-1}static syncOffset(t){const n=t.length;let a=Math.min($t*5,t.length-$t)+1,l=0;for(;l<a;){let u=!1,c=-1,p=0;for(let v=l;v<n;v+=$t)if(t[v]===71){if(p++,c===-1&&(c=v,c!==0&&(a=Math.min(c+$t*99,t.length-$t)+1)),u||(u=Yn(t,v)===0),u&&p>1&&(c===0&&p>2||v+$t>a))return c}else{if(p)return-1;break}l++}return-1}static createTrack(t,n){return{container:t==="video"||t==="audio"?"video/mp2t":void 0,type:t,id:Tt[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:t==="audio"?n:void 0}}resetInitSegment(t,n,a,l){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=_n.createTrack("video"),this._audioTrack=_n.createTrack("audio",l),this._id3Track=_n.createTrack("id3"),this._txtTrack=_n.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=n,this.videoCodec=a,this._duration=l}resetTimeStamp(){}resetContiguity(){const{_audioTrack:t,_avcTrack:n,_id3Track:a}=this;t&&(t.pesData=null),n&&(n.pesData=null),a&&(a.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null}demux(t,n,a=!1,l=!1){a||(this.sampleAes=null);let u;const c=this._avcTrack,p=this._audioTrack,v=this._id3Track,A=this._txtTrack;let C=c.pid,O=c.pesData,U=p.pid,W=v.pid,J=p.pesData,oe=v.pesData,he=null,we=this.pmtParsed,Fe=this._pmtId,Me=t.length;if(this.remainderData&&(t=hn(this.remainderData,t),Me=t.length,this.remainderData=null),Me<$t&&!l)return this.remainderData=t,{audioTrack:p,videoTrack:c,id3Track:v,textTrack:A};const it=Math.max(0,_n.syncOffset(t));Me-=(Me-it)%$t,Me<t.byteLength&&!l&&(this.remainderData=new Uint8Array(t.buffer,Me,t.buffer.byteLength-Me));let We=0;for(let ut=it;ut<Me;ut+=$t)if(t[ut]===71){const gt=!!(t[ut+1]&64),Ct=Yn(t,ut),rt=(t[ut+3]&48)>>4;let qt;if(rt>1){if(qt=ut+5+t[ut+4],qt===ut+$t)continue}else qt=ut+4;switch(Ct){case C:gt&&(O&&(u=Mr(O))&&this.parseAVCPES(c,A,u,!1),O={data:[],size:0}),O&&(O.data.push(t.subarray(qt,ut+$t)),O.size+=ut+$t-qt);break;case U:if(gt){if(J&&(u=Mr(J)))switch(p.segmentCodec){case"aac":this.parseAACPES(p,u);break;case"mp3":this.parseMPEGPES(p,u);break}J={data:[],size:0}}J&&(J.data.push(t.subarray(qt,ut+$t)),J.size+=ut+$t-qt);break;case W:gt&&(oe&&(u=Mr(oe))&&this.parseID3PES(v,u),oe={data:[],size:0}),oe&&(oe.data.push(t.subarray(qt,ut+$t)),oe.size+=ut+$t-qt);break;case 0:gt&&(qt+=t[qt]+1),Fe=this._pmtId=Br(t,qt);break;case Fe:{gt&&(qt+=t[qt]+1);const Ot=ga(t,qt,this.typeSupported,a);C=Ot.avc,C>0&&(c.pid=C),U=Ot.audio,U>0&&(p.pid=U,p.segmentCodec=Ot.segmentCodec),W=Ot.id3,W>0&&(v.pid=W),he!==null&&!we&&(T.warn(`MPEG-TS PMT found at ${ut} after unknown PID '${he}'. Backtracking to sync byte @${it} to parse all TS packets.`),he=null,ut=it-188),we=this.pmtParsed=!0;break}case 17:case 8191:break;default:he=Ct;break}}else We++;if(We>0){const ut=new Error(`Found ${We} TS packet/s that do not start with 0x47`);this.observer.emit(y.ERROR,y.ERROR,{type:$.MEDIA_ERROR,details:D.FRAG_PARSING_ERROR,fatal:!1,error:ut,reason:ut.message})}c.pesData=O,p.pesData=J,v.pesData=oe;const St={audioTrack:p,videoTrack:c,id3Track:v,textTrack:A};return l&&this.extractRemainingSamples(St),St}flush(){const{remainderData:t}=this;this.remainderData=null;let n;return t?n=this.demux(t,-1,!1,!0):n={videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(n),this.sampleAes?this.decrypt(n,this.sampleAes):n}extractRemainingSamples(t){const{audioTrack:n,videoTrack:a,id3Track:l,textTrack:u}=t,c=a.pesData,p=n.pesData,v=l.pesData;let A;if(c&&(A=Mr(c))?(this.parseAVCPES(a,u,A,!0),a.pesData=null):a.pesData=c,p&&(A=Mr(p))){switch(n.segmentCodec){case"aac":this.parseAACPES(n,A);break;case"mp3":this.parseMPEGPES(n,A);break}n.pesData=null}else p!=null&&p.size&&T.log("last AAC PES packet truncated,might overlap between fragments"),n.pesData=p;v&&(A=Mr(v))?(this.parseID3PES(l,A),l.pesData=null):l.pesData=v}demuxSampleAes(t,n,a){const l=this.demux(t,a,!0,!this.config.progressive),u=this.sampleAes=new Do(this.observer,this.config,n);return this.decrypt(l,u)}decrypt(t,n){return new Promise(a=>{const{audioTrack:l,videoTrack:u}=t;l.samples&&l.segmentCodec==="aac"?n.decryptAacSamples(l.samples,0,()=>{u.samples?n.decryptAvcSamples(u.samples,0,0,()=>{a(t)}):a(t)}):u.samples&&n.decryptAvcSamples(u.samples,0,0,()=>{a(t)})})}destroy(){this._duration=0}parseAVCPES(t,n,a,l){const u=this.parseAVCNALu(t,a.data);let c=this.avcSample,p,v=!1;a.data=null,c&&u.length&&!t.audFound&&(ns(c,t),c=this.avcSample=Es(!1,a.pts,a.dts,"")),u.forEach(A=>{var C;switch(A.type){case 1:{let U=!1;p=!0;const W=A.data;if(v&&W.length>4){const J=new Ga(W).readSliceType();(J===2||J===4||J===7||J===9)&&(U=!0)}if(U){var O;(O=c)!=null&&O.frame&&!c.key&&(ns(c,t),c=this.avcSample=null)}c||(c=this.avcSample=Es(!0,a.pts,a.dts,"")),c.frame=!0,c.key=U;break}case 5:p=!0,(C=c)!=null&&C.frame&&!c.key&&(ns(c,t),c=this.avcSample=null),c||(c=this.avcSample=Es(!0,a.pts,a.dts,"")),c.key=!0,c.frame=!0;break;case 6:{p=!0,re(A.data,1,a.pts,n.samples);break}case 7:if(p=!0,v=!0,!t.sps){const U=A.data,J=new Ga(U).readSPS();t.width=J.width,t.height=J.height,t.pixelRatio=J.pixelRatio,t.sps=[U],t.duration=this._duration;const oe=U.subarray(1,4);let he="avc1.";for(let we=0;we<3;we++){let Fe=oe[we].toString(16);Fe.length<2&&(Fe="0"+Fe),he+=Fe}t.codec=he}break;case 8:p=!0,t.pps||(t.pps=[A.data]);break;case 9:p=!1,t.audFound=!0,c&&ns(c,t),c=this.avcSample=Es(!1,a.pts,a.dts,"");break;case 12:p=!0;break;default:p=!1,c&&(c.debug+="unknown NAL "+A.type+" ");break}c&&p&&c.units.push(A)}),l&&c&&(ns(c,t),this.avcSample=null)}getLastNalUnit(t){var n;let a=this.avcSample,l;if((!a||a.units.length===0)&&(a=t[t.length-1]),(n=a)!=null&&n.units){const u=a.units;l=u[u.length-1]}return l}parseAVCNALu(t,n){const a=n.byteLength;let l=t.naluState||0;const u=l,c=[];let p=0,v,A,C,O=-1,U=0;for(l===-1&&(O=0,U=n[0]&31,l=0,p=1);p<a;){if(v=n[p++],!l){l=v?0:1;continue}if(l===1){l=v?0:2;continue}if(!v)l=3;else if(v===1){if(O>=0){const W={data:n.subarray(O,p-l-1),type:U};c.push(W)}else{const W=this.getLastNalUnit(t.samples);if(W&&(u&&p<=4-u&&W.state&&(W.data=W.data.subarray(0,W.data.byteLength-u)),A=p-l-1,A>0)){const J=new Uint8Array(W.data.byteLength+A);J.set(W.data,0),J.set(n.subarray(0,A),W.data.byteLength),W.data=J,W.state=0}}p<a?(C=n[p]&31,O=p,U=C,l=0):l=-1}else l=0}if(O>=0&&l>=0){const W={data:n.subarray(O,a),type:U,state:l};c.push(W)}if(c.length===0){const W=this.getLastNalUnit(t.samples);if(W){const J=new Uint8Array(W.data.byteLength+n.byteLength);J.set(W.data,0),J.set(n,W.data.byteLength),W.data=J}}return t.naluState=l,c}parseAACPES(t,n){let a=0;const l=this.aacOverFlow;let u=n.data;if(l){this.aacOverFlow=null;const O=l.missing,U=l.sample.unit.byteLength;if(O===-1){const W=new Uint8Array(U+u.byteLength);W.set(l.sample.unit,0),W.set(u,U),u=W}else{const W=U-O;l.sample.unit.set(u.subarray(0,O),W),t.samples.push(l.sample),a=l.missing}}let c,p;for(c=a,p=u.length;c<p-1&&!vs(u,c);c++);if(c!==a){let O;const U=c<p-1;U?O=`AAC PES did not start with ADTS header,offset:${c}`:O="No ADTS header found in AAC PES";const W=new Error(O);if(T.warn(`parsing error: ${O}`),this.observer.emit(y.ERROR,y.ERROR,{type:$.MEDIA_ERROR,details:D.FRAG_PARSING_ERROR,fatal:!1,levelRetry:U,error:W,reason:O}),!U)return}ts(t,this.observer,u,c,this.audioCodec);let v;if(n.pts!==void 0)v=n.pts;else if(l){const O=An(t.samplerate);v=l.sample.pts+O}else{T.warn("[tsdemuxer]: AAC PES unknown PTS");return}let A=0,C;for(;c<p;)if(C=Hs(t,u,c,v,A),c+=C.length,C.missing){this.aacOverFlow=C;break}else for(A++;c<p-1&&!vs(u,c);c++);}parseMPEGPES(t,n){const a=n.data,l=a.length;let u=0,c=0;const p=n.pts;if(p===void 0){T.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;c<l;)if(ko(a,c)){const v=Gs(t,a,c,p,u);if(v)c+=v.length,u++;else break}else c++}parseID3PES(t,n){if(n.pts===void 0){T.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const a=Ee({},n,{type:this._avcTrack?Un.emsg:Un.audioId3,duration:Number.POSITIVE_INFINITY});t.samples.push(a)}}function Es(f,t,n,a){return{key:f,frame:!1,pts:t,dts:n,units:[],debug:a,length:0}}function Yn(f,t){return((f[t+1]&31)<<8)+f[t+2]}function Br(f,t){return(f[t+10]&31)<<8|f[t+11]}function ga(f,t,n,a){const l={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},u=(f[t+1]&15)<<8|f[t+2],c=t+3+u-4,p=(f[t+10]&15)<<8|f[t+11];for(t+=12+p;t<c;){const v=Yn(f,t);switch(f[t]){case 207:if(!a){T.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:l.audio===-1&&(l.audio=v);break;case 21:l.id3===-1&&(l.id3=v);break;case 219:if(!a){T.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:l.avc===-1&&(l.avc=v);break;case 3:case 4:n.mpeg!==!0&&n.mp3!==!0?T.log("MPEG audio found, not supported in this browser"):l.audio===-1&&(l.audio=v,l.segmentCodec="mp3");break;case 36:T.warn("Unsupported HEVC stream type found");break}t+=((f[t+3]&15)<<8|f[t+4])+5}return l}function Mr(f){let t=0,n,a,l,u,c;const p=f.data;if(!f||f.size===0)return null;for(;p[0].length<19&&p.length>1;){const A=new Uint8Array(p[0].length+p[1].length);A.set(p[0]),A.set(p[1],p[0].length),p[0]=A,p.splice(1,1)}if(n=p[0],(n[0]<<16)+(n[1]<<8)+n[2]===1){if(a=(n[4]<<8)+n[5],a&&a>f.size-6)return null;const A=n[7];A&192&&(u=(n[9]&14)*536870912+(n[10]&255)*4194304+(n[11]&254)*16384+(n[12]&255)*128+(n[13]&254)/2,A&64?(c=(n[14]&14)*536870912+(n[15]&255)*4194304+(n[16]&254)*16384+(n[17]&255)*128+(n[18]&254)/2,u-c>60*9e4&&(T.warn(`${Math.round((u-c)/9e4)}s delta between PTS and DTS, align them`),u=c)):c=u),l=n[8];let C=l+9;if(f.size<=C)return null;f.size-=C;const O=new Uint8Array(f.size);for(let U=0,W=p.length;U<W;U++){n=p[U];let J=n.byteLength;if(C)if(C>J){C-=J;continue}else n=n.subarray(C),J-=C,C=0;O.set(n,t),t+=J}return a&&(a-=l+3),{data:O,pts:u,dts:c,len:a}}return null}function ns(f,t){if(f.units.length&&f.frame){if(f.pts===void 0){const n=t.samples,a=n.length;if(a){const l=n[a-1];f.pts=l.pts,f.dts=l.dts}else{t.dropped++;return}}t.samples.push(f)}f.debug.length&&T.log(f.pts+"/"+f.dts+":"+f.debug)}class _r extends ci{resetInitSegment(t,n,a,l){super.resetInitSegment(t,n,a,l),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:n,duration:l,inputTimeScale:9e4,dropped:0}}static probe(t){if(!t)return!1;let a=(Ji(t,0)||[]).length;for(let l=t.length;a<l;a++)if(rr(t,a))return T.log("MPEG Audio sync word found !"),!0;return!1}canParse(t,n){return xs(t,n)}appendFrame(t,n,a){if(this.basePTS!==null)return Gs(t,n,a,this.basePTS,this.frameIndex)}}class Fr{static getSilentFrame(t,n){switch(t){case"mp4a.40.2":if(n===1)return new Uint8Array([0,200,0,128,35,128]);if(n===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(n===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(n===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(n===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(n===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(n===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(n===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(n===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const Rn=Math.pow(2,32)-1;class Ve{static init(){Ve.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let t;for(t in Ve.types)Ve.types.hasOwnProperty(t)&&(Ve.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);const n=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),a=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);Ve.HDLR_TYPES={video:n,audio:a};const l=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),u=new Uint8Array([0,0,0,0,0,0,0,0]);Ve.STTS=Ve.STSC=Ve.STCO=u,Ve.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Ve.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Ve.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Ve.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const c=new Uint8Array([105,115,111,109]),p=new Uint8Array([97,118,99,49]),v=new Uint8Array([0,0,0,1]);Ve.FTYP=Ve.box(Ve.types.ftyp,c,v,c,p),Ve.DINF=Ve.box(Ve.types.dinf,Ve.box(Ve.types.dref,l))}static box(t,...n){let a=8,l=n.length;const u=l;for(;l--;)a+=n[l].byteLength;const c=new Uint8Array(a);for(c[0]=a>>24&255,c[1]=a>>16&255,c[2]=a>>8&255,c[3]=a&255,c.set(t,4),l=0,a=8;l<u;l++)c.set(n[l],a),a+=n[l].byteLength;return c}static hdlr(t){return Ve.box(Ve.types.hdlr,Ve.HDLR_TYPES[t])}static mdat(t){return Ve.box(Ve.types.mdat,t)}static mdhd(t,n){n*=t;const a=Math.floor(n/(Rn+1)),l=Math.floor(n%(Rn+1));return Ve.box(Ve.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,a>>24,a>>16&255,a>>8&255,a&255,l>>24,l>>16&255,l>>8&255,l&255,85,196,0,0]))}static mdia(t){return Ve.box(Ve.types.mdia,Ve.mdhd(t.timescale,t.duration),Ve.hdlr(t.type),Ve.minf(t))}static mfhd(t){return Ve.box(Ve.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255]))}static minf(t){return t.type==="audio"?Ve.box(Ve.types.minf,Ve.box(Ve.types.smhd,Ve.SMHD),Ve.DINF,Ve.stbl(t)):Ve.box(Ve.types.minf,Ve.box(Ve.types.vmhd,Ve.VMHD),Ve.DINF,Ve.stbl(t))}static moof(t,n,a){return Ve.box(Ve.types.moof,Ve.mfhd(t),Ve.traf(a,n))}static moov(t){let n=t.length;const a=[];for(;n--;)a[n]=Ve.trak(t[n]);return Ve.box.apply(null,[Ve.types.moov,Ve.mvhd(t[0].timescale,t[0].duration)].concat(a).concat(Ve.mvex(t)))}static mvex(t){let n=t.length;const a=[];for(;n--;)a[n]=Ve.trex(t[n]);return Ve.box.apply(null,[Ve.types.mvex,...a])}static mvhd(t,n){n*=t;const a=Math.floor(n/(Rn+1)),l=Math.floor(n%(Rn+1)),u=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,a>>24,a>>16&255,a>>8&255,a&255,l>>24,l>>16&255,l>>8&255,l&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Ve.box(Ve.types.mvhd,u)}static sdtp(t){const n=t.samples||[],a=new Uint8Array(4+n.length);let l,u;for(l=0;l<n.length;l++)u=n[l].flags,a[l+4]=u.dependsOn<<4|u.isDependedOn<<2|u.hasRedundancy;return Ve.box(Ve.types.sdtp,a)}static stbl(t){return Ve.box(Ve.types.stbl,Ve.stsd(t),Ve.box(Ve.types.stts,Ve.STTS),Ve.box(Ve.types.stsc,Ve.STSC),Ve.box(Ve.types.stsz,Ve.STSZ),Ve.box(Ve.types.stco,Ve.STCO))}static avc1(t){let n=[],a=[],l,u,c;for(l=0;l<t.sps.length;l++)u=t.sps[l],c=u.byteLength,n.push(c>>>8&255),n.push(c&255),n=n.concat(Array.prototype.slice.call(u));for(l=0;l<t.pps.length;l++)u=t.pps[l],c=u.byteLength,a.push(c>>>8&255),a.push(c&255),a=a.concat(Array.prototype.slice.call(u));const p=Ve.box(Ve.types.avcC,new Uint8Array([1,n[3],n[4],n[5],252|3,224|t.sps.length].concat(n).concat([t.pps.length]).concat(a))),v=t.width,A=t.height,C=t.pixelRatio[0],O=t.pixelRatio[1];return Ve.box(Ve.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,v>>8&255,v&255,A>>8&255,A&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),p,Ve.box(Ve.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Ve.box(Ve.types.pasp,new Uint8Array([C>>24,C>>16&255,C>>8&255,C&255,O>>24,O>>16&255,O>>8&255,O&255])))}static esds(t){const n=t.config.length;return new Uint8Array([0,0,0,0,3,23+n,0,1,0,4,15+n,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([n]).concat(t.config).concat([6,1,2]))}static mp4a(t){const n=t.samplerate;return Ve.box(Ve.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,n>>8&255,n&255,0,0]),Ve.box(Ve.types.esds,Ve.esds(t)))}static mp3(t){const n=t.samplerate;return Ve.box(Ve.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,n>>8&255,n&255,0,0]))}static stsd(t){return t.type==="audio"?t.segmentCodec==="mp3"&&t.codec==="mp3"?Ve.box(Ve.types.stsd,Ve.STSD,Ve.mp3(t)):Ve.box(Ve.types.stsd,Ve.STSD,Ve.mp4a(t)):Ve.box(Ve.types.stsd,Ve.STSD,Ve.avc1(t))}static tkhd(t){const n=t.id,a=t.duration*t.timescale,l=t.width,u=t.height,c=Math.floor(a/(Rn+1)),p=Math.floor(a%(Rn+1));return Ve.box(Ve.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,n>>24&255,n>>16&255,n>>8&255,n&255,0,0,0,0,c>>24,c>>16&255,c>>8&255,c&255,p>>24,p>>16&255,p>>8&255,p&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,l>>8&255,l&255,0,0,u>>8&255,u&255,0,0]))}static traf(t,n){const a=Ve.sdtp(t),l=t.id,u=Math.floor(n/(Rn+1)),c=Math.floor(n%(Rn+1));return Ve.box(Ve.types.traf,Ve.box(Ve.types.tfhd,new Uint8Array([0,0,0,0,l>>24,l>>16&255,l>>8&255,l&255])),Ve.box(Ve.types.tfdt,new Uint8Array([1,0,0,0,u>>24,u>>16&255,u>>8&255,u&255,c>>24,c>>16&255,c>>8&255,c&255])),Ve.trun(t,a.length+16+20+8+16+8+8),a)}static trak(t){return t.duration=t.duration||4294967295,Ve.box(Ve.types.trak,Ve.tkhd(t),Ve.mdia(t))}static trex(t){const n=t.id;return Ve.box(Ve.types.trex,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,n&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(t,n){const a=t.samples||[],l=a.length,u=12+16*l,c=new Uint8Array(u);let p,v,A,C,O,U;for(n+=8+u,c.set([t.type==="video"?1:0,0,15,1,l>>>24&255,l>>>16&255,l>>>8&255,l&255,n>>>24&255,n>>>16&255,n>>>8&255,n&255],0),p=0;p<l;p++)v=a[p],A=v.duration,C=v.size,O=v.flags,U=v.cts,c.set([A>>>24&255,A>>>16&255,A>>>8&255,A&255,C>>>24&255,C>>>16&255,C>>>8&255,C&255,O.isLeading<<2|O.dependsOn,O.isDependedOn<<6|O.hasRedundancy<<4|O.paddingValue<<1|O.isNonSync,O.degradPrio&240<<8,O.degradPrio&15,U>>>24&255,U>>>16&255,U>>>8&255,U&255],12+16*p);return Ve.box(Ve.types.trun,c)}static initSegment(t){Ve.types||Ve.init();const n=Ve.moov(t),a=new Uint8Array(Ve.FTYP.byteLength+n.byteLength);return a.set(Ve.FTYP),a.set(n,Ve.FTYP.byteLength),a}}Ve.types=void 0,Ve.HDLR_TYPES=void 0,Ve.STTS=void 0,Ve.STSC=void 0,Ve.STCO=void 0,Ve.STSZ=void 0,Ve.VMHD=void 0,Ve.SMHD=void 0,Ve.STSD=void 0,Ve.FTYP=void 0,Ve.DINF=void 0;const qa=9e4;function x(f,t,n=1,a=!1){const l=f*t*n;return a?Math.round(l):l}function L(f,t,n=1,a=!1){return x(f,t,1/n,a)}function q(f,t=!1){return x(f,1e3,1/qa,t)}function _(f,t=1){return x(f,qa,1/t)}const R=10*1e3,B=1024,X=1152;let ce=null,pe=null;class Ue{constructor(t,n,a,l=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=t,this.config=n,this.typeSupported=a,this.ISGenerated=!1,ce===null){const c=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);ce=c?parseInt(c[1]):0}if(pe===null){const u=navigator.userAgent.match(/Safari\/(\d+)/i);pe=u?parseInt(u[1]):0}}destroy(){}resetTimeStamp(t){T.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=t}resetNextTimestamp(){T.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){T.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1}getVideoStartPts(t){let n=!1;const a=t.reduce((l,u)=>{const c=u.pts-l;return c<-4294967296?(n=!0,He(l,u.pts)):c>0?l:u.pts},t[0].pts);return n&&T.debug("PTS rollover detected"),a}remux(t,n,a,l,u,c,p,v){let A,C,O,U,W,J,oe=u,he=u;const we=t.pid>-1,Fe=n.pid>-1,Me=n.samples.length,it=t.samples.length>0,We=p&&Me>0||Me>1;if((!we||it)&&(!Fe||We)||this.ISGenerated||p){this.ISGenerated||(O=this.generateIS(t,n,u,c));const ut=this.isVideoContiguous;let gt=-1,Ct;if(We&&(gt=yt(n.samples),!ut&&this.config.forceKeyFrameOnDiscontinuity))if(J=!0,gt>0){T.warn(`[mp4-remuxer]: Dropped ${gt} out of ${Me} video samples due to a missing keyframe`);const rt=this.getVideoStartPts(n.samples);n.samples=n.samples.slice(gt),n.dropped+=gt,he+=(n.samples[0].pts-rt)/n.inputTimeScale,Ct=he}else gt===-1&&(T.warn(`[mp4-remuxer]: No keyframe found out of ${Me} video samples`),J=!1);if(this.ISGenerated){if(it&&We){const rt=this.getVideoStartPts(n.samples),Ot=(He(t.samples[0].pts,rt)-rt)/n.inputTimeScale;oe+=Math.max(0,Ot),he+=Math.max(0,-Ot)}if(it){if(t.samplerate||(T.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),O=this.generateIS(t,n,u,c)),C=this.remuxAudio(t,oe,this.isAudioContiguous,c,Fe||We||v===Gt.AUDIO?he:void 0),We){const rt=C?C.endPTS-C.startPTS:0;n.inputTimeScale||(T.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),O=this.generateIS(t,n,u,c)),A=this.remuxVideo(n,he,ut,rt)}}else We&&(A=this.remuxVideo(n,he,ut,0));A&&(A.firstKeyFrame=gt,A.independent=gt!==-1,A.firstKeyFramePTS=Ct)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(a.samples.length&&(W=At(a,u,this._initPTS,this._initDTS)),l.samples.length&&(U=Dt(l,u,this._initPTS))),{audio:C,video:A,initSegment:O,independent:J,text:U,id3:W}}generateIS(t,n,a,l){const u=t.samples,c=n.samples,p=this.typeSupported,v={},A=this._initPTS;let C=!A||l,O="audio/mp4",U,W,J;if(C&&(U=W=Infinity),t.config&&u.length){switch(t.timescale=t.samplerate,t.segmentCodec){case"mp3":p.mpeg?(O="audio/mpeg",t.codec=""):p.mp3&&(t.codec="mp3");break}v.audio={id:"audio",container:O,codec:t.codec,initSegment:t.segmentCodec==="mp3"&&p.mpeg?new Uint8Array(0):Ve.initSegment([t]),metadata:{channelCount:t.channelCount}},C&&(J=t.inputTimeScale,!A||J!==A.timescale?U=W=u[0].pts-Math.round(J*a):C=!1)}if(n.sps&&n.pps&&c.length&&(n.timescale=n.inputTimeScale,v.video={id:"main",container:"video/mp4",codec:n.codec,initSegment:Ve.initSegment([n]),metadata:{width:n.width,height:n.height}},C))if(J=n.inputTimeScale,!A||J!==A.timescale){const oe=this.getVideoStartPts(c),he=Math.round(J*a);W=Math.min(W,He(c[0].dts,oe)-he),U=Math.min(U,oe-he)}else C=!1;if(Object.keys(v).length)return this.ISGenerated=!0,C?(this._initPTS={baseTime:U,timescale:J},this._initDTS={baseTime:W,timescale:J}):U=J=void 0,{tracks:v,initPTS:U,timescale:J}}remuxVideo(t,n,a,l){const u=t.inputTimeScale,c=t.samples,p=[],v=c.length,A=this._initPTS;let C=this.nextAvcDts,O=8,U=this.videoSampleDuration,W,J,oe=Number.POSITIVE_INFINITY,he=Number.NEGATIVE_INFINITY,we=!1;if(!a||C===null){const Ft=n*u,Wt=c[0].pts-He(c[0].dts,c[0].pts);C=Ft-Wt}const Fe=A.baseTime*u/A.timescale;for(let Ft=0;Ft<v;Ft++){const Wt=c[Ft];Wt.pts=He(Wt.pts-Fe,C),Wt.dts=He(Wt.dts-Fe,C),Wt.dts<c[Ft>0?Ft-1:Ft].dts&&(we=!0)}we&&c.sort(function(Ft,Wt){const Ei=Ft.dts-Wt.dts,wi=Ft.pts-Wt.pts;return Ei||wi}),W=c[0].dts,J=c[c.length-1].dts;const Me=J-W,it=Me?Math.round(Me/(v-1)):U||t.inputTimeScale/30;if(a){const Ft=W-C,Wt=Ft>it,Ei=Ft<-1;if((Wt||Ei)&&(Wt?T.warn(`AVC: ${q(Ft,!0)} ms (${Ft}dts) hole between fragments detected, filling it`):T.warn(`AVC: ${q(-Ft,!0)} ms (${Ft}dts) overlapping between fragments detected`),!Ei||C>=c[0].pts)){W=C;const wi=c[0].pts-Ft;c[0].dts=W,c[0].pts=wi,T.log(`Video: First PTS/DTS adjusted: ${q(wi,!0)}/${q(W,!0)}, delta: ${q(Ft,!0)} ms`)}}W=Math.max(0,W);let We=0,St=0;for(let Ft=0;Ft<v;Ft++){const Wt=c[Ft],Ei=Wt.units,wi=Ei.length;let Ti=0;for(let qi=0;qi<wi;qi++)Ti+=Ei[qi].data.length;St+=Ti,We+=wi,Wt.length=Ti,Wt.dts=Math.max(Wt.dts,W),oe=Math.min(Wt.pts,oe),he=Math.max(Wt.pts,he)}J=c[v-1].dts;const ut=St+4*We+8;let gt;try{gt=new Uint8Array(ut)}catch(Ft){this.observer.emit(y.ERROR,y.ERROR,{type:$.MUX_ERROR,details:D.REMUX_ALLOC_ERROR,fatal:!1,error:Ft,bytes:ut,reason:`fail allocating video mdat ${ut}`});return}const Ct=new DataView(gt.buffer);Ct.setUint32(0,ut),gt.set(Ve.types.mdat,4);let rt=!1,qt=Number.POSITIVE_INFINITY,Ot=Number.POSITIVE_INFINITY,Si=Number.NEGATIVE_INFINITY,Pn=Number.NEGATIVE_INFINITY;for(let Ft=0;Ft<v;Ft++){const Wt=c[Ft],Ei=Wt.units;let wi=0;for(let wn=0,dr=Ei.length;wn<dr;wn++){const xn=Ei[wn],Ss=xn.data,Ja=xn.data.byteLength;Ct.setUint32(O,Ja),O+=4,gt.set(Ss,O),O+=Ja,wi+=4+Ja}let Ti;if(Ft<v-1)U=c[Ft+1].dts-Wt.dts,Ti=c[Ft+1].pts-Wt.pts;else{const wn=this.config,dr=Ft>0?Wt.dts-c[Ft-1].dts:it;if(Ti=Ft>0?Wt.pts-c[Ft-1].pts:it,wn.stretchShortVideoTrack&&this.nextAudioPts!==null){const xn=Math.floor(wn.maxBufferHole*u),Ss=(l?oe+l*u:this.nextAudioPts)-Wt.pts;Ss>xn?(U=Ss-dr,U<0?U=dr:rt=!0,T.log(`[mp4-remuxer]: It is approximately ${Ss/90} ms to the next segment; using duration ${U/90} ms for the last video frame.`)):U=dr}else U=dr}const qi=Math.round(Wt.pts-Wt.dts);qt=Math.min(qt,U),Si=Math.max(Si,U),Ot=Math.min(Ot,Ti),Pn=Math.max(Pn,Ti),p.push(new Et(Wt.key,U,wi,qi))}if(p.length){if(ce){if(ce<70){const Ft=p[0].flags;Ft.dependsOn=2,Ft.isNonSync=0}}else if(pe&&Pn-Ot<Si-qt&&it/Si<.025&&p[0].cts===0){T.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let Ft=W;for(let Wt=0,Ei=p.length;Wt<Ei;Wt++){const wi=Ft+p[Wt].duration,Ti=Ft+p[Wt].cts;if(Wt<Ei-1){const qi=wi+p[Wt+1].cts;p[Wt].duration=qi-Ti}else p[Wt].duration=Wt?p[Wt-1].duration:it;p[Wt].cts=0,Ft=wi}}}U=rt||!U?it:U,this.nextAvcDts=C=J+U,this.videoSampleDuration=U,this.isVideoContiguous=!0;const Pi=Ve.moof(t.sequenceNumber++,W,Ee({},t,{samples:p})),Ni="video",Ui={data1:Pi,data2:gt,startPTS:oe/u,endPTS:(he+U)/u,startDTS:W/u,endDTS:C/u,type:Ni,hasAudio:!1,hasVideo:!0,nb:p.length,dropped:t.dropped};return t.samples=[],t.dropped=0,Ui}remuxAudio(t,n,a,l,u){const c=t.inputTimeScale,p=t.samplerate?t.samplerate:c,v=c/p,A=t.segmentCodec==="aac"?B:X,C=A*v,O=this._initPTS,U=t.segmentCodec==="mp3"&&this.typeSupported.mpeg,W=[],J=u!==void 0;let oe=t.samples,he=U?0:8,we=this.nextAudioPts||-1;const Fe=n*c,Me=O.baseTime*c/O.timescale;if(this.isAudioContiguous=a=a||oe.length&&we>0&&(l&&Math.abs(Fe-we)<9e3||Math.abs(He(oe[0].pts-Me,Fe)-we)<20*C),oe.forEach(function(Ni){Ni.pts=He(Ni.pts-Me,Fe)}),!a||we<0){if(oe=oe.filter(Ni=>Ni.pts>=0),!oe.length)return;u===0?we=0:l&&!J?we=Math.max(0,Fe):we=oe[0].pts}if(t.segmentCodec==="aac"){const Ni=this.config.maxAudioFramesDrift;for(let Ui=0,Ft=we;Ui<oe.length;Ui++){const Wt=oe[Ui],Ei=Wt.pts,wi=Ei-Ft,Ti=Math.abs(1e3*wi/c);if(wi<=-Ni*C&&J)Ui===0&&(T.warn(`Audio frame @ ${(Ei/c).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*wi/c)} ms.`),this.nextAudioPts=we=Ft=Ei);else if(wi>=Ni*C&&Ti<R&&J){let qi=Math.round(wi/C);Ft=Ei-qi*C,Ft<0&&(qi--,Ft+=C),Ui===0&&(this.nextAudioPts=we=Ft),T.warn(`[mp4-remuxer]: Injecting ${qi} audio frame @ ${(Ft/c).toFixed(3)}s due to ${Math.round(1e3*wi/c)} ms gap.`);for(let wn=0;wn<qi;wn++){const dr=Math.max(Ft,0);let xn=Fr.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);xn||(T.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),xn=Wt.unit.subarray()),oe.splice(Ui,0,{unit:xn,pts:dr}),Ft+=C,Ui++}}Wt.pts=Ft,Ft+=C}}let it=null,We=null,St,ut=0,gt=oe.length;for(;gt--;)ut+=oe[gt].unit.byteLength;for(let Ni=0,Ui=oe.length;Ni<Ui;Ni++){const Ft=oe[Ni],Wt=Ft.unit;let Ei=Ft.pts;if(We!==null){const Ti=W[Ni-1];Ti.duration=Math.round((Ei-We)/v)}else if(a&&t.segmentCodec==="aac"&&(Ei=we),it=Ei,ut>0){ut+=he;try{St=new Uint8Array(ut)}catch(Ti){this.observer.emit(y.ERROR,y.ERROR,{type:$.MUX_ERROR,details:D.REMUX_ALLOC_ERROR,fatal:!1,error:Ti,bytes:ut,reason:`fail allocating audio mdat ${ut}`});return}U||(new DataView(St.buffer).setUint32(0,ut),St.set(Ve.types.mdat,4))}else return;St.set(Wt,he);const wi=Wt.byteLength;he+=wi,W.push(new Et(!0,A,wi,0)),We=Ei}const Ct=W.length;if(!Ct)return;const rt=W[W.length-1];this.nextAudioPts=we=We+v*rt.duration;const qt=U?new Uint8Array(0):Ve.moof(t.sequenceNumber++,it/v,Ee({},t,{samples:W}));t.samples=[];const Ot=it/c,Si=we/c,Pi={data1:qt,data2:St,startPTS:Ot,endPTS:Si,startDTS:Ot,endDTS:Si,type:"audio",hasAudio:!0,hasVideo:!1,nb:Ct};return this.isAudioContiguous=!0,Pi}remuxEmptyAudio(t,n,a,l){const u=t.inputTimeScale,c=t.samplerate?t.samplerate:u,p=u/c,v=this.nextAudioPts,A=this._initDTS,C=A.baseTime*9e4/A.timescale,O=(v!==null?v:l.startDTS*u)+C,U=l.endDTS*u+C,W=p*B,J=Math.ceil((U-O)/W),oe=Fr.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(T.warn("[mp4-remuxer]: remux empty Audio"),!oe){T.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}const he=[];for(let we=0;we<J;we++){const Fe=O+we*W;he.push({unit:oe,pts:Fe,dts:Fe})}return t.samples=he,this.remuxAudio(t,n,a,!1)}}function He(f,t){let n;if(t===null)return f;for(t<f?n=-8589934592:n=8589934592;Math.abs(f-t)>4294967296;)f+=n;return f}function yt(f){for(let t=0;t<f.length;t++)if(f[t].key)return t;return-1}function At(f,t,n,a){const l=f.samples.length;if(!l)return;const u=f.inputTimeScale;for(let p=0;p<l;p++){const v=f.samples[p];v.pts=He(v.pts-n.baseTime*u/n.timescale,t*u)/u,v.dts=He(v.dts-a.baseTime*u/a.timescale,t*u)/u}const c=f.samples;return f.samples=[],{samples:c}}function Dt(f,t,n){const a=f.samples.length;if(!a)return;const l=f.inputTimeScale;for(let c=0;c<a;c++){const p=f.samples[c];p.pts=He(p.pts-n.baseTime*l/n.timescale,t*l)/l}f.samples.sort((c,p)=>c.pts-p.pts);const u=f.samples;return f.samples=[],{samples:u}}class Et{constructor(t,n,a,l){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=n,this.size=a,this.cts=l,this.flags=new vt(t)}}class vt{constructor(t){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=t?2:1,this.isNonSync=t?0:1}}class Bt{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(t){this.initPTS=t,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(t,n,a,l){this.audioCodec=n,this.videoCodec=a,this.generateInitSegment(Ri(t,l)),this.emitInitSegment=!0}generateInitSegment(t){let{audioCodec:n,videoCodec:a}=this;if(!(t!=null&&t.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const l=this.initData=pr(t);n||(n=Fi(l.audio,ve.AUDIO)),a||(a=Fi(l.video,ve.VIDEO));const u={};l.audio&&l.video?u.audiovideo={container:"video/mp4",codec:n+","+a,initSegment:t,id:"main"}:l.audio?u.audio={container:"audio/mp4",codec:n,initSegment:t,id:"audio"}:l.video?u.video={container:"video/mp4",codec:a,initSegment:t,id:"main"}:T.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=u}remux(t,n,a,l,u,c){var p,v;let{initPTS:A,lastEndTime:C}=this;const O={audio:void 0,video:void 0,text:l,id3:a,initSegment:void 0};te(C)||(C=this.lastEndTime=u||0);const U=n.samples;if(!(U!=null&&U.length))return O;const W={initPTS:void 0,timescale:1};let J=this.initData;if((p=J)!=null&&p.length||(this.generateInitSegment(U),J=this.initData),!((v=J)!=null&&v.length))return T.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),O;this.emitInitSegment&&(W.tracks=this.initTracks,this.emitInitSegment=!1);const oe=mr(U,J),he=Rs(J,U),we=he===null?u:he;(Yt(A,we,u,oe)||W.timescale!==A.timescale&&c)&&(W.initPTS=we-u,A&&A.timescale===1&&T.warn(`Adjusting initPTS by ${W.initPTS-A.baseTime}`),this.initPTS=A={baseTime:W.initPTS,timescale:1});const Fe=t?we-A.baseTime/A.timescale:C,Me=Fe+oe;Mn(J,U,A.baseTime/A.timescale),oe>0?this.lastEndTime=Me:(T.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const it=!!J.audio,We=!!J.video;let St="";it&&(St+="audio"),We&&(St+="video");const ut={data1:U,startPTS:Fe,startDTS:Fe,endPTS:Me,endDTS:Me,type:St,hasAudio:it,hasVideo:We,nb:1,dropped:0};return O.audio=ut.type==="audio"?ut:void 0,O.video=ut.type!=="audio"?ut:void 0,O.initSegment=W,O.id3=At(a,u,A,A),l.samples.length&&(O.text=Dt(l,u,A)),O}}function Yt(f,t,n,a){if(f===null)return!0;const l=Math.max(a,1),u=t-f.baseTime/f.timescale;return Math.abs(u-n)>l}function Fi(f,t){const n=f==null?void 0:f.codec;return n&&n.length>4?n:n==="hvc1"||n==="hev1"?"hvc1.1.6.L120.90":n==="av01"?"av01.0.04M.08":n==="avc1"||t===ve.VIDEO?"avc1.42e01e":"mp4a.40.5"}let hi;try{hi=self.performance.now.bind(self.performance)}catch(f){T.debug("Unable to use Performance API on this environment"),hi=typeof self!="undefined"&&self.Date.now}const fi=[{demux:fa,remux:Bt},{demux:_n,remux:Ue},{demux:Lo,remux:Ue},{demux:_r,remux:Ue}];class sr{constructor(t,n,a,l,u){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=t,this.typeSupported=n,this.config=a,this.vendor=l,this.id=u}configure(t){this.transmuxConfig=t,this.decrypter&&this.decrypter.reset()}push(t,n,a,l){const u=a.transmuxing;u.executeStart=hi();let c=new Uint8Array(t);const{currentTransmuxState:p,transmuxConfig:v}=this;l&&(this.currentTransmuxState=l);const{contiguous:A,discontinuity:C,trackSwitch:O,accurateTimeOffset:U,timeOffset:W,initSegmentChange:J}=l||p,{audioCodec:oe,videoCodec:he,defaultInitPts:we,duration:Fe,initSegmentData:Me}=v,it=Hi(c,n);if(it&&it.method==="AES-128"){const gt=this.getDecrypter();if(gt.isSync()){let Ct=gt.softwareDecrypt(c,it.key.buffer,it.iv.buffer);if(a.part>-1&&(Ct=gt.flush()),!Ct)return u.executeEnd=hi(),rs(a);c=new Uint8Array(Ct)}else return this.decryptionPromise=gt.webCryptoDecrypt(c,it.key.buffer,it.iv.buffer).then(Ct=>{const rt=this.push(Ct,null,a);return this.decryptionPromise=null,rt}),this.decryptionPromise}const We=this.needsProbing(C,O);if(We){const gt=this.configureTransmuxer(c);if(gt)return T.warn(`[transmuxer] ${gt.message}`),this.observer.emit(y.ERROR,y.ERROR,{type:$.MEDIA_ERROR,details:D.FRAG_PARSING_ERROR,fatal:!1,error:gt,reason:gt.message}),u.executeEnd=hi(),rs(a)}(C||O||J||We)&&this.resetInitSegment(Me,oe,he,Fe,n),(C||J||We)&&this.resetInitialTimestamp(we),A||this.resetContiguity();const St=this.transmux(c,it,W,U,a),ut=this.currentTransmuxState;return ut.contiguous=!0,ut.discontinuity=!1,ut.trackSwitch=!1,u.executeEnd=hi(),St}flush(t){const n=t.transmuxing;n.executeStart=hi();const{decrypter:a,currentTransmuxState:l,decryptionPromise:u}=this;if(u)return u.then(()=>this.flush(t));const c=[],{timeOffset:p}=l;if(a){const O=a.flush();O&&c.push(this.push(O,null,t))}const{demuxer:v,remuxer:A}=this;if(!v||!A)return n.executeEnd=hi(),[rs(t)];const C=v.flush(p);return Nr(C)?C.then(O=>(this.flushRemux(c,O,t),c)):(this.flushRemux(c,C,t),c)}flushRemux(t,n,a){const{audioTrack:l,videoTrack:u,id3Track:c,textTrack:p}=n,{accurateTimeOffset:v,timeOffset:A}=this.currentTransmuxState;T.log(`[transmuxer.ts]: Flushed fragment ${a.sn}${a.part>-1?" p: "+a.part:""} of level ${a.level}`);const C=this.remuxer.remux(l,u,c,p,A,v,!0,this.id);t.push({remuxResult:C,chunkMeta:a}),a.transmuxing.executeEnd=hi()}resetInitialTimestamp(t){const{demuxer:n,remuxer:a}=this;!n||!a||(n.resetTimeStamp(t),a.resetTimeStamp(t))}resetContiguity(){const{demuxer:t,remuxer:n}=this;!t||!n||(t.resetContiguity(),n.resetNextTimestamp())}resetInitSegment(t,n,a,l,u){const{demuxer:c,remuxer:p}=this;!c||!p||(c.resetInitSegment(t,n,a,l),p.resetInitSegment(t,n,a,u))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(t,n,a,l,u){let c;return n&&n.method==="SAMPLE-AES"?c=this.transmuxSampleAes(t,n,a,l,u):c=this.transmuxUnencrypted(t,a,l,u),c}transmuxUnencrypted(t,n,a,l){const{audioTrack:u,videoTrack:c,id3Track:p,textTrack:v}=this.demuxer.demux(t,n,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(u,c,p,v,n,a,!1,this.id),chunkMeta:l}}transmuxSampleAes(t,n,a,l,u){return this.demuxer.demuxSampleAes(t,n,a).then(c=>({remuxResult:this.remuxer.remux(c.audioTrack,c.videoTrack,c.id3Track,c.textTrack,a,l,!1,this.id),chunkMeta:u}))}configureTransmuxer(t){const{config:n,observer:a,typeSupported:l,vendor:u}=this;let c;for(let O=0,U=fi.length;O<U;O++)if(fi[O].demux.probe(t)){c=fi[O];break}if(!c)return new Error("Failed to find demuxer by probing fragment data");const p=this.demuxer,v=this.remuxer,A=c.remux,C=c.demux;(!v||!(v instanceof A))&&(this.remuxer=new A(a,n,l,u)),(!p||!(p instanceof C))&&(this.demuxer=new C(a,n,l),this.probe=C.probe)}needsProbing(t,n){return!this.demuxer||!this.remuxer||t||n}getDecrypter(){let t=this.decrypter;return t||(t=this.decrypter=new Yi(this.config)),t}}function Hi(f,t){let n=null;return f.byteLength>0&&t!=null&&t.key!=null&&t.iv!==null&&t.method!=null&&(n=t),n}const rs=f=>({remuxResult:{},chunkMeta:f});function Nr(f){return"then"in f&&f.then instanceof Function}class Xn{constructor(t,n,a,l,u){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=t,this.videoCodec=n,this.initSegmentData=a,this.duration=l,this.defaultInitPts=u||null}}class pu{constructor(t,n,a,l,u,c){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=t,this.contiguous=n,this.accurateTimeOffset=a,this.trackSwitch=l,this.timeOffset=u,this.initSegmentChange=c}}var Io={exports:{}};(function(f){var t=Object.prototype.hasOwnProperty,n="~";function a(){}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(n=!1));function l(v,A,C){this.fn=v,this.context=A,this.once=C||!1}function u(v,A,C,O,U){if(typeof C!="function")throw new TypeError("The listener must be a function");var W=new l(C,O||v,U),J=n?n+A:A;return v._events[J]?v._events[J].fn?v._events[J]=[v._events[J],W]:v._events[J].push(W):(v._events[J]=W,v._eventsCount++),v}function c(v,A){--v._eventsCount==0?v._events=new a:delete v._events[A]}function p(){this._events=new a,this._eventsCount=0}p.prototype.eventNames=function(){var A=[],C,O;if(this._eventsCount===0)return A;for(O in C=this._events)t.call(C,O)&&A.push(n?O.slice(1):O);return Object.getOwnPropertySymbols?A.concat(Object.getOwnPropertySymbols(C)):A},p.prototype.listeners=function(A){var C=n?n+A:A,O=this._events[C];if(!O)return[];if(O.fn)return[O.fn];for(var U=0,W=O.length,J=new Array(W);U<W;U++)J[U]=O[U].fn;return J},p.prototype.listenerCount=function(A){var C=n?n+A:A,O=this._events[C];return O?O.fn?1:O.length:0},p.prototype.emit=function(A,C,O,U,W,J){var oe=n?n+A:A;if(!this._events[oe])return!1;var he=this._events[oe],we=arguments.length,Fe,Me;if(he.fn){switch(he.once&&this.removeListener(A,he.fn,void 0,!0),we){case 1:return he.fn.call(he.context),!0;case 2:return he.fn.call(he.context,C),!0;case 3:return he.fn.call(he.context,C,O),!0;case 4:return he.fn.call(he.context,C,O,U),!0;case 5:return he.fn.call(he.context,C,O,U,W),!0;case 6:return he.fn.call(he.context,C,O,U,W,J),!0}for(Me=1,Fe=new Array(we-1);Me<we;Me++)Fe[Me-1]=arguments[Me];he.fn.apply(he.context,Fe)}else{var it=he.length,We;for(Me=0;Me<it;Me++)switch(he[Me].once&&this.removeListener(A,he[Me].fn,void 0,!0),we){case 1:he[Me].fn.call(he[Me].context);break;case 2:he[Me].fn.call(he[Me].context,C);break;case 3:he[Me].fn.call(he[Me].context,C,O);break;case 4:he[Me].fn.call(he[Me].context,C,O,U);break;default:if(!Fe)for(We=1,Fe=new Array(we-1);We<we;We++)Fe[We-1]=arguments[We];he[Me].fn.apply(he[Me].context,Fe)}}return!0},p.prototype.on=function(A,C,O){return u(this,A,C,O,!1)},p.prototype.once=function(A,C,O){return u(this,A,C,O,!0)},p.prototype.removeListener=function(A,C,O,U){var W=n?n+A:A;if(!this._events[W])return this;if(!C)return c(this,W),this;var J=this._events[W];if(J.fn)J.fn===C&&(!U||J.once)&&(!O||J.context===O)&&c(this,W);else{for(var oe=0,he=[],we=J.length;oe<we;oe++)(J[oe].fn!==C||U&&!J[oe].once||O&&J[oe].context!==O)&&he.push(J[oe]);he.length?this._events[W]=he.length===1?he[0]:he:c(this,W)}return this},p.prototype.removeAllListeners=function(A){var C;return A?(C=n?n+A:A,this._events[C]&&c(this,C)):(this._events=new a,this._eventsCount=0),this},p.prototype.off=p.prototype.removeListener,p.prototype.addListener=p.prototype.on,p.prefixed=n,p.EventEmitter=p,f.exports=p})(Io);var Ro=Io.exports,ya=lt(Ro);const Cl=an()||{isTypeSupported:()=>!1};class mu{constructor(t,n,a,l){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const u=t.config;this.hls=t,this.id=n,this.useWorker=!!u.enableWorker,this.onTransmuxComplete=a,this.onFlush=l;const c=(A,C)=>{C=C||{},C.frag=this.frag,C.id=this.id,A===y.ERROR&&(this.error=C.error),this.hls.trigger(A,C)};this.observer=new ya,this.observer.on(y.FRAG_DECRYPTED,c),this.observer.on(y.ERROR,c);const p={mp4:Cl.isTypeSupported("video/mp4"),mpeg:Cl.isTypeSupported("audio/mpeg"),mp3:Cl.isTypeSupported('audio/mp4; codecs="mp3"')},v=navigator.vendor;if(this.useWorker&&typeof Worker!="undefined"&&(u.workerPath||gs())){try{u.workerPath?(T.log(`loading Web Worker ${u.workerPath} for "${n}"`),this.workerContext=nr(u.workerPath)):(T.log(`injecting Web Worker for "${n}"`),this.workerContext=ys()),this.onwmsg=O=>this.onWorkerMessage(O);const{worker:C}=this.workerContext;C.addEventListener("message",this.onwmsg),C.onerror=O=>{const U=new Error(`${O.message}  (${O.filename}:${O.lineno})`);u.enableWorker=!1,T.warn(`Error in "${n}" Web Worker, fallback to inline`),this.hls.trigger(y.ERROR,{type:$.OTHER_ERROR,details:D.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:U})},C.postMessage({cmd:"init",typeSupported:p,vendor:v,id:n,config:JSON.stringify(u)})}catch(C){T.warn(`Error setting up "${n}" Web Worker, fallback to inline`,C),this.resetWorker(),this.error=null,this.transmuxer=new sr(this.observer,p,u,v,n)}return}this.transmuxer=new sr(this.observer,p,u,v,n)}resetWorker(){if(this.workerContext){const{worker:t,objectURL:n}=this.workerContext;n&&self.URL.revokeObjectURL(n),t.removeEventListener("message",this.onwmsg),t.onerror=null,t.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const n=this.transmuxer;n&&(n.destroy(),this.transmuxer=null)}const t=this.observer;t&&t.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(t,n,a,l,u,c,p,v,A,C){var O,U;A.transmuxing.start=self.performance.now();const{transmuxer:W}=this,J=c?c.start:u.start,oe=u.decryptdata,he=this.frag,we=!(he&&u.cc===he.cc),Fe=!(he&&A.level===he.level),Me=he?A.sn-he.sn:-1,it=this.part?A.part-this.part.index:-1,We=Me===0&&A.id>1&&A.id===(he==null?void 0:he.stats.chunkCount),St=!Fe&&(Me===1||Me===0&&(it===1||We&&it<=0)),ut=self.performance.now();(Fe||Me||u.stats.parsing.start===0)&&(u.stats.parsing.start=ut),c&&(it||!St)&&(c.stats.parsing.start=ut);const gt=!(he&&((O=u.initSegment)==null?void 0:O.url)===((U=he.initSegment)==null?void 0:U.url)),Ct=new pu(we,St,v,Fe,J,gt);if(!St||we||gt){T.log(`[transmuxer-interface, ${u.type}]: Starting new transmux session for sn: ${A.sn} p: ${A.part} level: ${A.level} id: ${A.id}
        discontinuity: ${we}
        trackSwitch: ${Fe}
        contiguous: ${St}
        accurateTimeOffset: ${v}
        timeOffset: ${J}
        initSegmentChange: ${gt}`);const rt=new Xn(a,l,n,p,C);this.configureTransmuxer(rt)}if(this.frag=u,this.part=c,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:t,decryptdata:oe,chunkMeta:A,state:Ct},t instanceof ArrayBuffer?[t]:[]);else if(W){const rt=W.push(t,oe,A,Ct);Nr(rt)?(W.async=!0,rt.then(qt=>{this.handleTransmuxComplete(qt)}).catch(qt=>{this.transmuxerError(qt,A,"transmuxer-interface push error")})):(W.async=!1,this.handleTransmuxComplete(rt))}}flush(t){t.transmuxing.start=self.performance.now();const{transmuxer:n}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:t});else if(n){let a=n.flush(t);Nr(a)||n.async?(Nr(a)||(a=Promise.resolve(a)),a.then(u=>{this.handleFlushResult(u,t)}).catch(u=>{this.transmuxerError(u,t,"transmuxer-interface flush error")})):this.handleFlushResult(a,t)}}transmuxerError(t,n,a){!this.hls||(this.error=t,this.hls.trigger(y.ERROR,{type:$.MEDIA_ERROR,details:D.FRAG_PARSING_ERROR,chunkMeta:n,fatal:!1,error:t,err:t,reason:a}))}handleFlushResult(t,n){t.forEach(a=>{this.handleTransmuxComplete(a)}),this.onFlush(n)}onWorkerMessage(t){const n=t.data,a=this.hls;switch(n.event){case"init":{var l;const u=(l=this.workerContext)==null?void 0:l.objectURL;u&&self.URL.revokeObjectURL(u);break}case"transmuxComplete":{this.handleTransmuxComplete(n.data);break}case"flush":{this.onFlush(n.data);break}case"workerLog":T[n.data.logType]&&T[n.data.logType](n.data.message);break;default:{n.data=n.data||{},n.data.frag=this.frag,n.data.id=this.id,a.trigger(n.event,n.data);break}}}configureTransmuxer(t){const{transmuxer:n}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:t}):n&&n.configure(t)}handleTransmuxComplete(t){t.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(t)}}const Qn=250,pn=2,va=.1,Oo=.05;class wl{constructor(t,n,a,l){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=t,this.media=n,this.fragmentTracker=a,this.hls=l}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(t,n){const{config:a,media:l,stalled:u}=this;if(l===null)return;const{currentTime:c,seeking:p}=l,v=this.seeking&&!p,A=!this.seeking&&p;if(this.seeking=p,c!==t){if(this.moved=!0,u!==null){if(this.stallReported){const we=self.performance.now()-u;T.warn(`playback not stuck anymore @${c}, after ${Math.round(we)}ms`),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if(A||v){this.stalled=null;return}if(l.paused&&!p||l.ended||l.playbackRate===0||!ni.getBuffered(l).length)return;const C=ni.bufferInfo(l,c,0),O=C.len>0,U=C.nextStart||0;if(!O&&!U)return;if(p){const we=C.len>pn,Fe=!U||n&&n.start<=c||U-c>pn&&!this.fragmentTracker.getPartialFragment(c);if(we||Fe)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var W;const we=Math.max(U,C.start||0)-c,Fe=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,it=(Fe==null||(W=Fe.details)==null?void 0:W.live)?Fe.details.targetduration*2:pn,We=this.fragmentTracker.getPartialFragment(c);if(we>0&&(we<=it||We)){this._trySkipBufferHole(We);return}}const J=self.performance.now();if(u===null){this.stalled=J;return}const oe=J-u;if(!p&&oe>=Qn&&(this._reportStall(C),!this.media))return;const he=ni.bufferInfo(l,c,a.maxBufferHole);this._tryFixBufferStall(he,oe)}_tryFixBufferStall(t,n){const{config:a,fragmentTracker:l,media:u}=this;if(u===null)return;const c=u.currentTime,p=l.getPartialFragment(c);p&&(this._trySkipBufferHole(p)||!this.media)||(t.len>a.maxBufferHole||t.nextStart&&t.nextStart-c<a.maxBufferHole)&&n>a.highBufferWatchdogPeriod*1e3&&(T.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(t){const{hls:n,media:a,stallReported:l}=this;if(!l&&a){this.stallReported=!0;const u=new Error(`Playback stalling at @${a.currentTime} due to low buffer (${JSON.stringify(t)})`);T.warn(u.message),n.trigger(y.ERROR,{type:$.MEDIA_ERROR,details:D.BUFFER_STALLED_ERROR,fatal:!1,error:u,buffer:t.len})}}_trySkipBufferHole(t){const{config:n,hls:a,media:l}=this;if(l===null)return 0;const u=l.currentTime,c=ni.bufferInfo(l,u,0),p=u<c.start?c.start:c.nextStart;if(p){const v=c.len<=n.maxBufferHole,A=c.len>0&&c.len<1&&l.readyState<3,C=p-u;if(C>0&&(v||A)){if(C>n.maxBufferHole){const{fragmentTracker:U}=this;let W=!1;if(u===0){const J=U.getAppendedFrag(0,Gt.MAIN);J&&p<J.end&&(W=!0)}if(!W){const J=t||U.getAppendedFrag(u,Gt.MAIN);if(J){let oe=!1,he=J.end;for(;he<p;){const we=U.getPartialFragment(he);if(we)he+=we.duration;else{oe=!0;break}}if(oe)return 0}}}const O=Math.max(p+Oo,u+va);if(T.warn(`skipping hole, adjusting currentTime from ${u} to ${O}`),this.moved=!0,this.stalled=null,l.currentTime=O,t&&!t.gap){const U=new Error(`fragment loaded with buffer holes, seeking from ${u} to ${O}`);a.trigger(y.ERROR,{type:$.MEDIA_ERROR,details:D.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:U,reason:U.message,frag:t})}return O}}return 0}_tryNudgeBuffer(){const{config:t,hls:n,media:a,nudgeRetry:l}=this;if(a===null)return;const u=a.currentTime;if(this.nudgeRetry++,l<t.nudgeMaxRetry){const c=u+(l+1)*t.nudgeOffset,p=new Error(`Nudging 'currentTime' from ${u} to ${c}`);T.warn(p.message),a.currentTime=c,n.trigger(y.ERROR,{type:$.MEDIA_ERROR,details:D.BUFFER_NUDGE_ON_STALL,error:p,fatal:!1})}else{const c=new Error(`Playhead still not moving while enough data buffered @${u} after ${t.nudgeMaxRetry} nudges`);T.error(c.message),n.trigger(y.ERROR,{type:$.MEDIA_ERROR,details:D.BUFFER_STALLED_ERROR,error:c,fatal:!0})}}}const kd=100;class ar extends ri{constructor(t,n,a){super(t,n,a,"[stream-controller]",Gt.MAIN);this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:t}=this;t.on(y.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(y.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(y.MANIFEST_LOADING,this.onManifestLoading,this),t.on(y.MANIFEST_PARSED,this.onManifestParsed,this),t.on(y.LEVEL_LOADING,this.onLevelLoading,this),t.on(y.LEVEL_LOADED,this.onLevelLoaded,this),t.on(y.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.on(y.ERROR,this.onError,this),t.on(y.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(y.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.on(y.BUFFER_CREATED,this.onBufferCreated,this),t.on(y.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(y.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(y.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:t}=this;t.off(y.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(y.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(y.MANIFEST_LOADING,this.onManifestLoading,this),t.off(y.MANIFEST_PARSED,this.onManifestParsed,this),t.off(y.LEVEL_LOADED,this.onLevelLoaded,this),t.off(y.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.off(y.ERROR,this.onError,this),t.off(y.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(y.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.off(y.BUFFER_CREATED,this.onBufferCreated,this),t.off(y.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(y.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(y.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),this.onMediaDetaching()}startLoad(t){if(this.levels){const{lastCurrentTime:n,hls:a}=this;if(this.stopLoad(),this.setInterval(kd),this.level=-1,!this.startFragRequested){let l=a.startLevel;l===-1&&(a.config.testBandwidth&&this.levels.length>1?(l=0,this.bitrateTest=!0):l=a.nextAutoLevel),this.level=a.nextLoadLevel=l,this.loadedmetadata=!1}n>0&&t===-1&&(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),t=n),this.state=st.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}else this._forceStartLoad=!0,this.state=st.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case st.WAITING_LEVEL:{var t;const{levels:a,level:l}=this,u=a==null||(t=a[l])==null?void 0:t.details;if(u&&(!u.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(u))break;this.state=st.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=st.IDLE;break}break}case st.FRAG_LOADING_WAITING_RETRY:{var n;const a=self.performance.now(),l=this.retryDate;(!l||a>=l||(n=this.media)!=null&&n.seeking)&&(this.resetStartWhenNotLoaded(this.level),this.state=st.IDLE)}break}this.state===st.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:t,levelLastLoaded:n,levels:a,media:l}=this,{config:u,nextLoadLevel:c}=t;if(n===null||!l&&(this.startFragRequested||!u.startFragPrefetch)||this.altAudio&&this.audioOnly||!(a!=null&&a[c]))return;const p=a[c],v=this.getMainFwdBufferInfo();if(v===null)return;const A=this.getLevelDetails();if(A&&this._streamEnded(v,A)){const he={};this.altAudio&&(he.type="video"),this.hls.trigger(y.BUFFER_EOS,he),this.state=st.ENDED;return}t.loadLevel!==c&&t.manualLevel===-1&&this.log(`Adapting to level ${c} from level ${this.level}`),this.level=t.nextLoadLevel=c;const C=p.details;if(!C||this.state===st.WAITING_LEVEL||C.live&&this.levelLastLoaded!==c){this.level=c,this.state=st.WAITING_LEVEL;return}const O=v.len,U=this.getMaxBufferLength(p.maxBitrate);if(O>=U)return;this.backtrackFragment&&this.backtrackFragment.start>v.end&&(this.backtrackFragment=null);const W=this.backtrackFragment?this.backtrackFragment.start:v.end;let J=this.getNextFragment(W,C);if(this.couldBacktrack&&!this.fragPrevious&&J&&J.sn!=="initSegment"&&this.fragmentTracker.getState(J)!==ei.OK){var oe;const we=((oe=this.backtrackFragment)!=null?oe:J).sn-C.startSN,Fe=C.fragments[we-1];Fe&&J.cc===Fe.cc&&(J=Fe,this.fragmentTracker.removeFragment(Fe))}else this.backtrackFragment&&v.len&&(this.backtrackFragment=null);if(J&&this.isLoopLoading(J,W)){if(!J.gap){const we=this.audioOnly&&!this.altAudio?ve.AUDIO:ve.VIDEO,Fe=(we===ve.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;Fe&&this.afterBufferFlushed(Fe,we,Gt.MAIN)}J=this.getNextFragmentLoopLoading(J,C,v,Gt.MAIN,U)}!J||(J.initSegment&&!J.initSegment.data&&!this.bitrateTest&&(J=J.initSegment),this.loadFragment(J,p,W))}loadFragment(t,n,a){const l=this.fragmentTracker.getState(t);this.fragCurrent=t,l===ei.NOT_LOADED||l===ei.PARTIAL?t.sn==="initSegment"?this._loadInitSegment(t,n):this.bitrateTest?(this.log(`Fragment ${t.sn} of level ${t.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(t,n)):(this.startFragRequested=!0,super.loadFragment(t,n,a)):this.clearTrackerIfNeeded(t)}getBufferedFrag(t){return this.fragmentTracker.getBufferedFrag(t,Gt.MAIN)}followingBufferedFrag(t){return t?this.getBufferedFrag(t.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:t,media:n}=this;if(n!=null&&n.readyState){let a;const l=this.getAppendedFrag(n.currentTime);l&&l.start>1&&this.flushMainBuffer(0,l.start-1);const u=this.getLevelDetails();if(u!=null&&u.live){const p=this.getMainFwdBufferInfo();if(!p||p.len<u.targetduration*2)return}if(!n.paused&&t){const p=this.hls.nextLoadLevel,v=t[p],A=this.fragLastKbps;A&&this.fragCurrent?a=this.fragCurrent.duration*v.maxBitrate/(1e3*A)+1:a=0}else a=0;const c=this.getBufferedFrag(n.currentTime+a);if(c){const p=this.followingBufferedFrag(c);if(p){this.abortCurrentFrag();const v=p.maxStartPTS?p.maxStartPTS:p.start,A=p.duration,C=Math.max(c.end,v+Math.min(Math.max(A-this.config.maxFragLookUpTolerance,A*.5),A*.75));this.flushMainBuffer(C,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const t=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,t&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.state){case st.KEY_LOADING:case st.FRAG_LOADING:case st.FRAG_LOADING_WAITING_RETRY:case st.PARSING:case st.PARSED:this.state=st.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(t,n){super.flushMainBuffer(t,n,this.altAudio?"video":null)}onMediaAttached(t,n){super.onMediaAttached(t,n);const a=n.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),a.addEventListener("playing",this.onvplaying),a.addEventListener("seeked",this.onvseeked),this.gapController=new wl(this.config,a,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:t}=this;t&&this.onvplaying&&this.onvseeked&&(t.removeEventListener("playing",this.onvplaying),t.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const t=this.media,n=t?t.currentTime:null;te(n)&&this.log(`Media seeked to ${n.toFixed(3)}`);const a=this.getMainFwdBufferInfo();if(a===null||a.len===0){this.warn(`Main forward buffer length on "seeked" event ${a?a.len:"empty"})`);return}this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(y.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.levels=this.fragPlaying=this.backtrackFragment=null,this.altAudio=this.audioOnly=!1}onManifestParsed(t,n){let a=!1,l=!1,u;n.levels.forEach(c=>{u=c.audioCodec,u&&(u.indexOf("mp4a.40.2")!==-1&&(a=!0),u.indexOf("mp4a.40.5")!==-1&&(l=!0))}),this.audioCodecSwitch=a&&l&&!So(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=n.levels,this.startFragRequested=!1}onLevelLoading(t,n){const{levels:a}=this;if(!a||this.state!==st.IDLE)return;const l=a[n.level];(!l.details||l.details.live&&this.levelLastLoaded!==n.level||this.waitForCdnTuneIn(l.details))&&(this.state=st.WAITING_LEVEL)}onLevelLoaded(t,n){var a;const{levels:l}=this,u=n.level,c=n.details,p=c.totalduration;if(!l){this.warn(`Levels were reset while loading level ${u}`);return}this.log(`Level ${u} loaded [${c.startSN},${c.endSN}]${c.lastPartSn?`[part-${c.lastPartSn}-${c.lastPartIndex}]`:""}, cc [${c.startCC}, ${c.endCC}] duration:${p}`);const v=l[u],A=this.fragCurrent;A&&(this.state===st.FRAG_LOADING||this.state===st.FRAG_LOADING_WAITING_RETRY)&&(A.level!==n.level||A.urlId!==v.urlId)&&A.loader&&this.abortCurrentFrag();let C=0;if(c.live||(a=v.details)!=null&&a.live){if(this.checkLiveUpdate(c),c.deltaUpdateFailed)return;C=this.alignPlaylists(c,v.details)}if(v.details=c,this.levelLastLoaded=u,this.hls.trigger(y.LEVEL_UPDATED,{details:c,level:u}),this.state===st.WAITING_LEVEL){if(this.waitForCdnTuneIn(c))return;this.state=st.IDLE}this.startFragRequested?c.live&&this.synchronizeToLiveEdge(c):this.setStartPosition(c,C),this.tick()}_handleFragmentLoadProgress(t){var n;const{frag:a,part:l,payload:u}=t,{levels:c}=this;if(!c){this.warn(`Levels were reset while fragment load was in progress. Fragment ${a.sn} of level ${a.level} will not be buffered`);return}const p=c[a.level],v=p.details;if(!v){this.warn(`Dropping fragment ${a.sn} of level ${a.level} after level details were reset`),this.fragmentTracker.removeFragment(a);return}const A=p.videoCodec,C=v.PTSKnown||!v.live,O=(n=a.initSegment)==null?void 0:n.data,U=this._getAudioCodec(p),W=this.transmuxer=this.transmuxer||new mu(this.hls,Gt.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),J=l?l.index:-1,oe=J!==-1,he=new $n(a.level,a.sn,a.stats.chunkCount,u.byteLength,J,oe),we=this.initPTS[a.cc];W.push(u,O,U,A,a,l,v.totalduration,C,he,we)}onAudioTrackSwitching(t,n){const a=this.altAudio;if(!!!n.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const c=this.fragCurrent;c&&(this.log("Switching to main audio track, cancel main fragment load"),c.abortRequests(),this.fragmentTracker.removeFragment(c)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const u=this.hls;a&&(u.trigger(y.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),u.trigger(y.AUDIO_TRACK_SWITCHED,n)}}onAudioTrackSwitched(t,n){const a=n.id,l=!!this.hls.audioTracks[a].url;if(l){const u=this.videoBuffer;u&&this.mediaBuffer!==u&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=u)}this.altAudio=l,this.tick()}onBufferCreated(t,n){const a=n.tracks;let l,u,c=!1;for(const p in a){const v=a[p];if(v.id==="main"){if(u=p,l=v,p==="video"){const A=a[p];A&&(this.videoBuffer=A.buffer)}}else c=!0}c&&l?(this.log(`Alternate track found, use ${u}.buffered to schedule main fragment loading`),this.mediaBuffer=l.buffer):this.mediaBuffer=this.media}onFragBuffered(t,n){const{frag:a,part:l}=n;if(a&&a.type!==Gt.MAIN)return;if(this.fragContextChanged(a)){this.warn(`Fragment ${a.sn}${l?" p: "+l.index:""} of level ${a.level} finished buffering, but was aborted. state: ${this.state}`),this.state===st.PARSED&&(this.state=st.IDLE);return}const u=l?l.stats:a.stats;this.fragLastKbps=Math.round(8*u.total/(u.buffering.end-u.loading.first)),a.sn!=="initSegment"&&(this.fragPrevious=a),this.fragBufferedComplete(a,l)}onError(t,n){var a;if(n.fatal){this.state=st.ERROR;return}switch(n.details){case D.FRAG_GAP:case D.FRAG_PARSING_ERROR:case D.FRAG_DECRYPT_ERROR:case D.FRAG_LOAD_ERROR:case D.FRAG_LOAD_TIMEOUT:case D.KEY_LOAD_ERROR:case D.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Gt.MAIN,n);break;case D.LEVEL_LOAD_ERROR:case D.LEVEL_LOAD_TIMEOUT:case D.LEVEL_PARSING_ERROR:!n.levelRetry&&this.state===st.WAITING_LEVEL&&((a=n.context)==null?void 0:a.type)===ui.LEVEL&&(this.state=st.IDLE);break;case D.BUFFER_FULL_ERROR:if(!n.parent||n.parent!=="main")return;this.reduceLengthAndFlushBuffer(n)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case D.INTERNAL_EXCEPTION:this.recoverWorkerError(n);break}}checkBuffer(){const{media:t,gapController:n}=this;if(!(!t||!n||!t.readyState)){if(this.loadedmetadata||!ni.getBuffered(t).length){const a=this.state!==st.IDLE?this.fragCurrent:null;n.poll(this.lastCurrentTime,a)}this.lastCurrentTime=t.currentTime}}onFragLoadEmergencyAborted(){this.state=st.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(t,{type:n}){if(n!==ve.AUDIO||this.audioOnly&&!this.altAudio){const a=(n===ve.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(a,n,Gt.MAIN)}}onLevelsUpdated(t,n){this.levels=n.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:t}=this;if(!t)return;const n=t.currentTime;let a=this.startPosition;if(a>=0&&n<a){if(t.seeking){this.log(`could not seek to ${a}, already seeking at ${n}`);return}const l=ni.getBuffered(t),c=(l.length?l.start(0):0)-a;c>0&&(c<this.config.maxBufferHole||c<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${c} to match buffer start`),a+=c,this.startPosition=a),this.log(`seek to target start position ${a} from current time ${n}`),t.currentTime=a}}_getAudioCodec(t){let n=this.config.defaultAudioCodec||t.audioCodec;return this.audioCodecSwap&&n&&(this.log("Swapping audio codec"),n.indexOf("mp4a.40.5")!==-1?n="mp4a.40.2":n="mp4a.40.5"),n}_loadBitrateTestFrag(t,n){t.bitrateTest=!0,this._doFragLoad(t,n).then(a=>{const{hls:l}=this;if(!a||this.fragContextChanged(t))return;n.fragmentError=0,this.state=st.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const u=t.stats;u.parsing.start=u.parsing.end=u.buffering.start=u.buffering.end=self.performance.now(),l.trigger(y.FRAG_LOADED,a),t.bitrateTest=!1})}_handleTransmuxComplete(t){var n;const a="main",{hls:l}=this,{remuxResult:u,chunkMeta:c}=t,p=this.getCurrentContext(c);if(!p){this.resetWhenMissingContext(c);return}const{frag:v,part:A,level:C}=p,{video:O,text:U,id3:W,initSegment:J}=u,{details:oe}=C,he=this.altAudio?void 0:u.audio;if(this.fragContextChanged(v)){this.fragmentTracker.removeFragment(v);return}if(this.state=st.PARSING,J){if(J!=null&&J.tracks){const Me=v.initSegment||v;this._bufferInitSegment(C,J.tracks,Me,c),l.trigger(y.FRAG_PARSING_INIT_SEGMENT,{frag:Me,id:a,tracks:J.tracks})}const we=J.initPTS,Fe=J.timescale;te(we)&&(this.initPTS[v.cc]={baseTime:we,timescale:Fe},l.trigger(y.INIT_PTS_FOUND,{frag:v,id:a,initPTS:we,timescale:Fe}))}if(O&&oe&&v.sn!=="initSegment"){const we=oe.fragments[v.sn-1-oe.startSN],Fe=v.sn===oe.startSN,Me=!we||v.cc>we.cc;if(u.independent!==!1){const{startPTS:it,endPTS:We,startDTS:St,endDTS:ut}=O;if(A)A.elementaryStreams[O.type]={startPTS:it,endPTS:We,startDTS:St,endDTS:ut};else if(O.firstKeyFrame&&O.independent&&c.id===1&&!Me&&(this.couldBacktrack=!0),O.dropped&&O.independent){const gt=this.getMainFwdBufferInfo(),Ct=(gt?gt.end:this.getLoadPosition())+this.config.maxBufferHole,rt=O.firstKeyFramePTS?O.firstKeyFramePTS:it;if(!Fe&&Ct<rt-this.config.maxBufferHole&&!Me){this.backtrack(v);return}else Me&&(v.gap=!0);v.setElementaryStreamInfo(O.type,v.start,We,v.start,ut,!0)}v.setElementaryStreamInfo(O.type,it,We,St,ut),this.backtrackFragment&&(this.backtrackFragment=v),this.bufferFragmentData(O,v,A,c,Fe||Me)}else if(Fe||Me)v.gap=!0;else{this.backtrack(v);return}}if(he){const{startPTS:we,endPTS:Fe,startDTS:Me,endDTS:it}=he;A&&(A.elementaryStreams[ve.AUDIO]={startPTS:we,endPTS:Fe,startDTS:Me,endDTS:it}),v.setElementaryStreamInfo(ve.AUDIO,we,Fe,Me,it),this.bufferFragmentData(he,v,A,c)}if(oe&&W!=null&&(n=W.samples)!=null&&n.length){const we={id:a,frag:v,details:oe,samples:W.samples};l.trigger(y.FRAG_PARSING_METADATA,we)}if(oe&&U){const we={id:a,frag:v,details:oe,samples:U.samples};l.trigger(y.FRAG_PARSING_USERDATA,we)}}_bufferInitSegment(t,n,a,l){if(this.state!==st.PARSING)return;this.audioOnly=!!n.audio&&!n.video,this.altAudio&&!this.audioOnly&&delete n.audio;const{audio:u,video:c,audiovideo:p}=n;if(u){let v=t.audioCodec;const A=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(v&&(v.indexOf("mp4a.40.5")!==-1?v="mp4a.40.2":v="mp4a.40.5"),u.metadata.channelCount!==1&&A.indexOf("firefox")===-1&&(v="mp4a.40.5")),A.indexOf("android")!==-1&&u.container!=="audio/mpeg"&&(v="mp4a.40.2",this.log(`Android: force audio codec to ${v}`)),t.audioCodec&&t.audioCodec!==v&&this.log(`Swapping manifest audio codec "${t.audioCodec}" for "${v}"`),u.levelCodec=v,u.id="main",this.log(`Init audio buffer, container:${u.container}, codecs[selected/level/parsed]=[${v||""}/${t.audioCodec||""}/${u.codec}]`)}c&&(c.levelCodec=t.videoCodec,c.id="main",this.log(`Init video buffer, container:${c.container}, codecs[level/parsed]=[${t.videoCodec||""}/${c.codec}]`)),p&&this.log(`Init audiovideo buffer, container:${p.container}, codecs[level/parsed]=[${t.attrs.CODECS||""}/${p.codec}]`),this.hls.trigger(y.BUFFER_CODECS,n),Object.keys(n).forEach(v=>{const C=n[v].initSegment;C!=null&&C.byteLength&&this.hls.trigger(y.BUFFER_APPENDING,{type:v,data:C,frag:a,part:null,chunkMeta:l,parent:a.type})}),this.tick()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,Gt.MAIN)}backtrack(t){this.couldBacktrack=!0,this.backtrackFragment=t,this.resetTransmuxer(),this.flushBufferGap(t),this.fragmentTracker.removeFragment(t),this.fragPrevious=null,this.nextLoadPosition=t.start,this.state=st.IDLE}checkFragmentChanged(){const t=this.media;let n=null;if(t&&t.readyState>1&&t.seeking===!1){const a=t.currentTime;if(ni.isBuffered(t,a)?n=this.getAppendedFrag(a):ni.isBuffered(t,a+.1)&&(n=this.getAppendedFrag(a+.1)),n){this.backtrackFragment=null;const l=this.fragPlaying,u=n.level;(!l||n.sn!==l.sn||l.level!==u||n.urlId!==l.urlId)&&(this.fragPlaying=n,this.hls.trigger(y.FRAG_CHANGED,{frag:n}),(!l||l.level!==u)&&this.hls.trigger(y.LEVEL_SWITCHED,{level:u}))}}}get nextLevel(){const t=this.nextBufferedFrag;return t?t.level:-1}get currentFrag(){const t=this.media;return t?this.fragPlaying||this.getAppendedFrag(t.currentTime):null}get currentProgramDateTime(){const t=this.media;if(t){const n=t.currentTime,a=this.currentFrag;if(a&&te(n)&&te(a.programDateTime)){const l=a.programDateTime+(n-a.start)*1e3;return new Date(l)}}return null}get currentLevel(){const t=this.currentFrag;return t?t.level:-1}get nextBufferedFrag(){const t=this.currentFrag;return t?this.followingBufferedFrag(t):null}get forceStartLoad(){return this._forceStartLoad}}class gi{constructor(t,n=0,a=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=t,this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=n,this.totalWeight_=a}sample(t,n){const a=Math.pow(this.alpha_,t);this.estimate_=n*(1-a)+a*this.estimate_,this.totalWeight_+=t}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const t=1-Math.pow(this.alpha_,this.totalWeight_);if(t)return this.estimate_/t}return this.estimate_}}class Ur{constructor(t,n,a,l=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=a,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new gi(t),this.fast_=new gi(n),this.defaultTTFB_=l,this.ttfb_=new gi(t)}update(t,n){const{slow_:a,fast_:l,ttfb_:u}=this;a.halfLife!==t&&(this.slow_=new gi(t,a.getEstimate(),a.getTotalWeight())),l.halfLife!==n&&(this.fast_=new gi(n,l.getEstimate(),l.getTotalWeight())),u.halfLife!==t&&(this.ttfb_=new gi(t,u.getEstimate(),u.getTotalWeight()))}sample(t,n){t=Math.max(t,this.minDelayMs_);const a=8*n,l=t/1e3,u=a/l;this.fast_.sample(l,u),this.slow_.sample(l,u)}sampleTTFB(t){const n=t/1e3,a=Math.sqrt(2)*Math.exp(-Math.pow(n,2)/2);this.ttfb_.sample(a,Math.max(t,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}class gu{constructor(t){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=-1,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=t;const n=t.config;this.bwEstimator=new Ur(n.abrEwmaSlowVoD,n.abrEwmaFastVoD,n.abrEwmaDefaultEstimate),this.registerListeners()}registerListeners(){const{hls:t}=this;t.on(y.FRAG_LOADING,this.onFragLoading,this),t.on(y.FRAG_LOADED,this.onFragLoaded,this),t.on(y.FRAG_BUFFERED,this.onFragBuffered,this),t.on(y.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(y.LEVEL_LOADED,this.onLevelLoaded,this)}unregisterListeners(){const{hls:t}=this;t.off(y.FRAG_LOADING,this.onFragLoading,this),t.off(y.FRAG_LOADED,this.onFragLoaded,this),t.off(y.FRAG_BUFFERED,this.onFragBuffered,this),t.off(y.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(y.LEVEL_LOADED,this.onLevelLoaded,this)}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null}onFragLoading(t,n){var a;const l=n.frag;this.ignoreFragment(l)||(this.fragCurrent=l,this.partCurrent=(a=n.part)!=null?a:null,this.clearTimer(),this.timer=self.setInterval(this.onCheck,100))}onLevelSwitching(t,n){this.clearTimer()}getTimeToLoadFrag(t,n,a,l){const u=t+a/n,c=l?this.lastLevelLoadSec:0;return u+c}onLevelLoaded(t,n){const a=this.hls.config,{total:l,bwEstimate:u}=n.stats;te(l)&&te(u)&&(this.lastLevelLoadSec=8*l/u),n.details.live?this.bwEstimator.update(a.abrEwmaSlowLive,a.abrEwmaFastLive):this.bwEstimator.update(a.abrEwmaSlowVoD,a.abrEwmaFastVoD)}_abandonRulesCheck(){const{fragCurrent:t,partCurrent:n,hls:a}=this,{autoLevelEnabled:l,media:u}=a;if(!t||!u)return;const c=performance.now(),p=n?n.stats:t.stats,v=n?n.duration:t.duration,A=c-p.loading.start;if(p.aborted||p.loaded&&p.loaded===p.total||t.level===0){this.clearTimer(),this._nextAutoLevel=-1;return}if(!l||u.paused||!u.playbackRate||!u.readyState)return;const C=a.mainForwardBufferInfo;if(C===null)return;const O=this.bwEstimator.getEstimateTTFB(),U=Math.abs(u.playbackRate);if(A<=Math.max(O,1e3*(v/(U*2))))return;const W=C.len/U;if(W>=2*v/U)return;const J=p.loading.first?p.loading.first-p.loading.start:-1,oe=p.loaded&&J>-1,he=this.bwEstimator.getEstimate(),{levels:we,minAutoLevel:Fe}=a,Me=we[t.level],it=p.total||Math.max(p.loaded,Math.round(v*Me.maxBitrate/8));let We=A-J;We<1&&oe&&(We=Math.min(A,p.loaded*8/he));const St=oe?p.loaded*1e3/We:0,ut=St?(it-p.loaded)/St:it*8/he+O/1e3;if(ut<=W)return;const gt=St?St*8:he;let Ct=Number.POSITIVE_INFINITY,rt;for(rt=t.level-1;rt>Fe;rt--){const qt=we[rt].maxBitrate;if(Ct=this.getTimeToLoadFrag(O/1e3,gt,v*qt,!we[rt].details),Ct<W)break}Ct>=ut||Ct>v*10||(a.nextLoadLevel=rt,oe?this.bwEstimator.sample(A-Math.min(O,J),p.loaded):this.bwEstimator.sampleTTFB(A),this.clearTimer(),T.warn(`[abr] Fragment ${t.sn}${n?" part "+n.index:""} of level ${t.level} is loading too slowly;
      Time to underbuffer: ${W.toFixed(3)} s
      Estimated load time for current fragment: ${ut.toFixed(3)} s
      Estimated load time for down switch fragment: ${Ct.toFixed(3)} s
      TTFB estimate: ${J}
      Current BW estimate: ${te(he)?(he/1024).toFixed(3):"Unknown"} Kb/s
      New BW estimate: ${(this.bwEstimator.getEstimate()/1024).toFixed(3)} Kb/s
      Aborting and switching to level ${rt}`),t.loader&&(this.fragCurrent=this.partCurrent=null,t.abortRequests()),a.trigger(y.FRAG_LOAD_EMERGENCY_ABORTED,{frag:t,part:n,stats:p}))}onFragLoaded(t,{frag:n,part:a}){const l=a?a.stats:n.stats;if(n.type===Gt.MAIN&&this.bwEstimator.sampleTTFB(l.loading.first-l.loading.start),!this.ignoreFragment(n)){if(this.clearTimer(),this.lastLoadedFragLevel=n.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){const u=a?a.duration:n.duration,c=this.hls.levels[n.level],p=(c.loaded?c.loaded.bytes:0)+l.loaded,v=(c.loaded?c.loaded.duration:0)+u;c.loaded={bytes:p,duration:v},c.realBitrate=Math.round(8*p/v)}if(n.bitrateTest){const u={stats:l,frag:n,part:a,id:n.type};this.onFragBuffered(y.FRAG_BUFFERED,u),n.bitrateTest=!1}}}onFragBuffered(t,n){const{frag:a,part:l}=n,u=l!=null&&l.stats.loaded?l.stats:a.stats;if(u.aborted||this.ignoreFragment(a))return;const c=u.parsing.end-u.loading.start-Math.min(u.loading.first-u.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(c,u.loaded),u.bwEstimate=this.bwEstimator.getEstimate(),a.bitrateTest?this.bitrateTestDelay=c/1e3:this.bitrateTestDelay=0}ignoreFragment(t){return t.type!==Gt.MAIN||t.sn==="initSegment"}clearTimer(){self.clearInterval(this.timer)}get nextAutoLevel(){const t=this._nextAutoLevel,n=this.bwEstimator;if(t!==-1&&!n.canEstimate())return t;let a=this.getNextABRAutoLevel();if(t!==-1){const l=this.hls.levels;if(l.length>Math.max(t,a)&&l[t].loadError<=l[a].loadError)return t}return t!==-1&&(a=Math.min(t,a)),a}getNextABRAutoLevel(){const{fragCurrent:t,partCurrent:n,hls:a}=this,{maxAutoLevel:l,config:u,minAutoLevel:c,media:p}=a,v=n?n.duration:t?t.duration:0,A=p&&p.playbackRate!==0?Math.abs(p.playbackRate):1,C=this.bwEstimator?this.bwEstimator.getEstimate():u.abrEwmaDefaultEstimate,O=a.mainForwardBufferInfo,U=(O?O.len:0)/A;let W=this.findBestLevel(C,c,l,U,u.abrBandWidthFactor,u.abrBandWidthUpFactor);if(W>=0)return W;T.trace(`[abr] ${U?"rebuffering expected":"buffer is empty"}, finding optimal quality level`);let J=v?Math.min(v,u.maxStarvationDelay):u.maxStarvationDelay,oe=u.abrBandWidthFactor,he=u.abrBandWidthUpFactor;if(!U){const we=this.bitrateTestDelay;we&&(J=(v?Math.min(v,u.maxLoadingDelay):u.maxLoadingDelay)-we,T.trace(`[abr] bitrate test took ${Math.round(1e3*we)}ms, set first fragment max fetchDuration to ${Math.round(1e3*J)} ms`),oe=he=1)}return W=this.findBestLevel(C,c,l,U+J,oe,he),Math.max(W,0)}findBestLevel(t,n,a,l,u,c){var p;const{fragCurrent:v,partCurrent:A,lastLoadedFragLevel:C}=this,{levels:O}=this.hls,U=O[C],W=!!(U!=null&&(p=U.details)!=null&&p.live),J=U==null?void 0:U.codecSet,oe=A?A.duration:v?v.duration:0,he=this.bwEstimator.getEstimateTTFB()/1e3;let we=n,Fe=-1;for(let Me=a;Me>=n;Me--){const it=O[Me];if(!it||J&&it.codecSet!==J){it&&(we=Math.min(Me,we),Fe=Math.max(Me,Fe));continue}Fe!==-1&&T.trace(`[abr] Skipped level(s) ${we}-${Fe} with CODECS:"${O[Fe].attrs.CODECS}"; not compatible with "${U.attrs.CODECS}"`);const We=it.details,St=(A?We==null?void 0:We.partTarget:We==null?void 0:We.averagetargetduration)||oe;let ut;Me<=C?ut=u*t:ut=c*t;const gt=O[Me].maxBitrate,Ct=this.getTimeToLoadFrag(he,ut,gt*St,We===void 0);if(T.trace(`[abr] level:${Me} adjustedbw-bitrate:${Math.round(ut-gt)} avgDuration:${St.toFixed(1)} maxFetchDuration:${l.toFixed(1)} fetchDuration:${Ct.toFixed(1)}`),ut>gt&&(Ct===0||!te(Ct)||W&&!this.bitrateTestDelay||Ct<l))return Me}return-1}set nextAutoLevel(t){this._nextAutoLevel=t}}class yu{constructor(){this.chunks=[],this.dataLength=0}push(t){this.chunks.push(t),this.dataLength+=t.length}flush(){const{chunks:t,dataLength:n}=this;let a;if(t.length)t.length===1?a=t[0]:a=Wa(t,n);else return new Uint8Array(0);return this.reset(),a}reset(){this.chunks.length=0,this.dataLength=0}}function Wa(f,t){const n=new Uint8Array(t);let a=0;for(let l=0;l<f.length;l++){const u=f[l];n.set(u,a),a+=u.length}return n}const Jn=100;class Po extends ri{constructor(t,n,a){super(t,n,a,"[audio-stream-controller]",Gt.AUDIO);this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:t}=this;t.on(y.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(y.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(y.MANIFEST_LOADING,this.onManifestLoading,this),t.on(y.LEVEL_LOADED,this.onLevelLoaded,this),t.on(y.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.on(y.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(y.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(y.ERROR,this.onError,this),t.on(y.BUFFER_RESET,this.onBufferReset,this),t.on(y.BUFFER_CREATED,this.onBufferCreated,this),t.on(y.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(y.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(y.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:t}=this;t.off(y.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(y.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(y.MANIFEST_LOADING,this.onManifestLoading,this),t.off(y.LEVEL_LOADED,this.onLevelLoaded,this),t.off(y.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.off(y.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(y.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(y.ERROR,this.onError,this),t.off(y.BUFFER_RESET,this.onBufferReset,this),t.off(y.BUFFER_CREATED,this.onBufferCreated,this),t.off(y.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(y.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(y.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(t,{frag:n,id:a,initPTS:l,timescale:u}){if(a==="main"){const c=n.cc;this.initPTS[n.cc]={baseTime:l,timescale:u},this.log(`InitPTS for cc: ${c} found from main: ${l}`),this.videoTrackCC=c,this.state===st.WAITING_INIT_PTS&&this.tick()}}startLoad(t){if(!this.levels){this.startPosition=t,this.state=st.STOPPED;return}const n=this.lastCurrentTime;this.stopLoad(),this.setInterval(Jn),n>0&&t===-1?(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),t=n,this.state=st.IDLE):(this.loadedmetadata=!1,this.state=st.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}doTick(){switch(this.state){case st.IDLE:this.doTickIdle();break;case st.WAITING_TRACK:{var t;const{levels:a,trackId:l}=this,u=a==null||(t=a[l])==null?void 0:t.details;if(u){if(this.waitForCdnTuneIn(u))break;this.state=st.WAITING_INIT_PTS}break}case st.FRAG_LOADING_WAITING_RETRY:{var n;const a=performance.now(),l=this.retryDate;(!l||a>=l||(n=this.media)!=null&&n.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=st.IDLE);break}case st.WAITING_INIT_PTS:{const a=this.waitingData;if(a){const{frag:l,part:u,cache:c,complete:p}=a;if(this.initPTS[l.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=st.FRAG_LOADING;const v=c.flush(),A={frag:l,part:u,payload:v,networkDetails:null};this._handleFragmentLoadProgress(A),p&&super._handleFragmentLoadComplete(A)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${l.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const v=this.getLoadPosition(),A=ni.bufferInfo(this.mediaBuffer,v,this.config.maxBufferHole);Dr(A.end,this.config.maxFragLookUpTolerance,l)<0&&(this.log(`Waiting fragment cc (${l.cc}) @ ${l.start} cancelled because another fragment at ${A.end} is needed`),this.clearWaitingFragment())}}else this.state=st.IDLE}}this.onTickEnd()}clearWaitingFragment(){const t=this.waitingData;t&&(this.fragmentTracker.removeFragment(t.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=st.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:t}=this;!(t!=null&&t.readyState)||(this.lastCurrentTime=t.currentTime)}doTickIdle(){const{hls:t,levels:n,media:a,trackId:l}=this,u=t.config;if(!(n!=null&&n[l])||!a&&(this.startFragRequested||!u.startFragPrefetch))return;const c=n[l],p=c.details;if(!p||p.live&&this.levelLastLoaded!==l||this.waitForCdnTuneIn(p)){this.state=st.WAITING_TRACK;return}const v=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&v&&(this.bufferFlushed=!1,this.afterBufferFlushed(v,ve.AUDIO,Gt.AUDIO));const A=this.getFwdBufferInfo(v,Gt.AUDIO);if(A===null)return;const{bufferedTrack:C,switchingTrack:O}=this;if(!O&&this._streamEnded(A,p)){t.trigger(y.BUFFER_EOS,{type:"audio"}),this.state=st.ENDED;return}const U=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,Gt.MAIN),W=A.len,J=this.getMaxBufferLength(U==null?void 0:U.len);if(W>=J&&!O)return;const he=p.fragments[0].start;let we=A.end;if(O&&a){const We=this.getLoadPosition();C&&O.attrs!==C.attrs&&(we=We),p.PTSKnown&&We<he&&(A.end>he||A.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),a.currentTime=he+.05)}let Fe=this.getNextFragment(we,p),Me=!1;if(Fe&&this.isLoopLoading(Fe,we)&&(Me=!!Fe.gap,Fe=this.getNextFragmentLoopLoading(Fe,p,A,Gt.MAIN,J)),!Fe){this.bufferFlushed=!0;return}const it=U&&Fe.start>U.end+p.targetduration;if(it||!(U!=null&&U.len)&&A.len){const We=this.getAppendedFrag(Fe.start,Gt.MAIN);if(We===null||(Me||(Me=!!We.gap||!!it&&U.len===0),it&&!Me||Me&&A.nextStart&&A.nextStart<We.end))return}this.loadFragment(Fe,c,we)}getMaxBufferLength(t){const n=super.getMaxBufferLength();return t?Math.min(Math.max(n,t),this.config.maxMaxBufferLength):n}onMediaDetaching(){this.videoBuffer=null,super.onMediaDetaching()}onAudioTracksUpdated(t,{audioTracks:n}){this.resetTransmuxer(),this.levels=n.map(a=>new Ms(a))}onAudioTrackSwitching(t,n){const a=!!n.url;this.trackId=n.id;const{fragCurrent:l}=this;l&&(l.abortRequests(),this.removeUnbufferedFrags(l.start)),this.resetLoadingState(),a?this.setInterval(Jn):this.resetTransmuxer(),a?(this.switchingTrack=n,this.state=st.IDLE):(this.switchingTrack=null,this.bufferedTrack=n,this.state=st.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(t,n){this.mainDetails=n.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(y.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(t,n){var a;if(this.mainDetails==null){this.cachedTrackLoadedData=n;return}const{levels:l}=this,{details:u,id:c}=n;if(!l){this.warn(`Audio tracks were reset while loading level ${c}`);return}this.log(`Track ${c} loaded [${u.startSN},${u.endSN}]${u.lastPartSn?`[part-${u.lastPartSn}-${u.lastPartIndex}]`:""},duration:${u.totalduration}`);const p=l[c];let v=0;if(u.live||(a=p.details)!=null&&a.live){this.checkLiveUpdate(u);const A=this.mainDetails;if(u.deltaUpdateFailed||!A)return;!p.details&&u.hasProgramDateTime&&A.hasProgramDateTime?(Va(u,A),v=u.fragments[0].start):v=this.alignPlaylists(u,p.details)}p.details=u,this.levelLastLoaded=c,!this.startFragRequested&&(this.mainDetails||!u.live)&&this.setStartPosition(p.details,v),this.state===st.WAITING_TRACK&&!this.waitForCdnTuneIn(u)&&(this.state=st.IDLE),this.tick()}_handleFragmentLoadProgress(t){var n;const{frag:a,part:l,payload:u}=t,{config:c,trackId:p,levels:v}=this;if(!v){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${a.sn} of level ${a.level} will not be buffered`);return}const A=v[p];if(!A){this.warn("Audio track is undefined on fragment load progress");return}const C=A.details;if(!C){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(a.start);return}const O=c.defaultAudioCodec||A.audioCodec||"mp4a.40.2";let U=this.transmuxer;U||(U=this.transmuxer=new mu(this.hls,Gt.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const W=this.initPTS[a.cc],J=(n=a.initSegment)==null?void 0:n.data;if(W!==void 0){const oe=!1,he=l?l.index:-1,we=he!==-1,Fe=new $n(a.level,a.sn,a.stats.chunkCount,u.byteLength,he,we);U.push(u,J,O,"",a,l,C.totalduration,oe,Fe,W)}else{this.log(`Unknown video PTS for cc ${a.cc}, waiting for video PTS before demuxing audio frag ${a.sn} of [${C.startSN} ,${C.endSN}],track ${p}`);const{cache:oe}=this.waitingData=this.waitingData||{frag:a,part:l,cache:new yu,complete:!1};oe.push(new Uint8Array(u)),this.waitingVideoCC=this.videoTrackCC,this.state=st.WAITING_INIT_PTS}}_handleFragmentLoadComplete(t){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(t)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(t,n){const a=n.tracks.audio;a&&(this.mediaBuffer=a.buffer||null),n.tracks.video&&(this.videoBuffer=n.tracks.video.buffer||null)}onFragBuffered(t,n){const{frag:a,part:l}=n;if(a.type!==Gt.AUDIO){if(!this.loadedmetadata&&a.type===Gt.MAIN){const u=this.videoBuffer||this.media;u&&ni.getBuffered(u).length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(a)){this.warn(`Fragment ${a.sn}${l?" p: "+l.index:""} of level ${a.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(a.sn!=="initSegment"){this.fragPrevious=a;const u=this.switchingTrack;u&&(this.bufferedTrack=u,this.switchingTrack=null,this.hls.trigger(y.AUDIO_TRACK_SWITCHED,tt({},u)))}this.fragBufferedComplete(a,l)}onError(t,n){var a;if(n.fatal){this.state=st.ERROR;return}switch(n.details){case D.FRAG_GAP:case D.FRAG_PARSING_ERROR:case D.FRAG_DECRYPT_ERROR:case D.FRAG_LOAD_ERROR:case D.FRAG_LOAD_TIMEOUT:case D.KEY_LOAD_ERROR:case D.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Gt.AUDIO,n);break;case D.AUDIO_TRACK_LOAD_ERROR:case D.AUDIO_TRACK_LOAD_TIMEOUT:case D.LEVEL_PARSING_ERROR:!n.levelRetry&&this.state===st.WAITING_TRACK&&((a=n.context)==null?void 0:a.type)===ui.AUDIO_TRACK&&(this.state=st.IDLE);break;case D.BUFFER_FULL_ERROR:if(!n.parent||n.parent!=="audio")return;this.reduceLengthAndFlushBuffer(n)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case D.INTERNAL_EXCEPTION:this.recoverWorkerError(n);break}}onBufferFlushed(t,{type:n}){n===ve.AUDIO&&(this.bufferFlushed=!0,this.state===st.ENDED&&(this.state=st.IDLE))}_handleTransmuxComplete(t){var n;const a="audio",{hls:l}=this,{remuxResult:u,chunkMeta:c}=t,p=this.getCurrentContext(c);if(!p){this.resetWhenMissingContext(c);return}const{frag:v,part:A,level:C}=p,{details:O}=C,{audio:U,text:W,id3:J,initSegment:oe}=u;if(this.fragContextChanged(v)||!O){this.fragmentTracker.removeFragment(v);return}if(this.state=st.PARSING,this.switchingTrack&&U&&this.completeAudioSwitch(this.switchingTrack),oe!=null&&oe.tracks){const he=v.initSegment||v;this._bufferInitSegment(oe.tracks,he,c),l.trigger(y.FRAG_PARSING_INIT_SEGMENT,{frag:he,id:a,tracks:oe.tracks})}if(U){const{startPTS:he,endPTS:we,startDTS:Fe,endDTS:Me}=U;A&&(A.elementaryStreams[ve.AUDIO]={startPTS:he,endPTS:we,startDTS:Fe,endDTS:Me}),v.setElementaryStreamInfo(ve.AUDIO,he,we,Fe,Me),this.bufferFragmentData(U,v,A,c)}if(J!=null&&(n=J.samples)!=null&&n.length){const he=Ee({id:a,frag:v,details:O},J);l.trigger(y.FRAG_PARSING_METADATA,he)}if(W){const he=Ee({id:a,frag:v,details:O},W);l.trigger(y.FRAG_PARSING_USERDATA,he)}}_bufferInitSegment(t,n,a){if(this.state!==st.PARSING)return;t.video&&delete t.video;const l=t.audio;if(!l)return;l.levelCodec=l.codec,l.id="audio",this.log(`Init audio buffer, container:${l.container}, codecs[parsed]=[${l.codec}]`),this.hls.trigger(y.BUFFER_CODECS,t);const u=l.initSegment;if(u!=null&&u.byteLength){const c={type:"audio",frag:n,part:null,chunkMeta:a,parent:n.type,data:u};this.hls.trigger(y.BUFFER_APPENDING,c)}this.tick()}loadFragment(t,n,a){const l=this.fragmentTracker.getState(t);if(this.fragCurrent=t,this.switchingTrack||l===ei.NOT_LOADED||l===ei.PARTIAL){var u;t.sn==="initSegment"?this._loadInitSegment(t,n):(u=n.details)!=null&&u.live&&!this.initPTS[t.cc]?(this.log(`Waiting for video PTS in continuity counter ${t.cc} of live stream before loading audio fragment ${t.sn} of level ${this.trackId}`),this.state=st.WAITING_INIT_PTS):(this.startFragRequested=!0,super.loadFragment(t,n,a))}else this.clearTrackerIfNeeded(t)}completeAudioSwitch(t){const{hls:n,media:a,bufferedTrack:l}=this,u=l==null?void 0:l.attrs,c=t.attrs;a&&u&&(u.CHANNELS!==c.CHANNELS||u.NAME!==c.NAME||u.LANGUAGE!==c.LANGUAGE)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio")),this.bufferedTrack=t,this.switchingTrack=null,n.trigger(y.AUDIO_TRACK_SWITCHED,tt({},t))}}class ss extends ja{constructor(t){super(t,"[audio-track-controller]");this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:t}=this;t.on(y.MANIFEST_LOADING,this.onManifestLoading,this),t.on(y.MANIFEST_PARSED,this.onManifestParsed,this),t.on(y.LEVEL_LOADING,this.onLevelLoading,this),t.on(y.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(y.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(y.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(y.MANIFEST_LOADING,this.onManifestLoading,this),t.off(y.MANIFEST_PARSED,this.onManifestParsed,this),t.off(y.LEVEL_LOADING,this.onLevelLoading,this),t.off(y.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(y.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(y.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(t,n){this.tracks=n.audioTracks||[]}onAudioTrackLoaded(t,n){const{id:a,groupId:l,details:u}=n,c=this.tracksInGroup[a];if(!c||c.groupId!==l){this.warn(`Track with id:${a} and group:${l} not found in active group ${c.groupId}`);return}const p=c.details;c.details=n.details,this.log(`audio-track ${a} "${c.name}" lang:${c.lang} group:${l} loaded [${u.startSN}-${u.endSN}]`),a===this.trackId&&this.playlistLoaded(a,n,p)}onLevelLoading(t,n){this.switchLevel(n.level)}onLevelSwitching(t,n){this.switchLevel(n.level)}switchLevel(t){const n=this.hls.levels[t];if(!(n!=null&&n.audioGroupIds))return;const a=n.audioGroupIds[n.urlId];if(this.groupId!==a){this.groupId=a||null;const l=this.tracks.filter(c=>!a||c.groupId===a);this.selectDefaultTrack&&!l.some(c=>c.default)&&(this.selectDefaultTrack=!1),this.tracksInGroup=l;const u={audioTracks:l};this.log(`Updating audio tracks, ${l.length} track(s) found in group:${a}`),this.hls.trigger(y.AUDIO_TRACKS_UPDATED,u),this.selectInitialTrack()}else this.shouldReloadPlaylist(this.currentTrack)&&this.setAudioTrack(this.trackId)}onError(t,n){n.fatal||!n.context||n.context.type===ui.AUDIO_TRACK&&n.context.id===this.trackId&&n.context.groupId===this.groupId&&(this.requestScheduled=-1,this.checkRetry(n))}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(t){this.selectDefaultTrack=!1,this.setAudioTrack(t)}setAudioTrack(t){const n=this.tracksInGroup;if(t<0||t>=n.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();const a=this.currentTrack;n[this.trackId];const l=n[t],{groupId:u,name:c}=l;if(this.log(`Switching to audio-track ${t} "${c}" lang:${l.lang} group:${u}`),this.trackId=t,this.currentTrack=l,this.selectDefaultTrack=!1,this.hls.trigger(y.AUDIO_TRACK_SWITCHING,tt({},l)),l.details&&!l.details.live)return;const p=this.switchParams(l.url,a==null?void 0:a.details);this.loadPlaylist(p)}selectInitialTrack(){const t=this.tracksInGroup,n=this.findTrackId(this.currentTrack)|this.findTrackId(null);if(n!==-1)this.setAudioTrack(n);else{const a=new Error(`No track found for running audio group-ID: ${this.groupId} track count: ${t.length}`);this.warn(a.message),this.hls.trigger(y.ERROR,{type:$.MEDIA_ERROR,details:D.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:a})}}findTrackId(t){const n=this.tracksInGroup;for(let a=0;a<n.length;a++){const l=n[a];if((!this.selectDefaultTrack||l.default)&&(!t||t.attrs["STABLE-RENDITION-ID"]!==void 0&&t.attrs["STABLE-RENDITION-ID"]===l.attrs["STABLE-RENDITION-ID"]||t.name===l.name&&t.lang===l.lang))return l.id}return-1}loadPlaylist(t){super.loadPlaylist();const n=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(n)){const a=n.id,l=n.groupId;let u=n.url;if(t)try{u=t.addDirectives(u)}catch(c){this.warn(`Could not construct new URL with HLS Delivery Directives: ${c}`)}this.log(`loading audio-track playlist ${a} "${n.name}" lang:${n.lang} group:${l}`),this.clearTimer(),this.hls.trigger(y.AUDIO_TRACK_LOADING,{url:u,id:a,groupId:l,deliveryDirectives:t||null})}}}function vu(f,t){if(f.length!==t.length)return!1;for(let n=0;n<f.length;n++)if(!Ll(f[n].attrs,t[n].attrs))return!1;return!0}function Ll(f,t){const n=f["STABLE-RENDITION-ID"];return n?n===t["STABLE-RENDITION-ID"]:!["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED"].some(a=>f[a]!==t[a])}const Ka=500;class Au extends ri{constructor(t,n,a){super(t,n,a,"[subtitle-stream-controller]",Gt.SUBTITLE);this.levels=[],this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null}_registerListeners(){const{hls:t}=this;t.on(y.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(y.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(y.MANIFEST_LOADING,this.onManifestLoading,this),t.on(y.LEVEL_LOADED,this.onLevelLoaded,this),t.on(y.ERROR,this.onError,this),t.on(y.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(y.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.on(y.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(y.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.on(y.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(y.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:t}=this;t.off(y.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(y.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(y.MANIFEST_LOADING,this.onManifestLoading,this),t.off(y.LEVEL_LOADED,this.onLevelLoaded,this),t.off(y.ERROR,this.onError,this),t.off(y.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(y.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.off(y.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(y.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.off(y.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(y.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(t){this.stopLoad(),this.state=st.IDLE,this.setInterval(Ka),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(t,n){this.mainDetails=n.details}onSubtitleFragProcessed(t,n){const{frag:a,success:l}=n;if(this.fragPrevious=a,this.state=st.IDLE,!l)return;const u=this.tracksBuffered[this.currentTrackId];if(!u)return;let c;const p=a.start;for(let A=0;A<u.length;A++)if(p>=u[A].start&&p<=u[A].end){c=u[A];break}const v=a.start+a.duration;c?c.end=v:(c={start:p,end:v},u.push(c)),this.fragmentTracker.fragBuffered(a)}onBufferFlushing(t,n){const{startOffset:a,endOffset:l}=n;if(a===0&&l!==Number.POSITIVE_INFINITY){const u=l-1;if(u<=0)return;n.endOffsetSubtitles=Math.max(0,u),this.tracksBuffered.forEach(c=>{for(let p=0;p<c.length;){if(c[p].end<=u){c.shift();continue}else if(c[p].start<u)c[p].start=u;else break;p++}}),this.fragmentTracker.removeFragmentsInRange(a,u,Gt.SUBTITLE)}}onFragBuffered(t,n){if(!this.loadedmetadata&&n.frag.type===Gt.MAIN){var a;(a=this.media)!=null&&a.buffered.length&&(this.loadedmetadata=!0)}}onError(t,n){const a=n.frag;(a==null?void 0:a.type)===Gt.SUBTITLE&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==st.STOPPED&&(this.state=st.IDLE))}onSubtitleTracksUpdated(t,{subtitleTracks:n}){if(vu(this.levels,n)){this.levels=n.map(a=>new Ms(a));return}this.tracksBuffered=[],this.levels=n.map(a=>{const l=new Ms(a);return this.tracksBuffered[l.id]=[],l}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Gt.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(t,n){if(this.currentTrackId=n.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}const a=this.levels[this.currentTrackId];a!=null&&a.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,a&&this.setInterval(Ka)}onSubtitleTrackLoaded(t,n){var a;const{details:l,id:u}=n,{currentTrackId:c,levels:p}=this;if(!p.length)return;const v=p[c];if(u>=p.length||u!==c||!v)return;this.mediaBuffer=this.mediaBufferTimeRanges;let A=0;if(l.live||(a=v.details)!=null&&a.live){const C=this.mainDetails;if(l.deltaUpdateFailed||!C)return;const O=C.fragments[0];v.details?(A=this.alignPlaylists(l,v.details),A===0&&O&&(A=O.start,Ma(l,A))):l.hasProgramDateTime&&C.hasProgramDateTime?(Va(l,C),A=l.fragments[0].start):O&&(A=O.start,Ma(l,A))}v.details=l,this.levelLastLoaded=u,!this.startFragRequested&&(this.mainDetails||!l.live)&&this.setStartPosition(v.details,A),this.tick(),l.live&&!this.fragCurrent&&this.media&&this.state===st.IDLE&&(tn(null,l.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),v.details=void 0))}_handleFragmentLoadComplete(t){const{frag:n,payload:a}=t,l=n.decryptdata,u=this.hls;if(!this.fragContextChanged(n)&&a&&a.byteLength>0&&l&&l.key&&l.iv&&l.method==="AES-128"){const c=performance.now();this.decrypter.decrypt(new Uint8Array(a),l.key.buffer,l.iv.buffer).catch(p=>{throw u.trigger(y.ERROR,{type:$.MEDIA_ERROR,details:D.FRAG_DECRYPT_ERROR,fatal:!1,error:p,reason:p.message,frag:n}),p}).then(p=>{const v=performance.now();u.trigger(y.FRAG_DECRYPTED,{frag:n,payload:p,stats:{tstart:c,tdecrypt:v}})}).catch(p=>{this.warn(`${p.name}: ${p.message}`),this.state=st.IDLE})}}doTick(){if(!this.media){this.state=st.IDLE;return}if(this.state===st.IDLE){const{currentTrackId:t,levels:n}=this,a=n[t];if(!n.length||!a||!a.details)return;const{config:l}=this,u=this.getLoadPosition(),c=ni.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],u,l.maxBufferHole),{end:p,len:v}=c,A=this.getFwdBufferInfo(this.media,Gt.MAIN),C=a.details,O=this.getMaxBufferLength(A==null?void 0:A.len)+C.levelTargetDuration;if(v>O)return;const U=C.fragments,W=U.length,J=C.edge;let oe=null;const he=this.fragPrevious;if(p<J){const we=l.maxFragLookUpTolerance,Fe=p>J-we?0:we;oe=tn(he,U,Math.max(U[0].start,p),Fe),!oe&&he&&he.start<U[0].start&&(oe=U[0])}else oe=U[W-1];if(!oe)return;if(oe=this.mapToInitFragWhenRequired(oe),oe.sn!=="initSegment"){const we=oe.sn-C.startSN,Fe=U[we-1];Fe&&Fe.cc===oe.cc&&this.fragmentTracker.getState(Fe)===ei.NOT_LOADED&&(oe=Fe)}this.fragmentTracker.getState(oe)===ei.NOT_LOADED&&this.loadFragment(oe,a,p)}}getMaxBufferLength(t){const n=super.getMaxBufferLength();return t?Math.max(n,t):n}loadFragment(t,n,a){this.fragCurrent=t,t.sn==="initSegment"?this._loadInitSegment(t,n):(this.startFragRequested=!0,super.loadFragment(t,n,a))}get mediaBufferTimeRanges(){return new bu(this.tracksBuffered[this.currentTrackId]||[])}}class bu{constructor(t){this.buffered=void 0;const n=(a,l,u)=>{if(l=l>>>0,l>u-1)throw new DOMException(`Failed to execute '${a}' on 'TimeRanges': The index provided (${l}) is greater than the maximum bound (${u})`);return t[l][a]};this.buffered={get length(){return t.length},end(a){return n("end",a,t.length)},start(a){return n("start",a,t.length)}}}}class kl extends ja{constructor(t){super(t,"[subtitle-track-controller]");this.media=null,this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.trackChangeListener=()=>this.onTextTracksChanged(),this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(t){this._subtitleDisplay=t,this.trackId>-1&&this.toggleTrackModes(this.trackId)}registerListeners(){const{hls:t}=this;t.on(y.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(y.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(y.MANIFEST_LOADING,this.onManifestLoading,this),t.on(y.MANIFEST_PARSED,this.onManifestParsed,this),t.on(y.LEVEL_LOADING,this.onLevelLoading,this),t.on(y.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(y.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(y.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(y.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(y.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(y.MANIFEST_LOADING,this.onManifestLoading,this),t.off(y.MANIFEST_PARSED,this.onManifestParsed,this),t.off(y.LEVEL_LOADING,this.onLevelLoading,this),t.off(y.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(y.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(y.ERROR,this.onError,this)}onMediaAttached(t,n){this.media=n.media,!!this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(t){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,t)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),as(this.media.textTracks).forEach(n=>{In(n)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(t,n){this.tracks=n.subtitleTracks}onSubtitleTrackLoaded(t,n){const{id:a,details:l}=n,{trackId:u}=this,c=this.tracksInGroup[u];if(!c){this.warn(`Invalid subtitle track id ${a}`);return}const p=c.details;c.details=n.details,this.log(`subtitle track ${a} loaded [${l.startSN}-${l.endSN}]`),a===this.trackId&&this.playlistLoaded(a,n,p)}onLevelLoading(t,n){this.switchLevel(n.level)}onLevelSwitching(t,n){this.switchLevel(n.level)}switchLevel(t){const n=this.hls.levels[t];if(!(n!=null&&n.textGroupIds))return;const a=n.textGroupIds[n.urlId],l=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;if(this.groupId!==a){const u=this.tracks.filter(v=>!a||v.groupId===a);this.tracksInGroup=u;const c=this.findTrackId(l==null?void 0:l.name)||this.findTrackId();this.groupId=a||null;const p={subtitleTracks:u};this.log(`Updating subtitle tracks, ${u.length} track(s) found in "${a}" group-id`),this.hls.trigger(y.SUBTITLE_TRACKS_UPDATED,p),c!==-1&&this.setSubtitleTrack(c,l)}else this.shouldReloadPlaylist(l)&&this.setSubtitleTrack(this.trackId,l)}findTrackId(t){const n=this.tracksInGroup;for(let a=0;a<n.length;a++){const l=n[a];if((!this.selectDefaultTrack||l.default)&&(!t||t===l.name))return l.id}return-1}onError(t,n){n.fatal||!n.context||n.context.type===ui.SUBTITLE_TRACK&&n.context.id===this.trackId&&n.context.groupId===this.groupId&&this.checkRetry(n)}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(t){this.selectDefaultTrack=!1;const n=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(t,n)}loadPlaylist(t){super.loadPlaylist();const n=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(n)){const a=n.id,l=n.groupId;let u=n.url;if(t)try{u=t.addDirectives(u)}catch(c){this.warn(`Could not construct new URL with HLS Delivery Directives: ${c}`)}this.log(`Loading subtitle playlist for id ${a}`),this.hls.trigger(y.SUBTITLE_TRACK_LOADING,{url:u,id:a,groupId:l,deliveryDirectives:t||null})}}toggleTrackModes(t){const{media:n,trackId:a}=this;if(!n)return;const l=as(n.textTracks),u=l.filter(p=>p.groupId===this.groupId);if(t===-1)[].slice.call(l).forEach(p=>{p.mode="disabled"});else{const p=u[a];p&&(p.mode="disabled")}const c=u[t];c&&(c.mode=this.subtitleDisplay?"showing":"hidden")}setSubtitleTrack(t,n){var a;const l=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=t;return}if(this.trackId!==t&&this.toggleTrackModes(t),this.trackId===t&&(t===-1||(a=l[t])!=null&&a.details)||t<-1||t>=l.length)return;this.clearTimer();const u=l[t];if(this.log(`Switching to subtitle-track ${t}`+(u?` "${u.name}" lang:${u.lang} group:${u.groupId}`:"")),this.trackId=t,u){const{id:c,groupId:p="",name:v,type:A,url:C}=u;this.hls.trigger(y.SUBTITLE_TRACK_SWITCH,{id:c,groupId:p,name:v,type:A,url:C});const O=this.switchParams(u.url,n==null?void 0:n.details);this.loadPlaylist(O)}else this.hls.trigger(y.SUBTITLE_TRACK_SWITCH,{id:t})}onTextTracksChanged(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=-1;const n=as(this.media.textTracks);for(let a=0;a<n.length;a++)if(n[a].mode==="hidden")t=a;else if(n[a].mode==="showing"){t=a;break}this.subtitleTrack!==t&&(this.subtitleTrack=t)}}function as(f){const t=[];for(let n=0;n<f.length;n++){const a=f[n];(a.kind==="subtitles"||a.kind==="captions")&&a.label&&t.push(f[n])}return t}class Dd{constructor(t){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=t}append(t,n){const a=this.queues[n];a.push(t),a.length===1&&this.buffers[n]&&this.executeNext(n)}insertAbort(t,n){this.queues[n].unshift(t),this.executeNext(n)}appendBlocker(t){let n;const a=new Promise(u=>{n=u}),l={execute:n,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(l,t),a}executeNext(t){const{buffers:n,queues:a}=this,l=n[t],u=a[t];if(u.length){const c=u[0];try{c.execute()}catch(p){T.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),c.onError(p),l!=null&&l.updating||(u.shift(),this.executeNext(t))}}}shiftAndExecuteNext(t){this.queues[t].shift(),this.executeNext(t)}current(t){return this.queues[t][0]}}const Bo=an(),_u=/([ha]vc.)(?:\.[^.,]+)+/;class xu{constructor(t){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=()=>{const{media:n,mediaSource:a}=this;T.log("[buffer-controller]: Media source opened"),n&&(n.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(y.MEDIA_ATTACHED,{media:n})),a&&a.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{T.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=()=>{T.log("[buffer-controller]: Media source ended")},this._onMediaEmptied=()=>{const{media:n,_objectUrl:a}=this;n&&n.src!==a&&T.error(`Media element src was set while attaching MediaSource (${a} > ${n.src})`)},this.hls=t,this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null}registerListeners(){const{hls:t}=this;t.on(y.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(y.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(y.MANIFEST_LOADING,this.onManifestLoading,this),t.on(y.MANIFEST_PARSED,this.onManifestParsed,this),t.on(y.BUFFER_RESET,this.onBufferReset,this),t.on(y.BUFFER_APPENDING,this.onBufferAppending,this),t.on(y.BUFFER_CODECS,this.onBufferCodecs,this),t.on(y.BUFFER_EOS,this.onBufferEos,this),t.on(y.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(y.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(y.FRAG_PARSED,this.onFragParsed,this),t.on(y.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:t}=this;t.off(y.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(y.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(y.MANIFEST_LOADING,this.onManifestLoading,this),t.off(y.MANIFEST_PARSED,this.onManifestParsed,this),t.off(y.BUFFER_RESET,this.onBufferReset,this),t.off(y.BUFFER_APPENDING,this.onBufferAppending,this),t.off(y.BUFFER_CODECS,this.onBufferCodecs,this),t.off(y.BUFFER_EOS,this.onBufferEos,this),t.off(y.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(y.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(y.FRAG_PARSED,this.onFragParsed,this),t.off(y.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new Dd(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(t,n){let a=2;(n.audio&&!n.video||!n.altAudio)&&(a=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=a,T.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(t,n){const a=this.media=n.media;if(a&&Bo){const l=this.mediaSource=new Bo;l.addEventListener("sourceopen",this._onMediaSourceOpen),l.addEventListener("sourceended",this._onMediaSourceEnded),l.addEventListener("sourceclose",this._onMediaSourceClose),a.src=self.URL.createObjectURL(l),this._objectUrl=a.src,a.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:t,mediaSource:n,_objectUrl:a}=this;if(n){if(T.log("[buffer-controller]: media source detaching"),n.readyState==="open")try{n.endOfStream()}catch(l){T.warn(`[buffer-controller]: onMediaDetaching: ${l.message} while calling endOfStream`)}this.onBufferReset(),n.removeEventListener("sourceopen",this._onMediaSourceOpen),n.removeEventListener("sourceended",this._onMediaSourceEnded),n.removeEventListener("sourceclose",this._onMediaSourceClose),t&&(t.removeEventListener("emptied",this._onMediaEmptied),a&&self.URL.revokeObjectURL(a),t.src===a?(t.removeAttribute("src"),t.load()):T.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(y.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(t=>{const n=this.sourceBuffer[t];try{n&&(this.removeBufferListeners(t),this.mediaSource&&this.mediaSource.removeSourceBuffer(n),this.sourceBuffer[t]=void 0)}catch(a){T.warn(`[buffer-controller]: Failed to reset the ${t} buffer`,a)}}),this._initSourceBuffer()}onBufferCodecs(t,n){const a=this.getSourceBufferTypes().length;Object.keys(n).forEach(l=>{if(a){const u=this.tracks[l];if(u&&typeof u.buffer.changeType=="function"){const{id:c,codec:p,levelCodec:v,container:A,metadata:C}=n[l],O=(u.levelCodec||u.codec).replace(_u,"$1"),U=(v||p).replace(_u,"$1");if(O!==U){const W=`${A};codecs=${v||p}`;this.appendChangeType(l,W),T.log(`[buffer-controller]: switching codec ${O} to ${U}`),this.tracks[l]={buffer:u.buffer,codec:p,container:A,levelCodec:v,metadata:C,id:c}}}}else this.pendingTracks[l]=n[l]}),!a&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())}appendChangeType(t,n){const{operationQueue:a}=this,l={execute:()=>{const u=this.sourceBuffer[t];u&&(T.log(`[buffer-controller]: changing ${t} sourceBuffer type to ${n}`),u.changeType(n)),a.shiftAndExecuteNext(t)},onStart:()=>{},onComplete:()=>{},onError:u=>{T.warn(`[buffer-controller]: Failed to change ${t} SourceBuffer type`,u)}};a.append(l,t)}onBufferAppending(t,n){const{hls:a,operationQueue:l,tracks:u}=this,{data:c,type:p,frag:v,part:A,chunkMeta:C}=n,O=C.buffering[p],U=self.performance.now();O.start=U;const W=v.stats.buffering,J=A?A.stats.buffering:null;W.start===0&&(W.start=U),J&&J.start===0&&(J.start=U);const oe=u.audio;let he=!1;p==="audio"&&(oe==null?void 0:oe.container)==="audio/mpeg"&&(he=!this.lastMpegAudioChunk||C.id===1||this.lastMpegAudioChunk.sn!==C.sn,this.lastMpegAudioChunk=C);const we=v.start,Fe={execute:()=>{if(O.executeStart=self.performance.now(),he){const Me=this.sourceBuffer[p];if(Me){const it=we-Me.timestampOffset;Math.abs(it)>=.1&&(T.log(`[buffer-controller]: Updating audio SourceBuffer timestampOffset to ${we} (delta: ${it}) sn: ${v.sn})`),Me.timestampOffset=we)}}this.appendExecutor(c,p)},onStart:()=>{},onComplete:()=>{const Me=self.performance.now();O.executeEnd=O.end=Me,W.first===0&&(W.first=Me),J&&J.first===0&&(J.first=Me);const{sourceBuffer:it}=this,We={};for(const St in it)We[St]=ni.getBuffered(it[St]);this.appendError=0,this.hls.trigger(y.BUFFER_APPENDED,{type:p,frag:v,part:A,chunkMeta:C,parent:v.type,timeRanges:We})},onError:Me=>{T.error(`[buffer-controller]: Error encountered while trying to append to the ${p} SourceBuffer`,Me);const it={type:$.MEDIA_ERROR,parent:v.type,details:D.BUFFER_APPEND_ERROR,frag:v,part:A,chunkMeta:C,error:Me,err:Me,fatal:!1};Me.code===DOMException.QUOTA_EXCEEDED_ERR?it.details=D.BUFFER_FULL_ERROR:(this.appendError++,it.details=D.BUFFER_APPEND_ERROR,this.appendError>a.config.appendErrorMaxRetry&&(T.error(`[buffer-controller]: Failed ${a.config.appendErrorMaxRetry} times to append segment in sourceBuffer`),it.fatal=!0)),a.trigger(y.ERROR,it)}};l.append(Fe,p)}onBufferFlushing(t,n){const{operationQueue:a}=this,l=u=>({execute:this.removeExecutor.bind(this,u,n.startOffset,n.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(y.BUFFER_FLUSHED,{type:u})},onError:c=>{T.warn(`[buffer-controller]: Failed to remove from ${u} SourceBuffer`,c)}});n.type?a.append(l(n.type),n.type):this.getSourceBufferTypes().forEach(u=>{a.append(l(u),u)})}onFragParsed(t,n){const{frag:a,part:l}=n,u=[],c=l?l.elementaryStreams:a.elementaryStreams;c[ve.AUDIOVIDEO]?u.push("audiovideo"):(c[ve.AUDIO]&&u.push("audio"),c[ve.VIDEO]&&u.push("video"));const p=()=>{const v=self.performance.now();a.stats.buffering.end=v,l&&(l.stats.buffering.end=v);const A=l?l.stats:a.stats;this.hls.trigger(y.FRAG_BUFFERED,{frag:a,part:l,stats:A,id:a.type})};u.length===0&&T.warn(`Fragments must have at least one ElementaryStreamType set. type: ${a.type} level: ${a.level} sn: ${a.sn}`),this.blockBuffers(p,u)}onFragChanged(t,n){this.flushBackBuffer()}onBufferEos(t,n){this.getSourceBufferTypes().reduce((l,u)=>{const c=this.sourceBuffer[u];return c&&(!n.type||n.type===u)&&(c.ending=!0,c.ended||(c.ended=!0,T.log(`[buffer-controller]: ${u} sourceBuffer now EOS`))),l&&!!(!c||c.ended)},!0)&&(T.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(u=>{const c=this.sourceBuffer[u];c&&(c.ending=!1)});const{mediaSource:l}=this;if(!l||l.readyState!=="open"){l&&T.info(`[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: ${l.readyState}`);return}T.log("[buffer-controller]: Calling mediaSource.endOfStream()"),l.endOfStream()}))}onLevelUpdated(t,{details:n}){!n.fragments.length||(this.details=n,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}flushBackBuffer(){const{hls:t,details:n,media:a,sourceBuffer:l}=this;if(!a||n===null)return;const u=this.getSourceBufferTypes();if(!u.length)return;const c=n.live&&t.config.liveBackBufferLength!==null?t.config.liveBackBufferLength:t.config.backBufferLength;if(!te(c)||c<0)return;const p=a.currentTime,v=n.levelTargetDuration,A=Math.max(c,v),C=Math.floor(p/v)*v-A;u.forEach(O=>{const U=l[O];if(U){const W=ni.getBuffered(U);if(W.length>0&&C>W.start(0)){if(t.trigger(y.BACK_BUFFER_REACHED,{bufferEnd:C}),n.live)t.trigger(y.LIVE_BACK_BUFFER_REACHED,{bufferEnd:C});else if(U.ended&&W.end(W.length-1)-p<v*2){T.info(`[buffer-controller]: Cannot flush ${O} back buffer while SourceBuffer is in ended state`);return}t.trigger(y.BUFFER_FLUSHING,{startOffset:0,endOffset:C,type:O})}}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")return;const{details:t,hls:n,media:a,mediaSource:l}=this,u=t.fragments[0].start+t.totalduration,c=a.duration,p=te(l.duration)?l.duration:0;t.live&&n.config.liveDurationInfinity?(T.log("[buffer-controller]: Media Source duration is set to Infinity"),l.duration=Infinity,this.updateSeekableRange(t)):(u>p&&u>c||!te(c))&&(T.log(`[buffer-controller]: Updating Media Source duration to ${u.toFixed(3)}`),l.duration=u)}updateSeekableRange(t){const n=this.mediaSource,a=t.fragments;if(a.length&&t.live&&n!=null&&n.setLiveSeekableRange){const u=Math.max(0,a[0].start),c=Math.max(u,u+t.totalduration);n.setLiveSeekableRange(u,c)}}checkPendingTracks(){const{bufferCodecEventsExpected:t,operationQueue:n,pendingTracks:a}=this,l=Object.keys(a).length;if(l&&!t||l===2){this.createSourceBuffers(a),this.pendingTracks={};const u=this.getSourceBufferTypes();if(u.length)this.hls.trigger(y.BUFFER_CREATED,{tracks:this.tracks}),u.forEach(c=>{n.executeNext(c)});else{const c=new Error("could not create source buffer for media codec(s)");this.hls.trigger(y.ERROR,{type:$.MEDIA_ERROR,details:D.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:c,reason:c.message})}}}createSourceBuffers(t){const{sourceBuffer:n,mediaSource:a}=this;if(!a)throw Error("createSourceBuffers called when mediaSource was null");for(const l in t)if(!n[l]){const u=t[l];if(!u)throw Error(`source buffer exists for track ${l}, however track does not`);const c=u.levelCodec||u.codec,p=`${u.container};codecs=${c}`;T.log(`[buffer-controller]: creating sourceBuffer(${p})`);try{const v=n[l]=a.addSourceBuffer(p),A=l;this.addBufferListener(A,"updatestart",this._onSBUpdateStart),this.addBufferListener(A,"updateend",this._onSBUpdateEnd),this.addBufferListener(A,"error",this._onSBUpdateError),this.tracks[l]={buffer:v,codec:c,container:u.container,levelCodec:u.levelCodec,metadata:u.metadata,id:u.id}}catch(v){T.error(`[buffer-controller]: error while trying to add sourceBuffer: ${v.message}`),this.hls.trigger(y.ERROR,{type:$.MEDIA_ERROR,details:D.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:v,mimeType:p})}}}_onSBUpdateStart(t){const{operationQueue:n}=this;n.current(t).onStart()}_onSBUpdateEnd(t){const{operationQueue:n}=this;n.current(t).onComplete(),n.shiftAndExecuteNext(t)}_onSBUpdateError(t,n){const a=new Error(`${t} SourceBuffer error`);T.error(`[buffer-controller]: ${a}`,n),this.hls.trigger(y.ERROR,{type:$.MEDIA_ERROR,details:D.BUFFER_APPENDING_ERROR,error:a,fatal:!1});const l=this.operationQueue.current(t);l&&l.onError(n)}removeExecutor(t,n,a){const{media:l,mediaSource:u,operationQueue:c,sourceBuffer:p}=this,v=p[t];if(!l||!u||!v){T.warn(`[buffer-controller]: Attempting to remove from the ${t} SourceBuffer, but it does not exist`),c.shiftAndExecuteNext(t);return}const A=te(l.duration)?l.duration:Infinity,C=te(u.duration)?u.duration:Infinity,O=Math.max(0,n),U=Math.min(a,A,C);U>O&&!v.ending?(v.ended=!1,T.log(`[buffer-controller]: Removing [${O},${U}] from the ${t} SourceBuffer`),v.remove(O,U)):c.shiftAndExecuteNext(t)}appendExecutor(t,n){const{operationQueue:a,sourceBuffer:l}=this,u=l[n];if(!u){T.warn(`[buffer-controller]: Attempting to append to the ${n} SourceBuffer, but it does not exist`),a.shiftAndExecuteNext(n);return}u.ended=!1,u.appendBuffer(t)}blockBuffers(t,n=this.getSourceBufferTypes()){if(!n.length){T.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(t);return}const{operationQueue:a}=this,l=n.map(u=>a.appendBlocker(u));Promise.all(l).then(()=>{t(),n.forEach(u=>{const c=this.sourceBuffer[u];c!=null&&c.updating||a.shiftAndExecuteNext(u)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(t,n,a){const l=this.sourceBuffer[t];if(!l)return;const u=a.bind(this,t);this.listeners[t].push({event:n,listener:u}),l.addEventListener(n,u)}removeBufferListeners(t){const n=this.sourceBuffer[t];!n||this.listeners[t].forEach(a=>{n.removeEventListener(a.event,a.listener)})}}const Aa={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Gi=function(t){let n=t;return Aa.hasOwnProperty(t)&&(n=Aa[t]),String.fromCharCode(n)},or=15,os=100,et={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Id={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Eu={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Dl={25:2,26:4,29:6,30:8,31:10,27:13,28:15},jr=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class Tu{constructor(){this.time=null,this.verboseLevel=0}log(t,n){if(this.verboseLevel>=t){const a=typeof n=="function"?n():n;T.log(`${this.time} [${t}] ${a}`)}}}const ls=function(t){const n=[];for(let a=0;a<t.length;a++)n.push(t[a].toString(16));return n};class Il{constructor(t,n,a,l,u){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=t||"white",this.underline=n||!1,this.italics=a||!1,this.background=l||"black",this.flash=u||!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(t){const n=["foreground","underline","italics","background","flash"];for(let a=0;a<n.length;a++){const l=n[a];t.hasOwnProperty(l)&&(this[l]=t[l])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash}copy(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class Su{constructor(t,n,a,l,u,c){this.uchar=void 0,this.penState=void 0,this.uchar=t||" ",this.penState=new Il(n,a,l,u,c)}reset(){this.uchar=" ",this.penState.reset()}setChar(t,n){this.uchar=t,this.penState.copy(n)}setPenState(t){this.penState.copy(t)}equals(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)}copy(t){this.uchar=t.uchar,this.penState.copy(t.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class qs{constructor(t){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(let n=0;n<os;n++)this.chars.push(new Su);this.logger=t,this.pos=0,this.currPenState=new Il}equals(t){let n=!0;for(let a=0;a<os;a++)if(!this.chars[a].equals(t.chars[a])){n=!1;break}return n}copy(t){for(let n=0;n<os;n++)this.chars[n].copy(t.chars[n])}isEmpty(){let t=!0;for(let n=0;n<os;n++)if(!this.chars[n].isEmpty()){t=!1;break}return t}setCursor(t){this.pos!==t&&(this.pos=t),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>os&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=os)}moveCursor(t){const n=this.pos+t;if(t>1)for(let a=this.pos+1;a<n+1;a++)this.chars[a].setPenState(this.currPenState);this.setCursor(n)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(t){t>=144&&this.backSpace();const n=Gi(t);if(this.pos>=os){this.logger.log(0,()=>"Cannot insert "+t.toString(16)+" ("+n+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(n,this.currPenState),this.moveCursor(1)}clearFromPos(t){let n;for(n=t;n<os;n++)this.chars[n].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const t=[];let n=!0;for(let a=0;a<os;a++){const l=this.chars[a].uchar;l!==" "&&(n=!1),t.push(l)}return n?"":t.join("")}setPenStyles(t){this.currPenState.setStyles(t),this.chars[this.pos].setPenState(this.currPenState)}}class Rl{constructor(t){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(let n=0;n<or;n++)this.rows.push(new qs(t));this.logger=t,this.currRow=or-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}reset(){for(let t=0;t<or;t++)this.rows[t].clear();this.currRow=or-1}equals(t){let n=!0;for(let a=0;a<or;a++)if(!this.rows[a].equals(t.rows[a])){n=!1;break}return n}copy(t){for(let n=0;n<or;n++)this.rows[n].copy(t.rows[n])}isEmpty(){let t=!0;for(let n=0;n<or;n++)if(!this.rows[n].isEmpty()){t=!1;break}return t}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(t){this.rows[this.currRow].insertChar(t)}setPen(t){this.rows[this.currRow].setPenStyles(t)}moveCursor(t){this.rows[this.currRow].moveCursor(t)}setCursor(t){this.logger.log(2,"setCursor: "+t),this.rows[this.currRow].setCursor(t)}setPAC(t){this.logger.log(2,()=>"pacData = "+JSON.stringify(t));let n=t.row-1;if(this.nrRollUpRows&&n<this.nrRollUpRows-1&&(n=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==n){for(let p=0;p<or;p++)this.rows[p].clear();const u=this.currRow+1-this.nrRollUpRows,c=this.lastOutputScreen;if(c){const p=c.rows[u].cueStartTime,v=this.logger.time;if(p&&v!==null&&p<v)for(let A=0;A<this.nrRollUpRows;A++)this.rows[n-this.nrRollUpRows+A+1].copy(c.rows[u+A])}}this.currRow=n;const a=this.rows[this.currRow];if(t.indent!==null){const u=t.indent,c=Math.max(u-1,0);a.setCursor(t.indent),t.color=a.chars[c].penState.foreground}const l={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1};this.setPen(l)}setBkgData(t){this.logger.log(2,()=>"bkgData = "+JSON.stringify(t)),this.backSpace(),this.setPen(t),this.insertChar(32)}setRollUpRows(t){this.nrRollUpRows=t}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const t=this.currRow+1-this.nrRollUpRows,n=this.rows.splice(t,1)[0];n.clear(),this.rows.splice(this.currRow,0,n),this.logger.log(2,"Rolling up")}getDisplayText(t){t=t||!1;const n=[];let a="",l=-1;for(let u=0;u<or;u++){const c=this.rows[u].getTextString();c&&(l=u+1,t?n.push("Row "+l+": '"+c+"'"):n.push(c.trim()))}return n.length>0&&(t?a="["+n.join(" | ")+"]":a=n.join(`
`)),a}getTextAndFormat(){return this.rows}}class Ol{constructor(t,n,a){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=t,this.outputFilter=n,this.mode=null,this.verbose=0,this.displayedMemory=new Rl(a),this.nonDisplayedMemory=new Rl(a),this.lastOutputScreen=new Rl(a),this.currRollUpRow=this.displayedMemory.rows[or-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=a}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[or-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(t){this.outputFilter=t}setPAC(t){this.writeScreen.setPAC(t)}setBkgData(t){this.writeScreen.setBkgData(t)}setMode(t){t!==this.mode&&(this.mode=t,this.logger.log(2,()=>"MODE="+t),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)}insertChars(t){for(let a=0;a<t.length;a++)this.writeScreen.insertChar(t[a]);const n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>n+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(t){this.logger.log(2,"RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(t){this.logger.log(2,"TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)}ccMIDROW(t){const n={flash:!1};if(n.underline=t%2==1,n.italics=t>=46,n.italics)n.foreground="white";else{const a=Math.floor(t/2)-16,l=["white","green","blue","cyan","red","yellow","magenta"];n.foreground=l[a]}this.logger.log(2,"MIDROW: "+JSON.stringify(n)),this.writeScreen.setPen(n)}outputDataUpdate(t=!1){const n=this.logger.time;n!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=n:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,n,this.lastOutputScreen),t&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:n),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))}}class Cn{constructor(t,n,a){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;const l=new Tu;this.channels=[null,new Ol(t,n,l),new Ol(t+1,a,l)],this.cmdHistory=Mo(),this.logger=l}getHandler(t){return this.channels[t].getHandler()}setHandler(t,n){this.channels[t].setHandler(n)}addData(t,n){let a,l,u,c=!1;this.logger.time=t;for(let p=0;p<n.length;p+=2)if(l=n[p]&127,u=n[p+1]&127,!(l===0&&u===0)){if(this.logger.log(3,"["+ls([n[p],n[p+1]])+"] -> ("+ls([l,u])+")"),a=this.parseCmd(l,u),a||(a=this.parseMidrow(l,u)),a||(a=this.parsePAC(l,u)),a||(a=this.parseBackgroundAttributes(l,u)),!a&&(c=this.parseChars(l,u),c)){const v=this.currentChannel;v&&v>0?this.channels[v].insertChars(c):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!a&&!c&&this.logger.log(2,"Couldn't parse cleaned data "+ls([l,u])+" orig: "+ls([n[p],n[p+1]]))}}parseCmd(t,n){const{cmdHistory:a}=this,l=(t===20||t===28||t===21||t===29)&&n>=32&&n<=47,u=(t===23||t===31)&&n>=33&&n<=35;if(!(l||u))return!1;if(xr(t,n,a))return $r(null,null,a),this.logger.log(3,"Repeated command ("+ls([t,n])+") is dropped"),!0;const c=t===20||t===21||t===23?1:2,p=this.channels[c];return t===20||t===21||t===28||t===29?n===32?p.ccRCL():n===33?p.ccBS():n===34?p.ccAOF():n===35?p.ccAON():n===36?p.ccDER():n===37?p.ccRU(2):n===38?p.ccRU(3):n===39?p.ccRU(4):n===40?p.ccFON():n===41?p.ccRDC():n===42?p.ccTR():n===43?p.ccRTD():n===44?p.ccEDM():n===45?p.ccCR():n===46?p.ccENM():n===47&&p.ccEOC():p.ccTO(n-32),$r(t,n,a),this.currentChannel=c,!0}parseMidrow(t,n){let a=0;if((t===17||t===25)&&n>=32&&n<=47){if(t===17?a=1:a=2,a!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const l=this.channels[a];return l?(l.ccMIDROW(n),this.logger.log(3,"MIDROW ("+ls([t,n])+")"),!0):!1}return!1}parsePAC(t,n){let a;const l=this.cmdHistory,u=(t>=17&&t<=23||t>=25&&t<=31)&&n>=64&&n<=127,c=(t===16||t===24)&&n>=64&&n<=95;if(!(u||c))return!1;if(xr(t,n,l))return $r(null,null,l),!0;const p=t<=23?1:2;n>=64&&n<=95?a=p===1?et[t]:Eu[t]:a=p===1?Id[t]:Dl[t];const v=this.channels[p];return v?(v.setPAC(this.interpretPAC(a,n)),$r(t,n,l),this.currentChannel=p,!0):!1}interpretPAC(t,n){let a;const l={color:null,italics:!1,indent:null,underline:!1,row:t};return n>95?a=n-96:a=n-64,l.underline=(a&1)==1,a<=13?l.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(a/2)]:a<=15?(l.italics=!0,l.color="white"):l.indent=Math.floor((a-16)/2)*4,l}parseChars(t,n){let a,l=null,u=null;if(t>=25?(a=2,u=t-8):(a=1,u=t),u>=17&&u<=19){let c;u===17?c=n+80:u===18?c=n+112:c=n+144,this.logger.log(2,"Special char '"+Gi(c)+"' in channel "+a),l=[c]}else t>=32&&t<=127&&(l=n===0?[t]:[t,n]);if(l){const c=ls(l);this.logger.log(3,"Char codes =  "+c.join(",")),$r(t,n,this.cmdHistory)}return l}parseBackgroundAttributes(t,n){const a=(t===16||t===24)&&n>=32&&n<=47,l=(t===23||t===31)&&n>=45&&n<=47;if(!(a||l))return!1;let u;const c={};t===16||t===24?(u=Math.floor((n-32)/2),c.background=jr[u],n%2==1&&(c.background=c.background+"_semi")):n===45?c.background="transparent":(c.foreground="black",n===47&&(c.underline=!0));const p=t<=23?1:2;return this.channels[p].setBkgData(c),$r(t,n,this.cmdHistory),!0}reset(){for(let t=0;t<Object.keys(this.channels).length;t++){const n=this.channels[t];n&&n.reset()}this.cmdHistory=Mo()}cueSplitAtTime(t){for(let n=0;n<this.channels.length;n++){const a=this.channels[n];a&&a.cueSplitAtTime(t)}}}function $r(f,t,n){n.a=f,n.b=t}function xr(f,t,n){return n.a===f&&n.b===t}function Mo(){return{a:null,b:null}}class Pl{constructor(t,n){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=t,this.trackName=n}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(t,n,a){(this.startTime===null||this.startTime>t)&&(this.startTime=t),this.endTime=n,this.screen=a,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var Cu=function(){if(typeof self!="undefined"&&self.VTTCue)return self.VTTCue;const f=["","lr","rl"],t=["start","middle","end","left","right"];function n(p,v){if(typeof v!="string"||!Array.isArray(p))return!1;const A=v.toLowerCase();return~p.indexOf(A)?A:!1}function a(p){return n(f,p)}function l(p){return n(t,p)}function u(p,...v){let A=1;for(;A<arguments.length;A++){const C=arguments[A];for(const O in C)p[O]=C[O]}return p}function c(p,v,A){const C=this,O={enumerable:!0};C.hasBeenReset=!1;let U="",W=!1,J=p,oe=v,he=A,we=null,Fe="",Me=!0,it="auto",We="start",St=50,ut="middle",gt=50,Ct="middle";Object.defineProperty(C,"id",u({},O,{get:function(){return U},set:function(rt){U=""+rt}})),Object.defineProperty(C,"pauseOnExit",u({},O,{get:function(){return W},set:function(rt){W=!!rt}})),Object.defineProperty(C,"startTime",u({},O,{get:function(){return J},set:function(rt){if(typeof rt!="number")throw new TypeError("Start time must be set to a number.");J=rt,this.hasBeenReset=!0}})),Object.defineProperty(C,"endTime",u({},O,{get:function(){return oe},set:function(rt){if(typeof rt!="number")throw new TypeError("End time must be set to a number.");oe=rt,this.hasBeenReset=!0}})),Object.defineProperty(C,"text",u({},O,{get:function(){return he},set:function(rt){he=""+rt,this.hasBeenReset=!0}})),Object.defineProperty(C,"region",u({},O,{get:function(){return we},set:function(rt){we=rt,this.hasBeenReset=!0}})),Object.defineProperty(C,"vertical",u({},O,{get:function(){return Fe},set:function(rt){const qt=a(rt);if(qt===!1)throw new SyntaxError("An invalid or illegal string was specified.");Fe=qt,this.hasBeenReset=!0}})),Object.defineProperty(C,"snapToLines",u({},O,{get:function(){return Me},set:function(rt){Me=!!rt,this.hasBeenReset=!0}})),Object.defineProperty(C,"line",u({},O,{get:function(){return it},set:function(rt){if(typeof rt!="number"&&rt!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");it=rt,this.hasBeenReset=!0}})),Object.defineProperty(C,"lineAlign",u({},O,{get:function(){return We},set:function(rt){const qt=l(rt);if(!qt)throw new SyntaxError("An invalid or illegal string was specified.");We=qt,this.hasBeenReset=!0}})),Object.defineProperty(C,"position",u({},O,{get:function(){return St},set:function(rt){if(rt<0||rt>100)throw new Error("Position must be between 0 and 100.");St=rt,this.hasBeenReset=!0}})),Object.defineProperty(C,"positionAlign",u({},O,{get:function(){return ut},set:function(rt){const qt=l(rt);if(!qt)throw new SyntaxError("An invalid or illegal string was specified.");ut=qt,this.hasBeenReset=!0}})),Object.defineProperty(C,"size",u({},O,{get:function(){return gt},set:function(rt){if(rt<0||rt>100)throw new Error("Size must be between 0 and 100.");gt=rt,this.hasBeenReset=!0}})),Object.defineProperty(C,"align",u({},O,{get:function(){return Ct},set:function(rt){const qt=l(rt);if(!qt)throw new SyntaxError("An invalid or illegal string was specified.");Ct=qt,this.hasBeenReset=!0}})),C.displayState=void 0}return c.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},c}();class wu{decode(t,n){if(!t)return"";if(typeof t!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}function Fo(f){function t(a,l,u,c){return(a|0)*3600+(l|0)*60+(u|0)+parseFloat(c||0)}const n=f.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return n?parseFloat(n[2])>59?t(n[2],n[3],0,n[4]):t(n[1],n[2],n[3],n[4]):null}class ba{constructor(){this.values=Object.create(null)}set(t,n){!this.get(t)&&n!==""&&(this.values[t]=n)}get(t,n,a){return a?this.has(t)?this.values[t]:n[a]:this.has(t)?this.values[t]:n}has(t){return t in this.values}alt(t,n,a){for(let l=0;l<a.length;++l)if(n===a[l]){this.set(t,n);break}}integer(t,n){/^-?\d+$/.test(n)&&this.set(t,parseInt(n,10))}percent(t,n){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(n)){const a=parseFloat(n);if(a>=0&&a<=100)return this.set(t,a),!0}return!1}}function Ws(f,t,n,a){const l=a?f.split(a):[f];for(const u in l){if(typeof l[u]!="string")continue;const c=l[u].split(n);if(c.length!==2)continue;const p=c[0],v=c[1];t(p,v)}}const za=new Cu(0,0,""),No=za.align==="middle"?"middle":"center";function Bl(f,t,n){const a=f;function l(){const p=Fo(f);if(p===null)throw new Error("Malformed timestamp: "+a);return f=f.replace(/^[^\sa-zA-Z-]+/,""),p}function u(p,v){const A=new ba;Ws(p,function(U,W){let J;switch(U){case"region":for(let oe=n.length-1;oe>=0;oe--)if(n[oe].id===W){A.set(U,n[oe].region);break}break;case"vertical":A.alt(U,W,["rl","lr"]);break;case"line":J=W.split(","),A.integer(U,J[0]),A.percent(U,J[0])&&A.set("snapToLines",!1),A.alt(U,J[0],["auto"]),J.length===2&&A.alt("lineAlign",J[1],["start",No,"end"]);break;case"position":J=W.split(","),A.percent(U,J[0]),J.length===2&&A.alt("positionAlign",J[1],["start",No,"end","line-left","line-right","auto"]);break;case"size":A.percent(U,W);break;case"align":A.alt(U,W,["start",No,"end","left","right"]);break}},/:/,/\s/),v.region=A.get("region",null),v.vertical=A.get("vertical","");let C=A.get("line","auto");C==="auto"&&za.line===-1&&(C=-1),v.line=C,v.lineAlign=A.get("lineAlign","start"),v.snapToLines=A.get("snapToLines",!0),v.size=A.get("size",100),v.align=A.get("align",No);let O=A.get("position","auto");O==="auto"&&za.position===50&&(O=v.align==="start"||v.align==="left"?0:v.align==="end"||v.align==="right"?100:50),v.position=O}function c(){f=f.replace(/^\s+/,"")}if(c(),t.startTime=l(),c(),f.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+a);f=f.slice(3),c(),t.endTime=l(),c(),u(f,t)}function Lu(f){return f.replace(/<br(?: \/)?>/gi,`
`)}class ku{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new wu,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(t){const n=this;t&&(n.buffer+=n.decoder.decode(t,{stream:!0}));function a(){let u=n.buffer,c=0;for(u=Lu(u);c<u.length&&u[c]!=="\r"&&u[c]!==`
`;)++c;const p=u.slice(0,c);return u[c]==="\r"&&++c,u[c]===`
`&&++c,n.buffer=u.slice(c),p}function l(u){Ws(u,function(c,p){},/:/)}try{let u="";if(n.state==="INITIAL"){if(!/\r\n|\n/.test(n.buffer))return this;u=a();const p=u.match(/^()?WEBVTT([ \t].*)?$/);if(!(p!=null&&p[0]))throw new Error("Malformed WebVTT signature.");n.state="HEADER"}let c=!1;for(;n.buffer;){if(!/\r\n|\n/.test(n.buffer))return this;switch(c?c=!1:u=a(),n.state){case"HEADER":/:/.test(u)?l(u):u||(n.state="ID");continue;case"NOTE":u||(n.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(u)){n.state="NOTE";break}if(!u)continue;if(n.cue=new Cu(0,0,""),n.state="CUE",u.indexOf("-->")===-1){n.cue.id=u;continue}case"CUE":if(!n.cue){n.state="BADCUE";continue}try{Bl(u,n.cue,n.regionList)}catch(p){n.cue=null,n.state="BADCUE";continue}n.state="CUETEXT";continue;case"CUETEXT":{const p=u.indexOf("-->")!==-1;if(!u||p&&(c=!0)){n.oncue&&n.cue&&n.oncue(n.cue),n.cue=null,n.state="ID";continue}if(n.cue===null)continue;n.cue.text&&(n.cue.text+=`
`),n.cue.text+=u}continue;case"BADCUE":u||(n.state="ID")}}}catch(u){n.state==="CUETEXT"&&n.cue&&n.oncue&&n.oncue(n.cue),n.cue=null,n.state=n.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const t=this;try{if((t.cue||t.state==="HEADER")&&(t.buffer+=`

`,t.parse()),t.state==="INITIAL"||t.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(n){t.onparsingerror&&t.onparsingerror(n)}return t.onflush&&t.onflush(),this}}const Rd=/\r\n|\n\r|\n|\r/g,_a=function(t,n,a=0){return t.slice(a,a+n.length)===n},Od=function(t){let n=parseInt(t.slice(-3));const a=parseInt(t.slice(-6,-4)),l=parseInt(t.slice(-9,-7)),u=t.length>9?parseInt(t.substring(0,t.indexOf(":"))):0;if(!te(n)||!te(a)||!te(l)||!te(u))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${t}`);return n+=1e3*a,n+=60*1e3*l,n+=60*60*1e3*u,n},Ml=function(t){let n=5381,a=t.length;for(;a;)n=n*33^t.charCodeAt(--a);return(n>>>0).toString()};function Fl(f,t,n){return Ml(f.toString())+Ml(t.toString())+Ml(n)}const Du=function(t,n,a){let l=t[n],u=t[l.prevCC];if(!u||!u.new&&l.new){t.ccOffset=t.presentationOffset=l.start,l.new=!1;return}for(;(c=u)!=null&&c.new;){var c;t.ccOffset+=l.start-u.start,l.new=!1,l=u,u=t[l.prevCC]}t.presentationOffset=a};function Nl(f,t,n,a,l,u,c){const p=new ku,v=Tn(new Uint8Array(f)).trim().replace(Rd,`
`).split(`
`),A=[],C=t?_(t.baseTime,t.timescale):0;let O="00:00.000",U=0,W=0,J,oe=!0;p.oncue=function(he){const we=n[a];let Fe=n.ccOffset;const Me=(U-C)/9e4;if(we!=null&&we.new&&(W!==void 0?Fe=n.ccOffset=we.start:Du(n,a,Me)),Me){if(!t){J=new Error("Missing initPTS for VTT MPEGTS");return}Fe=Me-n.presentationOffset}const it=he.endTime-he.startTime,We=He((he.startTime+Fe-W)*9e4,l*9e4)/9e4;he.startTime=Math.max(We,0),he.endTime=Math.max(We+it,0);const St=he.text.trim();he.text=decodeURIComponent(encodeURIComponent(St)),he.id||(he.id=Fl(he.startTime,he.endTime,St)),he.endTime>0&&A.push(he)},p.onparsingerror=function(he){J=he},p.onflush=function(){if(J){c(J);return}u(A)},v.forEach(he=>{if(oe)if(_a(he,"X-TIMESTAMP-MAP=")){oe=!1,he.slice(16).split(",").forEach(we=>{_a(we,"LOCAL:")?O=we.slice(6):_a(we,"MPEGTS:")&&(U=parseInt(we.slice(7)))});try{W=Od(O)/1e3}catch(we){J=we}return}else he===""&&(oe=!1);p.parse(he+`
`)}),p.flush()}const Ya="stpp.ttml.im1t",Ul=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Uo=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,jo={left:"start",center:"center",right:"end",start:"start",end:"end"};function Iu(f,t,n,a){const l=ai(new Uint8Array(f),["mdat"]);if(l.length===0){a(new Error("Could not parse IMSC1 mdat"));return}const u=l.map(p=>Tn(p)),c=L(t.baseTime,1,t.timescale);try{u.forEach(p=>n(Ru(p,c)))}catch(p){a(p)}}function Ru(f,t){const l=new DOMParser().parseFromString(f,"text/xml").getElementsByTagName("tt")[0];if(!l)throw new Error("Invalid ttml");const u={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},c=Object.keys(u).reduce((O,U)=>(O[U]=l.getAttribute(`ttp:${U}`)||u[U],O),{}),p=l.getAttribute("xml:space")!=="preserve",v=xa($o(l,"styling","style")),A=xa($o(l,"layout","region")),C=$o(l,"body","[begin]");return[].map.call(C,O=>{const U=jl(O,p);if(!U||!O.hasAttribute("begin"))return null;const W=Ts(O.getAttribute("begin"),c),J=Ts(O.getAttribute("dur"),c);let oe=Ts(O.getAttribute("end"),c);if(W===null)throw Zn(O);if(oe===null){if(J===null)throw Zn(O);oe=W+J}const he=new Cu(W-t,oe-t,U);he.id=Fl(he.startTime,he.endTime,he.text);const we=A[O.getAttribute("region")],Fe=v[O.getAttribute("style")],Me=Ou(we,Fe,v),{textAlign:it}=Me;if(it){const We=jo[it];We&&(he.lineAlign=We),he.align=it}return Ee(he,Me),he}).filter(O=>O!==null)}function $o(f,t,n){const a=f.getElementsByTagName(t)[0];return a?[].slice.call(a.querySelectorAll(n)):[]}function xa(f){return f.reduce((t,n)=>{const a=n.getAttribute("xml:id");return a&&(t[a]=n),t},{})}function jl(f,t){return[].slice.call(f.childNodes).reduce((n,a,l)=>{var u;return a.nodeName==="br"&&l?n+`
`:(u=a.childNodes)!=null&&u.length?jl(a,t):t?n+a.textContent.trim().replace(/\s+/g," "):n+a.textContent},"")}function Ou(f,t,n){const a="http://www.w3.org/ns/ttml#styling";let l=null;const u=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],c=f!=null&&f.hasAttribute("style")?f.getAttribute("style"):null;return c&&n.hasOwnProperty(c)&&(l=n[c]),u.reduce((p,v)=>{const A=Er(t,a,v)||Er(f,a,v)||Er(l,a,v);return A&&(p[v]=A),p},{})}function Er(f,t,n){return f&&f.hasAttributeNS(t,n)?f.getAttributeNS(t,n):null}function Zn(f){return new Error(`Could not parse ttml timestamp ${f}`)}function Ts(f,t){if(!f)return null;let n=Fo(f);return n===null&&(Ul.test(f)?n=On(f,t):Uo.test(f)&&(n=Pd(f,t))),n}function On(f,t){const n=Ul.exec(f),a=(n[4]|0)+(n[5]|0)/t.subFrameRate;return(n[1]|0)*3600+(n[2]|0)*60+(n[3]|0)+a/t.frameRate}function Pd(f,t){const n=Uo.exec(f),a=Number(n[1]);switch(n[2]){case"h":return a*3600;case"m":return a*60;case"ms":return a*1e3;case"f":return a/t.frameRate;case"t":return a/t.tickRate}return a}class Zt{constructor(t){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Xa(),this.captionsProperties=void 0,this.hls=t,this.config=t.config,this.Cues=t.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){const n=new Pl(this,"textTrack1"),a=new Pl(this,"textTrack2"),l=new Pl(this,"textTrack3"),u=new Pl(this,"textTrack4");this.cea608Parser1=new Cn(1,n,a),this.cea608Parser2=new Cn(3,l,u)}t.on(y.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(y.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(y.MANIFEST_LOADING,this.onManifestLoading,this),t.on(y.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(y.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(y.FRAG_LOADING,this.onFragLoading,this),t.on(y.FRAG_LOADED,this.onFragLoaded,this),t.on(y.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.on(y.FRAG_DECRYPTED,this.onFragDecrypted,this),t.on(y.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(y.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.on(y.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:t}=this;t.off(y.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(y.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(y.MANIFEST_LOADING,this.onManifestLoading,this),t.off(y.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(y.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(y.FRAG_LOADING,this.onFragLoading,this),t.off(y.FRAG_LOADED,this.onFragLoaded,this),t.off(y.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.off(y.FRAG_DECRYPTED,this.onFragDecrypted,this),t.off(y.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(y.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.off(y.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null}addCues(t,n,a,l,u){let c=!1;for(let p=u.length;p--;){const v=u[p],A=$l(v[0],v[1],n,a);if(A>=0&&(v[0]=Math.min(v[0],n),v[1]=Math.max(v[1],a),c=!0,A/(a-n)>.5))return}if(c||u.push([n,a]),this.config.renderTextTracksNatively){const p=this.captionsTracks[t];this.Cues.newCue(p,n,a,l)}else{const p=this.Cues.newCue(null,n,a,l);this.hls.trigger(y.CUES_PARSED,{type:"captions",cues:p,track:t})}}onInitPtsFound(t,{frag:n,id:a,initPTS:l,timescale:u}){const{unparsedVttFrags:c}=this;a==="main"&&(this.initPTS[n.cc]={baseTime:l,timescale:u}),c.length&&(this.unparsedVttFrags=[],c.forEach(p=>{this.onFragLoaded(y.FRAG_LOADED,p)}))}getExistingTrack(t){const{media:n}=this;if(n)for(let a=0;a<n.textTracks.length;a++){const l=n.textTracks[a];if(l[t])return l}return null}createCaptionsTrack(t){this.config.renderTextTracksNatively?this.createNativeTrack(t):this.createNonNativeTrack(t)}createNativeTrack(t){if(this.captionsTracks[t])return;const{captionsProperties:n,captionsTracks:a,media:l}=this,{label:u,languageCode:c}=n[t],p=this.getExistingTrack(t);if(p)a[t]=p,In(a[t]),gr(a[t],l);else{const v=this.createTextTrack("captions",u,c);v&&(v[t]=!0,a[t]=v)}}createNonNativeTrack(t){if(this.nonNativeCaptionsTracks[t])return;const n=this.captionsProperties[t];if(!n)return;const a=n.label,l={_id:t,label:a,kind:"captions",default:n.media?!!n.media.default:!1,closedCaptions:n.media};this.nonNativeCaptionsTracks[t]=l,this.hls.trigger(y.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[l]})}createTextTrack(t,n,a){const l=this.media;if(!!l)return l.addTextTrack(t,n,a)}onMediaAttaching(t,n){this.media=n.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:t}=this;Object.keys(t).forEach(n=>{In(t[n]),delete t[n]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Xa(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:t}=this;if(!t)return;const n=t.textTracks;if(n)for(let a=0;a<n.length;a++)In(n[a])}onSubtitleTracksUpdated(t,n){const a=n.subtitleTracks||[],l=a.some(u=>u.textCodec===Ya);if(this.config.enableWebVTT||l&&this.config.enableIMSC1){if(vu(this.tracks,a)){this.tracks=a;return}if(this.textTracks=[],this.tracks=a,this.config.renderTextTracksNatively){const c=this.media?this.media.textTracks:null;this.tracks.forEach((p,v)=>{let A;if(c&&v<c.length){let C=null;for(let O=0;O<c.length;O++)if(Ks(c[O],p)){C=c[O];break}C&&(A=C)}if(A)In(A);else{const C=this._captionsOrSubtitlesFromCharacteristics(p);A=this.createTextTrack(C,p.name,p.lang),A&&(A.mode="disabled")}A&&(A.groupId=p.groupId,this.textTracks.push(A))})}else if(this.tracks.length){const c=this.tracks.map(p=>({label:p.name,kind:p.type.toLowerCase(),default:p.default,subtitleTrack:p}));this.hls.trigger(y.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:c})}}}_captionsOrSubtitlesFromCharacteristics(t){if(t.attrs.CHARACTERISTICS){const n=/transcribes-spoken-dialog/gi.test(t.attrs.CHARACTERISTICS),a=/describes-music-and-sound/gi.test(t.attrs.CHARACTERISTICS);if(n&&a)return"captions"}return"subtitles"}onManifestLoaded(t,n){this.config.enableCEA708Captions&&n.captions&&n.captions.forEach(a=>{const l=/(?:CC|SERVICE)([1-4])/.exec(a.instreamId);if(!l)return;const u=`textTrack${l[1]}`,c=this.captionsProperties[u];!c||(c.label=a.name,a.lang&&(c.languageCode=a.lang),c.media=a)})}closedCaptionsForLevel(t){const n=this.hls.levels[t.level];return n==null?void 0:n.attrs["CLOSED-CAPTIONS"]}onFragLoading(t,n){const{cea608Parser1:a,cea608Parser2:l,lastSn:u,lastPartIndex:c}=this;if(!(!this.enabled||!(a&&l))&&n.frag.type===Gt.MAIN){var p,v;const A=n.frag.sn,C=(p=n==null||(v=n.part)==null?void 0:v.index)!=null?p:-1;A===u+1||A===u&&C===c+1||(a.reset(),l.reset()),this.lastSn=A,this.lastPartIndex=C}}onFragLoaded(t,n){const{frag:a,payload:l}=n;if(a.type===Gt.SUBTITLE)if(l.byteLength){const u=a.decryptdata,c="stats"in n;if(u==null||!u.encrypted||c){const p=this.tracks[a.level],v=this.vttCCs;v[a.cc]||(v[a.cc]={start:a.start,prevCC:this.prevCC,new:!0},this.prevCC=a.cc),p&&p.textCodec===Ya?this._parseIMSC1(a,l):this._parseVTTs(n)}}else this.hls.trigger(y.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:a,error:new Error("Empty subtitle payload")})}_parseIMSC1(t,n){const a=this.hls;Iu(n,this.initPTS[t.cc],l=>{this._appendCues(l,t.level),a.trigger(y.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})},l=>{T.log(`Failed to parse IMSC1: ${l}`),a.trigger(y.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t,error:l})})}_parseVTTs(t){var n;const{frag:a,payload:l}=t,{initPTS:u,unparsedVttFrags:c}=this,p=u.length-1;if(!u[a.cc]&&p===-1){c.push(t);return}const v=this.hls,A=(n=a.initSegment)!=null&&n.data?hn(a.initSegment.data,new Uint8Array(l)):l;Nl(A,this.initPTS[a.cc],this.vttCCs,a.cc,a.start,C=>{this._appendCues(C,a.level),v.trigger(y.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:a})},C=>{const O=C.message==="Missing initPTS for VTT MPEGTS";O?c.push(t):this._fallbackToIMSC1(a,l),T.log(`Failed to parse VTT cue: ${C}`),!(O&&p>a.cc)&&v.trigger(y.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:a,error:C})})}_fallbackToIMSC1(t,n){const a=this.tracks[t.level];a.textCodec||Iu(n,this.initPTS[t.cc],()=>{a.textCodec=Ya,this._parseIMSC1(t,n)},()=>{a.textCodec="wvtt"})}_appendCues(t,n){const a=this.hls;if(this.config.renderTextTracksNatively){const l=this.textTracks[n];if(!l||l.mode==="disabled")return;t.forEach(u=>bi(l,u))}else{const l=this.tracks[n];if(!l)return;const u=l.default?"default":"subtitles"+n;a.trigger(y.CUES_PARSED,{type:"subtitles",cues:t,track:u})}}onFragDecrypted(t,n){const{frag:a}=n;a.type===Gt.SUBTITLE&&this.onFragLoaded(y.FRAG_LOADED,n)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(t,n){const{cea608Parser1:a,cea608Parser2:l}=this;if(!this.enabled||!(a&&l))return;const{frag:u,samples:c}=n;if(!(u.type===Gt.MAIN&&this.closedCaptionsForLevel(u)==="NONE"))for(let p=0;p<c.length;p++){const v=c[p].bytes;if(v){const A=this.extractCea608Data(v);a.addData(c[p].pts,A[0]),l.addData(c[p].pts,A[1])}}}onBufferFlushing(t,{startOffset:n,endOffset:a,endOffsetSubtitles:l,type:u}){const{media:c}=this;if(!(!c||c.currentTime<a)){if(!u||u==="video"){const{captionsTracks:p}=this;Object.keys(p).forEach(v=>Xr(p[v],n,a))}if(this.config.renderTextTracksNatively&&n===0&&l!==void 0){const{textTracks:p}=this;Object.keys(p).forEach(v=>Xr(p[v],n,l))}}}extractCea608Data(t){const n=[[],[]],a=t[0]&31;let l=2;for(let u=0;u<a;u++){const c=t[l++],p=127&t[l++],v=127&t[l++];if(p===0&&v===0)continue;if((4&c)!=0){const C=3&c;(C===0||C===1)&&(n[C].push(p),n[C].push(v))}}return n}}function Ks(f,t){return!!f&&f.label===t.name&&!(f.textTrack1||f.textTrack2)}function $l(f,t,n,a){return Math.min(t,a)-Math.max(f,n)}function Xa(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class Vl{constructor(t){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=t,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(t){this.streamController=t}destroy(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:t}=this;t.on(y.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.on(y.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(y.MANIFEST_PARSED,this.onManifestParsed,this),t.on(y.BUFFER_CODECS,this.onBufferCodecs,this),t.on(y.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:t}=this;t.off(y.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.off(y.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(y.MANIFEST_PARSED,this.onManifestParsed,this),t.off(y.BUFFER_CODECS,this.onBufferCodecs,this),t.off(y.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(t,n){const a=this.hls.levels[n.droppedLevel];this.isLevelAllowed(a)&&this.restrictedLevels.push({bitrate:a.bitrate,height:a.height,width:a.width})}onMediaAttaching(t,n){this.media=n.media instanceof HTMLVideoElement?n.media:null,this.clientRect=null}onManifestParsed(t,n){const a=this.hls;this.restrictedLevels=[],this.firstLevel=n.firstLevel,a.config.capLevelToPlayerSize&&n.video&&this.startCapping()}onBufferCodecs(t,n){this.hls.config.capLevelToPlayerSize&&n.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){const t=this.hls.levels;if(t.length){const n=this.hls;n.autoLevelCapping=this.getMaxLevel(t.length-1),n.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=n.autoLevelCapping}}}getMaxLevel(t){const n=this.hls.levels;if(!n.length)return-1;const a=n.filter((l,u)=>this.isLevelAllowed(l)&&u<=t);return this.clientRect=null,Vl.getMaxLevelByMediaSize(a,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const t=this.media,n={width:0,height:0};if(t){const a=t.getBoundingClientRect();n.width=a.width,n.height=a.height,!n.width&&!n.height&&(n.width=a.right-a.left||t.width||0,n.height=a.bottom-a.top||t.height||0)}return this.clientRect=n,n}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let t=1;if(!this.hls.config.ignoreDevicePixelRatio)try{t=self.devicePixelRatio}catch(n){}return t}isLevelAllowed(t){return!this.restrictedLevels.some(a=>t.bitrate===a.bitrate&&t.width===a.width&&t.height===a.height)}static getMaxLevelByMediaSize(t,n,a){if(!(t!=null&&t.length))return-1;const l=(c,p)=>p?c.width!==p.width||c.height!==p.height:!0;let u=t.length-1;for(let c=0;c<t.length;c+=1){const p=t[c];if((p.width>=n||p.height>=a)&&l(p,t[c+1])){u=c;break}}return u}}class Bd{constructor(t){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=t,this.registerListeners()}setStreamController(t){this.streamController=t}registerListeners(){this.hls.on(y.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(y.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(t,n){const a=this.hls.config;if(a.capLevelOnFPSDrop){const l=n.media instanceof self.HTMLVideoElement?n.media:null;this.media=l,l&&typeof l.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),a.fpsDroppedMonitoringPeriod)}}checkFPS(t,n,a){const l=performance.now();if(n){if(this.lastTime){const u=l-this.lastTime,c=a-this.lastDroppedFrames,p=n-this.lastDecodedFrames,v=1e3*c/u,A=this.hls;if(A.trigger(y.FPS_DROP,{currentDropped:c,currentDecoded:p,totalDroppedFrames:a}),v>0&&c>A.config.fpsDroppedMonitoringThreshold*p){let C=A.currentLevel;T.warn("drop FPS ratio greater than max allowed value for currentLevel: "+C),C>0&&(A.autoLevelCapping===-1||A.autoLevelCapping>=C)&&(C=C-1,A.trigger(y.FPS_DROP_LEVEL_CAPPING,{level:C,droppedLevel:A.currentLevel}),A.autoLevelCapping=C,this.streamController.nextLevelSwitch())}}this.lastTime=l,this.lastDroppedFrames=a,this.lastDecodedFrames=n}}checkFPSInterval(){const t=this.media;if(t)if(this.isVideoPlaybackQualityAvailable){const n=t.getVideoPlaybackQuality();this.checkFPS(t,n.totalVideoFrames,n.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)}}const Vo="[eme]";class Ea{constructor(t){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=Ea.CDMCleanupPromise?[Ea.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=T.debug.bind(T,Vo),this.log=T.log.bind(T,Vo),this.warn=T.warn.bind(T,Vo),this.error=T.error.bind(T,Vo),this.hls=t,this.config=t.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const t=this.config;t.requestMediaKeySystemAccessFunc=null,t.licenseXhrSetup=t.licenseResponseCallback=void 0,t.drmSystems=t.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(y.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(y.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(y.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(y.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(y.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(y.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(y.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(y.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(t){const{drmSystems:n,widevineLicenseUrl:a}=this.config,l=n[t];if(l)return l.licenseUrl;if(t===nt.WIDEVINE&&a)return a;throw new Error(`no license server URL configured for key-system "${t}"`)}getServerCertificateUrl(t){const{drmSystems:n}=this.config,a=n[t];if(a)return a.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${t}"]`)}attemptKeySystemAccess(t){const n=this.hls.levels,a=(c,p,v)=>!!c&&v.indexOf(c)===p,l=n.map(c=>c.audioCodec).filter(a),u=n.map(c=>c.videoCodec).filter(a);return l.length+u.length===0&&u.push("avc1.42e01e"),new Promise((c,p)=>{const v=A=>{const C=A.shift();this.getMediaKeysPromise(C,l,u).then(O=>c({keySystem:C,mediaKeys:O})).catch(O=>{A.length?v(A):O instanceof lr?p(O):p(new lr({type:$.KEY_SYSTEM_ERROR,details:D.KEY_SYSTEM_NO_ACCESS,error:O,fatal:!0},O.message))})};v(t)})}requestMediaKeySystemAccess(t,n){const{requestMediaKeySystemAccessFunc:a}=this.config;if(typeof a!="function"){let l=`Configured requestMediaKeySystemAccess is not a function ${a}`;return _i===null&&self.location.protocol==="http:"&&(l=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(l))}return a(t,n)}getMediaKeysPromise(t,n,a){const l=yi(t,n,a,this.config.drmSystemOptions),u=this.keySystemAccessPromises[t];let c=u==null?void 0:u.keySystemAccess;if(!c){this.log(`Requesting encrypted media "${t}" key-system access with config: ${JSON.stringify(l)}`),c=this.requestMediaKeySystemAccess(t,l);const p=this.keySystemAccessPromises[t]={keySystemAccess:c};return c.catch(v=>{this.log(`Failed to obtain access to key-system "${t}": ${v}`)}),c.then(v=>{this.log(`Access for key-system "${v.keySystem}" obtained`);const A=this.fetchServerCertificate(t);return this.log(`Create media-keys for "${t}"`),p.mediaKeys=v.createMediaKeys().then(C=>(this.log(`Media-keys created for "${t}"`),A.then(O=>O?this.setMediaKeysServerCertificate(C,t,O):C))),p.mediaKeys.catch(C=>{this.error(`Failed to create media-keys for "${t}"}: ${C}`)}),p.mediaKeys})}return c.then(()=>u.mediaKeys)}createMediaKeySessionContext({decryptdata:t,keySystem:n,mediaKeys:a}){this.log(`Creating key-system session "${n}" keyId: ${ht.hexDump(t.keyId||[])}`);const l=a.createSession(),u={decryptdata:t,keySystem:n,mediaKeys:a,mediaKeysSession:l,keyStatus:"status-pending"};return this.mediaKeySessions.push(u),u}renewKeySession(t){const n=t.decryptdata;if(n.pssh){const a=this.createMediaKeySessionContext(t),l=this.getKeyIdString(n),u="cenc";this.keyIdToKeySessionPromise[l]=this.generateRequestWithPreferredKeySession(a,u,n.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(t)}getKeyIdString(t){if(!t)throw new Error("Could not read keyId of undefined decryptdata");if(t.keyId===null)throw new Error("keyId is null");return ht.hexDump(t.keyId)}updateKeySession(t,n){var a;const l=t.mediaKeysSession;return this.log(`Updating key-session "${l.sessionId}" for keyID ${ht.hexDump(((a=t.decryptdata)==null?void 0:a.keyId)||[])}
      } (data length: ${n&&n.byteLength})`),l.update(n)}selectKeySystemFormat(t){const n=Object.keys(t.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${t.sn} ${t.type}: ${t.level}) key formats ${n.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(n)),this.keyFormatPromise}getKeyFormatPromise(t){return new Promise((n,a)=>{const l=Xt(this.config),u=t.map(ti).filter(c=>!!c&&l.indexOf(c)!==-1);return this.getKeySystemSelectionPromise(u).then(({keySystem:c})=>{const p=si(c);p?n(p):a(new Error(`Unable to find format for key-system "${c}"`))}).catch(a)})}loadKey(t){const n=t.keyInfo.decryptdata,a=this.getKeyIdString(n),l=`(keyId: ${a} format: "${n.keyFormat}" method: ${n.method} uri: ${n.uri})`;this.log(`Starting session for key ${l}`);let u=this.keyIdToKeySessionPromise[a];return u||(u=this.keyIdToKeySessionPromise[a]=this.getKeySystemForKeyPromise(n).then(({keySystem:c,mediaKeys:p})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${t.frag.sn} ${t.frag.type}: ${t.frag.level} using key ${l}`),this.attemptSetMediaKeys(c,p).then(()=>{this.throwIfDestroyed();const v=this.createMediaKeySessionContext({keySystem:c,mediaKeys:p,decryptdata:n}),A="cenc";return this.generateRequestWithPreferredKeySession(v,A,n.pssh,"playlist-key")}))),u.catch(c=>this.handleError(c))),u}throwIfDestroyed(t="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(t){!this.hls||(this.error(t.message),t instanceof lr?this.hls.trigger(y.ERROR,t.data):this.hls.trigger(y.ERROR,{type:$.KEY_SYSTEM_ERROR,details:D.KEY_SYSTEM_NO_KEYS,error:t,fatal:!0}))}getKeySystemForKeyPromise(t){const n=this.getKeyIdString(t),a=this.keyIdToKeySessionPromise[n];if(!a){const l=ti(t.keyFormat),u=l?[l]:Xt(this.config);return this.attemptKeySystemAccess(u)}return a}getKeySystemSelectionPromise(t){if(t.length||(t=Xt(this.config)),t.length===0)throw new lr({type:$.KEY_SYSTEM_ERROR,details:D.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(t)}_onMediaEncrypted(t){const{initDataType:n,initData:a}=t;if(this.debug(`"${t.type}" event: init data type: "${n}"`),a===null)return;let l,u;if(n==="sinf"&&this.config.drmSystems[nt.FAIRPLAY]){const C=ii(new Uint8Array(a));try{const O=Ne(JSON.parse(C).sinf),U=Wr(new Uint8Array(O));if(!U)return;l=U.subarray(8,24),u=nt.FAIRPLAY}catch(O){this.warn('Failed to parse sinf "encrypted" event message initData');return}}else{const C=Ai(a);if(C===null)return;C.version===0&&C.systemId===bt.WIDEVINE&&C.data&&(l=C.data.subarray(8,24)),u=Vt(C.systemId)}if(!u||!l)return;const c=ht.hexDump(l),{keyIdToKeySessionPromise:p,mediaKeySessions:v}=this;let A=p[c];for(let C=0;C<v.length;C++){const O=v[C],U=O.decryptdata;if(U.pssh||!U.keyId)continue;const W=ht.hexDump(U.keyId);if(c===W||U.uri.replace(/-/g,"").indexOf(c)!==-1){A=p[W],delete p[W],U.pssh=new Uint8Array(a),U.keyId=l,A=p[c]=A.then(()=>this.generateRequestWithPreferredKeySession(O,n,a,"encrypted-event-key-match"));break}}A||(A=p[c]=this.getKeySystemSelectionPromise([u]).then(({keySystem:C,mediaKeys:O})=>{var U;this.throwIfDestroyed();const W=new zi("ISO-23001-7",c,(U=si(C))!=null?U:"");return W.pssh=new Uint8Array(a),W.keyId=l,this.attemptSetMediaKeys(C,O).then(()=>{this.throwIfDestroyed();const J=this.createMediaKeySessionContext({decryptdata:W,keySystem:C,mediaKeys:O});return this.generateRequestWithPreferredKeySession(J,n,a,"encrypted-event-no-match")})})),A.catch(C=>this.handleError(C))}_onWaitingForKey(t){this.log(`"${t.type}" event`)}attemptSetMediaKeys(t,n){const a=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${t}"`);const l=Promise.all(a).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(n)});return this.setMediaKeysQueue.push(l),l.then(()=>{this.log(`Media-keys set for "${t}"`),a.push(l),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(u=>a.indexOf(u)===-1)})}generateRequestWithPreferredKeySession(t,n,a,l){var u,c;const p=(u=this.config.drmSystems)==null||(c=u[t.keySystem])==null?void 0:c.generateRequest;if(p)try{const U=p.call(this.hls,n,a,t);if(!U)throw new Error("Invalid response from configured generateRequest filter");n=U.initDataType,a=t.decryptdata.pssh=U.initData?new Uint8Array(U.initData):null}catch(U){var v;if(this.warn(U.message),(v=this.hls)!=null&&v.config.debug)throw U}if(a===null)return this.log(`Skipping key-session request for "${l}" (no initData)`),Promise.resolve(t);const A=this.getKeyIdString(t.decryptdata);this.log(`Generating key-session request for "${l}": ${A} (init data type: ${n} length: ${a?a.byteLength:null})`);const C=new ya;t.mediaKeysSession.onmessage=U=>{const W=t.mediaKeysSession;if(!W){C.emit("error",new Error("invalid state"));return}const{messageType:J,message:oe}=U;this.log(`"${J}" message event for session "${W.sessionId}" message size: ${oe.byteLength}`),J==="license-request"||J==="license-renewal"?this.renewLicense(t,oe).catch(he=>{this.handleError(he),C.emit("error",he)}):J==="license-release"?t.keySystem===nt.FAIRPLAY&&(this.updateKeySession(t,It("acknowledged")),this.removeSession(t)):this.warn(`unhandled media key message type "${J}"`)},t.mediaKeysSession.onkeystatuseschange=U=>{if(!t.mediaKeysSession){C.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(t);const J=t.keyStatus;C.emit("keyStatus",J),J==="expired"&&(this.warn(`${t.keySystem} expired for key ${A}`),this.renewKeySession(t))};const O=new Promise((U,W)=>{C.on("error",W),C.on("keyStatus",J=>{J.startsWith("usable")?U():J==="output-restricted"?W(new lr({type:$.KEY_SYSTEM_ERROR,details:D.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):J==="internal-error"?W(new lr({type:$.KEY_SYSTEM_ERROR,details:D.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${J}"`)):J==="expired"?W(new Error("key expired while generating request")):this.warn(`unhandled key status change "${J}"`)})});return t.mediaKeysSession.generateRequest(n,a).then(()=>{var U;this.log(`Request generated for key-session "${(U=t.mediaKeysSession)==null?void 0:U.sessionId}" keyId: ${A}`)}).catch(U=>{throw new lr({type:$.KEY_SYSTEM_ERROR,details:D.KEY_SYSTEM_NO_SESSION,error:U,fatal:!1},`Error generating key-session request: ${U}`)}).then(()=>O).catch(U=>{throw C.removeAllListeners(),this.removeSession(t),U}).then(()=>(C.removeAllListeners(),t))}onKeyStatusChange(t){t.mediaKeysSession.keyStatuses.forEach((n,a)=>{this.log(`key status change "${n}" for keyStatuses keyId: ${ht.hexDump("buffer"in a?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):new Uint8Array(a))} session keyId: ${ht.hexDump(new Uint8Array(t.decryptdata.keyId||[]))} uri: ${t.decryptdata.uri}`),t.keyStatus=n})}fetchServerCertificate(t){const n=this.config,a=n.loader,l=new a(n),u=this.getServerCertificateUrl(t);return u?(this.log(`Fetching serverCertificate for "${t}"`),new Promise((c,p)=>{const v={responseType:"arraybuffer",url:u},A=n.certLoadPolicy.default,C={loadPolicy:A,timeout:A.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},O={onSuccess:(U,W,J,oe)=>{c(U.data)},onError:(U,W,J,oe)=>{p(new lr({type:$.KEY_SYSTEM_ERROR,details:D.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:J,response:tt({url:v.url,data:void 0},U)},`"${t}" certificate request failed (${u}). Status: ${U.code} (${U.text})`))},onTimeout:(U,W,J)=>{p(new lr({type:$.KEY_SYSTEM_ERROR,details:D.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:J,response:{url:v.url,data:void 0}},`"${t}" certificate request timed out (${u})`))},onAbort:(U,W,J)=>{p(new Error("aborted"))}};l.load(v,C,O)})):Promise.resolve()}setMediaKeysServerCertificate(t,n,a){return new Promise((l,u)=>{t.setServerCertificate(a).then(c=>{this.log(`setServerCertificate ${c?"success":"not supported by CDM"} (${a==null?void 0:a.byteLength}) on "${n}"`),l(t)}).catch(c=>{u(new lr({type:$.KEY_SYSTEM_ERROR,details:D.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:c,fatal:!0},c.message))})})}renewLicense(t,n){return this.requestLicense(t,new Uint8Array(n)).then(a=>this.updateKeySession(t,new Uint8Array(a)).catch(l=>{throw new lr({type:$.KEY_SYSTEM_ERROR,details:D.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:l,fatal:!0},l.message)}))}setupLicenseXHR(t,n,a,l){const u=this.config.licenseXhrSetup;return u?Promise.resolve().then(()=>{if(!a.decryptdata)throw new Error("Key removed");return u.call(this.hls,t,n,a,l)}).catch(c=>{if(!a.decryptdata)throw c;return t.open("POST",n,!0),u.call(this.hls,t,n,a,l)}).then(c=>(t.readyState||t.open("POST",n,!0),{xhr:t,licenseChallenge:c||l})):(t.open("POST",n,!0),Promise.resolve({xhr:t,licenseChallenge:l}))}requestLicense(t,n){const a=this.config.keyLoadPolicy.default;return new Promise((l,u)=>{const c=this.getLicenseServerUrl(t.keySystem);this.log(`Sending license request to URL: ${c}`);const p=new XMLHttpRequest;p.responseType="arraybuffer",p.onreadystatechange=()=>{if(!this.hls||!t.mediaKeysSession)return u(new Error("invalid state"));if(p.readyState===4)if(p.status===200){this._requestLicenseFailureCount=0;let v=p.response;this.log(`License received ${v instanceof ArrayBuffer?v.byteLength:v}`);const A=this.config.licenseResponseCallback;if(A)try{v=A.call(this.hls,p,c,t)}catch(C){this.error(C)}l(v)}else{const v=a.errorRetry,A=v?v.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>A||p.status>=400&&p.status<500)u(new lr({type:$.KEY_SYSTEM_ERROR,details:D.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:p,response:{url:c,data:void 0,code:p.status,text:p.statusText}},`License Request XHR failed (${c}). Status: ${p.status} (${p.statusText})`));else{const C=A-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${C} attempts left`),this.requestLicense(t,n).then(l,u)}}},t.licenseXhr&&t.licenseXhr.readyState!==XMLHttpRequest.DONE&&t.licenseXhr.abort(),t.licenseXhr=p,this.setupLicenseXHR(p,c,t,n).then(({xhr:v,licenseChallenge:A})=>{v.send(A)})})}onMediaAttached(t,n){if(!this.config.emeEnabled)return;const a=n.media;this.media=a,a.addEventListener("encrypted",this.onMediaEncrypted),a.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const t=this.media,n=this.mediaKeySessions;t&&(t.removeEventListener("encrypted",this.onMediaEncrypted),t.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},zi.clearKeyUriToKeyIdMap();const a=n.length;Ea.CDMCleanupPromise=Promise.all(n.map(l=>this.removeSession(l)).concat(t==null?void 0:t.setMediaKeys(null).catch(l=>{this.log(`Could not clear media keys: ${l}. media.src: ${t==null?void 0:t.src}`)}))).then(()=>{a&&(this.log("finished closing key sessions and clearing media keys"),n.length=0)}).catch(l=>{this.log(`Could not close sessions and clear media keys: ${l}. media.src: ${t==null?void 0:t.src}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(t,{sessionKeys:n}){if(!(!n||!this.config.emeEnabled)&&!this.keyFormatPromise){const a=n.reduce((l,u)=>(l.indexOf(u.keyFormat)===-1&&l.push(u.keyFormat),l),[]);this.log(`Selecting key-system from session-keys ${a.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(a)}}removeSession(t){const{mediaKeysSession:n,licenseXhr:a}=t;if(n){this.log(`Remove licenses and keys and close session ${n.sessionId}`),n.onmessage=null,n.onkeystatuseschange=null,a&&a.readyState!==XMLHttpRequest.DONE&&a.abort(),t.mediaKeysSession=t.decryptdata=t.licenseXhr=void 0;const l=this.mediaKeySessions.indexOf(t);return l>-1&&this.mediaKeySessions.splice(l,1),n.remove().catch(u=>{this.log(`Could not remove session: ${u}`)}).then(()=>n.close()).catch(u=>{this.log(`Could not close session: ${u}`)})}}}Ea.CDMCleanupPromise=void 0;class lr extends Error{constructor(t,n){super(n);this.data=void 0,t.error||(t.error=new Error(n)),this.data=t,t.err=t.error}}const Pu=1;var Hn={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"};const Md="h";class us{constructor(t){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=l=>{try{this.apply(l,{ot:Hn.MANIFEST,su:!this.initialized})}catch(u){T.warn("Could not generate manifest CMCD data.",u)}},this.applyFragmentData=l=>{try{const u=l.frag,c=this.hls.levels[u.level],p=this.getObjectType(u),v={d:u.duration*1e3,ot:p};(p===Hn.VIDEO||p===Hn.AUDIO||p==Hn.MUXED)&&(v.br=c.bitrate/1e3,v.tb=this.getTopBandwidth(p)/1e3,v.bl=this.getBufferLength(p)),this.apply(l,v)}catch(u){T.warn("Could not generate segment CMCD data.",u)}},this.hls=t;const n=this.config=t.config,{cmcd:a}=n;a!=null&&(n.pLoader=this.createPlaylistLoader(),n.fLoader=this.createFragmentLoader(),this.sid=a.sessionId||us.uuid(),this.cid=a.contentId,this.useHeaders=a.useHeaders===!0,this.registerListeners())}registerListeners(){const t=this.hls;t.on(y.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(y.MEDIA_DETACHED,this.onMediaDetached,this),t.on(y.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const t=this.hls;t.off(y.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(y.MEDIA_DETACHED,this.onMediaDetached,this),t.off(y.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null}onMediaAttached(t,n){this.media=n.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){!this.media||(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(t,n){var a,l;this.audioBuffer=(a=n.tracks.audio)==null?void 0:a.buffer,this.videoBuffer=(l=n.tracks.video)==null?void 0:l.buffer}createData(){var t;return{v:Pu,sf:Md,sid:this.sid,cid:this.cid,pr:(t=this.media)==null?void 0:t.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(t,n={}){Ee(n,this.createData());const a=n.ot===Hn.INIT||n.ot===Hn.VIDEO||n.ot===Hn.MUXED;if(this.starved&&a&&(n.bs=!0,n.su=!0,this.starved=!1),n.su==null&&(n.su=this.buffering),this.useHeaders){const l=us.toHeaders(n);if(!Object.keys(l).length)return;t.headers||(t.headers={}),Ee(t.headers,l)}else{const l=us.toQuery(n);if(!l)return;t.url=us.appendQueryToUri(t.url,l)}}getObjectType(t){const{type:n}=t;if(n==="subtitle")return Hn.TIMED_TEXT;if(t.sn==="initSegment")return Hn.INIT;if(n==="audio")return Hn.AUDIO;if(n==="main")return this.hls.audioTracks.length?Hn.VIDEO:Hn.MUXED}getTopBandwidth(t){let n=0,a;const l=this.hls;if(t===Hn.AUDIO)a=l.audioTracks;else{const u=l.maxAutoLevel,c=u>-1?u+1:l.levels.length;a=l.levels.slice(0,c)}for(const u of a)u.bitrate>n&&(n=u.bitrate);return n>0?n:NaN}getBufferLength(t){const n=this.hls.media,a=t===Hn.AUDIO?this.audioBuffer:this.videoBuffer;return!a||!n?NaN:ni.bufferInfo(a,n.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:t}=this.config,n=this.applyPlaylistData,a=t||this.config.loader;return class{constructor(u){this.loader=void 0,this.loader=new a(u)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(u,c,p){n(u),this.loader.load(u,c,p)}}}createFragmentLoader(){const{fLoader:t}=this.config,n=this.applyFragmentData,a=t||this.config.loader;return class{constructor(u){this.loader=void 0,this.loader=new a(u)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(u,c,p){n(u),this.loader.load(u,c,p)}}}static uuid(){const t=URL.createObjectURL(new Blob),n=t.toString();return URL.revokeObjectURL(t),n.slice(n.lastIndexOf("/")+1)}static serialize(t){const n=[],a=A=>!Number.isNaN(A)&&A!=null&&A!==""&&A!==!1,l=A=>Math.round(A),u=A=>l(A/100)*100,p={br:l,d:l,bl:u,dl:u,mtp:u,nor:A=>encodeURIComponent(A),rtp:u,tb:l},v=Object.keys(t||{}).sort();for(const A of v){let C=t[A];if(!a(C)||A==="v"&&C===1||A=="pr"&&C===1)continue;const O=p[A];O&&(C=O(C));const U=typeof C;let W;A==="ot"||A==="sf"||A==="st"?W=`${A}=${C}`:U==="boolean"?W=A:U==="number"?W=`${A}=${C}`:W=`${A}=${JSON.stringify(C)}`,n.push(W)}return n.join(",")}static toHeaders(t){const n=Object.keys(t),a={},l=["Object","Request","Session","Status"],u=[{},{},{},{}],c={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3};for(const p of n){const v=c[p]!=null?c[p]:1;u[v][p]=t[p]}for(let p=0;p<u.length;p++){const v=us.serialize(u[p]);v&&(a[`CMCD-${l[p]}`]=v)}return a}static toQuery(t){return`CMCD=${encodeURIComponent(us.serialize(t))}`}static appendQueryToUri(t,n){if(!n)return t;const a=t.includes("?")?"&":"?";return`${t}${a}${n}`}}const Hl=3e5;class Fd{constructor(t){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=t,this.log=T.log.bind(T,"[content-steering]:"),this.registerListeners()}registerListeners(){const t=this.hls;t.on(y.MANIFEST_LOADING,this.onManifestLoading,this),t.on(y.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(y.MANIFEST_PARSED,this.onManifestParsed,this),t.on(y.ERROR,this.onError,this)}unregisterListeners(){const t=this.hls;!t||(t.off(y.MANIFEST_LOADING,this.onManifestLoading,this),t.off(y.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(y.MANIFEST_PARSED,this.onManifestParsed,this),t.off(y.ERROR,this.onError,this))}startLoad(){if(this.started=!0,self.clearTimeout(this.reloadTimer),this.enabled&&this.uri)if(this.updated){const t=Math.max(this.timeToLoad*1e3-(performance.now()-this.updated),0);this.scheduleRefresh(this.uri,t)}else this.loadSteeringManifest(this.uri)}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),self.clearTimeout(this.reloadTimer)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(t){const n=this.levels;n&&(this.levels=n.filter(a=>a!==t))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(t,n){const{contentSteering:a}=n;a!==null&&(this.pathwayId=a.pathwayId,this.uri=a.uri,this.started&&this.startLoad())}onManifestParsed(t,n){this.audioTracks=n.audioTracks,this.subtitleTracks=n.subtitleTracks}onError(t,n){const{errorAction:a}=n;if((a==null?void 0:a.action)===yn.SendAlternateToPenaltyBox&&a.flags===zn.MoveAllAlternatesMatchingHost){let l=this.pathwayPriority;const u=this.pathwayId;this.penalizedPathways[u]||(this.penalizedPathways[u]=performance.now()),!l&&this.levels&&(l=this.levels.reduce((c,p)=>(c.indexOf(p.pathwayId)===-1&&c.push(p.pathwayId),c),[])),l&&l.length>1&&(this.updatePathwayPriority(l),a.resolved=this.pathwayId!==u)}}filterParsedLevels(t){this.levels=t;let n=this.getLevelsForPathway(this.pathwayId);if(n.length===0){const a=t[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${a}"`),n=this.getLevelsForPathway(a),this.pathwayId=a}return n.length!==t.length?(this.log(`Found ${n.length}/${t.length} levels in Pathway "${this.pathwayId}"`),n):t}getLevelsForPathway(t){return this.levels===null?[]:this.levels.filter(n=>t===n.pathwayId)}updatePathwayPriority(t){this.pathwayPriority=t;let n;const a=this.penalizedPathways,l=performance.now();Object.keys(a).forEach(u=>{l-a[u]>Hl&&delete a[u]});for(let u=0;u<t.length;u++){const c=t[u];if(a[c])continue;if(c===this.pathwayId)return;const p=this.hls.nextLoadLevel,v=this.hls.levels[p];if(n=this.getLevelsForPathway(c),n.length>0){this.log(`Setting Pathway to "${c}"`),this.pathwayId=c,this.hls.trigger(y.LEVELS_UPDATED,{levels:n});const A=this.hls.levels[p];v&&A&&this.levels&&(A.attrs["STABLE-VARIANT-ID"]!==v.attrs["STABLE-VARIANT-ID"]&&A.bitrate!==v.bitrate&&this.log(`Unstable Pathways change from bitrate ${v.bitrate} to ${A.bitrate}`),this.hls.nextLoadLevel=p);break}}}clonePathways(t){const n=this.levels;if(!n)return;const a={},l={};t.forEach(u=>{const{ID:c,"BASE-ID":p,"URI-REPLACEMENT":v}=u;if(n.some(C=>C.pathwayId===c))return;const A=this.getLevelsForPathway(p).map(C=>{const O=Ee({},C);O.details=void 0,O.url=Mu(C.uri,C.attrs["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",v);const U=new le(C.attrs);U["PATHWAY-ID"]=c;const W=U.AUDIO&&`${U.AUDIO}_clone_${c}`,J=U.SUBTITLES&&`${U.SUBTITLES}_clone_${c}`;W&&(a[U.AUDIO]=W,U.AUDIO=W),J&&(l[U.SUBTITLES]=J,U.SUBTITLES=J),O.attrs=U;const oe=new Ms(O);return oa(oe,"audio",W),oa(oe,"text",J),oe});n.push(...A),Bu(this.audioTracks,a,v,c),Bu(this.subtitleTracks,l,v,c)})}loadSteeringManifest(t){const n=this.hls.config,a=n.loader;this.loader&&this.loader.destroy(),this.loader=new a(n);let l;try{l=new self.URL(t)}catch(C){this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${t}`);return}if(l.protocol!=="data:"){const C=(this.hls.bandwidthEstimate||n.abrEwmaDefaultEstimate)|0;l.searchParams.set("_HLS_pathway",this.pathwayId),l.searchParams.set("_HLS_throughput",""+C)}const u={responseType:"json",url:l.href},c=n.steeringManifestLoadPolicy.default,p=c.errorRetry||c.timeoutRetry||{},v={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:p.maxNumRetry||0,retryDelay:p.retryDelayMs||0,maxRetryDelay:p.maxRetryDelayMs||0},A={onSuccess:(C,O,U,W)=>{this.log(`Loaded steering manifest: "${l}"`);const J=C.data;if(J.VERSION!==1){this.log(`Steering VERSION ${J.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=J.TTL;const{"RELOAD-URI":oe,"PATHWAY-CLONES":he,"PATHWAY-PRIORITY":we}=J;if(oe)try{this.uri=new self.URL(oe,l).href}catch(Fe){this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${oe}`);return}this.scheduleRefresh(this.uri||U.url),he&&this.clonePathways(he),we&&this.updatePathwayPriority(we)},onError:(C,O,U,W)=>{if(this.log(`Error loading steering manifest: ${C.code} ${C.text} (${O.url})`),this.stopLoad(),C.code===410){this.enabled=!1,this.log(`Steering manifest ${O.url} no longer available`);return}let J=this.timeToLoad*1e3;if(C.code===429){const oe=this.loader;if(typeof(oe==null?void 0:oe.getResponseHeader)=="function"){const he=oe.getResponseHeader("Retry-After");he&&(J=parseFloat(he)*1e3)}this.log(`Steering manifest ${O.url} rate limited`);return}this.scheduleRefresh(this.uri||O.url,J)},onTimeout:(C,O,U)=>{this.log(`Timeout loading steering manifest (${O.url})`),this.scheduleRefresh(this.uri||O.url)}};this.log(`Requesting steering manifest: ${l}`),this.loader.load(u,v,A)}scheduleRefresh(t,n=this.timeToLoad*1e3){self.clearTimeout(this.reloadTimer),this.reloadTimer=self.setTimeout(()=>{this.loadSteeringManifest(t)},n)}}function Bu(f,t,n,a){!f||Object.keys(t).forEach(l=>{const u=f.filter(c=>c.groupId===l).map(c=>{const p=Ee({},c);return p.details=void 0,p.attrs=new le(p.attrs),p.url=p.attrs.URI=Mu(c.url,c.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",n),p.groupId=p.attrs["GROUP-ID"]=t[l],p.attrs["PATHWAY-ID"]=a,p});f.push(...u)})}function Mu(f,t,n,a){const{HOST:l,PARAMS:u,[n]:c}=a;let p;t&&(p=c==null?void 0:c[t],p&&(f=p));const v=new self.URL(f);return l&&!p&&(v.host=l),u&&Object.keys(u).sort().forEach(A=>{A&&v.searchParams.set(A,u[A])}),v.href}const zs=/^age:\s*[\d.]+\s*$/im;class Fu{constructor(t){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=t&&t.xhrSetup||null,this.stats=new de,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null}abortInternal(){const t=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),t&&(t.onreadystatechange=null,t.onprogress=null,t.readyState!==4&&(this.stats.aborted=!0,t.abort()))}abort(){var t;this.abortInternal(),(t=this.callbacks)!=null&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(t,n,a){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=t,this.config=n,this.callbacks=a,this.loadInternal()}loadInternal(){const{config:t,context:n}=this;if(!t)return;const a=this.loader=new self.XMLHttpRequest,l=this.stats;l.loading.first=0,l.loaded=0,l.aborted=!1;const u=this.xhrSetup;u?Promise.resolve().then(()=>{if(!this.stats.aborted)return u(a,n.url)}).catch(c=>(a.open("GET",n.url,!0),u(a,n.url))).then(()=>{this.stats.aborted||this.openAndSendXhr(a,n,t)}).catch(c=>{this.callbacks.onError({code:a.status,text:c.message},n,a,l)}):this.openAndSendXhr(a,n,t)}openAndSendXhr(t,n,a){t.readyState||t.open("GET",n.url,!0);const l=this.context.headers,{maxTimeToFirstByteMs:u,maxLoadTimeMs:c}=a.loadPolicy;if(l)for(const p in l)t.setRequestHeader(p,l[p]);n.rangeEnd&&t.setRequestHeader("Range","bytes="+n.rangeStart+"-"+(n.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=n.responseType,self.clearTimeout(this.requestTimeout),a.timeout=u&&te(u)?u:c,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),a.timeout),t.send()}readystatechange(){const{context:t,loader:n,stats:a}=this;if(!t||!n)return;const l=n.readyState,u=this.config;if(!a.aborted&&l>=2&&(a.loading.first===0&&(a.loading.first=Math.max(self.performance.now(),a.loading.start),u.timeout!==u.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),u.timeout=u.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),u.loadPolicy.maxLoadTimeMs-(a.loading.first-a.loading.start)))),l===4)){self.clearTimeout(this.requestTimeout),n.onreadystatechange=null,n.onprogress=null;const c=n.status,p=n.responseType!=="text";if(c>=200&&c<300&&(p&&n.response||n.responseText!==null)){a.loading.end=Math.max(self.performance.now(),a.loading.first);const v=p?n.response:n.responseText,A=n.responseType==="arraybuffer"?v.byteLength:v.length;if(a.loaded=a.total=A,a.bwEstimate=a.total*8e3/(a.loading.end-a.loading.first),!this.callbacks)return;const C=this.callbacks.onProgress;if(C&&C(a,t,v,n),!this.callbacks)return;const O={url:n.responseURL,data:v,code:c};this.callbacks.onSuccess(O,a,t,n)}else{const v=u.loadPolicy.errorRetry,A=a.retry;ps(v,A,!1,c)?this.retry(v):(T.error(`${c} while loading ${t.url}`),this.callbacks.onError({code:c,text:n.statusText},t,n,a))}}}loadtimeout(){var t;const n=(t=this.config)==null?void 0:t.loadPolicy.timeoutRetry,a=this.stats.retry;if(ps(n,a,!0))this.retry(n);else{T.warn(`timeout while loading ${this.context.url}`);const l=this.callbacks;l&&(this.abortInternal(),l.onTimeout(this.stats,this.context,this.loader))}}retry(t){const{context:n,stats:a}=this;this.retryDelay=vo(t,a.retry),a.retry++,T.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${n.url}, retrying ${a.retry}/${t.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(t){const n=this.stats;n.loaded=t.loaded,t.lengthComputable&&(n.total=t.total)}getCacheAge(){let t=null;if(this.loader&&zs.test(this.loader.getAllResponseHeaders())){const n=this.loader.getResponseHeader("age");t=n?parseFloat(n):null}return t}getResponseHeader(t){return this.loader&&new RegExp(`^${t}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(t):null}}function Ho(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(f){}return!1}const Nd=/(\d+)-(\d+)\/(\d+)/;class Gl{constructor(t){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=t.fetchSetup||Go,this.controller=new self.AbortController,this.stats=new de}destroy(){this.loader=this.callbacks=null,this.abortInternal()}abortInternal(){const t=this.response;t!=null&&t.ok||(this.stats.aborted=!0,this.controller.abort())}abort(){var t;this.abortInternal(),(t=this.callbacks)!=null&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(t,n,a){const l=this.stats;if(l.loading.start)throw new Error("Loader can only be used once.");l.loading.start=self.performance.now();const u=Nu(t,this.controller.signal),c=a.onProgress,p=t.responseType==="arraybuffer",v=p?"byteLength":"length",{maxTimeToFirstByteMs:A,maxLoadTimeMs:C}=n.loadPolicy;this.context=t,this.config=n,this.callbacks=a,this.request=this.fetchSetup(t,u),self.clearTimeout(this.requestTimeout),n.timeout=A&&te(A)?A:C,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),a.onTimeout(l,t,this.response)},n.timeout),self.fetch(this.request).then(O=>{this.response=this.loader=O;const U=Math.max(self.performance.now(),l.loading.start);if(self.clearTimeout(this.requestTimeout),n.timeout=C,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),a.onTimeout(l,t,this.response)},C-(U-l.loading.start)),!O.ok){const{status:W,statusText:J}=O;throw new ql(J||"fetch, bad network response",W,O)}return l.loading.first=U,l.total=jd(O.headers)||l.total,c&&te(n.highWaterMark)?this.loadProgressively(O,l,t,n.highWaterMark,c):p?O.arrayBuffer():t.responseType==="json"?O.json():O.text()}).then(O=>{const{response:U}=this;self.clearTimeout(this.requestTimeout),l.loading.end=Math.max(self.performance.now(),l.loading.first);const W=O[v];W&&(l.loaded=l.total=W);const J={url:U.url,data:O,code:U.status};c&&!te(n.highWaterMark)&&c(l,t,O,U),a.onSuccess(J,l,t,U)}).catch(O=>{if(self.clearTimeout(this.requestTimeout),l.aborted)return;const U=O&&O.code||0,W=O?O.message:null;a.onError({code:U,text:W},t,O?O.details:null,l)})}getCacheAge(){let t=null;if(this.response){const n=this.response.headers.get("age");t=n?parseFloat(n):null}return t}getResponseHeader(t){return this.response?this.response.headers.get(t):null}loadProgressively(t,n,a,l=0,u){const c=new yu,p=t.body.getReader(),v=()=>p.read().then(A=>{if(A.done)return c.dataLength&&u(n,a,c.flush(),t),Promise.resolve(new ArrayBuffer(0));const C=A.value,O=C.length;return n.loaded+=O,O<l||c.dataLength?(c.push(C),c.dataLength>=l&&u(n,a,c.flush(),t)):u(n,a,C,t),v()}).catch(()=>Promise.reject());return v()}}function Nu(f,t){const n={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(Ee({},f.headers))};return f.rangeEnd&&n.headers.set("Range","bytes="+f.rangeStart+"-"+String(f.rangeEnd-1)),n}function Ud(f){const t=Nd.exec(f);if(t)return parseInt(t[2])-parseInt(t[1])+1}function jd(f){const t=f.get("Content-Range");if(t){const a=Ud(t);if(te(a))return a}const n=f.get("Content-Length");if(n)return parseInt(n)}function Go(f,t){return new self.Request(f.url,t)}class ql extends Error{constructor(t,n,a){super(t);this.code=void 0,this.details=void 0,this.code=n,this.details=a}}const ur=/\s/,Uu={newCue(f,t,n,a){const l=[];let u,c,p,v,A;const C=self.VTTCue||self.TextTrackCue;for(let U=0;U<a.rows.length;U++)if(u=a.rows[U],p=!0,v=0,A="",!u.isEmpty()){var O;for(let oe=0;oe<u.chars.length;oe++)ur.test(u.chars[oe].uchar)&&p?v++:(A+=u.chars[oe].uchar,p=!1);u.cueStartTime=t,t===n&&(n+=1e-4),v>=16?v--:v++;const W=Lu(A.trim()),J=Fl(t,n,W);f!=null&&(O=f.cues)!=null&&O.getCueById(J)||(c=new C(t,n,W),c.id=J,c.line=U+1,c.align="left",c.position=10+Math.min(80,Math.floor(v*8/32)*10),l.push(c))}return f&&l.length&&(l.sort((U,W)=>U.line==="auto"||W.line==="auto"?0:U.line>8&&W.line>8?W.line-U.line:U.line-W.line),l.forEach(U=>bi(f,U))),l}},$d={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},Wl=tt(tt({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:Infinity,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:Infinity,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Fu,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:gu,bufferController:xu,capLevelController:Vl,errorController:Ci,fpsController:Bd,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:_i,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,certLoadPolicy:{default:$d},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:Infinity,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},Qa()),{},{subtitleStreamController:Au,subtitleTrackController:kl,timelineController:Zt,audioStreamController:Po,audioTrackController:ss,emeController:Ea,cmcdController:us,contentSteeringController:Fd});function Qa(){return{cueHandler:Uu,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function ju(f,t){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(t.liveMaxLatencyDurationCount!==void 0&&(t.liveSyncDurationCount===void 0||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(t.liveMaxLatencyDuration!==void 0&&(t.liveSyncDuration===void 0||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const n=Kl(f),a=["manifest","level","frag"],l=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return a.forEach(u=>{const c=`${u==="level"?"playlist":u}LoadPolicy`,p=t[c]===void 0,v=[];l.forEach(A=>{const C=`${u}Loading${A}`,O=t[C];if(O!==void 0&&p){v.push(C);const U=n[c].default;switch(t[c]={default:U},A){case"TimeOut":U.maxLoadTimeMs=O,U.maxTimeToFirstByteMs=O;break;case"MaxRetry":U.errorRetry.maxNumRetry=O,U.timeoutRetry.maxNumRetry=O;break;case"RetryDelay":U.errorRetry.retryDelayMs=O,U.timeoutRetry.retryDelayMs=O;break;case"MaxRetryTimeout":U.errorRetry.maxRetryDelayMs=O,U.timeoutRetry.maxRetryDelayMs=O;break}}}),v.length&&T.warn(`hls.js config: "${v.join('", "')}" setting(s) are deprecated, use "${c}": ${JSON.stringify(t[c])}`)}),tt(tt({},n),t)}function Kl(f){return f&&typeof f=="object"?Array.isArray(f)?f.map(Kl):Object.keys(f).reduce((t,n)=>(t[n]=Kl(f[n]),t),{}):f}function Vd(f){const t=f.loader;t!==Gl&&t!==Fu?(T.log("[config]: Custom loader detected, cannot enable progressive streaming"),f.progressive=!1):Ho()&&(f.loader=Gl,f.progressive=!0,f.enableSoftwareAES=!0,T.log("[config]: Progressive streaming enabled, using FetchLoader"))}class ln{static get version(){return"1.4.13"}static isSupported(){return Sl()}static get Events(){return y}static get ErrorTypes(){return $}static get ErrorDetails(){return D}static get DefaultConfig(){return ln.defaultConfig?ln.defaultConfig:Wl}static set DefaultConfig(t){ln.defaultConfig=t}constructor(t={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new ya,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,V(t.debug||!1,"Hls instance");const n=this.config=ju(ln.DefaultConfig,t);this.userConfig=t,this._autoLevelCapping=-1,n.progressive&&Vd(n);const{abrController:a,bufferController:l,capLevelController:u,errorController:c,fpsController:p}=n,v=new c(this),A=this.abrController=new a(this),C=this.bufferController=new l(this),O=this.capLevelController=new u(this),U=new p(this),W=new nl(this),J=new Ba(this),oe=n.contentSteeringController,he=oe?new oe(this):null,we=this.levelController=new Ao(this,he),Fe=new Al(this),Me=new xo(this.config),it=this.streamController=new ar(this,Fe,Me);O.setStreamController(it),U.setStreamController(it);const We=[W,we,it];he&&We.splice(1,0,he),this.networkControllers=We;const St=[A,C,O,U,J,Fe];this.audioTrackController=this.createController(n.audioTrackController,We);const ut=n.audioStreamController;ut&&We.push(new ut(this,Fe,Me)),this.subtitleTrackController=this.createController(n.subtitleTrackController,We);const gt=n.subtitleStreamController;gt&&We.push(new gt(this,Fe,Me)),this.createController(n.timelineController,St),Me.emeController=this.emeController=this.createController(n.emeController,St),this.cmcdController=this.createController(n.cmcdController,St),this.latencyController=this.createController(al,St),this.coreComponents=St,We.push(v);const Ct=v.onErrorOut;typeof Ct=="function"&&this.on(y.ERROR,Ct,v)}createController(t,n){if(t){const a=new t(this);return n&&n.push(a),a}return null}on(t,n,a=this){this._emitter.on(t,n,a)}once(t,n,a=this){this._emitter.once(t,n,a)}removeAllListeners(t){this._emitter.removeAllListeners(t)}off(t,n,a=this,l){this._emitter.off(t,n,a,l)}listeners(t){return this._emitter.listeners(t)}emit(t,n,a){return this._emitter.emit(t,n,a)}trigger(t,n){if(this.config.debug)return this.emit(t,t,n);try{return this.emit(t,t,n)}catch(a){T.error("An internal error happened while handling event "+t+'. Error message: "'+a.message+'". Here is a stacktrace:',a),this.trigger(y.ERROR,{type:$.OTHER_ERROR,details:D.INTERNAL_EXCEPTION,fatal:!1,event:t,error:a})}return!1}listenerCount(t){return this._emitter.listenerCount(t)}destroy(){T.log("destroy"),this.trigger(y.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(n=>n.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(n=>n.destroy()),this.coreComponents.length=0;const t=this.config;t.xhrSetup=t.fetchSetup=void 0,this.userConfig=null}attachMedia(t){T.log("attachMedia"),this._media=t,this.trigger(y.MEDIA_ATTACHING,{media:t})}detachMedia(){T.log("detachMedia"),this.trigger(y.MEDIA_DETACHING,void 0),this._media=null}loadSource(t){this.stopLoad();const n=this.media,a=this.url,l=this.url=Ze.buildAbsoluteURL(self.location.href,t,{alwaysNormalize:!0});T.log(`loadSource:${l}`),n&&a&&(a!==l||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(n)),this.trigger(y.MANIFEST_LOADING,{url:t})}startLoad(t=-1){T.log(`startLoad(${t})`),this.networkControllers.forEach(n=>{n.startLoad(t)})}stopLoad(){T.log("stopLoad"),this.networkControllers.forEach(t=>{t.stopLoad()})}swapAudioCodec(){T.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){T.log("recoverMediaError");const t=this._media;this.detachMedia(),t&&this.attachMedia(t)}removeLevel(t,n=0){this.levelController.removeLevel(t,n)}get levels(){const t=this.levelController.levels;return t||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(t){T.log(`set currentLevel:${t}`),this.loadLevel=t,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(t){T.log(`set nextLevel:${t}`),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(t){T.log(`set loadLevel:${t}`),this.levelController.manualLevel=t}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(t){this.levelController.nextLoadLevel=t}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(t){T.log(`set firstLevel:${t}`),this.levelController.firstLevel=t}get startLevel(){return this.levelController.startLevel}set startLevel(t){T.log(`set startLevel:${t}`),t!==-1&&(t=Math.max(t,this.minAutoLevel)),this.levelController.startLevel=t}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(t){const n=!!t;n!==this.config.capLevelToPlayerSize&&(n?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=n)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimate():NaN}get ttfbEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimateTTFB():NaN}set autoLevelCapping(t){this._autoLevelCapping!==t&&(T.log(`set autoLevelCapping:${t}`),this._autoLevelCapping=t)}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(t){Bs.indexOf(t)>-1&&(this._maxHdcpLevel=t)}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:t,config:{minAutoBitrate:n}}=this;if(!t)return 0;const a=t.length;for(let l=0;l<a;l++)if(t[l].maxBitrate>=n)return l;return 0}get maxAutoLevel(){const{levels:t,autoLevelCapping:n,maxHdcpLevel:a}=this;let l;if(n===-1&&t&&t.length?l=t.length-1:l=n,a)for(let u=l;u--;){const c=t[u].attrs["HDCP-LEVEL"];if(c&&c<=a)return u}return l}get nextAutoLevel(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)}set nextAutoLevel(t){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,t)}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get audioTracks(){const t=this.audioTrackController;return t?t.audioTracks:[]}get audioTrack(){const t=this.audioTrackController;return t?t.audioTrack:-1}set audioTrack(t){const n=this.audioTrackController;n&&(n.audioTrack=t)}get subtitleTracks(){const t=this.subtitleTrackController;return t?t.subtitleTracks:[]}get subtitleTrack(){const t=this.subtitleTrackController;return t?t.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(t){const n=this.subtitleTrackController;n&&(n.subtitleTrack=t)}get subtitleDisplay(){const t=this.subtitleTrackController;return t?t.subtitleDisplay:!1}set subtitleDisplay(t){const n=this.subtitleTrackController;n&&(n.subtitleDisplay=t)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(t){this.config.lowLatencyMode=t}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}ln.defaultConfig=void 0},70189:function(Kt){Kt.exports=ft;var Mt=Object.prototype.toString;function ft(lt){if(!lt)return!1;var ae=Mt.call(lt);return ae==="[object Function]"||typeof lt=="function"&&ae!=="[object RegExp]"||typeof window!="undefined"&&(lt===window.setTimeout||lt===window.alert||lt===window.confirm||lt===window.prompt)}},37946:function(Kt,Mt){function ft(fe){if(fe&&typeof fe=="object"){var Ee=fe.which||fe.keyCode||fe.charCode;Ee&&(fe=Ee)}if(typeof fe=="number")return _e[fe];var ye=String(fe),se=lt[ye.toLowerCase()];if(se)return se;var se=ae[ye.toLowerCase()];if(se)return se;if(ye.length===1)return ye.charCodeAt(0)}ft.isEventKey=function(Ee,ye){if(Ee&&typeof Ee=="object"){var se=Ee.which||Ee.keyCode||Ee.charCode;if(se==null)return!1;if(typeof ye=="string"){var te=lt[ye.toLowerCase()];if(te)return te===se;var te=ae[ye.toLowerCase()];if(te)return te===se}else if(typeof ye=="number")return ye===se;return!1}},Mt=Kt.exports=ft;var lt=Mt.code=Mt.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},ae=Mt.aliases={windows:91,"\u21E7":16,"\u2325":18,"\u2303":17,"\u2318":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};/*!
 * Programatically add the following
 */for(Ze=97;Ze<123;Ze++)lt[String.fromCharCode(Ze)]=Ze-32;for(var Ze=48;Ze<58;Ze++)lt[Ze-48]=Ze;for(Ze=1;Ze<13;Ze++)lt["f"+Ze]=Ze+111;for(Ze=0;Ze<10;Ze++)lt["numpad "+Ze]=Ze+96;var _e=Mt.names=Mt.title={};for(Ze in lt)_e[lt[Ze]]=Ze;for(var tt in ae)lt[tt]=ae[tt]},88156:function(Kt,Mt,ft){var lt=ft(45992).getUint64,ae=function(Ze){var _e=new DataView(Ze.buffer,Ze.byteOffset,Ze.byteLength),tt={version:Ze[0],flags:new Uint8Array(Ze.subarray(1,4)),references:[],referenceId:_e.getUint32(4),timescale:_e.getUint32(8)},fe=12;tt.version===0?(tt.earliestPresentationTime=_e.getUint32(fe),tt.firstOffset=_e.getUint32(fe+4),fe+=8):(tt.earliestPresentationTime=lt(Ze.subarray(fe)),tt.firstOffset=lt(Ze.subarray(fe+8)),fe+=16),fe+=2;var Ee=_e.getUint16(fe);for(fe+=2;Ee>0;fe+=12,Ee--)tt.references.push({referenceType:(Ze[fe]&128)>>>7,referencedSize:_e.getUint32(fe)&2147483647,subsegmentDuration:_e.getUint32(fe+4),startsWithSap:!!(Ze[fe+8]&128),sapType:(Ze[fe+8]&112)>>>4,sapDeltaTime:_e.getUint32(fe+8)&268435455});return tt};Kt.exports=ae},81351:function(Kt){var Mt=9e4,ft,lt,ae,Ze,_e,tt,fe;ft=function(Ee){return Ee*Mt},lt=function(Ee,ye){return Ee*ye},ae=function(Ee){return Ee/Mt},Ze=function(Ee,ye){return Ee/ye},_e=function(Ee,ye){return ft(Ze(Ee,ye))},tt=function(Ee,ye){return lt(ae(Ee),ye)},fe=function(Ee,ye,se){return ae(se?Ee:Ee-ye)},Kt.exports={ONE_SECOND_IN_TS:Mt,secondsToVideoTs:ft,secondsToAudioTs:lt,videoTsToSeconds:ae,audioTsToSeconds:Ze,audioTsToVideoTs:_e,videoTsToAudioTs:tt,metadataTsToSeconds:fe}},45992:function(Kt){var Mt=Math.pow(2,32),ft=function(lt){var ae=new DataView(lt.buffer,lt.byteOffset,lt.byteLength),Ze;return ae.getBigUint64?(Ze=ae.getBigUint64(0),Ze<Number.MAX_SAFE_INTEGER?Number(Ze):Ze):ae.getUint32(0)*Mt+ae.getUint32(4)};Kt.exports={getUint64:ft,MAX_UINT32:Mt}},61843:function(Kt){Kt.exports=Mt;function Mt(ft,lt){var ae,Ze=null;try{ae=JSON.parse(ft,lt)}catch(_e){Ze=_e}return[Ze,ae]}},98622:function(Kt){(function(Mt){var ft=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,lt=/^(?=([^\/?#]*))\1([^]*)$/,ae=/(?:\/|^)\.(?=\/)/g,Ze=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,_e={buildAbsoluteURL:function(tt,fe,Ee){if(Ee=Ee||{},tt=tt.trim(),fe=fe.trim(),!fe){if(!Ee.alwaysNormalize)return tt;var ye=_e.parseURL(tt);if(!ye)throw new Error("Error trying to parse base URL.");return ye.path=_e.normalizePath(ye.path),_e.buildURLFromParts(ye)}var se=_e.parseURL(fe);if(!se)throw new Error("Error trying to parse relative URL.");if(se.scheme)return Ee.alwaysNormalize?(se.path=_e.normalizePath(se.path),_e.buildURLFromParts(se)):fe;var te=_e.parseURL(tt);if(!te)throw new Error("Error trying to parse base URL.");if(!te.netLoc&&te.path&&te.path[0]!=="/"){var Q=lt.exec(te.path);te.netLoc=Q[1],te.path=Q[2]}te.netLoc&&!te.path&&(te.path="/");var w={scheme:te.scheme,netLoc:se.netLoc,path:null,params:se.params,query:se.query,fragment:se.fragment};if(!se.netLoc&&(w.netLoc=te.netLoc,se.path[0]!=="/"))if(!se.path)w.path=te.path,se.params||(w.params=te.params,se.query||(w.query=te.query));else{var y=te.path,$=y.substring(0,y.lastIndexOf("/")+1)+se.path;w.path=_e.normalizePath($)}return w.path===null&&(w.path=Ee.alwaysNormalize?_e.normalizePath(se.path):se.path),_e.buildURLFromParts(w)},parseURL:function(tt){var fe=ft.exec(tt);return fe?{scheme:fe[1]||"",netLoc:fe[2]||"",path:fe[3]||"",params:fe[4]||"",query:fe[5]||"",fragment:fe[6]||""}:null},normalizePath:function(tt){for(tt=tt.split("").reverse().join("").replace(ae,"");tt.length!==(tt=tt.replace(Ze,"")).length;);return tt.split("").reverse().join("")},buildURLFromParts:function(tt){return tt.scheme+tt.netLoc+tt.path+tt.params+tt.query+tt.fragment}};Kt.exports=_e})(this)},49925:function(Kt,Mt,ft){"use strict";ft.d(Mt,{Z:function(){return ze}});var lt=ft(60288),ae=ft.n(lt),Ze=ft(70915),_e=ft.n(Ze),tt=ft(37946),fe=ft.n(tt),Ee=ft(61843),ye=ft.n(Ee),se=ft(7441),te=ft.n(se),Q=ft(69473),w=ft.n(Q),y=ft(98622),$=ft.n(y),D="http://example.com",G=function(e,i){if(/^[a-z]+:/i.test(i))return i;/^data:/.test(e)&&(e=ae().location&&ae().location.href||"");var r=typeof ae().URL=="function",o=/^\/\//.test(e),d=!ae().location&&!/\/\//i.test(e);if(r?e=new(ae()).URL(e,ae().location||D):/\/\//i.test(e)||(e=$().buildAbsoluteURL(ae().location&&ae().location.href||"",e)),r){var h=new URL(i,e);return d?h.href.slice(D.length):o?h.href.slice(h.protocol.length):h.href}return $().buildAbsoluteURL(e,i)},z=G,P=ft(37897),H=function(){function s(){this.listeners={}}var e=s.prototype;return e.on=function(r,o){this.listeners[r]||(this.listeners[r]=[]),this.listeners[r].push(o)},e.off=function(r,o){if(!this.listeners[r])return!1;var d=this.listeners[r].indexOf(o);return this.listeners[r]=this.listeners[r].slice(0),this.listeners[r].splice(d,1),d>-1},e.trigger=function(r){var o=this.listeners[r];if(!!o)if(arguments.length===2)for(var d=o.length,h=0;h<d;++h)o[h].call(this,arguments[1]);else for(var g=Array.prototype.slice.call(arguments,1),k=o.length,N=0;N<k;++N)o[N].apply(this,g)},e.dispose=function(){this.listeners={}},e.pipe=function(r){this.on("data",function(o){r.push(o)})},s}(),j=ft(19208).Buffer,V=function(e){return ae().atob?ae().atob(e):j.from(e,"base64").toString("binary")};function T(s){for(var e=V(s),i=new Uint8Array(e.length),r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return i}/*! @name m3u8-parser @version 6.2.0 @license Apache-2.0 */class Z extends H{constructor(){super();this.buffer=""}push(e){let i;for(this.buffer+=e,i=this.buffer.indexOf(`
`);i>-1;i=this.buffer.indexOf(`
`))this.trigger("data",this.buffer.substring(0,i)),this.buffer=this.buffer.substring(i+1)}}const ie=String.fromCharCode(9),le=function(s){const e=/([0-9.]*)?@?([0-9.]*)?/.exec(s||""),i={};return e[1]&&(i.length=parseInt(e[1],10)),e[2]&&(i.offset=parseInt(e[2],10)),i},F=function(){const s="[^=]*",e='"[^"]*"|[^,]*',i="(?:"+s+")=(?:"+e+")";return new RegExp("(?:^|,)("+i+")")},K=function(s){const e={};if(!s)return e;const i=s.split(F());let r=i.length,o;for(;r--;)i[r]!==""&&(o=/([^=]*)=(.*)/.exec(i[r]).slice(1),o[0]=o[0].replace(/^\s+|\s+$/g,""),o[1]=o[1].replace(/^\s+|\s+$/g,""),o[1]=o[1].replace(/^['"](.*)['"]$/g,"$1"),e[o[0]]=o[1]);return e};class ne extends H{constructor(){super();this.customParsers=[],this.tagMappers=[]}push(e){let i,r;if(e=e.trim(),e.length===0)return;if(e[0]!=="#"){this.trigger("data",{type:"uri",uri:e});return}this.tagMappers.reduce((d,h)=>{const g=h(e);return g===e?d:d.concat([g])},[e]).forEach(d=>{for(let h=0;h<this.customParsers.length;h++)if(this.customParsers[h].call(this,d))return;if(d.indexOf("#EXT")!==0){this.trigger("data",{type:"comment",text:d.slice(1)});return}if(d=d.replace("\r",""),i=/^#EXTM3U/.exec(d),i){this.trigger("data",{type:"tag",tagType:"m3u"});return}if(i=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(d),i){r={type:"tag",tagType:"inf"},i[1]&&(r.duration=parseFloat(i[1])),i[2]&&(r.title=i[2]),this.trigger("data",r);return}if(i=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(d),i){r={type:"tag",tagType:"targetduration"},i[1]&&(r.duration=parseInt(i[1],10)),this.trigger("data",r);return}if(i=/^#EXT-X-VERSION:([0-9.]*)?/.exec(d),i){r={type:"tag",tagType:"version"},i[1]&&(r.version=parseInt(i[1],10)),this.trigger("data",r);return}if(i=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(d),i){r={type:"tag",tagType:"media-sequence"},i[1]&&(r.number=parseInt(i[1],10)),this.trigger("data",r);return}if(i=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(d),i){r={type:"tag",tagType:"discontinuity-sequence"},i[1]&&(r.number=parseInt(i[1],10)),this.trigger("data",r);return}if(i=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(d),i){r={type:"tag",tagType:"playlist-type"},i[1]&&(r.playlistType=i[1]),this.trigger("data",r);return}if(i=/^#EXT-X-BYTERANGE:(.*)?$/.exec(d),i){r=(0,P.Z)(le(i[1]),{type:"tag",tagType:"byterange"}),this.trigger("data",r);return}if(i=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(d),i){r={type:"tag",tagType:"allow-cache"},i[1]&&(r.allowed=!/NO/.test(i[1])),this.trigger("data",r);return}if(i=/^#EXT-X-MAP:(.*)$/.exec(d),i){if(r={type:"tag",tagType:"map"},i[1]){const h=K(i[1]);h.URI&&(r.uri=h.URI),h.BYTERANGE&&(r.byterange=le(h.BYTERANGE))}this.trigger("data",r);return}if(i=/^#EXT-X-STREAM-INF:(.*)$/.exec(d),i){if(r={type:"tag",tagType:"stream-inf"},i[1]){if(r.attributes=K(i[1]),r.attributes.RESOLUTION){const h=r.attributes.RESOLUTION.split("x"),g={};h[0]&&(g.width=parseInt(h[0],10)),h[1]&&(g.height=parseInt(h[1],10)),r.attributes.RESOLUTION=g}r.attributes.BANDWIDTH&&(r.attributes.BANDWIDTH=parseInt(r.attributes.BANDWIDTH,10)),r.attributes["FRAME-RATE"]&&(r.attributes["FRAME-RATE"]=parseFloat(r.attributes["FRAME-RATE"])),r.attributes["PROGRAM-ID"]&&(r.attributes["PROGRAM-ID"]=parseInt(r.attributes["PROGRAM-ID"],10))}this.trigger("data",r);return}if(i=/^#EXT-X-MEDIA:(.*)$/.exec(d),i){r={type:"tag",tagType:"media"},i[1]&&(r.attributes=K(i[1])),this.trigger("data",r);return}if(i=/^#EXT-X-ENDLIST/.exec(d),i){this.trigger("data",{type:"tag",tagType:"endlist"});return}if(i=/^#EXT-X-DISCONTINUITY/.exec(d),i){this.trigger("data",{type:"tag",tagType:"discontinuity"});return}if(i=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(d),i){r={type:"tag",tagType:"program-date-time"},i[1]&&(r.dateTimeString=i[1],r.dateTimeObject=new Date(i[1])),this.trigger("data",r);return}if(i=/^#EXT-X-KEY:(.*)$/.exec(d),i){r={type:"tag",tagType:"key"},i[1]&&(r.attributes=K(i[1]),r.attributes.IV&&(r.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(r.attributes.IV=r.attributes.IV.substring(2)),r.attributes.IV=r.attributes.IV.match(/.{8}/g),r.attributes.IV[0]=parseInt(r.attributes.IV[0],16),r.attributes.IV[1]=parseInt(r.attributes.IV[1],16),r.attributes.IV[2]=parseInt(r.attributes.IV[2],16),r.attributes.IV[3]=parseInt(r.attributes.IV[3],16),r.attributes.IV=new Uint32Array(r.attributes.IV))),this.trigger("data",r);return}if(i=/^#EXT-X-START:(.*)$/.exec(d),i){r={type:"tag",tagType:"start"},i[1]&&(r.attributes=K(i[1]),r.attributes["TIME-OFFSET"]=parseFloat(r.attributes["TIME-OFFSET"]),r.attributes.PRECISE=/YES/.test(r.attributes.PRECISE)),this.trigger("data",r);return}if(i=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(d),i){r={type:"tag",tagType:"cue-out-cont"},i[1]?r.data=i[1]:r.data="",this.trigger("data",r);return}if(i=/^#EXT-X-CUE-OUT:(.*)?$/.exec(d),i){r={type:"tag",tagType:"cue-out"},i[1]?r.data=i[1]:r.data="",this.trigger("data",r);return}if(i=/^#EXT-X-CUE-IN:(.*)?$/.exec(d),i){r={type:"tag",tagType:"cue-in"},i[1]?r.data=i[1]:r.data="",this.trigger("data",r);return}if(i=/^#EXT-X-SKIP:(.*)$/.exec(d),i&&i[1]){r={type:"tag",tagType:"skip"},r.attributes=K(i[1]),r.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(r.attributes["SKIPPED-SEGMENTS"]=parseInt(r.attributes["SKIPPED-SEGMENTS"],10)),r.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(r.attributes["RECENTLY-REMOVED-DATERANGES"]=r.attributes["RECENTLY-REMOVED-DATERANGES"].split(ie)),this.trigger("data",r);return}if(i=/^#EXT-X-PART:(.*)$/.exec(d),i&&i[1]){r={type:"tag",tagType:"part"},r.attributes=K(i[1]),["DURATION"].forEach(function(h){r.attributes.hasOwnProperty(h)&&(r.attributes[h]=parseFloat(r.attributes[h]))}),["INDEPENDENT","GAP"].forEach(function(h){r.attributes.hasOwnProperty(h)&&(r.attributes[h]=/YES/.test(r.attributes[h]))}),r.attributes.hasOwnProperty("BYTERANGE")&&(r.attributes.byterange=le(r.attributes.BYTERANGE)),this.trigger("data",r);return}if(i=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(d),i&&i[1]){r={type:"tag",tagType:"server-control"},r.attributes=K(i[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(h){r.attributes.hasOwnProperty(h)&&(r.attributes[h]=parseFloat(r.attributes[h]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(h){r.attributes.hasOwnProperty(h)&&(r.attributes[h]=/YES/.test(r.attributes[h]))}),this.trigger("data",r);return}if(i=/^#EXT-X-PART-INF:(.*)$/.exec(d),i&&i[1]){r={type:"tag",tagType:"part-inf"},r.attributes=K(i[1]),["PART-TARGET"].forEach(function(h){r.attributes.hasOwnProperty(h)&&(r.attributes[h]=parseFloat(r.attributes[h]))}),this.trigger("data",r);return}if(i=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(d),i&&i[1]){r={type:"tag",tagType:"preload-hint"},r.attributes=K(i[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(h){if(r.attributes.hasOwnProperty(h)){r.attributes[h]=parseInt(r.attributes[h],10);const g=h==="BYTERANGE-LENGTH"?"length":"offset";r.attributes.byterange=r.attributes.byterange||{},r.attributes.byterange[g]=r.attributes[h],delete r.attributes[h]}}),this.trigger("data",r);return}if(i=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(d),i&&i[1]){r={type:"tag",tagType:"rendition-report"},r.attributes=K(i[1]),["LAST-MSN","LAST-PART"].forEach(function(h){r.attributes.hasOwnProperty(h)&&(r.attributes[h]=parseInt(r.attributes[h],10))}),this.trigger("data",r);return}if(i=/^#EXT-X-DATERANGE:(.*)$/.exec(d),i&&i[1]){r={type:"tag",tagType:"daterange"},r.attributes=K(i[1]),["ID","CLASS"].forEach(function(g){r.attributes.hasOwnProperty(g)&&(r.attributes[g]=String(r.attributes[g]))}),["START-DATE","END-DATE"].forEach(function(g){r.attributes.hasOwnProperty(g)&&(r.attributes[g]=new Date(r.attributes[g]))}),["DURATION","PLANNED-DURATION"].forEach(function(g){r.attributes.hasOwnProperty(g)&&(r.attributes[g]=parseFloat(r.attributes[g]))}),["END-ON-NEXT"].forEach(function(g){r.attributes.hasOwnProperty(g)&&(r.attributes[g]=/YES/i.test(r.attributes[g]))}),["SCTE35-CMD"," SCTE35-OUT","SCTE35-IN"].forEach(function(g){r.attributes.hasOwnProperty(g)&&(r.attributes[g]=r.attributes[g].toString(16))});const h=/^X-([A-Z]+-)+[A-Z]+$/;for(const g in r.attributes){if(!h.test(g))continue;const k=/[0-9A-Fa-f]{6}/g.test(r.attributes[g]),N=/^\d+(\.\d+)?$/.test(r.attributes[g]);r.attributes[g]=k?r.attributes[g].toString(16):N?parseFloat(r.attributes[g]):String(r.attributes[g])}this.trigger("data",r);return}if(i=/^#EXT-X-INDEPENDENT-SEGMENTS/.exec(d),i){this.trigger("data",{type:"tag",tagType:"independent-segments"});return}this.trigger("data",{type:"tag",data:d.slice(4)})})}addParser({expression:e,customType:i,dataParser:r,segment:o}){typeof r!="function"&&(r=d=>d),this.customParsers.push(d=>{if(e.exec(d))return this.trigger("data",{type:"custom",data:r(d),customType:i,segment:o}),!0})}addTagMapper({expression:e,map:i}){const r=o=>e.test(o)?i(o):o;this.tagMappers.push(r)}}const de=s=>s.toLowerCase().replace(/-(\w)/g,e=>e[1].toUpperCase()),ve=function(s){const e={};return Object.keys(s).forEach(function(i){e[de(i)]=s[i]}),e},De=function(s){const{serverControl:e,targetDuration:i,partTargetDuration:r}=s;if(!e)return;const o="#EXT-X-SERVER-CONTROL",d="holdBack",h="partHoldBack",g=i&&i*3,k=r&&r*2;i&&!e.hasOwnProperty(d)&&(e[d]=g,this.trigger("info",{message:`${o} defaulting HOLD-BACK to targetDuration * 3 (${g}).`})),g&&e[d]<g&&(this.trigger("warn",{message:`${o} clamping HOLD-BACK (${e[d]}) to targetDuration * 3 (${g})`}),e[d]=g),r&&!e.hasOwnProperty(h)&&(e[h]=r*3,this.trigger("info",{message:`${o} defaulting PART-HOLD-BACK to partTargetDuration * 3 (${e[h]}).`})),r&&e[h]<k&&(this.trigger("warn",{message:`${o} clamping PART-HOLD-BACK (${e[h]}) to partTargetDuration * 2 (${k}).`}),e[h]=k)};class Se extends H{constructor(){super();this.lineStream=new Z,this.parseStream=new ne,this.lineStream.pipe(this.parseStream);const e=this,i=[];let r={},o,d,h=!1;const g=function(){},k={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},N="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";let Y=0;this.manifest={allowCache:!0,discontinuityStarts:[],segments:[]};let me=0,Ie=0;const Pe={};this.on("end",()=>{r.uri||!r.parts&&!r.preloadHints||(!r.map&&o&&(r.map=o),!r.key&&d&&(r.key=d),!r.timeline&&typeof Y=="number"&&(r.timeline=Y),this.manifest.preloadSegment=r)}),this.parseStream.on("data",function(Ae){let $e,Ye;({tag(){({version(){Ae.version&&(this.manifest.version=Ae.version)},"allow-cache"(){this.manifest.allowCache=Ae.allowed,"allowed"in Ae||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){const Qe={};"length"in Ae&&(r.byterange=Qe,Qe.length=Ae.length,"offset"in Ae||(Ae.offset=me)),"offset"in Ae&&(r.byterange=Qe,Qe.offset=Ae.offset),me=Qe.offset+Qe.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),Ae.duration>0&&(r.duration=Ae.duration),Ae.duration===0&&(r.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=i},key(){if(!Ae.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(Ae.attributes.METHOD==="NONE"){d=null;return}if(!Ae.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(Ae.attributes.KEYFORMAT==="com.apple.streamingkeydelivery"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:Ae.attributes};return}if(Ae.attributes.KEYFORMAT==="com.microsoft.playready"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:Ae.attributes.URI};return}if(Ae.attributes.KEYFORMAT===N){if(["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(Ae.attributes.METHOD)===-1){this.trigger("warn",{message:"invalid key method provided for Widevine"});return}if(Ae.attributes.METHOD==="SAMPLE-AES-CENC"&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),Ae.attributes.URI.substring(0,23)!=="data:text/plain;base64,"){this.trigger("warn",{message:"invalid key URI provided for Widevine"});return}if(!(Ae.attributes.KEYID&&Ae.attributes.KEYID.substring(0,2)==="0x")){this.trigger("warn",{message:"invalid key ID provided for Widevine"});return}this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:Ae.attributes.KEYFORMAT,keyId:Ae.attributes.KEYID.substring(2)},pssh:T(Ae.attributes.URI.split(",")[1])};return}Ae.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),d={method:Ae.attributes.METHOD||"AES-128",uri:Ae.attributes.URI},typeof Ae.attributes.IV!="undefined"&&(d.iv=Ae.attributes.IV)},"media-sequence"(){if(!isFinite(Ae.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+Ae.number});return}this.manifest.mediaSequence=Ae.number},"discontinuity-sequence"(){if(!isFinite(Ae.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+Ae.number});return}this.manifest.discontinuitySequence=Ae.number,Y=Ae.number},"playlist-type"(){if(!/VOD|EVENT/.test(Ae.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+Ae.playlist});return}this.manifest.playlistType=Ae.playlistType},map(){o={},Ae.uri&&(o.uri=Ae.uri),Ae.byterange&&(o.byterange=Ae.byterange),d&&(o.key=d)},"stream-inf"(){if(this.manifest.playlists=i,this.manifest.mediaGroups=this.manifest.mediaGroups||k,!Ae.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}r.attributes||(r.attributes={}),(0,P.Z)(r.attributes,Ae.attributes)},media(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||k,!(Ae.attributes&&Ae.attributes.TYPE&&Ae.attributes["GROUP-ID"]&&Ae.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}const Qe=this.manifest.mediaGroups[Ae.attributes.TYPE];Qe[Ae.attributes["GROUP-ID"]]=Qe[Ae.attributes["GROUP-ID"]]||{},$e=Qe[Ae.attributes["GROUP-ID"]],Ye={default:/yes/i.test(Ae.attributes.DEFAULT)},Ye.default?Ye.autoselect=!0:Ye.autoselect=/yes/i.test(Ae.attributes.AUTOSELECT),Ae.attributes.LANGUAGE&&(Ye.language=Ae.attributes.LANGUAGE),Ae.attributes.URI&&(Ye.uri=Ae.attributes.URI),Ae.attributes["INSTREAM-ID"]&&(Ye.instreamId=Ae.attributes["INSTREAM-ID"]),Ae.attributes.CHARACTERISTICS&&(Ye.characteristics=Ae.attributes.CHARACTERISTICS),Ae.attributes.FORCED&&(Ye.forced=/yes/i.test(Ae.attributes.FORCED)),$e[Ae.attributes.NAME]=Ye},discontinuity(){Y+=1,r.discontinuity=!0,this.manifest.discontinuityStarts.push(i.length)},"program-date-time"(){typeof this.manifest.dateTimeString=="undefined"&&(this.manifest.dateTimeString=Ae.dateTimeString,this.manifest.dateTimeObject=Ae.dateTimeObject),r.dateTimeString=Ae.dateTimeString,r.dateTimeObject=Ae.dateTimeObject},targetduration(){if(!isFinite(Ae.duration)||Ae.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+Ae.duration});return}this.manifest.targetDuration=Ae.duration,De.call(this,this.manifest)},start(){if(!Ae.attributes||isNaN(Ae.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:Ae.attributes["TIME-OFFSET"],precise:Ae.attributes.PRECISE}},"cue-out"(){r.cueOut=Ae.data},"cue-out-cont"(){r.cueOutCont=Ae.data},"cue-in"(){r.cueIn=Ae.data},skip(){this.manifest.skip=ve(Ae.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",Ae.attributes,["SKIPPED-SEGMENTS"])},part(){h=!0;const Qe=this.manifest.segments.length,qe=ve(Ae.attributes);r.parts=r.parts||[],r.parts.push(qe),qe.byterange&&(qe.byterange.hasOwnProperty("offset")||(qe.byterange.offset=Ie),Ie=qe.byterange.offset+qe.byterange.length);const ct=r.parts.length-1;this.warnOnMissingAttributes_(`#EXT-X-PART #${ct} for segment #${Qe}`,Ae.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((Je,je)=>{Je.hasOwnProperty("lastPart")||this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${je} lacks required attribute(s): LAST-PART`})})},"server-control"(){const Qe=this.manifest.serverControl=ve(Ae.attributes);Qe.hasOwnProperty("canBlockReload")||(Qe.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),De.call(this,this.manifest),Qe.canSkipDateranges&&!Qe.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){const Qe=this.manifest.segments.length,qe=ve(Ae.attributes),ct=qe.type&&qe.type==="PART";r.preloadHints=r.preloadHints||[],r.preloadHints.push(qe),qe.byterange&&(qe.byterange.hasOwnProperty("offset")||(qe.byterange.offset=ct?Ie:0,ct&&(Ie=qe.byterange.offset+qe.byterange.length)));const Je=r.preloadHints.length-1;if(this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${Je} for segment #${Qe}`,Ae.attributes,["TYPE","URI"]),!!qe.type)for(let je=0;je<r.preloadHints.length-1;je++){const _t=r.preloadHints[je];!_t.type||_t.type===qe.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${Je} for segment #${Qe} has the same TYPE ${qe.type} as preload hint #${je}`})}},"rendition-report"(){const Qe=ve(Ae.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(Qe);const qe=this.manifest.renditionReports.length-1,ct=["LAST-MSN","URI"];h&&ct.push("LAST-PART"),this.warnOnMissingAttributes_(`#EXT-X-RENDITION-REPORT #${qe}`,Ae.attributes,ct)},"part-inf"(){this.manifest.partInf=ve(Ae.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",Ae.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),De.call(this,this.manifest)},daterange(){this.manifest.daterange=this.manifest.daterange||[],this.manifest.daterange.push(ve(Ae.attributes));const Qe=this.manifest.daterange.length-1;this.warnOnMissingAttributes_(`#EXT-X-DATERANGE #${Qe}`,Ae.attributes,["ID","START-DATE"]);const qe=this.manifest.daterange[Qe];qe.endDate&&qe.startDate&&new Date(qe.endDate)<new Date(qe.startDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE END-DATE must be equal to or later than the value of the START-DATE"}),qe.duration&&qe.duration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE DURATION must not be negative"}),qe.plannedDuration&&qe.plannedDuration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE PLANNED-DURATION must not be negative"});const ct=!!qe.endOnNext;if(ct&&!qe.class&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must have a CLASS attribute"}),ct&&(qe.duration||qe.endDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must not contain DURATION or END-DATE attributes"}),qe.duration&&qe.endDate){const Je=qe.startDate,je=Je.setSeconds(Je.getSeconds()+qe.duration);this.manifest.daterange[Qe].endDate=new Date(je)}if(qe&&!this.manifest.dateTimeString&&this.trigger("warn",{message:"A playlist with EXT-X-DATERANGE tag must contain atleast one EXT-X-PROGRAM-DATE-TIME tag"}),!Pe[qe.id])Pe[qe.id]=qe;else for(const Je in Pe[qe.id])if(Pe[qe.id][Je]!==qe[Je]){this.trigger("warn",{message:"EXT-X-DATERANGE tags with the same ID in a playlist must have the same attributes and same attribute values"});break}},"independent-segments"(){this.manifest.independentSegments=!0}}[Ae.tagType]||g).call(e)},uri(){r.uri=Ae.uri,i.push(r),this.manifest.targetDuration&&!("duration"in r)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),r.duration=this.manifest.targetDuration),d&&(r.key=d),r.timeline=Y,o&&(r.map=o),Ie=0,r={}},comment(){},custom(){Ae.segment?(r.custom=r.custom||{},r.custom[Ae.customType]=Ae.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[Ae.customType]=Ae.data)}})[Ae.type].call(e)})}warnOnMissingAttributes_(e,i,r){const o=[];r.forEach(function(d){i.hasOwnProperty(d)||o.push(d)}),o.length&&this.trigger("warn",{message:`${e} lacks required attribute(s): ${o.join(", ")}`})}push(e){this.lineStream.push(e)}end(){this.lineStream.push(`
`),this.trigger("end")}addParser(e){this.parseStream.addParser(e)}addTagMapper(e){this.parseStream.addTagMapper(e)}}var Ce={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},Be=["video","audio","text"],ke=["Video","Audio","Text"],Ne=function(e){return e&&e.replace(/avc1\.(\d+)\.(\d+)/i,function(i,r,o){var d=("00"+Number(r).toString(16)).slice(-2),h=("00"+Number(o).toString(16)).slice(-2);return"avc1."+d+"00"+h})},Re=function(e){return e.map(Ne)},dt=function(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,function(i){return Re([i])[0]})},wt=function(e){e===void 0&&(e="");var i=e.split(","),r=[];return i.forEach(function(o){o=o.trim();var d;Be.forEach(function(h){var g=Ce[h].exec(o.toLowerCase());if(!(!g||g.length<=1)){d=h;var k=o.substring(0,g[1].length),N=o.replace(k,"");r.push({type:k,details:N,mediaType:h})}}),d||r.push({type:o,details:"",mediaType:"unknown"})}),r},It=function(e,i){if(!e.mediaGroups.AUDIO||!i)return null;var r=e.mediaGroups.AUDIO[i];if(!r)return null;for(var o in r){var d=r[o];if(d.default&&d.playlists)return wt(d.playlists[0].attributes.CODECS)}return null},nt=function(e){return e===void 0&&(e=""),Ce.video.test(e.trim().toLowerCase())},ot=function(e){return e===void 0&&(e=""),Ce.audio.test(e.trim().toLowerCase())},ti=function(e){return e===void 0&&(e=""),Ce.text.test(e.trim().toLowerCase())},bt=function(e){if(!(!e||typeof e!="string")){var i=e.toLowerCase().split(",").map(function(d){return Ne(d.trim())}),r="video";i.length===1&&ot(i[0])?r="audio":i.length===1&&ti(i[0])&&(r="application");var o="mp4";return i.every(function(d){return Ce.mp4.test(d)})?o="mp4":i.every(function(d){return Ce.webm.test(d)})?o="webm":i.every(function(d){return Ce.ogg.test(d)})&&(o="ogg"),r+"/"+o+';codecs="'+e+'"'}},Vt=function(e){return e===void 0&&(e=""),ae().MediaSource&&ae().MediaSource.isTypeSupported&&ae().MediaSource.isTypeSupported(bt(e))||!1},si=function(e){return e===void 0&&(e=""),e.toLowerCase().split(",").every(function(i){i=i.trim();for(var r=0;r<ke.length;r++){var o=ke[r];if(Ce["muxer"+o].test(i))return!0}return!1})},Xt="mp4a.40.2",_i="avc1.4d400d",yi=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,xt=/^application\/dash\+xml/i,Qt=function(e){return yi.test(e)?"hls":xt.test(e)?"dash":e==="application/vnd.videojs.vhs+json"?"vhs-json":null},li=function(e,i){for(var r="";i--;)r+=e;return r},Ki=function(e){return e.toString(2).length},Ji=function(e){return Math.ceil(Ki(e)/8)},$i=function(e,i,r){return r===void 0&&(r=" "),(li(r,i)+e.toString()).slice(-i)},cn=function(e){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer},sn=function(e){return cn(e)},pt=function(e){return e instanceof Uint8Array?e:(!Array.isArray(e)&&!sn(e)&&!(e instanceof ArrayBuffer)&&(typeof e!="number"||typeof e=="number"&&e!==e?e=0:e=[e]),new Uint8Array(e&&e.buffer||e,e&&e.byteOffset||0,e&&e.byteLength||0))},vi=function(e){e=pt(e);for(var i="",r=0;r<e.length;r++)i+=$i(e[r].toString(16),2,"0");return i},xi=function(e){e=pt(e);for(var i="",r=0;r<e.length;r++)i+=$i(e[r].toString(2),8,"0");return i},oi=ae().BigInt||Number,kn=[oi("0x1"),oi("0x100"),oi("0x10000"),oi("0x1000000"),oi("0x100000000"),oi("0x10000000000"),oi("0x1000000000000"),oi("0x100000000000000"),oi("0x10000000000000000")],Gr=function(){var s=new Uint16Array([65484]),e=new Uint8Array(s.buffer,s.byteOffset,s.byteLength);return e[0]===255?"big":e[0]===204?"little":"unknown"}(),Is=Gr==="big",Zi=Gr==="little",Tn=function(e,i){var r=i===void 0?{}:i,o=r.signed,d=o===void 0?!1:o,h=r.le,g=h===void 0?!1:h;e=pt(e);var k=g?"reduce":"reduceRight",N=e[k]?e[k]:Array.prototype[k],Y=N.call(e,function(Ie,Pe,Ae){var $e=g?Ae:Math.abs(Ae+1-e.length);return Ie+oi(Pe)*kn[$e]},oi(0));if(d){var me=kn[e.length]/oi(2)-oi(1);Y=oi(Y),Y>me&&(Y-=me,Y-=me,Y-=oi(2))}return Number(Y)},Xe=function(e,i){var r=i===void 0?{}:i,o=r.le,d=o===void 0?!1:o;(typeof e!="bigint"&&typeof e!="number"||typeof e=="number"&&e!==e)&&(e=0),e=oi(e);for(var h=Ji(e),g=new Uint8Array(new ArrayBuffer(h)),k=0;k<h;k++){var N=d?k:Math.abs(k+1-g.length);g[N]=Number(e/kn[k]&oi(255)),e<0&&(g[N]=Math.abs(~g[N]),g[N]-=k===0?1:2)}return g},Le=function(e){if(!e)return"";e=Array.prototype.slice.call(e);var i=String.fromCharCode.apply(null,pt(e));try{return decodeURIComponent(escape(i))}catch(r){}return i},ht=function(e,i){if(typeof e!="string"&&e&&typeof e.toString=="function"&&(e=e.toString()),typeof e!="string")return new Uint8Array;i||(e=unescape(encodeURIComponent(e)));for(var r=new Uint8Array(e.length),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);return r},Rt=function(){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];if(i=i.filter(function(g){return g&&(g.byteLength||g.length)&&typeof g!="string"}),i.length<=1)return pt(i[0]);var o=i.reduce(function(g,k,N){return g+(k.byteLength||k.length)},0),d=new Uint8Array(o),h=0;return i.forEach(function(g){g=pt(g),d.set(g,h),h+=g.byteLength}),d},Lt=function(e,i,r){var o=r===void 0?{}:r,d=o.offset,h=d===void 0?0:d,g=o.mask,k=g===void 0?[]:g;e=pt(e),i=pt(i);var N=i.every?i.every:Array.prototype.every;return i.length&&e.length-h>=i.length&&N.call(i,function(Y,me){var Ie=k[me]?k[me]&e[h+me]:e[h+me];return Y===Ie})},Tt=function(e,i,r){return Uint8Array.prototype.slice?Uint8Array.prototype.slice.call(e,i,r):new Uint8Array(Array.prototype.slice.call(e,i,r))},ii=function(e){return e.reverse?e.reverse():Array.prototype.reverse.call(e)},mn=function(e,i,r){i.forEach(function(o){for(var d in e.mediaGroups[o])for(var h in e.mediaGroups[o][d]){var g=e.mediaGroups[o][d][h];r(g,o,d,h)}})},Ut=ft(19208).Buffer,Bn=function(e){return ae().atob?ae().atob(e):Ut.from(e,"base64").toString("binary")};function Wn(s){for(var e=Bn(s),i=new Uint8Array(e.length),r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return i}var ai=ft(65952);/*! @name mpd-parser @version 1.3.0 @license Apache-2.0 */var qr="1.3.0";const pr=s=>!!s&&typeof s=="object",Ri=(...s)=>s.reduce((e,i)=>(typeof i!="object"||Object.keys(i).forEach(r=>{Array.isArray(e[r])&&Array.isArray(i[r])?e[r]=e[r].concat(i[r]):pr(e[r])&&pr(i[r])?e[r]=Ri(e[r],i[r]):e[r]=i[r]}),e),{}),Wr=s=>Object.keys(s).map(e=>s[e]),Rs=(s,e)=>{const i=[];for(let r=s;r<e;r++)i.push(r);return i},mr=s=>s.reduce((e,i)=>e.concat(i),[]),Kr=s=>{if(!s.length)return[];const e=[];for(let i=0;i<s.length;i++)e.push(s[i]);return e},Mn=(s,e)=>s.reduce((i,r,o)=>(r[e]&&i.push(o),i),[]),ea=(s,e)=>Wr(s.reduce((i,r)=>(r.forEach(o=>{i[e(o)]=o}),i),{}));var hn={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",INVALID_NUMBER_OF_CONTENT_STEERING:"INVALID_NUMBER_OF_CONTENT_STEERING",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",MISSING_SEGMENT_INFORMATION:"MISSING_SEGMENT_INFORMATION",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"};const tr=({baseUrl:s="",source:e="",range:i="",indexRange:r=""})=>{const o={uri:e,resolvedUri:z(s||"",e)};if(i||r){const h=(i||r).split("-");let g=ae().BigInt?ae().BigInt(h[0]):parseInt(h[0],10),k=ae().BigInt?ae().BigInt(h[1]):parseInt(h[1],10);g<Number.MAX_SAFE_INTEGER&&typeof g=="bigint"&&(g=Number(g)),k<Number.MAX_SAFE_INTEGER&&typeof k=="bigint"&&(k=Number(k));let N;typeof k=="bigint"||typeof g=="bigint"?N=ae().BigInt(k)-ae().BigInt(g)+ae().BigInt(1):N=k-g+1,typeof N=="bigint"&&N<Number.MAX_SAFE_INTEGER&&(N=Number(N)),o.byterange={length:N,offset:g}}return o},ho=s=>{let e;return typeof s.offset=="bigint"||typeof s.length=="bigint"?e=ae().BigInt(s.offset)+ae().BigInt(s.length)-ae().BigInt(1):e=s.offset+s.length-1,`${s.offset}-${e}`},ee=s=>(s&&typeof s!="number"&&(s=parseInt(s,10)),isNaN(s)?null:s),re={static(s){const{duration:e,timescale:i=1,sourceDuration:r,periodDuration:o}=s,d=ee(s.endNumber),h=e/i;return typeof d=="number"?{start:0,end:d}:typeof o=="number"?{start:0,end:o/h}:{start:0,end:r/h}},dynamic(s){const{NOW:e,clientOffset:i,availabilityStartTime:r,timescale:o=1,duration:d,periodStart:h=0,minimumUpdatePeriod:g=0,timeShiftBufferDepth:k=Infinity}=s,N=ee(s.endNumber),Y=(e+i)/1e3,me=r+h,Pe=Y+g-me,Ae=Math.ceil(Pe*o/d),$e=Math.floor((Y-me-k)*o/d),Ye=Math.floor((Y-me)*o/d);return{start:Math.max(0,$e),end:typeof N=="number"?N:Math.min(Ae,Ye)}}},Te=s=>e=>{const{duration:i,timescale:r=1,periodStart:o,startNumber:d=1}=s;return{number:d+e,duration:i/r,timeline:o,time:e*i}},Ge=s=>{const{type:e,duration:i,timescale:r=1,periodDuration:o,sourceDuration:d}=s,{start:h,end:g}=re[e](s),k=Rs(h,g).map(Te(s));if(e==="static"){const N=k.length-1,Y=typeof o=="number"?o:d;k[N].duration=Y-i/r*N}return k},mt=s=>{const{baseUrl:e,initialization:i={},sourceDuration:r,indexRange:o="",periodStart:d,presentationTime:h,number:g=0,duration:k}=s;if(!e)throw new Error(hn.NO_BASE_URL);const N=tr({baseUrl:e,source:i.sourceURL,range:i.range}),Y=tr({baseUrl:e,source:e,indexRange:o});if(Y.map=N,k){const me=Ge(s);me.length&&(Y.duration=me[0].duration,Y.timeline=me[0].timeline)}else r&&(Y.duration=r,Y.timeline=d);return Y.presentationTime=h||d,Y.number=g,[Y]},Nt=(s,e,i)=>{const r=s.sidx.map?s.sidx.map:null,o=s.sidx.duration,d=s.timeline||0,h=s.sidx.byterange,g=h.offset+h.length,k=e.timescale,N=e.references.filter(Ye=>Ye.referenceType!==1),Y=[],me=s.endList?"static":"dynamic",Ie=s.sidx.timeline;let Pe=Ie,Ae=s.mediaSequence||0,$e;typeof e.firstOffset=="bigint"?$e=ae().BigInt(g)+e.firstOffset:$e=g+e.firstOffset;for(let Ye=0;Ye<N.length;Ye++){const Qe=e.references[Ye],qe=Qe.referencedSize,ct=Qe.subsegmentDuration;let Je;typeof $e=="bigint"?Je=$e+ae().BigInt(qe)-ae().BigInt(1):Je=$e+qe-1;const je=`${$e}-${Je}`,jt=mt({baseUrl:i,timescale:k,timeline:d,periodStart:Ie,presentationTime:Pe,number:Ae,duration:ct,sourceDuration:o,indexRange:je,type:me})[0];r&&(jt.map=r),Y.push(jt),typeof $e=="bigint"?$e+=ae().BigInt(qe):$e+=qe,Pe+=ct/k,Ae++}return s.segments=Y,s},Ai=["AUDIO","SUBTITLES"],mi=1/60,zi=s=>ea(s,({timeline:e})=>e).sort((e,i)=>e.timeline>i.timeline?1:-1),gn=(s,e)=>{for(let i=0;i<s.length;i++)if(s[i].attributes.NAME===e)return s[i];return null},Dn=s=>{let e=[];return mn(s,Ai,(i,r,o,d)=>{e=e.concat(i.playlists||[])}),e},Fn=({playlist:s,mediaSequence:e})=>{s.mediaSequence=e,s.segments.forEach((i,r)=>{i.number=s.mediaSequence+r})},Oi=({oldPlaylists:s,newPlaylists:e,timelineStarts:i})=>{e.forEach(r=>{r.discontinuitySequence=i.findIndex(function({timeline:k}){return k===r.timeline});const o=gn(s,r.attributes.NAME);if(!o||r.sidx)return;const d=r.segments[0],h=o.segments.findIndex(function(k){return Math.abs(k.presentationTime-d.presentationTime)<mi});if(h===-1){Fn({playlist:r,mediaSequence:o.mediaSequence+o.segments.length}),r.segments[0].discontinuity=!0,r.discontinuityStarts.unshift(0),(!o.segments.length&&r.timeline>o.timeline||o.segments.length&&r.timeline>o.segments[o.segments.length-1].timeline)&&r.discontinuitySequence--;return}o.segments[h].discontinuity&&!d.discontinuity&&(d.discontinuity=!0,r.discontinuityStarts.unshift(0),r.discontinuitySequence--),Fn({playlist:r,mediaSequence:o.segments[h].number})})},Nn=({oldManifest:s,newManifest:e})=>{const i=s.playlists.concat(Dn(s)),r=e.playlists.concat(Dn(e));return e.timelineStarts=zi([s.timelineStarts,e.timelineStarts]),Oi({oldPlaylists:i,newPlaylists:r,timelineStarts:e.timelineStarts}),e},Sn=s=>s&&s.uri+"-"+ho(s.byterange),en=s=>{const e=s.reduce(function(r,o){return r[o.attributes.baseUrl]||(r[o.attributes.baseUrl]=[]),r[o.attributes.baseUrl].push(o),r},{});let i=[];return Object.values(e).forEach(r=>{const o=Wr(r.reduce((d,h)=>{const g=h.attributes.id+(h.attributes.lang||"");return d[g]?(h.segments&&(h.segments[0]&&(h.segments[0].discontinuity=!0),d[g].segments.push(...h.segments)),h.attributes.contentProtection&&(d[g].attributes.contentProtection=h.attributes.contentProtection)):(d[g]=h,d[g].attributes.timelineStarts=[]),d[g].attributes.timelineStarts.push({start:h.attributes.periodStart,timeline:h.attributes.periodStart}),d},{}));i=i.concat(o)}),i.map(r=>(r.discontinuityStarts=Mn(r.segments||[],"discontinuity"),r))},an=(s,e)=>{const i=Sn(s.sidx),r=i&&e[i]&&e[i].sidx;return r&&Nt(s,r,s.sidx.resolvedUri),s},wr=(s,e={})=>{if(!Object.keys(e).length)return s;for(const i in s)s[i]=an(s[i],e);return s},Lr=({attributes:s,segments:e,sidx:i,mediaSequence:r,discontinuitySequence:o,discontinuityStarts:d},h)=>{const g={attributes:{NAME:s.id,BANDWIDTH:s.bandwidth,CODECS:s.codecs,["PROGRAM-ID"]:1},uri:"",endList:s.type==="static",timeline:s.periodStart,resolvedUri:s.baseUrl||"",targetDuration:s.duration,discontinuitySequence:o,discontinuityStarts:d,timelineStarts:s.timelineStarts,mediaSequence:r,segments:e};return s.contentProtection&&(g.contentProtection=s.contentProtection),s.serviceLocation&&(g.attributes.serviceLocation=s.serviceLocation),i&&(g.sidx=i),h&&(g.attributes.AUDIO="audio",g.attributes.SUBTITLES="subs"),g},fn=({attributes:s,segments:e,mediaSequence:i,discontinuityStarts:r,discontinuitySequence:o})=>{typeof e=="undefined"&&(e=[{uri:s.baseUrl,timeline:s.periodStart,resolvedUri:s.baseUrl||"",duration:s.sourceDuration,number:0}],s.duration=s.sourceDuration);const d={NAME:s.id,BANDWIDTH:s.bandwidth,["PROGRAM-ID"]:1};s.codecs&&(d.CODECS=s.codecs);const h={attributes:d,uri:"",endList:s.type==="static",timeline:s.periodStart,resolvedUri:s.baseUrl||"",targetDuration:s.duration,timelineStarts:s.timelineStarts,discontinuityStarts:r,discontinuitySequence:o,mediaSequence:i,segments:e};return s.serviceLocation&&(h.attributes.serviceLocation=s.serviceLocation),h},kr=(s,e={},i=!1)=>{let r;const o=s.reduce((d,h)=>{const g=h.attributes.role&&h.attributes.role.value||"",k=h.attributes.lang||"";let N=h.attributes.label||"main";if(k&&!h.attributes.label){const me=g?` (${g})`:"";N=`${h.attributes.lang}${me}`}d[N]||(d[N]={language:k,autoselect:!0,default:g==="main",playlists:[],uri:""});const Y=an(Lr(h,i),e);return d[N].playlists.push(Y),typeof r=="undefined"&&g==="main"&&(r=h,r.default=!0),d},{});if(!r){const d=Object.keys(o)[0];o[d].default=!0}return o},La=(s,e={})=>s.reduce((i,r)=>{const o=r.attributes.label||r.attributes.lang||"text";return i[o]||(i[o]={language:o,default:!1,autoselect:!1,playlists:[],uri:""}),i[o].playlists.push(an(fn(r),e)),i},{}),ka=s=>s.reduce((e,i)=>(i&&i.forEach(r=>{const{channel:o,language:d}=r;e[d]={autoselect:!1,default:!1,instreamId:o,language:d},r.hasOwnProperty("aspectRatio")&&(e[d].aspectRatio=r.aspectRatio),r.hasOwnProperty("easyReader")&&(e[d].easyReader=r.easyReader),r.hasOwnProperty("3D")&&(e[d]["3D"]=r["3D"])}),e),{}),ta=({attributes:s,segments:e,sidx:i,discontinuityStarts:r})=>{const o={attributes:{NAME:s.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:s.width,height:s.height},CODECS:s.codecs,BANDWIDTH:s.bandwidth,["PROGRAM-ID"]:1},uri:"",endList:s.type==="static",timeline:s.periodStart,resolvedUri:s.baseUrl||"",targetDuration:s.duration,discontinuityStarts:r,timelineStarts:s.timelineStarts,segments:e};return s.frameRate&&(o.attributes["FRAME-RATE"]=s.frameRate),s.contentProtection&&(o.contentProtection=s.contentProtection),s.serviceLocation&&(o.attributes.serviceLocation=s.serviceLocation),i&&(o.sidx=i),o},fo=({attributes:s})=>s.mimeType==="video/mp4"||s.mimeType==="video/webm"||s.contentType==="video",po=({attributes:s})=>s.mimeType==="audio/mp4"||s.mimeType==="audio/webm"||s.contentType==="audio",Kn=({attributes:s})=>s.mimeType==="text/vtt"||s.contentType==="text",Da=(s,e)=>{s.forEach(i=>{i.mediaSequence=0,i.discontinuitySequence=e.findIndex(function({timeline:r}){return r===i.timeline}),!!i.segments&&i.segments.forEach((r,o)=>{r.number=o})})},Ia=s=>s?Object.keys(s).reduce((e,i)=>{const r=s[i];return e.concat(r.playlists)},[]):[],Ra=({dashPlaylists:s,locations:e,contentSteering:i,sidxMapping:r={},previousManifest:o,eventStream:d})=>{if(!s.length)return{};const{sourceDuration:h,type:g,suggestedPresentationDelay:k,minimumUpdatePeriod:N}=s[0].attributes,Y=en(s.filter(fo)).map(ta),me=en(s.filter(po)),Ie=en(s.filter(Kn)),Pe=s.map(Je=>Je.attributes.captionServices).filter(Boolean),Ae={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:{AUDIO:{},VIDEO:{},["CLOSED-CAPTIONS"]:{},SUBTITLES:{}},uri:"",duration:h,playlists:wr(Y,r)};N>=0&&(Ae.minimumUpdatePeriod=N*1e3),e&&(Ae.locations=e),i&&(Ae.contentSteering=i),g==="dynamic"&&(Ae.suggestedPresentationDelay=k),d&&d.length>0&&(Ae.eventStream=d);const $e=Ae.playlists.length===0,Ye=me.length?kr(me,r,$e):null,Qe=Ie.length?La(Ie,r):null,qe=Y.concat(Ia(Ye),Ia(Qe)),ct=qe.map(({timelineStarts:Je})=>Je);return Ae.timelineStarts=zi(ct),Da(qe,Ae.timelineStarts),Ye&&(Ae.mediaGroups.AUDIO.audio=Ye),Qe&&(Ae.mediaGroups.SUBTITLES.subs=Qe),Pe.length&&(Ae.mediaGroups["CLOSED-CAPTIONS"].cc=ka(Pe)),o?Nn({oldManifest:o,newManifest:Ae}):Ae},ia=(s,e,i)=>{const{NOW:r,clientOffset:o,availabilityStartTime:d,timescale:h=1,periodStart:g=0,minimumUpdatePeriod:k=0}=s,N=(r+o)/1e3,Y=d+g,Ie=N+k-Y;return Math.ceil((Ie*h-e)/i)},Oa=(s,e)=>{const{type:i,minimumUpdatePeriod:r=0,media:o="",sourceDuration:d,timescale:h=1,startNumber:g=1,periodStart:k}=s,N=[];let Y=-1;for(let me=0;me<e.length;me++){const Ie=e[me],Pe=Ie.d,Ae=Ie.r||0,$e=Ie.t||0;Y<0&&(Y=$e),$e&&$e>Y&&(Y=$e);let Ye;if(Ae<0){const ct=me+1;ct===e.length?i==="dynamic"&&r>0&&o.indexOf("$Number$")>0?Ye=ia(s,Y,Pe):Ye=(d*h-Y)/Pe:Ye=(e[ct].t-Y)/Pe}else Ye=Ae+1;const Qe=g+N.length+Ye;let qe=g+N.length;for(;qe<Qe;)N.push({number:qe,duration:Pe/h,time:Y,timeline:k}),Y+=Pe,qe++}return N},Pa=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,zr=s=>(e,i,r,o)=>{if(e==="$$")return"$";if(typeof s[i]=="undefined")return e;const d=""+s[i];return i==="RepresentationID"||(r?o=parseInt(o,10):o=1,d.length>=o)?d:`${new Array(o-d.length+1).join("0")}${d}`},fs=(s,e)=>s.replace(Pa,zr(e)),ui=(s,e)=>!s.duration&&!e?[{number:s.startNumber||1,duration:s.sourceDuration,time:0,timeline:s.periodStart}]:s.duration?Ge(s):Oa(s,e),Gt=(s,e)=>{const i={RepresentationID:s.id,Bandwidth:s.bandwidth||0},{initialization:r={sourceURL:"",range:""}}=s,o=tr({baseUrl:s.baseUrl,source:fs(r.sourceURL,i),range:r.range});return ui(s,e).map(h=>{i.Number=h.number,i.Time=h.time;const g=fs(s.media||"",i),k=s.timescale||1,N=s.presentationTimeOffset||0,Y=s.periodStart+(h.time-N)/k;return{uri:g,timeline:h.timeline,duration:h.duration,resolvedUri:z(s.baseUrl||"",g),map:o,number:h.number,presentationTime:Y}})},na=(s,e)=>{const{baseUrl:i,initialization:r={}}=s,o=tr({baseUrl:i,source:r.sourceURL,range:r.range}),d=tr({baseUrl:i,source:e.media,range:e.mediaRange});return d.map=o,d},Yr=(s,e)=>{const{duration:i,segmentUrls:r=[],periodStart:o}=s;if(!i&&!e||i&&e)throw new Error(hn.SEGMENT_TIME_UNSPECIFIED);const d=r.map(k=>na(s,k));let h;return i&&(h=Ge(s)),e&&(h=Oa(s,e)),h.map((k,N)=>{if(d[N]){const Y=d[N],me=s.timescale||1,Ie=s.presentationTimeOffset||0;return Y.timeline=k.timeline,Y.duration=k.duration,Y.number=k.number,Y.presentationTime=o+(k.time-Ie)/me,Y}}).filter(k=>k)},nl=({attributes:s,segmentInfo:e})=>{let i,r;e.template?(r=Gt,i=Ri(s,e.template)):e.base?(r=mt,i=Ri(s,e.base)):e.list&&(r=Yr,i=Ri(s,e.list));const o={attributes:s};if(!r)return o;const d=r(i,e.segmentTimeline);if(i.duration){const{duration:h,timescale:g=1}=i;i.duration=h/g}else d.length?i.duration=d.reduce((h,g)=>Math.max(h,Math.ceil(g.duration)),0):i.duration=0;return o.attributes=i,o.segments=d,e.base&&i.indexRange&&(o.sidx=d[0],o.segments=[]),o},gr=s=>s.map(nl),bi=(s,e)=>Kr(s.childNodes).filter(({tagName:i})=>i===e),In=s=>s.textContent.trim(),Xr=s=>parseFloat(s.split("/").reduce((e,i)=>e/i)),Qr=s=>{const e=365*24*60*60,i=30*24*60*60,r=24*60*60,o=60*60,d=60,g=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(s);if(!g)return 0;const[k,N,Y,me,Ie,Pe]=g.slice(1);return parseFloat(k||0)*e+parseFloat(N||0)*i+parseFloat(Y||0)*r+parseFloat(me||0)*o+parseFloat(Ie||0)*d+parseFloat(Pe||0)},rl=s=>(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(s)&&(s+="Z"),Date.parse(s)),Un={mediaPresentationDuration(s){return Qr(s)},availabilityStartTime(s){return rl(s)/1e3},minimumUpdatePeriod(s){return Qr(s)},suggestedPresentationDelay(s){return Qr(s)},type(s){return s},timeShiftBufferDepth(s){return Qr(s)},start(s){return Qr(s)},width(s){return parseInt(s,10)},height(s){return parseInt(s,10)},bandwidth(s){return parseInt(s,10)},frameRate(s){return Xr(s)},startNumber(s){return parseInt(s,10)},timescale(s){return parseInt(s,10)},presentationTimeOffset(s){return parseInt(s,10)},duration(s){const e=parseInt(s,10);return isNaN(e)?Qr(s):e},d(s){return parseInt(s,10)},t(s){return parseInt(s,10)},r(s){return parseInt(s,10)},presentationTime(s){return parseInt(s,10)},DEFAULT(s){return s}},Vi=s=>s&&s.attributes?Kr(s.attributes).reduce((e,i)=>{const r=Un[i.name]||Un.DEFAULT;return e[i.name]=r(i.value),e},{}):{},Os={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime","urn:mpeg:dash:mp4protection:2011":"mp4protection"},Ps=(s,e)=>e.length?mr(s.map(function(i){return e.map(function(r){const o=In(r),d=z(i.baseUrl,o),h=Ri(Vi(r),{baseUrl:d});return d!==o&&!h.serviceLocation&&i.serviceLocation&&(h.serviceLocation=i.serviceLocation),h})})):s,Di=s=>{const e=bi(s,"SegmentTemplate")[0],i=bi(s,"SegmentList")[0],r=i&&bi(i,"SegmentURL").map(me=>Ri({tag:"SegmentURL"},Vi(me))),o=bi(s,"SegmentBase")[0],d=i||e,h=d&&bi(d,"SegmentTimeline")[0],g=i||o||e,k=g&&bi(g,"Initialization")[0],N=e&&Vi(e);N&&k?N.initialization=k&&Vi(k):N&&N.initialization&&(N.initialization={sourceURL:N.initialization});const Y={template:N,segmentTimeline:h&&bi(h,"S").map(me=>Vi(me)),list:i&&Ri(Vi(i),{segmentUrls:r,initialization:Vi(k)}),base:o&&Ri(Vi(o),{initialization:Vi(k)})};return Object.keys(Y).forEach(me=>{Y[me]||delete Y[me]}),Y},ra=(s,e,i)=>r=>{const o=bi(r,"BaseURL"),d=Ps(e,o),h=Ri(s,Vi(r)),g=Di(r);return d.map(k=>({segmentInfo:Ri(i,g),attributes:Ri(h,k)}))},sl=s=>s.reduce((e,i)=>{const r=Vi(i);r.schemeIdUri&&(r.schemeIdUri=r.schemeIdUri.toLowerCase());const o=Os[r.schemeIdUri];if(o){e[o]={attributes:r};const d=bi(i,"cenc:pssh")[0];if(d){const h=In(d);e[o].pssh=h&&Wn(h)}}return e},{}),Ba=s=>{if(s.schemeIdUri==="urn:scte:dash:cc:cea-608:2015")return(typeof s.value!="string"?[]:s.value.split(";")).map(i=>{let r,o;return o=i,/^CC\d=/.test(i)?[r,o]=i.split("="):/^CC\d$/.test(i)&&(r=i),{channel:r,language:o}});if(s.schemeIdUri==="urn:scte:dash:cc:cea-708:2015")return(typeof s.value!="string"?[]:s.value.split(";")).map(i=>{const r={channel:void 0,language:void 0,aspectRatio:1,easyReader:0,"3D":0};if(/=/.test(i)){const[o,d=""]=i.split("=");r.channel=o,r.language=i,d.split(",").forEach(h=>{const[g,k]=h.split(":");g==="lang"?r.language=k:g==="er"?r.easyReader=Number(k):g==="war"?r.aspectRatio=Number(k):g==="3D"&&(r["3D"]=Number(k))})}else r.language=i;return r.channel&&(r.channel="SERVICE"+r.channel),r})},al=s=>mr(bi(s.node,"EventStream").map(e=>{const i=Vi(e),r=i.schemeIdUri;return bi(e,"Event").map(o=>{const d=Vi(o),h=d.presentationTime||0,g=i.timescale||1,k=d.duration||0,N=h/g+s.attributes.start;return{schemeIdUri:r,value:i.value,id:d.id,start:N,end:N+k/g,messageData:In(o)||d.messageData,contentEncoding:i.contentEncoding,presentationTimeOffset:i.presentationTimeOffset||0}})})),Bs=(s,e,i)=>r=>{const o=Vi(r),d=Ps(e,bi(r,"BaseURL")),h=bi(r,"Role")[0],g={role:Vi(h)};let k=Ri(s,o,g);const N=bi(r,"Accessibility")[0],Y=Ba(Vi(N));Y&&(k=Ri(k,{captionServices:Y}));const me=bi(r,"Label")[0];if(me&&me.childNodes.length){const Ye=me.childNodes[0].nodeValue.trim();k=Ri(k,{label:Ye})}const Ie=sl(bi(r,"ContentProtection"));Object.keys(Ie).length&&(k=Ri(k,{contentProtection:Ie}));const Pe=Di(r),Ae=bi(r,"Representation"),$e=Ri(i,Pe);return mr(Ae.map(ra(k,d,$e)))},ir=(s,e)=>(i,r)=>{const o=Ps(e,bi(i.node,"BaseURL")),d=Ri(s,{periodStart:i.attributes.start});typeof i.attributes.duration=="number"&&(d.periodDuration=i.attributes.duration);const h=bi(i.node,"AdaptationSet"),g=Di(i.node);return mr(h.map(Bs(d,o,g)))},ol=(s,e)=>{if(s.length>1&&e({type:"warn",message:"The MPD manifest should contain no more than one ContentSteering tag"}),!s.length)return null;const i=Ri({serverURL:In(s[0])},Vi(s[0]));return i.queryBeforeStart=i.queryBeforeStart==="true",i},mo=({attributes:s,priorPeriodAttributes:e,mpdType:i})=>typeof s.start=="number"?s.start:e&&typeof e.start=="number"&&typeof e.duration=="number"?e.start+e.duration:!e&&i==="static"?0:null,Ms=(s,e={})=>{const{manifestUri:i="",NOW:r=Date.now(),clientOffset:o=0,eventHandler:d=function(){}}=e,h=bi(s,"Period");if(!h.length)throw new Error(hn.INVALID_NUMBER_OF_PERIOD);const g=bi(s,"Location"),k=Vi(s),N=Ps([{baseUrl:i}],bi(s,"BaseURL")),Y=bi(s,"ContentSteering");k.type=k.type||"static",k.sourceDuration=k.mediaPresentationDuration||0,k.NOW=r,k.clientOffset=o,g.length&&(k.locations=g.map(In));const me=[];return h.forEach((Ie,Pe)=>{const Ae=Vi(Ie),$e=me[Pe-1];Ae.start=mo({attributes:Ae,priorPeriodAttributes:$e?$e.attributes:null,mpdType:k.type}),me.push({node:Ie,attributes:Ae})}),{locations:k.locations,contentSteeringInfo:ol(Y,d),representationInfo:mr(me.map(ir(k,N))),eventStream:mr(me.map(al))}},sa=s=>{if(s==="")throw new Error(hn.DASH_EMPTY_MANIFEST);const e=new ai.DOMParser;let i,r;try{i=e.parseFromString(s,"application/xml"),r=i&&i.documentElement.tagName==="MPD"?i.documentElement:null}catch(o){}if(!r||r&&r.getElementsByTagName("parsererror").length>0)throw new Error(hn.DASH_INVALID_XML);return r},go=s=>{const e=bi(s,"UTCTiming")[0];if(!e)return null;const i=Vi(e);switch(i.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":i.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":i.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":i.method="DIRECT",i.value=Date.parse(i.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(hn.UNSUPPORTED_UTC_TIMING_SCHEME)}return i},fu=null,ll=(s,e={})=>{const i=Ms(sa(s),e),r=gr(i.representationInfo);return Ra({dashPlaylists:r,locations:i.locations,contentSteering:i.contentSteeringInfo,sidxMapping:e.sidxMapping,previousManifest:e.previousManifest,eventStream:i.eventStream})},ul=s=>go(sa(s));var dl=ft(88156),yo=ft.n(dl),Ma=pt([73,68,51]),cl=function(e,i){i===void 0&&(i=0),e=pt(e);var r=e[i+5],o=e[i+6]<<21|e[i+7]<<14|e[i+8]<<7|e[i+9],d=(r&16)>>4;return d?o+20:o+10},Fs=function s(e,i){return i===void 0&&(i=0),e=pt(e),e.length-i<10||!Lt(e,Ma,{offset:i})?i:(i+=cl(e,i),s(e,i))},hl=function(e){var i="",r=e[1]>>>3,o=e[1]&31,d=e[2]>>>7,h=(e[2]&64)>>6,g=(e[2]&32)>>5,k=(e[2]&16)>>4,N=(e[2]&8)>>3,Y=(e[2]&4)>>2,me=e[2]&3;i+=r+"."+padStart(o,2,"0"),d===0?i+="M":d===1&&(i+="H");var Ie;return r===2&&h?Ie=g?12:10:Ie=h?10:8,i+="."+padStart(Ie,2,"0"),i+="."+k,i+="."+N+Y+me,i},fl=function(e){var i=toHexString(e[1]),r=toHexString(e[2]&252),o=toHexString(e[3]);return""+i+r+o},Fa=function(e){var i="",r=e[1]>>6,o=e[1]&31,d=(e[1]&32)>>5,h=e.subarray(2,6),g=e.subarray(6,12),k=e[12];r===1?i+="A":r===2?i+="B":r===3&&(i+="C"),i+=o+".";var N=parseInt(toBinaryString(h).split("").reverse().join(""),2);N>255&&(N=parseInt(toBinaryString(h),2)),i+=N.toString(16)+".",d===0?i+="L":i+="H",i+=k;for(var Y="",me=0;me<g.length;me++){var Ie=g[me];Ie&&(Y&&(Y+="."),Y+=Ie.toString(16))}return Y&&(i+="."+Y),i},pl=new Uint8Array([79,112,117,115,72,101,97,100]),vo=function(e){var i=new DataView(e.buffer,e.byteOffset,e.byteLength),r=i.getUint8(0),o=r!==0,d={version:r,channels:i.getUint8(1),preSkip:i.getUint16(2,o),sampleRate:i.getUint32(4,o),outputGain:i.getUint16(8,o),channelMappingFamily:i.getUint8(10)};if(d.channelMappingFamily>0&&e.length>10){d.streamCount=i.getUint8(11),d.twoChannelStreamCount=i.getUint8(12),d.channelMapping=[];for(var h=0;h<d.channels;h++)d.channelMapping.push(i.getUint8(13+h))}return d},ml=function(e){var i=e.channelMappingFamily<=0?11:12+e.channels,r=new DataView(new ArrayBuffer(i)),o=e.version!==0;return r.setUint8(0,e.version),r.setUint8(1,e.channels),r.setUint16(2,e.preSkip,o),r.setUint32(4,e.sampleRate,o),r.setUint16(8,e.outputGain,o),r.setUint8(10,e.channelMappingFamily),e.channelMappingFamily>0&&(r.setUint8(11,e.streamCount),e.channelMapping.foreach(function(d,h){r.setUint8(12+h,d)})),new Uint8Array(r.buffer)},ps=function(e){return typeof e=="string"?ht(e):(typeof e=="number",e)},gl=function(e){return Array.isArray(e)?e.map(function(i){return ps(i)}):[ps(e)]},aa,Na=function(e){e=pt(e);for(var i=[],r=0;e.length>r;){var o=e[r],d=0,h=0;h++;var g=e[h];for(h++;g&128;)d=(g&127)<<7,g=e[h],h++;d+=g&127;for(var k=0;k<aa.length;k++){var N=aa[k],Y=N.id,me=N.parser;if(o===Y){i.push(me(e.subarray(h,h+d)));break}}r+=d+h}return i};aa=[{id:3,parser:function(e){var i={tag:3,id:e[0]<<8|e[1],flags:e[2],size:3,dependsOnEsId:0,ocrEsId:0,descriptors:[],url:""};if(i.flags&128&&(i.dependsOnEsId=e[i.size]<<8|e[i.size+1],i.size+=2),i.flags&64){var r=e[i.size];i.url=Le(e.subarray(i.size+1,i.size+1+r)),i.size+=r}return i.flags&32&&(i.ocrEsId=e[i.size]<<8|e[i.size+1],i.size+=2),i.descriptors=Na(e.subarray(i.size))||[],i}},{id:4,parser:function(e){var i={tag:4,oti:e[0],streamType:e[1],bufferSize:e[2]<<16|e[3]<<8|e[4],maxBitrate:e[5]<<24|e[6]<<16|e[7]<<8|e[8],avgBitrate:e[9]<<24|e[10]<<16|e[11]<<8|e[12],descriptors:Na(e.subarray(13))};return i}},{id:5,parser:function(e){return{tag:5,bytes:e}}},{id:6,parser:function(e){return{tag:6,bytes:e}}}];var tn=function s(e,i,r){r===void 0&&(r=!1),i=gl(i),e=pt(e);var o=[];if(!i.length)return o;for(var d=0;d<e.length;){var h=(e[d]<<24|e[d+1]<<16|e[d+2]<<8|e[d+3])>>>0,g=e.subarray(d+4,d+8);if(h===0)break;var k=d+h;if(k>e.length){if(r)break;k=e.length}var N=e.subarray(d+8,k);Lt(g,i[0])&&(i.length===1?o.push(N):o.push.apply(o,s(N,i.slice(1),r))),d=k}return o},Dr=function(e,i){if(i=ps(i),!i.length)return e.subarray(e.length);for(var r=0;r<e.length;){if(bytesMatch(e.subarray(r,r+i.length),i)){var o=(e[r-4]<<24|e[r-3]<<16|e[r-2]<<8|e[r-1])>>>0,d=o>1?r+o:e.byteLength;return e.subarray(r+4,d)}r++}return e.subarray(e.length)},Ns=function(e,i,r){i===void 0&&(i=4),r===void 0&&(r=function(k){return bytesToNumber(k)});var o=[];if(!e||!e.length)return o;for(var d=bytesToNumber(e.subarray(4,8)),h=8;d;h+=i,d--)o.push(r(e.subarray(h,h+i)));return o},yl=function(e,i){for(var r=Ns(tn(e,["stss"])[0]),o=Ns(tn(e,["stco"])[0]),d=Ns(tn(e,["stts"])[0],8,function(pi){return{sampleCount:bytesToNumber(pi.subarray(0,4)),sampleDelta:bytesToNumber(pi.subarray(4,8))}}),h=Ns(tn(e,["stsc"])[0],12,function(pi){return{firstChunk:bytesToNumber(pi.subarray(0,4)),samplesPerChunk:bytesToNumber(pi.subarray(4,8)),sampleDescriptionIndex:bytesToNumber(pi.subarray(8,12))}}),g=tn(e,["stsz"])[0],k=Ns(g&&g.length&&g.subarray(4)||null),N=[],Y=0;Y<o.length;Y++){for(var me=void 0,Ie=0;Ie<h.length;Ie++){var Pe=h[Ie],Ae=Y+1>=Pe.firstChunk&&(Ie+1>=h.length||Y+1<h[Ie+1].firstChunk);if(Ae){me=Pe.samplesPerChunk;break}}for(var $e=o[Y],Ye=0;Ye<me;Ye++){var Qe=k[N.length],qe=!r.length;r.length&&r.indexOf(N.length+1)!==-1&&(qe=!0);for(var ct={keyframe:qe,start:$e,end:$e+Qe},Je=0;Je<d.length;Je++){var je=d[Je],_t=je.sampleCount,jt=je.sampleDelta;if(N.length<=_t){var di=N.length?N[N.length-1].timestamp:0;ct.timestamp=di+jt/i*1e3,ct.duration=jt;break}}N.push(ct),$e+=Qe}}return N},vl=function(e,i){var r=bytesToString(i.subarray(0,4));if(e.type==="video"?(e.info=e.info||{},e.info.width=i[28]<<8|i[29],e.info.height=i[30]<<8|i[31]):e.type==="audio"&&(e.info=e.info||{},e.info.channels=i[20]<<8|i[21],e.info.bitDepth=i[22]<<8|i[23],e.info.sampleRate=i[28]<<8|i[29]),r==="avc1"){var o=Dr(i,"avcC");r+="."+getAvcCodec(o),e.info.avcC=o}else if(r==="hvc1"||r==="hev1")r+="."+getHvcCodec(Dr(i,"hvcC"));else if(r==="mp4a"||r==="mp4v"){var d=Dr(i,"esds"),h=Na(d.subarray(4))[0],g=h&&h.descriptors.filter(function(qe){var ct=qe.tag;return ct===4})[0];g?(r+="."+toHexString(g.oti),g.oti===64?r+="."+(g.descriptors[0].bytes[0]>>3).toString():g.oti===32?r+="."+g.descriptors[0].bytes[4].toString():g.oti===221&&(r="vorbis")):e.type==="audio"?r+=".40.2":r+=".20.9"}else if(r==="av01")r+="."+getAv1Codec(Dr(i,"av1C"));else if(r==="vp09"){var k=Dr(i,"vpcC"),N=k[0],Y=k[1],me=k[2]>>4,Ie=(k[2]&15)>>1,Pe=(k[2]&15)>>3,Ae=k[3],$e=k[4],Ye=k[5];r+="."+padStart(N,2,"0"),r+="."+padStart(Y,2,"0"),r+="."+padStart(me,2,"0"),r+="."+padStart(Ie,2,"0"),r+="."+padStart(Ae,2,"0"),r+="."+padStart($e,2,"0"),r+="."+padStart(Ye,2,"0"),r+="."+padStart(Pe,2,"0")}else if(r==="theo")r="theora";else if(r==="spex")r="speex";else if(r===".mp3")r="mp4a.40.34";else if(r==="msVo")r="vorbis";else if(r==="Opus"){r="opus";var Qe=Dr(i,"dOps");e.info.opus=parseOpusHead(Qe),e.info.codecDelay=65e5}else r=r.toLowerCase();e.codec=r},yn=function(e,i){i===void 0&&(i=!0),e=toUint8(e);var r=tn(e,["moov","trak"],!0),o=[];return r.forEach(function(d){var h={bytes:d},g=tn(d,["mdia"])[0],k=tn(g,["hdlr"])[0],N=bytesToString(k.subarray(8,12));N==="soun"?h.type="audio":N==="vide"?h.type="video":h.type=N;var Y=tn(d,["tkhd"])[0];if(Y){var me=new DataView(Y.buffer,Y.byteOffset,Y.byteLength),Ie=me.getUint8(0);h.number=Ie===0?me.getUint32(12):me.getUint32(20)}var Pe=tn(g,["mdhd"])[0];if(Pe){var Ae=Pe[0],$e=Ae===0?12:20;h.timescale=(Pe[$e]<<24|Pe[$e+1]<<16|Pe[$e+2]<<8|Pe[$e+3])>>>0}for(var Ye=tn(g,["minf","stbl"])[0],Qe=tn(Ye,["stsd"])[0],qe=bytesToNumber(Qe.subarray(4,8)),ct=8;qe--;){var Je=bytesToNumber(Qe.subarray(ct,ct+4)),je=Qe.subarray(ct+4,ct+4+Je);vl(h,je),ct+=4+Je}i&&(h.frameTable=yl(Ye,h.timescale)),o.push(h)}),o},zn=function(e){var i=tn(e,["moov","mvhd"],!0)[0];if(!(!i||!i.length)){var r={};return i[0]===1?(r.timestampScale=bytesToNumber(i.subarray(20,24)),r.duration=bytesToNumber(i.subarray(24,32))):(r.timestampScale=bytesToNumber(i.subarray(12,16)),r.duration=bytesToNumber(i.subarray(16,20))),r.bytes=i,r}},Ci={EBML:pt([26,69,223,163]),DocType:pt([66,130]),Segment:pt([24,83,128,103]),SegmentInfo:pt([21,73,169,102]),Tracks:pt([22,84,174,107]),Track:pt([174]),TrackNumber:pt([215]),DefaultDuration:pt([35,227,131]),TrackEntry:pt([174]),TrackType:pt([131]),FlagDefault:pt([136]),CodecID:pt([134]),CodecPrivate:pt([99,162]),VideoTrack:pt([224]),AudioTrack:pt([225]),Cluster:pt([31,67,182,117]),Timestamp:pt([231]),TimestampScale:pt([42,215,177]),BlockGroup:pt([160]),BlockDuration:pt([155]),Block:pt([161]),SimpleBlock:pt([163])},Ua=[128,64,32,16,8,4,2,1],ja=function(e){for(var i=1,r=0;r<Ua.length&&!(e&Ua[r]);r++)i++;return i},yr=function(e,i,r,o){r===void 0&&(r=!0),o===void 0&&(o=!1);var d=ja(e[i]),h=e.subarray(i,i+d);return r&&(h=Array.prototype.slice.call(e,i,i+d),h[0]^=Ua[d-1]),{length:d,value:Tn(h,{signed:o}),bytes:h}},Ao=function s(e){return typeof e=="string"?e.match(/.{1,2}/g).map(function(i){return s(i)}):typeof e=="number"?Xe(e):e},oa=function(e){return Array.isArray(e)?e.map(function(i){return Ao(i)}):[Ao(e)]},jn=function s(e,i,r){if(r>=i.length)return i.length;var o=yr(i,r,!1);if(Lt(e.bytes,o.bytes))return r;var d=yr(i,r+o.length);return s(e,i,r+d.length+d.value+o.length)},ei=function s(e,i){i=oa(i),e=pt(e);var r=[];if(!i.length)return r;for(var o=0;o<e.length;){var d=yr(e,o,!1),h=yr(e,o+d.length),g=o+d.length+h.length;h.value===127&&(h.value=jn(d,e,g),h.value!==e.length&&(h.value-=g));var k=g+h.value>e.length?e.length:g+h.value,N=e.subarray(g,k);Lt(i[0],d.bytes)&&(i.length===1?r.push(N):r=r.concat(s(N,i.slice(1))));var Y=d.length+h.length+N.length;o+=Y}return r},Al=function(e,i,r,o){var d;i==="group"&&(d=ei(e,[Ci.BlockDuration])[0],d&&(d=bytesToNumber(d),d=1/r*d*r/1e3),e=ei(e,[Ci.Block])[0],i="block");var h=new DataView(e.buffer,e.byteOffset,e.byteLength),g=yr(e,0),k=h.getInt16(g.length,!1),N=e[g.length+2],Y=e.subarray(g.length+3),me=1/r*(o+k)*r/1e3,Ie={duration:d,trackNumber:g.value,keyframe:i==="simple"&&N>>7==1,invisible:(N&8)>>3==1,lacing:(N&6)>>1,discardable:i==="simple"&&(N&1)==1,frames:[],pts:me,dts:me,timestamp:k};if(!Ie.lacing)return Ie.frames.push(Y),Ie;var Pe=Y[0]+1,Ae=[],$e=1;if(Ie.lacing===2)for(var Ye=(Y.length-$e)/Pe,Qe=0;Qe<Pe;Qe++)Ae.push(Ye);if(Ie.lacing===1)for(var qe=0;qe<Pe-1;qe++){var ct=0;do ct+=Y[$e],$e++;while(Y[$e-1]===255);Ae.push(ct)}if(Ie.lacing===3)for(var Je=0,je=0;je<Pe-1;je++){var _t=je===0?yr(Y,$e):yr(Y,$e,!0,!0);Je+=_t.value,Ae.push(Je),$e+=_t.length}return Ae.forEach(function(jt){Ie.frames.push(Y.subarray($e,$e+jt)),$e+=jt}),Ie},Ir=function(e){for(var i=0,r={};i<e.length;){var o=e[i]&127,d=e[i+1],h=void 0;d===1?h=e[i+2]:h=e.subarray(i+2,i+2+d),o===1?r.profile=h:o===2?r.level=h:o===3?r.bitDepth=h:o===4?r.chromaSubsampling=h:r[o]=h,i+=2+d}return r},Jr=function(e){e=toUint8(e);var i=[],r=ei(e,[Ci.Segment,Ci.Tracks,Ci.Track]);return r.length||(r=ei(e,[Ci.Tracks,Ci.Track])),r.length||(r=ei(e,[Ci.Track])),r.length?(r.forEach(function(o){var d=ei(o,Ci.TrackType)[0];if(!(!d||!d.length)){if(d[0]===1)d="video";else if(d[0]===2)d="audio";else if(d[0]===17)d="subtitle";else return;var h={rawCodec:bytesToString(ei(o,[Ci.CodecID])[0]),type:d,codecPrivate:ei(o,[Ci.CodecPrivate])[0],number:bytesToNumber(ei(o,[Ci.TrackNumber])[0]),defaultDuration:bytesToNumber(ei(o,[Ci.DefaultDuration])[0]),default:ei(o,[Ci.FlagDefault])[0],rawData:o},g="";if(/V_MPEG4\/ISO\/AVC/.test(h.rawCodec))g="avc1."+getAvcCodec(h.codecPrivate);else if(/V_MPEGH\/ISO\/HEVC/.test(h.rawCodec))g="hev1."+getHvcCodec(h.codecPrivate);else if(/V_MPEG4\/ISO\/ASP/.test(h.rawCodec))h.codecPrivate?g="mp4v.20."+h.codecPrivate[4].toString():g="mp4v.20.9";else if(/^V_THEORA/.test(h.rawCodec))g="theora";else if(/^V_VP8/.test(h.rawCodec))g="vp8";else if(/^V_VP9/.test(h.rawCodec))if(h.codecPrivate){var k=Ir(h.codecPrivate),N=k.profile,Y=k.level,me=k.bitDepth,Ie=k.chromaSubsampling;g="vp09.",g+=padStart(N,2,"0")+".",g+=padStart(Y,2,"0")+".",g+=padStart(me,2,"0")+".",g+=""+padStart(Ie,2,"0");var Pe=ei(o,[224,[85,176],[85,177]])[0]||[],Ae=ei(o,[224,[85,176],[85,185]])[0]||[],$e=ei(o,[224,[85,176],[85,186]])[0]||[],Ye=ei(o,[224,[85,176],[85,187]])[0]||[];(Pe.length||Ae.length||$e.length||Ye.length)&&(g+="."+padStart(Ye[0],2,"0"),g+="."+padStart($e[0],2,"0"),g+="."+padStart(Pe[0],2,"0"),g+="."+padStart(Ae[0],2,"0"))}else g="vp9";else/^V_AV1/.test(h.rawCodec)?g="av01."+getAv1Codec(h.codecPrivate):/A_ALAC/.test(h.rawCodec)?g="alac":/A_MPEG\/L2/.test(h.rawCodec)?g="mp2":/A_MPEG\/L3/.test(h.rawCodec)?g="mp3":/^A_AAC/.test(h.rawCodec)?h.codecPrivate?g="mp4a.40."+(h.codecPrivate[0]>>>3).toString():g="mp4a.40.2":/^A_AC3/.test(h.rawCodec)?g="ac-3":/^A_PCM/.test(h.rawCodec)?g="pcm":/^A_MS\/ACM/.test(h.rawCodec)?g="speex":/^A_EAC3/.test(h.rawCodec)?g="ec-3":/^A_VORBIS/.test(h.rawCodec)?g="vorbis":/^A_FLAC/.test(h.rawCodec)?g="flac":/^A_OPUS/.test(h.rawCodec)&&(g="opus");h.codec=g,i.push(h)}}),i.sort(function(o,d){return o.number-d.number})):i},bl=function(e,i){var r=[],o=ei(e,[Ci.Segment])[0],d=ei(o,[Ci.SegmentInfo,Ci.TimestampScale])[0];d&&d.length?d=bytesToNumber(d):d=1e6;var h=ei(o,[Ci.Cluster]);return i||(i=Jr(o)),h.forEach(function(g,k){var N=ei(g,[Ci.SimpleBlock]).map(function(Pe){return{type:"simple",data:Pe}}),Y=ei(g,[Ci.BlockGroup]).map(function(Pe){return{type:"group",data:Pe}}),me=ei(g,[Ci.Timestamp])[0]||0;me&&me.length&&(me=bytesToNumber(me));var Ie=N.concat(Y).sort(function(Pe,Ae){return Pe.data.byteOffset-Ae.data.byteOffset});Ie.forEach(function(Pe,Ae){var $e=Al(Pe.data,Pe.type,d,me);r.push($e)})}),{tracks:i,blocks:r}},bo=pt([0,0,0,1]),Zr=pt([0,0,1]),_o=pt([0,0,3]),vr=function(e){for(var i=[],r=1;r<e.length-2;)Lt(e.subarray(r,r+3),_o)&&(i.push(r+2),r++),r++;if(i.length===0)return e;var o=e.length-i.length,d=new Uint8Array(o),h=0;for(r=0;r<o;h++,r++)h===i[0]&&(h++,i.shift()),d[r]=e[h];return d},xo=function(e,i,r,o){o===void 0&&(o=Infinity),e=pt(e),r=[].concat(r);for(var d=0,h,g=0;d<e.length&&(g<o||h);){var k=void 0;if(Lt(e.subarray(d),bo)?k=4:Lt(e.subarray(d),Zr)&&(k=3),!k){d++;continue}if(g++,h)return vr(e.subarray(h,d));var N=void 0;i==="h264"?N=e[d+k]&31:i==="h265"&&(N=e[d+k]>>1&63),r.indexOf(N)!==-1&&(h=d+k),d+=k+(i==="h264"?1:2)}return e.subarray(0,0)},Us=function(e,i,r){return xo(e,"h264",i,r)},_l=function(e,i,r){return xo(e,"h265",i,r)},ni={webm:pt([119,101,98,109]),matroska:pt([109,97,116,114,111,115,107,97]),flac:pt([102,76,97,67]),ogg:pt([79,103,103,83]),ac3:pt([11,119]),riff:pt([82,73,70,70]),avi:pt([65,86,73]),wav:pt([87,65,86,69]),"3gp":pt([102,116,121,112,51,103]),mp4:pt([102,116,121,112]),fmp4:pt([115,116,121,112]),mov:pt([102,116,121,112,113,116]),moov:pt([109,111,111,118]),moof:pt([109,111,111,102])},$n={aac:function(e){var i=Fs(e);return Lt(e,[255,16],{offset:i,mask:[255,22]})},mp3:function(e){var i=Fs(e);return Lt(e,[255,2],{offset:i,mask:[255,6]})},webm:function(e){var i=ei(e,[Ci.EBML,Ci.DocType])[0];return Lt(i,ni.webm)},mkv:function(e){var i=ei(e,[Ci.EBML,Ci.DocType])[0];return Lt(i,ni.matroska)},mp4:function(e){if($n["3gp"](e)||$n.mov(e))return!1;if(Lt(e,ni.mp4,{offset:4})||Lt(e,ni.fmp4,{offset:4})||Lt(e,ni.moof,{offset:4})||Lt(e,ni.moov,{offset:4}))return!0},mov:function(e){return Lt(e,ni.mov,{offset:4})},"3gp":function(e){return Lt(e,ni["3gp"],{offset:4})},ac3:function(e){var i=Fs(e);return Lt(e,ni.ac3,{offset:i})},ts:function(e){if(e.length<189&&e.length>=1)return e[0]===71;for(var i=0;i+188<e.length&&i<188;){if(e[i]===71&&e[i+188]===71)return!0;i+=1}return!1},flac:function(e){var i=Fs(e);return Lt(e,ni.flac,{offset:i})},ogg:function(e){return Lt(e,ni.ogg)},avi:function(e){return Lt(e,ni.riff)&&Lt(e,ni.avi,{offset:8})},wav:function(e){return Lt(e,ni.riff)&&Lt(e,ni.wav,{offset:8})},h264:function(e){return Us(e,7,3).length},h265:function(e){return _l(e,[32,33],3).length}},ms=Object.keys($n).filter(function(s){return s!=="ts"&&s!=="h264"&&s!=="h265"}).concat(["ts","h264","h265"]);ms.forEach(function(s){var e=$n[s];$n[s]=function(i){return e(pt(i))}});var Eo=$n,$a=function(e){e=pt(e);for(var i=0;i<ms.length;i++){var r=ms[i];if(Eo[r](e))return r}return""},js=function(e){return tn(e,["moof"]).length>0},$s=ft(81351);/**
 * @license
 * Video.js 8.6.1 <http://videojs.com/>
 * Copyright Brightcove, Inc. <https://www.brightcove.com/>
 * Available under Apache License Version 2.0
 * <https://github.com/videojs/video.js/blob/main/LICENSE>
 *
 * Includes vtt.js <https://github.com/mozilla/vtt.js>
 * Available under Apache License Version 2.0
 * <https://github.com/mozilla/vtt.js/blob/main/LICENSE>
 */var la="8.6.1";const Ar={},Vn=function(s,e){return Ar[s]=Ar[s]||[],e&&(Ar[s]=Ar[s].concat(e)),Ar[s]},xl=function(s,e){Vn(s,e)},Va=function(s,e){const i=Vn(s).indexOf(e);return i<=-1?!1:(Ar[s]=Ar[s].slice(),Ar[s].splice(i,1),!0)},El=function(s,e){Vn(s,[].concat(e).map(i=>{const r=(...o)=>(Va(s,r),i(...o));return r}))},Rr={prefixed:!0},ua=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"]],To=ua[0];let Vs;for(let s=0;s<ua.length;s++)if(ua[s][1]in _e()){Vs=ua[s];break}if(Vs){for(let s=0;s<Vs.length;s++)Rr[To[s]]=Vs[s];Rr.prefixed=Vs[0]!==To[0]}let Yi=[];const Tl=(s,e,i)=>(r,o,d)=>{const h=e.levels[o],g=new RegExp(`^(${h})$`);let k=s;if(r!=="log"&&d.unshift(r.toUpperCase()+":"),i&&(k=`%c${s}`,d.unshift(i)),d.unshift(k+":"),Yi){Yi.push([].concat(d));const Y=Yi.length-1e3;Yi.splice(0,Y>0?Y:0)}if(!ae().console)return;let N=ae().console[r];!N&&r==="debug"&&(N=ae().console.info||ae().console.log),!(!N||!h||!g.test(r))&&N[Array.isArray(d)?"apply":"call"](ae().console,d)};function st(s,e=":",i=""){let r="info",o;const d=function(...h){o("log",r,h)};return o=Tl(s,d,i),d.createLogger=(h,g,k)=>{const N=g!==void 0?g:e,Y=k!==void 0?k:i,me=`${s} ${N} ${h}`;return st(me,N,Y)},d.createNewLogger=(h,g,k)=>st(h,g,k),d.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:r},d.level=h=>{if(typeof h=="string"){if(!d.levels.hasOwnProperty(h))throw new Error(`"${h}" in not a valid log level`);r=h}return r},d.history=()=>Yi?[].concat(Yi):[],d.history.filter=h=>(Yi||[]).filter(g=>new RegExp(`.*${h}.*`).test(g[0])),d.history.clear=()=>{Yi&&(Yi.length=0)},d.history.disable=()=>{Yi!==null&&(Yi.length=0,Yi=null)},d.history.enable=()=>{Yi===null&&(Yi=[])},d.error=(...h)=>o("error",r,h),d.warn=(...h)=>o("warn",r,h),d.debug=(...h)=>o("debug",r,h),d}const ri=st("VIDEOJS"),es=ri.createLogger,Sl=Object.prototype.toString,So=function(s){return nr(s)?Object.keys(s):[]};function gs(s,e){So(s).forEach(i=>e(s[i],i))}function ys(s,e,i=0){return So(s).reduce((r,o)=>e(r,s[o],o),i)}function nr(s){return!!s&&typeof s=="object"}function vn(s){return nr(s)&&Sl.call(s)==="[object Object]"&&s.constructor===Object}function ci(...s){const e={};return s.forEach(i=>{!i||gs(i,(r,o)=>{if(!vn(r)){e[o]=r;return}vn(e[o])||(e[o]={}),e[o]=ci(e[o],r)})}),e}function Co(s={}){const e=[];for(const i in s)if(s.hasOwnProperty(i)){const r=s[i];e.push(r)}return e}function da(s,e,i,r=!0){const o=h=>Object.defineProperty(s,e,{value:h,enumerable:!0,writable:!0}),d={configurable:!0,enumerable:!0,get(){const h=i();return o(h),h}};return r&&(d.set=o),Object.defineProperty(s,e,d)}var wo=Object.freeze({__proto__:null,each:gs,reduce:ys,isObject:nr,isPlain:vn,merge:ci,values:Co,defineLazyProperty:da});let Or=!1,ca=null,on=!1,vs,ha=!1,As=!1,ts=!1,An=!1,Ha=null,Hs=null,Lo=null,Pr=!1,fa=!1,is=!1,pa=!1;const br=Boolean(xs()&&("ontouchstart"in ae()||ae().navigator.maxTouchPoints||ae().DocumentTouch&&ae().document instanceof ae().DocumentTouch)),bs=ae().navigator&&ae().navigator.userAgentData;if(bs&&(on=bs.platform==="Android",As=Boolean(bs.brands.find(s=>s.brand==="Microsoft Edge")),ts=Boolean(bs.brands.find(s=>s.brand==="Chromium")),An=!As&&ts,Ha=Hs=(bs.brands.find(s=>s.brand==="Chromium")||{}).version||null,fa=bs.platform==="Windows"),!ts){const s=ae().navigator&&ae().navigator.userAgent||"";Or=/iPod/i.test(s),ca=function(){const e=s.match(/OS (\d+)_/i);return e&&e[1]?e[1]:null}(),on=/Android/i.test(s),vs=function(){const e=s.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;const i=e[1]&&parseFloat(e[1]),r=e[2]&&parseFloat(e[2]);return i&&r?parseFloat(e[1]+"."+e[2]):i||null}(),ha=/Firefox/i.test(s),As=/Edg/i.test(s),ts=/Chrome/i.test(s)||/CriOS/i.test(s),An=!As&&ts,Ha=Hs=function(){const e=s.match(/(Chrome|CriOS)\/(\d+)/);return e&&e[2]?parseFloat(e[2]):null}(),Lo=function(){const e=/MSIE\s(\d+)\.\d/.exec(s);let i=e&&parseFloat(e[1]);return!i&&/Trident\/7.0/i.test(s)&&/rv:11.0/.test(s)&&(i=11),i}(),Pr=/Safari/i.test(s)&&!An&&!on&&!As,fa=/Windows/i.test(s),is=/iPad/i.test(s)||Pr&&br&&!/iPhone/i.test(s),pa=/iPhone/i.test(s)&&!is}const bn=pa||is||Or,Gs=(Pr||bn)&&!An;var _s=Object.freeze({__proto__:null,get IS_IPOD(){return Or},get IOS_VERSION(){return ca},get IS_ANDROID(){return on},get ANDROID_VERSION(){return vs},get IS_FIREFOX(){return ha},get IS_EDGE(){return As},get IS_CHROMIUM(){return ts},get IS_CHROME(){return An},get CHROMIUM_VERSION(){return Ha},get CHROME_VERSION(){return Hs},get IE_VERSION(){return Lo},get IS_SAFARI(){return Pr},get IS_WINDOWS(){return fa},get IS_IPAD(){return is},get IS_IPHONE(){return pa},TOUCH_ENABLED:br,IS_IOS:bn,IS_ANY_SAFARI:Gs});function ma(s){return typeof s=="string"&&Boolean(s.trim())}function ko(s){if(s.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}function xs(){return _e()===ae().document}function rr(s){return nr(s)&&s.nodeType===1}function Ga(){try{return ae().parent!==ae().self}catch(s){return!0}}function Do(s){return function(e,i){if(!ma(e))return _e()[s](null);ma(i)&&(i=_e().querySelector(i));const r=rr(i)?i:_e();return r[s]&&r[s](e)}}function $t(s="div",e={},i={},r){const o=_e().createElement(s);return Object.getOwnPropertyNames(e).forEach(function(d){const h=e[d];d==="textContent"?_n(o,h):(o[d]!==h||d==="tabIndex")&&(o[d]=h)}),Object.getOwnPropertyNames(i).forEach(function(d){o.setAttribute(d,i[d])}),r&&ce(o,r),o}function _n(s,e){return typeof s.textContent=="undefined"?s.innerText=e:s.textContent=e,s}function Es(s,e){e.firstChild?e.insertBefore(s,e.firstChild):e.appendChild(s)}function Yn(s,e){return ko(e),s.classList.contains(e)}function Br(s,...e){return s.classList.add(...e.reduce((i,r)=>i.concat(r.split(/\s+/)),[])),s}function ga(s,...e){return s?(s.classList.remove(...e.reduce((i,r)=>i.concat(r.split(/\s+/)),[])),s):(ri.warn("removeClass was called with an element that doesn't exist"),null)}function Mr(s,e,i){return typeof i=="function"&&(i=i(s,e)),typeof i!="boolean"&&(i=void 0),e.split(/\s+/).forEach(r=>s.classList.toggle(r,i)),s}function ns(s,e){Object.getOwnPropertyNames(e).forEach(function(i){const r=e[i];r===null||typeof r=="undefined"||r===!1?s.removeAttribute(i):s.setAttribute(i,r===!0?"":r)})}function _r(s){const e={},i=["autoplay","controls","playsinline","loop","muted","default","defaultMuted"];if(s&&s.attributes&&s.attributes.length>0){const r=s.attributes;for(let o=r.length-1;o>=0;o--){const d=r[o].name;let h=r[o].value;i.includes(d)&&(h=h!==null),e[d]=h}}return e}function Fr(s,e){return s.getAttribute(e)}function Rn(s,e,i){s.setAttribute(e,i)}function Ve(s,e){s.removeAttribute(e)}function qa(){_e().body.focus(),_e().onselectstart=function(){return!1}}function x(){_e().onselectstart=function(){return!0}}function L(s){if(s&&s.getBoundingClientRect&&s.parentNode){const e=s.getBoundingClientRect(),i={};return["bottom","height","left","right","top","width"].forEach(r=>{e[r]!==void 0&&(i[r]=e[r])}),i.height||(i.height=parseFloat(At(s,"height"))),i.width||(i.width=parseFloat(At(s,"width"))),i}}function q(s){if(!s||s&&!s.offsetParent)return{left:0,top:0,width:0,height:0};const e=s.offsetWidth,i=s.offsetHeight;let r=0,o=0;for(;s.offsetParent&&s!==_e()[Rr.fullscreenElement];)r+=s.offsetLeft,o+=s.offsetTop,s=s.offsetParent;return{left:r,top:o,width:e,height:i}}function _(s,e){const i={x:0,y:0};if(bn){let Y=s;for(;Y&&Y.nodeName.toLowerCase()!=="html";){const me=At(Y,"transform");if(/^matrix/.test(me)){const Ie=me.slice(7,-1).split(/,\s/).map(Number);i.x+=Ie[4],i.y+=Ie[5]}else if(/^matrix3d/.test(me)){const Ie=me.slice(9,-1).split(/,\s/).map(Number);i.x+=Ie[12],i.y+=Ie[13]}Y=Y.parentNode}}const r={},o=q(e.target),d=q(s),h=d.width,g=d.height;let k=e.offsetY-(d.top-o.top),N=e.offsetX-(d.left-o.left);return e.changedTouches&&(N=e.changedTouches[0].pageX-d.left,k=e.changedTouches[0].pageY+d.top,bn&&(N-=i.x,k-=i.y)),r.y=1-Math.max(0,Math.min(1,k/g)),r.x=Math.max(0,Math.min(1,N/h)),r}function R(s){return nr(s)&&s.nodeType===3}function B(s){for(;s.firstChild;)s.removeChild(s.firstChild);return s}function X(s){return typeof s=="function"&&(s=s()),(Array.isArray(s)?s:[s]).map(e=>{if(typeof e=="function"&&(e=e()),rr(e)||R(e))return e;if(typeof e=="string"&&/\S/.test(e))return _e().createTextNode(e)}).filter(e=>e)}function ce(s,e){return X(e).forEach(i=>s.appendChild(i)),s}function pe(s,e){return ce(B(s),e)}function Ue(s){return s.button===void 0&&s.buttons===void 0||s.button===0&&s.buttons===void 0||s.type==="mouseup"&&s.button===0&&s.buttons===0?!0:!(s.button!==0||s.buttons!==1)}const He=Do("querySelector"),yt=Do("querySelectorAll");function At(s,e){if(!s||!e)return"";if(typeof ae().getComputedStyle=="function"){let i;try{i=ae().getComputedStyle(s)}catch(r){return""}return i?i.getPropertyValue(e)||i[e]:""}return""}function Dt(s){[..._e().styleSheets].forEach(e=>{try{const i=[...e.cssRules].map(o=>o.cssText).join(""),r=_e().createElement("style");r.textContent=i,s.document.head.appendChild(r)}catch(i){const r=_e().createElement("link");r.rel="stylesheet",r.type=e.type,r.media=e.media.mediaText,r.href=e.href,s.document.head.appendChild(r)}})}var Et=Object.freeze({__proto__:null,isReal:xs,isEl:rr,isInFrame:Ga,createEl:$t,textContent:_n,prependTo:Es,hasClass:Yn,addClass:Br,removeClass:ga,toggleClass:Mr,setAttributes:ns,getAttributes:_r,getAttribute:Fr,setAttribute:Rn,removeAttribute:Ve,blockTextSelection:qa,unblockTextSelection:x,getBoundingClientRect:L,findPosition:q,getPointerPosition:_,isTextNode:R,emptyEl:B,normalizeContent:X,appendContent:ce,insertContent:pe,isSingleLeftClick:Ue,$:He,$$:yt,computedStyle:At,copyStyleSheetsToWindow:Dt});let vt=!1,Bt;const Yt=function(){if(Bt.options.autoSetup===!1)return;const s=Array.prototype.slice.call(_e().getElementsByTagName("video")),e=Array.prototype.slice.call(_e().getElementsByTagName("audio")),i=Array.prototype.slice.call(_e().getElementsByTagName("video-js")),r=s.concat(e,i);if(r&&r.length>0)for(let o=0,d=r.length;o<d;o++){const h=r[o];if(h&&h.getAttribute)h.player===void 0&&h.getAttribute("data-setup")!==null&&Bt(h);else{Fi(1);break}}else vt||Fi(1)};function Fi(s,e){!xs()||(e&&(Bt=e),ae().setTimeout(Yt,s))}function hi(){vt=!0,ae().removeEventListener("load",hi)}xs()&&(_e().readyState==="complete"?hi():ae().addEventListener("load",hi));const fi=function(s){const e=_e().createElement("style");return e.className=s,e},sr=function(s,e){s.styleSheet?s.styleSheet.cssText=e:s.textContent=e};var Hi=new WeakMap;let Nr=3;function Xn(){return Nr++}function pu(s,e){if(!Hi.has(s))return;const i=Hi.get(s);i.handlers[e].length===0&&(delete i.handlers[e],s.removeEventListener?s.removeEventListener(e,i.dispatcher,!1):s.detachEvent&&s.detachEvent("on"+e,i.dispatcher)),Object.getOwnPropertyNames(i.handlers).length<=0&&(delete i.handlers,delete i.dispatcher,delete i.disabled),Object.getOwnPropertyNames(i).length===0&&Hi.delete(s)}function Io(s,e,i,r){i.forEach(function(o){s(e,o,r)})}function Ro(s){if(s.fixed_)return s;function e(){return!0}function i(){return!1}if(!s||!s.isPropagationStopped||!s.isImmediatePropagationStopped){const r=s||ae().event;s={};for(const o in r)o!=="layerX"&&o!=="layerY"&&o!=="keyLocation"&&o!=="webkitMovementX"&&o!=="webkitMovementY"&&o!=="path"&&(o==="returnValue"&&r.preventDefault||(s[o]=r[o]));if(s.target||(s.target=s.srcElement||_e()),s.relatedTarget||(s.relatedTarget=s.fromElement===s.target?s.toElement:s.fromElement),s.preventDefault=function(){r.preventDefault&&r.preventDefault(),s.returnValue=!1,r.returnValue=!1,s.defaultPrevented=!0},s.defaultPrevented=!1,s.stopPropagation=function(){r.stopPropagation&&r.stopPropagation(),s.cancelBubble=!0,r.cancelBubble=!0,s.isPropagationStopped=e},s.isPropagationStopped=i,s.stopImmediatePropagation=function(){r.stopImmediatePropagation&&r.stopImmediatePropagation(),s.isImmediatePropagationStopped=e,s.stopPropagation()},s.isImmediatePropagationStopped=i,s.clientX!==null&&s.clientX!==void 0){const o=_e().documentElement,d=_e().body;s.pageX=s.clientX+(o&&o.scrollLeft||d&&d.scrollLeft||0)-(o&&o.clientLeft||d&&d.clientLeft||0),s.pageY=s.clientY+(o&&o.scrollTop||d&&d.scrollTop||0)-(o&&o.clientTop||d&&d.clientTop||0)}s.which=s.charCode||s.keyCode,s.button!==null&&s.button!==void 0&&(s.button=s.button&1?0:s.button&4?1:s.button&2?2:0)}return s.fixed_=!0,s}let ya;const Cl=function(){if(typeof ya!="boolean"){ya=!1;try{const s=Object.defineProperty({},"passive",{get(){ya=!0}});ae().addEventListener("test",null,s),ae().removeEventListener("test",null,s)}catch(s){}}return ya},mu=["touchstart","touchmove"];function Qn(s,e,i){if(Array.isArray(e))return Io(Qn,s,e,i);Hi.has(s)||Hi.set(s,{});const r=Hi.get(s);if(r.handlers||(r.handlers={}),r.handlers[e]||(r.handlers[e]=[]),i.guid||(i.guid=Xn()),r.handlers[e].push(i),r.dispatcher||(r.disabled=!1,r.dispatcher=function(o,d){if(r.disabled)return;o=Ro(o);const h=r.handlers[o.type];if(h){const g=h.slice(0);for(let k=0,N=g.length;k<N&&!o.isImmediatePropagationStopped();k++)try{g[k].call(s,o,d)}catch(Y){ri.error(Y)}}}),r.handlers[e].length===1)if(s.addEventListener){let o=!1;Cl()&&mu.indexOf(e)>-1&&(o={passive:!0}),s.addEventListener(e,r.dispatcher,o)}else s.attachEvent&&s.attachEvent("on"+e,r.dispatcher)}function pn(s,e,i){if(!Hi.has(s))return;const r=Hi.get(s);if(!r.handlers)return;if(Array.isArray(e))return Io(pn,s,e,i);const o=function(h,g){r.handlers[g]=[],pu(h,g)};if(e===void 0){for(const h in r.handlers)Object.prototype.hasOwnProperty.call(r.handlers||{},h)&&o(s,h);return}const d=r.handlers[e];if(!!d){if(!i){o(s,e);return}if(i.guid)for(let h=0;h<d.length;h++)d[h].guid===i.guid&&d.splice(h--,1);pu(s,e)}}function va(s,e,i){const r=Hi.has(s)?Hi.get(s):{},o=s.parentNode||s.ownerDocument;if(typeof e=="string"?e={type:e,target:s}:e.target||(e.target=s),e=Ro(e),r.dispatcher&&r.dispatcher.call(s,e,i),o&&!e.isPropagationStopped()&&e.bubbles===!0)va.call(null,o,e,i);else if(!o&&!e.defaultPrevented&&e.target&&e.target[e.type]){Hi.has(e.target)||Hi.set(e.target,{});const d=Hi.get(e.target);e.target[e.type]&&(d.disabled=!0,typeof e.target[e.type]=="function"&&e.target[e.type](),d.disabled=!1)}return!e.defaultPrevented}function Oo(s,e,i){if(Array.isArray(e))return Io(Oo,s,e,i);const r=function(){pn(s,e,r),i.apply(this,arguments)};r.guid=i.guid=i.guid||Xn(),Qn(s,e,r)}function wl(s,e,i){const r=function(){pn(s,e,r),i.apply(this,arguments)};r.guid=i.guid=i.guid||Xn(),Qn(s,e,r)}var kd=Object.freeze({__proto__:null,fixEvent:Ro,on:Qn,off:pn,trigger:va,one:Oo,any:wl});const ar=30,gi=function(s,e,i){e.guid||(e.guid=Xn());const r=e.bind(s);return r.guid=i?i+"_"+e.guid:e.guid,r},Ur=function(s,e){let i=ae().performance.now();return function(...o){const d=ae().performance.now();d-i>=e&&(s(...o),i=d)}},gu=function(s,e,i,r=ae()){let o;const d=()=>{r.clearTimeout(o),o=null},h=function(){const g=this,k=arguments;let N=function(){o=null,N=null,i||s.apply(g,k)};!o&&i&&s.apply(g,k),r.clearTimeout(o),o=r.setTimeout(N,e)};return h.cancel=d,h};var yu=Object.freeze({__proto__:null,UPDATE_REFRESH_INTERVAL:ar,bind_:gi,throttle:Ur,debounce:gu});let Wa;class Jn{on(e,i){const r=this.addEventListener;this.addEventListener=()=>{},Qn(this,e,i),this.addEventListener=r}off(e,i){pn(this,e,i)}one(e,i){const r=this.addEventListener;this.addEventListener=()=>{},Oo(this,e,i),this.addEventListener=r}any(e,i){const r=this.addEventListener;this.addEventListener=()=>{},wl(this,e,i),this.addEventListener=r}trigger(e){const i=e.type||e;typeof e=="string"&&(e={type:i}),e=Ro(e),this.allowedEvents_[i]&&this["on"+i]&&this["on"+i](e),va(this,e)}queueTrigger(e){Wa||(Wa=new Map);const i=e.type||e;let r=Wa.get(this);r||(r=new Map,Wa.set(this,r));const o=r.get(i);r.delete(i),ae().clearTimeout(o);const d=ae().setTimeout(()=>{r.delete(i),r.size===0&&(r=null,Wa.delete(this)),this.trigger(e)},0);r.set(i,d)}}Jn.prototype.allowedEvents_={},Jn.prototype.addEventListener=Jn.prototype.on,Jn.prototype.removeEventListener=Jn.prototype.off,Jn.prototype.dispatchEvent=Jn.prototype.trigger;const Po=s=>typeof s.name=="function"?s.name():typeof s.name=="string"?s.name:s.name_?s.name_:s.constructor&&s.constructor.name?s.constructor.name:typeof s,ss=s=>s instanceof Jn||!!s.eventBusEl_&&["on","one","off","trigger"].every(e=>typeof s[e]=="function"),vu=(s,e)=>{ss(s)?e():(s.eventedCallbacks||(s.eventedCallbacks=[]),s.eventedCallbacks.push(e))},Ll=s=>typeof s=="string"&&/\S/.test(s)||Array.isArray(s)&&!!s.length,Ka=(s,e,i)=>{if(!s||!s.nodeName&&!ss(s))throw new Error(`Invalid target for ${Po(e)}#${i}; must be a DOM node or evented object.`)},Au=(s,e,i)=>{if(!Ll(s))throw new Error(`Invalid event type for ${Po(e)}#${i}; must be a non-empty string or array.`)},bu=(s,e,i)=>{if(typeof s!="function")throw new Error(`Invalid listener for ${Po(e)}#${i}; must be a function.`)},kl=(s,e,i)=>{const r=e.length<3||e[0]===s||e[0]===s.eventBusEl_;let o,d,h;return r?(o=s.eventBusEl_,e.length>=3&&e.shift(),[d,h]=e):[o,d,h]=e,Ka(o,s,i),Au(d,s,i),bu(h,s,i),h=gi(s,h),{isTargetingSelf:r,target:o,type:d,listener:h}},as=(s,e,i,r)=>{Ka(s,s,e),s.nodeName?kd[e](s,i,r):s[e](i,r)},Dd={on(...s){const{isTargetingSelf:e,target:i,type:r,listener:o}=kl(this,s,"on");if(as(i,"on",r,o),!e){const d=()=>this.off(i,r,o);d.guid=o.guid;const h=()=>this.off("dispose",d);h.guid=o.guid,as(this,"on","dispose",d),as(i,"on","dispose",h)}},one(...s){const{isTargetingSelf:e,target:i,type:r,listener:o}=kl(this,s,"one");if(e)as(i,"one",r,o);else{const d=(...h)=>{this.off(i,r,d),o.apply(null,h)};d.guid=o.guid,as(i,"one",r,d)}},any(...s){const{isTargetingSelf:e,target:i,type:r,listener:o}=kl(this,s,"any");if(e)as(i,"any",r,o);else{const d=(...h)=>{this.off(i,r,d),o.apply(null,h)};d.guid=o.guid,as(i,"any",r,d)}},off(s,e,i){if(!s||Ll(s))pn(this.eventBusEl_,s,e);else{const r=s,o=e;Ka(r,this,"off"),Au(o,this,"off"),bu(i,this,"off"),i=gi(this,i),this.off("dispose",i),r.nodeName?(pn(r,o,i),pn(r,"dispose",i)):ss(r)&&(r.off(o,i),r.off("dispose",i))}},trigger(s,e){Ka(this.eventBusEl_,this,"trigger");const i=s&&typeof s!="string"?s.type:s;if(!Ll(i))throw new Error(`Invalid event type for ${Po(this)}#trigger; must be a non-empty string or object with a type key that has a non-empty value.`);return va(this.eventBusEl_,s,e)}};function Bo(s,e={}){const{eventBusKey:i}=e;if(i){if(!s[i].nodeName)throw new Error(`The eventBusKey "${i}" does not refer to an element.`);s.eventBusEl_=s[i]}else s.eventBusEl_=$t("span",{className:"vjs-event-bus"});return Object.assign(s,Dd),s.eventedCallbacks&&s.eventedCallbacks.forEach(r=>{r()}),s.on("dispose",()=>{s.off(),[s,s.el_,s.eventBusEl_].forEach(function(r){r&&Hi.has(r)&&Hi.delete(r)}),ae().setTimeout(()=>{s.eventBusEl_=null},0)}),s}const _u={state:{},setState(s){typeof s=="function"&&(s=s());let e;return gs(s,(i,r)=>{this.state[r]!==i&&(e=e||{},e[r]={from:this.state[r],to:i}),this.state[r]=i}),e&&ss(this)&&this.trigger({changes:e,type:"statechanged"}),e}};function xu(s,e){return Object.assign(s,_u),s.state=Object.assign({},s.state,e),typeof s.handleStateChanged=="function"&&ss(s)&&s.on("statechanged",s.handleStateChanged),s}const Aa=function(s){return typeof s!="string"?s:s.replace(/./,e=>e.toLowerCase())},Gi=function(s){return typeof s!="string"?s:s.replace(/./,e=>e.toUpperCase())},or=function(s,e){return Gi(s)===Gi(e)};var os=Object.freeze({__proto__:null,toLowerCase:Aa,toTitleCase:Gi,titleCaseEquals:or});class et{constructor(e,i,r){if(!e&&this.play?this.player_=e=this:this.player_=e,this.isDisposed_=!1,this.parentComponent_=null,this.options_=ci({},this.options_),i=this.options_=ci(this.options_,i),this.id_=i.id||i.el&&i.el.id,!this.id_){const o=e&&e.id&&e.id()||"no_player";this.id_=`${o}_component_${Xn()}`}this.name_=i.name||null,i.el?this.el_=i.el:i.createEl!==!1&&(this.el_=this.createEl()),i.className&&this.el_&&i.className.split(" ").forEach(o=>this.addClass(o)),["on","off","one","any","trigger"].forEach(o=>{this[o]=void 0}),i.evented!==!1&&(Bo(this,{eventBusKey:this.el_?"el_":null}),this.handleLanguagechange=this.handleLanguagechange.bind(this),this.on(this.player_,"languagechange",this.handleLanguagechange)),xu(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Set,this.setIntervalIds_=new Set,this.rafIds_=new Set,this.namedRafs_=new Map,this.clearingTimersOnDispose_=!1,i.initChildren!==!1&&this.initChildren(),this.ready(r),i.reportTouchActivity!==!1&&this.enableTouchActivity()}on(e,i){}off(e,i){}one(e,i){}any(e,i){}trigger(e,i){}dispose(e={}){if(!this.isDisposed_){if(this.readyQueue_&&(this.readyQueue_.length=0),this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(let i=this.children_.length-1;i>=0;i--)this.children_[i].dispose&&this.children_[i].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&(e.restoreEl?this.el_.parentNode.replaceChild(e.restoreEl,this.el_):this.el_.parentNode.removeChild(this.el_)),this.el_=null),this.player_=null}}isDisposed(){return Boolean(this.isDisposed_)}player(){return this.player_}options(e){return e?(this.options_=ci(this.options_,e),this.options_):this.options_}el(){return this.el_}createEl(e,i,r){return $t(e,i,r)}localize(e,i,r=e){const o=this.player_.language&&this.player_.language(),d=this.player_.languages&&this.player_.languages(),h=d&&d[o],g=o&&o.split("-")[0],k=d&&d[g];let N=r;return h&&h[e]?N=h[e]:k&&k[e]&&(N=k[e]),i&&(N=N.replace(/\{(\d+)\}/g,function(Y,me){const Ie=i[me-1];let Pe=Ie;return typeof Ie=="undefined"&&(Pe=Y),Pe})),N}handleLanguagechange(){}contentEl(){return this.contentEl_||this.el_}id(){return this.id_}name(){return this.name_}children(){return this.children_}getChildById(e){return this.childIndex_[e]}getChild(e){if(!!e)return this.childNameIndex_[e]}getDescendant(...e){e=e.reduce((r,o)=>r.concat(o),[]);let i=this;for(let r=0;r<e.length;r++)if(i=i.getChild(e[r]),!i||!i.getChild)return;return i}setIcon(e,i=this.el()){if(!this.player_.options_.experimentalSvgIcons)return;const r="http://www.w3.org/2000/svg",o=$t("span",{className:"vjs-icon-placeholder vjs-svg-icon"},{"aria-hidden":"true"}),d=_e().createElementNS(r,"svg");d.setAttributeNS(null,"viewBox","0 0 512 512");const h=_e().createElementNS(r,"use");return d.appendChild(h),h.setAttributeNS(null,"href",`#vjs-icon-${e}`),o.appendChild(d),this.iconIsSet_?i.replaceChild(o,i.querySelector(".vjs-icon-placeholder")):i.appendChild(o),this.iconIsSet_=!0,o}addChild(e,i={},r=this.children_.length){let o,d;if(typeof e=="string"){d=Gi(e);const h=i.componentClass||d;i.name=d;const g=et.getComponent(h);if(!g)throw new Error(`Component ${h} does not exist`);if(typeof g!="function")return null;o=new g(this.player_||this,i)}else o=e;if(o.parentComponent_&&o.parentComponent_.removeChild(o),this.children_.splice(r,0,o),o.parentComponent_=this,typeof o.id=="function"&&(this.childIndex_[o.id()]=o),d=d||o.name&&Gi(o.name()),d&&(this.childNameIndex_[d]=o,this.childNameIndex_[Aa(d)]=o),typeof o.el=="function"&&o.el()){let h=null;this.children_[r+1]&&(this.children_[r+1].el_?h=this.children_[r+1].el_:rr(this.children_[r+1])&&(h=this.children_[r+1])),this.contentEl().insertBefore(o.el(),h)}return o}removeChild(e){if(typeof e=="string"&&(e=this.getChild(e)),!e||!this.children_)return;let i=!1;for(let o=this.children_.length-1;o>=0;o--)if(this.children_[o]===e){i=!0,this.children_.splice(o,1);break}if(!i)return;e.parentComponent_=null,this.childIndex_[e.id()]=null,this.childNameIndex_[Gi(e.name())]=null,this.childNameIndex_[Aa(e.name())]=null;const r=e.el();r&&r.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}initChildren(){const e=this.options_.children;if(e){const i=this.options_,r=h=>{const g=h.name;let k=h.opts;if(i[g]!==void 0&&(k=i[g]),k===!1)return;k===!0&&(k={}),k.playerOptions=this.options_.playerOptions;const N=this.addChild(g,k);N&&(this[g]=N)};let o;const d=et.getComponent("Tech");Array.isArray(e)?o=e:o=Object.keys(e),o.concat(Object.keys(this.options_).filter(function(h){return!o.some(function(g){return typeof g=="string"?h===g:h===g.name})})).map(h=>{let g,k;return typeof h=="string"?(g=h,k=e[g]||this.options_[g]||{}):(g=h.name,k=h),{name:g,opts:k}}).filter(h=>{const g=et.getComponent(h.opts.componentClass||Gi(h.name));return g&&!d.isTech(g)}).forEach(r)}}buildCSSClass(){return""}ready(e,i=!1){if(!!e){if(!this.isReady_){this.readyQueue_=this.readyQueue_||[],this.readyQueue_.push(e);return}i?e.call(this):this.setTimeout(e,1)}}triggerReady(){this.isReady_=!0,this.setTimeout(function(){const e=this.readyQueue_;this.readyQueue_=[],e&&e.length>0&&e.forEach(function(i){i.call(this)},this),this.trigger("ready")},1)}$(e,i){return He(e,i||this.contentEl())}$$(e,i){return yt(e,i||this.contentEl())}hasClass(e){return Yn(this.el_,e)}addClass(...e){Br(this.el_,...e)}removeClass(...e){ga(this.el_,...e)}toggleClass(e,i){Mr(this.el_,e,i)}show(){this.removeClass("vjs-hidden")}hide(){this.addClass("vjs-hidden")}lockShowing(){this.addClass("vjs-lock-showing")}unlockShowing(){this.removeClass("vjs-lock-showing")}getAttribute(e){return Fr(this.el_,e)}setAttribute(e,i){Rn(this.el_,e,i)}removeAttribute(e){Ve(this.el_,e)}width(e,i){return this.dimension("width",e,i)}height(e,i){return this.dimension("height",e,i)}dimensions(e,i){this.width(e,!0),this.height(i)}dimension(e,i,r){if(i!==void 0){(i===null||i!==i)&&(i=0),(""+i).indexOf("%")!==-1||(""+i).indexOf("px")!==-1?this.el_.style[e]=i:i==="auto"?this.el_.style[e]="":this.el_.style[e]=i+"px",r||this.trigger("componentresize");return}if(!this.el_)return 0;const o=this.el_.style[e],d=o.indexOf("px");return parseInt(d!==-1?o.slice(0,d):this.el_["offset"+Gi(e)],10)}currentDimension(e){let i=0;if(e!=="width"&&e!=="height")throw new Error("currentDimension only accepts width or height value");if(i=At(this.el_,e),i=parseFloat(i),i===0||isNaN(i)){const r=`offset${Gi(e)}`;i=this.el_[r]}return i}currentDimensions(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}}currentWidth(){return this.currentDimension("width")}currentHeight(){return this.currentDimension("height")}focus(){this.el_.focus()}blur(){this.el_.blur()}handleKeyDown(e){this.player_&&(fe().isEventKey(e,"Tab")||e.stopPropagation(),this.player_.handleKeyDown(e))}handleKeyPress(e){this.handleKeyDown(e)}emitTapEvents(){let e=0,i=null;const r=10,o=200;let d;this.on("touchstart",function(g){g.touches.length===1&&(i={pageX:g.touches[0].pageX,pageY:g.touches[0].pageY},e=ae().performance.now(),d=!0)}),this.on("touchmove",function(g){if(g.touches.length>1)d=!1;else if(i){const k=g.touches[0].pageX-i.pageX,N=g.touches[0].pageY-i.pageY;Math.sqrt(k*k+N*N)>r&&(d=!1)}});const h=function(){d=!1};this.on("touchleave",h),this.on("touchcancel",h),this.on("touchend",function(g){i=null,d===!0&&ae().performance.now()-e<o&&(g.preventDefault(),this.trigger("tap"))})}enableTouchActivity(){if(!this.player()||!this.player().reportUserActivity)return;const e=gi(this.player(),this.player().reportUserActivity);let i;this.on("touchstart",function(){e(),this.clearInterval(i),i=this.setInterval(e,250)});const r=function(o){e(),this.clearInterval(i)};this.on("touchmove",e),this.on("touchend",r),this.on("touchcancel",r)}setTimeout(e,i){var r;return e=gi(this,e),this.clearTimersOnDispose_(),r=ae().setTimeout(()=>{this.setTimeoutIds_.has(r)&&this.setTimeoutIds_.delete(r),e()},i),this.setTimeoutIds_.add(r),r}clearTimeout(e){return this.setTimeoutIds_.has(e)&&(this.setTimeoutIds_.delete(e),ae().clearTimeout(e)),e}setInterval(e,i){e=gi(this,e),this.clearTimersOnDispose_();const r=ae().setInterval(e,i);return this.setIntervalIds_.add(r),r}clearInterval(e){return this.setIntervalIds_.has(e)&&(this.setIntervalIds_.delete(e),ae().clearInterval(e)),e}requestAnimationFrame(e){this.clearTimersOnDispose_();var i;return e=gi(this,e),i=ae().requestAnimationFrame(()=>{this.rafIds_.has(i)&&this.rafIds_.delete(i),e()}),this.rafIds_.add(i),i}requestNamedAnimationFrame(e,i){if(this.namedRafs_.has(e))return;this.clearTimersOnDispose_(),i=gi(this,i);const r=this.requestAnimationFrame(()=>{i(),this.namedRafs_.has(e)&&this.namedRafs_.delete(e)});return this.namedRafs_.set(e,r),e}cancelNamedAnimationFrame(e){!this.namedRafs_.has(e)||(this.cancelAnimationFrame(this.namedRafs_.get(e)),this.namedRafs_.delete(e))}cancelAnimationFrame(e){return this.rafIds_.has(e)&&(this.rafIds_.delete(e),ae().cancelAnimationFrame(e)),e}clearTimersOnDispose_(){this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",()=>{[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(([e,i])=>{this[e].forEach((r,o)=>this[i](o))}),this.clearingTimersOnDispose_=!1}))}static registerComponent(e,i){if(typeof e!="string"||!e)throw new Error(`Illegal component name, "${e}"; must be a non-empty string.`);const r=et.getComponent("Tech"),o=r&&r.isTech(i),d=et===i||et.prototype.isPrototypeOf(i.prototype);if(o||!d){let g;throw o?g="techs must be registered using Tech.registerTech()":g="must be a Component subclass",new Error(`Illegal component, "${e}"; ${g}.`)}e=Gi(e),et.components_||(et.components_={});const h=et.getComponent("Player");if(e==="Player"&&h&&h.players){const g=h.players,k=Object.keys(g);if(g&&k.length>0&&k.map(N=>g[N]).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return et.components_[e]=i,et.components_[Aa(e)]=i,i}static getComponent(e){if(!(!e||!et.components_))return et.components_[e]}}et.registerComponent("Component",et);function Id(s,e,i){if(typeof e!="number"||e<0||e>i)throw new Error(`Failed to execute '${s}' on 'TimeRanges': The index provided (${e}) is non-numeric or out of bounds (0-${i}).`)}function Eu(s,e,i,r){return Id(s,r,i.length-1),i[r][e]}function Dl(s){let e;return s===void 0||s.length===0?e={length:0,start(){throw new Error("This TimeRanges object is empty")},end(){throw new Error("This TimeRanges object is empty")}}:e={length:s.length,start:Eu.bind(null,"start",0,s),end:Eu.bind(null,"end",1,s)},ae().Symbol&&ae().Symbol.iterator&&(e[ae().Symbol.iterator]=()=>(s||[]).values()),e}function jr(s,e){return Array.isArray(s)?Dl(s):s===void 0||e===void 0?Dl():Dl([[s,e]])}const Tu=function(s,e){s=s<0?0:s;let i=Math.floor(s%60),r=Math.floor(s/60%60),o=Math.floor(s/3600);const d=Math.floor(e/60%60),h=Math.floor(e/3600);return(isNaN(s)||s===Infinity)&&(o=r=i="-"),o=o>0||h>0?o+":":"",r=((o||d>=10)&&r<10?"0"+r:r)+":",i=i<10?"0"+i:i,o+r+i};let ls=Tu;function Il(s){ls=s}function Su(){ls=Tu}function qs(s,e=s){return ls(s,e)}var Rl=Object.freeze({__proto__:null,createTimeRanges:jr,createTimeRange:jr,setFormatTime:Il,resetFormatTime:Su,formatTime:qs});function Ol(s,e){let i=0,r,o;if(!e)return 0;(!s||!s.length)&&(s=jr(0,0));for(let d=0;d<s.length;d++)r=s.start(d),o=s.end(d),o>e&&(o=e),i+=o-r;return i/e}function Cn(s){if(s instanceof Cn)return s;typeof s=="number"?this.code=s:typeof s=="string"?this.message=s:nr(s)&&(typeof s.code=="number"&&(this.code=s.code),Object.assign(this,s)),this.message||(this.message=Cn.defaultMessages[this.code]||"")}Cn.prototype.code=0,Cn.prototype.message="",Cn.prototype.status=null,Cn.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],Cn.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(let s=0;s<Cn.errorTypes.length;s++)Cn[Cn.errorTypes[s]]=s,Cn.prototype[Cn.errorTypes[s]]=s;function $r(s){return s!=null&&typeof s.then=="function"}function xr(s){$r(s)&&s.then(null,e=>{})}const Mo=function(s){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce((i,r,o)=>(s[r]&&(i[r]=s[r]),i),{cues:s.cues&&Array.prototype.map.call(s.cues,function(i){return{startTime:i.startTime,endTime:i.endTime,text:i.text,id:i.id}})})};var wu={textTracksToJson:function(s){const e=s.$$("track"),i=Array.prototype.map.call(e,o=>o.track);return Array.prototype.map.call(e,function(o){const d=Mo(o.track);return o.src&&(d.src=o.src),d}).concat(Array.prototype.filter.call(s.textTracks(),function(o){return i.indexOf(o)===-1}).map(Mo))},jsonToTextTracks:function(s,e){return s.forEach(function(i){const r=e.addRemoteTextTrack(i).track;!i.src&&i.cues&&i.cues.forEach(o=>r.addCue(o))}),e.textTracks()},trackToJson_:Mo};const Fo="vjs-modal-dialog";class ba extends et{constructor(e,i){super(e,i);this.handleKeyDown_=r=>this.handleKeyDown(r),this.close_=r=>this.close(r),this.opened_=this.hasBeenOpened_=this.hasBeenFilled_=!1,this.closeable(!this.options_.uncloseable),this.content(this.options_.content),this.contentEl_=$t("div",{className:`${Fo}-content`},{role:"document"}),this.descEl_=$t("p",{className:`${Fo}-description vjs-control-text`,id:this.el().getAttribute("aria-describedby")}),_n(this.descEl_,this.description()),this.el_.appendChild(this.descEl_),this.el_.appendChild(this.contentEl_)}createEl(){return super.createEl("div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":`${this.id()}_description`,"aria-hidden":"true","aria-label":this.label(),role:"dialog"})}dispose(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,super.dispose()}buildCSSClass(){return`${Fo} vjs-hidden ${super.buildCSSClass()}`}label(){return this.localize(this.options_.label||"Modal Window")}description(){let e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e}open(){if(!this.opened_){const e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.on("keydown",this.handleKeyDown_),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}}opened(e){return typeof e=="boolean"&&this[e?"open":"close"](),this.opened_}close(){if(!this.opened_)return;const e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.off("keydown",this.handleKeyDown_),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}closeable(e){if(typeof e=="boolean"){const i=this.closeable_=!!e;let r=this.getChild("closeButton");if(i&&!r){const o=this.contentEl_;this.contentEl_=this.el_,r=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=o,this.on(r,"close",this.close_)}!i&&r&&(this.off(r,"close",this.close_),this.removeChild(r),r.dispose())}return this.closeable_}fill(){this.fillWith(this.content())}fillWith(e){const i=this.contentEl(),r=i.parentNode,o=i.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,r.removeChild(i),this.empty(),pe(i,e),this.trigger("modalfill"),o?r.insertBefore(i,o):r.appendChild(i);const d=this.getChild("closeButton");d&&r.appendChild(d.el_)}empty(){this.trigger("beforemodalempty"),B(this.contentEl()),this.trigger("modalempty")}content(e){return typeof e!="undefined"&&(this.content_=e),this.content_}conditionalFocus_(){const e=_e().activeElement,i=this.player_.el_;this.previouslyActiveEl_=null,(i.contains(e)||i===e)&&(this.previouslyActiveEl_=e,this.focus())}conditionalBlur_(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)}handleKeyDown(e){if(e.stopPropagation(),fe().isEventKey(e,"Escape")&&this.closeable()){e.preventDefault(),this.close();return}if(!fe().isEventKey(e,"Tab"))return;const i=this.focusableEls_(),r=this.el_.querySelector(":focus");let o;for(let d=0;d<i.length;d++)if(r===i[d]){o=d;break}_e().activeElement===this.el_&&(o=0),e.shiftKey&&o===0?(i[i.length-1].focus(),e.preventDefault()):!e.shiftKey&&o===i.length-1&&(i[0].focus(),e.preventDefault())}focusableEls_(){const e=this.el_.querySelectorAll("*");return Array.prototype.filter.call(e,i=>(i instanceof ae().HTMLAnchorElement||i instanceof ae().HTMLAreaElement)&&i.hasAttribute("href")||(i instanceof ae().HTMLInputElement||i instanceof ae().HTMLSelectElement||i instanceof ae().HTMLTextAreaElement||i instanceof ae().HTMLButtonElement)&&!i.hasAttribute("disabled")||i instanceof ae().HTMLIFrameElement||i instanceof ae().HTMLObjectElement||i instanceof ae().HTMLEmbedElement||i.hasAttribute("tabindex")&&i.getAttribute("tabindex")!==-1||i.hasAttribute("contenteditable"))}}ba.prototype.options_={pauseOnOpen:!0,temporary:!0},et.registerComponent("ModalDialog",ba);class Ws extends Jn{constructor(e=[]){super();this.tracks_=[],Object.defineProperty(this,"length",{get(){return this.tracks_.length}});for(let i=0;i<e.length;i++)this.addTrack(e[i])}addTrack(e){const i=this.tracks_.length;""+i in this||Object.defineProperty(this,i,{get(){return this.tracks_[i]}}),this.tracks_.indexOf(e)===-1&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack",target:this})),e.labelchange_=()=>{this.trigger({track:e,type:"labelchange",target:this})},ss(e)&&e.addEventListener("labelchange",e.labelchange_)}removeTrack(e){let i;for(let r=0,o=this.length;r<o;r++)if(this[r]===e){i=this[r],i.off&&i.off(),this.tracks_.splice(r,1);break}!i||this.trigger({track:i,type:"removetrack",target:this})}getTrackById(e){let i=null;for(let r=0,o=this.length;r<o;r++){const d=this[r];if(d.id===e){i=d;break}}return i}}Ws.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"};for(const s in Ws.prototype.allowedEvents_)Ws.prototype["on"+s]=null;const za=function(s,e){for(let i=0;i<s.length;i++)!Object.keys(s[i]).length||e.id===s[i].id||(s[i].enabled=!1)};class No extends Ws{constructor(e=[]){for(let i=e.length-1;i>=0;i--)if(e[i].enabled){za(e,e[i]);break}super(e);this.changing_=!1}addTrack(e){e.enabled&&za(this,e),super.addTrack(e),!!e.addEventListener&&(e.enabledChange_=()=>{this.changing_||(this.changing_=!0,za(this,e),this.changing_=!1,this.trigger("change"))},e.addEventListener("enabledchange",e.enabledChange_))}removeTrack(e){super.removeTrack(e),e.removeEventListener&&e.enabledChange_&&(e.removeEventListener("enabledchange",e.enabledChange_),e.enabledChange_=null)}}const Bl=function(s,e){for(let i=0;i<s.length;i++)!Object.keys(s[i]).length||e.id===s[i].id||(s[i].selected=!1)};class Lu extends Ws{constructor(e=[]){for(let i=e.length-1;i>=0;i--)if(e[i].selected){Bl(e,e[i]);break}super(e);this.changing_=!1,Object.defineProperty(this,"selectedIndex",{get(){for(let i=0;i<this.length;i++)if(this[i].selected)return i;return-1},set(){}})}addTrack(e){e.selected&&Bl(this,e),super.addTrack(e),!!e.addEventListener&&(e.selectedChange_=()=>{this.changing_||(this.changing_=!0,Bl(this,e),this.changing_=!1,this.trigger("change"))},e.addEventListener("selectedchange",e.selectedChange_))}removeTrack(e){super.removeTrack(e),e.removeEventListener&&e.selectedChange_&&(e.removeEventListener("selectedchange",e.selectedChange_),e.selectedChange_=null)}}class ku extends Ws{addTrack(e){super.addTrack(e),this.queueChange_||(this.queueChange_=()=>this.queueTrigger("change")),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=()=>this.trigger("selectedlanguagechange")),e.addEventListener("modechange",this.queueChange_),["metadata","chapters"].indexOf(e.kind)===-1&&e.addEventListener("modechange",this.triggerSelectedlanguagechange_)}removeTrack(e){super.removeTrack(e),e.removeEventListener&&(this.queueChange_&&e.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&e.removeEventListener("modechange",this.triggerSelectedlanguagechange_))}}class Rd{constructor(e=[]){this.trackElements_=[],Object.defineProperty(this,"length",{get(){return this.trackElements_.length}});for(let i=0,r=e.length;i<r;i++)this.addTrackElement_(e[i])}addTrackElement_(e){const i=this.trackElements_.length;""+i in this||Object.defineProperty(this,i,{get(){return this.trackElements_[i]}}),this.trackElements_.indexOf(e)===-1&&this.trackElements_.push(e)}getTrackElementByTrack_(e){let i;for(let r=0,o=this.trackElements_.length;r<o;r++)if(e===this.trackElements_[r].track){i=this.trackElements_[r];break}return i}removeTrackElement_(e){for(let i=0,r=this.trackElements_.length;i<r;i++)if(e===this.trackElements_[i]){this.trackElements_[i].track&&typeof this.trackElements_[i].track.off=="function"&&this.trackElements_[i].track.off(),typeof this.trackElements_[i].off=="function"&&this.trackElements_[i].off(),this.trackElements_.splice(i,1);break}}}class _a{constructor(e){_a.prototype.setCues_.call(this,e),Object.defineProperty(this,"length",{get(){return this.length_}})}setCues_(e){const i=this.length||0;let r=0;const o=e.length;this.cues_=e,this.length_=e.length;const d=function(h){""+h in this||Object.defineProperty(this,""+h,{get(){return this.cues_[h]}})};if(i<o)for(r=i;r<o;r++)d.call(this,r)}getCueById(e){let i=null;for(let r=0,o=this.length;r<o;r++){const d=this[r];if(d.id===e){i=d;break}}return i}}const Od={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},Ml={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},Fl={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},Du={disabled:"disabled",hidden:"hidden",showing:"showing"};class Nl extends Jn{constructor(e={}){super();const i={id:e.id||"vjs_track_"+Xn(),kind:e.kind||"",language:e.language||""};let r=e.label||"";for(const o in i)Object.defineProperty(this,o,{get(){return i[o]},set(){}});Object.defineProperty(this,"label",{get(){return r},set(o){o!==r&&(r=o,this.trigger("labelchange"))}})}}const Ya=function(s){const e=["protocol","hostname","port","pathname","search","hash","host"],i=_e().createElement("a");i.href=s;const r={};for(let o=0;o<e.length;o++)r[e[o]]=i[e[o]];return r.protocol==="http:"&&(r.host=r.host.replace(/:80$/,"")),r.protocol==="https:"&&(r.host=r.host.replace(/:443$/,"")),r.protocol||(r.protocol=ae().location.protocol),r.host||(r.host=ae().location.host),r},Ul=function(s){if(!s.match(/^https?:\/\//)){const e=_e().createElement("a");e.href=s,s=e.href}return s},Uo=function(s){if(typeof s=="string"){const i=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(s);if(i)return i.pop().toLowerCase()}return""},jo=function(s,e=ae().location){const i=Ya(s);return(i.protocol===":"?e.protocol:i.protocol)+i.host!==e.protocol+e.host};var Iu=Object.freeze({__proto__:null,parseUrl:Ya,getAbsoluteURL:Ul,getFileExtension:Uo,isCrossOrigin:jo});const Ru=function(s,e){const i=new(ae()).WebVTT.Parser(ae(),ae().vttjs,ae().WebVTT.StringDecoder()),r=[];i.oncue=function(o){e.addCue(o)},i.onparsingerror=function(o){r.push(o)},i.onflush=function(){e.trigger({type:"loadeddata",target:e})},i.parse(s),r.length>0&&(ae().console&&ae().console.groupCollapsed&&ae().console.groupCollapsed(`Text Track parsing errors for ${e.src}`),r.forEach(o=>ri.error(o)),ae().console&&ae().console.groupEnd&&ae().console.groupEnd()),i.flush()},$o=function(s,e){const i={uri:s},r=jo(s);r&&(i.cors=r);const o=e.tech_.crossOrigin()==="use-credentials";o&&(i.withCredentials=o),te()(i,gi(this,function(d,h,g){if(d)return ri.error(d,h);e.loaded_=!0,typeof ae().WebVTT!="function"?e.tech_&&e.tech_.any(["vttjsloaded","vttjserror"],k=>{if(k.type==="vttjserror"){ri.error(`vttjs failed to load, stopping trying to process ${e.src}`);return}return Ru(g,e)}):Ru(g,e)}))};class xa extends Nl{constructor(e={}){if(!e.tech)throw new Error("A tech was not provided.");const i=ci(e,{kind:Fl[e.kind]||"subtitles",language:e.language||e.srclang||""});let r=Du[i.mode]||"disabled";const o=i.default;(i.kind==="metadata"||i.kind==="chapters")&&(r="hidden"),super(i),this.tech_=i.tech,this.cues_=[],this.activeCues_=[],this.preload_=this.tech_.preloadTextTracks!==!1;const d=new _a(this.cues_),h=new _a(this.activeCues_);let g=!1;this.timeupdateHandler=gi(this,function(N={}){if(!this.tech_.isDisposed()){if(!this.tech_.isReady_){N.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler));return}this.activeCues=this.activeCues,g&&(this.trigger("cuechange"),g=!1),N.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler))}});const k=()=>{this.stopTracking()};this.tech_.one("dispose",k),r!=="disabled"&&this.startTracking(),Object.defineProperties(this,{default:{get(){return o},set(){}},mode:{get(){return r},set(N){!Du[N]||r!==N&&(r=N,!this.preload_&&r!=="disabled"&&this.cues.length===0&&$o(this.src,this),this.stopTracking(),r!=="disabled"&&this.startTracking(),this.trigger("modechange"))}},cues:{get(){return this.loaded_?d:null},set(){}},activeCues:{get(){if(!this.loaded_)return null;if(this.cues.length===0)return h;const N=this.tech_.currentTime(),Y=[];for(let me=0,Ie=this.cues.length;me<Ie;me++){const Pe=this.cues[me];Pe.startTime<=N&&Pe.endTime>=N&&Y.push(Pe)}if(g=!1,Y.length!==this.activeCues_.length)g=!0;else for(let me=0;me<Y.length;me++)this.activeCues_.indexOf(Y[me])===-1&&(g=!0);return this.activeCues_=Y,h.setCues_(this.activeCues_),h},set(){}}}),i.src?(this.src=i.src,this.preload_||(this.loaded_=!0),(this.preload_||i.kind!=="subtitles"&&i.kind!=="captions")&&$o(this.src,this)):this.loaded_=!0}startTracking(){this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler),this.tech_.on("timeupdate",this.timeupdateHandler)}stopTracking(){this.rvf_&&(this.tech_.cancelVideoFrameCallback(this.rvf_),this.rvf_=void 0),this.tech_.off("timeupdate",this.timeupdateHandler)}addCue(e){let i=e;if(!("getCueAsHTML"in i)){i=new(ae()).vttjs.VTTCue(e.startTime,e.endTime,e.text);for(const o in e)o in i||(i[o]=e[o]);i.id=e.id,i.originalCue_=e}const r=this.tech_.textTracks();for(let o=0;o<r.length;o++)r[o]!==this&&r[o].removeCue(i);this.cues_.push(i),this.cues.setCues_(this.cues_)}removeCue(e){let i=this.cues_.length;for(;i--;){const r=this.cues_[i];if(r===e||r.originalCue_&&r.originalCue_===e){this.cues_.splice(i,1),this.cues.setCues_(this.cues_);break}}}}xa.prototype.allowedEvents_={cuechange:"cuechange"};class jl extends Nl{constructor(e={}){const i=ci(e,{kind:Ml[e.kind]||""});super(i);let r=!1;Object.defineProperty(this,"enabled",{get(){return r},set(o){typeof o!="boolean"||o===r||(r=o,this.trigger("enabledchange"))}}),i.enabled&&(this.enabled=i.enabled),this.loaded_=!0}}class Ou extends Nl{constructor(e={}){const i=ci(e,{kind:Od[e.kind]||""});super(i);let r=!1;Object.defineProperty(this,"selected",{get(){return r},set(o){typeof o!="boolean"||o===r||(r=o,this.trigger("selectedchange"))}}),i.selected&&(this.selected=i.selected)}}class Er extends Jn{constructor(e={}){super();let i;const r=new xa(e);this.kind=r.kind,this.src=r.src,this.srclang=r.language,this.label=r.label,this.default=r.default,Object.defineProperties(this,{readyState:{get(){return i}},track:{get(){return r}}}),i=Er.NONE,r.addEventListener("loadeddata",()=>{i=Er.LOADED,this.trigger({type:"load",target:this})})}}Er.prototype.allowedEvents_={load:"load"},Er.NONE=0,Er.LOADING=1,Er.LOADED=2,Er.ERROR=3;const Zn={audio:{ListClass:No,TrackClass:jl,capitalName:"Audio"},video:{ListClass:Lu,TrackClass:Ou,capitalName:"Video"},text:{ListClass:ku,TrackClass:xa,capitalName:"Text"}};Object.keys(Zn).forEach(function(s){Zn[s].getterName=`${s}Tracks`,Zn[s].privateName=`${s}Tracks_`});const Ts={remoteText:{ListClass:ku,TrackClass:xa,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:Rd,TrackClass:Er,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},On=Object.assign({},Zn,Ts);Ts.names=Object.keys(Ts),Zn.names=Object.keys(Zn),On.names=[].concat(Ts.names).concat(Zn.names);function Pd(s,e,i,r,o={}){const d=s.textTracks();o.kind=e,i&&(o.label=i),r&&(o.language=r),o.tech=s;const h=new On.text.TrackClass(o);return d.addTrack(h),h}class Zt extends et{constructor(e={},i=function(){}){e.reportTouchActivity=!1,super(null,e,i),this.onDurationChange_=r=>this.onDurationChange(r),this.trackProgress_=r=>this.trackProgress(r),this.trackCurrentTime_=r=>this.trackCurrentTime(r),this.stopTrackingCurrentTime_=r=>this.stopTrackingCurrentTime(r),this.disposeSourceHandler_=r=>this.disposeSourceHandler(r),this.queuedHanders_=new Set,this.hasStarted_=!1,this.on("playing",function(){this.hasStarted_=!0}),this.on("loadstart",function(){this.hasStarted_=!1}),On.names.forEach(r=>{const o=On[r];e&&e[o.getterName]&&(this[o.privateName]=e[o.getterName])}),this.featuresProgressEvents||this.manualProgressOn(),this.featuresTimeupdateEvents||this.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(r=>{e[`native${r}Tracks`]===!1&&(this[`featuresNative${r}Tracks`]=!1)}),e.nativeCaptions===!1||e.nativeTextTracks===!1?this.featuresNativeTextTracks=!1:(e.nativeCaptions===!0||e.nativeTextTracks===!0)&&(this.featuresNativeTextTracks=!0),this.featuresNativeTextTracks||this.emulateTextTracks(),this.preloadTextTracks=e.preloadTextTracks!==!1,this.autoRemoteTextTracks_=new On.text.ListClass,this.initTrackListeners(),e.nativeControlsForTouch||this.emitTapEvents(),this.constructor&&(this.name_=this.constructor.name||"Unknown Tech")}triggerSourceset(e){this.isReady_||this.one("ready",()=>this.setTimeout(()=>this.triggerSourceset(e),1)),this.trigger({src:e,type:"sourceset"})}manualProgressOn(){this.on("durationchange",this.onDurationChange_),this.manualProgress=!0,this.one("ready",this.trackProgress_)}manualProgressOff(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange_)}trackProgress(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(gi(this,function(){const i=this.bufferedPercent();this.bufferedPercent_!==i&&this.trigger("progress"),this.bufferedPercent_=i,i===1&&this.stopTrackingProgress()}),500)}onDurationChange(e){this.duration_=this.duration()}buffered(){return jr(0,0)}bufferedPercent(){return Ol(this.buffered(),this.duration_)}stopTrackingProgress(){this.clearInterval(this.progressInterval)}manualTimeUpdatesOn(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime_),this.on("pause",this.stopTrackingCurrentTime_)}manualTimeUpdatesOff(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime_),this.off("pause",this.stopTrackingCurrentTime_)}trackCurrentTime(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)}stopTrackingCurrentTime(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}dispose(){this.clearTracks(Zn.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),super.dispose()}clearTracks(e){e=[].concat(e),e.forEach(i=>{const r=this[`${i}Tracks`]()||[];let o=r.length;for(;o--;){const d=r[o];i==="text"&&this.removeRemoteTextTrack(d),r.removeTrack(d)}})}cleanupAutoTextTracks(){const e=this.autoRemoteTextTracks_||[];let i=e.length;for(;i--;){const r=e[i];this.removeRemoteTextTrack(r)}}reset(){}crossOrigin(){}setCrossOrigin(){}error(e){return e!==void 0&&(this.error_=new Cn(e),this.trigger("error")),this.error_}played(){return this.hasStarted_?jr(0,0):jr()}play(){}setScrubbing(e){}scrubbing(){}setCurrentTime(e){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}initTrackListeners(){Zn.names.forEach(e=>{const i=Zn[e],r=()=>{this.trigger(`${e}trackchange`)},o=this[i.getterName]();o.addEventListener("removetrack",r),o.addEventListener("addtrack",r),this.on("dispose",()=>{o.removeEventListener("removetrack",r),o.removeEventListener("addtrack",r)})})}addWebVttScript_(){if(!ae().WebVTT)if(_e().body.contains(this.el())){if(!this.options_["vtt.js"]&&vn(w())&&Object.keys(w()).length>0){this.trigger("vttjsloaded");return}const e=_e().createElement("script");e.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",e.onload=()=>{this.trigger("vttjsloaded")},e.onerror=()=>{this.trigger("vttjserror")},this.on("dispose",()=>{e.onload=null,e.onerror=null}),ae().WebVTT=!0,this.el().parentNode.appendChild(e)}else this.ready(this.addWebVttScript_)}emulateTextTracks(){const e=this.textTracks(),i=this.remoteTextTracks(),r=g=>e.addTrack(g.track),o=g=>e.removeTrack(g.track);i.on("addtrack",r),i.on("removetrack",o),this.addWebVttScript_();const d=()=>this.trigger("texttrackchange"),h=()=>{d();for(let g=0;g<e.length;g++){const k=e[g];k.removeEventListener("cuechange",d),k.mode==="showing"&&k.addEventListener("cuechange",d)}};h(),e.addEventListener("change",h),e.addEventListener("addtrack",h),e.addEventListener("removetrack",h),this.on("dispose",function(){i.off("addtrack",r),i.off("removetrack",o),e.removeEventListener("change",h),e.removeEventListener("addtrack",h),e.removeEventListener("removetrack",h);for(let g=0;g<e.length;g++)e[g].removeEventListener("cuechange",d)})}addTextTrack(e,i,r){if(!e)throw new Error("TextTrack kind is required but was not provided");return Pd(this,e,i,r)}createRemoteTextTrack(e){const i=ci(e,{tech:this});return new Ts.remoteTextEl.TrackClass(i)}addRemoteTextTrack(e={},i){const r=this.createRemoteTextTrack(e);return typeof i!="boolean"&&(i=!1),this.remoteTextTrackEls().addTrackElement_(r),this.remoteTextTracks().addTrack(r.track),i===!1&&this.ready(()=>this.autoRemoteTextTracks_.addTrack(r.track)),r}removeRemoteTextTrack(e){const i=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(i),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)}getVideoPlaybackQuality(){return{}}requestPictureInPicture(){return Promise.reject()}disablePictureInPicture(){return!0}setDisablePictureInPicture(){}requestVideoFrameCallback(e){const i=Xn();return!this.isReady_||this.paused()?(this.queuedHanders_.add(i),this.one("playing",()=>{this.queuedHanders_.has(i)&&(this.queuedHanders_.delete(i),e())})):this.requestNamedAnimationFrame(i,e),i}cancelVideoFrameCallback(e){this.queuedHanders_.has(e)?this.queuedHanders_.delete(e):this.cancelNamedAnimationFrame(e)}setPoster(){}playsinline(){}setPlaysinline(){}overrideNativeAudioTracks(e){}overrideNativeVideoTracks(e){}canPlayType(e){return""}static canPlayType(e){return""}static canPlaySource(e,i){return Zt.canPlayType(e.type)}static isTech(e){return e.prototype instanceof Zt||e instanceof Zt||e===Zt}static registerTech(e,i){if(Zt.techs_||(Zt.techs_={}),!Zt.isTech(i))throw new Error(`Tech ${e} must be a Tech`);if(!Zt.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!Zt.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=Gi(e),Zt.techs_[e]=i,Zt.techs_[Aa(e)]=i,e!=="Tech"&&Zt.defaultTechOrder_.push(e),i}static getTech(e){if(!!e){if(Zt.techs_&&Zt.techs_[e])return Zt.techs_[e];if(e=Gi(e),ae()&&ae().videojs&&ae().videojs[e])return ri.warn(`The ${e} tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)`),ae().videojs[e]}}}On.names.forEach(function(s){const e=On[s];Zt.prototype[e.getterName]=function(){return this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName]}}),Zt.prototype.featuresVolumeControl=!0,Zt.prototype.featuresMuteControl=!0,Zt.prototype.featuresFullscreenResize=!1,Zt.prototype.featuresPlaybackRate=!1,Zt.prototype.featuresProgressEvents=!1,Zt.prototype.featuresSourceset=!1,Zt.prototype.featuresTimeupdateEvents=!1,Zt.prototype.featuresNativeTextTracks=!1,Zt.prototype.featuresVideoFrameCallback=!1,Zt.withSourceHandlers=function(s){s.registerSourceHandler=function(i,r){let o=s.sourceHandlers;o||(o=s.sourceHandlers=[]),r===void 0&&(r=o.length),o.splice(r,0,i)},s.canPlayType=function(i){const r=s.sourceHandlers||[];let o;for(let d=0;d<r.length;d++)if(o=r[d].canPlayType(i),o)return o;return""},s.selectSourceHandler=function(i,r){const o=s.sourceHandlers||[];let d;for(let h=0;h<o.length;h++)if(d=o[h].canHandleSource(i,r),d)return o[h];return null},s.canPlaySource=function(i,r){const o=s.selectSourceHandler(i,r);return o?o.canHandleSource(i,r):""},["seekable","seeking","duration"].forEach(function(i){const r=this[i];typeof r=="function"&&(this[i]=function(){return this.sourceHandler_&&this.sourceHandler_[i]?this.sourceHandler_[i].apply(this.sourceHandler_,arguments):r.apply(this,arguments)})},s.prototype),s.prototype.setSource=function(i){let r=s.selectSourceHandler(i,this.options_);r||(s.nativeSourceHandler?r=s.nativeSourceHandler:ri.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler_),r!==s.nativeSourceHandler&&(this.currentSource_=i),this.sourceHandler_=r.handleSource(i,this,this.options_),this.one("dispose",this.disposeSourceHandler_)},s.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},et.registerComponent("Tech",Zt),Zt.registerTech("Tech",Zt),Zt.defaultTechOrder_=[];const Ks={},$l={},Xa={};function Vl(s,e){Ks[s]=Ks[s]||[],Ks[s].push(e)}function Bd(s,e,i){s.setTimeout(()=>zs(e,Ks[e.type],i,s),1)}function Vo(s,e){s.forEach(i=>i.setTech&&i.setTech(e))}function Ea(s,e,i){return s.reduceRight(Hl(i),e[i]())}function lr(s,e,i,r){return e[i](s.reduce(Hl(i),r))}function Pu(s,e,i,r=null){const o="call"+Gi(i),d=s.reduce(Hl(o),r),h=d===Xa,g=h?null:e[i](d);return Fd(s,i,g,h),g}const Hn={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1,ended:1},Md={setCurrentTime:1,setMuted:1,setVolume:1},us={play:1,pause:1};function Hl(s){return(e,i)=>e===Xa?Xa:i[s]?i[s](e):e}function Fd(s,e,i,r){for(let o=s.length-1;o>=0;o--){const d=s[o];d[e]&&d[e](r,i)}}function Bu(s){$l[s.id()]=null}function Mu(s,e){const i=$l[s.id()];let r=null;if(i==null)return r=e(s),$l[s.id()]=[[e,r]],r;for(let o=0;o<i.length;o++){const[d,h]=i[o];d===e&&(r=h)}return r===null&&(r=e(s),i.push([e,r])),r}function zs(s={},e=[],i,r,o=[],d=!1){const[h,...g]=e;if(typeof h=="string")zs(s,Ks[h],i,r,o,d);else if(h){const k=Mu(r,h);if(!k.setSource)return o.push(k),zs(s,g,i,r,o,d);k.setSource(Object.assign({},s),function(N,Y){if(N)return zs(s,g,i,r,o,d);o.push(k),zs(Y,s.type===Y.type?g:Ks[Y.type],i,r,o,d)})}else g.length?zs(s,g,i,r,o,d):d?i(s,o):zs(s,Ks["*"],i,r,o,!0)}const Fu={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",mpd:"application/dash+xml",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},Ho=function(s=""){const e=Uo(s);return Fu[e.toLowerCase()]||""},Nd=(s,e)=>{if(!e)return"";if(s.cache_.source.src===e&&s.cache_.source.type)return s.cache_.source.type;const i=s.cache_.sources.filter(o=>o.src===e);if(i.length)return i[0].type;const r=s.$$("source");for(let o=0;o<r.length;o++){const d=r[o];if(d.type&&d.src&&d.src===e)return d.type}return Ho(e)},Gl=function(s){if(Array.isArray(s)){let e=[];s.forEach(function(i){i=Gl(i),Array.isArray(i)?e=e.concat(i):nr(i)&&e.push(i)}),s=e}else typeof s=="string"&&s.trim()?s=[Nu({src:s})]:nr(s)&&typeof s.src=="string"&&s.src&&s.src.trim()?s=[Nu(s)]:s=[];return s};function Nu(s){if(!s.type){const e=Ho(s.src);e&&(s.type=e)}return s}var Ud=`<svg xmlns="http://www.w3.org/2000/svg">
  <defs>
    <symbol viewBox="0 0 48 48" id="vjs-icon-play">
      <path d="M16 10v28l22-14z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-pause">
      <path d="M12 38h8V10h-8v28zm16-28v28h8V10h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-audio">
      <path d="M24 2C14.06 2 6 10.06 6 20v14c0 3.31 2.69 6 6 6h6V24h-8v-4c0-7.73 6.27-14 14-14s14 6.27 14 14v4h-8v16h6c3.31 0 6-2.69 6-6V20c0-9.94-8.06-18-18-18z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-captions">
      <path d="M38 8H10c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h28c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM22 22h-3v-1h-4v6h4v-1h3v2a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2zm14 0h-3v-1h-4v6h4v-1h3v2a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-subtitles">
      <path d="M40 8H8c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h32c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM8 24h8v4H8v-4zm20 12H8v-4h20v4zm12 0h-8v-4h8v4zm0-8H20v-4h20v4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-fullscreen-enter">
      <path d="M14 28h-4v10h10v-4h-6v-6zm-4-8h4v-6h6v-4H10v10zm24 14h-6v4h10V28h-4v6zm-6-24v4h6v6h4V10H28z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-fullscreen-exit">
      <path d="M10 32h6v6h4V28H10v4zm6-16h-6v4h10V10h-4v6zm12 22h4v-6h6v-4H28v10zm4-22v-6h-4v10h10v-4h-6z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-play-circle">
      <path d="M20 33l12-9-12-9v18zm4-29C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-mute">
      <path d="M33 24c0-3.53-2.04-6.58-5-8.05v4.42l4.91 4.91c.06-.42.09-.85.09-1.28zm5 0c0 1.88-.41 3.65-1.08 5.28l3.03 3.03C41.25 29.82 42 27 42 24c0-8.56-5.99-15.72-14-17.54v4.13c5.78 1.72 10 7.07 10 13.41zM8.55 6L6 8.55 15.45 18H6v12h8l10 10V26.55l8.51 8.51c-1.34 1.03-2.85 1.86-4.51 2.36v4.13a17.94 17.94 0 0 0 7.37-3.62L39.45 42 42 39.45l-18-18L8.55 6zM24 8l-4.18 4.18L24 16.36V8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-low">
      <path d="M14 18v12h8l10 10V8L22 18h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-medium">
      <path d="M37 24c0-3.53-2.04-6.58-5-8.05v16.11c2.96-1.48 5-4.53 5-8.06zm-27-6v12h8l10 10V8L18 18h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-high">
      <path d="M6 18v12h8l10 10V8L14 18H6zm27 6c0-3.53-2.04-6.58-5-8.05v16.11c2.96-1.48 5-4.53 5-8.06zM28 6.46v4.13c5.78 1.72 10 7.07 10 13.41s-4.22 11.69-10 13.41v4.13c8.01-1.82 14-8.97 14-17.54S36.01 8.28 28 6.46z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-spinner">
      <path d="M18.8 21l9.53-16.51C26.94 4.18 25.49 4 24 4c-4.8 0-9.19 1.69-12.64 4.51l7.33 12.69.11-.2zm24.28-3c-1.84-5.85-6.3-10.52-11.99-12.68L23.77 18h19.31zm.52 2H28.62l.58 1 9.53 16.5C41.99 33.94 44 29.21 44 24c0-1.37-.14-2.71-.4-4zm-26.53 4l-7.8-13.5C6.01 14.06 4 18.79 4 24c0 1.37.14 2.71.4 4h14.98l-2.31-4zM4.92 30c1.84 5.85 6.3 10.52 11.99 12.68L24.23 30H4.92zm22.54 0l-7.8 13.51c1.4.31 2.85.49 4.34.49 4.8 0 9.19-1.69 12.64-4.51L29.31 26.8 27.46 30z"></path>
    </symbol>
    <symbol viewBox="0 0 24 24" id="vjs-icon-hd">
      <path d="M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-8 12H9.5v-2h-2v2H6V9h1.5v2.5h2V9H11v6zm2-6h4c.55 0 1 .45 1 1v4c0 .55-.45 1-1 1h-4V9zm1.5 4.5h2v-3h-2v3z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-chapters">
      <path d="M6 26h4v-4H6v4zm0 8h4v-4H6v4zm0-16h4v-4H6v4zm8 8h28v-4H14v4zm0 8h28v-4H14v4zm0-20v4h28v-4H14z"></path>
    </symbol>
    <symbol viewBox="0 0 40 40" id="vjs-icon-downloading">
      <path d="M18.208 36.875q-3.208-.292-5.979-1.729-2.771-1.438-4.812-3.729-2.042-2.292-3.188-5.229-1.146-2.938-1.146-6.23 0-6.583 4.334-11.416 4.333-4.834 10.833-5.5v3.166q-5.167.75-8.583 4.646Q6.25 14.75 6.25 19.958q0 5.209 3.396 9.104 3.396 3.896 8.562 4.646zM20 28.417L11.542 20l2.083-2.083 4.917 4.916v-11.25h2.916v11.25l4.875-4.916L28.417 20zm1.792 8.458v-3.167q1.833-.25 3.541-.958 1.709-.708 3.167-1.875l2.333 2.292q-1.958 1.583-4.25 2.541-2.291.959-4.791 1.167zm6.791-27.792q-1.541-1.125-3.25-1.854-1.708-.729-3.541-1.021V3.042q2.5.25 4.77 1.208 2.271.958 4.271 2.5zm4.584 21.584l-2.25-2.25q1.166-1.5 1.854-3.209.687-1.708.937-3.541h3.209q-.292 2.5-1.229 4.791-.938 2.292-2.521 4.209zm.541-12.417q-.291-1.833-.958-3.562-.667-1.73-1.833-3.188l2.375-2.208q1.541 1.916 2.458 4.208.917 2.292 1.167 4.75z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download">
      <path d="M10.8 40.55q-1.35 0-2.375-1T7.4 37.15v-7.7h3.4v7.7h26.35v-7.7h3.4v7.7q0 1.4-1 2.4t-2.4 1zM24 32.1L13.9 22.05l2.45-2.45 5.95 5.95V7.15h3.4v18.4l5.95-5.95 2.45 2.45z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download-done">
      <path d="M9.8 40.5v-3.45h28.4v3.45zm9.2-9.05L7.4 19.85l2.45-2.35L19 26.65l19.2-19.2 2.4 2.4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download-off">
      <path d="M4.9 4.75L43.25 43.1 41 45.3l-4.75-4.75q-.05.05-.075.025-.025-.025-.075-.025H10.8q-1.35 0-2.375-1T7.4 37.15v-7.7h3.4v7.7h22.05l-7-7-1.85 1.8L13.9 21.9l1.85-1.85L2.7 7zm26.75 14.7l2.45 2.45-3.75 3.8-2.45-2.5zM25.7 7.15V21.1l-3.4-3.45V7.15z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-share">
      <path d="M36 32.17c-1.52 0-2.89.59-3.93 1.54L17.82 25.4c.11-.45.18-.92.18-1.4s-.07-.95-.18-1.4l14.1-8.23c1.07 1 2.5 1.62 4.08 1.62 3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6c0 .48.07.95.18 1.4l-14.1 8.23c-1.07-1-2.5-1.62-4.08-1.62-3.31 0-6 2.69-6 6s2.69 6 6 6c1.58 0 3.01-.62 4.08-1.62l14.25 8.31c-.1.42-.16.86-.16 1.31A5.83 5.83 0 1 0 36 32.17z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cog">
      <path d="M38.86 25.95c.08-.64.14-1.29.14-1.95s-.06-1.31-.14-1.95l4.23-3.31c.38-.3.49-.84.24-1.28l-4-6.93c-.25-.43-.77-.61-1.22-.43l-4.98 2.01c-1.03-.79-2.16-1.46-3.38-1.97L29 4.84c-.09-.47-.5-.84-1-.84h-8c-.5 0-.91.37-.99.84l-.75 5.3a14.8 14.8 0 0 0-3.38 1.97L9.9 10.1a1 1 0 0 0-1.22.43l-4 6.93c-.25.43-.14.97.24 1.28l4.22 3.31C9.06 22.69 9 23.34 9 24s.06 1.31.14 1.95l-4.22 3.31c-.38.3-.49.84-.24 1.28l4 6.93c.25.43.77.61 1.22.43l4.98-2.01c1.03.79 2.16 1.46 3.38 1.97l.75 5.3c.08.47.49.84.99.84h8c.5 0 .91-.37.99-.84l.75-5.3a14.8 14.8 0 0 0 3.38-1.97l4.98 2.01a1 1 0 0 0 1.22-.43l4-6.93c.25-.43.14-.97-.24-1.28l-4.22-3.31zM24 31c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-square">
      <path d="M36 8H12c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h24c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zm0 28H12V12h24v24z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle">
      <circle cx="24" cy="24" r="20"></circle>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle-outline">
      <path d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle-inner-circle">
      <path d="M24 4C12.97 4 4 12.97 4 24s8.97 20 20 20 20-8.97 20-20S35.03 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16zm6-16c0 3.31-2.69 6-6 6s-6-2.69-6-6 2.69-6 6-6 6 2.69 6 6z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cancel">
      <path d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm10 27.17L31.17 34 24 26.83 16.83 34 14 31.17 21.17 24 14 16.83 16.83 14 24 21.17 31.17 14 34 16.83 26.83 24 34 31.17z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-replay">
      <path d="M24 10V2L14 12l10 10v-8c6.63 0 12 5.37 12 12s-5.37 12-12 12-12-5.37-12-12H8c0 8.84 7.16 16 16 16s16-7.16 16-16-7.16-16-16-16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-repeat">
      <path d="M14 14h20v6l8-8-8-8v6H10v12h4v-8zm20 20H14v-6l-8 8 8 8v-6h24V26h-4v8z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-5">
      <path d="M17.689 98l-8.697 8.696 8.697 8.697 2.486-2.485-4.32-4.319h1.302c4.93 0 9.071 1.722 12.424 5.165 3.352 3.443 5.029 7.638 5.029 12.584h3.55c0-2.958-.553-5.73-1.658-8.313-1.104-2.583-2.622-4.841-4.555-6.774-1.932-1.932-4.19-3.45-6.773-4.555-2.584-1.104-5.355-1.657-8.313-1.657H15.5l4.615-4.615zm-8.08 21.659v13.861h11.357v5.008H9.609V143h12.7c.834 0 1.55-.298 2.146-.894.596-.597.895-1.31.895-2.145v-7.781c0-.835-.299-1.55-.895-2.147a2.929 2.929 0 0 0-2.147-.894h-8.227v-5.096H25.35v-4.384z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-10">
      <path d="M42.315 125.63c0-4.997-1.694-9.235-5.08-12.713-3.388-3.479-7.571-5.218-12.552-5.218h-1.315l4.363 4.363-2.51 2.51-8.787-8.786L25.221 97l2.45 2.45-4.662 4.663h1.375c2.988 0 5.788.557 8.397 1.673 2.61 1.116 4.892 2.65 6.844 4.602 1.953 1.953 3.487 4.234 4.602 6.844 1.116 2.61 1.674 5.41 1.674 8.398zM8.183 142v-19.657H3.176V117.8h9.643V142zm13.63 0c-1.156 0-2.127-.393-2.912-1.178-.778-.778-1.168-1.746-1.168-2.902v-16.04c0-1.156.393-2.127 1.178-2.912.779-.779 1.746-1.168 2.902-1.168h7.696c1.156 0 2.126.392 2.911 1.177.779.78 1.168 1.747 1.168 2.903v16.04c0 1.156-.392 2.127-1.177 2.912-.779.779-1.746 1.168-2.902 1.168zm.556-4.636h6.583v-15.02H22.37z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-30">
      <path d="M26.047 97l-8.733 8.732 8.733 8.733 2.496-2.494-4.336-4.338h1.307c4.95 0 9.108 1.73 12.474 5.187 3.367 3.458 5.051 7.668 5.051 12.635h3.565c0-2.97-.556-5.751-1.665-8.346-1.109-2.594-2.633-4.862-4.574-6.802-1.94-1.941-4.208-3.466-6.803-4.575-2.594-1.109-5.375-1.664-8.345-1.664H23.85l4.634-4.634zM2.555 117.531v4.688h10.297v5.25H5.873v4.687h6.979v5.156H2.555V142H13.36c1.061 0 1.95-.395 2.668-1.186.718-.79 1.076-1.772 1.076-2.94v-16.218c0-1.168-.358-2.149-1.076-2.94-.717-.79-1.607-1.185-2.668-1.185zm22.482.14c-1.149 0-2.11.39-2.885 1.165-.78.78-1.172 1.744-1.172 2.893v15.943c0 1.149.388 2.11 1.163 2.885.78.78 1.745 1.172 2.894 1.172h7.649c1.148 0 2.11-.388 2.884-1.163.78-.78 1.17-1.745 1.17-2.894v-15.943c0-1.15-.386-2.111-1.16-2.885-.78-.78-1.746-1.172-2.894-1.172zm.553 4.518h6.545v14.93H25.59z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-5">
      <path d="M29.508 97l-2.431 2.43 4.625 4.625h-1.364c-2.965 0-5.742.554-8.332 1.66-2.589 1.107-4.851 2.629-6.788 4.566-1.937 1.937-3.458 4.2-4.565 6.788-1.107 2.59-1.66 5.367-1.66 8.331h3.557c0-4.957 1.68-9.16 5.04-12.611 3.36-3.45 7.51-5.177 12.451-5.177h1.304l-4.326 4.33 2.49 2.49 8.715-8.716zm-9.783 21.61v13.89h11.382v5.018H19.725V142h12.727a2.93 2.93 0 0 0 2.15-.896 2.93 2.93 0 0 0 .896-2.15v-7.798c0-.837-.299-1.554-.896-2.152a2.93 2.93 0 0 0-2.15-.896h-8.245V123h11.29v-4.392z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-10">
      <path d="M23.119 97l-2.386 2.383 4.538 4.538h-1.339c-2.908 0-5.633.543-8.173 1.63-2.54 1.085-4.76 2.577-6.66 4.478-1.9 1.9-3.392 4.12-4.478 6.66-1.085 2.54-1.629 5.264-1.629 8.172h3.49c0-4.863 1.648-8.986 4.944-12.372 3.297-3.385 7.368-5.078 12.216-5.078h1.279l-4.245 4.247 2.443 2.442 8.55-8.55zm-9.52 21.45v4.42h4.871V142h4.513v-23.55zm18.136 0c-1.125 0-2.066.377-2.824 1.135-.764.764-1.148 1.709-1.148 2.834v15.612c0 1.124.38 2.066 1.139 2.824.764.764 1.708 1.145 2.833 1.145h7.489c1.125 0 2.066-.378 2.824-1.136.764-.764 1.145-1.709 1.145-2.833v-15.612c0-1.125-.378-2.067-1.136-2.825-.764-.764-1.708-1.145-2.833-1.145zm.54 4.42h6.408v14.617h-6.407z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-30">
      <path d="M25.549 97l-2.437 2.434 4.634 4.635H26.38c-2.97 0-5.753.555-8.347 1.664-2.594 1.109-4.861 2.633-6.802 4.574-1.94 1.94-3.465 4.207-4.574 6.802-1.109 2.594-1.664 5.377-1.664 8.347h3.565c0-4.967 1.683-9.178 5.05-12.636 3.366-3.458 7.525-5.187 12.475-5.187h1.307l-4.335 4.338 2.495 2.494 8.732-8.732zm-11.553 20.53v4.689h10.297v5.249h-6.978v4.688h6.978v5.156H13.996V142h10.808c1.06 0 1.948-.395 2.666-1.186.718-.79 1.077-1.771 1.077-2.94v-16.217c0-1.169-.36-2.15-1.077-2.94-.718-.79-1.605-1.186-2.666-1.186zm21.174.168c-1.149 0-2.11.389-2.884 1.163-.78.78-1.172 1.745-1.172 2.894v15.942c0 1.15.388 2.11 1.162 2.885.78.78 1.745 1.17 2.894 1.17h7.649c1.149 0 2.11-.386 2.885-1.16.78-.78 1.17-1.746 1.17-2.895v-15.942c0-1.15-.387-2.11-1.161-2.885-.78-.78-1.745-1.172-2.894-1.172zm.552 4.516h6.542v14.931h-6.542z"></path>
    </symbol>
    <symbol viewBox="0 0 512 512" id="vjs-icon-audio-description">
      <g fill-rule="evenodd"><path d="M227.29 381.351V162.993c50.38-1.017 89.108-3.028 117.631 17.126 27.374 19.342 48.734 56.965 44.89 105.325-4.067 51.155-41.335 94.139-89.776 98.475-24.085 2.155-71.972 0-71.972 0s-.84-1.352-.773-2.568m48.755-54.804c31.43 1.26 53.208-16.633 56.495-45.386 4.403-38.51-21.188-63.552-58.041-60.796v103.612c-.036 1.466.575 2.22 1.546 2.57"></path><path d="M383.78 381.328c13.336 3.71 17.387-11.06 23.215-21.408 12.722-22.571 22.294-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.51c-.587 3.874 2.226 7.315 3.865 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894"></path><path d="M425.154 381.328c13.336 3.71 17.384-11.061 23.215-21.408 12.721-22.571 22.291-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.511c-.586 3.874 2.226 7.315 3.866 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894"></path><path d="M466.26 381.328c13.337 3.71 17.385-11.061 23.216-21.408 12.722-22.571 22.292-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.51c-.587 3.874 2.225 7.315 3.865 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894M4.477 383.005H72.58l18.573-28.484 64.169-.135s.065 19.413.065 28.62h48.756V160.307h-58.816c-5.653 9.537-140.85 222.697-140.85 222.697zm152.667-145.282v71.158l-40.453-.27 40.453-70.888z"></path></g>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-next-item">
      <path d="M12 36l17-12-17-12v24zm20-24v24h4V12h-4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-previous-item">
      <path d="M12 12h4v24h-4zm7 12l17 12V12z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-shuffle">
      <path d="M21.17 18.34L10.83 8 8 10.83l10.34 10.34 2.83-2.83zM29 8l4.09 4.09L8 37.17 10.83 40l25.09-25.09L40 19V8H29zm.66 18.83l-2.83 2.83 6.26 6.26L29 40h11V29l-4.09 4.09-6.25-6.26z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cast">
      <path d="M42 6H6c-2.21 0-4 1.79-4 4v6h4v-6h36v28H28v4h14c2.21 0 4-1.79 4-4V10c0-2.21-1.79-4-4-4zM2 36v6h6c0-3.31-2.69-6-6-6zm0-8v4c5.52 0 10 4.48 10 10h4c0-7.73-6.27-14-14-14zm0-8v4c9.94 0 18 8.06 18 18h4c0-12.15-9.85-22-22-22z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-picture-in-picture-enter">
      <path d="M38 22H22v11.99h16V22zm8 16V9.96C46 7.76 44.2 6 42 6H6C3.8 6 2 7.76 2 9.96V38c0 2.2 1.8 4 4 4h36c2.2 0 4-1.8 4-4zm-4 .04H6V9.94h36v28.1z"></path>
    </symbol>
    <symbol viewBox="0 0 22 18" id="vjs-icon-picture-in-picture-exit">
      <path d="M18 4H4v10h14V4zm4 12V1.98C22 .88 21.1 0 20 0H2C.9 0 0 .88 0 1.98V16c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2zm-2 .02H2V1.97h18v14.05z"></path>
      <path fill="none" d="M-1-3h24v24H-1z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-facebook">
      <path d="M1343 12v264h-157q-86 0-116 36t-30 108v189h293l-39 296h-254v759H734V905H479V609h255V391q0-186 104-288.5T1115 0q147 0 228 12z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-linkedin">
      <path d="M477 625v991H147V625h330zm21-306q1 73-50.5 122T312 490h-2q-82 0-132-49t-50-122q0-74 51.5-122.5T314 148t133 48.5T498 319zm1166 729v568h-329v-530q0-105-40.5-164.5T1168 862q-63 0-105.5 34.5T999 982q-11 30-11 81v553H659q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5T1285 602q171 0 275 113.5t104 332.5z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-twitter">
      <path d="M1684 408q-67 98-162 167 1 14 1 42 0 130-38 259.5T1369.5 1125 1185 1335.5t-258 146-323 54.5q-271 0-496-145 35 4 78 4 225 0 401-138-105-2-188-64.5T285 1033q33 5 61 5 43 0 85-11-112-23-185.5-111.5T172 710v-4q68 38 146 41-66-44-105-115t-39-154q0-88 44-163 121 149 294.5 238.5T884 653q-8-38-8-74 0-134 94.5-228.5T1199 256q140 0 236 102 109-21 205-78-37 115-142 178 93-10 186-50z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-tumblr">
      <path d="M1328 1329l80 237q-23 35-111 66t-177 32q-104 2-190.5-26T787 1564t-95-106-55.5-120-16.5-118V676H452V461q72-26 129-69.5t91-90 58-102 34-99T779 12q1-5 4.5-8.5T791 0h244v424h333v252h-334v518q0 30 6.5 56t22.5 52.5 49.5 41.5 81.5 14q78-2 134-29z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-pinterest">
      <path d="M1664 896q0 209-103 385.5T1281.5 1561 896 1664q-111 0-218-32 59-93 78-164 9-34 54-211 20 39 73 67.5t114 28.5q121 0 216-68.5t147-188.5 52-270q0-114-59.5-214T1180 449t-255-63q-105 0-196 29t-154.5 77-109 110.5-67 129.5T377 866q0 104 40 183t117 111q30 12 38-20 2-7 8-31t8-30q6-23-11-43-51-61-51-151 0-151 104.5-259.5T904 517q151 0 235.5 82t84.5 213q0 170-68.5 289T980 1220q-61 0-98-43.5T859 1072q8-35 26.5-93.5t30-103T927 800q0-50-27-83t-77-33q-62 0-105 57t-43 142q0 73 25 122l-99 418q-17 70-13 177-206-91-333-281T128 896q0-209 103-385.5T510.5 231 896 128t385.5 103T1561 510.5 1664 896z"></path>
    </symbol>
  </defs>
</svg>`;class jd extends et{constructor(e,i,r){const o=ci({createEl:!1},i);super(e,o,r);if(!i.playerOptions.sources||i.playerOptions.sources.length===0)for(let d=0,h=i.playerOptions.techOrder;d<h.length;d++){const g=Gi(h[d]);let k=Zt.getTech(g);if(g||(k=et.getComponent(g)),k&&k.isSupported()){e.loadTech_(g);break}}else e.src(i.playerOptions.sources)}}et.registerComponent("MediaLoader",jd);class Go extends et{constructor(e,i){super(e,i);this.options_.controlText&&this.controlText(this.options_.controlText),this.handleMouseOver_=r=>this.handleMouseOver(r),this.handleMouseOut_=r=>this.handleMouseOut(r),this.handleClick_=r=>this.handleClick(r),this.handleKeyDown_=r=>this.handleKeyDown(r),this.emitTapEvents(),this.enable()}createEl(e="div",i={},r={}){i=Object.assign({className:this.buildCSSClass(),tabIndex:0},i),e==="button"&&ri.error(`Creating a ClickableComponent with an HTML element of ${e} is not supported; use a Button instead.`),r=Object.assign({role:"button"},r),this.tabIndex_=i.tabIndex;const o=$t(e,i,r);return this.player_.options_.experimentalSvgIcons||o.appendChild($t("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(o),o}dispose(){this.controlTextEl_=null,super.dispose()}createControlTextEl(e){return this.controlTextEl_=$t("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_}controlText(e,i=this.el()){if(e===void 0)return this.controlText_||"Need Text";const r=this.localize(e);this.controlText_=e,_n(this.controlTextEl_,r),!this.nonIconControl&&!this.player_.options_.noUITitleAttributes&&i.setAttribute("title",r)}buildCSSClass(){return`vjs-control vjs-button ${super.buildCSSClass()}`}enable(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),typeof this.tabIndex_!="undefined"&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick_),this.on("keydown",this.handleKeyDown_))}disable(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),typeof this.tabIndex_!="undefined"&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver_),this.off("mouseout",this.handleMouseOut_),this.off(["tap","click"],this.handleClick_),this.off("keydown",this.handleKeyDown_)}handleLanguagechange(){this.controlText(this.controlText_)}handleClick(e){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)}handleKeyDown(e){fe().isEventKey(e,"Space")||fe().isEventKey(e,"Enter")?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):super.handleKeyDown(e)}}et.registerComponent("ClickableComponent",Go);class ql extends Go{constructor(e,i){super(e,i);this.update(),this.update_=r=>this.update(r),e.on("posterchange",this.update_)}dispose(){this.player().off("posterchange",this.update_),super.dispose()}createEl(){return $t("div",{className:"vjs-poster"})}crossOrigin(e){if(typeof e=="undefined")return this.$("img")?this.$("img").crossOrigin:this.player_.tech_&&this.player_.tech_.isReady_?this.player_.crossOrigin():this.player_.options_.crossOrigin||this.player_.options_.crossorigin||null;if(e!==null&&e!=="anonymous"&&e!=="use-credentials"){this.player_.log.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${e}"`);return}this.$("img")&&(this.$("img").crossOrigin=e)}update(e){const i=this.player().poster();this.setSrc(i),i?this.show():this.hide()}setSrc(e){if(!e){this.el_.textContent="";return}this.$("img")||this.el_.appendChild($t("picture",{className:"vjs-poster",tabIndex:-1},{},$t("img",{loading:"lazy",crossOrigin:this.crossOrigin()},{alt:""}))),this.$("img").src=e}handleClick(e){!this.player_.controls()||(this.player_.tech(!0)&&this.player_.tech(!0).focus(),this.player_.paused()?xr(this.player_.play()):this.player_.pause())}}ql.prototype.crossorigin=ql.prototype.crossOrigin,et.registerComponent("PosterImage",ql);const ur="#222",Uu="#ccc",$d={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function Wl(s,e){let i;if(s.length===4)i=s[1]+s[1]+s[2]+s[2]+s[3]+s[3];else if(s.length===7)i=s.slice(1);else throw new Error("Invalid color code provided, "+s+"; must be formatted as e.g. #f0e or #f604e2.");return"rgba("+parseInt(i.slice(0,2),16)+","+parseInt(i.slice(2,4),16)+","+parseInt(i.slice(4,6),16)+","+e+")"}function Qa(s,e,i){try{s.style[e]=i}catch(r){return}}function ju(s){return s?`${s}px`:""}class Kl extends et{constructor(e,i,r){super(e,i,r);const o=h=>this.updateDisplay(h),d=h=>{this.updateDisplayOverlay(),this.updateDisplay(h)};e.on("loadstart",h=>this.toggleDisplay(h)),e.on("texttrackchange",o),e.on("loadedmetadata",h=>{this.updateDisplayOverlay(),this.preselectTrack(h)}),e.ready(gi(this,function(){if(e.tech_&&e.tech_.featuresNativeTextTracks){this.hide();return}e.on("fullscreenchange",d),e.on("playerresize",d);const h=ae().screen.orientation||ae(),g=ae().screen.orientation?"change":"orientationchange";h.addEventListener(g,d),e.on("dispose",()=>h.removeEventListener(g,d));const k=this.options_.playerOptions.tracks||[];for(let N=0;N<k.length;N++)this.player_.addRemoteTextTrack(k[N],!0);this.preselectTrack()}))}preselectTrack(){const e={captions:1,subtitles:1},i=this.player_.textTracks(),r=this.player_.cache_.selectedLanguage;let o,d,h;for(let g=0;g<i.length;g++){const k=i[g];r&&r.enabled&&r.language&&r.language===k.language&&k.kind in e?k.kind===r.kind?h=k:h||(h=k):r&&!r.enabled?(h=null,o=null,d=null):k.default&&(k.kind==="descriptions"&&!o?o=k:k.kind in e&&!d&&(d=k))}h?h.mode="showing":d?d.mode="showing":o&&(o.mode="showing")}toggleDisplay(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()}createEl(){return super.createEl("div",{className:"vjs-text-track-display"},{translate:"yes","aria-live":"off","aria-atomic":"true"})}clearDisplay(){typeof ae().WebVTT=="function"&&ae().WebVTT.processCues(ae(),[],this.el_)}updateDisplay(){const e=this.player_.textTracks(),i=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),i){const h=[];for(let g=0;g<e.length;++g){const k=e[g];k.mode==="showing"&&h.push(k)}this.updateForTrack(h);return}let r=null,o=null,d=e.length;for(;d--;){const h=e[d];h.mode==="showing"&&(h.kind==="descriptions"?r=h:o=h)}o?(this.getAttribute("aria-live")!=="off"&&this.setAttribute("aria-live","off"),this.updateForTrack(o)):r&&(this.getAttribute("aria-live")!=="assertive"&&this.setAttribute("aria-live","assertive"),this.updateForTrack(r))}updateDisplayOverlay(){if(!this.player_.videoHeight()||!ae().CSS.supports("inset-inline: 10px"))return;const e=this.player_.currentWidth(),i=this.player_.currentHeight(),r=e/i,o=this.player_.videoWidth()/this.player_.videoHeight();let d=0,h=0;Math.abs(r-o)>.1&&(r>o?d=Math.round((e-i*o)/2):h=Math.round((i-e/o)/2)),Qa(this.el_,"insetInline",ju(d)),Qa(this.el_,"insetBlock",ju(h))}updateDisplayState(e){const i=this.player_.textTrackSettings.getValues(),r=e.activeCues;let o=r.length;for(;o--;){const d=r[o];if(!d)continue;const h=d.displayState;if(i.color&&(h.firstChild.style.color=i.color),i.textOpacity&&Qa(h.firstChild,"color",Wl(i.color||"#fff",i.textOpacity)),i.backgroundColor&&(h.firstChild.style.backgroundColor=i.backgroundColor),i.backgroundOpacity&&Qa(h.firstChild,"backgroundColor",Wl(i.backgroundColor||"#000",i.backgroundOpacity)),i.windowColor&&(i.windowOpacity?Qa(h,"backgroundColor",Wl(i.windowColor,i.windowOpacity)):h.style.backgroundColor=i.windowColor),i.edgeStyle&&(i.edgeStyle==="dropshadow"?h.firstChild.style.textShadow=`2px 2px 3px ${ur}, 2px 2px 4px ${ur}, 2px 2px 5px ${ur}`:i.edgeStyle==="raised"?h.firstChild.style.textShadow=`1px 1px ${ur}, 2px 2px ${ur}, 3px 3px ${ur}`:i.edgeStyle==="depressed"?h.firstChild.style.textShadow=`1px 1px ${Uu}, 0 1px ${Uu}, -1px -1px ${ur}, 0 -1px ${ur}`:i.edgeStyle==="uniform"&&(h.firstChild.style.textShadow=`0 0 4px ${ur}, 0 0 4px ${ur}, 0 0 4px ${ur}, 0 0 4px ${ur}`)),i.fontPercent&&i.fontPercent!==1){const g=ae().parseFloat(h.style.fontSize);h.style.fontSize=g*i.fontPercent+"px",h.style.height="auto",h.style.top="auto"}i.fontFamily&&i.fontFamily!=="default"&&(i.fontFamily==="small-caps"?h.firstChild.style.fontVariant="small-caps":h.firstChild.style.fontFamily=$d[i.fontFamily])}}updateForTrack(e){if(Array.isArray(e)||(e=[e]),typeof ae().WebVTT!="function"||e.every(r=>!r.activeCues))return;const i=[];for(let r=0;r<e.length;++r){const o=e[r];for(let d=0;d<o.activeCues.length;++d)i.push(o.activeCues[d])}ae().WebVTT.processCues(ae(),i,this.el_);for(let r=0;r<e.length;++r){const o=e[r];for(let d=0;d<o.activeCues.length;++d){const h=o.activeCues[d].displayState;Br(h,"vjs-text-track-cue","vjs-text-track-cue-"+(o.language?o.language:r)),o.language&&Rn(h,"lang",o.language)}this.player_.textTrackSettings&&this.updateDisplayState(o)}}}et.registerComponent("TextTrackDisplay",Kl);class Vd extends et{createEl(){const e=this.player_.isAudio(),i=this.localize(e?"Audio Player":"Video Player"),r=$t("span",{className:"vjs-control-text",textContent:this.localize("{1} is loading.",[i])}),o=super.createEl("div",{className:"vjs-loading-spinner",dir:"ltr"});return o.appendChild(r),o}handleLanguagechange(){this.$(".vjs-control-text").textContent=this.localize("{1} is loading.",[this.player_.isAudio()?"Audio Player":"Video Player"])}}et.registerComponent("LoadingSpinner",Vd);class ln extends Go{createEl(e,i={},r={}){e="button",i=Object.assign({className:this.buildCSSClass()},i),r=Object.assign({type:"button"},r);const o=$t(e,i,r);return this.player_.options_.experimentalSvgIcons||o.appendChild($t("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(o),o}addChild(e,i={}){const r=this.constructor.name;return ri.warn(`Adding an actionable (user controllable) child to a Button (${r}) is not supported; use a ClickableComponent instead.`),et.prototype.addChild.call(this,e,i)}enable(){super.enable(),this.el_.removeAttribute("disabled")}disable(){super.disable(),this.el_.setAttribute("disabled","disabled")}handleKeyDown(e){if(fe().isEventKey(e,"Space")||fe().isEventKey(e,"Enter")){e.stopPropagation();return}super.handleKeyDown(e)}}et.registerComponent("Button",ln);class f extends ln{constructor(e,i){super(e,i);this.mouseused_=!1,this.setIcon("play"),this.on("mousedown",r=>this.handleMouseDown(r))}buildCSSClass(){return"vjs-big-play-button"}handleClick(e){const i=this.player_.play();if(this.mouseused_&&"clientX"in e&&"clientY"in e){xr(i),this.player_.tech(!0)&&this.player_.tech(!0).focus();return}const r=this.player_.getChild("controlBar"),o=r&&r.getChild("playToggle");if(!o){this.player_.tech(!0).focus();return}const d=()=>o.focus();$r(i)?i.then(d,()=>{}):this.setTimeout(d,1)}handleKeyDown(e){this.mouseused_=!1,super.handleKeyDown(e)}handleMouseDown(e){this.mouseused_=!0}}f.prototype.controlText_="Play Video",et.registerComponent("BigPlayButton",f);class t extends ln{constructor(e,i){super(e,i);this.setIcon("cancel"),this.controlText(i&&i.controlText||this.localize("Close"))}buildCSSClass(){return`vjs-close-button ${super.buildCSSClass()}`}handleClick(e){this.trigger({type:"close",bubbles:!1})}handleKeyDown(e){fe().isEventKey(e,"Esc")?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):super.handleKeyDown(e)}}et.registerComponent("CloseButton",t);class n extends ln{constructor(e,i={}){super(e,i);i.replay=i.replay===void 0||i.replay,this.setIcon("play"),this.on(e,"play",r=>this.handlePlay(r)),this.on(e,"pause",r=>this.handlePause(r)),i.replay&&this.on(e,"ended",r=>this.handleEnded(r))}buildCSSClass(){return`vjs-play-control ${super.buildCSSClass()}`}handleClick(e){this.player_.paused()?xr(this.player_.play()):this.player_.pause()}handleSeeked(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)}handlePlay(e){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.setIcon("pause"),this.controlText("Pause")}handlePause(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.setIcon("play"),this.controlText("Play")}handleEnded(e){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.setIcon("replay"),this.controlText("Replay"),this.one(this.player_,"seeked",i=>this.handleSeeked(i))}}n.prototype.controlText_="Play",et.registerComponent("PlayToggle",n);class a extends et{constructor(e,i){super(e,i);this.on(e,["timeupdate","ended"],r=>this.updateContent(r)),this.updateTextNode_()}createEl(){const e=this.buildCSSClass(),i=super.createEl("div",{className:`${e} vjs-time-control vjs-control`}),r=$t("span",{className:"vjs-control-text",textContent:`${this.localize(this.labelText_)}\xA0`},{role:"presentation"});return i.appendChild(r),this.contentEl_=$t("span",{className:`${e}-display`},{role:"presentation"}),i.appendChild(this.contentEl_),i}dispose(){this.contentEl_=null,this.textNode_=null,super.dispose()}updateTextNode_(e=0){e=qs(e),this.formattedTime_!==e&&(this.formattedTime_=e,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",()=>{if(!this.contentEl_)return;let i=this.textNode_;i&&this.contentEl_.firstChild!==i&&(i=null,ri.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")),this.textNode_=_e().createTextNode(this.formattedTime_),!!this.textNode_&&(i?this.contentEl_.replaceChild(this.textNode_,i):this.contentEl_.appendChild(this.textNode_))}))}updateContent(e){}}a.prototype.labelText_="Time",a.prototype.controlText_="Time",et.registerComponent("TimeDisplay",a);class l extends a{buildCSSClass(){return"vjs-current-time"}updateContent(e){let i;this.player_.ended()?i=this.player_.duration():i=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(i)}}l.prototype.labelText_="Current Time",l.prototype.controlText_="Current Time",et.registerComponent("CurrentTimeDisplay",l);class u extends a{constructor(e,i){super(e,i);const r=o=>this.updateContent(o);this.on(e,"durationchange",r),this.on(e,"loadstart",r),this.on(e,"loadedmetadata",r)}buildCSSClass(){return"vjs-duration"}updateContent(e){const i=this.player_.duration();this.updateTextNode_(i)}}u.prototype.labelText_="Duration",u.prototype.controlText_="Duration",et.registerComponent("DurationDisplay",u);class c extends et{createEl(){const e=super.createEl("div",{className:"vjs-time-control vjs-time-divider"},{"aria-hidden":!0}),i=super.createEl("div"),r=super.createEl("span",{textContent:"/"});return i.appendChild(r),e.appendChild(i),e}}et.registerComponent("TimeDivider",c);class p extends a{constructor(e,i){super(e,i);this.on(e,"durationchange",r=>this.updateContent(r))}buildCSSClass(){return"vjs-remaining-time"}createEl(){const e=super.createEl();return this.options_.displayNegative!==!1&&e.insertBefore($t("span",{},{"aria-hidden":!0},"-"),this.contentEl_),e}updateContent(e){if(typeof this.player_.duration()!="number")return;let i;this.player_.ended()?i=0:this.player_.remainingTimeDisplay?i=this.player_.remainingTimeDisplay():i=this.player_.remainingTime(),this.updateTextNode_(i)}}p.prototype.labelText_="Remaining Time",p.prototype.controlText_="Remaining Time",et.registerComponent("RemainingTimeDisplay",p);class v extends et{constructor(e,i){super(e,i);this.updateShowing(),this.on(this.player(),"durationchange",r=>this.updateShowing(r))}createEl(){const e=super.createEl("div",{className:"vjs-live-control vjs-control"});return this.contentEl_=$t("div",{className:"vjs-live-display"},{"aria-live":"off"}),this.contentEl_.appendChild($t("span",{className:"vjs-control-text",textContent:`${this.localize("Stream Type")}\xA0`})),this.contentEl_.appendChild(_e().createTextNode(this.localize("LIVE"))),e.appendChild(this.contentEl_),e}dispose(){this.contentEl_=null,super.dispose()}updateShowing(e){this.player().duration()===Infinity?this.show():this.hide()}}et.registerComponent("LiveDisplay",v);class A extends ln{constructor(e,i){super(e,i);this.updateLiveEdgeStatus(),this.player_.liveTracker&&(this.updateLiveEdgeStatusHandler_=r=>this.updateLiveEdgeStatus(r),this.on(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_))}createEl(){const e=super.createEl("button",{className:"vjs-seek-to-live-control vjs-control"});return this.setIcon("circle",e),this.textEl_=$t("span",{className:"vjs-seek-to-live-text",textContent:this.localize("LIVE")},{"aria-hidden":"true"}),e.appendChild(this.textEl_),e}updateLiveEdgeStatus(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))}handleClick(){this.player_.liveTracker.seekToLiveEdge()}dispose(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_),this.textEl_=null,super.dispose()}}A.prototype.controlText_="Seek to live, currently playing live",et.registerComponent("SeekToLive",A);function C(s,e,i){return s=Number(s),Math.min(i,Math.max(e,isNaN(s)?e:s))}var O=Object.freeze({__proto__:null,clamp:C});class U extends et{constructor(e,i){super(e,i);this.handleMouseDown_=r=>this.handleMouseDown(r),this.handleMouseUp_=r=>this.handleMouseUp(r),this.handleKeyDown_=r=>this.handleKeyDown(r),this.handleClick_=r=>this.handleClick(r),this.handleMouseMove_=r=>this.handleMouseMove(r),this.update_=r=>this.update(r),this.bar=this.getChild(this.options_.barName),this.vertical(!!this.options_.vertical),this.enable()}enabled(){return this.enabled_}enable(){this.enabled()||(this.on("mousedown",this.handleMouseDown_),this.on("touchstart",this.handleMouseDown_),this.on("keydown",this.handleKeyDown_),this.on("click",this.handleClick_),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)}disable(){if(!this.enabled())return;const e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown_),this.off("touchstart",this.handleMouseDown_),this.off("keydown",this.handleKeyDown_),this.off("click",this.handleClick_),this.off(this.player_,"controlsvisible",this.update_),this.off(e,"mousemove",this.handleMouseMove_),this.off(e,"mouseup",this.handleMouseUp_),this.off(e,"touchmove",this.handleMouseMove_),this.off(e,"touchend",this.handleMouseUp_),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}createEl(e,i={},r={}){return i.className=i.className+" vjs-slider",i=Object.assign({tabIndex:0},i),r=Object.assign({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100},r),super.createEl(e,i,r)}handleMouseDown(e){const i=this.bar.el_.ownerDocument;e.type==="mousedown"&&e.preventDefault(),e.type==="touchstart"&&!An&&e.preventDefault(),qa(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(i,"mousemove",this.handleMouseMove_),this.on(i,"mouseup",this.handleMouseUp_),this.on(i,"touchmove",this.handleMouseMove_),this.on(i,"touchend",this.handleMouseUp_),this.handleMouseMove(e,!0)}handleMouseMove(e){}handleMouseUp(e){const i=this.bar.el_.ownerDocument;x(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(i,"mousemove",this.handleMouseMove_),this.off(i,"mouseup",this.handleMouseUp_),this.off(i,"touchmove",this.handleMouseMove_),this.off(i,"touchend",this.handleMouseUp_),this.update()}update(){if(!this.el_||!this.bar)return;const e=this.getProgress();return e===this.progress_||(this.progress_=e,this.requestNamedAnimationFrame("Slider#update",()=>{const i=this.vertical()?"height":"width";this.bar.el().style[i]=(e*100).toFixed(2)+"%"})),e}getProgress(){return Number(C(this.getPercent(),0,1).toFixed(4))}calculateDistance(e){const i=_(this.el_,e);return this.vertical()?i.y:i.x}handleKeyDown(e){fe().isEventKey(e,"Left")||fe().isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepBack()):fe().isEventKey(e,"Right")||fe().isEventKey(e,"Up")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):super.handleKeyDown(e)}handleClick(e){e.stopPropagation(),e.preventDefault()}vertical(e){if(e===void 0)return this.vertical_||!1;this.vertical_=!!e,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")}}et.registerComponent("Slider",U);const W=(s,e)=>C(s/e*100,0,100).toFixed(2)+"%";class J extends et{constructor(e,i){super(e,i);this.partEls_=[],this.on(e,"progress",r=>this.update(r))}createEl(){const e=super.createEl("div",{className:"vjs-load-progress"}),i=$t("span",{className:"vjs-control-text"}),r=$t("span",{textContent:this.localize("Loaded")}),o=_e().createTextNode(": ");return this.percentageEl_=$t("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),e.appendChild(i),i.appendChild(r),i.appendChild(o),i.appendChild(this.percentageEl_),e}dispose(){this.partEls_=null,this.percentageEl_=null,super.dispose()}update(e){this.requestNamedAnimationFrame("LoadProgressBar#update",()=>{const i=this.player_.liveTracker,r=this.player_.buffered(),o=i&&i.isLive()?i.seekableEnd():this.player_.duration(),d=this.player_.bufferedEnd(),h=this.partEls_,g=W(d,o);this.percent_!==g&&(this.el_.style.width=g,_n(this.percentageEl_,g),this.percent_=g);for(let k=0;k<r.length;k++){const N=r.start(k),Y=r.end(k);let me=h[k];me||(me=this.el_.appendChild($t()),h[k]=me),!(me.dataset.start===N&&me.dataset.end===Y)&&(me.dataset.start=N,me.dataset.end=Y,me.style.left=W(N,d),me.style.width=W(Y-N,d))}for(let k=h.length;k>r.length;k--)this.el_.removeChild(h[k-1]);h.length=r.length})}}et.registerComponent("LoadProgressBar",J);class oe extends et{constructor(e,i){super(e,i);this.update=Ur(gi(this,this.update),ar)}createEl(){return super.createEl("div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})}update(e,i,r){const o=q(this.el_),d=L(this.player_.el()),h=e.width*i;if(!d||!o)return;const g=e.left-d.left+h,k=e.width-h+(d.right-e.right);let N=o.width/2;g<N?N+=N-g:k<N&&(N=k),N<0?N=0:N>o.width&&(N=o.width),N=Math.round(N),this.el_.style.right=`-${N}px`,this.write(r)}write(e){_n(this.el_,e)}updateTime(e,i,r,o){this.requestNamedAnimationFrame("TimeTooltip#updateTime",()=>{let d;const h=this.player_.duration();if(this.player_.liveTracker&&this.player_.liveTracker.isLive()){const g=this.player_.liveTracker.liveWindow(),k=g-i*g;d=(k<1?"":"-")+qs(k,g)}else d=qs(r,h);this.update(e,i,d),o&&o()})}}et.registerComponent("TimeTooltip",oe);class he extends et{constructor(e,i){super(e,i);this.setIcon("circle"),this.update=Ur(gi(this,this.update),ar)}createEl(){return super.createEl("div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})}update(e,i){const r=this.getChild("timeTooltip");if(!r)return;const o=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();r.updateTime(e,i,o)}}he.prototype.options_={children:[]},!bn&&!on&&he.prototype.options_.children.push("timeTooltip"),et.registerComponent("PlayProgressBar",he);class we extends et{constructor(e,i){super(e,i);this.update=Ur(gi(this,this.update),ar)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(e,i){const r=i*this.player_.duration();this.getChild("timeTooltip").updateTime(e,i,r,()=>{this.el_.style.left=`${e.width*i}px`})}}we.prototype.options_={children:["timeTooltip"]},et.registerComponent("MouseTimeDisplay",we);const Fe=5,Me=12;class it extends U{constructor(e,i){super(e,i);this.setEventHandlers_()}setEventHandlers_(){this.update_=gi(this,this.update),this.update=Ur(this.update_,ar),this.on(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.enableIntervalHandler_=e=>this.enableInterval_(e),this.disableIntervalHandler_=e=>this.disableInterval_(e),this.on(this.player_,["playing"],this.enableIntervalHandler_),this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in _e()&&"visibilityState"in _e()&&this.on(_e(),"visibilitychange",this.toggleVisibility_)}toggleVisibility_(e){_e().visibilityState==="hidden"?(this.cancelNamedAnimationFrame("SeekBar#update"),this.cancelNamedAnimationFrame("Slider#update"),this.disableInterval_(e)):(!this.player_.ended()&&!this.player_.paused()&&this.enableInterval_(),this.update())}enableInterval_(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,ar))}disableInterval_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&e&&e.type!=="ended"||!this.updateInterval||(this.clearInterval(this.updateInterval),this.updateInterval=null)}createEl(){return super.createEl("div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})}update(e){if(_e().visibilityState==="hidden")return;const i=super.update();return this.requestNamedAnimationFrame("SeekBar#update",()=>{const r=this.player_.ended()?this.player_.duration():this.getCurrentTime_(),o=this.player_.liveTracker;let d=this.player_.duration();o&&o.isLive()&&(d=this.player_.liveTracker.liveCurrentTime()),this.percent_!==i&&(this.el_.setAttribute("aria-valuenow",(i*100).toFixed(2)),this.percent_=i),(this.currentTime_!==r||this.duration_!==d)&&(this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[qs(r,d),qs(d,d)],"{1} of {2}")),this.currentTime_=r,this.duration_=d),this.bar&&this.bar.update(L(this.el()),this.getProgress())}),i}userSeek_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(e)}getCurrentTime_(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()}getPercent(){const e=this.getCurrentTime_();let i;const r=this.player_.liveTracker;return r&&r.isLive()?(i=(e-r.seekableStart())/r.liveWindow(),r.atLiveEdge()&&(i=1)):i=e/this.player_.duration(),i}handleMouseDown(e){!Ue(e)||(e.stopPropagation(),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),super.handleMouseDown(e))}handleMouseMove(e,i=!1){if(!Ue(e)||isNaN(this.player_.duration()))return;!i&&!this.player_.scrubbing()&&this.player_.scrubbing(!0);let r;const o=this.calculateDistance(e),d=this.player_.liveTracker;if(!d||!d.isLive())r=o*this.player_.duration(),r===this.player_.duration()&&(r=r-.1);else{if(o>=.99){d.seekToLiveEdge();return}const h=d.seekableStart(),g=d.liveCurrentTime();if(r=h+o*d.liveWindow(),r>=g&&(r=g),r<=h&&(r=h+.1),r===Infinity)return}this.userSeek_(r)}enable(){super.enable();const e=this.getChild("mouseTimeDisplay");!e||e.show()}disable(){super.disable();const e=this.getChild("mouseTimeDisplay");!e||e.hide()}handleMouseUp(e){super.handleMouseUp(e),e&&e.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?xr(this.player_.play()):this.update_()}stepForward(){this.userSeek_(this.player_.currentTime()+Fe)}stepBack(){this.userSeek_(this.player_.currentTime()-Fe)}handleAction(e){this.player_.paused()?this.player_.play():this.player_.pause()}handleKeyDown(e){const i=this.player_.liveTracker;if(fe().isEventKey(e,"Space")||fe().isEventKey(e,"Enter"))e.preventDefault(),e.stopPropagation(),this.handleAction(e);else if(fe().isEventKey(e,"Home"))e.preventDefault(),e.stopPropagation(),this.userSeek_(0);else if(fe().isEventKey(e,"End"))e.preventDefault(),e.stopPropagation(),i&&i.isLive()?this.userSeek_(i.liveCurrentTime()):this.userSeek_(this.player_.duration());else if(/^[0-9]$/.test(fe()(e))){e.preventDefault(),e.stopPropagation();const r=(fe().codes[fe()(e)]-fe().codes[0])*10/100;i&&i.isLive()?this.userSeek_(i.seekableStart()+i.liveWindow()*r):this.userSeek_(this.player_.duration()*r)}else fe().isEventKey(e,"PgDn")?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()-Fe*Me)):fe().isEventKey(e,"PgUp")?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()+Fe*Me)):super.handleKeyDown(e)}dispose(){this.disableInterval_(),this.off(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableIntervalHandler_),this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in _e()&&"visibilityState"in _e()&&this.off(_e(),"visibilitychange",this.toggleVisibility_),super.dispose()}}it.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},!bn&&!on&&it.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),et.registerComponent("SeekBar",it);class We extends et{constructor(e,i){super(e,i);this.handleMouseMove=Ur(gi(this,this.handleMouseMove),ar),this.throttledHandleMouseSeek=Ur(gi(this,this.handleMouseSeek),ar),this.handleMouseUpHandler_=r=>this.handleMouseUp(r),this.handleMouseDownHandler_=r=>this.handleMouseDown(r),this.enable()}createEl(){return super.createEl("div",{className:"vjs-progress-control vjs-control"})}handleMouseMove(e){const i=this.getChild("seekBar");if(!i)return;const r=i.getChild("playProgressBar"),o=i.getChild("mouseTimeDisplay");if(!r&&!o)return;const d=i.el(),h=q(d);let g=_(d,e).x;g=C(g,0,1),o&&o.update(h,g),r&&r.update(h,i.getProgress())}handleMouseSeek(e){const i=this.getChild("seekBar");i&&i.handleMouseMove(e)}enabled(){return this.enabled_}disable(){if(this.children().forEach(e=>e.disable&&e.disable()),!!this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDownHandler_),this.off(this.el_,"mousemove",this.handleMouseMove),this.removeListenersAddedOnMousedownAndTouchstart(),this.addClass("disabled"),this.enabled_=!1,this.player_.scrubbing())){const e=this.getChild("seekBar");this.player_.scrubbing(!1),e.videoWasPlaying&&xr(this.player_.play())}}enable(){this.children().forEach(e=>e.enable&&e.enable()),!this.enabled()&&(this.on(["mousedown","touchstart"],this.handleMouseDownHandler_),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)}removeListenersAddedOnMousedownAndTouchstart(){const e=this.el_.ownerDocument;this.off(e,"mousemove",this.throttledHandleMouseSeek),this.off(e,"touchmove",this.throttledHandleMouseSeek),this.off(e,"mouseup",this.handleMouseUpHandler_),this.off(e,"touchend",this.handleMouseUpHandler_)}handleMouseDown(e){const i=this.el_.ownerDocument,r=this.getChild("seekBar");r&&r.handleMouseDown(e),this.on(i,"mousemove",this.throttledHandleMouseSeek),this.on(i,"touchmove",this.throttledHandleMouseSeek),this.on(i,"mouseup",this.handleMouseUpHandler_),this.on(i,"touchend",this.handleMouseUpHandler_)}handleMouseUp(e){const i=this.getChild("seekBar");i&&i.handleMouseUp(e),this.removeListenersAddedOnMousedownAndTouchstart()}}We.prototype.options_={children:["seekBar"]},et.registerComponent("ProgressControl",We);class St extends ln{constructor(e,i){super(e,i);this.setIcon("picture-in-picture-enter"),this.on(e,["enterpictureinpicture","leavepictureinpicture"],r=>this.handlePictureInPictureChange(r)),this.on(e,["disablepictureinpicturechanged","loadedmetadata"],r=>this.handlePictureInPictureEnabledChange(r)),this.on(e,["loadedmetadata","audioonlymodechange","audiopostermodechange"],()=>this.handlePictureInPictureAudioModeChange()),this.disable()}buildCSSClass(){return`vjs-picture-in-picture-control vjs-hidden ${super.buildCSSClass()}`}handlePictureInPictureAudioModeChange(){if(!(this.player_.currentType().substring(0,5)==="audio"||this.player_.audioPosterMode()||this.player_.audioOnlyMode())){this.show();return}this.player_.isInPictureInPicture()&&this.player_.exitPictureInPicture(),this.hide()}handlePictureInPictureEnabledChange(){_e().pictureInPictureEnabled&&this.player_.disablePictureInPicture()===!1||this.player_.options_.enableDocumentPictureInPicture&&"documentPictureInPicture"in ae()?this.enable():this.disable()}handlePictureInPictureChange(e){this.player_.isInPictureInPicture()?(this.setIcon("picture-in-picture-exit"),this.controlText("Exit Picture-in-Picture")):(this.setIcon("picture-in-picture-enter"),this.controlText("Picture-in-Picture")),this.handlePictureInPictureEnabledChange()}handleClick(e){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()}show(){typeof _e().exitPictureInPicture=="function"&&super.show()}}St.prototype.controlText_="Picture-in-Picture",et.registerComponent("PictureInPictureToggle",St);class ut extends ln{constructor(e,i){super(e,i);this.setIcon("fullscreen-enter"),this.on(e,"fullscreenchange",r=>this.handleFullscreenChange(r)),_e()[e.fsApi_.fullscreenEnabled]===!1&&this.disable()}buildCSSClass(){return`vjs-fullscreen-control ${super.buildCSSClass()}`}handleFullscreenChange(e){this.player_.isFullscreen()?(this.controlText("Exit Fullscreen"),this.setIcon("fullscreen-exit")):(this.controlText("Fullscreen"),this.setIcon("fullscreen-enter"))}handleClick(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()}}ut.prototype.controlText_="Fullscreen",et.registerComponent("FullscreenToggle",ut);const gt=function(s,e){e.tech_&&!e.tech_.featuresVolumeControl&&s.addClass("vjs-hidden"),s.on(e,"loadstart",function(){e.tech_.featuresVolumeControl?s.removeClass("vjs-hidden"):s.addClass("vjs-hidden")})};class Ct extends et{createEl(){const e=super.createEl("div",{className:"vjs-volume-level"});return this.setIcon("circle",e),e.appendChild(super.createEl("span",{className:"vjs-control-text"})),e}}et.registerComponent("VolumeLevel",Ct);class rt extends et{constructor(e,i){super(e,i);this.update=Ur(gi(this,this.update),ar)}createEl(){return super.createEl("div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})}update(e,i,r,o){if(!r){const d=L(this.el_),h=L(this.player_.el()),g=e.width*i;if(!h||!d)return;const k=e.left-h.left+g,N=e.width-g+(h.right-e.right);let Y=d.width/2;k<Y?Y+=Y-k:N<Y&&(Y=N),Y<0?Y=0:Y>d.width&&(Y=d.width),this.el_.style.right=`-${Y}px`}this.write(`${o}%`)}write(e){_n(this.el_,e)}updateVolume(e,i,r,o,d){this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",()=>{this.update(e,i,r,o.toFixed(0)),d&&d()})}}et.registerComponent("VolumeLevelTooltip",rt);class qt extends et{constructor(e,i){super(e,i);this.update=Ur(gi(this,this.update),ar)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(e,i,r){const o=100*i;this.getChild("volumeLevelTooltip").updateVolume(e,i,r,o,()=>{r?this.el_.style.bottom=`${e.height*i}px`:this.el_.style.left=`${e.width*i}px`})}}qt.prototype.options_={children:["volumeLevelTooltip"]},et.registerComponent("MouseVolumeLevelDisplay",qt);class Ot extends U{constructor(e,i){super(e,i);this.on("slideractive",r=>this.updateLastVolume_(r)),this.on(e,"volumechange",r=>this.updateARIAAttributes(r)),e.ready(()=>this.updateARIAAttributes())}createEl(){return super.createEl("div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})}handleMouseDown(e){!Ue(e)||super.handleMouseDown(e)}handleMouseMove(e){const i=this.getChild("mouseVolumeLevelDisplay");if(i){const r=this.el(),o=L(r),d=this.vertical();let h=_(r,e);h=d?h.y:h.x,h=C(h,0,1),i.update(o,h,d)}!Ue(e)||(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))}checkMuted(){this.player_.muted()&&this.player_.muted(!1)}getPercent(){return this.player_.muted()?0:this.player_.volume()}stepForward(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)}stepBack(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)}updateARIAAttributes(e){const i=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",i),this.el_.setAttribute("aria-valuetext",i+"%")}volumeAsPercentage_(){return Math.round(this.player_.volume()*100)}updateLastVolume_(){const e=this.player_.volume();this.one("sliderinactive",()=>{this.player_.volume()===0&&this.player_.lastVolume_(e)})}}Ot.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},!bn&&!on&&Ot.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay"),Ot.prototype.playerEvent="volumechange",et.registerComponent("VolumeBar",Ot);class Si extends et{constructor(e,i={}){i.vertical=i.vertical||!1,(typeof i.volumeBar=="undefined"||vn(i.volumeBar))&&(i.volumeBar=i.volumeBar||{},i.volumeBar.vertical=i.vertical),super(e,i),gt(this,e),this.throttledHandleMouseMove=Ur(gi(this,this.handleMouseMove),ar),this.handleMouseUpHandler_=r=>this.handleMouseUp(r),this.on("mousedown",r=>this.handleMouseDown(r)),this.on("touchstart",r=>this.handleMouseDown(r)),this.on("mousemove",r=>this.handleMouseMove(r)),this.on(this.volumeBar,["focus","slideractive"],()=>{this.volumeBar.addClass("vjs-slider-active"),this.addClass("vjs-slider-active"),this.trigger("slideractive")}),this.on(this.volumeBar,["blur","sliderinactive"],()=>{this.volumeBar.removeClass("vjs-slider-active"),this.removeClass("vjs-slider-active"),this.trigger("sliderinactive")})}createEl(){let e="vjs-volume-horizontal";return this.options_.vertical&&(e="vjs-volume-vertical"),super.createEl("div",{className:`vjs-volume-control vjs-control ${e}`})}handleMouseDown(e){const i=this.el_.ownerDocument;this.on(i,"mousemove",this.throttledHandleMouseMove),this.on(i,"touchmove",this.throttledHandleMouseMove),this.on(i,"mouseup",this.handleMouseUpHandler_),this.on(i,"touchend",this.handleMouseUpHandler_)}handleMouseUp(e){const i=this.el_.ownerDocument;this.off(i,"mousemove",this.throttledHandleMouseMove),this.off(i,"touchmove",this.throttledHandleMouseMove),this.off(i,"mouseup",this.handleMouseUpHandler_),this.off(i,"touchend",this.handleMouseUpHandler_)}handleMouseMove(e){this.volumeBar.handleMouseMove(e)}}Si.prototype.options_={children:["volumeBar"]},et.registerComponent("VolumeControl",Si);const Pn=function(s,e){e.tech_&&!e.tech_.featuresMuteControl&&s.addClass("vjs-hidden"),s.on(e,"loadstart",function(){e.tech_.featuresMuteControl?s.removeClass("vjs-hidden"):s.addClass("vjs-hidden")})};class Pi extends ln{constructor(e,i){super(e,i);Pn(this,e),this.on(e,["loadstart","volumechange"],r=>this.update(r))}buildCSSClass(){return`vjs-mute-control ${super.buildCSSClass()}`}handleClick(e){const i=this.player_.volume(),r=this.player_.lastVolume_();if(i===0){const o=r<.1?.1:r;this.player_.volume(o),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())}update(e){this.updateIcon_(),this.updateControlText_()}updateIcon_(){const e=this.player_.volume();let i=3;this.setIcon("volume-high"),bn&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),e===0||this.player_.muted()?(this.setIcon("volume-mute"),i=0):e<.33?(this.setIcon("volume-low"),i=1):e<.67&&(this.setIcon("volume-medium"),i=2),ga(this.el_,[0,1,2,3].reduce((r,o)=>r+`${o?" ":""}vjs-vol-${o}`,"")),Br(this.el_,`vjs-vol-${i}`)}updateControlText_(){const i=this.player_.muted()||this.player_.volume()===0?"Unmute":"Mute";this.controlText()!==i&&this.controlText(i)}}Pi.prototype.controlText_="Mute",et.registerComponent("MuteToggle",Pi);class Ni extends et{constructor(e,i={}){typeof i.inline!="undefined"?i.inline=i.inline:i.inline=!0,(typeof i.volumeControl=="undefined"||vn(i.volumeControl))&&(i.volumeControl=i.volumeControl||{},i.volumeControl.vertical=!i.inline),super(e,i),this.handleKeyPressHandler_=r=>this.handleKeyPress(r),this.on(e,["loadstart"],r=>this.volumePanelState_(r)),this.on(this.muteToggle,"keyup",r=>this.handleKeyPress(r)),this.on(this.volumeControl,"keyup",r=>this.handleVolumeControlKeyUp(r)),this.on("keydown",r=>this.handleKeyPress(r)),this.on("mouseover",r=>this.handleMouseOver(r)),this.on("mouseout",r=>this.handleMouseOut(r)),this.on(this.volumeControl,["slideractive"],this.sliderActive_),this.on(this.volumeControl,["sliderinactive"],this.sliderInactive_)}sliderActive_(){this.addClass("vjs-slider-active")}sliderInactive_(){this.removeClass("vjs-slider-active")}volumePanelState_(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")}createEl(){let e="vjs-volume-panel-horizontal";return this.options_.inline||(e="vjs-volume-panel-vertical"),super.createEl("div",{className:`vjs-volume-panel vjs-control ${e}`})}dispose(){this.handleMouseOut(),super.dispose()}handleVolumeControlKeyUp(e){fe().isEventKey(e,"Esc")&&this.muteToggle.focus()}handleMouseOver(e){this.addClass("vjs-hover"),Qn(_e(),"keyup",this.handleKeyPressHandler_)}handleMouseOut(e){this.removeClass("vjs-hover"),pn(_e(),"keyup",this.handleKeyPressHandler_)}handleKeyPress(e){fe().isEventKey(e,"Esc")&&this.handleMouseOut()}}Ni.prototype.options_={children:["muteToggle","volumeControl"]},et.registerComponent("VolumePanel",Ni);class Ui extends ln{constructor(e,i){super(e,i);this.validOptions=[5,10,30],this.skipTime=this.getSkipForwardTime(),this.skipTime&&this.validOptions.includes(this.skipTime)?(this.setIcon(`forward-${this.skipTime}`),this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime])),this.show()):this.hide()}getSkipForwardTime(){const e=this.options_.playerOptions;return e.controlBar&&e.controlBar.skipButtons&&e.controlBar.skipButtons.forward}buildCSSClass(){return`vjs-skip-forward-${this.getSkipForwardTime()} ${super.buildCSSClass()}`}handleClick(e){if(isNaN(this.player_.duration()))return;const i=this.player_.currentTime(),r=this.player_.liveTracker,o=r&&r.isLive()?r.seekableEnd():this.player_.duration();let d;i+this.skipTime<=o?d=i+this.skipTime:d=o,this.player_.currentTime(d)}handleLanguagechange(){this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime]))}}et.registerComponent("SkipForward",Ui);class Ft extends ln{constructor(e,i){super(e,i);this.validOptions=[5,10,30],this.skipTime=this.getSkipBackwardTime(),this.skipTime&&this.validOptions.includes(this.skipTime)?(this.setIcon(`replay-${this.skipTime}`),this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime])),this.show()):this.hide()}getSkipBackwardTime(){const e=this.options_.playerOptions;return e.controlBar&&e.controlBar.skipButtons&&e.controlBar.skipButtons.backward}buildCSSClass(){return`vjs-skip-backward-${this.getSkipBackwardTime()} ${super.buildCSSClass()}`}handleClick(e){const i=this.player_.currentTime(),r=this.player_.liveTracker,o=r&&r.isLive()&&r.seekableStart();let d;o&&i-this.skipTime<=o?d=o:i>=this.skipTime?d=i-this.skipTime:d=0,this.player_.currentTime(d)}handleLanguagechange(){this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime]))}}Ft.prototype.controlText_="Skip Backward",et.registerComponent("SkipBackward",Ft);class Wt extends et{constructor(e,i){super(e,i);i&&(this.menuButton_=i.menuButton),this.focusedChild_=-1,this.on("keydown",r=>this.handleKeyDown(r)),this.boundHandleBlur_=r=>this.handleBlur(r),this.boundHandleTapClick_=r=>this.handleTapClick(r)}addEventListenerForItem(e){e instanceof et&&(this.on(e,"blur",this.boundHandleBlur_),this.on(e,["tap","click"],this.boundHandleTapClick_))}removeEventListenerForItem(e){e instanceof et&&(this.off(e,"blur",this.boundHandleBlur_),this.off(e,["tap","click"],this.boundHandleTapClick_))}removeChild(e){typeof e=="string"&&(e=this.getChild(e)),this.removeEventListenerForItem(e),super.removeChild(e)}addItem(e){const i=this.addChild(e);i&&this.addEventListenerForItem(i)}createEl(){const e=this.options_.contentElType||"ul";this.contentEl_=$t(e,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");const i=super.createEl("div",{append:this.contentEl_,className:"vjs-menu"});return i.appendChild(this.contentEl_),Qn(i,"click",function(r){r.preventDefault(),r.stopImmediatePropagation()}),i}dispose(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,super.dispose()}handleBlur(e){const i=e.relatedTarget||_e().activeElement;if(!this.children().some(r=>r.el()===i)){const r=this.menuButton_;r&&r.buttonPressed_&&i!==r.el().firstChild&&r.unpressButton()}}handleTapClick(e){if(this.menuButton_){this.menuButton_.unpressButton();const i=this.children();if(!Array.isArray(i))return;const r=i.filter(o=>o.el()===e.target)[0];if(!r)return;r.name()!=="CaptionSettingsMenuItem"&&this.menuButton_.focus()}}handleKeyDown(e){fe().isEventKey(e,"Left")||fe().isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(fe().isEventKey(e,"Right")||fe().isEventKey(e,"Up"))&&(e.preventDefault(),e.stopPropagation(),this.stepBack())}stepForward(){let e=0;this.focusedChild_!==void 0&&(e=this.focusedChild_+1),this.focus(e)}stepBack(){let e=0;this.focusedChild_!==void 0&&(e=this.focusedChild_-1),this.focus(e)}focus(e=0){const i=this.children().slice();i.length&&i[0].hasClass("vjs-menu-title")&&i.shift(),i.length>0&&(e<0?e=0:e>=i.length&&(e=i.length-1),this.focusedChild_=e,i[e].el_.focus())}}et.registerComponent("Menu",Wt);class Ei extends et{constructor(e,i={}){super(e,i);this.menuButton_=new ln(e,i),this.menuButton_.controlText(this.controlText_),this.menuButton_.el_.setAttribute("aria-haspopup","true");const r=ln.prototype.buildCSSClass();this.menuButton_.el_.className=this.buildCSSClass()+" "+r,this.menuButton_.removeClass("vjs-control"),this.addChild(this.menuButton_),this.update(),this.enabled_=!0;const o=d=>this.handleClick(d);this.handleMenuKeyUp_=d=>this.handleMenuKeyUp(d),this.on(this.menuButton_,"tap",o),this.on(this.menuButton_,"click",o),this.on(this.menuButton_,"keydown",d=>this.handleKeyDown(d)),this.on(this.menuButton_,"mouseenter",()=>{this.addClass("vjs-hover"),this.menu.show(),Qn(_e(),"keyup",this.handleMenuKeyUp_)}),this.on("mouseleave",d=>this.handleMouseLeave(d)),this.on("keydown",d=>this.handleSubmenuKeyDown(d))}update(){const e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?(this.hide(),this.menu.contentEl_.removeAttribute("role")):(this.show(),this.menu.contentEl_.setAttribute("role","menu"))}createMenu(){const e=new Wt(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){const i=$t("li",{className:"vjs-menu-title",textContent:Gi(this.options_.title),tabIndex:-1}),r=new et(this.player_,{el:i});e.addItem(r)}if(this.items=this.createItems(),this.items)for(let i=0;i<this.items.length;i++)e.addItem(this.items[i]);return e}createItems(){}createEl(){return super.createEl("div",{className:this.buildWrapperCSSClass()},{})}setIcon(e){super.setIcon(e,this.menuButton_.el_)}buildWrapperCSSClass(){let e="vjs-menu-button";this.options_.inline===!0?e+="-inline":e+="-popup";const i=ln.prototype.buildCSSClass();return`vjs-menu-button ${e} ${i} ${super.buildCSSClass()}`}buildCSSClass(){let e="vjs-menu-button";return this.options_.inline===!0?e+="-inline":e+="-popup",`vjs-menu-button ${e} ${super.buildCSSClass()}`}controlText(e,i=this.menuButton_.el()){return this.menuButton_.controlText(e,i)}dispose(){this.handleMouseLeave(),super.dispose()}handleClick(e){this.buttonPressed_?this.unpressButton():this.pressButton()}handleMouseLeave(e){this.removeClass("vjs-hover"),pn(_e(),"keyup",this.handleMenuKeyUp_)}focus(){this.menuButton_.focus()}blur(){this.menuButton_.blur()}handleKeyDown(e){fe().isEventKey(e,"Esc")||fe().isEventKey(e,"Tab")?(this.buttonPressed_&&this.unpressButton(),fe().isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus())):(fe().isEventKey(e,"Up")||fe().isEventKey(e,"Down"))&&(this.buttonPressed_||(e.preventDefault(),this.pressButton()))}handleMenuKeyUp(e){(fe().isEventKey(e,"Esc")||fe().isEventKey(e,"Tab"))&&this.removeClass("vjs-hover")}handleSubmenuKeyPress(e){this.handleSubmenuKeyDown(e)}handleSubmenuKeyDown(e){(fe().isEventKey(e,"Esc")||fe().isEventKey(e,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),fe().isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus()))}pressButton(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),bn&&Ga())return;this.menu.focus()}}unpressButton(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))}disable(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()}enable(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()}}et.registerComponent("MenuButton",Ei);class wi extends Ei{constructor(e,i){const r=i.tracks;super(e,i);if(this.items.length<=1&&this.hide(),!r)return;const o=gi(this,this.update);r.addEventListener("removetrack",o),r.addEventListener("addtrack",o),r.addEventListener("labelchange",o),this.player_.on("ready",o),this.player_.on("dispose",function(){r.removeEventListener("removetrack",o),r.removeEventListener("addtrack",o),r.removeEventListener("labelchange",o)})}}et.registerComponent("TrackButton",wi);const Ti=["Tab","Esc","Up","Down","Right","Left"];class qi extends Go{constructor(e,i){super(e,i);this.selectable=i.selectable,this.isSelected_=i.selected||!1,this.multiSelectable=i.multiSelectable,this.selected(this.isSelected_),this.selectable?this.multiSelectable?this.el_.setAttribute("role","menuitemcheckbox"):this.el_.setAttribute("role","menuitemradio"):this.el_.setAttribute("role","menuitem")}createEl(e,i,r){this.nonIconControl=!0;const o=super.createEl("li",Object.assign({className:"vjs-menu-item",tabIndex:-1},i),r),d=$t("span",{className:"vjs-menu-item-text",textContent:this.localize(this.options_.label)});return this.player_.options_.experimentalSvgIcons?o.appendChild(d):o.replaceChild(d,o.querySelector(".vjs-icon-placeholder")),o}handleKeyDown(e){Ti.some(i=>fe().isEventKey(e,i))||super.handleKeyDown(e)}handleClick(e){this.selected(!0)}selected(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))}}et.registerComponent("MenuItem",qi);class wn extends qi{constructor(e,i){const r=i.track,o=e.textTracks();i.label=r.label||r.language||"Unknown",i.selected=r.mode==="showing",super(e,i),this.track=r,this.kinds=(i.kinds||[i.kind||this.track.kind]).filter(Boolean);const d=(...g)=>{this.handleTracksChange.apply(this,g)},h=(...g)=>{this.handleSelectedLanguageChange.apply(this,g)};if(e.on(["loadstart","texttrackchange"],d),o.addEventListener("change",d),o.addEventListener("selectedlanguagechange",h),this.on("dispose",function(){e.off(["loadstart","texttrackchange"],d),o.removeEventListener("change",d),o.removeEventListener("selectedlanguagechange",h)}),o.onchange===void 0){let g;this.on(["tap","click"],function(){if(typeof ae().Event!="object")try{g=new(ae()).Event("change")}catch(k){}g||(g=_e().createEvent("Event"),g.initEvent("change",!0,!0)),o.dispatchEvent(g)})}this.handleTracksChange()}handleClick(e){const i=this.track,r=this.player_.textTracks();if(super.handleClick(e),!!r)for(let o=0;o<r.length;o++){const d=r[o];this.kinds.indexOf(d.kind)!==-1&&(d===i?d.mode!=="showing"&&(d.mode="showing"):d.mode!=="disabled"&&(d.mode="disabled"))}}handleTracksChange(e){const i=this.track.mode==="showing";i!==this.isSelected_&&this.selected(i)}handleSelectedLanguageChange(e){if(this.track.mode==="showing"){const i=this.player_.cache_.selectedLanguage;if(i&&i.enabled&&i.language===this.track.language&&i.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}}dispose(){this.track=null,super.dispose()}}et.registerComponent("TextTrackMenuItem",wn);class dr extends wn{constructor(e,i){i.track={player:e,kind:i.kind,kinds:i.kinds,default:!1,mode:"disabled"},i.kinds||(i.kinds=[i.kind]),i.label?i.track.label=i.label:i.track.label=i.kinds.join(" and ")+" off",i.selectable=!0,i.multiSelectable=!1,super(e,i)}handleTracksChange(e){const i=this.player().textTracks();let r=!0;for(let o=0,d=i.length;o<d;o++){const h=i[o];if(this.options_.kinds.indexOf(h.kind)>-1&&h.mode==="showing"){r=!1;break}}r!==this.isSelected_&&this.selected(r)}handleSelectedLanguageChange(e){const i=this.player().textTracks();let r=!0;for(let o=0,d=i.length;o<d;o++){const h=i[o];if(["captions","descriptions","subtitles"].indexOf(h.kind)>-1&&h.mode==="showing"){r=!1;break}}r&&(this.player_.cache_.selectedLanguage={enabled:!1})}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.label),super.handleLanguagechange()}}et.registerComponent("OffTextTrackMenuItem",dr);class xn extends wi{constructor(e,i={}){i.tracks=e.textTracks(),super(e,i)}createItems(e=[],i=wn){let r;this.label_&&(r=`${this.label_} off`),e.push(new dr(this.player_,{kinds:this.kinds_,kind:this.kind_,label:r})),this.hideThreshold_+=1;const o=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(let d=0;d<o.length;d++){const h=o[d];if(this.kinds_.indexOf(h.kind)>-1){const g=new i(this.player_,{track:h,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});g.addClass(`vjs-${h.kind}-menu-item`),e.push(g)}}return e}}et.registerComponent("TextTrackButton",xn);class Ss extends qi{constructor(e,i){const r=i.track,o=i.cue,d=e.currentTime();i.selectable=!0,i.multiSelectable=!1,i.label=o.text,i.selected=o.startTime<=d&&d<o.endTime,super(e,i),this.track=r,this.cue=o}handleClick(e){super.handleClick(),this.player_.currentTime(this.cue.startTime)}}et.registerComponent("ChaptersTrackMenuItem",Ss);class Ja extends xn{constructor(e,i,r){super(e,i,r);this.setIcon("chapters"),this.selectCurrentItem_=()=>{this.items.forEach(o=>{o.selected(this.track_.activeCues[0]===o.cue)})}}buildCSSClass(){return`vjs-chapters-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-chapters-button ${super.buildWrapperCSSClass()}`}update(e){if(e&&e.track&&e.track.kind!=="chapters")return;const i=this.findChaptersTrack();i!==this.track_?(this.setTrack(i),super.update()):(!this.items||i&&i.cues&&i.cues.length!==this.items.length)&&super.update()}setTrack(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){const i=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);i&&i.removeEventListener("load",this.updateHandler_),this.track_.removeEventListener("cuechange",this.selectCurrentItem_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";const i=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);i&&i.addEventListener("load",this.updateHandler_),this.track_.addEventListener("cuechange",this.selectCurrentItem_)}}}findChaptersTrack(){const e=this.player_.textTracks()||[];for(let i=e.length-1;i>=0;i--){const r=e[i];if(r.kind===this.kind_)return r}}getMenuCaption(){return this.track_&&this.track_.label?this.track_.label:this.localize(Gi(this.kind_))}createMenu(){return this.options_.title=this.getMenuCaption(),super.createMenu()}createItems(){const e=[];if(!this.track_)return e;const i=this.track_.cues;if(!i)return e;for(let r=0,o=i.length;r<o;r++){const d=i[r],h=new Ss(this.player_,{track:this.track_,cue:d});e.push(h)}return e}}Ja.prototype.kind_="chapters",Ja.prototype.controlText_="Chapters",et.registerComponent("ChaptersButton",Ja);class Hd extends xn{constructor(e,i,r){super(e,i,r);this.setIcon("audio-description");const o=e.textTracks(),d=gi(this,this.handleTracksChange);o.addEventListener("change",d),this.on("dispose",function(){o.removeEventListener("change",d)})}handleTracksChange(e){const i=this.player().textTracks();let r=!1;for(let o=0,d=i.length;o<d;o++){const h=i[o];if(h.kind!==this.kind_&&h.mode==="showing"){r=!0;break}}r?this.disable():this.enable()}buildCSSClass(){return`vjs-descriptions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-descriptions-button ${super.buildWrapperCSSClass()}`}}Hd.prototype.kind_="descriptions",Hd.prototype.controlText_="Descriptions",et.registerComponent("DescriptionsButton",Hd);class Gd extends xn{constructor(e,i,r){super(e,i,r);this.setIcon("subtitles")}buildCSSClass(){return`vjs-subtitles-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subtitles-button ${super.buildWrapperCSSClass()}`}}Gd.prototype.kind_="subtitles",Gd.prototype.controlText_="Subtitles",et.registerComponent("SubtitlesButton",Gd);class qd extends wn{constructor(e,i){i.track={player:e,kind:i.kind,label:i.kind+" settings",selectable:!1,default:!1,mode:"disabled"},i.selectable=!1,i.name="CaptionSettingsMenuItem",super(e,i),this.addClass("vjs-texttrack-settings"),this.controlText(", opens "+i.kind+" settings dialog")}handleClick(e){this.player().getChild("textTrackSettings").open()}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.kind+" settings"),super.handleLanguagechange()}}et.registerComponent("CaptionSettingsMenuItem",qd);class Wd extends xn{constructor(e,i,r){super(e,i,r);this.setIcon("captions")}buildCSSClass(){return`vjs-captions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-captions-button ${super.buildWrapperCSSClass()}`}createItems(){const e=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(e.push(new qd(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),super.createItems(e)}}Wd.prototype.kind_="captions",Wd.prototype.controlText_="Captions",et.registerComponent("CaptionsButton",Wd);class qc extends wn{createEl(e,i,r){const o=super.createEl(e,i,r),d=o.querySelector(".vjs-menu-item-text");return this.options_.track.kind==="captions"&&(this.player_.options_.experimentalSvgIcons?this.setIcon("captions",o):d.appendChild($t("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),d.appendChild($t("span",{className:"vjs-control-text",textContent:` ${this.localize("Captions")}`}))),o}}et.registerComponent("SubsCapsMenuItem",qc);class Kd extends xn{constructor(e,i={}){super(e,i);this.label_="subtitles",this.setIcon("subtitles"),["en","en-us","en-ca","fr-ca"].indexOf(this.player_.language_)>-1&&(this.label_="captions",this.setIcon("captions")),this.menuButton_.controlText(Gi(this.label_))}buildCSSClass(){return`vjs-subs-caps-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subs-caps-button ${super.buildWrapperCSSClass()}`}createItems(){let e=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(e.push(new qd(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e=super.createItems(e,qc),e}}Kd.prototype.kinds_=["captions","subtitles"],Kd.prototype.controlText_="Subtitles",et.registerComponent("SubsCapsButton",Kd);class Wc extends qi{constructor(e,i){const r=i.track,o=e.audioTracks();i.label=r.label||r.language||"Unknown",i.selected=r.enabled,super(e,i),this.track=r,this.addClass(`vjs-${r.kind}-menu-item`);const d=(...h)=>{this.handleTracksChange.apply(this,h)};o.addEventListener("change",d),this.on("dispose",()=>{o.removeEventListener("change",d)})}createEl(e,i,r){const o=super.createEl(e,i,r),d=o.querySelector(".vjs-menu-item-text");return["main-desc","description"].indexOf(this.options_.track.kind)>=0&&(d.appendChild($t("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),d.appendChild($t("span",{className:"vjs-control-text",textContent:" "+this.localize("Descriptions")}))),o}handleClick(e){if(super.handleClick(e),this.track.enabled=!0,this.player_.tech_.featuresNativeAudioTracks){const i=this.player_.audioTracks();for(let r=0;r<i.length;r++){const o=i[r];o!==this.track&&(o.enabled=o===this.track)}}}handleTracksChange(e){this.selected(this.track.enabled)}}et.registerComponent("AudioTrackMenuItem",Wc);class Kc extends wi{constructor(e,i={}){i.tracks=e.audioTracks(),super(e,i),this.setIcon("audio")}buildCSSClass(){return`vjs-audio-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-audio-button ${super.buildWrapperCSSClass()}`}createItems(e=[]){this.hideThreshold_=1;const i=this.player_.audioTracks();for(let r=0;r<i.length;r++){const o=i[r];e.push(new Wc(this.player_,{track:o,selectable:!0,multiSelectable:!1}))}return e}}Kc.prototype.controlText_="Audio Track",et.registerComponent("AudioTrackButton",Kc);class zd extends qi{constructor(e,i){const r=i.rate,o=parseFloat(r,10);i.label=r,i.selected=o===e.playbackRate(),i.selectable=!0,i.multiSelectable=!1,super(e,i),this.label=r,this.rate=o,this.on(e,"ratechange",d=>this.update(d))}handleClick(e){super.handleClick(),this.player().playbackRate(this.rate)}update(e){this.selected(this.player().playbackRate()===this.rate)}}zd.prototype.contentElType="button",et.registerComponent("PlaybackRateMenuItem",zd);class zc extends Ei{constructor(e,i){super(e,i);this.menuButton_.el_.setAttribute("aria-describedby",this.labelElId_),this.updateVisibility(),this.updateLabel(),this.on(e,"loadstart",r=>this.updateVisibility(r)),this.on(e,"ratechange",r=>this.updateLabel(r)),this.on(e,"playbackrateschange",r=>this.handlePlaybackRateschange(r))}createEl(){const e=super.createEl();return this.labelElId_="vjs-playback-rate-value-label-"+this.id_,this.labelEl_=$t("div",{className:"vjs-playback-rate-value",id:this.labelElId_,textContent:"1x"}),e.appendChild(this.labelEl_),e}dispose(){this.labelEl_=null,super.dispose()}buildCSSClass(){return`vjs-playback-rate ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-playback-rate ${super.buildWrapperCSSClass()}`}createItems(){const e=this.playbackRates(),i=[];for(let r=e.length-1;r>=0;r--)i.push(new zd(this.player(),{rate:e[r]+"x"}));return i}handlePlaybackRateschange(e){this.update()}playbackRates(){const e=this.player();return e.playbackRates&&e.playbackRates()||[]}playbackRateSupported(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0}updateVisibility(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")}updateLabel(e){this.playbackRateSupported()&&(this.labelEl_.textContent=this.player().playbackRate()+"x")}}zc.prototype.controlText_="Playback Rate",et.registerComponent("PlaybackRateMenuButton",zc);class Yc extends et{buildCSSClass(){return`vjs-spacer ${super.buildCSSClass()}`}createEl(e="div",i={},r={}){return i.className||(i.className=this.buildCSSClass()),super.createEl(e,i,r)}}et.registerComponent("Spacer",Yc);class Bp extends Yc{buildCSSClass(){return`vjs-custom-control-spacer ${super.buildCSSClass()}`}createEl(){return super.createEl("div",{className:this.buildCSSClass(),textContent:"\xA0"})}}et.registerComponent("CustomControlSpacer",Bp);class Xc extends et{createEl(){return super.createEl("div",{className:"vjs-control-bar",dir:"ltr"})}}Xc.prototype.options_={children:["playToggle","skipBackward","skipForward","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","pictureInPictureToggle","fullscreenToggle"]},et.registerComponent("ControlBar",Xc);class Qc extends ba{constructor(e,i){super(e,i);this.on(e,"error",r=>this.open(r))}buildCSSClass(){return`vjs-error-display ${super.buildCSSClass()}`}content(){const e=this.player().error();return e?this.localize(e.message):""}}Qc.prototype.options_=Object.assign({},ba.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),et.registerComponent("ErrorDisplay",Qc);const Yd="vjs-text-track-settings",Jc=["#000","Black"],Zc=["#00F","Blue"],eh=["#0FF","Cyan"],th=["#0F0","Green"],ih=["#F0F","Magenta"],nh=["#F00","Red"],rh=["#FFF","White"],sh=["#FF0","Yellow"],Xd=["1","Opaque"],Qd=["0.5","Semi-Transparent"],ah=["0","Transparent"],Za={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[Jc,rh,nh,th,Zc,sh,ih,eh]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Opacity",options:[Xd,Qd,ah]},color:{selector:".vjs-text-color > select",id:"captions-foreground-color-%s",label:"Color",options:[rh,Jc,nh,th,Zc,sh,ih,eh]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Drop shadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:s=>s==="1.00"?null:Number(s)},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Opacity",options:[Xd,Qd]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Opacity",options:[ah,Qd,Xd]}};Za.windowColor.options=Za.backgroundColor.options;function oh(s,e){if(e&&(s=e(s)),s&&s!=="none")return s}function Mp(s,e){const i=s.options[s.options.selectedIndex].value;return oh(i,e)}function Fp(s,e,i){if(!!e){for(let r=0;r<s.options.length;r++)if(oh(s.options[r].value,i)===e){s.selectedIndex=r;break}}}class Np extends ba{constructor(e,i){i.temporary=!1,super(e,i),this.updateDisplay=this.updateDisplay.bind(this),this.fill(),this.hasBeenOpened_=this.hasBeenFilled_=!0,this.endDialog=$t("p",{className:"vjs-control-text",textContent:this.localize("End of dialog window.")}),this.el().appendChild(this.endDialog),this.setDefaults(),i.persistTextTrackSettings===void 0&&(this.options_.persistTextTrackSettings=this.options_.playerOptions.persistTextTrackSettings),this.on(this.$(".vjs-done-button"),"click",()=>{this.saveSettings(),this.close()}),this.on(this.$(".vjs-default-button"),"click",()=>{this.setDefaults(),this.updateDisplay()}),gs(Za,r=>{this.on(this.$(r.selector),"change",this.updateDisplay)}),this.options_.persistTextTrackSettings&&this.restoreSettings()}dispose(){this.endDialog=null,super.dispose()}createElSelect_(e,i="",r="label"){const o=Za[e],d=o.id.replace("%s",this.id_),h=[i,d].join(" ").trim();return[`<${r} id="${d}" class="${r==="label"?"vjs-label":""}">`,this.localize(o.label),`</${r}>`,`<select aria-labelledby="${h}">`].concat(o.options.map(g=>{const k=d+"-"+g[1].replace(/\W+/g,"");return[`<option id="${k}" value="${g[0]}" `,`aria-labelledby="${h} ${k}">`,this.localize(g[1]),"</option>"].join("")})).concat("</select>").join("")}createElFgColor_(){const e=`captions-text-legend-${this.id_}`;return['<fieldset class="vjs-fg vjs-track-setting">',`<legend id="${e}">`,this.localize("Text"),"</legend>",'<span class="vjs-text-color">',this.createElSelect_("color",e),"</span>",'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")}createElBgColor_(){const e=`captions-background-${this.id_}`;return['<fieldset class="vjs-bg vjs-track-setting">',`<legend id="${e}">`,this.localize("Text Background"),"</legend>",'<span class="vjs-bg-color">',this.createElSelect_("backgroundColor",e),"</span>",'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")}createElWinColor_(){const e=`captions-window-${this.id_}`;return['<fieldset class="vjs-window vjs-track-setting">',`<legend id="${e}">`,this.localize("Caption Area Background"),"</legend>",'<span class="vjs-window-color">',this.createElSelect_("windowColor",e),"</span>",'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")}createElColors_(){return $t("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})}createElFont_(){return $t("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})}createElControls_(){const e=this.localize("restore all settings to the default values");return $t("div",{className:"vjs-track-settings-controls",innerHTML:[`<button type="button" class="vjs-default-button" title="${e}">`,this.localize("Reset"),`<span class="vjs-control-text"> ${e}</span>`,"</button>",`<button type="button" class="vjs-done-button">${this.localize("Done")}</button>`].join("")})}content(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]}label(){return this.localize("Caption Settings Dialog")}description(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")}buildCSSClass(){return super.buildCSSClass()+" vjs-text-track-settings"}getValues(){return ys(Za,(e,i,r)=>{const o=Mp(this.$(i.selector),i.parser);return o!==void 0&&(e[r]=o),e},{})}setValues(e){gs(Za,(i,r)=>{Fp(this.$(i.selector),e[r],i.parser)})}setDefaults(){gs(Za,e=>{const i=e.hasOwnProperty("default")?e.default:0;this.$(e.selector).selectedIndex=i})}restoreSettings(){let e;try{e=JSON.parse(ae().localStorage.getItem(Yd))}catch(i){ri.warn(i)}e&&this.setValues(e)}saveSettings(){if(!this.options_.persistTextTrackSettings)return;const e=this.getValues();try{Object.keys(e).length?ae().localStorage.setItem(Yd,JSON.stringify(e)):ae().localStorage.removeItem(Yd)}catch(i){ri.warn(i)}}updateDisplay(){const e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()}conditionalBlur_(){this.previouslyActiveEl_=null;const e=this.player_.controlBar,i=e&&e.subsCapsButton,r=e&&e.captionsButton;i?i.focus():r&&r.focus()}handleLanguagechange(){this.fill()}}et.registerComponent("TextTrackSettings",Np);class Up extends et{constructor(e,i){let r=i.ResizeObserver||ae().ResizeObserver;i.ResizeObserver===null&&(r=!1);const o=ci({createEl:!r,reportTouchActivity:!1},i);super(e,o);this.ResizeObserver=i.ResizeObserver||ae().ResizeObserver,this.loadListener_=null,this.resizeObserver_=null,this.debouncedHandler_=gu(()=>{this.resizeHandler()},100,!1,this),r?(this.resizeObserver_=new this.ResizeObserver(this.debouncedHandler_),this.resizeObserver_.observe(e.el())):(this.loadListener_=()=>{if(!this.el_||!this.el_.contentWindow)return;const d=this.debouncedHandler_;let h=this.unloadListener_=function(){pn(this,"resize",d),pn(this,"unload",h),h=null};Qn(this.el_.contentWindow,"unload",h),Qn(this.el_.contentWindow,"resize",d)},this.one("load",this.loadListener_))}createEl(){return super.createEl("iframe",{className:"vjs-resize-manager",tabIndex:-1,title:this.localize("No content")},{"aria-hidden":"true"})}resizeHandler(){!this.player_||!this.player_.trigger||this.player_.trigger("playerresize")}dispose(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,super.dispose()}}et.registerComponent("ResizeManager",Up);const jp={trackingThreshold:20,liveTolerance:15};class $p extends et{constructor(e,i){const r=ci(jp,i,{createEl:!1});super(e,r);this.trackLiveHandler_=()=>this.trackLive_(),this.handlePlay_=o=>this.handlePlay(o),this.handleFirstTimeupdate_=o=>this.handleFirstTimeupdate(o),this.handleSeeked_=o=>this.handleSeeked(o),this.seekToLiveEdge_=o=>this.seekToLiveEdge(o),this.reset_(),this.on(this.player_,"durationchange",o=>this.handleDurationchange(o)),this.on(this.player_,"canplay",()=>this.toggleTracking())}trackLive_(){const e=this.player_.seekable();if(!e||!e.length)return;const i=Number(ae().performance.now().toFixed(4)),r=this.lastTime_===-1?0:(i-this.lastTime_)/1e3;this.lastTime_=i,this.pastSeekEnd_=this.pastSeekEnd()+r;const o=this.liveCurrentTime(),d=this.player_.currentTime();let h=this.player_.paused()||this.seekedBehindLive_||Math.abs(o-d)>this.options_.liveTolerance;(!this.timeupdateSeen_||o===Infinity)&&(h=!1),h!==this.behindLiveEdge_&&(this.behindLiveEdge_=h,this.trigger("liveedgechange"))}handleDurationchange(){this.toggleTracking()}toggleTracking(){this.player_.duration()===Infinity&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())}startTracking(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLiveHandler_,ar),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLiveHandler_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked_):(this.one(this.player_,"play",this.handlePlay_),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)))}handleFirstTimeupdate(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked_)}handleSeeked(){const e=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&e>2,this.nextSeekedFromUser_=!1,this.trackLive_()}handlePlay(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)}reset_(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.nextSeekedFromUser_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLiveHandler_),this.off(this.player_,"seeked",this.handleSeeked_),this.off(this.player_,"play",this.handlePlay_),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_),this.off(this.player_,"timeupdate",this.seekToLiveEdge_)}nextSeekedFromUser(){this.nextSeekedFromUser_=!0}stopTracking(){!this.isTracking()||(this.reset_(),this.trigger("liveedgechange"))}seekableEnd(){const e=this.player_.seekable(),i=[];let r=e?e.length:0;for(;r--;)i.push(e.end(r));return i.length?i.sort()[i.length-1]:Infinity}seekableStart(){const e=this.player_.seekable(),i=[];let r=e?e.length:0;for(;r--;)i.push(e.start(r));return i.length?i.sort()[0]:0}liveWindow(){const e=this.liveCurrentTime();return e===Infinity?0:e-this.seekableStart()}isLive(){return this.isTracking()}atLiveEdge(){return!this.behindLiveEdge()}liveCurrentTime(){return this.pastSeekEnd()+this.seekableEnd()}pastSeekEnd(){const e=this.seekableEnd();return this.lastSeekEnd_!==-1&&e!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=e,this.pastSeekEnd_}behindLiveEdge(){return this.behindLiveEdge_}isTracking(){return typeof this.trackingInterval_=="number"}seekToLiveEdge(){this.seekedBehindLive_=!1,!this.atLiveEdge()&&(this.nextSeekedFromUser_=!1,this.player_.currentTime(this.liveCurrentTime()))}dispose(){this.stopTracking(),super.dispose()}}et.registerComponent("LiveTracker",$p);class Vp extends et{constructor(e,i){super(e,i);this.on("statechanged",r=>this.updateDom_()),this.updateDom_()}createEl(){return this.els={title:$t("div",{className:"vjs-title-bar-title",id:`vjs-title-bar-title-${Xn()}`}),description:$t("div",{className:"vjs-title-bar-description",id:`vjs-title-bar-description-${Xn()}`})},$t("div",{className:"vjs-title-bar"},{},Co(this.els))}updateDom_(){const e=this.player_.tech_,i=e&&e.el_,r={title:"aria-labelledby",description:"aria-describedby"};["title","description"].forEach(o=>{const d=this.state[o],h=this.els[o],g=r[o];B(h),d&&_n(h,d),i&&(i.removeAttribute(g),d&&i.setAttribute(g,h.id))}),this.state.title||this.state.description?this.show():this.hide()}update(e){this.setState(e)}dispose(){const e=this.player_.tech_,i=e&&e.el_;i&&(i.removeAttribute("aria-labelledby"),i.removeAttribute("aria-describedby")),super.dispose(),this.els=null}}et.registerComponent("TitleBar",Vp);const Jd=s=>{const e=s.el();if(e.hasAttribute("src"))return s.triggerSourceset(e.src),!0;const i=s.$$("source"),r=[];let o="";if(!i.length)return!1;for(let d=0;d<i.length;d++){const h=i[d].src;h&&r.indexOf(h)===-1&&r.push(h)}return r.length?(r.length===1&&(o=r[0]),s.triggerSourceset(o),!0):!1},Hp=Object.defineProperty({},"innerHTML",{get(){return this.cloneNode(!0).innerHTML},set(s){const e=_e().createElement(this.nodeName.toLowerCase());e.innerHTML=s;const i=_e().createDocumentFragment();for(;e.childNodes.length;)i.appendChild(e.childNodes[0]);return this.innerText="",ae().Element.prototype.appendChild.call(this,i),this.innerHTML}}),lh=(s,e)=>{let i={};for(let r=0;r<s.length&&(i=Object.getOwnPropertyDescriptor(s[r],e),!(i&&i.set&&i.get));r++);return i.enumerable=!0,i.configurable=!0,i},Gp=s=>lh([s.el(),ae().HTMLMediaElement.prototype,ae().Element.prototype,Hp],"innerHTML"),uh=function(s){const e=s.el();if(e.resetSourceWatch_)return;const i={},r=Gp(s),o=d=>(...h)=>{const g=d.apply(e,h);return Jd(s),g};["append","appendChild","insertAdjacentHTML"].forEach(d=>{!e[d]||(i[d]=e[d],e[d]=o(i[d]))}),Object.defineProperty(e,"innerHTML",ci(r,{set:o(r.set)})),e.resetSourceWatch_=()=>{e.resetSourceWatch_=null,Object.keys(i).forEach(d=>{e[d]=i[d]}),Object.defineProperty(e,"innerHTML",r)},s.one("sourceset",e.resetSourceWatch_)},qp=Object.defineProperty({},"src",{get(){return this.hasAttribute("src")?Ul(ae().Element.prototype.getAttribute.call(this,"src")):""},set(s){return ae().Element.prototype.setAttribute.call(this,"src",s),s}}),Wp=s=>lh([s.el(),ae().HTMLMediaElement.prototype,qp],"src"),Kp=function(s){if(!s.featuresSourceset)return;const e=s.el();if(e.resetSourceset_)return;const i=Wp(s),r=e.setAttribute,o=e.load;Object.defineProperty(e,"src",ci(i,{set:d=>{const h=i.set.call(e,d);return s.triggerSourceset(e.src),h}})),e.setAttribute=(d,h)=>{const g=r.call(e,d,h);return/src/i.test(d)&&s.triggerSourceset(e.src),g},e.load=()=>{const d=o.call(e);return Jd(s)||(s.triggerSourceset(""),uh(s)),d},e.currentSrc?s.triggerSourceset(e.currentSrc):Jd(s)||uh(s),e.resetSourceset_=()=>{e.resetSourceset_=null,e.load=o,e.setAttribute=r,Object.defineProperty(e,"src",i),e.resetSourceWatch_&&e.resetSourceWatch_()}};class Pt extends Zt{constructor(e,i){super(e,i);const r=e.source;let o=!1;if(this.featuresVideoFrameCallback=this.featuresVideoFrameCallback&&this.el_.tagName==="VIDEO",r&&(this.el_.currentSrc!==r.src||e.tag&&e.tag.initNetworkState_===3)?this.setSource(r):this.handleLateInit_(this.el_),e.enableSourceset&&this.setupSourcesetHandling_(),this.isScrubbing_=!1,this.el_.hasChildNodes()){const d=this.el_.childNodes;let h=d.length;const g=[];for(;h--;){const k=d[h];k.nodeName.toLowerCase()==="track"&&(this.featuresNativeTextTracks?(this.remoteTextTrackEls().addTrackElement_(k),this.remoteTextTracks().addTrack(k.track),this.textTracks().addTrack(k.track),!o&&!this.el_.hasAttribute("crossorigin")&&jo(k.src)&&(o=!0)):g.push(k))}for(let k=0;k<g.length;k++)this.el_.removeChild(g[k])}this.proxyNativeTracks_(),this.featuresNativeTextTracks&&o&&ri.warn(`Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.
This may prevent text tracks from loading.`),this.restoreMetadataTracksInIOSNativePlayer_(),(br||pa)&&e.nativeControlsForTouch===!0&&this.setControls(!0),this.proxyWebkitFullscreen_(),this.triggerReady()}dispose(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),Pt.disposeMediaElement(this.el_),this.options_=null,super.dispose()}setupSourcesetHandling_(){Kp(this)}restoreMetadataTracksInIOSNativePlayer_(){const e=this.textTracks();let i;const r=()=>{i=[];for(let d=0;d<e.length;d++){const h=e[d];h.kind==="metadata"&&i.push({track:h,storedMode:h.mode})}};r(),e.addEventListener("change",r),this.on("dispose",()=>e.removeEventListener("change",r));const o=()=>{for(let d=0;d<i.length;d++){const h=i[d];h.track.mode==="disabled"&&h.track.mode!==h.storedMode&&(h.track.mode=h.storedMode)}e.removeEventListener("change",o)};this.on("webkitbeginfullscreen",()=>{e.removeEventListener("change",r),e.removeEventListener("change",o),e.addEventListener("change",o)}),this.on("webkitendfullscreen",()=>{e.removeEventListener("change",r),e.addEventListener("change",r),e.removeEventListener("change",o)})}overrideNative_(e,i){if(i!==this[`featuresNative${e}Tracks`])return;const r=e.toLowerCase();this[`${r}TracksListeners_`]&&Object.keys(this[`${r}TracksListeners_`]).forEach(o=>{this.el()[`${r}Tracks`].removeEventListener(o,this[`${r}TracksListeners_`][o])}),this[`featuresNative${e}Tracks`]=!i,this[`${r}TracksListeners_`]=null,this.proxyNativeTracksForType_(r)}overrideNativeAudioTracks(e){this.overrideNative_("Audio",e)}overrideNativeVideoTracks(e){this.overrideNative_("Video",e)}proxyNativeTracksForType_(e){const i=Zn[e],r=this.el()[i.getterName],o=this[i.getterName]();if(!this[`featuresNative${i.capitalName}Tracks`]||!r||!r.addEventListener)return;const d={change:g=>{const k={type:"change",target:o,currentTarget:o,srcElement:o};o.trigger(k),e==="text"&&this[Ts.remoteText.getterName]().trigger(k)},addtrack(g){o.addTrack(g.track)},removetrack(g){o.removeTrack(g.track)}},h=function(){const g=[];for(let k=0;k<o.length;k++){let N=!1;for(let Y=0;Y<r.length;Y++)if(r[Y]===o[k]){N=!0;break}N||g.push(o[k])}for(;g.length;)o.removeTrack(g.shift())};this[i.getterName+"Listeners_"]=d,Object.keys(d).forEach(g=>{const k=d[g];r.addEventListener(g,k),this.on("dispose",N=>r.removeEventListener(g,k))}),this.on("loadstart",h),this.on("dispose",g=>this.off("loadstart",h))}proxyNativeTracks_(){Zn.names.forEach(e=>{this.proxyNativeTracksForType_(e)})}createEl(){let e=this.options_.tag;if(!e||!(this.options_.playerElIngest||this.movingMediaElementInDOM)){if(e){const r=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(r,e),Pt.disposeMediaElement(e),e=r}else{e=_e().createElement("video");const r=this.options_.tag&&_r(this.options_.tag),o=ci({},r);(!br||this.options_.nativeControlsForTouch!==!0)&&delete o.controls,ns(e,Object.assign(o,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}typeof this.options_.preload!="undefined"&&Rn(e,"preload",this.options_.preload),this.options_.disablePictureInPicture!==void 0&&(e.disablePictureInPicture=this.options_.disablePictureInPicture);const i=["loop","muted","playsinline","autoplay"];for(let r=0;r<i.length;r++){const o=i[r],d=this.options_[o];typeof d!="undefined"&&(d?Rn(e,o,o):Ve(e,o),e[o]=d)}return e}handleLateInit_(e){if(e.networkState===0||e.networkState===3)return;if(e.readyState===0){let r=!1;const o=function(){r=!0};this.on("loadstart",o);const d=function(){r||this.trigger("loadstart")};this.on("loadedmetadata",d),this.ready(function(){this.off("loadstart",o),this.off("loadedmetadata",d),r||this.trigger("loadstart")});return}const i=["loadstart"];i.push("loadedmetadata"),e.readyState>=2&&i.push("loadeddata"),e.readyState>=3&&i.push("canplay"),e.readyState>=4&&i.push("canplaythrough"),this.ready(function(){i.forEach(function(r){this.trigger(r)},this)})}setScrubbing(e){this.isScrubbing_=e}scrubbing(){return this.isScrubbing_}setCurrentTime(e){try{this.isScrubbing_&&this.el_.fastSeek&&Gs?this.el_.fastSeek(e):this.el_.currentTime=e}catch(i){ri(i,"Video is not ready. (Video.js)")}}duration(){if(this.el_.duration===Infinity&&on&&An&&this.el_.currentTime===0){const e=()=>{this.el_.currentTime>0&&(this.el_.duration===Infinity&&this.trigger("durationchange"),this.off("timeupdate",e))};return this.on("timeupdate",e),NaN}return this.el_.duration||NaN}width(){return this.el_.offsetWidth}height(){return this.el_.offsetHeight}proxyWebkitFullscreen_(){if(!("webkitDisplayingFullscreen"in this.el_))return;const e=function(){this.trigger("fullscreenchange",{isFullscreen:!1}),this.el_.controls&&!this.options_.nativeControlsForTouch&&this.controls()&&(this.el_.controls=!1)},i=function(){"webkitPresentationMode"in this.el_&&this.el_.webkitPresentationMode!=="picture-in-picture"&&(this.one("webkitendfullscreen",e),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",i),this.on("dispose",()=>{this.off("webkitbeginfullscreen",i),this.off("webkitendfullscreen",e)})}supportsFullScreen(){return typeof this.el_.webkitEnterFullScreen=="function"}enterFullScreen(){const e=this.el_;if(e.paused&&e.networkState<=e.HAVE_METADATA)xr(this.el_.play()),this.setTimeout(function(){e.pause();try{e.webkitEnterFullScreen()}catch(i){this.trigger("fullscreenerror",i)}},0);else try{e.webkitEnterFullScreen()}catch(i){this.trigger("fullscreenerror",i)}}exitFullScreen(){if(!this.el_.webkitDisplayingFullscreen){this.trigger("fullscreenerror",new Error("The video is not fullscreen"));return}this.el_.webkitExitFullScreen()}requestPictureInPicture(){return this.el_.requestPictureInPicture()}requestVideoFrameCallback(e){return this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.requestVideoFrameCallback(e):super.requestVideoFrameCallback(e)}cancelVideoFrameCallback(e){this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.cancelVideoFrameCallback(e):super.cancelVideoFrameCallback(e)}src(e){if(e===void 0)return this.el_.src;this.setSrc(e)}reset(){Pt.resetMediaElement(this.el_)}currentSrc(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc}setControls(e){this.el_.controls=!!e}addTextTrack(e,i,r){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,i,r):super.addTextTrack(e,i,r)}createRemoteTextTrack(e){if(!this.featuresNativeTextTracks)return super.createRemoteTextTrack(e);const i=_e().createElement("track");return e.kind&&(i.kind=e.kind),e.label&&(i.label=e.label),(e.language||e.srclang)&&(i.srclang=e.language||e.srclang),e.default&&(i.default=e.default),e.id&&(i.id=e.id),e.src&&(i.src=e.src),i}addRemoteTextTrack(e,i){const r=super.addRemoteTextTrack(e,i);return this.featuresNativeTextTracks&&this.el().appendChild(r),r}removeRemoteTextTrack(e){if(super.removeRemoteTextTrack(e),this.featuresNativeTextTracks){const i=this.$$("track");let r=i.length;for(;r--;)(e===i[r]||e===i[r].track)&&this.el().removeChild(i[r])}}getVideoPlaybackQuality(){if(typeof this.el().getVideoPlaybackQuality=="function")return this.el().getVideoPlaybackQuality();const e={};return typeof this.el().webkitDroppedFrameCount!="undefined"&&typeof this.el().webkitDecodedFrameCount!="undefined"&&(e.droppedVideoFrames=this.el().webkitDroppedFrameCount,e.totalVideoFrames=this.el().webkitDecodedFrameCount),ae().performance&&(e.creationTime=ae().performance.now()),e}}da(Pt,"TEST_VID",function(){if(!xs())return;const s=_e().createElement("video"),e=_e().createElement("track");return e.kind="captions",e.srclang="en",e.label="English",s.appendChild(e),s}),Pt.isSupported=function(){try{Pt.TEST_VID.volume=.5}catch(s){return!1}return!!(Pt.TEST_VID&&Pt.TEST_VID.canPlayType)},Pt.canPlayType=function(s){return Pt.TEST_VID.canPlayType(s)},Pt.canPlaySource=function(s,e){return Pt.canPlayType(s.type)},Pt.canControlVolume=function(){try{const s=Pt.TEST_VID.volume;Pt.TEST_VID.volume=s/2+.1;const e=s!==Pt.TEST_VID.volume;return e&&bn?(ae().setTimeout(()=>{Pt&&Pt.prototype&&(Pt.prototype.featuresVolumeControl=s!==Pt.TEST_VID.volume)}),!1):e}catch(s){return!1}},Pt.canMuteVolume=function(){try{const s=Pt.TEST_VID.muted;return Pt.TEST_VID.muted=!s,Pt.TEST_VID.muted?Rn(Pt.TEST_VID,"muted","muted"):Ve(Pt.TEST_VID,"muted","muted"),s!==Pt.TEST_VID.muted}catch(s){return!1}},Pt.canControlPlaybackRate=function(){if(on&&An&&Hs<58)return!1;try{const s=Pt.TEST_VID.playbackRate;return Pt.TEST_VID.playbackRate=s/2+.1,s!==Pt.TEST_VID.playbackRate}catch(s){return!1}},Pt.canOverrideAttributes=function(){try{const s=()=>{};Object.defineProperty(_e().createElement("video"),"src",{get:s,set:s}),Object.defineProperty(_e().createElement("audio"),"src",{get:s,set:s}),Object.defineProperty(_e().createElement("video"),"innerHTML",{get:s,set:s}),Object.defineProperty(_e().createElement("audio"),"innerHTML",{get:s,set:s})}catch(s){return!1}return!0},Pt.supportsNativeTextTracks=function(){return Gs||bn&&An},Pt.supportsNativeVideoTracks=function(){return!!(Pt.TEST_VID&&Pt.TEST_VID.videoTracks)},Pt.supportsNativeAudioTracks=function(){return!!(Pt.TEST_VID&&Pt.TEST_VID.audioTracks)},Pt.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],[["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach(function([s,e]){da(Pt.prototype,s,()=>Pt[e](),!0)}),Pt.prototype.featuresVolumeControl=Pt.canControlVolume(),Pt.prototype.movingMediaElementInDOM=!bn,Pt.prototype.featuresFullscreenResize=!0,Pt.prototype.featuresProgressEvents=!0,Pt.prototype.featuresTimeupdateEvents=!0,Pt.prototype.featuresVideoFrameCallback=!!(Pt.TEST_VID&&Pt.TEST_VID.requestVideoFrameCallback),Pt.disposeMediaElement=function(s){if(!!s){for(s.parentNode&&s.parentNode.removeChild(s);s.hasChildNodes();)s.removeChild(s.firstChild);s.removeAttribute("src"),typeof s.load=="function"&&function(){try{s.load()}catch(e){}}()}},Pt.resetMediaElement=function(s){if(!s)return;const e=s.querySelectorAll("source");let i=e.length;for(;i--;)s.removeChild(e[i]);s.removeAttribute("src"),typeof s.load=="function"&&function(){try{s.load()}catch(r){}}()},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(s){Pt.prototype[s]=function(){return this.el_[s]||this.el_.hasAttribute(s)}}),["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(s){Pt.prototype["set"+Gi(s)]=function(e){this.el_[s]=e,e?this.el_.setAttribute(s,s):this.el_.removeAttribute(s)}}),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach(function(s){Pt.prototype[s]=function(){return this.el_[s]}}),["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach(function(s){Pt.prototype["set"+Gi(s)]=function(e){this.el_[s]=e}}),["pause","load","play"].forEach(function(s){Pt.prototype[s]=function(){return this.el_[s]()}}),Zt.withSourceHandlers(Pt),Pt.nativeSourceHandler={},Pt.nativeSourceHandler.canPlayType=function(s){try{return Pt.TEST_VID.canPlayType(s)}catch(e){return""}},Pt.nativeSourceHandler.canHandleSource=function(s,e){if(s.type)return Pt.nativeSourceHandler.canPlayType(s.type);if(s.src){const i=Uo(s.src);return Pt.nativeSourceHandler.canPlayType(`video/${i}`)}return""},Pt.nativeSourceHandler.handleSource=function(s,e,i){e.setSrc(s.src)},Pt.nativeSourceHandler.dispose=function(){},Pt.registerSourceHandler(Pt.nativeSourceHandler),Zt.registerTech("Html5",Pt);const dh=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],Zd={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},ec=["tiny","xsmall","small","medium","large","xlarge","huge"],$u={};ec.forEach(s=>{const e=s.charAt(0)==="x"?`x-${s.substring(1)}`:s;$u[s]=`vjs-layout-${e}`});const zp={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:Infinity};class ji extends et{constructor(e,i,r){if(e.id=e.id||i.id||`vjs_video_${Xn()}`,i=Object.assign(ji.getTagSettings(e),i),i.initChildren=!1,i.createEl=!1,i.evented=!1,i.reportTouchActivity=!1,!i.language){const h=e.closest("[lang]");h&&(i.language=h.getAttribute("lang"))}super(null,i,r);if(this.boundDocumentFullscreenChange_=h=>this.documentFullscreenChange_(h),this.boundFullWindowOnEscKey_=h=>this.fullWindowOnEscKey(h),this.boundUpdateStyleEl_=h=>this.updateStyleEl_(h),this.boundApplyInitTime_=h=>this.applyInitTime_(h),this.boundUpdateCurrentBreakpoint_=h=>this.updateCurrentBreakpoint_(h),this.boundHandleTechClick_=h=>this.handleTechClick_(h),this.boundHandleTechDoubleClick_=h=>this.handleTechDoubleClick_(h),this.boundHandleTechTouchStart_=h=>this.handleTechTouchStart_(h),this.boundHandleTechTouchMove_=h=>this.handleTechTouchMove_(h),this.boundHandleTechTouchEnd_=h=>this.handleTechTouchEnd_(h),this.boundHandleTechTap_=h=>this.handleTechTap_(h),this.isFullscreen_=!1,this.log=es(this.id_),this.fsApi_=Rr,this.isPosterFromTech_=!1,this.queuedCallbacks_=[],this.isReady_=!1,this.hasStarted_=!1,this.userActive_=!1,this.debugEnabled_=!1,this.audioOnlyMode_=!1,this.audioPosterMode_=!1,this.audioOnlyCache_={playerHeight:null,hiddenChildren:[]},!this.options_||!this.options_.techOrder||!this.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(this.tag=e,this.tagAttributes=e&&_r(e),this.language(this.options_.language),i.languages){const h={};Object.getOwnPropertyNames(i.languages).forEach(function(g){h[g.toLowerCase()]=i.languages[g]}),this.languages_=h}else this.languages_=ji.prototype.options_.languages;this.resetCache_(),this.poster_=i.poster||"",this.controls_=!!i.controls,e.controls=!1,e.removeAttribute("controls"),this.changingSrc_=!1,this.playCallbacks_=[],this.playTerminatedQueue_=[],e.hasAttribute("autoplay")?this.autoplay(!0):this.autoplay(this.options_.autoplay),i.plugins&&Object.keys(i.plugins).forEach(h=>{if(typeof this[h]!="function")throw new Error(`plugin "${h}" does not exist`)}),this.scrubbing_=!1,this.el_=this.createEl(),Bo(this,{eventBusKey:"el_"}),this.fsApi_.requestFullscreen&&(Qn(_e(),this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.on(this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_)),this.fluid_&&this.on(["playerreset","resize"],this.boundUpdateStyleEl_);const o=ci(this.options_);if(i.plugins&&Object.keys(i.plugins).forEach(h=>{this[h](i.plugins[h])}),i.debug&&this.debug(!0),this.options_.playerOptions=o,this.middleware_=[],this.playbackRates(i.playbackRates),i.experimentalSvgIcons){const g=new(ae()).DOMParser().parseFromString(Ud,"image/svg+xml");if(g.querySelector("parsererror"))ri.warn("Failed to load SVG Icons. Falling back to Font Icons."),this.options_.experimentalSvgIcons=null;else{const N=g.documentElement;N.style.display="none",this.el_.appendChild(N),this.addClass("vjs-svg-icons-enabled")}}this.initChildren(),this.isAudio(e.nodeName.toLowerCase()==="audio"),this.controls()?this.addClass("vjs-controls-enabled"):this.addClass("vjs-controls-disabled"),this.el_.setAttribute("role","region"),this.isAudio()?this.el_.setAttribute("aria-label",this.localize("Audio Player")):this.el_.setAttribute("aria-label",this.localize("Video Player")),this.isAudio()&&this.addClass("vjs-audio"),br&&this.addClass("vjs-touch-enabled"),bn||this.addClass("vjs-workinghover"),ji.players[this.id_]=this;const d=la.split(".")[0];this.addClass(`vjs-v${d}`),this.userActive(!0),this.reportUserActivity(),this.one("play",h=>this.listenForUserActivity_(h)),this.on("keydown",h=>this.handleKeyDown(h)),this.on("languagechange",h=>this.handleLanguagechange(h)),this.breakpoints(this.options_.breakpoints),this.responsive(this.options_.responsive),this.on("ready",()=>{this.audioPosterMode(this.options_.audioPosterMode),this.audioOnlyMode(this.options_.audioOnlyMode)})}dispose(){this.trigger("dispose"),this.off("dispose"),pn(_e(),this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),pn(_e(),"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),ji.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),Bu(this),On.names.forEach(e=>{const i=On[e],r=this[i.getterName]();r&&r.off&&r.off()}),super.dispose({restoreEl:this.options_.restoreEl})}createEl(){let e=this.tag,i,r=this.playerElIngest_=e.parentNode&&e.parentNode.hasAttribute&&e.parentNode.hasAttribute("data-vjs-player");const o=this.tag.tagName.toLowerCase()==="video-js";r?i=this.el_=e.parentNode:o||(i=this.el_=super.createEl("div"));const d=_r(e);if(o){for(i=this.el_=e,e=this.tag=_e().createElement("video");i.children.length;)e.appendChild(i.firstChild);Yn(i,"video-js")||Br(i,"video-js"),i.appendChild(e),r=this.playerElIngest_=i,Object.keys(i).forEach(g=>{try{e[g]=i[g]}catch(k){}})}if(e.setAttribute("tabindex","-1"),d.tabindex="-1",An&&fa&&(e.setAttribute("role","application"),d.role="application"),e.removeAttribute("width"),e.removeAttribute("height"),"width"in d&&delete d.width,"height"in d&&delete d.height,Object.getOwnPropertyNames(d).forEach(function(g){o&&g==="class"||i.setAttribute(g,d[g]),o&&e.setAttribute(g,d[g])}),e.playerId=e.id,e.id+="_html5_api",e.className="vjs-tech",e.player=i.player=this,this.addClass("vjs-paused"),ae().VIDEOJS_NO_DYNAMIC_STYLE!==!0){this.styleEl_=fi("vjs-styles-dimensions");const g=He(".vjs-styles-defaults"),k=He("head");k.insertBefore(this.styleEl_,g?g.nextSibling:k.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);const h=e.getElementsByTagName("a");for(let g=0;g<h.length;g++){const k=h.item(g);Br(k,"vjs-hidden"),k.setAttribute("hidden","hidden")}return e.initNetworkState_=e.networkState,e.parentNode&&!r&&e.parentNode.insertBefore(i,e),Es(e,i),this.children_.unshift(e),this.el_.setAttribute("lang",this.language_),this.el_.setAttribute("translate","no"),this.el_=i,i}crossOrigin(e){if(typeof e=="undefined")return this.techGet_("crossOrigin");if(e!==null&&e!=="anonymous"&&e!=="use-credentials"){ri.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${e}"`);return}this.techCall_("setCrossOrigin",e),this.posterImage&&this.posterImage.crossOrigin(e)}width(e){return this.dimension("width",e)}height(e){return this.dimension("height",e)}dimension(e,i){const r=e+"_";if(i===void 0)return this[r]||0;if(i===""||i==="auto"){this[r]=void 0,this.updateStyleEl_();return}const o=parseFloat(i);if(isNaN(o)){ri.error(`Improper value "${i}" supplied for for ${e}`);return}this[r]=o,this.updateStyleEl_()}fluid(e){if(e===void 0)return!!this.fluid_;this.fluid_=!!e,ss(this)&&this.off(["playerreset","resize"],this.boundUpdateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),vu(this,()=>{this.on(["playerreset","resize"],this.boundUpdateStyleEl_)})):this.removeClass("vjs-fluid"),this.updateStyleEl_()}fill(e){if(e===void 0)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")}aspectRatio(e){if(e===void 0)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()}updateStyleEl_(){if(ae().VIDEOJS_NO_DYNAMIC_STYLE===!0){const g=typeof this.width_=="number"?this.width_:this.options_.width,k=typeof this.height_=="number"?this.height_:this.options_.height,N=this.tech_&&this.tech_.el();N&&(g>=0&&(N.width=g),k>=0&&(N.height=k));return}let e,i,r,o;this.aspectRatio_!==void 0&&this.aspectRatio_!=="auto"?r=this.aspectRatio_:this.videoWidth()>0?r=this.videoWidth()+":"+this.videoHeight():r="16:9";const d=r.split(":"),h=d[1]/d[0];this.width_!==void 0?e=this.width_:this.height_!==void 0?e=this.height_/h:e=this.videoWidth()||300,this.height_!==void 0?i=this.height_:i=e*h,/^[^a-zA-Z]/.test(this.id())?o="dimensions-"+this.id():o=this.id()+"-dimensions",this.addClass(o),sr(this.styleEl_,`
      .${o} {
        width: ${e}px;
        height: ${i}px;
      }

      .${o}.vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: ${h*100}%;
      }
    `)}loadTech_(e,i){this.tech_&&this.unloadTech_();const r=Gi(e),o=e.charAt(0).toLowerCase()+e.slice(1);r!=="Html5"&&this.tag&&(Zt.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=r,this.isReady_=!1;let d=this.autoplay();(typeof this.autoplay()=="string"||this.autoplay()===!0&&this.options_.normalizeAutoplay)&&(d=!1);const h={source:i,autoplay:d,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:`${this.id()}_${o}_api`,playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};On.names.forEach(k=>{const N=On[k];h[N.getterName]=this[N.privateName]}),Object.assign(h,this.options_[r]),Object.assign(h,this.options_[o]),Object.assign(h,this.options_[e.toLowerCase()]),this.tag&&(h.tag=this.tag),i&&i.src===this.cache_.src&&this.cache_.currentTime>0&&(h.startTime=this.cache_.currentTime);const g=Zt.getTech(e);if(!g)throw new Error(`No Tech named '${r}' exists! '${r}' should be registered using videojs.registerTech()'`);this.tech_=new g(h),this.tech_.ready(gi(this,this.handleTechReady_),!0),wu.jsonToTextTracks(this.textTracksJson_||[],this.tech_),dh.forEach(k=>{this.on(this.tech_,k,N=>this[`handleTech${Gi(k)}_`](N))}),Object.keys(Zd).forEach(k=>{this.on(this.tech_,k,N=>{if(this.tech_.playbackRate()===0&&this.tech_.seeking()){this.queuedCallbacks_.push({callback:this[`handleTech${Zd[k]}_`].bind(this),event:N});return}this[`handleTech${Zd[k]}_`](N)})}),this.on(this.tech_,"loadstart",k=>this.handleTechLoadStart_(k)),this.on(this.tech_,"sourceset",k=>this.handleTechSourceset_(k)),this.on(this.tech_,"waiting",k=>this.handleTechWaiting_(k)),this.on(this.tech_,"ended",k=>this.handleTechEnded_(k)),this.on(this.tech_,"seeking",k=>this.handleTechSeeking_(k)),this.on(this.tech_,"play",k=>this.handleTechPlay_(k)),this.on(this.tech_,"pause",k=>this.handleTechPause_(k)),this.on(this.tech_,"durationchange",k=>this.handleTechDurationChange_(k)),this.on(this.tech_,"fullscreenchange",(k,N)=>this.handleTechFullscreenChange_(k,N)),this.on(this.tech_,"fullscreenerror",(k,N)=>this.handleTechFullscreenError_(k,N)),this.on(this.tech_,"enterpictureinpicture",k=>this.handleTechEnterPictureInPicture_(k)),this.on(this.tech_,"leavepictureinpicture",k=>this.handleTechLeavePictureInPicture_(k)),this.on(this.tech_,"error",k=>this.handleTechError_(k)),this.on(this.tech_,"posterchange",k=>this.handleTechPosterChange_(k)),this.on(this.tech_,"textdata",k=>this.handleTechTextData_(k)),this.on(this.tech_,"ratechange",k=>this.handleTechRateChange_(k)),this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode!==this.el()&&(r!=="Html5"||!this.tag)&&Es(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)}unloadTech_(){On.names.forEach(e=>{const i=On[e];this[i.privateName]=this[i.getterName]()}),this.textTracksJson_=wu.textTracksToJson(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1}tech(e){return e===void 0&&ri.warn(`Using the tech directly can be dangerous. I hope you know what you're doing.
See https://github.com/videojs/video.js/issues/2617 for more info.
`),this.tech_}addTechControlsListeners_(){this.removeTechControlsListeners_(),this.on(this.tech_,"click",this.boundHandleTechClick_),this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_),this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.on(this.tech_,"tap",this.boundHandleTechTap_)}removeTechControlsListeners_(){this.off(this.tech_,"tap",this.boundHandleTechTap_),this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.off(this.tech_,"click",this.boundHandleTechClick_),this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)}handleTechReady_(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()}handleTechLoadStart_(){this.removeClass("vjs-ended","vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):this.trigger("loadstart"),this.manualAutoplay_(this.autoplay()===!0&&this.options_.normalizeAutoplay?"play":this.autoplay())}manualAutoplay_(e){if(!this.tech_||typeof e!="string")return;const i=()=>{const o=this.muted();this.muted(!0);const d=()=>{this.muted(o)};this.playTerminatedQueue_.push(d);const h=this.play();if(!!$r(h))return h.catch(g=>{throw d(),new Error(`Rejection at manualAutoplay. Restoring muted value. ${g||""}`)})};let r;if(e==="any"&&!this.muted()?(r=this.play(),$r(r)&&(r=r.catch(i))):e==="muted"&&!this.muted()?r=i():r=this.play(),!!$r(r))return r.then(()=>{this.trigger({type:"autoplay-success",autoplay:e})}).catch(()=>{this.trigger({type:"autoplay-failure",autoplay:e})})}updateSourceCaches_(e=""){let i=e,r="";typeof i!="string"&&(i=e.src,r=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],i&&!r&&(r=Nd(this,i)),this.cache_.source=ci({},e,{src:i,type:r});const o=this.cache_.sources.filter(k=>k.src&&k.src===i),d=[],h=this.$$("source"),g=[];for(let k=0;k<h.length;k++){const N=_r(h[k]);d.push(N),N.src&&N.src===i&&g.push(N.src)}g.length&&!o.length?this.cache_.sources=d:o.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=i}handleTechSourceset_(e){if(!this.changingSrc_){let i=d=>this.updateSourceCaches_(d);const r=this.currentSource().src,o=e.src;r&&!/^blob:/.test(r)&&/^blob:/.test(o)&&(!this.lastSource_||this.lastSource_.tech!==o&&this.lastSource_.player!==r)&&(i=()=>{}),i(o),e.src||this.tech_.any(["sourceset","loadstart"],d=>{if(d.type==="sourceset")return;const h=this.techGet_("currentSrc");this.lastSource_.tech=h,this.updateSourceCaches_(h)})}this.lastSource_={player:this.currentSource().src,tech:e.src},this.trigger({src:e.src,type:"sourceset"})}hasStarted(e){if(e===void 0)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?this.addClass("vjs-has-started"):this.removeClass("vjs-has-started"))}handleTechPlay_(){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")}handleTechRateChange_(){this.tech_.playbackRate()>0&&this.cache_.lastPlaybackRate===0&&(this.queuedCallbacks_.forEach(e=>e.callback(e.event)),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")}handleTechWaiting_(){this.addClass("vjs-waiting"),this.trigger("waiting");const e=this.currentTime(),i=()=>{e!==this.currentTime()&&(this.removeClass("vjs-waiting"),this.off("timeupdate",i))};this.on("timeupdate",i)}handleTechCanPlay_(){this.removeClass("vjs-waiting"),this.trigger("canplay")}handleTechCanPlayThrough_(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")}handleTechPlaying_(){this.removeClass("vjs-waiting"),this.trigger("playing")}handleTechSeeking_(){this.addClass("vjs-seeking"),this.trigger("seeking")}handleTechSeeked_(){this.removeClass("vjs-seeking","vjs-ended"),this.trigger("seeked")}handleTechPause_(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")}handleTechEnded_(){this.addClass("vjs-ended"),this.removeClass("vjs-waiting"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")}handleTechDurationChange_(){this.duration(this.techGet_("duration"))}handleTechClick_(e){!this.controls_||(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.click===void 0||this.options_.userActions.click!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.click=="function"?this.options_.userActions.click.call(this,e):this.paused()?xr(this.play()):this.pause())}handleTechDoubleClick_(e){if(!this.controls_)return;Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),r=>r.contains(e.target))||(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.doubleClick===void 0||this.options_.userActions.doubleClick!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.doubleClick=="function"?this.options_.userActions.doubleClick.call(this,e):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen())}handleTechTap_(){this.userActive(!this.userActive())}handleTechTouchStart_(){this.userWasActive=this.userActive()}handleTechTouchMove_(){this.userWasActive&&this.reportUserActivity()}handleTechTouchEnd_(e){e.cancelable&&e.preventDefault()}toggleFullscreenClass_(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")}documentFullscreenChange_(e){const i=e.target.player;if(i&&i!==this)return;const r=this.el();let o=_e()[this.fsApi_.fullscreenElement]===r;!o&&r.matches&&(o=r.matches(":"+this.fsApi_.fullscreen)),this.isFullscreen(o)}handleTechFullscreenChange_(e,i){i&&(i.nativeIOSFullscreen&&(this.addClass("vjs-ios-native-fs"),this.tech_.one("webkitendfullscreen",()=>{this.removeClass("vjs-ios-native-fs")})),this.isFullscreen(i.isFullscreen))}handleTechFullscreenError_(e,i){this.trigger("fullscreenerror",i)}togglePictureInPictureClass_(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")}handleTechEnterPictureInPicture_(e){this.isInPictureInPicture(!0)}handleTechLeavePictureInPicture_(e){this.isInPictureInPicture(!1)}handleTechError_(){const e=this.tech_.error();e&&this.error(e)}handleTechTextData_(){let e=null;arguments.length>1&&(e=arguments[1]),this.trigger("textdata",e)}getCache(){return this.cache_}resetCache_(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}}techCall_(e,i){this.ready(function(){if(e in Md)return lr(this.middleware_,this.tech_,e,i);if(e in us)return Pu(this.middleware_,this.tech_,e,i);try{this.tech_&&this.tech_[e](i)}catch(r){throw ri(r),r}},!0)}techGet_(e){if(!(!this.tech_||!this.tech_.isReady_)){if(e in Hn)return Ea(this.middleware_,this.tech_,e);if(e in us)return Pu(this.middleware_,this.tech_,e);try{return this.tech_[e]()}catch(i){throw this.tech_[e]===void 0?(ri(`Video.js: ${e} method not defined for ${this.techName_} playback technology.`,i),i):i.name==="TypeError"?(ri(`Video.js: ${e} unavailable on ${this.techName_} playback technology element.`,i),this.tech_.isReady_=!1,i):(ri(i),i)}}}play(){return new Promise(e=>{this.play_(e)})}play_(e=xr){this.playCallbacks_.push(e);const i=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc())),r=Boolean(Gs||bn);if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!i){this.waitToPlay_=h=>{this.play_()},this.one(["ready","loadstart"],this.waitToPlay_),!i&&r&&this.load();return}const o=this.techGet_("play");r&&this.hasClass("vjs-ended")&&this.resetProgressBar_(),o===null?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(o)}runPlayTerminatedQueue_(){const e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],e.forEach(function(i){i()})}runPlayCallbacks_(e){const i=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],i.forEach(function(r){r(e)})}pause(){this.techCall_("pause")}paused(){return this.techGet_("paused")!==!1}played(){return this.techGet_("played")||jr(0,0)}scrubbing(e){if(typeof e=="undefined")return this.scrubbing_;this.scrubbing_=!!e,this.techCall_("setScrubbing",this.scrubbing_),e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")}currentTime(e){if(e===void 0)return this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime;if(e<0&&(e=0),!this.isReady_||this.changingSrc_||!this.tech_||!this.tech_.isReady_){this.cache_.initTime=e,this.off("canplay",this.boundApplyInitTime_),this.one("canplay",this.boundApplyInitTime_);return}this.techCall_("setCurrentTime",e),this.cache_.initTime=0,isFinite(e)&&(this.cache_.currentTime=Number(e))}applyInitTime_(){this.currentTime(this.cache_.initTime)}duration(e){if(e===void 0)return this.cache_.duration!==void 0?this.cache_.duration:NaN;e=parseFloat(e),e<0&&(e=Infinity),e!==this.cache_.duration&&(this.cache_.duration=e,e===Infinity?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(e)||this.trigger("durationchange"))}remainingTime(){return this.duration()-this.currentTime()}remainingTimeDisplay(){return Math.floor(this.duration())-Math.floor(this.currentTime())}buffered(){let e=this.techGet_("buffered");return(!e||!e.length)&&(e=jr(0,0)),e}bufferedPercent(){return Ol(this.buffered(),this.duration())}bufferedEnd(){const e=this.buffered(),i=this.duration();let r=e.end(e.length-1);return r>i&&(r=i),r}volume(e){let i;if(e!==void 0){i=Math.max(0,Math.min(1,e)),this.cache_.volume=i,this.techCall_("setVolume",i),i>0&&this.lastVolume_(i);return}return i=parseFloat(this.techGet_("volume")),isNaN(i)?1:i}muted(e){if(e!==void 0){this.techCall_("setMuted",e);return}return this.techGet_("muted")||!1}defaultMuted(e){return e!==void 0&&this.techCall_("setDefaultMuted",e),this.techGet_("defaultMuted")||!1}lastVolume_(e){if(e!==void 0&&e!==0){this.cache_.lastVolume=e;return}return this.cache_.lastVolume}supportsFullScreen(){return this.techGet_("supportsFullScreen")||!1}isFullscreen(e){if(e!==void 0){const i=this.isFullscreen_;this.isFullscreen_=Boolean(e),this.isFullscreen_!==i&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),this.toggleFullscreenClass_();return}return this.isFullscreen_}requestFullscreen(e){this.isInPictureInPicture()&&this.exitPictureInPicture();const i=this;return new Promise((r,o)=>{function d(){i.off("fullscreenerror",g),i.off("fullscreenchange",h)}function h(){d(),r()}function g(N,Y){d(),o(Y)}i.one("fullscreenchange",h),i.one("fullscreenerror",g);const k=i.requestFullscreenHelper_(e);k&&(k.then(d,d),k.then(r,o))})}requestFullscreenHelper_(e){let i;if(this.fsApi_.prefixed||(i=this.options_.fullscreen&&this.options_.fullscreen.options||{},e!==void 0&&(i=e)),this.fsApi_.requestFullscreen){const r=this.el_[this.fsApi_.requestFullscreen](i);return r&&r.then(()=>this.isFullscreen(!0),()=>this.isFullscreen(!1)),r}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("enterFullScreen"):this.enterFullWindow()}exitFullscreen(){const e=this;return new Promise((i,r)=>{function o(){e.off("fullscreenerror",h),e.off("fullscreenchange",d)}function d(){o(),i()}function h(k,N){o(),r(N)}e.one("fullscreenchange",d),e.one("fullscreenerror",h);const g=e.exitFullscreenHelper_();g&&(g.then(o,o),g.then(i,r))})}exitFullscreenHelper_(){if(this.fsApi_.requestFullscreen){const e=_e()[this.fsApi_.exitFullscreen]();return e&&xr(e.then(()=>this.isFullscreen(!1))),e}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("exitFullScreen"):this.exitFullWindow()}enterFullWindow(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=_e().documentElement.style.overflow,Qn(_e(),"keydown",this.boundFullWindowOnEscKey_),_e().documentElement.style.overflow="hidden",Br(_e().body,"vjs-full-window"),this.trigger("enterFullWindow")}fullWindowOnEscKey(e){fe().isEventKey(e,"Esc")&&this.isFullscreen()===!0&&(this.isFullWindow?this.exitFullWindow():this.exitFullscreen())}exitFullWindow(){this.isFullscreen(!1),this.isFullWindow=!1,pn(_e(),"keydown",this.boundFullWindowOnEscKey_),_e().documentElement.style.overflow=this.docOrigOverflow,ga(_e().body,"vjs-full-window"),this.trigger("exitFullWindow")}disablePictureInPicture(e){if(e===void 0)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",e),this.options_.disablePictureInPicture=e,this.trigger("disablepictureinpicturechanged")}isInPictureInPicture(e){if(e!==void 0){this.isInPictureInPicture_=!!e,this.togglePictureInPictureClass_();return}return!!this.isInPictureInPicture_}requestPictureInPicture(){if(this.options_.enableDocumentPictureInPicture&&ae().documentPictureInPicture){const e=_e().createElement(this.el().tagName);return e.classList=this.el().classList,e.classList.add("vjs-pip-container"),this.posterImage&&e.appendChild(this.posterImage.el().cloneNode(!0)),this.titleBar&&e.appendChild(this.titleBar.el().cloneNode(!0)),e.appendChild($t("p",{className:"vjs-pip-text"},{},this.localize("Playing in picture-in-picture"))),ae().documentPictureInPicture.requestWindow({width:this.videoWidth(),height:this.videoHeight()}).then(i=>(Dt(i),this.el_.parentNode.insertBefore(e,this.el_),i.document.body.appendChild(this.el_),i.document.body.classList.add("vjs-pip-window"),this.player_.isInPictureInPicture(!0),this.player_.trigger("enterpictureinpicture"),i.addEventListener("pagehide",r=>{const o=r.target.querySelector(".video-js");e.parentNode.replaceChild(o,e),this.player_.isInPictureInPicture(!1),this.player_.trigger("leavepictureinpicture")}),i))}return"pictureInPictureEnabled"in _e()&&this.disablePictureInPicture()===!1?this.techGet_("requestPictureInPicture"):Promise.reject("No PiP mode is available")}exitPictureInPicture(){if(ae().documentPictureInPicture&&ae().documentPictureInPicture.window)return ae().documentPictureInPicture.window.close(),Promise.resolve();if("pictureInPictureEnabled"in _e())return _e().exitPictureInPicture()}handleKeyDown(e){const{userActions:i}=this.options_;!i||!i.hotkeys||(o=>{const d=o.tagName.toLowerCase();if(o.isContentEditable)return!0;const h=["button","checkbox","hidden","radio","reset","submit"];return d==="input"?h.indexOf(o.type)===-1:["textarea"].indexOf(d)!==-1})(this.el_.ownerDocument.activeElement)||(typeof i.hotkeys=="function"?i.hotkeys.call(this,e):this.handleHotkeys(e))}handleHotkeys(e){const i=this.options_.userActions?this.options_.userActions.hotkeys:{},{fullscreenKey:r=h=>fe().isEventKey(h,"f"),muteKey:o=h=>fe().isEventKey(h,"m"),playPauseKey:d=h=>fe().isEventKey(h,"k")||fe().isEventKey(h,"Space")}=i;if(r.call(this,e)){e.preventDefault(),e.stopPropagation();const h=et.getComponent("FullscreenToggle");_e()[this.fsApi_.fullscreenEnabled]!==!1&&h.prototype.handleClick.call(this,e)}else o.call(this,e)?(e.preventDefault(),e.stopPropagation(),et.getComponent("MuteToggle").prototype.handleClick.call(this,e)):d.call(this,e)&&(e.preventDefault(),e.stopPropagation(),et.getComponent("PlayToggle").prototype.handleClick.call(this,e))}canPlayType(e){let i;for(let r=0,o=this.options_.techOrder;r<o.length;r++){const d=o[r];let h=Zt.getTech(d);if(h||(h=et.getComponent(d)),!h){ri.error(`The "${d}" tech is undefined. Skipped browser support check for that tech.`);continue}if(h.isSupported()&&(i=h.canPlayType(e),i))return i}return""}selectSource(e){const i=this.options_.techOrder.map(g=>[g,Zt.getTech(g)]).filter(([g,k])=>k?k.isSupported():(ri.error(`The "${g}" tech is undefined. Skipped browser support check for that tech.`),!1)),r=function(g,k,N){let Y;return g.some(me=>k.some(Ie=>{if(Y=N(me,Ie),Y)return!0})),Y};let o;const d=g=>(k,N)=>g(N,k),h=([g,k],N)=>{if(k.canPlaySource(N,this.options_[g.toLowerCase()]))return{source:N,tech:g}};return this.options_.sourceOrder?o=r(e,i,d(h)):o=r(i,e,h),o||!1}handleSrc_(e,i){if(typeof e=="undefined")return this.cache_.src||"";this.resetRetryOnError_&&this.resetRetryOnError_();const r=Gl(e);if(!r.length){this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0);return}if(this.changingSrc_=!0,i||(this.cache_.sources=r),this.updateSourceCaches_(r[0]),Bd(this,r[0],(o,d)=>{if(this.middleware_=d,i||(this.cache_.sources=r),this.updateSourceCaches_(o),this.src_(o)){if(r.length>1)return this.handleSrc_(r.slice(1));this.changingSrc_=!1,this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0),this.triggerReady();return}Vo(d,this.tech_)}),r.length>1){const o=()=>{this.error(null),this.handleSrc_(r.slice(1),!0)},d=()=>{this.off("error",o)};this.one("error",o),this.one("playing",d),this.resetRetryOnError_=()=>{this.off("error",o),this.off("playing",d)}}}src(e){return this.handleSrc_(e,!1)}src_(e){const i=this.selectSource([e]);return i?or(i.tech,this.techName_)?(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1},!0),!1):(this.changingSrc_=!0,this.loadTech_(i.tech,i.source),this.tech_.ready(()=>{this.changingSrc_=!1}),!1):!0}load(){if(this.tech_&&this.tech_.vhs){this.src(this.currentSource());return}this.techCall_("load")}reset(){if(this.paused())this.doReset_();else{const e=this.play();xr(e.then(()=>this.doReset_()))}}doReset_(){this.tech_&&this.tech_.clearTracks("text"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),ss(this)&&this.trigger("playerreset")}resetControlBarUI_(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()}resetProgressBar_(){this.currentTime(0);const{currentTimeDisplay:e,durationDisplay:i,progressControl:r,remainingTimeDisplay:o}=this.controlBar||{},{seekBar:d}=r||{};e&&e.updateContent(),i&&i.updateContent(),o&&o.updateContent(),d&&(d.update(),d.loadProgressBar&&d.loadProgressBar.update())}resetPlaybackRate_(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()}resetVolumeBar_(){this.volume(1),this.trigger("volumechange")}currentSources(){const e=this.currentSource(),i=[];return Object.keys(e).length!==0&&i.push(e),this.cache_.sources||i}currentSource(){return this.cache_.source||{}}currentSrc(){return this.currentSource()&&this.currentSource().src||""}currentType(){return this.currentSource()&&this.currentSource().type||""}preload(e){if(e!==void 0){this.techCall_("setPreload",e),this.options_.preload=e;return}return this.techGet_("preload")}autoplay(e){if(e===void 0)return this.options_.autoplay||!1;let i;typeof e=="string"&&/(any|play|muted)/.test(e)||e===!0&&this.options_.normalizeAutoplay?(this.options_.autoplay=e,this.manualAutoplay_(typeof e=="string"?e:"play"),i=!1):e?this.options_.autoplay=!0:this.options_.autoplay=!1,i=typeof i=="undefined"?this.options_.autoplay:i,this.tech_&&this.techCall_("setAutoplay",i)}playsinline(e){return e!==void 0&&(this.techCall_("setPlaysinline",e),this.options_.playsinline=e),this.techGet_("playsinline")}loop(e){if(e!==void 0){this.techCall_("setLoop",e),this.options_.loop=e;return}return this.techGet_("loop")}poster(e){if(e===void 0)return this.poster_;e||(e=""),e!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))}handleTechPosterChange_(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){const e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}}controls(e){if(e===void 0)return!!this.controls_;e=!!e,this.controls_!==e&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))}usingNativeControls(e){if(e===void 0)return!!this.usingNativeControls_;e=!!e,this.usingNativeControls_!==e&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))}error(e){if(e===void 0)return this.error_||null;if(Vn("beforeerror").forEach(i=>{const r=i(this,e);if(!(nr(r)&&!Array.isArray(r)||typeof r=="string"||typeof r=="number"||r===null)){this.log.error("please return a value that MediaError expects in beforeerror hooks");return}e=r}),this.options_.suppressNotSupportedError&&e&&e.code===4){const i=function(){this.error(e)};this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],i),this.one("loadstart",function(){this.off(["click","touchstart"],i)});return}if(e===null){this.error_=null,this.removeClass("vjs-error"),this.errorDisplay&&this.errorDisplay.close();return}this.error_=new Cn(e),this.addClass("vjs-error"),ri.error(`(CODE:${this.error_.code} ${Cn.errorTypes[this.error_.code]})`,this.error_.message,this.error_),this.trigger("error"),Vn("error").forEach(i=>i(this,this.error_))}reportUserActivity(e){this.userActivity_=!0}userActive(e){if(e===void 0)return this.userActive_;if(e=!!e,e!==this.userActive_){if(this.userActive_=e,this.userActive_){this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive");return}this.tech_&&this.tech_.one("mousemove",function(i){i.stopPropagation(),i.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}}listenForUserActivity_(){let e,i,r;const o=gi(this,this.reportUserActivity),d=function(me){(me.screenX!==i||me.screenY!==r)&&(i=me.screenX,r=me.screenY,o())},h=function(){o(),this.clearInterval(e),e=this.setInterval(o,250)},g=function(me){o(),this.clearInterval(e)};this.on("mousedown",h),this.on("mousemove",d),this.on("mouseup",g),this.on("mouseleave",g);const k=this.getChild("controlBar");k&&!bn&&!on&&(k.on("mouseenter",function(me){this.player().options_.inactivityTimeout!==0&&(this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout),this.player().options_.inactivityTimeout=0}),k.on("mouseleave",function(me){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",o),this.on("keyup",o);let N;const Y=function(){if(!this.userActivity_)return;this.userActivity_=!1,this.userActive(!0),this.clearTimeout(N);const me=this.options_.inactivityTimeout;me<=0||(N=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},me))};this.setInterval(Y,250)}playbackRate(e){if(e!==void 0){this.techCall_("setPlaybackRate",e);return}return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1}defaultPlaybackRate(e){return e!==void 0?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1}isAudio(e){if(e!==void 0){this.isAudio_=!!e;return}return!!this.isAudio_}enableAudioOnlyUI_(){this.addClass("vjs-audio-only-mode");const e=this.children(),i=this.getChild("ControlBar"),r=i&&i.currentHeight();e.forEach(o=>{o!==i&&o.el_&&!o.hasClass("vjs-hidden")&&(o.hide(),this.audioOnlyCache_.hiddenChildren.push(o))}),this.audioOnlyCache_.playerHeight=this.currentHeight(),this.height(r),this.trigger("audioonlymodechange")}disableAudioOnlyUI_(){this.removeClass("vjs-audio-only-mode"),this.audioOnlyCache_.hiddenChildren.forEach(e=>e.show()),this.height(this.audioOnlyCache_.playerHeight),this.trigger("audioonlymodechange")}audioOnlyMode(e){if(typeof e!="boolean"||e===this.audioOnlyMode_)return this.audioOnlyMode_;if(this.audioOnlyMode_=e,e){const i=[];return this.isInPictureInPicture()&&i.push(this.exitPictureInPicture()),this.isFullscreen()&&i.push(this.exitFullscreen()),this.audioPosterMode()&&i.push(this.audioPosterMode(!1)),Promise.all(i).then(()=>this.enableAudioOnlyUI_())}return Promise.resolve().then(()=>this.disableAudioOnlyUI_())}enablePosterModeUI_(){(this.tech_&&this.tech_).hide(),this.addClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}disablePosterModeUI_(){(this.tech_&&this.tech_).show(),this.removeClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}audioPosterMode(e){return typeof e!="boolean"||e===this.audioPosterMode_?this.audioPosterMode_:(this.audioPosterMode_=e,e?this.audioOnlyMode()?this.audioOnlyMode(!1).then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.disablePosterModeUI_()}))}addTextTrack(e,i,r){if(this.tech_)return this.tech_.addTextTrack(e,i,r)}addRemoteTextTrack(e,i){if(this.tech_)return this.tech_.addRemoteTextTrack(e,i)}removeRemoteTextTrack(e={}){let{track:i}=e;if(i||(i=e),this.tech_)return this.tech_.removeRemoteTextTrack(i)}getVideoPlaybackQuality(){return this.techGet_("getVideoPlaybackQuality")}videoWidth(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0}videoHeight(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0}language(e){if(e===void 0)return this.language_;this.language_!==String(e).toLowerCase()&&(this.language_=String(e).toLowerCase(),ss(this)&&this.trigger("languagechange"))}languages(){return ci(ji.prototype.options_.languages,this.languages_)}toJSON(){const e=ci(this.options_),i=e.tracks;e.tracks=[];for(let r=0;r<i.length;r++){let o=i[r];o=ci(o),o.player=void 0,e.tracks[r]=o}return e}createModal(e,i){i=i||{},i.content=e||"";const r=new ba(this,i);return this.addChild(r),r.on("dispose",()=>{this.removeChild(r)}),r.open(),r}updateCurrentBreakpoint_(){if(!this.responsive())return;const e=this.currentBreakpoint(),i=this.currentWidth();for(let r=0;r<ec.length;r++){const o=ec[r],d=this.breakpoints_[o];if(i<=d){if(e===o)return;e&&this.removeClass($u[e]),this.addClass($u[o]),this.breakpoint_=o;break}}}removeCurrentBreakpoint_(){const e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)}breakpoints(e){return e===void 0?Object.assign(this.breakpoints_):(this.breakpoint_="",this.breakpoints_=Object.assign({},zp,e),this.updateCurrentBreakpoint_(),Object.assign(this.breakpoints_))}responsive(e){if(e===void 0)return this.responsive_;e=Boolean(e);const i=this.responsive_;if(e!==i)return this.responsive_=e,e?(this.on("playerresize",this.boundUpdateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.boundUpdateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e}currentBreakpoint(){return this.breakpoint_}currentBreakpointClass(){return $u[this.breakpoint_]||""}loadMedia(e,i){if(!e||typeof e!="object")return;const r=this.crossOrigin();this.reset(),this.cache_.media=ci(e);const{artist:o,artwork:d,description:h,poster:g,src:k,textTracks:N,title:Y}=this.cache_.media;!d&&g&&(this.cache_.media.artwork=[{src:g,type:Ho(g)}]),r&&this.crossOrigin(r),k&&this.src(k),g&&this.poster(g),Array.isArray(N)&&N.forEach(me=>this.addRemoteTextTrack(me,!1)),this.titleBar&&this.titleBar.update({title:Y,description:h||o||""}),this.ready(i)}getMedia(){if(!this.cache_.media){const e=this.poster(),i=this.currentSources(),r=Array.prototype.map.call(this.remoteTextTracks(),d=>({kind:d.kind,label:d.label,language:d.language,src:d.src})),o={src:i,textTracks:r};return e&&(o.poster=e,o.artwork=[{src:o.poster,type:Ho(o.poster)}]),o}return ci(this.cache_.media)}static getTagSettings(e){const i={sources:[],tracks:[]},r=_r(e),o=r["data-setup"];if(Yn(e,"vjs-fill")&&(r.fill=!0),Yn(e,"vjs-fluid")&&(r.fluid=!0),o!==null){const[d,h]=ye()(o||"{}");d&&ri.error(d),Object.assign(r,h)}if(Object.assign(i,r),e.hasChildNodes()){const d=e.childNodes;for(let h=0,g=d.length;h<g;h++){const k=d[h],N=k.nodeName.toLowerCase();N==="source"?i.sources.push(_r(k)):N==="track"&&i.tracks.push(_r(k))}}return i}debug(e){if(e===void 0)return this.debugEnabled_;e?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)}playbackRates(e){if(e===void 0)return this.cache_.playbackRates;!Array.isArray(e)||!e.every(i=>typeof i=="number")||(this.cache_.playbackRates=e,this.trigger("playbackrateschange"))}}On.names.forEach(function(s){const e=On[s];ji.prototype[e.getterName]=function(){return this.tech_?this.tech_[e.getterName]():(this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName])}}),ji.prototype.crossorigin=ji.prototype.crossOrigin,ji.players={};const zl=ae().navigator;ji.prototype.options_={techOrder:Zt.defaultTechOrder_,html5:{},enableSourceset:!0,inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","titleBar","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:zl&&(zl.languages&&zl.languages[0]||zl.userLanguage||zl.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",normalizeAutoplay:!1,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1,audioOnlyMode:!1,audioPosterMode:!1},["ended","seeking","seekable","networkState","readyState"].forEach(function(s){ji.prototype[s]=function(){return this.techGet_(s)}}),dh.forEach(function(s){ji.prototype[`handleTech${Gi(s)}_`]=function(){return this.trigger(s)}}),et.registerComponent("Player",ji);const Vu="plugin",qo="activePlugins_",Wo={},Hu=s=>Wo.hasOwnProperty(s),Gu=s=>Hu(s)?Wo[s]:void 0,ch=(s,e)=>{s[qo]=s[qo]||{},s[qo][e]=!0},qu=(s,e,i)=>{const r=(i?"before":"")+"pluginsetup";s.trigger(r,e),s.trigger(r+":"+e.name,e)},Yp=function(s,e){const i=function(){qu(this,{name:s,plugin:e,instance:null},!0);const r=e.apply(this,arguments);return ch(this,s),qu(this,{name:s,plugin:e,instance:r}),r};return Object.keys(e).forEach(function(r){i[r]=e[r]}),i},hh=(s,e)=>(e.prototype.name=s,function(...i){qu(this,{name:s,plugin:e,instance:null},!0);const r=new e(...[this,...i]);return this[s]=()=>r,qu(this,r.getEventHash()),r});class cr{constructor(e){if(this.constructor===cr)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=e,this.log||(this.log=this.player.log.createLogger(this.name)),Bo(this),delete this.trigger,xu(this,this.constructor.defaultState),ch(e,this.name),this.dispose=this.dispose.bind(this),e.on("dispose",this.dispose)}version(){return this.constructor.VERSION}getEventHash(e={}){return e.name=this.name,e.plugin=this.constructor,e.instance=this,e}trigger(e,i={}){return va(this.eventBusEl_,e,this.getEventHash(i))}handleStateChanged(e){}dispose(){const{name:e,player:i}=this;this.trigger("dispose"),this.off(),i.off("dispose",this.dispose),i[qo][e]=!1,this.player=this.state=null,i[e]=hh(e,Wo[e])}static isBasic(e){const i=typeof e=="string"?Gu(e):e;return typeof i=="function"&&!cr.prototype.isPrototypeOf(i.prototype)}static registerPlugin(e,i){if(typeof e!="string")throw new Error(`Illegal plugin name, "${e}", must be a string, was ${typeof e}.`);if(Hu(e))ri.warn(`A plugin named "${e}" already exists. You may want to avoid re-registering plugins!`);else if(ji.prototype.hasOwnProperty(e))throw new Error(`Illegal plugin name, "${e}", cannot share a name with an existing player method!`);if(typeof i!="function")throw new Error(`Illegal plugin for "${e}", must be a function, was ${typeof i}.`);return Wo[e]=i,e!==Vu&&(cr.isBasic(i)?ji.prototype[e]=Yp(e,i):ji.prototype[e]=hh(e,i)),i}static deregisterPlugin(e){if(e===Vu)throw new Error("Cannot de-register base plugin.");Hu(e)&&(delete Wo[e],delete ji.prototype[e])}static getPlugins(e=Object.keys(Wo)){let i;return e.forEach(r=>{const o=Gu(r);o&&(i=i||{},i[r]=o)}),i}static getPluginVersion(e){const i=Gu(e);return i&&i.VERSION||""}}cr.getPlugin=Gu,cr.BASE_PLUGIN_NAME=Vu,cr.registerPlugin(Vu,cr),ji.prototype.usingPlugin=function(s){return!!this[qo]&&this[qo][s]===!0},ji.prototype.hasPlugin=function(s){return!!Hu(s)};function Xp(s,e){let i=!1;return function(...r){return i||ri.warn(s),i=!0,e.apply(this,r)}}function ds(s,e,i,r){return Xp(`${e} is deprecated and will be removed in ${s}.0; please use ${i} instead.`,r)}const fh=s=>s.indexOf("#")===0?s.slice(1):s;function ze(s,e,i){let r=ze.getPlayer(s);if(r)return e&&ri.warn(`Player "${s}" is already initialised. Options will not be applied.`),i&&r.ready(i),r;const o=typeof s=="string"?He("#"+fh(s)):s;if(!rr(o))throw new TypeError("The element or ID supplied is not valid. (videojs)");const h=("getRootNode"in o?o.getRootNode()instanceof ae().ShadowRoot:!1)?o.getRootNode():o.ownerDocument.body;(!o.ownerDocument.defaultView||!h.contains(o))&&ri.warn("The element supplied is not included in the DOM"),e=e||{},e.restoreEl===!0&&(e.restoreEl=(o.parentNode&&o.parentNode.hasAttribute("data-vjs-player")?o.parentNode:o).cloneNode(!0)),Vn("beforesetup").forEach(k=>{const N=k(o,ci(e));if(!nr(N)||Array.isArray(N)){ri.error("please return an object in beforesetup hooks");return}e=ci(e,N)});const g=et.getComponent("Player");return r=new g(o,e,i),Vn("setup").forEach(k=>k(r)),r}if(ze.hooks_=Ar,ze.hooks=Vn,ze.hook=xl,ze.hookOnce=El,ze.removeHook=Va,ae().VIDEOJS_NO_DYNAMIC_STYLE!==!0&&xs()){let s=He(".vjs-styles-defaults");if(!s){s=fi("vjs-styles-defaults");const e=He("head");e&&e.insertBefore(s,e.firstChild),sr(s,`
      .video-js {
        width: 300px;
        height: 150px;
      }

      .vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: 56.25%
      }
    `)}}Fi(1,ze),ze.VERSION=la,ze.options=ji.prototype.options_,ze.getPlayers=()=>ji.players,ze.getPlayer=s=>{const e=ji.players;let i;if(typeof s=="string"){const r=fh(s),o=e[r];if(o)return o;i=He("#"+r)}else i=s;if(rr(i)){const{player:r,playerId:o}=i;if(r||e[o])return r||e[o]}},ze.getAllPlayers=()=>Object.keys(ji.players).map(s=>ji.players[s]).filter(Boolean),ze.players=ji.players,ze.getComponent=et.getComponent,ze.registerComponent=(s,e)=>(Zt.isTech(e)&&ri.warn(`The ${s} tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)`),et.registerComponent.call(et,s,e)),ze.getTech=Zt.getTech,ze.registerTech=Zt.registerTech,ze.use=Vl,Object.defineProperty(ze,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(ze.middleware,"TERMINATOR",{value:Xa,writeable:!1,enumerable:!0}),ze.browser=_s,ze.obj=wo,ze.mergeOptions=ds(9,"videojs.mergeOptions","videojs.obj.merge",ci),ze.defineLazyProperty=ds(9,"videojs.defineLazyProperty","videojs.obj.defineLazyProperty",da),ze.bind=ds(9,"videojs.bind","native Function.prototype.bind",gi),ze.registerPlugin=cr.registerPlugin,ze.deregisterPlugin=cr.deregisterPlugin,ze.plugin=(s,e)=>(ri.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),cr.registerPlugin(s,e)),ze.getPlugins=cr.getPlugins,ze.getPlugin=cr.getPlugin,ze.getPluginVersion=cr.getPluginVersion,ze.addLanguage=function(s,e){return s=(""+s).toLowerCase(),ze.options.languages=ci(ze.options.languages,{[s]:e}),ze.options.languages[s]},ze.log=ri,ze.createLogger=es,ze.time=Rl,ze.createTimeRange=ds(9,"videojs.createTimeRange","videojs.time.createTimeRanges",jr),ze.createTimeRanges=ds(9,"videojs.createTimeRanges","videojs.time.createTimeRanges",jr),ze.formatTime=ds(9,"videojs.formatTime","videojs.time.formatTime",qs),ze.setFormatTime=ds(9,"videojs.setFormatTime","videojs.time.setFormatTime",Il),ze.resetFormatTime=ds(9,"videojs.resetFormatTime","videojs.time.resetFormatTime",Su),ze.parseUrl=ds(9,"videojs.parseUrl","videojs.url.parseUrl",Ya),ze.isCrossOrigin=ds(9,"videojs.isCrossOrigin","videojs.url.isCrossOrigin",jo),ze.EventTarget=Jn,ze.any=wl,ze.on=Qn,ze.one=Oo,ze.off=pn,ze.trigger=va,ze.xhr=te(),ze.TextTrack=xa,ze.AudioTrack=jl,ze.VideoTrack=Ou,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(s=>{ze[s]=function(){return ri.warn(`videojs.${s}() is deprecated; use videojs.dom.${s}() instead`),Et[s].apply(null,arguments)}}),ze.computedStyle=ds(9,"videojs.computedStyle","videojs.dom.computedStyle",At),ze.dom=Et,ze.fn=yu,ze.num=O,ze.str=os,ze.url=Iu;/*! @name videojs-contrib-quality-levels @version 4.0.0 @license Apache-2.0 */class Qp{constructor(e){let i=this;return i.id=e.id,i.label=i.id,i.width=e.width,i.height=e.height,i.bitrate=e.bandwidth,i.frameRate=e.frameRate,i.enabled_=e.enabled,Object.defineProperty(i,"enabled",{get(){return i.enabled_()},set(r){i.enabled_(r)}}),i}}class Wu extends ze.EventTarget{constructor(){super();let e=this;return e.levels_=[],e.selectedIndex_=-1,Object.defineProperty(e,"selectedIndex",{get(){return e.selectedIndex_}}),Object.defineProperty(e,"length",{get(){return e.levels_.length}}),e[Symbol.iterator]=()=>e.levels_.values(),e}addQualityLevel(e){let i=this.getQualityLevelById(e.id);if(i)return i;const r=this.levels_.length;return i=new Qp(e),""+r in this||Object.defineProperty(this,r,{get(){return this.levels_[r]}}),this.levels_.push(i),this.trigger({qualityLevel:i,type:"addqualitylevel"}),i}removeQualityLevel(e){let i=null;for(let r=0,o=this.length;r<o;r++)if(this[r]===e){i=this.levels_.splice(r,1)[0],this.selectedIndex_===r?this.selectedIndex_=-1:this.selectedIndex_>r&&this.selectedIndex_--;break}return i&&this.trigger({qualityLevel:e,type:"removequalitylevel"}),i}getQualityLevelById(e){for(let i=0,r=this.length;i<r;i++){const o=this[i];if(o.id===e)return o}return null}dispose(){this.selectedIndex_=-1,this.levels_.length=0}}Wu.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"};for(const s in Wu.prototype.allowedEvents_)Wu.prototype["on"+s]=null;var ph="4.0.0";const Jp=function(s,e){const i=s.qualityLevels,r=new Wu,o=function(){r.dispose(),s.qualityLevels=i,s.off("dispose",o)};return s.on("dispose",o),s.qualityLevels=()=>r,s.qualityLevels.VERSION=ph,r},mh=function(s){return Jp(this,ze.obj.merge({},s))};ze.registerPlugin("qualityLevels",mh),mh.VERSION=ph;/*! @name @videojs/http-streaming @version 3.7.0 @license Apache-2.0 */const Tr=z,Ku=(s,e)=>e&&e.responseURL&&s!==e.responseURL?e.responseURL:s,Vr=s=>ze.log.debug?ze.log.debug.bind(ze,"VHS:",`${s} >`):function(){};function Ii(...s){const e=ze.obj||ze;return(e.merge||e.mergeOptions).apply(e,s)}function Gn(...s){const e=ze.time||ze;return(e.createTimeRanges||e.createTimeRanges).apply(e,s)}function Zp(s){let e="";for(let i=0;i<s.length;i++){const r=s.start(i),o=s.end(i),d=o-r;e.length&&(e+=`
`),e+=`[${d}](${r} -> ${o})`}return e||"empty"}const Ta=1/30,Cs=Ta*3,gh=function(s,e){const i=[];let r;if(s&&s.length)for(r=0;r<s.length;r++)e(s.start(r),s.end(r))&&i.push([s.start(r),s.end(r)]);return Gn(i)},Ko=function(s,e){return gh(s,function(i,r){return i-Cs<=e&&r+Cs>=e})},zu=function(s,e){return gh(s,function(i){return i-Ta>=e})},e0=function(s){if(s.length<2)return Gn();const e=[];for(let i=1;i<s.length;i++){const r=s.end(i-1),o=s.start(i);e.push([r,o])}return Gn(e)},t0=function(s,e){let i=null,r=null,o=0;const d=[],h=[];if(!s||!s.length||!e||!e.length)return Gn();let g=s.length;for(;g--;)d.push({time:s.start(g),type:"start"}),d.push({time:s.end(g),type:"end"});for(g=e.length;g--;)d.push({time:e.start(g),type:"start"}),d.push({time:e.end(g),type:"end"});for(d.sort(function(k,N){return k.time-N.time}),g=0;g<d.length;g++)d[g].type==="start"?(o++,o===2&&(i=d[g].time)):d[g].type==="end"&&(o--,o===1&&(r=d[g].time)),i!==null&&r!==null&&(h.push([i,r]),i=null,r=null);return Gn(h)},yh=s=>{const e=[];if(!s||!s.length)return"";for(let i=0;i<s.length;i++)e.push(s.start(i)+" => "+s.end(i));return e.join(", ")},i0=function(s,e,i=1){return((s.length?s.end(s.length-1):0)-e)/i},eo=s=>{const e=[];for(let i=0;i<s.length;i++)e.push({start:s.start(i),end:s.end(i)});return e},n0=function(s,e){if(s===e)return!1;if(!s&&e||!e&&s||s.length!==e.length)return!0;for(let i=0;i<s.length;i++)if(s.start(i)!==e.start(i)||s.end(i)!==e.end(i))return!0;return!1},vh=function(s){if(!(!s||!s.length||!s.end))return s.end(s.length-1)},tc=function(s,e){let i=0;if(!s||!s.length)return i;for(let r=0;r<s.length;r++){const o=s.start(r),d=s.end(r);if(!(e>d)){if(e>o&&e<=d){i+=d-e;continue}i+=d-o}}return i},ic=(s,e)=>{if(!e.preload)return e.duration;let i=0;return(e.parts||[]).forEach(function(r){i+=r.duration}),(e.preloadHints||[]).forEach(function(r){r.type==="PART"&&(i+=s.partTargetDuration)}),i},nc=s=>(s.segments||[]).reduce((e,i,r)=>(i.parts?i.parts.forEach(function(o,d){e.push({duration:o.duration,segmentIndex:r,partIndex:d,part:o,segment:i})}):e.push({duration:i.duration,segmentIndex:r,partIndex:null,segment:i,part:null}),e),[]),Ah=s=>{const e=s.segments&&s.segments.length&&s.segments[s.segments.length-1];return e&&e.parts||[]},bh=({preloadSegment:s})=>{if(!s)return;const{parts:e,preloadHints:i}=s;let r=(i||[]).reduce((o,d)=>o+(d.type==="PART"?1:0),0);return r+=e&&e.length?e.length:0,r},_h=(s,e)=>{if(e.endList)return 0;if(s&&s.suggestedPresentationDelay)return s.suggestedPresentationDelay;const i=Ah(e).length>0;return i&&e.serverControl&&e.serverControl.partHoldBack?e.serverControl.partHoldBack:i&&e.partTargetDuration?e.partTargetDuration*3:e.serverControl&&e.serverControl.holdBack?e.serverControl.holdBack:e.targetDuration?e.targetDuration*3:0},r0=function(s,e){let i=0,r=e-s.mediaSequence,o=s.segments[r];if(o){if(typeof o.start!="undefined")return{result:o.start,precise:!0};if(typeof o.end!="undefined")return{result:o.end-o.duration,precise:!0}}for(;r--;){if(o=s.segments[r],typeof o.end!="undefined")return{result:i+o.end,precise:!0};if(i+=ic(s,o),typeof o.start!="undefined")return{result:i+o.start,precise:!0}}return{result:i,precise:!1}},s0=function(s,e){let i=0,r,o=e-s.mediaSequence;for(;o<s.segments.length;o++){if(r=s.segments[o],typeof r.start!="undefined")return{result:r.start-i,precise:!0};if(i+=ic(s,r),typeof r.end!="undefined")return{result:r.end-i,precise:!0}}return{result:-1,precise:!1}},xh=function(s,e,i){if(typeof e=="undefined"&&(e=s.mediaSequence+s.segments.length),e<s.mediaSequence)return 0;const r=r0(s,e);if(r.precise)return r.result;const o=s0(s,e);return o.precise?o.result:r.result+i},Eh=function(s,e,i){if(!s)return 0;if(typeof i!="number"&&(i=0),typeof e=="undefined"){if(s.totalDuration)return s.totalDuration;if(!s.endList)return ae()[Infinity]}return xh(s,e,i)},Yl=function({defaultDuration:s,durationList:e,startIndex:i,endIndex:r}){let o=0;if(i>r&&([i,r]=[r,i]),i<0){for(let d=i;d<Math.min(0,r);d++)o+=s;i=0}for(let d=i;d<r;d++)o+=e[d].duration;return o},Th=function(s,e,i,r){if(!s||!s.segments)return null;if(s.endList)return Eh(s);if(e===null)return null;e=e||0;let o=xh(s,s.mediaSequence+s.segments.length,e);return i&&(r=typeof r=="number"?r:_h(null,s),o-=r),Math.max(0,o)},a0=function(s,e,i){const r=!0,o=e||0;let d=Th(s,e,r,i);return d===null?Gn():(d<o&&(d=o),Gn(o,d))},o0=function({playlist:s,currentTime:e,startingSegmentIndex:i,startingPartIndex:r,startTime:o,exactManifestTimings:d}){let h=e-o;const g=nc(s);let k=0;for(let N=0;N<g.length;N++){const Y=g[N];if(i===Y.segmentIndex&&!(typeof r=="number"&&typeof Y.partIndex=="number"&&r!==Y.partIndex)){k=N;break}}if(h<0){if(k>0)for(let N=k-1;N>=0;N--){const Y=g[N];if(h+=Y.duration,d){if(h<0)continue}else if(h+Ta<=0)continue;return{partIndex:Y.partIndex,segmentIndex:Y.segmentIndex,startTime:o-Yl({defaultDuration:s.targetDuration,durationList:g,startIndex:k,endIndex:N})}}return{partIndex:g[0]&&g[0].partIndex||null,segmentIndex:g[0]&&g[0].segmentIndex||0,startTime:e}}if(k<0){for(let N=k;N<0;N++)if(h-=s.targetDuration,h<0)return{partIndex:g[0]&&g[0].partIndex||null,segmentIndex:g[0]&&g[0].segmentIndex||0,startTime:e};k=0}for(let N=k;N<g.length;N++){const Y=g[N];if(h-=Y.duration,d){if(h>0)continue}else if(h-Ta>=0)continue;return{partIndex:Y.partIndex,segmentIndex:Y.segmentIndex,startTime:o+Yl({defaultDuration:s.targetDuration,durationList:g,startIndex:k,endIndex:N})}}return{segmentIndex:g[g.length-1].segmentIndex,partIndex:g[g.length-1].partIndex,startTime:e}},Sh=function(s){return s.excludeUntil&&s.excludeUntil>Date.now()},rc=function(s){return s.excludeUntil&&s.excludeUntil===Infinity},Yu=function(s){const e=Sh(s);return!s.disabled&&!e},l0=function(s){return s.disabled},u0=function(s){for(let e=0;e<s.segments.length;e++)if(s.segments[e].key)return!0;return!1},Ch=function(s,e){return e.attributes&&e.attributes[s]},d0=function(s,e,i,r=0){return Ch("BANDWIDTH",i)?(s*i.attributes.BANDWIDTH-r*8)/e:NaN},sc=(s,e)=>{if(s.playlists.length===1)return!0;const i=e.attributes.BANDWIDTH||Number.MAX_VALUE;return s.playlists.filter(r=>Yu(r)?(r.attributes.BANDWIDTH||0)<i:!1).length===0},ac=(s,e)=>!s&&!e||!s&&e||s&&!e?!1:!!(s===e||s.id&&e.id&&s.id===e.id||s.resolvedUri&&e.resolvedUri&&s.resolvedUri===e.resolvedUri||s.uri&&e.uri&&s.uri===e.uri),wh=function(s,e){const i=s&&s.mediaGroups&&s.mediaGroups.AUDIO||{};let r=!1;for(const o in i){for(const d in i[o])if(r=e(i[o][d]),r)break;if(r)break}return!!r},Xl=s=>{if(!s||!s.playlists||!s.playlists.length)return wh(s,i=>i.playlists&&i.playlists.length||i.uri);for(let e=0;e<s.playlists.length;e++){const i=s.playlists[e],r=i.attributes&&i.attributes.CODECS;if(!(r&&r.split(",").every(d=>ot(d))||wh(s,d=>ac(i,d))))return!1}return!0};var hr={liveEdgeDelay:_h,duration:Eh,seekable:a0,getMediaInfoForTime:o0,isEnabled:Yu,isDisabled:l0,isExcluded:Sh,isIncompatible:rc,playlistEnd:Th,isAes:u0,hasAttribute:Ch,estimateSegmentRequestTime:d0,isLowestEnabledRendition:sc,isAudioOnly:Xl,playlistMatch:ac,segmentDurationWithParts:ic};const{log:Lh}=ze,oc=(s,e)=>`${s}-${e}`,c0=(s,e,i)=>`placeholder-uri-${s}-${e}-${i}`,h0=({onwarn:s,oninfo:e,manifestString:i,customTagParsers:r=[],customTagMappers:o=[],llhls:d})=>{const h=new Se;s&&h.on("warn",s),e&&h.on("info",e),r.forEach(N=>h.addParser(N)),o.forEach(N=>h.addTagMapper(N)),h.push(i),h.end();const g=h.manifest;if(d||(["preloadSegment","skip","serverControl","renditionReports","partInf","partTargetDuration"].forEach(function(N){g.hasOwnProperty(N)&&delete g[N]}),g.segments&&g.segments.forEach(function(N){["parts","preloadHints"].forEach(function(Y){N.hasOwnProperty(Y)&&delete N[Y]})})),!g.targetDuration){let N=10;g.segments&&g.segments.length&&(N=g.segments.reduce((Y,me)=>Math.max(Y,me.duration),0)),s&&s(`manifest has no targetDuration defaulting to ${N}`),g.targetDuration=N}const k=Ah(g);if(k.length&&!g.partTargetDuration){const N=k.reduce((Y,me)=>Math.max(Y,me.duration),0);s&&(s(`manifest has no partTargetDuration defaulting to ${N}`),Lh.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")),g.partTargetDuration=N}return g},zo=(s,e)=>{!s.mediaGroups||["AUDIO","SUBTITLES"].forEach(i=>{if(!!s.mediaGroups[i])for(const r in s.mediaGroups[i])for(const o in s.mediaGroups[i][r]){const d=s.mediaGroups[i][r][o];e(d,i,r,o)}})},kh=({playlist:s,uri:e,id:i})=>{s.id=i,s.playlistErrors_=0,e&&(s.uri=e),s.attributes=s.attributes||{}},f0=s=>{let e=s.playlists.length;for(;e--;){const i=s.playlists[e];kh({playlist:i,id:oc(e,i.uri)}),i.resolvedUri=Tr(s.uri,i.uri),s.playlists[i.id]=i,s.playlists[i.uri]=i,i.attributes.BANDWIDTH||Lh.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}},p0=s=>{zo(s,e=>{e.uri&&(e.resolvedUri=Tr(s.uri,e.uri))})},m0=(s,e)=>{const i=oc(0,e),r={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:ae().location.href,resolvedUri:ae().location.href,playlists:[{uri:e,id:i,resolvedUri:e,attributes:{}}]};return r.playlists[i]=r.playlists[0],r.playlists[e]=r.playlists[0],r},Dh=(s,e,i=c0)=>{s.uri=e;for(let o=0;o<s.playlists.length;o++)if(!s.playlists[o].uri){const d=`placeholder-uri-${o}`;s.playlists[o].uri=d}const r=Xl(s);zo(s,(o,d,h,g)=>{if(!o.playlists||!o.playlists.length){if(r&&d==="AUDIO"&&!o.uri)for(let k=0;k<s.playlists.length;k++){const N=s.playlists[k];if(N.attributes&&N.attributes.AUDIO&&N.attributes.AUDIO===h)return}o.playlists=[(0,P.Z)({},o)]}o.playlists.forEach(function(k,N){const Y=i(d,h,g,k),me=oc(N,Y);k.uri?k.resolvedUri=k.resolvedUri||Tr(s.uri,k.uri):(k.uri=N===0?Y:me,k.resolvedUri=k.uri),k.id=k.id||me,k.attributes=k.attributes||{},s.playlists[k.id]=k,s.playlists[k.uri]=k})}),f0(s),p0(s)};class Ih{constructor(){this.offset_=null,this.pendingDateRanges_=new Map,this.processedDateRanges_=new Map}setOffset(e=[]){if(this.offset_!==null||!e.length)return;const[i]=e;i.programDateTime!==void 0&&(this.offset_=i.programDateTime/1e3)}setPendingDateRanges(e=[]){if(!e.length)return;const[i]=e,r=i.startDate.getTime();this.trimProcessedDateRanges_(r),this.pendingDateRanges_=e.reduce((o,d)=>(o.set(d.id,d),o),new Map)}processDateRange(e){this.pendingDateRanges_.delete(e.id),this.processedDateRanges_.set(e.id,e)}getDateRangesToProcess(){if(this.offset_===null)return[];const e={},i=[];this.pendingDateRanges_.forEach((r,o)=>{if(!this.processedDateRanges_.has(o)&&(r.startTime=r.startDate.getTime()/1e3-this.offset_,r.processDateRange=()=>this.processDateRange(r),i.push(r),!!r.class))if(e[r.class]){const d=e[r.class].push(r);r.classListIndex=d-1}else e[r.class]=[r],r.classListIndex=0});for(const r of i){const o=e[r.class]||[];r.endDate?r.endTime=r.endDate.getTime()/1e3-this.offset_:r.endOnNext&&o[r.classListIndex+1]?r.endTime=o[r.classListIndex+1].startTime:r.duration?r.endTime=r.startTime+r.duration:r.plannedDuration?r.endTime=r.startTime+r.plannedDuration:r.endTime=r.startTime}return i}trimProcessedDateRanges_(e){new Map(this.processedDateRanges_).forEach((r,o)=>{r.startDate.getTime()<e&&this.processedDateRanges_.delete(o)})}}const{EventTarget:g0}=ze,y0=(s,e)=>{if(e.endList||!e.serverControl)return s;const i={};if(e.serverControl.canBlockReload){const{preloadSegment:r}=e;let o=e.mediaSequence+e.segments.length;if(r){const d=r.parts||[],h=bh(e)-1;h>-1&&h!==d.length-1&&(i._HLS_part=h),(h>-1||d.length)&&o--}i._HLS_msn=o}if(e.serverControl&&e.serverControl.canSkipUntil&&(i._HLS_skip=e.serverControl.canSkipDateranges?"v2":"YES"),Object.keys(i).length){const r=new(ae()).URL(s);["_HLS_skip","_HLS_msn","_HLS_part"].forEach(function(o){!i.hasOwnProperty(o)||r.searchParams.set(o,i[o])}),s=r.toString()}return s},v0=(s,e)=>{if(!s)return e;const i=Ii(s,e);if(s.preloadHints&&!e.preloadHints&&delete i.preloadHints,s.parts&&!e.parts)delete i.parts;else if(s.parts&&e.parts)for(let r=0;r<e.parts.length;r++)s.parts&&s.parts[r]&&(i.parts[r]=Ii(s.parts[r],e.parts[r]));return!s.skipped&&e.skipped&&(i.skipped=!1),s.preload&&!e.preload&&(i.preload=!1),i},A0=(s,e,i)=>{const r=s.slice(),o=e.slice();i=i||0;const d=[];let h;for(let g=0;g<o.length;g++){const k=r[g+i],N=o[g];k?(h=k.map||h,d.push(v0(k,N))):(h&&!N.map&&(N.map=h),d.push(N))}return d},Rh=(s,e)=>{!s.resolvedUri&&s.uri&&(s.resolvedUri=Tr(e,s.uri)),s.key&&!s.key.resolvedUri&&(s.key.resolvedUri=Tr(e,s.key.uri)),s.map&&!s.map.resolvedUri&&(s.map.resolvedUri=Tr(e,s.map.uri)),s.map&&s.map.key&&!s.map.key.resolvedUri&&(s.map.key.resolvedUri=Tr(e,s.map.key.uri)),s.parts&&s.parts.length&&s.parts.forEach(i=>{i.resolvedUri||(i.resolvedUri=Tr(e,i.uri))}),s.preloadHints&&s.preloadHints.length&&s.preloadHints.forEach(i=>{i.resolvedUri||(i.resolvedUri=Tr(e,i.uri))})},Oh=function(s){const e=s.segments||[],i=s.preloadSegment;if(i&&i.parts&&i.parts.length){if(i.preloadHints){for(let r=0;r<i.preloadHints.length;r++)if(i.preloadHints[r].type==="MAP")return e}i.duration=s.targetDuration,i.preload=!0,e.push(i)}return e},Ph=(s,e)=>s===e||s.segments&&e.segments&&s.segments.length===e.segments.length&&s.endList===e.endList&&s.mediaSequence===e.mediaSequence&&s.preloadSegment===e.preloadSegment,lc=(s,e,i=Ph)=>{const r=Ii(s,{}),o=r.playlists[e.id];if(!o||i(o,e))return null;e.segments=Oh(e);const d=Ii(o,e);if(d.preloadSegment&&!e.preloadSegment&&delete d.preloadSegment,o.segments){if(e.skip){e.segments=e.segments||[];for(let h=0;h<e.skip.skippedSegments;h++)e.segments.unshift({skipped:!0})}d.segments=A0(o.segments,e.segments,e.mediaSequence-o.mediaSequence)}d.segments.forEach(h=>{Rh(h,d.resolvedUri)});for(let h=0;h<r.playlists.length;h++)r.playlists[h].id===e.id&&(r.playlists[h]=d);return r.playlists[e.id]=d,r.playlists[e.uri]=d,zo(s,(h,g,k,N)=>{if(!!h.playlists)for(let Y=0;Y<h.playlists.length;Y++)e.id===h.playlists[Y].id&&(h.playlists[Y]=d)}),r},uc=(s,e)=>{const i=s.segments||[],r=i[i.length-1],o=r&&r.parts&&r.parts[r.parts.length-1],d=o&&o.duration||r&&r.duration;return e&&d?d*1e3:(s.partTargetDuration||s.targetDuration||10)*500};class Yo extends g0{constructor(e,i,r={}){super();if(!e)throw new Error("A non-empty playlist URL or object is required");this.logger_=Vr("PlaylistLoader");const{withCredentials:o=!1}=r;this.src=e,this.vhs_=i,this.withCredentials=o,this.addDateRangesToTextTrack_=r.addDateRangesToTextTrack;const d=i.options_;this.customTagParsers=d&&d.customTagParsers||[],this.customTagMappers=d&&d.customTagMappers||[],this.llhls=d&&d.llhls,this.dateRangesStorage_=new Ih,this.state="HAVE_NOTHING",this.handleMediaupdatetimeout_=this.handleMediaupdatetimeout_.bind(this),this.on("mediaupdatetimeout",this.handleMediaupdatetimeout_),this.on("loadedplaylist",this.handleLoadedPlaylist_.bind(this))}handleLoadedPlaylist_(){const e=this.media();if(!e)return;this.dateRangesStorage_.setOffset(e.segments),this.dateRangesStorage_.setPendingDateRanges(e.dateRanges);const i=this.dateRangesStorage_.getDateRangesToProcess();!i.length||!this.addDateRangesToTextTrack_||this.addDateRangesToTextTrack_(i)}handleMediaupdatetimeout_(){if(this.state!=="HAVE_METADATA")return;const e=this.media();let i=Tr(this.main.uri,e.uri);this.llhls&&(i=y0(i,e)),this.state="HAVE_CURRENT_METADATA",this.request=this.vhs_.xhr({uri:i,withCredentials:this.withCredentials},(r,o)=>{if(!!this.request){if(r)return this.playlistRequestError(this.request,this.media(),"HAVE_METADATA");this.haveMetadata({playlistString:this.request.responseText,url:this.media().uri,id:this.media().id})}})}playlistRequestError(e,i,r){const{uri:o,id:d}=i;this.request=null,r&&(this.state=r),this.error={playlist:this.main.playlists[d],status:e.status,message:`HLS playlist request error at URL: ${o}.`,responseText:e.responseText,code:e.status>=500?4:2},this.trigger("error")}parseManifest_({url:e,manifestString:i}){return h0({onwarn:({message:r})=>this.logger_(`m3u8-parser warn for ${e}: ${r}`),oninfo:({message:r})=>this.logger_(`m3u8-parser info for ${e}: ${r}`),manifestString:i,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,llhls:this.llhls})}haveMetadata({playlistString:e,playlistObject:i,url:r,id:o}){this.request=null,this.state="HAVE_METADATA";const d=i||this.parseManifest_({url:r,manifestString:e});d.lastRequest=Date.now(),kh({playlist:d,uri:r,id:o});const h=lc(this.main,d);this.targetDuration=d.partTargetDuration||d.targetDuration,this.pendingMedia_=null,h?(this.main=h,this.media_=this.main.playlists[o]):this.trigger("playlistunchanged"),this.updateMediaUpdateTimeout_(uc(this.media(),!!h)),this.trigger("loadedplaylist")}dispose(){this.trigger("dispose"),this.stopRequest(),ae().clearTimeout(this.mediaUpdateTimeout),ae().clearTimeout(this.finalRenditionTimeout),this.dateRangesStorage_=new Ih,this.off()}stopRequest(){if(this.request){const e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}media(e,i){if(!e)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);if(typeof e=="string"){if(!this.main.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.main.playlists[e]}if(ae().clearTimeout(this.finalRenditionTimeout),i){const h=(e.partTargetDuration||e.targetDuration)/2*1e3||5*1e3;this.finalRenditionTimeout=ae().setTimeout(this.media.bind(this,e,!1),h);return}const r=this.state,o=!this.media_||e.id!==this.media_.id,d=this.main.playlists[e.id];if(d&&d.endList||e.endList&&e.segments.length){this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=e,o&&(this.trigger("mediachanging"),r==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange"));return}if(this.updateMediaUpdateTimeout_(uc(e,!0)),!!o){if(this.state="SWITCHING_MEDIA",this.request){if(e.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.pendingMedia_=e,this.request=this.vhs_.xhr({uri:e.resolvedUri,withCredentials:this.withCredentials},(h,g)=>{if(!!this.request){if(e.lastRequest=Date.now(),e.resolvedUri=Ku(e.resolvedUri,g),h)return this.playlistRequestError(this.request,e,r);this.haveMetadata({playlistString:g.responseText,url:e.uri,id:e.id}),r==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange")}})}}pause(){this.mediaUpdateTimeout&&(ae().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.stopRequest(),this.state==="HAVE_NOTHING"&&(this.started=!1),this.state==="SWITCHING_MEDIA"?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MAIN_MANIFEST":this.state==="HAVE_CURRENT_METADATA"&&(this.state="HAVE_METADATA")}load(e){this.mediaUpdateTimeout&&(ae().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null);const i=this.media();if(e){const r=i?(i.partTargetDuration||i.targetDuration)/2*1e3:5*1e3;this.mediaUpdateTimeout=ae().setTimeout(()=>{this.mediaUpdateTimeout=null,this.load()},r);return}if(!this.started){this.start();return}i&&!i.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist")}updateMediaUpdateTimeout_(e){this.mediaUpdateTimeout&&(ae().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),!(!this.media()||this.media().endList)&&(this.mediaUpdateTimeout=ae().setTimeout(()=>{this.mediaUpdateTimeout=null,this.trigger("mediaupdatetimeout"),this.updateMediaUpdateTimeout_(e)},e))}start(){if(this.started=!0,typeof this.src=="object"){this.src.uri||(this.src.uri=ae().location.href),this.src.resolvedUri=this.src.uri,setTimeout(()=>{this.setupInitialPlaylist(this.src)},0);return}this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials},(e,i)=>{if(!this.request)return;if(this.request=null,e)return this.error={status:i.status,message:`HLS playlist request error at URL: ${this.src}.`,responseText:i.responseText,code:2},this.state==="HAVE_NOTHING"&&(this.started=!1),this.trigger("error");this.src=Ku(this.src,i);const r=this.parseManifest_({manifestString:i.responseText,url:this.src});this.setupInitialPlaylist(r)})}srcUri(){return typeof this.src=="string"?this.src:this.src.uri}setupInitialPlaylist(e){if(this.state="HAVE_MAIN_MANIFEST",e.playlists){this.main=e,Dh(this.main,this.srcUri()),e.playlists.forEach(r=>{r.segments=Oh(r),r.segments.forEach(o=>{Rh(o,r.resolvedUri)})}),this.trigger("loadedplaylist"),this.request||this.media(this.main.playlists[0]);return}const i=this.srcUri()||ae().location.href;this.main=m0(e,i),this.haveMetadata({playlistObject:e,url:i,id:this.main.playlists[0].id}),this.trigger("loadedmetadata")}}const{xhr:b0}=ze,dc=function(s,e,i,r){const o=s.responseType==="arraybuffer"?s.response:s.responseText;!e&&o&&(s.responseTime=Date.now(),s.roundTripTime=s.responseTime-s.requestTime,s.bytesReceived=o.byteLength||o.length,s.bandwidth||(s.bandwidth=Math.floor(s.bytesReceived/s.roundTripTime*8*1e3))),i.headers&&(s.responseHeaders=i.headers),e&&e.code==="ETIMEDOUT"&&(s.timedout=!0),!e&&!s.aborted&&i.statusCode!==200&&i.statusCode!==206&&i.statusCode!==0&&(e=new Error("XHR Failed with a response of: "+(s&&(o||s.responseText)))),r(e,s)},_0=(s,e)=>{if(!s||!s.size)return;let i=e;return s.forEach(r=>{i=r(i)}),i},x0=(s,e,i,r)=>{!s||!s.size||s.forEach(o=>{o(e,i,r)})},Bh=function(){const s=function e(i,r){i=Ii({timeout:45e3},i);const o=e.beforeRequest||ze.Vhs.xhr.beforeRequest,d=e._requestCallbackSet||ze.Vhs.xhr._requestCallbackSet||new Set,h=e._responseCallbackSet||ze.Vhs.xhr._responseCallbackSet;o&&typeof o=="function"&&(ze.log.warn("beforeRequest is deprecated, use onRequest instead."),d.add(o));const g=ze.Vhs.xhr.original===!0?b0:ze.Vhs.xhr,k=_0(d,i);d.delete(o);const N=g(k||i,function(me,Ie){return x0(h,N,me,Ie),dc(N,me,Ie,r)}),Y=N.abort;return N.abort=function(){return N.aborted=!0,Y.apply(N,arguments)},N.uri=i.uri,N.requestTime=Date.now(),N};return s.original=!0,s},E0=function(s){let e;const i=s.offset;return typeof s.offset=="bigint"||typeof s.length=="bigint"?e=ae().BigInt(s.offset)+ae().BigInt(s.length)-ae().BigInt(1):e=s.offset+s.length-1,"bytes="+i+"-"+e},cc=function(s){const e={};return s.byterange&&(e.Range=E0(s.byterange)),e},T0=function(s,e){return s.start(e)+"-"+s.end(e)},S0=function(s,e){const i=s.toString(16);return"00".substring(0,2-i.length)+i+(e%2?" ":"")},C0=function(s){return s>=32&&s<126?String.fromCharCode(s):"."},Mh=function(s){const e={};return Object.keys(s).forEach(i=>{const r=s[i];cn(r)?e[i]={bytes:r.buffer,byteOffset:r.byteOffset,byteLength:r.byteLength}:e[i]=r}),e},Xu=function(s){const e=s.byterange||{length:Infinity,offset:0};return[e.length,e.offset,s.resolvedUri].join(",")},Fh=function(s){return s.resolvedUri},Nh=s=>{const e=Array.prototype.slice.call(s),i=16;let r="",o,d;for(let h=0;h<e.length/i;h++)o=e.slice(h*i,h*i+i).map(S0).join(""),d=e.slice(h*i,h*i+i).map(C0).join(""),r+=o+" "+d+`
`;return r};var w0=Object.freeze({__proto__:null,createTransferableMessage:Mh,initSegmentId:Xu,segmentKeyId:Fh,hexDump:Nh,tagDump:({bytes:s})=>Nh(s),textRanges:s=>{let e="",i;for(i=0;i<s.length;i++)e+=T0(s,i)+" ";return e}});const Uh=.25,L0=(s,e)=>{if(!e.dateTimeObject)return null;const i=e.videoTimingInfo.transmuxerPrependedSeconds,o=e.videoTimingInfo.transmuxedPresentationStart+i,d=s-o;return new Date(e.dateTimeObject.getTime()+d*1e3)},k0=s=>s.transmuxedPresentationEnd-s.transmuxedPresentationStart-s.transmuxerPrependedSeconds,D0=(s,e)=>{let i;try{i=new Date(s)}catch(k){return null}if(!e||!e.segments||e.segments.length===0)return null;let r=e.segments[0];if(i<new Date(r.dateTimeObject))return null;for(let k=0;k<e.segments.length-1;k++){r=e.segments[k];const N=new Date(e.segments[k+1].dateTimeObject);if(i<N)break}const o=e.segments[e.segments.length-1],d=o.dateTimeObject,h=o.videoTimingInfo?k0(o.videoTimingInfo):o.duration+o.duration*Uh,g=new Date(d.getTime()+h*1e3);return i>g?null:(i>new Date(d)&&(r=o),{segment:r,estimatedStart:r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationStart:hr.duration(e,e.mediaSequence+e.segments.indexOf(r)),type:r.videoTimingInfo?"accurate":"estimate"})},I0=(s,e)=>{if(!e||!e.segments||e.segments.length===0)return null;let i=0,r;for(let d=0;d<e.segments.length&&(r=e.segments[d],i=r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationEnd:i+r.duration,!(s<=i));d++);const o=e.segments[e.segments.length-1];if(o.videoTimingInfo&&o.videoTimingInfo.transmuxedPresentationEnd<s)return null;if(s>i){if(s>i+o.duration*Uh)return null;r=o}return{segment:r,estimatedStart:r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationStart:i-r.duration,type:r.videoTimingInfo?"accurate":"estimate"}},R0=(s,e)=>{let i,r;try{i=new Date(s),r=new Date(e)}catch(h){}const o=i.getTime();return(r.getTime()-o)/1e3},O0=s=>{if(!s.segments||s.segments.length===0)return!1;for(let e=0;e<s.segments.length;e++)if(!s.segments[e].dateTimeObject)return!1;return!0},P0=({playlist:s,time:e=void 0,callback:i})=>{if(!i)throw new Error("getProgramTime: callback must be provided");if(!s||e===void 0)return i({message:"getProgramTime: playlist and time must be provided"});const r=I0(e,s);if(!r)return i({message:"valid programTime was not found"});if(r.type==="estimate")return i({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:r.estimatedStart});const o={mediaSeconds:e},d=L0(e,r.segment);return d&&(o.programDateTime=d.toISOString()),i(null,o)},jh=({programTime:s,playlist:e,retryCount:i=2,seekTo:r,pauseAfterSeek:o=!0,tech:d,callback:h})=>{if(!h)throw new Error("seekToProgramTime: callback must be provided");if(typeof s=="undefined"||!e||!r)return h({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!e.endList&&!d.hasStarted_)return h({message:"player must be playing a live stream to start buffering"});if(!O0(e))return h({message:"programDateTime tags must be provided in the manifest "+e.resolvedUri});const g=D0(s,e);if(!g)return h({message:`${s} was not found in the stream`});const k=g.segment,N=R0(k.dateTimeObject,s);if(g.type==="estimate"){if(i===0)return h({message:`${s} is not buffered yet. Try again`});r(g.estimatedStart+N),d.one("seeked",()=>{jh({programTime:s,playlist:e,retryCount:i-1,seekTo:r,pauseAfterSeek:o,tech:d,callback:h})});return}const Y=k.start+N,me=()=>h(null,d.currentTime());d.one("seeked",me),o&&d.pause(),r(Y)},hc=(s,e)=>{if(s.readyState===4)return e()},B0=(s,e,i)=>{let r=[],o,d=!1;const h=function(Y,me,Ie,Pe){return me.abort(),d=!0,i(Y,me,Ie,Pe)},g=function(Y,me){if(d)return;if(Y)return h(Y,me,"",r);const Ie=me.responseText.substring(r&&r.byteLength||0,me.responseText.length);if(r=Rt(r,ht(Ie,!0)),o=o||Fs(r),r.length<10||o&&r.length<o+2)return hc(me,()=>h(Y,me,"",r));const Pe=$a(r);return Pe==="ts"&&r.length<188?hc(me,()=>h(Y,me,"",r)):!Pe&&r.length<376?hc(me,()=>h(Y,me,"",r)):h(null,me,Pe,r)},N=e({uri:s,beforeSend(Y){Y.overrideMimeType("text/plain; charset=x-user-defined"),Y.addEventListener("progress",function({total:me,loaded:Ie}){return dc(Y,null,{statusCode:Y.status},g)})}},function(Y,me){return dc(N,Y,me,g)});return N},{EventTarget:M0}=ze,$h=function(s,e){if(!Ph(s,e)||s.sidx&&e.sidx&&(s.sidx.offset!==e.sidx.offset||s.sidx.length!==e.sidx.length))return!1;if(!s.sidx&&e.sidx||s.sidx&&!e.sidx||s.segments&&!e.segments||!s.segments&&e.segments)return!1;if(!s.segments&&!e.segments)return!0;for(let i=0;i<s.segments.length;i++){const r=s.segments[i],o=e.segments[i];if(r.uri!==o.uri)return!1;if(!r.byterange&&!o.byterange)continue;const d=r.byterange,h=o.byterange;if(d&&!h||!d&&h||d.offset!==h.offset||d.length!==h.length)return!1}return!0},F0=(s,e,i,r)=>{const o=r.attributes.NAME||i;return`placeholder-uri-${s}-${e}-${o}`},N0=({mainXml:s,srcUrl:e,clientOffset:i,sidxMapping:r,previousManifest:o})=>{const d=ll(s,{manifestUri:e,clientOffset:i,sidxMapping:r,previousManifest:o});return Dh(d,e,F0),d},U0=(s,e)=>{zo(s,(i,r,o,d)=>{d in e.mediaGroups[r][o]||delete s.mediaGroups[r][o][d]})},j0=(s,e,i)=>{let r=!0,o=Ii(s,{duration:e.duration,minimumUpdatePeriod:e.minimumUpdatePeriod,timelineStarts:e.timelineStarts});for(let d=0;d<e.playlists.length;d++){const h=e.playlists[d];if(h.sidx){const k=Sn(h.sidx);i&&i[k]&&i[k].sidx&&Nt(h,i[k].sidx,h.sidx.resolvedUri)}const g=lc(o,h,$h);g&&(o=g,r=!1)}return zo(e,(d,h,g,k)=>{if(d.playlists&&d.playlists.length){const N=d.playlists[0].id,Y=lc(o,d.playlists[0],$h);Y&&(o=Y,k in o.mediaGroups[h][g]||(o.mediaGroups[h][g][k]=d),o.mediaGroups[h][g][k].playlists[0]=o.playlists[N],r=!1)}}),U0(o,e),e.minimumUpdatePeriod!==s.minimumUpdatePeriod&&(r=!1),r?null:o},$0=(s,e)=>(Boolean(!s.map&&!e.map)||Boolean(s.map&&e.map&&s.map.byterange.offset===e.map.byterange.offset&&s.map.byterange.length===e.map.byterange.length))&&s.uri===e.uri&&s.byterange.offset===e.byterange.offset&&s.byterange.length===e.byterange.length,Vh=(s,e)=>{const i={};for(const r in s){const d=s[r].sidx;if(d){const h=Sn(d);if(!e[h])break;const g=e[h].sidxInfo;$0(g,d)&&(i[h]=e[h])}}return i},V0=(s,e)=>{let r=Vh(s.playlists,e);return zo(s,(o,d,h,g)=>{if(o.playlists&&o.playlists.length){const k=o.playlists;r=Ii(r,Vh(k,e))}}),r};class fc extends M0{constructor(e,i,r={},o){super();this.mainPlaylistLoader_=o||this,o||(this.isMain_=!0);const{withCredentials:d=!1}=r;if(this.vhs_=i,this.withCredentials=d,this.addMetadataToTextTrack=r.addMetadataToTextTrack,!e)throw new Error("A non-empty playlist URL or object is required");this.on("minimumUpdatePeriod",()=>{this.refreshXml_()}),this.on("mediaupdatetimeout",()=>{this.media().attributes.serviceLocation||this.refreshMedia_(this.media().id)}),this.state="HAVE_NOTHING",this.loadedPlaylists_={},this.logger_=Vr("DashPlaylistLoader"),this.isMain_?(this.mainPlaylistLoader_.srcUrl=e,this.mainPlaylistLoader_.sidxMapping_={}):this.childPlaylist_=e}requestErrored_(e,i,r){if(!this.request)return!0;if(this.request=null,e)return this.error=typeof e=="object"&&!(e instanceof Error)?e:{status:i.status,message:"DASH request error at URL: "+i.uri,response:i.response,code:2},r&&(this.state=r),this.trigger("error"),!0}addSidxSegments_(e,i,r){const o=e.sidx&&Sn(e.sidx);if(!e.sidx||!o||this.mainPlaylistLoader_.sidxMapping_[o]){this.mediaRequest_=ae().setTimeout(()=>r(!1),0);return}const d=Ku(e.sidx.resolvedUri),h=(g,k)=>{if(this.requestErrored_(g,k,i))return;const N=this.mainPlaylistLoader_.sidxMapping_;let Y;try{Y=yo()(pt(k.response).subarray(8))}catch(me){this.requestErrored_(me,k,i);return}return N[o]={sidxInfo:e.sidx,sidx:Y},Nt(e,Y,e.sidx.resolvedUri),r(!0)};this.request=B0(d,this.vhs_.xhr,(g,k,N,Y)=>{if(g)return h(g,k);if(!N||N!=="mp4")return h({status:k.status,message:`Unsupported ${N||"unknown"} container type for sidx segment at URL: ${d}`,response:"",playlist:e,internal:!0,playlistExclusionDuration:Infinity,code:2},k);const{offset:me,length:Ie}=e.sidx.byterange;if(Y.length>=Ie+me)return h(g,{response:Y.subarray(me,me+Ie),status:k.status,uri:k.uri});this.request=this.vhs_.xhr({uri:d,responseType:"arraybuffer",headers:cc({byterange:e.sidx.byterange})},h)})}dispose(){this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},ae().clearTimeout(this.minimumUpdatePeriodTimeout_),ae().clearTimeout(this.mediaRequest_),ae().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.mediaRequest_=null,this.minimumUpdatePeriodTimeout_=null,this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.off()}hasPendingRequest(){return this.request||this.mediaRequest_}stopRequest(){if(this.request){const e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}media(e){if(!e)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);const i=this.state;if(typeof e=="string"){if(!this.mainPlaylistLoader_.main.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.mainPlaylistLoader_.main.playlists[e]}const r=!this.media_||e.id!==this.media_.id;if(r&&this.loadedPlaylists_[e.id]&&this.loadedPlaylists_[e.id].endList){this.state="HAVE_METADATA",this.media_=e,r&&(this.trigger("mediachanging"),this.trigger("mediachange"));return}!r||(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(e,i,o=>{this.haveMetadata({startingState:i,playlist:e})}))}haveMetadata({startingState:e,playlist:i}){this.state="HAVE_METADATA",this.loadedPlaylists_[i.id]=i,this.mediaRequest_=null,this.refreshMedia_(i.id),e==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange")}pause(){this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.stopRequest(),ae().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.isMain_&&(ae().clearTimeout(this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_),this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_=null),this.state==="HAVE_NOTHING"&&(this.started=!1)}load(e){ae().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null;const i=this.media();if(e){const r=i?i.targetDuration/2*1e3:5*1e3;this.mediaUpdateTimeout=ae().setTimeout(()=>this.load(),r);return}if(!this.started){this.start();return}i&&!i.endList?(this.isMain_&&!this.minimumUpdatePeriodTimeout_&&(this.trigger("minimumUpdatePeriod"),this.updateMinimumUpdatePeriodTimeout_()),this.trigger("mediaupdatetimeout")):this.trigger("loadedplaylist")}start(){if(this.started=!0,!this.isMain_){this.mediaRequest_=ae().setTimeout(()=>this.haveMain_(),0);return}this.requestMain_((e,i)=>{this.haveMain_(),!this.hasPendingRequest()&&!this.media_&&this.media(this.mainPlaylistLoader_.main.playlists[0])})}requestMain_(e){this.request=this.vhs_.xhr({uri:this.mainPlaylistLoader_.srcUrl,withCredentials:this.withCredentials},(i,r)=>{if(this.requestErrored_(i,r)){this.state==="HAVE_NOTHING"&&(this.started=!1);return}const o=r.responseText!==this.mainPlaylistLoader_.mainXml_;if(this.mainPlaylistLoader_.mainXml_=r.responseText,r.responseHeaders&&r.responseHeaders.date?this.mainLoaded_=Date.parse(r.responseHeaders.date):this.mainLoaded_=Date.now(),this.mainPlaylistLoader_.srcUrl=Ku(this.mainPlaylistLoader_.srcUrl,r),o){this.handleMain_(),this.syncClientServerClock_(()=>e(r,o));return}return e(r,o)})}syncClientServerClock_(e){const i=ul(this.mainPlaylistLoader_.mainXml_);if(i===null)return this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),e();if(i.method==="DIRECT")return this.mainPlaylistLoader_.clientOffset_=i.value-Date.now(),e();this.request=this.vhs_.xhr({uri:Tr(this.mainPlaylistLoader_.srcUrl,i.value),method:i.method,withCredentials:this.withCredentials},(r,o)=>{if(!this.request)return;if(r)return this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),e();let d;i.method==="HEAD"?!o.responseHeaders||!o.responseHeaders.date?d=this.mainLoaded_:d=Date.parse(o.responseHeaders.date):d=Date.parse(o.responseText),this.mainPlaylistLoader_.clientOffset_=d-Date.now(),e()})}haveMain_(){this.state="HAVE_MAIN_MANIFEST",this.isMain_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)}handleMain_(){this.mediaRequest_=null;const e=this.mainPlaylistLoader_.main;let i=N0({mainXml:this.mainPlaylistLoader_.mainXml_,srcUrl:this.mainPlaylistLoader_.srcUrl,clientOffset:this.mainPlaylistLoader_.clientOffset_,sidxMapping:this.mainPlaylistLoader_.sidxMapping_,previousManifest:e});e&&(i=j0(e,i,this.mainPlaylistLoader_.sidxMapping_)),this.mainPlaylistLoader_.main=i||e;const r=this.mainPlaylistLoader_.main.locations&&this.mainPlaylistLoader_.main.locations[0];return r&&r!==this.mainPlaylistLoader_.srcUrl&&(this.mainPlaylistLoader_.srcUrl=r),(!e||i&&i.minimumUpdatePeriod!==e.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_(),this.addEventStreamToMetadataTrack_(i),Boolean(i)}updateMinimumUpdatePeriodTimeout_(){const e=this.mainPlaylistLoader_;e.createMupOnMedia_&&(e.off("loadedmetadata",e.createMupOnMedia_),e.createMupOnMedia_=null),e.minimumUpdatePeriodTimeout_&&(ae().clearTimeout(e.minimumUpdatePeriodTimeout_),e.minimumUpdatePeriodTimeout_=null);let i=e.main&&e.main.minimumUpdatePeriod;if(i===0&&(e.media()?i=e.media().targetDuration*1e3:(e.createMupOnMedia_=e.updateMinimumUpdatePeriodTimeout_,e.one("loadedmetadata",e.createMupOnMedia_))),typeof i!="number"||i<=0){i<0&&this.logger_(`found invalid minimumUpdatePeriod of ${i}, not setting a timeout`);return}this.createMUPTimeout_(i)}createMUPTimeout_(e){const i=this.mainPlaylistLoader_;i.minimumUpdatePeriodTimeout_=ae().setTimeout(()=>{i.minimumUpdatePeriodTimeout_=null,i.trigger("minimumUpdatePeriod"),i.createMUPTimeout_(e)},e)}refreshXml_(){this.requestMain_((e,i)=>{!i||(this.media_&&(this.media_=this.mainPlaylistLoader_.main.playlists[this.media_.id]),this.mainPlaylistLoader_.sidxMapping_=V0(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.sidxMapping_),this.addSidxSegments_(this.media(),this.state,r=>{this.refreshMedia_(this.media().id)}))})}refreshMedia_(e){if(!e)throw new Error("refreshMedia_ must take a media id");this.media_&&this.isMain_&&this.handleMain_();const i=this.mainPlaylistLoader_.main.playlists,r=!this.media_||this.media_!==i[e];if(r?this.media_=i[e]:this.trigger("playlistunchanged"),!this.mediaUpdateTimeout){const o=()=>{this.media().endList||(this.mediaUpdateTimeout=ae().setTimeout(()=>{this.trigger("mediaupdatetimeout"),o()},uc(this.media(),Boolean(r))))};o()}this.trigger("loadedplaylist")}addEventStreamToMetadataTrack_(e){if(e&&this.mainPlaylistLoader_.main.eventStream){const i=this.mainPlaylistLoader_.main.eventStream.map(r=>({cueTime:r.start,frames:[{data:r.messageData}]}));this.addMetadataToTextTrack("EventStream",i,this.mainPlaylistLoader_.main.duration)}}}var Ln={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30};const H0=s=>{const e=new Uint8Array(new ArrayBuffer(s.length));for(let i=0;i<s.length;i++)e[i]=s.charCodeAt(i);return e.buffer},Hh=function(s){return s.on=s.addEventListener,s.off=s.removeEventListener,s},G0=function(s){try{return URL.createObjectURL(new Blob([s],{type:"application/javascript"}))}catch(e){const i=new BlobBuilder;return i.append(s),URL.createObjectURL(i.getBlob())}},Gh=function(s){return function(){const e=G0(s),i=Hh(new Worker(e));i.objURL=e;const r=i.terminate;return i.on=i.addEventListener,i.off=i.removeEventListener,i.terminate=function(){return URL.revokeObjectURL(e),r.call(this)},i}},qh=function(s){return`var browserWorkerPolyFill = ${Hh.toString()};
browserWorkerPolyFill(self);
`+s},Wh=function(s){return s.toString().replace(/^function.+?{/,"").slice(0,-1)},q0=qh(Wh(function(){var s=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof ft.g!="undefined"?ft.g:typeof self!="undefined"?self:{},e=function(){this.init=function(){var m={};this.on=function(b,S){m[b]||(m[b]=[]),m[b]=m[b].concat(S)},this.off=function(b,S){var E;return m[b]?(E=m[b].indexOf(S),m[b]=m[b].slice(),m[b].splice(E,1),E>-1):!1},this.trigger=function(b){var S,E,I,M;if(S=m[b],!!S)if(arguments.length===2)for(I=S.length,E=0;E<I;++E)S[E].call(this,arguments[1]);else{for(M=[],E=arguments.length,E=1;E<arguments.length;++E)M.push(arguments[E]);for(I=S.length,E=0;E<I;++E)S[E].apply(this,M)}},this.dispose=function(){m={}}}};e.prototype.pipe=function(m){return this.on("data",function(b){m.push(b)}),this.on("done",function(b){m.flush(b)}),this.on("partialdone",function(b){m.partialFlush(b)}),this.on("endedtimeline",function(b){m.endTimeline(b)}),this.on("reset",function(b){m.reset(b)}),m},e.prototype.push=function(m){this.trigger("data",m)},e.prototype.flush=function(m){this.trigger("done",m)},e.prototype.partialFlush=function(m){this.trigger("partialdone",m)},e.prototype.endTimeline=function(m){this.trigger("endedtimeline",m)},e.prototype.reset=function(m){this.trigger("reset",m)};var i=e,r=Math.pow(2,32),o=function(m){var b=new DataView(m.buffer,m.byteOffset,m.byteLength),S;return b.getBigUint64?(S=b.getBigUint64(0),S<Number.MAX_SAFE_INTEGER?Number(S):S):b.getUint32(0)*r+b.getUint32(4)},d={getUint64:o,MAX_UINT32:r},h=d.MAX_UINT32,g,k,N,Y,me,Ie,Pe,Ae,$e,Ye,Qe,qe,ct,Je,je,_t,jt,di,pi,nn,qn,rn,Ht,Bi,ks,Qs,Sa,to,io,no,ro,so,nd,Ff,Nf,Uf;(function(){var m;if(Ht={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},typeof Uint8Array!="undefined"){for(m in Ht)Ht.hasOwnProperty(m)&&(Ht[m]=[m.charCodeAt(0),m.charCodeAt(1),m.charCodeAt(2),m.charCodeAt(3)]);Bi=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),Qs=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),ks=new Uint8Array([0,0,0,1]),Sa=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),to=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),io={video:Sa,audio:to},so=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),ro=new Uint8Array([0,0,0,0,0,0,0,0]),nd=new Uint8Array([0,0,0,0,0,0,0,0]),Ff=nd,Nf=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Uf=nd,no=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})(),g=function(m){var b=[],S=0,E,I,M;for(E=1;E<arguments.length;E++)b.push(arguments[E]);for(E=b.length;E--;)S+=b[E].byteLength;for(I=new Uint8Array(S+8),M=new DataView(I.buffer,I.byteOffset,I.byteLength),M.setUint32(0,I.byteLength),I.set(m,4),E=0,S=8;E<b.length;E++)I.set(b[E],S),S+=b[E].byteLength;return I},k=function(){return g(Ht.dinf,g(Ht.dref,so))},N=function(m){return g(Ht.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,m.audioobjecttype<<3|m.samplingfrequencyindex>>>1,m.samplingfrequencyindex<<7|m.channelcount<<3,6,1,2]))},Y=function(){return g(Ht.ftyp,Bi,ks,Bi,Qs)},_t=function(m){return g(Ht.hdlr,io[m])},me=function(m){return g(Ht.mdat,m)},je=function(m){var b=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,m.duration>>>24&255,m.duration>>>16&255,m.duration>>>8&255,m.duration&255,85,196,0,0]);return m.samplerate&&(b[12]=m.samplerate>>>24&255,b[13]=m.samplerate>>>16&255,b[14]=m.samplerate>>>8&255,b[15]=m.samplerate&255),g(Ht.mdhd,b)},Je=function(m){return g(Ht.mdia,je(m),_t(m.type),Pe(m))},Ie=function(m){return g(Ht.mfhd,new Uint8Array([0,0,0,0,(m&4278190080)>>24,(m&16711680)>>16,(m&65280)>>8,m&255]))},Pe=function(m){return g(Ht.minf,m.type==="video"?g(Ht.vmhd,no):g(Ht.smhd,ro),k(),di(m))},Ae=function(m,b){for(var S=[],E=b.length;E--;)S[E]=nn(b[E]);return g.apply(null,[Ht.moof,Ie(m)].concat(S))},$e=function(m){for(var b=m.length,S=[];b--;)S[b]=qe(m[b]);return g.apply(null,[Ht.moov,Qe(4294967295)].concat(S).concat(Ye(m)))},Ye=function(m){for(var b=m.length,S=[];b--;)S[b]=qn(m[b]);return g.apply(null,[Ht.mvex].concat(S))},Qe=function(m){var b=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(m&4278190080)>>24,(m&16711680)>>16,(m&65280)>>8,m&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return g(Ht.mvhd,b)},jt=function(m){var b=m.samples||[],S=new Uint8Array(4+b.length),E,I;for(I=0;I<b.length;I++)E=b[I].flags,S[I+4]=E.dependsOn<<4|E.isDependedOn<<2|E.hasRedundancy;return g(Ht.sdtp,S)},di=function(m){return g(Ht.stbl,pi(m),g(Ht.stts,Uf),g(Ht.stsc,Ff),g(Ht.stsz,Nf),g(Ht.stco,nd))},function(){var m,b;pi=function(S){return g(Ht.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),S.type==="video"?m(S):b(S))},m=function(S){var E=S.sps||[],I=S.pps||[],M=[],ue=[],ge,be;for(ge=0;ge<E.length;ge++)M.push((E[ge].byteLength&65280)>>>8),M.push(E[ge].byteLength&255),M=M.concat(Array.prototype.slice.call(E[ge]));for(ge=0;ge<I.length;ge++)ue.push((I[ge].byteLength&65280)>>>8),ue.push(I[ge].byteLength&255),ue=ue.concat(Array.prototype.slice.call(I[ge]));if(be=[Ht.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(S.width&65280)>>8,S.width&255,(S.height&65280)>>8,S.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),g(Ht.avcC,new Uint8Array([1,S.profileIdc,S.profileCompatibility,S.levelIdc,255].concat([E.length],M,[I.length],ue))),g(Ht.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],S.sarRatio){var xe=S.sarRatio[0],Oe=S.sarRatio[1];be.push(g(Ht.pasp,new Uint8Array([(xe&4278190080)>>24,(xe&16711680)>>16,(xe&65280)>>8,xe&255,(Oe&4278190080)>>24,(Oe&16711680)>>16,(Oe&65280)>>8,Oe&255])))}return g.apply(null,be)},b=function(S){return g(Ht.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(S.channelcount&65280)>>8,S.channelcount&255,(S.samplesize&65280)>>8,S.samplesize&255,0,0,0,0,(S.samplerate&65280)>>8,S.samplerate&255,0,0]),N(S))}}(),ct=function(m){var b=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(m.id&4278190080)>>24,(m.id&16711680)>>16,(m.id&65280)>>8,m.id&255,0,0,0,0,(m.duration&4278190080)>>24,(m.duration&16711680)>>16,(m.duration&65280)>>8,m.duration&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(m.width&65280)>>8,m.width&255,0,0,(m.height&65280)>>8,m.height&255,0,0]);return g(Ht.tkhd,b)},nn=function(m){var b,S,E,I,M,ue,ge;return b=g(Ht.tfhd,new Uint8Array([0,0,0,58,(m.id&4278190080)>>24,(m.id&16711680)>>16,(m.id&65280)>>8,m.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),ue=Math.floor(m.baseMediaDecodeTime/h),ge=Math.floor(m.baseMediaDecodeTime%h),S=g(Ht.tfdt,new Uint8Array([1,0,0,0,ue>>>24&255,ue>>>16&255,ue>>>8&255,ue&255,ge>>>24&255,ge>>>16&255,ge>>>8&255,ge&255])),M=32+20+8+16+8+8,m.type==="audio"?(E=rn(m,M),g(Ht.traf,b,S,E)):(I=jt(m),E=rn(m,I.length+M),g(Ht.traf,b,S,E,I))},qe=function(m){return m.duration=m.duration||4294967295,g(Ht.trak,ct(m),Je(m))},qn=function(m){var b=new Uint8Array([0,0,0,0,(m.id&4278190080)>>24,(m.id&16711680)>>16,(m.id&65280)>>8,m.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return m.type!=="video"&&(b[b.length-1]=0),g(Ht.trex,b)},function(){var m,b,S;S=function(E,I){var M=0,ue=0,ge=0,be=0;return E.length&&(E[0].duration!==void 0&&(M=1),E[0].size!==void 0&&(ue=2),E[0].flags!==void 0&&(ge=4),E[0].compositionTimeOffset!==void 0&&(be=8)),[0,0,M|ue|ge|be,1,(E.length&4278190080)>>>24,(E.length&16711680)>>>16,(E.length&65280)>>>8,E.length&255,(I&4278190080)>>>24,(I&16711680)>>>16,(I&65280)>>>8,I&255]},b=function(E,I){var M,ue,ge,be,xe,Oe;for(be=E.samples||[],I+=8+12+16*be.length,ge=S(be,I),ue=new Uint8Array(ge.length+be.length*16),ue.set(ge),M=ge.length,Oe=0;Oe<be.length;Oe++)xe=be[Oe],ue[M++]=(xe.duration&4278190080)>>>24,ue[M++]=(xe.duration&16711680)>>>16,ue[M++]=(xe.duration&65280)>>>8,ue[M++]=xe.duration&255,ue[M++]=(xe.size&4278190080)>>>24,ue[M++]=(xe.size&16711680)>>>16,ue[M++]=(xe.size&65280)>>>8,ue[M++]=xe.size&255,ue[M++]=xe.flags.isLeading<<2|xe.flags.dependsOn,ue[M++]=xe.flags.isDependedOn<<6|xe.flags.hasRedundancy<<4|xe.flags.paddingValue<<1|xe.flags.isNonSyncSample,ue[M++]=xe.flags.degradationPriority&240<<8,ue[M++]=xe.flags.degradationPriority&15,ue[M++]=(xe.compositionTimeOffset&4278190080)>>>24,ue[M++]=(xe.compositionTimeOffset&16711680)>>>16,ue[M++]=(xe.compositionTimeOffset&65280)>>>8,ue[M++]=xe.compositionTimeOffset&255;return g(Ht.trun,ue)},m=function(E,I){var M,ue,ge,be,xe,Oe;for(be=E.samples||[],I+=8+12+8*be.length,ge=S(be,I),M=new Uint8Array(ge.length+be.length*8),M.set(ge),ue=ge.length,Oe=0;Oe<be.length;Oe++)xe=be[Oe],M[ue++]=(xe.duration&4278190080)>>>24,M[ue++]=(xe.duration&16711680)>>>16,M[ue++]=(xe.duration&65280)>>>8,M[ue++]=xe.duration&255,M[ue++]=(xe.size&4278190080)>>>24,M[ue++]=(xe.size&16711680)>>>16,M[ue++]=(xe.size&65280)>>>8,M[ue++]=xe.size&255;return g(Ht.trun,M)},rn=function(E,I){return E.type==="audio"?m(E,I):b(E,I)}}();var Cg={ftyp:Y,mdat:me,moof:Ae,moov:$e,initSegment:function(m){var b=Y(),S=$e(m),E;return E=new Uint8Array(b.byteLength+S.byteLength),E.set(b),E.set(S,b.byteLength),E}},wg=function(m){var b,S,E=[],I=[];for(I.byteLength=0,I.nalCount=0,I.duration=0,E.byteLength=0,b=0;b<m.length;b++)S=m[b],S.nalUnitType==="access_unit_delimiter_rbsp"?(E.length&&(E.duration=S.dts-E.dts,I.byteLength+=E.byteLength,I.nalCount+=E.length,I.duration+=E.duration,I.push(E)),E=[S],E.byteLength=S.data.byteLength,E.pts=S.pts,E.dts=S.dts):(S.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"&&(E.keyFrame=!0),E.duration=S.dts-E.dts,E.byteLength+=S.data.byteLength,E.push(S));return I.length&&(!E.duration||E.duration<=0)&&(E.duration=I[I.length-1].duration),I.byteLength+=E.byteLength,I.nalCount+=E.length,I.duration+=E.duration,I.push(E),I},Lg=function(m){var b,S,E=[],I=[];for(E.byteLength=0,E.nalCount=0,E.duration=0,E.pts=m[0].pts,E.dts=m[0].dts,I.byteLength=0,I.nalCount=0,I.duration=0,I.pts=m[0].pts,I.dts=m[0].dts,b=0;b<m.length;b++)S=m[b],S.keyFrame?(E.length&&(I.push(E),I.byteLength+=E.byteLength,I.nalCount+=E.nalCount,I.duration+=E.duration),E=[S],E.nalCount=S.length,E.byteLength=S.byteLength,E.pts=S.pts,E.dts=S.dts,E.duration=S.duration):(E.duration+=S.duration,E.nalCount+=S.length,E.byteLength+=S.byteLength,E.push(S));return I.length&&E.duration<=0&&(E.duration=I[I.length-1].duration),I.byteLength+=E.byteLength,I.nalCount+=E.nalCount,I.duration+=E.duration,I.push(E),I},kg=function(m){var b;return!m[0][0].keyFrame&&m.length>1&&(b=m.shift(),m.byteLength-=b.byteLength,m.nalCount-=b.nalCount,m[0][0].dts=b.dts,m[0][0].pts=b.pts,m[0][0].duration+=b.duration),m},Dg=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},jf=function(m,b){var S=Dg();return S.dataOffset=b,S.compositionTimeOffset=m.pts-m.dts,S.duration=m.duration,S.size=4*m.length,S.size+=m.byteLength,m.keyFrame&&(S.flags.dependsOn=2,S.flags.isNonSyncSample=0),S},Ig=function(m,b){var S,E,I,M,ue,ge=b||0,be=[];for(S=0;S<m.length;S++)for(M=m[S],E=0;E<M.length;E++)ue=M[E],I=jf(ue,ge),ge+=I.size,be.push(I);return be},Rg=function(m){var b,S,E,I,M,ue,ge=0,be=m.byteLength,xe=m.nalCount,Oe=be+4*xe,Ke=new Uint8Array(Oe),kt=new DataView(Ke.buffer);for(b=0;b<m.length;b++)for(I=m[b],S=0;S<I.length;S++)for(M=I[S],E=0;E<M.length;E++)ue=M[E],kt.setUint32(ge,ue.data.byteLength),ge+=4,Ke.set(ue.data,ge),ge+=ue.data.byteLength;return Ke},Og=function(m,b){var S,E=b||0,I=[];return S=jf(m,E),I.push(S),I},Pg=function(m){var b,S,E=0,I=m.byteLength,M=m.length,ue=I+4*M,ge=new Uint8Array(ue),be=new DataView(ge.buffer);for(b=0;b<m.length;b++)S=m[b],be.setUint32(E,S.data.byteLength),E+=4,ge.set(S.data,E),E+=S.data.byteLength;return ge},Bg={groupNalsIntoFrames:wg,groupFramesIntoGops:Lg,extendFirstKeyFrame:kg,generateSampleTable:Ig,concatenateNalData:Rg,generateSampleTableForFrame:Og,concatenateNalDataForFrame:Pg},Ca=[33,16,5,32,164,27],_c=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],Li=function(m){for(var b=[];m--;)b.push(0);return b},Mg=function(m){return Object.keys(m).reduce(function(b,S){return b[S]=new Uint8Array(m[S].reduce(function(E,I){return E.concat(I)},[])),b},{})},xc,Fg=function(){if(!xc){var m={96e3:[Ca,[227,64],Li(154),[56]],88200:[Ca,[231],Li(170),[56]],64e3:[Ca,[248,192],Li(240),[56]],48e3:[Ca,[255,192],Li(268),[55,148,128],Li(54),[112]],44100:[Ca,[255,192],Li(268),[55,163,128],Li(84),[112]],32e3:[Ca,[255,192],Li(268),[55,234],Li(226),[112]],24e3:[Ca,[255,192],Li(268),[55,255,128],Li(268),[111,112],Li(126),[224]],16e3:[Ca,[255,192],Li(268),[55,255,128],Li(268),[111,255],Li(269),[223,108],Li(195),[1,192]],12e3:[_c,Li(268),[3,127,248],Li(268),[6,255,240],Li(268),[13,255,224],Li(268),[27,253,128],Li(259),[56]],11025:[_c,Li(268),[3,127,248],Li(268),[6,255,240],Li(268),[13,255,224],Li(268),[27,255,192],Li(268),[55,175,128],Li(108),[112]],8e3:[_c,Li(268),[3,121,16],Li(47),[7]]};xc=Mg(m)}return xc},Ec=9e4,Tc,Sc,rd,Cc,$f,Vf,Hf;Tc=function(m){return m*Ec},Sc=function(m,b){return m*b},rd=function(m){return m/Ec},Cc=function(m,b){return m/b},$f=function(m,b){return Tc(Cc(m,b))},Vf=function(m,b){return Sc(rd(m),b)},Hf=function(m,b,S){return rd(S?m:m-b)};var Wi={ONE_SECOND_IN_TS:Ec,secondsToVideoTs:Tc,secondsToAudioTs:Sc,videoTsToSeconds:rd,audioTsToSeconds:Cc,audioTsToVideoTs:$f,videoTsToAudioTs:Vf,metadataTsToSeconds:Hf},Ng=Fg,sd=Wi,Ug=function(m){var b,S,E=0;for(b=0;b<m.length;b++)S=m[b],E+=S.data.byteLength;return E},jg=function(m,b,S,E){var I,M=0,ue=0,ge=0,be=0,xe,Oe,Ke;if(!!b.length&&(I=sd.audioTsToVideoTs(m.baseMediaDecodeTime,m.samplerate),M=Math.ceil(sd.ONE_SECOND_IN_TS/(m.samplerate/1024)),S&&E&&(ue=I-Math.max(S,E),ge=Math.floor(ue/M),be=ge*M),!(ge<1||be>sd.ONE_SECOND_IN_TS/2))){for(xe=Ng()[m.samplerate],xe||(xe=b[0].data),Oe=0;Oe<ge;Oe++)Ke=b[0],b.splice(0,0,{data:xe,dts:Ke.dts-M,pts:Ke.pts-M});return m.baseMediaDecodeTime-=Math.floor(sd.videoTsToAudioTs(be,m.samplerate)),be}},$g=function(m,b,S){return b.minSegmentDts>=S?m:(b.minSegmentDts=Infinity,m.filter(function(E){return E.dts>=S?(b.minSegmentDts=Math.min(b.minSegmentDts,E.dts),b.minSegmentPts=b.minSegmentDts,!0):!1}))},Vg=function(m){var b,S,E=[];for(b=0;b<m.length;b++)S=m[b],E.push({size:S.data.byteLength,duration:1024});return E},Hg=function(m){var b,S,E=0,I=new Uint8Array(Ug(m));for(b=0;b<m.length;b++)S=m[b],I.set(S.data,E),E+=S.data.byteLength;return I},Gg={prefixWithSilence:jg,trimAdtsFramesByEarliestDts:$g,generateSampleTable:Vg,concatenateFrameData:Hg},qg=Wi.ONE_SECOND_IN_TS,Wg=function(m,b){typeof b.pts=="number"&&(m.timelineStartInfo.pts===void 0&&(m.timelineStartInfo.pts=b.pts),m.minSegmentPts===void 0?m.minSegmentPts=b.pts:m.minSegmentPts=Math.min(m.minSegmentPts,b.pts),m.maxSegmentPts===void 0?m.maxSegmentPts=b.pts:m.maxSegmentPts=Math.max(m.maxSegmentPts,b.pts)),typeof b.dts=="number"&&(m.timelineStartInfo.dts===void 0&&(m.timelineStartInfo.dts=b.dts),m.minSegmentDts===void 0?m.minSegmentDts=b.dts:m.minSegmentDts=Math.min(m.minSegmentDts,b.dts),m.maxSegmentDts===void 0?m.maxSegmentDts=b.dts:m.maxSegmentDts=Math.max(m.maxSegmentDts,b.dts))},Kg=function(m){delete m.minSegmentDts,delete m.maxSegmentDts,delete m.minSegmentPts,delete m.maxSegmentPts},zg=function(m,b){var S,E,I=m.minSegmentDts;return b||(I-=m.timelineStartInfo.dts),S=m.timelineStartInfo.baseMediaDecodeTime,S+=I,S=Math.max(0,S),m.type==="audio"&&(E=m.samplerate/qg,S*=E,S=Math.floor(S)),S},Yg={clearDtsInfo:Kg,calculateTrackBaseMediaDecodeTime:zg,collectDtsInfo:Wg},Gf=4,Xg=128,Qg=function(m){for(var b=0,S={payloadType:-1,payloadSize:0},E=0,I=0;b<m.byteLength&&m[b]!==Xg;){for(;m[b]===255;)E+=255,b++;for(E+=m[b++];m[b]===255;)I+=255,b++;if(I+=m[b++],!S.payload&&E===Gf){var M=String.fromCharCode(m[b+3],m[b+4],m[b+5],m[b+6]);if(M==="GA94"){S.payloadType=E,S.payloadSize=I,S.payload=m.subarray(b,b+I);break}else S.payload=void 0}b+=I,E=0,I=0}return S},Jg=function(m){return m.payload[0]!==181||(m.payload[1]<<8|m.payload[2])!=49||String.fromCharCode(m.payload[3],m.payload[4],m.payload[5],m.payload[6])!=="GA94"||m.payload[7]!==3?null:m.payload.subarray(8,m.payload.length-1)},Zg=function(m,b){var S=[],E,I,M,ue;if(!(b[0]&64))return S;for(I=b[0]&31,E=0;E<I;E++)M=E*3,ue={type:b[M+2]&3,pts:m},b[M+2]&4&&(ue.ccData=b[M+3]<<8|b[M+4],S.push(ue));return S},ey=function(m){for(var b=m.byteLength,S=[],E=1,I,M;E<b-2;)m[E]===0&&m[E+1]===0&&m[E+2]===3?(S.push(E+2),E+=2):E++;if(S.length===0)return m;I=b-S.length,M=new Uint8Array(I);var ue=0;for(E=0;E<I;ue++,E++)ue===S[0]&&(ue++,S.shift()),M[E]=m[ue];return M},qf={parseSei:Qg,parseUserData:Jg,parseCaptionPackets:Zg,discardEmulationPreventionBytes:ey,USER_DATA_REGISTERED_ITU_T_T35:Gf},wc=i,ad=qf,fr=function(m){m=m||{},fr.prototype.init.call(this),this.parse708captions_=typeof m.parse708captions=="boolean"?m.parse708captions:!0,this.captionPackets_=[],this.ccStreams_=[new Xi(0,0),new Xi(0,1),new Xi(1,0),new Xi(1,1)],this.parse708captions_&&(this.cc708Stream_=new Mi({captionServices:m.captionServices})),this.reset(),this.ccStreams_.forEach(function(b){b.on("data",this.trigger.bind(this,"data")),b.on("partialdone",this.trigger.bind(this,"partialdone")),b.on("done",this.trigger.bind(this,"done"))},this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))};fr.prototype=new wc,fr.prototype.push=function(m){var b,S,E;if(m.nalUnitType==="sei_rbsp"&&(b=ad.parseSei(m.escapedRBSP),!!b.payload&&b.payloadType===ad.USER_DATA_REGISTERED_ITU_T_T35&&(S=ad.parseUserData(b),!!S))){if(m.dts<this.latestDts_){this.ignoreNextEqualDts_=!0;return}else if(m.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--,this.numSameDts_||(this.ignoreNextEqualDts_=!1);return}E=ad.parseCaptionPackets(m.pts,S),this.captionPackets_=this.captionPackets_.concat(E),this.latestDts_!==m.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=m.dts}},fr.prototype.flushCCStreams=function(m){this.ccStreams_.forEach(function(b){return m==="flush"?b.flush():b.partialFlush()},this)},fr.prototype.flushStream=function(m){if(!this.captionPackets_.length){this.flushCCStreams(m);return}this.captionPackets_.forEach(function(b,S){b.presortIndex=S}),this.captionPackets_.sort(function(b,S){return b.pts===S.pts?b.presortIndex-S.presortIndex:b.pts-S.pts}),this.captionPackets_.forEach(function(b){b.type<2?this.dispatchCea608Packet(b):this.dispatchCea708Packet(b)},this),this.captionPackets_.length=0,this.flushCCStreams(m)},fr.prototype.flush=function(){return this.flushStream("flush")},fr.prototype.partialFlush=function(){return this.flushStream("partialFlush")},fr.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(m){m.reset()})},fr.prototype.dispatchCea608Packet=function(m){this.setsTextOrXDSActive(m)?this.activeCea608Channel_[m.type]=null:this.setsChannel1Active(m)?this.activeCea608Channel_[m.type]=0:this.setsChannel2Active(m)&&(this.activeCea608Channel_[m.type]=1),this.activeCea608Channel_[m.type]!==null&&this.ccStreams_[(m.type<<1)+this.activeCea608Channel_[m.type]].push(m)},fr.prototype.setsChannel1Active=function(m){return(m.ccData&30720)==4096},fr.prototype.setsChannel2Active=function(m){return(m.ccData&30720)==6144},fr.prototype.setsTextOrXDSActive=function(m){return(m.ccData&28928)==256||(m.ccData&30974)==4138||(m.ccData&30974)==6186},fr.prototype.dispatchCea708Packet=function(m){this.parse708captions_&&this.cc708Stream_.push(m)};var ty={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},iy=function(m){var b=ty[m]||m;return m&4096&&m===b?"":String.fromCharCode(b)},od=function(m){return 32<=m&&m<=127||160<=m&&m<=255},Js=function(m){this.windowNum=m,this.reset()};Js.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},Js.prototype.getText=function(){return this.rows.join(`
`)},Js.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},Js.prototype.newLine=function(m){for(this.rows.length>=this.virtualRowCount&&typeof this.beforeRowOverflow=="function"&&this.beforeRowOverflow(m),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},Js.prototype.isEmpty=function(){return this.rows.length===0?!0:this.rows.length===1?this.rows[0]==="":!1},Js.prototype.addText=function(m){this.rows[this.rowIdx]+=m},Js.prototype.backspace=function(){if(!this.isEmpty()){var m=this.rows[this.rowIdx];this.rows[this.rowIdx]=m.substr(0,m.length-1)}};var ld=function(m,b,S){this.serviceNum=m,this.text="",this.currentWindow=new Js(-1),this.windows=[],this.stream=S,typeof b=="string"&&this.createTextDecoder(b)};ld.prototype.init=function(m,b){this.startPts=m;for(var S=0;S<8;S++)this.windows[S]=new Js(S),typeof b=="function"&&(this.windows[S].beforeRowOverflow=b)},ld.prototype.setCurrentWindow=function(m){this.currentWindow=this.windows[m]},ld.prototype.createTextDecoder=function(m){if(typeof TextDecoder=="undefined")this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(m)}catch(b){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+m+" encoding. "+b})}};var Mi=function(m){m=m||{},Mi.prototype.init.call(this);var b=this,S=m.captionServices||{},E={},I;Object.keys(S).forEach(M=>{I=S[M],/^SERVICE/.test(M)&&(E[M]=I.encoding)}),this.serviceEncodings=E,this.current708Packet=null,this.services={},this.push=function(M){M.type===3?(b.new708Packet(),b.add708Bytes(M)):(b.current708Packet===null&&b.new708Packet(),b.add708Bytes(M))}};Mi.prototype=new wc,Mi.prototype.new708Packet=function(){this.current708Packet!==null&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},Mi.prototype.add708Bytes=function(m){var b=m.ccData,S=b>>>8,E=b&255;this.current708Packet.ptsVals.push(m.pts),this.current708Packet.data.push(S),this.current708Packet.data.push(E)},Mi.prototype.push708Packet=function(){var m=this.current708Packet,b=m.data,S=null,E=null,I=0,M=b[I++];for(m.seq=M>>6,m.sizeCode=M&63;I<b.length;I++)M=b[I++],S=M>>5,E=M&31,S===7&&E>0&&(M=b[I++],S=M),this.pushServiceBlock(S,I,E),E>0&&(I+=E-1)},Mi.prototype.pushServiceBlock=function(m,b,S){var E,I=b,M=this.current708Packet.data,ue=this.services[m];for(ue||(ue=this.initService(m,I));I<b+S&&I<M.length;I++)E=M[I],od(E)?I=this.handleText(I,ue):E===24?I=this.multiByteCharacter(I,ue):E===16?I=this.extendedCommands(I,ue):128<=E&&E<=135?I=this.setCurrentWindow(I,ue):152<=E&&E<=159?I=this.defineWindow(I,ue):E===136?I=this.clearWindows(I,ue):E===140?I=this.deleteWindows(I,ue):E===137?I=this.displayWindows(I,ue):E===138?I=this.hideWindows(I,ue):E===139?I=this.toggleWindows(I,ue):E===151?I=this.setWindowAttributes(I,ue):E===144?I=this.setPenAttributes(I,ue):E===145?I=this.setPenColor(I,ue):E===146?I=this.setPenLocation(I,ue):E===143?ue=this.reset(I,ue):E===8?ue.currentWindow.backspace():E===12?ue.currentWindow.clearText():E===13?ue.currentWindow.pendingNewLine=!0:E===14?ue.currentWindow.clearText():E===141&&I++},Mi.prototype.extendedCommands=function(m,b){var S=this.current708Packet.data,E=S[++m];return od(E)&&(m=this.handleText(m,b,{isExtended:!0})),m},Mi.prototype.getPts=function(m){return this.current708Packet.ptsVals[Math.floor(m/2)]},Mi.prototype.initService=function(m,b){var S="SERVICE"+m,E=this,S,I;return S in this.serviceEncodings&&(I=this.serviceEncodings[S]),this.services[m]=new ld(m,I,E),this.services[m].init(this.getPts(b),function(M){E.flushDisplayed(M,E.services[m])}),this.services[m]},Mi.prototype.handleText=function(m,b,S){var E=S&&S.isExtended,I=S&&S.isMultiByte,M=this.current708Packet.data,ue=E?4096:0,ge=M[m],be=M[m+1],xe=b.currentWindow,Oe,Ke;function kt(at){return at.map(zt=>("0"+(zt&255).toString(16)).slice(-2)).join("")}if(I?(Ke=[ge,be],m++):Ke=[ge],b.textDecoder_&&!E)Oe=b.textDecoder_.decode(new Uint8Array(Ke));else if(I){const at=kt(Ke);Oe=String.fromCharCode(parseInt(at,16))}else Oe=iy(ue|ge);return xe.pendingNewLine&&!xe.isEmpty()&&xe.newLine(this.getPts(m)),xe.pendingNewLine=!1,xe.addText(Oe),m},Mi.prototype.multiByteCharacter=function(m,b){var S=this.current708Packet.data,E=S[m+1],I=S[m+2];return od(E)&&od(I)&&(m=this.handleText(++m,b,{isMultiByte:!0})),m},Mi.prototype.setCurrentWindow=function(m,b){var S=this.current708Packet.data,E=S[m],I=E&7;return b.setCurrentWindow(I),m},Mi.prototype.defineWindow=function(m,b){var S=this.current708Packet.data,E=S[m],I=E&7;b.setCurrentWindow(I);var M=b.currentWindow;return E=S[++m],M.visible=(E&32)>>5,M.rowLock=(E&16)>>4,M.columnLock=(E&8)>>3,M.priority=E&7,E=S[++m],M.relativePositioning=(E&128)>>7,M.anchorVertical=E&127,E=S[++m],M.anchorHorizontal=E,E=S[++m],M.anchorPoint=(E&240)>>4,M.rowCount=E&15,E=S[++m],M.columnCount=E&63,E=S[++m],M.windowStyle=(E&56)>>3,M.penStyle=E&7,M.virtualRowCount=M.rowCount+1,m},Mi.prototype.setWindowAttributes=function(m,b){var S=this.current708Packet.data,E=S[m],I=b.currentWindow.winAttr;return E=S[++m],I.fillOpacity=(E&192)>>6,I.fillRed=(E&48)>>4,I.fillGreen=(E&12)>>2,I.fillBlue=E&3,E=S[++m],I.borderType=(E&192)>>6,I.borderRed=(E&48)>>4,I.borderGreen=(E&12)>>2,I.borderBlue=E&3,E=S[++m],I.borderType+=(E&128)>>5,I.wordWrap=(E&64)>>6,I.printDirection=(E&48)>>4,I.scrollDirection=(E&12)>>2,I.justify=E&3,E=S[++m],I.effectSpeed=(E&240)>>4,I.effectDirection=(E&12)>>2,I.displayEffect=E&3,m},Mi.prototype.flushDisplayed=function(m,b){for(var S=[],E=0;E<8;E++)b.windows[E].visible&&!b.windows[E].isEmpty()&&S.push(b.windows[E].getText());b.endPts=m,b.text=S.join(`

`),this.pushCaption(b),b.startPts=m},Mi.prototype.pushCaption=function(m){m.text!==""&&(this.trigger("data",{startPts:m.startPts,endPts:m.endPts,text:m.text,stream:"cc708_"+m.serviceNum}),m.text="",m.startPts=m.endPts)},Mi.prototype.displayWindows=function(m,b){var S=this.current708Packet.data,E=S[++m],I=this.getPts(m);this.flushDisplayed(I,b);for(var M=0;M<8;M++)E&1<<M&&(b.windows[M].visible=1);return m},Mi.prototype.hideWindows=function(m,b){var S=this.current708Packet.data,E=S[++m],I=this.getPts(m);this.flushDisplayed(I,b);for(var M=0;M<8;M++)E&1<<M&&(b.windows[M].visible=0);return m},Mi.prototype.toggleWindows=function(m,b){var S=this.current708Packet.data,E=S[++m],I=this.getPts(m);this.flushDisplayed(I,b);for(var M=0;M<8;M++)E&1<<M&&(b.windows[M].visible^=1);return m},Mi.prototype.clearWindows=function(m,b){var S=this.current708Packet.data,E=S[++m],I=this.getPts(m);this.flushDisplayed(I,b);for(var M=0;M<8;M++)E&1<<M&&b.windows[M].clearText();return m},Mi.prototype.deleteWindows=function(m,b){var S=this.current708Packet.data,E=S[++m],I=this.getPts(m);this.flushDisplayed(I,b);for(var M=0;M<8;M++)E&1<<M&&b.windows[M].reset();return m},Mi.prototype.setPenAttributes=function(m,b){var S=this.current708Packet.data,E=S[m],I=b.currentWindow.penAttr;return E=S[++m],I.textTag=(E&240)>>4,I.offset=(E&12)>>2,I.penSize=E&3,E=S[++m],I.italics=(E&128)>>7,I.underline=(E&64)>>6,I.edgeType=(E&56)>>3,I.fontStyle=E&7,m},Mi.prototype.setPenColor=function(m,b){var S=this.current708Packet.data,E=S[m],I=b.currentWindow.penColor;return E=S[++m],I.fgOpacity=(E&192)>>6,I.fgRed=(E&48)>>4,I.fgGreen=(E&12)>>2,I.fgBlue=E&3,E=S[++m],I.bgOpacity=(E&192)>>6,I.bgRed=(E&48)>>4,I.bgGreen=(E&12)>>2,I.bgBlue=E&3,E=S[++m],I.edgeRed=(E&48)>>4,I.edgeGreen=(E&12)>>2,I.edgeBlue=E&3,m},Mi.prototype.setPenLocation=function(m,b){var S=this.current708Packet.data,E=S[m],I=b.currentWindow.penLoc;return b.currentWindow.pendingNewLine=!0,E=S[++m],I.row=E&15,E=S[++m],I.column=E&63,m},Mi.prototype.reset=function(m,b){var S=this.getPts(m);return this.flushDisplayed(S,b),this.initService(b.serviceNum,m)};var ny={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},ud=function(m){return m===null?"":(m=ny[m]||m,String.fromCharCode(m))},dd=14,ry=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],ao=function(){for(var m=[],b=dd+1;b--;)m.push({text:"",indent:0,offset:0});return m},Xi=function(m,b){Xi.prototype.init.call(this),this.field_=m||0,this.dataChannel_=b||0,this.name_="CC"+((this.field_<<1|this.dataChannel_)+1),this.setConstants(),this.reset(),this.push=function(S){var E,I,M,ue,ge;if(E=S.ccData&32639,E===this.lastControlCode_){this.lastControlCode_=null;return}if((E&61440)==4096?this.lastControlCode_=E:E!==this.PADDING_&&(this.lastControlCode_=null),M=E>>>8,ue=E&255,E!==this.PADDING_)if(E===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(E===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(S.pts),this.flushDisplayed(S.pts),I=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=I,this.startPts_=S.pts;else if(E===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(S.pts);else if(E===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(S.pts);else if(E===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(S.pts);else if(E===this.CARRIAGE_RETURN_)this.clearFormatting(S.pts),this.flushDisplayed(S.pts),this.shiftRowsUp_(),this.startPts_=S.pts;else if(E===this.BACKSPACE_)this.mode_==="popOn"?this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1):this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1);else if(E===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(S.pts),this.displayed_=ao();else if(E===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=ao();else if(E===this.RESUME_DIRECT_CAPTIONING_)this.mode_!=="paintOn"&&(this.flushDisplayed(S.pts),this.displayed_=ao()),this.mode_="paintOn",this.startPts_=S.pts;else if(this.isSpecialCharacter(M,ue))M=(M&3)<<8,ge=ud(M|ue),this[this.mode_](S.pts,ge),this.column_++;else if(this.isExtCharacter(M,ue))this.mode_==="popOn"?this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1):this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1),M=(M&3)<<8,ge=ud(M|ue),this[this.mode_](S.pts,ge),this.column_++;else if(this.isMidRowCode(M,ue))this.clearFormatting(S.pts),this[this.mode_](S.pts," "),this.column_++,(ue&14)==14&&this.addFormatting(S.pts,["i"]),(ue&1)==1&&this.addFormatting(S.pts,["u"]);else if(this.isOffsetControlCode(M,ue)){const xe=ue&3;this.nonDisplayed_[this.row_].offset=xe,this.column_+=xe}else if(this.isPAC(M,ue)){var be=ry.indexOf(E&7968);if(this.mode_==="rollUp"&&(be-this.rollUpRows_+1<0&&(be=this.rollUpRows_-1),this.setRollUp(S.pts,be)),be!==this.row_&&(this.clearFormatting(S.pts),this.row_=be),ue&1&&this.formatting_.indexOf("u")===-1&&this.addFormatting(S.pts,["u"]),(E&16)==16){const xe=(E&14)>>1;this.column_=xe*4,this.nonDisplayed_[this.row_].indent+=xe}this.isColorPAC(ue)&&(ue&14)==14&&this.addFormatting(S.pts,["i"])}else this.isNormalChar(M)&&(ue===0&&(ue=null),ge=ud(M),ge+=ud(ue),this[this.mode_](S.pts,ge),this.column_+=ge.length)}};Xi.prototype=new wc,Xi.prototype.flushDisplayed=function(m){const b=E=>{this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+E+"."})},S=[];this.displayed_.forEach((E,I)=>{if(E&&E.text&&E.text.length){try{E.text=E.text.trim()}catch(M){b(I)}E.text.length&&S.push({text:E.text,line:I+1,position:10+Math.min(70,E.indent*10)+E.offset*2.5})}else E==null&&b(I)}),S.length&&this.trigger("data",{startPts:this.startPts_,endPts:m,content:S,stream:this.name_})},Xi.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=ao(),this.nonDisplayed_=ao(),this.lastControlCode_=null,this.column_=0,this.row_=dd,this.rollUpRows_=2,this.formatting_=[]},Xi.prototype.setConstants=function(){this.dataChannel_===0?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):this.dataChannel_===1&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=this.CONTROL_|32,this.END_OF_CAPTION_=this.CONTROL_|47,this.ROLL_UP_2_ROWS_=this.CONTROL_|37,this.ROLL_UP_3_ROWS_=this.CONTROL_|38,this.ROLL_UP_4_ROWS_=this.CONTROL_|39,this.CARRIAGE_RETURN_=this.CONTROL_|45,this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|41,this.BACKSPACE_=this.CONTROL_|33,this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44,this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46},Xi.prototype.isSpecialCharacter=function(m,b){return m===this.EXT_&&b>=48&&b<=63},Xi.prototype.isExtCharacter=function(m,b){return(m===this.EXT_+1||m===this.EXT_+2)&&b>=32&&b<=63},Xi.prototype.isMidRowCode=function(m,b){return m===this.EXT_&&b>=32&&b<=47},Xi.prototype.isOffsetControlCode=function(m,b){return m===this.OFFSET_&&b>=33&&b<=35},Xi.prototype.isPAC=function(m,b){return m>=this.BASE_&&m<this.BASE_+8&&b>=64&&b<=127},Xi.prototype.isColorPAC=function(m){return m>=64&&m<=79||m>=96&&m<=127},Xi.prototype.isNormalChar=function(m){return m>=32&&m<=127},Xi.prototype.setRollUp=function(m,b){if(this.mode_!=="rollUp"&&(this.row_=dd,this.mode_="rollUp",this.flushDisplayed(m),this.nonDisplayed_=ao(),this.displayed_=ao()),b!==void 0&&b!==this.row_)for(var S=0;S<this.rollUpRows_;S++)this.displayed_[b-S]=this.displayed_[this.row_-S],this.displayed_[this.row_-S]={text:"",indent:0,offset:0};b===void 0&&(b=this.row_),this.topRow_=b-this.rollUpRows_+1},Xi.prototype.addFormatting=function(m,b){this.formatting_=this.formatting_.concat(b);var S=b.reduce(function(E,I){return E+"<"+I+">"},"");this[this.mode_](m,S)},Xi.prototype.clearFormatting=function(m){if(!!this.formatting_.length){var b=this.formatting_.reverse().reduce(function(S,E){return S+"</"+E+">"},"");this.formatting_=[],this[this.mode_](m,b)}},Xi.prototype.popOn=function(m,b){var S=this.nonDisplayed_[this.row_].text;S+=b,this.nonDisplayed_[this.row_].text=S},Xi.prototype.rollUp=function(m,b){var S=this.displayed_[this.row_].text;S+=b,this.displayed_[this.row_].text=S},Xi.prototype.shiftRowsUp_=function(){var m;for(m=0;m<this.topRow_;m++)this.displayed_[m]={text:"",indent:0,offset:0};for(m=this.row_+1;m<dd+1;m++)this.displayed_[m]={text:"",indent:0,offset:0};for(m=this.topRow_;m<this.row_;m++)this.displayed_[m]=this.displayed_[m+1];this.displayed_[this.row_]={text:"",indent:0,offset:0}},Xi.prototype.paintOn=function(m,b){var S=this.displayed_[this.row_].text;S+=b,this.displayed_[this.row_].text=S};var Wf={CaptionStream:fr,Cea608Stream:Xi,Cea708Stream:Mi},cd={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},sy=i,ay=8589934592,oy=4294967296,Kf="shared",Lc=function(m,b){var S=1;for(m>b&&(S=-1);Math.abs(b-m)>oy;)m+=S*ay;return m},kc=function(m){var b,S;kc.prototype.init.call(this),this.type_=m||Kf,this.push=function(E){this.type_!==Kf&&E.type!==this.type_||(S===void 0&&(S=E.dts),E.dts=Lc(E.dts,S),E.pts=Lc(E.pts,S),b=E.dts,this.trigger("data",E))},this.flush=function(){S=b,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){S=void 0,b=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};kc.prototype=new sy;var zf={TimestampRolloverStream:kc,handleRollover:Lc},ly=(m,b,S)=>{if(!m)return-1;for(var E=S;E<m.length;E++)if(m[E]===b)return E;return-1},uy={typedArrayIndexOf:ly},hd=uy.typedArrayIndexOf,fd={Iso88591:0,Utf16:1,Utf16be:2,Utf8:3},Yf=function(m,b,S){var E,I="";for(E=b;E<S;E++)I+="%"+("00"+m[E].toString(16)).slice(-2);return I},tu=function(m,b,S){return decodeURIComponent(Yf(m,b,S))},iu=function(m,b,S){return unescape(Yf(m,b,S))},nu=function(m){return m[0]<<21|m[1]<<14|m[2]<<7|m[3]},ru={APIC:function(m){var b=1,S,E,I="-->";m.data[0]===fd.Utf8&&(S=hd(m.data,0,b),!(S<0)&&(m.mimeType=iu(m.data,b,S),b=S+1,m.pictureType=m.data[b],b++,E=hd(m.data,0,b),!(E<0)&&(m.description=tu(m.data,b,E),b=E+1,m.mimeType===I?m.url=iu(m.data,b,m.data.length):m.pictureData=m.data.subarray(b,m.data.length))))},"T*":function(m){m.data[0]===fd.Utf8&&(m.value=tu(m.data,1,m.data.length).replace(/\0*$/,""),m.values=m.value.split("\0"))},TXXX:function(m){var b;m.data[0]===fd.Utf8&&(b=hd(m.data,0,1),b!==-1&&(m.description=tu(m.data,1,b),m.value=tu(m.data,b+1,m.data.length).replace(/\0*$/,""),m.data=m.value))},"W*":function(m){m.url=iu(m.data,0,m.data.length).replace(/\0.*$/,"")},WXXX:function(m){var b;m.data[0]===fd.Utf8&&(b=hd(m.data,0,1),b!==-1&&(m.description=tu(m.data,1,b),m.url=iu(m.data,b+1,m.data.length).replace(/\0.*$/,"")))},PRIV:function(m){var b;for(b=0;b<m.data.length;b++)if(m.data[b]===0){m.owner=iu(m.data,0,b);break}m.privateData=m.data.subarray(b+1),m.data=m.privateData}},dy=function(m){var b,S,E=10,I=0,M=[];if(!(m.length<10||m[0]!=="I".charCodeAt(0)||m[1]!=="D".charCodeAt(0)||m[2]!=="3".charCodeAt(0))){I=nu(m.subarray(6,10)),I+=10;var ue=m[5]&64;ue&&(E+=4,E+=nu(m.subarray(10,14)),I-=nu(m.subarray(16,20)));do{if(b=nu(m.subarray(E+4,E+8)),b<1)break;S=String.fromCharCode(m[E],m[E+1],m[E+2],m[E+3]);var ge={id:S,data:m.subarray(E+10,E+b+10)};ge.key=ge.id,ru[ge.id]?ru[ge.id](ge):ge.id[0]==="T"?ru["T*"](ge):ge.id[0]==="W"&&ru["W*"](ge),M.push(ge),E+=10,E+=b}while(E<I);return M}},Xf={parseId3Frames:dy,parseSyncSafeInteger:nu,frameParsers:ru},cy=i,hy=cd,wa=Xf,pd;pd=function(m){var b={descriptor:m&&m.descriptor},S=0,E=[],I=0,M;if(pd.prototype.init.call(this),this.dispatchType=hy.METADATA_STREAM_TYPE.toString(16),b.descriptor)for(M=0;M<b.descriptor.length;M++)this.dispatchType+=("00"+b.descriptor[M].toString(16)).slice(-2);this.push=function(ue){var ge,be,xe,Oe,Ke,kt;if(ue.type==="timed-metadata"){if(ue.dataAlignmentIndicator&&(I=0,E.length=0),E.length===0&&(ue.data.length<10||ue.data[0]!=="I".charCodeAt(0)||ue.data[1]!=="D".charCodeAt(0)||ue.data[2]!=="3".charCodeAt(0))){this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});return}if(E.push(ue),I+=ue.data.byteLength,E.length===1&&(S=wa.parseSyncSafeInteger(ue.data.subarray(6,10)),S+=10),!(I<S)){for(ge={data:new Uint8Array(S),frames:[],pts:E[0].pts,dts:E[0].dts},Ke=0;Ke<S;)ge.data.set(E[0].data.subarray(0,S-Ke),Ke),Ke+=E[0].data.byteLength,I-=E[0].data.byteLength,E.shift();be=10,ge.data[5]&64&&(be+=4,be+=wa.parseSyncSafeInteger(ge.data.subarray(10,14)),S-=wa.parseSyncSafeInteger(ge.data.subarray(16,20)));do{if(xe=wa.parseSyncSafeInteger(ge.data.subarray(be+4,be+8)),xe<1){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping remaining metadata parsing."});break}if(kt=String.fromCharCode(ge.data[be],ge.data[be+1],ge.data[be+2],ge.data[be+3]),Oe={id:kt,data:ge.data.subarray(be+10,be+xe+10)},Oe.key=Oe.id,wa.frameParsers[Oe.id]?wa.frameParsers[Oe.id](Oe):Oe.id[0]==="T"?wa.frameParsers["T*"](Oe):Oe.id[0]==="W"&&wa.frameParsers["W*"](Oe),Oe.owner==="com.apple.streaming.transportStreamTimestamp"){var at=Oe.data,zt=(at[3]&1)<<30|at[4]<<22|at[5]<<14|at[6]<<6|at[7]>>>2;zt*=4,zt+=at[7]&3,Oe.timeStamp=zt,ge.pts===void 0&&ge.dts===void 0&&(ge.pts=Oe.timeStamp,ge.dts=Oe.timeStamp),this.trigger("timestamp",Oe)}ge.frames.push(Oe),be+=10,be+=xe}while(be<S);this.trigger("data",ge)}}}},pd.prototype=new cy;var fy=pd,Dc=i,Ic=Wf,cs=cd,py=zf.TimestampRolloverStream,md,su,gd,Zo=188,Rc=71;md=function(){var m=new Uint8Array(Zo),b=0;md.prototype.init.call(this),this.push=function(S){var E=0,I=Zo,M;for(b?(M=new Uint8Array(S.byteLength+b),M.set(m.subarray(0,b)),M.set(S,b),b=0):M=S;I<M.byteLength;){if(M[E]===Rc&&M[I]===Rc){this.trigger("data",M.subarray(E,I)),E+=Zo,I+=Zo;continue}E++,I++}E<M.byteLength&&(m.set(M.subarray(E),0),b=M.byteLength-E)},this.flush=function(){b===Zo&&m[0]===Rc&&(this.trigger("data",m),b=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){b=0,this.trigger("reset")}},md.prototype=new Dc,su=function(){var m,b,S,E;su.prototype.init.call(this),E=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,m=function(I,M){var ue=0;M.payloadUnitStartIndicator&&(ue+=I[ue]+1),M.type==="pat"?b(I.subarray(ue),M):S(I.subarray(ue),M)},b=function(I,M){M.section_number=I[7],M.last_section_number=I[8],E.pmtPid=(I[10]&31)<<8|I[11],M.pmtPid=E.pmtPid},S=function(I,M){var ue,ge,be,xe;if(!!(I[5]&1)){for(E.programMapTable={video:null,audio:null,"timed-metadata":{}},ue=(I[1]&15)<<8|I[2],ge=3+ue-4,be=(I[10]&15)<<8|I[11],xe=12+be;xe<ge;){var Oe=I[xe],Ke=(I[xe+1]&31)<<8|I[xe+2];Oe===cs.H264_STREAM_TYPE&&E.programMapTable.video===null?E.programMapTable.video=Ke:Oe===cs.ADTS_STREAM_TYPE&&E.programMapTable.audio===null?E.programMapTable.audio=Ke:Oe===cs.METADATA_STREAM_TYPE&&(E.programMapTable["timed-metadata"][Ke]=Oe),xe+=((I[xe+3]&15)<<8|I[xe+4])+5}M.programMapTable=E.programMapTable}},this.push=function(I){var M={},ue=4;if(M.payloadUnitStartIndicator=!!(I[1]&64),M.pid=I[1]&31,M.pid<<=8,M.pid|=I[2],(I[3]&48)>>>4>1&&(ue+=I[ue]+1),M.pid===0)M.type="pat",m(I.subarray(ue),M),this.trigger("data",M);else if(M.pid===this.pmtPid)for(M.type="pmt",m(I.subarray(ue),M),this.trigger("data",M);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else this.programMapTable===void 0?this.packetsWaitingForPmt.push([I,ue,M]):this.processPes_(I,ue,M)},this.processPes_=function(I,M,ue){ue.pid===this.programMapTable.video?ue.streamType=cs.H264_STREAM_TYPE:ue.pid===this.programMapTable.audio?ue.streamType=cs.ADTS_STREAM_TYPE:ue.streamType=this.programMapTable["timed-metadata"][ue.pid],ue.type="pes",ue.data=I.subarray(M),this.trigger("data",ue)}},su.prototype=new Dc,su.STREAM_TYPES={h264:27,adts:15},gd=function(){var m=this,b=!1,S={data:[],size:0},E={data:[],size:0},I={data:[],size:0},M,ue=function(be,xe){var Oe;const Ke=be[0]<<16|be[1]<<8|be[2];xe.data=new Uint8Array,Ke===1&&(xe.packetLength=6+(be[4]<<8|be[5]),xe.dataAlignmentIndicator=(be[6]&4)!=0,Oe=be[7],Oe&192&&(xe.pts=(be[9]&14)<<27|(be[10]&255)<<20|(be[11]&254)<<12|(be[12]&255)<<5|(be[13]&254)>>>3,xe.pts*=4,xe.pts+=(be[13]&6)>>>1,xe.dts=xe.pts,Oe&64&&(xe.dts=(be[14]&14)<<27|(be[15]&255)<<20|(be[16]&254)<<12|(be[17]&255)<<5|(be[18]&254)>>>3,xe.dts*=4,xe.dts+=(be[18]&6)>>>1)),xe.data=be.subarray(9+be[8]))},ge=function(be,xe,Oe){var Ke=new Uint8Array(be.size),kt={type:xe},at=0,zt=0,Jt=!1,En;if(!(!be.data.length||be.size<9)){for(kt.trackId=be.data[0].pid,at=0;at<be.data.length;at++)En=be.data[at],Ke.set(En.data,zt),zt+=En.data.byteLength;ue(Ke,kt),Jt=xe==="video"||kt.packetLength<=be.size,(Oe||Jt)&&(be.size=0,be.data.length=0),Jt&&m.trigger("data",kt)}};gd.prototype.init.call(this),this.push=function(be){({pat:function(){},pes:function(){var xe,Oe;switch(be.streamType){case cs.H264_STREAM_TYPE:xe=S,Oe="video";break;case cs.ADTS_STREAM_TYPE:xe=E,Oe="audio";break;case cs.METADATA_STREAM_TYPE:xe=I,Oe="timed-metadata";break;default:return}be.payloadUnitStartIndicator&&ge(xe,Oe,!0),xe.data.push(be),xe.size+=be.data.byteLength},pmt:function(){var xe={type:"metadata",tracks:[]};M=be.programMapTable,M.video!==null&&xe.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+M.video,codec:"avc",type:"video"}),M.audio!==null&&xe.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+M.audio,codec:"adts",type:"audio"}),b=!0,m.trigger("data",xe)}})[be.type]()},this.reset=function(){S.size=0,S.data.length=0,E.size=0,E.data.length=0,this.trigger("reset")},this.flushStreams_=function(){ge(S,"video"),ge(E,"audio"),ge(I,"timed-metadata")},this.flush=function(){if(!b&&M){var be={type:"metadata",tracks:[]};M.video!==null&&be.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+M.video,codec:"avc",type:"video"}),M.audio!==null&&be.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+M.audio,codec:"adts",type:"audio"}),m.trigger("data",be)}b=!1,this.flushStreams_(),this.trigger("done")}},gd.prototype=new Dc;var Qf={PAT_PID:0,MP2T_PACKET_LENGTH:Zo,TransportPacketStream:md,TransportParseStream:su,ElementaryStream:gd,TimestampRolloverStream:py,CaptionStream:Ic.CaptionStream,Cea608Stream:Ic.Cea608Stream,Cea708Stream:Ic.Cea708Stream,MetadataStream:fy};for(var Oc in cs)cs.hasOwnProperty(Oc)&&(Qf[Oc]=cs[Oc]);var my=Qf,gy=i,yy=Wi.ONE_SECOND_IN_TS,yd,Jf=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];yd=function(m){var b,S=0;yd.prototype.init.call(this),this.skipWarn_=function(E,I){this.trigger("log",{level:"warn",message:`adts skiping bytes ${E} to ${I} in frame ${S} outside syncword`})},this.push=function(E){var I=0,M,ue,ge,be,xe;if(m||(S=0),E.type==="audio"){b&&b.length?(ge=b,b=new Uint8Array(ge.byteLength+E.data.byteLength),b.set(ge),b.set(E.data,ge.byteLength)):b=E.data;for(var Oe;I+7<b.length;){if(b[I]!==255||(b[I+1]&246)!=240){typeof Oe!="number"&&(Oe=I),I++;continue}if(typeof Oe=="number"&&(this.skipWarn_(Oe,I),Oe=null),ue=(~b[I+1]&1)*2,M=(b[I+3]&3)<<11|b[I+4]<<3|(b[I+5]&224)>>5,be=((b[I+6]&3)+1)*1024,xe=be*yy/Jf[(b[I+2]&60)>>>2],b.byteLength-I<M)break;this.trigger("data",{pts:E.pts+S*xe,dts:E.dts+S*xe,sampleCount:be,audioobjecttype:(b[I+2]>>>6&3)+1,channelcount:(b[I+2]&1)<<2|(b[I+3]&192)>>>6,samplerate:Jf[(b[I+2]&60)>>>2],samplingfrequencyindex:(b[I+2]&60)>>>2,samplesize:16,data:b.subarray(I+7+ue,I+M)}),S++,I+=M}typeof Oe=="number"&&(this.skipWarn_(Oe,I),Oe=null),b=b.subarray(I)}},this.flush=function(){S=0,this.trigger("done")},this.reset=function(){b=void 0,this.trigger("reset")},this.endTimeline=function(){b=void 0,this.trigger("endedtimeline")}},yd.prototype=new gy;var vy=yd,Zf;Zf=function(m){var b=m.byteLength,S=0,E=0;this.length=function(){return 8*b},this.bitsAvailable=function(){return 8*b+E},this.loadWord=function(){var I=m.byteLength-b,M=new Uint8Array(4),ue=Math.min(4,b);if(ue===0)throw new Error("no bytes available");M.set(m.subarray(I,I+ue)),S=new DataView(M.buffer).getUint32(0),E=ue*8,b-=ue},this.skipBits=function(I){var M;E>I?(S<<=I,E-=I):(I-=E,M=Math.floor(I/8),I-=M*8,b-=M,this.loadWord(),S<<=I,E-=I)},this.readBits=function(I){var M=Math.min(E,I),ue=S>>>32-M;return E-=M,E>0?S<<=M:b>0&&this.loadWord(),M=I-M,M>0?ue<<M|this.readBits(M):ue},this.skipLeadingZeros=function(){var I;for(I=0;I<E;++I)if((S&2147483648>>>I)!=0)return S<<=I,E-=I,I;return this.loadWord(),I+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var I=this.skipLeadingZeros();return this.readBits(I+1)-1},this.readExpGolomb=function(){var I=this.readUnsignedExpGolomb();return 1&I?1+I>>>1:-1*(I>>>1)},this.readBoolean=function(){return this.readBits(1)===1},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};var Ay=Zf,ep=i,by=Ay,vd,au,tp;au=function(){var m=0,b,S;au.prototype.init.call(this),this.push=function(E){var I;S?(I=new Uint8Array(S.byteLength+E.data.byteLength),I.set(S),I.set(E.data,S.byteLength),S=I):S=E.data;for(var M=S.byteLength;m<M-3;m++)if(S[m+2]===1){b=m+5;break}for(;b<M;)switch(S[b]){case 0:if(S[b-1]!==0){b+=2;break}else if(S[b-2]!==0){b++;break}m+3!==b-2&&this.trigger("data",S.subarray(m+3,b-2));do b++;while(S[b]!==1&&b<M);m=b-2,b+=3;break;case 1:if(S[b-1]!==0||S[b-2]!==0){b+=3;break}this.trigger("data",S.subarray(m+3,b-2)),m=b-2,b+=3;break;default:b+=3;break}S=S.subarray(m),b-=m,m=0},this.reset=function(){S=null,m=0,this.trigger("reset")},this.flush=function(){S&&S.byteLength>3&&this.trigger("data",S.subarray(m+3)),S=null,m=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}},au.prototype=new ep,tp={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},vd=function(){var m=new au,b,S,E,I,M,ue,ge;vd.prototype.init.call(this),b=this,this.push=function(be){be.type==="video"&&(S=be.trackId,E=be.pts,I=be.dts,m.push(be))},m.on("data",function(be){var xe={trackId:S,pts:E,dts:I,data:be,nalUnitTypeCode:be[0]&31};switch(xe.nalUnitTypeCode){case 5:xe.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:xe.nalUnitType="sei_rbsp",xe.escapedRBSP=M(be.subarray(1));break;case 7:xe.nalUnitType="seq_parameter_set_rbsp",xe.escapedRBSP=M(be.subarray(1)),xe.config=ue(xe.escapedRBSP);break;case 8:xe.nalUnitType="pic_parameter_set_rbsp";break;case 9:xe.nalUnitType="access_unit_delimiter_rbsp";break}b.trigger("data",xe)}),m.on("done",function(){b.trigger("done")}),m.on("partialdone",function(){b.trigger("partialdone")}),m.on("reset",function(){b.trigger("reset")}),m.on("endedtimeline",function(){b.trigger("endedtimeline")}),this.flush=function(){m.flush()},this.partialFlush=function(){m.partialFlush()},this.reset=function(){m.reset()},this.endTimeline=function(){m.endTimeline()},ge=function(be,xe){var Oe=8,Ke=8,kt,at;for(kt=0;kt<be;kt++)Ke!==0&&(at=xe.readExpGolomb(),Ke=(Oe+at+256)%256),Oe=Ke===0?Oe:Ke},M=function(be){for(var xe=be.byteLength,Oe=[],Ke=1,kt,at;Ke<xe-2;)be[Ke]===0&&be[Ke+1]===0&&be[Ke+2]===3?(Oe.push(Ke+2),Ke+=2):Ke++;if(Oe.length===0)return be;kt=xe-Oe.length,at=new Uint8Array(kt);var zt=0;for(Ke=0;Ke<kt;zt++,Ke++)zt===Oe[0]&&(zt++,Oe.shift()),at[Ke]=be[zt];return at},ue=function(be){var xe=0,Oe=0,Ke=0,kt=0,at,zt,Jt,En,Hr,uo,kp,Dp,Ip,Gc,Rp,dn=[1,1],Op,co;if(at=new by(be),zt=at.readUnsignedByte(),En=at.readUnsignedByte(),Jt=at.readUnsignedByte(),at.skipUnsignedExpGolomb(),tp[zt]&&(Hr=at.readUnsignedExpGolomb(),Hr===3&&at.skipBits(1),at.skipUnsignedExpGolomb(),at.skipUnsignedExpGolomb(),at.skipBits(1),at.readBoolean()))for(Rp=Hr!==3?8:12,co=0;co<Rp;co++)at.readBoolean()&&(co<6?ge(16,at):ge(64,at));if(at.skipUnsignedExpGolomb(),uo=at.readUnsignedExpGolomb(),uo===0)at.readUnsignedExpGolomb();else if(uo===1)for(at.skipBits(1),at.skipExpGolomb(),at.skipExpGolomb(),kp=at.readUnsignedExpGolomb(),co=0;co<kp;co++)at.skipExpGolomb();if(at.skipUnsignedExpGolomb(),at.skipBits(1),Dp=at.readUnsignedExpGolomb(),Ip=at.readUnsignedExpGolomb(),Gc=at.readBits(1),Gc===0&&at.skipBits(1),at.skipBits(1),at.readBoolean()&&(xe=at.readUnsignedExpGolomb(),Oe=at.readUnsignedExpGolomb(),Ke=at.readUnsignedExpGolomb(),kt=at.readUnsignedExpGolomb()),at.readBoolean()&&at.readBoolean()){switch(Op=at.readUnsignedByte(),Op){case 1:dn=[1,1];break;case 2:dn=[12,11];break;case 3:dn=[10,11];break;case 4:dn=[16,11];break;case 5:dn=[40,33];break;case 6:dn=[24,11];break;case 7:dn=[20,11];break;case 8:dn=[32,11];break;case 9:dn=[80,33];break;case 10:dn=[18,11];break;case 11:dn=[15,11];break;case 12:dn=[64,33];break;case 13:dn=[160,99];break;case 14:dn=[4,3];break;case 15:dn=[3,2];break;case 16:dn=[2,1];break;case 255:{dn=[at.readUnsignedByte()<<8|at.readUnsignedByte(),at.readUnsignedByte()<<8|at.readUnsignedByte()];break}}dn&&dn[0]/dn[1]}return{profileIdc:zt,levelIdc:Jt,profileCompatibility:En,width:(Dp+1)*16-xe*2-Oe*2,height:(2-Gc)*(Ip+1)*16-Ke*2-kt*2,sarRatio:dn}}},vd.prototype=new ep;var _y={H264Stream:vd,NalByteStream:au},xy=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],ip=function(m,b){var S=m[b+6]<<21|m[b+7]<<14|m[b+8]<<7|m[b+9],E=m[b+5],I=(E&16)>>4;return S=S>=0?S:0,I?S+20:S+10},np=function(m,b){return m.length-b<10||m[b]!=="I".charCodeAt(0)||m[b+1]!=="D".charCodeAt(0)||m[b+2]!=="3".charCodeAt(0)?b:(b+=ip(m,b),np(m,b))},Ey=function(m){var b=np(m,0);return m.length>=b+2&&(m[b]&255)==255&&(m[b+1]&240)==240&&(m[b+1]&22)==16},rp=function(m){return m[0]<<21|m[1]<<14|m[2]<<7|m[3]},Ty=function(m,b,S){var E,I="";for(E=b;E<S;E++)I+="%"+("00"+m[E].toString(16)).slice(-2);return I},Sy=function(m,b,S){return unescape(Ty(m,b,S))},Cy=function(m,b){var S=(m[b+5]&224)>>5,E=m[b+4]<<3,I=m[b+3]&3<<11;return I|E|S},wy=function(m,b){return m[b]==="I".charCodeAt(0)&&m[b+1]==="D".charCodeAt(0)&&m[b+2]==="3".charCodeAt(0)?"timed-metadata":m[b]&!0&&(m[b+1]&240)==240?"audio":null},Ly=function(m){for(var b=0;b+5<m.length;){if(m[b]!==255||(m[b+1]&246)!=240){b++;continue}return xy[(m[b+2]&60)>>>2]}return null},ky=function(m){var b,S,E,I;b=10,m[5]&64&&(b+=4,b+=rp(m.subarray(10,14)));do{if(S=rp(m.subarray(b+4,b+8)),S<1)return null;if(I=String.fromCharCode(m[b],m[b+1],m[b+2],m[b+3]),I==="PRIV"){E=m.subarray(b+10,b+S+10);for(var M=0;M<E.byteLength;M++)if(E[M]===0){var ue=Sy(E,0,M);if(ue==="com.apple.streaming.transportStreamTimestamp"){var ge=E.subarray(M+1),be=(ge[3]&1)<<30|ge[4]<<22|ge[5]<<14|ge[6]<<6|ge[7]>>>2;return be*=4,be+=ge[7]&3,be}break}}b+=10,b+=S}while(b<m.byteLength);return null},Pc={isLikelyAacData:Ey,parseId3TagSize:ip,parseAdtsSize:Cy,parseType:wy,parseSampleRate:Ly,parseAacTimestamp:ky},Dy=i,sp=Pc,Ad;Ad=function(){var m=new Uint8Array,b=0;Ad.prototype.init.call(this),this.setTimestamp=function(S){b=S},this.push=function(S){var E=0,I=0,M,ue,ge,be;for(m.length?(be=m.length,m=new Uint8Array(S.byteLength+be),m.set(m.subarray(0,be)),m.set(S,be)):m=S;m.length-I>=3;){if(m[I]==="I".charCodeAt(0)&&m[I+1]==="D".charCodeAt(0)&&m[I+2]==="3".charCodeAt(0)){if(m.length-I<10||(E=sp.parseId3TagSize(m,I),I+E>m.length))break;ue={type:"timed-metadata",data:m.subarray(I,I+E)},this.trigger("data",ue),I+=E;continue}else if((m[I]&255)==255&&(m[I+1]&240)==240){if(m.length-I<7||(E=sp.parseAdtsSize(m,I),I+E>m.length))break;ge={type:"audio",data:m.subarray(I,I+E),pts:b,dts:b},this.trigger("data",ge),I+=E;continue}I++}M=m.length-I,M>0?m=m.subarray(I):m=new Uint8Array},this.reset=function(){m=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){m=new Uint8Array,this.trigger("endedtimeline")}},Ad.prototype=new Dy;var Iy=Ad,Ry=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],Oy=Ry,Py=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],By=Py,bd=i,ou=Cg,lu=Bg,_d=Gg,hs=Yg,Zs=my,xd=Wi,ap=vy,My=_y.H264Stream,Fy=Iy,Ny=Pc.isLikelyAacData,Uy=Wi.ONE_SECOND_IN_TS,Bc=Oy,Mc=By,uu,el,Ed,oo,jy=function(m,b){b.stream=m,this.trigger("log",b)},op=function(m,b){for(var S=Object.keys(b),E=0;E<S.length;E++){var I=S[E];I==="headOfPipeline"||!b[I].on||b[I].on("log",jy.bind(m,I))}},lp=function(m,b){var S;if(m.length!==b.length)return!1;for(S=0;S<m.length;S++)if(m[S]!==b[S])return!1;return!0},Fc=function(m,b,S,E,I,M){var ue=S-b,ge=E-b,be=I-S;return{start:{dts:m,pts:m+ue},end:{dts:m+ge,pts:m+be},prependedContentDuration:M,baseMediaDecodeTime:m}};el=function(m,b){var S=[],E,I=0,M=0,ue=Infinity;b=b||{},E=b.firstSequenceNumber||0,el.prototype.init.call(this),this.push=function(ge){hs.collectDtsInfo(m,ge),m&&Bc.forEach(function(be){m[be]=ge[be]}),S.push(ge)},this.setEarliestDts=function(ge){I=ge},this.setVideoBaseMediaDecodeTime=function(ge){ue=ge},this.setAudioAppendStart=function(ge){M=ge},this.flush=function(){var ge,be,xe,Oe,Ke,kt,at;if(S.length===0){this.trigger("done","AudioSegmentStream");return}ge=_d.trimAdtsFramesByEarliestDts(S,m,I),m.baseMediaDecodeTime=hs.calculateTrackBaseMediaDecodeTime(m,b.keepOriginalTimestamps),at=_d.prefixWithSilence(m,ge,M,ue),m.samples=_d.generateSampleTable(ge),xe=ou.mdat(_d.concatenateFrameData(ge)),S=[],be=ou.moof(E,[m]),Oe=new Uint8Array(be.byteLength+xe.byteLength),E++,Oe.set(be),Oe.set(xe,be.byteLength),hs.clearDtsInfo(m),Ke=Math.ceil(Uy*1024/m.samplerate),ge.length&&(kt=ge.length*Ke,this.trigger("segmentTimingInfo",Fc(xd.audioTsToVideoTs(m.baseMediaDecodeTime,m.samplerate),ge[0].dts,ge[0].pts,ge[0].dts+kt,ge[0].pts+kt,at||0)),this.trigger("timingInfo",{start:ge[0].pts,end:ge[0].pts+kt})),this.trigger("data",{track:m,boxes:Oe}),this.trigger("done","AudioSegmentStream")},this.reset=function(){hs.clearDtsInfo(m),S=[],this.trigger("reset")}},el.prototype=new bd,uu=function(m,b){var S,E=[],I=[],M,ue;b=b||{},S=b.firstSequenceNumber||0,uu.prototype.init.call(this),delete m.minPTS,this.gopCache_=[],this.push=function(ge){hs.collectDtsInfo(m,ge),ge.nalUnitType==="seq_parameter_set_rbsp"&&!M&&(M=ge.config,m.sps=[ge.data],Mc.forEach(function(be){m[be]=M[be]},this)),ge.nalUnitType==="pic_parameter_set_rbsp"&&!ue&&(ue=ge.data,m.pps=[ge.data]),E.push(ge)},this.flush=function(){for(var ge,be,xe,Oe,Ke,kt,at=0,zt,Jt;E.length&&E[0].nalUnitType!=="access_unit_delimiter_rbsp";)E.shift();if(E.length===0){this.resetStream_(),this.trigger("done","VideoSegmentStream");return}if(ge=lu.groupNalsIntoFrames(E),xe=lu.groupFramesIntoGops(ge),xe[0][0].keyFrame||(be=this.getGopForFusion_(E[0],m),be?(at=be.duration,xe.unshift(be),xe.byteLength+=be.byteLength,xe.nalCount+=be.nalCount,xe.pts=be.pts,xe.dts=be.dts,xe.duration+=be.duration):xe=lu.extendFirstKeyFrame(xe)),I.length){var En;if(b.alignGopsAtEnd?En=this.alignGopsAtEnd_(xe):En=this.alignGopsAtStart_(xe),!En){this.gopCache_.unshift({gop:xe.pop(),pps:m.pps,sps:m.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),E=[],this.resetStream_(),this.trigger("done","VideoSegmentStream");return}hs.clearDtsInfo(m),xe=En}hs.collectDtsInfo(m,xe),m.samples=lu.generateSampleTable(xe),Ke=ou.mdat(lu.concatenateNalData(xe)),m.baseMediaDecodeTime=hs.calculateTrackBaseMediaDecodeTime(m,b.keepOriginalTimestamps),this.trigger("processedGopsInfo",xe.map(function(Hr){return{pts:Hr.pts,dts:Hr.dts,byteLength:Hr.byteLength}})),zt=xe[0],Jt=xe[xe.length-1],this.trigger("segmentTimingInfo",Fc(m.baseMediaDecodeTime,zt.dts,zt.pts,Jt.dts+Jt.duration,Jt.pts+Jt.duration,at)),this.trigger("timingInfo",{start:xe[0].pts,end:xe[xe.length-1].pts+xe[xe.length-1].duration}),this.gopCache_.unshift({gop:xe.pop(),pps:m.pps,sps:m.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),E=[],this.trigger("baseMediaDecodeTime",m.baseMediaDecodeTime),this.trigger("timelineStartInfo",m.timelineStartInfo),Oe=ou.moof(S,[m]),kt=new Uint8Array(Oe.byteLength+Ke.byteLength),S++,kt.set(Oe),kt.set(Ke,Oe.byteLength),this.trigger("data",{track:m,boxes:kt}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),E=[],this.gopCache_.length=0,I.length=0,this.trigger("reset")},this.resetStream_=function(){hs.clearDtsInfo(m),M=void 0,ue=void 0},this.getGopForFusion_=function(ge){var be=45e3,xe=1e4,Oe=Infinity,Ke,kt,at,zt,Jt;for(Jt=0;Jt<this.gopCache_.length;Jt++)zt=this.gopCache_[Jt],at=zt.gop,!(!(m.pps&&lp(m.pps[0],zt.pps[0]))||!(m.sps&&lp(m.sps[0],zt.sps[0])))&&(at.dts<m.timelineStartInfo.dts||(Ke=ge.dts-at.dts-at.duration,Ke>=-xe&&Ke<=be&&(!kt||Oe>Ke)&&(kt=zt,Oe=Ke)));return kt?kt.gop:null},this.alignGopsAtStart_=function(ge){var be,xe,Oe,Ke,kt,at,zt,Jt;for(kt=ge.byteLength,at=ge.nalCount,zt=ge.duration,be=xe=0;be<I.length&&xe<ge.length&&(Oe=I[be],Ke=ge[xe],Oe.pts!==Ke.pts);){if(Ke.pts>Oe.pts){be++;continue}xe++,kt-=Ke.byteLength,at-=Ke.nalCount,zt-=Ke.duration}return xe===0?ge:xe===ge.length?null:(Jt=ge.slice(xe),Jt.byteLength=kt,Jt.duration=zt,Jt.nalCount=at,Jt.pts=Jt[0].pts,Jt.dts=Jt[0].dts,Jt)},this.alignGopsAtEnd_=function(ge){var be,xe,Oe,Ke,kt,at;for(be=I.length-1,xe=ge.length-1,kt=null,at=!1;be>=0&&xe>=0;){if(Oe=I[be],Ke=ge[xe],Oe.pts===Ke.pts){at=!0;break}if(Oe.pts>Ke.pts){be--;continue}be===I.length-1&&(kt=xe),xe--}if(!at&&kt===null)return null;var zt;if(at?zt=xe:zt=kt,zt===0)return ge;var Jt=ge.slice(zt),En=Jt.reduce(function(Hr,uo){return Hr.byteLength+=uo.byteLength,Hr.duration+=uo.duration,Hr.nalCount+=uo.nalCount,Hr},{byteLength:0,duration:0,nalCount:0});return Jt.byteLength=En.byteLength,Jt.duration=En.duration,Jt.nalCount=En.nalCount,Jt.pts=Jt[0].pts,Jt.dts=Jt[0].dts,Jt},this.alignGopsWith=function(ge){I=ge}},uu.prototype=new bd,oo=function(m,b){this.numberOfTracks=0,this.metadataStream=b,m=m||{},typeof m.remux!="undefined"?this.remuxTracks=!!m.remux:this.remuxTracks=!0,typeof m.keepOriginalTimestamps=="boolean"?this.keepOriginalTimestamps=m.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,oo.prototype.init.call(this),this.push=function(S){if(S.content||S.text)return this.pendingCaptions.push(S);if(S.frames)return this.pendingMetadata.push(S);this.pendingTracks.push(S.track),this.pendingBytes+=S.boxes.byteLength,S.track.type==="video"&&(this.videoTrack=S.track,this.pendingBoxes.push(S.boxes)),S.track.type==="audio"&&(this.audioTrack=S.track,this.pendingBoxes.unshift(S.boxes))}},oo.prototype=new bd,oo.prototype.flush=function(m){var b=0,S={captions:[],captionStreams:{},metadata:[],info:{}},E,I,M,ue=0,ge;if(this.pendingTracks.length<this.numberOfTracks){if(m!=="VideoSegmentStream"&&m!=="AudioSegmentStream")return;if(this.remuxTracks)return;if(this.pendingTracks.length===0){this.emittedTracks++,this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0);return}}if(this.videoTrack?(ue=this.videoTrack.timelineStartInfo.pts,Mc.forEach(function(be){S.info[be]=this.videoTrack[be]},this)):this.audioTrack&&(ue=this.audioTrack.timelineStartInfo.pts,Bc.forEach(function(be){S.info[be]=this.audioTrack[be]},this)),this.videoTrack||this.audioTrack){for(this.pendingTracks.length===1?S.type=this.pendingTracks[0].type:S.type="combined",this.emittedTracks+=this.pendingTracks.length,M=ou.initSegment(this.pendingTracks),S.initSegment=new Uint8Array(M.byteLength),S.initSegment.set(M),S.data=new Uint8Array(this.pendingBytes),ge=0;ge<this.pendingBoxes.length;ge++)S.data.set(this.pendingBoxes[ge],b),b+=this.pendingBoxes[ge].byteLength;for(ge=0;ge<this.pendingCaptions.length;ge++)E=this.pendingCaptions[ge],E.startTime=xd.metadataTsToSeconds(E.startPts,ue,this.keepOriginalTimestamps),E.endTime=xd.metadataTsToSeconds(E.endPts,ue,this.keepOriginalTimestamps),S.captionStreams[E.stream]=!0,S.captions.push(E);for(ge=0;ge<this.pendingMetadata.length;ge++)I=this.pendingMetadata[ge],I.cueTime=xd.metadataTsToSeconds(I.pts,ue,this.keepOriginalTimestamps),S.metadata.push(I);for(S.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",S),ge=0;ge<S.captions.length;ge++)E=S.captions[ge],this.trigger("caption",E);for(ge=0;ge<S.metadata.length;ge++)I=S.metadata[ge],this.trigger("id3Frame",I)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},oo.prototype.setRemux=function(m){this.remuxTracks=m},Ed=function(m){var b=this,S=!0,E,I;Ed.prototype.init.call(this),m=m||{},this.baseMediaDecodeTime=m.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var M={};this.transmuxPipeline_=M,M.type="aac",M.metadataStream=new Zs.MetadataStream,M.aacStream=new Fy,M.audioTimestampRolloverStream=new Zs.TimestampRolloverStream("audio"),M.timedMetadataTimestampRolloverStream=new Zs.TimestampRolloverStream("timed-metadata"),M.adtsStream=new ap,M.coalesceStream=new oo(m,M.metadataStream),M.headOfPipeline=M.aacStream,M.aacStream.pipe(M.audioTimestampRolloverStream).pipe(M.adtsStream),M.aacStream.pipe(M.timedMetadataTimestampRolloverStream).pipe(M.metadataStream).pipe(M.coalesceStream),M.metadataStream.on("timestamp",function(ue){M.aacStream.setTimestamp(ue.timeStamp)}),M.aacStream.on("data",function(ue){ue.type!=="timed-metadata"&&ue.type!=="audio"||M.audioSegmentStream||(I=I||{timelineStartInfo:{baseMediaDecodeTime:b.baseMediaDecodeTime},codec:"adts",type:"audio"},M.coalesceStream.numberOfTracks++,M.audioSegmentStream=new el(I,m),M.audioSegmentStream.on("log",b.getLogTrigger_("audioSegmentStream")),M.audioSegmentStream.on("timingInfo",b.trigger.bind(b,"audioTimingInfo")),M.adtsStream.pipe(M.audioSegmentStream).pipe(M.coalesceStream),b.trigger("trackinfo",{hasAudio:!!I,hasVideo:!!E}))}),M.coalesceStream.on("data",this.trigger.bind(this,"data")),M.coalesceStream.on("done",this.trigger.bind(this,"done")),op(this,M)},this.setupTsPipeline=function(){var M={};this.transmuxPipeline_=M,M.type="ts",M.metadataStream=new Zs.MetadataStream,M.packetStream=new Zs.TransportPacketStream,M.parseStream=new Zs.TransportParseStream,M.elementaryStream=new Zs.ElementaryStream,M.timestampRolloverStream=new Zs.TimestampRolloverStream,M.adtsStream=new ap,M.h264Stream=new My,M.captionStream=new Zs.CaptionStream(m),M.coalesceStream=new oo(m,M.metadataStream),M.headOfPipeline=M.packetStream,M.packetStream.pipe(M.parseStream).pipe(M.elementaryStream).pipe(M.timestampRolloverStream),M.timestampRolloverStream.pipe(M.h264Stream),M.timestampRolloverStream.pipe(M.adtsStream),M.timestampRolloverStream.pipe(M.metadataStream).pipe(M.coalesceStream),M.h264Stream.pipe(M.captionStream).pipe(M.coalesceStream),M.elementaryStream.on("data",function(ue){var ge;if(ue.type==="metadata"){for(ge=ue.tracks.length;ge--;)!E&&ue.tracks[ge].type==="video"?(E=ue.tracks[ge],E.timelineStartInfo.baseMediaDecodeTime=b.baseMediaDecodeTime):!I&&ue.tracks[ge].type==="audio"&&(I=ue.tracks[ge],I.timelineStartInfo.baseMediaDecodeTime=b.baseMediaDecodeTime);E&&!M.videoSegmentStream&&(M.coalesceStream.numberOfTracks++,M.videoSegmentStream=new uu(E,m),M.videoSegmentStream.on("log",b.getLogTrigger_("videoSegmentStream")),M.videoSegmentStream.on("timelineStartInfo",function(be){I&&!m.keepOriginalTimestamps&&(I.timelineStartInfo=be,M.audioSegmentStream.setEarliestDts(be.dts-b.baseMediaDecodeTime))}),M.videoSegmentStream.on("processedGopsInfo",b.trigger.bind(b,"gopInfo")),M.videoSegmentStream.on("segmentTimingInfo",b.trigger.bind(b,"videoSegmentTimingInfo")),M.videoSegmentStream.on("baseMediaDecodeTime",function(be){I&&M.audioSegmentStream.setVideoBaseMediaDecodeTime(be)}),M.videoSegmentStream.on("timingInfo",b.trigger.bind(b,"videoTimingInfo")),M.h264Stream.pipe(M.videoSegmentStream).pipe(M.coalesceStream)),I&&!M.audioSegmentStream&&(M.coalesceStream.numberOfTracks++,M.audioSegmentStream=new el(I,m),M.audioSegmentStream.on("log",b.getLogTrigger_("audioSegmentStream")),M.audioSegmentStream.on("timingInfo",b.trigger.bind(b,"audioTimingInfo")),M.audioSegmentStream.on("segmentTimingInfo",b.trigger.bind(b,"audioSegmentTimingInfo")),M.adtsStream.pipe(M.audioSegmentStream).pipe(M.coalesceStream)),b.trigger("trackinfo",{hasAudio:!!I,hasVideo:!!E})}}),M.coalesceStream.on("data",this.trigger.bind(this,"data")),M.coalesceStream.on("id3Frame",function(ue){ue.dispatchType=M.metadataStream.dispatchType,b.trigger("id3Frame",ue)}),M.coalesceStream.on("caption",this.trigger.bind(this,"caption")),M.coalesceStream.on("done",this.trigger.bind(this,"done")),op(this,M)},this.setBaseMediaDecodeTime=function(M){var ue=this.transmuxPipeline_;m.keepOriginalTimestamps||(this.baseMediaDecodeTime=M),I&&(I.timelineStartInfo.dts=void 0,I.timelineStartInfo.pts=void 0,hs.clearDtsInfo(I),ue.audioTimestampRolloverStream&&ue.audioTimestampRolloverStream.discontinuity()),E&&(ue.videoSegmentStream&&(ue.videoSegmentStream.gopCache_=[]),E.timelineStartInfo.dts=void 0,E.timelineStartInfo.pts=void 0,hs.clearDtsInfo(E),ue.captionStream.reset()),ue.timestampRolloverStream&&ue.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(M){I&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(M)},this.setRemux=function(M){var ue=this.transmuxPipeline_;m.remux=M,ue&&ue.coalesceStream&&ue.coalesceStream.setRemux(M)},this.alignGopsWith=function(M){E&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(M)},this.getLogTrigger_=function(M){var ue=this;return function(ge){ge.stream=M,ue.trigger("log",ge)}},this.push=function(M){if(S){var ue=Ny(M);ue&&this.transmuxPipeline_.type!=="aac"?this.setupAacPipeline():!ue&&this.transmuxPipeline_.type!=="ts"&&this.setupTsPipeline(),S=!1}this.transmuxPipeline_.headOfPipeline.push(M)},this.flush=function(){S=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}},Ed.prototype=new bd;var $y={Transmuxer:Ed,VideoSegmentStream:uu,AudioSegmentStream:el,AUDIO_PROPERTIES:Bc,VIDEO_PROPERTIES:Mc,generateSegmentTimingInfo:Fc},Vy=function(m){return m>>>0},Hy=function(m){return("00"+m.toString(16)).slice(-2)},Td={toUnsigned:Vy,toHexString:Hy},Gy=function(m){var b="";return b+=String.fromCharCode(m[0]),b+=String.fromCharCode(m[1]),b+=String.fromCharCode(m[2]),b+=String.fromCharCode(m[3]),b},up=Gy,qy=Td.toUnsigned,Wy=up,dp=function(m,b){var S=[],E,I,M,ue,ge;if(!b.length)return null;for(E=0;E<m.byteLength;)I=qy(m[E]<<24|m[E+1]<<16|m[E+2]<<8|m[E+3]),M=Wy(m.subarray(E+4,E+8)),ue=I>1?E+I:m.byteLength,M===b[0]&&(b.length===1?S.push(m.subarray(E+8,ue)):(ge=dp(m.subarray(E+8,ue),b.slice(1)),ge.length&&(S=S.concat(ge)))),E=ue;return S},cp=dp,Ky=Td.toUnsigned,zy=d.getUint64,Yy=function(m){var b={version:m[0],flags:new Uint8Array(m.subarray(1,4))};return b.version===1?b.baseMediaDecodeTime=zy(m.subarray(4)):b.baseMediaDecodeTime=Ky(m[4]<<24|m[5]<<16|m[6]<<8|m[7]),b},hp=Yy,Xy=function(m){return{isLeading:(m[0]&12)>>>2,dependsOn:m[0]&3,isDependedOn:(m[1]&192)>>>6,hasRedundancy:(m[1]&48)>>>4,paddingValue:(m[1]&14)>>>1,isNonSyncSample:m[1]&1,degradationPriority:m[2]<<8|m[3]}},Qy=Xy,fp=Qy,Jy=function(m){var b={version:m[0],flags:new Uint8Array(m.subarray(1,4)),samples:[]},S=new DataView(m.buffer,m.byteOffset,m.byteLength),E=b.flags[2]&1,I=b.flags[2]&4,M=b.flags[1]&1,ue=b.flags[1]&2,ge=b.flags[1]&4,be=b.flags[1]&8,xe=S.getUint32(4),Oe=8,Ke;for(E&&(b.dataOffset=S.getInt32(Oe),Oe+=4),I&&xe&&(Ke={flags:fp(m.subarray(Oe,Oe+4))},Oe+=4,M&&(Ke.duration=S.getUint32(Oe),Oe+=4),ue&&(Ke.size=S.getUint32(Oe),Oe+=4),be&&(b.version===1?Ke.compositionTimeOffset=S.getInt32(Oe):Ke.compositionTimeOffset=S.getUint32(Oe),Oe+=4),b.samples.push(Ke),xe--);xe--;)Ke={},M&&(Ke.duration=S.getUint32(Oe),Oe+=4),ue&&(Ke.size=S.getUint32(Oe),Oe+=4),ge&&(Ke.flags=fp(m.subarray(Oe,Oe+4)),Oe+=4),be&&(b.version===1?Ke.compositionTimeOffset=S.getInt32(Oe):Ke.compositionTimeOffset=S.getUint32(Oe),Oe+=4),b.samples.push(Ke);return b},pp=Jy,Zy=function(m){var b=new DataView(m.buffer,m.byteOffset,m.byteLength),S={version:m[0],flags:new Uint8Array(m.subarray(1,4)),trackId:b.getUint32(4)},E=S.flags[2]&1,I=S.flags[2]&2,M=S.flags[2]&8,ue=S.flags[2]&16,ge=S.flags[2]&32,be=S.flags[0]&65536,xe=S.flags[0]&131072,Oe;return Oe=8,E&&(Oe+=4,S.baseDataOffset=b.getUint32(12),Oe+=4),I&&(S.sampleDescriptionIndex=b.getUint32(Oe),Oe+=4),M&&(S.defaultSampleDuration=b.getUint32(Oe),Oe+=4),ue&&(S.defaultSampleSize=b.getUint32(Oe),Oe+=4),ge&&(S.defaultSampleFlags=b.getUint32(Oe)),be&&(S.durationIsEmpty=!0),!E&&xe&&(S.baseDataOffsetIsMoof=!0),S},mp=Zy,du;typeof window!="undefined"?du=window:typeof s!="undefined"?du=s:typeof self!="undefined"?du=self:du={};var gp=du,ev=qf.discardEmulationPreventionBytes,tv=Wf.CaptionStream,cu=cp,iv=hp,nv=pp,rv=mp,yp=gp,sv=function(m,b){for(var S=m,E=0;E<b.length;E++){var I=b[E];if(S<I.size)return I;S-=I.size}return null},av=function(m,b,S){var E=new DataView(m.buffer,m.byteOffset,m.byteLength),I={logs:[],seiNals:[]},M,ue,ge,be;for(ue=0;ue+4<m.length;ue+=ge)if(ge=E.getUint32(ue),ue+=4,!(ge<=0))switch(m[ue]&31){case 6:var xe=m.subarray(ue+1,ue+1+ge),Oe=sv(ue,b);if(M={nalUnitType:"sei_rbsp",size:ge,data:xe,escapedRBSP:ev(xe),trackId:S},Oe)M.pts=Oe.pts,M.dts=Oe.dts,be=Oe;else if(be)M.pts=be.pts,M.dts=be.dts;else{I.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+ue+" for trackId "+S+". See mux.js#223."});break}I.seiNals.push(M);break}return I},ov=function(m,b,S){var E=b,I=S.defaultSampleDuration||0,M=S.defaultSampleSize||0,ue=S.trackId,ge=[];return m.forEach(function(be){var xe=nv(be),Oe=xe.samples;Oe.forEach(function(Ke){Ke.duration===void 0&&(Ke.duration=I),Ke.size===void 0&&(Ke.size=M),Ke.trackId=ue,Ke.dts=E,Ke.compositionTimeOffset===void 0&&(Ke.compositionTimeOffset=0),typeof E=="bigint"?(Ke.pts=E+yp.BigInt(Ke.compositionTimeOffset),E+=yp.BigInt(Ke.duration)):(Ke.pts=E+Ke.compositionTimeOffset,E+=Ke.duration)}),ge=ge.concat(Oe)}),ge},lv=function(m,b){var S=cu(m,["moof","traf"]),E=cu(m,["mdat"]),I={},M=[];return E.forEach(function(ue,ge){var be=S[ge];M.push({mdat:ue,traf:be})}),M.forEach(function(ue){var ge=ue.mdat,be=ue.traf,xe=cu(be,["tfhd"]),Oe=rv(xe[0]),Ke=Oe.trackId,kt=cu(be,["tfdt"]),at=kt.length>0?iv(kt[0]).baseMediaDecodeTime:0,zt=cu(be,["trun"]),Jt,En;b===Ke&&zt.length>0&&(Jt=ov(zt,at,Oe),En=av(ge,Jt,Ke),I[Ke]||(I[Ke]={seiNals:[],logs:[]}),I[Ke].seiNals=I[Ke].seiNals.concat(En.seiNals),I[Ke].logs=I[Ke].logs.concat(En.logs))}),I},uv=function(m,b,S){var E;if(b===null)return null;E=lv(m,b);var I=E[b]||{};return{seiNals:I.seiNals,logs:I.logs,timescale:S}},dv=function(){var m=!1,b,S,E,I,M,ue;this.isInitialized=function(){return m},this.init=function(ge){b=new tv,m=!0,ue=ge?ge.isPartial:!1,b.on("data",function(be){be.startTime=be.startPts/I,be.endTime=be.endPts/I,M.captions.push(be),M.captionStreams[be.stream]=!0}),b.on("log",function(be){M.logs.push(be)})},this.isNewInit=function(ge,be){return ge&&ge.length===0||be&&typeof be=="object"&&Object.keys(be).length===0?!1:E!==ge[0]||I!==be[E]},this.parse=function(ge,be,xe){var Oe;if(this.isInitialized()){if(!be||!xe)return null;if(this.isNewInit(be,xe))E=be[0],I=xe[E];else if(E===null||!I)return S.push(ge),null}else return null;for(;S.length>0;){var Ke=S.shift();this.parse(Ke,be,xe)}return Oe=uv(ge,E,I),Oe&&Oe.logs&&(M.logs=M.logs.concat(Oe.logs)),Oe===null||!Oe.seiNals?M.logs.length?{logs:M.logs,captions:[],captionStreams:[]}:null:(this.pushNals(Oe.seiNals),this.flushStream(),M)},this.pushNals=function(ge){if(!this.isInitialized()||!ge||ge.length===0)return null;ge.forEach(function(be){b.push(be)})},this.flushStream=function(){if(!this.isInitialized())return null;ue?b.partialFlush():b.flush()},this.clearParsedCaptions=function(){M.captions=[],M.captionStreams={},M.logs=[]},this.resetCaptionStream=function(){if(!this.isInitialized())return null;b.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){S=[],E=null,I=null,M?this.clearParsedCaptions():M={captions:[],captionStreams:{},logs:[]},this.resetCaptionStream()},this.reset()},cv=dv,hv=function(m){for(var b=0,S=String.fromCharCode(m[b]),E="";S!=="\0";)E+=S,b++,S=String.fromCharCode(m[b]);return E+=S,E},fv={uint8ToCString:hv},Sd=fv.uint8ToCString,pv=d.getUint64,mv=function(m){var b=4,S=m[0],E,I,M,ue,ge,be,xe,Oe;if(S===0){E=Sd(m.subarray(b)),b+=E.length,I=Sd(m.subarray(b)),b+=I.length;var Ke=new DataView(m.buffer);M=Ke.getUint32(b),b+=4,ge=Ke.getUint32(b),b+=4,be=Ke.getUint32(b),b+=4,xe=Ke.getUint32(b),b+=4}else if(S===1){var Ke=new DataView(m.buffer);M=Ke.getUint32(b),b+=4,ue=pv(m.subarray(b)),b+=8,be=Ke.getUint32(b),b+=4,xe=Ke.getUint32(b),b+=4,E=Sd(m.subarray(b)),b+=E.length,I=Sd(m.subarray(b)),b+=I.length}Oe=new Uint8Array(m.subarray(b,m.byteLength));var kt={scheme_id_uri:E,value:I,timescale:M||1,presentation_time:ue,presentation_time_delta:ge,event_duration:be,id:xe,message_data:Oe};return yv(S,kt)?kt:void 0},gv=function(m,b,S,E){return m||m===0?m/b:E+S/b},yv=function(m,b){var S=b.scheme_id_uri!=="\0",E=m===0&&vp(b.presentation_time_delta)&&S,I=m===1&&vp(b.presentation_time)&&S;return!(m>1)&&E||I},vp=function(m){return m!==void 0||m!==null},vv={parseEmsgBox:mv,scaleTime:gv},Cd=Td.toUnsigned,hu=Td.toHexString,un=cp,tl=up,Nc=vv,Av=mp,bv=pp,_v=hp,xv=d.getUint64,Ap,bp,_p,xp,Ep,Uc,Tp,jc=gp,Ev=Xf.parseId3Frames;Ap=function(m){var b={},S=un(m,["moov","trak"]);return S.reduce(function(E,I){var M,ue,ge,be,xe;return M=un(I,["tkhd"])[0],!M||(ue=M[0],ge=ue===0?12:20,be=Cd(M[ge]<<24|M[ge+1]<<16|M[ge+2]<<8|M[ge+3]),xe=un(I,["mdia","mdhd"])[0],!xe)?null:(ue=xe[0],ge=ue===0?12:20,E[be]=Cd(xe[ge]<<24|xe[ge+1]<<16|xe[ge+2]<<8|xe[ge+3]),E)},b)},bp=function(m,b){var S;S=un(b,["moof","traf"]);var E=S.reduce(function(I,M){var ue=un(M,["tfhd"])[0],ge=Cd(ue[4]<<24|ue[5]<<16|ue[6]<<8|ue[7]),be=m[ge]||9e4,xe=un(M,["tfdt"])[0],Oe=new DataView(xe.buffer,xe.byteOffset,xe.byteLength),Ke;xe[0]===1?Ke=xv(xe.subarray(4,12)):Ke=Oe.getUint32(4);let kt;return typeof Ke=="bigint"?kt=Ke/jc.BigInt(be):typeof Ke=="number"&&!isNaN(Ke)&&(kt=Ke/be),kt<Number.MAX_SAFE_INTEGER&&(kt=Number(kt)),kt<I&&(I=kt),I},Infinity);return typeof E=="bigint"||isFinite(E)?E:0},_p=function(m,b){var S=un(b,["moof","traf"]),E=0,I=0,M;if(S&&S.length){var ue=un(S[0],["tfhd"])[0],ge=un(S[0],["trun"])[0],be=un(S[0],["tfdt"])[0];if(ue){var xe=Av(ue);M=xe.trackId}if(be){var Oe=_v(be);E=Oe.baseMediaDecodeTime}if(ge){var Ke=bv(ge);Ke.samples&&Ke.samples.length&&(I=Ke.samples[0].compositionTimeOffset||0)}}var kt=m[M]||9e4;typeof E=="bigint"&&(I=jc.BigInt(I),kt=jc.BigInt(kt));var at=(E+I)/kt;return typeof at=="bigint"&&at<Number.MAX_SAFE_INTEGER&&(at=Number(at)),at},xp=function(m){var b=un(m,["moov","trak"]),S=[];return b.forEach(function(E){var I=un(E,["mdia","hdlr"]),M=un(E,["tkhd"]);I.forEach(function(ue,ge){var be=tl(ue.subarray(8,12)),xe=M[ge],Oe,Ke,kt;be==="vide"&&(Oe=new DataView(xe.buffer,xe.byteOffset,xe.byteLength),Ke=Oe.getUint8(0),kt=Ke===0?Oe.getUint32(12):Oe.getUint32(20),S.push(kt))})}),S},Uc=function(m){var b=m[0],S=b===0?12:20;return Cd(m[S]<<24|m[S+1]<<16|m[S+2]<<8|m[S+3])},Ep=function(m){var b=un(m,["moov","trak"]),S=[];return b.forEach(function(E){var I={},M=un(E,["tkhd"])[0],ue,ge;M&&(ue=new DataView(M.buffer,M.byteOffset,M.byteLength),ge=ue.getUint8(0),I.id=ge===0?ue.getUint32(12):ue.getUint32(20));var be=un(E,["mdia","hdlr"])[0];if(be){var xe=tl(be.subarray(8,12));xe==="vide"?I.type="video":xe==="soun"?I.type="audio":I.type=xe}var Oe=un(E,["mdia","minf","stbl","stsd"])[0];if(Oe){var Ke=Oe.subarray(8);I.codec=tl(Ke.subarray(4,8));var kt=un(Ke,[I.codec])[0],at,zt;kt&&(/^[asm]vc[1-9]$/i.test(I.codec)?(at=kt.subarray(78),zt=tl(at.subarray(4,8)),zt==="avcC"&&at.length>11?(I.codec+=".",I.codec+=hu(at[9]),I.codec+=hu(at[10]),I.codec+=hu(at[11])):I.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(I.codec)?(at=kt.subarray(28),zt=tl(at.subarray(4,8)),zt==="esds"&&at.length>20&&at[19]!==0?(I.codec+="."+hu(at[19]),I.codec+="."+hu(at[20]>>>2&63).replace(/^0/,"")):I.codec="mp4a.40.2"):I.codec=I.codec.toLowerCase())}var Jt=un(E,["mdia","mdhd"])[0];Jt&&(I.timescale=Uc(Jt)),S.push(I)}),S},Tp=function(m,b=0){var S=un(m,["emsg"]);return S.map(E=>{var I=Nc.parseEmsgBox(new Uint8Array(E)),M=Ev(I.message_data);return{cueTime:Nc.scaleTime(I.presentation_time,I.timescale,I.presentation_time_delta,b),duration:Nc.scaleTime(I.event_duration,I.timescale),frames:M}})};var $c={findBox:un,parseType:tl,timescale:Ap,startTime:bp,compositionStartTime:_p,videoTrackIds:xp,tracks:Ep,getTimescaleFromMediaHeader:Uc,getEmsgID3:Tp},Vc=cd,Sp=function(m){var b=m[1]&31;return b<<=8,b|=m[2],b},wd=function(m){return!!(m[1]&64)},Ld=function(m){var b=0;return(m[3]&48)>>>4>1&&(b+=m[4]+1),b},Tv=function(m,b){var S=Sp(m);return S===0?"pat":S===b?"pmt":b?"pes":null},Sv=function(m){var b=wd(m),S=4+Ld(m);return b&&(S+=m[S]+1),(m[S+10]&31)<<8|m[S+11]},Cv=function(m){var b={},S=wd(m),E=4+Ld(m);if(S&&(E+=m[E]+1),!!(m[E+5]&1)){var I,M,ue;I=(m[E+1]&15)<<8|m[E+2],M=3+I-4,ue=(m[E+10]&15)<<8|m[E+11];for(var ge=12+ue;ge<M;){var be=E+ge;b[(m[be+1]&31)<<8|m[be+2]]=m[be],ge+=((m[be+3]&15)<<8|m[be+4])+5}return b}},wv=function(m,b){var S=Sp(m),E=b[S];switch(E){case Vc.H264_STREAM_TYPE:return"video";case Vc.ADTS_STREAM_TYPE:return"audio";case Vc.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},Lv=function(m){var b=wd(m);if(!b)return null;var S=4+Ld(m);if(S>=m.byteLength)return null;var E=null,I;return I=m[S+7],I&192&&(E={},E.pts=(m[S+9]&14)<<27|(m[S+10]&255)<<20|(m[S+11]&254)<<12|(m[S+12]&255)<<5|(m[S+13]&254)>>>3,E.pts*=4,E.pts+=(m[S+13]&6)>>>1,E.dts=E.pts,I&64&&(E.dts=(m[S+14]&14)<<27|(m[S+15]&255)<<20|(m[S+16]&254)<<12|(m[S+17]&255)<<5|(m[S+18]&254)>>>3,E.dts*=4,E.dts+=(m[S+18]&6)>>>1)),E},Hc=function(m){switch(m){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},kv=function(m){for(var b=4+Ld(m),S=m.subarray(b),E=0,I=0,M=!1,ue;I<S.byteLength-3;I++)if(S[I+2]===1){E=I+5;break}for(;E<S.byteLength;)switch(S[E]){case 0:if(S[E-1]!==0){E+=2;break}else if(S[E-2]!==0){E++;break}I+3!==E-2&&(ue=Hc(S[I+3]&31),ue==="slice_layer_without_partitioning_rbsp_idr"&&(M=!0));do E++;while(S[E]!==1&&E<S.length);I=E-2,E+=3;break;case 1:if(S[E-1]!==0||S[E-2]!==0){E+=3;break}ue=Hc(S[I+3]&31),ue==="slice_layer_without_partitioning_rbsp_idr"&&(M=!0),I=E-2,E+=3;break;default:E+=3;break}return S=S.subarray(I),E-=I,I=0,S&&S.byteLength>3&&(ue=Hc(S[I+3]&31),ue==="slice_layer_without_partitioning_rbsp_idr"&&(M=!0)),M},Dv={parseType:Tv,parsePat:Sv,parsePmt:Cv,parsePayloadUnitStartIndicator:wd,parsePesType:wv,parsePesTime:Lv,videoPacketContainsKeyFrame:kv},Cp=cd,il=zf.handleRollover,ki={};ki.ts=Dv,ki.aac=Pc;var lo=Wi.ONE_SECOND_IN_TS,er=188,Ds=71,Iv=function(m,b){for(var S=0,E=er,I,M;E<m.byteLength;){if(m[S]===Ds&&m[E]===Ds){switch(I=m.subarray(S,E),M=ki.ts.parseType(I,b.pid),M){case"pat":b.pid=ki.ts.parsePat(I);break;case"pmt":var ue=ki.ts.parsePmt(I);b.table=b.table||{},Object.keys(ue).forEach(function(ge){b.table[ge]=ue[ge]});break}S+=er,E+=er;continue}S++,E++}},wp=function(m,b,S){for(var E=0,I=er,M,ue,ge,be,xe,Oe=!1;I<=m.byteLength;){if(m[E]===Ds&&(m[I]===Ds||I===m.byteLength)){switch(M=m.subarray(E,I),ue=ki.ts.parseType(M,b.pid),ue){case"pes":ge=ki.ts.parsePesType(M,b.table),be=ki.ts.parsePayloadUnitStartIndicator(M),ge==="audio"&&be&&(xe=ki.ts.parsePesTime(M),xe&&(xe.type="audio",S.audio.push(xe),Oe=!0));break}if(Oe)break;E+=er,I+=er;continue}E++,I++}for(I=m.byteLength,E=I-er,Oe=!1;E>=0;){if(m[E]===Ds&&(m[I]===Ds||I===m.byteLength)){switch(M=m.subarray(E,I),ue=ki.ts.parseType(M,b.pid),ue){case"pes":ge=ki.ts.parsePesType(M,b.table),be=ki.ts.parsePayloadUnitStartIndicator(M),ge==="audio"&&be&&(xe=ki.ts.parsePesTime(M),xe&&(xe.type="audio",S.audio.push(xe),Oe=!0));break}if(Oe)break;E-=er,I-=er;continue}E--,I--}},Rv=function(m,b,S){for(var E=0,I=er,M,ue,ge,be,xe,Oe,Ke,kt,at=!1,zt={data:[],size:0};I<m.byteLength;){if(m[E]===Ds&&m[I]===Ds){switch(M=m.subarray(E,I),ue=ki.ts.parseType(M,b.pid),ue){case"pes":if(ge=ki.ts.parsePesType(M,b.table),be=ki.ts.parsePayloadUnitStartIndicator(M),ge==="video"&&(be&&!at&&(xe=ki.ts.parsePesTime(M),xe&&(xe.type="video",S.video.push(xe),at=!0)),!S.firstKeyFrame)){if(be&&zt.size!==0){for(Oe=new Uint8Array(zt.size),Ke=0;zt.data.length;)kt=zt.data.shift(),Oe.set(kt,Ke),Ke+=kt.byteLength;if(ki.ts.videoPacketContainsKeyFrame(Oe)){var Jt=ki.ts.parsePesTime(Oe);Jt?(S.firstKeyFrame=Jt,S.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}zt.size=0}zt.data.push(M),zt.size+=M.byteLength}break}if(at&&S.firstKeyFrame)break;E+=er,I+=er;continue}E++,I++}for(I=m.byteLength,E=I-er,at=!1;E>=0;){if(m[E]===Ds&&m[I]===Ds){switch(M=m.subarray(E,I),ue=ki.ts.parseType(M,b.pid),ue){case"pes":ge=ki.ts.parsePesType(M,b.table),be=ki.ts.parsePayloadUnitStartIndicator(M),ge==="video"&&be&&(xe=ki.ts.parsePesTime(M),xe&&(xe.type="video",S.video.push(xe),at=!0));break}if(at)break;E-=er,I-=er;continue}E--,I--}},Ov=function(m,b){if(m.audio&&m.audio.length){var S=b;(typeof S=="undefined"||isNaN(S))&&(S=m.audio[0].dts),m.audio.forEach(function(M){M.dts=il(M.dts,S),M.pts=il(M.pts,S),M.dtsTime=M.dts/lo,M.ptsTime=M.pts/lo})}if(m.video&&m.video.length){var E=b;if((typeof E=="undefined"||isNaN(E))&&(E=m.video[0].dts),m.video.forEach(function(M){M.dts=il(M.dts,E),M.pts=il(M.pts,E),M.dtsTime=M.dts/lo,M.ptsTime=M.pts/lo}),m.firstKeyFrame){var I=m.firstKeyFrame;I.dts=il(I.dts,E),I.pts=il(I.pts,E),I.dtsTime=I.dts/lo,I.ptsTime=I.pts/lo}}},Pv=function(m){for(var b=!1,S=0,E=null,I=null,M=0,ue=0,ge;m.length-ue>=3;){var be=ki.aac.parseType(m,ue);switch(be){case"timed-metadata":if(m.length-ue<10){b=!0;break}if(M=ki.aac.parseId3TagSize(m,ue),M>m.length){b=!0;break}I===null&&(ge=m.subarray(ue,ue+M),I=ki.aac.parseAacTimestamp(ge)),ue+=M;break;case"audio":if(m.length-ue<7){b=!0;break}if(M=ki.aac.parseAdtsSize(m,ue),M>m.length){b=!0;break}E===null&&(ge=m.subarray(ue,ue+M),E=ki.aac.parseSampleRate(ge)),S++,ue+=M;break;default:ue++;break}if(b)return null}if(E===null||I===null)return null;var xe=lo/E,Oe={audio:[{type:"audio",dts:I,pts:I},{type:"audio",dts:I+S*1024*xe,pts:I+S*1024*xe}]};return Oe},Bv=function(m){var b={pid:null,table:null},S={};Iv(m,b);for(var E in b.table)if(b.table.hasOwnProperty(E)){var I=b.table[E];switch(I){case Cp.H264_STREAM_TYPE:S.video=[],Rv(m,b,S),S.video.length===0&&delete S.video;break;case Cp.ADTS_STREAM_TYPE:S.audio=[],wp(m,b,S),S.audio.length===0&&delete S.audio;break}}return S},Mv=function(m,b){var S=ki.aac.isLikelyAacData(m),E;return S?E=Pv(m):E=Bv(m),!E||!E.audio&&!E.video?null:(Ov(E,b),E)},Fv={inspect:Mv,parseAudioPes_:wp};const Nv=function(m,b){b.on("data",function(S){const E=S.initSegment;S.initSegment={data:E.buffer,byteOffset:E.byteOffset,byteLength:E.byteLength};const I=S.data;S.data=I.buffer,m.postMessage({action:"data",segment:S,byteOffset:I.byteOffset,byteLength:I.byteLength},[S.data])}),b.on("done",function(S){m.postMessage({action:"done"})}),b.on("gopInfo",function(S){m.postMessage({action:"gopInfo",gopInfo:S})}),b.on("videoSegmentTimingInfo",function(S){const E={start:{decode:Wi.videoTsToSeconds(S.start.dts),presentation:Wi.videoTsToSeconds(S.start.pts)},end:{decode:Wi.videoTsToSeconds(S.end.dts),presentation:Wi.videoTsToSeconds(S.end.pts)},baseMediaDecodeTime:Wi.videoTsToSeconds(S.baseMediaDecodeTime)};S.prependedContentDuration&&(E.prependedContentDuration=Wi.videoTsToSeconds(S.prependedContentDuration)),m.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:E})}),b.on("audioSegmentTimingInfo",function(S){const E={start:{decode:Wi.videoTsToSeconds(S.start.dts),presentation:Wi.videoTsToSeconds(S.start.pts)},end:{decode:Wi.videoTsToSeconds(S.end.dts),presentation:Wi.videoTsToSeconds(S.end.pts)},baseMediaDecodeTime:Wi.videoTsToSeconds(S.baseMediaDecodeTime)};S.prependedContentDuration&&(E.prependedContentDuration=Wi.videoTsToSeconds(S.prependedContentDuration)),m.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:E})}),b.on("id3Frame",function(S){m.postMessage({action:"id3Frame",id3Frame:S})}),b.on("caption",function(S){m.postMessage({action:"caption",caption:S})}),b.on("trackinfo",function(S){m.postMessage({action:"trackinfo",trackInfo:S})}),b.on("audioTimingInfo",function(S){m.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:Wi.videoTsToSeconds(S.start),end:Wi.videoTsToSeconds(S.end)}})}),b.on("videoTimingInfo",function(S){m.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:Wi.videoTsToSeconds(S.start),end:Wi.videoTsToSeconds(S.end)}})}),b.on("log",function(S){m.postMessage({action:"log",log:S})})};class Lp{constructor(b,S){this.options=S||{},this.self=b,this.init()}init(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new $y.Transmuxer(this.options),Nv(this.self,this.transmuxer)}pushMp4Captions(b){this.captionParser||(this.captionParser=new cv,this.captionParser.init());const S=new Uint8Array(b.data,b.byteOffset,b.byteLength),E=this.captionParser.parse(S,b.trackIds,b.timescales);this.self.postMessage({action:"mp4Captions",captions:E&&E.captions||[],logs:E&&E.logs||[],data:S.buffer},[S.buffer])}probeMp4StartTime({timescales:b,data:S}){const E=$c.startTime(b,S);this.self.postMessage({action:"probeMp4StartTime",startTime:E,data:S},[S.buffer])}probeMp4Tracks({data:b}){const S=$c.tracks(b);this.self.postMessage({action:"probeMp4Tracks",tracks:S,data:b},[b.buffer])}probeEmsgID3({data:b,offset:S}){const E=$c.getEmsgID3(b,S);this.self.postMessage({action:"probeEmsgID3",id3Frames:E,emsgData:b},[b.buffer])}probeTs({data:b,baseStartTime:S}){const E=typeof S=="number"&&!isNaN(S)?S*Wi.ONE_SECOND_IN_TS:void 0,I=Fv.inspect(b,E);let M=null;I&&(M={hasVideo:I.video&&I.video.length===2||!1,hasAudio:I.audio&&I.audio.length===2||!1},M.hasVideo&&(M.videoStart=I.video[0].ptsTime),M.hasAudio&&(M.audioStart=I.audio[0].ptsTime)),this.self.postMessage({action:"probeTs",result:M,data:b},[b.buffer])}clearAllMp4Captions(){this.captionParser&&this.captionParser.clearAllCaptions()}clearParsedMp4Captions(){this.captionParser&&this.captionParser.clearParsedCaptions()}push(b){const S=new Uint8Array(b.data,b.byteOffset,b.byteLength);this.transmuxer.push(S)}reset(){this.transmuxer.reset()}setTimestampOffset(b){const S=b.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(Wi.secondsToVideoTs(S)))}setAudioAppendStart(b){this.transmuxer.setAudioAppendStart(Math.ceil(Wi.secondsToVideoTs(b.appendStart)))}setRemux(b){this.transmuxer.setRemux(b.remux)}flush(b){this.transmuxer.flush(),self.postMessage({action:"done",type:"transmuxed"})}endTimeline(){this.transmuxer.endTimeline(),self.postMessage({action:"endedtimeline",type:"transmuxed"})}alignGopsWith(b){this.transmuxer.alignGopsWith(b.gopsToAlignWith.slice())}}self.onmessage=function(m){if(m.data.action==="init"&&m.data.options){this.messageHandlers=new Lp(self,m.data.options);return}this.messageHandlers||(this.messageHandlers=new Lp(self)),m.data&&m.data.action&&m.data.action!=="init"&&this.messageHandlers[m.data.action]&&this.messageHandlers[m.data.action](m.data)}}));var W0=Gh(q0);const K0=(s,e,i)=>{const{type:r,initSegment:o,captions:d,captionStreams:h,metadata:g,videoFrameDtsTime:k,videoFramePtsTime:N}=s.data.segment;e.buffer.push({captions:d,captionStreams:h,metadata:g});const Y=s.data.segment.boxes||{data:s.data.segment.data},me={type:r,data:new Uint8Array(Y.data,Y.data.byteOffset,Y.data.byteLength),initSegment:new Uint8Array(o.data,o.byteOffset,o.byteLength)};typeof k!="undefined"&&(me.videoFrameDtsTime=k),typeof N!="undefined"&&(me.videoFramePtsTime=N),i(me)},z0=({transmuxedData:s,callback:e})=>{s.buffer=[],e(s)},Y0=(s,e)=>{e.gopInfo=s.data.gopInfo},Kh=s=>{const{transmuxer:e,bytes:i,audioAppendStart:r,gopsToAlignWith:o,remux:d,onData:h,onTrackInfo:g,onAudioTimingInfo:k,onVideoTimingInfo:N,onVideoSegmentTimingInfo:Y,onAudioSegmentTimingInfo:me,onId3:Ie,onCaptions:Pe,onDone:Ae,onEndedTimeline:$e,onTransmuxerLog:Ye,isEndOfTimeline:Qe}=s,qe={buffer:[]};let ct=Qe;const Je=je=>{e.currentTransmux===s&&(je.data.action==="data"&&K0(je,qe,h),je.data.action==="trackinfo"&&g(je.data.trackInfo),je.data.action==="gopInfo"&&Y0(je,qe),je.data.action==="audioTimingInfo"&&k(je.data.audioTimingInfo),je.data.action==="videoTimingInfo"&&N(je.data.videoTimingInfo),je.data.action==="videoSegmentTimingInfo"&&Y(je.data.videoSegmentTimingInfo),je.data.action==="audioSegmentTimingInfo"&&me(je.data.audioSegmentTimingInfo),je.data.action==="id3Frame"&&Ie([je.data.id3Frame],je.data.id3Frame.dispatchType),je.data.action==="caption"&&Pe(je.data.caption),je.data.action==="endedtimeline"&&(ct=!1,$e()),je.data.action==="log"&&Ye(je.data.log),je.data.type==="transmuxed"&&(ct||(e.onmessage=null,z0({transmuxedData:qe,callback:Ae}),zh(e))))};if(e.onmessage=Je,r&&e.postMessage({action:"setAudioAppendStart",appendStart:r}),Array.isArray(o)&&e.postMessage({action:"alignGopsWith",gopsToAlignWith:o}),typeof d!="undefined"&&e.postMessage({action:"setRemux",remux:d}),i.byteLength){const je=i instanceof ArrayBuffer?i:i.buffer,_t=i instanceof ArrayBuffer?0:i.byteOffset;e.postMessage({action:"push",data:je,byteOffset:_t,byteLength:i.byteLength},[je])}Qe&&e.postMessage({action:"endTimeline"}),e.postMessage({action:"flush"})},zh=s=>{s.currentTransmux=null,s.transmuxQueue.length&&(s.currentTransmux=s.transmuxQueue.shift(),typeof s.currentTransmux=="function"?s.currentTransmux():Kh(s.currentTransmux))},Yh=(s,e)=>{s.postMessage({action:e}),zh(s)},Xh=(s,e)=>{if(!e.currentTransmux){e.currentTransmux=s,Yh(e,s);return}e.transmuxQueue.push(Yh.bind(null,e,s))},X0=s=>{Xh("reset",s)},Q0=s=>{Xh("endTimeline",s)},Qh=s=>{if(!s.transmuxer.currentTransmux){s.transmuxer.currentTransmux=s,Kh(s);return}s.transmuxer.transmuxQueue.push(s)};var pc={reset:X0,endTimeline:Q0,transmux:Qh,createTransmuxer:s=>{const e=new W0;e.currentTransmux=null,e.transmuxQueue=[];const i=e.terminate;return e.terminate=()=>(e.currentTransmux=null,e.transmuxQueue.length=0,i.call(e)),e.postMessage({action:"init",options:s}),e}};const Ql=function(s){const e=s.transmuxer,i=s.endAction||s.action,r=s.callback,o=(0,P.Z)({},s,{endAction:null,transmuxer:null,callback:null}),d=h=>{h.data.action===i&&(e.removeEventListener("message",d),h.data.data&&(h.data.data=new Uint8Array(h.data.data,s.byteOffset||0,s.byteLength||h.data.data.byteLength),s.data&&(s.data=h.data.data)),r(h.data))};if(e.addEventListener("message",d),s.data){const h=s.data instanceof ArrayBuffer;o.byteOffset=h?0:s.data.byteOffset,o.byteLength=s.data.byteLength;const g=[h?s.data:s.data.buffer];e.postMessage(o,g)}else e.postMessage(o)},ws={FAILURE:2,TIMEOUT:-101,ABORTED:-102},mc=s=>{s.forEach(e=>{e.abort()})},J0=s=>({bandwidth:s.bandwidth,bytesReceived:s.bytesReceived||0,roundTripTime:s.roundTripTime||0}),Z0=s=>{const e=s.target,i=Date.now()-e.requestTime,r={bandwidth:Infinity,bytesReceived:0,roundTripTime:i||0};return r.bytesReceived=s.loaded,r.bandwidth=Math.floor(r.bytesReceived/r.roundTripTime*8*1e3),r},gc=(s,e)=>e.timedout?{status:e.status,message:"HLS request timed-out at URL: "+e.uri,code:ws.TIMEOUT,xhr:e}:e.aborted?{status:e.status,message:"HLS request aborted at URL: "+e.uri,code:ws.ABORTED,xhr:e}:s?{status:e.status,message:"HLS request errored at URL: "+e.uri,code:ws.FAILURE,xhr:e}:e.responseType==="arraybuffer"&&e.response.byteLength===0?{status:e.status,message:"Empty HLS response at URL: "+e.uri,code:ws.FAILURE,xhr:e}:null,Jh=(s,e,i)=>(r,o)=>{const d=o.response,h=gc(r,o);if(h)return i(h,s);if(d.byteLength!==16)return i({status:o.status,message:"Invalid HLS key at URL: "+o.uri,code:ws.FAILURE,xhr:o},s);const g=new DataView(d),k=new Uint32Array([g.getUint32(0),g.getUint32(4),g.getUint32(8),g.getUint32(12)]);for(let N=0;N<e.length;N++)e[N].bytes=k;return i(null,s)},Zh=(s,e)=>{const i=$a(s.map.bytes);if(i!=="mp4"){const r=s.map.resolvedUri||s.map.uri;return e({internal:!0,message:`Found unsupported ${i||"unknown"} container for initialization segment at URL: ${r}`,code:ws.FAILURE})}Ql({action:"probeMp4Tracks",data:s.map.bytes,transmuxer:s.transmuxer,callback:({tracks:r,data:o})=>(s.map.bytes=o,r.forEach(function(d){s.map.tracks=s.map.tracks||{},!s.map.tracks[d.type]&&(s.map.tracks[d.type]=d,typeof d.id=="number"&&d.timescale&&(s.map.timescales=s.map.timescales||{},s.map.timescales[d.id]=d.timescale))}),e(null))})},em=({segment:s,finishProcessingFn:e})=>(i,r)=>{const o=gc(i,r);if(o)return e(o,s);const d=new Uint8Array(r.response);if(s.map.key)return s.map.encryptedBytes=d,e(null,s);s.map.bytes=d,Zh(s,function(h){if(h)return h.xhr=r,h.status=r.status,e(h,s);e(null,s)})},tm=({segment:s,finishProcessingFn:e,responseType:i})=>(r,o)=>{const d=gc(r,o);if(d)return e(d,s);const h=i==="arraybuffer"||!o.responseText?o.response:H0(o.responseText.substring(s.lastReachedChar||0));return s.stats=J0(o),s.key?s.encryptedBytes=new Uint8Array(h):s.bytes=new Uint8Array(h),e(null,s)},im=({segment:s,bytes:e,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:d,id3Fn:h,captionsFn:g,isEndOfTimeline:k,endedTimelineFn:N,dataFn:Y,doneFn:me,onTransmuxerLog:Ie})=>{const Pe=s.map&&s.map.tracks||{},Ae=Boolean(Pe.audio&&Pe.video);let $e=r.bind(null,s,"audio","start");const Ye=r.bind(null,s,"audio","end");let Qe=r.bind(null,s,"video","start");const qe=r.bind(null,s,"video","end"),ct=()=>Qh({bytes:e,transmuxer:s.transmuxer,audioAppendStart:s.audioAppendStart,gopsToAlignWith:s.gopsToAlignWith,remux:Ae,onData:Je=>{Je.type=Je.type==="combined"?"video":Je.type,Y(s,Je)},onTrackInfo:Je=>{i&&(Ae&&(Je.isMuxed=!0),i(s,Je))},onAudioTimingInfo:Je=>{$e&&typeof Je.start!="undefined"&&($e(Je.start),$e=null),Ye&&typeof Je.end!="undefined"&&Ye(Je.end)},onVideoTimingInfo:Je=>{Qe&&typeof Je.start!="undefined"&&(Qe(Je.start),Qe=null),qe&&typeof Je.end!="undefined"&&qe(Je.end)},onVideoSegmentTimingInfo:Je=>{o(Je)},onAudioSegmentTimingInfo:Je=>{d(Je)},onId3:(Je,je)=>{h(s,Je,je)},onCaptions:Je=>{g(s,[Je])},isEndOfTimeline:k,onEndedTimeline:()=>{N()},onTransmuxerLog:Ie,onDone:Je=>{!me||(Je.type=Je.type==="combined"?"video":Je.type,me(null,s,Je))}});Ql({action:"probeTs",transmuxer:s.transmuxer,data:e,baseStartTime:s.baseStartTime,callback:Je=>{s.bytes=e=Je.data;const je=Je.result;je&&(i(s,{hasAudio:je.hasAudio,hasVideo:je.hasVideo,isMuxed:Ae}),i=null),ct()}})},ef=({segment:s,bytes:e,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:d,id3Fn:h,captionsFn:g,isEndOfTimeline:k,endedTimelineFn:N,dataFn:Y,doneFn:me,onTransmuxerLog:Ie})=>{let Pe=new Uint8Array(e);if(js(Pe)){s.isFmp4=!0;const{tracks:Ae}=s.map,$e={isFmp4:!0,hasVideo:!!Ae.video,hasAudio:!!Ae.audio};Ae.audio&&Ae.audio.codec&&Ae.audio.codec!=="enca"&&($e.audioCodec=Ae.audio.codec),Ae.video&&Ae.video.codec&&Ae.video.codec!=="encv"&&($e.videoCodec=Ae.video.codec),Ae.video&&Ae.audio&&($e.isMuxed=!0),i(s,$e);const Ye=(Qe,qe)=>{Y(s,{data:Pe,type:$e.hasAudio&&!$e.isMuxed?"audio":"video"}),qe&&qe.length&&h(s,qe),Qe&&Qe.length&&g(s,Qe),me(null,s,{})};Ql({action:"probeMp4StartTime",timescales:s.map.timescales,data:Pe,transmuxer:s.transmuxer,callback:({data:Qe,startTime:qe})=>{e=Qe.buffer,s.bytes=Pe=Qe,$e.hasAudio&&!$e.isMuxed&&r(s,"audio","start",qe),$e.hasVideo&&r(s,"video","start",qe),Ql({action:"probeEmsgID3",data:Pe,transmuxer:s.transmuxer,offset:qe,callback:({emsgData:ct,id3Frames:Je})=>{if(e=ct.buffer,s.bytes=Pe=ct,!Ae.video||!ct.byteLength||!s.transmuxer){Ye(void 0,Je);return}Ql({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:s.transmuxer,data:Pe,timescales:s.map.timescales,trackIds:[Ae.video.id],callback:je=>{e=je.data.buffer,s.bytes=Pe=je.data,je.logs.forEach(function(_t){Ie(Ii(_t,{stream:"mp4CaptionParser"}))}),Ye(je.captions,Je)}})}})}});return}if(!s.transmuxer){me(null,s,{});return}if(typeof s.container=="undefined"&&(s.container=$a(Pe)),s.container!=="ts"&&s.container!=="aac"){i(s,{hasAudio:!1,hasVideo:!1}),me(null,s,{});return}im({segment:s,bytes:e,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:d,id3Fn:h,captionsFn:g,isEndOfTimeline:k,endedTimelineFn:N,dataFn:Y,doneFn:me,onTransmuxerLog:Ie})},tf=function({id:s,key:e,encryptedBytes:i,decryptionWorker:r},o){const d=g=>{if(g.data.source===s){r.removeEventListener("message",d);const k=g.data.decrypted;o(new Uint8Array(k.bytes,k.byteOffset,k.byteLength))}};r.addEventListener("message",d);let h;e.bytes.slice?h=e.bytes.slice():h=new Uint32Array(Array.prototype.slice.call(e.bytes)),r.postMessage(Mh({source:s,encrypted:i,key:h,iv:e.iv}),[i.buffer,h.buffer])},nm=({decryptionWorker:s,segment:e,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:d,id3Fn:h,captionsFn:g,isEndOfTimeline:k,endedTimelineFn:N,dataFn:Y,doneFn:me,onTransmuxerLog:Ie})=>{tf({id:e.requestId,key:e.key,encryptedBytes:e.encryptedBytes,decryptionWorker:s},Pe=>{e.bytes=Pe,ef({segment:e,bytes:e.bytes,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:d,id3Fn:h,captionsFn:g,isEndOfTimeline:k,endedTimelineFn:N,dataFn:Y,doneFn:me,onTransmuxerLog:Ie})})},rm=({activeXhrs:s,decryptionWorker:e,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:d,id3Fn:h,captionsFn:g,isEndOfTimeline:k,endedTimelineFn:N,dataFn:Y,doneFn:me,onTransmuxerLog:Ie})=>{let Pe=0,Ae=!1;return($e,Ye)=>{if(!Ae){if($e)return Ae=!0,mc(s),me($e,Ye);if(Pe+=1,Pe===s.length){const Qe=function(){if(Ye.encryptedBytes)return nm({decryptionWorker:e,segment:Ye,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:d,id3Fn:h,captionsFn:g,isEndOfTimeline:k,endedTimelineFn:N,dataFn:Y,doneFn:me,onTransmuxerLog:Ie});ef({segment:Ye,bytes:Ye.bytes,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:d,id3Fn:h,captionsFn:g,isEndOfTimeline:k,endedTimelineFn:N,dataFn:Y,doneFn:me,onTransmuxerLog:Ie})};if(Ye.endOfAllRequests=Date.now(),Ye.map&&Ye.map.encryptedBytes&&!Ye.map.bytes)return tf({decryptionWorker:e,id:Ye.requestId+"-init",encryptedBytes:Ye.map.encryptedBytes,key:Ye.map.key},qe=>{Ye.map.bytes=qe,Zh(Ye,ct=>{if(ct)return mc(s),me(ct,Ye);Qe()})});Qe()}}}},sm=({loadendState:s,abortFn:e})=>i=>{i.target.aborted&&e&&!s.calledAbortFn&&(e(),s.calledAbortFn=!0)},am=({segment:s,progressFn:e,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:d,id3Fn:h,captionsFn:g,isEndOfTimeline:k,endedTimelineFn:N,dataFn:Y})=>me=>{if(!me.target.aborted)return s.stats=Ii(s.stats,Z0(me)),!s.stats.firstBytesReceivedAt&&s.stats.bytesReceived&&(s.stats.firstBytesReceivedAt=Date.now()),e(me,s)},om=({xhr:s,xhrOptions:e,decryptionWorker:i,segment:r,abortFn:o,progressFn:d,trackInfoFn:h,timingInfoFn:g,videoSegmentTimingInfoFn:k,audioSegmentTimingInfoFn:N,id3Fn:Y,captionsFn:me,isEndOfTimeline:Ie,endedTimelineFn:Pe,dataFn:Ae,doneFn:$e,onTransmuxerLog:Ye})=>{const Qe=[],qe=rm({activeXhrs:Qe,decryptionWorker:i,trackInfoFn:h,timingInfoFn:g,videoSegmentTimingInfoFn:k,audioSegmentTimingInfoFn:N,id3Fn:Y,captionsFn:me,isEndOfTimeline:Ie,endedTimelineFn:Pe,dataFn:Ae,doneFn:$e,onTransmuxerLog:Ye});if(r.key&&!r.key.bytes){const jt=[r.key];r.map&&!r.map.bytes&&r.map.key&&r.map.key.resolvedUri===r.key.resolvedUri&&jt.push(r.map.key);const di=Ii(e,{uri:r.key.resolvedUri,responseType:"arraybuffer"}),pi=Jh(r,jt,qe),nn=s(di,pi);Qe.push(nn)}if(r.map&&!r.map.bytes){if(r.map.key&&(!r.key||r.key.resolvedUri!==r.map.key.resolvedUri)){const qn=Ii(e,{uri:r.map.key.resolvedUri,responseType:"arraybuffer"}),rn=Jh(r,[r.map.key],qe),Ht=s(qn,rn);Qe.push(Ht)}const di=Ii(e,{uri:r.map.resolvedUri,responseType:"arraybuffer",headers:cc(r.map)}),pi=em({segment:r,finishProcessingFn:qe}),nn=s(di,pi);Qe.push(nn)}const ct=Ii(e,{uri:r.part&&r.part.resolvedUri||r.resolvedUri,responseType:"arraybuffer",headers:cc(r)}),Je=tm({segment:r,finishProcessingFn:qe,responseType:ct.responseType}),je=s(ct,Je);je.addEventListener("progress",am({segment:r,progressFn:d,trackInfoFn:h,timingInfoFn:g,videoSegmentTimingInfoFn:k,audioSegmentTimingInfoFn:N,id3Fn:Y,captionsFn:me,isEndOfTimeline:Ie,endedTimelineFn:Pe,dataFn:Ae})),Qe.push(je);const _t={};return Qe.forEach(jt=>{jt.addEventListener("loadend",sm({loadendState:_t,abortFn:o}))}),()=>mc(Qe)},lm=Vr("CodecUtils"),um=function(s){const e=s.attributes||{};if(e.CODECS)return wt(e.CODECS)},nf=(s,e)=>{const i=e.attributes||{};return s&&s.mediaGroups&&s.mediaGroups.AUDIO&&i.AUDIO&&s.mediaGroups.AUDIO[i.AUDIO]},dm=(s,e)=>{if(!nf(s,e))return!0;const i=e.attributes||{},r=s.mediaGroups.AUDIO[i.AUDIO];for(const o in r)if(!r[o].uri&&!r[o].playlists)return!0;return!1},Qu=function(s){const e={};return s.forEach(({mediaType:i,type:r,details:o})=>{e[i]=e[i]||[],e[i].push(Ne(`${r}${o}`))}),Object.keys(e).forEach(function(i){if(e[i].length>1){lm(`multiple ${i} codecs found as attributes: ${e[i].join(", ")}. Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs.`),e[i]=null;return}e[i]=e[i][0]}),e},rf=function(s){let e=0;return s.audio&&e++,s.video&&e++,e},Jl=function(s,e){const i=e.attributes||{},r=Qu(um(e)||[]);if(nf(s,e)&&!r.audio&&!dm(s,e)){const o=Qu(It(s,i.AUDIO)||[]);o.audio&&(r.audio=o.audio)}return r},Ju=Vr("PlaylistSelector"),sf=function(s){if(!s||!s.playlist)return;const e=s.playlist;return JSON.stringify({id:e.id,bandwidth:s.bandwidth,width:s.width,height:s.height,codecs:e.attributes&&e.attributes.CODECS||""})},Zu=function(s,e){if(!s)return"";const i=ae().getComputedStyle(s);return i?i[e]:""},Xo=function(s,e){const i=s.slice();s.sort(function(r,o){const d=e(r,o);return d===0?i.indexOf(r)-i.indexOf(o):d})},yc=function(s,e){let i,r;return s.attributes.BANDWIDTH&&(i=s.attributes.BANDWIDTH),i=i||ae().Number.MAX_VALUE,e.attributes.BANDWIDTH&&(r=e.attributes.BANDWIDTH),r=r||ae().Number.MAX_VALUE,i-r},cm=function(s,e){let i,r;return s.attributes.RESOLUTION&&s.attributes.RESOLUTION.width&&(i=s.attributes.RESOLUTION.width),i=i||ae().Number.MAX_VALUE,e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width&&(r=e.attributes.RESOLUTION.width),r=r||ae().Number.MAX_VALUE,i===r&&s.attributes.BANDWIDTH&&e.attributes.BANDWIDTH?s.attributes.BANDWIDTH-e.attributes.BANDWIDTH:i-r};let af=function(s,e,i,r,o,d){if(!s)return;const h={bandwidth:e,width:i,height:r,limitRenditionByPlayerDimensions:o};let g=s.playlists;hr.isAudioOnly(s)&&(g=d.getAudioTrackPlaylists_(),h.audioOnly=!0);let k=g.map(je=>{let _t;const jt=je.attributes&&je.attributes.RESOLUTION&&je.attributes.RESOLUTION.width,di=je.attributes&&je.attributes.RESOLUTION&&je.attributes.RESOLUTION.height;return _t=je.attributes&&je.attributes.BANDWIDTH,_t=_t||ae().Number.MAX_VALUE,{bandwidth:_t,width:jt,height:di,playlist:je}});Xo(k,(je,_t)=>je.bandwidth-_t.bandwidth),k=k.filter(je=>!hr.isIncompatible(je.playlist));let N=k.filter(je=>hr.isEnabled(je.playlist));N.length||(N=k.filter(je=>!hr.isDisabled(je.playlist)));const Y=N.filter(je=>je.bandwidth*Ln.BANDWIDTH_VARIANCE<e);let me=Y[Y.length-1];const Ie=Y.filter(je=>je.bandwidth===me.bandwidth)[0];if(o===!1){const je=Ie||N[0]||k[0];if(je&&je.playlist){let _t="sortedPlaylistReps";return Ie&&(_t="bandwidthBestRep"),N[0]&&(_t="enabledPlaylistReps"),Ju(`choosing ${sf(je)} using ${_t} with options`,h),je.playlist}return Ju("could not choose a playlist with options",h),null}const Pe=Y.filter(je=>je.width&&je.height);Xo(Pe,(je,_t)=>je.width-_t.width);const Ae=Pe.filter(je=>je.width===i&&je.height===r);me=Ae[Ae.length-1];const $e=Ae.filter(je=>je.bandwidth===me.bandwidth)[0];let Ye,Qe,qe;$e||(Ye=Pe.filter(je=>je.width>i||je.height>r),Qe=Ye.filter(je=>je.width===Ye[0].width&&je.height===Ye[0].height),me=Qe[Qe.length-1],qe=Qe.filter(je=>je.bandwidth===me.bandwidth)[0]);let ct;if(d.leastPixelDiffSelector){const je=Pe.map(_t=>(_t.pixelDiff=Math.abs(_t.width-i)+Math.abs(_t.height-r),_t));Xo(je,(_t,jt)=>_t.pixelDiff===jt.pixelDiff?jt.bandwidth-_t.bandwidth:_t.pixelDiff-jt.pixelDiff),ct=je[0]}const Je=ct||qe||$e||Ie||N[0]||k[0];if(Je&&Je.playlist){let je="sortedPlaylistReps";return ct?je="leastPixelDiffRep":qe?je="resolutionPlusOneRep":$e?je="resolutionBestRep":Ie?je="bandwidthBestRep":N[0]&&(je="enabledPlaylistReps"),Ju(`choosing ${sf(Je)} using ${je} with options`,h),Je.playlist}return Ju("could not choose a playlist with options",h),null};const of=function(){const s=this.useDevicePixelRatio&&ae().devicePixelRatio||1;return af(this.playlists.main,this.systemBandwidth,parseInt(Zu(this.tech_.el(),"width"),10)*s,parseInt(Zu(this.tech_.el(),"height"),10)*s,this.limitRenditionByPlayerDimensions,this.playlistController_)},hm=function(s){let e=-1,i=-1;if(s<0||s>1)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){const r=this.useDevicePixelRatio&&ae().devicePixelRatio||1;return e<0&&(e=this.systemBandwidth,i=this.systemBandwidth),this.systemBandwidth>0&&this.systemBandwidth!==i&&(e=s*this.systemBandwidth+(1-s)*e,i=this.systemBandwidth),af(this.playlists.main,e,parseInt(Zu(this.tech_.el(),"width"),10)*r,parseInt(Zu(this.tech_.el(),"height"),10)*r,this.limitRenditionByPlayerDimensions,this.playlistController_)}},fm=function(s){const{main:e,currentTime:i,bandwidth:r,duration:o,segmentDuration:d,timeUntilRebuffer:h,currentTimeline:g,syncController:k}=s,N=e.playlists.filter(Ae=>!hr.isIncompatible(Ae));let Y=N.filter(hr.isEnabled);Y.length||(Y=N.filter(Ae=>!hr.isDisabled(Ae)));const Ie=Y.filter(hr.hasAttribute.bind(null,"BANDWIDTH")).map(Ae=>{const Ye=k.getSyncPoint(Ae,o,g,i)?1:2,qe=hr.estimateSegmentRequestTime(d,r,Ae)*Ye-h;return{playlist:Ae,rebufferingImpact:qe}}),Pe=Ie.filter(Ae=>Ae.rebufferingImpact<=0);return Xo(Pe,(Ae,$e)=>yc($e.playlist,Ae.playlist)),Pe.length?Pe[0]:(Xo(Ie,(Ae,$e)=>Ae.rebufferingImpact-$e.rebufferingImpact),Ie[0]||null)},pm=function(){const s=this.playlists.main.playlists.filter(hr.isEnabled);return Xo(s,(i,r)=>yc(i,r)),s.filter(i=>!!Jl(this.playlists.main,i).video)[0]||null},mm=s=>{let e=0,i;return s.bytes&&(i=new Uint8Array(s.bytes),s.segments.forEach(r=>{i.set(r,e),e+=r.byteLength})),i},gm=function(s,e,i){if(!s[i]){e.trigger({type:"usage",name:"vhs-608"});let r=i;/^cc708_/.test(i)&&(r="SERVICE"+i.split("_")[1]);const o=e.textTracks().getTrackById(r);if(o)s[i]=o;else{const d=e.options_.vhs&&e.options_.vhs.captionServices||{};let h=i,g=i,k=!1;const N=d[r];N&&(h=N.label,g=N.language,k=N.default),s[i]=e.addRemoteTextTrack({kind:"captions",id:r,default:k,label:h,language:g},!1).track}}},ym=function({inbandTextTracks:s,captionArray:e,timestampOffset:i}){if(!e)return;const r=ae().WebKitDataCue||ae().VTTCue;e.forEach(o=>{const d=o.stream;o.content?o.content.forEach(h=>{const g=new r(o.startTime+i,o.endTime+i,h.text);g.line=h.line,g.align="left",g.position=h.position,g.positionAlign="line-left",s[d].addCue(g)}):s[d].addCue(new r(o.startTime+i,o.endTime+i,o.text))})},vm=function(s){Object.defineProperties(s.frame,{id:{get(){return ze.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),s.value.key}},value:{get(){return ze.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),s.value.data}},privateData:{get(){return ze.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),s.value.data}}})},Am=({inbandTextTracks:s,metadataArray:e,timestampOffset:i,videoDuration:r})=>{if(!e)return;const o=ae().WebKitDataCue||ae().VTTCue,d=s.metadataTrack_;if(!d||(e.forEach(Y=>{const me=Y.cueTime+i;typeof me!="number"||ae().isNaN(me)||me<0||!(me<Infinity)||!Y.frames||!Y.frames.length||Y.frames.forEach(Ie=>{const Pe=new o(me,me,Ie.value||Ie.url||Ie.data||"");Pe.frame=Ie,Pe.value=Ie,vm(Pe),d.addCue(Pe)})}),!d.cues||!d.cues.length))return;const h=d.cues,g=[];for(let Y=0;Y<h.length;Y++)h[Y]&&g.push(h[Y]);const k=g.reduce((Y,me)=>{const Ie=Y[me.startTime]||[];return Ie.push(me),Y[me.startTime]=Ie,Y},{}),N=Object.keys(k).sort((Y,me)=>Number(Y)-Number(me));N.forEach((Y,me)=>{const Ie=k[Y],Pe=isFinite(r)?r:0,Ae=Number(N[me+1])||Pe;Ie.forEach($e=>{$e.endTime=Ae})})},bm={id:"ID",class:"CLASS",startDate:"START-DATE",duration:"DURATION",endDate:"END-DATE",endOnNext:"END-ON-NEXT",plannedDuration:"PLANNED-DURATION",scte35Out:"SCTE35-OUT",scte35In:"SCTE35-IN"},_m=new Set(["id","class","startDate","duration","endDate","endOnNext","startTime","endTime","processDateRange"]),xm=({inbandTextTracks:s,dateRanges:e})=>{const i=s.metadataTrack_;if(!i)return;const r=ae().WebKitDataCue||ae().VTTCue;e.forEach(o=>{for(const d of Object.keys(o)){if(_m.has(d))continue;const h=new r(o.startTime,o.endTime,"");h.id=o.id,h.type="com.apple.quicktime.HLS",h.value={key:bm[d],data:o[d]},(d==="scte35Out"||d==="scte35In")&&(h.value.data=new Uint8Array(h.value.data.match(/[\da-f]{2}/gi)).buffer),i.addCue(h)}o.processDateRange()})},lf=(s,e,i)=>{s.metadataTrack_||(s.metadataTrack_=i.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,ze.browser.IS_ANY_SAFARI||(s.metadataTrack_.inBandMetadataTrackDispatchType=e))},Zl=function(s,e,i){let r,o;if(!!i&&!!i.cues)for(r=i.cues.length;r--;)o=i.cues[r],o.startTime>=s&&o.endTime<=e&&i.removeCue(o)},Em=function(s){const e=s.cues;if(!e)return;const i={};for(let r=e.length-1;r>=0;r--){const o=e[r],d=`${o.startTime}-${o.endTime}-${o.text}`;i[d]?s.removeCue(o):i[d]=o}},Tm=(s,e,i)=>{if(typeof e=="undefined"||e===null||!s.length)return[];const r=Math.ceil((e-i+3)*$s.ONE_SECOND_IN_TS);let o;for(o=0;o<s.length&&!(s[o].pts>r);o++);return s.slice(o)},Sm=(s,e,i)=>{if(!e.length)return s;if(i)return e.slice();const r=e[0].pts;let o=0;for(o;o<s.length&&!(s[o].pts>=r);o++);return s.slice(0,o).concat(e)},Cm=(s,e,i,r)=>{const o=Math.ceil((e-r)*$s.ONE_SECOND_IN_TS),d=Math.ceil((i-r)*$s.ONE_SECOND_IN_TS),h=s.slice();let g=s.length;for(;g--&&!(s[g].pts<=d););if(g===-1)return h;let k=g+1;for(;k--&&!(s[k].pts<=o););return k=Math.max(k,0),h.splice(k,g-k+1),h},wm=function(s,e){if(!s&&!e||!s&&e||s&&!e)return!1;if(s===e)return!0;const i=Object.keys(s).sort(),r=Object.keys(e).sort();if(i.length!==r.length)return!1;for(let o=0;o<i.length;o++){const d=i[o];if(d!==r[o]||s[d]!==e[d])return!1}return!0},uf=22,Lm=function(s,e,i){e=e||[];const r=[];let o=0;for(let d=0;d<e.length;d++){const h=e[d];if(s===h.timeline&&(r.push(d),o+=h.duration,o>i))return d}return r.length===0?0:r[r.length-1]},eu=1,km=500,df=s=>typeof s=="number"&&isFinite(s),ed=1/60,Dm=(s,e,i)=>s!=="main"||!e||!i?null:!i.hasAudio&&!i.hasVideo?"Neither audio nor video found in segment.":e.hasVideo&&!i.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!e.hasVideo&&i.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null,Im=(s,e,i)=>{let r=e-Ln.BACK_BUFFER_LENGTH;s.length&&(r=Math.max(r,s.start(0)));const o=e-i;return Math.min(o,r)},Qo=s=>{const{startOfSegment:e,duration:i,segment:r,part:o,playlist:{mediaSequence:d,id:h,segments:g=[]},mediaIndex:k,partIndex:N,timeline:Y}=s,me=g.length-1;let Ie="mediaIndex/partIndex increment";s.getMediaInfoForTime?Ie=`getMediaInfoForTime (${s.getMediaInfoForTime})`:s.isSyncRequest&&(Ie="getSyncSegmentCandidate (isSyncRequest)"),s.independent&&(Ie+=` with independent ${s.independent}`);const Pe=typeof N=="number",Ae=s.segment.uri?"segment":"pre-segment",$e=Pe?bh({preloadSegment:r})-1:0;return`${Ae} [${d+k}/${d+me}]`+(Pe?` part [${N}/${$e}]`:"")+` segment start/end [${r.start} => ${r.end}]`+(Pe?` part start/end [${o.start} => ${o.end}]`:"")+` startOfSegment [${e}] duration [${i}] timeline [${Y}] selected by [${Ie}] playlist [${h}]`},cf=s=>`${s}TimingInfo`,hf=(s,e)=>s.length?s.end(s.length-1):e,Rm=({segmentTimeline:s,currentTimeline:e,startOfSegment:i,buffered:r,calculateTimestampOffsetForEachSegment:o,overrideCheck:d})=>o?hf(r,i):!d&&s===e?null:s<e?i:hf(r,i),ff=({timelineChangeController:s,currentTimeline:e,segmentTimeline:i,loaderType:r,audioDisabled:o})=>{if(e===i)return!1;if(r==="audio"){const d=s.lastTimelineChange({type:"main"});return!d||d.to!==i}if(r==="main"&&o){const d=s.pendingTimelineChange({type:"audio"});return!(d&&d.to===i)}return!1},Om=s=>{let e=0;return["video","audio"].forEach(function(i){const r=s[`${i}TimingInfo`];if(!r)return;const{start:o,end:d}=r;let h;typeof o=="bigint"||typeof d=="bigint"?h=ae().BigInt(d)-ae().BigInt(o):typeof o=="number"&&typeof d=="number"&&(h=d-o),typeof h!="undefined"&&h>e&&(e=h)}),typeof e=="bigint"&&e<Number.MAX_SAFE_INTEGER&&(e=Number(e)),e},pf=({segmentDuration:s,maxDuration:e})=>s?Math.round(s)>e+Ta:!1,Pm=(s,e)=>{if(e!=="hls")return null;const i=Om({audioTimingInfo:s.audioTimingInfo,videoTimingInfo:s.videoTimingInfo});if(!i)return null;const r=s.playlist.targetDuration,o=pf({segmentDuration:i,maxDuration:r*2}),d=pf({segmentDuration:i,maxDuration:r}),h=`Segment with index ${s.mediaIndex} from playlist ${s.playlist.id} has a duration of ${i} when the reported duration is ${s.duration} and the target duration is ${r}. For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1`;return o||d?{severity:o?"warn":"info",message:h}:null};class vc extends ze.EventTarget{constructor(e,i={}){super();if(!e)throw new TypeError("Initialization settings are required");if(typeof e.currentTime!="function")throw new TypeError("No currentTime getter specified");if(!e.mediaSource)throw new TypeError("No MediaSource specified");this.bandwidth=e.bandwidth,this.throughput={rate:0,count:0},this.roundTrip=NaN,this.resetStats_(),this.mediaIndex=null,this.partIndex=null,this.hasPlayed_=e.hasPlayed,this.currentTime_=e.currentTime,this.seekable_=e.seekable,this.seeking_=e.seeking,this.duration_=e.duration,this.mediaSource_=e.mediaSource,this.vhs_=e.vhs,this.loaderType_=e.loaderType,this.currentMediaInfo_=void 0,this.startingMediaInfo_=void 0,this.segmentMetadataTrack_=e.segmentMetadataTrack,this.goalBufferLength_=e.goalBufferLength,this.sourceType_=e.sourceType,this.sourceUpdater_=e.sourceUpdater,this.inbandTextTracks_=e.inbandTextTracks,this.state_="INIT",this.timelineChangeController_=e.timelineChangeController,this.shouldSaveSegmentTimingInfo_=!0,this.parse708captions_=e.parse708captions,this.useDtsForTimestampOffset_=e.useDtsForTimestampOffset,this.calculateTimestampOffsetForEachSegment_=e.calculateTimestampOffsetForEachSegment,this.captionServices_=e.captionServices,this.exactManifestTimings=e.exactManifestTimings,this.addMetadataToTextTrack=e.addMetadataToTextTrack,this.checkBufferTimeout_=null,this.error_=void 0,this.currentTimeline_=-1,this.pendingSegment_=null,this.xhrOptions_=null,this.pendingSegments_=[],this.audioDisabled_=!1,this.isPendingTimestampOffset_=!1,this.gopBuffer_=[],this.timeMapping_=0,this.safeAppend_=!1,this.appendInitSegment_={audio:!0,video:!0},this.playlistOfLastInitSegment_={audio:null,video:null},this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_={id3:[],caption:[]},this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=null,this.activeInitSegmentId_=null,this.initSegments_={},this.cacheEncryptionKeys_=e.cacheEncryptionKeys,this.keyCache_={},this.decrypter_=e.decrypter,this.syncController_=e.syncController,this.syncPoint_={segmentIndex:0,time:0},this.transmuxer_=this.createTransmuxer_(),this.triggerSyncInfoUpdate_=()=>this.trigger("syncinfoupdate"),this.syncController_.on("syncinfoupdate",this.triggerSyncInfoUpdate_),this.mediaSource_.addEventListener("sourceopen",()=>{this.isEndOfStream_()||(this.ended_=!1)}),this.fetchAtBuffer_=!1,this.replaceSegmentsUntil_=-1,this.logger_=Vr(`SegmentLoader[${this.loaderType_}]`),Object.defineProperty(this,"state",{get(){return this.state_},set(r){r!==this.state_&&(this.logger_(`${this.state_} -> ${r}`),this.state_=r,this.trigger("statechange"))}}),this.sourceUpdater_.on("ready",()=>{this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}),this.loaderType_==="main"&&this.timelineChangeController_.on("pendingtimelinechange",()=>{this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}),this.loaderType_==="audio"&&this.timelineChangeController_.on("timelinechange",()=>{this.hasEnoughInfoToLoad_()&&this.processLoadQueue_(),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()})}createTransmuxer_(){return pc.createTransmuxer({remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,parse708captions:this.parse708captions_,captionServices:this.captionServices_})}resetStats_(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0,this.mediaAppends=0}dispose(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&this.transmuxer_.terminate(),this.resetStats_(),this.checkBufferTimeout_&&ae().clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()}setAudio(e){this.audioDisabled_=!e,e?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())}abort(){if(this.state!=="WAITING"){this.pendingSegment_&&(this.pendingSegment_=null);return}this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()}abort_(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_),this.waitingOnRemove_=!1,ae().clearTimeout(this.quotaExceededErrorRetryTimeout_),this.quotaExceededErrorRetryTimeout_=null}checkForAbort_(e){return this.state==="APPENDING"&&!this.pendingSegment_?(this.state="READY",!0):!this.pendingSegment_||this.pendingSegment_.requestId!==e}error(e){return typeof e!="undefined"&&(this.logger_("error occurred:",e),this.error_=e),this.pendingSegment_=null,this.error_}endOfStream(){this.ended_=!0,this.transmuxer_&&pc.reset(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")}buffered_(){const e=this.getMediaInfo_();if(!this.sourceUpdater_||!e)return Gn();if(this.loaderType_==="main"){const{hasAudio:i,hasVideo:r,isMuxed:o}=e;if(r&&i&&!this.audioDisabled_&&!o)return this.sourceUpdater_.buffered();if(r)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()}initSegmentForMap(e,i=!1){if(!e)return null;const r=Xu(e);let o=this.initSegments_[r];return i&&!o&&e.bytes&&(this.initSegments_[r]=o={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,tracks:e.tracks,timescales:e.timescales}),o||e}segmentKey(e,i=!1){if(!e)return null;const r=Fh(e);let o=this.keyCache_[r];this.cacheEncryptionKeys_&&i&&!o&&e.bytes&&(this.keyCache_[r]=o={resolvedUri:e.resolvedUri,bytes:e.bytes});const d={resolvedUri:(o||e).resolvedUri};return o&&(d.bytes=o.bytes),d}couldBeginLoading_(){return this.playlist_&&!this.paused()}load(){if(this.monitorBuffer_(),!!this.playlist_){if(this.state==="INIT"&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||this.state!=="READY"&&this.state!=="INIT"||(this.state="READY")}}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}playlist(e,i={}){if(!e)return;const r=this.playlist_,o=this.pendingSegment_;this.playlist_=e,this.xhrOptions_=i,this.state==="INIT"&&(e.syncInfo={mediaSequence:e.mediaSequence,time:0},this.loaderType_==="main"&&this.syncController_.setDateTimeMappingForStart(e));let d=null;if(r&&(r.id?d=r.id:r.uri&&(d=r.uri)),this.logger_(`playlist update [${d} => ${e.id||e.uri}]`),this.trigger("syncinfoupdate"),this.state==="INIT"&&this.couldBeginLoading_())return this.init_();if(!r||r.uri!==e.uri){this.mediaIndex!==null&&(!e.endList&&typeof e.partTargetDuration=="number"?this.resetLoader():this.resyncLoader()),this.currentMediaInfo_=void 0,this.trigger("playlistupdate");return}const h=e.mediaSequence-r.mediaSequence;if(this.logger_(`live window shift [${h}]`),this.mediaIndex!==null)if(this.mediaIndex-=h,this.mediaIndex<0)this.mediaIndex=null,this.partIndex=null;else{const g=this.playlist_.segments[this.mediaIndex];if(this.partIndex&&(!g.parts||!g.parts.length||!g.parts[this.partIndex])){const k=this.mediaIndex;this.logger_(`currently processing part (index ${this.partIndex}) no longer exists.`),this.resetLoader(),this.mediaIndex=k}}o&&(o.mediaIndex-=h,o.mediaIndex<0?(o.mediaIndex=null,o.partIndex=null):(o.mediaIndex>=0&&(o.segment=e.segments[o.mediaIndex]),o.partIndex>=0&&o.segment.parts&&(o.part=o.segment.parts[o.partIndex]))),this.syncController_.saveExpiredSegmentInfo(r,e)}pause(){this.checkBufferTimeout_&&(ae().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}paused(){return this.checkBufferTimeout_===null}resetLoaderProperties(){this.ended_=!1,this.activeInitSegmentId_=null,this.appendInitSegment_={audio:!0,video:!0}}resetEverything(e){this.resetLoaderProperties(),this.resetLoader(),this.remove(0,Infinity,e),this.transmuxer_&&(this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.transmuxer_.postMessage({action:"reset"}))}resetLoader(){this.fetchAtBuffer_=!1,this.resyncLoader()}resyncLoader(){this.transmuxer_&&pc.reset(this.transmuxer_),this.mediaIndex=null,this.partIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}remove(e,i,r=()=>{},o=!1){if(i===Infinity&&(i=this.duration_()),i<=e){this.logger_("skipping remove because end ${end} is <= start ${start}");return}if(!this.sourceUpdater_||!this.getMediaInfo_()){this.logger_("skipping remove because no source updater or starting media info");return}let d=1;const h=()=>{d--,d===0&&r()};(o||!this.audioDisabled_)&&(d++,this.sourceUpdater_.removeAudio(e,i,h)),(o||this.loaderType_==="main")&&(this.gopBuffer_=Cm(this.gopBuffer_,e,i,this.timeMapping_),d++,this.sourceUpdater_.removeVideo(e,i,h));for(const g in this.inbandTextTracks_)Zl(e,i,this.inbandTextTracks_[g]);Zl(e,i,this.segmentMetadataTrack_),h()}monitorBuffer_(){this.checkBufferTimeout_&&ae().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=ae().setTimeout(this.monitorBufferTick_.bind(this),1)}monitorBufferTick_(){this.state==="READY"&&this.fillBuffer_(),this.checkBufferTimeout_&&ae().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=ae().setTimeout(this.monitorBufferTick_.bind(this),km)}fillBuffer_(){if(this.sourceUpdater_.updating())return;const e=this.chooseNextRequest_();!e||(typeof e.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!1,this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline})),this.loadSegment_(e))}isEndOfStream_(e=this.mediaIndex,i=this.playlist_,r=this.partIndex){if(!i||!this.mediaSource_)return!1;const o=typeof e=="number"&&i.segments[e],d=e+1===i.segments.length,h=!o||!o.parts||r+1===o.parts.length;return i.endList&&this.mediaSource_.readyState==="open"&&d&&h}chooseNextRequest_(){const e=this.buffered_(),i=vh(e)||0,r=tc(e,this.currentTime_()),o=!this.hasPlayed_()&&r>=1,d=r>=this.goalBufferLength_(),h=this.playlist_.segments;if(!h.length||o||d)return null;this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_());const g={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:Boolean(!this.syncPoint_)};if(g.isSyncRequest)g.mediaIndex=Lm(this.currentTimeline_,h,i);else if(this.mediaIndex!==null){const Ie=h[this.mediaIndex],Pe=typeof this.partIndex=="number"?this.partIndex:-1;g.startOfSegment=Ie.end?Ie.end:i,Ie.parts&&Ie.parts[Pe+1]?(g.mediaIndex=this.mediaIndex,g.partIndex=Pe+1):g.mediaIndex=this.mediaIndex+1}else{const{segmentIndex:Ie,startTime:Pe,partIndex:Ae}=hr.getMediaInfoForTime({exactManifestTimings:this.exactManifestTimings,playlist:this.playlist_,currentTime:this.fetchAtBuffer_?i:this.currentTime_(),startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time});g.getMediaInfoForTime=this.fetchAtBuffer_?`bufferedEnd ${i}`:`currentTime ${this.currentTime_()}`,g.mediaIndex=Ie,g.startOfSegment=Pe,g.partIndex=Ae}const k=h[g.mediaIndex];let N=k&&typeof g.partIndex=="number"&&k.parts&&k.parts[g.partIndex];if(!k||typeof g.partIndex=="number"&&!N)return null;typeof g.partIndex!="number"&&k.parts&&(g.partIndex=0,N=k.parts[0]);const Y=this.vhs_.playlists&&this.vhs_.playlists.main&&this.vhs_.playlists.main.independentSegments||this.playlist_.independentSegments;if(!r&&N&&!Y&&!N.independent)if(g.partIndex===0){const Ie=h[g.mediaIndex-1],Pe=Ie.parts&&Ie.parts.length&&Ie.parts[Ie.parts.length-1];Pe&&Pe.independent&&(g.mediaIndex-=1,g.partIndex=Ie.parts.length-1,g.independent="previous segment")}else k.parts[g.partIndex-1].independent&&(g.partIndex-=1,g.independent="previous part");const me=this.mediaSource_&&this.mediaSource_.readyState==="ended";return g.mediaIndex>=h.length-1&&me&&!this.seeking_()?null:this.generateSegmentInfo_(g)}generateSegmentInfo_(e){const{independent:i,playlist:r,mediaIndex:o,startOfSegment:d,isSyncRequest:h,partIndex:g,forceTimestampOffset:k,getMediaInfoForTime:N}=e,Y=r.segments[o],me=typeof g=="number"&&Y.parts[g],Ie={requestId:"segment-loader-"+Math.random(),uri:me&&me.resolvedUri||Y.resolvedUri,mediaIndex:o,partIndex:me?g:null,isSyncRequest:h,startOfSegment:d,playlist:r,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:Y.timeline,duration:me&&me.duration||Y.duration,segment:Y,part:me,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:N,independent:i},Pe=typeof k!="undefined"?k:this.isPendingTimestampOffset_;Ie.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:Y.timeline,currentTimeline:this.currentTimeline_,startOfSegment:d,buffered:this.buffered_(),calculateTimestampOffsetForEachSegment:this.calculateTimestampOffsetForEachSegment_,overrideCheck:Pe});const Ae=vh(this.sourceUpdater_.audioBuffered());return typeof Ae=="number"&&(Ie.audioAppendStart=Ae-this.sourceUpdater_.audioTimestampOffset()),this.sourceUpdater_.videoBuffered().length&&(Ie.gopsToAlignWith=Tm(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),Ie}timestampOffsetForSegment_(e){return Rm(e)}earlyAbortWhenNeeded_(e){if(this.vhs_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH||Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)return;const i=this.currentTime_(),r=e.bandwidth,o=this.pendingSegment_.duration,d=hr.estimateSegmentRequestTime(o,r,this.playlist_,e.bytesReceived),h=i0(this.buffered_(),i,this.vhs_.tech_.playbackRate())-1;if(d<=h)return;const g=fm({main:this.vhs_.playlists.main,currentTime:i,bandwidth:r,duration:this.duration_(),segmentDuration:o,timeUntilRebuffer:h,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(!g)return;const N=d-h-g.rebufferingImpact;let Y=.5;h<=Ta&&(Y=1),!(!g.playlist||g.playlist.uri===this.playlist_.uri||N<Y)&&(this.bandwidth=g.playlist.attributes.BANDWIDTH*Ln.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort"))}handleAbort_(e){this.logger_(`Aborting ${Qo(e)}`),this.mediaRequestsAborted+=1}handleProgress_(e,i){this.earlyAbortWhenNeeded_(i.stats),!this.checkForAbort_(i.requestId)&&this.trigger("progress")}handleTrackInfo_(e,i){this.earlyAbortWhenNeeded_(e.stats),!this.checkForAbort_(e.requestId)&&(this.checkForIllegalMediaSwitch(i)||(i=i||{},wm(this.currentMediaInfo_,i)||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=i,this.currentMediaInfo_=i,this.logger_("trackinfo update",i),this.trigger("trackinfo")),!this.checkForAbort_(e.requestId)&&(this.pendingSegment_.trackInfo=i,this.hasEnoughInfoToAppend_()&&this.processCallQueue_())))}handleTimingInfo_(e,i,r,o){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;const d=this.pendingSegment_,h=cf(i);d[h]=d[h]||{},d[h][r]=o,this.logger_(`timinginfo: ${i} - ${r} - ${o}`),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}handleCaptions_(e,i){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(i.length===0){this.logger_("SegmentLoader received no captions from a caption event");return}if(!this.pendingSegment_.hasAppendedData_){this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,e,i));return}const o=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),d={};i.forEach(h=>{d[h.stream]=d[h.stream]||{startTime:Infinity,captions:[],endTime:0};const g=d[h.stream];g.startTime=Math.min(g.startTime,h.startTime+o),g.endTime=Math.max(g.endTime,h.endTime+o),g.captions.push(h)}),Object.keys(d).forEach(h=>{const{startTime:g,endTime:k,captions:N}=d[h],Y=this.inbandTextTracks_;this.logger_(`adding cues from ${g} -> ${k} for ${h}`),gm(Y,this.vhs_.tech_,h),Zl(g,k,Y[h]),ym({captionArray:N,inbandTextTracks:Y,timestampOffset:o})}),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}handleId3_(e,i,r){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(!this.pendingSegment_.hasAppendedData_){this.metadataQueue_.id3.push(this.handleId3_.bind(this,e,i,r));return}this.addMetadataToTextTrack(r,i,this.duration_())}processMetadataQueue_(){this.metadataQueue_.id3.forEach(e=>e()),this.metadataQueue_.caption.forEach(e=>e()),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]}processCallQueue_(){const e=this.callQueue_;this.callQueue_=[],e.forEach(i=>i())}processLoadQueue_(){const e=this.loadQueue_;this.loadQueue_=[],e.forEach(i=>i())}hasEnoughInfoToLoad_(){if(this.loaderType_!=="audio")return!0;const e=this.pendingSegment_;return e?this.getCurrentMediaInfo_()?!ff({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}):!0:!1}getCurrentMediaInfo_(e=this.pendingSegment_){return e&&e.trackInfo||this.currentMediaInfo_}getMediaInfo_(e=this.pendingSegment_){return this.getCurrentMediaInfo_(e)||this.startingMediaInfo_}getPendingSegmentPlaylist(){return this.pendingSegment_?this.pendingSegment_.playlist:null}hasEnoughInfoToAppend_(){if(!this.sourceUpdater_.ready()||this.waitingOnRemove_||this.quotaExceededErrorRetryTimeout_)return!1;const e=this.pendingSegment_,i=this.getCurrentMediaInfo_();if(!e||!i)return!1;const{hasAudio:r,hasVideo:o,isMuxed:d}=i;return!(o&&!e.videoTimingInfo||r&&!this.audioDisabled_&&!d&&!e.audioTimingInfo||ff({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))}handleData_(e,i){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(this.callQueue_.length||!this.hasEnoughInfoToAppend_()){this.callQueue_.push(this.handleData_.bind(this,e,i));return}const r=this.pendingSegment_;if(this.setTimeMapping_(r.timeline),this.updateMediaSecondsLoaded_(r.part||r.segment),this.mediaSource_.readyState!=="closed"){if(e.map&&(e.map=this.initSegmentForMap(e.map,!0),r.segment.map=e.map),e.key&&this.segmentKey(e.key,!0),r.isFmp4=e.isFmp4,r.timingInfo=r.timingInfo||{},r.isFmp4)this.trigger("fmp4"),r.timingInfo.start=r[cf(i.type)].start;else{const o=this.getCurrentMediaInfo_(),d=this.loaderType_==="main"&&o&&o.hasVideo;let h;d&&(h=r.videoTimingInfo.start),r.timingInfo.start=this.trueSegmentStart_({currentStart:r.timingInfo.start,playlist:r.playlist,mediaIndex:r.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:d,firstVideoFrameTimeForData:h,videoTimingInfo:r.videoTimingInfo,audioTimingInfo:r.audioTimingInfo})}if(this.updateAppendInitSegmentStatus(r,i.type),this.updateSourceBufferTimestampOffset_(r),r.isSyncRequest){this.updateTimingInfoEnd_(r),this.syncController_.saveSegmentTimingInfo({segmentInfo:r,shouldSaveTimelineMapping:this.loaderType_==="main"});const o=this.chooseNextRequest_();if(o.mediaIndex!==r.mediaIndex||o.partIndex!==r.partIndex){this.logger_("sync segment was incorrect, not appending");return}this.logger_("sync segment was correct, appending")}r.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(r,i)}}updateAppendInitSegmentStatus(e,i){this.loaderType_==="main"&&typeof e.timestampOffset=="number"&&!e.changedTimestampOffset&&(this.appendInitSegment_={audio:!0,video:!0}),this.playlistOfLastInitSegment_[i]!==e.playlist&&(this.appendInitSegment_[i]=!0)}getInitSegmentAndUpdateState_({type:e,initSegment:i,map:r,playlist:o}){if(r){const d=Xu(r);if(this.activeInitSegmentId_===d)return null;i=this.initSegmentForMap(r,!0).bytes,this.activeInitSegmentId_=d}return i&&this.appendInitSegment_[e]?(this.playlistOfLastInitSegment_[e]=o,this.appendInitSegment_[e]=!1,this.activeInitSegmentId_=null,i):null}handleQuotaExceededError_({segmentInfo:e,type:i,bytes:r},o){const d=this.sourceUpdater_.audioBuffered(),h=this.sourceUpdater_.videoBuffered();d.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+eo(d).join(", ")),h.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+eo(h).join(", "));const g=d.length?d.start(0):0,k=d.length?d.end(d.length-1):0,N=h.length?h.start(0):0,Y=h.length?h.end(h.length-1):0;if(k-g<=eu&&Y-N<=eu){this.logger_(`On QUOTA_EXCEEDED_ERR, single segment too large to append to buffer, triggering an error. Appended byte length: ${r.byteLength}, audio buffer: ${eo(d).join(", ")}, video buffer: ${eo(h).join(", ")}, `),this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:Infinity}),this.trigger("error");return}this.waitingOnRemove_=!0,this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:e,type:i,bytes:r}));const Ie=this.currentTime_()-eu;this.logger_(`On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to ${Ie}`),this.remove(0,Ie,()=>{this.logger_(`On QUOTA_EXCEEDED_ERR, retrying append in ${eu}s`),this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=ae().setTimeout(()=>{this.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue"),this.quotaExceededErrorRetryTimeout_=null,this.processCallQueue_()},eu*1e3)},!0)}handleAppendError_({segmentInfo:e,type:i,bytes:r},o){if(!!o){if(o.code===uf){this.handleQuotaExceededError_({segmentInfo:e,type:i,bytes:r});return}this.logger_("Received non QUOTA_EXCEEDED_ERR on append",o),this.error(`${i} append of ${r.length}b failed for segment #${e.mediaIndex} in playlist ${e.playlist.id}`),this.trigger("appenderror")}}appendToSourceBuffer_({segmentInfo:e,type:i,initSegment:r,data:o,bytes:d}){if(!d){const h=[o];let g=o.byteLength;r&&(h.unshift(r),g+=r.byteLength),d=mm({bytes:g,segments:h})}this.sourceUpdater_.appendBuffer({segmentInfo:e,type:i,bytes:d},this.handleAppendError_.bind(this,{segmentInfo:e,type:i,bytes:d}))}handleSegmentTimingInfo_(e,i,r){if(!this.pendingSegment_||i!==this.pendingSegment_.requestId)return;const o=this.pendingSegment_.segment,d=`${e}TimingInfo`;o[d]||(o[d]={}),o[d].transmuxerPrependedSeconds=r.prependedContentDuration||0,o[d].transmuxedPresentationStart=r.start.presentation,o[d].transmuxedDecodeStart=r.start.decode,o[d].transmuxedPresentationEnd=r.end.presentation,o[d].transmuxedDecodeEnd=r.end.decode,o[d].baseMediaDecodeTime=r.baseMediaDecodeTime}appendData_(e,i){const{type:r,data:o}=i;if(!o||!o.byteLength||r==="audio"&&this.audioDisabled_)return;const d=this.getInitSegmentAndUpdateState_({type:r,initSegment:i.initSegment,playlist:e.playlist,map:e.isFmp4?e.segment.map:null});this.appendToSourceBuffer_({segmentInfo:e,type:r,initSegment:d,data:o})}loadSegment_(e){if(this.state="WAITING",this.pendingSegment_=e,this.trimBackBuffer_(e),typeof e.timestampOffset=="number"&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),!this.hasEnoughInfoToLoad_()){this.loadQueue_.push(()=>{const i=(0,P.Z)({},e,{forceTimestampOffset:!0});(0,P.Z)(e,this.generateSegmentInfo_(i)),this.isPendingTimestampOffset_=!1,this.updateTransmuxerAndRequestSegment_(e)});return}this.updateTransmuxerAndRequestSegment_(e)}updateTransmuxerAndRequestSegment_(e){this.shouldUpdateTransmuxerTimestampOffset_(e.timestampOffset)&&(this.gopBuffer_.length=0,e.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e.timestampOffset}));const i=this.createSimplifiedSegmentObj_(e),r=this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex),o=this.mediaIndex!==null,d=e.timeline!==this.currentTimeline_&&e.timeline>0,h=r||o&&d;this.logger_(`Requesting ${Qo(e)}`),i.map&&!i.map.bytes&&(this.logger_("going to request init segment."),this.appendInitSegment_={video:!0,audio:!0}),e.abortRequests=om({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:i,abortFn:this.handleAbort_.bind(this,e),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",e.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",e.requestId),captionsFn:this.handleCaptions_.bind(this),isEndOfTimeline:h,endedTimelineFn:()=>{this.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this),onTransmuxerLog:({message:g,level:k,stream:N})=>{this.logger_(`${Qo(e)} logged from transmuxer stream ${N} as a ${k}: ${g}`)}})}trimBackBuffer_(e){const i=Im(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);i>0&&this.remove(0,i)}createSimplifiedSegmentObj_(e){const i=e.segment,r=e.part,o={resolvedUri:r?r.resolvedUri:i.resolvedUri,byterange:r?r.byterange:i.byterange,requestId:e.requestId,transmuxer:e.transmuxer,audioAppendStart:e.audioAppendStart,gopsToAlignWith:e.gopsToAlignWith,part:e.part},d=e.playlist.segments[e.mediaIndex-1];if(d&&d.timeline===i.timeline&&(d.videoTimingInfo?o.baseStartTime=d.videoTimingInfo.transmuxedDecodeEnd:d.audioTimingInfo&&(o.baseStartTime=d.audioTimingInfo.transmuxedDecodeEnd)),i.key){const h=i.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);o.key=this.segmentKey(i.key),o.key.iv=h}return i.map&&(o.map=this.initSegmentForMap(i.map)),o}saveTransferStats_(e){this.mediaRequests+=1,e&&(this.mediaBytesTransferred+=e.bytesReceived,this.mediaTransferDuration+=e.roundTripTime)}saveBandwidthRelatedStats_(e,i){if(this.pendingSegment_.byteLength=i.bytesReceived,e<ed){this.logger_(`Ignoring segment's bandwidth because its duration of ${e} is less than the min to record ${ed}`);return}this.bandwidth=i.bandwidth,this.roundTrip=i.roundTripTime}handleTimeout_(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate"),this.trigger("timeout")}segmentRequestFinished_(e,i,r){if(this.callQueue_.length){this.callQueue_.push(this.segmentRequestFinished_.bind(this,e,i,r));return}if(this.saveTransferStats_(i.stats),!this.pendingSegment_||i.requestId!==this.pendingSegment_.requestId)return;if(e){if(this.pendingSegment_=null,this.state="READY",e.code===ws.ABORTED)return;if(this.pause(),e.code===ws.TIMEOUT){this.handleTimeout_();return}this.mediaRequestsErrored+=1,this.error(e),this.trigger("error");return}const o=this.pendingSegment_;this.saveBandwidthRelatedStats_(o.duration,i.stats),o.endOfAllRequests=i.endOfAllRequests,r.gopInfo&&(this.gopBuffer_=Sm(this.gopBuffer_,r.gopInfo,this.safeAppend_)),this.state="APPENDING",this.trigger("appending"),this.waitForAppendsToComplete_(o)}setTimeMapping_(e){const i=this.syncController_.mappingForTimeline(e);i!==null&&(this.timeMapping_=i)}updateMediaSecondsLoaded_(e){typeof e.start=="number"&&typeof e.end=="number"?this.mediaSecondsLoaded+=e.end-e.start:this.mediaSecondsLoaded+=e.duration}shouldUpdateTransmuxerTimestampOffset_(e){return e===null?!1:this.loaderType_==="main"&&e!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&e!==this.sourceUpdater_.audioTimestampOffset()}trueSegmentStart_({currentStart:e,playlist:i,mediaIndex:r,firstVideoFrameTimeForData:o,currentVideoTimestampOffset:d,useVideoTimingInfo:h,videoTimingInfo:g,audioTimingInfo:k}){if(typeof e!="undefined")return e;if(!h)return k.start;const N=i.segments[r-1];return r===0||!N||typeof N.start=="undefined"||N.end!==o+d?o:g.start}waitForAppendsToComplete_(e){const i=this.getCurrentMediaInfo_(e);if(!i){this.error({message:"No starting media returned, likely due to an unsupported media format.",playlistExclusionDuration:Infinity}),this.trigger("error");return}const{hasAudio:r,hasVideo:o,isMuxed:d}=i,h=this.loaderType_==="main"&&o,g=!this.audioDisabled_&&r&&!d;if(e.waitingOnAppends=0,!e.hasAppendedData_){!e.timingInfo&&typeof e.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!0),e.timingInfo={start:0},e.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(e),this.processMetadataQueue_()),this.checkAppendsDone_(e);return}h&&e.waitingOnAppends++,g&&e.waitingOnAppends++,h&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,e)),g&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,e))}checkAppendsDone_(e){this.checkForAbort_(e.requestId)||(e.waitingOnAppends--,e.waitingOnAppends===0&&this.handleAppendsDone_())}checkForIllegalMediaSwitch(e){const i=Dm(this.loaderType_,this.getCurrentMediaInfo_(),e);return i?(this.error({message:i,playlistExclusionDuration:Infinity}),this.trigger("error"),!0):!1}updateSourceBufferTimestampOffset_(e){if(e.timestampOffset===null||typeof e.timingInfo.start!="number"||e.changedTimestampOffset||this.loaderType_!=="main")return;let i=!1;e.timestampOffset-=this.getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:e.segment.videoTimingInfo,audioTimingInfo:e.segment.audioTimingInfo,timingInfo:e.timingInfo}),e.changedTimestampOffset=!0,e.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(e.timestampOffset),i=!0),e.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(e.timestampOffset),i=!0),i&&this.trigger("timestampoffset")}getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:e,audioTimingInfo:i,timingInfo:r}){return this.useDtsForTimestampOffset_?e&&typeof e.transmuxedDecodeStart=="number"?e.transmuxedDecodeStart:i&&typeof i.transmuxedDecodeStart=="number"?i.transmuxedDecodeStart:r.start:r.start}updateTimingInfoEnd_(e){e.timingInfo=e.timingInfo||{};const i=this.getMediaInfo_(),o=this.loaderType_==="main"&&i&&i.hasVideo&&e.videoTimingInfo?e.videoTimingInfo:e.audioTimingInfo;!o||(e.timingInfo.end=typeof o.end=="number"?o.end:o.start+e.duration)}handleAppendsDone_(){if(this.pendingSegment_&&this.trigger("appendsdone"),!this.pendingSegment_){this.state="READY",this.paused()||this.monitorBuffer_();return}const e=this.pendingSegment_;this.updateTimingInfoEnd_(e),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:this.loaderType_==="main"});const i=Pm(e,this.sourceType_);if(i&&(i.severity==="warn"?ze.log.warn(i.message):this.logger_(i.message)),this.recordThroughput_(e),this.pendingSegment_=null,this.state="READY",e.isSyncRequest&&(this.trigger("syncinfoupdate"),!e.hasAppendedData_)){this.logger_(`Throwing away un-appended sync request ${Qo(e)}`);return}this.logger_(`Appended ${Qo(e)}`),this.addSegmentMetadataCue_(e),this.currentTime_()>=this.replaceSegmentsUntil_&&(this.replaceSegmentsUntil_=-1,this.fetchAtBuffer_=!0),this.currentTimeline_!==e.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline}),this.loaderType_==="main"&&!this.audioDisabled_&&this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:e.timeline})),this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate");const r=e.segment,o=e.part,d=r.end&&this.currentTime_()-r.end>e.playlist.targetDuration*3,h=o&&o.end&&this.currentTime_()-o.end>e.playlist.partTargetDuration*3;if(d||h){this.logger_(`bad ${d?"segment":"part"} ${Qo(e)}`),this.resetEverything();return}this.mediaIndex!==null&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=e.mediaIndex,this.partIndex=e.partIndex,this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex)&&this.endOfStream(),this.trigger("appended"),e.hasAppendedData_&&this.mediaAppends++,this.paused()||this.monitorBuffer_()}recordThroughput_(e){if(e.duration<ed){this.logger_(`Ignoring segment's throughput because its duration of ${e.duration} is less than the min to record ${ed}`);return}const i=this.throughput.rate,r=Date.now()-e.endOfAllRequests+1,o=Math.floor(e.byteLength/r*8*1e3);this.throughput.rate+=(o-i)/++this.throughput.count}addSegmentMetadataCue_(e){if(!this.segmentMetadataTrack_)return;const i=e.segment,r=i.start,o=i.end;if(!df(r)||!df(o))return;Zl(r,o,this.segmentMetadataTrack_);const d=ae().WebKitDataCue||ae().VTTCue,h={custom:i.custom,dateTimeObject:i.dateTimeObject,dateTimeString:i.dateTimeString,programDateTime:i.programDateTime,bandwidth:e.playlist.attributes.BANDWIDTH,resolution:e.playlist.attributes.RESOLUTION,codecs:e.playlist.attributes.CODECS,byteLength:e.byteLength,uri:e.uri,timeline:e.timeline,playlist:e.playlist.id,start:r,end:o},g=JSON.stringify(h),k=new d(r,o,g);k.value=h,this.segmentMetadataTrack_.addCue(k)}set replaceSegmentsUntil(e){this.logger_(`Replacing currently buffered segments until ${e}`),this.replaceSegmentsUntil_=e}}function Ys(){}const mf=function(s){return typeof s!="string"?s:s.replace(/./,e=>e.toUpperCase())},Bm=["video","audio"],Ac=(s,e)=>{const i=e[`${s}Buffer`];return i&&i.updating||e.queuePending[s]},Mm=(s,e)=>{for(let i=0;i<e.length;i++){const r=e[i];if(r.type==="mediaSource")return null;if(r.type===s)return i}return null},Jo=(s,e)=>{if(e.queue.length===0)return;let i=0,r=e.queue[i];if(r.type==="mediaSource"){!e.updating()&&e.mediaSource.readyState!=="closed"&&(e.queue.shift(),r.action(e),r.doneFn&&r.doneFn(),Jo("audio",e),Jo("video",e));return}if(s!=="mediaSource"&&!(!e.ready()||e.mediaSource.readyState==="closed"||Ac(s,e))){if(r.type!==s){if(i=Mm(s,e.queue),i===null)return;r=e.queue[i]}if(e.queue.splice(i,1),e.queuePending[s]=r,r.action(s,e),!r.doneFn){e.queuePending[s]=null,Jo(s,e);return}}},gf=(s,e)=>{const i=e[`${s}Buffer`],r=mf(s);!i||(i.removeEventListener("updateend",e[`on${r}UpdateEnd_`]),i.removeEventListener("error",e[`on${r}Error_`]),e.codecs[s]=null,e[`${s}Buffer`]=null)},Ls=(s,e)=>s&&e&&Array.prototype.indexOf.call(s.sourceBuffers,e)!==-1,Sr={appendBuffer:(s,e,i)=>(r,o)=>{const d=o[`${r}Buffer`];if(!!Ls(o.mediaSource,d)){o.logger_(`Appending segment ${e.mediaIndex}'s ${s.length} bytes to ${r}Buffer`);try{d.appendBuffer(s)}catch(h){o.logger_(`Error with code ${h.code} `+(h.code===uf?"(QUOTA_EXCEEDED_ERR) ":"")+`when appending segment ${e.mediaIndex} to ${r}Buffer`),o.queuePending[r]=null,i(h)}}},remove:(s,e)=>(i,r)=>{const o=r[`${i}Buffer`];if(!!Ls(r.mediaSource,o)){r.logger_(`Removing ${s} to ${e} from ${i}Buffer`);try{o.remove(s,e)}catch(d){r.logger_(`Remove ${s} to ${e} from ${i}Buffer failed`)}}},timestampOffset:s=>(e,i)=>{const r=i[`${e}Buffer`];!Ls(i.mediaSource,r)||(i.logger_(`Setting ${e}timestampOffset to ${s}`),r.timestampOffset=s)},callback:s=>(e,i)=>{s()},endOfStream:s=>e=>{if(e.mediaSource.readyState==="open"){e.logger_(`Calling mediaSource endOfStream(${s||""})`);try{e.mediaSource.endOfStream(s)}catch(i){ze.log.warn("Failed to call media source endOfStream",i)}}},duration:s=>e=>{e.logger_(`Setting mediaSource duration to ${s}`);try{e.mediaSource.duration=s}catch(i){ze.log.warn("Failed to set media source duration",i)}},abort:()=>(s,e)=>{if(e.mediaSource.readyState!=="open")return;const i=e[`${s}Buffer`];if(!!Ls(e.mediaSource,i)){e.logger_(`calling abort on ${s}Buffer`);try{i.abort()}catch(r){ze.log.warn(`Failed to abort on ${s}Buffer`,r)}}},addSourceBuffer:(s,e)=>i=>{const r=mf(s),o=bt(e);i.logger_(`Adding ${s}Buffer with codec ${e} to mediaSource`);const d=i.mediaSource.addSourceBuffer(o);d.addEventListener("updateend",i[`on${r}UpdateEnd_`]),d.addEventListener("error",i[`on${r}Error_`]),i.codecs[s]=e,i[`${s}Buffer`]=d},removeSourceBuffer:s=>e=>{const i=e[`${s}Buffer`];if(gf(s,e),!!Ls(e.mediaSource,i)){e.logger_(`Removing ${s}Buffer with codec ${e.codecs[s]} from mediaSource`);try{e.mediaSource.removeSourceBuffer(i)}catch(r){ze.log.warn(`Failed to removeSourceBuffer ${s}Buffer`,r)}}},changeType:s=>(e,i)=>{const r=i[`${e}Buffer`],o=bt(s);!Ls(i.mediaSource,r)||i.codecs[e]!==s&&(i.logger_(`changing ${e}Buffer codec from ${i.codecs[e]} to ${s}`),r.changeType(o),i.codecs[e]=s)}},Cr=({type:s,sourceUpdater:e,action:i,doneFn:r,name:o})=>{e.queue.push({type:s,action:i,doneFn:r,name:o}),Jo(s,e)},yf=(s,e)=>i=>{const r=e[`${s}Buffered`](),o=Zp(r);if(e.logger_(`${s} source buffer update end. Buffered: 
`,o),e.queuePending[s]){const d=e.queuePending[s].doneFn;e.queuePending[s]=null,d&&d(e[`${s}Error_`])}Jo(s,e)};class vf extends ze.EventTarget{constructor(e){super();this.mediaSource=e,this.sourceopenListener_=()=>Jo("mediaSource",this),this.mediaSource.addEventListener("sourceopen",this.sourceopenListener_),this.logger_=Vr("SourceUpdater"),this.audioTimestampOffset_=0,this.videoTimestampOffset_=0,this.queue=[],this.queuePending={audio:null,video:null},this.delayedAudioAppendQueue_=[],this.videoAppendQueued_=!1,this.codecs={},this.onVideoUpdateEnd_=yf("video",this),this.onAudioUpdateEnd_=yf("audio",this),this.onVideoError_=i=>{this.videoError_=i},this.onAudioError_=i=>{this.audioError_=i},this.createdSourceBuffers_=!1,this.initializedEme_=!1,this.triggeredReady_=!1}initializedEme(){this.initializedEme_=!0,this.triggerReady()}hasCreatedSourceBuffers(){return this.createdSourceBuffers_}hasInitializedAnyEme(){return this.initializedEme_}ready(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()}createSourceBuffers(e){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(e),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())}triggerReady(){this.ready()&&!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))}addSourceBuffer(e,i){Cr({type:"mediaSource",sourceUpdater:this,action:Sr.addSourceBuffer(e,i),name:"addSourceBuffer"})}abort(e){Cr({type:e,sourceUpdater:this,action:Sr.abort(e),name:"abort"})}removeSourceBuffer(e){if(!this.canRemoveSourceBuffer()){ze.log.error("removeSourceBuffer is not supported!");return}Cr({type:"mediaSource",sourceUpdater:this,action:Sr.removeSourceBuffer(e),name:"removeSourceBuffer"})}canRemoveSourceBuffer(){return!ze.browser.IS_FIREFOX&&ae().MediaSource&&ae().MediaSource.prototype&&typeof ae().MediaSource.prototype.removeSourceBuffer=="function"}static canChangeType(){return ae().SourceBuffer&&ae().SourceBuffer.prototype&&typeof ae().SourceBuffer.prototype.changeType=="function"}canChangeType(){return this.constructor.canChangeType()}changeType(e,i){if(!this.canChangeType()){ze.log.error("changeType is not supported!");return}Cr({type:e,sourceUpdater:this,action:Sr.changeType(i),name:"changeType"})}addOrChangeSourceBuffers(e){if(!e||typeof e!="object"||Object.keys(e).length===0)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(e).forEach(i=>{const r=e[i];if(!this.hasCreatedSourceBuffers())return this.addSourceBuffer(i,r);this.canChangeType()&&this.changeType(i,r)})}appendBuffer(e,i){const{segmentInfo:r,type:o,bytes:d}=e;if(this.processedAppend_=!0,o==="audio"&&this.videoBuffer&&!this.videoAppendQueued_){this.delayedAudioAppendQueue_.push([e,i]),this.logger_(`delayed audio append of ${d.length} until video append`);return}const h=i;if(Cr({type:o,sourceUpdater:this,action:Sr.appendBuffer(d,r||{mediaIndex:-1},h),doneFn:i,name:"appendBuffer"}),o==="video"){if(this.videoAppendQueued_=!0,!this.delayedAudioAppendQueue_.length)return;const g=this.delayedAudioAppendQueue_.slice();this.logger_(`queuing delayed audio ${g.length} appendBuffers`),this.delayedAudioAppendQueue_.length=0,g.forEach(k=>{this.appendBuffer.apply(this,k)})}}audioBuffered(){return Ls(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered?this.audioBuffer.buffered:Gn()}videoBuffered(){return Ls(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered?this.videoBuffer.buffered:Gn()}buffered(){const e=Ls(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,i=Ls(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return i&&!e?this.audioBuffered():e&&!i?this.videoBuffered():t0(this.audioBuffered(),this.videoBuffered())}setDuration(e,i=Ys){Cr({type:"mediaSource",sourceUpdater:this,action:Sr.duration(e),name:"duration",doneFn:i})}endOfStream(e=null,i=Ys){typeof e!="string"&&(e=void 0),Cr({type:"mediaSource",sourceUpdater:this,action:Sr.endOfStream(e),name:"endOfStream",doneFn:i})}removeAudio(e,i,r=Ys){if(!this.audioBuffered().length||this.audioBuffered().end(0)===0){r();return}Cr({type:"audio",sourceUpdater:this,action:Sr.remove(e,i),doneFn:r,name:"remove"})}removeVideo(e,i,r=Ys){if(!this.videoBuffered().length||this.videoBuffered().end(0)===0){r();return}Cr({type:"video",sourceUpdater:this,action:Sr.remove(e,i),doneFn:r,name:"remove"})}updating(){return!!(Ac("audio",this)||Ac("video",this))}audioTimestampOffset(e){return typeof e!="undefined"&&this.audioBuffer&&this.audioTimestampOffset_!==e&&(Cr({type:"audio",sourceUpdater:this,action:Sr.timestampOffset(e),name:"timestampOffset"}),this.audioTimestampOffset_=e),this.audioTimestampOffset_}videoTimestampOffset(e){return typeof e!="undefined"&&this.videoBuffer&&this.videoTimestampOffset!==e&&(Cr({type:"video",sourceUpdater:this,action:Sr.timestampOffset(e),name:"timestampOffset"}),this.videoTimestampOffset_=e),this.videoTimestampOffset_}audioQueueCallback(e){!this.audioBuffer||Cr({type:"audio",sourceUpdater:this,action:Sr.callback(e),name:"callback"})}videoQueueCallback(e){!this.videoBuffer||Cr({type:"video",sourceUpdater:this,action:Sr.callback(e),name:"callback"})}dispose(){this.trigger("dispose"),Bm.forEach(e=>{this.abort(e),this.canRemoveSourceBuffer()?this.removeSourceBuffer(e):this[`${e}QueueCallback`](()=>gf(e,this))}),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()}}const Af=s=>decodeURIComponent(escape(String.fromCharCode.apply(null,s))),bf=new Uint8Array(`

`.split("").map(s=>s.charCodeAt(0)));class Fm extends Error{constructor(){super("Trying to parse received VTT cues, but there is no WebVTT. Make sure vtt.js is loaded.")}}class Nm extends vc{constructor(e,i={}){super(e,i);this.mediaSource_=null,this.subtitlesTrack_=null,this.loaderType_="subtitle",this.featuresNativeTextTracks_=e.featuresNativeTextTracks,this.loadVttJs=e.loadVttJs,this.shouldSaveSegmentTimingInfo_=!1}createTransmuxer_(){return null}buffered_(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues||!this.subtitlesTrack_.cues.length)return Gn();const e=this.subtitlesTrack_.cues,i=e[0].startTime,r=e[e.length-1].startTime;return Gn([[i,r]])}initSegmentForMap(e,i=!1){if(!e)return null;const r=Xu(e);let o=this.initSegments_[r];if(i&&!o&&e.bytes){const d=bf.byteLength+e.bytes.byteLength,h=new Uint8Array(d);h.set(e.bytes),h.set(bf,e.bytes.byteLength),this.initSegments_[r]=o={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:h}}return o||e}couldBeginLoading_(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}track(e){return typeof e=="undefined"?this.subtitlesTrack_:(this.subtitlesTrack_=e,this.state==="INIT"&&this.couldBeginLoading_()&&this.init_(),this.subtitlesTrack_)}remove(e,i){Zl(e,i,this.subtitlesTrack_)}fillBuffer_(){const e=this.chooseNextRequest_();if(!!e){if(this.syncController_.timestampOffsetForTimeline(e.timeline)===null){const i=()=>{this.state="READY",this.paused()||this.monitorBuffer_()};this.syncController_.one("timestampoffset",i),this.state="WAITING_ON_TIMELINE";return}this.loadSegment_(e)}}timestampOffsetForSegment_(){return null}chooseNextRequest_(){return this.skipEmptySegments_(super.chooseNextRequest_())}skipEmptySegments_(e){for(;e&&e.segment.empty;){if(e.mediaIndex+1>=e.playlist.segments.length){e=null;break}e=this.generateSegmentInfo_({playlist:e.playlist,mediaIndex:e.mediaIndex+1,startOfSegment:e.startOfSegment+e.duration,isSyncRequest:e.isSyncRequest})}return e}stopForError(e){this.error(e),this.state="READY",this.pause(),this.trigger("error")}segmentRequestFinished_(e,i,r){if(!this.subtitlesTrack_){this.state="READY";return}if(this.saveTransferStats_(i.stats),!this.pendingSegment_){this.state="READY",this.mediaRequestsAborted+=1;return}if(e){e.code===ws.TIMEOUT&&this.handleTimeout_(),e.code===ws.ABORTED?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,this.stopForError(e);return}const o=this.pendingSegment_;this.saveBandwidthRelatedStats_(o.duration,i.stats),i.key&&this.segmentKey(i.key,!0),this.state="APPENDING",this.trigger("appending");const d=o.segment;if(d.map&&(d.map.bytes=i.map.bytes),o.bytes=i.bytes,typeof ae().WebVTT!="function"&&typeof this.loadVttJs=="function"){this.state="WAITING_ON_VTTJS",this.loadVttJs().then(()=>this.segmentRequestFinished_(e,i,r),()=>this.stopForError({message:"Error loading vtt.js"}));return}d.requested=!0;try{this.parseVTTCues_(o)}catch(h){this.stopForError({message:h.message});return}if(this.updateTimeMapping_(o,this.syncController_.timelines[o.timeline],this.playlist_),o.cues.length?o.timingInfo={start:o.cues[0].startTime,end:o.cues[o.cues.length-1].endTime}:o.timingInfo={start:o.startOfSegment,end:o.startOfSegment+o.duration},o.isSyncRequest){this.trigger("syncinfoupdate"),this.pendingSegment_=null,this.state="READY";return}o.byteLength=o.bytes.byteLength,this.mediaSecondsLoaded+=d.duration,o.cues.forEach(h=>{this.subtitlesTrack_.addCue(this.featuresNativeTextTracks_?new(ae()).VTTCue(h.startTime,h.endTime,h.text):h)}),Em(this.subtitlesTrack_),this.handleAppendsDone_()}handleData_(){}updateTimingInfoEnd_(){}parseVTTCues_(e){let i,r=!1;if(typeof ae().WebVTT!="function")throw new Fm;typeof ae().TextDecoder=="function"?i=new(ae()).TextDecoder("utf8"):(i=ae().WebVTT.StringDecoder(),r=!0);const o=new(ae()).WebVTT.Parser(ae(),ae().vttjs,i);if(e.cues=[],e.timestampmap={MPEGTS:0,LOCAL:0},o.oncue=e.cues.push.bind(e.cues),o.ontimestampmap=h=>{e.timestampmap=h},o.onparsingerror=h=>{ze.log.warn("Error encountered when parsing cues: "+h.message)},e.segment.map){let h=e.segment.map.bytes;r&&(h=Af(h)),o.parse(h)}let d=e.bytes;r&&(d=Af(d)),o.parse(d),o.flush()}updateTimeMapping_(e,i,r){const o=e.segment;if(!i)return;if(!e.cues.length){o.empty=!0;return}const d=e.timestampmap,h=d.MPEGTS/$s.ONE_SECOND_IN_TS-d.LOCAL+i.mapping;if(e.cues.forEach(g=>{g.startTime+=h,g.endTime+=h}),!r.syncInfo){const g=e.cues[0].startTime,k=e.cues[e.cues.length-1].startTime;r.syncInfo={mediaSequence:r.mediaSequence+e.mediaIndex,time:Math.min(g,k-o.duration)}}}}const Um=function(s,e){const i=s.cues;for(let r=0;r<i.length;r++){const o=i[r];if(e>=o.adStartTime&&e<=o.adEndTime)return o}return null},jm=function(s,e,i=0){if(!s.segments)return;let r=i,o;for(let d=0;d<s.segments.length;d++){const h=s.segments[d];if(o||(o=Um(e,r+h.duration/2)),o){if("cueIn"in h){o.endTime=r,o.adEndTime=r,r+=h.duration,o=null;continue}if(r<o.endTime){r+=h.duration;continue}o.endTime+=h.duration}else if("cueOut"in h&&(o=new(ae()).VTTCue(r,r+h.duration,h.cueOut),o.adStartTime=r,o.adEndTime=r+parseFloat(h.cueOut),e.addCue(o)),"cueOutCont"in h){const[g,k]=h.cueOutCont.split("/").map(parseFloat);o=new(ae()).VTTCue(r,r+h.duration,""),o.adStartTime=r-g,o.adEndTime=o.adStartTime+k,e.addCue(o)}r+=h.duration}},$m=86400,_f=[{name:"VOD",run:(s,e,i,r,o)=>i!==Infinity?{time:0,segmentIndex:0,partIndex:null}:null},{name:"ProgramDateTime",run:(s,e,i,r,o)=>{if(!Object.keys(s.timelineToDatetimeMappings).length)return null;let d=null,h=null;const g=nc(e);o=o||0;for(let k=0;k<g.length;k++){const N=e.endList||o===0?k:g.length-(k+1),Y=g[N],me=Y.segment,Ie=s.timelineToDatetimeMappings[me.timeline];if(!Ie||!me.dateTimeObject)continue;let Ae=me.dateTimeObject.getTime()/1e3+Ie;if(me.parts&&typeof Y.partIndex=="number")for(let Ye=0;Ye<Y.partIndex;Ye++)Ae+=me.parts[Ye].duration;const $e=Math.abs(o-Ae);if(h!==null&&($e===0||h<$e))break;h=$e,d={time:Ae,segmentIndex:Y.segmentIndex,partIndex:Y.partIndex}}return d}},{name:"Segment",run:(s,e,i,r,o)=>{let d=null,h=null;o=o||0;const g=nc(e);for(let k=0;k<g.length;k++){const N=e.endList||o===0?k:g.length-(k+1),Y=g[N],me=Y.segment,Ie=Y.part&&Y.part.start||me&&me.start;if(me.timeline===r&&typeof Ie!="undefined"){const Pe=Math.abs(o-Ie);if(h!==null&&h<Pe)break;(!d||h===null||h>=Pe)&&(h=Pe,d={time:Ie,segmentIndex:Y.segmentIndex,partIndex:Y.partIndex})}}return d}},{name:"Discontinuity",run:(s,e,i,r,o)=>{let d=null;if(o=o||0,e.discontinuityStarts&&e.discontinuityStarts.length){let h=null;for(let g=0;g<e.discontinuityStarts.length;g++){const k=e.discontinuityStarts[g],N=e.discontinuitySequence+g+1,Y=s.discontinuities[N];if(Y){const me=Math.abs(o-Y.time);if(h!==null&&h<me)break;(!d||h===null||h>=me)&&(h=me,d={time:Y.time,segmentIndex:k,partIndex:null})}}}return d}},{name:"Playlist",run:(s,e,i,r,o)=>e.syncInfo?{time:e.syncInfo.time,segmentIndex:e.syncInfo.mediaSequence-e.mediaSequence,partIndex:null}:null}];class Vm extends ze.EventTarget{constructor(e={}){super();this.timelines=[],this.discontinuities=[],this.timelineToDatetimeMappings={},this.logger_=Vr("SyncController")}getSyncPoint(e,i,r,o){const d=this.runStrategies_(e,i,r,o);return d.length?this.selectSyncPoint_(d,{key:"time",value:o}):null}getExpiredTime(e,i){if(!e||!e.segments)return null;const r=this.runStrategies_(e,i,e.discontinuitySequence,0);if(!r.length)return null;const o=this.selectSyncPoint_(r,{key:"segmentIndex",value:0});return o.segmentIndex>0&&(o.time*=-1),Math.abs(o.time+Yl({defaultDuration:e.targetDuration,durationList:e.segments,startIndex:o.segmentIndex,endIndex:0}))}runStrategies_(e,i,r,o){const d=[];for(let h=0;h<_f.length;h++){const g=_f[h],k=g.run(this,e,i,r,o);k&&(k.strategy=g.name,d.push({strategy:g.name,syncPoint:k}))}return d}selectSyncPoint_(e,i){let r=e[0].syncPoint,o=Math.abs(e[0].syncPoint[i.key]-i.value),d=e[0].strategy;for(let h=1;h<e.length;h++){const g=Math.abs(e[h].syncPoint[i.key]-i.value);g<o&&(o=g,r=e[h].syncPoint,d=e[h].strategy)}return this.logger_(`syncPoint for [${i.key}: ${i.value}] chosen with strategy [${d}]: [time:${r.time}, segmentIndex:${r.segmentIndex}`+(typeof r.partIndex=="number"?`,partIndex:${r.partIndex}`:"")+"]"),r}saveExpiredSegmentInfo(e,i){const r=i.mediaSequence-e.mediaSequence;if(r>$m){ze.log.warn(`Not saving expired segment info. Media sequence gap ${r} is too large.`);return}for(let o=r-1;o>=0;o--){const d=e.segments[o];if(d&&typeof d.start!="undefined"){i.syncInfo={mediaSequence:e.mediaSequence+o,time:d.start},this.logger_(`playlist refresh sync: [time:${i.syncInfo.time}, mediaSequence: ${i.syncInfo.mediaSequence}]`),this.trigger("syncinfoupdate");break}}}setDateTimeMappingForStart(e){if(this.timelineToDatetimeMappings={},e.segments&&e.segments.length&&e.segments[0].dateTimeObject){const i=e.segments[0],r=i.dateTimeObject.getTime()/1e3;this.timelineToDatetimeMappings[i.timeline]=-r}}saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:i}){const r=this.calculateSegmentTimeMapping_(e,e.timingInfo,i),o=e.segment;r&&(this.saveDiscontinuitySyncInfo_(e),e.playlist.syncInfo||(e.playlist.syncInfo={mediaSequence:e.playlist.mediaSequence+e.mediaIndex,time:o.start}));const d=o.dateTimeObject;o.discontinuity&&i&&d&&(this.timelineToDatetimeMappings[o.timeline]=-(d.getTime()/1e3))}timestampOffsetForTimeline(e){return typeof this.timelines[e]=="undefined"?null:this.timelines[e].time}mappingForTimeline(e){return typeof this.timelines[e]=="undefined"?null:this.timelines[e].mapping}calculateSegmentTimeMapping_(e,i,r){const o=e.segment,d=e.part;let h=this.timelines[e.timeline],g,k;if(typeof e.timestampOffset=="number")h={time:e.startOfSegment,mapping:e.startOfSegment-i.start},r&&(this.timelines[e.timeline]=h,this.trigger("timestampoffset"),this.logger_(`time mapping for timeline ${e.timeline}: [time: ${h.time}] [mapping: ${h.mapping}]`)),g=e.startOfSegment,k=i.end+h.mapping;else if(h)g=i.start+h.mapping,k=i.end+h.mapping;else return!1;return d&&(d.start=g,d.end=k),(!o.start||g<o.start)&&(o.start=g),o.end=k,!0}saveDiscontinuitySyncInfo_(e){const i=e.playlist,r=e.segment;if(r.discontinuity)this.discontinuities[r.timeline]={time:r.start,accuracy:0};else if(i.discontinuityStarts&&i.discontinuityStarts.length)for(let o=0;o<i.discontinuityStarts.length;o++){const d=i.discontinuityStarts[o],h=i.discontinuitySequence+o+1,g=d-e.mediaIndex,k=Math.abs(g);if(!this.discontinuities[h]||this.discontinuities[h].accuracy>k){let N;g<0?N=r.start-Yl({defaultDuration:i.targetDuration,durationList:i.segments,startIndex:e.mediaIndex,endIndex:d}):N=r.end+Yl({defaultDuration:i.targetDuration,durationList:i.segments,startIndex:e.mediaIndex+1,endIndex:d}),this.discontinuities[h]={time:N,accuracy:k}}}}dispose(){this.trigger("dispose"),this.off()}}class Hm extends ze.EventTarget{constructor(){super();this.pendingTimelineChanges_={},this.lastTimelineChanges_={}}clearPendingTimelineChange(e){this.pendingTimelineChanges_[e]=null,this.trigger("pendingtimelinechange")}pendingTimelineChange({type:e,from:i,to:r}){return typeof i=="number"&&typeof r=="number"&&(this.pendingTimelineChanges_[e]={type:e,from:i,to:r},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[e]}lastTimelineChange({type:e,from:i,to:r}){return typeof i=="number"&&typeof r=="number"&&(this.lastTimelineChanges_[e]={type:e,from:i,to:r},delete this.pendingTimelineChanges_[e],this.trigger("timelinechange")),this.lastTimelineChanges_[e]}dispose(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()}}const Gm=qh(Wh(function(){var s=function(){function $e(){this.listeners={}}var Ye=$e.prototype;return Ye.on=function(qe,ct){this.listeners[qe]||(this.listeners[qe]=[]),this.listeners[qe].push(ct)},Ye.off=function(qe,ct){if(!this.listeners[qe])return!1;var Je=this.listeners[qe].indexOf(ct);return this.listeners[qe]=this.listeners[qe].slice(0),this.listeners[qe].splice(Je,1),Je>-1},Ye.trigger=function(qe){var ct=this.listeners[qe];if(!!ct)if(arguments.length===2)for(var Je=ct.length,je=0;je<Je;++je)ct[je].call(this,arguments[1]);else for(var _t=Array.prototype.slice.call(arguments,1),jt=ct.length,di=0;di<jt;++di)ct[di].apply(this,_t)},Ye.dispose=function(){this.listeners={}},Ye.pipe=function(qe){this.on("data",function(ct){qe.push(ct)})},$e}();/*! @name pkcs7 @version 1.0.4 @license Apache-2.0 */function e($e){return $e.subarray(0,$e.byteLength-$e[$e.byteLength-1])}/*! @name aes-decrypter @version 4.0.1 @license Apache-2.0 */const i=function(){const $e=[[[],[],[],[],[]],[[],[],[],[],[]]],Ye=$e[0],Qe=$e[1],qe=Ye[4],ct=Qe[4];let Je,je,_t;const jt=[],di=[];let pi,nn,qn,rn,Ht,Bi;for(Je=0;Je<256;Je++)di[(jt[Je]=Je<<1^(Je>>7)*283)^Je]=Je;for(je=_t=0;!qe[je];je^=pi||1,_t=di[_t]||1)for(rn=_t^_t<<1^_t<<2^_t<<3^_t<<4,rn=rn>>8^rn&255^99,qe[je]=rn,ct[rn]=je,qn=jt[nn=jt[pi=jt[je]]],Bi=qn*16843009^nn*65537^pi*257^je*16843008,Ht=jt[rn]*257^rn*16843008,Je=0;Je<4;Je++)Ye[Je][je]=Ht=Ht<<24^Ht>>>8,Qe[Je][rn]=Bi=Bi<<24^Bi>>>8;for(Je=0;Je<5;Je++)Ye[Je]=Ye[Je].slice(0),Qe[Je]=Qe[Je].slice(0);return $e};let r=null;class o{constructor(Ye){r||(r=i()),this._tables=[[r[0][0].slice(),r[0][1].slice(),r[0][2].slice(),r[0][3].slice(),r[0][4].slice()],[r[1][0].slice(),r[1][1].slice(),r[1][2].slice(),r[1][3].slice(),r[1][4].slice()]];let Qe,qe,ct;const Je=this._tables[0][4],je=this._tables[1],_t=Ye.length;let jt=1;if(_t!==4&&_t!==6&&_t!==8)throw new Error("Invalid aes key size");const di=Ye.slice(0),pi=[];for(this._key=[di,pi],Qe=_t;Qe<4*_t+28;Qe++)ct=di[Qe-1],(Qe%_t==0||_t===8&&Qe%_t==4)&&(ct=Je[ct>>>24]<<24^Je[ct>>16&255]<<16^Je[ct>>8&255]<<8^Je[ct&255],Qe%_t==0&&(ct=ct<<8^ct>>>24^jt<<24,jt=jt<<1^(jt>>7)*283)),di[Qe]=di[Qe-_t]^ct;for(qe=0;Qe;qe++,Qe--)ct=di[qe&3?Qe:Qe-4],Qe<=4||qe<4?pi[qe]=ct:pi[qe]=je[0][Je[ct>>>24]]^je[1][Je[ct>>16&255]]^je[2][Je[ct>>8&255]]^je[3][Je[ct&255]]}decrypt(Ye,Qe,qe,ct,Je,je){const _t=this._key[1];let jt=Ye^_t[0],di=ct^_t[1],pi=qe^_t[2],nn=Qe^_t[3],qn,rn,Ht;const Bi=_t.length/4-2;let ks,Qs=4;const Sa=this._tables[1],to=Sa[0],io=Sa[1],no=Sa[2],ro=Sa[3],so=Sa[4];for(ks=0;ks<Bi;ks++)qn=to[jt>>>24]^io[di>>16&255]^no[pi>>8&255]^ro[nn&255]^_t[Qs],rn=to[di>>>24]^io[pi>>16&255]^no[nn>>8&255]^ro[jt&255]^_t[Qs+1],Ht=to[pi>>>24]^io[nn>>16&255]^no[jt>>8&255]^ro[di&255]^_t[Qs+2],nn=to[nn>>>24]^io[jt>>16&255]^no[di>>8&255]^ro[pi&255]^_t[Qs+3],Qs+=4,jt=qn,di=rn,pi=Ht;for(ks=0;ks<4;ks++)Je[(3&-ks)+je]=so[jt>>>24]<<24^so[di>>16&255]<<16^so[pi>>8&255]<<8^so[nn&255]^_t[Qs++],qn=jt,jt=di,di=pi,pi=nn,nn=qn}}class d extends s{constructor(){super(s);this.jobs=[],this.delay=1,this.timeout_=null}processJob_(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null}push(Ye){this.jobs.push(Ye),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))}}const h=function($e){return $e<<24|($e&65280)<<8|($e&16711680)>>8|$e>>>24},g=function($e,Ye,Qe){const qe=new Int32Array($e.buffer,$e.byteOffset,$e.byteLength>>2),ct=new o(Array.prototype.slice.call(Ye)),Je=new Uint8Array($e.byteLength),je=new Int32Array(Je.buffer);let _t,jt,di,pi,nn,qn,rn,Ht,Bi;for(_t=Qe[0],jt=Qe[1],di=Qe[2],pi=Qe[3],Bi=0;Bi<qe.length;Bi+=4)nn=h(qe[Bi]),qn=h(qe[Bi+1]),rn=h(qe[Bi+2]),Ht=h(qe[Bi+3]),ct.decrypt(nn,qn,rn,Ht,je,Bi),je[Bi]=h(je[Bi]^_t),je[Bi+1]=h(je[Bi+1]^jt),je[Bi+2]=h(je[Bi+2]^di),je[Bi+3]=h(je[Bi+3]^pi),_t=nn,jt=qn,di=rn,pi=Ht;return Je};class k{constructor(Ye,Qe,qe,ct){const Je=k.STEP,je=new Int32Array(Ye.buffer),_t=new Uint8Array(Ye.byteLength);let jt=0;for(this.asyncStream_=new d,this.asyncStream_.push(this.decryptChunk_(je.subarray(jt,jt+Je),Qe,qe,_t)),jt=Je;jt<je.length;jt+=Je)qe=new Uint32Array([h(je[jt-4]),h(je[jt-3]),h(je[jt-2]),h(je[jt-1])]),this.asyncStream_.push(this.decryptChunk_(je.subarray(jt,jt+Je),Qe,qe,_t));this.asyncStream_.push(function(){ct(null,e(_t))})}static get STEP(){return 32e3}decryptChunk_(Ye,Qe,qe,ct){return function(){const Je=g(Ye,Qe,qe);ct.set(Je,Ye.byteOffset)}}}var N=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof ft.g!="undefined"?ft.g:typeof self!="undefined"?self:{},Y;typeof window!="undefined"?Y=window:typeof N!="undefined"?Y=N:typeof self!="undefined"?Y=self:Y={};var me=Y,Ie=function(Ye){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(Ye):Ye&&Ye.buffer instanceof ArrayBuffer},Pe=me.BigInt||Number;Pe("0x1"),Pe("0x100"),Pe("0x10000"),Pe("0x1000000"),Pe("0x100000000"),Pe("0x10000000000"),Pe("0x1000000000000"),Pe("0x100000000000000"),Pe("0x10000000000000000"),function(){var $e=new Uint16Array([65484]),Ye=new Uint8Array($e.buffer,$e.byteOffset,$e.byteLength);return Ye[0]===255?"big":Ye[0]===204?"little":"unknown"}();const Ae=function($e){const Ye={};return Object.keys($e).forEach(Qe=>{const qe=$e[Qe];Ie(qe)?Ye[Qe]={bytes:qe.buffer,byteOffset:qe.byteOffset,byteLength:qe.byteLength}:Ye[Qe]=qe}),Ye};self.onmessage=function($e){const Ye=$e.data,Qe=new Uint8Array(Ye.encrypted.bytes,Ye.encrypted.byteOffset,Ye.encrypted.byteLength),qe=new Uint32Array(Ye.key.bytes,Ye.key.byteOffset,Ye.key.byteLength/4),ct=new Uint32Array(Ye.iv.bytes,Ye.iv.byteOffset,Ye.iv.byteLength/4);new k(Qe,qe,ct,function(Je,je){self.postMessage(Ae({source:Ye.source,decrypted:je}),[je.buffer])})}}));var qm=Gh(Gm);const Wm=s=>{let e=s.default?"main":"alternative";return s.characteristics&&s.characteristics.indexOf("public.accessibility.describes-video")>=0&&(e="main-desc"),e},xf=(s,e)=>{s.abort(),s.pause(),e&&e.activePlaylistLoader&&(e.activePlaylistLoader.pause(),e.activePlaylistLoader=null)},bc=(s,e)=>{e.activePlaylistLoader=s,s.load()},Km=(s,e)=>()=>{const{segmentLoaders:{[s]:i,main:r},mediaTypes:{[s]:o}}=e,d=o.activeTrack(),h=o.getActiveGroup(),g=o.activePlaylistLoader,k=o.lastGroup_;if(!(h&&k&&h.id===k.id)&&(o.lastGroup_=h,o.lastTrack_=d,xf(i,o),!(!h||h.isMainPlaylist))){if(!h.playlistLoader){g&&r.resetEverything();return}i.resyncLoader(),bc(h.playlistLoader,o)}},zm=(s,e)=>()=>{const{segmentLoaders:{[s]:i},mediaTypes:{[s]:r}}=e;r.lastGroup_=null,i.abort(),i.pause()},Ym=(s,e)=>()=>{const{mainPlaylistLoader:i,segmentLoaders:{[s]:r,main:o},mediaTypes:{[s]:d}}=e,h=d.activeTrack(),g=d.getActiveGroup(),k=d.activePlaylistLoader,N=d.lastTrack_;if(!(N&&h&&N.id===h.id)&&(d.lastGroup_=g,d.lastTrack_=h,xf(r,d),!!g)){if(g.isMainPlaylist){if(!h||!N||h.id===N.id)return;const Y=e.vhs.playlistController_,me=Y.selectPlaylist();if(Y.media()===me)return;d.logger_(`track change. Switching main audio from ${N.id} to ${h.id}`),i.pause(),o.resetEverything(),Y.fastQualityChange_(me);return}if(s==="AUDIO"){if(!g.playlistLoader){o.setAudio(!0),o.resetEverything();return}r.setAudio(!0),o.setAudio(!1)}if(k===g.playlistLoader){bc(g.playlistLoader,d);return}r.track&&r.track(h),r.resetEverything(),bc(g.playlistLoader,d)}},td={AUDIO:(s,e)=>()=>{const{mediaTypes:{[s]:i},excludePlaylist:r}=e,o=i.activeTrack(),d=i.activeGroup(),h=(d.filter(k=>k.default)[0]||d[0]).id,g=i.tracks[h];if(o===g){r({error:{message:"Problem encountered loading the default audio track."}});return}ze.log.warn("Problem encountered loading the alternate audio track.Switching back to default.");for(const k in i.tracks)i.tracks[k].enabled=i.tracks[k]===g;i.onTrackChanged()},SUBTITLES:(s,e)=>()=>{const{mediaTypes:{[s]:i}}=e;ze.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track.");const r=i.activeTrack();r&&(r.mode="disabled"),i.onTrackChanged()}},Ef={AUDIO:(s,e,i)=>{if(!e)return;const{tech:r,requestOptions:o,segmentLoaders:{[s]:d}}=i;e.on("loadedmetadata",()=>{const h=e.media();d.playlist(h,o),(!r.paused()||h.endList&&r.preload()!=="none")&&d.load()}),e.on("loadedplaylist",()=>{d.playlist(e.media(),o),r.paused()||d.load()}),e.on("error",td[s](s,i))},SUBTITLES:(s,e,i)=>{const{tech:r,requestOptions:o,segmentLoaders:{[s]:d},mediaTypes:{[s]:h}}=i;e.on("loadedmetadata",()=>{const g=e.media();d.playlist(g,o),d.track(h.activeTrack()),(!r.paused()||g.endList&&r.preload()!=="none")&&d.load()}),e.on("loadedplaylist",()=>{d.playlist(e.media(),o),r.paused()||d.load()}),e.on("error",td[s](s,i))}},Xm={AUDIO:(s,e)=>{const{vhs:i,sourceType:r,segmentLoaders:{[s]:o},requestOptions:d,main:{mediaGroups:h},mediaTypes:{[s]:{groups:g,tracks:k,logger_:N}},mainPlaylistLoader:Y}=e,me=Xl(Y.main);(!h[s]||Object.keys(h[s]).length===0)&&(h[s]={main:{default:{default:!0}}},me&&(h[s].main.default.playlists=Y.main.playlists));for(const Ie in h[s]){g[Ie]||(g[Ie]=[]);for(const Pe in h[s][Ie]){let Ae=h[s][Ie][Pe],$e;if(me?(N(`AUDIO group '${Ie}' label '${Pe}' is a main playlist`),Ae.isMainPlaylist=!0,$e=null):r==="vhs-json"&&Ae.playlists?$e=new Yo(Ae.playlists[0],i,d):Ae.resolvedUri?$e=new Yo(Ae.resolvedUri,i,d):Ae.playlists&&r==="dash"?$e=new fc(Ae.playlists[0],i,d,Y):$e=null,Ae=Ii({id:Pe,playlistLoader:$e},Ae),Ef[s](s,Ae.playlistLoader,e),g[Ie].push(Ae),typeof k[Pe]=="undefined"){const Ye=new ze.AudioTrack({id:Pe,kind:Wm(Ae),enabled:!1,language:Ae.language,default:Ae.default,label:Pe});k[Pe]=Ye}}}o.on("error",td[s](s,e))},SUBTITLES:(s,e)=>{const{tech:i,vhs:r,sourceType:o,segmentLoaders:{[s]:d},requestOptions:h,main:{mediaGroups:g},mediaTypes:{[s]:{groups:k,tracks:N}},mainPlaylistLoader:Y}=e;for(const me in g[s]){k[me]||(k[me]=[]);for(const Ie in g[s][me]){if(!r.options_.useForcedSubtitles&&g[s][me][Ie].forced)continue;let Pe=g[s][me][Ie],Ae;if(o==="hls")Ae=new Yo(Pe.resolvedUri,r,h);else if(o==="dash"){if(!Pe.playlists.filter(Ye=>Ye.excludeUntil!==Infinity).length)return;Ae=new fc(Pe.playlists[0],r,h,Y)}else o==="vhs-json"&&(Ae=new Yo(Pe.playlists?Pe.playlists[0]:Pe.resolvedUri,r,h));if(Pe=Ii({id:Ie,playlistLoader:Ae},Pe),Ef[s](s,Pe.playlistLoader,e),k[me].push(Pe),typeof N[Ie]=="undefined"){const $e=i.addRemoteTextTrack({id:Ie,kind:"subtitles",default:Pe.default&&Pe.autoselect,language:Pe.language,label:Ie},!1).track;N[Ie]=$e}}}d.on("error",td[s](s,e))},"CLOSED-CAPTIONS":(s,e)=>{const{tech:i,main:{mediaGroups:r},mediaTypes:{[s]:{groups:o,tracks:d}}}=e;for(const h in r[s]){o[h]||(o[h]=[]);for(const g in r[s][h]){const k=r[s][h][g];if(!/^(?:CC|SERVICE)/.test(k.instreamId))continue;const N=i.options_.vhs&&i.options_.vhs.captionServices||{};let Y={label:g,language:k.language,instreamId:k.instreamId,default:k.default&&k.autoselect};if(N[Y.instreamId]&&(Y=Ii(Y,N[Y.instreamId])),Y.default===void 0&&delete Y.default,o[h].push(Ii({id:g},k)),typeof d[g]=="undefined"){const me=i.addRemoteTextTrack({id:Y.instreamId,kind:"captions",default:Y.default,language:Y.language,label:Y.label},!1).track;d[g]=me}}}}},Tf=(s,e)=>{for(let i=0;i<s.length;i++)if(ac(e,s[i])||s[i].playlists&&Tf(s[i].playlists,e))return!0;return!1},Qm=(s,e)=>i=>{const{mainPlaylistLoader:r,mediaTypes:{[s]:{groups:o}}}=e,d=r.media();if(!d)return null;let h=null;d.attributes[s]&&(h=o[d.attributes[s]]);const g=Object.keys(o);if(!h)if(s==="AUDIO"&&g.length>1&&Xl(e.main))for(let k=0;k<g.length;k++){const N=o[g[k]];if(Tf(N,d)){h=N;break}}else o.main?h=o.main:g.length===1&&(h=o[g[0]]);return typeof i=="undefined"?h:i===null||!h?null:h.filter(k=>k.id===i.id)[0]||null},Jm={AUDIO:(s,e)=>()=>{const{mediaTypes:{[s]:{tracks:i}}}=e;for(const r in i)if(i[r].enabled)return i[r];return null},SUBTITLES:(s,e)=>()=>{const{mediaTypes:{[s]:{tracks:i}}}=e;for(const r in i)if(i[r].mode==="showing"||i[r].mode==="hidden")return i[r];return null}},Zm=(s,{mediaTypes:e})=>()=>{const i=e[s].activeTrack();return i?e[s].activeGroup(i):null},eg=s=>{["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(N=>{Xm[N](N,s)});const{mediaTypes:e,mainPlaylistLoader:i,tech:r,vhs:o,segmentLoaders:{["AUDIO"]:d,main:h}}=s;["AUDIO","SUBTITLES"].forEach(N=>{e[N].activeGroup=Qm(N,s),e[N].activeTrack=Jm[N](N,s),e[N].onGroupChanged=Km(N,s),e[N].onGroupChanging=zm(N,s),e[N].onTrackChanged=Ym(N,s),e[N].getActiveGroup=Zm(N,s)});const g=e.AUDIO.activeGroup();if(g){const N=(g.filter(me=>me.default)[0]||g[0]).id;e.AUDIO.tracks[N].enabled=!0,e.AUDIO.onGroupChanged(),e.AUDIO.onTrackChanged(),e.AUDIO.getActiveGroup().playlistLoader?(h.setAudio(!1),d.setAudio(!0)):h.setAudio(!0)}i.on("mediachange",()=>{["AUDIO","SUBTITLES"].forEach(N=>e[N].onGroupChanged())}),i.on("mediachanging",()=>{["AUDIO","SUBTITLES"].forEach(N=>e[N].onGroupChanging())});const k=()=>{e.AUDIO.onTrackChanged(),r.trigger({type:"usage",name:"vhs-audio-change"})};r.audioTracks().addEventListener("change",k),r.remoteTextTracks().addEventListener("change",e.SUBTITLES.onTrackChanged),o.on("dispose",()=>{r.audioTracks().removeEventListener("change",k),r.remoteTextTracks().removeEventListener("change",e.SUBTITLES.onTrackChanged)}),r.clearTracks("audio");for(const N in e.AUDIO.tracks)r.audioTracks().addTrack(e.AUDIO.tracks[N])},tg=()=>{const s={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(e=>{s[e]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:Ys,activeTrack:Ys,getActiveGroup:Ys,onGroupChanged:Ys,onTrackChanged:Ys,lastTrack_:null,logger_:Vr(`MediaGroups[${e}]`)}}),s};class Sf{constructor(){this.priority_=[]}set version(e){e===1&&(this.version_=e)}set ttl(e){this.ttl_=e||300}set reloadUri(e){e&&(this.reloadUri_=Tr(this.reloadUri_,e))}set priority(e){e&&e.length&&(this.priority_=e)}get version(){return this.version_}get ttl(){return this.ttl_}get reloadUri(){return this.reloadUri_}get priority(){return this.priority_}}class ig extends ze.EventTarget{constructor(e,i){super();this.currentPathway=null,this.defaultPathway=null,this.queryBeforeStart=null,this.availablePathways_=new Set,this.excludedPathways_=new Set,this.steeringManifest=new Sf,this.proxyServerUrl_=null,this.manifestType_=null,this.ttlTimeout_=null,this.request_=null,this.excludedSteeringManifestURLs=new Set,this.logger_=Vr("Content Steering"),this.xhr_=e,this.getBandwidth_=i}assignTagProperties(e,i){this.manifestType_=i.serverUri?"HLS":"DASH";const r=i.serverUri||i.serverURL;if(!r){this.logger_(`steering manifest URL is ${r}, cannot request steering manifest.`),this.trigger("error");return}if(r.startsWith("data:")){this.decodeDataUriManifest_(r.substring(r.indexOf(",")+1));return}this.steeringManifest.reloadUri=this.queryBeforeStart?r:Tr(e,r),this.defaultPathway=i.pathwayId||i.defaultServiceLocation,this.queryBeforeStart=i.queryBeforeStart||!1,this.proxyServerUrl_=i.proxyServerURL||null,this.defaultPathway&&!this.queryBeforeStart&&this.trigger("content-steering"),this.queryBeforeStart&&this.requestSteeringManifest(this.steeringManifest.reloadUri)}requestSteeringManifest(e){const i=this.steeringManifest.reloadUri;if(!e&&!i)return;const r=e||this.getRequestURI(i);if(!r){this.logger_("No valid content steering manifest URIs. Stopping content steering."),this.trigger("error"),this.dispose();return}this.request_=this.xhr_({uri:r},(o,d)=>{if(o){if(d.status===410){this.logger_(`manifest request 410 ${o}.`),this.logger_(`There will be no more content steering requests to ${r} this session.`),this.excludedSteeringManifestURLs.add(r);return}if(d.status===429){const g=d.responseHeaders["retry-after"];this.logger_(`manifest request 429 ${o}.`),this.logger_(`content steering will retry in ${g} seconds.`),this.startTTLTimeout_(parseInt(g,10));return}this.logger_(`manifest failed to load ${o}.`),this.startTTLTimeout_();return}const h=JSON.parse(this.request_.responseText);this.startTTLTimeout_(),this.assignSteeringProperties_(h)})}setProxyServerUrl_(e){const i=new(ae()).URL(e),r=new(ae()).URL(this.proxyServerUrl_);return r.searchParams.set("url",encodeURI(i.toString())),this.setSteeringParams_(r.toString())}decodeDataUriManifest_(e){const i=JSON.parse(ae().atob(e));this.assignSteeringProperties_(i)}setSteeringParams_(e){const i=new(ae()).URL(e),r=this.getPathway(),o=this.getBandwidth_();if(r){const d=`_${this.manifestType_}_pathway`;i.searchParams.set(d,r)}if(o){const d=`_${this.manifestType_}_throughput`;i.searchParams.set(d,o)}return i.toString()}assignSteeringProperties_(e){if(this.steeringManifest.version=e.VERSION,!this.steeringManifest.version){this.logger_(`manifest version is ${e.VERSION}, which is not supported.`),this.trigger("error");return}this.steeringManifest.ttl=e.TTL,this.steeringManifest.reloadUri=e["RELOAD-URI"],this.steeringManifest.priority=e["PATHWAY-PRIORITY"]||e["SERVICE-LOCATION-PRIORITY"],this.availablePathways_.size||(this.logger_("There are no available pathways for content steering. Ending content steering."),this.trigger("error"),this.dispose());const r=(o=>{for(const d of o)if(this.availablePathways_.has(d))return d;return[...this.availablePathways_][0]})(this.steeringManifest.priority);this.currentPathway!==r&&(this.currentPathway=r,this.trigger("content-steering"))}getPathway(){return this.currentPathway||this.defaultPathway}getRequestURI(e){if(!e)return null;const i=o=>this.excludedSteeringManifestURLs.has(o);if(this.proxyServerUrl_){const o=this.setProxyServerUrl_(e);if(!i(o))return o}const r=this.setSteeringParams_(e);return i(r)?null:r}startTTLTimeout_(e=this.steeringManifest.ttl){const i=e*1e3;this.ttlTimeout_=ae().setTimeout(()=>{this.requestSteeringManifest()},i)}clearTTLTimeout_(){ae().clearTimeout(this.ttlTimeout_),this.ttlTimeout_=null}abort(){this.request_&&this.request_.abort(),this.request_=null}dispose(){this.off("content-steering"),this.off("error"),this.abort(),this.clearTTLTimeout_(),this.currentPathway=null,this.defaultPathway=null,this.queryBeforeStart=null,this.proxyServerUrl_=null,this.manifestType_=null,this.ttlTimeout_=null,this.request_=null,this.excludedSteeringManifestURLs=new Set,this.availablePathways_=new Set,this.excludedPathways_=new Set,this.steeringManifest=new Sf}addAvailablePathway(e){e&&this.availablePathways_.add(e)}clearAvailablePathways(){this.availablePathways_.clear()}excludePathway(e){return this.availablePathways_.delete(e)}}const ng=10;let Xs;const rg=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred","mediaAppends"],sg=function(s){return this.audioSegmentLoader_[s]+this.mainSegmentLoader_[s]},ag=function({currentPlaylist:s,buffered:e,currentTime:i,nextPlaylist:r,bufferLowWaterLine:o,bufferHighWaterLine:d,duration:h,bufferBasedABR:g,log:k}){if(!r)return ze.log.warn("We received no playlist to switch to. Please check your stream."),!1;const N=`allowing switch ${s&&s.id||"null"} -> ${r.id}`;if(!s)return k(`${N} as current playlist is not set`),!0;if(r.id===s.id)return!1;const Y=Boolean(Ko(e,i).length);if(!s.endList)return!Y&&typeof s.partTargetDuration=="number"?(k(`not ${N} as current playlist is live llhls, but currentTime isn't in buffered.`),!1):(k(`${N} as current playlist is live`),!0);const me=tc(e,i),Ie=g?Ln.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:Ln.MAX_BUFFER_LOW_WATER_LINE;if(h<Ie)return k(`${N} as duration < max low water line (${h} < ${Ie})`),!0;const Pe=r.attributes.BANDWIDTH,Ae=s.attributes.BANDWIDTH;if(Pe<Ae&&(!g||me<d)){let $e=`${N} as next bandwidth < current bandwidth (${Pe} < ${Ae})`;return g&&($e+=` and forwardBuffer < bufferHighWaterLine (${me} < ${d})`),k($e),!0}if((!g||Pe>Ae)&&me>=o){let $e=`${N} as forwardBuffer >= bufferLowWaterLine (${me} >= ${o})`;return g&&($e+=` and next bandwidth > current bandwidth (${Pe} > ${Ae})`),k($e),!0}return k(`not ${N} as no switching criteria met`),!1};class og extends ze.EventTarget{constructor(e){super();const{src:i,withCredentials:r,tech:o,bandwidth:d,externVhs:h,useCueTags:g,playlistExclusionDuration:k,enableLowInitialPlaylist:N,sourceType:Y,cacheEncryptionKeys:me,bufferBasedABR:Ie,leastPixelDiffSelector:Pe,captionServices:Ae}=e;if(!i)throw new Error("A non-empty playlist URL or JSON manifest string is required");let{maxPlaylistRetries:$e}=e;($e===null||typeof $e=="undefined")&&($e=Infinity),Xs=h,this.bufferBasedABR=Boolean(Ie),this.leastPixelDiffSelector=Boolean(Pe),this.withCredentials=r,this.tech_=o,this.vhs_=o.vhs,this.sourceType_=Y,this.useCueTags_=g,this.playlistExclusionDuration=k,this.maxPlaylistRetries=$e,this.enableLowInitialPlaylist=N,this.useCueTags_&&(this.cueTagsTrack_=this.tech_.addTextTrack("metadata","ad-cues"),this.cueTagsTrack_.inBandMetadataTrackDispatchType=""),this.requestOptions_={withCredentials:r,maxPlaylistRetries:$e,timeout:null},this.on("error",this.pauseLoading),this.mediaTypes_=tg(),this.mediaSource=new(ae()).MediaSource,this.handleDurationChange_=this.handleDurationChange_.bind(this),this.handleSourceOpen_=this.handleSourceOpen_.bind(this),this.handleSourceEnded_=this.handleSourceEnded_.bind(this),this.mediaSource.addEventListener("durationchange",this.handleDurationChange_),this.mediaSource.addEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.addEventListener("sourceended",this.handleSourceEnded_),this.seekable_=Gn(),this.hasPlayed_=!1,this.syncController_=new Vm(e),this.segmentMetadataTrack_=o.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,this.decrypter_=new qm,this.sourceUpdater_=new vf(this.mediaSource),this.inbandTextTracks_={},this.timelineChangeController_=new Hm;const Ye={vhs:this.vhs_,parse708captions:e.parse708captions,useDtsForTimestampOffset:e.useDtsForTimestampOffset,calculateTimestampOffsetForEachSegment:e.calculateTimestampOffsetForEachSegment,captionServices:Ae,mediaSource:this.mediaSource,currentTime:this.tech_.currentTime.bind(this.tech_),seekable:()=>this.seekable(),seeking:()=>this.tech_.seeking(),duration:()=>this.duration(),hasPlayed:()=>this.hasPlayed_,goalBufferLength:()=>this.goalBufferLength(),bandwidth:d,syncController:this.syncController_,decrypter:this.decrypter_,sourceType:this.sourceType_,inbandTextTracks:this.inbandTextTracks_,cacheEncryptionKeys:me,sourceUpdater:this.sourceUpdater_,timelineChangeController:this.timelineChangeController_,exactManifestTimings:e.exactManifestTimings,addMetadataToTextTrack:this.addMetadataToTextTrack.bind(this)};this.mainPlaylistLoader_=this.sourceType_==="dash"?new fc(i,this.vhs_,Ii(this.requestOptions_,{addMetadataToTextTrack:this.addMetadataToTextTrack.bind(this)})):new Yo(i,this.vhs_,Ii(this.requestOptions_,{addDateRangesToTextTrack:this.addDateRangesToTextTrack_.bind(this)})),this.setupMainPlaylistLoaderListeners_(),this.mainSegmentLoader_=new vc(Ii(Ye,{segmentMetadataTrack:this.segmentMetadataTrack_,loaderType:"main"}),e),this.audioSegmentLoader_=new vc(Ii(Ye,{loaderType:"audio"}),e),this.subtitleSegmentLoader_=new Nm(Ii(Ye,{loaderType:"vtt",featuresNativeTextTracks:this.tech_.featuresNativeTextTracks,loadVttJs:()=>new Promise((ct,Je)=>{function je(){o.off("vttjserror",_t),ct()}function _t(){o.off("vttjsloaded",je),Je()}o.one("vttjsloaded",je),o.one("vttjserror",_t),o.addWebVttScript_()})}),e);const Qe=()=>this.mainSegmentLoader_.bandwidth;this.contentSteeringController_=new ig(this.vhs_.xhr,Qe),this.setupSegmentLoaderListeners_(),this.bufferBasedABR&&(this.mainPlaylistLoader_.one("loadedplaylist",()=>this.startABRTimer_()),this.tech_.on("pause",()=>this.stopABRTimer_()),this.tech_.on("play",()=>this.startABRTimer_())),rg.forEach(ct=>{this[ct+"_"]=sg.bind(this,ct)}),this.logger_=Vr("pc"),this.triggeredFmp4Usage=!1,this.tech_.preload()==="none"?(this.loadOnPlay_=()=>{this.loadOnPlay_=null,this.mainPlaylistLoader_.load()},this.tech_.one("play",this.loadOnPlay_)):this.mainPlaylistLoader_.load(),this.timeToLoadedData__=-1,this.mainAppendsToLoadedData__=-1,this.audioAppendsToLoadedData__=-1;const qe=this.tech_.preload()==="none"?"play":"loadstart";this.tech_.one(qe,()=>{const ct=Date.now();this.tech_.one("loadeddata",()=>{this.timeToLoadedData__=Date.now()-ct,this.mainAppendsToLoadedData__=this.mainSegmentLoader_.mediaAppends,this.audioAppendsToLoadedData__=this.audioSegmentLoader_.mediaAppends})})}mainAppendsToLoadedData_(){return this.mainAppendsToLoadedData__}audioAppendsToLoadedData_(){return this.audioAppendsToLoadedData__}appendsToLoadedData_(){const e=this.mainAppendsToLoadedData_(),i=this.audioAppendsToLoadedData_();return e===-1||i===-1?-1:e+i}timeToLoadedData_(){return this.timeToLoadedData__}checkABR_(e="abr"){const i=this.selectPlaylist();i&&this.shouldSwitchToMedia_(i)&&this.switchMedia_(i,e)}switchMedia_(e,i,r){const o=this.media(),d=o&&(o.id||o.uri),h=e.id||e.uri;d&&d!==h&&(this.logger_(`switch media ${d} -> ${h} from ${i}`),this.tech_.trigger({type:"usage",name:`vhs-rendition-change-${i}`})),this.mainPlaylistLoader_.media(e,r)}switchMediaForDASHContentSteering_(){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(e=>{const i=this.mediaTypes_[e],r=i?i.activeGroup():null,o=this.contentSteeringController_.getPathway();if(r&&o){const h=(r.length?r[0].playlists:r.playlists).filter(g=>g.attributes.serviceLocation===o);h.length&&this.mediaTypes_[e].activePlaylistLoader.media(h[0])}})}startABRTimer_(){this.stopABRTimer_(),this.abrTimer_=ae().setInterval(()=>this.checkABR_(),250)}stopABRTimer_(){this.tech_.scrubbing&&this.tech_.scrubbing()||(ae().clearInterval(this.abrTimer_),this.abrTimer_=null)}getAudioTrackPlaylists_(){const e=this.main(),i=e&&e.playlists||[];if(!e||!e.mediaGroups||!e.mediaGroups.AUDIO)return i;const r=e.mediaGroups.AUDIO,o=Object.keys(r);let d;if(Object.keys(this.mediaTypes_.AUDIO.groups).length)d=this.mediaTypes_.AUDIO.activeTrack();else{const g=r.main||o.length&&r[o[0]];for(const k in g)if(g[k].default){d={label:k};break}}if(!d)return i;const h=[];for(const g in r)if(r[g][d.label]){const k=r[g][d.label];if(k.playlists&&k.playlists.length)h.push.apply(h,k.playlists);else if(k.uri)h.push(k);else if(e.playlists.length)for(let N=0;N<e.playlists.length;N++){const Y=e.playlists[N];Y.attributes&&Y.attributes.AUDIO&&Y.attributes.AUDIO===g&&h.push(Y)}}return h.length?h:i}setupMainPlaylistLoaderListeners_(){this.mainPlaylistLoader_.on("loadedmetadata",()=>{const e=this.mainPlaylistLoader_.media(),i=e.targetDuration*1.5*1e3;sc(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=i,e.endList&&this.tech_.preload()!=="none"&&(this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.mainSegmentLoader_.load()),eg({sourceType:this.sourceType_,segmentLoaders:{AUDIO:this.audioSegmentLoader_,SUBTITLES:this.subtitleSegmentLoader_,main:this.mainSegmentLoader_},tech:this.tech_,requestOptions:this.requestOptions_,mainPlaylistLoader:this.mainPlaylistLoader_,vhs:this.vhs_,main:this.main(),mediaTypes:this.mediaTypes_,excludePlaylist:this.excludePlaylist.bind(this)}),this.triggerPresenceUsage_(this.main(),e),this.setupFirstPlay(),!this.mediaTypes_.AUDIO.activePlaylistLoader||this.mediaTypes_.AUDIO.activePlaylistLoader.media()?this.trigger("selectedinitialmedia"):this.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",()=>{this.trigger("selectedinitialmedia")})}),this.mainPlaylistLoader_.on("loadedplaylist",()=>{this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_);let e=this.mainPlaylistLoader_.media();if(!e){this.initContentSteeringController_(),this.excludeUnsupportedVariants_();let i;if(this.enableLowInitialPlaylist&&(i=this.selectInitialPlaylist()),i||(i=this.selectPlaylist()),!i||!this.shouldSwitchToMedia_(i)||(this.initialMedia_=i,this.switchMedia_(this.initialMedia_,"initial"),!(this.sourceType_==="vhs-json"&&this.initialMedia_.segments)))return;e=this.initialMedia_}this.handleUpdatedMediaPlaylist(e)}),this.mainPlaylistLoader_.on("error",()=>{const e=this.mainPlaylistLoader_.error;this.excludePlaylist({playlistToExclude:e.playlist,error:e})}),this.mainPlaylistLoader_.on("mediachanging",()=>{this.mainSegmentLoader_.abort(),this.mainSegmentLoader_.pause()}),this.mainPlaylistLoader_.on("mediachange",()=>{const e=this.mainPlaylistLoader_.media(),i=e.targetDuration*1.5*1e3;sc(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=i,this.mainPlaylistLoader_.load(),this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.mainSegmentLoader_.load(),this.tech_.trigger({type:"mediachange",bubbles:!0})}),this.mainPlaylistLoader_.on("playlistunchanged",()=>{const e=this.mainPlaylistLoader_.media();if(e.lastExcludeReason_==="playlist-unchanged")return;this.stuckAtPlaylistEnd_(e)&&(this.excludePlaylist({error:{message:"Playlist no longer updating.",reason:"playlist-unchanged"}}),this.tech_.trigger("playliststuck"))}),this.mainPlaylistLoader_.on("renditiondisabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"})}),this.mainPlaylistLoader_.on("renditionenabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"})})}handleUpdatedMediaPlaylist(e){this.useCueTags_&&this.updateAdCues_(e),this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.updateDuration(!e.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())}triggerPresenceUsage_(e,i){const r=e.mediaGroups||{};let o=!0;const d=Object.keys(r.AUDIO);for(const h in r.AUDIO)for(const g in r.AUDIO[h])r.AUDIO[h][g].uri||(o=!1);o&&this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),Object.keys(r.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),Xs.Playlist.isAes(i)&&this.tech_.trigger({type:"usage",name:"vhs-aes"}),d.length&&Object.keys(r.AUDIO[d[0]]).length>1&&this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"})}shouldSwitchToMedia_(e){const i=this.mainPlaylistLoader_.media()||this.mainPlaylistLoader_.pendingMedia_,r=this.tech_.currentTime(),o=this.bufferLowWaterLine(),d=this.bufferHighWaterLine(),h=this.tech_.buffered();return ag({buffered:h,currentTime:r,currentPlaylist:i,nextPlaylist:e,bufferLowWaterLine:o,bufferHighWaterLine:d,duration:this.duration(),bufferBasedABR:this.bufferBasedABR,log:this.logger_})}setupSegmentLoaderListeners_(){this.mainSegmentLoader_.on("bandwidthupdate",()=>{this.checkABR_("bandwidthupdate"),this.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("timeout",()=>{this.bufferBasedABR&&this.mainSegmentLoader_.load()}),this.bufferBasedABR||this.mainSegmentLoader_.on("progress",()=>{this.trigger("progress")}),this.mainSegmentLoader_.on("error",()=>{const i=this.mainSegmentLoader_.error();this.excludePlaylist({playlistToExclude:i.playlist,error:i})}),this.mainSegmentLoader_.on("appenderror",()=>{this.error=this.mainSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",()=>{this.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.audioSegmentLoader_.on("appenderror",()=>{this.error=this.audioSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("ended",()=>{this.logger_("main segment loader ended"),this.onEndOfStream()}),this.mainSegmentLoader_.on("earlyabort",i=>{this.bufferBasedABR||(this.delegateLoaders_("all",["abort"]),this.excludePlaylist({error:{message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},playlistExclusionDuration:ng}))});const e=()=>{if(!this.sourceUpdater_.hasCreatedSourceBuffers())return this.tryToCreateSourceBuffers_();const i=this.getCodecsOrExclude_();!i||this.sourceUpdater_.addOrChangeSourceBuffers(i)};this.mainSegmentLoader_.on("trackinfo",e),this.audioSegmentLoader_.on("trackinfo",e),this.mainSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("ended",()=>{this.logger_("audioSegmentLoader ended"),this.onEndOfStream()})}mediaSecondsLoaded_(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}load(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}fastQualityChange_(e=this.selectPlaylist()){if(e===this.mainPlaylistLoader_.media()){this.logger_("skipping fastQualityChange because new media is same as old");return}this.switchMedia_(e,"fast-quality"),this.resetMainLoaderReplaceSegments()}resetMainLoaderReplaceSegments(){const e=this.tech_.buffered(),i=e.end(e.length-1);this.mainSegmentLoader_.replaceSegmentsUntil=i,this.mainSegmentLoader_.resetLoaderProperties(),this.mainSegmentLoader_.resetLoader()}play(){if(this.setupFirstPlay())return;this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();const e=this.tech_.seekable();if(this.tech_.duration()===Infinity&&this.tech_.currentTime()<e.start(0))return this.tech_.setCurrentTime(e.end(e.length-1))}setupFirstPlay(){const e=this.mainPlaylistLoader_.media();if(!e||this.tech_.paused()||this.hasPlayed_)return!1;if(!e.endList||e.start){const i=this.seekable();if(!i.length)return!1;const r=i.end(0);let o=r;if(e.start){const d=e.start.timeOffset;d<0?o=Math.max(r+d,i.start(0)):o=Math.min(r,d)}this.trigger("firstplay"),this.tech_.setCurrentTime(o)}return this.hasPlayed_=!0,this.load(),!0}handleSourceOpen_(){if(this.tryToCreateSourceBuffers_(),this.tech_.autoplay()){const e=this.tech_.play();typeof e!="undefined"&&typeof e.then=="function"&&e.then(null,i=>{})}this.trigger("sourceopen")}handleSourceEnded_(){if(!this.inbandTextTracks_.metadataTrack_)return;const e=this.inbandTextTracks_.metadataTrack_.cues;if(!e||!e.length)return;const i=this.duration();e[e.length-1].endTime=isNaN(i)||Math.abs(i)===Infinity?Number.MAX_VALUE:i}handleDurationChange_(){this.tech_.trigger("durationchange")}onEndOfStream(){let e=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){const i=this.mainSegmentLoader_.getCurrentMediaInfo_();!i||i.hasVideo?e=e&&this.audioSegmentLoader_.ended_:e=this.audioSegmentLoader_.ended_}!e||(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())}stuckAtPlaylistEnd_(e){if(!this.seekable().length)return!1;const r=this.syncController_.getExpiredTime(e,this.duration());if(r===null)return!1;const o=Xs.Playlist.playlistEnd(e,r),d=this.tech_.currentTime(),h=this.tech_.buffered();if(!h.length)return o-d<=Cs;const g=h.end(h.length-1);return g-d<=Cs&&o-g<=Cs}excludePlaylist({playlistToExclude:e=this.mainPlaylistLoader_.media(),error:i={},playlistExclusionDuration:r}){if(e=e||this.mainPlaylistLoader_.media(),r=r||i.playlistExclusionDuration||this.playlistExclusionDuration,!e){this.error=i,this.mediaSource.readyState!=="open"?this.trigger("error"):this.sourceUpdater_.endOfStream("network");return}e.playlistErrors_++;const o=this.mainPlaylistLoader_.main.playlists,d=o.filter(Yu),h=d.length===1&&d[0]===e;if(o.length===1&&r!==Infinity)return ze.log.warn(`Problem encountered with playlist ${e.id}. Trying again since it is the only playlist.`),this.tech_.trigger("retryplaylist"),this.mainPlaylistLoader_.load(h);if(h){if(this.main().contentSteering){const Ae=this.pathwayAttribute_(e),$e=this.contentSteeringController_.steeringManifest.ttl*1e3;this.contentSteeringController_.excludePathway(Ae),this.excludeThenChangePathway_(),setTimeout(()=>{this.contentSteeringController_.addAvailablePathway(Ae)},$e);return}let Pe=!1;o.forEach(Ae=>{if(Ae===e)return;const $e=Ae.excludeUntil;typeof $e!="undefined"&&$e!==Infinity&&(Pe=!0,delete Ae.excludeUntil)}),Pe&&(ze.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}let g;e.playlistErrors_>this.maxPlaylistRetries?g=Infinity:g=Date.now()+r*1e3,e.excludeUntil=g,i.reason&&(e.lastExcludeReason_=i.reason),this.tech_.trigger("excludeplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-excluded"});const k=this.selectPlaylist();if(!k){this.error="Playback cannot continue. No available working or supported playlists.",this.trigger("error");return}const N=i.internal?this.logger_:ze.log.warn,Y=i.message?" "+i.message:"";N(`${i.internal?"Internal problem":"Problem"} encountered with playlist ${e.id}.${Y} Switching to playlist ${k.id}.`),k.attributes.AUDIO!==e.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),k.attributes.SUBTITLES!==e.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]);const me=k.targetDuration/2*1e3||5*1e3,Ie=typeof k.lastRequest=="number"&&Date.now()-k.lastRequest<=me;return this.switchMedia_(k,"exclude",h||Ie)}pauseLoading(){this.delegateLoaders_("all",["abort","pause"]),this.stopABRTimer_()}delegateLoaders_(e,i){const r=[],o=e==="all";(o||e==="main")&&r.push(this.mainPlaylistLoader_);const d=[];(o||e==="audio")&&d.push("AUDIO"),(o||e==="subtitle")&&(d.push("CLOSED-CAPTIONS"),d.push("SUBTITLES")),d.forEach(h=>{const g=this.mediaTypes_[h]&&this.mediaTypes_[h].activePlaylistLoader;g&&r.push(g)}),["main","audio","subtitle"].forEach(h=>{const g=this[`${h}SegmentLoader_`];g&&(e===h||e==="all")&&r.push(g)}),r.forEach(h=>i.forEach(g=>{typeof h[g]=="function"&&h[g]()}))}setCurrentTime(e){const i=Ko(this.tech_.buffered(),e);if(!(this.mainPlaylistLoader_&&this.mainPlaylistLoader_.media())||!this.mainPlaylistLoader_.media().segments)return 0;if(i&&i.length)return e;this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.resetEverything(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.resetEverything(),this.load()}duration(){if(!this.mainPlaylistLoader_)return 0;const e=this.mainPlaylistLoader_.media();return e?e.endList?this.mediaSource?this.mediaSource.duration:Xs.Playlist.duration(e):Infinity:0}seekable(){return this.seekable_}onSyncInfoUpdate_(){let e;if(!this.mainPlaylistLoader_)return;let i=this.mainPlaylistLoader_.media();if(!i)return;let r=this.syncController_.getExpiredTime(i,this.duration());if(r===null)return;const o=this.mainPlaylistLoader_.main,d=Xs.Playlist.seekable(i,r,Xs.Playlist.liveEdgeDelay(o,i));if(d.length===0||this.mediaTypes_.AUDIO.activePlaylistLoader&&(i=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),r=this.syncController_.getExpiredTime(i,this.duration()),r===null||(e=Xs.Playlist.seekable(i,r,Xs.Playlist.liveEdgeDelay(o,i)),e.length===0)))return;let h,g;this.seekable_&&this.seekable_.length&&(h=this.seekable_.end(0),g=this.seekable_.start(0)),e?e.start(0)>d.end(0)||d.start(0)>e.end(0)?this.seekable_=d:this.seekable_=Gn([[e.start(0)>d.start(0)?e.start(0):d.start(0),e.end(0)<d.end(0)?e.end(0):d.end(0)]]):this.seekable_=d,!(this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===h&&this.seekable_.start(0)===g)&&(this.logger_(`seekable updated [${yh(this.seekable_)}]`),this.tech_.trigger("seekablechanged"))}updateDuration(e){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),this.mediaSource.readyState!=="open"){this.updateDuration_=this.updateDuration.bind(this,e),this.mediaSource.addEventListener("sourceopen",this.updateDuration_);return}if(e){const o=this.seekable();if(!o.length)return;(isNaN(this.mediaSource.duration)||this.mediaSource.duration<o.end(o.length-1))&&this.sourceUpdater_.setDuration(o.end(o.length-1));return}const i=this.tech_.buffered();let r=Xs.Playlist.duration(this.mainPlaylistLoader_.media());i.length>0&&(r=Math.max(r,i.end(i.length-1))),this.mediaSource.duration!==r&&this.sourceUpdater_.setDuration(r)}dispose(){this.trigger("dispose"),this.decrypter_.terminate(),this.mainPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),this.contentSteeringController_.dispose(),this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_),["AUDIO","SUBTITLES"].forEach(e=>{const i=this.mediaTypes_[e].groups;for(const r in i)i[r].forEach(o=>{o.playlistLoader&&o.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.stopABRTimer_(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()}main(){return this.mainPlaylistLoader_.main}media(){return this.mainPlaylistLoader_.media()||this.initialMedia_}areMediaTypesKnown_(){const e=!!this.mediaTypes_.AUDIO.activePlaylistLoader,i=!!this.mainSegmentLoader_.getCurrentMediaInfo_(),r=e?!!this.audioSegmentLoader_.getCurrentMediaInfo_():!0;return!(!i||!r)}getCodecsOrExclude_(){const e={main:this.mainSegmentLoader_.getCurrentMediaInfo_()||{},audio:this.audioSegmentLoader_.getCurrentMediaInfo_()||{}},i=this.mainSegmentLoader_.getPendingSegmentPlaylist()||this.media();e.video=e.main;const r=Jl(this.main(),i),o={},d=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(e.main.hasVideo&&(o.video=r.video||e.main.videoCodec||_i),e.main.isMuxed&&(o.video+=`,${r.audio||e.main.audioCodec||Xt}`),(e.main.hasAudio&&!e.main.isMuxed||e.audio.hasAudio||d)&&(o.audio=r.audio||e.main.audioCodec||e.audio.audioCodec||Xt,e.audio.isFmp4=e.main.hasAudio&&!e.main.isMuxed?e.main.isFmp4:e.audio.isFmp4),!o.audio&&!o.video){this.excludePlaylist({playlistToExclude:i,error:{message:"Could not determine codecs for playlist."},playlistExclusionDuration:Infinity});return}const h=(N,Y)=>N?Vt(Y):si(Y),g={};let k;if(["video","audio"].forEach(function(N){if(o.hasOwnProperty(N)&&!h(e[N].isFmp4,o[N])){const Y=e[N].isFmp4?"browser":"muxer";g[Y]=g[Y]||[],g[Y].push(o[N]),N==="audio"&&(k=Y)}}),d&&k&&i.attributes.AUDIO){const N=i.attributes.AUDIO;this.main().playlists.forEach(Y=>{(Y.attributes&&Y.attributes.AUDIO)===N&&Y!==i&&(Y.excludeUntil=Infinity)}),this.logger_(`excluding audio group ${N} as ${k} does not support codec(s): "${o.audio}"`)}if(Object.keys(g).length){const N=Object.keys(g).reduce((Y,me)=>(Y&&(Y+=", "),Y+=`${me} does not support codec(s): "${g[me].join(",")}"`,Y),"")+".";this.excludePlaylist({playlistToExclude:i,error:{internal:!0,message:N},playlistExclusionDuration:Infinity});return}if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){const N=[];if(["video","audio"].forEach(Y=>{const me=(wt(this.sourceUpdater_.codecs[Y]||"")[0]||{}).type,Ie=(wt(o[Y]||"")[0]||{}).type;me&&Ie&&me.toLowerCase()!==Ie.toLowerCase()&&N.push(`"${this.sourceUpdater_.codecs[Y]}" -> "${o[Y]}"`)}),N.length){this.excludePlaylist({playlistToExclude:i,error:{message:`Codec switching not supported: ${N.join(", ")}.`,internal:!0},playlistExclusionDuration:Infinity});return}}return o}tryToCreateSourceBuffers_(){if(this.mediaSource.readyState!=="open"||this.sourceUpdater_.hasCreatedSourceBuffers()||!this.areMediaTypesKnown_())return;const e=this.getCodecsOrExclude_();if(!e)return;this.sourceUpdater_.createSourceBuffers(e);const i=[e.video,e.audio].filter(Boolean).join(",");this.excludeIncompatibleVariants_(i)}excludeUnsupportedVariants_(){const e=this.main().playlists,i=[];Object.keys(e).forEach(r=>{const o=e[r];if(i.indexOf(o.id)!==-1)return;i.push(o.id);const d=Jl(this.main,o),h=[];d.audio&&!si(d.audio)&&!Vt(d.audio)&&h.push(`audio codec ${d.audio}`),d.video&&!si(d.video)&&!Vt(d.video)&&h.push(`video codec ${d.video}`),d.text&&d.text==="stpp.ttml.im1t"&&h.push(`text codec ${d.text}`),h.length&&(o.excludeUntil=Infinity,this.logger_(`excluding ${o.id} for unsupported: ${h.join(", ")}`))})}excludeIncompatibleVariants_(e){const i=[],r=this.main().playlists,o=Qu(wt(e)),d=rf(o),h=o.video&&wt(o.video)[0]||null,g=o.audio&&wt(o.audio)[0]||null;Object.keys(r).forEach(k=>{const N=r[k];if(i.indexOf(N.id)!==-1||N.excludeUntil===Infinity)return;i.push(N.id);const Y=[],me=Jl(this.mainPlaylistLoader_.main,N),Ie=rf(me);if(!(!me.audio&&!me.video)){if(Ie!==d&&Y.push(`codec count "${Ie}" !== "${d}"`),!this.sourceUpdater_.canChangeType()){const Pe=me.video&&wt(me.video)[0]||null,Ae=me.audio&&wt(me.audio)[0]||null;Pe&&h&&Pe.type.toLowerCase()!==h.type.toLowerCase()&&Y.push(`video codec "${Pe.type}" !== "${h.type}"`),Ae&&g&&Ae.type.toLowerCase()!==g.type.toLowerCase()&&Y.push(`audio codec "${Ae.type}" !== "${g.type}"`)}Y.length&&(N.excludeUntil=Infinity,this.logger_(`excluding ${N.id}: ${Y.join(" && ")}`))}})}updateAdCues_(e){let i=0;const r=this.seekable();r.length&&(i=r.start(0)),jm(e,this.cueTagsTrack_,i)}goalBufferLength(){const e=this.tech_.currentTime(),i=Ln.GOAL_BUFFER_LENGTH,r=Ln.GOAL_BUFFER_LENGTH_RATE,o=Math.max(i,Ln.MAX_GOAL_BUFFER_LENGTH);return Math.min(i+e*r,o)}bufferLowWaterLine(){const e=this.tech_.currentTime(),i=Ln.BUFFER_LOW_WATER_LINE,r=Ln.BUFFER_LOW_WATER_LINE_RATE,o=Math.max(i,Ln.MAX_BUFFER_LOW_WATER_LINE),d=Math.max(i,Ln.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(i+e*r,this.bufferBasedABR?d:o)}bufferHighWaterLine(){return Ln.BUFFER_HIGH_WATER_LINE}addDateRangesToTextTrack_(e){lf(this.inbandTextTracks_,"com.apple.streaming",this.tech_),xm({inbandTextTracks:this.inbandTextTracks_,dateRanges:e})}addMetadataToTextTrack(e,i,r){const o=this.sourceUpdater_.videoBuffer?this.sourceUpdater_.videoTimestampOffset():this.sourceUpdater_.audioTimestampOffset();lf(this.inbandTextTracks_,e,this.tech_),Am({inbandTextTracks:this.inbandTextTracks_,metadataArray:i,timestampOffset:o,videoDuration:r})}pathwayAttribute_(e){return e.attributes["PATHWAY-ID"]||e.attributes.serviceLocation}initContentSteeringController_(){const e=this.main();if(!e.contentSteering)return;const i=r=>{for(const o of r.playlists)this.contentSteeringController_.addAvailablePathway(this.pathwayAttribute_(o));this.contentSteeringController_.assignTagProperties(r.uri,r.contentSteering)};i(e),this.contentSteeringController_.on("content-steering",this.excludeThenChangePathway_.bind(this)),this.sourceType_==="dash"&&this.mainPlaylistLoader_.on("mediaupdatetimeout",()=>{this.mainPlaylistLoader_.refreshMedia_(this.mainPlaylistLoader_.media().id),this.contentSteeringController_.abort(),this.contentSteeringController_.clearTTLTimeout_(),this.contentSteeringController_.clearAvailablePathways(),i(this.main())}),this.contentSteeringController_.queryBeforeStart||this.tech_.one("canplay",()=>{this.contentSteeringController_.requestSteeringManifest()})}excludeThenChangePathway_(){const e=this.contentSteeringController_.getPathway();if(!e)return;const r=this.main().playlists,o=new Set;let d=!1;Object.keys(r).forEach(h=>{const g=r[h],k=this.pathwayAttribute_(g),N=k&&e!==k;g.excludeUntil===Infinity&&g.lastExcludeReason_==="content-steering"&&!N&&(delete g.excludeUntil,delete g.lastExcludeReason_,d=!0);const me=!g.excludeUntil&&g.excludeUntil!==Infinity;!(!o.has(g.id)&&N&&me)||(o.add(g.id),g.excludeUntil=Infinity,g.lastExcludeReason_="content-steering",this.logger_(`excluding ${g.id} for ${g.lastExcludeReason_}`))}),this.contentSteeringController_.manifestType_==="DASH"&&Object.keys(this.mediaTypes_).forEach(h=>{const g=this.mediaTypes_[h];if(g.activePlaylistLoader){const k=g.activePlaylistLoader.media_;k&&k.attributes.serviceLocation!==e&&(d=!0)}}),d&&this.changeSegmentPathway_()}changeSegmentPathway_(){const e=this.selectPlaylist();this.pauseLoading(),this.contentSteeringController_.manifestType_==="DASH"&&this.switchMediaForDASHContentSteering_(),this.switchMedia_(e,"content-steering")}}const lg=(s,e,i)=>r=>{const o=s.main.playlists[e],d=rc(o),h=Yu(o);return typeof r=="undefined"?h:(r?delete o.disabled:o.disabled=!0,r!==h&&!d&&(i(),r?s.trigger("renditionenabled"):s.trigger("renditiondisabled")),r)};class ug{constructor(e,i,r){const{playlistController_:o}=e,d=o.fastQualityChange_.bind(o);if(i.attributes){const h=i.attributes.RESOLUTION;this.width=h&&h.width,this.height=h&&h.height,this.bandwidth=i.attributes.BANDWIDTH,this.frameRate=i.attributes["FRAME-RATE"]}this.codecs=Jl(o.main(),i),this.playlist=i,this.id=r,this.enabled=lg(e.playlists,i.id,d)}}const dg=function(s){s.representations=()=>{const e=s.playlistController_.main(),i=Xl(e)?s.playlistController_.getAudioTrackPlaylists_():e.playlists;return i?i.filter(r=>!rc(r)).map((r,o)=>new ug(s,r,r.id)):[]}},Cf=["seeking","seeked","pause","playing","error"];class cg{constructor(e){this.playlistController_=e.playlistController,this.tech_=e.tech,this.seekable=e.seekable,this.allowSeeksWithinUnsafeLiveWindow=e.allowSeeksWithinUnsafeLiveWindow,this.liveRangeSafeTimeDelta=e.liveRangeSafeTimeDelta,this.media=e.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.checkCurrentTimeTimeout_=null,this.logger_=Vr("PlaybackWatcher"),this.logger_("initialize");const i=()=>this.monitorCurrentTime_(),r=()=>this.monitorCurrentTime_(),o=()=>this.techWaiting_(),d=()=>this.resetTimeUpdate_(),h=this.playlistController_,g=["main","subtitle","audio"],k={};g.forEach(Y=>{k[Y]={reset:()=>this.resetSegmentDownloads_(Y),updateend:()=>this.checkSegmentDownloads_(Y)},h[`${Y}SegmentLoader_`].on("appendsdone",k[Y].updateend),h[`${Y}SegmentLoader_`].on("playlistupdate",k[Y].reset),this.tech_.on(["seeked","seeking"],k[Y].reset)});const N=Y=>{["main","audio"].forEach(me=>{h[`${me}SegmentLoader_`][Y]("appended",this.seekingAppendCheck_)})};this.seekingAppendCheck_=()=>{this.fixesBadSeeks_()&&(this.consecutiveUpdates=0,this.lastRecordedTime=this.tech_.currentTime(),N("off"))},this.clearSeekingAppendCheck_=()=>N("off"),this.watchForBadSeeking_=()=>{this.clearSeekingAppendCheck_(),N("on")},this.tech_.on("seeked",this.clearSeekingAppendCheck_),this.tech_.on("seeking",this.watchForBadSeeking_),this.tech_.on("waiting",o),this.tech_.on(Cf,d),this.tech_.on("canplay",r),this.tech_.one("play",i),this.dispose=()=>{this.clearSeekingAppendCheck_(),this.logger_("dispose"),this.tech_.off("waiting",o),this.tech_.off(Cf,d),this.tech_.off("canplay",r),this.tech_.off("play",i),this.tech_.off("seeking",this.watchForBadSeeking_),this.tech_.off("seeked",this.clearSeekingAppendCheck_),g.forEach(Y=>{h[`${Y}SegmentLoader_`].off("appendsdone",k[Y].updateend),h[`${Y}SegmentLoader_`].off("playlistupdate",k[Y].reset),this.tech_.off(["seeked","seeking"],k[Y].reset)}),this.checkCurrentTimeTimeout_&&ae().clearTimeout(this.checkCurrentTimeTimeout_),this.resetTimeUpdate_()}}monitorCurrentTime_(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&ae().clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=ae().setTimeout(this.monitorCurrentTime_.bind(this),250)}resetSegmentDownloads_(e){const i=this.playlistController_[`${e}SegmentLoader_`];this[`${e}StalledDownloads_`]>0&&this.logger_(`resetting possible stalled download count for ${e} loader`),this[`${e}StalledDownloads_`]=0,this[`${e}Buffered_`]=i.buffered_()}checkSegmentDownloads_(e){const i=this.playlistController_,r=i[`${e}SegmentLoader_`],o=r.buffered_(),d=n0(this[`${e}Buffered_`],o);if(this[`${e}Buffered_`]=o,d){this.resetSegmentDownloads_(e);return}this[`${e}StalledDownloads_`]++,this.logger_(`found #${this[`${e}StalledDownloads_`]} ${e} appends that did not increase buffer (possible stalled download)`,{playlistId:r.playlist_&&r.playlist_.id,buffered:eo(o)}),!(this[`${e}StalledDownloads_`]<10)&&(this.logger_(`${e} loader stalled download exclusion`),this.resetSegmentDownloads_(e),this.tech_.trigger({type:"usage",name:`vhs-${e}-download-exclusion`}),e!=="subtitle"&&i.excludePlaylist({error:{message:`Excessive ${e} segment downloading detected.`},playlistExclusionDuration:Infinity}))}checkCurrentTime_(){if(this.tech_.paused()||this.tech_.seeking())return;const e=this.tech_.currentTime(),i=this.tech_.buffered();if(this.lastRecordedTime===e&&(!i.length||e+Cs>=i.end(i.length-1)))return this.techWaiting_();this.consecutiveUpdates>=5&&e===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):e===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=e)}resetTimeUpdate_(){this.consecutiveUpdates=0}fixesBadSeeks_(){if(!this.tech_.seeking())return!1;const i=this.seekable(),r=this.tech_.currentTime(),o=this.afterSeekableWindow_(i,r,this.media(),this.allowSeeksWithinUnsafeLiveWindow);let d;if(o&&(d=i.end(i.length-1)),this.beforeSeekableWindow_(i,r)){const Ae=i.start(0);d=Ae+(Ae===i.end(0)?0:Cs)}if(typeof d!="undefined")return this.logger_(`Trying to seek outside of seekable at time ${r} with seekable range ${yh(i)}. Seeking to ${d}.`),this.tech_.setCurrentTime(d),!0;const h=this.playlistController_.sourceUpdater_,g=this.tech_.buffered(),k=h.audioBuffer?h.audioBuffered():null,N=h.videoBuffer?h.videoBuffered():null,Y=this.media(),me=Y.partTargetDuration?Y.partTargetDuration:(Y.targetDuration-Ta)*2,Ie=[k,N];for(let Ae=0;Ae<Ie.length;Ae++){if(!Ie[Ae])continue;if(tc(Ie[Ae],r)<me)return!1}const Pe=zu(g,r);return Pe.length===0?!1:(d=Pe.start(0)+Cs,this.logger_(`Buffered region starts (${Pe.start(0)})  just beyond seek point (${r}). Seeking to ${d}.`),this.tech_.setCurrentTime(d),!0)}waiting_(){if(this.techWaiting_())return;const e=this.tech_.currentTime(),i=this.tech_.buffered(),r=Ko(i,e);if(r.length&&e+3<=r.end(0)){this.resetTimeUpdate_(),this.tech_.setCurrentTime(e),this.logger_(`Stopped at ${e} while inside a buffered region [${r.start(0)} -> ${r.end(0)}]. Attempting to resume playback by seeking to the current time.`),this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"});return}}techWaiting_(){const e=this.seekable(),i=this.tech_.currentTime();if(this.tech_.seeking())return!0;if(this.beforeSeekableWindow_(e,i)){const g=e.end(e.length-1);return this.logger_(`Fell out of live window at time ${i}. Seeking to live point (seekable end) ${g}`),this.resetTimeUpdate_(),this.tech_.setCurrentTime(g),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),!0}const r=this.tech_.vhs.playlistController_.sourceUpdater_,o=this.tech_.buffered();if(this.videoUnderflow_({audioBuffered:r.audioBuffered(),videoBuffered:r.videoBuffered(),currentTime:i}))return this.resetTimeUpdate_(),this.tech_.setCurrentTime(i),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),!0;const h=zu(o,i);return h.length>0?(this.logger_(`Stopped at ${i} and seeking to ${h.start(0)}`),this.resetTimeUpdate_(),this.skipTheGap_(i),!0):!1}afterSeekableWindow_(e,i,r,o=!1){if(!e.length)return!1;let d=e.end(e.length-1)+Cs;const h=!r.endList,g=typeof r.partTargetDuration=="number";return h&&(g||o)&&(d=e.end(e.length-1)+r.targetDuration*3),i>d}beforeSeekableWindow_(e,i){return!!(e.length&&e.start(0)>0&&i<e.start(0)-this.liveRangeSafeTimeDelta)}videoUnderflow_({videoBuffered:e,audioBuffered:i,currentTime:r}){if(!e)return;let o;if(e.length&&i.length){const d=Ko(e,r-3),h=Ko(e,r),g=Ko(i,r);g.length&&!h.length&&d.length&&(o={start:d.end(0),end:g.end(0)})}else zu(e,r).length||(o=this.gapFromVideoUnderflow_(e,r));return o?(this.logger_(`Encountered a gap in video from ${o.start} to ${o.end}. Seeking to current time ${r}`),!0):!1}skipTheGap_(e){const i=this.tech_.buffered(),r=this.tech_.currentTime(),o=zu(i,r);this.resetTimeUpdate_(),!(o.length===0||r!==e)&&(this.logger_("skipTheGap_:","currentTime:",r,"scheduled currentTime:",e,"nextRange start:",o.start(0)),this.tech_.setCurrentTime(o.start(0)+Ta),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"}))}gapFromVideoUnderflow_(e,i){const r=e0(e);for(let o=0;o<r.length;o++){const d=r.start(o),h=r.end(o);if(i-d<4&&i-d>2)return{start:d,end:h}}return null}}const hg={errorInterval:30,getSource(s){const i=this.tech({IWillNotUseThisInPlugins:!0}).currentSource_||this.currentSource();return s(i)}},wf=function(s,e){let i=0,r=0;const o=Ii(hg,e);s.ready(()=>{s.trigger({type:"usage",name:"vhs-error-reload-initialized"})});const d=function(){r&&s.currentTime(r)},h=function(Y){Y!=null&&(r=s.duration()!==Infinity&&s.currentTime()||0,s.one("loadedmetadata",d),s.src(Y),s.trigger({type:"usage",name:"vhs-error-reload"}),s.play())},g=function(){if(Date.now()-i<o.errorInterval*1e3){s.trigger({type:"usage",name:"vhs-error-reload-canceled"});return}if(!o.getSource||typeof o.getSource!="function"){ze.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!");return}return i=Date.now(),o.getSource.call(s,h)},k=function(){s.off("loadedmetadata",d),s.off("error",g),s.off("dispose",k)},N=function(Y){k(),wf(s,Y)};s.on("error",g),s.on("dispose",k),s.reloadSourceOnError=N},fg=function(s){wf(this,s)};var Lf="3.7.0",pg="7.0.1",mg="1.2.2",gg="7.1.0",yg="4.0.1";const Qi={PlaylistLoader:Yo,Playlist:hr,utils:w0,STANDARD_PLAYLIST_SELECTOR:of,INITIAL_PLAYLIST_SELECTOR:pm,lastBandwidthSelector:of,movingAverageBandwidthSelector:hm,comparePlaylistBandwidth:yc,comparePlaylistResolution:cm,xhr:Bh()};Object.keys(Ln).forEach(s=>{Object.defineProperty(Qi,s,{get(){return ze.log.warn(`using Vhs.${s} is UNSAFE be sure you know what you are doing`),Ln[s]},set(e){if(ze.log.warn(`using Vhs.${s} is UNSAFE be sure you know what you are doing`),typeof e!="number"||e<0){ze.log.warn(`value of Vhs.${s} must be greater than or equal to 0`);return}Ln[s]=e}})});const kf="videojs-vhs",Df=function(s,e){const i=e.media();let r=-1;for(let o=0;o<s.length;o++)if(s[o].id===i.id){r=o;break}s.selectedIndex_=r,s.trigger({selectedIndex:r,type:"change"})},vg=function(s,e){e.representations().forEach(i=>{s.addQualityLevel(i)}),Df(s,e.playlists)};Qi.canPlaySource=function(){return ze.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")};const Ag=(s,e,i)=>{if(!s)return s;let r={};e&&e.attributes&&e.attributes.CODECS&&(r=Qu(wt(e.attributes.CODECS))),i&&i.attributes&&i.attributes.CODECS&&(r.audio=i.attributes.CODECS);const o=bt(r.video),d=bt(r.audio),h={};for(const g in s)h[g]={},d&&(h[g].audioContentType=d),o&&(h[g].videoContentType=o),e.contentProtection&&e.contentProtection[g]&&e.contentProtection[g].pssh&&(h[g].pssh=e.contentProtection[g].pssh),typeof s[g]=="string"&&(h[g].url=s[g]);return Ii(s,h)},bg=(s,e)=>s.reduce((i,r)=>{if(!r.contentProtection)return i;const o=e.reduce((d,h)=>{const g=r.contentProtection[h];return g&&g.pssh&&(d[h]={pssh:g.pssh}),d},{});return Object.keys(o).length&&i.push(o),i},[]),_g=({player:s,sourceKeySystems:e,audioMedia:i,mainPlaylists:r})=>{if(!s.eme.initializeMediaKeys)return Promise.resolve();const o=i?r.concat([i]):r,d=bg(o,Object.keys(e)),h=[],g=[];return d.forEach(k=>{g.push(new Promise((N,Y)=>{s.tech_.one("keysessioncreated",N)})),h.push(new Promise((N,Y)=>{s.eme.initializeMediaKeys({keySystems:k},me=>{if(me){Y(me);return}N()})}))}),Promise.race([Promise.all(h),Promise.race(g)])},xg=({player:s,sourceKeySystems:e,media:i,audioMedia:r})=>{const o=Ag(e,i,r);return o?(s.currentSource().keySystems=o,o&&!s.eme?(ze.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),!1):!0):!1},If=()=>{if(!ae().localStorage)return null;const s=ae().localStorage.getItem(kf);if(!s)return null;try{return JSON.parse(s)}catch(e){return null}},Eg=s=>{if(!ae().localStorage)return!1;let e=If();e=e?Ii(e,s):s;try{ae().localStorage.setItem(kf,JSON.stringify(e))}catch(i){return!1}return e},Tg=s=>s.toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")===0?JSON.parse(s.substring(s.indexOf(",")+1)):s,Rf=(s,e)=>{s._requestCallbackSet||(s._requestCallbackSet=new Set),s._requestCallbackSet.add(e)},Of=(s,e)=>{s._responseCallbackSet||(s._responseCallbackSet=new Set),s._responseCallbackSet.add(e)},Pf=(s,e)=>{!s._requestCallbackSet||(s._requestCallbackSet.delete(e),s._requestCallbackSet.size||delete s._requestCallbackSet)},Bf=(s,e)=>{!s._responseCallbackSet||(s._responseCallbackSet.delete(e),s._responseCallbackSet.size||delete s._responseCallbackSet)};Qi.supportsNativeHls=function(){if(!_e()||!_e().createElement)return!1;const s=_e().createElement("video");return ze.getTech("Html5").isSupported()?["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(i){return/maybe|probably/i.test(s.canPlayType(i))}):!1}(),Qi.supportsNativeDash=function(){return!_e()||!_e().createElement||!ze.getTech("Html5").isSupported()?!1:/maybe|probably/i.test(_e().createElement("video").canPlayType("application/dash+xml"))}(),Qi.supportsTypeNatively=s=>s==="hls"?Qi.supportsNativeHls:s==="dash"?Qi.supportsNativeDash:!1,Qi.isSupported=function(){return ze.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")},Qi.xhr.onRequest=function(s){Rf(Qi.xhr,s)},Qi.xhr.onResponse=function(s){Of(Qi.xhr,s)},Qi.xhr.offRequest=function(s){Pf(Qi.xhr,s)},Qi.xhr.offResponse=function(s){Bf(Qi.xhr,s)};const Sg=ze.getComponent("Component");class Mf extends Sg{constructor(e,i,r){super(i,r.vhs);if(typeof r.initialBandwidth=="number"&&(this.options_.bandwidth=r.initialBandwidth),this.logger_=Vr("VhsHandler"),i.options_&&i.options_.playerId){const o=ze.getPlayer(i.options_.playerId);this.player_=o}if(this.tech_=i,this.source_=e,this.stats={},this.ignoreNextSeekingEvent_=!1,this.setOptions_(),this.options_.overrideNative&&i.overrideNativeAudioTracks&&i.overrideNativeVideoTracks)i.overrideNativeAudioTracks(!0),i.overrideNativeVideoTracks(!0);else if(this.options_.overrideNative&&(i.featuresNativeVideoTracks||i.featuresNativeAudioTracks))throw new Error("Overriding native VHS requires emulated tracks. See https://git.io/vMpjB");this.on(_e(),["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],o=>{const d=_e().fullscreenElement||_e().webkitFullscreenElement||_e().mozFullScreenElement||_e().msFullscreenElement;d&&d.contains(this.tech_.el())?this.playlistController_.fastQualityChange_():this.playlistController_.checkABR_()}),this.on(this.tech_,"seeking",function(){if(this.ignoreNextSeekingEvent_){this.ignoreNextSeekingEvent_=!1;return}this.setCurrentTime(this.tech_.currentTime())}),this.on(this.tech_,"error",function(){this.tech_.error()&&this.playlistController_&&this.playlistController_.pauseLoading()}),this.on(this.tech_,"play",this.play)}setOptions_(){if(this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions!==!1,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.useBandwidthFromLocalStorage=typeof this.source_.useBandwidthFromLocalStorage!="undefined"?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.useForcedSubtitles=this.options_.useForcedSubtitles||!1,this.options_.useNetworkInformationApi=this.options_.useNetworkInformationApi||!1,this.options_.useDtsForTimestampOffset=this.options_.useDtsForTimestampOffset||!1,this.options_.calculateTimestampOffsetForEachSegment=this.options_.calculateTimestampOffsetForEachSegment||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,this.options_.llhls=this.options_.llhls!==!1,this.options_.bufferBasedABR=this.options_.bufferBasedABR||!1,typeof this.options_.playlistExclusionDuration!="number"&&(this.options_.playlistExclusionDuration=60),typeof this.options_.bandwidth!="number"&&this.options_.useBandwidthFromLocalStorage){const e=If();e&&e.bandwidth&&(this.options_.bandwidth=e.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"})),e&&e.throughput&&(this.options_.throughput=e.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"}))}typeof this.options_.bandwidth!="number"&&(this.options_.bandwidth=Ln.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===Ln.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","limitRenditionByPlayerDimensions","bandwidth","customTagParsers","customTagMappers","cacheEncryptionKeys","playlistSelector","initialPlaylistSelector","bufferBasedABR","liveRangeSafeTimeDelta","llhls","useForcedSubtitles","useNetworkInformationApi","useDtsForTimestampOffset","calculateTimestampOffsetForEachSegment","exactManifestTimings","leastPixelDiffSelector"].forEach(e=>{typeof this.source_[e]!="undefined"&&(this.options_[e]=this.source_[e])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio}src(e,i){if(!e)return;this.setOptions_(),this.options_.src=Tg(this.source_.src),this.options_.tech=this.tech_,this.options_.externVhs=Qi,this.options_.sourceType=Qt(i),this.options_.seekTo=d=>{this.tech_.setCurrentTime(d)},this.playlistController_=new og(this.options_);const r=Ii({liveRangeSafeTimeDelta:Cs},this.options_,{seekable:()=>this.seekable(),media:()=>this.playlistController_.media(),playlistController:this.playlistController_});this.playbackWatcher_=new cg(r),this.playlistController_.on("error",()=>{const d=ze.players[this.tech_.options_.playerId];let h=this.playlistController_.error;typeof h=="object"&&!h.code?h.code=3:typeof h=="string"&&(h={message:h,code:3}),d.error(h)});const o=this.options_.bufferBasedABR?Qi.movingAverageBandwidthSelector(.55):Qi.STANDARD_PLAYLIST_SELECTOR;this.playlistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):o.bind(this),this.playlistController_.selectInitialPlaylist=Qi.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.playlistController_.mainPlaylistLoader_,this.mediaSource=this.playlistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get(){return this.playlistController_.selectPlaylist},set(d){this.playlistController_.selectPlaylist=d.bind(this)}},throughput:{get(){return this.playlistController_.mainSegmentLoader_.throughput.rate},set(d){this.playlistController_.mainSegmentLoader_.throughput.rate=d,this.playlistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get(){let d=this.playlistController_.mainSegmentLoader_.bandwidth;const h=ae().navigator.connection||ae().navigator.mozConnection||ae().navigator.webkitConnection,g=1e7;if(this.options_.useNetworkInformationApi&&h){const k=h.downlink*1e3*1e3;k>=g&&d>=g?d=Math.max(d,k):d=k}return d},set(d){this.playlistController_.mainSegmentLoader_.bandwidth=d,this.playlistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get(){const d=1/(this.bandwidth||1);let h;return this.throughput>0?h=1/this.throughput:h=0,Math.floor(1/(d+h))},set(){ze.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:()=>this.bandwidth||0,enumerable:!0},mediaRequests:{get:()=>this.playlistController_.mediaRequests_()||0,enumerable:!0},mediaRequestsAborted:{get:()=>this.playlistController_.mediaRequestsAborted_()||0,enumerable:!0},mediaRequestsTimedout:{get:()=>this.playlistController_.mediaRequestsTimedout_()||0,enumerable:!0},mediaRequestsErrored:{get:()=>this.playlistController_.mediaRequestsErrored_()||0,enumerable:!0},mediaTransferDuration:{get:()=>this.playlistController_.mediaTransferDuration_()||0,enumerable:!0},mediaBytesTransferred:{get:()=>this.playlistController_.mediaBytesTransferred_()||0,enumerable:!0},mediaSecondsLoaded:{get:()=>this.playlistController_.mediaSecondsLoaded_()||0,enumerable:!0},mediaAppends:{get:()=>this.playlistController_.mediaAppends_()||0,enumerable:!0},mainAppendsToLoadedData:{get:()=>this.playlistController_.mainAppendsToLoadedData_()||0,enumerable:!0},audioAppendsToLoadedData:{get:()=>this.playlistController_.audioAppendsToLoadedData_()||0,enumerable:!0},appendsToLoadedData:{get:()=>this.playlistController_.appendsToLoadedData_()||0,enumerable:!0},timeToLoadedData:{get:()=>this.playlistController_.timeToLoadedData_()||0,enumerable:!0},buffered:{get:()=>eo(this.tech_.buffered()),enumerable:!0},currentTime:{get:()=>this.tech_.currentTime(),enumerable:!0},currentSource:{get:()=>this.tech_.currentSource_,enumerable:!0},currentTech:{get:()=>this.tech_.name_,enumerable:!0},duration:{get:()=>this.tech_.duration(),enumerable:!0},main:{get:()=>this.playlists.main,enumerable:!0},playerDimensions:{get:()=>this.tech_.currentDimensions(),enumerable:!0},seekable:{get:()=>eo(this.tech_.seekable()),enumerable:!0},timestamp:{get:()=>Date.now(),enumerable:!0},videoPlaybackQuality:{get:()=>this.tech_.getVideoPlaybackQuality(),enumerable:!0}}),this.tech_.one("canplay",this.playlistController_.setupFirstPlay.bind(this.playlistController_)),this.tech_.on("bandwidthupdate",()=>{this.options_.useBandwidthFromLocalStorage&&Eg({bandwidth:this.bandwidth,throughput:Math.round(this.throughput)})}),this.playlistController_.on("selectedinitialmedia",()=>{dg(this)}),this.playlistController_.sourceUpdater_.on("createdsourcebuffers",()=>{this.setupEme_()}),this.on(this.playlistController_,"progress",function(){this.tech_.trigger("progress")}),this.on(this.playlistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.setupQualityLevels_(),!!this.tech_.el()&&(this.mediaSourceUrl_=ae().URL.createObjectURL(this.playlistController_.mediaSource),this.tech_.src(this.mediaSourceUrl_))}createKeySessions_(){const e=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader;this.logger_("waiting for EME key session creation"),_g({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:e&&e.media(),mainPlaylists:this.playlists.main.playlists}).then(()=>{this.logger_("created EME key session"),this.playlistController_.sourceUpdater_.initializedEme()}).catch(i=>{this.logger_("error while creating EME key session",i),this.player_.error({message:"Failed to initialize media keys for EME",code:3})})}handleWaitingForKey_(){this.logger_("waitingforkey fired, attempting to create any new key sessions"),this.createKeySessions_()}setupEme_(){const e=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader,i=xg({player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:e&&e.media()});if(this.player_.tech_.on("keystatuschange",r=>{if(r.status!=="output-restricted")return;const o=this.playlistController_.main();if(!o||!o.playlists)return;const d=[];o.playlists.forEach(h=>{h&&h.attributes&&h.attributes.RESOLUTION&&h.attributes.RESOLUTION.height>=720&&(!h.excludeUntil||h.excludeUntil<Infinity)&&(h.excludeUntil=Infinity,d.push(h))}),d.length&&(ze.log.warn('DRM keystatus changed to "output-restricted." Removing the following HD playlists that will most likely fail to play and clearing the buffer. This may be due to HDCP restrictions on the stream and the capabilities of the current device.',...d),this.playlistController_.mainSegmentLoader_.resetEverything(),this.playlistController_.fastQualityChange_())}),this.handleWaitingForKey_=this.handleWaitingForKey_.bind(this),this.player_.tech_.on("waitingforkey",this.handleWaitingForKey_),!i){this.playlistController_.sourceUpdater_.initializedEme();return}this.createKeySessions_()}setupQualityLevels_(){const e=ze.players[this.tech_.options_.playerId];!e||!e.qualityLevels||this.qualityLevels_||(this.qualityLevels_=e.qualityLevels(),this.playlistController_.on("selectedinitialmedia",()=>{vg(this.qualityLevels_,this)}),this.playlists.on("mediachange",()=>{Df(this.qualityLevels_,this.playlists)}))}static version(){return{"@videojs/http-streaming":Lf,"mux.js":pg,"mpd-parser":mg,"m3u8-parser":gg,"aes-decrypter":yg}}version(){return this.constructor.version()}canChangeType(){return vf.canChangeType()}play(){this.playlistController_.play()}setCurrentTime(e){this.playlistController_.setCurrentTime(e)}duration(){return this.playlistController_.duration()}seekable(){return this.playlistController_.seekable()}dispose(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.playlistController_&&this.playlistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.mediaSourceUrl_&&ae().URL.revokeObjectURL&&(ae().URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),this.tech_&&this.tech_.off("waitingforkey",this.handleWaitingForKey_),super.dispose()}convertToProgramTime(e,i){return P0({playlist:this.playlistController_.media(),time:e,callback:i})}seekToProgramTime(e,i,r=!0,o=2){return jh({programTime:e,playlist:this.playlistController_.media(),retryCount:o,pauseAfterSeek:r,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:i})}setupXhrHooks_(){this.xhr.onRequest=e=>{Rf(this.xhr,e)},this.xhr.onResponse=e=>{Of(this.xhr,e)},this.xhr.offRequest=e=>{Pf(this.xhr,e)},this.xhr.offResponse=e=>{Bf(this.xhr,e)},this.player_.trigger("xhr-hooks-ready")}}const id={name:"videojs-http-streaming",VERSION:Lf,canHandleSource(s,e={}){const i=Ii(ze.options,e);return id.canPlayType(s.type,i)},handleSource(s,e,i={}){const r=Ii(ze.options,i);return e.vhs=new Mf(s,e,r),e.vhs.xhr=Bh(),e.vhs.setupXhrHooks_(),e.vhs.src(s.src,s.type),e.vhs},canPlayType(s,e){const i=Qt(s);if(!i)return"";const r=id.getOverrideNative(e);return!Qi.supportsTypeNatively(i)||r?"maybe":""},getOverrideNative(s={}){const{vhs:e={}}=s,i=!(ze.browser.IS_ANY_SAFARI||ze.browser.IS_IOS),{overrideNative:r=i}=e;return r}};(()=>Vt("avc1.4d400d,mp4a.40.2"))()&&ze.getTech("Html5").registerSourceHandler(id,0),ze.VhsHandler=Mf,ze.VhsSourceHandler=id,ze.Vhs=Qi,ze.use||ze.registerComponent("Vhs",Qi),ze.options.vhs=ze.options.vhs||{},(!ze.getPlugin||!ze.getPlugin("reloadSourceOnError"))&&ze.registerPlugin("reloadSourceOnError",fg)},35539:function(Kt,Mt,ft){"use strict";var lt=ft(49925),ae=ft(42827),Ze=ft.n(ae);const _e=lt.Z.getTech("Html5"),tt=lt.Z.mergeOptions||lt.Z.util.mergeOptions,fe={mediaDataSource:{},config:{}};class Ee extends _e{constructor(te,Q){te=tt(fe,te),super(te,Q)}setSrc(te){this.flvPlayer&&(this.flvPlayer.detachMediaElement(),this.flvPlayer.destroy());const Q=this.options_.mediaDataSource,w=this.options_.config;Q.type=Q.type===void 0?"flv":Q.type,Q.url=te,this.flvPlayer=Ze().createPlayer(Q,w),this.flvPlayer.attachMediaElement(this.el_),this.flvPlayer.load()}dispose(){this.flvPlayer&&(this.flvPlayer.detachMediaElement(),this.flvPlayer.destroy()),super.dispose()}}Ee.isSupported=function(){return Ze()&&Ze().isSupported()},Ee.formats={"video/flv":"FLV","video/x-flv":"FLV"},Ee.canPlayType=function(se){return Ee.isSupported()&&se in Ee.formats?"maybe":""},Ee.canPlaySource=function(se,te){return Ee.canPlayType(se.type)},Ee.VERSION="__VERSION__",lt.Z.registerTech("Flvjs",Ee);var ye=null},69473:function(Kt,Mt,ft){var lt=ft(60288),ae=Kt.exports={WebVTT:ft(59846),VTTCue:ft(63406),VTTRegion:ft(58917)};lt.vttjs=ae,lt.WebVTT=ae.WebVTT;var Ze=ae.VTTCue,_e=ae.VTTRegion,tt=lt.VTTCue,fe=lt.VTTRegion;ae.shim=function(){lt.VTTCue=Ze,lt.VTTRegion=_e},ae.restore=function(){lt.VTTCue=tt,lt.VTTRegion=fe},lt.VTTCue||ae.shim()},59846:function(Kt,Mt,ft){var lt=ft(70915),ae=Object.create||function(){function F(){}return function(K){if(arguments.length!==1)throw new Error("Object.create shim only accepts one parameter.");return F.prototype=K,new F}}();function Ze(F,K){this.name="ParsingError",this.code=F.code,this.message=K||F.message}Ze.prototype=ae(Error.prototype),Ze.prototype.constructor=Ze,Ze.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};function _e(F){function K(de,ve,De,Se){return(de|0)*3600+(ve|0)*60+(De|0)+(Se|0)/1e3}var ne=F.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return ne?ne[3]?K(ne[1],ne[2],ne[3].replace(":",""),ne[4]):ne[1]>59?K(ne[1],ne[2],0,ne[4]):K(0,ne[1],ne[2],ne[4]):null}function tt(){this.values=ae(null)}tt.prototype={set:function(F,K){!this.get(F)&&K!==""&&(this.values[F]=K)},get:function(F,K,ne){return ne?this.has(F)?this.values[F]:K[ne]:this.has(F)?this.values[F]:K},has:function(F){return F in this.values},alt:function(F,K,ne){for(var de=0;de<ne.length;++de)if(K===ne[de]){this.set(F,K);break}},integer:function(F,K){/^-?\d+$/.test(K)&&this.set(F,parseInt(K,10))},percent:function(F,K){var ne;return(ne=K.match(/^([\d]{1,3})(\.[\d]*)?%$/))&&(K=parseFloat(K),K>=0&&K<=100)?(this.set(F,K),!0):!1}};function fe(F,K,ne,de){var ve=de?F.split(de):[F];for(var De in ve)if(typeof ve[De]=="string"){var Se=ve[De].split(ne);if(Se.length===2){var Ce=Se[0].trim(),Be=Se[1].trim();K(Ce,Be)}}}function Ee(F,K,ne){var de=F;function ve(){var Ce=_e(F);if(Ce===null)throw new Ze(Ze.Errors.BadTimeStamp,"Malformed timestamp: "+de);return F=F.replace(/^[^\sa-zA-Z-]+/,""),Ce}function De(Ce,Be){var ke=new tt;fe(Ce,function(Ne,Re){switch(Ne){case"region":for(var dt=ne.length-1;dt>=0;dt--)if(ne[dt].id===Re){ke.set(Ne,ne[dt].region);break}break;case"vertical":ke.alt(Ne,Re,["rl","lr"]);break;case"line":var wt=Re.split(","),It=wt[0];ke.integer(Ne,It),ke.percent(Ne,It)&&ke.set("snapToLines",!1),ke.alt(Ne,It,["auto"]),wt.length===2&&ke.alt("lineAlign",wt[1],["start","center","end"]);break;case"position":wt=Re.split(","),ke.percent(Ne,wt[0]),wt.length===2&&ke.alt("positionAlign",wt[1],["start","center","end"]);break;case"size":ke.percent(Ne,Re);break;case"align":ke.alt(Ne,Re,["start","center","end","left","right"]);break}},/:/,/\s/),Be.region=ke.get("region",null),Be.vertical=ke.get("vertical","");try{Be.line=ke.get("line","auto")}catch(Ne){}Be.lineAlign=ke.get("lineAlign","start"),Be.snapToLines=ke.get("snapToLines",!0),Be.size=ke.get("size",100);try{Be.align=ke.get("align","center")}catch(Ne){Be.align=ke.get("align","middle")}try{Be.position=ke.get("position","auto")}catch(Ne){Be.position=ke.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},Be.align)}Be.positionAlign=ke.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},Be.align)}function Se(){F=F.replace(/^\s+/,"")}if(Se(),K.startTime=ve(),Se(),F.substr(0,3)!=="-->")throw new Ze(Ze.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+de);F=F.substr(3),Se(),K.endTime=ve(),Se(),De(F,K)}var ye=lt.createElement&&lt.createElement("textarea"),se={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},te={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},Q={v:"title",lang:"lang"},w={rt:"ruby"};function y(F,K){function ne(){if(!K)return null;function It(ot){return K=K.substr(ot.length),ot}var nt=K.match(/^([^<]*)(<[^>]*>?)?/);return It(nt[1]?nt[1]:nt[2])}function de(It){return ye.innerHTML=It,It=ye.textContent,ye.textContent="",It}function ve(It,nt){return!w[nt.localName]||w[nt.localName]===It.localName}function De(It,nt){var ot=se[It];if(!ot)return null;var ti=F.document.createElement(ot),bt=Q[It];return bt&&nt&&(ti[bt]=nt.trim()),ti}for(var Se=F.document.createElement("div"),Ce=Se,Be,ke=[];(Be=ne())!==null;){if(Be[0]==="<"){if(Be[1]==="/"){ke.length&&ke[ke.length-1]===Be.substr(2).replace(">","")&&(ke.pop(),Ce=Ce.parentNode);continue}var Ne=_e(Be.substr(1,Be.length-2)),Re;if(Ne){Re=F.document.createProcessingInstruction("timestamp",Ne),Ce.appendChild(Re);continue}var dt=Be.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!dt||(Re=De(dt[1],dt[3]),!Re)||!ve(Ce,Re))continue;if(dt[2]){var wt=dt[2].split(".");wt.forEach(function(It){var nt=/^bg_/.test(It),ot=nt?It.slice(3):It;if(te.hasOwnProperty(ot)){var ti=nt?"background-color":"color",bt=te[ot];Re.style[ti]=bt}}),Re.className=wt.join(" ")}ke.push(dt[1]),Ce.appendChild(Re),Ce=Re;continue}Ce.appendChild(F.document.createTextNode(de(Be)))}return Se}var $=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function D(F){for(var K=0;K<$.length;K++){var ne=$[K];if(F>=ne[0]&&F<=ne[1])return!0}return!1}function G(F){var K=[],ne="",de;if(!F||!F.childNodes)return"ltr";function ve(Ce,Be){for(var ke=Be.childNodes.length-1;ke>=0;ke--)Ce.push(Be.childNodes[ke])}function De(Ce){if(!Ce||!Ce.length)return null;var Be=Ce.pop(),ke=Be.textContent||Be.innerText;if(ke){var Ne=ke.match(/^.*(\n|\r)/);return Ne?(Ce.length=0,Ne[0]):ke}if(Be.tagName==="ruby")return De(Ce);if(Be.childNodes)return ve(Ce,Be),De(Ce)}for(ve(K,F);ne=De(K);)for(var Se=0;Se<ne.length;Se++)if(de=ne.charCodeAt(Se),D(de))return"rtl";return"ltr"}function z(F){if(typeof F.line=="number"&&(F.snapToLines||F.line>=0&&F.line<=100))return F.line;if(!F.track||!F.track.textTrackList||!F.track.textTrackList.mediaElement)return-1;for(var K=F.track,ne=K.textTrackList,de=0,ve=0;ve<ne.length&&ne[ve]!==K;ve++)ne[ve].mode==="showing"&&de++;return++de*-1}function P(){}P.prototype.applyStyles=function(F,K){K=K||this.div;for(var ne in F)F.hasOwnProperty(ne)&&(K.style[ne]=F[ne])},P.prototype.formatStyle=function(F,K){return F===0?0:F+K};function H(F,K,ne){P.call(this),this.cue=K,this.cueDiv=y(F,K.text);var de={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:K.vertical===""?"horizontal-tb":K.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(de,this.cueDiv),this.div=F.document.createElement("div"),de={direction:G(this.cueDiv),writingMode:K.vertical===""?"horizontal-tb":K.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:K.align==="middle"?"center":K.align,font:ne.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(de),this.div.appendChild(this.cueDiv);var ve=0;switch(K.positionAlign){case"start":case"line-left":ve=K.position;break;case"center":ve=K.position-K.size/2;break;case"end":case"line-right":ve=K.position-K.size;break}K.vertical===""?this.applyStyles({left:this.formatStyle(ve,"%"),width:this.formatStyle(K.size,"%")}):this.applyStyles({top:this.formatStyle(ve,"%"),height:this.formatStyle(K.size,"%")}),this.move=function(De){this.applyStyles({top:this.formatStyle(De.top,"px"),bottom:this.formatStyle(De.bottom,"px"),left:this.formatStyle(De.left,"px"),right:this.formatStyle(De.right,"px"),height:this.formatStyle(De.height,"px"),width:this.formatStyle(De.width,"px")})}}H.prototype=ae(P.prototype),H.prototype.constructor=H;function j(F){var K,ne,de,ve;if(F.div){ne=F.div.offsetHeight,de=F.div.offsetWidth,ve=F.div.offsetTop;var De=(De=F.div.childNodes)&&(De=De[0])&&De.getClientRects&&De.getClientRects();F=F.div.getBoundingClientRect(),K=De?Math.max(De[0]&&De[0].height||0,F.height/De.length):0}this.left=F.left,this.right=F.right,this.top=F.top||ve,this.height=F.height||ne,this.bottom=F.bottom||ve+(F.height||ne),this.width=F.width||de,this.lineHeight=K!==void 0?K:F.lineHeight}j.prototype.move=function(F,K){switch(K=K!==void 0?K:this.lineHeight,F){case"+x":this.left+=K,this.right+=K;break;case"-x":this.left-=K,this.right-=K;break;case"+y":this.top+=K,this.bottom+=K;break;case"-y":this.top-=K,this.bottom-=K;break}},j.prototype.overlaps=function(F){return this.left<F.right&&this.right>F.left&&this.top<F.bottom&&this.bottom>F.top},j.prototype.overlapsAny=function(F){for(var K=0;K<F.length;K++)if(this.overlaps(F[K]))return!0;return!1},j.prototype.within=function(F){return this.top>=F.top&&this.bottom<=F.bottom&&this.left>=F.left&&this.right<=F.right},j.prototype.overlapsOppositeAxis=function(F,K){switch(K){case"+x":return this.left<F.left;case"-x":return this.right>F.right;case"+y":return this.top<F.top;case"-y":return this.bottom>F.bottom}},j.prototype.intersectPercentage=function(F){var K=Math.max(0,Math.min(this.right,F.right)-Math.max(this.left,F.left)),ne=Math.max(0,Math.min(this.bottom,F.bottom)-Math.max(this.top,F.top)),de=K*ne;return de/(this.height*this.width)},j.prototype.toCSSCompatValues=function(F){return{top:this.top-F.top,bottom:F.bottom-this.bottom,left:this.left-F.left,right:F.right-this.right,height:this.height,width:this.width}},j.getSimpleBoxPosition=function(F){var K=F.div?F.div.offsetHeight:F.tagName?F.offsetHeight:0,ne=F.div?F.div.offsetWidth:F.tagName?F.offsetWidth:0,de=F.div?F.div.offsetTop:F.tagName?F.offsetTop:0;F=F.div?F.div.getBoundingClientRect():F.tagName?F.getBoundingClientRect():F;var ve={left:F.left,right:F.right,top:F.top||de,height:F.height||K,bottom:F.bottom||de+(F.height||K),width:F.width||ne};return ve};function V(F,K,ne,de){function ve(ot,ti){for(var bt,Vt=new j(ot),si=1,Xt=0;Xt<ti.length;Xt++){for(;ot.overlapsOppositeAxis(ne,ti[Xt])||ot.within(ne)&&ot.overlapsAny(de);)ot.move(ti[Xt]);if(ot.within(ne))return ot;var _i=ot.intersectPercentage(ne);si>_i&&(bt=new j(ot),si=_i),ot=new j(Vt)}return bt||Vt}var De=new j(K),Se=K.cue,Ce=z(Se),Be=[];if(Se.snapToLines){var ke;switch(Se.vertical){case"":Be=["+y","-y"],ke="height";break;case"rl":Be=["+x","-x"],ke="width";break;case"lr":Be=["-x","+x"],ke="width";break}var Ne=De.lineHeight,Re=Ne*Math.round(Ce),dt=ne[ke]+Ne,wt=Be[0];Math.abs(Re)>dt&&(Re=Re<0?-1:1,Re*=Math.ceil(dt/Ne)*Ne),Ce<0&&(Re+=Se.vertical===""?ne.height:ne.width,Be=Be.reverse()),De.move(wt,Re)}else{var It=De.lineHeight/ne.height*100;switch(Se.lineAlign){case"center":Ce-=It/2;break;case"end":Ce-=It;break}switch(Se.vertical){case"":K.applyStyles({top:K.formatStyle(Ce,"%")});break;case"rl":K.applyStyles({left:K.formatStyle(Ce,"%")});break;case"lr":K.applyStyles({right:K.formatStyle(Ce,"%")});break}Be=["+y","-x","+x","-y"],De=new j(K)}var nt=ve(De,Be);K.move(nt.toCSSCompatValues(ne))}function T(){}T.StringDecoder=function(){return{decode:function(F){if(!F)return"";if(typeof F!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(F))}}},T.convertCueToDOMTree=function(F,K){return!F||!K?null:y(F,K)};var Z=.05,ie="sans-serif",le="1.5%";T.processCues=function(F,K,ne){if(!F||!K||!ne)return null;for(;ne.firstChild;)ne.removeChild(ne.firstChild);var de=F.document.createElement("div");de.style.position="absolute",de.style.left="0",de.style.right="0",de.style.top="0",de.style.bottom="0",de.style.margin=le,ne.appendChild(de);function ve(Ne){for(var Re=0;Re<Ne.length;Re++)if(Ne[Re].hasBeenReset||!Ne[Re].displayState)return!0;return!1}if(!ve(K)){for(var De=0;De<K.length;De++)de.appendChild(K[De].displayState);return}var Se=[],Ce=j.getSimpleBoxPosition(de),Be=Math.round(Ce.height*Z*100)/100,ke={font:Be+"px "+ie};(function(){for(var Ne,Re,dt=0;dt<K.length;dt++)Re=K[dt],Ne=new H(F,Re,ke),de.appendChild(Ne.div),V(F,Ne,Ce,Se),Re.displayState=Ne.div,Se.push(j.getSimpleBoxPosition(Ne))})()},T.Parser=function(F,K,ne){ne||(ne=K,K={}),K||(K={}),this.window=F,this.vttjs=K,this.state="INITIAL",this.buffer="",this.decoder=ne||new TextDecoder("utf8"),this.regionList=[]},T.Parser.prototype={reportOrThrowError:function(F){if(F instanceof Ze)this.onparsingerror&&this.onparsingerror(F);else throw F},parse:function(F){var K=this;F&&(K.buffer+=K.decoder.decode(F,{stream:!0}));function ne(){for(var Ne=K.buffer,Re=0;Re<Ne.length&&Ne[Re]!=="\r"&&Ne[Re]!==`
`;)++Re;var dt=Ne.substr(0,Re);return Ne[Re]==="\r"&&++Re,Ne[Re]===`
`&&++Re,K.buffer=Ne.substr(Re),dt}function de(Ne){var Re=new tt;if(fe(Ne,function(wt,It){switch(wt){case"id":Re.set(wt,It);break;case"width":Re.percent(wt,It);break;case"lines":Re.integer(wt,It);break;case"regionanchor":case"viewportanchor":var nt=It.split(",");if(nt.length!==2)break;var ot=new tt;if(ot.percent("x",nt[0]),ot.percent("y",nt[1]),!ot.has("x")||!ot.has("y"))break;Re.set(wt+"X",ot.get("x")),Re.set(wt+"Y",ot.get("y"));break;case"scroll":Re.alt(wt,It,["up"]);break}},/=/,/\s/),Re.has("id")){var dt=new(K.vttjs.VTTRegion||K.window.VTTRegion);dt.width=Re.get("width",100),dt.lines=Re.get("lines",3),dt.regionAnchorX=Re.get("regionanchorX",0),dt.regionAnchorY=Re.get("regionanchorY",100),dt.viewportAnchorX=Re.get("viewportanchorX",0),dt.viewportAnchorY=Re.get("viewportanchorY",100),dt.scroll=Re.get("scroll",""),K.onregion&&K.onregion(dt),K.regionList.push({id:Re.get("id"),region:dt})}}function ve(Ne){var Re=new tt;fe(Ne,function(dt,wt){switch(dt){case"MPEGT":Re.integer(dt+"S",wt);break;case"LOCA":Re.set(dt+"L",_e(wt));break}},/[^\d]:/,/,/),K.ontimestampmap&&K.ontimestampmap({MPEGTS:Re.get("MPEGTS"),LOCAL:Re.get("LOCAL")})}function De(Ne){Ne.match(/X-TIMESTAMP-MAP/)?fe(Ne,function(Re,dt){switch(Re){case"X-TIMESTAMP-MAP":ve(dt);break}},/=/):fe(Ne,function(Re,dt){switch(Re){case"Region":de(dt);break}},/:/)}try{var Se;if(K.state==="INITIAL"){if(!/\r\n|\n/.test(K.buffer))return this;Se=ne();var Ce=Se.match(/^WEBVTT([ \t].*)?$/);if(!Ce||!Ce[0])throw new Ze(Ze.Errors.BadSignature);K.state="HEADER"}for(var Be=!1;K.buffer;){if(!/\r\n|\n/.test(K.buffer))return this;switch(Be?Be=!1:Se=ne(),K.state){case"HEADER":/:/.test(Se)?De(Se):Se||(K.state="ID");continue;case"NOTE":Se||(K.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(Se)){K.state="NOTE";break}if(!Se)continue;K.cue=new(K.vttjs.VTTCue||K.window.VTTCue)(0,0,"");try{K.cue.align="center"}catch(Ne){K.cue.align="middle"}if(K.state="CUE",Se.indexOf("-->")===-1){K.cue.id=Se;continue}case"CUE":try{Ee(Se,K.cue,K.regionList)}catch(Ne){K.reportOrThrowError(Ne),K.cue=null,K.state="BADCUE";continue}K.state="CUETEXT";continue;case"CUETEXT":var ke=Se.indexOf("-->")!==-1;if(!Se||ke&&(Be=!0)){K.oncue&&K.oncue(K.cue),K.cue=null,K.state="ID";continue}K.cue.text&&(K.cue.text+=`
`),K.cue.text+=Se.replace(/\u2028/g,`
`).replace(/u2029/g,`
`);continue;case"BADCUE":Se||(K.state="ID");continue}}}catch(Ne){K.reportOrThrowError(Ne),K.state==="CUETEXT"&&K.cue&&K.oncue&&K.oncue(K.cue),K.cue=null,K.state=K.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){var F=this;try{if(F.buffer+=F.decoder.decode(),(F.cue||F.state==="HEADER")&&(F.buffer+=`

`,F.parse()),F.state==="INITIAL")throw new Ze(Ze.Errors.BadSignature)}catch(K){F.reportOrThrowError(K)}return F.onflush&&F.onflush(),this}},Kt.exports=T},63406:function(Kt){var Mt="auto",ft={"":1,lr:1,rl:1},lt={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function ae(tt){if(typeof tt!="string")return!1;var fe=ft[tt.toLowerCase()];return fe?tt.toLowerCase():!1}function Ze(tt){if(typeof tt!="string")return!1;var fe=lt[tt.toLowerCase()];return fe?tt.toLowerCase():!1}function _e(tt,fe,Ee){this.hasBeenReset=!1;var ye="",se=!1,te=tt,Q=fe,w=Ee,y=null,$="",D=!0,G="auto",z="start",P="auto",H="auto",j=100,V="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return ye},set:function(T){ye=""+T}},pauseOnExit:{enumerable:!0,get:function(){return se},set:function(T){se=!!T}},startTime:{enumerable:!0,get:function(){return te},set:function(T){if(typeof T!="number")throw new TypeError("Start time must be set to a number.");te=T,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return Q},set:function(T){if(typeof T!="number")throw new TypeError("End time must be set to a number.");Q=T,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return w},set:function(T){w=""+T,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return y},set:function(T){y=T,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return $},set:function(T){var Z=ae(T);if(Z===!1)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");$=Z,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return D},set:function(T){D=!!T,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return G},set:function(T){if(typeof T!="number"&&T!==Mt)throw new SyntaxError("Line: an invalid number or illegal string was specified.");G=T,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return z},set:function(T){var Z=Ze(T);Z?(z=Z,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return P},set:function(T){if(T<0||T>100)throw new Error("Position must be between 0 and 100.");P=T,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return H},set:function(T){var Z=Ze(T);Z?(H=Z,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return j},set:function(T){if(T<0||T>100)throw new Error("Size must be between 0 and 100.");j=T,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return V},set:function(T){var Z=Ze(T);if(!Z)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");V=Z,this.hasBeenReset=!0}}}),this.displayState=void 0}_e.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},Kt.exports=_e},58917:function(Kt){var Mt={"":!0,up:!0};function ft(Ze){if(typeof Ze!="string")return!1;var _e=Mt[Ze.toLowerCase()];return _e?Ze.toLowerCase():!1}function lt(Ze){return typeof Ze=="number"&&Ze>=0&&Ze<=100}function ae(){var Ze=100,_e=3,tt=0,fe=100,Ee=0,ye=100,se="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return Ze},set:function(te){if(!lt(te))throw new Error("Width must be between 0 and 100.");Ze=te}},lines:{enumerable:!0,get:function(){return _e},set:function(te){if(typeof te!="number")throw new TypeError("Lines must be set to a number.");_e=te}},regionAnchorY:{enumerable:!0,get:function(){return fe},set:function(te){if(!lt(te))throw new Error("RegionAnchorX must be between 0 and 100.");fe=te}},regionAnchorX:{enumerable:!0,get:function(){return tt},set:function(te){if(!lt(te))throw new Error("RegionAnchorY must be between 0 and 100.");tt=te}},viewportAnchorY:{enumerable:!0,get:function(){return ye},set:function(te){if(!lt(te))throw new Error("ViewportAnchorY must be between 0 and 100.");ye=te}},viewportAnchorX:{enumerable:!0,get:function(){return Ee},set:function(te){if(!lt(te))throw new Error("ViewportAnchorX must be between 0 and 100.");Ee=te}},scroll:{enumerable:!0,get:function(){return se},set:function(te){var Q=ft(te);Q===!1?console.warn("Scroll: an invalid or illegal string was specified."):se=Q}}})}Kt.exports=ae}}]);
