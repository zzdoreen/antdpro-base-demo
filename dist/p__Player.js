(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[131],{29732:function(x,P,n){"use strict";n.r(P),n.d(P,{default:function(){return Y}});var m=n(86582),j=n(2824),s=n(67294),L=n(68630),R=n.n(L);function M(e,a){if(e===a)return!0;for(var r=0;r<e.length;r++)if(!Object.is(e[r],a[r]))return!1;return!0}function C(e,a){var r=(0,s.useRef)({deps:a,obj:void 0,initialized:!1}).current;return(r.initialized===!1||!M(r.deps,a))&&(r.deps=a,r.obj=e(),r.initialized=!0),r.obj}var A=n(65353),S=function(){var e=(0,A.__read)((0,s.useState)({}),2),a=e[1];return(0,s.useCallback)(function(){return a({})},[])},$=S,b=new WeakMap,k=new WeakMap;function p(e,a){var r=b.get(e);if(r)return r;if(k.has(e))return e;var O=new Proxy(e,{get:function(h,i,f){var d=Reflect.get(h,i,f);return R()(d)||Array.isArray(d)?p(d,a):d},set:function(h,i,f){var d=Reflect.set(h,i,f);return a(),d},deleteProperty:function(h,i){var f=Reflect.deleteProperty(h,i);return a(),f}});return b.set(e,O),k.set(O,e),O}function z(e){var a=$(),r=(0,s.useRef)(e),O=C(function(){return p(r.current,function(){a()})},[]);return O}var X=z,o=n(85893);function Y(){var e=X({list:[],path:""}),a=(0,s.useState)(!1),r=(0,j.Z)(a,2),O=r[0],h=r[1],i=(0,s.useRef)(null),f=(0,s.useRef)(null),d=(0,s.useRef)(null),Z=function(){var t=document.getElementById("video");return new Promise(function(l,u){var v,g="",y=document.createElement("canvas"),w=t==null?void 0:t.width,U=t==null?void 0:t.height;y.width=w,y.height=U,(v=y.getContext("2d"))===null||v===void 0||v.drawImage(t,0,0,w,U),setTimeout(function(){g=y.toDataURL("image/jpeg"),console.log(g),document.getElementById("testImg").src=g,l(g)},0)})},E=function(t){var l=[];return t?l=t:l=e.list,l.length<1?"":l.map(function(u,v){return u?v===0?"M ".concat(u[0]," ").concat(u[1]):v===1?"L ".concat(u[0]," ").concat(u[1]):v===l.length-1?"".concat(u[0]," ").concat(u[1]," Z"):"".concat(u[0]," ").concat(u[1]):""}).join(",")},F=function(t){e.list.push([t.layerX,t.layerY]),e.path=E()},I=function(t){e.path=E([].concat((0,m.Z)(e.list),[[t.layerX,t.layerY]]))},B=function(t){e.list.push([t.offsetX,t.offsetY]),e.path=E()},T=function(){e.path=E()};return(0,s.useEffect)(function(){var c,t,l,u;if(!!i.current)return(c=i.current)===null||c===void 0||c.addEventListener("click",F),(t=i.current)===null||t===void 0||t.addEventListener("mousemove",I),(l=f.current)===null||l===void 0||l.addEventListener("click",B),(u=d.current)===null||u===void 0||u.addEventListener("mouseleave",T),function(){var v,g,y,w;(v=i.current)===null||v===void 0||v.removeEventListener("click",F),(g=i.current)===null||g===void 0||g.removeEventListener("mousemove",I),(y=f.current)===null||y===void 0||y.removeEventListener("click",B),(w=d.current)===null||w===void 0||w.removeEventListener("mouseleave",T)}},[]),(0,o.jsxs)("div",{children:[(0,o.jsx)("button",{onClick:Z,children:"\u622A\u56FE"}),(0,o.jsx)("button",{onClick:function(){return h(!0)},children:"\u6807\u8BB0\u70B9"}),(0,o.jsx)("button",{onClick:function(){console.log(e.list),h(!1),e.list=[],e.path=""},children:"\u63D0\u4EA4"}),(0,o.jsx)("br",{}),(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"500",height:"300",ref:d,children:[(0,o.jsxs)("foreignObject",{x:"0",y:"0",width:"500",height:"300",children:[(0,o.jsx)("div",{ref:i,className:"video-marker-cover",style:{width:"500px",height:"300px",display:O?"block":"none"}}),(0,o.jsx)("video",{autoPlay:!0,muted:!0,src:"/video/big_buck_bunny.mp4",width:500,height:300,id:"video",controls:!0})]}),(0,o.jsx)("path",{ref:f,fill:"none",stroke:"red",d:e.path})]}),(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"500",height:"300",children:[(0,o.jsx)("foreignObject",{x:"0",y:"0",width:"500",height:"300",children:(0,o.jsx)("div",{children:(0,o.jsx)("img",{src:"",width:"500",height:"300",id:"testImg",alt:""})})}),(0,o.jsx)("path",{fill:"none",stroke:"red",d:e.path})]})]})}},85924:function(x,P,n){var m=n(5569),j=m(Object.getPrototypeOf,Object);x.exports=j},5569:function(x){function P(n,m){return function(j){return n(m(j))}}x.exports=P},68630:function(x,P,n){var m=n(44239),j=n(85924),s=n(37005),L="[object Object]",R=Function.prototype,M=Object.prototype,C=R.toString,A=M.hasOwnProperty,S=C.call(Object);function $(b){if(!s(b)||m(b)!=L)return!1;var k=j(b);if(k===null)return!0;var p=A.call(k,"constructor")&&k.constructor;return typeof p=="function"&&p instanceof p&&C.call(p)==S}x.exports=$}}]);
