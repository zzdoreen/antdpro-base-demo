var Qg=Math.pow;(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[655],{67154:function(Tt){function yt(){return Tt.exports=yt=Object.assign?Object.assign.bind():function(Ne){for(var We=1;We<arguments.length;We++){var rt=arguments[We];for(var q in rt)Object.prototype.hasOwnProperty.call(rt,q)&&(Ne[q]=rt[q])}return Ne},Tt.exports.__esModule=!0,Tt.exports.default=Tt.exports,yt.apply(this,arguments)}Tt.exports=yt,Tt.exports.__esModule=!0,Tt.exports.default=Tt.exports},99026:function(Tt,yt,Ne){"use strict";Ne.r(yt),Ne.d(yt,{default:function(){return kT}});var We=Ne(67294),rt=Ne(58908),q=Ne.n(rt),Oe=Ne(89144),Ee=Ne.n(Oe),fe=Ne(27537),ce=Ne.n(fe),le=Ne(75974),Z=Ne.n(le),oe=Ne(9603),V=Ne.n(oe),A=Ne(13407),I=Ne.n(A),U=Ne(49945),w=Ne.n(U),F="http://example.com",$=function(e,t){if(/^[a-z]+:/i.test(t))return t;/^data:/.test(e)&&(e=q().location&&q().location.href||"");var i=typeof q().URL=="function",r=/^\/\//.test(e),s=!q().location&&!/\/\//i.test(e);if(i?e=new(q()).URL(e,q().location||F):/\/\//i.test(e)||(e=w().buildAbsoluteURL(q().location&&q().location.href||"",e)),i){var a=new URL(t,e);return s?a.href.slice(F.length):r?a.href.slice(a.protocol.length):a.href}return w().buildAbsoluteURL(e,t)},C=$,B=Ne(22122),O=function(){function n(){this.listeners={}}var e=n.prototype;return e.on=function(i,r){this.listeners[i]||(this.listeners[i]=[]),this.listeners[i].push(r)},e.off=function(i,r){if(!this.listeners[i])return!1;var s=this.listeners[i].indexOf(r);return this.listeners[i]=this.listeners[i].slice(0),this.listeners[i].splice(s,1),s>-1},e.trigger=function(i){var r=this.listeners[i];if(!!r)if(arguments.length===2)for(var s=r.length,a=0;a<s;++a)r[a].call(this,arguments[1]);else for(var o=Array.prototype.slice.call(arguments,1),l=r.length,u=0;u<l;++u)r[u].apply(this,o)},e.dispose=function(){this.listeners={}},e.pipe=function(i){this.on("data",function(r){i.push(r)})},n}(),P=Ne(48764).Buffer,S=function(e){return q().atob?q().atob(e):P.from(e,"base64").toString("binary")};function H(n){for(var e=S(n),t=new Uint8Array(e.length),i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t}/*! @name m3u8-parser @version 6.2.0 @license Apache-2.0 */class X extends O{constructor(){super();this.buffer=""}push(e){let t;for(this.buffer+=e,t=this.buffer.indexOf(`
`);t>-1;t=this.buffer.indexOf(`
`))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)}}const ie=String.fromCharCode(9),k=function(n){const e=/([0-9.]*)?@?([0-9.]*)?/.exec(n||""),t={};return e[1]&&(t.length=parseInt(e[1],10)),e[2]&&(t.offset=parseInt(e[2],10)),t},j=function(){const n="[^=]*",e='"[^"]*"|[^,]*',t="(?:"+n+")=(?:"+e+")";return new RegExp("(?:^|,)("+t+")")},Y=function(n){const e={};if(!n)return e;const t=n.split(j());let i=t.length,r;for(;i--;)t[i]!==""&&(r=/([^=]*)=(.*)/.exec(t[i]).slice(1),r[0]=r[0].replace(/^\s+|\s+$/g,""),r[1]=r[1].replace(/^\s+|\s+$/g,""),r[1]=r[1].replace(/^['"](.*)['"]$/g,"$1"),e[r[0]]=r[1]);return e};class ne extends O{constructor(){super();this.customParsers=[],this.tagMappers=[]}push(e){let t,i;if(e=e.trim(),e.length===0)return;if(e[0]!=="#"){this.trigger("data",{type:"uri",uri:e});return}this.tagMappers.reduce((s,a)=>{const o=a(e);return o===e?s:s.concat([o])},[e]).forEach(s=>{for(let a=0;a<this.customParsers.length;a++)if(this.customParsers[a].call(this,s))return;if(s.indexOf("#EXT")!==0){this.trigger("data",{type:"comment",text:s.slice(1)});return}if(s=s.replace("\r",""),t=/^#EXTM3U/.exec(s),t){this.trigger("data",{type:"tag",tagType:"m3u"});return}if(t=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(s),t){i={type:"tag",tagType:"inf"},t[1]&&(i.duration=parseFloat(t[1])),t[2]&&(i.title=t[2]),this.trigger("data",i);return}if(t=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(s),t){i={type:"tag",tagType:"targetduration"},t[1]&&(i.duration=parseInt(t[1],10)),this.trigger("data",i);return}if(t=/^#EXT-X-VERSION:([0-9.]*)?/.exec(s),t){i={type:"tag",tagType:"version"},t[1]&&(i.version=parseInt(t[1],10)),this.trigger("data",i);return}if(t=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(s),t){i={type:"tag",tagType:"media-sequence"},t[1]&&(i.number=parseInt(t[1],10)),this.trigger("data",i);return}if(t=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(s),t){i={type:"tag",tagType:"discontinuity-sequence"},t[1]&&(i.number=parseInt(t[1],10)),this.trigger("data",i);return}if(t=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(s),t){i={type:"tag",tagType:"playlist-type"},t[1]&&(i.playlistType=t[1]),this.trigger("data",i);return}if(t=/^#EXT-X-BYTERANGE:(.*)?$/.exec(s),t){i=(0,B.Z)(k(t[1]),{type:"tag",tagType:"byterange"}),this.trigger("data",i);return}if(t=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(s),t){i={type:"tag",tagType:"allow-cache"},t[1]&&(i.allowed=!/NO/.test(t[1])),this.trigger("data",i);return}if(t=/^#EXT-X-MAP:(.*)$/.exec(s),t){if(i={type:"tag",tagType:"map"},t[1]){const a=Y(t[1]);a.URI&&(i.uri=a.URI),a.BYTERANGE&&(i.byterange=k(a.BYTERANGE))}this.trigger("data",i);return}if(t=/^#EXT-X-STREAM-INF:(.*)$/.exec(s),t){if(i={type:"tag",tagType:"stream-inf"},t[1]){if(i.attributes=Y(t[1]),i.attributes.RESOLUTION){const a=i.attributes.RESOLUTION.split("x"),o={};a[0]&&(o.width=parseInt(a[0],10)),a[1]&&(o.height=parseInt(a[1],10)),i.attributes.RESOLUTION=o}i.attributes.BANDWIDTH&&(i.attributes.BANDWIDTH=parseInt(i.attributes.BANDWIDTH,10)),i.attributes["FRAME-RATE"]&&(i.attributes["FRAME-RATE"]=parseFloat(i.attributes["FRAME-RATE"])),i.attributes["PROGRAM-ID"]&&(i.attributes["PROGRAM-ID"]=parseInt(i.attributes["PROGRAM-ID"],10))}this.trigger("data",i);return}if(t=/^#EXT-X-MEDIA:(.*)$/.exec(s),t){i={type:"tag",tagType:"media"},t[1]&&(i.attributes=Y(t[1])),this.trigger("data",i);return}if(t=/^#EXT-X-ENDLIST/.exec(s),t){this.trigger("data",{type:"tag",tagType:"endlist"});return}if(t=/^#EXT-X-DISCONTINUITY/.exec(s),t){this.trigger("data",{type:"tag",tagType:"discontinuity"});return}if(t=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(s),t){i={type:"tag",tagType:"program-date-time"},t[1]&&(i.dateTimeString=t[1],i.dateTimeObject=new Date(t[1])),this.trigger("data",i);return}if(t=/^#EXT-X-KEY:(.*)$/.exec(s),t){i={type:"tag",tagType:"key"},t[1]&&(i.attributes=Y(t[1]),i.attributes.IV&&(i.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(i.attributes.IV=i.attributes.IV.substring(2)),i.attributes.IV=i.attributes.IV.match(/.{8}/g),i.attributes.IV[0]=parseInt(i.attributes.IV[0],16),i.attributes.IV[1]=parseInt(i.attributes.IV[1],16),i.attributes.IV[2]=parseInt(i.attributes.IV[2],16),i.attributes.IV[3]=parseInt(i.attributes.IV[3],16),i.attributes.IV=new Uint32Array(i.attributes.IV))),this.trigger("data",i);return}if(t=/^#EXT-X-START:(.*)$/.exec(s),t){i={type:"tag",tagType:"start"},t[1]&&(i.attributes=Y(t[1]),i.attributes["TIME-OFFSET"]=parseFloat(i.attributes["TIME-OFFSET"]),i.attributes.PRECISE=/YES/.test(i.attributes.PRECISE)),this.trigger("data",i);return}if(t=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(s),t){i={type:"tag",tagType:"cue-out-cont"},t[1]?i.data=t[1]:i.data="",this.trigger("data",i);return}if(t=/^#EXT-X-CUE-OUT:(.*)?$/.exec(s),t){i={type:"tag",tagType:"cue-out"},t[1]?i.data=t[1]:i.data="",this.trigger("data",i);return}if(t=/^#EXT-X-CUE-IN:(.*)?$/.exec(s),t){i={type:"tag",tagType:"cue-in"},t[1]?i.data=t[1]:i.data="",this.trigger("data",i);return}if(t=/^#EXT-X-SKIP:(.*)$/.exec(s),t&&t[1]){i={type:"tag",tagType:"skip"},i.attributes=Y(t[1]),i.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(i.attributes["SKIPPED-SEGMENTS"]=parseInt(i.attributes["SKIPPED-SEGMENTS"],10)),i.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(i.attributes["RECENTLY-REMOVED-DATERANGES"]=i.attributes["RECENTLY-REMOVED-DATERANGES"].split(ie)),this.trigger("data",i);return}if(t=/^#EXT-X-PART:(.*)$/.exec(s),t&&t[1]){i={type:"tag",tagType:"part"},i.attributes=Y(t[1]),["DURATION"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=parseFloat(i.attributes[a]))}),["INDEPENDENT","GAP"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=/YES/.test(i.attributes[a]))}),i.attributes.hasOwnProperty("BYTERANGE")&&(i.attributes.byterange=k(i.attributes.BYTERANGE)),this.trigger("data",i);return}if(t=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(s),t&&t[1]){i={type:"tag",tagType:"server-control"},i.attributes=Y(t[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=parseFloat(i.attributes[a]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=/YES/.test(i.attributes[a]))}),this.trigger("data",i);return}if(t=/^#EXT-X-PART-INF:(.*)$/.exec(s),t&&t[1]){i={type:"tag",tagType:"part-inf"},i.attributes=Y(t[1]),["PART-TARGET"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=parseFloat(i.attributes[a]))}),this.trigger("data",i);return}if(t=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(s),t&&t[1]){i={type:"tag",tagType:"preload-hint"},i.attributes=Y(t[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(a){if(i.attributes.hasOwnProperty(a)){i.attributes[a]=parseInt(i.attributes[a],10);const o=a==="BYTERANGE-LENGTH"?"length":"offset";i.attributes.byterange=i.attributes.byterange||{},i.attributes.byterange[o]=i.attributes[a],delete i.attributes[a]}}),this.trigger("data",i);return}if(t=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(s),t&&t[1]){i={type:"tag",tagType:"rendition-report"},i.attributes=Y(t[1]),["LAST-MSN","LAST-PART"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=parseInt(i.attributes[a],10))}),this.trigger("data",i);return}if(t=/^#EXT-X-DATERANGE:(.*)$/.exec(s),t&&t[1]){i={type:"tag",tagType:"daterange"},i.attributes=Y(t[1]),["ID","CLASS"].forEach(function(o){i.attributes.hasOwnProperty(o)&&(i.attributes[o]=String(i.attributes[o]))}),["START-DATE","END-DATE"].forEach(function(o){i.attributes.hasOwnProperty(o)&&(i.attributes[o]=new Date(i.attributes[o]))}),["DURATION","PLANNED-DURATION"].forEach(function(o){i.attributes.hasOwnProperty(o)&&(i.attributes[o]=parseFloat(i.attributes[o]))}),["END-ON-NEXT"].forEach(function(o){i.attributes.hasOwnProperty(o)&&(i.attributes[o]=/YES/i.test(i.attributes[o]))}),["SCTE35-CMD"," SCTE35-OUT","SCTE35-IN"].forEach(function(o){i.attributes.hasOwnProperty(o)&&(i.attributes[o]=i.attributes[o].toString(16))});const a=/^X-([A-Z]+-)+[A-Z]+$/;for(const o in i.attributes){if(!a.test(o))continue;const l=/[0-9A-Fa-f]{6}/g.test(i.attributes[o]),u=/^\d+(\.\d+)?$/.test(i.attributes[o]);i.attributes[o]=l?i.attributes[o].toString(16):u?parseFloat(i.attributes[o]):String(i.attributes[o])}this.trigger("data",i);return}if(t=/^#EXT-X-INDEPENDENT-SEGMENTS/.exec(s),t){this.trigger("data",{type:"tag",tagType:"independent-segments"});return}this.trigger("data",{type:"tag",data:s.slice(4)})})}addParser({expression:e,customType:t,dataParser:i,segment:r}){typeof i!="function"&&(i=s=>s),this.customParsers.push(s=>{if(e.exec(s))return this.trigger("data",{type:"custom",data:i(s),customType:t,segment:r}),!0})}addTagMapper({expression:e,map:t}){const i=r=>e.test(r)?t(r):r;this.tagMappers.push(i)}}const he=n=>n.toLowerCase().replace(/-(\w)/g,e=>e[1].toUpperCase()),_e=function(n){const e={};return Object.keys(n).forEach(function(t){e[he(t)]=n[t]}),e},ye=function(n){const{serverControl:e,targetDuration:t,partTargetDuration:i}=n;if(!e)return;const r="#EXT-X-SERVER-CONTROL",s="holdBack",a="partHoldBack",o=t&&t*3,l=i&&i*2;t&&!e.hasOwnProperty(s)&&(e[s]=o,this.trigger("info",{message:`${r} defaulting HOLD-BACK to targetDuration * 3 (${o}).`})),o&&e[s]<o&&(this.trigger("warn",{message:`${r} clamping HOLD-BACK (${e[s]}) to targetDuration * 3 (${o})`}),e[s]=o),i&&!e.hasOwnProperty(a)&&(e[a]=i*3,this.trigger("info",{message:`${r} defaulting PART-HOLD-BACK to partTargetDuration * 3 (${e[a]}).`})),i&&e[a]<l&&(this.trigger("warn",{message:`${r} clamping PART-HOLD-BACK (${e[a]}) to partTargetDuration * 2 (${l}).`}),e[a]=l)};class ve extends O{constructor(){super();this.lineStream=new X,this.parseStream=new ne,this.lineStream.pipe(this.parseStream);const e=this,t=[];let i={},r,s,a=!1;const o=function(){},l={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},u="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";let d=0;this.manifest={allowCache:!0,discontinuityStarts:[],segments:[]};let h=0,v=0;const x={};this.on("end",()=>{i.uri||!i.parts&&!i.preloadHints||(!i.map&&r&&(i.map=r),!i.key&&s&&(i.key=s),!i.timeline&&typeof d=="number"&&(i.timeline=d),this.manifest.preloadSegment=i)}),this.parseStream.on("data",function(_){let R,N;({tag(){({version(){_.version&&(this.manifest.version=_.version)},"allow-cache"(){this.manifest.allowCache=_.allowed,"allowed"in _||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){const z={};"length"in _&&(i.byterange=z,z.length=_.length,"offset"in _||(_.offset=h)),"offset"in _&&(i.byterange=z,z.offset=_.offset),h=z.offset+z.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),_.duration>0&&(i.duration=_.duration),_.duration===0&&(i.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=t},key(){if(!_.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(_.attributes.METHOD==="NONE"){s=null;return}if(!_.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(_.attributes.KEYFORMAT==="com.apple.streamingkeydelivery"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:_.attributes};return}if(_.attributes.KEYFORMAT==="com.microsoft.playready"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:_.attributes.URI};return}if(_.attributes.KEYFORMAT===u){if(["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(_.attributes.METHOD)===-1){this.trigger("warn",{message:"invalid key method provided for Widevine"});return}if(_.attributes.METHOD==="SAMPLE-AES-CENC"&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),_.attributes.URI.substring(0,23)!=="data:text/plain;base64,"){this.trigger("warn",{message:"invalid key URI provided for Widevine"});return}if(!(_.attributes.KEYID&&_.attributes.KEYID.substring(0,2)==="0x")){this.trigger("warn",{message:"invalid key ID provided for Widevine"});return}this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:_.attributes.KEYFORMAT,keyId:_.attributes.KEYID.substring(2)},pssh:H(_.attributes.URI.split(",")[1])};return}_.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),s={method:_.attributes.METHOD||"AES-128",uri:_.attributes.URI},typeof _.attributes.IV!="undefined"&&(s.iv=_.attributes.IV)},"media-sequence"(){if(!isFinite(_.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+_.number});return}this.manifest.mediaSequence=_.number},"discontinuity-sequence"(){if(!isFinite(_.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+_.number});return}this.manifest.discontinuitySequence=_.number,d=_.number},"playlist-type"(){if(!/VOD|EVENT/.test(_.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+_.playlist});return}this.manifest.playlistType=_.playlistType},map(){r={},_.uri&&(r.uri=_.uri),_.byterange&&(r.byterange=_.byterange),s&&(r.key=s)},"stream-inf"(){if(this.manifest.playlists=t,this.manifest.mediaGroups=this.manifest.mediaGroups||l,!_.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}i.attributes||(i.attributes={}),(0,B.Z)(i.attributes,_.attributes)},media(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||l,!(_.attributes&&_.attributes.TYPE&&_.attributes["GROUP-ID"]&&_.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}const z=this.manifest.mediaGroups[_.attributes.TYPE];z[_.attributes["GROUP-ID"]]=z[_.attributes["GROUP-ID"]]||{},R=z[_.attributes["GROUP-ID"]],N={default:/yes/i.test(_.attributes.DEFAULT)},N.default?N.autoselect=!0:N.autoselect=/yes/i.test(_.attributes.AUTOSELECT),_.attributes.LANGUAGE&&(N.language=_.attributes.LANGUAGE),_.attributes.URI&&(N.uri=_.attributes.URI),_.attributes["INSTREAM-ID"]&&(N.instreamId=_.attributes["INSTREAM-ID"]),_.attributes.CHARACTERISTICS&&(N.characteristics=_.attributes.CHARACTERISTICS),_.attributes.FORCED&&(N.forced=/yes/i.test(_.attributes.FORCED)),R[_.attributes.NAME]=N},discontinuity(){d+=1,i.discontinuity=!0,this.manifest.discontinuityStarts.push(t.length)},"program-date-time"(){typeof this.manifest.dateTimeString=="undefined"&&(this.manifest.dateTimeString=_.dateTimeString,this.manifest.dateTimeObject=_.dateTimeObject),i.dateTimeString=_.dateTimeString,i.dateTimeObject=_.dateTimeObject},targetduration(){if(!isFinite(_.duration)||_.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+_.duration});return}this.manifest.targetDuration=_.duration,ye.call(this,this.manifest)},start(){if(!_.attributes||isNaN(_.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:_.attributes["TIME-OFFSET"],precise:_.attributes.PRECISE}},"cue-out"(){i.cueOut=_.data},"cue-out-cont"(){i.cueOutCont=_.data},"cue-in"(){i.cueIn=_.data},skip(){this.manifest.skip=_e(_.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",_.attributes,["SKIPPED-SEGMENTS"])},part(){a=!0;const z=this.manifest.segments.length,J=_e(_.attributes);i.parts=i.parts||[],i.parts.push(J),J.byterange&&(J.byterange.hasOwnProperty("offset")||(J.byterange.offset=v),v=J.byterange.offset+J.byterange.length);const ue=i.parts.length-1;this.warnOnMissingAttributes_(`#EXT-X-PART #${ue} for segment #${z}`,_.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((pe,te)=>{pe.hasOwnProperty("lastPart")||this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${te} lacks required attribute(s): LAST-PART`})})},"server-control"(){const z=this.manifest.serverControl=_e(_.attributes);z.hasOwnProperty("canBlockReload")||(z.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),ye.call(this,this.manifest),z.canSkipDateranges&&!z.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){const z=this.manifest.segments.length,J=_e(_.attributes),ue=J.type&&J.type==="PART";i.preloadHints=i.preloadHints||[],i.preloadHints.push(J),J.byterange&&(J.byterange.hasOwnProperty("offset")||(J.byterange.offset=ue?v:0,ue&&(v=J.byterange.offset+J.byterange.length)));const pe=i.preloadHints.length-1;if(this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${pe} for segment #${z}`,_.attributes,["TYPE","URI"]),!!J.type)for(let te=0;te<i.preloadHints.length-1;te++){const ke=i.preloadHints[te];!ke.type||ke.type===J.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${pe} for segment #${z} has the same TYPE ${J.type} as preload hint #${te}`})}},"rendition-report"(){const z=_e(_.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(z);const J=this.manifest.renditionReports.length-1,ue=["LAST-MSN","URI"];a&&ue.push("LAST-PART"),this.warnOnMissingAttributes_(`#EXT-X-RENDITION-REPORT #${J}`,_.attributes,ue)},"part-inf"(){this.manifest.partInf=_e(_.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",_.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),ye.call(this,this.manifest)},daterange(){this.manifest.daterange=this.manifest.daterange||[],this.manifest.daterange.push(_e(_.attributes));const z=this.manifest.daterange.length-1;this.warnOnMissingAttributes_(`#EXT-X-DATERANGE #${z}`,_.attributes,["ID","START-DATE"]);const J=this.manifest.daterange[z];J.endDate&&J.startDate&&new Date(J.endDate)<new Date(J.startDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE END-DATE must be equal to or later than the value of the START-DATE"}),J.duration&&J.duration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE DURATION must not be negative"}),J.plannedDuration&&J.plannedDuration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE PLANNED-DURATION must not be negative"});const ue=!!J.endOnNext;if(ue&&!J.class&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must have a CLASS attribute"}),ue&&(J.duration||J.endDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must not contain DURATION or END-DATE attributes"}),J.duration&&J.endDate){const pe=J.startDate,te=pe.setSeconds(pe.getSeconds()+J.duration);this.manifest.daterange[z].endDate=new Date(te)}if(J&&!this.manifest.dateTimeString&&this.trigger("warn",{message:"A playlist with EXT-X-DATERANGE tag must contain atleast one EXT-X-PROGRAM-DATE-TIME tag"}),!x[J.id])x[J.id]=J;else for(const pe in x[J.id])if(x[J.id][pe]!==J[pe]){this.trigger("warn",{message:"EXT-X-DATERANGE tags with the same ID in a playlist must have the same attributes and same attribute values"});break}},"independent-segments"(){this.manifest.independentSegments=!0}}[_.tagType]||o).call(e)},uri(){i.uri=_.uri,t.push(i),this.manifest.targetDuration&&!("duration"in i)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),i.duration=this.manifest.targetDuration),s&&(i.key=s),i.timeline=d,r&&(i.map=r),v=0,i={}},comment(){},custom(){_.segment?(i.custom=i.custom||{},i.custom[_.customType]=_.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[_.customType]=_.data)}})[_.type].call(e)})}warnOnMissingAttributes_(e,t,i){const r=[];i.forEach(function(s){t.hasOwnProperty(s)||r.push(s)}),r.length&&this.trigger("warn",{message:`${e} lacks required attribute(s): ${r.join(", ")}`})}push(e){this.lineStream.push(e)}end(){this.lineStream.push(`
`),this.trigger("end")}addParser(e){this.parseStream.addParser(e)}addTagMapper(e){this.parseStream.addTagMapper(e)}}var Te={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},be=["video","audio","text"],De=["Video","Audio","Text"],xe=function(e){return e&&e.replace(/avc1\.(\d+)\.(\d+)/i,function(t,i,r){var s=("00"+Number(i).toString(16)).slice(-2),a=("00"+Number(r).toString(16)).slice(-2);return"avc1."+s+"00"+a})},qe=function(e){return e.map(xe)},vt=function(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,function(t){return qe([t])[0]})},st=function(e){e===void 0&&(e="");var t=e.split(","),i=[];return t.forEach(function(r){r=r.trim();var s;be.forEach(function(a){var o=Te[a].exec(r.toLowerCase());if(!(!o||o.length<=1)){s=a;var l=r.substring(0,o[1].length),u=r.replace(l,"");i.push({type:l,details:u,mediaType:a})}}),s||i.push({type:r,details:"",mediaType:"unknown"})}),i},Xe=function(e,t){if(!e.mediaGroups.AUDIO||!t)return null;var i=e.mediaGroups.AUDIO[t];if(!i)return null;for(var r in i){var s=i[r];if(s.default&&s.playlists)return st(s.playlists[0].attributes.CODECS)}return null},Ye=function(e){return e===void 0&&(e=""),Te.video.test(e.trim().toLowerCase())},Ft=function(e){return e===void 0&&(e=""),Te.audio.test(e.trim().toLowerCase())},lt=function(e){return e===void 0&&(e=""),Te.text.test(e.trim().toLowerCase())},_t=function(e){if(!(!e||typeof e!="string")){var t=e.toLowerCase().split(",").map(function(s){return xe(s.trim())}),i="video";t.length===1&&Ft(t[0])?i="audio":t.length===1&&lt(t[0])&&(i="application");var r="mp4";return t.every(function(s){return Te.mp4.test(s)})?r="mp4":t.every(function(s){return Te.webm.test(s)})?r="webm":t.every(function(s){return Te.ogg.test(s)})&&(r="ogg"),i+"/"+r+';codecs="'+e+'"'}},Mt=function(e){return e===void 0&&(e=""),q().MediaSource&&q().MediaSource.isTypeSupported&&q().MediaSource.isTypeSupported(_t(e))||!1},It=function(e){return e===void 0&&(e=""),e.toLowerCase().split(",").every(function(t){t=t.trim();for(var i=0;i<De.length;i++){var r=De[i];if(Te["muxer"+r].test(t))return!0}return!1})},Jt="mp4a.40.2",Zt="avc1.4d400d",at=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,Nt=/^application\/dash\+xml/i,$t=function(e){return at.test(e)?"hls":Nt.test(e)?"dash":e==="application/vnd.videojs.vhs+json"?"vhs-json":null},Ci=function(e,t){for(var i="";t--;)i+=e;return i},Gi=function(e){return e.toString(2).length},Pi=function(e){return Math.ceil(Gi(e)/8)},Mi=function(e,t,i){return i===void 0&&(i=" "),(Ci(i,t)+e.toString()).slice(-t)},ki=function(e){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer},Ht=function(e){return ki(e)},tt=function(e){return e instanceof Uint8Array?e:(!Array.isArray(e)&&!Ht(e)&&!(e instanceof ArrayBuffer)&&(typeof e!="number"||typeof e=="number"&&e!==e?e=0:e=[e]),new Uint8Array(e&&e.buffer||e,e&&e.byteOffset||0,e&&e.byteLength||0))},ni=function(e){e=tt(e);for(var t="",i=0;i<e.length;i++)t+=Mi(e[i].toString(16),2,"0");return t},Ii=function(e){e=tt(e);for(var t="",i=0;i<e.length;i++)t+=Mi(e[i].toString(2),8,"0");return t},ei=q().BigInt||Number,lr=[ei("0x1"),ei("0x100"),ei("0x10000"),ei("0x1000000"),ei("0x100000000"),ei("0x10000000000"),ei("0x1000000000000"),ei("0x100000000000000"),ei("0x10000000000000000")],Cr=function(){var n=new Uint16Array([65484]),e=new Uint8Array(n.buffer,n.byteOffset,n.byteLength);return e[0]===255?"big":e[0]===204?"little":"unknown"}(),Ri=Cr==="big",Hs=Cr==="little",Ue=function(e,t){var i=t===void 0?{}:t,r=i.signed,s=r===void 0?!1:r,a=i.le,o=a===void 0?!1:a;e=tt(e);var l=o?"reduce":"reduceRight",u=e[l]?e[l]:Array.prototype[l],d=u.call(e,function(v,x,_){var R=o?_:Math.abs(_+1-e.length);return v+ei(x)*lr[R]},ei(0));if(s){var h=lr[e.length]/ei(2)-ei(1);d=ei(d),d>h&&(d-=h,d-=h,d-=ei(2))}return Number(d)},Ae=function(e,t){var i=t===void 0?{}:t,r=i.le,s=r===void 0?!1:r;(typeof e!="bigint"&&typeof e!="number"||typeof e=="number"&&e!==e)&&(e=0),e=ei(e);for(var a=Pi(e),o=new Uint8Array(new ArrayBuffer(a)),l=0;l<a;l++){var u=s?l:Math.abs(l+1-o.length);o[u]=Number(e/lr[l]&ei(255)),e<0&&(o[u]=Math.abs(~o[u]),o[u]-=l===0?1:2)}return o},Ze=function(e){if(!e)return"";e=Array.prototype.slice.call(e);var t=String.fromCharCode.apply(null,tt(e));try{return decodeURIComponent(escape(t))}catch(i){}return t},pt=function(e,t){if(typeof e!="string"&&e&&typeof e.toString=="function"&&(e=e.toString()),typeof e!="string")return new Uint8Array;t||(e=unescape(encodeURIComponent(e)));for(var i=new Uint8Array(e.length),r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return i},St=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];if(t=t.filter(function(o){return o&&(o.byteLength||o.length)&&typeof o!="string"}),t.length<=1)return tt(t[0]);var r=t.reduce(function(o,l,u){return o+(l.byteLength||l.length)},0),s=new Uint8Array(r),a=0;return t.forEach(function(o){o=tt(o),s.set(o,a),a+=o.byteLength}),s},ze=function(e,t,i){var r=i===void 0?{}:i,s=r.offset,a=s===void 0?0:s,o=r.mask,l=o===void 0?[]:o;e=tt(e),t=tt(t);var u=t.every?t.every:Array.prototype.every;return t.length&&e.length-a>=t.length&&u.call(t,function(d,h){var v=l[h]?l[h]&e[a+h]:e[a+h];return d===v})},hi=function(e,t,i){return Uint8Array.prototype.slice?Uint8Array.prototype.slice.call(e,t,i):new Uint8Array(Array.prototype.slice.call(e,t,i))},tn=function(e){return e.reverse?e.reverse():Array.prototype.reverse.call(e)},nn="http://example.com",bn=function(e,t){if(/^[a-z]+:/i.test(t))return t;/^data:/.test(e)&&(e=q().location&&q().location.href||"");var i=typeof q().URL=="function",r=/^\/\//.test(e),s=!q().location&&!/\/\//i.test(e);if(i?e=new(q()).URL(e,q().location||nn):/\/\//i.test(e)||(e=w().buildAbsoluteURL(q().location&&q().location.href||"",e)),i){var a=new URL(t,e);return s?a.href.slice(nn.length):r?a.href.slice(a.protocol.length):a.href}return w().buildAbsoluteURL(e,t)},_n=bn,Ws=function(e,t,i){t.forEach(function(r){for(var s in e.mediaGroups[r])for(var a in e.mediaGroups[r][s]){var o=e.mediaGroups[r][s][a];i(o,r,s,a)}})},ur=Ne(3969);/*! @name mpd-parser @version 1.1.1 @license Apache-2.0 */var Wr="1.1.1";const wr=n=>!!n&&typeof n=="object",xi=(...n)=>n.reduce((e,t)=>(typeof t!="object"||Object.keys(t).forEach(i=>{Array.isArray(e[i])&&Array.isArray(t[i])?e[i]=e[i].concat(t[i]):wr(e[i])&&wr(t[i])?e[i]=xi(e[i],t[i]):e[i]=t[i]}),e),{}),Kr=n=>Object.keys(n).map(e=>n[e]),Ks=(n,e)=>{const t=[];for(let i=n;i<e;i++)t.push(i);return t},xn=n=>n.reduce((e,t)=>e.concat(t),[]),rn=n=>{if(!n.length)return[];const e=[];for(let t=0;t<n.length;t++)e.push(n[t]);return e},qs=(n,e)=>n.reduce((t,i,r)=>(i[e]&&t.push(r),t),[]),ys=(n,e)=>Kr(n.reduce((t,i)=>(i.forEach(r=>{t[e(r)]=r}),t),{}));var On={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",MISSING_SEGMENT_INFORMATION:"MISSING_SEGMENT_INFORMATION",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"};const qr=({baseUrl:n="",source:e="",range:t="",indexRange:i=""})=>{const r={uri:e,resolvedUri:_n(n||"",e)};if(t||i){const a=(t||i).split("-");let o=q().BigInt?q().BigInt(a[0]):parseInt(a[0],10),l=q().BigInt?q().BigInt(a[1]):parseInt(a[1],10);o<Number.MAX_SAFE_INTEGER&&typeof o=="bigint"&&(o=Number(o)),l<Number.MAX_SAFE_INTEGER&&typeof l=="bigint"&&(l=Number(l));let u;typeof l=="bigint"||typeof o=="bigint"?u=q().BigInt(l)-q().BigInt(o)+q().BigInt(1):u=l-o+1,typeof u=="bigint"&&u<Number.MAX_SAFE_INTEGER&&(u=Number(u)),r.byterange={length:u,offset:o}}return r},K=n=>{let e;return typeof n.offset=="bigint"||typeof n.length=="bigint"?e=q().BigInt(n.offset)+q().BigInt(n.length)-q().BigInt(1):e=n.offset+n.length-1,`${n.offset}-${e}`},Q=n=>(n&&typeof n!="number"&&(n=parseInt(n,10)),isNaN(n)?null:n),ge={static(n){const{duration:e,timescale:t=1,sourceDuration:i,periodDuration:r}=n,s=Q(n.endNumber),a=e/t;return typeof s=="number"?{start:0,end:s}:typeof r=="number"?{start:0,end:r/a}:{start:0,end:i/a}},dynamic(n){const{NOW:e,clientOffset:t,availabilityStartTime:i,timescale:r=1,duration:s,periodStart:a=0,minimumUpdatePeriod:o=0,timeShiftBufferDepth:l=Infinity}=n,u=Q(n.endNumber),d=(e+t)/1e3,h=i+a,x=d+o-h,_=Math.ceil(x*r/s),R=Math.floor((d-h-l)*r/s),N=Math.floor((d-h)*r/s);return{start:Math.max(0,R),end:typeof u=="number"?u:Math.min(_,N)}}},Be=n=>e=>{const{duration:t,timescale:i=1,periodStart:r,startNumber:s=1}=n;return{number:s+e,duration:t/i,timeline:r,time:e*t}},Qe=n=>{const{type:e,duration:t,timescale:i=1,periodDuration:r,sourceDuration:s}=n,{start:a,end:o}=ge[e](n),l=Ks(a,o).map(Be(n));if(e==="static"){const u=l.length-1,d=typeof r=="number"?r:s;l[u].duration=d-t/i*u}return l},At=n=>{const{baseUrl:e,initialization:t={},sourceDuration:i,indexRange:r="",periodStart:s,presentationTime:a,number:o=0,duration:l}=n;if(!e)throw new Error(On.NO_BASE_URL);const u=qr({baseUrl:e,source:t.sourceURL,range:t.range}),d=qr({baseUrl:e,source:e,indexRange:r});if(d.map=u,l){const h=Qe(n);h.length&&(d.duration=h[0].duration,d.timeline=h[0].timeline)}else i&&(d.duration=i,d.timeline=s);return d.presentationTime=a||s,d.number=o,[d]},Yt=(n,e,t)=>{const i=n.sidx.map?n.sidx.map:null,r=n.sidx.duration,s=n.timeline||0,a=n.sidx.byterange,o=a.offset+a.length,l=e.timescale,u=e.references.filter(N=>N.referenceType!==1),d=[],h=n.endList?"static":"dynamic",v=n.sidx.timeline;let x=v,_=n.mediaSequence||0,R;typeof e.firstOffset=="bigint"?R=q().BigInt(o)+e.firstOffset:R=o+e.firstOffset;for(let N=0;N<u.length;N++){const z=e.references[N],J=z.referencedSize,ue=z.subsegmentDuration;let pe;typeof R=="bigint"?pe=R+q().BigInt(J)-q().BigInt(1):pe=R+J-1;const te=`${R}-${pe}`,we=At({baseUrl:t,timescale:l,timeline:s,periodStart:v,presentationTime:x,number:_,duration:ue,sourceDuration:r,indexRange:te,type:h})[0];i&&(we.map=i),d.push(we),typeof R=="bigint"?R+=q().BigInt(J):R+=J,x+=ue/l,_++}return n.segments=d,n},ri=["AUDIO","SUBTITLES"],Vi=1/60,Ni=n=>ys(n,({timeline:e})=>e).sort((e,t)=>e.timeline>t.timeline?1:-1),En=(n,e)=>{for(let t=0;t<n.length;t++)if(n[t].attributes.NAME===e)return n[t];return null},Tn=n=>{let e=[];return Ws(n,ri,(t,i,r,s)=>{e=e.concat(t.playlists||[])}),e},Sn=({playlist:n,mediaSequence:e})=>{n.mediaSequence=e,n.segments.forEach((t,i)=>{t.number=n.mediaSequence+i})},Pn=({oldPlaylists:n,newPlaylists:e,timelineStarts:t})=>{e.forEach(i=>{i.discontinuitySequence=t.findIndex(function({timeline:l}){return l===i.timeline});const r=En(n,i.attributes.NAME);if(!r||i.sidx)return;const s=i.segments[0],a=r.segments.findIndex(function(l){return Math.abs(l.presentationTime-s.presentationTime)<Vi});if(a===-1){Sn({playlist:i,mediaSequence:r.mediaSequence+r.segments.length}),i.segments[0].discontinuity=!0,i.discontinuityStarts.unshift(0),(!r.segments.length&&i.timeline>r.timeline||r.segments.length&&i.timeline>r.segments[r.segments.length-1].timeline)&&i.discontinuitySequence--;return}r.segments[a].discontinuity&&!s.discontinuity&&(s.discontinuity=!0,i.discontinuityStarts.unshift(0),i.discontinuitySequence--),Sn({playlist:i,mediaSequence:r.segments[a].number})})},Bn=({oldManifest:n,newManifest:e})=>{const t=n.playlists.concat(Tn(n)),i=e.playlists.concat(Tn(e));return e.timelineStarts=Ni([n.timelineStarts,e.timelineStarts]),Pn({oldPlaylists:t,newPlaylists:i,timelineStarts:e.timelineStarts}),e},wi=n=>n&&n.uri+"-"+K(n.byterange),zi=n=>Kr(n.reduce((t,i)=>{const r=i.attributes.id+(i.attributes.lang||"");return t[r]?(i.segments&&(i.segments[0]&&(i.segments[0].discontinuity=!0),t[r].segments.push(...i.segments)),i.attributes.contentProtection&&(t[r].attributes.contentProtection=i.attributes.contentProtection)):(t[r]=i,t[r].attributes.timelineStarts=[]),t[r].attributes.timelineStarts.push({start:i.attributes.periodStart,timeline:i.attributes.periodStart}),t},{})).map(t=>(t.discontinuityStarts=qs(t.segments||[],"discontinuity"),t)),Fn=(n,e)=>{const t=wi(n.sidx),i=t&&e[t]&&e[t].sidx;return i&&Yt(n,i,n.sidx.resolvedUri),n},Lr=(n,e={})=>{if(!Object.keys(e).length)return n;for(const t in n)n[t]=Fn(n[t],e);return n},Ui=({attributes:n,segments:e,sidx:t,mediaSequence:i,discontinuitySequence:r,discontinuityStarts:s},a)=>{const o={attributes:{NAME:n.id,BANDWIDTH:n.bandwidth,CODECS:n.codecs,["PROGRAM-ID"]:1},uri:"",endList:n.type==="static",timeline:n.periodStart,resolvedUri:"",targetDuration:n.duration,discontinuitySequence:r,discontinuityStarts:s,timelineStarts:n.timelineStarts,mediaSequence:i,segments:e};return n.contentProtection&&(o.contentProtection=n.contentProtection),t&&(o.sidx=t),a&&(o.attributes.AUDIO="audio",o.attributes.SUBTITLES="subs"),o},zr=({attributes:n,segments:e,mediaSequence:t,discontinuityStarts:i,discontinuitySequence:r})=>{typeof e=="undefined"&&(e=[{uri:n.baseUrl,timeline:n.periodStart,resolvedUri:n.baseUrl||"",duration:n.sourceDuration,number:0}],n.duration=n.sourceDuration);const s={NAME:n.id,BANDWIDTH:n.bandwidth,["PROGRAM-ID"]:1};return n.codecs&&(s.CODECS=n.codecs),{attributes:s,uri:"",endList:n.type==="static",timeline:n.periodStart,resolvedUri:n.baseUrl||"",targetDuration:n.duration,timelineStarts:n.timelineStarts,discontinuityStarts:i,discontinuitySequence:r,mediaSequence:t,segments:e}},Io=(n,e={},t=!1)=>{let i;const r=n.reduce((s,a)=>{const o=a.attributes.role&&a.attributes.role.value||"",l=a.attributes.lang||"";let u=a.attributes.label||"main";if(l&&!a.attributes.label){const h=o?` (${o})`:"";u=`${a.attributes.lang}${h}`}s[u]||(s[u]={language:l,autoselect:!0,default:o==="main",playlists:[],uri:""});const d=Fn(Ui(a,t),e);return s[u].playlists.push(d),typeof i=="undefined"&&o==="main"&&(i=a,i.default=!0),s},{});if(!i){const s=Object.keys(r)[0];r[s].default=!0}return r},Ro=(n,e={})=>n.reduce((t,i)=>{const r=i.attributes.label||i.attributes.lang||"text";return t[r]||(t[r]={language:r,default:!1,autoselect:!1,playlists:[],uri:""}),t[r].playlists.push(Fn(zr(i),e)),t},{}),zs=n=>n.reduce((e,t)=>(t&&t.forEach(i=>{const{channel:r,language:s}=i;e[s]={autoselect:!1,default:!1,instreamId:r,language:s},i.hasOwnProperty("aspectRatio")&&(e[s].aspectRatio=i.aspectRatio),i.hasOwnProperty("easyReader")&&(e[s].easyReader=i.easyReader),i.hasOwnProperty("3D")&&(e[s]["3D"]=i["3D"])}),e),{}),Eu=({attributes:n,segments:e,sidx:t,discontinuityStarts:i})=>{const r={attributes:{NAME:n.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:n.width,height:n.height},CODECS:n.codecs,BANDWIDTH:n.bandwidth,["PROGRAM-ID"]:1},uri:"",endList:n.type==="static",timeline:n.periodStart,resolvedUri:"",targetDuration:n.duration,discontinuityStarts:i,timelineStarts:n.timelineStarts,segments:e};return n.frameRate&&(r.attributes["FRAME-RATE"]=n.frameRate),n.contentProtection&&(r.contentProtection=n.contentProtection),t&&(r.sidx=t),r},Oo=({attributes:n})=>n.mimeType==="video/mp4"||n.mimeType==="video/webm"||n.contentType==="video",Tu=({attributes:n})=>n.mimeType==="audio/mp4"||n.mimeType==="audio/webm"||n.contentType==="audio",Po=({attributes:n})=>n.mimeType==="text/vtt"||n.contentType==="text",Su=(n,e)=>{n.forEach(t=>{t.mediaSequence=0,t.discontinuitySequence=e.findIndex(function({timeline:i}){return i===t.timeline}),!!t.segments&&t.segments.forEach((i,r)=>{i.number=r})})},Ys=n=>n?Object.keys(n).reduce((e,t)=>{const i=n[t];return e.concat(i.playlists)},[]):[],Pa=({dashPlaylists:n,locations:e,sidxMapping:t={},previousManifest:i,eventStream:r})=>{if(!n.length)return{};const{sourceDuration:s,type:a,suggestedPresentationDelay:o,minimumUpdatePeriod:l}=n[0].attributes,u=zi(n.filter(Oo)).map(Eu),d=zi(n.filter(Tu)),h=zi(n.filter(Po)),v=n.map(ue=>ue.attributes.captionServices).filter(Boolean),x={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:{AUDIO:{},VIDEO:{},["CLOSED-CAPTIONS"]:{},SUBTITLES:{}},uri:"",duration:s,playlists:Lr(u,t)};l>=0&&(x.minimumUpdatePeriod=l*1e3),e&&(x.locations=e),a==="dynamic"&&(x.suggestedPresentationDelay=o),r&&r.length>0&&(x.eventStream=r);const _=x.playlists.length===0,R=d.length?Io(d,t,_):null,N=h.length?Ro(h,t):null,z=u.concat(Ys(R),Ys(N)),J=z.map(({timelineStarts:ue})=>ue);return x.timelineStarts=Ni(J),Su(z,x.timelineStarts),R&&(x.mediaGroups.AUDIO.audio=R),N&&(x.mediaGroups.SUBTITLES.subs=N),v.length&&(x.mediaGroups["CLOSED-CAPTIONS"].cc=zs(v)),i?Bn({oldManifest:i,newManifest:x}):x},Bo=(n,e,t)=>{const{NOW:i,clientOffset:r,availabilityStartTime:s,timescale:a=1,periodStart:o=0,minimumUpdatePeriod:l=0}=n,u=(i+r)/1e3,d=s+o,v=u+l-d;return Math.ceil((v*a-e)/t)},Ba=(n,e)=>{const{type:t,minimumUpdatePeriod:i=0,media:r="",sourceDuration:s,timescale:a=1,startNumber:o=1,periodStart:l}=n,u=[];let d=-1;for(let h=0;h<e.length;h++){const v=e[h],x=v.d,_=v.r||0,R=v.t||0;d<0&&(d=R),R&&R>d&&(d=R);let N;if(_<0){const ue=h+1;ue===e.length?t==="dynamic"&&i>0&&r.indexOf("$Number$")>0?N=Bo(n,d,x):N=(s*a-d)/x:N=(e[ue].t-d)/x}else N=_+1;const z=o+u.length+N;let J=o+u.length;for(;J<z;)u.push({number:J,duration:x/a,time:d,timeline:l}),d+=x,J++}return u},Yr=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,Xs=n=>(e,t,i,r)=>{if(e==="$$")return"$";if(typeof n[t]=="undefined")return e;const s=""+n[t];return t==="RepresentationID"||(i?r=parseInt(r,10):r=1,s.length>=r)?s:`${new Array(r-s.length+1).join("0")}${s}`},Qs=(n,e)=>n.replace(Yr,Xs(e)),Fo=(n,e)=>!n.duration&&!e?[{number:n.startNumber||1,duration:n.sourceDuration,time:0,timeline:n.periodStart}]:n.duration?Qe(n):Ba(n,e),Fa=(n,e)=>{const t={RepresentationID:n.id,Bandwidth:n.bandwidth||0},{initialization:i={sourceURL:"",range:""}}=n,r=qr({baseUrl:n.baseUrl,source:Qs(i.sourceURL,t),range:i.range});return Fo(n,e).map(a=>{t.Number=a.number,t.Time=a.time;const o=Qs(n.media||"",t),l=n.timescale||1,u=n.presentationTimeOffset||0,d=n.periodStart+(a.time-u)/l;return{uri:o,timeline:a.timeline,duration:a.duration,resolvedUri:_n(n.baseUrl||"",o),map:r,number:a.number,presentationTime:d}})},vs=(n,e)=>{const{baseUrl:t,initialization:i={}}=n,r=qr({baseUrl:t,source:i.sourceURL,range:i.range}),s=qr({baseUrl:t,source:e.media,range:e.mediaRange});return s.map=r,s},Cu=(n,e)=>{const{duration:t,segmentUrls:i=[],periodStart:r}=n;if(!t&&!e||t&&e)throw new Error(On.SEGMENT_TIME_UNSPECIFIED);const s=i.map(l=>vs(n,l));let a;return t&&(a=Qe(n)),e&&(a=Ba(n,e)),a.map((l,u)=>{if(s[u]){const d=s[u],h=n.timescale||1,v=n.presentationTimeOffset||0;return d.timeline=l.timeline,d.duration=l.duration,d.number=l.number,d.presentationTime=r+(l.time-v)/h,d}}).filter(l=>l)},dr=({attributes:n,segmentInfo:e})=>{let t,i;e.template?(i=Fa,t=xi(n,e.template)):e.base?(i=At,t=xi(n,e.base)):e.list&&(i=Cu,t=xi(n,e.list));const r={attributes:n};if(!i)return r;const s=i(t,e.segmentTimeline);if(t.duration){const{duration:a,timescale:o=1}=t;t.duration=a/o}else s.length?t.duration=s.reduce((a,o)=>Math.max(a,Math.ceil(o.duration)),0):t.duration=0;return r.attributes=t,r.segments=s,e.base&&t.indexRange&&(r.sidx=s[0],r.segments=[]),r},Zs=n=>n.map(dr),si=(n,e)=>rn(n.childNodes).filter(({tagName:t})=>t===e),cr=n=>n.textContent.trim(),Mo=n=>parseFloat(n.split("/").reduce((e,t)=>e/t)),Xr=n=>{const e=365*24*60*60,t=30*24*60*60,i=24*60*60,r=60*60,s=60,o=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(n);if(!o)return 0;const[l,u,d,h,v,x]=o.slice(1);return parseFloat(l||0)*e+parseFloat(u||0)*t+parseFloat(d||0)*i+parseFloat(h||0)*r+parseFloat(v||0)*s+parseFloat(x||0)},wu=n=>(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(n)&&(n+="Z"),Date.parse(n)),Ma={mediaPresentationDuration(n){return Xr(n)},availabilityStartTime(n){return wu(n)/1e3},minimumUpdatePeriod(n){return Xr(n)},suggestedPresentationDelay(n){return Xr(n)},type(n){return n},timeShiftBufferDepth(n){return Xr(n)},start(n){return Xr(n)},width(n){return parseInt(n,10)},height(n){return parseInt(n,10)},bandwidth(n){return parseInt(n,10)},frameRate(n){return Mo(n)},startNumber(n){return parseInt(n,10)},timescale(n){return parseInt(n,10)},presentationTimeOffset(n){return parseInt(n,10)},duration(n){const e=parseInt(n,10);return isNaN(e)?Xr(n):e},d(n){return parseInt(n,10)},t(n){return parseInt(n,10)},r(n){return parseInt(n,10)},presentationTime(n){return parseInt(n,10)},DEFAULT(n){return n}},Ei=n=>n&&n.attributes?rn(n.attributes).reduce((e,t)=>{const i=Ma[t.name]||Ma.DEFAULT;return e[t.name]=i(t.value),e},{}):{},Lu={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},gi=(n,e)=>e.length?xn(n.map(function(t){return e.map(function(i){return _n(t,cr(i))})})):n,Js=n=>{const e=si(n,"SegmentTemplate")[0],t=si(n,"SegmentList")[0],i=t&&si(t,"SegmentURL").map(h=>xi({tag:"SegmentURL"},Ei(h))),r=si(n,"SegmentBase")[0],s=t||e,a=s&&si(s,"SegmentTimeline")[0],o=t||r||e,l=o&&si(o,"Initialization")[0],u=e&&Ei(e);u&&l?u.initialization=l&&Ei(l):u&&u.initialization&&(u.initialization={sourceURL:u.initialization});const d={template:u,segmentTimeline:a&&si(a,"S").map(h=>Ei(h)),list:t&&xi(Ei(t),{segmentUrls:i,initialization:Ei(l)}),base:r&&xi(Ei(r),{initialization:Ei(l)})};return Object.keys(d).forEach(h=>{d[h]||delete d[h]}),d},Du=(n,e,t)=>i=>{const r=si(i,"BaseURL"),s=gi(e,r),a=xi(n,Ei(i)),o=Js(i);return s.map(l=>({segmentInfo:xi(t,o),attributes:xi(a,{baseUrl:l})}))},Na=n=>n.reduce((e,t)=>{const i=Ei(t);i.schemeIdUri&&(i.schemeIdUri=i.schemeIdUri.toLowerCase());const r=Lu[i.schemeIdUri];if(r){e[r]={attributes:i};const s=si(t,"cenc:pssh")[0];if(s){const a=cr(s);e[r].pssh=a&&H(a)}}return e},{}),ku=n=>{if(n.schemeIdUri==="urn:scte:dash:cc:cea-608:2015")return(typeof n.value!="string"?[]:n.value.split(";")).map(t=>{let i,r;return r=t,/^CC\d=/.test(t)?[i,r]=t.split("="):/^CC\d$/.test(t)&&(i=t),{channel:i,language:r}});if(n.schemeIdUri==="urn:scte:dash:cc:cea-708:2015")return(typeof n.value!="string"?[]:n.value.split(";")).map(t=>{const i={channel:void 0,language:void 0,aspectRatio:1,easyReader:0,"3D":0};if(/=/.test(t)){const[r,s=""]=t.split("=");i.channel=r,i.language=t,s.split(",").forEach(a=>{const[o,l]=a.split(":");o==="lang"?i.language=l:o==="er"?i.easyReader=Number(l):o==="war"?i.aspectRatio=Number(l):o==="3D"&&(i["3D"]=Number(l))})}else i.language=t;return i.channel&&(i.channel="SERVICE"+i.channel),i})},Ua=n=>xn(si(n.node,"EventStream").map(e=>{const t=Ei(e),i=t.schemeIdUri;return si(e,"Event").map(r=>{const s=Ei(r),a=s.presentationTime||0,o=t.timescale||1,l=s.duration||0,u=a/o+n.attributes.start;return{schemeIdUri:i,value:t.value,id:s.id,start:u,end:u+l/o,messageData:cr(r)||s.messageData,contentEncoding:t.contentEncoding,presentationTimeOffset:t.presentationTimeOffset||0}})})),Qr=(n,e,t)=>i=>{const r=Ei(i),s=gi(e,si(i,"BaseURL")),a=si(i,"Role")[0],o={role:Ei(a)};let l=xi(n,r,o);const u=si(i,"Accessibility")[0],d=ku(Ei(u));d&&(l=xi(l,{captionServices:d}));const h=si(i,"Label")[0];if(h&&h.childNodes.length){const N=h.childNodes[0].nodeValue.trim();l=xi(l,{label:N})}const v=Na(si(i,"ContentProtection"));Object.keys(v).length&&(l=xi(l,{contentProtection:v}));const x=Js(i),_=si(i,"Representation"),R=xi(t,x);return xn(_.map(Du(l,s,R)))},Iu=(n,e)=>(t,i)=>{const r=gi(e,si(t.node,"BaseURL")),s=xi(n,{periodStart:t.attributes.start});typeof t.attributes.duration=="number"&&(s.periodDuration=t.attributes.duration);const a=si(t.node,"AdaptationSet"),o=Js(t.node);return xn(a.map(Qr(s,r,o)))},Ru=({attributes:n,priorPeriodAttributes:e,mpdType:t})=>typeof n.start=="number"?n.start:e&&typeof e.start=="number"&&typeof e.duration=="number"?e.start+e.duration:!e&&t==="static"?0:null,Ou=(n,e={})=>{const{manifestUri:t="",NOW:i=Date.now(),clientOffset:r=0}=e,s=si(n,"Period");if(!s.length)throw new Error(On.INVALID_NUMBER_OF_PERIOD);const a=si(n,"Location"),o=Ei(n),l=gi([t],si(n,"BaseURL"));o.type=o.type||"static",o.sourceDuration=o.mediaPresentationDuration||0,o.NOW=i,o.clientOffset=r,a.length&&(o.locations=a.map(cr));const u=[];return s.forEach((d,h)=>{const v=Ei(d),x=u[h-1];v.start=Ru({attributes:v,priorPeriodAttributes:x?x.attributes:null,mpdType:o.type}),u.push({node:d,attributes:v})}),{locations:o.locations,representationInfo:xn(u.map(Iu(o,l))),eventStream:xn(u.map(Ua))}},No=n=>{if(n==="")throw new Error(On.DASH_EMPTY_MANIFEST);const e=new ur.DOMParser;let t,i;try{t=e.parseFromString(n,"application/xml"),i=t&&t.documentElement.tagName==="MPD"?t.documentElement:null}catch(r){}if(!i||i&&i.getElementsByTagName("parsererror").length>0)throw new Error(On.DASH_INVALID_XML);return i},Pu=n=>{const e=si(n,"UTCTiming")[0];if(!e)return null;const t=Ei(e);switch(t.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":t.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":t.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":t.method="DIRECT",t.value=Date.parse(t.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(On.UNSUPPORTED_UTC_TIMING_SCHEME)}return t},kh=null,Bu=(n,e={})=>{const t=Ou(No(n),e),i=Zs(t.representationInfo);return Pa({dashPlaylists:i,locations:t.locations,sidxMapping:e.sidxMapping,previousManifest:e.previousManifest,eventStream:t.eventStream})},Fu=n=>Pu(No(n));var Mu=Ne(84221),Nu=Ne.n(Mu),Uu=tt([73,68,51]),ju=function(e,t){t===void 0&&(t=0),e=tt(e);var i=e[t+5],r=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9],s=(i&16)>>4;return s?r+20:r+10},As=function n(e,t){return t===void 0&&(t=0),e=tt(e),e.length-t<10||!ze(e,Uu,{offset:t})?t:(t+=ju(e,t),n(e,t))},Ih=function(e){var t="",i=e[1]>>>3,r=e[1]&31,s=e[2]>>>7,a=(e[2]&64)>>6,o=(e[2]&32)>>5,l=(e[2]&16)>>4,u=(e[2]&8)>>3,d=(e[2]&4)>>2,h=e[2]&3;t+=i+"."+padStart(r,2,"0"),s===0?t+="M":s===1&&(t+="H");var v;return i===2&&a?v=o?12:10:v=a?10:8,t+="."+padStart(v,2,"0"),t+="."+l,t+="."+u+d+h,t},Rh=function(e){var t=toHexString(e[1]),i=toHexString(e[2]&252),r=toHexString(e[3]);return""+t+i+r},Oh=function(e){var t="",i=e[1]>>6,r=e[1]&31,s=(e[1]&32)>>5,a=e.subarray(2,6),o=e.subarray(6,12),l=e[12];i===1?t+="A":i===2?t+="B":i===3&&(t+="C"),t+=r+".";var u=parseInt(toBinaryString(a).split("").reverse().join(""),2);u>255&&(u=parseInt(toBinaryString(a),2)),t+=u.toString(16)+".",s===0?t+="L":t+="H",t+=l;for(var d="",h=0;h<o.length;h++){var v=o[h];v&&(d&&(d+="."),d+=v.toString(16))}return d&&(t+="."+d),t},Ph=new Uint8Array([79,112,117,115,72,101,97,100]),Bh=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),i=t.getUint8(0),r=i!==0,s={version:i,channels:t.getUint8(1),preSkip:t.getUint16(2,r),sampleRate:t.getUint32(4,r),outputGain:t.getUint16(8,r),channelMappingFamily:t.getUint8(10)};if(s.channelMappingFamily>0&&e.length>10){s.streamCount=t.getUint8(11),s.twoChannelStreamCount=t.getUint8(12),s.channelMapping=[];for(var a=0;a<s.channels;a++)s.channelMapping.push(t.getUint8(13+a))}return s},Fh=function(e){var t=e.channelMappingFamily<=0?11:12+e.channels,i=new DataView(new ArrayBuffer(t)),r=e.version!==0;return i.setUint8(0,e.version),i.setUint8(1,e.channels),i.setUint16(2,e.preSkip,r),i.setUint32(4,e.sampleRate,r),i.setUint16(8,e.outputGain,r),i.setUint8(10,e.channelMappingFamily),e.channelMappingFamily>0&&(i.setUint8(11,e.streamCount),e.channelMapping.foreach(function(s,a){i.setUint8(12+a,s)})),new Uint8Array(i.buffer)},ja=function(e){return typeof e=="string"?pt(e):(typeof e=="number",e)},$u=function(e){return Array.isArray(e)?e.map(function(t){return ja(t)}):[ja(e)]},$a,Ga=function(e){e=tt(e);for(var t=[],i=0;e.length>i;){var r=e[i],s=0,a=0;a++;var o=e[a];for(a++;o&128;)s=(o&127)<<7,o=e[a],a++;s+=o&127;for(var l=0;l<$a.length;l++){var u=$a[l],d=u.id,h=u.parser;if(r===d){t.push(h(e.subarray(a,a+s)));break}}i+=s+a}return t};$a=[{id:3,parser:function(e){var t={tag:3,id:e[0]<<8|e[1],flags:e[2],size:3,dependsOnEsId:0,ocrEsId:0,descriptors:[],url:""};if(t.flags&128&&(t.dependsOnEsId=e[t.size]<<8|e[t.size+1],t.size+=2),t.flags&64){var i=e[t.size];t.url=Ze(e.subarray(t.size+1,t.size+1+i)),t.size+=i}return t.flags&32&&(t.ocrEsId=e[t.size]<<8|e[t.size+1],t.size+=2),t.descriptors=Ga(e.subarray(t.size))||[],t}},{id:4,parser:function(e){var t={tag:4,oti:e[0],streamType:e[1],bufferSize:e[2]<<16|e[3]<<8|e[4],maxBitrate:e[5]<<24|e[6]<<16|e[7]<<8|e[8],avgBitrate:e[9]<<24|e[10]<<16|e[11]<<8|e[12],descriptors:Ga(e.subarray(13))};return t}},{id:5,parser:function(e){return{tag:5,bytes:e}}},{id:6,parser:function(e){return{tag:6,bytes:e}}}];var Yi=function n(e,t,i){i===void 0&&(i=!1),t=$u(t),e=tt(e);var r=[];if(!t.length)return r;for(var s=0;s<e.length;){var a=(e[s]<<24|e[s+1]<<16|e[s+2]<<8|e[s+3])>>>0,o=e.subarray(s+4,s+8);if(a===0)break;var l=s+a;if(l>e.length){if(i)break;l=e.length}var u=e.subarray(s+8,l);ze(o,t[0])&&(t.length===1?r.push(u):r.push.apply(r,n(u,t.slice(1),i))),s=l}return r},Zr=function(e,t){if(t=ja(t),!t.length)return e.subarray(e.length);for(var i=0;i<e.length;){if(bytesMatch(e.subarray(i,i+t.length),t)){var r=(e[i-4]<<24|e[i-3]<<16|e[i-2]<<8|e[i-1])>>>0,s=r>1?i+r:e.byteLength;return e.subarray(i+4,s)}i++}return e.subarray(e.length)},bs=function(e,t,i){t===void 0&&(t=4),i===void 0&&(i=function(l){return bytesToNumber(l)});var r=[];if(!e||!e.length)return r;for(var s=bytesToNumber(e.subarray(4,8)),a=8;s;a+=t,s--)r.push(i(e.subarray(a,a+t)));return r},Gu=function(e,t){for(var i=bs(Yi(e,["stss"])[0]),r=bs(Yi(e,["stco"])[0]),s=bs(Yi(e,["stts"])[0],8,function(Ve){return{sampleCount:bytesToNumber(Ve.subarray(0,4)),sampleDelta:bytesToNumber(Ve.subarray(4,8))}}),a=bs(Yi(e,["stsc"])[0],12,function(Ve){return{firstChunk:bytesToNumber(Ve.subarray(0,4)),samplesPerChunk:bytesToNumber(Ve.subarray(4,8)),sampleDescriptionIndex:bytesToNumber(Ve.subarray(8,12))}}),o=Yi(e,["stsz"])[0],l=bs(o&&o.length&&o.subarray(4)||null),u=[],d=0;d<r.length;d++){for(var h=void 0,v=0;v<a.length;v++){var x=a[v],_=d+1>=x.firstChunk&&(v+1>=a.length||d+1<a[v+1].firstChunk);if(_){h=x.samplesPerChunk;break}}for(var R=r[d],N=0;N<h;N++){var z=l[u.length],J=!i.length;i.length&&i.indexOf(u.length+1)!==-1&&(J=!0);for(var ue={keyframe:J,start:R,end:R+z},pe=0;pe<s.length;pe++){var te=s[pe],ke=te.sampleCount,we=te.sampleDelta;if(u.length<=ke){var Ge=u.length?u[u.length-1].timestamp:0;ue.timestamp=Ge+we/t*1e3,ue.duration=we;break}}u.push(ue),R+=z}}return u},Vu=function(e,t){var i=bytesToString(t.subarray(0,4));if(e.type==="video"?(e.info=e.info||{},e.info.width=t[28]<<8|t[29],e.info.height=t[30]<<8|t[31]):e.type==="audio"&&(e.info=e.info||{},e.info.channels=t[20]<<8|t[21],e.info.bitDepth=t[22]<<8|t[23],e.info.sampleRate=t[28]<<8|t[29]),i==="avc1"){var r=Zr(t,"avcC");i+="."+getAvcCodec(r),e.info.avcC=r}else if(i==="hvc1"||i==="hev1")i+="."+getHvcCodec(Zr(t,"hvcC"));else if(i==="mp4a"||i==="mp4v"){var s=Zr(t,"esds"),a=Ga(s.subarray(4))[0],o=a&&a.descriptors.filter(function(J){var ue=J.tag;return ue===4})[0];o?(i+="."+toHexString(o.oti),o.oti===64?i+="."+(o.descriptors[0].bytes[0]>>3).toString():o.oti===32?i+="."+o.descriptors[0].bytes[4].toString():o.oti===221&&(i="vorbis")):e.type==="audio"?i+=".40.2":i+=".20.9"}else if(i==="av01")i+="."+getAv1Codec(Zr(t,"av1C"));else if(i==="vp09"){var l=Zr(t,"vpcC"),u=l[0],d=l[1],h=l[2]>>4,v=(l[2]&15)>>1,x=(l[2]&15)>>3,_=l[3],R=l[4],N=l[5];i+="."+padStart(u,2,"0"),i+="."+padStart(d,2,"0"),i+="."+padStart(h,2,"0"),i+="."+padStart(v,2,"0"),i+="."+padStart(_,2,"0"),i+="."+padStart(R,2,"0"),i+="."+padStart(N,2,"0"),i+="."+padStart(x,2,"0")}else if(i==="theo")i="theora";else if(i==="spex")i="speex";else if(i===".mp3")i="mp4a.40.34";else if(i==="msVo")i="vorbis";else if(i==="Opus"){i="opus";var z=Zr(t,"dOps");e.info.opus=parseOpusHead(z),e.info.codecDelay=65e5}else i=i.toLowerCase();e.codec=i},Mh=function(e,t){t===void 0&&(t=!0),e=toUint8(e);var i=Yi(e,["moov","trak"],!0),r=[];return i.forEach(function(s){var a={bytes:s},o=Yi(s,["mdia"])[0],l=Yi(o,["hdlr"])[0],u=bytesToString(l.subarray(8,12));u==="soun"?a.type="audio":u==="vide"?a.type="video":a.type=u;var d=Yi(s,["tkhd"])[0];if(d){var h=new DataView(d.buffer,d.byteOffset,d.byteLength),v=h.getUint8(0);a.number=v===0?h.getUint32(12):h.getUint32(20)}var x=Yi(o,["mdhd"])[0];if(x){var _=x[0],R=_===0?12:20;a.timescale=(x[R]<<24|x[R+1]<<16|x[R+2]<<8|x[R+3])>>>0}for(var N=Yi(o,["minf","stbl"])[0],z=Yi(N,["stsd"])[0],J=bytesToNumber(z.subarray(4,8)),ue=8;J--;){var pe=bytesToNumber(z.subarray(ue,ue+4)),te=z.subarray(ue+4,ue+4+pe);Vu(a,te),ue+=4+pe}t&&(a.frameTable=Gu(N,a.timescale)),r.push(a)}),r},Nh=function(e){var t=Yi(e,["moov","mvhd"],!0)[0];if(!(!t||!t.length)){var i={};return t[0]===1?(i.timestampScale=bytesToNumber(t.subarray(20,24)),i.duration=bytesToNumber(t.subarray(24,32))):(i.timestampScale=bytesToNumber(t.subarray(12,16)),i.duration=bytesToNumber(t.subarray(16,20))),i.bytes=t,i}},oi={EBML:tt([26,69,223,163]),DocType:tt([66,130]),Segment:tt([24,83,128,103]),SegmentInfo:tt([21,73,169,102]),Tracks:tt([22,84,174,107]),Track:tt([174]),TrackNumber:tt([215]),DefaultDuration:tt([35,227,131]),TrackEntry:tt([174]),TrackType:tt([131]),FlagDefault:tt([136]),CodecID:tt([134]),CodecPrivate:tt([99,162]),VideoTrack:tt([224]),AudioTrack:tt([225]),Cluster:tt([31,67,182,117]),Timestamp:tt([231]),TimestampScale:tt([42,215,177]),BlockGroup:tt([160]),BlockDuration:tt([155]),Block:tt([161]),SimpleBlock:tt([163])},Va=[128,64,32,16,8,4,2,1],Hu=function(e){for(var t=1,i=0;i<Va.length&&!(e&Va[i]);i++)t++;return t},Dr=function(e,t,i,r){i===void 0&&(i=!0),r===void 0&&(r=!1);var s=Hu(e[t]),a=e.subarray(t,t+s);return i&&(a=Array.prototype.slice.call(e,t,t+s),a[0]^=Va[s-1]),{length:s,value:Ue(a,{signed:r}),bytes:a}},Uo=function n(e){return typeof e=="string"?e.match(/.{1,2}/g).map(function(t){return n(t)}):typeof e=="number"?Ae(e):e},Wu=function(e){return Array.isArray(e)?e.map(function(t){return Uo(t)}):[Uo(e)]},Cn=function n(e,t,i){if(i>=t.length)return t.length;var r=Dr(t,i,!1);if(ze(e.bytes,r.bytes))return i;var s=Dr(t,i+r.length);return n(e,t,i+s.length+s.value+r.length)},fi=function n(e,t){t=Wu(t),e=tt(e);var i=[];if(!t.length)return i;for(var r=0;r<e.length;){var s=Dr(e,r,!1),a=Dr(e,r+s.length),o=r+s.length+a.length;a.value===127&&(a.value=Cn(s,e,o),a.value!==e.length&&(a.value-=o));var l=o+a.value>e.length?e.length:o+a.value,u=e.subarray(o,l);ze(t[0],s.bytes)&&(t.length===1?i.push(u):i=i.concat(n(u,t.slice(1))));var d=s.length+a.length+u.length;r+=d}return i},Ku=function(e,t,i,r){var s;t==="group"&&(s=fi(e,[oi.BlockDuration])[0],s&&(s=bytesToNumber(s),s=1/i*s*i/1e3),e=fi(e,[oi.Block])[0],t="block");var a=new DataView(e.buffer,e.byteOffset,e.byteLength),o=Dr(e,0),l=a.getInt16(o.length,!1),u=e[o.length+2],d=e.subarray(o.length+3),h=1/i*(r+l)*i/1e3,v={duration:s,trackNumber:o.value,keyframe:t==="simple"&&u>>7==1,invisible:(u&8)>>3==1,lacing:(u&6)>>1,discardable:t==="simple"&&(u&1)==1,frames:[],pts:h,dts:h,timestamp:l};if(!v.lacing)return v.frames.push(d),v;var x=d[0]+1,_=[],R=1;if(v.lacing===2)for(var N=(d.length-R)/x,z=0;z<x;z++)_.push(N);if(v.lacing===1)for(var J=0;J<x-1;J++){var ue=0;do ue+=d[R],R++;while(d[R-1]===255);_.push(ue)}if(v.lacing===3)for(var pe=0,te=0;te<x-1;te++){var ke=te===0?Dr(d,R):Dr(d,R,!0,!0);pe+=ke.value,_.push(pe),R+=ke.length}return _.forEach(function(we){v.frames.push(d.subarray(R,R+we)),R+=we}),v},_s=function(e){for(var t=0,i={};t<e.length;){var r=e[t]&127,s=e[t+1],a=void 0;s===1?a=e[t+2]:a=e.subarray(t+2,t+2+s),r===1?i.profile=a:r===2?i.level=a:r===3?i.bitDepth=a:r===4?i.chromaSubsampling=a:i[r]=a,t+=2+s}return i},jo=function(e){e=toUint8(e);var t=[],i=fi(e,[oi.Segment,oi.Tracks,oi.Track]);return i.length||(i=fi(e,[oi.Tracks,oi.Track])),i.length||(i=fi(e,[oi.Track])),i.length?(i.forEach(function(r){var s=fi(r,oi.TrackType)[0];if(!(!s||!s.length)){if(s[0]===1)s="video";else if(s[0]===2)s="audio";else if(s[0]===17)s="subtitle";else return;var a={rawCodec:bytesToString(fi(r,[oi.CodecID])[0]),type:s,codecPrivate:fi(r,[oi.CodecPrivate])[0],number:bytesToNumber(fi(r,[oi.TrackNumber])[0]),defaultDuration:bytesToNumber(fi(r,[oi.DefaultDuration])[0]),default:fi(r,[oi.FlagDefault])[0],rawData:r},o="";if(/V_MPEG4\/ISO\/AVC/.test(a.rawCodec))o="avc1."+getAvcCodec(a.codecPrivate);else if(/V_MPEGH\/ISO\/HEVC/.test(a.rawCodec))o="hev1."+getHvcCodec(a.codecPrivate);else if(/V_MPEG4\/ISO\/ASP/.test(a.rawCodec))a.codecPrivate?o="mp4v.20."+a.codecPrivate[4].toString():o="mp4v.20.9";else if(/^V_THEORA/.test(a.rawCodec))o="theora";else if(/^V_VP8/.test(a.rawCodec))o="vp8";else if(/^V_VP9/.test(a.rawCodec))if(a.codecPrivate){var l=_s(a.codecPrivate),u=l.profile,d=l.level,h=l.bitDepth,v=l.chromaSubsampling;o="vp09.",o+=padStart(u,2,"0")+".",o+=padStart(d,2,"0")+".",o+=padStart(h,2,"0")+".",o+=""+padStart(v,2,"0");var x=fi(r,[224,[85,176],[85,177]])[0]||[],_=fi(r,[224,[85,176],[85,185]])[0]||[],R=fi(r,[224,[85,176],[85,186]])[0]||[],N=fi(r,[224,[85,176],[85,187]])[0]||[];(x.length||_.length||R.length||N.length)&&(o+="."+padStart(N[0],2,"0"),o+="."+padStart(R[0],2,"0"),o+="."+padStart(x[0],2,"0"),o+="."+padStart(_[0],2,"0"))}else o="vp9";else/^V_AV1/.test(a.rawCodec)?o="av01."+getAv1Codec(a.codecPrivate):/A_ALAC/.test(a.rawCodec)?o="alac":/A_MPEG\/L2/.test(a.rawCodec)?o="mp2":/A_MPEG\/L3/.test(a.rawCodec)?o="mp3":/^A_AAC/.test(a.rawCodec)?a.codecPrivate?o="mp4a.40."+(a.codecPrivate[0]>>>3).toString():o="mp4a.40.2":/^A_AC3/.test(a.rawCodec)?o="ac-3":/^A_PCM/.test(a.rawCodec)?o="pcm":/^A_MS\/ACM/.test(a.rawCodec)?o="speex":/^A_EAC3/.test(a.rawCodec)?o="ec-3":/^A_VORBIS/.test(a.rawCodec)?o="vorbis":/^A_FLAC/.test(a.rawCodec)?o="flac":/^A_OPUS/.test(a.rawCodec)&&(o="opus");a.codec=o,t.push(a)}}),t.sort(function(r,s){return r.number-s.number})):t},Uh=function(e,t){var i=[],r=fi(e,[oi.Segment])[0],s=fi(r,[oi.SegmentInfo,oi.TimestampScale])[0];s&&s.length?s=bytesToNumber(s):s=1e6;var a=fi(r,[oi.Cluster]);return t||(t=jo(r)),a.forEach(function(o,l){var u=fi(o,[oi.SimpleBlock]).map(function(x){return{type:"simple",data:x}}),d=fi(o,[oi.BlockGroup]).map(function(x){return{type:"group",data:x}}),h=fi(o,[oi.Timestamp])[0]||0;h&&h.length&&(h=bytesToNumber(h));var v=u.concat(d).sort(function(x,_){return x.data.byteOffset-_.data.byteOffset});v.forEach(function(x,_){var R=Ku(x.data,x.type,s,h);i.push(R)})}),{tracks:t,blocks:i}},$o=tt([0,0,0,1]),Jr=tt([0,0,1]),qu=tt([0,0,3]),zu=function(e){for(var t=[],i=1;i<e.length-2;)ze(e.subarray(i,i+3),qu)&&(t.push(i+2),i++),i++;if(t.length===0)return e;var r=e.length-t.length,s=new Uint8Array(r),a=0;for(i=0;i<r;a++,i++)a===t[0]&&(a++,t.shift()),s[i]=e[a];return s},Go=function(e,t,i,r){r===void 0&&(r=Infinity),e=tt(e),i=[].concat(i);for(var s=0,a,o=0;s<e.length&&(o<r||a);){var l=void 0;if(ze(e.subarray(s),$o)?l=4:ze(e.subarray(s),Jr)&&(l=3),!l){s++;continue}if(o++,a)return zu(e.subarray(a,s));var u=void 0;t==="h264"?u=e[s+l]&31:t==="h265"&&(u=e[s+l]>>1&63),i.indexOf(u)!==-1&&(a=s+l),s+=l+(t==="h264"?1:2)}return e.subarray(0,0)},xs=function(e,t,i){return Go(e,"h264",t,i)},Yu=function(e,t,i){return Go(e,"h265",t,i)},Hi={webm:tt([119,101,98,109]),matroska:tt([109,97,116,114,111,115,107,97]),flac:tt([102,76,97,67]),ogg:tt([79,103,103,83]),ac3:tt([11,119]),riff:tt([82,73,70,70]),avi:tt([65,86,73]),wav:tt([87,65,86,69]),"3gp":tt([102,116,121,112,51,103]),mp4:tt([102,116,121,112]),fmp4:tt([115,116,121,112]),mov:tt([102,116,121,112,113,116]),moov:tt([109,111,111,118]),moof:tt([109,111,111,102])},Mn={aac:function(e){var t=As(e);return ze(e,[255,16],{offset:t,mask:[255,22]})},mp3:function(e){var t=As(e);return ze(e,[255,2],{offset:t,mask:[255,6]})},webm:function(e){var t=fi(e,[oi.EBML,oi.DocType])[0];return ze(t,Hi.webm)},mkv:function(e){var t=fi(e,[oi.EBML,oi.DocType])[0];return ze(t,Hi.matroska)},mp4:function(e){if(Mn["3gp"](e)||Mn.mov(e))return!1;if(ze(e,Hi.mp4,{offset:4})||ze(e,Hi.fmp4,{offset:4})||ze(e,Hi.moof,{offset:4})||ze(e,Hi.moov,{offset:4}))return!0},mov:function(e){return ze(e,Hi.mov,{offset:4})},"3gp":function(e){return ze(e,Hi["3gp"],{offset:4})},ac3:function(e){var t=As(e);return ze(e,Hi.ac3,{offset:t})},ts:function(e){if(e.length<189&&e.length>=1)return e[0]===71;for(var t=0;t+188<e.length&&t<188;){if(e[t]===71&&e[t+188]===71)return!0;t+=1}return!1},flac:function(e){var t=As(e);return ze(e,Hi.flac,{offset:t})},ogg:function(e){return ze(e,Hi.ogg)},avi:function(e){return ze(e,Hi.riff)&&ze(e,Hi.avi,{offset:8})},wav:function(e){return ze(e,Hi.riff)&&ze(e,Hi.wav,{offset:8})},h264:function(e){return xs(e,7,3).length},h265:function(e){return Yu(e,[32,33],3).length}},Ha=Object.keys(Mn).filter(function(n){return n!=="ts"&&n!=="h264"&&n!=="h265"}).concat(["ts","h264","h265"]);Ha.forEach(function(n){var e=Mn[n];Mn[n]=function(t){return e(tt(t))}});var Xu=Mn,Wa=function(e){e=tt(e);for(var t=0;t<Ha.length;t++){var i=Ha[t];if(Xu[i](e))return i}return""},Es=function(e){return Yi(e,["moof"]).length>0},ea=Ne(51489);/**
 * @license
 * Video.js 8.3.0 <http://videojs.com/>
 * Copyright Brightcove, Inc. <https://www.brightcove.com/>
 * Available under Apache License Version 2.0
 * <https://github.com/videojs/video.js/blob/main/LICENSE>
 *
 * Includes vtt.js <https://github.com/mozilla/vtt.js>
 * Available under Apache License Version 2.0
 * <https://github.com/mozilla/vtt.js/blob/main/LICENSE>
 */var Vo="8.3.0";const Xn={},cn=function(n,e){return Xn[n]=Xn[n]||[],e&&(Xn[n]=Xn[n].concat(e)),Xn[n]},Qu=function(n,e){cn(n,e)},Ho=function(n,e){const t=cn(n).indexOf(e);return t<=-1?!1:(Xn[n]=Xn[n].slice(),Xn[n].splice(t,1),!0)},Zu=function(n,e){cn(n,[].concat(e).map(t=>{const i=(...r)=>(Ho(n,i),t(...r));return i}))},hr={prefixed:!0},ta=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],Wo=ta[0];let Ts;for(let n=0;n<ta.length;n++)if(ta[n][1]in Ee()){Ts=ta[n];break}if(Ts){for(let n=0;n<Ts.length;n++)hr[Wo[n]]=Ts[n];hr.prefixed=Ts[0]!==Wo[0]}let Oi=[];const Ju=(n,e)=>(t,i,r)=>{const s=e.levels[i],a=new RegExp(`^(${s})$`);if(t!=="log"&&r.unshift(t.toUpperCase()+":"),r.unshift(n+":"),Oi){Oi.push([].concat(r));const l=Oi.length-1e3;Oi.splice(0,l>0?l:0)}if(!q().console)return;let o=q().console[t];!o&&t==="debug"&&(o=q().console.info||q().console.log),!(!o||!s||!a.test(t))&&o[Array.isArray(r)?"apply":"call"](q().console,r)};function Ko(n){let e="info",t;const i=function(...r){t("log",e,r)};return t=Ju(n,i),i.createLogger=r=>Ko(n+": "+r),i.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:e},i.level=r=>{if(typeof r=="string"){if(!i.levels.hasOwnProperty(r))throw new Error(`"${r}" in not a valid log level`);e=r}return e},i.history=()=>Oi?[].concat(Oi):[],i.history.filter=r=>(Oi||[]).filter(s=>new RegExp(`.*${r}.*`).test(s[0])),i.history.clear=()=>{Oi&&(Oi.length=0)},i.history.disable=()=>{Oi!==null&&(Oi.length=0,Oi=null)},i.history.enable=()=>{Oi===null&&(Oi=[])},i.error=(...r)=>t("error",e,r),i.warn=(...r)=>t("warn",e,r),i.debug=(...r)=>t("debug",e,r),i}const Ut=Ko("VIDEOJS"),es=Ut.createLogger,ed=Object.prototype.toString,qo=function(n){return Nn(n)?Object.keys(n):[]};function ts(n,e){qo(n).forEach(t=>e(n[t],t))}function is(n,e,t=0){return qo(n).reduce((i,r)=>e(i,n[r],r),t)}function Nn(n){return!!n&&typeof n=="object"}function ns(n){return Nn(n)&&ed.call(n)==="[object Object]"&&n.constructor===Object}function Xt(...n){const e={};return n.forEach(t=>{!t||ts(t,(i,r)=>{if(!ns(i)){e[r]=i;return}ns(e[r])||(e[r]={}),e[r]=Xt(e[r],i)})}),e}function ia(n,e,t,i=!0){const r=a=>Object.defineProperty(n,e,{value:a,enumerable:!0,writable:!0}),s={configurable:!0,enumerable:!0,get(){const a=t();return r(a),a}};return i&&(s.set=r),Object.defineProperty(n,e,s)}var td=Object.freeze({__proto__:null,each:ts,reduce:is,isObject:Nn,isPlain:ns,merge:Xt,defineLazyProperty:ia});let Ka=!1,rs=null,Un=!1,Qn,qa=!1,fr=!1,ss=!1,jn=!1,kr=null,na=null,zo=null,ra=!1,pr=!1,sa=!1,aa=!1;const Ss=Boolean(os()&&("ontouchstart"in q()||q().navigator.maxTouchPoints||q().DocumentTouch&&q().document instanceof q().DocumentTouch)),$n=q().navigator&&q().navigator.userAgentData;if($n&&(Un=$n.platform==="Android",fr=Boolean($n.brands.find(n=>n.brand==="Microsoft Edge")),ss=Boolean($n.brands.find(n=>n.brand==="Chromium")),jn=!fr&&ss,kr=na=($n.brands.find(n=>n.brand==="Chromium")||{}).version||null,pr=$n.platform==="Windows"),!ss){const n=q().navigator&&q().navigator.userAgent||"";Ka=/iPod/i.test(n),rs=function(){const e=n.match(/OS (\d+)_/i);return e&&e[1]?e[1]:null}(),Un=/Android/i.test(n),Qn=function(){const e=n.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;const t=e[1]&&parseFloat(e[1]),i=e[2]&&parseFloat(e[2]);return t&&i?parseFloat(e[1]+"."+e[2]):t||null}(),qa=/Firefox/i.test(n),fr=/Edg/i.test(n),ss=/Chrome/i.test(n)||/CriOS/i.test(n),jn=!fr&&ss,kr=na=function(){const e=n.match(/(Chrome|CriOS)\/(\d+)/);return e&&e[2]?parseFloat(e[2]):null}(),zo=function(){const e=/MSIE\s(\d+)\.\d/.exec(n);let t=e&&parseFloat(e[1]);return!t&&/Trident\/7.0/i.test(n)&&/rv:11.0/.test(n)&&(t=11),t}(),ra=/Safari/i.test(n)&&!jn&&!Un&&!fr,pr=/Windows/i.test(n),sa=/iPad/i.test(n)||ra&&Ss&&!/iPhone/i.test(n),aa=/iPhone/i.test(n)&&!sa}const Wi=aa||sa||Ka,oa=(ra||Wi)&&!jn;var id=Object.freeze({__proto__:null,get IS_IPOD(){return Ka},get IOS_VERSION(){return rs},get IS_ANDROID(){return Un},get ANDROID_VERSION(){return Qn},get IS_FIREFOX(){return qa},get IS_EDGE(){return fr},get IS_CHROMIUM(){return ss},get IS_CHROME(){return jn},get CHROMIUM_VERSION(){return kr},get CHROME_VERSION(){return na},get IE_VERSION(){return zo},get IS_SAFARI(){return ra},get IS_WINDOWS(){return pr},get IS_IPAD(){return sa},get IS_IPHONE(){return aa},TOUCH_ENABLED:Ss,IS_IOS:Wi,IS_ANY_SAFARI:oa});function as(n){return typeof n=="string"&&Boolean(n.trim())}function nd(n){if(n.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}function os(){return Ee()===q().document}function ls(n){return Nn(n)&&n.nodeType===1}function us(){try{return q().parent!==q().self}catch(n){return!0}}function Yo(n){return function(e,t){if(!as(e))return Ee()[n](null);as(t)&&(t=Ee().querySelector(t));const i=ls(t)?t:Ee();return i[n]&&i[n](e)}}function Bt(n="div",e={},t={},i){const r=Ee().createElement(n);return Object.getOwnPropertyNames(e).forEach(function(s){const a=e[s];s==="textContent"?mr(r,a):(r[s]!==a||s==="tabIndex")&&(r[s]=a)}),Object.getOwnPropertyNames(t).forEach(function(s){r.setAttribute(s,t[s])}),i&&G(r,i),r}function mr(n,e){return typeof n.textContent=="undefined"?n.innerText=e:n.textContent=e,n}function za(n,e){e.firstChild?e.insertBefore(n,e.firstChild):e.appendChild(n)}function Cs(n,e){return nd(e),n.classList.contains(e)}function wn(n,...e){return n.classList.add(...e.reduce((t,i)=>t.concat(i.split(/\s+/)),[])),n}function ws(n,...e){return n?(n.classList.remove(...e.reduce((t,i)=>t.concat(i.split(/\s+/)),[])),n):(Ut.warn("removeClass was called with an element that doesn't exist"),null)}function Xo(n,e,t){return typeof t=="function"&&(t=t(n,e)),typeof t!="boolean"&&(t=void 0),e.split(/\s+/).forEach(i=>n.classList.toggle(i,t)),n}function Ya(n,e){Object.getOwnPropertyNames(e).forEach(function(t){const i=e[t];i===null||typeof i=="undefined"||i===!1?n.removeAttribute(t):n.setAttribute(t,i===!0?"":i)})}function Zn(n){const e={},t=",autoplay,controls,playsinline,loop,muted,default,defaultMuted,";if(n&&n.attributes&&n.attributes.length>0){const i=n.attributes;for(let r=i.length-1;r>=0;r--){const s=i[r].name;let a=i[r].value;(typeof n[s]=="boolean"||t.indexOf(","+s+",")!==-1)&&(a=a!==null),e[s]=a}}return e}function Xa(n,e){return n.getAttribute(e)}function Ln(n,e,t){n.setAttribute(e,t)}function la(n,e){n.removeAttribute(e)}function Qo(){Ee().body.focus(),Ee().onselectstart=function(){return!1}}function Zo(){Ee().onselectstart=function(){return!0}}function m(n){if(n&&n.getBoundingClientRect&&n.parentNode){const e=n.getBoundingClientRect(),t={};return["bottom","height","left","right","top","width"].forEach(i=>{e[i]!==void 0&&(t[i]=e[i])}),t.height||(t.height=parseFloat(Je(n,"height"))),t.width||(t.width=parseFloat(Je(n,"width"))),t}}function b(n){if(!n||n&&!n.offsetParent)return{left:0,top:0,width:0,height:0};const e=n.offsetWidth,t=n.offsetHeight;let i=0,r=0;for(;n.offsetParent&&n!==Ee()[hr.fullscreenElement];)i+=n.offsetLeft,r+=n.offsetTop,n=n.offsetParent;return{left:i,top:r,width:e,height:t}}function M(n,e){const t={x:0,y:0};if(Wi){let d=n;for(;d&&d.nodeName.toLowerCase()!=="html";){const h=Je(d,"transform");if(/^matrix/.test(h)){const v=h.slice(7,-1).split(/,\s/).map(Number);t.x+=v[4],t.y+=v[5]}else if(/^matrix3d/.test(h)){const v=h.slice(9,-1).split(/,\s/).map(Number);t.x+=v[12],t.y+=v[13]}d=d.parentNode}}const i={},r=b(e.target),s=b(n),a=s.width,o=s.height;let l=e.offsetY-(s.top-r.top),u=e.offsetX-(s.left-r.left);return e.changedTouches&&(u=e.changedTouches[0].pageX-s.left,l=e.changedTouches[0].pageY+s.top,Wi&&(u-=t.x,l-=t.y)),i.y=1-Math.max(0,Math.min(1,l/o)),i.x=Math.max(0,Math.min(1,u/a)),i}function p(n){return Nn(n)&&n.nodeType===3}function T(n){for(;n.firstChild;)n.removeChild(n.firstChild);return n}function L(n){return typeof n=="function"&&(n=n()),(Array.isArray(n)?n:[n]).map(e=>{if(typeof e=="function"&&(e=e()),ls(e)||p(e))return e;if(typeof e=="string"&&/\S/.test(e))return Ee().createTextNode(e)}).filter(e=>e)}function G(n,e){return L(e).forEach(t=>n.appendChild(t)),n}function re(n,e){return G(T(n),e)}function se(n){return n.button===void 0&&n.buttons===void 0||n.button===0&&n.buttons===void 0||n.type==="mouseup"&&n.button===0&&n.buttons===0?!0:!(n.button!==0||n.buttons!==1)}const Le=Yo("querySelector"),Me=Yo("querySelectorAll");function Je(n,e){if(!n||!e)return"";if(typeof q().getComputedStyle=="function"){let t;try{t=q().getComputedStyle(n)}catch(i){return""}return t?t.getPropertyValue(e)||t[e]:""}return""}var ot=Object.freeze({__proto__:null,isReal:os,isEl:ls,isInFrame:us,createEl:Bt,textContent:mr,prependTo:za,hasClass:Cs,addClass:wn,removeClass:ws,toggleClass:Xo,setAttributes:Ya,getAttributes:Zn,getAttribute:Xa,setAttribute:Ln,removeAttribute:la,blockTextSelection:Qo,unblockTextSelection:Zo,getBoundingClientRect:m,findPosition:b,getPointerPosition:M,isTextNode:p,emptyEl:T,normalizeContent:L,appendContent:G,insertContent:re,isSingleLeftClick:se,$:Le,$$:Me,computedStyle:Je});let ht=!1,ut;const it=function(){if(ut.options.autoSetup===!1)return;const n=Array.prototype.slice.call(Ee().getElementsByTagName("video")),e=Array.prototype.slice.call(Ee().getElementsByTagName("audio")),t=Array.prototype.slice.call(Ee().getElementsByTagName("video-js")),i=n.concat(e,t);if(i&&i.length>0)for(let r=0,s=i.length;r<s;r++){const a=i[r];if(a&&a.getAttribute)a.player===void 0&&a.getAttribute("data-setup")!==null&&ut(a);else{gt(1);break}}else ht||gt(1)};function gt(n,e){!os()||(e&&(ut=e),q().setTimeout(it,n))}function Et(){ht=!0,q().removeEventListener("load",Et)}os()&&(Ee().readyState==="complete"?Et():q().addEventListener("load",Et));const Ti=function(n){const e=Ee().createElement("style");return e.className=n,e},yi=function(n,e){n.styleSheet?n.styleSheet.cssText=e:n.textContent=e};var Rt=new WeakMap;let Rr=3;function Ki(){return Rr++}function ds(n,e){if(!Rt.has(n))return;const t=Rt.get(n);t.handlers[e].length===0&&(delete t.handlers[e],n.removeEventListener?n.removeEventListener(e,t.dispatcher,!1):n.detachEvent&&n.detachEvent("on"+e,t.dispatcher)),Object.getOwnPropertyNames(t.handlers).length<=0&&(delete t.handlers,delete t.dispatcher,delete t.disabled),Object.getOwnPropertyNames(t).length===0&&Rt.delete(n)}function ua(n,e,t,i){t.forEach(function(r){n(e,r,i)})}function Jo(n){if(n.fixed_)return n;function e(){return!0}function t(){return!1}if(!n||!n.isPropagationStopped||!n.isImmediatePropagationStopped){const i=n||q().event;n={};for(const r in i)r!=="layerX"&&r!=="layerY"&&r!=="keyLocation"&&r!=="webkitMovementX"&&r!=="webkitMovementY"&&r!=="path"&&(r==="returnValue"&&i.preventDefault||(n[r]=i[r]));if(n.target||(n.target=n.srcElement||Ee()),n.relatedTarget||(n.relatedTarget=n.fromElement===n.target?n.toElement:n.fromElement),n.preventDefault=function(){i.preventDefault&&i.preventDefault(),n.returnValue=!1,i.returnValue=!1,n.defaultPrevented=!0},n.defaultPrevented=!1,n.stopPropagation=function(){i.stopPropagation&&i.stopPropagation(),n.cancelBubble=!0,i.cancelBubble=!0,n.isPropagationStopped=e},n.isPropagationStopped=t,n.stopImmediatePropagation=function(){i.stopImmediatePropagation&&i.stopImmediatePropagation(),n.isImmediatePropagationStopped=e,n.stopPropagation()},n.isImmediatePropagationStopped=t,n.clientX!==null&&n.clientX!==void 0){const r=Ee().documentElement,s=Ee().body;n.pageX=n.clientX+(r&&r.scrollLeft||s&&s.scrollLeft||0)-(r&&r.clientLeft||s&&s.clientLeft||0),n.pageY=n.clientY+(r&&r.scrollTop||s&&s.scrollTop||0)-(r&&r.clientTop||s&&s.clientTop||0)}n.which=n.charCode||n.keyCode,n.button!==null&&n.button!==void 0&&(n.button=n.button&1?0:n.button&4?1:n.button&2?2:0)}return n.fixed_=!0,n}let el;const Zg=function(){if(typeof el!="boolean"){el=!1;try{const n=Object.defineProperty({},"passive",{get(){el=!0}});q().addEventListener("test",null,n),q().removeEventListener("test",null,n)}catch(n){}}return el},Jg=["touchstart","touchmove"];function Dn(n,e,t){if(Array.isArray(e))return ua(Dn,n,e,t);Rt.has(n)||Rt.set(n,{});const i=Rt.get(n);if(i.handlers||(i.handlers={}),i.handlers[e]||(i.handlers[e]=[]),t.guid||(t.guid=Ki()),i.handlers[e].push(t),i.dispatcher||(i.disabled=!1,i.dispatcher=function(r,s){if(i.disabled)return;r=Jo(r);const a=i.handlers[r.type];if(a){const o=a.slice(0);for(let l=0,u=o.length;l<u&&!r.isImmediatePropagationStopped();l++)try{o[l].call(n,r,s)}catch(d){Ut.error(d)}}}),i.handlers[e].length===1)if(n.addEventListener){let r=!1;Zg()&&Jg.indexOf(e)>-1&&(r={passive:!0}),n.addEventListener(e,i.dispatcher,r)}else n.attachEvent&&n.attachEvent("on"+e,i.dispatcher)}function Xi(n,e,t){if(!Rt.has(n))return;const i=Rt.get(n);if(!i.handlers)return;if(Array.isArray(e))return ua(Xi,n,e,t);const r=function(a,o){i.handlers[o]=[],ds(a,o)};if(e===void 0){for(const a in i.handlers)Object.prototype.hasOwnProperty.call(i.handlers||{},a)&&r(n,a);return}const s=i.handlers[e];if(!!s){if(!t){r(n,e);return}if(t.guid)for(let a=0;a<s.length;a++)s[a].guid===t.guid&&s.splice(a--,1);ds(n,e)}}function da(n,e,t){const i=Rt.has(n)?Rt.get(n):{},r=n.parentNode||n.ownerDocument;if(typeof e=="string"?e={type:e,target:n}:e.target||(e.target=n),e=Jo(e),i.dispatcher&&i.dispatcher.call(n,e,t),r&&!e.isPropagationStopped()&&e.bubbles===!0)da.call(null,r,e,t);else if(!r&&!e.defaultPrevented&&e.target&&e.target[e.type]){Rt.has(e.target)||Rt.set(e.target,{});const s=Rt.get(e.target);e.target[e.type]&&(s.disabled=!0,typeof e.target[e.type]=="function"&&e.target[e.type](),s.disabled=!1)}return!e.defaultPrevented}function tl(n,e,t){if(Array.isArray(e))return ua(tl,n,e,t);const i=function(){Xi(n,e,i),t.apply(this,arguments)};i.guid=t.guid=t.guid||Ki(),Dn(n,e,i)}function rd(n,e,t){const i=function(){Xi(n,e,i),t.apply(this,arguments)};i.guid=t.guid=t.guid||Ki(),Dn(n,e,i)}var ey=Object.freeze({__proto__:null,fixEvent:Jo,on:Dn,off:Xi,trigger:da,one:tl,any:rd});const Gn=30,ui=function(n,e,t){e.guid||(e.guid=Ki());const i=e.bind(n);return i.guid=t?t+"_"+e.guid:e.guid,i},gr=function(n,e){let t=q().performance.now();return function(...r){const s=q().performance.now();s-t>=e&&(n(...r),t=s)}},jh=function(n,e,t,i=q()){let r;const s=()=>{i.clearTimeout(r),r=null},a=function(){const o=this,l=arguments;let u=function(){r=null,u=null,t||n.apply(o,l)};!r&&t&&n.apply(o,l),i.clearTimeout(r),r=i.setTimeout(u,e)};return a.cancel=s,a};var ty=Object.freeze({__proto__:null,UPDATE_REFRESH_INTERVAL:Gn,bind_:ui,throttle:gr,debounce:jh});let Qa;class Vn{on(e,t){const i=this.addEventListener;this.addEventListener=()=>{},Dn(this,e,t),this.addEventListener=i}off(e,t){Xi(this,e,t)}one(e,t){const i=this.addEventListener;this.addEventListener=()=>{},tl(this,e,t),this.addEventListener=i}any(e,t){const i=this.addEventListener;this.addEventListener=()=>{},rd(this,e,t),this.addEventListener=i}trigger(e){const t=e.type||e;typeof e=="string"&&(e={type:t}),e=Jo(e),this.allowedEvents_[t]&&this["on"+t]&&this["on"+t](e),da(this,e)}queueTrigger(e){Qa||(Qa=new Map);const t=e.type||e;let i=Qa.get(this);i||(i=new Map,Qa.set(this,i));const r=i.get(t);i.delete(t),q().clearTimeout(r);const s=q().setTimeout(()=>{i.delete(t),i.size===0&&(i=null,Qa.delete(this)),this.trigger(e)},0);i.set(t,s)}}Vn.prototype.allowedEvents_={},Vn.prototype.addEventListener=Vn.prototype.on,Vn.prototype.removeEventListener=Vn.prototype.off,Vn.prototype.dispatchEvent=Vn.prototype.trigger;const il=n=>typeof n.name=="function"?n.name():typeof n.name=="string"?n.name:n.name_?n.name_:n.constructor&&n.constructor.name?n.constructor.name:typeof n,Or=n=>n instanceof Vn||!!n.eventBusEl_&&["on","one","off","trigger"].every(e=>typeof n[e]=="function"),iy=(n,e)=>{Or(n)?e():(n.eventedCallbacks||(n.eventedCallbacks=[]),n.eventedCallbacks.push(e))},sd=n=>typeof n=="string"&&/\S/.test(n)||Array.isArray(n)&&!!n.length,nl=(n,e,t)=>{if(!n||!n.nodeName&&!Or(n))throw new Error(`Invalid target for ${il(e)}#${t}; must be a DOM node or evented object.`)},$h=(n,e,t)=>{if(!sd(n))throw new Error(`Invalid event type for ${il(e)}#${t}; must be a non-empty string or array.`)},Gh=(n,e,t)=>{if(typeof n!="function")throw new Error(`Invalid listener for ${il(e)}#${t}; must be a function.`)},ad=(n,e,t)=>{const i=e.length<3||e[0]===n||e[0]===n.eventBusEl_;let r,s,a;return i?(r=n.eventBusEl_,e.length>=3&&e.shift(),[s,a]=e):[r,s,a]=e,nl(r,n,t),$h(s,n,t),Gh(a,n,t),a=ui(n,a),{isTargetingSelf:i,target:r,type:s,listener:a}},Ls=(n,e,t,i)=>{nl(n,n,e),n.nodeName?ey[e](n,t,i):n[e](t,i)},ny={on(...n){const{isTargetingSelf:e,target:t,type:i,listener:r}=ad(this,n,"on");if(Ls(t,"on",i,r),!e){const s=()=>this.off(t,i,r);s.guid=r.guid;const a=()=>this.off("dispose",s);a.guid=r.guid,Ls(this,"on","dispose",s),Ls(t,"on","dispose",a)}},one(...n){const{isTargetingSelf:e,target:t,type:i,listener:r}=ad(this,n,"one");if(e)Ls(t,"one",i,r);else{const s=(...a)=>{this.off(t,i,s),r.apply(null,a)};s.guid=r.guid,Ls(t,"one",i,s)}},any(...n){const{isTargetingSelf:e,target:t,type:i,listener:r}=ad(this,n,"any");if(e)Ls(t,"any",i,r);else{const s=(...a)=>{this.off(t,i,s),r.apply(null,a)};s.guid=r.guid,Ls(t,"any",i,s)}},off(n,e,t){if(!n||sd(n))Xi(this.eventBusEl_,n,e);else{const i=n,r=e;nl(i,this,"off"),$h(r,this,"off"),Gh(t,this,"off"),t=ui(this,t),this.off("dispose",t),i.nodeName?(Xi(i,r,t),Xi(i,"dispose",t)):Or(i)&&(i.off(r,t),i.off("dispose",t))}},trigger(n,e){nl(this.eventBusEl_,this,"trigger");const t=n&&typeof n!="string"?n.type:n;if(!sd(t))throw new Error(`Invalid event type for ${il(this)}#trigger; must be a non-empty string or object with a type key that has a non-empty value.`);return da(this.eventBusEl_,n,e)}};function od(n,e={}){const{eventBusKey:t}=e;if(t){if(!n[t].nodeName)throw new Error(`The eventBusKey "${t}" does not refer to an element.`);n.eventBusEl_=n[t]}else n.eventBusEl_=Bt("span",{className:"vjs-event-bus"});return Object.assign(n,ny),n.eventedCallbacks&&n.eventedCallbacks.forEach(i=>{i()}),n.on("dispose",()=>{n.off(),[n,n.el_,n.eventBusEl_].forEach(function(i){i&&Rt.has(i)&&Rt.delete(i)}),q().setTimeout(()=>{n.eventBusEl_=null},0)}),n}const ry={state:{},setState(n){typeof n=="function"&&(n=n());let e;return ts(n,(t,i)=>{this.state[i]!==t&&(e=e||{},e[i]={from:this.state[i],to:t}),this.state[i]=t}),e&&Or(this)&&this.trigger({changes:e,type:"statechanged"}),e}};function Vh(n,e){return Object.assign(n,ry),n.state=Object.assign({},n.state,e),typeof n.handleStateChanged=="function"&&Or(n)&&n.on("statechanged",n.handleStateChanged),n}const Za=function(n){return typeof n!="string"?n:n.replace(/./,e=>e.toLowerCase())},Si=function(n){return typeof n!="string"?n:n.replace(/./,e=>e.toUpperCase())},Hh=function(n,e){return Si(n)===Si(e)};var sy=Object.freeze({__proto__:null,toLowerCase:Za,toTitleCase:Si,titleCaseEquals:Hh});class $e{constructor(e,t,i){if(!e&&this.play?this.player_=e=this:this.player_=e,this.isDisposed_=!1,this.parentComponent_=null,this.options_=Xt({},this.options_),t=this.options_=Xt(this.options_,t),this.id_=t.id||t.el&&t.el.id,!this.id_){const r=e&&e.id&&e.id()||"no_player";this.id_=`${r}_component_${Ki()}`}this.name_=t.name||null,t.el?this.el_=t.el:t.createEl!==!1&&(this.el_=this.createEl()),t.className&&this.el_&&t.className.split(" ").forEach(r=>this.addClass(r)),["on","off","one","any","trigger"].forEach(r=>{this[r]=void 0}),t.evented!==!1&&(od(this,{eventBusKey:this.el_?"el_":null}),this.handleLanguagechange=this.handleLanguagechange.bind(this),this.on(this.player_,"languagechange",this.handleLanguagechange)),Vh(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Set,this.setIntervalIds_=new Set,this.rafIds_=new Set,this.namedRafs_=new Map,this.clearingTimersOnDispose_=!1,t.initChildren!==!1&&this.initChildren(),this.ready(i),t.reportTouchActivity!==!1&&this.enableTouchActivity()}on(e,t){}off(e,t){}one(e,t){}any(e,t){}trigger(e){}dispose(e={}){if(!this.isDisposed_){if(this.readyQueue_&&(this.readyQueue_.length=0),this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(let t=this.children_.length-1;t>=0;t--)this.children_[t].dispose&&this.children_[t].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&(e.restoreEl?this.el_.parentNode.replaceChild(e.restoreEl,this.el_):this.el_.parentNode.removeChild(this.el_)),this.el_=null),this.player_=null}}isDisposed(){return Boolean(this.isDisposed_)}player(){return this.player_}options(e){return e?(this.options_=Xt(this.options_,e),this.options_):this.options_}el(){return this.el_}createEl(e,t,i){return Bt(e,t,i)}localize(e,t,i=e){const r=this.player_.language&&this.player_.language(),s=this.player_.languages&&this.player_.languages(),a=s&&s[r],o=r&&r.split("-")[0],l=s&&s[o];let u=i;return a&&a[e]?u=a[e]:l&&l[e]&&(u=l[e]),t&&(u=u.replace(/\{(\d+)\}/g,function(d,h){const v=t[h-1];let x=v;return typeof v=="undefined"&&(x=d),x})),u}handleLanguagechange(){}contentEl(){return this.contentEl_||this.el_}id(){return this.id_}name(){return this.name_}children(){return this.children_}getChildById(e){return this.childIndex_[e]}getChild(e){if(!!e)return this.childNameIndex_[e]}getDescendant(...e){e=e.reduce((i,r)=>i.concat(r),[]);let t=this;for(let i=0;i<e.length;i++)if(t=t.getChild(e[i]),!t||!t.getChild)return;return t}addChild(e,t={},i=this.children_.length){let r,s;if(typeof e=="string"){s=Si(e);const a=t.componentClass||s;t.name=s;const o=$e.getComponent(a);if(!o)throw new Error(`Component ${a} does not exist`);if(typeof o!="function")return null;r=new o(this.player_||this,t)}else r=e;if(r.parentComponent_&&r.parentComponent_.removeChild(r),this.children_.splice(i,0,r),r.parentComponent_=this,typeof r.id=="function"&&(this.childIndex_[r.id()]=r),s=s||r.name&&Si(r.name()),s&&(this.childNameIndex_[s]=r,this.childNameIndex_[Za(s)]=r),typeof r.el=="function"&&r.el()){let a=null;this.children_[i+1]&&(this.children_[i+1].el_?a=this.children_[i+1].el_:ls(this.children_[i+1])&&(a=this.children_[i+1])),this.contentEl().insertBefore(r.el(),a)}return r}removeChild(e){if(typeof e=="string"&&(e=this.getChild(e)),!e||!this.children_)return;let t=!1;for(let r=this.children_.length-1;r>=0;r--)if(this.children_[r]===e){t=!0,this.children_.splice(r,1);break}if(!t)return;e.parentComponent_=null,this.childIndex_[e.id()]=null,this.childNameIndex_[Si(e.name())]=null,this.childNameIndex_[Za(e.name())]=null;const i=e.el();i&&i.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}initChildren(){const e=this.options_.children;if(e){const t=this.options_,i=a=>{const o=a.name;let l=a.opts;if(t[o]!==void 0&&(l=t[o]),l===!1)return;l===!0&&(l={}),l.playerOptions=this.options_.playerOptions;const u=this.addChild(o,l);u&&(this[o]=u)};let r;const s=$e.getComponent("Tech");Array.isArray(e)?r=e:r=Object.keys(e),r.concat(Object.keys(this.options_).filter(function(a){return!r.some(function(o){return typeof o=="string"?a===o:a===o.name})})).map(a=>{let o,l;return typeof a=="string"?(o=a,l=e[o]||this.options_[o]||{}):(o=a.name,l=a),{name:o,opts:l}}).filter(a=>{const o=$e.getComponent(a.opts.componentClass||Si(a.name));return o&&!s.isTech(o)}).forEach(i)}}buildCSSClass(){return""}ready(e,t=!1){if(!!e){if(!this.isReady_){this.readyQueue_=this.readyQueue_||[],this.readyQueue_.push(e);return}t?e.call(this):this.setTimeout(e,1)}}triggerReady(){this.isReady_=!0,this.setTimeout(function(){const e=this.readyQueue_;this.readyQueue_=[],e&&e.length>0&&e.forEach(function(t){t.call(this)},this),this.trigger("ready")},1)}$(e,t){return Le(e,t||this.contentEl())}$$(e,t){return Me(e,t||this.contentEl())}hasClass(e){return Cs(this.el_,e)}addClass(...e){wn(this.el_,...e)}removeClass(...e){ws(this.el_,...e)}toggleClass(e,t){Xo(this.el_,e,t)}show(){this.removeClass("vjs-hidden")}hide(){this.addClass("vjs-hidden")}lockShowing(){this.addClass("vjs-lock-showing")}unlockShowing(){this.removeClass("vjs-lock-showing")}getAttribute(e){return Xa(this.el_,e)}setAttribute(e,t){Ln(this.el_,e,t)}removeAttribute(e){la(this.el_,e)}width(e,t){return this.dimension("width",e,t)}height(e,t){return this.dimension("height",e,t)}dimensions(e,t){this.width(e,!0),this.height(t)}dimension(e,t,i){if(t!==void 0){(t===null||t!==t)&&(t=0),(""+t).indexOf("%")!==-1||(""+t).indexOf("px")!==-1?this.el_.style[e]=t:t==="auto"?this.el_.style[e]="":this.el_.style[e]=t+"px",i||this.trigger("componentresize");return}if(!this.el_)return 0;const r=this.el_.style[e],s=r.indexOf("px");return parseInt(s!==-1?r.slice(0,s):this.el_["offset"+Si(e)],10)}currentDimension(e){let t=0;if(e!=="width"&&e!=="height")throw new Error("currentDimension only accepts width or height value");if(t=Je(this.el_,e),t=parseFloat(t),t===0||isNaN(t)){const i=`offset${Si(e)}`;t=this.el_[i]}return t}currentDimensions(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}}currentWidth(){return this.currentDimension("width")}currentHeight(){return this.currentDimension("height")}focus(){this.el_.focus()}blur(){this.el_.blur()}handleKeyDown(e){this.player_&&(ce().isEventKey(e,"Tab")||e.stopPropagation(),this.player_.handleKeyDown(e))}handleKeyPress(e){this.handleKeyDown(e)}emitTapEvents(){let e=0,t=null;const i=10,r=200;let s;this.on("touchstart",function(o){o.touches.length===1&&(t={pageX:o.touches[0].pageX,pageY:o.touches[0].pageY},e=q().performance.now(),s=!0)}),this.on("touchmove",function(o){if(o.touches.length>1)s=!1;else if(t){const l=o.touches[0].pageX-t.pageX,u=o.touches[0].pageY-t.pageY;Math.sqrt(l*l+u*u)>i&&(s=!1)}});const a=function(){s=!1};this.on("touchleave",a),this.on("touchcancel",a),this.on("touchend",function(o){t=null,s===!0&&q().performance.now()-e<r&&(o.preventDefault(),this.trigger("tap"))})}enableTouchActivity(){if(!this.player()||!this.player().reportUserActivity)return;const e=ui(this.player(),this.player().reportUserActivity);let t;this.on("touchstart",function(){e(),this.clearInterval(t),t=this.setInterval(e,250)});const i=function(r){e(),this.clearInterval(t)};this.on("touchmove",e),this.on("touchend",i),this.on("touchcancel",i)}setTimeout(e,t){var i;return e=ui(this,e),this.clearTimersOnDispose_(),i=q().setTimeout(()=>{this.setTimeoutIds_.has(i)&&this.setTimeoutIds_.delete(i),e()},t),this.setTimeoutIds_.add(i),i}clearTimeout(e){return this.setTimeoutIds_.has(e)&&(this.setTimeoutIds_.delete(e),q().clearTimeout(e)),e}setInterval(e,t){e=ui(this,e),this.clearTimersOnDispose_();const i=q().setInterval(e,t);return this.setIntervalIds_.add(i),i}clearInterval(e){return this.setIntervalIds_.has(e)&&(this.setIntervalIds_.delete(e),q().clearInterval(e)),e}requestAnimationFrame(e){this.clearTimersOnDispose_();var t;return e=ui(this,e),t=q().requestAnimationFrame(()=>{this.rafIds_.has(t)&&this.rafIds_.delete(t),e()}),this.rafIds_.add(t),t}requestNamedAnimationFrame(e,t){if(this.namedRafs_.has(e))return;this.clearTimersOnDispose_(),t=ui(this,t);const i=this.requestAnimationFrame(()=>{t(),this.namedRafs_.has(e)&&this.namedRafs_.delete(e)});return this.namedRafs_.set(e,i),e}cancelNamedAnimationFrame(e){!this.namedRafs_.has(e)||(this.cancelAnimationFrame(this.namedRafs_.get(e)),this.namedRafs_.delete(e))}cancelAnimationFrame(e){return this.rafIds_.has(e)&&(this.rafIds_.delete(e),q().cancelAnimationFrame(e)),e}clearTimersOnDispose_(){this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",()=>{[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(([e,t])=>{this[e].forEach((i,r)=>this[t](r))}),this.clearingTimersOnDispose_=!1}))}static registerComponent(e,t){if(typeof e!="string"||!e)throw new Error(`Illegal component name, "${e}"; must be a non-empty string.`);const i=$e.getComponent("Tech"),r=i&&i.isTech(t),s=$e===t||$e.prototype.isPrototypeOf(t.prototype);if(r||!s){let o;throw r?o="techs must be registered using Tech.registerTech()":o="must be a Component subclass",new Error(`Illegal component, "${e}"; ${o}.`)}e=Si(e),$e.components_||($e.components_={});const a=$e.getComponent("Player");if(e==="Player"&&a&&a.players){const o=a.players,l=Object.keys(o);if(o&&l.length>0&&l.map(u=>o[u]).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return $e.components_[e]=t,$e.components_[Za(e)]=t,t}static getComponent(e){if(!(!e||!$e.components_))return $e.components_[e]}}$e.registerComponent("Component",$e);function ay(n,e,t){if(typeof e!="number"||e<0||e>t)throw new Error(`Failed to execute '${n}' on 'TimeRanges': The index provided (${e}) is non-numeric or out of bounds (0-${t}).`)}function Wh(n,e,t,i){return ay(n,i,t.length-1),t[i][e]}function ld(n){let e;return n===void 0||n.length===0?e={length:0,start(){throw new Error("This TimeRanges object is empty")},end(){throw new Error("This TimeRanges object is empty")}}:e={length:n.length,start:Wh.bind(null,"start",0,n),end:Wh.bind(null,"end",1,n)},q().Symbol&&q().Symbol.iterator&&(e[q().Symbol.iterator]=()=>(n||[]).values()),e}function yr(n,e){return Array.isArray(n)?ld(n):n===void 0||e===void 0?ld():ld([[n,e]])}const Kh=function(n,e){n=n<0?0:n;let t=Math.floor(n%60),i=Math.floor(n/60%60),r=Math.floor(n/3600);const s=Math.floor(e/60%60),a=Math.floor(e/3600);return(isNaN(n)||n===Infinity)&&(r=i=t="-"),r=r>0||a>0?r+":":"",i=((r||s>=10)&&i<10?"0"+i:i)+":",t=t<10?"0"+t:t,r+i+t};let ud=Kh;function qh(n){ud=n}function zh(){ud=Kh}function Ds(n,e=n){return ud(n,e)}var oy=Object.freeze({__proto__:null,createTimeRanges:yr,createTimeRange:yr,setFormatTime:qh,resetFormatTime:zh,formatTime:Ds});function Yh(n,e){let t=0,i,r;if(!e)return 0;(!n||!n.length)&&(n=yr(0,0));for(let s=0;s<n.length;s++)i=n.start(s),r=n.end(s),r>e&&(r=e),t+=r-i;return t/e}function sn(n){if(n instanceof sn)return n;typeof n=="number"?this.code=n:typeof n=="string"?this.message=n:Nn(n)&&(typeof n.code=="number"&&(this.code=n.code),Object.assign(this,n)),this.message||(this.message=sn.defaultMessages[this.code]||"")}sn.prototype.code=0,sn.prototype.message="",sn.prototype.status=null,sn.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],sn.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(let n=0;n<sn.errorTypes.length;n++)sn[sn.errorTypes[n]]=n,sn.prototype[sn.errorTypes[n]]=n;function Ja(n){return n!=null&&typeof n.then=="function"}function vr(n){Ja(n)&&n.then(null,e=>{})}const dd=function(n){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce((t,i,r)=>(n[i]&&(t[i]=n[i]),t),{cues:n.cues&&Array.prototype.map.call(n.cues,function(t){return{startTime:t.startTime,endTime:t.endTime,text:t.text,id:t.id}})})};var Xh={textTracksToJson:function(n){const e=n.$$("track"),t=Array.prototype.map.call(e,r=>r.track);return Array.prototype.map.call(e,function(r){const s=dd(r.track);return r.src&&(s.src=r.src),s}).concat(Array.prototype.filter.call(n.textTracks(),function(r){return t.indexOf(r)===-1}).map(dd))},jsonToTextTracks:function(n,e){return n.forEach(function(t){const i=e.addRemoteTextTrack(t).track;!t.src&&t.cues&&t.cues.forEach(r=>i.addCue(r))}),e.textTracks()},trackToJson_:dd};const cd="vjs-modal-dialog";class ca extends $e{constructor(e,t){super(e,t);this.handleKeyDown_=i=>this.handleKeyDown(i),this.close_=i=>this.close(i),this.opened_=this.hasBeenOpened_=this.hasBeenFilled_=!1,this.closeable(!this.options_.uncloseable),this.content(this.options_.content),this.contentEl_=Bt("div",{className:`${cd}-content`},{role:"document"}),this.descEl_=Bt("p",{className:`${cd}-description vjs-control-text`,id:this.el().getAttribute("aria-describedby")}),mr(this.descEl_,this.description()),this.el_.appendChild(this.descEl_),this.el_.appendChild(this.contentEl_)}createEl(){return super.createEl("div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":`${this.id()}_description`,"aria-hidden":"true","aria-label":this.label(),role:"dialog"})}dispose(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,super.dispose()}buildCSSClass(){return`${cd} vjs-hidden ${super.buildCSSClass()}`}label(){return this.localize(this.options_.label||"Modal Window")}description(){let e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e}open(){if(!this.opened_){const e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.on("keydown",this.handleKeyDown_),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}}opened(e){return typeof e=="boolean"&&this[e?"open":"close"](),this.opened_}close(){if(!this.opened_)return;const e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.off("keydown",this.handleKeyDown_),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}closeable(e){if(typeof e=="boolean"){const t=this.closeable_=!!e;let i=this.getChild("closeButton");if(t&&!i){const r=this.contentEl_;this.contentEl_=this.el_,i=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=r,this.on(i,"close",this.close_)}!t&&i&&(this.off(i,"close",this.close_),this.removeChild(i),i.dispose())}return this.closeable_}fill(){this.fillWith(this.content())}fillWith(e){const t=this.contentEl(),i=t.parentNode,r=t.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,i.removeChild(t),this.empty(),re(t,e),this.trigger("modalfill"),r?i.insertBefore(t,r):i.appendChild(t);const s=this.getChild("closeButton");s&&i.appendChild(s.el_)}empty(){this.trigger("beforemodalempty"),T(this.contentEl()),this.trigger("modalempty")}content(e){return typeof e!="undefined"&&(this.content_=e),this.content_}conditionalFocus_(){const e=Ee().activeElement,t=this.player_.el_;this.previouslyActiveEl_=null,(t.contains(e)||t===e)&&(this.previouslyActiveEl_=e,this.focus())}conditionalBlur_(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)}handleKeyDown(e){if(e.stopPropagation(),ce().isEventKey(e,"Escape")&&this.closeable()){e.preventDefault(),this.close();return}if(!ce().isEventKey(e,"Tab"))return;const t=this.focusableEls_(),i=this.el_.querySelector(":focus");let r;for(let s=0;s<t.length;s++)if(i===t[s]){r=s;break}Ee().activeElement===this.el_&&(r=0),e.shiftKey&&r===0?(t[t.length-1].focus(),e.preventDefault()):!e.shiftKey&&r===t.length-1&&(t[0].focus(),e.preventDefault())}focusableEls_(){const e=this.el_.querySelectorAll("*");return Array.prototype.filter.call(e,t=>(t instanceof q().HTMLAnchorElement||t instanceof q().HTMLAreaElement)&&t.hasAttribute("href")||(t instanceof q().HTMLInputElement||t instanceof q().HTMLSelectElement||t instanceof q().HTMLTextAreaElement||t instanceof q().HTMLButtonElement)&&!t.hasAttribute("disabled")||t instanceof q().HTMLIFrameElement||t instanceof q().HTMLObjectElement||t instanceof q().HTMLEmbedElement||t.hasAttribute("tabindex")&&t.getAttribute("tabindex")!==-1||t.hasAttribute("contenteditable"))}}ca.prototype.options_={pauseOnOpen:!0,temporary:!0},$e.registerComponent("ModalDialog",ca);class ha extends Vn{constructor(e=[]){super();this.tracks_=[],Object.defineProperty(this,"length",{get(){return this.tracks_.length}});for(let t=0;t<e.length;t++)this.addTrack(e[t])}addTrack(e){const t=this.tracks_.length;""+t in this||Object.defineProperty(this,t,{get(){return this.tracks_[t]}}),this.tracks_.indexOf(e)===-1&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack",target:this})),e.labelchange_=()=>{this.trigger({track:e,type:"labelchange",target:this})},Or(e)&&e.addEventListener("labelchange",e.labelchange_)}removeTrack(e){let t;for(let i=0,r=this.length;i<r;i++)if(this[i]===e){t=this[i],t.off&&t.off(),this.tracks_.splice(i,1);break}!t||this.trigger({track:t,type:"removetrack",target:this})}getTrackById(e){let t=null;for(let i=0,r=this.length;i<r;i++){const s=this[i];if(s.id===e){t=s;break}}return t}}ha.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"};for(const n in ha.prototype.allowedEvents_)ha.prototype["on"+n]=null;const hd=function(n,e){for(let t=0;t<n.length;t++)!Object.keys(n[t]).length||e.id===n[t].id||(n[t].enabled=!1)};class ly extends ha{constructor(e=[]){for(let t=e.length-1;t>=0;t--)if(e[t].enabled){hd(e,e[t]);break}super(e);this.changing_=!1}addTrack(e){e.enabled&&hd(this,e),super.addTrack(e),!!e.addEventListener&&(e.enabledChange_=()=>{this.changing_||(this.changing_=!0,hd(this,e),this.changing_=!1,this.trigger("change"))},e.addEventListener("enabledchange",e.enabledChange_))}removeTrack(e){super.removeTrack(e),e.removeEventListener&&e.enabledChange_&&(e.removeEventListener("enabledchange",e.enabledChange_),e.enabledChange_=null)}}const fd=function(n,e){for(let t=0;t<n.length;t++)!Object.keys(n[t]).length||e.id===n[t].id||(n[t].selected=!1)};class uy extends ha{constructor(e=[]){for(let t=e.length-1;t>=0;t--)if(e[t].selected){fd(e,e[t]);break}super(e);this.changing_=!1,Object.defineProperty(this,"selectedIndex",{get(){for(let t=0;t<this.length;t++)if(this[t].selected)return t;return-1},set(){}})}addTrack(e){e.selected&&fd(this,e),super.addTrack(e),!!e.addEventListener&&(e.selectedChange_=()=>{this.changing_||(this.changing_=!0,fd(this,e),this.changing_=!1,this.trigger("change"))},e.addEventListener("selectedchange",e.selectedChange_))}removeTrack(e){super.removeTrack(e),e.removeEventListener&&e.selectedChange_&&(e.removeEventListener("selectedchange",e.selectedChange_),e.selectedChange_=null)}}class Qh extends ha{addTrack(e){super.addTrack(e),this.queueChange_||(this.queueChange_=()=>this.queueTrigger("change")),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=()=>this.trigger("selectedlanguagechange")),e.addEventListener("modechange",this.queueChange_),["metadata","chapters"].indexOf(e.kind)===-1&&e.addEventListener("modechange",this.triggerSelectedlanguagechange_)}removeTrack(e){super.removeTrack(e),e.removeEventListener&&(this.queueChange_&&e.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&e.removeEventListener("modechange",this.triggerSelectedlanguagechange_))}}class dy{constructor(e=[]){this.trackElements_=[],Object.defineProperty(this,"length",{get(){return this.trackElements_.length}});for(let t=0,i=e.length;t<i;t++)this.addTrackElement_(e[t])}addTrackElement_(e){const t=this.trackElements_.length;""+t in this||Object.defineProperty(this,t,{get(){return this.trackElements_[t]}}),this.trackElements_.indexOf(e)===-1&&this.trackElements_.push(e)}getTrackElementByTrack_(e){let t;for(let i=0,r=this.trackElements_.length;i<r;i++)if(e===this.trackElements_[i].track){t=this.trackElements_[i];break}return t}removeTrackElement_(e){for(let t=0,i=this.trackElements_.length;t<i;t++)if(e===this.trackElements_[t]){this.trackElements_[t].track&&typeof this.trackElements_[t].track.off=="function"&&this.trackElements_[t].track.off(),typeof this.trackElements_[t].off=="function"&&this.trackElements_[t].off(),this.trackElements_.splice(t,1);break}}}class rl{constructor(e){rl.prototype.setCues_.call(this,e),Object.defineProperty(this,"length",{get(){return this.length_}})}setCues_(e){const t=this.length||0;let i=0;const r=e.length;this.cues_=e,this.length_=e.length;const s=function(a){""+a in this||Object.defineProperty(this,""+a,{get(){return this.cues_[a]}})};if(t<r)for(i=t;i<r;i++)s.call(this,i)}getCueById(e){let t=null;for(let i=0,r=this.length;i<r;i++){const s=this[i];if(s.id===e){t=s;break}}return t}}const cy={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},hy={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},fy={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},Zh={disabled:"disabled",hidden:"hidden",showing:"showing"};class pd extends Vn{constructor(e={}){super();const t={id:e.id||"vjs_track_"+Ki(),kind:e.kind||"",language:e.language||""};let i=e.label||"";for(const r in t)Object.defineProperty(this,r,{get(){return t[r]},set(){}});Object.defineProperty(this,"label",{get(){return i},set(r){r!==i&&(i=r,this.trigger("labelchange"))}})}}const md=function(n){const e=["protocol","hostname","port","pathname","search","hash","host"],t=Ee().createElement("a");t.href=n;const i={};for(let r=0;r<e.length;r++)i[e[r]]=t[e[r]];return i.protocol==="http:"&&(i.host=i.host.replace(/:80$/,"")),i.protocol==="https:"&&(i.host=i.host.replace(/:443$/,"")),i.protocol||(i.protocol=q().location.protocol),i.host||(i.host=q().location.host),i},Jh=function(n){if(!n.match(/^https?:\/\//)){const e=Ee().createElement("a");e.href=n,n=e.href}return n},gd=function(n){if(typeof n=="string"){const t=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(n);if(t)return t.pop().toLowerCase()}return""},sl=function(n,e=q().location){const t=md(n);return(t.protocol===":"?e.protocol:t.protocol)+t.host!==e.protocol+e.host};var py=Object.freeze({__proto__:null,parseUrl:md,getAbsoluteURL:Jh,getFileExtension:gd,isCrossOrigin:sl});const ef=function(n,e){const t=new(q()).WebVTT.Parser(q(),q().vttjs,q().WebVTT.StringDecoder()),i=[];t.oncue=function(r){e.addCue(r)},t.onparsingerror=function(r){i.push(r)},t.onflush=function(){e.trigger({type:"loadeddata",target:e})},t.parse(n),i.length>0&&(q().console&&q().console.groupCollapsed&&q().console.groupCollapsed(`Text Track parsing errors for ${e.src}`),i.forEach(r=>Ut.error(r)),q().console&&q().console.groupEnd&&q().console.groupEnd()),t.flush()},tf=function(n,e){const t={uri:n},i=sl(n);i&&(t.cors=i);const r=e.tech_.crossOrigin()==="use-credentials";r&&(t.withCredentials=r),V()(t,ui(this,function(s,a,o){if(s)return Ut.error(s,a);e.loaded_=!0,typeof q().WebVTT!="function"?e.tech_&&e.tech_.any(["vttjsloaded","vttjserror"],l=>{if(l.type==="vttjserror"){Ut.error(`vttjs failed to load, stopping trying to process ${e.src}`);return}return ef(o,e)}):ef(o,e)}))};class eo extends pd{constructor(e={}){if(!e.tech)throw new Error("A tech was not provided.");const t=Xt(e,{kind:fy[e.kind]||"subtitles",language:e.language||e.srclang||""});let i=Zh[t.mode]||"disabled";const r=t.default;(t.kind==="metadata"||t.kind==="chapters")&&(i="hidden"),super(t),this.tech_=t.tech,this.cues_=[],this.activeCues_=[],this.preload_=this.tech_.preloadTextTracks!==!1;const s=new rl(this.cues_),a=new rl(this.activeCues_);let o=!1;this.timeupdateHandler=ui(this,function(u={}){if(!this.tech_.isDisposed()){if(!this.tech_.isReady_){u.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler));return}this.activeCues=this.activeCues,o&&(this.trigger("cuechange"),o=!1),u.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler))}});const l=()=>{this.stopTracking()};this.tech_.one("dispose",l),i!=="disabled"&&this.startTracking(),Object.defineProperties(this,{default:{get(){return r},set(){}},mode:{get(){return i},set(u){!Zh[u]||i!==u&&(i=u,!this.preload_&&i!=="disabled"&&this.cues.length===0&&tf(this.src,this),this.stopTracking(),i!=="disabled"&&this.startTracking(),this.trigger("modechange"))}},cues:{get(){return this.loaded_?s:null},set(){}},activeCues:{get(){if(!this.loaded_)return null;if(this.cues.length===0)return a;const u=this.tech_.currentTime(),d=[];for(let h=0,v=this.cues.length;h<v;h++){const x=this.cues[h];x.startTime<=u&&x.endTime>=u&&d.push(x)}if(o=!1,d.length!==this.activeCues_.length)o=!0;else for(let h=0;h<d.length;h++)this.activeCues_.indexOf(d[h])===-1&&(o=!0);return this.activeCues_=d,a.setCues_(this.activeCues_),a},set(){}}}),t.src?(this.src=t.src,this.preload_||(this.loaded_=!0),(this.preload_||t.kind!=="subtitles"&&t.kind!=="captions")&&tf(this.src,this)):this.loaded_=!0}startTracking(){this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler),this.tech_.on("timeupdate",this.timeupdateHandler)}stopTracking(){this.rvf_&&(this.tech_.cancelVideoFrameCallback(this.rvf_),this.rvf_=void 0),this.tech_.off("timeupdate",this.timeupdateHandler)}addCue(e){let t=e;if(q().vttjs&&!(e instanceof q().vttjs.VTTCue)){t=new(q()).vttjs.VTTCue(e.startTime,e.endTime,e.text);for(const r in e)r in t||(t[r]=e[r]);t.id=e.id,t.originalCue_=e}const i=this.tech_.textTracks();for(let r=0;r<i.length;r++)i[r]!==this&&i[r].removeCue(t);this.cues_.push(t),this.cues.setCues_(this.cues_)}removeCue(e){let t=this.cues_.length;for(;t--;){const i=this.cues_[t];if(i===e||i.originalCue_&&i.originalCue_===e){this.cues_.splice(t,1),this.cues.setCues_(this.cues_);break}}}}eo.prototype.allowedEvents_={cuechange:"cuechange"};class nf extends pd{constructor(e={}){const t=Xt(e,{kind:hy[e.kind]||""});super(t);let i=!1;Object.defineProperty(this,"enabled",{get(){return i},set(r){typeof r!="boolean"||r===i||(i=r,this.trigger("enabledchange"))}}),t.enabled&&(this.enabled=t.enabled),this.loaded_=!0}}class rf extends pd{constructor(e={}){const t=Xt(e,{kind:cy[e.kind]||""});super(t);let i=!1;Object.defineProperty(this,"selected",{get(){return i},set(r){typeof r!="boolean"||r===i||(i=r,this.trigger("selectedchange"))}}),t.selected&&(this.selected=t.selected)}}class Pr extends Vn{constructor(e={}){super();let t;const i=new eo(e);this.kind=i.kind,this.src=i.src,this.srclang=i.language,this.label=i.label,this.default=i.default,Object.defineProperties(this,{readyState:{get(){return t}},track:{get(){return i}}}),t=Pr.NONE,i.addEventListener("loadeddata",()=>{t=Pr.LOADED,this.trigger({type:"load",target:this})})}}Pr.prototype.allowedEvents_={load:"load"},Pr.NONE=0,Pr.LOADING=1,Pr.LOADED=2,Pr.ERROR=3;const Hn={audio:{ListClass:ly,TrackClass:nf,capitalName:"Audio"},video:{ListClass:uy,TrackClass:rf,capitalName:"Video"},text:{ListClass:Qh,TrackClass:eo,capitalName:"Text"}};Object.keys(Hn).forEach(function(n){Hn[n].getterName=`${n}Tracks`,Hn[n].privateName=`${n}Tracks_`});const fa={remoteText:{ListClass:Qh,TrackClass:eo,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:dy,TrackClass:Pr,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},an=Object.assign({},Hn,fa);fa.names=Object.keys(fa),Hn.names=Object.keys(Hn),an.names=[].concat(fa.names).concat(Hn.names);function my(n,e,t,i,r={}){const s=n.textTracks();r.kind=e,t&&(r.label=t),i&&(r.language=i),r.tech=n;const a=new an.text.TrackClass(r);return s.addTrack(a),a}class Ot extends $e{constructor(e={},t=function(){}){e.reportTouchActivity=!1,super(null,e,t),this.onDurationChange_=i=>this.onDurationChange(i),this.trackProgress_=i=>this.trackProgress(i),this.trackCurrentTime_=i=>this.trackCurrentTime(i),this.stopTrackingCurrentTime_=i=>this.stopTrackingCurrentTime(i),this.disposeSourceHandler_=i=>this.disposeSourceHandler(i),this.queuedHanders_=new Set,this.hasStarted_=!1,this.on("playing",function(){this.hasStarted_=!0}),this.on("loadstart",function(){this.hasStarted_=!1}),an.names.forEach(i=>{const r=an[i];e&&e[r.getterName]&&(this[r.privateName]=e[r.getterName])}),this.featuresProgressEvents||this.manualProgressOn(),this.featuresTimeupdateEvents||this.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(i=>{e[`native${i}Tracks`]===!1&&(this[`featuresNative${i}Tracks`]=!1)}),e.nativeCaptions===!1||e.nativeTextTracks===!1?this.featuresNativeTextTracks=!1:(e.nativeCaptions===!0||e.nativeTextTracks===!0)&&(this.featuresNativeTextTracks=!0),this.featuresNativeTextTracks||this.emulateTextTracks(),this.preloadTextTracks=e.preloadTextTracks!==!1,this.autoRemoteTextTracks_=new an.text.ListClass,this.initTrackListeners(),e.nativeControlsForTouch||this.emitTapEvents(),this.constructor&&(this.name_=this.constructor.name||"Unknown Tech")}triggerSourceset(e){this.isReady_||this.one("ready",()=>this.setTimeout(()=>this.triggerSourceset(e),1)),this.trigger({src:e,type:"sourceset"})}manualProgressOn(){this.on("durationchange",this.onDurationChange_),this.manualProgress=!0,this.one("ready",this.trackProgress_)}manualProgressOff(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange_)}trackProgress(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(ui(this,function(){const t=this.bufferedPercent();this.bufferedPercent_!==t&&this.trigger("progress"),this.bufferedPercent_=t,t===1&&this.stopTrackingProgress()}),500)}onDurationChange(e){this.duration_=this.duration()}buffered(){return yr(0,0)}bufferedPercent(){return Yh(this.buffered(),this.duration_)}stopTrackingProgress(){this.clearInterval(this.progressInterval)}manualTimeUpdatesOn(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime_),this.on("pause",this.stopTrackingCurrentTime_)}manualTimeUpdatesOff(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime_),this.off("pause",this.stopTrackingCurrentTime_)}trackCurrentTime(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)}stopTrackingCurrentTime(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}dispose(){this.clearTracks(Hn.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),super.dispose()}clearTracks(e){e=[].concat(e),e.forEach(t=>{const i=this[`${t}Tracks`]()||[];let r=i.length;for(;r--;){const s=i[r];t==="text"&&this.removeRemoteTextTrack(s),i.removeTrack(s)}})}cleanupAutoTextTracks(){const e=this.autoRemoteTextTracks_||[];let t=e.length;for(;t--;){const i=e[t];this.removeRemoteTextTrack(i)}}reset(){}crossOrigin(){}setCrossOrigin(){}error(e){return e!==void 0&&(this.error_=new sn(e),this.trigger("error")),this.error_}played(){return this.hasStarted_?yr(0,0):yr()}play(){}setScrubbing(e){}scrubbing(){}setCurrentTime(e){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}initTrackListeners(){Hn.names.forEach(e=>{const t=Hn[e],i=()=>{this.trigger(`${e}trackchange`)},r=this[t.getterName]();r.addEventListener("removetrack",i),r.addEventListener("addtrack",i),this.on("dispose",()=>{r.removeEventListener("removetrack",i),r.removeEventListener("addtrack",i)})})}addWebVttScript_(){if(!q().WebVTT)if(Ee().body.contains(this.el())){if(!this.options_["vtt.js"]&&ns(I())&&Object.keys(I()).length>0){this.trigger("vttjsloaded");return}const e=Ee().createElement("script");e.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",e.onload=()=>{this.trigger("vttjsloaded")},e.onerror=()=>{this.trigger("vttjserror")},this.on("dispose",()=>{e.onload=null,e.onerror=null}),q().WebVTT=!0,this.el().parentNode.appendChild(e)}else this.ready(this.addWebVttScript_)}emulateTextTracks(){const e=this.textTracks(),t=this.remoteTextTracks(),i=o=>e.addTrack(o.track),r=o=>e.removeTrack(o.track);t.on("addtrack",i),t.on("removetrack",r),this.addWebVttScript_();const s=()=>this.trigger("texttrackchange"),a=()=>{s();for(let o=0;o<e.length;o++){const l=e[o];l.removeEventListener("cuechange",s),l.mode==="showing"&&l.addEventListener("cuechange",s)}};a(),e.addEventListener("change",a),e.addEventListener("addtrack",a),e.addEventListener("removetrack",a),this.on("dispose",function(){t.off("addtrack",i),t.off("removetrack",r),e.removeEventListener("change",a),e.removeEventListener("addtrack",a),e.removeEventListener("removetrack",a);for(let o=0;o<e.length;o++)e[o].removeEventListener("cuechange",s)})}addTextTrack(e,t,i){if(!e)throw new Error("TextTrack kind is required but was not provided");return my(this,e,t,i)}createRemoteTextTrack(e){const t=Xt(e,{tech:this});return new fa.remoteTextEl.TrackClass(t)}addRemoteTextTrack(e={},t){const i=this.createRemoteTextTrack(e);return typeof t!="boolean"&&(t=!1),this.remoteTextTrackEls().addTrackElement_(i),this.remoteTextTracks().addTrack(i.track),t===!1&&this.ready(()=>this.autoRemoteTextTracks_.addTrack(i.track)),i}removeRemoteTextTrack(e){const t=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(t),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)}getVideoPlaybackQuality(){return{}}requestPictureInPicture(){return Promise.reject()}disablePictureInPicture(){return!0}setDisablePictureInPicture(){}requestVideoFrameCallback(e){const t=Ki();return!this.isReady_||this.paused()?(this.queuedHanders_.add(t),this.one("playing",()=>{this.queuedHanders_.has(t)&&(this.queuedHanders_.delete(t),e())})):this.requestNamedAnimationFrame(t,e),t}cancelVideoFrameCallback(e){this.queuedHanders_.has(e)?this.queuedHanders_.delete(e):this.cancelNamedAnimationFrame(e)}setPoster(){}playsinline(){}setPlaysinline(){}overrideNativeAudioTracks(e){}overrideNativeVideoTracks(e){}canPlayType(e){return""}static canPlayType(e){return""}static canPlaySource(e,t){return Ot.canPlayType(e.type)}static isTech(e){return e.prototype instanceof Ot||e instanceof Ot||e===Ot}static registerTech(e,t){if(Ot.techs_||(Ot.techs_={}),!Ot.isTech(t))throw new Error(`Tech ${e} must be a Tech`);if(!Ot.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!Ot.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=Si(e),Ot.techs_[e]=t,Ot.techs_[Za(e)]=t,e!=="Tech"&&Ot.defaultTechOrder_.push(e),t}static getTech(e){if(!!e){if(Ot.techs_&&Ot.techs_[e])return Ot.techs_[e];if(e=Si(e),q()&&q().videojs&&q().videojs[e])return Ut.warn(`The ${e} tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)`),q().videojs[e]}}}an.names.forEach(function(n){const e=an[n];Ot.prototype[e.getterName]=function(){return this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName]}}),Ot.prototype.featuresVolumeControl=!0,Ot.prototype.featuresMuteControl=!0,Ot.prototype.featuresFullscreenResize=!1,Ot.prototype.featuresPlaybackRate=!1,Ot.prototype.featuresProgressEvents=!1,Ot.prototype.featuresSourceset=!1,Ot.prototype.featuresTimeupdateEvents=!1,Ot.prototype.featuresNativeTextTracks=!1,Ot.prototype.featuresVideoFrameCallback=!1,Ot.withSourceHandlers=function(n){n.registerSourceHandler=function(t,i){let r=n.sourceHandlers;r||(r=n.sourceHandlers=[]),i===void 0&&(i=r.length),r.splice(i,0,t)},n.canPlayType=function(t){const i=n.sourceHandlers||[];let r;for(let s=0;s<i.length;s++)if(r=i[s].canPlayType(t),r)return r;return""},n.selectSourceHandler=function(t,i){const r=n.sourceHandlers||[];let s;for(let a=0;a<r.length;a++)if(s=r[a].canHandleSource(t,i),s)return r[a];return null},n.canPlaySource=function(t,i){const r=n.selectSourceHandler(t,i);return r?r.canHandleSource(t,i):""},["seekable","seeking","duration"].forEach(function(t){const i=this[t];typeof i=="function"&&(this[t]=function(){return this.sourceHandler_&&this.sourceHandler_[t]?this.sourceHandler_[t].apply(this.sourceHandler_,arguments):i.apply(this,arguments)})},n.prototype),n.prototype.setSource=function(t){let i=n.selectSourceHandler(t,this.options_);i||(n.nativeSourceHandler?i=n.nativeSourceHandler:Ut.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler_),i!==n.nativeSourceHandler&&(this.currentSource_=t),this.sourceHandler_=i.handleSource(t,this,this.options_),this.one("dispose",this.disposeSourceHandler_)},n.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},$e.registerComponent("Tech",Ot),Ot.registerTech("Tech",Ot),Ot.defaultTechOrder_=[];const ks={},yd={},al={};function gy(n,e){ks[n]=ks[n]||[],ks[n].push(e)}function yy(n,e,t){n.setTimeout(()=>Is(e,ks[e.type],t,n),1)}function vy(n,e){n.forEach(t=>t.setTech&&t.setTech(e))}function Ay(n,e,t){return n.reduceRight(vd(t),e[t]())}function by(n,e,t,i){return e[t](n.reduce(vd(t),i))}function sf(n,e,t,i=null){const r="call"+Si(t),s=n.reduce(vd(r),i),a=s===al,o=a?null:e[t](s);return Ey(n,t,o,a),o}const _y={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1,ended:1},xy={setCurrentTime:1,setMuted:1,setVolume:1},af={play:1,pause:1};function vd(n){return(e,t)=>e===al?al:t[n]?t[n](e):e}function Ey(n,e,t,i){for(let r=n.length-1;r>=0;r--){const s=n[r];s[e]&&s[e](i,t)}}function Ty(n){yd[n.id()]=null}function Sy(n,e){const t=yd[n.id()];let i=null;if(t==null)return i=e(n),yd[n.id()]=[[e,i]],i;for(let r=0;r<t.length;r++){const[s,a]=t[r];s===e&&(i=a)}return i===null&&(i=e(n),t.push([e,i])),i}function Is(n={},e=[],t,i,r=[],s=!1){const[a,...o]=e;if(typeof a=="string")Is(n,ks[a],t,i,r,s);else if(a){const l=Sy(i,a);if(!l.setSource)return r.push(l),Is(n,o,t,i,r,s);l.setSource(Object.assign({},n),function(u,d){if(u)return Is(n,o,t,i,r,s);r.push(l),Is(d,n.type===d.type?o:ks[d.type],t,i,r,s)})}else o.length?Is(n,o,t,i,r,s):s?t(n,r):Is(n,ks["*"],t,i,r,!0)}const Cy={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",mpd:"application/dash+xml",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},ol=function(n=""){const e=gd(n);return Cy[e.toLowerCase()]||""},wy=(n,e)=>{if(!e)return"";if(n.cache_.source.src===e&&n.cache_.source.type)return n.cache_.source.type;const t=n.cache_.sources.filter(r=>r.src===e);if(t.length)return t[0].type;const i=n.$$("source");for(let r=0;r<i.length;r++){const s=i[r];if(s.type&&s.src&&s.src===e)return s.type}return ol(e)},of=function(n){if(Array.isArray(n)){let e=[];n.forEach(function(t){t=of(t),Array.isArray(t)?e=e.concat(t):Nn(t)&&e.push(t)}),n=e}else typeof n=="string"&&n.trim()?n=[lf({src:n})]:Nn(n)&&typeof n.src=="string"&&n.src&&n.src.trim()?n=[lf(n)]:n=[];return n};function lf(n){if(!n.type){const e=ol(n.src);e&&(n.type=e)}return n}class Ly extends $e{constructor(e,t,i){const r=Xt({createEl:!1},t);super(e,r,i);if(!t.playerOptions.sources||t.playerOptions.sources.length===0)for(let s=0,a=t.playerOptions.techOrder;s<a.length;s++){const o=Si(a[s]);let l=Ot.getTech(o);if(o||(l=$e.getComponent(o)),l&&l.isSupported()){e.loadTech_(o);break}}else e.src(t.playerOptions.sources)}}$e.registerComponent("MediaLoader",Ly);class ll extends $e{constructor(e,t){super(e,t);this.options_.controlText&&this.controlText(this.options_.controlText),this.handleMouseOver_=i=>this.handleMouseOver(i),this.handleMouseOut_=i=>this.handleMouseOut(i),this.handleClick_=i=>this.handleClick(i),this.handleKeyDown_=i=>this.handleKeyDown(i),this.emitTapEvents(),this.enable()}createEl(e="div",t={},i={}){t=Object.assign({className:this.buildCSSClass(),tabIndex:0},t),e==="button"&&Ut.error(`Creating a ClickableComponent with an HTML element of ${e} is not supported; use a Button instead.`),i=Object.assign({role:"button"},i),this.tabIndex_=t.tabIndex;const r=Bt(e,t,i);return r.appendChild(Bt("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(r),r}dispose(){this.controlTextEl_=null,super.dispose()}createControlTextEl(e){return this.controlTextEl_=Bt("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_}controlText(e,t=this.el()){if(e===void 0)return this.controlText_||"Need Text";const i=this.localize(e);this.controlText_=e,mr(this.controlTextEl_,i),!this.nonIconControl&&!this.player_.options_.noUITitleAttributes&&t.setAttribute("title",i)}buildCSSClass(){return`vjs-control vjs-button ${super.buildCSSClass()}`}enable(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),typeof this.tabIndex_!="undefined"&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick_),this.on("keydown",this.handleKeyDown_))}disable(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),typeof this.tabIndex_!="undefined"&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver_),this.off("mouseout",this.handleMouseOut_),this.off(["tap","click"],this.handleClick_),this.off("keydown",this.handleKeyDown_)}handleLanguagechange(){this.controlText(this.controlText_)}handleClick(e){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)}handleKeyDown(e){ce().isEventKey(e,"Space")||ce().isEventKey(e,"Enter")?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):super.handleKeyDown(e)}}$e.registerComponent("ClickableComponent",ll);class Ad extends ll{constructor(e,t){super(e,t);this.update(),this.update_=i=>this.update(i),e.on("posterchange",this.update_)}dispose(){this.player().off("posterchange",this.update_),super.dispose()}createEl(){return Bt("div",{className:"vjs-poster"})}crossOrigin(e){if(typeof e=="undefined")return this.$("img")?this.$("img").crossOrigin:this.player_.tech_&&this.player_.tech_.isReady_?this.player_.crossOrigin():this.player_.options_.crossOrigin||this.player_.options_.crossorigin||null;if(e!==null&&e!=="anonymous"&&e!=="use-credentials"){this.player_.log.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${e}"`);return}this.$("img")&&(this.$("img").crossOrigin=e)}update(e){const t=this.player().poster();this.setSrc(t),t?this.show():this.hide()}setSrc(e){if(!e){this.el_.textContent="";return}this.$("img")||this.el_.appendChild(Bt("picture",{className:"vjs-poster",tabIndex:-1},{},Bt("img",{loading:"lazy",crossOrigin:this.crossOrigin()},{alt:""}))),this.$("img").src=e}handleClick(e){!this.player_.controls()||(this.player_.tech(!0)&&this.player_.tech(!0).focus(),this.player_.paused()?vr(this.player_.play()):this.player_.pause())}}Ad.prototype.crossorigin=Ad.prototype.crossOrigin,$e.registerComponent("PosterImage",Ad);const Wn="#222",uf="#ccc",Dy={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function bd(n,e){let t;if(n.length===4)t=n[1]+n[1]+n[2]+n[2]+n[3]+n[3];else if(n.length===7)t=n.slice(1);else throw new Error("Invalid color code provided, "+n+"; must be formatted as e.g. #f0e or #f604e2.");return"rgba("+parseInt(t.slice(0,2),16)+","+parseInt(t.slice(2,4),16)+","+parseInt(t.slice(4,6),16)+","+e+")"}function _d(n,e,t){try{n.style[e]=t}catch(i){return}}class ky extends $e{constructor(e,t,i){super(e,t,i);const r=s=>this.updateDisplay(s);e.on("loadstart",s=>this.toggleDisplay(s)),e.on("texttrackchange",r),e.on("loadedmetadata",s=>this.preselectTrack(s)),e.ready(ui(this,function(){if(e.tech_&&e.tech_.featuresNativeTextTracks){this.hide();return}e.on("fullscreenchange",r),e.on("playerresize",r);const s=q().screen.orientation||q(),a=q().screen.orientation?"change":"orientationchange";s.addEventListener(a,r),e.on("dispose",()=>s.removeEventListener(a,r));const o=this.options_.playerOptions.tracks||[];for(let l=0;l<o.length;l++)this.player_.addRemoteTextTrack(o[l],!0);this.preselectTrack()}))}preselectTrack(){const e={captions:1,subtitles:1},t=this.player_.textTracks(),i=this.player_.cache_.selectedLanguage;let r,s,a;for(let o=0;o<t.length;o++){const l=t[o];i&&i.enabled&&i.language&&i.language===l.language&&l.kind in e?l.kind===i.kind?a=l:a||(a=l):i&&!i.enabled?(a=null,r=null,s=null):l.default&&(l.kind==="descriptions"&&!r?r=l:l.kind in e&&!s&&(s=l))}a?a.mode="showing":s?s.mode="showing":r&&(r.mode="showing")}toggleDisplay(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()}createEl(){return super.createEl("div",{className:"vjs-text-track-display"},{translate:"yes","aria-live":"off","aria-atomic":"true"})}clearDisplay(){typeof q().WebVTT=="function"&&q().WebVTT.processCues(q(),[],this.el_)}updateDisplay(){const e=this.player_.textTracks(),t=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),t){const a=[];for(let o=0;o<e.length;++o){const l=e[o];l.mode==="showing"&&a.push(l)}this.updateForTrack(a);return}let i=null,r=null,s=e.length;for(;s--;){const a=e[s];a.mode==="showing"&&(a.kind==="descriptions"?i=a:r=a)}r?(this.getAttribute("aria-live")!=="off"&&this.setAttribute("aria-live","off"),this.updateForTrack(r)):i&&(this.getAttribute("aria-live")!=="assertive"&&this.setAttribute("aria-live","assertive"),this.updateForTrack(i))}updateDisplayState(e){const t=this.player_.textTrackSettings.getValues(),i=e.activeCues;let r=i.length;for(;r--;){const s=i[r];if(!s)continue;const a=s.displayState;if(t.color&&(a.firstChild.style.color=t.color),t.textOpacity&&_d(a.firstChild,"color",bd(t.color||"#fff",t.textOpacity)),t.backgroundColor&&(a.firstChild.style.backgroundColor=t.backgroundColor),t.backgroundOpacity&&_d(a.firstChild,"backgroundColor",bd(t.backgroundColor||"#000",t.backgroundOpacity)),t.windowColor&&(t.windowOpacity?_d(a,"backgroundColor",bd(t.windowColor,t.windowOpacity)):a.style.backgroundColor=t.windowColor),t.edgeStyle&&(t.edgeStyle==="dropshadow"?a.firstChild.style.textShadow=`2px 2px 3px ${Wn}, 2px 2px 4px ${Wn}, 2px 2px 5px ${Wn}`:t.edgeStyle==="raised"?a.firstChild.style.textShadow=`1px 1px ${Wn}, 2px 2px ${Wn}, 3px 3px ${Wn}`:t.edgeStyle==="depressed"?a.firstChild.style.textShadow=`1px 1px ${uf}, 0 1px ${uf}, -1px -1px ${Wn}, 0 -1px ${Wn}`:t.edgeStyle==="uniform"&&(a.firstChild.style.textShadow=`0 0 4px ${Wn}, 0 0 4px ${Wn}, 0 0 4px ${Wn}, 0 0 4px ${Wn}`)),t.fontPercent&&t.fontPercent!==1){const o=q().parseFloat(a.style.fontSize);a.style.fontSize=o*t.fontPercent+"px",a.style.height="auto",a.style.top="auto"}t.fontFamily&&t.fontFamily!=="default"&&(t.fontFamily==="small-caps"?a.firstChild.style.fontVariant="small-caps":a.firstChild.style.fontFamily=Dy[t.fontFamily])}}updateForTrack(e){if(Array.isArray(e)||(e=[e]),typeof q().WebVTT!="function"||e.every(i=>!i.activeCues))return;const t=[];for(let i=0;i<e.length;++i){const r=e[i];for(let s=0;s<r.activeCues.length;++s)t.push(r.activeCues[s])}q().WebVTT.processCues(q(),t,this.el_);for(let i=0;i<e.length;++i){const r=e[i];for(let s=0;s<r.activeCues.length;++s){const a=r.activeCues[s].displayState;wn(a,"vjs-text-track-cue","vjs-text-track-cue-"+(r.language?r.language:i)),r.language&&Ln(a,"lang",r.language)}this.player_.textTrackSettings&&this.updateDisplayState(r)}}}$e.registerComponent("TextTrackDisplay",ky);class Iy extends $e{createEl(){const e=this.player_.isAudio(),t=this.localize(e?"Audio Player":"Video Player"),i=Bt("span",{className:"vjs-control-text",textContent:this.localize("{1} is loading.",[t])}),r=super.createEl("div",{className:"vjs-loading-spinner",dir:"ltr"});return r.appendChild(i),r}handleLanguagechange(){this.$(".vjs-control-text").textContent=this.localize("{1} is loading.",[this.player_.isAudio()?"Audio Player":"Video Player"])}}$e.registerComponent("LoadingSpinner",Iy);class kn extends ll{createEl(e,t={},i={}){e="button",t=Object.assign({className:this.buildCSSClass()},t),i=Object.assign({type:"button"},i);const r=Bt(e,t,i);return r.appendChild(Bt("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(r),r}addChild(e,t={}){const i=this.constructor.name;return Ut.warn(`Adding an actionable (user controllable) child to a Button (${i}) is not supported; use a ClickableComponent instead.`),$e.prototype.addChild.call(this,e,t)}enable(){super.enable(),this.el_.removeAttribute("disabled")}disable(){super.disable(),this.el_.setAttribute("disabled","disabled")}handleKeyDown(e){if(ce().isEventKey(e,"Space")||ce().isEventKey(e,"Enter")){e.stopPropagation();return}super.handleKeyDown(e)}}$e.registerComponent("Button",kn);class df extends kn{constructor(e,t){super(e,t);this.mouseused_=!1,this.on("mousedown",i=>this.handleMouseDown(i))}buildCSSClass(){return"vjs-big-play-button"}handleClick(e){const t=this.player_.play();if(this.mouseused_&&e.clientX&&e.clientY){vr(t),this.player_.tech(!0)&&this.player_.tech(!0).focus();return}const i=this.player_.getChild("controlBar"),r=i&&i.getChild("playToggle");if(!r){this.player_.tech(!0).focus();return}const s=()=>r.focus();Ja(t)?t.then(s,()=>{}):this.setTimeout(s,1)}handleKeyDown(e){this.mouseused_=!1,super.handleKeyDown(e)}handleMouseDown(e){this.mouseused_=!0}}df.prototype.controlText_="Play Video",$e.registerComponent("BigPlayButton",df);class Ry extends kn{constructor(e,t){super(e,t);this.controlText(t&&t.controlText||this.localize("Close"))}buildCSSClass(){return`vjs-close-button ${super.buildCSSClass()}`}handleClick(e){this.trigger({type:"close",bubbles:!1})}handleKeyDown(e){ce().isEventKey(e,"Esc")?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):super.handleKeyDown(e)}}$e.registerComponent("CloseButton",Ry);class cf extends kn{constructor(e,t={}){super(e,t);t.replay=t.replay===void 0||t.replay,this.on(e,"play",i=>this.handlePlay(i)),this.on(e,"pause",i=>this.handlePause(i)),t.replay&&this.on(e,"ended",i=>this.handleEnded(i))}buildCSSClass(){return`vjs-play-control ${super.buildCSSClass()}`}handleClick(e){this.player_.paused()?vr(this.player_.play()):this.player_.pause()}handleSeeked(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)}handlePlay(e){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")}handlePause(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")}handleEnded(e){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",t=>this.handleSeeked(t))}}cf.prototype.controlText_="Play",$e.registerComponent("PlayToggle",cf);class pa extends $e{constructor(e,t){super(e,t);this.on(e,["timeupdate","ended"],i=>this.updateContent(i)),this.updateTextNode_()}createEl(){const e=this.buildCSSClass(),t=super.createEl("div",{className:`${e} vjs-time-control vjs-control`}),i=Bt("span",{className:"vjs-control-text",textContent:`${this.localize(this.labelText_)}\xA0`},{role:"presentation"});return t.appendChild(i),this.contentEl_=Bt("span",{className:`${e}-display`},{role:"presentation"}),t.appendChild(this.contentEl_),t}dispose(){this.contentEl_=null,this.textNode_=null,super.dispose()}updateTextNode_(e=0){e=Ds(e),this.formattedTime_!==e&&(this.formattedTime_=e,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",()=>{if(!this.contentEl_)return;let t=this.textNode_;t&&this.contentEl_.firstChild!==t&&(t=null,Ut.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")),this.textNode_=Ee().createTextNode(this.formattedTime_),!!this.textNode_&&(t?this.contentEl_.replaceChild(this.textNode_,t):this.contentEl_.appendChild(this.textNode_))}))}updateContent(e){}}pa.prototype.labelText_="Time",pa.prototype.controlText_="Time",$e.registerComponent("TimeDisplay",pa);class xd extends pa{buildCSSClass(){return"vjs-current-time"}updateContent(e){let t;this.player_.ended()?t=this.player_.duration():t=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(t)}}xd.prototype.labelText_="Current Time",xd.prototype.controlText_="Current Time",$e.registerComponent("CurrentTimeDisplay",xd);class Ed extends pa{constructor(e,t){super(e,t);const i=r=>this.updateContent(r);this.on(e,"durationchange",i),this.on(e,"loadstart",i),this.on(e,"loadedmetadata",i)}buildCSSClass(){return"vjs-duration"}updateContent(e){const t=this.player_.duration();this.updateTextNode_(t)}}Ed.prototype.labelText_="Duration",Ed.prototype.controlText_="Duration",$e.registerComponent("DurationDisplay",Ed);class Oy extends $e{createEl(){const e=super.createEl("div",{className:"vjs-time-control vjs-time-divider"},{"aria-hidden":!0}),t=super.createEl("div"),i=super.createEl("span",{textContent:"/"});return t.appendChild(i),e.appendChild(t),e}}$e.registerComponent("TimeDivider",Oy);class Td extends pa{constructor(e,t){super(e,t);this.on(e,"durationchange",i=>this.updateContent(i))}buildCSSClass(){return"vjs-remaining-time"}createEl(){const e=super.createEl();return this.options_.displayNegative!==!1&&e.insertBefore(Bt("span",{},{"aria-hidden":!0},"-"),this.contentEl_),e}updateContent(e){if(typeof this.player_.duration()!="number")return;let t;this.player_.ended()?t=0:this.player_.remainingTimeDisplay?t=this.player_.remainingTimeDisplay():t=this.player_.remainingTime(),this.updateTextNode_(t)}}Td.prototype.labelText_="Remaining Time",Td.prototype.controlText_="Remaining Time",$e.registerComponent("RemainingTimeDisplay",Td);class Py extends $e{constructor(e,t){super(e,t);this.updateShowing(),this.on(this.player(),"durationchange",i=>this.updateShowing(i))}createEl(){const e=super.createEl("div",{className:"vjs-live-control vjs-control"});return this.contentEl_=Bt("div",{className:"vjs-live-display"},{"aria-live":"off"}),this.contentEl_.appendChild(Bt("span",{className:"vjs-control-text",textContent:`${this.localize("Stream Type")}\xA0`})),this.contentEl_.appendChild(Ee().createTextNode(this.localize("LIVE"))),e.appendChild(this.contentEl_),e}dispose(){this.contentEl_=null,super.dispose()}updateShowing(e){this.player().duration()===Infinity?this.show():this.hide()}}$e.registerComponent("LiveDisplay",Py);class hf extends kn{constructor(e,t){super(e,t);this.updateLiveEdgeStatus(),this.player_.liveTracker&&(this.updateLiveEdgeStatusHandler_=i=>this.updateLiveEdgeStatus(i),this.on(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_))}createEl(){const e=super.createEl("button",{className:"vjs-seek-to-live-control vjs-control"});return this.textEl_=Bt("span",{className:"vjs-seek-to-live-text",textContent:this.localize("LIVE")},{"aria-hidden":"true"}),e.appendChild(this.textEl_),e}updateLiveEdgeStatus(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))}handleClick(){this.player_.liveTracker.seekToLiveEdge()}dispose(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_),this.textEl_=null,super.dispose()}}hf.prototype.controlText_="Seek to live, currently playing live",$e.registerComponent("SeekToLive",hf);function to(n,e,t){return n=Number(n),Math.min(t,Math.max(e,isNaN(n)?e:n))}var By=Object.freeze({__proto__:null,clamp:to});class Sd extends $e{constructor(e,t){super(e,t);this.handleMouseDown_=i=>this.handleMouseDown(i),this.handleMouseUp_=i=>this.handleMouseUp(i),this.handleKeyDown_=i=>this.handleKeyDown(i),this.handleClick_=i=>this.handleClick(i),this.handleMouseMove_=i=>this.handleMouseMove(i),this.update_=i=>this.update(i),this.bar=this.getChild(this.options_.barName),this.vertical(!!this.options_.vertical),this.enable()}enabled(){return this.enabled_}enable(){this.enabled()||(this.on("mousedown",this.handleMouseDown_),this.on("touchstart",this.handleMouseDown_),this.on("keydown",this.handleKeyDown_),this.on("click",this.handleClick_),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)}disable(){if(!this.enabled())return;const e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown_),this.off("touchstart",this.handleMouseDown_),this.off("keydown",this.handleKeyDown_),this.off("click",this.handleClick_),this.off(this.player_,"controlsvisible",this.update_),this.off(e,"mousemove",this.handleMouseMove_),this.off(e,"mouseup",this.handleMouseUp_),this.off(e,"touchmove",this.handleMouseMove_),this.off(e,"touchend",this.handleMouseUp_),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}createEl(e,t={},i={}){return t.className=t.className+" vjs-slider",t=Object.assign({tabIndex:0},t),i=Object.assign({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100},i),super.createEl(e,t,i)}handleMouseDown(e){const t=this.bar.el_.ownerDocument;e.type==="mousedown"&&e.preventDefault(),e.type==="touchstart"&&!jn&&e.preventDefault(),Qo(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(t,"mousemove",this.handleMouseMove_),this.on(t,"mouseup",this.handleMouseUp_),this.on(t,"touchmove",this.handleMouseMove_),this.on(t,"touchend",this.handleMouseUp_),this.handleMouseMove(e,!0)}handleMouseMove(e){}handleMouseUp(e){const t=this.bar.el_.ownerDocument;Zo(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(t,"mousemove",this.handleMouseMove_),this.off(t,"mouseup",this.handleMouseUp_),this.off(t,"touchmove",this.handleMouseMove_),this.off(t,"touchend",this.handleMouseUp_),this.update()}update(){if(!this.el_||!this.bar)return;const e=this.getProgress();return e===this.progress_||(this.progress_=e,this.requestNamedAnimationFrame("Slider#update",()=>{const t=this.vertical()?"height":"width";this.bar.el().style[t]=(e*100).toFixed(2)+"%"})),e}getProgress(){return Number(to(this.getPercent(),0,1).toFixed(4))}calculateDistance(e){const t=M(this.el_,e);return this.vertical()?t.y:t.x}handleKeyDown(e){ce().isEventKey(e,"Left")||ce().isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepBack()):ce().isEventKey(e,"Right")||ce().isEventKey(e,"Up")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):super.handleKeyDown(e)}handleClick(e){e.stopPropagation(),e.preventDefault()}vertical(e){if(e===void 0)return this.vertical_||!1;this.vertical_=!!e,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")}}$e.registerComponent("Slider",Sd);const Cd=(n,e)=>to(n/e*100,0,100).toFixed(2)+"%";class Fy extends $e{constructor(e,t){super(e,t);this.partEls_=[],this.on(e,"progress",i=>this.update(i))}createEl(){const e=super.createEl("div",{className:"vjs-load-progress"}),t=Bt("span",{className:"vjs-control-text"}),i=Bt("span",{textContent:this.localize("Loaded")}),r=Ee().createTextNode(": ");return this.percentageEl_=Bt("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),e.appendChild(t),t.appendChild(i),t.appendChild(r),t.appendChild(this.percentageEl_),e}dispose(){this.partEls_=null,this.percentageEl_=null,super.dispose()}update(e){this.requestNamedAnimationFrame("LoadProgressBar#update",()=>{const t=this.player_.liveTracker,i=this.player_.buffered(),r=t&&t.isLive()?t.seekableEnd():this.player_.duration(),s=this.player_.bufferedEnd(),a=this.partEls_,o=Cd(s,r);this.percent_!==o&&(this.el_.style.width=o,mr(this.percentageEl_,o),this.percent_=o);for(let l=0;l<i.length;l++){const u=i.start(l),d=i.end(l);let h=a[l];h||(h=this.el_.appendChild(Bt()),a[l]=h),!(h.dataset.start===u&&h.dataset.end===d)&&(h.dataset.start=u,h.dataset.end=d,h.style.left=Cd(u,s),h.style.width=Cd(d-u,s))}for(let l=a.length;l>i.length;l--)this.el_.removeChild(a[l-1]);a.length=i.length})}}$e.registerComponent("LoadProgressBar",Fy);class My extends $e{constructor(e,t){super(e,t);this.update=gr(ui(this,this.update),Gn)}createEl(){return super.createEl("div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})}update(e,t,i){const r=b(this.el_),s=m(this.player_.el()),a=e.width*t;if(!s||!r)return;const o=e.left-s.left+a,l=e.width-a+(s.right-e.right);let u=r.width/2;o<u?u+=u-o:l<u&&(u=l),u<0?u=0:u>r.width&&(u=r.width),u=Math.round(u),this.el_.style.right=`-${u}px`,this.write(i)}write(e){mr(this.el_,e)}updateTime(e,t,i,r){this.requestNamedAnimationFrame("TimeTooltip#updateTime",()=>{let s;const a=this.player_.duration();if(this.player_.liveTracker&&this.player_.liveTracker.isLive()){const o=this.player_.liveTracker.liveWindow(),l=o-t*o;s=(l<1?"":"-")+Ds(l,o)}else s=Ds(i,a);this.update(e,t,s),r&&r()})}}$e.registerComponent("TimeTooltip",My);class wd extends $e{constructor(e,t){super(e,t);this.update=gr(ui(this,this.update),Gn)}createEl(){return super.createEl("div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})}update(e,t){const i=this.getChild("timeTooltip");if(!i)return;const r=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();i.updateTime(e,t,r)}}wd.prototype.options_={children:[]},!Wi&&!Un&&wd.prototype.options_.children.push("timeTooltip"),$e.registerComponent("PlayProgressBar",wd);class ff extends $e{constructor(e,t){super(e,t);this.update=gr(ui(this,this.update),Gn)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(e,t){const i=t*this.player_.duration();this.getChild("timeTooltip").updateTime(e,t,i,()=>{this.el_.style.left=`${e.width*t}px`})}}ff.prototype.options_={children:["timeTooltip"]},$e.registerComponent("MouseTimeDisplay",ff);const ul=5,pf=12;class Ld extends Sd{constructor(e,t){super(e,t);this.setEventHandlers_()}setEventHandlers_(){this.update_=ui(this,this.update),this.update=gr(this.update_,Gn),this.on(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.enableIntervalHandler_=e=>this.enableInterval_(e),this.disableIntervalHandler_=e=>this.disableInterval_(e),this.on(this.player_,["playing"],this.enableIntervalHandler_),this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in Ee()&&"visibilityState"in Ee()&&this.on(Ee(),"visibilitychange",this.toggleVisibility_)}toggleVisibility_(e){Ee().visibilityState==="hidden"?(this.cancelNamedAnimationFrame("SeekBar#update"),this.cancelNamedAnimationFrame("Slider#update"),this.disableInterval_(e)):(!this.player_.ended()&&!this.player_.paused()&&this.enableInterval_(),this.update())}enableInterval_(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,Gn))}disableInterval_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&e&&e.type!=="ended"||!this.updateInterval||(this.clearInterval(this.updateInterval),this.updateInterval=null)}createEl(){return super.createEl("div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})}update(e){if(Ee().visibilityState==="hidden")return;const t=super.update();return this.requestNamedAnimationFrame("SeekBar#update",()=>{const i=this.player_.ended()?this.player_.duration():this.getCurrentTime_(),r=this.player_.liveTracker;let s=this.player_.duration();r&&r.isLive()&&(s=this.player_.liveTracker.liveCurrentTime()),this.percent_!==t&&(this.el_.setAttribute("aria-valuenow",(t*100).toFixed(2)),this.percent_=t),(this.currentTime_!==i||this.duration_!==s)&&(this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[Ds(i,s),Ds(s,s)],"{1} of {2}")),this.currentTime_=i,this.duration_=s),this.bar&&this.bar.update(m(this.el()),this.getProgress())}),t}userSeek_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(e)}getCurrentTime_(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()}getPercent(){const e=this.getCurrentTime_();let t;const i=this.player_.liveTracker;return i&&i.isLive()?(t=(e-i.seekableStart())/i.liveWindow(),i.atLiveEdge()&&(t=1)):t=e/this.player_.duration(),t}handleMouseDown(e){!se(e)||(e.stopPropagation(),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),super.handleMouseDown(e))}handleMouseMove(e,t=!1){if(!se(e))return;!t&&!this.player_.scrubbing()&&this.player_.scrubbing(!0);let i;const r=this.calculateDistance(e),s=this.player_.liveTracker;if(!s||!s.isLive())i=r*this.player_.duration(),i===this.player_.duration()&&(i=i-.1);else{if(r>=.99){s.seekToLiveEdge();return}const a=s.seekableStart(),o=s.liveCurrentTime();if(i=a+r*s.liveWindow(),i>=o&&(i=o),i<=a&&(i=a+.1),i===Infinity)return}this.userSeek_(i)}enable(){super.enable();const e=this.getChild("mouseTimeDisplay");!e||e.show()}disable(){super.disable();const e=this.getChild("mouseTimeDisplay");!e||e.hide()}handleMouseUp(e){super.handleMouseUp(e),e&&e.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?vr(this.player_.play()):this.update_()}stepForward(){this.userSeek_(this.player_.currentTime()+ul)}stepBack(){this.userSeek_(this.player_.currentTime()-ul)}handleAction(e){this.player_.paused()?this.player_.play():this.player_.pause()}handleKeyDown(e){const t=this.player_.liveTracker;if(ce().isEventKey(e,"Space")||ce().isEventKey(e,"Enter"))e.preventDefault(),e.stopPropagation(),this.handleAction(e);else if(ce().isEventKey(e,"Home"))e.preventDefault(),e.stopPropagation(),this.userSeek_(0);else if(ce().isEventKey(e,"End"))e.preventDefault(),e.stopPropagation(),t&&t.isLive()?this.userSeek_(t.liveCurrentTime()):this.userSeek_(this.player_.duration());else if(/^[0-9]$/.test(ce()(e))){e.preventDefault(),e.stopPropagation();const i=(ce().codes[ce()(e)]-ce().codes[0])*10/100;t&&t.isLive()?this.userSeek_(t.seekableStart()+t.liveWindow()*i):this.userSeek_(this.player_.duration()*i)}else ce().isEventKey(e,"PgDn")?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()-ul*pf)):ce().isEventKey(e,"PgUp")?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()+ul*pf)):super.handleKeyDown(e)}dispose(){this.disableInterval_(),this.off(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableIntervalHandler_),this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in Ee()&&"visibilityState"in Ee()&&this.off(Ee(),"visibilitychange",this.toggleVisibility_),super.dispose()}}Ld.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},!Wi&&!Un&&Ld.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),$e.registerComponent("SeekBar",Ld);class mf extends $e{constructor(e,t){super(e,t);this.handleMouseMove=gr(ui(this,this.handleMouseMove),Gn),this.throttledHandleMouseSeek=gr(ui(this,this.handleMouseSeek),Gn),this.handleMouseUpHandler_=i=>this.handleMouseUp(i),this.handleMouseDownHandler_=i=>this.handleMouseDown(i),this.enable()}createEl(){return super.createEl("div",{className:"vjs-progress-control vjs-control"})}handleMouseMove(e){const t=this.getChild("seekBar");if(!t)return;const i=t.getChild("playProgressBar"),r=t.getChild("mouseTimeDisplay");if(!i&&!r)return;const s=t.el(),a=b(s);let o=M(s,e).x;o=to(o,0,1),r&&r.update(a,o),i&&i.update(a,t.getProgress())}handleMouseSeek(e){const t=this.getChild("seekBar");t&&t.handleMouseMove(e)}enabled(){return this.enabled_}disable(){if(this.children().forEach(e=>e.disable&&e.disable()),!!this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDownHandler_),this.off(this.el_,"mousemove",this.handleMouseMove),this.removeListenersAddedOnMousedownAndTouchstart(),this.addClass("disabled"),this.enabled_=!1,this.player_.scrubbing())){const e=this.getChild("seekBar");this.player_.scrubbing(!1),e.videoWasPlaying&&vr(this.player_.play())}}enable(){this.children().forEach(e=>e.enable&&e.enable()),!this.enabled()&&(this.on(["mousedown","touchstart"],this.handleMouseDownHandler_),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)}removeListenersAddedOnMousedownAndTouchstart(){const e=this.el_.ownerDocument;this.off(e,"mousemove",this.throttledHandleMouseSeek),this.off(e,"touchmove",this.throttledHandleMouseSeek),this.off(e,"mouseup",this.handleMouseUpHandler_),this.off(e,"touchend",this.handleMouseUpHandler_)}handleMouseDown(e){const t=this.el_.ownerDocument,i=this.getChild("seekBar");i&&i.handleMouseDown(e),this.on(t,"mousemove",this.throttledHandleMouseSeek),this.on(t,"touchmove",this.throttledHandleMouseSeek),this.on(t,"mouseup",this.handleMouseUpHandler_),this.on(t,"touchend",this.handleMouseUpHandler_)}handleMouseUp(e){const t=this.getChild("seekBar");t&&t.handleMouseUp(e),this.removeListenersAddedOnMousedownAndTouchstart()}}mf.prototype.options_={children:["seekBar"]},$e.registerComponent("ProgressControl",mf);class gf extends kn{constructor(e,t){super(e,t);this.on(e,["enterpictureinpicture","leavepictureinpicture"],i=>this.handlePictureInPictureChange(i)),this.on(e,["disablepictureinpicturechanged","loadedmetadata"],i=>this.handlePictureInPictureEnabledChange(i)),this.on(e,["loadedmetadata","audioonlymodechange","audiopostermodechange"],()=>{e.currentType().substring(0,5)==="audio"||e.audioPosterMode()||e.audioOnlyMode()?(e.isInPictureInPicture()&&e.exitPictureInPicture(),this.hide()):this.show()}),this.disable()}buildCSSClass(){return`vjs-picture-in-picture-control ${super.buildCSSClass()}`}handlePictureInPictureEnabledChange(){Ee().pictureInPictureEnabled&&this.player_.disablePictureInPicture()===!1||this.player_.options_.enableDocumentPictureInPicture&&"documentPictureInPicture"in q()?this.enable():this.disable()}handlePictureInPictureChange(e){this.player_.isInPictureInPicture()?this.controlText("Exit Picture-in-Picture"):this.controlText("Picture-in-Picture"),this.handlePictureInPictureEnabledChange()}handleClick(e){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()}}gf.prototype.controlText_="Picture-in-Picture",$e.registerComponent("PictureInPictureToggle",gf);class yf extends kn{constructor(e,t){super(e,t);this.on(e,"fullscreenchange",i=>this.handleFullscreenChange(i)),Ee()[e.fsApi_.fullscreenEnabled]===!1&&this.disable()}buildCSSClass(){return`vjs-fullscreen-control ${super.buildCSSClass()}`}handleFullscreenChange(e){this.player_.isFullscreen()?this.controlText("Exit Fullscreen"):this.controlText("Fullscreen")}handleClick(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()}}yf.prototype.controlText_="Fullscreen",$e.registerComponent("FullscreenToggle",yf);const Ny=function(n,e){e.tech_&&!e.tech_.featuresVolumeControl&&n.addClass("vjs-hidden"),n.on(e,"loadstart",function(){e.tech_.featuresVolumeControl?n.removeClass("vjs-hidden"):n.addClass("vjs-hidden")})};class Uy extends $e{createEl(){const e=super.createEl("div",{className:"vjs-volume-level"});return e.appendChild(super.createEl("span",{className:"vjs-control-text"})),e}}$e.registerComponent("VolumeLevel",Uy);class jy extends $e{constructor(e,t){super(e,t);this.update=gr(ui(this,this.update),Gn)}createEl(){return super.createEl("div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})}update(e,t,i,r){if(!i){const s=m(this.el_),a=m(this.player_.el()),o=e.width*t;if(!a||!s)return;const l=e.left-a.left+o,u=e.width-o+(a.right-e.right);let d=s.width/2;l<d?d+=d-l:u<d&&(d=u),d<0?d=0:d>s.width&&(d=s.width),this.el_.style.right=`-${d}px`}this.write(`${r}%`)}write(e){mr(this.el_,e)}updateVolume(e,t,i,r,s){this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",()=>{this.update(e,t,i,r.toFixed(0)),s&&s()})}}$e.registerComponent("VolumeLevelTooltip",jy);class vf extends $e{constructor(e,t){super(e,t);this.update=gr(ui(this,this.update),Gn)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(e,t,i){const r=100*t;this.getChild("volumeLevelTooltip").updateVolume(e,t,i,r,()=>{i?this.el_.style.bottom=`${e.height*t}px`:this.el_.style.left=`${e.width*t}px`})}}vf.prototype.options_={children:["volumeLevelTooltip"]},$e.registerComponent("MouseVolumeLevelDisplay",vf);class dl extends Sd{constructor(e,t){super(e,t);this.on("slideractive",i=>this.updateLastVolume_(i)),this.on(e,"volumechange",i=>this.updateARIAAttributes(i)),e.ready(()=>this.updateARIAAttributes())}createEl(){return super.createEl("div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})}handleMouseDown(e){!se(e)||super.handleMouseDown(e)}handleMouseMove(e){const t=this.getChild("mouseVolumeLevelDisplay");if(t){const i=this.el(),r=m(i),s=this.vertical();let a=M(i,e);a=s?a.y:a.x,a=to(a,0,1),t.update(r,a,s)}!se(e)||(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))}checkMuted(){this.player_.muted()&&this.player_.muted(!1)}getPercent(){return this.player_.muted()?0:this.player_.volume()}stepForward(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)}stepBack(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)}updateARIAAttributes(e){const t=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",t),this.el_.setAttribute("aria-valuetext",t+"%")}volumeAsPercentage_(){return Math.round(this.player_.volume()*100)}updateLastVolume_(){const e=this.player_.volume();this.one("sliderinactive",()=>{this.player_.volume()===0&&this.player_.lastVolume_(e)})}}dl.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},!Wi&&!Un&&dl.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay"),dl.prototype.playerEvent="volumechange",$e.registerComponent("VolumeBar",dl);class Af extends $e{constructor(e,t={}){t.vertical=t.vertical||!1,(typeof t.volumeBar=="undefined"||ns(t.volumeBar))&&(t.volumeBar=t.volumeBar||{},t.volumeBar.vertical=t.vertical),super(e,t),Ny(this,e),this.throttledHandleMouseMove=gr(ui(this,this.handleMouseMove),Gn),this.handleMouseUpHandler_=i=>this.handleMouseUp(i),this.on("mousedown",i=>this.handleMouseDown(i)),this.on("touchstart",i=>this.handleMouseDown(i)),this.on("mousemove",i=>this.handleMouseMove(i)),this.on(this.volumeBar,["focus","slideractive"],()=>{this.volumeBar.addClass("vjs-slider-active"),this.addClass("vjs-slider-active"),this.trigger("slideractive")}),this.on(this.volumeBar,["blur","sliderinactive"],()=>{this.volumeBar.removeClass("vjs-slider-active"),this.removeClass("vjs-slider-active"),this.trigger("sliderinactive")})}createEl(){let e="vjs-volume-horizontal";return this.options_.vertical&&(e="vjs-volume-vertical"),super.createEl("div",{className:`vjs-volume-control vjs-control ${e}`})}handleMouseDown(e){const t=this.el_.ownerDocument;this.on(t,"mousemove",this.throttledHandleMouseMove),this.on(t,"touchmove",this.throttledHandleMouseMove),this.on(t,"mouseup",this.handleMouseUpHandler_),this.on(t,"touchend",this.handleMouseUpHandler_)}handleMouseUp(e){const t=this.el_.ownerDocument;this.off(t,"mousemove",this.throttledHandleMouseMove),this.off(t,"touchmove",this.throttledHandleMouseMove),this.off(t,"mouseup",this.handleMouseUpHandler_),this.off(t,"touchend",this.handleMouseUpHandler_)}handleMouseMove(e){this.volumeBar.handleMouseMove(e)}}Af.prototype.options_={children:["volumeBar"]},$e.registerComponent("VolumeControl",Af);const $y=function(n,e){e.tech_&&!e.tech_.featuresMuteControl&&n.addClass("vjs-hidden"),n.on(e,"loadstart",function(){e.tech_.featuresMuteControl?n.removeClass("vjs-hidden"):n.addClass("vjs-hidden")})};class bf extends kn{constructor(e,t){super(e,t);$y(this,e),this.on(e,["loadstart","volumechange"],i=>this.update(i))}buildCSSClass(){return`vjs-mute-control ${super.buildCSSClass()}`}handleClick(e){const t=this.player_.volume(),i=this.player_.lastVolume_();if(t===0){const r=i<.1?.1:i;this.player_.volume(r),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())}update(e){this.updateIcon_(),this.updateControlText_()}updateIcon_(){const e=this.player_.volume();let t=3;Wi&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),e===0||this.player_.muted()?t=0:e<.33?t=1:e<.67&&(t=2),ws(this.el_,[0,1,2,3].reduce((i,r)=>i+`${r?" ":""}vjs-vol-${r}`,"")),wn(this.el_,`vjs-vol-${t}`)}updateControlText_(){const t=this.player_.muted()||this.player_.volume()===0?"Unmute":"Mute";this.controlText()!==t&&this.controlText(t)}}bf.prototype.controlText_="Mute",$e.registerComponent("MuteToggle",bf);class _f extends $e{constructor(e,t={}){typeof t.inline!="undefined"?t.inline=t.inline:t.inline=!0,(typeof t.volumeControl=="undefined"||ns(t.volumeControl))&&(t.volumeControl=t.volumeControl||{},t.volumeControl.vertical=!t.inline),super(e,t),this.handleKeyPressHandler_=i=>this.handleKeyPress(i),this.on(e,["loadstart"],i=>this.volumePanelState_(i)),this.on(this.muteToggle,"keyup",i=>this.handleKeyPress(i)),this.on(this.volumeControl,"keyup",i=>this.handleVolumeControlKeyUp(i)),this.on("keydown",i=>this.handleKeyPress(i)),this.on("mouseover",i=>this.handleMouseOver(i)),this.on("mouseout",i=>this.handleMouseOut(i)),this.on(this.volumeControl,["slideractive"],this.sliderActive_),this.on(this.volumeControl,["sliderinactive"],this.sliderInactive_)}sliderActive_(){this.addClass("vjs-slider-active")}sliderInactive_(){this.removeClass("vjs-slider-active")}volumePanelState_(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")}createEl(){let e="vjs-volume-panel-horizontal";return this.options_.inline||(e="vjs-volume-panel-vertical"),super.createEl("div",{className:`vjs-volume-panel vjs-control ${e}`})}dispose(){this.handleMouseOut(),super.dispose()}handleVolumeControlKeyUp(e){ce().isEventKey(e,"Esc")&&this.muteToggle.focus()}handleMouseOver(e){this.addClass("vjs-hover"),Dn(Ee(),"keyup",this.handleKeyPressHandler_)}handleMouseOut(e){this.removeClass("vjs-hover"),Xi(Ee(),"keyup",this.handleKeyPressHandler_)}handleKeyPress(e){ce().isEventKey(e,"Esc")&&this.handleMouseOut()}}_f.prototype.options_={children:["muteToggle","volumeControl"]},$e.registerComponent("VolumePanel",_f);class Gy extends kn{constructor(e,t){super(e,t);this.validOptions=[5,10,30],this.skipTime=this.getSkipForwardTime(),this.skipTime&&this.validOptions.includes(this.skipTime)?(this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime])),this.show()):this.hide()}getSkipForwardTime(){const e=this.options_.playerOptions;return e.controlBar&&e.controlBar.skipButtons&&e.controlBar.skipButtons.forward}buildCSSClass(){return`vjs-skip-forward-${this.getSkipForwardTime()} ${super.buildCSSClass()}`}handleClick(e){const t=this.player_.currentTime(),i=this.player_.liveTracker,r=i&&i.isLive()?i.seekableEnd():this.player_.duration();let s;t+this.skipTime<=r?s=t+this.skipTime:s=r,this.player_.currentTime(s)}handleLanguagechange(){this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime]))}}$e.registerComponent("SkipForward",Gy);class xf extends kn{constructor(e,t){super(e,t);this.validOptions=[5,10,30],this.skipTime=this.getSkipBackwardTime(),this.skipTime&&this.validOptions.includes(this.skipTime)?(this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime])),this.show()):this.hide()}getSkipBackwardTime(){const e=this.options_.playerOptions;return e.controlBar&&e.controlBar.skipButtons&&e.controlBar.skipButtons.backward}buildCSSClass(){return`vjs-skip-backward-${this.getSkipBackwardTime()} ${super.buildCSSClass()}`}handleClick(e){const t=this.player_.currentTime(),i=this.player_.liveTracker,r=i&&i.isLive()&&i.seekableStart();let s;r&&t-this.skipTime<=r?s=r:t>=this.skipTime?s=t-this.skipTime:s=0,this.player_.currentTime(s)}handleLanguagechange(){this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime]))}}xf.prototype.controlText_="Skip Backward",$e.registerComponent("SkipBackward",xf);class Ef extends $e{constructor(e,t){super(e,t);t&&(this.menuButton_=t.menuButton),this.focusedChild_=-1,this.on("keydown",i=>this.handleKeyDown(i)),this.boundHandleBlur_=i=>this.handleBlur(i),this.boundHandleTapClick_=i=>this.handleTapClick(i)}addEventListenerForItem(e){e instanceof $e&&(this.on(e,"blur",this.boundHandleBlur_),this.on(e,["tap","click"],this.boundHandleTapClick_))}removeEventListenerForItem(e){e instanceof $e&&(this.off(e,"blur",this.boundHandleBlur_),this.off(e,["tap","click"],this.boundHandleTapClick_))}removeChild(e){typeof e=="string"&&(e=this.getChild(e)),this.removeEventListenerForItem(e),super.removeChild(e)}addItem(e){const t=this.addChild(e);t&&this.addEventListenerForItem(t)}createEl(){const e=this.options_.contentElType||"ul";this.contentEl_=Bt(e,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");const t=super.createEl("div",{append:this.contentEl_,className:"vjs-menu"});return t.appendChild(this.contentEl_),Dn(t,"click",function(i){i.preventDefault(),i.stopImmediatePropagation()}),t}dispose(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,super.dispose()}handleBlur(e){const t=e.relatedTarget||Ee().activeElement;if(!this.children().some(i=>i.el()===t)){const i=this.menuButton_;i&&i.buttonPressed_&&t!==i.el().firstChild&&i.unpressButton()}}handleTapClick(e){if(this.menuButton_){this.menuButton_.unpressButton();const t=this.children();if(!Array.isArray(t))return;const i=t.filter(r=>r.el()===e.target)[0];if(!i)return;i.name()!=="CaptionSettingsMenuItem"&&this.menuButton_.focus()}}handleKeyDown(e){ce().isEventKey(e,"Left")||ce().isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(ce().isEventKey(e,"Right")||ce().isEventKey(e,"Up"))&&(e.preventDefault(),e.stopPropagation(),this.stepBack())}stepForward(){let e=0;this.focusedChild_!==void 0&&(e=this.focusedChild_+1),this.focus(e)}stepBack(){let e=0;this.focusedChild_!==void 0&&(e=this.focusedChild_-1),this.focus(e)}focus(e=0){const t=this.children().slice();t.length&&t[0].hasClass("vjs-menu-title")&&t.shift(),t.length>0&&(e<0?e=0:e>=t.length&&(e=t.length-1),this.focusedChild_=e,t[e].el_.focus())}}$e.registerComponent("Menu",Ef);class Dd extends $e{constructor(e,t={}){super(e,t);this.menuButton_=new kn(e,t),this.menuButton_.controlText(this.controlText_),this.menuButton_.el_.setAttribute("aria-haspopup","true");const i=kn.prototype.buildCSSClass();this.menuButton_.el_.className=this.buildCSSClass()+" "+i,this.menuButton_.removeClass("vjs-control"),this.addChild(this.menuButton_),this.update(),this.enabled_=!0;const r=s=>this.handleClick(s);this.handleMenuKeyUp_=s=>this.handleMenuKeyUp(s),this.on(this.menuButton_,"tap",r),this.on(this.menuButton_,"click",r),this.on(this.menuButton_,"keydown",s=>this.handleKeyDown(s)),this.on(this.menuButton_,"mouseenter",()=>{this.addClass("vjs-hover"),this.menu.show(),Dn(Ee(),"keyup",this.handleMenuKeyUp_)}),this.on("mouseleave",s=>this.handleMouseLeave(s)),this.on("keydown",s=>this.handleSubmenuKeyDown(s))}update(){const e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?(this.hide(),this.menu.contentEl_.removeAttribute("role")):(this.show(),this.menu.contentEl_.setAttribute("role","menu"))}createMenu(){const e=new Ef(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){const t=Bt("li",{className:"vjs-menu-title",textContent:Si(this.options_.title),tabIndex:-1}),i=new $e(this.player_,{el:t});e.addItem(i)}if(this.items=this.createItems(),this.items)for(let t=0;t<this.items.length;t++)e.addItem(this.items[t]);return e}createItems(){}createEl(){return super.createEl("div",{className:this.buildWrapperCSSClass()},{})}buildWrapperCSSClass(){let e="vjs-menu-button";this.options_.inline===!0?e+="-inline":e+="-popup";const t=kn.prototype.buildCSSClass();return`vjs-menu-button ${e} ${t} ${super.buildCSSClass()}`}buildCSSClass(){let e="vjs-menu-button";return this.options_.inline===!0?e+="-inline":e+="-popup",`vjs-menu-button ${e} ${super.buildCSSClass()}`}controlText(e,t=this.menuButton_.el()){return this.menuButton_.controlText(e,t)}dispose(){this.handleMouseLeave(),super.dispose()}handleClick(e){this.buttonPressed_?this.unpressButton():this.pressButton()}handleMouseLeave(e){this.removeClass("vjs-hover"),Xi(Ee(),"keyup",this.handleMenuKeyUp_)}focus(){this.menuButton_.focus()}blur(){this.menuButton_.blur()}handleKeyDown(e){ce().isEventKey(e,"Esc")||ce().isEventKey(e,"Tab")?(this.buttonPressed_&&this.unpressButton(),ce().isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus())):(ce().isEventKey(e,"Up")||ce().isEventKey(e,"Down"))&&(this.buttonPressed_||(e.preventDefault(),this.pressButton()))}handleMenuKeyUp(e){(ce().isEventKey(e,"Esc")||ce().isEventKey(e,"Tab"))&&this.removeClass("vjs-hover")}handleSubmenuKeyPress(e){this.handleSubmenuKeyDown(e)}handleSubmenuKeyDown(e){(ce().isEventKey(e,"Esc")||ce().isEventKey(e,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),ce().isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus()))}pressButton(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),Wi&&us())return;this.menu.focus()}}unpressButton(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))}disable(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()}enable(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()}}$e.registerComponent("MenuButton",Dd);class kd extends Dd{constructor(e,t){const i=t.tracks;super(e,t);if(this.items.length<=1&&this.hide(),!i)return;const r=ui(this,this.update);i.addEventListener("removetrack",r),i.addEventListener("addtrack",r),i.addEventListener("labelchange",r),this.player_.on("ready",r),this.player_.on("dispose",function(){i.removeEventListener("removetrack",r),i.removeEventListener("addtrack",r),i.removeEventListener("labelchange",r)})}}$e.registerComponent("TrackButton",kd);const Vy=["Tab","Esc","Up","Down","Right","Left"];class io extends ll{constructor(e,t){super(e,t);this.selectable=t.selectable,this.isSelected_=t.selected||!1,this.multiSelectable=t.multiSelectable,this.selected(this.isSelected_),this.selectable?this.multiSelectable?this.el_.setAttribute("role","menuitemcheckbox"):this.el_.setAttribute("role","menuitemradio"):this.el_.setAttribute("role","menuitem")}createEl(e,t,i){this.nonIconControl=!0;const r=super.createEl("li",Object.assign({className:"vjs-menu-item",tabIndex:-1},t),i);return r.replaceChild(Bt("span",{className:"vjs-menu-item-text",textContent:this.localize(this.options_.label)}),r.querySelector(".vjs-icon-placeholder")),r}handleKeyDown(e){Vy.some(t=>ce().isEventKey(e,t))||super.handleKeyDown(e)}handleClick(e){this.selected(!0)}selected(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))}}$e.registerComponent("MenuItem",io);class no extends io{constructor(e,t){const i=t.track,r=e.textTracks();t.label=i.label||i.language||"Unknown",t.selected=i.mode==="showing",super(e,t),this.track=i,this.kinds=(t.kinds||[t.kind||this.track.kind]).filter(Boolean);const s=(...o)=>{this.handleTracksChange.apply(this,o)},a=(...o)=>{this.handleSelectedLanguageChange.apply(this,o)};if(e.on(["loadstart","texttrackchange"],s),r.addEventListener("change",s),r.addEventListener("selectedlanguagechange",a),this.on("dispose",function(){e.off(["loadstart","texttrackchange"],s),r.removeEventListener("change",s),r.removeEventListener("selectedlanguagechange",a)}),r.onchange===void 0){let o;this.on(["tap","click"],function(){if(typeof q().Event!="object")try{o=new(q()).Event("change")}catch(l){}o||(o=Ee().createEvent("Event"),o.initEvent("change",!0,!0)),r.dispatchEvent(o)})}this.handleTracksChange()}handleClick(e){const t=this.track,i=this.player_.textTracks();if(super.handleClick(e),!!i)for(let r=0;r<i.length;r++){const s=i[r];this.kinds.indexOf(s.kind)!==-1&&(s===t?s.mode!=="showing"&&(s.mode="showing"):s.mode!=="disabled"&&(s.mode="disabled"))}}handleTracksChange(e){const t=this.track.mode==="showing";t!==this.isSelected_&&this.selected(t)}handleSelectedLanguageChange(e){if(this.track.mode==="showing"){const t=this.player_.cache_.selectedLanguage;if(t&&t.enabled&&t.language===this.track.language&&t.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}}dispose(){this.track=null,super.dispose()}}$e.registerComponent("TextTrackMenuItem",no);class Tf extends no{constructor(e,t){t.track={player:e,kind:t.kind,kinds:t.kinds,default:!1,mode:"disabled"},t.kinds||(t.kinds=[t.kind]),t.label?t.track.label=t.label:t.track.label=t.kinds.join(" and ")+" off",t.selectable=!0,t.multiSelectable=!1,super(e,t)}handleTracksChange(e){const t=this.player().textTracks();let i=!0;for(let r=0,s=t.length;r<s;r++){const a=t[r];if(this.options_.kinds.indexOf(a.kind)>-1&&a.mode==="showing"){i=!1;break}}i!==this.isSelected_&&this.selected(i)}handleSelectedLanguageChange(e){const t=this.player().textTracks();let i=!0;for(let r=0,s=t.length;r<s;r++){const a=t[r];if(["captions","descriptions","subtitles"].indexOf(a.kind)>-1&&a.mode==="showing"){i=!1;break}}i&&(this.player_.cache_.selectedLanguage={enabled:!1})}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.label),super.handleLanguagechange()}}$e.registerComponent("OffTextTrackMenuItem",Tf);class ma extends kd{constructor(e,t={}){t.tracks=e.textTracks(),super(e,t)}createItems(e=[],t=no){let i;this.label_&&(i=`${this.label_} off`),e.push(new Tf(this.player_,{kinds:this.kinds_,kind:this.kind_,label:i})),this.hideThreshold_+=1;const r=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(let s=0;s<r.length;s++){const a=r[s];if(this.kinds_.indexOf(a.kind)>-1){const o=new t(this.player_,{track:a,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});o.addClass(`vjs-${a.kind}-menu-item`),e.push(o)}}return e}}$e.registerComponent("TextTrackButton",ma);class Sf extends io{constructor(e,t){const i=t.track,r=t.cue,s=e.currentTime();t.selectable=!0,t.multiSelectable=!1,t.label=r.text,t.selected=r.startTime<=s&&s<r.endTime,super(e,t),this.track=i,this.cue=r}handleClick(e){super.handleClick(),this.player_.currentTime(this.cue.startTime)}}$e.registerComponent("ChaptersTrackMenuItem",Sf);class Id extends ma{constructor(e,t,i){super(e,t,i);this.selectCurrentItem_=()=>{this.items.forEach(r=>{r.selected(this.track_.activeCues[0]===r.cue)})}}buildCSSClass(){return`vjs-chapters-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-chapters-button ${super.buildWrapperCSSClass()}`}update(e){if(e&&e.track&&e.track.kind!=="chapters")return;const t=this.findChaptersTrack();t!==this.track_?(this.setTrack(t),super.update()):(!this.items||t&&t.cues&&t.cues.length!==this.items.length)&&super.update()}setTrack(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){const t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);t&&t.removeEventListener("load",this.updateHandler_),this.track_.removeEventListener("cuechange",this.selectCurrentItem_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";const t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);t&&t.addEventListener("load",this.updateHandler_),this.track_.addEventListener("cuechange",this.selectCurrentItem_)}}}findChaptersTrack(){const e=this.player_.textTracks()||[];for(let t=e.length-1;t>=0;t--){const i=e[t];if(i.kind===this.kind_)return i}}getMenuCaption(){return this.track_&&this.track_.label?this.track_.label:this.localize(Si(this.kind_))}createMenu(){return this.options_.title=this.getMenuCaption(),super.createMenu()}createItems(){const e=[];if(!this.track_)return e;const t=this.track_.cues;if(!t)return e;for(let i=0,r=t.length;i<r;i++){const s=t[i],a=new Sf(this.player_,{track:this.track_,cue:s});e.push(a)}return e}}Id.prototype.kind_="chapters",Id.prototype.controlText_="Chapters",$e.registerComponent("ChaptersButton",Id);class Rd extends ma{constructor(e,t,i){super(e,t,i);const r=e.textTracks(),s=ui(this,this.handleTracksChange);r.addEventListener("change",s),this.on("dispose",function(){r.removeEventListener("change",s)})}handleTracksChange(e){const t=this.player().textTracks();let i=!1;for(let r=0,s=t.length;r<s;r++){const a=t[r];if(a.kind!==this.kind_&&a.mode==="showing"){i=!0;break}}i?this.disable():this.enable()}buildCSSClass(){return`vjs-descriptions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-descriptions-button ${super.buildWrapperCSSClass()}`}}Rd.prototype.kind_="descriptions",Rd.prototype.controlText_="Descriptions",$e.registerComponent("DescriptionsButton",Rd);class Od extends ma{constructor(e,t,i){super(e,t,i)}buildCSSClass(){return`vjs-subtitles-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subtitles-button ${super.buildWrapperCSSClass()}`}}Od.prototype.kind_="subtitles",Od.prototype.controlText_="Subtitles",$e.registerComponent("SubtitlesButton",Od);class Pd extends no{constructor(e,t){t.track={player:e,kind:t.kind,label:t.kind+" settings",selectable:!1,default:!1,mode:"disabled"},t.selectable=!1,t.name="CaptionSettingsMenuItem",super(e,t),this.addClass("vjs-texttrack-settings"),this.controlText(", opens "+t.kind+" settings dialog")}handleClick(e){this.player().getChild("textTrackSettings").open()}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.kind+" settings"),super.handleLanguagechange()}}$e.registerComponent("CaptionSettingsMenuItem",Pd);class Bd extends ma{constructor(e,t,i){super(e,t,i)}buildCSSClass(){return`vjs-captions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-captions-button ${super.buildWrapperCSSClass()}`}createItems(){const e=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(e.push(new Pd(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),super.createItems(e)}}Bd.prototype.kind_="captions",Bd.prototype.controlText_="Captions",$e.registerComponent("CaptionsButton",Bd);class Cf extends no{createEl(e,t,i){const r=super.createEl(e,t,i),s=r.querySelector(".vjs-menu-item-text");return this.options_.track.kind==="captions"&&(s.appendChild(Bt("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),s.appendChild(Bt("span",{className:"vjs-control-text",textContent:` ${this.localize("Captions")}`}))),r}}$e.registerComponent("SubsCapsMenuItem",Cf);class Fd extends ma{constructor(e,t={}){super(e,t);this.label_="subtitles",["en","en-us","en-ca","fr-ca"].indexOf(this.player_.language_)>-1&&(this.label_="captions"),this.menuButton_.controlText(Si(this.label_))}buildCSSClass(){return`vjs-subs-caps-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subs-caps-button ${super.buildWrapperCSSClass()}`}createItems(){let e=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(e.push(new Pd(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e=super.createItems(e,Cf),e}}Fd.prototype.kinds_=["captions","subtitles"],Fd.prototype.controlText_="Subtitles",$e.registerComponent("SubsCapsButton",Fd);class wf extends io{constructor(e,t){const i=t.track,r=e.audioTracks();t.label=i.label||i.language||"Unknown",t.selected=i.enabled,super(e,t),this.track=i,this.addClass(`vjs-${i.kind}-menu-item`);const s=(...a)=>{this.handleTracksChange.apply(this,a)};r.addEventListener("change",s),this.on("dispose",()=>{r.removeEventListener("change",s)})}createEl(e,t,i){const r=super.createEl(e,t,i),s=r.querySelector(".vjs-menu-item-text");return this.options_.track.kind==="main-desc"&&(s.appendChild(Bt("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),s.appendChild(Bt("span",{className:"vjs-control-text",textContent:" "+this.localize("Descriptions")}))),r}handleClick(e){if(super.handleClick(e),this.track.enabled=!0,this.player_.tech_.featuresNativeAudioTracks){const t=this.player_.audioTracks();for(let i=0;i<t.length;i++){const r=t[i];r!==this.track&&(r.enabled=r===this.track)}}}handleTracksChange(e){this.selected(this.track.enabled)}}$e.registerComponent("AudioTrackMenuItem",wf);class Lf extends kd{constructor(e,t={}){t.tracks=e.audioTracks(),super(e,t)}buildCSSClass(){return`vjs-audio-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-audio-button ${super.buildWrapperCSSClass()}`}createItems(e=[]){this.hideThreshold_=1;const t=this.player_.audioTracks();for(let i=0;i<t.length;i++){const r=t[i];e.push(new wf(this.player_,{track:r,selectable:!0,multiSelectable:!1}))}return e}}Lf.prototype.controlText_="Audio Track",$e.registerComponent("AudioTrackButton",Lf);class Md extends io{constructor(e,t){const i=t.rate,r=parseFloat(i,10);t.label=i,t.selected=r===e.playbackRate(),t.selectable=!0,t.multiSelectable=!1,super(e,t),this.label=i,this.rate=r,this.on(e,"ratechange",s=>this.update(s))}handleClick(e){super.handleClick(),this.player().playbackRate(this.rate)}update(e){this.selected(this.player().playbackRate()===this.rate)}}Md.prototype.contentElType="button",$e.registerComponent("PlaybackRateMenuItem",Md);class Df extends Dd{constructor(e,t){super(e,t);this.menuButton_.el_.setAttribute("aria-describedby",this.labelElId_),this.updateVisibility(),this.updateLabel(),this.on(e,"loadstart",i=>this.updateVisibility(i)),this.on(e,"ratechange",i=>this.updateLabel(i)),this.on(e,"playbackrateschange",i=>this.handlePlaybackRateschange(i))}createEl(){const e=super.createEl();return this.labelElId_="vjs-playback-rate-value-label-"+this.id_,this.labelEl_=Bt("div",{className:"vjs-playback-rate-value",id:this.labelElId_,textContent:"1x"}),e.appendChild(this.labelEl_),e}dispose(){this.labelEl_=null,super.dispose()}buildCSSClass(){return`vjs-playback-rate ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-playback-rate ${super.buildWrapperCSSClass()}`}createItems(){const e=this.playbackRates(),t=[];for(let i=e.length-1;i>=0;i--)t.push(new Md(this.player(),{rate:e[i]+"x"}));return t}handlePlaybackRateschange(e){this.update()}playbackRates(){const e=this.player();return e.playbackRates&&e.playbackRates()||[]}playbackRateSupported(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0}updateVisibility(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")}updateLabel(e){this.playbackRateSupported()&&(this.labelEl_.textContent=this.player().playbackRate()+"x")}}Df.prototype.controlText_="Playback Rate",$e.registerComponent("PlaybackRateMenuButton",Df);class kf extends $e{buildCSSClass(){return`vjs-spacer ${super.buildCSSClass()}`}createEl(e="div",t={},i={}){return t.className||(t.className=this.buildCSSClass()),super.createEl(e,t,i)}}$e.registerComponent("Spacer",kf);class Hy extends kf{buildCSSClass(){return`vjs-custom-control-spacer ${super.buildCSSClass()}`}createEl(){return super.createEl("div",{className:this.buildCSSClass(),textContent:"\xA0"})}}$e.registerComponent("CustomControlSpacer",Hy);class cl extends $e{createEl(){return super.createEl("div",{className:"vjs-control-bar",dir:"ltr"})}}cl.prototype.options_={children:["playToggle","skipBackward","skipForward","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]},"exitPictureInPicture"in Ee()&&cl.prototype.options_.children.splice(cl.prototype.options_.children.length-1,0,"pictureInPictureToggle"),$e.registerComponent("ControlBar",cl);class If extends ca{constructor(e,t){super(e,t);this.on(e,"error",i=>this.open(i))}buildCSSClass(){return`vjs-error-display ${super.buildCSSClass()}`}content(){const e=this.player().error();return e?this.localize(e.message):""}}If.prototype.options_=Object.assign({},ca.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),$e.registerComponent("ErrorDisplay",If);const Nd="vjs-text-track-settings",Rf=["#000","Black"],Of=["#00F","Blue"],Pf=["#0FF","Cyan"],Bf=["#0F0","Green"],Ff=["#F0F","Magenta"],Mf=["#F00","Red"],Nf=["#FFF","White"],Uf=["#FF0","Yellow"],Ud=["1","Opaque"],jd=["0.5","Semi-Transparent"],jf=["0","Transparent"],Rs={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[Rf,Nf,Mf,Bf,Of,Uf,Ff,Pf]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Opacity",options:[Ud,jd,jf]},color:{selector:".vjs-text-color > select",id:"captions-foreground-color-%s",label:"Color",options:[Nf,Rf,Mf,Bf,Of,Uf,Ff,Pf]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:n=>n==="1.00"?null:Number(n)},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Opacity",options:[Ud,jd]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Opacity",options:[jf,jd,Ud]}};Rs.windowColor.options=Rs.backgroundColor.options;function $f(n,e){if(e&&(n=e(n)),n&&n!=="none")return n}function Wy(n,e){const t=n.options[n.options.selectedIndex].value;return $f(t,e)}function Ky(n,e,t){if(!!e){for(let i=0;i<n.options.length;i++)if($f(n.options[i].value,t)===e){n.selectedIndex=i;break}}}class qy extends ca{constructor(e,t){t.temporary=!1,super(e,t),this.updateDisplay=this.updateDisplay.bind(this),this.fill(),this.hasBeenOpened_=this.hasBeenFilled_=!0,this.endDialog=Bt("p",{className:"vjs-control-text",textContent:this.localize("End of dialog window.")}),this.el().appendChild(this.endDialog),this.setDefaults(),t.persistTextTrackSettings===void 0&&(this.options_.persistTextTrackSettings=this.options_.playerOptions.persistTextTrackSettings),this.on(this.$(".vjs-done-button"),"click",()=>{this.saveSettings(),this.close()}),this.on(this.$(".vjs-default-button"),"click",()=>{this.setDefaults(),this.updateDisplay()}),ts(Rs,i=>{this.on(this.$(i.selector),"change",this.updateDisplay)}),this.options_.persistTextTrackSettings&&this.restoreSettings()}dispose(){this.endDialog=null,super.dispose()}createElSelect_(e,t="",i="label"){const r=Rs[e],s=r.id.replace("%s",this.id_),a=[t,s].join(" ").trim();return[`<${i} id="${s}" class="${i==="label"?"vjs-label":""}">`,this.localize(r.label),`</${i}>`,`<select aria-labelledby="${a}">`].concat(r.options.map(o=>{const l=s+"-"+o[1].replace(/\W+/g,"");return[`<option id="${l}" value="${o[0]}" `,`aria-labelledby="${a} ${l}">`,this.localize(o[1]),"</option>"].join("")})).concat("</select>").join("")}createElFgColor_(){const e=`captions-text-legend-${this.id_}`;return['<fieldset class="vjs-fg vjs-track-setting">',`<legend id="${e}">`,this.localize("Text"),"</legend>",'<span class="vjs-text-color">',this.createElSelect_("color",e),"</span>",'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")}createElBgColor_(){const e=`captions-background-${this.id_}`;return['<fieldset class="vjs-bg vjs-track-setting">',`<legend id="${e}">`,this.localize("Text Background"),"</legend>",'<span class="vjs-bg-color">',this.createElSelect_("backgroundColor",e),"</span>",'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")}createElWinColor_(){const e=`captions-window-${this.id_}`;return['<fieldset class="vjs-window vjs-track-setting">',`<legend id="${e}">`,this.localize("Caption Area Background"),"</legend>",'<span class="vjs-window-color">',this.createElSelect_("windowColor",e),"</span>",'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")}createElColors_(){return Bt("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})}createElFont_(){return Bt("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})}createElControls_(){const e=this.localize("restore all settings to the default values");return Bt("div",{className:"vjs-track-settings-controls",innerHTML:[`<button type="button" class="vjs-default-button" title="${e}">`,this.localize("Reset"),`<span class="vjs-control-text"> ${e}</span>`,"</button>",`<button type="button" class="vjs-done-button">${this.localize("Done")}</button>`].join("")})}content(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]}label(){return this.localize("Caption Settings Dialog")}description(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")}buildCSSClass(){return super.buildCSSClass()+" vjs-text-track-settings"}getValues(){return is(Rs,(e,t,i)=>{const r=Wy(this.$(t.selector),t.parser);return r!==void 0&&(e[i]=r),e},{})}setValues(e){ts(Rs,(t,i)=>{Ky(this.$(t.selector),e[i],t.parser)})}setDefaults(){ts(Rs,e=>{const t=e.hasOwnProperty("default")?e.default:0;this.$(e.selector).selectedIndex=t})}restoreSettings(){let e;try{e=JSON.parse(q().localStorage.getItem(Nd))}catch(t){Ut.warn(t)}e&&this.setValues(e)}saveSettings(){if(!this.options_.persistTextTrackSettings)return;const e=this.getValues();try{Object.keys(e).length?q().localStorage.setItem(Nd,JSON.stringify(e)):q().localStorage.removeItem(Nd)}catch(t){Ut.warn(t)}}updateDisplay(){const e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()}conditionalBlur_(){this.previouslyActiveEl_=null;const e=this.player_.controlBar,t=e&&e.subsCapsButton,i=e&&e.captionsButton;t?t.focus():i&&i.focus()}handleLanguagechange(){this.fill()}}$e.registerComponent("TextTrackSettings",qy);class zy extends $e{constructor(e,t){let i=t.ResizeObserver||q().ResizeObserver;t.ResizeObserver===null&&(i=!1);const r=Xt({createEl:!i,reportTouchActivity:!1},t);super(e,r);this.ResizeObserver=t.ResizeObserver||q().ResizeObserver,this.loadListener_=null,this.resizeObserver_=null,this.debouncedHandler_=jh(()=>{this.resizeHandler()},100,!1,this),i?(this.resizeObserver_=new this.ResizeObserver(this.debouncedHandler_),this.resizeObserver_.observe(e.el())):(this.loadListener_=()=>{if(!this.el_||!this.el_.contentWindow)return;const s=this.debouncedHandler_;let a=this.unloadListener_=function(){Xi(this,"resize",s),Xi(this,"unload",a),a=null};Dn(this.el_.contentWindow,"unload",a),Dn(this.el_.contentWindow,"resize",s)},this.one("load",this.loadListener_))}createEl(){return super.createEl("iframe",{className:"vjs-resize-manager",tabIndex:-1,title:this.localize("No content")},{"aria-hidden":"true"})}resizeHandler(){!this.player_||!this.player_.trigger||this.player_.trigger("playerresize")}dispose(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,super.dispose()}}$e.registerComponent("ResizeManager",zy);const Yy={trackingThreshold:20,liveTolerance:15};class Xy extends $e{constructor(e,t){const i=Xt(Yy,t,{createEl:!1});super(e,i);this.trackLiveHandler_=()=>this.trackLive_(),this.handlePlay_=r=>this.handlePlay(r),this.handleFirstTimeupdate_=r=>this.handleFirstTimeupdate(r),this.handleSeeked_=r=>this.handleSeeked(r),this.seekToLiveEdge_=r=>this.seekToLiveEdge(r),this.reset_(),this.on(this.player_,"durationchange",r=>this.handleDurationchange(r)),this.on(this.player_,"canplay",()=>this.toggleTracking())}trackLive_(){const e=this.player_.seekable();if(!e||!e.length)return;const t=Number(q().performance.now().toFixed(4)),i=this.lastTime_===-1?0:(t-this.lastTime_)/1e3;this.lastTime_=t,this.pastSeekEnd_=this.pastSeekEnd()+i;const r=this.liveCurrentTime(),s=this.player_.currentTime();let a=this.player_.paused()||this.seekedBehindLive_||Math.abs(r-s)>this.options_.liveTolerance;(!this.timeupdateSeen_||r===Infinity)&&(a=!1),a!==this.behindLiveEdge_&&(this.behindLiveEdge_=a,this.trigger("liveedgechange"))}handleDurationchange(){this.toggleTracking()}toggleTracking(){this.player_.duration()===Infinity&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())}startTracking(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLiveHandler_,Gn),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLiveHandler_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked_):(this.one(this.player_,"play",this.handlePlay_),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)))}handleFirstTimeupdate(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked_)}handleSeeked(){const e=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&e>2,this.nextSeekedFromUser_=!1,this.trackLive_()}handlePlay(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)}reset_(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.nextSeekedFromUser_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLiveHandler_),this.off(this.player_,"seeked",this.handleSeeked_),this.off(this.player_,"play",this.handlePlay_),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_),this.off(this.player_,"timeupdate",this.seekToLiveEdge_)}nextSeekedFromUser(){this.nextSeekedFromUser_=!0}stopTracking(){!this.isTracking()||(this.reset_(),this.trigger("liveedgechange"))}seekableEnd(){const e=this.player_.seekable(),t=[];let i=e?e.length:0;for(;i--;)t.push(e.end(i));return t.length?t.sort()[t.length-1]:Infinity}seekableStart(){const e=this.player_.seekable(),t=[];let i=e?e.length:0;for(;i--;)t.push(e.start(i));return t.length?t.sort()[0]:0}liveWindow(){const e=this.liveCurrentTime();return e===Infinity?0:e-this.seekableStart()}isLive(){return this.isTracking()}atLiveEdge(){return!this.behindLiveEdge()}liveCurrentTime(){return this.pastSeekEnd()+this.seekableEnd()}pastSeekEnd(){const e=this.seekableEnd();return this.lastSeekEnd_!==-1&&e!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=e,this.pastSeekEnd_}behindLiveEdge(){return this.behindLiveEdge_}isTracking(){return typeof this.trackingInterval_=="number"}seekToLiveEdge(){this.seekedBehindLive_=!1,!this.atLiveEdge()&&(this.nextSeekedFromUser_=!1,this.player_.currentTime(this.liveCurrentTime()))}dispose(){this.stopTracking(),super.dispose()}}$e.registerComponent("LiveTracker",Xy);class Qy extends $e{constructor(e,t){super(e,t);this.on("statechanged",i=>this.updateDom_()),this.updateDom_()}createEl(){return this.els={title:Bt("div",{className:"vjs-title-bar-title",id:`vjs-title-bar-title-${Ki()}`}),description:Bt("div",{className:"vjs-title-bar-description",id:`vjs-title-bar-description-${Ki()}`})},Bt("div",{className:"vjs-title-bar"},{},Object.values(this.els))}updateDom_(){const e=this.player_.tech_,t=e&&e.el_,i={title:"aria-labelledby",description:"aria-describedby"};["title","description"].forEach(r=>{const s=this.state[r],a=this.els[r],o=i[r];T(a),s&&mr(a,s),t&&(t.removeAttribute(o),s&&t.setAttribute(o,a.id))}),this.state.title||this.state.description?this.show():this.hide()}update(e){this.setState(e)}dispose(){const e=this.player_.tech_,t=e&&e.el_;t&&(t.removeAttribute("aria-labelledby"),t.removeAttribute("aria-describedby")),super.dispose(),this.els=null}}$e.registerComponent("TitleBar",Qy);const $d=n=>{const e=n.el();if(e.hasAttribute("src"))return n.triggerSourceset(e.src),!0;const t=n.$$("source"),i=[];let r="";if(!t.length)return!1;for(let s=0;s<t.length;s++){const a=t[s].src;a&&i.indexOf(a)===-1&&i.push(a)}return i.length?(i.length===1&&(r=i[0]),n.triggerSourceset(r),!0):!1},Zy=Object.defineProperty({},"innerHTML",{get(){return this.cloneNode(!0).innerHTML},set(n){const e=Ee().createElement(this.nodeName.toLowerCase());e.innerHTML=n;const t=Ee().createDocumentFragment();for(;e.childNodes.length;)t.appendChild(e.childNodes[0]);return this.innerText="",q().Element.prototype.appendChild.call(this,t),this.innerHTML}}),Gf=(n,e)=>{let t={};for(let i=0;i<n.length&&(t=Object.getOwnPropertyDescriptor(n[i],e),!(t&&t.set&&t.get));i++);return t.enumerable=!0,t.configurable=!0,t},Jy=n=>Gf([n.el(),q().HTMLMediaElement.prototype,q().Element.prototype,Zy],"innerHTML"),Vf=function(n){const e=n.el();if(e.resetSourceWatch_)return;const t={},i=Jy(n),r=s=>(...a)=>{const o=s.apply(e,a);return $d(n),o};["append","appendChild","insertAdjacentHTML"].forEach(s=>{!e[s]||(t[s]=e[s],e[s]=r(t[s]))}),Object.defineProperty(e,"innerHTML",Xt(i,{set:r(i.set)})),e.resetSourceWatch_=()=>{e.resetSourceWatch_=null,Object.keys(t).forEach(s=>{e[s]=t[s]}),Object.defineProperty(e,"innerHTML",i)},n.one("sourceset",e.resetSourceWatch_)},ev=Object.defineProperty({},"src",{get(){return this.hasAttribute("src")?Jh(q().Element.prototype.getAttribute.call(this,"src")):""},set(n){return q().Element.prototype.setAttribute.call(this,"src",n),n}}),tv=n=>Gf([n.el(),q().HTMLMediaElement.prototype,ev],"src"),iv=function(n){if(!n.featuresSourceset)return;const e=n.el();if(e.resetSourceset_)return;const t=tv(n),i=e.setAttribute,r=e.load;Object.defineProperty(e,"src",Xt(t,{set:s=>{const a=t.set.call(e,s);return n.triggerSourceset(e.src),a}})),e.setAttribute=(s,a)=>{const o=i.call(e,s,a);return/src/i.test(s)&&n.triggerSourceset(e.src),o},e.load=()=>{const s=r.call(e);return $d(n)||(n.triggerSourceset(""),Vf(n)),s},e.currentSrc?n.triggerSourceset(e.currentSrc):$d(n)||Vf(n),e.resetSourceset_=()=>{e.resetSourceset_=null,e.load=r,e.setAttribute=i,Object.defineProperty(e,"src",t),e.resetSourceWatch_&&e.resetSourceWatch_()}};class ct extends Ot{constructor(e,t){super(e,t);const i=e.source;let r=!1;if(this.featuresVideoFrameCallback=this.featuresVideoFrameCallback&&this.el_.tagName==="VIDEO",i&&(this.el_.currentSrc!==i.src||e.tag&&e.tag.initNetworkState_===3)?this.setSource(i):this.handleLateInit_(this.el_),e.enableSourceset&&this.setupSourcesetHandling_(),this.isScrubbing_=!1,this.el_.hasChildNodes()){const s=this.el_.childNodes;let a=s.length;const o=[];for(;a--;){const l=s[a];l.nodeName.toLowerCase()==="track"&&(this.featuresNativeTextTracks?(this.remoteTextTrackEls().addTrackElement_(l),this.remoteTextTracks().addTrack(l.track),this.textTracks().addTrack(l.track),!r&&!this.el_.hasAttribute("crossorigin")&&sl(l.src)&&(r=!0)):o.push(l))}for(let l=0;l<o.length;l++)this.el_.removeChild(o[l])}this.proxyNativeTracks_(),this.featuresNativeTextTracks&&r&&Ut.warn(`Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.
This may prevent text tracks from loading.`),this.restoreMetadataTracksInIOSNativePlayer_(),(Ss||aa)&&e.nativeControlsForTouch===!0&&this.setControls(!0),this.proxyWebkitFullscreen_(),this.triggerReady()}dispose(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),ct.disposeMediaElement(this.el_),this.options_=null,super.dispose()}setupSourcesetHandling_(){iv(this)}restoreMetadataTracksInIOSNativePlayer_(){const e=this.textTracks();let t;const i=()=>{t=[];for(let s=0;s<e.length;s++){const a=e[s];a.kind==="metadata"&&t.push({track:a,storedMode:a.mode})}};i(),e.addEventListener("change",i),this.on("dispose",()=>e.removeEventListener("change",i));const r=()=>{for(let s=0;s<t.length;s++){const a=t[s];a.track.mode==="disabled"&&a.track.mode!==a.storedMode&&(a.track.mode=a.storedMode)}e.removeEventListener("change",r)};this.on("webkitbeginfullscreen",()=>{e.removeEventListener("change",i),e.removeEventListener("change",r),e.addEventListener("change",r)}),this.on("webkitendfullscreen",()=>{e.removeEventListener("change",i),e.addEventListener("change",i),e.removeEventListener("change",r)})}overrideNative_(e,t){if(t!==this[`featuresNative${e}Tracks`])return;const i=e.toLowerCase();this[`${i}TracksListeners_`]&&Object.keys(this[`${i}TracksListeners_`]).forEach(r=>{this.el()[`${i}Tracks`].removeEventListener(r,this[`${i}TracksListeners_`][r])}),this[`featuresNative${e}Tracks`]=!t,this[`${i}TracksListeners_`]=null,this.proxyNativeTracksForType_(i)}overrideNativeAudioTracks(e){this.overrideNative_("Audio",e)}overrideNativeVideoTracks(e){this.overrideNative_("Video",e)}proxyNativeTracksForType_(e){const t=Hn[e],i=this.el()[t.getterName],r=this[t.getterName]();if(!this[`featuresNative${t.capitalName}Tracks`]||!i||!i.addEventListener)return;const s={change:o=>{const l={type:"change",target:r,currentTarget:r,srcElement:r};r.trigger(l),e==="text"&&this[fa.remoteText.getterName]().trigger(l)},addtrack(o){r.addTrack(o.track)},removetrack(o){r.removeTrack(o.track)}},a=function(){const o=[];for(let l=0;l<r.length;l++){let u=!1;for(let d=0;d<i.length;d++)if(i[d]===r[l]){u=!0;break}u||o.push(r[l])}for(;o.length;)r.removeTrack(o.shift())};this[t.getterName+"Listeners_"]=s,Object.keys(s).forEach(o=>{const l=s[o];i.addEventListener(o,l),this.on("dispose",u=>i.removeEventListener(o,l))}),this.on("loadstart",a),this.on("dispose",o=>this.off("loadstart",a))}proxyNativeTracks_(){Hn.names.forEach(e=>{this.proxyNativeTracksForType_(e)})}createEl(){let e=this.options_.tag;if(!e||!(this.options_.playerElIngest||this.movingMediaElementInDOM)){if(e){const i=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(i,e),ct.disposeMediaElement(e),e=i}else{e=Ee().createElement("video");const i=this.options_.tag&&Zn(this.options_.tag),r=Xt({},i);(!Ss||this.options_.nativeControlsForTouch!==!0)&&delete r.controls,Ya(e,Object.assign(r,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}typeof this.options_.preload!="undefined"&&Ln(e,"preload",this.options_.preload),this.options_.disablePictureInPicture!==void 0&&(e.disablePictureInPicture=this.options_.disablePictureInPicture);const t=["loop","muted","playsinline","autoplay"];for(let i=0;i<t.length;i++){const r=t[i],s=this.options_[r];typeof s!="undefined"&&(s?Ln(e,r,r):la(e,r),e[r]=s)}return e}handleLateInit_(e){if(e.networkState===0||e.networkState===3)return;if(e.readyState===0){let i=!1;const r=function(){i=!0};this.on("loadstart",r);const s=function(){i||this.trigger("loadstart")};this.on("loadedmetadata",s),this.ready(function(){this.off("loadstart",r),this.off("loadedmetadata",s),i||this.trigger("loadstart")});return}const t=["loadstart"];t.push("loadedmetadata"),e.readyState>=2&&t.push("loadeddata"),e.readyState>=3&&t.push("canplay"),e.readyState>=4&&t.push("canplaythrough"),this.ready(function(){t.forEach(function(i){this.trigger(i)},this)})}setScrubbing(e){this.isScrubbing_=e}scrubbing(){return this.isScrubbing_}setCurrentTime(e){try{this.isScrubbing_&&this.el_.fastSeek&&oa?this.el_.fastSeek(e):this.el_.currentTime=e}catch(t){Ut(t,"Video is not ready. (Video.js)")}}duration(){if(this.el_.duration===Infinity&&Un&&jn&&this.el_.currentTime===0){const e=()=>{this.el_.currentTime>0&&(this.el_.duration===Infinity&&this.trigger("durationchange"),this.off("timeupdate",e))};return this.on("timeupdate",e),NaN}return this.el_.duration||NaN}width(){return this.el_.offsetWidth}height(){return this.el_.offsetHeight}proxyWebkitFullscreen_(){if(!("webkitDisplayingFullscreen"in this.el_))return;const e=function(){this.trigger("fullscreenchange",{isFullscreen:!1}),this.el_.controls&&!this.options_.nativeControlsForTouch&&this.controls()&&(this.el_.controls=!1)},t=function(){"webkitPresentationMode"in this.el_&&this.el_.webkitPresentationMode!=="picture-in-picture"&&(this.one("webkitendfullscreen",e),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",t),this.on("dispose",()=>{this.off("webkitbeginfullscreen",t),this.off("webkitendfullscreen",e)})}supportsFullScreen(){return typeof this.el_.webkitEnterFullScreen=="function"}enterFullScreen(){const e=this.el_;if(e.paused&&e.networkState<=e.HAVE_METADATA)vr(this.el_.play()),this.setTimeout(function(){e.pause();try{e.webkitEnterFullScreen()}catch(t){this.trigger("fullscreenerror",t)}},0);else try{e.webkitEnterFullScreen()}catch(t){this.trigger("fullscreenerror",t)}}exitFullScreen(){if(!this.el_.webkitDisplayingFullscreen){this.trigger("fullscreenerror",new Error("The video is not fullscreen"));return}this.el_.webkitExitFullScreen()}requestPictureInPicture(){return this.el_.requestPictureInPicture()}requestVideoFrameCallback(e){return this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.requestVideoFrameCallback(e):super.requestVideoFrameCallback(e)}cancelVideoFrameCallback(e){this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.cancelVideoFrameCallback(e):super.cancelVideoFrameCallback(e)}src(e){if(e===void 0)return this.el_.src;this.setSrc(e)}reset(){ct.resetMediaElement(this.el_)}currentSrc(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc}setControls(e){this.el_.controls=!!e}addTextTrack(e,t,i){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,t,i):super.addTextTrack(e,t,i)}createRemoteTextTrack(e){if(!this.featuresNativeTextTracks)return super.createRemoteTextTrack(e);const t=Ee().createElement("track");return e.kind&&(t.kind=e.kind),e.label&&(t.label=e.label),(e.language||e.srclang)&&(t.srclang=e.language||e.srclang),e.default&&(t.default=e.default),e.id&&(t.id=e.id),e.src&&(t.src=e.src),t}addRemoteTextTrack(e,t){const i=super.addRemoteTextTrack(e,t);return this.featuresNativeTextTracks&&this.el().appendChild(i),i}removeRemoteTextTrack(e){if(super.removeRemoteTextTrack(e),this.featuresNativeTextTracks){const t=this.$$("track");let i=t.length;for(;i--;)(e===t[i]||e===t[i].track)&&this.el().removeChild(t[i])}}getVideoPlaybackQuality(){if(typeof this.el().getVideoPlaybackQuality=="function")return this.el().getVideoPlaybackQuality();const e={};return typeof this.el().webkitDroppedFrameCount!="undefined"&&typeof this.el().webkitDecodedFrameCount!="undefined"&&(e.droppedVideoFrames=this.el().webkitDroppedFrameCount,e.totalVideoFrames=this.el().webkitDecodedFrameCount),q().performance&&(e.creationTime=q().performance.now()),e}}ia(ct,"TEST_VID",function(){if(!os())return;const n=Ee().createElement("video"),e=Ee().createElement("track");return e.kind="captions",e.srclang="en",e.label="English",n.appendChild(e),n}),ct.isSupported=function(){try{ct.TEST_VID.volume=.5}catch(n){return!1}return!!(ct.TEST_VID&&ct.TEST_VID.canPlayType)},ct.canPlayType=function(n){return ct.TEST_VID.canPlayType(n)},ct.canPlaySource=function(n,e){return ct.canPlayType(n.type)},ct.canControlVolume=function(){try{const n=ct.TEST_VID.volume;ct.TEST_VID.volume=n/2+.1;const e=n!==ct.TEST_VID.volume;return e&&Wi?(q().setTimeout(()=>{ct&&ct.prototype&&(ct.prototype.featuresVolumeControl=n!==ct.TEST_VID.volume)}),!1):e}catch(n){return!1}},ct.canMuteVolume=function(){try{const n=ct.TEST_VID.muted;return ct.TEST_VID.muted=!n,ct.TEST_VID.muted?Ln(ct.TEST_VID,"muted","muted"):la(ct.TEST_VID,"muted","muted"),n!==ct.TEST_VID.muted}catch(n){return!1}},ct.canControlPlaybackRate=function(){if(Un&&jn&&na<58)return!1;try{const n=ct.TEST_VID.playbackRate;return ct.TEST_VID.playbackRate=n/2+.1,n!==ct.TEST_VID.playbackRate}catch(n){return!1}},ct.canOverrideAttributes=function(){try{const n=()=>{};Object.defineProperty(Ee().createElement("video"),"src",{get:n,set:n}),Object.defineProperty(Ee().createElement("audio"),"src",{get:n,set:n}),Object.defineProperty(Ee().createElement("video"),"innerHTML",{get:n,set:n}),Object.defineProperty(Ee().createElement("audio"),"innerHTML",{get:n,set:n})}catch(n){return!1}return!0},ct.supportsNativeTextTracks=function(){return oa||Wi&&jn},ct.supportsNativeVideoTracks=function(){return!!(ct.TEST_VID&&ct.TEST_VID.videoTracks)},ct.supportsNativeAudioTracks=function(){return!!(ct.TEST_VID&&ct.TEST_VID.audioTracks)},ct.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],[["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach(function([n,e]){ia(ct.prototype,n,()=>ct[e](),!0)}),ct.prototype.featuresVolumeControl=ct.canControlVolume(),ct.prototype.movingMediaElementInDOM=!Wi,ct.prototype.featuresFullscreenResize=!0,ct.prototype.featuresProgressEvents=!0,ct.prototype.featuresTimeupdateEvents=!0,ct.prototype.featuresVideoFrameCallback=!!(ct.TEST_VID&&ct.TEST_VID.requestVideoFrameCallback),ct.disposeMediaElement=function(n){if(!!n){for(n.parentNode&&n.parentNode.removeChild(n);n.hasChildNodes();)n.removeChild(n.firstChild);n.removeAttribute("src"),typeof n.load=="function"&&function(){try{n.load()}catch(e){}}()}},ct.resetMediaElement=function(n){if(!n)return;const e=n.querySelectorAll("source");let t=e.length;for(;t--;)n.removeChild(e[t]);n.removeAttribute("src"),typeof n.load=="function"&&function(){try{n.load()}catch(i){}}()},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(n){ct.prototype[n]=function(){return this.el_[n]||this.el_.hasAttribute(n)}}),["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(n){ct.prototype["set"+Si(n)]=function(e){this.el_[n]=e,e?this.el_.setAttribute(n,n):this.el_.removeAttribute(n)}}),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach(function(n){ct.prototype[n]=function(){return this.el_[n]}}),["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach(function(n){ct.prototype["set"+Si(n)]=function(e){this.el_[n]=e}}),["pause","load","play"].forEach(function(n){ct.prototype[n]=function(){return this.el_[n]()}}),Ot.withSourceHandlers(ct),ct.nativeSourceHandler={},ct.nativeSourceHandler.canPlayType=function(n){try{return ct.TEST_VID.canPlayType(n)}catch(e){return""}},ct.nativeSourceHandler.canHandleSource=function(n,e){if(n.type)return ct.nativeSourceHandler.canPlayType(n.type);if(n.src){const t=gd(n.src);return ct.nativeSourceHandler.canPlayType(`video/${t}`)}return""},ct.nativeSourceHandler.handleSource=function(n,e,t){e.setSrc(n.src)},ct.nativeSourceHandler.dispose=function(){},ct.registerSourceHandler(ct.nativeSourceHandler),Ot.registerTech("Html5",ct);const Hf=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],Gd={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},Vd=["tiny","xsmall","small","medium","large","xlarge","huge"],hl={};Vd.forEach(n=>{const e=n.charAt(0)==="x"?`x-${n.substring(1)}`:n;hl[n]=`vjs-layout-${e}`});const nv={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:Infinity};class di extends $e{constructor(e,t,i){if(e.id=e.id||t.id||`vjs_video_${Ki()}`,t=Object.assign(di.getTagSettings(e),t),t.initChildren=!1,t.createEl=!1,t.evented=!1,t.reportTouchActivity=!1,!t.language){const a=e.closest("[lang]");a&&(t.language=a.getAttribute("lang"))}super(null,t,i);if(this.boundDocumentFullscreenChange_=a=>this.documentFullscreenChange_(a),this.boundFullWindowOnEscKey_=a=>this.fullWindowOnEscKey(a),this.boundUpdateStyleEl_=a=>this.updateStyleEl_(a),this.boundApplyInitTime_=a=>this.applyInitTime_(a),this.boundUpdateCurrentBreakpoint_=a=>this.updateCurrentBreakpoint_(a),this.boundHandleTechClick_=a=>this.handleTechClick_(a),this.boundHandleTechDoubleClick_=a=>this.handleTechDoubleClick_(a),this.boundHandleTechTouchStart_=a=>this.handleTechTouchStart_(a),this.boundHandleTechTouchMove_=a=>this.handleTechTouchMove_(a),this.boundHandleTechTouchEnd_=a=>this.handleTechTouchEnd_(a),this.boundHandleTechTap_=a=>this.handleTechTap_(a),this.isFullscreen_=!1,this.log=es(this.id_),this.fsApi_=hr,this.isPosterFromTech_=!1,this.queuedCallbacks_=[],this.isReady_=!1,this.hasStarted_=!1,this.userActive_=!1,this.debugEnabled_=!1,this.audioOnlyMode_=!1,this.audioPosterMode_=!1,this.audioOnlyCache_={playerHeight:null,hiddenChildren:[]},!this.options_||!this.options_.techOrder||!this.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(this.tag=e,this.tagAttributes=e&&Zn(e),this.language(this.options_.language),t.languages){const a={};Object.getOwnPropertyNames(t.languages).forEach(function(o){a[o.toLowerCase()]=t.languages[o]}),this.languages_=a}else this.languages_=di.prototype.options_.languages;this.resetCache_(),this.poster_=t.poster||"",this.controls_=!!t.controls,e.controls=!1,e.removeAttribute("controls"),this.changingSrc_=!1,this.playCallbacks_=[],this.playTerminatedQueue_=[],e.hasAttribute("autoplay")?this.autoplay(!0):this.autoplay(this.options_.autoplay),t.plugins&&Object.keys(t.plugins).forEach(a=>{if(typeof this[a]!="function")throw new Error(`plugin "${a}" does not exist`)}),this.scrubbing_=!1,this.el_=this.createEl(),od(this,{eventBusKey:"el_"}),this.fsApi_.requestFullscreen&&(Dn(Ee(),this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.on(this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_)),this.fluid_&&this.on(["playerreset","resize"],this.boundUpdateStyleEl_);const r=Xt(this.options_);t.plugins&&Object.keys(t.plugins).forEach(a=>{this[a](t.plugins[a])}),t.debug&&this.debug(!0),this.options_.playerOptions=r,this.middleware_=[],this.playbackRates(t.playbackRates),this.initChildren(),this.isAudio(e.nodeName.toLowerCase()==="audio"),this.controls()?this.addClass("vjs-controls-enabled"):this.addClass("vjs-controls-disabled"),this.el_.setAttribute("role","region"),this.isAudio()?this.el_.setAttribute("aria-label",this.localize("Audio Player")):this.el_.setAttribute("aria-label",this.localize("Video Player")),this.isAudio()&&this.addClass("vjs-audio"),Ss&&this.addClass("vjs-touch-enabled"),Wi||this.addClass("vjs-workinghover"),di.players[this.id_]=this;const s=Vo.split(".")[0];this.addClass(`vjs-v${s}`),this.userActive(!0),this.reportUserActivity(),this.one("play",a=>this.listenForUserActivity_(a)),this.on("keydown",a=>this.handleKeyDown(a)),this.on("languagechange",a=>this.handleLanguagechange(a)),this.breakpoints(this.options_.breakpoints),this.responsive(this.options_.responsive),this.on("ready",()=>{this.audioPosterMode(this.options_.audioPosterMode),this.audioOnlyMode(this.options_.audioOnlyMode)})}dispose(){this.trigger("dispose"),this.off("dispose"),Xi(Ee(),this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),Xi(Ee(),"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),di.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),Ty(this),an.names.forEach(e=>{const t=an[e],i=this[t.getterName]();i&&i.off&&i.off()}),super.dispose({restoreEl:this.options_.restoreEl})}createEl(){let e=this.tag,t,i=this.playerElIngest_=e.parentNode&&e.parentNode.hasAttribute&&e.parentNode.hasAttribute("data-vjs-player");const r=this.tag.tagName.toLowerCase()==="video-js";i?t=this.el_=e.parentNode:r||(t=this.el_=super.createEl("div"));const s=Zn(e);if(r){for(t=this.el_=e,e=this.tag=Ee().createElement("video");t.children.length;)e.appendChild(t.firstChild);Cs(t,"video-js")||wn(t,"video-js"),t.appendChild(e),i=this.playerElIngest_=t,Object.keys(t).forEach(o=>{try{e[o]=t[o]}catch(l){}})}if(e.setAttribute("tabindex","-1"),s.tabindex="-1",jn&&pr&&(e.setAttribute("role","application"),s.role="application"),e.removeAttribute("width"),e.removeAttribute("height"),"width"in s&&delete s.width,"height"in s&&delete s.height,Object.getOwnPropertyNames(s).forEach(function(o){r&&o==="class"||t.setAttribute(o,s[o]),r&&e.setAttribute(o,s[o])}),e.playerId=e.id,e.id+="_html5_api",e.className="vjs-tech",e.player=t.player=this,this.addClass("vjs-paused"),q().VIDEOJS_NO_DYNAMIC_STYLE!==!0){this.styleEl_=Ti("vjs-styles-dimensions");const o=Le(".vjs-styles-defaults"),l=Le("head");l.insertBefore(this.styleEl_,o?o.nextSibling:l.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);const a=e.getElementsByTagName("a");for(let o=0;o<a.length;o++){const l=a.item(o);wn(l,"vjs-hidden"),l.setAttribute("hidden","hidden")}return e.initNetworkState_=e.networkState,e.parentNode&&!i&&e.parentNode.insertBefore(t,e),za(e,t),this.children_.unshift(e),this.el_.setAttribute("lang",this.language_),this.el_.setAttribute("translate","no"),this.el_=t,t}crossOrigin(e){if(typeof e=="undefined")return this.techGet_("crossOrigin");if(e!==null&&e!=="anonymous"&&e!=="use-credentials"){Ut.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${e}"`);return}this.techCall_("setCrossOrigin",e),this.posterImage&&this.posterImage.crossOrigin(e)}width(e){return this.dimension("width",e)}height(e){return this.dimension("height",e)}dimension(e,t){const i=e+"_";if(t===void 0)return this[i]||0;if(t===""||t==="auto"){this[i]=void 0,this.updateStyleEl_();return}const r=parseFloat(t);if(isNaN(r)){Ut.error(`Improper value "${t}" supplied for for ${e}`);return}this[i]=r,this.updateStyleEl_()}fluid(e){if(e===void 0)return!!this.fluid_;this.fluid_=!!e,Or(this)&&this.off(["playerreset","resize"],this.boundUpdateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),iy(this,()=>{this.on(["playerreset","resize"],this.boundUpdateStyleEl_)})):this.removeClass("vjs-fluid"),this.updateStyleEl_()}fill(e){if(e===void 0)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")}aspectRatio(e){if(e===void 0)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()}updateStyleEl_(){if(q().VIDEOJS_NO_DYNAMIC_STYLE===!0){const o=typeof this.width_=="number"?this.width_:this.options_.width,l=typeof this.height_=="number"?this.height_:this.options_.height,u=this.tech_&&this.tech_.el();u&&(o>=0&&(u.width=o),l>=0&&(u.height=l));return}let e,t,i,r;this.aspectRatio_!==void 0&&this.aspectRatio_!=="auto"?i=this.aspectRatio_:this.videoWidth()>0?i=this.videoWidth()+":"+this.videoHeight():i="16:9";const s=i.split(":"),a=s[1]/s[0];this.width_!==void 0?e=this.width_:this.height_!==void 0?e=this.height_/a:e=this.videoWidth()||300,this.height_!==void 0?t=this.height_:t=e*a,/^[^a-zA-Z]/.test(this.id())?r="dimensions-"+this.id():r=this.id()+"-dimensions",this.addClass(r),yi(this.styleEl_,`
      .${r} {
        width: ${e}px;
        height: ${t}px;
      }

      .${r}.vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: ${a*100}%;
      }
    `)}loadTech_(e,t){this.tech_&&this.unloadTech_();const i=Si(e),r=e.charAt(0).toLowerCase()+e.slice(1);i!=="Html5"&&this.tag&&(Ot.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=i,this.isReady_=!1;let s=this.autoplay();(typeof this.autoplay()=="string"||this.autoplay()===!0&&this.options_.normalizeAutoplay)&&(s=!1);const a={source:t,autoplay:s,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:`${this.id()}_${r}_api`,playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};an.names.forEach(l=>{const u=an[l];a[u.getterName]=this[u.privateName]}),Object.assign(a,this.options_[i]),Object.assign(a,this.options_[r]),Object.assign(a,this.options_[e.toLowerCase()]),this.tag&&(a.tag=this.tag),t&&t.src===this.cache_.src&&this.cache_.currentTime>0&&(a.startTime=this.cache_.currentTime);const o=Ot.getTech(e);if(!o)throw new Error(`No Tech named '${i}' exists! '${i}' should be registered using videojs.registerTech()'`);this.tech_=new o(a),this.tech_.ready(ui(this,this.handleTechReady_),!0),Xh.jsonToTextTracks(this.textTracksJson_||[],this.tech_),Hf.forEach(l=>{this.on(this.tech_,l,u=>this[`handleTech${Si(l)}_`](u))}),Object.keys(Gd).forEach(l=>{this.on(this.tech_,l,u=>{if(this.tech_.playbackRate()===0&&this.tech_.seeking()){this.queuedCallbacks_.push({callback:this[`handleTech${Gd[l]}_`].bind(this),event:u});return}this[`handleTech${Gd[l]}_`](u)})}),this.on(this.tech_,"loadstart",l=>this.handleTechLoadStart_(l)),this.on(this.tech_,"sourceset",l=>this.handleTechSourceset_(l)),this.on(this.tech_,"waiting",l=>this.handleTechWaiting_(l)),this.on(this.tech_,"ended",l=>this.handleTechEnded_(l)),this.on(this.tech_,"seeking",l=>this.handleTechSeeking_(l)),this.on(this.tech_,"play",l=>this.handleTechPlay_(l)),this.on(this.tech_,"pause",l=>this.handleTechPause_(l)),this.on(this.tech_,"durationchange",l=>this.handleTechDurationChange_(l)),this.on(this.tech_,"fullscreenchange",(l,u)=>this.handleTechFullscreenChange_(l,u)),this.on(this.tech_,"fullscreenerror",(l,u)=>this.handleTechFullscreenError_(l,u)),this.on(this.tech_,"enterpictureinpicture",l=>this.handleTechEnterPictureInPicture_(l)),this.on(this.tech_,"leavepictureinpicture",l=>this.handleTechLeavePictureInPicture_(l)),this.on(this.tech_,"error",l=>this.handleTechError_(l)),this.on(this.tech_,"posterchange",l=>this.handleTechPosterChange_(l)),this.on(this.tech_,"textdata",l=>this.handleTechTextData_(l)),this.on(this.tech_,"ratechange",l=>this.handleTechRateChange_(l)),this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode!==this.el()&&(i!=="Html5"||!this.tag)&&za(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)}unloadTech_(){an.names.forEach(e=>{const t=an[e];this[t.privateName]=this[t.getterName]()}),this.textTracksJson_=Xh.textTracksToJson(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1}tech(e){return e===void 0&&Ut.warn(`Using the tech directly can be dangerous. I hope you know what you're doing.
See https://github.com/videojs/video.js/issues/2617 for more info.
`),this.tech_}addTechControlsListeners_(){this.removeTechControlsListeners_(),this.on(this.tech_,"click",this.boundHandleTechClick_),this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_),this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.on(this.tech_,"tap",this.boundHandleTechTap_)}removeTechControlsListeners_(){this.off(this.tech_,"tap",this.boundHandleTechTap_),this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.off(this.tech_,"click",this.boundHandleTechClick_),this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)}handleTechReady_(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()}handleTechLoadStart_(){this.removeClass("vjs-ended","vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):this.trigger("loadstart"),this.manualAutoplay_(this.autoplay()===!0&&this.options_.normalizeAutoplay?"play":this.autoplay())}manualAutoplay_(e){if(!this.tech_||typeof e!="string")return;const t=()=>{const r=this.muted();this.muted(!0);const s=()=>{this.muted(r)};this.playTerminatedQueue_.push(s);const a=this.play();if(!!Ja(a))return a.catch(o=>{throw s(),new Error(`Rejection at manualAutoplay. Restoring muted value. ${o||""}`)})};let i;if(e==="any"&&!this.muted()?(i=this.play(),Ja(i)&&(i=i.catch(t))):e==="muted"&&!this.muted()?i=t():i=this.play(),!!Ja(i))return i.then(()=>{this.trigger({type:"autoplay-success",autoplay:e})}).catch(()=>{this.trigger({type:"autoplay-failure",autoplay:e})})}updateSourceCaches_(e=""){let t=e,i="";typeof t!="string"&&(t=e.src,i=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],t&&!i&&(i=wy(this,t)),this.cache_.source=Xt({},e,{src:t,type:i});const r=this.cache_.sources.filter(l=>l.src&&l.src===t),s=[],a=this.$$("source"),o=[];for(let l=0;l<a.length;l++){const u=Zn(a[l]);s.push(u),u.src&&u.src===t&&o.push(u.src)}o.length&&!r.length?this.cache_.sources=s:r.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=t}handleTechSourceset_(e){if(!this.changingSrc_){let t=s=>this.updateSourceCaches_(s);const i=this.currentSource().src,r=e.src;i&&!/^blob:/.test(i)&&/^blob:/.test(r)&&(!this.lastSource_||this.lastSource_.tech!==r&&this.lastSource_.player!==i)&&(t=()=>{}),t(r),e.src||this.tech_.any(["sourceset","loadstart"],s=>{if(s.type==="sourceset")return;const a=this.techGet("currentSrc");this.lastSource_.tech=a,this.updateSourceCaches_(a)})}this.lastSource_={player:this.currentSource().src,tech:e.src},this.trigger({src:e.src,type:"sourceset"})}hasStarted(e){if(e===void 0)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?this.addClass("vjs-has-started"):this.removeClass("vjs-has-started"))}handleTechPlay_(){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")}handleTechRateChange_(){this.tech_.playbackRate()>0&&this.cache_.lastPlaybackRate===0&&(this.queuedCallbacks_.forEach(e=>e.callback(e.event)),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")}handleTechWaiting_(){this.addClass("vjs-waiting"),this.trigger("waiting");const e=this.currentTime(),t=()=>{e!==this.currentTime()&&(this.removeClass("vjs-waiting"),this.off("timeupdate",t))};this.on("timeupdate",t)}handleTechCanPlay_(){this.removeClass("vjs-waiting"),this.trigger("canplay")}handleTechCanPlayThrough_(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")}handleTechPlaying_(){this.removeClass("vjs-waiting"),this.trigger("playing")}handleTechSeeking_(){this.addClass("vjs-seeking"),this.trigger("seeking")}handleTechSeeked_(){this.removeClass("vjs-seeking","vjs-ended"),this.trigger("seeked")}handleTechPause_(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")}handleTechEnded_(){this.addClass("vjs-ended"),this.removeClass("vjs-waiting"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")}handleTechDurationChange_(){this.duration(this.techGet_("duration"))}handleTechClick_(e){!this.controls_||(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.click===void 0||this.options_.userActions.click!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.click=="function"?this.options_.userActions.click.call(this,e):this.paused()?vr(this.play()):this.pause())}handleTechDoubleClick_(e){if(!this.controls_)return;Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),i=>i.contains(e.target))||(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.doubleClick===void 0||this.options_.userActions.doubleClick!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.doubleClick=="function"?this.options_.userActions.doubleClick.call(this,e):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen())}handleTechTap_(){this.userActive(!this.userActive())}handleTechTouchStart_(){this.userWasActive=this.userActive()}handleTechTouchMove_(){this.userWasActive&&this.reportUserActivity()}handleTechTouchEnd_(e){e.cancelable&&e.preventDefault()}toggleFullscreenClass_(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")}documentFullscreenChange_(e){const t=e.target.player;if(t&&t!==this)return;const i=this.el();let r=Ee()[this.fsApi_.fullscreenElement]===i;!r&&i.matches?r=i.matches(":"+this.fsApi_.fullscreen):!r&&i.msMatchesSelector&&(r=i.msMatchesSelector(":"+this.fsApi_.fullscreen)),this.isFullscreen(r)}handleTechFullscreenChange_(e,t){t&&(t.nativeIOSFullscreen&&(this.addClass("vjs-ios-native-fs"),this.tech_.one("webkitendfullscreen",()=>{this.removeClass("vjs-ios-native-fs")})),this.isFullscreen(t.isFullscreen))}handleTechFullscreenError_(e,t){this.trigger("fullscreenerror",t)}togglePictureInPictureClass_(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")}handleTechEnterPictureInPicture_(e){this.isInPictureInPicture(!0)}handleTechLeavePictureInPicture_(e){this.isInPictureInPicture(!1)}handleTechError_(){const e=this.tech_.error();this.error(e)}handleTechTextData_(){let e=null;arguments.length>1&&(e=arguments[1]),this.trigger("textdata",e)}getCache(){return this.cache_}resetCache_(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}}techCall_(e,t){this.ready(function(){if(e in xy)return by(this.middleware_,this.tech_,e,t);if(e in af)return sf(this.middleware_,this.tech_,e,t);try{this.tech_&&this.tech_[e](t)}catch(i){throw Ut(i),i}},!0)}techGet_(e){if(!(!this.tech_||!this.tech_.isReady_)){if(e in _y)return Ay(this.middleware_,this.tech_,e);if(e in af)return sf(this.middleware_,this.tech_,e);try{return this.tech_[e]()}catch(t){throw this.tech_[e]===void 0?(Ut(`Video.js: ${e} method not defined for ${this.techName_} playback technology.`,t),t):t.name==="TypeError"?(Ut(`Video.js: ${e} unavailable on ${this.techName_} playback technology element.`,t),this.tech_.isReady_=!1,t):(Ut(t),t)}}}play(){return new Promise(e=>{this.play_(e)})}play_(e=vr){this.playCallbacks_.push(e);const t=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc())),i=Boolean(oa||Wi);if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!t){this.waitToPlay_=a=>{this.play_()},this.one(["ready","loadstart"],this.waitToPlay_),!t&&i&&this.load();return}const r=this.techGet_("play");i&&this.hasClass("vjs-ended")&&this.resetProgressBar_(),r===null?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(r)}runPlayTerminatedQueue_(){const e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],e.forEach(function(t){t()})}runPlayCallbacks_(e){const t=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],t.forEach(function(i){i(e)})}pause(){this.techCall_("pause")}paused(){return this.techGet_("paused")!==!1}played(){return this.techGet_("played")||yr(0,0)}scrubbing(e){if(typeof e=="undefined")return this.scrubbing_;this.scrubbing_=!!e,this.techCall_("setScrubbing",this.scrubbing_),e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")}currentTime(e){if(typeof e!="undefined"){if(e<0&&(e=0),!this.isReady_||this.changingSrc_||!this.tech_||!this.tech_.isReady_){this.cache_.initTime=e,this.off("canplay",this.boundApplyInitTime_),this.one("canplay",this.boundApplyInitTime_);return}this.techCall_("setCurrentTime",e),this.cache_.initTime=0;return}return this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime}applyInitTime_(){this.currentTime(this.cache_.initTime)}duration(e){if(e===void 0)return this.cache_.duration!==void 0?this.cache_.duration:NaN;e=parseFloat(e),e<0&&(e=Infinity),e!==this.cache_.duration&&(this.cache_.duration=e,e===Infinity?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(e)||this.trigger("durationchange"))}remainingTime(){return this.duration()-this.currentTime()}remainingTimeDisplay(){return Math.floor(this.duration())-Math.floor(this.currentTime())}buffered(){let e=this.techGet_("buffered");return(!e||!e.length)&&(e=yr(0,0)),e}bufferedPercent(){return Yh(this.buffered(),this.duration())}bufferedEnd(){const e=this.buffered(),t=this.duration();let i=e.end(e.length-1);return i>t&&(i=t),i}volume(e){let t;if(e!==void 0){t=Math.max(0,Math.min(1,parseFloat(e))),this.cache_.volume=t,this.techCall_("setVolume",t),t>0&&this.lastVolume_(t);return}return t=parseFloat(this.techGet_("volume")),isNaN(t)?1:t}muted(e){if(e!==void 0){this.techCall_("setMuted",e);return}return this.techGet_("muted")||!1}defaultMuted(e){return e!==void 0?this.techCall_("setDefaultMuted",e):this.techGet_("defaultMuted")||!1}lastVolume_(e){if(e!==void 0&&e!==0){this.cache_.lastVolume=e;return}return this.cache_.lastVolume}supportsFullScreen(){return this.techGet_("supportsFullScreen")||!1}isFullscreen(e){if(e!==void 0){const t=this.isFullscreen_;this.isFullscreen_=Boolean(e),this.isFullscreen_!==t&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),this.toggleFullscreenClass_();return}return this.isFullscreen_}requestFullscreen(e){this.isInPictureInPicture()&&this.exitPictureInPicture();const t=this;return new Promise((i,r)=>{function s(){t.off("fullscreenerror",o),t.off("fullscreenchange",a)}function a(){s(),i()}function o(u,d){s(),r(d)}t.one("fullscreenchange",a),t.one("fullscreenerror",o);const l=t.requestFullscreenHelper_(e);l&&(l.then(s,s),l.then(i,r))})}requestFullscreenHelper_(e){let t;if(this.fsApi_.prefixed||(t=this.options_.fullscreen&&this.options_.fullscreen.options||{},e!==void 0&&(t=e)),this.fsApi_.requestFullscreen){const i=this.el_[this.fsApi_.requestFullscreen](t);return i&&i.then(()=>this.isFullscreen(!0),()=>this.isFullscreen(!1)),i}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("enterFullScreen"):this.enterFullWindow()}exitFullscreen(){const e=this;return new Promise((t,i)=>{function r(){e.off("fullscreenerror",a),e.off("fullscreenchange",s)}function s(){r(),t()}function a(l,u){r(),i(u)}e.one("fullscreenchange",s),e.one("fullscreenerror",a);const o=e.exitFullscreenHelper_();o&&(o.then(r,r),o.then(t,i))})}exitFullscreenHelper_(){if(this.fsApi_.requestFullscreen){const e=Ee()[this.fsApi_.exitFullscreen]();return e&&vr(e.then(()=>this.isFullscreen(!1))),e}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("exitFullScreen"):this.exitFullWindow()}enterFullWindow(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=Ee().documentElement.style.overflow,Dn(Ee(),"keydown",this.boundFullWindowOnEscKey_),Ee().documentElement.style.overflow="hidden",wn(Ee().body,"vjs-full-window"),this.trigger("enterFullWindow")}fullWindowOnEscKey(e){ce().isEventKey(e,"Esc")&&this.isFullscreen()===!0&&(this.isFullWindow?this.exitFullWindow():this.exitFullscreen())}exitFullWindow(){this.isFullscreen(!1),this.isFullWindow=!1,Xi(Ee(),"keydown",this.boundFullWindowOnEscKey_),Ee().documentElement.style.overflow=this.docOrigOverflow,ws(Ee().body,"vjs-full-window"),this.trigger("exitFullWindow")}disablePictureInPicture(e){if(e===void 0)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",e),this.options_.disablePictureInPicture=e,this.trigger("disablepictureinpicturechanged")}isInPictureInPicture(e){if(e!==void 0){this.isInPictureInPicture_=!!e,this.togglePictureInPictureClass_();return}return!!this.isInPictureInPicture_}requestPictureInPicture(){if(this.options_.enableDocumentPictureInPicture&&q().documentPictureInPicture){const e=Ee().createElement(this.el().tagName);return e.classList=this.el().classList,e.classList.add("vjs-pip-container"),this.posterImage&&e.appendChild(this.posterImage.el().cloneNode(!0)),this.titleBar&&e.appendChild(this.titleBar.el().cloneNode(!0)),e.appendChild(Bt("p",{className:"vjs-pip-text"},{},this.localize("Playing in picture-in-picture"))),q().documentPictureInPicture.requestWindow({initialAspectRatio:this.videoWidth()/this.videoHeight(),copyStyleSheets:!0}).then(t=>(this.el_.parentNode.insertBefore(e,this.el_),t.document.body.append(this.el_),t.document.body.classList.add("vjs-pip-window"),this.player_.isInPictureInPicture(!0),this.player_.trigger("enterpictureinpicture"),t.addEventListener("unload",i=>{const r=i.target.querySelector(".video-js");e.replaceWith(r),this.player_.isInPictureInPicture(!1),this.player_.trigger("leavepictureinpicture")}),t))}return"pictureInPictureEnabled"in Ee()&&this.disablePictureInPicture()===!1?this.techGet_("requestPictureInPicture"):Promise.reject("No PiP mode is available")}exitPictureInPicture(){if(q().documentPictureInPicture&&q().documentPictureInPicture.window)return q().documentPictureInPicture.window.close(),Promise.resolve();if("pictureInPictureEnabled"in Ee())return Ee().exitPictureInPicture()}handleKeyDown(e){const{userActions:t}=this.options_;!t||!t.hotkeys||(r=>{const s=r.tagName.toLowerCase();if(r.isContentEditable)return!0;const a=["button","checkbox","hidden","radio","reset","submit"];return s==="input"?a.indexOf(r.type)===-1:["textarea"].indexOf(s)!==-1})(this.el_.ownerDocument.activeElement)||(typeof t.hotkeys=="function"?t.hotkeys.call(this,e):this.handleHotkeys(e))}handleHotkeys(e){const t=this.options_.userActions?this.options_.userActions.hotkeys:{},{fullscreenKey:i=a=>ce().isEventKey(a,"f"),muteKey:r=a=>ce().isEventKey(a,"m"),playPauseKey:s=a=>ce().isEventKey(a,"k")||ce().isEventKey(a,"Space")}=t;if(i.call(this,e)){e.preventDefault(),e.stopPropagation();const a=$e.getComponent("FullscreenToggle");Ee()[this.fsApi_.fullscreenEnabled]!==!1&&a.prototype.handleClick.call(this,e)}else r.call(this,e)?(e.preventDefault(),e.stopPropagation(),$e.getComponent("MuteToggle").prototype.handleClick.call(this,e)):s.call(this,e)&&(e.preventDefault(),e.stopPropagation(),$e.getComponent("PlayToggle").prototype.handleClick.call(this,e))}canPlayType(e){let t;for(let i=0,r=this.options_.techOrder;i<r.length;i++){const s=r[i];let a=Ot.getTech(s);if(a||(a=$e.getComponent(s)),!a){Ut.error(`The "${s}" tech is undefined. Skipped browser support check for that tech.`);continue}if(a.isSupported()&&(t=a.canPlayType(e),t))return t}return""}selectSource(e){const t=this.options_.techOrder.map(o=>[o,Ot.getTech(o)]).filter(([o,l])=>l?l.isSupported():(Ut.error(`The "${o}" tech is undefined. Skipped browser support check for that tech.`),!1)),i=function(o,l,u){let d;return o.some(h=>l.some(v=>{if(d=u(h,v),d)return!0})),d};let r;const s=o=>(l,u)=>o(u,l),a=([o,l],u)=>{if(l.canPlaySource(u,this.options_[o.toLowerCase()]))return{source:u,tech:o}};return this.options_.sourceOrder?r=i(e,t,s(a)):r=i(t,e,a),r||!1}handleSrc_(e,t){if(typeof e=="undefined")return this.cache_.src||"";this.resetRetryOnError_&&this.resetRetryOnError_();const i=of(e);if(!i.length){this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0);return}if(this.changingSrc_=!0,t||(this.cache_.sources=i),this.updateSourceCaches_(i[0]),yy(this,i[0],(r,s)=>{if(this.middleware_=s,t||(this.cache_.sources=i),this.updateSourceCaches_(r),this.src_(r)){if(i.length>1)return this.handleSrc_(i.slice(1));this.changingSrc_=!1,this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0),this.triggerReady();return}vy(s,this.tech_)}),i.length>1){const r=()=>{this.error(null),this.handleSrc_(i.slice(1),!0)},s=()=>{this.off("error",r)};this.one("error",r),this.one("playing",s),this.resetRetryOnError_=()=>{this.off("error",r),this.off("playing",s)}}}src(e){return this.handleSrc_(e,!1)}src_(e){const t=this.selectSource([e]);return t?Hh(t.tech,this.techName_)?(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1},!0),!1):(this.changingSrc_=!0,this.loadTech_(t.tech,t.source),this.tech_.ready(()=>{this.changingSrc_=!1}),!1):!0}load(){this.techCall_("load")}reset(){if(this.paused())this.doReset_();else{const e=this.play();vr(e.then(()=>this.doReset_()))}}doReset_(){this.tech_&&this.tech_.clearTracks("text"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),Or(this)&&this.trigger("playerreset")}resetControlBarUI_(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()}resetProgressBar_(){this.currentTime(0);const{currentTimeDisplay:e,durationDisplay:t,progressControl:i,remainingTimeDisplay:r}=this.controlBar||{},{seekBar:s}=i||{};e&&e.updateContent(),t&&t.updateContent(),r&&r.updateContent(),s&&(s.update(),s.loadProgressBar&&s.loadProgressBar.update())}resetPlaybackRate_(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()}resetVolumeBar_(){this.volume(1),this.trigger("volumechange")}currentSources(){const e=this.currentSource(),t=[];return Object.keys(e).length!==0&&t.push(e),this.cache_.sources||t}currentSource(){return this.cache_.source||{}}currentSrc(){return this.currentSource()&&this.currentSource().src||""}currentType(){return this.currentSource()&&this.currentSource().type||""}preload(e){if(e!==void 0){this.techCall_("setPreload",e),this.options_.preload=e;return}return this.techGet_("preload")}autoplay(e){if(e===void 0)return this.options_.autoplay||!1;let t;typeof e=="string"&&/(any|play|muted)/.test(e)||e===!0&&this.options_.normalizeAutoplay?(this.options_.autoplay=e,this.manualAutoplay_(typeof e=="string"?e:"play"),t=!1):e?this.options_.autoplay=!0:this.options_.autoplay=!1,t=typeof t=="undefined"?this.options_.autoplay:t,this.tech_&&this.techCall_("setAutoplay",t)}playsinline(e){return e!==void 0?(this.techCall_("setPlaysinline",e),this.options_.playsinline=e,this):this.techGet_("playsinline")}loop(e){if(e!==void 0){this.techCall_("setLoop",e),this.options_.loop=e;return}return this.techGet_("loop")}poster(e){if(e===void 0)return this.poster_;e||(e=""),e!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))}handleTechPosterChange_(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){const e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}}controls(e){if(e===void 0)return!!this.controls_;e=!!e,this.controls_!==e&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))}usingNativeControls(e){if(e===void 0)return!!this.usingNativeControls_;e=!!e,this.usingNativeControls_!==e&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))}error(e){if(e===void 0)return this.error_||null;if(cn("beforeerror").forEach(t=>{const i=t(this,e);if(!(Nn(i)&&!Array.isArray(i)||typeof i=="string"||typeof i=="number"||i===null)){this.log.error("please return a value that MediaError expects in beforeerror hooks");return}e=i}),this.options_.suppressNotSupportedError&&e&&e.code===4){const t=function(){this.error(e)};this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],t),this.one("loadstart",function(){this.off(["click","touchstart"],t)});return}if(e===null){this.error_=e,this.removeClass("vjs-error"),this.errorDisplay&&this.errorDisplay.close();return}this.error_=new sn(e),this.addClass("vjs-error"),Ut.error(`(CODE:${this.error_.code} ${sn.errorTypes[this.error_.code]})`,this.error_.message,this.error_),this.trigger("error"),cn("error").forEach(t=>t(this,this.error_))}reportUserActivity(e){this.userActivity_=!0}userActive(e){if(e===void 0)return this.userActive_;if(e=!!e,e!==this.userActive_){if(this.userActive_=e,this.userActive_){this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive");return}this.tech_&&this.tech_.one("mousemove",function(t){t.stopPropagation(),t.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}}listenForUserActivity_(){let e,t,i;const r=ui(this,this.reportUserActivity),s=function(d){(d.screenX!==t||d.screenY!==i)&&(t=d.screenX,i=d.screenY,r())},a=function(){r(),this.clearInterval(e),e=this.setInterval(r,250)},o=function(d){r(),this.clearInterval(e)};this.on("mousedown",a),this.on("mousemove",s),this.on("mouseup",o),this.on("mouseleave",o);const l=this.getChild("controlBar");l&&!Wi&&!Un&&(l.on("mouseenter",function(d){this.player().options_.inactivityTimeout!==0&&(this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout),this.player().options_.inactivityTimeout=0}),l.on("mouseleave",function(d){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",r),this.on("keyup",r);let u;this.setInterval(function(){if(!this.userActivity_)return;this.userActivity_=!1,this.userActive(!0),this.clearTimeout(u);const d=this.options_.inactivityTimeout;d<=0||(u=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},d))},250)}playbackRate(e){if(e!==void 0){this.techCall_("setPlaybackRate",e);return}return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1}defaultPlaybackRate(e){return e!==void 0?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1}isAudio(e){if(e!==void 0){this.isAudio_=!!e;return}return!!this.isAudio_}enableAudioOnlyUI_(){this.addClass("vjs-audio-only-mode");const e=this.children(),t=this.getChild("ControlBar"),i=t&&t.currentHeight();e.forEach(r=>{r!==t&&r.el_&&!r.hasClass("vjs-hidden")&&(r.hide(),this.audioOnlyCache_.hiddenChildren.push(r))}),this.audioOnlyCache_.playerHeight=this.currentHeight(),this.height(i),this.trigger("audioonlymodechange")}disableAudioOnlyUI_(){this.removeClass("vjs-audio-only-mode"),this.audioOnlyCache_.hiddenChildren.forEach(e=>e.show()),this.height(this.audioOnlyCache_.playerHeight),this.trigger("audioonlymodechange")}audioOnlyMode(e){if(typeof e!="boolean"||e===this.audioOnlyMode_)return this.audioOnlyMode_;if(this.audioOnlyMode_=e,e){const t=[];return this.isInPictureInPicture()&&t.push(this.exitPictureInPicture()),this.isFullscreen()&&t.push(this.exitFullscreen()),this.audioPosterMode()&&t.push(this.audioPosterMode(!1)),Promise.all(t).then(()=>this.enableAudioOnlyUI_())}return Promise.resolve().then(()=>this.disableAudioOnlyUI_())}enablePosterModeUI_(){(this.tech_&&this.tech_).hide(),this.addClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}disablePosterModeUI_(){(this.tech_&&this.tech_).show(),this.removeClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}audioPosterMode(e){return typeof e!="boolean"||e===this.audioPosterMode_?this.audioPosterMode_:(this.audioPosterMode_=e,e?this.audioOnlyMode()?this.audioOnlyMode(!1).then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.disablePosterModeUI_()}))}addTextTrack(e,t,i){if(this.tech_)return this.tech_.addTextTrack(e,t,i)}addRemoteTextTrack(e,t){if(this.tech_)return this.tech_.addRemoteTextTrack(e,t)}removeRemoteTextTrack(e={}){let{track:t}=e;if(t||(t=e),this.tech_)return this.tech_.removeRemoteTextTrack(t)}getVideoPlaybackQuality(){return this.techGet_("getVideoPlaybackQuality")}videoWidth(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0}videoHeight(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0}language(e){if(e===void 0)return this.language_;this.language_!==String(e).toLowerCase()&&(this.language_=String(e).toLowerCase(),Or(this)&&this.trigger("languagechange"))}languages(){return Xt(di.prototype.options_.languages,this.languages_)}toJSON(){const e=Xt(this.options_),t=e.tracks;e.tracks=[];for(let i=0;i<t.length;i++){let r=t[i];r=Xt(r),r.player=void 0,e.tracks[i]=r}return e}createModal(e,t){t=t||{},t.content=e||"";const i=new ca(this,t);return this.addChild(i),i.on("dispose",()=>{this.removeChild(i)}),i.open(),i}updateCurrentBreakpoint_(){if(!this.responsive())return;const e=this.currentBreakpoint(),t=this.currentWidth();for(let i=0;i<Vd.length;i++){const r=Vd[i],s=this.breakpoints_[r];if(t<=s){if(e===r)return;e&&this.removeClass(hl[e]),this.addClass(hl[r]),this.breakpoint_=r;break}}}removeCurrentBreakpoint_(){const e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)}breakpoints(e){return e===void 0?Object.assign(this.breakpoints_):(this.breakpoint_="",this.breakpoints_=Object.assign({},nv,e),this.updateCurrentBreakpoint_(),Object.assign(this.breakpoints_))}responsive(e){if(e===void 0)return this.responsive_;e=Boolean(e);const t=this.responsive_;if(e!==t)return this.responsive_=e,e?(this.on("playerresize",this.boundUpdateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.boundUpdateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e}currentBreakpoint(){return this.breakpoint_}currentBreakpointClass(){return hl[this.breakpoint_]||""}loadMedia(e,t){if(!e||typeof e!="object")return;this.reset(),this.cache_.media=Xt(e);const{artist:i,artwork:r,description:s,poster:a,src:o,textTracks:l,title:u}=this.cache_.media;!r&&a&&(this.cache_.media.artwork=[{src:a,type:ol(a)}]),o&&this.src(o),a&&this.poster(a),Array.isArray(l)&&l.forEach(d=>this.addRemoteTextTrack(d,!1)),this.titleBar&&this.titleBar.update({title:u,description:s||i||""}),this.ready(t)}getMedia(){if(!this.cache_.media){const e=this.poster(),t=this.currentSources(),i=Array.prototype.map.call(this.remoteTextTracks(),s=>({kind:s.kind,label:s.label,language:s.language,src:s.src})),r={src:t,textTracks:i};return e&&(r.poster=e,r.artwork=[{src:r.poster,type:ol(r.poster)}]),r}return Xt(this.cache_.media)}static getTagSettings(e){const t={sources:[],tracks:[]},i=Zn(e),r=i["data-setup"];if(Cs(e,"vjs-fill")&&(i.fill=!0),Cs(e,"vjs-fluid")&&(i.fluid=!0),r!==null){const[s,a]=Z()(r||"{}");s&&Ut.error(s),Object.assign(i,a)}if(Object.assign(t,i),e.hasChildNodes()){const s=e.childNodes;for(let a=0,o=s.length;a<o;a++){const l=s[a],u=l.nodeName.toLowerCase();u==="source"?t.sources.push(Zn(l)):u==="track"&&t.tracks.push(Zn(l))}}return t}debug(e){if(e===void 0)return this.debugEnabled_;e?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)}playbackRates(e){if(e===void 0)return this.cache_.playbackRates;!Array.isArray(e)||!e.every(t=>typeof t=="number")||(this.cache_.playbackRates=e,this.trigger("playbackrateschange"))}}an.names.forEach(function(n){const e=an[n];di.prototype[e.getterName]=function(){return this.tech_?this.tech_[e.getterName]():(this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName])}}),di.prototype.crossorigin=di.prototype.crossOrigin,di.players={};const ro=q().navigator;di.prototype.options_={techOrder:Ot.defaultTechOrder_,html5:{},enableSourceset:!0,inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","titleBar","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:ro&&(ro.languages&&ro.languages[0]||ro.userLanguage||ro.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",normalizeAutoplay:!1,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1,audioOnlyMode:!1,audioPosterMode:!1},["ended","seeking","seekable","networkState","readyState"].forEach(function(n){di.prototype[n]=function(){return this.techGet_(n)}}),Hf.forEach(function(n){di.prototype[`handleTech${Si(n)}_`]=function(){return this.trigger(n)}}),$e.registerComponent("Player",di);const fl="plugin",ga="activePlugins_",ya={},pl=n=>ya.hasOwnProperty(n),ml=n=>pl(n)?ya[n]:void 0,Wf=(n,e)=>{n[ga]=n[ga]||{},n[ga][e]=!0},gl=(n,e,t)=>{const i=(t?"before":"")+"pluginsetup";n.trigger(i,e),n.trigger(i+":"+e.name,e)},rv=function(n,e){const t=function(){gl(this,{name:n,plugin:e,instance:null},!0);const i=e.apply(this,arguments);return Wf(this,n),gl(this,{name:n,plugin:e,instance:i}),i};return Object.keys(e).forEach(function(i){t[i]=e[i]}),t},Kf=(n,e)=>(e.prototype.name=n,function(...t){gl(this,{name:n,plugin:e,instance:null},!0);const i=new e(...[this,...t]);return this[n]=()=>i,gl(this,i.getEventHash()),i});class hn{constructor(e){if(this.constructor===hn)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=e,this.log||(this.log=this.player.log.createLogger(this.name)),od(this),delete this.trigger,Vh(this,this.constructor.defaultState),Wf(e,this.name),this.dispose=this.dispose.bind(this),e.on("dispose",this.dispose)}version(){return this.constructor.VERSION}getEventHash(e={}){return e.name=this.name,e.plugin=this.constructor,e.instance=this,e}trigger(e,t={}){return da(this.eventBusEl_,e,this.getEventHash(t))}handleStateChanged(e){}dispose(){const{name:e,player:t}=this;this.trigger("dispose"),this.off(),t.off("dispose",this.dispose),t[ga][e]=!1,this.player=this.state=null,t[e]=Kf(e,ya[e])}static isBasic(e){const t=typeof e=="string"?ml(e):e;return typeof t=="function"&&!hn.prototype.isPrototypeOf(t.prototype)}static registerPlugin(e,t){if(typeof e!="string")throw new Error(`Illegal plugin name, "${e}", must be a string, was ${typeof e}.`);if(pl(e))Ut.warn(`A plugin named "${e}" already exists. You may want to avoid re-registering plugins!`);else if(di.prototype.hasOwnProperty(e))throw new Error(`Illegal plugin name, "${e}", cannot share a name with an existing player method!`);if(typeof t!="function")throw new Error(`Illegal plugin for "${e}", must be a function, was ${typeof t}.`);return ya[e]=t,e!==fl&&(hn.isBasic(t)?di.prototype[e]=rv(e,t):di.prototype[e]=Kf(e,t)),t}static deregisterPlugin(e){if(e===fl)throw new Error("Cannot de-register base plugin.");pl(e)&&(delete ya[e],delete di.prototype[e])}static getPlugins(e=Object.keys(ya)){let t;return e.forEach(i=>{const r=ml(i);r&&(t=t||{},t[i]=r)}),t}static getPluginVersion(e){const t=ml(e);return t&&t.VERSION||""}}hn.getPlugin=ml,hn.BASE_PLUGIN_NAME=fl,hn.registerPlugin(fl,hn),di.prototype.usingPlugin=function(n){return!!this[ga]&&this[ga][n]===!0},di.prototype.hasPlugin=function(n){return!!pl(n)};function sv(n,e){let t=!1;return function(...i){return t||Ut.warn(n),t=!0,e.apply(this,i)}}function Jn(n,e,t,i){return sv(`${e} is deprecated and will be removed in ${n}.0; please use ${t} instead.`,i)}const qf=n=>n.indexOf("#")===0?n.slice(1):n;function Re(n,e,t){let i=Re.getPlayer(n);if(i)return e&&Ut.warn(`Player "${n}" is already initialised. Options will not be applied.`),t&&i.ready(t),i;const r=typeof n=="string"?Le("#"+qf(n)):n;if(!ls(r))throw new TypeError("The element or ID supplied is not valid. (videojs)");(!r.ownerDocument.defaultView||!r.ownerDocument.body.contains(r))&&Ut.warn("The element supplied is not included in the DOM"),e=e||{},e.restoreEl===!0&&(e.restoreEl=(r.parentNode&&r.parentNode.hasAttribute("data-vjs-player")?r.parentNode:r).cloneNode(!0)),cn("beforesetup").forEach(a=>{const o=a(r,Xt(e));if(!Nn(o)||Array.isArray(o)){Ut.error("please return an object in beforesetup hooks");return}e=Xt(e,o)});const s=$e.getComponent("Player");return i=new s(r,e,t),cn("setup").forEach(a=>a(i)),i}if(Re.hooks_=Xn,Re.hooks=cn,Re.hook=Qu,Re.hookOnce=Zu,Re.removeHook=Ho,q().VIDEOJS_NO_DYNAMIC_STYLE!==!0&&os()){let n=Le(".vjs-styles-defaults");if(!n){n=Ti("vjs-styles-defaults");const e=Le("head");e&&e.insertBefore(n,e.firstChild),yi(n,`
      .video-js {
        width: 300px;
        height: 150px;
      }

      .vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: 56.25%
      }
    `)}}gt(1,Re),Re.VERSION=Vo,Re.options=di.prototype.options_,Re.getPlayers=()=>di.players,Re.getPlayer=n=>{const e=di.players;let t;if(typeof n=="string"){const i=qf(n),r=e[i];if(r)return r;t=Le("#"+i)}else t=n;if(ls(t)){const{player:i,playerId:r}=t;if(i||e[r])return i||e[r]}},Re.getAllPlayers=()=>Object.keys(di.players).map(n=>di.players[n]).filter(Boolean),Re.players=di.players,Re.getComponent=$e.getComponent,Re.registerComponent=(n,e)=>{Ot.isTech(e)&&Ut.warn(`The ${n} tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)`),$e.registerComponent.call($e,n,e)},Re.getTech=Ot.getTech,Re.registerTech=Ot.registerTech,Re.use=gy,Object.defineProperty(Re,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(Re.middleware,"TERMINATOR",{value:al,writeable:!1,enumerable:!0}),Re.browser=id,Re.obj=td,Re.mergeOptions=Jn(9,"videojs.mergeOptions","videojs.obj.merge",Xt),Re.defineLazyProperty=Jn(9,"videojs.defineLazyProperty","videojs.obj.defineLazyProperty",ia),Re.bind=Jn(9,"videojs.bind","native Function.prototype.bind",ui),Re.registerPlugin=hn.registerPlugin,Re.deregisterPlugin=hn.deregisterPlugin,Re.plugin=(n,e)=>(Ut.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),hn.registerPlugin(n,e)),Re.getPlugins=hn.getPlugins,Re.getPlugin=hn.getPlugin,Re.getPluginVersion=hn.getPluginVersion,Re.addLanguage=function(n,e){return n=(""+n).toLowerCase(),Re.options.languages=Xt(Re.options.languages,{[n]:e}),Re.options.languages[n]},Re.log=Ut,Re.createLogger=es,Re.time=oy,Re.createTimeRange=Jn(9,"videojs.createTimeRange","videojs.time.createTimeRanges",yr),Re.createTimeRanges=Jn(9,"videojs.createTimeRanges","videojs.time.createTimeRanges",yr),Re.formatTime=Jn(9,"videojs.formatTime","videojs.time.formatTime",Ds),Re.setFormatTime=Jn(9,"videojs.setFormatTime","videojs.time.setFormatTime",qh),Re.resetFormatTime=Jn(9,"videojs.resetFormatTime","videojs.time.resetFormatTime",zh),Re.parseUrl=Jn(9,"videojs.parseUrl","videojs.url.parseUrl",md),Re.isCrossOrigin=Jn(9,"videojs.isCrossOrigin","videojs.url.isCrossOrigin",sl),Re.EventTarget=Vn,Re.any=rd,Re.on=Dn,Re.one=tl,Re.off=Xi,Re.trigger=da,Re.xhr=V(),Re.TextTrack=eo,Re.AudioTrack=nf,Re.VideoTrack=rf,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(n=>{Re[n]=function(){return Ut.warn(`videojs.${n}() is deprecated; use videojs.dom.${n}() instead`),ot[n].apply(null,arguments)}}),Re.computedStyle=Jn(9,"videojs.computedStyle","videojs.dom.computedStyle",Je),Re.dom=ot,Re.fn=ty,Re.num=By,Re.str=sy,Re.url=py;/*! @name videojs-contrib-quality-levels @version 3.0.0 @license Apache-2.0 */class av{constructor(e){let t=this;return t.id=e.id,t.label=t.id,t.width=e.width,t.height=e.height,t.bitrate=e.bandwidth,t.frameRate=e.frameRate,t.enabled_=e.enabled,Object.defineProperty(t,"enabled",{get(){return t.enabled_()},set(i){t.enabled_(i)}}),t}}class yl extends Re.EventTarget{constructor(){super();let e=this;return e.levels_=[],e.selectedIndex_=-1,Object.defineProperty(e,"selectedIndex",{get(){return e.selectedIndex_}}),Object.defineProperty(e,"length",{get(){return e.levels_.length}}),e}addQualityLevel(e){let t=this.getQualityLevelById(e.id);if(t)return t;const i=this.levels_.length;return t=new av(e),""+i in this||Object.defineProperty(this,i,{get(){return this.levels_[i]}}),this.levels_.push(t),this.trigger({qualityLevel:t,type:"addqualitylevel"}),t}removeQualityLevel(e){let t=null;for(let i=0,r=this.length;i<r;i++)if(this[i]===e){t=this.levels_.splice(i,1)[0],this.selectedIndex_===i?this.selectedIndex_=-1:this.selectedIndex_>i&&this.selectedIndex_--;break}return t&&this.trigger({qualityLevel:e,type:"removequalitylevel"}),t}getQualityLevelById(e){for(let t=0,i=this.length;t<i;t++){const r=this[t];if(r.id===e)return r}return null}dispose(){this.selectedIndex_=-1,this.levels_.length=0}}yl.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"};for(const n in yl.prototype.allowedEvents_)yl.prototype["on"+n]=null;var zf="3.0.0";const ov=Re.registerPlugin||Re.plugin,lv=function(n,e){const t=n.qualityLevels,i=new yl,r=function(){i.dispose(),n.qualityLevels=t,n.off("dispose",r)};return n.on("dispose",r),n.qualityLevels=()=>i,n.qualityLevels.VERSION=zf,i},Yf=function(n){return lv(this,Re.mergeOptions({},n))};ov("qualityLevels",Yf),Yf.VERSION=zf;/*! @name @videojs/http-streaming @version 3.0.2 @license Apache-2.0 */const er=C,vl=(n,e)=>e&&e.responseURL&&n!==e.responseURL?e.responseURL:n,tr=n=>Re.log.debug?Re.log.debug.bind(Re,"VHS:",`${n} >`):function(){};function ci(...n){const e=Re.obj||Re;return(e.merge||e.mergeOptions).apply(e,n)}function Qi(...n){const e=Re.time||Re;return(e.createTimeRanges||e.createTimeRanges).apply(e,n)}const cs=1/30,Ar=cs*3,Xf=function(n,e){const t=[];let i;if(n&&n.length)for(i=0;i<n.length;i++)e(n.start(i),n.end(i))&&t.push([n.start(i),n.end(i)]);return Qi(t)},va=function(n,e){return Xf(n,function(t,i){return t-Ar<=e&&i+Ar>=e})},Al=function(n,e){return Xf(n,function(t){return t-cs>=e})},uv=function(n){if(n.length<2)return Qi();const e=[];for(let t=1;t<n.length;t++){const i=n.end(t-1),r=n.start(t);e.push([i,r])}return Qi(e)},dv=function(n,e){let t=null,i=null,r=0;const s=[],a=[];if(!n||!n.length||!e||!e.length)return Qi();let o=n.length;for(;o--;)s.push({time:n.start(o),type:"start"}),s.push({time:n.end(o),type:"end"});for(o=e.length;o--;)s.push({time:e.start(o),type:"start"}),s.push({time:e.end(o),type:"end"});for(s.sort(function(l,u){return l.time-u.time}),o=0;o<s.length;o++)s[o].type==="start"?(r++,r===2&&(t=s[o].time)):s[o].type==="end"&&(r--,r===1&&(i=s[o].time)),t!==null&&i!==null&&(a.push([t,i]),t=null,i=null);return Qi(a)},Qf=n=>{const e=[];if(!n||!n.length)return"";for(let t=0;t<n.length;t++)e.push(n.start(t)+" => "+n.end(t));return e.join(", ")},cv=function(n,e,t=1){return((n.length?n.end(n.length-1):0)-e)/t},Os=n=>{const e=[];for(let t=0;t<n.length;t++)e.push({start:n.start(t),end:n.end(t)});return e},hv=function(n,e){if(n===e)return!1;if(!n&&e||!e&&n||n.length!==e.length)return!0;for(let t=0;t<n.length;t++)if(n.start(t)!==e.start(t)||n.end(t)!==e.end(t))return!0;return!1},Zf=function(n){if(!(!n||!n.length||!n.end))return n.end(n.length-1)},Hd=function(n,e){let t=0;if(!n||!n.length)return t;for(let i=0;i<n.length;i++){const r=n.start(i),s=n.end(i);if(!(e>s)){if(e>r&&e<=s){t+=s-e;continue}t+=s-r}}return t},Wd=(n,e)=>{if(!e.preload)return e.duration;let t=0;return(e.parts||[]).forEach(function(i){t+=i.duration}),(e.preloadHints||[]).forEach(function(i){i.type==="PART"&&(t+=n.partTargetDuration)}),t},Kd=n=>(n.segments||[]).reduce((e,t,i)=>(t.parts?t.parts.forEach(function(r,s){e.push({duration:r.duration,segmentIndex:i,partIndex:s,part:r,segment:t})}):e.push({duration:t.duration,segmentIndex:i,partIndex:null,segment:t,part:null}),e),[]),Jf=n=>{const e=n.segments&&n.segments.length&&n.segments[n.segments.length-1];return e&&e.parts||[]},ep=({preloadSegment:n})=>{if(!n)return;const{parts:e,preloadHints:t}=n;let i=(t||[]).reduce((r,s)=>r+(s.type==="PART"?1:0),0);return i+=e&&e.length?e.length:0,i},tp=(n,e)=>{if(e.endList)return 0;if(n&&n.suggestedPresentationDelay)return n.suggestedPresentationDelay;const t=Jf(e).length>0;return t&&e.serverControl&&e.serverControl.partHoldBack?e.serverControl.partHoldBack:t&&e.partTargetDuration?e.partTargetDuration*3:e.serverControl&&e.serverControl.holdBack?e.serverControl.holdBack:e.targetDuration?e.targetDuration*3:0},fv=function(n,e){let t=0,i=e-n.mediaSequence,r=n.segments[i];if(r){if(typeof r.start!="undefined")return{result:r.start,precise:!0};if(typeof r.end!="undefined")return{result:r.end-r.duration,precise:!0}}for(;i--;){if(r=n.segments[i],typeof r.end!="undefined")return{result:t+r.end,precise:!0};if(t+=Wd(n,r),typeof r.start!="undefined")return{result:t+r.start,precise:!0}}return{result:t,precise:!1}},pv=function(n,e){let t=0,i,r=e-n.mediaSequence;for(;r<n.segments.length;r++){if(i=n.segments[r],typeof i.start!="undefined")return{result:i.start-t,precise:!0};if(t+=Wd(n,i),typeof i.end!="undefined")return{result:i.end-t,precise:!0}}return{result:-1,precise:!1}},ip=function(n,e,t){if(typeof e=="undefined"&&(e=n.mediaSequence+n.segments.length),e<n.mediaSequence)return 0;const i=fv(n,e);if(i.precise)return i.result;const r=pv(n,e);return r.precise?r.result:i.result+t},np=function(n,e,t){if(!n)return 0;if(typeof t!="number"&&(t=0),typeof e=="undefined"){if(n.totalDuration)return n.totalDuration;if(!n.endList)return q()[Infinity]}return ip(n,e,t)},so=function({defaultDuration:n,durationList:e,startIndex:t,endIndex:i}){let r=0;if(t>i&&([t,i]=[i,t]),t<0){for(let s=t;s<Math.min(0,i);s++)r+=n;t=0}for(let s=t;s<i;s++)r+=e[s].duration;return r},rp=function(n,e,t,i){if(!n||!n.segments)return null;if(n.endList)return np(n);if(e===null)return null;e=e||0;let r=ip(n,n.mediaSequence+n.segments.length,e);return t&&(i=typeof i=="number"?i:tp(null,n),r-=i),Math.max(0,r)},mv=function(n,e,t){const i=!0,r=e||0,s=rp(n,e,i,t);return s===null?Qi():Qi(r,s)},gv=function({playlist:n,currentTime:e,startingSegmentIndex:t,startingPartIndex:i,startTime:r,exactManifestTimings:s}){let a=e-r;const o=Kd(n);let l=0;for(let u=0;u<o.length;u++){const d=o[u];if(t===d.segmentIndex&&!(typeof i=="number"&&typeof d.partIndex=="number"&&i!==d.partIndex)){l=u;break}}if(a<0){if(l>0)for(let u=l-1;u>=0;u--){const d=o[u];if(a+=d.duration,s){if(a<0)continue}else if(a+cs<=0)continue;return{partIndex:d.partIndex,segmentIndex:d.segmentIndex,startTime:r-so({defaultDuration:n.targetDuration,durationList:o,startIndex:l,endIndex:u})}}return{partIndex:o[0]&&o[0].partIndex||null,segmentIndex:o[0]&&o[0].segmentIndex||0,startTime:e}}if(l<0){for(let u=l;u<0;u++)if(a-=n.targetDuration,a<0)return{partIndex:o[0]&&o[0].partIndex||null,segmentIndex:o[0]&&o[0].segmentIndex||0,startTime:e};l=0}for(let u=l;u<o.length;u++){const d=o[u];if(a-=d.duration,s){if(a>0)continue}else if(a-cs>=0)continue;return{partIndex:d.partIndex,segmentIndex:d.segmentIndex,startTime:r+so({defaultDuration:n.targetDuration,durationList:o,startIndex:l,endIndex:u})}}return{segmentIndex:o[o.length-1].segmentIndex,partIndex:o[o.length-1].partIndex,startTime:e}},sp=function(n){return n.excludeUntil&&n.excludeUntil>Date.now()},qd=function(n){return n.excludeUntil&&n.excludeUntil===Infinity},bl=function(n){const e=sp(n);return!n.disabled&&!e},yv=function(n){return n.disabled},vv=function(n){for(let e=0;e<n.segments.length;e++)if(n.segments[e].key)return!0;return!1},ap=function(n,e){return e.attributes&&e.attributes[n]},Av=function(n,e,t,i=0){return ap("BANDWIDTH",t)?(n*t.attributes.BANDWIDTH-i*8)/e:NaN},zd=(n,e)=>{if(n.playlists.length===1)return!0;const t=e.attributes.BANDWIDTH||Number.MAX_VALUE;return n.playlists.filter(i=>bl(i)?(i.attributes.BANDWIDTH||0)<t:!1).length===0},Yd=(n,e)=>!n&&!e||!n&&e||n&&!e?!1:!!(n===e||n.id&&e.id&&n.id===e.id||n.resolvedUri&&e.resolvedUri&&n.resolvedUri===e.resolvedUri||n.uri&&e.uri&&n.uri===e.uri),op=function(n,e){const t=n&&n.mediaGroups&&n.mediaGroups.AUDIO||{};let i=!1;for(const r in t){for(const s in t[r])if(i=e(t[r][s]),i)break;if(i)break}return!!i},ao=n=>{if(!n||!n.playlists||!n.playlists.length)return op(n,t=>t.playlists&&t.playlists.length||t.uri);for(let e=0;e<n.playlists.length;e++){const t=n.playlists[e],i=t.attributes&&t.attributes.CODECS;if(!(i&&i.split(",").every(s=>Ft(s))||op(n,s=>Yd(t,s))))return!1}return!0};var fn={liveEdgeDelay:tp,duration:np,seekable:mv,getMediaInfoForTime:gv,isEnabled:bl,isDisabled:yv,isExcluded:sp,isIncompatible:qd,playlistEnd:rp,isAes:vv,hasAttribute:ap,estimateSegmentRequestTime:Av,isLowestEnabledRendition:zd,isAudioOnly:ao,playlistMatch:Yd,segmentDurationWithParts:Wd};const{log:lp}=Re,Xd=(n,e)=>`${n}-${e}`,bv=(n,e,t)=>`placeholder-uri-${n}-${e}-${t}`,_v=({onwarn:n,oninfo:e,manifestString:t,customTagParsers:i=[],customTagMappers:r=[],llhls:s})=>{const a=new ve;n&&a.on("warn",n),e&&a.on("info",e),i.forEach(u=>a.addParser(u)),r.forEach(u=>a.addTagMapper(u)),a.push(t),a.end();const o=a.manifest;if(s||(["preloadSegment","skip","serverControl","renditionReports","partInf","partTargetDuration"].forEach(function(u){o.hasOwnProperty(u)&&delete o[u]}),o.segments&&o.segments.forEach(function(u){["parts","preloadHints"].forEach(function(d){u.hasOwnProperty(d)&&delete u[d]})})),!o.targetDuration){let u=10;o.segments&&o.segments.length&&(u=o.segments.reduce((d,h)=>Math.max(d,h.duration),0)),n&&n(`manifest has no targetDuration defaulting to ${u}`),o.targetDuration=u}const l=Jf(o);if(l.length&&!o.partTargetDuration){const u=l.reduce((d,h)=>Math.max(d,h.duration),0);n&&(n(`manifest has no partTargetDuration defaulting to ${u}`),lp.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")),o.partTargetDuration=u}return o},Aa=(n,e)=>{!n.mediaGroups||["AUDIO","SUBTITLES"].forEach(t=>{if(!!n.mediaGroups[t])for(const i in n.mediaGroups[t])for(const r in n.mediaGroups[t][i]){const s=n.mediaGroups[t][i][r];e(s,t,i,r)}})},up=({playlist:n,uri:e,id:t})=>{n.id=t,n.playlistErrors_=0,e&&(n.uri=e),n.attributes=n.attributes||{}},xv=n=>{let e=n.playlists.length;for(;e--;){const t=n.playlists[e];up({playlist:t,id:Xd(e,t.uri)}),t.resolvedUri=er(n.uri,t.uri),n.playlists[t.id]=t,n.playlists[t.uri]=t,t.attributes.BANDWIDTH||lp.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}},Ev=n=>{Aa(n,e=>{e.uri&&(e.resolvedUri=er(n.uri,e.uri))})},Tv=(n,e)=>{const t=Xd(0,e),i={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:q().location.href,resolvedUri:q().location.href,playlists:[{uri:e,id:t,resolvedUri:e,attributes:{}}]};return i.playlists[t]=i.playlists[0],i.playlists[e]=i.playlists[0],i},dp=(n,e,t=bv)=>{n.uri=e;for(let r=0;r<n.playlists.length;r++)if(!n.playlists[r].uri){const s=`placeholder-uri-${r}`;n.playlists[r].uri=s}const i=ao(n);Aa(n,(r,s,a,o)=>{if(!r.playlists||!r.playlists.length){if(i&&s==="AUDIO"&&!r.uri)for(let l=0;l<n.playlists.length;l++){const u=n.playlists[l];if(u.attributes&&u.attributes.AUDIO&&u.attributes.AUDIO===a)return}r.playlists=[(0,B.Z)({},r)]}r.playlists.forEach(function(l,u){const d=t(s,a,o,l),h=Xd(u,d);l.uri?l.resolvedUri=l.resolvedUri||er(n.uri,l.uri):(l.uri=u===0?d:h,l.resolvedUri=l.uri),l.id=l.id||h,l.attributes=l.attributes||{},n.playlists[l.id]=l,n.playlists[l.uri]=l})}),xv(n),Ev(n)},{EventTarget:Sv}=Re,Cv=(n,e)=>{if(e.endList||!e.serverControl)return n;const t={};if(e.serverControl.canBlockReload){const{preloadSegment:i}=e;let r=e.mediaSequence+e.segments.length;if(i){const s=i.parts||[],a=ep(e)-1;a>-1&&a!==s.length-1&&(t._HLS_part=a),(a>-1||s.length)&&r--}t._HLS_msn=r}if(e.serverControl&&e.serverControl.canSkipUntil&&(t._HLS_skip=e.serverControl.canSkipDateranges?"v2":"YES"),Object.keys(t).length){const i=new(q()).URL(n);["_HLS_skip","_HLS_msn","_HLS_part"].forEach(function(r){!t.hasOwnProperty(r)||i.searchParams.set(r,t[r])}),n=i.toString()}return n},wv=(n,e)=>{if(!n)return e;const t=ci(n,e);if(n.preloadHints&&!e.preloadHints&&delete t.preloadHints,n.parts&&!e.parts)delete t.parts;else if(n.parts&&e.parts)for(let i=0;i<e.parts.length;i++)n.parts&&n.parts[i]&&(t.parts[i]=ci(n.parts[i],e.parts[i]));return!n.skipped&&e.skipped&&(t.skipped=!1),n.preload&&!e.preload&&(t.preload=!1),t},Lv=(n,e,t)=>{const i=n.slice(),r=e.slice();t=t||0;const s=[];let a;for(let o=0;o<r.length;o++){const l=i[o+t],u=r[o];l?(a=l.map||a,s.push(wv(l,u))):(a&&!u.map&&(u.map=a),s.push(u))}return s},cp=(n,e)=>{!n.resolvedUri&&n.uri&&(n.resolvedUri=er(e,n.uri)),n.key&&!n.key.resolvedUri&&(n.key.resolvedUri=er(e,n.key.uri)),n.map&&!n.map.resolvedUri&&(n.map.resolvedUri=er(e,n.map.uri)),n.map&&n.map.key&&!n.map.key.resolvedUri&&(n.map.key.resolvedUri=er(e,n.map.key.uri)),n.parts&&n.parts.length&&n.parts.forEach(t=>{t.resolvedUri||(t.resolvedUri=er(e,t.uri))}),n.preloadHints&&n.preloadHints.length&&n.preloadHints.forEach(t=>{t.resolvedUri||(t.resolvedUri=er(e,t.uri))})},hp=function(n){const e=n.segments||[],t=n.preloadSegment;if(t&&t.parts&&t.parts.length){if(t.preloadHints){for(let i=0;i<t.preloadHints.length;i++)if(t.preloadHints[i].type==="MAP")return e}t.duration=n.targetDuration,t.preload=!0,e.push(t)}return e},fp=(n,e)=>n===e||n.segments&&e.segments&&n.segments.length===e.segments.length&&n.endList===e.endList&&n.mediaSequence===e.mediaSequence&&n.preloadSegment===e.preloadSegment,Qd=(n,e,t=fp)=>{const i=ci(n,{}),r=i.playlists[e.id];if(!r||t(r,e))return null;e.segments=hp(e);const s=ci(r,e);if(s.preloadSegment&&!e.preloadSegment&&delete s.preloadSegment,r.segments){if(e.skip){e.segments=e.segments||[];for(let a=0;a<e.skip.skippedSegments;a++)e.segments.unshift({skipped:!0})}s.segments=Lv(r.segments,e.segments,e.mediaSequence-r.mediaSequence)}s.segments.forEach(a=>{cp(a,s.resolvedUri)});for(let a=0;a<i.playlists.length;a++)i.playlists[a].id===e.id&&(i.playlists[a]=s);return i.playlists[e.id]=s,i.playlists[e.uri]=s,Aa(n,(a,o,l,u)=>{if(!!a.playlists)for(let d=0;d<a.playlists.length;d++)e.id===a.playlists[d].id&&(a.playlists[d]=s)}),i},Zd=(n,e)=>{const t=n.segments||[],i=t[t.length-1],r=i&&i.parts&&i.parts[i.parts.length-1],s=r&&r.duration||i&&i.duration;return e&&s?s*1e3:(n.partTargetDuration||n.targetDuration||10)*500};class ba extends Sv{constructor(e,t,i={}){super();if(!e)throw new Error("A non-empty playlist URL or object is required");this.logger_=tr("PlaylistLoader");const{withCredentials:r=!1}=i;this.src=e,this.vhs_=t,this.withCredentials=r;const s=t.options_;this.customTagParsers=s&&s.customTagParsers||[],this.customTagMappers=s&&s.customTagMappers||[],this.llhls=s&&s.llhls,this.state="HAVE_NOTHING",this.handleMediaupdatetimeout_=this.handleMediaupdatetimeout_.bind(this),this.on("mediaupdatetimeout",this.handleMediaupdatetimeout_)}handleMediaupdatetimeout_(){if(this.state!=="HAVE_METADATA")return;const e=this.media();let t=er(this.main.uri,e.uri);this.llhls&&(t=Cv(t,e)),this.state="HAVE_CURRENT_METADATA",this.request=this.vhs_.xhr({uri:t,withCredentials:this.withCredentials},(i,r)=>{if(!!this.request){if(i)return this.playlistRequestError(this.request,this.media(),"HAVE_METADATA");this.haveMetadata({playlistString:this.request.responseText,url:this.media().uri,id:this.media().id})}})}playlistRequestError(e,t,i){const{uri:r,id:s}=t;this.request=null,i&&(this.state=i),this.error={playlist:this.main.playlists[s],status:e.status,message:`HLS playlist request error at URL: ${r}.`,responseText:e.responseText,code:e.status>=500?4:2},this.trigger("error")}parseManifest_({url:e,manifestString:t}){return _v({onwarn:({message:i})=>this.logger_(`m3u8-parser warn for ${e}: ${i}`),oninfo:({message:i})=>this.logger_(`m3u8-parser info for ${e}: ${i}`),manifestString:t,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,llhls:this.llhls})}haveMetadata({playlistString:e,playlistObject:t,url:i,id:r}){this.request=null,this.state="HAVE_METADATA";const s=t||this.parseManifest_({url:i,manifestString:e});s.lastRequest=Date.now(),up({playlist:s,uri:i,id:r});const a=Qd(this.main,s);this.targetDuration=s.partTargetDuration||s.targetDuration,this.pendingMedia_=null,a?(this.main=a,this.media_=this.main.playlists[r]):this.trigger("playlistunchanged"),this.updateMediaUpdateTimeout_(Zd(this.media(),!!a)),this.trigger("loadedplaylist")}dispose(){this.trigger("dispose"),this.stopRequest(),q().clearTimeout(this.mediaUpdateTimeout),q().clearTimeout(this.finalRenditionTimeout),this.off()}stopRequest(){if(this.request){const e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}media(e,t){if(!e)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);if(typeof e=="string"){if(!this.main.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.main.playlists[e]}if(q().clearTimeout(this.finalRenditionTimeout),t){const a=(e.partTargetDuration||e.targetDuration)/2*1e3||5*1e3;this.finalRenditionTimeout=q().setTimeout(this.media.bind(this,e,!1),a);return}const i=this.state,r=!this.media_||e.id!==this.media_.id,s=this.main.playlists[e.id];if(s&&s.endList||e.endList&&e.segments.length){this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=e,r&&(this.trigger("mediachanging"),i==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange"));return}if(this.updateMediaUpdateTimeout_(Zd(e,!0)),!!r){if(this.state="SWITCHING_MEDIA",this.request){if(e.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.pendingMedia_=e,this.request=this.vhs_.xhr({uri:e.resolvedUri,withCredentials:this.withCredentials},(a,o)=>{if(!!this.request){if(e.lastRequest=Date.now(),e.resolvedUri=vl(e.resolvedUri,o),a)return this.playlistRequestError(this.request,e,i);this.haveMetadata({playlistString:o.responseText,url:e.uri,id:e.id}),i==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange")}})}}pause(){this.mediaUpdateTimeout&&(q().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.stopRequest(),this.state==="HAVE_NOTHING"&&(this.started=!1),this.state==="SWITCHING_MEDIA"?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MAIN_MANIFEST":this.state==="HAVE_CURRENT_METADATA"&&(this.state="HAVE_METADATA")}load(e){this.mediaUpdateTimeout&&(q().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null);const t=this.media();if(e){const i=t?(t.partTargetDuration||t.targetDuration)/2*1e3:5*1e3;this.mediaUpdateTimeout=q().setTimeout(()=>{this.mediaUpdateTimeout=null,this.load()},i);return}if(!this.started){this.start();return}t&&!t.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist")}updateMediaUpdateTimeout_(e){this.mediaUpdateTimeout&&(q().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),!(!this.media()||this.media().endList)&&(this.mediaUpdateTimeout=q().setTimeout(()=>{this.mediaUpdateTimeout=null,this.trigger("mediaupdatetimeout"),this.updateMediaUpdateTimeout_(e)},e))}start(){if(this.started=!0,typeof this.src=="object"){this.src.uri||(this.src.uri=q().location.href),this.src.resolvedUri=this.src.uri,setTimeout(()=>{this.setupInitialPlaylist(this.src)},0);return}this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials},(e,t)=>{if(!this.request)return;if(this.request=null,e)return this.error={status:t.status,message:`HLS playlist request error at URL: ${this.src}.`,responseText:t.responseText,code:2},this.state==="HAVE_NOTHING"&&(this.started=!1),this.trigger("error");this.src=vl(this.src,t);const i=this.parseManifest_({manifestString:t.responseText,url:this.src});this.setupInitialPlaylist(i)})}srcUri(){return typeof this.src=="string"?this.src:this.src.uri}setupInitialPlaylist(e){if(this.state="HAVE_MAIN_MANIFEST",e.playlists){this.main=e,dp(this.main,this.srcUri()),e.playlists.forEach(i=>{i.segments=hp(i),i.segments.forEach(r=>{cp(r,i.resolvedUri)})}),this.trigger("loadedplaylist"),this.request||this.media(this.main.playlists[0]);return}const t=this.srcUri()||q().location.href;this.main=Tv(e,t),this.haveMetadata({playlistObject:e,url:t,id:this.main.playlists[0].id}),this.trigger("loadedmetadata")}}const{xhr:Dv}=Re,Jd=function(n,e,t,i){const r=n.responseType==="arraybuffer"?n.response:n.responseText;!e&&r&&(n.responseTime=Date.now(),n.roundTripTime=n.responseTime-n.requestTime,n.bytesReceived=r.byteLength||r.length,n.bandwidth||(n.bandwidth=Math.floor(n.bytesReceived/n.roundTripTime*8*1e3))),t.headers&&(n.responseHeaders=t.headers),e&&e.code==="ETIMEDOUT"&&(n.timedout=!0),!e&&!n.aborted&&t.statusCode!==200&&t.statusCode!==206&&t.statusCode!==0&&(e=new Error("XHR Failed with a response of: "+(n&&(r||n.responseText)))),i(e,n)},pp=function(){const n=function e(t,i){t=ci({timeout:45e3},t);const r=e.beforeRequest||Re.Vhs.xhr.beforeRequest;if(r&&typeof r=="function"){const l=r(t);l&&(t=l)}const a=(Re.Vhs.xhr.original===!0?Dv:Re.Vhs.xhr)(t,function(l,u){return Jd(a,l,u,i)}),o=a.abort;return a.abort=function(){return a.aborted=!0,o.apply(a,arguments)},a.uri=t.uri,a.requestTime=Date.now(),a};return n.original=!0,n},kv=function(n){let e;const t=n.offset;return typeof n.offset=="bigint"||typeof n.length=="bigint"?e=q().BigInt(n.offset)+q().BigInt(n.length)-q().BigInt(1):e=n.offset+n.length-1,"bytes="+t+"-"+e},ec=function(n){const e={};return n.byterange&&(e.Range=kv(n.byterange)),e},Iv=function(n,e){return n.start(e)+"-"+n.end(e)},Rv=function(n,e){const t=n.toString(16);return"00".substring(0,2-t.length)+t+(e%2?" ":"")},Ov=function(n){return n>=32&&n<126?String.fromCharCode(n):"."},mp=function(n){const e={};return Object.keys(n).forEach(t=>{const i=n[t];ki(i)?e[t]={bytes:i.buffer,byteOffset:i.byteOffset,byteLength:i.byteLength}:e[t]=i}),e},_l=function(n){const e=n.byterange||{length:Infinity,offset:0};return[e.length,e.offset,n.resolvedUri].join(",")},gp=function(n){return n.resolvedUri},yp=n=>{const e=Array.prototype.slice.call(n),t=16;let i="",r,s;for(let a=0;a<e.length/t;a++)r=e.slice(a*t,a*t+t).map(Rv).join(""),s=e.slice(a*t,a*t+t).map(Ov).join(""),i+=r+" "+s+`
`;return i};var Pv=Object.freeze({__proto__:null,createTransferableMessage:mp,initSegmentId:_l,segmentKeyId:gp,hexDump:yp,tagDump:({bytes:n})=>yp(n),textRanges:n=>{let e="",t;for(t=0;t<n.length;t++)e+=Iv(n,t)+" ";return e}});const vp=.25,Bv=(n,e)=>{if(!e.dateTimeObject)return null;const t=e.videoTimingInfo.transmuxerPrependedSeconds,r=e.videoTimingInfo.transmuxedPresentationStart+t,s=n-r;return new Date(e.dateTimeObject.getTime()+s*1e3)},Fv=n=>n.transmuxedPresentationEnd-n.transmuxedPresentationStart-n.transmuxerPrependedSeconds,Mv=(n,e)=>{let t;try{t=new Date(n)}catch(l){return null}if(!e||!e.segments||e.segments.length===0)return null;let i=e.segments[0];if(t<i.dateTimeObject)return null;for(let l=0;l<e.segments.length-1;l++){i=e.segments[l];const u=e.segments[l+1].dateTimeObject;if(t<u)break}const r=e.segments[e.segments.length-1],s=r.dateTimeObject,a=r.videoTimingInfo?Fv(r.videoTimingInfo):r.duration+r.duration*vp,o=new Date(s.getTime()+a*1e3);return t>o?null:(t>s&&(i=r),{segment:i,estimatedStart:i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationStart:fn.duration(e,e.mediaSequence+e.segments.indexOf(i)),type:i.videoTimingInfo?"accurate":"estimate"})},Nv=(n,e)=>{if(!e||!e.segments||e.segments.length===0)return null;let t=0,i;for(let s=0;s<e.segments.length&&(i=e.segments[s],t=i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationEnd:t+i.duration,!(n<=t));s++);const r=e.segments[e.segments.length-1];if(r.videoTimingInfo&&r.videoTimingInfo.transmuxedPresentationEnd<n)return null;if(n>t){if(n>t+r.duration*vp)return null;i=r}return{segment:i,estimatedStart:i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationStart:t-i.duration,type:i.videoTimingInfo?"accurate":"estimate"}},Uv=(n,e)=>{let t,i;try{t=new Date(n),i=new Date(e)}catch(a){}const r=t.getTime();return(i.getTime()-r)/1e3},jv=n=>{if(!n.segments||n.segments.length===0)return!1;for(let e=0;e<n.segments.length;e++)if(!n.segments[e].dateTimeObject)return!1;return!0},$v=({playlist:n,time:e=void 0,callback:t})=>{if(!t)throw new Error("getProgramTime: callback must be provided");if(!n||e===void 0)return t({message:"getProgramTime: playlist and time must be provided"});const i=Nv(e,n);if(!i)return t({message:"valid programTime was not found"});if(i.type==="estimate")return t({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:i.estimatedStart});const r={mediaSeconds:e},s=Bv(e,i.segment);return s&&(r.programDateTime=s.toISOString()),t(null,r)},Ap=({programTime:n,playlist:e,retryCount:t=2,seekTo:i,pauseAfterSeek:r=!0,tech:s,callback:a})=>{if(!a)throw new Error("seekToProgramTime: callback must be provided");if(typeof n=="undefined"||!e||!i)return a({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!e.endList&&!s.hasStarted_)return a({message:"player must be playing a live stream to start buffering"});if(!jv(e))return a({message:"programDateTime tags must be provided in the manifest "+e.resolvedUri});const o=Mv(n,e);if(!o)return a({message:`${n} was not found in the stream`});const l=o.segment,u=Uv(l.dateTimeObject,n);if(o.type==="estimate"){if(t===0)return a({message:`${n} is not buffered yet. Try again`});i(o.estimatedStart+u),s.one("seeked",()=>{Ap({programTime:n,playlist:e,retryCount:t-1,seekTo:i,pauseAfterSeek:r,tech:s,callback:a})});return}const d=l.start+u,h=()=>a(null,s.currentTime());s.one("seeked",h),r&&s.pause(),i(d)},tc=(n,e)=>{if(n.readyState===4)return e()},Gv=(n,e,t)=>{let i=[],r,s=!1;const a=function(d,h,v,x){return h.abort(),s=!0,t(d,h,v,x)},o=function(d,h){if(s)return;if(d)return a(d,h,"",i);const v=h.responseText.substring(i&&i.byteLength||0,h.responseText.length);if(i=St(i,pt(v,!0)),r=r||As(i),i.length<10||r&&i.length<r+2)return tc(h,()=>a(d,h,"",i));const x=Wa(i);return x==="ts"&&i.length<188?tc(h,()=>a(d,h,"",i)):!x&&i.length<376?tc(h,()=>a(d,h,"",i)):a(null,h,x,i)},u=e({uri:n,beforeSend(d){d.overrideMimeType("text/plain; charset=x-user-defined"),d.addEventListener("progress",function({total:h,loaded:v}){return Jd(d,null,{statusCode:d.status},o)})}},function(d,h){return Jd(u,d,h,o)});return u},{EventTarget:Vv}=Re,bp=function(n,e){if(!fp(n,e)||n.sidx&&e.sidx&&(n.sidx.offset!==e.sidx.offset||n.sidx.length!==e.sidx.length))return!1;if(!n.sidx&&e.sidx||n.sidx&&!e.sidx||n.segments&&!e.segments||!n.segments&&e.segments)return!1;if(!n.segments&&!e.segments)return!0;for(let t=0;t<n.segments.length;t++){const i=n.segments[t],r=e.segments[t];if(i.uri!==r.uri)return!1;if(!i.byterange&&!r.byterange)continue;const s=i.byterange,a=r.byterange;if(s&&!a||!s&&a||s.offset!==a.offset||s.length!==a.length)return!1}return!0},Hv=(n,e,t,i)=>{const r=i.attributes.NAME||t;return`placeholder-uri-${n}-${e}-${r}`},Wv=({mainXml:n,srcUrl:e,clientOffset:t,sidxMapping:i,previousManifest:r})=>{const s=Bu(n,{manifestUri:e,clientOffset:t,sidxMapping:i,previousManifest:r});return dp(s,e,Hv),s},Kv=(n,e)=>{Aa(n,(t,i,r,s)=>{s in e.mediaGroups[i][r]||delete n.mediaGroups[i][r][s]})},qv=(n,e,t)=>{let i=!0,r=ci(n,{duration:e.duration,minimumUpdatePeriod:e.minimumUpdatePeriod,timelineStarts:e.timelineStarts});for(let s=0;s<e.playlists.length;s++){const a=e.playlists[s];if(a.sidx){const l=wi(a.sidx);t&&t[l]&&t[l].sidx&&Yt(a,t[l].sidx,a.sidx.resolvedUri)}const o=Qd(r,a,bp);o&&(r=o,i=!1)}return Aa(e,(s,a,o,l)=>{if(s.playlists&&s.playlists.length){const u=s.playlists[0].id,d=Qd(r,s.playlists[0],bp);d&&(r=d,l in r.mediaGroups[a][o]||(r.mediaGroups[a][o][l]=s),r.mediaGroups[a][o][l].playlists[0]=r.playlists[u],i=!1)}}),Kv(r,e),e.minimumUpdatePeriod!==n.minimumUpdatePeriod&&(i=!1),i?null:r},zv=(n,e)=>(Boolean(!n.map&&!e.map)||Boolean(n.map&&e.map&&n.map.byterange.offset===e.map.byterange.offset&&n.map.byterange.length===e.map.byterange.length))&&n.uri===e.uri&&n.byterange.offset===e.byterange.offset&&n.byterange.length===e.byterange.length,_p=(n,e)=>{const t={};for(const i in n){const s=n[i].sidx;if(s){const a=wi(s);if(!e[a])break;const o=e[a].sidxInfo;zv(o,s)&&(t[a]=e[a])}}return t},Yv=(n,e)=>{let i=_p(n.playlists,e);return Aa(n,(r,s,a,o)=>{if(r.playlists&&r.playlists.length){const l=r.playlists;i=ci(i,_p(l,e))}}),i};class ic extends Vv{constructor(e,t,i={},r){super();this.mainPlaylistLoader_=r||this,r||(this.isMain_=!0);const{withCredentials:s=!1}=i;if(this.vhs_=t,this.withCredentials=s,!e)throw new Error("A non-empty playlist URL or object is required");this.on("minimumUpdatePeriod",()=>{this.refreshXml_()}),this.on("mediaupdatetimeout",()=>{this.refreshMedia_(this.media().id)}),this.state="HAVE_NOTHING",this.loadedPlaylists_={},this.logger_=tr("DashPlaylistLoader"),this.isMain_?(this.mainPlaylistLoader_.srcUrl=e,this.mainPlaylistLoader_.sidxMapping_={}):this.childPlaylist_=e}requestErrored_(e,t,i){if(!this.request)return!0;if(this.request=null,e)return this.error=typeof e=="object"&&!(e instanceof Error)?e:{status:t.status,message:"DASH request error at URL: "+t.uri,response:t.response,code:2},i&&(this.state=i),this.trigger("error"),!0}addSidxSegments_(e,t,i){const r=e.sidx&&wi(e.sidx);if(!e.sidx||!r||this.mainPlaylistLoader_.sidxMapping_[r]){this.mediaRequest_=q().setTimeout(()=>i(!1),0);return}const s=vl(e.sidx.resolvedUri),a=(o,l)=>{if(this.requestErrored_(o,l,t))return;const u=this.mainPlaylistLoader_.sidxMapping_;let d;try{d=Nu()(tt(l.response).subarray(8))}catch(h){this.requestErrored_(h,l,t);return}return u[r]={sidxInfo:e.sidx,sidx:d},Yt(e,d,e.sidx.resolvedUri),i(!0)};this.request=Gv(s,this.vhs_.xhr,(o,l,u,d)=>{if(o)return a(o,l);if(!u||u!=="mp4")return a({status:l.status,message:`Unsupported ${u||"unknown"} container type for sidx segment at URL: ${s}`,response:"",playlist:e,internal:!0,playlistExclusionDuration:Infinity,code:2},l);const{offset:h,length:v}=e.sidx.byterange;if(d.length>=v+h)return a(o,{response:d.subarray(h,h+v),status:l.status,uri:l.uri});this.request=this.vhs_.xhr({uri:s,responseType:"arraybuffer",headers:ec({byterange:e.sidx.byterange})},a)})}dispose(){this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},q().clearTimeout(this.minimumUpdatePeriodTimeout_),q().clearTimeout(this.mediaRequest_),q().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.mediaRequest_=null,this.minimumUpdatePeriodTimeout_=null,this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.off()}hasPendingRequest(){return this.request||this.mediaRequest_}stopRequest(){if(this.request){const e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}media(e){if(!e)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);const t=this.state;if(typeof e=="string"){if(!this.mainPlaylistLoader_.main.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.mainPlaylistLoader_.main.playlists[e]}const i=!this.media_||e.id!==this.media_.id;if(i&&this.loadedPlaylists_[e.id]&&this.loadedPlaylists_[e.id].endList){this.state="HAVE_METADATA",this.media_=e,i&&(this.trigger("mediachanging"),this.trigger("mediachange"));return}!i||(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(e,t,r=>{this.haveMetadata({startingState:t,playlist:e})}))}haveMetadata({startingState:e,playlist:t}){this.state="HAVE_METADATA",this.loadedPlaylists_[t.id]=t,this.mediaRequest_=null,this.refreshMedia_(t.id),e==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange")}pause(){this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.stopRequest(),q().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.isMain_&&(q().clearTimeout(this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_),this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_=null),this.state==="HAVE_NOTHING"&&(this.started=!1)}load(e){q().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null;const t=this.media();if(e){const i=t?t.targetDuration/2*1e3:5*1e3;this.mediaUpdateTimeout=q().setTimeout(()=>this.load(),i);return}if(!this.started){this.start();return}t&&!t.endList?(this.isMain_&&!this.minimumUpdatePeriodTimeout_&&(this.trigger("minimumUpdatePeriod"),this.updateMinimumUpdatePeriodTimeout_()),this.trigger("mediaupdatetimeout")):this.trigger("loadedplaylist")}start(){if(this.started=!0,!this.isMain_){this.mediaRequest_=q().setTimeout(()=>this.haveMain_(),0);return}this.requestMain_((e,t)=>{this.haveMain_(),!this.hasPendingRequest()&&!this.media_&&this.media(this.mainPlaylistLoader_.main.playlists[0])})}requestMain_(e){this.request=this.vhs_.xhr({uri:this.mainPlaylistLoader_.srcUrl,withCredentials:this.withCredentials},(t,i)=>{if(this.requestErrored_(t,i)){this.state==="HAVE_NOTHING"&&(this.started=!1);return}const r=i.responseText!==this.mainPlaylistLoader_.mainXml_;if(this.mainPlaylistLoader_.mainXml_=i.responseText,i.responseHeaders&&i.responseHeaders.date?this.mainLoaded_=Date.parse(i.responseHeaders.date):this.mainLoaded_=Date.now(),this.mainPlaylistLoader_.srcUrl=vl(this.mainPlaylistLoader_.srcUrl,i),r){this.handleMain_(),this.syncClientServerClock_(()=>e(i,r));return}return e(i,r)})}syncClientServerClock_(e){const t=Fu(this.mainPlaylistLoader_.mainXml_);if(t===null)return this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),e();if(t.method==="DIRECT")return this.mainPlaylistLoader_.clientOffset_=t.value-Date.now(),e();this.request=this.vhs_.xhr({uri:er(this.mainPlaylistLoader_.srcUrl,t.value),method:t.method,withCredentials:this.withCredentials},(i,r)=>{if(!this.request)return;if(i)return this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),e();let s;t.method==="HEAD"?!r.responseHeaders||!r.responseHeaders.date?s=this.mainLoaded_:s=Date.parse(r.responseHeaders.date):s=Date.parse(r.responseText),this.mainPlaylistLoader_.clientOffset_=s-Date.now(),e()})}haveMain_(){this.state="HAVE_MAIN_MANIFEST",this.isMain_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)}handleMain_(){this.mediaRequest_=null;const e=this.mainPlaylistLoader_.main;let t=Wv({mainXml:this.mainPlaylistLoader_.mainXml_,srcUrl:this.mainPlaylistLoader_.srcUrl,clientOffset:this.mainPlaylistLoader_.clientOffset_,sidxMapping:this.mainPlaylistLoader_.sidxMapping_,previousManifest:e});e&&(t=qv(e,t,this.mainPlaylistLoader_.sidxMapping_)),this.mainPlaylistLoader_.main=t||e;const i=this.mainPlaylistLoader_.main.locations&&this.mainPlaylistLoader_.main.locations[0];return i&&i!==this.mainPlaylistLoader_.srcUrl&&(this.mainPlaylistLoader_.srcUrl=i),(!e||t&&t.minimumUpdatePeriod!==e.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_(),Boolean(t)}updateMinimumUpdatePeriodTimeout_(){const e=this.mainPlaylistLoader_;e.createMupOnMedia_&&(e.off("loadedmetadata",e.createMupOnMedia_),e.createMupOnMedia_=null),e.minimumUpdatePeriodTimeout_&&(q().clearTimeout(e.minimumUpdatePeriodTimeout_),e.minimumUpdatePeriodTimeout_=null);let t=e.main&&e.main.minimumUpdatePeriod;if(t===0&&(e.media()?t=e.media().targetDuration*1e3:(e.createMupOnMedia_=e.updateMinimumUpdatePeriodTimeout_,e.one("loadedmetadata",e.createMupOnMedia_))),typeof t!="number"||t<=0){t<0&&this.logger_(`found invalid minimumUpdatePeriod of ${t}, not setting a timeout`);return}this.createMUPTimeout_(t)}createMUPTimeout_(e){const t=this.mainPlaylistLoader_;t.minimumUpdatePeriodTimeout_=q().setTimeout(()=>{t.minimumUpdatePeriodTimeout_=null,t.trigger("minimumUpdatePeriod"),t.createMUPTimeout_(e)},e)}refreshXml_(){this.requestMain_((e,t)=>{!t||(this.media_&&(this.media_=this.mainPlaylistLoader_.main.playlists[this.media_.id]),this.mainPlaylistLoader_.sidxMapping_=Yv(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.sidxMapping_),this.addSidxSegments_(this.media(),this.state,i=>{this.refreshMedia_(this.media().id)}))})}refreshMedia_(e){if(!e)throw new Error("refreshMedia_ must take a media id");this.media_&&this.isMain_&&this.handleMain_();const t=this.mainPlaylistLoader_.main.playlists,i=!this.media_||this.media_!==t[e];if(i?this.media_=t[e]:this.trigger("playlistunchanged"),!this.mediaUpdateTimeout){const r=()=>{this.media().endList||(this.mediaUpdateTimeout=q().setTimeout(()=>{this.trigger("mediaupdatetimeout"),r()},Zd(this.media(),Boolean(i))))};r()}this.trigger("loadedplaylist")}}var ji={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30};const Xv=n=>{const e=new Uint8Array(new ArrayBuffer(n.length));for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e.buffer},xp=function(n){return n.on=n.addEventListener,n.off=n.removeEventListener,n},Qv=function(n){try{return URL.createObjectURL(new Blob([n],{type:"application/javascript"}))}catch(e){const t=new BlobBuilder;return t.append(n),URL.createObjectURL(t.getBlob())}},Ep=function(n){return function(){const e=Qv(n),t=xp(new Worker(e));t.objURL=e;const i=t.terminate;return t.on=t.addEventListener,t.off=t.removeEventListener,t.terminate=function(){return URL.revokeObjectURL(e),i.call(this)},t}},Tp=function(n){return`var browserWorkerPolyFill = ${xp.toString()};
browserWorkerPolyFill(self);
`+n},Sp=function(n){return n.toString().replace(/^function.+?{/,"").slice(0,-1)},Zv=Tp(Sp(function(){var n=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof Ne.g!="undefined"?Ne.g:typeof self!="undefined"?self:{},e=function(){this.init=function(){var c={};this.on=function(f,y){c[f]||(c[f]=[]),c[f]=c[f].concat(y)},this.off=function(f,y){var g;return c[f]?(g=c[f].indexOf(y),c[f]=c[f].slice(),c[f].splice(g,1),g>-1):!1},this.trigger=function(f){var y,g,E,D;if(y=c[f],!!y)if(arguments.length===2)for(E=y.length,g=0;g<E;++g)y[g].call(this,arguments[1]);else{for(D=[],g=arguments.length,g=1;g<arguments.length;++g)D.push(arguments[g]);for(E=y.length,g=0;g<E;++g)y[g].apply(this,D)}},this.dispose=function(){c={}}}};e.prototype.pipe=function(c){return this.on("data",function(f){c.push(f)}),this.on("done",function(f){c.flush(f)}),this.on("partialdone",function(f){c.partialFlush(f)}),this.on("endedtimeline",function(f){c.endTimeline(f)}),this.on("reset",function(f){c.reset(f)}),c},e.prototype.push=function(c){this.trigger("data",c)},e.prototype.flush=function(c){this.trigger("done",c)},e.prototype.partialFlush=function(c){this.trigger("partialdone",c)},e.prototype.endTimeline=function(c){this.trigger("endedtimeline",c)},e.prototype.reset=function(c){this.trigger("reset",c)};var t=e,i=Math.pow(2,32),r=function(c){var f=new DataView(c.buffer,c.byteOffset,c.byteLength),y;return f.getBigUint64?(y=f.getBigUint64(0),y<Number.MAX_SAFE_INTEGER?Number(y):y):f.getUint32(0)*i+f.getUint32(4)},s={getUint64:r,MAX_UINT32:i},a=s.MAX_UINT32,o,l,u,d,h,v,x,_,R,N,z,J,ue,pe,te,ke,we,Ge,Ve,Fe,mt,et,nt,Pt,Gt,Kt,qt,ft,bt,Vt,zt,jt,vi,ln,vn,un;(function(){var c;if(nt={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},typeof Uint8Array!="undefined"){for(c in nt)nt.hasOwnProperty(c)&&(nt[c]=[c.charCodeAt(0),c.charCodeAt(1),c.charCodeAt(2),c.charCodeAt(3)]);Pt=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),Kt=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),Gt=new Uint8Array([0,0,0,1]),qt=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),ft=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),bt={video:qt,audio:ft},jt=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),zt=new Uint8Array([0,0,0,0,0,0,0,0]),vi=new Uint8Array([0,0,0,0,0,0,0,0]),ln=vi,vn=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),un=vi,Vt=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})(),o=function(c){var f=[],y=0,g,E,D;for(g=1;g<arguments.length;g++)f.push(arguments[g]);for(g=f.length;g--;)y+=f[g].byteLength;for(E=new Uint8Array(y+8),D=new DataView(E.buffer,E.byteOffset,E.byteLength),D.setUint32(0,E.byteLength),E.set(c,4),g=0,y=8;g<f.length;g++)E.set(f[g],y),y+=f[g].byteLength;return E},l=function(){return o(nt.dinf,o(nt.dref,jt))},u=function(c){return o(nt.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,c.audioobjecttype<<3|c.samplingfrequencyindex>>>1,c.samplingfrequencyindex<<7|c.channelcount<<3,6,1,2]))},d=function(){return o(nt.ftyp,Pt,Gt,Pt,Kt)},ke=function(c){return o(nt.hdlr,bt[c])},h=function(c){return o(nt.mdat,c)},te=function(c){var f=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,c.duration>>>24&255,c.duration>>>16&255,c.duration>>>8&255,c.duration&255,85,196,0,0]);return c.samplerate&&(f[12]=c.samplerate>>>24&255,f[13]=c.samplerate>>>16&255,f[14]=c.samplerate>>>8&255,f[15]=c.samplerate&255),o(nt.mdhd,f)},pe=function(c){return o(nt.mdia,te(c),ke(c.type),x(c))},v=function(c){return o(nt.mfhd,new Uint8Array([0,0,0,0,(c&4278190080)>>24,(c&16711680)>>16,(c&65280)>>8,c&255]))},x=function(c){return o(nt.minf,c.type==="video"?o(nt.vmhd,Vt):o(nt.smhd,zt),l(),Ge(c))},_=function(c,f){for(var y=[],g=f.length;g--;)y[g]=Fe(f[g]);return o.apply(null,[nt.moof,v(c)].concat(y))},R=function(c){for(var f=c.length,y=[];f--;)y[f]=J(c[f]);return o.apply(null,[nt.moov,z(4294967295)].concat(y).concat(N(c)))},N=function(c){for(var f=c.length,y=[];f--;)y[f]=mt(c[f]);return o.apply(null,[nt.mvex].concat(y))},z=function(c){var f=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(c&4278190080)>>24,(c&16711680)>>16,(c&65280)>>8,c&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return o(nt.mvhd,f)},we=function(c){var f=c.samples||[],y=new Uint8Array(4+f.length),g,E;for(E=0;E<f.length;E++)g=f[E].flags,y[E+4]=g.dependsOn<<4|g.isDependedOn<<2|g.hasRedundancy;return o(nt.sdtp,y)},Ge=function(c){return o(nt.stbl,Ve(c),o(nt.stts,un),o(nt.stsc,ln),o(nt.stsz,vn),o(nt.stco,vi))},function(){var c,f;Ve=function(y){return o(nt.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),y.type==="video"?c(y):f(y))},c=function(y){var g=y.sps||[],E=y.pps||[],D=[],ee=[],ae,de;for(ae=0;ae<g.length;ae++)D.push((g[ae].byteLength&65280)>>>8),D.push(g[ae].byteLength&255),D=D.concat(Array.prototype.slice.call(g[ae]));for(ae=0;ae<E.length;ae++)ee.push((E[ae].byteLength&65280)>>>8),ee.push(E[ae].byteLength&255),ee=ee.concat(Array.prototype.slice.call(E[ae]));if(de=[nt.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(y.width&65280)>>8,y.width&255,(y.height&65280)>>8,y.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o(nt.avcC,new Uint8Array([1,y.profileIdc,y.profileCompatibility,y.levelIdc,255].concat([g.length],D,[E.length],ee))),o(nt.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],y.sarRatio){var me=y.sarRatio[0],Se=y.sarRatio[1];de.push(o(nt.pasp,new Uint8Array([(me&4278190080)>>24,(me&16711680)>>16,(me&65280)>>8,me&255,(Se&4278190080)>>24,(Se&16711680)>>16,(Se&65280)>>8,Se&255])))}return o.apply(null,de)},f=function(y){return o(nt.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(y.channelcount&65280)>>8,y.channelcount&255,(y.samplesize&65280)>>8,y.samplesize&255,0,0,0,0,(y.samplerate&65280)>>8,y.samplerate&255,0,0]),u(y))}}(),ue=function(c){var f=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(c.id&4278190080)>>24,(c.id&16711680)>>16,(c.id&65280)>>8,c.id&255,0,0,0,0,(c.duration&4278190080)>>24,(c.duration&16711680)>>16,(c.duration&65280)>>8,c.duration&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(c.width&65280)>>8,c.width&255,0,0,(c.height&65280)>>8,c.height&255,0,0]);return o(nt.tkhd,f)},Fe=function(c){var f,y,g,E,D,ee,ae;return f=o(nt.tfhd,new Uint8Array([0,0,0,58,(c.id&4278190080)>>24,(c.id&16711680)>>16,(c.id&65280)>>8,c.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),ee=Math.floor(c.baseMediaDecodeTime/a),ae=Math.floor(c.baseMediaDecodeTime%a),y=o(nt.tfdt,new Uint8Array([1,0,0,0,ee>>>24&255,ee>>>16&255,ee>>>8&255,ee&255,ae>>>24&255,ae>>>16&255,ae>>>8&255,ae&255])),D=32+20+8+16+8+8,c.type==="audio"?(g=et(c,D),o(nt.traf,f,y,g)):(E=we(c),g=et(c,E.length+D),o(nt.traf,f,y,g,E))},J=function(c){return c.duration=c.duration||4294967295,o(nt.trak,ue(c),pe(c))},mt=function(c){var f=new Uint8Array([0,0,0,0,(c.id&4278190080)>>24,(c.id&16711680)>>16,(c.id&65280)>>8,c.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return c.type!=="video"&&(f[f.length-1]=0),o(nt.trex,f)},function(){var c,f,y;y=function(g,E){var D=0,ee=0,ae=0,de=0;return g.length&&(g[0].duration!==void 0&&(D=1),g[0].size!==void 0&&(ee=2),g[0].flags!==void 0&&(ae=4),g[0].compositionTimeOffset!==void 0&&(de=8)),[0,0,D|ee|ae|de,1,(g.length&4278190080)>>>24,(g.length&16711680)>>>16,(g.length&65280)>>>8,g.length&255,(E&4278190080)>>>24,(E&16711680)>>>16,(E&65280)>>>8,E&255]},f=function(g,E){var D,ee,ae,de,me,Se;for(de=g.samples||[],E+=8+12+16*de.length,ae=y(de,E),ee=new Uint8Array(ae.length+de.length*16),ee.set(ae),D=ae.length,Se=0;Se<de.length;Se++)me=de[Se],ee[D++]=(me.duration&4278190080)>>>24,ee[D++]=(me.duration&16711680)>>>16,ee[D++]=(me.duration&65280)>>>8,ee[D++]=me.duration&255,ee[D++]=(me.size&4278190080)>>>24,ee[D++]=(me.size&16711680)>>>16,ee[D++]=(me.size&65280)>>>8,ee[D++]=me.size&255,ee[D++]=me.flags.isLeading<<2|me.flags.dependsOn,ee[D++]=me.flags.isDependedOn<<6|me.flags.hasRedundancy<<4|me.flags.paddingValue<<1|me.flags.isNonSyncSample,ee[D++]=me.flags.degradationPriority&240<<8,ee[D++]=me.flags.degradationPriority&15,ee[D++]=(me.compositionTimeOffset&4278190080)>>>24,ee[D++]=(me.compositionTimeOffset&16711680)>>>16,ee[D++]=(me.compositionTimeOffset&65280)>>>8,ee[D++]=me.compositionTimeOffset&255;return o(nt.trun,ee)},c=function(g,E){var D,ee,ae,de,me,Se;for(de=g.samples||[],E+=8+12+8*de.length,ae=y(de,E),D=new Uint8Array(ae.length+de.length*8),D.set(ae),ee=ae.length,Se=0;Se<de.length;Se++)me=de[Se],D[ee++]=(me.duration&4278190080)>>>24,D[ee++]=(me.duration&16711680)>>>16,D[ee++]=(me.duration&65280)>>>8,D[ee++]=me.duration&255,D[ee++]=(me.size&4278190080)>>>24,D[ee++]=(me.size&16711680)>>>16,D[ee++]=(me.size&65280)>>>8,D[ee++]=me.size&255;return o(nt.trun,D)},et=function(g,E){return g.type==="audio"?c(g,E):f(g,E)}}();var Gr={ftyp:d,mdat:h,moof:_,moov:R,initSegment:function(c){var f=d(),y=R(c),g;return g=new Uint8Array(f.byteLength+y.byteLength),g.set(f),g.set(y,f.byteLength),g}},vo=function(c){var f,y,g=[],E=[];for(E.byteLength=0,E.nalCount=0,E.duration=0,g.byteLength=0,f=0;f<c.length;f++)y=c[f],y.nalUnitType==="access_unit_delimiter_rbsp"?(g.length&&(g.duration=y.dts-g.dts,E.byteLength+=g.byteLength,E.nalCount+=g.length,E.duration+=g.duration,E.push(g)),g=[y],g.byteLength=y.data.byteLength,g.pts=y.pts,g.dts=y.dts):(y.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"&&(g.keyFrame=!0),g.duration=y.dts-g.dts,g.byteLength+=y.data.byteLength,g.push(y));return E.length&&(!g.duration||g.duration<=0)&&(g.duration=E[E.length-1].duration),E.byteLength+=g.byteLength,E.nalCount+=g.length,E.duration+=g.duration,E.push(g),E},IT=function(c){var f,y,g=[],E=[];for(g.byteLength=0,g.nalCount=0,g.duration=0,g.pts=c[0].pts,g.dts=c[0].dts,E.byteLength=0,E.nalCount=0,E.duration=0,E.pts=c[0].pts,E.dts=c[0].dts,f=0;f<c.length;f++)y=c[f],y.keyFrame?(g.length&&(E.push(g),E.byteLength+=g.byteLength,E.nalCount+=g.nalCount,E.duration+=g.duration),g=[y],g.nalCount=y.length,g.byteLength=y.byteLength,g.pts=y.pts,g.dts=y.dts,g.duration=y.duration):(g.duration+=y.duration,g.nalCount+=y.length,g.byteLength+=y.byteLength,g.push(y));return E.length&&g.duration<=0&&(g.duration=E[E.length-1].duration),E.byteLength+=g.byteLength,E.nalCount+=g.nalCount,E.duration+=g.duration,E.push(g),E},RT=function(c){var f;return!c[0][0].keyFrame&&c.length>1&&(f=c.shift(),c.byteLength-=f.byteLength,c.nalCount-=f.nalCount,c[0][0].dts=f.dts,c[0][0].pts=f.pts,c[0][0].duration+=f.duration),c},OT=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},ig=function(c,f){var y=OT();return y.dataOffset=f,y.compositionTimeOffset=c.pts-c.dts,y.duration=c.duration,y.size=4*c.length,y.size+=c.byteLength,c.keyFrame&&(y.flags.dependsOn=2,y.flags.isNonSyncSample=0),y},PT=function(c,f){var y,g,E,D,ee,ae=f||0,de=[];for(y=0;y<c.length;y++)for(D=c[y],g=0;g<D.length;g++)ee=D[g],E=ig(ee,ae),ae+=E.size,de.push(E);return de},BT=function(c){var f,y,g,E,D,ee,ae=0,de=c.byteLength,me=c.nalCount,Se=de+4*me,Pe=new Uint8Array(Se),dt=new DataView(Pe.buffer);for(f=0;f<c.length;f++)for(E=c[f],y=0;y<E.length;y++)for(D=E[y],g=0;g<D.length;g++)ee=D[g],dt.setUint32(ae,ee.data.byteLength),ae+=4,Pe.set(ee.data,ae),ae+=ee.data.byteLength;return Pe},FT=function(c,f){var y,g=f||0,E=[];return y=ig(c,g),E.push(y),E},MT=function(c){var f,y,g=0,E=c.byteLength,D=c.length,ee=E+4*D,ae=new Uint8Array(ee),de=new DataView(ae.buffer);for(f=0;f<c.length;f++)y=c[f],de.setUint32(g,y.data.byteLength),g+=4,ae.set(y.data,g),g+=y.data.byteLength;return ae},NT={groupNalsIntoFrames:vo,groupFramesIntoGops:IT,extendFirstKeyFrame:RT,generateSampleTable:PT,concatenateNalData:BT,generateSampleTableForFrame:FT,concatenateNalDataForFrame:MT},ms=[33,16,5,32,164,27],oh=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],ti=function(c){for(var f=[];c--;)f.push(0);return f},UT=function(c){return Object.keys(c).reduce(function(f,y){return f[y]=new Uint8Array(c[y].reduce(function(g,E){return g.concat(E)},[])),f},{})},lh,jT=function(){if(!lh){var c={96e3:[ms,[227,64],ti(154),[56]],88200:[ms,[231],ti(170),[56]],64e3:[ms,[248,192],ti(240),[56]],48e3:[ms,[255,192],ti(268),[55,148,128],ti(54),[112]],44100:[ms,[255,192],ti(268),[55,163,128],ti(84),[112]],32e3:[ms,[255,192],ti(268),[55,234],ti(226),[112]],24e3:[ms,[255,192],ti(268),[55,255,128],ti(268),[111,112],ti(126),[224]],16e3:[ms,[255,192],ti(268),[55,255,128],ti(268),[111,255],ti(269),[223,108],ti(195),[1,192]],12e3:[oh,ti(268),[3,127,248],ti(268),[6,255,240],ti(268),[13,255,224],ti(268),[27,253,128],ti(259),[56]],11025:[oh,ti(268),[3,127,248],ti(268),[6,255,240],ti(268),[13,255,224],ti(268),[27,255,192],ti(268),[55,175,128],ti(108),[112]],8e3:[oh,ti(268),[3,121,16],ti(47),[7]]};lh=UT(c)}return lh},uh=9e4,dh,ch,Zl,hh,ng,rg,sg;dh=function(c){return c*uh},ch=function(c,f){return c*f},Zl=function(c){return c/uh},hh=function(c,f){return c/f},ng=function(c,f){return dh(hh(c,f))},rg=function(c,f){return ch(Zl(c),f)},sg=function(c,f,y){return Zl(y?c:c-f)};var mi={ONE_SECOND_IN_TS:uh,secondsToVideoTs:dh,secondsToAudioTs:ch,videoTsToSeconds:Zl,audioTsToSeconds:hh,audioTsToVideoTs:ng,videoTsToAudioTs:rg,metadataTsToSeconds:sg},$T=jT,Jl=mi,GT=function(c){var f,y,g=0;for(f=0;f<c.length;f++)y=c[f],g+=y.data.byteLength;return g},VT=function(c,f,y,g){var E,D=0,ee=0,ae=0,de=0,me,Se,Pe;if(!!f.length&&(E=Jl.audioTsToVideoTs(c.baseMediaDecodeTime,c.samplerate),D=Math.ceil(Jl.ONE_SECOND_IN_TS/(c.samplerate/1024)),y&&g&&(ee=E-Math.max(y,g),ae=Math.floor(ee/D),de=ae*D),!(ae<1||de>Jl.ONE_SECOND_IN_TS/2))){for(me=$T()[c.samplerate],me||(me=f[0].data),Se=0;Se<ae;Se++)Pe=f[0],f.splice(0,0,{data:me,dts:Pe.dts-D,pts:Pe.pts-D});return c.baseMediaDecodeTime-=Math.floor(Jl.videoTsToAudioTs(de,c.samplerate)),de}},HT=function(c,f,y){return f.minSegmentDts>=y?c:(f.minSegmentDts=Infinity,c.filter(function(g){return g.dts>=y?(f.minSegmentDts=Math.min(f.minSegmentDts,g.dts),f.minSegmentPts=f.minSegmentDts,!0):!1}))},WT=function(c){var f,y,g=[];for(f=0;f<c.length;f++)y=c[f],g.push({size:y.data.byteLength,duration:1024});return g},KT=function(c){var f,y,g=0,E=new Uint8Array(GT(c));for(f=0;f<c.length;f++)y=c[f],E.set(y.data,g),g+=y.data.byteLength;return E},qT={prefixWithSilence:VT,trimAdtsFramesByEarliestDts:HT,generateSampleTable:WT,concatenateFrameData:KT},zT=mi.ONE_SECOND_IN_TS,YT=function(c,f){typeof f.pts=="number"&&(c.timelineStartInfo.pts===void 0&&(c.timelineStartInfo.pts=f.pts),c.minSegmentPts===void 0?c.minSegmentPts=f.pts:c.minSegmentPts=Math.min(c.minSegmentPts,f.pts),c.maxSegmentPts===void 0?c.maxSegmentPts=f.pts:c.maxSegmentPts=Math.max(c.maxSegmentPts,f.pts)),typeof f.dts=="number"&&(c.timelineStartInfo.dts===void 0&&(c.timelineStartInfo.dts=f.dts),c.minSegmentDts===void 0?c.minSegmentDts=f.dts:c.minSegmentDts=Math.min(c.minSegmentDts,f.dts),c.maxSegmentDts===void 0?c.maxSegmentDts=f.dts:c.maxSegmentDts=Math.max(c.maxSegmentDts,f.dts))},XT=function(c){delete c.minSegmentDts,delete c.maxSegmentDts,delete c.minSegmentPts,delete c.maxSegmentPts},QT=function(c,f){var y,g,E=c.minSegmentDts;return f||(E-=c.timelineStartInfo.dts),y=c.timelineStartInfo.baseMediaDecodeTime,y+=E,y=Math.max(0,y),c.type==="audio"&&(g=c.samplerate/zT,y*=g,y=Math.floor(y)),y},ZT={clearDtsInfo:XT,calculateTrackBaseMediaDecodeTime:QT,collectDtsInfo:YT},ag=4,JT=128,eS=function(c){for(var f=0,y={payloadType:-1,payloadSize:0},g=0,E=0;f<c.byteLength&&c[f]!==JT;){for(;c[f]===255;)g+=255,f++;for(g+=c[f++];c[f]===255;)E+=255,f++;if(E+=c[f++],!y.payload&&g===ag){var D=String.fromCharCode(c[f+3],c[f+4],c[f+5],c[f+6]);if(D==="GA94"){y.payloadType=g,y.payloadSize=E,y.payload=c.subarray(f,f+E);break}else y.payload=void 0}f+=E,g=0,E=0}return y},tS=function(c){return c.payload[0]!==181||(c.payload[1]<<8|c.payload[2])!=49||String.fromCharCode(c.payload[3],c.payload[4],c.payload[5],c.payload[6])!=="GA94"||c.payload[7]!==3?null:c.payload.subarray(8,c.payload.length-1)},iS=function(c,f){var y=[],g,E,D,ee;if(!(f[0]&64))return y;for(E=f[0]&31,g=0;g<E;g++)D=g*3,ee={type:f[D+2]&3,pts:c},f[D+2]&4&&(ee.ccData=f[D+3]<<8|f[D+4],y.push(ee));return y},nS=function(c){for(var f=c.byteLength,y=[],g=1,E,D;g<f-2;)c[g]===0&&c[g+1]===0&&c[g+2]===3?(y.push(g+2),g+=2):g++;if(y.length===0)return c;E=f-y.length,D=new Uint8Array(E);var ee=0;for(g=0;g<E;ee++,g++)ee===y[0]&&(ee++,y.shift()),D[g]=c[ee];return D},og={parseSei:eS,parseUserData:tS,parseCaptionPackets:iS,discardEmulationPreventionBytes:nS,USER_DATA_REGISTERED_ITU_T_T35:ag},fh=t,eu=og,An=function(c){c=c||{},An.prototype.init.call(this),this.parse708captions_=typeof c.parse708captions=="boolean"?c.parse708captions:!0,this.captionPackets_=[],this.ccStreams_=[new Ai(0,0),new Ai(0,1),new Ai(1,0),new Ai(1,1)],this.parse708captions_&&(this.cc708Stream_=new li({captionServices:c.captionServices})),this.reset(),this.ccStreams_.forEach(function(f){f.on("data",this.trigger.bind(this,"data")),f.on("partialdone",this.trigger.bind(this,"partialdone")),f.on("done",this.trigger.bind(this,"done"))},this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))};An.prototype=new fh,An.prototype.push=function(c){var f,y,g;if(c.nalUnitType==="sei_rbsp"&&(f=eu.parseSei(c.escapedRBSP),!!f.payload&&f.payloadType===eu.USER_DATA_REGISTERED_ITU_T_T35&&(y=eu.parseUserData(f),!!y))){if(c.dts<this.latestDts_){this.ignoreNextEqualDts_=!0;return}else if(c.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--,this.numSameDts_||(this.ignoreNextEqualDts_=!1);return}g=eu.parseCaptionPackets(c.pts,y),this.captionPackets_=this.captionPackets_.concat(g),this.latestDts_!==c.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=c.dts}},An.prototype.flushCCStreams=function(c){this.ccStreams_.forEach(function(f){return c==="flush"?f.flush():f.partialFlush()},this)},An.prototype.flushStream=function(c){if(!this.captionPackets_.length){this.flushCCStreams(c);return}this.captionPackets_.forEach(function(f,y){f.presortIndex=y}),this.captionPackets_.sort(function(f,y){return f.pts===y.pts?f.presortIndex-y.presortIndex:f.pts-y.pts}),this.captionPackets_.forEach(function(f){f.type<2?this.dispatchCea608Packet(f):this.dispatchCea708Packet(f)},this),this.captionPackets_.length=0,this.flushCCStreams(c)},An.prototype.flush=function(){return this.flushStream("flush")},An.prototype.partialFlush=function(){return this.flushStream("partialFlush")},An.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(c){c.reset()})},An.prototype.dispatchCea608Packet=function(c){this.setsTextOrXDSActive(c)?this.activeCea608Channel_[c.type]=null:this.setsChannel1Active(c)?this.activeCea608Channel_[c.type]=0:this.setsChannel2Active(c)&&(this.activeCea608Channel_[c.type]=1),this.activeCea608Channel_[c.type]!==null&&this.ccStreams_[(c.type<<1)+this.activeCea608Channel_[c.type]].push(c)},An.prototype.setsChannel1Active=function(c){return(c.ccData&30720)==4096},An.prototype.setsChannel2Active=function(c){return(c.ccData&30720)==6144},An.prototype.setsTextOrXDSActive=function(c){return(c.ccData&28928)==256||(c.ccData&30974)==4138||(c.ccData&30974)==6186},An.prototype.dispatchCea708Packet=function(c){this.parse708captions_&&this.cc708Stream_.push(c)};var rS={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},sS=function(c){var f=rS[c]||c;return c&4096&&c===f?"":String.fromCharCode(f)},tu=function(c){return 32<=c&&c<=127||160<=c&&c<=255},Vr=function(c){this.windowNum=c,this.reset()};Vr.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},Vr.prototype.getText=function(){return this.rows.join(`
`)},Vr.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},Vr.prototype.newLine=function(c){for(this.rows.length>=this.virtualRowCount&&typeof this.beforeRowOverflow=="function"&&this.beforeRowOverflow(c),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},Vr.prototype.isEmpty=function(){return this.rows.length===0?!0:this.rows.length===1?this.rows[0]==="":!1},Vr.prototype.addText=function(c){this.rows[this.rowIdx]+=c},Vr.prototype.backspace=function(){if(!this.isEmpty()){var c=this.rows[this.rowIdx];this.rows[this.rowIdx]=c.substr(0,c.length-1)}};var iu=function(c,f,y){this.serviceNum=c,this.text="",this.currentWindow=new Vr(-1),this.windows=[],this.stream=y,typeof f=="string"&&this.createTextDecoder(f)};iu.prototype.init=function(c,f){this.startPts=c;for(var y=0;y<8;y++)this.windows[y]=new Vr(y),typeof f=="function"&&(this.windows[y].beforeRowOverflow=f)},iu.prototype.setCurrentWindow=function(c){this.currentWindow=this.windows[c]},iu.prototype.createTextDecoder=function(c){if(typeof TextDecoder=="undefined")this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(c)}catch(f){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+c+" encoding. "+f})}};var li=function(c){c=c||{},li.prototype.init.call(this);var f=this,y=c.captionServices||{},g={},E;Object.keys(y).forEach(D=>{E=y[D],/^SERVICE/.test(D)&&(g[D]=E.encoding)}),this.serviceEncodings=g,this.current708Packet=null,this.services={},this.push=function(D){D.type===3?(f.new708Packet(),f.add708Bytes(D)):(f.current708Packet===null&&f.new708Packet(),f.add708Bytes(D))}};li.prototype=new fh,li.prototype.new708Packet=function(){this.current708Packet!==null&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},li.prototype.add708Bytes=function(c){var f=c.ccData,y=f>>>8,g=f&255;this.current708Packet.ptsVals.push(c.pts),this.current708Packet.data.push(y),this.current708Packet.data.push(g)},li.prototype.push708Packet=function(){var c=this.current708Packet,f=c.data,y=null,g=null,E=0,D=f[E++];for(c.seq=D>>6,c.sizeCode=D&63;E<f.length;E++)D=f[E++],y=D>>5,g=D&31,y===7&&g>0&&(D=f[E++],y=D),this.pushServiceBlock(y,E,g),g>0&&(E+=g-1)},li.prototype.pushServiceBlock=function(c,f,y){var g,E=f,D=this.current708Packet.data,ee=this.services[c];for(ee||(ee=this.initService(c,E));E<f+y&&E<D.length;E++)g=D[E],tu(g)?E=this.handleText(E,ee):g===24?E=this.multiByteCharacter(E,ee):g===16?E=this.extendedCommands(E,ee):128<=g&&g<=135?E=this.setCurrentWindow(E,ee):152<=g&&g<=159?E=this.defineWindow(E,ee):g===136?E=this.clearWindows(E,ee):g===140?E=this.deleteWindows(E,ee):g===137?E=this.displayWindows(E,ee):g===138?E=this.hideWindows(E,ee):g===139?E=this.toggleWindows(E,ee):g===151?E=this.setWindowAttributes(E,ee):g===144?E=this.setPenAttributes(E,ee):g===145?E=this.setPenColor(E,ee):g===146?E=this.setPenLocation(E,ee):g===143?ee=this.reset(E,ee):g===8?ee.currentWindow.backspace():g===12?ee.currentWindow.clearText():g===13?ee.currentWindow.pendingNewLine=!0:g===14?ee.currentWindow.clearText():g===141&&E++},li.prototype.extendedCommands=function(c,f){var y=this.current708Packet.data,g=y[++c];return tu(g)&&(c=this.handleText(c,f,{isExtended:!0})),c},li.prototype.getPts=function(c){return this.current708Packet.ptsVals[Math.floor(c/2)]},li.prototype.initService=function(c,f){var y="SERVICE"+c,g=this,y,E;return y in this.serviceEncodings&&(E=this.serviceEncodings[y]),this.services[c]=new iu(c,E,g),this.services[c].init(this.getPts(f),function(D){g.flushDisplayed(D,g.services[c])}),this.services[c]},li.prototype.handleText=function(c,f,y){var g=y&&y.isExtended,E=y&&y.isMultiByte,D=this.current708Packet.data,ee=g?4096:0,ae=D[c],de=D[c+1],me=f.currentWindow,Se,Pe;return f.textDecoder_&&!g?(E?(Pe=[ae,de],c++):Pe=[ae],Se=f.textDecoder_.decode(new Uint8Array(Pe))):Se=sS(ee|ae),me.pendingNewLine&&!me.isEmpty()&&me.newLine(this.getPts(c)),me.pendingNewLine=!1,me.addText(Se),c},li.prototype.multiByteCharacter=function(c,f){var y=this.current708Packet.data,g=y[c+1],E=y[c+2];return tu(g)&&tu(E)&&(c=this.handleText(++c,f,{isMultiByte:!0})),c},li.prototype.setCurrentWindow=function(c,f){var y=this.current708Packet.data,g=y[c],E=g&7;return f.setCurrentWindow(E),c},li.prototype.defineWindow=function(c,f){var y=this.current708Packet.data,g=y[c],E=g&7;f.setCurrentWindow(E);var D=f.currentWindow;return g=y[++c],D.visible=(g&32)>>5,D.rowLock=(g&16)>>4,D.columnLock=(g&8)>>3,D.priority=g&7,g=y[++c],D.relativePositioning=(g&128)>>7,D.anchorVertical=g&127,g=y[++c],D.anchorHorizontal=g,g=y[++c],D.anchorPoint=(g&240)>>4,D.rowCount=g&15,g=y[++c],D.columnCount=g&63,g=y[++c],D.windowStyle=(g&56)>>3,D.penStyle=g&7,D.virtualRowCount=D.rowCount+1,c},li.prototype.setWindowAttributes=function(c,f){var y=this.current708Packet.data,g=y[c],E=f.currentWindow.winAttr;return g=y[++c],E.fillOpacity=(g&192)>>6,E.fillRed=(g&48)>>4,E.fillGreen=(g&12)>>2,E.fillBlue=g&3,g=y[++c],E.borderType=(g&192)>>6,E.borderRed=(g&48)>>4,E.borderGreen=(g&12)>>2,E.borderBlue=g&3,g=y[++c],E.borderType+=(g&128)>>5,E.wordWrap=(g&64)>>6,E.printDirection=(g&48)>>4,E.scrollDirection=(g&12)>>2,E.justify=g&3,g=y[++c],E.effectSpeed=(g&240)>>4,E.effectDirection=(g&12)>>2,E.displayEffect=g&3,c},li.prototype.flushDisplayed=function(c,f){for(var y=[],g=0;g<8;g++)f.windows[g].visible&&!f.windows[g].isEmpty()&&y.push(f.windows[g].getText());f.endPts=c,f.text=y.join(`

`),this.pushCaption(f),f.startPts=c},li.prototype.pushCaption=function(c){c.text!==""&&(this.trigger("data",{startPts:c.startPts,endPts:c.endPts,text:c.text,stream:"cc708_"+c.serviceNum}),c.text="",c.startPts=c.endPts)},li.prototype.displayWindows=function(c,f){var y=this.current708Packet.data,g=y[++c],E=this.getPts(c);this.flushDisplayed(E,f);for(var D=0;D<8;D++)g&1<<D&&(f.windows[D].visible=1);return c},li.prototype.hideWindows=function(c,f){var y=this.current708Packet.data,g=y[++c],E=this.getPts(c);this.flushDisplayed(E,f);for(var D=0;D<8;D++)g&1<<D&&(f.windows[D].visible=0);return c},li.prototype.toggleWindows=function(c,f){var y=this.current708Packet.data,g=y[++c],E=this.getPts(c);this.flushDisplayed(E,f);for(var D=0;D<8;D++)g&1<<D&&(f.windows[D].visible^=1);return c},li.prototype.clearWindows=function(c,f){var y=this.current708Packet.data,g=y[++c],E=this.getPts(c);this.flushDisplayed(E,f);for(var D=0;D<8;D++)g&1<<D&&f.windows[D].clearText();return c},li.prototype.deleteWindows=function(c,f){var y=this.current708Packet.data,g=y[++c],E=this.getPts(c);this.flushDisplayed(E,f);for(var D=0;D<8;D++)g&1<<D&&f.windows[D].reset();return c},li.prototype.setPenAttributes=function(c,f){var y=this.current708Packet.data,g=y[c],E=f.currentWindow.penAttr;return g=y[++c],E.textTag=(g&240)>>4,E.offset=(g&12)>>2,E.penSize=g&3,g=y[++c],E.italics=(g&128)>>7,E.underline=(g&64)>>6,E.edgeType=(g&56)>>3,E.fontStyle=g&7,c},li.prototype.setPenColor=function(c,f){var y=this.current708Packet.data,g=y[c],E=f.currentWindow.penColor;return g=y[++c],E.fgOpacity=(g&192)>>6,E.fgRed=(g&48)>>4,E.fgGreen=(g&12)>>2,E.fgBlue=g&3,g=y[++c],E.bgOpacity=(g&192)>>6,E.bgRed=(g&48)>>4,E.bgGreen=(g&12)>>2,E.bgBlue=g&3,g=y[++c],E.edgeRed=(g&48)>>4,E.edgeGreen=(g&12)>>2,E.edgeBlue=g&3,c},li.prototype.setPenLocation=function(c,f){var y=this.current708Packet.data,g=y[c],E=f.currentWindow.penLoc;return f.currentWindow.pendingNewLine=!0,g=y[++c],E.row=g&15,g=y[++c],E.column=g&63,c},li.prototype.reset=function(c,f){var y=this.getPts(c);return this.flushDisplayed(y,f),this.initService(f.serviceNum,c)};var aS={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},nu=function(c){return c===null?"":(c=aS[c]||c,String.fromCharCode(c))},ru=14,oS=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],Us=function(){for(var c=[],f=ru+1;f--;)c.push("");return c},Ai=function(c,f){Ai.prototype.init.call(this),this.field_=c||0,this.dataChannel_=f||0,this.name_="CC"+((this.field_<<1|this.dataChannel_)+1),this.setConstants(),this.reset(),this.push=function(y){var g,E,D,ee,ae;if(g=y.ccData&32639,g===this.lastControlCode_){this.lastControlCode_=null;return}if((g&61440)==4096?this.lastControlCode_=g:g!==this.PADDING_&&(this.lastControlCode_=null),D=g>>>8,ee=g&255,g!==this.PADDING_)if(g===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(g===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(y.pts),this.flushDisplayed(y.pts),E=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=E,this.startPts_=y.pts;else if(g===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(y.pts);else if(g===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(y.pts);else if(g===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(y.pts);else if(g===this.CARRIAGE_RETURN_)this.clearFormatting(y.pts),this.flushDisplayed(y.pts),this.shiftRowsUp_(),this.startPts_=y.pts;else if(g===this.BACKSPACE_)this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(g===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(y.pts),this.displayed_=Us();else if(g===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=Us();else if(g===this.RESUME_DIRECT_CAPTIONING_)this.mode_!=="paintOn"&&(this.flushDisplayed(y.pts),this.displayed_=Us()),this.mode_="paintOn",this.startPts_=y.pts;else if(this.isSpecialCharacter(D,ee))D=(D&3)<<8,ae=nu(D|ee),this[this.mode_](y.pts,ae),this.column_++;else if(this.isExtCharacter(D,ee))this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),D=(D&3)<<8,ae=nu(D|ee),this[this.mode_](y.pts,ae),this.column_++;else if(this.isMidRowCode(D,ee))this.clearFormatting(y.pts),this[this.mode_](y.pts," "),this.column_++,(ee&14)==14&&this.addFormatting(y.pts,["i"]),(ee&1)==1&&this.addFormatting(y.pts,["u"]);else if(this.isOffsetControlCode(D,ee))this.column_+=ee&3;else if(this.isPAC(D,ee)){var de=oS.indexOf(g&7968);this.mode_==="rollUp"&&(de-this.rollUpRows_+1<0&&(de=this.rollUpRows_-1),this.setRollUp(y.pts,de)),de!==this.row_&&(this.clearFormatting(y.pts),this.row_=de),ee&1&&this.formatting_.indexOf("u")===-1&&this.addFormatting(y.pts,["u"]),(g&16)==16&&(this.column_=((g&14)>>1)*4),this.isColorPAC(ee)&&(ee&14)==14&&this.addFormatting(y.pts,["i"])}else this.isNormalChar(D)&&(ee===0&&(ee=null),ae=nu(D),ae+=nu(ee),this[this.mode_](y.pts,ae),this.column_+=ae.length)}};Ai.prototype=new fh,Ai.prototype.flushDisplayed=function(c){var f=this.displayed_.map(function(y,g){try{return y.trim()}catch(E){return this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+g+"."}),""}},this).join(`
`).replace(/^\n+|\n+$/g,"");f.length&&this.trigger("data",{startPts:this.startPts_,endPts:c,text:f,stream:this.name_})},Ai.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=Us(),this.nonDisplayed_=Us(),this.lastControlCode_=null,this.column_=0,this.row_=ru,this.rollUpRows_=2,this.formatting_=[]},Ai.prototype.setConstants=function(){this.dataChannel_===0?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):this.dataChannel_===1&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=this.CONTROL_|32,this.END_OF_CAPTION_=this.CONTROL_|47,this.ROLL_UP_2_ROWS_=this.CONTROL_|37,this.ROLL_UP_3_ROWS_=this.CONTROL_|38,this.ROLL_UP_4_ROWS_=this.CONTROL_|39,this.CARRIAGE_RETURN_=this.CONTROL_|45,this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|41,this.BACKSPACE_=this.CONTROL_|33,this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44,this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46},Ai.prototype.isSpecialCharacter=function(c,f){return c===this.EXT_&&f>=48&&f<=63},Ai.prototype.isExtCharacter=function(c,f){return(c===this.EXT_+1||c===this.EXT_+2)&&f>=32&&f<=63},Ai.prototype.isMidRowCode=function(c,f){return c===this.EXT_&&f>=32&&f<=47},Ai.prototype.isOffsetControlCode=function(c,f){return c===this.OFFSET_&&f>=33&&f<=35},Ai.prototype.isPAC=function(c,f){return c>=this.BASE_&&c<this.BASE_+8&&f>=64&&f<=127},Ai.prototype.isColorPAC=function(c){return c>=64&&c<=79||c>=96&&c<=127},Ai.prototype.isNormalChar=function(c){return c>=32&&c<=127},Ai.prototype.setRollUp=function(c,f){if(this.mode_!=="rollUp"&&(this.row_=ru,this.mode_="rollUp",this.flushDisplayed(c),this.nonDisplayed_=Us(),this.displayed_=Us()),f!==void 0&&f!==this.row_)for(var y=0;y<this.rollUpRows_;y++)this.displayed_[f-y]=this.displayed_[this.row_-y],this.displayed_[this.row_-y]="";f===void 0&&(f=this.row_),this.topRow_=f-this.rollUpRows_+1},Ai.prototype.addFormatting=function(c,f){this.formatting_=this.formatting_.concat(f);var y=f.reduce(function(g,E){return g+"<"+E+">"},"");this[this.mode_](c,y)},Ai.prototype.clearFormatting=function(c){if(!!this.formatting_.length){var f=this.formatting_.reverse().reduce(function(y,g){return y+"</"+g+">"},"");this.formatting_=[],this[this.mode_](c,f)}},Ai.prototype.popOn=function(c,f){var y=this.nonDisplayed_[this.row_];y+=f,this.nonDisplayed_[this.row_]=y},Ai.prototype.rollUp=function(c,f){var y=this.displayed_[this.row_];y+=f,this.displayed_[this.row_]=y},Ai.prototype.shiftRowsUp_=function(){var c;for(c=0;c<this.topRow_;c++)this.displayed_[c]="";for(c=this.row_+1;c<ru+1;c++)this.displayed_[c]="";for(c=this.topRow_;c<this.row_;c++)this.displayed_[c]=this.displayed_[c+1];this.displayed_[this.row_]=""},Ai.prototype.paintOn=function(c,f){var y=this.displayed_[this.row_];y+=f,this.displayed_[this.row_]=y};var lg={CaptionStream:An,Cea608Stream:Ai,Cea708Stream:li},su={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},lS=t,uS=8589934592,dS=4294967296,ug="shared",ph=function(c,f){var y=1;for(c>f&&(y=-1);Math.abs(f-c)>dS;)c+=y*uS;return c},mh=function(c){var f,y;mh.prototype.init.call(this),this.type_=c||ug,this.push=function(g){this.type_!==ug&&g.type!==this.type_||(y===void 0&&(y=g.dts),g.dts=ph(g.dts,y),g.pts=ph(g.pts,y),f=g.dts,this.trigger("data",g))},this.flush=function(){y=f,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){y=void 0,f=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};mh.prototype=new lS;var dg={TimestampRolloverStream:mh,handleRollover:ph},cS=(c,f,y)=>{if(!c)return-1;for(var g=y;g<c.length;g++)if(c[g]===f)return g;return-1},hS={typedArrayIndexOf:cS},au=hS.typedArrayIndexOf,ou={Iso88591:0,Utf16:1,Utf16be:2,Utf8:3},cg=function(c,f,y){var g,E="";for(g=f;g<y;g++)E+="%"+("00"+c[g].toString(16)).slice(-2);return E},Ao=function(c,f,y){return decodeURIComponent(cg(c,f,y))},bo=function(c,f,y){return unescape(cg(c,f,y))},_o=function(c){return c[0]<<21|c[1]<<14|c[2]<<7|c[3]},xo={APIC:function(c){var f=1,y,g,E="-->";c.data[0]===ou.Utf8&&(y=au(c.data,0,f),!(y<0)&&(c.mimeType=bo(c.data,f,y),f=y+1,c.pictureType=c.data[f],f++,g=au(c.data,0,f),!(g<0)&&(c.description=Ao(c.data,f,g),f=g+1,c.mimeType===E?c.url=bo(c.data,f,c.data.length):c.pictureData=c.data.subarray(f,c.data.length))))},"T*":function(c){c.data[0]===ou.Utf8&&(c.value=Ao(c.data,1,c.data.length).replace(/\0*$/,""),c.values=c.value.split("\0"))},TXXX:function(c){var f;c.data[0]===ou.Utf8&&(f=au(c.data,0,1),f!==-1&&(c.description=Ao(c.data,1,f),c.value=Ao(c.data,f+1,c.data.length).replace(/\0*$/,""),c.data=c.value))},"W*":function(c){c.url=bo(c.data,0,c.data.length).replace(/\0.*$/,"")},WXXX:function(c){var f;c.data[0]===ou.Utf8&&(f=au(c.data,0,1),f!==-1&&(c.description=Ao(c.data,1,f),c.url=bo(c.data,f+1,c.data.length).replace(/\0.*$/,"")))},PRIV:function(c){var f;for(f=0;f<c.data.length;f++)if(c.data[f]===0){c.owner=bo(c.data,0,f);break}c.privateData=c.data.subarray(f+1),c.data=c.privateData}},fS=function(c){var f,y,g=10,E=0,D=[];if(!(c.length<10||c[0]!=="I".charCodeAt(0)||c[1]!=="D".charCodeAt(0)||c[2]!=="3".charCodeAt(0))){E=_o(c.subarray(6,10)),E+=10;var ee=c[5]&64;ee&&(g+=4,g+=_o(c.subarray(10,14)),E-=_o(c.subarray(16,20)));do{if(f=_o(c.subarray(g+4,g+8)),f<1)break;y=String.fromCharCode(c[g],c[g+1],c[g+2],c[g+3]);var ae={id:y,data:c.subarray(g+10,g+f+10)};ae.key=ae.id,xo[ae.id]?xo[ae.id](ae):ae.id[0]==="T"?xo["T*"](ae):ae.id[0]==="W"&&xo["W*"](ae),D.push(ae),g+=10,g+=f}while(g<E);return D}},hg={parseId3Frames:fS,parseSyncSafeInteger:_o,frameParsers:xo},pS=t,mS=su,gs=hg,lu;lu=function(c){var f={descriptor:c&&c.descriptor},y=0,g=[],E=0,D;if(lu.prototype.init.call(this),this.dispatchType=mS.METADATA_STREAM_TYPE.toString(16),f.descriptor)for(D=0;D<f.descriptor.length;D++)this.dispatchType+=("00"+f.descriptor[D].toString(16)).slice(-2);this.push=function(ee){var ae,de,me,Se,Pe,dt;if(ee.type==="timed-metadata"){if(ee.dataAlignmentIndicator&&(E=0,g.length=0),g.length===0&&(ee.data.length<10||ee.data[0]!=="I".charCodeAt(0)||ee.data[1]!=="D".charCodeAt(0)||ee.data[2]!=="3".charCodeAt(0))){this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});return}if(g.push(ee),E+=ee.data.byteLength,g.length===1&&(y=gs.parseSyncSafeInteger(ee.data.subarray(6,10)),y+=10),!(E<y)){for(ae={data:new Uint8Array(y),frames:[],pts:g[0].pts,dts:g[0].dts},Pe=0;Pe<y;)ae.data.set(g[0].data.subarray(0,y-Pe),Pe),Pe+=g[0].data.byteLength,E-=g[0].data.byteLength,g.shift();de=10,ae.data[5]&64&&(de+=4,de+=gs.parseSyncSafeInteger(ae.data.subarray(10,14)),y-=gs.parseSyncSafeInteger(ae.data.subarray(16,20)));do{if(me=gs.parseSyncSafeInteger(ae.data.subarray(de+4,de+8)),me<1){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping remaining metadata parsing."});break}if(dt=String.fromCharCode(ae.data[de],ae.data[de+1],ae.data[de+2],ae.data[de+3]),Se={id:dt,data:ae.data.subarray(de+10,de+me+10)},Se.key=Se.id,gs.frameParsers[Se.id]?gs.frameParsers[Se.id](Se):Se.id[0]==="T"?gs.frameParsers["T*"](Se):Se.id[0]==="W"&&gs.frameParsers["W*"](Se),Se.owner==="com.apple.streaming.transportStreamTimestamp"){var He=Se.data,wt=(He[3]&1)<<30|He[4]<<22|He[5]<<14|He[6]<<6|He[7]>>>2;wt*=4,wt+=He[7]&3,Se.timeStamp=wt,ae.pts===void 0&&ae.dts===void 0&&(ae.pts=Se.timeStamp,ae.dts=Se.timeStamp),this.trigger("timestamp",Se)}ae.frames.push(Se),de+=10,de+=me}while(de<y);this.trigger("data",ae)}}}},lu.prototype=new pS;var gS=lu,gh=t,yh=lg,ar=su,yS=dg.TimestampRolloverStream,uu,Eo,du,ka=188,vh=71;uu=function(){var c=new Uint8Array(ka),f=0;uu.prototype.init.call(this),this.push=function(y){var g=0,E=ka,D;for(f?(D=new Uint8Array(y.byteLength+f),D.set(c.subarray(0,f)),D.set(y,f),f=0):D=y;E<D.byteLength;){if(D[g]===vh&&D[E]===vh){this.trigger("data",D.subarray(g,E)),g+=ka,E+=ka;continue}g++,E++}g<D.byteLength&&(c.set(D.subarray(g),0),f=D.byteLength-g)},this.flush=function(){f===ka&&c[0]===vh&&(this.trigger("data",c),f=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){f=0,this.trigger("reset")}},uu.prototype=new gh,Eo=function(){var c,f,y,g;Eo.prototype.init.call(this),g=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,c=function(E,D){var ee=0;D.payloadUnitStartIndicator&&(ee+=E[ee]+1),D.type==="pat"?f(E.subarray(ee),D):y(E.subarray(ee),D)},f=function(E,D){D.section_number=E[7],D.last_section_number=E[8],g.pmtPid=(E[10]&31)<<8|E[11],D.pmtPid=g.pmtPid},y=function(E,D){var ee,ae,de,me;if(!!(E[5]&1)){for(g.programMapTable={video:null,audio:null,"timed-metadata":{}},ee=(E[1]&15)<<8|E[2],ae=3+ee-4,de=(E[10]&15)<<8|E[11],me=12+de;me<ae;){var Se=E[me],Pe=(E[me+1]&31)<<8|E[me+2];Se===ar.H264_STREAM_TYPE&&g.programMapTable.video===null?g.programMapTable.video=Pe:Se===ar.ADTS_STREAM_TYPE&&g.programMapTable.audio===null?g.programMapTable.audio=Pe:Se===ar.METADATA_STREAM_TYPE&&(g.programMapTable["timed-metadata"][Pe]=Se),me+=((E[me+3]&15)<<8|E[me+4])+5}D.programMapTable=g.programMapTable}},this.push=function(E){var D={},ee=4;if(D.payloadUnitStartIndicator=!!(E[1]&64),D.pid=E[1]&31,D.pid<<=8,D.pid|=E[2],(E[3]&48)>>>4>1&&(ee+=E[ee]+1),D.pid===0)D.type="pat",c(E.subarray(ee),D),this.trigger("data",D);else if(D.pid===this.pmtPid)for(D.type="pmt",c(E.subarray(ee),D),this.trigger("data",D);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else this.programMapTable===void 0?this.packetsWaitingForPmt.push([E,ee,D]):this.processPes_(E,ee,D)},this.processPes_=function(E,D,ee){ee.pid===this.programMapTable.video?ee.streamType=ar.H264_STREAM_TYPE:ee.pid===this.programMapTable.audio?ee.streamType=ar.ADTS_STREAM_TYPE:ee.streamType=this.programMapTable["timed-metadata"][ee.pid],ee.type="pes",ee.data=E.subarray(D),this.trigger("data",ee)}},Eo.prototype=new gh,Eo.STREAM_TYPES={h264:27,adts:15},du=function(){var c=this,f=!1,y={data:[],size:0},g={data:[],size:0},E={data:[],size:0},D,ee=function(de,me){var Se;const Pe=de[0]<<16|de[1]<<8|de[2];me.data=new Uint8Array,Pe===1&&(me.packetLength=6+(de[4]<<8|de[5]),me.dataAlignmentIndicator=(de[6]&4)!=0,Se=de[7],Se&192&&(me.pts=(de[9]&14)<<27|(de[10]&255)<<20|(de[11]&254)<<12|(de[12]&255)<<5|(de[13]&254)>>>3,me.pts*=4,me.pts+=(de[13]&6)>>>1,me.dts=me.pts,Se&64&&(me.dts=(de[14]&14)<<27|(de[15]&255)<<20|(de[16]&254)<<12|(de[17]&255)<<5|(de[18]&254)>>>3,me.dts*=4,me.dts+=(de[18]&6)>>>1)),me.data=de.subarray(9+de[8]))},ae=function(de,me,Se){var Pe=new Uint8Array(de.size),dt={type:me},He=0,wt=0,kt=!1,Fi;if(!(!de.data.length||de.size<9)){for(dt.trackId=de.data[0].pid,He=0;He<de.data.length;He++)Fi=de.data[He],Pe.set(Fi.data,wt),wt+=Fi.data.byteLength;ee(Pe,dt),kt=me==="video"||dt.packetLength<=de.size,(Se||kt)&&(de.size=0,de.data.length=0),kt&&c.trigger("data",dt)}};du.prototype.init.call(this),this.push=function(de){({pat:function(){},pes:function(){var me,Se;switch(de.streamType){case ar.H264_STREAM_TYPE:me=y,Se="video";break;case ar.ADTS_STREAM_TYPE:me=g,Se="audio";break;case ar.METADATA_STREAM_TYPE:me=E,Se="timed-metadata";break;default:return}de.payloadUnitStartIndicator&&ae(me,Se,!0),me.data.push(de),me.size+=de.data.byteLength},pmt:function(){var me={type:"metadata",tracks:[]};D=de.programMapTable,D.video!==null&&me.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+D.video,codec:"avc",type:"video"}),D.audio!==null&&me.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+D.audio,codec:"adts",type:"audio"}),f=!0,c.trigger("data",me)}})[de.type]()},this.reset=function(){y.size=0,y.data.length=0,g.size=0,g.data.length=0,this.trigger("reset")},this.flushStreams_=function(){ae(y,"video"),ae(g,"audio"),ae(E,"timed-metadata")},this.flush=function(){if(!f&&D){var de={type:"metadata",tracks:[]};D.video!==null&&de.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+D.video,codec:"avc",type:"video"}),D.audio!==null&&de.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+D.audio,codec:"adts",type:"audio"}),c.trigger("data",de)}f=!1,this.flushStreams_(),this.trigger("done")}},du.prototype=new gh;var fg={PAT_PID:0,MP2T_PACKET_LENGTH:ka,TransportPacketStream:uu,TransportParseStream:Eo,ElementaryStream:du,TimestampRolloverStream:yS,CaptionStream:yh.CaptionStream,Cea608Stream:yh.Cea608Stream,Cea708Stream:yh.Cea708Stream,MetadataStream:gS};for(var Ah in ar)ar.hasOwnProperty(Ah)&&(fg[Ah]=ar[Ah]);var vS=fg,AS=t,bS=mi.ONE_SECOND_IN_TS,cu,pg=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];cu=function(c){var f,y=0;cu.prototype.init.call(this),this.skipWarn_=function(g,E){this.trigger("log",{level:"warn",message:`adts skiping bytes ${g} to ${E} in frame ${y} outside syncword`})},this.push=function(g){var E=0,D,ee,ae,de,me;if(c||(y=0),g.type==="audio"){f&&f.length?(ae=f,f=new Uint8Array(ae.byteLength+g.data.byteLength),f.set(ae),f.set(g.data,ae.byteLength)):f=g.data;for(var Se;E+7<f.length;){if(f[E]!==255||(f[E+1]&246)!=240){typeof Se!="number"&&(Se=E),E++;continue}if(typeof Se=="number"&&(this.skipWarn_(Se,E),Se=null),ee=(~f[E+1]&1)*2,D=(f[E+3]&3)<<11|f[E+4]<<3|(f[E+5]&224)>>5,de=((f[E+6]&3)+1)*1024,me=de*bS/pg[(f[E+2]&60)>>>2],f.byteLength-E<D)break;this.trigger("data",{pts:g.pts+y*me,dts:g.dts+y*me,sampleCount:de,audioobjecttype:(f[E+2]>>>6&3)+1,channelcount:(f[E+2]&1)<<2|(f[E+3]&192)>>>6,samplerate:pg[(f[E+2]&60)>>>2],samplingfrequencyindex:(f[E+2]&60)>>>2,samplesize:16,data:f.subarray(E+7+ee,E+D)}),y++,E+=D}typeof Se=="number"&&(this.skipWarn_(Se,E),Se=null),f=f.subarray(E)}},this.flush=function(){y=0,this.trigger("done")},this.reset=function(){f=void 0,this.trigger("reset")},this.endTimeline=function(){f=void 0,this.trigger("endedtimeline")}},cu.prototype=new AS;var _S=cu,mg;mg=function(c){var f=c.byteLength,y=0,g=0;this.length=function(){return 8*f},this.bitsAvailable=function(){return 8*f+g},this.loadWord=function(){var E=c.byteLength-f,D=new Uint8Array(4),ee=Math.min(4,f);if(ee===0)throw new Error("no bytes available");D.set(c.subarray(E,E+ee)),y=new DataView(D.buffer).getUint32(0),g=ee*8,f-=ee},this.skipBits=function(E){var D;g>E?(y<<=E,g-=E):(E-=g,D=Math.floor(E/8),E-=D*8,f-=D,this.loadWord(),y<<=E,g-=E)},this.readBits=function(E){var D=Math.min(g,E),ee=y>>>32-D;return g-=D,g>0?y<<=D:f>0&&this.loadWord(),D=E-D,D>0?ee<<D|this.readBits(D):ee},this.skipLeadingZeros=function(){var E;for(E=0;E<g;++E)if((y&2147483648>>>E)!=0)return y<<=E,g-=E,E;return this.loadWord(),E+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var E=this.skipLeadingZeros();return this.readBits(E+1)-1},this.readExpGolomb=function(){var E=this.readUnsignedExpGolomb();return 1&E?1+E>>>1:-1*(E>>>1)},this.readBoolean=function(){return this.readBits(1)===1},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};var xS=mg,gg=t,ES=xS,hu,To,yg;To=function(){var c=0,f,y;To.prototype.init.call(this),this.push=function(g){var E;y?(E=new Uint8Array(y.byteLength+g.data.byteLength),E.set(y),E.set(g.data,y.byteLength),y=E):y=g.data;for(var D=y.byteLength;c<D-3;c++)if(y[c+2]===1){f=c+5;break}for(;f<D;)switch(y[f]){case 0:if(y[f-1]!==0){f+=2;break}else if(y[f-2]!==0){f++;break}c+3!==f-2&&this.trigger("data",y.subarray(c+3,f-2));do f++;while(y[f]!==1&&f<D);c=f-2,f+=3;break;case 1:if(y[f-1]!==0||y[f-2]!==0){f+=3;break}this.trigger("data",y.subarray(c+3,f-2)),c=f-2,f+=3;break;default:f+=3;break}y=y.subarray(c),f-=c,c=0},this.reset=function(){y=null,c=0,this.trigger("reset")},this.flush=function(){y&&y.byteLength>3&&this.trigger("data",y.subarray(c+3)),y=null,c=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}},To.prototype=new gg,yg={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},hu=function(){var c=new To,f,y,g,E,D,ee,ae;hu.prototype.init.call(this),f=this,this.push=function(de){de.type==="video"&&(y=de.trackId,g=de.pts,E=de.dts,c.push(de))},c.on("data",function(de){var me={trackId:y,pts:g,dts:E,data:de,nalUnitTypeCode:de[0]&31};switch(me.nalUnitTypeCode){case 5:me.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:me.nalUnitType="sei_rbsp",me.escapedRBSP=D(de.subarray(1));break;case 7:me.nalUnitType="seq_parameter_set_rbsp",me.escapedRBSP=D(de.subarray(1)),me.config=ee(me.escapedRBSP);break;case 8:me.nalUnitType="pic_parameter_set_rbsp";break;case 9:me.nalUnitType="access_unit_delimiter_rbsp";break}f.trigger("data",me)}),c.on("done",function(){f.trigger("done")}),c.on("partialdone",function(){f.trigger("partialdone")}),c.on("reset",function(){f.trigger("reset")}),c.on("endedtimeline",function(){f.trigger("endedtimeline")}),this.flush=function(){c.flush()},this.partialFlush=function(){c.partialFlush()},this.reset=function(){c.reset()},this.endTimeline=function(){c.endTimeline()},ae=function(de,me){var Se=8,Pe=8,dt,He;for(dt=0;dt<de;dt++)Pe!==0&&(He=me.readExpGolomb(),Pe=(Se+He+256)%256),Se=Pe===0?Se:Pe},D=function(de){for(var me=de.byteLength,Se=[],Pe=1,dt,He;Pe<me-2;)de[Pe]===0&&de[Pe+1]===0&&de[Pe+2]===3?(Se.push(Pe+2),Pe+=2):Pe++;if(Se.length===0)return de;dt=me-Se.length,He=new Uint8Array(dt);var wt=0;for(Pe=0;Pe<dt;wt++,Pe++)wt===Se[0]&&(wt++,Se.shift()),He[Pe]=de[wt];return He},ee=function(de){var me=0,Se=0,Pe=0,dt=0,He,wt,kt,Fi,Yn,Gs,Kg,qg,zg,Dh,Yg,Di=[1,1],Xg,Vs;if(He=new ES(de),wt=He.readUnsignedByte(),Fi=He.readUnsignedByte(),kt=He.readUnsignedByte(),He.skipUnsignedExpGolomb(),yg[wt]&&(Yn=He.readUnsignedExpGolomb(),Yn===3&&He.skipBits(1),He.skipUnsignedExpGolomb(),He.skipUnsignedExpGolomb(),He.skipBits(1),He.readBoolean()))for(Yg=Yn!==3?8:12,Vs=0;Vs<Yg;Vs++)He.readBoolean()&&(Vs<6?ae(16,He):ae(64,He));if(He.skipUnsignedExpGolomb(),Gs=He.readUnsignedExpGolomb(),Gs===0)He.readUnsignedExpGolomb();else if(Gs===1)for(He.skipBits(1),He.skipExpGolomb(),He.skipExpGolomb(),Kg=He.readUnsignedExpGolomb(),Vs=0;Vs<Kg;Vs++)He.skipExpGolomb();if(He.skipUnsignedExpGolomb(),He.skipBits(1),qg=He.readUnsignedExpGolomb(),zg=He.readUnsignedExpGolomb(),Dh=He.readBits(1),Dh===0&&He.skipBits(1),He.skipBits(1),He.readBoolean()&&(me=He.readUnsignedExpGolomb(),Se=He.readUnsignedExpGolomb(),Pe=He.readUnsignedExpGolomb(),dt=He.readUnsignedExpGolomb()),He.readBoolean()&&He.readBoolean()){switch(Xg=He.readUnsignedByte(),Xg){case 1:Di=[1,1];break;case 2:Di=[12,11];break;case 3:Di=[10,11];break;case 4:Di=[16,11];break;case 5:Di=[40,33];break;case 6:Di=[24,11];break;case 7:Di=[20,11];break;case 8:Di=[32,11];break;case 9:Di=[80,33];break;case 10:Di=[18,11];break;case 11:Di=[15,11];break;case 12:Di=[64,33];break;case 13:Di=[160,99];break;case 14:Di=[4,3];break;case 15:Di=[3,2];break;case 16:Di=[2,1];break;case 255:{Di=[He.readUnsignedByte()<<8|He.readUnsignedByte(),He.readUnsignedByte()<<8|He.readUnsignedByte()];break}}Di&&Di[0]/Di[1]}return{profileIdc:wt,levelIdc:kt,profileCompatibility:Fi,width:(qg+1)*16-me*2-Se*2,height:(2-Dh)*(zg+1)*16-Pe*2-dt*2,sarRatio:Di}}},hu.prototype=new gg;var TS={H264Stream:hu,NalByteStream:To},SS=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],vg=function(c,f){var y=c[f+6]<<21|c[f+7]<<14|c[f+8]<<7|c[f+9],g=c[f+5],E=(g&16)>>4;return y=y>=0?y:0,E?y+20:y+10},Ag=function(c,f){return c.length-f<10||c[f]!=="I".charCodeAt(0)||c[f+1]!=="D".charCodeAt(0)||c[f+2]!=="3".charCodeAt(0)?f:(f+=vg(c,f),Ag(c,f))},CS=function(c){var f=Ag(c,0);return c.length>=f+2&&(c[f]&255)==255&&(c[f+1]&240)==240&&(c[f+1]&22)==16},bg=function(c){return c[0]<<21|c[1]<<14|c[2]<<7|c[3]},wS=function(c,f,y){var g,E="";for(g=f;g<y;g++)E+="%"+("00"+c[g].toString(16)).slice(-2);return E},LS=function(c,f,y){return unescape(wS(c,f,y))},DS=function(c,f){var y=(c[f+5]&224)>>5,g=c[f+4]<<3,E=c[f+3]&3<<11;return E|g|y},kS=function(c,f){return c[f]==="I".charCodeAt(0)&&c[f+1]==="D".charCodeAt(0)&&c[f+2]==="3".charCodeAt(0)?"timed-metadata":c[f]&!0&&(c[f+1]&240)==240?"audio":null},IS=function(c){for(var f=0;f+5<c.length;){if(c[f]!==255||(c[f+1]&246)!=240){f++;continue}return SS[(c[f+2]&60)>>>2]}return null},RS=function(c){var f,y,g,E;f=10,c[5]&64&&(f+=4,f+=bg(c.subarray(10,14)));do{if(y=bg(c.subarray(f+4,f+8)),y<1)return null;if(E=String.fromCharCode(c[f],c[f+1],c[f+2],c[f+3]),E==="PRIV"){g=c.subarray(f+10,f+y+10);for(var D=0;D<g.byteLength;D++)if(g[D]===0){var ee=LS(g,0,D);if(ee==="com.apple.streaming.transportStreamTimestamp"){var ae=g.subarray(D+1),de=(ae[3]&1)<<30|ae[4]<<22|ae[5]<<14|ae[6]<<6|ae[7]>>>2;return de*=4,de+=ae[7]&3,de}break}}f+=10,f+=y}while(f<c.byteLength);return null},bh={isLikelyAacData:CS,parseId3TagSize:vg,parseAdtsSize:DS,parseType:kS,parseSampleRate:IS,parseAacTimestamp:RS},OS=t,_g=bh,fu;fu=function(){var c=new Uint8Array,f=0;fu.prototype.init.call(this),this.setTimestamp=function(y){f=y},this.push=function(y){var g=0,E=0,D,ee,ae,de;for(c.length?(de=c.length,c=new Uint8Array(y.byteLength+de),c.set(c.subarray(0,de)),c.set(y,de)):c=y;c.length-E>=3;){if(c[E]==="I".charCodeAt(0)&&c[E+1]==="D".charCodeAt(0)&&c[E+2]==="3".charCodeAt(0)){if(c.length-E<10||(g=_g.parseId3TagSize(c,E),E+g>c.length))break;ee={type:"timed-metadata",data:c.subarray(E,E+g)},this.trigger("data",ee),E+=g;continue}else if((c[E]&255)==255&&(c[E+1]&240)==240){if(c.length-E<7||(g=_g.parseAdtsSize(c,E),E+g>c.length))break;ae={type:"audio",data:c.subarray(E,E+g),pts:f,dts:f},this.trigger("data",ae),E+=g;continue}E++}D=c.length-E,D>0?c=c.subarray(E):c=new Uint8Array},this.reset=function(){c=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){c=new Uint8Array,this.trigger("endedtimeline")}},fu.prototype=new OS;var PS=fu,BS=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],FS=BS,MS=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],NS=MS,pu=t,So=Gr,Co=NT,mu=qT,or=ZT,Hr=vS,gu=mi,xg=_S,US=TS.H264Stream,jS=PS,$S=bh.isLikelyAacData,GS=mi.ONE_SECOND_IN_TS,_h=FS,xh=NS,wo,Ia,yu,js,VS=function(c,f){f.stream=c,this.trigger("log",f)},Eg=function(c,f){for(var y=Object.keys(f),g=0;g<y.length;g++){var E=y[g];E==="headOfPipeline"||!f[E].on||f[E].on("log",VS.bind(c,E))}},Tg=function(c,f){var y;if(c.length!==f.length)return!1;for(y=0;y<c.length;y++)if(c[y]!==f[y])return!1;return!0},Eh=function(c,f,y,g,E,D){var ee=y-f,ae=g-f,de=E-y;return{start:{dts:c,pts:c+ee},end:{dts:c+ae,pts:c+de},prependedContentDuration:D,baseMediaDecodeTime:c}};Ia=function(c,f){var y=[],g,E=0,D=0,ee=Infinity;f=f||{},g=f.firstSequenceNumber||0,Ia.prototype.init.call(this),this.push=function(ae){or.collectDtsInfo(c,ae),c&&_h.forEach(function(de){c[de]=ae[de]}),y.push(ae)},this.setEarliestDts=function(ae){E=ae},this.setVideoBaseMediaDecodeTime=function(ae){ee=ae},this.setAudioAppendStart=function(ae){D=ae},this.flush=function(){var ae,de,me,Se,Pe,dt,He;if(y.length===0){this.trigger("done","AudioSegmentStream");return}ae=mu.trimAdtsFramesByEarliestDts(y,c,E),c.baseMediaDecodeTime=or.calculateTrackBaseMediaDecodeTime(c,f.keepOriginalTimestamps),He=mu.prefixWithSilence(c,ae,D,ee),c.samples=mu.generateSampleTable(ae),me=So.mdat(mu.concatenateFrameData(ae)),y=[],de=So.moof(g,[c]),Se=new Uint8Array(de.byteLength+me.byteLength),g++,Se.set(de),Se.set(me,de.byteLength),or.clearDtsInfo(c),Pe=Math.ceil(GS*1024/c.samplerate),ae.length&&(dt=ae.length*Pe,this.trigger("segmentTimingInfo",Eh(gu.audioTsToVideoTs(c.baseMediaDecodeTime,c.samplerate),ae[0].dts,ae[0].pts,ae[0].dts+dt,ae[0].pts+dt,He||0)),this.trigger("timingInfo",{start:ae[0].pts,end:ae[0].pts+dt})),this.trigger("data",{track:c,boxes:Se}),this.trigger("done","AudioSegmentStream")},this.reset=function(){or.clearDtsInfo(c),y=[],this.trigger("reset")}},Ia.prototype=new pu,wo=function(c,f){var y,g=[],E=[],D,ee;f=f||{},y=f.firstSequenceNumber||0,wo.prototype.init.call(this),delete c.minPTS,this.gopCache_=[],this.push=function(ae){or.collectDtsInfo(c,ae),ae.nalUnitType==="seq_parameter_set_rbsp"&&!D&&(D=ae.config,c.sps=[ae.data],xh.forEach(function(de){c[de]=D[de]},this)),ae.nalUnitType==="pic_parameter_set_rbsp"&&!ee&&(ee=ae.data,c.pps=[ae.data]),g.push(ae)},this.flush=function(){for(var ae,de,me,Se,Pe,dt,He=0,wt,kt;g.length&&g[0].nalUnitType!=="access_unit_delimiter_rbsp";)g.shift();if(g.length===0){this.resetStream_(),this.trigger("done","VideoSegmentStream");return}if(ae=Co.groupNalsIntoFrames(g),me=Co.groupFramesIntoGops(ae),me[0][0].keyFrame||(de=this.getGopForFusion_(g[0],c),de?(He=de.duration,me.unshift(de),me.byteLength+=de.byteLength,me.nalCount+=de.nalCount,me.pts=de.pts,me.dts=de.dts,me.duration+=de.duration):me=Co.extendFirstKeyFrame(me)),E.length){var Fi;if(f.alignGopsAtEnd?Fi=this.alignGopsAtEnd_(me):Fi=this.alignGopsAtStart_(me),!Fi){this.gopCache_.unshift({gop:me.pop(),pps:c.pps,sps:c.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),g=[],this.resetStream_(),this.trigger("done","VideoSegmentStream");return}or.clearDtsInfo(c),me=Fi}or.collectDtsInfo(c,me),c.samples=Co.generateSampleTable(me),Pe=So.mdat(Co.concatenateNalData(me)),c.baseMediaDecodeTime=or.calculateTrackBaseMediaDecodeTime(c,f.keepOriginalTimestamps),this.trigger("processedGopsInfo",me.map(function(Yn){return{pts:Yn.pts,dts:Yn.dts,byteLength:Yn.byteLength}})),wt=me[0],kt=me[me.length-1],this.trigger("segmentTimingInfo",Eh(c.baseMediaDecodeTime,wt.dts,wt.pts,kt.dts+kt.duration,kt.pts+kt.duration,He)),this.trigger("timingInfo",{start:me[0].pts,end:me[me.length-1].pts+me[me.length-1].duration}),this.gopCache_.unshift({gop:me.pop(),pps:c.pps,sps:c.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),g=[],this.trigger("baseMediaDecodeTime",c.baseMediaDecodeTime),this.trigger("timelineStartInfo",c.timelineStartInfo),Se=So.moof(y,[c]),dt=new Uint8Array(Se.byteLength+Pe.byteLength),y++,dt.set(Se),dt.set(Pe,Se.byteLength),this.trigger("data",{track:c,boxes:dt}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),g=[],this.gopCache_.length=0,E.length=0,this.trigger("reset")},this.resetStream_=function(){or.clearDtsInfo(c),D=void 0,ee=void 0},this.getGopForFusion_=function(ae){var de=45e3,me=1e4,Se=Infinity,Pe,dt,He,wt,kt;for(kt=0;kt<this.gopCache_.length;kt++)wt=this.gopCache_[kt],He=wt.gop,!(!(c.pps&&Tg(c.pps[0],wt.pps[0]))||!(c.sps&&Tg(c.sps[0],wt.sps[0])))&&(He.dts<c.timelineStartInfo.dts||(Pe=ae.dts-He.dts-He.duration,Pe>=-me&&Pe<=de&&(!dt||Se>Pe)&&(dt=wt,Se=Pe)));return dt?dt.gop:null},this.alignGopsAtStart_=function(ae){var de,me,Se,Pe,dt,He,wt,kt;for(dt=ae.byteLength,He=ae.nalCount,wt=ae.duration,de=me=0;de<E.length&&me<ae.length&&(Se=E[de],Pe=ae[me],Se.pts!==Pe.pts);){if(Pe.pts>Se.pts){de++;continue}me++,dt-=Pe.byteLength,He-=Pe.nalCount,wt-=Pe.duration}return me===0?ae:me===ae.length?null:(kt=ae.slice(me),kt.byteLength=dt,kt.duration=wt,kt.nalCount=He,kt.pts=kt[0].pts,kt.dts=kt[0].dts,kt)},this.alignGopsAtEnd_=function(ae){var de,me,Se,Pe,dt,He;for(de=E.length-1,me=ae.length-1,dt=null,He=!1;de>=0&&me>=0;){if(Se=E[de],Pe=ae[me],Se.pts===Pe.pts){He=!0;break}if(Se.pts>Pe.pts){de--;continue}de===E.length-1&&(dt=me),me--}if(!He&&dt===null)return null;var wt;if(He?wt=me:wt=dt,wt===0)return ae;var kt=ae.slice(wt),Fi=kt.reduce(function(Yn,Gs){return Yn.byteLength+=Gs.byteLength,Yn.duration+=Gs.duration,Yn.nalCount+=Gs.nalCount,Yn},{byteLength:0,duration:0,nalCount:0});return kt.byteLength=Fi.byteLength,kt.duration=Fi.duration,kt.nalCount=Fi.nalCount,kt.pts=kt[0].pts,kt.dts=kt[0].dts,kt},this.alignGopsWith=function(ae){E=ae}},wo.prototype=new pu,js=function(c,f){this.numberOfTracks=0,this.metadataStream=f,c=c||{},typeof c.remux!="undefined"?this.remuxTracks=!!c.remux:this.remuxTracks=!0,typeof c.keepOriginalTimestamps=="boolean"?this.keepOriginalTimestamps=c.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,js.prototype.init.call(this),this.push=function(y){if(y.text)return this.pendingCaptions.push(y);if(y.frames)return this.pendingMetadata.push(y);this.pendingTracks.push(y.track),this.pendingBytes+=y.boxes.byteLength,y.track.type==="video"&&(this.videoTrack=y.track,this.pendingBoxes.push(y.boxes)),y.track.type==="audio"&&(this.audioTrack=y.track,this.pendingBoxes.unshift(y.boxes))}},js.prototype=new pu,js.prototype.flush=function(c){var f=0,y={captions:[],captionStreams:{},metadata:[],info:{}},g,E,D,ee=0,ae;if(this.pendingTracks.length<this.numberOfTracks){if(c!=="VideoSegmentStream"&&c!=="AudioSegmentStream")return;if(this.remuxTracks)return;if(this.pendingTracks.length===0){this.emittedTracks++,this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0);return}}if(this.videoTrack?(ee=this.videoTrack.timelineStartInfo.pts,xh.forEach(function(de){y.info[de]=this.videoTrack[de]},this)):this.audioTrack&&(ee=this.audioTrack.timelineStartInfo.pts,_h.forEach(function(de){y.info[de]=this.audioTrack[de]},this)),this.videoTrack||this.audioTrack){for(this.pendingTracks.length===1?y.type=this.pendingTracks[0].type:y.type="combined",this.emittedTracks+=this.pendingTracks.length,D=So.initSegment(this.pendingTracks),y.initSegment=new Uint8Array(D.byteLength),y.initSegment.set(D),y.data=new Uint8Array(this.pendingBytes),ae=0;ae<this.pendingBoxes.length;ae++)y.data.set(this.pendingBoxes[ae],f),f+=this.pendingBoxes[ae].byteLength;for(ae=0;ae<this.pendingCaptions.length;ae++)g=this.pendingCaptions[ae],g.startTime=gu.metadataTsToSeconds(g.startPts,ee,this.keepOriginalTimestamps),g.endTime=gu.metadataTsToSeconds(g.endPts,ee,this.keepOriginalTimestamps),y.captionStreams[g.stream]=!0,y.captions.push(g);for(ae=0;ae<this.pendingMetadata.length;ae++)E=this.pendingMetadata[ae],E.cueTime=gu.metadataTsToSeconds(E.pts,ee,this.keepOriginalTimestamps),y.metadata.push(E);for(y.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",y),ae=0;ae<y.captions.length;ae++)g=y.captions[ae],this.trigger("caption",g);for(ae=0;ae<y.metadata.length;ae++)E=y.metadata[ae],this.trigger("id3Frame",E)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},js.prototype.setRemux=function(c){this.remuxTracks=c},yu=function(c){var f=this,y=!0,g,E;yu.prototype.init.call(this),c=c||{},this.baseMediaDecodeTime=c.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var D={};this.transmuxPipeline_=D,D.type="aac",D.metadataStream=new Hr.MetadataStream,D.aacStream=new jS,D.audioTimestampRolloverStream=new Hr.TimestampRolloverStream("audio"),D.timedMetadataTimestampRolloverStream=new Hr.TimestampRolloverStream("timed-metadata"),D.adtsStream=new xg,D.coalesceStream=new js(c,D.metadataStream),D.headOfPipeline=D.aacStream,D.aacStream.pipe(D.audioTimestampRolloverStream).pipe(D.adtsStream),D.aacStream.pipe(D.timedMetadataTimestampRolloverStream).pipe(D.metadataStream).pipe(D.coalesceStream),D.metadataStream.on("timestamp",function(ee){D.aacStream.setTimestamp(ee.timeStamp)}),D.aacStream.on("data",function(ee){ee.type!=="timed-metadata"&&ee.type!=="audio"||D.audioSegmentStream||(E=E||{timelineStartInfo:{baseMediaDecodeTime:f.baseMediaDecodeTime},codec:"adts",type:"audio"},D.coalesceStream.numberOfTracks++,D.audioSegmentStream=new Ia(E,c),D.audioSegmentStream.on("log",f.getLogTrigger_("audioSegmentStream")),D.audioSegmentStream.on("timingInfo",f.trigger.bind(f,"audioTimingInfo")),D.adtsStream.pipe(D.audioSegmentStream).pipe(D.coalesceStream),f.trigger("trackinfo",{hasAudio:!!E,hasVideo:!!g}))}),D.coalesceStream.on("data",this.trigger.bind(this,"data")),D.coalesceStream.on("done",this.trigger.bind(this,"done")),Eg(this,D)},this.setupTsPipeline=function(){var D={};this.transmuxPipeline_=D,D.type="ts",D.metadataStream=new Hr.MetadataStream,D.packetStream=new Hr.TransportPacketStream,D.parseStream=new Hr.TransportParseStream,D.elementaryStream=new Hr.ElementaryStream,D.timestampRolloverStream=new Hr.TimestampRolloverStream,D.adtsStream=new xg,D.h264Stream=new US,D.captionStream=new Hr.CaptionStream(c),D.coalesceStream=new js(c,D.metadataStream),D.headOfPipeline=D.packetStream,D.packetStream.pipe(D.parseStream).pipe(D.elementaryStream).pipe(D.timestampRolloverStream),D.timestampRolloverStream.pipe(D.h264Stream),D.timestampRolloverStream.pipe(D.adtsStream),D.timestampRolloverStream.pipe(D.metadataStream).pipe(D.coalesceStream),D.h264Stream.pipe(D.captionStream).pipe(D.coalesceStream),D.elementaryStream.on("data",function(ee){var ae;if(ee.type==="metadata"){for(ae=ee.tracks.length;ae--;)!g&&ee.tracks[ae].type==="video"?(g=ee.tracks[ae],g.timelineStartInfo.baseMediaDecodeTime=f.baseMediaDecodeTime):!E&&ee.tracks[ae].type==="audio"&&(E=ee.tracks[ae],E.timelineStartInfo.baseMediaDecodeTime=f.baseMediaDecodeTime);g&&!D.videoSegmentStream&&(D.coalesceStream.numberOfTracks++,D.videoSegmentStream=new wo(g,c),D.videoSegmentStream.on("log",f.getLogTrigger_("videoSegmentStream")),D.videoSegmentStream.on("timelineStartInfo",function(de){E&&!c.keepOriginalTimestamps&&(E.timelineStartInfo=de,D.audioSegmentStream.setEarliestDts(de.dts-f.baseMediaDecodeTime))}),D.videoSegmentStream.on("processedGopsInfo",f.trigger.bind(f,"gopInfo")),D.videoSegmentStream.on("segmentTimingInfo",f.trigger.bind(f,"videoSegmentTimingInfo")),D.videoSegmentStream.on("baseMediaDecodeTime",function(de){E&&D.audioSegmentStream.setVideoBaseMediaDecodeTime(de)}),D.videoSegmentStream.on("timingInfo",f.trigger.bind(f,"videoTimingInfo")),D.h264Stream.pipe(D.videoSegmentStream).pipe(D.coalesceStream)),E&&!D.audioSegmentStream&&(D.coalesceStream.numberOfTracks++,D.audioSegmentStream=new Ia(E,c),D.audioSegmentStream.on("log",f.getLogTrigger_("audioSegmentStream")),D.audioSegmentStream.on("timingInfo",f.trigger.bind(f,"audioTimingInfo")),D.audioSegmentStream.on("segmentTimingInfo",f.trigger.bind(f,"audioSegmentTimingInfo")),D.adtsStream.pipe(D.audioSegmentStream).pipe(D.coalesceStream)),f.trigger("trackinfo",{hasAudio:!!E,hasVideo:!!g})}}),D.coalesceStream.on("data",this.trigger.bind(this,"data")),D.coalesceStream.on("id3Frame",function(ee){ee.dispatchType=D.metadataStream.dispatchType,f.trigger("id3Frame",ee)}),D.coalesceStream.on("caption",this.trigger.bind(this,"caption")),D.coalesceStream.on("done",this.trigger.bind(this,"done")),Eg(this,D)},this.setBaseMediaDecodeTime=function(D){var ee=this.transmuxPipeline_;c.keepOriginalTimestamps||(this.baseMediaDecodeTime=D),E&&(E.timelineStartInfo.dts=void 0,E.timelineStartInfo.pts=void 0,or.clearDtsInfo(E),ee.audioTimestampRolloverStream&&ee.audioTimestampRolloverStream.discontinuity()),g&&(ee.videoSegmentStream&&(ee.videoSegmentStream.gopCache_=[]),g.timelineStartInfo.dts=void 0,g.timelineStartInfo.pts=void 0,or.clearDtsInfo(g),ee.captionStream.reset()),ee.timestampRolloverStream&&ee.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(D){E&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(D)},this.setRemux=function(D){var ee=this.transmuxPipeline_;c.remux=D,ee&&ee.coalesceStream&&ee.coalesceStream.setRemux(D)},this.alignGopsWith=function(D){g&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(D)},this.getLogTrigger_=function(D){var ee=this;return function(ae){ae.stream=D,ee.trigger("log",ae)}},this.push=function(D){if(y){var ee=$S(D);ee&&this.transmuxPipeline_.type!=="aac"?this.setupAacPipeline():!ee&&this.transmuxPipeline_.type!=="ts"&&this.setupTsPipeline(),y=!1}this.transmuxPipeline_.headOfPipeline.push(D)},this.flush=function(){y=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}},yu.prototype=new pu;var HS={Transmuxer:yu,VideoSegmentStream:wo,AudioSegmentStream:Ia,AUDIO_PROPERTIES:_h,VIDEO_PROPERTIES:xh,generateSegmentTimingInfo:Eh},WS=function(c){return c>>>0},KS=function(c){return("00"+c.toString(16)).slice(-2)},vu={toUnsigned:WS,toHexString:KS},qS=function(c){var f="";return f+=String.fromCharCode(c[0]),f+=String.fromCharCode(c[1]),f+=String.fromCharCode(c[2]),f+=String.fromCharCode(c[3]),f},Sg=qS,zS=vu.toUnsigned,YS=Sg,Cg=function(c,f){var y=[],g,E,D,ee,ae;if(!f.length)return null;for(g=0;g<c.byteLength;)E=zS(c[g]<<24|c[g+1]<<16|c[g+2]<<8|c[g+3]),D=YS(c.subarray(g+4,g+8)),ee=E>1?g+E:c.byteLength,D===f[0]&&(f.length===1?y.push(c.subarray(g+8,ee)):(ae=Cg(c.subarray(g+8,ee),f.slice(1)),ae.length&&(y=y.concat(ae)))),g=ee;return y},wg=Cg,XS=vu.toUnsigned,QS=s.getUint64,ZS=function(c){var f={version:c[0],flags:new Uint8Array(c.subarray(1,4))};return f.version===1?f.baseMediaDecodeTime=QS(c.subarray(4)):f.baseMediaDecodeTime=XS(c[4]<<24|c[5]<<16|c[6]<<8|c[7]),f},Lg=ZS,JS=function(c){return{isLeading:(c[0]&12)>>>2,dependsOn:c[0]&3,isDependedOn:(c[1]&192)>>>6,hasRedundancy:(c[1]&48)>>>4,paddingValue:(c[1]&14)>>>1,isNonSyncSample:c[1]&1,degradationPriority:c[2]<<8|c[3]}},e1=JS,Dg=e1,t1=function(c){var f={version:c[0],flags:new Uint8Array(c.subarray(1,4)),samples:[]},y=new DataView(c.buffer,c.byteOffset,c.byteLength),g=f.flags[2]&1,E=f.flags[2]&4,D=f.flags[1]&1,ee=f.flags[1]&2,ae=f.flags[1]&4,de=f.flags[1]&8,me=y.getUint32(4),Se=8,Pe;for(g&&(f.dataOffset=y.getInt32(Se),Se+=4),E&&me&&(Pe={flags:Dg(c.subarray(Se,Se+4))},Se+=4,D&&(Pe.duration=y.getUint32(Se),Se+=4),ee&&(Pe.size=y.getUint32(Se),Se+=4),de&&(f.version===1?Pe.compositionTimeOffset=y.getInt32(Se):Pe.compositionTimeOffset=y.getUint32(Se),Se+=4),f.samples.push(Pe),me--);me--;)Pe={},D&&(Pe.duration=y.getUint32(Se),Se+=4),ee&&(Pe.size=y.getUint32(Se),Se+=4),ae&&(Pe.flags=Dg(c.subarray(Se,Se+4)),Se+=4),de&&(f.version===1?Pe.compositionTimeOffset=y.getInt32(Se):Pe.compositionTimeOffset=y.getUint32(Se),Se+=4),f.samples.push(Pe);return f},kg=t1,i1=function(c){var f=new DataView(c.buffer,c.byteOffset,c.byteLength),y={version:c[0],flags:new Uint8Array(c.subarray(1,4)),trackId:f.getUint32(4)},g=y.flags[2]&1,E=y.flags[2]&2,D=y.flags[2]&8,ee=y.flags[2]&16,ae=y.flags[2]&32,de=y.flags[0]&65536,me=y.flags[0]&131072,Se;return Se=8,g&&(Se+=4,y.baseDataOffset=f.getUint32(12),Se+=4),E&&(y.sampleDescriptionIndex=f.getUint32(Se),Se+=4),D&&(y.defaultSampleDuration=f.getUint32(Se),Se+=4),ee&&(y.defaultSampleSize=f.getUint32(Se),Se+=4),ae&&(y.defaultSampleFlags=f.getUint32(Se)),de&&(y.durationIsEmpty=!0),!g&&me&&(y.baseDataOffsetIsMoof=!0),y},Ig=i1,Lo;typeof window!="undefined"?Lo=window:typeof n!="undefined"?Lo=n:typeof self!="undefined"?Lo=self:Lo={};var Rg=Lo,n1=og.discardEmulationPreventionBytes,r1=lg.CaptionStream,Do=wg,s1=Lg,a1=kg,o1=Ig,Og=Rg,l1=function(c,f){for(var y=c,g=0;g<f.length;g++){var E=f[g];if(y<E.size)return E;y-=E.size}return null},u1=function(c,f,y){var g=new DataView(c.buffer,c.byteOffset,c.byteLength),E={logs:[],seiNals:[]},D,ee,ae,de;for(ee=0;ee+4<c.length;ee+=ae)if(ae=g.getUint32(ee),ee+=4,!(ae<=0))switch(c[ee]&31){case 6:var me=c.subarray(ee+1,ee+1+ae),Se=l1(ee,f);if(D={nalUnitType:"sei_rbsp",size:ae,data:me,escapedRBSP:n1(me),trackId:y},Se)D.pts=Se.pts,D.dts=Se.dts,de=Se;else if(de)D.pts=de.pts,D.dts=de.dts;else{E.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+ee+" for trackId "+y+". See mux.js#223."});break}E.seiNals.push(D);break}return E},d1=function(c,f,y){var g=f,E=y.defaultSampleDuration||0,D=y.defaultSampleSize||0,ee=y.trackId,ae=[];return c.forEach(function(de){var me=a1(de),Se=me.samples;Se.forEach(function(Pe){Pe.duration===void 0&&(Pe.duration=E),Pe.size===void 0&&(Pe.size=D),Pe.trackId=ee,Pe.dts=g,Pe.compositionTimeOffset===void 0&&(Pe.compositionTimeOffset=0),typeof g=="bigint"?(Pe.pts=g+Og.BigInt(Pe.compositionTimeOffset),g+=Og.BigInt(Pe.duration)):(Pe.pts=g+Pe.compositionTimeOffset,g+=Pe.duration)}),ae=ae.concat(Se)}),ae},c1=function(c,f){var y=Do(c,["moof","traf"]),g=Do(c,["mdat"]),E={},D=[];return g.forEach(function(ee,ae){var de=y[ae];D.push({mdat:ee,traf:de})}),D.forEach(function(ee){var ae=ee.mdat,de=ee.traf,me=Do(de,["tfhd"]),Se=o1(me[0]),Pe=Se.trackId,dt=Do(de,["tfdt"]),He=dt.length>0?s1(dt[0]).baseMediaDecodeTime:0,wt=Do(de,["trun"]),kt,Fi;f===Pe&&wt.length>0&&(kt=d1(wt,He,Se),Fi=u1(ae,kt,Pe),E[Pe]||(E[Pe]={seiNals:[],logs:[]}),E[Pe].seiNals=E[Pe].seiNals.concat(Fi.seiNals),E[Pe].logs=E[Pe].logs.concat(Fi.logs))}),E},h1=function(c,f,y){var g;if(f===null)return null;g=c1(c,f);var E=g[f]||{};return{seiNals:E.seiNals,logs:E.logs,timescale:y}},f1=function(){var c=!1,f,y,g,E,D,ee;this.isInitialized=function(){return c},this.init=function(ae){f=new r1,c=!0,ee=ae?ae.isPartial:!1,f.on("data",function(de){de.startTime=de.startPts/E,de.endTime=de.endPts/E,D.captions.push(de),D.captionStreams[de.stream]=!0}),f.on("log",function(de){D.logs.push(de)})},this.isNewInit=function(ae,de){return ae&&ae.length===0||de&&typeof de=="object"&&Object.keys(de).length===0?!1:g!==ae[0]||E!==de[g]},this.parse=function(ae,de,me){var Se;if(this.isInitialized()){if(!de||!me)return null;if(this.isNewInit(de,me))g=de[0],E=me[g];else if(g===null||!E)return y.push(ae),null}else return null;for(;y.length>0;){var Pe=y.shift();this.parse(Pe,de,me)}return Se=h1(ae,g,E),Se&&Se.logs&&(D.logs=D.logs.concat(Se.logs)),Se===null||!Se.seiNals?D.logs.length?{logs:D.logs,captions:[],captionStreams:[]}:null:(this.pushNals(Se.seiNals),this.flushStream(),D)},this.pushNals=function(ae){if(!this.isInitialized()||!ae||ae.length===0)return null;ae.forEach(function(de){f.push(de)})},this.flushStream=function(){if(!this.isInitialized())return null;ee?f.partialFlush():f.flush()},this.clearParsedCaptions=function(){D.captions=[],D.captionStreams={},D.logs=[]},this.resetCaptionStream=function(){if(!this.isInitialized())return null;f.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){y=[],g=null,E=null,D?this.clearParsedCaptions():D={captions:[],captionStreams:{},logs:[]},this.resetCaptionStream()},this.reset()},p1=f1,m1=function(c){for(var f=0,y=String.fromCharCode(c[f]),g="";y!=="\0";)g+=y,f++,y=String.fromCharCode(c[f]);return g+=y,g},g1={uint8ToCString:m1},Au=g1.uint8ToCString,y1=s.getUint64,v1=function(c){var f=4,y=c[0],g,E,D,ee,ae,de,me,Se;if(y===0){g=Au(c.subarray(f)),f+=g.length,E=Au(c.subarray(f)),f+=E.length;var Pe=new DataView(c.buffer);D=Pe.getUint32(f),f+=4,ae=Pe.getUint32(f),f+=4,de=Pe.getUint32(f),f+=4,me=Pe.getUint32(f),f+=4}else if(y===1){var Pe=new DataView(c.buffer);D=Pe.getUint32(f),f+=4,ee=y1(c.subarray(f)),f+=8,de=Pe.getUint32(f),f+=4,me=Pe.getUint32(f),f+=4,g=Au(c.subarray(f)),f+=g.length,E=Au(c.subarray(f)),f+=E.length}Se=new Uint8Array(c.subarray(f,c.byteLength));var dt={scheme_id_uri:g,value:E,timescale:D||1,presentation_time:ee,presentation_time_delta:ae,event_duration:de,id:me,message_data:Se};return b1(y,dt)?dt:void 0},A1=function(c,f,y,g){return c||c===0?c/f:g+y/f},b1=function(c,f){var y=f.scheme_id_uri!=="\0",g=c===0&&Pg(f.presentation_time_delta)&&y,E=c===1&&Pg(f.presentation_time)&&y;return!(c>1)&&g||E},Pg=function(c){return c!==void 0||c!==null},_1={parseEmsgBox:v1,scaleTime:A1},bu=vu.toUnsigned,ko=vu.toHexString,Li=wg,Ra=Sg,Th=_1,x1=Ig,E1=kg,T1=Lg,S1=s.getUint64,Bg,Fg,Mg,Ng,Ug,Sh,jg,Ch=Rg,C1=hg.parseId3Frames;Bg=function(c){var f={},y=Li(c,["moov","trak"]);return y.reduce(function(g,E){var D,ee,ae,de,me;return D=Li(E,["tkhd"])[0],!D||(ee=D[0],ae=ee===0?12:20,de=bu(D[ae]<<24|D[ae+1]<<16|D[ae+2]<<8|D[ae+3]),me=Li(E,["mdia","mdhd"])[0],!me)?null:(ee=me[0],ae=ee===0?12:20,g[de]=bu(me[ae]<<24|me[ae+1]<<16|me[ae+2]<<8|me[ae+3]),g)},f)},Fg=function(c,f){var y;y=Li(f,["moof","traf"]);var g=y.reduce(function(E,D){var ee=Li(D,["tfhd"])[0],ae=bu(ee[4]<<24|ee[5]<<16|ee[6]<<8|ee[7]),de=c[ae]||9e4,me=Li(D,["tfdt"])[0],Se=new DataView(me.buffer,me.byteOffset,me.byteLength),Pe;me[0]===1?Pe=S1(me.subarray(4,12)):Pe=Se.getUint32(4);let dt;return typeof Pe=="bigint"?dt=Pe/Ch.BigInt(de):typeof Pe=="number"&&!isNaN(Pe)&&(dt=Pe/de),dt<Number.MAX_SAFE_INTEGER&&(dt=Number(dt)),dt<E&&(E=dt),E},Infinity);return typeof g=="bigint"||isFinite(g)?g:0},Mg=function(c,f){var y=Li(f,["moof","traf"]),g=0,E=0,D;if(y&&y.length){var ee=Li(y[0],["tfhd"])[0],ae=Li(y[0],["trun"])[0],de=Li(y[0],["tfdt"])[0];if(ee){var me=x1(ee);D=me.trackId}if(de){var Se=T1(de);g=Se.baseMediaDecodeTime}if(ae){var Pe=E1(ae);Pe.samples&&Pe.samples.length&&(E=Pe.samples[0].compositionTimeOffset||0)}}var dt=c[D]||9e4;typeof g=="bigint"&&(E=Ch.BigInt(E),dt=Ch.BigInt(dt));var He=(g+E)/dt;return typeof He=="bigint"&&He<Number.MAX_SAFE_INTEGER&&(He=Number(He)),He},Ng=function(c){var f=Li(c,["moov","trak"]),y=[];return f.forEach(function(g){var E=Li(g,["mdia","hdlr"]),D=Li(g,["tkhd"]);E.forEach(function(ee,ae){var de=Ra(ee.subarray(8,12)),me=D[ae],Se,Pe,dt;de==="vide"&&(Se=new DataView(me.buffer,me.byteOffset,me.byteLength),Pe=Se.getUint8(0),dt=Pe===0?Se.getUint32(12):Se.getUint32(20),y.push(dt))})}),y},Sh=function(c){var f=c[0],y=f===0?12:20;return bu(c[y]<<24|c[y+1]<<16|c[y+2]<<8|c[y+3])},Ug=function(c){var f=Li(c,["moov","trak"]),y=[];return f.forEach(function(g){var E={},D=Li(g,["tkhd"])[0],ee,ae;D&&(ee=new DataView(D.buffer,D.byteOffset,D.byteLength),ae=ee.getUint8(0),E.id=ae===0?ee.getUint32(12):ee.getUint32(20));var de=Li(g,["mdia","hdlr"])[0];if(de){var me=Ra(de.subarray(8,12));me==="vide"?E.type="video":me==="soun"?E.type="audio":E.type=me}var Se=Li(g,["mdia","minf","stbl","stsd"])[0];if(Se){var Pe=Se.subarray(8);E.codec=Ra(Pe.subarray(4,8));var dt=Li(Pe,[E.codec])[0],He,wt;dt&&(/^[asm]vc[1-9]$/i.test(E.codec)?(He=dt.subarray(78),wt=Ra(He.subarray(4,8)),wt==="avcC"&&He.length>11?(E.codec+=".",E.codec+=ko(He[9]),E.codec+=ko(He[10]),E.codec+=ko(He[11])):E.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(E.codec)?(He=dt.subarray(28),wt=Ra(He.subarray(4,8)),wt==="esds"&&He.length>20&&He[19]!==0?(E.codec+="."+ko(He[19]),E.codec+="."+ko(He[20]>>>2&63).replace(/^0/,"")):E.codec="mp4a.40.2"):E.codec=E.codec.toLowerCase())}var kt=Li(g,["mdia","mdhd"])[0];kt&&(E.timescale=Sh(kt)),y.push(E)}),y},jg=function(c,f=0){var y=Li(c,["emsg"]);return y.map(g=>{var E=Th.parseEmsgBox(new Uint8Array(g)),D=C1(E.message_data);return{cueTime:Th.scaleTime(E.presentation_time,E.timescale,E.presentation_time_delta,f),duration:Th.scaleTime(E.event_duration,E.timescale),frames:D}})};var $g={findBox:Li,parseType:Ra,timescale:Bg,startTime:Fg,compositionStartTime:Mg,videoTrackIds:Ng,tracks:Ug,getTimescaleFromMediaHeader:Sh,getEmsgID3:jg},wh=su,Gg=function(c){var f=c[1]&31;return f<<=8,f|=c[2],f},_u=function(c){return!!(c[1]&64)},xu=function(c){var f=0;return(c[3]&48)>>>4>1&&(f+=c[4]+1),f},w1=function(c,f){var y=Gg(c);return y===0?"pat":y===f?"pmt":f?"pes":null},L1=function(c){var f=_u(c),y=4+xu(c);return f&&(y+=c[y]+1),(c[y+10]&31)<<8|c[y+11]},D1=function(c){var f={},y=_u(c),g=4+xu(c);if(y&&(g+=c[g]+1),!!(c[g+5]&1)){var E,D,ee;E=(c[g+1]&15)<<8|c[g+2],D=3+E-4,ee=(c[g+10]&15)<<8|c[g+11];for(var ae=12+ee;ae<D;){var de=g+ae;f[(c[de+1]&31)<<8|c[de+2]]=c[de],ae+=((c[de+3]&15)<<8|c[de+4])+5}return f}},k1=function(c,f){var y=Gg(c),g=f[y];switch(g){case wh.H264_STREAM_TYPE:return"video";case wh.ADTS_STREAM_TYPE:return"audio";case wh.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},I1=function(c){var f=_u(c);if(!f)return null;var y=4+xu(c);if(y>=c.byteLength)return null;var g=null,E;return E=c[y+7],E&192&&(g={},g.pts=(c[y+9]&14)<<27|(c[y+10]&255)<<20|(c[y+11]&254)<<12|(c[y+12]&255)<<5|(c[y+13]&254)>>>3,g.pts*=4,g.pts+=(c[y+13]&6)>>>1,g.dts=g.pts,E&64&&(g.dts=(c[y+14]&14)<<27|(c[y+15]&255)<<20|(c[y+16]&254)<<12|(c[y+17]&255)<<5|(c[y+18]&254)>>>3,g.dts*=4,g.dts+=(c[y+18]&6)>>>1)),g},Lh=function(c){switch(c){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},R1=function(c){for(var f=4+xu(c),y=c.subarray(f),g=0,E=0,D=!1,ee;E<y.byteLength-3;E++)if(y[E+2]===1){g=E+5;break}for(;g<y.byteLength;)switch(y[g]){case 0:if(y[g-1]!==0){g+=2;break}else if(y[g-2]!==0){g++;break}E+3!==g-2&&(ee=Lh(y[E+3]&31),ee==="slice_layer_without_partitioning_rbsp_idr"&&(D=!0));do g++;while(y[g]!==1&&g<y.length);E=g-2,g+=3;break;case 1:if(y[g-1]!==0||y[g-2]!==0){g+=3;break}ee=Lh(y[E+3]&31),ee==="slice_layer_without_partitioning_rbsp_idr"&&(D=!0),E=g-2,g+=3;break;default:g+=3;break}return y=y.subarray(E),g-=E,E=0,y&&y.byteLength>3&&(ee=Lh(y[E+3]&31),ee==="slice_layer_without_partitioning_rbsp_idr"&&(D=!0)),D},O1={parseType:w1,parsePat:L1,parsePmt:D1,parsePayloadUnitStartIndicator:_u,parsePesType:k1,parsePesTime:I1,videoPacketContainsKeyFrame:R1},Vg=su,Oa=dg.handleRollover,ii={};ii.ts=O1,ii.aac=bh;var $s=mi.ONE_SECOND_IN_TS,dn=188,Sr=71,P1=function(c,f){for(var y=0,g=dn,E,D;g<c.byteLength;){if(c[y]===Sr&&c[g]===Sr){switch(E=c.subarray(y,g),D=ii.ts.parseType(E,f.pid),D){case"pat":f.pid=ii.ts.parsePat(E);break;case"pmt":var ee=ii.ts.parsePmt(E);f.table=f.table||{},Object.keys(ee).forEach(function(ae){f.table[ae]=ee[ae]});break}y+=dn,g+=dn;continue}y++,g++}},Hg=function(c,f,y){for(var g=0,E=dn,D,ee,ae,de,me,Se=!1;E<=c.byteLength;){if(c[g]===Sr&&(c[E]===Sr||E===c.byteLength)){switch(D=c.subarray(g,E),ee=ii.ts.parseType(D,f.pid),ee){case"pes":ae=ii.ts.parsePesType(D,f.table),de=ii.ts.parsePayloadUnitStartIndicator(D),ae==="audio"&&de&&(me=ii.ts.parsePesTime(D),me&&(me.type="audio",y.audio.push(me),Se=!0));break}if(Se)break;g+=dn,E+=dn;continue}g++,E++}for(E=c.byteLength,g=E-dn,Se=!1;g>=0;){if(c[g]===Sr&&(c[E]===Sr||E===c.byteLength)){switch(D=c.subarray(g,E),ee=ii.ts.parseType(D,f.pid),ee){case"pes":ae=ii.ts.parsePesType(D,f.table),de=ii.ts.parsePayloadUnitStartIndicator(D),ae==="audio"&&de&&(me=ii.ts.parsePesTime(D),me&&(me.type="audio",y.audio.push(me),Se=!0));break}if(Se)break;g-=dn,E-=dn;continue}g--,E--}},B1=function(c,f,y){for(var g=0,E=dn,D,ee,ae,de,me,Se,Pe,dt,He=!1,wt={data:[],size:0};E<c.byteLength;){if(c[g]===Sr&&c[E]===Sr){switch(D=c.subarray(g,E),ee=ii.ts.parseType(D,f.pid),ee){case"pes":if(ae=ii.ts.parsePesType(D,f.table),de=ii.ts.parsePayloadUnitStartIndicator(D),ae==="video"&&(de&&!He&&(me=ii.ts.parsePesTime(D),me&&(me.type="video",y.video.push(me),He=!0)),!y.firstKeyFrame)){if(de&&wt.size!==0){for(Se=new Uint8Array(wt.size),Pe=0;wt.data.length;)dt=wt.data.shift(),Se.set(dt,Pe),Pe+=dt.byteLength;if(ii.ts.videoPacketContainsKeyFrame(Se)){var kt=ii.ts.parsePesTime(Se);kt?(y.firstKeyFrame=kt,y.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}wt.size=0}wt.data.push(D),wt.size+=D.byteLength}break}if(He&&y.firstKeyFrame)break;g+=dn,E+=dn;continue}g++,E++}for(E=c.byteLength,g=E-dn,He=!1;g>=0;){if(c[g]===Sr&&c[E]===Sr){switch(D=c.subarray(g,E),ee=ii.ts.parseType(D,f.pid),ee){case"pes":ae=ii.ts.parsePesType(D,f.table),de=ii.ts.parsePayloadUnitStartIndicator(D),ae==="video"&&de&&(me=ii.ts.parsePesTime(D),me&&(me.type="video",y.video.push(me),He=!0));break}if(He)break;g-=dn,E-=dn;continue}g--,E--}},F1=function(c,f){if(c.audio&&c.audio.length){var y=f;(typeof y=="undefined"||isNaN(y))&&(y=c.audio[0].dts),c.audio.forEach(function(D){D.dts=Oa(D.dts,y),D.pts=Oa(D.pts,y),D.dtsTime=D.dts/$s,D.ptsTime=D.pts/$s})}if(c.video&&c.video.length){var g=f;if((typeof g=="undefined"||isNaN(g))&&(g=c.video[0].dts),c.video.forEach(function(D){D.dts=Oa(D.dts,g),D.pts=Oa(D.pts,g),D.dtsTime=D.dts/$s,D.ptsTime=D.pts/$s}),c.firstKeyFrame){var E=c.firstKeyFrame;E.dts=Oa(E.dts,g),E.pts=Oa(E.pts,g),E.dtsTime=E.dts/$s,E.ptsTime=E.pts/$s}}},M1=function(c){for(var f=!1,y=0,g=null,E=null,D=0,ee=0,ae;c.length-ee>=3;){var de=ii.aac.parseType(c,ee);switch(de){case"timed-metadata":if(c.length-ee<10){f=!0;break}if(D=ii.aac.parseId3TagSize(c,ee),D>c.length){f=!0;break}E===null&&(ae=c.subarray(ee,ee+D),E=ii.aac.parseAacTimestamp(ae)),ee+=D;break;case"audio":if(c.length-ee<7){f=!0;break}if(D=ii.aac.parseAdtsSize(c,ee),D>c.length){f=!0;break}g===null&&(ae=c.subarray(ee,ee+D),g=ii.aac.parseSampleRate(ae)),y++,ee+=D;break;default:ee++;break}if(f)return null}if(g===null||E===null)return null;var me=$s/g,Se={audio:[{type:"audio",dts:E,pts:E},{type:"audio",dts:E+y*1024*me,pts:E+y*1024*me}]};return Se},N1=function(c){var f={pid:null,table:null},y={};P1(c,f);for(var g in f.table)if(f.table.hasOwnProperty(g)){var E=f.table[g];switch(E){case Vg.H264_STREAM_TYPE:y.video=[],B1(c,f,y),y.video.length===0&&delete y.video;break;case Vg.ADTS_STREAM_TYPE:y.audio=[],Hg(c,f,y),y.audio.length===0&&delete y.audio;break}}return y},U1=function(c,f){var y=ii.aac.isLikelyAacData(c),g;return y?g=M1(c):g=N1(c),!g||!g.audio&&!g.video?null:(F1(g,f),g)},j1={inspect:U1,parseAudioPes_:Hg};const $1=function(c,f){f.on("data",function(y){const g=y.initSegment;y.initSegment={data:g.buffer,byteOffset:g.byteOffset,byteLength:g.byteLength};const E=y.data;y.data=E.buffer,c.postMessage({action:"data",segment:y,byteOffset:E.byteOffset,byteLength:E.byteLength},[y.data])}),f.on("done",function(y){c.postMessage({action:"done"})}),f.on("gopInfo",function(y){c.postMessage({action:"gopInfo",gopInfo:y})}),f.on("videoSegmentTimingInfo",function(y){const g={start:{decode:mi.videoTsToSeconds(y.start.dts),presentation:mi.videoTsToSeconds(y.start.pts)},end:{decode:mi.videoTsToSeconds(y.end.dts),presentation:mi.videoTsToSeconds(y.end.pts)},baseMediaDecodeTime:mi.videoTsToSeconds(y.baseMediaDecodeTime)};y.prependedContentDuration&&(g.prependedContentDuration=mi.videoTsToSeconds(y.prependedContentDuration)),c.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:g})}),f.on("audioSegmentTimingInfo",function(y){const g={start:{decode:mi.videoTsToSeconds(y.start.dts),presentation:mi.videoTsToSeconds(y.start.pts)},end:{decode:mi.videoTsToSeconds(y.end.dts),presentation:mi.videoTsToSeconds(y.end.pts)},baseMediaDecodeTime:mi.videoTsToSeconds(y.baseMediaDecodeTime)};y.prependedContentDuration&&(g.prependedContentDuration=mi.videoTsToSeconds(y.prependedContentDuration)),c.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:g})}),f.on("id3Frame",function(y){c.postMessage({action:"id3Frame",id3Frame:y})}),f.on("caption",function(y){c.postMessage({action:"caption",caption:y})}),f.on("trackinfo",function(y){c.postMessage({action:"trackinfo",trackInfo:y})}),f.on("audioTimingInfo",function(y){c.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:mi.videoTsToSeconds(y.start),end:mi.videoTsToSeconds(y.end)}})}),f.on("videoTimingInfo",function(y){c.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:mi.videoTsToSeconds(y.start),end:mi.videoTsToSeconds(y.end)}})}),f.on("log",function(y){c.postMessage({action:"log",log:y})})};class Wg{constructor(f,y){this.options=y||{},this.self=f,this.init()}init(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new HS.Transmuxer(this.options),$1(this.self,this.transmuxer)}pushMp4Captions(f){this.captionParser||(this.captionParser=new p1,this.captionParser.init());const y=new Uint8Array(f.data,f.byteOffset,f.byteLength),g=this.captionParser.parse(y,f.trackIds,f.timescales);this.self.postMessage({action:"mp4Captions",captions:g&&g.captions||[],logs:g&&g.logs||[],data:y.buffer},[y.buffer])}probeMp4StartTime({timescales:f,data:y}){const g=$g.startTime(f,y);this.self.postMessage({action:"probeMp4StartTime",startTime:g,data:y},[y.buffer])}probeMp4Tracks({data:f}){const y=$g.tracks(f);this.self.postMessage({action:"probeMp4Tracks",tracks:y,data:f},[f.buffer])}probeTs({data:f,baseStartTime:y}){const g=typeof y=="number"&&!isNaN(y)?y*mi.ONE_SECOND_IN_TS:void 0,E=j1.inspect(f,g);let D=null;E&&(D={hasVideo:E.video&&E.video.length===2||!1,hasAudio:E.audio&&E.audio.length===2||!1},D.hasVideo&&(D.videoStart=E.video[0].ptsTime),D.hasAudio&&(D.audioStart=E.audio[0].ptsTime)),this.self.postMessage({action:"probeTs",result:D,data:f},[f.buffer])}clearAllMp4Captions(){this.captionParser&&this.captionParser.clearAllCaptions()}clearParsedMp4Captions(){this.captionParser&&this.captionParser.clearParsedCaptions()}push(f){const y=new Uint8Array(f.data,f.byteOffset,f.byteLength);this.transmuxer.push(y)}reset(){this.transmuxer.reset()}setTimestampOffset(f){const y=f.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(mi.secondsToVideoTs(y)))}setAudioAppendStart(f){this.transmuxer.setAudioAppendStart(Math.ceil(mi.secondsToVideoTs(f.appendStart)))}setRemux(f){this.transmuxer.setRemux(f.remux)}flush(f){this.transmuxer.flush(),self.postMessage({action:"done",type:"transmuxed"})}endTimeline(){this.transmuxer.endTimeline(),self.postMessage({action:"endedtimeline",type:"transmuxed"})}alignGopsWith(f){this.transmuxer.alignGopsWith(f.gopsToAlignWith.slice())}}self.onmessage=function(c){if(c.data.action==="init"&&c.data.options){this.messageHandlers=new Wg(self,c.data.options);return}this.messageHandlers||(this.messageHandlers=new Wg(self)),c.data&&c.data.action&&c.data.action!=="init"&&this.messageHandlers[c.data.action]&&this.messageHandlers[c.data.action](c.data)}}));var Jv=Ep(Zv);const eA=(n,e,t)=>{const{type:i,initSegment:r,captions:s,captionStreams:a,metadata:o,videoFrameDtsTime:l,videoFramePtsTime:u}=n.data.segment;e.buffer.push({captions:s,captionStreams:a,metadata:o});const d=n.data.segment.boxes||{data:n.data.segment.data},h={type:i,data:new Uint8Array(d.data,d.data.byteOffset,d.data.byteLength),initSegment:new Uint8Array(r.data,r.byteOffset,r.byteLength)};typeof l!="undefined"&&(h.videoFrameDtsTime=l),typeof u!="undefined"&&(h.videoFramePtsTime=u),t(h)},tA=({transmuxedData:n,callback:e})=>{n.buffer=[],e(n)},iA=(n,e)=>{e.gopInfo=n.data.gopInfo},Cp=n=>{const{transmuxer:e,bytes:t,audioAppendStart:i,gopsToAlignWith:r,remux:s,onData:a,onTrackInfo:o,onAudioTimingInfo:l,onVideoTimingInfo:u,onVideoSegmentTimingInfo:d,onAudioSegmentTimingInfo:h,onId3:v,onCaptions:x,onDone:_,onEndedTimeline:R,onTransmuxerLog:N,isEndOfTimeline:z}=n,J={buffer:[]};let ue=z;const pe=te=>{e.currentTransmux===n&&(te.data.action==="data"&&eA(te,J,a),te.data.action==="trackinfo"&&o(te.data.trackInfo),te.data.action==="gopInfo"&&iA(te,J),te.data.action==="audioTimingInfo"&&l(te.data.audioTimingInfo),te.data.action==="videoTimingInfo"&&u(te.data.videoTimingInfo),te.data.action==="videoSegmentTimingInfo"&&d(te.data.videoSegmentTimingInfo),te.data.action==="audioSegmentTimingInfo"&&h(te.data.audioSegmentTimingInfo),te.data.action==="id3Frame"&&v([te.data.id3Frame],te.data.id3Frame.dispatchType),te.data.action==="caption"&&x(te.data.caption),te.data.action==="endedtimeline"&&(ue=!1,R()),te.data.action==="log"&&N(te.data.log),te.data.type==="transmuxed"&&(ue||(e.onmessage=null,tA({transmuxedData:J,callback:_}),wp(e))))};if(e.onmessage=pe,i&&e.postMessage({action:"setAudioAppendStart",appendStart:i}),Array.isArray(r)&&e.postMessage({action:"alignGopsWith",gopsToAlignWith:r}),typeof s!="undefined"&&e.postMessage({action:"setRemux",remux:s}),t.byteLength){const te=t instanceof ArrayBuffer?t:t.buffer,ke=t instanceof ArrayBuffer?0:t.byteOffset;e.postMessage({action:"push",data:te,byteOffset:ke,byteLength:t.byteLength},[te])}z&&e.postMessage({action:"endTimeline"}),e.postMessage({action:"flush"})},wp=n=>{n.currentTransmux=null,n.transmuxQueue.length&&(n.currentTransmux=n.transmuxQueue.shift(),typeof n.currentTransmux=="function"?n.currentTransmux():Cp(n.currentTransmux))},Lp=(n,e)=>{n.postMessage({action:e}),wp(n)},Dp=(n,e)=>{if(!e.currentTransmux){e.currentTransmux=n,Lp(e,n);return}e.transmuxQueue.push(Lp.bind(null,e,n))},nA=n=>{Dp("reset",n)},rA=n=>{Dp("endTimeline",n)},kp=n=>{if(!n.transmuxer.currentTransmux){n.transmuxer.currentTransmux=n,Cp(n);return}n.transmuxer.transmuxQueue.push(n)};var nc={reset:nA,endTimeline:rA,transmux:kp,createTransmuxer:n=>{const e=new Jv;e.currentTransmux=null,e.transmuxQueue=[];const t=e.terminate;return e.terminate=()=>(e.currentTransmux=null,e.transmuxQueue.length=0,t.call(e)),e.postMessage({action:"init",options:n}),e}};const xl=function(n){const e=n.transmuxer,t=n.endAction||n.action,i=n.callback,r=(0,B.Z)({},n,{endAction:null,transmuxer:null,callback:null}),s=a=>{a.data.action===t&&(e.removeEventListener("message",s),a.data.data&&(a.data.data=new Uint8Array(a.data.data,n.byteOffset||0,n.byteLength||a.data.data.byteLength),n.data&&(n.data=a.data.data)),i(a.data))};if(e.addEventListener("message",s),n.data){const a=n.data instanceof ArrayBuffer;r.byteOffset=a?0:n.data.byteOffset,r.byteLength=n.data.byteLength;const o=[a?n.data:n.data.buffer];e.postMessage(r,o)}else e.postMessage(r)},br={FAILURE:2,TIMEOUT:-101,ABORTED:-102},rc=n=>{n.forEach(e=>{e.abort()})},sA=n=>({bandwidth:n.bandwidth,bytesReceived:n.bytesReceived||0,roundTripTime:n.roundTripTime||0}),aA=n=>{const e=n.target,t=Date.now()-e.requestTime,i={bandwidth:Infinity,bytesReceived:0,roundTripTime:t||0};return i.bytesReceived=n.loaded,i.bandwidth=Math.floor(i.bytesReceived/i.roundTripTime*8*1e3),i},sc=(n,e)=>e.timedout?{status:e.status,message:"HLS request timed-out at URL: "+e.uri,code:br.TIMEOUT,xhr:e}:e.aborted?{status:e.status,message:"HLS request aborted at URL: "+e.uri,code:br.ABORTED,xhr:e}:n?{status:e.status,message:"HLS request errored at URL: "+e.uri,code:br.FAILURE,xhr:e}:e.responseType==="arraybuffer"&&e.response.byteLength===0?{status:e.status,message:"Empty HLS response at URL: "+e.uri,code:br.FAILURE,xhr:e}:null,Ip=(n,e,t)=>(i,r)=>{const s=r.response,a=sc(i,r);if(a)return t(a,n);if(s.byteLength!==16)return t({status:r.status,message:"Invalid HLS key at URL: "+r.uri,code:br.FAILURE,xhr:r},n);const o=new DataView(s),l=new Uint32Array([o.getUint32(0),o.getUint32(4),o.getUint32(8),o.getUint32(12)]);for(let u=0;u<e.length;u++)e[u].bytes=l;return t(null,n)},Rp=(n,e)=>{const t=Wa(n.map.bytes);if(t!=="mp4"){const i=n.map.resolvedUri||n.map.uri;return e({internal:!0,message:`Found unsupported ${t||"unknown"} container for initialization segment at URL: ${i}`,code:br.FAILURE})}xl({action:"probeMp4Tracks",data:n.map.bytes,transmuxer:n.transmuxer,callback:({tracks:i,data:r})=>(n.map.bytes=r,i.forEach(function(s){n.map.tracks=n.map.tracks||{},!n.map.tracks[s.type]&&(n.map.tracks[s.type]=s,typeof s.id=="number"&&s.timescale&&(n.map.timescales=n.map.timescales||{},n.map.timescales[s.id]=s.timescale))}),e(null))})},oA=({segment:n,finishProcessingFn:e})=>(t,i)=>{const r=sc(t,i);if(r)return e(r,n);const s=new Uint8Array(i.response);if(n.map.key)return n.map.encryptedBytes=s,e(null,n);n.map.bytes=s,Rp(n,function(a){if(a)return a.xhr=i,a.status=i.status,e(a,n);e(null,n)})},lA=({segment:n,finishProcessingFn:e,responseType:t})=>(i,r)=>{const s=sc(i,r);if(s)return e(s,n);const a=t==="arraybuffer"||!r.responseText?r.response:Xv(r.responseText.substring(n.lastReachedChar||0));return n.stats=sA(r),n.key?n.encryptedBytes=new Uint8Array(a):n.bytes=new Uint8Array(a),e(null,n)},uA=({segment:n,bytes:e,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:r,audioSegmentTimingInfoFn:s,id3Fn:a,captionsFn:o,isEndOfTimeline:l,endedTimelineFn:u,dataFn:d,doneFn:h,onTransmuxerLog:v})=>{const x=n.map&&n.map.tracks||{},_=Boolean(x.audio&&x.video);let R=i.bind(null,n,"audio","start");const N=i.bind(null,n,"audio","end");let z=i.bind(null,n,"video","start");const J=i.bind(null,n,"video","end"),ue=()=>kp({bytes:e,transmuxer:n.transmuxer,audioAppendStart:n.audioAppendStart,gopsToAlignWith:n.gopsToAlignWith,remux:_,onData:pe=>{pe.type=pe.type==="combined"?"video":pe.type,d(n,pe)},onTrackInfo:pe=>{t&&(_&&(pe.isMuxed=!0),t(n,pe))},onAudioTimingInfo:pe=>{R&&typeof pe.start!="undefined"&&(R(pe.start),R=null),N&&typeof pe.end!="undefined"&&N(pe.end)},onVideoTimingInfo:pe=>{z&&typeof pe.start!="undefined"&&(z(pe.start),z=null),J&&typeof pe.end!="undefined"&&J(pe.end)},onVideoSegmentTimingInfo:pe=>{r(pe)},onAudioSegmentTimingInfo:pe=>{s(pe)},onId3:(pe,te)=>{a(n,pe,te)},onCaptions:pe=>{o(n,[pe])},isEndOfTimeline:l,onEndedTimeline:()=>{u()},onTransmuxerLog:v,onDone:pe=>{!h||(pe.type=pe.type==="combined"?"video":pe.type,h(null,n,pe))}});xl({action:"probeTs",transmuxer:n.transmuxer,data:e,baseStartTime:n.baseStartTime,callback:pe=>{n.bytes=e=pe.data;const te=pe.result;te&&(t(n,{hasAudio:te.hasAudio,hasVideo:te.hasVideo,isMuxed:_}),t=null,te.hasAudio&&!_&&R(te.audioStart),te.hasVideo&&z(te.videoStart),R=null,z=null),ue()}})},Op=({segment:n,bytes:e,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:r,audioSegmentTimingInfoFn:s,id3Fn:a,captionsFn:o,isEndOfTimeline:l,endedTimelineFn:u,dataFn:d,doneFn:h,onTransmuxerLog:v})=>{let x=new Uint8Array(e);if(Es(x)){n.isFmp4=!0;const{tracks:_}=n.map,R={isFmp4:!0,hasVideo:!!_.video,hasAudio:!!_.audio};_.audio&&_.audio.codec&&_.audio.codec!=="enca"&&(R.audioCodec=_.audio.codec),_.video&&_.video.codec&&_.video.codec!=="encv"&&(R.videoCodec=_.video.codec),_.video&&_.audio&&(R.isMuxed=!0),t(n,R);const N=z=>{d(n,{data:x,type:R.hasAudio&&!R.isMuxed?"audio":"video"}),z&&z.length&&o(n,z),h(null,n,{})};xl({action:"probeMp4StartTime",timescales:n.map.timescales,data:x,transmuxer:n.transmuxer,callback:({data:z,startTime:J})=>{if(e=z.buffer,n.bytes=x=z,R.hasAudio&&!R.isMuxed&&i(n,"audio","start",J),R.hasVideo&&i(n,"video","start",J),!_.video||!z.byteLength||!n.transmuxer){N();return}xl({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:n.transmuxer,data:x,timescales:n.map.timescales,trackIds:[_.video.id],callback:ue=>{e=ue.data.buffer,n.bytes=x=ue.data,ue.logs.forEach(function(pe){v(ci(pe,{stream:"mp4CaptionParser"}))}),N(ue.captions)}})}});return}if(!n.transmuxer){h(null,n,{});return}if(typeof n.container=="undefined"&&(n.container=Wa(x)),n.container!=="ts"&&n.container!=="aac"){t(n,{hasAudio:!1,hasVideo:!1}),h(null,n,{});return}uA({segment:n,bytes:e,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:r,audioSegmentTimingInfoFn:s,id3Fn:a,captionsFn:o,isEndOfTimeline:l,endedTimelineFn:u,dataFn:d,doneFn:h,onTransmuxerLog:v})},Pp=function({id:n,key:e,encryptedBytes:t,decryptionWorker:i},r){const s=o=>{if(o.data.source===n){i.removeEventListener("message",s);const l=o.data.decrypted;r(new Uint8Array(l.bytes,l.byteOffset,l.byteLength))}};i.addEventListener("message",s);let a;e.bytes.slice?a=e.bytes.slice():a=new Uint32Array(Array.prototype.slice.call(e.bytes)),i.postMessage(mp({source:n,encrypted:t,key:a,iv:e.iv}),[t.buffer,a.buffer])},dA=({decryptionWorker:n,segment:e,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:r,audioSegmentTimingInfoFn:s,id3Fn:a,captionsFn:o,isEndOfTimeline:l,endedTimelineFn:u,dataFn:d,doneFn:h,onTransmuxerLog:v})=>{Pp({id:e.requestId,key:e.key,encryptedBytes:e.encryptedBytes,decryptionWorker:n},x=>{e.bytes=x,Op({segment:e,bytes:e.bytes,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:r,audioSegmentTimingInfoFn:s,id3Fn:a,captionsFn:o,isEndOfTimeline:l,endedTimelineFn:u,dataFn:d,doneFn:h,onTransmuxerLog:v})})},cA=({activeXhrs:n,decryptionWorker:e,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:r,audioSegmentTimingInfoFn:s,id3Fn:a,captionsFn:o,isEndOfTimeline:l,endedTimelineFn:u,dataFn:d,doneFn:h,onTransmuxerLog:v})=>{let x=0,_=!1;return(R,N)=>{if(!_){if(R)return _=!0,rc(n),h(R,N);if(x+=1,x===n.length){const z=function(){if(N.encryptedBytes)return dA({decryptionWorker:e,segment:N,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:r,audioSegmentTimingInfoFn:s,id3Fn:a,captionsFn:o,isEndOfTimeline:l,endedTimelineFn:u,dataFn:d,doneFn:h,onTransmuxerLog:v});Op({segment:N,bytes:N.bytes,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:r,audioSegmentTimingInfoFn:s,id3Fn:a,captionsFn:o,isEndOfTimeline:l,endedTimelineFn:u,dataFn:d,doneFn:h,onTransmuxerLog:v})};if(N.endOfAllRequests=Date.now(),N.map&&N.map.encryptedBytes&&!N.map.bytes)return Pp({decryptionWorker:e,id:N.requestId+"-init",encryptedBytes:N.map.encryptedBytes,key:N.map.key},J=>{N.map.bytes=J,Rp(N,ue=>{if(ue)return rc(n),h(ue,N);z()})});z()}}}},hA=({loadendState:n,abortFn:e})=>t=>{t.target.aborted&&e&&!n.calledAbortFn&&(e(),n.calledAbortFn=!0)},fA=({segment:n,progressFn:e,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:r,audioSegmentTimingInfoFn:s,id3Fn:a,captionsFn:o,isEndOfTimeline:l,endedTimelineFn:u,dataFn:d})=>h=>{if(!h.target.aborted)return n.stats=ci(n.stats,aA(h)),!n.stats.firstBytesReceivedAt&&n.stats.bytesReceived&&(n.stats.firstBytesReceivedAt=Date.now()),e(h,n)},pA=({xhr:n,xhrOptions:e,decryptionWorker:t,segment:i,abortFn:r,progressFn:s,trackInfoFn:a,timingInfoFn:o,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:u,id3Fn:d,captionsFn:h,isEndOfTimeline:v,endedTimelineFn:x,dataFn:_,doneFn:R,onTransmuxerLog:N})=>{const z=[],J=cA({activeXhrs:z,decryptionWorker:t,trackInfoFn:a,timingInfoFn:o,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:u,id3Fn:d,captionsFn:h,isEndOfTimeline:v,endedTimelineFn:x,dataFn:_,doneFn:R,onTransmuxerLog:N});if(i.key&&!i.key.bytes){const we=[i.key];i.map&&!i.map.bytes&&i.map.key&&i.map.key.resolvedUri===i.key.resolvedUri&&we.push(i.map.key);const Ge=ci(e,{uri:i.key.resolvedUri,responseType:"arraybuffer"}),Ve=Ip(i,we,J),Fe=n(Ge,Ve);z.push(Fe)}if(i.map&&!i.map.bytes){if(i.map.key&&(!i.key||i.key.resolvedUri!==i.map.key.resolvedUri)){const mt=ci(e,{uri:i.map.key.resolvedUri,responseType:"arraybuffer"}),et=Ip(i,[i.map.key],J),nt=n(mt,et);z.push(nt)}const Ge=ci(e,{uri:i.map.resolvedUri,responseType:"arraybuffer",headers:ec(i.map)}),Ve=oA({segment:i,finishProcessingFn:J}),Fe=n(Ge,Ve);z.push(Fe)}const ue=ci(e,{uri:i.part&&i.part.resolvedUri||i.resolvedUri,responseType:"arraybuffer",headers:ec(i)}),pe=lA({segment:i,finishProcessingFn:J,responseType:ue.responseType}),te=n(ue,pe);te.addEventListener("progress",fA({segment:i,progressFn:s,trackInfoFn:a,timingInfoFn:o,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:u,id3Fn:d,captionsFn:h,isEndOfTimeline:v,endedTimelineFn:x,dataFn:_})),z.push(te);const ke={};return z.forEach(we=>{we.addEventListener("loadend",hA({loadendState:ke,abortFn:r}))}),()=>rc(z)},mA=tr("CodecUtils"),gA=function(n){const e=n.attributes||{};if(e.CODECS)return st(e.CODECS)},Bp=(n,e)=>{const t=e.attributes||{};return n&&n.mediaGroups&&n.mediaGroups.AUDIO&&t.AUDIO&&n.mediaGroups.AUDIO[t.AUDIO]},yA=(n,e)=>{if(!Bp(n,e))return!0;const t=e.attributes||{},i=n.mediaGroups.AUDIO[t.AUDIO];for(const r in i)if(!i[r].uri&&!i[r].playlists)return!0;return!1},El=function(n){const e={};return n.forEach(({mediaType:t,type:i,details:r})=>{e[t]=e[t]||[],e[t].push(xe(`${i}${r}`))}),Object.keys(e).forEach(function(t){if(e[t].length>1){mA(`multiple ${t} codecs found as attributes: ${e[t].join(", ")}. Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs.`),e[t]=null;return}e[t]=e[t][0]}),e},Fp=function(n){let e=0;return n.audio&&e++,n.video&&e++,e},oo=function(n,e){const t=e.attributes||{},i=El(gA(e)||[]);if(Bp(n,e)&&!i.audio&&!yA(n,e)){const r=El(Xe(n,t.AUDIO)||[]);r.audio&&(i.audio=r.audio)}return i},Tl=tr("PlaylistSelector"),Mp=function(n){if(!n||!n.playlist)return;const e=n.playlist;return JSON.stringify({id:e.id,bandwidth:n.bandwidth,width:n.width,height:n.height,codecs:e.attributes&&e.attributes.CODECS||""})},Sl=function(n,e){if(!n)return"";const t=q().getComputedStyle(n);return t?t[e]:""},_a=function(n,e){const t=n.slice();n.sort(function(i,r){const s=e(i,r);return s===0?t.indexOf(i)-t.indexOf(r):s})},ac=function(n,e){let t,i;return n.attributes.BANDWIDTH&&(t=n.attributes.BANDWIDTH),t=t||q().Number.MAX_VALUE,e.attributes.BANDWIDTH&&(i=e.attributes.BANDWIDTH),i=i||q().Number.MAX_VALUE,t-i},vA=function(n,e){let t,i;return n.attributes.RESOLUTION&&n.attributes.RESOLUTION.width&&(t=n.attributes.RESOLUTION.width),t=t||q().Number.MAX_VALUE,e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width&&(i=e.attributes.RESOLUTION.width),i=i||q().Number.MAX_VALUE,t===i&&n.attributes.BANDWIDTH&&e.attributes.BANDWIDTH?n.attributes.BANDWIDTH-e.attributes.BANDWIDTH:t-i};let Np=function(n,e,t,i,r,s){if(!n)return;const a={bandwidth:e,width:t,height:i,limitRenditionByPlayerDimensions:r};let o=n.playlists;fn.isAudioOnly(n)&&(o=s.getAudioTrackPlaylists_(),a.audioOnly=!0);let l=o.map(te=>{let ke;const we=te.attributes&&te.attributes.RESOLUTION&&te.attributes.RESOLUTION.width,Ge=te.attributes&&te.attributes.RESOLUTION&&te.attributes.RESOLUTION.height;return ke=te.attributes&&te.attributes.BANDWIDTH,ke=ke||q().Number.MAX_VALUE,{bandwidth:ke,width:we,height:Ge,playlist:te}});_a(l,(te,ke)=>te.bandwidth-ke.bandwidth),l=l.filter(te=>!fn.isIncompatible(te.playlist));let u=l.filter(te=>fn.isEnabled(te.playlist));u.length||(u=l.filter(te=>!fn.isDisabled(te.playlist)));const d=u.filter(te=>te.bandwidth*ji.BANDWIDTH_VARIANCE<e);let h=d[d.length-1];const v=d.filter(te=>te.bandwidth===h.bandwidth)[0];if(r===!1){const te=v||u[0]||l[0];if(te&&te.playlist){let ke="sortedPlaylistReps";return v&&(ke="bandwidthBestRep"),u[0]&&(ke="enabledPlaylistReps"),Tl(`choosing ${Mp(te)} using ${ke} with options`,a),te.playlist}return Tl("could not choose a playlist with options",a),null}const x=d.filter(te=>te.width&&te.height);_a(x,(te,ke)=>te.width-ke.width);const _=x.filter(te=>te.width===t&&te.height===i);h=_[_.length-1];const R=_.filter(te=>te.bandwidth===h.bandwidth)[0];let N,z,J;R||(N=x.filter(te=>te.width>t||te.height>i),z=N.filter(te=>te.width===N[0].width&&te.height===N[0].height),h=z[z.length-1],J=z.filter(te=>te.bandwidth===h.bandwidth)[0]);let ue;if(s.leastPixelDiffSelector){const te=x.map(ke=>(ke.pixelDiff=Math.abs(ke.width-t)+Math.abs(ke.height-i),ke));_a(te,(ke,we)=>ke.pixelDiff===we.pixelDiff?we.bandwidth-ke.bandwidth:ke.pixelDiff-we.pixelDiff),ue=te[0]}const pe=ue||J||R||v||u[0]||l[0];if(pe&&pe.playlist){let te="sortedPlaylistReps";return ue?te="leastPixelDiffRep":J?te="resolutionPlusOneRep":R?te="resolutionBestRep":v?te="bandwidthBestRep":u[0]&&(te="enabledPlaylistReps"),Tl(`choosing ${Mp(pe)} using ${te} with options`,a),pe.playlist}return Tl("could not choose a playlist with options",a),null};const Up=function(){const n=this.useDevicePixelRatio&&q().devicePixelRatio||1;return Np(this.playlists.main,this.systemBandwidth,parseInt(Sl(this.tech_.el(),"width"),10)*n,parseInt(Sl(this.tech_.el(),"height"),10)*n,this.limitRenditionByPlayerDimensions,this.playlistController_)},AA=function(n){let e=-1,t=-1;if(n<0||n>1)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){const i=this.useDevicePixelRatio&&q().devicePixelRatio||1;return e<0&&(e=this.systemBandwidth,t=this.systemBandwidth),this.systemBandwidth>0&&this.systemBandwidth!==t&&(e=n*this.systemBandwidth+(1-n)*e,t=this.systemBandwidth),Np(this.playlists.main,e,parseInt(Sl(this.tech_.el(),"width"),10)*i,parseInt(Sl(this.tech_.el(),"height"),10)*i,this.limitRenditionByPlayerDimensions,this.playlistController_)}},bA=function(n){const{main:e,currentTime:t,bandwidth:i,duration:r,segmentDuration:s,timeUntilRebuffer:a,currentTimeline:o,syncController:l}=n,u=e.playlists.filter(_=>!fn.isIncompatible(_));let d=u.filter(fn.isEnabled);d.length||(d=u.filter(_=>!fn.isDisabled(_)));const v=d.filter(fn.hasAttribute.bind(null,"BANDWIDTH")).map(_=>{const N=l.getSyncPoint(_,r,o,t)?1:2,J=fn.estimateSegmentRequestTime(s,i,_)*N-a;return{playlist:_,rebufferingImpact:J}}),x=v.filter(_=>_.rebufferingImpact<=0);return _a(x,(_,R)=>ac(R.playlist,_.playlist)),x.length?x[0]:(_a(v,(_,R)=>_.rebufferingImpact-R.rebufferingImpact),v[0]||null)},_A=function(){const n=this.playlists.main.playlists.filter(fn.isEnabled);return _a(n,(t,i)=>ac(t,i)),n.filter(t=>!!oo(this.playlists.main,t).video)[0]||null},xA=n=>{let e=0,t;return n.bytes&&(t=new Uint8Array(n.bytes),n.segments.forEach(i=>{t.set(i,e),e+=i.byteLength})),t},EA=function(n,e,t){if(!n[t]){e.trigger({type:"usage",name:"vhs-608"});let i=t;/^cc708_/.test(t)&&(i="SERVICE"+t.split("_")[1]);const r=e.textTracks().getTrackById(i);if(r)n[t]=r;else{const s=e.options_.vhs&&e.options_.vhs.captionServices||{};let a=t,o=t,l=!1;const u=s[i];u&&(a=u.label,o=u.language,l=u.default),n[t]=e.addRemoteTextTrack({kind:"captions",id:i,default:l,label:a,language:o},!1).track}}},TA=function({inbandTextTracks:n,captionArray:e,timestampOffset:t}){if(!e)return;const i=q().WebKitDataCue||q().VTTCue;e.forEach(r=>{const s=r.stream;n[s].addCue(new i(r.startTime+t,r.endTime+t,r.text))})},SA=function(n){Object.defineProperties(n.frame,{id:{get(){return Re.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),n.value.key}},value:{get(){return Re.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),n.value.data}},privateData:{get(){return Re.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),n.value.data}}})},CA=({inbandTextTracks:n,metadataArray:e,timestampOffset:t,videoDuration:i})=>{if(!e)return;const r=q().WebKitDataCue||q().VTTCue,s=n.metadataTrack_;if(!s||(e.forEach(d=>{const h=d.cueTime+t;typeof h!="number"||q().isNaN(h)||h<0||!(h<Infinity)||d.frames.forEach(v=>{const x=new r(h,h,v.value||v.url||v.data||"");x.frame=v,x.value=v,SA(x),s.addCue(x)})}),!s.cues||!s.cues.length))return;const a=s.cues,o=[];for(let d=0;d<a.length;d++)a[d]&&o.push(a[d]);const l=o.reduce((d,h)=>{const v=d[h.startTime]||[];return v.push(h),d[h.startTime]=v,d},{}),u=Object.keys(l).sort((d,h)=>Number(d)-Number(h));u.forEach((d,h)=>{const v=l[d],x=Number(u[h+1])||i;v.forEach(_=>{_.endTime=x})})},wA=(n,e,t)=>{n.metadataTrack_||(n.metadataTrack_=t.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,n.metadataTrack_.inBandMetadataTrackDispatchType=e)},lo=function(n,e,t){let i,r;if(!!t&&!!t.cues)for(i=t.cues.length;i--;)r=t.cues[i],r.startTime>=n&&r.endTime<=e&&t.removeCue(r)},LA=function(n){const e=n.cues;if(!!e)for(let t=0;t<e.length;t++){const i=[];let r=0;for(let s=0;s<e.length;s++)e[t].startTime===e[s].startTime&&e[t].endTime===e[s].endTime&&e[t].text===e[s].text&&(r++,r>1&&i.push(e[s]));i.length&&i.forEach(s=>n.removeCue(s))}},DA=(n,e,t)=>{if(typeof e=="undefined"||e===null||!n.length)return[];const i=Math.ceil((e-t+3)*ea.ONE_SECOND_IN_TS);let r;for(r=0;r<n.length&&!(n[r].pts>i);r++);return n.slice(r)},kA=(n,e,t)=>{if(!e.length)return n;if(t)return e.slice();const i=e[0].pts;let r=0;for(r;r<n.length&&!(n[r].pts>=i);r++);return n.slice(0,r).concat(e)},IA=(n,e,t,i)=>{const r=Math.ceil((e-i)*ea.ONE_SECOND_IN_TS),s=Math.ceil((t-i)*ea.ONE_SECOND_IN_TS),a=n.slice();let o=n.length;for(;o--&&!(n[o].pts<=s););if(o===-1)return a;let l=o+1;for(;l--&&!(n[l].pts<=r););return l=Math.max(l,0),a.splice(l,o-l+1),a},RA=function(n,e){if(!n&&!e||!n&&e||n&&!e)return!1;if(n===e)return!0;const t=Object.keys(n).sort(),i=Object.keys(e).sort();if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(s!==i[r]||n[s]!==e[s])return!1}return!0},jp=22,OA=function(n,e,t){e=e||[];const i=[];let r=0;for(let s=0;s<e.length;s++){const a=e[s];if(n===a.timeline&&(i.push(s),r+=a.duration,r>t))return s}return i.length===0?0:i[i.length-1]},uo=1,PA=500,$p=n=>typeof n=="number"&&isFinite(n),Cl=1/60,BA=(n,e,t)=>n!=="main"||!e||!t?null:!t.hasAudio&&!t.hasVideo?"Neither audio nor video found in segment.":e.hasVideo&&!t.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!e.hasVideo&&t.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null,FA=(n,e,t)=>{let i=e-ji.BACK_BUFFER_LENGTH;n.length&&(i=Math.max(i,n.start(0)));const r=e-t;return Math.min(r,i)},xa=n=>{const{startOfSegment:e,duration:t,segment:i,part:r,playlist:{mediaSequence:s,id:a,segments:o=[]},mediaIndex:l,partIndex:u,timeline:d}=n,h=o.length-1;let v="mediaIndex/partIndex increment";n.getMediaInfoForTime?v=`getMediaInfoForTime (${n.getMediaInfoForTime})`:n.isSyncRequest&&(v="getSyncSegmentCandidate (isSyncRequest)"),n.independent&&(v+=` with independent ${n.independent}`);const x=typeof u=="number",_=n.segment.uri?"segment":"pre-segment",R=x?ep({preloadSegment:i})-1:0;return`${_} [${s+l}/${s+h}]`+(x?` part [${u}/${R}]`:"")+` segment start/end [${i.start} => ${i.end}]`+(x?` part start/end [${r.start} => ${r.end}]`:"")+` startOfSegment [${e}] duration [${t}] timeline [${d}] selected by [${v}] playlist [${a}]`},Gp=n=>`${n}TimingInfo`,MA=({segmentTimeline:n,currentTimeline:e,startOfSegment:t,buffered:i,overrideCheck:r})=>!r&&n===e?null:n<e?t:i.length?i.end(i.length-1):t,Vp=({timelineChangeController:n,currentTimeline:e,segmentTimeline:t,loaderType:i,audioDisabled:r})=>{if(e===t)return!1;if(i==="audio"){const s=n.lastTimelineChange({type:"main"});return!s||s.to!==t}if(i==="main"&&r){const s=n.pendingTimelineChange({type:"audio"});return!(s&&s.to===t)}return!1},NA=n=>{let e=0;return["video","audio"].forEach(function(t){const i=n[`${t}TimingInfo`];if(!i)return;const{start:r,end:s}=i;let a;typeof r=="bigint"||typeof s=="bigint"?a=q().BigInt(s)-q().BigInt(r):typeof r=="number"&&typeof s=="number"&&(a=s-r),typeof a!="undefined"&&a>e&&(e=a)}),typeof e=="bigint"&&e<Number.MAX_SAFE_INTEGER&&(e=Number(e)),e},Hp=({segmentDuration:n,maxDuration:e})=>n?Math.round(n)>e+cs:!1,UA=(n,e)=>{if(e!=="hls")return null;const t=NA({audioTimingInfo:n.audioTimingInfo,videoTimingInfo:n.videoTimingInfo});if(!t)return null;const i=n.playlist.targetDuration,r=Hp({segmentDuration:t,maxDuration:i*2}),s=Hp({segmentDuration:t,maxDuration:i}),a=`Segment with index ${n.mediaIndex} from playlist ${n.playlist.id} has a duration of ${t} when the reported duration is ${n.duration} and the target duration is ${i}. For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1`;return r||s?{severity:r?"warn":"info",message:a}:null};class oc extends Re.EventTarget{constructor(e,t={}){super();if(!e)throw new TypeError("Initialization settings are required");if(typeof e.currentTime!="function")throw new TypeError("No currentTime getter specified");if(!e.mediaSource)throw new TypeError("No MediaSource specified");this.bandwidth=e.bandwidth,this.throughput={rate:0,count:0},this.roundTrip=NaN,this.resetStats_(),this.mediaIndex=null,this.partIndex=null,this.hasPlayed_=e.hasPlayed,this.currentTime_=e.currentTime,this.seekable_=e.seekable,this.seeking_=e.seeking,this.duration_=e.duration,this.mediaSource_=e.mediaSource,this.vhs_=e.vhs,this.loaderType_=e.loaderType,this.currentMediaInfo_=void 0,this.startingMediaInfo_=void 0,this.segmentMetadataTrack_=e.segmentMetadataTrack,this.goalBufferLength_=e.goalBufferLength,this.sourceType_=e.sourceType,this.sourceUpdater_=e.sourceUpdater,this.inbandTextTracks_=e.inbandTextTracks,this.state_="INIT",this.timelineChangeController_=e.timelineChangeController,this.shouldSaveSegmentTimingInfo_=!0,this.parse708captions_=e.parse708captions,this.useDtsForTimestampOffset_=e.useDtsForTimestampOffset,this.captionServices_=e.captionServices,this.exactManifestTimings=e.exactManifestTimings,this.checkBufferTimeout_=null,this.error_=void 0,this.currentTimeline_=-1,this.pendingSegment_=null,this.xhrOptions_=null,this.pendingSegments_=[],this.audioDisabled_=!1,this.isPendingTimestampOffset_=!1,this.gopBuffer_=[],this.timeMapping_=0,this.safeAppend_=Re.browser.IE_VERSION>=11,this.appendInitSegment_={audio:!0,video:!0},this.playlistOfLastInitSegment_={audio:null,video:null},this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_={id3:[],caption:[]},this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=null,this.activeInitSegmentId_=null,this.initSegments_={},this.cacheEncryptionKeys_=e.cacheEncryptionKeys,this.keyCache_={},this.decrypter_=e.decrypter,this.syncController_=e.syncController,this.syncPoint_={segmentIndex:0,time:0},this.transmuxer_=this.createTransmuxer_(),this.triggerSyncInfoUpdate_=()=>this.trigger("syncinfoupdate"),this.syncController_.on("syncinfoupdate",this.triggerSyncInfoUpdate_),this.mediaSource_.addEventListener("sourceopen",()=>{this.isEndOfStream_()||(this.ended_=!1)}),this.fetchAtBuffer_=!1,this.logger_=tr(`SegmentLoader[${this.loaderType_}]`),Object.defineProperty(this,"state",{get(){return this.state_},set(i){i!==this.state_&&(this.logger_(`${this.state_} -> ${i}`),this.state_=i,this.trigger("statechange"))}}),this.sourceUpdater_.on("ready",()=>{this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}),this.loaderType_==="main"&&this.timelineChangeController_.on("pendingtimelinechange",()=>{this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}),this.loaderType_==="audio"&&this.timelineChangeController_.on("timelinechange",()=>{this.hasEnoughInfoToLoad_()&&this.processLoadQueue_(),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()})}createTransmuxer_(){return nc.createTransmuxer({remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,parse708captions:this.parse708captions_,captionServices:this.captionServices_})}resetStats_(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0,this.mediaAppends=0}dispose(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&this.transmuxer_.terminate(),this.resetStats_(),this.checkBufferTimeout_&&q().clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()}setAudio(e){this.audioDisabled_=!e,e?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())}abort(){if(this.state!=="WAITING"){this.pendingSegment_&&(this.pendingSegment_=null);return}this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()}abort_(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_),this.waitingOnRemove_=!1,q().clearTimeout(this.quotaExceededErrorRetryTimeout_),this.quotaExceededErrorRetryTimeout_=null}checkForAbort_(e){return this.state==="APPENDING"&&!this.pendingSegment_?(this.state="READY",!0):!this.pendingSegment_||this.pendingSegment_.requestId!==e}error(e){return typeof e!="undefined"&&(this.logger_("error occurred:",e),this.error_=e),this.pendingSegment_=null,this.error_}endOfStream(){this.ended_=!0,this.transmuxer_&&nc.reset(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")}buffered_(){const e=this.getMediaInfo_();if(!this.sourceUpdater_||!e)return Qi();if(this.loaderType_==="main"){const{hasAudio:t,hasVideo:i,isMuxed:r}=e;if(i&&t&&!this.audioDisabled_&&!r)return this.sourceUpdater_.buffered();if(i)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()}initSegmentForMap(e,t=!1){if(!e)return null;const i=_l(e);let r=this.initSegments_[i];return t&&!r&&e.bytes&&(this.initSegments_[i]=r={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,tracks:e.tracks,timescales:e.timescales}),r||e}segmentKey(e,t=!1){if(!e)return null;const i=gp(e);let r=this.keyCache_[i];this.cacheEncryptionKeys_&&t&&!r&&e.bytes&&(this.keyCache_[i]=r={resolvedUri:e.resolvedUri,bytes:e.bytes});const s={resolvedUri:(r||e).resolvedUri};return r&&(s.bytes=r.bytes),s}couldBeginLoading_(){return this.playlist_&&!this.paused()}load(){if(this.monitorBuffer_(),!!this.playlist_){if(this.state==="INIT"&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||this.state!=="READY"&&this.state!=="INIT"||(this.state="READY")}}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}playlist(e,t={}){if(!e)return;const i=this.playlist_,r=this.pendingSegment_;this.playlist_=e,this.xhrOptions_=t,this.state==="INIT"&&(e.syncInfo={mediaSequence:e.mediaSequence,time:0},this.loaderType_==="main"&&this.syncController_.setDateTimeMappingForStart(e));let s=null;if(i&&(i.id?s=i.id:i.uri&&(s=i.uri)),this.logger_(`playlist update [${s} => ${e.id||e.uri}]`),this.trigger("syncinfoupdate"),this.state==="INIT"&&this.couldBeginLoading_())return this.init_();if(!i||i.uri!==e.uri){this.mediaIndex!==null&&(e.endList?this.resyncLoader():this.resetLoader()),this.currentMediaInfo_=void 0,this.trigger("playlistupdate");return}const a=e.mediaSequence-i.mediaSequence;if(this.logger_(`live window shift [${a}]`),this.mediaIndex!==null)if(this.mediaIndex-=a,this.mediaIndex<0)this.mediaIndex=null,this.partIndex=null;else{const o=this.playlist_.segments[this.mediaIndex];if(this.partIndex&&(!o.parts||!o.parts.length||!o.parts[this.partIndex])){const l=this.mediaIndex;this.logger_(`currently processing part (index ${this.partIndex}) no longer exists.`),this.resetLoader(),this.mediaIndex=l}}r&&(r.mediaIndex-=a,r.mediaIndex<0?(r.mediaIndex=null,r.partIndex=null):(r.mediaIndex>=0&&(r.segment=e.segments[r.mediaIndex]),r.partIndex>=0&&r.segment.parts&&(r.part=r.segment.parts[r.partIndex]))),this.syncController_.saveExpiredSegmentInfo(i,e)}pause(){this.checkBufferTimeout_&&(q().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}paused(){return this.checkBufferTimeout_===null}resetEverything(e){this.ended_=!1,this.activeInitSegmentId_=null,this.appendInitSegment_={audio:!0,video:!0},this.resetLoader(),this.remove(0,Infinity,e),this.transmuxer_&&(this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.transmuxer_.postMessage({action:"reset"}))}resetLoader(){this.fetchAtBuffer_=!1,this.resyncLoader()}resyncLoader(){this.transmuxer_&&nc.reset(this.transmuxer_),this.mediaIndex=null,this.partIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}remove(e,t,i=()=>{},r=!1){if(t===Infinity&&(t=this.duration_()),t<=e){this.logger_("skipping remove because end ${end} is <= start ${start}");return}if(!this.sourceUpdater_||!this.getMediaInfo_()){this.logger_("skipping remove because no source updater or starting media info");return}let s=1;const a=()=>{s--,s===0&&i()};(r||!this.audioDisabled_)&&(s++,this.sourceUpdater_.removeAudio(e,t,a)),(r||this.loaderType_==="main")&&(this.gopBuffer_=IA(this.gopBuffer_,e,t,this.timeMapping_),s++,this.sourceUpdater_.removeVideo(e,t,a));for(const o in this.inbandTextTracks_)lo(e,t,this.inbandTextTracks_[o]);lo(e,t,this.segmentMetadataTrack_),a()}monitorBuffer_(){this.checkBufferTimeout_&&q().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=q().setTimeout(this.monitorBufferTick_.bind(this),1)}monitorBufferTick_(){this.state==="READY"&&this.fillBuffer_(),this.checkBufferTimeout_&&q().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=q().setTimeout(this.monitorBufferTick_.bind(this),PA)}fillBuffer_(){if(this.sourceUpdater_.updating())return;const e=this.chooseNextRequest_();!e||(typeof e.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!1,this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline})),this.loadSegment_(e))}isEndOfStream_(e=this.mediaIndex,t=this.playlist_,i=this.partIndex){if(!t||!this.mediaSource_)return!1;const r=typeof e=="number"&&t.segments[e],s=e+1===t.segments.length,a=!r||!r.parts||i+1===r.parts.length;return t.endList&&this.mediaSource_.readyState==="open"&&s&&a}chooseNextRequest_(){const e=this.buffered_(),t=Zf(e)||0,i=Hd(e,this.currentTime_()),r=!this.hasPlayed_()&&i>=1,s=i>=this.goalBufferLength_(),a=this.playlist_.segments;if(!a.length||r||s)return null;this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_());const o={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:Boolean(!this.syncPoint_)};if(o.isSyncRequest)o.mediaIndex=OA(this.currentTimeline_,a,t);else if(this.mediaIndex!==null){const h=a[this.mediaIndex],v=typeof this.partIndex=="number"?this.partIndex:-1;o.startOfSegment=h.end?h.end:t,h.parts&&h.parts[v+1]?(o.mediaIndex=this.mediaIndex,o.partIndex=v+1):o.mediaIndex=this.mediaIndex+1}else{const{segmentIndex:h,startTime:v,partIndex:x}=fn.getMediaInfoForTime({exactManifestTimings:this.exactManifestTimings,playlist:this.playlist_,currentTime:this.fetchAtBuffer_?t:this.currentTime_(),startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time});o.getMediaInfoForTime=this.fetchAtBuffer_?`bufferedEnd ${t}`:`currentTime ${this.currentTime_()}`,o.mediaIndex=h,o.startOfSegment=v,o.partIndex=x}const l=a[o.mediaIndex];let u=l&&typeof o.partIndex=="number"&&l.parts&&l.parts[o.partIndex];if(!l||typeof o.partIndex=="number"&&!u)return null;if(typeof o.partIndex!="number"&&l.parts&&(o.partIndex=0,u=l.parts[0]),!i&&u&&!u.independent)if(o.partIndex===0){const h=a[o.mediaIndex-1],v=h.parts&&h.parts.length&&h.parts[h.parts.length-1];v&&v.independent&&(o.mediaIndex-=1,o.partIndex=h.parts.length-1,o.independent="previous segment")}else l.parts[o.partIndex-1].independent&&(o.partIndex-=1,o.independent="previous part");const d=this.mediaSource_&&this.mediaSource_.readyState==="ended";return o.mediaIndex>=a.length-1&&d&&!this.seeking_()?null:this.generateSegmentInfo_(o)}generateSegmentInfo_(e){const{independent:t,playlist:i,mediaIndex:r,startOfSegment:s,isSyncRequest:a,partIndex:o,forceTimestampOffset:l,getMediaInfoForTime:u}=e,d=i.segments[r],h=typeof o=="number"&&d.parts[o],v={requestId:"segment-loader-"+Math.random(),uri:h&&h.resolvedUri||d.resolvedUri,mediaIndex:r,partIndex:h?o:null,isSyncRequest:a,startOfSegment:s,playlist:i,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:d.timeline,duration:h&&h.duration||d.duration,segment:d,part:h,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:u,independent:t},x=typeof l!="undefined"?l:this.isPendingTimestampOffset_;v.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:d.timeline,currentTimeline:this.currentTimeline_,startOfSegment:s,buffered:this.buffered_(),overrideCheck:x});const _=Zf(this.sourceUpdater_.audioBuffered());return typeof _=="number"&&(v.audioAppendStart=_-this.sourceUpdater_.audioTimestampOffset()),this.sourceUpdater_.videoBuffered().length&&(v.gopsToAlignWith=DA(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),v}timestampOffsetForSegment_(e){return MA(e)}earlyAbortWhenNeeded_(e){if(this.vhs_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH||Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)return;const t=this.currentTime_(),i=e.bandwidth,r=this.pendingSegment_.duration,s=fn.estimateSegmentRequestTime(r,i,this.playlist_,e.bytesReceived),a=cv(this.buffered_(),t,this.vhs_.tech_.playbackRate())-1;if(s<=a)return;const o=bA({main:this.vhs_.playlists.main,currentTime:t,bandwidth:i,duration:this.duration_(),segmentDuration:r,timeUntilRebuffer:a,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(!o)return;const u=s-a-o.rebufferingImpact;let d=.5;a<=cs&&(d=1),!(!o.playlist||o.playlist.uri===this.playlist_.uri||u<d)&&(this.bandwidth=o.playlist.attributes.BANDWIDTH*ji.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort"))}handleAbort_(e){this.logger_(`Aborting ${xa(e)}`),this.mediaRequestsAborted+=1}handleProgress_(e,t){this.earlyAbortWhenNeeded_(t.stats),!this.checkForAbort_(t.requestId)&&this.trigger("progress")}handleTrackInfo_(e,t){this.earlyAbortWhenNeeded_(e.stats),!this.checkForAbort_(e.requestId)&&(this.checkForIllegalMediaSwitch(t)||(t=t||{},RA(this.currentMediaInfo_,t)||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=t,this.currentMediaInfo_=t,this.logger_("trackinfo update",t),this.trigger("trackinfo")),!this.checkForAbort_(e.requestId)&&(this.pendingSegment_.trackInfo=t,this.hasEnoughInfoToAppend_()&&this.processCallQueue_())))}handleTimingInfo_(e,t,i,r){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;const s=this.pendingSegment_,a=Gp(t);s[a]=s[a]||{},s[a][i]=r,this.logger_(`timinginfo: ${t} - ${i} - ${r}`),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}handleCaptions_(e,t){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(t.length===0){this.logger_("SegmentLoader received no captions from a caption event");return}if(!this.pendingSegment_.hasAppendedData_){this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,e,t));return}const r=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),s={};t.forEach(a=>{s[a.stream]=s[a.stream]||{startTime:Infinity,captions:[],endTime:0};const o=s[a.stream];o.startTime=Math.min(o.startTime,a.startTime+r),o.endTime=Math.max(o.endTime,a.endTime+r),o.captions.push(a)}),Object.keys(s).forEach(a=>{const{startTime:o,endTime:l,captions:u}=s[a],d=this.inbandTextTracks_;this.logger_(`adding cues from ${o} -> ${l} for ${a}`),EA(d,this.vhs_.tech_,a),lo(o,l,d[a]),TA({captionArray:u,inbandTextTracks:d,timestampOffset:r})}),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}handleId3_(e,t,i){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(!this.pendingSegment_.hasAppendedData_){this.metadataQueue_.id3.push(this.handleId3_.bind(this,e,t,i));return}const s=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset();wA(this.inbandTextTracks_,i,this.vhs_.tech_),CA({inbandTextTracks:this.inbandTextTracks_,metadataArray:t,timestampOffset:s,videoDuration:this.duration_()})}processMetadataQueue_(){this.metadataQueue_.id3.forEach(e=>e()),this.metadataQueue_.caption.forEach(e=>e()),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]}processCallQueue_(){const e=this.callQueue_;this.callQueue_=[],e.forEach(t=>t())}processLoadQueue_(){const e=this.loadQueue_;this.loadQueue_=[],e.forEach(t=>t())}hasEnoughInfoToLoad_(){if(this.loaderType_!=="audio")return!0;const e=this.pendingSegment_;return e?this.getCurrentMediaInfo_()?!Vp({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}):!0:!1}getCurrentMediaInfo_(e=this.pendingSegment_){return e&&e.trackInfo||this.currentMediaInfo_}getMediaInfo_(e=this.pendingSegment_){return this.getCurrentMediaInfo_(e)||this.startingMediaInfo_}getPendingSegmentPlaylist(){return this.pendingSegment_?this.pendingSegment_.playlist:null}hasEnoughInfoToAppend_(){if(!this.sourceUpdater_.ready()||this.waitingOnRemove_||this.quotaExceededErrorRetryTimeout_)return!1;const e=this.pendingSegment_,t=this.getCurrentMediaInfo_();if(!e||!t)return!1;const{hasAudio:i,hasVideo:r,isMuxed:s}=t;return!(r&&!e.videoTimingInfo||i&&!this.audioDisabled_&&!s&&!e.audioTimingInfo||Vp({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))}handleData_(e,t){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(this.callQueue_.length||!this.hasEnoughInfoToAppend_()){this.callQueue_.push(this.handleData_.bind(this,e,t));return}const i=this.pendingSegment_;if(this.setTimeMapping_(i.timeline),this.updateMediaSecondsLoaded_(i.part||i.segment),this.mediaSource_.readyState!=="closed"){if(e.map&&(e.map=this.initSegmentForMap(e.map,!0),i.segment.map=e.map),e.key&&this.segmentKey(e.key,!0),i.isFmp4=e.isFmp4,i.timingInfo=i.timingInfo||{},i.isFmp4)this.trigger("fmp4"),i.timingInfo.start=i[Gp(t.type)].start;else{const r=this.getCurrentMediaInfo_(),s=this.loaderType_==="main"&&r&&r.hasVideo;let a;s&&(a=i.videoTimingInfo.start),i.timingInfo.start=this.trueSegmentStart_({currentStart:i.timingInfo.start,playlist:i.playlist,mediaIndex:i.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:s,firstVideoFrameTimeForData:a,videoTimingInfo:i.videoTimingInfo,audioTimingInfo:i.audioTimingInfo})}if(this.updateAppendInitSegmentStatus(i,t.type),this.updateSourceBufferTimestampOffset_(i),i.isSyncRequest){this.updateTimingInfoEnd_(i),this.syncController_.saveSegmentTimingInfo({segmentInfo:i,shouldSaveTimelineMapping:this.loaderType_==="main"});const r=this.chooseNextRequest_();if(r.mediaIndex!==i.mediaIndex||r.partIndex!==i.partIndex){this.logger_("sync segment was incorrect, not appending");return}this.logger_("sync segment was correct, appending")}i.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(i,t)}}updateAppendInitSegmentStatus(e,t){this.loaderType_==="main"&&typeof e.timestampOffset=="number"&&!e.changedTimestampOffset&&(this.appendInitSegment_={audio:!0,video:!0}),this.playlistOfLastInitSegment_[t]!==e.playlist&&(this.appendInitSegment_[t]=!0)}getInitSegmentAndUpdateState_({type:e,initSegment:t,map:i,playlist:r}){if(i){const s=_l(i);if(this.activeInitSegmentId_===s)return null;t=this.initSegmentForMap(i,!0).bytes,this.activeInitSegmentId_=s}return t&&this.appendInitSegment_[e]?(this.playlistOfLastInitSegment_[e]=r,this.appendInitSegment_[e]=!1,this.activeInitSegmentId_=null,t):null}handleQuotaExceededError_({segmentInfo:e,type:t,bytes:i},r){const s=this.sourceUpdater_.audioBuffered(),a=this.sourceUpdater_.videoBuffered();s.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+Os(s).join(", ")),a.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+Os(a).join(", "));const o=s.length?s.start(0):0,l=s.length?s.end(s.length-1):0,u=a.length?a.start(0):0,d=a.length?a.end(a.length-1):0;if(l-o<=uo&&d-u<=uo){this.logger_(`On QUOTA_EXCEEDED_ERR, single segment too large to append to buffer, triggering an error. Appended byte length: ${i.byteLength}, audio buffer: ${Os(s).join(", ")}, video buffer: ${Os(a).join(", ")}, `),this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:Infinity}),this.trigger("error");return}this.waitingOnRemove_=!0,this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:e,type:t,bytes:i}));const v=this.currentTime_()-uo;this.logger_(`On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to ${v}`),this.remove(0,v,()=>{this.logger_(`On QUOTA_EXCEEDED_ERR, retrying append in ${uo}s`),this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=q().setTimeout(()=>{this.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue"),this.quotaExceededErrorRetryTimeout_=null,this.processCallQueue_()},uo*1e3)},!0)}handleAppendError_({segmentInfo:e,type:t,bytes:i},r){if(!!r){if(r.code===jp){this.handleQuotaExceededError_({segmentInfo:e,type:t,bytes:i});return}this.logger_("Received non QUOTA_EXCEEDED_ERR on append",r),this.error(`${t} append of ${i.length}b failed for segment #${e.mediaIndex} in playlist ${e.playlist.id}`),this.trigger("appenderror")}}appendToSourceBuffer_({segmentInfo:e,type:t,initSegment:i,data:r,bytes:s}){if(!s){const a=[r];let o=r.byteLength;i&&(a.unshift(i),o+=i.byteLength),s=xA({bytes:o,segments:a})}this.sourceUpdater_.appendBuffer({segmentInfo:e,type:t,bytes:s},this.handleAppendError_.bind(this,{segmentInfo:e,type:t,bytes:s}))}handleSegmentTimingInfo_(e,t,i){if(!this.pendingSegment_||t!==this.pendingSegment_.requestId)return;const r=this.pendingSegment_.segment,s=`${e}TimingInfo`;r[s]||(r[s]={}),r[s].transmuxerPrependedSeconds=i.prependedContentDuration||0,r[s].transmuxedPresentationStart=i.start.presentation,r[s].transmuxedDecodeStart=i.start.decode,r[s].transmuxedPresentationEnd=i.end.presentation,r[s].transmuxedDecodeEnd=i.end.decode,r[s].baseMediaDecodeTime=i.baseMediaDecodeTime}appendData_(e,t){const{type:i,data:r}=t;if(!r||!r.byteLength||i==="audio"&&this.audioDisabled_)return;const s=this.getInitSegmentAndUpdateState_({type:i,initSegment:t.initSegment,playlist:e.playlist,map:e.isFmp4?e.segment.map:null});this.appendToSourceBuffer_({segmentInfo:e,type:i,initSegment:s,data:r})}loadSegment_(e){if(this.state="WAITING",this.pendingSegment_=e,this.trimBackBuffer_(e),typeof e.timestampOffset=="number"&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),!this.hasEnoughInfoToLoad_()){this.loadQueue_.push(()=>{const t=(0,B.Z)({},e,{forceTimestampOffset:!0});(0,B.Z)(e,this.generateSegmentInfo_(t)),this.isPendingTimestampOffset_=!1,this.updateTransmuxerAndRequestSegment_(e)});return}this.updateTransmuxerAndRequestSegment_(e)}updateTransmuxerAndRequestSegment_(e){this.shouldUpdateTransmuxerTimestampOffset_(e.timestampOffset)&&(this.gopBuffer_.length=0,e.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e.timestampOffset}));const t=this.createSimplifiedSegmentObj_(e),i=this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex),r=this.mediaIndex!==null,s=e.timeline!==this.currentTimeline_&&e.timeline>0,a=i||r&&s;this.logger_(`Requesting ${xa(e)}`),t.map&&!t.map.bytes&&(this.logger_("going to request init segment."),this.appendInitSegment_={video:!0,audio:!0}),e.abortRequests=pA({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:t,abortFn:this.handleAbort_.bind(this,e),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",e.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",e.requestId),captionsFn:this.handleCaptions_.bind(this),isEndOfTimeline:a,endedTimelineFn:()=>{this.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this),onTransmuxerLog:({message:o,level:l,stream:u})=>{this.logger_(`${xa(e)} logged from transmuxer stream ${u} as a ${l}: ${o}`)}})}trimBackBuffer_(e){const t=FA(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);t>0&&this.remove(0,t)}createSimplifiedSegmentObj_(e){const t=e.segment,i=e.part,r={resolvedUri:i?i.resolvedUri:t.resolvedUri,byterange:i?i.byterange:t.byterange,requestId:e.requestId,transmuxer:e.transmuxer,audioAppendStart:e.audioAppendStart,gopsToAlignWith:e.gopsToAlignWith,part:e.part},s=e.playlist.segments[e.mediaIndex-1];if(s&&s.timeline===t.timeline&&(s.videoTimingInfo?r.baseStartTime=s.videoTimingInfo.transmuxedDecodeEnd:s.audioTimingInfo&&(r.baseStartTime=s.audioTimingInfo.transmuxedDecodeEnd)),t.key){const a=t.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);r.key=this.segmentKey(t.key),r.key.iv=a}return t.map&&(r.map=this.initSegmentForMap(t.map)),r}saveTransferStats_(e){this.mediaRequests+=1,e&&(this.mediaBytesTransferred+=e.bytesReceived,this.mediaTransferDuration+=e.roundTripTime)}saveBandwidthRelatedStats_(e,t){if(this.pendingSegment_.byteLength=t.bytesReceived,e<Cl){this.logger_(`Ignoring segment's bandwidth because its duration of ${e} is less than the min to record ${Cl}`);return}this.bandwidth=t.bandwidth,this.roundTrip=t.roundTripTime}handleTimeout_(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate"),this.trigger("timeout")}segmentRequestFinished_(e,t,i){if(this.callQueue_.length){this.callQueue_.push(this.segmentRequestFinished_.bind(this,e,t,i));return}if(this.saveTransferStats_(t.stats),!this.pendingSegment_||t.requestId!==this.pendingSegment_.requestId)return;if(e){if(this.pendingSegment_=null,this.state="READY",e.code===br.ABORTED)return;if(this.pause(),e.code===br.TIMEOUT){this.handleTimeout_();return}this.mediaRequestsErrored+=1,this.error(e),this.trigger("error");return}const r=this.pendingSegment_;this.saveBandwidthRelatedStats_(r.duration,t.stats),r.endOfAllRequests=t.endOfAllRequests,i.gopInfo&&(this.gopBuffer_=kA(this.gopBuffer_,i.gopInfo,this.safeAppend_)),this.state="APPENDING",this.trigger("appending"),this.waitForAppendsToComplete_(r)}setTimeMapping_(e){const t=this.syncController_.mappingForTimeline(e);t!==null&&(this.timeMapping_=t)}updateMediaSecondsLoaded_(e){typeof e.start=="number"&&typeof e.end=="number"?this.mediaSecondsLoaded+=e.end-e.start:this.mediaSecondsLoaded+=e.duration}shouldUpdateTransmuxerTimestampOffset_(e){return e===null?!1:this.loaderType_==="main"&&e!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&e!==this.sourceUpdater_.audioTimestampOffset()}trueSegmentStart_({currentStart:e,playlist:t,mediaIndex:i,firstVideoFrameTimeForData:r,currentVideoTimestampOffset:s,useVideoTimingInfo:a,videoTimingInfo:o,audioTimingInfo:l}){if(typeof e!="undefined")return e;if(!a)return l.start;const u=t.segments[i-1];return i===0||!u||typeof u.start=="undefined"||u.end!==r+s?r:o.start}waitForAppendsToComplete_(e){const t=this.getCurrentMediaInfo_(e);if(!t){this.error({message:"No starting media returned, likely due to an unsupported media format.",playlistExclusionDuration:Infinity}),this.trigger("error");return}const{hasAudio:i,hasVideo:r,isMuxed:s}=t,a=this.loaderType_==="main"&&r,o=!this.audioDisabled_&&i&&!s;if(e.waitingOnAppends=0,!e.hasAppendedData_){!e.timingInfo&&typeof e.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!0),e.timingInfo={start:0},e.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(e),this.processMetadataQueue_()),this.checkAppendsDone_(e);return}a&&e.waitingOnAppends++,o&&e.waitingOnAppends++,a&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,e)),o&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,e))}checkAppendsDone_(e){this.checkForAbort_(e.requestId)||(e.waitingOnAppends--,e.waitingOnAppends===0&&this.handleAppendsDone_())}checkForIllegalMediaSwitch(e){const t=BA(this.loaderType_,this.getCurrentMediaInfo_(),e);return t?(this.error({message:t,playlistExclusionDuration:Infinity}),this.trigger("error"),!0):!1}updateSourceBufferTimestampOffset_(e){if(e.timestampOffset===null||typeof e.timingInfo.start!="number"||e.changedTimestampOffset||this.loaderType_!=="main")return;let t=!1;e.timestampOffset-=this.getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:e.segment.videoTimingInfo,audioTimingInfo:e.segment.audioTimingInfo,timingInfo:e.timingInfo}),e.changedTimestampOffset=!0,e.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(e.timestampOffset),t=!0),e.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(e.timestampOffset),t=!0),t&&this.trigger("timestampoffset")}getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:e,audioTimingInfo:t,timingInfo:i}){return this.useDtsForTimestampOffset_?e&&typeof e.transmuxedDecodeStart=="number"?e.transmuxedDecodeStart:t&&typeof t.transmuxedDecodeStart=="number"?t.transmuxedDecodeStart:i.start:i.start}updateTimingInfoEnd_(e){e.timingInfo=e.timingInfo||{};const t=this.getMediaInfo_(),r=this.loaderType_==="main"&&t&&t.hasVideo&&e.videoTimingInfo?e.videoTimingInfo:e.audioTimingInfo;!r||(e.timingInfo.end=typeof r.end=="number"?r.end:r.start+e.duration)}handleAppendsDone_(){if(this.pendingSegment_&&this.trigger("appendsdone"),!this.pendingSegment_){this.state="READY",this.paused()||this.monitorBuffer_();return}const e=this.pendingSegment_;this.updateTimingInfoEnd_(e),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:this.loaderType_==="main"});const t=UA(e,this.sourceType_);if(t&&(t.severity==="warn"?Re.log.warn(t.message):this.logger_(t.message)),this.recordThroughput_(e),this.pendingSegment_=null,this.state="READY",e.isSyncRequest&&(this.trigger("syncinfoupdate"),!e.hasAppendedData_)){this.logger_(`Throwing away un-appended sync request ${xa(e)}`);return}this.logger_(`Appended ${xa(e)}`),this.addSegmentMetadataCue_(e),this.fetchAtBuffer_=!0,this.currentTimeline_!==e.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline}),this.loaderType_==="main"&&!this.audioDisabled_&&this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:e.timeline})),this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate");const i=e.segment,r=e.part,s=i.end&&this.currentTime_()-i.end>e.playlist.targetDuration*3,a=r&&r.end&&this.currentTime_()-r.end>e.playlist.partTargetDuration*3;if(s||a){this.logger_(`bad ${s?"segment":"part"} ${xa(e)}`),this.resetEverything();return}this.mediaIndex!==null&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=e.mediaIndex,this.partIndex=e.partIndex,this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex)&&this.endOfStream(),this.trigger("appended"),e.hasAppendedData_&&this.mediaAppends++,this.paused()||this.monitorBuffer_()}recordThroughput_(e){if(e.duration<Cl){this.logger_(`Ignoring segment's throughput because its duration of ${e.duration} is less than the min to record ${Cl}`);return}const t=this.throughput.rate,i=Date.now()-e.endOfAllRequests+1,r=Math.floor(e.byteLength/i*8*1e3);this.throughput.rate+=(r-t)/++this.throughput.count}addSegmentMetadataCue_(e){if(!this.segmentMetadataTrack_)return;const t=e.segment,i=t.start,r=t.end;if(!$p(i)||!$p(r))return;lo(i,r,this.segmentMetadataTrack_);const s=q().WebKitDataCue||q().VTTCue,a={custom:t.custom,dateTimeObject:t.dateTimeObject,dateTimeString:t.dateTimeString,bandwidth:e.playlist.attributes.BANDWIDTH,resolution:e.playlist.attributes.RESOLUTION,codecs:e.playlist.attributes.CODECS,byteLength:e.byteLength,uri:e.uri,timeline:e.timeline,playlist:e.playlist.id,start:i,end:r},o=JSON.stringify(a),l=new s(i,r,o);l.value=a,this.segmentMetadataTrack_.addCue(l)}}function Br(){}const Wp=function(n){return typeof n!="string"?n:n.replace(/./,e=>e.toUpperCase())},jA=["video","audio"],lc=(n,e)=>{const t=e[`${n}Buffer`];return t&&t.updating||e.queuePending[n]},$A=(n,e)=>{for(let t=0;t<e.length;t++){const i=e[t];if(i.type==="mediaSource")return null;if(i.type===n)return t}return null},Ea=(n,e)=>{if(e.queue.length===0)return;let t=0,i=e.queue[t];if(i.type==="mediaSource"){!e.updating()&&e.mediaSource.readyState!=="closed"&&(e.queue.shift(),i.action(e),i.doneFn&&i.doneFn(),Ea("audio",e),Ea("video",e));return}if(n!=="mediaSource"&&!(!e.ready()||e.mediaSource.readyState==="closed"||lc(n,e))){if(i.type!==n){if(t=$A(n,e.queue),t===null)return;i=e.queue[t]}if(e.queue.splice(t,1),e.queuePending[n]=i,i.action(n,e),!i.doneFn){e.queuePending[n]=null,Ea(n,e);return}}},Kp=(n,e)=>{const t=e[`${n}Buffer`],i=Wp(n);!t||(t.removeEventListener("updateend",e[`on${i}UpdateEnd_`]),t.removeEventListener("error",e[`on${i}Error_`]),e.codecs[n]=null,e[`${n}Buffer`]=null)},_r=(n,e)=>n&&e&&Array.prototype.indexOf.call(n.sourceBuffers,e)!==-1,In={appendBuffer:(n,e,t)=>(i,r)=>{const s=r[`${i}Buffer`];if(!!_r(r.mediaSource,s)){r.logger_(`Appending segment ${e.mediaIndex}'s ${n.length} bytes to ${i}Buffer`);try{s.appendBuffer(n)}catch(a){r.logger_(`Error with code ${a.code} `+(a.code===jp?"(QUOTA_EXCEEDED_ERR) ":"")+`when appending segment ${e.mediaIndex} to ${i}Buffer`),r.queuePending[i]=null,t(a)}}},remove:(n,e)=>(t,i)=>{const r=i[`${t}Buffer`];if(!!_r(i.mediaSource,r)){i.logger_(`Removing ${n} to ${e} from ${t}Buffer`);try{r.remove(n,e)}catch(s){i.logger_(`Remove ${n} to ${e} from ${t}Buffer failed`)}}},timestampOffset:n=>(e,t)=>{const i=t[`${e}Buffer`];!_r(t.mediaSource,i)||(t.logger_(`Setting ${e}timestampOffset to ${n}`),i.timestampOffset=n)},callback:n=>(e,t)=>{n()},endOfStream:n=>e=>{if(e.mediaSource.readyState==="open"){e.logger_(`Calling mediaSource endOfStream(${n||""})`);try{e.mediaSource.endOfStream(n)}catch(t){Re.log.warn("Failed to call media source endOfStream",t)}}},duration:n=>e=>{e.logger_(`Setting mediaSource duration to ${n}`);try{e.mediaSource.duration=n}catch(t){Re.log.warn("Failed to set media source duration",t)}},abort:()=>(n,e)=>{if(e.mediaSource.readyState!=="open")return;const t=e[`${n}Buffer`];if(!!_r(e.mediaSource,t)){e.logger_(`calling abort on ${n}Buffer`);try{t.abort()}catch(i){Re.log.warn(`Failed to abort on ${n}Buffer`,i)}}},addSourceBuffer:(n,e)=>t=>{const i=Wp(n),r=_t(e);t.logger_(`Adding ${n}Buffer with codec ${e} to mediaSource`);const s=t.mediaSource.addSourceBuffer(r);s.addEventListener("updateend",t[`on${i}UpdateEnd_`]),s.addEventListener("error",t[`on${i}Error_`]),t.codecs[n]=e,t[`${n}Buffer`]=s},removeSourceBuffer:n=>e=>{const t=e[`${n}Buffer`];if(Kp(n,e),!!_r(e.mediaSource,t)){e.logger_(`Removing ${n}Buffer with codec ${e.codecs[n]} from mediaSource`);try{e.mediaSource.removeSourceBuffer(t)}catch(i){Re.log.warn(`Failed to removeSourceBuffer ${n}Buffer`,i)}}},changeType:n=>(e,t)=>{const i=t[`${e}Buffer`],r=_t(n);!_r(t.mediaSource,i)||t.codecs[e]!==n&&(t.logger_(`changing ${e}Buffer codec from ${t.codecs[e]} to ${n}`),i.changeType(r),t.codecs[e]=n)}},Rn=({type:n,sourceUpdater:e,action:t,doneFn:i,name:r})=>{e.queue.push({type:n,action:t,doneFn:i,name:r}),Ea(n,e)},qp=(n,e)=>t=>{if(e.queuePending[n]){const i=e.queuePending[n].doneFn;e.queuePending[n]=null,i&&i(e[`${n}Error_`])}Ea(n,e)};class zp extends Re.EventTarget{constructor(e){super();this.mediaSource=e,this.sourceopenListener_=()=>Ea("mediaSource",this),this.mediaSource.addEventListener("sourceopen",this.sourceopenListener_),this.logger_=tr("SourceUpdater"),this.audioTimestampOffset_=0,this.videoTimestampOffset_=0,this.queue=[],this.queuePending={audio:null,video:null},this.delayedAudioAppendQueue_=[],this.videoAppendQueued_=!1,this.codecs={},this.onVideoUpdateEnd_=qp("video",this),this.onAudioUpdateEnd_=qp("audio",this),this.onVideoError_=t=>{this.videoError_=t},this.onAudioError_=t=>{this.audioError_=t},this.createdSourceBuffers_=!1,this.initializedEme_=!1,this.triggeredReady_=!1}initializedEme(){this.initializedEme_=!0,this.triggerReady()}hasCreatedSourceBuffers(){return this.createdSourceBuffers_}hasInitializedAnyEme(){return this.initializedEme_}ready(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()}createSourceBuffers(e){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(e),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())}triggerReady(){this.ready()&&!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))}addSourceBuffer(e,t){Rn({type:"mediaSource",sourceUpdater:this,action:In.addSourceBuffer(e,t),name:"addSourceBuffer"})}abort(e){Rn({type:e,sourceUpdater:this,action:In.abort(e),name:"abort"})}removeSourceBuffer(e){if(!this.canRemoveSourceBuffer()){Re.log.error("removeSourceBuffer is not supported!");return}Rn({type:"mediaSource",sourceUpdater:this,action:In.removeSourceBuffer(e),name:"removeSourceBuffer"})}canRemoveSourceBuffer(){return!Re.browser.IE_VERSION&&!Re.browser.IS_FIREFOX&&q().MediaSource&&q().MediaSource.prototype&&typeof q().MediaSource.prototype.removeSourceBuffer=="function"}static canChangeType(){return q().SourceBuffer&&q().SourceBuffer.prototype&&typeof q().SourceBuffer.prototype.changeType=="function"}canChangeType(){return this.constructor.canChangeType()}changeType(e,t){if(!this.canChangeType()){Re.log.error("changeType is not supported!");return}Rn({type:e,sourceUpdater:this,action:In.changeType(t),name:"changeType"})}addOrChangeSourceBuffers(e){if(!e||typeof e!="object"||Object.keys(e).length===0)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(e).forEach(t=>{const i=e[t];if(!this.hasCreatedSourceBuffers())return this.addSourceBuffer(t,i);this.canChangeType()&&this.changeType(t,i)})}appendBuffer(e,t){const{segmentInfo:i,type:r,bytes:s}=e;if(this.processedAppend_=!0,r==="audio"&&this.videoBuffer&&!this.videoAppendQueued_){this.delayedAudioAppendQueue_.push([e,t]),this.logger_(`delayed audio append of ${s.length} until video append`);return}const a=t;if(Rn({type:r,sourceUpdater:this,action:In.appendBuffer(s,i||{mediaIndex:-1},a),doneFn:t,name:"appendBuffer"}),r==="video"){if(this.videoAppendQueued_=!0,!this.delayedAudioAppendQueue_.length)return;const o=this.delayedAudioAppendQueue_.slice();this.logger_(`queuing delayed audio ${o.length} appendBuffers`),this.delayedAudioAppendQueue_.length=0,o.forEach(l=>{this.appendBuffer.apply(this,l)})}}audioBuffered(){return _r(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered?this.audioBuffer.buffered:Qi()}videoBuffered(){return _r(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered?this.videoBuffer.buffered:Qi()}buffered(){const e=_r(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,t=_r(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return t&&!e?this.audioBuffered():e&&!t?this.videoBuffered():dv(this.audioBuffered(),this.videoBuffered())}setDuration(e,t=Br){Rn({type:"mediaSource",sourceUpdater:this,action:In.duration(e),name:"duration",doneFn:t})}endOfStream(e=null,t=Br){typeof e!="string"&&(e=void 0),Rn({type:"mediaSource",sourceUpdater:this,action:In.endOfStream(e),name:"endOfStream",doneFn:t})}removeAudio(e,t,i=Br){if(!this.audioBuffered().length||this.audioBuffered().end(0)===0){i();return}Rn({type:"audio",sourceUpdater:this,action:In.remove(e,t),doneFn:i,name:"remove"})}removeVideo(e,t,i=Br){if(!this.videoBuffered().length||this.videoBuffered().end(0)===0){i();return}Rn({type:"video",sourceUpdater:this,action:In.remove(e,t),doneFn:i,name:"remove"})}updating(){return!!(lc("audio",this)||lc("video",this))}audioTimestampOffset(e){return typeof e!="undefined"&&this.audioBuffer&&this.audioTimestampOffset_!==e&&(Rn({type:"audio",sourceUpdater:this,action:In.timestampOffset(e),name:"timestampOffset"}),this.audioTimestampOffset_=e),this.audioTimestampOffset_}videoTimestampOffset(e){return typeof e!="undefined"&&this.videoBuffer&&this.videoTimestampOffset!==e&&(Rn({type:"video",sourceUpdater:this,action:In.timestampOffset(e),name:"timestampOffset"}),this.videoTimestampOffset_=e),this.videoTimestampOffset_}audioQueueCallback(e){!this.audioBuffer||Rn({type:"audio",sourceUpdater:this,action:In.callback(e),name:"callback"})}videoQueueCallback(e){!this.videoBuffer||Rn({type:"video",sourceUpdater:this,action:In.callback(e),name:"callback"})}dispose(){this.trigger("dispose"),jA.forEach(e=>{this.abort(e),this.canRemoveSourceBuffer()?this.removeSourceBuffer(e):this[`${e}QueueCallback`](()=>Kp(e,this))}),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()}}const Yp=n=>decodeURIComponent(escape(String.fromCharCode.apply(null,n))),Xp=new Uint8Array(`

`.split("").map(n=>n.charCodeAt(0)));class GA extends Error{constructor(){super("Trying to parse received VTT cues, but there is no WebVTT. Make sure vtt.js is loaded.")}}class VA extends oc{constructor(e,t={}){super(e,t);this.mediaSource_=null,this.subtitlesTrack_=null,this.loaderType_="subtitle",this.featuresNativeTextTracks_=e.featuresNativeTextTracks,this.loadVttJs=e.loadVttJs,this.shouldSaveSegmentTimingInfo_=!1}createTransmuxer_(){return null}buffered_(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues||!this.subtitlesTrack_.cues.length)return Qi();const e=this.subtitlesTrack_.cues,t=e[0].startTime,i=e[e.length-1].startTime;return Qi([[t,i]])}initSegmentForMap(e,t=!1){if(!e)return null;const i=_l(e);let r=this.initSegments_[i];if(t&&!r&&e.bytes){const s=Xp.byteLength+e.bytes.byteLength,a=new Uint8Array(s);a.set(e.bytes),a.set(Xp,e.bytes.byteLength),this.initSegments_[i]=r={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:a}}return r||e}couldBeginLoading_(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}track(e){return typeof e=="undefined"?this.subtitlesTrack_:(this.subtitlesTrack_=e,this.state==="INIT"&&this.couldBeginLoading_()&&this.init_(),this.subtitlesTrack_)}remove(e,t){lo(e,t,this.subtitlesTrack_)}fillBuffer_(){const e=this.chooseNextRequest_();if(!!e){if(this.syncController_.timestampOffsetForTimeline(e.timeline)===null){const t=()=>{this.state="READY",this.paused()||this.monitorBuffer_()};this.syncController_.one("timestampoffset",t),this.state="WAITING_ON_TIMELINE";return}this.loadSegment_(e)}}timestampOffsetForSegment_(){return null}chooseNextRequest_(){return this.skipEmptySegments_(super.chooseNextRequest_())}skipEmptySegments_(e){for(;e&&e.segment.empty;){if(e.mediaIndex+1>=e.playlist.segments.length){e=null;break}e=this.generateSegmentInfo_({playlist:e.playlist,mediaIndex:e.mediaIndex+1,startOfSegment:e.startOfSegment+e.duration,isSyncRequest:e.isSyncRequest})}return e}stopForError(e){this.error(e),this.state="READY",this.pause(),this.trigger("error")}segmentRequestFinished_(e,t,i){if(!this.subtitlesTrack_){this.state="READY";return}if(this.saveTransferStats_(t.stats),!this.pendingSegment_){this.state="READY",this.mediaRequestsAborted+=1;return}if(e){e.code===br.TIMEOUT&&this.handleTimeout_(),e.code===br.ABORTED?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,this.stopForError(e);return}const r=this.pendingSegment_;this.saveBandwidthRelatedStats_(r.duration,t.stats),t.key&&this.segmentKey(t.key,!0),this.state="APPENDING",this.trigger("appending");const s=r.segment;if(s.map&&(s.map.bytes=t.map.bytes),r.bytes=t.bytes,typeof q().WebVTT!="function"&&typeof this.loadVttJs=="function"){this.state="WAITING_ON_VTTJS",this.loadVttJs().then(()=>this.segmentRequestFinished_(e,t,i),()=>this.stopForError({message:"Error loading vtt.js"}));return}s.requested=!0;try{this.parseVTTCues_(r)}catch(a){this.stopForError({message:a.message});return}if(this.updateTimeMapping_(r,this.syncController_.timelines[r.timeline],this.playlist_),r.cues.length?r.timingInfo={start:r.cues[0].startTime,end:r.cues[r.cues.length-1].endTime}:r.timingInfo={start:r.startOfSegment,end:r.startOfSegment+r.duration},r.isSyncRequest){this.trigger("syncinfoupdate"),this.pendingSegment_=null,this.state="READY";return}r.byteLength=r.bytes.byteLength,this.mediaSecondsLoaded+=s.duration,r.cues.forEach(a=>{this.subtitlesTrack_.addCue(this.featuresNativeTextTracks_?new(q()).VTTCue(a.startTime,a.endTime,a.text):a)}),LA(this.subtitlesTrack_),this.handleAppendsDone_()}handleData_(){}updateTimingInfoEnd_(){}parseVTTCues_(e){let t,i=!1;if(typeof q().WebVTT!="function")throw new GA;typeof q().TextDecoder=="function"?t=new(q()).TextDecoder("utf8"):(t=q().WebVTT.StringDecoder(),i=!0);const r=new(q()).WebVTT.Parser(q(),q().vttjs,t);if(e.cues=[],e.timestampmap={MPEGTS:0,LOCAL:0},r.oncue=e.cues.push.bind(e.cues),r.ontimestampmap=a=>{e.timestampmap=a},r.onparsingerror=a=>{Re.log.warn("Error encountered when parsing cues: "+a.message)},e.segment.map){let a=e.segment.map.bytes;i&&(a=Yp(a)),r.parse(a)}let s=e.bytes;i&&(s=Yp(s)),r.parse(s),r.flush()}updateTimeMapping_(e,t,i){const r=e.segment;if(!t)return;if(!e.cues.length){r.empty=!0;return}const s=e.timestampmap,a=s.MPEGTS/ea.ONE_SECOND_IN_TS-s.LOCAL+t.mapping;if(e.cues.forEach(o=>{o.startTime+=a,o.endTime+=a}),!i.syncInfo){const o=e.cues[0].startTime,l=e.cues[e.cues.length-1].startTime;i.syncInfo={mediaSequence:i.mediaSequence+e.mediaIndex,time:Math.min(o,l-r.duration)}}}}const HA=function(n,e){const t=n.cues;for(let i=0;i<t.length;i++){const r=t[i];if(e>=r.adStartTime&&e<=r.adEndTime)return r}return null},WA=function(n,e,t=0){if(!n.segments)return;let i=t,r;for(let s=0;s<n.segments.length;s++){const a=n.segments[s];if(r||(r=HA(e,i+a.duration/2)),r){if("cueIn"in a){r.endTime=i,r.adEndTime=i,i+=a.duration,r=null;continue}if(i<r.endTime){i+=a.duration;continue}r.endTime+=a.duration}else if("cueOut"in a&&(r=new(q()).VTTCue(i,i+a.duration,a.cueOut),r.adStartTime=i,r.adEndTime=i+parseFloat(a.cueOut),e.addCue(r)),"cueOutCont"in a){const[o,l]=a.cueOutCont.split("/").map(parseFloat);r=new(q()).VTTCue(i,i+a.duration,""),r.adStartTime=i-o,r.adEndTime=r.adStartTime+l,e.addCue(r)}i+=a.duration}},KA=86400,Qp=[{name:"VOD",run:(n,e,t,i,r)=>t!==Infinity?{time:0,segmentIndex:0,partIndex:null}:null},{name:"ProgramDateTime",run:(n,e,t,i,r)=>{if(!Object.keys(n.timelineToDatetimeMappings).length)return null;let s=null,a=null;const o=Kd(e);r=r||0;for(let l=0;l<o.length;l++){const u=e.endList||r===0?l:o.length-(l+1),d=o[u],h=d.segment,v=n.timelineToDatetimeMappings[h.timeline];if(!v||!h.dateTimeObject)continue;let _=h.dateTimeObject.getTime()/1e3+v;if(h.parts&&typeof d.partIndex=="number")for(let N=0;N<d.partIndex;N++)_+=h.parts[N].duration;const R=Math.abs(r-_);if(a!==null&&(R===0||a<R))break;a=R,s={time:_,segmentIndex:d.segmentIndex,partIndex:d.partIndex}}return s}},{name:"Segment",run:(n,e,t,i,r)=>{let s=null,a=null;r=r||0;const o=Kd(e);for(let l=0;l<o.length;l++){const u=e.endList||r===0?l:o.length-(l+1),d=o[u],h=d.segment,v=d.part&&d.part.start||h&&h.start;if(h.timeline===i&&typeof v!="undefined"){const x=Math.abs(r-v);if(a!==null&&a<x)break;(!s||a===null||a>=x)&&(a=x,s={time:v,segmentIndex:d.segmentIndex,partIndex:d.partIndex})}}return s}},{name:"Discontinuity",run:(n,e,t,i,r)=>{let s=null;if(r=r||0,e.discontinuityStarts&&e.discontinuityStarts.length){let a=null;for(let o=0;o<e.discontinuityStarts.length;o++){const l=e.discontinuityStarts[o],u=e.discontinuitySequence+o+1,d=n.discontinuities[u];if(d){const h=Math.abs(r-d.time);if(a!==null&&a<h)break;(!s||a===null||a>=h)&&(a=h,s={time:d.time,segmentIndex:l,partIndex:null})}}}return s}},{name:"Playlist",run:(n,e,t,i,r)=>e.syncInfo?{time:e.syncInfo.time,segmentIndex:e.syncInfo.mediaSequence-e.mediaSequence,partIndex:null}:null}];class qA extends Re.EventTarget{constructor(e={}){super();this.timelines=[],this.discontinuities=[],this.timelineToDatetimeMappings={},this.logger_=tr("SyncController")}getSyncPoint(e,t,i,r){const s=this.runStrategies_(e,t,i,r);return s.length?this.selectSyncPoint_(s,{key:"time",value:r}):null}getExpiredTime(e,t){if(!e||!e.segments)return null;const i=this.runStrategies_(e,t,e.discontinuitySequence,0);if(!i.length)return null;const r=this.selectSyncPoint_(i,{key:"segmentIndex",value:0});return r.segmentIndex>0&&(r.time*=-1),Math.abs(r.time+so({defaultDuration:e.targetDuration,durationList:e.segments,startIndex:r.segmentIndex,endIndex:0}))}runStrategies_(e,t,i,r){const s=[];for(let a=0;a<Qp.length;a++){const o=Qp[a],l=o.run(this,e,t,i,r);l&&(l.strategy=o.name,s.push({strategy:o.name,syncPoint:l}))}return s}selectSyncPoint_(e,t){let i=e[0].syncPoint,r=Math.abs(e[0].syncPoint[t.key]-t.value),s=e[0].strategy;for(let a=1;a<e.length;a++){const o=Math.abs(e[a].syncPoint[t.key]-t.value);o<r&&(r=o,i=e[a].syncPoint,s=e[a].strategy)}return this.logger_(`syncPoint for [${t.key}: ${t.value}] chosen with strategy [${s}]: [time:${i.time}, segmentIndex:${i.segmentIndex}`+(typeof i.partIndex=="number"?`,partIndex:${i.partIndex}`:"")+"]"),i}saveExpiredSegmentInfo(e,t){const i=t.mediaSequence-e.mediaSequence;if(i>KA){Re.log.warn(`Not saving expired segment info. Media sequence gap ${i} is too large.`);return}for(let r=i-1;r>=0;r--){const s=e.segments[r];if(s&&typeof s.start!="undefined"){t.syncInfo={mediaSequence:e.mediaSequence+r,time:s.start},this.logger_(`playlist refresh sync: [time:${t.syncInfo.time}, mediaSequence: ${t.syncInfo.mediaSequence}]`),this.trigger("syncinfoupdate");break}}}setDateTimeMappingForStart(e){if(this.timelineToDatetimeMappings={},e.segments&&e.segments.length&&e.segments[0].dateTimeObject){const t=e.segments[0],i=t.dateTimeObject.getTime()/1e3;this.timelineToDatetimeMappings[t.timeline]=-i}}saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:t}){const i=this.calculateSegmentTimeMapping_(e,e.timingInfo,t),r=e.segment;i&&(this.saveDiscontinuitySyncInfo_(e),e.playlist.syncInfo||(e.playlist.syncInfo={mediaSequence:e.playlist.mediaSequence+e.mediaIndex,time:r.start}));const s=r.dateTimeObject;r.discontinuity&&t&&s&&(this.timelineToDatetimeMappings[r.timeline]=-(s.getTime()/1e3))}timestampOffsetForTimeline(e){return typeof this.timelines[e]=="undefined"?null:this.timelines[e].time}mappingForTimeline(e){return typeof this.timelines[e]=="undefined"?null:this.timelines[e].mapping}calculateSegmentTimeMapping_(e,t,i){const r=e.segment,s=e.part;let a=this.timelines[e.timeline],o,l;if(typeof e.timestampOffset=="number")a={time:e.startOfSegment,mapping:e.startOfSegment-t.start},i&&(this.timelines[e.timeline]=a,this.trigger("timestampoffset"),this.logger_(`time mapping for timeline ${e.timeline}: [time: ${a.time}] [mapping: ${a.mapping}]`)),o=e.startOfSegment,l=t.end+a.mapping;else if(a)o=t.start+a.mapping,l=t.end+a.mapping;else return!1;return s&&(s.start=o,s.end=l),(!r.start||o<r.start)&&(r.start=o),r.end=l,!0}saveDiscontinuitySyncInfo_(e){const t=e.playlist,i=e.segment;if(i.discontinuity)this.discontinuities[i.timeline]={time:i.start,accuracy:0};else if(t.discontinuityStarts&&t.discontinuityStarts.length)for(let r=0;r<t.discontinuityStarts.length;r++){const s=t.discontinuityStarts[r],a=t.discontinuitySequence+r+1,o=s-e.mediaIndex,l=Math.abs(o);if(!this.discontinuities[a]||this.discontinuities[a].accuracy>l){let u;o<0?u=i.start-so({defaultDuration:t.targetDuration,durationList:t.segments,startIndex:e.mediaIndex,endIndex:s}):u=i.end+so({defaultDuration:t.targetDuration,durationList:t.segments,startIndex:e.mediaIndex+1,endIndex:s}),this.discontinuities[a]={time:u,accuracy:l}}}}dispose(){this.trigger("dispose"),this.off()}}class zA extends Re.EventTarget{constructor(){super();this.pendingTimelineChanges_={},this.lastTimelineChanges_={}}clearPendingTimelineChange(e){this.pendingTimelineChanges_[e]=null,this.trigger("pendingtimelinechange")}pendingTimelineChange({type:e,from:t,to:i}){return typeof t=="number"&&typeof i=="number"&&(this.pendingTimelineChanges_[e]={type:e,from:t,to:i},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[e]}lastTimelineChange({type:e,from:t,to:i}){return typeof t=="number"&&typeof i=="number"&&(this.lastTimelineChanges_[e]={type:e,from:t,to:i},delete this.pendingTimelineChanges_[e],this.trigger("timelinechange")),this.lastTimelineChanges_[e]}dispose(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()}}const YA=Tp(Sp(function(){var n=function(){function R(){this.listeners={}}var N=R.prototype;return N.on=function(J,ue){this.listeners[J]||(this.listeners[J]=[]),this.listeners[J].push(ue)},N.off=function(J,ue){if(!this.listeners[J])return!1;var pe=this.listeners[J].indexOf(ue);return this.listeners[J]=this.listeners[J].slice(0),this.listeners[J].splice(pe,1),pe>-1},N.trigger=function(J){var ue=this.listeners[J];if(!!ue)if(arguments.length===2)for(var pe=ue.length,te=0;te<pe;++te)ue[te].call(this,arguments[1]);else for(var ke=Array.prototype.slice.call(arguments,1),we=ue.length,Ge=0;Ge<we;++Ge)ue[Ge].apply(this,ke)},N.dispose=function(){this.listeners={}},N.pipe=function(J){this.on("data",function(ue){J.push(ue)})},R}();/*! @name pkcs7 @version 1.0.4 @license Apache-2.0 */function e(R){return R.subarray(0,R.byteLength-R[R.byteLength-1])}/*! @name aes-decrypter @version 4.0.1 @license Apache-2.0 */const t=function(){const R=[[[],[],[],[],[]],[[],[],[],[],[]]],N=R[0],z=R[1],J=N[4],ue=z[4];let pe,te,ke;const we=[],Ge=[];let Ve,Fe,mt,et,nt,Pt;for(pe=0;pe<256;pe++)Ge[(we[pe]=pe<<1^(pe>>7)*283)^pe]=pe;for(te=ke=0;!J[te];te^=Ve||1,ke=Ge[ke]||1)for(et=ke^ke<<1^ke<<2^ke<<3^ke<<4,et=et>>8^et&255^99,J[te]=et,ue[et]=te,mt=we[Fe=we[Ve=we[te]]],Pt=mt*16843009^Fe*65537^Ve*257^te*16843008,nt=we[et]*257^et*16843008,pe=0;pe<4;pe++)N[pe][te]=nt=nt<<24^nt>>>8,z[pe][et]=Pt=Pt<<24^Pt>>>8;for(pe=0;pe<5;pe++)N[pe]=N[pe].slice(0),z[pe]=z[pe].slice(0);return R};let i=null;class r{constructor(N){i||(i=t()),this._tables=[[i[0][0].slice(),i[0][1].slice(),i[0][2].slice(),i[0][3].slice(),i[0][4].slice()],[i[1][0].slice(),i[1][1].slice(),i[1][2].slice(),i[1][3].slice(),i[1][4].slice()]];let z,J,ue;const pe=this._tables[0][4],te=this._tables[1],ke=N.length;let we=1;if(ke!==4&&ke!==6&&ke!==8)throw new Error("Invalid aes key size");const Ge=N.slice(0),Ve=[];for(this._key=[Ge,Ve],z=ke;z<4*ke+28;z++)ue=Ge[z-1],(z%ke==0||ke===8&&z%ke==4)&&(ue=pe[ue>>>24]<<24^pe[ue>>16&255]<<16^pe[ue>>8&255]<<8^pe[ue&255],z%ke==0&&(ue=ue<<8^ue>>>24^we<<24,we=we<<1^(we>>7)*283)),Ge[z]=Ge[z-ke]^ue;for(J=0;z;J++,z--)ue=Ge[J&3?z:z-4],z<=4||J<4?Ve[J]=ue:Ve[J]=te[0][pe[ue>>>24]]^te[1][pe[ue>>16&255]]^te[2][pe[ue>>8&255]]^te[3][pe[ue&255]]}decrypt(N,z,J,ue,pe,te){const ke=this._key[1];let we=N^ke[0],Ge=ue^ke[1],Ve=J^ke[2],Fe=z^ke[3],mt,et,nt;const Pt=ke.length/4-2;let Gt,Kt=4;const qt=this._tables[1],ft=qt[0],bt=qt[1],Vt=qt[2],zt=qt[3],jt=qt[4];for(Gt=0;Gt<Pt;Gt++)mt=ft[we>>>24]^bt[Ge>>16&255]^Vt[Ve>>8&255]^zt[Fe&255]^ke[Kt],et=ft[Ge>>>24]^bt[Ve>>16&255]^Vt[Fe>>8&255]^zt[we&255]^ke[Kt+1],nt=ft[Ve>>>24]^bt[Fe>>16&255]^Vt[we>>8&255]^zt[Ge&255]^ke[Kt+2],Fe=ft[Fe>>>24]^bt[we>>16&255]^Vt[Ge>>8&255]^zt[Ve&255]^ke[Kt+3],Kt+=4,we=mt,Ge=et,Ve=nt;for(Gt=0;Gt<4;Gt++)pe[(3&-Gt)+te]=jt[we>>>24]<<24^jt[Ge>>16&255]<<16^jt[Ve>>8&255]<<8^jt[Fe&255]^ke[Kt++],mt=we,we=Ge,Ge=Ve,Ve=Fe,Fe=mt}}class s extends n{constructor(){super(n);this.jobs=[],this.delay=1,this.timeout_=null}processJob_(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null}push(N){this.jobs.push(N),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))}}const a=function(R){return R<<24|(R&65280)<<8|(R&16711680)>>8|R>>>24},o=function(R,N,z){const J=new Int32Array(R.buffer,R.byteOffset,R.byteLength>>2),ue=new r(Array.prototype.slice.call(N)),pe=new Uint8Array(R.byteLength),te=new Int32Array(pe.buffer);let ke,we,Ge,Ve,Fe,mt,et,nt,Pt;for(ke=z[0],we=z[1],Ge=z[2],Ve=z[3],Pt=0;Pt<J.length;Pt+=4)Fe=a(J[Pt]),mt=a(J[Pt+1]),et=a(J[Pt+2]),nt=a(J[Pt+3]),ue.decrypt(Fe,mt,et,nt,te,Pt),te[Pt]=a(te[Pt]^ke),te[Pt+1]=a(te[Pt+1]^we),te[Pt+2]=a(te[Pt+2]^Ge),te[Pt+3]=a(te[Pt+3]^Ve),ke=Fe,we=mt,Ge=et,Ve=nt;return pe};class l{constructor(N,z,J,ue){const pe=l.STEP,te=new Int32Array(N.buffer),ke=new Uint8Array(N.byteLength);let we=0;for(this.asyncStream_=new s,this.asyncStream_.push(this.decryptChunk_(te.subarray(we,we+pe),z,J,ke)),we=pe;we<te.length;we+=pe)J=new Uint32Array([a(te[we-4]),a(te[we-3]),a(te[we-2]),a(te[we-1])]),this.asyncStream_.push(this.decryptChunk_(te.subarray(we,we+pe),z,J,ke));this.asyncStream_.push(function(){ue(null,e(ke))})}static get STEP(){return 32e3}decryptChunk_(N,z,J,ue){return function(){const pe=o(N,z,J);ue.set(pe,N.byteOffset)}}}var u=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof Ne.g!="undefined"?Ne.g:typeof self!="undefined"?self:{},d;typeof window!="undefined"?d=window:typeof u!="undefined"?d=u:typeof self!="undefined"?d=self:d={};var h=d,v=function(N){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(N):N&&N.buffer instanceof ArrayBuffer},x=h.BigInt||Number;x("0x1"),x("0x100"),x("0x10000"),x("0x1000000"),x("0x100000000"),x("0x10000000000"),x("0x1000000000000"),x("0x100000000000000"),x("0x10000000000000000"),function(){var R=new Uint16Array([65484]),N=new Uint8Array(R.buffer,R.byteOffset,R.byteLength);return N[0]===255?"big":N[0]===204?"little":"unknown"}();const _=function(R){const N={};return Object.keys(R).forEach(z=>{const J=R[z];v(J)?N[z]={bytes:J.buffer,byteOffset:J.byteOffset,byteLength:J.byteLength}:N[z]=J}),N};self.onmessage=function(R){const N=R.data,z=new Uint8Array(N.encrypted.bytes,N.encrypted.byteOffset,N.encrypted.byteLength),J=new Uint32Array(N.key.bytes,N.key.byteOffset,N.key.byteLength/4),ue=new Uint32Array(N.iv.bytes,N.iv.byteOffset,N.iv.byteLength/4);new l(z,J,ue,function(pe,te){self.postMessage(_({source:N.source,decrypted:te}),[te.buffer])})}}));var XA=Ep(YA);const QA=n=>{let e=n.default?"main":"alternative";return n.characteristics&&n.characteristics.indexOf("public.accessibility.describes-video")>=0&&(e="main-desc"),e},wl=(n,e)=>{n.abort(),n.pause(),e&&e.activePlaylistLoader&&(e.activePlaylistLoader.pause(),e.activePlaylistLoader=null)},uc=(n,e)=>{e.activePlaylistLoader=n,n.load()},ZA=(n,e)=>()=>{const{segmentLoaders:{[n]:t,main:i},mediaTypes:{[n]:r}}=e,s=r.activeTrack(),a=r.getActiveGroup(),o=r.activePlaylistLoader,l=r.lastGroup_;if(!(a&&l&&a.id===l.id)&&(r.lastGroup_=a,r.lastTrack_=s,wl(t,r),!(!a||a.isMainPlaylist))){if(!a.playlistLoader){o&&i.resetEverything();return}t.resyncLoader(),uc(a.playlistLoader,r)}},JA=(n,e)=>()=>{const{segmentLoaders:{[n]:t},mediaTypes:{[n]:i}}=e;i.lastGroup_=null,t.abort(),t.pause()},eb=(n,e)=>()=>{const{mainPlaylistLoader:t,segmentLoaders:{[n]:i,main:r},mediaTypes:{[n]:s}}=e,a=s.activeTrack(),o=s.getActiveGroup(),l=s.activePlaylistLoader,u=s.lastTrack_;if(!(u&&a&&u.id===a.id)&&(s.lastGroup_=o,s.lastTrack_=a,wl(i,s),!!o)){if(o.isMainPlaylist){if(!a||!u||a.id===u.id)return;const d=e.vhs.playlistController_,h=d.selectPlaylist();if(d.media()===h)return;s.logger_(`track change. Switching main audio from ${u.id} to ${a.id}`),t.pause(),r.resetEverything(),d.fastQualityChange_(h);return}if(n==="AUDIO"){if(!o.playlistLoader){r.setAudio(!0),r.resetEverything();return}i.setAudio(!0),r.setAudio(!1)}if(l===o.playlistLoader){uc(o.playlistLoader,s);return}i.track&&i.track(a),i.resetEverything(),uc(o.playlistLoader,s)}},Ll={AUDIO:(n,e)=>()=>{const{segmentLoaders:{[n]:t},mediaTypes:{[n]:i},excludePlaylist:r}=e;wl(t,i);const s=i.activeTrack(),a=i.activeGroup(),o=(a.filter(u=>u.default)[0]||a[0]).id,l=i.tracks[o];if(s===l){r({error:{message:"Problem encountered loading the default audio track."}});return}Re.log.warn("Problem encountered loading the alternate audio track.Switching back to default.");for(const u in i.tracks)i.tracks[u].enabled=i.tracks[u]===l;i.onTrackChanged()},SUBTITLES:(n,e)=>()=>{const{segmentLoaders:{[n]:t},mediaTypes:{[n]:i}}=e;Re.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),wl(t,i);const r=i.activeTrack();r&&(r.mode="disabled"),i.onTrackChanged()}},Zp={AUDIO:(n,e,t)=>{if(!e)return;const{tech:i,requestOptions:r,segmentLoaders:{[n]:s}}=t;e.on("loadedmetadata",()=>{const a=e.media();s.playlist(a,r),(!i.paused()||a.endList&&i.preload()!=="none")&&s.load()}),e.on("loadedplaylist",()=>{s.playlist(e.media(),r),i.paused()||s.load()}),e.on("error",Ll[n](n,t))},SUBTITLES:(n,e,t)=>{const{tech:i,requestOptions:r,segmentLoaders:{[n]:s},mediaTypes:{[n]:a}}=t;e.on("loadedmetadata",()=>{const o=e.media();s.playlist(o,r),s.track(a.activeTrack()),(!i.paused()||o.endList&&i.preload()!=="none")&&s.load()}),e.on("loadedplaylist",()=>{s.playlist(e.media(),r),i.paused()||s.load()}),e.on("error",Ll[n](n,t))}},tb={AUDIO:(n,e)=>{const{vhs:t,sourceType:i,segmentLoaders:{[n]:r},requestOptions:s,main:{mediaGroups:a},mediaTypes:{[n]:{groups:o,tracks:l,logger_:u}},mainPlaylistLoader:d}=e,h=ao(d.main);(!a[n]||Object.keys(a[n]).length===0)&&(a[n]={main:{default:{default:!0}}},h&&(a[n].main.default.playlists=d.main.playlists));for(const v in a[n]){o[v]||(o[v]=[]);for(const x in a[n][v]){let _=a[n][v][x],R;if(h?(u(`AUDIO group '${v}' label '${x}' is a main playlist`),_.isMainPlaylist=!0,R=null):i==="vhs-json"&&_.playlists?R=new ba(_.playlists[0],t,s):_.resolvedUri?R=new ba(_.resolvedUri,t,s):_.playlists&&i==="dash"?R=new ic(_.playlists[0],t,s,d):R=null,_=ci({id:x,playlistLoader:R},_),Zp[n](n,_.playlistLoader,e),o[v].push(_),typeof l[x]=="undefined"){const N=new Re.AudioTrack({id:x,kind:QA(_),enabled:!1,language:_.language,default:_.default,label:x});l[x]=N}}}r.on("error",Ll[n](n,e))},SUBTITLES:(n,e)=>{const{tech:t,vhs:i,sourceType:r,segmentLoaders:{[n]:s},requestOptions:a,main:{mediaGroups:o},mediaTypes:{[n]:{groups:l,tracks:u}},mainPlaylistLoader:d}=e;for(const h in o[n]){l[h]||(l[h]=[]);for(const v in o[n][h]){if(o[n][h][v].forced)continue;let x=o[n][h][v],_;if(r==="hls")_=new ba(x.resolvedUri,i,a);else if(r==="dash"){if(!x.playlists.filter(N=>N.excludeUntil!==Infinity).length)return;_=new ic(x.playlists[0],i,a,d)}else r==="vhs-json"&&(_=new ba(x.playlists?x.playlists[0]:x.resolvedUri,i,a));if(x=ci({id:v,playlistLoader:_},x),Zp[n](n,x.playlistLoader,e),l[h].push(x),typeof u[v]=="undefined"){const R=t.addRemoteTextTrack({id:v,kind:"subtitles",default:x.default&&x.autoselect,language:x.language,label:v},!1).track;u[v]=R}}}s.on("error",Ll[n](n,e))},"CLOSED-CAPTIONS":(n,e)=>{const{tech:t,main:{mediaGroups:i},mediaTypes:{[n]:{groups:r,tracks:s}}}=e;for(const a in i[n]){r[a]||(r[a]=[]);for(const o in i[n][a]){const l=i[n][a][o];if(!/^(?:CC|SERVICE)/.test(l.instreamId))continue;const u=t.options_.vhs&&t.options_.vhs.captionServices||{};let d={label:o,language:l.language,instreamId:l.instreamId,default:l.default&&l.autoselect};if(u[d.instreamId]&&(d=ci(d,u[d.instreamId])),d.default===void 0&&delete d.default,r[a].push(ci({id:o},l)),typeof s[o]=="undefined"){const h=t.addRemoteTextTrack({id:d.instreamId,kind:"captions",default:d.default,language:d.language,label:d.label},!1).track;s[o]=h}}}}},Jp=(n,e)=>{for(let t=0;t<n.length;t++)if(Yd(e,n[t])||n[t].playlists&&Jp(n[t].playlists,e))return!0;return!1},ib=(n,e)=>t=>{const{mainPlaylistLoader:i,mediaTypes:{[n]:{groups:r}}}=e,s=i.media();if(!s)return null;let a=null;s.attributes[n]&&(a=r[s.attributes[n]]);const o=Object.keys(r);if(!a)if(n==="AUDIO"&&o.length>1&&ao(e.main))for(let l=0;l<o.length;l++){const u=r[o[l]];if(Jp(u,s)){a=u;break}}else r.main?a=r.main:o.length===1&&(a=r[o[0]]);return typeof t=="undefined"?a:t===null||!a?null:a.filter(l=>l.id===t.id)[0]||null},nb={AUDIO:(n,e)=>()=>{const{mediaTypes:{[n]:{tracks:t}}}=e;for(const i in t)if(t[i].enabled)return t[i];return null},SUBTITLES:(n,e)=>()=>{const{mediaTypes:{[n]:{tracks:t}}}=e;for(const i in t)if(t[i].mode==="showing"||t[i].mode==="hidden")return t[i];return null}},rb=(n,{mediaTypes:e})=>()=>{const t=e[n].activeTrack();return t?e[n].activeGroup(t):null},sb=n=>{["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(u=>{tb[u](u,n)});const{mediaTypes:e,mainPlaylistLoader:t,tech:i,vhs:r,segmentLoaders:{["AUDIO"]:s,main:a}}=n;["AUDIO","SUBTITLES"].forEach(u=>{e[u].activeGroup=ib(u,n),e[u].activeTrack=nb[u](u,n),e[u].onGroupChanged=ZA(u,n),e[u].onGroupChanging=JA(u,n),e[u].onTrackChanged=eb(u,n),e[u].getActiveGroup=rb(u,n)});const o=e.AUDIO.activeGroup();if(o){const u=(o.filter(h=>h.default)[0]||o[0]).id;e.AUDIO.tracks[u].enabled=!0,e.AUDIO.onGroupChanged(),e.AUDIO.onTrackChanged(),e.AUDIO.getActiveGroup().playlistLoader?(a.setAudio(!1),s.setAudio(!0)):a.setAudio(!0)}t.on("mediachange",()=>{["AUDIO","SUBTITLES"].forEach(u=>e[u].onGroupChanged())}),t.on("mediachanging",()=>{["AUDIO","SUBTITLES"].forEach(u=>e[u].onGroupChanging())});const l=()=>{e.AUDIO.onTrackChanged(),i.trigger({type:"usage",name:"vhs-audio-change"})};i.audioTracks().addEventListener("change",l),i.remoteTextTracks().addEventListener("change",e.SUBTITLES.onTrackChanged),r.on("dispose",()=>{i.audioTracks().removeEventListener("change",l),i.remoteTextTracks().removeEventListener("change",e.SUBTITLES.onTrackChanged)}),i.clearTracks("audio");for(const u in e.AUDIO.tracks)i.audioTracks().addTrack(e.AUDIO.tracks[u])},ab=()=>{const n={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(e=>{n[e]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:Br,activeTrack:Br,getActiveGroup:Br,onGroupChanged:Br,onTrackChanged:Br,lastTrack_:null,logger_:tr(`MediaGroups[${e}]`)}}),n},ob=60*2;let Fr;const lb=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred","mediaAppends"],ub=function(n){return this.audioSegmentLoader_[n]+this.mainSegmentLoader_[n]},db=function({currentPlaylist:n,buffered:e,currentTime:t,nextPlaylist:i,bufferLowWaterLine:r,bufferHighWaterLine:s,duration:a,bufferBasedABR:o,log:l}){if(!i)return Re.log.warn("We received no playlist to switch to. Please check your stream."),!1;const u=`allowing switch ${n&&n.id||"null"} -> ${i.id}`;if(!n)return l(`${u} as current playlist is not set`),!0;if(i.id===n.id)return!1;const d=Boolean(va(e,t).length);if(!n.endList)return!d&&typeof n.partTargetDuration=="number"?(l(`not ${u} as current playlist is live llhls, but currentTime isn't in buffered.`),!1):(l(`${u} as current playlist is live`),!0);const h=Hd(e,t),v=o?ji.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:ji.MAX_BUFFER_LOW_WATER_LINE;if(a<v)return l(`${u} as duration < max low water line (${a} < ${v})`),!0;const x=i.attributes.BANDWIDTH,_=n.attributes.BANDWIDTH;if(x<_&&(!o||h<s)){let R=`${u} as next bandwidth < current bandwidth (${x} < ${_})`;return o&&(R+=` and forwardBuffer < bufferHighWaterLine (${h} < ${s})`),l(R),!0}if((!o||x>_)&&h>=r){let R=`${u} as forwardBuffer >= bufferLowWaterLine (${h} >= ${r})`;return o&&(R+=` and next bandwidth > current bandwidth (${x} > ${_})`),l(R),!0}return l(`not ${u} as no switching criteria met`),!1};class cb extends Re.EventTarget{constructor(e){super();const{src:t,withCredentials:i,tech:r,bandwidth:s,externVhs:a,useCueTags:o,playlistExclusionDuration:l,enableLowInitialPlaylist:u,sourceType:d,cacheEncryptionKeys:h,bufferBasedABR:v,leastPixelDiffSelector:x,captionServices:_}=e;if(!t)throw new Error("A non-empty playlist URL or JSON manifest string is required");let{maxPlaylistRetries:R}=e;(R===null||typeof R=="undefined")&&(R=Infinity),Fr=a,this.bufferBasedABR=Boolean(v),this.leastPixelDiffSelector=Boolean(x),this.withCredentials=i,this.tech_=r,this.vhs_=r.vhs,this.sourceType_=d,this.useCueTags_=o,this.playlistExclusionDuration=l,this.maxPlaylistRetries=R,this.enableLowInitialPlaylist=u,this.useCueTags_&&(this.cueTagsTrack_=this.tech_.addTextTrack("metadata","ad-cues"),this.cueTagsTrack_.inBandMetadataTrackDispatchType=""),this.requestOptions_={withCredentials:i,maxPlaylistRetries:R,timeout:null},this.on("error",this.pauseLoading),this.mediaTypes_=ab(),this.mediaSource=new(q()).MediaSource,this.handleDurationChange_=this.handleDurationChange_.bind(this),this.handleSourceOpen_=this.handleSourceOpen_.bind(this),this.handleSourceEnded_=this.handleSourceEnded_.bind(this),this.mediaSource.addEventListener("durationchange",this.handleDurationChange_),this.mediaSource.addEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.addEventListener("sourceended",this.handleSourceEnded_),this.seekable_=Qi(),this.hasPlayed_=!1,this.syncController_=new qA(e),this.segmentMetadataTrack_=r.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,this.decrypter_=new XA,this.sourceUpdater_=new zp(this.mediaSource),this.inbandTextTracks_={},this.timelineChangeController_=new zA;const N={vhs:this.vhs_,parse708captions:e.parse708captions,useDtsForTimestampOffset:e.useDtsForTimestampOffset,captionServices:_,mediaSource:this.mediaSource,currentTime:this.tech_.currentTime.bind(this.tech_),seekable:()=>this.seekable(),seeking:()=>this.tech_.seeking(),duration:()=>this.duration(),hasPlayed:()=>this.hasPlayed_,goalBufferLength:()=>this.goalBufferLength(),bandwidth:s,syncController:this.syncController_,decrypter:this.decrypter_,sourceType:this.sourceType_,inbandTextTracks:this.inbandTextTracks_,cacheEncryptionKeys:h,sourceUpdater:this.sourceUpdater_,timelineChangeController:this.timelineChangeController_,exactManifestTimings:e.exactManifestTimings};this.mainPlaylistLoader_=this.sourceType_==="dash"?new ic(t,this.vhs_,this.requestOptions_):new ba(t,this.vhs_,this.requestOptions_),this.setupMainPlaylistLoaderListeners_(),this.mainSegmentLoader_=new oc(ci(N,{segmentMetadataTrack:this.segmentMetadataTrack_,loaderType:"main"}),e),this.audioSegmentLoader_=new oc(ci(N,{loaderType:"audio"}),e),this.subtitleSegmentLoader_=new VA(ci(N,{loaderType:"vtt",featuresNativeTextTracks:this.tech_.featuresNativeTextTracks,loadVttJs:()=>new Promise((J,ue)=>{function pe(){r.off("vttjserror",te),J()}function te(){r.off("vttjsloaded",pe),ue()}r.one("vttjsloaded",pe),r.one("vttjserror",te),r.addWebVttScript_()})}),e),this.setupSegmentLoaderListeners_(),this.bufferBasedABR&&(this.mainPlaylistLoader_.one("loadedplaylist",()=>this.startABRTimer_()),this.tech_.on("pause",()=>this.stopABRTimer_()),this.tech_.on("play",()=>this.startABRTimer_())),lb.forEach(J=>{this[J+"_"]=ub.bind(this,J)}),this.logger_=tr("pc"),this.triggeredFmp4Usage=!1,this.tech_.preload()==="none"?(this.loadOnPlay_=()=>{this.loadOnPlay_=null,this.mainPlaylistLoader_.load()},this.tech_.one("play",this.loadOnPlay_)):this.mainPlaylistLoader_.load(),this.timeToLoadedData__=-1,this.mainAppendsToLoadedData__=-1,this.audioAppendsToLoadedData__=-1;const z=this.tech_.preload()==="none"?"play":"loadstart";this.tech_.one(z,()=>{const J=Date.now();this.tech_.one("loadeddata",()=>{this.timeToLoadedData__=Date.now()-J,this.mainAppendsToLoadedData__=this.mainSegmentLoader_.mediaAppends,this.audioAppendsToLoadedData__=this.audioSegmentLoader_.mediaAppends})})}mainAppendsToLoadedData_(){return this.mainAppendsToLoadedData__}audioAppendsToLoadedData_(){return this.audioAppendsToLoadedData__}appendsToLoadedData_(){const e=this.mainAppendsToLoadedData_(),t=this.audioAppendsToLoadedData_();return e===-1||t===-1?-1:e+t}timeToLoadedData_(){return this.timeToLoadedData__}checkABR_(e="abr"){const t=this.selectPlaylist();t&&this.shouldSwitchToMedia_(t)&&this.switchMedia_(t,e)}switchMedia_(e,t,i){const r=this.media(),s=r&&(r.id||r.uri),a=e.id||e.uri;s&&s!==a&&(this.logger_(`switch media ${s} -> ${a} from ${t}`),this.tech_.trigger({type:"usage",name:`vhs-rendition-change-${t}`})),this.mainPlaylistLoader_.media(e,i)}startABRTimer_(){this.stopABRTimer_(),this.abrTimer_=q().setInterval(()=>this.checkABR_(),250)}stopABRTimer_(){this.tech_.scrubbing&&this.tech_.scrubbing()||(q().clearInterval(this.abrTimer_),this.abrTimer_=null)}getAudioTrackPlaylists_(){const e=this.main(),t=e&&e.playlists||[];if(!e||!e.mediaGroups||!e.mediaGroups.AUDIO)return t;const i=e.mediaGroups.AUDIO,r=Object.keys(i);let s;if(Object.keys(this.mediaTypes_.AUDIO.groups).length)s=this.mediaTypes_.AUDIO.activeTrack();else{const o=i.main||r.length&&i[r[0]];for(const l in o)if(o[l].default){s={label:l};break}}if(!s)return t;const a=[];for(const o in i)if(i[o][s.label]){const l=i[o][s.label];if(l.playlists&&l.playlists.length)a.push.apply(a,l.playlists);else if(l.uri)a.push(l);else if(e.playlists.length)for(let u=0;u<e.playlists.length;u++){const d=e.playlists[u];d.attributes&&d.attributes.AUDIO&&d.attributes.AUDIO===o&&a.push(d)}}return a.length?a:t}setupMainPlaylistLoaderListeners_(){this.mainPlaylistLoader_.on("loadedmetadata",()=>{const e=this.mainPlaylistLoader_.media(),t=e.targetDuration*1.5*1e3;zd(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=t,e.endList&&this.tech_.preload()!=="none"&&(this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.mainSegmentLoader_.load()),sb({sourceType:this.sourceType_,segmentLoaders:{AUDIO:this.audioSegmentLoader_,SUBTITLES:this.subtitleSegmentLoader_,main:this.mainSegmentLoader_},tech:this.tech_,requestOptions:this.requestOptions_,mainPlaylistLoader:this.mainPlaylistLoader_,vhs:this.vhs_,main:this.main(),mediaTypes:this.mediaTypes_,excludePlaylist:this.excludePlaylist.bind(this)}),this.triggerPresenceUsage_(this.main(),e),this.setupFirstPlay(),!this.mediaTypes_.AUDIO.activePlaylistLoader||this.mediaTypes_.AUDIO.activePlaylistLoader.media()?this.trigger("selectedinitialmedia"):this.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",()=>{this.trigger("selectedinitialmedia")})}),this.mainPlaylistLoader_.on("loadedplaylist",()=>{this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_);let e=this.mainPlaylistLoader_.media();if(!e){this.excludeUnsupportedVariants_();let t;if(this.enableLowInitialPlaylist&&(t=this.selectInitialPlaylist()),t||(t=this.selectPlaylist()),!t||!this.shouldSwitchToMedia_(t)||(this.initialMedia_=t,this.switchMedia_(this.initialMedia_,"initial"),!(this.sourceType_==="vhs-json"&&this.initialMedia_.segments)))return;e=this.initialMedia_}this.handleUpdatedMediaPlaylist(e)}),this.mainPlaylistLoader_.on("error",()=>{const e=this.mainPlaylistLoader_.error;this.excludePlaylist({playlistToExclude:e.playlist,error:e})}),this.mainPlaylistLoader_.on("mediachanging",()=>{this.mainSegmentLoader_.abort(),this.mainSegmentLoader_.pause()}),this.mainPlaylistLoader_.on("mediachange",()=>{const e=this.mainPlaylistLoader_.media(),t=e.targetDuration*1.5*1e3;zd(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=t,this.mainPlaylistLoader_.load(),this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.mainSegmentLoader_.load(),this.tech_.trigger({type:"mediachange",bubbles:!0})}),this.mainPlaylistLoader_.on("playlistunchanged",()=>{const e=this.mainPlaylistLoader_.media();if(e.lastExcludeReason_==="playlist-unchanged")return;this.stuckAtPlaylistEnd_(e)&&(this.excludePlaylist({error:{message:"Playlist no longer updating.",reason:"playlist-unchanged"}}),this.tech_.trigger("playliststuck"))}),this.mainPlaylistLoader_.on("renditiondisabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"})}),this.mainPlaylistLoader_.on("renditionenabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"})})}handleUpdatedMediaPlaylist(e){this.useCueTags_&&this.updateAdCues_(e),this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.updateDuration(!e.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())}triggerPresenceUsage_(e,t){const i=e.mediaGroups||{};let r=!0;const s=Object.keys(i.AUDIO);for(const a in i.AUDIO)for(const o in i.AUDIO[a])i.AUDIO[a][o].uri||(r=!1);r&&this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),Object.keys(i.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),Fr.Playlist.isAes(t)&&this.tech_.trigger({type:"usage",name:"vhs-aes"}),s.length&&Object.keys(i.AUDIO[s[0]]).length>1&&this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"})}shouldSwitchToMedia_(e){const t=this.mainPlaylistLoader_.media()||this.mainPlaylistLoader_.pendingMedia_,i=this.tech_.currentTime(),r=this.bufferLowWaterLine(),s=this.bufferHighWaterLine(),a=this.tech_.buffered();return db({buffered:a,currentTime:i,currentPlaylist:t,nextPlaylist:e,bufferLowWaterLine:r,bufferHighWaterLine:s,duration:this.duration(),bufferBasedABR:this.bufferBasedABR,log:this.logger_})}setupSegmentLoaderListeners_(){this.mainSegmentLoader_.on("bandwidthupdate",()=>{this.checkABR_("bandwidthupdate"),this.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("timeout",()=>{this.bufferBasedABR&&this.mainSegmentLoader_.load()}),this.bufferBasedABR||this.mainSegmentLoader_.on("progress",()=>{this.trigger("progress")}),this.mainSegmentLoader_.on("error",()=>{const t=this.mainSegmentLoader_.error();this.excludePlaylist({playlistToExclude:t.playlist,error:t})}),this.mainSegmentLoader_.on("appenderror",()=>{this.error=this.mainSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",()=>{this.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.audioSegmentLoader_.on("appenderror",()=>{this.error=this.audioSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("ended",()=>{this.logger_("main segment loader ended"),this.onEndOfStream()}),this.mainSegmentLoader_.on("earlyabort",t=>{this.bufferBasedABR||(this.delegateLoaders_("all",["abort"]),this.excludePlaylist({error:{message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},playlistExclusionDuration:ob}))});const e=()=>{if(!this.sourceUpdater_.hasCreatedSourceBuffers())return this.tryToCreateSourceBuffers_();const t=this.getCodecsOrExclude_();!t||this.sourceUpdater_.addOrChangeSourceBuffers(t)};this.mainSegmentLoader_.on("trackinfo",e),this.audioSegmentLoader_.on("trackinfo",e),this.mainSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("ended",()=>{this.logger_("audioSegmentLoader ended"),this.onEndOfStream()})}mediaSecondsLoaded_(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}load(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}fastQualityChange_(e=this.selectPlaylist()){if(e===this.mainPlaylistLoader_.media()){this.logger_("skipping fastQualityChange because new media is same as old");return}this.switchMedia_(e,"fast-quality"),this.mainSegmentLoader_.resetEverything(()=>{Re.browser.IE_VERSION||Re.browser.IS_EDGE?this.tech_.setCurrentTime(this.tech_.currentTime()+.04):this.tech_.setCurrentTime(this.tech_.currentTime())})}play(){if(this.setupFirstPlay())return;this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();const e=this.tech_.seekable();if(this.tech_.duration()===Infinity&&this.tech_.currentTime()<e.start(0))return this.tech_.setCurrentTime(e.end(e.length-1))}setupFirstPlay(){const e=this.mainPlaylistLoader_.media();if(!e||this.tech_.paused()||this.hasPlayed_)return!1;if(!e.endList){const t=this.seekable();if(!t.length)return!1;if(Re.browser.IE_VERSION&&this.tech_.readyState()===0)return this.tech_.one("loadedmetadata",()=>{this.trigger("firstplay"),this.tech_.setCurrentTime(t.end(0)),this.hasPlayed_=!0}),!1;this.trigger("firstplay"),this.tech_.setCurrentTime(t.end(0))}return this.hasPlayed_=!0,this.load(),!0}handleSourceOpen_(){if(this.tryToCreateSourceBuffers_(),this.tech_.autoplay()){const e=this.tech_.play();typeof e!="undefined"&&typeof e.then=="function"&&e.then(null,t=>{})}this.trigger("sourceopen")}handleSourceEnded_(){if(!this.inbandTextTracks_.metadataTrack_)return;const e=this.inbandTextTracks_.metadataTrack_.cues;if(!e||!e.length)return;const t=this.duration();e[e.length-1].endTime=isNaN(t)||Math.abs(t)===Infinity?Number.MAX_VALUE:t}handleDurationChange_(){this.tech_.trigger("durationchange")}onEndOfStream(){let e=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){const t=this.mainSegmentLoader_.getCurrentMediaInfo_();!t||t.hasVideo?e=e&&this.audioSegmentLoader_.ended_:e=this.audioSegmentLoader_.ended_}!e||(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())}stuckAtPlaylistEnd_(e){if(!this.seekable().length)return!1;const i=this.syncController_.getExpiredTime(e,this.duration());if(i===null)return!1;const r=Fr.Playlist.playlistEnd(e,i),s=this.tech_.currentTime(),a=this.tech_.buffered();if(!a.length)return r-s<=Ar;const o=a.end(a.length-1);return o-s<=Ar&&r-o<=Ar}excludePlaylist({playlistToExclude:e=this.mainPlaylistLoader_.media(),error:t={},playlistExclusionDuration:i}){if(e=e||this.mainPlaylistLoader_.media(),i=i||t.playlistExclusionDuration||this.playlistExclusionDuration,!e){this.error=t,this.mediaSource.readyState!=="open"?this.trigger("error"):this.sourceUpdater_.endOfStream("network");return}e.playlistErrors_++;const r=this.mainPlaylistLoader_.main.playlists,s=r.filter(bl),a=s.length===1&&s[0]===e;if(r.length===1&&i!==Infinity)return Re.log.warn(`Problem encountered with playlist ${e.id}. Trying again since it is the only playlist.`),this.tech_.trigger("retryplaylist"),this.mainPlaylistLoader_.load(a);if(a){let x=!1;r.forEach(_=>{if(_===e)return;const R=_.excludeUntil;typeof R!="undefined"&&R!==Infinity&&(x=!0,delete _.excludeUntil)}),x&&(Re.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}let o;e.playlistErrors_>this.maxPlaylistRetries?o=Infinity:o=Date.now()+i*1e3,e.excludeUntil=o,t.reason&&(e.lastExcludeReason_=t.reason),this.tech_.trigger("excludeplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-excluded"});const l=this.selectPlaylist();if(!l){this.error="Playback cannot continue. No available working or supported playlists.",this.trigger("error");return}const u=t.internal?this.logger_:Re.log.warn,d=t.message?" "+t.message:"";u(`${t.internal?"Internal problem":"Problem"} encountered with playlist ${e.id}.${d} Switching to playlist ${l.id}.`),l.attributes.AUDIO!==e.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),l.attributes.SUBTITLES!==e.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]);const h=l.targetDuration/2*1e3||5*1e3,v=typeof l.lastRequest=="number"&&Date.now()-l.lastRequest<=h;return this.switchMedia_(l,"exclude",a||v)}pauseLoading(){this.delegateLoaders_("all",["abort","pause"]),this.stopABRTimer_()}delegateLoaders_(e,t){const i=[],r=e==="all";(r||e==="main")&&i.push(this.mainPlaylistLoader_);const s=[];(r||e==="audio")&&s.push("AUDIO"),(r||e==="subtitle")&&(s.push("CLOSED-CAPTIONS"),s.push("SUBTITLES")),s.forEach(a=>{const o=this.mediaTypes_[a]&&this.mediaTypes_[a].activePlaylistLoader;o&&i.push(o)}),["main","audio","subtitle"].forEach(a=>{const o=this[`${a}SegmentLoader_`];o&&(e===a||e==="all")&&i.push(o)}),i.forEach(a=>t.forEach(o=>{typeof a[o]=="function"&&a[o]()}))}setCurrentTime(e){const t=va(this.tech_.buffered(),e);if(!(this.mainPlaylistLoader_&&this.mainPlaylistLoader_.media())||!this.mainPlaylistLoader_.media().segments)return 0;if(t&&t.length)return e;this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort()),this.load()}duration(){if(!this.mainPlaylistLoader_)return 0;const e=this.mainPlaylistLoader_.media();return e?e.endList?this.mediaSource?this.mediaSource.duration:Fr.Playlist.duration(e):Infinity:0}seekable(){return this.seekable_}onSyncInfoUpdate_(){let e;if(!this.mainPlaylistLoader_)return;let t=this.mainPlaylistLoader_.media();if(!t)return;let i=this.syncController_.getExpiredTime(t,this.duration());if(i===null)return;const r=this.mainPlaylistLoader_.main,s=Fr.Playlist.seekable(t,i,Fr.Playlist.liveEdgeDelay(r,t));if(s.length===0||this.mediaTypes_.AUDIO.activePlaylistLoader&&(t=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),i=this.syncController_.getExpiredTime(t,this.duration()),i===null||(e=Fr.Playlist.seekable(t,i,Fr.Playlist.liveEdgeDelay(r,t)),e.length===0)))return;let a,o;this.seekable_&&this.seekable_.length&&(a=this.seekable_.end(0),o=this.seekable_.start(0)),e?e.start(0)>s.end(0)||s.start(0)>e.end(0)?this.seekable_=s:this.seekable_=Qi([[e.start(0)>s.start(0)?e.start(0):s.start(0),e.end(0)<s.end(0)?e.end(0):s.end(0)]]):this.seekable_=s,!(this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===a&&this.seekable_.start(0)===o)&&(this.logger_(`seekable updated [${Qf(this.seekable_)}]`),this.tech_.trigger("seekablechanged"))}updateDuration(e){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),this.mediaSource.readyState!=="open"){this.updateDuration_=this.updateDuration.bind(this,e),this.mediaSource.addEventListener("sourceopen",this.updateDuration_);return}if(e){const r=this.seekable();if(!r.length)return;(isNaN(this.mediaSource.duration)||this.mediaSource.duration<r.end(r.length-1))&&this.sourceUpdater_.setDuration(r.end(r.length-1));return}const t=this.tech_.buffered();let i=Fr.Playlist.duration(this.mainPlaylistLoader_.media());t.length>0&&(i=Math.max(i,t.end(t.length-1))),this.mediaSource.duration!==i&&this.sourceUpdater_.setDuration(i)}dispose(){this.trigger("dispose"),this.decrypter_.terminate(),this.mainPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_),["AUDIO","SUBTITLES"].forEach(e=>{const t=this.mediaTypes_[e].groups;for(const i in t)t[i].forEach(r=>{r.playlistLoader&&r.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.stopABRTimer_(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()}main(){return this.mainPlaylistLoader_.main}media(){return this.mainPlaylistLoader_.media()||this.initialMedia_}areMediaTypesKnown_(){const e=!!this.mediaTypes_.AUDIO.activePlaylistLoader,t=!!this.mainSegmentLoader_.getCurrentMediaInfo_(),i=e?!!this.audioSegmentLoader_.getCurrentMediaInfo_():!0;return!(!t||!i)}getCodecsOrExclude_(){const e={main:this.mainSegmentLoader_.getCurrentMediaInfo_()||{},audio:this.audioSegmentLoader_.getCurrentMediaInfo_()||{}},t=this.mainSegmentLoader_.getPendingSegmentPlaylist()||this.media();e.video=e.main;const i=oo(this.main(),t),r={},s=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(e.main.hasVideo&&(r.video=i.video||e.main.videoCodec||Zt),e.main.isMuxed&&(r.video+=`,${i.audio||e.main.audioCodec||Jt}`),(e.main.hasAudio&&!e.main.isMuxed||e.audio.hasAudio||s)&&(r.audio=i.audio||e.main.audioCodec||e.audio.audioCodec||Jt,e.audio.isFmp4=e.main.hasAudio&&!e.main.isMuxed?e.main.isFmp4:e.audio.isFmp4),!r.audio&&!r.video){this.excludePlaylist({playlistToExclude:t,error:{message:"Could not determine codecs for playlist."},playlistExclusionDuration:Infinity});return}const a=(u,d)=>u?Mt(d):It(d),o={};let l;if(["video","audio"].forEach(function(u){if(r.hasOwnProperty(u)&&!a(e[u].isFmp4,r[u])){const d=e[u].isFmp4?"browser":"muxer";o[d]=o[d]||[],o[d].push(r[u]),u==="audio"&&(l=d)}}),s&&l&&t.attributes.AUDIO){const u=t.attributes.AUDIO;this.main().playlists.forEach(d=>{(d.attributes&&d.attributes.AUDIO)===u&&d!==t&&(d.excludeUntil=Infinity)}),this.logger_(`excluding audio group ${u} as ${l} does not support codec(s): "${r.audio}"`)}if(Object.keys(o).length){const u=Object.keys(o).reduce((d,h)=>(d&&(d+=", "),d+=`${h} does not support codec(s): "${o[h].join(",")}"`,d),"")+".";this.excludePlaylist({playlistToExclude:t,error:{internal:!0,message:u},playlistExclusionDuration:Infinity});return}if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){const u=[];if(["video","audio"].forEach(d=>{const h=(st(this.sourceUpdater_.codecs[d]||"")[0]||{}).type,v=(st(r[d]||"")[0]||{}).type;h&&v&&h.toLowerCase()!==v.toLowerCase()&&u.push(`"${this.sourceUpdater_.codecs[d]}" -> "${r[d]}"`)}),u.length){this.excludePlaylist({playlistToExclude:t,error:{message:`Codec switching not supported: ${u.join(", ")}.`,internal:!0},playlistExclusionDuration:Infinity});return}}return r}tryToCreateSourceBuffers_(){if(this.mediaSource.readyState!=="open"||this.sourceUpdater_.hasCreatedSourceBuffers()||!this.areMediaTypesKnown_())return;const e=this.getCodecsOrExclude_();if(!e)return;this.sourceUpdater_.createSourceBuffers(e);const t=[e.video,e.audio].filter(Boolean).join(",");this.excludeIncompatibleVariants_(t)}excludeUnsupportedVariants_(){const e=this.main().playlists,t=[];Object.keys(e).forEach(i=>{const r=e[i];if(t.indexOf(r.id)!==-1)return;t.push(r.id);const s=oo(this.main,r),a=[];s.audio&&!It(s.audio)&&!Mt(s.audio)&&a.push(`audio codec ${s.audio}`),s.video&&!It(s.video)&&!Mt(s.video)&&a.push(`video codec ${s.video}`),s.text&&s.text==="stpp.ttml.im1t"&&a.push(`text codec ${s.text}`),a.length&&(r.excludeUntil=Infinity,this.logger_(`excluding ${r.id} for unsupported: ${a.join(", ")}`))})}excludeIncompatibleVariants_(e){const t=[],i=this.main().playlists,r=El(st(e)),s=Fp(r),a=r.video&&st(r.video)[0]||null,o=r.audio&&st(r.audio)[0]||null;Object.keys(i).forEach(l=>{const u=i[l];if(t.indexOf(u.id)!==-1||u.excludeUntil===Infinity)return;t.push(u.id);const d=[],h=oo(this.mainPlaylistLoader_.main,u),v=Fp(h);if(!(!h.audio&&!h.video)){if(v!==s&&d.push(`codec count "${v}" !== "${s}"`),!this.sourceUpdater_.canChangeType()){const x=h.video&&st(h.video)[0]||null,_=h.audio&&st(h.audio)[0]||null;x&&a&&x.type.toLowerCase()!==a.type.toLowerCase()&&d.push(`video codec "${x.type}" !== "${a.type}"`),_&&o&&_.type.toLowerCase()!==o.type.toLowerCase()&&d.push(`audio codec "${_.type}" !== "${o.type}"`)}d.length&&(u.excludeUntil=Infinity,this.logger_(`excluding ${u.id}: ${d.join(" && ")}`))}})}updateAdCues_(e){let t=0;const i=this.seekable();i.length&&(t=i.start(0)),WA(e,this.cueTagsTrack_,t)}goalBufferLength(){const e=this.tech_.currentTime(),t=ji.GOAL_BUFFER_LENGTH,i=ji.GOAL_BUFFER_LENGTH_RATE,r=Math.max(t,ji.MAX_GOAL_BUFFER_LENGTH);return Math.min(t+e*i,r)}bufferLowWaterLine(){const e=this.tech_.currentTime(),t=ji.BUFFER_LOW_WATER_LINE,i=ji.BUFFER_LOW_WATER_LINE_RATE,r=Math.max(t,ji.MAX_BUFFER_LOW_WATER_LINE),s=Math.max(t,ji.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(t+e*i,this.bufferBasedABR?s:r)}bufferHighWaterLine(){return ji.BUFFER_HIGH_WATER_LINE}}const hb=(n,e,t)=>i=>{const r=n.main.playlists[e],s=qd(r),a=bl(r);return typeof i=="undefined"?a:(i?delete r.disabled:r.disabled=!0,i!==a&&!s&&(t(),i?n.trigger("renditionenabled"):n.trigger("renditiondisabled")),i)};class fb{constructor(e,t,i){const{playlistController_:r}=e,s=r.fastQualityChange_.bind(r);if(t.attributes){const a=t.attributes.RESOLUTION;this.width=a&&a.width,this.height=a&&a.height,this.bandwidth=t.attributes.BANDWIDTH,this.frameRate=t.attributes["FRAME-RATE"]}this.codecs=oo(r.main(),t),this.playlist=t,this.id=i,this.enabled=hb(e.playlists,t.id,s)}}const pb=function(n){n.representations=()=>{const e=n.playlistController_.main(),t=ao(e)?n.playlistController_.getAudioTrackPlaylists_():e.playlists;return t?t.filter(i=>!qd(i)).map((i,r)=>new fb(n,i,i.id)):[]}},e0=["seeking","seeked","pause","playing","error"];class mb{constructor(e){this.playlistController_=e.playlistController,this.tech_=e.tech,this.seekable=e.seekable,this.allowSeeksWithinUnsafeLiveWindow=e.allowSeeksWithinUnsafeLiveWindow,this.liveRangeSafeTimeDelta=e.liveRangeSafeTimeDelta,this.media=e.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.checkCurrentTimeTimeout_=null,this.logger_=tr("PlaybackWatcher"),this.logger_("initialize");const t=()=>this.monitorCurrentTime_(),i=()=>this.monitorCurrentTime_(),r=()=>this.techWaiting_(),s=()=>this.resetTimeUpdate_(),a=this.playlistController_,o=["main","subtitle","audio"],l={};o.forEach(d=>{l[d]={reset:()=>this.resetSegmentDownloads_(d),updateend:()=>this.checkSegmentDownloads_(d)},a[`${d}SegmentLoader_`].on("appendsdone",l[d].updateend),a[`${d}SegmentLoader_`].on("playlistupdate",l[d].reset),this.tech_.on(["seeked","seeking"],l[d].reset)});const u=d=>{["main","audio"].forEach(h=>{a[`${h}SegmentLoader_`][d]("appended",this.seekingAppendCheck_)})};this.seekingAppendCheck_=()=>{this.fixesBadSeeks_()&&(this.consecutiveUpdates=0,this.lastRecordedTime=this.tech_.currentTime(),u("off"))},this.clearSeekingAppendCheck_=()=>u("off"),this.watchForBadSeeking_=()=>{this.clearSeekingAppendCheck_(),u("on")},this.tech_.on("seeked",this.clearSeekingAppendCheck_),this.tech_.on("seeking",this.watchForBadSeeking_),this.tech_.on("waiting",r),this.tech_.on(e0,s),this.tech_.on("canplay",i),this.tech_.one("play",t),this.dispose=()=>{this.clearSeekingAppendCheck_(),this.logger_("dispose"),this.tech_.off("waiting",r),this.tech_.off(e0,s),this.tech_.off("canplay",i),this.tech_.off("play",t),this.tech_.off("seeking",this.watchForBadSeeking_),this.tech_.off("seeked",this.clearSeekingAppendCheck_),o.forEach(d=>{a[`${d}SegmentLoader_`].off("appendsdone",l[d].updateend),a[`${d}SegmentLoader_`].off("playlistupdate",l[d].reset),this.tech_.off(["seeked","seeking"],l[d].reset)}),this.checkCurrentTimeTimeout_&&q().clearTimeout(this.checkCurrentTimeTimeout_),this.resetTimeUpdate_()}}monitorCurrentTime_(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&q().clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=q().setTimeout(this.monitorCurrentTime_.bind(this),250)}resetSegmentDownloads_(e){const t=this.playlistController_[`${e}SegmentLoader_`];this[`${e}StalledDownloads_`]>0&&this.logger_(`resetting possible stalled download count for ${e} loader`),this[`${e}StalledDownloads_`]=0,this[`${e}Buffered_`]=t.buffered_()}checkSegmentDownloads_(e){const t=this.playlistController_,i=t[`${e}SegmentLoader_`],r=i.buffered_(),s=hv(this[`${e}Buffered_`],r);if(this[`${e}Buffered_`]=r,s){this.resetSegmentDownloads_(e);return}this[`${e}StalledDownloads_`]++,this.logger_(`found #${this[`${e}StalledDownloads_`]} ${e} appends that did not increase buffer (possible stalled download)`,{playlistId:i.playlist_&&i.playlist_.id,buffered:Os(r)}),!(this[`${e}StalledDownloads_`]<10)&&(this.logger_(`${e} loader stalled download exclusion`),this.resetSegmentDownloads_(e),this.tech_.trigger({type:"usage",name:`vhs-${e}-download-exclusion`}),e!=="subtitle"&&t.excludePlaylist({error:{message:`Excessive ${e} segment downloading detected.`},playlistExclusionDuration:Infinity}))}checkCurrentTime_(){if(this.tech_.paused()||this.tech_.seeking())return;const e=this.tech_.currentTime(),t=this.tech_.buffered();if(this.lastRecordedTime===e&&(!t.length||e+Ar>=t.end(t.length-1)))return this.techWaiting_();this.consecutiveUpdates>=5&&e===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):e===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=e)}resetTimeUpdate_(){this.consecutiveUpdates=0}fixesBadSeeks_(){if(!this.tech_.seeking())return!1;const t=this.seekable(),i=this.tech_.currentTime(),r=this.afterSeekableWindow_(t,i,this.media(),this.allowSeeksWithinUnsafeLiveWindow);let s;if(r&&(s=t.end(t.length-1)),this.beforeSeekableWindow_(t,i)){const _=t.start(0);s=_+(_===t.end(0)?0:Ar)}if(typeof s!="undefined")return this.logger_(`Trying to seek outside of seekable at time ${i} with seekable range ${Qf(t)}. Seeking to ${s}.`),this.tech_.setCurrentTime(s),!0;const a=this.playlistController_.sourceUpdater_,o=this.tech_.buffered(),l=a.audioBuffer?a.audioBuffered():null,u=a.videoBuffer?a.videoBuffered():null,d=this.media(),h=d.partTargetDuration?d.partTargetDuration:(d.targetDuration-cs)*2,v=[l,u];for(let _=0;_<v.length;_++){if(!v[_])continue;if(Hd(v[_],i)<h)return!1}const x=Al(o,i);return x.length===0?!1:(s=x.start(0)+Ar,this.logger_(`Buffered region starts (${x.start(0)})  just beyond seek point (${i}). Seeking to ${s}.`),this.tech_.setCurrentTime(s),!0)}waiting_(){if(this.techWaiting_())return;const e=this.tech_.currentTime(),t=this.tech_.buffered(),i=va(t,e);if(i.length&&e+3<=i.end(0)){this.resetTimeUpdate_(),this.tech_.setCurrentTime(e),this.logger_(`Stopped at ${e} while inside a buffered region [${i.start(0)} -> ${i.end(0)}]. Attempting to resume playback by seeking to the current time.`),this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"});return}}techWaiting_(){const e=this.seekable(),t=this.tech_.currentTime();if(this.tech_.seeking())return!0;if(this.beforeSeekableWindow_(e,t)){const o=e.end(e.length-1);return this.logger_(`Fell out of live window at time ${t}. Seeking to live point (seekable end) ${o}`),this.resetTimeUpdate_(),this.tech_.setCurrentTime(o),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),!0}const i=this.tech_.vhs.playlistController_.sourceUpdater_,r=this.tech_.buffered();if(this.videoUnderflow_({audioBuffered:i.audioBuffered(),videoBuffered:i.videoBuffered(),currentTime:t}))return this.resetTimeUpdate_(),this.tech_.setCurrentTime(t),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),!0;const a=Al(r,t);return a.length>0?(this.logger_(`Stopped at ${t} and seeking to ${a.start(0)}`),this.resetTimeUpdate_(),this.skipTheGap_(t),!0):!1}afterSeekableWindow_(e,t,i,r=!1){if(!e.length)return!1;let s=e.end(e.length-1)+Ar;return!i.endList&&r&&(s=e.end(e.length-1)+i.targetDuration*3),t>s}beforeSeekableWindow_(e,t){return!!(e.length&&e.start(0)>0&&t<e.start(0)-this.liveRangeSafeTimeDelta)}videoUnderflow_({videoBuffered:e,audioBuffered:t,currentTime:i}){if(!e)return;let r;if(e.length&&t.length){const s=va(e,i-3),a=va(e,i),o=va(t,i);o.length&&!a.length&&s.length&&(r={start:s.end(0),end:o.end(0)})}else Al(e,i).length||(r=this.gapFromVideoUnderflow_(e,i));return r?(this.logger_(`Encountered a gap in video from ${r.start} to ${r.end}. Seeking to current time ${i}`),!0):!1}skipTheGap_(e){const t=this.tech_.buffered(),i=this.tech_.currentTime(),r=Al(t,i);this.resetTimeUpdate_(),!(r.length===0||i!==e)&&(this.logger_("skipTheGap_:","currentTime:",i,"scheduled currentTime:",e,"nextRange start:",r.start(0)),this.tech_.setCurrentTime(r.start(0)+cs),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"}))}gapFromVideoUnderflow_(e,t){const i=uv(e);for(let r=0;r<i.length;r++){const s=i.start(r),a=i.end(r);if(t-s<4&&t-s>2)return{start:s,end:a}}return null}}const gb={errorInterval:30,getSource(n){const t=this.tech({IWillNotUseThisInPlugins:!0}).currentSource_||this.currentSource();return n(t)}},t0=function(n,e){let t=0,i=0;const r=ci(gb,e);n.ready(()=>{n.trigger({type:"usage",name:"vhs-error-reload-initialized"})});const s=function(){i&&n.currentTime(i)},a=function(d){d!=null&&(i=n.duration()!==Infinity&&n.currentTime()||0,n.one("loadedmetadata",s),n.src(d),n.trigger({type:"usage",name:"vhs-error-reload"}),n.play())},o=function(){if(Date.now()-t<r.errorInterval*1e3){n.trigger({type:"usage",name:"vhs-error-reload-canceled"});return}if(!r.getSource||typeof r.getSource!="function"){Re.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!");return}return t=Date.now(),r.getSource.call(n,a)},l=function(){n.off("loadedmetadata",s),n.off("error",o),n.off("dispose",l)},u=function(d){l(),t0(n,d)};n.on("error",o),n.on("dispose",l),n.reloadSourceOnError=u},yb=function(n){t0(this,n)};var i0="3.0.2",vb="6.3.0",Ab="1.0.1",bb="6.0.0",_b="4.0.1";const on={PlaylistLoader:ba,Playlist:fn,utils:Pv,STANDARD_PLAYLIST_SELECTOR:Up,INITIAL_PLAYLIST_SELECTOR:_A,lastBandwidthSelector:Up,movingAverageBandwidthSelector:AA,comparePlaylistBandwidth:ac,comparePlaylistResolution:vA,xhr:pp()};Object.keys(ji).forEach(n=>{Object.defineProperty(on,n,{get(){return Re.log.warn(`using Vhs.${n} is UNSAFE be sure you know what you are doing`),ji[n]},set(e){if(Re.log.warn(`using Vhs.${n} is UNSAFE be sure you know what you are doing`),typeof e!="number"||e<0){Re.log.warn(`value of Vhs.${n} must be greater than or equal to 0`);return}ji[n]=e}})});const n0="videojs-vhs",r0=function(n,e){const t=e.media();let i=-1;for(let r=0;r<n.length;r++)if(n[r].id===t.id){i=r;break}n.selectedIndex_=i,n.trigger({selectedIndex:i,type:"change"})},xb=function(n,e){e.representations().forEach(t=>{n.addQualityLevel(t)}),r0(n,e.playlists)};on.canPlaySource=function(){return Re.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")};const Eb=(n,e,t)=>{if(!n)return n;let i={};e&&e.attributes&&e.attributes.CODECS&&(i=El(st(e.attributes.CODECS))),t&&t.attributes&&t.attributes.CODECS&&(i.audio=t.attributes.CODECS);const r=_t(i.video),s=_t(i.audio),a={};for(const o in n)a[o]={},s&&(a[o].audioContentType=s),r&&(a[o].videoContentType=r),e.contentProtection&&e.contentProtection[o]&&e.contentProtection[o].pssh&&(a[o].pssh=e.contentProtection[o].pssh),typeof n[o]=="string"&&(a[o].url=n[o]);return ci(n,a)},Tb=(n,e)=>n.reduce((t,i)=>{if(!i.contentProtection)return t;const r=e.reduce((s,a)=>{const o=i.contentProtection[a];return o&&o.pssh&&(s[a]={pssh:o.pssh}),s},{});return Object.keys(r).length&&t.push(r),t},[]),Sb=({player:n,sourceKeySystems:e,audioMedia:t,mainPlaylists:i})=>{if(!n.eme.initializeMediaKeys)return Promise.resolve();const r=t?i.concat([t]):i,s=Tb(r,Object.keys(e)),a=[],o=[];return s.forEach(l=>{o.push(new Promise((u,d)=>{n.tech_.one("keysessioncreated",u)})),a.push(new Promise((u,d)=>{n.eme.initializeMediaKeys({keySystems:l},h=>{if(h){d(h);return}u()})}))}),Promise.race([Promise.all(a),Promise.race(o)])},Cb=({player:n,sourceKeySystems:e,media:t,audioMedia:i})=>{const r=Eb(e,t,i);return r?(n.currentSource().keySystems=r,r&&!n.eme?(Re.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),!1):!0):!1},s0=()=>{if(!q().localStorage)return null;const n=q().localStorage.getItem(n0);if(!n)return null;try{return JSON.parse(n)}catch(e){return null}},wb=n=>{if(!q().localStorage)return!1;let e=s0();e=e?ci(e,n):n;try{q().localStorage.setItem(n0,JSON.stringify(e))}catch(t){return!1}return e},Lb=n=>n.toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")===0?JSON.parse(n.substring(n.indexOf(",")+1)):n;on.supportsNativeHls=function(){if(!Ee()||!Ee().createElement)return!1;const n=Ee().createElement("video");return Re.getTech("Html5").isSupported()?["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(t){return/maybe|probably/i.test(n.canPlayType(t))}):!1}(),on.supportsNativeDash=function(){return!Ee()||!Ee().createElement||!Re.getTech("Html5").isSupported()?!1:/maybe|probably/i.test(Ee().createElement("video").canPlayType("application/dash+xml"))}(),on.supportsTypeNatively=n=>n==="hls"?on.supportsNativeHls:n==="dash"?on.supportsNativeDash:!1,on.isSupported=function(){return Re.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")};const Db=Re.getComponent("Component");class a0 extends Db{constructor(e,t,i){super(t,i.vhs);if(typeof i.initialBandwidth=="number"&&(this.options_.bandwidth=i.initialBandwidth),this.logger_=tr("VhsHandler"),t.options_&&t.options_.playerId){const r=Re.getPlayer(t.options_.playerId);this.player_=r}if(this.tech_=t,this.source_=e,this.stats={},this.ignoreNextSeekingEvent_=!1,this.setOptions_(),this.options_.overrideNative&&t.overrideNativeAudioTracks&&t.overrideNativeVideoTracks)t.overrideNativeAudioTracks(!0),t.overrideNativeVideoTracks(!0);else if(this.options_.overrideNative&&(t.featuresNativeVideoTracks||t.featuresNativeAudioTracks))throw new Error("Overriding native VHS requires emulated tracks. See https://git.io/vMpjB");this.on(Ee(),["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],r=>{const s=Ee().fullscreenElement||Ee().webkitFullscreenElement||Ee().mozFullScreenElement||Ee().msFullscreenElement;s&&s.contains(this.tech_.el())?this.playlistController_.fastQualityChange_():this.playlistController_.checkABR_()}),this.on(this.tech_,"seeking",function(){if(this.ignoreNextSeekingEvent_){this.ignoreNextSeekingEvent_=!1;return}this.setCurrentTime(this.tech_.currentTime())}),this.on(this.tech_,"error",function(){this.tech_.error()&&this.playlistController_&&this.playlistController_.pauseLoading()}),this.on(this.tech_,"play",this.play)}setOptions_(){if(this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions!==!1,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.useBandwidthFromLocalStorage=typeof this.source_.useBandwidthFromLocalStorage!="undefined"?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.useNetworkInformationApi=this.options_.useNetworkInformationApi||!1,this.options_.useDtsForTimestampOffset=this.options_.useDtsForTimestampOffset||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,this.options_.llhls=this.options_.llhls!==!1,this.options_.bufferBasedABR=this.options_.bufferBasedABR||!1,typeof this.options_.playlistExclusionDuration!="number"&&(this.options_.playlistExclusionDuration=5*60),typeof this.options_.bandwidth!="number"&&this.options_.useBandwidthFromLocalStorage){const e=s0();e&&e.bandwidth&&(this.options_.bandwidth=e.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"})),e&&e.throughput&&(this.options_.throughput=e.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"}))}typeof this.options_.bandwidth!="number"&&(this.options_.bandwidth=ji.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===ji.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","limitRenditionByPlayerDimensions","bandwidth","customTagParsers","customTagMappers","cacheEncryptionKeys","playlistSelector","initialPlaylistSelector","bufferBasedABR","liveRangeSafeTimeDelta","llhls","useNetworkInformationApi","useDtsForTimestampOffset","exactManifestTimings","leastPixelDiffSelector"].forEach(e=>{typeof this.source_[e]!="undefined"&&(this.options_[e]=this.source_[e])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio}src(e,t){if(!e)return;this.setOptions_(),this.options_.src=Lb(this.source_.src),this.options_.tech=this.tech_,this.options_.externVhs=on,this.options_.sourceType=$t(t),this.options_.seekTo=s=>{this.tech_.setCurrentTime(s)},this.playlistController_=new cb(this.options_);const i=ci({liveRangeSafeTimeDelta:Ar},this.options_,{seekable:()=>this.seekable(),media:()=>this.playlistController_.media(),playlistController:this.playlistController_});this.playbackWatcher_=new mb(i),this.playlistController_.on("error",()=>{const s=Re.players[this.tech_.options_.playerId];let a=this.playlistController_.error;typeof a=="object"&&!a.code?a.code=3:typeof a=="string"&&(a={message:a,code:3}),s.error(a)});const r=this.options_.bufferBasedABR?on.movingAverageBandwidthSelector(.55):on.STANDARD_PLAYLIST_SELECTOR;this.playlistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):r.bind(this),this.playlistController_.selectInitialPlaylist=on.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.playlistController_.mainPlaylistLoader_,this.mediaSource=this.playlistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get(){return this.playlistController_.selectPlaylist},set(s){this.playlistController_.selectPlaylist=s.bind(this)}},throughput:{get(){return this.playlistController_.mainSegmentLoader_.throughput.rate},set(s){this.playlistController_.mainSegmentLoader_.throughput.rate=s,this.playlistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get(){let s=this.playlistController_.mainSegmentLoader_.bandwidth;const a=q().navigator.connection||q().navigator.mozConnection||q().navigator.webkitConnection,o=1e7;if(this.options_.useNetworkInformationApi&&a){const l=a.downlink*1e3*1e3;l>=o&&s>=o?s=Math.max(s,l):s=l}return s},set(s){this.playlistController_.mainSegmentLoader_.bandwidth=s,this.playlistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get(){const s=1/(this.bandwidth||1);let a;return this.throughput>0?a=1/this.throughput:a=0,Math.floor(1/(s+a))},set(){Re.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:()=>this.bandwidth||0,enumerable:!0},mediaRequests:{get:()=>this.playlistController_.mediaRequests_()||0,enumerable:!0},mediaRequestsAborted:{get:()=>this.playlistController_.mediaRequestsAborted_()||0,enumerable:!0},mediaRequestsTimedout:{get:()=>this.playlistController_.mediaRequestsTimedout_()||0,enumerable:!0},mediaRequestsErrored:{get:()=>this.playlistController_.mediaRequestsErrored_()||0,enumerable:!0},mediaTransferDuration:{get:()=>this.playlistController_.mediaTransferDuration_()||0,enumerable:!0},mediaBytesTransferred:{get:()=>this.playlistController_.mediaBytesTransferred_()||0,enumerable:!0},mediaSecondsLoaded:{get:()=>this.playlistController_.mediaSecondsLoaded_()||0,enumerable:!0},mediaAppends:{get:()=>this.playlistController_.mediaAppends_()||0,enumerable:!0},mainAppendsToLoadedData:{get:()=>this.playlistController_.mainAppendsToLoadedData_()||0,enumerable:!0},audioAppendsToLoadedData:{get:()=>this.playlistController_.audioAppendsToLoadedData_()||0,enumerable:!0},appendsToLoadedData:{get:()=>this.playlistController_.appendsToLoadedData_()||0,enumerable:!0},timeToLoadedData:{get:()=>this.playlistController_.timeToLoadedData_()||0,enumerable:!0},buffered:{get:()=>Os(this.tech_.buffered()),enumerable:!0},currentTime:{get:()=>this.tech_.currentTime(),enumerable:!0},currentSource:{get:()=>this.tech_.currentSource_,enumerable:!0},currentTech:{get:()=>this.tech_.name_,enumerable:!0},duration:{get:()=>this.tech_.duration(),enumerable:!0},main:{get:()=>this.playlists.main,enumerable:!0},playerDimensions:{get:()=>this.tech_.currentDimensions(),enumerable:!0},seekable:{get:()=>Os(this.tech_.seekable()),enumerable:!0},timestamp:{get:()=>Date.now(),enumerable:!0},videoPlaybackQuality:{get:()=>this.tech_.getVideoPlaybackQuality(),enumerable:!0}}),this.tech_.one("canplay",this.playlistController_.setupFirstPlay.bind(this.playlistController_)),this.tech_.on("bandwidthupdate",()=>{this.options_.useBandwidthFromLocalStorage&&wb({bandwidth:this.bandwidth,throughput:Math.round(this.throughput)})}),this.playlistController_.on("selectedinitialmedia",()=>{pb(this)}),this.playlistController_.sourceUpdater_.on("createdsourcebuffers",()=>{this.setupEme_()}),this.on(this.playlistController_,"progress",function(){this.tech_.trigger("progress")}),this.on(this.playlistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.setupQualityLevels_(),!!this.tech_.el()&&(this.mediaSourceUrl_=q().URL.createObjectURL(this.playlistController_.mediaSource),this.tech_.src(this.mediaSourceUrl_))}createKeySessions_(){const e=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader;this.logger_("waiting for EME key session creation"),Sb({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:e&&e.media(),mainPlaylists:this.playlists.main.playlists}).then(()=>{this.logger_("created EME key session"),this.playlistController_.sourceUpdater_.initializedEme()}).catch(t=>{this.logger_("error while creating EME key session",t),this.player_.error({message:"Failed to initialize media keys for EME",code:3})})}handleWaitingForKey_(){this.logger_("waitingforkey fired, attempting to create any new key sessions"),this.createKeySessions_()}setupEme_(){const e=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader,t=Cb({player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:e&&e.media()});if(this.player_.tech_.on("keystatuschange",i=>{if(i.status!=="output-restricted")return;const r=this.playlistController_.main();if(!r||!r.playlists)return;const s=[];r.playlists.forEach(a=>{a&&a.attributes&&a.attributes.RESOLUTION&&a.attributes.RESOLUTION.height>=720&&(!a.excludeUntil||a.excludeUntil<Infinity)&&(a.excludeUntil=Infinity,s.push(a))}),s.length&&(Re.log.warn('DRM keystatus changed to "output-restricted." Removing the following HD playlists that will most likely fail to play and clearing the buffer. This may be due to HDCP restrictions on the stream and the capabilities of the current device.',...s),this.playlistController_.fastQualityChange_())}),this.handleWaitingForKey_=this.handleWaitingForKey_.bind(this),this.player_.tech_.on("waitingforkey",this.handleWaitingForKey_),Re.browser.IE_VERSION===11||!t){this.playlistController_.sourceUpdater_.initializedEme();return}this.createKeySessions_()}setupQualityLevels_(){const e=Re.players[this.tech_.options_.playerId];!e||!e.qualityLevels||this.qualityLevels_||(this.qualityLevels_=e.qualityLevels(),this.playlistController_.on("selectedinitialmedia",()=>{xb(this.qualityLevels_,this)}),this.playlists.on("mediachange",()=>{r0(this.qualityLevels_,this.playlists)}))}static version(){return{"@videojs/http-streaming":i0,"mux.js":vb,"mpd-parser":Ab,"m3u8-parser":bb,"aes-decrypter":_b}}version(){return this.constructor.version()}canChangeType(){return zp.canChangeType()}play(){this.playlistController_.play()}setCurrentTime(e){this.playlistController_.setCurrentTime(e)}duration(){return this.playlistController_.duration()}seekable(){return this.playlistController_.seekable()}dispose(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.playlistController_&&this.playlistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.mediaSourceUrl_&&q().URL.revokeObjectURL&&(q().URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),this.tech_&&this.tech_.off("waitingforkey",this.handleWaitingForKey_),super.dispose()}convertToProgramTime(e,t){return $v({playlist:this.playlistController_.media(),time:e,callback:t})}seekToProgramTime(e,t,i=!0,r=2){return Ap({programTime:e,playlist:this.playlistController_.media(),retryCount:r,pauseAfterSeek:i,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:t})}}const Dl={name:"videojs-http-streaming",VERSION:i0,canHandleSource(n,e={}){const t=ci(Re.options,e);return Dl.canPlayType(n.type,t)},handleSource(n,e,t={}){const i=ci(Re.options,t);return e.vhs=new a0(n,e,i),e.vhs.xhr=pp(),e.vhs.src(n.src,n.type),e.vhs},canPlayType(n,e){const t=$t(n);if(!t)return"";const i=Dl.getOverrideNative(e);return!on.supportsTypeNatively(t)||i?"maybe":""},getOverrideNative(n={}){const{vhs:e={}}=n,t=!(Re.browser.IS_ANY_SAFARI||Re.browser.IS_IOS),{overrideNative:i=t}=e;return i}};(()=>Mt("avc1.4d400d,mp4a.40.2"))()&&Re.getTech("Html5").registerSourceHandler(Dl,0),Re.VhsHandler=a0,Re.VhsSourceHandler=Dl,Re.Vhs=on,Re.use||Re.registerComponent("Vhs",on),Re.options.vhs=Re.options.vhs||{},(!Re.getPlugin||!Re.getPlugin("reloadSourceOnError"))&&Re.registerPlugin("reloadSourceOnError",yb);var kb=Ne(74020),dc=Ne.n(kb);const Ib=Re.getTech("Html5"),Rb=Re.mergeOptions||Re.util.mergeOptions,Ob={mediaDataSource:{},config:{}};class Mr extends Ib{constructor(e,t){e=Rb(Ob,e),super(e,t)}setSrc(e){this.flvPlayer&&(this.flvPlayer.detachMediaElement(),this.flvPlayer.destroy());const t=this.options_.mediaDataSource,i=this.options_.config;t.type=t.type===void 0?"flv":t.type,t.url=e,this.flvPlayer=dc().createPlayer(t,i),this.flvPlayer.attachMediaElement(this.el_),this.flvPlayer.load()}dispose(){this.flvPlayer&&(this.flvPlayer.detachMediaElement(),this.flvPlayer.destroy()),super.dispose()}}Mr.isSupported=function(){return dc()&&dc().isSupported()},Mr.formats={"video/flv":"FLV","video/x-flv":"FLV"},Mr.canPlayType=function(n){return Mr.isSupported()&&n in Mr.formats?"maybe":""},Mr.canPlaySource=function(n,e){return Mr.canPlayType(n.type)},Mr.VERSION="__VERSION__",Re.registerTech("Flvjs",Mr);var z1=null,Pb=Ne(5953),Bb=Ne.n(Pb);function Fb(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var o0={exports:{}};(function(n,e){(function(t){var i=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,r=/^(?=([^\/?#]*))\1([^]*)$/,s=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,o={buildAbsoluteURL:function(l,u,d){if(d=d||{},l=l.trim(),u=u.trim(),!u){if(!d.alwaysNormalize)return l;var h=o.parseURL(l);if(!h)throw new Error("Error trying to parse base URL.");return h.path=o.normalizePath(h.path),o.buildURLFromParts(h)}var v=o.parseURL(u);if(!v)throw new Error("Error trying to parse relative URL.");if(v.scheme)return d.alwaysNormalize?(v.path=o.normalizePath(v.path),o.buildURLFromParts(v)):u;var x=o.parseURL(l);if(!x)throw new Error("Error trying to parse base URL.");if(!x.netLoc&&x.path&&x.path[0]!=="/"){var _=r.exec(x.path);x.netLoc=_[1],x.path=_[2]}x.netLoc&&!x.path&&(x.path="/");var R={scheme:x.scheme,netLoc:v.netLoc,path:null,params:v.params,query:v.query,fragment:v.fragment};if(!v.netLoc&&(R.netLoc=x.netLoc,v.path[0]!=="/"))if(!v.path)R.path=x.path,v.params||(R.params=x.params,v.query||(R.query=x.query));else{var N=x.path,z=N.substring(0,N.lastIndexOf("/")+1)+v.path;R.path=o.normalizePath(z)}return R.path===null&&(R.path=d.alwaysNormalize?o.normalizePath(v.path):v.path),o.buildURLFromParts(R)},parseURL:function(l){var u=i.exec(l);return u?{scheme:u[1]||"",netLoc:u[2]||"",path:u[3]||"",params:u[4]||"",query:u[5]||"",fragment:u[6]||""}:null},normalizePath:function(l){for(l=l.split("").reverse().join("").replace(s,"");l.length!==(l=l.replace(a,"")).length;);return l.split("").reverse().join("")},buildURLFromParts:function(l){return l.scheme+l.netLoc+l.path+l.params+l.query+l.fragment}};n.exports=o})()})(o0);var cc=o0.exports;function l0(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function pn(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?l0(Object(t),!0).forEach(function(i){Mb(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):l0(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function Mb(n,e,t){return e=Ub(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Bi(){return Bi=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Bi.apply(this,arguments)}function Nb(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Ub(n){var e=Nb(n,"string");return typeof e=="symbol"?e:String(e)}const xt=Number.isFinite||function(n){return typeof n=="number"&&isFinite(n)};let W=function(n){return n.MEDIA_ATTACHING="hlsMediaAttaching",n.MEDIA_ATTACHED="hlsMediaAttached",n.MEDIA_DETACHING="hlsMediaDetaching",n.MEDIA_DETACHED="hlsMediaDetached",n.BUFFER_RESET="hlsBufferReset",n.BUFFER_CODECS="hlsBufferCodecs",n.BUFFER_CREATED="hlsBufferCreated",n.BUFFER_APPENDING="hlsBufferAppending",n.BUFFER_APPENDED="hlsBufferAppended",n.BUFFER_EOS="hlsBufferEos",n.BUFFER_FLUSHING="hlsBufferFlushing",n.BUFFER_FLUSHED="hlsBufferFlushed",n.MANIFEST_LOADING="hlsManifestLoading",n.MANIFEST_LOADED="hlsManifestLoaded",n.MANIFEST_PARSED="hlsManifestParsed",n.LEVEL_SWITCHING="hlsLevelSwitching",n.LEVEL_SWITCHED="hlsLevelSwitched",n.LEVEL_LOADING="hlsLevelLoading",n.LEVEL_LOADED="hlsLevelLoaded",n.LEVEL_UPDATED="hlsLevelUpdated",n.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",n.LEVELS_UPDATED="hlsLevelsUpdated",n.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",n.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",n.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",n.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",n.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",n.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",n.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",n.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",n.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",n.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",n.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",n.CUES_PARSED="hlsCuesParsed",n.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",n.INIT_PTS_FOUND="hlsInitPtsFound",n.FRAG_LOADING="hlsFragLoading",n.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",n.FRAG_LOADED="hlsFragLoaded",n.FRAG_DECRYPTED="hlsFragDecrypted",n.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",n.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",n.FRAG_PARSING_METADATA="hlsFragParsingMetadata",n.FRAG_PARSED="hlsFragParsed",n.FRAG_BUFFERED="hlsFragBuffered",n.FRAG_CHANGED="hlsFragChanged",n.FPS_DROP="hlsFpsDrop",n.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",n.ERROR="hlsError",n.DESTROYING="hlsDestroying",n.KEY_LOADING="hlsKeyLoading",n.KEY_LOADED="hlsKeyLoaded",n.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",n.BACK_BUFFER_REACHED="hlsBackBufferReached",n}({}),Ct=function(n){return n.NETWORK_ERROR="networkError",n.MEDIA_ERROR="mediaError",n.KEY_SYSTEM_ERROR="keySystemError",n.MUX_ERROR="muxError",n.OTHER_ERROR="otherError",n}({}),je=function(n){return n.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",n.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",n.KEY_SYSTEM_NO_SESSION="keySystemNoSession",n.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",n.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",n.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",n.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",n.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",n.MANIFEST_LOAD_ERROR="manifestLoadError",n.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",n.MANIFEST_PARSING_ERROR="manifestParsingError",n.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",n.LEVEL_EMPTY_ERROR="levelEmptyError",n.LEVEL_LOAD_ERROR="levelLoadError",n.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",n.LEVEL_PARSING_ERROR="levelParsingError",n.LEVEL_SWITCH_ERROR="levelSwitchError",n.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",n.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",n.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",n.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",n.FRAG_LOAD_ERROR="fragLoadError",n.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",n.FRAG_DECRYPT_ERROR="fragDecryptError",n.FRAG_PARSING_ERROR="fragParsingError",n.FRAG_GAP="fragGap",n.REMUX_ALLOC_ERROR="remuxAllocError",n.KEY_LOAD_ERROR="keyLoadError",n.KEY_LOAD_TIMEOUT="keyLoadTimeOut",n.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",n.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",n.BUFFER_APPEND_ERROR="bufferAppendError",n.BUFFER_APPENDING_ERROR="bufferAppendingError",n.BUFFER_STALLED_ERROR="bufferStalledError",n.BUFFER_FULL_ERROR="bufferFullError",n.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",n.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",n.INTERNAL_EXCEPTION="internalException",n.INTERNAL_ABORTED="aborted",n.UNKNOWN="unknown",n}({});const Ps=function(){},hc={trace:Ps,debug:Ps,log:Ps,warn:Ps,info:Ps,error:Ps};let co=hc;function jb(n){const e=self.console[n];return e?e.bind(self.console,`[${n}] >`):Ps}function $b(n,...e){e.forEach(function(t){co[t]=n[t]?n[t].bind(n):jb(t)})}function Gb(n,e){if(self.console&&n===!0||typeof n=="object"){$b(n,"debug","log","info","warn","error");try{co.log(`Debug logs enabled for "${e}" in hls.js version 1.4.12`)}catch(t){co=hc}}else co=hc}const Ce=co,Vb=/^(\d+)x(\d+)$/,u0=/(.+?)=(".*?"|.*?)(?:,|$)/g;class bi{constructor(e){typeof e=="string"&&(e=bi.parseAttrList(e));for(const t in e)e.hasOwnProperty(t)&&(t.substring(0,2)==="X-"&&(this.clientAttrs=this.clientAttrs||[],this.clientAttrs.push(t)),this[t]=e[t])}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?Infinity:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const i=new Uint8Array(t.length/2);for(let r=0;r<t.length/2;r++)i[r]=parseInt(t.slice(r*2,r*2+2),16);return i}else return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?Infinity:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const i=this[e];return i?parseFloat(i):t}enumeratedString(e){return this[e]}bool(e){return this[e]==="YES"}decimalResolution(e){const t=Vb.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;const i={},r='"';for(u0.lastIndex=0;(t=u0.exec(e))!==null;){let s=t[2];s.indexOf(r)===0&&s.lastIndexOf(r)===s.length-1&&(s=s.slice(1,-1));const a=t[1].trim();i[a]=s}return i}}function Hb(n){return n!=="ID"&&n!=="CLASS"&&n!=="START-DATE"&&n!=="DURATION"&&n!=="END-DATE"&&n!=="END-ON-NEXT"}function Wb(n){return n==="SCTE35-OUT"||n==="SCTE35-IN"}class d0{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){const i=t.attr;for(const r in i)if(Object.prototype.hasOwnProperty.call(e,r)&&e[r]!==i[r]){Ce.warn(`DATERANGE tag attribute: "${r}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=r;break}e=Bi(new bi({}),i,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const i=new Date(this.attr["END-DATE"]);xt(i.getTime())&&(this._endDate=i)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return e!==null?new Date(this._startDate.getTime()+e*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(xt(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&xt(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class kl{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var ai={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class c0{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[ai.AUDIO]:null,[ai.VIDEO]:null,[ai.AUDIOVIDEO]:null},this.baseurl=e}setByteRange(e,t){const i=e.split("@",2),r=[];i.length===1?r[0]=t?t.byteRangeEndOffset:0:r[0]=parseInt(i[1]),r[1]=parseInt(i[0])+r[0],this._byteRange=r}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=cc.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class fc extends c0{constructor(e,t){super(t);this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new kl,this.urlId=0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.type=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const i=Object.keys(this.levelkeys);if(i.length===1)return this._decryptdata=this.levelkeys[i[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null||!xt(this.programDateTime))return null;const e=xt(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),i=t.length;if(i>1||i===1&&this.levelkeys[t[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,i,r,s,a=!1){const{elementaryStreams:o}=this,l=o[e];if(!l){o[e]={startPTS:t,endPTS:i,startDTS:r,endDTS:s,partial:a};return}l.startPTS=Math.min(l.startPTS,t),l.endPTS=Math.max(l.endPTS,i),l.startDTS=Math.min(l.startDTS,r),l.endDTS=Math.max(l.endDTS,s)}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[ai.AUDIO]=null,e[ai.VIDEO]=null,e[ai.AUDIOVIDEO]=null}}class Kb extends c0{constructor(e,t,i,r,s){super(i);this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new kl,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=r;const a=e.enumeratedString("BYTERANGE");a&&this.setByteRange(a,s),s&&(this.fragOffset=s.fragOffset+s.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}const qb=10;class zb{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,i=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!i||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&i>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return this.fragments.length?xt(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||qb}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function pc(n){return Uint8Array.from(atob(n),e=>e.charCodeAt(0))}function Yb(n){const e=h0(n).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function Xb(n){const e=function(i,r,s){const a=i[r];i[r]=i[s],i[s]=a};e(n,0,3),e(n,1,2),e(n,4,5),e(n,6,7)}function Qb(n){const e=n.split(":");let t=null;if(e[0]==="data"&&e.length===2){const i=e[1].split(";"),r=i[i.length-1].split(",");if(r.length===2){const s=r[0]==="base64",a=r[1];s?(i.splice(-1,1),t=pc(a)):t=Yb(a)}}return t}function h0(n){return Uint8Array.from(unescape(encodeURIComponent(n)),e=>e.charCodeAt(0))}var _i={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},mn={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function f0(n){switch(n){case mn.FAIRPLAY:return _i.FAIRPLAY;case mn.PLAYREADY:return _i.PLAYREADY;case mn.WIDEVINE:return _i.WIDEVINE;case mn.CLEARKEY:return _i.CLEARKEY}}var p0={WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function Zb(n){if(n===p0.WIDEVINE)return _i.WIDEVINE}function m0(n){switch(n){case _i.FAIRPLAY:return mn.FAIRPLAY;case _i.PLAYREADY:return mn.PLAYREADY;case _i.WIDEVINE:return mn.WIDEVINE;case _i.CLEARKEY:return mn.CLEARKEY}}function mc(n){const{drmSystems:e,widevineLicenseUrl:t}=n,i=e?[_i.FAIRPLAY,_i.WIDEVINE,_i.PLAYREADY,_i.CLEARKEY].filter(r=>!!e[r]):[];return!i[_i.WIDEVINE]&&t&&i.push(_i.WIDEVINE),i}const g0=function(){return typeof self!="undefined"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function Jb(n,e,t,i){let r;switch(n){case _i.FAIRPLAY:r=["cenc","sinf"];break;case _i.WIDEVINE:case _i.PLAYREADY:r=["cenc"];break;case _i.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${n}`)}return e_(r,e,t,i)}function e_(n,e,t,i){return[{initDataTypes:n,persistentState:i.persistentState||"not-allowed",distinctiveIdentifier:i.distinctiveIdentifier||"not-allowed",sessionTypes:i.sessionTypes||[i.sessionType||"temporary"],audioCapabilities:e.map(s=>({contentType:`audio/mp4; codecs="${s}"`,robustness:i.audioRobustness||"",encryptionScheme:i.audioEncryptionScheme||null})),videoCapabilities:t.map(s=>({contentType:`video/mp4; codecs="${s}"`,robustness:i.videoRobustness||"",encryptionScheme:i.videoEncryptionScheme||null}))}]}function Bs(n,e,t){return Uint8Array.prototype.slice?n.slice(e,t):new Uint8Array(Array.prototype.slice.call(n,e,t))}const gc=(n,e)=>e+10<=n.length&&n[e]===73&&n[e+1]===68&&n[e+2]===51&&n[e+3]<255&&n[e+4]<255&&n[e+6]<128&&n[e+7]<128&&n[e+8]<128&&n[e+9]<128,y0=(n,e)=>e+10<=n.length&&n[e]===51&&n[e+1]===68&&n[e+2]===73&&n[e+3]<255&&n[e+4]<255&&n[e+6]<128&&n[e+7]<128&&n[e+8]<128&&n[e+9]<128,Il=(n,e)=>{const t=e;let i=0;for(;gc(n,e);)i+=10,i+=Rl(n,e+6),y0(n,e+10)&&(i+=10),e+=i;if(i>0)return n.subarray(t,t+i)},Rl=(n,e)=>{let t=0;return t=(n[e]&127)<<21,t|=(n[e+1]&127)<<14,t|=(n[e+2]&127)<<7,t|=n[e+3]&127,t},t_=(n,e)=>gc(n,e)&&Rl(n,e+6)+10<=n.length-e,i_=n=>{const e=A0(n);for(let t=0;t<e.length;t++){const i=e[t];if(v0(i))return l_(i)}},v0=n=>n&&n.key==="PRIV"&&n.info==="com.apple.streaming.transportStreamTimestamp",n_=n=>{const e=String.fromCharCode(n[0],n[1],n[2],n[3]),t=Rl(n,4),i=10;return{type:e,size:t,data:n.subarray(i,i+t)}},A0=n=>{let e=0;const t=[];for(;gc(n,e);){const i=Rl(n,e+6);e+=10;const r=e+i;for(;e+8<r;){const s=n_(n.subarray(e)),a=r_(s);a&&t.push(a),e+=s.size+10}y0(n,e)&&(e+=10)}return t},r_=n=>n.type==="PRIV"?s_(n):n.type[0]==="W"?o_(n):a_(n),s_=n=>{if(n.size<2)return;const e=xr(n.data,!0),t=new Uint8Array(n.data.subarray(e.length+1));return{key:n.type,info:e,data:t.buffer}},a_=n=>{if(n.size<2)return;if(n.type==="TXXX"){let t=1;const i=xr(n.data.subarray(t),!0);t+=i.length+1;const r=xr(n.data.subarray(t));return{key:n.type,info:i,data:r}}const e=xr(n.data.subarray(1));return{key:n.type,data:e}},o_=n=>{if(n.type==="WXXX"){if(n.size<2)return;let t=1;const i=xr(n.data.subarray(t),!0);t+=i.length+1;const r=xr(n.data.subarray(t));return{key:n.type,info:i,data:r}}const e=xr(n.data);return{key:n.type,data:e}},l_=n=>{if(n.data.byteLength===8){const e=new Uint8Array(n.data),t=e[3]&1;let i=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return i/=45,t&&(i+=4772185884e-2),Math.round(i)}},xr=(n,e=!1)=>{const t=u_();if(t){const u=t.decode(n);if(e){const d=u.indexOf("\0");return d!==-1?u.substring(0,d):u}return u.replace(/\0/g,"")}const i=n.length;let r,s,a,o="",l=0;for(;l<i;){if(r=n[l++],r===0&&e)return o;if(r===0||r===3)continue;switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(r);break;case 12:case 13:s=n[l++],o+=String.fromCharCode((r&31)<<6|s&63);break;case 14:s=n[l++],a=n[l++],o+=String.fromCharCode((r&15)<<12|(s&63)<<6|(a&63)<<0);break}}return o};let yc;function u_(){return!yc&&typeof self.TextDecoder!="undefined"&&(yc=new self.TextDecoder("utf-8")),yc}const Er={hexDump:function(n){let e="";for(let t=0;t<n.length;t++){let i=n[t].toString(16);i.length<2&&(i="0"+i),e+=i}return e}},Ol=Math.pow(2,32)-1,d_=[].push,b0={video:1,audio:2,id3:3,text:4};function qi(n){return String.fromCharCode.apply(null,n)}function _0(n,e){const t=n[e]<<8|n[e+1];return t<0?65536+t:t}function Dt(n,e){const t=x0(n,e);return t<0?4294967296+t:t}function x0(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]}function vc(n,e,t){n[e]=t>>24,n[e+1]=t>>16&255,n[e+2]=t>>8&255,n[e+3]=t&255}function Wt(n,e){const t=[];if(!e.length)return t;const i=n.byteLength;for(let r=0;r<i;){const s=Dt(n,r),a=qi(n.subarray(r+4,r+8)),o=s>1?r+s:i;if(a===e[0])if(e.length===1)t.push(n.subarray(r+8,o));else{const l=Wt(n.subarray(r+8,o),e.slice(1));l.length&&d_.apply(t,l)}r=o}return t}function c_(n){const e=[],t=n[0];let i=8;const r=Dt(n,i);i+=4;const s=0,a=0;t===0?i+=8:i+=16,i+=2;let o=n.length+a;const l=_0(n,i);i+=2;for(let u=0;u<l;u++){let d=i;const h=Dt(n,d);d+=4;const v=h&2147483647;if((h&2147483648)>>>31===1)return Ce.warn("SIDX has hierarchical references (not supported)"),null;const _=Dt(n,d);d+=4,e.push({referenceSize:v,subsegmentDuration:_,info:{duration:_/r,start:o,end:o+v-1}}),o+=v,d+=4,i=d}return{earliestPresentationTime:s,timescale:r,version:t,referencesCount:l,references:e}}function E0(n){const e=[],t=Wt(n,["moov","trak"]);for(let r=0;r<t.length;r++){const s=t[r],a=Wt(s,["tkhd"])[0];if(a){let o=a[0],l=o===0?12:20;const u=Dt(a,l),d=Wt(s,["mdia","mdhd"])[0];if(d){o=d[0],l=o===0?12:20;const h=Dt(d,l),v=Wt(s,["mdia","hdlr"])[0];if(v){const x=qi(v.subarray(8,12)),_={soun:ai.AUDIO,vide:ai.VIDEO}[x];if(_){const R=Wt(s,["mdia","minf","stbl","stsd"])[0];let N;R&&(N=qi(R.subarray(12,16))),e[u]={timescale:h,type:_},e[_]={timescale:h,id:u,codec:N}}}}}}return Wt(n,["moov","mvex","trex"]).forEach(r=>{const s=Dt(r,4),a=e[s];a&&(a.default={duration:Dt(r,12),flags:Dt(r,20)})}),e}function h_(n,e){if(!n||!e)return n;const t=e.keyId;return t&&e.isCommonEncryption&&Wt(n,["moov","trak"]).forEach(r=>{const a=Wt(r,["mdia","minf","stbl","stsd"])[0].subarray(8);let o=Wt(a,["enca"]);const l=o.length>0;l||(o=Wt(a,["encv"])),o.forEach(u=>{const d=l?u.subarray(28):u.subarray(78);Wt(d,["sinf"]).forEach(v=>{const x=T0(v);if(x){const _=x.subarray(8,24);_.some(R=>R!==0)||(Ce.log(`[eme] Patching keyId in 'enc${l?"a":"v"}>sinf>>tenc' box: ${Er.hexDump(_)} -> ${Er.hexDump(t)}`),x.set(t,8))}})})}),n}function T0(n){const e=Wt(n,["schm"])[0];if(e){const t=qi(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return Wt(n,["schi","tenc"])[0]}return Ce.error("[eme] missing 'schm' box"),null}function f_(n,e){return Wt(e,["moof","traf"]).reduce((t,i)=>{const r=Wt(i,["tfdt"])[0],s=r[0],a=Wt(i,["tfhd"]).reduce((o,l)=>{const u=Dt(l,4),d=n[u];if(d){let h=Dt(r,4);if(s===1){if(h===Ol)return Ce.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),o;h*=Ol+1,h+=Dt(r,8)}const v=d.timescale||9e4,x=h/v;if(isFinite(x)&&(o===null||x<o))return x}return o},null);return a!==null&&isFinite(a)&&(t===null||a<t)?a:t},null)}function p_(n,e){let t=0,i=0,r=0;const s=Wt(n,["moof","traf"]);for(let a=0;a<s.length;a++){const o=s[a],l=Wt(o,["tfhd"])[0],u=Dt(l,4),d=e[u];if(!d)continue;const h=d.default,v=Dt(l,0)|(h==null?void 0:h.flags);let x=h==null?void 0:h.duration;v&8&&(v&2?x=Dt(l,12):x=Dt(l,8));const _=d.timescale||9e4,R=Wt(o,["trun"]);for(let N=0;N<R.length;N++){if(t=m_(R[N]),!t&&x){const z=Dt(R[N],4);t=x*z}d.type===ai.VIDEO?i+=t/_:d.type===ai.AUDIO&&(r+=t/_)}}if(i===0&&r===0){let a=0;const o=Wt(n,["sidx"]);for(let l=0;l<o.length;l++){const u=c_(o[l]);u!=null&&u.references&&(a+=u.references.reduce((d,h)=>d+h.info.duration||0,0))}return a}return i||r}function m_(n){const e=Dt(n,0);let t=8;e&1&&(t+=4),e&4&&(t+=4);let i=0;const r=Dt(n,4);for(let s=0;s<r;s++)e&256&&(i+=Dt(n,t),t+=4),e&512&&(t+=4),e&1024&&(t+=4),e&2048&&(t+=4);return i}function g_(n,e,t){Wt(e,["moof","traf"]).forEach(i=>{Wt(i,["tfhd"]).forEach(r=>{const s=Dt(r,4),a=n[s];if(!a)return;const o=a.timescale||9e4;Wt(i,["tfdt"]).forEach(l=>{const u=l[0];let d=Dt(l,4);if(u===0)d-=t*o,d=Math.max(d,0),vc(l,4,d);else{d*=Math.pow(2,32),d+=Dt(l,8),d-=t*o,d=Math.max(d,0);const h=Math.floor(d/(Ol+1)),v=Math.floor(d%(Ol+1));vc(l,4,h),vc(l,8,v)}})})})}function y_(n){const e={valid:null,remainder:null},t=Wt(n,["moof"]);if(t){if(t.length<2)return e.remainder=n,e}else return e;const i=t[t.length-1];return e.valid=Bs(n,0,i.byteOffset-8),e.remainder=Bs(n,i.byteOffset-8),e}function Fs(n,e){const t=new Uint8Array(n.length+e.length);return t.set(n),t.set(e,n.length),t}function S0(n,e){const t=[],i=e.samples,r=e.timescale,s=e.id;let a=!1;return Wt(i,["moof"]).map(l=>{const u=l.byteOffset-8;Wt(l,["traf"]).map(h=>{const v=Wt(h,["tfdt"]).map(x=>{const _=x[0];let R=Dt(x,4);return _===1&&(R*=Math.pow(2,32),R+=Dt(x,8)),R/r})[0];return v!==void 0&&(n=v),Wt(h,["tfhd"]).map(x=>{const _=Dt(x,4),R=Dt(x,0)&16777215,N=(R&1)!=0,z=(R&2)!=0,J=(R&8)!=0;let ue=0;const pe=(R&16)!=0;let te=0;const ke=(R&32)!=0;let we=8;_===s&&(N&&(we+=8),z&&(we+=4),J&&(ue=Dt(x,we),we+=4),pe&&(te=Dt(x,we),we+=4),ke&&(we+=4),e.type==="video"&&(a=v_(e.codec)),Wt(h,["trun"]).map(Ge=>{const Ve=Ge[0],Fe=Dt(Ge,0)&16777215,mt=(Fe&1)!=0;let et=0;const nt=(Fe&4)!=0,Pt=(Fe&256)!=0;let Gt=0;const Kt=(Fe&512)!=0;let qt=0;const ft=(Fe&1024)!=0,bt=(Fe&2048)!=0;let Vt=0;const zt=Dt(Ge,4);let jt=8;mt&&(et=Dt(Ge,jt),jt+=4),nt&&(jt+=4);let vi=et+u;for(let ln=0;ln<zt;ln++){if(Pt?(Gt=Dt(Ge,jt),jt+=4):Gt=ue,Kt?(qt=Dt(Ge,jt),jt+=4):qt=te,ft&&(jt+=4),bt&&(Ve===0?Vt=Dt(Ge,jt):Vt=x0(Ge,jt),jt+=4),e.type===ai.VIDEO){let vn=0;for(;vn<qt;){const un=Dt(i,vi);if(vi+=4,A_(a,i[vi])){const Gr=i.subarray(vi,vi+un);C0(Gr,a?2:1,n+Vt/r,t)}vi+=un,vn+=un+4}}n+=Gt/r}}))})})}),t}function v_(n){if(!n)return!1;const e=n.indexOf("."),t=e<0?n:n.substring(0,e);return t==="hvc1"||t==="hev1"||t==="dvh1"||t==="dvhe"}function A_(n,e){if(n){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function C0(n,e,t,i){const r=w0(n);let s=0;s+=e;let a=0,o=0,l=!1,u=0;for(;s<r.length;){a=0;do{if(s>=r.length)break;u=r[s++],a+=u}while(u===255);o=0;do{if(s>=r.length)break;u=r[s++],o+=u}while(u===255);const d=r.length-s;if(!l&&a===4&&s<r.length){if(l=!0,r[s++]===181){const v=_0(r,s);if(s+=2,v===49){const x=Dt(r,s);if(s+=4,x===1195456820){const _=r[s++];if(_===3){const R=r[s++],N=31&R,z=64&R,J=z?2+N*3:0,ue=new Uint8Array(J);if(z){ue[0]=R;for(let pe=1;pe<J;pe++)ue[pe]=r[s++]}i.push({type:_,payloadType:a,pts:t,bytes:ue})}}}}}else if(a===5&&o<d){if(l=!0,o>16){const h=[];for(let _=0;_<16;_++){const R=r[s++].toString(16);h.push(R.length==1?"0"+R:R),(_===3||_===5||_===7||_===9)&&h.push("-")}const v=o-16,x=new Uint8Array(v);for(let _=0;_<v;_++)x[_]=r[s++];i.push({payloadType:a,pts:t,uuid:h.join(""),userData:xr(x),userDataBytes:x})}}else if(o<d)s+=o;else if(o>d)break}}function w0(n){const e=n.byteLength,t=[];let i=1;for(;i<e-2;)n[i]===0&&n[i+1]===0&&n[i+2]===3?(t.push(i+2),i+=2):i++;if(t.length===0)return n;const r=e-t.length,s=new Uint8Array(r);let a=0;for(i=0;i<r;a++,i++)a===t[0]&&(a++,t.shift()),s[i]=n[a];return s}function b_(n){const e=n[0];let t="",i="",r=0,s=0,a=0,o=0,l=0,u=0;if(e===0){for(;qi(n.subarray(u,u+1))!=="\0";)t+=qi(n.subarray(u,u+1)),u+=1;for(t+=qi(n.subarray(u,u+1)),u+=1;qi(n.subarray(u,u+1))!=="\0";)i+=qi(n.subarray(u,u+1)),u+=1;i+=qi(n.subarray(u,u+1)),u+=1,r=Dt(n,12),s=Dt(n,16),o=Dt(n,20),l=Dt(n,24),u=28}else if(e===1){u+=4,r=Dt(n,u),u+=4;const h=Dt(n,u);u+=4;const v=Dt(n,u);for(u+=4,a=Qg(2,32)*h+v,Number.isSafeInteger(a)||(a=Number.MAX_SAFE_INTEGER,Ce.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=Dt(n,u),u+=4,l=Dt(n,u),u+=4;qi(n.subarray(u,u+1))!=="\0";)t+=qi(n.subarray(u,u+1)),u+=1;for(t+=qi(n.subarray(u,u+1)),u+=1;qi(n.subarray(u,u+1))!=="\0";)i+=qi(n.subarray(u,u+1)),u+=1;i+=qi(n.subarray(u,u+1)),u+=1}const d=n.subarray(u,n.byteLength);return{schemeIdUri:t,value:i,timeScale:r,presentationTime:a,presentationTimeDelta:s,eventDuration:o,id:l,payload:d}}function __(n,...e){const t=e.length;let i=8,r=t;for(;r--;)i+=e[r].byteLength;const s=new Uint8Array(i);for(s[0]=i>>24&255,s[1]=i>>16&255,s[2]=i>>8&255,s[3]=i&255,s.set(n,4),r=0,i=8;r<t;r++)s.set(e[r],i),i+=e[r].byteLength;return s}function x_(n,e,t){if(n.byteLength!==16)throw new RangeError("Invalid system id");let i,r;if(e){i=1,r=new Uint8Array(e.length*16);for(let o=0;o<e.length;o++){const l=e[o];if(l.byteLength!==16)throw new RangeError("Invalid key");r.set(l,o*16)}}else i=0,r=new Uint8Array;let s;i>0?(s=new Uint8Array(4),e.length>0&&new DataView(s.buffer).setUint32(0,e.length,!1)):s=new Uint8Array;const a=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(a.buffer).setUint32(0,t.byteLength,!1),__([112,115,115,104],new Uint8Array([i,0,0,0]),n,s,r,a,t||new Uint8Array)}function E_(n){if(!(n instanceof ArrayBuffer)||n.byteLength<32)return null;const e={version:0,systemId:"",kids:null,data:null},t=new DataView(n),i=t.getUint32(0);if(n.byteLength!==i&&i>44||t.getUint32(4)!==1886614376||(e.version=t.getUint32(8)>>>24,e.version>1))return null;e.systemId=Er.hexDump(new Uint8Array(n,12,16));const s=t.getUint32(28);if(e.version===0){if(i-32<s)return null;e.data=new Uint8Array(n,32,s)}else if(e.version===1){e.kids=[];for(let a=0;a<s;a++)e.kids.push(new Uint8Array(n,32+a*16,16))}return e}let Pl={};class ho{static clearKeyUriToKeyIdMap(){Pl={}}constructor(e,t,i,r=[1],s=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=i,this.keyFormatVersions=r,this.iv=s,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&e!=="AES-128"}isSupported(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case mn.FAIRPLAY:case mn.WIDEVINE:case mn.PLAYREADY:case mn.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof e!="number"&&(this.method==="AES-128"&&!this.iv&&Ce.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const i=T_(e);return new ho(this.method,this.uri,"identity",this.keyFormatVersions,i)}const t=Qb(this.uri);if(t)switch(this.keyFormat){case mn.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case mn.PLAYREADY:{const i=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=x_(i,null,t);const r=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),s=String.fromCharCode.apply(null,Array.from(r)),a=s.substring(s.indexOf("<"),s.length),u=new DOMParser().parseFromString(a,"text/xml").getElementsByTagName("KID")[0];if(u){const d=u.childNodes[0]?u.childNodes[0].nodeValue:u.getAttribute("VALUE");if(d){const h=pc(d).subarray(0,16);Xb(h),this.keyId=h}}break}default:{let i=t.subarray(0,16);if(i.length!==16){const r=new Uint8Array(16);r.set(i,16-i.length),i=r}this.keyId=i;break}}if(!this.keyId||this.keyId.byteLength!==16){let i=Pl[this.uri];if(!i){const r=Object.keys(Pl).length%Number.MAX_SAFE_INTEGER;i=new Uint8Array(16),new DataView(i.buffer,12,4).setUint32(0,r),Pl[this.uri]=i}this.keyId=i}return this}}function T_(n){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=n>>8*(15-t)&255;return e}const L0=/\{\$([a-zA-Z0-9-_]+)\}/g;function D0(n){return L0.test(n)}function gn(n,e,t){if(n.variableList!==null||n.hasVariableRefs)for(let i=t.length;i--;){const r=t[i],s=e[r];s&&(e[r]=Ac(n,s))}}function Ac(n,e){if(n.variableList!==null||n.hasVariableRefs){const t=n.variableList;return e.replace(L0,i=>{const r=i.substring(2,i.length-1),s=t==null?void 0:t[r];return s===void 0?(n.playlistParsingError||(n.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${r}"`)),i):s})}return e}function k0(n,e,t){let i=n.variableList;i||(n.variableList=i={});let r,s;if("QUERYPARAM"in e){r=e.QUERYPARAM;try{const a=new self.URL(t).searchParams;if(a.has(r))s=a.get(r);else throw new Error(`"${r}" does not match any query parameter in URI: "${t}"`)}catch(a){n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${a.message}`))}}else r=e.NAME,s=e.VALUE;r in i?n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${r}"`)):i[r]=s||""}function S_(n,e,t){const i=e.IMPORT;if(t&&i in t){let r=n.variableList;r||(n.variableList=r={}),r[i]=t[i]}else n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${i}"`))}function Bl(){if(typeof self!="undefined")return self.MediaSource||self.WebKitMediaSource}const C_={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}},I0=Bl();function w_(n,e){const t=C_[e];return!!t&&t[n.slice(0,4)]===!0}function bc(n,e){var t;return(t=I0==null?void 0:I0.isTypeSupported(`${e||"video"}/mp4;codecs="${n}"`))!=null?t:!1}const R0=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,O0=/#EXT-X-MEDIA:(.*)/g,L_=/^#EXT(?:INF|-X-TARGETDURATION):/m,P0=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),D_=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class ir{static findGroup(e,t){for(let i=0;i<e.length;i++){const r=e[i];if(r.id===t)return r}}static convertAVC1ToAVCOTI(e){const t=e.split(".");if(t.length>2){let i=t.shift()+".";return i+=parseInt(t.shift()).toString(16),i+=("000"+parseInt(t.shift()).toString(16)).slice(-4),i}return e}static resolve(e,t){return cc.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return L_.test(e)}static parseMasterPlaylist(e,t){const i=D0(e),r={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:i},s=[];R0.lastIndex=0;let a;for(;(a=R0.exec(e))!=null;)if(a[1]){var o;const u=new bi(a[1]);gn(r,u,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const d=Ac(r,a[2]),h={attrs:u,bitrate:u.decimalInteger("AVERAGE-BANDWIDTH")||u.decimalInteger("BANDWIDTH"),name:u.NAME,url:ir.resolve(d,t)},v=u.decimalResolution("RESOLUTION");v&&(h.width=v.width,h.height=v.height),k_((u.CODECS||"").split(/[ ,]+/).filter(x=>x),h),h.videoCodec&&h.videoCodec.indexOf("avc1")!==-1&&(h.videoCodec=ir.convertAVC1ToAVCOTI(h.videoCodec)),(o=h.unknownCodecs)!=null&&o.length||s.push(h),r.levels.push(h)}else if(a[3]){const u=a[3],d=a[4];switch(u){case"SESSION-DATA":{const h=new bi(d);gn(r,h,["DATA-ID","LANGUAGE","VALUE","URI"]);const v=h["DATA-ID"];v&&(r.sessionData===null&&(r.sessionData={}),r.sessionData[v]=h);break}case"SESSION-KEY":{const h=B0(d,t,r);h.encrypted&&h.isSupported()?(r.sessionKeys===null&&(r.sessionKeys=[]),r.sessionKeys.push(h)):Ce.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${d}"`);break}case"DEFINE":{{const h=new bi(d);gn(r,h,["NAME","VALUE","QUERYPARAM"]),k0(r,h,t)}break}case"CONTENT-STEERING":{const h=new bi(d);gn(r,h,["SERVER-URI","PATHWAY-ID"]),r.contentSteering={uri:ir.resolve(h["SERVER-URI"],t),pathwayId:h["PATHWAY-ID"]||"."};break}case"START":{r.startTimeOffset=F0(d);break}}}const l=s.length>0&&s.length<r.levels.length;return r.levels=l?s:r.levels,r.levels.length===0&&(r.playlistParsingError=new Error("no levels found in manifest")),r}static parseMasterPlaylistMedia(e,t,i){let r;const s={},a=i.levels,o={AUDIO:a.map(u=>({id:u.attrs.AUDIO,audioCodec:u.audioCodec})),SUBTITLES:a.map(u=>({id:u.attrs.SUBTITLES,textCodec:u.textCodec})),"CLOSED-CAPTIONS":[]};let l=0;for(O0.lastIndex=0;(r=O0.exec(e))!==null;){const u=new bi(r[1]),d=u.TYPE;if(d){const h=o[d],v=s[d]||[];s[d]=v,gn(i,u,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const x={attrs:u,bitrate:0,id:l++,groupId:u["GROUP-ID"]||"",instreamId:u["INSTREAM-ID"],name:u.NAME||u.LANGUAGE||"",type:d,default:u.bool("DEFAULT"),autoselect:u.bool("AUTOSELECT"),forced:u.bool("FORCED"),lang:u.LANGUAGE,url:u.URI?ir.resolve(u.URI,t):""};if(h!=null&&h.length){const _=ir.findGroup(h,x.groupId)||h[0];M0(x,_,"audioCodec"),M0(x,_,"textCodec")}v.push(x)}}return s}static parseLevelPlaylist(e,t,i,r,s,a){const o=new zb(t),l=o.fragments;let u=null,d=0,h=0,v=0,x=0,_=null,R=new fc(r,t),N,z,J,ue=-1,pe=!1;for(P0.lastIndex=0,o.m3u8=e,o.hasVariableRefs=D0(e);(N=P0.exec(e))!==null;){pe&&(pe=!1,R=new fc(r,t),R.start=v,R.sn=d,R.cc=x,R.level=i,u&&(R.initSegment=u,R.rawProgramDateTime=u.rawProgramDateTime,u.rawProgramDateTime=null));const Ge=N[1];if(Ge){R.duration=parseFloat(Ge);const Ve=(" "+N[2]).slice(1);R.title=Ve||null,R.tagList.push(Ve?["INF",Ge,Ve]:["INF",Ge])}else if(N[3]){if(xt(R.duration)){R.start=v,J&&j0(R,J,o),R.sn=d,R.level=i,R.cc=x,R.urlId=s,l.push(R);const Ve=(" "+N[3]).slice(1);R.relurl=Ac(o,Ve),N0(R,_),_=R,v+=R.duration,d++,h=0,pe=!0}}else if(N[4]){const Ve=(" "+N[4]).slice(1);_?R.setByteRange(Ve,_):R.setByteRange(Ve)}else if(N[5])R.rawProgramDateTime=(" "+N[5]).slice(1),R.tagList.push(["PROGRAM-DATE-TIME",R.rawProgramDateTime]),ue===-1&&(ue=l.length);else{if(N=N[0].match(D_),!N){Ce.warn("No matches on slow regex match for level playlist!");continue}for(z=1;z<N.length&&typeof N[z]=="undefined";z++);const Ve=(" "+N[z]).slice(1),Fe=(" "+N[z+1]).slice(1),mt=N[z+2]?(" "+N[z+2]).slice(1):"";switch(Ve){case"PLAYLIST-TYPE":o.type=Fe.toUpperCase();break;case"MEDIA-SEQUENCE":d=o.startSN=parseInt(Fe);break;case"SKIP":{const et=new bi(Fe);gn(o,et,["RECENTLY-REMOVED-DATERANGES"]);const nt=et.decimalInteger("SKIPPED-SEGMENTS");if(xt(nt)){o.skippedSegments=nt;for(let Gt=nt;Gt--;)l.unshift(null);d+=nt}const Pt=et.enumeratedString("RECENTLY-REMOVED-DATERANGES");Pt&&(o.recentlyRemovedDateranges=Pt.split("	"));break}case"TARGETDURATION":o.targetduration=Math.max(parseInt(Fe),1);break;case"VERSION":o.version=parseInt(Fe);break;case"EXTM3U":break;case"ENDLIST":o.live=!1;break;case"#":(Fe||mt)&&R.tagList.push(mt?[Fe,mt]:[Fe]);break;case"DISCONTINUITY":x++,R.tagList.push(["DIS"]);break;case"GAP":R.gap=!0,R.tagList.push([Ve]);break;case"BITRATE":R.tagList.push([Ve,Fe]);break;case"DATERANGE":{const et=new bi(Fe);gn(o,et,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),gn(o,et,et.clientAttrs);const nt=new d0(et,o.dateRanges[et.ID]);nt.isValid||o.skippedSegments?o.dateRanges[nt.id]=nt:Ce.warn(`Ignoring invalid DATERANGE tag: "${Fe}"`),R.tagList.push(["EXT-X-DATERANGE",Fe]);break}case"DEFINE":{{const et=new bi(Fe);gn(o,et,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in et?S_(o,et,a):k0(o,et,t)}break}case"DISCONTINUITY-SEQUENCE":x=parseInt(Fe);break;case"KEY":{const et=B0(Fe,t,o);if(et.isSupported()){if(et.method==="NONE"){J=void 0;break}J||(J={}),J[et.keyFormat]&&(J=Bi({},J)),J[et.keyFormat]=et}else Ce.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${Fe}"`);break}case"START":o.startTimeOffset=F0(Fe);break;case"MAP":{const et=new bi(Fe);if(gn(o,et,["BYTERANGE","URI"]),R.duration){const nt=new fc(r,t);U0(nt,et,i,J),u=nt,R.initSegment=u,u.rawProgramDateTime&&!R.rawProgramDateTime&&(R.rawProgramDateTime=u.rawProgramDateTime)}else U0(R,et,i,J),u=R,pe=!0;break}case"SERVER-CONTROL":{const et=new bi(Fe);o.canBlockReload=et.bool("CAN-BLOCK-RELOAD"),o.canSkipUntil=et.optionalFloat("CAN-SKIP-UNTIL",0),o.canSkipDateRanges=o.canSkipUntil>0&&et.bool("CAN-SKIP-DATERANGES"),o.partHoldBack=et.optionalFloat("PART-HOLD-BACK",0),o.holdBack=et.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const et=new bi(Fe);o.partTarget=et.decimalFloatingPoint("PART-TARGET");break}case"PART":{let et=o.partList;et||(et=o.partList=[]);const nt=h>0?et[et.length-1]:void 0,Pt=h++,Gt=new bi(Fe);gn(o,Gt,["BYTERANGE","URI"]);const Kt=new Kb(Gt,R,t,Pt,nt);et.push(Kt),R.duration+=Kt.duration;break}case"PRELOAD-HINT":{const et=new bi(Fe);gn(o,et,["URI"]),o.preloadHint=et;break}case"RENDITION-REPORT":{const et=new bi(Fe);gn(o,et,["URI"]),o.renditionReports=o.renditionReports||[],o.renditionReports.push(et);break}default:Ce.warn(`line parsed but not handled: ${N}`);break}}}_&&!_.relurl?(l.pop(),v-=_.duration,o.partList&&(o.fragmentHint=_)):o.partList&&(N0(R,_),R.cc=x,o.fragmentHint=R,J&&j0(R,J,o));const te=l.length,ke=l[0],we=l[te-1];if(v+=o.skippedSegments*o.targetduration,v>0&&te&&we){o.averagetargetduration=v/te;const Ge=we.sn;o.endSN=Ge!=="initSegment"?Ge:0,o.live||(we.endList=!0),ke&&(o.startCC=ke.cc)}else o.endSN=0,o.startCC=0;return o.fragmentHint&&(v+=o.fragmentHint.duration),o.totalduration=v,o.endCC=x,ue>0&&I_(l,ue),o}}function B0(n,e,t){var i,r;const s=new bi(n);gn(t,s,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const a=(i=s.METHOD)!=null?i:"",o=s.URI,l=s.hexadecimalInteger("IV"),u=s.KEYFORMATVERSIONS,d=(r=s.KEYFORMAT)!=null?r:"identity";o&&s.IV&&!l&&Ce.error(`Invalid IV: ${s.IV}`);const h=o?ir.resolve(o,e):"",v=(u||"1").split("/").map(Number).filter(Number.isFinite);return new ho(a,h,d,v,l)}function F0(n){const t=new bi(n).decimalFloatingPoint("TIME-OFFSET");return xt(t)?t:null}function k_(n,e){["video","audio","text"].forEach(t=>{const i=n.filter(r=>w_(r,t));if(i.length){const r=i.filter(s=>s.lastIndexOf("avc1",0)===0||s.lastIndexOf("mp4a",0)===0);e[`${t}Codec`]=r.length>0?r[0]:i[0],n=n.filter(s=>i.indexOf(s)===-1)}}),e.unknownCodecs=n}function M0(n,e,t){const i=e[t];i&&(n[t]=i)}function I_(n,e){let t=n[e];for(let i=e;i--;){const r=n[i];if(!r)return;r.programDateTime=t.programDateTime-r.duration*1e3,t=r}}function N0(n,e){n.rawProgramDateTime?n.programDateTime=Date.parse(n.rawProgramDateTime):e!=null&&e.programDateTime&&(n.programDateTime=e.endProgramDateTime),xt(n.programDateTime)||(n.programDateTime=null,n.rawProgramDateTime=null)}function U0(n,e,t,i){n.relurl=e.URI,e.BYTERANGE&&n.setByteRange(e.BYTERANGE),n.level=t,n.sn="initSegment",i&&(n.levelkeys=i),n.initSegment=null}function j0(n,e,t){n.levelkeys=e;const{encryptedFragments:i}=t;(!i.length||i[i.length-1].levelkeys!==e)&&Object.keys(e).some(r=>e[r].isCommonEncryption)&&i.push(n)}var Qt={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},Lt={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function $0(n){const{type:e}=n;switch(e){case Qt.AUDIO_TRACK:return Lt.AUDIO;case Qt.SUBTITLE_TRACK:return Lt.SUBTITLE;default:return Lt.MAIN}}function _c(n,e){let t=n.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class R_{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(W.MANIFEST_LOADING,this.onManifestLoading,this),e.on(W.LEVEL_LOADING,this.onLevelLoading,this),e.on(W.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(W.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(W.MANIFEST_LOADING,this.onManifestLoading,this),e.off(W.LEVEL_LOADING,this.onLevelLoading,this),e.off(W.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(W.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const t=this.hls.config,i=t.pLoader,r=t.loader,s=i||r,a=new s(t);return this.loaders[e.type]=a,a}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:i}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Qt.MANIFEST,url:i,deliveryDirectives:null})}onLevelLoading(e,t){const{id:i,level:r,url:s,deliveryDirectives:a}=t;this.load({id:i,level:r,responseType:"text",type:Qt.LEVEL,url:s,deliveryDirectives:a})}onAudioTrackLoading(e,t){const{id:i,groupId:r,url:s,deliveryDirectives:a}=t;this.load({id:i,groupId:r,level:null,responseType:"text",type:Qt.AUDIO_TRACK,url:s,deliveryDirectives:a})}onSubtitleTrackLoading(e,t){const{id:i,groupId:r,url:s,deliveryDirectives:a}=t;this.load({id:i,groupId:r,level:null,responseType:"text",type:Qt.SUBTITLE_TRACK,url:s,deliveryDirectives:a})}load(e){var t;const i=this.hls.config;let r=this.getInternalLoader(e);if(r){const u=r.context;if(u&&u.url===e.url){Ce.trace("[playlist-loader]: playlist request ongoing");return}Ce.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),r.abort()}let s;if(e.type===Qt.MANIFEST?s=i.manifestLoadPolicy.default:s=Bi({},i.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(e),(t=e.deliveryDirectives)!=null&&t.part){let u;if(e.type===Qt.LEVEL&&e.level!==null?u=this.hls.levels[e.level].details:e.type===Qt.AUDIO_TRACK&&e.id!==null?u=this.hls.audioTracks[e.id].details:e.type===Qt.SUBTITLE_TRACK&&e.id!==null&&(u=this.hls.subtitleTracks[e.id].details),u){const d=u.partTarget,h=u.targetduration;if(d&&h){const v=Math.max(d*3,h*.8)*1e3;s=Bi({},s,{maxTimeToFirstByteMs:Math.min(v,s.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(v,s.maxTimeToFirstByteMs)})}}}const a=s.errorRetry||s.timeoutRetry||{},o={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},l={onSuccess:(u,d,h,v)=>{const x=this.getInternalLoader(h);this.resetInternalLoader(h.type);const _=u.data;if(_.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(u,h,new Error("no EXTM3U delimiter"),v||null,d);return}d.parsing.start=performance.now(),ir.isMediaPlaylist(_)?this.handleTrackOrLevelPlaylist(u,d,h,v||null,x):this.handleMasterPlaylist(u,d,h,v)},onError:(u,d,h,v)=>{this.handleNetworkError(d,h,!1,u,v)},onTimeout:(u,d,h)=>{this.handleNetworkError(d,h,!0,void 0,u)}};r.load(e,o,l)}handleMasterPlaylist(e,t,i,r){const s=this.hls,a=e.data,o=_c(e,i),l=ir.parseMasterPlaylist(a,o);if(l.playlistParsingError){this.handleManifestParsingError(e,i,l.playlistParsingError,r,t);return}const{contentSteering:u,levels:d,sessionData:h,sessionKeys:v,startTimeOffset:x,variableList:_}=l;this.variableList=_;const{AUDIO:R=[],SUBTITLES:N,"CLOSED-CAPTIONS":z}=ir.parseMasterPlaylistMedia(a,o,l);R.length&&!R.some(ue=>!ue.url)&&d[0].audioCodec&&!d[0].attrs.AUDIO&&(Ce.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),R.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new bi({}),bitrate:0,url:""})),s.trigger(W.MANIFEST_LOADED,{levels:d,audioTracks:R,subtitles:N,captions:z,contentSteering:u,url:o,stats:t,networkDetails:r,sessionData:h,sessionKeys:v,startTimeOffset:x,variableList:_})}handleTrackOrLevelPlaylist(e,t,i,r,s){const a=this.hls,{id:o,level:l,type:u}=i,d=_c(e,i),h=xt(o)?o:0,v=xt(l)?l:h,x=$0(i),_=ir.parseLevelPlaylist(e.data,d,v,x,h,this.variableList);if(u===Qt.MANIFEST){const R={attrs:new bi({}),bitrate:0,details:_,name:"",url:d};a.trigger(W.MANIFEST_LOADED,{levels:[R],audioTracks:[],url:d,stats:t,networkDetails:r,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),i.levelDetails=_,this.handlePlaylistLoaded(_,e,t,i,r,s)}handleManifestParsingError(e,t,i,r,s){this.hls.trigger(W.ERROR,{type:Ct.NETWORK_ERROR,details:je.MANIFEST_PARSING_ERROR,fatal:t.type===Qt.MANIFEST,url:e.url,err:i,error:i,reason:i.message,response:e,context:t,networkDetails:r,stats:s})}handleNetworkError(e,t,i=!1,r,s){let a=`A network ${i?"timeout":"error"+(r?" (status "+r.code+")":"")} occurred while loading ${e.type}`;e.type===Qt.LEVEL?a+=`: ${e.level} id: ${e.id}`:(e.type===Qt.AUDIO_TRACK||e.type===Qt.SUBTITLE_TRACK)&&(a+=` id: ${e.id} group-id: "${e.groupId}"`);const o=new Error(a);Ce.warn(`[playlist-loader]: ${a}`);let l=je.UNKNOWN,u=!1;const d=this.getInternalLoader(e);switch(e.type){case Qt.MANIFEST:l=i?je.MANIFEST_LOAD_TIMEOUT:je.MANIFEST_LOAD_ERROR,u=!0;break;case Qt.LEVEL:l=i?je.LEVEL_LOAD_TIMEOUT:je.LEVEL_LOAD_ERROR,u=!1;break;case Qt.AUDIO_TRACK:l=i?je.AUDIO_TRACK_LOAD_TIMEOUT:je.AUDIO_TRACK_LOAD_ERROR,u=!1;break;case Qt.SUBTITLE_TRACK:l=i?je.SUBTITLE_TRACK_LOAD_TIMEOUT:je.SUBTITLE_LOAD_ERROR,u=!1;break}d&&this.resetInternalLoader(e.type);const h={type:Ct.NETWORK_ERROR,details:l,fatal:u,url:e.url,loader:d,context:e,error:o,networkDetails:t,stats:s};if(r){const v=(t==null?void 0:t.url)||e.url;h.response=pn({url:v,data:void 0},r)}this.hls.trigger(W.ERROR,h)}handlePlaylistLoaded(e,t,i,r,s,a){const o=this.hls,{type:l,level:u,id:d,groupId:h,deliveryDirectives:v}=r,x=_c(t,r),_=$0(r),R=typeof r.level=="number"&&_===Lt.MAIN?u:void 0;if(!e.fragments.length){const z=new Error("No Segments found in Playlist");o.trigger(W.ERROR,{type:Ct.NETWORK_ERROR,details:je.LEVEL_EMPTY_ERROR,fatal:!1,url:x,error:z,reason:z.message,response:t,context:r,level:R,parent:_,networkDetails:s,stats:i});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const N=e.playlistParsingError;if(N){o.trigger(W.ERROR,{type:Ct.NETWORK_ERROR,details:je.LEVEL_PARSING_ERROR,fatal:!1,url:x,error:N,reason:N.message,response:t,context:r,level:R,parent:_,networkDetails:s,stats:i});return}switch(e.live&&a&&(a.getCacheAge&&(e.ageHeader=a.getCacheAge()||0),(!a.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),l){case Qt.MANIFEST:case Qt.LEVEL:o.trigger(W.LEVEL_LOADED,{details:e,level:R||0,id:d||0,stats:i,networkDetails:s,deliveryDirectives:v});break;case Qt.AUDIO_TRACK:o.trigger(W.AUDIO_TRACK_LOADED,{details:e,id:d||0,groupId:h||"",stats:i,networkDetails:s,deliveryDirectives:v});break;case Qt.SUBTITLE_TRACK:o.trigger(W.SUBTITLE_TRACK_LOADED,{details:e,id:d||0,groupId:h||"",stats:i,networkDetails:s,deliveryDirectives:v});break}}}function G0(n,e){let t;try{t=new Event("addtrack")}catch(i){t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=n,e.dispatchEvent(t)}function V0(n,e){const t=n.mode;if(t==="disabled"&&(n.mode="hidden"),n.cues&&!n.cues.getCueById(e.id))try{if(n.addCue(e),!n.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(i){Ce.debug(`[texttrack-utils]: ${i}`);try{const r=new self.TextTrackCue(e.startTime,e.endTime,e.text);r.id=e.id,n.addCue(r)}catch(r){Ce.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${r}`)}}t==="disabled"&&(n.mode=t)}function Ta(n){const e=n.mode;if(e==="disabled"&&(n.mode="hidden"),n.cues)for(let t=n.cues.length;t--;)n.removeCue(n.cues[t]);e==="disabled"&&(n.mode=e)}function xc(n,e,t,i){const r=n.mode;if(r==="disabled"&&(n.mode="hidden"),n.cues&&n.cues.length>0){const s=P_(n.cues,e,t);for(let a=0;a<s.length;a++)(!i||i(s[a]))&&n.removeCue(s[a])}r==="disabled"&&(n.mode=r)}function O_(n,e){if(e<n[0].startTime)return 0;const t=n.length-1;if(e>n[t].endTime)return-1;let i=0,r=t;for(;i<=r;){const s=Math.floor((r+i)/2);if(e<n[s].startTime)r=s-1;else if(e>n[s].startTime&&i<t)i=s+1;else return s}return n[i].startTime-e<e-n[r].startTime?i:r}function P_(n,e,t){const i=[],r=O_(n,e);if(r>-1)for(let s=r,a=n.length;s<a;s++){const o=n[s];if(o.startTime>=e&&o.endTime<=t)i.push(o);else if(o.startTime>t)return i}return i}var nr={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};const B_=.25;function Ec(){if(typeof self!="undefined")return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}const Fl=(()=>{const n=Ec();try{new n(0,Number.POSITIVE_INFINITY,"")}catch(e){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function Tc(n,e){return n.getTime()/1e3-e}function F_(n){return Uint8Array.from(n.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class M_{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(W.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(W.MANIFEST_LOADING,this.onManifestLoading,this),e.on(W.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(W.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(W.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(W.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(W.MANIFEST_LOADING,this.onManifestLoading,this),e.off(W.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(W.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(W.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){!this.id3Track||(Ta(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(!!this.media){for(let t=0;t<e.length;t++){const i=e[t];if(i.kind==="metadata"&&i.label==="id3")return G0(i,this.media),i}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:i,enableID3MetadataCues:r}}}=this;if(!i&&!r)return;const{samples:s}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const a=Ec();for(let o=0;o<s.length;o++){const l=s[o].type;if(l===nr.emsg&&!i||!r)continue;const u=A0(s[o].data);if(u){const d=s[o].pts;let h=d+s[o].duration;h>Fl&&(h=Fl),h-d<=0&&(h=d+B_);for(let x=0;x<u.length;x++){const _=u[x];if(!v0(_)){this.updateId3CueEnds(d,l);const R=new a(d,h,"");R.value=_,l&&(R.type=l),this.id3Track.addCue(R)}}}}}updateId3CueEnds(e,t){var i;const r=(i=this.id3Track)==null?void 0:i.cues;if(r)for(let s=r.length;s--;){const a=r[s];a.type===t&&a.startTime<e&&a.endTime===Fl&&(a.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:i,type:r}){const{id3Track:s,hls:a}=this;if(!a)return;const{config:{enableEmsgMetadataCues:o,enableID3MetadataCues:l}}=a;if(s&&(o||l)){let u;r==="audio"?u=d=>d.type===nr.audioId3&&l:r==="video"?u=d=>d.type===nr.emsg&&o:u=d=>d.type===nr.audioId3&&l||d.type===nr.emsg&&o,xc(s,t,i,u)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:i,id3Track:r}=this,{dateRanges:s}=t,a=Object.keys(s);if(r){const d=Object.keys(i).filter(h=>!a.includes(h));for(let h=d.length;h--;){const v=d[h];Object.keys(i[v].cues).forEach(x=>{r.removeCue(i[v].cues[x])}),delete i[v]}}const o=t.fragments[t.fragments.length-1];if(a.length===0||!xt(o==null?void 0:o.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const l=o.programDateTime/1e3-o.start,u=Ec();for(let d=0;d<a.length;d++){const h=a[d],v=s[h],x=i[h],_=(x==null?void 0:x.cues)||{};let R=(x==null?void 0:x.durationKnown)||!1;const N=Tc(v.startDate,l);let z=Fl;const J=v.endDate;if(J)z=Tc(J,l),R=!0;else if(v.endOnNext&&!R){const pe=a.reduce((te,ke)=>{const we=s[ke];return we.class===v.class&&we.id!==ke&&we.startDate>v.startDate&&te.push(we),te},[]).sort((te,ke)=>te.startDate.getTime()-ke.startDate.getTime())[0];pe&&(z=Tc(pe.startDate,l),R=!0)}const ue=Object.keys(v.attr);for(let pe=0;pe<ue.length;pe++){const te=ue[pe];if(!Hb(te))continue;let ke=_[te];if(ke)R&&!x.durationKnown&&(ke.endTime=z);else{let we=v.attr[te];ke=new u(N,z,""),Wb(te)&&(we=F_(we)),ke.value={key:te,data:we},ke.type=nr.dateRange,ke.id=h,this.id3Track.addCue(ke),_[te]=ke}}i[h]={cues:_,dateRange:v,durationKnown:R}}}}class N_{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:t}=this;return e.liveMaxLatencyDuration!==void 0?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(e===null)return null;const{holdBack:t,partHoldBack:i,targetduration:r}=e,{liveSyncDuration:s,liveSyncDurationCount:a,lowLatencyMode:o}=this.config,l=this.hls.userConfig;let u=o&&i||t;(l.liveSyncDuration||l.liveSyncDurationCount||u===0)&&(u=s!==void 0?s:a*r);const d=r,h=1;return u+Math.min(this.stallCount*h,d)}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency,i=this.levelDetails;if(e===null||t===null||i===null)return null;const r=i.edge,s=e-t-this.edgeStalled,a=r-i.totalduration,o=r-(this.config.lowLatencyMode&&i.partTarget||i.targetduration);return Math.min(Math.max(a,s),o)}get drift(){const{levelDetails:e}=this;return e===null?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e,levelDetails:t}=this;if(!e||!t)return 0;const i=e.buffered.length;return(i?e.buffered.end(i-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(W.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(W.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(W.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(W.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(W.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(W.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(W.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(W.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(W.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(W.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var i;t.details===je.BUFFER_STALLED_ERROR&&(this.stallCount++,(i=this.levelDetails)!=null&&i.live&&Ce.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;const i=this.computeLatency();if(i===null)return;this._latency=i;const{lowLatencyMode:r,maxLiveSyncPlaybackRate:s}=this.config;if(!r||s===1)return;const a=this.targetLatency;if(a===null)return;const o=i-a,l=Math.min(this.maxLatency,a+t.targetduration),u=o<l;if(t.live&&u&&o>.05&&this.forwardBufferLength>1){const d=Math.min(2,Math.max(1,s)),h=Math.round(2/(1+Math.exp(-.75*o-this.edgeStalled))*20)/20;e.playbackRate=Math.min(d,Math.max(1,h))}else e.playbackRate!==1&&e.playbackRate!==0&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}const Sc=["NONE","TYPE-0","TYPE-1",null];var fo={No:"",Yes:"YES",v2:"v2"};function U_(n,e){const{canSkipUntil:t,canSkipDateRanges:i,endSN:r}=n,s=e!==void 0?e-r:0;return t&&s<t?i?fo.v2:fo.Yes:fo.No}class H0{constructor(e,t,i){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=i}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class po{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.unknownCodecs=e.unknownCodecs,this.codecSet=[e.videoCodec,e.audioCodec].filter(t=>t).join(",").replace(/\.[^.,]+/g,"")}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get attrs(){return this._attrs[this._urlId]}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get uri(){return this.url[this._urlId]||""}get urlId(){return this._urlId}set urlId(e){const t=e%this.url.length;this._urlId!==t&&(this.fragmentError=0,this.loadError=0,this.details=void 0,this._urlId=t)}get audioGroupId(){var e;return(e=this.audioGroupIds)==null?void 0:e[this.urlId]}get textGroupId(){var e;return(e=this.textGroupIds)==null?void 0:e[this.urlId]}addFallback(e){this.url.push(e.url),this._attrs.push(e.attrs)}}function Cc(n,e){const t=e.startPTS;if(xt(t)){let i=0,r;e.sn>n.sn?(i=t-n.start,r=n):(i=n.start-t,r=e),r.duration!==i&&(r.duration=i)}else e.sn>n.sn?n.cc===e.cc&&n.minEndPTS?e.start=n.start+(n.minEndPTS-n.start):e.start=n.start+n.duration:e.start=Math.max(n.start-e.duration,0)}function W0(n,e,t,i,r,s){i-t<=0&&(Ce.warn("Fragment should have a positive duration",e),i=t+e.duration,s=r+e.duration);let o=t,l=i;const u=e.startPTS,d=e.endPTS;if(xt(u)){const N=Math.abs(u-t);xt(e.deltaPTS)?e.deltaPTS=Math.max(N,e.deltaPTS):e.deltaPTS=N,o=Math.max(t,u),t=Math.min(t,u),r=Math.min(r,e.startDTS),l=Math.min(i,d),i=Math.max(i,d),s=Math.max(s,e.endDTS)}const h=t-e.start;e.start!==0&&(e.start=t),e.duration=i-e.start,e.startPTS=t,e.maxStartPTS=o,e.startDTS=r,e.endPTS=i,e.minEndPTS=l,e.endDTS=s;const v=e.sn;if(!n||v<n.startSN||v>n.endSN)return 0;let x;const _=v-n.startSN,R=n.fragments;for(R[_]=e,x=_;x>0;x--)Cc(R[x],R[x-1]);for(x=_;x<R.length-1;x++)Cc(R[x],R[x+1]);return n.fragmentHint&&Cc(R[R.length-1],n.fragmentHint),n.PTSKnown=n.alignedSliding=!0,h}function j_(n,e){let t=null;const i=n.fragments;for(let l=i.length-1;l>=0;l--){const u=i[l].initSegment;if(u){t=u;break}}n.fragmentHint&&delete n.fragmentHint.endPTS;let r=0,s;if(V_(n,e,(l,u)=>{l.relurl&&(r=l.cc-u.cc),xt(l.startPTS)&&xt(l.endPTS)&&(u.start=u.startPTS=l.startPTS,u.startDTS=l.startDTS,u.maxStartPTS=l.maxStartPTS,u.endPTS=l.endPTS,u.endDTS=l.endDTS,u.minEndPTS=l.minEndPTS,u.duration=l.endPTS-l.startPTS,u.duration&&(s=u),e.PTSKnown=e.alignedSliding=!0),u.elementaryStreams=l.elementaryStreams,u.loader=l.loader,u.stats=l.stats,u.urlId=l.urlId,l.initSegment&&(u.initSegment=l.initSegment,t=l.initSegment)}),t&&(e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments).forEach(u=>{var d;(!u.initSegment||u.initSegment.relurl===((d=t)==null?void 0:d.relurl))&&(u.initSegment=t)}),e.skippedSegments)if(e.deltaUpdateFailed=e.fragments.some(l=>!l),e.deltaUpdateFailed){Ce.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let l=e.skippedSegments;l--;)e.fragments.shift();e.startSN=e.fragments[0].sn,e.startCC=e.fragments[0].cc}else e.canSkipDateRanges&&(e.dateRanges=$_(n.dateRanges,e.dateRanges,e.recentlyRemovedDateranges));const a=e.fragments;if(r){Ce.warn("discontinuity sliding from playlist, take drift into account");for(let l=0;l<a.length;l++)a[l].cc+=r}e.skippedSegments&&(e.startCC=e.fragments[0].cc),G_(n.partList,e.partList,(l,u)=>{u.elementaryStreams=l.elementaryStreams,u.stats=l.stats}),s?W0(e,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS):K0(n,e),a.length&&(e.totalduration=e.edge-a[0].start),e.driftStartTime=n.driftStartTime,e.driftStart=n.driftStart;const o=e.advancedDateTime;if(e.advanced&&o){const l=e.edge;e.driftStart||(e.driftStartTime=o,e.driftStart=l),e.driftEndTime=o,e.driftEnd=l}else e.driftEndTime=n.driftEndTime,e.driftEnd=n.driftEnd,e.advancedDateTime=n.advancedDateTime}function $_(n,e,t){const i=Bi({},n);return t&&t.forEach(r=>{delete i[r]}),Object.keys(e).forEach(r=>{const s=new d0(e[r].attr,i[r]);s.isValid?i[r]=s:Ce.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(e[r].attr)}"`)}),i}function G_(n,e,t){if(n&&e){let i=0;for(let r=0,s=n.length;r<=s;r++){const a=n[r],o=e[r+i];a&&o&&a.index===o.index&&a.fragment.sn===o.fragment.sn?t(a,o):i--}}}function V_(n,e,t){const i=e.skippedSegments,r=Math.max(n.startSN,e.startSN)-e.startSN,s=(n.fragmentHint?1:0)+(i?e.endSN:Math.min(n.endSN,e.endSN))-e.startSN,a=e.startSN-n.startSN,o=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,l=n.fragmentHint?n.fragments.concat(n.fragmentHint):n.fragments;for(let u=r;u<=s;u++){const d=l[a+u];let h=o[u];i&&!h&&u<i&&(h=e.fragments[u]=d),d&&h&&t(d,h)}}function K0(n,e){const t=e.startSN+e.skippedSegments-n.startSN,i=n.fragments;t<0||t>=i.length||wc(e,i[t].start)}function wc(n,e){if(e){const t=n.fragments;for(let i=n.skippedSegments;i<t.length;i++)t[i].start+=e;n.fragmentHint&&(n.fragmentHint.start+=e)}}function H_(n,e=Infinity){let t=1e3*n.targetduration;if(n.updated){const i=n.fragments,r=4;if(i.length&&t*r>e){const s=i[i.length-1].duration*1e3;s<t&&(t=s)}}else t/=2;return Math.round(t)}function W_(n,e,t){if(!(n!=null&&n.details))return null;const i=n.details;let r=i.fragments[e-i.startSN];return r||(r=i.fragmentHint,r&&r.sn===e)?r:e<i.startSN&&t&&t.sn===e?t:null}function q0(n,e,t){var i;return n!=null&&n.details?z0((i=n.details)==null?void 0:i.partList,e,t):null}function z0(n,e,t){if(n)for(let i=n.length;i--;){const r=n[i];if(r.index===t&&r.fragment.sn===e)return r}return null}function Ml(n){switch(n.details){case je.FRAG_LOAD_TIMEOUT:case je.KEY_LOAD_TIMEOUT:case je.LEVEL_LOAD_TIMEOUT:case je.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Y0(n,e){const t=Ml(e);return n.default[`${t?"timeout":"error"}Retry`]}function Lc(n,e){const t=n.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*n.retryDelayMs,n.maxRetryDelayMs)}function X0(n){return pn(pn({},n),{errorRetry:null,timeoutRetry:null})}function Nl(n,e,t,i){return!!n&&e<n.maxNumRetry&&(K_(i)||!!t)}function K_(n){return n===0&&navigator.onLine===!1||!!n&&(n<400||n>499)}const Q0={search:function(n,e){let t=0,i=n.length-1,r=null,s=null;for(;t<=i;){r=(t+i)/2|0,s=n[r];const a=e(s);if(a>0)t=r+1;else if(a<0)i=r-1;else return s}return null}};function q_(n,e,t){if(e===null||!Array.isArray(n)||!n.length||!xt(e))return null;const i=n[0].programDateTime;if(e<(i||0))return null;const r=n[n.length-1].endProgramDateTime;if(e>=(r||0))return null;t=t||0;for(let s=0;s<n.length;++s){const a=n[s];if(z_(e,t,a))return a}return null}function mo(n,e,t=0,i=0){let r=null;if(n?r=e[n.sn-e[0].sn+1]||null:t===0&&e[0].start===0&&(r=e[0]),r&&Dc(t,i,r)===0)return r;const s=Q0.search(e,Dc.bind(null,t,i));return s&&(s!==n||!r)?s:r}function Dc(n=0,e=0,t){if(t.start<=n&&t.start+t.duration>n)return 0;const i=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-i<=n?1:t.start-i>n&&t.start?-1:0}function z_(n,e,t){const i=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-i>n}function Y_(n,e){return Q0.search(n,t=>t.cc<e?1:t.cc>e?-1:0)}const X_=3e5;var Zi={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},Kn={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4};class Q_{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=Ce.log.bind(Ce,"[info]:"),this.warn=Ce.warn.bind(Ce,"[warning]:"),this.error=Ce.error.bind(Ce,"[error]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(W.ERROR,this.onError,this),e.on(W.MANIFEST_LOADING,this.onManifestLoading,this),e.on(W.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;!e||(e.off(W.ERROR,this.onError,this),e.off(W.ERROR,this.onErrorOut,this),e.off(W.MANIFEST_LOADING,this.onManifestLoading,this),e.off(W.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){this.playlistError=0}stopLoad(){}getVariantLevelIndex(e){return(e==null?void 0:e.type)===Lt.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var i,r;if(t.fatal)return;const s=this.hls,a=t.context;switch(t.details){case je.FRAG_LOAD_ERROR:case je.FRAG_LOAD_TIMEOUT:case je.KEY_LOAD_ERROR:case je.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case je.FRAG_PARSING_ERROR:if((i=t.frag)!=null&&i.gap){t.errorAction={action:Zi.DoNothing,flags:Kn.None};return}case je.FRAG_GAP:case je.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=Zi.SendAlternateToPenaltyBox;return}case je.LEVEL_EMPTY_ERROR:case je.LEVEL_PARSING_ERROR:{var o,l;const u=t.parent===Lt.MAIN?t.level:s.loadLevel;t.details===je.LEVEL_EMPTY_ERROR&&!!((o=t.context)!=null&&(l=o.levelDetails)!=null&&l.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,u):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,u))}return;case je.LEVEL_LOAD_ERROR:case je.LEVEL_LOAD_TIMEOUT:typeof(a==null?void 0:a.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,a.level));return;case je.AUDIO_TRACK_LOAD_ERROR:case je.AUDIO_TRACK_LOAD_TIMEOUT:case je.SUBTITLE_LOAD_ERROR:case je.SUBTITLE_TRACK_LOAD_TIMEOUT:if(a){const u=s.levels[s.loadLevel];if(u&&(a.type===Qt.AUDIO_TRACK&&a.groupId===u.audioGroupId||a.type===Qt.SUBTITLE_TRACK&&a.groupId===u.textGroupId)){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.loadLevel),t.errorAction.action=Zi.SendAlternateToPenaltyBox,t.errorAction.flags=Kn.MoveAllAlternatesMatchingHost;return}}return;case je.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const u=s.levels[s.loadLevel],d=u==null?void 0:u.attrs["HDCP-LEVEL"];d&&(t.errorAction={action:Zi.SendAlternateToPenaltyBox,flags:Kn.MoveAllAlternatesMatchingHDCP,hdcpLevel:d})}return;case je.BUFFER_ADD_CODEC_ERROR:case je.REMUX_ALLOC_ERROR:t.errorAction=this.getLevelSwitchAction(t,(r=t.level)!=null?r:s.loadLevel);return;case je.INTERNAL_EXCEPTION:case je.BUFFER_APPENDING_ERROR:case je.BUFFER_APPEND_ERROR:case je.BUFFER_FULL_ERROR:case je.LEVEL_SWITCH_ERROR:case je.BUFFER_STALLED_ERROR:case je.BUFFER_SEEK_OVER_HOLE:case je.BUFFER_NUDGE_ON_STALL:t.errorAction={action:Zi.DoNothing,flags:Kn.None};return}if(t.type===Ct.KEY_SYSTEM_ERROR){const u=this.getVariantLevelIndex(t.frag);t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,u);return}}getPlaylistRetryOrSwitchAction(e,t){var i;const r=this.hls,s=Y0(r.config.playlistLoadPolicy,e),a=this.playlistError++,o=(i=e.response)==null?void 0:i.code;if(Nl(s,a,Ml(e),o))return{action:Zi.RetryRequest,flags:Kn.None,retryConfig:s,retryCount:a};const u=this.getLevelSwitchAction(e,t);return s&&(u.retryConfig=s,u.retryCount=a),u}getFragRetryOrSwitchAction(e){const t=this.hls,i=this.getVariantLevelIndex(e.frag),r=t.levels[i],{fragLoadPolicy:s,keyLoadPolicy:a}=t.config,o=Y0(e.details.startsWith("key")?a:s,e),l=t.levels.reduce((h,v)=>h+v.fragmentError,0);if(r){var u;e.details!==je.FRAG_GAP&&r.fragmentError++;const h=(u=e.response)==null?void 0:u.code;if(Nl(o,l,Ml(e),h))return{action:Zi.RetryRequest,flags:Kn.None,retryConfig:o,retryCount:l}}const d=this.getLevelSwitchAction(e,i);return o&&(d.retryConfig=o,d.retryCount=l),d}getLevelSwitchAction(e,t){const i=this.hls;t==null&&(t=i.loadLevel);const r=this.hls.levels[t];if(r&&(r.loadError++,i.autoLevelEnabled)){var s,a;let o=-1;const{levels:l,loadLevel:u,minAutoLevel:d,maxAutoLevel:h}=i,v=(s=e.frag)==null?void 0:s.type,{type:x,groupId:_}=(a=e.context)!=null?a:{};for(let R=l.length;R--;){const N=(R+u)%l.length;if(N!==u&&N>=d&&N<=h&&l[N].loadError===0){const z=l[N];if(e.details===je.FRAG_GAP&&e.frag){const J=l[N].details;if(J){const ue=mo(e.frag,J.fragments,e.frag.start);if(ue!=null&&ue.gap)continue}}else{if(x===Qt.AUDIO_TRACK&&_===z.audioGroupId||x===Qt.SUBTITLE_TRACK&&_===z.textGroupId)continue;if(v===Lt.AUDIO&&r.audioGroupId===z.audioGroupId||v===Lt.SUBTITLE&&r.textGroupId===z.textGroupId)continue}o=N;break}}if(o>-1&&i.loadLevel!==o)return e.levelRetry=!0,this.playlistError=0,{action:Zi.SendAlternateToPenaltyBox,flags:Kn.None,nextAutoLevel:o}}return{action:Zi.SendAlternateToPenaltyBox,flags:Kn.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var i;switch((i=t.errorAction)==null?void 0:i.action){case Zi.DoNothing:break;case Zi.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==je.FRAG_GAP&&(t.fatal=!0);break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,i=e.errorAction;if(!i)return;const{flags:r,hdcpLevel:s,nextAutoLevel:a}=i;switch(r){case Kn.None:this.switchLevel(e,a);break;case Kn.MoveAllAlternatesMatchingHost:i.resolved||(i.resolved=this.redundantFailover(e));break;case Kn.MoveAllAlternatesMatchingHDCP:s&&(t.maxHdcpLevel=Sc[Sc.indexOf(s)-1],i.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}i.resolved||this.switchLevel(e,a)}switchLevel(e,t){t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}redundantFailover(e){const{hls:t,penalizedRenditions:i}=this,r=e.parent===Lt.MAIN?e.level:t.loadLevel,s=t.levels[r],a=s.url.length,o=e.frag?e.frag.urlId:s.urlId;s.urlId===o&&(!e.frag||s.details)&&this.penalizeRendition(s,e);for(let l=1;l<a;l++){const u=(o+l)%a,d=i[u];if(!d||Z_(d,e,i[o]))return this.warn(`Switching to Redundant Stream ${u+1}/${a}: "${s.url[u]}" after ${e.details}`),this.playlistError=0,t.levels.forEach(h=>{h.urlId=u}),t.nextLoadLevel=r,!0}return!1}penalizeRendition(e,t){const{penalizedRenditions:i}=this,r=i[e.urlId]||{lastErrorPerfMs:0,errors:[],details:void 0};r.lastErrorPerfMs=performance.now(),r.errors.push(t),r.details=e.details,i[e.urlId]=r}}function Z_(n,e,t){if(performance.now()-n.lastErrorPerfMs>X_)return!0;const i=n.details;if(e.details===je.FRAG_GAP&&i&&e.frag){const r=e.frag.start,s=mo(null,i.fragments,r);if(s&&!s.gap)return!0}if(t&&n.errors.length<t.errors.length){const r=n.errors[n.errors.length-1];if(i&&r.frag&&e.frag&&Math.abs(r.frag.start-e.frag.start)>i.targetduration*3)return!0}return!1}class kc{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=Ce.log.bind(Ce,`${t}:`),this.warn=Ce.warn.bind(Ce,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){clearTimeout(this.timer),this.timer=-1}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t){const i=t==null?void 0:t.renditionReports;if(i){let r=-1;for(let s=0;s<i.length;s++){const a=i[s];let o;try{o=new self.URL(a.URI,t.url).href}catch(l){Ce.warn(`Could not construct new URL for Rendition Report: ${l}`),o=a.URI||""}if(o===e){r=s;break}else o===e.substring(0,o.length)&&(r=s)}if(r!==-1){const s=i[r],a=parseInt(s["LAST-MSN"])||(t==null?void 0:t.lastPartSn);let o=parseInt(s["LAST-PART"])||(t==null?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const l=Math.min(t.age-t.partTarget,t.targetduration);o>=0&&l>t.partTarget&&(o+=1)}return new H0(a,o>=0?o:void 0,fo.No)}}}loadPlaylist(e){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return this.timer===-1&&this.requestScheduled===-1&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,i){const{details:r,stats:s}=t,a=self.performance.now(),o=s.loading.first?Math.max(0,a-s.loading.first):0;if(r.advancedDateTime=Date.now()-o,r.live||i!=null&&i.live){if(r.reloaded(i),i&&this.log(`live playlist ${e} ${r.advanced?"REFRESHED "+r.lastPartSn+"-"+r.lastPartIndex:r.updated?"UPDATED":"MISSED"}`),i&&r.fragments.length>0&&j_(i,r),!this.canLoad||!r.live)return;let l,u,d;if(r.canBlockReload&&r.endSN&&r.advanced){const N=this.hls.config.lowLatencyMode,z=r.lastPartSn,J=r.endSN,ue=r.lastPartIndex,pe=ue!==-1,te=z===J,ke=N?0:ue;pe?(u=te?J+1:z,d=te?ke:ue+1):u=J+1;const we=r.age,Ge=we+r.ageHeader;let Ve=Math.min(Ge-r.partTarget,r.targetduration*1.5);if(Ve>0){if(i&&Ve>i.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${i.tuneInGoal} to: ${Ve} with playlist age: ${r.age}`),Ve=0;else{const Fe=Math.floor(Ve/r.targetduration);u+=Fe,d!==void 0&&(d+=Math.round(Ve%r.targetduration/r.partTarget)),this.log(`CDN Tune-in age: ${r.ageHeader}s last advanced ${we.toFixed(2)}s goal: ${Ve} skip sn ${Fe} to part ${d}`)}r.tuneInGoal=Ve}if(l=this.getDeliveryDirectives(r,t.deliveryDirectives,u,d),N||!te){this.loadPlaylist(l);return}}else(r.canBlockReload||r.canSkipUntil)&&(l=this.getDeliveryDirectives(r,t.deliveryDirectives,u,d));const h=this.hls.mainForwardBufferInfo,v=h?h.end-h.len:0,x=(r.edge-v)*1e3,_=H_(r,x);r.updated&&a>this.requestScheduled+_&&(this.requestScheduled=s.loading.start),u!==void 0&&r.canBlockReload?this.requestScheduled=s.loading.first+_-(r.partTarget*1e3||1e3):this.requestScheduled===-1||this.requestScheduled+_<a?this.requestScheduled=a:this.requestScheduled-a<=0&&(this.requestScheduled+=_);let R=this.requestScheduled-a;R=Math.max(0,R),this.log(`reload live playlist ${e} in ${Math.round(R)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(l),R)}else this.clearTimer()}getDeliveryDirectives(e,t,i,r){let s=U_(e,i);return t!=null&&t.skip&&e.deltaUpdateFailed&&(i=t.msn,r=t.part,s=fo.No),new H0(i,r,s)}checkRetry(e){const t=e.details,i=Ml(e),r=e.errorAction,{action:s,retryCount:a=0,retryConfig:o}=r||{},l=!!r&&!!o&&(s===Zi.RetryRequest||!r.resolved&&s===Zi.SendAlternateToPenaltyBox);if(l){var u;if(this.requestScheduled=-1,a>=o.maxNumRetry)return!1;if(i&&(u=e.context)!=null&&u.deliveryDirectives)this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const d=Lc(o,a);this.timer=self.setTimeout(()=>this.loadPlaylist(),d),this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${t}" in ${d}ms`)}e.levelRetry=!0,r.resolved=!0}return l}}let Ic;class J_ extends kc{constructor(e,t){super(e,"[level-controller]");this._levels=[],this._firstLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(W.MANIFEST_LOADING,this.onManifestLoading,this),e.on(W.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(W.LEVEL_LOADED,this.onLevelLoaded,this),e.on(W.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(W.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(W.FRAG_LOADED,this.onFragLoaded,this),e.on(W.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(W.MANIFEST_LOADING,this.onManifestLoading,this),e.off(W.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(W.LEVEL_LOADED,this.onLevelLoaded,this),e.off(W.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(W.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(W.FRAG_LOADED,this.onFragLoaded,this),e.off(W.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}startLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.startLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[]}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const i=[],r={};let s;t.levels.forEach(a=>{var o;const l=a.attrs;((o=a.audioCodec)==null?void 0:o.indexOf("mp4a.40.34"))!==-1&&(Ic||(Ic=/chrome|firefox/i.test(navigator.userAgent)),Ic&&(a.audioCodec=void 0));const{AUDIO:u,CODECS:d,"FRAME-RATE":h,"PATHWAY-ID":v,RESOLUTION:x,SUBTITLES:_}=l,N=`${`${v||"."}-`}${a.bitrate}-${x}-${h}-${d}`;s=r[N],s?s.addFallback(a):(s=new po(a),r[N]=s,i.push(s)),Ul(s,"audio",u),Ul(s,"text",_)}),this.filterAndSortMediaOptions(i,t)}filterAndSortMediaOptions(e,t){let i=[],r=[],s=!1,a=!1,o=!1,l=e.filter(({audioCodec:x,videoCodec:_,width:R,height:N,unknownCodecs:z})=>(s||(s=!!(R&&N)),a||(a=!!_),o||(o=!!x),!(z!=null&&z.length)&&(!x||bc(x,"audio"))&&(!_||bc(_,"video"))));if((s||a)&&o&&(l=l.filter(({videoCodec:x,width:_,height:R})=>!!x||!!(_&&R))),l.length===0){Promise.resolve().then(()=>{if(this.hls){const x=new Error("no level with compatible codecs found in manifest");this.hls.trigger(W.ERROR,{type:Ct.MEDIA_ERROR,details:je.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:x,reason:x.message})}});return}t.audioTracks&&(i=t.audioTracks.filter(x=>!x.audioCodec||bc(x.audioCodec,"audio")),Z0(i)),t.subtitles&&(r=t.subtitles,Z0(r));const u=l.slice(0);l.sort((x,_)=>x.attrs["HDCP-LEVEL"]!==_.attrs["HDCP-LEVEL"]?(x.attrs["HDCP-LEVEL"]||"")>(_.attrs["HDCP-LEVEL"]||"")?1:-1:x.bitrate!==_.bitrate?x.bitrate-_.bitrate:x.attrs["FRAME-RATE"]!==_.attrs["FRAME-RATE"]?x.attrs.decimalFloatingPoint("FRAME-RATE")-_.attrs.decimalFloatingPoint("FRAME-RATE"):x.attrs.SCORE!==_.attrs.SCORE?x.attrs.decimalFloatingPoint("SCORE")-_.attrs.decimalFloatingPoint("SCORE"):s&&x.height!==_.height?x.height-_.height:0);let d=u[0];if(this.steering&&(l=this.steering.filterParsedLevels(l),l.length!==u.length)){for(let x=0;x<u.length;x++)if(u[x].pathwayId===l[0].pathwayId){d=u[x];break}}this._levels=l;for(let x=0;x<l.length;x++)if(l[x]===d){this._firstLevel=x,this.log(`manifest loaded, ${l.length} level(s) found, first bitrate: ${d.bitrate}`);break}const h=o&&!a,v={levels:l,audioTracks:i,subtitleTracks:r,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:o,video:a,altAudio:!h&&i.some(x=>!!x.url)};this.hls.trigger(W.MANIFEST_PARSED,v),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return this._levels.length===0?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const d=new Error("invalid level idx"),h=e<0;if(this.hls.trigger(W.ERROR,{type:Ct.OTHER_ERROR,details:je.LEVEL_SWITCH_ERROR,level:e,fatal:h,error:d,reason:d.message}),h)return;e=Math.min(e,t.length-1)}const i=this.currentLevelIndex,r=this.currentLevel,s=r?r.attrs["PATHWAY-ID"]:void 0,a=t[e],o=a.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=a,i===e&&a.details&&r&&s===o)return;this.log(`Switching to level ${e}${o?" with Pathway "+o:""} from level ${i}${s?" with Pathway "+s:""}`);const l=Bi({},a,{level:e,maxBitrate:a.maxBitrate,attrs:a.attrs,uri:a.uri,urlId:a.urlId});delete l._attrs,delete l._urlId,this.hls.trigger(W.LEVEL_SWITCHING,l);const u=a.details;if(!u||u.live){const d=this.switchParams(a.uri,r==null?void 0:r.details);this.loadPlaylist(d)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this._firstLevel}else return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){t.fatal||!t.context||t.context.type===Qt.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragLoaded(e,{frag:t}){if(t!==void 0&&t.type===Lt.MAIN){const i=this._levels[t.level];i!==void 0&&(i.loadError=0)}}onLevelLoaded(e,t){var i;const{level:r,details:s}=t,a=this._levels[r];if(!a){var o;this.warn(`Invalid level index ${r}`),(o=t.deliveryDirectives)!=null&&o.skip&&(s.deltaUpdateFailed=!0);return}r===this.currentLevelIndex?(a.fragmentError===0&&(a.loadError=0),this.playlistLoaded(r,t,a.details)):(i=t.deliveryDirectives)!=null&&i.skip&&(s.deltaUpdateFailed=!0)}onAudioTrackSwitched(e,t){const i=this.currentLevel;if(!i)return;const r=this.hls.audioTracks[t.id].groupId;if(i.audioGroupIds&&i.audioGroupId!==r){let s=-1;for(let a=0;a<i.audioGroupIds.length;a++)if(i.audioGroupIds[a]===r){s=a;break}s!==-1&&s!==i.urlId&&(i.urlId=s,this.canLoad&&this.startLoad())}}loadPlaylist(e){super.loadPlaylist();const t=this.currentLevelIndex,i=this.currentLevel;if(i&&this.shouldLoadPlaylist(i)){const r=i.urlId;let s=i.uri;if(e)try{s=e.addDirectives(s)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}const a=i.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${(e==null?void 0:e.msn)!==void 0?" at sn "+e.msn+" part "+e.part:""} with${a?" Pathway "+a:""} URI ${r+1}/${i.url.length} ${s}`),this.clearTimer(),this.hls.trigger(W.LEVEL_LOADING,{url:s,level:t,id:r,deliveryDirectives:e||null})}}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e,t){const i=(s,a)=>a!==t,r=this._levels.filter((s,a)=>a!==e?!0:s.url.length>1&&t!==void 0?(s.url=s.url.filter(i),s.audioGroupIds&&(s.audioGroupIds=s.audioGroupIds.filter(i)),s.textGroupIds&&(s.textGroupIds=s.textGroupIds.filter(i)),s.urlId=0,!0):(this.steering&&this.steering.removeLevel(s),!1));this.hls.trigger(W.LEVELS_UPDATED,{levels:r})}onLevelsUpdated(e,{levels:t}){t.forEach((i,r)=>{const{details:s}=i;s!=null&&s.fragments&&s.fragments.forEach(a=>{a.level=r})}),this._levels=t}}function Ul(n,e,t){!t||(e==="audio"?(n.audioGroupIds||(n.audioGroupIds=[]),n.audioGroupIds[n.url.length-1]=t):e==="text"&&(n.textGroupIds||(n.textGroupIds=[]),n.textGroupIds[n.url.length-1]=t))}function Z0(n){const e={};n.forEach(t=>{const i=t.groupId||"";t.id=e[i]=e[i]||0,e[i]++})}var $i={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class ex{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(W.BUFFER_APPENDED,this.onBufferAppended,this),e.on(W.FRAG_BUFFERED,this.onFragBuffered,this),e.on(W.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(W.BUFFER_APPENDED,this.onBufferAppended,this),e.off(W.FRAG_BUFFERED,this.onFragBuffered,this),e.off(W.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const i=this.activePartLists[t];if(i)for(let r=i.length;r--;){const s=i[r];if(!s)break;const a=s.end;if(s.start<=e&&a!==null&&e<=a)return s}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){const{fragments:i}=this,r=Object.keys(i);for(let s=r.length;s--;){const a=i[r[s]];if((a==null?void 0:a.body.type)===t&&a.buffered){const o=a.body;if(o.start<=e&&e<=o.end)return o}}return null}detectEvictedFragments(e,t,i,r){this.timeRanges&&(this.timeRanges[e]=t);const s=(r==null?void 0:r.fragment.sn)||-1;Object.keys(this.fragments).forEach(a=>{const o=this.fragments[a];if(!o||s>=o.body.sn)return;if(!o.buffered&&!o.loaded){o.body.type===i&&this.removeFragment(o.body);return}const l=o.range[e];!l||l.time.some(u=>{const d=!this.isTimeBuffered(u.startPTS,u.endPTS,t);return d&&this.removeFragment(o.body),d})})}detectPartialFragments(e){const t=this.timeRanges,{frag:i,part:r}=e;if(!t||i.sn==="initSegment")return;const s=Sa(i),a=this.fragments[s];if(!a||a.buffered&&i.gap)return;const o=!i.relurl;Object.keys(t).forEach(l=>{const u=i.elementaryStreams[l];if(!u)return;const d=t[l],h=o||u.partial===!0;a.range[l]=this.getBufferedTimes(i,r,h,d)}),a.loaded=null,Object.keys(a.range).length?(a.buffered=!0,(a.body.endList=i.endList||a.body.endList)&&(this.endListFragments[a.body.type]=a),jl(a)||this.removeParts(i.sn-1,i.type)):this.removeFragment(a.body)}removeParts(e,t){const i=this.activePartLists[t];!i||(this.activePartLists[t]=i.filter(r=>r.fragment.sn>=e))}fragBuffered(e,t){const i=Sa(e);let r=this.fragments[i];!r&&t&&(r=this.fragments[i]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),r&&(r.loaded=null,r.buffered=!0)}getBufferedTimes(e,t,i,r){const s={time:[],partial:i},a=e.start,o=e.end,l=e.minEndPTS||o,u=e.maxStartPTS||a;for(let d=0;d<r.length;d++){const h=r.start(d)-this.bufferPadding,v=r.end(d)+this.bufferPadding;if(u>=h&&l<=v){s.time.push({startPTS:Math.max(a,r.start(d)),endPTS:Math.min(o,r.end(d))});break}else if(a<v&&o>h)s.partial=!0,s.time.push({startPTS:Math.max(a,r.start(d)),endPTS:Math.min(o,r.end(d))});else if(o<=h)break}return s}getPartialFragment(e){let t=null,i,r,s,a=0;const{bufferPadding:o,fragments:l}=this;return Object.keys(l).forEach(u=>{const d=l[u];!d||jl(d)&&(r=d.body.start-o,s=d.body.end+o,e>=r&&e<=s&&(i=Math.min(e-r,s-e),a<=i&&(t=d.body,a=i)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||jl(t))}getState(e){const t=Sa(e),i=this.fragments[t];return i?i.buffered?jl(i)?$i.PARTIAL:$i.OK:$i.APPENDING:$i.NOT_LOADED}isTimeBuffered(e,t,i){let r,s;for(let a=0;a<i.length;a++){if(r=i.start(a)-this.bufferPadding,s=i.end(a)+this.bufferPadding,e>=r&&t<=s)return!0;if(t<=r)return!1}return!1}onFragLoaded(e,t){const{frag:i,part:r}=t;if(i.sn==="initSegment"||i.bitrateTest)return;const s=r?null:t,a=Sa(i);this.fragments[a]={body:i,appendedPTS:null,loaded:s,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:i,part:r,timeRanges:s}=t;if(i.sn==="initSegment")return;const a=i.type;if(r){let o=this.activePartLists[a];o||(this.activePartLists[a]=o=[]),o.push(r)}this.timeRanges=s,Object.keys(s).forEach(o=>{const l=s[o];this.detectEvictedFragments(o,l,a,r)})}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=Sa(e);return!!this.fragments[t]}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,i,r,s){r&&!this.hasGaps||Object.keys(this.fragments).forEach(a=>{const o=this.fragments[a];if(!o)return;const l=o.body;l.type!==i||r&&!l.gap||l.start<t&&l.end>e&&(o.buffered||s)&&this.removeFragment(l)})}removeFragment(e){const t=Sa(e);e.stats.loaded=0,e.clearElementaryStreamInfo();const i=this.activePartLists[e.type];if(i){const r=e.sn;this.activePartLists[e.type]=i.filter(s=>s.fragment.sn!==r)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function jl(n){var e,t,i;return n.buffered&&(n.body.gap||((e=n.range.video)==null?void 0:e.partial)||((t=n.range.audio)==null?void 0:t.partial)||((i=n.range.audiovideo)==null?void 0:i.partial))}function Sa(n){return`${n.type}_${n.level}_${n.urlId}_${n.sn}`}const J0=Math.pow(2,17);class tx{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const i=e.url;if(!i)return Promise.reject(new Nr({type:Ct.NETWORK_ERROR,details:je.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${i?"part list":"url"}`),networkDetails:null}));this.abort();const r=this.config,s=r.fLoader,a=r.loader;return new Promise((o,l)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(x=>x[0]==="GAP")){l(tm(e));return}else e.gap=!1;const u=this.loader=e.loader=s?new s(r):new a(r),d=em(e),h=X0(r.fragLoadPolicy.default),v={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?Infinity:J0};e.stats=u.stats,u.load(d,v,{onSuccess:(x,_,R,N)=>{this.resetLoader(e,u);let z=x.data;R.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(z.slice(0,16)),z=z.slice(16)),o({frag:e,part:null,payload:z,networkDetails:N})},onError:(x,_,R,N)=>{this.resetLoader(e,u),l(new Nr({type:Ct.NETWORK_ERROR,details:je.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:pn({url:i,data:void 0},x),error:new Error(`HTTP Error ${x.code} ${x.text}`),networkDetails:R,stats:N}))},onAbort:(x,_,R)=>{this.resetLoader(e,u),l(new Nr({type:Ct.NETWORK_ERROR,details:je.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:R,stats:x}))},onTimeout:(x,_,R)=>{this.resetLoader(e,u),l(new Nr({type:Ct.NETWORK_ERROR,details:je.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${v.timeout}ms`),networkDetails:R,stats:x}))},onProgress:(x,_,R,N)=>{t&&t({frag:e,part:null,payload:R,networkDetails:N})}})})}loadPart(e,t,i){this.abort();const r=this.config,s=r.fLoader,a=r.loader;return new Promise((o,l)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){l(tm(e,t));return}const u=this.loader=e.loader=s?new s(r):new a(r),d=em(e,t),h=X0(r.fragLoadPolicy.default),v={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:J0};t.stats=u.stats,u.load(d,v,{onSuccess:(x,_,R,N)=>{this.resetLoader(e,u),this.updateStatsFromPart(e,t);const z={frag:e,part:t,payload:x.data,networkDetails:N};i(z),o(z)},onError:(x,_,R,N)=>{this.resetLoader(e,u),l(new Nr({type:Ct.NETWORK_ERROR,details:je.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:pn({url:d.url,data:void 0},x),error:new Error(`HTTP Error ${x.code} ${x.text}`),networkDetails:R,stats:N}))},onAbort:(x,_,R)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,u),l(new Nr({type:Ct.NETWORK_ERROR,details:je.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:R,stats:x}))},onTimeout:(x,_,R)=>{this.resetLoader(e,u),l(new Nr({type:Ct.NETWORK_ERROR,details:je.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${v.timeout}ms`),networkDetails:R,stats:x}))}})})}updateStatsFromPart(e,t){const i=e.stats,r=t.stats,s=r.total;if(i.loaded+=r.loaded,s){const l=Math.round(e.duration/t.duration),u=Math.min(Math.round(i.loaded/s),l),h=(l-u)*Math.round(i.loaded/u);i.total=i.loaded+h}else i.total=Math.max(i.loaded,i.total);const a=i.loading,o=r.loading;a.start?a.first+=o.first-o.start:(a.start=o.start,a.first=o.first),a.end=o.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function em(n,e=null){const t=e||n,i={frag:n,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},r=t.byteRangeStartOffset,s=t.byteRangeEndOffset;if(xt(r)&&xt(s)){var a;let o=r,l=s;if(n.sn==="initSegment"&&((a=n.decryptdata)==null?void 0:a.method)==="AES-128"){const u=s-r;u%16&&(l=s+(16-u%16)),r!==0&&(i.resetIV=!0,o=r-16)}i.rangeStart=o,i.rangeEnd=l}return i}function tm(n,e){const t=new Error(`GAP ${n.gap?"tag":"attribute"} found`),i={type:Ct.MEDIA_ERROR,details:je.FRAG_GAP,fatal:!1,frag:n,error:t,networkDetails:null};return e&&(i.part=e),(e||n).stats.aborted=!0,new Nr(i)}class Nr extends Error{constructor(e){super(e.error.message);this.data=void 0,this.data=e}}class ix{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const t in this.keyUriToKeyInfo){const i=this.keyUriToKeyInfo[t].loader;if(i){if(e&&e!==i.context.frag.type)return;i.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=je.KEY_LOAD_ERROR,i,r,s){return new Nr({type:Ct.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:s,error:i,networkDetails:r})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:i,cc:r}=e;for(let s=0;s<t.length;s++){const a=t[s];if(r<=a.cc&&(i==="initSegment"||a.sn==="initSegment"||i<a.sn)){this.emeController.selectKeySystemFormat(a).then(o=>{a.setKeyFormat(o)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var i,r;t&&e.setKeyFormat(t);const s=e.decryptdata;if(!s){const u=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,je.KEY_LOAD_ERROR,u))}const a=s.uri;if(!a)return Promise.reject(this.createKeyLoadError(e,je.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${a}"`)));let o=this.keyUriToKeyInfo[a];if((i=o)!=null&&i.decryptdata.key)return s.key=o.decryptdata.key,Promise.resolve({frag:e,keyInfo:o});if((r=o)!=null&&r.keyLoadPromise){var l;switch((l=o.mediaKeySessionContext)==null?void 0:l.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return o.keyLoadPromise.then(u=>(s.key=u.keyInfo.decryptdata.key,{frag:e,keyInfo:o}))}}switch(o=this.keyUriToKeyInfo[a]={decryptdata:s,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},s.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return s.keyFormat==="identity"?this.loadKeyHTTP(o,e):this.loadKeyEME(o,e);case"AES-128":return this.loadKeyHTTP(o,e);default:return Promise.reject(this.createKeyLoadError(e,je.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${s.method}"`)))}}loadKeyEME(e,t){const i={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const r=this.emeController.loadKey(i);if(r)return(e.keyLoadPromise=r.then(s=>(e.mediaKeySessionContext=s,i))).catch(s=>{throw e.keyLoadPromise=null,s})}return Promise.resolve(i)}loadKeyHTTP(e,t){const i=this.config,r=i.loader,s=new r(i);return t.keyLoader=e.loader=s,e.keyLoadPromise=new Promise((a,o)=>{const l={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},u=i.keyLoadPolicy.default,d={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},h={onSuccess:(v,x,_,R)=>{const{frag:N,keyInfo:z,url:J}=_;if(!N.decryptdata||z!==this.keyUriToKeyInfo[J])return o(this.createKeyLoadError(N,je.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),R));z.decryptdata.key=N.decryptdata.key=new Uint8Array(v.data),N.keyLoader=null,z.loader=null,a({frag:N,keyInfo:z})},onError:(v,x,_,R)=>{this.resetLoader(x),o(this.createKeyLoadError(t,je.KEY_LOAD_ERROR,new Error(`HTTP Error ${v.code} loading key ${v.text}`),_,pn({url:l.url,data:void 0},v)))},onTimeout:(v,x,_)=>{this.resetLoader(x),o(this.createKeyLoadError(t,je.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),_))},onAbort:(v,x,_)=>{this.resetLoader(x),o(this.createKeyLoadError(t,je.INTERNAL_ABORTED,new Error("key loading aborted"),_))}};s.load(l,d,h)})}resetLoader(e){const{frag:t,keyInfo:i,url:r}=e,s=i.loader;t.keyLoader===s&&(t.keyLoader=null,i.loader=null),delete this.keyUriToKeyInfo[r],s&&s.destroy()}}class nx{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}const rx={length:0,start:()=>0,end:()=>0};class pi{static isBuffered(e,t){try{if(e){const i=pi.getBuffered(e);for(let r=0;r<i.length;r++)if(t>=i.start(r)&&t<=i.end(r))return!0}}catch(i){}return!1}static bufferInfo(e,t,i){try{if(e){const r=pi.getBuffered(e),s=[];let a;for(a=0;a<r.length;a++)s.push({start:r.start(a),end:r.end(a)});return this.bufferedInfo(s,t,i)}}catch(r){}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,i){t=Math.max(0,t),e.sort(function(u,d){const h=u.start-d.start;return h||d.end-u.end});let r=[];if(i)for(let u=0;u<e.length;u++){const d=r.length;if(d){const h=r[d-1].end;e[u].start-h<i?e[u].end>h&&(r[d-1].end=e[u].end):r.push(e[u])}else r.push(e[u])}else r=e;let s=0,a,o=t,l=t;for(let u=0;u<r.length;u++){const d=r[u].start,h=r[u].end;if(t+i>=d&&t<h)o=d,l=h,s=l-t;else if(t+i<d){a=d;break}}return{len:s,start:o||0,end:l||0,nextStart:a}}static getBuffered(e){try{return e.buffered}catch(t){return Ce.log("failed to get media.buffered",t),rx}}}class Rc{constructor(e,t,i,r=0,s=-1,a=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=$l(),this.buffering={audio:$l(),video:$l(),audiovideo:$l()},this.level=e,this.sn=t,this.id=i,this.size=r,this.part=s,this.partial=a}}function $l(){return{start:0,executeStart:0,executeEnd:0,end:0}}function im(n,e){let t=null;for(let i=0,r=n.length;i<r;i++){const s=n[i];if(s&&s.cc===e){t=s;break}}return t}function sx(n,e,t){return!!(e.details&&(t.endCC>t.startCC||n&&n.cc<t.startCC))}function ax(n,e,t=0){const i=n.fragments,r=e.fragments;if(!r.length||!i.length){Ce.log("No fragments to align");return}const s=im(i,r[0].cc);if(!s||s&&!s.startPTS){Ce.log("No frag in previous level to align on");return}return s}function nm(n,e){if(n){const t=n.start+e;n.start=n.startPTS=t,n.endPTS=t+n.duration}}function Oc(n,e){const t=e.fragments;for(let i=0,r=t.length;i<r;i++)nm(t[i],n);e.fragmentHint&&nm(e.fragmentHint,n),e.alignedSliding=!0}function ox(n,e,t){!e||(lx(n,t,e),!t.alignedSliding&&e.details&&ux(t,e.details),!t.alignedSliding&&e.details&&!t.skippedSegments&&K0(e.details,t))}function lx(n,e,t){if(sx(n,t,e)){const i=ax(t.details,e);i&&xt(i.start)&&(Ce.log(`Adjusting PTS using last level due to CC increase within current level ${e.url}`),Oc(i.start,e))}}function ux(n,e){if(!e.fragments.length||!n.hasProgramDateTime||!e.hasProgramDateTime)return;const t=e.fragments[0].programDateTime,i=n.fragments[0].programDateTime,r=(i-t)/1e3+e.fragments[0].start;r&&xt(r)&&(Ce.log(`Adjusting PTS using programDateTime delta ${i-t}ms, sliding:${r.toFixed(3)} ${n.url} `),Oc(r,n))}function rm(n,e){if(!n.hasProgramDateTime||!e.hasProgramDateTime)return;const t=n.fragments,i=e.fragments;if(!t.length||!i.length)return;const r=Math.round(i.length/2)-1,s=i[r],a=im(t,s.cc)||t[Math.round(t.length/2)-1],o=s.programDateTime,l=a.programDateTime;if(o===null||l===null)return;const u=(l-o)/1e3-(a.start-s.start);Oc(u,n)}class dx{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}class cx{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}function hx(n){const e=n.byteLength,t=e&&new DataView(n.buffer).getUint8(e-1);return t?Bs(n,0,e-t):n}class fx{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),i=new Uint32Array(4);for(let r=0;r<4;r++)i[r]=t.getUint32(r*4);return i}initTable(){const e=this.sBox,t=this.invSBox,i=this.subMix,r=i[0],s=i[1],a=i[2],o=i[3],l=this.invSubMix,u=l[0],d=l[1],h=l[2],v=l[3],x=new Uint32Array(256);let _=0,R=0,N=0;for(N=0;N<256;N++)N<128?x[N]=N<<1:x[N]=N<<1^283;for(N=0;N<256;N++){let z=R^R<<1^R<<2^R<<3^R<<4;z=z>>>8^z&255^99,e[_]=z,t[z]=_;const J=x[_],ue=x[J],pe=x[ue];let te=x[z]*257^z*16843008;r[_]=te<<24|te>>>8,s[_]=te<<16|te>>>16,a[_]=te<<8|te>>>24,o[_]=te,te=pe*16843009^ue*65537^J*257^_*16843008,u[z]=te<<24|te>>>8,d[z]=te<<16|te>>>16,h[z]=te<<8|te>>>24,v[z]=te,_?(_=J^x[x[x[pe^J]]],R^=x[x[R]]):_=R=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let i=!0,r=0;for(;r<t.length&&i;)i=t[r]===this.key[r],r++;if(i)return;this.key=t;const s=this.keySize=t.length;if(s!==4&&s!==6&&s!==8)throw new Error("Invalid aes key size="+s);const a=this.ksRows=(s+6+1)*4;let o,l;const u=this.keySchedule=new Uint32Array(a),d=this.invKeySchedule=new Uint32Array(a),h=this.sBox,v=this.rcon,x=this.invSubMix,_=x[0],R=x[1],N=x[2],z=x[3];let J,ue;for(o=0;o<a;o++){if(o<s){J=u[o]=t[o];continue}ue=J,o%s==0?(ue=ue<<8|ue>>>24,ue=h[ue>>>24]<<24|h[ue>>>16&255]<<16|h[ue>>>8&255]<<8|h[ue&255],ue^=v[o/s|0]<<24):s>6&&o%s==4&&(ue=h[ue>>>24]<<24|h[ue>>>16&255]<<16|h[ue>>>8&255]<<8|h[ue&255]),u[o]=J=(u[o-s]^ue)>>>0}for(l=0;l<a;l++)o=a-l,l&3?ue=u[o]:ue=u[o-4],l<4||o<=4?d[l]=ue:d[l]=_[h[ue>>>24]]^R[h[ue>>>16&255]]^N[h[ue>>>8&255]]^z[h[ue&255]],d[l]=d[l]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,i){const r=this.keySize+6,s=this.invKeySchedule,a=this.invSBox,o=this.invSubMix,l=o[0],u=o[1],d=o[2],h=o[3],v=this.uint8ArrayToUint32Array_(i);let x=v[0],_=v[1],R=v[2],N=v[3];const z=new Int32Array(e),J=new Int32Array(z.length);let ue,pe,te,ke,we,Ge,Ve,Fe,mt,et,nt,Pt,Gt,Kt;const qt=this.networkToHostOrderSwap;for(;t<z.length;){for(mt=qt(z[t]),et=qt(z[t+1]),nt=qt(z[t+2]),Pt=qt(z[t+3]),we=mt^s[0],Ge=Pt^s[1],Ve=nt^s[2],Fe=et^s[3],Gt=4,Kt=1;Kt<r;Kt++)ue=l[we>>>24]^u[Ge>>16&255]^d[Ve>>8&255]^h[Fe&255]^s[Gt],pe=l[Ge>>>24]^u[Ve>>16&255]^d[Fe>>8&255]^h[we&255]^s[Gt+1],te=l[Ve>>>24]^u[Fe>>16&255]^d[we>>8&255]^h[Ge&255]^s[Gt+2],ke=l[Fe>>>24]^u[we>>16&255]^d[Ge>>8&255]^h[Ve&255]^s[Gt+3],we=ue,Ge=pe,Ve=te,Fe=ke,Gt=Gt+4;ue=a[we>>>24]<<24^a[Ge>>16&255]<<16^a[Ve>>8&255]<<8^a[Fe&255]^s[Gt],pe=a[Ge>>>24]<<24^a[Ve>>16&255]<<16^a[Fe>>8&255]<<8^a[we&255]^s[Gt+1],te=a[Ve>>>24]<<24^a[Fe>>16&255]<<16^a[we>>8&255]<<8^a[Ge&255]^s[Gt+2],ke=a[Fe>>>24]<<24^a[we>>16&255]<<16^a[Ge>>8&255]<<8^a[Ve&255]^s[Gt+3],J[t]=qt(ue^x),J[t+1]=qt(ke^_),J[t+2]=qt(te^R),J[t+3]=qt(pe^N),x=mt,_=et,R=nt,N=Pt,t=t+4}return J.buffer}}const px=16;class Pc{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const i=self.crypto;i&&(this.subtle=i.subtle||i.webkitSubtle)}catch(i){}this.subtle===null&&(this.useSoftware=!0)}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const i=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?hx(i):i}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,i){return this.useSoftware?new Promise((r,s)=>{this.softwareDecrypt(new Uint8Array(e),t,i);const a=this.flush();a?r(a.buffer):s(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,i)}softwareDecrypt(e,t,i){const{currentIV:r,currentResult:s,remainderData:a}=this;this.logOnce("JS AES decrypt"),a&&(e=Fs(a,e),this.remainderData=null);const o=this.getValidChunk(e);if(!o.length)return null;r&&(i=r);let l=this.softwareDecrypter;l||(l=this.softwareDecrypter=new fx),l.expandKey(t);const u=s;return this.currentResult=l.decrypt(o.buffer,0,i),this.currentIV=Bs(o,-16).buffer,u||null}webCryptoDecrypt(e,t,i){const r=this.subtle;return(this.key!==t||!this.fastAesKey)&&(this.key=t,this.fastAesKey=new cx(r,t)),this.fastAesKey.expandKey().then(s=>r?(this.logOnce("WebCrypto AES decrypt"),new dx(r,new Uint8Array(i)).decrypt(e.buffer,s)):Promise.reject(new Error("web crypto not initialized"))).catch(s=>(Ce.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${s.name}: ${s.message}`),this.onWebCryptoError(e,t,i)))}onWebCryptoError(e,t,i){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,i);const r=this.flush();if(r)return r.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e;const i=e.length-e.length%px;return i!==e.length&&(t=Bs(e,0,i),this.remainderData=Bs(e,i)),t}logOnce(e){!this.logEnabled||(Ce.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const mx={toString:function(n){let e="";const t=n.length;for(let i=0;i<t;i++)e+=`[${n.start(i).toFixed(3)}-${n.end(i).toFixed(3)}]`;return e}},Ke={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Bc extends nx{constructor(e,t,i,r,s){super();this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=Ke.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=s,this.logPrefix=r,this.log=Ce.log.bind(Ce,`${r}:`),this.warn=Ce.warn.bind(Ce,`${r}:`),this.hls=e,this.fragmentLoader=new tx(e.config),this.keyLoader=i,this.fragmentTracker=t,this.config=e.config,this.decrypter=new Pc(e.config),e.on(W.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=Ke.STOPPED}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;const i=t.partList;if(i!=null&&i.length){const s=i[i.length-1];return pi.isBuffered(this.media,s.start+s.duration/2)}const r=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(r)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levels[this.levelLastLoaded])==null?void 0:e.details}}onMediaAttached(e,t){const i=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),i.addEventListener("seeking",this.onvseeking),i.addEventListener("ended",this.onvended);const r=this.config;this.levels&&r.autoStartLoad&&this.state===Ke.STOPPED&&this.startLoad(r.startPosition)}onMediaDetaching(){const e=this.media;e!=null&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:t,media:i,mediaBuffer:r,state:s}=this,a=i?i.currentTime:0,o=pi.bufferInfo(r||i,a,e.maxBufferHole);if(this.log(`media seeking to ${xt(a)?a.toFixed(3):a}, state: ${s}`),this.state===Ke.ENDED)this.resetLoadingState();else if(t){const l=e.maxFragLookUpTolerance,u=t.start-l,d=t.start+t.duration+l;if(!o.len||d<o.start||u>o.end){const h=a>d;(a<u||h)&&(h&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}i&&(this.fragmentTracker.removeFragmentsInRange(a,Infinity,this.playlistType,!0),this.lastCurrentTime=a),!this.loadedmetadata&&!o.len&&(this.nextLoadPosition=this.startPosition=a),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.stopLoad(),super.onHandlerDestroying()}onHandlerDestroyed(){this.state=Ke.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,i){this._loadFragForPlayback(e,t,i)}_loadFragForPlayback(e,t,i){const r=s=>{if(this.fragContextChanged(e)){this.warn(`Fragment ${e.sn}${s.part?" p: "+s.part.index:""} of level ${e.level} was dropped during download.`),this.fragmentTracker.removeFragment(e);return}e.stats.chunkCount++,this._handleFragmentLoadProgress(s)};this._doFragLoad(e,t,i,r).then(s=>{if(!s)return;const a=this.state;if(this.fragContextChanged(e)){(a===Ke.FRAG_LOADING||!this.fragCurrent&&a===Ke.PARSING)&&(this.fragmentTracker.removeFragment(e),this.state=Ke.IDLE);return}"payload"in s&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(W.FRAG_LOADED,s)),this._handleFragmentLoadComplete(s)}).catch(s=>{this.state===Ke.STOPPED||this.state===Ke.ERROR||(this.warn(s),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:i}=this;if(i.getState(e)===$i.APPENDING){const s=e.type,a=this.getFwdBufferInfo(this.mediaBuffer,s),o=Math.max(e.duration,a?a.len:this.config.maxBufferLength);this.reduceMaxBufferLength(o)&&i.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?i.removeAllFragments():i.hasParts(e.type)&&(i.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),i.getState(e)===$i.PARTIAL&&i.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}flushMainBuffer(e,t,i=null){if(!(e-t))return;const r={startOffset:e,endOffset:t,type:i};this.hls.trigger(W.BUFFER_FLUSHING,r)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(i=>{if(!i||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return i}).then(i=>{const{hls:r}=this,{payload:s}=i,a=e.decryptdata;if(s&&s.byteLength>0&&a&&a.key&&a.iv&&a.method==="AES-128"){const o=self.performance.now();return this.decrypter.decrypt(new Uint8Array(s),a.key.buffer,a.iv.buffer).catch(l=>{throw r.trigger(W.ERROR,{type:Ct.MEDIA_ERROR,details:je.FRAG_DECRYPT_ERROR,fatal:!1,error:l,reason:l.message,frag:e}),l}).then(l=>{const u=self.performance.now();return r.trigger(W.FRAG_DECRYPTED,{frag:e,payload:l,stats:{tstart:o,tdecrypt:u}}),i.payload=l,i})}return i}).then(i=>{const{fragCurrent:r,hls:s,levels:a}=this;if(!a)throw new Error("init load aborted, missing levels");const o=e.stats;this.state=Ke.IDLE,t.fragmentError=0,e.data=new Uint8Array(i.payload),o.parsing.start=o.buffering.start=self.performance.now(),o.parsing.end=o.buffering.end=self.performance.now(),i.frag===r&&s.trigger(W.FRAG_BUFFERED,{stats:o,frag:r,part:null,id:e.type}),this.tick()}).catch(i=>{this.state===Ke.STOPPED||this.state===Ke.ERROR||(this.warn(i),this.resetFragmentLoading(e))})}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.level!==t.level||e.sn!==t.sn||e.urlId!==t.urlId}fragBufferedComplete(e,t){var i,r,s,a;const o=this.mediaBuffer?this.mediaBuffer:this.media;this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===Lt.MAIN?"level":"track"} ${e.level} (frag:[${((i=e.startPTS)!=null?i:NaN).toFixed(3)}-${((r=e.endPTS)!=null?r:NaN).toFixed(3)}] > buffer:${o?mx.toString(pi.getBuffered(o)):"(detached)"})`),this.state=Ke.IDLE,!!o&&(!this.loadedmetadata&&e.type==Lt.MAIN&&o.buffered.length&&((s=this.fragCurrent)==null?void 0:s.sn)===((a=this.fragPrevious)==null?void 0:a.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:i,part:r,partsLoaded:s}=e,a=!s||s.length===0||s.some(l=>!l),o=new Rc(i.level,i.sn,i.stats.chunkCount+1,0,r?r.index:-1,!a);t.flush(o)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,i=null,r){var s;const a=t==null?void 0:t.details;if(!this.levels||!a)throw new Error(`frag load aborted, missing level${a?"":" detail"}s`);let o=null;if(e.encrypted&&!((s=e.decryptdata)!=null&&s.key)?(this.log(`Loading key for ${e.sn} of [${a.startSN}-${a.endSN}], ${this.logPrefix==="[stream-controller]"?"level":"track"} ${e.level}`),this.state=Ke.KEY_LOADING,this.fragCurrent=e,o=this.keyLoader.load(e).then(d=>{if(!this.fragContextChanged(d.frag))return this.hls.trigger(W.KEY_LOADED,d),this.state===Ke.KEY_LOADING&&(this.state=Ke.IDLE),d}),this.hls.trigger(W.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(o=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!e.encrypted&&a.encryptedFragments.length&&this.keyLoader.loadClear(e,a.encryptedFragments),i=Math.max(e.start,i||0),this.config.lowLatencyMode&&e.sn!=="initSegment"){const d=a.partList;if(d&&r){i>e.end&&a.fragmentHint&&(e=a.fragmentHint);const h=this.getNextPart(d,e,i);if(h>-1){const v=d[h];this.log(`Loading part sn: ${e.sn} p: ${v.index} cc: ${e.cc} of playlist [${a.startSN}-${a.endSN}] parts [0-${h}-${d.length-1}] ${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(i.toFixed(3))}`),this.nextLoadPosition=v.start+v.duration,this.state=Ke.FRAG_LOADING;let x;return o?x=o.then(_=>!_||this.fragContextChanged(_.frag)?null:this.doFragPartsLoad(e,v,t,r)).catch(_=>this.handleFragLoadError(_)):x=this.doFragPartsLoad(e,v,t,r).catch(_=>this.handleFragLoadError(_)),this.hls.trigger(W.FRAG_LOADING,{frag:e,part:v,targetBufferTime:i}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):x}else if(!e.url||this.loadedEndOfParts(d,i))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${a?"of ["+a.startSN+"-"+a.endSN+"] ":""}${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(i.toFixed(3))}`),xt(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=Ke.FRAG_LOADING;const l=this.config.progressive;let u;return l&&o?u=o.then(d=>!d||this.fragContextChanged(d==null?void 0:d.frag)?null:this.fragmentLoader.load(e,r)).catch(d=>this.handleFragLoadError(d)):u=Promise.all([this.fragmentLoader.load(e,l?r:void 0),o]).then(([d])=>(!l&&d&&r&&r(d),d)).catch(d=>this.handleFragLoadError(d)),this.hls.trigger(W.FRAG_LOADING,{frag:e,targetBufferTime:i}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):u}doFragPartsLoad(e,t,i,r){return new Promise((s,a)=>{var o;const l=[],u=(o=i.details)==null?void 0:o.partList,d=h=>{this.fragmentLoader.loadPart(e,h,r).then(v=>{l[h.index]=v;const x=v.part;this.hls.trigger(W.FRAG_LOADED,v);const _=q0(i,e.sn,h.index+1)||z0(u,e.sn,h.index+1);if(_)d(_);else return s({frag:e,part:x,partsLoaded:l})}).catch(a)};d(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===je.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(W.ERROR,t)}else this.hls.trigger(W.ERROR,{type:Ct.OTHER_ERROR,details:je.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==Ke.PARSING){!this.fragCurrent&&this.state!==Ke.STOPPED&&this.state!==Ke.ERROR&&(this.state=Ke.IDLE);return}const{frag:i,part:r,level:s}=t,a=self.performance.now();i.stats.parsing.end=a,r&&(r.stats.parsing.end=a),this.updateLevelTiming(i,r,s,e.partial)}getCurrentContext(e){const{levels:t,fragCurrent:i}=this,{level:r,sn:s,part:a}=e;if(!(t!=null&&t[r]))return this.warn(`Levels object was unset while buffering fragment ${s} of level ${r}. The current chunk will not be buffered.`),null;const o=t[r],l=a>-1?q0(o,s,a):null,u=l?l.fragment:W_(o,s,i);return u?(i&&i!==u&&(u.stats=i.stats),{frag:u,part:l,level:o}):null}bufferFragmentData(e,t,i,r,s){var a;if(!e||this.state!==Ke.PARSING)return;const{data1:o,data2:l}=e;let u=o;if(o&&l&&(u=Fs(o,l)),!((a=u)!=null&&a.length))return;const d={type:e.type,frag:t,part:i,chunkMeta:r,parent:t.type,data:u};if(this.hls.trigger(W.BUFFER_APPENDING,d),e.dropped&&e.independent&&!i){if(s)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!pi.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const i=t.currentTime,r=pi.bufferInfo(t,i,0),s=e.duration,a=Math.min(this.config.maxFragLookUpTolerance*2,s*.25),o=Math.max(Math.min(e.start-a,r.end-a),i+a);e.start-o>a&&this.flushMainBuffer(o,e.start)}getFwdBufferInfo(e,t){const i=this.getLoadPosition();return xt(i)?this.getFwdBufferInfoAtPos(e,i,t):null}getFwdBufferInfoAtPos(e,t,i){const{config:{maxBufferHole:r}}=this,s=pi.bufferInfo(e,t,r);if(s.len===0&&s.nextStart!==void 0){const a=this.fragmentTracker.getBufferedFrag(t,i);if(a&&s.nextStart<a.end)return pi.bufferInfo(e,t,Math.max(s.nextStart,r))}return s}getMaxBufferLength(e){const{config:t}=this;let i;return e?i=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):i=t.maxBufferLength,Math.min(i,t.maxMaxBufferLength)}reduceMaxBufferLength(e){const t=this.config,i=e||t.maxBufferLength;return t.maxMaxBufferLength>=i?(t.maxMaxBufferLength/=2,this.warn(`Reduce max buffer length to ${t.maxMaxBufferLength}s`),!0):!1}getAppendedFrag(e,t=Lt.MAIN){const i=this.fragmentTracker.getAppendedFrag(e,Lt.MAIN);return i&&"fragment"in i?i.fragment:i}getNextFragment(e,t){const i=t.fragments,r=i.length;if(!r)return null;const{config:s}=this,a=i[0].start;let o;if(t.live){const l=s.initialLiveManifestSize;if(r<l)return this.warn(`Not enough fragments to start playback (have: ${r}, need: ${l})`),null;!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&(o=this.getInitialLiveFragment(t,i),this.startPosition=o?this.hls.liveSyncPosition||o.start:e)}else e<=a&&(o=i[0]);if(!o){const l=s.lowLatencyMode?t.partEnd:t.fragmentEnd;o=this.getFragmentAtPosition(e,l,t)}return this.mapToInitFragWhenRequired(o)}isLoopLoading(e,t){const i=this.fragmentTracker.getState(e);return(i===$i.OK||i===$i.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,i,r,s){const a=e.gap,o=this.getNextFragment(this.nextLoadPosition,t);if(o===null)return o;if(e=o,a&&e&&!e.gap&&i.nextStart){const l=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,i.nextStart,r);if(l!==null&&i.len+l.len>=s)return this.log(`buffer full after gaps in "${r}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,i){let r=-1,s=!1,a=!0;for(let o=0,l=e.length;o<l;o++){const u=e[o];if(a=a&&!u.independent,r>-1&&i<u.start)break;const d=u.loaded;d?r=-1:(s||u.independent||a)&&u.fragment===t&&(r=o),s=d}return r}loadedEndOfParts(e,t){const i=e[e.length-1];return i&&t>i.start&&i.loaded}getInitialLiveFragment(e,t){const i=this.fragPrevious;let r=null;if(i){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${i.programDateTime}`),r=q_(t,i.endProgramDateTime,this.config.maxFragLookUpTolerance)),!r){const s=i.sn+1;if(s>=e.startSN&&s<=e.endSN){const a=t[s-e.startSN];i.cc===a.cc&&(r=a,this.log(`Live playlist, switching playlist, load frag with next SN: ${r.sn}`))}r||(r=Y_(t,i.cc),r&&this.log(`Live playlist, switching playlist, load frag with same CC: ${r.sn}`))}}else{const s=this.hls.liveSyncPosition;s!==null&&(r=this.getFragmentAtPosition(s,this.bitrateTest?e.fragmentEnd:e.edge,e))}return r}getFragmentAtPosition(e,t,i){const{config:r}=this;let{fragPrevious:s}=this,{fragments:a,endSN:o}=i;const{fragmentHint:l}=i,u=r.maxFragLookUpTolerance,d=i.partList,h=!!(r.lowLatencyMode&&d!=null&&d.length&&l);h&&l&&!this.bitrateTest&&(a=a.concat(l),o=l.sn);let v;if(e<t){const x=e>t-u?0:u;v=mo(s,a,e,x)}else v=a[a.length-1];if(v){const x=v.sn-i.startSN,_=this.fragmentTracker.getState(v);if((_===$i.OK||_===$i.PARTIAL&&v.gap)&&(s=v),s&&v.sn===s.sn&&(!h||d[0].fragment.sn>v.sn)&&s&&v.level===s.level){const N=a[x+1];v.sn<o&&this.fragmentTracker.getState(N)!==$i.OK?v=N:v=null}}return v}synchronizeToLiveEdge(e){const{config:t,media:i}=this;if(!i)return;const r=this.hls.liveSyncPosition,s=i.currentTime,a=e.fragments[0].start,o=e.edge,l=s>=a-t.maxFragLookUpTolerance&&s<=o;if(r!==null&&i.duration>r&&(s<r||!l)){const u=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!l&&i.readyState<4||s<o-u)&&(this.loadedmetadata||(this.nextLoadPosition=r),i.readyState&&(this.warn(`Playback: ${s.toFixed(3)} is located too far from the end of live sliding playlist: ${o}, reset currentTime to : ${r.toFixed(3)}`),i.currentTime=r))}}alignPlaylists(e,t){const{levels:i,levelLastLoaded:r,fragPrevious:s}=this,a=r!==null?i[r]:null,o=e.fragments.length;if(!o)return this.warn("No fragments in live playlist"),0;const l=e.fragments[0].start,u=!t,d=e.alignedSliding&&xt(l);if(u||!d&&!l){ox(s,a,e);const h=e.fragments[0].start;return this.log(`Live playlist sliding: ${h.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${s?s.sn:"na"} fragments: ${o}`),h}return l}waitForCdnTuneIn(e){const t=3;return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*t)}setStartPosition(e,t){let i=this.startPosition;if(i<t&&(i=-1),i===-1||this.lastCurrentTime===-1){const r=this.startTimeOffset!==null,s=r?this.startTimeOffset:e.startTimeOffset;s!==null&&xt(s)?(i=t+s,s<0&&(i+=e.totalduration),i=Math.min(Math.max(t,i),t+e.totalduration),this.log(`Start time offset ${s} found in ${r?"multivariant":"media"} playlist, adjust startPosition to ${i}`),this.startPosition=i):e.live?i=this.hls.liveSyncPosition||t:this.startPosition=i=0,this.lastCurrentTime=i}this.nextLoadPosition=i}getLoadPosition(){const{media:e}=this;let t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&e.sn!=="initSegment"&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==Ke.FRAG_LOADING_WAITING_RETRY)&&(this.state=Ke.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const h=this.getCurrentContext(t.chunkMeta);h&&(t.frag=h.frag)}const i=t.frag;if(!i||i.type!==e||!this.levels)return;if(this.fragContextChanged(i)){var r;this.warn(`Frag load error must match current frag to retry ${i.url} > ${(r=this.fragCurrent)==null?void 0:r.url}`);return}const s=t.details===je.FRAG_GAP;s&&this.fragmentTracker.fragBuffered(i,!0);const a=t.errorAction,{action:o,retryCount:l=0,retryConfig:u}=a||{};if(a&&o===Zi.RetryRequest&&u){var d;this.resetStartWhenNotLoaded((d=this.levelLastLoaded)!=null?d:i.level);const h=Lc(u,l);this.warn(`Fragment ${i.sn} of ${e} ${i.level} errored with ${t.details}, retrying loading ${l+1}/${u.maxNumRetry} in ${h}ms`),a.resolved=!0,this.retryDate=self.performance.now()+h,this.state=Ke.FRAG_LOADING_WAITING_RETRY}else u&&a?(this.resetFragmentErrors(e),l<u.maxNumRetry?s||(a.resolved=!0):Ce.warn(`${t.details} reached or exceeded max retry (${l})`)):(a==null?void 0:a.action)===Zi.SendAlternateToPenaltyBox?this.state=Ke.WAITING_LEVEL:this.state=Ke.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===Ke.PARSING||this.state===Ke.PARSED){const t=e.parent,i=this.getFwdBufferInfo(this.mediaBuffer,t),r=i&&i.len>.5;r&&this.reduceMaxBufferLength(i.len);const s=!r;return s&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${t} buffer`),e.frag&&(this.fragmentTracker.removeFragment(e.frag),this.nextLoadPosition=e.frag.start),this.resetLoadingState(),s}return!1}resetFragmentErrors(e){e===Lt.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==Ke.STOPPED&&(this.state=Ke.IDLE)}afterBufferFlushed(e,t,i){if(!e)return;const r=pi.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,r,i),this.state===Ke.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=Ke.IDLE}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const t=this.levels?this.levels[e].details:null;t!=null&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){var t;this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded((t=this.levelLastLoaded)!=null?t:e.level),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,Infinity,this.playlistType,!1,!0)}updateLevelTiming(e,t,i,r){var s;const a=i.details;if(!a){this.warn("level.details undefined");return}if(Object.keys(e.elementaryStreams).reduce((l,u)=>{const d=e.elementaryStreams[u];if(d){const h=d.endPTS-d.startPTS;if(h<=0)return this.warn(`Could not parse fragment ${e.sn} ${u} duration reliably (${h})`),l||!1;const v=r?0:W0(a,e,d.startPTS,d.endPTS,d.startDTS,d.endDTS);return this.hls.trigger(W.LEVEL_PTS_UPDATED,{details:a,level:i,drift:v,type:u,frag:e,start:d.startPTS,end:d.endPTS}),!0}return l},!1))i.fragmentError=0;else if(((s=this.transmuxer)==null?void 0:s.error)===null){const l=new Error(`Found no media in fragment ${e.sn} of level ${e.level} resetting transmuxer to fallback to playlist timing`);if(i.fragmentError===0&&(i.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(l.message),this.hls.trigger(W.ERROR,{type:Ct.MEDIA_ERROR,details:je.FRAG_PARSING_ERROR,fatal:!1,error:l,frag:e,reason:`Found no media in msn ${e.sn} of level "${i.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=Ke.PARSED,this.hls.trigger(W.FRAG_PARSED,{frag:e,part:t})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){if(e.event==="demuxerWorker"){var t,i,r;this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded((t=(i=this.levelLastLoaded)!=null?i:(r=this.fragCurrent)==null?void 0:r.level)!=null?t:0),this.resetLoadingState()}}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function sm(){return self.SourceBuffer||self.WebKitSourceBuffer}function gx(){const n=Bl();if(!n)return!1;const e=sm(),t=n&&typeof n.isTypeSupported=="function"&&n.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),i=!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function";return!!t&&!!i}function yx(){var n;const e=sm();return typeof(e==null||(n=e.prototype)==null?void 0:n.changeType)=="function"}function vx(){return typeof __HLS_WORKER_BUNDLE__=="function"}function Ax(){const n=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(n);return{worker:new self.Worker(e),objectURL:e}}function bx(n){const e=new self.URL(n,self.location.href).href;return{worker:new self.Worker(e),scriptURL:e}}function Tr(n="",e=9e4){return{type:n,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class am{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,i,r){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,i){}demux(e,t){this.cachedData&&(e=Fs(this.cachedData,e),this.cachedData=null);let i=Il(e,0),r=i?i.length:0,s;const a=this._audioTrack,o=this._id3Track,l=i?i_(i):void 0,u=e.length;for((this.basePTS===null||this.frameIndex===0&&xt(l))&&(this.basePTS=_x(l,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),i&&i.length>0&&o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:nr.audioId3,duration:Number.POSITIVE_INFINITY});r<u;){if(this.canParse(e,r)){const d=this.appendFrame(a,e,r);d?(this.frameIndex++,this.lastPTS=d.sample.pts,r+=d.length,s=r):r=u}else t_(e,r)?(i=Il(e,r),o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:nr.audioId3,duration:Number.POSITIVE_INFINITY}),r+=i.length,s=r):r++;if(r===u&&s!==u){const d=Bs(e,s);this.cachedData?this.cachedData=Fs(this.cachedData,d):this.cachedData=d}}return{audioTrack:a,videoTrack:Tr(),id3Track:o,textTrack:Tr()}}demuxSampleAes(e,t,i){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:Tr(),id3Track:this._id3Track,textTrack:Tr()}}destroy(){}}const _x=(n,e,t)=>{if(xt(n))return n*90;const i=t?t.baseTime*9e4/t.timescale:0;return e*9e4+i};function xx(n,e,t,i){let r,s,a,o;const l=navigator.userAgent.toLowerCase(),u=i,d=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];r=((e[t+2]&192)>>>6)+1;const h=(e[t+2]&60)>>>2;if(h>d.length-1){n.trigger(W.ERROR,{type:Ct.MEDIA_ERROR,details:je.FRAG_PARSING_ERROR,fatal:!0,reason:`invalid ADTS sampling index:${h}`});return}return a=(e[t+2]&1)<<2,a|=(e[t+3]&192)>>>6,Ce.log(`manifest codec:${i}, ADTS type:${r}, samplingIndex:${h}`),/firefox/i.test(l)?h>=6?(r=5,o=new Array(4),s=h-3):(r=2,o=new Array(2),s=h):l.indexOf("android")!==-1?(r=2,o=new Array(2),s=h):(r=5,o=new Array(4),i&&(i.indexOf("mp4a.40.29")!==-1||i.indexOf("mp4a.40.5")!==-1)||!i&&h>=6?s=h-3:((i&&i.indexOf("mp4a.40.2")!==-1&&(h>=6&&a===1||/vivaldi/i.test(l))||!i&&a===1)&&(r=2,o=new Array(2)),s=h)),o[0]=r<<3,o[0]|=(h&14)>>1,o[1]|=(h&1)<<7,o[1]|=a<<3,r===5&&(o[1]|=(s&14)>>1,o[2]=(s&1)<<7,o[2]|=2<<2,o[3]=0),{config:o,samplerate:d[h],channelCount:a,codec:"mp4a.40."+r,manifestCodec:u}}function om(n,e){return n[e]===255&&(n[e+1]&246)==240}function lm(n,e){return n[e+1]&1?7:9}function Fc(n,e){return(n[e+3]&3)<<11|n[e+4]<<3|(n[e+5]&224)>>>5}function Ex(n,e){return e+5<n.length}function Gl(n,e){return e+1<n.length&&om(n,e)}function Tx(n,e){return Ex(n,e)&&om(n,e)&&Fc(n,e)<=n.length-e}function Sx(n,e){if(Gl(n,e)){const t=lm(n,e);if(e+t>=n.length)return!1;const i=Fc(n,e);if(i<=t)return!1;const r=e+i;return r===n.length||Gl(n,r)}return!1}function um(n,e,t,i,r){if(!n.samplerate){const s=xx(e,t,i,r);if(!s)return;n.config=s.config,n.samplerate=s.samplerate,n.channelCount=s.channelCount,n.codec=s.codec,n.manifestCodec=s.manifestCodec,Ce.log(`parsed codec:${n.codec}, rate:${s.samplerate}, channels:${s.channelCount}`)}}function dm(n){return 1024*9e4/n}function Cx(n,e){const t=lm(n,e);if(e+t<=n.length){const i=Fc(n,e)-t;if(i>0)return{headerLength:t,frameLength:i}}}function cm(n,e,t,i,r){const s=dm(n.samplerate),a=i+r*s,o=Cx(e,t);let l;if(o){const{frameLength:h,headerLength:v}=o,x=v+h,_=Math.max(0,t+x-e.length);_?(l=new Uint8Array(x-v),l.set(e.subarray(t+v,e.length),0)):l=e.subarray(t+v,t+x);const R={unit:l,pts:a};return _||n.samples.push(R),{sample:R,length:x,missing:_}}const u=e.length-t;return l=new Uint8Array(u),l.set(e.subarray(t,e.length),0),{sample:{unit:l,pts:a},length:u,missing:-1}}class wx extends am{constructor(e,t){super();this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,i,r){super.resetInitSegment(e,t,i,r),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let i=(Il(e,0)||[]).length;for(let r=e.length;i<r;i++)if(Sx(e,i))return Ce.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return Tx(e,t)}appendFrame(e,t,i){um(e,this.observer,t,i,e.manifestCodec);const r=cm(e,t,i,this.basePTS,this.frameIndex);if(r&&r.missing===0)return r}}const Lx=/\/emsg[-/]ID3/i;class Dx{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,i,r){const s=this.videoTrack=Tr("video",1),a=this.audioTrack=Tr("audio",1),o=this.txtTrack=Tr("text",1);if(this.id3Track=Tr("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const l=E0(e);if(l.video){const{id:u,timescale:d,codec:h}=l.video;s.id=u,s.timescale=o.timescale=d,s.codec=h}if(l.audio){const{id:u,timescale:d,codec:h}=l.audio;a.id=u,a.timescale=d,a.codec=h}o.id=b0.text,s.sampleDuration=0,s.duration=a.duration=r}resetContiguity(){this.remainderData=null}static probe(e){return e=e.length>16384?e.subarray(0,16384):e,Wt(e,["moof"]).length>0}demux(e,t){this.timeOffset=t;let i=e;const r=this.videoTrack,s=this.txtTrack;if(this.config.progressive){this.remainderData&&(i=Fs(this.remainderData,e));const o=y_(i);this.remainderData=o.remainder,r.samples=o.valid||new Uint8Array}else r.samples=i;const a=this.extractID3Track(r,t);return s.samples=S0(t,r),{videoTrack:r,audioTrack:this.audioTrack,id3Track:a,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,i=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const r=this.extractID3Track(t,this.timeOffset);return i.samples=S0(e,t),{videoTrack:t,audioTrack:Tr(),id3Track:r,textTrack:Tr()}}extractID3Track(e,t){const i=this.id3Track;if(e.samples.length){const r=Wt(e.samples,["emsg"]);r&&r.forEach(s=>{const a=b_(s);if(Lx.test(a.schemeIdUri)){const o=xt(a.presentationTime)?a.presentationTime/a.timeScale:t+a.presentationTimeDelta/a.timeScale;let l=a.eventDuration===4294967295?Number.POSITIVE_INFINITY:a.eventDuration/a.timeScale;l<=.001&&(l=Number.POSITIVE_INFINITY);const u=a.payload;i.samples.push({data:u,len:u.byteLength,dts:o,pts:o,type:nr.emsg,duration:l})}})}return i}demuxSampleAes(e,t,i){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}}let Vl=null;const kx=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],Ix=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],Rx=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],Ox=[0,1,1,4];function hm(n,e,t,i,r){if(t+24>e.length)return;const s=fm(e,t);if(s&&t+s.frameLength<=e.length){const a=s.samplesPerFrame*9e4/s.sampleRate,o=i+r*a,l={unit:e.subarray(t,t+s.frameLength),pts:o,dts:o};return n.config=[],n.channelCount=s.channelCount,n.samplerate=s.sampleRate,n.samples.push(l),{sample:l,length:s.frameLength,missing:0}}}function fm(n,e){const t=n[e+1]>>3&3,i=n[e+1]>>1&3,r=n[e+2]>>4&15,s=n[e+2]>>2&3;if(t!==1&&r!==0&&r!==15&&s!==3){const a=n[e+2]>>1&1,o=n[e+3]>>6,l=t===3?3-i:i===3?3:4,u=kx[l*14+r-1]*1e3,h=Ix[(t===3?0:t===2?1:2)*3+s],v=o===3?1:2,x=Rx[t][i],_=Ox[i],R=x*8*_,N=Math.floor(x*u/h+a)*_;if(Vl===null){const ue=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Vl=ue?parseInt(ue[1]):0}return!!Vl&&Vl<=87&&i===2&&u>=224e3&&o===0&&(n[e+3]=n[e+3]|128),{sampleRate:h,channelCount:v,frameLength:N,samplesPerFrame:R}}}function Mc(n,e){return n[e]===255&&(n[e+1]&224)==224&&(n[e+1]&6)!=0}function pm(n,e){return e+1<n.length&&Mc(n,e)}function Px(n,e){const t=4;return Mc(n,e)&&t<=n.length-e}function Bx(n,e){if(e+1<n.length&&Mc(n,e)){const t=4,i=fm(n,e);let r=t;i!=null&&i.frameLength&&(r=i.frameLength);const s=e+r;return s===n.length||pm(n,s)}return!1}class mm{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,i=e.byteLength-t,r=new Uint8Array(4),s=Math.min(4,t);if(s===0)throw new Error("no bytes available");r.set(e.subarray(i,i+s)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=s*8,this.bytesAvailable-=s}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const i=this.word>>>32-t;if(e>32&&Ce.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?i<<t|this.readBits(t):i}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!=0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t=8,i=8,r;for(let s=0;s<e;s++)i!==0&&(r=this.readEG(),i=(t+r+256)%256),t=i===0?t:i}readSPS(){let e=0,t=0,i=0,r=0,s,a,o;const l=this.readUByte.bind(this),u=this.readBits.bind(this),d=this.readUEG.bind(this),h=this.readBoolean.bind(this),v=this.skipBits.bind(this),x=this.skipEG.bind(this),_=this.skipUEG.bind(this),R=this.skipScalingList.bind(this);l();const N=l();if(u(5),v(3),l(),_(),N===100||N===110||N===122||N===244||N===44||N===83||N===86||N===118||N===128){const ke=d();if(ke===3&&v(1),_(),_(),v(1),h())for(a=ke!==3?8:12,o=0;o<a;o++)h()&&(o<6?R(16):R(64))}_();const z=d();if(z===0)d();else if(z===1)for(v(1),x(),x(),s=d(),o=0;o<s;o++)x();_(),v(1);const J=d(),ue=d(),pe=u(1);pe===0&&v(1),v(1),h()&&(e=d(),t=d(),i=d(),r=d());let te=[1,1];if(h()&&h())switch(l()){case 1:te=[1,1];break;case 2:te=[12,11];break;case 3:te=[10,11];break;case 4:te=[16,11];break;case 5:te=[40,33];break;case 6:te=[24,11];break;case 7:te=[20,11];break;case 8:te=[32,11];break;case 9:te=[80,33];break;case 10:te=[18,11];break;case 11:te=[15,11];break;case 12:te=[64,33];break;case 13:te=[160,99];break;case 14:te=[4,3];break;case 15:te=[3,2];break;case 16:te=[2,1];break;case 255:{te=[l()<<8|l(),l()<<8|l()];break}}return{width:Math.ceil((J+1)*16-e*2-t*2),height:(2-pe)*(ue+1)*16-(pe?2:4)*(i+r),pixelRatio:te}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class Fx{constructor(e,t,i){this.keyData=void 0,this.decrypter=void 0,this.keyData=i,this.decrypter=new Pc(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,i){const r=e[t].unit;if(r.length<=16)return;const s=r.subarray(16,r.length-r.length%16),a=s.buffer.slice(s.byteOffset,s.byteOffset+s.length);this.decryptBuffer(a).then(o=>{const l=new Uint8Array(o);r.set(l,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,i)})}decryptAacSamples(e,t,i){for(;;t++){if(t>=e.length){i();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,i),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,i=new Int8Array(t);let r=0;for(let s=32;s<e.length-16;s+=160,r+=16)i.set(e.subarray(s,s+16),r);return i}getAvcDecryptedUnit(e,t){const i=new Uint8Array(t);let r=0;for(let s=32;s<e.length-16;s+=160,r+=16)e.set(i.subarray(r,r+16),s);return e}decryptAvcSample(e,t,i,r,s){const a=w0(s.data),o=this.getAvcEncryptedData(a);this.decryptBuffer(o.buffer).then(l=>{s.data=this.getAvcDecryptedUnit(a,l),this.decrypter.isSync()||this.decryptAvcSamples(e,t,i+1,r)})}decryptAvcSamples(e,t,i,r){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,i=0){if(t>=e.length){r();return}const s=e[t].units;for(;!(i>=s.length);i++){const a=s[i];if(!(a.data.length<=48||a.type!==1&&a.type!==5)&&(this.decryptAvcSample(e,t,i,r,a),!this.decrypter.isSync()))return}}}}const Ji=188;class hs{constructor(e,t,i){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=e,this.config=t,this.typeSupported=i}static probe(e){const t=hs.syncOffset(e);return t>0&&Ce.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),t!==-1}static syncOffset(e){const t=e.length;let i=Math.min(Ji*5,e.length-Ji)+1,r=0;for(;r<i;){let s=!1,a=-1,o=0;for(let l=r;l<t;l+=Ji)if(e[l]===71){if(o++,a===-1&&(a=l,a!==0&&(i=Math.min(a+Ji*99,e.length-Ji)+1)),s||(s=Nc(e,l)===0),s&&o>1&&(a===0&&o>2||l+Ji>i))return a}else{if(o)return-1;break}r++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:b0[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,i,r){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=hs.createTrack("video"),this._audioTrack=hs.createTrack("audio",r),this._id3Track=hs.createTrack("id3"),this._txtTrack=hs.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=i,this._duration=r}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_avcTrack:t,_id3Track:i}=this;e&&(e.pesData=null),t&&(t.pesData=null),i&&(i.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null}demux(e,t,i=!1,r=!1){i||(this.sampleAes=null);let s;const a=this._avcTrack,o=this._audioTrack,l=this._id3Track,u=this._txtTrack;let d=a.pid,h=a.pesData,v=o.pid,x=l.pid,_=o.pesData,R=l.pesData,N=null,z=this.pmtParsed,J=this._pmtId,ue=e.length;if(this.remainderData&&(e=Fs(this.remainderData,e),ue=e.length,this.remainderData=null),ue<Ji&&!r)return this.remainderData=e,{audioTrack:o,videoTrack:a,id3Track:l,textTrack:u};const pe=Math.max(0,hs.syncOffset(e));ue-=(ue-pe)%Ji,ue<e.byteLength&&!r&&(this.remainderData=new Uint8Array(e.buffer,ue,e.buffer.byteLength-ue));let te=0;for(let we=pe;we<ue;we+=Ji)if(e[we]===71){const Ge=!!(e[we+1]&64),Ve=Nc(e,we),Fe=(e[we+3]&48)>>4;let mt;if(Fe>1){if(mt=we+5+e[we+4],mt===we+Ji)continue}else mt=we+4;switch(Ve){case d:Ge&&(h&&(s=Ca(h))&&this.parseAVCPES(a,u,s,!1),h={data:[],size:0}),h&&(h.data.push(e.subarray(mt,we+Ji)),h.size+=we+Ji-mt);break;case v:if(Ge){if(_&&(s=Ca(_)))switch(o.segmentCodec){case"aac":this.parseAACPES(o,s);break;case"mp3":this.parseMPEGPES(o,s);break}_={data:[],size:0}}_&&(_.data.push(e.subarray(mt,we+Ji)),_.size+=we+Ji-mt);break;case x:Ge&&(R&&(s=Ca(R))&&this.parseID3PES(l,s),R={data:[],size:0}),R&&(R.data.push(e.subarray(mt,we+Ji)),R.size+=we+Ji-mt);break;case 0:Ge&&(mt+=e[mt]+1),J=this._pmtId=Mx(e,mt);break;case J:{Ge&&(mt+=e[mt]+1);const et=Nx(e,mt,this.typeSupported,i);d=et.avc,d>0&&(a.pid=d),v=et.audio,v>0&&(o.pid=v,o.segmentCodec=et.segmentCodec),x=et.id3,x>0&&(l.pid=x),N!==null&&!z&&(Ce.warn(`MPEG-TS PMT found at ${we} after unknown PID '${N}'. Backtracking to sync byte @${pe} to parse all TS packets.`),N=null,we=pe-188),z=this.pmtParsed=!0;break}case 17:case 8191:break;default:N=Ve;break}}else te++;if(te>0){const we=new Error(`Found ${te} TS packet/s that do not start with 0x47`);this.observer.emit(W.ERROR,W.ERROR,{type:Ct.MEDIA_ERROR,details:je.FRAG_PARSING_ERROR,fatal:!1,error:we,reason:we.message})}a.pesData=h,o.pesData=_,l.pesData=R;const ke={audioTrack:o,videoTrack:a,id3Track:l,textTrack:u};return r&&this.extractRemainingSamples(ke),ke}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:i,id3Track:r,textTrack:s}=e,a=i.pesData,o=t.pesData,l=r.pesData;let u;if(a&&(u=Ca(a))?(this.parseAVCPES(i,s,u,!0),i.pesData=null):i.pesData=a,o&&(u=Ca(o))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,u);break;case"mp3":this.parseMPEGPES(t,u);break}t.pesData=null}else o!=null&&o.size&&Ce.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=o;l&&(u=Ca(l))?(this.parseID3PES(r,u),r.pesData=null):r.pesData=l}demuxSampleAes(e,t,i){const r=this.demux(e,i,!0,!this.config.progressive),s=this.sampleAes=new Fx(this.observer,this.config,t);return this.decrypt(r,s)}decrypt(e,t){return new Promise(i=>{const{audioTrack:r,videoTrack:s}=e;r.samples&&r.segmentCodec==="aac"?t.decryptAacSamples(r.samples,0,()=>{s.samples?t.decryptAvcSamples(s.samples,0,0,()=>{i(e)}):i(e)}):s.samples&&t.decryptAvcSamples(s.samples,0,0,()=>{i(e)})})}destroy(){this._duration=0}parseAVCPES(e,t,i,r){const s=this.parseAVCNALu(e,i.data);let a=this.avcSample,o,l=!1;i.data=null,a&&s.length&&!e.audFound&&(go(a,e),a=this.avcSample=Hl(!1,i.pts,i.dts,"")),s.forEach(u=>{var d;switch(u.type){case 1:{let v=!1;o=!0;const x=u.data;if(l&&x.length>4){const _=new mm(x).readSliceType();(_===2||_===4||_===7||_===9)&&(v=!0)}if(v){var h;(h=a)!=null&&h.frame&&!a.key&&(go(a,e),a=this.avcSample=null)}a||(a=this.avcSample=Hl(!0,i.pts,i.dts,"")),a.frame=!0,a.key=v;break}case 5:o=!0,(d=a)!=null&&d.frame&&!a.key&&(go(a,e),a=this.avcSample=null),a||(a=this.avcSample=Hl(!0,i.pts,i.dts,"")),a.key=!0,a.frame=!0;break;case 6:{o=!0,C0(u.data,1,i.pts,t.samples);break}case 7:if(o=!0,l=!0,!e.sps){const v=u.data,_=new mm(v).readSPS();e.width=_.width,e.height=_.height,e.pixelRatio=_.pixelRatio,e.sps=[v],e.duration=this._duration;const R=v.subarray(1,4);let N="avc1.";for(let z=0;z<3;z++){let J=R[z].toString(16);J.length<2&&(J="0"+J),N+=J}e.codec=N}break;case 8:o=!0,e.pps||(e.pps=[u.data]);break;case 9:o=!1,e.audFound=!0,a&&go(a,e),a=this.avcSample=Hl(!1,i.pts,i.dts,"");break;case 12:o=!0;break;default:o=!1,a&&(a.debug+="unknown NAL "+u.type+" ");break}a&&o&&a.units.push(u)}),r&&a&&(go(a,e),this.avcSample=null)}getLastNalUnit(e){var t;let i=this.avcSample,r;if((!i||i.units.length===0)&&(i=e[e.length-1]),(t=i)!=null&&t.units){const s=i.units;r=s[s.length-1]}return r}parseAVCNALu(e,t){const i=t.byteLength;let r=e.naluState||0;const s=r,a=[];let o=0,l,u,d,h=-1,v=0;for(r===-1&&(h=0,v=t[0]&31,r=0,o=1);o<i;){if(l=t[o++],!r){r=l?0:1;continue}if(r===1){r=l?0:2;continue}if(!l)r=3;else if(l===1){if(h>=0){const x={data:t.subarray(h,o-r-1),type:v};a.push(x)}else{const x=this.getLastNalUnit(e.samples);if(x&&(s&&o<=4-s&&x.state&&(x.data=x.data.subarray(0,x.data.byteLength-s)),u=o-r-1,u>0)){const _=new Uint8Array(x.data.byteLength+u);_.set(x.data,0),_.set(t.subarray(0,u),x.data.byteLength),x.data=_,x.state=0}}o<i?(d=t[o]&31,h=o,v=d,r=0):r=-1}else r=0}if(h>=0&&r>=0){const x={data:t.subarray(h,i),type:v,state:r};a.push(x)}if(a.length===0){const x=this.getLastNalUnit(e.samples);if(x){const _=new Uint8Array(x.data.byteLength+t.byteLength);_.set(x.data,0),_.set(t,x.data.byteLength),x.data=_}}return e.naluState=r,a}parseAACPES(e,t){let i=0;const r=this.aacOverFlow;let s=t.data;if(r){this.aacOverFlow=null;const h=r.missing,v=r.sample.unit.byteLength;if(h===-1){const x=new Uint8Array(v+s.byteLength);x.set(r.sample.unit,0),x.set(s,v),s=x}else{const x=v-h;r.sample.unit.set(s.subarray(0,h),x),e.samples.push(r.sample),i=r.missing}}let a,o;for(a=i,o=s.length;a<o-1&&!Gl(s,a);a++);if(a!==i){let h;const v=a<o-1;v?h=`AAC PES did not start with ADTS header,offset:${a}`:h="No ADTS header found in AAC PES";const x=new Error(h);if(Ce.warn(`parsing error: ${h}`),this.observer.emit(W.ERROR,W.ERROR,{type:Ct.MEDIA_ERROR,details:je.FRAG_PARSING_ERROR,fatal:!1,levelRetry:v,error:x,reason:h}),!v)return}um(e,this.observer,s,a,this.audioCodec);let l;if(t.pts!==void 0)l=t.pts;else if(r){const h=dm(e.samplerate);l=r.sample.pts+h}else{Ce.warn("[tsdemuxer]: AAC PES unknown PTS");return}let u=0,d;for(;a<o;)if(d=cm(e,s,a,l,u),a+=d.length,d.missing){this.aacOverFlow=d;break}else for(u++;a<o-1&&!Gl(s,a);a++);}parseMPEGPES(e,t){const i=t.data,r=i.length;let s=0,a=0;const o=t.pts;if(o===void 0){Ce.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;a<r;)if(pm(i,a)){const l=hm(e,i,a,o,s);if(l)a+=l.length,s++;else break}else a++}parseID3PES(e,t){if(t.pts===void 0){Ce.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const i=Bi({},t,{type:this._avcTrack?nr.emsg:nr.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(i)}}function Hl(n,e,t,i){return{key:n,frame:!1,pts:e,dts:t,units:[],debug:i,length:0}}function Nc(n,e){return((n[e+1]&31)<<8)+n[e+2]}function Mx(n,e){return(n[e+10]&31)<<8|n[e+11]}function Nx(n,e,t,i){const r={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},s=(n[e+1]&15)<<8|n[e+2],a=e+3+s-4,o=(n[e+10]&15)<<8|n[e+11];for(e+=12+o;e<a;){const l=Nc(n,e);switch(n[e]){case 207:if(!i){Ce.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:r.audio===-1&&(r.audio=l);break;case 21:r.id3===-1&&(r.id3=l);break;case 219:if(!i){Ce.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:r.avc===-1&&(r.avc=l);break;case 3:case 4:t.mpeg!==!0&&t.mp3!==!0?Ce.log("MPEG audio found, not supported in this browser"):r.audio===-1&&(r.audio=l,r.segmentCodec="mp3");break;case 36:Ce.warn("Unsupported HEVC stream type found");break}e+=((n[e+3]&15)<<8|n[e+4])+5}return r}function Ca(n){let e=0,t,i,r,s,a;const o=n.data;if(!n||n.size===0)return null;for(;o[0].length<19&&o.length>1;){const u=new Uint8Array(o[0].length+o[1].length);u.set(o[0]),u.set(o[1],o[0].length),o[0]=u,o.splice(1,1)}if(t=o[0],(t[0]<<16)+(t[1]<<8)+t[2]===1){if(i=(t[4]<<8)+t[5],i&&i>n.size-6)return null;const u=t[7];u&192&&(s=(t[9]&14)*536870912+(t[10]&255)*4194304+(t[11]&254)*16384+(t[12]&255)*128+(t[13]&254)/2,u&64?(a=(t[14]&14)*536870912+(t[15]&255)*4194304+(t[16]&254)*16384+(t[17]&255)*128+(t[18]&254)/2,s-a>60*9e4&&(Ce.warn(`${Math.round((s-a)/9e4)}s delta between PTS and DTS, align them`),s=a)):a=s),r=t[8];let d=r+9;if(n.size<=d)return null;n.size-=d;const h=new Uint8Array(n.size);for(let v=0,x=o.length;v<x;v++){t=o[v];let _=t.byteLength;if(d)if(d>_){d-=_;continue}else t=t.subarray(d),_-=d,d=0;h.set(t,e),e+=_}return i&&(i-=r+3),{data:h,pts:s,dts:a,len:i}}return null}function go(n,e){if(n.units.length&&n.frame){if(n.pts===void 0){const t=e.samples,i=t.length;if(i){const r=t[i-1];n.pts=r.pts,n.dts=r.dts}else{e.dropped++;return}}e.samples.push(n)}n.debug.length&&Ce.log(n.pts+"/"+n.dts+":"+n.debug)}class Ux extends am{resetInitSegment(e,t,i,r){super.resetInitSegment(e,t,i,r),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let i=(Il(e,0)||[]).length;for(let r=e.length;i<r;i++)if(Bx(e,i))return Ce.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return Px(e,t)}appendFrame(e,t,i){if(this.basePTS!==null)return hm(e,t,i,this.basePTS,this.frameIndex)}}class gm{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const fs=Math.pow(2,32)-1;class Ie{static init(){Ie.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in Ie.types)Ie.types.hasOwnProperty(e)&&(Ie.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);Ie.HDLR_TYPES={video:t,audio:i};const r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),s=new Uint8Array([0,0,0,0,0,0,0,0]);Ie.STTS=Ie.STSC=Ie.STCO=s,Ie.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Ie.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Ie.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Ie.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const a=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);Ie.FTYP=Ie.box(Ie.types.ftyp,a,l,a,o),Ie.DINF=Ie.box(Ie.types.dinf,Ie.box(Ie.types.dref,r))}static box(e,...t){let i=8,r=t.length;const s=r;for(;r--;)i+=t[r].byteLength;const a=new Uint8Array(i);for(a[0]=i>>24&255,a[1]=i>>16&255,a[2]=i>>8&255,a[3]=i&255,a.set(e,4),r=0,i=8;r<s;r++)a.set(t[r],i),i+=t[r].byteLength;return a}static hdlr(e){return Ie.box(Ie.types.hdlr,Ie.HDLR_TYPES[e])}static mdat(e){return Ie.box(Ie.types.mdat,e)}static mdhd(e,t){t*=e;const i=Math.floor(t/(fs+1)),r=Math.floor(t%(fs+1));return Ie.box(Ie.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,i>>24,i>>16&255,i>>8&255,i&255,r>>24,r>>16&255,r>>8&255,r&255,85,196,0,0]))}static mdia(e){return Ie.box(Ie.types.mdia,Ie.mdhd(e.timescale,e.duration),Ie.hdlr(e.type),Ie.minf(e))}static mfhd(e){return Ie.box(Ie.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?Ie.box(Ie.types.minf,Ie.box(Ie.types.smhd,Ie.SMHD),Ie.DINF,Ie.stbl(e)):Ie.box(Ie.types.minf,Ie.box(Ie.types.vmhd,Ie.VMHD),Ie.DINF,Ie.stbl(e))}static moof(e,t,i){return Ie.box(Ie.types.moof,Ie.mfhd(e),Ie.traf(i,t))}static moov(e){let t=e.length;const i=[];for(;t--;)i[t]=Ie.trak(e[t]);return Ie.box.apply(null,[Ie.types.moov,Ie.mvhd(e[0].timescale,e[0].duration)].concat(i).concat(Ie.mvex(e)))}static mvex(e){let t=e.length;const i=[];for(;t--;)i[t]=Ie.trex(e[t]);return Ie.box.apply(null,[Ie.types.mvex,...i])}static mvhd(e,t){t*=e;const i=Math.floor(t/(fs+1)),r=Math.floor(t%(fs+1)),s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,i>>24,i>>16&255,i>>8&255,i&255,r>>24,r>>16&255,r>>8&255,r&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Ie.box(Ie.types.mvhd,s)}static sdtp(e){const t=e.samples||[],i=new Uint8Array(4+t.length);let r,s;for(r=0;r<t.length;r++)s=t[r].flags,i[r+4]=s.dependsOn<<4|s.isDependedOn<<2|s.hasRedundancy;return Ie.box(Ie.types.sdtp,i)}static stbl(e){return Ie.box(Ie.types.stbl,Ie.stsd(e),Ie.box(Ie.types.stts,Ie.STTS),Ie.box(Ie.types.stsc,Ie.STSC),Ie.box(Ie.types.stsz,Ie.STSZ),Ie.box(Ie.types.stco,Ie.STCO))}static avc1(e){let t=[],i=[],r,s,a;for(r=0;r<e.sps.length;r++)s=e.sps[r],a=s.byteLength,t.push(a>>>8&255),t.push(a&255),t=t.concat(Array.prototype.slice.call(s));for(r=0;r<e.pps.length;r++)s=e.pps[r],a=s.byteLength,i.push(a>>>8&255),i.push(a&255),i=i.concat(Array.prototype.slice.call(s));const o=Ie.box(Ie.types.avcC,new Uint8Array([1,t[3],t[4],t[5],252|3,224|e.sps.length].concat(t).concat([e.pps.length]).concat(i))),l=e.width,u=e.height,d=e.pixelRatio[0],h=e.pixelRatio[1];return Ie.box(Ie.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,l&255,u>>8&255,u&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,Ie.box(Ie.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Ie.box(Ie.types.pasp,new Uint8Array([d>>24,d>>16&255,d>>8&255,d&255,h>>24,h>>16&255,h>>8&255,h&255])))}static esds(e){const t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static mp4a(e){const t=e.samplerate;return Ie.box(Ie.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,t&255,0,0]),Ie.box(Ie.types.esds,Ie.esds(e)))}static mp3(e){const t=e.samplerate;return Ie.box(Ie.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,t&255,0,0]))}static stsd(e){return e.type==="audio"?e.segmentCodec==="mp3"&&e.codec==="mp3"?Ie.box(Ie.types.stsd,Ie.STSD,Ie.mp3(e)):Ie.box(Ie.types.stsd,Ie.STSD,Ie.mp4a(e)):Ie.box(Ie.types.stsd,Ie.STSD,Ie.avc1(e))}static tkhd(e){const t=e.id,i=e.duration*e.timescale,r=e.width,s=e.height,a=Math.floor(i/(fs+1)),o=Math.floor(i%(fs+1));return Ie.box(Ie.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,o>>24,o>>16&255,o>>8&255,o&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>8&255,r&255,0,0,s>>8&255,s&255,0,0]))}static traf(e,t){const i=Ie.sdtp(e),r=e.id,s=Math.floor(t/(fs+1)),a=Math.floor(t%(fs+1));return Ie.box(Ie.types.traf,Ie.box(Ie.types.tfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,r&255])),Ie.box(Ie.types.tfdt,new Uint8Array([1,0,0,0,s>>24,s>>16&255,s>>8&255,s&255,a>>24,a>>16&255,a>>8&255,a&255])),Ie.trun(e,i.length+16+20+8+16+8+8),i)}static trak(e){return e.duration=e.duration||4294967295,Ie.box(Ie.types.trak,Ie.tkhd(e),Ie.mdia(e))}static trex(e){const t=e.id;return Ie.box(Ie.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const i=e.samples||[],r=i.length,s=12+16*r,a=new Uint8Array(s);let o,l,u,d,h,v;for(t+=8+s,a.set([e.type==="video"?1:0,0,15,1,r>>>24&255,r>>>16&255,r>>>8&255,r&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),o=0;o<r;o++)l=i[o],u=l.duration,d=l.size,h=l.flags,v=l.cts,a.set([u>>>24&255,u>>>16&255,u>>>8&255,u&255,d>>>24&255,d>>>16&255,d>>>8&255,d&255,h.isLeading<<2|h.dependsOn,h.isDependedOn<<6|h.hasRedundancy<<4|h.paddingValue<<1|h.isNonSync,h.degradPrio&240<<8,h.degradPrio&15,v>>>24&255,v>>>16&255,v>>>8&255,v&255],12+16*o);return Ie.box(Ie.types.trun,a)}static initSegment(e){Ie.types||Ie.init();const t=Ie.moov(e),i=new Uint8Array(Ie.FTYP.byteLength+t.byteLength);return i.set(Ie.FTYP),i.set(t,Ie.FTYP.byteLength),i}}Ie.types=void 0,Ie.HDLR_TYPES=void 0,Ie.STTS=void 0,Ie.STSC=void 0,Ie.STCO=void 0,Ie.STSZ=void 0,Ie.VMHD=void 0,Ie.SMHD=void 0,Ie.STSD=void 0,Ie.FTYP=void 0,Ie.DINF=void 0;const ym=9e4;function Uc(n,e,t=1,i=!1){const r=n*e*t;return i?Math.round(r):r}function jx(n,e,t=1,i=!1){return Uc(n,e,1/t,i)}function yo(n,e=!1){return Uc(n,1e3,1/ym,e)}function $x(n,e=1){return Uc(n,ym,1/e)}const Gx=10*1e3,vm=1024,Vx=1152;let Wl=null,jc=null;class $c{constructor(e,t,i,r=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=e,this.config=t,this.typeSupported=i,this.ISGenerated=!1,Wl===null){const a=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Wl=a?parseInt(a[1]):0}if(jc===null){const s=navigator.userAgent.match(/Safari\/(\d+)/i);jc=s?parseInt(s[1]):0}}destroy(){}resetTimeStamp(e){Ce.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){Ce.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){Ce.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1}getVideoStartPts(e){let t=!1;const i=e.reduce((r,s)=>{const a=s.pts-r;return a<-4294967296?(t=!0,qn(r,s.pts)):a>0?r:s.pts},e[0].pts);return t&&Ce.debug("PTS rollover detected"),i}remux(e,t,i,r,s,a,o,l){let u,d,h,v,x,_,R=s,N=s;const z=e.pid>-1,J=t.pid>-1,ue=t.samples.length,pe=e.samples.length>0,te=o&&ue>0||ue>1;if((!z||pe)&&(!J||te)||this.ISGenerated||o){this.ISGenerated||(h=this.generateIS(e,t,s,a));const we=this.isVideoContiguous;let Ge=-1,Ve;if(te&&(Ge=Hx(t.samples),!we&&this.config.forceKeyFrameOnDiscontinuity))if(_=!0,Ge>0){Ce.warn(`[mp4-remuxer]: Dropped ${Ge} out of ${ue} video samples due to a missing keyframe`);const Fe=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(Ge),t.dropped+=Ge,N+=(t.samples[0].pts-Fe)/t.inputTimeScale,Ve=N}else Ge===-1&&(Ce.warn(`[mp4-remuxer]: No keyframe found out of ${ue} video samples`),_=!1);if(this.ISGenerated){if(pe&&te){const Fe=this.getVideoStartPts(t.samples),et=(qn(e.samples[0].pts,Fe)-Fe)/t.inputTimeScale;R+=Math.max(0,et),N+=Math.max(0,-et)}if(pe){if(e.samplerate||(Ce.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),h=this.generateIS(e,t,s,a)),d=this.remuxAudio(e,R,this.isAudioContiguous,a,J||te||l===Lt.AUDIO?N:void 0),te){const Fe=d?d.endPTS-d.startPTS:0;t.inputTimeScale||(Ce.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),h=this.generateIS(e,t,s,a)),u=this.remuxVideo(t,N,we,Fe)}}else te&&(u=this.remuxVideo(t,N,we,0));u&&(u.firstKeyFrame=Ge,u.independent=Ge!==-1,u.firstKeyFramePTS=Ve)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(i.samples.length&&(x=Am(i,s,this._initPTS,this._initDTS)),r.samples.length&&(v=bm(r,s,this._initPTS))),{audio:d,video:u,initSegment:h,independent:_,text:v,id3:x}}generateIS(e,t,i,r){const s=e.samples,a=t.samples,o=this.typeSupported,l={},u=this._initPTS;let d=!u||r,h="audio/mp4",v,x,_;if(d&&(v=x=Infinity),e.config&&s.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":o.mpeg?(h="audio/mpeg",e.codec=""):o.mp3&&(e.codec="mp3");break}l.audio={id:"audio",container:h,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&o.mpeg?new Uint8Array(0):Ie.initSegment([e]),metadata:{channelCount:e.channelCount}},d&&(_=e.inputTimeScale,!u||_!==u.timescale?v=x=s[0].pts-Math.round(_*i):d=!1)}if(t.sps&&t.pps&&a.length&&(t.timescale=t.inputTimeScale,l.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:Ie.initSegment([t]),metadata:{width:t.width,height:t.height}},d))if(_=t.inputTimeScale,!u||_!==u.timescale){const R=this.getVideoStartPts(a),N=Math.round(_*i);x=Math.min(x,qn(a[0].dts,R)-N),v=Math.min(v,R-N)}else d=!1;if(Object.keys(l).length)return this.ISGenerated=!0,d?(this._initPTS={baseTime:v,timescale:_},this._initDTS={baseTime:x,timescale:_}):v=_=void 0,{tracks:l,initPTS:v,timescale:_}}remuxVideo(e,t,i,r){const s=e.inputTimeScale,a=e.samples,o=[],l=a.length,u=this._initPTS;let d=this.nextAvcDts,h=8,v=this.videoSampleDuration,x,_,R=Number.POSITIVE_INFINITY,N=Number.NEGATIVE_INFINITY,z=!1;if(!i||d===null){const ft=t*s,bt=a[0].pts-qn(a[0].dts,a[0].pts);d=ft-bt}const J=u.baseTime*s/u.timescale;for(let ft=0;ft<l;ft++){const bt=a[ft];bt.pts=qn(bt.pts-J,d),bt.dts=qn(bt.dts-J,d),bt.dts<a[ft>0?ft-1:ft].dts&&(z=!0)}z&&a.sort(function(ft,bt){const Vt=ft.dts-bt.dts,zt=ft.pts-bt.pts;return Vt||zt}),x=a[0].dts,_=a[a.length-1].dts;const ue=_-x,pe=ue?Math.round(ue/(l-1)):v||e.inputTimeScale/30;if(i){const ft=x-d,bt=ft>pe,Vt=ft<-1;if((bt||Vt)&&(bt?Ce.warn(`AVC: ${yo(ft,!0)} ms (${ft}dts) hole between fragments detected, filling it`):Ce.warn(`AVC: ${yo(-ft,!0)} ms (${ft}dts) overlapping between fragments detected`),!Vt||d>=a[0].pts)){x=d;const zt=a[0].pts-ft;a[0].dts=x,a[0].pts=zt,Ce.log(`Video: First PTS/DTS adjusted: ${yo(zt,!0)}/${yo(x,!0)}, delta: ${yo(ft,!0)} ms`)}}x=Math.max(0,x);let te=0,ke=0;for(let ft=0;ft<l;ft++){const bt=a[ft],Vt=bt.units,zt=Vt.length;let jt=0;for(let vi=0;vi<zt;vi++)jt+=Vt[vi].data.length;ke+=jt,te+=zt,bt.length=jt,bt.dts=Math.max(bt.dts,x),R=Math.min(bt.pts,R),N=Math.max(bt.pts,N)}_=a[l-1].dts;const we=ke+4*te+8;let Ge;try{Ge=new Uint8Array(we)}catch(ft){this.observer.emit(W.ERROR,W.ERROR,{type:Ct.MUX_ERROR,details:je.REMUX_ALLOC_ERROR,fatal:!1,error:ft,bytes:we,reason:`fail allocating video mdat ${we}`});return}const Ve=new DataView(Ge.buffer);Ve.setUint32(0,we),Ge.set(Ie.types.mdat,4);let Fe=!1,mt=Number.POSITIVE_INFINITY,et=Number.POSITIVE_INFINITY,nt=Number.NEGATIVE_INFINITY,Pt=Number.NEGATIVE_INFINITY;for(let ft=0;ft<l;ft++){const bt=a[ft],Vt=bt.units;let zt=0;for(let ln=0,vn=Vt.length;ln<vn;ln++){const un=Vt[ln],Gr=un.data,vo=un.data.byteLength;Ve.setUint32(h,vo),h+=4,Ge.set(Gr,h),h+=vo,zt+=4+vo}let jt;if(ft<l-1)v=a[ft+1].dts-bt.dts,jt=a[ft+1].pts-bt.pts;else{const ln=this.config,vn=ft>0?bt.dts-a[ft-1].dts:pe;if(jt=ft>0?bt.pts-a[ft-1].pts:pe,ln.stretchShortVideoTrack&&this.nextAudioPts!==null){const un=Math.floor(ln.maxBufferHole*s),Gr=(r?R+r*s:this.nextAudioPts)-bt.pts;Gr>un?(v=Gr-vn,v<0?v=vn:Fe=!0,Ce.log(`[mp4-remuxer]: It is approximately ${Gr/90} ms to the next segment; using duration ${v/90} ms for the last video frame.`)):v=vn}else v=vn}const vi=Math.round(bt.pts-bt.dts);mt=Math.min(mt,v),nt=Math.max(nt,v),et=Math.min(et,jt),Pt=Math.max(Pt,jt),o.push(new _m(bt.key,v,zt,vi))}if(o.length){if(Wl){if(Wl<70){const ft=o[0].flags;ft.dependsOn=2,ft.isNonSync=0}}else if(jc&&Pt-et<nt-mt&&pe/nt<.025&&o[0].cts===0){Ce.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let ft=x;for(let bt=0,Vt=o.length;bt<Vt;bt++){const zt=ft+o[bt].duration,jt=ft+o[bt].cts;if(bt<Vt-1){const vi=zt+o[bt+1].cts;o[bt].duration=vi-jt}else o[bt].duration=bt?o[bt-1].duration:pe;o[bt].cts=0,ft=zt}}}v=Fe||!v?pe:v,this.nextAvcDts=d=_+v,this.videoSampleDuration=v,this.isVideoContiguous=!0;const Gt=Ie.moof(e.sequenceNumber++,x,Bi({},e,{samples:o})),Kt="video",qt={data1:Gt,data2:Ge,startPTS:R/s,endPTS:(N+v)/s,startDTS:x/s,endDTS:d/s,type:Kt,hasAudio:!1,hasVideo:!0,nb:o.length,dropped:e.dropped};return e.samples=[],e.dropped=0,qt}remuxAudio(e,t,i,r,s){const a=e.inputTimeScale,o=e.samplerate?e.samplerate:a,l=a/o,u=e.segmentCodec==="aac"?vm:Vx,d=u*l,h=this._initPTS,v=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,x=[],_=s!==void 0;let R=e.samples,N=v?0:8,z=this.nextAudioPts||-1;const J=t*a,ue=h.baseTime*a/h.timescale;if(this.isAudioContiguous=i=i||R.length&&z>0&&(r&&Math.abs(J-z)<9e3||Math.abs(qn(R[0].pts-ue,J)-z)<20*d),R.forEach(function(Kt){Kt.pts=qn(Kt.pts-ue,J)}),!i||z<0){if(R=R.filter(Kt=>Kt.pts>=0),!R.length)return;s===0?z=0:r&&!_?z=Math.max(0,J):z=R[0].pts}if(e.segmentCodec==="aac"){const Kt=this.config.maxAudioFramesDrift;for(let qt=0,ft=z;qt<R.length;qt++){const bt=R[qt],Vt=bt.pts,zt=Vt-ft,jt=Math.abs(1e3*zt/a);if(zt<=-Kt*d&&_)qt===0&&(Ce.warn(`Audio frame @ ${(Vt/a).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*zt/a)} ms.`),this.nextAudioPts=z=ft=Vt);else if(zt>=Kt*d&&jt<Gx&&_){let vi=Math.round(zt/d);ft=Vt-vi*d,ft<0&&(vi--,ft+=d),qt===0&&(this.nextAudioPts=z=ft),Ce.warn(`[mp4-remuxer]: Injecting ${vi} audio frame @ ${(ft/a).toFixed(3)}s due to ${Math.round(1e3*zt/a)} ms gap.`);for(let ln=0;ln<vi;ln++){const vn=Math.max(ft,0);let un=gm.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);un||(Ce.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),un=bt.unit.subarray()),R.splice(qt,0,{unit:un,pts:vn}),ft+=d,qt++}}bt.pts=ft,ft+=d}}let pe=null,te=null,ke,we=0,Ge=R.length;for(;Ge--;)we+=R[Ge].unit.byteLength;for(let Kt=0,qt=R.length;Kt<qt;Kt++){const ft=R[Kt],bt=ft.unit;let Vt=ft.pts;if(te!==null){const jt=x[Kt-1];jt.duration=Math.round((Vt-te)/l)}else if(i&&e.segmentCodec==="aac"&&(Vt=z),pe=Vt,we>0){we+=N;try{ke=new Uint8Array(we)}catch(jt){this.observer.emit(W.ERROR,W.ERROR,{type:Ct.MUX_ERROR,details:je.REMUX_ALLOC_ERROR,fatal:!1,error:jt,bytes:we,reason:`fail allocating audio mdat ${we}`});return}v||(new DataView(ke.buffer).setUint32(0,we),ke.set(Ie.types.mdat,4))}else return;ke.set(bt,N);const zt=bt.byteLength;N+=zt,x.push(new _m(!0,u,zt,0)),te=Vt}const Ve=x.length;if(!Ve)return;const Fe=x[x.length-1];this.nextAudioPts=z=te+l*Fe.duration;const mt=v?new Uint8Array(0):Ie.moof(e.sequenceNumber++,pe/l,Bi({},e,{samples:x}));e.samples=[];const et=pe/a,nt=z/a,Gt={data1:mt,data2:ke,startPTS:et,endPTS:nt,startDTS:et,endDTS:nt,type:"audio",hasAudio:!0,hasVideo:!1,nb:Ve};return this.isAudioContiguous=!0,Gt}remuxEmptyAudio(e,t,i,r){const s=e.inputTimeScale,a=e.samplerate?e.samplerate:s,o=s/a,l=this.nextAudioPts,u=this._initDTS,d=u.baseTime*9e4/u.timescale,h=(l!==null?l:r.startDTS*s)+d,v=r.endDTS*s+d,x=o*vm,_=Math.ceil((v-h)/x),R=gm.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(Ce.warn("[mp4-remuxer]: remux empty Audio"),!R){Ce.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}const N=[];for(let z=0;z<_;z++){const J=h+z*x;N.push({unit:R,pts:J,dts:J})}return e.samples=N,this.remuxAudio(e,t,i,!1)}}function qn(n,e){let t;if(e===null)return n;for(e<n?t=-8589934592:t=8589934592;Math.abs(n-e)>4294967296;)n+=t;return n}function Hx(n){for(let e=0;e<n.length;e++)if(n[e].key)return e;return-1}function Am(n,e,t,i){const r=n.samples.length;if(!r)return;const s=n.inputTimeScale;for(let o=0;o<r;o++){const l=n.samples[o];l.pts=qn(l.pts-t.baseTime*s/t.timescale,e*s)/s,l.dts=qn(l.dts-i.baseTime*s/i.timescale,e*s)/s}const a=n.samples;return n.samples=[],{samples:a}}function bm(n,e,t){const i=n.samples.length;if(!i)return;const r=n.inputTimeScale;for(let a=0;a<i;a++){const o=n.samples[a];o.pts=qn(o.pts-t.baseTime*r/t.timescale,e*r)/r}n.samples.sort((a,o)=>a.pts-o.pts);const s=n.samples;return n.samples=[],{samples:s}}class _m{constructor(e,t,i,r){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=i,this.cts=r,this.flags=new Wx(e)}}class Wx{constructor(e){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=e?2:1,this.isNonSync=e?0:1}}class Kx{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,i,r){this.audioCodec=t,this.videoCodec=i,this.generateInitSegment(h_(e,r)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:i}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const r=this.initData=E0(e);t||(t=xm(r.audio,ai.AUDIO)),i||(i=xm(r.video,ai.VIDEO));const s={};r.audio&&r.video?s.audiovideo={container:"video/mp4",codec:t+","+i,initSegment:e,id:"main"}:r.audio?s.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:r.video?s.video={container:"video/mp4",codec:i,initSegment:e,id:"main"}:Ce.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=s}remux(e,t,i,r,s,a){var o,l;let{initPTS:u,lastEndTime:d}=this;const h={audio:void 0,video:void 0,text:r,id3:i,initSegment:void 0};xt(d)||(d=this.lastEndTime=s||0);const v=t.samples;if(!(v!=null&&v.length))return h;const x={initPTS:void 0,timescale:1};let _=this.initData;if((o=_)!=null&&o.length||(this.generateInitSegment(v),_=this.initData),!((l=_)!=null&&l.length))return Ce.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),h;this.emitInitSegment&&(x.tracks=this.initTracks,this.emitInitSegment=!1);const R=p_(v,_),N=f_(_,v),z=N===null?s:N;(qx(u,z,s,R)||x.timescale!==u.timescale&&a)&&(x.initPTS=z-s,u&&u.timescale===1&&Ce.warn(`Adjusting initPTS by ${x.initPTS-u.baseTime}`),this.initPTS=u={baseTime:x.initPTS,timescale:1});const J=e?z-u.baseTime/u.timescale:d,ue=J+R;g_(_,v,u.baseTime/u.timescale),R>0?this.lastEndTime=ue:(Ce.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const pe=!!_.audio,te=!!_.video;let ke="";pe&&(ke+="audio"),te&&(ke+="video");const we={data1:v,startPTS:J,startDTS:J,endPTS:ue,endDTS:ue,type:ke,hasAudio:pe,hasVideo:te,nb:1,dropped:0};return h.audio=we.type==="audio"?we:void 0,h.video=we.type!=="audio"?we:void 0,h.initSegment=x,h.id3=Am(i,s,u,u),r.samples.length&&(h.text=bm(r,s,u)),h}}function qx(n,e,t,i){if(n===null)return!0;const r=Math.max(i,1),s=e-n.baseTime/n.timescale;return Math.abs(s-t)>r}function xm(n,e){const t=n==null?void 0:n.codec;return t&&t.length>4?t:t==="hvc1"||t==="hev1"?"hvc1.1.6.L120.90":t==="av01"?"av01.0.04M.08":t==="avc1"||e===ai.VIDEO?"avc1.42e01e":"mp4a.40.5"}let Ur;try{Ur=self.performance.now.bind(self.performance)}catch(n){Ce.debug("Unable to use Performance API on this environment"),Ur=typeof self!="undefined"&&self.Date.now}const Gc=[{demux:Dx,remux:Kx},{demux:hs,remux:$c},{demux:wx,remux:$c},{demux:Ux,remux:$c}];class Em{constructor(e,t,i,r,s){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=i,this.vendor=r,this.id=s}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,i,r){const s=i.transmuxing;s.executeStart=Ur();let a=new Uint8Array(e);const{currentTransmuxState:o,transmuxConfig:l}=this;r&&(this.currentTransmuxState=r);const{contiguous:u,discontinuity:d,trackSwitch:h,accurateTimeOffset:v,timeOffset:x,initSegmentChange:_}=r||o,{audioCodec:R,videoCodec:N,defaultInitPts:z,duration:J,initSegmentData:ue}=l,pe=zx(a,t);if(pe&&pe.method==="AES-128"){const Ge=this.getDecrypter();if(Ge.isSync()){let Ve=Ge.softwareDecrypt(a,pe.key.buffer,pe.iv.buffer);if(i.part>-1&&(Ve=Ge.flush()),!Ve)return s.executeEnd=Ur(),Vc(i);a=new Uint8Array(Ve)}else return this.decryptionPromise=Ge.webCryptoDecrypt(a,pe.key.buffer,pe.iv.buffer).then(Ve=>{const Fe=this.push(Ve,null,i);return this.decryptionPromise=null,Fe}),this.decryptionPromise}const te=this.needsProbing(d,h);if(te){const Ge=this.configureTransmuxer(a);if(Ge)return Ce.warn(`[transmuxer] ${Ge.message}`),this.observer.emit(W.ERROR,W.ERROR,{type:Ct.MEDIA_ERROR,details:je.FRAG_PARSING_ERROR,fatal:!1,error:Ge,reason:Ge.message}),s.executeEnd=Ur(),Vc(i)}(d||h||_||te)&&this.resetInitSegment(ue,R,N,J,t),(d||_||te)&&this.resetInitialTimestamp(z),u||this.resetContiguity();const ke=this.transmux(a,pe,x,v,i),we=this.currentTransmuxState;return we.contiguous=!0,we.discontinuity=!1,we.trackSwitch=!1,s.executeEnd=Ur(),ke}flush(e){const t=e.transmuxing;t.executeStart=Ur();const{decrypter:i,currentTransmuxState:r,decryptionPromise:s}=this;if(s)return s.then(()=>this.flush(e));const a=[],{timeOffset:o}=r;if(i){const h=i.flush();h&&a.push(this.push(h,null,e))}const{demuxer:l,remuxer:u}=this;if(!l||!u)return t.executeEnd=Ur(),[Vc(e)];const d=l.flush(o);return Kl(d)?d.then(h=>(this.flushRemux(a,h,e),a)):(this.flushRemux(a,d,e),a)}flushRemux(e,t,i){const{audioTrack:r,videoTrack:s,id3Track:a,textTrack:o}=t,{accurateTimeOffset:l,timeOffset:u}=this.currentTransmuxState;Ce.log(`[transmuxer.ts]: Flushed fragment ${i.sn}${i.part>-1?" p: "+i.part:""} of level ${i.level}`);const d=this.remuxer.remux(r,s,a,o,u,l,!0,this.id);e.push({remuxResult:d,chunkMeta:i}),i.transmuxing.executeEnd=Ur()}resetInitialTimestamp(e){const{demuxer:t,remuxer:i}=this;!t||!i||(t.resetTimeStamp(e),i.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,i,r,s){const{demuxer:a,remuxer:o}=this;!a||!o||(a.resetInitSegment(e,t,i,r),o.resetInitSegment(e,t,i,s))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,i,r,s){let a;return t&&t.method==="SAMPLE-AES"?a=this.transmuxSampleAes(e,t,i,r,s):a=this.transmuxUnencrypted(e,i,r,s),a}transmuxUnencrypted(e,t,i,r){const{audioTrack:s,videoTrack:a,id3Track:o,textTrack:l}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(s,a,o,l,t,i,!1,this.id),chunkMeta:r}}transmuxSampleAes(e,t,i,r,s){return this.demuxer.demuxSampleAes(e,t,i).then(a=>({remuxResult:this.remuxer.remux(a.audioTrack,a.videoTrack,a.id3Track,a.textTrack,i,r,!1,this.id),chunkMeta:s}))}configureTransmuxer(e){const{config:t,observer:i,typeSupported:r,vendor:s}=this;let a;for(let h=0,v=Gc.length;h<v;h++)if(Gc[h].demux.probe(e)){a=Gc[h];break}if(!a)return new Error("Failed to find demuxer by probing fragment data");const o=this.demuxer,l=this.remuxer,u=a.remux,d=a.demux;(!l||!(l instanceof u))&&(this.remuxer=new u(i,t,r,s)),(!o||!(o instanceof d))&&(this.demuxer=new d(i,t,r),this.probe=d.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Pc(this.config)),e}}function zx(n,e){let t=null;return n.byteLength>0&&e!=null&&e.key!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const Vc=n=>({remuxResult:{},chunkMeta:n});function Kl(n){return"then"in n&&n.then instanceof Function}class Yx{constructor(e,t,i,r,s){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=i,this.duration=r,this.defaultInitPts=s||null}}class Xx{constructor(e,t,i,r,s,a){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=i,this.trackSwitch=r,this.timeOffset=s,this.initSegmentChange=a}}var Tm={exports:{}};(function(n){var e=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function r(l,u,d){this.fn=l,this.context=u,this.once=d||!1}function s(l,u,d,h,v){if(typeof d!="function")throw new TypeError("The listener must be a function");var x=new r(d,h||l,v),_=t?t+u:u;return l._events[_]?l._events[_].fn?l._events[_]=[l._events[_],x]:l._events[_].push(x):(l._events[_]=x,l._eventsCount++),l}function a(l,u){--l._eventsCount==0?l._events=new i:delete l._events[u]}function o(){this._events=new i,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],d,h;if(this._eventsCount===0)return u;for(h in d=this._events)e.call(d,h)&&u.push(t?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},o.prototype.listeners=function(u){var d=t?t+u:u,h=this._events[d];if(!h)return[];if(h.fn)return[h.fn];for(var v=0,x=h.length,_=new Array(x);v<x;v++)_[v]=h[v].fn;return _},o.prototype.listenerCount=function(u){var d=t?t+u:u,h=this._events[d];return h?h.fn?1:h.length:0},o.prototype.emit=function(u,d,h,v,x,_){var R=t?t+u:u;if(!this._events[R])return!1;var N=this._events[R],z=arguments.length,J,ue;if(N.fn){switch(N.once&&this.removeListener(u,N.fn,void 0,!0),z){case 1:return N.fn.call(N.context),!0;case 2:return N.fn.call(N.context,d),!0;case 3:return N.fn.call(N.context,d,h),!0;case 4:return N.fn.call(N.context,d,h,v),!0;case 5:return N.fn.call(N.context,d,h,v,x),!0;case 6:return N.fn.call(N.context,d,h,v,x,_),!0}for(ue=1,J=new Array(z-1);ue<z;ue++)J[ue-1]=arguments[ue];N.fn.apply(N.context,J)}else{var pe=N.length,te;for(ue=0;ue<pe;ue++)switch(N[ue].once&&this.removeListener(u,N[ue].fn,void 0,!0),z){case 1:N[ue].fn.call(N[ue].context);break;case 2:N[ue].fn.call(N[ue].context,d);break;case 3:N[ue].fn.call(N[ue].context,d,h);break;case 4:N[ue].fn.call(N[ue].context,d,h,v);break;default:if(!J)for(te=1,J=new Array(z-1);te<z;te++)J[te-1]=arguments[te];N[ue].fn.apply(N[ue].context,J)}}return!0},o.prototype.on=function(u,d,h){return s(this,u,d,h,!1)},o.prototype.once=function(u,d,h){return s(this,u,d,h,!0)},o.prototype.removeListener=function(u,d,h,v){var x=t?t+u:u;if(!this._events[x])return this;if(!d)return a(this,x),this;var _=this._events[x];if(_.fn)_.fn===d&&(!v||_.once)&&(!h||_.context===h)&&a(this,x);else{for(var R=0,N=[],z=_.length;R<z;R++)(_[R].fn!==d||v&&!_[R].once||h&&_[R].context!==h)&&N.push(_[R]);N.length?this._events[x]=N.length===1?N[0]:N:a(this,x)}return this},o.prototype.removeAllListeners=function(u){var d;return u?(d=t?t+u:u,this._events[d]&&a(this,d)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=t,o.EventEmitter=o,n.exports=o})(Tm);var Qx=Tm.exports,Hc=Fb(Qx);const Wc=Bl()||{isTypeSupported:()=>!1};class Sm{constructor(e,t,i,r){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const s=e.config;this.hls=e,this.id=t,this.useWorker=!!s.enableWorker,this.onTransmuxComplete=i,this.onFlush=r;const a=(u,d)=>{d=d||{},d.frag=this.frag,d.id=this.id,u===W.ERROR&&(this.error=d.error),this.hls.trigger(u,d)};this.observer=new Hc,this.observer.on(W.FRAG_DECRYPTED,a),this.observer.on(W.ERROR,a);const o={mp4:Wc.isTypeSupported("video/mp4"),mpeg:Wc.isTypeSupported("audio/mpeg"),mp3:Wc.isTypeSupported('audio/mp4; codecs="mp3"')},l=navigator.vendor;if(this.useWorker&&typeof Worker!="undefined"&&(s.workerPath||vx())){try{s.workerPath?(Ce.log(`loading Web Worker ${s.workerPath} for "${t}"`),this.workerContext=bx(s.workerPath)):(Ce.log(`injecting Web Worker for "${t}"`),this.workerContext=Ax()),this.onwmsg=h=>this.onWorkerMessage(h);const{worker:d}=this.workerContext;d.addEventListener("message",this.onwmsg),d.onerror=h=>{const v=new Error(`${h.message}  (${h.filename}:${h.lineno})`);s.enableWorker=!1,Ce.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(W.ERROR,{type:Ct.OTHER_ERROR,details:je.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:v})},d.postMessage({cmd:"init",typeSupported:o,vendor:l,id:t,config:JSON.stringify(s)})}catch(d){Ce.warn(`Error setting up "${t}" Web Worker, fallback to inline`,d),this.resetWorker(),this.error=null,this.transmuxer=new Em(this.observer,o,s,l,t)}return}this.transmuxer=new Em(this.observer,o,s,l,t)}resetWorker(){if(this.workerContext){const{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,i,r,s,a,o,l,u,d){var h,v;u.transmuxing.start=self.performance.now();const{transmuxer:x}=this,_=a?a.start:s.start,R=s.decryptdata,N=this.frag,z=!(N&&s.cc===N.cc),J=!(N&&u.level===N.level),ue=N?u.sn-N.sn:-1,pe=this.part?u.part-this.part.index:-1,te=ue===0&&u.id>1&&u.id===(N==null?void 0:N.stats.chunkCount),ke=!J&&(ue===1||ue===0&&(pe===1||te&&pe<=0)),we=self.performance.now();(J||ue||s.stats.parsing.start===0)&&(s.stats.parsing.start=we),a&&(pe||!ke)&&(a.stats.parsing.start=we);const Ge=!(N&&((h=s.initSegment)==null?void 0:h.url)===((v=N.initSegment)==null?void 0:v.url)),Ve=new Xx(z,ke,l,J,_,Ge);if(!ke||z||Ge){Ce.log(`[transmuxer-interface, ${s.type}]: Starting new transmux session for sn: ${u.sn} p: ${u.part} level: ${u.level} id: ${u.id}
        discontinuity: ${z}
        trackSwitch: ${J}
        contiguous: ${ke}
        accurateTimeOffset: ${l}
        timeOffset: ${_}
        initSegmentChange: ${Ge}`);const Fe=new Yx(i,r,t,o,d);this.configureTransmuxer(Fe)}if(this.frag=s,this.part=a,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:R,chunkMeta:u,state:Ve},e instanceof ArrayBuffer?[e]:[]);else if(x){const Fe=x.push(e,R,u,Ve);Kl(Fe)?(x.async=!0,Fe.then(mt=>{this.handleTransmuxComplete(mt)}).catch(mt=>{this.transmuxerError(mt,u,"transmuxer-interface push error")})):(x.async=!1,this.handleTransmuxComplete(Fe))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let i=t.flush(e);Kl(i)||t.async?(Kl(i)||(i=Promise.resolve(i)),i.then(s=>{this.handleFlushResult(s,e)}).catch(s=>{this.transmuxerError(s,e,"transmuxer-interface flush error")})):this.handleFlushResult(i,e)}}transmuxerError(e,t,i){!this.hls||(this.error=e,this.hls.trigger(W.ERROR,{type:Ct.MEDIA_ERROR,details:je.FRAG_PARSING_ERROR,chunkMeta:t,fatal:!1,error:e,err:e,reason:i}))}handleFlushResult(e,t){e.forEach(i=>{this.handleTransmuxComplete(i)}),this.onFlush(t)}onWorkerMessage(e){const t=e.data,i=this.hls;switch(t.event){case"init":{var r;const s=(r=this.workerContext)==null?void 0:r.objectURL;s&&self.URL.revokeObjectURL(s);break}case"transmuxComplete":{this.handleTransmuxComplete(t.data);break}case"flush":{this.onFlush(t.data);break}case"workerLog":Ce[t.data.logType]&&Ce[t.data.logType](t.data.message);break;default:{t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,i.trigger(t.event,t.data);break}}}configureTransmuxer(e){const{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const Zx=250,Kc=2,Jx=.1,eE=.05;class tE{constructor(e,t,i,r){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=i,this.hls=r}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){const{config:i,media:r,stalled:s}=this;if(r===null)return;const{currentTime:a,seeking:o}=r,l=this.seeking&&!o,u=!this.seeking&&o;if(this.seeking=o,a!==e){if(this.moved=!0,s!==null){if(this.stallReported){const z=self.performance.now()-s;Ce.warn(`playback not stuck anymore @${a}, after ${Math.round(z)}ms`),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if(u||l){this.stalled=null;return}if(r.paused&&!o||r.ended||r.playbackRate===0||!pi.getBuffered(r).length)return;const d=pi.bufferInfo(r,a,0),h=d.len>0,v=d.nextStart||0;if(!h&&!v)return;if(o){const z=d.len>Kc,J=!v||t&&t.start<=a||v-a>Kc&&!this.fragmentTracker.getPartialFragment(a);if(z||J)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var x;const z=Math.max(v,d.start||0)-a,J=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,pe=(J==null||(x=J.details)==null?void 0:x.live)?J.details.targetduration*2:Kc,te=this.fragmentTracker.getPartialFragment(a);if(z>0&&(z<=pe||te)){this._trySkipBufferHole(te);return}}const _=self.performance.now();if(s===null){this.stalled=_;return}const R=_-s;if(!o&&R>=Zx&&(this._reportStall(d),!this.media))return;const N=pi.bufferInfo(r,a,i.maxBufferHole);this._tryFixBufferStall(N,R)}_tryFixBufferStall(e,t){const{config:i,fragmentTracker:r,media:s}=this;if(s===null)return;const a=s.currentTime,o=r.getPartialFragment(a);o&&(this._trySkipBufferHole(o)||!this.media)||(e.len>i.maxBufferHole||e.nextStart&&e.nextStart-a<i.maxBufferHole)&&t>i.highBufferWatchdogPeriod*1e3&&(Ce.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:t,media:i,stallReported:r}=this;if(!r&&i){this.stallReported=!0;const s=new Error(`Playback stalling at @${i.currentTime} due to low buffer (${JSON.stringify(e)})`);Ce.warn(s.message),t.trigger(W.ERROR,{type:Ct.MEDIA_ERROR,details:je.BUFFER_STALLED_ERROR,fatal:!1,error:s,buffer:e.len})}}_trySkipBufferHole(e){const{config:t,hls:i,media:r}=this;if(r===null)return 0;const s=r.currentTime,a=pi.bufferInfo(r,s,0),o=s<a.start?a.start:a.nextStart;if(o){const l=a.len<=t.maxBufferHole,u=a.len>0&&a.len<1&&r.readyState<3,d=o-s;if(d>0&&(l||u)){if(d>t.maxBufferHole){const{fragmentTracker:v}=this;let x=!1;if(s===0){const _=v.getAppendedFrag(0,Lt.MAIN);_&&o<_.end&&(x=!0)}if(!x){const _=e||v.getAppendedFrag(s,Lt.MAIN);if(_){let R=!1,N=_.end;for(;N<o;){const z=v.getPartialFragment(N);if(z)N+=z.duration;else{R=!0;break}}if(R)return 0}}}const h=Math.max(o+eE,s+Jx);if(Ce.warn(`skipping hole, adjusting currentTime from ${s} to ${h}`),this.moved=!0,this.stalled=null,r.currentTime=h,e&&!e.gap){const v=new Error(`fragment loaded with buffer holes, seeking from ${s} to ${h}`);i.trigger(W.ERROR,{type:Ct.MEDIA_ERROR,details:je.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:v,reason:v.message,frag:e})}return h}}return 0}_tryNudgeBuffer(){const{config:e,hls:t,media:i,nudgeRetry:r}=this;if(i===null)return;const s=i.currentTime;if(this.nudgeRetry++,r<e.nudgeMaxRetry){const a=s+(r+1)*e.nudgeOffset,o=new Error(`Nudging 'currentTime' from ${s} to ${a}`);Ce.warn(o.message),i.currentTime=a,t.trigger(W.ERROR,{type:Ct.MEDIA_ERROR,details:je.BUFFER_NUDGE_ON_STALL,error:o,fatal:!1})}else{const a=new Error(`Playhead still not moving while enough data buffered @${s} after ${e.nudgeMaxRetry} nudges`);Ce.error(a.message),t.trigger(W.ERROR,{type:Ct.MEDIA_ERROR,details:je.BUFFER_STALLED_ERROR,error:a,fatal:!0})}}}const iE=100;class nE extends Bc{constructor(e,t,i){super(e,t,i,"[stream-controller]",Lt.MAIN);this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(W.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(W.MANIFEST_LOADING,this.onManifestLoading,this),e.on(W.MANIFEST_PARSED,this.onManifestParsed,this),e.on(W.LEVEL_LOADING,this.onLevelLoading,this),e.on(W.LEVEL_LOADED,this.onLevelLoaded,this),e.on(W.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(W.ERROR,this.onError,this),e.on(W.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(W.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(W.BUFFER_CREATED,this.onBufferCreated,this),e.on(W.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(W.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(W.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(W.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(W.MANIFEST_LOADING,this.onManifestLoading,this),e.off(W.MANIFEST_PARSED,this.onManifestParsed,this),e.off(W.LEVEL_LOADED,this.onLevelLoaded,this),e.off(W.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(W.ERROR,this.onError,this),e.off(W.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(W.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(W.BUFFER_CREATED,this.onBufferCreated,this),e.off(W.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(W.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(W.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),this.onMediaDetaching()}startLoad(e){if(this.levels){const{lastCurrentTime:t,hls:i}=this;if(this.stopLoad(),this.setInterval(iE),this.level=-1,!this.startFragRequested){let r=i.startLevel;r===-1&&(i.config.testBandwidth&&this.levels.length>1?(r=0,this.bitrateTest=!0):r=i.nextAutoLevel),this.level=i.nextLoadLevel=r,this.loadedmetadata=!1}t>0&&e===-1&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=Ke.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=Ke.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case Ke.WAITING_LEVEL:{var e;const{levels:i,level:r}=this,s=i==null||(e=i[r])==null?void 0:e.details;if(s&&(!s.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(s))break;this.state=Ke.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=Ke.IDLE;break}break}case Ke.FRAG_LOADING_WAITING_RETRY:{var t;const i=self.performance.now(),r=this.retryDate;(!r||i>=r||(t=this.media)!=null&&t.seeking)&&(this.resetStartWhenNotLoaded(this.level),this.state=Ke.IDLE)}break}this.state===Ke.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:i,media:r}=this,{config:s,nextLoadLevel:a}=e;if(t===null||!r&&(this.startFragRequested||!s.startFragPrefetch)||this.altAudio&&this.audioOnly||!(i!=null&&i[a]))return;const o=i[a],l=this.getMainFwdBufferInfo();if(l===null)return;const u=this.getLevelDetails();if(u&&this._streamEnded(l,u)){const N={};this.altAudio&&(N.type="video"),this.hls.trigger(W.BUFFER_EOS,N),this.state=Ke.ENDED;return}e.loadLevel!==a&&e.manualLevel===-1&&this.log(`Adapting to level ${a} from level ${this.level}`),this.level=e.nextLoadLevel=a;const d=o.details;if(!d||this.state===Ke.WAITING_LEVEL||d.live&&this.levelLastLoaded!==a){this.level=a,this.state=Ke.WAITING_LEVEL;return}const h=l.len,v=this.getMaxBufferLength(o.maxBitrate);if(h>=v)return;this.backtrackFragment&&this.backtrackFragment.start>l.end&&(this.backtrackFragment=null);const x=this.backtrackFragment?this.backtrackFragment.start:l.end;let _=this.getNextFragment(x,d);if(this.couldBacktrack&&!this.fragPrevious&&_&&_.sn!=="initSegment"&&this.fragmentTracker.getState(_)!==$i.OK){var R;const z=((R=this.backtrackFragment)!=null?R:_).sn-d.startSN,J=d.fragments[z-1];J&&_.cc===J.cc&&(_=J,this.fragmentTracker.removeFragment(J))}else this.backtrackFragment&&l.len&&(this.backtrackFragment=null);if(_&&this.isLoopLoading(_,x)){if(!_.gap){const z=this.audioOnly&&!this.altAudio?ai.AUDIO:ai.VIDEO,J=(z===ai.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;J&&this.afterBufferFlushed(J,z,Lt.MAIN)}_=this.getNextFragmentLoopLoading(_,d,l,Lt.MAIN,v)}!_||(_.initSegment&&!_.initSegment.data&&!this.bitrateTest&&(_=_.initSegment),this.loadFragment(_,o,x))}loadFragment(e,t,i){const r=this.fragmentTracker.getState(e);this.fragCurrent=e,r===$i.NOT_LOADED||r===$i.PARTIAL?e.sn==="initSegment"?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,i)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,Lt.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let i;const r=this.getAppendedFrag(t.currentTime);r&&r.start>1&&this.flushMainBuffer(0,r.start-1);const s=this.getLevelDetails();if(s!=null&&s.live){const o=this.getMainFwdBufferInfo();if(!o||o.len<s.targetduration*2)return}if(!t.paused&&e){const o=this.hls.nextLoadLevel,l=e[o],u=this.fragLastKbps;u&&this.fragCurrent?i=this.fragCurrent.duration*l.maxBitrate/(1e3*u)+1:i=0}else i=0;const a=this.getBufferedFrag(t.currentTime+i);if(a){const o=this.followingBufferedFrag(a);if(o){this.abortCurrentFrag();const l=o.maxStartPTS?o.maxStartPTS:o.start,u=o.duration,d=Math.max(a.end,l+Math.min(Math.max(u-this.config.maxFragLookUpTolerance,u*.5),u*.75));this.flushMainBuffer(d,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case Ke.KEY_LOADING:case Ke.FRAG_LOADING:case Ke.FRAG_LOADING_WAITING_RETRY:case Ke.PARSING:case Ke.PARSED:this.state=Ke.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const i=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),i.addEventListener("playing",this.onvplaying),i.addEventListener("seeked",this.onvseeked),this.gapController=new tE(this.config,i,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,t=e?e.currentTime:null;xt(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);const i=this.getMainFwdBufferInfo();if(i===null||i.len===0){this.warn(`Main forward buffer length on "seeked" event ${i?i.len:"empty"})`);return}this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(W.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.levels=this.fragPlaying=this.backtrackFragment=null,this.altAudio=this.audioOnly=!1}onManifestParsed(e,t){let i=!1,r=!1,s;t.levels.forEach(a=>{s=a.audioCodec,s&&(s.indexOf("mp4a.40.2")!==-1&&(i=!0),s.indexOf("mp4a.40.5")!==-1&&(r=!0))}),this.audioCodecSwitch=i&&r&&!yx(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:i}=this;if(!i||this.state!==Ke.IDLE)return;const r=i[t.level];(!r.details||r.details.live&&this.levelLastLoaded!==t.level||this.waitForCdnTuneIn(r.details))&&(this.state=Ke.WAITING_LEVEL)}onLevelLoaded(e,t){var i;const{levels:r}=this,s=t.level,a=t.details,o=a.totalduration;if(!r){this.warn(`Levels were reset while loading level ${s}`);return}this.log(`Level ${s} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""}, cc [${a.startCC}, ${a.endCC}] duration:${o}`);const l=r[s],u=this.fragCurrent;u&&(this.state===Ke.FRAG_LOADING||this.state===Ke.FRAG_LOADING_WAITING_RETRY)&&(u.level!==t.level||u.urlId!==l.urlId)&&u.loader&&this.abortCurrentFrag();let d=0;if(a.live||(i=l.details)!=null&&i.live){if(this.checkLiveUpdate(a),a.deltaUpdateFailed)return;d=this.alignPlaylists(a,l.details)}if(l.details=a,this.levelLastLoaded=s,this.hls.trigger(W.LEVEL_UPDATED,{details:a,level:s}),this.state===Ke.WAITING_LEVEL){if(this.waitForCdnTuneIn(a))return;this.state=Ke.IDLE}this.startFragRequested?a.live&&this.synchronizeToLiveEdge(a):this.setStartPosition(a,d),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:i,part:r,payload:s}=e,{levels:a}=this;if(!a){this.warn(`Levels were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);return}const o=a[i.level],l=o.details;if(!l){this.warn(`Dropping fragment ${i.sn} of level ${i.level} after level details were reset`),this.fragmentTracker.removeFragment(i);return}const u=o.videoCodec,d=l.PTSKnown||!l.live,h=(t=i.initSegment)==null?void 0:t.data,v=this._getAudioCodec(o),x=this.transmuxer=this.transmuxer||new Sm(this.hls,Lt.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),_=r?r.index:-1,R=_!==-1,N=new Rc(i.level,i.sn,i.stats.chunkCount,s.byteLength,_,R),z=this.initPTS[i.cc];x.push(s,h,v,u,i,r,l.totalduration,d,N,z)}onAudioTrackSwitching(e,t){const i=this.altAudio;if(!!!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const a=this.fragCurrent;a&&(this.log("Switching to main audio track, cancel main fragment load"),a.abortRequests(),this.fragmentTracker.removeFragment(a)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const s=this.hls;i&&(s.trigger(W.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),s.trigger(W.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const i=t.id,r=!!this.hls.audioTracks[i].url;if(r){const s=this.videoBuffer;s&&this.mediaBuffer!==s&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=s)}this.altAudio=r,this.tick()}onBufferCreated(e,t){const i=t.tracks;let r,s,a=!1;for(const o in i){const l=i[o];if(l.id==="main"){if(s=o,r=l,o==="video"){const u=i[o];u&&(this.videoBuffer=u.buffer)}}else a=!0}a&&r?(this.log(`Alternate track found, use ${s}.buffered to schedule main fragment loading`),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:i,part:r}=t;if(i&&i.type!==Lt.MAIN)return;if(this.fragContextChanged(i)){this.warn(`Fragment ${i.sn}${r?" p: "+r.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}`),this.state===Ke.PARSED&&(this.state=Ke.IDLE);return}const s=r?r.stats:i.stats;this.fragLastKbps=Math.round(8*s.total/(s.buffering.end-s.loading.first)),i.sn!=="initSegment"&&(this.fragPrevious=i),this.fragBufferedComplete(i,r)}onError(e,t){var i;if(t.fatal){this.state=Ke.ERROR;return}switch(t.details){case je.FRAG_GAP:case je.FRAG_PARSING_ERROR:case je.FRAG_DECRYPT_ERROR:case je.FRAG_LOAD_ERROR:case je.FRAG_LOAD_TIMEOUT:case je.KEY_LOAD_ERROR:case je.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Lt.MAIN,t);break;case je.LEVEL_LOAD_ERROR:case je.LEVEL_LOAD_TIMEOUT:case je.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===Ke.WAITING_LEVEL&&((i=t.context)==null?void 0:i.type)===Qt.LEVEL&&(this.state=Ke.IDLE);break;case je.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case je.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}checkBuffer(){const{media:e,gapController:t}=this;if(!(!e||!t||!e.readyState)){if(this.loadedmetadata||!pi.getBuffered(e).length){const i=this.state!==Ke.IDLE?this.fragCurrent:null;t.poll(this.lastCurrentTime,i)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=Ke.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==ai.AUDIO||this.audioOnly&&!this.altAudio){const i=(t===ai.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(i,t,Lt.MAIN)}}onLevelsUpdated(e,t){this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let i=this.startPosition;if(i>=0&&t<i){if(e.seeking){this.log(`could not seek to ${i}, already seeking at ${t}`);return}const r=pi.getBuffered(e),a=(r.length?r.start(0):0)-i;a>0&&(a<this.config.maxBufferHole||a<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${a} to match buffer start`),i+=a,this.startPosition=i),this.log(`seek to target start position ${i} from current time ${t}`),e.currentTime=i}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(i=>{const{hls:r}=this;if(!i||this.fragContextChanged(e))return;t.fragmentError=0,this.state=Ke.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const s=e.stats;s.parsing.start=s.parsing.end=s.buffering.start=s.buffering.end=self.performance.now(),r.trigger(W.FRAG_LOADED,i),e.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const i="main",{hls:r}=this,{remuxResult:s,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}const{frag:l,part:u,level:d}=o,{video:h,text:v,id3:x,initSegment:_}=s,{details:R}=d,N=this.altAudio?void 0:s.audio;if(this.fragContextChanged(l)){this.fragmentTracker.removeFragment(l);return}if(this.state=Ke.PARSING,_){if(_!=null&&_.tracks){const ue=l.initSegment||l;this._bufferInitSegment(d,_.tracks,ue,a),r.trigger(W.FRAG_PARSING_INIT_SEGMENT,{frag:ue,id:i,tracks:_.tracks})}const z=_.initPTS,J=_.timescale;xt(z)&&(this.initPTS[l.cc]={baseTime:z,timescale:J},r.trigger(W.INIT_PTS_FOUND,{frag:l,id:i,initPTS:z,timescale:J}))}if(h&&R&&l.sn!=="initSegment"){const z=R.fragments[l.sn-1-R.startSN],J=l.sn===R.startSN,ue=!z||l.cc>z.cc;if(s.independent!==!1){const{startPTS:pe,endPTS:te,startDTS:ke,endDTS:we}=h;if(u)u.elementaryStreams[h.type]={startPTS:pe,endPTS:te,startDTS:ke,endDTS:we};else if(h.firstKeyFrame&&h.independent&&a.id===1&&!ue&&(this.couldBacktrack=!0),h.dropped&&h.independent){const Ge=this.getMainFwdBufferInfo(),Ve=(Ge?Ge.end:this.getLoadPosition())+this.config.maxBufferHole,Fe=h.firstKeyFramePTS?h.firstKeyFramePTS:pe;if(!J&&Ve<Fe-this.config.maxBufferHole&&!ue){this.backtrack(l);return}else ue&&(l.gap=!0);l.setElementaryStreamInfo(h.type,l.start,te,l.start,we,!0)}l.setElementaryStreamInfo(h.type,pe,te,ke,we),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(h,l,u,a,J||ue)}else if(J||ue)l.gap=!0;else{this.backtrack(l);return}}if(N){const{startPTS:z,endPTS:J,startDTS:ue,endDTS:pe}=N;u&&(u.elementaryStreams[ai.AUDIO]={startPTS:z,endPTS:J,startDTS:ue,endDTS:pe}),l.setElementaryStreamInfo(ai.AUDIO,z,J,ue,pe),this.bufferFragmentData(N,l,u,a)}if(R&&x!=null&&(t=x.samples)!=null&&t.length){const z={id:i,frag:l,details:R,samples:x.samples};r.trigger(W.FRAG_PARSING_METADATA,z)}if(R&&v){const z={id:i,frag:l,details:R,samples:v.samples};r.trigger(W.FRAG_PARSING_USERDATA,z)}}_bufferInitSegment(e,t,i,r){if(this.state!==Ke.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:s,video:a,audiovideo:o}=t;if(s){let l=e.audioCodec;const u=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(l&&(l.indexOf("mp4a.40.5")!==-1?l="mp4a.40.2":l="mp4a.40.5"),s.metadata.channelCount!==1&&u.indexOf("firefox")===-1&&(l="mp4a.40.5")),u.indexOf("android")!==-1&&s.container!=="audio/mpeg"&&(l="mp4a.40.2",this.log(`Android: force audio codec to ${l}`)),e.audioCodec&&e.audioCodec!==l&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${l}"`),s.levelCodec=l,s.id="main",this.log(`Init audio buffer, container:${s.container}, codecs[selected/level/parsed]=[${l||""}/${e.audioCodec||""}/${s.codec}]`)}a&&(a.levelCodec=e.videoCodec,a.id="main",this.log(`Init video buffer, container:${a.container}, codecs[level/parsed]=[${e.videoCodec||""}/${a.codec}]`)),o&&this.log(`Init audiovideo buffer, container:${o.container}, codecs[level/parsed]=[${e.attrs.CODECS||""}/${o.codec}]`),this.hls.trigger(W.BUFFER_CODECS,t),Object.keys(t).forEach(l=>{const d=t[l].initSegment;d!=null&&d.byteLength&&this.hls.trigger(W.BUFFER_APPENDING,{type:l,data:d,frag:i,part:null,chunkMeta:r,parent:i.type})}),this.tick()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,Lt.MAIN)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=Ke.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const i=e.currentTime;if(pi.isBuffered(e,i)?t=this.getAppendedFrag(i):pi.isBuffered(e,i+.1)&&(t=this.getAppendedFrag(i+.1)),t){this.backtrackFragment=null;const r=this.fragPlaying,s=t.level;(!r||t.sn!==r.sn||r.level!==s||t.urlId!==r.urlId)&&(this.fragPlaying=t,this.hls.trigger(W.FRAG_CHANGED,{frag:t}),(!r||r.level!==s)&&this.hls.trigger(W.LEVEL_SWITCHED,{level:s}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const t=e.currentTime,i=this.currentFrag;if(i&&xt(t)&&xt(i.programDateTime)){const r=i.programDateTime+(t-i.start)*1e3;return new Date(r)}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class wa{constructor(e,t=0,i=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=i}sample(e,t){const i=Math.pow(this.alpha_,e);this.estimate_=t*(1-i)+i*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class rE{constructor(e,t,i,r=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new wa(e),this.fast_=new wa(t),this.defaultTTFB_=r,this.ttfb_=new wa(e)}update(e,t){const{slow_:i,fast_:r,ttfb_:s}=this;i.halfLife!==e&&(this.slow_=new wa(e,i.getEstimate(),i.getTotalWeight())),r.halfLife!==t&&(this.fast_=new wa(t,r.getEstimate(),r.getTotalWeight())),s.halfLife!==e&&(this.ttfb_=new wa(e,s.getEstimate(),s.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const i=8*t,r=e/1e3,s=i/r;this.fast_.sample(r,s),this.slow_.sample(r,s)}sampleTTFB(e){const t=e/1e3,i=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(i,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}class sE{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=-1,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=e;const t=e.config;this.bwEstimator=new rE(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate),this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(W.FRAG_LOADING,this.onFragLoading,this),e.on(W.FRAG_LOADED,this.onFragLoaded,this),e.on(W.FRAG_BUFFERED,this.onFragBuffered,this),e.on(W.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(W.LEVEL_LOADED,this.onLevelLoaded,this)}unregisterListeners(){const{hls:e}=this;e.off(W.FRAG_LOADING,this.onFragLoading,this),e.off(W.FRAG_LOADED,this.onFragLoaded,this),e.off(W.FRAG_BUFFERED,this.onFragBuffered,this),e.off(W.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(W.LEVEL_LOADED,this.onLevelLoaded,this)}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null}onFragLoading(e,t){var i;const r=t.frag;this.ignoreFragment(r)||(this.fragCurrent=r,this.partCurrent=(i=t.part)!=null?i:null,this.clearTimer(),this.timer=self.setInterval(this.onCheck,100))}onLevelSwitching(e,t){this.clearTimer()}getTimeToLoadFrag(e,t,i,r){const s=e+i/t,a=r?this.lastLevelLoadSec:0;return s+a}onLevelLoaded(e,t){const i=this.hls.config,{total:r,bwEstimate:s}=t.stats;xt(r)&&xt(s)&&(this.lastLevelLoadSec=8*r/s),t.details.live?this.bwEstimator.update(i.abrEwmaSlowLive,i.abrEwmaFastLive):this.bwEstimator.update(i.abrEwmaSlowVoD,i.abrEwmaFastVoD)}_abandonRulesCheck(){const{fragCurrent:e,partCurrent:t,hls:i}=this,{autoLevelEnabled:r,media:s}=i;if(!e||!s)return;const a=performance.now(),o=t?t.stats:e.stats,l=t?t.duration:e.duration,u=a-o.loading.start;if(o.aborted||o.loaded&&o.loaded===o.total||e.level===0){this.clearTimer(),this._nextAutoLevel=-1;return}if(!r||s.paused||!s.playbackRate||!s.readyState)return;const d=i.mainForwardBufferInfo;if(d===null)return;const h=this.bwEstimator.getEstimateTTFB(),v=Math.abs(s.playbackRate);if(u<=Math.max(h,1e3*(l/(v*2))))return;const x=d.len/v;if(x>=2*l/v)return;const _=o.loading.first?o.loading.first-o.loading.start:-1,R=o.loaded&&_>-1,N=this.bwEstimator.getEstimate(),{levels:z,minAutoLevel:J}=i,ue=z[e.level],pe=o.total||Math.max(o.loaded,Math.round(l*ue.maxBitrate/8));let te=u-_;te<1&&R&&(te=Math.min(u,o.loaded*8/N));const ke=R?o.loaded*1e3/te:0,we=ke?(pe-o.loaded)/ke:pe*8/N+h/1e3;if(we<=x)return;const Ge=ke?ke*8:N;let Ve=Number.POSITIVE_INFINITY,Fe;for(Fe=e.level-1;Fe>J;Fe--){const mt=z[Fe].maxBitrate;if(Ve=this.getTimeToLoadFrag(h/1e3,Ge,l*mt,!z[Fe].details),Ve<x)break}Ve>=we||Ve>l*10||(i.nextLoadLevel=Fe,R?this.bwEstimator.sample(u-Math.min(h,_),o.loaded):this.bwEstimator.sampleTTFB(u),this.clearTimer(),Ce.warn(`[abr] Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} is loading too slowly;
      Time to underbuffer: ${x.toFixed(3)} s
      Estimated load time for current fragment: ${we.toFixed(3)} s
      Estimated load time for down switch fragment: ${Ve.toFixed(3)} s
      TTFB estimate: ${_}
      Current BW estimate: ${xt(N)?(N/1024).toFixed(3):"Unknown"} Kb/s
      New BW estimate: ${(this.bwEstimator.getEstimate()/1024).toFixed(3)} Kb/s
      Aborting and switching to level ${Fe}`),e.loader&&(this.fragCurrent=this.partCurrent=null,e.abortRequests()),i.trigger(W.FRAG_LOAD_EMERGENCY_ABORTED,{frag:e,part:t,stats:o}))}onFragLoaded(e,{frag:t,part:i}){const r=i?i.stats:t.stats;if(t.type===Lt.MAIN&&this.bwEstimator.sampleTTFB(r.loading.first-r.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){const s=i?i.duration:t.duration,a=this.hls.levels[t.level],o=(a.loaded?a.loaded.bytes:0)+r.loaded,l=(a.loaded?a.loaded.duration:0)+s;a.loaded={bytes:o,duration:l},a.realBitrate=Math.round(8*o/l)}if(t.bitrateTest){const s={stats:r,frag:t,part:i,id:t.type};this.onFragBuffered(W.FRAG_BUFFERED,s),t.bitrateTest=!1}}}onFragBuffered(e,t){const{frag:i,part:r}=t,s=r!=null&&r.stats.loaded?r.stats:i.stats;if(s.aborted||this.ignoreFragment(i))return;const a=s.parsing.end-s.loading.start-Math.min(s.loading.first-s.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(a,s.loaded),s.bwEstimate=this.bwEstimator.getEstimate(),i.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==Lt.MAIN||e.sn==="initSegment"}clearTimer(){self.clearInterval(this.timer)}get nextAutoLevel(){const e=this._nextAutoLevel,t=this.bwEstimator;if(e!==-1&&!t.canEstimate())return e;let i=this.getNextABRAutoLevel();if(e!==-1){const r=this.hls.levels;if(r.length>Math.max(e,i)&&r[e].loadError<=r[i].loadError)return e}return e!==-1&&(i=Math.min(e,i)),i}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:i}=this,{maxAutoLevel:r,config:s,minAutoLevel:a,media:o}=i,l=t?t.duration:e?e.duration:0,u=o&&o.playbackRate!==0?Math.abs(o.playbackRate):1,d=this.bwEstimator?this.bwEstimator.getEstimate():s.abrEwmaDefaultEstimate,h=i.mainForwardBufferInfo,v=(h?h.len:0)/u;let x=this.findBestLevel(d,a,r,v,s.abrBandWidthFactor,s.abrBandWidthUpFactor);if(x>=0)return x;Ce.trace(`[abr] ${v?"rebuffering expected":"buffer is empty"}, finding optimal quality level`);let _=l?Math.min(l,s.maxStarvationDelay):s.maxStarvationDelay,R=s.abrBandWidthFactor,N=s.abrBandWidthUpFactor;if(!v){const z=this.bitrateTestDelay;z&&(_=(l?Math.min(l,s.maxLoadingDelay):s.maxLoadingDelay)-z,Ce.trace(`[abr] bitrate test took ${Math.round(1e3*z)}ms, set first fragment max fetchDuration to ${Math.round(1e3*_)} ms`),R=N=1)}return x=this.findBestLevel(d,a,r,v+_,R,N),Math.max(x,0)}findBestLevel(e,t,i,r,s,a){var o;const{fragCurrent:l,partCurrent:u,lastLoadedFragLevel:d}=this,{levels:h}=this.hls,v=h[d],x=!!(v!=null&&(o=v.details)!=null&&o.live),_=v==null?void 0:v.codecSet,R=u?u.duration:l?l.duration:0,N=this.bwEstimator.getEstimateTTFB()/1e3;let z=t,J=-1;for(let ue=i;ue>=t;ue--){const pe=h[ue];if(!pe||_&&pe.codecSet!==_){pe&&(z=Math.min(ue,z),J=Math.max(ue,J));continue}J!==-1&&Ce.trace(`[abr] Skipped level(s) ${z}-${J} with CODECS:"${h[J].attrs.CODECS}"; not compatible with "${v.attrs.CODECS}"`);const te=pe.details,ke=(u?te==null?void 0:te.partTarget:te==null?void 0:te.averagetargetduration)||R;let we;ue<=d?we=s*e:we=a*e;const Ge=h[ue].maxBitrate,Ve=this.getTimeToLoadFrag(N,we,Ge*ke,te===void 0);if(Ce.trace(`[abr] level:${ue} adjustedbw-bitrate:${Math.round(we-Ge)} avgDuration:${ke.toFixed(1)} maxFetchDuration:${r.toFixed(1)} fetchDuration:${Ve.toFixed(1)}`),we>Ge&&(Ve===0||!xt(Ve)||x&&!this.bitrateTestDelay||Ve<r))return ue}return-1}set nextAutoLevel(e){this._nextAutoLevel=e}}class Cm{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let i;if(e.length)e.length===1?i=e[0]:i=aE(e,t);else return new Uint8Array(0);return this.reset(),i}reset(){this.chunks.length=0,this.dataLength=0}}function aE(n,e){const t=new Uint8Array(e);let i=0;for(let r=0;r<n.length;r++){const s=n[r];t.set(s,i),i+=s.length}return t}const wm=100;class oE extends Bc{constructor(e,t,i){super(e,t,i,"[audio-stream-controller]",Lt.AUDIO);this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(W.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(W.MANIFEST_LOADING,this.onManifestLoading,this),e.on(W.LEVEL_LOADED,this.onLevelLoaded,this),e.on(W.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(W.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(W.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(W.ERROR,this.onError,this),e.on(W.BUFFER_RESET,this.onBufferReset,this),e.on(W.BUFFER_CREATED,this.onBufferCreated,this),e.on(W.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(W.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(W.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(W.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(W.MANIFEST_LOADING,this.onManifestLoading,this),e.off(W.LEVEL_LOADED,this.onLevelLoaded,this),e.off(W.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(W.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(W.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(W.ERROR,this.onError,this),e.off(W.BUFFER_RESET,this.onBufferReset,this),e.off(W.BUFFER_CREATED,this.onBufferCreated,this),e.off(W.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(W.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(W.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:i,initPTS:r,timescale:s}){if(i==="main"){const a=t.cc;this.initPTS[t.cc]={baseTime:r,timescale:s},this.log(`InitPTS for cc: ${a} found from main: ${r}`),this.videoTrackCC=a,this.state===Ke.WAITING_INIT_PTS&&this.tick()}}startLoad(e){if(!this.levels){this.startPosition=e,this.state=Ke.STOPPED;return}const t=this.lastCurrentTime;this.stopLoad(),this.setInterval(wm),t>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=Ke.IDLE):(this.loadedmetadata=!1,this.state=Ke.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case Ke.IDLE:this.doTickIdle();break;case Ke.WAITING_TRACK:{var e;const{levels:i,trackId:r}=this,s=i==null||(e=i[r])==null?void 0:e.details;if(s){if(this.waitForCdnTuneIn(s))break;this.state=Ke.WAITING_INIT_PTS}break}case Ke.FRAG_LOADING_WAITING_RETRY:{var t;const i=performance.now(),r=this.retryDate;(!r||i>=r||(t=this.media)!=null&&t.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=Ke.IDLE);break}case Ke.WAITING_INIT_PTS:{const i=this.waitingData;if(i){const{frag:r,part:s,cache:a,complete:o}=i;if(this.initPTS[r.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=Ke.FRAG_LOADING;const l=a.flush(),u={frag:r,part:s,payload:l,networkDetails:null};this._handleFragmentLoadProgress(u),o&&super._handleFragmentLoadComplete(u)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${r.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const l=this.getLoadPosition(),u=pi.bufferInfo(this.mediaBuffer,l,this.config.maxBufferHole);Dc(u.end,this.config.maxFragLookUpTolerance,r)<0&&(this.log(`Waiting fragment cc (${r.cc}) @ ${r.start} cancelled because another fragment at ${u.end} is needed`),this.clearWaitingFragment())}}else this.state=Ke.IDLE}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=Ke.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;!(e!=null&&e.readyState)||(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:t,media:i,trackId:r}=this,s=e.config;if(!(t!=null&&t[r])||!i&&(this.startFragRequested||!s.startFragPrefetch))return;const a=t[r],o=a.details;if(!o||o.live&&this.levelLastLoaded!==r||this.waitForCdnTuneIn(o)){this.state=Ke.WAITING_TRACK;return}const l=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&l&&(this.bufferFlushed=!1,this.afterBufferFlushed(l,ai.AUDIO,Lt.AUDIO));const u=this.getFwdBufferInfo(l,Lt.AUDIO);if(u===null)return;const{bufferedTrack:d,switchingTrack:h}=this;if(!h&&this._streamEnded(u,o)){e.trigger(W.BUFFER_EOS,{type:"audio"}),this.state=Ke.ENDED;return}const v=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,Lt.MAIN),x=u.len,_=this.getMaxBufferLength(v==null?void 0:v.len);if(x>=_&&!h)return;const N=o.fragments[0].start;let z=u.end;if(h&&i){const te=this.getLoadPosition();d&&h.attrs!==d.attrs&&(z=te),o.PTSKnown&&te<N&&(u.end>N||u.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),i.currentTime=N+.05)}let J=this.getNextFragment(z,o),ue=!1;if(J&&this.isLoopLoading(J,z)&&(ue=!!J.gap,J=this.getNextFragmentLoopLoading(J,o,u,Lt.MAIN,_)),!J){this.bufferFlushed=!0;return}const pe=v&&J.start>v.end+o.targetduration;if(pe||!(v!=null&&v.len)&&u.len){const te=this.getAppendedFrag(J.start,Lt.MAIN);if(te===null||(ue||(ue=!!te.gap||!!pe&&v.len===0),pe&&!ue||ue&&u.nextStart&&u.nextStart<te.end))return}this.loadFragment(J,a,z)}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(i=>new po(i))}onAudioTrackSwitching(e,t){const i=!!t.url;this.trackId=t.id;const{fragCurrent:r}=this;r&&(r.abortRequests(),this.removeUnbufferedFrags(r.start)),this.resetLoadingState(),i?this.setInterval(wm):this.resetTransmuxer(),i?(this.switchingTrack=t,this.state=Ke.IDLE):(this.switchingTrack=null,this.bufferedTrack=t,this.state=Ke.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(W.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var i;if(this.mainDetails==null){this.cachedTrackLoadedData=t;return}const{levels:r}=this,{details:s,id:a}=t;if(!r){this.warn(`Audio tracks were reset while loading level ${a}`);return}this.log(`Track ${a} loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""},duration:${s.totalduration}`);const o=r[a];let l=0;if(s.live||(i=o.details)!=null&&i.live){this.checkLiveUpdate(s);const u=this.mainDetails;if(s.deltaUpdateFailed||!u)return;!o.details&&s.hasProgramDateTime&&u.hasProgramDateTime?(rm(s,u),l=s.fragments[0].start):l=this.alignPlaylists(s,o.details)}o.details=s,this.levelLastLoaded=a,!this.startFragRequested&&(this.mainDetails||!s.live)&&this.setStartPosition(o.details,l),this.state===Ke.WAITING_TRACK&&!this.waitForCdnTuneIn(s)&&(this.state=Ke.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:i,part:r,payload:s}=e,{config:a,trackId:o,levels:l}=this;if(!l){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);return}const u=l[o];if(!u){this.warn("Audio track is undefined on fragment load progress");return}const d=u.details;if(!d){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(i.start);return}const h=a.defaultAudioCodec||u.audioCodec||"mp4a.40.2";let v=this.transmuxer;v||(v=this.transmuxer=new Sm(this.hls,Lt.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const x=this.initPTS[i.cc],_=(t=i.initSegment)==null?void 0:t.data;if(x!==void 0){const R=!1,N=r?r.index:-1,z=N!==-1,J=new Rc(i.level,i.sn,i.stats.chunkCount,s.byteLength,N,z);v.push(s,_,h,"",i,r,d.totalduration,R,J,x)}else{this.log(`Unknown video PTS for cc ${i.cc}, waiting for video PTS before demuxing audio frag ${i.sn} of [${d.startSN} ,${d.endSN}],track ${o}`);const{cache:R}=this.waitingData=this.waitingData||{frag:i,part:r,cache:new Cm,complete:!1};R.push(new Uint8Array(s)),this.waitingVideoCC=this.videoTrackCC,this.state=Ke.WAITING_INIT_PTS}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){const i=t.tracks.audio;i&&(this.mediaBuffer=i.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){const{frag:i,part:r}=t;if(i.type!==Lt.AUDIO){if(!this.loadedmetadata&&i.type===Lt.MAIN){const s=this.videoBuffer||this.media;s&&pi.getBuffered(s).length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(i)){this.warn(`Fragment ${i.sn}${r?" p: "+r.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(i.sn!=="initSegment"){this.fragPrevious=i;const s=this.switchingTrack;s&&(this.bufferedTrack=s,this.switchingTrack=null,this.hls.trigger(W.AUDIO_TRACK_SWITCHED,pn({},s)))}this.fragBufferedComplete(i,r)}onError(e,t){var i;if(t.fatal){this.state=Ke.ERROR;return}switch(t.details){case je.FRAG_GAP:case je.FRAG_PARSING_ERROR:case je.FRAG_DECRYPT_ERROR:case je.FRAG_LOAD_ERROR:case je.FRAG_LOAD_TIMEOUT:case je.KEY_LOAD_ERROR:case je.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Lt.AUDIO,t);break;case je.AUDIO_TRACK_LOAD_ERROR:case je.AUDIO_TRACK_LOAD_TIMEOUT:case je.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===Ke.WAITING_TRACK&&((i=t.context)==null?void 0:i.type)===Qt.AUDIO_TRACK&&(this.state=Ke.IDLE);break;case je.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case je.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushed(e,{type:t}){t===ai.AUDIO&&(this.bufferFlushed=!0,this.state===Ke.ENDED&&(this.state=Ke.IDLE))}_handleTransmuxComplete(e){var t;const i="audio",{hls:r}=this,{remuxResult:s,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}const{frag:l,part:u,level:d}=o,{details:h}=d,{audio:v,text:x,id3:_,initSegment:R}=s;if(this.fragContextChanged(l)||!h){this.fragmentTracker.removeFragment(l);return}if(this.state=Ke.PARSING,this.switchingTrack&&v&&this.completeAudioSwitch(this.switchingTrack),R!=null&&R.tracks){const N=l.initSegment||l;this._bufferInitSegment(R.tracks,N,a),r.trigger(W.FRAG_PARSING_INIT_SEGMENT,{frag:N,id:i,tracks:R.tracks})}if(v){const{startPTS:N,endPTS:z,startDTS:J,endDTS:ue}=v;u&&(u.elementaryStreams[ai.AUDIO]={startPTS:N,endPTS:z,startDTS:J,endDTS:ue}),l.setElementaryStreamInfo(ai.AUDIO,N,z,J,ue),this.bufferFragmentData(v,l,u,a)}if(_!=null&&(t=_.samples)!=null&&t.length){const N=Bi({id:i,frag:l,details:h},_);r.trigger(W.FRAG_PARSING_METADATA,N)}if(x){const N=Bi({id:i,frag:l,details:h},x);r.trigger(W.FRAG_PARSING_USERDATA,N)}}_bufferInitSegment(e,t,i){if(this.state!==Ke.PARSING)return;e.video&&delete e.video;const r=e.audio;if(!r)return;r.levelCodec=r.codec,r.id="audio",this.log(`Init audio buffer, container:${r.container}, codecs[parsed]=[${r.codec}]`),this.hls.trigger(W.BUFFER_CODECS,e);const s=r.initSegment;if(s!=null&&s.byteLength){const a={type:"audio",frag:t,part:null,chunkMeta:i,parent:t.type,data:s};this.hls.trigger(W.BUFFER_APPENDING,a)}this.tick()}loadFragment(e,t,i){const r=this.fragmentTracker.getState(e);if(this.fragCurrent=e,this.switchingTrack||r===$i.NOT_LOADED||r===$i.PARTIAL){var s;e.sn==="initSegment"?this._loadInitSegment(e,t):(s=t.details)!=null&&s.live&&!this.initPTS[e.cc]?(this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=Ke.WAITING_INIT_PTS):(this.startFragRequested=!0,super.loadFragment(e,t,i))}else this.clearTrackerIfNeeded(e)}completeAudioSwitch(e){const{hls:t,media:i,bufferedTrack:r}=this,s=r==null?void 0:r.attrs,a=e.attrs;i&&s&&(s.CHANNELS!==a.CHANNELS||s.NAME!==a.NAME||s.LANGUAGE!==a.LANGUAGE)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio")),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(W.AUDIO_TRACK_SWITCHED,pn({},e))}}class lE extends kc{constructor(e){super(e,"[audio-track-controller]");this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(W.MANIFEST_LOADING,this.onManifestLoading,this),e.on(W.MANIFEST_PARSED,this.onManifestParsed,this),e.on(W.LEVEL_LOADING,this.onLevelLoading,this),e.on(W.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(W.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(W.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(W.MANIFEST_LOADING,this.onManifestLoading,this),e.off(W.MANIFEST_PARSED,this.onManifestParsed,this),e.off(W.LEVEL_LOADING,this.onLevelLoading,this),e.off(W.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(W.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(W.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:i,groupId:r,details:s}=t,a=this.tracksInGroup[i];if(!a||a.groupId!==r){this.warn(`Track with id:${i} and group:${r} not found in active group ${a.groupId}`);return}const o=a.details;a.details=t.details,this.log(`audio-track ${i} "${a.name}" lang:${a.lang} group:${r} loaded [${s.startSN}-${s.endSN}]`),i===this.trackId&&this.playlistLoaded(i,t,o)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!(t!=null&&t.audioGroupIds))return;const i=t.audioGroupIds[t.urlId];if(this.groupId!==i){this.groupId=i||null;const r=this.tracks.filter(a=>!i||a.groupId===i);this.selectDefaultTrack&&!r.some(a=>a.default)&&(this.selectDefaultTrack=!1),this.tracksInGroup=r;const s={audioTracks:r};this.log(`Updating audio tracks, ${r.length} track(s) found in group:${i}`),this.hls.trigger(W.AUDIO_TRACKS_UPDATED,s),this.selectInitialTrack()}else this.shouldReloadPlaylist(this.currentTrack)&&this.setAudioTrack(this.trackId)}onError(e,t){t.fatal||!t.context||t.context.type===Qt.AUDIO_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&(this.requestScheduled=-1,this.checkRetry(t))}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();const i=this.currentTrack;t[this.trackId];const r=t[e],{groupId:s,name:a}=r;if(this.log(`Switching to audio-track ${e} "${a}" lang:${r.lang} group:${s}`),this.trackId=e,this.currentTrack=r,this.selectDefaultTrack=!1,this.hls.trigger(W.AUDIO_TRACK_SWITCHING,pn({},r)),r.details&&!r.details.live)return;const o=this.switchParams(r.url,i==null?void 0:i.details);this.loadPlaylist(o)}selectInitialTrack(){const e=this.tracksInGroup,t=this.findTrackId(this.currentTrack)|this.findTrackId(null);if(t!==-1)this.setAudioTrack(t);else{const i=new Error(`No track found for running audio group-ID: ${this.groupId} track count: ${e.length}`);this.warn(i.message),this.hls.trigger(W.ERROR,{type:Ct.MEDIA_ERROR,details:je.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:i})}}findTrackId(e){const t=this.tracksInGroup;for(let i=0;i<t.length;i++){const r=t[i];if((!this.selectDefaultTrack||r.default)&&(!e||e.attrs["STABLE-RENDITION-ID"]!==void 0&&e.attrs["STABLE-RENDITION-ID"]===r.attrs["STABLE-RENDITION-ID"]||e.name===r.name&&e.lang===r.lang))return r.id}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){const i=t.id,r=t.groupId;let s=t.url;if(e)try{s=e.addDirectives(s)}catch(a){this.warn(`Could not construct new URL with HLS Delivery Directives: ${a}`)}this.log(`loading audio-track playlist ${i} "${t.name}" lang:${t.lang} group:${r}`),this.clearTimer(),this.hls.trigger(W.AUDIO_TRACK_LOADING,{url:s,id:i,groupId:r,deliveryDirectives:e||null})}}}function Lm(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!uE(n[t].attrs,e[t].attrs))return!1;return!0}function uE(n,e){const t=n["STABLE-RENDITION-ID"];return t?t===e["STABLE-RENDITION-ID"]:!["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED"].some(i=>n[i]!==e[i])}const Dm=500;class dE extends Bc{constructor(e,t,i){super(e,t,i,"[subtitle-stream-controller]",Lt.SUBTITLE);this.levels=[],this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(W.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(W.MANIFEST_LOADING,this.onManifestLoading,this),e.on(W.LEVEL_LOADED,this.onLevelLoaded,this),e.on(W.ERROR,this.onError,this),e.on(W.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(W.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(W.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(W.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(W.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(W.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(W.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(W.MANIFEST_LOADING,this.onManifestLoading,this),e.off(W.LEVEL_LOADED,this.onLevelLoaded,this),e.off(W.ERROR,this.onError,this),e.off(W.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(W.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(W.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(W.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(W.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(W.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=Ke.IDLE,this.setInterval(Dm),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:i,success:r}=t;if(this.fragPrevious=i,this.state=Ke.IDLE,!r)return;const s=this.tracksBuffered[this.currentTrackId];if(!s)return;let a;const o=i.start;for(let u=0;u<s.length;u++)if(o>=s[u].start&&o<=s[u].end){a=s[u];break}const l=i.start+i.duration;a?a.end=l:(a={start:o,end:l},s.push(a)),this.fragmentTracker.fragBuffered(i)}onBufferFlushing(e,t){const{startOffset:i,endOffset:r}=t;if(i===0&&r!==Number.POSITIVE_INFINITY){const s=r-1;if(s<=0)return;t.endOffsetSubtitles=Math.max(0,s),this.tracksBuffered.forEach(a=>{for(let o=0;o<a.length;){if(a[o].end<=s){a.shift();continue}else if(a[o].start<s)a[o].start=s;else break;o++}}),this.fragmentTracker.removeFragmentsInRange(i,s,Lt.SUBTITLE)}}onFragBuffered(e,t){if(!this.loadedmetadata&&t.frag.type===Lt.MAIN){var i;(i=this.media)!=null&&i.buffered.length&&(this.loadedmetadata=!0)}}onError(e,t){const i=t.frag;(i==null?void 0:i.type)===Lt.SUBTITLE&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==Ke.STOPPED&&(this.state=Ke.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(Lm(this.levels,t)){this.levels=t.map(i=>new po(i));return}this.tracksBuffered=[],this.levels=t.map(i=>{const r=new po(i);return this.tracksBuffered[r.id]=[],r}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Lt.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){if(this.currentTrackId=t.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}const i=this.levels[this.currentTrackId];i!=null&&i.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,i&&this.setInterval(Dm)}onSubtitleTrackLoaded(e,t){var i;const{details:r,id:s}=t,{currentTrackId:a,levels:o}=this;if(!o.length)return;const l=o[a];if(s>=o.length||s!==a||!l)return;this.mediaBuffer=this.mediaBufferTimeRanges;let u=0;if(r.live||(i=l.details)!=null&&i.live){const d=this.mainDetails;if(r.deltaUpdateFailed||!d)return;const h=d.fragments[0];l.details?(u=this.alignPlaylists(r,l.details),u===0&&h&&(u=h.start,wc(r,u))):r.hasProgramDateTime&&d.hasProgramDateTime?(rm(r,d),u=r.fragments[0].start):h&&(u=h.start,wc(r,u))}l.details=r,this.levelLastLoaded=s,!this.startFragRequested&&(this.mainDetails||!r.live)&&this.setStartPosition(l.details,u),this.tick(),r.live&&!this.fragCurrent&&this.media&&this.state===Ke.IDLE&&(mo(null,r.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),l.details=void 0))}_handleFragmentLoadComplete(e){const{frag:t,payload:i}=e,r=t.decryptdata,s=this.hls;if(!this.fragContextChanged(t)&&i&&i.byteLength>0&&r&&r.key&&r.iv&&r.method==="AES-128"){const a=performance.now();this.decrypter.decrypt(new Uint8Array(i),r.key.buffer,r.iv.buffer).catch(o=>{throw s.trigger(W.ERROR,{type:Ct.MEDIA_ERROR,details:je.FRAG_DECRYPT_ERROR,fatal:!1,error:o,reason:o.message,frag:t}),o}).then(o=>{const l=performance.now();s.trigger(W.FRAG_DECRYPTED,{frag:t,payload:o,stats:{tstart:a,tdecrypt:l}})}).catch(o=>{this.warn(`${o.name}: ${o.message}`),this.state=Ke.IDLE})}}doTick(){if(!this.media){this.state=Ke.IDLE;return}if(this.state===Ke.IDLE){const{currentTrackId:e,levels:t}=this,i=t[e];if(!t.length||!i||!i.details)return;const{config:r}=this,s=this.getLoadPosition(),a=pi.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],s,r.maxBufferHole),{end:o,len:l}=a,u=this.getFwdBufferInfo(this.media,Lt.MAIN),d=i.details,h=this.getMaxBufferLength(u==null?void 0:u.len)+d.levelTargetDuration;if(l>h)return;const v=d.fragments,x=v.length,_=d.edge;let R=null;const N=this.fragPrevious;if(o<_){const z=r.maxFragLookUpTolerance,J=o>_-z?0:z;R=mo(N,v,Math.max(v[0].start,o),J),!R&&N&&N.start<v[0].start&&(R=v[0])}else R=v[x-1];if(!R)return;if(R=this.mapToInitFragWhenRequired(R),R.sn!=="initSegment"){const z=R.sn-d.startSN,J=v[z-1];J&&J.cc===R.cc&&this.fragmentTracker.getState(J)===$i.NOT_LOADED&&(R=J)}this.fragmentTracker.getState(R)===$i.NOT_LOADED&&this.loadFragment(R,i,o)}}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,i){this.fragCurrent=e,e.sn==="initSegment"?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,i))}get mediaBufferTimeRanges(){return new cE(this.tracksBuffered[this.currentTrackId]||[])}}class cE{constructor(e){this.buffered=void 0;const t=(i,r,s)=>{if(r=r>>>0,r>s-1)throw new DOMException(`Failed to execute '${i}' on 'TimeRanges': The index provided (${r}) is greater than the maximum bound (${s})`);return e[r][i]};this.buffered={get length(){return e.length},end(i){return t("end",i,e.length)},start(i){return t("start",i,e.length)}}}}class hE extends kc{constructor(e){super(e,"[subtitle-track-controller]");this.media=null,this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.trackChangeListener=()=>this.onTextTracksChanged(),this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes(this.trackId)}registerListeners(){const{hls:e}=this;e.on(W.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(W.MANIFEST_LOADING,this.onManifestLoading,this),e.on(W.MANIFEST_PARSED,this.onManifestParsed,this),e.on(W.LEVEL_LOADING,this.onLevelLoading,this),e.on(W.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(W.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(W.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(W.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(W.MANIFEST_LOADING,this.onManifestLoading,this),e.off(W.MANIFEST_PARSED,this.onManifestParsed,this),e.off(W.LEVEL_LOADING,this.onLevelLoading,this),e.off(W.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(W.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(W.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,!!this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),qc(this.media.textTracks).forEach(t=>{Ta(t)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:i,details:r}=t,{trackId:s}=this,a=this.tracksInGroup[s];if(!a){this.warn(`Invalid subtitle track id ${i}`);return}const o=a.details;a.details=t.details,this.log(`subtitle track ${i} loaded [${r.startSN}-${r.endSN}]`),i===this.trackId&&this.playlistLoaded(i,t,o)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!(t!=null&&t.textGroupIds))return;const i=t.textGroupIds[t.urlId],r=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;if(this.groupId!==i){const s=this.tracks.filter(l=>!i||l.groupId===i);this.tracksInGroup=s;const a=this.findTrackId(r==null?void 0:r.name)||this.findTrackId();this.groupId=i||null;const o={subtitleTracks:s};this.log(`Updating subtitle tracks, ${s.length} track(s) found in "${i}" group-id`),this.hls.trigger(W.SUBTITLE_TRACKS_UPDATED,o),a!==-1&&this.setSubtitleTrack(a,r)}else this.shouldReloadPlaylist(r)&&this.setSubtitleTrack(this.trackId,r)}findTrackId(e){const t=this.tracksInGroup;for(let i=0;i<t.length;i++){const r=t[i];if((!this.selectDefaultTrack||r.default)&&(!e||e===r.name))return r.id}return-1}onError(e,t){t.fatal||!t.context||t.context.type===Qt.SUBTITLE_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&this.checkRetry(t)}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1;const t=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(e,t)}loadPlaylist(e){super.loadPlaylist();const t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){const i=t.id,r=t.groupId;let s=t.url;if(e)try{s=e.addDirectives(s)}catch(a){this.warn(`Could not construct new URL with HLS Delivery Directives: ${a}`)}this.log(`Loading subtitle playlist for id ${i}`),this.hls.trigger(W.SUBTITLE_TRACK_LOADING,{url:s,id:i,groupId:r,deliveryDirectives:e||null})}}toggleTrackModes(e){const{media:t,trackId:i}=this;if(!t)return;const r=qc(t.textTracks),s=r.filter(o=>o.groupId===this.groupId);if(e===-1)[].slice.call(r).forEach(o=>{o.mode="disabled"});else{const o=s[i];o&&(o.mode="disabled")}const a=s[e];a&&(a.mode=this.subtitleDisplay?"showing":"hidden")}setSubtitleTrack(e,t){var i;const r=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(this.trackId!==e&&this.toggleTrackModes(e),this.trackId===e&&(e===-1||(i=r[e])!=null&&i.details)||e<-1||e>=r.length)return;this.clearTimer();const s=r[e];if(this.log(`Switching to subtitle-track ${e}`+(s?` "${s.name}" lang:${s.lang} group:${s.groupId}`:"")),this.trackId=e,s){const{id:a,groupId:o="",name:l,type:u,url:d}=s;this.hls.trigger(W.SUBTITLE_TRACK_SWITCH,{id:a,groupId:o,name:l,type:u,url:d});const h=this.switchParams(s.url,t==null?void 0:t.details);this.loadPlaylist(h)}else this.hls.trigger(W.SUBTITLE_TRACK_SWITCH,{id:e})}onTextTracksChanged(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=-1;const t=qc(this.media.textTracks);for(let i=0;i<t.length;i++)if(t[i].mode==="hidden")e=i;else if(t[i].mode==="showing"){e=i;break}this.subtitleTrack!==e&&(this.subtitleTrack=e)}}function qc(n){const e=[];for(let t=0;t<n.length;t++){const i=n[t];(i.kind==="subtitles"||i.kind==="captions")&&i.label&&e.push(n[t])}return e}class fE{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t){const i=this.queues[t];i.push(e),i.length===1&&this.buffers[t]&&this.executeNext(t)}insertAbort(e,t){this.queues[t].unshift(e),this.executeNext(t)}appendBlocker(e){let t;const i=new Promise(s=>{t=s}),r={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(r,e),i}executeNext(e){const{buffers:t,queues:i}=this,r=t[e],s=i[e];if(s.length){const a=s[0];try{a.execute()}catch(o){Ce.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),a.onError(o),r!=null&&r.updating||(s.shift(),this.executeNext(e))}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}const km=Bl(),Im=/([ha]vc.)(?:\.[^.,]+)+/;class pE{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=()=>{const{media:t,mediaSource:i}=this;Ce.log("[buffer-controller]: Media source opened"),t&&(t.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(W.MEDIA_ATTACHED,{media:t})),i&&i.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{Ce.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=()=>{Ce.log("[buffer-controller]: Media source ended")},this._onMediaEmptied=()=>{const{media:t,_objectUrl:i}=this;t&&t.src!==i&&Ce.error(`Media element src was set while attaching MediaSource (${i} > ${t.src})`)},this.hls=e,this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null}registerListeners(){const{hls:e}=this;e.on(W.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(W.MANIFEST_LOADING,this.onManifestLoading,this),e.on(W.MANIFEST_PARSED,this.onManifestParsed,this),e.on(W.BUFFER_RESET,this.onBufferReset,this),e.on(W.BUFFER_APPENDING,this.onBufferAppending,this),e.on(W.BUFFER_CODECS,this.onBufferCodecs,this),e.on(W.BUFFER_EOS,this.onBufferEos,this),e.on(W.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(W.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(W.FRAG_PARSED,this.onFragParsed,this),e.on(W.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(W.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(W.MANIFEST_LOADING,this.onManifestLoading,this),e.off(W.MANIFEST_PARSED,this.onManifestParsed,this),e.off(W.BUFFER_RESET,this.onBufferReset,this),e.off(W.BUFFER_APPENDING,this.onBufferAppending,this),e.off(W.BUFFER_CODECS,this.onBufferCodecs,this),e.off(W.BUFFER_EOS,this.onBufferEos,this),e.off(W.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(W.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(W.FRAG_PARSED,this.onFragParsed,this),e.off(W.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new fE(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let i=2;(t.audio&&!t.video||!t.altAudio)&&(i=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=i,Ce.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){const i=this.media=t.media;if(i&&km){const r=this.mediaSource=new km;r.addEventListener("sourceopen",this._onMediaSourceOpen),r.addEventListener("sourceended",this._onMediaSourceEnded),r.addEventListener("sourceclose",this._onMediaSourceClose),i.src=self.URL.createObjectURL(r),this._objectUrl=i.src,i.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:t,_objectUrl:i}=this;if(t){if(Ce.log("[buffer-controller]: media source detaching"),t.readyState==="open")try{t.endOfStream()}catch(r){Ce.warn(`[buffer-controller]: onMediaDetaching: ${r.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),e&&(e.removeEventListener("emptied",this._onMediaEmptied),i&&self.URL.revokeObjectURL(i),e.src===i?(e.removeAttribute("src"),e.load()):Ce.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(W.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(e=>{const t=this.sourceBuffer[e];try{t&&(this.removeBufferListeners(e),this.mediaSource&&this.mediaSource.removeSourceBuffer(t),this.sourceBuffer[e]=void 0)}catch(i){Ce.warn(`[buffer-controller]: Failed to reset the ${e} buffer`,i)}}),this._initSourceBuffer()}onBufferCodecs(e,t){const i=this.getSourceBufferTypes().length;Object.keys(t).forEach(r=>{if(i){const s=this.tracks[r];if(s&&typeof s.buffer.changeType=="function"){const{id:a,codec:o,levelCodec:l,container:u,metadata:d}=t[r],h=(s.levelCodec||s.codec).replace(Im,"$1"),v=(l||o).replace(Im,"$1");if(h!==v){const x=`${u};codecs=${l||o}`;this.appendChangeType(r,x),Ce.log(`[buffer-controller]: switching codec ${h} to ${v}`),this.tracks[r]={buffer:s.buffer,codec:o,container:u,levelCodec:l,metadata:d,id:a}}}}else this.pendingTracks[r]=t[r]}),!i&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())}appendChangeType(e,t){const{operationQueue:i}=this,r={execute:()=>{const s=this.sourceBuffer[e];s&&(Ce.log(`[buffer-controller]: changing ${e} sourceBuffer type to ${t}`),s.changeType(t)),i.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:s=>{Ce.warn(`[buffer-controller]: Failed to change ${e} SourceBuffer type`,s)}};i.append(r,e)}onBufferAppending(e,t){const{hls:i,operationQueue:r,tracks:s}=this,{data:a,type:o,frag:l,part:u,chunkMeta:d}=t,h=d.buffering[o],v=self.performance.now();h.start=v;const x=l.stats.buffering,_=u?u.stats.buffering:null;x.start===0&&(x.start=v),_&&_.start===0&&(_.start=v);const R=s.audio;let N=!1;o==="audio"&&(R==null?void 0:R.container)==="audio/mpeg"&&(N=!this.lastMpegAudioChunk||d.id===1||this.lastMpegAudioChunk.sn!==d.sn,this.lastMpegAudioChunk=d);const z=l.start,J={execute:()=>{if(h.executeStart=self.performance.now(),N){const ue=this.sourceBuffer[o];if(ue){const pe=z-ue.timestampOffset;Math.abs(pe)>=.1&&(Ce.log(`[buffer-controller]: Updating audio SourceBuffer timestampOffset to ${z} (delta: ${pe}) sn: ${l.sn})`),ue.timestampOffset=z)}}this.appendExecutor(a,o)},onStart:()=>{},onComplete:()=>{const ue=self.performance.now();h.executeEnd=h.end=ue,x.first===0&&(x.first=ue),_&&_.first===0&&(_.first=ue);const{sourceBuffer:pe}=this,te={};for(const ke in pe)te[ke]=pi.getBuffered(pe[ke]);this.appendError=0,this.hls.trigger(W.BUFFER_APPENDED,{type:o,frag:l,part:u,chunkMeta:d,parent:l.type,timeRanges:te})},onError:ue=>{Ce.error(`[buffer-controller]: Error encountered while trying to append to the ${o} SourceBuffer`,ue);const pe={type:Ct.MEDIA_ERROR,parent:l.type,details:je.BUFFER_APPEND_ERROR,frag:l,part:u,chunkMeta:d,error:ue,err:ue,fatal:!1};ue.code===DOMException.QUOTA_EXCEEDED_ERR?pe.details=je.BUFFER_FULL_ERROR:(this.appendError++,pe.details=je.BUFFER_APPEND_ERROR,this.appendError>i.config.appendErrorMaxRetry&&(Ce.error(`[buffer-controller]: Failed ${i.config.appendErrorMaxRetry} times to append segment in sourceBuffer`),pe.fatal=!0)),i.trigger(W.ERROR,pe)}};r.append(J,o)}onBufferFlushing(e,t){const{operationQueue:i}=this,r=s=>({execute:this.removeExecutor.bind(this,s,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(W.BUFFER_FLUSHED,{type:s})},onError:a=>{Ce.warn(`[buffer-controller]: Failed to remove from ${s} SourceBuffer`,a)}});t.type?i.append(r(t.type),t.type):this.getSourceBufferTypes().forEach(s=>{i.append(r(s),s)})}onFragParsed(e,t){const{frag:i,part:r}=t,s=[],a=r?r.elementaryStreams:i.elementaryStreams;a[ai.AUDIOVIDEO]?s.push("audiovideo"):(a[ai.AUDIO]&&s.push("audio"),a[ai.VIDEO]&&s.push("video"));const o=()=>{const l=self.performance.now();i.stats.buffering.end=l,r&&(r.stats.buffering.end=l);const u=r?r.stats:i.stats;this.hls.trigger(W.FRAG_BUFFERED,{frag:i,part:r,stats:u,id:i.type})};s.length===0&&Ce.warn(`Fragments must have at least one ElementaryStreamType set. type: ${i.type} level: ${i.level} sn: ${i.sn}`),this.blockBuffers(o,s)}onFragChanged(e,t){this.flushBackBuffer()}onBufferEos(e,t){this.getSourceBufferTypes().reduce((r,s)=>{const a=this.sourceBuffer[s];return a&&(!t.type||t.type===s)&&(a.ending=!0,a.ended||(a.ended=!0,Ce.log(`[buffer-controller]: ${s} sourceBuffer now EOS`))),r&&!!(!a||a.ended)},!0)&&(Ce.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(s=>{const a=this.sourceBuffer[s];a&&(a.ending=!1)});const{mediaSource:r}=this;if(!r||r.readyState!=="open"){r&&Ce.info(`[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: ${r.readyState}`);return}Ce.log("[buffer-controller]: Calling mediaSource.endOfStream()"),r.endOfStream()}))}onLevelUpdated(e,{details:t}){!t.fragments.length||(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}flushBackBuffer(){const{hls:e,details:t,media:i,sourceBuffer:r}=this;if(!i||t===null)return;const s=this.getSourceBufferTypes();if(!s.length)return;const a=t.live&&e.config.liveBackBufferLength!==null?e.config.liveBackBufferLength:e.config.backBufferLength;if(!xt(a)||a<0)return;const o=i.currentTime,l=t.levelTargetDuration,u=Math.max(a,l),d=Math.floor(o/l)*l-u;s.forEach(h=>{const v=r[h];if(v){const x=pi.getBuffered(v);if(x.length>0&&d>x.start(0)){if(e.trigger(W.BACK_BUFFER_REACHED,{bufferEnd:d}),t.live)e.trigger(W.LIVE_BACK_BUFFER_REACHED,{bufferEnd:d});else if(v.ended&&x.end(x.length-1)-o<l*2){Ce.info(`[buffer-controller]: Cannot flush ${h} back buffer while SourceBuffer is in ended state`);return}e.trigger(W.BUFFER_FLUSHING,{startOffset:0,endOffset:d,type:h})}}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")return;const{details:e,hls:t,media:i,mediaSource:r}=this,s=e.fragments[0].start+e.totalduration,a=i.duration,o=xt(r.duration)?r.duration:0;e.live&&t.config.liveDurationInfinity?(Ce.log("[buffer-controller]: Media Source duration is set to Infinity"),r.duration=Infinity,this.updateSeekableRange(e)):(s>o&&s>a||!xt(a))&&(Ce.log(`[buffer-controller]: Updating Media Source duration to ${s.toFixed(3)}`),r.duration=s)}updateSeekableRange(e){const t=this.mediaSource,i=e.fragments;if(i.length&&e.live&&t!=null&&t.setLiveSeekableRange){const s=Math.max(0,i[0].start),a=Math.max(s,s+e.totalduration);t.setLiveSeekableRange(s,a)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:i}=this,r=Object.keys(i).length;if(r&&!e||r===2){this.createSourceBuffers(i),this.pendingTracks={};const s=this.getSourceBufferTypes();if(s.length)this.hls.trigger(W.BUFFER_CREATED,{tracks:this.tracks}),s.forEach(a=>{t.executeNext(a)});else{const a=new Error("could not create source buffer for media codec(s)");this.hls.trigger(W.ERROR,{type:Ct.MEDIA_ERROR,details:je.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:a,reason:a.message})}}}createSourceBuffers(e){const{sourceBuffer:t,mediaSource:i}=this;if(!i)throw Error("createSourceBuffers called when mediaSource was null");for(const r in e)if(!t[r]){const s=e[r];if(!s)throw Error(`source buffer exists for track ${r}, however track does not`);const a=s.levelCodec||s.codec,o=`${s.container};codecs=${a}`;Ce.log(`[buffer-controller]: creating sourceBuffer(${o})`);try{const l=t[r]=i.addSourceBuffer(o),u=r;this.addBufferListener(u,"updatestart",this._onSBUpdateStart),this.addBufferListener(u,"updateend",this._onSBUpdateEnd),this.addBufferListener(u,"error",this._onSBUpdateError),this.tracks[r]={buffer:l,codec:a,container:s.container,levelCodec:s.levelCodec,metadata:s.metadata,id:s.id}}catch(l){Ce.error(`[buffer-controller]: error while trying to add sourceBuffer: ${l.message}`),this.hls.trigger(W.ERROR,{type:Ct.MEDIA_ERROR,details:je.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:l,mimeType:o})}}}_onSBUpdateStart(e){const{operationQueue:t}=this;t.current(e).onStart()}_onSBUpdateEnd(e){const{operationQueue:t}=this;t.current(e).onComplete(),t.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){const i=new Error(`${e} SourceBuffer error`);Ce.error(`[buffer-controller]: ${i}`,t),this.hls.trigger(W.ERROR,{type:Ct.MEDIA_ERROR,details:je.BUFFER_APPENDING_ERROR,error:i,fatal:!1});const r=this.operationQueue.current(e);r&&r.onError(t)}removeExecutor(e,t,i){const{media:r,mediaSource:s,operationQueue:a,sourceBuffer:o}=this,l=o[e];if(!r||!s||!l){Ce.warn(`[buffer-controller]: Attempting to remove from the ${e} SourceBuffer, but it does not exist`),a.shiftAndExecuteNext(e);return}const u=xt(r.duration)?r.duration:Infinity,d=xt(s.duration)?s.duration:Infinity,h=Math.max(0,t),v=Math.min(i,u,d);v>h&&!l.ending?(l.ended=!1,Ce.log(`[buffer-controller]: Removing [${h},${v}] from the ${e} SourceBuffer`),l.remove(h,v)):a.shiftAndExecuteNext(e)}appendExecutor(e,t){const{operationQueue:i,sourceBuffer:r}=this,s=r[t];if(!s){Ce.warn(`[buffer-controller]: Attempting to append to the ${t} SourceBuffer, but it does not exist`),i.shiftAndExecuteNext(t);return}s.ended=!1,s.appendBuffer(e)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length){Ce.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);return}const{operationQueue:i}=this,r=t.map(s=>i.appendBlocker(s));Promise.all(r).then(()=>{e(),t.forEach(s=>{const a=this.sourceBuffer[s];a!=null&&a.updating||i.shiftAndExecuteNext(s)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,i){const r=this.sourceBuffer[e];if(!r)return;const s=i.bind(this,e);this.listeners[e].push({event:t,listener:s}),r.addEventListener(t,s)}removeBufferListeners(e){const t=this.sourceBuffer[e];!t||this.listeners[e].forEach(i=>{t.removeEventListener(i.event,i.listener)})}}const Rm={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Om=function(e){let t=e;return Rm.hasOwnProperty(e)&&(t=Rm[e]),String.fromCharCode(t)},rr=15,jr=100,mE={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},gE={17:2,18:4,21:6,22:8,23:10,19:13,20:15},yE={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},vE={25:2,26:4,29:6,30:8,31:10,27:13,28:15},AE=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class bE{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const i=typeof t=="function"?t():t;Ce.log(`${this.time} [${e}] ${i}`)}}}const Ms=function(e){const t=[];for(let i=0;i<e.length;i++)t.push(e[i].toString(16));return t};class Pm{constructor(e,t,i,r,s){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||"white",this.underline=t||!1,this.italics=i||!1,this.background=r||"black",this.flash=s||!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let i=0;i<t.length;i++){const r=t[i];e.hasOwnProperty(r)&&(this[r]=e[r])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class _E{constructor(e,t,i,r,s,a){this.uchar=void 0,this.penState=void 0,this.uchar=e||" ",this.penState=new Pm(t,i,r,s,a)}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class xE{constructor(e){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(let t=0;t<jr;t++)this.chars.push(new _E);this.logger=e,this.pos=0,this.currPenState=new Pm}equals(e){let t=!0;for(let i=0;i<jr;i++)if(!this.chars[i].equals(e.chars[i])){t=!1;break}return t}copy(e){for(let t=0;t<jr;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<jr;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>jr&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=jr)}moveCursor(e){const t=this.pos+e;if(e>1)for(let i=this.pos+1;i<t+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=Om(e);if(this.pos>=jr){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<jr;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let i=0;i<jr;i++){const r=this.chars[i].uchar;r!==" "&&(t=!1),e.push(r)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class zc{constructor(e){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(let t=0;t<rr;t++)this.rows.push(new xE(e));this.logger=e,this.currRow=rr-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}reset(){for(let e=0;e<rr;e++)this.rows[e].clear();this.currRow=rr-1}equals(e){let t=!0;for(let i=0;i<rr;i++)if(!this.rows[i].equals(e.rows[i])){t=!1;break}return t}copy(e){for(let t=0;t<rr;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<rr;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+JSON.stringify(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let o=0;o<rr;o++)this.rows[o].clear();const s=this.currRow+1-this.nrRollUpRows,a=this.lastOutputScreen;if(a){const o=a.rows[s].cueStartTime,l=this.logger.time;if(o&&l!==null&&o<l)for(let u=0;u<this.nrRollUpRows;u++)this.rows[t-this.nrRollUpRows+u+1].copy(a.rows[s+u])}}this.currRow=t;const i=this.rows[this.currRow];if(e.indent!==null){const s=e.indent,a=Math.max(s-1,0);i.setCursor(e.indent),e.color=i.chars[a].penState.foreground}const r={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(r)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let i="",r=-1;for(let s=0;s<rr;s++){const a=this.rows[s].getTextString();a&&(r=s+1,e?t.push("Row "+r+": '"+a+"'"):t.push(a.trim()))}return t.length>0&&(e?i="["+t.join(" | ")+"]":i=t.join(`
`)),i}getTextAndFormat(){return this.rows}}class Bm{constructor(e,t,i){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new zc(i),this.nonDisplayedMemory=new zc(i),this.lastOutputScreen=new zc(i),this.currRollUpRow=this.displayedMemory.rows[rr-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=i}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[rr-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let i=0;i<e.length;i++)this.writeScreen.insertChar(e[i]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{const i=Math.floor(e/2)-16,r=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=r[i]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class Fm{constructor(e,t,i){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;const r=new bE;this.channels=[null,new Bm(e,t,r),new Bm(e+1,i,r)],this.cmdHistory=Nm(),this.logger=r}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){let i,r,s,a=!1;this.logger.time=e;for(let o=0;o<t.length;o+=2)if(r=t[o]&127,s=t[o+1]&127,!(r===0&&s===0)){if(this.logger.log(3,"["+Ms([t[o],t[o+1]])+"] -> ("+Ms([r,s])+")"),i=this.parseCmd(r,s),i||(i=this.parseMidrow(r,s)),i||(i=this.parsePAC(r,s)),i||(i=this.parseBackgroundAttributes(r,s)),!i&&(a=this.parseChars(r,s),a)){const l=this.currentChannel;l&&l>0?this.channels[l].insertChars(a):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!i&&!a&&this.logger.log(2,"Couldn't parse cleaned data "+Ms([r,s])+" orig: "+Ms([t[o],t[o+1]]))}}parseCmd(e,t){const{cmdHistory:i}=this,r=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,s=(e===23||e===31)&&t>=33&&t<=35;if(!(r||s))return!1;if(Mm(e,t,i))return La(null,null,i),this.logger.log(3,"Repeated command ("+Ms([e,t])+") is dropped"),!0;const a=e===20||e===21||e===23?1:2,o=this.channels[a];return e===20||e===21||e===28||e===29?t===32?o.ccRCL():t===33?o.ccBS():t===34?o.ccAOF():t===35?o.ccAON():t===36?o.ccDER():t===37?o.ccRU(2):t===38?o.ccRU(3):t===39?o.ccRU(4):t===40?o.ccFON():t===41?o.ccRDC():t===42?o.ccTR():t===43?o.ccRTD():t===44?o.ccEDM():t===45?o.ccCR():t===46?o.ccENM():t===47&&o.ccEOC():o.ccTO(t-32),La(e,t,i),this.currentChannel=a,!0}parseMidrow(e,t){let i=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?i=1:i=2,i!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const r=this.channels[i];return r?(r.ccMIDROW(t),this.logger.log(3,"MIDROW ("+Ms([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let i;const r=this.cmdHistory,s=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,a=(e===16||e===24)&&t>=64&&t<=95;if(!(s||a))return!1;if(Mm(e,t,r))return La(null,null,r),!0;const o=e<=23?1:2;t>=64&&t<=95?i=o===1?mE[e]:yE[e]:i=o===1?gE[e]:vE[e];const l=this.channels[o];return l?(l.setPAC(this.interpretPAC(i,t)),La(e,t,r),this.currentChannel=o,!0):!1}interpretPAC(e,t){let i;const r={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?i=t-96:i=t-64,r.underline=(i&1)==1,i<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(r.italics=!0,r.color="white"):r.indent=Math.floor((i-16)/2)*4,r}parseChars(e,t){let i,r=null,s=null;if(e>=25?(i=2,s=e-8):(i=1,s=e),s>=17&&s<=19){let a;s===17?a=t+80:s===18?a=t+112:a=t+144,this.logger.log(2,"Special char '"+Om(a)+"' in channel "+i),r=[a]}else e>=32&&e<=127&&(r=t===0?[e]:[e,t]);if(r){const a=Ms(r);this.logger.log(3,"Char codes =  "+a.join(",")),La(e,t,this.cmdHistory)}return r}parseBackgroundAttributes(e,t){const i=(e===16||e===24)&&t>=32&&t<=47,r=(e===23||e===31)&&t>=45&&t<=47;if(!(i||r))return!1;let s;const a={};e===16||e===24?(s=Math.floor((t-32)/2),a.background=AE[s],t%2==1&&(a.background=a.background+"_semi")):t===45?a.background="transparent":(a.foreground="black",t===47&&(a.underline=!0));const o=e<=23?1:2;return this.channels[o].setBkgData(a),La(e,t,this.cmdHistory),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}this.cmdHistory=Nm()}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const i=this.channels[t];i&&i.cueSplitAtTime(e)}}}function La(n,e,t){t.a=n,t.b=e}function Mm(n,e,t){return t.a===n&&t.b===e}function Nm(){return{a:null,b:null}}class ql{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,i){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=i,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var Yc=function(){if(typeof self!="undefined"&&self.VTTCue)return self.VTTCue;const n=["","lr","rl"],e=["start","middle","end","left","right"];function t(o,l){if(typeof l!="string"||!Array.isArray(o))return!1;const u=l.toLowerCase();return~o.indexOf(u)?u:!1}function i(o){return t(n,o)}function r(o){return t(e,o)}function s(o,...l){let u=1;for(;u<arguments.length;u++){const d=arguments[u];for(const h in d)o[h]=d[h]}return o}function a(o,l,u){const d=this,h={enumerable:!0};d.hasBeenReset=!1;let v="",x=!1,_=o,R=l,N=u,z=null,J="",ue=!0,pe="auto",te="start",ke=50,we="middle",Ge=50,Ve="middle";Object.defineProperty(d,"id",s({},h,{get:function(){return v},set:function(Fe){v=""+Fe}})),Object.defineProperty(d,"pauseOnExit",s({},h,{get:function(){return x},set:function(Fe){x=!!Fe}})),Object.defineProperty(d,"startTime",s({},h,{get:function(){return _},set:function(Fe){if(typeof Fe!="number")throw new TypeError("Start time must be set to a number.");_=Fe,this.hasBeenReset=!0}})),Object.defineProperty(d,"endTime",s({},h,{get:function(){return R},set:function(Fe){if(typeof Fe!="number")throw new TypeError("End time must be set to a number.");R=Fe,this.hasBeenReset=!0}})),Object.defineProperty(d,"text",s({},h,{get:function(){return N},set:function(Fe){N=""+Fe,this.hasBeenReset=!0}})),Object.defineProperty(d,"region",s({},h,{get:function(){return z},set:function(Fe){z=Fe,this.hasBeenReset=!0}})),Object.defineProperty(d,"vertical",s({},h,{get:function(){return J},set:function(Fe){const mt=i(Fe);if(mt===!1)throw new SyntaxError("An invalid or illegal string was specified.");J=mt,this.hasBeenReset=!0}})),Object.defineProperty(d,"snapToLines",s({},h,{get:function(){return ue},set:function(Fe){ue=!!Fe,this.hasBeenReset=!0}})),Object.defineProperty(d,"line",s({},h,{get:function(){return pe},set:function(Fe){if(typeof Fe!="number"&&Fe!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");pe=Fe,this.hasBeenReset=!0}})),Object.defineProperty(d,"lineAlign",s({},h,{get:function(){return te},set:function(Fe){const mt=r(Fe);if(!mt)throw new SyntaxError("An invalid or illegal string was specified.");te=mt,this.hasBeenReset=!0}})),Object.defineProperty(d,"position",s({},h,{get:function(){return ke},set:function(Fe){if(Fe<0||Fe>100)throw new Error("Position must be between 0 and 100.");ke=Fe,this.hasBeenReset=!0}})),Object.defineProperty(d,"positionAlign",s({},h,{get:function(){return we},set:function(Fe){const mt=r(Fe);if(!mt)throw new SyntaxError("An invalid or illegal string was specified.");we=mt,this.hasBeenReset=!0}})),Object.defineProperty(d,"size",s({},h,{get:function(){return Ge},set:function(Fe){if(Fe<0||Fe>100)throw new Error("Size must be between 0 and 100.");Ge=Fe,this.hasBeenReset=!0}})),Object.defineProperty(d,"align",s({},h,{get:function(){return Ve},set:function(Fe){const mt=r(Fe);if(!mt)throw new SyntaxError("An invalid or illegal string was specified.");Ve=mt,this.hasBeenReset=!0}})),d.displayState=void 0}return a.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},a}();class EE{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function Um(n){function e(i,r,s,a){return(i|0)*3600+(r|0)*60+(s|0)+parseFloat(a||0)}const t=n.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class TE{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,i){return i?this.has(e)?this.values[e]:t[i]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,i){for(let r=0;r<i.length;++r)if(t===i[r]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const i=parseFloat(t);if(i>=0&&i<=100)return this.set(e,i),!0}return!1}}function jm(n,e,t,i){const r=i?n.split(i):[n];for(const s in r){if(typeof r[s]!="string")continue;const a=r[s].split(t);if(a.length!==2)continue;const o=a[0],l=a[1];e(o,l)}}const Xc=new Yc(0,0,""),zl=Xc.align==="middle"?"middle":"center";function SE(n,e,t){const i=n;function r(){const o=Um(n);if(o===null)throw new Error("Malformed timestamp: "+i);return n=n.replace(/^[^\sa-zA-Z-]+/,""),o}function s(o,l){const u=new TE;jm(o,function(v,x){let _;switch(v){case"region":for(let R=t.length-1;R>=0;R--)if(t[R].id===x){u.set(v,t[R].region);break}break;case"vertical":u.alt(v,x,["rl","lr"]);break;case"line":_=x.split(","),u.integer(v,_[0]),u.percent(v,_[0])&&u.set("snapToLines",!1),u.alt(v,_[0],["auto"]),_.length===2&&u.alt("lineAlign",_[1],["start",zl,"end"]);break;case"position":_=x.split(","),u.percent(v,_[0]),_.length===2&&u.alt("positionAlign",_[1],["start",zl,"end","line-left","line-right","auto"]);break;case"size":u.percent(v,x);break;case"align":u.alt(v,x,["start",zl,"end","left","right"]);break}},/:/,/\s/),l.region=u.get("region",null),l.vertical=u.get("vertical","");let d=u.get("line","auto");d==="auto"&&Xc.line===-1&&(d=-1),l.line=d,l.lineAlign=u.get("lineAlign","start"),l.snapToLines=u.get("snapToLines",!0),l.size=u.get("size",100),l.align=u.get("align",zl);let h=u.get("position","auto");h==="auto"&&Xc.position===50&&(h=l.align==="start"||l.align==="left"?0:l.align==="end"||l.align==="right"?100:50),l.position=h}function a(){n=n.replace(/^\s+/,"")}if(a(),e.startTime=r(),a(),n.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+i);n=n.slice(3),a(),e.endTime=r(),a(),s(n,e)}function $m(n){return n.replace(/<br(?: \/)?>/gi,`
`)}class CE{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new EE,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function i(){let s=t.buffer,a=0;for(s=$m(s);a<s.length&&s[a]!=="\r"&&s[a]!==`
`;)++a;const o=s.slice(0,a);return s[a]==="\r"&&++a,s[a]===`
`&&++a,t.buffer=s.slice(a),o}function r(s){jm(s,function(a,o){},/:/)}try{let s="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;s=i();const o=s.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!(o!=null&&o[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let a=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(a?a=!1:s=i(),t.state){case"HEADER":/:/.test(s)?r(s):s||(t.state="ID");continue;case"NOTE":s||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(s)){t.state="NOTE";break}if(!s)continue;if(t.cue=new Yc(0,0,""),t.state="CUE",s.indexOf("-->")===-1){t.cue.id=s;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{SE(s,t.cue,t.regionList)}catch(o){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const o=s.indexOf("-->")!==-1;if(!s||o&&(a=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=s}continue;case"BADCUE":s||(t.state="ID")}}}catch(s){t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const wE=/\r\n|\n\r|\n|\r/g,Qc=function(e,t,i=0){return e.slice(i,i+t.length)===t},LE=function(e){let t=parseInt(e.slice(-3));const i=parseInt(e.slice(-6,-4)),r=parseInt(e.slice(-9,-7)),s=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!xt(t)||!xt(i)||!xt(r)||!xt(s))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*i,t+=60*1e3*r,t+=60*60*1e3*s,t},Zc=function(e){let t=5381,i=e.length;for(;i;)t=t*33^e.charCodeAt(--i);return(t>>>0).toString()};function Jc(n,e,t){return Zc(n.toString())+Zc(e.toString())+Zc(t)}const DE=function(e,t,i){let r=e[t],s=e[r.prevCC];if(!s||!s.new&&r.new){e.ccOffset=e.presentationOffset=r.start,r.new=!1;return}for(;(a=s)!=null&&a.new;){var a;e.ccOffset+=r.start-s.start,r.new=!1,r=s,s=e[r.prevCC]}e.presentationOffset=i};function kE(n,e,t,i,r,s,a){const o=new CE,l=xr(new Uint8Array(n)).trim().replace(wE,`
`).split(`
`),u=[],d=e?$x(e.baseTime,e.timescale):0;let h="00:00.000",v=0,x=0,_,R=!0;o.oncue=function(N){const z=t[i];let J=t.ccOffset;const ue=(v-d)/9e4;if(z!=null&&z.new&&(x!==void 0?J=t.ccOffset=z.start:DE(t,i,ue)),ue){if(!e){_=new Error("Missing initPTS for VTT MPEGTS");return}J=ue-t.presentationOffset}const pe=N.endTime-N.startTime,te=qn((N.startTime+J-x)*9e4,r*9e4)/9e4;N.startTime=Math.max(te,0),N.endTime=Math.max(te+pe,0);const ke=N.text.trim();N.text=decodeURIComponent(encodeURIComponent(ke)),N.id||(N.id=Jc(N.startTime,N.endTime,ke)),N.endTime>0&&u.push(N)},o.onparsingerror=function(N){_=N},o.onflush=function(){if(_){a(_);return}s(u)},l.forEach(N=>{if(R)if(Qc(N,"X-TIMESTAMP-MAP=")){R=!1,N.slice(16).split(",").forEach(z=>{Qc(z,"LOCAL:")?h=z.slice(6):Qc(z,"MPEGTS:")&&(v=parseInt(z.slice(7)))});try{x=LE(h)/1e3}catch(z){_=z}return}else N===""&&(R=!1);o.parse(N+`
`)}),o.flush()}const eh="stpp.ttml.im1t",Gm=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Vm=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,IE={left:"start",center:"center",right:"end",start:"start",end:"end"};function Hm(n,e,t,i){const r=Wt(new Uint8Array(n),["mdat"]);if(r.length===0){i(new Error("Could not parse IMSC1 mdat"));return}const s=r.map(o=>xr(o)),a=jx(e.baseTime,1,e.timescale);try{s.forEach(o=>t(RE(o,a)))}catch(o){i(o)}}function RE(n,e){const r=new DOMParser().parseFromString(n,"text/xml").getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");const s={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},a=Object.keys(s).reduce((h,v)=>(h[v]=r.getAttribute(`ttp:${v}`)||s[v],h),{}),o=r.getAttribute("xml:space")!=="preserve",l=Wm(th(r,"styling","style")),u=Wm(th(r,"layout","region")),d=th(r,"body","[begin]");return[].map.call(d,h=>{const v=Km(h,o);if(!v||!h.hasAttribute("begin"))return null;const x=nh(h.getAttribute("begin"),a),_=nh(h.getAttribute("dur"),a);let R=nh(h.getAttribute("end"),a);if(x===null)throw qm(h);if(R===null){if(_===null)throw qm(h);R=x+_}const N=new Yc(x-e,R-e,v);N.id=Jc(N.startTime,N.endTime,N.text);const z=u[h.getAttribute("region")],J=l[h.getAttribute("style")],ue=OE(z,J,l),{textAlign:pe}=ue;if(pe){const te=IE[pe];te&&(N.lineAlign=te),N.align=pe}return Bi(N,ue),N}).filter(h=>h!==null)}function th(n,e,t){const i=n.getElementsByTagName(e)[0];return i?[].slice.call(i.querySelectorAll(t)):[]}function Wm(n){return n.reduce((e,t)=>{const i=t.getAttribute("xml:id");return i&&(e[i]=t),e},{})}function Km(n,e){return[].slice.call(n.childNodes).reduce((t,i,r)=>{var s;return i.nodeName==="br"&&r?t+`
`:(s=i.childNodes)!=null&&s.length?Km(i,e):e?t+i.textContent.trim().replace(/\s+/g," "):t+i.textContent},"")}function OE(n,e,t){const i="http://www.w3.org/ns/ttml#styling";let r=null;const s=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],a=n!=null&&n.hasAttribute("style")?n.getAttribute("style"):null;return a&&t.hasOwnProperty(a)&&(r=t[a]),s.reduce((o,l)=>{const u=ih(e,i,l)||ih(n,i,l)||ih(r,i,l);return u&&(o[l]=u),o},{})}function ih(n,e,t){return n&&n.hasAttributeNS(e,t)?n.getAttributeNS(e,t):null}function qm(n){return new Error(`Could not parse ttml timestamp ${n}`)}function nh(n,e){if(!n)return null;let t=Um(n);return t===null&&(Gm.test(n)?t=PE(n,e):Vm.test(n)&&(t=BE(n,e))),t}function PE(n,e){const t=Gm.exec(n),i=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+i/e.frameRate}function BE(n,e){const t=Vm.exec(n),i=Number(t[1]);switch(t[2]){case"h":return i*3600;case"m":return i*60;case"ms":return i*1e3;case"f":return i/e.frameRate;case"t":return i/e.tickRate}return i}class FE{constructor(e){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=zm(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){const t=new ql(this,"textTrack1"),i=new ql(this,"textTrack2"),r=new ql(this,"textTrack3"),s=new ql(this,"textTrack4");this.cea608Parser1=new Fm(1,t,i),this.cea608Parser2=new Fm(3,r,s)}e.on(W.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(W.MANIFEST_LOADING,this.onManifestLoading,this),e.on(W.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(W.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(W.FRAG_LOADING,this.onFragLoading,this),e.on(W.FRAG_LOADED,this.onFragLoaded,this),e.on(W.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(W.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(W.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(W.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(W.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(W.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(W.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(W.MANIFEST_LOADING,this.onManifestLoading,this),e.off(W.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(W.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(W.FRAG_LOADING,this.onFragLoading,this),e.off(W.FRAG_LOADED,this.onFragLoaded,this),e.off(W.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(W.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(W.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(W.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(W.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null}addCues(e,t,i,r,s){let a=!1;for(let o=s.length;o--;){const l=s[o],u=NE(l[0],l[1],t,i);if(u>=0&&(l[0]=Math.min(l[0],t),l[1]=Math.max(l[1],i),a=!0,u/(i-t)>.5))return}if(a||s.push([t,i]),this.config.renderTextTracksNatively){const o=this.captionsTracks[e];this.Cues.newCue(o,t,i,r)}else{const o=this.Cues.newCue(null,t,i,r);this.hls.trigger(W.CUES_PARSED,{type:"captions",cues:o,track:e})}}onInitPtsFound(e,{frag:t,id:i,initPTS:r,timescale:s}){const{unparsedVttFrags:a}=this;i==="main"&&(this.initPTS[t.cc]={baseTime:r,timescale:s}),a.length&&(this.unparsedVttFrags=[],a.forEach(o=>{this.onFragLoaded(W.FRAG_LOADED,o)}))}getExistingTrack(e){const{media:t}=this;if(t)for(let i=0;i<t.textTracks.length;i++){const r=t.textTracks[i];if(r[e])return r}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:i,media:r}=this,{label:s,languageCode:a}=t[e],o=this.getExistingTrack(e);if(o)i[e]=o,Ta(i[e]),G0(i[e],r);else{const l=this.createTextTrack("captions",s,a);l&&(l[e]=!0,i[e]=l)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const i=t.label,r={_id:e,label:i,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(W.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}createTextTrack(e,t,i){const r=this.media;if(!!r)return r.addTextTrack(e,t,i)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach(t=>{Ta(e[t]),delete e[t]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=zm(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let i=0;i<t.length;i++)Ta(t[i])}onSubtitleTracksUpdated(e,t){const i=t.subtitleTracks||[],r=i.some(s=>s.textCodec===eh);if(this.config.enableWebVTT||r&&this.config.enableIMSC1){if(Lm(this.tracks,i)){this.tracks=i;return}if(this.textTracks=[],this.tracks=i,this.config.renderTextTracksNatively){const a=this.media?this.media.textTracks:null;this.tracks.forEach((o,l)=>{let u;if(a&&l<a.length){let d=null;for(let h=0;h<a.length;h++)if(ME(a[h],o)){d=a[h];break}d&&(u=d)}if(u)Ta(u);else{const d=this._captionsOrSubtitlesFromCharacteristics(o);u=this.createTextTrack(d,o.name,o.lang),u&&(u.mode="disabled")}u&&(u.groupId=o.groupId,this.textTracks.push(u))})}else if(this.tracks.length){const a=this.tracks.map(o=>({label:o.name,kind:o.type.toLowerCase(),default:o.default,subtitleTrack:o}));this.hls.trigger(W.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:a})}}}_captionsOrSubtitlesFromCharacteristics(e){if(e.attrs.CHARACTERISTICS){const t=/transcribes-spoken-dialog/gi.test(e.attrs.CHARACTERISTICS),i=/describes-music-and-sound/gi.test(e.attrs.CHARACTERISTICS);if(t&&i)return"captions"}return"subtitles"}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(i=>{const r=/(?:CC|SERVICE)([1-4])/.exec(i.instreamId);if(!r)return;const s=`textTrack${r[1]}`,a=this.captionsProperties[s];!a||(a.label=i.name,i.lang&&(a.languageCode=i.lang),a.media=i)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){const{cea608Parser1:i,cea608Parser2:r,lastSn:s,lastPartIndex:a}=this;if(!(!this.enabled||!(i&&r))&&t.frag.type===Lt.MAIN){var o,l;const u=t.frag.sn,d=(o=t==null||(l=t.part)==null?void 0:l.index)!=null?o:-1;u===s+1||u===s&&d===a+1||(i.reset(),r.reset()),this.lastSn=u,this.lastPartIndex=d}}onFragLoaded(e,t){const{frag:i,payload:r}=t;if(i.type===Lt.SUBTITLE)if(r.byteLength){const s=i.decryptdata,a="stats"in t;if(s==null||!s.encrypted||a){const o=this.tracks[i.level],l=this.vttCCs;l[i.cc]||(l[i.cc]={start:i.start,prevCC:this.prevCC,new:!0},this.prevCC=i.cc),o&&o.textCodec===eh?this._parseIMSC1(i,r):this._parseVTTs(t)}}else this.hls.trigger(W.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const i=this.hls;Hm(t,this.initPTS[e.cc],r=>{this._appendCues(r,e.level),i.trigger(W.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},r=>{Ce.log(`Failed to parse IMSC1: ${r}`),i.trigger(W.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:r})})}_parseVTTs(e){var t;const{frag:i,payload:r}=e,{initPTS:s,unparsedVttFrags:a}=this,o=s.length-1;if(!s[i.cc]&&o===-1){a.push(e);return}const l=this.hls,u=(t=i.initSegment)!=null&&t.data?Fs(i.initSegment.data,new Uint8Array(r)):r;kE(u,this.initPTS[i.cc],this.vttCCs,i.cc,i.start,d=>{this._appendCues(d,i.level),l.trigger(W.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:i})},d=>{const h=d.message==="Missing initPTS for VTT MPEGTS";h?a.push(e):this._fallbackToIMSC1(i,r),Ce.log(`Failed to parse VTT cue: ${d}`),!(h&&o>i.cc)&&l.trigger(W.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:d})})}_fallbackToIMSC1(e,t){const i=this.tracks[e.level];i.textCodec||Hm(t,this.initPTS[e.cc],()=>{i.textCodec=eh,this._parseIMSC1(e,t)},()=>{i.textCodec="wvtt"})}_appendCues(e,t){const i=this.hls;if(this.config.renderTextTracksNatively){const r=this.textTracks[t];if(!r||r.mode==="disabled")return;e.forEach(s=>V0(r,s))}else{const r=this.tracks[t];if(!r)return;const s=r.default?"default":"subtitles"+t;i.trigger(W.CUES_PARSED,{type:"subtitles",cues:e,track:s})}}onFragDecrypted(e,t){const{frag:i}=t;i.type===Lt.SUBTITLE&&this.onFragLoaded(W.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){const{cea608Parser1:i,cea608Parser2:r}=this;if(!this.enabled||!(i&&r))return;const{frag:s,samples:a}=t;if(!(s.type===Lt.MAIN&&this.closedCaptionsForLevel(s)==="NONE"))for(let o=0;o<a.length;o++){const l=a[o].bytes;if(l){const u=this.extractCea608Data(l);i.addData(a[o].pts,u[0]),r.addData(a[o].pts,u[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:i,endOffsetSubtitles:r,type:s}){const{media:a}=this;if(!(!a||a.currentTime<i)){if(!s||s==="video"){const{captionsTracks:o}=this;Object.keys(o).forEach(l=>xc(o[l],t,i))}if(this.config.renderTextTracksNatively&&t===0&&r!==void 0){const{textTracks:o}=this;Object.keys(o).forEach(l=>xc(o[l],t,r))}}}extractCea608Data(e){const t=[[],[]],i=e[0]&31;let r=2;for(let s=0;s<i;s++){const a=e[r++],o=127&e[r++],l=127&e[r++];if(o===0&&l===0)continue;if((4&a)!=0){const d=3&a;(d===0||d===1)&&(t[d].push(o),t[d].push(l))}}return t}}function ME(n,e){return!!n&&n.label===e.name&&!(n.textTrack1||n.textTrack2)}function NE(n,e,t,i){return Math.min(e,i)-Math.max(n,t)}function zm(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class rh{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(W.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(W.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(W.MANIFEST_PARSED,this.onManifestParsed,this),e.on(W.BUFFER_CODECS,this.onBufferCodecs,this),e.on(W.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(W.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(W.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(W.MANIFEST_PARSED,this.onManifestParsed,this),e.off(W.BUFFER_CODECS,this.onBufferCodecs,this),e.off(W.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const i=this.hls.levels[t.droppedLevel];this.isLevelAllowed(i)&&this.restrictedLevels.push({bitrate:i.bitrate,height:i.height,width:i.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null}onManifestParsed(e,t){const i=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,i.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){const e=this.hls.levels;if(e.length){const t=this.hls;t.autoLevelCapping=this.getMaxLevel(e.length-1),t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const i=t.filter((r,s)=>this.isLevelAllowed(r)&&s<=e);return this.clientRect=null,rh.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const i=e.getBoundingClientRect();t.width=i.width,t.height=i.height,!t.width&&!t.height&&(t.width=i.right-i.left||e.width||0,t.height=i.bottom-i.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch(t){}return e}isLevelAllowed(e){return!this.restrictedLevels.some(i=>e.bitrate===i.bitrate&&e.width===i.width&&e.height===i.height)}static getMaxLevelByMediaSize(e,t,i){if(!(e!=null&&e.length))return-1;const r=(a,o)=>o?a.width!==o.width||a.height!==o.height:!0;let s=e.length-1;for(let a=0;a<e.length;a+=1){const o=e[a];if((o.width>=t||o.height>=i)&&r(o,e[a+1])){s=a;break}}return s}}class UE{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(W.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(W.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const i=this.hls.config;if(i.capLevelOnFPSDrop){const r=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=r,r&&typeof r.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),i.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,i){const r=performance.now();if(t){if(this.lastTime){const s=r-this.lastTime,a=i-this.lastDroppedFrames,o=t-this.lastDecodedFrames,l=1e3*a/s,u=this.hls;if(u.trigger(W.FPS_DROP,{currentDropped:a,currentDecoded:o,totalDroppedFrames:i}),l>0&&a>u.config.fpsDroppedMonitoringThreshold*o){let d=u.currentLevel;Ce.warn("drop FPS ratio greater than max allowed value for currentLevel: "+d),d>0&&(u.autoLevelCapping===-1||u.autoLevelCapping>=d)&&(d=d-1,u.trigger(W.FPS_DROP_LEVEL_CAPPING,{level:d,droppedLevel:u.currentLevel}),u.autoLevelCapping=d,this.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=i,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}const Yl="[eme]";class Da{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=Da.CDMCleanupPromise?[Da.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=Ce.debug.bind(Ce,Yl),this.log=Ce.log.bind(Ce,Yl),this.warn=Ce.warn.bind(Ce,Yl),this.error=Ce.error.bind(Ce,Yl),this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(W.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(W.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(W.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(W.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(W.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(W.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(W.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(W.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:i}=this.config,r=t[e];if(r)return r.licenseUrl;if(e===_i.WIDEVINE&&i)return i;throw new Error(`no license server URL configured for key-system "${e}"`)}getServerCertificateUrl(e){const{drmSystems:t}=this.config,i=t[e];if(i)return i.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,i=(a,o,l)=>!!a&&l.indexOf(a)===o,r=t.map(a=>a.audioCodec).filter(i),s=t.map(a=>a.videoCodec).filter(i);return r.length+s.length===0&&s.push("avc1.42e01e"),new Promise((a,o)=>{const l=u=>{const d=u.shift();this.getMediaKeysPromise(d,r,s).then(h=>a({keySystem:d,mediaKeys:h})).catch(h=>{u.length?l(u):h instanceof zn?o(h):o(new zn({type:Ct.KEY_SYSTEM_ERROR,details:je.KEY_SYSTEM_NO_ACCESS,error:h,fatal:!0},h.message))})};l(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:i}=this.config;if(typeof i!="function"){let r=`Configured requestMediaKeySystemAccess is not a function ${i}`;return g0===null&&self.location.protocol==="http:"&&(r=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(r))}return i(e,t)}getMediaKeysPromise(e,t,i){const r=Jb(e,t,i,this.config.drmSystemOptions),s=this.keySystemAccessPromises[e];let a=s==null?void 0:s.keySystemAccess;if(!a){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(r)}`),a=this.requestMediaKeySystemAccess(e,r);const o=this.keySystemAccessPromises[e]={keySystemAccess:a};return a.catch(l=>{this.log(`Failed to obtain access to key-system "${e}": ${l}`)}),a.then(l=>{this.log(`Access for key-system "${l.keySystem}" obtained`);const u=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),o.mediaKeys=l.createMediaKeys().then(d=>(this.log(`Media-keys created for "${e}"`),u.then(h=>h?this.setMediaKeysServerCertificate(d,e,h):d))),o.mediaKeys.catch(d=>{this.error(`Failed to create media-keys for "${e}"}: ${d}`)}),o.mediaKeys})}return a.then(()=>s.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:i}){this.log(`Creating key-system session "${t}" keyId: ${Er.hexDump(e.keyId||[])}`);const r=i.createSession(),s={decryptdata:e,keySystem:t,mediaKeys:i,mediaKeysSession:r,keyStatus:"status-pending"};return this.mediaKeySessions.push(s),s}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const i=this.createMediaKeySessionContext(e),r=this.getKeyIdString(t),s="cenc";this.keyIdToKeySessionPromise[r]=this.generateRequestWithPreferredKeySession(i,s,t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return Er.hexDump(e.keyId)}updateKeySession(e,t){var i;const r=e.mediaKeysSession;return this.log(`Updating key-session "${r.sessionId}" for keyID ${Er.hexDump(((i=e.decryptdata)==null?void 0:i.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),r.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise((t,i)=>{const r=mc(this.config),s=e.map(f0).filter(a=>!!a&&r.indexOf(a)!==-1);return this.getKeySystemSelectionPromise(s).then(({keySystem:a})=>{const o=m0(a);o?t(o):i(new Error(`Unable to find format for key-system "${a}"`))}).catch(i)})}loadKey(e){const t=e.keyInfo.decryptdata,i=this.getKeyIdString(t),r=`(keyId: ${i} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${r}`);let s=this.keyIdToKeySessionPromise[i];return s||(s=this.keyIdToKeySessionPromise[i]=this.getKeySystemForKeyPromise(t).then(({keySystem:a,mediaKeys:o})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${r}`),this.attemptSetMediaKeys(a,o).then(()=>{this.throwIfDestroyed();const l=this.createMediaKeySessionContext({keySystem:a,mediaKeys:o,decryptdata:t}),u="cenc";return this.generateRequestWithPreferredKeySession(l,u,t.pssh,"playlist-key")}))),s.catch(a=>this.handleError(a))),s}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){!this.hls||(this.error(e.message),e instanceof zn?this.hls.trigger(W.ERROR,e.data):this.hls.trigger(W.ERROR,{type:Ct.KEY_SYSTEM_ERROR,details:je.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),i=this.keyIdToKeySessionPromise[t];if(!i){const r=f0(e.keyFormat),s=r?[r]:mc(this.config);return this.attemptKeySystemAccess(s)}return i}getKeySystemSelectionPromise(e){if(e.length||(e=mc(this.config)),e.length===0)throw new zn({type:Ct.KEY_SYSTEM_ERROR,details:je.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}_onMediaEncrypted(e){const{initDataType:t,initData:i}=e;if(this.debug(`"${e.type}" event: init data type: "${t}"`),i===null)return;let r,s;if(t==="sinf"&&this.config.drmSystems[_i.FAIRPLAY]){const d=qi(new Uint8Array(i));try{const h=pc(JSON.parse(d).sinf),v=T0(new Uint8Array(h));if(!v)return;r=v.subarray(8,24),s=_i.FAIRPLAY}catch(h){this.warn('Failed to parse sinf "encrypted" event message initData');return}}else{const d=E_(i);if(d===null)return;d.version===0&&d.systemId===p0.WIDEVINE&&d.data&&(r=d.data.subarray(8,24)),s=Zb(d.systemId)}if(!s||!r)return;const a=Er.hexDump(r),{keyIdToKeySessionPromise:o,mediaKeySessions:l}=this;let u=o[a];for(let d=0;d<l.length;d++){const h=l[d],v=h.decryptdata;if(v.pssh||!v.keyId)continue;const x=Er.hexDump(v.keyId);if(a===x||v.uri.replace(/-/g,"").indexOf(a)!==-1){u=o[x],delete o[x],v.pssh=new Uint8Array(i),v.keyId=r,u=o[a]=u.then(()=>this.generateRequestWithPreferredKeySession(h,t,i,"encrypted-event-key-match"));break}}u||(u=o[a]=this.getKeySystemSelectionPromise([s]).then(({keySystem:d,mediaKeys:h})=>{var v;this.throwIfDestroyed();const x=new ho("ISO-23001-7",a,(v=m0(d))!=null?v:"");return x.pssh=new Uint8Array(i),x.keyId=r,this.attemptSetMediaKeys(d,h).then(()=>{this.throwIfDestroyed();const _=this.createMediaKeySessionContext({decryptdata:x,keySystem:d,mediaKeys:h});return this.generateRequestWithPreferredKeySession(_,t,i,"encrypted-event-no-match")})})),u.catch(d=>this.handleError(d))}_onWaitingForKey(e){this.log(`"${e.type}" event`)}attemptSetMediaKeys(e,t){const i=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const r=Promise.all(i).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.setMediaKeysQueue.push(r),r.then(()=>{this.log(`Media-keys set for "${e}"`),i.push(r),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(s=>i.indexOf(s)===-1)})}generateRequestWithPreferredKeySession(e,t,i,r){var s,a;const o=(s=this.config.drmSystems)==null||(a=s[e.keySystem])==null?void 0:a.generateRequest;if(o)try{const v=o.call(this.hls,t,i,e);if(!v)throw new Error("Invalid response from configured generateRequest filter");t=v.initDataType,i=e.decryptdata.pssh=v.initData?new Uint8Array(v.initData):null}catch(v){var l;if(this.warn(v.message),(l=this.hls)!=null&&l.config.debug)throw v}if(i===null)return this.log(`Skipping key-session request for "${r}" (no initData)`),Promise.resolve(e);const u=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${r}": ${u} (init data type: ${t} length: ${i?i.byteLength:null})`);const d=new Hc;e.mediaKeysSession.onmessage=v=>{const x=e.mediaKeysSession;if(!x){d.emit("error",new Error("invalid state"));return}const{messageType:_,message:R}=v;this.log(`"${_}" message event for session "${x.sessionId}" message size: ${R.byteLength}`),_==="license-request"||_==="license-renewal"?this.renewLicense(e,R).catch(N=>{this.handleError(N),d.emit("error",N)}):_==="license-release"?e.keySystem===_i.FAIRPLAY&&(this.updateKeySession(e,h0("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${_}"`)},e.mediaKeysSession.onkeystatuseschange=v=>{if(!e.mediaKeysSession){d.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const _=e.keyStatus;d.emit("keyStatus",_),_==="expired"&&(this.warn(`${e.keySystem} expired for key ${u}`),this.renewKeySession(e))};const h=new Promise((v,x)=>{d.on("error",x),d.on("keyStatus",_=>{_.startsWith("usable")?v():_==="output-restricted"?x(new zn({type:Ct.KEY_SYSTEM_ERROR,details:je.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):_==="internal-error"?x(new zn({type:Ct.KEY_SYSTEM_ERROR,details:je.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${_}"`)):_==="expired"?x(new Error("key expired while generating request")):this.warn(`unhandled key status change "${_}"`)})});return e.mediaKeysSession.generateRequest(t,i).then(()=>{var v;this.log(`Request generated for key-session "${(v=e.mediaKeysSession)==null?void 0:v.sessionId}" keyId: ${u}`)}).catch(v=>{throw new zn({type:Ct.KEY_SYSTEM_ERROR,details:je.KEY_SYSTEM_NO_SESSION,error:v,fatal:!1},`Error generating key-session request: ${v}`)}).then(()=>h).catch(v=>{throw d.removeAllListeners(),this.removeSession(e),v}).then(()=>(d.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,i)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${Er.hexDump("buffer"in i?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):new Uint8Array(i))} session keyId: ${Er.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,i=t.loader,r=new i(t),s=this.getServerCertificateUrl(e);return s?(this.log(`Fetching serverCertificate for "${e}"`),new Promise((a,o)=>{const l={responseType:"arraybuffer",url:s},u=t.certLoadPolicy.default,d={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},h={onSuccess:(v,x,_,R)=>{a(v.data)},onError:(v,x,_,R)=>{o(new zn({type:Ct.KEY_SYSTEM_ERROR,details:je.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:_,response:pn({url:l.url,data:void 0},v)},`"${e}" certificate request failed (${s}). Status: ${v.code} (${v.text})`))},onTimeout:(v,x,_)=>{o(new zn({type:Ct.KEY_SYSTEM_ERROR,details:je.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:_,response:{url:l.url,data:void 0}},`"${e}" certificate request timed out (${s})`))},onAbort:(v,x,_)=>{o(new Error("aborted"))}};r.load(l,d,h)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,i){return new Promise((r,s)=>{e.setServerCertificate(i).then(a=>{this.log(`setServerCertificate ${a?"success":"not supported by CDM"} (${i==null?void 0:i.byteLength}) on "${t}"`),r(e)}).catch(a=>{s(new zn({type:Ct.KEY_SYSTEM_ERROR,details:je.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:a,fatal:!0},a.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(i=>this.updateKeySession(e,new Uint8Array(i)).catch(r=>{throw new zn({type:Ct.KEY_SYSTEM_ERROR,details:je.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:r,fatal:!0},r.message)}))}setupLicenseXHR(e,t,i,r){const s=this.config.licenseXhrSetup;return s?Promise.resolve().then(()=>{if(!i.decryptdata)throw new Error("Key removed");return s.call(this.hls,e,t,i,r)}).catch(a=>{if(!i.decryptdata)throw a;return e.open("POST",t,!0),s.call(this.hls,e,t,i,r)}).then(a=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:a||r})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:r}))}requestLicense(e,t){const i=this.config.keyLoadPolicy.default;return new Promise((r,s)=>{const a=this.getLicenseServerUrl(e.keySystem);this.log(`Sending license request to URL: ${a}`);const o=new XMLHttpRequest;o.responseType="arraybuffer",o.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return s(new Error("invalid state"));if(o.readyState===4)if(o.status===200){this._requestLicenseFailureCount=0;let l=o.response;this.log(`License received ${l instanceof ArrayBuffer?l.byteLength:l}`);const u=this.config.licenseResponseCallback;if(u)try{l=u.call(this.hls,o,a,e)}catch(d){this.error(d)}r(l)}else{const l=i.errorRetry,u=l?l.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>u||o.status>=400&&o.status<500)s(new zn({type:Ct.KEY_SYSTEM_ERROR,details:je.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:o,response:{url:a,data:void 0,code:o.status,text:o.statusText}},`License Request XHR failed (${a}). Status: ${o.status} (${o.statusText})`));else{const d=u-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${d} attempts left`),this.requestLicense(e,t).then(r,s)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=o,this.setupLicenseXHR(o,a,e,t).then(({xhr:l,licenseChallenge:u})=>{l.send(u)})})}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const i=t.media;this.media=i,i.addEventListener("encrypted",this.onMediaEncrypted),i.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media,t=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},ho.clearKeyUriToKeyIdMap();const i=t.length;Da.CDMCleanupPromise=Promise.all(t.map(r=>this.removeSession(r)).concat(e==null?void 0:e.setMediaKeys(null).catch(r=>{this.log(`Could not clear media keys: ${r}. media.src: ${e==null?void 0:e.src}`)}))).then(()=>{i&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)}).catch(r=>{this.log(`Could not close sessions and clear media keys: ${r}. media.src: ${e==null?void 0:e.src}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const i=t.reduce((r,s)=>(r.indexOf(s.keyFormat)===-1&&r.push(s.keyFormat),r),[]);this.log(`Selecting key-system from session-keys ${i.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(i)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:i}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),t.onmessage=null,t.onkeystatuseschange=null,i&&i.readyState!==XMLHttpRequest.DONE&&i.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const r=this.mediaKeySessions.indexOf(e);return r>-1&&this.mediaKeySessions.splice(r,1),t.remove().catch(s=>{this.log(`Could not remove session: ${s}`)}).then(()=>t.close()).catch(s=>{this.log(`Could not close session: ${s}`)})}}}Da.CDMCleanupPromise=void 0;class zn extends Error{constructor(e,t){super(t);this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}const jE=1;var yn={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"};const $E="h";class ps{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=r=>{try{this.apply(r,{ot:yn.MANIFEST,su:!this.initialized})}catch(s){Ce.warn("Could not generate manifest CMCD data.",s)}},this.applyFragmentData=r=>{try{const s=r.frag,a=this.hls.levels[s.level],o=this.getObjectType(s),l={d:s.duration*1e3,ot:o};(o===yn.VIDEO||o===yn.AUDIO||o==yn.MUXED)&&(l.br=a.bitrate/1e3,l.tb=this.getTopBandwidth(o)/1e3,l.bl=this.getBufferLength(o)),this.apply(r,l)}catch(s){Ce.warn("Could not generate segment CMCD data.",s)}},this.hls=e;const t=this.config=e.config,{cmcd:i}=t;i!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=i.sessionId||ps.uuid(),this.cid=i.contentId,this.useHeaders=i.useHeaders===!0,this.registerListeners())}registerListeners(){const e=this.hls;e.on(W.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(W.MEDIA_DETACHED,this.onMediaDetached,this),e.on(W.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(W.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(W.MEDIA_DETACHED,this.onMediaDetached,this),e.off(W.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){!this.media||(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var i,r;this.audioBuffer=(i=t.tracks.audio)==null?void 0:i.buffer,this.videoBuffer=(r=t.tracks.video)==null?void 0:r.buffer}createData(){var e;return{v:jE,sf:$E,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){Bi(t,this.createData());const i=t.ot===yn.INIT||t.ot===yn.VIDEO||t.ot===yn.MUXED;if(this.starved&&i&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering),this.useHeaders){const r=ps.toHeaders(t);if(!Object.keys(r).length)return;e.headers||(e.headers={}),Bi(e.headers,r)}else{const r=ps.toQuery(t);if(!r)return;e.url=ps.appendQueryToUri(e.url,r)}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return yn.TIMED_TEXT;if(e.sn==="initSegment")return yn.INIT;if(t==="audio")return yn.AUDIO;if(t==="main")return this.hls.audioTracks.length?yn.VIDEO:yn.MUXED}getTopBandwidth(e){let t=0,i;const r=this.hls;if(e===yn.AUDIO)i=r.audioTracks;else{const s=r.maxAutoLevel,a=s>-1?s+1:r.levels.length;i=r.levels.slice(0,a)}for(const s of i)s.bitrate>t&&(t=s.bitrate);return t>0?t:NaN}getBufferLength(e){const t=this.hls.media,i=e===yn.AUDIO?this.audioBuffer:this.videoBuffer;return!i||!t?NaN:pi.bufferInfo(i,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,i=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new i(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,a,o){t(s),this.loader.load(s,a,o)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,i=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new i(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,a,o){t(s),this.loader.load(s,a,o)}}}static uuid(){const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}static serialize(e){const t=[],i=u=>!Number.isNaN(u)&&u!=null&&u!==""&&u!==!1,r=u=>Math.round(u),s=u=>r(u/100)*100,o={br:r,d:r,bl:s,dl:s,mtp:s,nor:u=>encodeURIComponent(u),rtp:s,tb:r},l=Object.keys(e||{}).sort();for(const u of l){let d=e[u];if(!i(d)||u==="v"&&d===1||u=="pr"&&d===1)continue;const h=o[u];h&&(d=h(d));const v=typeof d;let x;u==="ot"||u==="sf"||u==="st"?x=`${u}=${d}`:v==="boolean"?x=u:v==="number"?x=`${u}=${d}`:x=`${u}=${JSON.stringify(d)}`,t.push(x)}return t.join(",")}static toHeaders(e){const t=Object.keys(e),i={},r=["Object","Request","Session","Status"],s=[{},{},{},{}],a={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3};for(const o of t){const l=a[o]!=null?a[o]:1;s[l][o]=e[o]}for(let o=0;o<s.length;o++){const l=ps.serialize(s[o]);l&&(i[`CMCD-${r[o]}`]=l)}return i}static toQuery(e){return`CMCD=${encodeURIComponent(ps.serialize(e))}`}static appendQueryToUri(e,t){if(!t)return e;const i=e.includes("?")?"&":"?";return`${e}${i}${t}`}}const GE=3e5;class VE{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=Ce.log.bind(Ce,"[content-steering]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(W.MANIFEST_LOADING,this.onManifestLoading,this),e.on(W.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(W.MANIFEST_PARSED,this.onManifestParsed,this),e.on(W.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;!e||(e.off(W.MANIFEST_LOADING,this.onManifestLoading,this),e.off(W.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(W.MANIFEST_PARSED,this.onManifestParsed,this),e.off(W.ERROR,this.onError,this))}startLoad(){if(this.started=!0,self.clearTimeout(this.reloadTimer),this.enabled&&this.uri)if(this.updated){const e=Math.max(this.timeToLoad*1e3-(performance.now()-this.updated),0);this.scheduleRefresh(this.uri,e)}else this.loadSteeringManifest(this.uri)}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),self.clearTimeout(this.reloadTimer)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(i=>i!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:i}=t;i!==null&&(this.pathwayId=i.pathwayId,this.uri=i.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:i}=t;if((i==null?void 0:i.action)===Zi.SendAlternateToPenaltyBox&&i.flags===Kn.MoveAllAlternatesMatchingHost){let r=this.pathwayPriority;const s=this.pathwayId;this.penalizedPathways[s]||(this.penalizedPathways[s]=performance.now()),!r&&this.levels&&(r=this.levels.reduce((a,o)=>(a.indexOf(o.pathwayId)===-1&&a.push(o.pathwayId),a),[])),r&&r.length>1&&(this.updatePathwayPriority(r),i.resolved=this.pathwayId!==s)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const i=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${i}"`),t=this.getLevelsForPathway(i),this.pathwayId=i}return t.length!==e.length?(this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t):e}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this.pathwayPriority=e;let t;const i=this.penalizedPathways,r=performance.now();Object.keys(i).forEach(s=>{r-i[s]>GE&&delete i[s]});for(let s=0;s<e.length;s++){const a=e[s];if(i[a])continue;if(a===this.pathwayId)return;const o=this.hls.nextLoadLevel,l=this.hls.levels[o];if(t=this.getLevelsForPathway(a),t.length>0){this.log(`Setting Pathway to "${a}"`),this.pathwayId=a,this.hls.trigger(W.LEVELS_UPDATED,{levels:t});const u=this.hls.levels[o];l&&u&&this.levels&&(u.attrs["STABLE-VARIANT-ID"]!==l.attrs["STABLE-VARIANT-ID"]&&u.bitrate!==l.bitrate&&this.log(`Unstable Pathways change from bitrate ${l.bitrate} to ${u.bitrate}`),this.hls.nextLoadLevel=o);break}}}clonePathways(e){const t=this.levels;if(!t)return;const i={},r={};e.forEach(s=>{const{ID:a,"BASE-ID":o,"URI-REPLACEMENT":l}=s;if(t.some(d=>d.pathwayId===a))return;const u=this.getLevelsForPathway(o).map(d=>{const h=Bi({},d);h.details=void 0,h.url=Xm(d.uri,d.attrs["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",l);const v=new bi(d.attrs);v["PATHWAY-ID"]=a;const x=v.AUDIO&&`${v.AUDIO}_clone_${a}`,_=v.SUBTITLES&&`${v.SUBTITLES}_clone_${a}`;x&&(i[v.AUDIO]=x,v.AUDIO=x),_&&(r[v.SUBTITLES]=_,v.SUBTITLES=_),h.attrs=v;const R=new po(h);return Ul(R,"audio",x),Ul(R,"text",_),R});t.push(...u),Ym(this.audioTracks,i,l,a),Ym(this.subtitleTracks,r,l,a)})}loadSteeringManifest(e){const t=this.hls.config,i=t.loader;this.loader&&this.loader.destroy(),this.loader=new i(t);let r;try{r=new self.URL(e)}catch(d){this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(r.protocol!=="data:"){const d=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;r.searchParams.set("_HLS_pathway",this.pathwayId),r.searchParams.set("_HLS_throughput",""+d)}const s={responseType:"json",url:r.href},a=t.steeringManifestLoadPolicy.default,o=a.errorRetry||a.timeoutRetry||{},l={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},u={onSuccess:(d,h,v,x)=>{this.log(`Loaded steering manifest: "${r}"`);const _=d.data;if(_.VERSION!==1){this.log(`Steering VERSION ${_.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=_.TTL;const{"RELOAD-URI":R,"PATHWAY-CLONES":N,"PATHWAY-PRIORITY":z}=_;if(R)try{this.uri=new self.URL(R,r).href}catch(J){this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${R}`);return}this.scheduleRefresh(this.uri||v.url),N&&this.clonePathways(N),z&&this.updatePathwayPriority(z)},onError:(d,h,v,x)=>{if(this.log(`Error loading steering manifest: ${d.code} ${d.text} (${h.url})`),this.stopLoad(),d.code===410){this.enabled=!1,this.log(`Steering manifest ${h.url} no longer available`);return}let _=this.timeToLoad*1e3;if(d.code===429){const R=this.loader;if(typeof(R==null?void 0:R.getResponseHeader)=="function"){const N=R.getResponseHeader("Retry-After");N&&(_=parseFloat(N)*1e3)}this.log(`Steering manifest ${h.url} rate limited`);return}this.scheduleRefresh(this.uri||h.url,_)},onTimeout:(d,h,v)=>{this.log(`Timeout loading steering manifest (${h.url})`),this.scheduleRefresh(this.uri||h.url)}};this.log(`Requesting steering manifest: ${r}`),this.loader.load(s,l,u)}scheduleRefresh(e,t=this.timeToLoad*1e3){self.clearTimeout(this.reloadTimer),this.reloadTimer=self.setTimeout(()=>{this.loadSteeringManifest(e)},t)}}function Ym(n,e,t,i){!n||Object.keys(e).forEach(r=>{const s=n.filter(a=>a.groupId===r).map(a=>{const o=Bi({},a);return o.details=void 0,o.attrs=new bi(o.attrs),o.url=o.attrs.URI=Xm(a.url,a.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),o.groupId=o.attrs["GROUP-ID"]=e[r],o.attrs["PATHWAY-ID"]=i,o});n.push(...s)})}function Xm(n,e,t,i){const{HOST:r,PARAMS:s,[t]:a}=i;let o;e&&(o=a==null?void 0:a[e],o&&(n=o));const l=new self.URL(n);return r&&!o&&(l.host=r),s&&Object.keys(s).sort().forEach(u=>{u&&l.searchParams.set(u,s[u])}),l.href}const HE=/^age:\s*[\d.]+\s*$/im;class Qm{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new kl,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,i){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=i,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e)return;const i=this.loader=new self.XMLHttpRequest,r=this.stats;r.loading.first=0,r.loaded=0,r.aborted=!1;const s=this.xhrSetup;s?Promise.resolve().then(()=>{if(!this.stats.aborted)return s(i,t.url)}).catch(a=>(i.open("GET",t.url,!0),s(i,t.url))).then(()=>{this.stats.aborted||this.openAndSendXhr(i,t,e)}).catch(a=>{this.callbacks.onError({code:i.status,text:a.message},t,i,r)}):this.openAndSendXhr(i,t,e)}openAndSendXhr(e,t,i){e.readyState||e.open("GET",t.url,!0);const r=this.context.headers,{maxTimeToFirstByteMs:s,maxLoadTimeMs:a}=i.loadPolicy;if(r)for(const o in r)e.setRequestHeader(o,r[o]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),i.timeout=s&&xt(s)?s:a,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:i}=this;if(!e||!t)return;const r=t.readyState,s=this.config;if(!i.aborted&&r>=2&&(i.loading.first===0&&(i.loading.first=Math.max(self.performance.now(),i.loading.start),s.timeout!==s.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),s.timeout=s.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),s.loadPolicy.maxLoadTimeMs-(i.loading.first-i.loading.start)))),r===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const a=t.status,o=t.responseType!=="text";if(a>=200&&a<300&&(o&&t.response||t.responseText!==null)){i.loading.end=Math.max(self.performance.now(),i.loading.first);const l=o?t.response:t.responseText,u=t.responseType==="arraybuffer"?l.byteLength:l.length;if(i.loaded=i.total=u,i.bwEstimate=i.total*8e3/(i.loading.end-i.loading.first),!this.callbacks)return;const d=this.callbacks.onProgress;if(d&&d(i,e,l,t),!this.callbacks)return;const h={url:t.responseURL,data:l,code:a};this.callbacks.onSuccess(h,i,e,t)}else{const l=s.loadPolicy.errorRetry,u=i.retry;Nl(l,u,!1,a)?this.retry(l):(Ce.error(`${a} while loading ${e.url}`),this.callbacks.onError({code:a,text:t.statusText},e,t,i))}}}loadtimeout(){var e;const t=(e=this.config)==null?void 0:e.loadPolicy.timeoutRetry,i=this.stats.retry;if(Nl(t,i,!0))this.retry(t);else{Ce.warn(`timeout while loading ${this.context.url}`);const r=this.callbacks;r&&(this.abortInternal(),r.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:i}=this;this.retryDelay=Lc(e,i.retry),i.retry++,Ce.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t.url}, retrying ${i.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&HE.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}function WE(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(n){}return!1}const KE=/(\d+)-(\d+)\/(\d+)/;class Zm{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||XE,this.controller=new self.AbortController,this.stats=new kl}destroy(){this.loader=this.callbacks=null,this.abortInternal()}abortInternal(){const e=this.response;e!=null&&e.ok||(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,i){const r=this.stats;if(r.loading.start)throw new Error("Loader can only be used once.");r.loading.start=self.performance.now();const s=qE(e,this.controller.signal),a=i.onProgress,o=e.responseType==="arraybuffer",l=o?"byteLength":"length",{maxTimeToFirstByteMs:u,maxLoadTimeMs:d}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=i,this.request=this.fetchSetup(e,s),self.clearTimeout(this.requestTimeout),t.timeout=u&&xt(u)?u:d,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),i.onTimeout(r,e,this.response)},t.timeout),self.fetch(this.request).then(h=>{this.response=this.loader=h;const v=Math.max(self.performance.now(),r.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=d,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),i.onTimeout(r,e,this.response)},d-(v-r.loading.start)),!h.ok){const{status:x,statusText:_}=h;throw new QE(_||"fetch, bad network response",x,h)}return r.loading.first=v,r.total=YE(h.headers)||r.total,a&&xt(t.highWaterMark)?this.loadProgressively(h,r,e,t.highWaterMark,a):o?h.arrayBuffer():e.responseType==="json"?h.json():h.text()}).then(h=>{const{response:v}=this;self.clearTimeout(this.requestTimeout),r.loading.end=Math.max(self.performance.now(),r.loading.first);const x=h[l];x&&(r.loaded=r.total=x);const _={url:v.url,data:h,code:v.status};a&&!xt(t.highWaterMark)&&a(r,e,h,v),i.onSuccess(_,r,e,v)}).catch(h=>{if(self.clearTimeout(this.requestTimeout),r.aborted)return;const v=h&&h.code||0,x=h?h.message:null;i.onError({code:v,text:x},e,h?h.details:null,r)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,i,r=0,s){const a=new Cm,o=e.body.getReader(),l=()=>o.read().then(u=>{if(u.done)return a.dataLength&&s(t,i,a.flush(),e),Promise.resolve(new ArrayBuffer(0));const d=u.value,h=d.length;return t.loaded+=h,h<r||a.dataLength?(a.push(d),a.dataLength>=r&&s(t,i,a.flush(),e)):s(t,i,d,e),l()}).catch(()=>Promise.reject());return l()}}function qE(n,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(Bi({},n.headers))};return n.rangeEnd&&t.headers.set("Range","bytes="+n.rangeStart+"-"+String(n.rangeEnd-1)),t}function zE(n){const e=KE.exec(n);if(e)return parseInt(e[2])-parseInt(e[1])+1}function YE(n){const e=n.get("Content-Range");if(e){const i=zE(e);if(xt(i))return i}const t=n.get("Content-Length");if(t)return parseInt(t)}function XE(n,e){return new self.Request(n.url,e)}class QE extends Error{constructor(e,t,i){super(e);this.code=void 0,this.details=void 0,this.code=t,this.details=i}}const ZE=/\s/,JE={newCue(n,e,t,i){const r=[];let s,a,o,l,u;const d=self.VTTCue||self.TextTrackCue;for(let v=0;v<i.rows.length;v++)if(s=i.rows[v],o=!0,l=0,u="",!s.isEmpty()){var h;for(let R=0;R<s.chars.length;R++)ZE.test(s.chars[R].uchar)&&o?l++:(u+=s.chars[R].uchar,o=!1);s.cueStartTime=e,e===t&&(t+=1e-4),l>=16?l--:l++;const x=$m(u.trim()),_=Jc(e,t,x);n!=null&&(h=n.cues)!=null&&h.getCueById(_)||(a=new d(e,t,x),a.id=_,a.line=v+1,a.align="left",a.position=10+Math.min(80,Math.floor(l*8/32)*10),r.push(a))}return n&&r.length&&(r.sort((v,x)=>v.line==="auto"||x.line==="auto"?0:v.line>8&&x.line>8?x.line-v.line:v.line-x.line),r.forEach(v=>V0(n,v))),r}},eT={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},tT=pn(pn({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:Infinity,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:Infinity,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Qm,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:sE,bufferController:pE,capLevelController:rh,errorController:Q_,fpsController:UE,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:g0,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,certLoadPolicy:{default:eT},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:Infinity,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},iT()),{},{subtitleStreamController:dE,subtitleTrackController:hE,timelineController:FE,audioStreamController:oE,audioTrackController:lE,emeController:Da,cmcdController:ps,contentSteeringController:VE});function iT(){return{cueHandler:JE,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function nT(n,e){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const t=sh(n),i=["manifest","level","frag"],r=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return i.forEach(s=>{const a=`${s==="level"?"playlist":s}LoadPolicy`,o=e[a]===void 0,l=[];r.forEach(u=>{const d=`${s}Loading${u}`,h=e[d];if(h!==void 0&&o){l.push(d);const v=t[a].default;switch(e[a]={default:v},u){case"TimeOut":v.maxLoadTimeMs=h,v.maxTimeToFirstByteMs=h;break;case"MaxRetry":v.errorRetry.maxNumRetry=h,v.timeoutRetry.maxNumRetry=h;break;case"RetryDelay":v.errorRetry.retryDelayMs=h,v.timeoutRetry.retryDelayMs=h;break;case"MaxRetryTimeout":v.errorRetry.maxRetryDelayMs=h,v.timeoutRetry.maxRetryDelayMs=h;break}}}),l.length&&Ce.warn(`hls.js config: "${l.join('", "')}" setting(s) are deprecated, use "${a}": ${JSON.stringify(e[a])}`)}),pn(pn({},t),e)}function sh(n){return n&&typeof n=="object"?Array.isArray(n)?n.map(sh):Object.keys(n).reduce((e,t)=>(e[t]=sh(n[t]),e),{}):n}function rT(n){const e=n.loader;e!==Zm&&e!==Qm?(Ce.log("[config]: Custom loader detected, cannot enable progressive streaming"),n.progressive=!1):WE()&&(n.loader=Zm,n.progressive=!0,n.enableSoftwareAES=!0,Ce.log("[config]: Progressive streaming enabled, using FetchLoader"))}class Ns{static get version(){return"1.4.12"}static isSupported(){return gx()}static get Events(){return W}static get ErrorTypes(){return Ct}static get ErrorDetails(){return je}static get DefaultConfig(){return Ns.defaultConfig?Ns.defaultConfig:tT}static set DefaultConfig(e){Ns.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Hc,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,Gb(e.debug||!1,"Hls instance");const t=this.config=nT(Ns.DefaultConfig,e);this.userConfig=e,this._autoLevelCapping=-1,t.progressive&&rT(t);const{abrController:i,bufferController:r,capLevelController:s,errorController:a,fpsController:o}=t,l=new a(this),u=this.abrController=new i(this),d=this.bufferController=new r(this),h=this.capLevelController=new s(this),v=new o(this),x=new R_(this),_=new M_(this),R=t.contentSteeringController,N=R?new R(this):null,z=this.levelController=new J_(this,N),J=new ex(this),ue=new ix(this.config),pe=this.streamController=new nE(this,J,ue);h.setStreamController(pe),v.setStreamController(pe);const te=[x,z,pe];N&&te.splice(1,0,N),this.networkControllers=te;const ke=[u,d,h,v,_,J];this.audioTrackController=this.createController(t.audioTrackController,te);const we=t.audioStreamController;we&&te.push(new we(this,J,ue)),this.subtitleTrackController=this.createController(t.subtitleTrackController,te);const Ge=t.subtitleStreamController;Ge&&te.push(new Ge(this,J,ue)),this.createController(t.timelineController,ke),ue.emeController=this.emeController=this.createController(t.emeController,ke),this.cmcdController=this.createController(t.cmcdController,ke),this.latencyController=this.createController(N_,ke),this.coreComponents=ke,te.push(l);const Ve=l.onErrorOut;typeof Ve=="function"&&this.on(W.ERROR,Ve,l)}createController(e,t){if(e){const i=new e(this);return t&&t.push(i),i}return null}on(e,t,i=this){this._emitter.on(e,t,i)}once(e,t,i=this){this._emitter.once(e,t,i)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,i=this,r){this._emitter.off(e,t,i,r)}listeners(e){return this._emitter.listeners(e)}emit(e,t,i){return this._emitter.emit(e,t,i)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(i){Ce.error("An internal error happened while handling event "+e+'. Error message: "'+i.message+'". Here is a stacktrace:',i),this.trigger(W.ERROR,{type:Ct.OTHER_ERROR,details:je.INTERNAL_EXCEPTION,fatal:!1,event:e,error:i})}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){Ce.log("destroy"),this.trigger(W.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){Ce.log("attachMedia"),this._media=e,this.trigger(W.MEDIA_ATTACHING,{media:e})}detachMedia(){Ce.log("detachMedia"),this.trigger(W.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();const t=this.media,i=this.url,r=this.url=cc.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});Ce.log(`loadSource:${r}`),t&&i&&(i!==r||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(W.MANIFEST_LOADING,{url:e})}startLoad(e=-1){Ce.log(`startLoad(${e})`),this.networkControllers.forEach(t=>{t.startLoad(e)})}stopLoad(){Ce.log("stopLoad"),this.networkControllers.forEach(e=>{e.stopLoad()})}swapAudioCodec(){Ce.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){Ce.log("recoverMediaError");const e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e,t=0){this.levelController.removeLevel(e,t)}get levels(){const e=this.levelController.levels;return e||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){Ce.log(`set currentLevel:${e}`),this.loadLevel=e,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){Ce.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){Ce.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){Ce.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){return this.levelController.startLevel}set startLevel(e){Ce.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(Ce.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e)}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){Sc.indexOf(e)>-1&&(this._maxHdcpLevel=e)}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const i=e.length;for(let r=0;r<i;r++)if(e[r].maxBitrate>=t)return r;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:i}=this;let r;if(t===-1&&e&&e.length?r=e.length-1:r=t,i)for(let s=r;s--;){const a=e[s].attrs["HDCP-LEVEL"];if(a&&a<=i)return s}return r}get nextAutoLevel(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)}set nextAutoLevel(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}Ns.defaultConfig=void 0;var Y1=Ne(84305),sT=Ne(17187),aT=Ne.n(sT),X1=Ne(30381),Q1=Ne(76225),Z1=Ne(76959),J1=Ne(29218),eC=Ne(39183),tC=Ne(57971),iC=Ne(83839),nC=Ne(74152),en=Ne(11849),rC=Ne(80250),oT=Ne(99222),sC=new oT.Plugin({validKeys:["modifyClientRenderOpts","patchRoutes","rootContainer","render","onRouteChange","__mfsu","getInitialState","initialStateConfig","locale","layout","layoutActionRef","request"]}),lT=Ne(60145),uT=Ne(83900),dT=Ne(40378),cT=Ne(75989),hT=Ne(66078),fT=Ne(77632),pT=Ne(37974),mT=Ne(24499),gT=Ne(43267),yT=Ne(51891),vT=Ne(84218),AT=Ne(13039),bT=Ne(84378),_T=Ne(56852),xT=Ne(83142),ET=Ne(99381),Xl,Jm=!0,$r={"bn-BD":{messages:(0,en.Z)({},uT.Z),locale:"bn-BD",antd:(0,en.Z)({},lT.Z),momentLocale:"bn-bd"},"en-US":{messages:(0,en.Z)({},cT.Z),locale:"en-US",antd:(0,en.Z)({},dT.Z),momentLocale:""},"fa-IR":{messages:(0,en.Z)({},fT.Z),locale:"fa-IR",antd:(0,en.Z)({},hT.Z),momentLocale:"fa"},"id-ID":{messages:(0,en.Z)({},mT.Z),locale:"id-ID",antd:(0,en.Z)({},pT.Z),momentLocale:"id"},"ja-JP":{messages:(0,en.Z)({},yT.Z),locale:"ja-JP",antd:(0,en.Z)({},gT.Z),momentLocale:"ja"},"pt-BR":{messages:(0,en.Z)({},AT.Z),locale:"pt-BR",antd:(0,en.Z)({},vT.Z),momentLocale:"pt-br"},"zh-CN":{messages:(0,en.Z)({},_T.Z),locale:"zh-CN",antd:(0,en.Z)({},bT.Z),momentLocale:"zh-cn"},"zh-TW":{messages:(0,en.Z)({},ET.Z),locale:"zh-TW",antd:(0,en.Z)({},xT.Z),momentLocale:"zh-tw"}},aC=function(e,t,i){var r,s;if(!!e){var a=(r=$r[e])!==null&&r!==void 0&&r.messages?Object.assign({},$r[e].messages,t):t,o=i||{},l=o.momentLocale,u=o.antd,d=(s=e.split("-"))===null||s===void 0?void 0:s.join("-");$r[e]={messages:a,locale:d,momentLocale:l,antd:u},d===ah()&&event.emit(LANG_CHANGE_EVENT,d)}},TT=function(e,t){return Xl&&!t&&!e?Xl:e&&$r[e]?createIntl($r[e]):(warning(!e||!!$r[e],"The current popular language does not exist, please check the locales folder!"),$r["zh-CN"]?createIntl($r["zh-CN"]):createIntl({locale:"zh-CN",messages:{}}))},ST=function(e){Xl=TT(e,!0)},ah=function(){var e=plugin.applyPlugins({key:"locale",type:ApplyPluginsType.modify,initialValue:{}});if(typeof(e==null?void 0:e.getLocale)=="function")return e.getLocale();var t=navigator.cookieEnabled&&typeof localStorage!="undefined"&&Jm?window.localStorage.getItem("umi_locale"):"",i,r=typeof navigator!="undefined"&&typeof navigator.language=="string";return i=r?navigator.language.split("-").join("-"):"",t||i||"zh-CN"},oC=function(){var e=ah(),t=["he","ar","fa","ku"],i=t.filter(function(r){return e.startsWith(r)}).length?"rtl":"ltr";return i},lC=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=plugin.applyPlugins({key:"locale",type:ApplyPluginsType.modify,initialValue:{}}),r=function(){if(ah()!==e){if(navigator.cookieEnabled&&typeof window.localStorage!="undefined"&&Jm&&window.localStorage.setItem("umi_locale",e||""),ST(e),t)window.location.reload();else if(event.emit(LANG_CHANGE_EVENT,e),window.dispatchEvent){var a=new Event("languagechange");window.dispatchEvent(a)}}};if(typeof(i==null?void 0:i.setLocale)=="function"){i.setLocale({lang:e,realReload:t,updater:r});return}r()},eg=!0,uC=function(e,t){return eg&&(warning(!1,`Using this API will cause automatic refresh when switching languages, please use useIntl or injectIntl.

\u4F7F\u7528\u6B64 api \u4F1A\u9020\u6210\u5207\u6362\u8BED\u8A00\u7684\u65F6\u5019\u65E0\u6CD5\u81EA\u52A8\u5237\u65B0\uFF0C\u8BF7\u4F7F\u7528 useIntl \u6216 injectIntl\u3002

http://j.mp/37Fkd5Q
      `),eg=!1),Xl.formatMessage(e,t)},dC=function(){return Object.keys($r)},sr=Ne(85893),Ql=new(aT());Ql.setMaxListeners(5);var tg=Symbol("LANG_CHANGE");function cC(){var n=getLocale();if(moment!=null&&moment.locale){var e;moment.locale(((e=localeInfo[n])===null||e===void 0?void 0:e.momentLocale)||"")}setIntl(n)}var CT=typeof window!="undefined"&&typeof window.document!="undefined"&&typeof window.document.createElement!="undefined"?We.useLayoutEffect:We.useEffect,hC=function(e){var t,i=React.useState(function(){return getLocale()}),r=_slicedToArray(i,2),s=r[0],a=r[1],o=React.useState(function(){return getIntl(s,!0)}),l=_slicedToArray(o,2),u=l[0],d=l[1],h=function(R){if(moment!=null&&moment.locale){var N;moment.locale(((N=localeInfo[R])===null||N===void 0?void 0:N.momentLocale)||"en")}a(R),d(getIntl(R))};CT(function(){return Ql.on(tg,h),function(){Ql.off(tg,h)}},[]);var v={},x=getDirection();return _jsx(_ConfigProvider,{direction:x,locale:((t=localeInfo[s])===null||t===void 0?void 0:t.antd)||v,children:_jsx(RawIntlProvider,{value:u,children:e.children})})};function wT(){var n=(0,We.useRef)();return(0,We.useEffect)(function(){if(!!(n!=null&&n.current)){var e=new(Bb())({container:n==null?void 0:n.current,autoplay:!1,lang:"zh-cn",screenshot:!0,preload:"none",volume:0,hotkey:!0,video:{pic:"https://img2.baidu.com/it/u=1814561676,2470063876&fm=253&fmt=auto&app=138&f=JPEG?w=750&h=500",url:"http://222.86.87.5:9997/hls/live/cameraid/1000006%240/substream/1.m3u8",type:"customHls",customType:{customHls:function(i,r){var s=new Ns;s.loadSource(i.src),s.attachMedia(i)}}},highlight:[{time:2,text:"\u8FD9\u662F\u7B2C 2 \u79D2"},{time:120,text:"\u8FD9\u662F 2 \u5206\u949F"}],danmaku:{id:"9E2E3368B56CDBB4",api:"https://api.prprpr.me/dplayer/",token:"tokendemo",maximum:"1000",addition:["https://api.prprpr.me/dplayer/v3/bilibili?aid=4157142"],user:"DIYgod",bottom:"15%",unlimited:!0},contextmenu:[]});return e.on("canplay",function(){console.log(Ql)}),setTimeout(function(){var t,i;console.log(e.danmaku),(t=e.danmaku)===null||t===void 0||t.send({text:"zz test!!",color:"#b7daff",type:"top"},function(){console.log("send")}),(i=e.danmaku)===null||i===void 0||i.draw({text:"zz test",color:"red",type:"top"})},2e3),function(){e==null||e.destroy()}}},[]),(0,sr.jsxs)("div",{children:[(0,sr.jsx)("h1",{children:"dplayer"}),(0,sr.jsx)("div",{ref:n,style:{width:"500px",height:"500px"}})]})}var LT={url:"http://222.86.87.5:9997/hls/live/cameraid/1000006%240/substream/1.m3u8",img:"https://neijiang-test.oss-cn-chengdu.aliyuncs.com/neijiang_warning_wateraccum_snap/8F022C4RANDB420/8F022C4RANDB420_1687844782.jpg"},DT={url:"ws://test191.chinaeew.cn:5021/live/xd-001.live.flv",img:"/files/screenShoot/1659102220/109d89be-f11c-11ec-aac2-083a8891a376/20220729/1/dsf_786c2ba3-0f43-11ed-b20e-083a8891a376_27030498_27586850.jpg"};function kT(){var n=(0,We.useRef)(null),e=(0,We.useRef)(null);return(0,We.useEffect)(function(){if(!(!e.current||!n.current)){var t=Re(e.current,{controls:!0,muted:!0,techOrder:["html5","flvjs"],preload:"none",sources:[{src:LT.url,type:"application/x-mpegURL"}]}),i=Re(n.current,{controls:!0,muted:!0,preload:"none",sources:[{src:DT.url,type:"video/x-flv"}]});return function(){i==null||i.dispose(),t==null||t.dispose()}}},[]),(0,sr.jsxs)("div",{className:"video-container",children:[(0,sr.jsxs)("div",{children:[(0,sr.jsx)("h1",{children:"flv"}),(0,sr.jsx)("video",{ref:n,style:{width:"500px",height:"500px"},className:"video-js vjs-default-skin vjs-big-play-centered"})]}),(0,sr.jsxs)("div",{children:[(0,sr.jsx)("h1",{children:"hls"}),(0,sr.jsx)("video",{ref:e,style:{width:"500px",height:"500px"},className:"video-js vjs-default-skin vjs-big-play-centered"})]}),(0,sr.jsx)(wT,{})]})}},74020:function(Tt,yt,Ne){var We=Ne(34155);(function(q,Oe){Tt.exports=Oe()})(self,function(){return function(){var rt={"./node_modules/es6-promise/dist/es6-promise.js":function(ce,le,Z){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */(function(oe,V){ce.exports=V()})(this,function(){"use strict";function oe(Ue){var Ae=typeof Ue;return Ue!==null&&(Ae==="object"||Ae==="function")}function V(Ue){return typeof Ue=="function"}var A=void 0;Array.isArray?A=Array.isArray:A=function(Ae){return Object.prototype.toString.call(Ae)==="[object Array]"};var I=A,U=0,w=void 0,F=void 0,$=function(Ae,Ze){he[U]=Ae,he[U+1]=Ze,U+=2,U===2&&(F?F(_e):ve())};function C(Ue){F=Ue}function B(Ue){$=Ue}var O=typeof window!="undefined"?window:void 0,P=O||{},S=P.MutationObserver||P.WebKitMutationObserver,H=typeof self=="undefined"&&typeof We!="undefined"&&{}.toString.call(We)==="[object process]",X=typeof Uint8ClampedArray!="undefined"&&typeof importScripts!="undefined"&&typeof MessageChannel!="undefined";function ie(){return function(){return We.nextTick(_e)}}function k(){return typeof w!="undefined"?function(){w(_e)}:ne()}function j(){var Ue=0,Ae=new S(_e),Ze=document.createTextNode("");return Ae.observe(Ze,{characterData:!0}),function(){Ze.data=Ue=++Ue%2}}function Y(){var Ue=new MessageChannel;return Ue.port1.onmessage=_e,function(){return Ue.port2.postMessage(0)}}function ne(){var Ue=setTimeout;return function(){return Ue(_e,1)}}var he=new Array(1e3);function _e(){for(var Ue=0;Ue<U;Ue+=2){var Ae=he[Ue],Ze=he[Ue+1];Ae(Ze),he[Ue]=void 0,he[Ue+1]=void 0}U=0}function ye(){try{var Ue=Function("return this")().require("vertx");return w=Ue.runOnLoop||Ue.runOnContext,k()}catch(Ae){return ne()}}var ve=void 0;H?ve=ie():S?ve=j():X?ve=Y():O===void 0?ve=ye():ve=ne();function Te(Ue,Ae){var Ze=this,pt=new this.constructor(xe);pt[De]===void 0&&ki(pt);var St=Ze._state;if(St){var ze=arguments[St-1];$(function(){return Ci(St,pt,ze,Ze._result)})}else Nt(Ze,pt,Ue,Ae);return pt}function be(Ue){var Ae=this;if(Ue&&typeof Ue=="object"&&Ue.constructor===Ae)return Ue;var Ze=new Ae(xe);return It(Ze,Ue),Ze}var De=Math.random().toString(36).substring(2);function xe(){}var qe=void 0,vt=1,st=2;function Xe(){return new TypeError("You cannot resolve a promise with itself")}function Ye(){return new TypeError("A promises callback cannot return that same promise.")}function Ft(Ue,Ae,Ze,pt){try{Ue.call(Ae,Ze,pt)}catch(St){return St}}function lt(Ue,Ae,Ze){$(function(pt){var St=!1,ze=Ft(Ze,Ae,function(hi){St||(St=!0,Ae!==hi?It(pt,hi):Zt(pt,hi))},function(hi){St||(St=!0,at(pt,hi))},"Settle: "+(pt._label||" unknown promise"));!St&&ze&&(St=!0,at(pt,ze))},Ue)}function _t(Ue,Ae){Ae._state===vt?Zt(Ue,Ae._result):Ae._state===st?at(Ue,Ae._result):Nt(Ae,void 0,function(Ze){return It(Ue,Ze)},function(Ze){return at(Ue,Ze)})}function Mt(Ue,Ae,Ze){Ae.constructor===Ue.constructor&&Ze===Te&&Ae.constructor.resolve===be?_t(Ue,Ae):Ze===void 0?Zt(Ue,Ae):V(Ze)?lt(Ue,Ae,Ze):Zt(Ue,Ae)}function It(Ue,Ae){if(Ue===Ae)at(Ue,Xe());else if(oe(Ae)){var Ze=void 0;try{Ze=Ae.then}catch(pt){at(Ue,pt);return}Mt(Ue,Ae,Ze)}else Zt(Ue,Ae)}function Jt(Ue){Ue._onerror&&Ue._onerror(Ue._result),$t(Ue)}function Zt(Ue,Ae){Ue._state===qe&&(Ue._result=Ae,Ue._state=vt,Ue._subscribers.length!==0&&$($t,Ue))}function at(Ue,Ae){Ue._state===qe&&(Ue._state=st,Ue._result=Ae,$(Jt,Ue))}function Nt(Ue,Ae,Ze,pt){var St=Ue._subscribers,ze=St.length;Ue._onerror=null,St[ze]=Ae,St[ze+vt]=Ze,St[ze+st]=pt,ze===0&&Ue._state&&$($t,Ue)}function $t(Ue){var Ae=Ue._subscribers,Ze=Ue._state;if(Ae.length!==0){for(var pt=void 0,St=void 0,ze=Ue._result,hi=0;hi<Ae.length;hi+=3)pt=Ae[hi],St=Ae[hi+Ze],pt?Ci(Ze,pt,St,ze):St(ze);Ue._subscribers.length=0}}function Ci(Ue,Ae,Ze,pt){var St=V(Ze),ze=void 0,hi=void 0,tn=!0;if(St){try{ze=Ze(pt)}catch(nn){tn=!1,hi=nn}if(Ae===ze){at(Ae,Ye());return}}else ze=pt;Ae._state!==qe||(St&&tn?It(Ae,ze):tn===!1?at(Ae,hi):Ue===vt?Zt(Ae,ze):Ue===st&&at(Ae,ze))}function Gi(Ue,Ae){try{Ae(function(pt){It(Ue,pt)},function(pt){at(Ue,pt)})}catch(Ze){at(Ue,Ze)}}var Pi=0;function Mi(){return Pi++}function ki(Ue){Ue[De]=Pi++,Ue._state=void 0,Ue._result=void 0,Ue._subscribers=[]}function Ht(){return new Error("Array Methods must be provided an Array")}var tt=function(){function Ue(Ae,Ze){this._instanceConstructor=Ae,this.promise=new Ae(xe),this.promise[De]||ki(this.promise),I(Ze)?(this.length=Ze.length,this._remaining=Ze.length,this._result=new Array(this.length),this.length===0?Zt(this.promise,this._result):(this.length=this.length||0,this._enumerate(Ze),this._remaining===0&&Zt(this.promise,this._result))):at(this.promise,Ht())}return Ue.prototype._enumerate=function(Ze){for(var pt=0;this._state===qe&&pt<Ze.length;pt++)this._eachEntry(Ze[pt],pt)},Ue.prototype._eachEntry=function(Ze,pt){var St=this._instanceConstructor,ze=St.resolve;if(ze===be){var hi=void 0,tn=void 0,nn=!1;try{hi=Ze.then}catch(_n){nn=!0,tn=_n}if(hi===Te&&Ze._state!==qe)this._settledAt(Ze._state,pt,Ze._result);else if(typeof hi!="function")this._remaining--,this._result[pt]=Ze;else if(St===Ri){var bn=new St(xe);nn?at(bn,tn):Mt(bn,Ze,hi),this._willSettleAt(bn,pt)}else this._willSettleAt(new St(function(_n){return _n(Ze)}),pt)}else this._willSettleAt(ze(Ze),pt)},Ue.prototype._settledAt=function(Ze,pt,St){var ze=this.promise;ze._state===qe&&(this._remaining--,Ze===st?at(ze,St):this._result[pt]=St),this._remaining===0&&Zt(ze,this._result)},Ue.prototype._willSettleAt=function(Ze,pt){var St=this;Nt(Ze,void 0,function(ze){return St._settledAt(vt,pt,ze)},function(ze){return St._settledAt(st,pt,ze)})},Ue}();function ni(Ue){return new tt(this,Ue).promise}function Ii(Ue){var Ae=this;return I(Ue)?new Ae(function(Ze,pt){for(var St=Ue.length,ze=0;ze<St;ze++)Ae.resolve(Ue[ze]).then(Ze,pt)}):new Ae(function(Ze,pt){return pt(new TypeError("You must pass an array to race."))})}function ei(Ue){var Ae=this,Ze=new Ae(xe);return at(Ze,Ue),Ze}function lr(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function Cr(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var Ri=function(){function Ue(Ae){this[De]=Mi(),this._result=this._state=void 0,this._subscribers=[],xe!==Ae&&(typeof Ae!="function"&&lr(),this instanceof Ue?Gi(this,Ae):Cr())}return Ue.prototype.catch=function(Ze){return this.then(null,Ze)},Ue.prototype.finally=function(Ze){var pt=this,St=pt.constructor;return V(Ze)?pt.then(function(ze){return St.resolve(Ze()).then(function(){return ze})},function(ze){return St.resolve(Ze()).then(function(){throw ze})}):pt.then(Ze,Ze)},Ue}();Ri.prototype.then=Te,Ri.all=ni,Ri.race=Ii,Ri.resolve=be,Ri.reject=ei,Ri._setScheduler=C,Ri._setAsap=B,Ri._asap=$;function Hs(){var Ue=void 0;if(typeof Z.g!="undefined")Ue=Z.g;else if(typeof self!="undefined")Ue=self;else try{Ue=Function("return this")()}catch(pt){throw new Error("polyfill failed because global object is unavailable in this environment")}var Ae=Ue.Promise;if(Ae){var Ze=null;try{Ze=Object.prototype.toString.call(Ae.resolve())}catch(pt){}if(Ze==="[object Promise]"&&!Ae.cast)return}Ue.Promise=Ri}return Ri.polyfill=Hs,Ri.Promise=Ri,Ri})},"./node_modules/events/events.js":function(ce){"use strict";var le=typeof Reflect=="object"?Reflect:null,Z=le&&typeof le.apply=="function"?le.apply:function(ne,he,_e){return Function.prototype.apply.call(ne,he,_e)},oe;le&&typeof le.ownKeys=="function"?oe=le.ownKeys:Object.getOwnPropertySymbols?oe=function(ne){return Object.getOwnPropertyNames(ne).concat(Object.getOwnPropertySymbols(ne))}:oe=function(ne){return Object.getOwnPropertyNames(ne)};function V(Y){console&&console.warn&&console.warn(Y)}var A=Number.isNaN||function(ne){return ne!==ne};function I(){I.init.call(this)}ce.exports=I,ce.exports.once=ie,I.EventEmitter=I,I.prototype._events=void 0,I.prototype._eventsCount=0,I.prototype._maxListeners=void 0;var U=10;function w(Y){if(typeof Y!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof Y)}Object.defineProperty(I,"defaultMaxListeners",{enumerable:!0,get:function(){return U},set:function(ne){if(typeof ne!="number"||ne<0||A(ne))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+ne+".");U=ne}}),I.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},I.prototype.setMaxListeners=function(ne){if(typeof ne!="number"||ne<0||A(ne))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+ne+".");return this._maxListeners=ne,this};function F(Y){return Y._maxListeners===void 0?I.defaultMaxListeners:Y._maxListeners}I.prototype.getMaxListeners=function(){return F(this)},I.prototype.emit=function(ne){for(var he=[],_e=1;_e<arguments.length;_e++)he.push(arguments[_e]);var ye=ne==="error",ve=this._events;if(ve!==void 0)ye=ye&&ve.error===void 0;else if(!ye)return!1;if(ye){var Te;if(he.length>0&&(Te=he[0]),Te instanceof Error)throw Te;var be=new Error("Unhandled error."+(Te?" ("+Te.message+")":""));throw be.context=Te,be}var De=ve[ne];if(De===void 0)return!1;if(typeof De=="function")Z(De,this,he);else for(var xe=De.length,qe=S(De,xe),_e=0;_e<xe;++_e)Z(qe[_e],this,he);return!0};function $(Y,ne,he,_e){var ye,ve,Te;if(w(he),ve=Y._events,ve===void 0?(ve=Y._events=Object.create(null),Y._eventsCount=0):(ve.newListener!==void 0&&(Y.emit("newListener",ne,he.listener?he.listener:he),ve=Y._events),Te=ve[ne]),Te===void 0)Te=ve[ne]=he,++Y._eventsCount;else if(typeof Te=="function"?Te=ve[ne]=_e?[he,Te]:[Te,he]:_e?Te.unshift(he):Te.push(he),ye=F(Y),ye>0&&Te.length>ye&&!Te.warned){Te.warned=!0;var be=new Error("Possible EventEmitter memory leak detected. "+Te.length+" "+String(ne)+" listeners added. Use emitter.setMaxListeners() to increase limit");be.name="MaxListenersExceededWarning",be.emitter=Y,be.type=ne,be.count=Te.length,V(be)}return Y}I.prototype.addListener=function(ne,he){return $(this,ne,he,!1)},I.prototype.on=I.prototype.addListener,I.prototype.prependListener=function(ne,he){return $(this,ne,he,!0)};function C(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function B(Y,ne,he){var _e={fired:!1,wrapFn:void 0,target:Y,type:ne,listener:he},ye=C.bind(_e);return ye.listener=he,_e.wrapFn=ye,ye}I.prototype.once=function(ne,he){return w(he),this.on(ne,B(this,ne,he)),this},I.prototype.prependOnceListener=function(ne,he){return w(he),this.prependListener(ne,B(this,ne,he)),this},I.prototype.removeListener=function(ne,he){var _e,ye,ve,Te,be;if(w(he),ye=this._events,ye===void 0)return this;if(_e=ye[ne],_e===void 0)return this;if(_e===he||_e.listener===he)--this._eventsCount==0?this._events=Object.create(null):(delete ye[ne],ye.removeListener&&this.emit("removeListener",ne,_e.listener||he));else if(typeof _e!="function"){for(ve=-1,Te=_e.length-1;Te>=0;Te--)if(_e[Te]===he||_e[Te].listener===he){be=_e[Te].listener,ve=Te;break}if(ve<0)return this;ve===0?_e.shift():H(_e,ve),_e.length===1&&(ye[ne]=_e[0]),ye.removeListener!==void 0&&this.emit("removeListener",ne,be||he)}return this},I.prototype.off=I.prototype.removeListener,I.prototype.removeAllListeners=function(ne){var he,_e,ye;if(_e=this._events,_e===void 0)return this;if(_e.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):_e[ne]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete _e[ne]),this;if(arguments.length===0){var ve=Object.keys(_e),Te;for(ye=0;ye<ve.length;++ye)Te=ve[ye],Te!=="removeListener"&&this.removeAllListeners(Te);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(he=_e[ne],typeof he=="function")this.removeListener(ne,he);else if(he!==void 0)for(ye=he.length-1;ye>=0;ye--)this.removeListener(ne,he[ye]);return this};function O(Y,ne,he){var _e=Y._events;if(_e===void 0)return[];var ye=_e[ne];return ye===void 0?[]:typeof ye=="function"?he?[ye.listener||ye]:[ye]:he?X(ye):S(ye,ye.length)}I.prototype.listeners=function(ne){return O(this,ne,!0)},I.prototype.rawListeners=function(ne){return O(this,ne,!1)},I.listenerCount=function(Y,ne){return typeof Y.listenerCount=="function"?Y.listenerCount(ne):P.call(Y,ne)},I.prototype.listenerCount=P;function P(Y){var ne=this._events;if(ne!==void 0){var he=ne[Y];if(typeof he=="function")return 1;if(he!==void 0)return he.length}return 0}I.prototype.eventNames=function(){return this._eventsCount>0?oe(this._events):[]};function S(Y,ne){for(var he=new Array(ne),_e=0;_e<ne;++_e)he[_e]=Y[_e];return he}function H(Y,ne){for(;ne+1<Y.length;ne++)Y[ne]=Y[ne+1];Y.pop()}function X(Y){for(var ne=new Array(Y.length),he=0;he<ne.length;++he)ne[he]=Y[he].listener||Y[he];return ne}function ie(Y,ne){return new Promise(function(he,_e){function ye(Te){Y.removeListener(ne,ve),_e(Te)}function ve(){typeof Y.removeListener=="function"&&Y.removeListener("error",ye),he([].slice.call(arguments))}j(Y,ne,ve,{once:!0}),ne!=="error"&&k(Y,ye,{once:!0})})}function k(Y,ne,he){typeof Y.on=="function"&&j(Y,"error",ne,he)}function j(Y,ne,he,_e){if(typeof Y.on=="function")_e.once?Y.once(ne,he):Y.on(ne,he);else if(typeof Y.addEventListener=="function")Y.addEventListener(ne,function ye(ve){_e.once&&Y.removeEventListener(ne,ye),he(ve)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof Y)}},"./node_modules/webworkify-webpack/index.js":function(ce,le,Z){function oe(C){var B={};function O(S){if(B[S])return B[S].exports;var H=B[S]={i:S,l:!1,exports:{}};return C[S].call(H.exports,H,H.exports,O),H.l=!0,H.exports}O.m=C,O.c=B,O.i=function(S){return S},O.d=function(S,H,X){O.o(S,H)||Object.defineProperty(S,H,{configurable:!1,enumerable:!0,get:X})},O.r=function(S){Object.defineProperty(S,"__esModule",{value:!0})},O.n=function(S){var H=S&&S.__esModule?function(){return S.default}:function(){return S};return O.d(H,"a",H),H},O.o=function(S,H){return Object.prototype.hasOwnProperty.call(S,H)},O.p="/",O.oe=function(S){throw console.error(S),S};var P=O(O.s=ENTRY_MODULE);return P.default||P}var V="[\\.|\\-|\\+|\\w|/|@]+",A="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+V+").*?\\)";function I(C){return(C+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function U(C){return!isNaN(1*C)}function w(C,B,O){var P={};P[O]=[];var S=B.toString(),H=S.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!H)return P;for(var X=H[1],ie=new RegExp("(\\\\n|\\W)"+I(X)+A,"g"),k;k=ie.exec(S);)k[3]!=="dll-reference"&&P[O].push(k[3]);for(ie=new RegExp("\\("+I(X)+'\\("(dll-reference\\s('+V+'))"\\)\\)'+A,"g");k=ie.exec(S);)C[k[2]]||(P[O].push(k[1]),C[k[2]]=Z(k[1]).m),P[k[2]]=P[k[2]]||[],P[k[2]].push(k[4]);for(var j=Object.keys(P),Y=0;Y<j.length;Y++)for(var ne=0;ne<P[j[Y]].length;ne++)U(P[j[Y]][ne])&&(P[j[Y]][ne]=1*P[j[Y]][ne]);return P}function F(C){var B=Object.keys(C);return B.reduce(function(O,P){return O||C[P].length>0},!1)}function $(C,B){for(var O={main:[B]},P={main:[]},S={main:{}};F(O);)for(var H=Object.keys(O),X=0;X<H.length;X++){var ie=H[X],k=O[ie],j=k.pop();if(S[ie]=S[ie]||{},!(S[ie][j]||!C[ie][j])){S[ie][j]=!0,P[ie]=P[ie]||[],P[ie].push(j);for(var Y=w(C,C[ie][j],ie),ne=Object.keys(Y),he=0;he<ne.length;he++)O[ne[he]]=O[ne[he]]||[],O[ne[he]]=O[ne[he]].concat(Y[ne[he]])}}return P}ce.exports=function(C,B){B=B||{};var O={main:Z.m},P=B.all?{main:Object.keys(O.main)}:$(O,C),S="";Object.keys(P).filter(function(j){return j!=="main"}).forEach(function(j){for(var Y=0;P[j][Y];)Y++;P[j].push(Y),O[j][Y]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",S=S+"var "+j+" = ("+oe.toString().replace("ENTRY_MODULE",JSON.stringify(Y))+")({"+P[j].map(function(ne){return""+JSON.stringify(ne)+": "+O[j][ne].toString()}).join(",")+`});
`}),S=S+"new (("+oe.toString().replace("ENTRY_MODULE",JSON.stringify(C))+")({"+P.main.map(function(j){return""+JSON.stringify(j)+": "+O.main[j].toString()}).join(",")+"}))(self);";var H=new window.Blob([S],{type:"text/javascript"});if(B.bare)return H;var X=window.URL||window.webkitURL||window.mozURL||window.msURL,ie=X.createObjectURL(H),k=new window.Worker(ie);return k.objectURL=ie,k}},"./src/config.js":function(ce,le,Z){"use strict";Z.r(le),Z.d(le,{defaultConfig:function(){return oe},createDefaultConfig:function(){return V}});var oe={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,lazyLoad:!0,lazyLoadMaxDuration:3*60,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:3*60,autoCleanupMinBackwardDuration:2*60,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function V(){return Object.assign({},oe)}},"./src/core/features.js":function(ce,le,Z){"use strict";Z.r(le);var oe=Z("./src/io/io-controller.js"),V=Z("./src/config.js"),A=function(){function I(){}return I.supportMSEH264Playback=function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')},I.supportNetworkStreamIO=function(){var U=new oe.default({},(0,V.createDefaultConfig)()),w=U.loaderType;return U.destroy(),w=="fetch-stream-loader"||w=="xhr-moz-chunked-loader"},I.getNetworkLoaderTypeName=function(){var U=new oe.default({},(0,V.createDefaultConfig)()),w=U.loaderType;return U.destroy(),w},I.supportNativeMediaPlayback=function(U){I.videoElement==null&&(I.videoElement=window.document.createElement("video"));var w=I.videoElement.canPlayType(U);return w==="probably"||w=="maybe"},I.getFeatureList=function(){var U={mseFlvPlayback:!1,mseLiveFlvPlayback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return U.mseFlvPlayback=I.supportMSEH264Playback(),U.networkStreamIO=I.supportNetworkStreamIO(),U.networkLoaderName=I.getNetworkLoaderTypeName(),U.mseLiveFlvPlayback=U.mseFlvPlayback&&U.networkStreamIO,U.nativeMP4H264Playback=I.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),U.nativeWebmVP8Playback=I.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),U.nativeWebmVP9Playback=I.supportNativeMediaPlayback('video/webm; codecs="vp9"'),U},I}();le.default=A},"./src/core/media-info.js":function(ce,le,Z){"use strict";Z.r(le);var oe=function(){function V(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return V.prototype.isComplete=function(){var A=this.hasAudio===!1||this.hasAudio===!0&&this.audioCodec!=null&&this.audioSampleRate!=null&&this.audioChannelCount!=null,I=this.hasVideo===!1||this.hasVideo===!0&&this.videoCodec!=null&&this.width!=null&&this.height!=null&&this.fps!=null&&this.profile!=null&&this.level!=null&&this.refFrames!=null&&this.chromaFormat!=null&&this.sarNum!=null&&this.sarDen!=null;return this.mimeType!=null&&this.duration!=null&&this.metadata!=null&&this.hasKeyframesIndex!=null&&A&&I},V.prototype.isSeekable=function(){return this.hasKeyframesIndex===!0},V.prototype.getNearestKeyframe=function(A){if(this.keyframesIndex==null)return null;var I=this.keyframesIndex,U=this._search(I.times,A);return{index:U,milliseconds:I.times[U],fileposition:I.filepositions[U]}},V.prototype._search=function(A,I){var U=0,w=A.length-1,F=0,$=0,C=w;for(I<A[0]&&(U=0,$=C+1);$<=C;)if(F=$+Math.floor((C-$)/2),F===w||I>=A[F]&&I<A[F+1]){U=F;break}else A[F]<I?$=F+1:C=F-1;return U},V}();le.default=oe},"./src/core/media-segment-info.js":function(ce,le,Z){"use strict";Z.r(le),Z.d(le,{SampleInfo:function(){return oe},MediaSegmentInfo:function(){return V},IDRSampleList:function(){return A},MediaSegmentInfoList:function(){return I}});var oe=function(){function U(w,F,$,C,B){this.dts=w,this.pts=F,this.duration=$,this.originalDts=C,this.isSyncPoint=B,this.fileposition=null}return U}(),V=function(){function U(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return U.prototype.appendSyncPoint=function(w){w.isSyncPoint=!0,this.syncPoints.push(w)},U}(),A=function(){function U(){this._list=[]}return U.prototype.clear=function(){this._list=[]},U.prototype.appendArray=function(w){var F=this._list;w.length!==0&&(F.length>0&&w[0].originalDts<F[F.length-1].originalDts&&this.clear(),Array.prototype.push.apply(F,w))},U.prototype.getLastSyncPointBeforeDts=function(w){if(this._list.length==0)return null;var F=this._list,$=0,C=F.length-1,B=0,O=0,P=C;for(w<F[0].dts&&($=0,O=P+1);O<=P;)if(B=O+Math.floor((P-O)/2),B===C||w>=F[B].dts&&w<F[B+1].dts){$=B;break}else F[B].dts<w?O=B+1:P=B-1;return this._list[$]},U}(),I=function(){function U(w){this._type=w,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(U.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),U.prototype.isEmpty=function(){return this._list.length===0},U.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},U.prototype._searchNearestSegmentBefore=function(w){var F=this._list;if(F.length===0)return-2;var $=F.length-1,C=0,B=0,O=$,P=0;if(w<F[0].originalBeginDts)return P=-1,P;for(;B<=O;)if(C=B+Math.floor((O-B)/2),C===$||w>F[C].lastSample.originalDts&&w<F[C+1].originalBeginDts){P=C;break}else F[C].originalBeginDts<w?B=C+1:O=C-1;return P},U.prototype._searchNearestSegmentAfter=function(w){return this._searchNearestSegmentBefore(w)+1},U.prototype.append=function(w){var F=this._list,$=w,C=this._lastAppendLocation,B=0;C!==-1&&C<F.length&&$.originalBeginDts>=F[C].lastSample.originalDts&&(C===F.length-1||C<F.length-1&&$.originalBeginDts<F[C+1].originalBeginDts)?B=C+1:F.length>0&&(B=this._searchNearestSegmentBefore($.originalBeginDts)+1),this._lastAppendLocation=B,this._list.splice(B,0,$)},U.prototype.getLastSegmentBefore=function(w){var F=this._searchNearestSegmentBefore(w);return F>=0?this._list[F]:null},U.prototype.getLastSampleBefore=function(w){var F=this.getLastSegmentBefore(w);return F!=null?F.lastSample:null},U.prototype.getLastSyncPointBefore=function(w){for(var F=this._searchNearestSegmentBefore(w),$=this._list[F].syncPoints;$.length===0&&F>0;)F--,$=this._list[F].syncPoints;return $.length>0?$[$.length-1]:null},U}()},"./src/core/mse-controller.js":function(ce,le,Z){"use strict";Z.r(le);var oe=Z("./node_modules/events/events.js"),V=Z.n(oe),A=Z("./src/utils/logger.js"),I=Z("./src/utils/browser.js"),U=Z("./src/core/mse-events.js"),w=Z("./src/core/media-segment-info.js"),F=Z("./src/utils/exception.js"),$=function(){function C(B){this.TAG="MSEController",this._config=B,this._emitter=new(V()),this._config.isLive&&this._config.autoCleanupSourceBuffer==null&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new w.IDRSampleList}return C.prototype.destroy=function(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},C.prototype.on=function(B,O){this._emitter.addListener(B,O)},C.prototype.off=function(B,O){this._emitter.removeListener(B,O)},C.prototype.attachMediaElement=function(B){if(this._mediaSource)throw new F.IllegalStateException("MediaSource has been attached to an HTMLMediaElement!");var O=this._mediaSource=new window.MediaSource;O.addEventListener("sourceopen",this.e.onSourceOpen),O.addEventListener("sourceended",this.e.onSourceEnded),O.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=B,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),B.src=this._mediaSourceObjectURL},C.prototype.detachMediaElement=function(){if(this._mediaSource){var B=this._mediaSource;for(var O in this._sourceBuffers){var P=this._pendingSegments[O];P.splice(0,P.length),this._pendingSegments[O]=null,this._pendingRemoveRanges[O]=null,this._lastInitSegments[O]=null;var S=this._sourceBuffers[O];if(S){if(B.readyState!=="closed"){try{B.removeSourceBuffer(S)}catch(H){A.default.e(this.TAG,H.message)}S.removeEventListener("error",this.e.onSourceBufferError),S.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[O]=null,this._sourceBuffers[O]=null}}if(B.readyState==="open")try{B.endOfStream()}catch(H){A.default.e(this.TAG,H.message)}B.removeEventListener("sourceopen",this.e.onSourceOpen),B.removeEventListener("sourceended",this.e.onSourceEnded),B.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},C.prototype.appendInitSegment=function(B,O){if(!this._mediaSource||this._mediaSource.readyState!=="open"){this._pendingSourceBufferInit.push(B),this._pendingSegments[B.type].push(B);return}var P=B,S=""+P.container;P.codec&&P.codec.length>0&&(S+=";codecs="+P.codec);var H=!1;if(A.default.v(this.TAG,"Received Initialization Segment, mimeType: "+S),this._lastInitSegments[P.type]=P,S!==this._mimeTypes[P.type]){if(this._mimeTypes[P.type])A.default.v(this.TAG,"Notice: "+P.type+" mimeType changed, origin: "+this._mimeTypes[P.type]+", target: "+S);else{H=!0;try{var X=this._sourceBuffers[P.type]=this._mediaSource.addSourceBuffer(S);X.addEventListener("error",this.e.onSourceBufferError),X.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(ie){A.default.e(this.TAG,ie.message),this._emitter.emit(U.default.ERROR,{code:ie.code,msg:ie.message});return}}this._mimeTypes[P.type]=S}O||this._pendingSegments[P.type].push(P),H||this._sourceBuffers[P.type]&&!this._sourceBuffers[P.type].updating&&this._doAppendSegments(),I.default.safari&&P.container==="audio/mpeg"&&P.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=P.mediaDuration/1e3,this._updateMediaSourceDuration())},C.prototype.appendMediaSegment=function(B){var O=B;this._pendingSegments[O.type].push(O),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var P=this._sourceBuffers[O.type];P&&!P.updating&&!this._hasPendingRemoveRanges()&&this._doAppendSegments()},C.prototype.seek=function(B){for(var O in this._sourceBuffers)if(!!this._sourceBuffers[O]){var P=this._sourceBuffers[O];if(this._mediaSource.readyState==="open")try{P.abort()}catch(j){A.default.e(this.TAG,j.message)}this._idrList.clear();var S=this._pendingSegments[O];if(S.splice(0,S.length),this._mediaSource.readyState!=="closed"){for(var H=0;H<P.buffered.length;H++){var X=P.buffered.start(H),ie=P.buffered.end(H);this._pendingRemoveRanges[O].push({start:X,end:ie})}if(P.updating||this._doRemoveRanges(),I.default.safari){var k=this._lastInitSegments[O];k&&(this._pendingSegments[O].push(k),P.updating||this._doAppendSegments())}}}},C.prototype.endOfStream=function(){var B=this._mediaSource,O=this._sourceBuffers;if(!B||B.readyState!=="open"){B&&B.readyState==="closed"&&this._hasPendingSegments()&&(this._hasPendingEos=!0);return}O.video&&O.video.updating||O.audio&&O.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,B.endOfStream())},C.prototype.getNearestKeyframe=function(B){return this._idrList.getLastSyncPointBeforeDts(B)},C.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var B=this._mediaElement.currentTime;for(var O in this._sourceBuffers){var P=this._sourceBuffers[O];if(P){var S=P.buffered;if(S.length>=1&&B-S.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},C.prototype._doCleanupSourceBuffer=function(){var B=this._mediaElement.currentTime;for(var O in this._sourceBuffers){var P=this._sourceBuffers[O];if(P){for(var S=P.buffered,H=!1,X=0;X<S.length;X++){var ie=S.start(X),k=S.end(X);if(ie<=B&&B<k+3){if(B-ie>=this._config.autoCleanupMaxBackwardDuration){H=!0;var j=B-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[O].push({start:ie,end:j})}}else k<B&&(H=!0,this._pendingRemoveRanges[O].push({start:ie,end:k}))}H&&!P.updating&&this._doRemoveRanges()}}},C.prototype._updateMediaSourceDuration=function(){var B=this._sourceBuffers;if(!(this._mediaElement.readyState===0||this._mediaSource.readyState!=="open")&&!(B.video&&B.video.updating||B.audio&&B.audio.updating)){var O=this._mediaSource.duration,P=this._pendingMediaDuration;P>0&&(isNaN(O)||P>O)&&(A.default.v(this.TAG,"Update MediaSource duration from "+O+" to "+P),this._mediaSource.duration=P),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},C.prototype._doRemoveRanges=function(){for(var B in this._pendingRemoveRanges)if(!(!this._sourceBuffers[B]||this._sourceBuffers[B].updating))for(var O=this._sourceBuffers[B],P=this._pendingRemoveRanges[B];P.length&&!O.updating;){var S=P.shift();O.remove(S.start,S.end)}},C.prototype._doAppendSegments=function(){var B=this._pendingSegments;for(var O in B)if(!(!this._sourceBuffers[O]||this._sourceBuffers[O].updating)&&B[O].length>0){var P=B[O].shift();if(P.timestampOffset){var S=this._sourceBuffers[O].timestampOffset,H=P.timestampOffset/1e3,X=Math.abs(S-H);X>.1&&(A.default.v(this.TAG,"Update MPEG audio timestampOffset from "+S+" to "+H),this._sourceBuffers[O].timestampOffset=H),delete P.timestampOffset}if(!P.data||P.data.byteLength===0)continue;try{this._sourceBuffers[O].appendBuffer(P.data),this._isBufferFull=!1,O==="video"&&P.hasOwnProperty("info")&&this._idrList.appendArray(P.info.syncPoints)}catch(ie){this._pendingSegments[O].unshift(P),ie.code===22?(this._isBufferFull||this._emitter.emit(U.default.BUFFER_FULL),this._isBufferFull=!0):(A.default.e(this.TAG,ie.message),this._emitter.emit(U.default.ERROR,{code:ie.code,msg:ie.message}))}}},C.prototype._onSourceOpen=function(){if(A.default.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var B=this._pendingSourceBufferInit;B.length;){var O=B.shift();this.appendInitSegment(O,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(U.default.SOURCE_OPEN)},C.prototype._onSourceEnded=function(){A.default.v(this.TAG,"MediaSource onSourceEnded")},C.prototype._onSourceClose=function(){A.default.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&this.e!=null&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))},C.prototype._hasPendingSegments=function(){var B=this._pendingSegments;return B.video.length>0||B.audio.length>0},C.prototype._hasPendingRemoveRanges=function(){var B=this._pendingRemoveRanges;return B.video.length>0||B.audio.length>0},C.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(U.default.UPDATE_END)},C.prototype._onSourceBufferError=function(B){A.default.e(this.TAG,"SourceBuffer Error: "+B)},C}();le.default=$},"./src/core/mse-events.js":function(ce,le,Z){"use strict";Z.r(le);var oe={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"};le.default=oe},"./src/core/transmuxer.js":function(ce,le,Z){"use strict";Z.r(le);var oe=Z("./node_modules/events/events.js"),V=Z.n(oe),A=Z("./node_modules/webworkify-webpack/index.js"),I=Z.n(A),U=Z("./src/utils/logger.js"),w=Z("./src/utils/logging-control.js"),F=Z("./src/core/transmuxing-controller.js"),$=Z("./src/core/transmuxing-events.js"),C=Z("./src/core/media-info.js"),B=function(){function O(P,S){if(this.TAG="Transmuxer",this._emitter=new(V()),S.enableWorker&&typeof Worker!="undefined")try{this._worker=I()("./src/core/transmuxing-worker.js"),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[P,S]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},w.default.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:w.default.getConfig()})}catch(X){U.default.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new F.default(P,S)}else this._controller=new F.default(P,S);if(this._controller){var H=this._controller;H.on($.default.IO_ERROR,this._onIOError.bind(this)),H.on($.default.DEMUX_ERROR,this._onDemuxError.bind(this)),H.on($.default.INIT_SEGMENT,this._onInitSegment.bind(this)),H.on($.default.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),H.on($.default.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),H.on($.default.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),H.on($.default.MEDIA_INFO,this._onMediaInfo.bind(this)),H.on($.default.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),H.on($.default.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),H.on($.default.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),H.on($.default.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return O.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),w.default.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},O.prototype.on=function(P,S){this._emitter.addListener(P,S)},O.prototype.off=function(P,S){this._emitter.removeListener(P,S)},O.prototype.hasWorker=function(){return this._worker!=null},O.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},O.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},O.prototype.seek=function(P){this._worker?this._worker.postMessage({cmd:"seek",param:P}):this._controller.seek(P)},O.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},O.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},O.prototype._onInitSegment=function(P,S){var H=this;Promise.resolve().then(function(){H._emitter.emit($.default.INIT_SEGMENT,P,S)})},O.prototype._onMediaSegment=function(P,S){var H=this;Promise.resolve().then(function(){H._emitter.emit($.default.MEDIA_SEGMENT,P,S)})},O.prototype._onLoadingComplete=function(){var P=this;Promise.resolve().then(function(){P._emitter.emit($.default.LOADING_COMPLETE)})},O.prototype._onRecoveredEarlyEof=function(){var P=this;Promise.resolve().then(function(){P._emitter.emit($.default.RECOVERED_EARLY_EOF)})},O.prototype._onMediaInfo=function(P){var S=this;Promise.resolve().then(function(){S._emitter.emit($.default.MEDIA_INFO,P)})},O.prototype._onMetaDataArrived=function(P){var S=this;Promise.resolve().then(function(){S._emitter.emit($.default.METADATA_ARRIVED,P)})},O.prototype._onScriptDataArrived=function(P){var S=this;Promise.resolve().then(function(){S._emitter.emit($.default.SCRIPTDATA_ARRIVED,P)})},O.prototype._onStatisticsInfo=function(P){var S=this;Promise.resolve().then(function(){S._emitter.emit($.default.STATISTICS_INFO,P)})},O.prototype._onIOError=function(P,S){var H=this;Promise.resolve().then(function(){H._emitter.emit($.default.IO_ERROR,P,S)})},O.prototype._onDemuxError=function(P,S){var H=this;Promise.resolve().then(function(){H._emitter.emit($.default.DEMUX_ERROR,P,S)})},O.prototype._onRecommendSeekpoint=function(P){var S=this;Promise.resolve().then(function(){S._emitter.emit($.default.RECOMMEND_SEEKPOINT,P)})},O.prototype._onLoggingConfigChanged=function(P){this._worker&&this._worker.postMessage({cmd:"logging_config",param:P})},O.prototype._onWorkerMessage=function(P){var S=P.data,H=S.data;if(S.msg==="destroyed"||this._workerDestroying){this._workerDestroying=!1,this._worker.terminate(),this._worker=null;return}switch(S.msg){case $.default.INIT_SEGMENT:case $.default.MEDIA_SEGMENT:this._emitter.emit(S.msg,H.type,H.data);break;case $.default.LOADING_COMPLETE:case $.default.RECOVERED_EARLY_EOF:this._emitter.emit(S.msg);break;case $.default.MEDIA_INFO:Object.setPrototypeOf(H,C.default.prototype),this._emitter.emit(S.msg,H);break;case $.default.METADATA_ARRIVED:case $.default.SCRIPTDATA_ARRIVED:case $.default.STATISTICS_INFO:this._emitter.emit(S.msg,H);break;case $.default.IO_ERROR:case $.default.DEMUX_ERROR:this._emitter.emit(S.msg,H.type,H.info);break;case $.default.RECOMMEND_SEEKPOINT:this._emitter.emit(S.msg,H);break;case"logcat_callback":U.default.emitter.emit("log",H.type,H.logcat);break;default:break}},O}();le.default=B},"./src/core/transmuxing-controller.js":function(ce,le,Z){"use strict";Z.r(le);var oe=Z("./node_modules/events/events.js"),V=Z.n(oe),A=Z("./src/utils/logger.js"),I=Z("./src/utils/browser.js"),U=Z("./src/core/media-info.js"),w=Z("./src/demux/flv-demuxer.js"),F=Z("./src/remux/mp4-remuxer.js"),$=Z("./src/demux/demux-errors.js"),C=Z("./src/io/io-controller.js"),B=Z("./src/core/transmuxing-events.js"),O=function(){function P(S,H){this.TAG="TransmuxingController",this._emitter=new(V()),this._config=H,S.segments||(S.segments=[{duration:S.duration,filesize:S.filesize,url:S.url}]),typeof S.cors!="boolean"&&(S.cors=!0),typeof S.withCredentials!="boolean"&&(S.withCredentials=!1),this._mediaDataSource=S,this._currentSegmentIndex=0;var X=0;this._mediaDataSource.segments.forEach(function(ie){ie.timestampBase=X,X+=ie.duration,ie.cors=S.cors,ie.withCredentials=S.withCredentials,H.referrerPolicy&&(ie.referrerPolicy=H.referrerPolicy)}),!isNaN(X)&&this._mediaDataSource.duration!==X&&(this._mediaDataSource.duration=X),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return P.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},P.prototype.on=function(S,H){this._emitter.addListener(S,H)},P.prototype.off=function(S,H){this._emitter.removeListener(S,H)},P.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},P.prototype._loadSegment=function(S,H){this._currentSegmentIndex=S;var X=this._mediaDataSource.segments[S],ie=this._ioctl=new C.default(X,this._config,S);ie.onError=this._onIOException.bind(this),ie.onSeeked=this._onIOSeeked.bind(this),ie.onComplete=this._onIOComplete.bind(this),ie.onRedirect=this._onIORedirect.bind(this),ie.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),H?this._demuxer.bindDataSource(this._ioctl):ie.onDataArrival=this._onInitChunkArrival.bind(this),ie.open(H)},P.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},P.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},P.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},P.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},P.prototype.seek=function(S){if(!(this._mediaInfo==null||!this._mediaInfo.isSeekable())){var H=this._searchSegmentIndexContains(S);if(H===this._currentSegmentIndex){var X=this._mediaInfo.segments[H];if(X==null)this._pendingSeekTime=S;else{var ie=X.getNearestKeyframe(S);this._remuxer.seek(ie.milliseconds),this._ioctl.seek(ie.fileposition),this._pendingResolveSeekPoint=ie.milliseconds}}else{var k=this._mediaInfo.segments[H];if(k==null)this._pendingSeekTime=S,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(H);else{var ie=k.getNearestKeyframe(S);this._internalAbort(),this._remuxer.seek(S),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[H].timestampBase,this._loadSegment(H,ie.fileposition),this._pendingResolveSeekPoint=ie.milliseconds,this._reportSegmentMediaInfo(H)}}this._enableStatisticsReporter()}},P.prototype._searchSegmentIndexContains=function(S){for(var H=this._mediaDataSource.segments,X=H.length-1,ie=0;ie<H.length;ie++)if(S<H[ie].timestampBase){X=ie-1;break}return X},P.prototype._onInitChunkArrival=function(S,H){var X=this,ie=null,k=0;if(H>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,k=this._demuxer.parseChunks(S,H);else if((ie=w.default.probe(S)).match){this._demuxer=new w.default(ie,this._config),this._remuxer||(this._remuxer=new F.default(this._config));var j=this._mediaDataSource;j.duration!=null&&!isNaN(j.duration)&&(this._demuxer.overridedDuration=j.duration),typeof j.hasAudio=="boolean"&&(this._demuxer.overridedHasAudio=j.hasAudio),typeof j.hasVideo=="boolean"&&(this._demuxer.overridedHasVideo=j.hasVideo),this._demuxer.timestampBase=j.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this),k=this._demuxer.parseChunks(S,H)}else ie=null,A.default.e(this.TAG,"Non-FLV, Unsupported media type!"),Promise.resolve().then(function(){X._internalAbort()}),this._emitter.emit(B.default.DEMUX_ERROR,$.default.FORMAT_UNSUPPORTED,"Non-FLV, Unsupported media type"),k=0;return k},P.prototype._onMediaInfo=function(S){var H=this;this._mediaInfo==null&&(this._mediaInfo=Object.assign({},S),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,U.default.prototype));var X=Object.assign({},S);Object.setPrototypeOf(X,U.default.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=X,this._reportSegmentMediaInfo(this._currentSegmentIndex),this._pendingSeekTime!=null&&Promise.resolve().then(function(){var ie=H._pendingSeekTime;H._pendingSeekTime=null,H.seek(ie)})},P.prototype._onMetaDataArrived=function(S){this._emitter.emit(B.default.METADATA_ARRIVED,S)},P.prototype._onScriptDataArrived=function(S){this._emitter.emit(B.default.SCRIPTDATA_ARRIVED,S)},P.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},P.prototype._onIOComplete=function(S){var H=S,X=H+1;X<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer.flushStashedSamples(),this._loadSegment(X)):(this._remuxer.flushStashedSamples(),this._emitter.emit(B.default.LOADING_COMPLETE),this._disableStatisticsReporter())},P.prototype._onIORedirect=function(S){var H=this._ioctl.extraData;this._mediaDataSource.segments[H].redirectedURL=S},P.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(B.default.RECOVERED_EARLY_EOF)},P.prototype._onIOException=function(S,H){A.default.e(this.TAG,"IOException: type = "+S+", code = "+H.code+", msg = "+H.msg),this._emitter.emit(B.default.IO_ERROR,S,H),this._disableStatisticsReporter()},P.prototype._onDemuxException=function(S,H){A.default.e(this.TAG,"DemuxException: type = "+S+", info = "+H),this._emitter.emit(B.default.DEMUX_ERROR,S,H)},P.prototype._onRemuxerInitSegmentArrival=function(S,H){this._emitter.emit(B.default.INIT_SEGMENT,S,H)},P.prototype._onRemuxerMediaSegmentArrival=function(S,H){if(this._pendingSeekTime==null&&(this._emitter.emit(B.default.MEDIA_SEGMENT,S,H),this._pendingResolveSeekPoint!=null&&S==="video")){var X=H.info.syncPoints,ie=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,I.default.safari&&X.length>0&&X[0].originalDts===ie&&(ie=X[0].pts),this._emitter.emit(B.default.RECOMMEND_SEEKPOINT,ie)}},P.prototype._enableStatisticsReporter=function(){this._statisticsReporter==null&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},P.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},P.prototype._reportSegmentMediaInfo=function(S){var H=this._mediaInfo.segments[S],X=Object.assign({},H);X.duration=this._mediaInfo.duration,X.segmentCount=this._mediaInfo.segmentCount,delete X.segments,delete X.keyframesIndex,this._emitter.emit(B.default.MEDIA_INFO,X)},P.prototype._reportStatisticsInfo=function(){var S={};S.url=this._ioctl.currentURL,S.hasRedirect=this._ioctl.hasRedirect,S.hasRedirect&&(S.redirectedURL=this._ioctl.currentRedirectedURL),S.speed=this._ioctl.currentSpeed,S.loaderType=this._ioctl.loaderType,S.currentSegmentIndex=this._currentSegmentIndex,S.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(B.default.STATISTICS_INFO,S)},P}();le.default=O},"./src/core/transmuxing-events.js":function(ce,le,Z){"use strict";Z.r(le);var oe={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint"};le.default=oe},"./src/core/transmuxing-worker.js":function(ce,le,Z){"use strict";Z.r(le);var oe=Z("./src/utils/logging-control.js"),V=Z("./src/utils/polyfill.js"),A=Z("./src/core/transmuxing-controller.js"),I=Z("./src/core/transmuxing-events.js"),U=function(F){var $="TransmuxingWorker",C=null,B=_e.bind(this);V.default.install(),F.addEventListener("message",function(ye){switch(ye.data.cmd){case"init":C=new A.default(ye.data.param[0],ye.data.param[1]),C.on(I.default.IO_ERROR,Y.bind(this)),C.on(I.default.DEMUX_ERROR,ne.bind(this)),C.on(I.default.INIT_SEGMENT,O.bind(this)),C.on(I.default.MEDIA_SEGMENT,P.bind(this)),C.on(I.default.LOADING_COMPLETE,S.bind(this)),C.on(I.default.RECOVERED_EARLY_EOF,H.bind(this)),C.on(I.default.MEDIA_INFO,X.bind(this)),C.on(I.default.METADATA_ARRIVED,ie.bind(this)),C.on(I.default.SCRIPTDATA_ARRIVED,k.bind(this)),C.on(I.default.STATISTICS_INFO,j.bind(this)),C.on(I.default.RECOMMEND_SEEKPOINT,he.bind(this));break;case"destroy":C&&(C.destroy(),C=null),F.postMessage({msg:"destroyed"});break;case"start":C.start();break;case"stop":C.stop();break;case"seek":C.seek(ye.data.param);break;case"pause":C.pause();break;case"resume":C.resume();break;case"logging_config":{var ve=ye.data.param;oe.default.applyConfig(ve),ve.enableCallback===!0?oe.default.addLogListener(B):oe.default.removeLogListener(B);break}}});function O(ye,ve){var Te={msg:I.default.INIT_SEGMENT,data:{type:ye,data:ve}};F.postMessage(Te,[ve.data])}function P(ye,ve){var Te={msg:I.default.MEDIA_SEGMENT,data:{type:ye,data:ve}};F.postMessage(Te,[ve.data])}function S(){var ye={msg:I.default.LOADING_COMPLETE};F.postMessage(ye)}function H(){var ye={msg:I.default.RECOVERED_EARLY_EOF};F.postMessage(ye)}function X(ye){var ve={msg:I.default.MEDIA_INFO,data:ye};F.postMessage(ve)}function ie(ye){var ve={msg:I.default.METADATA_ARRIVED,data:ye};F.postMessage(ve)}function k(ye){var ve={msg:I.default.SCRIPTDATA_ARRIVED,data:ye};F.postMessage(ve)}function j(ye){var ve={msg:I.default.STATISTICS_INFO,data:ye};F.postMessage(ve)}function Y(ye,ve){F.postMessage({msg:I.default.IO_ERROR,data:{type:ye,info:ve}})}function ne(ye,ve){F.postMessage({msg:I.default.DEMUX_ERROR,data:{type:ye,info:ve}})}function he(ye){F.postMessage({msg:I.default.RECOMMEND_SEEKPOINT,data:ye})}function _e(ye,ve){F.postMessage({msg:"logcat_callback",data:{type:ye,logcat:ve}})}};le.default=U},"./src/demux/amf-parser.js":function(ce,le,Z){"use strict";Z.r(le);var oe=Z("./src/utils/logger.js"),V=Z("./src/utils/utf8-conv.js"),A=Z("./src/utils/exception.js"),I=function(){var w=new ArrayBuffer(2);return new DataView(w).setInt16(0,256,!0),new Int16Array(w)[0]===256}(),U=function(){function w(){}return w.parseScriptData=function(F,$,C){var B={};try{var O=w.parseValue(F,$,C),P=w.parseValue(F,$+O.size,C-O.size);B[O.data]=P.data}catch(S){oe.default.e("AMF",S.toString())}return B},w.parseObject=function(F,$,C){if(C<3)throw new A.IllegalStateException("Data not enough when parse ScriptDataObject");var B=w.parseString(F,$,C),O=w.parseValue(F,$+B.size,C-B.size),P=O.objectEnd;return{data:{name:B.data,value:O.data},size:B.size+O.size,objectEnd:P}},w.parseVariable=function(F,$,C){return w.parseObject(F,$,C)},w.parseString=function(F,$,C){if(C<2)throw new A.IllegalStateException("Data not enough when parse String");var B=new DataView(F,$,C),O=B.getUint16(0,!I),P;return O>0?P=(0,V.default)(new Uint8Array(F,$+2,O)):P="",{data:P,size:2+O}},w.parseLongString=function(F,$,C){if(C<4)throw new A.IllegalStateException("Data not enough when parse LongString");var B=new DataView(F,$,C),O=B.getUint32(0,!I),P;return O>0?P=(0,V.default)(new Uint8Array(F,$+4,O)):P="",{data:P,size:4+O}},w.parseDate=function(F,$,C){if(C<10)throw new A.IllegalStateException("Data size invalid when parse Date");var B=new DataView(F,$,C),O=B.getFloat64(0,!I),P=B.getInt16(8,!I);return O+=P*60*1e3,{data:new Date(O),size:8+2}},w.parseValue=function(F,$,C){if(C<1)throw new A.IllegalStateException("Data not enough when parse Value");var B=new DataView(F,$,C),O=1,P=B.getUint8(0),S,H=!1;try{switch(P){case 0:S=B.getFloat64(1,!I),O+=8;break;case 1:{var X=B.getUint8(1);S=!!X,O+=1;break}case 2:{var ie=w.parseString(F,$+1,C-1);S=ie.data,O+=ie.size;break}case 3:{S={};var k=0;for((B.getUint32(C-4,!I)&16777215)==9&&(k=3);O<C-4;){var j=w.parseObject(F,$+O,C-O-k);if(j.objectEnd)break;S[j.data.name]=j.data.value,O+=j.size}if(O<=C-3){var Y=B.getUint32(O-1,!I)&16777215;Y===9&&(O+=3)}break}case 8:{S={},O+=4;var k=0;for((B.getUint32(C-4,!I)&16777215)==9&&(k=3);O<C-8;){var ne=w.parseVariable(F,$+O,C-O-k);if(ne.objectEnd)break;S[ne.data.name]=ne.data.value,O+=ne.size}if(O<=C-3){var Y=B.getUint32(O-1,!I)&16777215;Y===9&&(O+=3)}break}case 9:S=void 0,O=1,H=!0;break;case 10:{S=[];var he=B.getUint32(1,!I);O+=4;for(var _e=0;_e<he;_e++){var ye=w.parseValue(F,$+O,C-O);S.push(ye.data),O+=ye.size}break}case 11:{var ve=w.parseDate(F,$+1,C-1);S=ve.data,O+=ve.size;break}case 12:{var Te=w.parseString(F,$+1,C-1);S=Te.data,O+=Te.size;break}default:O=C,oe.default.w("AMF","Unsupported AMF value type "+P)}}catch(be){oe.default.e("AMF",be.toString())}return{data:S,size:O,objectEnd:H}},w}();le.default=U},"./src/demux/demux-errors.js":function(ce,le,Z){"use strict";Z.r(le);var oe={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"};le.default=oe},"./src/demux/exp-golomb.js":function(ce,le,Z){"use strict";Z.r(le);var oe=Z("./src/utils/exception.js"),V=function(){function A(I){this.TAG="ExpGolomb",this._buffer=I,this._buffer_index=0,this._total_bytes=I.byteLength,this._total_bits=I.byteLength*8,this._current_word=0,this._current_word_bits_left=0}return A.prototype.destroy=function(){this._buffer=null},A.prototype._fillCurrentWord=function(){var I=this._total_bytes-this._buffer_index;if(I<=0)throw new oe.IllegalStateException("ExpGolomb: _fillCurrentWord() but no bytes available");var U=Math.min(4,I),w=new Uint8Array(4);w.set(this._buffer.subarray(this._buffer_index,this._buffer_index+U)),this._current_word=new DataView(w.buffer).getUint32(0,!1),this._buffer_index+=U,this._current_word_bits_left=U*8},A.prototype.readBits=function(I){if(I>32)throw new oe.InvalidArgumentException("ExpGolomb: readBits() bits exceeded max 32bits!");if(I<=this._current_word_bits_left){var U=this._current_word>>>32-I;return this._current_word<<=I,this._current_word_bits_left-=I,U}var w=this._current_word_bits_left?this._current_word:0;w=w>>>32-this._current_word_bits_left;var F=I-this._current_word_bits_left;this._fillCurrentWord();var $=Math.min(F,this._current_word_bits_left),C=this._current_word>>>32-$;return this._current_word<<=$,this._current_word_bits_left-=$,w=w<<$|C,w},A.prototype.readBool=function(){return this.readBits(1)===1},A.prototype.readByte=function(){return this.readBits(8)},A.prototype._skipLeadingZero=function(){var I;for(I=0;I<this._current_word_bits_left;I++)if((this._current_word&2147483648>>>I)!=0)return this._current_word<<=I,this._current_word_bits_left-=I,I;return this._fillCurrentWord(),I+this._skipLeadingZero()},A.prototype.readUEG=function(){var I=this._skipLeadingZero();return this.readBits(I+1)-1},A.prototype.readSEG=function(){var I=this.readUEG();return I&1?I+1>>>1:-1*(I>>>1)},A}();le.default=V},"./src/demux/flv-demuxer.js":function(ce,le,Z){"use strict";Z.r(le);var oe=Z("./src/utils/logger.js"),V=Z("./src/demux/amf-parser.js"),A=Z("./src/demux/sps-parser.js"),I=Z("./src/demux/demux-errors.js"),U=Z("./src/core/media-info.js"),w=Z("./src/utils/exception.js");function F(O){return O>>>8&255|(O&255)<<8}function $(O){return(O&4278190080)>>>24|(O&16711680)>>>8|(O&65280)<<8|(O&255)<<24}function C(O,P){return O[P]<<24|O[P+1]<<16|O[P+2]<<8|O[P+3]}var B=function(){function O(P,S){this.TAG="FLVDemuxer",this._config=S,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=P.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=P.hasAudioTrack,this._hasVideo=P.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new U.default,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var H=new ArrayBuffer(2);return new DataView(H).setInt16(0,256,!0),new Int16Array(H)[0]===256}()}return O.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},O.probe=function(P){var S=new Uint8Array(P),H={match:!1};if(S[0]!==70||S[1]!==76||S[2]!==86||S[3]!==1)return H;var X=(S[4]&4)>>>2!=0,ie=(S[4]&1)!=0,k=C(S,5);return k<9?H:{match:!0,consumed:k,dataOffset:k,hasAudioTrack:X,hasVideoTrack:ie}},O.prototype.bindDataSource=function(P){return P.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(O.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(S){this._onTrackMetadata=S},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(S){this._onMediaInfo=S},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(S){this._onMetaDataArrived=S},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(S){this._onScriptDataArrived=S},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"onError",{get:function(){return this._onError},set:function(S){this._onError=S},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(S){this._onDataAvailable=S},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(S){this._timestampBase=S},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"overridedDuration",{get:function(){return this._duration},set:function(S){this._durationOverrided=!0,this._duration=S,this._mediaInfo.duration=S},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"overridedHasAudio",{set:function(S){this._hasAudioFlagOverrided=!0,this._hasAudio=S,this._mediaInfo.hasAudio=S},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"overridedHasVideo",{set:function(S){this._hasVideoFlagOverrided=!0,this._hasVideo=S,this._mediaInfo.hasVideo=S},enumerable:!1,configurable:!0}),O.prototype.resetMediaInfo=function(){this._mediaInfo=new U.default},O.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!this._hasAudio&&this._hasVideo?this._videoInitialMetadataDispatched:!1},O.prototype.parseChunks=function(P,S){if(!this._onError||!this._onMediaInfo||!this._onTrackMetadata||!this._onDataAvailable)throw new w.IllegalStateException("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var H=0,X=this._littleEndian;if(S===0)if(P.byteLength>13){var ie=O.probe(P);H=ie.dataOffset}else return 0;if(this._firstParse){this._firstParse=!1,S+H!==this._dataOffset&&oe.default.w(this.TAG,"First time parsing but chunk byteStart invalid!");var k=new DataView(P,H),j=k.getUint32(0,!X);j!==0&&oe.default.w(this.TAG,"PrevTagSize0 !== 0 !!!"),H+=4}for(;H<P.byteLength;){this._dispatch=!0;var k=new DataView(P,H);if(H+11+4>P.byteLength)break;var Y=k.getUint8(0),ne=k.getUint32(0,!X)&16777215;if(H+11+ne+4>P.byteLength)break;if(Y!==8&&Y!==9&&Y!==18){oe.default.w(this.TAG,"Unsupported tag type "+Y+", skipped"),H+=11+ne+4;continue}var he=k.getUint8(4),_e=k.getUint8(5),ye=k.getUint8(6),ve=k.getUint8(7),Te=ye|_e<<8|he<<16|ve<<24,be=k.getUint32(7,!X)&16777215;be!==0&&oe.default.w(this.TAG,"Meet tag which has StreamID != 0!");var De=H+11;switch(Y){case 8:this._parseAudioData(P,De,ne,Te);break;case 9:this._parseVideoData(P,De,ne,Te,S+H);break;case 18:this._parseScriptData(P,De,ne);break}var xe=k.getUint32(11+ne,!X);xe!==11+ne&&oe.default.w(this.TAG,"Invalid PrevTagSize "+xe),H+=11+ne+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),H},O.prototype._parseScriptData=function(P,S,H){var X=V.default.parseScriptData(P,S,H);if(X.hasOwnProperty("onMetaData")){if(X.onMetaData==null||typeof X.onMetaData!="object"){oe.default.w(this.TAG,"Invalid onMetaData structure!");return}this._metadata&&oe.default.w(this.TAG,"Found another onMetaData tag!"),this._metadata=X;var ie=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},ie)),typeof ie.hasAudio=="boolean"&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=ie.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),typeof ie.hasVideo=="boolean"&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=ie.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),typeof ie.audiodatarate=="number"&&(this._mediaInfo.audioDataRate=ie.audiodatarate),typeof ie.videodatarate=="number"&&(this._mediaInfo.videoDataRate=ie.videodatarate),typeof ie.width=="number"&&(this._mediaInfo.width=ie.width),typeof ie.height=="number"&&(this._mediaInfo.height=ie.height),typeof ie.duration=="number"){if(!this._durationOverrided){var k=Math.floor(ie.duration*this._timescale);this._duration=k,this._mediaInfo.duration=k}}else this._mediaInfo.duration=0;if(typeof ie.framerate=="number"){var j=Math.floor(ie.framerate*1e3);if(j>0){var Y=j/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=Y,this._referenceFrameRate.fps_num=j,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=Y}}if(typeof ie.keyframes=="object"){this._mediaInfo.hasKeyframesIndex=!0;var ne=ie.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(ne),ie.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=ie,oe.default.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(X).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},X))},O.prototype._parseKeyframesIndex=function(P){for(var S=[],H=[],X=1;X<P.times.length;X++){var ie=this._timestampBase+Math.floor(P.times[X]*1e3);S.push(ie),H.push(P.filepositions[X])}return{times:S,filepositions:H}},O.prototype._parseAudioData=function(P,S,H,X){if(H<=1){oe.default.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");return}if(!(this._hasAudioFlagOverrided===!0&&this._hasAudio===!1)){var ie=this._littleEndian,k=new DataView(P,S,H),j=k.getUint8(0),Y=j>>>4;if(Y!==2&&Y!==10){this._onError(I.default.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+Y);return}var ne=0,he=(j&12)>>>2;if(he>=0&&he<=4)ne=this._flvSoundRateTable[he];else{this._onError(I.default.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+he);return}var _e=(j&2)>>>1,ye=j&1,ve=this._audioMetadata,Te=this._audioTrack;if(ve||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),ve=this._audioMetadata={},ve.type="audio",ve.id=Te.id,ve.timescale=this._timescale,ve.duration=this._duration,ve.audioSampleRate=ne,ve.channelCount=ye===0?1:2),Y===10){var be=this._parseAACAudioData(P,S+1,H-1);if(be==null)return;if(be.packetType===0){ve.config&&oe.default.w(this.TAG,"Found another AudioSpecificConfig!");var De=be.data;ve.audioSampleRate=De.samplingRate,ve.channelCount=De.channelCount,ve.codec=De.codec,ve.originalCodec=De.originalCodec,ve.config=De.config,ve.refSampleDuration=1024/ve.audioSampleRate*ve.timescale,oe.default.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",ve);var xe=this._mediaInfo;xe.audioCodec=ve.originalCodec,xe.audioSampleRate=ve.audioSampleRate,xe.audioChannelCount=ve.channelCount,xe.hasVideo?xe.videoCodec!=null&&(xe.mimeType='video/x-flv; codecs="'+xe.videoCodec+","+xe.audioCodec+'"'):xe.mimeType='video/x-flv; codecs="'+xe.audioCodec+'"',xe.isComplete()&&this._onMediaInfo(xe)}else if(be.packetType===1){var qe=this._timestampBase+X,vt={unit:be.data,length:be.data.byteLength,dts:qe,pts:qe};Te.samples.push(vt),Te.length+=be.data.length}else oe.default.e(this.TAG,"Flv: Unsupported AAC data type "+be.packetType)}else if(Y===2){if(!ve.codec){var De=this._parseMP3AudioData(P,S+1,H-1,!0);if(De==null)return;ve.audioSampleRate=De.samplingRate,ve.channelCount=De.channelCount,ve.codec=De.codec,ve.originalCodec=De.originalCodec,ve.refSampleDuration=1152/ve.audioSampleRate*ve.timescale,oe.default.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",ve);var xe=this._mediaInfo;xe.audioCodec=ve.codec,xe.audioSampleRate=ve.audioSampleRate,xe.audioChannelCount=ve.channelCount,xe.audioDataRate=De.bitRate,xe.hasVideo?xe.videoCodec!=null&&(xe.mimeType='video/x-flv; codecs="'+xe.videoCodec+","+xe.audioCodec+'"'):xe.mimeType='video/x-flv; codecs="'+xe.audioCodec+'"',xe.isComplete()&&this._onMediaInfo(xe)}var st=this._parseMP3AudioData(P,S+1,H-1,!1);if(st==null)return;var qe=this._timestampBase+X,Xe={unit:st,length:st.byteLength,dts:qe,pts:qe};Te.samples.push(Xe),Te.length+=st.length}}},O.prototype._parseAACAudioData=function(P,S,H){if(H<=1){oe.default.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!");return}var X={},ie=new Uint8Array(P,S,H);return X.packetType=ie[0],ie[0]===0?X.data=this._parseAACAudioSpecificConfig(P,S+1,H-1):X.data=ie.subarray(1),X},O.prototype._parseAACAudioSpecificConfig=function(P,S,H){var X=new Uint8Array(P,S,H),ie=null,k=0,j=0,Y=null,ne=0,he=null;if(k=j=X[0]>>>3,ne=(X[0]&7)<<1|X[1]>>>7,ne<0||ne>=this._mpegSamplingRates.length){this._onError(I.default.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");return}var _e=this._mpegSamplingRates[ne],ye=(X[1]&120)>>>3;if(ye<0||ye>=8){this._onError(I.default.FORMAT_ERROR,"Flv: AAC invalid channel configuration");return}k===5&&(he=(X[1]&7)<<1|X[2]>>>7,Y=(X[2]&124)>>>2);var ve=self.navigator.userAgent.toLowerCase();return ve.indexOf("firefox")!==-1?ne>=6?(k=5,ie=new Array(4),he=ne-3):(k=2,ie=new Array(2),he=ne):ve.indexOf("android")!==-1?(k=2,ie=new Array(2),he=ne):(k=5,he=ne,ie=new Array(4),ne>=6?he=ne-3:ye===1&&(k=2,ie=new Array(2),he=ne)),ie[0]=k<<3,ie[0]|=(ne&15)>>>1,ie[1]=(ne&15)<<7,ie[1]|=(ye&15)<<3,k===5&&(ie[1]|=(he&15)>>>1,ie[2]=(he&1)<<7,ie[2]|=2<<2,ie[3]=0),{config:ie,samplingRate:_e,channelCount:ye,codec:"mp4a.40."+k,originalCodec:"mp4a.40."+j}},O.prototype._parseMP3AudioData=function(P,S,H,X){if(H<4){oe.default.w(this.TAG,"Flv: Invalid MP3 packet, header missing!");return}var ie=this._littleEndian,k=new Uint8Array(P,S,H),j=null;if(X){if(k[0]!==255)return;var Y=k[1]>>>3&3,ne=(k[1]&6)>>1,he=(k[2]&240)>>>4,_e=(k[2]&12)>>>2,ye=k[3]>>>6&3,ve=ye!==3?2:1,Te=0,be=0,De=34,xe="mp3";switch(Y){case 0:Te=this._mpegAudioV25SampleRateTable[_e];break;case 2:Te=this._mpegAudioV20SampleRateTable[_e];break;case 3:Te=this._mpegAudioV10SampleRateTable[_e];break}switch(ne){case 1:De=34,he<this._mpegAudioL3BitRateTable.length&&(be=this._mpegAudioL3BitRateTable[he]);break;case 2:De=33,he<this._mpegAudioL2BitRateTable.length&&(be=this._mpegAudioL2BitRateTable[he]);break;case 3:De=32,he<this._mpegAudioL1BitRateTable.length&&(be=this._mpegAudioL1BitRateTable[he]);break}j={bitRate:be,samplingRate:Te,channelCount:ve,codec:xe,originalCodec:xe}}else j=k;return j},O.prototype._parseVideoData=function(P,S,H,X,ie){if(H<=1){oe.default.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");return}if(!(this._hasVideoFlagOverrided===!0&&this._hasVideo===!1)){var k=new Uint8Array(P,S,H)[0],j=(k&240)>>>4,Y=k&15;if(Y!==7){this._onError(I.default.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+Y);return}this._parseAVCVideoPacket(P,S+1,H-1,X,ie,j)}},O.prototype._parseAVCVideoPacket=function(P,S,H,X,ie,k){if(H<4){oe.default.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");return}var j=this._littleEndian,Y=new DataView(P,S,H),ne=Y.getUint8(0),he=Y.getUint32(0,!j)&16777215,_e=he<<8>>8;if(ne===0)this._parseAVCDecoderConfigurationRecord(P,S+4,H-4);else if(ne===1)this._parseAVCVideoData(P,S+4,H-4,X,ie,k,_e);else if(ne!==2){this._onError(I.default.FORMAT_ERROR,"Flv: Invalid video packet type "+ne);return}},O.prototype._parseAVCDecoderConfigurationRecord=function(P,S,H){if(H<7){oe.default.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");return}var X=this._videoMetadata,ie=this._videoTrack,k=this._littleEndian,j=new DataView(P,S,H);X?typeof X.avcc!="undefined"&&oe.default.w(this.TAG,"Found another AVCDecoderConfigurationRecord!"):(this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),X=this._videoMetadata={},X.type="video",X.id=ie.id,X.timescale=this._timescale,X.duration=this._duration);var Y=j.getUint8(0),ne=j.getUint8(1),he=j.getUint8(2),_e=j.getUint8(3);if(Y!==1||ne===0){this._onError(I.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord");return}if(this._naluLengthSize=(j.getUint8(4)&3)+1,this._naluLengthSize!==3&&this._naluLengthSize!==4){this._onError(I.default.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));return}var ye=j.getUint8(5)&31;if(ye===0){this._onError(I.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS");return}else ye>1&&oe.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+ye);for(var ve=6,Te=0;Te<ye;Te++){var be=j.getUint16(ve,!k);if(ve+=2,be!==0){var De=new Uint8Array(P,S+ve,be);ve+=be;var xe=A.default.parseSPS(De);if(Te===0){X.codecWidth=xe.codec_size.width,X.codecHeight=xe.codec_size.height,X.presentWidth=xe.present_size.width,X.presentHeight=xe.present_size.height,X.profile=xe.profile_string,X.level=xe.level_string,X.bitDepth=xe.bit_depth,X.chromaFormat=xe.chroma_format,X.sarRatio=xe.sar_ratio,X.frameRate=xe.frame_rate,(xe.frame_rate.fixed===!1||xe.frame_rate.fps_num===0||xe.frame_rate.fps_den===0)&&(X.frameRate=this._referenceFrameRate);var qe=X.frameRate.fps_den,vt=X.frameRate.fps_num;X.refSampleDuration=X.timescale*(qe/vt);for(var st=De.subarray(1,4),Xe="avc1.",Ye=0;Ye<3;Ye++){var Ft=st[Ye].toString(16);Ft.length<2&&(Ft="0"+Ft),Xe+=Ft}X.codec=Xe;var lt=this._mediaInfo;lt.width=X.codecWidth,lt.height=X.codecHeight,lt.fps=X.frameRate.fps,lt.profile=X.profile,lt.level=X.level,lt.refFrames=xe.ref_frames,lt.chromaFormat=xe.chroma_format_string,lt.sarNum=X.sarRatio.width,lt.sarDen=X.sarRatio.height,lt.videoCodec=Xe,lt.hasAudio?lt.audioCodec!=null&&(lt.mimeType='video/x-flv; codecs="'+lt.videoCodec+","+lt.audioCodec+'"'):lt.mimeType='video/x-flv; codecs="'+lt.videoCodec+'"',lt.isComplete()&&this._onMediaInfo(lt)}}}var _t=j.getUint8(ve);if(_t===0){this._onError(I.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS");return}else _t>1&&oe.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = "+_t);ve++;for(var Te=0;Te<_t;Te++){var be=j.getUint16(ve,!k);ve+=2,be!==0&&(ve+=be)}X.avcc=new Uint8Array(H),X.avcc.set(new Uint8Array(P,S,H),0),oe.default.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",X)},O.prototype._parseAVCVideoData=function(P,S,H,X,ie,k,j){for(var Y=this._littleEndian,ne=new DataView(P,S,H),he=[],_e=0,ye=0,ve=this._naluLengthSize,Te=this._timestampBase+X,be=k===1;ye<H;){if(ye+4>=H){oe.default.w(this.TAG,"Malformed Nalu near timestamp "+Te+", offset = "+ye+", dataSize = "+H);break}var De=ne.getUint32(ye,!Y);if(ve===3&&(De>>>=8),De>H-ve){oe.default.w(this.TAG,"Malformed Nalus near timestamp "+Te+", NaluSize > DataSize!");return}var xe=ne.getUint8(ye+ve)&31;xe===5&&(be=!0);var qe=new Uint8Array(P,S+ye,ve+De),vt={type:xe,data:qe};he.push(vt),_e+=qe.byteLength,ye+=ve+De}if(he.length){var st=this._videoTrack,Xe={units:he,length:_e,isKeyframe:be,dts:Te,cts:j,pts:Te+j};be&&(Xe.fileposition=ie),st.samples.push(Xe),st.length+=_e}},O}();le.default=B},"./src/demux/sps-parser.js":function(ce,le,Z){"use strict";Z.r(le);var oe=Z("./src/demux/exp-golomb.js"),V=function(){function A(){}return A._ebsp2rbsp=function(I){for(var U=I,w=U.byteLength,F=new Uint8Array(w),$=0,C=0;C<w;C++)C>=2&&U[C]===3&&U[C-1]===0&&U[C-2]===0||(F[$]=U[C],$++);return new Uint8Array(F.buffer,0,$)},A.parseSPS=function(I){var U=A._ebsp2rbsp(I),w=new oe.default(U);w.readByte();var F=w.readByte();w.readByte();var $=w.readByte();w.readUEG();var C=A.getProfileString(F),B=A.getLevelString($),O=1,P=420,S=[0,420,422,444],H=8;if((F===100||F===110||F===122||F===244||F===44||F===83||F===86||F===118||F===128||F===138||F===144)&&(O=w.readUEG(),O===3&&w.readBits(1),O<=3&&(P=S[O]),H=w.readUEG()+8,w.readUEG(),w.readBits(1),w.readBool()))for(var X=O!==3?8:12,ie=0;ie<X;ie++)w.readBool()&&(ie<6?A._skipScalingList(w,16):A._skipScalingList(w,64));w.readUEG();var k=w.readUEG();if(k===0)w.readUEG();else if(k===1){w.readBits(1),w.readSEG(),w.readSEG();for(var j=w.readUEG(),ie=0;ie<j;ie++)w.readSEG()}var Y=w.readUEG();w.readBits(1);var ne=w.readUEG(),he=w.readUEG(),_e=w.readBits(1);_e===0&&w.readBits(1),w.readBits(1);var ye=0,ve=0,Te=0,be=0,De=w.readBool();De&&(ye=w.readUEG(),ve=w.readUEG(),Te=w.readUEG(),be=w.readUEG());var xe=1,qe=1,vt=0,st=!0,Xe=0,Ye=0,Ft=w.readBool();if(Ft){if(w.readBool()){var lt=w.readByte(),_t=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],Mt=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];lt>0&&lt<16?(xe=_t[lt-1],qe=Mt[lt-1]):lt===255&&(xe=w.readByte()<<8|w.readByte(),qe=w.readByte()<<8|w.readByte())}if(w.readBool()&&w.readBool(),w.readBool()&&(w.readBits(4),w.readBool()&&w.readBits(24)),w.readBool()&&(w.readUEG(),w.readUEG()),w.readBool()){var It=w.readBits(32),Jt=w.readBits(32);st=w.readBool(),Xe=Jt,Ye=It*2,vt=Xe/Ye}}var Zt=1;(xe!==1||qe!==1)&&(Zt=xe/qe);var at=0,Nt=0;if(O===0)at=1,Nt=2-_e;else{var $t=O===3?1:2,Ci=O===1?2:1;at=$t,Nt=Ci*(2-_e)}var Gi=(ne+1)*16,Pi=(2-_e)*((he+1)*16);Gi-=(ye+ve)*at,Pi-=(Te+be)*Nt;var Mi=Math.ceil(Gi*Zt);return w.destroy(),w=null,{profile_string:C,level_string:B,bit_depth:H,ref_frames:Y,chroma_format:P,chroma_format_string:A.getChromaFormatString(P),frame_rate:{fixed:st,fps:vt,fps_den:Ye,fps_num:Xe},sar_ratio:{width:xe,height:qe},codec_size:{width:Gi,height:Pi},present_size:{width:Mi,height:Pi}}},A._skipScalingList=function(I,U){for(var w=8,F=8,$=0,C=0;C<U;C++)F!==0&&($=I.readSEG(),F=(w+$+256)%256),w=F===0?w:F},A.getProfileString=function(I){switch(I){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},A.getLevelString=function(I){return(I/10).toFixed(1)},A.getChromaFormatString=function(I){switch(I){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},A}();le.default=V},"./src/flv.js":function(ce,le,Z){"use strict";Z.r(le);var oe=Z("./src/utils/polyfill.js"),V=Z("./src/core/features.js"),A=Z("./src/io/loader.js"),I=Z("./src/player/flv-player.js"),U=Z("./src/player/native-player.js"),w=Z("./src/player/player-events.js"),F=Z("./src/player/player-errors.js"),$=Z("./src/utils/logging-control.js"),C=Z("./src/utils/exception.js");oe.default.install();function B(H,X){var ie=H;if(ie==null||typeof ie!="object")throw new C.InvalidArgumentException("MediaDataSource must be an javascript object!");if(!ie.hasOwnProperty("type"))throw new C.InvalidArgumentException("MediaDataSource must has type field to indicate video file type!");switch(ie.type){case"flv":return new I.default(ie,X);default:return new U.default(ie,X)}}function O(){return V.default.supportMSEH264Playback()}function P(){return V.default.getFeatureList()}var S={};S.createPlayer=B,S.isSupported=O,S.getFeatureList=P,S.BaseLoader=A.BaseLoader,S.LoaderStatus=A.LoaderStatus,S.LoaderErrors=A.LoaderErrors,S.Events=w.default,S.ErrorTypes=F.ErrorTypes,S.ErrorDetails=F.ErrorDetails,S.FlvPlayer=I.default,S.NativePlayer=U.default,S.LoggingControl=$.default,Object.defineProperty(S,"version",{enumerable:!0,get:function(){return"1.6.2"}}),le.default=S},"./src/index.js":function(ce,le,Z){ce.exports=Z("./src/flv.js").default},"./src/io/fetch-stream-loader.js":function(ce,le,Z){"use strict";Z.r(le);var oe=Z("./src/utils/browser.js"),V=Z("./src/io/loader.js"),A=Z("./src/utils/exception.js"),I=function(){var w=function($,C){return w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(B,O){B.__proto__=O}||function(B,O){for(var P in O)Object.prototype.hasOwnProperty.call(O,P)&&(B[P]=O[P])},w($,C)};return function(F,$){if(typeof $!="function"&&$!==null)throw new TypeError("Class extends value "+String($)+" is not a constructor or null");w(F,$);function C(){this.constructor=F}F.prototype=$===null?Object.create($):(C.prototype=$.prototype,new C)}}(),U=function(w){I(F,w);function F($,C){var B=w.call(this,"fetch-stream-loader")||this;return B.TAG="FetchStreamLoader",B._seekHandler=$,B._config=C,B._needStash=!0,B._requestAbort=!1,B._contentLength=null,B._receivedLength=0,B}return F.isSupported=function(){try{var $=oe.default.msedge&&oe.default.version.minor>=15048,C=oe.default.msedge?$:!0;return self.fetch&&self.ReadableStream&&C}catch(B){return!1}},F.prototype.destroy=function(){this.isWorking()&&this.abort(),w.prototype.destroy.call(this)},F.prototype.open=function($,C){var B=this;this._dataSource=$,this._range=C;var O=$.url;this._config.reuseRedirectedURL&&$.redirectedURL!=null&&(O=$.redirectedURL);var P=this._seekHandler.getConfig(O,C),S=new self.Headers;if(typeof P.headers=="object"){var H=P.headers;for(var X in H)H.hasOwnProperty(X)&&S.append(X,H[X])}var ie={method:"GET",headers:S,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(typeof this._config.headers=="object")for(var X in this._config.headers)S.append(X,this._config.headers[X]);$.cors===!1&&(ie.mode="same-origin"),$.withCredentials&&(ie.credentials="include"),$.referrerPolicy&&(ie.referrerPolicy=$.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,ie.signal=this._abortController.signal),this._status=V.LoaderStatus.kConnecting,self.fetch(P.url,ie).then(function(k){if(B._requestAbort){B._status=V.LoaderStatus.kIdle,k.body.cancel();return}if(k.ok&&k.status>=200&&k.status<=299){if(k.url!==P.url&&B._onURLRedirect){var j=B._seekHandler.removeURLParameters(k.url);B._onURLRedirect(j)}var Y=k.headers.get("Content-Length");return Y!=null&&(B._contentLength=parseInt(Y),B._contentLength!==0&&B._onContentLengthKnown&&B._onContentLengthKnown(B._contentLength)),B._pump.call(B,k.body.getReader())}else if(B._status=V.LoaderStatus.kError,B._onError)B._onError(V.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:k.status,msg:k.statusText});else throw new A.RuntimeException("FetchStreamLoader: Http code invalid, "+k.status+" "+k.statusText)}).catch(function(k){if(!(B._abortController&&B._abortController.signal.aborted))if(B._status=V.LoaderStatus.kError,B._onError)B._onError(V.LoaderErrors.EXCEPTION,{code:-1,msg:k.message});else throw k})},F.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==V.LoaderStatus.kBuffering||!oe.default.chrome)&&this._abortController)try{this._abortController.abort()}catch($){}},F.prototype._pump=function($){var C=this;return $.read().then(function(B){if(B.done)if(C._contentLength!==null&&C._receivedLength<C._contentLength){C._status=V.LoaderStatus.kError;var O=V.LoaderErrors.EARLY_EOF,P={code:-1,msg:"Fetch stream meet Early-EOF"};if(C._onError)C._onError(O,P);else throw new A.RuntimeException(P.msg)}else C._status=V.LoaderStatus.kComplete,C._onComplete&&C._onComplete(C._range.from,C._range.from+C._receivedLength-1);else{if(C._abortController&&C._abortController.signal.aborted){C._status=V.LoaderStatus.kComplete;return}else if(C._requestAbort===!0)return C._status=V.LoaderStatus.kComplete,$.cancel();C._status=V.LoaderStatus.kBuffering;var S=B.value.buffer,H=C._range.from+C._receivedLength;C._receivedLength+=S.byteLength,C._onDataArrival&&C._onDataArrival(S,H,C._receivedLength),C._pump($)}}).catch(function(B){if(C._abortController&&C._abortController.signal.aborted){C._status=V.LoaderStatus.kComplete;return}if(!(B.code===11&&oe.default.msedge)){C._status=V.LoaderStatus.kError;var O=0,P=null;if((B.code===19||B.message==="network error")&&(C._contentLength===null||C._contentLength!==null&&C._receivedLength<C._contentLength)?(O=V.LoaderErrors.EARLY_EOF,P={code:B.code,msg:"Fetch stream meet Early-EOF"}):(O=V.LoaderErrors.EXCEPTION,P={code:B.code,msg:B.message}),C._onError)C._onError(O,P);else throw new A.RuntimeException(P.msg)}})},F}(V.BaseLoader);le.default=U},"./src/io/io-controller.js":function(ce,le,Z){"use strict";Z.r(le);var oe=Z("./src/utils/logger.js"),V=Z("./src/io/speed-sampler.js"),A=Z("./src/io/loader.js"),I=Z("./src/io/fetch-stream-loader.js"),U=Z("./src/io/xhr-moz-chunked-loader.js"),w=Z("./src/io/xhr-range-loader.js"),F=Z("./src/io/websocket-loader.js"),$=Z("./src/io/range-seek-handler.js"),C=Z("./src/io/param-seek-handler.js"),B=Z("./src/utils/exception.js"),O=function(){function P(S,H,X){this.TAG="IOController",this._config=H,this._extraData=X,this._stashInitialSize=1024*384,H.stashInitialSize!=null&&H.stashInitialSize>0&&(this._stashInitialSize=H.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=1024*1024*3,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,H.enableStashBuffer===!1&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=S,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(S.url),this._refTotalLength=S.filesize?S.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new V.default,this._speedNormalizeList=[64,128,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return P.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},P.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},P.prototype.isPaused=function(){return this._paused},Object.defineProperty(P.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"extraData",{get:function(){return this._extraData},set:function(H){this._extraData=H},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(H){this._onDataArrival=H},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(H){this._onSeeked=H},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"onError",{get:function(){return this._onError},set:function(H){this._onError=H},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"onComplete",{get:function(){return this._onComplete},set:function(H){this._onComplete=H},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(H){this._onRedirect=H},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(H){this._onRecoveredEarlyEof=H},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"hasRedirect",{get:function(){return this._redirectedURL!=null||this._dataSource.redirectedURL!=null},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"currentSpeed",{get:function(){return this._loaderClass===w.default?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),P.prototype._selectSeekHandler=function(){var S=this._config;if(S.seekType==="range")this._seekHandler=new $.default(this._config.rangeLoadZeroStart);else if(S.seekType==="param"){var H=S.seekParamStart||"bstart",X=S.seekParamEnd||"bend";this._seekHandler=new C.default(H,X)}else if(S.seekType==="custom"){if(typeof S.customSeekHandler!="function")throw new B.InvalidArgumentException("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new S.customSeekHandler}else throw new B.InvalidArgumentException("Invalid seekType in config: "+S.seekType)},P.prototype._selectLoader=function(){if(this._config.customLoader!=null)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=F.default;else if(I.default.isSupported())this._loaderClass=I.default;else if(U.default.isSupported())this._loaderClass=U.default;else if(w.default.isSupported())this._loaderClass=w.default;else throw new B.RuntimeException("Your browser doesn't support xhr with arraybuffer responseType!")},P.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),this._loader.needStashBuffer===!1&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},P.prototype.open=function(S){this._currentRange={from:0,to:-1},S&&(this._currentRange.from=S),this._speedSampler.reset(),S||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},P.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},P.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),this._stashUsed!==0?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},P.prototype.resume=function(){if(this._paused){this._paused=!1;var S=this._resumeFrom;this._resumeFrom=0,this._internalSeek(S,!0)}},P.prototype.seek=function(S){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(S,!0)},P.prototype._internalSeek=function(S,H){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(H),this._loader.destroy(),this._loader=null;var X={from:S,to:-1};this._currentRange={from:X.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,X),this._onSeeked&&this._onSeeked()},P.prototype.updateUrl=function(S){if(!S||typeof S!="string"||S.length===0)throw new B.InvalidArgumentException("Url must be a non-empty string!");this._dataSource.url=S},P.prototype._expandBuffer=function(S){for(var H=this._stashSize;H+1024*1024*1<S;)H*=2;if(H+=1024*1024*1,H!==this._bufferSize){var X=new ArrayBuffer(H);if(this._stashUsed>0){var ie=new Uint8Array(this._stashBuffer,0,this._stashUsed),k=new Uint8Array(X,0,H);k.set(ie,0)}this._stashBuffer=X,this._bufferSize=H}},P.prototype._normalizeSpeed=function(S){var H=this._speedNormalizeList,X=H.length-1,ie=0,k=0,j=X;if(S<H[0])return H[0];for(;k<=j;){if(ie=k+Math.floor((j-k)/2),ie===X||S>=H[ie]&&S<H[ie+1])return H[ie];H[ie]<S?k=ie+1:j=ie-1}},P.prototype._adjustStashSize=function(S){var H=0;this._config.isLive||S<512?H=S:S>=512&&S<=1024?H=Math.floor(S*1.5):H=S*2,H>8192&&(H=8192);var X=H*1024+1024*1024*1;this._bufferSize<X&&this._expandBuffer(X),this._stashSize=H*1024},P.prototype._dispatchChunks=function(S,H){return this._currentRange.to=H+S.byteLength-1,this._onDataArrival(S,H)},P.prototype._onURLRedirect=function(S){this._redirectedURL=S,this._onRedirect&&this._onRedirect(S)},P.prototype._onContentLengthKnown=function(S){S&&this._fullRequestFlag&&(this._totalLength=S,this._fullRequestFlag=!1)},P.prototype._onLoaderChunkArrival=function(S,H,X){if(!this._onDataArrival)throw new B.IllegalStateException("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(S.byteLength);var ie=this._speedSampler.lastSecondKBps;if(ie!==0){var k=this._normalizeSpeed(ie);this._speedNormalized!==k&&(this._speedNormalized=k,this._adjustStashSize(k))}if(this._enableStash)if(this._stashUsed===0&&this._stashByteStart===0&&(this._stashByteStart=H),this._stashUsed+S.byteLength<=this._stashSize){var ne=new Uint8Array(this._stashBuffer,0,this._stashSize);ne.set(new Uint8Array(S),this._stashUsed),this._stashUsed+=S.byteLength}else{var ne=new Uint8Array(this._stashBuffer,0,this._bufferSize);if(this._stashUsed>0){var _e=this._stashBuffer.slice(0,this._stashUsed),j=this._dispatchChunks(_e,this._stashByteStart);if(j<_e.byteLength){if(j>0){var he=new Uint8Array(_e,j);ne.set(he,0),this._stashUsed=he.byteLength,this._stashByteStart+=j}}else this._stashUsed=0,this._stashByteStart+=j;this._stashUsed+S.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+S.byteLength),ne=new Uint8Array(this._stashBuffer,0,this._bufferSize)),ne.set(new Uint8Array(S),this._stashUsed),this._stashUsed+=S.byteLength}else{var j=this._dispatchChunks(S,H);if(j<S.byteLength){var Y=S.byteLength-j;Y>this._bufferSize&&(this._expandBuffer(Y),ne=new Uint8Array(this._stashBuffer,0,this._bufferSize)),ne.set(new Uint8Array(S,j),0),this._stashUsed+=Y,this._stashByteStart=H+j}}}else if(this._stashUsed===0){var j=this._dispatchChunks(S,H);if(j<S.byteLength){var Y=S.byteLength-j;Y>this._bufferSize&&this._expandBuffer(Y);var ne=new Uint8Array(this._stashBuffer,0,this._bufferSize);ne.set(new Uint8Array(S,j),0),this._stashUsed+=Y,this._stashByteStart=H+j}}else{this._stashUsed+S.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+S.byteLength);var ne=new Uint8Array(this._stashBuffer,0,this._bufferSize);ne.set(new Uint8Array(S),this._stashUsed),this._stashUsed+=S.byteLength;var j=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart);if(j<this._stashUsed&&j>0){var he=new Uint8Array(this._stashBuffer,j);ne.set(he,0)}this._stashUsed-=j,this._stashByteStart+=j}}},P.prototype._flushStashBuffer=function(S){if(this._stashUsed>0){var H=this._stashBuffer.slice(0,this._stashUsed),X=this._dispatchChunks(H,this._stashByteStart),ie=H.byteLength-X;if(X<H.byteLength)if(S)oe.default.w(this.TAG,ie+" bytes unconsumed data remain when flush buffer, dropped");else{if(X>0){var k=new Uint8Array(this._stashBuffer,0,this._bufferSize),j=new Uint8Array(H,X);k.set(j,0),this._stashUsed=j.byteLength,this._stashByteStart+=X}return 0}return this._stashUsed=0,this._stashByteStart=0,ie}return 0},P.prototype._onLoaderComplete=function(S,H){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},P.prototype._onLoaderError=function(S,H){switch(oe.default.e(this.TAG,"Loader error, code = "+H.code+", msg = "+H.msg),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,S=A.LoaderErrors.UNRECOVERABLE_EARLY_EOF),S){case A.LoaderErrors.EARLY_EOF:{if(!this._config.isLive&&this._totalLength){var X=this._currentRange.to+1;X<this._totalLength&&(oe.default.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(X,!1));return}S=A.LoaderErrors.UNRECOVERABLE_EARLY_EOF;break}case A.LoaderErrors.UNRECOVERABLE_EARLY_EOF:case A.LoaderErrors.CONNECTING_TIMEOUT:case A.LoaderErrors.HTTP_STATUS_CODE_INVALID:case A.LoaderErrors.EXCEPTION:break}if(this._onError)this._onError(S,H);else throw new B.RuntimeException("IOException: "+H.msg)},P}();le.default=O},"./src/io/loader.js":function(ce,le,Z){"use strict";Z.r(le),Z.d(le,{LoaderStatus:function(){return V},LoaderErrors:function(){return A},BaseLoader:function(){return I}});var oe=Z("./src/utils/exception.js"),V={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},A={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},I=function(){function U(w){this._type=w||"undefined",this._status=V.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return U.prototype.destroy=function(){this._status=V.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},U.prototype.isWorking=function(){return this._status===V.kConnecting||this._status===V.kBuffering},Object.defineProperty(U.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(F){this._onContentLengthKnown=F},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(F){this._onURLRedirect=F},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(F){this._onDataArrival=F},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"onError",{get:function(){return this._onError},set:function(F){this._onError=F},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,"onComplete",{get:function(){return this._onComplete},set:function(F){this._onComplete=F},enumerable:!1,configurable:!0}),U.prototype.open=function(w,F){throw new oe.NotImplementedException("Unimplemented abstract function!")},U.prototype.abort=function(){throw new oe.NotImplementedException("Unimplemented abstract function!")},U}()},"./src/io/param-seek-handler.js":function(ce,le,Z){"use strict";Z.r(le);var oe=function(){function V(A,I){this._startName=A,this._endName=I}return V.prototype.getConfig=function(A,I){var U=A;if(I.from!==0||I.to!==-1){var w=!0;U.indexOf("?")===-1&&(U+="?",w=!1),w&&(U+="&"),U+=this._startName+"="+I.from.toString(),I.to!==-1&&(U+="&"+this._endName+"="+I.to.toString())}return{url:U,headers:{}}},V.prototype.removeURLParameters=function(A){var I=A.split("?")[0],U=void 0,w=A.indexOf("?");w!==-1&&(U=A.substring(w+1));var F="";if(U!=null&&U.length>0)for(var $=U.split("&"),C=0;C<$.length;C++){var B=$[C].split("="),O=C>0;B[0]!==this._startName&&B[0]!==this._endName&&(O&&(F+="&"),F+=$[C])}return F.length===0?I:I+"?"+F},V}();le.default=oe},"./src/io/range-seek-handler.js":function(ce,le,Z){"use strict";Z.r(le);var oe=function(){function V(A){this._zeroStart=A||!1}return V.prototype.getConfig=function(A,I){var U={};if(I.from!==0||I.to!==-1){var w=void 0;I.to!==-1?w="bytes="+I.from.toString()+"-"+I.to.toString():w="bytes="+I.from.toString()+"-",U.Range=w}else this._zeroStart&&(U.Range="bytes=0-");return{url:A,headers:U}},V.prototype.removeURLParameters=function(A){return A},V}();le.default=oe},"./src/io/speed-sampler.js":function(ce,le,Z){"use strict";Z.r(le);var oe=function(){function V(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return V.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},V.prototype.addBytes=function(A){this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=A,this._totalBytes+=A):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=A,this._totalBytes+=A):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=A,this._totalBytes+=A,this._lastCheckpoint=this._now())},Object.defineProperty(V.prototype,"currentKBps",{get:function(){this.addBytes(0);var I=(this._now()-this._lastCheckpoint)/1e3;return I==0&&(I=1),this._intervalBytes/I/1024},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),this._lastSecondBytes!==0?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"averageKBps",{get:function(){var I=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/I/1024},enumerable:!1,configurable:!0}),V}();le.default=oe},"./src/io/websocket-loader.js":function(ce,le,Z){"use strict";Z.r(le);var oe=Z("./src/io/loader.js"),V=Z("./src/utils/exception.js"),A=function(){var U=function(F,$){return U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,B){C.__proto__=B}||function(C,B){for(var O in B)Object.prototype.hasOwnProperty.call(B,O)&&(C[O]=B[O])},U(F,$)};return function(w,F){if(typeof F!="function"&&F!==null)throw new TypeError("Class extends value "+String(F)+" is not a constructor or null");U(w,F);function $(){this.constructor=w}w.prototype=F===null?Object.create(F):($.prototype=F.prototype,new $)}}(),I=function(U){A(w,U);function w(){var F=U.call(this,"websocket-loader")||this;return F.TAG="WebSocketLoader",F._needStash=!0,F._ws=null,F._requestAbort=!1,F._receivedLength=0,F}return w.isSupported=function(){try{return typeof self.WebSocket!="undefined"}catch(F){return!1}},w.prototype.destroy=function(){this._ws&&this.abort(),U.prototype.destroy.call(this)},w.prototype.open=function(F){try{var $=this._ws=new self.WebSocket(F.url);$.binaryType="arraybuffer",$.onopen=this._onWebSocketOpen.bind(this),$.onclose=this._onWebSocketClose.bind(this),$.onmessage=this._onWebSocketMessage.bind(this),$.onerror=this._onWebSocketError.bind(this),this._status=oe.LoaderStatus.kConnecting}catch(B){this._status=oe.LoaderStatus.kError;var C={code:B.code,msg:B.message};if(this._onError)this._onError(oe.LoaderErrors.EXCEPTION,C);else throw new V.RuntimeException(C.msg)}},w.prototype.abort=function(){var F=this._ws;F&&(F.readyState===0||F.readyState===1)&&(this._requestAbort=!0,F.close()),this._ws=null,this._status=oe.LoaderStatus.kComplete},w.prototype._onWebSocketOpen=function(F){this._status=oe.LoaderStatus.kBuffering},w.prototype._onWebSocketClose=function(F){if(this._requestAbort===!0){this._requestAbort=!1;return}this._status=oe.LoaderStatus.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)},w.prototype._onWebSocketMessage=function(F){var $=this;if(F.data instanceof ArrayBuffer)this._dispatchArrayBuffer(F.data);else if(F.data instanceof Blob){var C=new FileReader;C.onload=function(){$._dispatchArrayBuffer(C.result)},C.readAsArrayBuffer(F.data)}else{this._status=oe.LoaderStatus.kError;var B={code:-1,msg:"Unsupported WebSocket message type: "+F.data.constructor.name};if(this._onError)this._onError(oe.LoaderErrors.EXCEPTION,B);else throw new V.RuntimeException(B.msg)}},w.prototype._dispatchArrayBuffer=function(F){var $=F,C=this._receivedLength;this._receivedLength+=$.byteLength,this._onDataArrival&&this._onDataArrival($,C,this._receivedLength)},w.prototype._onWebSocketError=function(F){this._status=oe.LoaderStatus.kError;var $={code:F.code,msg:F.message};if(this._onError)this._onError(oe.LoaderErrors.EXCEPTION,$);else throw new V.RuntimeException($.msg)},w}(oe.BaseLoader);le.default=I},"./src/io/xhr-moz-chunked-loader.js":function(ce,le,Z){"use strict";Z.r(le);var oe=Z("./src/utils/logger.js"),V=Z("./src/io/loader.js"),A=Z("./src/utils/exception.js"),I=function(){var w=function($,C){return w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(B,O){B.__proto__=O}||function(B,O){for(var P in O)Object.prototype.hasOwnProperty.call(O,P)&&(B[P]=O[P])},w($,C)};return function(F,$){if(typeof $!="function"&&$!==null)throw new TypeError("Class extends value "+String($)+" is not a constructor or null");w(F,$);function C(){this.constructor=F}F.prototype=$===null?Object.create($):(C.prototype=$.prototype,new C)}}(),U=function(w){I(F,w);function F($,C){var B=w.call(this,"xhr-moz-chunked-loader")||this;return B.TAG="MozChunkedLoader",B._seekHandler=$,B._config=C,B._needStash=!0,B._xhr=null,B._requestAbort=!1,B._contentLength=null,B._receivedLength=0,B}return F.isSupported=function(){try{var $=new XMLHttpRequest;return $.open("GET","https://example.com",!0),$.responseType="moz-chunked-arraybuffer",$.responseType==="moz-chunked-arraybuffer"}catch(C){return oe.default.w("MozChunkedLoader",C.message),!1}},F.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),w.prototype.destroy.call(this)},F.prototype.open=function($,C){this._dataSource=$,this._range=C;var B=$.url;this._config.reuseRedirectedURL&&$.redirectedURL!=null&&(B=$.redirectedURL);var O=this._seekHandler.getConfig(B,C);this._requestURL=O.url;var P=this._xhr=new XMLHttpRequest;if(P.open("GET",O.url,!0),P.responseType="moz-chunked-arraybuffer",P.onreadystatechange=this._onReadyStateChange.bind(this),P.onprogress=this._onProgress.bind(this),P.onloadend=this._onLoadEnd.bind(this),P.onerror=this._onXhrError.bind(this),$.withCredentials&&(P.withCredentials=!0),typeof O.headers=="object"){var S=O.headers;for(var H in S)S.hasOwnProperty(H)&&P.setRequestHeader(H,S[H])}if(typeof this._config.headers=="object"){var S=this._config.headers;for(var H in S)S.hasOwnProperty(H)&&P.setRequestHeader(H,S[H])}this._status=V.LoaderStatus.kConnecting,P.send()},F.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=V.LoaderStatus.kComplete},F.prototype._onReadyStateChange=function($){var C=$.target;if(C.readyState===2){if(C.responseURL!=null&&C.responseURL!==this._requestURL&&this._onURLRedirect){var B=this._seekHandler.removeURLParameters(C.responseURL);this._onURLRedirect(B)}if(C.status!==0&&(C.status<200||C.status>299))if(this._status=V.LoaderStatus.kError,this._onError)this._onError(V.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:C.status,msg:C.statusText});else throw new A.RuntimeException("MozChunkedLoader: Http code invalid, "+C.status+" "+C.statusText);else this._status=V.LoaderStatus.kBuffering}},F.prototype._onProgress=function($){if(this._status!==V.LoaderStatus.kError){this._contentLength===null&&$.total!==null&&$.total!==0&&(this._contentLength=$.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var C=$.target.response,B=this._range.from+this._receivedLength;this._receivedLength+=C.byteLength,this._onDataArrival&&this._onDataArrival(C,B,this._receivedLength)}},F.prototype._onLoadEnd=function($){if(this._requestAbort===!0){this._requestAbort=!1;return}else if(this._status===V.LoaderStatus.kError)return;this._status=V.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)},F.prototype._onXhrError=function($){this._status=V.LoaderStatus.kError;var C=0,B=null;if(this._contentLength&&$.loaded<this._contentLength?(C=V.LoaderErrors.EARLY_EOF,B={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(C=V.LoaderErrors.EXCEPTION,B={code:-1,msg:$.constructor.name+" "+$.type}),this._onError)this._onError(C,B);else throw new A.RuntimeException(B.msg)},F}(V.BaseLoader);le.default=U},"./src/io/xhr-range-loader.js":function(ce,le,Z){"use strict";Z.r(le);var oe=Z("./src/utils/logger.js"),V=Z("./src/io/speed-sampler.js"),A=Z("./src/io/loader.js"),I=Z("./src/utils/exception.js"),U=function(){var F=function(C,B){return F=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,P){O.__proto__=P}||function(O,P){for(var S in P)Object.prototype.hasOwnProperty.call(P,S)&&(O[S]=P[S])},F(C,B)};return function($,C){if(typeof C!="function"&&C!==null)throw new TypeError("Class extends value "+String(C)+" is not a constructor or null");F($,C);function B(){this.constructor=$}$.prototype=C===null?Object.create(C):(B.prototype=C.prototype,new B)}}(),w=function(F){U($,F);function $(C,B){var O=F.call(this,"xhr-range-loader")||this;return O.TAG="RangeLoader",O._seekHandler=C,O._config=B,O._needStash=!1,O._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],O._currentChunkSizeKB=384,O._currentSpeedNormalized=0,O._zeroSpeedChunkCount=0,O._xhr=null,O._speedSampler=new V.default,O._requestAbort=!1,O._waitForTotalLength=!1,O._totalLengthReceived=!1,O._currentRequestURL=null,O._currentRedirectedURL=null,O._currentRequestRange=null,O._totalLength=null,O._contentLength=null,O._receivedLength=0,O._lastTimeLoaded=0,O}return $.isSupported=function(){try{var C=new XMLHttpRequest;return C.open("GET","https://example.com",!0),C.responseType="arraybuffer",C.responseType==="arraybuffer"}catch(B){return oe.default.w("RangeLoader",B.message),!1}},$.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),F.prototype.destroy.call(this)},Object.defineProperty($.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),$.prototype.open=function(C,B){this._dataSource=C,this._range=B,this._status=A.LoaderStatus.kConnecting;var O=!1;this._dataSource.filesize!=null&&this._dataSource.filesize!==0&&(O=!0,this._totalLength=this._dataSource.filesize),!this._totalLengthReceived&&!O?(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1})):this._openSubRange()},$.prototype._openSubRange=function(){var C=this._currentChunkSizeKB*1024,B=this._range.from+this._receivedLength,O=B+C;this._contentLength!=null&&O-this._range.from>=this._contentLength&&(O=this._range.from+this._contentLength-1),this._currentRequestRange={from:B,to:O},this._internalOpen(this._dataSource,this._currentRequestRange)},$.prototype._internalOpen=function(C,B){this._lastTimeLoaded=0;var O=C.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?O=this._currentRedirectedURL:C.redirectedURL!=null&&(O=C.redirectedURL));var P=this._seekHandler.getConfig(O,B);this._currentRequestURL=P.url;var S=this._xhr=new XMLHttpRequest;if(S.open("GET",P.url,!0),S.responseType="arraybuffer",S.onreadystatechange=this._onReadyStateChange.bind(this),S.onprogress=this._onProgress.bind(this),S.onload=this._onLoad.bind(this),S.onerror=this._onXhrError.bind(this),C.withCredentials&&(S.withCredentials=!0),typeof P.headers=="object"){var H=P.headers;for(var X in H)H.hasOwnProperty(X)&&S.setRequestHeader(X,H[X])}if(typeof this._config.headers=="object"){var H=this._config.headers;for(var X in H)H.hasOwnProperty(X)&&S.setRequestHeader(X,H[X])}S.send()},$.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=A.LoaderStatus.kComplete},$.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},$.prototype._onReadyStateChange=function(C){var B=C.target;if(B.readyState===2){if(B.responseURL!=null){var O=this._seekHandler.removeURLParameters(B.responseURL);B.responseURL!==this._currentRequestURL&&O!==this._currentRedirectedURL&&(this._currentRedirectedURL=O,this._onURLRedirect&&this._onURLRedirect(O))}if(B.status>=200&&B.status<=299){if(this._waitForTotalLength)return;this._status=A.LoaderStatus.kBuffering}else if(this._status=A.LoaderStatus.kError,this._onError)this._onError(A.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:B.status,msg:B.statusText});else throw new I.RuntimeException("RangeLoader: Http code invalid, "+B.status+" "+B.statusText)}},$.prototype._onProgress=function(C){if(this._status!==A.LoaderStatus.kError){if(this._contentLength===null){var B=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,B=!0;var O=C.total;this._internalAbort(),O!=null&O!==0&&(this._totalLength=O)}if(this._range.to===-1?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,B){this._openSubRange();return}this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var P=C.loaded-this._lastTimeLoaded;this._lastTimeLoaded=C.loaded,this._speedSampler.addBytes(P)}},$.prototype._normalizeSpeed=function(C){var B=this._chunkSizeKBList,O=B.length-1,P=0,S=0,H=O;if(C<B[0])return B[0];for(;S<=H;){if(P=S+Math.floor((H-S)/2),P===O||C>=B[P]&&C<B[P+1])return B[P];B[P]<C?S=P+1:H=P-1}},$.prototype._onLoad=function(C){if(this._status!==A.LoaderStatus.kError){if(this._waitForTotalLength){this._waitForTotalLength=!1;return}this._lastTimeLoaded=0;var B=this._speedSampler.lastSecondKBps;if(B===0&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(B=this._speedSampler.currentKBps)),B!==0){var O=this._normalizeSpeed(B);this._currentSpeedNormalized!==O&&(this._currentSpeedNormalized=O,this._currentChunkSizeKB=O)}var P=C.target.response,S=this._range.from+this._receivedLength;this._receivedLength+=P.byteLength;var H=!1;this._contentLength!=null&&this._receivedLength<this._contentLength?this._openSubRange():H=!0,this._onDataArrival&&this._onDataArrival(P,S,this._receivedLength),H&&(this._status=A.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},$.prototype._onXhrError=function(C){this._status=A.LoaderStatus.kError;var B=0,O=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(B=A.LoaderErrors.EARLY_EOF,O={code:-1,msg:"RangeLoader meet Early-Eof"}):(B=A.LoaderErrors.EXCEPTION,O={code:-1,msg:C.constructor.name+" "+C.type}),this._onError)this._onError(B,O);else throw new I.RuntimeException(O.msg)},$}(A.BaseLoader);le.default=w},"./src/player/flv-player.js":function(ce,le,Z){"use strict";Z.r(le);var oe=Z("./node_modules/events/events.js"),V=Z.n(oe),A=Z("./src/utils/logger.js"),I=Z("./src/utils/browser.js"),U=Z("./src/player/player-events.js"),w=Z("./src/core/transmuxer.js"),F=Z("./src/core/transmuxing-events.js"),$=Z("./src/core/mse-controller.js"),C=Z("./src/core/mse-events.js"),B=Z("./src/player/player-errors.js"),O=Z("./src/config.js"),P=Z("./src/utils/exception.js"),S=function(){function H(X,ie){if(this.TAG="FlvPlayer",this._type="FlvPlayer",this._emitter=new(V()),this._config=(0,O.createDefaultConfig)(),typeof ie=="object"&&Object.assign(this._config,ie),X.type.toLowerCase()!=="flv")throw new P.InvalidArgumentException("FlvPlayer requires an flv MediaDataSource input!");X.isLive===!0&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=X,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;var k=I.default.chrome&&(I.default.version.major<50||I.default.version.major===50&&I.default.version.build<2661);this._alwaysSeekKeyframe=!!(k||I.default.msedge||I.default.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}return H.prototype.destroy=function(){this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},H.prototype.on=function(X,ie){var k=this;X===U.default.MEDIA_INFO?this._mediaInfo!=null&&Promise.resolve().then(function(){k._emitter.emit(U.default.MEDIA_INFO,k.mediaInfo)}):X===U.default.STATISTICS_INFO&&this._statisticsInfo!=null&&Promise.resolve().then(function(){k._emitter.emit(U.default.STATISTICS_INFO,k.statisticsInfo)}),this._emitter.addListener(X,ie)},H.prototype.off=function(X,ie){this._emitter.removeListener(X,ie)},H.prototype.attachMediaElement=function(X){var ie=this;if(this._mediaElement=X,X.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),X.addEventListener("seeking",this.e.onvSeeking),X.addEventListener("canplay",this.e.onvCanPlay),X.addEventListener("stalled",this.e.onvStalled),X.addEventListener("progress",this.e.onvProgress),this._msectl=new $.default(this._config),this._msectl.on(C.default.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(C.default.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(C.default.SOURCE_OPEN,function(){ie._mseSourceOpened=!0,ie._hasPendingLoad&&(ie._hasPendingLoad=!1,ie.load())}),this._msectl.on(C.default.ERROR,function(k){ie._emitter.emit(U.default.ERROR,B.ErrorTypes.MEDIA_ERROR,B.ErrorDetails.MEDIA_MSE_ERROR,k)}),this._msectl.attachMediaElement(X),this._pendingSeekTime!=null)try{X.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(k){}},H.prototype.detachMediaElement=function(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)},H.prototype.load=function(){var X=this;if(!this._mediaElement)throw new P.IllegalStateException("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new P.IllegalStateException("FlvPlayer.load() has been called, please call unload() first!");if(!this._hasPendingLoad){if(this._config.deferLoadAfterSourceOpen&&this._mseSourceOpened===!1){this._hasPendingLoad=!0;return}this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new w.default(this._mediaDataSource,this._config),this._transmuxer.on(F.default.INIT_SEGMENT,function(ie,k){X._msectl.appendInitSegment(k)}),this._transmuxer.on(F.default.MEDIA_SEGMENT,function(ie,k){if(X._msectl.appendMediaSegment(k),X._config.lazyLoad&&!X._config.isLive){var j=X._mediaElement.currentTime;k.info.endDts>=(j+X._config.lazyLoadMaxDuration)*1e3&&X._progressChecker==null&&(A.default.v(X.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),X._suspendTransmuxer())}}),this._transmuxer.on(F.default.LOADING_COMPLETE,function(){X._msectl.endOfStream(),X._emitter.emit(U.default.LOADING_COMPLETE)}),this._transmuxer.on(F.default.RECOVERED_EARLY_EOF,function(){X._emitter.emit(U.default.RECOVERED_EARLY_EOF)}),this._transmuxer.on(F.default.IO_ERROR,function(ie,k){X._emitter.emit(U.default.ERROR,B.ErrorTypes.NETWORK_ERROR,ie,k)}),this._transmuxer.on(F.default.DEMUX_ERROR,function(ie,k){X._emitter.emit(U.default.ERROR,B.ErrorTypes.MEDIA_ERROR,ie,{code:-1,msg:k})}),this._transmuxer.on(F.default.MEDIA_INFO,function(ie){X._mediaInfo=ie,X._emitter.emit(U.default.MEDIA_INFO,Object.assign({},ie))}),this._transmuxer.on(F.default.METADATA_ARRIVED,function(ie){X._emitter.emit(U.default.METADATA_ARRIVED,ie)}),this._transmuxer.on(F.default.SCRIPTDATA_ARRIVED,function(ie){X._emitter.emit(U.default.SCRIPTDATA_ARRIVED,ie)}),this._transmuxer.on(F.default.STATISTICS_INFO,function(ie){X._statisticsInfo=X._fillStatisticsInfo(ie),X._emitter.emit(U.default.STATISTICS_INFO,Object.assign({},X._statisticsInfo))}),this._transmuxer.on(F.default.RECOMMEND_SEEKPOINT,function(ie){X._mediaElement&&!X._config.accurateSeek&&(X._requestSetTime=!0,X._mediaElement.currentTime=ie/1e3)}),this._transmuxer.open()}},H.prototype.unload=function(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)},H.prototype.play=function(){return this._mediaElement.play()},H.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(H.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(ie){this._mediaElement.volume=ie},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(ie){this._mediaElement.muted=ie},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(ie){this._mediaElement?this._internalSeek(ie):this._pendingSeekTime=ie},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"mediaInfo",{get:function(){return Object.assign({},this._mediaInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"statisticsInfo",{get:function(){return this._statisticsInfo==null&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)},enumerable:!1,configurable:!0}),H.prototype._fillStatisticsInfo=function(X){if(X.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return X;var ie=!0,k=0,j=0;if(this._mediaElement.getVideoPlaybackQuality){var Y=this._mediaElement.getVideoPlaybackQuality();k=Y.totalVideoFrames,j=Y.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(k=this._mediaElement.webkitDecodedFrameCount,j=this._mediaElement.webkitDroppedFrameCount):ie=!1;return ie&&(X.decodedFrames=k,X.droppedFrames=j),X},H.prototype._onmseUpdateEnd=function(){if(!(!this._config.lazyLoad||this._config.isLive)){for(var X=this._mediaElement.buffered,ie=this._mediaElement.currentTime,k=0,j=0,Y=0;Y<X.length;Y++){var ne=X.start(Y),he=X.end(Y);if(ne<=ie&&ie<he){k=ne,j=he;break}}j>=ie+this._config.lazyLoadMaxDuration&&this._progressChecker==null&&(A.default.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}},H.prototype._onmseBufferFull=function(){A.default.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._progressChecker==null&&this._suspendTransmuxer()},H.prototype._suspendTransmuxer=function(){this._transmuxer&&(this._transmuxer.pause(),this._progressChecker==null&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))},H.prototype._checkProgressAndResume=function(){for(var X=this._mediaElement.currentTime,ie=this._mediaElement.buffered,k=!1,j=0;j<ie.length;j++){var Y=ie.start(j),ne=ie.end(j);if(X>=Y&&X<ne){X>=ne-this._config.lazyLoadRecoverDuration&&(k=!0);break}}k&&(window.clearInterval(this._progressChecker),this._progressChecker=null,k&&(A.default.v(this.TAG,"Continue loading from paused position"),this._transmuxer.resume()))},H.prototype._isTimepointBuffered=function(X){for(var ie=this._mediaElement.buffered,k=0;k<ie.length;k++){var j=ie.start(k),Y=ie.end(k);if(X>=j&&X<Y)return!0}return!1},H.prototype._internalSeek=function(X){var ie=this._isTimepointBuffered(X),k=!1,j=0;if(X<1&&this._mediaElement.buffered.length>0){var Y=this._mediaElement.buffered.start(0);(Y<1&&X<Y||I.default.safari)&&(k=!0,j=I.default.safari?.1:Y)}if(k)this._requestSetTime=!0,this._mediaElement.currentTime=j;else if(ie){if(!this._alwaysSeekKeyframe)this._requestSetTime=!0,this._mediaElement.currentTime=X;else{var ne=this._msectl.getNearestKeyframe(Math.floor(X*1e3));this._requestSetTime=!0,ne!=null?this._mediaElement.currentTime=ne.dts/1e3:this._mediaElement.currentTime=X}this._progressChecker!=null&&this._checkProgressAndResume()}else this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(X),this._transmuxer.seek(Math.floor(X*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=X)},H.prototype._checkAndApplyUnbufferedSeekpoint=function(){if(this._seekpointRecord)if(this._seekpointRecord.recordTime<=this._now()-100){var X=this._mediaElement.currentTime;this._seekpointRecord=null,this._isTimepointBuffered(X)||(this._progressChecker!=null&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(X),this._transmuxer.seek(Math.floor(X*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=X))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},H.prototype._checkAndResumeStuckPlayback=function(X){var ie=this._mediaElement;if(X||!this._receivedCanPlay||ie.readyState<2){var k=ie.buffered;k.length>0&&ie.currentTime<k.start(0)&&(A.default.w(this.TAG,"Playback seems stuck at "+ie.currentTime+", seek to "+k.start(0)),this._requestSetTime=!0,this._mediaElement.currentTime=k.start(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress))}else this._mediaElement.removeEventListener("progress",this.e.onvProgress)},H.prototype._onvLoadedMetadata=function(X){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)},H.prototype._onvSeeking=function(X){var ie=this._mediaElement.currentTime,k=this._mediaElement.buffered;if(this._requestSetTime){this._requestSetTime=!1;return}if(ie<1&&k.length>0){var j=k.start(0);if(j<1&&ie<j||I.default.safari){this._requestSetTime=!0,this._mediaElement.currentTime=I.default.safari?.1:j;return}}if(this._isTimepointBuffered(ie)){if(this._alwaysSeekKeyframe){var Y=this._msectl.getNearestKeyframe(Math.floor(ie*1e3));Y!=null&&(this._requestSetTime=!0,this._mediaElement.currentTime=Y.dts/1e3)}this._progressChecker!=null&&this._checkProgressAndResume();return}this._seekpointRecord={seekPoint:ie,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},H.prototype._onvCanPlay=function(X){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)},H.prototype._onvStalled=function(X){this._checkAndResumeStuckPlayback(!0)},H.prototype._onvProgress=function(X){this._checkAndResumeStuckPlayback()},H}();le.default=S},"./src/player/native-player.js":function(ce,le,Z){"use strict";Z.r(le);var oe=Z("./node_modules/events/events.js"),V=Z.n(oe),A=Z("./src/player/player-events.js"),I=Z("./src/config.js"),U=Z("./src/utils/exception.js"),w=function(){function F($,C){if(this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new(V()),this._config=(0,I.createDefaultConfig)(),typeof C=="object"&&Object.assign(this._config,C),$.type.toLowerCase()==="flv")throw new U.InvalidArgumentException("NativePlayer does't support flv MediaDataSource input!");if($.hasOwnProperty("segments"))throw new U.InvalidArgumentException("NativePlayer("+$.type+") doesn't support multipart playback!");this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=$,this._mediaElement=null}return F.prototype.destroy=function(){this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},F.prototype.on=function($,C){var B=this;$===A.default.MEDIA_INFO?this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){B._emitter.emit(A.default.MEDIA_INFO,B.mediaInfo)}):$===A.default.STATISTICS_INFO&&this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){B._emitter.emit(A.default.STATISTICS_INFO,B.statisticsInfo)}),this._emitter.addListener($,C)},F.prototype.off=function($,C){this._emitter.removeListener($,C)},F.prototype.attachMediaElement=function($){if(this._mediaElement=$,$.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._pendingSeekTime!=null)try{$.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(C){}},F.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},F.prototype.load=function(){if(!this._mediaElement)throw new U.IllegalStateException("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},F.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},F.prototype.play=function(){return this._mediaElement.play()},F.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(F.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(C){this._mediaElement.volume=C},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(C){this._mediaElement.muted=C},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(C){this._mediaElement?this._mediaElement.currentTime=C:this._pendingSeekTime=C},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"mediaInfo",{get:function(){var C=this._mediaElement instanceof HTMLAudioElement?"audio/":"video/",B={mimeType:C+this._mediaDataSource.type};return this._mediaElement&&(B.duration=Math.floor(this._mediaElement.duration*1e3),this._mediaElement instanceof HTMLVideoElement&&(B.width=this._mediaElement.videoWidth,B.height=this._mediaElement.videoHeight)),B},enumerable:!1,configurable:!0}),Object.defineProperty(F.prototype,"statisticsInfo",{get:function(){var C={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return C;var B=!0,O=0,P=0;if(this._mediaElement.getVideoPlaybackQuality){var S=this._mediaElement.getVideoPlaybackQuality();O=S.totalVideoFrames,P=S.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(O=this._mediaElement.webkitDecodedFrameCount,P=this._mediaElement.webkitDroppedFrameCount):B=!1;return B&&(C.decodedFrames=O,C.droppedFrames=P),C},enumerable:!1,configurable:!0}),F.prototype._onvLoadedMetadata=function($){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(A.default.MEDIA_INFO,this.mediaInfo)},F.prototype._reportStatisticsInfo=function(){this._emitter.emit(A.default.STATISTICS_INFO,this.statisticsInfo)},F}();le.default=w},"./src/player/player-errors.js":function(ce,le,Z){"use strict";Z.r(le),Z.d(le,{ErrorTypes:function(){return A},ErrorDetails:function(){return I}});var oe=Z("./src/io/loader.js"),V=Z("./src/demux/demux-errors.js"),A={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},I={NETWORK_EXCEPTION:oe.LoaderErrors.EXCEPTION,NETWORK_STATUS_CODE_INVALID:oe.LoaderErrors.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:oe.LoaderErrors.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:oe.LoaderErrors.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:V.default.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:V.default.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:V.default.CODEC_UNSUPPORTED}},"./src/player/player-events.js":function(ce,le,Z){"use strict";Z.r(le);var oe={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info"};le.default=oe},"./src/remux/aac-silent.js":function(ce,le,Z){"use strict";Z.r(le);var oe=function(){function V(){}return V.getSilentFrame=function(A,I){if(A==="mp4a.40.2"){if(I===1)return new Uint8Array([0,200,0,128,35,128]);if(I===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(I===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(I===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(I===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(I===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(I===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(I===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(I===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},V}();le.default=oe},"./src/remux/mp4-generator.js":function(ce,le,Z){"use strict";Z.r(le);var oe=function(){function V(){}return V.init=function(){V.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[]};for(var A in V.types)V.types.hasOwnProperty(A)&&(V.types[A]=[A.charCodeAt(0),A.charCodeAt(1),A.charCodeAt(2),A.charCodeAt(3)]);var I=V.constants={};I.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),I.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),I.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),I.STSC=I.STCO=I.STTS,I.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),I.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),I.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),I.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),I.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),I.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},V.box=function(A){for(var I=8,U=null,w=Array.prototype.slice.call(arguments,1),F=w.length,$=0;$<F;$++)I+=w[$].byteLength;U=new Uint8Array(I),U[0]=I>>>24&255,U[1]=I>>>16&255,U[2]=I>>>8&255,U[3]=I&255,U.set(A,4);for(var C=8,$=0;$<F;$++)U.set(w[$],C),C+=w[$].byteLength;return U},V.generateInitSegment=function(A){var I=V.box(V.types.ftyp,V.constants.FTYP),U=V.moov(A),w=new Uint8Array(I.byteLength+U.byteLength);return w.set(I,0),w.set(U,I.byteLength),w},V.moov=function(A){var I=V.mvhd(A.timescale,A.duration),U=V.trak(A),w=V.mvex(A);return V.box(V.types.moov,I,U,w)},V.mvhd=function(A,I){return V.box(V.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,A>>>24&255,A>>>16&255,A>>>8&255,A&255,I>>>24&255,I>>>16&255,I>>>8&255,I&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},V.trak=function(A){return V.box(V.types.trak,V.tkhd(A),V.mdia(A))},V.tkhd=function(A){var I=A.id,U=A.duration,w=A.presentWidth,F=A.presentHeight;return V.box(V.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,I>>>24&255,I>>>16&255,I>>>8&255,I&255,0,0,0,0,U>>>24&255,U>>>16&255,U>>>8&255,U&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,w>>>8&255,w&255,0,0,F>>>8&255,F&255,0,0]))},V.mdia=function(A){return V.box(V.types.mdia,V.mdhd(A),V.hdlr(A),V.minf(A))},V.mdhd=function(A){var I=A.timescale,U=A.duration;return V.box(V.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,I>>>24&255,I>>>16&255,I>>>8&255,I&255,U>>>24&255,U>>>16&255,U>>>8&255,U&255,85,196,0,0]))},V.hdlr=function(A){var I=null;return A.type==="audio"?I=V.constants.HDLR_AUDIO:I=V.constants.HDLR_VIDEO,V.box(V.types.hdlr,I)},V.minf=function(A){var I=null;return A.type==="audio"?I=V.box(V.types.smhd,V.constants.SMHD):I=V.box(V.types.vmhd,V.constants.VMHD),V.box(V.types.minf,I,V.dinf(),V.stbl(A))},V.dinf=function(){var A=V.box(V.types.dinf,V.box(V.types.dref,V.constants.DREF));return A},V.stbl=function(A){var I=V.box(V.types.stbl,V.stsd(A),V.box(V.types.stts,V.constants.STTS),V.box(V.types.stsc,V.constants.STSC),V.box(V.types.stsz,V.constants.STSZ),V.box(V.types.stco,V.constants.STCO));return I},V.stsd=function(A){return A.type==="audio"?A.codec==="mp3"?V.box(V.types.stsd,V.constants.STSD_PREFIX,V.mp3(A)):V.box(V.types.stsd,V.constants.STSD_PREFIX,V.mp4a(A)):V.box(V.types.stsd,V.constants.STSD_PREFIX,V.avc1(A))},V.mp3=function(A){var I=A.channelCount,U=A.audioSampleRate,w=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,I,0,16,0,0,0,0,U>>>8&255,U&255,0,0]);return V.box(V.types[".mp3"],w)},V.mp4a=function(A){var I=A.channelCount,U=A.audioSampleRate,w=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,I,0,16,0,0,0,0,U>>>8&255,U&255,0,0]);return V.box(V.types.mp4a,w,V.esds(A))},V.esds=function(A){var I=A.config||[],U=I.length,w=new Uint8Array([0,0,0,0,3,23+U,0,1,0,4,15+U,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([U]).concat(I).concat([6,1,2]));return V.box(V.types.esds,w)},V.avc1=function(A){var I=A.avcc,U=A.codecWidth,w=A.codecHeight,F=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,U>>>8&255,U&255,w>>>8&255,w&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return V.box(V.types.avc1,F,V.box(V.types.avcC,I))},V.mvex=function(A){return V.box(V.types.mvex,V.trex(A))},V.trex=function(A){var I=A.id,U=new Uint8Array([0,0,0,0,I>>>24&255,I>>>16&255,I>>>8&255,I&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return V.box(V.types.trex,U)},V.moof=function(A,I){return V.box(V.types.moof,V.mfhd(A.sequenceNumber),V.traf(A,I))},V.mfhd=function(A){var I=new Uint8Array([0,0,0,0,A>>>24&255,A>>>16&255,A>>>8&255,A&255]);return V.box(V.types.mfhd,I)},V.traf=function(A,I){var U=A.id,w=V.box(V.types.tfhd,new Uint8Array([0,0,0,0,U>>>24&255,U>>>16&255,U>>>8&255,U&255])),F=V.box(V.types.tfdt,new Uint8Array([0,0,0,0,I>>>24&255,I>>>16&255,I>>>8&255,I&255])),$=V.sdtp(A),C=V.trun(A,$.byteLength+16+16+8+16+8+8);return V.box(V.types.traf,w,F,C,$)},V.sdtp=function(A){for(var I=A.samples||[],U=I.length,w=new Uint8Array(4+U),F=0;F<U;F++){var $=I[F].flags;w[F+4]=$.isLeading<<6|$.dependsOn<<4|$.isDependedOn<<2|$.hasRedundancy}return V.box(V.types.sdtp,w)},V.trun=function(A,I){var U=A.samples||[],w=U.length,F=12+16*w,$=new Uint8Array(F);I+=8+F,$.set([0,0,15,1,w>>>24&255,w>>>16&255,w>>>8&255,w&255,I>>>24&255,I>>>16&255,I>>>8&255,I&255],0);for(var C=0;C<w;C++){var B=U[C].duration,O=U[C].size,P=U[C].flags,S=U[C].cts;$.set([B>>>24&255,B>>>16&255,B>>>8&255,B&255,O>>>24&255,O>>>16&255,O>>>8&255,O&255,P.isLeading<<2|P.dependsOn,P.isDependedOn<<6|P.hasRedundancy<<4|P.isNonSync,0,0,S>>>24&255,S>>>16&255,S>>>8&255,S&255],12+16*C)}return V.box(V.types.trun,$)},V.mdat=function(A){return V.box(V.types.mdat,A)},V}();oe.init(),le.default=oe},"./src/remux/mp4-remuxer.js":function(ce,le,Z){"use strict";Z.r(le);var oe=Z("./src/utils/logger.js"),V=Z("./src/remux/mp4-generator.js"),A=Z("./src/remux/aac-silent.js"),I=Z("./src/utils/browser.js"),U=Z("./src/core/media-segment-info.js"),w=Z("./src/utils/exception.js"),F=function(){function $(C){this.TAG="MP4Remuxer",this._config=C,this._isLive=C.isLive===!0,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=Infinity,this._videoDtsBase=Infinity,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new U.MediaSegmentInfoList("audio"),this._videoSegmentInfoList=new U.MediaSegmentInfoList("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!!(I.default.chrome&&(I.default.version.major<50||I.default.version.major===50&&I.default.version.build<2661)),this._fillSilentAfterSeek=I.default.msedge||I.default.msie,this._mp3UseMpegAudio=!I.default.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return $.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},$.prototype.bindDataSource=function(C){return C.onDataAvailable=this.remux.bind(this),C.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty($.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(B){this._onInitSegment=B},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(B){this._onMediaSegment=B},enumerable:!1,configurable:!0}),$.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},$.prototype.seek=function(C){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},$.prototype.remux=function(C,B){if(!this._onMediaSegment)throw new w.IllegalStateException("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(C,B),this._remuxVideo(B),this._remuxAudio(C)},$.prototype._onTrackMetadataReceived=function(C,B){var O=null,P="mp4",S=B.codec;if(C==="audio")this._audioMeta=B,B.codec==="mp3"&&this._mp3UseMpegAudio?(P="mpeg",S="",O=new Uint8Array):O=V.default.generateInitSegment(B);else if(C==="video")this._videoMeta=B,O=V.default.generateInitSegment(B);else return;if(!this._onInitSegment)throw new w.IllegalStateException("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(C,{type:C,data:O.buffer,codec:S,container:C+"/"+P,mediaDuration:B.duration})},$.prototype._calculateDtsBase=function(C,B){this._dtsBaseInited||(C.samples&&C.samples.length&&(this._audioDtsBase=C.samples[0].dts),B.samples&&B.samples.length&&(this._videoDtsBase=B.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},$.prototype.flushStashedSamples=function(){var C=this._videoStashedLastSample,B=this._audioStashedLastSample,O={type:"video",id:1,sequenceNumber:0,samples:[],length:0};C!=null&&(O.samples.push(C),O.length=C.length);var P={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};B!=null&&(P.samples.push(B),P.length=B.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(O,!0),this._remuxAudio(P,!0)},$.prototype._remuxAudio=function(C,B){if(this._audioMeta!=null){var O=C,P=O.samples,S=void 0,H=-1,X=-1,ie=-1,k=this._audioMeta.refSampleDuration,j=this._audioMeta.codec==="mp3"&&this._mp3UseMpegAudio,Y=this._dtsBaseInited&&this._audioNextDts===void 0,ne=!1;if(!(!P||P.length===0)&&!(P.length===1&&!B)){var he=0,_e=null,ye=0;j?(he=0,ye=O.length):(he=8,ye=8+O.length);var ve=null;if(P.length>1&&(ve=P.pop(),ye-=ve.length),this._audioStashedLastSample!=null){var Te=this._audioStashedLastSample;this._audioStashedLastSample=null,P.unshift(Te),ye+=Te.length}ve!=null&&(this._audioStashedLastSample=ve);var be=P[0].dts-this._dtsBase;if(this._audioNextDts)S=be-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())S=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&this._audioMeta.originalCodec!=="mp3"&&(ne=!0);else{var De=this._audioSegmentInfoList.getLastSampleBefore(be);if(De!=null){var xe=be-(De.originalDts+De.duration);xe<=3&&(xe=0);var qe=De.dts+De.duration+xe;S=be-qe}else S=0}if(ne){var vt=be-S,st=this._videoSegmentInfoList.getLastSegmentBefore(be);if(st!=null&&st.beginDts<vt){var Xe=A.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);if(Xe){var Ye=st.beginDts,Ft=vt-st.beginDts;oe.default.v(this.TAG,"InsertPrefixSilentAudio: dts: "+Ye+", duration: "+Ft),P.unshift({unit:Xe,dts:Ye,pts:Ye}),ye+=Xe.byteLength}}else ne=!1}for(var lt=[],_t=0;_t<P.length;_t++){var Te=P[_t],Mt=Te.unit,It=Te.dts-this._dtsBase,Ye=It,Jt=!1,Zt=null,at=0;if(!(It<-.001)){if(this._audioMeta.codec!=="mp3"){var Nt=It,$t=3;if(this._audioNextDts&&(Nt=this._audioNextDts),S=It-Nt,S<=-$t*k){oe.default.w(this.TAG,"Dropping 1 audio frame (originalDts: "+It+" ms ,curRefDts: "+Nt+" ms)  due to dtsCorrection: "+S+" ms overlap.");continue}else if(S>=$t*k&&this._fillAudioTimestampGap&&!I.default.safari){Jt=!0;var Ci=Math.floor(S/k);oe.default.w(this.TAG,`Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.
`+("originalDts: "+It+" ms, curRefDts: "+Nt+" ms, ")+("dtsCorrection: "+Math.round(S)+" ms, generate: "+Ci+" frames")),Ye=Math.floor(Nt),at=Math.floor(Nt+k)-Ye;var Xe=A.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);Xe==null&&(oe.default.w(this.TAG,"Unable to generate silent frame for "+(this._audioMeta.originalCodec+" with "+this._audioMeta.channelCount+" channels, repeat last frame")),Xe=Mt),Zt=[];for(var Gi=0;Gi<Ci;Gi++){Nt=Nt+k;var Pi=Math.floor(Nt),Mi=Math.floor(Nt+k)-Pi,ki={dts:Pi,pts:Pi,cts:0,unit:Xe,size:Xe.byteLength,duration:Mi,originalDts:It,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};Zt.push(ki),ye+=ki.size}this._audioNextDts=Nt+k}else Ye=Math.floor(Nt),at=Math.floor(Nt+k)-Ye,this._audioNextDts=Nt+k}else{if(Ye=It-S,_t!==P.length-1){var Ht=P[_t+1].dts-this._dtsBase-S;at=Ht-Ye}else if(ve!=null){var Ht=ve.dts-this._dtsBase-S;at=Ht-Ye}else lt.length>=1?at=lt[lt.length-1].duration:at=Math.floor(k);this._audioNextDts=Ye+at}H===-1&&(H=Ye),lt.push({dts:Ye,pts:Ye,cts:0,unit:Te.unit,size:Te.unit.byteLength,duration:at,originalDts:It,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),Jt&&lt.push.apply(lt,Zt)}}if(lt.length===0){O.samples=[],O.length=0;return}j?_e=new Uint8Array(ye):(_e=new Uint8Array(ye),_e[0]=ye>>>24&255,_e[1]=ye>>>16&255,_e[2]=ye>>>8&255,_e[3]=ye&255,_e.set(V.default.types.mdat,4));for(var _t=0;_t<lt.length;_t++){var Mt=lt[_t].unit;_e.set(Mt,he),he+=Mt.byteLength}var tt=lt[lt.length-1];X=tt.dts+tt.duration;var ni=new U.MediaSegmentInfo;ni.beginDts=H,ni.endDts=X,ni.beginPts=H,ni.endPts=X,ni.originalBeginDts=lt[0].originalDts,ni.originalEndDts=tt.originalDts+tt.duration,ni.firstSample=new U.SampleInfo(lt[0].dts,lt[0].pts,lt[0].duration,lt[0].originalDts,!1),ni.lastSample=new U.SampleInfo(tt.dts,tt.pts,tt.duration,tt.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(ni),O.samples=lt,O.sequenceNumber++;var Ii=null;j?Ii=new Uint8Array:Ii=V.default.moof(O,H),O.samples=[],O.length=0;var ei={type:"audio",data:this._mergeBoxes(Ii,_e).buffer,sampleCount:lt.length,info:ni};j&&Y&&(ei.timestampOffset=H),this._onMediaSegment("audio",ei)}}},$.prototype._remuxVideo=function(C,B){if(this._videoMeta!=null){var O=C,P=O.samples,S=void 0,H=-1,X=-1,ie=-1,k=-1;if(!(!P||P.length===0)&&!(P.length===1&&!B)){var j=8,Y=null,ne=8+C.length,he=null;if(P.length>1&&(he=P.pop(),ne-=he.length),this._videoStashedLastSample!=null){var _e=this._videoStashedLastSample;this._videoStashedLastSample=null,P.unshift(_e),ne+=_e.length}he!=null&&(this._videoStashedLastSample=he);var ye=P[0].dts-this._dtsBase;if(this._videoNextDts)S=ye-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())S=0;else{var ve=this._videoSegmentInfoList.getLastSampleBefore(ye);if(ve!=null){var Te=ye-(ve.originalDts+ve.duration);Te<=3&&(Te=0);var be=ve.dts+ve.duration+Te;S=ye-be}else S=0}for(var De=new U.MediaSegmentInfo,xe=[],qe=0;qe<P.length;qe++){var _e=P[qe],vt=_e.dts-this._dtsBase,st=_e.isKeyframe,Xe=vt-S,Ye=_e.cts,Ft=Xe+Ye;H===-1&&(H=Xe,ie=Ft);var lt=0;if(qe!==P.length-1){var _t=P[qe+1].dts-this._dtsBase-S;lt=_t-Xe}else if(he!=null){var _t=he.dts-this._dtsBase-S;lt=_t-Xe}else xe.length>=1?lt=xe[xe.length-1].duration:lt=Math.floor(this._videoMeta.refSampleDuration);if(st){var Mt=new U.SampleInfo(Xe,Ft,lt,_e.dts,!0);Mt.fileposition=_e.fileposition,De.appendSyncPoint(Mt)}xe.push({dts:Xe,pts:Ft,cts:Ye,units:_e.units,size:_e.length,isKeyframe:st,duration:lt,originalDts:vt,flags:{isLeading:0,dependsOn:st?2:1,isDependedOn:st?1:0,hasRedundancy:0,isNonSync:st?0:1}})}Y=new Uint8Array(ne),Y[0]=ne>>>24&255,Y[1]=ne>>>16&255,Y[2]=ne>>>8&255,Y[3]=ne&255,Y.set(V.default.types.mdat,4);for(var qe=0;qe<xe.length;qe++)for(var It=xe[qe].units;It.length;){var Jt=It.shift(),Zt=Jt.data;Y.set(Zt,j),j+=Zt.byteLength}var at=xe[xe.length-1];if(X=at.dts+at.duration,k=at.pts+at.duration,this._videoNextDts=X,De.beginDts=H,De.endDts=X,De.beginPts=ie,De.endPts=k,De.originalBeginDts=xe[0].originalDts,De.originalEndDts=at.originalDts+at.duration,De.firstSample=new U.SampleInfo(xe[0].dts,xe[0].pts,xe[0].duration,xe[0].originalDts,xe[0].isKeyframe),De.lastSample=new U.SampleInfo(at.dts,at.pts,at.duration,at.originalDts,at.isKeyframe),this._isLive||this._videoSegmentInfoList.append(De),O.samples=xe,O.sequenceNumber++,this._forceFirstIDR){var Nt=xe[0].flags;Nt.dependsOn=2,Nt.isNonSync=0}var $t=V.default.moof(O,H);O.samples=[],O.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes($t,Y).buffer,sampleCount:xe.length,info:De})}}},$.prototype._mergeBoxes=function(C,B){var O=new Uint8Array(C.byteLength+B.byteLength);return O.set(C,0),O.set(B,C.byteLength),O},$}();le.default=F},"./src/utils/browser.js":function(ce,le,Z){"use strict";Z.r(le);var oe={};function V(){var A=self.navigator.userAgent.toLowerCase(),I=/(edge)\/([\w.]+)/.exec(A)||/(opr)[\/]([\w.]+)/.exec(A)||/(chrome)[ \/]([\w.]+)/.exec(A)||/(iemobile)[\/]([\w.]+)/.exec(A)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(A)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(A)||/(webkit)[ \/]([\w.]+)/.exec(A)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(A)||/(msie) ([\w.]+)/.exec(A)||A.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(A)||A.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(A)||[],U=/(ipad)/.exec(A)||/(ipod)/.exec(A)||/(windows phone)/.exec(A)||/(iphone)/.exec(A)||/(kindle)/.exec(A)||/(android)/.exec(A)||/(windows)/.exec(A)||/(mac)/.exec(A)||/(linux)/.exec(A)||/(cros)/.exec(A)||[],w={browser:I[5]||I[3]||I[1]||"",version:I[2]||I[4]||"0",majorVersion:I[4]||I[2]||"0",platform:U[0]||""},F={};if(w.browser){F[w.browser]=!0;var $=w.majorVersion.split(".");F.version={major:parseInt(w.majorVersion,10),string:w.version},$.length>1&&(F.version.minor=parseInt($[1],10)),$.length>2&&(F.version.build=parseInt($[2],10))}if(w.platform&&(F[w.platform]=!0),(F.chrome||F.opr||F.safari)&&(F.webkit=!0),F.rv||F.iemobile){F.rv&&delete F.rv;var C="msie";w.browser=C,F[C]=!0}if(F.edge){delete F.edge;var B="msedge";w.browser=B,F[B]=!0}if(F.opr){var O="opera";w.browser=O,F[O]=!0}if(F.safari&&F.android){var P="android";w.browser=P,F[P]=!0}F.name=w.browser,F.platform=w.platform;for(var S in oe)oe.hasOwnProperty(S)&&delete oe[S];Object.assign(oe,F)}V(),le.default=oe},"./src/utils/exception.js":function(ce,le,Z){"use strict";Z.r(le),Z.d(le,{RuntimeException:function(){return V},IllegalStateException:function(){return A},InvalidArgumentException:function(){return I},NotImplementedException:function(){return U}});var oe=function(){var w=function($,C){return w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(B,O){B.__proto__=O}||function(B,O){for(var P in O)Object.prototype.hasOwnProperty.call(O,P)&&(B[P]=O[P])},w($,C)};return function(F,$){if(typeof $!="function"&&$!==null)throw new TypeError("Class extends value "+String($)+" is not a constructor or null");w(F,$);function C(){this.constructor=F}F.prototype=$===null?Object.create($):(C.prototype=$.prototype,new C)}}(),V=function(){function w(F){this._message=F}return Object.defineProperty(w.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),w.prototype.toString=function(){return this.name+": "+this.message},w}(),A=function(w){oe(F,w);function F($){return w.call(this,$)||this}return Object.defineProperty(F.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),F}(V),I=function(w){oe(F,w);function F($){return w.call(this,$)||this}return Object.defineProperty(F.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),F}(V),U=function(w){oe(F,w);function F($){return w.call(this,$)||this}return Object.defineProperty(F.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),F}(V)},"./src/utils/logger.js":function(ce,le,Z){"use strict";Z.r(le);var oe=Z("./node_modules/events/events.js"),V=Z.n(oe),A=function(){function I(){}return I.e=function(U,w){(!U||I.FORCE_GLOBAL_TAG)&&(U=I.GLOBAL_TAG);var F="["+U+"] > "+w;I.ENABLE_CALLBACK&&I.emitter.emit("log","error",F),!!I.ENABLE_ERROR&&(console.error?console.error(F):console.warn?console.warn(F):console.log(F))},I.i=function(U,w){(!U||I.FORCE_GLOBAL_TAG)&&(U=I.GLOBAL_TAG);var F="["+U+"] > "+w;I.ENABLE_CALLBACK&&I.emitter.emit("log","info",F),!!I.ENABLE_INFO&&(console.info?console.info(F):console.log(F))},I.w=function(U,w){(!U||I.FORCE_GLOBAL_TAG)&&(U=I.GLOBAL_TAG);var F="["+U+"] > "+w;I.ENABLE_CALLBACK&&I.emitter.emit("log","warn",F),!!I.ENABLE_WARN&&(console.warn?console.warn(F):console.log(F))},I.d=function(U,w){(!U||I.FORCE_GLOBAL_TAG)&&(U=I.GLOBAL_TAG);var F="["+U+"] > "+w;I.ENABLE_CALLBACK&&I.emitter.emit("log","debug",F),!!I.ENABLE_DEBUG&&(console.debug?console.debug(F):console.log(F))},I.v=function(U,w){(!U||I.FORCE_GLOBAL_TAG)&&(U=I.GLOBAL_TAG);var F="["+U+"] > "+w;I.ENABLE_CALLBACK&&I.emitter.emit("log","verbose",F),!!I.ENABLE_VERBOSE&&console.log(F)},I}();A.GLOBAL_TAG="flv.js",A.FORCE_GLOBAL_TAG=!1,A.ENABLE_ERROR=!0,A.ENABLE_INFO=!0,A.ENABLE_WARN=!0,A.ENABLE_DEBUG=!0,A.ENABLE_VERBOSE=!0,A.ENABLE_CALLBACK=!1,A.emitter=new(V()),le.default=A},"./src/utils/logging-control.js":function(ce,le,Z){"use strict";Z.r(le);var oe=Z("./node_modules/events/events.js"),V=Z.n(oe),A=Z("./src/utils/logger.js"),I=function(){function U(){}return Object.defineProperty(U,"forceGlobalTag",{get:function(){return A.default.FORCE_GLOBAL_TAG},set:function(F){A.default.FORCE_GLOBAL_TAG=F,U._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(U,"globalTag",{get:function(){return A.default.GLOBAL_TAG},set:function(F){A.default.GLOBAL_TAG=F,U._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(U,"enableAll",{get:function(){return A.default.ENABLE_VERBOSE&&A.default.ENABLE_DEBUG&&A.default.ENABLE_INFO&&A.default.ENABLE_WARN&&A.default.ENABLE_ERROR},set:function(F){A.default.ENABLE_VERBOSE=F,A.default.ENABLE_DEBUG=F,A.default.ENABLE_INFO=F,A.default.ENABLE_WARN=F,A.default.ENABLE_ERROR=F,U._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(U,"enableDebug",{get:function(){return A.default.ENABLE_DEBUG},set:function(F){A.default.ENABLE_DEBUG=F,U._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(U,"enableVerbose",{get:function(){return A.default.ENABLE_VERBOSE},set:function(F){A.default.ENABLE_VERBOSE=F,U._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(U,"enableInfo",{get:function(){return A.default.ENABLE_INFO},set:function(F){A.default.ENABLE_INFO=F,U._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(U,"enableWarn",{get:function(){return A.default.ENABLE_WARN},set:function(F){A.default.ENABLE_WARN=F,U._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(U,"enableError",{get:function(){return A.default.ENABLE_ERROR},set:function(F){A.default.ENABLE_ERROR=F,U._notifyChange()},enumerable:!1,configurable:!0}),U.getConfig=function(){return{globalTag:A.default.GLOBAL_TAG,forceGlobalTag:A.default.FORCE_GLOBAL_TAG,enableVerbose:A.default.ENABLE_VERBOSE,enableDebug:A.default.ENABLE_DEBUG,enableInfo:A.default.ENABLE_INFO,enableWarn:A.default.ENABLE_WARN,enableError:A.default.ENABLE_ERROR,enableCallback:A.default.ENABLE_CALLBACK}},U.applyConfig=function(w){A.default.GLOBAL_TAG=w.globalTag,A.default.FORCE_GLOBAL_TAG=w.forceGlobalTag,A.default.ENABLE_VERBOSE=w.enableVerbose,A.default.ENABLE_DEBUG=w.enableDebug,A.default.ENABLE_INFO=w.enableInfo,A.default.ENABLE_WARN=w.enableWarn,A.default.ENABLE_ERROR=w.enableError,A.default.ENABLE_CALLBACK=w.enableCallback},U._notifyChange=function(){var w=U.emitter;if(w.listenerCount("change")>0){var F=U.getConfig();w.emit("change",F)}},U.registerListener=function(w){U.emitter.addListener("change",w)},U.removeListener=function(w){U.emitter.removeListener("change",w)},U.addLogListener=function(w){A.default.emitter.addListener("log",w),A.default.emitter.listenerCount("log")>0&&(A.default.ENABLE_CALLBACK=!0,U._notifyChange())},U.removeLogListener=function(w){A.default.emitter.removeListener("log",w),A.default.emitter.listenerCount("log")===0&&(A.default.ENABLE_CALLBACK=!1,U._notifyChange())},U}();I.emitter=new(V()),le.default=I},"./src/utils/polyfill.js":function(ce,le,Z){"use strict";Z.r(le);var oe=function(){function V(){}return V.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(A,I){return A.__proto__=I,A},Object.assign=Object.assign||function(A){if(A==null)throw new TypeError("Cannot convert undefined or null to object");for(var I=Object(A),U=1;U<arguments.length;U++){var w=arguments[U];if(w!=null)for(var F in w)w.hasOwnProperty(F)&&(I[F]=w[F])}return I},typeof self.Promise!="function"&&Z("./node_modules/es6-promise/dist/es6-promise.js").polyfill()},V}();oe.install(),le.default=oe},"./src/utils/utf8-conv.js":function(ce,le,Z){"use strict";Z.r(le);function oe(A,I,U){var w=A;if(I+U<w.length){for(;U--;)if((w[++I]&192)!=128)return!1;return!0}else return!1}function V(A){for(var I=[],U=A,w=0,F=A.length;w<F;){if(U[w]<128){I.push(String.fromCharCode(U[w])),++w;continue}else if(!(U[w]<192)){if(U[w]<224){if(oe(U,w,1)){var $=(U[w]&31)<<6|U[w+1]&63;if($>=128){I.push(String.fromCharCode($&65535)),w+=2;continue}}}else if(U[w]<240){if(oe(U,w,2)){var $=(U[w]&15)<<12|(U[w+1]&63)<<6|U[w+2]&63;if($>=2048&&($&63488)!=55296){I.push(String.fromCharCode($&65535)),w+=3;continue}}}else if(U[w]<248&&oe(U,w,3)){var $=(U[w]&7)<<18|(U[w+1]&63)<<12|(U[w+2]&63)<<6|U[w+3]&63;if($>65536&&$<1114112){$-=65536,I.push(String.fromCharCode($>>>10|55296)),I.push(String.fromCharCode($&1023|56320)),w+=4;continue}}}I.push(String.fromCharCode(65533)),++w}return I.join("")}le.default=V}},q={};function Oe(fe){var ce=q[fe];if(ce!==void 0)return ce.exports;var le=q[fe]={exports:{}};return rt[fe].call(le.exports,le,le.exports,Oe),le.exports}Oe.m=rt,function(){Oe.n=function(fe){var ce=fe&&fe.__esModule?function(){return fe.default}:function(){return fe};return Oe.d(ce,{a:ce}),ce}}(),function(){Oe.d=function(fe,ce){for(var le in ce)Oe.o(ce,le)&&!Oe.o(fe,le)&&Object.defineProperty(fe,le,{enumerable:!0,get:ce[le]})}}(),function(){Oe.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(fe){if(typeof window=="object")return window}}()}(),function(){Oe.o=function(fe,ce){return Object.prototype.hasOwnProperty.call(fe,ce)}}(),function(){Oe.r=function(fe){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(fe,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(fe,"__esModule",{value:!0})}}();var Ee=Oe("./src/index.js");return Ee}()})},13490:function(Tt,yt,Ne){"use strict";var We=Ne(58908),rt=function(Ee,fe){return fe===void 0&&(fe=!1),function(ce,le,Z){if(ce){Ee(ce);return}if(le.statusCode>=400&&le.statusCode<=599){var oe=Z;if(fe)if(We.TextDecoder){var V=q(le.headers&&le.headers["content-type"]);try{oe=new TextDecoder(V).decode(Z)}catch(A){}}else oe=String.fromCharCode.apply(null,new Uint8Array(Z));Ee({cause:oe});return}Ee(null,Z)}};function q(Oe){return Oe===void 0&&(Oe=""),Oe.toLowerCase().split(";").reduce(function(Ee,fe){var ce=fe.split("="),le=ce[0],Z=ce[1];return le.trim()==="charset"?Z.trim():Ee},"utf-8")}Tt.exports=rt},9603:function(Tt,yt,Ne){"use strict";var We=Ne(58908),rt=Ne(67154),q=Ne(27376);le.httpHandler=Ne(13490);/**
 * @license
 * slighly modified parse-headers 2.0.2 <https://github.com/kesla/parse-headers/>
 * Copyright (c) 2014 David Björklund
 * Available under the MIT license
 * <https://github.com/kesla/parse-headers/blob/master/LICENCE>
 */var Oe=function(I){var U={};return I&&I.trim().split(`
`).forEach(function(w){var F=w.indexOf(":"),$=w.slice(0,F).trim().toLowerCase(),C=w.slice(F+1).trim();typeof U[$]=="undefined"?U[$]=C:Array.isArray(U[$])?U[$].push(C):U[$]=[U[$],C]}),U};Tt.exports=le,Tt.exports.default=le,le.XMLHttpRequest=We.XMLHttpRequest||V,le.XDomainRequest="withCredentials"in new le.XMLHttpRequest?le.XMLHttpRequest:We.XDomainRequest,Ee(["get","put","post","patch","head","delete"],function(A){le[A==="delete"?"del":A]=function(I,U,w){return U=ce(I,U,w),U.method=A.toUpperCase(),Z(U)}});function Ee(A,I){for(var U=0;U<A.length;U++)I(A[U])}function fe(A){for(var I in A)if(A.hasOwnProperty(I))return!1;return!0}function ce(A,I,U){var w=A;return q(I)?(U=I,typeof A=="string"&&(w={uri:A})):w=rt({},I,{uri:A}),w.callback=U,w}function le(A,I,U){return I=ce(A,I,U),Z(I)}function Z(A){if(typeof A.callback=="undefined")throw new Error("callback argument missing");var I=!1,U=function(_e,ye,ve){I||(I=!0,A.callback(_e,ye,ve))};function w(){B.readyState===4&&setTimeout(C,0)}function F(){var he=void 0;if(B.response?he=B.response:he=B.responseText||oe(B),j)try{he=JSON.parse(he)}catch(_e){}return he}function $(he){return clearTimeout(Y),he instanceof Error||(he=new Error(""+(he||"Unknown XMLHttpRequest Error"))),he.statusCode=0,U(he,ne)}function C(){if(!P){var he;clearTimeout(Y),A.useXDR&&B.status===void 0?he=200:he=B.status===1223?204:B.status;var _e=ne,ye=null;return he!==0?(_e={body:F(),statusCode:he,method:H,headers:{},url:S,rawRequest:B},B.getAllResponseHeaders&&(_e.headers=Oe(B.getAllResponseHeaders()))):ye=new Error("Internal XMLHttpRequest Error"),U(ye,_e,_e.body)}}var B=A.xhr||null;B||(A.cors||A.useXDR?B=new le.XDomainRequest:B=new le.XMLHttpRequest);var O,P,S=B.url=A.uri||A.url,H=B.method=A.method||"GET",X=A.body||A.data,ie=B.headers=A.headers||{},k=!!A.sync,j=!1,Y,ne={body:void 0,headers:{},statusCode:0,method:H,url:S,rawRequest:B};if("json"in A&&A.json!==!1&&(j=!0,ie.accept||ie.Accept||(ie.Accept="application/json"),H!=="GET"&&H!=="HEAD"&&(ie["content-type"]||ie["Content-Type"]||(ie["Content-Type"]="application/json"),X=JSON.stringify(A.json===!0?X:A.json))),B.onreadystatechange=w,B.onload=C,B.onerror=$,B.onprogress=function(){},B.onabort=function(){P=!0},B.ontimeout=$,B.open(H,S,!k,A.username,A.password),k||(B.withCredentials=!!A.withCredentials),!k&&A.timeout>0&&(Y=setTimeout(function(){if(!P){P=!0,B.abort("timeout");var he=new Error("XMLHttpRequest timeout");he.code="ETIMEDOUT",$(he)}},A.timeout)),B.setRequestHeader)for(O in ie)ie.hasOwnProperty(O)&&B.setRequestHeader(O,ie[O]);else if(A.headers&&!fe(A.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in A&&(B.responseType=A.responseType),"beforeSend"in A&&typeof A.beforeSend=="function"&&A.beforeSend(B),B.send(X||null),B}function oe(A){try{if(A.responseType==="document")return A.responseXML;var I=A.responseXML&&A.responseXML.documentElement.nodeName==="parsererror";if(A.responseType===""&&!I)return A.responseXML}catch(U){}return null}function V(){}},72167:function(Tt,yt){"use strict";function Ne(Ee,fe,ce){if(ce===void 0&&(ce=Array.prototype),Ee&&typeof ce.find=="function")return ce.find.call(Ee,fe);for(var le=0;le<Ee.length;le++)if(Object.prototype.hasOwnProperty.call(Ee,le)){var Z=Ee[le];if(fe.call(void 0,Z,le,Ee))return Z}}function We(Ee,fe){return fe===void 0&&(fe=Object),fe&&typeof fe.freeze=="function"?fe.freeze(Ee):Ee}function rt(Ee,fe){if(Ee===null||typeof Ee!="object")throw new TypeError("target is not an object");for(var ce in fe)Object.prototype.hasOwnProperty.call(fe,ce)&&(Ee[ce]=fe[ce]);return Ee}var q=We({HTML:"text/html",isHTML:function(Ee){return Ee===q.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),Oe=We({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(Ee){return Ee===Oe.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});yt.assign=rt,yt.find=Ne,yt.freeze=We,yt.MIME_TYPE=q,yt.NAMESPACE=Oe},86129:function(Tt,yt,Ne){var We,rt=Ne(72167),q=Ne(41146),Oe=Ne(31045),Ee=Ne(76925),fe=q.DOMImplementation,ce=rt.NAMESPACE,le=Ee.ParseError,Z=Ee.XMLReader;function oe(C){return C.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028]/g,`
`)}function V(C){this.options=C||{locator:{}}}V.prototype.parseFromString=function(C,B){var O=this.options,P=new Z,S=O.domBuilder||new I,H=O.errorHandler,X=O.locator,ie=O.xmlns||{},k=/\/x?html?$/.test(B),j=k?Oe.HTML_ENTITIES:Oe.XML_ENTITIES;X&&S.setDocumentLocator(X),P.errorHandler=A(H,S,X),P.domBuilder=O.domBuilder||S,k&&(ie[""]=ce.HTML),ie.xml=ie.xml||ce.XML;var Y=O.normalizeLineEndings||oe;return C&&typeof C=="string"?P.parse(Y(C),ie,j):P.errorHandler.error("invalid doc source"),S.doc};function A(C,B,O){if(!C){if(B instanceof I)return B;C=B}var P={},S=C instanceof Function;O=O||{};function H(X){var ie=C[X];!ie&&S&&(ie=C.length==2?function(k){C(X,k)}:C),P[X]=ie&&function(k){ie("[xmldom "+X+"]	"+k+w(O))}||function(){}}return H("warning"),H("error"),H("fatalError"),P}function I(){this.cdata=!1}function U(C,B){B.lineNumber=C.lineNumber,B.columnNumber=C.columnNumber}I.prototype={startDocument:function(){this.doc=new fe().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(C,B,O,P){var S=this.doc,H=S.createElementNS(C,O||B),X=P.length;$(this,H),this.currentElement=H,this.locator&&U(this.locator,H);for(var ie=0;ie<X;ie++){var C=P.getURI(ie),k=P.getValue(ie),O=P.getQName(ie),j=S.createAttributeNS(C,O);this.locator&&U(P.getLocator(ie),j),j.value=j.nodeValue=k,H.setAttributeNode(j)}},endElement:function(C,B,O){var P=this.currentElement,S=P.tagName;this.currentElement=P.parentNode},startPrefixMapping:function(C,B){},endPrefixMapping:function(C){},processingInstruction:function(C,B){var O=this.doc.createProcessingInstruction(C,B);this.locator&&U(this.locator,O),$(this,O)},ignorableWhitespace:function(C,B,O){},characters:function(C,B,O){if(C=F.apply(this,arguments),C){if(this.cdata)var P=this.doc.createCDATASection(C);else var P=this.doc.createTextNode(C);this.currentElement?this.currentElement.appendChild(P):/^\s*$/.test(C)&&this.doc.appendChild(P),this.locator&&U(this.locator,P)}},skippedEntity:function(C){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(C){(this.locator=C)&&(C.lineNumber=0)},comment:function(C,B,O){C=F.apply(this,arguments);var P=this.doc.createComment(C);this.locator&&U(this.locator,P),$(this,P)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(C,B,O){var P=this.doc.implementation;if(P&&P.createDocumentType){var S=P.createDocumentType(C,B,O);this.locator&&U(this.locator,S),$(this,S),this.doc.doctype=S}},warning:function(C){console.warn("[xmldom warning]	"+C,w(this.locator))},error:function(C){console.error("[xmldom error]	"+C,w(this.locator))},fatalError:function(C){throw new le(C,this.locator)}};function w(C){if(C)return`
@`+(C.systemId||"")+"#[line:"+C.lineNumber+",col:"+C.columnNumber+"]"}function F(C,B,O){return typeof C=="string"?C.substr(B,O):C.length>=B+O||B?new java.lang.String(C,B,O)+"":C}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(C){I.prototype[C]=function(){return null}});function $(C,B){C.currentElement?C.currentElement.appendChild(B):C.doc.appendChild(B)}We=I,We=oe,yt.DOMParser=V},41146:function(Tt,yt,Ne){var We=Ne(72167),rt=We.find,q=We.NAMESPACE;function Oe(K){return K!==""}function Ee(K){return K?K.split(/[\t\n\f\r ]+/).filter(Oe):[]}function fe(K,Q){return K.hasOwnProperty(Q)||(K[Q]=!0),K}function ce(K){if(!K)return[];var Q=Ee(K);return Object.keys(Q.reduce(fe,{}))}function le(K){return function(Q){return K&&K.indexOf(Q)!==-1}}function Z(K,Q){for(var ge in K)Object.prototype.hasOwnProperty.call(K,ge)&&(Q[ge]=K[ge])}function oe(K,Q){var ge=K.prototype;if(!(ge instanceof Q)){let Qe=function(){};var Be=Qe;Qe.prototype=Q.prototype,Qe=new Qe,Z(ge,Qe),K.prototype=ge=Qe}ge.constructor!=K&&(typeof K!="function"&&console.error("unknown Class:"+K),ge.constructor=K)}var V={},A=V.ELEMENT_NODE=1,I=V.ATTRIBUTE_NODE=2,U=V.TEXT_NODE=3,w=V.CDATA_SECTION_NODE=4,F=V.ENTITY_REFERENCE_NODE=5,$=V.ENTITY_NODE=6,C=V.PROCESSING_INSTRUCTION_NODE=7,B=V.COMMENT_NODE=8,O=V.DOCUMENT_NODE=9,P=V.DOCUMENT_TYPE_NODE=10,S=V.DOCUMENT_FRAGMENT_NODE=11,H=V.NOTATION_NODE=12,X={},ie={},k=X.INDEX_SIZE_ERR=(ie[1]="Index size error",1),j=X.DOMSTRING_SIZE_ERR=(ie[2]="DOMString size error",2),Y=X.HIERARCHY_REQUEST_ERR=(ie[3]="Hierarchy request error",3),ne=X.WRONG_DOCUMENT_ERR=(ie[4]="Wrong document",4),he=X.INVALID_CHARACTER_ERR=(ie[5]="Invalid character",5),_e=X.NO_DATA_ALLOWED_ERR=(ie[6]="No data allowed",6),ye=X.NO_MODIFICATION_ALLOWED_ERR=(ie[7]="No modification allowed",7),ve=X.NOT_FOUND_ERR=(ie[8]="Not found",8),Te=X.NOT_SUPPORTED_ERR=(ie[9]="Not supported",9),be=X.INUSE_ATTRIBUTE_ERR=(ie[10]="Attribute in use",10),De=X.INVALID_STATE_ERR=(ie[11]="Invalid state",11),xe=X.SYNTAX_ERR=(ie[12]="Syntax error",12),qe=X.INVALID_MODIFICATION_ERR=(ie[13]="Invalid modification",13),vt=X.NAMESPACE_ERR=(ie[14]="Invalid namespace",14),st=X.INVALID_ACCESS_ERR=(ie[15]="Invalid access",15);function Xe(K,Q){if(Q instanceof Error)var ge=Q;else ge=this,Error.call(this,ie[K]),this.message=ie[K],Error.captureStackTrace&&Error.captureStackTrace(this,Xe);return ge.code=K,Q&&(this.message=this.message+": "+Q),ge}Xe.prototype=Error.prototype,Z(X,Xe);function Ye(){}Ye.prototype={length:0,item:function(K){return this[K]||null},toString:function(K,Q){for(var ge=[],Be=0;Be<this.length;Be++)rn(this[Be],ge,K,Q);return ge.join("")},filter:function(K){return Array.prototype.filter.call(this,K)},indexOf:function(K){return Array.prototype.indexOf.call(this,K)}};function Ft(K,Q){this._node=K,this._refresh=Q,lt(this)}function lt(K){var Q=K._node._inc||K._node.ownerDocument._inc;if(K._inc!=Q){var ge=K._refresh(K._node);On(K,"length",ge.length),Z(ge,K),K._inc=Q}}Ft.prototype.item=function(K){return lt(this),this[K]},oe(Ft,Ye);function _t(){}function Mt(K,Q){for(var ge=K.length;ge--;)if(K[ge]===Q)return ge}function It(K,Q,ge,Be){if(Be?Q[Mt(Q,Be)]=ge:Q[Q.length++]=ge,K){ge.ownerElement=K;var Qe=K.ownerDocument;Qe&&(Be&&Pi(Qe,K,Be),Gi(Qe,K,ge))}}function Jt(K,Q,ge){var Be=Mt(Q,ge);if(Be>=0){for(var Qe=Q.length-1;Be<Qe;)Q[Be]=Q[++Be];if(Q.length=Qe,K){var At=K.ownerDocument;At&&(Pi(At,K,ge),ge.ownerElement=null)}}else throw new Xe(ve,new Error(K.tagName+"@"+ge))}_t.prototype={length:0,item:Ye.prototype.item,getNamedItem:function(K){for(var Q=this.length;Q--;){var ge=this[Q];if(ge.nodeName==K)return ge}},setNamedItem:function(K){var Q=K.ownerElement;if(Q&&Q!=this._ownerElement)throw new Xe(be);var ge=this.getNamedItem(K.nodeName);return It(this._ownerElement,this,K,ge),ge},setNamedItemNS:function(K){var Q=K.ownerElement,ge;if(Q&&Q!=this._ownerElement)throw new Xe(be);return ge=this.getNamedItemNS(K.namespaceURI,K.localName),It(this._ownerElement,this,K,ge),ge},removeNamedItem:function(K){var Q=this.getNamedItem(K);return Jt(this._ownerElement,this,Q),Q},removeNamedItemNS:function(K,Q){var ge=this.getNamedItemNS(K,Q);return Jt(this._ownerElement,this,ge),ge},getNamedItemNS:function(K,Q){for(var ge=this.length;ge--;){var Be=this[ge];if(Be.localName==Q&&Be.namespaceURI==K)return Be}return null}};function Zt(){}Zt.prototype={hasFeature:function(K,Q){return!0},createDocument:function(K,Q,ge){var Be=new Ci;if(Be.implementation=this,Be.childNodes=new Ye,Be.doctype=ge||null,ge&&Be.appendChild(ge),Q){var Qe=Be.createElementNS(K,Q);Be.appendChild(Qe)}return Be},createDocumentType:function(K,Q,ge){var Be=new bn;return Be.name=K,Be.nodeName=K,Be.publicId=Q||"",Be.systemId=ge||"",Be}};function at(){}at.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(K,Q){return Ae(this,K,Q)},replaceChild:function(K,Q){Ae(this,K,Q,Ue),Q&&this.removeChild(Q)},removeChild:function(K){return ki(this,K)},appendChild:function(K){return this.insertBefore(K,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(K){return ys(this.ownerDocument||this,this,K)},normalize:function(){for(var K=this.firstChild;K;){var Q=K.nextSibling;Q&&Q.nodeType==U&&K.nodeType==U?(this.removeChild(Q),K.appendData(Q.data)):(K.normalize(),K=Q)}},isSupported:function(K,Q){return this.ownerDocument.implementation.hasFeature(K,Q)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(K){for(var Q=this;Q;){var ge=Q._nsMap;if(ge){for(var Be in ge)if(Object.prototype.hasOwnProperty.call(ge,Be)&&ge[Be]===K)return Be}Q=Q.nodeType==I?Q.ownerDocument:Q.parentNode}return null},lookupNamespaceURI:function(K){for(var Q=this;Q;){var ge=Q._nsMap;if(ge&&Object.prototype.hasOwnProperty.call(ge,K))return ge[K];Q=Q.nodeType==I?Q.ownerDocument:Q.parentNode}return null},isDefaultNamespace:function(K){var Q=this.lookupPrefix(K);return Q==null}};function Nt(K){return K=="<"&&"&lt;"||K==">"&&"&gt;"||K=="&"&&"&amp;"||K=='"'&&"&quot;"||"&#"+K.charCodeAt()+";"}Z(V,at),Z(V,at.prototype);function $t(K,Q){if(Q(K))return!0;if(K=K.firstChild)do if($t(K,Q))return!0;while(K=K.nextSibling)}function Ci(){this.ownerDocument=this}function Gi(K,Q,ge){K&&K._inc++;var Be=ge.namespaceURI;Be===q.XMLNS&&(Q._nsMap[ge.prefix?ge.localName:""]=ge.value)}function Pi(K,Q,ge,Be){K&&K._inc++;var Qe=ge.namespaceURI;Qe===q.XMLNS&&delete Q._nsMap[ge.prefix?ge.localName:""]}function Mi(K,Q,ge){if(K&&K._inc){K._inc++;var Be=Q.childNodes;if(ge)Be[Be.length++]=ge;else{for(var Qe=Q.firstChild,At=0;Qe;)Be[At++]=Qe,Qe=Qe.nextSibling;Be.length=At,delete Be[Be.length]}}}function ki(K,Q){var ge=Q.previousSibling,Be=Q.nextSibling;return ge?ge.nextSibling=Be:K.firstChild=Be,Be?Be.previousSibling=ge:K.lastChild=ge,Q.parentNode=null,Q.previousSibling=null,Q.nextSibling=null,Mi(K.ownerDocument,K),Q}function Ht(K){return K&&(K.nodeType===at.DOCUMENT_NODE||K.nodeType===at.DOCUMENT_FRAGMENT_NODE||K.nodeType===at.ELEMENT_NODE)}function tt(K){return K&&(Ii(K)||ei(K)||ni(K)||K.nodeType===at.DOCUMENT_FRAGMENT_NODE||K.nodeType===at.COMMENT_NODE||K.nodeType===at.PROCESSING_INSTRUCTION_NODE)}function ni(K){return K&&K.nodeType===at.DOCUMENT_TYPE_NODE}function Ii(K){return K&&K.nodeType===at.ELEMENT_NODE}function ei(K){return K&&K.nodeType===at.TEXT_NODE}function lr(K,Q){var ge=K.childNodes||[];if(rt(ge,Ii)||ni(Q))return!1;var Be=rt(ge,ni);return!(Q&&Be&&ge.indexOf(Be)>ge.indexOf(Q))}function Cr(K,Q){var ge=K.childNodes||[];function Be(At){return Ii(At)&&At!==Q}if(rt(ge,Be))return!1;var Qe=rt(ge,ni);return!(Q&&Qe&&ge.indexOf(Qe)>ge.indexOf(Q))}function Ri(K,Q,ge){if(!Ht(K))throw new Xe(Y,"Unexpected parent node type "+K.nodeType);if(ge&&ge.parentNode!==K)throw new Xe(ve,"child not in parent");if(!tt(Q)||ni(Q)&&K.nodeType!==at.DOCUMENT_NODE)throw new Xe(Y,"Unexpected node type "+Q.nodeType+" for parent node type "+K.nodeType)}function Hs(K,Q,ge){var Be=K.childNodes||[],Qe=Q.childNodes||[];if(Q.nodeType===at.DOCUMENT_FRAGMENT_NODE){var At=Qe.filter(Ii);if(At.length>1||rt(Qe,ei))throw new Xe(Y,"More than one element or text in fragment");if(At.length===1&&!lr(K,ge))throw new Xe(Y,"Element in fragment can not be inserted before doctype")}if(Ii(Q)&&!lr(K,ge))throw new Xe(Y,"Only one element can be added and only after doctype");if(ni(Q)){if(rt(Be,ni))throw new Xe(Y,"Only one doctype is allowed");var Yt=rt(Be,Ii);if(ge&&Be.indexOf(Yt)<Be.indexOf(ge))throw new Xe(Y,"Doctype can only be inserted before an element");if(!ge&&Yt)throw new Xe(Y,"Doctype can not be appended since element is present")}}function Ue(K,Q,ge){var Be=K.childNodes||[],Qe=Q.childNodes||[];if(Q.nodeType===at.DOCUMENT_FRAGMENT_NODE){var At=Qe.filter(Ii);if(At.length>1||rt(Qe,ei))throw new Xe(Y,"More than one element or text in fragment");if(At.length===1&&!Cr(K,ge))throw new Xe(Y,"Element in fragment can not be inserted before doctype")}if(Ii(Q)&&!Cr(K,ge))throw new Xe(Y,"Only one element can be added and only after doctype");if(ni(Q)){let Vi=function(Ni){return ni(Ni)&&Ni!==ge};var ri=Vi;if(rt(Be,Vi))throw new Xe(Y,"Only one doctype is allowed");var Yt=rt(Be,Ii);if(ge&&Be.indexOf(Yt)<Be.indexOf(ge))throw new Xe(Y,"Doctype can only be inserted before an element")}}function Ae(K,Q,ge,Be){Ri(K,Q,ge),K.nodeType===at.DOCUMENT_NODE&&(Be||Hs)(K,Q,ge);var Qe=Q.parentNode;if(Qe&&Qe.removeChild(Q),Q.nodeType===S){var At=Q.firstChild;if(At==null)return Q;var Yt=Q.lastChild}else At=Yt=Q;var ri=ge?ge.previousSibling:K.lastChild;At.previousSibling=ri,Yt.nextSibling=ge,ri?ri.nextSibling=At:K.firstChild=At,ge==null?K.lastChild=Yt:ge.previousSibling=Yt;do At.parentNode=K;while(At!==Yt&&(At=At.nextSibling));return Mi(K.ownerDocument||K,K),Q.nodeType==S&&(Q.firstChild=Q.lastChild=null),Q}function Ze(K,Q){return Q.parentNode&&Q.parentNode.removeChild(Q),Q.parentNode=K,Q.previousSibling=K.lastChild,Q.nextSibling=null,Q.previousSibling?Q.previousSibling.nextSibling=Q:K.firstChild=Q,K.lastChild=Q,Mi(K.ownerDocument,K,Q),Q}Ci.prototype={nodeName:"#document",nodeType:O,doctype:null,documentElement:null,_inc:1,insertBefore:function(K,Q){if(K.nodeType==S){for(var ge=K.firstChild;ge;){var Be=ge.nextSibling;this.insertBefore(ge,Q),ge=Be}return K}return Ae(this,K,Q),K.ownerDocument=this,this.documentElement===null&&K.nodeType===A&&(this.documentElement=K),K},removeChild:function(K){return this.documentElement==K&&(this.documentElement=null),ki(this,K)},replaceChild:function(K,Q){Ae(this,K,Q,Ue),K.ownerDocument=this,Q&&this.removeChild(Q),Ii(K)&&(this.documentElement=K)},importNode:function(K,Q){return qs(this,K,Q)},getElementById:function(K){var Q=null;return $t(this.documentElement,function(ge){if(ge.nodeType==A&&ge.getAttribute("id")==K)return Q=ge,!0}),Q},getElementsByClassName:function(K){var Q=ce(K);return new Ft(this,function(ge){var Be=[];return Q.length>0&&$t(ge.documentElement,function(Qe){if(Qe!==ge&&Qe.nodeType===A){var At=Qe.getAttribute("class");if(At){var Yt=K===At;if(!Yt){var ri=ce(At);Yt=Q.every(le(ri))}Yt&&Be.push(Qe)}}}),Be})},createElement:function(K){var Q=new pt;Q.ownerDocument=this,Q.nodeName=K,Q.tagName=K,Q.localName=K,Q.childNodes=new Ye;var ge=Q.attributes=new _t;return ge._ownerElement=Q,Q},createDocumentFragment:function(){var K=new Wr;return K.ownerDocument=this,K.childNodes=new Ye,K},createTextNode:function(K){var Q=new hi;return Q.ownerDocument=this,Q.appendData(K),Q},createComment:function(K){var Q=new tn;return Q.ownerDocument=this,Q.appendData(K),Q},createCDATASection:function(K){var Q=new nn;return Q.ownerDocument=this,Q.appendData(K),Q},createProcessingInstruction:function(K,Q){var ge=new wr;return ge.ownerDocument=this,ge.tagName=ge.target=K,ge.nodeValue=ge.data=Q,ge},createAttribute:function(K){var Q=new St;return Q.ownerDocument=this,Q.name=K,Q.nodeName=K,Q.localName=K,Q.specified=!0,Q},createEntityReference:function(K){var Q=new ur;return Q.ownerDocument=this,Q.nodeName=K,Q},createElementNS:function(K,Q){var ge=new pt,Be=Q.split(":"),Qe=ge.attributes=new _t;return ge.childNodes=new Ye,ge.ownerDocument=this,ge.nodeName=Q,ge.tagName=Q,ge.namespaceURI=K,Be.length==2?(ge.prefix=Be[0],ge.localName=Be[1]):ge.localName=Q,Qe._ownerElement=ge,ge},createAttributeNS:function(K,Q){var ge=new St,Be=Q.split(":");return ge.ownerDocument=this,ge.nodeName=Q,ge.name=Q,ge.namespaceURI=K,ge.specified=!0,Be.length==2?(ge.prefix=Be[0],ge.localName=Be[1]):ge.localName=Q,ge}},oe(Ci,at);function pt(){this._nsMap={}}pt.prototype={nodeType:A,hasAttribute:function(K){return this.getAttributeNode(K)!=null},getAttribute:function(K){var Q=this.getAttributeNode(K);return Q&&Q.value||""},getAttributeNode:function(K){return this.attributes.getNamedItem(K)},setAttribute:function(K,Q){var ge=this.ownerDocument.createAttribute(K);ge.value=ge.nodeValue=""+Q,this.setAttributeNode(ge)},removeAttribute:function(K){var Q=this.getAttributeNode(K);Q&&this.removeAttributeNode(Q)},appendChild:function(K){return K.nodeType===S?this.insertBefore(K,null):Ze(this,K)},setAttributeNode:function(K){return this.attributes.setNamedItem(K)},setAttributeNodeNS:function(K){return this.attributes.setNamedItemNS(K)},removeAttributeNode:function(K){return this.attributes.removeNamedItem(K.nodeName)},removeAttributeNS:function(K,Q){var ge=this.getAttributeNodeNS(K,Q);ge&&this.removeAttributeNode(ge)},hasAttributeNS:function(K,Q){return this.getAttributeNodeNS(K,Q)!=null},getAttributeNS:function(K,Q){var ge=this.getAttributeNodeNS(K,Q);return ge&&ge.value||""},setAttributeNS:function(K,Q,ge){var Be=this.ownerDocument.createAttributeNS(K,Q);Be.value=Be.nodeValue=""+ge,this.setAttributeNode(Be)},getAttributeNodeNS:function(K,Q){return this.attributes.getNamedItemNS(K,Q)},getElementsByTagName:function(K){return new Ft(this,function(Q){var ge=[];return $t(Q,function(Be){Be!==Q&&Be.nodeType==A&&(K==="*"||Be.tagName==K)&&ge.push(Be)}),ge})},getElementsByTagNameNS:function(K,Q){return new Ft(this,function(ge){var Be=[];return $t(ge,function(Qe){Qe!==ge&&Qe.nodeType===A&&(K==="*"||Qe.namespaceURI===K)&&(Q==="*"||Qe.localName==Q)&&Be.push(Qe)}),Be})}},Ci.prototype.getElementsByTagName=pt.prototype.getElementsByTagName,Ci.prototype.getElementsByTagNameNS=pt.prototype.getElementsByTagNameNS,oe(pt,at);function St(){}St.prototype.nodeType=I,oe(St,at);function ze(){}ze.prototype={data:"",substringData:function(K,Q){return this.data.substring(K,K+Q)},appendData:function(K){K=this.data+K,this.nodeValue=this.data=K,this.length=K.length},insertData:function(K,Q){this.replaceData(K,0,Q)},appendChild:function(K){throw new Error(ie[Y])},deleteData:function(K,Q){this.replaceData(K,Q,"")},replaceData:function(K,Q,ge){var Be=this.data.substring(0,K),Qe=this.data.substring(K+Q);ge=Be+ge+Qe,this.nodeValue=this.data=ge,this.length=ge.length}},oe(ze,at);function hi(){}hi.prototype={nodeName:"#text",nodeType:U,splitText:function(K){var Q=this.data,ge=Q.substring(K);Q=Q.substring(0,K),this.data=this.nodeValue=Q,this.length=Q.length;var Be=this.ownerDocument.createTextNode(ge);return this.parentNode&&this.parentNode.insertBefore(Be,this.nextSibling),Be}},oe(hi,ze);function tn(){}tn.prototype={nodeName:"#comment",nodeType:B},oe(tn,ze);function nn(){}nn.prototype={nodeName:"#cdata-section",nodeType:w},oe(nn,ze);function bn(){}bn.prototype.nodeType=P,oe(bn,at);function _n(){}_n.prototype.nodeType=H,oe(_n,at);function Ws(){}Ws.prototype.nodeType=$,oe(Ws,at);function ur(){}ur.prototype.nodeType=F,oe(ur,at);function Wr(){}Wr.prototype.nodeName="#document-fragment",Wr.prototype.nodeType=S,oe(Wr,at);function wr(){}wr.prototype.nodeType=C,oe(wr,at);function xi(){}xi.prototype.serializeToString=function(K,Q,ge){return Kr.call(K,Q,ge)},at.prototype.toString=Kr;function Kr(K,Q){var ge=[],Be=this.nodeType==9&&this.documentElement||this,Qe=Be.prefix,At=Be.namespaceURI;if(At&&Qe==null){var Qe=Be.lookupPrefix(At);if(Qe==null)var Yt=[{namespace:At,prefix:null}]}return rn(this,ge,K,Q,Yt),ge.join("")}function Ks(K,Q,ge){var Be=K.prefix||"",Qe=K.namespaceURI;if(!Qe||Be==="xml"&&Qe===q.XML||Qe===q.XMLNS)return!1;for(var At=ge.length;At--;){var Yt=ge[At];if(Yt.prefix===Be)return Yt.namespace!==Qe}return!0}function xn(K,Q,ge){K.push(" ",Q,'="',ge.replace(/[<>&"\t\n\r]/g,Nt),'"')}function rn(K,Q,ge,Be,Qe){if(Qe||(Qe=[]),Be)if(K=Be(K),K){if(typeof K=="string"){Q.push(K);return}}else return;switch(K.nodeType){case A:var At=K.attributes,Yt=At.length,ri=K.firstChild,Vi=K.tagName;ge=q.isHTML(K.namespaceURI)||ge;var Ni=Vi;if(!ge&&!K.prefix&&K.namespaceURI){for(var En,Tn=0;Tn<At.length;Tn++)if(At.item(Tn).name==="xmlns"){En=At.item(Tn).value;break}if(!En)for(var Sn=Qe.length-1;Sn>=0;Sn--){var Pn=Qe[Sn];if(Pn.prefix===""&&Pn.namespace===K.namespaceURI){En=Pn.namespace;break}}if(En!==K.namespaceURI)for(var Sn=Qe.length-1;Sn>=0;Sn--){var Pn=Qe[Sn];if(Pn.namespace===K.namespaceURI){Pn.prefix&&(Ni=Pn.prefix+":"+Vi);break}}}Q.push("<",Ni);for(var Bn=0;Bn<Yt;Bn++){var wi=At.item(Bn);wi.prefix=="xmlns"?Qe.push({prefix:wi.localName,namespace:wi.value}):wi.nodeName=="xmlns"&&Qe.push({prefix:"",namespace:wi.value})}for(var Bn=0;Bn<Yt;Bn++){var wi=At.item(Bn);if(Ks(wi,ge,Qe)){var zi=wi.prefix||"",Fn=wi.namespaceURI;xn(Q,zi?"xmlns:"+zi:"xmlns",Fn),Qe.push({prefix:zi,namespace:Fn})}rn(wi,Q,ge,Be,Qe)}if(Vi===Ni&&Ks(K,ge,Qe)){var zi=K.prefix||"",Fn=K.namespaceURI;xn(Q,zi?"xmlns:"+zi:"xmlns",Fn),Qe.push({prefix:zi,namespace:Fn})}if(ri||ge&&!/^(?:meta|link|img|br|hr|input)$/i.test(Vi)){if(Q.push(">"),ge&&/^script$/i.test(Vi))for(;ri;)ri.data?Q.push(ri.data):rn(ri,Q,ge,Be,Qe.slice()),ri=ri.nextSibling;else for(;ri;)rn(ri,Q,ge,Be,Qe.slice()),ri=ri.nextSibling;Q.push("</",Ni,">")}else Q.push("/>");return;case O:case S:for(var ri=K.firstChild;ri;)rn(ri,Q,ge,Be,Qe.slice()),ri=ri.nextSibling;return;case I:return xn(Q,K.name,K.value);case U:return Q.push(K.data.replace(/[<&>]/g,Nt));case w:return Q.push("<![CDATA[",K.data,"]]>");case B:return Q.push("<!--",K.data,"-->");case P:var Lr=K.publicId,Ui=K.systemId;if(Q.push("<!DOCTYPE ",K.name),Lr)Q.push(" PUBLIC ",Lr),Ui&&Ui!="."&&Q.push(" ",Ui),Q.push(">");else if(Ui&&Ui!=".")Q.push(" SYSTEM ",Ui,">");else{var zr=K.internalSubset;zr&&Q.push(" [",zr,"]"),Q.push(">")}return;case C:return Q.push("<?",K.target," ",K.data,"?>");case F:return Q.push("&",K.nodeName,";");default:Q.push("??",K.nodeName)}}function qs(K,Q,ge){var Be;switch(Q.nodeType){case A:Be=Q.cloneNode(!1),Be.ownerDocument=K;case S:break;case I:ge=!0;break}if(Be||(Be=Q.cloneNode(!1)),Be.ownerDocument=K,Be.parentNode=null,ge)for(var Qe=Q.firstChild;Qe;)Be.appendChild(qs(K,Qe,ge)),Qe=Qe.nextSibling;return Be}function ys(K,Q,ge){var Be=new Q.constructor;for(var Qe in Q)if(Object.prototype.hasOwnProperty.call(Q,Qe)){var At=Q[Qe];typeof At!="object"&&At!=Be[Qe]&&(Be[Qe]=At)}switch(Q.childNodes&&(Be.childNodes=new Ye),Be.ownerDocument=K,Be.nodeType){case A:var Yt=Q.attributes,ri=Be.attributes=new _t,Vi=Yt.length;ri._ownerElement=Be;for(var Ni=0;Ni<Vi;Ni++)Be.setAttributeNode(ys(K,Yt.item(Ni),!0));break;case I:ge=!0}if(ge)for(var En=Q.firstChild;En;)Be.appendChild(ys(K,En,ge)),En=En.nextSibling;return Be}function On(K,Q,ge){K[Q]=ge}try{if(Object.defineProperty){let K=function(Q){switch(Q.nodeType){case A:case S:var ge=[];for(Q=Q.firstChild;Q;)Q.nodeType!==7&&Q.nodeType!==8&&ge.push(K(Q)),Q=Q.nextSibling;return ge.join("");default:return Q.nodeValue}};var qr=K;Object.defineProperty(Ft.prototype,"length",{get:function(){return lt(this),this.$$length}}),Object.defineProperty(at.prototype,"textContent",{get:function(){return K(this)},set:function(Q){switch(this.nodeType){case A:case S:for(;this.firstChild;)this.removeChild(this.firstChild);(Q||String(Q))&&this.appendChild(this.ownerDocument.createTextNode(Q));break;default:this.data=Q,this.value=Q,this.nodeValue=Q}}}),On=function(Q,ge,Be){Q["$$"+ge]=Be}}}catch(K){}yt.DocumentType=bn,yt.DOMException=Xe,yt.DOMImplementation=Zt,yt.Element=pt,yt.Node=at,yt.NodeList=Ye,yt.XMLSerializer=xi},31045:function(Tt,yt,Ne){"use strict";var We=Ne(72167).freeze;yt.XML_ENTITIES=We({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),yt.HTML_ENTITIES=We({Aacute:"\xC1",aacute:"\xE1",Abreve:"\u0102",abreve:"\u0103",ac:"\u223E",acd:"\u223F",acE:"\u223E\u0333",Acirc:"\xC2",acirc:"\xE2",acute:"\xB4",Acy:"\u0410",acy:"\u0430",AElig:"\xC6",aelig:"\xE6",af:"\u2061",Afr:"\u{1D504}",afr:"\u{1D51E}",Agrave:"\xC0",agrave:"\xE0",alefsym:"\u2135",aleph:"\u2135",Alpha:"\u0391",alpha:"\u03B1",Amacr:"\u0100",amacr:"\u0101",amalg:"\u2A3F",AMP:"&",amp:"&",And:"\u2A53",and:"\u2227",andand:"\u2A55",andd:"\u2A5C",andslope:"\u2A58",andv:"\u2A5A",ang:"\u2220",ange:"\u29A4",angle:"\u2220",angmsd:"\u2221",angmsdaa:"\u29A8",angmsdab:"\u29A9",angmsdac:"\u29AA",angmsdad:"\u29AB",angmsdae:"\u29AC",angmsdaf:"\u29AD",angmsdag:"\u29AE",angmsdah:"\u29AF",angrt:"\u221F",angrtvb:"\u22BE",angrtvbd:"\u299D",angsph:"\u2222",angst:"\xC5",angzarr:"\u237C",Aogon:"\u0104",aogon:"\u0105",Aopf:"\u{1D538}",aopf:"\u{1D552}",ap:"\u2248",apacir:"\u2A6F",apE:"\u2A70",ape:"\u224A",apid:"\u224B",apos:"'",ApplyFunction:"\u2061",approx:"\u2248",approxeq:"\u224A",Aring:"\xC5",aring:"\xE5",Ascr:"\u{1D49C}",ascr:"\u{1D4B6}",Assign:"\u2254",ast:"*",asymp:"\u2248",asympeq:"\u224D",Atilde:"\xC3",atilde:"\xE3",Auml:"\xC4",auml:"\xE4",awconint:"\u2233",awint:"\u2A11",backcong:"\u224C",backepsilon:"\u03F6",backprime:"\u2035",backsim:"\u223D",backsimeq:"\u22CD",Backslash:"\u2216",Barv:"\u2AE7",barvee:"\u22BD",Barwed:"\u2306",barwed:"\u2305",barwedge:"\u2305",bbrk:"\u23B5",bbrktbrk:"\u23B6",bcong:"\u224C",Bcy:"\u0411",bcy:"\u0431",bdquo:"\u201E",becaus:"\u2235",Because:"\u2235",because:"\u2235",bemptyv:"\u29B0",bepsi:"\u03F6",bernou:"\u212C",Bernoullis:"\u212C",Beta:"\u0392",beta:"\u03B2",beth:"\u2136",between:"\u226C",Bfr:"\u{1D505}",bfr:"\u{1D51F}",bigcap:"\u22C2",bigcirc:"\u25EF",bigcup:"\u22C3",bigodot:"\u2A00",bigoplus:"\u2A01",bigotimes:"\u2A02",bigsqcup:"\u2A06",bigstar:"\u2605",bigtriangledown:"\u25BD",bigtriangleup:"\u25B3",biguplus:"\u2A04",bigvee:"\u22C1",bigwedge:"\u22C0",bkarow:"\u290D",blacklozenge:"\u29EB",blacksquare:"\u25AA",blacktriangle:"\u25B4",blacktriangledown:"\u25BE",blacktriangleleft:"\u25C2",blacktriangleright:"\u25B8",blank:"\u2423",blk12:"\u2592",blk14:"\u2591",blk34:"\u2593",block:"\u2588",bne:"=\u20E5",bnequiv:"\u2261\u20E5",bNot:"\u2AED",bnot:"\u2310",Bopf:"\u{1D539}",bopf:"\u{1D553}",bot:"\u22A5",bottom:"\u22A5",bowtie:"\u22C8",boxbox:"\u29C9",boxDL:"\u2557",boxDl:"\u2556",boxdL:"\u2555",boxdl:"\u2510",boxDR:"\u2554",boxDr:"\u2553",boxdR:"\u2552",boxdr:"\u250C",boxH:"\u2550",boxh:"\u2500",boxHD:"\u2566",boxHd:"\u2564",boxhD:"\u2565",boxhd:"\u252C",boxHU:"\u2569",boxHu:"\u2567",boxhU:"\u2568",boxhu:"\u2534",boxminus:"\u229F",boxplus:"\u229E",boxtimes:"\u22A0",boxUL:"\u255D",boxUl:"\u255C",boxuL:"\u255B",boxul:"\u2518",boxUR:"\u255A",boxUr:"\u2559",boxuR:"\u2558",boxur:"\u2514",boxV:"\u2551",boxv:"\u2502",boxVH:"\u256C",boxVh:"\u256B",boxvH:"\u256A",boxvh:"\u253C",boxVL:"\u2563",boxVl:"\u2562",boxvL:"\u2561",boxvl:"\u2524",boxVR:"\u2560",boxVr:"\u255F",boxvR:"\u255E",boxvr:"\u251C",bprime:"\u2035",Breve:"\u02D8",breve:"\u02D8",brvbar:"\xA6",Bscr:"\u212C",bscr:"\u{1D4B7}",bsemi:"\u204F",bsim:"\u223D",bsime:"\u22CD",bsol:"\\",bsolb:"\u29C5",bsolhsub:"\u27C8",bull:"\u2022",bullet:"\u2022",bump:"\u224E",bumpE:"\u2AAE",bumpe:"\u224F",Bumpeq:"\u224E",bumpeq:"\u224F",Cacute:"\u0106",cacute:"\u0107",Cap:"\u22D2",cap:"\u2229",capand:"\u2A44",capbrcup:"\u2A49",capcap:"\u2A4B",capcup:"\u2A47",capdot:"\u2A40",CapitalDifferentialD:"\u2145",caps:"\u2229\uFE00",caret:"\u2041",caron:"\u02C7",Cayleys:"\u212D",ccaps:"\u2A4D",Ccaron:"\u010C",ccaron:"\u010D",Ccedil:"\xC7",ccedil:"\xE7",Ccirc:"\u0108",ccirc:"\u0109",Cconint:"\u2230",ccups:"\u2A4C",ccupssm:"\u2A50",Cdot:"\u010A",cdot:"\u010B",cedil:"\xB8",Cedilla:"\xB8",cemptyv:"\u29B2",cent:"\xA2",CenterDot:"\xB7",centerdot:"\xB7",Cfr:"\u212D",cfr:"\u{1D520}",CHcy:"\u0427",chcy:"\u0447",check:"\u2713",checkmark:"\u2713",Chi:"\u03A7",chi:"\u03C7",cir:"\u25CB",circ:"\u02C6",circeq:"\u2257",circlearrowleft:"\u21BA",circlearrowright:"\u21BB",circledast:"\u229B",circledcirc:"\u229A",circleddash:"\u229D",CircleDot:"\u2299",circledR:"\xAE",circledS:"\u24C8",CircleMinus:"\u2296",CirclePlus:"\u2295",CircleTimes:"\u2297",cirE:"\u29C3",cire:"\u2257",cirfnint:"\u2A10",cirmid:"\u2AEF",cirscir:"\u29C2",ClockwiseContourIntegral:"\u2232",CloseCurlyDoubleQuote:"\u201D",CloseCurlyQuote:"\u2019",clubs:"\u2663",clubsuit:"\u2663",Colon:"\u2237",colon:":",Colone:"\u2A74",colone:"\u2254",coloneq:"\u2254",comma:",",commat:"@",comp:"\u2201",compfn:"\u2218",complement:"\u2201",complexes:"\u2102",cong:"\u2245",congdot:"\u2A6D",Congruent:"\u2261",Conint:"\u222F",conint:"\u222E",ContourIntegral:"\u222E",Copf:"\u2102",copf:"\u{1D554}",coprod:"\u2210",Coproduct:"\u2210",COPY:"\xA9",copy:"\xA9",copysr:"\u2117",CounterClockwiseContourIntegral:"\u2233",crarr:"\u21B5",Cross:"\u2A2F",cross:"\u2717",Cscr:"\u{1D49E}",cscr:"\u{1D4B8}",csub:"\u2ACF",csube:"\u2AD1",csup:"\u2AD0",csupe:"\u2AD2",ctdot:"\u22EF",cudarrl:"\u2938",cudarrr:"\u2935",cuepr:"\u22DE",cuesc:"\u22DF",cularr:"\u21B6",cularrp:"\u293D",Cup:"\u22D3",cup:"\u222A",cupbrcap:"\u2A48",CupCap:"\u224D",cupcap:"\u2A46",cupcup:"\u2A4A",cupdot:"\u228D",cupor:"\u2A45",cups:"\u222A\uFE00",curarr:"\u21B7",curarrm:"\u293C",curlyeqprec:"\u22DE",curlyeqsucc:"\u22DF",curlyvee:"\u22CE",curlywedge:"\u22CF",curren:"\xA4",curvearrowleft:"\u21B6",curvearrowright:"\u21B7",cuvee:"\u22CE",cuwed:"\u22CF",cwconint:"\u2232",cwint:"\u2231",cylcty:"\u232D",Dagger:"\u2021",dagger:"\u2020",daleth:"\u2138",Darr:"\u21A1",dArr:"\u21D3",darr:"\u2193",dash:"\u2010",Dashv:"\u2AE4",dashv:"\u22A3",dbkarow:"\u290F",dblac:"\u02DD",Dcaron:"\u010E",dcaron:"\u010F",Dcy:"\u0414",dcy:"\u0434",DD:"\u2145",dd:"\u2146",ddagger:"\u2021",ddarr:"\u21CA",DDotrahd:"\u2911",ddotseq:"\u2A77",deg:"\xB0",Del:"\u2207",Delta:"\u0394",delta:"\u03B4",demptyv:"\u29B1",dfisht:"\u297F",Dfr:"\u{1D507}",dfr:"\u{1D521}",dHar:"\u2965",dharl:"\u21C3",dharr:"\u21C2",DiacriticalAcute:"\xB4",DiacriticalDot:"\u02D9",DiacriticalDoubleAcute:"\u02DD",DiacriticalGrave:"`",DiacriticalTilde:"\u02DC",diam:"\u22C4",Diamond:"\u22C4",diamond:"\u22C4",diamondsuit:"\u2666",diams:"\u2666",die:"\xA8",DifferentialD:"\u2146",digamma:"\u03DD",disin:"\u22F2",div:"\xF7",divide:"\xF7",divideontimes:"\u22C7",divonx:"\u22C7",DJcy:"\u0402",djcy:"\u0452",dlcorn:"\u231E",dlcrop:"\u230D",dollar:"$",Dopf:"\u{1D53B}",dopf:"\u{1D555}",Dot:"\xA8",dot:"\u02D9",DotDot:"\u20DC",doteq:"\u2250",doteqdot:"\u2251",DotEqual:"\u2250",dotminus:"\u2238",dotplus:"\u2214",dotsquare:"\u22A1",doublebarwedge:"\u2306",DoubleContourIntegral:"\u222F",DoubleDot:"\xA8",DoubleDownArrow:"\u21D3",DoubleLeftArrow:"\u21D0",DoubleLeftRightArrow:"\u21D4",DoubleLeftTee:"\u2AE4",DoubleLongLeftArrow:"\u27F8",DoubleLongLeftRightArrow:"\u27FA",DoubleLongRightArrow:"\u27F9",DoubleRightArrow:"\u21D2",DoubleRightTee:"\u22A8",DoubleUpArrow:"\u21D1",DoubleUpDownArrow:"\u21D5",DoubleVerticalBar:"\u2225",DownArrow:"\u2193",Downarrow:"\u21D3",downarrow:"\u2193",DownArrowBar:"\u2913",DownArrowUpArrow:"\u21F5",DownBreve:"\u0311",downdownarrows:"\u21CA",downharpoonleft:"\u21C3",downharpoonright:"\u21C2",DownLeftRightVector:"\u2950",DownLeftTeeVector:"\u295E",DownLeftVector:"\u21BD",DownLeftVectorBar:"\u2956",DownRightTeeVector:"\u295F",DownRightVector:"\u21C1",DownRightVectorBar:"\u2957",DownTee:"\u22A4",DownTeeArrow:"\u21A7",drbkarow:"\u2910",drcorn:"\u231F",drcrop:"\u230C",Dscr:"\u{1D49F}",dscr:"\u{1D4B9}",DScy:"\u0405",dscy:"\u0455",dsol:"\u29F6",Dstrok:"\u0110",dstrok:"\u0111",dtdot:"\u22F1",dtri:"\u25BF",dtrif:"\u25BE",duarr:"\u21F5",duhar:"\u296F",dwangle:"\u29A6",DZcy:"\u040F",dzcy:"\u045F",dzigrarr:"\u27FF",Eacute:"\xC9",eacute:"\xE9",easter:"\u2A6E",Ecaron:"\u011A",ecaron:"\u011B",ecir:"\u2256",Ecirc:"\xCA",ecirc:"\xEA",ecolon:"\u2255",Ecy:"\u042D",ecy:"\u044D",eDDot:"\u2A77",Edot:"\u0116",eDot:"\u2251",edot:"\u0117",ee:"\u2147",efDot:"\u2252",Efr:"\u{1D508}",efr:"\u{1D522}",eg:"\u2A9A",Egrave:"\xC8",egrave:"\xE8",egs:"\u2A96",egsdot:"\u2A98",el:"\u2A99",Element:"\u2208",elinters:"\u23E7",ell:"\u2113",els:"\u2A95",elsdot:"\u2A97",Emacr:"\u0112",emacr:"\u0113",empty:"\u2205",emptyset:"\u2205",EmptySmallSquare:"\u25FB",emptyv:"\u2205",EmptyVerySmallSquare:"\u25AB",emsp:"\u2003",emsp13:"\u2004",emsp14:"\u2005",ENG:"\u014A",eng:"\u014B",ensp:"\u2002",Eogon:"\u0118",eogon:"\u0119",Eopf:"\u{1D53C}",eopf:"\u{1D556}",epar:"\u22D5",eparsl:"\u29E3",eplus:"\u2A71",epsi:"\u03B5",Epsilon:"\u0395",epsilon:"\u03B5",epsiv:"\u03F5",eqcirc:"\u2256",eqcolon:"\u2255",eqsim:"\u2242",eqslantgtr:"\u2A96",eqslantless:"\u2A95",Equal:"\u2A75",equals:"=",EqualTilde:"\u2242",equest:"\u225F",Equilibrium:"\u21CC",equiv:"\u2261",equivDD:"\u2A78",eqvparsl:"\u29E5",erarr:"\u2971",erDot:"\u2253",Escr:"\u2130",escr:"\u212F",esdot:"\u2250",Esim:"\u2A73",esim:"\u2242",Eta:"\u0397",eta:"\u03B7",ETH:"\xD0",eth:"\xF0",Euml:"\xCB",euml:"\xEB",euro:"\u20AC",excl:"!",exist:"\u2203",Exists:"\u2203",expectation:"\u2130",ExponentialE:"\u2147",exponentiale:"\u2147",fallingdotseq:"\u2252",Fcy:"\u0424",fcy:"\u0444",female:"\u2640",ffilig:"\uFB03",fflig:"\uFB00",ffllig:"\uFB04",Ffr:"\u{1D509}",ffr:"\u{1D523}",filig:"\uFB01",FilledSmallSquare:"\u25FC",FilledVerySmallSquare:"\u25AA",fjlig:"fj",flat:"\u266D",fllig:"\uFB02",fltns:"\u25B1",fnof:"\u0192",Fopf:"\u{1D53D}",fopf:"\u{1D557}",ForAll:"\u2200",forall:"\u2200",fork:"\u22D4",forkv:"\u2AD9",Fouriertrf:"\u2131",fpartint:"\u2A0D",frac12:"\xBD",frac13:"\u2153",frac14:"\xBC",frac15:"\u2155",frac16:"\u2159",frac18:"\u215B",frac23:"\u2154",frac25:"\u2156",frac34:"\xBE",frac35:"\u2157",frac38:"\u215C",frac45:"\u2158",frac56:"\u215A",frac58:"\u215D",frac78:"\u215E",frasl:"\u2044",frown:"\u2322",Fscr:"\u2131",fscr:"\u{1D4BB}",gacute:"\u01F5",Gamma:"\u0393",gamma:"\u03B3",Gammad:"\u03DC",gammad:"\u03DD",gap:"\u2A86",Gbreve:"\u011E",gbreve:"\u011F",Gcedil:"\u0122",Gcirc:"\u011C",gcirc:"\u011D",Gcy:"\u0413",gcy:"\u0433",Gdot:"\u0120",gdot:"\u0121",gE:"\u2267",ge:"\u2265",gEl:"\u2A8C",gel:"\u22DB",geq:"\u2265",geqq:"\u2267",geqslant:"\u2A7E",ges:"\u2A7E",gescc:"\u2AA9",gesdot:"\u2A80",gesdoto:"\u2A82",gesdotol:"\u2A84",gesl:"\u22DB\uFE00",gesles:"\u2A94",Gfr:"\u{1D50A}",gfr:"\u{1D524}",Gg:"\u22D9",gg:"\u226B",ggg:"\u22D9",gimel:"\u2137",GJcy:"\u0403",gjcy:"\u0453",gl:"\u2277",gla:"\u2AA5",glE:"\u2A92",glj:"\u2AA4",gnap:"\u2A8A",gnapprox:"\u2A8A",gnE:"\u2269",gne:"\u2A88",gneq:"\u2A88",gneqq:"\u2269",gnsim:"\u22E7",Gopf:"\u{1D53E}",gopf:"\u{1D558}",grave:"`",GreaterEqual:"\u2265",GreaterEqualLess:"\u22DB",GreaterFullEqual:"\u2267",GreaterGreater:"\u2AA2",GreaterLess:"\u2277",GreaterSlantEqual:"\u2A7E",GreaterTilde:"\u2273",Gscr:"\u{1D4A2}",gscr:"\u210A",gsim:"\u2273",gsime:"\u2A8E",gsiml:"\u2A90",Gt:"\u226B",GT:">",gt:">",gtcc:"\u2AA7",gtcir:"\u2A7A",gtdot:"\u22D7",gtlPar:"\u2995",gtquest:"\u2A7C",gtrapprox:"\u2A86",gtrarr:"\u2978",gtrdot:"\u22D7",gtreqless:"\u22DB",gtreqqless:"\u2A8C",gtrless:"\u2277",gtrsim:"\u2273",gvertneqq:"\u2269\uFE00",gvnE:"\u2269\uFE00",Hacek:"\u02C7",hairsp:"\u200A",half:"\xBD",hamilt:"\u210B",HARDcy:"\u042A",hardcy:"\u044A",hArr:"\u21D4",harr:"\u2194",harrcir:"\u2948",harrw:"\u21AD",Hat:"^",hbar:"\u210F",Hcirc:"\u0124",hcirc:"\u0125",hearts:"\u2665",heartsuit:"\u2665",hellip:"\u2026",hercon:"\u22B9",Hfr:"\u210C",hfr:"\u{1D525}",HilbertSpace:"\u210B",hksearow:"\u2925",hkswarow:"\u2926",hoarr:"\u21FF",homtht:"\u223B",hookleftarrow:"\u21A9",hookrightarrow:"\u21AA",Hopf:"\u210D",hopf:"\u{1D559}",horbar:"\u2015",HorizontalLine:"\u2500",Hscr:"\u210B",hscr:"\u{1D4BD}",hslash:"\u210F",Hstrok:"\u0126",hstrok:"\u0127",HumpDownHump:"\u224E",HumpEqual:"\u224F",hybull:"\u2043",hyphen:"\u2010",Iacute:"\xCD",iacute:"\xED",ic:"\u2063",Icirc:"\xCE",icirc:"\xEE",Icy:"\u0418",icy:"\u0438",Idot:"\u0130",IEcy:"\u0415",iecy:"\u0435",iexcl:"\xA1",iff:"\u21D4",Ifr:"\u2111",ifr:"\u{1D526}",Igrave:"\xCC",igrave:"\xEC",ii:"\u2148",iiiint:"\u2A0C",iiint:"\u222D",iinfin:"\u29DC",iiota:"\u2129",IJlig:"\u0132",ijlig:"\u0133",Im:"\u2111",Imacr:"\u012A",imacr:"\u012B",image:"\u2111",ImaginaryI:"\u2148",imagline:"\u2110",imagpart:"\u2111",imath:"\u0131",imof:"\u22B7",imped:"\u01B5",Implies:"\u21D2",in:"\u2208",incare:"\u2105",infin:"\u221E",infintie:"\u29DD",inodot:"\u0131",Int:"\u222C",int:"\u222B",intcal:"\u22BA",integers:"\u2124",Integral:"\u222B",intercal:"\u22BA",Intersection:"\u22C2",intlarhk:"\u2A17",intprod:"\u2A3C",InvisibleComma:"\u2063",InvisibleTimes:"\u2062",IOcy:"\u0401",iocy:"\u0451",Iogon:"\u012E",iogon:"\u012F",Iopf:"\u{1D540}",iopf:"\u{1D55A}",Iota:"\u0399",iota:"\u03B9",iprod:"\u2A3C",iquest:"\xBF",Iscr:"\u2110",iscr:"\u{1D4BE}",isin:"\u2208",isindot:"\u22F5",isinE:"\u22F9",isins:"\u22F4",isinsv:"\u22F3",isinv:"\u2208",it:"\u2062",Itilde:"\u0128",itilde:"\u0129",Iukcy:"\u0406",iukcy:"\u0456",Iuml:"\xCF",iuml:"\xEF",Jcirc:"\u0134",jcirc:"\u0135",Jcy:"\u0419",jcy:"\u0439",Jfr:"\u{1D50D}",jfr:"\u{1D527}",jmath:"\u0237",Jopf:"\u{1D541}",jopf:"\u{1D55B}",Jscr:"\u{1D4A5}",jscr:"\u{1D4BF}",Jsercy:"\u0408",jsercy:"\u0458",Jukcy:"\u0404",jukcy:"\u0454",Kappa:"\u039A",kappa:"\u03BA",kappav:"\u03F0",Kcedil:"\u0136",kcedil:"\u0137",Kcy:"\u041A",kcy:"\u043A",Kfr:"\u{1D50E}",kfr:"\u{1D528}",kgreen:"\u0138",KHcy:"\u0425",khcy:"\u0445",KJcy:"\u040C",kjcy:"\u045C",Kopf:"\u{1D542}",kopf:"\u{1D55C}",Kscr:"\u{1D4A6}",kscr:"\u{1D4C0}",lAarr:"\u21DA",Lacute:"\u0139",lacute:"\u013A",laemptyv:"\u29B4",lagran:"\u2112",Lambda:"\u039B",lambda:"\u03BB",Lang:"\u27EA",lang:"\u27E8",langd:"\u2991",langle:"\u27E8",lap:"\u2A85",Laplacetrf:"\u2112",laquo:"\xAB",Larr:"\u219E",lArr:"\u21D0",larr:"\u2190",larrb:"\u21E4",larrbfs:"\u291F",larrfs:"\u291D",larrhk:"\u21A9",larrlp:"\u21AB",larrpl:"\u2939",larrsim:"\u2973",larrtl:"\u21A2",lat:"\u2AAB",lAtail:"\u291B",latail:"\u2919",late:"\u2AAD",lates:"\u2AAD\uFE00",lBarr:"\u290E",lbarr:"\u290C",lbbrk:"\u2772",lbrace:"{",lbrack:"[",lbrke:"\u298B",lbrksld:"\u298F",lbrkslu:"\u298D",Lcaron:"\u013D",lcaron:"\u013E",Lcedil:"\u013B",lcedil:"\u013C",lceil:"\u2308",lcub:"{",Lcy:"\u041B",lcy:"\u043B",ldca:"\u2936",ldquo:"\u201C",ldquor:"\u201E",ldrdhar:"\u2967",ldrushar:"\u294B",ldsh:"\u21B2",lE:"\u2266",le:"\u2264",LeftAngleBracket:"\u27E8",LeftArrow:"\u2190",Leftarrow:"\u21D0",leftarrow:"\u2190",LeftArrowBar:"\u21E4",LeftArrowRightArrow:"\u21C6",leftarrowtail:"\u21A2",LeftCeiling:"\u2308",LeftDoubleBracket:"\u27E6",LeftDownTeeVector:"\u2961",LeftDownVector:"\u21C3",LeftDownVectorBar:"\u2959",LeftFloor:"\u230A",leftharpoondown:"\u21BD",leftharpoonup:"\u21BC",leftleftarrows:"\u21C7",LeftRightArrow:"\u2194",Leftrightarrow:"\u21D4",leftrightarrow:"\u2194",leftrightarrows:"\u21C6",leftrightharpoons:"\u21CB",leftrightsquigarrow:"\u21AD",LeftRightVector:"\u294E",LeftTee:"\u22A3",LeftTeeArrow:"\u21A4",LeftTeeVector:"\u295A",leftthreetimes:"\u22CB",LeftTriangle:"\u22B2",LeftTriangleBar:"\u29CF",LeftTriangleEqual:"\u22B4",LeftUpDownVector:"\u2951",LeftUpTeeVector:"\u2960",LeftUpVector:"\u21BF",LeftUpVectorBar:"\u2958",LeftVector:"\u21BC",LeftVectorBar:"\u2952",lEg:"\u2A8B",leg:"\u22DA",leq:"\u2264",leqq:"\u2266",leqslant:"\u2A7D",les:"\u2A7D",lescc:"\u2AA8",lesdot:"\u2A7F",lesdoto:"\u2A81",lesdotor:"\u2A83",lesg:"\u22DA\uFE00",lesges:"\u2A93",lessapprox:"\u2A85",lessdot:"\u22D6",lesseqgtr:"\u22DA",lesseqqgtr:"\u2A8B",LessEqualGreater:"\u22DA",LessFullEqual:"\u2266",LessGreater:"\u2276",lessgtr:"\u2276",LessLess:"\u2AA1",lesssim:"\u2272",LessSlantEqual:"\u2A7D",LessTilde:"\u2272",lfisht:"\u297C",lfloor:"\u230A",Lfr:"\u{1D50F}",lfr:"\u{1D529}",lg:"\u2276",lgE:"\u2A91",lHar:"\u2962",lhard:"\u21BD",lharu:"\u21BC",lharul:"\u296A",lhblk:"\u2584",LJcy:"\u0409",ljcy:"\u0459",Ll:"\u22D8",ll:"\u226A",llarr:"\u21C7",llcorner:"\u231E",Lleftarrow:"\u21DA",llhard:"\u296B",lltri:"\u25FA",Lmidot:"\u013F",lmidot:"\u0140",lmoust:"\u23B0",lmoustache:"\u23B0",lnap:"\u2A89",lnapprox:"\u2A89",lnE:"\u2268",lne:"\u2A87",lneq:"\u2A87",lneqq:"\u2268",lnsim:"\u22E6",loang:"\u27EC",loarr:"\u21FD",lobrk:"\u27E6",LongLeftArrow:"\u27F5",Longleftarrow:"\u27F8",longleftarrow:"\u27F5",LongLeftRightArrow:"\u27F7",Longleftrightarrow:"\u27FA",longleftrightarrow:"\u27F7",longmapsto:"\u27FC",LongRightArrow:"\u27F6",Longrightarrow:"\u27F9",longrightarrow:"\u27F6",looparrowleft:"\u21AB",looparrowright:"\u21AC",lopar:"\u2985",Lopf:"\u{1D543}",lopf:"\u{1D55D}",loplus:"\u2A2D",lotimes:"\u2A34",lowast:"\u2217",lowbar:"_",LowerLeftArrow:"\u2199",LowerRightArrow:"\u2198",loz:"\u25CA",lozenge:"\u25CA",lozf:"\u29EB",lpar:"(",lparlt:"\u2993",lrarr:"\u21C6",lrcorner:"\u231F",lrhar:"\u21CB",lrhard:"\u296D",lrm:"\u200E",lrtri:"\u22BF",lsaquo:"\u2039",Lscr:"\u2112",lscr:"\u{1D4C1}",Lsh:"\u21B0",lsh:"\u21B0",lsim:"\u2272",lsime:"\u2A8D",lsimg:"\u2A8F",lsqb:"[",lsquo:"\u2018",lsquor:"\u201A",Lstrok:"\u0141",lstrok:"\u0142",Lt:"\u226A",LT:"<",lt:"<",ltcc:"\u2AA6",ltcir:"\u2A79",ltdot:"\u22D6",lthree:"\u22CB",ltimes:"\u22C9",ltlarr:"\u2976",ltquest:"\u2A7B",ltri:"\u25C3",ltrie:"\u22B4",ltrif:"\u25C2",ltrPar:"\u2996",lurdshar:"\u294A",luruhar:"\u2966",lvertneqq:"\u2268\uFE00",lvnE:"\u2268\uFE00",macr:"\xAF",male:"\u2642",malt:"\u2720",maltese:"\u2720",Map:"\u2905",map:"\u21A6",mapsto:"\u21A6",mapstodown:"\u21A7",mapstoleft:"\u21A4",mapstoup:"\u21A5",marker:"\u25AE",mcomma:"\u2A29",Mcy:"\u041C",mcy:"\u043C",mdash:"\u2014",mDDot:"\u223A",measuredangle:"\u2221",MediumSpace:"\u205F",Mellintrf:"\u2133",Mfr:"\u{1D510}",mfr:"\u{1D52A}",mho:"\u2127",micro:"\xB5",mid:"\u2223",midast:"*",midcir:"\u2AF0",middot:"\xB7",minus:"\u2212",minusb:"\u229F",minusd:"\u2238",minusdu:"\u2A2A",MinusPlus:"\u2213",mlcp:"\u2ADB",mldr:"\u2026",mnplus:"\u2213",models:"\u22A7",Mopf:"\u{1D544}",mopf:"\u{1D55E}",mp:"\u2213",Mscr:"\u2133",mscr:"\u{1D4C2}",mstpos:"\u223E",Mu:"\u039C",mu:"\u03BC",multimap:"\u22B8",mumap:"\u22B8",nabla:"\u2207",Nacute:"\u0143",nacute:"\u0144",nang:"\u2220\u20D2",nap:"\u2249",napE:"\u2A70\u0338",napid:"\u224B\u0338",napos:"\u0149",napprox:"\u2249",natur:"\u266E",natural:"\u266E",naturals:"\u2115",nbsp:"\xA0",nbump:"\u224E\u0338",nbumpe:"\u224F\u0338",ncap:"\u2A43",Ncaron:"\u0147",ncaron:"\u0148",Ncedil:"\u0145",ncedil:"\u0146",ncong:"\u2247",ncongdot:"\u2A6D\u0338",ncup:"\u2A42",Ncy:"\u041D",ncy:"\u043D",ndash:"\u2013",ne:"\u2260",nearhk:"\u2924",neArr:"\u21D7",nearr:"\u2197",nearrow:"\u2197",nedot:"\u2250\u0338",NegativeMediumSpace:"\u200B",NegativeThickSpace:"\u200B",NegativeThinSpace:"\u200B",NegativeVeryThinSpace:"\u200B",nequiv:"\u2262",nesear:"\u2928",nesim:"\u2242\u0338",NestedGreaterGreater:"\u226B",NestedLessLess:"\u226A",NewLine:`
`,nexist:"\u2204",nexists:"\u2204",Nfr:"\u{1D511}",nfr:"\u{1D52B}",ngE:"\u2267\u0338",nge:"\u2271",ngeq:"\u2271",ngeqq:"\u2267\u0338",ngeqslant:"\u2A7E\u0338",nges:"\u2A7E\u0338",nGg:"\u22D9\u0338",ngsim:"\u2275",nGt:"\u226B\u20D2",ngt:"\u226F",ngtr:"\u226F",nGtv:"\u226B\u0338",nhArr:"\u21CE",nharr:"\u21AE",nhpar:"\u2AF2",ni:"\u220B",nis:"\u22FC",nisd:"\u22FA",niv:"\u220B",NJcy:"\u040A",njcy:"\u045A",nlArr:"\u21CD",nlarr:"\u219A",nldr:"\u2025",nlE:"\u2266\u0338",nle:"\u2270",nLeftarrow:"\u21CD",nleftarrow:"\u219A",nLeftrightarrow:"\u21CE",nleftrightarrow:"\u21AE",nleq:"\u2270",nleqq:"\u2266\u0338",nleqslant:"\u2A7D\u0338",nles:"\u2A7D\u0338",nless:"\u226E",nLl:"\u22D8\u0338",nlsim:"\u2274",nLt:"\u226A\u20D2",nlt:"\u226E",nltri:"\u22EA",nltrie:"\u22EC",nLtv:"\u226A\u0338",nmid:"\u2224",NoBreak:"\u2060",NonBreakingSpace:"\xA0",Nopf:"\u2115",nopf:"\u{1D55F}",Not:"\u2AEC",not:"\xAC",NotCongruent:"\u2262",NotCupCap:"\u226D",NotDoubleVerticalBar:"\u2226",NotElement:"\u2209",NotEqual:"\u2260",NotEqualTilde:"\u2242\u0338",NotExists:"\u2204",NotGreater:"\u226F",NotGreaterEqual:"\u2271",NotGreaterFullEqual:"\u2267\u0338",NotGreaterGreater:"\u226B\u0338",NotGreaterLess:"\u2279",NotGreaterSlantEqual:"\u2A7E\u0338",NotGreaterTilde:"\u2275",NotHumpDownHump:"\u224E\u0338",NotHumpEqual:"\u224F\u0338",notin:"\u2209",notindot:"\u22F5\u0338",notinE:"\u22F9\u0338",notinva:"\u2209",notinvb:"\u22F7",notinvc:"\u22F6",NotLeftTriangle:"\u22EA",NotLeftTriangleBar:"\u29CF\u0338",NotLeftTriangleEqual:"\u22EC",NotLess:"\u226E",NotLessEqual:"\u2270",NotLessGreater:"\u2278",NotLessLess:"\u226A\u0338",NotLessSlantEqual:"\u2A7D\u0338",NotLessTilde:"\u2274",NotNestedGreaterGreater:"\u2AA2\u0338",NotNestedLessLess:"\u2AA1\u0338",notni:"\u220C",notniva:"\u220C",notnivb:"\u22FE",notnivc:"\u22FD",NotPrecedes:"\u2280",NotPrecedesEqual:"\u2AAF\u0338",NotPrecedesSlantEqual:"\u22E0",NotReverseElement:"\u220C",NotRightTriangle:"\u22EB",NotRightTriangleBar:"\u29D0\u0338",NotRightTriangleEqual:"\u22ED",NotSquareSubset:"\u228F\u0338",NotSquareSubsetEqual:"\u22E2",NotSquareSuperset:"\u2290\u0338",NotSquareSupersetEqual:"\u22E3",NotSubset:"\u2282\u20D2",NotSubsetEqual:"\u2288",NotSucceeds:"\u2281",NotSucceedsEqual:"\u2AB0\u0338",NotSucceedsSlantEqual:"\u22E1",NotSucceedsTilde:"\u227F\u0338",NotSuperset:"\u2283\u20D2",NotSupersetEqual:"\u2289",NotTilde:"\u2241",NotTildeEqual:"\u2244",NotTildeFullEqual:"\u2247",NotTildeTilde:"\u2249",NotVerticalBar:"\u2224",npar:"\u2226",nparallel:"\u2226",nparsl:"\u2AFD\u20E5",npart:"\u2202\u0338",npolint:"\u2A14",npr:"\u2280",nprcue:"\u22E0",npre:"\u2AAF\u0338",nprec:"\u2280",npreceq:"\u2AAF\u0338",nrArr:"\u21CF",nrarr:"\u219B",nrarrc:"\u2933\u0338",nrarrw:"\u219D\u0338",nRightarrow:"\u21CF",nrightarrow:"\u219B",nrtri:"\u22EB",nrtrie:"\u22ED",nsc:"\u2281",nsccue:"\u22E1",nsce:"\u2AB0\u0338",Nscr:"\u{1D4A9}",nscr:"\u{1D4C3}",nshortmid:"\u2224",nshortparallel:"\u2226",nsim:"\u2241",nsime:"\u2244",nsimeq:"\u2244",nsmid:"\u2224",nspar:"\u2226",nsqsube:"\u22E2",nsqsupe:"\u22E3",nsub:"\u2284",nsubE:"\u2AC5\u0338",nsube:"\u2288",nsubset:"\u2282\u20D2",nsubseteq:"\u2288",nsubseteqq:"\u2AC5\u0338",nsucc:"\u2281",nsucceq:"\u2AB0\u0338",nsup:"\u2285",nsupE:"\u2AC6\u0338",nsupe:"\u2289",nsupset:"\u2283\u20D2",nsupseteq:"\u2289",nsupseteqq:"\u2AC6\u0338",ntgl:"\u2279",Ntilde:"\xD1",ntilde:"\xF1",ntlg:"\u2278",ntriangleleft:"\u22EA",ntrianglelefteq:"\u22EC",ntriangleright:"\u22EB",ntrianglerighteq:"\u22ED",Nu:"\u039D",nu:"\u03BD",num:"#",numero:"\u2116",numsp:"\u2007",nvap:"\u224D\u20D2",nVDash:"\u22AF",nVdash:"\u22AE",nvDash:"\u22AD",nvdash:"\u22AC",nvge:"\u2265\u20D2",nvgt:">\u20D2",nvHarr:"\u2904",nvinfin:"\u29DE",nvlArr:"\u2902",nvle:"\u2264\u20D2",nvlt:"<\u20D2",nvltrie:"\u22B4\u20D2",nvrArr:"\u2903",nvrtrie:"\u22B5\u20D2",nvsim:"\u223C\u20D2",nwarhk:"\u2923",nwArr:"\u21D6",nwarr:"\u2196",nwarrow:"\u2196",nwnear:"\u2927",Oacute:"\xD3",oacute:"\xF3",oast:"\u229B",ocir:"\u229A",Ocirc:"\xD4",ocirc:"\xF4",Ocy:"\u041E",ocy:"\u043E",odash:"\u229D",Odblac:"\u0150",odblac:"\u0151",odiv:"\u2A38",odot:"\u2299",odsold:"\u29BC",OElig:"\u0152",oelig:"\u0153",ofcir:"\u29BF",Ofr:"\u{1D512}",ofr:"\u{1D52C}",ogon:"\u02DB",Ograve:"\xD2",ograve:"\xF2",ogt:"\u29C1",ohbar:"\u29B5",ohm:"\u03A9",oint:"\u222E",olarr:"\u21BA",olcir:"\u29BE",olcross:"\u29BB",oline:"\u203E",olt:"\u29C0",Omacr:"\u014C",omacr:"\u014D",Omega:"\u03A9",omega:"\u03C9",Omicron:"\u039F",omicron:"\u03BF",omid:"\u29B6",ominus:"\u2296",Oopf:"\u{1D546}",oopf:"\u{1D560}",opar:"\u29B7",OpenCurlyDoubleQuote:"\u201C",OpenCurlyQuote:"\u2018",operp:"\u29B9",oplus:"\u2295",Or:"\u2A54",or:"\u2228",orarr:"\u21BB",ord:"\u2A5D",order:"\u2134",orderof:"\u2134",ordf:"\xAA",ordm:"\xBA",origof:"\u22B6",oror:"\u2A56",orslope:"\u2A57",orv:"\u2A5B",oS:"\u24C8",Oscr:"\u{1D4AA}",oscr:"\u2134",Oslash:"\xD8",oslash:"\xF8",osol:"\u2298",Otilde:"\xD5",otilde:"\xF5",Otimes:"\u2A37",otimes:"\u2297",otimesas:"\u2A36",Ouml:"\xD6",ouml:"\xF6",ovbar:"\u233D",OverBar:"\u203E",OverBrace:"\u23DE",OverBracket:"\u23B4",OverParenthesis:"\u23DC",par:"\u2225",para:"\xB6",parallel:"\u2225",parsim:"\u2AF3",parsl:"\u2AFD",part:"\u2202",PartialD:"\u2202",Pcy:"\u041F",pcy:"\u043F",percnt:"%",period:".",permil:"\u2030",perp:"\u22A5",pertenk:"\u2031",Pfr:"\u{1D513}",pfr:"\u{1D52D}",Phi:"\u03A6",phi:"\u03C6",phiv:"\u03D5",phmmat:"\u2133",phone:"\u260E",Pi:"\u03A0",pi:"\u03C0",pitchfork:"\u22D4",piv:"\u03D6",planck:"\u210F",planckh:"\u210E",plankv:"\u210F",plus:"+",plusacir:"\u2A23",plusb:"\u229E",pluscir:"\u2A22",plusdo:"\u2214",plusdu:"\u2A25",pluse:"\u2A72",PlusMinus:"\xB1",plusmn:"\xB1",plussim:"\u2A26",plustwo:"\u2A27",pm:"\xB1",Poincareplane:"\u210C",pointint:"\u2A15",Popf:"\u2119",popf:"\u{1D561}",pound:"\xA3",Pr:"\u2ABB",pr:"\u227A",prap:"\u2AB7",prcue:"\u227C",prE:"\u2AB3",pre:"\u2AAF",prec:"\u227A",precapprox:"\u2AB7",preccurlyeq:"\u227C",Precedes:"\u227A",PrecedesEqual:"\u2AAF",PrecedesSlantEqual:"\u227C",PrecedesTilde:"\u227E",preceq:"\u2AAF",precnapprox:"\u2AB9",precneqq:"\u2AB5",precnsim:"\u22E8",precsim:"\u227E",Prime:"\u2033",prime:"\u2032",primes:"\u2119",prnap:"\u2AB9",prnE:"\u2AB5",prnsim:"\u22E8",prod:"\u220F",Product:"\u220F",profalar:"\u232E",profline:"\u2312",profsurf:"\u2313",prop:"\u221D",Proportion:"\u2237",Proportional:"\u221D",propto:"\u221D",prsim:"\u227E",prurel:"\u22B0",Pscr:"\u{1D4AB}",pscr:"\u{1D4C5}",Psi:"\u03A8",psi:"\u03C8",puncsp:"\u2008",Qfr:"\u{1D514}",qfr:"\u{1D52E}",qint:"\u2A0C",Qopf:"\u211A",qopf:"\u{1D562}",qprime:"\u2057",Qscr:"\u{1D4AC}",qscr:"\u{1D4C6}",quaternions:"\u210D",quatint:"\u2A16",quest:"?",questeq:"\u225F",QUOT:'"',quot:'"',rAarr:"\u21DB",race:"\u223D\u0331",Racute:"\u0154",racute:"\u0155",radic:"\u221A",raemptyv:"\u29B3",Rang:"\u27EB",rang:"\u27E9",rangd:"\u2992",range:"\u29A5",rangle:"\u27E9",raquo:"\xBB",Rarr:"\u21A0",rArr:"\u21D2",rarr:"\u2192",rarrap:"\u2975",rarrb:"\u21E5",rarrbfs:"\u2920",rarrc:"\u2933",rarrfs:"\u291E",rarrhk:"\u21AA",rarrlp:"\u21AC",rarrpl:"\u2945",rarrsim:"\u2974",Rarrtl:"\u2916",rarrtl:"\u21A3",rarrw:"\u219D",rAtail:"\u291C",ratail:"\u291A",ratio:"\u2236",rationals:"\u211A",RBarr:"\u2910",rBarr:"\u290F",rbarr:"\u290D",rbbrk:"\u2773",rbrace:"}",rbrack:"]",rbrke:"\u298C",rbrksld:"\u298E",rbrkslu:"\u2990",Rcaron:"\u0158",rcaron:"\u0159",Rcedil:"\u0156",rcedil:"\u0157",rceil:"\u2309",rcub:"}",Rcy:"\u0420",rcy:"\u0440",rdca:"\u2937",rdldhar:"\u2969",rdquo:"\u201D",rdquor:"\u201D",rdsh:"\u21B3",Re:"\u211C",real:"\u211C",realine:"\u211B",realpart:"\u211C",reals:"\u211D",rect:"\u25AD",REG:"\xAE",reg:"\xAE",ReverseElement:"\u220B",ReverseEquilibrium:"\u21CB",ReverseUpEquilibrium:"\u296F",rfisht:"\u297D",rfloor:"\u230B",Rfr:"\u211C",rfr:"\u{1D52F}",rHar:"\u2964",rhard:"\u21C1",rharu:"\u21C0",rharul:"\u296C",Rho:"\u03A1",rho:"\u03C1",rhov:"\u03F1",RightAngleBracket:"\u27E9",RightArrow:"\u2192",Rightarrow:"\u21D2",rightarrow:"\u2192",RightArrowBar:"\u21E5",RightArrowLeftArrow:"\u21C4",rightarrowtail:"\u21A3",RightCeiling:"\u2309",RightDoubleBracket:"\u27E7",RightDownTeeVector:"\u295D",RightDownVector:"\u21C2",RightDownVectorBar:"\u2955",RightFloor:"\u230B",rightharpoondown:"\u21C1",rightharpoonup:"\u21C0",rightleftarrows:"\u21C4",rightleftharpoons:"\u21CC",rightrightarrows:"\u21C9",rightsquigarrow:"\u219D",RightTee:"\u22A2",RightTeeArrow:"\u21A6",RightTeeVector:"\u295B",rightthreetimes:"\u22CC",RightTriangle:"\u22B3",RightTriangleBar:"\u29D0",RightTriangleEqual:"\u22B5",RightUpDownVector:"\u294F",RightUpTeeVector:"\u295C",RightUpVector:"\u21BE",RightUpVectorBar:"\u2954",RightVector:"\u21C0",RightVectorBar:"\u2953",ring:"\u02DA",risingdotseq:"\u2253",rlarr:"\u21C4",rlhar:"\u21CC",rlm:"\u200F",rmoust:"\u23B1",rmoustache:"\u23B1",rnmid:"\u2AEE",roang:"\u27ED",roarr:"\u21FE",robrk:"\u27E7",ropar:"\u2986",Ropf:"\u211D",ropf:"\u{1D563}",roplus:"\u2A2E",rotimes:"\u2A35",RoundImplies:"\u2970",rpar:")",rpargt:"\u2994",rppolint:"\u2A12",rrarr:"\u21C9",Rrightarrow:"\u21DB",rsaquo:"\u203A",Rscr:"\u211B",rscr:"\u{1D4C7}",Rsh:"\u21B1",rsh:"\u21B1",rsqb:"]",rsquo:"\u2019",rsquor:"\u2019",rthree:"\u22CC",rtimes:"\u22CA",rtri:"\u25B9",rtrie:"\u22B5",rtrif:"\u25B8",rtriltri:"\u29CE",RuleDelayed:"\u29F4",ruluhar:"\u2968",rx:"\u211E",Sacute:"\u015A",sacute:"\u015B",sbquo:"\u201A",Sc:"\u2ABC",sc:"\u227B",scap:"\u2AB8",Scaron:"\u0160",scaron:"\u0161",sccue:"\u227D",scE:"\u2AB4",sce:"\u2AB0",Scedil:"\u015E",scedil:"\u015F",Scirc:"\u015C",scirc:"\u015D",scnap:"\u2ABA",scnE:"\u2AB6",scnsim:"\u22E9",scpolint:"\u2A13",scsim:"\u227F",Scy:"\u0421",scy:"\u0441",sdot:"\u22C5",sdotb:"\u22A1",sdote:"\u2A66",searhk:"\u2925",seArr:"\u21D8",searr:"\u2198",searrow:"\u2198",sect:"\xA7",semi:";",seswar:"\u2929",setminus:"\u2216",setmn:"\u2216",sext:"\u2736",Sfr:"\u{1D516}",sfr:"\u{1D530}",sfrown:"\u2322",sharp:"\u266F",SHCHcy:"\u0429",shchcy:"\u0449",SHcy:"\u0428",shcy:"\u0448",ShortDownArrow:"\u2193",ShortLeftArrow:"\u2190",shortmid:"\u2223",shortparallel:"\u2225",ShortRightArrow:"\u2192",ShortUpArrow:"\u2191",shy:"\xAD",Sigma:"\u03A3",sigma:"\u03C3",sigmaf:"\u03C2",sigmav:"\u03C2",sim:"\u223C",simdot:"\u2A6A",sime:"\u2243",simeq:"\u2243",simg:"\u2A9E",simgE:"\u2AA0",siml:"\u2A9D",simlE:"\u2A9F",simne:"\u2246",simplus:"\u2A24",simrarr:"\u2972",slarr:"\u2190",SmallCircle:"\u2218",smallsetminus:"\u2216",smashp:"\u2A33",smeparsl:"\u29E4",smid:"\u2223",smile:"\u2323",smt:"\u2AAA",smte:"\u2AAC",smtes:"\u2AAC\uFE00",SOFTcy:"\u042C",softcy:"\u044C",sol:"/",solb:"\u29C4",solbar:"\u233F",Sopf:"\u{1D54A}",sopf:"\u{1D564}",spades:"\u2660",spadesuit:"\u2660",spar:"\u2225",sqcap:"\u2293",sqcaps:"\u2293\uFE00",sqcup:"\u2294",sqcups:"\u2294\uFE00",Sqrt:"\u221A",sqsub:"\u228F",sqsube:"\u2291",sqsubset:"\u228F",sqsubseteq:"\u2291",sqsup:"\u2290",sqsupe:"\u2292",sqsupset:"\u2290",sqsupseteq:"\u2292",squ:"\u25A1",Square:"\u25A1",square:"\u25A1",SquareIntersection:"\u2293",SquareSubset:"\u228F",SquareSubsetEqual:"\u2291",SquareSuperset:"\u2290",SquareSupersetEqual:"\u2292",SquareUnion:"\u2294",squarf:"\u25AA",squf:"\u25AA",srarr:"\u2192",Sscr:"\u{1D4AE}",sscr:"\u{1D4C8}",ssetmn:"\u2216",ssmile:"\u2323",sstarf:"\u22C6",Star:"\u22C6",star:"\u2606",starf:"\u2605",straightepsilon:"\u03F5",straightphi:"\u03D5",strns:"\xAF",Sub:"\u22D0",sub:"\u2282",subdot:"\u2ABD",subE:"\u2AC5",sube:"\u2286",subedot:"\u2AC3",submult:"\u2AC1",subnE:"\u2ACB",subne:"\u228A",subplus:"\u2ABF",subrarr:"\u2979",Subset:"\u22D0",subset:"\u2282",subseteq:"\u2286",subseteqq:"\u2AC5",SubsetEqual:"\u2286",subsetneq:"\u228A",subsetneqq:"\u2ACB",subsim:"\u2AC7",subsub:"\u2AD5",subsup:"\u2AD3",succ:"\u227B",succapprox:"\u2AB8",succcurlyeq:"\u227D",Succeeds:"\u227B",SucceedsEqual:"\u2AB0",SucceedsSlantEqual:"\u227D",SucceedsTilde:"\u227F",succeq:"\u2AB0",succnapprox:"\u2ABA",succneqq:"\u2AB6",succnsim:"\u22E9",succsim:"\u227F",SuchThat:"\u220B",Sum:"\u2211",sum:"\u2211",sung:"\u266A",Sup:"\u22D1",sup:"\u2283",sup1:"\xB9",sup2:"\xB2",sup3:"\xB3",supdot:"\u2ABE",supdsub:"\u2AD8",supE:"\u2AC6",supe:"\u2287",supedot:"\u2AC4",Superset:"\u2283",SupersetEqual:"\u2287",suphsol:"\u27C9",suphsub:"\u2AD7",suplarr:"\u297B",supmult:"\u2AC2",supnE:"\u2ACC",supne:"\u228B",supplus:"\u2AC0",Supset:"\u22D1",supset:"\u2283",supseteq:"\u2287",supseteqq:"\u2AC6",supsetneq:"\u228B",supsetneqq:"\u2ACC",supsim:"\u2AC8",supsub:"\u2AD4",supsup:"\u2AD6",swarhk:"\u2926",swArr:"\u21D9",swarr:"\u2199",swarrow:"\u2199",swnwar:"\u292A",szlig:"\xDF",Tab:"	",target:"\u2316",Tau:"\u03A4",tau:"\u03C4",tbrk:"\u23B4",Tcaron:"\u0164",tcaron:"\u0165",Tcedil:"\u0162",tcedil:"\u0163",Tcy:"\u0422",tcy:"\u0442",tdot:"\u20DB",telrec:"\u2315",Tfr:"\u{1D517}",tfr:"\u{1D531}",there4:"\u2234",Therefore:"\u2234",therefore:"\u2234",Theta:"\u0398",theta:"\u03B8",thetasym:"\u03D1",thetav:"\u03D1",thickapprox:"\u2248",thicksim:"\u223C",ThickSpace:"\u205F\u200A",thinsp:"\u2009",ThinSpace:"\u2009",thkap:"\u2248",thksim:"\u223C",THORN:"\xDE",thorn:"\xFE",Tilde:"\u223C",tilde:"\u02DC",TildeEqual:"\u2243",TildeFullEqual:"\u2245",TildeTilde:"\u2248",times:"\xD7",timesb:"\u22A0",timesbar:"\u2A31",timesd:"\u2A30",tint:"\u222D",toea:"\u2928",top:"\u22A4",topbot:"\u2336",topcir:"\u2AF1",Topf:"\u{1D54B}",topf:"\u{1D565}",topfork:"\u2ADA",tosa:"\u2929",tprime:"\u2034",TRADE:"\u2122",trade:"\u2122",triangle:"\u25B5",triangledown:"\u25BF",triangleleft:"\u25C3",trianglelefteq:"\u22B4",triangleq:"\u225C",triangleright:"\u25B9",trianglerighteq:"\u22B5",tridot:"\u25EC",trie:"\u225C",triminus:"\u2A3A",TripleDot:"\u20DB",triplus:"\u2A39",trisb:"\u29CD",tritime:"\u2A3B",trpezium:"\u23E2",Tscr:"\u{1D4AF}",tscr:"\u{1D4C9}",TScy:"\u0426",tscy:"\u0446",TSHcy:"\u040B",tshcy:"\u045B",Tstrok:"\u0166",tstrok:"\u0167",twixt:"\u226C",twoheadleftarrow:"\u219E",twoheadrightarrow:"\u21A0",Uacute:"\xDA",uacute:"\xFA",Uarr:"\u219F",uArr:"\u21D1",uarr:"\u2191",Uarrocir:"\u2949",Ubrcy:"\u040E",ubrcy:"\u045E",Ubreve:"\u016C",ubreve:"\u016D",Ucirc:"\xDB",ucirc:"\xFB",Ucy:"\u0423",ucy:"\u0443",udarr:"\u21C5",Udblac:"\u0170",udblac:"\u0171",udhar:"\u296E",ufisht:"\u297E",Ufr:"\u{1D518}",ufr:"\u{1D532}",Ugrave:"\xD9",ugrave:"\xF9",uHar:"\u2963",uharl:"\u21BF",uharr:"\u21BE",uhblk:"\u2580",ulcorn:"\u231C",ulcorner:"\u231C",ulcrop:"\u230F",ultri:"\u25F8",Umacr:"\u016A",umacr:"\u016B",uml:"\xA8",UnderBar:"_",UnderBrace:"\u23DF",UnderBracket:"\u23B5",UnderParenthesis:"\u23DD",Union:"\u22C3",UnionPlus:"\u228E",Uogon:"\u0172",uogon:"\u0173",Uopf:"\u{1D54C}",uopf:"\u{1D566}",UpArrow:"\u2191",Uparrow:"\u21D1",uparrow:"\u2191",UpArrowBar:"\u2912",UpArrowDownArrow:"\u21C5",UpDownArrow:"\u2195",Updownarrow:"\u21D5",updownarrow:"\u2195",UpEquilibrium:"\u296E",upharpoonleft:"\u21BF",upharpoonright:"\u21BE",uplus:"\u228E",UpperLeftArrow:"\u2196",UpperRightArrow:"\u2197",Upsi:"\u03D2",upsi:"\u03C5",upsih:"\u03D2",Upsilon:"\u03A5",upsilon:"\u03C5",UpTee:"\u22A5",UpTeeArrow:"\u21A5",upuparrows:"\u21C8",urcorn:"\u231D",urcorner:"\u231D",urcrop:"\u230E",Uring:"\u016E",uring:"\u016F",urtri:"\u25F9",Uscr:"\u{1D4B0}",uscr:"\u{1D4CA}",utdot:"\u22F0",Utilde:"\u0168",utilde:"\u0169",utri:"\u25B5",utrif:"\u25B4",uuarr:"\u21C8",Uuml:"\xDC",uuml:"\xFC",uwangle:"\u29A7",vangrt:"\u299C",varepsilon:"\u03F5",varkappa:"\u03F0",varnothing:"\u2205",varphi:"\u03D5",varpi:"\u03D6",varpropto:"\u221D",vArr:"\u21D5",varr:"\u2195",varrho:"\u03F1",varsigma:"\u03C2",varsubsetneq:"\u228A\uFE00",varsubsetneqq:"\u2ACB\uFE00",varsupsetneq:"\u228B\uFE00",varsupsetneqq:"\u2ACC\uFE00",vartheta:"\u03D1",vartriangleleft:"\u22B2",vartriangleright:"\u22B3",Vbar:"\u2AEB",vBar:"\u2AE8",vBarv:"\u2AE9",Vcy:"\u0412",vcy:"\u0432",VDash:"\u22AB",Vdash:"\u22A9",vDash:"\u22A8",vdash:"\u22A2",Vdashl:"\u2AE6",Vee:"\u22C1",vee:"\u2228",veebar:"\u22BB",veeeq:"\u225A",vellip:"\u22EE",Verbar:"\u2016",verbar:"|",Vert:"\u2016",vert:"|",VerticalBar:"\u2223",VerticalLine:"|",VerticalSeparator:"\u2758",VerticalTilde:"\u2240",VeryThinSpace:"\u200A",Vfr:"\u{1D519}",vfr:"\u{1D533}",vltri:"\u22B2",vnsub:"\u2282\u20D2",vnsup:"\u2283\u20D2",Vopf:"\u{1D54D}",vopf:"\u{1D567}",vprop:"\u221D",vrtri:"\u22B3",Vscr:"\u{1D4B1}",vscr:"\u{1D4CB}",vsubnE:"\u2ACB\uFE00",vsubne:"\u228A\uFE00",vsupnE:"\u2ACC\uFE00",vsupne:"\u228B\uFE00",Vvdash:"\u22AA",vzigzag:"\u299A",Wcirc:"\u0174",wcirc:"\u0175",wedbar:"\u2A5F",Wedge:"\u22C0",wedge:"\u2227",wedgeq:"\u2259",weierp:"\u2118",Wfr:"\u{1D51A}",wfr:"\u{1D534}",Wopf:"\u{1D54E}",wopf:"\u{1D568}",wp:"\u2118",wr:"\u2240",wreath:"\u2240",Wscr:"\u{1D4B2}",wscr:"\u{1D4CC}",xcap:"\u22C2",xcirc:"\u25EF",xcup:"\u22C3",xdtri:"\u25BD",Xfr:"\u{1D51B}",xfr:"\u{1D535}",xhArr:"\u27FA",xharr:"\u27F7",Xi:"\u039E",xi:"\u03BE",xlArr:"\u27F8",xlarr:"\u27F5",xmap:"\u27FC",xnis:"\u22FB",xodot:"\u2A00",Xopf:"\u{1D54F}",xopf:"\u{1D569}",xoplus:"\u2A01",xotime:"\u2A02",xrArr:"\u27F9",xrarr:"\u27F6",Xscr:"\u{1D4B3}",xscr:"\u{1D4CD}",xsqcup:"\u2A06",xuplus:"\u2A04",xutri:"\u25B3",xvee:"\u22C1",xwedge:"\u22C0",Yacute:"\xDD",yacute:"\xFD",YAcy:"\u042F",yacy:"\u044F",Ycirc:"\u0176",ycirc:"\u0177",Ycy:"\u042B",ycy:"\u044B",yen:"\xA5",Yfr:"\u{1D51C}",yfr:"\u{1D536}",YIcy:"\u0407",yicy:"\u0457",Yopf:"\u{1D550}",yopf:"\u{1D56A}",Yscr:"\u{1D4B4}",yscr:"\u{1D4CE}",YUcy:"\u042E",yucy:"\u044E",Yuml:"\u0178",yuml:"\xFF",Zacute:"\u0179",zacute:"\u017A",Zcaron:"\u017D",zcaron:"\u017E",Zcy:"\u0417",zcy:"\u0437",Zdot:"\u017B",zdot:"\u017C",zeetrf:"\u2128",ZeroWidthSpace:"\u200B",Zeta:"\u0396",zeta:"\u03B6",Zfr:"\u2128",zfr:"\u{1D537}",ZHcy:"\u0416",zhcy:"\u0436",zigrarr:"\u21DD",Zopf:"\u2124",zopf:"\u{1D56B}",Zscr:"\u{1D4B5}",zscr:"\u{1D4CF}",zwj:"\u200D",zwnj:"\u200C"}),yt.entityMap=yt.HTML_ENTITIES},3969:function(Tt,yt,Ne){var We,rt=Ne(41146);We=rt.DOMImplementation,We=rt.XMLSerializer,yt.DOMParser=Ne(86129).DOMParser},76925:function(Tt,yt,Ne){var We=Ne(72167).NAMESPACE,rt=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,q=new RegExp("[\\-\\.0-9"+rt.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),Oe=new RegExp("^"+rt.source+q.source+"*(?::"+rt.source+q.source+"*)?$"),Ee=0,fe=1,ce=2,le=3,Z=4,oe=5,V=6,A=7;function I(k,j){this.message=k,this.locator=j,Error.captureStackTrace&&Error.captureStackTrace(this,I)}I.prototype=new Error,I.prototype.name=I.name;function U(){}U.prototype={parse:function(k,j,Y){var ne=this.domBuilder;ne.startDocument(),P(j,j={}),w(k,j,Y,ne,this.errorHandler),ne.endDocument()}};function w(k,j,Y,ne,he){function _e(Ht){if(Ht>65535){Ht-=65536;var tt=55296+(Ht>>10),ni=56320+(Ht&1023);return String.fromCharCode(tt,ni)}else return String.fromCharCode(Ht)}function ye(Ht){var tt=Ht.slice(1,-1);return Object.hasOwnProperty.call(Y,tt)?Y[tt]:tt.charAt(0)==="#"?_e(parseInt(tt.substr(1).replace("x","0x"))):(he.error("entity not found:"+Ht),Ht)}function ve(Ht){if(Ht>Xe){var tt=k.substring(Xe,Ht).replace(/&#?\w+;/g,ye);qe&&Te(Xe),ne.characters(tt,0,Ht-Xe),Xe=Ht}}function Te(Ht,tt){for(;Ht>=De&&(tt=xe.exec(k));)be=tt.index,De=be+tt[0].length,qe.lineNumber++;qe.columnNumber=Ht-be+1}for(var be=0,De=0,xe=/.*(?:\r\n?|\n)|.*$/g,qe=ne.locator,vt=[{currentNSMap:j}],st={},Xe=0;;){try{var Ye=k.indexOf("<",Xe);if(Ye<0){if(!k.substr(Xe).match(/^\s*$/)){var Ft=ne.doc,lt=Ft.createTextNode(k.substr(Xe));Ft.appendChild(lt),ne.currentElement=lt}return}switch(Ye>Xe&&ve(Ye),k.charAt(Ye+1)){case"/":var _t=k.indexOf(">",Ye+3),Mt=k.substring(Ye+2,_t).replace(/[ \t\n\r]+$/g,""),It=vt.pop();_t<0?(Mt=k.substring(Ye+2).replace(/[\s<].*/,""),he.error("end tag name: "+Mt+" is not complete:"+It.tagName),_t=Ye+1+Mt.length):Mt.match(/\s</)&&(Mt=Mt.replace(/[\s<].*/,""),he.error("end tag name: "+Mt+" maybe not complete"),_t=Ye+1+Mt.length);var Jt=It.localNSMap,Zt=It.tagName==Mt,at=Zt||It.tagName&&It.tagName.toLowerCase()==Mt.toLowerCase();if(at){if(ne.endElement(It.uri,It.localName,Mt),Jt)for(var Nt in Jt)Object.prototype.hasOwnProperty.call(Jt,Nt)&&ne.endPrefixMapping(Nt);Zt||he.fatalError("end tag name: "+Mt+" is not match the current start tagName:"+It.tagName)}else vt.push(It);_t++;break;case"?":qe&&Te(Ye),_t=H(k,Ye,ne);break;case"!":qe&&Te(Ye),_t=S(k,Ye,ne,he);break;default:qe&&Te(Ye);var $t=new X,Ci=vt[vt.length-1].currentNSMap,_t=$(k,Ye,$t,Ci,ye,he),Gi=$t.length;if(!$t.closed&&O(k,_t,$t.tagName,st)&&($t.closed=!0,Y.nbsp||he.warning("unclosed xml attribute")),qe&&Gi){for(var Pi=F(qe,{}),Mi=0;Mi<Gi;Mi++){var ki=$t[Mi];Te(ki.offset),ki.locator=F(qe,{})}ne.locator=Pi,C($t,ne,Ci)&&vt.push($t),ne.locator=qe}else C($t,ne,Ci)&&vt.push($t);We.isHTML($t.uri)&&!$t.closed?_t=B(k,_t,$t.tagName,ye,ne):_t++}}catch(Ht){if(Ht instanceof I)throw Ht;he.error("element parse error: "+Ht),_t=-1}_t>Xe?Xe=_t:ve(Math.max(Ye,Xe)+1)}}function F(k,j){return j.lineNumber=k.lineNumber,j.columnNumber=k.columnNumber,j}function $(k,j,Y,ne,he,_e){function ye(vt,st,Xe){Y.attributeNames.hasOwnProperty(vt)&&_e.fatalError("Attribute "+vt+" redefined"),Y.addValue(vt,st.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,he),Xe)}for(var ve,Te,be=++j,De=Ee;;){var xe=k.charAt(be);switch(xe){case"=":if(De===fe)ve=k.slice(j,be),De=le;else if(De===ce)De=le;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(De===le||De===fe)if(De===fe&&(_e.warning('attribute value must after "="'),ve=k.slice(j,be)),j=be+1,be=k.indexOf(xe,j),be>0)Te=k.slice(j,be),ye(ve,Te,j-1),De=oe;else throw new Error("attribute value no end '"+xe+"' match");else if(De==Z)Te=k.slice(j,be),ye(ve,Te,j),_e.warning('attribute "'+ve+'" missed start quot('+xe+")!!"),j=be+1,De=oe;else throw new Error('attribute value must after "="');break;case"/":switch(De){case Ee:Y.setTagName(k.slice(j,be));case oe:case V:case A:De=A,Y.closed=!0;case Z:case fe:break;case ce:Y.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return _e.error("unexpected end of input"),De==Ee&&Y.setTagName(k.slice(j,be)),be;case">":switch(De){case Ee:Y.setTagName(k.slice(j,be));case oe:case V:case A:break;case Z:case fe:Te=k.slice(j,be),Te.slice(-1)==="/"&&(Y.closed=!0,Te=Te.slice(0,-1));case ce:De===ce&&(Te=ve),De==Z?(_e.warning('attribute "'+Te+'" missed quot(")!'),ye(ve,Te,j)):((!We.isHTML(ne[""])||!Te.match(/^(?:disabled|checked|selected)$/i))&&_e.warning('attribute "'+Te+'" missed value!! "'+Te+'" instead!!'),ye(Te,Te,j));break;case le:throw new Error("attribute value missed!!")}return be;case"\x80":xe=" ";default:if(xe<=" ")switch(De){case Ee:Y.setTagName(k.slice(j,be)),De=V;break;case fe:ve=k.slice(j,be),De=ce;break;case Z:var Te=k.slice(j,be);_e.warning('attribute "'+Te+'" missed quot(")!!'),ye(ve,Te,j);case oe:De=V;break}else switch(De){case ce:var qe=Y.tagName;(!We.isHTML(ne[""])||!ve.match(/^(?:disabled|checked|selected)$/i))&&_e.warning('attribute "'+ve+'" missed value!! "'+ve+'" instead2!!'),ye(ve,ve,j),j=be,De=fe;break;case oe:_e.warning('attribute space is required"'+ve+'"!!');case V:De=fe,j=be;break;case le:De=Z,j=be;break;case A:throw new Error("elements closed character '/' and '>' must be connected to")}}be++}}function C(k,j,Y){for(var ne=k.tagName,he=null,_e=k.length;_e--;){var ye=k[_e],ve=ye.qName,Te=ye.value,qe=ve.indexOf(":");if(qe>0)var be=ye.prefix=ve.slice(0,qe),De=ve.slice(qe+1),xe=be==="xmlns"&&De;else De=ve,be=null,xe=ve==="xmlns"&&"";ye.localName=De,xe!==!1&&(he==null&&(he={},P(Y,Y={})),Y[xe]=he[xe]=Te,ye.uri=We.XMLNS,j.startPrefixMapping(xe,Te))}for(var _e=k.length;_e--;){ye=k[_e];var be=ye.prefix;be&&(be==="xml"&&(ye.uri=We.XML),be!=="xmlns"&&(ye.uri=Y[be||""]))}var qe=ne.indexOf(":");qe>0?(be=k.prefix=ne.slice(0,qe),De=k.localName=ne.slice(qe+1)):(be=null,De=k.localName=ne);var vt=k.uri=Y[be||""];if(j.startElement(vt,De,ne,k),k.closed){if(j.endElement(vt,De,ne),he)for(be in he)Object.prototype.hasOwnProperty.call(he,be)&&j.endPrefixMapping(be)}else return k.currentNSMap=Y,k.localNSMap=he,!0}function B(k,j,Y,ne,he){if(/^(?:script|textarea)$/i.test(Y)){var _e=k.indexOf("</"+Y+">",j),ye=k.substring(j+1,_e);if(/[&<]/.test(ye))return/^script$/i.test(Y)?(he.characters(ye,0,ye.length),_e):(ye=ye.replace(/&#?\w+;/g,ne),he.characters(ye,0,ye.length),_e)}return j+1}function O(k,j,Y,ne){var he=ne[Y];return he==null&&(he=k.lastIndexOf("</"+Y+">"),he<j&&(he=k.lastIndexOf("</"+Y)),ne[Y]=he),he<j}function P(k,j){for(var Y in k)Object.prototype.hasOwnProperty.call(k,Y)&&(j[Y]=k[Y])}function S(k,j,Y,ne){var he=k.charAt(j+2);switch(he){case"-":if(k.charAt(j+3)==="-"){var _e=k.indexOf("-->",j+4);return _e>j?(Y.comment(k,j+4,_e-j-4),_e+3):(ne.error("Unclosed comment"),-1)}else return-1;default:if(k.substr(j+3,6)=="CDATA["){var _e=k.indexOf("]]>",j+9);return Y.startCDATA(),Y.characters(k,j+9,_e-j-9),Y.endCDATA(),_e+3}var ye=ie(k,j),ve=ye.length;if(ve>1&&/!doctype/i.test(ye[0][0])){var Te=ye[1][0],be=!1,De=!1;ve>3&&(/^public$/i.test(ye[2][0])?(be=ye[3][0],De=ve>4&&ye[4][0]):/^system$/i.test(ye[2][0])&&(De=ye[3][0]));var xe=ye[ve-1];return Y.startDTD(Te,be,De),Y.endDTD(),xe.index+xe[0].length}}return-1}function H(k,j,Y){var ne=k.indexOf("?>",j);if(ne){var he=k.substring(j,ne).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(he){var _e=he[0].length;return Y.processingInstruction(he[1],he[2]),ne+2}else return-1}return-1}function X(){this.attributeNames={}}X.prototype={setTagName:function(k){if(!Oe.test(k))throw new Error("invalid tagName:"+k);this.tagName=k},addValue:function(k,j,Y){if(!Oe.test(k))throw new Error("invalid attribute:"+k);this.attributeNames[k]=this.length,this[this.length++]={qName:k,value:j,offset:Y}},length:0,getLocalName:function(k){return this[k].localName},getLocator:function(k){return this[k].locator},getQName:function(k){return this[k].qName},getURI:function(k){return this[k].uri},getValue:function(k){return this[k].value}};function ie(k,j){var Y,ne=[],he=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(he.lastIndex=j,he.exec(k);Y=he.exec(k);)if(ne.push(Y),Y[1])return ne}yt.XMLReader=U,yt.ParseError=I},5953:function(Tt,yt,Ne){var We=Ne(48764).Buffer;(function(rt,q){Tt.exports=q()})(self,()=>(()=>{var rt={916:(fe,ce,le)=>{var Z=le(471);fe.exports=function(oe){"use strict";var V,A="",I=(oe=oe||{}).video,U=oe.options,w=Z.$escape,F=oe.tran,$=oe.icons,C=oe.index,B=Z.$each;return oe.$value,oe.$index,A+=`<div class="dplayer-mask"></div>
<div class="dplayer-video-wrap">
    `,V=le(568)(I),A+=V,A+=`
    `,U.logo&&(A+=`
    <div class="dplayer-logo">
        <img src="`,A+=w(U.logo),A+=`">
    </div>
    `),A+=`
    <div class="dplayer-danmaku"`,U.danmaku&&U.danmaku.bottom&&(A+=' style="margin-bottom:',A+=w(U.danmaku.bottom),A+='"'),A+=`>
        <div class="dplayer-danmaku-item dplayer-danmaku-item--demo"></div>
    </div>
    <div class="dplayer-subtitle"></div>
    <div class="dplayer-bezel">
        <span class="dplayer-bezel-icon"></span>
        `,U.danmaku&&(A+=`
        <span class="dplayer-danloading">`,A+=w(F("danmaku-loading")),A+=`</span>
        `),A+=`
        <span class="diplayer-loading-icon">`,A+=$.loading,A+=`</span>
    </div>
</div>
<div class="dplayer-controller-mask"></div>
<div class="dplayer-controller">
    <div class="dplayer-icons dplayer-comment-box">
        <button class="dplayer-icon dplayer-comment-setting-icon" data-balloon="`,A+=w(F("setting")),A+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,A+=$.pallette,A+=`</span>
        </button>
        <div class="dplayer-comment-setting-box">
            <div class="dplayer-comment-setting-color">
                <div class="dplayer-comment-setting-title">`,A+=w(F("set-danmaku-color")),A+=`</div>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,A+=w(C),A+=`" value="#fff" checked>
                    <span style="background: #fff;"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,A+=w(C),A+=`" value="#e54256">
                    <span style="background: #e54256"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,A+=w(C),A+=`" value="#ffe133">
                    <span style="background: #ffe133"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,A+=w(C),A+=`" value="#64DD17">
                    <span style="background: #64DD17"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,A+=w(C),A+=`" value="#39ccff">
                    <span style="background: #39ccff"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,A+=w(C),A+=`" value="#D500F9">
                    <span style="background: #D500F9"></span>
                </label>
            </div>
            <div class="dplayer-comment-setting-type">
                <div class="dplayer-comment-setting-title">`,A+=w(F("set-danmaku-type")),A+=`</div>
                <label>
                    <input type="radio" name="dplayer-danmaku-type-`,A+=w(C),A+=`" value="1">
                    <span>`,A+=w(F("top")),A+=`</span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-type-`,A+=w(C),A+=`" value="0" checked>
                    <span>`,A+=w(F("rolling")),A+=`</span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-type-`,A+=w(C),A+=`" value="2">
                    <span>`,A+=w(F("bottom")),A+=`</span>
                </label>
            </div>
        </div>
        <input class="dplayer-comment-input" type="text" placeholder="`,A+=w(F("input-danmaku-enter")),A+=`" maxlength="30">
        <button class="dplayer-icon dplayer-send-icon" data-balloon="`,A+=w(F("send")),A+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,A+=$.send,A+=`</span>
        </button>
    </div>
    <div class="dplayer-icons dplayer-icons-left">
        <button class="dplayer-icon dplayer-play-icon">
            <span class="dplayer-icon-content">`,A+=$.play,A+=`</span>
        </button>
        <div class="dplayer-volume">
            <button class="dplayer-icon dplayer-volume-icon">
                <span class="dplayer-icon-content">`,A+=$.volumeDown,A+=`</span>
            </button>
            <div class="dplayer-volume-bar-wrap" data-balloon-pos="up">
                <div class="dplayer-volume-bar">
                    <div class="dplayer-volume-bar-inner" style="background: `,A+=w(U.theme),A+=`;">
                        <span class="dplayer-thumb" style="background: `,A+=w(U.theme),A+=`"></span>
                    </div>
                </div>
            </div>
        </div>
        <span class="dplayer-time">
            <span class="dplayer-ptime">0:00</span> /
            <span class="dplayer-dtime">0:00</span>
        </span>
        `,U.live&&(A+=`
        <span class="dplayer-live-badge"><span class="dplayer-live-dot" style="background: `,A+=w(U.theme),A+=';"></span>',A+=w(F("live")),A+=`</span>
        `),A+=`
    </div>
    <div class="dplayer-icons dplayer-icons-right">
        `,U.video.quality&&(A+=`
        <div class="dplayer-quality">
            <button class="dplayer-icon dplayer-quality-icon">`,A+=w(U.video.quality[U.video.defaultQuality].name),A+=`</button>
            <div class="dplayer-quality-mask">
                <div class="dplayer-quality-list">
                `,B(U.video.quality,function(O,P){A+=`
                    <div class="dplayer-quality-item" data-index="`,A+=w(P),A+='">',A+=w(O.name),A+=`</div>
                `}),A+=`
                </div>
            </div>
        </div>
        `),A+=`
        `,U.screenshot&&(A+=`
        <div class="dplayer-icon dplayer-camera-icon" data-balloon="`,A+=w(F("screenshot")),A+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,A+=$.camera,A+=`</span>
        </div>
        `),A+=`
        `,U.airplay&&(A+=`
        <div class="dplayer-icon dplayer-airplay-icon" data-balloon="`,A+=w(F("airplay")),A+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,A+=$.airplay,A+=`</span>
        </div>
        `),A+=`
        `,U.chromecast&&(A+=`
        <div class="dplayer-icon dplayer-chromecast-icon" data-balloon="`,A+=w(F("chromecast")),A+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,A+=$.chromecast,A+=`</span>
        </div>
        `),A+=`
        <div class="dplayer-comment">
            <button class="dplayer-icon dplayer-comment-icon" data-balloon="`,A+=w(F("send-danmaku")),A+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,A+=$.comment,A+=`</span>
            </button>
        </div>
        `,U.subtitle&&(A+=`
        `,typeof U.subtitle.url=="string"?(A+=`
        <div class="dplayer-subtitle-btn">
            <button class="dplayer-icon dplayer-subtitle-icon" data-balloon="`,A+=w(F("hide-subs")),A+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,A+=$.subtitle,A+=`</span>
            </button>
        </div>
        `):(A+=`
        <div class="dplayer-subtitles">
            <button class="dplayer-icon dplayer-subtitles-icon" data-balloon="`,A+=w(F("subtitle")),A+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,A+=$.subtitle,A+=`</span>
            </button>
            <div class="dplayer-subtitles-box">
                <div class="dplayer-subtitles-panel">
                    `,B(U.subtitle.url,function(O,P){A+=`
                        <div class="dplayer-subtitles-item" data-subtitle="`,A+=w(O.url),A+=`">
                            <!-- if lang, show tran(lang). if lang and name, show name + (tran(lang)). if name, show name. off option use lang for translation. -->
                            <span class="dplayer-label">`,A+=w(O.lang?O.name?O.name+" ("+F(O.lang)+")":F(O.lang):O.name),A+=`</span>
                        </div>
                    `}),A+=`
                </div>
            </div>
        </div>
        `),A+=`
        `),A+=`
        <div class="dplayer-setting">
            <button class="dplayer-icon dplayer-setting-icon" data-balloon="`,A+=w(F("setting")),A+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,A+=$.setting,A+=`</span>
            </button>
            <div class="dplayer-setting-box">
                <div class="dplayer-setting-origin-panel">
                    <div class="dplayer-setting-item dplayer-setting-speed">
                        <span class="dplayer-label">`,A+=w(F("speed")),A+=`</span>
                        <div class="dplayer-toggle">`,A+=$.right,A+=`</div>
                    </div>
                    <div class="dplayer-setting-item dplayer-setting-loop">
                        <span class="dplayer-label">`,A+=w(F("loop")),A+=`</span>
                        <div class="dplayer-toggle">
                            <input class="dplayer-toggle-setting-input" type="checkbox" name="dplayer-toggle">
                            <label for="dplayer-toggle"></label>
                        </div>
                    </div>
                    <div class="dplayer-setting-item dplayer-setting-showdan">
                        <span class="dplayer-label">`,A+=w(F("show-danmaku")),A+=`</span>
                        <div class="dplayer-toggle">
                            <input class="dplayer-showdan-setting-input" type="checkbox" name="dplayer-toggle-dan">
                            <label for="dplayer-toggle-dan"></label>
                        </div>
                    </div>
                    <div class="dplayer-setting-item dplayer-setting-danunlimit">
                        <span class="dplayer-label">`,A+=w(F("unlimited-danmaku")),A+=`</span>
                        <div class="dplayer-toggle">
                            <input class="dplayer-danunlimit-setting-input" type="checkbox" name="dplayer-toggle-danunlimit">
                            <label for="dplayer-toggle-danunlimit"></label>
                        </div>
                    </div>
                    <div class="dplayer-setting-item dplayer-setting-danmaku">
                        <span class="dplayer-label">`,A+=w(F("opacity-danmaku")),A+=`</span>
                        <div class="dplayer-danmaku-bar-wrap">
                            <div class="dplayer-danmaku-bar">
                                <div class="dplayer-danmaku-bar-inner">
                                    <span class="dplayer-thumb"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="dplayer-setting-speed-panel">
                    `,B(U.playbackSpeed,function(O,P){A+=`
                        <div class="dplayer-setting-speed-item" data-speed="`,A+=w(O),A+=`">
                            <span class="dplayer-label">`,A+=w(O===1?F("normal"):O),A+=`</span>
                        </div>
                    `}),A+=`
                </div>
            </div>
        </div>
        <div class="dplayer-full">
            <button class="dplayer-icon dplayer-full-in-icon" data-balloon="`,A+=w(F("web-fullscreen")),A+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,A+=$.fullWeb,A+=`</span>
            </button>
            <button class="dplayer-icon dplayer-full-icon" data-balloon="`,A+=w(F("fullscreen")),A+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,A+=$.full,A+=`</span>
            </button>
        </div>
    </div>
    <div class="dplayer-bar-wrap">
        <div class="dplayer-bar-time hidden">00:00</div>
        <div class="dplayer-bar-preview"></div>
        <div class="dplayer-bar">
            <div class="dplayer-loaded" style="width: 0;"></div>
            <div class="dplayer-played" style="width: 0; background: `,A+=w(U.theme),A+=`">
                <span class="dplayer-thumb" style="background: `,A+=w(U.theme),A+=`"></span>
            </div>
        </div>
    </div>
</div>
<div class="dplayer-info-panel dplayer-info-panel-hide">
    <div class="dplayer-info-panel-close">[x]</div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-version">
        <span class="dplayer-info-panel-item-title">Player version</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-fps">
        <span class="dplayer-info-panel-item-title">Player FPS</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-type">
        <span class="dplayer-info-panel-item-title">Video type</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-url">
        <span class="dplayer-info-panel-item-title">Video url</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-resolution">
        <span class="dplayer-info-panel-item-title">Video resolution</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-duration">
        <span class="dplayer-info-panel-item-title">Video duration</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    `,U.danmaku&&(A+=`
    <div class="dplayer-info-panel-item dplayer-info-panel-item-danmaku-id">
        <span class="dplayer-info-panel-item-title">Danmaku id</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-danmaku-api">
        <span class="dplayer-info-panel-item-title">Danmaku api</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-danmaku-amount">
        <span class="dplayer-info-panel-item-title">Danmaku amount</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    `),A+=`
</div>
<div class="dplayer-menu">
    `,B(U.contextmenu,function(O,P){A+=`
        <div class="dplayer-menu-item">
            <a`,O.link&&(A+=' target="_blank"'),A+=' href="',A+=w(O.link||"javascript:void(0);"),A+='">',O.key&&(A+=" ",A+=w(F(O.key))),O.text&&(A+=" ",A+=w(O.text)),A+=`</a>
        </div>
    `}),A+=`
</div>
<div class="dplayer-notice-list"></div>
<button class="dplayer-mobile-play">
    `,A+=$.play,A+=`
</button>`}},568:(fe,ce,le)=>{var Z=le(471);fe.exports=function(oe){"use strict";var V="",A=(oe=oe||{}).enableSubtitle,I=oe.subtitle,U=oe.current,w=oe.airplay,F=oe.pic,$=Z.$escape,C=oe.screenshot,B=oe.preload,O=oe.url;return A=I&&I.type==="webvtt",V+=`
<video
    class="dplayer-video `,U&&(V+="dplayer-video-current"),V+=`"
    webkit-playsinline
    `,w&&(V+=' x-webkit-airplay="allow" '),V+=`
    playsinline
    `,F&&(V+='poster="',V+=$(F),V+='"'),V+=`
    `,(C||A)&&(V+='crossorigin="anonymous"'),V+=`
    `,B&&(V+='preload="',V+=$(B),V+='"'),V+=`
    `,w?V+=`
    nosrc
    `:O&&(V+=`
    src="`,V+=$(O),V+=`"
    `),V+=`
    >
    `,w&&(V+=`
    <source src="`,V+=$(O),V+=`">
    `),V+=`
    `,A&&(V+=`
    <track class="dplayer-subtrack" kind="metadata" default src="`,V+=$(typeof I.url=="string"?I.url:I.url[I.index].url),V+=`"></track>
    `),V+`
</video>`}},49:(fe,ce,le)=>{"use strict";le.d(ce,{Z:()=>I});var Z=le(415),oe=le.n(Z),V=le(352),A=le.n(V)()(oe());A.push([fe.id,`:root {
  --balloon-border-radius: 2px;
  --balloon-color: rgba(16, 16, 16, 0.95);
  --balloon-text-color: #fff;
  --balloon-font-size: 12px;
  --balloon-move: 4px; }

button[aria-label][data-balloon-pos] {
  overflow: visible; }

[aria-label][data-balloon-pos] {
  position: relative;
  cursor: pointer; }
  [aria-label][data-balloon-pos]:after {
    opacity: 0;
    pointer-events: none;
    transition: all 0.18s ease-out 0.18s;
    text-indent: 0;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
    font-weight: normal;
    font-style: normal;
    text-shadow: none;
    font-size: 12px;
    font-size: var(--balloon-font-size);
    background: rgba(16, 16, 16, 0.95);
    background: var(--balloon-color);
    border-radius: 2px;
    color: #fff;
    color: var(--balloon-text-color);
    border-radius: var(--balloon-border-radius);
    content: attr(aria-label);
    padding: .5em 1em;
    position: absolute;
    white-space: nowrap;
    z-index: 10; }
  [aria-label][data-balloon-pos]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-top-color: rgba(16, 16, 16, 0.95);
    border-top-color: var(--balloon-color);
    opacity: 0;
    pointer-events: none;
    transition: all 0.18s ease-out 0.18s;
    content: "";
    position: absolute;
    z-index: 10; }
  [aria-label][data-balloon-pos]:hover:before, [aria-label][data-balloon-pos]:hover:after, [aria-label][data-balloon-pos][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-visible]:after, [aria-label][data-balloon-pos]:not([data-balloon-nofocus]):focus:before, [aria-label][data-balloon-pos]:not([data-balloon-nofocus]):focus:after {
    opacity: 1;
    pointer-events: none; }
  [aria-label][data-balloon-pos].font-awesome:after {
    font-family: FontAwesome, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; }
  [aria-label][data-balloon-pos][data-balloon-break]:after {
    white-space: pre; }
  [aria-label][data-balloon-pos][data-balloon-break][data-balloon-length]:after {
    white-space: pre-line;
    word-break: break-word; }
  [aria-label][data-balloon-pos][data-balloon-blunt]:before, [aria-label][data-balloon-pos][data-balloon-blunt]:after {
    transition: none; }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="up"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos="down"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="down"][data-balloon-visible]:after {
    transform: translate(-50%, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="up"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos="down"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="down"][data-balloon-visible]:before {
    transform: translate(-50%, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos*="-left"]:after {
    left: 0; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-left"]:before {
    left: 5px; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:after {
    right: 0; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:before {
    right: 5px; }
  [aria-label][data-balloon-pos][data-balloon-po*="-left"]:hover:after, [aria-label][data-balloon-pos][data-balloon-po*="-left"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos*="-right"][data-balloon-visible]:after {
    transform: translate(0, 0); }
  [aria-label][data-balloon-pos][data-balloon-po*="-left"]:hover:before, [aria-label][data-balloon-pos][data-balloon-po*="-left"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos*="-right"][data-balloon-visible]:before {
    transform: translate(0, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos^="up"]:before, [aria-label][data-balloon-pos][data-balloon-pos^="up"]:after {
    bottom: 100%;
    transform-origin: top;
    transform: translate(0, 4px);
    transform: translate(0, var(--balloon-move)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="up"]:after {
    margin-bottom: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:before, [aria-label][data-balloon-pos][data-balloon-pos="up"]:after {
    left: 50%;
    transform: translate(-50%, 4px);
    transform: translate(-50%, var(--balloon-move)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:before, [aria-label][data-balloon-pos][data-balloon-pos^="down"]:after {
    top: 100%;
    transform: translate(0, calc(4px * -1));
    transform: translate(0, calc(var(--balloon-move) * -1)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:after {
    margin-top: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-bottom-color: rgba(16, 16, 16, 0.95);
    border-bottom-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-pos="down"]:after, [aria-label][data-balloon-pos][data-balloon-pos="down"]:before {
    left: 50%;
    transform: translate(-50%, calc(4px * -1));
    transform: translate(-50%, calc(var(--balloon-move) * -1)); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="left"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos="right"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="right"][data-balloon-visible]:after {
    transform: translate(0, -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="left"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos="right"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="right"][data-balloon-visible]:before {
    transform: translate(0, -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:after, [aria-label][data-balloon-pos][data-balloon-pos="left"]:before {
    right: 100%;
    top: 50%;
    transform: translate(4px, -50%);
    transform: translate(var(--balloon-move), -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:after {
    margin-right: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-left-color: rgba(16, 16, 16, 0.95);
    border-left-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:after, [aria-label][data-balloon-pos][data-balloon-pos="right"]:before {
    left: 100%;
    top: 50%;
    transform: translate(calc(4px * -1), -50%);
    transform: translate(calc(var(--balloon-move) * -1), -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:after {
    margin-left: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-right-color: rgba(16, 16, 16, 0.95);
    border-right-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-length]:after {
    white-space: normal; }
  [aria-label][data-balloon-pos][data-balloon-length="small"]:after {
    width: 80px; }
  [aria-label][data-balloon-pos][data-balloon-length="medium"]:after {
    width: 150px; }
  [aria-label][data-balloon-pos][data-balloon-length="large"]:after {
    width: 260px; }
  [aria-label][data-balloon-pos][data-balloon-length="xlarge"]:after {
    width: 380px; }
    @media screen and (max-width: 768px) {
      [aria-label][data-balloon-pos][data-balloon-length="xlarge"]:after {
        width: 90vw; } }
  [aria-label][data-balloon-pos][data-balloon-length="fit"]:after {
    width: 100%; }
`,"",{version:3,sources:["webpack://./node_modules/.pnpm/balloon-css@1.2.0/node_modules/balloon-css/balloon.css"],names:[],mappings:"AAAA;EACE,4BAA4B;EAC5B,uCAAuC;EACvC,0BAA0B;EAC1B,yBAAyB;EACzB,mBAAmB,EAAE;;AAEvB;EACE,iBAAiB,EAAE;;AAErB;EACE,kBAAkB;EAClB,eAAe,EAAE;EACjB;IACE,UAAU;IACV,oBAAoB;IACpB,oCAAoC;IACpC,cAAc;IACd,wIAAwI;IACxI,mBAAmB;IACnB,kBAAkB;IAClB,iBAAiB;IACjB,eAAmC;IAAnC,mCAAmC;IACnC,kCAAgC;IAAhC,gCAAgC;IAChC,kBAAkB;IAClB,WAAgC;IAAhC,gCAAgC;IAChC,2CAA2C;IAC3C,yBAAyB;IACzB,iBAAiB;IACjB,kBAAkB;IAClB,mBAAmB;IACnB,WAAW,EAAE;EACf;IACE,QAAQ;IACR,SAAS;IACT,6BAA6B;IAC7B,wCAAsC;IAAtC,sCAAsC;IACtC,UAAU;IACV,oBAAoB;IACpB,oCAAoC;IACpC,WAAW;IACX,kBAAkB;IAClB,WAAW,EAAE;EACf;IACE,UAAU;IACV,oBAAoB,EAAE;EACxB;IACE,qJAAqJ,EAAE;EACzJ;IACE,gBAAgB,EAAE;EACpB;IACE,qBAAqB;IACrB,sBAAsB,EAAE;EAC1B;IACE,gBAAgB,EAAE;EACpB;IACE,6BAA6B,EAAE;EACjC;IACE,6BAA6B,EAAE;EACjC;IACE,OAAO,EAAE;EACX;IACE,SAAS,EAAE;EACb;IACE,QAAQ,EAAE;EACZ;IACE,UAAU,EAAE;EACd;IACE,0BAA0B,EAAE;EAC9B;IACE,0BAA0B,EAAE;EAC9B;IACE,YAAY;IACZ,qBAAqB;IACrB,4BAA4C;IAA5C,4CAA4C,EAAE;EAChD;IACE,mBAAmB,EAAE;EACvB;IACE,SAAS;IACT,+BAA+C;IAA/C,+CAA+C,EAAE;EACnD;IACE,SAAS;IACT,uCAAuD;IAAvD,uDAAuD,EAAE;EAC3D;IACE,gBAAgB,EAAE;EACpB;IACE,QAAQ;IACR,SAAS;IACT,6BAA6B;IAC7B,2CAAyC;IAAzC,yCAAyC,EAAE;EAC7C;IACE,SAAS;IACT,0CAA0D;IAA1D,0DAA0D,EAAE;EAC9D;IACE,6BAA6B,EAAE;EACjC;IACE,6BAA6B,EAAE;EACjC;IACE,WAAW;IACX,QAAQ;IACR,+BAA+C;IAA/C,+CAA+C,EAAE;EACnD;IACE,kBAAkB,EAAE;EACtB;IACE,QAAQ;IACR,SAAS;IACT,6BAA6B;IAC7B,yCAAuC;IAAvC,uCAAuC,EAAE;EAC3C;IACE,UAAU;IACV,QAAQ;IACR,0CAA0D;IAA1D,0DAA0D,EAAE;EAC9D;IACE,iBAAiB,EAAE;EACrB;IACE,QAAQ;IACR,SAAS;IACT,6BAA6B;IAC7B,0CAAwC;IAAxC,wCAAwC,EAAE;EAC5C;IACE,mBAAmB,EAAE;EACvB;IACE,WAAW,EAAE;EACf;IACE,YAAY,EAAE;EAChB;IACE,YAAY,EAAE;EAChB;IACE,YAAY,EAAE;IACd;MACE;QACE,WAAW,EAAE,EAAE;EACrB;IACE,WAAW,EAAE",sourcesContent:[`:root {
  --balloon-border-radius: 2px;
  --balloon-color: rgba(16, 16, 16, 0.95);
  --balloon-text-color: #fff;
  --balloon-font-size: 12px;
  --balloon-move: 4px; }

button[aria-label][data-balloon-pos] {
  overflow: visible; }

[aria-label][data-balloon-pos] {
  position: relative;
  cursor: pointer; }
  [aria-label][data-balloon-pos]:after {
    opacity: 0;
    pointer-events: none;
    transition: all 0.18s ease-out 0.18s;
    text-indent: 0;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
    font-weight: normal;
    font-style: normal;
    text-shadow: none;
    font-size: var(--balloon-font-size);
    background: var(--balloon-color);
    border-radius: 2px;
    color: var(--balloon-text-color);
    border-radius: var(--balloon-border-radius);
    content: attr(aria-label);
    padding: .5em 1em;
    position: absolute;
    white-space: nowrap;
    z-index: 10; }
  [aria-label][data-balloon-pos]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-top-color: var(--balloon-color);
    opacity: 0;
    pointer-events: none;
    transition: all 0.18s ease-out 0.18s;
    content: "";
    position: absolute;
    z-index: 10; }
  [aria-label][data-balloon-pos]:hover:before, [aria-label][data-balloon-pos]:hover:after, [aria-label][data-balloon-pos][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-visible]:after, [aria-label][data-balloon-pos]:not([data-balloon-nofocus]):focus:before, [aria-label][data-balloon-pos]:not([data-balloon-nofocus]):focus:after {
    opacity: 1;
    pointer-events: none; }
  [aria-label][data-balloon-pos].font-awesome:after {
    font-family: FontAwesome, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; }
  [aria-label][data-balloon-pos][data-balloon-break]:after {
    white-space: pre; }
  [aria-label][data-balloon-pos][data-balloon-break][data-balloon-length]:after {
    white-space: pre-line;
    word-break: break-word; }
  [aria-label][data-balloon-pos][data-balloon-blunt]:before, [aria-label][data-balloon-pos][data-balloon-blunt]:after {
    transition: none; }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="up"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos="down"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="down"][data-balloon-visible]:after {
    transform: translate(-50%, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="up"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos="down"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="down"][data-balloon-visible]:before {
    transform: translate(-50%, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos*="-left"]:after {
    left: 0; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-left"]:before {
    left: 5px; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:after {
    right: 0; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:before {
    right: 5px; }
  [aria-label][data-balloon-pos][data-balloon-po*="-left"]:hover:after, [aria-label][data-balloon-pos][data-balloon-po*="-left"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos*="-right"][data-balloon-visible]:after {
    transform: translate(0, 0); }
  [aria-label][data-balloon-pos][data-balloon-po*="-left"]:hover:before, [aria-label][data-balloon-pos][data-balloon-po*="-left"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos*="-right"][data-balloon-visible]:before {
    transform: translate(0, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos^="up"]:before, [aria-label][data-balloon-pos][data-balloon-pos^="up"]:after {
    bottom: 100%;
    transform-origin: top;
    transform: translate(0, var(--balloon-move)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="up"]:after {
    margin-bottom: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:before, [aria-label][data-balloon-pos][data-balloon-pos="up"]:after {
    left: 50%;
    transform: translate(-50%, var(--balloon-move)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:before, [aria-label][data-balloon-pos][data-balloon-pos^="down"]:after {
    top: 100%;
    transform: translate(0, calc(var(--balloon-move) * -1)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:after {
    margin-top: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-bottom-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-pos="down"]:after, [aria-label][data-balloon-pos][data-balloon-pos="down"]:before {
    left: 50%;
    transform: translate(-50%, calc(var(--balloon-move) * -1)); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="left"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos="right"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="right"][data-balloon-visible]:after {
    transform: translate(0, -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="left"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos="right"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="right"][data-balloon-visible]:before {
    transform: translate(0, -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:after, [aria-label][data-balloon-pos][data-balloon-pos="left"]:before {
    right: 100%;
    top: 50%;
    transform: translate(var(--balloon-move), -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:after {
    margin-right: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-left-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:after, [aria-label][data-balloon-pos][data-balloon-pos="right"]:before {
    left: 100%;
    top: 50%;
    transform: translate(calc(var(--balloon-move) * -1), -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:after {
    margin-left: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-right-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-length]:after {
    white-space: normal; }
  [aria-label][data-balloon-pos][data-balloon-length="small"]:after {
    width: 80px; }
  [aria-label][data-balloon-pos][data-balloon-length="medium"]:after {
    width: 150px; }
  [aria-label][data-balloon-pos][data-balloon-length="large"]:after {
    width: 260px; }
  [aria-label][data-balloon-pos][data-balloon-length="xlarge"]:after {
    width: 380px; }
    @media screen and (max-width: 768px) {
      [aria-label][data-balloon-pos][data-balloon-length="xlarge"]:after {
        width: 90vw; } }
  [aria-label][data-balloon-pos][data-balloon-length="fit"]:after {
    width: 100%; }
`],sourceRoot:""}]);const I=A},685:(fe,ce,le)=>{"use strict";le.d(ce,{Z:()=>B});var Z=le(415),oe=le.n(Z),V=le(352),A=le.n(V),I=le(49),U=le(80),w=le.n(U),F=new URL(le(831),le.b),$=A()(oe());$.i(I.Z);var C=w()(F);$.push([fe.id,`@keyframes my-face {
  2% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  4% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  6% {
    transform: translate(0, 1.5px) rotate(-1.5deg);
  }
  8% {
    transform: translate(0, -1.5px) rotate(-1.5deg);
  }
  10% {
    transform: translate(0, 2.5px) rotate(1.5deg);
  }
  12% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  14% {
    transform: translate(0, -1.5px) rotate(1.5deg);
  }
  16% {
    transform: translate(0, -0.5px) rotate(-1.5deg);
  }
  18% {
    transform: translate(0, 0.5px) rotate(-1.5deg);
  }
  20% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  22% {
    transform: translate(0, 0.5px) rotate(-1.5deg);
  }
  24% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  26% {
    transform: translate(0, 0.5px) rotate(0.5deg);
  }
  28% {
    transform: translate(0, 0.5px) rotate(1.5deg);
  }
  30% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  32% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  34% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  36% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  38% {
    transform: translate(0, 1.5px) rotate(-1.5deg);
  }
  40% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  42% {
    transform: translate(0, 2.5px) rotate(-1.5deg);
  }
  44% {
    transform: translate(0, 1.5px) rotate(0.5deg);
  }
  46% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  48% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  50% {
    transform: translate(0, 0.5px) rotate(0.5deg);
  }
  52% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  54% {
    transform: translate(0, -1.5px) rotate(1.5deg);
  }
  56% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  58% {
    transform: translate(0, 0.5px) rotate(2.5deg);
  }
  60% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  62% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  64% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  66% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  68% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  70% {
    transform: translate(0, 1.5px) rotate(0.5deg);
  }
  72% {
    transform: translate(0, 2.5px) rotate(1.5deg);
  }
  74% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  76% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  78% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  80% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  82% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  84% {
    transform: translate(0, 1.5px) rotate(2.5deg);
  }
  86% {
    transform: translate(0, -1.5px) rotate(-1.5deg);
  }
  88% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  90% {
    transform: translate(0, 2.5px) rotate(-0.5deg);
  }
  92% {
    transform: translate(0, 0.5px) rotate(-0.5deg);
  }
  94% {
    transform: translate(0, 2.5px) rotate(0.5deg);
  }
  96% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  98% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  0%,
  100% {
    transform: translate(0, 0) rotate(0deg);
  }
}
.dplayer {
  position: relative;
  overflow: hidden;
  -webkit-user-select: none;
     -moz-user-select: none;
          user-select: none;
  line-height: 1;
}
.dplayer * {
  box-sizing: content-box;
}
.dplayer svg {
  width: 100%;
  height: 100%;
}
.dplayer svg path,
.dplayer svg circle {
  fill: #fff;
}
.dplayer:-webkit-full-screen {
  width: 100%;
  height: 100%;
  background: #000;
  position: fixed;
  z-index: 100000;
  left: 0;
  top: 0;
  margin: 0;
  padding: 0;
  transform: translate(0, 0);
}
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-showdan,
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-danmaku,
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-danunlimit {
  display: none;
}
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-comment {
  display: none;
}
.dplayer.dplayer-no-danmaku .dplayer-danmaku {
  display: none;
}
.dplayer.dplayer-live .dplayer-time {
  display: none;
}
.dplayer.dplayer-live .dplayer-bar-wrap {
  display: none;
}
.dplayer.dplayer-live .dplayer-setting-speed {
  display: none;
}
.dplayer.dplayer-live .dplayer-setting-loop {
  display: none;
}
.dplayer.dplayer-live.dplayer-no-danmaku .dplayer-setting {
  display: none;
}
.dplayer.dplayer-arrow .dplayer-danmaku {
  font-size: 18px;
}
.dplayer.dplayer-arrow .dplayer-icon {
  margin: 0 -3px;
}
.dplayer.dplayer-playing .dplayer-danmaku .dplayer-danmaku-move {
  animation-play-state: running;
}
@media (min-width: 900px) {
  .dplayer.dplayer-playing .dplayer-controller-mask {
    opacity: 0;
  }
  .dplayer.dplayer-playing .dplayer-controller {
    opacity: 0;
  }
  .dplayer.dplayer-playing:hover .dplayer-controller-mask {
    opacity: 1;
  }
  .dplayer.dplayer-playing:hover .dplayer-controller {
    opacity: 1;
  }
}
.dplayer.dplayer-loading .dplayer-bezel .diplayer-loading-icon {
  display: block;
}
.dplayer.dplayer-loading .dplayer-danmaku,
.dplayer.dplayer-paused .dplayer-danmaku,
.dplayer.dplayer-loading .dplayer-danmaku-move,
.dplayer.dplayer-paused .dplayer-danmaku-move {
  animation-play-state: paused;
}
.dplayer.dplayer-hide-controller {
  cursor: none;
}
.dplayer.dplayer-hide-controller .dplayer-controller-mask {
  opacity: 0;
  transform: translateY(100%);
}
.dplayer.dplayer-hide-controller .dplayer-controller {
  opacity: 0;
  transform: translateY(100%);
}
.dplayer.dplayer-show-controller .dplayer-controller-mask {
  opacity: 1;
}
.dplayer.dplayer-show-controller .dplayer-controller {
  opacity: 1;
}
.dplayer.dplayer-fulled {
  width: 100% !important;
  height: 100% !important;
}
.dplayer.dplayer-fulled {
  position: fixed;
  z-index: 100000;
  left: 0;
  top: 0;
}
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-volume,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-camera-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-airplay-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-chromecast-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-play-icon {
  display: none;
}
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-full .dplayer-full-in-icon {
  position: static;
  display: inline-block;
}
.dplayer.dplayer-mobile .dplayer-bar-time {
  display: none;
}
.dplayer.dplayer-mobile.dplayer-hide-controller .dplayer-mobile-play {
  display: none;
}
.dplayer.dplayer-mobile .dplayer-mobile-play {
  display: block;
}
.dplayer-web-fullscreen-fix {
  position: fixed;
  top: 0;
  left: 0;
  margin: 0;
  padding: 0;
}
[data-balloon]:before {
  display: none;
}
[data-balloon]:after {
  padding: 0.3em 0.7em;
  background: rgba(17, 17, 17, 0.7);
}
[data-balloon][data-balloon-pos="up"]:after {
  margin-bottom: 0;
}
.dplayer-bezel {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  font-size: 22px;
  color: #fff;
  pointer-events: none;
}
.dplayer-bezel .dplayer-bezel-icon {
  position: absolute;
  top: 50%;
  left: 50%;
  margin: -26px 0 0 -26px;
  height: 52px;
  width: 52px;
  padding: 12px;
  box-sizing: border-box;
  background: rgba(0, 0, 0, 0.5);
  border-radius: 50%;
  opacity: 0;
  pointer-events: none;
}
.dplayer-bezel .dplayer-bezel-icon.dplayer-bezel-transition {
  animation: bezel-hide 0.5s linear;
}
@keyframes bezel-hide {
  from {
    opacity: 1;
    transform: scale(1);
  }
  to {
    opacity: 0;
    transform: scale(2);
  }
}
.dplayer-bezel .dplayer-danloading {
  position: absolute;
  top: 50%;
  margin-top: -7px;
  width: 100%;
  text-align: center;
  font-size: 14px;
  line-height: 14px;
  animation: my-face 5s infinite ease-in-out;
}
.dplayer-bezel .diplayer-loading-icon {
  display: none;
  position: absolute;
  top: 50%;
  left: 50%;
  margin: -18px 0 0 -18px;
  height: 36px;
  width: 36px;
  pointer-events: none;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-hide {
  display: none;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot {
  animation: diplayer-loading-dot-fade 0.8s ease infinite;
  opacity: 0;
  transform-origin: 4px 4px;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-1 {
  animation-delay: 0.1s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-2 {
  animation-delay: 0.2s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-3 {
  animation-delay: 0.3s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-4 {
  animation-delay: 0.4s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-5 {
  animation-delay: 0.5s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-6 {
  animation-delay: 0.6s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-7 {
  animation-delay: 0.7s;
}
@keyframes diplayer-loading-dot-fade {
  0% {
    opacity: 0.7;
    transform: scale(1.2, 1.2);
  }
  50% {
    opacity: 0.25;
    transform: scale(0.9, 0.9);
  }
  to {
    opacity: 0.25;
    transform: scale(0.85, 0.85);
  }
}
.dplayer-controller-mask {
  background: url(`+C+`) repeat-x bottom;
  height: 98px;
  width: 100%;
  position: absolute;
  bottom: 0;
  transition: all 0.3s ease;
}
.dplayer-controller {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 41px;
  padding: 0 20px;
  -webkit-user-select: none;
     -moz-user-select: none;
          user-select: none;
  transition: all 0.3s ease;
}
.dplayer-controller.dplayer-controller-comment .dplayer-icons {
  display: none;
}
.dplayer-controller.dplayer-controller-comment .dplayer-icons.dplayer-comment-box {
  display: block;
}
.dplayer-controller .dplayer-bar-wrap {
  padding: 5px 0;
  cursor: pointer;
  position: absolute;
  bottom: 33px;
  width: calc(100% - 40px);
  height: 3px;
}
.dplayer-controller .dplayer-bar-wrap:hover .dplayer-bar .dplayer-played .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-bar-wrap:hover .dplayer-highlight {
  display: block;
  width: 8px;
  transform: translateX(-4px);
  top: 4px;
  height: 40%;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight {
  z-index: 12;
  position: absolute;
  top: 5px;
  width: 6px;
  height: 20%;
  border-radius: 6px;
  background-color: #fff;
  text-align: center;
  transform: translateX(-3px);
  transition: all 0.2s ease-in-out;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover .dplayer-highlight-text {
  display: block;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover ~ .dplayer-bar-preview {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover ~ .dplayer-bar-time {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight .dplayer-highlight-text {
  display: none;
  position: absolute;
  left: 50%;
  top: -24px;
  padding: 5px 8px;
  background-color: rgba(0, 0, 0, 0.62);
  color: #fff;
  border-radius: 4px;
  font-size: 12px;
  white-space: nowrap;
  transform: translateX(-50%);
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-preview {
  position: absolute;
  background: #fff;
  pointer-events: none;
  display: none;
  background-size: 16000px 100%;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-preview-canvas {
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: 1;
  pointer-events: none;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-time {
  position: absolute;
  left: 0px;
  top: -20px;
  border-radius: 4px;
  padding: 5px 7px;
  background-color: rgba(0, 0, 0, 0.62);
  color: #fff;
  font-size: 12px;
  text-align: center;
  opacity: 1;
  transition: opacity 0.1s ease-in-out;
  word-wrap: normal;
  word-break: normal;
  z-index: 2;
  pointer-events: none;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-time.hidden {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar {
  position: relative;
  height: 3px;
  width: 100%;
  background: rgba(255, 255, 255, 0.2);
  cursor: pointer;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-loaded {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  background: rgba(255, 255, 255, 0.4);
  height: 3px;
  transition: all 0.5s ease;
  will-change: width;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-played {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  height: 3px;
  will-change: width;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-played .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons {
  height: 38px;
  position: absolute;
  bottom: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box {
  display: none;
  position: absolute;
  transition: all 0.3s ease-in-out;
  z-index: 2;
  height: 38px;
  bottom: 0;
  left: 20px;
  right: 20px;
  color: #fff;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-icon {
  padding: 7px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-icon {
  position: absolute;
  left: 0;
  top: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-send-icon {
  position: absolute;
  right: 0;
  top: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box {
  position: absolute;
  background: rgba(28, 28, 28, 0.9);
  bottom: 41px;
  left: 0;
  box-shadow: 0 0 25px rgba(0, 0, 0, 0.3);
  border-radius: 4px;
  padding: 10px 10px 16px;
  font-size: 14px;
  width: 204px;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box.dplayer-comment-setting-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box input[type=radio] {
  display: none;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box label {
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-title {
  font-size: 13px;
  color: #fff;
  line-height: 30px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type {
  font-size: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type .dplayer-comment-setting-title {
  margin-bottom: 6px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type label:nth-child(2) span {
  border-radius: 4px 0 0 4px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type label:nth-child(4) span {
  border-radius: 0 4px 4px 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type span {
  width: 33%;
  padding: 4px 6px;
  line-height: 16px;
  display: inline-block;
  font-size: 12px;
  color: #fff;
  border: 1px solid #fff;
  margin-right: -1px;
  box-sizing: border-box;
  text-align: center;
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type input:checked + span {
  background: #E4E4E6;
  color: #1c1c1c;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color {
  font-size: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color label {
  font-size: 0;
  padding: 6px;
  display: inline-block;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color span {
  width: 22px;
  height: 22px;
  display: inline-block;
  border-radius: 50%;
  box-sizing: border-box;
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color span:hover {
  animation: my-face 5s infinite ease-in-out;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input {
  outline: none;
  border: none;
  padding: 8px 31px;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  border-radius: 4px;
  background: none;
  margin: 0;
  height: 100%;
  box-sizing: border-box;
  width: 100%;
  color: #fff;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::-moz-placeholder {
  color: #fff;
  opacity: 0.8;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::placeholder {
  color: #fff;
  opacity: 0.8;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::-ms-clear {
  display: none;
}
.dplayer-controller .dplayer-icons.dplayer-icons-left .dplayer-icon {
  padding: 7px;
}
.dplayer-controller .dplayer-icons.dplayer-icons-right {
  right: 20px;
}
.dplayer-controller .dplayer-icons.dplayer-icons-right .dplayer-icon {
  padding: 8px;
}
.dplayer-controller .dplayer-icons .dplayer-time,
.dplayer-controller .dplayer-icons .dplayer-live-badge {
  line-height: 38px;
  color: #eee;
  text-shadow: 0 0 2px rgba(0, 0, 0, 0.5);
  vertical-align: middle;
  font-size: 13px;
  cursor: default;
}
.dplayer-controller .dplayer-icons .dplayer-live-dot {
  display: inline-block;
  width: 6px;
  height: 6px;
  vertical-align: 4%;
  margin-right: 5px;
  content: '';
  border-radius: 6px;
}
.dplayer-controller .dplayer-icons .dplayer-icon {
  width: 40px;
  height: 100%;
  border: none;
  background-color: transparent;
  outline: none;
  cursor: pointer;
  vertical-align: middle;
  box-sizing: border-box;
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-icon .dplayer-icon-content {
  transition: all 0.2s ease-in-out;
  opacity: 0.8;
}
.dplayer-controller .dplayer-icons .dplayer-icon:hover .dplayer-icon-content {
  opacity: 1;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-quality-icon {
  color: #fff;
  width: auto;
  line-height: 22px;
  font-size: 14px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-comment-icon {
  padding: 10px 9px 9px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-setting-icon {
  padding-top: 8.5px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-volume-icon {
  width: 43px;
}
.dplayer-controller .dplayer-icons .dplayer-volume {
  position: relative;
  display: inline-block;
  cursor: pointer;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-volume:hover .dplayer-volume-bar-wrap .dplayer-volume-bar {
  width: 45px;
}
.dplayer-controller .dplayer-icons .dplayer-volume:hover .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-volume.dplayer-volume-active .dplayer-volume-bar-wrap .dplayer-volume-bar {
  width: 45px;
}
.dplayer-controller .dplayer-icons .dplayer-volume.dplayer-volume-active .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap {
  display: inline-block;
  margin: 0 10px 0 -5px;
  vertical-align: middle;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar {
  position: relative;
  top: 17px;
  width: 0;
  height: 3px;
  background: #aaa;
  transition: all 0.3s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 100%;
  transition: all 0.1s ease;
  will-change: width;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons .dplayer-subtitle-btn {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box {
  position: absolute;
  right: 0;
  bottom: 50px;
  transform: scale(0);
  width: -moz-fit-content;
  width: fit-content;
  max-width: 240px;
  min-width: 120px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 7px 0;
  transition: all 0.3s ease-in-out;
  overflow: auto;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box.dplayer-subtitles-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box.dplayer-subtitles-box-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-item {
  height: 30px;
  padding: 5px 10px;
  box-sizing: border-box;
  cursor: pointer;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-setting {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box {
  position: absolute;
  right: 0;
  bottom: 50px;
  transform: scale(0);
  width: 150px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 7px 0;
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box > div {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box > div.dplayer-setting-origin-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-narrow {
  width: 70px;
  text-align: center;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-speed .dplayer-setting-origin-panel {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-speed .dplayer-setting-speed-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-item,
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-speed-item {
  height: 30px;
  padding: 5px 10px;
  box-sizing: border-box;
  cursor: pointer;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-item:hover,
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-speed-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku {
  padding: 5px 0;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-label {
  padding: 0 10px;
  display: inline;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku:hover .dplayer-label {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku:hover .dplayer-danmaku-bar-wrap {
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-label {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-danmaku-bar-wrap {
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap {
  padding: 0 10px;
  box-sizing: border-box;
  display: none;
  vertical-align: middle;
  height: 100%;
  width: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar {
  position: relative;
  top: 8.5px;
  width: 100%;
  height: 3px;
  background: #fff;
  transition: all 0.3s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar .dplayer-danmaku-bar-inner {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 100%;
  transition: all 0.1s ease;
  background: #aaa;
  will-change: width;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar .dplayer-danmaku-bar-inner .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  background: #aaa;
}
.dplayer-controller .dplayer-icons .dplayer-full {
  display: inline-block;
  height: 100%;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-full:hover .dplayer-full-in-icon {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-full .dplayer-full-in-icon {
  position: absolute;
  top: -30px;
  z-index: 1;
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-quality {
  position: relative;
  display: inline-block;
  height: 100%;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-quality:hover .dplayer-quality-list {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-quality:hover .dplayer-quality-mask {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-mask {
  display: none;
  position: absolute;
  bottom: 38px;
  left: -18px;
  width: 80px;
  padding-bottom: 12px;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-list {
  display: none;
  font-size: 12px;
  width: 80px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 5px 0;
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  color: #fff;
  text-align: center;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-item {
  height: 25px;
  box-sizing: border-box;
  cursor: pointer;
  line-height: 25px;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-comment {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-label {
  color: #eee;
  font-size: 13px;
  display: inline-block;
  vertical-align: middle;
  white-space: nowrap;
}
.dplayer-controller .dplayer-icons .dplayer-toggle {
  width: 32px;
  height: 20px;
  text-align: center;
  font-size: 0;
  vertical-align: middle;
  position: absolute;
  top: 5px;
  right: 10px;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input {
  max-height: 0;
  max-width: 0;
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label {
  display: inline-block;
  position: relative;
  box-shadow: #dfdfdf 0 0 0 0 inset;
  border: 1px solid #dfdfdf;
  height: 20px;
  width: 32px;
  border-radius: 10px;
  box-sizing: border-box;
  cursor: pointer;
  transition: 0.2s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label:before {
  content: "";
  position: absolute;
  display: block;
  height: 18px;
  width: 18px;
  top: 0;
  left: 0;
  border-radius: 15px;
  transition: 0.2s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label:after {
  content: "";
  position: absolute;
  display: block;
  left: 0;
  top: 0;
  border-radius: 15px;
  background: #fff;
  transition: 0.2s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
  height: 18px;
  width: 18px;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label {
  border-color: rgba(255, 255, 255, 0.5);
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label:before {
  width: 30px;
  background: rgba(255, 255, 255, 0.5);
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label:after {
  left: 12px;
}
.dplayer-mobile-play {
  display: none;
  width: 50px;
  height: 50px;
  border: none;
  background-color: transparent;
  outline: none;
  cursor: pointer;
  box-sizing: border-box;
  bottom: 0;
  opacity: 0.8;
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
}
.dplayer-danmaku {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  font-size: 22px;
  color: #fff;
}
.dplayer-danmaku .dplayer-danmaku-item {
  display: inline-block;
  pointer-events: none;
  -webkit-user-select: none;
     -moz-user-select: none;
          user-select: none;
  cursor: default;
  white-space: nowrap;
  text-shadow: 0.5px 0.5px 0.5px rgba(0, 0, 0, 0.5);
}
.dplayer-danmaku .dplayer-danmaku-item--demo {
  position: absolute;
  visibility: hidden;
}
.dplayer-danmaku .dplayer-danmaku-right {
  position: absolute;
  right: 0;
  transform: translateX(100%);
}
.dplayer-danmaku .dplayer-danmaku-right.dplayer-danmaku-move {
  will-change: transform;
  animation-name: 'danmaku';
  animation-timing-function: linear;
  animation-play-state: paused;
}
@keyframes danmaku {
  from {
    transform: translateX(100%);
  }
}
.dplayer-danmaku .dplayer-danmaku-top,
.dplayer-danmaku .dplayer-danmaku-bottom {
  position: absolute;
  width: 100%;
  text-align: center;
  visibility: hidden;
}
.dplayer-danmaku .dplayer-danmaku-top.dplayer-danmaku-move,
.dplayer-danmaku .dplayer-danmaku-bottom.dplayer-danmaku-move {
  will-change: visibility;
  animation-name: 'danmaku-center';
  animation-timing-function: linear;
  animation-play-state: paused;
}
@keyframes danmaku-center {
  from {
    visibility: visible;
  }
  to {
    visibility: visible;
  }
}
.dplayer-logo {
  pointer-events: none;
  position: absolute;
  left: 20px;
  top: 20px;
  max-width: 50px;
  max-height: 50px;
}
.dplayer-logo img {
  max-width: 100%;
  max-height: 100%;
  background: none;
}
.dplayer-menu {
  position: absolute;
  width: 170px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.85);
  padding: 5px 0;
  overflow: hidden;
  z-index: 3;
  display: none;
}
.dplayer-menu.dplayer-menu-show {
  display: block;
}
.dplayer-menu .dplayer-menu-item {
  height: 30px;
  box-sizing: border-box;
  cursor: pointer;
}
.dplayer-menu .dplayer-menu-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-menu .dplayer-menu-item a {
  padding: 0 10px;
  line-height: 30px;
  color: #eee;
  font-size: 13px;
  display: inline-block;
  vertical-align: middle;
  width: 100%;
  box-sizing: border-box;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
.dplayer-menu .dplayer-menu-item a:hover {
  text-decoration: none;
}
.dplayer-notice-list {
  position: absolute;
  bottom: 60px;
  left: 20px;
}
.dplayer-notice-list .dplayer-notice {
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  color: #fff;
  display: table;
  pointer-events: none;
  animation: showNotice 0.3s ease 1 forwards;
}
.dplayer-notice-list .remove-notice {
  animation: removeNotice 0.3s ease 1 forwards;
}
@keyframes showNotice {
  from {
    padding: 0;
    font-size: 0;
    margin-top: 0;
  }
  to {
    padding: 7px 20px;
    font-size: 14px;
    margin-top: 5px;
  }
}
@keyframes removeNotice {
  0% {
    padding: 7px 20px;
    font-size: 14px;
    margin-top: 5px;
  }
  20% {
    font-size: 12px;
  }
  21% {
    font-size: 0;
    padding: 7px 10px;
  }
  100% {
    padding: 0;
    margin-top: 0;
    font-size: 0;
  }
}
.dplayer-subtitle {
  position: absolute;
  bottom: 40px;
  width: 90%;
  left: 5%;
  text-align: center;
  color: #fff;
  text-shadow: 0.5px 0.5px 0.5px rgba(0, 0, 0, 0.5);
  font-size: 20px;
}
.dplayer-subtitle.dplayer-subtitle-hide {
  display: none;
}
.dplayer-mask {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 1;
  display: none;
}
.dplayer-mask.dplayer-mask-show {
  display: block;
}
.dplayer-video-wrap {
  position: relative;
  background: #000;
  font-size: 0;
  width: 100%;
  height: 100%;
}
.dplayer-video-wrap .dplayer-video {
  width: 100%;
  height: 100%;
  display: none;
}
.dplayer-video-wrap .dplayer-video-current {
  display: block;
}
.dplayer-video-wrap .dplayer-video-prepare {
  display: none;
}
.dplayer-info-panel {
  position: absolute;
  top: 10px;
  left: 10px;
  width: 400px;
  background: rgba(28, 28, 28, 0.8);
  padding: 10px;
  color: #fff;
  font-size: 12px;
  border-radius: 2px;
}
.dplayer-info-panel-hide {
  display: none;
}
.dplayer-info-panel .dplayer-info-panel-close {
  cursor: pointer;
  position: absolute;
  right: 10px;
  top: 10px;
}
.dplayer-info-panel .dplayer-info-panel-item > span {
  display: inline-block;
  vertical-align: middle;
  line-height: 15px;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
.dplayer-info-panel .dplayer-info-panel-item-title {
  width: 100px;
  text-align: right;
  margin-right: 10px;
}
.dplayer-info-panel .dplayer-info-panel-item-data {
  width: 260px;
}
`,"",{version:3,sources:["webpack://./src/css/global.less","webpack://./src/css/index.less","webpack://./src/css/player.less","webpack://./src/css/balloon.less","webpack://./src/css/bezel.less","webpack://./src/css/notice.less","webpack://./src/css/controller.less","webpack://./src/css/danmaku.less","webpack://./src/css/logo.less","webpack://./src/css/menu.less","webpack://./src/css/subtitle.less","webpack://./src/css/video.less","webpack://./src/css/info-panel.less"],names:[],mappings:"AAAA;EACI;IACI,6CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;;IAEI,uCAAA;ECEN;AACF;ACzJA;EACI,kBAAA;EACA,gBAAA;EACA,yBAAA;KAAA,sBAAA;UAAA,iBAAA;EACA,cAAA;AD2JJ;AC/JA;EAOQ,uBAAA;AD2JR;AClKA;EAWQ,WAAA;EACA,YAAA;AD0JR;ACtKA;;EAgBY,UAAA;AD0JZ;ACtJI;EACI,WAAA;EACA,YAAA;EACA,gBAAA;EACA,eAAA;EACA,eAAA;EACA,OAAA;EACA,MAAA;EACA,SAAA;EACA,UAAA;EACA,0BAAA;ADwJR;ACpJI;;;EAKY,aAAA;ADoJhB;ACzJI;EAUQ,aAAA;ADkJZ;AC5JI;EAcQ,aAAA;ADiJZ;AC7II;EAEQ,aAAA;AD8IZ;AChJI;EAKQ,aAAA;AD8IZ;ACnJI;EAQQ,aAAA;AD8IZ;ACtJI;EAWQ,aAAA;AD8IZ;AC3IQ;EAEQ,aAAA;AD4IhB;ACvII;EAEQ,eAAA;ADwIZ;AC1II;EAKQ,cAAA;ADwIZ;ACpII;EAEQ,6BAAA;ADqIZ;AClIQ;EAAA;IAEQ,UAAA;EDoId;ECtIM;IAKQ,UAAA;EDoId;ECjIU;IAEQ,UAAA;EDkIlB;ECpIU;IAKQ,UAAA;EDkIlB;AACF;AC7HI;EAEQ,cAAA;AD8HZ;AC1HI;;;;EAIQ,4BAAA;AD4HZ;ACxHI;EACI,YAAA;AD0HR;AC3HI;EAIQ,UAAA;EACA,2BAAA;AD0HZ;AC/HI;EAQQ,UAAA;EACA,2BAAA;AD0HZ;ACvHI;EAEQ,UAAA;ADwHZ;AC1HI;EAKQ,UAAA;ADwHZ;ACrHI;EAKI,sBAAA;EACA,uBAAA;ADuHR;AC7HI;EACI,eAAA;EACA,eAAA;EACA,OAAA;EACA,MAAA;ADyHR;ACrHI;;;;;EAOY,aAAA;ADqHhB;AC5HI;EAUY,gBAAA;EACA,qBAAA;ADqHhB;AChII;EAgBQ,aAAA;ADmHZ;AChHQ;EAEQ,aAAA;ADiHhB;ACtII;EA0BQ,cAAA;AD+GZ;ACzGA;EACI,eAAA;EACA,MAAA;EACA,OAAA;EACA,SAAA;EACA,UAAA;AD2GJ;AElSA;EACI,aAAA;AFoSJ;AEjSA;EACI,oBAAA;EACA,iCAAA;AFmSJ;AEhSA;EACI,gBAAA;AFkSJ;AG9SA;EACI,kBAAA;EACA,OAAA;EACA,QAAA;EACA,MAAA;EACA,SAAA;EACA,eAAA;EACA,WAAA;EACA,oBAAA;AHgTJ;AGxTA;EAUQ,kBAAA;EACA,QAAA;EACA,SAAA;EACA,uBAAA;EACA,YAAA;EACA,WAAA;EACA,aAAA;EACA,sBAAA;EACA,8BAAA;EACA,kBAAA;EACA,UAAA;EACA,oBAAA;AHiTR;AGhTQ;EACI,iCAAA;AHkTZ;AGhTQ;EACI;IACI,UAAA;IACA,mBAAA;EHkTd;EGhTU;IACI,UAAA;IACA,mBAAA;EHkTd;AACF;AGnVA;EAqCQ,kBAAA;EACA,QAAA;EACA,gBAAA;EACA,WAAA;EACA,kBAAA;EACA,eAAA;EACA,iBAAA;EACA,0CAAA;AHiTR;AG7VA;EA+CQ,aAAA;EACA,kBAAA;EACA,QAAA;EACA,SAAA;EACA,uBAAA;EACA,YAAA;EACA,WAAA;EACA,oBAAA;AHiTR;AGvWA;EAwDY,aAAA;AHkTZ;AG1WA;EA2DY,uDAAA;EACA,UAAA;EACA,yBAAA;AHkTZ;AI/WC;EDgEmB,qBAAA;AHkTpB;AIlXC;EDgEmB,qBAAA;AHqTpB;AIrXC;EDgEmB,qBAAA;AHwTpB;AIxXC;EDgEmB,qBAAA;AH2TpB;AI3XC;EDgEmB,qBAAA;AH8TpB;AI9XC;EDgEmB,qBAAA;AHiUpB;AIjYC;EDgEmB,qBAAA;AHoUpB;AGhUQ;EACI;IACI,YAAA;IACA,0BAAA;EHkUd;EGhUU;IACI,aAAA;IACA,0BAAA;EHkUd;EGhUU;IACI,aAAA;IACA,4BAAA;EHkUd;AACF;AKlZA;EACI,mEAAA;EACA,YAAA;EACA,WAAA;EACA,kBAAA;EACA,SAAA;EACA,yBAAA;ALoZJ;AKjZA;EACI,kBAAA;EACA,SAAA;EACA,OAAA;EACA,QAAA;EACA,YAAA;EACA,eAAA;EACA,yBAAA;KAAA,sBAAA;UAAA,iBAAA;EACA,yBAAA;ALmZJ;AKlZI;EAEQ,aAAA;ALmZZ;AKrZI;EAKQ,cAAA;ALmZZ;AKjaA;EAkBQ,cAAA;EACA,eAAA;EACA,kBAAA;EACA,YAAA;EACA,wBAAA;EACA,WAAA;ALkZR;AKjZQ;EAEQ,mBAAA;ALkZhB;AKpZQ;EAKQ,cAAA;EACA,UAAA;EACA,2BAAA;EACA,QAAA;EACA,WAAA;ALkZhB;AKnbA;EAqCY,WAAA;EACA,kBAAA;EACA,QAAA;EACA,UAAA;EACA,WAAA;EACA,kBAAA;EACA,sBAAA;EACA,kBAAA;EACA,2BAAA;EACA,gCAAA;ALiZZ;AKhZY;EAEQ,cAAA;ALiZpB;AK/YgB;EACI,UAAA;ALiZpB;AK/YgB;EACI,UAAA;ALiZpB;AKxcA;EA2DgB,aAAA;EACA,kBAAA;EACA,SAAA;EACA,UAAA;EACA,gBAAA;EACA,qCAAA;EACA,WAAA;EACA,kBAAA;EACA,eAAA;EACA,mBAAA;EACA,2BAAA;ALgZhB;AKrdA;EAyEY,kBAAA;EACA,gBAAA;EACA,oBAAA;EACA,aAAA;EACA,6BAAA;AL+YZ;AK5dA;EAgFY,kBAAA;EACA,WAAA;EACA,YAAA;EACA,UAAA;EACA,oBAAA;AL+YZ;AKneA;EA0FY,kBAAA;EACA,SAAA;EACA,UAAA;EACA,kBAAA;EACA,gBAAA;EACA,qCAAA;EACA,WAAA;EACA,eAAA;EACA,kBAAA;EACA,UAAA;EACA,oCAAA;EACA,iBAAA;EACA,kBAAA;EACA,UAAA;EACA,oBAAA;AL4YZ;AK7ZY;EACI,UAAA;AL+ZhB;AKvfA;EA2GY,kBAAA;EACA,WAAA;EACA,WAAA;EACA,oCAAA;EACA,eAAA;AL+YZ;AK9fA;EAiHgB,kBAAA;EACA,OAAA;EACA,MAAA;EACA,SAAA;EACA,oCAAA;EACA,WAAA;EACA,yBAAA;EACA,kBAAA;ALgZhB;AKxgBA;EA2HgB,kBAAA;EACA,OAAA;EACA,MAAA;EACA,SAAA;EACA,WAAA;EACA,kBAAA;ALgZhB;AKhhBA;EAkIoB,kBAAA;EACA,MAAA;EACA,UAAA;EACA,gBAAA;EACA,mBAAA;EACA,YAAA;EACA,WAAA;EACA,kBAAA;EACA,eAAA;EACA,gCAAA;EACA,mBAAA;ALiZpB;AK7hBA;EAkJQ,YAAA;EACA,kBAAA;EACA,SAAA;AL8YR;AK7YQ;EACI,aAAA;EACA,kBAAA;EACA,gCAAA;EACA,UAAA;EACA,YAAA;EACA,SAAA;EACA,UAAA;EACA,WAAA;EACA,WAAA;AL+YZ;AKxZQ;EAWQ,YAAA;ALgZhB;AK3ZQ;EAcQ,kBAAA;EACA,OAAA;EACA,MAAA;ALgZhB;AKhaQ;EAmBQ,kBAAA;EACA,QAAA;EACA,MAAA;ALgZhB;AKraQ;EAwBQ,kBAAA;EACA,iCAAA;EACA,YAAA;EACA,OAAA;EACA,uCAAA;EACA,kBAAA;EACA,uBAAA;EACA,eAAA;EACA,YAAA;EACA,gCAAA;EACA,mBAAA;ALgZhB;AK/YgB;EACI,mBAAA;ALiZpB;AKrbQ;EAuCY,aAAA;ALiZpB;AKxbQ;EA0CY,eAAA;ALiZpB;AK3bQ;EA6CY,eAAA;EACA,WAAA;EACA,iBAAA;ALiZpB;AKhcQ;EAkDY,YAAA;ALiZpB;AKncQ;EAoDgB,kBAAA;ALkZxB;AK/YwB;EAEQ,0BAAA;ALgZhC;AK7YwB;EAEQ,0BAAA;AL8YhC;AK5cQ;EAmEgB,UAAA;EACA,gBAAA;EACA,iBAAA;EACA,qBAAA;EACA,eAAA;EACA,WAAA;EACA,sBAAA;EACA,kBAAA;EACA,sBAAA;EACA,kBAAA;EACA,eAAA;AL4YxB;AKzdQ;EAgFgB,mBAAA;EACA,cAAA;AL4YxB;AK7dQ;EAqFY,YAAA;AL2YpB;AKheQ;EAuFgB,YAAA;EACA,YAAA;EACA,qBAAA;AL4YxB;AKreQ;EA4FgB,WAAA;EACA,YAAA;EACA,qBAAA;EACA,kBAAA;EACA,sBAAA;EACA,eAAA;AL4YxB;AK3YwB;EACI,0CAAA;AL6Y5B;AKhfQ;EAyGQ,aAAA;EACA,YAAA;EACA,iBAAA;EACA,eAAA;EACA,iBAAA;EACA,kBAAA;EACA,kBAAA;EACA,gBAAA;EACA,SAAA;EACA,YAAA;EACA,sBAAA;EACA,WAAA;EACA,WAAA;AL0YhB;AKzYgB;EACI,WAAA;EACA,YAAA;AL2YpB;AK7YgB;EACI,WAAA;EACA,YAAA;AL2YpB;AKzYgB;EACI,aAAA;AL2YpB;AKvYQ;EAEQ,YAAA;ALwYhB;AKrYQ;EACI,WAAA;ALuYZ;AKxYQ;EAGQ,YAAA;ALwYhB;AKpqBA;;EAiSY,iBAAA;EACA,WAAA;EACA,uCAAA;EACA,sBAAA;EACA,eAAA;EACA,eAAA;ALuYZ;AK7qBA;EAySY,qBAAA;EACA,UAAA;EACA,WAAA;EACA,kBAAA;EACA,iBAAA;EACA,WAAA;EACA,kBAAA;ALuYZ;AKtrBA;EAkTY,WAAA;EACA,YAAA;EACA,YAAA;EACA,6BAAA;EACA,aAAA;EACA,eAAA;EACA,sBAAA;EACA,sBAAA;EACA,qBAAA;ALuYZ;AKjsBA;EA4TgB,gCAAA;EACA,YAAA;ALwYhB;AKtYY;EAEQ,UAAA;ALuYpB;AKpYY;EACI,WAAA;EACA,WAAA;EACA,iBAAA;EACA,eAAA;ALsYhB;AKpYY;EACI,qBAAA;ALsYhB;AKpYY;EACI,kBAAA;ALsYhB;AKpYY;EACI,WAAA;ALsYhB;AKvtBA;EAqVY,kBAAA;EACA,qBAAA;EACA,eAAA;EACA,YAAA;ALqYZ;AKpYY;EAEQ,WAAA;ALqYpB;AKvYY;EAKQ,mBAAA;ALqYpB;AKlYY;EAEQ,WAAA;ALmYpB;AKrYY;EAKQ,mBAAA;ALmYpB;AKzuBA;EA0WgB,qBAAA;EACA,qBAAA;EACA,sBAAA;EACA,YAAA;ALkYhB;AK/uBA;EA+WoB,kBAAA;EACA,SAAA;EACA,QAAA;EACA,WAAA;EACA,gBAAA;EACA,gCAAA;ALmYpB;AKvvBA;EAsXwB,kBAAA;EACA,SAAA;EACA,OAAA;EACA,YAAA;EACA,yBAAA;EACA,kBAAA;ALoYxB;AK/vBA;EA6X4B,kBAAA;EACA,MAAA;EACA,UAAA;EACA,gBAAA;EACA,mBAAA;EACA,YAAA;EACA,WAAA;EACA,kBAAA;EACA,eAAA;EACA,gCAAA;EACA,mBAAA;ALqY5B;AK5wBA;EA8YY,qBAAA;EACA,YAAA;ALiYZ;AKhxBA;EAkZY,qBAAA;EACA,YAAA;ALiYZ;AKpxBA;EAqZgB,kBAAA;EACA,QAAA;EACA,YAAA;EACA,mBAAA;EACA,uBAAA;EAAA,kBAAA;EACA,gBAAA;EACA,gBAAA;EACA,kBAAA;EACA,iCAAA;EACA,cAAA;EACA,gCAAA;EACA,cAAA;EACA,UAAA;ALkYhB;AKjYgB;EACI,cAAA;ALmYpB;AKjYgB;EACI,mBAAA;ALmYpB;AKzyBA;EA0agB,YAAA;EACA,iBAAA;EACA,sBAAA;EACA,eAAA;EACA,kBAAA;ALkYhB;AKjYgB;EACI,0CAAA;ALmYpB;AKnzBA;EAqbY,qBAAA;EACA,YAAA;ALiYZ;AKvzBA;EAwbgB,kBAAA;EACA,QAAA;EACA,YAAA;EACA,mBAAA;EACA,YAAA;EACA,kBAAA;EACA,iCAAA;EACA,cAAA;EACA,gCAAA;EACA,gBAAA;EACA,UAAA;ALkYhB;AKjYgB;EACI,aAAA;ALmYpB;AKlYoB;EACI,cAAA;ALoYxB;AKjYgB;EACI,mBAAA;ALmYpB;AKjYgB;EACI,WAAA;EACA,kBAAA;ALmYpB;AKjYgB;EAEQ,aAAA;ALkYxB;AKpYgB;EAKQ,cAAA;ALkYxB;AKv1BA;;EA2dgB,YAAA;EACA,iBAAA;EACA,sBAAA;EACA,eAAA;EACA,kBAAA;ALgYhB;AK/XgB;;EACI,0CAAA;ALkYpB;AKn2BA;EAqegB,cAAA;ALiYhB;AKt2BA;EAueoB,eAAA;EACA,eAAA;ALkYpB;AKhYgB;EAEQ,aAAA;ALiYxB;AKnYgB;EAKQ,qBAAA;ALiYxB;AK9XgB;EAEQ,aAAA;AL+XxB;AKjYgB;EAKQ,qBAAA;AL+XxB;AKt3BA;EA2foB,eAAA;EACA,sBAAA;EACA,aAAA;EACA,sBAAA;EACA,YAAA;EACA,WAAA;AL8XpB;AK93BA;EAkgBwB,kBAAA;EACA,UAAA;EACA,WAAA;EACA,WAAA;EACA,gBAAA;EACA,gCAAA;AL+XxB;AKt4BA;EAygB4B,kBAAA;EACA,SAAA;EACA,OAAA;EACA,YAAA;EACA,yBAAA;EACA,gBAAA;EACA,kBAAA;ALgY5B;AK/4BA;EAihBgC,kBAAA;EACA,MAAA;EACA,UAAA;EACA,gBAAA;EACA,mBAAA;EACA,YAAA;EACA,WAAA;EACA,kBAAA;EACA,eAAA;EACA,gCAAA;EACA,gBAAA;ALiYhC;AK55BA;EAmiBY,qBAAA;EACA,YAAA;EACA,kBAAA;AL4XZ;AK3XY;EAEQ,cAAA;AL4XpB;AKp6BA;EA4iBgB,kBAAA;EACA,UAAA;EACA,UAAA;EACA,aAAA;AL2XhB;AK16BA;EAmjBY,kBAAA;EACA,qBAAA;EACA,YAAA;EACA,UAAA;AL0XZ;AKzXY;EAEQ,cAAA;AL0XpB;AK5XY;EAKQ,cAAA;AL0XpB;AKt7BA;EAgkBgB,aAAA;EACA,kBAAA;EACA,YAAA;EACA,WAAA;EACA,WAAA;EACA,oBAAA;ALyXhB;AK97BA;EAwkBgB,aAAA;EACA,eAAA;EACA,WAAA;EACA,kBAAA;EACA,iCAAA;EACA,cAAA;EACA,gCAAA;EACA,gBAAA;EACA,WAAA;EACA,kBAAA;ALyXhB;AK18BA;EAolBgB,YAAA;EACA,sBAAA;EACA,eAAA;EACA,iBAAA;ALyXhB;AKxXgB;EACI,0CAAA;AL0XpB;AKn9BA;EA8lBY,qBAAA;EACA,YAAA;ALwXZ;AKv9BA;EAkmBY,WAAA;EACA,eAAA;EACA,qBAAA;EACA,sBAAA;EACA,mBAAA;ALwXZ;AK99BA;EAymBY,WAAA;EACA,YAAA;EACA,kBAAA;EACA,YAAA;EACA,sBAAA;EACA,kBAAA;EACA,QAAA;EACA,WAAA;ALwXZ;AKx+BA;EAknBgB,aAAA;EACA,YAAA;EACA,aAAA;ALyXhB;AK7+BA;EAunBgB,qBAAA;EACA,kBAAA;EACA,iCAAA;EACA,yBAAA;EACA,YAAA;EACA,WAAA;EACA,mBAAA;EACA,sBAAA;EACA,eAAA;EACA,4BAAA;ALyXhB;AKz/BA;EAmoBgB,WAAA;EACA,kBAAA;EACA,cAAA;EACA,YAAA;EACA,WAAA;EACA,MAAA;EACA,OAAA;EACA,mBAAA;EACA,4BAAA;ALyXhB;AKpgCA;EA8oBgB,WAAA;EACA,kBAAA;EACA,cAAA;EACA,OAAA;EACA,MAAA;EACA,mBAAA;EACA,gBAAA;EACA,4BAAA;EACA,wCAAA;EACA,YAAA;EACA,WAAA;ALyXhB;AKjhCA;EA2pBgB,sCAAA;ALyXhB;AKphCA;EA8pBgB,WAAA;EACA,oCAAA;ALyXhB;AKxhCA;EAkqBgB,UAAA;ALyXhB;AKnXA;EACI,aAAA;EACA,WAAA;EACA,YAAA;EACA,YAAA;EACA,6BAAA;EACA,aAAA;EACA,eAAA;EACA,sBAAA;EAEA,SAAA;EACA,YAAA;EACA,kBAAA;EACA,SAAA;EACA,QAAA;EACA,gCAAA;ALoXJ;AMpjCA;EACI,kBAAA;EACA,OAAA;EACA,QAAA;EACA,MAAA;EACA,SAAA;EACA,eAAA;EACA,WAAA;ANsjCJ;AM7jCA;EASQ,qBAAA;EACA,oBAAA;EACA,yBAAA;KAAA,sBAAA;UAAA,iBAAA;EACA,eAAA;EACA,mBAAA;EACA,iDAAA;ANujCR;AMtjCQ;EACI,kBAAA;EACA,kBAAA;ANwjCZ;AMzkCA;EAqBQ,kBAAA;EACA,QAAA;EACA,2BAAA;ANujCR;AMtjCQ;EACI,sBAAA;EACA,yBAAA;EACA,iCAAA;EACA,4BAAA;ANwjCZ;AMrjCI;EACI;IACI,2BAAA;ENujCV;AACF;AMzlCA;;EAsCQ,kBAAA;EACA,WAAA;EACA,kBAAA;EACA,kBAAA;ANujCR;AMtjCQ;;EACI,uBAAA;EACA,gCAAA;EACA,iCAAA;EACA,4BAAA;ANyjCZ;AMtjCI;EACI;IACI,mBAAA;ENwjCV;EMtjCM;IACI,mBAAA;ENwjCV;AACF;AO/mCA;EACI,oBAAA;EACA,kBAAA;EACA,UAAA;EACA,SAAA;EACA,eAAA;EACA,gBAAA;APinCJ;AOvnCA;EAQQ,eAAA;EACA,gBAAA;EACA,gBAAA;APknCR;AQ5nCA;EACI,kBAAA;EACA,YAAA;EACA,kBAAA;EACA,kCAAA;EACA,cAAA;EACA,gBAAA;EACA,UAAA;EACA,aAAA;AR8nCJ;AQ7nCI;EACI,cAAA;AR+nCR;AQzoCA;EAaQ,YAAA;EACA,sBAAA;EACA,eAAA;AR+nCR;AQ9nCQ;EACI,0CAAA;ARgoCZ;AQjpCA;EAqBY,eAAA;EACA,iBAAA;EACA,WAAA;EACA,eAAA;EACA,qBAAA;EACA,sBAAA;EACA,WAAA;EACA,sBAAA;EACA,mBAAA;EACA,uBAAA;EACA,gBAAA;AR+nCZ;AQ9nCY;EACI,qBAAA;ARgoChB;AIjqCA;EACI,kBAAA;EACA,YAAA;EACA,UAAA;AJmqCJ;AItqCA;EAMQ,kBAAA;EACA,iCAAA;EACA,gCAAA;EACA,gBAAA;EACA,WAAA;EACA,cAAA;EACA,oBAAA;EACA,0CAAA;AJmqCR;AIhrCA;EAiBQ,4CAAA;AJkqCR;AI9pCA;EACI;IACI,UAAA;IACA,YAAA;IACA,aAAA;EJgqCN;EI9pCE;IACI,iBAAA;IACA,eAAA;IACA,eAAA;EJgqCN;AACF;AI7pCA;EACI;IACI,iBAAA;IACA,eAAA;IACA,eAAA;EJ+pCN;EI7pCE;IACI,eAAA;EJ+pCN;EI7pCE;IACI,YAAA;IACA,iBAAA;EJ+pCN;EI7pCE;IACI,UAAA;IACA,aAAA;IACA,YAAA;EJ+pCN;AACF;ASltCA;EACI,kBAAA;EACA,YAAA;EACA,UAAA;EACA,QAAA;EACA,kBAAA;EACA,WAAA;EACA,iDAAA;EACA,eAAA;ATotCJ;ASntCI;EACI,aAAA;ATqtCR;AU/tCA;EACI,kBAAA;EACA,MAAA;EACA,SAAA;EACA,OAAA;EACA,QAAA;EACA,UAAA;EACA,aAAA;AViuCJ;AUhuCI;EACI,cAAA;AVkuCR;AU9tCA;EACI,kBAAA;EACA,gBAAA;EACA,YAAA;EACA,WAAA;EACA,YAAA;AVguCJ;AUruCA;EAOQ,WAAA;EACA,YAAA;EACA,aAAA;AViuCR;AU1uCA;EAYQ,cAAA;AViuCR;AU7uCA;EAeQ,aAAA;AViuCR;AW7vCA;EACI,kBAAA;EACA,SAAA;EACA,UAAA;EACA,YAAA;EACA,iCAAA;EACA,aAAA;EACA,WAAA;EACA,eAAA;EACA,kBAAA;AX+vCJ;AW7vCI;EACI,aAAA;AX+vCR;AW3wCA;EAgBQ,eAAA;EACA,kBAAA;EACA,WAAA;EACA,SAAA;AX8vCR;AW1vCQ;EACI,qBAAA;EACA,sBAAA;EACA,iBAAA;EACA,mBAAA;EACA,uBAAA;EACA,gBAAA;AX4vCZ;AWzxCA;EAkCQ,YAAA;EACA,iBAAA;EACA,kBAAA;AX0vCR;AW9xCA;EAwCQ,YAAA;AXyvCR",sourcesContent:[`@keyframes my-face {
    2% {
        transform: translate(0, 1.5px) rotate(1.5deg);
    }
    4% {
        transform: translate(0, -1.5px) rotate(-0.5deg);
    }
    6% {
        transform: translate(0, 1.5px) rotate(-1.5deg);
    }
    8% {
        transform: translate(0, -1.5px) rotate(-1.5deg);
    }
    10% {
        transform: translate(0, 2.5px) rotate(1.5deg);
    }
    12% {
        transform: translate(0, -0.5px) rotate(1.5deg);
    }
    14% {
        transform: translate(0, -1.5px) rotate(1.5deg);
    }
    16% {
        transform: translate(0, -0.5px) rotate(-1.5deg);
    }
    18% {
        transform: translate(0, 0.5px) rotate(-1.5deg);
    }
    20% {
        transform: translate(0, -1.5px) rotate(2.5deg);
    }
    22% {
        transform: translate(0, 0.5px) rotate(-1.5deg);
    }
    24% {
        transform: translate(0, 1.5px) rotate(1.5deg);
    }
    26% {
        transform: translate(0, 0.5px) rotate(0.5deg);
    }
    28% {
        transform: translate(0, 0.5px) rotate(1.5deg);
    }
    30% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    32% {
        transform: translate(0, 1.5px) rotate(-0.5deg);
    }
    34% {
        transform: translate(0, 1.5px) rotate(-0.5deg);
    }
    36% {
        transform: translate(0, -1.5px) rotate(2.5deg);
    }
    38% {
        transform: translate(0, 1.5px) rotate(-1.5deg);
    }
    40% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    42% {
        transform: translate(0, 2.5px) rotate(-1.5deg);
    }
    44% {
        transform: translate(0, 1.5px) rotate(0.5deg);
    }
    46% {
        transform: translate(0, -1.5px) rotate(2.5deg);
    }
    48% {
        transform: translate(0, -0.5px) rotate(0.5deg);
    }
    50% {
        transform: translate(0, 0.5px) rotate(0.5deg);
    }
    52% {
        transform: translate(0, 2.5px) rotate(2.5deg);
    }
    54% {
        transform: translate(0, -1.5px) rotate(1.5deg);
    }
    56% {
        transform: translate(0, 2.5px) rotate(2.5deg);
    }
    58% {
        transform: translate(0, 0.5px) rotate(2.5deg);
    }
    60% {
        transform: translate(0, 2.5px) rotate(2.5deg);
    }
    62% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    64% {
        transform: translate(0, -0.5px) rotate(1.5deg);
    }
    66% {
        transform: translate(0, 1.5px) rotate(-0.5deg);
    }
    68% {
        transform: translate(0, -1.5px) rotate(-0.5deg);
    }
    70% {
        transform: translate(0, 1.5px) rotate(0.5deg);
    }
    72% {
        transform: translate(0, 2.5px) rotate(1.5deg);
    }
    74% {
        transform: translate(0, -0.5px) rotate(0.5deg);
    }
    76% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    78% {
        transform: translate(0, -0.5px) rotate(1.5deg);
    }
    80% {
        transform: translate(0, 1.5px) rotate(1.5deg);
    }
    82% {
        transform: translate(0, -0.5px) rotate(0.5deg);
    }
    84% {
        transform: translate(0, 1.5px) rotate(2.5deg);
    }
    86% {
        transform: translate(0, -1.5px) rotate(-1.5deg);
    }
    88% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    90% {
        transform: translate(0, 2.5px) rotate(-0.5deg);
    }
    92% {
        transform: translate(0, 0.5px) rotate(-0.5deg);
    }
    94% {
        transform: translate(0, 2.5px) rotate(0.5deg);
    }
    96% {
        transform: translate(0, -0.5px) rotate(1.5deg);
    }
    98% {
        transform: translate(0, -1.5px) rotate(-0.5deg);
    }
    0%,
    100% {
        transform: translate(0, 0) rotate(0deg);
    }
}`,`@import '../../node_modules/balloon-css/balloon.css';
@keyframes my-face {
  2% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  4% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  6% {
    transform: translate(0, 1.5px) rotate(-1.5deg);
  }
  8% {
    transform: translate(0, -1.5px) rotate(-1.5deg);
  }
  10% {
    transform: translate(0, 2.5px) rotate(1.5deg);
  }
  12% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  14% {
    transform: translate(0, -1.5px) rotate(1.5deg);
  }
  16% {
    transform: translate(0, -0.5px) rotate(-1.5deg);
  }
  18% {
    transform: translate(0, 0.5px) rotate(-1.5deg);
  }
  20% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  22% {
    transform: translate(0, 0.5px) rotate(-1.5deg);
  }
  24% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  26% {
    transform: translate(0, 0.5px) rotate(0.5deg);
  }
  28% {
    transform: translate(0, 0.5px) rotate(1.5deg);
  }
  30% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  32% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  34% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  36% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  38% {
    transform: translate(0, 1.5px) rotate(-1.5deg);
  }
  40% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  42% {
    transform: translate(0, 2.5px) rotate(-1.5deg);
  }
  44% {
    transform: translate(0, 1.5px) rotate(0.5deg);
  }
  46% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  48% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  50% {
    transform: translate(0, 0.5px) rotate(0.5deg);
  }
  52% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  54% {
    transform: translate(0, -1.5px) rotate(1.5deg);
  }
  56% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  58% {
    transform: translate(0, 0.5px) rotate(2.5deg);
  }
  60% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  62% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  64% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  66% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  68% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  70% {
    transform: translate(0, 1.5px) rotate(0.5deg);
  }
  72% {
    transform: translate(0, 2.5px) rotate(1.5deg);
  }
  74% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  76% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  78% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  80% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  82% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  84% {
    transform: translate(0, 1.5px) rotate(2.5deg);
  }
  86% {
    transform: translate(0, -1.5px) rotate(-1.5deg);
  }
  88% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  90% {
    transform: translate(0, 2.5px) rotate(-0.5deg);
  }
  92% {
    transform: translate(0, 0.5px) rotate(-0.5deg);
  }
  94% {
    transform: translate(0, 2.5px) rotate(0.5deg);
  }
  96% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  98% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  0%,
  100% {
    transform: translate(0, 0) rotate(0deg);
  }
}
.dplayer {
  position: relative;
  overflow: hidden;
  user-select: none;
  line-height: 1;
}
.dplayer * {
  box-sizing: content-box;
}
.dplayer svg {
  width: 100%;
  height: 100%;
}
.dplayer svg path,
.dplayer svg circle {
  fill: #fff;
}
.dplayer:-webkit-full-screen {
  width: 100%;
  height: 100%;
  background: #000;
  position: fixed;
  z-index: 100000;
  left: 0;
  top: 0;
  margin: 0;
  padding: 0;
  transform: translate(0, 0);
}
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-showdan,
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-danmaku,
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-danunlimit {
  display: none;
}
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-comment {
  display: none;
}
.dplayer.dplayer-no-danmaku .dplayer-danmaku {
  display: none;
}
.dplayer.dplayer-live .dplayer-time {
  display: none;
}
.dplayer.dplayer-live .dplayer-bar-wrap {
  display: none;
}
.dplayer.dplayer-live .dplayer-setting-speed {
  display: none;
}
.dplayer.dplayer-live .dplayer-setting-loop {
  display: none;
}
.dplayer.dplayer-live.dplayer-no-danmaku .dplayer-setting {
  display: none;
}
.dplayer.dplayer-arrow .dplayer-danmaku {
  font-size: 18px;
}
.dplayer.dplayer-arrow .dplayer-icon {
  margin: 0 -3px;
}
.dplayer.dplayer-playing .dplayer-danmaku .dplayer-danmaku-move {
  animation-play-state: running;
}
@media (min-width: 900px) {
  .dplayer.dplayer-playing .dplayer-controller-mask {
    opacity: 0;
  }
  .dplayer.dplayer-playing .dplayer-controller {
    opacity: 0;
  }
  .dplayer.dplayer-playing:hover .dplayer-controller-mask {
    opacity: 1;
  }
  .dplayer.dplayer-playing:hover .dplayer-controller {
    opacity: 1;
  }
}
.dplayer.dplayer-loading .dplayer-bezel .diplayer-loading-icon {
  display: block;
}
.dplayer.dplayer-loading .dplayer-danmaku,
.dplayer.dplayer-paused .dplayer-danmaku,
.dplayer.dplayer-loading .dplayer-danmaku-move,
.dplayer.dplayer-paused .dplayer-danmaku-move {
  animation-play-state: paused;
}
.dplayer.dplayer-hide-controller {
  cursor: none;
}
.dplayer.dplayer-hide-controller .dplayer-controller-mask {
  opacity: 0;
  transform: translateY(100%);
}
.dplayer.dplayer-hide-controller .dplayer-controller {
  opacity: 0;
  transform: translateY(100%);
}
.dplayer.dplayer-show-controller .dplayer-controller-mask {
  opacity: 1;
}
.dplayer.dplayer-show-controller .dplayer-controller {
  opacity: 1;
}
.dplayer.dplayer-fulled {
  position: fixed;
  z-index: 100000;
  left: 0;
  top: 0;
  width: 100% !important;
  height: 100% !important;
}
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-volume,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-camera-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-airplay-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-chromecast-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-play-icon {
  display: none;
}
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-full .dplayer-full-in-icon {
  position: static;
  display: inline-block;
}
.dplayer.dplayer-mobile .dplayer-bar-time {
  display: none;
}
.dplayer.dplayer-mobile.dplayer-hide-controller .dplayer-mobile-play {
  display: none;
}
.dplayer.dplayer-mobile .dplayer-mobile-play {
  display: block;
}
.dplayer-web-fullscreen-fix {
  position: fixed;
  top: 0;
  left: 0;
  margin: 0;
  padding: 0;
}
[data-balloon]:before {
  display: none;
}
[data-balloon]:after {
  padding: 0.3em 0.7em;
  background: rgba(17, 17, 17, 0.7);
}
[data-balloon][data-balloon-pos="up"]:after {
  margin-bottom: 0;
}
.dplayer-bezel {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  font-size: 22px;
  color: #fff;
  pointer-events: none;
}
.dplayer-bezel .dplayer-bezel-icon {
  position: absolute;
  top: 50%;
  left: 50%;
  margin: -26px 0 0 -26px;
  height: 52px;
  width: 52px;
  padding: 12px;
  box-sizing: border-box;
  background: rgba(0, 0, 0, 0.5);
  border-radius: 50%;
  opacity: 0;
  pointer-events: none;
}
.dplayer-bezel .dplayer-bezel-icon.dplayer-bezel-transition {
  animation: bezel-hide 0.5s linear;
}
@keyframes bezel-hide {
  from {
    opacity: 1;
    transform: scale(1);
  }
  to {
    opacity: 0;
    transform: scale(2);
  }
}
.dplayer-bezel .dplayer-danloading {
  position: absolute;
  top: 50%;
  margin-top: -7px;
  width: 100%;
  text-align: center;
  font-size: 14px;
  line-height: 14px;
  animation: my-face 5s infinite ease-in-out;
}
.dplayer-bezel .diplayer-loading-icon {
  display: none;
  position: absolute;
  top: 50%;
  left: 50%;
  margin: -18px 0 0 -18px;
  height: 36px;
  width: 36px;
  pointer-events: none;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-hide {
  display: none;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot {
  animation: diplayer-loading-dot-fade 0.8s ease infinite;
  opacity: 0;
  transform-origin: 4px 4px;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-1 {
  animation-delay: 0.1s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-2 {
  animation-delay: 0.2s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-3 {
  animation-delay: 0.3s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-4 {
  animation-delay: 0.4s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-5 {
  animation-delay: 0.5s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-6 {
  animation-delay: 0.6s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-7 {
  animation-delay: 0.7s;
}
@keyframes diplayer-loading-dot-fade {
  0% {
    opacity: 0.7;
    transform: scale(1.2, 1.2);
  }
  50% {
    opacity: 0.25;
    transform: scale(0.9, 0.9);
  }
  to {
    opacity: 0.25;
    transform: scale(0.85, 0.85);
  }
}
.dplayer-controller-mask {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAADGCAYAAAAT+OqFAAAAdklEQVQoz42QQQ7AIAgEF/T/D+kbq/RWAlnQyyazA4aoAB4FsBSA/bFjuF1EOL7VbrIrBuusmrt4ZZORfb6ehbWdnRHEIiITaEUKa5EJqUakRSaEYBJSCY2dEstQY7AuxahwXFrvZmWl2rh4JZ07z9dLtesfNj5q0FU3A5ObbwAAAABJRU5ErkJggg==) repeat-x bottom;
  height: 98px;
  width: 100%;
  position: absolute;
  bottom: 0;
  transition: all 0.3s ease;
}
.dplayer-controller {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 41px;
  padding: 0 20px;
  user-select: none;
  transition: all 0.3s ease;
}
.dplayer-controller.dplayer-controller-comment .dplayer-icons {
  display: none;
}
.dplayer-controller.dplayer-controller-comment .dplayer-icons.dplayer-comment-box {
  display: block;
}
.dplayer-controller .dplayer-bar-wrap {
  padding: 5px 0;
  cursor: pointer;
  position: absolute;
  bottom: 33px;
  width: calc(100% - 40px);
  height: 3px;
}
.dplayer-controller .dplayer-bar-wrap:hover .dplayer-bar .dplayer-played .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-bar-wrap:hover .dplayer-highlight {
  display: block;
  width: 8px;
  transform: translateX(-4px);
  top: 4px;
  height: 40%;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight {
  z-index: 12;
  position: absolute;
  top: 5px;
  width: 6px;
  height: 20%;
  border-radius: 6px;
  background-color: #fff;
  text-align: center;
  transform: translateX(-3px);
  transition: all 0.2s ease-in-out;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover .dplayer-highlight-text {
  display: block;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover ~ .dplayer-bar-preview {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover ~ .dplayer-bar-time {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight .dplayer-highlight-text {
  display: none;
  position: absolute;
  left: 50%;
  top: -24px;
  padding: 5px 8px;
  background-color: rgba(0, 0, 0, 0.62);
  color: #fff;
  border-radius: 4px;
  font-size: 12px;
  white-space: nowrap;
  transform: translateX(-50%);
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-preview {
  position: absolute;
  background: #fff;
  pointer-events: none;
  display: none;
  background-size: 16000px 100%;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-preview-canvas {
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: 1;
  pointer-events: none;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-time {
  position: absolute;
  left: 0px;
  top: -20px;
  border-radius: 4px;
  padding: 5px 7px;
  background-color: rgba(0, 0, 0, 0.62);
  color: #fff;
  font-size: 12px;
  text-align: center;
  opacity: 1;
  transition: opacity 0.1s ease-in-out;
  word-wrap: normal;
  word-break: normal;
  z-index: 2;
  pointer-events: none;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-time.hidden {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar {
  position: relative;
  height: 3px;
  width: 100%;
  background: rgba(255, 255, 255, 0.2);
  cursor: pointer;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-loaded {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  background: rgba(255, 255, 255, 0.4);
  height: 3px;
  transition: all 0.5s ease;
  will-change: width;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-played {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  height: 3px;
  will-change: width;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-played .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons {
  height: 38px;
  position: absolute;
  bottom: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box {
  display: none;
  position: absolute;
  transition: all 0.3s ease-in-out;
  z-index: 2;
  height: 38px;
  bottom: 0;
  left: 20px;
  right: 20px;
  color: #fff;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-icon {
  padding: 7px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-icon {
  position: absolute;
  left: 0;
  top: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-send-icon {
  position: absolute;
  right: 0;
  top: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box {
  position: absolute;
  background: rgba(28, 28, 28, 0.9);
  bottom: 41px;
  left: 0;
  box-shadow: 0 0 25px rgba(0, 0, 0, 0.3);
  border-radius: 4px;
  padding: 10px 10px 16px;
  font-size: 14px;
  width: 204px;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box.dplayer-comment-setting-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box input[type=radio] {
  display: none;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box label {
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-title {
  font-size: 13px;
  color: #fff;
  line-height: 30px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type {
  font-size: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type .dplayer-comment-setting-title {
  margin-bottom: 6px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type label:nth-child(2) span {
  border-radius: 4px 0 0 4px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type label:nth-child(4) span {
  border-radius: 0 4px 4px 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type span {
  width: 33%;
  padding: 4px 6px;
  line-height: 16px;
  display: inline-block;
  font-size: 12px;
  color: #fff;
  border: 1px solid #fff;
  margin-right: -1px;
  box-sizing: border-box;
  text-align: center;
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type input:checked + span {
  background: #E4E4E6;
  color: #1c1c1c;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color {
  font-size: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color label {
  font-size: 0;
  padding: 6px;
  display: inline-block;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color span {
  width: 22px;
  height: 22px;
  display: inline-block;
  border-radius: 50%;
  box-sizing: border-box;
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color span:hover {
  animation: my-face 5s infinite ease-in-out;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input {
  outline: none;
  border: none;
  padding: 8px 31px;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  border-radius: 4px;
  background: none;
  margin: 0;
  height: 100%;
  box-sizing: border-box;
  width: 100%;
  color: #fff;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::placeholder {
  color: #fff;
  opacity: 0.8;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::-ms-clear {
  display: none;
}
.dplayer-controller .dplayer-icons.dplayer-icons-left .dplayer-icon {
  padding: 7px;
}
.dplayer-controller .dplayer-icons.dplayer-icons-right {
  right: 20px;
}
.dplayer-controller .dplayer-icons.dplayer-icons-right .dplayer-icon {
  padding: 8px;
}
.dplayer-controller .dplayer-icons .dplayer-time,
.dplayer-controller .dplayer-icons .dplayer-live-badge {
  line-height: 38px;
  color: #eee;
  text-shadow: 0 0 2px rgba(0, 0, 0, 0.5);
  vertical-align: middle;
  font-size: 13px;
  cursor: default;
}
.dplayer-controller .dplayer-icons .dplayer-live-dot {
  display: inline-block;
  width: 6px;
  height: 6px;
  vertical-align: 4%;
  margin-right: 5px;
  content: '';
  border-radius: 6px;
}
.dplayer-controller .dplayer-icons .dplayer-icon {
  width: 40px;
  height: 100%;
  border: none;
  background-color: transparent;
  outline: none;
  cursor: pointer;
  vertical-align: middle;
  box-sizing: border-box;
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-icon .dplayer-icon-content {
  transition: all 0.2s ease-in-out;
  opacity: 0.8;
}
.dplayer-controller .dplayer-icons .dplayer-icon:hover .dplayer-icon-content {
  opacity: 1;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-quality-icon {
  color: #fff;
  width: auto;
  line-height: 22px;
  font-size: 14px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-comment-icon {
  padding: 10px 9px 9px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-setting-icon {
  padding-top: 8.5px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-volume-icon {
  width: 43px;
}
.dplayer-controller .dplayer-icons .dplayer-volume {
  position: relative;
  display: inline-block;
  cursor: pointer;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-volume:hover .dplayer-volume-bar-wrap .dplayer-volume-bar {
  width: 45px;
}
.dplayer-controller .dplayer-icons .dplayer-volume:hover .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-volume.dplayer-volume-active .dplayer-volume-bar-wrap .dplayer-volume-bar {
  width: 45px;
}
.dplayer-controller .dplayer-icons .dplayer-volume.dplayer-volume-active .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap {
  display: inline-block;
  margin: 0 10px 0 -5px;
  vertical-align: middle;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar {
  position: relative;
  top: 17px;
  width: 0;
  height: 3px;
  background: #aaa;
  transition: all 0.3s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 100%;
  transition: all 0.1s ease;
  will-change: width;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons .dplayer-subtitle-btn {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box {
  position: absolute;
  right: 0;
  bottom: 50px;
  transform: scale(0);
  width: fit-content;
  max-width: 240px;
  min-width: 120px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 7px 0;
  transition: all 0.3s ease-in-out;
  overflow: auto;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box.dplayer-subtitles-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box.dplayer-subtitles-box-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-item {
  height: 30px;
  padding: 5px 10px;
  box-sizing: border-box;
  cursor: pointer;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-setting {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box {
  position: absolute;
  right: 0;
  bottom: 50px;
  transform: scale(0);
  width: 150px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 7px 0;
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box > div {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box > div.dplayer-setting-origin-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-narrow {
  width: 70px;
  text-align: center;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-speed .dplayer-setting-origin-panel {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-speed .dplayer-setting-speed-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-item,
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-speed-item {
  height: 30px;
  padding: 5px 10px;
  box-sizing: border-box;
  cursor: pointer;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-item:hover,
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-speed-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku {
  padding: 5px 0;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-label {
  padding: 0 10px;
  display: inline;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku:hover .dplayer-label {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku:hover .dplayer-danmaku-bar-wrap {
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-label {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-danmaku-bar-wrap {
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap {
  padding: 0 10px;
  box-sizing: border-box;
  display: none;
  vertical-align: middle;
  height: 100%;
  width: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar {
  position: relative;
  top: 8.5px;
  width: 100%;
  height: 3px;
  background: #fff;
  transition: all 0.3s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar .dplayer-danmaku-bar-inner {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 100%;
  transition: all 0.1s ease;
  background: #aaa;
  will-change: width;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar .dplayer-danmaku-bar-inner .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  background: #aaa;
}
.dplayer-controller .dplayer-icons .dplayer-full {
  display: inline-block;
  height: 100%;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-full:hover .dplayer-full-in-icon {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-full .dplayer-full-in-icon {
  position: absolute;
  top: -30px;
  z-index: 1;
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-quality {
  position: relative;
  display: inline-block;
  height: 100%;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-quality:hover .dplayer-quality-list {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-quality:hover .dplayer-quality-mask {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-mask {
  display: none;
  position: absolute;
  bottom: 38px;
  left: -18px;
  width: 80px;
  padding-bottom: 12px;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-list {
  display: none;
  font-size: 12px;
  width: 80px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 5px 0;
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  color: #fff;
  text-align: center;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-item {
  height: 25px;
  box-sizing: border-box;
  cursor: pointer;
  line-height: 25px;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-comment {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-label {
  color: #eee;
  font-size: 13px;
  display: inline-block;
  vertical-align: middle;
  white-space: nowrap;
}
.dplayer-controller .dplayer-icons .dplayer-toggle {
  width: 32px;
  height: 20px;
  text-align: center;
  font-size: 0;
  vertical-align: middle;
  position: absolute;
  top: 5px;
  right: 10px;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input {
  max-height: 0;
  max-width: 0;
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label {
  display: inline-block;
  position: relative;
  box-shadow: #dfdfdf 0 0 0 0 inset;
  border: 1px solid #dfdfdf;
  height: 20px;
  width: 32px;
  border-radius: 10px;
  box-sizing: border-box;
  cursor: pointer;
  transition: 0.2s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label:before {
  content: "";
  position: absolute;
  display: block;
  height: 18px;
  width: 18px;
  top: 0;
  left: 0;
  border-radius: 15px;
  transition: 0.2s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label:after {
  content: "";
  position: absolute;
  display: block;
  left: 0;
  top: 0;
  border-radius: 15px;
  background: #fff;
  transition: 0.2s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
  height: 18px;
  width: 18px;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label {
  border-color: rgba(255, 255, 255, 0.5);
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label:before {
  width: 30px;
  background: rgba(255, 255, 255, 0.5);
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label:after {
  left: 12px;
}
.dplayer-mobile-play {
  display: none;
  width: 50px;
  height: 50px;
  border: none;
  background-color: transparent;
  outline: none;
  cursor: pointer;
  box-sizing: border-box;
  bottom: 0;
  opacity: 0.8;
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
}
.dplayer-danmaku {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  font-size: 22px;
  color: #fff;
}
.dplayer-danmaku .dplayer-danmaku-item {
  display: inline-block;
  pointer-events: none;
  user-select: none;
  cursor: default;
  white-space: nowrap;
  text-shadow: 0.5px 0.5px 0.5px rgba(0, 0, 0, 0.5);
}
.dplayer-danmaku .dplayer-danmaku-item--demo {
  position: absolute;
  visibility: hidden;
}
.dplayer-danmaku .dplayer-danmaku-right {
  position: absolute;
  right: 0;
  transform: translateX(100%);
}
.dplayer-danmaku .dplayer-danmaku-right.dplayer-danmaku-move {
  will-change: transform;
  animation-name: 'danmaku';
  animation-timing-function: linear;
  animation-play-state: paused;
}
@keyframes danmaku {
  from {
    transform: translateX(100%);
  }
}
.dplayer-danmaku .dplayer-danmaku-top,
.dplayer-danmaku .dplayer-danmaku-bottom {
  position: absolute;
  width: 100%;
  text-align: center;
  visibility: hidden;
}
.dplayer-danmaku .dplayer-danmaku-top.dplayer-danmaku-move,
.dplayer-danmaku .dplayer-danmaku-bottom.dplayer-danmaku-move {
  will-change: visibility;
  animation-name: 'danmaku-center';
  animation-timing-function: linear;
  animation-play-state: paused;
}
@keyframes danmaku-center {
  from {
    visibility: visible;
  }
  to {
    visibility: visible;
  }
}
.dplayer-logo {
  pointer-events: none;
  position: absolute;
  left: 20px;
  top: 20px;
  max-width: 50px;
  max-height: 50px;
}
.dplayer-logo img {
  max-width: 100%;
  max-height: 100%;
  background: none;
}
.dplayer-menu {
  position: absolute;
  width: 170px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.85);
  padding: 5px 0;
  overflow: hidden;
  z-index: 3;
  display: none;
}
.dplayer-menu.dplayer-menu-show {
  display: block;
}
.dplayer-menu .dplayer-menu-item {
  height: 30px;
  box-sizing: border-box;
  cursor: pointer;
}
.dplayer-menu .dplayer-menu-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-menu .dplayer-menu-item a {
  padding: 0 10px;
  line-height: 30px;
  color: #eee;
  font-size: 13px;
  display: inline-block;
  vertical-align: middle;
  width: 100%;
  box-sizing: border-box;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
.dplayer-menu .dplayer-menu-item a:hover {
  text-decoration: none;
}
.dplayer-notice-list {
  position: absolute;
  bottom: 60px;
  left: 20px;
}
.dplayer-notice-list .dplayer-notice {
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  color: #fff;
  display: table;
  pointer-events: none;
  animation: showNotice 0.3s ease 1 forwards;
}
.dplayer-notice-list .remove-notice {
  animation: removeNotice 0.3s ease 1 forwards;
}
@keyframes showNotice {
  from {
    padding: 0;
    font-size: 0;
    margin-top: 0;
  }
  to {
    padding: 7px 20px;
    font-size: 14px;
    margin-top: 5px;
  }
}
@keyframes removeNotice {
  0% {
    padding: 7px 20px;
    font-size: 14px;
    margin-top: 5px;
  }
  20% {
    font-size: 12px;
  }
  21% {
    font-size: 0;
    padding: 7px 10px;
  }
  100% {
    padding: 0;
    margin-top: 0;
    font-size: 0;
  }
}
.dplayer-subtitle {
  position: absolute;
  bottom: 40px;
  width: 90%;
  left: 5%;
  text-align: center;
  color: #fff;
  text-shadow: 0.5px 0.5px 0.5px rgba(0, 0, 0, 0.5);
  font-size: 20px;
}
.dplayer-subtitle.dplayer-subtitle-hide {
  display: none;
}
.dplayer-mask {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 1;
  display: none;
}
.dplayer-mask.dplayer-mask-show {
  display: block;
}
.dplayer-video-wrap {
  position: relative;
  background: #000;
  font-size: 0;
  width: 100%;
  height: 100%;
}
.dplayer-video-wrap .dplayer-video {
  width: 100%;
  height: 100%;
  display: none;
}
.dplayer-video-wrap .dplayer-video-current {
  display: block;
}
.dplayer-video-wrap .dplayer-video-prepare {
  display: none;
}
.dplayer-info-panel {
  position: absolute;
  top: 10px;
  left: 10px;
  width: 400px;
  background: rgba(28, 28, 28, 0.8);
  padding: 10px;
  color: #fff;
  font-size: 12px;
  border-radius: 2px;
}
.dplayer-info-panel-hide {
  display: none;
}
.dplayer-info-panel .dplayer-info-panel-close {
  cursor: pointer;
  position: absolute;
  right: 10px;
  top: 10px;
}
.dplayer-info-panel .dplayer-info-panel-item > span {
  display: inline-block;
  vertical-align: middle;
  line-height: 15px;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
.dplayer-info-panel .dplayer-info-panel-item-title {
  width: 100px;
  text-align: right;
  margin-right: 10px;
}
.dplayer-info-panel .dplayer-info-panel-item-data {
  width: 260px;
}
`,`.dplayer {
    position: relative;
    overflow: hidden;
    user-select: none;
    line-height: 1;

    * {
        box-sizing: content-box;
    }

    svg {
        width: 100%;
        height: 100%;

        path,
        circle {
            fill: #fff;
        }
    }

    &:-webkit-full-screen {
        width: 100%;
        height: 100%;
        background: #000;
        position: fixed;
        z-index: 100000;
        left: 0;
        top: 0;
        margin: 0;
        padding: 0;
        transform: translate(0, 0);
        
    }

    &.dplayer-no-danmaku {
        .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box {
            .dplayer-setting-showdan,
            .dplayer-setting-danmaku,
            .dplayer-setting-danunlimit {
                display: none;
            }
        }

        .dplayer-controller .dplayer-icons .dplayer-comment {
            display: none;
        }

        .dplayer-danmaku {
            display: none;
        }
    }

    &.dplayer-live {
        .dplayer-time {
            display: none;
        }
        .dplayer-bar-wrap {
            display: none;
        }
        .dplayer-setting-speed {
            display: none;
        }
        .dplayer-setting-loop {
            display: none;
        }

        &.dplayer-no-danmaku {
            .dplayer-setting {
                display: none;
            }
        }
    }

    &.dplayer-arrow {
        .dplayer-danmaku {
            font-size: 18px;
        }
        .dplayer-icon {
            margin: 0 -3px;
        }
    }

    &.dplayer-playing {
        .dplayer-danmaku .dplayer-danmaku-move {
            animation-play-state: running;
        }

        @media (min-width: 900px) {
            .dplayer-controller-mask {
                opacity: 0;
            }
            .dplayer-controller {
                opacity: 0;
            }

            &:hover {
                .dplayer-controller-mask {
                    opacity: 1;
                }
                .dplayer-controller {
                    opacity: 1;
                }
            }
        }
    }

    &.dplayer-loading {
        .dplayer-bezel .diplayer-loading-icon {
            display: block;
        }
    }

    &.dplayer-loading,
    &.dplayer-paused {
        .dplayer-danmaku,
        .dplayer-danmaku-move {
            animation-play-state: paused;
        }
    }

    &.dplayer-hide-controller {
        cursor: none;

        .dplayer-controller-mask {
            opacity: 0;
            transform: translateY(100%);
        }
        .dplayer-controller {
            opacity: 0;
            transform: translateY(100%);
        }
    }
    &.dplayer-show-controller {
        .dplayer-controller-mask {
            opacity: 1;
        }
        .dplayer-controller {
            opacity: 1;
        }
    }
    &.dplayer-fulled {
        position: fixed;
        z-index: 100000;
        left: 0;
        top: 0;
        width: 100% !important;
        height: 100% !important;
    }
    &.dplayer-mobile {
        .dplayer-controller .dplayer-icons {
            .dplayer-volume,
            .dplayer-camera-icon,
            .dplayer-airplay-icon,
            .dplayer-chromecast-icon,
            .dplayer-play-icon {
                display: none;
            }
            .dplayer-full .dplayer-full-in-icon {
                position: static;
                display: inline-block;
            }
        }

        .dplayer-bar-time {
            display: none;
        }

        &.dplayer-hide-controller {
            .dplayer-mobile-play {
                display: none;
            }
        }

        .dplayer-mobile-play {
            display: block;
        }
    }
}

// To hide scroll bar, apply this class to <body>
.dplayer-web-fullscreen-fix {
    position: fixed;
    top: 0;
    left: 0;
    margin: 0;
    padding: 0;
}
`,`@import '../../node_modules/balloon-css/balloon.css';

[data-balloon]:before {
    display: none;
}

[data-balloon]:after {
    padding: 0.3em 0.7em;
    background: rgba(17, 17, 17, 0.7);
}

[data-balloon][data-balloon-pos="up"]:after {
    margin-bottom: 0;
}`,`.dplayer-bezel {
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    font-size: 22px;
    color: #fff;
    pointer-events: none;
    .dplayer-bezel-icon {
        position: absolute;
        top: 50%;
        left: 50%;
        margin: -26px 0 0 -26px;
        height: 52px;
        width: 52px;
        padding: 12px;
        box-sizing: border-box;
        background: rgba(0, 0, 0, .5);
        border-radius: 50%;
        opacity: 0;
        pointer-events: none;
        &.dplayer-bezel-transition {
            animation: bezel-hide .5s linear;
        }
        @keyframes bezel-hide {
            from {
                opacity: 1;
                transform: scale(1);
            }
            to {
                opacity: 0;
                transform: scale(2);
            }
        }
    }
    .dplayer-danloading {
        position: absolute;
        top: 50%;
        margin-top: -7px;
        width: 100%;
        text-align: center;
        font-size: 14px;
        line-height: 14px;
        animation: my-face 5s infinite ease-in-out;
    }
    .diplayer-loading-icon {
        display: none;
        position: absolute;
        top: 50%;
        left: 50%;
        margin: -18px 0 0 -18px;
        height: 36px;
        width: 36px;
        pointer-events: none;
        .diplayer-loading-hide {
            display: none;
        }
        .diplayer-loading-dot {
            animation: diplayer-loading-dot-fade .8s ease infinite;
            opacity: 0;
            transform-origin: 4px 4px;
            each(range(7), {
                &.diplayer-loading-dot-@{value} {
                    animation-delay: (@value * 0.1s);
                }
            });
        }
        @keyframes diplayer-loading-dot-fade {
            0% {
                opacity: .7;
                transform: scale(1.2, 1.2)
            }
            50% {
                opacity: .25;
                transform: scale(.9, .9)
            }
            to {
                opacity: .25;
                transform: scale(.85, .85)
            }
        }
    }
}`,`.dplayer-notice-list{
    position: absolute;
    bottom: 60px;
    left: 20px;

    .dplayer-notice {
        border-radius: 2px;
        background: rgba(28, 28, 28, 0.9);
        transition: all .3s ease-in-out;
        overflow: hidden;
        color: #fff;
        display: table;
        pointer-events: none;
        animation: showNotice .3s ease 1 forwards;
    }

    .remove-notice{
        animation: removeNotice .3s ease 1 forwards;
    }
}

@keyframes showNotice {
    from {
        padding: 0;
        font-size: 0;
        margin-top: 0;
    }
    to {
        padding: 7px 20px;
        font-size: 14px;
        margin-top: 5px;
    }
}

@keyframes removeNotice {
    0%{
        padding: 7px 20px;
        font-size: 14px;
        margin-top: 5px;
    }
    20%{
        font-size: 12px;
    }
    21%{
        font-size: 0;
        padding: 7px 10px;
    }
    100%{
        padding: 0;
        margin-top: 0;
        font-size: 0;
    }
}
`,`.dplayer-controller-mask {
    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAADGCAYAAAAT+OqFAAAAdklEQVQoz42QQQ7AIAgEF/T/D+kbq/RWAlnQyyazA4aoAB4FsBSA/bFjuF1EOL7VbrIrBuusmrt4ZZORfb6ehbWdnRHEIiITaEUKa5EJqUakRSaEYBJSCY2dEstQY7AuxahwXFrvZmWl2rh4JZ07z9dLtesfNj5q0FU3A5ObbwAAAABJRU5ErkJggg==) repeat-x bottom;
    height: 98px;
    width: 100%;
    position: absolute;
    bottom: 0;
    transition: all 0.3s ease;
}

.dplayer-controller {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 41px;
    padding: 0 20px;
    user-select: none;
    transition: all 0.3s ease;
    &.dplayer-controller-comment {
        .dplayer-icons {
            display: none;
        }
        .dplayer-icons.dplayer-comment-box {
            display: block;
        }
    }
    .dplayer-bar-wrap {
        padding: 5px 0;
        cursor: pointer;
        position: absolute;
        bottom: 33px;
        width: calc(100% - 40px);
        height: 3px;
        &:hover {
            .dplayer-bar .dplayer-played .dplayer-thumb {
                transform: scale(1);
            }
            .dplayer-highlight {
                display: block;
                width: 8px;
                transform: translateX(-4px);
                top: 4px;
                height: 40%;
            }
        }
        .dplayer-highlight {
            z-index: 12;
            position: absolute;
            top: 5px;
            width: 6px;
            height: 20%;
            border-radius: 6px;
            background-color: #fff;
            text-align: center;
            transform: translateX(-3px);
            transition: all .2s ease-in-out;
            &:hover {
                .dplayer-highlight-text {
                    display: block;
                }
                &~.dplayer-bar-preview {
                    opacity: 0;
                }
                &~.dplayer-bar-time {
                    opacity: 0;
                }
            }
            .dplayer-highlight-text {
                display: none;
                position: absolute;
                left: 50%;
                top: -24px;
                padding: 5px 8px;
                background-color: rgba(0, 0, 0, .62);
                color: #fff;
                border-radius: 4px;
                font-size: 12px;
                white-space: nowrap;
                transform: translateX(-50%);
            }
        }
        .dplayer-bar-preview {
            position: absolute;
            background: #fff;
            pointer-events: none;
            display: none;
            background-size: 16000px 100%;
        }
        .dplayer-bar-preview-canvas {
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }
        .dplayer-bar-time {
            &.hidden {
                opacity: 0;
            }
            position: absolute;
            left: 0px;
            top: -20px;
            border-radius: 4px;
            padding: 5px 7px;
            background-color: rgba(0, 0, 0, 0.62);
            color: #fff;
            font-size: 12px;
            text-align: center;
            opacity: 1;
            transition: opacity .1s ease-in-out;
            word-wrap: normal;
            word-break: normal;
            z-index: 2;
            pointer-events: none;
        }
        .dplayer-bar {
            position: relative;
            height: 3px;
            width: 100%;
            background: rgba(255, 255, 255, .2);
            cursor: pointer;
            .dplayer-loaded {
                position: absolute;
                left: 0;
                top: 0;
                bottom: 0;
                background: rgba(255, 255, 255, .4);
                height: 3px;
                transition: all 0.5s ease;
                will-change: width;
            }
            .dplayer-played {
                position: absolute;
                left: 0;
                top: 0;
                bottom: 0;
                height: 3px;
                will-change: width;
                .dplayer-thumb {
                    position: absolute;
                    top: 0;
                    right: 5px;
                    margin-top: -4px;
                    margin-right: -10px;
                    height: 11px;
                    width: 11px;
                    border-radius: 50%;
                    cursor: pointer;
                    transition: all .3s ease-in-out;
                    transform: scale(0);
                }
            }
        }
    }
    .dplayer-icons {
        height: 38px;
        position: absolute;
        bottom: 0;
        &.dplayer-comment-box {
            display: none;
            position: absolute;
            transition: all .3s ease-in-out;
            z-index: 2;
            height: 38px;
            bottom: 0;
            left: 20px;
            right: 20px;
            color: #fff;
            .dplayer-icon {
                padding: 7px;
            }
            .dplayer-comment-setting-icon {
                position: absolute;
                left: 0;
                top: 0;
            }
            .dplayer-send-icon {
                position: absolute;
                right: 0;
                top: 0;
            }
            .dplayer-comment-setting-box {
                position: absolute;
                background: rgba(28, 28, 28, 0.9);
                bottom: 41px;
                left: 0;
                box-shadow: 0 0 25px rgba(0, 0, 0, .3);
                border-radius: 4px;
                padding: 10px 10px 16px;
                font-size: 14px;
                width: 204px;
                transition: all .3s ease-in-out;
                transform: scale(0);
                &.dplayer-comment-setting-open {
                    transform: scale(1);
                }
                input[type=radio] {
                    display: none;
                }
                label {
                    cursor: pointer;
                }
                .dplayer-comment-setting-title {
                    font-size: 13px;
                    color: #fff;
                    line-height: 30px;
                }
                .dplayer-comment-setting-type {
                    font-size: 0;
                    .dplayer-comment-setting-title {
                        margin-bottom: 6px;
                    }
                    label {
                        &:nth-child(2) {
                            span {
                                border-radius: 4px 0 0 4px;
                            }
                        }
                        &:nth-child(4) {
                            span {
                                border-radius: 0 4px 4px 0;
                            }
                        }
                    }
                    span {
                        width: 33%;
                        padding: 4px 6px;
                        line-height: 16px;
                        display: inline-block;
                        font-size: 12px;
                        color: #fff;
                        border: 1px solid #fff;
                        margin-right: -1px;
                        box-sizing: border-box;
                        text-align: center;
                        cursor: pointer;
                    }
                    input:checked+span {
                        background: #E4E4E6;
                        color: #1c1c1c;
                    }
                }
                .dplayer-comment-setting-color {
                    font-size: 0;
                    label {
                        font-size: 0;
                        padding: 6px;
                        display: inline-block;
                    }
                    span {
                        width: 22px;
                        height: 22px;
                        display: inline-block;
                        border-radius: 50%;
                        box-sizing: border-box;
                        cursor: pointer;
                        &:hover {
                            animation: my-face 5s infinite ease-in-out;
                        }
                    }
                }
            }
            .dplayer-comment-input {
                outline: none;
                border: none;
                padding: 8px 31px;
                font-size: 14px;
                line-height: 18px;
                text-align: center;
                border-radius: 4px;
                background: none;
                margin: 0;
                height: 100%;
                box-sizing: border-box;
                width: 100%;
                color: #fff;
                &::placeholder {
                    color: #fff;
                    opacity: 0.8;
                }
                &::-ms-clear {
                    display: none;
                }
            }
        }
        &.dplayer-icons-left {
            .dplayer-icon {
                padding: 7px;
            }
        }
        &.dplayer-icons-right {
            right: 20px;
            .dplayer-icon {
                padding: 8px;
            }
        }
        .dplayer-time,
        .dplayer-live-badge {
            line-height: 38px;
            color: #eee;
            text-shadow: 0 0 2px rgba(0, 0, 0, .5);
            vertical-align: middle;
            font-size: 13px;
            cursor: default;
        }
        .dplayer-live-dot {
            display: inline-block;
            width: 6px;
            height: 6px;
            vertical-align: 4%;
            margin-right: 5px;
            content: '';
            border-radius: 6px;
        }
        .dplayer-icon {
            width: 40px;
            height: 100%;
            border: none;
            background-color: transparent;
            outline: none;
            cursor: pointer;
            vertical-align: middle;
            box-sizing: border-box;
            display: inline-block;
            .dplayer-icon-content {
                transition: all .2s ease-in-out;
                opacity: .8;
            }
            &:hover {
                .dplayer-icon-content {
                    opacity: 1;
                }
            }
            &.dplayer-quality-icon {
                color: #fff;
                width: auto;
                line-height: 22px;
                font-size: 14px;
            }
            &.dplayer-comment-icon {
                padding: 10px 9px 9px;
            }
            &.dplayer-setting-icon {
                padding-top: 8.5px;
            }
            &.dplayer-volume-icon {
                width: 43px;
            }
        }
        .dplayer-volume {
            position: relative;
            display: inline-block;
            cursor: pointer;
            height: 100%;
            &:hover {
                .dplayer-volume-bar-wrap .dplayer-volume-bar {
                    width: 45px;
                }
                .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
                    transform: scale(1);
                }
            }
            &.dplayer-volume-active {
                .dplayer-volume-bar-wrap .dplayer-volume-bar {
                    width: 45px;
                }
                .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
                    transform: scale(1);
                }
            }
            .dplayer-volume-bar-wrap {
                display: inline-block;
                margin: 0 10px 0 -5px;
                vertical-align: middle;
                height: 100%;
                .dplayer-volume-bar {
                    position: relative;
                    top: 17px;
                    width: 0;
                    height: 3px;
                    background: #aaa;
                    transition: all 0.3s ease-in-out;
                    .dplayer-volume-bar-inner {
                        position: absolute;
                        bottom: 0;
                        left: 0;
                        height: 100%;
                        transition: all 0.1s ease;
                        will-change: width;
                        .dplayer-thumb {
                            position: absolute;
                            top: 0;
                            right: 5px;
                            margin-top: -4px;
                            margin-right: -10px;
                            height: 11px;
                            width: 11px;
                            border-radius: 50%;
                            cursor: pointer;
                            transition: all .3s ease-in-out;
                            transform: scale(0);
                        }
                    }
                }
            }
        }
        .dplayer-subtitle-btn {
            display: inline-block;
            height: 100%;
        }
        .dplayer-subtitles {
            display: inline-block;
            height: 100%;
            .dplayer-subtitles-box {
                position: absolute;
                right: 0;
                bottom: 50px;
                transform: scale(0);
                width: fit-content;
                max-width: 240px;
                min-width: 120px;
                border-radius: 2px;
                background: rgba(28, 28, 28, 0.9);
                padding: 7px 0;
                transition: all .3s ease-in-out;
                overflow: auto;
                z-index: 2;
                &.dplayer-subtitles-panel {
                    display: block;
                }
                &.dplayer-subtitles-box-open {
                    transform: scale(1);
                }
            }
            .dplayer-subtitles-item {
                height: 30px;
                padding: 5px 10px;
                box-sizing: border-box;
                cursor: pointer;
                position: relative;
                &:hover {
                    background-color: rgba(255, 255, 255, .1);
                }
            }
        }
        .dplayer-setting {
            display: inline-block;
            height: 100%;
            .dplayer-setting-box {
                position: absolute;
                right: 0;
                bottom: 50px;
                transform: scale(0);
                width: 150px;
                border-radius: 2px;
                background: rgba(28, 28, 28, 0.9);
                padding: 7px 0;
                transition: all .3s ease-in-out;
                overflow: hidden;
                z-index: 2;
                &>div {
                    display: none;
                    &.dplayer-setting-origin-panel {
                        display: block;
                    }
                }
                &.dplayer-setting-box-open {
                    transform: scale(1);
                }
                &.dplayer-setting-box-narrow {
                    width: 70px;
                    text-align: center;
                }
                &.dplayer-setting-box-speed {
                    .dplayer-setting-origin-panel {
                        display: none;
                    }
                    .dplayer-setting-speed-panel {
                        display: block;
                    }
                }
            }
            .dplayer-setting-item,
            .dplayer-setting-speed-item {
                height: 30px;
                padding: 5px 10px;
                box-sizing: border-box;
                cursor: pointer;
                position: relative;
                &:hover {
                    background-color: rgba(255, 255, 255, .1);
                }
            }
            .dplayer-setting-danmaku {
                padding: 5px 0;
                .dplayer-label {
                    padding: 0 10px;
                    display: inline;
                }
                &:hover {
                    .dplayer-label {
                        display: none;
                    }
                    .dplayer-danmaku-bar-wrap {
                        display: inline-block;
                    }
                }
                &.dplayer-setting-danmaku-active {
                    .dplayer-label {
                        display: none;
                    }
                    .dplayer-danmaku-bar-wrap {
                        display: inline-block;
                    }
                }
                .dplayer-danmaku-bar-wrap {
                    padding: 0 10px;
                    box-sizing: border-box;
                    display: none;
                    vertical-align: middle;
                    height: 100%;
                    width: 100%;
                    .dplayer-danmaku-bar {
                        position: relative;
                        top: 8.5px;
                        width: 100%;
                        height: 3px;
                        background: #fff;
                        transition: all 0.3s ease-in-out;
                        .dplayer-danmaku-bar-inner {
                            position: absolute;
                            bottom: 0;
                            left: 0;
                            height: 100%;
                            transition: all 0.1s ease;
                            background: #aaa;
                            will-change: width;
                            .dplayer-thumb {
                                position: absolute;
                                top: 0;
                                right: 5px;
                                margin-top: -4px;
                                margin-right: -10px;
                                height: 11px;
                                width: 11px;
                                border-radius: 50%;
                                cursor: pointer;
                                transition: all .3s ease-in-out;
                                background: #aaa;
                            }
                        }
                    }
                }
            }
        }
        .dplayer-full {
            display: inline-block;
            height: 100%;
            position: relative;
            &:hover {
                .dplayer-full-in-icon {
                    display: block;
                }
            }
            .dplayer-full-in-icon {
                position: absolute;
                top: -30px;
                z-index: 1;
                display: none;
            }
        }
        .dplayer-quality {
            position: relative;
            display: inline-block;
            height: 100%;
            z-index: 2;
            &:hover {
                .dplayer-quality-list {
                    display: block;
                }
                .dplayer-quality-mask {
                    display: block;
                }
            }
            .dplayer-quality-mask {
                display: none;
                position: absolute;
                bottom: 38px;
                left: -18px;
                width: 80px;
                padding-bottom: 12px;
            }
            .dplayer-quality-list {
                display: none;
                font-size: 12px;
                width: 80px;
                border-radius: 2px;
                background: rgba(28, 28, 28, 0.9);
                padding: 5px 0;
                transition: all .3s ease-in-out;
                overflow: hidden;
                color: #fff;
                text-align: center;
            }
            .dplayer-quality-item {
                height: 25px;
                box-sizing: border-box;
                cursor: pointer;
                line-height: 25px;
                &:hover {
                    background-color: rgba(255, 255, 255, .1);
                }
            }
        }
        .dplayer-comment {
            display: inline-block;
            height: 100%;
        }
        .dplayer-label {
            color: #eee;
            font-size: 13px;
            display: inline-block;
            vertical-align: middle;
            white-space: nowrap;
        }
        .dplayer-toggle {
            width: 32px;
            height: 20px;
            text-align: center;
            font-size: 0;
            vertical-align: middle;
            position: absolute;
            top: 5px;
            right: 10px;
            input {
                max-height: 0;
                max-width: 0;
                display: none;
            }
            input+label {
                display: inline-block;
                position: relative;
                box-shadow: rgb(223, 223, 223) 0 0 0 0 inset;
                border: 1px solid rgb(223, 223, 223);
                height: 20px;
                width: 32px;
                border-radius: 10px;
                box-sizing: border-box;
                cursor: pointer;
                transition: .2s ease-in-out;
            }
            input+label:before {
                content: "";
                position: absolute;
                display: block;
                height: 18px;
                width: 18px;
                top: 0;
                left: 0;
                border-radius: 15px;
                transition: .2s ease-in-out;
            }
            input+label:after {
                content: "";
                position: absolute;
                display: block;
                left: 0;
                top: 0;
                border-radius: 15px;
                background: #fff;
                transition: .2s ease-in-out;
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
                height: 18px;
                width: 18px;
            }
            input:checked+label {
                border-color: rgba(255, 255, 255, 0.5);
            }
            input:checked+label:before {
                width: 30px;
                background: rgba(255, 255, 255, 0.5);
            }
            input:checked+label:after {
                left: 12px;
            }
        }
    }
}

.dplayer-mobile-play {
    display: none;
    width: 50px;
    height: 50px;
    border: none;
    background-color: transparent;
    outline: none;
    cursor: pointer;
    box-sizing: border-box;
    position: absolute;
    bottom: 0;
    opacity: 0.8;
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
}`,`.dplayer-danmaku {
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    font-size: 22px;
    color: #fff;
    .dplayer-danmaku-item {
        display: inline-block;
        pointer-events: none;
        user-select: none;
        cursor: default;
        white-space: nowrap;
        text-shadow: .5px .5px .5px rgba(0, 0, 0, .5);
        &--demo {
            position: absolute;
            visibility: hidden;
        }
    }
    .dplayer-danmaku-right {
        position: absolute;
        right: 0;
        transform: translateX(100%);
        &.dplayer-danmaku-move {
            will-change: transform;
            animation-name: 'danmaku';
            animation-timing-function: linear;
            animation-play-state: paused;
        }
    }
    @keyframes danmaku {
        from {
            transform: translateX(100%);
        }
    }
    .dplayer-danmaku-top,
    .dplayer-danmaku-bottom {
        position: absolute;
        width: 100%;
        text-align: center;
        visibility: hidden;
        &.dplayer-danmaku-move {
            will-change: visibility;
            animation-name: 'danmaku-center';
            animation-timing-function: linear;
            animation-play-state: paused;
        }
    }
    @keyframes danmaku-center {
        from {
            visibility: visible;
        }
        to {
            visibility: visible;
        }
    }
}`,`.dplayer-logo {
    pointer-events: none;
    position: absolute;
    left: 20px;
    top: 20px;
    max-width: 50px;
    max-height: 50px;
    img {
        max-width: 100%;
        max-height: 100%;
        background: none;
    }
}`,`.dplayer-menu {
    position: absolute;
    width: 170px;
    border-radius: 2px;
    background: rgba(28, 28, 28, 0.85);
    padding: 5px 0;
    overflow: hidden;
    z-index: 3;
    display: none;
    &.dplayer-menu-show {
        display: block;
    }
    .dplayer-menu-item {
        height: 30px;
        box-sizing: border-box;
        cursor: pointer;
        &:hover {
            background-color: rgba(255, 255, 255, .1);
        }
        a {
            display: inline-block;
            padding: 0 10px;
            line-height: 30px;
            color: #eee;
            font-size: 13px;
            display: inline-block;
            vertical-align: middle;
            width: 100%;
            box-sizing: border-box;
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
            &:hover {
                text-decoration: none;
            }
        }
    }
}`,`.dplayer-subtitle {
    position: absolute;
    bottom: 40px;
    width: 90%;
    left: 5%;
    text-align: center;
    color: #fff;
    text-shadow: 0.5px 0.5px 0.5px rgba(0, 0, 0, 0.5);
    font-size: 20px;
    &.dplayer-subtitle-hide {
        display: none;
    }
}`,`.dplayer-mask {
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 1;
    display: none;
    &.dplayer-mask-show {
        display: block;
    }
}

.dplayer-video-wrap {
    position: relative;
    background: #000;
    font-size: 0;
    width: 100%;
    height: 100%;
    .dplayer-video {
        width: 100%;
        height: 100%;
        display: none;
    }
    .dplayer-video-current {
        display: block;
    }
    .dplayer-video-prepare {
        display: none;
    }
}`,`.dplayer-info-panel {
    position: absolute;
    top: 10px;
    left: 10px;
    width: 400px;
    background: rgba(28, 28, 28, 0.8);
    padding: 10px;
    color: #fff;
    font-size: 12px;
    border-radius: 2px;

    &-hide {
        display: none;
    }

    .dplayer-info-panel-close {
        cursor: pointer;
        position: absolute;
        right: 10px;
        top: 10px;
    }

    .dplayer-info-panel-item {
        & > span {
            display: inline-block;
            vertical-align: middle;
            line-height: 15px;
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
        }
    }

    .dplayer-info-panel-item-title {
        width: 100px;
        text-align: right;
        margin-right: 10px;
    }
    
    .dplayer-info-panel-item-data {
        width: 260px;
    }
}`],sourceRoot:""}]);const B=$},856:fe=>{"use strict";var ce=[];function le(V){for(var A=-1,I=0;I<ce.length;I++)if(ce[I].identifier===V){A=I;break}return A}function Z(V,A){for(var I={},U=[],w=0;w<V.length;w++){var F=V[w],$=A.base?F[0]+A.base:F[0],C=I[$]||0,B="".concat($," ").concat(C);I[$]=C+1;var O=le(B),P={css:F[1],media:F[2],sourceMap:F[3],supports:F[4],layer:F[5]};if(O!==-1)ce[O].references++,ce[O].updater(P);else{var S=oe(P,A);A.byIndex=w,ce.splice(w,0,{identifier:B,updater:S,references:1})}U.push(B)}return U}function oe(V,A){var I=A.domAPI(A);return I.update(V),function(U){if(U){if(U.css===V.css&&U.media===V.media&&U.sourceMap===V.sourceMap&&U.supports===V.supports&&U.layer===V.layer)return;I.update(V=U)}else I.remove()}}fe.exports=function(V,A){var I=Z(V=V||[],A=A||{});return function(U){U=U||[];for(var w=0;w<I.length;w++){var F=le(I[w]);ce[F].references--}for(var $=Z(U,A),C=0;C<I.length;C++){var B=le(I[C]);ce[B].references===0&&(ce[B].updater(),ce.splice(B,1))}I=$}}},370:fe=>{"use strict";var ce={};fe.exports=function(le,Z){var oe=function(V){if(ce[V]===void 0){var A=document.querySelector(V);if(window.HTMLIFrameElement&&A instanceof window.HTMLIFrameElement)try{A=A.contentDocument.head}catch(I){A=null}ce[V]=A}return ce[V]}(le);if(!oe)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");oe.appendChild(Z)}},278:fe=>{"use strict";fe.exports=function(ce){var le=document.createElement("style");return ce.setAttributes(le,ce.attributes),ce.insert(le,ce.options),le}},458:(fe,ce,le)=>{"use strict";fe.exports=function(Z){var oe=le.nc;oe&&Z.setAttribute("nonce",oe)}},470:fe=>{"use strict";fe.exports=function(ce){var le=ce.insertStyleElement(ce);return{update:function(Z){(function(oe,V,A){var I="";A.supports&&(I+="@supports (".concat(A.supports,") {")),A.media&&(I+="@media ".concat(A.media," {"));var U=A.layer!==void 0;U&&(I+="@layer".concat(A.layer.length>0?" ".concat(A.layer):""," {")),I+=A.css,U&&(I+="}"),A.media&&(I+="}"),A.supports&&(I+="}");var w=A.sourceMap;w&&typeof btoa!="undefined"&&(I+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(w))))," */")),V.styleTagTransform(I,oe,V.options)})(le,ce,Z)},remove:function(){(function(Z){if(Z.parentNode===null)return!1;Z.parentNode.removeChild(Z)})(le)}}}},488:fe=>{"use strict";fe.exports=function(ce,le){if(le.styleSheet)le.styleSheet.cssText=ce;else{for(;le.firstChild;)le.removeChild(le.firstChild);le.appendChild(document.createTextNode(ce))}}},251:fe=>{fe.exports='<svg viewBox="0 0 288 288" xmlns="http://www.w3.org/2000/svg"><path d="M288 90v96c0 20-16 36-36 36h-10c-16 0-16-24 0-24h10c7 0 12-5 12-12V90c0-7-5-12-12-12H36c-7 0-12 5-12 12v96c0 7 5 12 12 12h10c16 0 16 24 0 24H36c-20 0-36-16-36-36V90c0-20 16-36 36-36h216c20 0 36 16 36 36zm-120 62l48 68c14 20 1 38-20 38H92c-21 0-34-18-20-38l48-68c13-18 35-18 48 0z"></path></svg>'},113:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M16 23c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6zM16 13c-2.206 0-4 1.794-4 4s1.794 4 4 4c2.206 0 4-1.794 4-4s-1.794-4-4-4zM27 28h-22c-1.654 0-3-1.346-3-3v-16c0-1.654 1.346-3 3-3h3c0.552 0 1 0.448 1 1s-0.448 1-1 1h-3c-0.551 0-1 0.449-1 1v16c0 0.552 0.449 1 1 1h22c0.552 0 1-0.448 1-1v-16c0-0.551-0.448-1-1-1h-11c-0.552 0-1-0.448-1-1s0.448-1 1-1h11c1.654 0 3 1.346 3 3v16c0 1.654-1.346 3-3 3zM24 10.5c0 0.828 0.672 1.5 1.5 1.5s1.5-0.672 1.5-1.5c0-0.828-0.672-1.5-1.5-1.5s-1.5 0.672-1.5 1.5zM15 4c0 0.552-0.448 1-1 1h-4c-0.552 0-1-0.448-1-1v0c0-0.552 0.448-1 1-1h4c0.552 0 1 0.448 1 1v0z"></path></svg>'},193:fe=>{fe.exports='<svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="chromecast" class="svg-inline--fa fa-chromecast fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M447.8,64H64c-23.6,0-42.7,19.1-42.7,42.7v63.9H64v-63.9h383.8v298.6H298.6V448H448c23.6,0,42.7-19.1,42.7-42.7V106.7 C490.7,83.1,471.4,64,447.8,64z M21.3,383.6L21.3,383.6l0,63.9h63.9C85.2,412.2,56.6,383.6,21.3,383.6L21.3,383.6z M21.3,298.6V341 c58.9,0,106.6,48.1,106.6,107h42.7C170.7,365.6,103.7,298.7,21.3,298.6z M213.4,448h42.7c-0.5-129.5-105.3-234.3-234.8-234.6l0,42.4 C127.3,255.6,213.3,342,213.4,448z"></path></svg>'},338:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M27.090 0.131h-22.731c-2.354 0-4.262 1.839-4.262 4.109v16.401c0 2.269 1.908 4.109 4.262 4.109h4.262v-2.706h8.469l-8.853 8.135 1.579 1.451 7.487-6.88h9.787c2.353 0 4.262-1.84 4.262-4.109v-16.401c0-2.27-1.909-4.109-4.262-4.109v0zM28.511 19.304c0 1.512-1.272 2.738-2.841 2.738h-8.425l-0.076-0.070-0.076 0.070h-11.311c-1.569 0-2.841-1.226-2.841-2.738v-13.696c0-1.513 1.272-2.739 2.841-2.739h19.889c1.569 0 2.841-0.142 2.841 1.37v15.064z"></path></svg>'},807:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M27.128 0.38h-22.553c-2.336 0-4.229 1.825-4.229 4.076v16.273c0 2.251 1.893 4.076 4.229 4.076h4.229v-2.685h8.403l-8.784 8.072 1.566 1.44 7.429-6.827h9.71c2.335 0 4.229-1.825 4.229-4.076v-16.273c0-2.252-1.894-4.076-4.229-4.076zM28.538 19.403c0 1.5-1.262 2.717-2.819 2.717h-8.36l-0.076-0.070-0.076 0.070h-11.223c-1.557 0-2.819-1.217-2.819-2.717v-13.589c0-1.501 1.262-2.718 2.819-2.718h19.734c1.557 0 2.819-0.141 2.819 1.359v14.947zM9.206 10.557c-1.222 0-2.215 0.911-2.215 2.036s0.992 2.035 2.215 2.035c1.224 0 2.216-0.911 2.216-2.035s-0.992-2.036-2.216-2.036zM22.496 10.557c-1.224 0-2.215 0.911-2.215 2.036s0.991 2.035 2.215 2.035c1.224 0 2.215-0.911 2.215-2.035s-0.991-2.036-2.215-2.036zM15.852 10.557c-1.224 0-2.215 0.911-2.215 2.036s0.991 2.035 2.215 2.035c1.222 0 2.215-0.911 2.215-2.035s-0.992-2.036-2.215-2.036z"></path></svg>'},300:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 33"><path d="M24.965 24.38h-18.132c-1.366 0-2.478-1.113-2.478-2.478v-11.806c0-1.364 1.111-2.478 2.478-2.478h18.132c1.366 0 2.478 1.113 2.478 2.478v11.806c0 1.364-1.11 2.478-2.478 2.478zM6.833 10.097v11.806h18.134l-0.002-11.806h-18.132zM2.478 28.928h5.952c0.684 0 1.238-0.554 1.238-1.239 0-0.684-0.554-1.238-1.238-1.238h-5.952v-5.802c0-0.684-0.554-1.239-1.238-1.239s-1.239 0.556-1.239 1.239v5.802c0 1.365 1.111 2.478 2.478 2.478zM30.761 19.412c-0.684 0-1.238 0.554-1.238 1.238v5.801h-5.951c-0.686 0-1.239 0.554-1.239 1.238 0 0.686 0.554 1.239 1.239 1.239h5.951c1.366 0 2.478-1.111 2.478-2.478v-5.801c0-0.683-0.554-1.238-1.239-1.238zM0 5.55v5.802c0 0.683 0.554 1.238 1.238 1.238s1.238-0.555 1.238-1.238v-5.802h5.952c0.684 0 1.238-0.554 1.238-1.238s-0.554-1.238-1.238-1.238h-5.951c-1.366-0.001-2.478 1.111-2.478 2.476zM32 11.35v-5.801c0-1.365-1.11-2.478-2.478-2.478h-5.951c-0.686 0-1.239 0.554-1.239 1.238s0.554 1.238 1.239 1.238h5.951v5.801c0 0.683 0.554 1.237 1.238 1.237 0.686 0.002 1.239-0.553 1.239-1.236z"></path></svg>'},574:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 33"><path d="M6.667 28h-5.333c-0.8 0-1.333-0.533-1.333-1.333v-5.333c0-0.8 0.533-1.333 1.333-1.333s1.333 0.533 1.333 1.333v4h4c0.8 0 1.333 0.533 1.333 1.333s-0.533 1.333-1.333 1.333zM30.667 28h-5.333c-0.8 0-1.333-0.533-1.333-1.333s0.533-1.333 1.333-1.333h4v-4c0-0.8 0.533-1.333 1.333-1.333s1.333 0.533 1.333 1.333v5.333c0 0.8-0.533 1.333-1.333 1.333zM30.667 12c-0.8 0-1.333-0.533-1.333-1.333v-4h-4c-0.8 0-1.333-0.533-1.333-1.333s0.533-1.333 1.333-1.333h5.333c0.8 0 1.333 0.533 1.333 1.333v5.333c0 0.8-0.533 1.333-1.333 1.333zM1.333 12c-0.8 0-1.333-0.533-1.333-1.333v-5.333c0-0.8 0.533-1.333 1.333-1.333h5.333c0.8 0 1.333 0.533 1.333 1.333s-0.533 1.333-1.333 1.333h-4v4c0 0.8-0.533 1.333-1.333 1.333z"></path></svg>'},182:fe=>{fe.exports='<svg version="1.1" viewBox="0 0 22 22"><svg x="7" y="1"><circle class="diplayer-loading-dot diplayer-loading-dot-0" cx="4" cy="4" r="2"></circle></svg><svg x="11" y="3"><circle class="diplayer-loading-dot diplayer-loading-dot-1" cx="4" cy="4" r="2"></circle></svg><svg x="13" y="7"><circle class="diplayer-loading-dot diplayer-loading-dot-2" cx="4" cy="4" r="2"></circle></svg><svg x="11" y="11"><circle class="diplayer-loading-dot diplayer-loading-dot-3" cx="4" cy="4" r="2"></circle></svg><svg x="7" y="13"><circle class="diplayer-loading-dot diplayer-loading-dot-4" cx="4" cy="4" r="2"></circle></svg><svg x="3" y="11"><circle class="diplayer-loading-dot diplayer-loading-dot-5" cx="4" cy="4" r="2"></circle></svg><svg x="1" y="7"><circle class="diplayer-loading-dot diplayer-loading-dot-6" cx="4" cy="4" r="2"></circle></svg><svg x="3" y="3"><circle class="diplayer-loading-dot diplayer-loading-dot-7" cx="4" cy="4" r="2"></circle></svg></svg>'},965:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M19.357 2.88c1.749 0 3.366 0.316 4.851 0.946 1.485 0.632 2.768 1.474 3.845 2.533s1.922 2.279 2.532 3.661c0.611 1.383 0.915 2.829 0.915 4.334 0 1.425-0.304 2.847-0.915 4.271-0.611 1.425-1.587 2.767-2.928 4.028-0.855 0.813-1.811 1.607-2.869 2.38s-2.136 1.465-3.233 2.075c-1.099 0.61-2.198 1.098-3.296 1.465-1.098 0.366-2.115 0.549-3.051 0.549-1.343 0-2.441-0.438-3.296-1.311-0.854-0.876-1.281-2.41-1.281-4.608 0-0.366 0.020-0.773 0.060-1.221s0.062-0.895 0.062-1.343c0-0.773-0.183-1.353-0.55-1.738-0.366-0.387-0.793-0.58-1.281-0.58-0.652 0-1.21 0.295-1.678 0.886s-0.926 1.23-1.373 1.921c-0.447 0.693-0.905 1.334-1.372 1.923s-1.028 0.886-1.679 0.886c-0.529 0-1.048-0.427-1.556-1.282s-0.763-2.259-0.763-4.212c0-2.197 0.529-4.241 1.587-6.133s2.462-3.529 4.21-4.912c1.75-1.383 3.762-2.471 6.041-3.264 2.277-0.796 4.617-1.212 7.018-1.253zM7.334 15.817c0.569 0 1.047-0.204 1.434-0.611s0.579-0.875 0.579-1.404c0-0.569-0.193-1.047-0.579-1.434s-0.864-0.579-1.434-0.579c-0.529 0-0.987 0.193-1.373 0.579s-0.58 0.864-0.58 1.434c0 0.53 0.194 0.998 0.58 1.404 0.388 0.407 0.845 0.611 1.373 0.611zM12.216 11.79c0.691 0 1.292-0.254 1.8-0.763s0.762-1.107 0.762-1.8c0-0.732-0.255-1.343-0.762-1.831-0.509-0.489-1.109-0.732-1.8-0.732-0.732 0-1.342 0.244-1.831 0.732-0.488 0.488-0.732 1.098-0.732 1.831 0 0.693 0.244 1.292 0.732 1.8s1.099 0.763 1.831 0.763zM16.366 25.947c0.692 0 1.282-0.214 1.77-0.64s0.732-0.987 0.732-1.678-0.244-1.261-0.732-1.709c-0.489-0.448-1.078-0.671-1.77-0.671-0.65 0-1.21 0.223-1.678 0.671s-0.702 1.018-0.702 1.709c0 0.692 0.234 1.25 0.702 1.678s1.027 0.64 1.678 0.64zM19.113 9.592c0.651 0 1.129-0.203 1.433-0.611 0.305-0.406 0.459-0.874 0.459-1.404 0-0.488-0.154-0.947-0.459-1.373-0.304-0.427-0.782-0.641-1.433-0.641-0.529 0-1.008 0.193-1.434 0.58s-0.64 0.865-0.64 1.434c0 0.571 0.213 1.049 0.64 1.434 0.427 0.389 0.905 0.581 1.434 0.581zM24.848 12.826c0.57 0 1.067-0.213 1.495-0.64 0.427-0.427 0.64-0.947 0.64-1.556 0-0.57-0.214-1.068-0.64-1.495-0.428-0.427-0.927-0.64-1.495-0.64-0.611 0-1.129 0.213-1.555 0.64-0.428 0.427-0.642 0.926-0.642 1.495 0 0.611 0.213 1.129 0.642 1.556s0.947 0.64 1.555 0.64z"></path></svg>'},74:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 17 32"><path d="M14.080 4.8q2.88 0 2.88 2.048v18.24q0 2.112-2.88 2.112t-2.88-2.112v-18.24q0-2.048 2.88-2.048zM2.88 4.8q2.88 0 2.88 2.048v18.24q0 2.112-2.88 2.112t-2.88-2.112v-18.24q0-2.048 2.88-2.048z"></path></svg>'},730:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 16 32"><path d="M15.552 15.168q0.448 0.32 0.448 0.832 0 0.448-0.448 0.768l-13.696 8.512q-0.768 0.512-1.312 0.192t-0.544-1.28v-16.448q0-0.96 0.544-1.28t1.312 0.192z"></path></svg>'},428:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M22 16l-10.105-10.6-1.895 1.987 8.211 8.613-8.211 8.612 1.895 1.988 8.211-8.613z"></path></svg>'},254:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M13.725 30l3.9-5.325-3.9-1.125v6.45zM0 17.5l11.050 3.35 13.6-11.55-10.55 12.425 11.8 3.65 6.1-23.375-32 15.5z"></path></svg>'},934:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 28"><path d="M28.633 17.104c0.035 0.21 0.026 0.463-0.026 0.76s-0.14 0.598-0.262 0.904c-0.122 0.306-0.271 0.581-0.445 0.825s-0.367 0.419-0.576 0.524c-0.209 0.105-0.393 0.157-0.55 0.157s-0.332-0.035-0.524-0.105c-0.175-0.052-0.393-0.1-0.655-0.144s-0.528-0.052-0.799-0.026c-0.271 0.026-0.541 0.083-0.812 0.17s-0.502 0.236-0.694 0.445c-0.419 0.437-0.664 0.934-0.734 1.493s0.009 1.092 0.236 1.598c0.175 0.349 0.148 0.699-0.079 1.048-0.105 0.14-0.271 0.284-0.498 0.432s-0.476 0.284-0.747 0.406-0.555 0.218-0.851 0.288c-0.297 0.070-0.559 0.105-0.786 0.105-0.157 0-0.306-0.061-0.445-0.183s-0.236-0.253-0.288-0.393h-0.026c-0.192-0.541-0.52-1.009-0.982-1.402s-1-0.589-1.611-0.589c-0.594 0-1.131 0.197-1.611 0.589s-0.816 0.851-1.009 1.375c-0.087 0.21-0.218 0.362-0.393 0.458s-0.367 0.144-0.576 0.144c-0.244 0-0.52-0.044-0.825-0.131s-0.611-0.197-0.917-0.327c-0.306-0.131-0.581-0.284-0.825-0.458s-0.428-0.349-0.55-0.524c-0.087-0.122-0.135-0.266-0.144-0.432s0.057-0.397 0.197-0.694c0.192-0.402 0.266-0.86 0.223-1.375s-0.266-0.991-0.668-1.428c-0.244-0.262-0.541-0.432-0.891-0.511s-0.681-0.109-0.995-0.092c-0.367 0.017-0.742 0.087-1.127 0.21-0.244 0.070-0.489 0.052-0.734-0.052-0.192-0.070-0.371-0.231-0.537-0.485s-0.314-0.533-0.445-0.838c-0.131-0.306-0.231-0.62-0.301-0.943s-0.087-0.59-0.052-0.799c0.052-0.384 0.227-0.629 0.524-0.734 0.524-0.21 0.995-0.555 1.415-1.035s0.629-1.017 0.629-1.611c0-0.611-0.21-1.144-0.629-1.598s-0.891-0.786-1.415-0.996c-0.157-0.052-0.288-0.179-0.393-0.38s-0.157-0.406-0.157-0.616c0-0.227 0.035-0.48 0.105-0.76s0.162-0.55 0.275-0.812 0.244-0.502 0.393-0.72c0.148-0.218 0.31-0.38 0.485-0.485 0.14-0.087 0.275-0.122 0.406-0.105s0.275 0.052 0.432 0.105c0.524 0.21 1.070 0.275 1.637 0.197s1.070-0.327 1.506-0.747c0.21-0.209 0.362-0.467 0.458-0.773s0.157-0.607 0.183-0.904c0.026-0.297 0.026-0.568 0-0.812s-0.048-0.419-0.065-0.524c-0.035-0.105-0.066-0.227-0.092-0.367s-0.013-0.262 0.039-0.367c0.105-0.244 0.293-0.458 0.563-0.642s0.563-0.336 0.878-0.458c0.314-0.122 0.62-0.214 0.917-0.275s0.533-0.092 0.707-0.092c0.227 0 0.406 0.074 0.537 0.223s0.223 0.301 0.275 0.458c0.192 0.471 0.507 0.886 0.943 1.244s0.952 0.537 1.546 0.537c0.611 0 1.153-0.17 1.624-0.511s0.803-0.773 0.996-1.297c0.070-0.14 0.179-0.284 0.327-0.432s0.301-0.223 0.458-0.223c0.244 0 0.511 0.035 0.799 0.105s0.572 0.166 0.851 0.288c0.279 0.122 0.537 0.279 0.773 0.472s0.423 0.402 0.563 0.629c0.087 0.14 0.113 0.293 0.079 0.458s-0.070 0.284-0.105 0.354c-0.227 0.506-0.297 1.039-0.21 1.598s0.341 1.048 0.76 1.467c0.419 0.419 0.934 0.651 1.546 0.694s1.179-0.057 1.703-0.301c0.14-0.087 0.31-0.122 0.511-0.105s0.371 0.096 0.511 0.236c0.262 0.244 0.493 0.616 0.694 1.113s0.336 1 0.406 1.506c0.035 0.297-0.013 0.528-0.144 0.694s-0.266 0.275-0.406 0.327c-0.542 0.192-1.004 0.528-1.388 1.009s-0.576 1.026-0.576 1.637c0 0.594 0.162 1.113 0.485 1.559s0.747 0.764 1.27 0.956c0.122 0.070 0.227 0.14 0.314 0.21 0.192 0.157 0.323 0.358 0.393 0.602v0zM16.451 19.462c0.786 0 1.528-0.149 2.227-0.445s1.305-0.707 1.821-1.231c0.515-0.524 0.921-1.131 1.218-1.821s0.445-1.428 0.445-2.214c0-0.786-0.148-1.524-0.445-2.214s-0.703-1.292-1.218-1.808c-0.515-0.515-1.122-0.921-1.821-1.218s-1.441-0.445-2.227-0.445c-0.786 0-1.524 0.148-2.214 0.445s-1.292 0.703-1.808 1.218c-0.515 0.515-0.921 1.118-1.218 1.808s-0.445 1.428-0.445 2.214c0 0.786 0.149 1.524 0.445 2.214s0.703 1.297 1.218 1.821c0.515 0.524 1.118 0.934 1.808 1.231s1.428 0.445 2.214 0.445v0z"></path></svg>'},410:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M26.667 5.333h-21.333c-0 0-0.001 0-0.001 0-1.472 0-2.666 1.194-2.666 2.666 0 0 0 0.001 0 0.001v-0 16c0 0 0 0.001 0 0.001 0 1.472 1.194 2.666 2.666 2.666 0 0 0.001 0 0.001 0h21.333c0 0 0.001 0 0.001 0 1.472 0 2.666-1.194 2.666-2.666 0-0 0-0.001 0-0.001v0-16c0-0 0-0.001 0-0.001 0-1.472-1.194-2.666-2.666-2.666-0 0-0.001 0-0.001 0h0zM5.333 16h5.333v2.667h-5.333v-2.667zM18.667 24h-13.333v-2.667h13.333v2.667zM26.667 24h-5.333v-2.667h5.333v2.667zM26.667 18.667h-13.333v-2.667h13.333v2.667z"></path></svg>'},644:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8zM20.576 16q0 1.344-0.768 2.528t-2.016 1.664q-0.16 0.096-0.448 0.096-0.448 0-0.8-0.32t-0.32-0.832q0-0.384 0.192-0.64t0.544-0.448 0.608-0.384 0.512-0.64 0.192-1.024-0.192-1.024-0.512-0.64-0.608-0.384-0.544-0.448-0.192-0.64q0-0.48 0.32-0.832t0.8-0.32q0.288 0 0.448 0.096 1.248 0.48 2.016 1.664t0.768 2.528z"></path></svg>'},324:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8z"></path></svg>'},437:fe=>{fe.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8zM20.576 16q0 1.344-0.768 2.528t-2.016 1.664q-0.16 0.096-0.448 0.096-0.448 0-0.8-0.32t-0.32-0.832q0-0.384 0.192-0.64t0.544-0.448 0.608-0.384 0.512-0.64 0.192-1.024-0.192-1.024-0.512-0.64-0.608-0.384-0.544-0.448-0.192-0.64q0-0.48 0.32-0.832t0.8-0.32q0.288 0 0.448 0.096 1.248 0.48 2.016 1.664t0.768 2.528zM25.152 16q0 2.72-1.536 5.056t-4 3.36q-0.256 0.096-0.448 0.096-0.48 0-0.832-0.352t-0.32-0.8q0-0.704 0.672-1.056 1.024-0.512 1.376-0.8 1.312-0.96 2.048-2.4t0.736-3.104-0.736-3.104-2.048-2.4q-0.352-0.288-1.376-0.8-0.672-0.352-0.672-1.056 0-0.448 0.32-0.8t0.8-0.352q0.224 0 0.48 0.096 2.496 1.056 4 3.36t1.536 5.056z"></path></svg>'},897:(fe,ce,le)=>{"use strict";var Z=typeof self!="undefined"?self:typeof window!="undefined"?window:le.g!==void 0?le.g:{},oe=Object.create(Z),V=/["&'<>]/;function A(I){return typeof I!="string"&&(I=I==null?"":typeof I=="function"?A(I.call(I)):JSON.stringify(I)),I}oe.$escape=function(I){return function(U){var w=""+U,F=V.exec(w);if(!F)return U;var $="",C=void 0,B=void 0,O=void 0;for(C=F.index,B=0;C<w.length;C++){switch(w.charCodeAt(C)){case 34:O="&#34;";break;case 38:O="&#38;";break;case 39:O="&#39;";break;case 60:O="&#60;";break;case 62:O="&#62;";break;default:continue}B!==C&&($+=w.substring(B,C)),B=C+1,$+=O}return B!==C?$+w.substring(B,C):$}(A(I))},oe.$each=function(I,U){if(Array.isArray(I))for(var w=0,F=I.length;w<F;w++)U(I[w],w);else for(var $ in I)U(I[$],$)},fe.exports=oe},471:(fe,ce,le)=>{"use strict";fe.exports=le(897)},352:fe=>{"use strict";fe.exports=function(ce){var le=[];return le.toString=function(){return this.map(function(Z){var oe="",V=Z[5]!==void 0;return Z[4]&&(oe+="@supports (".concat(Z[4],") {")),Z[2]&&(oe+="@media ".concat(Z[2]," {")),V&&(oe+="@layer".concat(Z[5].length>0?" ".concat(Z[5]):""," {")),oe+=ce(Z),V&&(oe+="}"),Z[2]&&(oe+="}"),Z[4]&&(oe+="}"),oe}).join("")},le.i=function(Z,oe,V,A,I){typeof Z=="string"&&(Z=[[null,Z,void 0]]);var U={};if(V)for(var w=0;w<this.length;w++){var F=this[w][0];F!=null&&(U[F]=!0)}for(var $=0;$<Z.length;$++){var C=[].concat(Z[$]);V&&U[C[0]]||(I!==void 0&&(C[5]===void 0||(C[1]="@layer".concat(C[5].length>0?" ".concat(C[5]):""," {").concat(C[1],"}")),C[5]=I),oe&&(C[2]&&(C[1]="@media ".concat(C[2]," {").concat(C[1],"}")),C[2]=oe),A&&(C[4]?(C[1]="@supports (".concat(C[4],") {").concat(C[1],"}"),C[4]=A):C[4]="".concat(A)),le.push(C))}},le}},80:fe=>{"use strict";fe.exports=function(ce,le){return le||(le={}),ce&&(ce=String(ce.__esModule?ce.default:ce),/^['"].*['"]$/.test(ce)&&(ce=ce.slice(1,-1)),le.hash&&(ce+=le.hash),/["'() \t\n]|(%20)/.test(ce)||le.needQuotes?'"'.concat(ce.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):ce)}},415:fe=>{"use strict";fe.exports=function(ce){var le=ce[1],Z=ce[3];if(!Z)return le;if(typeof btoa=="function"){var oe=btoa(unescape(encodeURIComponent(JSON.stringify(Z)))),V="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(oe),A="/*# ".concat(V," */");return[le].concat([A]).join(`
`)}return[le].join(`
`)}},937:fe=>{function ce(le){return ce=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Z){return typeof Z}:function(Z){return Z&&typeof Symbol=="function"&&Z.constructor===Symbol&&Z!==Symbol.prototype?"symbol":typeof Z},ce(le)}fe.exports=(typeof self=="undefined"?"undefined":ce(self))=="object"?self.FormData:window.FormData},831:fe=>{"use strict";fe.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAADGCAYAAAAT+OqFAAAAdklEQVQoz42QQQ7AIAgEF/T/D+kbq/RWAlnQyyazA4aoAB4FsBSA/bFjuF1EOL7VbrIrBuusmrt4ZZORfb6ehbWdnRHEIiITaEUKa5EJqUakRSaEYBJSCY2dEstQY7AuxahwXFrvZmWl2rh4JZ07z9dLtesfNj5q0FU3A5ObbwAAAABJRU5ErkJggg=="}},q={};function Oe(fe){var ce=q[fe];if(ce!==void 0)return ce.exports;var le=q[fe]={id:fe,exports:{}};return rt[fe](le,le.exports,Oe),le.exports}Oe.m=rt,Oe.n=fe=>{var ce=fe&&fe.__esModule?()=>fe.default:()=>fe;return Oe.d(ce,{a:ce}),ce},Oe.d=(fe,ce)=>{for(var le in ce)Oe.o(ce,le)&&!Oe.o(fe,le)&&Object.defineProperty(fe,le,{enumerable:!0,get:ce[le]})},Oe.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(fe){if(typeof window=="object")return window}}(),Oe.o=(fe,ce)=>Object.prototype.hasOwnProperty.call(fe,ce),Oe.b=document.baseURI||self.location.href,Oe.nc=void 0;var Ee={};return(()=>{"use strict";Oe.d(Ee,{default:()=>Zo});var fe=Oe(856),ce=Oe.n(fe),le=Oe(470),Z=Oe.n(le),oe=Oe(370),V=Oe.n(oe),A=Oe(458),I=Oe.n(A),U=Oe(278),w=Oe.n(U),F=Oe(488),$=Oe.n(F),C=Oe(685),B={};B.styleTagTransform=$(),B.setAttributes=I(),B.insert=V().bind(null,"head"),B.domAPI=Z(),B.insertStyleElement=w(),ce()(C.Z,B),C.Z&&C.Z.locals&&C.Z.locals;function O(m){return O=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},O(m)}function P(m,b){this.name="AggregateError",this.errors=m,this.message=b||""}P.prototype=Error.prototype;function S(m){return S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},S(m)}var H=setTimeout;function X(m){return Boolean(m&&m.length!==void 0)}function ie(){}function k(m){if(!(this instanceof k))throw new TypeError("Promises must be constructed via new");if(typeof m!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],ye(m,this)}function j(m,b){for(;m._state===3;)m=m._value;m._state!==0?(m._handled=!0,k._immediateFn(function(){var M=m._state===1?b.onFulfilled:b.onRejected;if(M!==null){var p;try{p=M(m._value)}catch(T){return void ne(b.promise,T)}Y(b.promise,p)}else(m._state===1?Y:ne)(b.promise,m._value)})):m._deferreds.push(b)}function Y(m,b){try{if(b===m)throw new TypeError("A promise cannot be resolved with itself.");if(b&&(S(b)==="object"||typeof b=="function")){var M=b.then;if(b instanceof k)return m._state=3,m._value=b,void he(m);if(typeof M=="function")return void ye((p=M,T=b,function(){p.apply(T,arguments)}),m)}m._state=1,m._value=b,he(m)}catch(L){ne(m,L)}var p,T}function ne(m,b){m._state=2,m._value=b,he(m)}function he(m){m._state===2&&m._deferreds.length===0&&k._immediateFn(function(){m._handled||k._unhandledRejectionFn(m._value)});for(var b=0,M=m._deferreds.length;b<M;b++)j(m,m._deferreds[b]);m._deferreds=null}function _e(m,b,M){this.onFulfilled=typeof m=="function"?m:null,this.onRejected=typeof b=="function"?b:null,this.promise=M}function ye(m,b){var M=!1;try{m(function(p){M||(M=!0,Y(b,p))},function(p){M||(M=!0,ne(b,p))})}catch(p){if(M)return;M=!0,ne(b,p)}}k.prototype.catch=function(m){return this.then(null,m)},k.prototype.then=function(m,b){var M=new this.constructor(ie);return j(this,new _e(m,b,M)),M},k.prototype.finally=function(m){var b=this.constructor;return this.then(function(M){return b.resolve(m()).then(function(){return M})},function(M){return b.resolve(m()).then(function(){return b.reject(M)})})},k.all=function(m){return new k(function(b,M){if(!X(m))return M(new TypeError("Promise.all accepts an array"));var p=Array.prototype.slice.call(m);if(p.length===0)return b([]);var T=p.length;function L(re,se){try{if(se&&(S(se)==="object"||typeof se=="function")){var Le=se.then;if(typeof Le=="function")return void Le.call(se,function(Me){L(re,Me)},M)}p[re]=se,--T==0&&b(p)}catch(Me){M(Me)}}for(var G=0;G<p.length;G++)L(G,p[G])})},k.any=function(m){var b=this;return new b(function(M,p){if(!m||m.length===void 0)return p(new TypeError("Promise.any accepts an array"));var T=Array.prototype.slice.call(m);if(T.length===0)return p();for(var L=[],G=0;G<T.length;G++)try{b.resolve(T[G]).then(M).catch(function(re){L.push(re),L.length===T.length&&p(new P(L,"All promises were rejected"))})}catch(re){p(re)}})},k.allSettled=function(m){return new this(function(b,M){if(!m||m.length===void 0)return M(new TypeError(O(m)+" "+m+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var p=Array.prototype.slice.call(m);if(p.length===0)return b([]);var T=p.length;function L(re,se){if(se&&(O(se)==="object"||typeof se=="function")){var Le=se.then;if(typeof Le=="function")return void Le.call(se,function(Me){L(re,Me)},function(Me){p[re]={status:"rejected",reason:Me},--T==0&&b(p)})}p[re]={status:"fulfilled",value:se},--T==0&&b(p)}for(var G=0;G<p.length;G++)L(G,p[G])})},k.resolve=function(m){return m&&S(m)==="object"&&m.constructor===k?m:new k(function(b){b(m)})},k.reject=function(m){return new k(function(b,M){M(m)})},k.race=function(m){return new k(function(b,M){if(!X(m))return M(new TypeError("Promise.race accepts an array"));for(var p=0,T=m.length;p<T;p++)k.resolve(m[p]).then(b,M)})},k._immediateFn=typeof setImmediate=="function"&&function(m){setImmediate(m)}||function(m){H(m,0)},k._unhandledRejectionFn=function(m){typeof console!="undefined"&&console&&console.warn("Possible Unhandled Promise Rejection:",m)};const ve=k;var Te=/mobile/i.test(window.navigator.userAgent);const be={secondToTime:function(m){if((m=m||0)===0||m===1/0||m.toString()==="NaN")return"00:00";var b=Math.floor(m/3600),M=Math.floor((m-3600*b)/60),p=Math.floor(m-3600*b-60*M);return(b>0?[b,M,p]:[M,p]).map(function(T){return T<10?"0"+T:""+T}).join(":")},getElementViewLeft:function(m){var b=m.offsetLeft,M=m.offsetParent,p=document.body.scrollLeft+document.documentElement.scrollLeft;if(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement)for(;M!==null&&M!==m;)b+=M.offsetLeft,M=M.offsetParent;else for(;M!==null;)b+=M.offsetLeft,M=M.offsetParent;return b-p},getBoundingClientRectViewLeft:function(m){var b=window.scrollY||window.pageYOffset||document.body.scrollTop+(document.documentElement&&document.documentElement.scrollTop||0);if(m.getBoundingClientRect){if(typeof this.getBoundingClientRectViewLeft.offset!="number"){var M=document.createElement("div");M.style.cssText="position:absolute;top:0;left:0;",document.body.appendChild(M),this.getBoundingClientRectViewLeft.offset=-M.getBoundingClientRect().top-b,document.body.removeChild(M),M=null}var p=m.getBoundingClientRect(),T=this.getBoundingClientRectViewLeft.offset;return p.left+T}return this.getElementViewLeft(m)},getScrollPosition:function(){return{left:window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0,top:window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0}},setScrollPosition:function(m){var b=m.left,M=b===void 0?0:b,p=m.top,T=p===void 0?0:p;this.isFirefox?(document.documentElement.scrollLeft=M,document.documentElement.scrollTop=T):window.scrollTo(M,T)},isMobile:Te,isFirefox:/firefox/i.test(window.navigator.userAgent),isChrome:/chrome/i.test(window.navigator.userAgent),isSafari:/safari/i.test(window.navigator.userAgent),storage:{set:function(m,b){localStorage.setItem(m,b)},get:function(m){return localStorage.getItem(m)}},nameMap:{dragStart:Te?"touchstart":"mousedown",dragMove:Te?"touchmove":"mousemove",dragEnd:Te?"touchend":"mouseup"},color2Number:function(m){return m[0]==="#"&&(m=m.substr(1)),m.length===3&&(m="".concat(m[0]).concat(m[0]).concat(m[1]).concat(m[1]).concat(m[2]).concat(m[2])),parseInt(m,16)+0&16777215},number2Color:function(m){return"#"+("00000"+m.toString(16)).slice(-6)},number2Type:function(m){switch(m){case 0:default:return"right";case 1:return"top";case 2:return"bottom"}}};function De(m,b){return function(){return m.apply(b,arguments)}}function xe(m){return xe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},xe(m)}var qe,vt=Object.prototype.toString,st=Object.getPrototypeOf,Xe=(qe=Object.create(null),function(m){var b=vt.call(m);return qe[b]||(qe[b]=b.slice(8,-1).toLowerCase())}),Ye=function(m){return m=m.toLowerCase(),function(b){return Xe(b)===m}},Ft=function(m){return function(b){return xe(b)===m}},lt=Array.isArray,_t=Ft("undefined"),Mt=Ye("ArrayBuffer"),It=Ft("string"),Jt=Ft("function"),Zt=Ft("number"),at=function(m){return m!==null&&xe(m)==="object"},Nt=function(m){if(Xe(m)!=="object")return!1;var b=st(m);return!(b!==null&&b!==Object.prototype&&Object.getPrototypeOf(b)!==null||Symbol.toStringTag in m||Symbol.iterator in m)},$t=Ye("Date"),Ci=Ye("File"),Gi=Ye("Blob"),Pi=Ye("FileList"),Mi=Ye("URLSearchParams");function ki(m,b){var M,p,T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},L=T.allOwnKeys,G=L!==void 0&&L;if(m!=null)if(xe(m)!=="object"&&(m=[m]),lt(m))for(M=0,p=m.length;M<p;M++)b.call(null,m[M],M,m);else{var re,se=G?Object.getOwnPropertyNames(m):Object.keys(m),Le=se.length;for(M=0;M<Le;M++)re=se[M],b.call(null,m[re],re,m)}}function Ht(m,b){b=b.toLowerCase();for(var M,p=Object.keys(m),T=p.length;T-- >0;)if(b===(M=p[T]).toLowerCase())return M;return null}var tt,ni,Ii=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:Ne.g,ei=function(m){return!_t(m)&&m!==Ii},lr=(tt=typeof Uint8Array!="undefined"&&st(Uint8Array),function(m){return tt&&m instanceof tt}),Cr=Ye("HTMLFormElement"),Ri=(ni=Object.prototype.hasOwnProperty,function(m,b){return ni.call(m,b)}),Hs=Ye("RegExp"),Ue=function(m,b){var M=Object.getOwnPropertyDescriptors(m),p={};ki(M,function(T,L){b(T,L,m)!==!1&&(p[L]=T)}),Object.defineProperties(m,p)};const Ae={isArray:lt,isArrayBuffer:Mt,isBuffer:function(m){return m!==null&&!_t(m)&&m.constructor!==null&&!_t(m.constructor)&&Jt(m.constructor.isBuffer)&&m.constructor.isBuffer(m)},isFormData:function(m){var b="[object FormData]";return m&&(typeof FormData=="function"&&m instanceof FormData||vt.call(m)===b||Jt(m.toString)&&m.toString()===b)},isArrayBufferView:function(m){return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?ArrayBuffer.isView(m):m&&m.buffer&&Mt(m.buffer)},isString:It,isNumber:Zt,isBoolean:function(m){return m===!0||m===!1},isObject:at,isPlainObject:Nt,isUndefined:_t,isDate:$t,isFile:Ci,isBlob:Gi,isRegExp:Hs,isFunction:Jt,isStream:function(m){return at(m)&&Jt(m.pipe)},isURLSearchParams:Mi,isTypedArray:lr,isFileList:Pi,forEach:ki,merge:function m(){for(var b=ei(this)&&this||{},M=b.caseless,p={},T=function(re,se){var Le=M&&Ht(p,se)||se;Nt(p[Le])&&Nt(re)?p[Le]=m(p[Le],re):Nt(re)?p[Le]=m({},re):lt(re)?p[Le]=re.slice():p[Le]=re},L=0,G=arguments.length;L<G;L++)arguments[L]&&ki(arguments[L],T);return p},extend:function(m,b,M){var p=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},T=p.allOwnKeys;return ki(b,function(L,G){M&&Jt(L)?m[G]=De(L,M):m[G]=L},{allOwnKeys:T}),m},trim:function(m){return m.trim?m.trim():m.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},stripBOM:function(m){return m.charCodeAt(0)===65279&&(m=m.slice(1)),m},inherits:function(m,b,M,p){m.prototype=Object.create(b.prototype,p),m.prototype.constructor=m,Object.defineProperty(m,"super",{value:b.prototype}),M&&Object.assign(m.prototype,M)},toFlatObject:function(m,b,M,p){var T,L,G,re={};if(b=b||{},m==null)return b;do{for(L=(T=Object.getOwnPropertyNames(m)).length;L-- >0;)G=T[L],p&&!p(G,m,b)||re[G]||(b[G]=m[G],re[G]=!0);m=M!==!1&&st(m)}while(m&&(!M||M(m,b))&&m!==Object.prototype);return b},kindOf:Xe,kindOfTest:Ye,endsWith:function(m,b,M){m=String(m),(M===void 0||M>m.length)&&(M=m.length),M-=b.length;var p=m.indexOf(b,M);return p!==-1&&p===M},toArray:function(m){if(!m)return null;if(lt(m))return m;var b=m.length;if(!Zt(b))return null;for(var M=new Array(b);b-- >0;)M[b]=m[b];return M},forEachEntry:function(m,b){for(var M,p=(m&&m[Symbol.iterator]).call(m);(M=p.next())&&!M.done;){var T=M.value;b.call(m,T[0],T[1])}},matchAll:function(m,b){for(var M,p=[];(M=m.exec(b))!==null;)p.push(M);return p},isHTMLForm:Cr,hasOwnProperty:Ri,hasOwnProp:Ri,reduceDescriptors:Ue,freezeMethods:function(m){Ue(m,function(b,M){if(Jt(m)&&["arguments","caller","callee"].indexOf(M)!==-1)return!1;var p=m[M];Jt(p)&&(b.enumerable=!1,"writable"in b?b.writable=!1:b.set||(b.set=function(){throw Error("Can not rewrite read-only method '"+M+"'")}))})},toObjectSet:function(m,b){var M={},p=function(T){T.forEach(function(L){M[L]=!0})};return lt(m)?p(m):p(String(m).split(b)),M},toCamelCase:function(m){return m.toLowerCase().replace(/[_-\s]([a-z\d])(\w*)/g,function(b,M,p){return M.toUpperCase()+p})},noop:function(){},toFiniteNumber:function(m,b){return m=+m,Number.isFinite(m)?m:b},findKey:Ht,global:Ii,isContextDefined:ei,toJSONObject:function(m){var b=new Array(10);return function M(p,T){if(at(p)){if(b.indexOf(p)>=0)return;if(!("toJSON"in p)){b[T]=p;var L=lt(p)?[]:{};return ki(p,function(G,re){var se=M(G,T+1);!_t(se)&&(L[re]=se)}),b[T]=void 0,L}}return p}(m,0)}};function Ze(m,b,M,p,T){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=m,this.name="AxiosError",b&&(this.code=b),M&&(this.config=M),p&&(this.request=p),T&&(this.response=T)}Ae.inherits(Ze,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ae.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var pt=Ze.prototype,St={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(function(m){St[m]={value:m}}),Object.defineProperties(Ze,St),Object.defineProperty(pt,"isAxiosError",{value:!0}),Ze.from=function(m,b,M,p,T,L){var G=Object.create(pt);return Ae.toFlatObject(m,G,function(re){return re!==Error.prototype},function(re){return re!=="isAxiosError"}),Ze.call(G,m.message,b,M,p,T),G.cause=m,G.name=m.name,L&&Object.assign(G,L),G};const ze=Ze,hi=Oe(937);function tn(m){return tn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},tn(m)}function nn(m){return Ae.isPlainObject(m)||Ae.isArray(m)}function bn(m){return Ae.endsWith(m,"[]")?m.slice(0,-2):m}function _n(m,b,M){return m?m.concat(b).map(function(p,T){return p=bn(p),!M&&T?"["+p+"]":p}).join(M?".":""):b}var Ws=Ae.toFlatObject(Ae,{},null,function(m){return/^is[A-Z]/.test(m)});const ur=function(m,b,M){if(!Ae.isObject(m))throw new TypeError("target must be an object");b=b||new(hi||FormData);var p,T=(M=Ae.toFlatObject(M,{metaTokens:!0,dots:!1,indexes:!1},!1,function(ht,ut){return!Ae.isUndefined(ut[ht])})).metaTokens,L=M.visitor||Me,G=M.dots,re=M.indexes,se=(M.Blob||typeof Blob!="undefined"&&Blob)&&(p=b)&&Ae.isFunction(p.append)&&p[Symbol.toStringTag]==="FormData"&&p[Symbol.iterator];if(!Ae.isFunction(L))throw new TypeError("visitor must be a function");function Le(ht){if(ht===null)return"";if(Ae.isDate(ht))return ht.toISOString();if(!se&&Ae.isBlob(ht))throw new ze("Blob is not supported. Use a Buffer instead.");return Ae.isArrayBuffer(ht)||Ae.isTypedArray(ht)?se&&typeof Blob=="function"?new Blob([ht]):We.from(ht):ht}function Me(ht,ut,it){var gt=ht;if(ht&&!it&&tn(ht)==="object"){if(Ae.endsWith(ut,"{}"))ut=T?ut:ut.slice(0,-2),ht=JSON.stringify(ht);else if(Ae.isArray(ht)&&function(Et){return Ae.isArray(Et)&&!Et.some(nn)}(ht)||Ae.isFileList(ht)||Ae.endsWith(ut,"[]")&&(gt=Ae.toArray(ht)))return ut=bn(ut),gt.forEach(function(Et,Ti){!Ae.isUndefined(Et)&&Et!==null&&b.append(re===!0?_n([ut],Ti,G):re===null?ut:ut+"[]",Le(Et))}),!1}return!!nn(ht)||(b.append(_n(it,ut,G),Le(ht)),!1)}var Je=[],ot=Object.assign(Ws,{defaultVisitor:Me,convertValue:Le,isVisitable:nn});if(!Ae.isObject(m))throw new TypeError("data must be an object");return function ht(ut,it){if(!Ae.isUndefined(ut)){if(Je.indexOf(ut)!==-1)throw Error("Circular reference detected in "+it.join("."));Je.push(ut),Ae.forEach(ut,function(gt,Et){(!(Ae.isUndefined(gt)||gt===null)&&L.call(b,gt,Ae.isString(Et)?Et.trim():Et,it,ot))===!0&&ht(gt,it?it.concat(Et):[Et])}),Je.pop()}}(m),b};function Wr(m){var b={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(m).replace(/[!'()~]|%20|%00/g,function(M){return b[M]})}function wr(m,b){this._pairs=[],m&&ur(m,this,b)}var xi=wr.prototype;xi.append=function(m,b){this._pairs.push([m,b])},xi.toString=function(m){var b=m?function(M){return m.call(this,M,Wr)}:Wr;return this._pairs.map(function(M){return b(M[0])+"="+b(M[1])},"").join("&")};const Kr=wr;function Ks(m){return encodeURIComponent(m).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function xn(m,b,M){if(!b)return m;var p,T=M&&M.encode||Ks,L=M&&M.serialize;if(p=L?L(b,M):Ae.isURLSearchParams(b)?b.toString():new Kr(b,M).toString(T)){var G=m.indexOf("#");G!==-1&&(m=m.slice(0,G)),m+=(m.indexOf("?")===-1?"?":"&")+p}return m}function rn(m){return rn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},rn(m)}function qs(m,b){for(var M=0;M<b.length;M++){var p=b[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(m,(T=function(L,G){if(rn(L)!=="object"||L===null)return L;var re=L[Symbol.toPrimitive];if(re!==void 0){var se=re.call(L,"string");if(rn(se)!=="object")return se;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(L)}(p.key),rn(T)==="symbol"?T:String(T)),p)}var T}var ys=function(){function m(){(function(p,T){if(!(p instanceof T))throw new TypeError("Cannot call a class as a function")})(this,m),this.handlers=[]}var b,M;return b=m,M=[{key:"use",value:function(p,T,L){return this.handlers.push({fulfilled:p,rejected:T,synchronous:!!L&&L.synchronous,runWhen:L?L.runWhen:null}),this.handlers.length-1}},{key:"eject",value:function(p){this.handlers[p]&&(this.handlers[p]=null)}},{key:"clear",value:function(){this.handlers&&(this.handlers=[])}},{key:"forEach",value:function(p){Ae.forEach(this.handlers,function(T){T!==null&&p(T)})}}],M&&qs(b.prototype,M),Object.defineProperty(b,"prototype",{writable:!1}),m}();const On=ys,qr={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},K=typeof URLSearchParams!="undefined"?URLSearchParams:Kr,Q=FormData;var ge,Be=(typeof navigator=="undefined"||(ge=navigator.product)!=="ReactNative"&&ge!=="NativeScript"&&ge!=="NS")&&typeof window!="undefined"&&typeof document!="undefined",Qe=typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function";const At={isBrowser:!0,classes:{URLSearchParams:K,FormData:Q,Blob},isStandardBrowserEnv:Be,isStandardBrowserWebWorkerEnv:Qe,protocols:["http","https","file","blob","url","data"]},Yt=function(m){function b(p,T,L,G){var re=p[G++],se=Number.isFinite(+re),Le=G>=p.length;return re=!re&&Ae.isArray(L)?L.length:re,Le?(Ae.hasOwnProp(L,re)?L[re]=[L[re],T]:L[re]=T,!se):(L[re]&&Ae.isObject(L[re])||(L[re]=[]),b(p,T,L[re],G)&&Ae.isArray(L[re])&&(L[re]=function(Me){var Je,ot,ht={},ut=Object.keys(Me),it=ut.length;for(Je=0;Je<it;Je++)ht[ot=ut[Je]]=Me[ot];return ht}(L[re])),!se)}if(Ae.isFormData(m)&&Ae.isFunction(m.entries)){var M={};return Ae.forEachEntry(m,function(p,T){b(function(L){return Ae.matchAll(/\w+|\[(\w*)]/g,L).map(function(G){return G[0]==="[]"?"":G[1]||G[0]})}(p),T,M,0)}),M}return null};var ri={"Content-Type":void 0},Vi={transitional:qr,adapter:["xhr","http"],transformRequest:[function(m,b){var M,p=b.getContentType()||"",T=p.indexOf("application/json")>-1,L=Ae.isObject(m);if(L&&Ae.isHTMLForm(m)&&(m=new FormData(m)),Ae.isFormData(m))return T&&T?JSON.stringify(Yt(m)):m;if(Ae.isArrayBuffer(m)||Ae.isBuffer(m)||Ae.isStream(m)||Ae.isFile(m)||Ae.isBlob(m))return m;if(Ae.isArrayBufferView(m))return m.buffer;if(Ae.isURLSearchParams(m))return b.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),m.toString();if(L){if(p.indexOf("application/x-www-form-urlencoded")>-1)return function(re,se){return ur(re,new At.classes.URLSearchParams,Object.assign({visitor:function(Le,Me,Je,ot){return At.isNode&&Ae.isBuffer(Le)?(this.append(Me,Le.toString("base64")),!1):ot.defaultVisitor.apply(this,arguments)}},se))}(m,this.formSerializer).toString();if((M=Ae.isFileList(m))||p.indexOf("multipart/form-data")>-1){var G=this.env&&this.env.FormData;return ur(M?{"files[]":m}:m,G&&new G,this.formSerializer)}}return L||T?(b.setContentType("application/json",!1),function(re,se,Le){if(Ae.isString(re))try{return(0,JSON.parse)(re),Ae.trim(re)}catch(Me){if(Me.name!=="SyntaxError")throw Me}return(0,JSON.stringify)(re)}(m)):m}],transformResponse:[function(m){var b=this.transitional||Vi.transitional,M=b&&b.forcedJSONParsing,p=this.responseType==="json";if(m&&Ae.isString(m)&&(M&&!this.responseType||p)){var T=!(b&&b.silentJSONParsing)&&p;try{return JSON.parse(m)}catch(L){if(T)throw L.name==="SyntaxError"?ze.from(L,ze.ERR_BAD_RESPONSE,this,null,this.response):L}}return m}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:At.classes.FormData,Blob:At.classes.Blob},validateStatus:function(m){return m>=200&&m<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};Ae.forEach(["delete","get","head"],function(m){Vi.headers[m]={}}),Ae.forEach(["post","put","patch"],function(m){Vi.headers[m]=Ae.merge(ri)});const Ni=Vi;var En=Ae.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]);function Tn(m){return Tn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},Tn(m)}function Sn(m,b){(b==null||b>m.length)&&(b=m.length);for(var M=0,p=new Array(b);M<b;M++)p[M]=m[M];return p}function Pn(m,b){for(var M=0;M<b.length;M++){var p=b[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(m,(T=function(L,G){if(Tn(L)!=="object"||L===null)return L;var re=L[Symbol.toPrimitive];if(re!==void 0){var se=re.call(L,"string");if(Tn(se)!=="object")return se;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(L)}(p.key),Tn(T)==="symbol"?T:String(T)),p)}var T}var Bn=Symbol("internals");function wi(m){return m&&String(m).trim().toLowerCase()}function zi(m){return m===!1||m==null?m:Ae.isArray(m)?m.map(zi):String(m)}function Fn(m,b,M,p){return Ae.isFunction(p)?p.call(this,b,M):Ae.isString(b)?Ae.isString(p)?b.indexOf(p)!==-1:Ae.isRegExp(p)?p.test(b):void 0:void 0}var Lr=function(m,b){function M(G){(function(re,se){if(!(re instanceof se))throw new TypeError("Cannot call a class as a function")})(this,M),G&&this.set(G)}var p,T,L;return p=M,T=[{key:"set",value:function(G,re,se){var Le=this;function Me(Et,Ti,yi){var Rt=wi(Ti);if(!Rt)throw new Error("header name must be a non-empty string");var Ir=Ae.findKey(Le,Rt);(!Ir||Le[Ir]===void 0||yi===!0||yi===void 0&&Le[Ir]!==!1)&&(Le[Ir||Ti]=zi(Et))}var Je,ot,ht,ut,it,gt=function(Et,Ti){return Ae.forEach(Et,function(yi,Rt){return Me(yi,Rt,Ti)})};return Ae.isPlainObject(G)||G instanceof this.constructor?gt(G,re):Ae.isString(G)&&(G=G.trim())&&!/^[-_a-zA-Z]+$/.test(G.trim())?gt((it={},(Je=G)&&Je.split(`
`).forEach(function(Et){ut=Et.indexOf(":"),ot=Et.substring(0,ut).trim().toLowerCase(),ht=Et.substring(ut+1).trim(),!ot||it[ot]&&En[ot]||(ot==="set-cookie"?it[ot]?it[ot].push(ht):it[ot]=[ht]:it[ot]=it[ot]?it[ot]+", "+ht:ht)}),it),re):G!=null&&Me(re,G,se),this}},{key:"get",value:function(G,re){if(G=wi(G)){var se=Ae.findKey(this,G);if(se){var Le=this[se];if(!re)return Le;if(re===!0)return function(Me){for(var Je,ot=Object.create(null),ht=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;Je=ht.exec(Me);)ot[Je[1]]=Je[2];return ot}(Le);if(Ae.isFunction(re))return re.call(this,Le,se);if(Ae.isRegExp(re))return re.exec(Le);throw new TypeError("parser must be boolean|regexp|function")}}}},{key:"has",value:function(G,re){if(G=wi(G)){var se=Ae.findKey(this,G);return!(!se||re&&!Fn(0,this[se],se,re))}return!1}},{key:"delete",value:function(G,re){var se=this,Le=!1;function Me(Je){if(Je=wi(Je)){var ot=Ae.findKey(se,Je);!ot||re&&!Fn(0,se[ot],ot,re)||(delete se[ot],Le=!0)}}return Ae.isArray(G)?G.forEach(Me):Me(G),Le}},{key:"clear",value:function(){return Object.keys(this).forEach(this.delete.bind(this))}},{key:"normalize",value:function(G){var re=this,se={};return Ae.forEach(this,function(Le,Me){var Je=Ae.findKey(se,Me);if(Je)return re[Je]=zi(Le),void delete re[Me];var ot=G?function(ht){return ht.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,function(ut,it,gt){return it.toUpperCase()+gt})}(Me):String(Me).trim();ot!==Me&&delete re[Me],re[ot]=zi(Le),se[ot]=!0}),this}},{key:"concat",value:function(){for(var G,re=arguments.length,se=new Array(re),Le=0;Le<re;Le++)se[Le]=arguments[Le];return(G=this.constructor).concat.apply(G,[this].concat(se))}},{key:"toJSON",value:function(G){var re=Object.create(null);return Ae.forEach(this,function(se,Le){se!=null&&se!==!1&&(re[Le]=G&&Ae.isArray(se)?se.join(", "):se)}),re}},{key:Symbol.iterator,value:function(){return Object.entries(this.toJSON())[Symbol.iterator]()}},{key:"toString",value:function(){return Object.entries(this.toJSON()).map(function(G){var re,se,Le=(se=2,function(Me){if(Array.isArray(Me))return Me}(re=G)||function(Me,Je){var ot=Me==null?null:typeof Symbol!="undefined"&&Me[Symbol.iterator]||Me["@@iterator"];if(ot!=null){var ht,ut,it,gt,Et=[],Ti=!0,yi=!1;try{if(it=(ot=ot.call(Me)).next,Je===0){if(Object(ot)!==ot)return;Ti=!1}else for(;!(Ti=(ht=it.call(ot)).done)&&(Et.push(ht.value),Et.length!==Je);Ti=!0);}catch(Rt){yi=!0,ut=Rt}finally{try{if(!Ti&&ot.return!=null&&(gt=ot.return(),Object(gt)!==gt))return}finally{if(yi)throw ut}}return Et}}(re,se)||function(Me,Je){if(Me){if(typeof Me=="string")return Sn(Me,Je);var ot=Object.prototype.toString.call(Me).slice(8,-1);return ot==="Object"&&Me.constructor&&(ot=Me.constructor.name),ot==="Map"||ot==="Set"?Array.from(Me):ot==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ot)?Sn(Me,Je):void 0}}(re,se)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}());return Le[0]+": "+Le[1]}).join(`
`)}},{key:Symbol.toStringTag,get:function(){return"AxiosHeaders"}}],L=[{key:"from",value:function(G){return G instanceof this?G:new this(G)}},{key:"concat",value:function(G){for(var re=new this(G),se=arguments.length,Le=new Array(se>1?se-1:0),Me=1;Me<se;Me++)Le[Me-1]=arguments[Me];return Le.forEach(function(Je){return re.set(Je)}),re}},{key:"accessor",value:function(G){var re=(this[Bn]=this[Bn]={accessors:{}}).accessors,se=this.prototype;function Le(Me){var Je=wi(Me);re[Je]||(function(ot,ht){var ut=Ae.toCamelCase(" "+ht);["get","set","has"].forEach(function(it){Object.defineProperty(ot,it+ut,{value:function(gt,Et,Ti){return this[it].call(this,ht,gt,Et,Ti)},configurable:!0})})}(se,Me),re[Je]=!0)}return Ae.isArray(G)?G.forEach(Le):Le(G),this}}],T&&Pn(p.prototype,T),L&&Pn(p,L),Object.defineProperty(p,"prototype",{writable:!1}),M}();Lr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent"]),Ae.freezeMethods(Lr.prototype),Ae.freezeMethods(Lr);const Ui=Lr;function zr(m,b){var M=this||Ni,p=b||M,T=Ui.from(p.headers),L=p.data;return Ae.forEach(m,function(G){L=G.call(M,L,T.normalize(),b?b.status:void 0)}),T.normalize(),L}function Io(m){return!(!m||!m.__CANCEL__)}function Ro(m,b,M){ze.call(this,m==null?"canceled":m,ze.ERR_CANCELED,b,M),this.name="CanceledError"}Ae.inherits(Ro,ze,{__CANCEL__:!0});const zs=Ro,Eu=At.isStandardBrowserEnv?{write:function(m,b,M,p,T,L){var G=[];G.push(m+"="+encodeURIComponent(b)),Ae.isNumber(M)&&G.push("expires="+new Date(M).toGMTString()),Ae.isString(p)&&G.push("path="+p),Ae.isString(T)&&G.push("domain="+T),L===!0&&G.push("secure"),document.cookie=G.join("; ")},read:function(m){var b=document.cookie.match(new RegExp("(^|;\\s*)("+m+")=([^;]*)"));return b?decodeURIComponent(b[3]):null},remove:function(m){this.write(m,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}};function Oo(m,b){return m&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(b)?function(M,p){return p?M.replace(/\/+$/,"")+"/"+p.replace(/^\/+/,""):M}(m,b):b}const Tu=At.isStandardBrowserEnv?function(){var m,b=/(msie|trident)/i.test(navigator.userAgent),M=document.createElement("a");function p(T){var L=T;return b&&(M.setAttribute("href",L),L=M.href),M.setAttribute("href",L),{href:M.href,protocol:M.protocol?M.protocol.replace(/:$/,""):"",host:M.host,search:M.search?M.search.replace(/^\?/,""):"",hash:M.hash?M.hash.replace(/^#/,""):"",hostname:M.hostname,port:M.port,pathname:M.pathname.charAt(0)==="/"?M.pathname:"/"+M.pathname}}return m=p(window.location.href),function(T){var L=Ae.isString(T)?p(T):T;return L.protocol===m.protocol&&L.host===m.host}}():function(){return!0};function Po(m,b){var M=0,p=function(T,L){T=T||10;var G,re=new Array(T),se=new Array(T),Le=0,Me=0;return L=L!==void 0?L:1e3,function(Je){var ot=Date.now(),ht=se[Me];G||(G=ot),re[Le]=Je,se[Le]=ot;for(var ut=Me,it=0;ut!==Le;)it+=re[ut++],ut%=T;if((Le=(Le+1)%T)===Me&&(Me=(Me+1)%T),!(ot-G<L)){var gt=ht&&ot-ht;return gt?Math.round(1e3*it/gt):void 0}}}(50,250);return function(T){var L=T.loaded,G=T.lengthComputable?T.total:void 0,re=L-M,se=p(re);M=L;var Le={loaded:L,total:G,progress:G?L/G:void 0,bytes:re,rate:se||void 0,estimated:se&&G&&L<=G?(G-L)/se:void 0,event:T};Le[b?"download":"upload"]=!0,m(Le)}}const Su=typeof XMLHttpRequest!="undefined"&&function(m){return new Promise(function(b,M){var p,T=m.data,L=Ui.from(m.headers).normalize(),G=m.responseType;function re(){m.cancelToken&&m.cancelToken.unsubscribe(p),m.signal&&m.signal.removeEventListener("abort",p)}Ae.isFormData(T)&&(At.isStandardBrowserEnv||At.isStandardBrowserWebWorkerEnv)&&L.setContentType(!1);var se=new XMLHttpRequest;if(m.auth){var Le=m.auth.username||"",Me=m.auth.password?unescape(encodeURIComponent(m.auth.password)):"";L.set("Authorization","Basic "+btoa(Le+":"+Me))}var Je=Oo(m.baseURL,m.url);function ot(){if(se){var gt=Ui.from("getAllResponseHeaders"in se&&se.getAllResponseHeaders());(function(Et,Ti,yi){var Rt=yi.config.validateStatus;yi.status&&Rt&&!Rt(yi.status)?Ti(new ze("Request failed with status code "+yi.status,[ze.ERR_BAD_REQUEST,ze.ERR_BAD_RESPONSE][Math.floor(yi.status/100)-4],yi.config,yi.request,yi)):Et(yi)})(function(Et){b(Et),re()},function(Et){M(Et),re()},{data:G&&G!=="text"&&G!=="json"?se.response:se.responseText,status:se.status,statusText:se.statusText,headers:gt,config:m,request:se}),se=null}}if(se.open(m.method.toUpperCase(),xn(Je,m.params,m.paramsSerializer),!0),se.timeout=m.timeout,"onloadend"in se?se.onloadend=ot:se.onreadystatechange=function(){se&&se.readyState===4&&(se.status!==0||se.responseURL&&se.responseURL.indexOf("file:")===0)&&setTimeout(ot)},se.onabort=function(){se&&(M(new ze("Request aborted",ze.ECONNABORTED,m,se)),se=null)},se.onerror=function(){M(new ze("Network Error",ze.ERR_NETWORK,m,se)),se=null},se.ontimeout=function(){var gt=m.timeout?"timeout of "+m.timeout+"ms exceeded":"timeout exceeded",Et=m.transitional||qr;m.timeoutErrorMessage&&(gt=m.timeoutErrorMessage),M(new ze(gt,Et.clarifyTimeoutError?ze.ETIMEDOUT:ze.ECONNABORTED,m,se)),se=null},At.isStandardBrowserEnv){var ht=(m.withCredentials||Tu(Je))&&m.xsrfCookieName&&Eu.read(m.xsrfCookieName);ht&&L.set(m.xsrfHeaderName,ht)}T===void 0&&L.setContentType(null),"setRequestHeader"in se&&Ae.forEach(L.toJSON(),function(gt,Et){se.setRequestHeader(Et,gt)}),Ae.isUndefined(m.withCredentials)||(se.withCredentials=!!m.withCredentials),G&&G!=="json"&&(se.responseType=m.responseType),typeof m.onDownloadProgress=="function"&&se.addEventListener("progress",Po(m.onDownloadProgress,!0)),typeof m.onUploadProgress=="function"&&se.upload&&se.upload.addEventListener("progress",Po(m.onUploadProgress)),(m.cancelToken||m.signal)&&(p=function(gt){se&&(M(!gt||gt.type?new zs(null,m,se):gt),se.abort(),se=null)},m.cancelToken&&m.cancelToken.subscribe(p),m.signal&&(m.signal.aborted?p():m.signal.addEventListener("abort",p)));var ut,it=(ut=/^([-+\w]{1,25})(:?\/\/|:)/.exec(Je))&&ut[1]||"";it&&At.protocols.indexOf(it)===-1?M(new ze("Unsupported protocol "+it+":",ze.ERR_BAD_REQUEST,m)):se.send(T||null)})};var Ys={http:null,xhr:Su};Ae.forEach(Ys,function(m,b){if(m){try{Object.defineProperty(m,"name",{value:b})}catch(M){}Object.defineProperty(m,"adapterName",{value:b})}});function Pa(m){if(m.cancelToken&&m.cancelToken.throwIfRequested(),m.signal&&m.signal.aborted)throw new zs(null,m)}function Bo(m){return Pa(m),m.headers=Ui.from(m.headers),m.data=zr.call(m,m.transformRequest),["post","put","patch"].indexOf(m.method)!==-1&&m.headers.setContentType("application/x-www-form-urlencoded",!1),function(b){for(var M,p,T=(b=Ae.isArray(b)?b:[b]).length,L=0;L<T&&(M=b[L],!(p=Ae.isString(M)?Ys[M.toLowerCase()]:M));L++);if(!p)throw p===!1?new ze("Adapter ".concat(M," is not supported by the environment"),"ERR_NOT_SUPPORT"):new Error(Ae.hasOwnProp(Ys,M)?"Adapter '".concat(M,"' is not available in the build"):"Unknown adapter '".concat(M,"'"));if(!Ae.isFunction(p))throw new TypeError("adapter is not a function");return p}(m.adapter||Ni.adapter)(m).then(function(b){return Pa(m),b.data=zr.call(m,m.transformResponse,b),b.headers=Ui.from(b.headers),b},function(b){return Io(b)||(Pa(m),b&&b.response&&(b.response.data=zr.call(m,m.transformResponse,b.response),b.response.headers=Ui.from(b.response.headers))),Promise.reject(b)})}var Ba=function(m){return m instanceof Ui?m.toJSON():m};function Yr(m,b){b=b||{};var M={};function p(Le,Me,Je){return Ae.isPlainObject(Le)&&Ae.isPlainObject(Me)?Ae.merge.call({caseless:Je},Le,Me):Ae.isPlainObject(Me)?Ae.merge({},Me):Ae.isArray(Me)?Me.slice():Me}function T(Le,Me,Je){return Ae.isUndefined(Me)?Ae.isUndefined(Le)?void 0:p(void 0,Le,Je):p(Le,Me,Je)}function L(Le,Me){if(!Ae.isUndefined(Me))return p(void 0,Me)}function G(Le,Me){return Ae.isUndefined(Me)?Ae.isUndefined(Le)?void 0:p(void 0,Le):p(void 0,Me)}function re(Le,Me,Je){return Je in b?p(Le,Me):Je in m?p(void 0,Le):void 0}var se={url:L,method:L,data:L,baseURL:G,transformRequest:G,transformResponse:G,paramsSerializer:G,timeout:G,timeoutMessage:G,withCredentials:G,adapter:G,responseType:G,xsrfCookieName:G,xsrfHeaderName:G,onUploadProgress:G,onDownloadProgress:G,decompress:G,maxContentLength:G,maxBodyLength:G,beforeRedirect:G,transport:G,httpAgent:G,httpsAgent:G,cancelToken:G,socketPath:G,responseEncoding:G,validateStatus:re,headers:function(Le,Me){return T(Ba(Le),Ba(Me),!0)}};return Ae.forEach(Object.keys(m).concat(Object.keys(b)),function(Le){var Me=se[Le]||T,Je=Me(m[Le],b[Le],Le);Ae.isUndefined(Je)&&Me!==re||(M[Le]=Je)}),M}function Xs(m){return Xs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},Xs(m)}var Qs={};["object","boolean","number","function","string","symbol"].forEach(function(m,b){Qs[m]=function(M){return Xs(M)===m||"a"+(b<1?"n ":" ")+m}});var Fo={};Qs.transitional=function(m,b,M){function p(T,L){return"[Axios v1.2.3] Transitional option '"+T+"'"+L+(M?". "+M:"")}return function(T,L,G){if(m===!1)throw new ze(p(L," has been removed"+(b?" in "+b:"")),ze.ERR_DEPRECATED);return b&&!Fo[L]&&(Fo[L]=!0,console.warn(p(L," has been deprecated since v"+b+" and will be removed in the near future"))),!m||m(T,L,G)}};const Fa={assertOptions:function(m,b,M){if(Xs(m)!=="object")throw new ze("options must be an object",ze.ERR_BAD_OPTION_VALUE);for(var p=Object.keys(m),T=p.length;T-- >0;){var L=p[T],G=b[L];if(G){var re=m[L],se=re===void 0||G(re,L,m);if(se!==!0)throw new ze("option "+L+" must be "+se,ze.ERR_BAD_OPTION_VALUE)}else if(M!==!0)throw new ze("Unknown option "+L,ze.ERR_BAD_OPTION)}},validators:Qs};function vs(m){return vs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},vs(m)}function Cu(m,b){for(var M=0;M<b.length;M++){var p=b[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(m,(T=function(L,G){if(vs(L)!=="object"||L===null)return L;var re=L[Symbol.toPrimitive];if(re!==void 0){var se=re.call(L,"string");if(vs(se)!=="object")return se;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(L)}(p.key),vs(T)==="symbol"?T:String(T)),p)}var T}var dr=Fa.validators,Zs=function(){function m(p){(function(T,L){if(!(T instanceof L))throw new TypeError("Cannot call a class as a function")})(this,m),this.defaults=p,this.interceptors={request:new On,response:new On}}var b,M;return b=m,(M=[{key:"request",value:function(p,T){typeof p=="string"?(T=T||{}).url=p:T=p||{};var L,G=T=Yr(this.defaults,T),re=G.transitional,se=G.paramsSerializer,Le=G.headers;re!==void 0&&Fa.assertOptions(re,{silentJSONParsing:dr.transitional(dr.boolean),forcedJSONParsing:dr.transitional(dr.boolean),clarifyTimeoutError:dr.transitional(dr.boolean)},!1),se!==void 0&&Fa.assertOptions(se,{encode:dr.function,serialize:dr.function},!0),T.method=(T.method||this.defaults.method||"get").toLowerCase(),(L=Le&&Ae.merge(Le.common,Le[T.method]))&&Ae.forEach(["delete","get","head","post","put","patch","common"],function(Rt){delete Le[Rt]}),T.headers=Ui.concat(L,Le);var Me=[],Je=!0;this.interceptors.request.forEach(function(Rt){typeof Rt.runWhen=="function"&&Rt.runWhen(T)===!1||(Je=Je&&Rt.synchronous,Me.unshift(Rt.fulfilled,Rt.rejected))});var ot,ht=[];this.interceptors.response.forEach(function(Rt){ht.push(Rt.fulfilled,Rt.rejected)});var ut,it=0;if(!Je){var gt=[Bo.bind(this),void 0];for(gt.unshift.apply(gt,Me),gt.push.apply(gt,ht),ut=gt.length,ot=Promise.resolve(T);it<ut;)ot=ot.then(gt[it++],gt[it++]);return ot}ut=Me.length;var Et=T;for(it=0;it<ut;){var Ti=Me[it++],yi=Me[it++];try{Et=Ti(Et)}catch(Rt){yi.call(this,Rt);break}}try{ot=Bo.call(this,Et)}catch(Rt){return Promise.reject(Rt)}for(it=0,ut=ht.length;it<ut;)ot=ot.then(ht[it++],ht[it++]);return ot}},{key:"getUri",value:function(p){return xn(Oo((p=Yr(this.defaults,p)).baseURL,p.url),p.params,p.paramsSerializer)}}])&&Cu(b.prototype,M),Object.defineProperty(b,"prototype",{writable:!1}),m}();Ae.forEach(["delete","get","head","options"],function(m){Zs.prototype[m]=function(b,M){return this.request(Yr(M||{},{method:m,url:b,data:(M||{}).data}))}}),Ae.forEach(["post","put","patch"],function(m){function b(M){return function(p,T,L){return this.request(Yr(L||{},{method:m,headers:M?{"Content-Type":"multipart/form-data"}:{},url:p,data:T}))}}Zs.prototype[m]=b(),Zs.prototype[m+"Form"]=b(!0)});const si=Zs;function cr(m){return cr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},cr(m)}function Mo(m,b){for(var M=0;M<b.length;M++){var p=b[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(m,(T=function(L,G){if(cr(L)!=="object"||L===null)return L;var re=L[Symbol.toPrimitive];if(re!==void 0){var se=re.call(L,"string");if(cr(se)!=="object")return se;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(L)}(p.key),cr(T)==="symbol"?T:String(T)),p)}var T}var Xr=function(){function m(T){if(function(re,se){if(!(re instanceof se))throw new TypeError("Cannot call a class as a function")}(this,m),typeof T!="function")throw new TypeError("executor must be a function.");var L;this.promise=new Promise(function(re){L=re});var G=this;this.promise.then(function(re){if(G._listeners){for(var se=G._listeners.length;se-- >0;)G._listeners[se](re);G._listeners=null}}),this.promise.then=function(re){var se,Le=new Promise(function(Me){G.subscribe(Me),se=Me}).then(re);return Le.cancel=function(){G.unsubscribe(se)},Le},T(function(re,se,Le){G.reason||(G.reason=new zs(re,se,Le),L(G.reason))})}var b,M,p;return b=m,M=[{key:"throwIfRequested",value:function(){if(this.reason)throw this.reason}},{key:"subscribe",value:function(T){this.reason?T(this.reason):this._listeners?this._listeners.push(T):this._listeners=[T]}},{key:"unsubscribe",value:function(T){if(this._listeners){var L=this._listeners.indexOf(T);L!==-1&&this._listeners.splice(L,1)}}}],p=[{key:"source",value:function(){var T;return{token:new m(function(L){T=L}),cancel:T}}}],M&&Mo(b.prototype,M),p&&Mo(b,p),Object.defineProperty(b,"prototype",{writable:!1}),m}();const wu=Xr;function Ma(m,b){(b==null||b>m.length)&&(b=m.length);for(var M=0,p=new Array(b);M<b;M++)p[M]=m[M];return p}var Ei={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ei).forEach(function(m){var b,M,p=(M=2,function(G){if(Array.isArray(G))return G}(b=m)||function(G,re){var se=G==null?null:typeof Symbol!="undefined"&&G[Symbol.iterator]||G["@@iterator"];if(se!=null){var Le,Me,Je,ot,ht=[],ut=!0,it=!1;try{if(Je=(se=se.call(G)).next,re===0){if(Object(se)!==se)return;ut=!1}else for(;!(ut=(Le=Je.call(se)).done)&&(ht.push(Le.value),ht.length!==re);ut=!0);}catch(gt){it=!0,Me=gt}finally{try{if(!ut&&se.return!=null&&(ot=se.return(),Object(ot)!==ot))return}finally{if(it)throw Me}}return ht}}(b,M)||function(G,re){if(G){if(typeof G=="string")return Ma(G,re);var se=Object.prototype.toString.call(G).slice(8,-1);return se==="Object"&&G.constructor&&(se=G.constructor.name),se==="Map"||se==="Set"?Array.from(G):se==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(se)?Ma(G,re):void 0}}(b,M)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()),T=p[0],L=p[1];Ei[L]=T});const Lu=Ei;var gi=function m(b){var M=new si(b),p=De(si.prototype.request,M);return Ae.extend(p,si.prototype,M,{allOwnKeys:!0}),Ae.extend(p,M,null,{allOwnKeys:!0}),p.create=function(T){return m(Yr(b,T))},p}(Ni);gi.Axios=si,gi.CanceledError=zs,gi.CancelToken=wu,gi.isCancel=Io,gi.VERSION="1.2.3",gi.toFormData=ur,gi.AxiosError=ze,gi.Cancel=gi.CanceledError,gi.all=function(m){return Promise.all(m)},gi.spread=function(m){return function(b){return m.apply(null,b)}},gi.isAxiosError=function(m){return Ae.isObject(m)&&m.isAxiosError===!0},gi.mergeConfig=Yr,gi.AxiosHeaders=Ui,gi.formToJSON=function(m){return Yt(Ae.isHTMLForm(m)?new FormData(m):m)},gi.HttpStatusCode=Lu,gi.default=gi;const Js=gi,Du={send:function(m){Js.post(m.url,m.data).then(function(b){var M=b.data;M&&M.code===0?m.success&&m.success(M):m.error&&m.error(M&&M.msg)}).catch(function(b){console.error(b),m.error&&m.error()})},read:function(m){Js.get(m.url).then(function(b){var M=b.data;M&&M.code===0?m.success&&m.success(M.data.map(function(p){return{time:p[0],type:p[1],color:p[2],author:p[3],text:p[4]}})):m.error&&m.error(M&&M.msg)}).catch(function(b){console.error(b),m.error&&m.error()})}};function Na(m){return Na=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},Na(m)}function ku(m){var b=this;this.lang=m,this.fallbackLang=this.lang.includes("-")?this.lang.split("-")[0]:this.lang,this.tran=function(M){return M=M.toLowerCase(),Qr[b.lang]&&Qr[b.lang][M]?Qr[b.lang][M]:Qr[b.fallbackLang]&&Qr[b.fallbackLang][M]?Qr[b.fallbackLang][M]:Ua[M]?Ua[M]:M}}var Ua={"danmaku-loading":"Danmaku is loading",top:"Top",bottom:"Bottom",rolling:"Rolling","input-danmaku-enter":"Input danmaku, hit Enter","about-author":"About author","dplayer-feedback":"DPlayer feedback","about-dplayer":"About DPlayer",loop:"Loop",speed:"Speed","opacity-danmaku":"Opacity for danmaku",normal:"Normal","please-input-danmaku":"Please input danmaku content!","set-danmaku-color":"Set danmaku color","set-danmaku-type":"Set danmaku type","show-danmaku":"Show danmaku","video-failed":"Video load failed","danmaku-failed":"Danmaku load failed","danmaku-send-failed":"Danmaku send failed","switching-quality":"Switching to %q quality","switched-quality":"Switched to %q quality",ff:"FF %s s",rew:"REW %s s","unlimited-danmaku":"Unlimited danmaku","send-danmaku":"Send danmaku",setting:"Setting",fullscreen:"Full screen","web-fullscreen":"Web full screen",send:"Send",screenshot:"Screenshot",airplay:"AirPlay",chromecast:"ChromeCast",subtitle:"Subtitle",off:"Off","show-subs":"Show subtitle","hide-subs":"Hide subtitle",volume:"Volume",live:"Live","video-info":"Video info"},Qr={en:Ua,"zh-cn":{"danmaku-loading":"\u5F39\u5E55\u52A0\u8F7D\u4E2D",top:"\u9876\u90E8",bottom:"\u5E95\u90E8",rolling:"\u6EDA\u52A8","input-danmaku-enter":"\u8F93\u5165\u5F39\u5E55\uFF0C\u56DE\u8F66\u53D1\u9001","about-author":"\u5173\u4E8E\u4F5C\u8005","dplayer-feedback":"\u64AD\u653E\u5668\u610F\u89C1\u53CD\u9988","about-dplayer":"\u5173\u4E8E DPlayer \u64AD\u653E\u5668",loop:"\u6D17\u8111\u5FAA\u73AF",speed:"\u901F\u5EA6","opacity-danmaku":"\u5F39\u5E55\u900F\u660E\u5EA6",normal:"\u6B63\u5E38","please-input-danmaku":"\u8981\u8F93\u5165\u5F39\u5E55\u5185\u5BB9\u554A\u5582\uFF01","set-danmaku-color":"\u8BBE\u7F6E\u5F39\u5E55\u989C\u8272","set-danmaku-type":"\u8BBE\u7F6E\u5F39\u5E55\u7C7B\u578B","show-danmaku":"\u663E\u793A\u5F39\u5E55","video-failed":"\u89C6\u9891\u52A0\u8F7D\u5931\u8D25","danmaku-failed":"\u5F39\u5E55\u52A0\u8F7D\u5931\u8D25","danmaku-send-failed":"\u5F39\u5E55\u53D1\u9001\u5931\u8D25","switching-quality":"\u6B63\u5728\u5207\u6362\u81F3 %q \u753B\u8D28","switched-quality":"\u5DF2\u7ECF\u5207\u6362\u81F3 %q \u753B\u8D28",ff:"\u5FEB\u8FDB %s \u79D2",rew:"\u5FEB\u9000 %s \u79D2","unlimited-danmaku":"\u6D77\u91CF\u5F39\u5E55","send-danmaku":"\u53D1\u9001\u5F39\u5E55",setting:"\u8BBE\u7F6E",fullscreen:"\u5168\u5C4F","web-fullscreen":"\u9875\u9762\u5168\u5C4F",send:"\u53D1\u9001",screenshot:"\u622A\u56FE",airplay:"\u65E0\u7EBF\u6295\u5C4F",chromecast:"ChromeCast",subtitle:"\u5B57\u5E55",off:"\u5173\u95ED","show-subs":"\u663E\u793A\u5B57\u5E55","hide-subs":"\u9690\u85CF\u5B57\u5E55",volume:"\u97F3\u91CF",live:"\u76F4\u64AD","video-info":"\u89C6\u9891\u7EDF\u8BA1\u4FE1\u606F"},"zh-tw":{"danmaku-loading":"\u5F48\u5E55\u8F09\u5165\u4E2D",top:"\u9802\u90E8",bottom:"\u5E95\u90E8",rolling:"\u6EFE\u52D5","input-danmaku-enter":"\u8F38\u5165\u5F48\u5E55\uFF0CEnter \u767C\u9001","about-author":"\u95DC\u65BC\u4F5C\u8005","dplayer-feedback":"\u64AD\u653E\u5668\u610F\u898B\u56DE\u994B","about-dplayer":"\u95DC\u65BC DPlayer \u64AD\u653E\u5668",loop:"\u5FAA\u74B0\u64AD\u653E",speed:"\u901F\u5EA6","opacity-danmaku":"\u5F48\u5E55\u900F\u660E\u5EA6",normal:"\u6B63\u5E38","please-input-danmaku":"\u8ACB\u8F38\u5165\u5F48\u5E55\u5167\u5BB9\u554A\uFF01","set-danmaku-color":"\u8A2D\u5B9A\u5F48\u5E55\u984F\u8272","set-danmaku-type":"\u8A2D\u5B9A\u5F48\u5E55\u985E\u578B","show-danmaku":"\u986F\u793A\u5F48\u5E55","video-failed":"\u5F71\u7247\u8F09\u5165\u5931\u6557","danmaku-failed":"\u5F48\u5E55\u8F09\u5165\u5931\u6557","danmaku-send-failed":"\u5F48\u5E55\u767C\u9001\u5931\u6557","switching-quality":"\u6B63\u5728\u5207\u63DB\u81F3 %q \u756B\u8CEA","switched-quality":"\u5DF2\u7D93\u5207\u63DB\u81F3 %q \u756B\u8CEA",ff:"\u5FEB\u9032 %s \u79D2",rew:"\u5FEB\u9000 %s \u79D2","unlimited-danmaku":"\u5DE8\u91CF\u5F48\u5E55","send-danmaku":"\u767C\u9001\u5F48\u5E55",setting:"\u8A2D\u5B9A",fullscreen:"\u5168\u87A2\u5E55","web-fullscreen":"\u9801\u9762\u5168\u87A2\u5E55",send:"\u767C\u9001",screenshot:"\u622A\u5716",airplay:"\u7121\u7DDA\u6295\u5C4F",chromecast:"ChromeCast",subtitle:"\u5B57\u5E55",off:"\u95DC\u9589","show-subs":"\u986F\u793A\u5B57\u5E55","hide-subs":"\u96B1\u85CF\u5B57\u5E55",volume:"\u97F3\u91CF",live:"\u76F4\u64AD","video-info":"\u5F71\u7247\u7D71\u8A08\u8A0A\u606F"},"ko-kr":{"danmaku-loading":"Danmaku\uB97C \uBD88\uB7EC\uC624\uB294 \uC911\uC785\uB2C8\uB2E4.",top:"Top",bottom:"Bottom",rolling:"Rolling","input-danmaku-enter":"Danmaku\uB97C \uC785\uB825\uD558\uACE0 Enter\uB97C \uB204\uB974\uC138\uC694.","about-author":"\uB9CC\uB4E0\uC774","dplayer-feedback":"\uD53C\uB4DC\uBC31 \uBCF4\uB0B4\uAE30","about-dplayer":"DPlayer \uC815\uBCF4",loop:"\uBC18\uBCF5",speed:"\uBC30\uC18D","opacity-danmaku":"Danmaku \uBD88\uD22C\uBA85\uB3C4",normal:"\uD45C\uC900","please-input-danmaku":"Danmaku\uB97C \uC785\uB825\uD558\uC138\uC694!","set-danmaku-color":"Danmaku \uC0C9\uC0C1","set-danmaku-type":"Danmaku \uC124\uC815","show-danmaku":"Danmaku \uD45C\uC2DC","video-failed":"\uBE44\uB514\uC624\uB97C \uBD88\uB7EC\uC624\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4.","danmaku-failed":"Danmaku\uB97C \uBD88\uB7EC\uC624\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4.","danmaku-send-failed":"Danmaku \uC804\uC1A1\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.","Switching to":"","Switched to":"","switching-quality":"\uC804\uD658 %q \uD654\uC9C8","switched-quality":"\uC804\uD658 \uB428 %q \uD654\uC9C8",ff:"\uC55E\uC73C\uB85C %s \uCD08",rew:"\uB4A4\uB85C %s \uCD08","unlimited-danmaku":"\uB05D\uC5C6\uB294 Danmaku","send-danmaku":"Danmaku \uBCF4\uB0B4\uAE30",setting:"\uC124\uC815",fullscreen:"\uC804\uCCB4 \uD654\uBA74","web-fullscreen":"\uC6F9 \uB0B4 \uC804\uCCB4\uD654\uBA74",send:"\uBCF4\uB0B4\uAE30",screenshot:"\uD654\uBA74 \uCEA1\uCCD0",airplay:"\uC5D0\uC5B4\uD50C\uB808\uC774",chromecast:"ChromeCast",subtitle:"\uBD80\uC81C",off:"\uB044\uB2E4","show-subs":"\uC790\uB9C9 \uBCF4\uC774\uAE30","hide-subs":"\uC790\uB9C9 \uC228\uAE30\uAE30",Volume:"\uBCFC\uB968",live:"\uC0DD\uBC29\uC1A1","video-info":"\uBE44\uB514\uC624 \uC815\uBCF4"},de:{"danmaku-loading":"Danmaku l\xE4dt...",top:"Oben",bottom:"Unten",rolling:"Rollend","input-danmaku-enter":"Dr\xFCcke Enter nach dem Einf\xFCgen vom Danmaku","about-author":"\xDCber den Autor","dplayer-feedback":"DPlayer Feedback","about-dplayer":"\xDCber DPlayer",loop:"Wiederholen",speed:"Geschwindigkeit","opacity-danmaku":"Transparenz f\xFCr Danmaku",normal:"Normal","please-input-danmaku":"Bitte Danmaku Inhalt eingeben!","set-danmaku-color":"Danmaku Farbe festlegen","set-danmaku-type":"Danmaku Typ festlegen","show-danmaku":"Zeige Danmaku","video-failed":"Das Video konnte nicht geladen werden","danmaku-failed":"Danmaku konnte nicht geladen werden","danmaku-send-failed":"Das senden von Danmaku ist fehgeschlagen","switching-quality":"Wechsle zur %q Qualit\xE4t","switched-quality":"Zur %q Qualit\xE4t gewechselt",ff:"%s s Vorw\xE4rts",rew:"%s s Zur\xFCck","unlimited-danmaku":"Unlimitiertes Danmaku","send-danmaku":"Sende Danmaku",setting:"Einstellungen",fullscreen:"Vollbild","web-fullscreen":"Browser Vollbild",send:"Senden",screenshot:"Screenshot",airplay:"AirPlay","show-subs":"Zeige Untertitel",chromecast:"ChromeCast",subtitle:"Untertitel",off:"Schlie\xDFung","hide-subs":"Verstecke Untertitel",volume:"Lautst\xE4rke",live:"Live","video-info":"Video Info"}},Iu=Oe(730),Ru=Oe.n(Iu),Ou=Oe(74),No=Oe.n(Ou),Pu=Oe(437),kh=Oe.n(Pu),Bu=Oe(644),Fu=Oe.n(Bu),Mu=Oe(324),Nu=Oe.n(Mu),Uu=Oe(574),ju=Oe.n(Uu),As=Oe(300),Ih=Oe.n(As),Rh=Oe(934),Oh=Oe.n(Rh),Ph=Oe(428),Bh=Oe.n(Ph),Fh=Oe(807),ja=Oe.n(Fh),$u=Oe(338),$a=Oe.n($u),Ga=Oe(254),Yi=Oe.n(Ga),Zr=Oe(965),bs=Oe.n(Zr),Gu=Oe(113),Vu=Oe.n(Gu),Mh=Oe(251),Nh=Oe.n(Mh),oi=Oe(410),Va=Oe.n(oi),Hu=Oe(182),Dr=Oe.n(Hu),Uo=Oe(193),Wu=Oe.n(Uo);const Cn={play:Ru(),pause:No(),volumeUp:kh(),volumeDown:Fu(),volumeOff:Nu(),full:ju(),fullWeb:Ih(),setting:Oh(),right:Bh(),comment:ja(),commentOff:$a(),send:Yi(),pallette:bs(),camera:Vu(),subtitle:Va(),loading:Dr(),airplay:Nh(),chromecast:Wu()};var fi=Oe(916),Ku=Oe.n(fi);function _s(m){return _s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},_s(m)}function jo(m,b){for(var M=0;M<b.length;M++){var p=b[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(m,(T=function(L,G){if(_s(L)!=="object"||L===null)return L;var re=L[Symbol.toPrimitive];if(re!==void 0){var se=re.call(L,"string");if(_s(se)!=="object")return se;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(L)}(p.key),_s(T)==="symbol"?T:String(T)),p)}var T}var Uh=function(){function m(T){(function(L,G){if(!(L instanceof G))throw new TypeError("Cannot call a class as a function")})(this,m),this.container=T.container,this.options=T.options,this.index=T.index,this.tran=T.tran,this.init()}var b,M,p;return b=m,p=[{key:"NewNotice",value:function(T,L,G){var re=document.createElement("div");return re.classList.add("dplayer-notice"),re.style.opacity=L,re.innerText=T,G&&(re.id="dplayer-notice-".concat(G)),re}}],(M=[{key:"init",value:function(){this.container.innerHTML=Ku()({options:this.options,index:this.index,tran:this.tran,icons:Cn,mobile:be.isMobile,video:{current:!0,pic:this.options.video.pic,screenshot:this.options.screenshot,airplay:!(!be.isSafari||be.isChrome)&&this.options.airplay,chromecast:this.options.chromecast,preload:this.options.preload,url:this.options.video.url,subtitle:this.options.subtitle}}),this.volumeBar=this.container.querySelector(".dplayer-volume-bar-inner"),this.volumeBarWrap=this.container.querySelector(".dplayer-volume-bar"),this.volumeBarWrapWrap=this.container.querySelector(".dplayer-volume-bar-wrap"),this.volumeButton=this.container.querySelector(".dplayer-volume"),this.volumeButtonIcon=this.container.querySelector(".dplayer-volume-icon"),this.volumeIcon=this.container.querySelector(".dplayer-volume-icon .dplayer-icon-content"),this.playedBar=this.container.querySelector(".dplayer-played"),this.loadedBar=this.container.querySelector(".dplayer-loaded"),this.playedBarWrap=this.container.querySelector(".dplayer-bar-wrap"),this.playedBarTime=this.container.querySelector(".dplayer-bar-time"),this.danmaku=this.container.querySelector(".dplayer-danmaku"),this.danmakuLoading=this.container.querySelector(".dplayer-danloading"),this.video=this.container.querySelector(".dplayer-video-current"),this.bezel=this.container.querySelector(".dplayer-bezel-icon"),this.playButton=this.container.querySelector(".dplayer-play-icon"),this.mobilePlayButton=this.container.querySelector(".dplayer-mobile-play"),this.videoWrap=this.container.querySelector(".dplayer-video-wrap"),this.controllerMask=this.container.querySelector(".dplayer-controller-mask"),this.ptime=this.container.querySelector(".dplayer-ptime"),this.settingButton=this.container.querySelector(".dplayer-setting-icon"),this.settingBox=this.container.querySelector(".dplayer-setting-box"),this.mask=this.container.querySelector(".dplayer-mask"),this.loop=this.container.querySelector(".dplayer-setting-loop"),this.loopToggle=this.container.querySelector(".dplayer-setting-loop .dplayer-toggle-setting-input"),this.showDanmaku=this.container.querySelector(".dplayer-setting-showdan"),this.showDanmakuToggle=this.container.querySelector(".dplayer-showdan-setting-input"),this.unlimitDanmaku=this.container.querySelector(".dplayer-setting-danunlimit"),this.unlimitDanmakuToggle=this.container.querySelector(".dplayer-danunlimit-setting-input"),this.speed=this.container.querySelector(".dplayer-setting-speed"),this.speedItem=this.container.querySelectorAll(".dplayer-setting-speed-item"),this.danmakuOpacityBar=this.container.querySelector(".dplayer-danmaku-bar-inner"),this.danmakuOpacityBarWrap=this.container.querySelector(".dplayer-danmaku-bar"),this.danmakuOpacityBarWrapWrap=this.container.querySelector(".dplayer-danmaku-bar-wrap"),this.danmakuOpacityBox=this.container.querySelector(".dplayer-setting-danmaku"),this.dtime=this.container.querySelector(".dplayer-dtime"),this.controller=this.container.querySelector(".dplayer-controller"),this.commentInput=this.container.querySelector(".dplayer-comment-input"),this.commentButton=this.container.querySelector(".dplayer-comment-icon"),this.commentSettingBox=this.container.querySelector(".dplayer-comment-setting-box"),this.commentSettingButton=this.container.querySelector(".dplayer-comment-setting-icon"),this.commentSettingFill=this.container.querySelector(".dplayer-comment-setting-icon path"),this.commentSendButton=this.container.querySelector(".dplayer-send-icon"),this.commentSendFill=this.container.querySelector(".dplayer-send-icon path"),this.commentColorSettingBox=this.container.querySelector(".dplayer-comment-setting-color"),this.browserFullButton=this.container.querySelector(".dplayer-full-icon"),this.webFullButton=this.container.querySelector(".dplayer-full-in-icon"),this.menu=this.container.querySelector(".dplayer-menu"),this.menuItem=this.container.querySelectorAll(".dplayer-menu-item"),this.qualityList=this.container.querySelector(".dplayer-quality-list"),this.camareButton=this.container.querySelector(".dplayer-camera-icon"),this.airplayButton=this.container.querySelector(".dplayer-airplay-icon"),this.chromecastButton=this.container.querySelector(".dplayer-chromecast-icon"),this.subtitleButton=this.container.querySelector(".dplayer-subtitle-icon"),this.subtitleButtonInner=this.container.querySelector(".dplayer-subtitle-icon .dplayer-icon-content"),this.subtitlesButton=this.container.querySelector(".dplayer-subtitles-icon"),this.subtitlesBox=this.container.querySelector(".dplayer-subtitles-box"),this.subtitlesItem=this.container.querySelectorAll(".dplayer-subtitles-item"),this.subtitle=this.container.querySelector(".dplayer-subtitle"),this.subtrack=this.container.querySelector(".dplayer-subtrack"),this.qualityButton=this.container.querySelector(".dplayer-quality-icon"),this.barPreview=this.container.querySelector(".dplayer-bar-preview"),this.barWrap=this.container.querySelector(".dplayer-bar-wrap"),this.noticeList=this.container.querySelector(".dplayer-notice-list"),this.infoPanel=this.container.querySelector(".dplayer-info-panel"),this.infoPanelClose=this.container.querySelector(".dplayer-info-panel-close"),this.infoVersion=this.container.querySelector(".dplayer-info-panel-item-version .dplayer-info-panel-item-data"),this.infoFPS=this.container.querySelector(".dplayer-info-panel-item-fps .dplayer-info-panel-item-data"),this.infoType=this.container.querySelector(".dplayer-info-panel-item-type .dplayer-info-panel-item-data"),this.infoUrl=this.container.querySelector(".dplayer-info-panel-item-url .dplayer-info-panel-item-data"),this.infoResolution=this.container.querySelector(".dplayer-info-panel-item-resolution .dplayer-info-panel-item-data"),this.infoDuration=this.container.querySelector(".dplayer-info-panel-item-duration .dplayer-info-panel-item-data"),this.infoDanmakuId=this.container.querySelector(".dplayer-info-panel-item-danmaku-id .dplayer-info-panel-item-data"),this.infoDanmakuApi=this.container.querySelector(".dplayer-info-panel-item-danmaku-api .dplayer-info-panel-item-data"),this.infoDanmakuAmount=this.container.querySelector(".dplayer-info-panel-item-danmaku-amount .dplayer-info-panel-item-data")}}])&&jo(b.prototype,M),p&&jo(b,p),Object.defineProperty(b,"prototype",{writable:!1}),m}();const $o=Uh;function Jr(m){return Jr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},Jr(m)}function qu(m,b){for(var M=0;M<b.length;M++){var p=b[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(m,(T=function(L,G){if(Jr(L)!=="object"||L===null)return L;var re=L[Symbol.toPrimitive];if(re!==void 0){var se=re.call(L,"string");if(Jr(se)!=="object")return se;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(L)}(p.key),Jr(T)==="symbol"?T:String(T)),p)}var T}var zu=function(){function m(p){(function(T,L){if(!(T instanceof L))throw new TypeError("Cannot call a class as a function")})(this,m),this.options=p,this.player=this.options.player,this.container=this.options.container,this.danTunnel={right:{},top:{},bottom:{}},this.danIndex=0,this.dan=[],this.showing=!0,this._opacity=this.options.opacity,this.events=this.options.events,this.unlimited=this.options.unlimited,this._measure(""),this.load()}var b,M;return b=m,M=[{key:"load",value:function(){var p,T=this;p=this.options.api.maximum?"".concat(this.options.api.address,"v3/?id=").concat(this.options.api.id,"&max=").concat(this.options.api.maximum):"".concat(this.options.api.address,"v3/?id=").concat(this.options.api.id);var L=(this.options.api.addition||[]).slice(0);L.push(p),this.events&&this.events.trigger("danmaku_load_start",L),this._readAllEndpoints(L,function(G){T.dan=[].concat.apply([],G).sort(function(re,se){return re.time-se.time}),window.requestAnimationFrame(function(){T.frame()}),T.options.callback(),T.events&&T.events.trigger("danmaku_load_end")})}},{key:"reload",value:function(p){this.options.api=p,this.dan=[],this.clear(),this.load()}},{key:"_readAllEndpoints",value:function(p,T){for(var L=this,G=[],re=0,se=function(Me){L.options.apiBackend.read({url:p[Me],success:function(Je){G[Me]=Je,++re===p.length&&T(G)},error:function(Je){L.options.error(Je||L.options.tran("danmaku-failed")),G[Me]=[],++re===p.length&&T(G)}})},Le=0;Le<p.length;++Le)se(Le)}},{key:"send",value:function(p,T){var L=this,G={token:this.options.api.token,id:this.options.api.id,author:this.options.api.user,time:this.options.time(),text:p.text,color:p.color,type:p.type};this.options.apiBackend.send({url:this.options.api.address+"v3/",data:G,success:T,error:function(se){L.options.error(se||L.options.tran("danmaku-failed"))}}),this.dan.splice(this.danIndex,0,G),this.danIndex++;var re={text:this.htmlEncode(G.text),color:G.color,type:G.type,border:"2px solid ".concat(this.options.borderColor)};this.draw(re),this.events&&this.events.trigger("danmaku_send",G)}},{key:"frame",value:function(){var p=this;if(this.dan.length&&!this.paused&&this.showing){for(var T=this.dan[this.danIndex],L=[];T&&this.options.time()>parseFloat(T.time);)L.push(T),T=this.dan[++this.danIndex];this.draw(L)}window.requestAnimationFrame(function(){p.frame()})}},{key:"opacity",value:function(p){if(p!==void 0){for(var T=this.container.getElementsByClassName("dplayer-danmaku-item"),L=0;L<T.length;L++)T[L].style.opacity=p;this._opacity=p,this.events&&this.events.trigger("danmaku_opacity",this._opacity)}return this._opacity}},{key:"draw",value:function(p){var T=this;if(this.showing){var L=this.options.height,G=this.container.offsetWidth,re=this.container.offsetHeight,se=parseInt(re/L),Le=function(it){var gt=it.offsetWidth||parseInt(it.style.width),Et=it.getBoundingClientRect().right||T.container.getBoundingClientRect().right+gt;return T.container.getBoundingClientRect().right-Et},Me=function(it){return(G+it)/5},Je=function(it,gt,Et){for(var Ti=G/Me(Et),yi=function(Rr){var Ki=T.danTunnel[gt][Rr+""];if(!Ki||!Ki.length)return T.danTunnel[gt][Rr+""]=[it],it.addEventListener("animationend",function(){T.danTunnel[gt][Rr+""].splice(0,1)}),{v:Rr%se};if(gt!=="right")return"continue";for(var ds=0;ds<Ki.length;ds++){var ua=Le(Ki[ds])-10;if(ua<=G-Ti*Me(parseInt(Ki[ds].style.width))||ua<=0)break;if(ds===Ki.length-1)return T.danTunnel[gt][Rr+""].push(it),it.addEventListener("animationend",function(){T.danTunnel[gt][Rr+""].splice(0,1)}),{v:Rr%se}}},Rt=0;T.unlimited||Rt<se;Rt++){var Ir=yi(Rt);if(Ir!=="continue"&&Jr(Ir)==="object")return Ir.v}return-1};Object.prototype.toString.call(p)!=="[object Array]"&&(p=[p]);for(var ot=document.createDocumentFragment(),ht=function(){p[ut].type=be.number2Type(p[ut].type),p[ut].color||(p[ut].color=16777215);var it=document.createElement("div");it.classList.add("dplayer-danmaku-item"),it.classList.add("dplayer-danmaku-".concat(p[ut].type)),p[ut].border?it.innerHTML='<span style="border:'.concat(p[ut].border,'">').concat(p[ut].text,"</span>"):it.innerHTML=p[ut].text,it.style.opacity=T._opacity,it.style.color=be.number2Color(p[ut].color),it.addEventListener("animationend",function(){T.container.removeChild(it)});var gt,Et=T._measure(p[ut].text);switch(p[ut].type){case"right":(gt=Je(it,p[ut].type,Et))>=0&&(it.style.width=Et+1+"px",it.style.top=L*gt+"px",it.style.transform="translateX(-".concat(G,"px)"));break;case"top":(gt=Je(it,p[ut].type))>=0&&(it.style.top=L*gt+"px");break;case"bottom":(gt=Je(it,p[ut].type))>=0&&(it.style.bottom=L*gt+"px");break;default:console.error("Can't handled danmaku type: ".concat(p[ut].type))}gt>=0&&(it.classList.add("dplayer-danmaku-move"),it.style.animationDuration=T._danAnimation(p[ut].type),ot.appendChild(it))},ut=0;ut<p.length;ut++)ht();return this.container.appendChild(ot),ot}}},{key:"play",value:function(){this.paused=!1}},{key:"pause",value:function(){this.paused=!0}},{key:"_measure",value:function(p){if(!this.context){var T=getComputedStyle(this.container.getElementsByClassName("dplayer-danmaku-item")[0],null);this.context=document.createElement("canvas").getContext("2d"),this.context.font=T.getPropertyValue("font")}return this.context.measureText(p).width}},{key:"seek",value:function(){this.clear();for(var p=0;p<this.dan.length;p++){if(this.dan[p].time>=this.options.time()){this.danIndex=p;break}this.danIndex=this.dan.length}}},{key:"clear",value:function(){this.danTunnel={right:{},top:{},bottom:{}},this.danIndex=0,this.options.container.innerHTML="",this.events&&this.events.trigger("danmaku_clear")}},{key:"htmlEncode",value:function(p){return p.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2f;")}},{key:"resize",value:function(){for(var p=this.container.offsetWidth,T=this.container.getElementsByClassName("dplayer-danmaku-item"),L=0;L<T.length;L++)T[L].style.transform="translateX(-".concat(p,"px)")}},{key:"hide",value:function(){this.showing=!1,this.pause(),this.clear(),this.events&&this.events.trigger("danmaku_hide")}},{key:"show",value:function(){this.seek(),this.showing=!0,this.play(),this.events&&this.events.trigger("danmaku_show")}},{key:"unlimit",value:function(p){this.unlimited=p}},{key:"speed",value:function(p){this.options.api.speedRate=p}},{key:"_danAnimation",value:function(p){var T=this.options.api.speedRate||1,L=!!this.player.fullScreen.isFullScreen();return{top:"".concat((L?6:4)/T,"s"),right:"".concat((L?8:5)/T,"s"),bottom:"".concat((L?6:4)/T,"s")}[p]}}],M&&qu(b.prototype,M),Object.defineProperty(b,"prototype",{writable:!1}),m}();const Go=zu;function xs(m){return xs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},xs(m)}function Yu(m,b){for(var M=0;M<b.length;M++){var p=b[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(m,(T=function(L,G){if(xs(L)!=="object"||L===null)return L;var re=L[Symbol.toPrimitive];if(re!==void 0){var se=re.call(L,"string");if(xs(se)!=="object")return se;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(L)}(p.key),xs(T)==="symbol"?T:String(T)),p)}var T}const Hi=function(){function m(){(function(p,T){if(!(p instanceof T))throw new TypeError("Cannot call a class as a function")})(this,m),this.events={},this.videoEvents=["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","mozaudioavailable","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],this.playerEvents=["screenshot","thumbnails_show","thumbnails_hide","danmaku_show","danmaku_hide","danmaku_clear","danmaku_loaded","danmaku_send","danmaku_opacity","contextmenu_show","contextmenu_hide","notice_show","notice_hide","quality_start","quality_end","destroy","resize","fullscreen","fullscreen_cancel","webfullscreen","webfullscreen_cancel","subtitle_show","subtitle_hide","subtitle_change"]}var b,M;return b=m,(M=[{key:"on",value:function(p,T){this.type(p)&&typeof T=="function"&&(this.events[p]||(this.events[p]=[]),this.events[p].push(T))}},{key:"trigger",value:function(p,T){if(this.events[p]&&this.events[p].length)for(var L=0;L<this.events[p].length;L++)this.events[p][L](T)}},{key:"type",value:function(p){return this.playerEvents.indexOf(p)!==-1?"player":this.videoEvents.indexOf(p)!==-1?"video":(console.error("Unknown event name: ".concat(p)),null)}}])&&Yu(b.prototype,M),Object.defineProperty(b,"prototype",{writable:!1}),m}();function Mn(m){return Mn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},Mn(m)}function Ha(m,b){for(var M=0;M<b.length;M++){var p=b[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(m,(T=function(L,G){if(Mn(L)!=="object"||L===null)return L;var re=L[Symbol.toPrimitive];if(re!==void 0){var se=re.call(L,"string");if(Mn(se)!=="object")return se;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(L)}(p.key),Mn(T)==="symbol"?T:String(T)),p)}var T}var Xu=function(){function m(p){var T=this;(function(L,G){if(!(L instanceof G))throw new TypeError("Cannot call a class as a function")})(this,m),this.player=p,this.lastScrollPosition={left:0,top:0},this.player.events.on("webfullscreen",function(){T.player.resize()}),this.player.events.on("webfullscreen_cancel",function(){T.player.resize(),be.setScrollPosition(T.lastScrollPosition)}),this.fullscreenchange=function(){T.player.resize(),T.isFullScreen("browser")?T.player.events.trigger("fullscreen"):(be.setScrollPosition(T.lastScrollPosition),T.player.events.trigger("fullscreen_cancel"))},this.docfullscreenchange=function(){var L=document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;L&&L!==T.player.container||(T.player.resize(),L?T.player.events.trigger("fullscreen"):(be.setScrollPosition(T.lastScrollPosition),T.player.events.trigger("fullscreen_cancel")))},/Firefox/.test(navigator.userAgent)?(document.addEventListener("mozfullscreenchange",this.docfullscreenchange),document.addEventListener("fullscreenchange",this.docfullscreenchange)):(this.player.container.addEventListener("fullscreenchange",this.fullscreenchange),this.player.container.addEventListener("webkitfullscreenchange",this.fullscreenchange),document.addEventListener("msfullscreenchange",this.docfullscreenchange),document.addEventListener("MSFullscreenChange",this.docfullscreenchange))}var b,M;return b=m,M=[{key:"isFullScreen",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"browser";switch(p){case"browser":return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;case"web":return this.player.container.classList.contains("dplayer-fulled")}}},{key:"request",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"browser",T=p==="browser"?"web":"browser",L=this.isFullScreen(T);switch(L||(this.lastScrollPosition=be.getScrollPosition()),p){case"browser":this.player.container.requestFullscreen?this.player.container.requestFullscreen():this.player.container.mozRequestFullScreen?this.player.container.mozRequestFullScreen():this.player.container.webkitRequestFullscreen?this.player.container.webkitRequestFullscreen():this.player.video.webkitEnterFullscreen?this.player.video.webkitEnterFullscreen():this.player.video.webkitEnterFullScreen?this.player.video.webkitEnterFullScreen():this.player.container.msRequestFullscreen&&this.player.container.msRequestFullscreen();break;case"web":this.player.container.classList.add("dplayer-fulled"),document.body.classList.add("dplayer-web-fullscreen-fix"),this.player.events.trigger("webfullscreen")}L&&this.cancel(T)}},{key:"cancel",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"browser";switch(p){case"browser":document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.webkitCancelFullscreen?document.webkitCancelFullscreen():document.msCancelFullScreen?document.msCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen();break;case"web":this.player.container.classList.remove("dplayer-fulled"),document.body.classList.remove("dplayer-web-fullscreen-fix"),this.player.events.trigger("webfullscreen_cancel")}}},{key:"toggle",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"browser";this.isFullScreen(p)?this.cancel(p):this.request(p)}},{key:"destroy",value:function(){/Firefox/.test(navigator.userAgent)?(document.removeEventListener("mozfullscreenchange",this.docfullscreenchange),document.removeEventListener("fullscreenchange",this.docfullscreenchange)):(this.player.container.removeEventListener("fullscreenchange",this.fullscreenchange),this.player.container.removeEventListener("webkitfullscreenchange",this.fullscreenchange),document.removeEventListener("msfullscreenchange",this.docfullscreenchange),document.removeEventListener("MSFullscreenChange",this.docfullscreenchange))}}],M&&Ha(b.prototype,M),Object.defineProperty(b,"prototype",{writable:!1}),m}();const Wa=Xu;function Es(m){return Es=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},Es(m)}function ea(m,b){for(var M=0;M<b.length;M++){var p=b[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(m,(T=function(L,G){if(Es(L)!=="object"||L===null)return L;var re=L[Symbol.toPrimitive];if(re!==void 0){var se=re.call(L,"string");if(Es(se)!=="object")return se;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(L)}(p.key),Es(T)==="symbol"?T:String(T)),p)}var T}var Vo=function(){function m(p){(function(T,L){if(!(T instanceof L))throw new TypeError("Cannot call a class as a function")})(this,m),this.storageName={opacity:"dplayer-danmaku-opacity",volume:"dplayer-volume",unlimited:"dplayer-danmaku-unlimited",danmaku:"dplayer-danmaku-show",subtitle:"dplayer-subtitle-show"},this.default={opacity:.7,volume:p.options.hasOwnProperty("volume")?p.options.volume:.7,unlimited:(p.options.danmaku&&p.options.danmaku.unlimited?1:0)||0,danmaku:1,subtitle:1},this.data={},this.init()}var b,M;return b=m,(M=[{key:"init",value:function(){for(var p in this.storageName){var T=this.storageName[p];this.data[p]=parseFloat(be.storage.get(T)||this.default[p])}}},{key:"get",value:function(p){return this.data[p]}},{key:"set",value:function(p,T){this.data[p]=T,be.storage.set(this.storageName[p],T)}}])&&ea(b.prototype,M),Object.defineProperty(b,"prototype",{writable:!1}),m}();const Xn=Vo;function cn(m){return cn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},cn(m)}function Qu(m,b){for(var M=0;M<b.length;M++){var p=b[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(m,(T=function(L,G){if(cn(L)!=="object"||L===null)return L;var re=L[Symbol.toPrimitive];if(re!==void 0){var se=re.call(L,"string");if(cn(se)!=="object")return se;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(L)}(p.key),cn(T)==="symbol"?T:String(T)),p)}var T}var Ho=function(){function m(p,T,L,G){(function(re,se){if(!(re instanceof se))throw new TypeError("Cannot call a class as a function")})(this,m),this.container=p,this.video=T,this.options=L,this.events=G,this.init()}var b,M;return b=m,M=[{key:"init",value:function(){var p=this;if(this.container.style.fontSize=this.options.fontSize,this.container.style.bottom=this.options.bottom,this.container.style.color=this.options.color,this.video.textTracks&&this.video.textTracks[0]){var T=this.video.textTracks[0];T.oncuechange=function(){var L=T.activeCues[T.activeCues.length-1];if(p.container.innerHTML="",L){var G=document.createElement("div");G.appendChild(L.getCueAsHTML());var re=G.innerHTML.split(/\r?\n/).map(function(se){return"<p>".concat(se,"</p>")}).join("");p.container.innerHTML=re}p.events.trigger("subtitle_change")}}}},{key:"show",value:function(){this.container.classList.remove("dplayer-subtitle-hide"),this.events.trigger("subtitle_show")}},{key:"hide",value:function(){this.container.classList.add("dplayer-subtitle-hide"),this.events.trigger("subtitle_hide")}},{key:"toggle",value:function(){this.container.classList.contains("dplayer-subtitle-hide")?this.show():this.hide()}}],M&&Qu(b.prototype,M),Object.defineProperty(b,"prototype",{writable:!1}),m}();const Zu=Ho;function hr(m){return hr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},hr(m)}function ta(m,b){for(var M=0;M<b.length;M++){var p=b[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(m,(T=function(L,G){if(hr(L)!=="object"||L===null)return L;var re=L[Symbol.toPrimitive];if(re!==void 0){var se=re.call(L,"string");if(hr(se)!=="object")return se;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(L)}(p.key),hr(T)==="symbol"?T:String(T)),p)}var T}var Wo=function(){function m(p){var T=this;(function(se,Le){if(!(se instanceof Le))throw new TypeError("Cannot call a class as a function")})(this,m),this.player=p,this.player.template.mask.addEventListener("click",function(){T.hide()}),this.player.template.subtitlesButton.addEventListener("click",function(){T.adaptiveHeight(),T.show()});for(var L=this.player.template.subtitlesItem.length-1,G=function(se){T.player.template.subtitlesItem[se].addEventListener("click",function(){T.hide(),T.player.options.subtitle.index!==se&&(T.player.template.subtitle.innerHTML="<p></p>",T.player.template.subtrack.src=T.player.template.subtitlesItem[se].dataset.subtitle,T.player.options.subtitle.index=se,T.player.template.subtitle.classList.contains("dplayer-subtitle-hide")&&T.subContainerShow())})},re=0;re<L;re++)G(re);this.player.template.subtitlesItem[L].addEventListener("click",function(){T.hide(),T.player.options.subtitle.index!==L&&(T.player.template.subtitle.innerHTML="<p></p>",T.player.template.subtrack.src="",T.player.options.subtitle.index=L,T.subContainerHide())})}var b,M;return b=m,(M=[{key:"subContainerShow",value:function(){this.player.template.subtitle.classList.remove("dplayer-subtitle-hide"),this.player.events.trigger("subtitle_show")}},{key:"subContainerHide",value:function(){this.player.template.subtitle.classList.add("dplayer-subtitle-hide"),this.player.events.trigger("subtitle_hide")}},{key:"hide",value:function(){this.player.template.subtitlesBox.classList.remove("dplayer-subtitles-box-open"),this.player.template.mask.classList.remove("dplayer-mask-show"),this.player.controller.disableAutoHide=!1}},{key:"show",value:function(){this.player.template.subtitlesBox.classList.add("dplayer-subtitles-box-open"),this.player.template.mask.classList.add("dplayer-mask-show"),this.player.controller.disableAutoHide=!0}},{key:"adaptiveHeight",value:function(){var p=30*this.player.template.subtitlesItem.length+14,T=.8*this.player.template.videoWrap.offsetHeight;p>=T-50?(this.player.template.subtitlesBox.style.bottom="8px",this.player.template.subtitlesBox.style["max-height"]=T-8+"px"):(this.player.template.subtitlesBox.style.bottom="50px",this.player.template.subtitlesBox.style["max-height"]=T-50+"px")}}])&&ta(b.prototype,M),Object.defineProperty(b,"prototype",{writable:!1}),m}();const Ts=Wo;function Oi(m){return Oi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},Oi(m)}function Ju(m,b){for(var M=0;M<b.length;M++){var p=b[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(m,(T=function(L,G){if(Oi(L)!=="object"||L===null)return L;var re=L[Symbol.toPrimitive];if(re!==void 0){var se=re.call(L,"string");if(Oi(se)!=="object")return se;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(L)}(p.key),Oi(T)==="symbol"?T:String(T)),p)}var T}var Ko=function(){function m(p){(function(T,L){if(!(T instanceof L))throw new TypeError("Cannot call a class as a function")})(this,m),this.elements={},this.elements.volume=p.volumeBar,this.elements.played=p.playedBar,this.elements.loaded=p.loadedBar,this.elements.danmaku=p.danmakuOpacityBar}var b,M;return b=m,(M=[{key:"set",value:function(p,T,L){T=Math.max(T,0),T=Math.min(T,1),this.elements[p].style[L]=100*T+"%"}},{key:"get",value:function(p){return parseFloat(this.elements[p].style.width)/100}}])&&Ju(b.prototype,M),Object.defineProperty(b,"prototype",{writable:!1}),m}();const Ut=Ko;function es(m){return es=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},es(m)}function ed(m,b){for(var M=0;M<b.length;M++){var p=b[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(m,(T=function(L,G){if(es(L)!=="object"||L===null)return L;var re=L[Symbol.toPrimitive];if(re!==void 0){var se=re.call(L,"string");if(es(se)!=="object")return se;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(L)}(p.key),es(T)==="symbol"?T:String(T)),p)}var T}var qo=function(){function m(p){(function(T,L){if(!(T instanceof L))throw new TypeError("Cannot call a class as a function")})(this,m),this.player=p,window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(T){window.setTimeout(T,1e3/60)},this.types=["loading","info","fps"],this.init()}var b,M;return b=m,(M=[{key:"init",value:function(){var p=this;this.types.map(function(T){return T!=="fps"&&p["init".concat(T,"Checker")](),T})}},{key:"initloadingChecker",value:function(){var p=this,T=0,L=0,G=!1;this.loadingChecker=setInterval(function(){p.enableloadingChecker&&(L=p.player.video.currentTime,G||L!==T||p.player.video.paused||(p.player.container.classList.add("dplayer-loading"),G=!0),G&&L>T&&!p.player.video.paused&&(p.player.container.classList.remove("dplayer-loading"),G=!1),T=L)},100)}},{key:"initfpsChecker",value:function(){var p=this;window.requestAnimationFrame(function(){if(p.enablefpsChecker)if(p.initfpsChecker(),p.fpsStart){p.fpsIndex++;var T=new Date;T-p.fpsStart>1e3&&(p.player.infoPanel.fps(p.fpsIndex/(T-p.fpsStart)*1e3),p.fpsStart=new Date,p.fpsIndex=0)}else p.fpsStart=new Date,p.fpsIndex=0;else p.fpsStart=0,p.fpsIndex=0})}},{key:"initinfoChecker",value:function(){var p=this;this.infoChecker=setInterval(function(){p.enableinfoChecker&&p.player.infoPanel.update()},1e3)}},{key:"enable",value:function(p){this["enable".concat(p,"Checker")]=!0,p==="fps"&&this.initfpsChecker()}},{key:"disable",value:function(p){this["enable".concat(p,"Checker")]=!1}},{key:"destroy",value:function(){var p=this;this.types.map(function(T){return p["enable".concat(T,"Checker")]=!1,p["".concat(T,"Checker")]&&clearInterval(p["".concat(T,"Checker")]),T})}}])&&ed(b.prototype,M),Object.defineProperty(b,"prototype",{writable:!1}),m}();const ts=qo;function is(m){return is=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},is(m)}function Nn(m,b){for(var M=0;M<b.length;M++){var p=b[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(m,(T=function(L,G){if(is(L)!=="object"||L===null)return L;var re=L[Symbol.toPrimitive];if(re!==void 0){var se=re.call(L,"string");if(is(se)!=="object")return se;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(L)}(p.key),is(T)==="symbol"?T:String(T)),p)}var T}const ns=function(){function m(p){var T=this;(function(L,G){if(!(L instanceof G))throw new TypeError("Cannot call a class as a function")})(this,m),this.container=p,this.container.addEventListener("animationend",function(){T.container.classList.remove("dplayer-bezel-transition")})}var b,M;return b=m,(M=[{key:"switch",value:function(p){this.container.innerHTML=p,this.container.classList.add("dplayer-bezel-transition")}}])&&Nn(b.prototype,M),Object.defineProperty(b,"prototype",{writable:!1}),m}();function Xt(m){return Xt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},Xt(m)}function ia(m,b){for(var M=0;M<b.length;M++){var p=b[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(m,(T=function(L,G){if(Xt(L)!=="object"||L===null)return L;var re=L[Symbol.toPrimitive];if(re!==void 0){var se=re.call(L,"string");if(Xt(se)!=="object")return se;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(L)}(p.key),Xt(T)==="symbol"?T:String(T)),p)}var T}var td=function(){function m(p){(function(T,L){if(!(T instanceof L))throw new TypeError("Cannot call a class as a function")})(this,m),this.container=p.container,this.barWidth=p.barWidth,this.container.style.backgroundImage="url('".concat(p.url,"')"),this.events=p.events}var b,M;return b=m,(M=[{key:"resize",value:function(p,T,L){this.container.style.width="".concat(p,"px"),this.container.style.height="".concat(T,"px"),this.container.style.top="".concat(2-T,"px"),this.barWidth=L}},{key:"show",value:function(){this.container.style.display="block",this.events&&this.events.trigger("thumbnails_show")}},{key:"move",value:function(p){this.container.style.backgroundPosition="-".concat(160*(Math.ceil(p/this.barWidth*100)-1),"px 0"),this.container.style.left="".concat(Math.min(Math.max(p-this.container.offsetWidth/2,-10),this.barWidth-150),"px")}},{key:"hide",value:function(){this.container.style.display="none",this.events&&this.events.trigger("thumbnails_hide")}}])&&ia(b.prototype,M),Object.defineProperty(b,"prototype",{writable:!1}),m}();const Ka=td;function rs(m){return rs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},rs(m)}function Un(m,b){for(var M=0;M<b.length;M++){var p=b[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(m,(T=function(L,G){if(rs(L)!=="object"||L===null)return L;var re=L[Symbol.toPrimitive];if(re!==void 0){var se=re.call(L,"string");if(rs(se)!=="object")return se;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(L)}(p.key),rs(T)==="symbol"?T:String(T)),p)}var T}var Qn,qa=!0,fr=!1,ss=function(){function m(p){(function(T,L){if(!(T instanceof L))throw new TypeError("Cannot call a class as a function")})(this,m),this.player=p,this.autoHideTimer=0,be.isMobile||(this.setAutoHideHandler=this.setAutoHide.bind(this),this.player.container.addEventListener("mousemove",this.setAutoHideHandler),this.player.container.addEventListener("click",this.setAutoHideHandler),this.player.on("play",this.setAutoHideHandler),this.player.on("pause",this.setAutoHideHandler)),this.initPlayButton(),this.initThumbnails(),this.initPlayedBar(),this.initFullButton(),this.initQualityButton(),this.initScreenshotButton(),this.player.options.subtitle&&typeof this.player.options.subtitle.url=="string"&&this.initSubtitleButton(),this.initHighlights(),this.initAirplayButton(),this.initChromecastButton(),be.isMobile||this.initVolumeButton()}var b,M;return b=m,(M=[{key:"initPlayButton",value:function(){var p=this;this.player.template.playButton.addEventListener("click",function(){p.player.toggle()}),this.player.template.mobilePlayButton.addEventListener("click",function(){p.player.toggle()}),be.isMobile?(this.player.template.videoWrap.addEventListener("click",function(){p.toggle()}),this.player.template.controllerMask.addEventListener("click",function(){p.toggle()})):this.player.options.preventClickToggle||(this.player.template.videoWrap.addEventListener("click",function(){p.player.toggle()}),this.player.template.controllerMask.addEventListener("click",function(){p.player.toggle()}))}},{key:"initHighlights",value:function(){var p=this;this.player.on("durationchange",function(){if(p.player.video.duration!==1&&p.player.video.duration!==1/0&&p.player.options.highlight){var T=p.player.template.playedBarWrap.querySelectorAll(".dplayer-highlight");[].slice.call(T,0).forEach(function(re){p.player.template.playedBarWrap.removeChild(re)});for(var L=0;L<p.player.options.highlight.length;L++)if(p.player.options.highlight[L].text&&p.player.options.highlight[L].time){var G=document.createElement("div");G.classList.add("dplayer-highlight"),G.style.left=p.player.options.highlight[L].time/p.player.video.duration*100+"%",G.innerHTML='<span class="dplayer-highlight-text">'+p.player.options.highlight[L].text+"</span>",p.player.template.playedBarWrap.insertBefore(G,p.player.template.playedBarTime)}}})}},{key:"initThumbnails",value:function(){var p=this;this.player.options.video.thumbnails&&(this.thumbnails=new Ka({container:this.player.template.barPreview,barWidth:this.player.template.barWrap.offsetWidth,url:this.player.options.video.thumbnails,events:this.player.events}),this.player.on("loadedmetadata",function(){p.thumbnails.resize(160,p.player.video.videoHeight/p.player.video.videoWidth*160,p.player.template.barWrap.offsetWidth)}))}},{key:"initPlayedBar",value:function(){var p=this,T=function(G){var re=((G.clientX||G.changedTouches[0].clientX)-be.getBoundingClientRectViewLeft(p.player.template.playedBarWrap))/p.player.template.playedBarWrap.clientWidth;re=Math.max(re,0),re=Math.min(re,1),p.player.bar.set("played",re,"width"),p.player.template.ptime.innerHTML=be.secondToTime(re*p.player.video.duration)},L=function G(re){document.removeEventListener(be.nameMap.dragEnd,G),document.removeEventListener(be.nameMap.dragMove,T);var se=((re.clientX||re.changedTouches[0].clientX)-be.getBoundingClientRectViewLeft(p.player.template.playedBarWrap))/p.player.template.playedBarWrap.clientWidth;se=Math.max(se,0),se=Math.min(se,1),p.player.bar.set("played",se,"width"),p.player.seek(p.player.bar.get("played")*p.player.video.duration),p.player.timer.enable("progress")};this.player.template.playedBarWrap.addEventListener(be.nameMap.dragStart,function(){p.player.timer.disable("progress"),document.addEventListener(be.nameMap.dragMove,T),document.addEventListener(be.nameMap.dragEnd,L)}),this.player.template.playedBarWrap.addEventListener(be.nameMap.dragMove,function(G){if(p.player.video.duration){var re=p.player.template.playedBarWrap.getBoundingClientRect().left,se=(G.clientX||G.changedTouches[0].clientX)-re;if(se<0||se>p.player.template.playedBarWrap.offsetWidth)return;var Le=p.player.video.duration*(se/p.player.template.playedBarWrap.offsetWidth);be.isMobile&&p.thumbnails&&p.thumbnails.show(),p.thumbnails&&p.thumbnails.move(se),p.player.template.playedBarTime.style.left="".concat(se-(Le>=3600?25:20),"px"),p.player.template.playedBarTime.innerText=be.secondToTime(Le),p.player.template.playedBarTime.classList.remove("hidden")}}),this.player.template.playedBarWrap.addEventListener(be.nameMap.dragEnd,function(){be.isMobile&&p.thumbnails&&p.thumbnails.hide()}),be.isMobile||(this.player.template.playedBarWrap.addEventListener("mouseenter",function(){p.player.video.duration&&(p.thumbnails&&p.thumbnails.show(),p.player.template.playedBarTime.classList.remove("hidden"))}),this.player.template.playedBarWrap.addEventListener("mouseleave",function(){p.player.video.duration&&(p.thumbnails&&p.thumbnails.hide(),p.player.template.playedBarTime.classList.add("hidden"))}))}},{key:"initFullButton",value:function(){var p=this;this.player.template.browserFullButton.addEventListener("click",function(){p.player.fullScreen.toggle("browser")}),this.player.template.webFullButton.addEventListener("click",function(){p.player.fullScreen.toggle("web")})}},{key:"initVolumeButton",value:function(){var p=this,T=function(G){var re=G||window.event,se=((re.clientX||re.changedTouches[0].clientX)-be.getBoundingClientRectViewLeft(p.player.template.volumeBarWrap)-5.5)/35;p.player.volume(se)},L=function G(){document.removeEventListener(be.nameMap.dragEnd,G),document.removeEventListener(be.nameMap.dragMove,T),p.player.template.volumeButton.classList.remove("dplayer-volume-active")};this.player.template.volumeBarWrapWrap.addEventListener("click",function(G){var re=G||window.event,se=((re.clientX||re.changedTouches[0].clientX)-be.getBoundingClientRectViewLeft(p.player.template.volumeBarWrap)-5.5)/35;p.player.volume(se)}),this.player.template.volumeBarWrapWrap.addEventListener(be.nameMap.dragStart,function(){document.addEventListener(be.nameMap.dragMove,T),document.addEventListener(be.nameMap.dragEnd,L),p.player.template.volumeButton.classList.add("dplayer-volume-active")}),this.player.template.volumeButtonIcon.addEventListener("click",function(){p.player.video.muted?(p.player.video.muted=!1,p.player.switchVolumeIcon(),p.player.bar.set("volume",p.player.volume(),"width")):(p.player.video.muted=!0,p.player.template.volumeIcon.innerHTML=Cn.volumeOff,p.player.bar.set("volume",0,"width"))})}},{key:"initQualityButton",value:function(){var p=this;this.player.options.video.quality&&this.player.template.qualityList.addEventListener("click",function(T){T.target.classList.contains("dplayer-quality-item")&&p.player.switchQuality(T.target.dataset.index)})}},{key:"initScreenshotButton",value:function(){var p=this;this.player.options.screenshot&&this.player.template.camareButton.addEventListener("click",function(){var T,L=document.createElement("canvas");L.width=p.player.video.videoWidth,L.height=p.player.video.videoHeight,L.getContext("2d").drawImage(p.player.video,0,0,L.width,L.height),L.toBlob(function(G){T=URL.createObjectURL(G);var re=document.createElement("a");re.href=T,re.download="DPlayer.png",re.style.display="none",document.body.appendChild(re),re.click(),document.body.removeChild(re),URL.revokeObjectURL(T),p.player.events.trigger("screenshot",T)})})}},{key:"initAirplayButton",value:function(){this.player.options.airplay&&(window.WebKitPlaybackTargetAvailabilityEvent?this.player.video.addEventListener("webkitplaybacktargetavailabilitychanged",function(p){p.availability==="available"?this.template.airplayButton.disable=!1:this.template.airplayButton.disable=!0,this.template.airplayButton.addEventListener("click",function(){this.video.webkitShowPlaybackTargetPicker()}.bind(this))}.bind(this.player)):this.player.template.airplayButton.style.display="none")}},{key:"initChromecast",value:function(){var p=window.document.createElement("script");p.setAttribute("type","text/javascript"),p.setAttribute("src","https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1"),window.document.body.appendChild(p),window.__onGCastApiAvailable=function(T){if(T){var L=new(Qn=window.chrome.cast).SessionRequest(Qn.media.DEFAULT_MEDIA_RECEIVER_APP_ID),G=new Qn.ApiConfig(L,function(){},function(re){re===Qn.ReceiverAvailability.AVAILABLE&&console.log("chromecast: ",re)});Qn.initialize(G,function(){})}}}},{key:"initChromecastButton",value:function(){var p=this;if(this.player.options.chromecast){qa&&(qa=!1,this.initChromecast());var T=function(G,re){p.currentMedia=re},L=function(G){console.error("Error launching media",G)};this.player.template.chromecastButton.addEventListener("click",function(){fr?(fr=!1,p.currentMedia.stop(),p.session.stop(),p.initChromecast()):(fr=!0,Qn.requestSession(function(G){var re,se,Le;p.session=G,re=p.player.options.video.url,se=new Qn.media.MediaInfo(re),Le=new Qn.media.LoadRequest(se),p.session?p.session.loadMedia(Le,T.bind(p,"loadMedia"),L).play():window.open(re)},function(G){G.code==="cancel"?p.session=void 0:console.error("Error selecting a cast device",G)}))})}}},{key:"initSubtitleButton",value:function(){var p=this;this.player.events.on("subtitle_show",function(){p.player.template.subtitleButton.dataset.balloon=p.player.tran("hide-subs"),p.player.template.subtitleButtonInner.style.opacity="",p.player.user.set("subtitle",1)}),this.player.events.on("subtitle_hide",function(){p.player.template.subtitleButton.dataset.balloon=p.player.tran("show-subs"),p.player.template.subtitleButtonInner.style.opacity="0.4",p.player.user.set("subtitle",0)}),this.player.template.subtitleButton.addEventListener("click",function(){p.player.subtitle.toggle()})}},{key:"setAutoHide",value:function(){var p=this;this.show(),clearTimeout(this.autoHideTimer),this.autoHideTimer=setTimeout(function(){!p.player.video.played.length||p.player.paused||p.disableAutoHide||p.hide()},3e3)}},{key:"show",value:function(){this.player.container.classList.remove("dplayer-hide-controller")}},{key:"hide",value:function(){this.player.container.classList.add("dplayer-hide-controller"),this.player.setting.hide(),this.player.comment&&this.player.comment.hide()}},{key:"isShow",value:function(){return!this.player.container.classList.contains("dplayer-hide-controller")}},{key:"toggle",value:function(){this.isShow()?this.hide():this.show()}},{key:"destroy",value:function(){be.isMobile||(this.player.container.removeEventListener("mousemove",this.setAutoHideHandler),this.player.container.removeEventListener("click",this.setAutoHideHandler)),clearTimeout(this.autoHideTimer)}}])&&Un(b.prototype,M),Object.defineProperty(b,"prototype",{writable:!1}),m}();const jn=ss;function kr(m){return kr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},kr(m)}function na(m,b){for(var M=0;M<b.length;M++){var p=b[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(m,(T=function(L,G){if(kr(L)!=="object"||L===null)return L;var re=L[Symbol.toPrimitive];if(re!==void 0){var se=re.call(L,"string");if(kr(se)!=="object")return se;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(L)}(p.key),kr(T)==="symbol"?T:String(T)),p)}var T}var zo=function(){function m(p){var T=this;(function(Le,Me){if(!(Le instanceof Me))throw new TypeError("Cannot call a class as a function")})(this,m),this.player=p,this.player.template.mask.addEventListener("click",function(){T.hide()}),this.player.template.settingButton.addEventListener("click",function(){T.show()}),this.loop=this.player.options.loop,this.player.template.loopToggle.checked=this.loop,this.player.template.loop.addEventListener("click",function(){T.player.template.loopToggle.checked=!T.player.template.loopToggle.checked,T.player.template.loopToggle.checked?T.loop=!0:T.loop=!1,T.hide()}),this.showDanmaku=this.player.user.get("danmaku"),this.showDanmaku||this.player.danmaku&&this.player.danmaku.hide(),this.player.template.showDanmakuToggle.checked=this.showDanmaku,this.player.template.showDanmaku.addEventListener("click",function(){T.player.template.showDanmakuToggle.checked=!T.player.template.showDanmakuToggle.checked,T.player.template.showDanmakuToggle.checked?(T.showDanmaku=!0,T.player.danmaku.show()):(T.showDanmaku=!1,T.player.danmaku.hide()),T.player.user.set("danmaku",T.showDanmaku?1:0),T.hide()}),this.unlimitDanmaku=this.player.user.get("unlimited"),this.player.template.unlimitDanmakuToggle.checked=this.unlimitDanmaku,this.player.template.unlimitDanmaku.addEventListener("click",function(){T.player.template.unlimitDanmakuToggle.checked=!T.player.template.unlimitDanmakuToggle.checked,T.player.template.unlimitDanmakuToggle.checked?(T.unlimitDanmaku=!0,T.player.danmaku.unlimit(!0)):(T.unlimitDanmaku=!1,T.player.danmaku.unlimit(!1)),T.player.user.set("unlimited",T.unlimitDanmaku?1:0),T.hide()}),this.player.template.speed.addEventListener("click",function(){T.player.template.settingBox.classList.add("dplayer-setting-box-narrow"),T.player.template.settingBox.classList.add("dplayer-setting-box-speed")});for(var L=function(Le){T.player.template.speedItem[Le].addEventListener("click",function(){T.player.speed(T.player.template.speedItem[Le].dataset.speed),T.hide()})},G=0;G<this.player.template.speedItem.length;G++)L(G);if(this.player.danmaku){this.player.on("danmaku_opacity",function(Le){T.player.bar.set("danmaku",Le,"width"),T.player.user.set("opacity",Le)}),this.player.danmaku.opacity(this.player.user.get("opacity"));var re=function(Le){var Me=Le||window.event,Je=((Me.clientX||Me.changedTouches[0].clientX)-be.getBoundingClientRectViewLeft(T.player.template.danmakuOpacityBarWrap))/130;Je=Math.max(Je,0),Je=Math.min(Je,1),T.player.danmaku.opacity(Je)},se=function Le(){document.removeEventListener(be.nameMap.dragEnd,Le),document.removeEventListener(be.nameMap.dragMove,re),T.player.template.danmakuOpacityBox.classList.remove("dplayer-setting-danmaku-active")};this.player.template.danmakuOpacityBarWrapWrap.addEventListener("click",function(Le){var Me=Le||window.event,Je=((Me.clientX||Me.changedTouches[0].clientX)-be.getBoundingClientRectViewLeft(T.player.template.danmakuOpacityBarWrap))/130;Je=Math.max(Je,0),Je=Math.min(Je,1),T.player.danmaku.opacity(Je)}),this.player.template.danmakuOpacityBarWrapWrap.addEventListener(be.nameMap.dragStart,function(){document.addEventListener(be.nameMap.dragMove,re),document.addEventListener(be.nameMap.dragEnd,se),T.player.template.danmakuOpacityBox.classList.add("dplayer-setting-danmaku-active")})}}var b,M;return b=m,(M=[{key:"hide",value:function(){var p=this;this.player.template.settingBox.classList.remove("dplayer-setting-box-open"),this.player.template.mask.classList.remove("dplayer-mask-show"),setTimeout(function(){p.player.template.settingBox.classList.remove("dplayer-setting-box-narrow"),p.player.template.settingBox.classList.remove("dplayer-setting-box-speed")},300),this.player.controller.disableAutoHide=!1}},{key:"show",value:function(){this.player.template.settingBox.classList.add("dplayer-setting-box-open"),this.player.template.mask.classList.add("dplayer-mask-show"),this.player.controller.disableAutoHide=!0}}])&&na(b.prototype,M),Object.defineProperty(b,"prototype",{writable:!1}),m}();const ra=zo;function pr(m){return pr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},pr(m)}function sa(m,b){for(var M=0;M<b.length;M++){var p=b[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(m,(T=function(L,G){if(pr(L)!=="object"||L===null)return L;var re=L[Symbol.toPrimitive];if(re!==void 0){var se=re.call(L,"string");if(pr(se)!=="object")return se;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(L)}(p.key),pr(T)==="symbol"?T:String(T)),p)}var T}var aa=function(){function m(p){var T=this;(function(L,G){if(!(L instanceof G))throw new TypeError("Cannot call a class as a function")})(this,m),this.player=p,this.player.template.mask.addEventListener("click",function(){T.hide()}),this.player.template.commentButton.addEventListener("click",function(){T.show()}),this.player.template.commentSettingButton.addEventListener("click",function(){T.toggleSetting()}),this.player.template.commentColorSettingBox.addEventListener("click",function(){if(T.player.template.commentColorSettingBox.querySelector("input:checked+span")){var L=T.player.template.commentColorSettingBox.querySelector("input:checked").value;T.player.template.commentSettingFill.style.fill=L,T.player.template.commentInput.style.color=L,T.player.template.commentSendFill.style.fill=L}}),this.player.template.commentInput.addEventListener("click",function(){T.hideSetting()}),this.player.template.commentInput.addEventListener("keydown",function(L){(L||window.event).keyCode===13&&T.send()}),this.player.template.commentSendButton.addEventListener("click",function(){T.send()})}var b,M;return b=m,(M=[{key:"show",value:function(){this.player.controller.disableAutoHide=!0,this.player.template.controller.classList.add("dplayer-controller-comment"),this.player.template.mask.classList.add("dplayer-mask-show"),this.player.container.classList.add("dplayer-show-controller"),this.player.template.commentInput.focus()}},{key:"hide",value:function(){this.player.template.controller.classList.remove("dplayer-controller-comment"),this.player.template.mask.classList.remove("dplayer-mask-show"),this.player.container.classList.remove("dplayer-show-controller"),this.player.controller.disableAutoHide=!1,this.hideSetting()}},{key:"showSetting",value:function(){this.player.template.commentSettingBox.classList.add("dplayer-comment-setting-open")}},{key:"hideSetting",value:function(){this.player.template.commentSettingBox.classList.remove("dplayer-comment-setting-open")}},{key:"toggleSetting",value:function(){this.player.template.commentSettingBox.classList.contains("dplayer-comment-setting-open")?this.hideSetting():this.showSetting()}},{key:"send",value:function(){var p=this;this.player.template.commentInput.blur(),this.player.template.commentInput.value.replace(/^\s+|\s+$/g,"")?this.player.danmaku.send({text:this.player.template.commentInput.value,color:be.color2Number(this.player.container.querySelector(".dplayer-comment-setting-color input:checked").value),type:parseInt(this.player.container.querySelector(".dplayer-comment-setting-type input:checked").value)},function(){p.player.template.commentInput.value="",p.hide()}):this.player.notice(this.player.tran("please-input-danmaku"))}}])&&sa(b.prototype,M),Object.defineProperty(b,"prototype",{writable:!1}),m}();const Ss=aa;function $n(m){return $n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},$n(m)}function Wi(m,b){for(var M=0;M<b.length;M++){var p=b[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(m,(T=function(L,G){if($n(L)!=="object"||L===null)return L;var re=L[Symbol.toPrimitive];if(re!==void 0){var se=re.call(L,"string");if($n(se)!=="object")return se;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(L)}(p.key),$n(T)==="symbol"?T:String(T)),p)}var T}var oa=function(){function m(p){(function(T,L){if(!(T instanceof L))throw new TypeError("Cannot call a class as a function")})(this,m),this.player=p,this.doHotKeyHandler=this.doHotKey.bind(this),this.cancelFullScreenHandler=this.cancelFullScreen.bind(this),this.player.options.hotkey&&document.addEventListener("keydown",this.doHotKeyHandler),document.addEventListener("keydown",this.cancelFullScreenHandler)}var b,M;return b=m,(M=[{key:"doHotKey",value:function(p){if(this.player.focus){var T=document.activeElement.tagName.toUpperCase(),L=document.activeElement.getAttribute("contenteditable");if(T!=="INPUT"&&T!=="TEXTAREA"&&L!==""&&L!=="true"){var G,re=p||window.event;switch(re.keyCode){case 32:re.preventDefault(),this.player.toggle();break;case 37:if(re.preventDefault(),this.player.options.live)break;this.player.seek(this.player.video.currentTime-5),this.player.controller.setAutoHide();break;case 39:if(re.preventDefault(),this.player.options.live)break;this.player.seek(this.player.video.currentTime+5),this.player.controller.setAutoHide();break;case 38:re.preventDefault(),G=this.player.volume()+.1,this.player.volume(G);break;case 40:re.preventDefault(),G=this.player.volume()-.1,this.player.volume(G)}}}}},{key:"cancelFullScreen",value:function(p){(p||window.event).keyCode===27&&this.player.fullScreen.isFullScreen("web")&&this.player.fullScreen.cancel("web")}},{key:"destroy",value:function(){this.player.options.hotkey&&document.removeEventListener("keydown",this.doHotKeyHandler),document.removeEventListener("keydown",this.cancelFullScreenHandler)}}])&&Wi(b.prototype,M),Object.defineProperty(b,"prototype",{writable:!1}),m}();const id=oa;function as(m){return as=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},as(m)}function nd(m,b){for(var M=0;M<b.length;M++){var p=b[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(m,(T=function(L,G){if(as(L)!=="object"||L===null)return L;var re=L[Symbol.toPrimitive];if(re!==void 0){var se=re.call(L,"string");if(as(se)!=="object")return se;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(L)}(p.key),as(T)==="symbol"?T:String(T)),p)}var T}var os=function(){function m(p){var T=this;(function(L,G){if(!(L instanceof G))throw new TypeError("Cannot call a class as a function")})(this,m),this.player=p,this.shown=!1,Array.prototype.slice.call(this.player.template.menuItem).forEach(function(L,G){T.player.options.contextmenu[G].click&&L.addEventListener("click",function(){T.player.options.contextmenu[G].click(T.player),T.hide()})}),this.contextmenuHandler=function(L){if(T.shown)T.hide();else{var G=L||window.event;G.preventDefault();var re=T.player.container.getBoundingClientRect();T.show(G.clientX-re.left,G.clientY-re.top),T.player.template.mask.addEventListener("click",function(){T.hide()})}},this.player.container.addEventListener("contextmenu",this.contextmenuHandler)}var b,M;return b=m,(M=[{key:"show",value:function(p,T){this.player.template.menu.classList.add("dplayer-menu-show");var L=this.player.container.getBoundingClientRect();p+this.player.template.menu.offsetWidth>=L.width?(this.player.template.menu.style.right=L.width-p+"px",this.player.template.menu.style.left="initial"):(this.player.template.menu.style.left=p+"px",this.player.template.menu.style.right="initial"),T+this.player.template.menu.offsetHeight>=L.height?(this.player.template.menu.style.bottom=L.height-T+"px",this.player.template.menu.style.top="initial"):(this.player.template.menu.style.top=T+"px",this.player.template.menu.style.bottom="initial"),this.player.template.mask.classList.add("dplayer-mask-show"),this.shown=!0,this.player.events.trigger("contextmenu_show")}},{key:"hide",value:function(){this.player.template.mask.classList.remove("dplayer-mask-show"),this.player.template.menu.classList.remove("dplayer-menu-show"),this.shown=!1,this.player.events.trigger("contextmenu_hide")}},{key:"destroy",value:function(){this.player.container.removeEventListener("contextmenu",this.contextmenuHandler)}}])&&nd(b.prototype,M),Object.defineProperty(b,"prototype",{writable:!1}),m}();const ls=os;function us(m){return us=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},us(m)}function Yo(m,b){for(var M=0;M<b.length;M++){var p=b[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(m,(T=function(L,G){if(us(L)!=="object"||L===null)return L;var re=L[Symbol.toPrimitive];if(re!==void 0){var se=re.call(L,"string");if(us(se)!=="object")return se;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(L)}(p.key),us(T)==="symbol"?T:String(T)),p)}var T}var Bt=function(){function m(p){var T=this;(function(L,G){if(!(L instanceof G))throw new TypeError("Cannot call a class as a function")})(this,m),this.container=p.template.infoPanel,this.template=p.template,this.video=p.video,this.player=p,this.template.infoPanelClose.addEventListener("click",function(){T.hide()})}var b,M;return b=m,(M=[{key:"show",value:function(){this.beginTime=Date.now(),this.update(),this.player.timer.enable("info"),this.player.timer.enable("fps"),this.container.classList.remove("dplayer-info-panel-hide")}},{key:"hide",value:function(){this.player.timer.disable("info"),this.player.timer.disable("fps"),this.container.classList.add("dplayer-info-panel-hide")}},{key:"triggle",value:function(){this.container.classList.contains("dplayer-info-panel-hide")?this.show():this.hide()}},{key:"update",value:function(){this.template.infoVersion.innerHTML="v".concat("1.27.1"," ").concat("v1.27.0-12-g4f61091"),this.template.infoType.innerHTML=this.player.type,this.template.infoUrl.innerHTML=this.player.options.video.url,this.template.infoResolution.innerHTML="".concat(this.player.video.videoWidth," x ").concat(this.player.video.videoHeight),this.template.infoDuration.innerHTML=this.player.video.duration,this.player.options.danmaku&&(this.template.infoDanmakuId.innerHTML=this.player.options.danmaku.id,this.template.infoDanmakuApi.innerHTML=this.player.options.danmaku.api,this.template.infoDanmakuAmount.innerHTML=this.player.danmaku.dan.length)}},{key:"fps",value:function(p){this.template.infoFPS.innerHTML="".concat(p.toFixed(1))}}])&&Yo(b.prototype,M),Object.defineProperty(b,"prototype",{writable:!1}),m}();const mr=Bt;var za=Oe(568),Cs=Oe.n(za);function wn(m){return wn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},wn(m)}function ws(m,b){var M=Object.keys(m);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(m);b&&(p=p.filter(function(T){return Object.getOwnPropertyDescriptor(m,T).enumerable})),M.push.apply(M,p)}return M}function Xo(m,b,M){return(b=Zn(b))in m?Object.defineProperty(m,b,{value:M,enumerable:!0,configurable:!0,writable:!0}):m[b]=M,m}function Ya(m,b){for(var M=0;M<b.length;M++){var p=b[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(m,Zn(p.key),p)}}function Zn(m){var b=function(M,p){if(wn(M)!=="object"||M===null)return M;var T=M[Symbol.toPrimitive];if(T!==void 0){var L=T.call(M,"string");if(wn(L)!=="object")return L;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(M)}(m);return wn(b)==="symbol"?b:String(b)}var Xa=0,Ln=[],la=function(){function m(T){var L=this;(function(G,re){if(!(G instanceof re))throw new TypeError("Cannot call a class as a function")})(this,m),this.options=function(G){var re={container:G.element||document.getElementsByClassName("dplayer")[0],live:!1,autoplay:!1,theme:"#b7daff",loop:!1,lang:(navigator.language||navigator.browserLanguage).toLowerCase(),screenshot:!1,airplay:!0,chromecast:!1,hotkey:!0,preload:"metadata",volume:.7,playbackSpeed:[.5,.75,1,1.25,1.5,2],apiBackend:Du,video:{},contextmenu:[],mutex:!0,pluginOptions:{hls:{},flv:{},dash:{},webtorrent:{}},preventClickToggle:!1};for(var se in re)re.hasOwnProperty(se)&&!G.hasOwnProperty(se)&&(G[se]=re[se]);return G.video&&!G.video.type&&(G.video.type="auto"),Na(G.danmaku)==="object"&&G.danmaku&&!G.danmaku.user&&(G.danmaku.user="DIYgod"),G.subtitle&&(!G.subtitle.type&&(G.subtitle.type="webvtt"),!G.subtitle.fontSize&&(G.subtitle.fontSize="20px"),!G.subtitle.bottom&&(G.subtitle.bottom="40px"),!G.subtitle.color&&(G.subtitle.color="#fff")),G.video.quality&&(G.video.url=G.video.quality[G.video.defaultQuality].url),G.lang&&(G.lang=G.lang.toLowerCase()),G.contextmenu=G.contextmenu.concat([{key:"video-info",click:function(Le){Le.infoPanel.triggle()}},{key:"about-author",link:"https://diygod.me"},{text:"DPlayer v".concat("1.27.1"),link:"https://github.com/MoePlayer/DPlayer"}]),G}(function(G){for(var re=1;re<arguments.length;re++){var se=arguments[re]!=null?arguments[re]:{};re%2?ws(Object(se),!0).forEach(function(Le){Xo(G,Le,se[Le])}):Object.getOwnPropertyDescriptors?Object.defineProperties(G,Object.getOwnPropertyDescriptors(se)):ws(Object(se)).forEach(function(Le){Object.defineProperty(G,Le,Object.getOwnPropertyDescriptor(se,Le))})}return G}({preload:T.video.type==="webtorrent"?"none":"metadata"},T)),this.options.video.quality&&(this.qualityIndex=this.options.video.defaultQuality,this.quality=this.options.video.quality[this.options.video.defaultQuality]),this.tran=new ku(this.options.lang).tran,this.events=new Hi,this.user=new Xn(this),this.container=this.options.container,this.noticeList={},this.container.classList.add("dplayer"),this.options.danmaku||this.container.classList.add("dplayer-no-danmaku"),this.options.live?this.container.classList.add("dplayer-live"):this.container.classList.remove("dplayer-live"),be.isMobile&&this.container.classList.add("dplayer-mobile"),this.arrow=this.container.offsetWidth<=500,this.arrow&&this.container.classList.add("dplayer-arrow"),this.options.subtitle&&Array.isArray(this.options.subtitle.url)&&(this.options.subtitle.url.push({subtitle:"",lang:"off"}),this.options.subtitle.defaultSubtitle&&(typeof this.options.subtitle.defaultSubtitle=="string"?this.options.subtitle.index=this.options.subtitle.url.findIndex(function(G){return G.lang===L.options.subtitle.defaultSubtitle||G.name===L.options.subtitle.defaultSubtitle}):typeof this.options.subtitle.defaultSubtitle=="number"&&(this.options.subtitle.index=this.options.subtitle.defaultSubtitle)),(this.options.subtitle.index===-1||!this.options.subtitle.index||this.options.subtitle.index>this.options.subtitle.url.length-1)&&(this.options.subtitle.index=this.options.subtitle.url.findIndex(function(G){return G.lang===L.options.lang})),this.options.subtitle.index===-1&&(this.options.subtitle.index=this.options.subtitle.url.length-1)),this.template=new $o({container:this.container,options:this.options,index:Xa,tran:this.tran}),this.video=this.template.video,this.bar=new Ut(this.template),this.bezel=new ns(this.template.bezel),this.fullScreen=new Wa(this),this.controller=new jn(this),this.options.danmaku&&(this.danmaku=new Go({player:this,container:this.template.danmaku,opacity:this.user.get("opacity"),callback:function(){setTimeout(function(){L.template.danmakuLoading.style.display="none",L.options.autoplay&&L.play()},0)},error:function(G){L.notice(G)},apiBackend:this.options.apiBackend,borderColor:this.options.theme,height:this.arrow?24:30,time:function(){return L.video.currentTime},unlimited:this.user.get("unlimited"),api:{id:this.options.danmaku.id,address:this.options.danmaku.api,token:this.options.danmaku.token,maximum:this.options.danmaku.maximum,addition:this.options.danmaku.addition,user:this.options.danmaku.user,speedRate:this.options.danmaku.speedRate},events:this.events,tran:function(G){return L.tran(G)}}),this.comment=new Ss(this)),this.setting=new ra(this),this.plugins={},this.docClickFun=function(){L.focus=!1},this.containerClickFun=function(){L.focus=!0},document.addEventListener("click",this.docClickFun,!0),this.container.addEventListener("click",this.containerClickFun,!0),this.paused=!0,this.timer=new ts(this),this.hotkey=new id(this),this.contextmenu=new ls(this),this.initVideo(this.video,this.quality&&this.quality.type||this.options.video.type),this.infoPanel=new mr(this),!this.danmaku&&this.options.autoplay&&this.play(),Xa++,Ln.push(this)}var b,M,p;return b=m,M=[{key:"seek",value:function(T){T=Math.max(T,0),this.video.duration&&(T=Math.min(T,this.video.duration)),this.video.currentTime<T?this.notice("".concat(this.tran("ff").replace("%s",(T-this.video.currentTime).toFixed(0)))):this.video.currentTime>T&&this.notice("".concat(this.tran("rew").replace("%s",(this.video.currentTime-T).toFixed(0)))),this.video.currentTime=T,this.danmaku&&this.danmaku.seek(),this.bar.set("played",T/this.video.duration,"width"),this.template.ptime.innerHTML=be.secondToTime(T)}},{key:"play",value:function(T){var L=this;if(this.paused=!1,this.video.paused&&!be.isMobile&&this.bezel.switch(Cn.play),this.template.playButton.innerHTML=Cn.pause,this.template.mobilePlayButton.innerHTML=Cn.pause,T||ve.resolve(this.video.play()).catch(function(){L.pause()}).then(function(){}),this.timer.enable("loading"),this.container.classList.remove("dplayer-paused"),this.container.classList.add("dplayer-playing"),this.danmaku&&this.danmaku.play(),this.options.mutex)for(var G=0;G<Ln.length;G++)this!==Ln[G]&&Ln[G].pause()}},{key:"pause",value:function(T){this.paused=!0,this.container.classList.remove("dplayer-loading"),this.video.paused||be.isMobile||this.bezel.switch(Cn.pause),this.template.playButton.innerHTML=Cn.play,this.template.mobilePlayButton.innerHTML=Cn.play,T||this.video.pause(),this.timer.disable("loading"),this.container.classList.remove("dplayer-playing"),this.container.classList.add("dplayer-paused"),this.danmaku&&this.danmaku.pause()}},{key:"switchVolumeIcon",value:function(){this.volume()>=.95?this.template.volumeIcon.innerHTML=Cn.volumeUp:this.volume()>0?this.template.volumeIcon.innerHTML=Cn.volumeDown:this.template.volumeIcon.innerHTML=Cn.volumeOff}},{key:"volume",value:function(T,L,G){if(T=parseFloat(T),!isNaN(T)){T=Math.max(T,0),T=Math.min(T,1),this.bar.set("volume",T,"width");var re="".concat((100*T).toFixed(0),"%");this.template.volumeBarWrapWrap.dataset.balloon=re,L||this.user.set("volume",T),G||this.notice("".concat(this.tran("volume")," ").concat((100*T).toFixed(0),"%"),void 0,void 0,"volume"),this.video.volume=T,this.video.muted&&(this.video.muted=!1),this.switchVolumeIcon()}return this.video.volume}},{key:"toggle",value:function(){this.video.paused?this.play():this.pause()}},{key:"on",value:function(T,L){this.events.on(T,L)}},{key:"switchVideo",value:function(T,L){this.pause(),this.video.poster=T.pic?T.pic:"",this.video.src=T.url,this.initMSE(this.video,T.type||"auto"),L&&(this.template.danmakuLoading.style.display="block",this.bar.set("played",0,"width"),this.bar.set("loaded",0,"width"),this.template.ptime.innerHTML="00:00",this.template.danmaku.innerHTML="",this.danmaku&&this.danmaku.reload({id:L.id,address:L.api,token:L.token,maximum:L.maximum,addition:L.addition,user:L.user}))}},{key:"initMSE",value:function(T,L){var G=this;if(this.type=L,this.options.video.customType&&this.options.video.customType[L])Object.prototype.toString.call(this.options.video.customType[L])==="[object Function]"?this.options.video.customType[L](this.video,this):console.error("Illegal customType: ".concat(L));else switch(this.type==="auto"&&(/m3u8(#|\?|$)/i.exec(T.src)?this.type="hls":/.flv(#|\?|$)/i.exec(T.src)?this.type="flv":/.mpd(#|\?|$)/i.exec(T.src)?this.type="dash":this.type="normal"),this.type==="hls"&&(T.canPlayType("application/x-mpegURL")||T.canPlayType("application/vnd.apple.mpegURL"))&&(this.type="normal"),this.type){case"hls":if(window.Hls)if(window.Hls.isSupported()){var re=this.options.pluginOptions.hls,se=new window.Hls(re);this.plugins.hls=se,se.loadSource(T.src),se.attachMedia(T),this.events.on("destroy",function(){se.destroy(),delete G.plugins.hls})}else this.notice("Error: Hls is not supported.");else this.notice("Error: Can't find Hls.");break;case"flv":if(window.flvjs)if(window.flvjs.isSupported()){var Le=window.flvjs.createPlayer(Object.assign(this.options.pluginOptions.flv.mediaDataSource||{},{type:"flv",url:T.src}),this.options.pluginOptions.flv.config);this.plugins.flvjs=Le,Le.attachMediaElement(T),Le.load(),this.events.on("destroy",function(){Le.unload(),Le.detachMediaElement(),Le.destroy(),delete G.plugins.flvjs})}else this.notice("Error: flvjs is not supported.");else this.notice("Error: Can't find flvjs.");break;case"dash":if(window.dashjs){var Me=window.dashjs.MediaPlayer().create().initialize(T,T.src,!1),Je=this.options.pluginOptions.dash;Me.updateSettings(Je),this.plugins.dash=Me,this.events.on("destroy",function(){window.dashjs.MediaPlayer().reset(),delete G.plugins.dash})}else this.notice("Error: Can't find dashjs.");break;case"webtorrent":if(window.WebTorrent)if(window.WebTorrent.WEBRTC_SUPPORT){this.container.classList.add("dplayer-loading");var ot=this.options.pluginOptions.webtorrent,ht=new window.WebTorrent(ot);this.plugins.webtorrent=ht;var ut=T.src;T.src="",T.preload="metadata",T.addEventListener("durationchange",function(){return G.container.classList.remove("dplayer-loading")},{once:!0}),ht.add(ut,function(it){it.files.find(function(gt){return gt.name.endsWith(".mp4")}).renderTo(G.video,{autoplay:G.options.autoplay,controls:!1})}),this.events.on("destroy",function(){ht.remove(ut),ht.destroy(),delete G.plugins.webtorrent})}else this.notice("Error: Webtorrent is not supported.");else this.notice("Error: Can't find Webtorrent.")}}},{key:"initVideo",value:function(T,L){var G=this;this.initMSE(T,L),this.on("durationchange",function(){T.duration!==1&&T.duration!==1/0&&(G.template.dtime.innerHTML=be.secondToTime(T.duration))}),this.on("progress",function(){var Le=T.buffered.length?T.buffered.end(T.buffered.length-1)/T.duration:0;G.bar.set("loaded",Le,"width")}),this.on("error",function(){G.video.error&&G.tran&&G.notice&&G.type!=="webtorrent"&&G.notice(G.tran("video-failed"))}),this.on("ended",function(){G.bar.set("played",1,"width"),G.setting.loop?(G.seek(0),G.play()):G.pause(),G.danmaku&&(G.danmaku.danIndex=0)}),this.on("play",function(){G.paused&&G.play(!0)}),this.on("pause",function(){G.paused||G.pause(!0)}),this.on("timeupdate",function(){G.bar.set("played",G.video.currentTime/G.video.duration,"width");var Le=be.secondToTime(G.video.currentTime);G.template.ptime.innerHTML!==Le&&(G.template.ptime.innerHTML=Le)});for(var re=function(Le){T.addEventListener(G.events.videoEvents[Le],function(Me){G.events.trigger(G.events.videoEvents[Le],Me)})},se=0;se<this.events.videoEvents.length;se++)re(se);this.volume(this.user.get("volume"),!0,!0),this.options.subtitle&&(this.subtitle=new Zu(this.template.subtitle,this.video,this.options.subtitle,this.events),Array.isArray(this.options.subtitle.url)&&(this.subtitles=new Ts(this)),this.user.get("subtitle")||this.subtitle.hide())}},{key:"switchQuality",value:function(T){var L=this;if(T=typeof T=="string"?parseInt(T):T,this.qualityIndex!==T&&!this.switchingQuality){this.prevIndex=this.qualityIndex,this.qualityIndex=T,this.switchingQuality=!0,this.quality=this.options.video.quality[T],this.template.qualityButton.innerHTML=this.quality.name;var G=this.video.paused;this.video.pause();var re=Cs()({current:!1,pic:null,screenshot:this.options.screenshot,preload:"auto",url:this.quality.url,subtitle:this.options.subtitle}),se=new DOMParser().parseFromString(re,"text/html").body.firstChild;this.template.videoWrap.insertBefore(se,this.template.videoWrap.getElementsByTagName("div")[0]),this.prevVideo=this.video,this.video=se,this.initVideo(this.video,this.quality.type||this.options.video.type),this.seek(this.prevVideo.currentTime),this.notice("".concat(this.tran("switching-quality").replace("%q",this.quality.name)),-1,void 0,"switch-quality"),this.events.trigger("quality_start",this.quality),this.on("canplay",function(){if(L.prevVideo){if(L.video.currentTime!==L.prevVideo.currentTime)return void L.seek(L.prevVideo.currentTime);L.template.videoWrap.removeChild(L.prevVideo),L.video.classList.add("dplayer-video-current"),G||L.video.play(),L.prevVideo=null,L.notice("".concat(L.tran("switched-quality").replace("%q",L.quality.name)),void 0,void 0,"switch-quality"),L.switchingQuality=!1,L.events.trigger("quality_end")}}),this.on("error",function(){L.video.error&&L.prevVideo&&(L.template.videoWrap.removeChild(L.video),L.video=L.prevVideo,G||L.video.play(),L.qualityIndex=L.prevIndex,L.quality=L.options.video.quality[L.qualityIndex],L.noticeTime=setTimeout(function(){L.template.notice.style.opacity=0,L.events.trigger("notice_hide")},3e3),L.prevVideo=null,L.switchingQuality=!1)})}}},{key:"notice",value:function(T){var L,G,re,se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2e3,Le=arguments.length>2&&arguments[2]!==void 0?arguments[2]:.8,Me=arguments.length>3?arguments[3]:void 0;if(Me&&((L=document.getElementById("dplayer-notice-".concat(Me)))&&(L.innerHTML=T),this.noticeList[Me]&&(clearTimeout(this.noticeList[Me]),this.noticeList[Me]=null)),!L){var Je=$o.NewNotice(T,Le,Me);this.template.noticeList.appendChild(Je),L=Je}this.events.trigger("notice_show",L),se>0&&(this.noticeList[Me]=setTimeout((G=L,re=this,function(){G.addEventListener("animationend",function(){re.template.noticeList.removeChild(G)}),G.classList.add("remove-notice"),re.events.trigger("notice_hide"),re.noticeList[Me]=null}),se))}},{key:"resize",value:function(){this.danmaku&&this.danmaku.resize(),this.controller.thumbnails&&this.controller.thumbnails.resize(160,this.video.videoHeight/this.video.videoWidth*160,this.template.barWrap.offsetWidth),this.events.trigger("resize")}},{key:"speed",value:function(T){this.video.playbackRate=T}},{key:"destroy",value:function(){Ln.splice(Ln.indexOf(this),1),this.pause(),document.removeEventListener("click",this.docClickFun,!0),this.container.removeEventListener("click",this.containerClickFun,!0),this.fullScreen.destroy(),this.hotkey.destroy(),this.contextmenu.destroy(),this.controller.destroy(),this.timer.destroy(),this.video.src="",this.container.innerHTML="",this.events.trigger("destroy")}}],p=[{key:"version",get:function(){return"1.27.1"}}],M&&Ya(b.prototype,M),p&&Ya(b,p),Object.defineProperty(b,"prototype",{writable:!1}),m}();const Qo=la;console.log(`
`.concat(" %c DPlayer v","1.27.1"," ").concat("v1.27.0-12-g4f61091"," %c https://dplayer.diygod.dev ",`
`,`
`),"color: #fadfa3; background: #030307; padding:5px 0;","background: #fadfa3; padding:5px 0;");const Zo=Qo})(),Ee.default})())},89144:function(Tt,yt,Ne){var We=typeof Ne.g!="undefined"?Ne.g:typeof window!="undefined"?window:{},rt=Ne(25893),q;typeof document!="undefined"?q=document:(q=We["__GLOBAL_DOCUMENT_CACHE@4"],q||(q=We["__GLOBAL_DOCUMENT_CACHE@4"]=rt)),Tt.exports=q},58908:function(Tt,yt,Ne){var We;typeof window!="undefined"?We=window:typeof Ne.g!="undefined"?We=Ne.g:typeof self!="undefined"?We=self:We={},Tt.exports=We},27376:function(Tt){Tt.exports=Ne;var yt=Object.prototype.toString;function Ne(We){if(!We)return!1;var rt=yt.call(We);return rt==="[object Function]"||typeof We=="function"&&rt!=="[object RegExp]"||typeof window!="undefined"&&(We===window.setTimeout||We===window.alert||We===window.confirm||We===window.prompt)}},27537:function(Tt,yt){function Ne(fe){if(fe&&typeof fe=="object"){var ce=fe.which||fe.keyCode||fe.charCode;ce&&(fe=ce)}if(typeof fe=="number")return Oe[fe];var le=String(fe),Z=We[le.toLowerCase()];if(Z)return Z;var Z=rt[le.toLowerCase()];if(Z)return Z;if(le.length===1)return le.charCodeAt(0)}Ne.isEventKey=function(ce,le){if(ce&&typeof ce=="object"){var Z=ce.which||ce.keyCode||ce.charCode;if(Z==null)return!1;if(typeof le=="string"){var oe=We[le.toLowerCase()];if(oe)return oe===Z;var oe=rt[le.toLowerCase()];if(oe)return oe===Z}else if(typeof le=="number")return le===Z;return!1}},yt=Tt.exports=Ne;var We=yt.code=yt.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},rt=yt.aliases={windows:91,"\u21E7":16,"\u2325":18,"\u2303":17,"\u2318":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};/*!
 * Programatically add the following
 */for(q=97;q<123;q++)We[String.fromCharCode(q)]=q-32;for(var q=48;q<58;q++)We[q-48]=q;for(q=1;q<13;q++)We["f"+q]=q+111;for(q=0;q<10;q++)We["numpad "+q]=q+96;var Oe=yt.names=yt.title={};for(q in We)Oe[We[q]]=q;for(var Ee in rt)We[Ee]=rt[Ee]},84221:function(Tt,yt,Ne){var We=Ne(46894).getUint64,rt=function(q){var Oe=new DataView(q.buffer,q.byteOffset,q.byteLength),Ee={version:q[0],flags:new Uint8Array(q.subarray(1,4)),references:[],referenceId:Oe.getUint32(4),timescale:Oe.getUint32(8)},fe=12;Ee.version===0?(Ee.earliestPresentationTime=Oe.getUint32(fe),Ee.firstOffset=Oe.getUint32(fe+4),fe+=8):(Ee.earliestPresentationTime=We(q.subarray(fe)),Ee.firstOffset=We(q.subarray(fe+8)),fe+=16),fe+=2;var ce=Oe.getUint16(fe);for(fe+=2;ce>0;fe+=12,ce--)Ee.references.push({referenceType:(q[fe]&128)>>>7,referencedSize:Oe.getUint32(fe)&2147483647,subsegmentDuration:Oe.getUint32(fe+4),startsWithSap:!!(q[fe+8]&128),sapType:(q[fe+8]&112)>>>4,sapDeltaTime:Oe.getUint32(fe+8)&268435455});return Ee};Tt.exports=rt},51489:function(Tt){var yt=9e4,Ne,We,rt,q,Oe,Ee,fe;Ne=function(ce){return ce*yt},We=function(ce,le){return ce*le},rt=function(ce){return ce/yt},q=function(ce,le){return ce/le},Oe=function(ce,le){return Ne(q(ce,le))},Ee=function(ce,le){return We(rt(ce),le)},fe=function(ce,le,Z){return rt(Z?ce:ce-le)},Tt.exports={ONE_SECOND_IN_TS:yt,secondsToVideoTs:Ne,secondsToAudioTs:We,videoTsToSeconds:rt,audioTsToSeconds:q,audioTsToVideoTs:Oe,videoTsToAudioTs:Ee,metadataTsToSeconds:fe}},46894:function(Tt){var yt=Math.pow(2,32),Ne=function(We){var rt=new DataView(We.buffer,We.byteOffset,We.byteLength),q;return rt.getBigUint64?(q=rt.getBigUint64(0),q<Number.MAX_SAFE_INTEGER?Number(q):q):rt.getUint32(0)*yt+rt.getUint32(4)};Tt.exports={getUint64:Ne,MAX_UINT32:yt}},75974:function(Tt){Tt.exports=yt;function yt(Ne,We){var rt,q=null;try{rt=JSON.parse(Ne,We)}catch(Oe){q=Oe}return[q,rt]}},49945:function(Tt){(function(yt){var Ne=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,We=/^(?=([^\/?#]*))\1([^]*)$/,rt=/(?:\/|^)\.(?=\/)/g,q=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,Oe={buildAbsoluteURL:function(Ee,fe,ce){if(ce=ce||{},Ee=Ee.trim(),fe=fe.trim(),!fe){if(!ce.alwaysNormalize)return Ee;var le=Oe.parseURL(Ee);if(!le)throw new Error("Error trying to parse base URL.");return le.path=Oe.normalizePath(le.path),Oe.buildURLFromParts(le)}var Z=Oe.parseURL(fe);if(!Z)throw new Error("Error trying to parse relative URL.");if(Z.scheme)return ce.alwaysNormalize?(Z.path=Oe.normalizePath(Z.path),Oe.buildURLFromParts(Z)):fe;var oe=Oe.parseURL(Ee);if(!oe)throw new Error("Error trying to parse base URL.");if(!oe.netLoc&&oe.path&&oe.path[0]!=="/"){var V=We.exec(oe.path);oe.netLoc=V[1],oe.path=V[2]}oe.netLoc&&!oe.path&&(oe.path="/");var A={scheme:oe.scheme,netLoc:Z.netLoc,path:null,params:Z.params,query:Z.query,fragment:Z.fragment};if(!Z.netLoc&&(A.netLoc=oe.netLoc,Z.path[0]!=="/"))if(!Z.path)A.path=oe.path,Z.params||(A.params=oe.params,Z.query||(A.query=oe.query));else{var I=oe.path,U=I.substring(0,I.lastIndexOf("/")+1)+Z.path;A.path=Oe.normalizePath(U)}return A.path===null&&(A.path=ce.alwaysNormalize?Oe.normalizePath(Z.path):Z.path),Oe.buildURLFromParts(A)},parseURL:function(Ee){var fe=Ne.exec(Ee);return fe?{scheme:fe[1]||"",netLoc:fe[2]||"",path:fe[3]||"",params:fe[4]||"",query:fe[5]||"",fragment:fe[6]||""}:null},normalizePath:function(Ee){for(Ee=Ee.split("").reverse().join("").replace(rt,"");Ee.length!==(Ee=Ee.replace(q,"")).length;);return Ee.split("").reverse().join("")},buildURLFromParts:function(Ee){return Ee.scheme+Ee.netLoc+Ee.path+Ee.params+Ee.query+Ee.fragment}};Tt.exports=Oe})(this)},13407:function(Tt,yt,Ne){var We=Ne(58908),rt=Tt.exports={WebVTT:Ne(63706),VTTCue:Ne(22230),VTTRegion:Ne(13710)};We.vttjs=rt,We.WebVTT=rt.WebVTT;var q=rt.VTTCue,Oe=rt.VTTRegion,Ee=We.VTTCue,fe=We.VTTRegion;rt.shim=function(){We.VTTCue=q,We.VTTRegion=Oe},rt.restore=function(){We.VTTCue=Ee,We.VTTRegion=fe},We.VTTCue||rt.shim()},63706:function(Tt,yt,Ne){var We=Ne(89144),rt=Object.create||function(){function k(){}return function(j){if(arguments.length!==1)throw new Error("Object.create shim only accepts one parameter.");return k.prototype=j,new k}}();function q(k,j){this.name="ParsingError",this.code=k.code,this.message=j||k.message}q.prototype=rt(Error.prototype),q.prototype.constructor=q,q.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};function Oe(k){function j(ne,he,_e,ye){return(ne|0)*3600+(he|0)*60+(_e|0)+(ye|0)/1e3}var Y=k.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return Y?Y[3]?j(Y[1],Y[2],Y[3].replace(":",""),Y[4]):Y[1]>59?j(Y[1],Y[2],0,Y[4]):j(0,Y[1],Y[2],Y[4]):null}function Ee(){this.values=rt(null)}Ee.prototype={set:function(k,j){!this.get(k)&&j!==""&&(this.values[k]=j)},get:function(k,j,Y){return Y?this.has(k)?this.values[k]:j[Y]:this.has(k)?this.values[k]:j},has:function(k){return k in this.values},alt:function(k,j,Y){for(var ne=0;ne<Y.length;++ne)if(j===Y[ne]){this.set(k,j);break}},integer:function(k,j){/^-?\d+$/.test(j)&&this.set(k,parseInt(j,10))},percent:function(k,j){var Y;return(Y=j.match(/^([\d]{1,3})(\.[\d]*)?%$/))&&(j=parseFloat(j),j>=0&&j<=100)?(this.set(k,j),!0):!1}};function fe(k,j,Y,ne){var he=ne?k.split(ne):[k];for(var _e in he)if(typeof he[_e]=="string"){var ye=he[_e].split(Y);if(ye.length===2){var ve=ye[0].trim(),Te=ye[1].trim();j(ve,Te)}}}function ce(k,j,Y){var ne=k;function he(){var ve=Oe(k);if(ve===null)throw new q(q.Errors.BadTimeStamp,"Malformed timestamp: "+ne);return k=k.replace(/^[^\sa-zA-Z-]+/,""),ve}function _e(ve,Te){var be=new Ee;fe(ve,function(De,xe){switch(De){case"region":for(var qe=Y.length-1;qe>=0;qe--)if(Y[qe].id===xe){be.set(De,Y[qe].region);break}break;case"vertical":be.alt(De,xe,["rl","lr"]);break;case"line":var vt=xe.split(","),st=vt[0];be.integer(De,st),be.percent(De,st)&&be.set("snapToLines",!1),be.alt(De,st,["auto"]),vt.length===2&&be.alt("lineAlign",vt[1],["start","center","end"]);break;case"position":vt=xe.split(","),be.percent(De,vt[0]),vt.length===2&&be.alt("positionAlign",vt[1],["start","center","end"]);break;case"size":be.percent(De,xe);break;case"align":be.alt(De,xe,["start","center","end","left","right"]);break}},/:/,/\s/),Te.region=be.get("region",null),Te.vertical=be.get("vertical","");try{Te.line=be.get("line","auto")}catch(De){}Te.lineAlign=be.get("lineAlign","start"),Te.snapToLines=be.get("snapToLines",!0),Te.size=be.get("size",100);try{Te.align=be.get("align","center")}catch(De){Te.align=be.get("align","middle")}try{Te.position=be.get("position","auto")}catch(De){Te.position=be.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},Te.align)}Te.positionAlign=be.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},Te.align)}function ye(){k=k.replace(/^\s+/,"")}if(ye(),j.startTime=he(),ye(),k.substr(0,3)!=="-->")throw new q(q.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+ne);k=k.substr(3),ye(),j.endTime=he(),ye(),_e(k,j)}var le=We.createElement&&We.createElement("textarea"),Z={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},oe={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},V={v:"title",lang:"lang"},A={rt:"ruby"};function I(k,j){function Y(){if(!j)return null;function st(Ye){return j=j.substr(Ye.length),Ye}var Xe=j.match(/^([^<]*)(<[^>]*>?)?/);return st(Xe[1]?Xe[1]:Xe[2])}function ne(st){return le.innerHTML=st,st=le.textContent,le.textContent="",st}function he(st,Xe){return!A[Xe.localName]||A[Xe.localName]===st.localName}function _e(st,Xe){var Ye=Z[st];if(!Ye)return null;var Ft=k.document.createElement(Ye),lt=V[st];return lt&&Xe&&(Ft[lt]=Xe.trim()),Ft}for(var ye=k.document.createElement("div"),ve=ye,Te,be=[];(Te=Y())!==null;){if(Te[0]==="<"){if(Te[1]==="/"){be.length&&be[be.length-1]===Te.substr(2).replace(">","")&&(be.pop(),ve=ve.parentNode);continue}var De=Oe(Te.substr(1,Te.length-2)),xe;if(De){xe=k.document.createProcessingInstruction("timestamp",De),ve.appendChild(xe);continue}var qe=Te.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!qe||(xe=_e(qe[1],qe[3]),!xe)||!he(ve,xe))continue;if(qe[2]){var vt=qe[2].split(".");vt.forEach(function(st){var Xe=/^bg_/.test(st),Ye=Xe?st.slice(3):st;if(oe.hasOwnProperty(Ye)){var Ft=Xe?"background-color":"color",lt=oe[Ye];xe.style[Ft]=lt}}),xe.className=vt.join(" ")}be.push(qe[1]),ve.appendChild(xe),ve=xe;continue}ve.appendChild(k.document.createTextNode(ne(Te)))}return ye}var U=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function w(k){for(var j=0;j<U.length;j++){var Y=U[j];if(k>=Y[0]&&k<=Y[1])return!0}return!1}function F(k){var j=[],Y="",ne;if(!k||!k.childNodes)return"ltr";function he(ve,Te){for(var be=Te.childNodes.length-1;be>=0;be--)ve.push(Te.childNodes[be])}function _e(ve){if(!ve||!ve.length)return null;var Te=ve.pop(),be=Te.textContent||Te.innerText;if(be){var De=be.match(/^.*(\n|\r)/);return De?(ve.length=0,De[0]):be}if(Te.tagName==="ruby")return _e(ve);if(Te.childNodes)return he(ve,Te),_e(ve)}for(he(j,k);Y=_e(j);)for(var ye=0;ye<Y.length;ye++)if(ne=Y.charCodeAt(ye),w(ne))return"rtl";return"ltr"}function $(k){if(typeof k.line=="number"&&(k.snapToLines||k.line>=0&&k.line<=100))return k.line;if(!k.track||!k.track.textTrackList||!k.track.textTrackList.mediaElement)return-1;for(var j=k.track,Y=j.textTrackList,ne=0,he=0;he<Y.length&&Y[he]!==j;he++)Y[he].mode==="showing"&&ne++;return++ne*-1}function C(){}C.prototype.applyStyles=function(k,j){j=j||this.div;for(var Y in k)k.hasOwnProperty(Y)&&(j.style[Y]=k[Y])},C.prototype.formatStyle=function(k,j){return k===0?0:k+j};function B(k,j,Y){C.call(this),this.cue=j,this.cueDiv=I(k,j.text);var ne={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:j.vertical===""?"horizontal-tb":j.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(ne,this.cueDiv),this.div=k.document.createElement("div"),ne={direction:F(this.cueDiv),writingMode:j.vertical===""?"horizontal-tb":j.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:j.align==="middle"?"center":j.align,font:Y.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(ne),this.div.appendChild(this.cueDiv);var he=0;switch(j.positionAlign){case"start":he=j.position;break;case"center":he=j.position-j.size/2;break;case"end":he=j.position-j.size;break}j.vertical===""?this.applyStyles({left:this.formatStyle(he,"%"),width:this.formatStyle(j.size,"%")}):this.applyStyles({top:this.formatStyle(he,"%"),height:this.formatStyle(j.size,"%")}),this.move=function(_e){this.applyStyles({top:this.formatStyle(_e.top,"px"),bottom:this.formatStyle(_e.bottom,"px"),left:this.formatStyle(_e.left,"px"),right:this.formatStyle(_e.right,"px"),height:this.formatStyle(_e.height,"px"),width:this.formatStyle(_e.width,"px")})}}B.prototype=rt(C.prototype),B.prototype.constructor=B;function O(k){var j,Y,ne,he;if(k.div){Y=k.div.offsetHeight,ne=k.div.offsetWidth,he=k.div.offsetTop;var _e=(_e=k.div.childNodes)&&(_e=_e[0])&&_e.getClientRects&&_e.getClientRects();k=k.div.getBoundingClientRect(),j=_e?Math.max(_e[0]&&_e[0].height||0,k.height/_e.length):0}this.left=k.left,this.right=k.right,this.top=k.top||he,this.height=k.height||Y,this.bottom=k.bottom||he+(k.height||Y),this.width=k.width||ne,this.lineHeight=j!==void 0?j:k.lineHeight}O.prototype.move=function(k,j){switch(j=j!==void 0?j:this.lineHeight,k){case"+x":this.left+=j,this.right+=j;break;case"-x":this.left-=j,this.right-=j;break;case"+y":this.top+=j,this.bottom+=j;break;case"-y":this.top-=j,this.bottom-=j;break}},O.prototype.overlaps=function(k){return this.left<k.right&&this.right>k.left&&this.top<k.bottom&&this.bottom>k.top},O.prototype.overlapsAny=function(k){for(var j=0;j<k.length;j++)if(this.overlaps(k[j]))return!0;return!1},O.prototype.within=function(k){return this.top>=k.top&&this.bottom<=k.bottom&&this.left>=k.left&&this.right<=k.right},O.prototype.overlapsOppositeAxis=function(k,j){switch(j){case"+x":return this.left<k.left;case"-x":return this.right>k.right;case"+y":return this.top<k.top;case"-y":return this.bottom>k.bottom}},O.prototype.intersectPercentage=function(k){var j=Math.max(0,Math.min(this.right,k.right)-Math.max(this.left,k.left)),Y=Math.max(0,Math.min(this.bottom,k.bottom)-Math.max(this.top,k.top)),ne=j*Y;return ne/(this.height*this.width)},O.prototype.toCSSCompatValues=function(k){return{top:this.top-k.top,bottom:k.bottom-this.bottom,left:this.left-k.left,right:k.right-this.right,height:this.height,width:this.width}},O.getSimpleBoxPosition=function(k){var j=k.div?k.div.offsetHeight:k.tagName?k.offsetHeight:0,Y=k.div?k.div.offsetWidth:k.tagName?k.offsetWidth:0,ne=k.div?k.div.offsetTop:k.tagName?k.offsetTop:0;k=k.div?k.div.getBoundingClientRect():k.tagName?k.getBoundingClientRect():k;var he={left:k.left,right:k.right,top:k.top||ne,height:k.height||j,bottom:k.bottom||ne+(k.height||j),width:k.width||Y};return he};function P(k,j,Y,ne){function he(Ye,Ft){for(var lt,_t=new O(Ye),Mt=1,It=0;It<Ft.length;It++){for(;Ye.overlapsOppositeAxis(Y,Ft[It])||Ye.within(Y)&&Ye.overlapsAny(ne);)Ye.move(Ft[It]);if(Ye.within(Y))return Ye;var Jt=Ye.intersectPercentage(Y);Mt>Jt&&(lt=new O(Ye),Mt=Jt),Ye=new O(_t)}return lt||_t}var _e=new O(j),ye=j.cue,ve=$(ye),Te=[];if(ye.snapToLines){var be;switch(ye.vertical){case"":Te=["+y","-y"],be="height";break;case"rl":Te=["+x","-x"],be="width";break;case"lr":Te=["-x","+x"],be="width";break}var De=_e.lineHeight,xe=De*Math.round(ve),qe=Y[be]+De,vt=Te[0];Math.abs(xe)>qe&&(xe=xe<0?-1:1,xe*=Math.ceil(qe/De)*De),ve<0&&(xe+=ye.vertical===""?Y.height:Y.width,Te=Te.reverse()),_e.move(vt,xe)}else{var st=_e.lineHeight/Y.height*100;switch(ye.lineAlign){case"center":ve-=st/2;break;case"end":ve-=st;break}switch(ye.vertical){case"":j.applyStyles({top:j.formatStyle(ve,"%")});break;case"rl":j.applyStyles({left:j.formatStyle(ve,"%")});break;case"lr":j.applyStyles({right:j.formatStyle(ve,"%")});break}Te=["+y","-x","+x","-y"],_e=new O(j)}var Xe=he(_e,Te);j.move(Xe.toCSSCompatValues(Y))}function S(){}S.StringDecoder=function(){return{decode:function(k){if(!k)return"";if(typeof k!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(k))}}},S.convertCueToDOMTree=function(k,j){return!k||!j?null:I(k,j)};var H=.05,X="sans-serif",ie="1.5%";S.processCues=function(k,j,Y){if(!k||!j||!Y)return null;for(;Y.firstChild;)Y.removeChild(Y.firstChild);var ne=k.document.createElement("div");ne.style.position="absolute",ne.style.left="0",ne.style.right="0",ne.style.top="0",ne.style.bottom="0",ne.style.margin=ie,Y.appendChild(ne);function he(De){for(var xe=0;xe<De.length;xe++)if(De[xe].hasBeenReset||!De[xe].displayState)return!0;return!1}if(!he(j)){for(var _e=0;_e<j.length;_e++)ne.appendChild(j[_e].displayState);return}var ye=[],ve=O.getSimpleBoxPosition(ne),Te=Math.round(ve.height*H*100)/100,be={font:Te+"px "+X};(function(){for(var De,xe,qe=0;qe<j.length;qe++)xe=j[qe],De=new B(k,xe,be),ne.appendChild(De.div),P(k,De,ve,ye),xe.displayState=De.div,ye.push(O.getSimpleBoxPosition(De))})()},S.Parser=function(k,j,Y){Y||(Y=j,j={}),j||(j={}),this.window=k,this.vttjs=j,this.state="INITIAL",this.buffer="",this.decoder=Y||new TextDecoder("utf8"),this.regionList=[]},S.Parser.prototype={reportOrThrowError:function(k){if(k instanceof q)this.onparsingerror&&this.onparsingerror(k);else throw k},parse:function(k){var j=this;k&&(j.buffer+=j.decoder.decode(k,{stream:!0}));function Y(){for(var De=j.buffer,xe=0;xe<De.length&&De[xe]!=="\r"&&De[xe]!==`
`;)++xe;var qe=De.substr(0,xe);return De[xe]==="\r"&&++xe,De[xe]===`
`&&++xe,j.buffer=De.substr(xe),qe}function ne(De){var xe=new Ee;if(fe(De,function(vt,st){switch(vt){case"id":xe.set(vt,st);break;case"width":xe.percent(vt,st);break;case"lines":xe.integer(vt,st);break;case"regionanchor":case"viewportanchor":var Xe=st.split(",");if(Xe.length!==2)break;var Ye=new Ee;if(Ye.percent("x",Xe[0]),Ye.percent("y",Xe[1]),!Ye.has("x")||!Ye.has("y"))break;xe.set(vt+"X",Ye.get("x")),xe.set(vt+"Y",Ye.get("y"));break;case"scroll":xe.alt(vt,st,["up"]);break}},/=/,/\s/),xe.has("id")){var qe=new(j.vttjs.VTTRegion||j.window.VTTRegion);qe.width=xe.get("width",100),qe.lines=xe.get("lines",3),qe.regionAnchorX=xe.get("regionanchorX",0),qe.regionAnchorY=xe.get("regionanchorY",100),qe.viewportAnchorX=xe.get("viewportanchorX",0),qe.viewportAnchorY=xe.get("viewportanchorY",100),qe.scroll=xe.get("scroll",""),j.onregion&&j.onregion(qe),j.regionList.push({id:xe.get("id"),region:qe})}}function he(De){var xe=new Ee;fe(De,function(qe,vt){switch(qe){case"MPEGT":xe.integer(qe+"S",vt);break;case"LOCA":xe.set(qe+"L",Oe(vt));break}},/[^\d]:/,/,/),j.ontimestampmap&&j.ontimestampmap({MPEGTS:xe.get("MPEGTS"),LOCAL:xe.get("LOCAL")})}function _e(De){De.match(/X-TIMESTAMP-MAP/)?fe(De,function(xe,qe){switch(xe){case"X-TIMESTAMP-MAP":he(qe);break}},/=/):fe(De,function(xe,qe){switch(xe){case"Region":ne(qe);break}},/:/)}try{var ye;if(j.state==="INITIAL"){if(!/\r\n|\n/.test(j.buffer))return this;ye=Y();var ve=ye.match(/^WEBVTT([ \t].*)?$/);if(!ve||!ve[0])throw new q(q.Errors.BadSignature);j.state="HEADER"}for(var Te=!1;j.buffer;){if(!/\r\n|\n/.test(j.buffer))return this;switch(Te?Te=!1:ye=Y(),j.state){case"HEADER":/:/.test(ye)?_e(ye):ye||(j.state="ID");continue;case"NOTE":ye||(j.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(ye)){j.state="NOTE";break}if(!ye)continue;j.cue=new(j.vttjs.VTTCue||j.window.VTTCue)(0,0,"");try{j.cue.align="center"}catch(De){j.cue.align="middle"}if(j.state="CUE",ye.indexOf("-->")===-1){j.cue.id=ye;continue}case"CUE":try{ce(ye,j.cue,j.regionList)}catch(De){j.reportOrThrowError(De),j.cue=null,j.state="BADCUE";continue}j.state="CUETEXT";continue;case"CUETEXT":var be=ye.indexOf("-->")!==-1;if(!ye||be&&(Te=!0)){j.oncue&&j.oncue(j.cue),j.cue=null,j.state="ID";continue}j.cue.text&&(j.cue.text+=`
`),j.cue.text+=ye.replace(/\u2028/g,`
`).replace(/u2029/g,`
`);continue;case"BADCUE":ye||(j.state="ID");continue}}}catch(De){j.reportOrThrowError(De),j.state==="CUETEXT"&&j.cue&&j.oncue&&j.oncue(j.cue),j.cue=null,j.state=j.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){var k=this;try{if(k.buffer+=k.decoder.decode(),(k.cue||k.state==="HEADER")&&(k.buffer+=`

`,k.parse()),k.state==="INITIAL")throw new q(q.Errors.BadSignature)}catch(j){k.reportOrThrowError(j)}return k.onflush&&k.onflush(),this}},Tt.exports=S},22230:function(Tt){var yt="auto",Ne={"":1,lr:1,rl:1},We={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function rt(Ee){if(typeof Ee!="string")return!1;var fe=Ne[Ee.toLowerCase()];return fe?Ee.toLowerCase():!1}function q(Ee){if(typeof Ee!="string")return!1;var fe=We[Ee.toLowerCase()];return fe?Ee.toLowerCase():!1}function Oe(Ee,fe,ce){this.hasBeenReset=!1;var le="",Z=!1,oe=Ee,V=fe,A=ce,I=null,U="",w=!0,F="auto",$="start",C="auto",B="auto",O=100,P="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return le},set:function(S){le=""+S}},pauseOnExit:{enumerable:!0,get:function(){return Z},set:function(S){Z=!!S}},startTime:{enumerable:!0,get:function(){return oe},set:function(S){if(typeof S!="number")throw new TypeError("Start time must be set to a number.");oe=S,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return V},set:function(S){if(typeof S!="number")throw new TypeError("End time must be set to a number.");V=S,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return A},set:function(S){A=""+S,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return I},set:function(S){I=S,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return U},set:function(S){var H=rt(S);if(H===!1)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");U=H,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return w},set:function(S){w=!!S,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return F},set:function(S){if(typeof S!="number"&&S!==yt)throw new SyntaxError("Line: an invalid number or illegal string was specified.");F=S,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return $},set:function(S){var H=q(S);H?($=H,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return C},set:function(S){if(S<0||S>100)throw new Error("Position must be between 0 and 100.");C=S,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return B},set:function(S){var H=q(S);H?(B=H,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return O},set:function(S){if(S<0||S>100)throw new Error("Size must be between 0 and 100.");O=S,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return P},set:function(S){var H=q(S);if(!H)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");P=H,this.hasBeenReset=!0}}}),this.displayState=void 0}Oe.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},Tt.exports=Oe},13710:function(Tt){var yt={"":!0,up:!0};function Ne(q){if(typeof q!="string")return!1;var Oe=yt[q.toLowerCase()];return Oe?q.toLowerCase():!1}function We(q){return typeof q=="number"&&q>=0&&q<=100}function rt(){var q=100,Oe=3,Ee=0,fe=100,ce=0,le=100,Z="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return q},set:function(oe){if(!We(oe))throw new Error("Width must be between 0 and 100.");q=oe}},lines:{enumerable:!0,get:function(){return Oe},set:function(oe){if(typeof oe!="number")throw new TypeError("Lines must be set to a number.");Oe=oe}},regionAnchorY:{enumerable:!0,get:function(){return fe},set:function(oe){if(!We(oe))throw new Error("RegionAnchorX must be between 0 and 100.");fe=oe}},regionAnchorX:{enumerable:!0,get:function(){return Ee},set:function(oe){if(!We(oe))throw new Error("RegionAnchorY must be between 0 and 100.");Ee=oe}},viewportAnchorY:{enumerable:!0,get:function(){return le},set:function(oe){if(!We(oe))throw new Error("ViewportAnchorY must be between 0 and 100.");le=oe}},viewportAnchorX:{enumerable:!0,get:function(){return ce},set:function(oe){if(!We(oe))throw new Error("ViewportAnchorX must be between 0 and 100.");ce=oe}},scroll:{enumerable:!0,get:function(){return Z},set:function(oe){var V=Ne(oe);V===!1?console.warn("Scroll: an invalid or illegal string was specified."):Z=V}}})}Tt.exports=rt},25893:function(){}}]);
