(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[310],{90813:function($){$.exports={start:"start___3TT4V",loading:"loading___2O2h9",end:"end___34l8P"}},18778:function($){$.exports={table:"table___3IxDk",modal:"modal___LVRzp",form:"form___zeDs-"}},97796:function($){$.exports={_table:"_table___3odCR"}},10402:function($,ee,n){"use strict";n.r(ee),n.d(ee,{default:function(){return be}});var Me=n(34792),z=n(48086),Ne=n(57663),D=n(71577),c=n(11849),b=n(2824),Oe=n(13062),J=n(71230),Ve=n(89032),ie=n(15746),$e=n(71194),te=n(50146),ue=n(32059),ne=n(93224),de=n(86582),ce=n(76570),fe=n(49101),ae=n(10706),ve=n(94184),me=n.n(ve),he=n(82492),Q=n.n(he),xe=n(30381),E=n.n(xe),f=n(67294),ge=n(18778),re=n.n(ge),a=n(85893),pe=["onSubmit","modal","setModal","hasRestFooter","refreshTime","modelProps","onCancel"],Ce=["searchSpan","extraActions","addText","addButtonProps","hideSearchButton","className","actionRef","setModal"],ye={title:"\u5E8F\u53F7",valueType:"index",key:"index",width:100,render:function(i,o,m,h){var u=h.pageInfo;u=u===void 0?{}:u;var x=u.pageSize,g=x===void 0?0:x,F=u.current,S=F===void 0?1:F;return(0,a.jsx)("div",{style:{padding:"5px 0"},children:S*g+m+1-g})}};function Fe(e){var i=e.columns,o=e.request,m=e.showIndexColumn,h=m===void 0?!0:m,u=(0,f.useMemo)(function(){return(h?[ye].concat((0,de.Z)(i)):i).map(function(t){return Q()({align:t.valueType==="option"?"center":void 0,fieldProps:{allowClear:t.valueType!=="digit"?!0:void 0,placeholder:null},filters:void 0},t)})},[i]),x=(0,f.useRef)(),g=(0,f.useCallback)(function(t){var l;return(l=x.current)===null||l===void 0?void 0:l.reload(t)},[x]),F=(0,f.useState)({visible:!1}),S=(0,b.Z)(F,2),s=S[0],r=S[1];return{setModal:r,modal:s,reload:g,proTableProps:{request:o,columns:u,setModal:r,actionRef:x,rowKey:"id"},proFormModalProps:{modal:s,setModal:r,columns:u}}}function Se(e){var i=e.onSubmit,o=e.modal,m=e.setModal,h=e.hasRestFooter,u=h===void 0?!1:h,x=e.refreshTime,g=x===void 0?{flag:!1,name:"createdAt"}:x,F=e.modelProps,S=e.onCancel,s=S===void 0?!1:S,r=(0,ne.Z)(e,pe),t=(0,f.useRef)();(0,f.useEffect)(function(){var Z=null,d=o.isAdd,y=o.visible,I=o.title;return(d||I==="\u5904\u7406")&&g.flag&&y&&(Z=setInterval(function(){var L,M;return(L=t.current)===null||L===void 0?void 0:L.setFieldsValue((0,c.Z)((0,c.Z)({},(M=t.current)===null||M===void 0?void 0:M.getFieldsValue()),{},(0,ue.Z)({},g==null?void 0:g.name,E()())))},1e3)),function(){Z&&clearInterval(Z)}},[o.visible,o.isAdd,g,o.title]),(0,f.useEffect)(function(){m(function(Z){return(0,c.Z)((0,c.Z)({},Z),{},{isAdd:!o.defaultFormValues})})},[o.visible,o.defaultFormValues]),(0,f.useEffect)(function(){var Z=o.visible,d=o.defaultFormValues;if(Z){var y,I;(y=t.current)===null||y===void 0||y.resetFields(),d&&((I=t.current)===null||I===void 0||I.setFieldsValue(d))}},[o.visible,o.defaultFormValues]);var l=(0,f.useMemo)(function(){return Q()({form:{layout:"horizontal"}},r)},[r]),v=(0,f.useState)(!1),p=(0,b.Z)(v,2),T=p[0],R=p[1];return(0,a.jsx)(te.Z,(0,c.Z)((0,c.Z)((0,c.Z)({visible:o.visible,title:o.title,className:re().modal,onCancel:function(){var d,y;s&&s((d=t.current)===null||d===void 0?void 0:d.getFieldsValue()),(y=t.current)===null||y===void 0||y.setFieldsValue({file:[]}),m({visible:!1})},forceRender:!0,maskClosable:!1,onOk:function(){var d;return(d=t.current)===null||d===void 0?void 0:d.validateFields().then(function(y){return R(!0),i==null?void 0:i(y)}).finally(function(){return R(!1)})},okButtonProps:{loading:T}},u&&{footer:[(0,a.jsx)(D.Z,{onClick:function(){var d;return(d=t.current)===null||d===void 0?void 0:d.setFieldsValue((0,c.Z)((0,c.Z)({},o.defaultFormValues),{},{content:"",result:""}))},children:"\u91CD\u7F6E"}),(0,a.jsx)(D.Z,{type:"primary",onClick:function(){var d;return(d=t.current)===null||d===void 0?void 0:d.validateFields().then(function(y){return R(!0),i==null?void 0:i(y)}).finally(function(){return R(!1)})},children:"\u4FDD\u5B58"})]}),F),{},{children:(0,a.jsx)(ae.ZP,(0,c.Z)({type:"form",formRef:t},l))}))}function Ze(e){var i=e.searchSpan,o=i===void 0?6:i,m=e.extraActions,h=e.addText,u=e.addButtonProps,x=e.hideSearchButton,g=e.className,F=e.actionRef,S=e.setModal,s=(0,ne.Z)(e,Ce),r=Q()({options:!1,toolBarRender:!1,actionRef:F,pagination:{size:"default",defaultPageSize:10,showSizeChanger:!0},className:me()(re().table,g),search:{span:o,optionRender:function(l,v,p){return(0,a.jsxs)(J.Z,{justify:"space-between",children:[x?(0,a.jsx)("span",{}):f.cloneElement(p[1],{icon:(0,a.jsx)(ce.Z,{})}),(0,a.jsxs)(ie.Z,{children:[h&&(0,a.jsx)(D.Z,(0,c.Z)((0,c.Z)({type:"primary",icon:(0,a.jsx)(fe.Z,{}),onClick:function(){return S({visible:!0,title:h})}},u),{},{children:h})),e.extraActions]})]})}}},s);return(0,a.jsx)(ae.ZP,(0,c.Z)({},r))}var W=n(42122);function le(e){return console.log(e),Promise.resolve({code:0,data:{list:[{name:"text",age:25.5,sex:"female",imgs:"https://ruler-recognition.oss-cn-beijing.aliyuncs.com/original/2023-06-01/CMD1000014/CMD1000014_2023-06-01--18:00:16.jpg",time:1703389324,select:"",startAt:1703389324,endAt:1703389824}],total:10}});return(0,W.U2)("/plan/list",e)}function je(e){return(0,W.v_)("/plan",e)}function ze(e){return put("/plan",e)}function Pe(e){return(0,W.IV)("/plan/".concat(e))}function Ue(){return get("/plan/strategy")}function Ge(e){return post("/plan/strategy",e)}function ke(e){return put("/plan/strategy",e)}function Ye(e){return get("/plan/record/list",e)}function He(e){return get("/plan/record/receive",e)}function We(e){return get("/plan/record/statistics",{emergencyPlanRecordId:e})}function Ke(e){return put("/plan/record",e)}var se=n(17024),Ae=n(97796),Te=n.n(Ae),Je=n(20228),Re=n(11382),Qe=n(54421),X=n(38272),Xe=n(402),G=n(61859),we=n(43185),oe=n(94412),De=n(7085),k=n(51459),Ie=n(90813),w=n.n(Ie);function Ee(e){var i=e.template,o=e.service,m=e.name,h=e.reload,u=e.tootip,x=e.accept,g=x===void 0?".xls,.xlsx":x,F=e.validator,S=(0,f.useState)(!1),s=(0,b.Z)(S,2),r=s[0],t=s[1],l=(0,f.useState)(C.START),v=(0,b.Z)(l,2),p=v[0],T=v[1],R=(0,f.useState)({success:0,failed:[]}),Z=(0,b.Z)(R,2),d=Z[0],y=Z[1],I=(0,f.useState)([]),L=(0,b.Z)(I,2),M=L[0],V=L[1],U=(0,f.useRef)(),q=(0,f.useCallback)(function(A,O){return O&&!O(A)?oe.Z.LIST_IGNORE:(U.current=A,!1)},[]),Y=(0,f.useCallback)(function(){if(!U.current)return z.ZP.error("\u8BF7\u9009\u62E9\u6587\u4EF6\uFF01");T(C.LOADING),o(U.current).then(function(A){var O=A.code,_=A.data,Le=A.message;if(O!==0)throw Le;y(_),T(C.END)}).catch(function(A){z.ZP.error(A||"\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),T(C.START)})},[]),N=(0,f.useCallback)(function(){p===C.END&&(h==null||h(!0)),T(C.START),V([]),U.current=void 0,t(!1)},[p]),B,j;if(p===C.START)B=(0,a.jsxs)(X.ZP,{className:w().start,children:[(0,a.jsx)(J.Z,{className:"title",children:"\u8BF7\u6309\u6A21\u677F\u6807\u51C6\u683C\u5F0F\u5BFC\u5165\u6570\u636E"}),(0,a.jsx)(J.Z,{className:"template-link",children:(0,a.jsx)(G.Z.Link,{href:i,download:!0,children:"\u4E0B\u8F7D\u5BFC\u5165\u6A21\u677F"})}),(0,a.jsx)(oe.Z,{beforeUpload:function(O){return q(O,F)},accept:g,showUploadList:{showRemoveIcon:!1},fileList:M,onChange:function(O){var _=O.fileList;return V(_.slice(-1))},children:(0,a.jsx)(D.Z,{type:"primary",ghost:!0,children:"\u9009\u62E9\u6587\u4EF6"})}),(0,a.jsx)("span",{className:"tooltip",children:u})]}),j=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D.Z,{onClick:N,children:"\u53D6\u6D88"}),(0,a.jsx)(D.Z,{onClick:Y,type:"primary",children:"\u5BFC\u5165"})]});else if(p===C.LOADING)B=(0,a.jsx)(X.ZP,{className:w().loading,children:(0,a.jsx)(Re.Z,{indicator:(0,a.jsx)(De.Z,{style:{fontSize:40},spin:!0}),tip:"\u5BFC\u5165\u4E2D"})}),j=null;else{var P=d,H=P.success,K=P.failed;B=(0,a.jsxs)(X.ZP,{className:w().end,children:[(0,a.jsxs)(G.Z,{children:["\u5BFC\u5165\u5B8C\u6210\uFF0C\u5B8C\u6210",(0,a.jsx)(G.Z.Text,{style:{padding:"0 4px"},strong:!0,children:H}),"\u6761\uFF0C\u5931\u8D25",(0,a.jsx)(G.Z.Text,{style:{padding:"0 4px"},strong:!0,type:K.length?"danger":void 0,children:K.length}),"\u6761"]}),K.length>0&&(0,a.jsx)(G.Z.Link,{onClick:function(){return Be(K,m)},children:"\u4E0B\u8F7D\u5931\u8D25\u65E5\u5FD7"})]}),j=(0,a.jsx)(D.Z,{onClick:N,type:"primary",children:"\u786E\u5B9A"})}return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{onClick:function(){return t(!0)},children:e.children}),(0,a.jsx)(te.Z,{title:"\u5BFC\u5165".concat(m),visible:r,maskClosable:!1,footer:j,onCancel:N,children:B})]})}var C;(function(e){e[e.START=0]="START",e[e.LOADING=1]="LOADING",e[e.END=2]="END"})(C||(C={}));function Be(e,i){var o=[["\u884C\u53F7","\u5931\u8D25\u539F\u56E0"]],m=k.utils.aoa_to_sheet(o),h=k.utils.sheet_add_aoa(m,e.map(function(x){var g=x.index,F=x.reason;return[g,F]}),{origin:"A2"}),u=k.utils.book_new();k.utils.book_append_sheet(u,h),(0,k.writeFile)(u,"".concat(i,"\u5BFC\u5165\u5931\u8D25\u65E5\u5FD7").concat(E()().format("YYYYMMDDHHmmss"),".xlsx"))}function qe(e){var i=e.service,o=e.name,m=e.reload,h=e.tootip,u=e.accept,x=u===void 0?".xls,.xlsx":u,g=e.validator,F=useState(!1),S=_slicedToArray(F,2),s=S[0],r=S[1],t=useState(C.START),l=_slicedToArray(t,2),v=l[0],p=l[1],T=useState(!1),R=_slicedToArray(T,2),Z=R[0],d=R[1],y=useState([]),I=_slicedToArray(y,2),L=I[0],M=I[1],V=useRef(),U=useCallback(function(j,P){return P&&!P(j)?_Upload.LIST_IGNORE:(V.current=j,!1)},[]),q=useCallback(function(){if(!V.current)return _message.error("\u8BF7\u9009\u62E9\u6587\u4EF6\uFF01");p(C.LOADING),i(V.current).then(function(j){var P=j.code,H=j.message;if(d(P===0),P!==0)throw H;p(C.END)}).catch(function(j){_message.error(j||"\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),p(C.START)})},[]),Y=useCallback(function(){v===C.END&&(m==null||m()),p(C.START),M([]),V.current=void 0,r(!1)},[v]),N,B;return v===C.START?(N=_jsxs(_List,{className:style.start,children:[_jsx(_Upload,{beforeUpload:function(P){return U(P,g)},accept:x,fileList:L,onChange:function(P){var H=P.fileList;return M(H.slice(-1))},children:_jsx(_Button,{type:"primary",ghost:!0,children:"\u9009\u62E9\u6587\u4EF6"})}),_jsx("span",{className:"tooltip",children:h})]}),B=_jsxs(_Fragment,{children:[_jsx(_Button,{onClick:Y,children:"\u53D6\u6D88"}),_jsx(_Button,{onClick:q,type:"primary",children:"\u5BFC\u5165"})]})):v===C.LOADING?(N=_jsx(_List,{className:style.loading,children:_jsx(_Spin,{indicator:_jsx(LoadingOutlined,{style:{fontSize:40},spin:!0}),tip:"\u4E0A\u4F20\u4E2D"})}),B=null):(N=_jsx(_List,{className:style.end,children:_jsx(_Typography,{children:Z?"\u4E0A\u4F20\u5B8C\u6210":"\u4E0A\u4F20\u5931\u8D25"})}),B=_jsx(_Button,{onClick:Y,type:"primary",children:"\u786E\u5B9A"})),_jsxs(_Fragment,{children:[_jsx("span",{onClick:function(){return r(!0)},children:e.children}),_jsx(_Modal,{title:"\u4E0A\u4F20".concat(o),visible:s,maskClosable:!1,footer:B,onCancel:Y,children:N})]})}function be(){var e=(0,f.useMemo)(function(){return[{title:function(r,t){return t==="table"?"\u5B57\u7B26\u4E32":"\u540D\u5B57(\u5B57\u7B26\u4E32"},dataIndex:"name",formItemProps:{rules:[{required:!0},{max:30}]}},{title:"\u6570\u5B57",dataIndex:"age",valueType:"digitRange",fieldProps:{precision:2,min:0,max:120},search:{transform:function(r){if(!r)return{};var t=(0,b.Z)(r,2),l=t[0],v=t[1];return{minAge:l,maxAge:v}}},render:function(r,t){var l=t.age;return l}},{title:"\u7B5B\u9009",dataIndex:"sex",valueEnum:new Map([["female","\u5973"],["male","\u7537"]])},{title:"\u65F6\u95F4",dataIndex:"time",valueType:"dateRange",hideInForm:!0,render:function(r,t){var l=t.time;return(0,se.Pj)(l)},search:{transform:function(r){if(!r)return{};var t=(0,b.Z)(r,2),l=t[0],v=t[1];return{createStartAt:E()(l).startOf("day").unix(),createEndAt:E()(v).endOf("day").unix()}}}},{title:"\u56FE\u7247",dataIndex:"imgs",valueType:"image",search:!1,hideInForm:!0},{title:"\u5F00\u59CB\u65E5\u671F",dataIndex:"startAt",valueType:"date",search:!1,formItemProps:{rules:[{required:!0,message:"\u8BF7\u9009\u62E9${label}"}]},render:function(r,t){var l=t.startAt;return E().unix(l).format("yyyy-MM-DD")},fieldProps:{allowClear:!1,placeholder:"\u8BF7\u9009\u62E9"}},{title:"\u7ED3\u675F\u65E5\u671F",dataIndex:"endAt",valueType:"date",search:!1,formItemProps:function(r){return{rules:[{required:!0,message:"\u8BF7\u9009\u62E9${label}"},{validator:function(l,v){var p,T=r==null||(p=r.getFieldValue("startAt"))===null||p===void 0?void 0:p.startOf("day").unix(),R=v==null?void 0:v.startOf("day").unix();return R<T?Promise.reject("\u7ED3\u675F\u65E5\u671F\u4E0D\u80FD\u65E9\u4E8E\u5F00\u59CB\u65E5\u671F"):Promise.resolve()}}]}},fieldProps:function(r){var t;console.log(r==null?void 0:r.getFieldValue("startAt"));var l=r==null||(t=r.getFieldValue("startAt"))===null||t===void 0?void 0:t.startOf("day");return{allowClear:!1,placeholder:"\u8BF7\u9009\u62E9",disabledDate:function(p){return p<l}}},render:function(r,t){var l=t.endAt;return E().unix(l).format("yyyy-MM-DD")}},{dataIndex:"id",hideInTable:!0,search:!1,formItemProps:{hidden:!0}},{title:"\u64CD\u4F5C",valueType:"option",render:function(r,t){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D.Z,{type:"link",onClick:function(){return h({visible:!0,defaultFormValues:(0,c.Z)((0,c.Z)({},t),{},{startAt:E().unix(t.startAt),endAt:E().unix(t.endAt)}),title:"\u7F16\u8F91"})},children:"\u7F16\u8F91"}),(0,a.jsx)(D.Z,{danger:!0,type:"link",onClick:function(){return F(t.id)},children:"\u5220\u9664"})]})}}]},[]),i=Fe({columns:e,request:(0,W.yd)(le)}),o=i.proTableProps,m=i.proFormModalProps,h=i.setModal,u=i.reload,x=i.modal,g=(0,f.useCallback)(function(s){var r=je((0,c.Z)((0,c.Z)({},s),{},{createdAt:E()(s.createdAt).unix()}));return r.then(function(t){var l=t.code,v=t.message;l===0?(z.ZP.success("\u65B0\u589E\u6210\u529F"),u(),h({visible:!1})):z.ZP.error(v||"\u64CD\u4F5C\u5931\u8D25")})},[]),F=(0,f.useCallback)(function(s){(0,se.WZ)({content:"\u786E\u5B9A\u5220\u9664\u6B64\u6570\u636E\u5417?",onOk:function(){Pe(s).then(function(t){var l=t.code,v=t.message;l===0?(z.ZP.success("\u5220\u9664\u6210\u529F"),u(!0)):z.ZP.error(v||"\u5220\u9664\u5931\u8D25")})}})},[]),S=(0,f.useMemo)(function(){var s=m.columns;return s.map(function(r){return r.dataIndex==="age"?(0,c.Z)((0,c.Z)({},r),{},{valueType:"digit"}):r})},[m.columns]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Ze,(0,c.Z)((0,c.Z)({},o),{},{searchSpan:6,addText:"\u65B0\u5EFA",extraActions:(0,a.jsx)(Ee,{name:"\u5BFC\u5165",service:function(){return le({})},reload:u,template:"/aa.xlsx",tootip:"\u4EC5\u652F\u6301xlsx\u683C\u5F0F\u6587\u4EF6,\u6587\u4EF6\u5C0F\u4E8E30MB",accept:".xlsx",children:(0,a.jsx)(D.Z,{type:"primary",children:"\u5BFC\u5165"})}),className:Te()._table})),(0,a.jsx)(Se,(0,c.Z)((0,c.Z)({},m),{},{columns:S,onSubmit:g}))]})}},18685:function(){}}]);
