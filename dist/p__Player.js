(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[131],{68167:function(x,y,t){"use strict";t.r(y),t.d(y,{default:function(){return C}});var c=t(86582),h=t(2824),g=t(67294),M=t(2293),o=t(85893);function C(){var u=(0,M.Z)({list:[],path:""}),R=(0,g.useState)(!1),E=(0,h.Z)(R,2),w=E[0],m=E[1],l=(0,g.useRef)(null),f=(0,g.useRef)(null),n=(0,g.useRef)(null),i=function(){var e=document.getElementById("video");return new Promise(function(v,s){var d,b="",P=document.createElement("canvas"),k=e==null?void 0:e.width,L=e==null?void 0:e.height;P.width=k,P.height=L,(d=P.getContext("2d"))===null||d===void 0||d.drawImage(e,0,0,k,L),setTimeout(function(){b=P.toDataURL("image/jpeg"),console.log(b),document.getElementById("testImg").src=b,v(b)},0)})},r=function(e){var v=[];return e?v=e:v=u.list,v.length<1?"":v.map(function(s,d){return s?d===0?"M ".concat(s[0]," ").concat(s[1]):d===1?"L ".concat(s[0]," ").concat(s[1]):d===v.length-1?"".concat(s[0]," ").concat(s[1]," Z"):"".concat(s[0]," ").concat(s[1]):""}).join(",")},O=function(e){u.list.push([e.layerX,e.layerY]),u.path=r()},p=function(e){u.path=r([].concat((0,c.Z)(u.list),[[e.layerX,e.layerY]]))},_=function(e){u.list.push([e.offsetX,e.offsetY]),u.path=r()},j=function(){u.path=r()};return(0,g.useEffect)(function(){var a,e,v,s;if(!!l.current)return(a=l.current)===null||a===void 0||a.addEventListener("click",O),(e=l.current)===null||e===void 0||e.addEventListener("mousemove",p),(v=f.current)===null||v===void 0||v.addEventListener("click",_),(s=n.current)===null||s===void 0||s.addEventListener("mouseleave",j),function(){var d,b,P,k;(d=l.current)===null||d===void 0||d.removeEventListener("click",O),(b=l.current)===null||b===void 0||b.removeEventListener("mousemove",p),(P=f.current)===null||P===void 0||P.removeEventListener("click",_),(k=n.current)===null||k===void 0||k.removeEventListener("mouseleave",j)}},[]),(0,o.jsxs)("div",{children:[(0,o.jsx)("button",{onClick:i,children:"\u622A\u56FE"}),(0,o.jsx)("button",{onClick:function(){return m(!0)},children:"\u6807\u8BB0\u70B9"}),(0,o.jsx)("button",{onClick:function(){console.log(u.list),m(!1),u.list=[],u.path=""},children:"\u63D0\u4EA4"}),(0,o.jsx)("br",{}),(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"500",height:"300",ref:n,children:[(0,o.jsxs)("foreignObject",{x:"0",y:"0",width:"500",height:"300",children:[(0,o.jsx)("div",{ref:l,className:"video-marker-cover",style:{width:"500px",height:"300px",display:w?"block":"none"}}),(0,o.jsx)("video",{autoPlay:!0,muted:!0,src:"/antdpro-base-demo/public/video/big_buck_bunny.mp4",width:500,height:300,id:"video",controls:!0})]}),(0,o.jsx)("path",{ref:f,fill:"none",stroke:"red",d:u.path})]}),(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"500",height:"300",children:[(0,o.jsx)("foreignObject",{x:"0",y:"0",width:"500",height:"300",children:(0,o.jsx)("div",{children:(0,o.jsx)("img",{src:"",width:"500",height:"300",id:"testImg",alt:""})})}),(0,o.jsx)("path",{fill:"none",stroke:"red",d:u.path})]})]})}},2293:function(x,y,t){"use strict";t.d(y,{Z:function(){return f}});var c=t(67294),h=t(68630),g=t.n(h);function M(n,i){if(n===i)return!0;for(var r=0;r<n.length;r++)if(!Object.is(n[r],i[r]))return!1;return!0}function o(n,i){var r=(0,c.useRef)({deps:i,obj:void 0,initialized:!1}).current;return(r.initialized===!1||!M(r.deps,i))&&(r.deps=i,r.obj=n(),r.initialized=!0),r.obj}var C=t(65353),u=function(){var n=(0,C.__read)((0,c.useState)({}),2),i=n[1];return(0,c.useCallback)(function(){return i({})},[])},R=u,E=new WeakMap,w=new WeakMap;function m(n,i){var r=E.get(n);if(r)return r;if(w.has(n))return n;var O=new Proxy(n,{get:function(p,_,j){var a=Reflect.get(p,_,j),e=Reflect.getOwnPropertyDescriptor(p,_);return!(e==null?void 0:e.configurable)&&!(e==null?void 0:e.writable)?a:g()(a)||Array.isArray(a)?m(a,i):a},set:function(p,_,j){var a=Reflect.set(p,_,j);return i(),a},deleteProperty:function(p,_){var j=Reflect.deleteProperty(p,_);return i(),j}});return E.set(n,O),w.set(O,n),O}function l(n){var i=R(),r=(0,c.useRef)(n),O=o(function(){return m(r.current,function(){i()})},[]);return O}var f=l},85924:function(x,y,t){var c=t(5569),h=c(Object.getPrototypeOf,Object);x.exports=h},5569:function(x){function y(t,c){return function(h){return t(c(h))}}x.exports=y},68630:function(x,y,t){var c=t(44239),h=t(85924),g=t(37005),M="[object Object]",o=Function.prototype,C=Object.prototype,u=o.toString,R=C.hasOwnProperty,E=u.call(Object);function w(m){if(!g(m)||c(m)!=M)return!1;var l=h(m);if(l===null)return!0;var f=R.call(l,"constructor")&&l.constructor;return typeof f=="function"&&f instanceof f&&u.call(f)==E}x.exports=w}}]);
