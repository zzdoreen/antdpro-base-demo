(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[170],{69816:function(oi,Qt,Dt){"use strict";Dt.d(Qt,{Z:function(){return st}});var ce=Dt(28991),Lt=Dt(67294),ge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M304 176h80v672h-80zm408 0h-64c-4.4 0-8 3.6-8 8v656c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V184c0-4.4-3.6-8-8-8z"}}]},name:"pause",theme:"outlined"},Nt=ge,Rt=Dt(27029),ue=function(Pt,It){return Lt.createElement(Rt.Z,(0,ce.Z)((0,ce.Z)({},Pt),{},{ref:It,icon:Nt}))},se=Lt.forwardRef(ue),st=se},34294:function(){},58580:function(oi,Qt,Dt){"use strict";var ce=Dt(65353),Lt=Dt(67294),ge=Dt(78187);function Nt(Rt,ue){var se=(0,ce.__read)((0,Lt.useState)(Rt),2),st=se[0],Ft=se[1],Pt=(0,ge.Z)(function(){Ft(Rt)},ue).run;return(0,Lt.useEffect)(function(){Pt()},[Rt]),st}Qt.Z=Nt},2293:function(oi,Qt,Dt){"use strict";Dt.d(Qt,{Z:function(){return re}});var ce=Dt(67294),Lt=Dt(68630),ge=Dt.n(Lt);function Nt(he,lt){if(he===lt)return!0;for(var ye=0;ye<he.length;ye++)if(!Object.is(he[ye],lt[ye]))return!1;return!0}function Rt(he,lt){var ye=(0,ce.useRef)({deps:lt,obj:void 0,initialized:!1}).current;return(ye.initialized===!1||!Nt(ye.deps,lt))&&(ye.deps=lt,ye.obj=he(),ye.initialized=!0),ye.obj}var ue=Dt(65353),se=function(){var he=(0,ue.__read)((0,ce.useState)({}),2),lt=he[1];return(0,ce.useCallback)(function(){return lt({})},[])},st=se,Ft=new WeakMap,Pt=new WeakMap;function It(he,lt){var ye=Ft.get(he);if(ye)return ye;if(Pt.has(he))return he;var ci=new Proxy(he,{get:function(Or,Ce,ti){var Ai=Reflect.get(Or,Ce,ti),Ti=Reflect.getOwnPropertyDescriptor(Or,Ce);return!(Ti==null?void 0:Ti.configurable)&&!(Ti==null?void 0:Ti.writable)?Ai:ge()(Ai)||Array.isArray(Ai)?It(Ai,lt):Ai},set:function(Or,Ce,ti){var Ai=Reflect.set(Or,Ce,ti);return lt(),Ai},deleteProperty:function(Or,Ce){var ti=Reflect.deleteProperty(Or,Ce);return lt(),ti}});return Ft.set(he,ci),Pt.set(ci,he),ci}function bt(he){var lt=st(),ye=(0,ce.useRef)(he),ci=Rt(function(){return It(ye.current,function(){lt()})},[]);return ci}var re=bt},99177:function(oi,Qt,Dt){"use strict";Dt.d(Qt,{Z:function(){return dn}});var ce=Dt(90484),Lt=Dt(96156),ge=Dt(22122),Nt=Dt(28481),Rt=Dt(94184),ue=Dt.n(Rt),se=Dt(85061),st=Dt(67294),Ft=Dt(96774),Pt=Dt.n(Ft),It=Dt(21770),bt=Dt(81253),re=Dt(28991),he=Dt(15105),lt=st.createContext({min:0,max:0,direction:"ltr",step:1,includedStart:0,includedEnd:0,tabIndex:0}),ye=lt;function ci(ne,Fr,Le){return(ne-Fr)/(Le-Fr)}function Or(ne,Fr,Le,Mr){var Xe=ci(Fr,Le,Mr),$e={};switch(ne){case"rtl":$e.right="".concat(Xe*100,"%"),$e.transform="translateX(50%)";break;case"btt":$e.bottom="".concat(Xe*100,"%"),$e.transform="translateY(50%)";break;case"ttb":$e.top="".concat(Xe*100,"%"),$e.transform="translateY(-50%)";break;default:$e.left="".concat(Xe*100,"%"),$e.transform="translateX(-50%)";break}return $e}function Ce(ne,Fr){return Array.isArray(ne)?ne[Fr]:ne}var ti=["prefixCls","value","valueIndex","onStartMove","style","render","dragging","onOffsetChange"],Ai=st.forwardRef(function(ne,Fr){var Le,Mr,Xe=ne.prefixCls,$e=ne.value,Gr=ne.valueIndex,Cr=ne.onStartMove,Br=ne.style,Ni=ne.render,Ri=ne.dragging,mi=ne.onOffsetChange,fi=(0,bt.Z)(ne,ti),Er=st.useContext(ye),Lr=Er.min,br=Er.max,zr=Er.direction,pi=Er.disabled,Tr=Er.range,zi=Er.tabIndex,gn=Er.ariaLabelForHandle,hn=Er.ariaLabelledByForHandle,mn=Er.ariaValueTextFormatterForHandle,Ki="".concat(Xe,"-handle"),$i=function(xe){pi||Cr(xe,Gr)},tn=function(xe){if(!pi){var rn=null;switch(xe.which||xe.keyCode){case he.Z.LEFT:rn=zr==="ltr"||zr==="btt"?-1:1;break;case he.Z.RIGHT:rn=zr==="ltr"||zr==="btt"?1:-1;break;case he.Z.UP:rn=zr!=="ttb"?1:-1;break;case he.Z.DOWN:rn=zr!=="ttb"?-1:1;break;case he.Z.HOME:rn="min";break;case he.Z.END:rn="max";break;case he.Z.PAGE_UP:rn=2;break;case he.Z.PAGE_DOWN:rn=-2;break}rn!==null&&(xe.preventDefault(),mi(rn,Gr))}},Vi=Or(zr,$e,Lr,br),en=st.createElement("div",(0,ge.Z)({ref:Fr,className:ue()(Ki,(Le={},(0,Lt.Z)(Le,"".concat(Ki,"-").concat(Gr+1),Tr),(0,Lt.Z)(Le,"".concat(Ki,"-dragging"),Ri),Le)),style:(0,re.Z)((0,re.Z)({},Vi),Br),onMouseDown:$i,onTouchStart:$i,onKeyDown:tn,tabIndex:pi?null:Ce(zi,Gr),role:"slider","aria-valuemin":Lr,"aria-valuemax":br,"aria-valuenow":$e,"aria-disabled":pi,"aria-label":Ce(gn,Gr),"aria-labelledby":Ce(hn,Gr),"aria-valuetext":(Mr=Ce(mn,Gr))===null||Mr===void 0?void 0:Mr($e)},fi));return Ni&&(en=Ni(en,{index:Gr,prefixCls:Xe,value:$e,dragging:Ri})),en}),Ti=Ai,Fn=["prefixCls","style","onStartMove","onOffsetChange","values","handleRender","draggingIndex"],xo=st.forwardRef(function(ne,Fr){var Le=ne.prefixCls,Mr=ne.style,Xe=ne.onStartMove,$e=ne.onOffsetChange,Gr=ne.values,Cr=ne.handleRender,Br=ne.draggingIndex,Ni=(0,bt.Z)(ne,Fn),Ri=st.useRef({});return st.useImperativeHandle(Fr,function(){return{focus:function(fi){var Er;(Er=Ri.current[fi])===null||Er===void 0||Er.focus()}}}),st.createElement(st.Fragment,null,Gr.map(function(mi,fi){return st.createElement(Ti,(0,ge.Z)({ref:function(Lr){Lr?Ri.current[fi]=Lr:delete Ri.current[fi]},dragging:Br===fi,prefixCls:Le,style:Ce(Mr,fi),key:fi,value:mi,valueIndex:fi,onStartMove:Xe,onOffsetChange:$e,render:Cr},Ni))}))}),Wi=xo;function Xi(ne){var Fr="touches"in ne?ne.touches[0]:ne;return{pageX:Fr.pageX,pageY:Fr.pageY}}function Ue(ne,Fr,Le,Mr,Xe,$e,Gr,Cr,Br){var Ni=st.useState(null),Ri=(0,Nt.Z)(Ni,2),mi=Ri[0],fi=Ri[1],Er=st.useState(-1),Lr=(0,Nt.Z)(Er,2),br=Lr[0],zr=Lr[1],pi=st.useState(Le),Tr=(0,Nt.Z)(pi,2),zi=Tr[0],gn=Tr[1],hn=st.useState(Le),mn=(0,Nt.Z)(hn,2),Ki=mn[0],$i=mn[1],tn=st.useRef(null),Vi=st.useRef(null);st.useEffect(function(){br===-1&&gn(Le)},[Le,br]),st.useEffect(function(){return function(){document.removeEventListener("mousemove",tn.current),document.removeEventListener("mouseup",Vi.current),document.removeEventListener("touchmove",tn.current),document.removeEventListener("touchend",Vi.current)}},[]);var en=function(nn,Jn){zi.some(function(io,no){return io!==nn[no]})&&(Jn!==void 0&&fi(Jn),gn(nn),Gr(nn))},Yi=function(nn,Jn){if(nn===-1){var io=Ki[0],no=Ki[Ki.length-1],qa=Mr-io,Sa=Xe-no,Ln=Jn*(Xe-Mr);Ln=Math.max(Ln,qa),Ln=Math.min(Ln,Sa);var ds=$e(io+Ln);Ln=ds-io;var na=Ki.map(function(Ia){return Ia+Ln});en(na)}else{var Hs=(Xe-Mr)*Jn,Zi=(0,se.Z)(zi);Zi[nn]=Ki[nn];var qn=Br(Zi,Hs,nn,"dist");en(qn.values,qn.value)}},xe=st.useRef(Yi);xe.current=Yi;var rn=function(nn,Jn){nn.stopPropagation();var io=Le[Jn];zr(Jn),fi(io),$i(Le);var no=Xi(nn),qa=no.pageX,Sa=no.pageY,Ln=function(Hs){Hs.preventDefault();var Zi=Xi(Hs),qn=Zi.pageX,Ia=Zi.pageY,Ka=qn-qa,ul=Ia-Sa,Ea=ne.current.getBoundingClientRect(),Qa=Ea.width,oa=Ea.height,oo;switch(Fr){case"btt":oo=-ul/oa;break;case"ttb":oo=ul/oa;break;case"rtl":oo=-Ka/Qa;break;default:oo=Ka/Qa}xe.current(Jn,oo)},ds=function na(Hs){Hs.preventDefault(),document.removeEventListener("mouseup",na),document.removeEventListener("mousemove",Ln),document.removeEventListener("touchend",na),document.removeEventListener("touchmove",Ln),tn.current=null,Vi.current=null,zr(-1),Cr()};document.addEventListener("mouseup",ds),document.addEventListener("mousemove",Ln),document.addEventListener("touchend",ds),document.addEventListener("touchmove",Ln),tn.current=Ln,Vi.current=ds},cn=st.useMemo(function(){var vn=(0,se.Z)(Le).sort(function(Jn,io){return Jn-io}),nn=(0,se.Z)(zi).sort(function(Jn,io){return Jn-io});return vn.every(function(Jn,io){return Jn===nn[io]})?zi:Le},[Le,zi]);return[br,mi,cn,rn]}function jo(ne){var Fr=ne.prefixCls,Le=ne.style,Mr=ne.start,Xe=ne.end,$e=ne.index,Gr=ne.onStartMove,Cr=st.useContext(ye),Br=Cr.direction,Ni=Cr.min,Ri=Cr.max,mi=Cr.disabled,fi=Cr.range,Er="".concat(Fr,"-track"),Lr=ci(Mr,Ni,Ri),br=ci(Xe,Ni,Ri),zr=function(zi){!mi&&Gr&&Gr(zi,-1)},pi={};switch(Br){case"rtl":pi.right="".concat(Lr*100,"%"),pi.width="".concat(br*100-Lr*100,"%");break;case"btt":pi.bottom="".concat(Lr*100,"%"),pi.height="".concat(br*100-Lr*100,"%");break;case"ttb":pi.top="".concat(Lr*100,"%"),pi.height="".concat(br*100-Lr*100,"%");break;default:pi.left="".concat(Lr*100,"%"),pi.width="".concat(br*100-Lr*100,"%")}return st.createElement("div",{className:ue()(Er,fi&&"".concat(Er,"-").concat($e+1)),style:(0,re.Z)((0,re.Z)({},pi),Le),onMouseDown:zr,onTouchStart:zr})}function Ma(ne){var Fr=ne.prefixCls,Le=ne.style,Mr=ne.values,Xe=ne.startPoint,$e=ne.onStartMove,Gr=st.useContext(ye),Cr=Gr.included,Br=Gr.range,Ni=Gr.min,Ri=st.useMemo(function(){if(!Br){if(Mr.length===0)return[];var mi=Xe!=null?Xe:Ni,fi=Mr[0];return[{start:Math.min(mi,fi),end:Math.max(mi,fi)}]}for(var Er=[],Lr=0;Lr<Mr.length-1;Lr+=1)Er.push({start:Mr[Lr],end:Mr[Lr+1]});return Er},[Mr,Br,Xe,Ni]);return Cr?Ri.map(function(mi,fi){var Er=mi.start,Lr=mi.end;return st.createElement(jo,{index:fi,prefixCls:Fr,style:Ce(Le,fi),start:Er,end:Lr,key:fi,onStartMove:$e})}):null}function ia(ne){var Fr=ne.prefixCls,Le=ne.style,Mr=ne.children,Xe=ne.value,$e=ne.onClick,Gr=st.useContext(ye),Cr=Gr.min,Br=Gr.max,Ni=Gr.direction,Ri=Gr.includedStart,mi=Gr.includedEnd,fi=Gr.included,Er="".concat(Fr,"-text"),Lr=Or(Ni,Xe,Cr,Br);return st.createElement("span",{className:ue()(Er,(0,Lt.Z)({},"".concat(Er,"-active"),fi&&Ri<=Xe&&Xe<=mi)),style:(0,re.Z)((0,re.Z)({},Lr),Le),onMouseDown:function(zr){zr.stopPropagation()},onClick:function(){$e(Xe)}},Mr)}function Ca(ne){var Fr=ne.prefixCls,Le=ne.marks,Mr=ne.onClick,Xe="".concat(Fr,"-mark");return Le.length?st.createElement("div",{className:Xe},Le.map(function($e){var Gr=$e.value,Cr=$e.style,Br=$e.label;return st.createElement(ia,{key:Gr,prefixCls:Xe,style:Cr,value:Gr,onClick:Mr},Br)})):null}function kr(ne){var Fr=ne.prefixCls,Le=ne.value,Mr=ne.style,Xe=ne.activeStyle,$e=st.useContext(ye),Gr=$e.min,Cr=$e.max,Br=$e.direction,Ni=$e.included,Ri=$e.includedStart,mi=$e.includedEnd,fi="".concat(Fr,"-dot"),Er=Ni&&Ri<=Le&&Le<=mi,Lr=(0,re.Z)((0,re.Z)({},Or(Br,Le,Gr,Cr)),typeof Mr=="function"?Mr(Le):Mr);return Er&&(Lr=(0,re.Z)((0,re.Z)({},Lr),typeof Xe=="function"?Xe(Le):Xe)),st.createElement("span",{className:ue()(fi,(0,Lt.Z)({},"".concat(fi,"-active"),Er)),style:Lr})}function ro(ne){var Fr=ne.prefixCls,Le=ne.marks,Mr=ne.dots,Xe=ne.style,$e=ne.activeStyle,Gr=st.useContext(ye),Cr=Gr.min,Br=Gr.max,Ni=Gr.step,Ri=st.useMemo(function(){var mi=new Set;if(Le.forEach(function(Er){mi.add(Er.value)}),Mr&&Ni!==null)for(var fi=Cr;fi<=Br;)mi.add(fi),fi+=Ni;return Array.from(mi)},[Cr,Br,Ni,Mr,Le]);return st.createElement("div",{className:"".concat(Fr,"-step")},Ri.map(function(mi){return st.createElement(kr,{prefixCls:Fr,key:mi,value:mi,style:Xe,activeStyle:$e})}))}function Ir(ne,Fr,Le,Mr,Xe,$e){var Gr=st.useCallback(function(Er){var Lr=isFinite(Er)?Er:ne;return Lr=Math.min(Fr,Er),Lr=Math.max(ne,Lr),Lr},[ne,Fr]),Cr=st.useCallback(function(Er){if(Le!==null){var Lr=ne+Math.round((Gr(Er)-ne)/Le)*Le,br=function(zi){return(String(zi).split(".")[1]||"").length},zr=Math.max(br(Le),br(Fr),br(ne)),pi=Number(Lr.toFixed(zr));return ne<=pi&&pi<=Fr?pi:null}return null},[Le,ne,Fr,Gr]),Br=st.useCallback(function(Er){var Lr=Gr(Er),br=Mr.map(function(Tr){return Tr.value});Le!==null&&br.push(Cr(Er)),br.push(ne,Fr);var zr=br[0],pi=Fr-ne;return br.forEach(function(Tr){var zi=Math.abs(Lr-Tr);zi<=pi&&(zr=Tr,pi=zi)}),zr},[ne,Fr,Mr,Le,Gr,Cr]),Ni=function Er(Lr,br,zr){var pi=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit";if(typeof br=="number"){var Tr,zi=Lr[zr],gn=zi+br,hn=[];Mr.forEach(function(Vi){hn.push(Vi.value)}),hn.push(ne,Fr),hn.push(Cr(zi));var mn=br>0?1:-1;pi==="unit"?hn.push(Cr(zi+mn*Le)):hn.push(Cr(gn)),hn=hn.filter(function(Vi){return Vi!==null}).filter(function(Vi){return br<0?Vi<=zi:Vi>=zi}),pi==="unit"&&(hn=hn.filter(function(Vi){return Vi!==zi}));var Ki=pi==="unit"?zi:gn;Tr=hn[0];var $i=Math.abs(Tr-Ki);if(hn.forEach(function(Vi){var en=Math.abs(Vi-Ki);en<$i&&(Tr=Vi,$i=en)}),Tr===void 0)return br<0?ne:Fr;if(pi==="dist")return Tr;if(Math.abs(br)>1){var tn=(0,se.Z)(Lr);return tn[zr]=Tr,Er(tn,br-mn,zr,pi)}return Tr}else{if(br==="min")return ne;if(br==="max")return Fr}},Ri=function(Lr,br,zr){var pi=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit",Tr=Lr[zr],zi=Ni(Lr,br,zr,pi);return{value:zi,changed:zi!==Tr}},mi=function(Lr){return $e===null&&Lr===0||typeof $e=="number"&&Lr<$e},fi=function(Lr,br,zr){var pi=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit",Tr=Lr.map(Br),zi=Tr[zr],gn=Ni(Tr,br,zr,pi);if(Tr[zr]=gn,Xe===!1){var hn=$e||0;zr>0&&Tr[zr-1]!==zi&&(Tr[zr]=Math.max(Tr[zr],Tr[zr-1]+hn)),zr<Tr.length-1&&Tr[zr+1]!==zi&&(Tr[zr]=Math.min(Tr[zr],Tr[zr+1]-hn))}else if(typeof $e=="number"||$e===null){for(var mn=zr+1;mn<Tr.length;mn+=1)for(var Ki=!0;mi(Tr[mn]-Tr[mn-1])&&Ki;){var $i=Ri(Tr,1,mn);Tr[mn]=$i.value,Ki=$i.changed}for(var tn=zr;tn>0;tn-=1)for(var Vi=!0;mi(Tr[tn]-Tr[tn-1])&&Vi;){var en=Ri(Tr,-1,tn-1);Tr[tn-1]=en.value,Vi=en.changed}for(var Yi=Tr.length-1;Yi>0;Yi-=1)for(var xe=!0;mi(Tr[Yi]-Tr[Yi-1])&&xe;){var rn=Ri(Tr,-1,Yi-1);Tr[Yi-1]=rn.value,xe=rn.changed}for(var cn=0;cn<Tr.length-1;cn+=1)for(var vn=!0;mi(Tr[cn+1]-Tr[cn])&&vn;){var nn=Ri(Tr,1,cn+1);Tr[cn+1]=nn.value,vn=nn.changed}}return{value:Tr[zr],values:Tr}};return[Br,fi]}var rd=Dt(80334),wu=st.forwardRef(function(ne,Fr){var Le,Mr=ne.prefixCls,Xe=Mr===void 0?"rc-slider":Mr,$e=ne.className,Gr=ne.style,Cr=ne.disabled,Br=Cr===void 0?!1:Cr,Ni=ne.autoFocus,Ri=ne.onFocus,mi=ne.onBlur,fi=ne.min,Er=fi===void 0?0:fi,Lr=ne.max,br=Lr===void 0?100:Lr,zr=ne.step,pi=zr===void 0?1:zr,Tr=ne.value,zi=ne.defaultValue,gn=ne.range,hn=ne.count,mn=ne.onChange,Ki=ne.onBeforeChange,$i=ne.onAfterChange,tn=ne.allowCross,Vi=tn===void 0?!0:tn,en=ne.pushable,Yi=en===void 0?!1:en,xe=ne.draggableTrack,rn=ne.reverse,cn=ne.vertical,vn=ne.included,nn=vn===void 0?!0:vn,Jn=ne.startPoint,io=ne.trackStyle,no=ne.handleStyle,qa=ne.railStyle,Sa=ne.dotStyle,Ln=ne.activeDotStyle,ds=ne.marks,na=ne.dots,Hs=ne.handleRender,Zi=ne.tabIndex,qn=Zi===void 0?0:Zi,Ia=ne.ariaLabelForHandle,Ka=ne.ariaLabelledByForHandle,ul=ne.ariaValueTextFormatterForHandle,Ea=st.useRef(),Qa=st.useRef(),oa=st.useMemo(function(){return cn?rn?"ttb":"btt":rn?"rtl":"ltr"},[rn,cn]),oo=st.useMemo(function(){return isFinite(Er)?Er:0},[Er]),_u=st.useMemo(function(){return isFinite(br)?br:100},[br]),ks=st.useMemo(function(){return pi!==null&&pi<=0?1:pi},[pi]),id=st.useMemo(function(){return Yi===!0?ks:Yi>=0?Yi:!1},[Yi,ks]),No=st.useMemo(function(){var Kn=Object.keys(ds||{});return Kn.map(function(ki){var wi=ds[ki],co={value:Number(ki)};return wi&&(0,ce.Z)(wi)==="object"&&!st.isValidElement(wi)&&("label"in wi||"style"in wi)?(co.style=wi.style,co.label=wi.label):co.label=wi,co}).filter(function(ki){var wi=ki.label;return wi||typeof wi=="number"}).sort(function(ki,wi){return ki.value-wi.value})},[ds]),nd=Ir(oo,_u,ks,No,Vi,id),nh=(0,Nt.Z)(nd,2),is=nh[0],wf=nh[1],od=(0,It.Z)(zi,{value:Tr}),_f=(0,Nt.Z)(od,2),Gs=_f[0],sd=_f[1],sa=st.useMemo(function(){var Kn=Gs==null?[]:Array.isArray(Gs)?Gs:[Gs],ki=(0,Nt.Z)(Kn,1),wi=ki[0],co=wi===void 0?oo:wi,Qr=Gs===null?[]:[co];if(gn){if(Qr=(0,se.Z)(Kn),hn||Gs===void 0){var ei=hn>=0?hn+1:2;for(Qr=Qr.slice(0,ei);Qr.length<ei;){var Vs;Qr.push((Vs=Qr[Qr.length-1])!==null&&Vs!==void 0?Vs:oo)}}Qr.sort(function(La,sh){return La-sh})}return Qr.forEach(function(La,sh){Qr[sh]=is(La)}),Qr},[Gs,gn,oo,hn,is]),ac=st.useRef(sa);ac.current=sa;var $a=function(ki){return gn?ki:ki[0]},uc=function(ki){var wi=(0,se.Z)(ki).sort(function(co,Qr){return co-Qr});mn&&!Pt()(wi,ac.current)&&mn($a(wi)),sd(wi)},gs=function(ki){if(!Br){var wi=0,co=_u-oo;sa.forEach(function(ei,Vs){var La=Math.abs(ki-ei);La<=co&&(co=La,wi=Vs)});var Qr=(0,se.Z)(sa);Qr[wi]=ki,gn&&!sa.length&&hn===void 0&&Qr.push(ki),Ki==null||Ki($a(Qr)),uc(Qr),$i==null||$i($a(Qr))}},ad=function(ki){ki.preventDefault();var wi=Qa.current.getBoundingClientRect(),co=wi.width,Qr=wi.height,ei=wi.left,Vs=wi.top,La=wi.bottom,sh=wi.right,Ws=ki.clientX,Ra=ki.clientY,tu;switch(oa){case"btt":tu=(La-Ra)/Qr;break;case"ttb":tu=(Ra-Vs)/Qr;break;case"rtl":tu=(sh-Ws)/co;break;default:tu=(Ws-ei)/co}var Im=oo+tu*(_u-oo);gs(is(Im))},ud=st.useState(null),Mf=(0,Nt.Z)(ud,2),Mu=Mf[0],ld=Mf[1],Sm=function(ki,wi){if(!Br){var co=wf(sa,ki,wi);Ki==null||Ki($a(sa)),uc(co.values),$i==null||$i($a(co.values)),ld(co.value)}};st.useEffect(function(){if(Mu!==null){var Kn=sa.indexOf(Mu);Kn>=0&&Ea.current.focus(Kn)}ld(null)},[Mu]);var Nn=st.useMemo(function(){return xe&&ks===null?!1:xe},[xe,ks]),oh=function(){$i==null||$i($a(ac.current))},lc=Ue(Qa,oa,sa,oo,_u,is,uc,oh,wf),ll=(0,Nt.Z)(lc,4),hc=ll[0],Ye=ll[1],ms=ll[2],hd=ll[3],on=function(ki,wi){hd(ki,wi),Ki==null||Ki($a(ac.current))},cd=hc!==-1;st.useEffect(function(){if(!cd){var Kn=sa.lastIndexOf(Ye);Ea.current.focus(Kn)}},[cd]);var vs=st.useMemo(function(){return(0,se.Z)(ms).sort(function(Kn,ki){return Kn-ki})},[ms]),Cf=st.useMemo(function(){return gn?[vs[0],vs[vs.length-1]]:[oo,vs[0]]},[vs,gn,oo]),bs=(0,Nt.Z)(Cf,2),fd=bs[0],pd=bs[1];st.useImperativeHandle(Fr,function(){return{focus:function(){Ea.current.focus(0)},blur:function(){var ki=document,wi=ki.activeElement;Qa.current.contains(wi)&&(wi==null||wi.blur())}}}),st.useEffect(function(){Ni&&Ea.current.focus(0)},[]);var Tf=st.useMemo(function(){return{min:oo,max:_u,direction:oa,disabled:Br,step:ks,included:nn,includedStart:fd,includedEnd:pd,range:gn,tabIndex:qn,ariaLabelForHandle:Ia,ariaLabelledByForHandle:Ka,ariaValueTextFormatterForHandle:ul}},[oo,_u,oa,Br,ks,nn,fd,pd,gn,qn,Ia,Ka,ul]);return st.createElement(ye.Provider,{value:Tf},st.createElement("div",{ref:Qa,className:ue()(Xe,$e,(Le={},(0,Lt.Z)(Le,"".concat(Xe,"-disabled"),Br),(0,Lt.Z)(Le,"".concat(Xe,"-vertical"),cn),(0,Lt.Z)(Le,"".concat(Xe,"-horizontal"),!cn),(0,Lt.Z)(Le,"".concat(Xe,"-with-marks"),No.length),Le)),style:Gr,onMouseDown:ad},st.createElement("div",{className:"".concat(Xe,"-rail"),style:qa}),st.createElement(Ma,{prefixCls:Xe,style:io,values:vs,startPoint:Jn,onStartMove:Nn?on:null}),st.createElement(ro,{prefixCls:Xe,marks:No,dots:na,style:Sa,activeStyle:Ln}),st.createElement(Wi,{ref:Ea,prefixCls:Xe,style:no,values:ms,draggingIndex:hc,onStartMove:on,onOffsetChange:Sm,onFocus:Ri,onBlur:mi,handleRender:Hs}),st.createElement(Ca,{prefixCls:Xe,marks:No,onClick:gs})))}),ih=wu,xf=ih,Ta=Dt(53124),sl=Dt(75164),al=Dt(42550),We=Dt(45777),Bn=st.forwardRef(function(ne,Fr){var Le=ne.open,Mr=(0,st.useRef)(null),Xe=(0,st.useRef)(null);function $e(){sl.Z.cancel(Xe.current),Xe.current=null}function Gr(){Xe.current=(0,sl.Z)(function(){var Cr;(Cr=Mr.current)===null||Cr===void 0||Cr.forcePopupAlign(),Xe.current=null})}return st.useEffect(function(){return Le?Gr():$e(),$e},[Le,ne.title]),st.createElement(We.Z,(0,ge.Z)({ref:(0,al.sQ)(Mr,Fr)},ne))}),rs=Bn,Af=function(ne,Fr){var Le={};for(var Mr in ne)Object.prototype.hasOwnProperty.call(ne,Mr)&&Fr.indexOf(Mr)<0&&(Le[Mr]=ne[Mr]);if(ne!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Xe=0,Mr=Object.getOwnPropertySymbols(ne);Xe<Mr.length;Xe++)Fr.indexOf(Mr[Xe])<0&&Object.prototype.propertyIsEnumerable.call(ne,Mr[Xe])&&(Le[Mr[Xe]]=ne[Mr[Xe]]);return Le},Ge=st.forwardRef(function(ne,Fr){var Le=st.useContext(Ta.E_),Mr=Le.getPrefixCls,Xe=Le.direction,$e=Le.getPopupContainer,Gr=st.useState({}),Cr=(0,Nt.Z)(Gr,2),Br=Cr[0],Ni=Cr[1],Ri=function($i,tn){Ni(function(Vi){return(0,ge.Z)((0,ge.Z)({},Vi),(0,Lt.Z)({},$i,tn))})},mi=function($i,tn){return $i||(tn?Xe==="rtl"?"left":"right":"top")},fi=ne.prefixCls,Er=ne.range,Lr=ne.className,br=Af(ne,["prefixCls","range","className"]),zr=Mr("slider",fi),pi=ue()(Lr,(0,Lt.Z)({},"".concat(zr,"-rtl"),Xe==="rtl"));Xe==="rtl"&&!br.vertical&&(br.reverse=!br.reverse);var Tr=st.useMemo(function(){return Er?(0,ce.Z)(Er)==="object"?[!0,Er.draggableTrack]:[!0,!1]:[!1]},[Er]),zi=(0,Nt.Z)(Tr,2),gn=zi[0],hn=zi[1],mn=function($i,tn){var Vi,en=tn.index,Yi=tn.dragging,xe=Mr(),rn=ne.tooltip,cn=rn===void 0?{}:rn,vn=ne.vertical,nn=(0,ge.Z)({formatter:(Vi=ne.tipFormatter)!==null&&Vi!==void 0?Vi:function(Zi){return typeof Zi=="number"?Zi.toString():""},open:ne.tooltipVisible,placement:ne.tooltipPlacement,getPopupContainer:ne.getTooltipPopupContainer},cn),Jn=nn.open,io=nn.placement,no=nn.getPopupContainer,qa=nn.prefixCls,Sa=nn.formatter,Ln=Sa?Br[en]||Yi:!1,ds=Jn||Jn===void 0&&Ln,na=(0,ge.Z)((0,ge.Z)({},$i.props),{onMouseEnter:function(){return Ri(en,!0)},onMouseLeave:function(){return Ri(en,!1)}}),Hs=Mr("tooltip",qa);return st.createElement(rs,{prefixCls:Hs,title:Sa?Sa(tn.value):"",open:ds,placement:mi(io,vn),transitionName:"".concat(xe,"-zoom-down"),key:en,overlayClassName:"".concat(zr,"-tooltip"),getPopupContainer:no||$e},st.cloneElement($i,na))};return st.createElement(xf,(0,ge.Z)({},br,{step:br.step,range:gn,draggableTrack:hn,className:pi,ref:Fr,prefixCls:zr,handleRender:mn}))}),dn=Ge},66126:function(oi,Qt,Dt){"use strict";var ce=Dt(38663),Lt=Dt.n(ce),ge=Dt(34294),Nt=Dt.n(ge),Rt=Dt(22385)},85924:function(oi,Qt,Dt){var ce=Dt(5569),Lt=ce(Object.getPrototypeOf,Object);oi.exports=Lt},5569:function(oi){function Qt(Dt,ce){return function(Lt){return Dt(ce(Lt))}}oi.exports=Qt},68630:function(oi,Qt,Dt){var ce=Dt(44239),Lt=Dt(85924),ge=Dt(37005),Nt="[object Object]",Rt=Function.prototype,ue=Object.prototype,se=Rt.toString,st=ue.hasOwnProperty,Ft=se.call(Object);function Pt(It){if(!ge(It)||ce(It)!=Nt)return!1;var bt=Lt(It);if(bt===null)return!0;var re=st.call(bt,"constructor")&&bt.constructor;return typeof re=="function"&&re instanceof re&&se.call(re)==Ft}oi.exports=Pt},70507:function(oi,Qt,Dt){function ce(Lt,ge,Nt){for(var Rt=ge.length,ue=new Uint8Array(3*Rt/4-(ge[Rt-2]=="="?2:ge[Rt-1]=="="?1:0)),se=new Uint8Array(130),st=0;64>st;st++)se["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(st)]=st;for(var Ft=st=0;st<Rt;st+=4){var Pt=se[ge.charCodeAt(st+1)],It=se[ge.charCodeAt(st+2)];ue[Ft++]=se[ge.charCodeAt(st)]<<2|Pt>>4,ue[Ft++]=(Pt&15)<<4|It>>2,ue[Ft++]=(It&3)<<6|se[ge.charCodeAt(st+3)]&63}return Nt&&!Lt?WebAssembly.instantiate(ue,Nt):Nt||Lt?(Lt=new WebAssembly.Module(ue),Nt?new WebAssembly.Instance(Lt,Nt):Lt):WebAssembly.compile(ue)}(function(Lt,ge){ge(Qt)})(this,function(Lt){function ge(a){this.options=a||{},this.paneName=this.options.paneName||"labelPane",this.zIndex=this.options.zIndex||1,this._map=a.map,this._lastDrawTime=null,this.show()}function Nt(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}function Rt(a,u){return u={exports:{}},a(u,u.exports),u.exports}function ue(a,u){return function(n){return u(a(n))}}function se(a){var u=function(n){return n==null?n:(1<arguments.length&&(n=Array.prototype.slice.call(arguments)),a(n))};return"conversion"in a&&(u.conversion=a.conversion),u}function st(a){var u=function(n){if(n==null)return n;1<arguments.length&&(n=Array.prototype.slice.call(arguments));var l=a(n);if((typeof l=="undefined"?"undefined":si(l))==="object")for(var v=l.length,d=0;d<v;d++)l[d]=Math.round(l[d]);return l};return"conversion"in a&&(u.conversion=a.conversion),u}function Ft(a,u){if(!(this instanceof Ft))return new Ft(a,u);if(u&&u in zm&&(u=null),u&&!(u in Cs))throw Error("Unknown model: "+u);if(typeof a=="undefined")this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(a instanceof Ft)this.model=a.model,this.color=a.color.slice(),this.valpha=a.valpha;else if(typeof a=="string"){if(u=Tc.get(a),u===null)throw Error("Unable to parse color from string: "+a);this.model=u.model;var n=Cs[this.model].channels;this.color=u.value.slice(0,n),this.valpha=typeof u.value[n]=="number"?u.value[n]:1}else if(a.length)this.model=u||"rgb",n=Cs[this.model].channels,u=Dd.call(a,0,n),this.color=re(u,n),this.valpha=typeof a[n]=="number"?a[n]:1;else if(typeof a=="number")a&=16777215,this.model="rgb",this.color=[a>>16&255,a>>8&255,a&255],this.valpha=1;else{if(this.valpha=1,u=Un(a),"alpha"in a&&(u.splice(u.indexOf("alpha"),1),this.valpha=typeof a.alpha=="number"?a.alpha:0),u=u.sort().join(""),!(u in Od))throw Error("Unable to parse color from object: "+Ah(a));this.model=Od[u],n=Cs[this.model].labels;var l=[];for(u=0;u<n.length;u++)l.push(a[n[u]]);this.color=re(l)}if(wo[this.model])for(n=Cs[this.model].channels,u=0;u<n;u++)(a=wo[this.model][u])&&(this.color[u]=a(this.color[u]));this.valpha=Math.max(0,Math.min(1,this.valpha)),pa&&pa(this)}function Pt(a){return function(u){return Number(u.toFixed(a))}}function It(a,u,n){return a=Array.isArray(a)?a:[a],a.forEach(function(l){(wo[l]||(wo[l]=[]))[u]=n}),a=a[0],function(l){if(arguments.length){n&&(l=n(l));var v=this[a]();return v.color[u]=l,v}return v=this[a]().color[u],n&&(v=n(v)),v}}function bt(a){return function(u){return Math.max(0,Math.min(a,u))}}function re(a,u){for(var n=0;n<u;n++)typeof a[n]!="number"&&(a[n]=0);return a}function he(a){return a*Math.PI/180}function lt(a){return a/Math.PI*180}function ye(a){return Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))}function ci(a){return Math.pow(2,Math.floor(Math.log(a)/Math.LN2))}function Or(a,u){return 1e-8>Math.abs(a-u)}function Ce(a){var u=a[0],n=a[a.length-1];return Math.sqrt(Math.pow(u[0]-n[0],2)+Math.pow(u[1]-n[1],2)+Math.pow((u[2]||0)-(n[2]||0),2))<(1<arguments.length&&arguments[1]!==void 0?arguments[1]:2e-7)}function ti(){}function Ai(a,u){for(var n in u)a[n]=u[n]}function Ti(a,u){this.lng=a,this.lat=u}function Fn(a,u){this.x=a,this.y=u}function xo(a,u){var n=document.createElement("canvas");return a&&(n.width=a),u&&(n.height=u),n}function Wi(a){a=a||{},this.gradient=a.gradient||{"0.25":"rgba(0, 0, 255, 1)","0.55":"rgba(0, 255, 0, 1)","0.85":"rgba(255, 255, 0, 1)",1:"rgba(255, 0, 0, 1)"},this.maxSize=a.maxSize===void 0?35:a.maxSize,this.minSize=a.minSize||0,this.max=a.max||100,this.min=a.min||0,this.initPalette()}function Xi(a){this.options=a||{},this._initialize()}function Ue(a,u,n,l,v){var d=1-a,x=1-a;return d*d*d*u+3*x*x*a*n+3*(1-a)*a*a*l+a*a*a*v}function jo(a){this.WORLD_SIZE_MC_HALF=20037726372307256e-9,this.WORLD_SIZE_MC=2*this.WORLD_SIZE_MC_HALF,this.options=a||{},this._initialize()}function Ma(a,u){return a&&u?Math.round(Math.sqrt(Math.pow(a.lng-u.lng,2)+Math.pow(a.lat-u.lat,2))):0}function ia(a){return a=a.split("|"),a[0]=a[0].split(","),{lng:parseFloat(a[0][0]),lat:parseFloat(a[0][1])}}function Ca(a){for(var u=a.length;0<=--u;)a[u]=0}function kr(a,u,n,l,v){this.static_tree=a,this.extra_bits=u,this.extra_base=n,this.elems=l,this.max_length=v,this.has_stree=a&&a.length}function ro(a,u){this.dyn_tree=a,this.max_code=0,this.stat_desc=u}function Ir(a,u,n,l,v){this.good_length=a,this.max_lazy=u,this.nice_length=n,this.max_chain=l,this.func=v}function rd(){this.strm=null,this.status=0,this.pending_buf=null,this.wrap=this.pending=this.pending_out=this.pending_buf_size=0,this.gzhead=null,this.gzindex=0,this.method=_o,this.last_flush=-1,this.w_mask=this.w_bits=this.w_size=0,this.window=null,this.window_size=0,this.head=this.prev=null,this.nice_match=this.good_match=this.strategy=this.level=this.max_lazy_match=this.max_chain_length=this.prev_length=this.lookahead=this.match_start=this.strstart=this.match_available=this.prev_match=this.match_length=this.block_start=this.hash_shift=this.hash_mask=this.hash_bits=this.hash_size=this.ins_h=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Tl(this.dyn_ltree),Tl(this.dyn_dtree),Tl(this.bl_tree),this.bl_desc=this.d_desc=this.l_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Tl(this.heap),this.heap_max=this.heap_len=0,this.depth=new Uint16Array(573),Tl(this.depth),this.bi_valid=this.bi_buf=this.insert=this.matches=this.static_len=this.opt_len=this.d_buf=this.last_lit=this.lit_bufsize=this.l_buf=0}function wu(a){a=this.options=Ec.assign({level:$x,method:u1,chunkSize:16384,windowBits:15,memLevel:8,strategy:tA},a||{}),a.raw&&0<a.windowBits?a.windowBits=-a.windowBits:a.gzip&&0<a.windowBits&&16>a.windowBits&&(a.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Sh,this.strm.avail_out=0;var u=Ic.deflateInit2(this.strm,a.level,a.method,a.windowBits,a.memLevel,a.strategy);if(u!==Ih)throw Error(Wn[u]);if(a.header&&Ic.deflateSetHeader(this.strm,a.header),a.dictionary){if(a=typeof a.dictionary=="string"?Sl.string2buf(a.dictionary):jm.call(a.dictionary)==="[object ArrayBuffer]"?new Uint8Array(a.dictionary):a.dictionary,u=Ic.deflateSetDictionary(this.strm,a),u!==Ih)throw Error(Wn[u]);this._dict_set=!0}}function ih(a,u){if(u=new wu(u),u.push(a,!0),u.err)throw u.msg||Wn[u.err];return u.result}function xf(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.total=this.check=this.dmax=this.flags=0,this.head=null,this.wnext=this.whave=this.wsize=this.wbits=0,this.window=null,this.extra=this.offset=this.length=this.bits=this.hold=0,this.distcode=this.lencode=null,this.have=this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.distdyn=this.lendyn=null,this.was=this.back=this.sane=0}function Ta(a){var u=this.options=Ec.assign({chunkSize:65536,windowBits:15,to:""},a||{});if(u.raw&&0<=u.windowBits&&16>u.windowBits&&(u.windowBits=-u.windowBits,u.windowBits===0&&(u.windowBits=-15)),!(0<=u.windowBits&&16>u.windowBits)||a&&a.windowBits||(u.windowBits+=32),15<u.windowBits&&48>u.windowBits&&(u.windowBits&15)==0&&(u.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Sh,this.strm.avail_out=0,a=Nu.inflateInit2(this.strm,u.windowBits),a!==tp||(this.header=new d1,Nu.inflateGetHeader(this.strm,this.header),u.dictionary&&(typeof u.dictionary=="string"?u.dictionary=Sl.string2buf(u.dictionary):$m.call(u.dictionary)==="[object ArrayBuffer]"&&(u.dictionary=new Uint8Array(u.dictionary)),u.raw&&(a=Nu.inflateSetDictionary(this.strm,u.dictionary),a!==tp))))throw Error(Wn[a])}function sl(a,u){if(u=new Ta(u),u.push(a),u.err)throw u.msg||Wn[u.err];return u.result}function al(a,u){for(var n=["webgl2","experimental-webgl2","webgl","experimental-webgl"],l=void 0,v=0;v<n.length;v++)try{if(l=a.getContext(n[v],{stencil:!0,alpha:!0,premultipliedAlpha:!1,antialias:u.antialias||!0,preserveDrawingBuffer:u.preserveDrawingBuffer||!1}))break}catch(d){}return l}function We(a,u,n){var l=3<arguments.length&&arguments[3]!==void 0?arguments[3]:{};n=Ur({TEXTURE_MAG_FILTER:"LINEAR",TEXTURE_MIN_FILTER:"LINEAR",TEXTURE_WRAP_S:"REPEAT",TEXTURE_WRAP_T:"REPEAT"},n);var v=a.createTexture();if(a.bindTexture(a.TEXTURE_2D,v),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,l.flipY||!0),l.format&&l.width){var d=a.LUMINANCE;l.format&&(d=a[l.format]),l.format!=="RGBA"&&l.format!=="RGB"?(u=new Float32Array(u),a.texImage2D(a.TEXTURE_2D,0,a.R32F,l.width,l.height,0,a.RED,a[l.type]||a.FLOAT,u)):a.texImage2D(a.TEXTURE_2D,0,d,l.width,l.height,0,d,a[l.type]||a.FLOAT,u)}else a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,u);for(var x in n)a.texParameteri(a.TEXTURE_2D,a[x],a[n[x]]);return a.bindTexture(a.TEXTURE_2D,null),{texture:v,data:{width:l.width,height:l.height,data:u,type:l.type}}}function Bn(a,u,n,l,v){if((typeof u=="undefined"?"undefined":si(u))==="object")u=We(a,u,l,v),n(u.texture,null,u.data);else{var d=new Image;d.crossOrigin="anonymous",d.onload=function(){var x=ci(d.width),y=ci(d.height),M=document.createElement("canvas");M.width=x,M.height=y;var D=M.getContext("2d");D.drawImage(d,0,0,x,y),d=M,M=We(a,d,l,v).texture,n(M,d,{width:x,height:y,data:D.getImageData(0,0,x,y),type:"RGBA"})},d.src=u}}function rs(a,u){if(u instanceof Array){var n={zero:a.ZERO,one:a.ONE,src_color:a.SRC_COLOR,one_minus_src_color:a.ONE_MINUS_SRC_COLOR,dst_color:a.DST_COLOR,one_minus_dst_color:a.ONE_MINUS_DST_COLOR,src_alpha:a.SRC_ALPHA,one_minus_src_alpha:a.ONE_MINUS_SRC_ALPHA,dst_alpha:a.DST_ALPHA,one_minus_dst_alpha:a.ONE_MINUS_DST_ALPHA,constant_color:a.CONSTANT_COLOR,one_minus_constant_color:a.ONE_MINUS_CONSTANT_COLOR,constant_alpha:a.CONSTANT_ALPHA,one_minus_constant_alpha:a.ONE_MINUS_CONSTANT_ALPHA,src_alpha_saturate:a.SRC_ALPHA_SATURATE};return u.map(function(l){return n[l]})}switch(u){case"default":return Hm?[a.SRC_ALPHA,a.ZERO,a.ONE,a.ZERO]:[a.ONE,a.ZERO];case"deeper":return[a.ONE,a.ONE_MINUS_SRC_ALPHA];case"normal":return[a.SRC_ALPHA,a.ONE];case"lighter":return[a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA];default:return[a.ONE,a.ZERO]}}function Af(a,u){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:[],l=3<arguments.length&&arguments[3]!==void 0?arguments[3]:"#ccc",v=4<arguments.length&&arguments[4]!==void 0?arguments[4]:1,d=document.createElement("canvas"),x=d.getContext("2d");d.width=256,d.height=v,d=u[0];var y=u[u.length-1];if(a.length===u.length){for(var M=x.createLinearGradient(0,0,256,1),D=0;D<a.length;++D)M.addColorStop((u[D]-d)/(y-d),a[D]);x.fillStyle=M,x.fillRect(0,0,256,v)}else if(a.length-u.length==-1){M=0,D=1;for(var U=0;U<a.length;++U){var C=Math.floor((u[D]-d)/(y-d)*256);x.fillStyle=a[U],x.fillRect(M,0,C,v),M=C,D++}}else x.fillStyle=l||"#ccc",x.fillRect(0,0,256,v);return-1>=a.length-u.length&&n.length===2&&(x.fillStyle=l||"#ccc",l=(n[0]-d)/(y-d),l=Math.floor(256*l),x.fillRect(0,0,l,v),l=(n[1]-d)/(y-d),l=Math.floor(256*l),x.fillRect(l,0,255,v)),{data:new Uint8Array(new Uint8ClampedArray(x.getImageData(0,0,256,v).data)),width:256,height:v}}function Ge(a,u,n){n=n||2;var l=u&&u.length,v=l?u[0]*n:a.length,d=dn(a,0,v,n,!0),x=[];if(!d||d.next===d.prev)return x;var y;if(l){var M=n;l=[];var D,U=0;for(D=u.length;U<D;U++){var C=u[U]*M,E=U<D-1?u[U+1]*M:a.length;C=dn(a,C,E,M,!1),C===C.next&&(C.steiner=!0),l.push(Gr(C))}for(l.sort(Mr),U=0;U<l.length;U++)M=l[U],u=d,(u=Xe(M,u))&&(M=Lr(u,M),ne(u,u.next),ne(M,M.next)),d=ne(d,d.next)}if(a.length>80*n){var B=y=a[0],O=l=a[1];for(M=n;M<v;M+=n)U=a[M],u=a[M+1],U<B&&(B=U),u<O&&(O=u),U>y&&(y=U),u>l&&(l=u);y=Math.max(y-B,l-O),y=y!==0?1/y:0}return Fr(d,x,n,B,O,y),x}function dn(a,u,n,l,v){if(v===0<Tr(a,u,n,l))for(v=u;v<n;v+=l)var d=br(v,a[v],a[v+1],d);else for(v=n-l;v>=u;v-=l)d=br(v,a[v],a[v+1],d);return d&&Ni(d,d.next)&&(zr(d),d=d.next),d}function ne(a,u){if(!a)return a;u||(u=a);do{var n=!1;if(a.steiner||!Ni(a,a.next)&&Br(a.prev,a,a.next)!==0)a=a.next;else{if(zr(a),a=u=a.prev,a===a.next)break;n=!0}}while(n||a!==u);return u}function Fr(a,u,n,l,v,d,x){if(a){if(!x&&d){var y=a,M=y;do M.z===null&&(M.z=$e(M.x,M.y,l,v,d)),M.prevZ=M.prev,M=M.nextZ=M.next;while(M!==y);M.prevZ.nextZ=null,M.prevZ=null,y=M;var D,U,C,E,B=1;do{M=y;var O=y=null;for(U=0;M;){U++;var H=M;for(D=C=0;D<B&&(C++,H=H.nextZ,H);D++);for(E=B;0<C||0<E&&H;)C!==0&&(E===0||!H||M.z<=H.z)?(D=M,M=M.nextZ,C--):(D=H,H=H.nextZ,E--),O?O.nextZ=D:y=D,D.prevZ=O,O=D;M=H}O.nextZ=null,B*=2}while(1<U)}for(y=a;a.prev!==a.next;){if(M=a.prev,H=a.next,d)O=Le(a,l,v,d);else t:if(O=a,U=O.prev,C=O,B=O.next,0<=Br(U,C,B))O=!1;else{for(D=O.next.next;D!==O.prev;){if(Cr(U.x,U.y,C.x,C.y,B.x,B.y,D.x,D.y)&&0<=Br(D.prev,D,D.next)){O=!1;break t}D=D.next}O=!0}if(O)u.push(M.i/n),u.push(a.i/n),u.push(H.i/n),zr(a),y=a=H.next;else if(a=H,a===y){if(!x)Fr(ne(a),u,n,l,v,d,1);else if(x===1){a=ne(a),x=u,y=n,M=a;do H=M.prev,O=M.next.next,!Ni(H,O)&&Ri(H,M,M.next,O)&&Er(H,O)&&Er(O,H)&&(x.push(H.i/y),x.push(M.i/y),x.push(O.i/y),zr(M),zr(M.next),M=a=O),M=M.next;while(M!==a);a=ne(M),Fr(a,u,n,l,v,d,2)}else if(x===2)t:{x=a;do{for(y=x.next.next;y!==x.prev;){if(M=x.i!==y.i){if(M=x,H=y,O=M.next.i!==H.i&&M.prev.i!==H.i){e:{O=M;do{if(O.i!==M.i&&O.next.i!==M.i&&O.i!==H.i&&O.next.i!==H.i&&Ri(O,O.next,M,H)){O=!0;break e}O=O.next}while(O!==M);O=!1}O=!O}if(O){if(O=Er(M,H)&&Er(H,M)){O=M,U=!1,C=(M.x+H.x)/2,B=(M.y+H.y)/2;do O.y>B!=O.next.y>B&&O.next.y!==O.y&&C<(O.next.x-O.x)*(B-O.y)/(O.next.y-O.y)+O.x&&(U=!U),O=O.next;while(O!==M);O=U}O=O&&(Br(M.prev,M,H.prev)||Br(M,H.prev,H))||Ni(M,H)&&0<Br(M.prev,M,M.next)&&0<Br(H.prev,H,H.next)}M=O}if(M){a=Lr(x,y),x=ne(x,x.next),a=ne(a,a.next),Fr(x,u,n,l,v,d),Fr(a,u,n,l,v,d);break t}y=y.next}x=x.next}while(x!==a)}break}}}}function Le(a,u,n,l){var v=a.prev,d=a.next;if(0<=Br(v,a,d))return!1;var x=v.x>a.x?v.x>d.x?v.x:d.x:a.x>d.x?a.x:d.x,y=v.y>a.y?v.y>d.y?v.y:d.y:a.y>d.y?a.y:d.y,M=$e(v.x<a.x?v.x<d.x?v.x:d.x:a.x<d.x?a.x:d.x,v.y<a.y?v.y<d.y?v.y:d.y:a.y<d.y?a.y:d.y,u,n,l);for(u=$e(x,y,u,n,l),n=a.prevZ,l=a.nextZ;n&&n.z>=M&&l&&l.z<=u;){if(n!==a.prev&&n!==a.next&&Cr(v.x,v.y,a.x,a.y,d.x,d.y,n.x,n.y)&&0<=Br(n.prev,n,n.next)||(n=n.prevZ,l!==a.prev&&l!==a.next&&Cr(v.x,v.y,a.x,a.y,d.x,d.y,l.x,l.y)&&0<=Br(l.prev,l,l.next)))return!1;l=l.nextZ}for(;n&&n.z>=M;){if(n!==a.prev&&n!==a.next&&Cr(v.x,v.y,a.x,a.y,d.x,d.y,n.x,n.y)&&0<=Br(n.prev,n,n.next))return!1;n=n.prevZ}for(;l&&l.z<=u;){if(l!==a.prev&&l!==a.next&&Cr(v.x,v.y,a.x,a.y,d.x,d.y,l.x,l.y)&&0<=Br(l.prev,l,l.next))return!1;l=l.nextZ}return!0}function Mr(a,u){return a.x-u.x}function Xe(a,u){var n=u,l=a.x,v=a.y,d=-Infinity;do{if(v<=n.y&&v>=n.next.y&&n.next.y!==n.y){var x=n.x+(v-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(x<=l&&x>d){if(d=x,x===l){if(v===n.y)return n;if(v===n.next.y)return n.next}var y=n.x<n.next.x?n:n.next}}n=n.next}while(n!==u);if(!y)return null;if(l===d)return y;u=y,x=y.x;var M=y.y,D=Infinity;n=y;do{if(l>=n.x&&n.x>=x&&l!==n.x&&Cr(v<M?l:d,v,x,M,v<M?d:l,v,n.x,n.y)){var U=Math.abs(v-n.y)/(l-n.x),C;if((C=Er(n,a))&&!(C=U<D)&&(C=U===D)&&!(C=n.x>y.x)&&(C=n.x===y.x)){C=y;var E=n;C=0>Br(C.prev,C,E.prev)&&0>Br(E.next,C,C.next)}C&&(y=n,D=U)}n=n.next}while(n!==u);return y}function $e(a,u,n,l,v){return a=32767*(a-n)*v,u=32767*(u-l)*v,a=(a|a<<8)&16711935,a=(a|a<<4)&252645135,a=(a|a<<2)&858993459,u=(u|u<<8)&16711935,u=(u|u<<4)&252645135,u=(u|u<<2)&858993459,(a|a<<1)&1431655765|((u|u<<1)&1431655765)<<1}function Gr(a){var u=a,n=a;do(u.x<n.x||u.x===n.x&&u.y<n.y)&&(n=u),u=u.next;while(u!==a);return n}function Cr(a,u,n,l,v,d,x,y){return 0<=(v-x)*(u-y)-(a-x)*(d-y)&&0<=(a-x)*(l-y)-(n-x)*(u-y)&&0<=(n-x)*(d-y)-(v-x)*(l-y)}function Br(a,u,n){return(u.y-a.y)*(n.x-u.x)-(u.x-a.x)*(n.y-u.y)}function Ni(a,u){return a.x===u.x&&a.y===u.y}function Ri(a,u,n,l){var v=fi(Br(a,u,n)),d=fi(Br(a,u,l)),x=fi(Br(n,l,a)),y=fi(Br(n,l,u));return!!(v!==d&&x!==y||v===0&&mi(a,n,u)||d===0&&mi(a,l,u)||x===0&&mi(n,a,l)||y===0&&mi(n,u,l))}function mi(a,u,n){return u.x<=Math.max(a.x,n.x)&&u.x>=Math.min(a.x,n.x)&&u.y<=Math.max(a.y,n.y)&&u.y>=Math.min(a.y,n.y)}function fi(a){return 0<a?1:0>a?-1:0}function Er(a,u){return 0>Br(a.prev,a,a.next)?0<=Br(a,u,a.next)&&0<=Br(a,a.prev,u):0>Br(a,u,a.prev)||0>Br(a,a.next,u)}function Lr(a,u){var n=new pi(a.i,a.x,a.y),l=new pi(u.i,u.x,u.y),v=a.next,d=u.prev;return a.next=u,u.prev=a,n.next=v,v.prev=n,l.next=n,n.prev=l,d.next=l,l.prev=d,l}function br(a,u,n,l){return a=new pi(a,u,n),l?(a.next=l.next,a.prev=l,l.next.prev=a,l.next=a):(a.prev=a,a.next=a),a}function zr(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function pi(a,u,n){this.i=a,this.x=u,this.y=n,this.nextZ=this.prevZ=this.z=this.next=this.prev=null,this.steiner=!1}function Tr(a,u,n,l){for(var v=0,d=n-l;u<n;u+=l)v+=(a[d]-a[u])*(a[u+1]+a[d+1]),d=u;return v}function zi(a){try{return zu.createObjectURL(new Blob([a],{type:"application/javascript"}))}catch(n){var u=new sA;return u.append(a),zu.createObjectURL(u.getBlob(type))}}function gn(a,u){this.shapeLayer=a,this.gl=u,this.initData()}function hn(a,u,n,l){var v=[];return l=l*Math.PI/180,v[0]=(a-n[0])*Math.cos(l)-(u-n[1])*Math.sin(l)+n[0],v[1]=(a-n[0])*Math.sin(l)+(u-n[1])*Math.cos(l)+n[1],v}function mn(a){var u=0,n=0,l=!0,v=!1,d=void 0;try{for(var x=as(a),y;!(l=(y=x.next()).done);l=!0){var M=y.value;u+=M.w*M.h,n=Math.max(n,M.w)}}catch(H){v=!0,d=H}finally{try{!l&&x.return&&x.return()}finally{if(v)throw d}}a.sort(function(H,V){return V.h-H.h}),n=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(u/.95)),n),h:Infinity}],v=l=0,d=!0,x=!1,y=void 0;try{for(var D=as(a),U;!(d=(U=D.next()).done);d=!0)for(var C=U.value,E=n.length-1;0<=E;E--){var B=n[E];if(!(C.w>B.w||C.h>B.h)){if(C.x=B.x,C.y=B.y,v=Math.max(v,C.y+C.h),l=Math.max(l,C.x+C.w),C.w===B.w&&C.h===B.h){var O=n.pop();E<n.length&&(n[E]=O)}else C.h===B.h?(B.x+=C.w,B.w-=C.w):(C.w!==B.w&&n.push({x:B.x+C.w,y:B.y,w:B.w-C.w,h:C.h}),B.y+=C.h,B.h-=C.h);break}}}catch(H){x=!0,y=H}finally{try{!d&&D.return&&D.return()}finally{if(x)throw y}}return{w:l,h:v,fill:u/(l*v)||0}}function Ki(){ng=!0;for(var a=0;64>a;++a)va[a]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[a],Es["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(a)]=a;Es[45]=62,Es[95]=63}function $i(a,u,n){for(var l=[],v=u;v<n;v+=3)u=(a[v]<<16)+(a[v+1]<<8)+a[v+2],l.push(va[u>>18&63]+va[u>>12&63]+va[u>>6&63]+va[u&63]);return l.join("")}function tn(a){ng||Ki();for(var u=a.length,n=u%3,l="",v=[],d=0,x=u-n;d<x;d+=16383)v.push($i(a,d,d+16383>x?x:d+16383));return n===1?(a=a[u-1],l+=va[a>>2],l+=va[a<<4&63],l+="=="):n===2&&(a=(a[u-2]<<8)+a[u-1],l+=va[a>>10],l+=va[a>>4&63],l+=va[a<<2&63],l+="="),v.push(l),v.join("")}function Vi(a,u,n,l,v){var d=8*v-l-1,x=(1<<d)-1,y=x>>1,M=-7;v=n?v-1:0;var D=n?-1:1,U=a[u+v];for(v+=D,n=U&(1<<-M)-1,U>>=-M,M+=d;0<M;n=256*n+a[u+v],v+=D,M-=8);for(d=n&(1<<-M)-1,n>>=-M,M+=l;0<M;d=256*d+a[u+v],v+=D,M-=8);if(n===0)n=1-y;else{if(n===x)return d?NaN:Infinity*(U?-1:1);d+=Math.pow(2,l),n-=y}return(U?-1:1)*d*Math.pow(2,n-l)}function en(a,u,n,l,v,d){var x,y=8*d-v-1,M=(1<<y)-1,D=M>>1,U=v===23?Math.pow(2,-24)-Math.pow(2,-77):0;d=l?0:d-1;var C=l?1:-1,E=0>u||u===0&&0>1/u?1:0;for(u=Math.abs(u),isNaN(u)||u===Infinity?(u=isNaN(u)?1:0,l=M):(l=Math.floor(Math.log(u)/Math.LN2),1>u*(x=Math.pow(2,-l))&&(l--,x*=2),u=1<=l+D?u+U/x:u+U*Math.pow(2,1-D),2<=u*x&&(l++,x/=2),l+D>=M?(u=0,l=M):1<=l+D?(u=(u*x-1)*Math.pow(2,v),l+=D):(u=u*Math.pow(2,D-1)*Math.pow(2,v),l=0));8<=v;a[n+d]=u&255,d+=C,u/=256,v-=8);for(l=l<<v|u,y+=v;0<y;a[n+d]=l&255,d+=C,l/=256,y-=8);a[n+d-C]|=128*E}function Yi(a,u){if((xe.TYPED_ARRAY_SUPPORT?2147483647:1073741823)<u)throw new RangeError("Invalid typed array length");return xe.TYPED_ARRAY_SUPPORT?(a=new Uint8Array(u),a.__proto__=xe.prototype):(a===null&&(a=new xe(u)),a.length=u),a}function xe(a,u,n){if(!(xe.TYPED_ARRAY_SUPPORT||this instanceof xe))return new xe(a,u,n);if(typeof a=="number"){if(typeof u=="string")throw Error("If encoding is specified then the first argument must be a string");return vn(this,a)}return rn(this,a,u,n)}function rn(a,u,n,l){if(typeof u=="number")throw new TypeError('"value" argument must not be a number');if(typeof ArrayBuffer!="undefined"&&u instanceof ArrayBuffer){if(u.byteLength,0>n||u.byteLength<n)throw new RangeError("'offset' is out of bounds");if(u.byteLength<n+(l||0))throw new RangeError("'length' is out of bounds");return u=n===void 0&&l===void 0?new Uint8Array(u):l===void 0?new Uint8Array(u,n):new Uint8Array(u,n,l),xe.TYPED_ARRAY_SUPPORT?(a=u,a.__proto__=xe.prototype):a=nn(a,u),a}if(typeof u=="string"){if(l=a,a=n,(typeof a!="string"||a==="")&&(a="utf8"),!xe.isEncoding(a))throw new TypeError('"encoding" must be a valid string encoding');return n=qa(u,a)|0,l=Yi(l,n),u=l.write(u,a),u!==n&&(l=l.slice(0,u)),l}return Jn(a,u)}function cn(a){if(typeof a!="number")throw new TypeError('"size" argument must be a number');if(0>a)throw new RangeError('"size" argument must not be negative')}function vn(a,u){if(cn(u),a=Yi(a,0>u?0:io(u)|0),!xe.TYPED_ARRAY_SUPPORT)for(var n=0;n<u;++n)a[n]=0;return a}function nn(a,u){var n=0>u.length?0:io(u.length)|0;a=Yi(a,n);for(var l=0;l<n;l+=1)a[l]=u[l]&255;return a}function Jn(a,u){if(no(u)){var n=io(u.length)|0;return a=Yi(a,n),a.length===0||u.copy(a,0,0,n),a}if(u){if(typeof ArrayBuffer!="undefined"&&u.buffer instanceof ArrayBuffer||"length"in u)return(n=typeof u.length!="number")||(n=u.length,n=n!==n),n?Yi(a,0):nn(a,u);if(u.type==="Buffer"&&B1(u.data))return nn(a,u.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function io(a){if(a>=(xe.TYPED_ARRAY_SUPPORT?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(xe.TYPED_ARRAY_SUPPORT?2147483647:1073741823).toString(16)+" bytes");return a|0}function no(a){return!(a==null||!a._isBuffer)}function qa(a,u){if(no(a))return a.length;if(typeof ArrayBuffer!="undefined"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(a)||a instanceof ArrayBuffer))return a.byteLength;typeof a!="string"&&(a=""+a);var n=a.length;if(n===0)return 0;for(var l=!1;;)switch(u){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return oa(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return _u(a).length;default:if(l)return oa(a).length;u=(""+u).toLowerCase(),l=!0}}function Sa(a,u,n){var l=!1;if((u===void 0||0>u)&&(u=0),u>this.length||((n===void 0||n>this.length)&&(n=this.length),0>=n)||(n>>>=0,u>>>=0,n<=u))return"";for(a||(a="utf8");;)switch(a){case"hex":for(a=u,u=n,n=this.length,(!a||0>a)&&(a=0),(!u||0>u||u>n)&&(u=n),l="",n=a;n<u;++n)a=l,l=this[n],l=16>l?"0"+l.toString(16):l.toString(16),l=a+l;return l;case"utf8":case"utf-8":return Hs(this,u,n);case"ascii":for(a="",n=Math.min(this.length,n);u<n;++u)a+=String.fromCharCode(this[u]&127);return a;case"latin1":case"binary":for(a="",n=Math.min(this.length,n);u<n;++u)a+=String.fromCharCode(this[u]);return a;case"base64":return u=u===0&&n===this.length?tn(this):tn(this.slice(u,n)),u;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(u=this.slice(u,n),n="",a=0;a<u.length;a+=2)n+=String.fromCharCode(u[a]+256*u[a+1]);return n;default:if(l)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),l=!0}}function Ln(a,u,n){var l=a[u];a[u]=a[n],a[n]=l}function ds(a,u,n,l,v){if(a.length===0)return-1;if(typeof n=="string"?(l=n,n=0):2147483647<n?n=2147483647:-2147483648>n&&(n=-2147483648),n=+n,isNaN(n)&&(n=v?0:a.length-1),0>n&&(n=a.length+n),n>=a.length){if(v)return-1;n=a.length-1}else if(0>n)if(v)n=0;else return-1;if(typeof u=="string"&&(u=xe.from(u,l)),no(u))return u.length===0?-1:na(a,u,n,l,v);if(typeof u=="number")return u&=255,xe.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?v?Uint8Array.prototype.indexOf.call(a,u,n):Uint8Array.prototype.lastIndexOf.call(a,u,n):na(a,[u],n,l,v);throw new TypeError("val must be string, number or Buffer")}function na(a,u,n,l,v){function d(D,U){return x===1?D[U]:D.readUInt16BE(U*x)}var x=1,y=a.length,M=u.length;if(l!==void 0&&(l=String(l).toLowerCase(),l==="ucs2"||l==="ucs-2"||l==="utf16le"||l==="utf-16le")){if(2>a.length||2>u.length)return-1;x=2,y/=2,M/=2,n/=2}if(v)for(l=-1;n<y;n++)if(d(a,n)===d(u,l===-1?0:n-l)){if(l===-1&&(l=n),n-l+1===M)return l*x}else l!==-1&&(n-=n-l),l=-1;else for(n+M>y&&(n=y-M);0<=n;n--){for(y=!0,l=0;l<M;l++)if(d(a,n+l)!==d(u,l)){y=!1;break}if(y)return n}return-1}function Hs(a,u,n){n=Math.min(a.length,n);for(var l=[];u<n;){var v=a[u],d=null,x=239<v?4:223<v?3:191<v?2:1;if(u+x<=n)switch(x){case 1:128>v&&(d=v);break;case 2:var y=a[u+1];(y&192)==128&&(v=(v&31)<<6|y&63,127<v&&(d=v));break;case 3:y=a[u+1];var M=a[u+2];(y&192)==128&&(M&192)==128&&(v=(v&15)<<12|(y&63)<<6|M&63,2047<v&&(55296>v||57343<v)&&(d=v));break;case 4:y=a[u+1],M=a[u+2];var D=a[u+3];(y&192)==128&&(M&192)==128&&(D&192)==128&&(v=(v&15)<<18|(y&63)<<12|(M&63)<<6|D&63,65535<v&&1114112>v&&(d=v))}d===null?(d=65533,x=1):65535<d&&(d-=65536,l.push(d>>>10&1023|55296),d=56320|d&1023),l.push(d),u+=x}if(a=l.length,a<=cv)l=String.fromCharCode.apply(String,l);else{for(n="",u=0;u<a;)n+=String.fromCharCode.apply(String,l.slice(u,u+=cv));l=n}return l}function Zi(a,u,n){if(a%1!=0||0>a)throw new RangeError("offset is not uint");if(a+u>n)throw new RangeError("Trying to access beyond buffer length")}function qn(a,u,n,l,v,d){if(!no(a))throw new TypeError('"buffer" argument must be a Buffer instance');if(u>v||u<d)throw new RangeError('"value" argument is out of bounds');if(n+l>a.length)throw new RangeError("Index out of range")}function Ia(a,u,n,l){0>u&&(u=65535+u+1);for(var v=0,d=Math.min(a.length-n,2);v<d;++v)a[n+v]=(u&255<<8*(l?v:1-v))>>>8*(l?v:1-v)}function Ka(a,u,n,l){0>u&&(u=4294967295+u+1);for(var v=0,d=Math.min(a.length-n,4);v<d;++v)a[n+v]=u>>>8*(l?v:3-v)&255}function ul(a,u,n,l,v,d){if(n+l>a.length)throw new RangeError("Index out of range");if(0>n)throw new RangeError("Index out of range")}function Ea(a,u,n,l,v){return v||ul(a,u,n,4,34028234663852886e22,-34028234663852886e22),en(a,u,n,l,23,4),n+4}function Qa(a,u,n,l,v){return v||ul(a,u,n,8,17976931348623157e292,-17976931348623157e292),en(a,u,n,l,52,8),n+8}function oa(a,u){u=u||Infinity;for(var n,l=a.length,v=null,d=[],x=0;x<l;++x){if(n=a.charCodeAt(x),55295<n&&57344>n){if(!v){if(56319<n){-1<(u-=3)&&d.push(239,191,189);continue}else if(x+1===l){-1<(u-=3)&&d.push(239,191,189);continue}v=n;continue}if(56320>n){-1<(u-=3)&&d.push(239,191,189),v=n;continue}n=(v-55296<<10|n-56320)+65536}else v&&-1<(u-=3)&&d.push(239,191,189);if(v=null,128>n){if(0>--u)break;d.push(n)}else if(2048>n){if(0>(u-=2))break;d.push(n>>6|192,n&63|128)}else if(65536>n){if(0>(u-=3))break;d.push(n>>12|224,n>>6&63|128,n&63|128)}else if(1114112>n){if(0>(u-=4))break;d.push(n>>18|240,n>>12&63|128,n>>6&63|128,n&63|128)}else throw Error("Invalid code point")}return d}function oo(a){for(var u=[],n=0;n<a.length;++n)u.push(a.charCodeAt(n)&255);return u}function _u(a){if(a=(a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")).replace(N1,""),2>a.length)a="";else for(;a.length%4!=0;)a+="=";ng||Ki();var u=a.length;if(0<u%4)throw Error("Invalid string. Length must be a multiple of 4");var n=a[u-2]==="="?2:a[u-1]==="="?1:0,l=new hA(3*u/4-n),v=0<n?u-4:u,d=0;for(u=0;u<v;u+=4){var x=Es[a.charCodeAt(u)]<<18|Es[a.charCodeAt(u+1)]<<12|Es[a.charCodeAt(u+2)]<<6|Es[a.charCodeAt(u+3)];l[d++]=x>>16&255,l[d++]=x>>8&255,l[d++]=x&255}return n===2?(x=Es[a.charCodeAt(u)]<<2|Es[a.charCodeAt(u+1)]>>4,l[d++]=x&255):n===1&&(x=Es[a.charCodeAt(u)]<<10|Es[a.charCodeAt(u+1)]<<4|Es[a.charCodeAt(u+2)]>>2,l[d++]=x>>8&255,l[d++]=x&255),l}function ks(a,u,n,l){for(var v=0;v<l&&!(v+n>=u.length||v>=a.length);++v)u[v+n]=a[v];return v}function id(a){return!!a.constructor&&typeof a.constructor.isBuffer=="function"&&a.constructor.isBuffer(a)}function No(a,u){var n=[];return a.forEach(function(l){n.push(u?-l:l,l)}),n}function nd(a){for(var u=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,n=[],l=0;l<a-1;l++){var v=2*(l+u);n.push(v,v+1,v+2),n.push(v+2,v+1,v+3)}return n}function nh(a){return function(u,n,l){return u=n+a,n=l.length-1,l[0<n?0>u?0:u>n?n:u:u<n?n:0<u?0:u]}}function is(a){if(!a[0]||!a[0].length)return a;for(var u=a[0].length,n=[],l=0,v=0;v<a.length;v++)for(var d=0;d<u;d++)n[l++]=a[v][d];return n}function wf(){for(var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[],u=[],n=0,l=0;l<a.length;l++){var v=a[l];if(0<l){var d=a[l-1];n+=Math.sqrt(Math.pow(v[0]-d[0],2)+Math.pow(v[1]-d[1],2))}u.push(n)}return{arr:u,total:n}}function od(){var a=document.createElement("canvas");a.width=a.height=32;var u=a.getContext("2d");return{canvas:a,ctx:u}}function _f(){var a=(0<arguments.length&&arguments[0]!==void 0?arguments[0]:{}).color,u=od(),n=u.canvas;return u=u.ctx,u.save(),u.moveTo(0,0),u.lineTo(20,0),u.lineTo(32,16),u.lineTo(20,32),u.lineTo(0,32),u.lineTo(10,16),u.fillStyle=a||"#fff",u.fill(),u.restore(),n}function Gs(a,u){return di.set(a,-u[1],u[0])}function sd(a,u,n){return di.sub(a,u,n),di.normalize(a,a),a}function sa(a){var u,n;this.promise=new a(function(l,v){if(u!==void 0||n!==void 0)throw TypeError("Bad Promise constructor");u=l,n=v}),this.resolve=eu(u),this.reject=eu(n)}function ac(a,u,n){return n=Math.PI/180*(60*n+30),[a.x+u*Math.cos(n),a.y+u*Math.sin(n)]}function $a(a,u,n){for(var l={},v=[],d=a.length,x=u/2/Math.sin(Math.PI/3),y=1.5*x,M=1,D=0;D<d;++D){var U=a[D].geometry.coordinates;n&&(U=n(U));var C=+U[0],E=+U[1];if(!isNaN(C)&&!isNaN(E)){U=Math.round(E/=y);var B=Math.round(C=C/u-(U&1)/2),O=E-U;if(1<3*Math.abs(O)){var H=C-B,V=B+(C<B?-1:1)/2,G=U+(E<U?-1:1);C-=V,E-=G,H*H+O*O>C*C+E*E&&(B=V+(U&1?1:-1)/2,U=G)}O=B+"-"+U,(H=l[O])?(H.count+=a[D].count||1,M=Math.max(M,H.count)):(l[O]={center:{x:(B+(U&1)/2)*u,y:U*y},count:a[D].count||1},v.push(l[O]))}}return v.max=M,v.r=x,v}function uc(a,u,n,l){switch(l){case 5122:return new Int16Array(a,u,n);case 5123:return new Uint16Array(a,u,n);case 5124:return new Int32Array(a,u,n);case 5125:return new Uint32Array(a,u,n);case 5126:return new Float32Array(a,u,n);default:return null}}function gs(a){return uc(a.bufferView.data,a.byteOffset,a.count*Uh[a.type],a.componentType)}function ad(a){var u="",n=a.lastIndexOf("/");return n!==-1&&(u=a.substring(0,n+1)),u}function ud(a,u){var n=new XMLHttpRequest;n.overrideMimeType("application/json"),n.open("GET",a,!0),n.onreadystatechange=function(){n.readyState==4&&n.status=="200"&&u(n.responseText,this)},n.send(null)}function Mf(a,u){var n=new XMLHttpRequest;n.responseType="arraybuffer",n.open("GET",a,!0),n.onreadystatechange=function(){if(n.readyState==4&&n.status=="200"){var l=n.response;l&&u&&u(l)}},n.send(null)}function Mu(a,u,n){var l=new Image;l.crossOrigin="Anonymous",l.src=a,l.onload=function(){n(l,u)}}function ld(a){function u(oe,Be){n.uniform1i(oe,Be.index),n.activeTexture(n.TEXTURE0+Be.index),oe=nt.glTF.textures[Be.index],n.bindTexture(n.TEXTURE_2D,oe.texture),n.bindSampler(Be.index,oe.sampler?oe.sampler.sampler:x)}var n=a.gl,l=0,v=[];a=n.canvas;var d=function(oe,Be,wr){for(this.glTFScene=oe,this.glTF=Be,this.id=wr,this.rootTransform=rr.create(),this.nodeMatrix=Array(Be.nodes.length),oe=0,Be=this.nodeMatrix.length;oe<Be;oe++)this.nodeMatrix[oe]=rr.create()},x=n.createSampler();n.samplerParameteri(x,n.TEXTURE_MIN_FILTER,n.NEAREST_MIPMAP_LINEAR),n.samplerParameteri(x,n.TEXTURE_MAG_FILTER,n.LINEAR),n.samplerParameteri(x,n.TEXTURE_WRAP_S,n.REPEAT),n.samplerParameteri(x,n.TEXTURE_WRAP_T,n.REPEAT),n.bindVertexArray(null),n.bindVertexArray(null);var y={HAS_SKIN:1,SKIN_VEC8:2,HAS_BASECOLORMAP:4,HAS_NORMALMAP:8,HAS_METALROUGHNESSMAP:16,HAS_OCCLUSIONMAP:32,HAS_EMISSIVEMAP:64},M={},D=function(){this.flags=0,this.programObject=null};D.prototype.hasSkin=function(){return this.flags&y.HAS_SKIN},D.prototype.hasBaseColorMap=function(){return this.flags&y.HAS_BASECOLORMAP},D.prototype.hasNormalMap=function(){return this.flags&y.HAS_NORMALMAP},D.prototype.hasMetalRoughnessMap=function(){return this.flags&y.HAS_METALROUGHNESSMAP},D.prototype.hasOcclusionMap=function(){return this.flags&y.HAS_OCCLUSIONMAP},D.prototype.hasEmissiveMap=function(){return this.flags&y.HAS_EMISSIVEMAP},D.prototype.defineMacro=function(oe){y[oe]!==void 0&&(this.flags|=y[oe])},D.prototype.compile=function(){var oe=M[this.flags];if(oe)this.programObject=oe;else{var Be=oe="";this.flags&y.HAS_SKIN&&(oe+=`#define HAS_SKIN
`),this.flags&y.SKIN_VEC8&&(oe+=`#define SKIN_VEC8
`),this.flags&y.HAS_BASECOLORMAP&&(Be+=`#define HAS_BASECOLORMAP
`),this.flags&y.HAS_NORMALMAP&&(Be+=`#define HAS_NORMALMAP
`),this.flags&y.HAS_METALROUGHNESSMAP&&(Be+=`#define HAS_METALROUGHNESSMAP
`),this.flags&y.HAS_OCCLUSIONMAP&&(Be+=`#define HAS_OCCLUSIONMAP
`),this.flags&y.HAS_EMISSIVEMAP&&(Be+=`#define HAS_EMISSIVEMAP
`),oe=ba.createProgram(n,`#version 300 es
`+oe+`#define POSITION_LOCATION 0
#define NORMAL_LOCATION 1
#define TEXCOORD_0_LOCATION 2
#define JOINTS_0_LOCATION 3
#define JOINTS_1_LOCATION 5
#define WEIGHTS_0_LOCATION 4
#define WEIGHTS_1_LOCATION 6
#define TANGENT_LOCATION 7
precision highp float;precision highp int;uniform mat4 u_MVP;uniform mat4 u_MV;uniform mat4 u_MVNormal;
#ifdef HAS_SKIN
uniform JointMatrix{mat4 matrix[65];}u_jointMatrix;
#endif
layout(location=POSITION_LOCATION)in vec3 position;layout(location=NORMAL_LOCATION)in vec3 normal;layout(location=TEXCOORD_0_LOCATION)in vec2 uv;
#ifdef HAS_SKIN
layout(location=JOINTS_0_LOCATION)in vec4 joint0;layout(location=WEIGHTS_0_LOCATION)in vec4 weight0;
#ifdef SKIN_VEC8
layout(location=JOINTS_1_LOCATION)in vec4 joint1;layout(location=WEIGHTS_1_LOCATION)in vec4 weight1;
#endif
#endif
out vec3 v_position;out vec3 v_normal;out vec2 v_uv;void main(){
#ifdef HAS_SKIN
mat4 skinMatrix=weight0.x*u_jointMatrix.matrix[int(joint0.x)]+weight0.y*u_jointMatrix.matrix[int(joint0.y)]+weight0.z*u_jointMatrix.matrix[int(joint0.z)]+weight0.w*u_jointMatrix.matrix[int(joint0.w)];
#ifdef SKIN_VEC8
skinMatrix+=weight1.x*u_jointMatrix.matrix[int(joint1.x)]+weight1.y*u_jointMatrix.matrix[int(joint1.y)]+weight1.z*u_jointMatrix.matrix[int(joint1.z)]+weight1.w*u_jointMatrix.matrix[int(joint1.w)];
#endif
#endif
v_uv=uv;
#ifdef HAS_SKIN
v_normal=normalize((u_MVNormal*transpose(inverse(skinMatrix))*vec4(normal,0)).xyz);vec4 pos=u_MV*skinMatrix*vec4(position,1.0);gl_Position=u_MVP*skinMatrix*vec4(position,1.0);
#else
v_normal=normalize((u_MVNormal*vec4(normal,0)).xyz);vec4 pos=u_MV*vec4(position,1.0);gl_Position=u_MVP*vec4(position,1.0);
#endif
v_position=vec3(pos.xyz)/pos.w;}`,`#version 300 es
`+Be+`#define FRAG_COLOR_LOCATION 0
precision highp float;precision highp int;uniform sampler2D u_brdfLUT;uniform vec4 u_baseColorFactor;
#ifdef HAS_BASECOLORMAP
uniform sampler2D u_baseColorTexture;
#endif
#ifdef HAS_NORMALMAP
uniform sampler2D u_normalTexture;uniform float u_normalTextureScale;
#endif
#ifdef HAS_EMISSIVEMAP
uniform sampler2D u_emissiveTexture;uniform vec3 u_emissiveFactor;
#endif
#ifdef HAS_METALROUGHNESSMAP
uniform sampler2D u_metallicRoughnessTexture;
#endif
uniform float u_metallicFactor;uniform float u_roughnessFactor;
#ifdef HAS_OCCLUSIONMAP
uniform sampler2D u_occlusionTexture;uniform float u_occlusionStrength;
#endif
in vec3 v_position;in vec3 v_normal;in vec2 v_uv;layout(location=FRAG_COLOR_LOCATION)out vec4 frag_color;struct PBRInfo{float NdotL;float NdotV;float NdotH;float LdotH;float VdotH;float perceptualRoughness;float metalness;vec3 reflectance0;vec3 reflectance90;float alphaRoughness;vec3 diffuseColor;vec3 specularColor;};const float M_PI=3.141592653589793;const float c_MinRoughness=0.04;vec3 getNormal(){vec3 pos_dx=dFdx(v_position);vec3 pos_dy=dFdy(v_position);vec3 tex_dx=dFdx(vec3(v_uv,0.0));vec3 tex_dy=dFdy(vec3(v_uv,0.0));vec3 t=(tex_dy.t*pos_dx-tex_dx.t*pos_dy)/(tex_dx.s*tex_dy.t-tex_dy.s*tex_dx.t);vec3 ng=v_normal;t=normalize(t-ng*dot(ng,t));vec3 b=normalize(cross(ng,t));mat3 tbn=mat3(t,b,ng);
#ifdef HAS_NORMALMAP
vec3 n=texture(u_normalTexture,v_uv).rgb;n=normalize(tbn*((2.0*n-1.0)*vec3(u_normalTextureScale,u_normalTextureScale,1.0)));
#else
vec3 n=tbn[2].xyz;
#endif
return n;}vec3 getIBLContribution(PBRInfo pbrInputs,vec3 n,vec3 reflection){float mipCount=10.0;float lod=(pbrInputs.perceptualRoughness*mipCount);vec3 brdf=texture(u_brdfLUT,vec2(pbrInputs.NdotV,1.0-pbrInputs.perceptualRoughness)).rgb;vec3 diffuseLight=vec3(0.6,0.6,0.6);vec3 specularLight=vec3(0.6,0.6,0.6);vec3 diffuse=diffuseLight*pbrInputs.diffuseColor;vec3 specular=specularLight*(pbrInputs.specularColor*brdf.x+brdf.y);return diffuse+specular;}vec3 diffuse(PBRInfo pbrInputs){return pbrInputs.diffuseColor/M_PI;}vec3 specularReflection(PBRInfo pbrInputs){return pbrInputs.reflectance0+(pbrInputs.reflectance90-pbrInputs.reflectance0)*pow(clamp(1.0-pbrInputs.VdotH,0.0,1.0),5.0);}float geometricOcclusion(PBRInfo pbrInputs){float NdotL=pbrInputs.NdotL;float NdotV=pbrInputs.NdotV;float r=pbrInputs.alphaRoughness;float attenuationL=2.0*NdotL/(NdotL+sqrt(r*r+(1.0-r*r)*(NdotL*NdotL)));float attenuationV=2.0*NdotV/(NdotV+sqrt(r*r+(1.0-r*r)*(NdotV*NdotV)));return attenuationL*attenuationV;}float microfacetDistribution(PBRInfo pbrInputs){float roughnessSq=pbrInputs.alphaRoughness*pbrInputs.alphaRoughness;float f=(pbrInputs.NdotH*roughnessSq-pbrInputs.NdotH)*pbrInputs.NdotH+1.0;return roughnessSq/(M_PI*f*f);}void main(){float perceptualRoughness=u_roughnessFactor;float metallic=u_metallicFactor;
#ifdef HAS_METALROUGHNESSMAP
vec4 mrSample=texture(u_metallicRoughnessTexture,v_uv);perceptualRoughness=mrSample.g*perceptualRoughness;metallic=mrSample.b*metallic;
#endif
perceptualRoughness=clamp(perceptualRoughness,c_MinRoughness,1.0);metallic=clamp(metallic,0.0,1.0);float alphaRoughness=perceptualRoughness*perceptualRoughness;
#ifdef HAS_BASECOLORMAP
vec4 baseColor=texture(u_baseColorTexture,v_uv)*u_baseColorFactor;
#else
vec4 baseColor=u_baseColorFactor;
#endif
vec3 f0=vec3(0.04);vec3 diffuseColor=baseColor.rgb*(vec3(1.0)-f0);diffuseColor*=1.0-metallic;vec3 specularColor=mix(f0,baseColor.rgb,metallic);float reflectance=max(max(specularColor.r,specularColor.g),specularColor.b);float reflectance90=clamp(reflectance*25.0,0.0,1.0);vec3 specularEnvironmentR0=specularColor.rgb;vec3 specularEnvironmentR90=vec3(1.0,1.0,1.0)*reflectance90;vec3 n=getNormal();vec3 v=normalize(-v_position);vec3 l=normalize(vec3(1.0,1.0,1.0));vec3 h=normalize(l+v);vec3 reflection=-normalize(reflect(v,n));float NdotL=clamp(dot(n,l),0.001,1.0);float NdotV=abs(dot(n,v))+0.001;float NdotH=clamp(dot(n,h),0.0,1.0);float LdotH=clamp(dot(l,h),0.0,1.0);float VdotH=clamp(dot(v,h),0.0,1.0);PBRInfo pbrInputs=PBRInfo(NdotL,NdotV,NdotH,LdotH,VdotH,perceptualRoughness,metallic,specularEnvironmentR0,specularEnvironmentR90,alphaRoughness,diffuseColor,specularColor);vec3 F=specularReflection(pbrInputs);float G=geometricOcclusion(pbrInputs);float D=microfacetDistribution(pbrInputs);vec3 diffuseContrib=(1.0-F)*diffuse(pbrInputs);vec3 specContrib=max(vec3(0.0),F*G*D/(4.0*NdotL*NdotV));vec3 color=NdotL*(diffuseContrib+specContrib);color+=getIBLContribution(pbrInputs,n,reflection);
#ifdef HAS_OCCLUSIONMAP
float ao=texture(u_occlusionTexture,v_uv).r;color=mix(color,color*ao,u_occlusionStrength);
#endif
#ifdef HAS_EMISSIVEMAP
vec3 emissive=texture(u_emissiveTexture,v_uv).rgb*u_emissiveFactor;color+=emissive;
#endif
frag_color=vec4(color,baseColor.a);}`),this.programObject={program:oe,uniformLocations:{},uniformBlockIndices:{}},this.flags&y.HAS_SKIN&&(this.programObject.uniformBlockIndices.JointMatrix=n.getUniformBlockIndex(oe,"JointMatrix")),Be=this.programObject.uniformLocations,Be.MVP=n.getUniformLocation(oe,"u_MVP"),Be.MVNormal=n.getUniformLocation(oe,"u_MVNormal"),Be.MV=n.getUniformLocation(oe,"u_MV"),Be.baseColorFactor=n.getUniformLocation(oe,"u_baseColorFactor"),Be.metallicFactor=n.getUniformLocation(oe,"u_metallicFactor"),Be.roughnessFactor=n.getUniformLocation(oe,"u_roughnessFactor"),this.flags&y.HAS_BASECOLORMAP&&(Be.baseColorTexture=n.getUniformLocation(oe,"u_baseColorTexture")),this.flags&y.HAS_NORMALMAP&&(Be.normalTexture=n.getUniformLocation(oe,"u_normalTexture"),Be.normalTextureScale=n.getUniformLocation(oe,"u_normalTextureScale")),this.flags&y.HAS_METALROUGHNESSMAP&&(Be.metallicRoughnessTexture=n.getUniformLocation(oe,"u_metallicRoughnessTexture")),this.flags&y.HAS_OCCLUSIONMAP&&(Be.occlusionTexture=n.getUniformLocation(oe,"u_occlusionTexture"),Be.occlusionStrength=n.getUniformLocation(oe,"u_occlusionStrength")),this.flags&y.HAS_EMISSIVEMAP&&(Be.emissiveTexture=n.getUniformLocation(oe,"u_emissiveTexture"),Be.emissiveFactor=n.getUniformLocation(oe,"u_emissiveFactor")),n.useProgram(null),M[this.flags]=this.programObject}};var U=1,C=Dr.create(),E=rr.create();np.create();var B=[];n.enable(n.CULL_FACE),n.cullFace(n.BACK),n.frontFace(n.CCW);var O=!0;n.enable(n.DEPTH_TEST),n.depthFunc(n.LEQUAL);var H=H||{},V=null;Dr.create();var G=rr.create();rr.perspective(G,.785,a.width/a.height,.01,100),rr.create();var j=rr.create(),Y=rr.create(),$=rr.create();rr.create();var it,nt,dt=[1,1,1,1],Et=H.drawPrimitive=function(oe,Be){if(yr){Y=j=yr.matrix,rr.invert($,j),rr.transpose($,$),Be=dt;var wr=oe.shader,_r=oe.material;if(_r!==null){var ke=_r.pbrMetallicRoughness;Be=ke.baseColorFactor,oe.material.doubleSided===O&&((O=!oe.material.doubleSided)?n.enable(n.CULL_FACE):n.disable(n.CULL_FACE))}V!=oe.shader.programObject&&(V=oe.shader.programObject,n.useProgram(V.program)),_r&&(wr.hasBaseColorMap()&&u(V.uniformLocations.baseColorTexture,ke.baseColorTexture),wr.hasNormalMap()&&(u(V.uniformLocations.normalTexture,_r.normalTexture),n.uniform1f(V.uniformLocations.normalTextureScale,_r.normalTexture.scale)),wr.hasMetalRoughnessMap()&&u(V.uniformLocations.metallicRoughnessTexture,ke.metallicRoughnessTexture),n.uniform1f(V.uniformLocations.metallicFactor,ke.metallicFactor),n.uniform1f(V.uniformLocations.roughnessFactor,ke.roughnessFactor),wr.hasOcclusionMap()&&(u(V.uniformLocations.occlusionTexture,_r.occlusionTexture),n.uniform1f(V.uniformLocations.occlusionStrength,_r.occlusionTexture.strength)),wr.hasEmissiveMap()&&(u(V.uniformLocations.emissiveTexture,_r.emissiveTexture),n.uniform3fv(V.uniformLocations.emissiveFactor,_r.emissiveFactor))),wr.hasSkin()&&n.uniformBlockBinding(V.program,V.uniformBlockIndices.JointMatrix,it),n.activeTexture(n.TEXTURE0+29),n.bindTexture(n.TEXTURE_2D,null),n.uniform4fv(V.uniformLocations.baseColorFactor,Be),n.uniformMatrix4fv(V.uniformLocations.MV,!1,j),n.uniformMatrix4fv(V.uniformLocations.MVP,!1,Y),n.uniformMatrix4fv(V.uniformLocations.MVNormal,!1,$),n.bindVertexArray(oe.vertexArray),oe.indices!==null?n.drawElements(oe.mode,oe.indicesLength,oe.indicesComponentType,oe.indicesOffset):n.drawArrays(oe.mode,oe.drawArraysOffset,oe.drawArraysCount),n.bindVertexArray(null)}},St=rr.create(),Xt=rr.create(),te=H.drawNode=function(oe,Be,wr,_r){if(Be=wr[Be],_r!==void 0?rr.mul(Be,_r,oe.matrix):rr.copy(Be,oe.matrix),oe.skin!==null){var ke=oe.skin;it=ke.uniformBlockID;var Os=oe.skin.joints;for(rr.invert(Xt,Be),_r=0,_n=Os.length;_r<_n;_r++){var wn=Os[_r];rr.mul(St,wr[wn.nodeID],ke.inverseBindMatrix[_r]),rr.mul(St,Xt,St),ke.jointMatrixUnidormBufferData.set(St,16*_r)}n.bindBuffer(n.UNIFORM_BUFFER,ke.jointMatrixUniformBuffer),n.bufferSubData(n.UNIFORM_BUFFER,0,ke.jointMatrixUnidormBufferData,0,ke.jointMatrixUnidormBufferData.length)}var _n;if(oe.mesh!==null)for(ke=oe.mesh,_r=0,_n=ke.primitives.length;_r<_n;_r++)Et(ke.primitives[_r],Be);for(oe.skin!==null&&n.bindBuffer(n.UNIFORM_BUFFER,null),_r=0,_n=oe.children.length;_r<_n;_r++)te(oe.children[_r],oe.children[_r].nodeID,wr,Be)},Ie=H.drawScene=function(oe){var Be=oe.glTF;if(Be.animations){var wr=Be.animations[l],_r,ke=0;for(_r=wr.samplers.length;ke<_r;ke++)wr.samplers[ke].getValue(be);for(ke=0,_r=wr.channels.length;ke<_r;ke++){var Os=wr.channels[ke],wn=Os.sampler,_n=Be.nodes[Os.target.nodeID];switch(Os.target.path){case"rotation":sn.copy(_n.rotation,wn.curValue);break;case"translation":Dr.copy(_n.translation,wn.curValue);break;case"scale":Dr.copy(_n.scale,wn.curValue)}_n.updateMatrixFromTRS()}}for(wr=0,Be=oe.glTFScene.nodes.length;wr<Be;wr++)te(oe.glTFScene.nodes[wr],oe.glTFScene.nodes[wr].nodeID,oe.nodeMatrix,oe.rootTransform)},pe=performance.now(),be=0,yr;return{setupScene:function(oe,Be){function wr(bl,Xc){if(bl!==void 0){var pu=bl.bufferView;return pu.target===null?(n.bindBuffer(n.ARRAY_BUFFER,pu.buffer),n.bufferData(n.ARRAY_BUFFER,pu.data,n.STATIC_DRAW)):n.bindBuffer(pu.target,pu.buffer),bl.prepareVertexAttrib(Xc,n),!0}return!1}var _r;if(oe.animations){var ke=0;for(_r=oe.animations.length;ke<_r;ke++)v.add(oe.animations[ke].name||ke)}l=0,ke=oe.scenes[oe.defaultScene],Dr.fromValues(1.2*ke.boundingBox.transform[0],0,0),Dr.create(),Be?Be=B[Be.id]=new d(ke,oe,Be.id):(Be=new d(ke,oe,B.length),B.push(Be)),B.length===1&&(rr.identity(E),U=1/Math.max(ke.boundingBox.transform[0],Math.max(ke.boundingBox.transform[5],ke.boundingBox.transform[10])),rr.getTranslation(C,ke.boundingBox.transform),Dr.scale(C,C,-1),C[0]+=-.5*ke.boundingBox.transform[0],C[1]+=-.5*ke.boundingBox.transform[5],C[2]+=-.5*ke.boundingBox.transform[10],U*=.5,E[0]=U,E[5]=U,E[10]=U,rr.translate(E,E,C),Dr.set(C,0,0,-1.5),U=1);var Os;for(ke=0,_r=oe.bufferViews.length;ke<_r;ke++){var wn=oe.bufferViews[ke];wn.createBuffer(n),wn.bindData(n)}if(oe.textures)for(ke=0,_r=oe.textures.length;ke<_r;ke++){var _n=oe.textures[ke];_n.createTexture(n)}if(oe.samplers)for(ke=0,_r=oe.samplers.length;ke<_r;ke++)_n=oe.samplers[ke],_n.createSampler(n);if(oe.skins)for(ke=0,_r=oe.skins.length;ke<_r;ke++)_n=oe.skins[ke],_n.jointMatrixUniformBuffer=n.createBuffer(),n.bindBufferBase(n.UNIFORM_BUFFER,_n.uniformBlockID,_n.jointMatrixUniformBuffer),n.bindBuffer(n.UNIFORM_BUFFER,_n.jointMatrixUniformBuffer),n.bufferData(n.UNIFORM_BUFFER,_n.jointMatrixUnidormBufferData,n.DYNAMIC_DRAW),n.bufferSubData(n.UNIFORM_BUFFER,0,_n.jointMatrixUnidormBufferData),n.bindBuffer(n.UNIFORM_BUFFER,null);var jc=0;for(Os=oe.meshes.length;jc<Os;jc++)for(_n=oe.meshes[jc],ke=0,_r=_n.primitives.length;ke<_r;++ke){var Xn=_n.primitives[ke];Xn.shader=new D,Xn.vertexArray=wn=n.createVertexArray(),n.bindVertexArray(wn),wr(Xn.attributes.POSITION,0),wr(Xn.attributes.NORMAL,1),wr(Xn.attributes.TEXCOORD_0,2),wr(Xn.attributes.JOINTS_0,3)&&wr(Xn.attributes.WEIGHTS_0,4)&&Xn.shader.defineMacro("HAS_SKIN"),wr(Xn.attributes.JOINTS_1,5)&&wr(Xn.attributes.WEIGHTS_1,6)&&Xn.shader.defineMacro("SKIN_VEC8"),Xn.indices!==null&&(wn=oe.accessors[Xn.indices],wn=wn.bufferView,wn.target===null?(n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,wn.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,wn.data,n.STATIC_DRAW)):n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,wn.buffer)),n.bindVertexArray(null),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null),(wn=Xn.material)&&(wn.pbrMetallicRoughness.baseColorTexture&&Xn.shader.defineMacro("HAS_BASECOLORMAP"),wn.pbrMetallicRoughness.metallicRoughnessTexture&&Xn.shader.defineMacro("HAS_METALROUGHNESSMAP"),wn.normalTexture&&Xn.shader.defineMacro("HAS_NORMALMAP"),wn.occlusionTexture&&Xn.shader.defineMacro("HAS_OCCLUSIONMAP"),wn.emissiveTexture&&Xn.shader.defineMacro("HAS_EMISSIVEMAP")),Xn.shader.compile()}return Be},render:H.render=function(oe){yr=oe,oe=new Date().getTime();var Be,wr=0;for(Be=B.length;wr<Be;wr++)nt=B[wr],Ie(B[wr]);V=null,be=.001*(oe-pe)}}}function Sm(a,u,n,l,v,d){if(typeof u=="string"&&typeof n=="number"&&typeof l=="number")for(u=u.split(d),d=0;d<u.length;d++)a.fillText(u[d],n,l),l+=v}function Nn(a){this.options=a=a||{},a.colors=a.colors||["rgba(0,192,73,0.99609375)","rgba(242,48,48,0.99609375)","rgba(255,159,25,0.99609375)"];var u=a.colors;this.drawTogether=!0,this.parseColors(u),this.tileSize=256,this.ratio=window.devicePixelRatio,this.cache={},a.getTileUrl&&(this.getTileUrl=a.getTileUrl),this._loadCount={}}function oh(a){var u=a/2,n=a+u,l=new xo(2*n,2*n),v=l.getContext("2d");return v.shadowBlur=u,v.shadowColor="black",v.shadowOffsetX=v.shadowOffsetY=1e4,v.beginPath(),v.arc(n-1e4,n-1e4,a,0,2*Math.PI,!0),v.closePath(),v.fill(),l}var lc=window.BMapGL||window.BMap;lc&&lc.Overlay&&(ge.prototype=new lc.Overlay),ge.prototype.initialize=function(a){this._map=a;var u=this.canvas=document.createElement("canvas"),n=this.ctx=this.canvas.getContext("2d");u.style.cssText="position:absolute;left:0;top:0;z-index:"+this.zIndex+";",this.adjustSize(),this.adjustRatio(n),a.getContainer().appendChild(u);var l=this;return a.addEventListener("resize",function(){l.adjustSize(),l._draw()}),this.canvas},ge.prototype.adjustSize=function(){var a=this._map.getSize(),u=this.canvas;u.width=a.width,u.height=a.height,u.style.width=u.width+"px",u.style.height=u.height+"px"},ge.prototype.adjustRatio=function(a){var u=(window.devicePixelRatio||1)/(a.backingStorePixelRatio||a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1),n=a.canvas.width,l=a.canvas.height;a.canvas.width=n*u,a.canvas.height=l*u,a.canvas.style.width=n+"px",a.canvas.style.height=l+"px",a.scale(u,u)},ge.prototype.draw=function(){this._draw.apply(this,arguments)},ge.prototype._draw=function(){this.dispatchEvent("draw"),this.options.update&&this.options.update.apply(this,arguments)},ge.prototype.getContainer=function(){return this.canvas},ge.prototype.show=function(){this.canvas||this._map.addOverlay(this),this.canvas.style.display="block"},ge.prototype.hide=function(){this.canvas.style.display="none"},ge.prototype.setZIndex=function(a){this.canvas.style.zIndex=a},ge.prototype.getZIndex=function(){return this.zIndex};var ll=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof Dt.g!="undefined"?Dt.g:typeof self!="undefined"?self:{},hc=Rt(function(a,u){u.__esModule=!0,u.default=function(n,l){if(!(n instanceof l))throw new TypeError("Cannot call a class as a function")}}),Ye=Nt(hc),ms=function(a){if(a==null)throw TypeError("Can't call method on  "+a);return a},hd={}.hasOwnProperty,on=function(a,u){return hd.call(a,u)},cd={}.toString,vs=function(a){return cd.call(a).slice(8,-1)},Cf=Object("z").propertyIsEnumerable(0)?Object:function(a){return vs(a)=="String"?a.split(""):Object(a)},bs=function(a){return Cf(ms(a))},fd=Math.ceil,pd=Math.floor,Tf=function(a){return isNaN(a=+a)?0:(0<a?pd:fd)(a)},Kn=Math.min,ki=function(a){return 0<a?Kn(Tf(a),9007199254740991):0},wi=Math.max,co=Math.min,Qr=Rt(function(a){a=a.exports={version:"2.6.5"},typeof __e=="number"&&(__e=a)}),ei=Rt(function(a){a=a.exports=typeof window!="undefined"&&Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")(),typeof __g=="number"&&(__g=a)}),Vs=Rt(function(a){var u=ei["__core-js_shared__"]||(ei["__core-js_shared__"]={});(a.exports=function(n,l){return u[n]||(u[n]=l!==void 0?l:{})})("versions",[]).push({version:Qr.version,mode:"pure",copyright:"\xA9 2019 Denis Pushkarev (zloirock.ru)"})}),La=0,sh=Math.random(),Ws=function(a){return"Symbol(".concat(a===void 0?"":a,")_",(++La+sh).toString(36))},Ra=Vs("keys"),tu=function(a){return Ra[a]||(Ra[a]=Ws(a))},Im=function(a){return function(u,n,l){u=bs(u);var v=ki(u.length);if(l=Tf(l),l=0>l?wi(l+v,0):co(l,v),a&&n!=n){for(;v>l;)if(n=u[l++],n!=n)return!0}else for(;v>l;l++)if((a||l in u)&&u[l]===n)return a||l||0;return!a&&-1}}(!1),Yx=tu("IE_PROTO"),z0=function(a,u){a=bs(a);var n=0,l=[],v;for(v in a)v!=Yx&&on(a,v)&&l.push(v);for(;u.length>n;)on(a,v=u[n++])&&(~Im(l,v)||l.push(v));return l},cc="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),ys=Object.keys||function(a){return z0(a,cc)},eu=function(a){if(typeof a!="function")throw TypeError(a+" is not a function!");return a},Ao=function(a,u,n){if(eu(a),u===void 0)return a;switch(n){case 1:return function(l){return a.call(u,l)};case 2:return function(l,v){return a.call(u,l,v)};case 3:return function(l,v,d){return a.call(u,l,v,d)}}return function(){return a.apply(u,arguments)}},Xo=function(a){return typeof a=="object"?a!==null:typeof a=="function"},Yo=function(a){if(!Xo(a))throw TypeError(a+" is not an object!");return a},ru=function(a){try{return!!a()}catch(u){return!0}},xs=!ru(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7}),As=ei.document,hl=Xo(As)&&Xo(As.createElement),cl=!xs&&!ru(function(){return Object.defineProperty(hl?As.createElement("div"):{},"a",{get:function(){return 7}}).a!=7}),ah=function(a,u){if(!Xo(a))return a;var n,l;if(u&&typeof(n=a.toString)=="function"&&!Xo(l=n.call(a))||typeof(n=a.valueOf)=="function"&&!Xo(l=n.call(a))||!u&&typeof(n=a.toString)=="function"&&!Xo(l=n.call(a)))return l;throw TypeError("Can't convert object to primitive value")},dd=Object.defineProperty,Zo={f:xs?Object.defineProperty:function(a,u,n){if(Yo(a),u=ah(u,!0),Yo(n),cl)try{return dd(a,u,n)}catch(l){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(a[u]=n.value),a}},Pa=function(a,u){return{enumerable:!(a&1),configurable:!(a&2),writable:!(a&4),value:u}},aa=xs?function(a,u,n){return Zo.f(a,u,Pa(1,n))}:function(a,u,n){return a[u]=n,a},Io=function(a,u,n){var l=a&Io.F,v=a&Io.G,d=a&Io.S,x=a&Io.P,y=a&Io.B,M=a&Io.W,D=v?Qr:Qr[u]||(Qr[u]={}),U=D.prototype;d=v?ei:d?ei[u]:(ei[u]||{}).prototype;var C;v&&(n=u);for(C in n)if(u=!l&&d&&d[C]!==void 0,!u||!on(D,C)){var E=u?d[C]:n[C];D[C]=v&&typeof d[C]!="function"?n[C]:y&&u?Ao(E,ei):M&&d[C]==E?function(B){var O=function(H,V,G){if(this instanceof B){switch(arguments.length){case 0:return new B;case 1:return new B(H);case 2:return new B(H,V)}return new B(H,V,G)}return B.apply(this,arguments)};return O.prototype=B.prototype,O}(E):x&&typeof E=="function"?Ao(Function.call,E):E,x&&((D.virtual||(D.virtual={}))[C]=E,a&Io.R&&U&&!U[C]&&aa(U,C,E))}};Io.F=1,Io.G=2,Io.S=4,Io.P=8,Io.B=16,Io.W=32,Io.U=64,Io.R=128;var Sr=Io,yn=function(a,u){var n=(Qr.Object||{})[a]||Object[a],l={};l[a]=u(n),Sr(Sr.S+Sr.F*ru(function(){n(1)}),"Object",l)};yn("keys",function(){return function(a){return ys(Object(ms(a)))}});var js=Qr.Object.keys,zn=Rt(function(a){a.exports={default:js,__esModule:!0}}),Un=Nt(zn),Xs=Object.getOwnPropertySymbols,Cu={}.propertyIsEnumerable,fc=Object.assign,U0=!fc||ru(function(){var a={},u={},n=Symbol();return a[n]=7,"abcdefghijklmnopqrst".split("").forEach(function(l){u[l]=l}),fc({},a)[n]!=7||Object.keys(fc({},u)).join("")!="abcdefghijklmnopqrst"})?function(a,u){for(var n=Object(ms(a)),l=arguments.length,v=1,d=Xs,x=Cu;l>v;)for(var y=Cf(arguments[v++]),M=d?ys(y).concat(d(y)):ys(y),D=M.length,U=0,C;D>U;)x.call(y,C=M[U++])&&(n[C]=y[C]);return n}:fc;Sr(Sr.S+Sr.F,"Object",{assign:U0});var Sf=Qr.Object.assign,gd=Rt(function(a){a.exports={default:Sf,__esModule:!0}}),Ur=Nt(gd),If=tu("IE_PROTO"),md=Object.prototype,pc=Object.getPrototypeOf||function(a){return a=Object(ms(a)),on(a,If)?a[If]:typeof a.constructor=="function"&&a instanceof a.constructor?a.constructor.prototype:a instanceof Object?md:null};yn("getPrototypeOf",function(){return function(a){return pc(Object(ms(a)))}});var vd=Qr.Object.getPrototypeOf,zo=Rt(function(a){a.exports={default:vd,__esModule:!0}}),lr=Nt(zo);Sr(Sr.S+Sr.F*!xs,"Object",{defineProperty:Zo.f});var Ef=Qr.Object,yd=function(a,u,n){return Ef.defineProperty(a,u,n)},ws=Rt(function(a){a.exports={default:yd,__esModule:!0}}),Hn=Nt(ws),Lf=Rt(function(a,u){u.__esModule=!0;var n=ws&&ws.__esModule?ws:{default:ws};u.default=function(){function l(v,d){for(var x=0;x<d.length;x++){var y=d[x];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),(0,n.default)(v,y.key,y)}}return function(v,d,x){return d&&l(v.prototype,d),x&&l(v,x),v}}()}),qe=Nt(Lf),_s={},xd=xs?Object.defineProperties:function(a,u){Yo(a);for(var n=ys(u),l=n.length,v=0,d;l>v;)Zo.f(a,d=n[v++],u[d]);return a},uh=ei.document,dc=uh&&uh.documentElement,Rf=tu("IE_PROTO"),gc=function(){},fl=function(){var a=hl?As.createElement("iframe"):{},u=cc.length;for(a.style.display="none",dc.appendChild(a),a.src="javascript:",a=a.contentWindow.document,a.open(),a.write("<script>document.F=Object</script>"),a.close(),fl=a.F;u--;)delete fl.prototype[cc[u]];return fl()},Tu=Object.create||function(a,u){if(a!==null){gc.prototype=Yo(a);var n=new gc;gc.prototype=null,n[Rf]=a}else n=fl();return u===void 0?n:xd(n,u)},Sn=Rt(function(a){var u=Vs("wks"),n=ei.Symbol,l=typeof n=="function";(a.exports=function(v){return u[v]||(u[v]=l&&n[v]||(l?n:Ws)("Symbol."+v))}).store=u}),Pf=Zo.f,H0=Sn("toStringTag"),lh=function(a,u,n){a&&!on(a=n?a:a.prototype,H0)&&Pf(a,H0,{configurable:!0,value:u})},k0={};aa(k0,Sn("iterator"),function(){return this});var Em=function(a,u,n){a.prototype=Tu(k0,{next:Pa(1,n)}),lh(a,u+" Iterator")},Lm=Sn("iterator"),pl=!([].keys&&"next"in[].keys()),kn=function(){return this},mc=function(a,u,n,l,v,d,x){Em(n,u,l),l=function(G){return!pl&&G in U?U[G]:function(){return new n(this,G)}};var y=u+" Iterator",M=v=="values",D=!1,U=a.prototype,C=U[Lm]||U["@@iterator"]||v&&U[v],E=C||l(v),B=v?M?l("entries"):E:void 0,O=u=="Array"&&U.entries||C,H;if(O&&(a=pc(O.call(new a)),a!==Object.prototype&&a.next&&lh(a,y,!0)),M&&C&&C.name!=="values"&&(D=!0,E=function(){return C.call(this)}),x&&(pl||D||!U[Lm])&&aa(U,Lm,E),_s[u]=E,_s[y]=kn,v){var V={values:M?E:l("values"),keys:d?E:l("keys"),entries:B};if(x)for(H in V)H in U||aa(U,H,V[H]);else Sr(Sr.P+Sr.F*(pl||D),u,V)}return V},G0=function(a){return function(u,n){u=String(ms(u)),n=Tf(n);var l=u.length,v;if(0>n||n>=l)return a?"":void 0;var d=u.charCodeAt(n);return 55296>d||56319<d||n+1===l||56320>(v=u.charCodeAt(n+1))||57343<v?a?u.charAt(n):d:a?u.slice(n,n+2):(d-55296<<10)+(v-56320)+65536}}(!0);mc(String,"String",function(a){this._t=String(a),this._i=0},function(){var a=this._t,u=this._i;return u>=a.length?{value:void 0,done:!0}:(a=G0(a,u),this._i+=a.length,{value:a,done:!1})});var Da=function(a,u){return{value:u,done:!!a}};mc(Array,"Array",function(a,u){this._t=bs(a),this._i=0,this._k=u},function(){var a=this._t,u=this._k,n=this._i++;return!a||n>=a.length?(this._t=void 0,Da(1)):u=="keys"?Da(0,n):u=="values"?Da(0,a[n]):Da(0,[n,a[n]])},"values"),_s.Arguments=_s.Array;for(var Df=Sn("toStringTag"),vc="CSSRuleList CSSStyleDeclaration CSSValueList ClientRectList DOMRectList DOMStringList DOMTokenList DataTransferItemList FileList HTMLAllCollection HTMLCollection HTMLFormElement HTMLSelectElement MediaList MimeTypeArray NamedNodeMap NodeList PaintRequestList Plugin PluginArray SVGLengthList SVGNumberList SVGPathSegList SVGPointList SVGStringList SVGTransformList SourceBufferList StyleSheetList TextTrackCueList TextTrackList TouchList".split(" "),Ad=0;Ad<vc.length;Ad++){var wd=vc[Ad],yc=ei[wd],Of=yc&&yc.prototype;Of&&!Of[Df]&&aa(Of,Df,wd),_s[wd]=_s.Array}var Ff={f:Sn},b0=Ff.f("iterator"),iu=Rt(function(a){a.exports={default:b0,__esModule:!0}});Nt(iu);var ua=Rt(function(a){var u=Ws("meta"),n=Zo.f,l=0,v=Object.isExtensible||function(){return!0},d=!ru(function(){return v(Object.preventExtensions({}))}),x=function(M){n(M,u,{value:{i:"O"+ ++l,w:{}}})},y=a.exports={KEY:u,NEED:!1,fastKey:function(M,D){if(!Xo(M))return typeof M=="symbol"?M:(typeof M=="string"?"S":"P")+M;if(!on(M,u)){if(!v(M))return"F";if(!D)return"E";x(M)}return M[u].i},getWeak:function(M,D){if(!on(M,u)){if(!v(M))return!0;if(!D)return!1;x(M)}return M[u].w},onFreeze:function(M){return d&&y.NEED&&v(M)&&!on(M,u)&&x(M),M}}}),V0=Zo.f,xc=function(a){var u=Qr.Symbol||(Qr.Symbol={});a.charAt(0)=="_"||a in u||V0(u,a,{value:Ff.f(a)})},hh=Array.isArray||function(a){return vs(a)=="Array"},_d=cc.concat("length","prototype"),ch=Object.getOwnPropertyNames||function(a){return z0(a,_d)},Bf=ch,Nf={}.toString,zf=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Ac=function(a){if(zf&&Nf.call(a)=="[object Window]")try{var u=Bf(a)}catch(n){u=zf.slice()}else u=Bf(bs(a));return u},fh=Object.getOwnPropertyDescriptor,Su={f:xs?fh:function(a,u){if(a=bs(a),u=ah(u,!0),cl)try{return fh(a,u)}catch(n){}if(on(a,u))return Pa(!Cu.call(a,u),a[u])}},W0=ua.KEY,Uf=Su.f,la=Zo.f,Iu=Ac,Uo=ei.Symbol,ph=ei.JSON,dh=ph&&ph.stringify,Eo=Sn("_hidden"),gh=Sn("toPrimitive"),Hf={}.propertyIsEnumerable,Lo=Vs("symbol-registry"),ns=Vs("symbols"),Ys=Vs("op-symbols"),Jo=Object.prototype,Oa=typeof Uo=="function",dl=ei.QObject,gl=!dl||!dl.prototype||!dl.prototype.findChild,ml=xs&&ru(function(){return Tu(la({},"a",{get:function(){return la(this,"a",{value:7}).a}})).a!=7})?function(a,u,n){var l=Uf(Jo,u);l&&delete Jo[u],la(a,u,n),l&&a!==Jo&&la(Jo,u,l)}:la,os=function(a){var u=ns[a]=Tu(Uo.prototype);return u._k=a,u},kf=Oa&&typeof Uo.iterator=="symbol"?function(a){return typeof a=="symbol"}:function(a){return a instanceof Uo},mh=function(a,u,n){return a===Jo&&mh(Ys,u,n),Yo(a),u=ah(u,!0),Yo(n),on(ns,u)?(n.enumerable?(on(a,Eo)&&a[Eo][u]&&(a[Eo][u]=!1),n=Tu(n,{enumerable:Pa(0,!1)})):(on(a,Eo)||la(a,Eo,Pa(1,{})),a[Eo][u]=!0),ml(a,u,n)):la(a,u,n)},Md=function(a,u){Yo(a);var n=u=bs(u),l=ys(n),v=Xs;if(v){v=v(n);for(var d=Cu,x=0,y;v.length>x;)d.call(n,y=v[x++])&&l.push(y)}n=0,y=l.length;for(var M;y>n;)mh(a,M=l[n++],u[M]);return a},qo=function(a){var u=Hf.call(this,a=ah(a,!0));return this===Jo&&on(ns,a)&&!on(Ys,a)?!1:u||!on(this,a)||!on(ns,a)||on(this,Eo)&&this[Eo][a]?u:!0},Cd=function(a,u){if(a=bs(a),u=ah(u,!0),a!==Jo||!on(ns,u)||on(Ys,u)){var n=Uf(a,u);return!n||!on(ns,u)||on(a,Eo)&&a[Eo][u]||(n.enumerable=!0),n}},Td=function(a){a=Iu(bs(a));for(var u=[],n=0,l;a.length>n;)on(ns,l=a[n++])||l==Eo||l==W0||u.push(l);return u},vh=function(a){var u=a===Jo;a=Iu(u?Ys:bs(a));for(var n=[],l=0,v;a.length>l;)on(ns,v=a[l++])&&(u?on(Jo,v):1)&&n.push(ns[v]);return n};Oa||(Uo=function(){if(this instanceof Uo)throw TypeError("Symbol is not a constructor!");var a=Ws(0<arguments.length?arguments[0]:void 0),u=function(n){this===Jo&&u.call(Ys,n),on(this,Eo)&&on(this[Eo],a)&&(this[Eo][a]=!1),ml(this,a,Pa(1,n))};return xs&&gl&&ml(Jo,a,{configurable:!0,set:u}),os(a)},aa(Uo.prototype,"toString",function(){return this._k}),Su.f=Cd,Zo.f=mh,ch=Ac=Td,Cu=qo,Xs=vh,Ff.f=function(a){return os(Sn(a))}),Sr(Sr.G+Sr.W+Sr.F*!Oa,{Symbol:Uo});for(var Sd="hasInstance isConcatSpreadable iterator match replace search species split toPrimitive toStringTag unscopables".split(" "),wc=0;Sd.length>wc;)Sn(Sd[wc++]);for(var Id=ys(Sn.store),yh=0;Id.length>yh;)xc(Id[yh++]);Sr(Sr.S+Sr.F*!Oa,"Symbol",{for:function(a){return on(Lo,a+="")?Lo[a]:Lo[a]=Uo(a)},keyFor:function(a){if(!kf(a))throw TypeError(a+" is not a symbol!");for(var u in Lo)if(Lo[u]===a)return u},useSetter:function(){gl=!0},useSimple:function(){gl=!1}}),Sr(Sr.S+Sr.F*!Oa,"Object",{create:function(a,u){return u===void 0?Tu(a):Md(Tu(a),u)},defineProperty:mh,defineProperties:Md,getOwnPropertyDescriptor:Cd,getOwnPropertyNames:Td,getOwnPropertySymbols:vh}),ph&&Sr(Sr.S+Sr.F*(!Oa||ru(function(){var a=Uo();return dh([a])!="[null]"||dh({a})!="{}"||dh(Object(a))!="{}"})),"JSON",{stringify:function(a){for(var u=[a],n=1,l;arguments.length>n;)u.push(arguments[n++]);if(l=n=u[1],(Xo(n)||a!==void 0)&&!kf(a))return hh(n)||(n=function(v,d){if(typeof l=="function"&&(d=l.call(this,v,d)),!kf(d))return d}),u[1]=n,dh.apply(ph,u)}}),Uo.prototype[gh]||aa(Uo.prototype,gh,Uo.prototype.valueOf),lh(Uo,"Symbol"),lh(Math,"Math",!0),lh(ei.JSON,"JSON",!0),xc("asyncIterator"),xc("observable");var ha=Qr.Symbol,Gf=Rt(function(a){a.exports={default:ha,__esModule:!0}}),j0=Nt(Gf),xh=Rt(function(a,u){u.__esModule=!0,a=iu&&iu.__esModule?iu:{default:iu};var n=Gf&&Gf.__esModule?Gf:{default:Gf},l=typeof n.default=="function"&&typeof a.default=="symbol"?function(v){return typeof v}:function(v){return v&&typeof n.default=="function"&&v.constructor===n.default&&v!==n.default.prototype?"symbol":typeof v};u.default=typeof n.default=="function"&&l(a.default)==="symbol"?function(v){return typeof v=="undefined"?"undefined":l(v)}:function(v){return v&&typeof n.default=="function"&&v.constructor===n.default&&v!==n.default.prototype?"symbol":typeof v=="undefined"?"undefined":l(v)}}),si=Nt(xh),Ms=Rt(function(a,u){u.__esModule=!0;var n=xh&&xh.__esModule?xh:{default:xh};u.default=function(l,v){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!v||(typeof v=="undefined"?"undefined":(0,n.default)(v))!=="object"&&typeof v!="function"?l:v}}),Pr=Nt(Ms),X0=Object.setPrototypeOf||("__proto__"in{}?function(a,u,n){try{n=Ao(Function.call,Su.f(Object.prototype,"__proto__").set,2),n(a,[]),u=!(a instanceof Array)}catch(l){u=!0}return function(l,v){if(Yo(l),!Xo(v)&&v!==null)throw TypeError(v+": can't set as prototype!");return u?l.__proto__=v:n(l,v),l}}({},!1):void 0);Sr(Sr.S,"Object",{setPrototypeOf:X0});var Y0=Qr.Object.setPrototypeOf,_c=Rt(function(a){a.exports={default:Y0,__esModule:!0}});Nt(_c),Sr(Sr.S,"Object",{create:Tu});var Rm=Qr.Object,bf=function(a,u){return Rm.create(a,u)},Vr=Rt(function(a){a.exports={default:bf,__esModule:!0}}),ca=Nt(Vr),Vf=Rt(function(a,u){function n(x){return x&&x.__esModule?x:{default:x}}u.__esModule=!0;var l=n(_c),v=n(Vr),d=n(xh);u.default=function(x,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+(typeof y=="undefined"?"undefined":(0,d.default)(y)));x.prototype=(0,v.default)(y&&y.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),y&&(l.default?(0,l.default)(x,y):x.__proto__=y)}}),Rr=Nt(Vf),ss=Sn("toStringTag"),Z0=vs(function(){return arguments}())=="Arguments",vl=function(a){var u;if(a===void 0)var n="Undefined";else{if(a===null)var l="Null";else{t:{var v=a=Object(a);try{l=v[ss];break t}catch(d){}l=void 0}l=typeof(n=l)=="string"?n:Z0?vs(a):(u=vs(a))=="Object"&&typeof a.callee=="function"?"Arguments":u}n=l}return n},Wf=Sn("iterator"),nu=Qr.isIterable=function(a){return a=Object(a),a[Wf]!==void 0||"@@iterator"in a||_s.hasOwnProperty(vl(a))},Zs=Rt(function(a){a.exports={default:nu,__esModule:!0}});Nt(Zs);var Js=Sn("iterator"),fa=Qr.getIteratorMethod=function(a){if(a!=null)return a[Js]||a["@@iterator"]||_s[vl(a)]},ou=Qr.getIterator=function(a){var u=fa(a);if(typeof u!="function")throw TypeError(a+" is not iterable!");return Yo(u.call(a))},qs=Rt(function(a){a.exports={default:ou,__esModule:!0}}),as=Nt(qs),yl=Rt(function(a,u){u.__esModule=!0;var n=Zs&&Zs.__esModule?Zs:{default:Zs},l=qs&&qs.__esModule?qs:{default:qs};u.default=function(){return function(v,d){if(Array.isArray(v))return v;if((0,n.default)(Object(v))){var x=[],y=!0,M=!1,D=void 0;try{for(var U=(0,l.default)(v),C;!(y=(C=U.next()).done)&&(x.push(C.value),!d||x.length!==d);y=!0);}catch(E){M=!0,D=E}finally{try{!y&&U.return&&U.return()}finally{if(M)throw D}}return x}throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()}),Pi=Nt(yl),xl=function(a,u,n,l){try{return l?u(Yo(n)[0],n[1]):u(n)}catch(v){throw u=a.return,u!==void 0&&Yo(u.call(a)),v}},In=Sn("iterator"),Ed=Array.prototype,Fa=Sn("iterator"),Ld=!1;try{[7][Fa]().return=function(){Ld=!0}}catch(a){}var jf=function(a,u){if(!u&&!Ld)return!1;var n=!1;try{u=[7];var l=u[Fa]();l.next=function(){return{done:n=!0}},u[Fa]=function(){return l},a(u)}catch(v){}return n};Sr(Sr.S+Sr.F*!jf(function(a){}),"Array",{from:function(a){var u=Object(ms(a)),n=typeof this=="function"?this:Array,l=arguments.length,v=1<l?arguments[1]:void 0,d=v!==void 0,x=0,y=fa(u),M;if(d&&(v=Ao(v,2<l?arguments[2]:void 0,2)),y!=null&&(n!=Array||y===void 0||_s.Array!==y&&Ed[In]!==y))for(u=y.call(u),n=new n;!(M=u.next()).done;x++)l=n,y=x,M=d?xl(u,v,[M.value,x],!0):M.value,y in l?Zo.f(l,y,Pa(0,M)):l[y]=M;else for(l=ki(u.length),n=new n(l);l>x;x++){y=n,M=x;var D=d?v(u[x],x):u[x];M in y?Zo.f(y,M,Pa(0,D)):y[M]=D}return n.length=x,n}});var Pm=Qr.Array.from,Al=Rt(function(a){a.exports={default:Pm,__esModule:!0}}),Ba=Nt(Al),Dm=Rt(function(a,u){u.__esModule=!0;var n=Al&&Al.__esModule?Al:{default:Al};u.default=function(l){if(Array.isArray(l)){for(var v=0,d=Array(l.length);v<l.length;v++)d[v]=l[v];return d}return(0,n.default)(l)}}),ri=Nt(Dm),Om=ua.onFreeze;yn("freeze",function(a){return function(u){return a&&Xo(u)?a(Om(u)):u}});var Fm=Qr.Object.freeze,Bm=Rt(function(a){a.exports={default:Fm,__esModule:!0}}),pa=Nt(Bm),Rd=Qr.JSON||(Qr.JSON={stringify:JSON.stringify}),Pd=function(a){return Rd.stringify.apply(Rd,arguments)},Nm=Rt(function(a){a.exports={default:Pd,__esModule:!0}}),Ah=Nt(Nm),Ks={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},J0=Su.f;yn("getOwnPropertyDescriptor",function(){return function(a,u){return J0(bs(a),u)}});var q0=Qr.Object,K0=function(a,u){return q0.getOwnPropertyDescriptor(a,u)},Mc=Rt(function(a){a.exports={default:K0,__esModule:!0}}),Gn=Nt(Mc),Cc=Rt(function(a){var u=Array.prototype.concat,n=Array.prototype.slice,l=a.exports=function(v){for(var d=[],x=0,y=v.length;x<y;x++){var M=v[x],D=(D=M)&&typeof D!="string"?D instanceof Array||Array.isArray(D)||0<=D.length&&(D.splice instanceof Function||Gn(D,D.length-1)&&D.constructor.name!=="String"):!1;D?d=u.call(d,n.call(M)):d.push(M)}return d};l.wrap=function(v){return function(){return v(l(arguments))}}}),Tc=Rt(function(a){function u(x,y,M){return Math.min(Math.max(y,x),M)}function n(x){return x=x.toString(16).toUpperCase(),2>x.length?"0"+x:x}var l={},v;for(v in Ks)Ks.hasOwnProperty(v)&&(l[Ks[v]]=v);var d=a.exports={to:{},get:{}};d.get=function(x){switch(x.substring(0,3).toLowerCase()){case"hsl":x=d.get.hsl(x);var y="hsl";break;case"hwb":x=d.get.hwb(x),y="hwb";break;default:x=d.get.rgb(x),y="rgb"}return x?{model:y,value:x}:null},d.get.rgb=function(x){if(!x)return null;var y=/^#([a-f0-9]{3,4})$/i,M=/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,D=/^rgba?\(\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,U=/(\D+)/,C=[0,0,0,1],E;if(E=x.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(y=E[2],E=E[1],x=0;3>x;x++)M=2*x,C[x]=parseInt(E.slice(M,M+2),16);y&&(C[3]=Math.round(parseInt(y,16)/255*100)/100)}else if(E=x.match(y)){for(E=E[1],y=E[3],x=0;3>x;x++)C[x]=parseInt(E[x]+E[x],16);y&&(C[3]=Math.round(parseInt(y+y,16)/255*100)/100)}else if(E=x.match(M)){for(x=0;3>x;x++)C[x]=parseInt(E[x+1],0);E[4]&&(C[3]=parseFloat(E[4]))}else if(E=x.match(D)){for(x=0;3>x;x++)C[x]=Math.round(2.55*parseFloat(E[x+1]));E[4]&&(C[3]=parseFloat(E[4]))}else return(E=x.match(U))?E[1]==="transparent"?[0,0,0,0]:(C=Ks[E[1]],C?(C[3]=1,C):null):null;for(x=0;3>x;x++)C[x]=u(C[x],0,255);return C[3]=u(C[3],0,1),C},d.get.hsl=function(x){if(!x)return null;var y=x.match(/^hsla?\(\s*([+-]?(?:\d*\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(y){var M=parseFloat(y[4]);x=(parseFloat(y[1])+360)%360;var D=u(parseFloat(y[2]),0,100);return y=u(parseFloat(y[3]),0,100),M=u(isNaN(M)?1:M,0,1),[x,D,y,M]}return null},d.get.hwb=function(x){if(!x)return null;var y=x.match(/^hwb\(\s*([+-]?\d*[\.]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(y){var M=parseFloat(y[4]);x=(parseFloat(y[1])%360+360)%360;var D=u(parseFloat(y[2]),0,100);return y=u(parseFloat(y[3]),0,100),M=u(isNaN(M)?1:M,0,1),[x,D,y,M]}return null},d.to.hex=function(){var x=Cc(arguments);return"#"+n(x[0])+n(x[1])+n(x[2])+(1>x[3]?n(Math.round(255*x[3])):"")},d.to.rgb=function(){var x=Cc(arguments);return 4>x.length||x[3]===1?"rgb("+Math.round(x[0])+", "+Math.round(x[1])+", "+Math.round(x[2])+")":"rgba("+Math.round(x[0])+", "+Math.round(x[1])+", "+Math.round(x[2])+", "+x[3]+")"},d.to.rgb.percent=function(){var x=Cc(arguments),y=Math.round(x[0]/255*100),M=Math.round(x[1]/255*100),D=Math.round(x[2]/255*100);return 4>x.length||x[3]===1?"rgb("+y+"%, "+M+"%, "+D+"%)":"rgba("+y+"%, "+M+"%, "+D+"%, "+x[3]+")"},d.to.hsl=function(){var x=Cc(arguments);return 4>x.length||x[3]===1?"hsl("+x[0]+", "+x[1]+"%, "+x[2]+"%)":"hsla("+x[0]+", "+x[1]+"%, "+x[2]+"%, "+x[3]+")"},d.to.hwb=function(){var x=Cc(arguments),y="";return 4<=x.length&&x[3]!==1&&(y=", "+x[3]),"hwb("+x[0]+", "+x[1]+"%, "+x[2]+"%"+y+")"},d.to.keyword=function(x){return l[x.slice(0,3)]}}),Eu=Rt(function(a){var u={};for(v in Ks)Ks.hasOwnProperty(v)&&(u[Ks[v]]=v);var n=a.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}},l;for(l in n)if(n.hasOwnProperty(l)){if(!("channels"in n[l]))throw Error("missing channels property: "+l);if(!("labels"in n[l]))throw Error("missing channel labels property: "+l);if(n[l].labels.length!==n[l].channels)throw Error("channel and label counts mismatch: "+l);a=n[l].channels;var v=n[l].labels;delete n[l].channels,delete n[l].labels,Object.defineProperty(n[l],"channels",{value:a}),Object.defineProperty(n[l],"labels",{value:v})}n.rgb.hsl=function(d){var x=d[0]/255,y=d[1]/255,M=d[2]/255;d=Math.min(x,y,M);var D=Math.max(x,y,M),U=D-d,C;return D===d?C=0:x===D?C=(y-M)/U:y===D?C=2+(M-x)/U:M===D&&(C=4+(x-y)/U),C=Math.min(60*C,360),0>C&&(C+=360),x=(d+D)/2,[C,100*(D===d?0:.5>=x?U/(D+d):U/(2-D-d)),100*x]},n.rgb.hsv=function(d){var x,y=d[0]/255,M=d[1]/255,D=d[2]/255,U=Math.max(y,M,D),C=U-Math.min(y,M,D);if(C===0)var E=x=0;else{x=C/U,d=(U-y)/6/C+.5;var B=(U-M)/6/C+.5;C=(U-D)/6/C+.5,y===U?E=C-B:M===U?E=1/3+d-C:D===U&&(E=2/3+B-d),0>E?E+=1:1<E&&--E}return[360*E,100*x,100*U]},n.rgb.hwb=function(d){var x=d[0],y=d[1],M=d[2];d=n.rgb.hsl(d)[0];var D=1/255*Math.min(x,Math.min(y,M));return M=1-1/255*Math.max(x,Math.max(y,M)),[d,100*D,100*M]},n.rgb.cmyk=function(d){var x=d[0]/255,y=d[1]/255;d=d[2]/255;var M=Math.min(1-x,1-y,1-d);return[100*((1-x-M)/(1-M)||0),100*((1-y-M)/(1-M)||0),100*((1-d-M)/(1-M)||0),100*M]},n.rgb.keyword=function(d){var x=u[d];if(x)return x;x=Infinity;var y;for(y in Ks)if(Ks.hasOwnProperty(y)){var M=Ks[y];if(M=Math.pow(d[0]-M[0],2)+Math.pow(d[1]-M[1],2)+Math.pow(d[2]-M[2],2),M<x){x=M;var D=y}}return D},n.keyword.rgb=function(d){return Ks[d]},n.rgb.xyz=function(d){var x=d[0]/255,y=d[1]/255;return d=d[2]/255,x=.04045<x?Math.pow((x+.055)/1.055,2.4):x/12.92,y=.04045<y?Math.pow((y+.055)/1.055,2.4):y/12.92,d=.04045<d?Math.pow((d+.055)/1.055,2.4):d/12.92,[100*(.4124*x+.3576*y+.1805*d),100*(.2126*x+.7152*y+.0722*d),100*(.0193*x+.1192*y+.9505*d)]},n.rgb.lab=function(d){var x=n.rgb.xyz(d);d=x[0];var y=x[1];return x=x[2],d/=95.047,y/=100,x/=108.883,d=.008856<d?Math.pow(d,1/3):7.787*d+16/116,y=.008856<y?Math.pow(y,1/3):7.787*y+16/116,x=.008856<x?Math.pow(x,1/3):7.787*x+16/116,[116*y-16,500*(d-y),200*(y-x)]},n.hsl.rgb=function(d){var x=d[0]/360,y=d[1]/100;if(d=d[2]/100,y===0){var M=255*d;return[M,M,M]}y=.5>d?d*(1+y):d+y-d*y,d=2*d-y;for(var D=[0,0,0],U=0;3>U;U++)M=x+1/3*-(U-1),0>M&&M++,1<M&&M--,M=1>6*M?d+6*(y-d)*M:1>2*M?y:2>3*M?d+(y-d)*(2/3-M)*6:d,D[U]=255*M;return D},n.hsl.hsv=function(d){var x=d[0],y=d[1]/100;d=d[2]/100;var M=y,D=Math.max(d,.01);return d*=2,y*=1>=d?d:2-d,M*=1>=D?D:2-D,[x,100*(d===0?2*M/(D+M):2*y/(d+y)),(d+y)/2*100]},n.hsv.rgb=function(d){var x=d[0]/60,y=d[1]/100;d=d[2]/100;var M=Math.floor(x)%6,D=x-Math.floor(x);x=255*d*(1-y);var U=255*d*(1-y*D);switch(y=255*d*(1-y*(1-D)),d*=255,M){case 0:return[d,y,x];case 1:return[U,d,x];case 2:return[x,d,y];case 3:return[x,U,d];case 4:return[y,x,d];case 5:return[d,x,U]}},n.hsv.hsl=function(d){var x=d[0],y=d[1]/100;d=d[2]/100;var M=Math.max(d,.01),D=(2-y)*M;return M=y*M/(1>=D?D:2-D)||0,[x,100*M,(2-y)*d/2*100]},n.hwb.rgb=function(d){var x=d[0]/360,y=d[1]/100;d=d[2]/100;var M=y+d;switch(1<M&&(y/=M,d/=M),M=Math.floor(6*x),d=1-d,x=6*x-M,(M&1)!=0&&(x=1-x),x=y+x*(d-y),M){default:case 6:case 0:M=d;var D=x;break;case 1:M=x,D=d;break;case 2:M=y,D=d,y=x;break;case 3:M=y,D=x,y=d;break;case 4:M=x,D=y,y=d;break;case 5:M=d,D=y,y=x}return[255*M,255*D,255*y]},n.cmyk.rgb=function(d){var x=d[3]/100;return[255*(1-Math.min(1,d[0]/100*(1-x)+x)),255*(1-Math.min(1,d[1]/100*(1-x)+x)),255*(1-Math.min(1,d[2]/100*(1-x)+x))]},n.xyz.rgb=function(d){var x=d[0]/100,y=d[1]/100,M=d[2]/100;d=3.2406*x+-1.5372*y+-.4986*M;var D=-.9689*x+1.8758*y+.0415*M;return x=.0557*x+-.204*y+1.057*M,d=.0031308<d?1.055*Math.pow(d,1/2.4)-.055:12.92*d,D=.0031308<D?1.055*Math.pow(D,1/2.4)-.055:12.92*D,x=.0031308<x?1.055*Math.pow(x,1/2.4)-.055:12.92*x,d=Math.min(Math.max(0,d),1),D=Math.min(Math.max(0,D),1),x=Math.min(Math.max(0,x),1),[255*d,255*D,255*x]},n.xyz.lab=function(d){var x=d[0],y=d[1];return d=d[2],x/=95.047,y/=100,d/=108.883,x=.008856<x?Math.pow(x,1/3):7.787*x+16/116,y=.008856<y?Math.pow(y,1/3):7.787*y+16/116,d=.008856<d?Math.pow(d,1/3):7.787*d+16/116,[116*y-16,500*(x-y),200*(y-d)]},n.lab.xyz=function(d){var x=d[1],y=d[2];d=(d[0]+16)/116,x=x/500+d,y=d-y/200;var M=Math.pow(d,3),D=Math.pow(x,3),U=Math.pow(y,3);return[95.047*(.008856<D?D:(x-16/116)/7.787),100*(.008856<M?M:(d-16/116)/7.787),108.883*(.008856<U?U:(y-16/116)/7.787)]},n.lab.lch=function(d){var x=d[0],y=d[1];d=d[2];var M=360*Math.atan2(d,y)/2/Math.PI;return 0>M&&(M+=360),[x,Math.sqrt(y*y+d*d),M]},n.lch.lab=function(d){var x=d[0],y=d[1];return d=d[2]/360*2*Math.PI,[x,y*Math.cos(d),y*Math.sin(d)]},n.rgb.ansi16=function(d){var x=d[0],y=d[1],M=d[2],D=1 in arguments?arguments[1]:n.rgb.hsv(d)[2];return D=Math.round(D/50),D===0?30:(x=30+(Math.round(M/255)<<2|Math.round(y/255)<<1|Math.round(x/255)),D===2&&(x+=60),x)},n.hsv.ansi16=function(d){return n.rgb.ansi16(n.hsv.rgb(d),d[2])},n.rgb.ansi256=function(d){var x=d[0],y=d[1];return d=d[2],x===y&&y===d?8>x?16:248<x?231:Math.round((x-8)/247*24)+232:16+36*Math.round(x/255*5)+6*Math.round(y/255*5)+Math.round(d/255*5)},n.ansi16.rgb=function(d){var x=d%10;return x===0||x===7?(50<d&&(x+=3.5),x=x/10.5*255,[x,x,x]):(d=.5*(~~(50<d)+1),[(x&1)*d*255,(x>>1&1)*d*255,(x>>2&1)*d*255])},n.ansi256.rgb=function(d){if(232<=d){var x=10*(d-232)+8;return[x,x,x]}d-=16,x=Math.floor(d/36)/5*255;var y=Math.floor((d%=36)/6)/5*255;return[x,y,d%6/5*255]},n.rgb.hex=function(d){return d=(((Math.round(d[0])&255)<<16)+((Math.round(d[1])&255)<<8)+(Math.round(d[2])&255)).toString(16).toUpperCase(),"000000".substring(d.length)+d},n.hex.rgb=function(d){if(d=d.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i),!d)return[0,0,0];var x=d[0];return d[0].length===3&&(x=x.split("").map(function(y){return y+y}).join("")),d=parseInt(x,16),[d>>16&255,d>>8&255,d&255]},n.rgb.hcg=function(d){var x=d[0]/255,y=d[1]/255;d=d[2]/255;var M=Math.max(Math.max(x,y),d),D=Math.min(Math.min(x,y),d),U=M-D;return[(0>=U?0:M===x?(y-d)/U%6:M===y?2+(d-x)/U:(x-y)/U+8)/6%1*360,100*U,100*(1>U?D/(1-U):0)]},n.hsl.hcg=function(d){var x=d[1]/100,y=d[2]/100,M=0;return x=.5>y?2*x*y:2*x*(1-y),1>x&&(M=(y-.5*x)/(1-x)),[d[0],100*x,100*M]},n.hsv.hcg=function(d){var x=d[2]/100,y=d[1]/100*x,M=0;return 1>y&&(M=(x-y)/(1-y)),[d[0],100*y,100*M]},n.hcg.rgb=function(d){var x=d[1]/100,y=d[2]/100;if(x===0)return[255*y,255*y,255*y];var M=[0,0,0];d=d[0]/360%1*6;var D=d%1,U=1-D;switch(Math.floor(d)){case 0:M[0]=1,M[1]=D,M[2]=0;break;case 1:M[0]=U,M[1]=1,M[2]=0;break;case 2:M[0]=0,M[1]=1,M[2]=D;break;case 3:M[0]=0,M[1]=U,M[2]=1;break;case 4:M[0]=D,M[1]=0,M[2]=1;break;default:M[0]=1,M[1]=0,M[2]=U}return y*=1-x,[255*(x*M[0]+y),255*(x*M[1]+y),255*(x*M[2]+y)]},n.hcg.hsv=function(d){var x=d[1]/100,y=x+d[2]/100*(1-x),M=0;return 0<y&&(M=x/y),[d[0],100*M,100*y]},n.hcg.hsl=function(d){var x=d[1]/100,y=d[2]/100*(1-x)+.5*x,M=0;return 0<y&&.5>y?M=x/(2*y):.5<=y&&1>y&&(M=x/(2*(1-y))),[d[0],100*M,100*y]},n.hcg.hwb=function(d){var x=d[1]/100,y=x+d[2]/100*(1-x);return[d[0],100*(y-x),100*(1-y)]},n.hwb.hcg=function(d){var x=1-d[2]/100,y=x-d[1]/100,M=0;return 1>y&&(M=(x-y)/(1-y)),[d[0],100*y,100*M]},n.apple.rgb=function(d){return[d[0]/65535*255,d[1]/65535*255,d[2]/65535*255]},n.rgb.apple=function(d){return[d[0]/255*65535,d[1]/255*65535,d[2]/255*65535]},n.gray.rgb=function(d){return[d[0]/100*255,d[0]/100*255,d[0]/100*255]},n.gray.hsl=n.gray.hsv=function(d){return[0,0,d[0]]},n.gray.hwb=function(d){return[0,100,d[0]]},n.gray.cmyk=function(d){return[0,0,0,d[0]]},n.gray.lab=function(d){return[d[0],0,0]},n.gray.hex=function(d){return d=Math.round(d[0]/100*255)&255,d=((d<<16)+(d<<8)+d).toString(16).toUpperCase(),"000000".substring(d.length)+d},n.rgb.gray=function(d){return[(d[0]+d[1]+d[2])/3/255*100]}}),Q0=function(a){for(var u={},n=Un(Eu),l=n.length,v=0;v<l;v++)u[n[v]]={distance:-1,parent:null};for(n=[a],u[a].distance=0;n.length;){a=n.pop(),l=Un(Eu[a]),v=l.length;for(var d=0;d<v;d++){var x=l[d],y=u[x];y.distance===-1&&(y.distance=u[a].distance+1,y.parent=a,n.unshift(x))}}for(n={},a=Un(u),l=a.length,v=0;v<l;v++){var M=a[v];if(u[M].parent!==null){d=M,x=u,y=[x[M].parent,M];var D=Eu[x[M].parent][M];for(M=x[M].parent;x[M].parent;)y.unshift(x[M].parent),D=ue(Eu[x[M].parent][M],D),M=x[M].parent;D.conversion=y,n[d]=D}}return n},su={};Un(Eu).forEach(function(a){su[a]={},Object.defineProperty(su[a],"channels",{value:Eu[a].channels}),Object.defineProperty(su[a],"labels",{value:Eu[a].labels});var u=Q0(a);Un(u).forEach(function(n){var l=u[n];su[a][n]=st(l),su[a][n].raw=se(l)})});var Cs=su,Dd=[].slice,zm=["keyword","gray","hex"],Od={};Un(Cs).forEach(function(a){Od[Dd.call(Cs[a].labels).sort().join("")]=a});var wo={};Ft.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(a){var u=this.model in Tc.to?this:this.rgb();return u=u.round(typeof a=="number"?a:1),a=u.valpha===1?u.color:u.color.concat(this.valpha),Tc.to[u.model](a)},percentString:function(a){return a=this.rgb().round(typeof a=="number"?a:1),a=a.valpha===1?a.color:a.color.concat(this.valpha),Tc.to.rgb.percent(a)},array:function(){return this.valpha===1?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var a={},u=Cs[this.model].channels,n=Cs[this.model].labels,l=0;l<u;l++)a[n[l]]=this.color[l];return this.valpha!==1&&(a.alpha=this.valpha),a},unitArray:function(){var a=this.rgb().color;return a[0]/=255,a[1]/=255,a[2]/=255,this.valpha!==1&&a.push(this.valpha),a},unitObject:function(){var a=this.rgb().object();return a.r/=255,a.g/=255,a.b/=255,this.valpha!==1&&(a.alpha=this.valpha),a},round:function(a){return a=Math.max(a||0,0),new Ft(this.color.map(Pt(a)).concat(this.valpha),this.model)},alpha:function(a){return arguments.length?new Ft(this.color.concat(Math.max(0,Math.min(1,a))),this.model):this.valpha},red:It("rgb",0,bt(255)),green:It("rgb",1,bt(255)),blue:It("rgb",2,bt(255)),hue:It(["hsl","hsv","hsl","hwb","hcg"],0,function(a){return(a%360+360)%360}),saturationl:It("hsl",1,bt(100)),lightness:It("hsl",2,bt(100)),saturationv:It("hsv",1,bt(100)),value:It("hsv",2,bt(100)),chroma:It("hcg",1,bt(100)),gray:It("hcg",2,bt(100)),white:It("hwb",1,bt(100)),wblack:It("hwb",2,bt(100)),cyan:It("cmyk",0,bt(100)),magenta:It("cmyk",1,bt(100)),yellow:It("cmyk",2,bt(100)),black:It("cmyk",3,bt(100)),x:It("xyz",0,bt(100)),y:It("xyz",1,bt(100)),z:It("xyz",2,bt(100)),l:It("lab",0,bt(100)),a:It("lab",1),b:It("lab",2),keyword:function(a){return arguments.length?new Ft(a):Cs[this.model].keyword(this.color)},hex:function(a){return arguments.length?new Ft(a):Tc.to.hex(this.rgb().round().color)},rgbNumber:function(){var a=this.rgb().color;return(a[0]&255)<<16|(a[1]&255)<<8|a[2]&255},luminosity:function(){for(var a=this.rgb().color,u=[],n=0;n<a.length;n++){var l=a[n]/255;u[n]=.03928>=l?l/12.92:Math.pow((l+.055)/1.055,2.4)}return .2126*u[0]+.7152*u[1]+.0722*u[2]},contrast:function(a){var u=this.luminosity();return a=a.luminosity(),u>a?(u+.05)/(a+.05):(a+.05)/(u+.05)},level:function(a){return a=this.contrast(a),7.1<=a?"AAA":4.5<=a?"AA":""},isDark:function(){var a=this.rgb().color;return 128>(299*a[0]+587*a[1]+114*a[2])/1e3},isLight:function(){return!this.isDark()},negate:function(){for(var a=this.rgb(),u=0;3>u;u++)a.color[u]=255-a.color[u];return a},lighten:function(a){var u=this.hsl();return u.color[2]+=u.color[2]*a,u},darken:function(a){var u=this.hsl();return u.color[2]-=u.color[2]*a,u},saturate:function(a){var u=this.hsl();return u.color[1]+=u.color[1]*a,u},desaturate:function(a){var u=this.hsl();return u.color[1]-=u.color[1]*a,u},whiten:function(a){var u=this.hwb();return u.color[1]+=u.color[1]*a,u},blacken:function(a){var u=this.hwb();return u.color[2]+=u.color[2]*a,u},grayscale:function(){var a=this.rgb().color;return a=.3*a[0]+.59*a[1]+.11*a[2],Ft.rgb(a,a,a)},fade:function(a){return this.alpha(this.valpha-this.valpha*a)},opaquer:function(a){return this.alpha(this.valpha+this.valpha*a)},rotate:function(a){var u=this.hsl(),n=u.color[0];return n=(n+a)%360,u.color[0]=0>n?360+n:n,u},mix:function(a,u){if(!a||!a.rgb)throw Error('Argument to "mix" was not a Color instance, but rather an instance of '+(typeof a=="undefined"?"undefined":si(a)));a=a.rgb();var n=this.rgb();u=u===void 0?.5:u;var l=2*u-1,v=a.alpha()-n.alpha();return l=((l*v==-1?l:(l+v)/(1+l*v))+1)/2,v=1-l,Ft.rgb(l*a.red()+v*n.red(),l*a.green()+v*n.green(),l*a.blue()+v*n.blue(),a.alpha()*u+n.alpha()*(1-u))}},Un(Cs).forEach(function(a){if(zm.indexOf(a)===-1){var u=Cs[a].channels;Ft.prototype[a]=function(){if(this.model===a)return new Ft(this);if(arguments.length)return new Ft(arguments,a);var n=typeof arguments[u]=="number"?u:this.valpha,l=Cs[this.model][a].raw(this.color);return l=Array.isArray(l)?l:[l],new Ft(l.concat(n),a)},Ft[a]=function(n){return typeof n=="number"&&(n=re(Dd.call(arguments),u)),new Ft(n,a)}}}),Ai(Ti.prototype,{equals:function(a){return this.lat===a.lat&&this.lng===a.lng},clone:function(){return new Ti(this.lat,this.lng)},getLngSpan:function(a){return a=Math.abs(a-this.lng),180<a&&(a=360-a),a},sub:function(a){return new Ti(this.lat-a.lat,this.lng-a.lng)},toString:function(){return"Point"}}),Ai(ti,{EARTHRADIUS:637099681e-2,MCBAND:[1289059486e-2,836237787e-2,5591021,348198983e-2,167804312e-2,0],LLBAND:[75,60,45,30,15,0],MC2LL:[[1410526172116255e-23,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,173379812e-1],[-7435856389565537e-24,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,1026014486e-2],[-3030883460898826e-23,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,685681737e-2],[-1981981304930552e-23,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,448277706e-2],[309191371068437e-23,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,25551644e-1],[2890871144776878e-24,8983055095805407e-21,-3068298e-14,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],LL2MC:[[-.0015702102444,111320.7020616939,1704480524535203,-10338987376042340,26112667856603880,-35149669176653700,26595700718403920,-10725012454188240,1800819912950474,82.5],[.0008277824516172526,111320.7020463578,6477955746671607e-7,-4082003173641316e-6,1077490566351142e-5,-1517187553151559e-5,1205306533862167e-5,-5124939663577472e-6,9133119359512032e-7,67.5],[.00337398766765,111320.7020202162,4481351045890365e-9,-2339375119931662e-8,7968221547186455e-8,-1159649932797253e-7,9723671115602145e-8,-4366194633752821e-8,8477230501135234e-9,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837749470245e-9,992013.7397791013,-122195221711287e-8,1340652697009075e-9,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758690035394e-9,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]],getDistanceByMC:function(a,u){if(!a||!u||(a=this.convertMC2LL(a),!a))return 0;var n=this.toRadians(a.lng);if(a=this.toRadians(a.lat),u=this.convertMC2LL(u),!u)return 0;var l=this.toRadians(u.lng);return u=this.toRadians(u.lat),this.getDistance(n,l,a,u)},getDistanceByLL:function(a,u){if(!a||!u)return 0;a.lng=this.getLoop(a.lng,-180,180),a.lat=this.getRange(a.lat,-74,74),u.lng=this.getLoop(u.lng,-180,180),u.lat=this.getRange(u.lat,-74,74);var n=this.toRadians(a.lng),l=this.toRadians(a.lat);return a=this.toRadians(u.lng),u=this.toRadians(u.lat),this.getDistance(n,a,l,u)},convertMC2LL:function(a){if(a==null)return new Ti(0,0);if(180>a.lng&&-180<a.lng&&90>a.lat&&-90<a.lat)return a;if(window.BMAPGL_84)return new Ti(180/Math.PI*(2*Math.atan(Math.exp(a.lat/2003750834e-2*180*Math.PI/180))-Math.PI/2),a.lng/2003750834e-2*180);for(var u=new Ti(Math.abs(a.lng),Math.abs(a.lat)),n=0;n<this.MCBAND.length;n++)if(u.lat>=this.MCBAND[n]){var l=this.MC2LL[n];break}return a=this.convertor(a,l),a=new Ti(a.lng.toFixed(6),a.lat.toFixed(6))},convertLL2MC:function(a){if(a==null)return new Ti(0,0);if(180<a.lng||-180>a.lng||90<a.lat||-90>a.lat)return a;if(window.BMAPGL_84){var u=a.lat*Math.PI/180;return new Ti(a.lng*Math.PI/180*6378137,31890685e-1*Math.log((1+Math.sin(u))/(1-Math.sin(u))))}a.lng=this.getLoop(a.lng,-180,180),a.lat=this.getRange(a.lat,-74,74),u=new Ti(a.lng,a.lat);for(var n=0;n<this.LLBAND.length;n++)if(u.lat>=this.LLBAND[n]){var l=this.LL2MC[n];break}if(!l){for(n=0;n<this.LLBAND.length;n++)if(u.lat<=-this.LLBAND[n]){l=this.LL2MC[n];break}}return a=this.convertor(a,l),a=new Ti(Number(a.lng.toFixed(2)),Number(a.lat.toFixed(2)))},convertor:function(a,u){if(a&&u){var n=u[0]+u[1]*Math.abs(a.lng),l=Math.abs(a.lat)/u[9];return u=u[2]+u[3]*l+u[4]*l*l+u[5]*l*l*l+u[6]*l*l*l*l+u[7]*l*l*l*l*l+u[8]*l*l*l*l*l*l,n*=0>a.lng?-1:1,u*=0>a.lat?-1:1,new Ti(n,u)}},getDistance:function(a,u,n,l){return this.EARTHRADIUS*Math.acos(Math.sin(n)*Math.sin(l)+Math.cos(n)*Math.cos(l)*Math.cos(u-a))},toRadians:function(a){return Math.PI*a/180},toDegrees:function(a){return 180*a/Math.PI},getRange:function(a,u,n){return u!=null&&(a=Math.max(a,u)),n!=null&&(a=Math.min(a,n)),a},getLoop:function(a,u,n){for(;a>n;)a-=n-u;for(;a<u;)a+=n-u;return a}}),Ai(ti.prototype,{lngLatToMercator:function(a){return ti.convertLL2MC(a)},lngLatToPoint:function(a){return a=ti.convertLL2MC(a),new Fn(a.lng,a.lat)},mercatorToLngLat:function(a){return ti.convertMC2LL(a)},pointToLngLat:function(a){return a=new Ti(a.x,a.y),ti.convertMC2LL(a)},pointToPixel:function(a,u,n,l,v){if(a)return a=this.lngLatToMercator(a,v),u=this.getZoomUnits(u),new Fn(Math.round((a.lng-n.lng)/u+l.width/2),Math.round((n.lat-a.lat)/u+l.height/2))},pixelToPoint:function(a,u,n,l,v){if(a)return u=this.getZoomUnits(u),a=new Ti(n.lng+u*(a.x-l.width/2),n.lat-u*(a.y-l.height/2)),this.mercatorToLngLat(a,v)},getZoomUnits:function(a){return Math.pow(2,18-a)}}),Wi.prototype.setMax=function(a){this.max=a||100},Wi.prototype.setMin=function(a){this.min=a||0},Wi.prototype.setMaxSize=function(a){this.maxSize=a||35},Wi.prototype.setMinSize=function(a){this.minSize=a||0},Wi.prototype.initPalette=function(){var a=this.gradient,u=this.paletteCtx=new xo(256,1).getContext("2d"),n=u.createLinearGradient(0,0,256,1);Un(a).forEach(function(l){n.addColorStop(parseFloat(l),a[l])}),u.fillStyle=n,u.fillRect(0,0,256,1),u.imageData=u.getImageData(0,0,256,1).data},Wi.prototype.getColor=function(a){return a=this.getImageData(a),"rgba("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]/256+")"},Wi.prototype.getImageData=function(a){var u=this.paletteCtx.imageData;if(a===void 0)return u;var n=this.max,l=this.min;return a>n&&(a=n),a<l&&(a=l),a=4*Math.floor((a-l)/(n-l)*255),[u[a],u[a+1],u[a+2],u[a+3]]},Wi.prototype.getSize=function(a){var u=this.max,n=this.min,l=this.maxSize,v=this.minSize;return a>u&&(a=u),a<n&&(a=n),v+(a-n)/(u-n)*(l-v)},Xi.prototype._initialize=function(){this.v0=this._normalizaCoord(this.options.start),this.v3=this._normalizaCoord(this.options.end),this.v1=this._getControlPoint(this.v0,this.v3,4),this.v2=this._getControlPoint(this.v3,this.v0,5),this.v0[2]||(this.v0[2]=0),this.v3[2]||(this.v3[2]=0)},Xi.prototype.setOptions=function(a){this.options=a||{},this._initialize()},Xi.prototype.getPoints=function(a){a===void 0&&(a=20);for(var u=[],n=0;n<=a;n++)u.push(this._getPoint(n/a));return u},Xi.prototype._normalizaCoord=function(a){return a?(a=ti.convertLL2MC({lng:Number(a[0]),lat:Number(a[1])}),[a.lng,a.lat]):[]},Xi.prototype._getControlPoint=function(a,u){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1;return[].concat(ri(this._getQuarter(a,u)),[this._getDistance(a,u)/n])},Xi.prototype._getQuarter=function(a,u){return[(3*a[0]+u[0])/4,(3*a[1]+u[1])/4]},Xi.prototype._getDistance=function(a,u){return Math.sqrt(Math.pow(a[0]-u[0],2)+Math.pow(a[1]-u[1],2))},Xi.prototype._getPoint=function(a){var u=[],n=this.v0,l=this.v1,v=this.v2,d=this.v3;return u.push(Ue(a,n[0],l[0],v[0],d[0]),Ue(a,n[1],l[1],v[1],d[1]),Ue(a,n[2],l[2],v[2],d[2])),u},jo.prototype._initialize=function(){this.points=this.options.points||this.options.point||[],this.greatCirclePoints=[];for(var a=[],u=0;u<this.points.length;u++){var n=this._normalizaCoord(this.points[u]);n&&a.push(n)}this.points=a},jo.prototype.setOptions=function(a){this.options=a||{},this._initialize()},jo.prototype.getPoints=function(){if(this.greatCirclePoints.length===0)for(var a=0;a<this.points.length-1;a++)this._calcGreatCirclePoints(this.points[a],this.points[a+1]);return this.greatCirclePoints},jo.prototype._normalizaCoord=function(a){if(!a)return null;a instanceof Array&&(a={lng:Number(a[0]),lat:Number(a[1])});var u=ti.convertLL2MC(a);return a=ti.convertMC2LL(a),u.latLng=a,u},jo.prototype._calcGreatCirclePoints=function(a,u){var n=a.latLng,l=u.latLng;if(!Or(n.lng,l.lng)||!Or(n.lat,l.lat)){var v=ti.getDistance(he(n.lng),he(n.lat),he(l.lng),he(l.lat));if(!(25e4>v)){v=Math.round(v/15e4);var d=this._calcAngularDistance(n,l);this.greatCirclePoints.push([a.lng,a.lat]);for(var x=0;x<v;x++){var y=this._calcMiddlePoint(n,l,x/v,d);y=ti.convertLL2MC(y);var M=Ma(y,a);30037726<M&&(y.lng=y.lng<a.lng?y.lng+this.WORLD_SIZE_MC:y.lng-this.WORLD_SIZE_MC),this.greatCirclePoints.push([y.lng,y.lat]),a=y}M=Ma(u,a),30037726<M&&(u.lng=u.lng<a.lng?u.lng+this.WORLD_SIZE_MC:u.lng-this.WORLD_SIZE_MC),this.greatCirclePoints.push([u.lng,u.lat])}}},jo.prototype._calcAngularDistance=function(a,u){var n=he(a.lat),l=he(u.lat);return a=he(a.lng),u=he(u.lng),Math.acos(Math.sin(n)*Math.sin(l)+Math.cos(n)*Math.cos(l)*Math.cos(Math.abs(u-a)))},jo.prototype._calcMiddlePoint=function(a,u,n,l){var v=u.lat,d=a.lng;u=u.lng,a=he(a.lat),v=he(v),d=he(d);var x=he(u);return u=Math.sin((1-n)*l)/Math.sin(l),l=Math.sin(n*l)/Math.sin(l),n=u*Math.cos(a)*Math.cos(d)+l*Math.cos(v)*Math.cos(x),d=u*Math.cos(a)*Math.sin(d)+l*Math.cos(v)*Math.sin(x),a=Math.atan2(u*Math.sin(a)+l*Math.sin(v),Math.sqrt(Math.pow(n,2)+Math.pow(d,2))),new Ti(lt(Math.atan2(d,n)),lt(a))};var $0=function(){function a(){var u=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};Ye(this,a),this.options=u,this._initialize()}return qe(a,[{key:"_initialize",value:function(){this.points=this.options.points}},{key:"_normalizaCoord",value:function(u){return u?(u instanceof Array&&(u={lng:Number(u[0]),lat:Number(u[1])}),ti.convertLL2MC(u)):null}},{key:"setOptions",value:function(){this.options=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},this._initialize()}},{key:"getPoints",value:function(u){for(var n=[],l=this.points,v=0;v<l.length-1;v++){var d=this.getCurveByTwoPoints(this._normalizaCoord(l[v]),this._normalizaCoord(l[v+1]),u);d&&0<d.length&&(n=n.concat(d))}return n}},{key:"getCurveByTwoPoints",value:function(u,n){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:20;if(!u||!n)return null;var v=[],d=0;if((typeof n=="undefined"?"undefined":si(n))===void 0)typeof v=="undefined"||si(v);else{var x=parseFloat(u.lat),y=parseFloat(n.lat),M=parseFloat(u.lng),D=parseFloat(n.lng);D>M&&180<parseFloat(D-M)&&0>M&&(M=parseFloat(360+M),D=parseFloat(360+D));var U=0;if(y===x)var C=0,E=M-D;else D===M?(C=Math.PI/2,E=x-y):(C=Math.atan((y-x)/(D-M)),E=(y-x)/Math.sin(C));for(U===0&&(U=C+Math.PI/5),E/=2,C=E*Math.cos(U)+M,U=E*Math.sin(U)+x,E=0;E<l+1;E++){var B=M*(1-2*d+d*d)+C*(2*d-2*d*d)+D*d*d,O=n.lng;v.push([0>u.lng&&0<O?B-360:B,x*(1-2*d+d*d)+U*(2*d-2*d*d)+y*d*d]),d+=1/l}return v}}}]),a}(),Fd=[{n:"\u5317\u4EAC",g:"116.395645,39.929986|12"},{n:"\u4E0A\u6D77",g:"121.487899,31.249162|12"},{n:"\u5929\u6D25",g:"117.210813,39.14393|12"},{n:"\u91CD\u5E86",g:"106.530635,29.544606|12"}],Lu=[{n:"\u5B89\u5FBD",g:"117.216005,31.859252|8",cities:[{n:"\u5408\u80A5",g:"117.282699,31.866942|12"},{n:"\u5B89\u5E86",g:"117.058739,30.537898|13"},{n:"\u868C\u57E0",g:"117.35708,32.929499|13"},{n:"\u4EB3\u5DDE",g:"115.787928,33.871211|13"},{n:"\u5DE2\u6E56",g:"117.88049,31.608733|13"},{n:"\u6C60\u5DDE",g:"117.494477,30.660019|14"},{n:"\u6EC1\u5DDE",g:"118.32457,32.317351|13"},{n:"\u961C\u9633",g:"115.820932,32.901211|13"},{n:"\u6DEE\u5317",g:"116.791447,33.960023|13"},{n:"\u6DEE\u5357",g:"117.018639,32.642812|13"},{n:"\u9EC4\u5C71",g:"118.29357,29.734435|13"},{n:"\u516D\u5B89",g:"116.505253,31.755558|13"},{n:"\u9A6C\u978D\u5C71",g:"118.515882,31.688528|13"},{n:"\u5BBF\u5DDE",g:"116.988692,33.636772|13"},{n:"\u94DC\u9675",g:"117.819429,30.94093|14"},{n:"\u829C\u6E56",g:"118.384108,31.36602|12"},{n:"\u5BA3\u57CE",g:"118.752096,30.951642|13"}]},{n:"\u798F\u5EFA",g:"117.984943,26.050118|8",cities:[{n:"\u798F\u5DDE",g:"119.330221,26.047125|12"},{n:"\u9F99\u5CA9",g:"117.017997,25.078685|13"},{n:"\u5357\u5E73",g:"118.181883,26.643626|13"},{n:"\u5B81\u5FB7",g:"119.542082,26.656527|14"},{n:"\u8386\u7530",g:"119.077731,25.44845|13"},{n:"\u6CC9\u5DDE",g:"118.600362,24.901652|12"},{n:"\u4E09\u660E",g:"117.642194,26.270835|14"},{n:"\u53A6\u95E8",g:"118.103886,24.489231|12"},{n:"\u6F33\u5DDE",g:"117.676205,24.517065|12"}]},{n:"\u7518\u8083",g:"102.457625,38.103267|6",cities:[{n:"\u5170\u5DDE",g:"103.823305,36.064226|12"},{n:"\u767D\u94F6",g:"104.171241,36.546682|13"},{n:"\u5B9A\u897F",g:"104.626638,35.586056|13"},{n:"\u7518\u5357\u5DDE",g:"102.917442,34.992211|14"},{n:"\u5609\u5CEA\u5173",g:"98.281635,39.802397|13"},{n:"\u91D1\u660C",g:"102.208126,38.516072|13"},{n:"\u9152\u6CC9",g:"98.508415,39.741474|13"},{n:"\u4E34\u590F\u5DDE",g:"103.215249,35.598514|13"},{n:"\u9647\u5357",g:"104.934573,33.39448|14"},{n:"\u5E73\u51C9",g:"106.688911,35.55011|13"},{n:"\u5E86\u9633",g:"107.644227,35.726801|13"},{n:"\u5929\u6C34",g:"105.736932,34.584319|13"},{n:"\u6B66\u5A01",g:"102.640147,37.933172|13"},{n:"\u5F20\u6396",g:"100.459892,38.93932|13"}]},{n:"\u5E7F\u4E1C",g:"113.394818,23.408004|8",cities:[{n:"\u5E7F\u5DDE",g:"113.30765,23.120049|12"},{n:"\u6F6E\u5DDE",g:"116.630076,23.661812|13"},{n:"\u4E1C\u839E",g:"113.763434,23.043024|12"},{n:"\u4F5B\u5C71",g:"113.134026,23.035095|13"},{n:"\u6CB3\u6E90",g:"114.713721,23.757251|12"},{n:"\u60E0\u5DDE",g:"114.410658,23.11354|12"},{n:"\u6C5F\u95E8",g:"113.078125,22.575117|13"},{n:"\u63ED\u9633",g:"116.379501,23.547999|13"},{n:"\u8302\u540D",g:"110.931245,21.668226|13"},{n:"\u6885\u5DDE",g:"116.126403,24.304571|13"},{n:"\u6E05\u8FDC",g:"113.040773,23.698469|13"},{n:"\u6C55\u5934",g:"116.72865,23.383908|13"},{n:"\u6C55\u5C3E",g:"115.372924,22.778731|14"},{n:"\u97F6\u5173",g:"113.594461,24.80296|13"},{n:"\u6DF1\u5733",g:"114.025974,22.546054|12"},{n:"\u9633\u6C5F",g:"111.97701,21.871517|14"},{n:"\u4E91\u6D6E",g:"112.050946,22.937976|13"},{n:"\u6E5B\u6C5F",g:"110.365067,21.257463|13"},{n:"\u8087\u5E86",g:"112.479653,23.078663|13"},{n:"\u4E2D\u5C71",g:"113.42206,22.545178|12"},{n:"\u73E0\u6D77",g:"113.562447,22.256915|13"}]},{n:"\u5E7F\u897F",g:"108.924274,23.552255|7",cities:[{n:"\u5357\u5B81",g:"108.297234,22.806493|12"},{n:"\u767E\u8272",g:"106.631821,23.901512|13"},{n:"\u5317\u6D77",g:"109.122628,21.472718|13"},{n:"\u5D07\u5DE6",g:"107.357322,22.415455|14"},{n:"\u9632\u57CE\u6E2F",g:"108.351791,21.617398|15"},{n:"\u6842\u6797",g:"110.26092,25.262901|12"},{n:"\u8D35\u6E2F",g:"109.613708,23.103373|13"},{n:"\u6CB3\u6C60",g:"108.069948,24.699521|14"},{n:"\u8D3A\u5DDE",g:"111.552594,24.411054|14"},{n:"\u6765\u5BBE",g:"109.231817,23.741166|14"},{n:"\u67F3\u5DDE",g:"109.422402,24.329053|12"},{n:"\u94A6\u5DDE",g:"108.638798,21.97335|13"},{n:"\u68A7\u5DDE",g:"111.305472,23.485395|13"},{n:"\u7389\u6797",g:"110.151676,22.643974|14"}]},{n:"\u8D35\u5DDE",g:"106.734996,26.902826|8",cities:[{n:"\u8D35\u9633",g:"106.709177,26.629907|12"},{n:"\u5B89\u987A",g:"105.92827,26.228595|13"},{n:"\u6BD5\u8282\u5730\u533A",g:"105.300492,27.302612|14"},{n:"\u516D\u76D8\u6C34",g:"104.852087,26.591866|13"},{n:"\u94DC\u4EC1\u5730\u533A",g:"109.196161,27.726271|14"},{n:"\u9075\u4E49",g:"106.93126,27.699961|13"},{n:"\u9ED4\u897F\u5357\u5DDE",g:"104.900558,25.095148|11"},{n:"\u9ED4\u4E1C\u5357\u5DDE",g:"107.985353,26.583992|11"},{n:"\u9ED4\u5357\u5DDE",g:"107.523205,26.264536|11"}]},{n:"\u6D77\u5357",g:"109.733755,19.180501|9",cities:[{n:"\u6D77\u53E3",g:"110.330802,20.022071|13"},{n:"\u767D\u6C99",g:"109.358586,19.216056|12"},{n:"\u4FDD\u4EAD",g:"109.656113,18.597592|12"},{n:"\u660C\u6C5F",g:"109.0113,19.222483|12"},{n:"\u510B\u5DDE",g:"109.413973,19.571153|13"},{n:"\u6F84\u8FC8",g:"109.996736,19.693135|13"},{n:"\u4E1C\u65B9",g:"108.85101,18.998161|13"},{n:"\u5B9A\u5B89",g:"110.32009,19.490991|13"},{n:"\u743C\u6D77",g:"110.414359,19.21483|13"},{n:"\u743C\u4E2D",g:"109.861849,19.039771|12"},{n:"\u4E50\u4E1C",g:"109.062698,18.658614|12"},{n:"\u4E34\u9AD8",g:"109.724101,19.805922|13"},{n:"\u9675\u6C34",g:"109.948661,18.575985|12"},{n:"\u4E09\u4E9A",g:"109.522771,18.257776|12"},{n:"\u5C6F\u660C",g:"110.063364,19.347749|13"},{n:"\u4E07\u5B81",g:"110.292505,18.839886|13"},{n:"\u6587\u660C",g:"110.780909,19.750947|13"},{n:"\u4E94\u6307\u5C71",g:"109.51775,18.831306|13"}]},{n:"\u6CB3\u5317",g:"115.661434,38.61384|7",cities:[{n:"\u77F3\u5BB6\u5E84",g:"114.522082,38.048958|12"},{n:"\u4FDD\u5B9A",g:"115.49481,38.886565|13"},{n:"\u6CA7\u5DDE",g:"116.863806,38.297615|13"},{n:"\u627F\u5FB7",g:"117.933822,40.992521|14"},{n:"\u90AF\u90F8",g:"114.482694,36.609308|13"},{n:"\u8861\u6C34",g:"115.686229,37.746929|13"},{n:"\u5ECA\u574A",g:"116.703602,39.518611|13"},{n:"\u79E6\u7687\u5C9B",g:"119.604368,39.945462|12"},{n:"\u5510\u5C71",g:"118.183451,39.650531|13"},{n:"\u90A2\u53F0",g:"114.520487,37.069531|13"},{n:"\u5F20\u5BB6\u53E3",g:"114.893782,40.811188|13"}]},{n:"\u6CB3\u5357",g:"113.486804,34.157184|7",cities:[{n:"\u90D1\u5DDE",g:"113.649644,34.75661|12"},{n:"\u5B89\u9633",g:"114.351807,36.110267|12"},{n:"\u9E64\u58C1",g:"114.29777,35.755426|13"},{n:"\u7126\u4F5C",g:"113.211836,35.234608|13"},{n:"\u5F00\u5C01",g:"114.351642,34.801854|13"},{n:"\u6D1B\u9633",g:"112.447525,34.657368|12"},{n:"\u6F2F\u6CB3",g:"114.046061,33.576279|13"},{n:"\u5357\u9633",g:"112.542842,33.01142|13"},{n:"\u5E73\u9876\u5C71",g:"113.300849,33.745301|13"},{n:"\u6FEE\u9633",g:"115.026627,35.753298|12"},{n:"\u4E09\u95E8\u5CE1",g:"111.181262,34.78332|13"},{n:"\u5546\u4E18",g:"115.641886,34.438589|13"},{n:"\u65B0\u4E61",g:"113.91269,35.307258|13"},{n:"\u4FE1\u9633",g:"114.085491,32.128582|13"},{n:"\u8BB8\u660C",g:"113.835312,34.02674|13"},{n:"\u5468\u53E3",g:"114.654102,33.623741|13"},{n:"\u9A7B\u9A6C\u5E97",g:"114.049154,32.983158|13"}]},{n:"\u9ED1\u9F99\u6C5F",g:"128.047414,47.356592|6",cities:[{n:"\u54C8\u5C14\u6EE8",g:"126.657717,45.773225|12"},{n:"\u5927\u5E86",g:"125.02184,46.596709|12"},{n:"\u5927\u5174\u5B89\u5CAD\u5730\u533A",g:"124.196104,51.991789|10"},{n:"\u9E64\u5C97",g:"130.292472,47.338666|13"},{n:"\u9ED1\u6CB3",g:"127.50083,50.25069|14"},{n:"\u9E21\u897F",g:"130.941767,45.32154|13"},{n:"\u4F73\u6728\u65AF",g:"130.284735,46.81378|12"},{n:"\u7261\u4E39\u6C5F",g:"129.608035,44.588521|13"},{n:"\u4E03\u53F0\u6CB3",g:"131.019048,45.775005|14"},{n:"\u9F50\u9F50\u54C8\u5C14",g:"123.987289,47.3477|13"},{n:"\u53CC\u9E2D\u5C71",g:"131.171402,46.655102|13"},{n:"\u7EE5\u5316",g:"126.989095,46.646064|13"},{n:"\u4F0A\u6625",g:"128.910766,47.734685|14"}]},{n:"\u6E56\u5317",g:"112.410562,31.209316|8",cities:[{n:"\u6B66\u6C49",g:"114.3162,30.581084|12"},{n:"\u9102\u5DDE",g:"114.895594,30.384439|14"},{n:"\u6069\u65BD",g:"109.517433,30.308978|14"},{n:"\u9EC4\u5188",g:"114.906618,30.446109|14"},{n:"\u9EC4\u77F3",g:"115.050683,30.216127|13"},{n:"\u8346\u95E8",g:"112.21733,31.042611|13"},{n:"\u8346\u5DDE",g:"112.241866,30.332591|12"},{n:"\u6F5C\u6C5F",g:"112.768768,30.343116|13"},{n:"\u795E\u519C\u67B6\u6797\u533A",g:"110.487231,31.595768|13"},{n:"\u5341\u5830",g:"110.801229,32.636994|13"},{n:"\u968F\u5DDE",g:"113.379358,31.717858|13"},{n:"\u5929\u95E8",g:"113.12623,30.649047|13"},{n:"\u4ED9\u6843",g:"113.387448,30.293966|13"},{n:"\u54B8\u5B81",g:"114.300061,29.880657|13"},{n:"\u8944\u9633",g:"112.176326,32.094934|12"},{n:"\u5B5D\u611F",g:"113.935734,30.927955|13"},{n:"\u5B9C\u660C",g:"111.310981,30.732758|13"}]},{n:"\u6E56\u5357",g:"111.720664,27.695864|7",cities:[{n:"\u957F\u6C99",g:"112.979353,28.213478|12"},{n:"\u5E38\u5FB7",g:"111.653718,29.012149|12"},{n:"\u90F4\u5DDE",g:"113.037704,25.782264|13"},{n:"\u8861\u9633",g:"112.583819,26.898164|13"},{n:"\u6000\u5316",g:"109.986959,27.557483|13"},{n:"\u5A04\u5E95",g:"111.996396,27.741073|13"},{n:"\u90B5\u9633",g:"111.461525,27.236811|13"},{n:"\u6E58\u6F6D",g:"112.935556,27.835095|13"},{n:"\u6E58\u897F\u5DDE",g:"109.745746,28.317951|14"},{n:"\u76CA\u9633",g:"112.366547,28.588088|13"},{n:"\u6C38\u5DDE",g:"111.614648,26.435972|13"},{n:"\u5CB3\u9633",g:"113.146196,29.378007|13"},{n:"\u5F20\u5BB6\u754C",g:"110.48162,29.124889|13"},{n:"\u682A\u6D32",g:"113.131695,27.827433|13"}]},{n:"\u6C5F\u82CF",g:"119.368489,33.013797|8",cities:[{n:"\u5357\u4EAC",g:"118.778074,32.057236|12"},{n:"\u5E38\u5DDE",g:"119.981861,31.771397|12"},{n:"\u6DEE\u5B89",g:"119.030186,33.606513|12"},{n:"\u8FDE\u4E91\u6E2F",g:"119.173872,34.601549|12"},{n:"\u5357\u901A",g:"120.873801,32.014665|12"},{n:"\u82CF\u5DDE",g:"120.619907,31.317987|12"},{n:"\u5BBF\u8FC1",g:"118.296893,33.95205|13"},{n:"\u6CF0\u5DDE",g:"119.919606,32.476053|13"},{n:"\u65E0\u9521",g:"120.305456,31.570037|12"},{n:"\u5F90\u5DDE",g:"117.188107,34.271553|12"},{n:"\u76D0\u57CE",g:"120.148872,33.379862|12"},{n:"\u626C\u5DDE",g:"119.427778,32.408505|13"},{n:"\u9547\u6C5F",g:"119.455835,32.204409|13"}]},{n:"\u6C5F\u897F",g:"115.676082,27.757258|7",cities:[{n:"\u5357\u660C",g:"115.893528,28.689578|12"},{n:"\u629A\u5DDE",g:"116.360919,27.954545|13"},{n:"\u8D63\u5DDE",g:"114.935909,25.845296|13"},{n:"\u5409\u5B89",g:"114.992039,27.113848|13"},{n:"\u666F\u5FB7\u9547",g:"117.186523,29.303563|12"},{n:"\u4E5D\u6C5F",g:"115.999848,29.71964|13"},{n:"\u840D\u4E61",g:"113.859917,27.639544|13"},{n:"\u4E0A\u9976",g:"117.955464,28.457623|13"},{n:"\u65B0\u4F59",g:"114.947117,27.822322|13"},{n:"\u5B9C\u6625",g:"114.400039,27.81113|13"},{n:"\u9E70\u6F6D",g:"117.03545,28.24131|13"}]},{n:"\u5409\u6797",g:"126.262876,43.678846|7",cities:[{n:"\u957F\u6625",g:"125.313642,43.898338|12"},{n:"\u767D\u57CE",g:"122.840777,45.621086|13"},{n:"\u767D\u5C71",g:"126.435798,41.945859|13"},{n:"\u5409\u6797",g:"126.564544,43.871988|12"},{n:"\u8FBD\u6E90",g:"125.133686,42.923303|13"},{n:"\u56DB\u5E73",g:"124.391382,43.175525|12"},{n:"\u677E\u539F",g:"124.832995,45.136049|13"},{n:"\u901A\u5316",g:"125.94265,41.736397|13"},{n:"\u5EF6\u8FB9",g:"129.485902,42.896414|13"}]},{n:"\u8FBD\u5B81",g:"122.753592,41.6216|8",cities:[{n:"\u6C88\u9633",g:"123.432791,41.808645|12"},{n:"\u978D\u5C71",g:"123.007763,41.118744|13"},{n:"\u672C\u6EAA",g:"123.778062,41.325838|12"},{n:"\u671D\u9633",g:"120.446163,41.571828|13"},{n:"\u5927\u8FDE",g:"121.593478,38.94871|12"},{n:"\u4E39\u4E1C",g:"124.338543,40.129023|12"},{n:"\u629A\u987A",g:"123.92982,41.877304|12"},{n:"\u961C\u65B0",g:"121.660822,42.01925|14"},{n:"\u846B\u82A6\u5C9B",g:"120.860758,40.74303|13"},{n:"\u9526\u5DDE",g:"121.147749,41.130879|13"},{n:"\u8FBD\u9633",g:"123.172451,41.273339|14"},{n:"\u76D8\u9526",g:"122.073228,41.141248|13"},{n:"\u94C1\u5CAD",g:"123.85485,42.299757|13"},{n:"\u8425\u53E3",g:"122.233391,40.668651|13"}]},{n:"\u5185\u8499\u53E4",g:"114.415868,43.468238|5",cities:[{n:"\u547C\u548C\u6D69\u7279",g:"111.660351,40.828319|12"},{n:"\u963F\u62C9\u5584\u76DF",g:"105.695683,38.843075|14"},{n:"\u5305\u5934",g:"109.846239,40.647119|12"},{n:"\u5DF4\u5F66\u6DD6\u5C14",g:"107.423807,40.76918|12"},{n:"\u8D64\u5CF0",g:"118.930761,42.297112|12"},{n:"\u9102\u5C14\u591A\u65AF",g:"109.993706,39.81649|12"},{n:"\u547C\u4F26\u8D1D\u5C14",g:"119.760822,49.201636|12"},{n:"\u901A\u8FBD",g:"122.260363,43.633756|12"},{n:"\u4E4C\u6D77",g:"106.831999,39.683177|13"},{n:"\u4E4C\u5170\u5BDF\u5E03",g:"113.112846,41.022363|12"},{n:"\u9521\u6797\u90ED\u52D2\u76DF",g:"116.02734,43.939705|11"},{n:"\u5174\u5B89\u76DF",g:"122.048167,46.083757|11"}]},{n:"\u5B81\u590F",g:"106.155481,37.321323|8",cities:[{n:"\u94F6\u5DDD",g:"106.206479,38.502621|12"},{n:"\u56FA\u539F",g:"106.285268,36.021523|13"},{n:"\u77F3\u5634\u5C71",g:"106.379337,39.020223|13"},{n:"\u5434\u5FE0",g:"106.208254,37.993561|14"},{n:"\u4E2D\u536B",g:"105.196754,37.521124|14"}]},{n:"\u9752\u6D77",g:"96.202544,35.499761|7",cities:[{n:"\u897F\u5B81",g:"101.767921,36.640739|12"},{n:"\u679C\u6D1B\u5DDE",g:"100.223723,34.480485|11"},{n:"\u6D77\u4E1C\u5730\u533A",g:"102.085207,36.51761|11"},{n:"\u6D77\u5317\u5DDE",g:"100.879802,36.960654|11"},{n:"\u6D77\u5357\u5DDE",g:"100.624066,36.284364|11"},{n:"\u6D77\u897F\u5DDE",g:"97.342625,37.373799|11"},{n:"\u9EC4\u5357\u5DDE",g:"102.0076,35.522852|11"},{n:"\u7389\u6811\u5DDE",g:"97.013316,33.00624|14"}]},{n:"\u5C71\u4E1C",g:"118.527663,36.09929|8",cities:[{n:"\u6D4E\u5357",g:"117.024967,36.682785|12"},{n:"\u6EE8\u5DDE",g:"117.968292,37.405314|12"},{n:"\u4E1C\u8425",g:"118.583926,37.487121|12"},{n:"\u5FB7\u5DDE",g:"116.328161,37.460826|12"},{n:"\u83CF\u6CFD",g:"115.46336,35.26244|13"},{n:"\u6D4E\u5B81",g:"116.600798,35.402122|13"},{n:"\u83B1\u829C",g:"117.684667,36.233654|13"},{n:"\u804A\u57CE",g:"115.986869,36.455829|12"},{n:"\u4E34\u6C82",g:"118.340768,35.072409|12"},{n:"\u9752\u5C9B",g:"120.384428,36.105215|12"},{n:"\u65E5\u7167",g:"119.50718,35.420225|12"},{n:"\u6CF0\u5B89",g:"117.089415,36.188078|13"},{n:"\u5A01\u6D77",g:"122.093958,37.528787|13"},{n:"\u6F4D\u574A",g:"119.142634,36.716115|12"},{n:"\u70DF\u53F0",g:"121.309555,37.536562|12"},{n:"\u67A3\u5E84",g:"117.279305,34.807883|13"},{n:"\u6DC4\u535A",g:"118.059134,36.804685|12"}]},{n:"\u5C71\u897F",g:"112.515496,37.866566|7",cities:[{n:"\u592A\u539F",g:"112.550864,37.890277|12"},{n:"\u957F\u6CBB",g:"113.120292,36.201664|12"},{n:"\u5927\u540C",g:"113.290509,40.113744|12"},{n:"\u664B\u57CE",g:"112.867333,35.499834|13"},{n:"\u664B\u4E2D",g:"112.738514,37.693362|13"},{n:"\u4E34\u6C7E",g:"111.538788,36.099745|13"},{n:"\u5415\u6881",g:"111.143157,37.527316|14"},{n:"\u6714\u5DDE",g:"112.479928,39.337672|13"},{n:"\u5FFB\u5DDE",g:"112.727939,38.461031|12"},{n:"\u9633\u6CC9",g:"113.569238,37.869529|13"},{n:"\u8FD0\u57CE",g:"111.006854,35.038859|13"}]},{n:"\u9655\u897F",g:"109.503789,35.860026|7",cities:[{n:"\u897F\u5B89",g:"108.953098,34.2778|12"},{n:"\u5B89\u5EB7",g:"109.038045,32.70437|13"},{n:"\u5B9D\u9E21",g:"107.170645,34.364081|12"},{n:"\u6C49\u4E2D",g:"107.045478,33.081569|13"},{n:"\u5546\u6D1B",g:"109.934208,33.873907|13"},{n:"\u94DC\u5DDD",g:"108.968067,34.908368|13"},{n:"\u6E2D\u5357",g:"109.483933,34.502358|13"},{n:"\u54B8\u9633",g:"108.707509,34.345373|13"},{n:"\u5EF6\u5B89",g:"109.50051,36.60332|13"},{n:"\u6986\u6797",g:"109.745926,38.279439|12"}]},{n:"\u56DB\u5DDD",g:"102.89916,30.367481|7",cities:[{n:"\u6210\u90FD",g:"104.067923,30.679943|12"},{n:"\u963F\u575D\u5DDE",g:"102.228565,31.905763|15"},{n:"\u5DF4\u4E2D",g:"106.757916,31.869189|14"},{n:"\u8FBE\u5DDE",g:"107.494973,31.214199|14"},{n:"\u5FB7\u9633",g:"104.402398,31.13114|13"},{n:"\u7518\u5B5C\u5DDE",g:"101.969232,30.055144|15"},{n:"\u5E7F\u5B89",g:"106.63572,30.463984|13"},{n:"\u5E7F\u5143",g:"105.819687,32.44104|13"},{n:"\u4E50\u5C71",g:"103.760824,29.600958|13"},{n:"\u51C9\u5C71\u5DDE",g:"102.259591,27.892393|14"},{n:"\u6CF8\u5DDE",g:"105.44397,28.89593|14"},{n:"\u5357\u5145",g:"106.105554,30.800965|13"},{n:"\u7709\u5C71",g:"103.84143,30.061115|13"},{n:"\u7EF5\u9633",g:"104.705519,31.504701|12"},{n:"\u5185\u6C5F",g:"105.073056,29.599462|13"},{n:"\u6500\u679D\u82B1",g:"101.722423,26.587571|14"},{n:"\u9042\u5B81",g:"105.564888,30.557491|12"},{n:"\u96C5\u5B89",g:"103.009356,29.999716|13"},{n:"\u5B9C\u5BBE",g:"104.633019,28.769675|13"},{n:"\u8D44\u9633",g:"104.63593,30.132191|13"},{n:"\u81EA\u8D21",g:"104.776071,29.359157|13"}]},{n:"\u897F\u85CF",g:"89.137982,31.367315|6",cities:[{n:"\u62C9\u8428",g:"91.111891,29.662557|13"},{n:"\u963F\u91CC\u5730\u533A",g:"81.107669,30.404557|11"},{n:"\u660C\u90FD\u5730\u533A",g:"97.185582,31.140576|15"},{n:"\u6797\u829D\u5730\u533A",g:"94.349985,29.666941|11"},{n:"\u90A3\u66F2\u5730\u533A",g:"92.067018,31.48068|14"},{n:"\u65E5\u5580\u5219\u5730\u533A",g:"88.891486,29.269023|14"},{n:"\u5C71\u5357\u5730\u533A",g:"91.750644,29.229027|11"}]},{n:"\u65B0\u7586",g:"85.614899,42.127001|6",cities:[{n:"\u4E4C\u9C81\u6728\u9F50",g:"87.564988,43.84038|12"},{n:"\u963F\u62C9\u5C14",g:"81.291737,40.61568|13"},{n:"\u963F\u514B\u82CF\u5730\u533A",g:"80.269846,41.171731|12"},{n:"\u963F\u52D2\u6CF0\u5730\u533A",g:"88.137915,47.839744|13"},{n:"\u5DF4\u97F3\u90ED\u695E",g:"86.121688,41.771362|12"},{n:"\u535A\u5C14\u5854\u62C9\u5DDE",g:"82.052436,44.913651|11"},{n:"\u660C\u5409\u5DDE",g:"87.296038,44.007058|13"},{n:"\u54C8\u5BC6\u5730\u533A",g:"93.528355,42.858596|13"},{n:"\u548C\u7530\u5730\u533A",g:"79.930239,37.116774|13"},{n:"\u5580\u4EC0\u5730\u533A",g:"75.992973,39.470627|12"},{n:"\u514B\u62C9\u739B\u4F9D",g:"84.88118,45.594331|13"},{n:"\u514B\u5B5C\u52D2\u82CF\u5DDE",g:"76.137564,39.750346|11"},{n:"\u77F3\u6CB3\u5B50",g:"86.041865,44.308259|13"},{n:"\u5854\u57CE\u5730\u533A",g:"82.974881,46.758684|12"},{n:"\u56FE\u6728\u8212\u514B",g:"79.198155,39.889223|13"},{n:"\u5410\u9C81\u756A\u5730\u533A",g:"89.181595,42.96047|13"},{n:"\u4E94\u5BB6\u6E20",g:"87.565449,44.368899|13"},{n:"\u4F0A\u7281\u5DDE",g:"81.297854,43.922248|11"}]},{n:"\u4E91\u5357",g:"101.592952,24.864213|7",cities:[{n:"\u6606\u660E",g:"102.714601,25.049153|12"},{n:"\u4FDD\u5C71",g:"99.177996,25.120489|13"},{n:"\u695A\u96C4\u5DDE",g:"101.529382,25.066356|13"},{n:"\u5927\u7406\u5DDE",g:"100.223675,25.5969|14"},{n:"\u5FB7\u5B8F\u5DDE",g:"98.589434,24.44124|14"},{n:"\u8FEA\u5E86\u5DDE",g:"99.713682,27.831029|14"},{n:"\u7EA2\u6CB3\u5DDE",g:"103.384065,23.367718|11"},{n:"\u4E3D\u6C5F",g:"100.229628,26.875351|13"},{n:"\u4E34\u6CA7",g:"100.092613,23.887806|14"},{n:"\u6012\u6C5F\u5DDE",g:"98.859932,25.860677|14"},{n:"\u666E\u6D31",g:"100.980058,22.788778|14"},{n:"\u66F2\u9756",g:"103.782539,25.520758|12"},{n:"\u662D\u901A",g:"103.725021,27.340633|13"},{n:"\u6587\u5C71",g:"104.089112,23.401781|14"},{n:"\u897F\u53CC\u7248\u7EB3",g:"100.803038,22.009433|13"},{n:"\u7389\u6EAA",g:"102.545068,24.370447|13"}]},{n:"\u6D59\u6C5F",g:"119.957202,29.159494|8",cities:[{n:"\u676D\u5DDE",g:"120.219375,30.259244|12"},{n:"\u6E56\u5DDE",g:"120.137243,30.877925|12"},{n:"\u5609\u5174",g:"120.760428,30.773992|13"},{n:"\u91D1\u534E",g:"119.652576,29.102899|12"},{n:"\u4E3D\u6C34",g:"119.929576,28.4563|13"},{n:"\u5B81\u6CE2",g:"121.579006,29.885259|12"},{n:"\u8862\u5DDE",g:"118.875842,28.95691|12"},{n:"\u7ECD\u5174",g:"120.592467,30.002365|13"},{n:"\u53F0\u5DDE",g:"121.440613,28.668283|13"},{n:"\u6E29\u5DDE",g:"120.690635,28.002838|12"},{n:"\u821F\u5C71",g:"122.169872,30.03601|13"}]}],Bd=[{n:"\u9999\u6E2F",g:"114.186124,22.293586|11"},{n:"\u6FB3\u95E8",g:"113.557519,22.204118|13"},{n:"\u53F0\u6E7E",g:"120.961454,23.80406|8"}],Sc=void 0,Um=function(){if(Sc!==void 0)return Sc;var a=navigator.userAgent,u="Android;iPhone;SymbianOS;Windows Phone;iPad;iPod".split(";");Sc=!1;for(var n=0;n<u.length;n++)if(0<a.indexOf(u[n])){Sc=!0;break}return Sc}(),wh=void 0,Hm=function(){if(wh!==void 0)return wh;var a=navigator.userAgent,u=["iPhone","iPad","iPod"];wh=!1;for(var n=0;n<u.length;n++)if(0<a.indexOf(u[n])){wh=!0;break}return wh}(),Nd=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),_h=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Xf=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),km=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ts=Array(576);Ca(Ts);var Ru=Array(60);Ca(Ru);var Na=Array(512);Ca(Na);var Mh=Array(256);Ca(Mh);var Yf=Array(29);Ca(Yf);var wl=Array(30);Ca(wl);var Zf=void 0,Qn=void 0,_l=void 0,Ml=function(a,u){a.pending_buf[a.pending++]=u&255,a.pending_buf[a.pending++]=u>>>8&255},Ho=function(a,u,n){a.bi_valid>16-n?(a.bi_buf|=u<<a.bi_valid&65535,Ml(a,a.bi_buf),a.bi_buf=u>>16-a.bi_valid,a.bi_valid+=n-16):(a.bi_buf|=u<<a.bi_valid&65535,a.bi_valid+=n)},ko=function(a,u,n){Ho(a,n[2*u],n[2*u+1])},zd=function(a,u){var n=0;do n|=a&1,a>>>=1,n<<=1;while(0<--u);return n>>>1},Gm=function(a,u,n){var l=Array(16),v=0,d;for(d=1;15>=d;d++)l[d]=v=v+n[d-1]<<1;for(n=0;n<=u;n++)v=a[2*n+1],v!==0&&(a[2*n]=zd(l[v]++,v))},Pu=function(a){var u;for(u=0;286>u;u++)a.dyn_ltree[2*u]=0;for(u=0;30>u;u++)a.dyn_dtree[2*u]=0;for(u=0;19>u;u++)a.bl_tree[2*u]=0;a.dyn_ltree[512]=1,a.opt_len=a.static_len=0,a.last_lit=a.matches=0},Ud=function(a){8<a.bi_valid?Ml(a,a.bi_buf):0<a.bi_valid&&(a.pending_buf[a.pending++]=a.bi_buf),a.bi_buf=0,a.bi_valid=0},us=function(a,u,n,l){var v=2*u,d=2*n;return a[v]<a[d]||a[v]===a[d]&&l[u]<=l[n]},Hd=function(a,u,n){for(var l=a.heap[n],v=n<<1;v<=a.heap_len&&(v<a.heap_len&&us(u,a.heap[v+1],a.heap[v],a.depth)&&v++,!us(u,l,a.heap[v],a.depth));)a.heap[n]=a.heap[v],n=v,v<<=1;a.heap[n]=l},Ch=function(a,u,n){var l=0;if(a.last_lit!==0)do{var v=a.pending_buf[a.d_buf+2*l]<<8|a.pending_buf[a.d_buf+2*l+1],d=a.pending_buf[a.l_buf+l];if(l++,v===0)ko(a,d,u);else{var x=Mh[d];ko(a,x+256+1,u);var y=Nd[x];y!==0&&(d-=Yf[x],Ho(a,d,y)),v--,x=256>v?Na[v]:Na[256+(v>>>7)],ko(a,x,n),y=_h[x],y!==0&&(v-=wl[x],Ho(a,v,y))}}while(l<a.last_lit);ko(a,256,u)},bm=function(a,u){var n=u.dyn_tree,l=u.stat_desc.static_tree,v=u.stat_desc.has_stree,d=u.stat_desc.elems,x,y=-1;for(a.heap_len=0,a.heap_max=573,x=0;x<d;x++)n[2*x]!==0?(a.heap[++a.heap_len]=y=x,a.depth[x]=0):n[2*x+1]=0;for(;2>a.heap_len;){var M=a.heap[++a.heap_len]=2>y?++y:0;n[2*M]=1,a.depth[M]=0,a.opt_len--,v&&(a.static_len-=l[2*M+1])}for(u.max_code=y,x=a.heap_len>>1;1<=x;x--)Hd(a,n,x);M=d;do x=a.heap[1],a.heap[1]=a.heap[a.heap_len--],Hd(a,n,1),l=a.heap[1],a.heap[--a.heap_max]=x,a.heap[--a.heap_max]=l,n[2*M]=n[2*x]+n[2*l],a.depth[M]=(a.depth[x]>=a.depth[l]?a.depth[x]:a.depth[l])+1,n[2*x+1]=n[2*l+1]=M,a.heap[1]=M++,Hd(a,n,1);while(2<=a.heap_len);a.heap[--a.heap_max]=a.heap[1],x=u.dyn_tree,M=u.max_code,l=u.stat_desc.static_tree,v=u.stat_desc.has_stree,d=u.stat_desc.extra_bits;var D=u.stat_desc.extra_base,U=u.stat_desc.max_length,C,E=0;for(C=0;15>=C;C++)a.bl_count[C]=0;for(x[2*a.heap[a.heap_max]+1]=0,u=a.heap_max+1;573>u;u++){var B=a.heap[u];if(C=x[2*x[2*B+1]+1]+1,C>U&&(C=U,E++),x[2*B+1]=C,!(B>M)){a.bl_count[C]++;var O=0;B>=D&&(O=d[B-D]);var H=x[2*B];a.opt_len+=H*(C+O),v&&(a.static_len+=H*(l[2*B+1]+O))}}if(E!==0){do{for(C=U-1;a.bl_count[C]===0;)C--;a.bl_count[C]--,a.bl_count[C+1]+=2,a.bl_count[U]--,E-=2}while(0<E);for(C=U;C!==0;C--)for(B=a.bl_count[C];B!==0;)l=a.heap[--u],l>M||(x[2*l+1]!==C&&(a.opt_len+=(C-x[2*l+1])*x[2*l],x[2*l+1]=C),B--)}Gm(n,y,a.bl_count)},t1=function(a,u,n){var l,v=-1,d=u[1],x=0,y=7,M=4;for(d===0&&(y=138,M=3),u[2*(n+1)+1]=65535,l=0;l<=n;l++){var D=d;d=u[2*(l+1)+1],++x<y&&D===d||(x<M?a.bl_tree[2*D]+=x:D!==0?(D!==v&&a.bl_tree[2*D]++,a.bl_tree[32]++):10>=x?a.bl_tree[34]++:a.bl_tree[36]++,x=0,v=D,d===0?(y=138,M=3):D===d?(y=6,M=3):(y=7,M=4))}},e1=function(a,u,n){var l,v=-1,d=u[1],x=0,y=7,M=4;for(d===0&&(y=138,M=3),l=0;l<=n;l++){var D=d;if(d=u[2*(l+1)+1],!(++x<y&&D===d)){if(x<M)do ko(a,D,a.bl_tree);while(--x!=0);else D!==0?(D!==v&&(ko(a,D,a.bl_tree),x--),ko(a,16,a.bl_tree),Ho(a,x-3,2)):10>=x?(ko(a,17,a.bl_tree),Ho(a,x-3,3)):(ko(a,18,a.bl_tree),Ho(a,x-11,7));x=0,v=D,d===0?(y=138,M=3):D===d?(y=6,M=3):(y=7,M=4)}}},Ro=function(a){var u=4093624447,n;for(n=0;31>=n;n++,u>>>=1)if(u&1&&a.dyn_ltree[2*n]!==0)return 0;if(a.dyn_ltree[18]!==0||a.dyn_ltree[20]!==0||a.dyn_ltree[26]!==0)return 1;for(n=32;256>n;n++)if(a.dyn_ltree[2*n]!==0)return 1;return 0},r1=!1,bn=function(a,u,n,l){Ho(a,l?1:0,3),Ud(a),Ml(a,n),Ml(a,~n),a.pending_buf.set(a.window.subarray(u,u+n),a.pending),a.pending+=n},Vn=function(a,u,n,l){var v=a&65535|0;a=a>>>16&65535|0;for(var d;n!==0;){d=2e3<n?2e3:n,n-=d;do v=v+u[l++]|0,a=a+v|0;while(--d);v%=65521,a%=65521}return v|a<<16|0},Vm=new Uint32Array(function(){for(var a,u=[],n=0;256>n;n++){a=n;for(var l=0;8>l;l++)a=a&1?3988292384^a>>>1:a>>>1;u[n]=a}return u}()),Po=function(a,u,n,l){for(n=l+n,a^=-1;l<n;l++)a=a>>>8^Vm[(a^u[l])&255];return a^-1},Wn={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ai={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},$r=function(a,u,n){return a.pending_buf[a.d_buf+2*a.last_lit]=u>>>8&255,a.pending_buf[a.d_buf+2*a.last_lit+1]=u&255,a.pending_buf[a.l_buf+a.last_lit]=n&255,a.last_lit++,u===0?a.dyn_ltree[2*n]++:(a.matches++,u--,a.dyn_ltree[2*(Mh[n]+256+1)]++,a.dyn_dtree[2*(256>u?Na[u]:Na[256+(u>>>7)])]++),a.last_lit===a.lit_bufsize-1},Li=ai.Z_NO_FLUSH,Th=ai.Z_PARTIAL_FLUSH,Do=ai.Z_FULL_FLUSH,xn=ai.Z_FINISH,Go=ai.Z_BLOCK,bo=ai.Z_OK,Ss=ai.Z_STREAM_END,Ko=ai.Z_STREAM_ERROR,kd=ai.Z_DATA_ERROR,Gd=ai.Z_BUF_ERROR,Jf=ai.Z_DEFAULT_COMPRESSION,Zx=ai.Z_FILTERED,Qo=ai.Z_HUFFMAN_ONLY,Cl=ai.Z_RLE,au=ai.Z_FIXED,Jx=ai.Z_DEFAULT_STRATEGY,fn=ai.Z_UNKNOWN,_o=ai.Z_DEFLATED,Ze=function(a,u){return a.msg=Wn[u],u},Tl=function(a){for(var u=a.length;0<=--u;)a[u]=0},Is=function(a,u,n){return(u<<a.hash_shift^n)&a.hash_mask},uu=function(a){var u=a.state,n=u.pending;n>a.avail_out&&(n=a.avail_out),n!==0&&(a.output.set(u.pending_buf.subarray(u.pending_out,u.pending_out+n),a.next_out),a.next_out+=n,u.pending_out+=n,a.total_out+=n,a.avail_out-=n,u.pending-=n,u.pending===0&&(u.pending_out=0))},Pn=function(a,u){var n=0<=a.block_start?a.block_start:-1,l=a.strstart-a.block_start,v=0;if(0<a.level){for(a.strm.data_type===2&&(a.strm.data_type=Ro(a)),bm(a,a.l_desc),bm(a,a.d_desc),t1(a,a.dyn_ltree,a.l_desc.max_code),t1(a,a.dyn_dtree,a.d_desc.max_code),bm(a,a.bl_desc),v=18;3<=v&&a.bl_tree[2*km[v]+1]===0;v--);a.opt_len+=3*(v+1)+14;var d=a.opt_len+3+7>>>3,x=a.static_len+3+7>>>3;x<=d&&(d=x)}else d=x=l+5;if(l+4<=d&&n!==-1)bn(a,n,l,u);else if(a.strategy===4||x===d)Ho(a,2+(u?1:0),3),Ch(a,Ts,Ru);else{for(Ho(a,4+(u?1:0),3),n=a.l_desc.max_code+1,l=a.d_desc.max_code+1,v+=1,Ho(a,n-257,5),Ho(a,l-1,5),Ho(a,v-4,4),d=0;d<v;d++)Ho(a,a.bl_tree[2*km[d]+1],3);e1(a,a.dyn_ltree,n-1),e1(a,a.dyn_dtree,l-1),Ch(a,a.dyn_ltree,a.dyn_dtree)}Pu(a),u&&Ud(a),a.block_start=a.strstart,uu(a.strm)},_i=function(a,u){a.pending_buf[a.pending++]=u},qf=function(a,u){a.pending_buf[a.pending++]=u>>>8&255,a.pending_buf[a.pending++]=u&255},i1=function(a,u){var n=a.max_chain_length,l=a.strstart,v=a.prev_length,d=a.nice_match,x=a.strstart>a.w_size-262?a.strstart-(a.w_size-262):0,y=a.window,M=a.w_mask,D=a.prev,U=a.strstart+258,C=y[l+v-1],E=y[l+v];a.prev_length>=a.good_match&&(n>>=2),d>a.lookahead&&(d=a.lookahead);do{var B=u;if(y[B+v]===E&&y[B+v-1]===C&&y[B]===y[l]&&y[++B]===y[l+1]){for(l+=2,B++;y[++l]===y[++B]&&y[++l]===y[++B]&&y[++l]===y[++B]&&y[++l]===y[++B]&&y[++l]===y[++B]&&y[++l]===y[++B]&&y[++l]===y[++B]&&y[++l]===y[++B]&&l<U;);if(B=258-(U-l),l=U-258,B>v){if(a.match_start=u,v=B,B>=d)break;C=y[l+v-1],E=y[l+v]}}}while((u=D[u&M])>x&&--n!=0);return v<=a.lookahead?v:a.lookahead},Du=function(a){var u=a.w_size,n;do{var l=a.window_size-a.lookahead-a.strstart;if(a.strstart>=u+(u-262)){a.window.set(a.window.subarray(u,u+u),0),a.match_start-=u,a.strstart-=u,a.block_start-=u;var v=n=a.hash_size;do{var d=a.head[--v];a.head[v]=d>=u?d-u:0}while(--n);v=n=u;do d=a.prev[--v],a.prev[v]=d>=u?d-u:0;while(--n);l+=u}if(a.strm.avail_in===0)break;v=a.strm,n=a.window,d=a.strstart+a.lookahead;var x=v.avail_in;if(x>l&&(x=l),x===0?n=0:(v.avail_in-=x,n.set(v.input.subarray(v.next_in,v.next_in+x),d),v.state.wrap===1?v.adler=Vn(v.adler,n,x,d):v.state.wrap===2&&(v.adler=Po(v.adler,n,x,d)),v.next_in+=x,v.total_in+=x,n=x),a.lookahead+=n,3<=a.lookahead+a.insert)for(l=a.strstart-a.insert,a.ins_h=a.window[l],a.ins_h=Is(a,a.ins_h,a.window[l+1]);a.insert&&(a.ins_h=Is(a,a.ins_h,a.window[l+3-1]),a.prev[l&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=l,l++,a.insert--,!(3>a.lookahead+a.insert)););}while(262>a.lookahead&&a.strm.avail_in!==0)},Wm=function(a,u){for(var n;;){if(262>a.lookahead){if(Du(a),262>a.lookahead&&u===Li)return 1;if(a.lookahead===0)break}if(n=0,3<=a.lookahead&&(a.ins_h=Is(a,a.ins_h,a.window[a.strstart+3-1]),n=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),n!==0&&a.strstart-n<=a.w_size-262&&(a.match_length=i1(a,n)),3<=a.match_length)if(n=$r(a,a.strstart-a.match_start,a.match_length-3),a.lookahead-=a.match_length,a.match_length<=a.max_lazy_match&&3<=a.lookahead){a.match_length--;do a.strstart++,a.ins_h=Is(a,a.ins_h,a.window[a.strstart+3-1]),a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart;while(--a.match_length!=0);a.strstart++}else a.strstart+=a.match_length,a.match_length=0,a.ins_h=a.window[a.strstart],a.ins_h=Is(a,a.ins_h,a.window[a.strstart+1]);else n=$r(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++;if(n&&(Pn(a,!1),a.strm.avail_out===0))return 1}return a.insert=2>a.strstart?a.strstart:2,u===xn?(Pn(a,!0),a.strm.avail_out===0?3:4):a.last_lit&&(Pn(a,!1),a.strm.avail_out===0)?1:2},Ou=function(a,u){for(var n,l;;){if(262>a.lookahead){if(Du(a),262>a.lookahead&&u===Li)return 1;if(a.lookahead===0)break}if(n=0,3<=a.lookahead&&(a.ins_h=Is(a,a.ins_h,a.window[a.strstart+3-1]),n=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),a.prev_length=a.match_length,a.prev_match=a.match_start,a.match_length=2,n!==0&&a.prev_length<a.max_lazy_match&&a.strstart-n<=a.w_size-262&&(a.match_length=i1(a,n),5>=a.match_length&&(a.strategy===Zx||a.match_length===3&&4096<a.strstart-a.match_start)&&(a.match_length=2)),3<=a.prev_length&&a.match_length<=a.prev_length){l=a.strstart+a.lookahead-3,n=$r(a,a.strstart-1-a.prev_match,a.prev_length-3),a.lookahead-=a.prev_length-1,a.prev_length-=2;do++a.strstart<=l&&(a.ins_h=Is(a,a.ins_h,a.window[a.strstart+3-1]),a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);while(--a.prev_length!=0);if(a.match_available=0,a.match_length=2,a.strstart++,n&&(Pn(a,!1),a.strm.avail_out===0))return 1}else if(a.match_available){if((n=$r(a,0,a.window[a.strstart-1]))&&Pn(a,!1),a.strstart++,a.lookahead--,a.strm.avail_out===0)return 1}else a.match_available=1,a.strstart++,a.lookahead--}return a.match_available&&($r(a,0,a.window[a.strstart-1]),a.match_available=0),a.insert=2>a.strstart?a.strstart:2,u===xn?(Pn(a,!0),a.strm.avail_out===0?3:4):a.last_lit&&(Pn(a,!1),a.strm.avail_out===0)?1:2},qx=function(a,u){for(var n,l,v,d=a.window;;){if(258>=a.lookahead){if(Du(a),258>=a.lookahead&&u===Li)return 1;if(a.lookahead===0)break}if(a.match_length=0,3<=a.lookahead&&0<a.strstart&&(l=a.strstart-1,n=d[l],n===d[++l]&&n===d[++l]&&n===d[++l])){for(v=a.strstart+258;n===d[++l]&&n===d[++l]&&n===d[++l]&&n===d[++l]&&n===d[++l]&&n===d[++l]&&n===d[++l]&&n===d[++l]&&l<v;);a.match_length=258-(v-l),a.match_length>a.lookahead&&(a.match_length=a.lookahead)}if(3<=a.match_length?(n=$r(a,1,a.match_length-3),a.lookahead-=a.match_length,a.strstart+=a.match_length,a.match_length=0):(n=$r(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++),n&&(Pn(a,!1),a.strm.avail_out===0))return 1}return a.insert=0,u===xn?(Pn(a,!0),a.strm.avail_out===0?3:4):a.last_lit&&(Pn(a,!1),a.strm.avail_out===0)?1:2},Kx=function(a,u){for(var n;;){if(a.lookahead===0&&(Du(a),a.lookahead===0)){if(u===Li)return 1;break}if(a.match_length=0,n=$r(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++,n&&(Pn(a,!1),a.strm.avail_out===0))return 1}return a.insert=0,u===xn?(Pn(a,!0),a.strm.avail_out===0?3:4):a.last_lit&&(Pn(a,!1),a.strm.avail_out===0)?1:2},Fu=[new Ir(0,0,0,0,function(a,u){var n=65535;for(n>a.pending_buf_size-5&&(n=a.pending_buf_size-5);;){if(1>=a.lookahead){if(Du(a),a.lookahead===0&&u===Li)return 1;if(a.lookahead===0)break}a.strstart+=a.lookahead,a.lookahead=0;var l=a.block_start+n;if((a.strstart===0||a.strstart>=l)&&(a.lookahead=a.strstart-l,a.strstart=l,Pn(a,!1),a.strm.avail_out===0)||a.strstart-a.block_start>=a.w_size-262&&(Pn(a,!1),a.strm.avail_out===0))return 1}return a.insert=0,u===xn?(Pn(a,!0),a.strm.avail_out===0?3:4):(a.strstart>a.block_start&&Pn(a,!1),1)}),new Ir(4,4,8,4,Wm),new Ir(4,5,16,8,Wm),new Ir(4,6,32,32,Wm),new Ir(4,4,16,16,Ou),new Ir(8,16,32,32,Ou),new Ir(8,16,128,128,Ou),new Ir(8,32,128,256,Ou),new Ir(32,128,258,1024,Ou),new Ir(32,258,258,4096,Ou)],n1=function(a){if(!a||!a.state)return Ze(a,Ko);a.total_in=a.total_out=0,a.data_type=fn;var u=a.state;if(u.pending=0,u.pending_out=0,0>u.wrap&&(u.wrap=-u.wrap),u.status=u.wrap?42:113,a.adler=u.wrap===2?0:1,u.last_flush=Li,!r1){var n,l,v;for(a=Array(16),v=l=0;28>v;v++)for(Yf[v]=l,n=0;n<1<<Nd[v];n++)Mh[l++]=v;for(Mh[l-1]=v,v=l=0;16>v;v++)for(wl[v]=l,n=0;n<1<<_h[v];n++)Na[l++]=v;for(l>>=7;30>v;v++)for(wl[v]=l<<7,n=0;n<1<<_h[v]-7;n++)Na[256+l++]=v;for(n=0;15>=n;n++)a[n]=0;for(n=0;143>=n;)Ts[2*n+1]=8,n++,a[8]++;for(;255>=n;)Ts[2*n+1]=9,n++,a[9]++;for(;279>=n;)Ts[2*n+1]=7,n++,a[7]++;for(;287>=n;)Ts[2*n+1]=8,n++,a[8]++;for(Gm(Ts,287,a),n=0;30>n;n++)Ru[2*n+1]=5,Ru[2*n]=zd(n,5);Zf=new kr(Ts,Nd,257,286,15),Qn=new kr(Ru,_h,0,30,15),_l=new kr([],Xf,0,19,7),r1=!0}return u.l_desc=new ro(u.dyn_ltree,Zf),u.d_desc=new ro(u.dyn_dtree,Qn),u.bl_desc=new ro(u.bl_tree,_l),u.bi_buf=0,u.bi_valid=0,Pu(u),bo},o1=function(a){var u=n1(a);return u===bo&&(a=a.state,a.window_size=2*a.w_size,Tl(a.head),a.max_lazy_match=Fu[a.level].max_lazy,a.good_match=Fu[a.level].good_length,a.nice_match=Fu[a.level].nice_length,a.max_chain_length=Fu[a.level].max_chain,a.strstart=0,a.block_start=0,a.lookahead=0,a.insert=0,a.match_length=a.prev_length=2,a.match_available=0,a.ins_h=0),u},Kf=function(a,u,n,l,v,d){if(!a)return Ko;var x=1;if(u===Jf&&(u=6),0>l?(x=0,l=-l):15<l&&(x=2,l-=16),1>v||9<v||n!==_o||8>l||15<l||0>u||9<u||0>d||d>au)return Ze(a,Ko);l===8&&(l=9);var y=new rd;return a.state=y,y.strm=a,y.wrap=x,y.gzhead=null,y.w_bits=l,y.w_size=1<<y.w_bits,y.w_mask=y.w_size-1,y.hash_bits=v+7,y.hash_size=1<<y.hash_bits,y.hash_mask=y.hash_size-1,y.hash_shift=~~((y.hash_bits+3-1)/3),y.window=new Uint8Array(2*y.w_size),y.head=new Uint16Array(y.hash_size),y.prev=new Uint16Array(y.w_size),y.lit_bufsize=1<<v+6,y.pending_buf_size=4*y.lit_bufsize,y.pending_buf=new Uint8Array(y.pending_buf_size),y.d_buf=1*y.lit_bufsize,y.l_buf=3*y.lit_bufsize,y.level=u,y.strategy=d,y.method=n,o1(a)},Ic={deflateInit:function(a,u){return Kf(a,u,_o,15,8,Jx)},deflateInit2:Kf,deflateReset:o1,deflateResetKeep:n1,deflateSetHeader:function(a,u){return!a||!a.state||a.state.wrap!==2?Ko:(a.state.gzhead=u,bo)},deflate:function(a,u){if(!a||!a.state||u>Go||0>u)return a?Ze(a,Ko):Ko;var n=a.state;if(!a.output||!a.input&&a.avail_in!==0||n.status===666&&u!==xn)return Ze(a,a.avail_out===0?Gd:Ko);n.strm=a;var l=n.last_flush;if(n.last_flush=u,n.status===42)if(n.wrap===2)a.adler=0,_i(n,31),_i(n,139),_i(n,8),n.gzhead?(_i(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),_i(n,n.gzhead.time&255),_i(n,n.gzhead.time>>8&255),_i(n,n.gzhead.time>>16&255),_i(n,n.gzhead.time>>24&255),_i(n,n.level===9?2:n.strategy>=Qo||2>n.level?4:0),_i(n,n.gzhead.os&255),n.gzhead.extra&&n.gzhead.extra.length&&(_i(n,n.gzhead.extra.length&255),_i(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(a.adler=Po(a.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(_i(n,0),_i(n,0),_i(n,0),_i(n,0),_i(n,0),_i(n,n.level===9?2:n.strategy>=Qo||2>n.level?4:0),_i(n,3),n.status=113);else{var v=_o+(n.w_bits-8<<4)<<8;v|=(n.strategy>=Qo||2>n.level?0:6>n.level?1:n.level===6?2:3)<<6,n.strstart!==0&&(v|=32),n.status=113,qf(n,v+(31-v%31)),n.strstart!==0&&(qf(n,a.adler>>>16),qf(n,a.adler&65535)),a.adler=1}if(n.status===69)if(n.gzhead.extra){for(v=n.pending;n.gzindex<(n.gzhead.extra.length&65535)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>v&&(a.adler=Po(a.adler,n.pending_buf,n.pending-v,v)),uu(a),v=n.pending,n.pending!==n.pending_buf_size));)_i(n,n.gzhead.extra[n.gzindex]&255),n.gzindex++;n.gzhead.hcrc&&n.pending>v&&(a.adler=Po(a.adler,n.pending_buf,n.pending-v,v)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(n.status===73)if(n.gzhead.name){v=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>v&&(a.adler=Po(a.adler,n.pending_buf,n.pending-v,v)),uu(a),v=n.pending,n.pending===n.pending_buf_size)){var d=1;break}d=n.gzindex<n.gzhead.name.length?n.gzhead.name.charCodeAt(n.gzindex++)&255:0,_i(n,d)}while(d!==0);n.gzhead.hcrc&&n.pending>v&&(a.adler=Po(a.adler,n.pending_buf,n.pending-v,v)),d===0&&(n.gzindex=0,n.status=91)}else n.status=91;if(n.status===91)if(n.gzhead.comment){v=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>v&&(a.adler=Po(a.adler,n.pending_buf,n.pending-v,v)),uu(a),v=n.pending,n.pending===n.pending_buf_size)){d=1;break}d=n.gzindex<n.gzhead.comment.length?n.gzhead.comment.charCodeAt(n.gzindex++)&255:0,_i(n,d)}while(d!==0);n.gzhead.hcrc&&n.pending>v&&(a.adler=Po(a.adler,n.pending_buf,n.pending-v,v)),d===0&&(n.status=103)}else n.status=103;if(n.status===103&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&uu(a),n.pending+2<=n.pending_buf_size&&(_i(n,a.adler&255),_i(n,a.adler>>8&255),a.adler=0,n.status=113)):n.status=113),n.pending!==0){if(uu(a),a.avail_out===0)return n.last_flush=-1,bo}else if(a.avail_in===0&&(u<<1)-(4<u?9:0)<=(l<<1)-(4<l?9:0)&&u!==xn)return Ze(a,Gd);if(n.status===666&&a.avail_in!==0)return Ze(a,Gd);if(a.avail_in!==0||n.lookahead!==0||u!==Li&&n.status!==666){if(l=n.strategy===Qo?Kx(n,u):n.strategy===Cl?qx(n,u):Fu[n.level].func(n,u),(l===3||l===4)&&(n.status=666),l===1||l===3)return a.avail_out===0&&(n.last_flush=-1),bo;if(l===2&&(u===Th?(Ho(n,2,3),ko(n,256,Ts),n.bi_valid===16?(Ml(n,n.bi_buf),n.bi_buf=0,n.bi_valid=0):8<=n.bi_valid&&(n.pending_buf[n.pending++]=n.bi_buf&255,n.bi_buf>>=8,n.bi_valid-=8)):u!==Go&&(bn(n,0,0,!1),u===Do&&(Tl(n.head),n.lookahead===0&&(n.strstart=0,n.block_start=0,n.insert=0))),uu(a),a.avail_out===0))return n.last_flush=-1,bo}return u!==xn?bo:0>=n.wrap?Ss:(n.wrap===2?(_i(n,a.adler&255),_i(n,a.adler>>8&255),_i(n,a.adler>>16&255),_i(n,a.adler>>24&255),_i(n,a.total_in&255),_i(n,a.total_in>>8&255),_i(n,a.total_in>>16&255),_i(n,a.total_in>>24&255)):(qf(n,a.adler>>>16),qf(n,a.adler&65535)),uu(a),0<n.wrap&&(n.wrap=-n.wrap),n.pending!==0?bo:Ss)},deflateEnd:function(a){if(!a||!a.state)return Ko;var u=a.state.status;return u!==42&&u!==69&&u!==73&&u!==91&&u!==103&&u!==113&&u!==666?Ze(a,Ko):(a.state=null,u===113?Ze(a,kd):bo)},deflateSetDictionary:function(a,u){var n=u.length;if(!a||!a.state)return Ko;var l=a.state,v=l.wrap;if(v===2||v===1&&l.status!==42||l.lookahead)return Ko;if(v===1&&(a.adler=Vn(a.adler,u,n,0)),l.wrap=0,n>=l.w_size){v===0&&(Tl(l.head),l.strstart=0,l.block_start=0,l.insert=0);var d=new Uint8Array(l.w_size);d.set(u.subarray(n-l.w_size,n),0),u=d,n=l.w_size}d=a.avail_in;var x=a.next_in,y=a.input;for(a.avail_in=n,a.next_in=0,a.input=u,Du(l);3<=l.lookahead;){u=l.strstart,n=l.lookahead-2;do l.ins_h=Is(l,l.ins_h,l.window[u+3-1]),l.prev[u&l.w_mask]=l.head[l.ins_h],l.head[l.ins_h]=u,u++;while(--n);l.strstart=u,l.lookahead=2,Du(l)}return l.strstart+=l.lookahead,l.block_start=l.strstart,l.insert=l.lookahead,l.lookahead=0,l.match_length=l.prev_length=2,l.match_available=0,a.next_in=x,a.input=y,a.avail_in=d,l.wrap=v,bo},deflateInfo:"pako deflate (from Nodeca project)"},Ec={assign:function(a){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var n=u.shift();if(n){if((typeof n=="undefined"?"undefined":si(n))!=="object")throw new TypeError(n+"must be non-object");for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(a[l]=n[l])}}return a},flattenChunks:function(a){for(var u=0,n=0,l=a.length;n<l;n++)u+=a[n].length;u=new Uint8Array(u),l=n=0;for(var v=a.length;n<v;n++){var d=a[n];u.set(d,l),l+=d.length}return u}},s1=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(a){s1=!1}for(var Qf=new Uint8Array(256),Bu=0;256>Bu;Bu++)Qf[Bu]=252<=Bu?6:248<=Bu?5:240<=Bu?4:224<=Bu?3:192<=Bu?2:1;Qf[254]=Qf[254]=1;var Sl={string2buf:function(a){var u,n,l=a.length,v=0;for(u=0;u<l;u++){var d=a.charCodeAt(u);if((d&64512)==55296&&u+1<l){var x=a.charCodeAt(u+1);(x&64512)==56320&&(d=65536+(d-55296<<10)+(x-56320),u++)}v+=128>d?1:2048>d?2:65536>d?3:4}var y=new Uint8Array(v);for(u=n=0;n<v;u++)d=a.charCodeAt(u),(d&64512)==55296&&u+1<l&&(x=a.charCodeAt(u+1),(x&64512)==56320&&(d=65536+(d-55296<<10)+(x-56320),u++)),128>d?y[n++]=d:(2048>d?y[n++]=192|d>>>6:(65536>d?y[n++]=224|d>>>12:(y[n++]=240|d>>>18,y[n++]=128|d>>>12&63),y[n++]=128|d>>>6&63),y[n++]=128|d&63);return y},buf2string:function(a,u){var n,l,v=u||a.length;for(u=Array(2*v),n=l=0;n<v;){var d=a[n++];if(128>d)u[l++]=d;else{var x=Qf[d];if(4<x)u[l++]=65533,n+=x-1;else{for(d&=x===2?31:x===3?15:7;1<x&&n<v;)d=d<<6|a[n++]&63,x--;1<x?u[l++]=65533:65536>d?u[l++]=d:(d-=65536,u[l++]=55296|d>>10&1023,u[l++]=56320|d&1023)}}}if(a=l,65534>a&&u.subarray&&s1)u=String.fromCharCode.apply(null,u.length===a?u:u.subarray(0,a));else{for(n="",l=0;l<a;l++)n+=String.fromCharCode(u[l]);u=n}return u},utf8border:function(a,u){u=u||a.length,u>a.length&&(u=a.length);for(var n=u-1;0<=n&&(a[n]&192)==128;)n--;return 0>n||n===0?u:n+Qf[a[n]]>u?n:u}},Sh=function(){this.input=null,this.total_in=this.avail_in=this.next_in=0,this.output=null,this.total_out=this.avail_out=this.next_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},jm=Object.prototype.toString,a1=ai.Z_NO_FLUSH,Xm=ai.Z_SYNC_FLUSH,Qx=ai.Z_FULL_FLUSH,Ym=ai.Z_FINISH,Ih=ai.Z_OK,Il=ai.Z_STREAM_END,$x=ai.Z_DEFAULT_COMPRESSION,tA=ai.Z_DEFAULT_STRATEGY,u1=ai.Z_DEFLATED;wu.prototype.push=function(a,u){var n=this.strm,l=this.options.chunkSize;if(this.ended)return!1;for(u=u===~~u?u:u===!0?Ym:a1,typeof a=="string"?n.input=Sl.string2buf(a):jm.call(a)==="[object ArrayBuffer]"?n.input=new Uint8Array(a):n.input=a,n.next_in=0,n.avail_in=n.input.length;;)if(n.avail_out===0&&(n.output=new Uint8Array(l),n.next_out=0,n.avail_out=l),(u===Xm||u===Qx)&&6>=n.avail_out)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(a=Ic.deflate(n,u),a===Il)return 0<n.next_out&&this.onData(n.output.subarray(0,n.next_out)),a=Ic.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===Ih;if(n.avail_out===0)this.onData(n.output);else if(0<u&&0<n.next_out)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(n.avail_in===0)break}return!0},wu.prototype.onData=function(a){this.chunks.push(a)},wu.prototype.onEnd=function(a){a===Ih&&(this.result=Ec.flattenChunks(this.chunks)),this.chunks=[],this.err=a,this.msg=this.strm.msg};var at=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Zm=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),bd=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Vd=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Lc=function(a,u,n,l,v,d,x,y){var M=y.bits,D,U,C,E,B,O,H=0,V=new Uint16Array(16),G=new Uint16Array(16),j,Y=0;for(D=0;15>=D;D++)V[D]=0;for(U=0;U<l;U++)V[u[n+U]]++;var $=M;for(C=15;1<=C&&V[C]===0;C--);if($>C&&($=C),C===0)return v[d++]=20971520,v[d++]=20971520,y.bits=1,0;for(M=1;M<C&&V[M]===0;M++);for($<M&&($=M),D=E=1;15>=D;D++)if(E<<=1,E-=V[D],0>E)return-1;if(0<E&&(a===0||C!==1))return-1;for(G[1]=0,D=1;15>D;D++)G[D+1]=G[D]+V[D];for(U=0;U<l;U++)u[n+U]!==0&&(x[G[u[n+U]]++]=U);if(a===0)var it=j=x,nt=19;else a===1?(it=at,H-=257,j=Zm,Y-=257,nt=256):(it=bd,j=Vd,nt=-1);U=B=0,D=M;var dt=d;l=$,G=0;var Et=-1,St=1<<$,Xt=St-1;if(a===1&&852<St||a===2&&592<St)return 1;for(;;){var te=D-G;if(x[U]<nt)var Ie=0,pe=x[U];else x[U]>nt?(Ie=j[Y+x[U]],pe=it[H+x[U]]):(Ie=96,pe=0);E=1<<D-G,M=O=1<<l;do O-=E,v[dt+(B>>G)+O]=te<<24|Ie<<16|pe|0;while(O!==0);for(E=1<<D-1;B&E;)E>>=1;if(E!==0?(B&=E-1,B+=E):B=0,U++,--V[D]==0){if(D===C)break;D=u[n+x[U]]}if(D>$&&(B&Xt)!==Et){for(G===0&&(G=$),dt+=M,l=D-G,E=1<<l;l+G<C&&(E-=V[l+G],!(0>=E));)l++,E<<=1;if(St+=1<<l,a===1&&852<St||a===2&&592<St)return 1;Et=B&Xt,v[Et]=$<<24|l<<16|dt-d|0}}return B!==0&&(v[dt+B]=D-G<<24|4194304),y.bits=$,0},l1=ai.Z_FINISH,eA=ai.Z_BLOCK,ut=ai.Z_TREES,Eh=ai.Z_OK,rA=ai.Z_STREAM_END,iA=ai.Z_NEED_DICT,so=ai.Z_STREAM_ERROR,fo=ai.Z_DATA_ERROR,h1=ai.Z_MEM_ERROR,c1=ai.Z_BUF_ERROR,El=ai.Z_DEFLATED,Jm=function(a){return(a>>>24&255)+(a>>>8&65280)+((a&65280)<<8)+((a&255)<<24)},f1=function(a){if(!a||!a.state)return so;var u=a.state;return a.total_in=a.total_out=u.total=0,a.msg="",u.wrap&&(a.adler=u.wrap&1),u.mode=1,u.last=0,u.havedict=0,u.dmax=32768,u.head=null,u.hold=0,u.bits=0,u.lencode=u.lendyn=new Int32Array(852),u.distcode=u.distdyn=new Int32Array(592),u.sane=1,u.back=-1,Eh},qm=function(a){if(!a||!a.state)return so;var u=a.state;return u.wsize=0,u.whave=0,u.wnext=0,f1(a)},p1=function(a,u){if(!a||!a.state)return so;var n=a.state;if(0>u){var l=0;u=-u}else l=(u>>4)+1,48>u&&(u&=15);return u&&(8>u||15<u)?so:(n.window!==null&&n.wbits!==u&&(n.window=null),n.wrap=l,n.wbits=u,qm(a))},Km=function(a,u){if(!a)return so;var n=new xf;return a.state=n,n.window=null,u=p1(a,u),u!==Eh&&(a.state=null),u},Wd=!0,$f=void 0,Qm=void 0,jd=function(a,u,n,l){var v=a.state;return v.window===null&&(v.wsize=1<<v.wbits,v.wnext=0,v.whave=0,v.window=new Uint8Array(v.wsize)),l>=v.wsize?(v.window.set(u.subarray(n-v.wsize,n),0),v.wnext=0,v.whave=v.wsize):(a=v.wsize-v.wnext,a>l&&(a=l),v.window.set(u.subarray(n-l,n-l+a),v.wnext),(l-=a)?(v.window.set(u.subarray(n-l,n),0),v.wnext=l,v.whave=v.wsize):(v.wnext+=a,v.wnext===v.wsize&&(v.wnext=0),v.whave<v.wsize&&(v.whave+=a))),0},Nu={inflateReset:qm,inflateReset2:p1,inflateResetKeep:f1,inflateInit:function(a){return Km(a,15)},inflateInit2:Km,inflate:function(a,u){var n=new Uint8Array(4),l=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!a||!a.state||!a.output||!a.input&&a.avail_in!==0)return so;var v=a.state;v.mode===12&&(v.mode=13);var d=a.next_out,x=a.output,y=a.avail_out,M=a.next_in,D=a.input,U=a.avail_in,C=v.hold,E=v.bits,B=U,O=y,H=Eh;t:for(;;)switch(v.mode){case 1:if(v.wrap===0){v.mode=13;break}for(;16>E;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}if(v.wrap&2&&C===35615){v.check=0,n[0]=C&255,n[1]=C>>>8&255,v.check=Po(v.check,n,2,0),E=C=0,v.mode=2;break}if(v.flags=0,v.head&&(v.head.done=!1),!(v.wrap&1)||(((C&255)<<8)+(C>>8))%31){a.msg="incorrect header check",v.mode=30;break}if((C&15)!==El){a.msg="unknown compression method",v.mode=30;break}C>>>=4,E-=4;var V=(C&15)+8;if(v.wbits===0)v.wbits=V;else if(V>v.wbits){a.msg="invalid window size",v.mode=30;break}v.dmax=1<<v.wbits,a.adler=v.check=1,v.mode=C&512?10:12,E=C=0;break;case 2:for(;16>E;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}if(v.flags=C,(v.flags&255)!==El){a.msg="unknown compression method",v.mode=30;break}if(v.flags&57344){a.msg="unknown header flags set",v.mode=30;break}v.head&&(v.head.text=C>>8&1),v.flags&512&&(n[0]=C&255,n[1]=C>>>8&255,v.check=Po(v.check,n,2,0)),E=C=0,v.mode=3;case 3:for(;32>E;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}v.head&&(v.head.time=C),v.flags&512&&(n[0]=C&255,n[1]=C>>>8&255,n[2]=C>>>16&255,n[3]=C>>>24&255,v.check=Po(v.check,n,4,0)),E=C=0,v.mode=4;case 4:for(;16>E;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}v.head&&(v.head.xflags=C&255,v.head.os=C>>8),v.flags&512&&(n[0]=C&255,n[1]=C>>>8&255,v.check=Po(v.check,n,2,0)),E=C=0,v.mode=5;case 5:if(v.flags&1024){for(;16>E;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}v.length=C,v.head&&(v.head.extra_len=C),v.flags&512&&(n[0]=C&255,n[1]=C>>>8&255,v.check=Po(v.check,n,2,0)),E=C=0}else v.head&&(v.head.extra=null);v.mode=6;case 6:if(v.flags&1024){var G=v.length;if(G>U&&(G=U),G&&(v.head&&(V=v.head.extra_len-v.length,v.head.extra||(v.head.extra=new Uint8Array(v.head.extra_len)),v.head.extra.set(D.subarray(M,M+G),V)),v.flags&512&&(v.check=Po(v.check,D,G,M)),U-=G,M+=G,v.length-=G),v.length)break t}v.length=0,v.mode=7;case 7:if(v.flags&2048){if(U===0)break t;G=0;do V=D[M+G++],v.head&&V&&65536>v.length&&(v.head.name+=String.fromCharCode(V));while(V&&G<U);if(v.flags&512&&(v.check=Po(v.check,D,G,M)),U-=G,M+=G,V)break t}else v.head&&(v.head.name=null);v.length=0,v.mode=8;case 8:if(v.flags&4096){if(U===0)break t;G=0;do V=D[M+G++],v.head&&V&&65536>v.length&&(v.head.comment+=String.fromCharCode(V));while(V&&G<U);if(v.flags&512&&(v.check=Po(v.check,D,G,M)),U-=G,M+=G,V)break t}else v.head&&(v.head.comment=null);v.mode=9;case 9:if(v.flags&512){for(;16>E;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}if(C!==(v.check&65535)){a.msg="header crc mismatch",v.mode=30;break}E=C=0}v.head&&(v.head.hcrc=v.flags>>9&1,v.head.done=!0),a.adler=v.check=0,v.mode=12;break;case 10:for(;32>E;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}a.adler=v.check=Jm(C),E=C=0,v.mode=11;case 11:if(v.havedict===0)return a.next_out=d,a.avail_out=y,a.next_in=M,a.avail_in=U,v.hold=C,v.bits=E,iA;a.adler=v.check=1,v.mode=12;case 12:if(u===eA||u===ut)break t;case 13:if(v.last){C>>>=E&7,E-=E&7,v.mode=27;break}for(;3>E;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}switch(v.last=C&1,C>>>=1,--E,C&3){case 0:v.mode=14;break;case 1:if(G=v,Wd){for($f=new Int32Array(512),Qm=new Int32Array(32),V=0;144>V;)G.lens[V++]=8;for(;256>V;)G.lens[V++]=9;for(;280>V;)G.lens[V++]=7;for(;288>V;)G.lens[V++]=8;for(Lc(1,G.lens,0,288,$f,0,G.work,{bits:9}),V=0;32>V;)G.lens[V++]=5;Lc(2,G.lens,0,32,Qm,0,G.work,{bits:5}),Wd=!1}if(G.lencode=$f,G.lenbits=9,G.distcode=Qm,G.distbits=5,v.mode=20,u===ut){C>>>=2,E-=2;break t}break;case 2:v.mode=17;break;case 3:a.msg="invalid block type",v.mode=30}C>>>=2,E-=2;break;case 14:for(C>>>=E&7,E-=E&7;32>E;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}if((C&65535)!=(C>>>16^65535)){a.msg="invalid stored block lengths",v.mode=30;break}if(v.length=C&65535,E=C=0,v.mode=15,u===ut)break t;case 15:v.mode=16;case 16:if(G=v.length){if(G>U&&(G=U),G>y&&(G=y),G===0)break t;x.set(D.subarray(M,M+G),d),U-=G,M+=G,y-=G,d+=G,v.length-=G;break}v.mode=12;break;case 17:for(;14>E;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}if(v.nlen=(C&31)+257,C>>>=5,E-=5,v.ndist=(C&31)+1,C>>>=5,E-=5,v.ncode=(C&15)+4,C>>>=4,E-=4,286<v.nlen||30<v.ndist){a.msg="too many length or distance symbols",v.mode=30;break}v.have=0,v.mode=18;case 18:for(;v.have<v.ncode;){for(;3>E;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}v.lens[l[v.have++]]=C&7,C>>>=3,E-=3}for(;19>v.have;)v.lens[l[v.have++]]=0;if(v.lencode=v.lendyn,v.lenbits=7,G={bits:v.lenbits},H=Lc(0,v.lens,0,19,v.lencode,0,v.work,G),v.lenbits=G.bits,H){a.msg="invalid code lengths set",v.mode=30;break}v.have=0,v.mode=19;case 19:for(;v.have<v.nlen+v.ndist;){for(;;){var j=v.lencode[C&(1<<v.lenbits)-1];if(G=j>>>24,j&=65535,G<=E)break;if(U===0)break t;U--,C+=D[M++]<<E,E+=8}if(16>j)C>>>=G,E-=G,v.lens[v.have++]=j;else{if(j===16){for(V=G+2;E<V;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}if(C>>>=G,E-=G,v.have===0){a.msg="invalid bit length repeat",v.mode=30;break}V=v.lens[v.have-1],G=3+(C&3),C>>>=2,E-=2}else if(j===17){for(V=G+3;E<V;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}C>>>=G,E-=G,V=0,G=3+(C&7),C>>>=3,E-=3}else{for(V=G+7;E<V;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}C>>>=G,E-=G,V=0,G=11+(C&127),C>>>=7,E-=7}if(v.have+G>v.nlen+v.ndist){a.msg="invalid bit length repeat",v.mode=30;break}for(;G--;)v.lens[v.have++]=V}}if(v.mode===30)break;if(v.lens[256]===0){a.msg="invalid code -- missing end-of-block",v.mode=30;break}if(v.lenbits=9,G={bits:v.lenbits},H=Lc(1,v.lens,0,v.nlen,v.lencode,0,v.work,G),v.lenbits=G.bits,H){a.msg="invalid literal/lengths set",v.mode=30;break}if(v.distbits=6,v.distcode=v.distdyn,G={bits:v.distbits},H=Lc(2,v.lens,v.nlen,v.ndist,v.distcode,0,v.work,G),v.distbits=G.bits,H){a.msg="invalid distances set",v.mode=30;break}if(v.mode=20,u===ut)break t;case 20:v.mode=21;case 21:if(6<=U&&258<=y){a.next_out=d,a.avail_out=y,a.next_in=M,a.avail_in=U,v.hold=C,v.bits=E,D=a;var Y=D.state;x=D.next_in;var $=D.input;M=x+(D.avail_in-5),d=D.next_out;var it=D.output;U=d-(O-D.avail_out),y=d+(D.avail_out-257),C=Y.dmax,E=Y.wsize,G=Y.whave,V=Y.wnext;var nt=Y.window,dt=Y.hold,Et=Y.bits;j=Y.lencode;var St=Y.distcode,Xt=(1<<Y.lenbits)-1,te=(1<<Y.distbits)-1;e:do{15>Et&&(dt+=$[x++]<<Et,Et+=8,dt+=$[x++]<<Et,Et+=8);var Ie=j[dt&Xt];r:for(;;){var pe=Ie>>>24;if(dt>>>=pe,Et-=pe,pe=Ie>>>16&255,pe===0)it[d++]=Ie&65535;else if(pe&16){var be=Ie&65535;(pe&=15)&&(Et<pe&&(dt+=$[x++]<<Et,Et+=8),be+=dt&(1<<pe)-1,dt>>>=pe,Et-=pe),15>Et&&(dt+=$[x++]<<Et,Et+=8,dt+=$[x++]<<Et,Et+=8),Ie=St[dt&te];i:for(;;){if(pe=Ie>>>24,dt>>>=pe,Et-=pe,pe=Ie>>>16&255,pe&16){if(Ie&=65535,pe&=15,Et<pe&&(dt+=$[x++]<<Et,Et+=8,Et<pe&&(dt+=$[x++]<<Et,Et+=8)),Ie+=dt&(1<<pe)-1,Ie>C){D.msg="invalid distance too far back",Y.mode=30;break e}if(dt>>>=pe,Et-=pe,pe=d-U,Ie>pe){if(pe=Ie-pe,pe>G&&Y.sane){D.msg="invalid distance too far back",Y.mode=30;break e}var yr=0,oe=nt;if(V===0){if(yr+=E-pe,pe<be){be-=pe;do it[d++]=nt[yr++];while(--pe);yr=d-Ie,oe=it}}else if(V<pe){if(yr+=E+V-pe,pe-=V,pe<be){be-=pe;do it[d++]=nt[yr++];while(--pe);if(yr=0,V<be){pe=V,be-=pe;do it[d++]=nt[yr++];while(--pe);yr=d-Ie,oe=it}}}else if(yr+=V-pe,pe<be){be-=pe;do it[d++]=nt[yr++];while(--pe);yr=d-Ie,oe=it}for(;2<be;)it[d++]=oe[yr++],it[d++]=oe[yr++],it[d++]=oe[yr++],be-=3;be&&(it[d++]=oe[yr++],1<be&&(it[d++]=oe[yr++]))}else{yr=d-Ie;do it[d++]=it[yr++],it[d++]=it[yr++],it[d++]=it[yr++],be-=3;while(2<be);be&&(it[d++]=it[yr++],1<be&&(it[d++]=it[yr++]))}}else if((pe&64)==0){Ie=St[(Ie&65535)+(dt&(1<<pe)-1)];continue i}else{D.msg="invalid distance code",Y.mode=30;break e}break}}else if((pe&64)==0){Ie=j[(Ie&65535)+(dt&(1<<pe)-1)];continue r}else{pe&32?Y.mode=12:(D.msg="invalid literal/length code",Y.mode=30);break e}break}}while(x<M&&d<y);be=Et>>3,x-=be,Et-=be<<3,D.next_in=x,D.next_out=d,D.avail_in=x<M?5+(M-x):5-(x-M),D.avail_out=d<y?257+(y-d):257-(d-y),Y.hold=dt&(1<<Et)-1,Y.bits=Et,d=a.next_out,x=a.output,y=a.avail_out,M=a.next_in,D=a.input,U=a.avail_in,C=v.hold,E=v.bits,v.mode===12&&(v.back=-1);break}for(v.back=0;j=v.lencode[C&(1<<v.lenbits)-1],G=j>>>24,V=j>>>16&255,j&=65535,!(G<=E);){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}if(V&&(V&240)==0){for(nt=G,dt=V,Et=j;j=v.lencode[Et+((C&(1<<nt+dt)-1)>>nt)],G=j>>>24,V=j>>>16&255,j&=65535,!(nt+G<=E);){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}C>>>=nt,E-=nt,v.back+=nt}if(C>>>=G,E-=G,v.back+=G,v.length=j,V===0){v.mode=26;break}if(V&32){v.back=-1,v.mode=12;break}if(V&64){a.msg="invalid literal/length code",v.mode=30;break}v.extra=V&15,v.mode=22;case 22:if(v.extra){for(V=v.extra;E<V;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}v.length+=C&(1<<v.extra)-1,C>>>=v.extra,E-=v.extra,v.back+=v.extra}v.was=v.length,v.mode=23;case 23:for(;j=v.distcode[C&(1<<v.distbits)-1],G=j>>>24,V=j>>>16&255,j&=65535,!(G<=E);){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}if((V&240)==0){for(nt=G,dt=V,Et=j;j=v.distcode[Et+((C&(1<<nt+dt)-1)>>nt)],G=j>>>24,V=j>>>16&255,j&=65535,!(nt+G<=E);){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}C>>>=nt,E-=nt,v.back+=nt}if(C>>>=G,E-=G,v.back+=G,V&64){a.msg="invalid distance code",v.mode=30;break}v.offset=j,v.extra=V&15,v.mode=24;case 24:if(v.extra){for(V=v.extra;E<V;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}v.offset+=C&(1<<v.extra)-1,C>>>=v.extra,E-=v.extra,v.back+=v.extra}if(v.offset>v.dmax){a.msg="invalid distance too far back",v.mode=30;break}v.mode=25;case 25:if(y===0)break t;if(G=O-y,v.offset>G){if(G=v.offset-G,G>v.whave&&v.sane){a.msg="invalid distance too far back",v.mode=30;break}G>v.wnext?(G-=v.wnext,V=v.wsize-G):V=v.wnext-G,G>v.length&&(G=v.length),nt=v.window}else nt=x,V=d-v.offset,G=v.length;G>y&&(G=y),y-=G,v.length-=G;do x[d++]=nt[V++];while(--G);v.length===0&&(v.mode=21);break;case 26:if(y===0)break t;x[d++]=v.length,y--,v.mode=21;break;case 27:if(v.wrap){for(;32>E;){if(U===0)break t;U--,C|=D[M++]<<E,E+=8}if(O-=y,a.total_out+=O,v.total+=O,O&&(a.adler=v.check=v.flags?Po(v.check,x,O,d-O):Vn(v.check,x,O,d-O)),O=y,(v.flags?C:Jm(C))!==v.check){a.msg="incorrect data check",v.mode=30;break}E=C=0}v.mode=28;case 28:if(v.wrap&&v.flags){for(;32>E;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}if(C!==(v.total&4294967295)){a.msg="incorrect length check",v.mode=30;break}E=C=0}v.mode=29;case 29:H=rA;break t;case 30:H=fo;break t;case 31:return h1;default:return so}return a.next_out=d,a.avail_out=y,a.next_in=M,a.avail_in=U,v.hold=C,v.bits=E,(v.wsize||O!==a.avail_out&&30>v.mode&&(27>v.mode||u!==l1))&&jd(a,a.output,a.next_out,O-a.avail_out),B-=a.avail_in,O-=a.avail_out,a.total_in+=B,a.total_out+=O,v.total+=O,v.wrap&&O&&(a.adler=v.check=v.flags?Po(v.check,x,O,a.next_out-O):Vn(v.check,x,O,a.next_out-O)),a.data_type=v.bits+(v.last?64:0)+(v.mode===12?128:0)+(v.mode===20||v.mode===15?256:0),(B===0&&O===0||u===l1)&&H===Eh&&(H=c1),H},inflateEnd:function(a){if(!a||!a.state)return so;var u=a.state;return u.window&&(u.window=null),a.state=null,Eh},inflateGetHeader:function(a,u){return!a||!a.state||(a=a.state,(a.wrap&2)==0)?so:(a.head=u,u.done=!1,Eh)},inflateSetDictionary:function(a,u){var n=u.length;if(!a||!a.state)return so;var l=a.state;if(l.wrap!==0&&l.mode!==11)return so;if(l.mode===11){var v=Vn(1,u,n,0);if(v!==l.check)return fo}return jd(a,u,n,n)?(l.mode=31,h1):(l.havedict=1,Eh)},inflateInfo:"pako inflate (from Nodeca project)"},d1=function(){this.os=this.xflags=this.time=this.text=0,this.extra=null,this.extra_len=0,this.comment=this.name="",this.hcrc=0,this.done=!1},$m=Object.prototype.toString,g1=ai.Z_NO_FLUSH,nA=ai.Z_FINISH,tp=ai.Z_OK,Rc=ai.Z_STREAM_END,tv=ai.Z_NEED_DICT,ev=ai.Z_STREAM_ERROR,Xd=ai.Z_DATA_ERROR,m1=ai.Z_MEM_ERROR;Ta.prototype.push=function(a,u){var n=this.strm,l=this.options.chunkSize,v=this.options.dictionary;if(this.ended)return!1;var d=u===~~u?u:u===!0?nA:g1;for($m.call(a)==="[object ArrayBuffer]"?n.input=new Uint8Array(a):n.input=a,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(l),n.next_out=0,n.avail_out=l),u=Nu.inflate(n,d),u===tv&&v&&(u=Nu.inflateSetDictionary(n,v),u===tp?u=Nu.inflate(n,d):u===Xd&&(u=tv));0<n.avail_in&&u===Rc&&0<n.state.wrap&&a[n.next_in]!==0;)Nu.inflateReset(n),u=Nu.inflate(n,d);switch(u){case ev:case Xd:case tv:case m1:return this.onEnd(u),this.ended=!0,!1}var x=n.avail_out;if(n.next_out&&(n.avail_out===0||u===Rc))if(this.options.to==="string"){var y=Sl.utf8border(n.output,n.next_out),M=n.next_out-y,D=Sl.buf2string(n.output,y);n.next_out=M,n.avail_out=l-M,M&&n.output.set(n.output.subarray(y,y+M),0),this.onData(D)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(u!==tp||x!==0){if(u===Rc){u=Nu.inflateEnd(this.strm),this.onEnd(u),this.ended=!0;break}if(n.avail_in===0)break}}return!0},Ta.prototype.onData=function(a){this.chunks.push(a)},Ta.prototype.onEnd=function(a){a===tp&&(this.result=this.options.to==="string"?this.chunks.join(""):Ec.flattenChunks(this.chunks)),this.chunks=[],this.err=a,this.msg=this.strm.msg};var rv={Deflate:wu,deflate:ih,deflateRaw:function(a,u){return u=u||{},u.raw=!0,ih(a,u)},gzip:function(a,u){return u=u||{},u.gzip=!0,ih(a,u)},Inflate:Ta,inflate:sl,inflateRaw:function(a,u){return u=u||{},u.raw=!0,sl(a,u)},ungzip:sl,constants:ai},za=Rt(function(a,u){Object.defineProperty(u,"__esModule",{value:!0}),u.setMatrixArrayType=function(d){u.ARRAY_TYPE=l=d},u.toRadian=function(d){return d*v},u.equals=function(d,x){return Math.abs(d-x)<=n*Math.max(1,Math.abs(d),Math.abs(x))},u.RANDOM=u.ARRAY_TYPE=u.EPSILON=void 0;var n=1e-6;u.EPSILON=n;var l=typeof Float32Array!="undefined"?Float32Array:Array;u.ARRAY_TYPE=l,u.RANDOM=Math.random;var v=Math.PI/180});Nt(za);var Pc=Rt(function(a,u){function n(d,x,y){var M=x[0],D=x[1],U=x[2];x=x[3];var C=y[0],E=y[1],B=y[2];return y=y[3],d[0]=M*C+U*E,d[1]=D*C+x*E,d[2]=M*B+U*y,d[3]=D*B+x*y,d}function l(d,x,y){return d[0]=x[0]-y[0],d[1]=x[1]-y[1],d[2]=x[2]-y[2],d[3]=x[3]-y[3],d}Object.defineProperty(u,"__esModule",{value:!0}),u.create=function(){var d=new v.ARRAY_TYPE(4);return v.ARRAY_TYPE!=Float32Array&&(d[1]=0,d[2]=0),d[0]=1,d[3]=1,d},u.clone=function(d){var x=new v.ARRAY_TYPE(4);return x[0]=d[0],x[1]=d[1],x[2]=d[2],x[3]=d[3],x},u.copy=function(d,x){return d[0]=x[0],d[1]=x[1],d[2]=x[2],d[3]=x[3],d},u.identity=function(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=1,d},u.fromValues=function(d,x,y,M){var D=new v.ARRAY_TYPE(4);return D[0]=d,D[1]=x,D[2]=y,D[3]=M,D},u.set=function(d,x,y,M,D){return d[0]=x,d[1]=y,d[2]=M,d[3]=D,d},u.transpose=function(d,x){if(d===x){var y=x[1];d[1]=x[2],d[2]=y}else d[0]=x[0],d[1]=x[2],d[2]=x[1],d[3]=x[3];return d},u.invert=function(d,x){var y=x[0],M=x[1],D=x[2];x=x[3];var U=y*x-D*M;return U?(U=1/U,d[0]=x*U,d[1]=-M*U,d[2]=-D*U,d[3]=y*U,d):null},u.adjoint=function(d,x){var y=x[0];return d[0]=x[3],d[1]=-x[1],d[2]=-x[2],d[3]=y,d},u.determinant=function(d){return d[0]*d[3]-d[2]*d[1]},u.multiply=n,u.rotate=function(d,x,y){var M=x[0],D=x[1],U=x[2];x=x[3];var C=Math.sin(y);return y=Math.cos(y),d[0]=M*y+U*C,d[1]=D*y+x*C,d[2]=M*-C+U*y,d[3]=D*-C+x*y,d},u.scale=function(d,x,y){var M=x[1],D=x[2],U=x[3],C=y[0];return y=y[1],d[0]=x[0]*C,d[1]=M*C,d[2]=D*y,d[3]=U*y,d},u.fromRotation=function(d,x){var y=Math.sin(x);return x=Math.cos(x),d[0]=x,d[1]=y,d[2]=-y,d[3]=x,d},u.fromScaling=function(d,x){return d[0]=x[0],d[1]=0,d[2]=0,d[3]=x[1],d},u.str=function(d){return"mat2("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+")"},u.frob=function(d){return Math.sqrt(Math.pow(d[0],2)+Math.pow(d[1],2)+Math.pow(d[2],2)+Math.pow(d[3],2))},u.LDU=function(d,x,y,M){return d[2]=M[2]/M[0],y[0]=M[0],y[1]=M[1],y[3]=M[3]-d[2]*y[1],[d,x,y]},u.add=function(d,x,y){return d[0]=x[0]+y[0],d[1]=x[1]+y[1],d[2]=x[2]+y[2],d[3]=x[3]+y[3],d},u.subtract=l,u.exactEquals=function(d,x){return d[0]===x[0]&&d[1]===x[1]&&d[2]===x[2]&&d[3]===x[3]},u.equals=function(d,x){var y=d[0],M=d[1],D=d[2];d=d[3];var U=x[0],C=x[1],E=x[2];return x=x[3],Math.abs(y-U)<=v.EPSILON*Math.max(1,Math.abs(y),Math.abs(U))&&Math.abs(M-C)<=v.EPSILON*Math.max(1,Math.abs(M),Math.abs(C))&&Math.abs(D-E)<=v.EPSILON*Math.max(1,Math.abs(D),Math.abs(E))&&Math.abs(d-x)<=v.EPSILON*Math.max(1,Math.abs(d),Math.abs(x))},u.multiplyScalar=function(d,x,y){return d[0]=x[0]*y,d[1]=x[1]*y,d[2]=x[2]*y,d[3]=x[3]*y,d},u.multiplyScalarAndAdd=function(d,x,y,M){return d[0]=x[0]+y[0]*M,d[1]=x[1]+y[1]*M,d[2]=x[2]+y[2]*M,d[3]=x[3]+y[3]*M,d},u.sub=u.mul=void 0;var v=function(d){if(d&&d.__esModule)return d;var x={};if(d!=null){for(var y in d)if(Object.prototype.hasOwnProperty.call(d,y)){var M=Hn&&Gn?Gn(d,y):{};M.get||M.set?Hn(x,y,M):x[y]=d[y]}}return x.default=d,x}(za);u.mul=n,u.sub=l});Nt(Pc);var ep=Rt(function(a,u){function n(d,x,y){var M=x[0],D=x[1],U=x[2],C=x[3],E=x[4];x=x[5];var B=y[0],O=y[1],H=y[2],V=y[3],G=y[4];return y=y[5],d[0]=M*B+U*O,d[1]=D*B+C*O,d[2]=M*H+U*V,d[3]=D*H+C*V,d[4]=M*G+U*y+E,d[5]=D*G+C*y+x,d}function l(d,x,y){return d[0]=x[0]-y[0],d[1]=x[1]-y[1],d[2]=x[2]-y[2],d[3]=x[3]-y[3],d[4]=x[4]-y[4],d[5]=x[5]-y[5],d}Object.defineProperty(u,"__esModule",{value:!0}),u.create=function(){var d=new v.ARRAY_TYPE(6);return v.ARRAY_TYPE!=Float32Array&&(d[1]=0,d[2]=0,d[4]=0,d[5]=0),d[0]=1,d[3]=1,d},u.clone=function(d){var x=new v.ARRAY_TYPE(6);return x[0]=d[0],x[1]=d[1],x[2]=d[2],x[3]=d[3],x[4]=d[4],x[5]=d[5],x},u.copy=function(d,x){return d[0]=x[0],d[1]=x[1],d[2]=x[2],d[3]=x[3],d[4]=x[4],d[5]=x[5],d},u.identity=function(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=1,d[4]=0,d[5]=0,d},u.fromValues=function(d,x,y,M,D,U){var C=new v.ARRAY_TYPE(6);return C[0]=d,C[1]=x,C[2]=y,C[3]=M,C[4]=D,C[5]=U,C},u.set=function(d,x,y,M,D,U,C){return d[0]=x,d[1]=y,d[2]=M,d[3]=D,d[4]=U,d[5]=C,d},u.invert=function(d,x){var y=x[0],M=x[1],D=x[2],U=x[3],C=x[4];x=x[5];var E=y*U-M*D;return E?(E=1/E,d[0]=U*E,d[1]=-M*E,d[2]=-D*E,d[3]=y*E,d[4]=(D*x-U*C)*E,d[5]=(M*C-y*x)*E,d):null},u.determinant=function(d){return d[0]*d[3]-d[1]*d[2]},u.multiply=n,u.rotate=function(d,x,y){var M=x[0],D=x[1],U=x[2],C=x[3],E=x[4];x=x[5];var B=Math.sin(y);return y=Math.cos(y),d[0]=M*y+U*B,d[1]=D*y+C*B,d[2]=M*-B+U*y,d[3]=D*-B+C*y,d[4]=E,d[5]=x,d},u.scale=function(d,x,y){var M=x[1],D=x[2],U=x[3],C=x[4],E=x[5],B=y[0];return y=y[1],d[0]=x[0]*B,d[1]=M*B,d[2]=D*y,d[3]=U*y,d[4]=C,d[5]=E,d},u.translate=function(d,x,y){var M=x[0],D=x[1],U=x[2],C=x[3],E=x[4];x=x[5];var B=y[0];return y=y[1],d[0]=M,d[1]=D,d[2]=U,d[3]=C,d[4]=M*B+U*y+E,d[5]=D*B+C*y+x,d},u.fromRotation=function(d,x){var y=Math.sin(x);return x=Math.cos(x),d[0]=x,d[1]=y,d[2]=-y,d[3]=x,d[4]=0,d[5]=0,d},u.fromScaling=function(d,x){return d[0]=x[0],d[1]=0,d[2]=0,d[3]=x[1],d[4]=0,d[5]=0,d},u.fromTranslation=function(d,x){return d[0]=1,d[1]=0,d[2]=0,d[3]=1,d[4]=x[0],d[5]=x[1],d},u.str=function(d){return"mat2d("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+", "+d[4]+", "+d[5]+")"},u.frob=function(d){return Math.sqrt(Math.pow(d[0],2)+Math.pow(d[1],2)+Math.pow(d[2],2)+Math.pow(d[3],2)+Math.pow(d[4],2)+Math.pow(d[5],2)+1)},u.add=function(d,x,y){return d[0]=x[0]+y[0],d[1]=x[1]+y[1],d[2]=x[2]+y[2],d[3]=x[3]+y[3],d[4]=x[4]+y[4],d[5]=x[5]+y[5],d},u.subtract=l,u.multiplyScalar=function(d,x,y){return d[0]=x[0]*y,d[1]=x[1]*y,d[2]=x[2]*y,d[3]=x[3]*y,d[4]=x[4]*y,d[5]=x[5]*y,d},u.multiplyScalarAndAdd=function(d,x,y,M){return d[0]=x[0]+y[0]*M,d[1]=x[1]+y[1]*M,d[2]=x[2]+y[2]*M,d[3]=x[3]+y[3]*M,d[4]=x[4]+y[4]*M,d[5]=x[5]+y[5]*M,d},u.exactEquals=function(d,x){return d[0]===x[0]&&d[1]===x[1]&&d[2]===x[2]&&d[3]===x[3]&&d[4]===x[4]&&d[5]===x[5]},u.equals=function(d,x){var y=d[0],M=d[1],D=d[2],U=d[3],C=d[4];d=d[5];var E=x[0],B=x[1],O=x[2],H=x[3],V=x[4];return x=x[5],Math.abs(y-E)<=v.EPSILON*Math.max(1,Math.abs(y),Math.abs(E))&&Math.abs(M-B)<=v.EPSILON*Math.max(1,Math.abs(M),Math.abs(B))&&Math.abs(D-O)<=v.EPSILON*Math.max(1,Math.abs(D),Math.abs(O))&&Math.abs(U-H)<=v.EPSILON*Math.max(1,Math.abs(U),Math.abs(H))&&Math.abs(C-V)<=v.EPSILON*Math.max(1,Math.abs(C),Math.abs(V))&&Math.abs(d-x)<=v.EPSILON*Math.max(1,Math.abs(d),Math.abs(x))},u.sub=u.mul=void 0;var v=function(d){if(d&&d.__esModule)return d;var x={};if(d!=null){for(var y in d)if(Object.prototype.hasOwnProperty.call(d,y)){var M=Hn&&Gn?Gn(d,y):{};M.get||M.set?Hn(x,y,M):x[y]=d[y]}}return x.default=d,x}(za);u.mul=n,u.sub=l});Nt(ep);var lu=Rt(function(a,u){function n(d,x,y){var M=x[0],D=x[1],U=x[2],C=x[3],E=x[4],B=x[5],O=x[6],H=x[7];x=x[8];var V=y[0],G=y[1],j=y[2],Y=y[3],$=y[4],it=y[5],nt=y[6],dt=y[7];return y=y[8],d[0]=V*M+G*C+j*O,d[1]=V*D+G*E+j*H,d[2]=V*U+G*B+j*x,d[3]=Y*M+$*C+it*O,d[4]=Y*D+$*E+it*H,d[5]=Y*U+$*B+it*x,d[6]=nt*M+dt*C+y*O,d[7]=nt*D+dt*E+y*H,d[8]=nt*U+dt*B+y*x,d}function l(d,x,y){return d[0]=x[0]-y[0],d[1]=x[1]-y[1],d[2]=x[2]-y[2],d[3]=x[3]-y[3],d[4]=x[4]-y[4],d[5]=x[5]-y[5],d[6]=x[6]-y[6],d[7]=x[7]-y[7],d[8]=x[8]-y[8],d}Object.defineProperty(u,"__esModule",{value:!0}),u.create=function(){var d=new v.ARRAY_TYPE(9);return v.ARRAY_TYPE!=Float32Array&&(d[1]=0,d[2]=0,d[3]=0,d[5]=0,d[6]=0,d[7]=0),d[0]=1,d[4]=1,d[8]=1,d},u.fromMat4=function(d,x){return d[0]=x[0],d[1]=x[1],d[2]=x[2],d[3]=x[4],d[4]=x[5],d[5]=x[6],d[6]=x[8],d[7]=x[9],d[8]=x[10],d},u.clone=function(d){var x=new v.ARRAY_TYPE(9);return x[0]=d[0],x[1]=d[1],x[2]=d[2],x[3]=d[3],x[4]=d[4],x[5]=d[5],x[6]=d[6],x[7]=d[7],x[8]=d[8],x},u.copy=function(d,x){return d[0]=x[0],d[1]=x[1],d[2]=x[2],d[3]=x[3],d[4]=x[4],d[5]=x[5],d[6]=x[6],d[7]=x[7],d[8]=x[8],d},u.fromValues=function(d,x,y,M,D,U,C,E,B){var O=new v.ARRAY_TYPE(9);return O[0]=d,O[1]=x,O[2]=y,O[3]=M,O[4]=D,O[5]=U,O[6]=C,O[7]=E,O[8]=B,O},u.set=function(d,x,y,M,D,U,C,E,B,O){return d[0]=x,d[1]=y,d[2]=M,d[3]=D,d[4]=U,d[5]=C,d[6]=E,d[7]=B,d[8]=O,d},u.identity=function(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=1,d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},u.transpose=function(d,x){if(d===x){var y=x[1],M=x[2],D=x[5];d[1]=x[3],d[2]=x[6],d[3]=y,d[5]=x[7],d[6]=M,d[7]=D}else d[0]=x[0],d[1]=x[3],d[2]=x[6],d[3]=x[1],d[4]=x[4],d[5]=x[7],d[6]=x[2],d[7]=x[5],d[8]=x[8];return d},u.invert=function(d,x){var y=x[0],M=x[1],D=x[2],U=x[3],C=x[4],E=x[5],B=x[6],O=x[7];x=x[8];var H=x*C-E*O,V=-x*U+E*B,G=O*U-C*B,j=y*H+M*V+D*G;return j?(j=1/j,d[0]=H*j,d[1]=(-x*M+D*O)*j,d[2]=(E*M-D*C)*j,d[3]=V*j,d[4]=(x*y-D*B)*j,d[5]=(-E*y+D*U)*j,d[6]=G*j,d[7]=(-O*y+M*B)*j,d[8]=(C*y-M*U)*j,d):null},u.adjoint=function(d,x){var y=x[0],M=x[1],D=x[2],U=x[3],C=x[4],E=x[5],B=x[6],O=x[7];return x=x[8],d[0]=C*x-E*O,d[1]=D*O-M*x,d[2]=M*E-D*C,d[3]=E*B-U*x,d[4]=y*x-D*B,d[5]=D*U-y*E,d[6]=U*O-C*B,d[7]=M*B-y*O,d[8]=y*C-M*U,d},u.determinant=function(d){var x=d[3],y=d[4],M=d[5],D=d[6],U=d[7],C=d[8];return d[0]*(C*y-M*U)+d[1]*(-C*x+M*D)+d[2]*(U*x-y*D)},u.multiply=n,u.translate=function(d,x,y){var M=x[0],D=x[1],U=x[2],C=x[3],E=x[4],B=x[5],O=x[6],H=x[7];x=x[8];var V=y[0];return y=y[1],d[0]=M,d[1]=D,d[2]=U,d[3]=C,d[4]=E,d[5]=B,d[6]=V*M+y*C+O,d[7]=V*D+y*E+H,d[8]=V*U+y*B+x,d},u.rotate=function(d,x,y){var M=x[0],D=x[1],U=x[2],C=x[3],E=x[4],B=x[5],O=x[6],H=x[7];x=x[8];var V=Math.sin(y);return y=Math.cos(y),d[0]=y*M+V*C,d[1]=y*D+V*E,d[2]=y*U+V*B,d[3]=y*C-V*M,d[4]=y*E-V*D,d[5]=y*B-V*U,d[6]=O,d[7]=H,d[8]=x,d},u.scale=function(d,x,y){var M=y[0];return y=y[1],d[0]=M*x[0],d[1]=M*x[1],d[2]=M*x[2],d[3]=y*x[3],d[4]=y*x[4],d[5]=y*x[5],d[6]=x[6],d[7]=x[7],d[8]=x[8],d},u.fromTranslation=function(d,x){return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=1,d[5]=0,d[6]=x[0],d[7]=x[1],d[8]=1,d},u.fromRotation=function(d,x){var y=Math.sin(x);return x=Math.cos(x),d[0]=x,d[1]=y,d[2]=0,d[3]=-y,d[4]=x,d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},u.fromScaling=function(d,x){return d[0]=x[0],d[1]=0,d[2]=0,d[3]=0,d[4]=x[1],d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},u.fromMat2d=function(d,x){return d[0]=x[0],d[1]=x[1],d[2]=0,d[3]=x[2],d[4]=x[3],d[5]=0,d[6]=x[4],d[7]=x[5],d[8]=1,d},u.fromQuat=function(d,x){var y=x[0],M=x[1],D=x[2];x=x[3];var U=y+y,C=M+M,E=D+D;y*=U;var B=M*U;M*=C;var O=D*U,H=D*C;return D*=E,U*=x,C*=x,x*=E,d[0]=1-M-D,d[3]=B-x,d[6]=O+C,d[1]=B+x,d[4]=1-y-D,d[7]=H-U,d[2]=O-C,d[5]=H+U,d[8]=1-y-M,d},u.normalFromMat4=function(d,x){var y=x[0],M=x[1],D=x[2],U=x[3],C=x[4],E=x[5],B=x[6],O=x[7],H=x[8],V=x[9],G=x[10],j=x[11],Y=x[12],$=x[13],it=x[14];x=x[15];var nt=y*E-M*C,dt=y*B-D*C,Et=y*O-U*C,St=M*B-D*E,Xt=M*O-U*E,te=D*O-U*B,Ie=H*$-V*Y,pe=H*it-G*Y;H=H*x-j*Y;var be=V*it-G*$;return V=V*x-j*$,G=G*x-j*it,j=nt*G-dt*V+Et*be+St*H-Xt*pe+te*Ie,j?(j=1/j,d[0]=(E*G-B*V+O*be)*j,d[1]=(B*H-C*G-O*pe)*j,d[2]=(C*V-E*H+O*Ie)*j,d[3]=(D*V-M*G-U*be)*j,d[4]=(y*G-D*H+U*pe)*j,d[5]=(M*H-y*V-U*Ie)*j,d[6]=($*te-it*Xt+x*St)*j,d[7]=(it*Et-Y*te-x*dt)*j,d[8]=(Y*Xt-$*Et+x*nt)*j,d):null},u.projection=function(d,x,y){return d[0]=2/x,d[1]=0,d[2]=0,d[3]=0,d[4]=-2/y,d[5]=0,d[6]=-1,d[7]=1,d[8]=1,d},u.str=function(d){return"mat3("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+", "+d[4]+", "+d[5]+", "+d[6]+", "+d[7]+", "+d[8]+")"},u.frob=function(d){return Math.sqrt(Math.pow(d[0],2)+Math.pow(d[1],2)+Math.pow(d[2],2)+Math.pow(d[3],2)+Math.pow(d[4],2)+Math.pow(d[5],2)+Math.pow(d[6],2)+Math.pow(d[7],2)+Math.pow(d[8],2))},u.add=function(d,x,y){return d[0]=x[0]+y[0],d[1]=x[1]+y[1],d[2]=x[2]+y[2],d[3]=x[3]+y[3],d[4]=x[4]+y[4],d[5]=x[5]+y[5],d[6]=x[6]+y[6],d[7]=x[7]+y[7],d[8]=x[8]+y[8],d},u.subtract=l,u.multiplyScalar=function(d,x,y){return d[0]=x[0]*y,d[1]=x[1]*y,d[2]=x[2]*y,d[3]=x[3]*y,d[4]=x[4]*y,d[5]=x[5]*y,d[6]=x[6]*y,d[7]=x[7]*y,d[8]=x[8]*y,d},u.multiplyScalarAndAdd=function(d,x,y,M){return d[0]=x[0]+y[0]*M,d[1]=x[1]+y[1]*M,d[2]=x[2]+y[2]*M,d[3]=x[3]+y[3]*M,d[4]=x[4]+y[4]*M,d[5]=x[5]+y[5]*M,d[6]=x[6]+y[6]*M,d[7]=x[7]+y[7]*M,d[8]=x[8]+y[8]*M,d},u.exactEquals=function(d,x){return d[0]===x[0]&&d[1]===x[1]&&d[2]===x[2]&&d[3]===x[3]&&d[4]===x[4]&&d[5]===x[5]&&d[6]===x[6]&&d[7]===x[7]&&d[8]===x[8]},u.equals=function(d,x){var y=d[0],M=d[1],D=d[2],U=d[3],C=d[4],E=d[5],B=d[6],O=d[7];d=d[8];var H=x[0],V=x[1],G=x[2],j=x[3],Y=x[4],$=x[5],it=x[6],nt=x[7];return x=x[8],Math.abs(y-H)<=v.EPSILON*Math.max(1,Math.abs(y),Math.abs(H))&&Math.abs(M-V)<=v.EPSILON*Math.max(1,Math.abs(M),Math.abs(V))&&Math.abs(D-G)<=v.EPSILON*Math.max(1,Math.abs(D),Math.abs(G))&&Math.abs(U-j)<=v.EPSILON*Math.max(1,Math.abs(U),Math.abs(j))&&Math.abs(C-Y)<=v.EPSILON*Math.max(1,Math.abs(C),Math.abs(Y))&&Math.abs(E-$)<=v.EPSILON*Math.max(1,Math.abs(E),Math.abs($))&&Math.abs(B-it)<=v.EPSILON*Math.max(1,Math.abs(B),Math.abs(it))&&Math.abs(O-nt)<=v.EPSILON*Math.max(1,Math.abs(O),Math.abs(nt))&&Math.abs(d-x)<=v.EPSILON*Math.max(1,Math.abs(d),Math.abs(x))},u.sub=u.mul=void 0;var v=function(d){if(d&&d.__esModule)return d;var x={};if(d!=null){for(var y in d)if(Object.prototype.hasOwnProperty.call(d,y)){var M=Hn&&Gn?Gn(d,y):{};M.get||M.set?Hn(x,y,M):x[y]=d[y]}}return x.default=d,x}(za);u.mul=n,u.sub=l});Nt(lu);var Yd=Rt(function(a,u){function n(y){return y[0]=1,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=1,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[10]=1,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y}function l(y,M,D){var U=M[0],C=M[1],E=M[2],B=M[3],O=M[4],H=M[5],V=M[6],G=M[7],j=M[8],Y=M[9],$=M[10],it=M[11],nt=M[12],dt=M[13],Et=M[14];M=M[15];var St=D[0],Xt=D[1],te=D[2],Ie=D[3];return y[0]=St*U+Xt*O+te*j+Ie*nt,y[1]=St*C+Xt*H+te*Y+Ie*dt,y[2]=St*E+Xt*V+te*$+Ie*Et,y[3]=St*B+Xt*G+te*it+Ie*M,St=D[4],Xt=D[5],te=D[6],Ie=D[7],y[4]=St*U+Xt*O+te*j+Ie*nt,y[5]=St*C+Xt*H+te*Y+Ie*dt,y[6]=St*E+Xt*V+te*$+Ie*Et,y[7]=St*B+Xt*G+te*it+Ie*M,St=D[8],Xt=D[9],te=D[10],Ie=D[11],y[8]=St*U+Xt*O+te*j+Ie*nt,y[9]=St*C+Xt*H+te*Y+Ie*dt,y[10]=St*E+Xt*V+te*$+Ie*Et,y[11]=St*B+Xt*G+te*it+Ie*M,St=D[12],Xt=D[13],te=D[14],Ie=D[15],y[12]=St*U+Xt*O+te*j+Ie*nt,y[13]=St*C+Xt*H+te*Y+Ie*dt,y[14]=St*E+Xt*V+te*$+Ie*Et,y[15]=St*B+Xt*G+te*it+Ie*M,y}function v(y,M,D){var U=M[0],C=M[1],E=M[2],B=M[3],O=U+U,H=C+C,V=E+E;M=U*O;var G=U*H;U*=V;var j=C*H;return C*=V,E*=V,O*=B,H*=B,B*=V,y[0]=1-(j+E),y[1]=G+B,y[2]=U-H,y[3]=0,y[4]=G-B,y[5]=1-(M+E),y[6]=C+O,y[7]=0,y[8]=U+H,y[9]=C-O,y[10]=1-(M+j),y[11]=0,y[12]=D[0],y[13]=D[1],y[14]=D[2],y[15]=1,y}function d(y,M,D){return y[0]=M[0]-D[0],y[1]=M[1]-D[1],y[2]=M[2]-D[2],y[3]=M[3]-D[3],y[4]=M[4]-D[4],y[5]=M[5]-D[5],y[6]=M[6]-D[6],y[7]=M[7]-D[7],y[8]=M[8]-D[8],y[9]=M[9]-D[9],y[10]=M[10]-D[10],y[11]=M[11]-D[11],y[12]=M[12]-D[12],y[13]=M[13]-D[13],y[14]=M[14]-D[14],y[15]=M[15]-D[15],y}Object.defineProperty(u,"__esModule",{value:!0}),u.create=function(){var y=new x.ARRAY_TYPE(16);return x.ARRAY_TYPE!=Float32Array&&(y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[11]=0,y[12]=0,y[13]=0,y[14]=0),y[0]=1,y[5]=1,y[10]=1,y[15]=1,y},u.clone=function(y){var M=new x.ARRAY_TYPE(16);return M[0]=y[0],M[1]=y[1],M[2]=y[2],M[3]=y[3],M[4]=y[4],M[5]=y[5],M[6]=y[6],M[7]=y[7],M[8]=y[8],M[9]=y[9],M[10]=y[10],M[11]=y[11],M[12]=y[12],M[13]=y[13],M[14]=y[14],M[15]=y[15],M},u.copy=function(y,M){return y[0]=M[0],y[1]=M[1],y[2]=M[2],y[3]=M[3],y[4]=M[4],y[5]=M[5],y[6]=M[6],y[7]=M[7],y[8]=M[8],y[9]=M[9],y[10]=M[10],y[11]=M[11],y[12]=M[12],y[13]=M[13],y[14]=M[14],y[15]=M[15],y},u.fromValues=function(y,M,D,U,C,E,B,O,H,V,G,j,Y,$,it,nt){var dt=new x.ARRAY_TYPE(16);return dt[0]=y,dt[1]=M,dt[2]=D,dt[3]=U,dt[4]=C,dt[5]=E,dt[6]=B,dt[7]=O,dt[8]=H,dt[9]=V,dt[10]=G,dt[11]=j,dt[12]=Y,dt[13]=$,dt[14]=it,dt[15]=nt,dt},u.set=function(y,M,D,U,C,E,B,O,H,V,G,j,Y,$,it,nt,dt){return y[0]=M,y[1]=D,y[2]=U,y[3]=C,y[4]=E,y[5]=B,y[6]=O,y[7]=H,y[8]=V,y[9]=G,y[10]=j,y[11]=Y,y[12]=$,y[13]=it,y[14]=nt,y[15]=dt,y},u.identity=n,u.transpose=function(y,M){if(y===M){var D=M[1],U=M[2],C=M[3],E=M[6],B=M[7],O=M[11];y[1]=M[4],y[2]=M[8],y[3]=M[12],y[4]=D,y[6]=M[9],y[7]=M[13],y[8]=U,y[9]=E,y[11]=M[14],y[12]=C,y[13]=B,y[14]=O}else y[0]=M[0],y[1]=M[4],y[2]=M[8],y[3]=M[12],y[4]=M[1],y[5]=M[5],y[6]=M[9],y[7]=M[13],y[8]=M[2],y[9]=M[6],y[10]=M[10],y[11]=M[14],y[12]=M[3],y[13]=M[7],y[14]=M[11],y[15]=M[15];return y},u.invert=function(y,M){var D=M[0],U=M[1],C=M[2],E=M[3],B=M[4],O=M[5],H=M[6],V=M[7],G=M[8],j=M[9],Y=M[10],$=M[11],it=M[12],nt=M[13],dt=M[14];M=M[15];var Et=D*O-U*B,St=D*H-C*B,Xt=D*V-E*B,te=U*H-C*O,Ie=U*V-E*O,pe=C*V-E*H,be=G*nt-j*it,yr=G*dt-Y*it,oe=G*M-$*it,Be=j*dt-Y*nt,wr=j*M-$*nt,_r=Y*M-$*dt,ke=Et*_r-St*wr+Xt*Be+te*oe-Ie*yr+pe*be;return ke?(ke=1/ke,y[0]=(O*_r-H*wr+V*Be)*ke,y[1]=(C*wr-U*_r-E*Be)*ke,y[2]=(nt*pe-dt*Ie+M*te)*ke,y[3]=(Y*Ie-j*pe-$*te)*ke,y[4]=(H*oe-B*_r-V*yr)*ke,y[5]=(D*_r-C*oe+E*yr)*ke,y[6]=(dt*Xt-it*pe-M*St)*ke,y[7]=(G*pe-Y*Xt+$*St)*ke,y[8]=(B*wr-O*oe+V*be)*ke,y[9]=(U*oe-D*wr-E*be)*ke,y[10]=(it*Ie-nt*Xt+M*Et)*ke,y[11]=(j*Xt-G*Ie-$*Et)*ke,y[12]=(O*yr-B*Be-H*be)*ke,y[13]=(D*Be-U*yr+C*be)*ke,y[14]=(nt*St-it*te-dt*Et)*ke,y[15]=(G*te-j*St+Y*Et)*ke,y):null},u.adjoint=function(y,M){var D=M[0],U=M[1],C=M[2],E=M[3],B=M[4],O=M[5],H=M[6],V=M[7],G=M[8],j=M[9],Y=M[10],$=M[11],it=M[12],nt=M[13],dt=M[14];return M=M[15],y[0]=O*(Y*M-$*dt)-j*(H*M-V*dt)+nt*(H*$-V*Y),y[1]=-(U*(Y*M-$*dt)-j*(C*M-E*dt)+nt*(C*$-E*Y)),y[2]=U*(H*M-V*dt)-O*(C*M-E*dt)+nt*(C*V-E*H),y[3]=-(U*(H*$-V*Y)-O*(C*$-E*Y)+j*(C*V-E*H)),y[4]=-(B*(Y*M-$*dt)-G*(H*M-V*dt)+it*(H*$-V*Y)),y[5]=D*(Y*M-$*dt)-G*(C*M-E*dt)+it*(C*$-E*Y),y[6]=-(D*(H*M-V*dt)-B*(C*M-E*dt)+it*(C*V-E*H)),y[7]=D*(H*$-V*Y)-B*(C*$-E*Y)+G*(C*V-E*H),y[8]=B*(j*M-$*nt)-G*(O*M-V*nt)+it*(O*$-V*j),y[9]=-(D*(j*M-$*nt)-G*(U*M-E*nt)+it*(U*$-E*j)),y[10]=D*(O*M-V*nt)-B*(U*M-E*nt)+it*(U*V-E*O),y[11]=-(D*(O*$-V*j)-B*(U*$-E*j)+G*(U*V-E*O)),y[12]=-(B*(j*dt-Y*nt)-G*(O*dt-H*nt)+it*(O*Y-H*j)),y[13]=D*(j*dt-Y*nt)-G*(U*dt-C*nt)+it*(U*Y-C*j),y[14]=-(D*(O*dt-H*nt)-B*(U*dt-C*nt)+it*(U*H-C*O)),y[15]=D*(O*Y-H*j)-B*(U*Y-C*j)+G*(U*H-C*O),y},u.determinant=function(y){var M=y[0],D=y[1],U=y[2],C=y[3],E=y[4],B=y[5],O=y[6],H=y[7],V=y[8],G=y[9],j=y[10],Y=y[11],$=y[12],it=y[13],nt=y[14];return y=y[15],(M*B-D*E)*(j*y-Y*nt)-(M*O-U*E)*(G*y-Y*it)+(M*H-C*E)*(G*nt-j*it)+(D*O-U*B)*(V*y-Y*$)-(D*H-C*B)*(V*nt-j*$)+(U*H-C*O)*(V*it-G*$)},u.multiply=l,u.translate=function(y,M,D){var U=D[0],C=D[1];if(D=D[2],M===y)y[12]=M[0]*U+M[4]*C+M[8]*D+M[12],y[13]=M[1]*U+M[5]*C+M[9]*D+M[13],y[14]=M[2]*U+M[6]*C+M[10]*D+M[14],y[15]=M[3]*U+M[7]*C+M[11]*D+M[15];else{var E=M[0],B=M[1],O=M[2],H=M[3],V=M[4],G=M[5],j=M[6],Y=M[7],$=M[8],it=M[9],nt=M[10],dt=M[11];y[0]=E,y[1]=B,y[2]=O,y[3]=H,y[4]=V,y[5]=G,y[6]=j,y[7]=Y,y[8]=$,y[9]=it,y[10]=nt,y[11]=dt,y[12]=E*U+V*C+$*D+M[12],y[13]=B*U+G*C+it*D+M[13],y[14]=O*U+j*C+nt*D+M[14],y[15]=H*U+Y*C+dt*D+M[15]}return y},u.scale=function(y,M,D){var U=D[0],C=D[1];return D=D[2],y[0]=M[0]*U,y[1]=M[1]*U,y[2]=M[2]*U,y[3]=M[3]*U,y[4]=M[4]*C,y[5]=M[5]*C,y[6]=M[6]*C,y[7]=M[7]*C,y[8]=M[8]*D,y[9]=M[9]*D,y[10]=M[10]*D,y[11]=M[11]*D,y[12]=M[12],y[13]=M[13],y[14]=M[14],y[15]=M[15],y},u.rotate=function(y,M,D,U){var C=U[0],E=U[1];U=U[2];var B=Math.sqrt(C*C+E*E+U*U);if(B<x.EPSILON)return null;B=1/B,C*=B,E*=B,U*=B;var O=Math.sin(D),H=Math.cos(D),V=1-H;D=M[0],B=M[1];var G=M[2],j=M[3],Y=M[4],$=M[5],it=M[6],nt=M[7],dt=M[8],Et=M[9],St=M[10],Xt=M[11],te=C*C*V+H,Ie=E*C*V+U*O,pe=U*C*V-E*O,be=C*E*V-U*O,yr=E*E*V+H,oe=U*E*V+C*O,Be=C*U*V+E*O;return C=E*U*V-C*O,E=U*U*V+H,y[0]=D*te+Y*Ie+dt*pe,y[1]=B*te+$*Ie+Et*pe,y[2]=G*te+it*Ie+St*pe,y[3]=j*te+nt*Ie+Xt*pe,y[4]=D*be+Y*yr+dt*oe,y[5]=B*be+$*yr+Et*oe,y[6]=G*be+it*yr+St*oe,y[7]=j*be+nt*yr+Xt*oe,y[8]=D*Be+Y*C+dt*E,y[9]=B*Be+$*C+Et*E,y[10]=G*Be+it*C+St*E,y[11]=j*Be+nt*C+Xt*E,M!==y&&(y[12]=M[12],y[13]=M[13],y[14]=M[14],y[15]=M[15]),y},u.rotateX=function(y,M,D){var U=Math.sin(D);D=Math.cos(D);var C=M[4],E=M[5],B=M[6],O=M[7],H=M[8],V=M[9],G=M[10],j=M[11];return M!==y&&(y[0]=M[0],y[1]=M[1],y[2]=M[2],y[3]=M[3],y[12]=M[12],y[13]=M[13],y[14]=M[14],y[15]=M[15]),y[4]=C*D+H*U,y[5]=E*D+V*U,y[6]=B*D+G*U,y[7]=O*D+j*U,y[8]=H*D-C*U,y[9]=V*D-E*U,y[10]=G*D-B*U,y[11]=j*D-O*U,y},u.rotateY=function(y,M,D){var U=Math.sin(D);D=Math.cos(D);var C=M[0],E=M[1],B=M[2],O=M[3],H=M[8],V=M[9],G=M[10],j=M[11];return M!==y&&(y[4]=M[4],y[5]=M[5],y[6]=M[6],y[7]=M[7],y[12]=M[12],y[13]=M[13],y[14]=M[14],y[15]=M[15]),y[0]=C*D-H*U,y[1]=E*D-V*U,y[2]=B*D-G*U,y[3]=O*D-j*U,y[8]=C*U+H*D,y[9]=E*U+V*D,y[10]=B*U+G*D,y[11]=O*U+j*D,y},u.rotateZ=function(y,M,D){var U=Math.sin(D);D=Math.cos(D);var C=M[0],E=M[1],B=M[2],O=M[3],H=M[4],V=M[5],G=M[6],j=M[7];return M!==y&&(y[8]=M[8],y[9]=M[9],y[10]=M[10],y[11]=M[11],y[12]=M[12],y[13]=M[13],y[14]=M[14],y[15]=M[15]),y[0]=C*D+H*U,y[1]=E*D+V*U,y[2]=B*D+G*U,y[3]=O*D+j*U,y[4]=H*D-C*U,y[5]=V*D-E*U,y[6]=G*D-B*U,y[7]=j*D-O*U,y},u.fromTranslation=function(y,M){return y[0]=1,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=1,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[10]=1,y[11]=0,y[12]=M[0],y[13]=M[1],y[14]=M[2],y[15]=1,y},u.fromScaling=function(y,M){return y[0]=M[0],y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=M[1],y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[10]=M[2],y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y},u.fromRotation=function(y,M,D){var U=D[0],C=D[1];D=D[2];var E=Math.sqrt(U*U+C*C+D*D);if(E<x.EPSILON)return null;E=1/E,U*=E,C*=E,D*=E,E=Math.sin(M),M=Math.cos(M);var B=1-M;return y[0]=U*U*B+M,y[1]=C*U*B+D*E,y[2]=D*U*B-C*E,y[3]=0,y[4]=U*C*B-D*E,y[5]=C*C*B+M,y[6]=D*C*B+U*E,y[7]=0,y[8]=U*D*B+C*E,y[9]=C*D*B-U*E,y[10]=D*D*B+M,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y},u.fromXRotation=function(y,M){var D=Math.sin(M);return M=Math.cos(M),y[0]=1,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=M,y[6]=D,y[7]=0,y[8]=0,y[9]=-D,y[10]=M,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y},u.fromYRotation=function(y,M){var D=Math.sin(M);return M=Math.cos(M),y[0]=M,y[1]=0,y[2]=-D,y[3]=0,y[4]=0,y[5]=1,y[6]=0,y[7]=0,y[8]=D,y[9]=0,y[10]=M,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y},u.fromZRotation=function(y,M){var D=Math.sin(M);return M=Math.cos(M),y[0]=M,y[1]=D,y[2]=0,y[3]=0,y[4]=-D,y[5]=M,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[10]=1,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y},u.fromRotationTranslation=v,u.fromQuat2=function(y,M){var D=new x.ARRAY_TYPE(3),U=-M[0],C=-M[1],E=-M[2],B=M[3],O=M[4],H=M[5],V=M[6],G=M[7],j=U*U+C*C+E*E+B*B;return 0<j?(D[0]=2*(O*B+G*U+H*E-V*C)/j,D[1]=2*(H*B+G*C+V*U-O*E)/j,D[2]=2*(V*B+G*E+O*C-H*U)/j):(D[0]=2*(O*B+G*U+H*E-V*C),D[1]=2*(H*B+G*C+V*U-O*E),D[2]=2*(V*B+G*E+O*C-H*U)),v(y,M,D),y},u.getTranslation=function(y,M){return y[0]=M[12],y[1]=M[13],y[2]=M[14],y},u.getScaling=function(y,M){var D=M[0],U=M[1],C=M[2],E=M[4],B=M[5],O=M[6],H=M[8],V=M[9];return M=M[10],y[0]=Math.sqrt(D*D+U*U+C*C),y[1]=Math.sqrt(E*E+B*B+O*O),y[2]=Math.sqrt(H*H+V*V+M*M),y},u.getRotation=function(y,M){var D=M[0]+M[5]+M[10];return 0<D?(D=2*Math.sqrt(D+1),y[3]=.25*D,y[0]=(M[6]-M[9])/D,y[1]=(M[8]-M[2])/D,y[2]=(M[1]-M[4])/D):M[0]>M[5]&&M[0]>M[10]?(D=2*Math.sqrt(1+M[0]-M[5]-M[10]),y[3]=(M[6]-M[9])/D,y[0]=.25*D,y[1]=(M[1]+M[4])/D,y[2]=(M[8]+M[2])/D):M[5]>M[10]?(D=2*Math.sqrt(1+M[5]-M[0]-M[10]),y[3]=(M[8]-M[2])/D,y[0]=(M[1]+M[4])/D,y[1]=.25*D,y[2]=(M[6]+M[9])/D):(D=2*Math.sqrt(1+M[10]-M[0]-M[5]),y[3]=(M[1]-M[4])/D,y[0]=(M[8]+M[2])/D,y[1]=(M[6]+M[9])/D,y[2]=.25*D),y},u.fromRotationTranslationScale=function(y,M,D,U){var C=M[0],E=M[1],B=M[2],O=M[3],H=C+C,V=E+E,G=B+B;M=C*H;var j=C*V;C*=G;var Y=E*V;E*=G,B*=G,H*=O,V*=O,O*=G,G=U[0];var $=U[1];return U=U[2],y[0]=(1-(Y+B))*G,y[1]=(j+O)*G,y[2]=(C-V)*G,y[3]=0,y[4]=(j-O)*$,y[5]=(1-(M+B))*$,y[6]=(E+H)*$,y[7]=0,y[8]=(C+V)*U,y[9]=(E-H)*U,y[10]=(1-(M+Y))*U,y[11]=0,y[12]=D[0],y[13]=D[1],y[14]=D[2],y[15]=1,y},u.fromRotationTranslationScaleOrigin=function(y,M,D,U,C){var E=M[0],B=M[1],O=M[2],H=M[3],V=E+E,G=B+B,j=O+O;M=E*V;var Y=E*G,$=E*j;E=B*G,B*=j;var it=O*j;O=H*V,G*=H;var nt=H*j,dt=U[0],Et=U[1];j=U[2],U=C[0],H=C[1],C=C[2],V=(1-(E+it))*dt;var St=(Y+nt)*dt;return dt*=$-G,Y=(Y-nt)*Et,it=(1-(M+it))*Et,Et*=B+O,$=($+G)*j,B=(B-O)*j,M=(1-(M+E))*j,y[0]=V,y[1]=St,y[2]=dt,y[3]=0,y[4]=Y,y[5]=it,y[6]=Et,y[7]=0,y[8]=$,y[9]=B,y[10]=M,y[11]=0,y[12]=D[0]+U-(V*U+Y*H+$*C),y[13]=D[1]+H-(St*U+it*H+B*C),y[14]=D[2]+C-(dt*U+Et*H+M*C),y[15]=1,y},u.fromQuat=function(y,M){var D=M[0],U=M[1],C=M[2];M=M[3];var E=D+D,B=U+U,O=C+C;D*=E;var H=U*E;U*=B;var V=C*E,G=C*B;return C*=O,E*=M,B*=M,M*=O,y[0]=1-U-C,y[1]=H+M,y[2]=V-B,y[3]=0,y[4]=H-M,y[5]=1-D-C,y[6]=G+E,y[7]=0,y[8]=V+B,y[9]=G-E,y[10]=1-D-U,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y},u.frustum=function(y,M,D,U,C,E,B){var O=1/(D-M),H=1/(C-U),V=1/(E-B);return y[0]=2*E*O,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=2*E*H,y[6]=0,y[7]=0,y[8]=(D+M)*O,y[9]=(C+U)*H,y[10]=(B+E)*V,y[11]=-1,y[12]=0,y[13]=0,y[14]=B*E*2*V,y[15]=0,y},u.perspective=function(y,M,D,U,C){return M=1/Math.tan(M/2),y[0]=M/D,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=M,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[11]=-1,y[12]=0,y[13]=0,y[15]=0,C!=null&&C!==Infinity?(D=1/(U-C),y[10]=(C+U)*D,y[14]=2*C*U*D):(y[10]=-1,y[14]=-2*U),y},u.perspectiveFromFieldOfView=function(y,M,D,U){var C=Math.tan(M.upDegrees*Math.PI/180),E=Math.tan(M.downDegrees*Math.PI/180),B=Math.tan(M.leftDegrees*Math.PI/180);M=Math.tan(M.rightDegrees*Math.PI/180);var O=2/(B+M),H=2/(C+E);return y[0]=O,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=H,y[6]=0,y[7]=0,y[8]=-((B-M)*O*.5),y[9]=(C-E)*H*.5,y[10]=U/(D-U),y[11]=-1,y[12]=0,y[13]=0,y[14]=U*D/(D-U),y[15]=0,y},u.ortho=function(y,M,D,U,C,E,B){var O=1/(M-D),H=1/(U-C),V=1/(E-B);return y[0]=-2*O,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=-2*H,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[10]=2*V,y[11]=0,y[12]=(M+D)*O,y[13]=(C+U)*H,y[14]=(B+E)*V,y[15]=1,y},u.lookAt=function(y,M,D,U){var C=M[0],E=M[1];M=M[2];var B=U[0],O=U[1],H=U[2],V=D[0];U=D[1];var G=D[2];if(Math.abs(C-V)<x.EPSILON&&Math.abs(E-U)<x.EPSILON&&Math.abs(M-G)<x.EPSILON)return n(y);D=C-V,U=E-U,V=M-G;var j=1/Math.sqrt(D*D+U*U+V*V);D*=j,U*=j,V*=j,G=O*V-H*U,H=H*D-B*V,B=B*U-O*D,(j=Math.sqrt(G*G+H*H+B*B))?(j=1/j,G*=j,H*=j,B*=j):B=H=G=0,O=U*B-V*H;var Y=V*G-D*B,$=D*H-U*G;return(j=Math.sqrt(O*O+Y*Y+$*$))?(j=1/j,O*=j,Y*=j,$*=j):$=Y=O=0,y[0]=G,y[1]=O,y[2]=D,y[3]=0,y[4]=H,y[5]=Y,y[6]=U,y[7]=0,y[8]=B,y[9]=$,y[10]=V,y[11]=0,y[12]=-(G*C+H*E+B*M),y[13]=-(O*C+Y*E+$*M),y[14]=-(D*C+U*E+V*M),y[15]=1,y},u.targetTo=function(y,M,D,U){var C=M[0],E=M[1];M=M[2];var B=U[0],O=U[1],H=U[2];U=C-D[0];var V=E-D[1];D=M-D[2];var G=U*U+V*V+D*D;0<G&&(G=1/Math.sqrt(G),U*=G,V*=G,D*=G);var j=O*D-H*V;return H=H*U-B*D,B=B*V-O*U,G=j*j+H*H+B*B,0<G&&(G=1/Math.sqrt(G),j*=G,H*=G,B*=G),y[0]=j,y[1]=H,y[2]=B,y[3]=0,y[4]=V*B-D*H,y[5]=D*j-U*B,y[6]=U*H-V*j,y[7]=0,y[8]=U,y[9]=V,y[10]=D,y[11]=0,y[12]=C,y[13]=E,y[14]=M,y[15]=1,y},u.str=function(y){return"mat4("+y[0]+", "+y[1]+", "+y[2]+", "+y[3]+", "+y[4]+", "+y[5]+", "+y[6]+", "+y[7]+", "+y[8]+", "+y[9]+", "+y[10]+", "+y[11]+", "+y[12]+", "+y[13]+", "+y[14]+", "+y[15]+")"},u.frob=function(y){return Math.sqrt(Math.pow(y[0],2)+Math.pow(y[1],2)+Math.pow(y[2],2)+Math.pow(y[3],2)+Math.pow(y[4],2)+Math.pow(y[5],2)+Math.pow(y[6],2)+Math.pow(y[7],2)+Math.pow(y[8],2)+Math.pow(y[9],2)+Math.pow(y[10],2)+Math.pow(y[11],2)+Math.pow(y[12],2)+Math.pow(y[13],2)+Math.pow(y[14],2)+Math.pow(y[15],2))},u.add=function(y,M,D){return y[0]=M[0]+D[0],y[1]=M[1]+D[1],y[2]=M[2]+D[2],y[3]=M[3]+D[3],y[4]=M[4]+D[4],y[5]=M[5]+D[5],y[6]=M[6]+D[6],y[7]=M[7]+D[7],y[8]=M[8]+D[8],y[9]=M[9]+D[9],y[10]=M[10]+D[10],y[11]=M[11]+D[11],y[12]=M[12]+D[12],y[13]=M[13]+D[13],y[14]=M[14]+D[14],y[15]=M[15]+D[15],y},u.subtract=d,u.multiplyScalar=function(y,M,D){return y[0]=M[0]*D,y[1]=M[1]*D,y[2]=M[2]*D,y[3]=M[3]*D,y[4]=M[4]*D,y[5]=M[5]*D,y[6]=M[6]*D,y[7]=M[7]*D,y[8]=M[8]*D,y[9]=M[9]*D,y[10]=M[10]*D,y[11]=M[11]*D,y[12]=M[12]*D,y[13]=M[13]*D,y[14]=M[14]*D,y[15]=M[15]*D,y},u.multiplyScalarAndAdd=function(y,M,D,U){return y[0]=M[0]+D[0]*U,y[1]=M[1]+D[1]*U,y[2]=M[2]+D[2]*U,y[3]=M[3]+D[3]*U,y[4]=M[4]+D[4]*U,y[5]=M[5]+D[5]*U,y[6]=M[6]+D[6]*U,y[7]=M[7]+D[7]*U,y[8]=M[8]+D[8]*U,y[9]=M[9]+D[9]*U,y[10]=M[10]+D[10]*U,y[11]=M[11]+D[11]*U,y[12]=M[12]+D[12]*U,y[13]=M[13]+D[13]*U,y[14]=M[14]+D[14]*U,y[15]=M[15]+D[15]*U,y},u.exactEquals=function(y,M){return y[0]===M[0]&&y[1]===M[1]&&y[2]===M[2]&&y[3]===M[3]&&y[4]===M[4]&&y[5]===M[5]&&y[6]===M[6]&&y[7]===M[7]&&y[8]===M[8]&&y[9]===M[9]&&y[10]===M[10]&&y[11]===M[11]&&y[12]===M[12]&&y[13]===M[13]&&y[14]===M[14]&&y[15]===M[15]},u.equals=function(y,M){var D=y[0],U=y[1],C=y[2],E=y[3],B=y[4],O=y[5],H=y[6],V=y[7],G=y[8],j=y[9],Y=y[10],$=y[11],it=y[12],nt=y[13],dt=y[14];y=y[15];var Et=M[0],St=M[1],Xt=M[2],te=M[3],Ie=M[4],pe=M[5],be=M[6],yr=M[7],oe=M[8],Be=M[9],wr=M[10],_r=M[11],ke=M[12],Os=M[13],wn=M[14];return M=M[15],Math.abs(D-Et)<=x.EPSILON*Math.max(1,Math.abs(D),Math.abs(Et))&&Math.abs(U-St)<=x.EPSILON*Math.max(1,Math.abs(U),Math.abs(St))&&Math.abs(C-Xt)<=x.EPSILON*Math.max(1,Math.abs(C),Math.abs(Xt))&&Math.abs(E-te)<=x.EPSILON*Math.max(1,Math.abs(E),Math.abs(te))&&Math.abs(B-Ie)<=x.EPSILON*Math.max(1,Math.abs(B),Math.abs(Ie))&&Math.abs(O-pe)<=x.EPSILON*Math.max(1,Math.abs(O),Math.abs(pe))&&Math.abs(H-be)<=x.EPSILON*Math.max(1,Math.abs(H),Math.abs(be))&&Math.abs(V-yr)<=x.EPSILON*Math.max(1,Math.abs(V),Math.abs(yr))&&Math.abs(G-oe)<=x.EPSILON*Math.max(1,Math.abs(G),Math.abs(oe))&&Math.abs(j-Be)<=x.EPSILON*Math.max(1,Math.abs(j),Math.abs(Be))&&Math.abs(Y-wr)<=x.EPSILON*Math.max(1,Math.abs(Y),Math.abs(wr))&&Math.abs($-_r)<=x.EPSILON*Math.max(1,Math.abs($),Math.abs(_r))&&Math.abs(it-ke)<=x.EPSILON*Math.max(1,Math.abs(it),Math.abs(ke))&&Math.abs(nt-Os)<=x.EPSILON*Math.max(1,Math.abs(nt),Math.abs(Os))&&Math.abs(dt-wn)<=x.EPSILON*Math.max(1,Math.abs(dt),Math.abs(wn))&&Math.abs(y-M)<=x.EPSILON*Math.max(1,Math.abs(y),Math.abs(M))},u.sub=u.mul=void 0;var x=function(y){if(y&&y.__esModule)return y;var M={};if(y!=null){for(var D in y)if(Object.prototype.hasOwnProperty.call(y,D)){var U=Hn&&Gn?Gn(y,D):{};U.get||U.set?Hn(M,D,U):M[D]=y[D]}}return M.default=y,M}(za);u.mul=l,u.sub=d});Nt(Yd);var Zd=Rt(function(a,u){function n(){var O=new B.ARRAY_TYPE(3);return B.ARRAY_TYPE!=Float32Array&&(O[0]=0,O[1]=0,O[2]=0),O}function l(O){var H=O[0],V=O[1];return O=O[2],Math.sqrt(H*H+V*V+O*O)}function v(O,H,V){var G=new B.ARRAY_TYPE(3);return G[0]=O,G[1]=H,G[2]=V,G}function d(O,H,V){return O[0]=H[0]-V[0],O[1]=H[1]-V[1],O[2]=H[2]-V[2],O}function x(O,H,V){return O[0]=H[0]*V[0],O[1]=H[1]*V[1],O[2]=H[2]*V[2],O}function y(O,H,V){return O[0]=H[0]/V[0],O[1]=H[1]/V[1],O[2]=H[2]/V[2],O}function M(O,H){var V=H[0]-O[0],G=H[1]-O[1];return O=H[2]-O[2],Math.sqrt(V*V+G*G+O*O)}function D(O,H){var V=H[0]-O[0],G=H[1]-O[1];return O=H[2]-O[2],V*V+G*G+O*O}function U(O){var H=O[0],V=O[1];return O=O[2],H*H+V*V+O*O}function C(O,H){var V=H[0],G=H[1],j=H[2];return V=V*V+G*G+j*j,0<V&&(V=1/Math.sqrt(V)),O[0]=H[0]*V,O[1]=H[1]*V,O[2]=H[2]*V,O}function E(O,H){return O[0]*H[0]+O[1]*H[1]+O[2]*H[2]}Object.defineProperty(u,"__esModule",{value:!0}),u.create=n,u.clone=function(O){var H=new B.ARRAY_TYPE(3);return H[0]=O[0],H[1]=O[1],H[2]=O[2],H},u.length=l,u.fromValues=v,u.copy=function(O,H){return O[0]=H[0],O[1]=H[1],O[2]=H[2],O},u.set=function(O,H,V,G){return O[0]=H,O[1]=V,O[2]=G,O},u.add=function(O,H,V){return O[0]=H[0]+V[0],O[1]=H[1]+V[1],O[2]=H[2]+V[2],O},u.subtract=d,u.multiply=x,u.divide=y,u.ceil=function(O,H){return O[0]=Math.ceil(H[0]),O[1]=Math.ceil(H[1]),O[2]=Math.ceil(H[2]),O},u.floor=function(O,H){return O[0]=Math.floor(H[0]),O[1]=Math.floor(H[1]),O[2]=Math.floor(H[2]),O},u.min=function(O,H,V){return O[0]=Math.min(H[0],V[0]),O[1]=Math.min(H[1],V[1]),O[2]=Math.min(H[2],V[2]),O},u.max=function(O,H,V){return O[0]=Math.max(H[0],V[0]),O[1]=Math.max(H[1],V[1]),O[2]=Math.max(H[2],V[2]),O},u.round=function(O,H){return O[0]=Math.round(H[0]),O[1]=Math.round(H[1]),O[2]=Math.round(H[2]),O},u.scale=function(O,H,V){return O[0]=H[0]*V,O[1]=H[1]*V,O[2]=H[2]*V,O},u.scaleAndAdd=function(O,H,V,G){return O[0]=H[0]+V[0]*G,O[1]=H[1]+V[1]*G,O[2]=H[2]+V[2]*G,O},u.distance=M,u.squaredDistance=D,u.squaredLength=U,u.negate=function(O,H){return O[0]=-H[0],O[1]=-H[1],O[2]=-H[2],O},u.inverse=function(O,H){return O[0]=1/H[0],O[1]=1/H[1],O[2]=1/H[2],O},u.normalize=C,u.dot=E,u.cross=function(O,H,V){var G=H[0],j=H[1];H=H[2];var Y=V[0],$=V[1];return V=V[2],O[0]=j*V-H*$,O[1]=H*Y-G*V,O[2]=G*$-j*Y,O},u.lerp=function(O,H,V,G){var j=H[0],Y=H[1];return H=H[2],O[0]=j+G*(V[0]-j),O[1]=Y+G*(V[1]-Y),O[2]=H+G*(V[2]-H),O},u.hermite=function(O,H,V,G,j,Y){var $=Y*Y,it=$*(2*Y-3)+1,nt=$*(Y-2)+Y,dt=$*(Y-1);return Y=$*(3-2*Y),O[0]=H[0]*it+V[0]*nt+G[0]*dt+j[0]*Y,O[1]=H[1]*it+V[1]*nt+G[1]*dt+j[1]*Y,O[2]=H[2]*it+V[2]*nt+G[2]*dt+j[2]*Y,O},u.bezier=function(O,H,V,G,j,Y){var $=1-Y,it=$*$,nt=Y*Y,dt=it*$;return it*=3*Y,$*=3*nt,Y*=nt,O[0]=H[0]*dt+V[0]*it+G[0]*$+j[0]*Y,O[1]=H[1]*dt+V[1]*it+G[1]*$+j[1]*Y,O[2]=H[2]*dt+V[2]*it+G[2]*$+j[2]*Y,O},u.random=function(O,H){H=H||1;var V=2*B.RANDOM()*Math.PI,G=2*B.RANDOM()-1,j=Math.sqrt(1-G*G)*H;return O[0]=Math.cos(V)*j,O[1]=Math.sin(V)*j,O[2]=G*H,O},u.transformMat4=function(O,H,V){var G=H[0],j=H[1];H=H[2];var Y=V[3]*G+V[7]*j+V[11]*H+V[15];return Y=Y||1,O[0]=(V[0]*G+V[4]*j+V[8]*H+V[12])/Y,O[1]=(V[1]*G+V[5]*j+V[9]*H+V[13])/Y,O[2]=(V[2]*G+V[6]*j+V[10]*H+V[14])/Y,O},u.transformMat3=function(O,H,V){var G=H[0],j=H[1];return H=H[2],O[0]=G*V[0]+j*V[3]+H*V[6],O[1]=G*V[1]+j*V[4]+H*V[7],O[2]=G*V[2]+j*V[5]+H*V[8],O},u.transformQuat=function(O,H,V){var G=V[0],j=V[1],Y=V[2],$=H[0],it=H[1];H=H[2];var nt=j*H-Y*it,dt=Y*$-G*H,Et=G*it-j*$;return V=2*V[3],O[0]=$+nt*V+2*(j*Et-Y*dt),O[1]=it+dt*V+2*(Y*nt-G*Et),O[2]=H+Et*V+2*(G*dt-j*nt),O},u.rotateX=function(O,H,V,G){var j=[],Y=[];return j[0]=H[0]-V[0],j[1]=H[1]-V[1],j[2]=H[2]-V[2],Y[0]=j[0],Y[1]=j[1]*Math.cos(G)-j[2]*Math.sin(G),Y[2]=j[1]*Math.sin(G)+j[2]*Math.cos(G),O[0]=Y[0]+V[0],O[1]=Y[1]+V[1],O[2]=Y[2]+V[2],O},u.rotateY=function(O,H,V,G){var j=[],Y=[];return j[0]=H[0]-V[0],j[1]=H[1]-V[1],j[2]=H[2]-V[2],Y[0]=j[2]*Math.sin(G)+j[0]*Math.cos(G),Y[1]=j[1],Y[2]=j[2]*Math.cos(G)-j[0]*Math.sin(G),O[0]=Y[0]+V[0],O[1]=Y[1]+V[1],O[2]=Y[2]+V[2],O},u.rotateZ=function(O,H,V,G){var j=[],Y=[];return j[0]=H[0]-V[0],j[1]=H[1]-V[1],j[2]=H[2]-V[2],Y[0]=j[0]*Math.cos(G)-j[1]*Math.sin(G),Y[1]=j[0]*Math.sin(G)+j[1]*Math.cos(G),Y[2]=j[2],O[0]=Y[0]+V[0],O[1]=Y[1]+V[1],O[2]=Y[2]+V[2],O},u.angle=function(O,H){return O=v(O[0],O[1],O[2]),H=v(H[0],H[1],H[2]),C(O,O),C(H,H),H=E(O,H),1<H?0:-1>H?Math.PI:Math.acos(H)},u.zero=function(O){return O[0]=0,O[1]=0,O[2]=0,O},u.str=function(O){return"vec3("+O[0]+", "+O[1]+", "+O[2]+")"},u.exactEquals=function(O,H){return O[0]===H[0]&&O[1]===H[1]&&O[2]===H[2]},u.equals=function(O,H){var V=O[0],G=O[1];O=O[2];var j=H[0],Y=H[1];return H=H[2],Math.abs(V-j)<=B.EPSILON*Math.max(1,Math.abs(V),Math.abs(j))&&Math.abs(G-Y)<=B.EPSILON*Math.max(1,Math.abs(G),Math.abs(Y))&&Math.abs(O-H)<=B.EPSILON*Math.max(1,Math.abs(O),Math.abs(H))},u.forEach=u.sqrLen=u.len=u.sqrDist=u.dist=u.div=u.mul=u.sub=void 0;var B=function(O){if(O&&O.__esModule)return O;var H={};if(O!=null){for(var V in O)if(Object.prototype.hasOwnProperty.call(O,V)){var G=Hn&&Gn?Gn(O,V):{};G.get||G.set?Hn(H,V,G):H[V]=O[V]}}return H.default=O,H}(za);u.sub=d,u.mul=x,u.div=y,u.dist=M,u.sqrDist=D,u.len=l,u.sqrLen=U,a=function(){var O=n();return function(H,V,G,j,Y,$){for(V||(V=3),G||(G=0),j=j?Math.min(j*V+G,H.length):H.length;G<j;G+=V)O[0]=H[G],O[1]=H[G+1],O[2]=H[G+2],Y(O,O,$),H[G]=O[0],H[G+1]=O[1],H[G+2]=O[2];return H}}(),u.forEach=a});Nt(Zd);var rp=Rt(function(a,u){function n(){var C=new U.ARRAY_TYPE(4);return U.ARRAY_TYPE!=Float32Array&&(C[0]=0,C[1]=0,C[2]=0,C[3]=0),C}function l(C,E,B){return C[0]=E[0]-B[0],C[1]=E[1]-B[1],C[2]=E[2]-B[2],C[3]=E[3]-B[3],C}function v(C,E,B){return C[0]=E[0]*B[0],C[1]=E[1]*B[1],C[2]=E[2]*B[2],C[3]=E[3]*B[3],C}function d(C,E,B){return C[0]=E[0]/B[0],C[1]=E[1]/B[1],C[2]=E[2]/B[2],C[3]=E[3]/B[3],C}function x(C,E){var B=E[0]-C[0],O=E[1]-C[1],H=E[2]-C[2];return C=E[3]-C[3],Math.sqrt(B*B+O*O+H*H+C*C)}function y(C,E){var B=E[0]-C[0],O=E[1]-C[1],H=E[2]-C[2];return C=E[3]-C[3],B*B+O*O+H*H+C*C}function M(C){var E=C[0],B=C[1],O=C[2];return C=C[3],Math.sqrt(E*E+B*B+O*O+C*C)}function D(C){var E=C[0],B=C[1],O=C[2];return C=C[3],E*E+B*B+O*O+C*C}Object.defineProperty(u,"__esModule",{value:!0}),u.create=n,u.clone=function(C){var E=new U.ARRAY_TYPE(4);return E[0]=C[0],E[1]=C[1],E[2]=C[2],E[3]=C[3],E},u.fromValues=function(C,E,B,O){var H=new U.ARRAY_TYPE(4);return H[0]=C,H[1]=E,H[2]=B,H[3]=O,H},u.copy=function(C,E){return C[0]=E[0],C[1]=E[1],C[2]=E[2],C[3]=E[3],C},u.set=function(C,E,B,O,H){return C[0]=E,C[1]=B,C[2]=O,C[3]=H,C},u.add=function(C,E,B){return C[0]=E[0]+B[0],C[1]=E[1]+B[1],C[2]=E[2]+B[2],C[3]=E[3]+B[3],C},u.subtract=l,u.multiply=v,u.divide=d,u.ceil=function(C,E){return C[0]=Math.ceil(E[0]),C[1]=Math.ceil(E[1]),C[2]=Math.ceil(E[2]),C[3]=Math.ceil(E[3]),C},u.floor=function(C,E){return C[0]=Math.floor(E[0]),C[1]=Math.floor(E[1]),C[2]=Math.floor(E[2]),C[3]=Math.floor(E[3]),C},u.min=function(C,E,B){return C[0]=Math.min(E[0],B[0]),C[1]=Math.min(E[1],B[1]),C[2]=Math.min(E[2],B[2]),C[3]=Math.min(E[3],B[3]),C},u.max=function(C,E,B){return C[0]=Math.max(E[0],B[0]),C[1]=Math.max(E[1],B[1]),C[2]=Math.max(E[2],B[2]),C[3]=Math.max(E[3],B[3]),C},u.round=function(C,E){return C[0]=Math.round(E[0]),C[1]=Math.round(E[1]),C[2]=Math.round(E[2]),C[3]=Math.round(E[3]),C},u.scale=function(C,E,B){return C[0]=E[0]*B,C[1]=E[1]*B,C[2]=E[2]*B,C[3]=E[3]*B,C},u.scaleAndAdd=function(C,E,B,O){return C[0]=E[0]+B[0]*O,C[1]=E[1]+B[1]*O,C[2]=E[2]+B[2]*O,C[3]=E[3]+B[3]*O,C},u.distance=x,u.squaredDistance=y,u.length=M,u.squaredLength=D,u.negate=function(C,E){return C[0]=-E[0],C[1]=-E[1],C[2]=-E[2],C[3]=-E[3],C},u.inverse=function(C,E){return C[0]=1/E[0],C[1]=1/E[1],C[2]=1/E[2],C[3]=1/E[3],C},u.normalize=function(C,E){var B=E[0],O=E[1],H=E[2];E=E[3];var V=B*B+O*O+H*H+E*E;return 0<V&&(V=1/Math.sqrt(V)),C[0]=B*V,C[1]=O*V,C[2]=H*V,C[3]=E*V,C},u.dot=function(C,E){return C[0]*E[0]+C[1]*E[1]+C[2]*E[2]+C[3]*E[3]},u.cross=function(C,E,B,O){var H=B[0]*O[1]-B[1]*O[0],V=B[0]*O[2]-B[2]*O[0],G=B[0]*O[3]-B[3]*O[0],j=B[1]*O[2]-B[2]*O[1],Y=B[1]*O[3]-B[3]*O[1];B=B[2]*O[3]-B[3]*O[2],O=E[0];var $=E[1],it=E[2];return E=E[3],C[0]=$*B-it*Y+E*j,C[1]=-(O*B)+it*G-E*V,C[2]=O*Y-$*G+E*H,C[3]=-(O*j)+$*V-it*H,C},u.lerp=function(C,E,B,O){var H=E[0],V=E[1],G=E[2];return E=E[3],C[0]=H+O*(B[0]-H),C[1]=V+O*(B[1]-V),C[2]=G+O*(B[2]-G),C[3]=E+O*(B[3]-E),C},u.random=function(C,E){E=E||1;do var B=2*U.RANDOM()-1,O=2*U.RANDOM()-1,H=B*B+O*O;while(1<=H);do var V=2*U.RANDOM()-1,G=2*U.RANDOM()-1,j=V*V+G*G;while(1<=j);return H=Math.sqrt((1-H)/j),C[0]=E*B,C[1]=E*O,C[2]=E*V*H,C[3]=E*G*H,C},u.transformMat4=function(C,E,B){var O=E[0],H=E[1],V=E[2];return E=E[3],C[0]=B[0]*O+B[4]*H+B[8]*V+B[12]*E,C[1]=B[1]*O+B[5]*H+B[9]*V+B[13]*E,C[2]=B[2]*O+B[6]*H+B[10]*V+B[14]*E,C[3]=B[3]*O+B[7]*H+B[11]*V+B[15]*E,C},u.transformQuat=function(C,E,B){var O=E[0],H=E[1],V=E[2],G=B[0],j=B[1],Y=B[2];B=B[3];var $=B*O+j*V-Y*H,it=B*H+Y*O-G*V,nt=B*V+G*H-j*O;return O=-G*O-j*H-Y*V,C[0]=$*B+O*-G+it*-Y-nt*-j,C[1]=it*B+O*-j+nt*-G-$*-Y,C[2]=nt*B+O*-Y+$*-j-it*-G,C[3]=E[3],C},u.zero=function(C){return C[0]=0,C[1]=0,C[2]=0,C[3]=0,C},u.str=function(C){return"vec4("+C[0]+", "+C[1]+", "+C[2]+", "+C[3]+")"},u.exactEquals=function(C,E){return C[0]===E[0]&&C[1]===E[1]&&C[2]===E[2]&&C[3]===E[3]},u.equals=function(C,E){var B=C[0],O=C[1],H=C[2];C=C[3];var V=E[0],G=E[1],j=E[2];return E=E[3],Math.abs(B-V)<=U.EPSILON*Math.max(1,Math.abs(B),Math.abs(V))&&Math.abs(O-G)<=U.EPSILON*Math.max(1,Math.abs(O),Math.abs(G))&&Math.abs(H-j)<=U.EPSILON*Math.max(1,Math.abs(H),Math.abs(j))&&Math.abs(C-E)<=U.EPSILON*Math.max(1,Math.abs(C),Math.abs(E))},u.forEach=u.sqrLen=u.len=u.sqrDist=u.dist=u.div=u.mul=u.sub=void 0;var U=function(C){if(C&&C.__esModule)return C;var E={};if(C!=null){for(var B in C)if(Object.prototype.hasOwnProperty.call(C,B)){var O=Hn&&Gn?Gn(C,B):{};O.get||O.set?Hn(E,B,O):E[B]=C[B]}}return E.default=C,E}(za);u.sub=l,u.mul=v,u.div=d,u.dist=x,u.sqrDist=y,u.len=M,u.sqrLen=D,a=function(){var C=n();return function(E,B,O,H,V,G){for(B||(B=4),O||(O=0),H=H?Math.min(H*B+O,E.length):E.length;O<H;O+=B)C[0]=E[O],C[1]=E[O+1],C[2]=E[O+2],C[3]=E[O+3],V(C,C,G),E[O]=C[0],E[O+1]=C[1],E[O+2]=C[2],E[O+3]=C[3];return E}}(),u.forEach=a});Nt(rp);var ip=Rt(function(a,u){function n(B){if(B&&B.__esModule)return B;var O={};if(B!=null){for(var H in B)if(Object.prototype.hasOwnProperty.call(B,H)){var V=Hn&&Gn?Gn(B,H):{};V.get||V.set?Hn(O,H,V):O[H]=B[H]}}return O.default=B,O}function l(){var B=new M.ARRAY_TYPE(4);return M.ARRAY_TYPE!=Float32Array&&(B[0]=0,B[1]=0,B[2]=0),B[3]=1,B}function v(B,O,H){H*=.5;var V=Math.sin(H);return B[0]=V*O[0],B[1]=V*O[1],B[2]=V*O[2],B[3]=Math.cos(H),B}function d(B,O,H){var V=O[0],G=O[1],j=O[2];O=O[3];var Y=H[0],$=H[1],it=H[2];return H=H[3],B[0]=V*H+O*Y+G*it-j*$,B[1]=G*H+O*$+j*Y-V*it,B[2]=j*H+O*it+V*$-G*Y,B[3]=O*H-V*Y-G*$-j*it,B}function x(B,O,H,V){var G=O[0],j=O[1],Y=O[2];O=O[3];var $=H[0],it=H[1],nt=H[2];H=H[3];var dt=G*$+j*it+Y*nt+O*H;if(0>dt&&(dt=-dt,$=-$,it=-it,nt=-nt,H=-H),1-dt>M.EPSILON){var Et=Math.acos(dt),St=Math.sin(Et);dt=Math.sin((1-V)*Et)/St,V=Math.sin(V*Et)/St}else dt=1-V;return B[0]=dt*G+V*$,B[1]=dt*j+V*it,B[2]=dt*Y+V*nt,B[3]=dt*O+V*H,B}function y(B,O){var H=O[0]+O[4]+O[8];if(0<H)H=Math.sqrt(H+1),B[3]=.5*H,H=.5/H,B[0]=(O[5]-O[7])*H,B[1]=(O[6]-O[2])*H,B[2]=(O[1]-O[3])*H;else{var V=0;O[4]>O[0]&&(V=1),O[8]>O[3*V+V]&&(V=2);var G=(V+1)%3,j=(V+2)%3;H=Math.sqrt(O[3*V+V]-O[3*G+G]-O[3*j+j]+1),B[V]=.5*H,H=.5/H,B[3]=(O[3*G+j]-O[3*j+G])*H,B[G]=(O[3*G+V]+O[3*V+G])*H,B[j]=(O[3*j+V]+O[3*V+j])*H}return B}Object.defineProperty(u,"__esModule",{value:!0}),u.create=l,u.identity=function(B){return B[0]=0,B[1]=0,B[2]=0,B[3]=1,B},u.setAxisAngle=v,u.getAxisAngle=function(B,O){var H=2*Math.acos(O[3]),V=Math.sin(H/2);return V>M.EPSILON?(B[0]=O[0]/V,B[1]=O[1]/V,B[2]=O[2]/V):(B[0]=1,B[1]=0,B[2]=0),H},u.multiply=d,u.rotateX=function(B,O,H){H*=.5;var V=O[0],G=O[1],j=O[2];O=O[3];var Y=Math.sin(H);return H=Math.cos(H),B[0]=V*H+O*Y,B[1]=G*H+j*Y,B[2]=j*H-G*Y,B[3]=O*H-V*Y,B},u.rotateY=function(B,O,H){H*=.5;var V=O[0],G=O[1],j=O[2];O=O[3];var Y=Math.sin(H);return H=Math.cos(H),B[0]=V*H-j*Y,B[1]=G*H+O*Y,B[2]=j*H+V*Y,B[3]=O*H-G*Y,B},u.rotateZ=function(B,O,H){H*=.5;var V=O[0],G=O[1],j=O[2];O=O[3];var Y=Math.sin(H);return H=Math.cos(H),B[0]=V*H+G*Y,B[1]=G*H-V*Y,B[2]=j*H+O*Y,B[3]=O*H-j*Y,B},u.calculateW=function(B,O){var H=O[0],V=O[1];return O=O[2],B[0]=H,B[1]=V,B[2]=O,B[3]=Math.sqrt(Math.abs(1-H*H-V*V-O*O)),B},u.slerp=x,u.random=function(B){var O=M.RANDOM(),H=M.RANDOM(),V=M.RANDOM(),G=Math.sqrt(1-O);return O=Math.sqrt(O),B[0]=G*Math.sin(2*Math.PI*H),B[1]=G*Math.cos(2*Math.PI*H),B[2]=O*Math.sin(2*Math.PI*V),B[3]=O*Math.cos(2*Math.PI*V),B},u.invert=function(B,O){var H=O[0],V=O[1],G=O[2];O=O[3];var j=H*H+V*V+G*G+O*O;return j=j?1/j:0,B[0]=-H*j,B[1]=-V*j,B[2]=-G*j,B[3]=O*j,B},u.conjugate=function(B,O){return B[0]=-O[0],B[1]=-O[1],B[2]=-O[2],B[3]=O[3],B},u.fromMat3=y,u.fromEuler=function(B,O,H,V){var G=.5*Math.PI/180;O*=G,H*=G,V*=G,G=Math.sin(O),O=Math.cos(O);var j=Math.sin(H);H=Math.cos(H);var Y=Math.sin(V);return V=Math.cos(V),B[0]=G*H*V-O*j*Y,B[1]=O*j*V+G*H*Y,B[2]=O*H*Y-G*j*V,B[3]=O*H*V+G*j*Y,B},u.str=function(B){return"quat("+B[0]+", "+B[1]+", "+B[2]+", "+B[3]+")"},u.setAxes=u.sqlerp=u.rotationTo=u.equals=u.exactEquals=u.normalize=u.sqrLen=u.squaredLength=u.len=u.length=u.lerp=u.dot=u.scale=u.mul=u.add=u.set=u.copy=u.fromValues=u.clone=void 0;var M=n(za),D=n(lu),U=n(Zd);a=n(rp),u.clone=a.clone,u.fromValues=a.fromValues,u.copy=a.copy,u.set=a.set,u.add=a.add,u.mul=d,u.scale=a.scale,u.dot=a.dot,u.lerp=a.lerp;var C=a.length;u.length=C,u.len=C,C=a.squaredLength,u.squaredLength=C,u.sqrLen=C;var E=a.normalize;u.normalize=E,u.exactEquals=a.exactEquals,u.equals=a.equals,a=function(){var B=U.create(),O=U.fromValues(1,0,0),H=U.fromValues(0,1,0);return function(V,G,j){var Y=U.dot(G,j);return-.999999>Y?(U.cross(B,O,G),1e-6>U.len(B)&&U.cross(B,H,G),U.normalize(B,B),v(V,B,Math.PI),V):.999999<Y?(V[0]=0,V[1]=0,V[2]=0,V[3]=1,V):(U.cross(B,G,j),V[0]=B[0],V[1]=B[1],V[2]=B[2],V[3]=1+Y,E(V,V))}}(),u.rotationTo=a,a=function(){var B=l(),O=l();return function(H,V,G,j,Y,$){return x(B,V,Y,$),x(O,G,j,$),x(H,B,O,2*$*(1-$)),H}}(),u.sqlerp=a,a=function(){var B=D.create();return function(O,H,V,G){return B[0]=V[0],B[3]=V[1],B[6]=V[2],B[1]=G[0],B[4]=G[1],B[7]=G[2],B[2]=-H[0],B[5]=-H[1],B[8]=-H[2],E(O,y(O,B))}}(),u.setAxes=a});Nt(ip);var iv=Rt(function(a,u){function n(C){if(C&&C.__esModule)return C;var E={};if(C!=null){for(var B in C)if(Object.prototype.hasOwnProperty.call(C,B)){var O=Hn&&Gn?Gn(C,B):{};O.get||O.set?Hn(E,B,O):E[B]=C[B]}}return E.default=C,E}function l(C,E,B){var O=.5*B[0],H=.5*B[1];B=.5*B[2];var V=E[0],G=E[1],j=E[2];return E=E[3],C[0]=V,C[1]=G,C[2]=j,C[3]=E,C[4]=O*E+H*j-B*G,C[5]=H*E+B*V-O*j,C[6]=B*E+O*G-H*V,C[7]=-O*V-H*G-B*j,C}function v(C,E){return C[0]=E[0],C[1]=E[1],C[2]=E[2],C[3]=E[3],C[4]=E[4],C[5]=E[5],C[6]=E[6],C[7]=E[7],C}function d(C,E,B){var O=E[0],H=E[1],V=E[2],G=E[3],j=B[4],Y=B[5],$=B[6],it=B[7],nt=E[4],dt=E[5],Et=E[6];E=E[7];var St=B[0],Xt=B[1],te=B[2];return B=B[3],C[0]=O*B+G*St+H*te-V*Xt,C[1]=H*B+G*Xt+V*St-O*te,C[2]=V*B+G*te+O*Xt-H*St,C[3]=G*B-O*St-H*Xt-V*te,C[4]=O*it+G*j+H*$-V*Y+nt*B+E*St+dt*te-Et*Xt,C[5]=H*it+G*Y+V*j-O*$+dt*B+E*Xt+Et*St-nt*te,C[6]=V*it+G*$+O*Y-H*j+Et*B+E*te+nt*Xt-dt*St,C[7]=G*it-O*j-H*Y-V*$+E*B-nt*St-dt*Xt-Et*te,C}Object.defineProperty(u,"__esModule",{value:!0}),u.create=function(){var C=new x.ARRAY_TYPE(8);return x.ARRAY_TYPE!=Float32Array&&(C[0]=0,C[1]=0,C[2]=0,C[4]=0,C[5]=0,C[6]=0,C[7]=0),C[3]=1,C},u.clone=function(C){var E=new x.ARRAY_TYPE(8);return E[0]=C[0],E[1]=C[1],E[2]=C[2],E[3]=C[3],E[4]=C[4],E[5]=C[5],E[6]=C[6],E[7]=C[7],E},u.fromValues=function(C,E,B,O,H,V,G,j){var Y=new x.ARRAY_TYPE(8);return Y[0]=C,Y[1]=E,Y[2]=B,Y[3]=O,Y[4]=H,Y[5]=V,Y[6]=G,Y[7]=j,Y},u.fromRotationTranslationValues=function(C,E,B,O,H,V,G){var j=new x.ARRAY_TYPE(8);return j[0]=C,j[1]=E,j[2]=B,j[3]=O,H*=.5,V*=.5,G*=.5,j[4]=H*O+V*B-G*E,j[5]=V*O+G*C-H*B,j[6]=G*O+H*E-V*C,j[7]=-H*C-V*E-G*B,j},u.fromRotationTranslation=l,u.fromTranslation=function(C,E){return C[0]=0,C[1]=0,C[2]=0,C[3]=1,C[4]=.5*E[0],C[5]=.5*E[1],C[6]=.5*E[2],C[7]=0,C},u.fromRotation=function(C,E){return C[0]=E[0],C[1]=E[1],C[2]=E[2],C[3]=E[3],C[4]=0,C[5]=0,C[6]=0,C[7]=0,C},u.fromMat4=function(C,E){var B=y.create();M.getRotation(B,E);var O=new x.ARRAY_TYPE(3);return M.getTranslation(O,E),l(C,B,O),C},u.copy=v,u.identity=function(C){return C[0]=0,C[1]=0,C[2]=0,C[3]=1,C[4]=0,C[5]=0,C[6]=0,C[7]=0,C},u.set=function(C,E,B,O,H,V,G,j,Y){return C[0]=E,C[1]=B,C[2]=O,C[3]=H,C[4]=V,C[5]=G,C[6]=j,C[7]=Y,C},u.getDual=function(C,E){return C[0]=E[4],C[1]=E[5],C[2]=E[6],C[3]=E[7],C},u.setDual=function(C,E){return C[4]=E[0],C[5]=E[1],C[6]=E[2],C[7]=E[3],C},u.getTranslation=function(C,E){var B=E[4],O=E[5],H=E[6],V=E[7],G=-E[0],j=-E[1],Y=-E[2];return E=E[3],C[0]=2*(B*E+V*G+O*Y-H*j),C[1]=2*(O*E+V*j+H*G-B*Y),C[2]=2*(H*E+V*Y+B*j-O*G),C},u.translate=function(C,E,B){var O=E[0],H=E[1],V=E[2],G=E[3],j=.5*B[0],Y=.5*B[1];B=.5*B[2];var $=E[4],it=E[5],nt=E[6];return E=E[7],C[0]=O,C[1]=H,C[2]=V,C[3]=G,C[4]=G*j+H*B-V*Y+$,C[5]=G*Y+V*j-O*B+it,C[6]=G*B+O*Y-H*j+nt,C[7]=-O*j-H*Y-V*B+E,C},u.rotateX=function(C,E,B){var O=-E[0],H=-E[1],V=-E[2],G=E[3],j=E[4],Y=E[5],$=E[6],it=E[7],nt=j*G+it*O+Y*V-$*H,dt=Y*G+it*H+$*O-j*V,Et=$*G+it*V+j*H-Y*O;return j=it*G-j*O-Y*H-$*V,y.rotateX(C,E,B),O=C[0],H=C[1],V=C[2],G=C[3],C[4]=nt*G+j*O+dt*V-Et*H,C[5]=dt*G+j*H+Et*O-nt*V,C[6]=Et*G+j*V+nt*H-dt*O,C[7]=j*G-nt*O-dt*H-Et*V,C},u.rotateY=function(C,E,B){var O=-E[0],H=-E[1],V=-E[2],G=E[3],j=E[4],Y=E[5],$=E[6],it=E[7],nt=j*G+it*O+Y*V-$*H,dt=Y*G+it*H+$*O-j*V,Et=$*G+it*V+j*H-Y*O;return j=it*G-j*O-Y*H-$*V,y.rotateY(C,E,B),O=C[0],H=C[1],V=C[2],G=C[3],C[4]=nt*G+j*O+dt*V-Et*H,C[5]=dt*G+j*H+Et*O-nt*V,C[6]=Et*G+j*V+nt*H-dt*O,C[7]=j*G-nt*O-dt*H-Et*V,C},u.rotateZ=function(C,E,B){var O=-E[0],H=-E[1],V=-E[2],G=E[3],j=E[4],Y=E[5],$=E[6],it=E[7],nt=j*G+it*O+Y*V-$*H,dt=Y*G+it*H+$*O-j*V,Et=$*G+it*V+j*H-Y*O;return j=it*G-j*O-Y*H-$*V,y.rotateZ(C,E,B),O=C[0],H=C[1],V=C[2],G=C[3],C[4]=nt*G+j*O+dt*V-Et*H,C[5]=dt*G+j*H+Et*O-nt*V,C[6]=Et*G+j*V+nt*H-dt*O,C[7]=j*G-nt*O-dt*H-Et*V,C},u.rotateByQuatAppend=function(C,E,B){var O=B[0],H=B[1],V=B[2];B=B[3];var G=E[0],j=E[1],Y=E[2],$=E[3];return C[0]=G*B+$*O+j*V-Y*H,C[1]=j*B+$*H+Y*O-G*V,C[2]=Y*B+$*V+G*H-j*O,C[3]=$*B-G*O-j*H-Y*V,G=E[4],j=E[5],Y=E[6],$=E[7],C[4]=G*B+$*O+j*V-Y*H,C[5]=j*B+$*H+Y*O-G*V,C[6]=Y*B+$*V+G*H-j*O,C[7]=$*B-G*O-j*H-Y*V,C},u.rotateByQuatPrepend=function(C,E,B){var O=E[0],H=E[1],V=E[2];E=E[3];var G=B[0],j=B[1],Y=B[2],$=B[3];return C[0]=O*$+E*G+H*Y-V*j,C[1]=H*$+E*j+V*G-O*Y,C[2]=V*$+E*Y+O*j-H*G,C[3]=E*$-O*G-H*j-V*Y,G=B[4],j=B[5],Y=B[6],$=B[7],C[4]=O*$+E*G+H*Y-V*j,C[5]=H*$+E*j+V*G-O*Y,C[6]=V*$+E*Y+O*j-H*G,C[7]=E*$-O*G-H*j-V*Y,C},u.rotateAroundAxis=function(C,E,B,O){if(Math.abs(O)<x.EPSILON)return v(C,E);var H=Math.sqrt(B[0]*B[0]+B[1]*B[1]+B[2]*B[2]);O*=.5;var V=Math.sin(O),G=V*B[0]/H,j=V*B[1]/H;B=V*B[2]/H,O=Math.cos(O),H=E[0],V=E[1];var Y=E[2],$=E[3];return C[0]=H*O+$*G+V*B-Y*j,C[1]=V*O+$*j+Y*G-H*B,C[2]=Y*O+$*B+H*j-V*G,C[3]=$*O-H*G-V*j-Y*B,H=E[4],V=E[5],Y=E[6],E=E[7],C[4]=H*O+E*G+V*B-Y*j,C[5]=V*O+E*j+Y*G-H*B,C[6]=Y*O+E*B+H*j-V*G,C[7]=E*O-H*G-V*j-Y*B,C},u.add=function(C,E,B){return C[0]=E[0]+B[0],C[1]=E[1]+B[1],C[2]=E[2]+B[2],C[3]=E[3]+B[3],C[4]=E[4]+B[4],C[5]=E[5]+B[5],C[6]=E[6]+B[6],C[7]=E[7]+B[7],C},u.multiply=d,u.scale=function(C,E,B){return C[0]=E[0]*B,C[1]=E[1]*B,C[2]=E[2]*B,C[3]=E[3]*B,C[4]=E[4]*B,C[5]=E[5]*B,C[6]=E[6]*B,C[7]=E[7]*B,C},u.lerp=function(C,E,B,O){var H=1-O;return 0>D(E,B)&&(O=-O),C[0]=E[0]*H+B[0]*O,C[1]=E[1]*H+B[1]*O,C[2]=E[2]*H+B[2]*O,C[3]=E[3]*H+B[3]*O,C[4]=E[4]*H+B[4]*O,C[5]=E[5]*H+B[5]*O,C[6]=E[6]*H+B[6]*O,C[7]=E[7]*H+B[7]*O,C},u.invert=function(C,E){var B=U(E);return C[0]=-E[0]/B,C[1]=-E[1]/B,C[2]=-E[2]/B,C[3]=E[3]/B,C[4]=-E[4]/B,C[5]=-E[5]/B,C[6]=-E[6]/B,C[7]=E[7]/B,C},u.conjugate=function(C,E){return C[0]=-E[0],C[1]=-E[1],C[2]=-E[2],C[3]=E[3],C[4]=-E[4],C[5]=-E[5],C[6]=-E[6],C[7]=E[7],C},u.normalize=function(C,E){var B=U(E);if(0<B){B=Math.sqrt(B);var O=E[0]/B,H=E[1]/B,V=E[2]/B,G=E[3]/B,j=E[4],Y=E[5],$=E[6];E=E[7];var it=O*j+H*Y+V*$+G*E;C[0]=O,C[1]=H,C[2]=V,C[3]=G,C[4]=(j-O*it)/B,C[5]=(Y-H*it)/B,C[6]=($-V*it)/B,C[7]=(E-G*it)/B}return C},u.str=function(C){return"quat2("+C[0]+", "+C[1]+", "+C[2]+", "+C[3]+", "+C[4]+", "+C[5]+", "+C[6]+", "+C[7]+")"},u.exactEquals=function(C,E){return C[0]===E[0]&&C[1]===E[1]&&C[2]===E[2]&&C[3]===E[3]&&C[4]===E[4]&&C[5]===E[5]&&C[6]===E[6]&&C[7]===E[7]},u.equals=function(C,E){var B=C[0],O=C[1],H=C[2],V=C[3],G=C[4],j=C[5],Y=C[6];C=C[7];var $=E[0],it=E[1],nt=E[2],dt=E[3],Et=E[4],St=E[5],Xt=E[6];return E=E[7],Math.abs(B-$)<=x.EPSILON*Math.max(1,Math.abs(B),Math.abs($))&&Math.abs(O-it)<=x.EPSILON*Math.max(1,Math.abs(O),Math.abs(it))&&Math.abs(H-nt)<=x.EPSILON*Math.max(1,Math.abs(H),Math.abs(nt))&&Math.abs(V-dt)<=x.EPSILON*Math.max(1,Math.abs(V),Math.abs(dt))&&Math.abs(G-Et)<=x.EPSILON*Math.max(1,Math.abs(G),Math.abs(Et))&&Math.abs(j-St)<=x.EPSILON*Math.max(1,Math.abs(j),Math.abs(St))&&Math.abs(Y-Xt)<=x.EPSILON*Math.max(1,Math.abs(Y),Math.abs(Xt))&&Math.abs(C-E)<=x.EPSILON*Math.max(1,Math.abs(C),Math.abs(E))},u.sqrLen=u.squaredLength=u.len=u.length=u.dot=u.mul=u.setReal=u.getReal=void 0;var x=n(za),y=n(ip),M=n(Yd);u.getReal=y.copy,u.setReal=y.copy,u.mul=d;var D=y.dot;u.dot=D,a=y.length,u.length=a,u.len=a;var U=y.squaredLength;u.squaredLength=U,u.sqrLen=U});Nt(iv);var Jd=Rt(function(a,u){function n(){var C=new U.ARRAY_TYPE(2);return U.ARRAY_TYPE!=Float32Array&&(C[0]=0,C[1]=0),C}function l(C,E,B){return C[0]=E[0]-B[0],C[1]=E[1]-B[1],C}function v(C,E,B){return C[0]=E[0]*B[0],C[1]=E[1]*B[1],C}function d(C,E,B){return C[0]=E[0]/B[0],C[1]=E[1]/B[1],C}function x(C,E){var B=E[0]-C[0];return C=E[1]-C[1],Math.sqrt(B*B+C*C)}function y(C,E){var B=E[0]-C[0];return C=E[1]-C[1],B*B+C*C}function M(C){var E=C[0];return C=C[1],Math.sqrt(E*E+C*C)}function D(C){var E=C[0];return C=C[1],E*E+C*C}Object.defineProperty(u,"__esModule",{value:!0}),u.create=n,u.clone=function(C){var E=new U.ARRAY_TYPE(2);return E[0]=C[0],E[1]=C[1],E},u.fromValues=function(C,E){var B=new U.ARRAY_TYPE(2);return B[0]=C,B[1]=E,B},u.copy=function(C,E){return C[0]=E[0],C[1]=E[1],C},u.set=function(C,E,B){return C[0]=E,C[1]=B,C},u.add=function(C,E,B){return C[0]=E[0]+B[0],C[1]=E[1]+B[1],C},u.subtract=l,u.multiply=v,u.divide=d,u.ceil=function(C,E){return C[0]=Math.ceil(E[0]),C[1]=Math.ceil(E[1]),C},u.floor=function(C,E){return C[0]=Math.floor(E[0]),C[1]=Math.floor(E[1]),C},u.min=function(C,E,B){return C[0]=Math.min(E[0],B[0]),C[1]=Math.min(E[1],B[1]),C},u.max=function(C,E,B){return C[0]=Math.max(E[0],B[0]),C[1]=Math.max(E[1],B[1]),C},u.round=function(C,E){return C[0]=Math.round(E[0]),C[1]=Math.round(E[1]),C},u.scale=function(C,E,B){return C[0]=E[0]*B,C[1]=E[1]*B,C},u.scaleAndAdd=function(C,E,B,O){return C[0]=E[0]+B[0]*O,C[1]=E[1]+B[1]*O,C},u.distance=x,u.squaredDistance=y,u.length=M,u.squaredLength=D,u.negate=function(C,E){return C[0]=-E[0],C[1]=-E[1],C},u.inverse=function(C,E){return C[0]=1/E[0],C[1]=1/E[1],C},u.normalize=function(C,E){var B=E[0],O=E[1];return B=B*B+O*O,0<B&&(B=1/Math.sqrt(B)),C[0]=E[0]*B,C[1]=E[1]*B,C},u.dot=function(C,E){return C[0]*E[0]+C[1]*E[1]},u.cross=function(C,E,B){return E=E[0]*B[1]-E[1]*B[0],C[0]=C[1]=0,C[2]=E,C},u.lerp=function(C,E,B,O){var H=E[0];return E=E[1],C[0]=H+O*(B[0]-H),C[1]=E+O*(B[1]-E),C},u.random=function(C,E){E=E||1;var B=2*U.RANDOM()*Math.PI;return C[0]=Math.cos(B)*E,C[1]=Math.sin(B)*E,C},u.transformMat2=function(C,E,B){var O=E[0];return E=E[1],C[0]=B[0]*O+B[2]*E,C[1]=B[1]*O+B[3]*E,C},u.transformMat2d=function(C,E,B){var O=E[0];return E=E[1],C[0]=B[0]*O+B[2]*E+B[4],C[1]=B[1]*O+B[3]*E+B[5],C},u.transformMat3=function(C,E,B){var O=E[0];return E=E[1],C[0]=B[0]*O+B[3]*E+B[6],C[1]=B[1]*O+B[4]*E+B[7],C},u.transformMat4=function(C,E,B){var O=E[0];return E=E[1],C[0]=B[0]*O+B[4]*E+B[12],C[1]=B[1]*O+B[5]*E+B[13],C},u.rotate=function(C,E,B,O){var H=E[0]-B[0];E=E[1]-B[1];var V=Math.sin(O);return O=Math.cos(O),C[0]=H*O-E*V+B[0],C[1]=H*V+E*O+B[1],C},u.angle=function(C,E){var B=C[0];C=C[1];var O=E[0];E=E[1];var H=B*B+C*C;0<H&&(H=1/Math.sqrt(H));var V=O*O+E*E;return 0<V&&(V=1/Math.sqrt(V)),B=(B*O+C*E)*H*V,1<B?0:-1>B?Math.PI:Math.acos(B)},u.zero=function(C){return C[0]=0,C[1]=0,C},u.str=function(C){return"vec2("+C[0]+", "+C[1]+")"},u.exactEquals=function(C,E){return C[0]===E[0]&&C[1]===E[1]},u.equals=function(C,E){var B=C[0];C=C[1];var O=E[0];return E=E[1],Math.abs(B-O)<=U.EPSILON*Math.max(1,Math.abs(B),Math.abs(O))&&Math.abs(C-E)<=U.EPSILON*Math.max(1,Math.abs(C),Math.abs(E))},u.forEach=u.sqrLen=u.sqrDist=u.dist=u.div=u.mul=u.sub=u.len=void 0;var U=function(C){if(C&&C.__esModule)return C;var E={};if(C!=null){for(var B in C)if(Object.prototype.hasOwnProperty.call(C,B)){var O=Hn&&Gn?Gn(C,B):{};O.get||O.set?Hn(E,B,O):E[B]=C[B]}}return E.default=C,E}(za);u.len=M,u.sub=l,u.mul=v,u.div=d,u.dist=x,u.sqrDist=y,u.sqrLen=D,a=function(){var C=n();return function(E,B,O,H,V,G){for(B||(B=2),O||(O=0),H=H?Math.min(H*B+O,E.length):E.length;O<H;O+=B)C[0]=E[O],C[1]=E[O+1],V(C,C,G),E[O]=C[0],E[O+1]=C[1];return E}}(),u.forEach=a});Nt(Jd);var $o=Rt(function(a,u){function n(l){if(l&&l.__esModule)return l;var v={};if(l!=null){for(var d in l)if(Object.prototype.hasOwnProperty.call(l,d)){var x=Hn&&Gn?Gn(l,d):{};x.get||x.set?Hn(v,d,x):v[d]=l[d]}}return v.default=l,v}Object.defineProperty(u,"__esModule",{value:!0}),u.vec4=u.vec3=u.vec2=u.quat2=u.quat=u.mat4=u.mat3=u.mat2d=u.mat2=u.glMatrix=void 0,a=n(za),u.glMatrix=a,a=n(Pc),u.mat2=a,a=n(ep),u.mat2d=a,a=n(lu),u.mat3=a,a=n(Yd),u.mat4=a,a=n(ip),u.quat=a,a=n(iv),u.quat2=a,a=n(Jd),u.vec2=a,a=n(Zd),u.vec3=a,a=n(rp),u.vec4=a});Nt($o);var sn=$o.vec4,Dr=$o.vec3,di=$o.vec2,oA=$o.quat2,np=$o.quat,rr=$o.mat4,v1=$o.mat3,y1=$o.mat2d,nv=$o.mat2,ov=$o.glMatrix,ii=function(){function a(u,n,l){Ye(this,a),this.options=n,this.gl=u,l&&(this.map=l.map),l=this.getVertexShader(n.vertexShader);var v=this.getFragmentShader(n.fragmentShader);n=u.createShader(u.VERTEX_SHADER),u.shaderSource(n,l),u.compileShader(n),u.getShaderParameter(n,u.COMPILE_STATUS)?(l=u.createShader(u.FRAGMENT_SHADER),u.shaderSource(l,v),u.compileShader(l),u.getShaderParameter(l,u.COMPILE_STATUS)?(v=u.createProgram(),u.attachShader(v,n),u.attachShader(v,l),u.deleteShader(n),u.deleteShader(l),u.linkProgram(v),u.getProgramParameter(v,u.LINK_STATUS)?n=v:(n="Shader program failed to link.  The error log is:"+u.getProgramInfoLog(v),console.error(n),n=-1)):(n="Fragment shader failed to compile.  The error log is:"+u.getShaderInfoLog(l),console.error(n),n=-1)):(n="Vertex shader failed to compile.  The error log is:"+u.getShaderInfoLog(n),console.error(n),n=-1),n=this.program=n,l={},v=u.getProgramParameter(n,u.ACTIVE_ATTRIBUTES);for(var d=0;d<v;d++){var x=u.getActiveAttrib(n,d);l[x.name]=u.getAttribLocation(n,x.name)}d={},x={};for(var y=u.getProgramParameter(n,u.ACTIVE_UNIFORMS),M=0;M<y;M++){var D=u.getActiveUniform(n,M);d[D.name]=u.getUniformLocation(n,D.name),x[D.name]=D.type}this.parameter=u={attributes:l,numAttributes:v,uniformsType:x,uniforms:d},this.attributes=u.attributes,this.uniforms=u.uniforms,this.parameter=u}return qe(a,[{key:"getVertexShader",value:function(u){var n="";return this.map&&this.map.type==="cesium"&&(n=`#define LOG_DEPTH
`),n+=`#ifdef LOG_DEPTH
uniform float currentFrustumX;varying float v_depthFromNearPlusOne;
#endif
uniform vec2 MAPV_resolution;
#if defined(PICK)
uniform bool uIsPickRender;attribute vec3 aPickColor;uniform vec3 uPickedColor;varying vec4 vPickColor;uniform bool uEnablePicked;bool mapvIsPicked(){return uEnablePicked&&aPickColor==uPickedColor;}
#endif
void afterMain(){
#if defined(LOG_DEPTH)
v_depthFromNearPlusOne=(gl_Position.w-currentFrustumX)+1.0;gl_Position.z=clamp(gl_Position.z/gl_Position.w,-1.0,1.0)*gl_Position.w;
#endif
#if defined(PICK)
vPickColor=vec4(aPickColor,0.0);if(mapvIsPicked()){vPickColor.a=1.0;}
#endif
}`,u=this.getDefines()+n+u,u=u.replace("void main","void originMain"),u+"void main() {originMain(); afterMain();}"}},{key:"getFragmentShader",value:function(u){var n="";return this.map&&this.map.type==="cesium"&&(n=`#define LOG_DEPTH
`),n+=`#if defined(LOG_DEPTH)
#extension GL_EXT_frag_depth : enable
#endif
precision highp float;uniform vec2 MAPV_resolution;uniform bool uIsPickRender;
#if defined(PICK)
varying vec4 vPickColor;bool mapvIsPicked(){return vPickColor.a==1.0;}
#endif
#if defined(LOG_DEPTH)
uniform float oneOverLog2FarDepthFromNearPlusOne;uniform float farDepthFromNearPlusOne;varying float v_depthFromNearPlusOne;void writeLogDepth(float depth){if(depth<=0.9999999||depth>farDepthFromNearPlusOne){discard;}gl_FragDepthEXT=log2(depth)*oneOverLog2FarDepthFromNearPlusOne;}
#endif
void afterMain(){
#if defined(PICK)
if(uIsPickRender){gl_FragColor=vec4(vPickColor.rgb,1.0);return;}
#endif
#if defined(LOG_DEPTH)
writeLogDepth(v_depthFromNearPlusOne);
#endif
}`,u=this.getDefines()+n+u,u=u.replace("void main","void originMain"),u+"void main() {originMain(); afterMain();}"}},{key:"getDefines",value:function(){var u="",n=this.options.defines;if(n)for(var l=0;l<n.length;l++)u+="#define "+n[l]+`
`;return u}},{key:"use",value:function(u,n){this.gl=u,u.useProgram(this.program),this.map&&this.map.type==="cesium"&&this.setUniforms({currentFrustumX:this.map.map.scene.camera.frustum.near,oneOverLog2FarDepthFromNearPlusOne:this.map.map.scene.context.uniformState.oneOverLog2FarDepthFromNearPlusOne,farDepthFromNearPlusOne:this.map.map.scene.context.uniformState.farDepthFromNearPlusOne}),this.uniforms.MAPV_resolution&&this.setUniforms({MAPV_resolution:[u.canvas.width,u.canvas.height]})}},{key:"setUniform",value:function(u,n){var l=this.gl,v=this.uniforms[u];if(v)switch(this.parameter.uniformsType[u]){case l.FLOAT:l.uniform1f(v,n);break;case l.FLOAT_VEC2:l.uniform2f(v,n[0],n[1]);break;case l.FLOAT_VEC3:l.uniform3f(v,n[0],n[1],n[2]);break;case l.FLOAT_VEC4:l.uniform4f(v,n[0],n[1],n[2],n[3]);break;case l.SAMPLER_2D:case l.SAMPLER_CUBE:l.activeTexture(l["TEXTURE"+this.textureIndex]),l.uniform1i(v,this.textureIndex),l.bindTexture(l.TEXTURE_2D,n),this.textureIndex++;break;case l.INT:case l.BOOL:l.uniform1i(v,n);break;case l.INT_VEC2:case l.BOOL_VEC2:l.uniform2i(v,n[0],n[1]);break;case l.INT_VEC3:case l.BOOL_VEC3:l.uniform3i(v,n[0],n[1],n[2]);break;case l.INT_VEC4:case l.BOOL_VEC4:l.uniform4i(v,n[0],n[1],n[2],n[3]);break;case l.FLOAT_MAT2:l.uniformMatrix2fv(v,!1,n);break;case l.FLOAT_MAT3:l.uniformMatrix3fv(v,!1,n);break;case l.FLOAT_MAT4:l.uniformMatrix4fv(v,!1,n);break;default:console.error("Unrecognized uniform type: "+u)}else console.warn("Unrecognized uniform type: "+u)}},{key:"setUniforms",value:function(u){this.textureIndex=0;for(var n in u)this.setUniform(n,u[n])}}]),a}(),Qs=function(a,u,n,l){var v=n?n.call(l,a,u):void 0;if(v!==void 0)return!!v;if(a===u)return!0;if((typeof a=="undefined"?"undefined":si(a))!=="object"||!a||(typeof u=="undefined"?"undefined":si(u))!=="object"||!u)return!1;var d=Un(a),x=Un(u);if(d.length!==x.length)return!1;x=Object.prototype.hasOwnProperty.bind(u);for(var y=0;y<d.length;y++){if(v=d[y],!x(v))return!1;var M=a[v],D=u[v];if(v=n?n.call(l,M,D,v):void 0,v===!1||v===void 0&&M!==D)return!1}return!0},sv=function(){function a(u){Ye(this,a),this.options=u,this.gl=u.gl,this.savedState=[],this.currentState=this.getDefaultState()}return qe(a,[{key:"setDefaultState",value:function(){this.setState()}},{key:"getDefaultState",value:function(){var u=this.gl;return{blend:!1,blendEquation:u.FUNC_ADD,blendFunc:[u.ONE,u.ZERO],depthMask:!0,depthTest:!0,depthFunc:u.LEQUAL,polygonOffset:[0,0],cullFace:!1,stencilTest:!1}}},{key:"getRealState",value:function(){var u=this.gl;return{blend:u.getParameter(u.BLEND),blendEquation:u.getParameter(u.BLEND_EQUATION),depthMask:u.getParameter(u.DEPTH_WRITEMASK),depthTest:u.getParameter(u.DEPTH_TEST),depthFunc:u.getParameter(u.DEPTH_FUNC),polygonOffset:[u.getParameter(u.POLYGON_OFFSET_FACTOR),u.getParameter(u.POLYGON_OFFSET_UNITS)],cullFace:u.getParameter(u.CULL_FACE),stencilTest:u.getParameter(u.STENCIL_TEST)}}},{key:"getCurrentState",value:function(){return this.currentState}},{key:"save",value:function(){this.savedState.push(this.getCurrentState())}},{key:"restore",value:function(){var u=this.savedState.pop();this.setState(u,{force:!0})}},{key:"setState",value:function(u){var n=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};u=Ur(this.getDefaultState(),u),this.setBlend(u,n),this.setDepth(u,n),this.setCullFace(u,n),this.setPolygonOffset(u,n),this.setStencil(u,n),this.currentState=u}},{key:"setBlend",value:function(u,n){var l=this.gl,v=this.getCurrentState();((n=n.force)||!Qs(u.blend,v.blend))&&(u.blend?l.enable(l.BLEND):l.disable(l.BLEND)),!n&&Qs(u.blendEquation,v.blendEquation)||l.blendEquation(u.blendEquation),(n||!Qs(u.blendFunc,v.blendFunc))&&(u.blendFunc.length===2?l.blendFunc(u.blendFunc[0],u.blendFunc[1]):u.blendFunc.length===4&&l.blendFuncSeparate(u.blendFunc[0],u.blendFunc[1],u.blendFunc[2],u.blendFunc[3]))}},{key:"setDepth",value:function(u,n){var l=this.gl,v=this.getCurrentState();((n=n.force)||!Qs(u.depthTest,v.depthTest))&&(u.depthTest?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST)),(n||!Qs(u.depthMask,v.depthMask))&&(u.depthMask?l.depthMask(!0):l.depthMask(!1)),!n&&Qs(u.depthFunc,v.depthFunc)||l.depthFunc(u.depthFunc)}},{key:"setPolygonOffset",value:function(u,n){var l=this.gl,v=this.getCurrentState();(n.force||!Qs(u.polygonOffset,v.polygonOffset))&&(u.polygonOffset[0]!==0&&u.polygonOffset[1]!==0?l.enable(l.POLYGON_OFFSET_FILL):l.disable(l.POLYGON_OFFSET_FILL),l.polygonOffset(u.polygonOffset[0],u.polygonOffset[1]))}},{key:"setCullFace",value:function(u,n){var l=this.gl,v=this.getCurrentState();(n.force||!Qs(u.cullFace,v.cullFace))&&(u.cullFace?(l.enable(l.CULL_FACE),l.cullFace(l.BACK)):l.disable(l.CULL_FACE))}},{key:"setStencil",value:function(u,n){var l=this.gl,v=this.getCurrentState();(n.force||!Qs(u.stencilTest,v.stencilTest))&&(u.stencilTest?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST))}}]),a}(),Ke=function(){function a(u){Ye(this,a),this.options=u,this.gl=u.gl,this.buffer=this.gl.createBuffer(),u.data&&this.updateData(u.data)}return qe(a,[{key:"updateData",value:function(u){var n=this.options,l=this.gl;this.bind(),l.bufferData(l[n.target],u,l[n.usage])}},{key:"bind",value:function(u){u=u||this.gl,u.bindBuffer(u[this.options.target],this.buffer)}},{key:"unBind",value:function(u){u=u||this.gl,u.bindBuffer(u[this.options.target],null)}},{key:"destroy",value:function(){this.buffer=null}}]),a}(),x1={BYTE:1,UNSIGNED_BYTE:1,SHORT:2,UNSIGNED_SHORT:2,FLOAT:4},pn=function(){function a(u){for(Ye(this,a),this.options=u,this.attributes=u.attributes,this.gl=u.gl,this.program=u.program,u=this.stride=0;u<this.attributes.length;u++)this.stride+=x1[this.attributes[u].type]*this.attributes[u].size}return qe(a,[{key:"setVertexAttribPointers",value:function(){for(var u=this.gl,n=this.program,l=0;l<this.attributes.length;l++){var v=this.attributes[l],d=n.attributes[v.name];d!==void 0&&(v.buffer.bind(u),u.vertexAttribPointer(d,v.size,u[v.type],v.normalize||!1,v.stride!==void 0?v.stride:this.stride,v.offset),u.enableVertexAttribArray(d))}}},{key:"bind",value:function(){this.setVertexAttribPointers()}},{key:"destroy",value:function(){}}]),a}(),ao=function a(u,n,l){Ye(this,a),n=n||u.canvas.width,l=l||u.canvas.height;var v=u.createFramebuffer(),d=u.createTexture();u.bindTexture(u.TEXTURE_2D,d),u.texImage2D(u.TEXTURE_2D,0,u.RGBA,n,l,0,u.RGBA,u.UNSIGNED_BYTE,null),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),v.texture=d;var x=u.createRenderbuffer();u.bindRenderbuffer(u.RENDERBUFFER,x),u.renderbufferStorage(u.RENDERBUFFER,u.DEPTH_STENCIL,n,l),v.depthBuffer=x,u.bindFramebuffer(u.FRAMEBUFFER,v),u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,d,0),u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.RENDERBUFFER,x),n=u.checkFramebufferStatus(u.FRAMEBUFFER),u.FRAMEBUFFER_COMPLETE===n&&(u.bindFramebuffer(u.FRAMEBUFFER,null),u.bindTexture(u.TEXTURE_2D,null),u.bindRenderbuffer(u.RENDERBUFFER,null),this.framebuffer=v)},Lh=function(){function a(u){Ye(this,a),this.options={},Ur(this.options,u),this.vertex=[-1,1,0,-1,-1,0,1,1,0,1,1,0,-1,-1,0,1,-1,0],this.sampleCoord=[0,1,0,0,1,1,1,1,0,0,1,0]}return qe(a,[{key:"getOptions",value:function(){return this.options}},{key:"onResize",value:function(u){}},{key:"render",value:function(u){var n=u.gl;u=u.texture;var l=this.programSample;n.useProgram(l.program);var v=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,v);var d=[-1,-1,0,-1,1,0,1,1,0,1,1,0,-1,-1,0,1,-1,0];n.bufferData(n.ARRAY_BUFFER,new Float32Array(d),n.STATIC_DRAW),n.enableVertexAttribArray(l.attributes.aPos),n.vertexAttribPointer(l.attributes.aPos,3,n.FLOAT,!1,0,0),v=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,v),n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,1,1,1,0,0,1,0]),n.STATIC_DRAW),n.enableVertexAttribArray(l.attributes.aTextureCoord),n.vertexAttribPointer(l.attributes.aTextureCoord,2,n.FLOAT,!1,0,0),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,u),n.uniform1i(l.uniforms.uSampler,0),n.drawArrays(n.TRIANGLES,0,d.length/3)}}]),a}(),av=function(a){function u(n){return Ye(this,u),Pr(this,(u.__proto__||lr(u)).call(this,n))}return Rr(u,a),qe(u,[{key:"getProgram",value:function(n){return this.programSample||(this.programSample=new ii(n,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(void){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision highp float;uniform sampler2D uSampler;uniform vec2 canvasSize;varying vec2 vTextureCoord;vec4 fxaa_2_0(sampler2D tex,vec2 fragCoord,vec2 resolution,vec2 v_rgbNW,vec2 v_rgbNE,vec2 v_rgbSW,vec2 v_rgbSE,vec2 v_rgbM){vec4 color;mediump vec2 inverseVP=vec2(1.0/resolution.x,1.0/resolution.y);vec3 rgbNW=texture2D(tex,v_rgbNW).xyz;vec3 rgbNE=texture2D(tex,v_rgbNE).xyz;vec3 rgbSW=texture2D(tex,v_rgbSW).xyz;vec3 rgbSE=texture2D(tex,v_rgbSE).xyz;vec4 texColor=texture2D(tex,v_rgbM);vec3 rgbM=texColor.xyz;vec3 luma=vec3(0.299,0.587,0.114);float lumaNW=dot(rgbNW,luma);float lumaNE=dot(rgbNE,luma);float lumaSW=dot(rgbSW,luma);float lumaSE=dot(rgbSE,luma);float lumaM=dot(rgbM,luma);float lumaMin=min(lumaM,min(min(lumaNW,lumaNE),min(lumaSW,lumaSE)));float lumaMax=max(lumaM,max(max(lumaNW,lumaNE),max(lumaSW,lumaSE)));mediump vec2 dir;dir.x=-((lumaNW+lumaNE)-(lumaSW+lumaSE));dir.y=((lumaNW+lumaSW)-(lumaNE+lumaSE));float dirReduce=max((lumaNW+lumaNE+lumaSW+lumaSE)*(0.25*1.0/8.0),1.0/128.0);float rcpDirMin=1.0/(min(abs(dir.x),abs(dir.y))+dirReduce);dir=min(vec2(8.0,8.0),max(vec2(-8.0,-8.0),dir*rcpDirMin))*inverseVP;vec3 rgbA=0.5*(texture2D(tex,fragCoord*inverseVP+dir*(1.0/3.0-0.5)).xyz+texture2D(tex,fragCoord*inverseVP+dir*(2.0/3.0-0.5)).xyz);vec3 rgbB=rgbA*0.5+0.25*(texture2D(tex,fragCoord*inverseVP+dir*-0.5).xyz+texture2D(tex,fragCoord*inverseVP+dir*0.5).xyz);float lumaB=dot(rgbB,luma);if((lumaB<lumaMin)||(lumaB>lumaMax)){color=vec4(rgbA,texColor.a);}else{color=vec4(rgbB,texColor.a);}return color;}void texcoords_3_1(vec2 fragCoord,vec2 resolution,out vec2 v_rgbNW,out vec2 v_rgbNE,out vec2 v_rgbSW,out vec2 v_rgbSE,out vec2 v_rgbM){vec2 inverseVP=1.0/resolution.xy;v_rgbNW=(fragCoord+vec2(-1.0,-1.0))*inverseVP;v_rgbNE=(fragCoord+vec2(1.0,-1.0))*inverseVP;v_rgbSW=(fragCoord+vec2(-1.0,1.0))*inverseVP;v_rgbSE=(fragCoord+vec2(1.0,1.0))*inverseVP;v_rgbM=vec2(fragCoord*inverseVP);}vec4 apply_1_2(sampler2D tex,vec2 fragCoord,vec2 resolution){mediump vec2 v_rgbNW;mediump vec2 v_rgbNE;mediump vec2 v_rgbSW;mediump vec2 v_rgbSE;mediump vec2 v_rgbM;texcoords_3_1(fragCoord,resolution,v_rgbNW,v_rgbNE,v_rgbSW,v_rgbSE,v_rgbM);return fxaa_2_0(tex,fragCoord,resolution,v_rgbNW,v_rgbNE,v_rgbSW,v_rgbSE,v_rgbM);}void main(void){vec2 fragCoord=vTextureCoord*canvasSize;gl_FragColor=apply_1_2(uSampler,fragCoord,canvasSize);}"})),this.programSample}},{key:"render",value:function(n){var l=n.gl;n=n.texture,this.getOptions(),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT);var v=this.getProgram(l);l.useProgram(v.program);var d=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,d),l.bufferData(l.ARRAY_BUFFER,new Float32Array(this.vertex),l.STATIC_DRAW),l.enableVertexAttribArray(v.attributes.aPos),l.vertexAttribPointer(v.attributes.aPos,3,l.FLOAT,!1,0,0),d=l.createBuffer(),l.bindBuffer(l.ARRAY_BUFFER,d),l.bufferData(l.ARRAY_BUFFER,new Float32Array(this.sampleCoord),l.STATIC_DRAW),l.enableVertexAttribArray(v.attributes.aTextureCoord),l.vertexAttribPointer(v.attributes.aTextureCoord,2,l.FLOAT,!1,0,0),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,n),l.uniform1i(v.uniforms.uSampler,1),l.uniform2fv(v.uniforms.canvasSize,[l.canvas.width,l.canvas.height]),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3),l.bindBuffer(l.ARRAY_BUFFER,null),l.useProgram(null)}}]),u}(Lh),uv=function(a){function u(n){return Ye(this,u),Pr(this,(u.__proto__||lr(u)).call(this,n))}return Rr(u,a),qe(u,[{key:"getProgram",value:function(n){if(this.program1||(this.program1=new ii(n,{vertexShader:"attribute vec3 position;attribute vec2 uv;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];void SMAAEdgeDetectionVS(vec2 texcoord){vOffset[0]=texcoord.xyxy+resolution.xyxy*vec4(-1.0,0.0,0.0,1.0);vOffset[1]=texcoord.xyxy+resolution.xyxy*vec4(1.0,0.0,0.0,-1.0);vOffset[2]=texcoord.xyxy+resolution.xyxy*vec4(-2.0,0.0,0.0,2.0);}void main(){vUv=uv;SMAAEdgeDetectionVS(vUv);gl_Position=vec4(position,1.0);}",fragmentShader:`precision highp float;
#define SMAA_THRESHOLD 0.1
uniform sampler2D tDiffuse;varying vec2 vUv;varying vec4 vOffset[3];vec4 SMAAColorEdgeDetectionPS(vec2 texcoord,vec4 offset[3],sampler2D colorTex){vec2 threshold=vec2(SMAA_THRESHOLD,SMAA_THRESHOLD);vec4 delta;vec3 C=texture2D(colorTex,texcoord).rgb;vec3 Cleft=texture2D(colorTex,offset[0].xy).rgb;vec3 t=abs(C-Cleft);delta.x=max(max(t.r,t.g),t.b);vec3 Ctop=texture2D(colorTex,offset[0].zw).rgb;t=abs(C-Ctop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0,1.0))==0.0)discard;vec3 Cright=texture2D(colorTex,offset[1].xy).rgb;t=abs(C-Cright);delta.z=max(max(t.r,t.g),t.b);vec3 Cbottom=texture2D(colorTex,offset[1].zw).rgb;t=abs(C-Cbottom);delta.w=max(max(t.r,t.g),t.b);float maxDelta=max(max(max(delta.x,delta.y),delta.z),delta.w);vec3 Cleftleft=texture2D(colorTex,offset[2].xy).rgb;t=abs(C-Cleftleft);delta.z=max(max(t.r,t.g),t.b);vec3 Ctoptop=texture2D(colorTex,offset[2].zw).rgb;t=abs(C-Ctoptop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(max(maxDelta,delta.z),delta.w);edges.xy*=step(0.5*maxDelta,delta.xy);return vec4(edges,0.0,0.0);}void main(){gl_FragColor=SMAAColorEdgeDetectionPS(vUv,vOffset,tDiffuse);}`})),this.program2||(this.program2=new ii(n,{vertexShader:`precision highp float;
#define SMAA_MAX_SEARCH_STEPS 8
#define SMAA_AREATEX_MAX_DISTANCE 16
#define SMAA_AREATEX_PIXEL_SIZE ( 1.0 / vec2( 160.0, 560.0 ) )
#define SMAA_AREATEX_SUBTEX_SIZE ( 1.0 / 7.0 )
attribute vec3 position;attribute vec2 uv;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixcoord;void SMAABlendingWeightCalculationVS(vec2 texcoord){vPixcoord=texcoord/resolution;vOffset[0]=texcoord.xyxy+resolution.xyxy*vec4(-0.25,0.125,1.25,0.125);vOffset[1]=texcoord.xyxy+resolution.xyxy*vec4(-0.125,0.25,-0.125,-1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*resolution.xxyy*float(SMAA_MAX_SEARCH_STEPS);}void main(){vUv=uv;SMAABlendingWeightCalculationVS(vUv);gl_Position=vec4(position,1.0);}`,fragmentShader:`precision highp float;
#define SMAA_MAX_SEARCH_STEPS 8
#define SMAA_AREATEX_MAX_DISTANCE 16
#define SMAA_AREATEX_PIXEL_SIZE ( 1.0 / vec2( 160.0, 560.0 ) )
#define SMAA_AREATEX_SUBTEX_SIZE ( 1.0 / 7.0 )
#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )
uniform sampler2D tDiffuse;uniform sampler2D tArea;uniform sampler2D tSearch;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixcoord;vec2 round(vec2 x){return sign(x)*floor(abs(x)+0.5);}float SMAASearchLength(sampler2D searchTex,vec2 e,float bias,float scale){e.r=bias+e.r*scale;return 255.0*texture2D(searchTex,e,0.0).r;}float SMAASearchXLeft(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){/***@PSEUDO_GATHER4*This texcoord has been offset by(-0.25,-0.125)in the vertex shader to*sample between edge,thus fetching four edges in a row.*Sampling with different offsets in each direction allows to disambiguate*which edges are active from the four fetched ones.*/vec2 e=vec2(0.0,1.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord-=vec2(2.0,0.0)*resolution;if(!(texcoord.x>end&&e.g>0.8281&&e.r==0.0))break;}texcoord.x+=0.25*resolution.x;texcoord.x+=resolution.x;texcoord.x+=2.0*resolution.x;texcoord.x-=resolution.x*SMAASearchLength(searchTex,e,0.0,0.5);return texcoord.x;}float SMAASearchXRight(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord+=vec2(2.0,0.0)*resolution;if(!(texcoord.x<end&&e.g>0.8281&&e.r==0.0))break;}texcoord.x-=0.25*resolution.x;texcoord.x-=resolution.x;texcoord.x-=2.0*resolution.x;texcoord.x+=resolution.x*SMAASearchLength(searchTex,e,0.5,0.5);return texcoord.x;}float SMAASearchYUp(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord+=vec2(0.0,2.0)*resolution;if(!(texcoord.y>end&&e.r>0.8281&&e.g==0.0))break;}texcoord.y-=0.25*resolution.y;texcoord.y-=resolution.y;texcoord.y-=2.0*resolution.y;texcoord.y+=resolution.y*SMAASearchLength(searchTex,e.gr,0.0,0.5);return texcoord.y;}float SMAASearchYDown(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord-=vec2(0.0,2.0)*resolution;if(!(texcoord.y<end&&e.r>0.8281&&e.g==0.0))break;}texcoord.y+=0.25*resolution.y;texcoord.y+=resolution.y;texcoord.y+=2.0*resolution.y;texcoord.y-=resolution.y*SMAASearchLength(searchTex,e.gr,0.5,0.5);return texcoord.y;}vec2 SMAAArea(sampler2D areaTex,vec2 dist,float e1,float e2,float offset){vec2 texcoord=float(SMAA_AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texcoord=SMAA_AREATEX_PIXEL_SIZE*texcoord+(0.5*SMAA_AREATEX_PIXEL_SIZE);texcoord.y+=SMAA_AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTex,texcoord,0.0).rg;}vec4 SMAABlendingWeightCalculationPS(vec2 texcoord,vec2 pixcoord,vec4 offset[3],sampler2D edgesTex,sampler2D areaTex,sampler2D searchTex,ivec4 subsampleIndices){vec4 weights=vec4(0.0,0.0,0.0,0.0);vec2 e=texture2D(edgesTex,texcoord).rg;if(e.g>0.0){vec2 d;vec2 coords;coords.x=SMAASearchXLeft(edgesTex,searchTex,offset[0].xy,offset[2].x);coords.y=offset[1].y;d.x=coords.x;float e1=texture2D(edgesTex,coords,0.0).r;coords.x=SMAASearchXRight(edgesTex,searchTex,offset[0].zw,offset[2].y);d.y=coords.x;d=d/resolution.x-pixcoord.x;vec2 sqrt_d=sqrt(abs(d));coords.y-=1.0*resolution.y;float e2=SMAASampleLevelZeroOffset(edgesTex,coords,ivec2(1,0)).r;weights.rg=SMAAArea(areaTex,sqrt_d,e1,e2,float(subsampleIndices.y));}if(e.r>0.0){vec2 d;vec2 coords;coords.y=SMAASearchYUp(edgesTex,searchTex,offset[1].xy,offset[2].z);coords.x=offset[0].x;d.x=coords.y;float e1=texture2D(edgesTex,coords,0.0).g;coords.y=SMAASearchYDown(edgesTex,searchTex,offset[1].zw,offset[2].w);d.y=coords.y;d=d/resolution.y-pixcoord.y;vec2 sqrt_d=sqrt(abs(d));coords.y-=1.0*resolution.y;float e2=SMAASampleLevelZeroOffset(edgesTex,coords,ivec2(0,1)).g;weights.ba=SMAAArea(areaTex,sqrt_d,e1,e2,float(subsampleIndices.x));}return weights;}void main(){gl_FragColor=SMAABlendingWeightCalculationPS(vUv,vPixcoord,vOffset,tDiffuse,tArea,tSearch,ivec4(0.0));}`})),this.program3||(this.program3=new ii(n,{vertexShader:"precision highp float;uniform vec2 resolution;attribute vec3 position;attribute vec2 uv;varying vec2 vUv;varying vec4 vOffset[2];void SMAANeighborhoodBlendingVS(vec2 texcoord){vOffset[0]=texcoord.xyxy+resolution.xyxy*vec4(-1.0,0.0,0.0,1.0);vOffset[1]=texcoord.xyxy+resolution.xyxy*vec4(1.0,0.0,0.0,-1.0);}void main(){vUv=uv;SMAANeighborhoodBlendingVS(vUv);gl_Position=vec4(position,1.0);}",fragmentShader:"precision highp float;uniform sampler2D tDiffuse;uniform sampler2D tColor;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[2];vec4 SMAANeighborhoodBlendingPS(vec2 texcoord,vec4 offset[2],sampler2D colorTex,sampler2D blendTex){vec4 a;a.xz=texture2D(blendTex,texcoord).xz;a.y=texture2D(blendTex,offset[1].zw).g;a.w=texture2D(blendTex,offset[1].xy).a;if(dot(a,vec4(1.0,1.0,1.0,1.0))<1e-5){return texture2D(colorTex,texcoord,0.0);}else{vec2 offset;offset.x=a.a>a.b ? a.a :-a.b;offset.y=a.g>a.r ?-a.g : a.r;if(abs(offset.x)>abs(offset.y)){offset.y=0.0;}else{offset.x=0.0;}vec4 C=texture2D(colorTex,texcoord,0.0);texcoord+=sign(offset)*resolution;vec4 Cop=texture2D(colorTex,texcoord,0.0);float s=abs(offset.x)>abs(offset.y)? abs(offset.x): abs(offset.y);C.xyz=pow(C.xyz,vec3(2.2));Cop.xyz=pow(Cop.xyz,vec3(2.2));vec4 mixed=mix(C,Cop,s);mixed.xyz=pow(mixed.xyz,vec3(1.0/2.2));return mixed;}}void main(){gl_FragColor=SMAANeighborhoodBlendingPS(vUv,vOffset,tColor,tDiffuse);}"})),!this.vertexBuffer||!this.sampleBuffer){this.vertexBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.sampleBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexBuffer.updateData(new Float32Array(this.vertex)),this.sampleBuffer.updateData(new Float32Array(this.sampleCoord));var l=[{stride:12,name:"position",buffer:this.vertexBuffer,size:3,type:"FLOAT",offset:0},{stride:8,name:"uv",buffer:this.sampleBuffer,size:2,type:"FLOAT",offset:0}];this.vertexArray1=new pn({gl:n,program:this.program1,attributes:l}),this.vertexArray2=new pn({gl:n,program:this.program2,attributes:l}),this.vertexArray3=new pn({gl:n,program:this.program3,attributes:l})}return{program1:this.program1,program2:this.program2,program3:this.program3}}},{key:"onResize",value:function(n){this.collectBrightBuffer=new ao(n),this.bloomBuffer=new ao(n)}},{key:"getExtraFbo",value:function(n){return this.collectBrightBuffer||(this.collectBrightBuffer=new ao(n)),this.bloomBuffer||(this.bloomBuffer=new ao(n)),{collectBrightBuffer:this.collectBrightBuffer.framebuffer,bloomBuffer:this.bloomBuffer.framebuffer}}},{key:"render",value:function(n){var l=n.gl,v=n.texture;n=n.fbo,this.getOptions(),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT);var d=this.getProgram(l),x=d.program1,y=d.program2;d=d.program3;var M=this.getExtraFbo(l),D=M.collectBrightBuffer;M=M.bloomBuffer;var U=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,U),l.bufferData(l.ARRAY_BUFFER,new Float32Array(this.vertex),l.STATIC_DRAW),l.enableVertexAttribArray(x.attributes.position),l.vertexAttribPointer(x.attributes.position,3,l.FLOAT,!1,0,0),l.enableVertexAttribArray(y.attributes.position),l.vertexAttribPointer(y.attributes.position,3,l.FLOAT,!1,0,0),l.enableVertexAttribArray(d.attributes.position),l.vertexAttribPointer(d.attributes.position,3,l.FLOAT,!1,0,0),U=l.createBuffer(),l.bindBuffer(l.ARRAY_BUFFER,U),l.bufferData(l.ARRAY_BUFFER,new Float32Array(this.sampleCoord),l.STATIC_DRAW),l.enableVertexAttribArray(x.attributes.uv),l.vertexAttribPointer(x.attributes.uv,2,l.FLOAT,!1,0,0),l.enableVertexAttribArray(y.attributes.uv),l.vertexAttribPointer(y.attributes.uv,2,l.FLOAT,!1,0,0),l.enableVertexAttribArray(d.attributes.uv),l.vertexAttribPointer(d.attributes.uv,2,l.FLOAT,!1,0,0),l.useProgram(x.program),l.bindFramebuffer(l.FRAMEBUFFER,D),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.activeTexture(l.TEXTURE2),l.bindTexture(l.TEXTURE_2D,v),l.uniform1i(x.uniforms.tDiffuse,2),l.uniform2fv(x.uniforms.resolution,[l.canvas.width,l.canvas.height]),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3),l.useProgram(y.program),l.bindFramebuffer(l.FRAMEBUFFER,M),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.activeTexture(l.TEXTURE2),l.bindTexture(l.TEXTURE_2D,D.texture),l.uniform1i(y.uniforms.uSampler,2),l.uniform2fv(y.uniforms.resolution,[l.canvas.width,l.canvas.height]),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3),l.useProgram(d.program),l.bindFramebuffer(l.FRAMEBUFFER,n),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.activeTexture(l.TEXTURE2),l.bindTexture(l.TEXTURE_2D,v),l.uniform1i(d.uniforms.tDiffuse,2),l.activeTexture(l.TEXTURE3),l.bindTexture(l.TEXTURE_2D,M.texture),l.uniform1i(d.uniforms.tColor,3),l.uniform2fv(d.uniforms.resolution,[l.canvas.width,l.canvas.height]),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3),l.bindBuffer(l.ARRAY_BUFFER,null),l.useProgram(null)}},{key:"getAreaTexture",value:function(){return"data:image/png;base64,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"}},{key:"getSearchTexture",value:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAIAAADiVupLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAFZJREFUeNrs00EKgAAIRNEZ739mTQoiwmhRi4L/FiKiu9ERISkzbXdTVV3H4WhfOG6ehl1rNR7qDSF8hwkVcJXt+3A//I0Nv0GoCBUAAAAAAMA/LAIMAB+Dcg2OE2zsAAAAAElFTkSuQmCC"}}]),u}(Lh),A1=function(a){function u(n){return Ye(this,u),Pr(this,(u.__proto__||lr(u)).call(this,n))}return Rr(u,a),qe(u,[{key:"getProgram",value:function(n){return this.programSample||(this.programSample=new ii(n,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;varying vec2 vTextureCoord;void main(){float fStep=1.0/512.0;vec4 sample11=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample12=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t+1.0*fStep));vec4 sample13=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample21=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t));vec4 sample22=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t));vec4 sample23=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t));vec4 sample31=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 sample32=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t-1.0*fStep));vec4 sample33=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 blurSample=(sample11+sample12+sample13+sample21+2.0*sample22+sample23+sample31+sample32+sample33)/10.0;gl_FragColor=blurSample;}"}),this.vertexBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.sampleBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexBuffer.updateData(new Float32Array(this.vertex)),this.sampleBuffer.updateData(new Float32Array(this.sampleCoord)),this.vertexArray=new pn({gl:n,program:this.programSample,attributes:[{stride:12,name:"aPos",buffer:this.vertexBuffer,size:3,type:"FLOAT",offset:0},{stride:8,name:"aTextureCoord",buffer:this.sampleBuffer,size:2,type:"FLOAT",offset:0}]})),this.programSample}},{key:"render",value:function(n){var l=n.gl;n=n.texture,l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT);var v=this.getProgram(l);v.use(l),this.vertexArray.bind(),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,n),l.uniform1i(v.uniforms.uSampler,1),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3)}}]),u}(Lh),qd=function(a){function u(n){return Ye(this,u),Pr(this,(u.__proto__||lr(u)).call(this,n))}return Rr(u,a),qe(u,[{key:"getProgram",value:function(n){return this.programBright||(this.programBright=new ii(n,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform float threshold;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(uSampler,vTextureCoord);vec4 lightColor=max(vec4(0.0),(color-(1.0-threshold)/5.0));float brightness=dot(color.rgb,vec3(0.2126,0.7152,0.0722));if(brightness>threshold){color=lightColor;}else{color=vec4(0.0);}gl_FragColor=color;}"})),this.programBloom||(this.programBloom=new ii(n,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform bool isVertical;uniform vec2 canvasSize;uniform float blurSize;uniform float devicePixelRatio;varying vec2 vTextureCoord;void main(){float weight[10];weight[0]=0.2270270270;weight[1]=0.1945945946;weight[2]=0.1216216216;weight[3]=0.1135135135;weight[4]=0.0972972973;weight[5]=0.0608108108;weight[6]=0.0540540541;weight[7]=0.0270270270;weight[8]=0.0162162162;weight[9]=0.0081081081;vec2 offset=vec2(blurSize/canvasSize.x,blurSize/canvasSize.y)*devicePixelRatio;vec4 result=texture2D(uSampler,vTextureCoord)*weight[0];if(isVertical){for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(0.0,offset.y*float(i)))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(0.0,offset.y*float(i)))*weight[i];}}else{for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(offset.x*float(i),0.0))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(offset.x*float(i),0.0))*weight[i];}}gl_FragColor=result;}"})),this.programResult||(this.programResult=new ii(n,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D originalTexture;uniform sampler2D bloomTexture;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(originalTexture,vTextureCoord);vec4 bloomColor=texture2D(bloomTexture,vTextureCoord);color+=bloomColor;gl_FragColor=color;}"})),{programBright:this.programBright,programBloom:this.programBloom,programResult:this.programResult}}},{key:"onResize",value:function(n){this.collectBrightBuffer=new ao(n),this.bloomBuffer=new ao(n)}},{key:"getExtraFbo",value:function(n){return this.collectBrightBuffer||(this.collectBrightBuffer=new ao(n)),this.bloomBuffer||(this.bloomBuffer=new ao(n)),{collectBrightBuffer:this.collectBrightBuffer.framebuffer,bloomBuffer:this.bloomBuffer.framebuffer}}},{key:"render",value:function(n){var l=n.gl,v=n.texture;n=n.fbo;var d=this.getOptions();l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT);var x=this.getProgram(l),y=x.programBright,M=x.programBloom;x=x.programResult;var D=this.getExtraFbo(l),U=D.collectBrightBuffer;D=D.bloomBuffer;var C=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,C),l.bufferData(l.ARRAY_BUFFER,new Float32Array(this.vertex),l.STATIC_DRAW),l.enableVertexAttribArray(y.attributes.aPos),l.vertexAttribPointer(y.attributes.aPos,3,l.FLOAT,!1,0,0),l.enableVertexAttribArray(M.attributes.aPos),l.vertexAttribPointer(M.attributes.aPos,3,l.FLOAT,!1,0,0),l.enableVertexAttribArray(x.attributes.aPos),l.vertexAttribPointer(x.attributes.aPos,3,l.FLOAT,!1,0,0),C=l.createBuffer(),l.bindBuffer(l.ARRAY_BUFFER,C),l.bufferData(l.ARRAY_BUFFER,new Float32Array(this.sampleCoord),l.STATIC_DRAW),l.enableVertexAttribArray(y.attributes.aTextureCoord),l.vertexAttribPointer(y.attributes.aTextureCoord,2,l.FLOAT,!1,0,0),l.enableVertexAttribArray(M.attributes.aTextureCoord),l.vertexAttribPointer(M.attributes.aTextureCoord,2,l.FLOAT,!1,0,0),l.enableVertexAttribArray(x.attributes.aTextureCoord),l.vertexAttribPointer(x.attributes.aTextureCoord,2,l.FLOAT,!1,0,0),l.useProgram(y.program),l.bindFramebuffer(l.FRAMEBUFFER,U),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,v),l.uniform1i(y.uniforms.uSampler,1),l.uniform1f(y.uniforms.threshold,d.threshold||0),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3),l.useProgram(M.program),l.bindFramebuffer(l.FRAMEBUFFER,D),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,U.texture),l.uniform1i(M.uniforms.uSampler,1),l.uniform1i(M.uniforms.isVertical,!0),l.uniform1f(M.uniforms.blurSize,d.blurSize||2),l.uniform1f(M.uniforms.devicePixelRatio,window.devicePixelRatio),l.uniform2fv(M.uniforms.canvasSize,[l.canvas.width,l.canvas.height]),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3),l.useProgram(M.program),l.bindFramebuffer(l.FRAMEBUFFER,U),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,D.texture),l.uniform1i(M.uniforms.uSampler,1),l.uniform1i(M.uniforms.isVertical,!1),l.uniform1f(M.uniforms.blurSize,d.blurSize||2),l.uniform1f(M.uniforms.devicePixelRatio,window.devicePixelRatio),l.uniform2fv(M.uniforms.canvasSize,[l.canvas.width,l.canvas.height]),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3),l.useProgram(x.program),l.bindFramebuffer(l.FRAMEBUFFER,n),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,v),l.uniform1i(x.uniforms.originalTexture,1),l.activeTexture(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,U.texture),l.uniform1i(x.uniforms.bloomTexture,0),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3),l.bindBuffer(l.ARRAY_BUFFER,null),l.useProgram(null)}}]),u}(Lh),Kd=function(a){function u(n){return Ye(this,u),Pr(this,(u.__proto__||lr(u)).call(this,n))}return Rr(u,a),qe(u,[{key:"getProgram",value:function(n){return this.programBright||(this.programBright=new ii(n,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform float threshold;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(uSampler,vTextureCoord);vec4 lightColor=max(vec4(0.0),(color-threshold));gl_FragColor=lightColor;}"})),this.programBloom||(this.programBloom=new ii(n,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform bool isVertical;uniform vec2 canvasSize;uniform float blurSize;uniform float devicePixelRatio;varying vec2 vTextureCoord;void main(){float weight[10];weight[0]=0.2270270270;weight[1]=0.1945945946;weight[2]=0.1216216216;weight[3]=0.1135135135;weight[4]=0.0972972973;weight[5]=0.0608108108;weight[6]=0.0540540541;weight[7]=0.0270270270;weight[8]=0.0162162162;weight[9]=0.0081081081;vec2 offset=vec2(blurSize/canvasSize.x,blurSize/canvasSize.y)*devicePixelRatio;vec4 result=texture2D(uSampler,vTextureCoord)*weight[0];if(isVertical){for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(0.0,offset.y*float(i)))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(0.0,offset.y*float(i)))*weight[i];}}else{for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(offset.x*float(i),0.0))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(offset.x*float(i),0.0))*weight[i];}}gl_FragColor=result;}"})),this.programResult||(this.programResult=new ii(n,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D originalTexture;uniform sampler2D bloomTexture;uniform float toneScale;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(originalTexture,vTextureCoord)*toneScale;vec4 bloomColor=texture2D(bloomTexture,vTextureCoord);color+=bloomColor;gl_FragColor=color;}"})),{programBright:this.programBright,programBloom:this.programBloom,programResult:this.programResult}}},{key:"onResize",value:function(n){this.collectBrightBuffer=new ao(n),this.bloomBuffer=new ao(n)}},{key:"getExtraFbo",value:function(n){return this.collectBrightBuffer||(this.collectBrightBuffer=new ao(n)),this.bloomBuffer||(this.bloomBuffer=new ao(n)),{collectBrightBuffer:this.collectBrightBuffer.framebuffer,bloomBuffer:this.bloomBuffer.framebuffer}}},{key:"render",value:function(n){var l=n.gl,v=n.texture;n=n.fbo;var d=this.getOptions(),x="clarity"in d?d.clarity:1;x=Math.max(0,x),x=Math.min(1,x),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT);var y=this.getProgram(l),M=y.programBright,D=y.programBloom;y=y.programResult;var U=this.getExtraFbo(l),C=U.collectBrightBuffer;U=U.bloomBuffer;var E=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,E),l.bufferData(l.ARRAY_BUFFER,new Float32Array(this.vertex),l.STATIC_DRAW),l.enableVertexAttribArray(M.attributes.aPos),l.vertexAttribPointer(M.attributes.aPos,3,l.FLOAT,!1,0,0),l.enableVertexAttribArray(D.attributes.aPos),l.vertexAttribPointer(D.attributes.aPos,3,l.FLOAT,!1,0,0),l.enableVertexAttribArray(y.attributes.aPos),l.vertexAttribPointer(y.attributes.aPos,3,l.FLOAT,!1,0,0),E=l.createBuffer(),l.bindBuffer(l.ARRAY_BUFFER,E),l.bufferData(l.ARRAY_BUFFER,new Float32Array(this.sampleCoord),l.STATIC_DRAW),l.enableVertexAttribArray(M.attributes.aTextureCoord),l.vertexAttribPointer(M.attributes.aTextureCoord,2,l.FLOAT,!1,0,0),l.enableVertexAttribArray(D.attributes.aTextureCoord),l.vertexAttribPointer(D.attributes.aTextureCoord,2,l.FLOAT,!1,0,0),l.enableVertexAttribArray(y.attributes.aTextureCoord),l.vertexAttribPointer(y.attributes.aTextureCoord,2,l.FLOAT,!1,0,0),l.useProgram(M.program),l.bindFramebuffer(l.FRAMEBUFFER,C),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,v),l.uniform1i(M.uniforms.uSampler,1),l.uniform1f(M.uniforms.threshold,d.threshold||0),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3),l.useProgram(D.program),l.bindFramebuffer(l.FRAMEBUFFER,U),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,C.texture),l.uniform1i(D.uniforms.uSampler,1),l.uniform1i(D.uniforms.isVertical,!0),l.uniform1f(D.uniforms.blurSize,d.blurSize||2),l.uniform1f(D.uniforms.devicePixelRatio,window.devicePixelRatio),l.uniform2fv(D.uniforms.canvasSize,[l.canvas.width,l.canvas.height]),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3),l.useProgram(D.program),l.bindFramebuffer(l.FRAMEBUFFER,C),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,U.texture),l.uniform1i(D.uniforms.uSampler,1),l.uniform1i(D.uniforms.isVertical,!1),l.uniform1f(D.uniforms.blurSize,d.blurSize||2),l.uniform1f(D.uniforms.devicePixelRatio,window.devicePixelRatio),l.uniform2fv(D.uniforms.canvasSize,[l.canvas.width,l.canvas.height]),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3),l.useProgram(y.program),l.bindFramebuffer(l.FRAMEBUFFER,n),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,v),l.uniform1i(y.uniforms.originalTexture,1),l.uniform1f(y.uniforms.toneScale,x),l.activeTexture(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,C.texture),l.uniform1i(y.uniforms.bloomTexture,0),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3),l.bindBuffer(l.ARRAY_BUFFER,null),l.useProgram(null)}}]),u}(Lh),w1=function(a){function u(n){return Ye(this,u),Pr(this,(u.__proto__||lr(u)).call(this,n))}return Rr(u,a),qe(u,[{key:"getProgram",value:function(n){return this.programSample||(this.programSample=new ii(n,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform vec2 canvasSize;varying vec2 vTextureCoord;void main(){float fStep=1.0/312.0;vec4 sample11=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample12=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t+1.0*fStep));vec4 sample13=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample21=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t));vec4 sample22=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t));vec4 sample23=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t));vec4 sample31=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 sample32=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t-1.0*fStep));vec4 sample33=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 blurSample=(sample11+sample12+sample13+sample21+2.0*sample22+sample23+sample31+sample32+sample33)/10.0;float desX=abs((gl_FragCoord.x-canvasSize.x/2.0)/(canvasSize.x/2.0));float desY=abs((gl_FragCoord.y-canvasSize.y/2.0)/(canvasSize.y/2.0));float factor=max(desX,desY);gl_FragColor=(sample22*(1.0-factor)+blurSample*factor);}"})),this.programSample}},{key:"render",value:function(n){var l=n.gl;n=n.texture;var v=this.getProgram(l);l.useProgram(v.program);var d=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,d),l.bufferData(l.ARRAY_BUFFER,new Float32Array(this.vertex),l.STATIC_DRAW),l.enableVertexAttribArray(v.attributes.aPos),l.vertexAttribPointer(v.attributes.aPos,3,l.FLOAT,!1,0,0),d=l.createBuffer(),l.bindBuffer(l.ARRAY_BUFFER,d),l.bufferData(l.ARRAY_BUFFER,new Float32Array(this.sampleCoord),l.STATIC_DRAW),l.enableVertexAttribArray(v.attributes.aTextureCoord),l.vertexAttribPointer(v.attributes.aTextureCoord,2,l.FLOAT,!1,0,0),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,n),l.uniform1i(v.uniforms.uSampler,1),l.uniform2fv(v.uniforms.canvasSize,[l.canvas.width,l.canvas.height]),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3)}}]),u}(Lh),_1=function(){function a(u){Ye(this,a),this.gl=u,this.effects=[],this.initFbo()}return qe(a,[{key:"addEffect",value:function(u){this.effects.push(u)}},{key:"removeEffect",value:function(u){}},{key:"setEffects",value:function(u){this.effects=u}},{key:"onResize",value:function(){this.initFbo();var u=this.gl,n=this.effects;if(n&&1<n.length)for(var l=1;l<n.length;l++){var v=n[l];v.onResize&&v.onResize(u)}}},{key:"initFbo",value:function(){var u=this.gl;u&&(this.fbo=[new ao(u),new ao(u)])}},{key:"destroy",value:function(){this.effects=[],this.fbo=[],this.gl=null}},{key:"render",value:function(){var u=this.gl,n=this.effects;if(n&&0<n.length)for(var l={},v=0;v<n.length;v++){var d=this.fbo[v%2].framebuffer;v===n.length-1&&(d=null),u.bindFramebuffer(u.FRAMEBUFFER,d);var x=[0,0,0,0];u.clearColor(x[0],x[1],x[2],x[3]),u.clear(u.COLOR_BUFFER_BIT|u.DEPTH_BUFFER_BIT),n[v].render({isPickRender:!1,gl:u,texture:l.texture,fbo:d}),l=d}}}]),a}(),Rh=function(){function a(u,n){Ye(this,a),this.map=u,this.options=n||{},this.eventMap={}}return qe(a,[{key:"onResize",value:function(u){}},{key:"onUpdate",value:function(u){throw"\u672A\u5B9E\u73B0onUpdate\u65B9\u6CD5"}},{key:"getContainer",value:function(){throw"\u672A\u5B9E\u73B0getContainer\u65B9\u6CD5"}},{key:"getSize",value:function(){throw"\u672A\u5B9E\u73B0getSize\u65B9\u6CD5"}},{key:"getTilt",value:function(){throw"\u672A\u5B9E\u73B0getTilt\u65B9\u6CD5"}},{key:"getHeading",value:function(){throw"\u672A\u5B9E\u73B0getHeading\u65B9\u6CD5"}},{key:"getZoomUnits",value:function(){throw"\u672A\u5B9E\u73B0getZoomUnits\u65B9\u6CD5"}},{key:"getCenter",value:function(){throw"\u672A\u5B9E\u73B0getCenter\u65B9\u6CD5"}},{key:"getMapType",value:function(){throw"\u672A\u5B9E\u73B0getMapType\u65B9\u6CD5"}},{key:"lnglatToMercator",value:function(u,n){return this.options.coordinateSystem==="gcj02"?(n=n*Math.PI/180,n=31890685e-1*Math.log((1+Math.sin(n))/(1-Math.sin(n))),[parseFloat((u*Math.PI/180*6378137).toFixed(2)),parseFloat(n.toFixed(2))]):(u=ti.convertLL2MC({lng:u,lat:n}),[u.lng,u.lat])}}]),a}(),Qd=function(a){function u(n){Ye(this,u);var l=Pr(this,(u.__proto__||lr(u)).call(this,n));return n._printLog&&n._printLog("mapvgl"),l.eventMap={},l}return Rr(u,a),qe(u,[{key:"onResize",value:function(n){this.map.addEventListener("resize",n),this.eventMap.resize=n}},{key:"onMousemove",value:function(n){n=this.extendCallback(n),this.map.addEventListener("mousemove",n),this.eventMap.mousemove=n}},{key:"onClick",value:function(n){n=this.extendCallback(n),this.map.addEventListener("click",n),this.eventMap.click=n}},{key:"onDblClick",value:function(n){n=this.extendCallback(n),this.map.addEventListener("dblclick",n),this.eventMap.dblclick=n}},{key:"onRightClick",value:function(n){n=this.extendCallback(n),this.map.addEventListener("rightclick",n),this.eventMap.rightclick=n}},{key:"onUpdate",value:function(n){this.map.addEventListener("update",n),this.map.addEventListener("onearthstatuschange",n),this.eventMap.update=n,this.eventMap.onearthstatuschange=n}},{key:"extendCallback",value:function(n){return function(l){n(Ur(l,{x:l.x,y:l.y}))}}},{key:"unbind",value:function(n){var l=this;this.eventMap[n]?(this.map.removeEventListener(n,this.eventMap[n]),delete this.eventMap[n]):(Un(this.eventMap).forEach(function(v){l.map.removeEventListener(v,l.eventMap[v])}),this.eventMap={})}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getSize",value:function(){return this.map.getSize()}},{key:"getBounds",value:function(){return this.map.getBounds()}},{key:"getTilt",value:function(){return this.map.getTilt()}},{key:"getHeading",value:function(){return this.map.getHeading()}},{key:"getZoomUnits",value:function(){return this.map.getZoomUnits()}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"getCenter",value:function(){var n=this.map.getCenter();return-180<=n.lng&&180>=n.lng&&(n=this.map.lnglatToMercator(n.lng,n.lat),n={lng:n[0],lat:n[1]}),n}},{key:"getMapType",value:function(){return this.map.getMapType()}},{key:"lnglatToMercator",value:function(n,l){return this.map.lnglatToMercator(n,l)}},{key:"mercatorToLnglat",value:function(n,l){return this.map.mercatorToLnglat(n,l)}},{key:"pixelToPointIn",value:function(n){return n=this.map.pixelToPointIn(n),this.mercatorToLnglat(n.lng,n.lat)}}]),u}(Rh),M1=function(a){function u(n){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n)),n.div=document.createElement("div"),n.div.style.position="absolute",n.div.style.userSelect="none",n.map.getPanes().mapPane.appendChild(n.div),n.eventMap={},n}return Rr(u,a),qe(u,[{key:"onResize",value:function(n){this.map.addEventListener("resize",n),this.eventMap.resize=n}},{key:"onMousemove",value:function(n){n=this.extendCallback(n),this.map.addEventListener("mousemove",n),this.eventMap.mousemove=n}},{key:"onClick",value:function(n){n=this.extendCallback(n),Um?(this.map.addEventListener("touchend",n),this.eventMap.touchend=n):(this.map.addEventListener("click",n),this.eventMap.click=n)}},{key:"onDblClick",value:function(n){n=this.extendCallback(n),this.map.addEventListener("dblclick",n),this.eventMap.dblclick=n}},{key:"onRightClick",value:function(n){n=this.extendCallback(n),this.map.addEventListener("rightclick",n),this.eventMap.rightclick=n}},{key:"changeCanvas",value:function(){var n=this.map,l=n.getSize(),v=n.getCenter();n=n.pointToOverlayPixel(v),this.div.style.left=n.x-l.width/2+"px",this.div.style.top=n.y-l.height/2+"px"}},{key:"onUpdate",value:function(n){var l=this,v=function(){l.changeCanvas(),n()};this.map.addEventListener("moveend",v),this.map.addEventListener("moving",v),this.map.addEventListener("zoomend",v),this.eventMap.moveend=v,this.eventMap.moving=v,this.eventMap.zoomend=v}},{key:"extendCallback",value:function(n){return function(l){n(Ur(l,{x:l.pixel.x,y:l.pixel.y}))}}},{key:"unbind",value:function(){var n=this;Un(this.eventMap).forEach(function(l){n.map.removeEventListener(l,n.eventMap[l])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.div}},{key:"getSize",value:function(){return this.map.getSize()}},{key:"getBounds",value:function(){return this.map.getBounds()}},{key:"getTilt",value:function(){return 0}},{key:"getHeading",value:function(){return 0}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"getZoomUnits",value:function(){var n=this.getZoom();return this.map.getMapType().getZoomUnits?this.map.getMapType().getZoomUnits(n):Math.pow(2,18-n)}},{key:"getCenter",value:function(){var n=this.map.getMapType().getProjection().lngLatToPoint(this.map.getCenter());return{lng:n.x,lat:n.y}}},{key:"lnglatToMercator",value:function(n,l){return n=this.map.getMapType().getProjection().lngLatToPoint({lng:n,lat:l}),[n.x,n.y]}},{key:"mercatorToLnglat",value:function(n,l){return n=this.map.getMapType().getProjection().pointToLngLat({lng:n,lat:l}),[n.lng,n.lat]}}]),u}(Rh),C1=function(a){function u(n){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n)),n.eventMap={},n}return Rr(u,a),qe(u,[{key:"onResize",value:function(n){window.addEventListener("resize",n),this.eventMap.resize=n}},{key:"onUpdate",value:function(n){}},{key:"unbind",value:function(){var n=this;Un(this.eventMap).forEach(function(l){window.removeEventListener(l,n.eventMap[l])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.map.container.getElementsByClassName("cesium-widget")[0]}},{key:"getSize",value:function(){var n=this.map;return{width:n.canvas.clientWidth,height:n.canvas.clientHeight}}},{key:"getTilt",value:function(){return 180*this.map.camera.pitch/Math.PI+90}},{key:"getHeading",value:function(){return 360-180*this.map.camera.heading/Math.PI}},{key:"getZoomUnits",value:function(){var n=this.map;return 6.8*n.scene.globe.ellipsoid.cartesianToCartographic(n.camera.position).height/6500}},{key:"getZoom",value:function(){return 10}},{key:"getCenter",value:function(){var n=this.map;return n=n.camera.pickEllipsoid(new Cesium.Cartesian2(n.canvas.clientWidth/2,n.canvas.clientHeight/2)),n=Cesium.Ellipsoid.WGS84.cartesianToCartographic(n),n=this.getMercator([180*n.longitude/Math.PI,180*n.latitude/Math.PI]),{lng:n[0],lat:n[1]}}},{key:"getMercator",value:function(n){var l=[];return l[0]=n[0]*Math.PI/180*6378137,n=n[1]*Math.PI/180,l[1]=31890685e-1*Math.log((1+Math.sin(n))/(1-Math.sin(n))),l}}]),u}(Rh),T1=function(a){function u(n){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n)),n.eventMap={},n}return Rr(u,a),qe(u,[{key:"onResize",value:function(n){window.addEventListener("resize",n),this.eventMap.resize=n}},{key:"onUpdate",value:function(n){}},{key:"unbind",value:function(){var n=this;Un(this.eventMap).forEach(function(l){window.removeEventListener(l,n.eventMap[l])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.map.container}},{key:"getSize",value:function(){return{width:this.map.container.clientWidth,height:this.map.container.clientHeight}}},{key:"getTilt",value:function(){return this.map.tilt}},{key:"getHeading",value:function(){return this.map.heading}},{key:"getZoomUnits",value:function(){return this.map.zoomUnits}},{key:"getZoom",value:function(){return this.map.zoom}},{key:"getCenter",value:function(){return this.map.center}}]),u}(Rh),S1=function(a){function u(n,l){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n,l)),n.eventMap={},n}return Rr(u,a),qe(u,[{key:"onResize",value:function(n){window.addEventListener("resize",n),this.eventMap.resize=n}},{key:"onUpdate",value:function(n){}},{key:"unbind",value:function(){var n=this;Un(this.eventMap).forEach(function(l){window.removeEventListener(l,n.eventMap[l])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.map.container}},{key:"getSize",value:function(){return{width:this.map.container.clientWidth,height:this.map.container.clientHeight}}},{key:"getTilt",value:function(){return this.map.tilt}},{key:"getHeading",value:function(){return this.map.heading}},{key:"getZoomUnits",value:function(){return this.map.zoomUnits}},{key:"getCenter",value:function(){return this.map.center}}]),u}(Rh),Ph=function(){function a(u,n){var l=this;Ye(this,a),n=n||{},n.mapType==="bmap"?this.map=new M1(u,n):n.mapType==="blank"?this.map=new T1(u,n):n.mapType==="cesium"?this.map=new C1(u,n):n.mapType==="three"?this.map=new S1(u,n):(n.mapType="bmapgl",this.map=new Qd(u,n)),this.map.type=n.mapType,this._dpr=window.devicePixelRatio,n.mapType==="bmapgl"&&(this._dpr=this.map.map.config.ratio),this.options=n||{},this.renderArr=[],(u=n.canvas)||(u=document.createElement("canvas")),this.canvas=u,this.gl=n.gl?n.gl:al(u,n),["OES_texture_float","OES_element_index_uint","WEBGL_color_buffer_float","EXT_float_blend"].forEach(function(v){l.gl.getExtension(v)}),this.changeSize(),this.projectionMatrix=rr.create(Float64Array),this.orthoMatrix=rr.create(Float64Array),this.matrix=rr.create(Float64Array),this.viewMatrix=rr.create(Float64Array),this.pointToPixelMatrix=rr.create(Float64Array),this.pixelToViewMatrix=rr.create(Float64Array),this.fovy=35,this.fps=Math.min(n.fps,60)||60,this.renderTime=new Date().valueOf(),this._animation=this.animation.bind(this),this._update=this.update.bind(this),this.onInitialize(this.options.onInitialize),this.options.onRender&&this.renderArr.push(this.options.onRender),this.stateManager=new sv({gl:this.gl}),this.pickFBO=new ao(this.gl),this.transferOptions={},this.bind()}return qe(a,[{key:"bind",value:function(){var u=this,n=this.map;n.onResize(function(){u.changeSize(),u.render()}),n.onUpdate(this._update),n.onClick&&n.onClick(function(l){u.onClick&&u.onClick(l)}),n.onDblClick&&n.onDblClick(function(l){u.onDblClick&&u.onDblClick(l)}),n.onRightClick&&n.onRightClick(function(l){u.onRightClick&&u.onRightClick(l)}),n.onMousemove&&n.onMousemove(function(l){u.onMousemove&&u.onMousemove(l)}),this.options.canvas||n.getContainer().appendChild(this.canvas)}},{key:"unbind",value:function(){var u=this.map;u.unbind&&u.unbind()}},{key:"setOptions",value:function(u){this.options=u}},{key:"onInitialize",value:function(u){u&&(this.transferOptions=u.bind(this)(this.gl)||{})}},{key:"bindFramebuffer",value:function(u){var n=this.gl;u?n.bindFramebuffer(n.FRAMEBUFFER,u.framebuffer):n.bindFramebuffer(n.FRAMEBUFFER,null)}},{key:"saveFramebuffer",value:function(){var u=this.gl;this.preFramebuffer=u.getParameter(u.FRAMEBUFFER_BINDING)}},{key:"restoreFramebuffer",value:function(){var u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,this.preFramebuffer)}},{key:"onRender",value:function(u){this.renderArr.push(u)}},{key:"changeSize",value:function(){var u=this.canvas,n=this.options;if(u){var l=u.style,v=this.map.getSize(),d=this._dpr;u.width=v.width*d,u.height=v.height*d,l.cssText="position: absolute;left:0;top:0;width:"+v.width+"px;height:"+v.height+"px;z-index:2;",n.mapType!=="cesium"||n.canvas||(l.pointerEvents="none"),this.gl.viewport(0,0,u.width,u.height),this.pickFBO=new ao(this.gl)}}},{key:"update",value:function(){this.options.autoUpdate===!1||this.isAnimation&&60<=this.fps||this.render()}},{key:"pixelToPointIn",value:function(u){return this.map.pixelToPointIn(u)}},{key:"render",value:function(){if(this.map&&this.gl){var u=this.options,n=this.projectionMatrix,l=this.viewMatrix;if(u.mapType==="three")l=this.map.map.camera,n=l.projectionMatrix.elements,l=l.matrixWorldInverse.elements;else if(u.mapType==="cesium"){l=this.map.map;var v=l.camera.frustum.projectionMatrix;n=new Float32Array([v[0],v[1],v[2],v[3],v[4],v[5],v[6],v[7],v[8],v[9],v[10],v[11],v[12],v[13],v[14],v[15]]),v=l.camera.viewMatrix,l=new Float32Array([v[0],v[1],v[2],v[3],v[4],v[5],v[6],v[7],v[8],v[9],v[10],v[11],v[12],v[13],v[14],v[15]])}else this.map.map.mapType==="B_EARTH_MAP"?(n=this.map.map.getEarth().scene._camera.getProjectionMatrix(),l=this.map.map.getEarth().scene._camera.getModelViewMatrix()):(this.updateProjectionMatrix(),this.updateModelViewMatrix());for(v=rr.multiply(this.matrix,n,l),Ur(this.transferOptions,{gl:this.gl,matrix:v,pointToPixelMatrix:this.pointToPixelMatrix,pixelToViewMatrix:this.pixelToViewMatrix,projectionMatrix:n,orthoMatrix:this.orthoMatrix,viewMatrix:l,stateManager:this.stateManager}),u.mapType!=="three"&&u.mapType!=="cesium"&&u.autoUpdate!==!1&&this.clear(),u=0;u<this.renderArr.length;u++)this.renderArr[u]&&this.renderArr[u].bind(this)(this.transferOptions)}}},{key:"clear",value:function(u){var n=this.gl,l=this.options.clearColor||[0,0,0,0];n.clearColor(l[0],l[1],l[2],l[3]),u&&(u instanceof Array||(u=Ft(u).unitArray()),n.clearColor(u[0],u[1],u[2],u[3])),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)}},{key:"updateProjectionMatrix",value:function(){var u=this.gl.canvas.width/this.gl.canvas.height,n=this.options.cameraNear||1,l=this.options.cameraFar||4e3;rr.perspective(this.projectionMatrix,he(this.fovy),u,n,l),u=this.map.getSize(),rr.ortho(this.orthoMatrix,-u.width/2,u.width/2,-u.height/2,u.height/2,n,l)}},{key:"updateModelViewMatrix",value:function(){var u=this.map,n=this.viewMatrix,l=this.pointToPixelMatrix,v=this.pixelToViewMatrix;rr.identity(n),rr.identity(l),rr.identity(v);var d=u.getSize();d=Math.round(-d.height/(2*Math.tan(he(this.fovy)/2))),rr.translate(v,v,[0,0,d]),rr.rotate(v,v,he(u.getTilt()),[-1,0,0]),rr.rotate(v,v,he(u.getHeading()),[0,0,-1]),d=u.getCenter();var x=this.options.pointOffset||[0,0];u=u.getZoomUnits(),rr.translate(l,l,[(x[0]-d.lng)/u,(x[1]-d.lat)/u,0]),u=1/u,rr.scale(l,l,[u,u,u]),rr.multiply(n,v,l)}},{key:"destroy",value:function(){this.stopAnimation(),this.unbind();var u=this.gl.getExtension("WEBGL_lose_context");u&&u.loseContext(),this.canvas.remove(),this.gl=this.canvas=null}},{key:"animation",value:function(){if(this.isAnimation){if(60<=this.fps)this.render();else{var u=new Date().valueOf(),n=Math.floor(1e3/this.fps),l=u-this.renderTime;l>n&&(this.render(),this.renderTime=u-l%n)}window.requestAnimationFrame(this._animation)}}},{key:"startAnimation",value:function(){this.isAnimation||(this.isAnimation=!0,window.requestAnimationFrame(this._animation))}},{key:"stopAnimation",value:function(){this.isAnimation=!1}}]),a}(),I1=function(){function a(u){Ye(this,a),this.layers=[],this.options=u,this.webglLayer=u.webglLayer}return qe(a,[{key:"addLayer",value:function(u){for(var n=!1,l=0;l<this.layers.length;l++)if(this.layers[l]===u){n=!0;break}n||(u.map=this.webglLayer.map,u.layerType==="threeLayer"?(u.setWebglLayer(this.webglLayer),n=u.getThreeLayer(),this.addLayer(n),u.initialize&&u.initialize(n)):(u.setWebglLayer(this.webglLayer),u.commonInitialize&&u.commonInitialize(this.webglLayer.gl),u.initialize&&u.initialize(this.webglLayer.gl),u.onOptionsChanged(u.getOptions(),{}),u.onDataChanged(u.getData()),u.onChanged(u.getOptions(),u.getData())),this.putInLayer(u)),this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"putInLayer",value:function(u){u.options.renderOrder===void 0&&(u.options.renderOrder=this.layers.length),this.layers.push(u),this.layers=this.layers.sort(function(n,l){return n.options.renderOrder-l.options.renderOrder})}},{key:"removeLayer",value:function(u){for(var n=0;n<this.layers.length;n++)this.layers[n]===u&&this.layers.splice(n,1);this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"showLayer",value:function(u){for(var n=0;n<this.layers.length;n++)this.layers[n]===u&&u.show();this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"hideLayer",value:function(u){for(var n=0;n<this.layers.length;n++)this.layers[n]===u&&u.hide();this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"removeAllLayers",value:function(){this.layers=[],this.webglLayer.stopAnimation(),this.webglLayer.render()}},{key:"destroyAllLayers",value:function(){for(var u=0;u<this.layers.length;u++){var n=this.layers[u];n.destroy&&n.destroy()}}},{key:"getAllLayers",value:function(){return this.layers}},{key:"getAllThreeLayers",value:function(){for(var u=[],n=0;n<this.layers.length;n++){var l=this.layers[n];l.layerType==="ThreeLayer"&&u.push(l)}return u}},{key:"isRequestAnimation",value:function(){for(var u=!1,n=0;n<this.layers.length;n++)if(this.layers[n].isRequestAnimation()){u=!0;break}return u}},{key:"beforeRender",value:function(u){u.gl&&this.webglLayer.stateManager.setDefaultState()}},{key:"afterRender",value:function(u){(u=u.gl)&&(u.bindBuffer(u.ARRAY_BUFFER,null),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,null),u.useProgram(null))}},{key:"renderGLLayers",value:function(u){this.webglLayer.stateManager.save();for(var n=0;n<this.layers.length;n++){var l=this.layers[n];if(l._visible===!0&&l.layerType!=="threeLayer"&&l.layerType!=="ThreeLayer"){var v=l.map.getZoom(),d=l.getOptions().zoomThreshold;d&&(v<d[0]||v>=d[1])||(this.beforeRender(u),l.render(u),this.afterRender(u))}}this.webglLayer.stateManager.restore()}},{key:"renderThreeLayer",value:function(u){this.webglLayer.stateManager.save(),this.webglLayer.stateManager.setState({blendFunc:[u.gl.SRC_ALPHA,u.gl.ONE],depthMask:!1,depthTest:!0,depthFunc:u.gl.LESS,cullFace:!1});for(var n=0;n<this.layers.length;n++){var l=this.layers[n];if(l._visible===!0&&l.layerType==="ThreeLayer"){var v=l.map.getZoom(),d=l.getOptions().zoomThreshold;d&&(v<d[0]||v>=d[1])||l.render(u)}}this.webglLayer.stateManager.restore()}},{key:"renderThreeLayers",value:function(u){this.webglLayer.stateManager.save(),this.webglLayer.stateManager.setState({blendFunc:[u.gl.SRC_ALPHA,u.gl.ONE],depthMask:!1,depthTest:!0,depthFunc:u.gl.LESS,cullFace:!1});for(var n=0;n<this.layers.length;n++){var l=this.layers[n];if(l._visible===!0&&l.layerType==="threeLayer"){var v=l.map.getZoom(),d=l.getOptions().zoomThreshold;d&&(v<d[0]||v>=d[1])||l.render(u)}}this.webglLayer.stateManager.restore()}},{key:"onClick",value:function(u){for(var n=this.layers.length-1;0<=n;n--){var l=this.layers[n];if(l._visible===!0&&l.layerType!=="threeLayer"&&l.layerType!=="ThreeLayer"){var v=l.map.getZoom(),d=l.getOptions().zoomThreshold;if((!d||!(v<=d[0]||v>=d[1]))&&l.options.enablePicked&&l.options.onClick&&l.pick&&(v=l.pick(u.x,u.y,"onClick"),l.options.onClick(v,u),l.options.autoSelect&&this.webglLayer.render(),u.cancelBubble===!0))break}}}},{key:"onDblClick",value:function(u){for(var n=this.layers.length-1;0<=n;n--){var l=this.layers[n];if(l._visible===!0&&l.layerType!=="threeLayer"&&l.layerType!=="ThreeLayer"){var v=l.map.getZoom(),d=l.getOptions().zoomThreshold;if((!d||!(v<=d[0]||v>=d[1]))&&l.options.enablePicked&&l.options.onDblClick&&l.pick&&(v=l.pick(u.x,u.y,"onDblClick"),l.options.onDblClick(v,u),l.options.autoSelect&&this.webglLayer.render(),u.cancelBubble===!0))break}}}},{key:"onRightClick",value:function(u){for(var n=this.layers.length-1;0<=n;n--){var l=this.layers[n];if(l._visible===!0&&l.layerType!=="threeLayer"&&l.layerType!=="ThreeLayer"){var v=l.map.getZoom(),d=l.getOptions().zoomThreshold;if((!d||!(v<=d[0]||v>=d[1]))&&l.options.enablePicked&&l.options.onRightClick&&l.pick&&(v=l.pick(u.x,u.y,"onRightClick"),l.options.onRightClick(v,u),l.options.autoSelect&&this.webglLayer.render(),u.cancelBubble===!0))break}}}},{key:"onMousemove",value:function(u){for(var n=!1,l=!1,v=this.layers.length-1;0<=v;v--){var d=this.layers[v];if(d._visible===!0&&d.layerType!=="threeLayer"&&d.layerType!=="ThreeLayer"){var x=d.map.getZoom(),y=d.getOptions().zoomThreshold;if((!y||!(x<=y[0]||x>=y[1]))&&d.options.enablePicked&&d.pick&&(d.options.onMousemove||d.options.autoSelect)&&(x=d.pick(u.x,u.y,"onMousemove"),!l&&(this.webglLayer.map.map.platform.style.cursor="default",l=x.dataIndex!==-1)&&(this.webglLayer.map.map.platform.style.cursor="pointer"),d.options.onMousemove&&d.options.onMousemove(x,u),d.options.autoSelect&&(n=!0),u.cancelBubble===!0))break}}n&&(this.webglLayer.isAnimation||this.webglLayer.render())}},{key:"destroy",value:function(){this.destroyAllLayers(),this.removeAllLayers()}}]),a}(),lv=function(){function a(u){var n=this;Ye(this,a),this.options={autoUpdate:!0},this._visible=!0,Ur(this.options,u);var l=u.pointOffset;this.webglLayer=u.webglLayer||new Ph(u.map,this.options),this.layerManager=new I1({autoUpdate:this.options.autoUpdate,webglLayer:this.webglLayer}),this.effectManager=new _1(this.webglLayer.gl),this.webglRender={render:function(){}},this.options.effects&&this.effectManager.setEffects([this.webglRender].concat(this.options.effects)),this.webglLayer.onRender(function(v){n._render(v)}),this.webglLayer.onClick=function(v){n._visible&&n.layerManager.onClick(v)},this.webglLayer.onDblClick=function(v){n._visible&&n.layerManager.onDblClick(v)},this.webglLayer.onRightClick=function(v){n._visible&&n.layerManager.onRightClick(v)},this.webglLayer.onMousemove=function(v){n._visible&&n.layerManager.onMousemove(v)},l||this.webglLayer.options.mapType==="cesium"||(l=this.webglLayer.map.getCenter(),this.webglLayer.options.pointOffset=[l.lng,l.lat]),this.webglLayer.map.onResize(function(){n.effectManager.onResize()}),(this.postProcessing=u.postProcessing)&&(this.postProcessing.setWebglLayer(this.webglLayer),u=this.postProcessing.getThreeLayer(),this.addLayer(u),this.postProcessing.initialize(u),u.postProcessing=this.postProcessing)}return qe(a,[{key:"renderCanvas",value:function(u){var n=this;this.postProcessing?this.postProcessing.addRender(function(){n.layerManager.renderGLLayers(u)}):this.layerManager.renderGLLayers(u),this.layerManager.renderThreeLayers(u),this.layerManager.renderThreeLayer(u)}},{key:"render",value:function(){this.webglLayer&&this.webglLayer.render()}},{key:"_render",value:function(u){var n=this;if(this._visible){var l=this.options.effects;l&&0<l.length?(this.webglRender.render=function(){n.renderCanvas(u)},this.effectManager.render()):(this.webglLayer.saveFramebuffer(),this.renderCanvas(u),this.webglLayer.restoreFramebuffer())}}},{key:"onRender",value:function(u){this.webglLayer.onRender(u)}},{key:"destroy",value:function(){this.stopAnimation(),this.layerManager.destroy(),this.effectManager.destroy(),this.webglLayer.destroy()}},{key:"isRequestAnimation",value:function(){return this.layerManager.isRequestAnimation()}},{key:"startAnimation",value:function(){this.webglLayer.startAnimation()}},{key:"stopAnimation",value:function(){this.webglLayer.stopAnimation()}},{key:"show",value:function(){this._visible!==!0&&(this._visible=!0,this.webglLayer.render(),this.isRequestAnimation()&&this.startAnimation())}},{key:"hide",value:function(){this._visible!==!1&&(this._visible=!1,this.stopAnimation(),this.webglLayer.clear())}},{key:"showLayer",value:function(u){this.layerManager.showLayer(u)}},{key:"hideLayer",value:function(u){this.layerManager.hideLayer(u)}},{key:"add",value:function(u){this.addLayer(u)}},{key:"remove",value:function(u){this.removeLayer(u)}},{key:"addLayer",value:function(u){this.layerManager.addLayer(u)}},{key:"removeLayer",value:function(u){this.layerManager.removeLayer(u)}},{key:"removeAllLayers",value:function(){this.layerManager.removeAllLayers()}},{key:"getAllLayers",value:function(){return this.layerManager.getAllLayers()}},{key:"getAllThreeLayers",value:function(){return this.layerManager.getAllThreeLayers()}}]),a}(),da=function(){function a(u){Ye(this,a),this._visible=!0,this.options=this.getCommonDefaultOptions(),this.options=Ur(this.options,this.getDefaultOptions()),this.autoUpdate=!1,this.options=Ur(this.options,u),this.options.data&&(this.data=this.options.data,delete this.options.data)}return qe(a,[{key:"getCommonDefaultOptions",value:function(){return{}}},{key:"getDefaultOptions",value:function(){return{}}},{key:"initialize",value:function(u){}},{key:"destroy",value:function(){this.onDestroy&&this.onDestroy()}},{key:"show",value:function(){this._visible=!0}},{key:"hide",value:function(){this._visible=!1}},{key:"render",value:function(){}},{key:"clear",value:function(){this.setData([])}},{key:"setData",value:function(u,n){n=n||{},this.data=u,this.onDataChanged&&this.onDataChanged(this.getData()),this.onChanged&&this.onChanged(this.getOptions(),this.getData(),n),n.autoRender!==!1&&this.webglLayer&&this.webglLayer.render()}},{key:"getData",value:function(){return this.data||[]}},{key:"setOptions",value:function(u,n){u=u||{},n=n||{};var l=Ur({},this.getOptions());Ur(this.options,u),this.onOptionsChanged&&this.onOptionsChanged(this.getOptions(),l),this.onChanged&&this.onChanged(this.getOptions(),this.getData(),n),u.data?(this.setData(u.data,n),delete u.data):n.autoRender!==!1&&this.webglLayer&&this.webglLayer.render()}},{key:"getOptions",value:function(){return this.options||{}}},{key:"onOptionsChanged",value:function(u,n){}},{key:"onDataChanged",value:function(u){}},{key:"onChanged",value:function(u,n){}},{key:"onDestroy",value:function(){}},{key:"lnglatToMercator",value:function(u,n){}},{key:"setWebglLayer",value:function(u){this.webglLayer=u}},{key:"getWebglLayer",value:function(){return this.webglLayer}},{key:"isRequestAnimation",value:function(){return this.autoUpdate}}]),a}(),Ui=function(a){function u(n){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n)),n.pickedColor=[-1,-1,-1],n}return Rr(u,a),qe(u,[{key:"getCommonDefaultOptions",value:function(){return{pickWidth:1,pickHeight:1,blend:"default",zIndex:0,zoomThreshold:[0,30],repeat:!1,enablePicked:!1,autoSelect:!1,selectedIndex:-1,selectedColor:"rgba(20, 20, 200, 1.0)"}}},{key:"commonInitialize",value:function(n){var l=this.getOptions();this.gl=n,l.enablePicked&&(this.pickBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}))}},{key:"getCommonAttributes",value:function(){var n=[];return this.getOptions().enablePicked&&n.push({name:"aPickColor",buffer:this.pickBuffer,size:3,type:"FLOAT",stride:12,offset:0}),n}},{key:"getProperty",value:function(n,l,v){return Object.prototype.toString.call(l)==="[object Function]"?l(v):(l=v[n]||l,"properties"in v&&n in v.properties&&(l=v.properties[n]),l)}},{key:"normizedColor",value:function(n){var l=n;return n instanceof Array||(l=Ft(n).unitArray()),l[3]===void 0&&(l[3]=1),l}},{key:"normizedPoint",value:function(n){var l=this.getPointOffset();if(!n||n[0]===void 0||n[1]===void 0)return[l[0],l[1],0];var v=Number(n[0]),d=Number(n[1]);-180<=v&&180>=v&&-90<=d&&90>=d&&(d=this.webglLayer.map.lnglatToMercator(v,d),v=d[0],d=d[1]);var x=Number(n[2])||0;return this.webglLayer&&this.webglLayer.options.mapType==="cesium"&&window.Cesium?(v=this.convertLngLat([v,d]),x=window.Cesium.Cartesian3.fromDegrees(v[0],v[1],x),v=x.x,d=x.y,x=x.z):this.webglLayer&&this.webglLayer.options.mapType==="bmapgl"&&this.webglLayer.map.map.mapType==="B_EARTH_MAP"&&(v=this.convertLngLat([v,d]),x=this.webglLayer.map.map.getEarth().scene.fromLatLngToXYZ({lng:v[0],lat:v[1]}),v=x.x,d=x.y,x=x.z),3<n.length?[v-l[0],d-l[1],x].concat(ri(n.slice(3))):[v-l[0],d-l[1],x]}},{key:"convertLngLat",value:function(n){return[n[0]/2003750834e-2*180,180/Math.PI*(2*Math.atan(Math.exp(n[1]/2003750834e-2*180*Math.PI/180))-Math.PI/2)]}},{key:"getPointOffset",value:function(){var n=[0,0],l=this.getOptions();return this.webglLayer&&this.webglLayer.options.pointOffset?n=this.webglLayer.options.pointOffset:l.pointOffset&&(n=l.pointOffset),n}},{key:"indexToRgb",value:function(n){n++;var l=Math.floor(n/65536);n-=65536*l;var v=Math.floor(n/256);return[n-256*v,v,l]}},{key:"rgbToIndex",value:function(n){for(var l=n.length/4,v=Math.floor(l/2),d=function(U){return n[U]+256*n[U+1]+65536*n[U+2]-1},x=0;;x++){var y=v+x,M=v-x;if(y===M){if(y=d(4*y),-1<y)return y}else{if(y<l){var D=d(4*y);if(-1<D)return D}if(0<=M&&(D=d(4*M),-1<D))return D;if(y>=l&&0>M)break}}return-1}},{key:"getCommonUniforms",value:function(n){n=n.isPickRender;var l=this.getOptions(),v={};if(l.enablePicked){var d=0<=l.selectedIndex?l.selectedIndex:-1;d=l.autoSelect?this.pickedColor:this.indexToRgb(d),v=Ur(v,{uSelectedColor:this.normizedColor(l.selectedColor),uEnablePicked:l.enablePicked,uPickedColor:d.map(function(x){return x/255}),uIsPickRender:!!n})}return v}},{key:"pick",value:function(n,l,v){var d=this.getOptions(),x=this.gl,y=this.webglLayer._dpr;this.webglLayer.saveFramebuffer(),this.webglLayer.bindFramebuffer(this.webglLayer.pickFBO),this.webglLayer.clear(),this.render({gl:x,isPickRender:!0,matrix:this.webglLayer.matrix,projectionMatrix:this.webglLayer.projectionMatrix,viewMatrix:this.webglLayer.viewMatrix,orthoMatrix:this.webglLayer.orthoMatrix});var M=new Uint8Array(4*d.pickWidth*d.pickHeight);return x.readPixels(n*y-Math.floor(d.pickWidth/2),x.canvas.height-l*y-Math.floor(d.pickHeight/2),d.pickWidth,d.pickHeight,x.RGBA,x.UNSIGNED_BYTE,M),n=this.rgbToIndex(M),this.pickAfter&&(n=this.pickAfter(M,n+1)),this.setPickedIndex&&this.setPickedIndex(n,v),v=this.getData(),this.pickedColor=[M[0],M[1],M[2]],this.webglLayer.restoreFramebuffer(),{dataIndex:n,dataItem:v[n]}}},{key:"setGLState",value:function(n){this.webglLayer.stateManager.setState(n,this.options)}},{key:"addMultipleCoords",value:function(n,l,v){if(!this.options.repeat||!this.webglLayer||this.webglLayer.options.mapType!=="bmapgl"||this.webglLayer.map.map.mapType==="B_EARTH_MAP")return[n];var d=this.webglLayer.map.map;l=l||d.getZoom();var x=v?d.worldSize(l):4007545274461451e-8;if(l=function(B){return[[B[0]-x,B[1],B[2]||0],[B[0]+x,B[1],B[2]||0]]},n instanceof Array&&!(n[0]instanceof Array))return l=l(n),l=Pi(l,2),[n,l[0],l[1]];if(n instanceof Array&&n[0]instanceof Array&&!(n[0][0]instanceof Array)){v=[],d=[];for(var y=0;y<n.length;y++){var M=l(n[y]);M=Pi(M,2);var D=M[1];v.push(M[0]),d.push(D)}return[n,v,d]}for(v=[],d=[],y=0;y<n.length;y++){M=[],D=[];for(var U=0;U<n[y].length;U++){var C=l(n[y][U]);C=Pi(C,2);var E=C[1];M.push(C[0]),D.push(E)}v.push(M),d.push(D)}return[n,v,d]}}]),u}(da),$d=function(a){function u(n){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n)),n.name="CircleLayer",n.bufferData=[],n.initializeTime=new Date,n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{depthWrite:!0,depthTest:!0,size:10,unit:"px",color:"blue",borderWidth:0,borderColor:"#000000",antialias:!0}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions();this.program=new ii(this.gl,{vertexShader:`attribute vec3 aPos;attribute float aSize;attribute float aIndex;attribute vec4 aColor;attribute float aBorderWidth;attribute vec4 aBorderColor;varying vec4 vColor;varying vec3 vPosition;varying vec3 vFragPosition;varying float vSize;varying float vBorderWidth;varying vec4 vBorderColor;uniform mat4 uMatrix;uniform float uZoomUnits;uniform vec4 uSelectedColor;void main(){vColor=aColor;vBorderWidth=aBorderWidth*uZoomUnits;vBorderColor=aBorderColor;float x=aPos.x;float y=aPos.y;float z=aPos.z*uZoomUnits;vSize=aSize*uZoomUnits+vBorderWidth;if(aIndex==1.0){x+=vSize;y-=vSize;}else if(aIndex==2.0){x-=vSize;y+=vSize;}else if(aIndex==3.0){x+=vSize;y+=vSize;}else{x-=vSize;y-=vSize;}vPosition=aPos;vFragPosition=vec3(x,y,z);gl_Position=uMatrix*vec4(vFragPosition,1.0);
#if defined(PICK)
if(mapvIsPicked()){vColor=uSelectedColor;}
#endif
}`,fragmentShader:"varying vec3 vPosition;varying float vSize;varying vec3 vFragPosition;varying vec4 vColor;varying float vBorderWidth;varying vec4 vBorderColor;uniform mat4 uMatrix;uniform float uTime;uniform float duration;uniform float trail;uniform float lineWidth;uniform float uAntiAliasing;void main(){float d=distance(vFragPosition.xy,vPosition.xy);if(d>vSize){discard;}vec4 color=vColor;float r=vSize-vBorderWidth;if(vBorderWidth>0.0){if(d>r){color=vBorderColor;}else if(uAntiAliasing==1.0&&d>0.95*r){color=vBorderColor;float st=1.0-smoothstep(0.95*r,r,d);color.r+=(vColor.r-vBorderColor.r)*st;color.g+=(vColor.g-vBorderColor.g)*st;color.b+=(vColor.b-vBorderColor.b)*st;color.a+=(vColor.a-vBorderColor.a)*st;}}if(uAntiAliasing==1.0&&d>0.95*vSize&&d<=vSize){color.a*=1.0-smoothstep(0.95*vSize,vSize,d);}gl_FragColor=color;}",defines:l.enablePicked?["PICK"]:[]},this),this.buffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new Ke({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),l=Float32Array.BYTES_PER_ELEMENT;var v=14*l;l=[{stride:v,name:"aPos",buffer:this.buffer,size:3,type:"FLOAT",offset:0},{stride:v,name:"aSize",buffer:this.buffer,size:1,type:"FLOAT",offset:3*l},{stride:v,name:"aIndex",buffer:this.buffer,size:1,type:"FLOAT",offset:4*l},{stride:v,name:"aColor",buffer:this.buffer,size:4,type:"FLOAT",offset:5*l},{stride:v,name:"aBorderWidth",buffer:this.buffer,size:1,type:"FLOAT",offset:9*l},{stride:v,name:"aBorderColor",buffer:this.buffer,size:4,type:"FLOAT",offset:10*l}],l=l.concat(this.getCommonAttributes()),this.vertexArray=new pn({gl:n,program:this.program,attributes:l})}},{key:"onChanged",value:function(n,l){this.gl&&l&&(this.uniforms={},this.data=l,this.processData(),n.enablePicked&&this.parsePickData(l))}},{key:"processData",value:function(){var n=this,l=[],v=[];this.data.forEach(function(d,x){var y=d.properties||{},M=function(O){return d[O]||y[O]||n.options[O]},D=M("color"),U=M("size"),C=M("borderWidth");M=M("borderColor"),D=n.normizedColor(D),M=n.normizedColor(M);for(var E=n.normizedPoint(d.geometry.coordinates),B=0;4>B;B++)l.push(E[0],E[1],E[2]||0,U,B),l.push(D[0],D[1],D[2],D[3]),l.push(C,M[0],M[1],M[2],M[3]);D=4*x,0<x&&v.push(D-1,D),v.push(D,D+1,D+2,D+3)}),this.bufferData=l,this.indexData=v,this.buffer.updateData(new Float32Array(l)),this.indexBuffer.updateData(new Uint32Array(v))}},{key:"parsePickData",value:function(n){var l=[];if(this.getOptions().enablePicked){for(var v=0;v<n.length;v++){var d=this.indexToRgb(v);l.push(d[0]/255,d[1]/255,d[2]/255),l.push(d[0]/255,d[1]/255,d[2]/255),l.push(d[0]/255,d[1]/255,d[2]/255),l.push(d[0]/255,d[1]/255,d[2]/255)}this.pickBuffer.updateData(new Float32Array(l))}}},{key:"render",value:function(n){var l=this.getOptions(),v=this.program,d=n.gl,x=n.matrix;this.setGLState({blend:!0,blendEquation:d.FUNC_ADD,blendFunc:rs(d,l.blend||"lighter"),depthTest:l.depthTest,depthMask:l.depthWrite}),v.use(d),this.vertexArray.bind(),this.indexBuffer.bind(),l=this.map.getZoomUnits(),Ur(this.uniforms,this.getCommonUniforms(n),{uZoomUnits:this.options.unit==="px"?l:1,uMatrix:x,uAntiAliasing:this.options.antialias?1:0}),v.setUniforms(this.uniforms),d.drawElements(d.TRIANGLE_STRIP,this.indexData.length,d.UNSIGNED_INT,0)}}]),u}(Ui),hv={wave:"varying vec4 vPosition;varying float vSize;varying vec4 vFragPosition;varying vec4 vColor;varying float vStartTime;varying float vRadius;uniform mat4 uMatrix;uniform float uTime;uniform float duration;uniform float trail;uniform float uAntiAliasing;varying float vWidth;void main(){float d=distance(vFragPosition.xy,vPosition.xy);if(d>=vRadius){discard;}vec4 color=vColor;float R=vRadius;float center=vSize;float time=vStartTime+uTime;float alpha=sin((R-d)/R*trail*2.0*3.14+time/duration);if(d<=center){if(uAntiAliasing==1.0&&d>0.9*center&&d<=center){if(alpha>=0.5){color.a=0.9;}else{color.a=1.0-smoothstep(0.9*center,center,d);}}}else{if(alpha>=0.5){color.a=0.9;if(uAntiAliasing==1.0){if(alpha>=0.5&&alpha<=0.6){color.a*=smoothstep(0.0,0.1,alpha-0.5);}if(d>=0.98*R&&d<=R){color.a*=1.0-smoothstep(0.98,1.0,d/R);}}}else{color.a=0.0;}}gl_FragColor=color;}",bubble:"varying vec4 vPosition;varying float vSize;varying vec4 vFragPosition;varying vec4 vColor;varying float vStartTime;varying float vRadius;uniform mat4 uMatrix;uniform float uTime;uniform float duration;uniform float trail;uniform float uAntiAliasing;varying float vWidth;void main(){float d=distance(vFragPosition.xy,vPosition.xy);if(d>=vRadius){discard;}float time=vStartTime+uTime;float range=mod(time,(duration+trail));float percent=0.0;if(range<=duration){percent=range/duration;}else{percent=1.0;}float center=vSize;float R=vRadius;float r=R*percent;vec4 color=vColor;if(d<=center){if(uAntiAliasing==1.0&&d>0.9*center&&d<=center){color.a=1.0-smoothstep(0.9*center,center,d);}}else{if(d<r){color.a=smoothstep(0.1,0.9,pow(d/r,2.0)*0.9);if(uAntiAliasing==1.0&&d>=0.9*r&&d<=r){color.a*=1.0-smoothstep(0.9,1.0,d/r);}if(range>duration){color.a*=1.0-(range-duration)/trail;}}else{color.a=0.0;}}gl_FragColor=color;}",breath:"varying vec4 vPosition;varying vec4 vFragPosition;varying vec4 vColor;varying float vStartTime;varying float vRadius;uniform float uTime;uniform float duration;uniform float trail;uniform float uAntiAliasing;void main(){float d=distance(vFragPosition.xy,vPosition.xy);if(d>=vRadius){discard;}vec4 color=vColor;if(uAntiAliasing==1.0&&d>0.9*vRadius&&d<=vRadius){color.a=1.0-smoothstep(0.9*vRadius,vRadius,d);}float time=vStartTime+uTime;float range=mod(time,(duration+trail));float percent=0.0;if(range<=duration){percent=range/duration;}else{percent=1.0;}color.a*=abs(1.0-percent*2.0)+0.2;gl_FragColor=color;}",radar:"varying vec4 vPosition;varying float vSize;varying vec4 vFragPosition;varying vec4 vColor;varying float vStartTime;varying float vRadius;uniform mat4 uMatrix;uniform float uTime;uniform float duration;uniform float trail;uniform float uAntiAliasing;varying float vWidth;void main(){float d=distance(vFragPosition.xy,vPosition.xy);if(d>=vRadius){discard;}float time=vStartTime+uTime;float range=mod(time,duration);float percent=range/duration;float center=vSize;float startDeg=360.0*percent;vec4 color=vColor;float deltaX=vFragPosition.x-vPosition.x;float deltaY=vFragPosition.y-vPosition.y;float currDeg=degrees(atan(deltaX/deltaY));if(deltaX>=0.0&&deltaY<=0.0){currDeg=180.0+currDeg;}if(deltaX<=0.0&&deltaY<=0.0){currDeg=180.0+currDeg;}if(deltaX<=0.0&&deltaY>=0.0){currDeg=360.0+currDeg;}float maxDeg=trail;if(trail<0.0){currDeg=-currDeg;maxDeg=-trail;}float modDeg=mod((currDeg-startDeg),360.0);if(modDeg<maxDeg){color.a=modDeg/maxDeg;}else{color.a=0.0;}if(uAntiAliasing==1.0&&d>0.95*vRadius&&d<=vRadius){color.a=color.a-smoothstep(0.95*vRadius,vRadius,d);}gl_FragColor=color;}"},op=function(a){function u(n){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n)),n.name="RippleCircleLayer",n.autoUpdate=!0,n.bufferData=[],n.initializeTime=new Date,n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){var n=1;return this.options.type==="radar"&&(n=120),{depthWrite:!1,depthTest:!0,type:"bubble",size:10,duration:1,trail:n,unit:"px",random:!0,color:"blue",antialias:!0,radius:function(l){return 2*l}}}},{key:"initialize",value:function(n){this.gl=n,this.program=new ii(this.gl,{vertexShader:`attribute vec3 aPos;attribute float aSize;attribute float aIndex;attribute vec4 aColor;attribute float aStartTime;attribute float aRadius;varying vec4 vColor;varying vec4 vPosition;varying vec4 vFragPosition;varying float vSize;varying float vWidth;varying float vStartTime;varying float vRadius;uniform mat4 uMatrix;uniform float uZoomUnits;uniform vec4 uSelectedColor;void main(){vColor=aColor;vStartTime=aStartTime;vSize=aSize*uZoomUnits;vRadius=aRadius*uZoomUnits;float x=aPos.x;float y=aPos.y;float z=aPos.z*uZoomUnits;float R=vRadius;if(aIndex==1.0){x+=R;y-=R;}else if(aIndex==2.0){x-=R;y+=R;}else if(aIndex==3.0){x+=R;y+=R;}else{x-=R;y-=R;}vPosition=vec4(aPos.xy,z,1.0);vFragPosition=vec4(x,y,z,1.0);gl_Position=uMatrix*vFragPosition;
#if defined(PICK)
if(mapvIsPicked()){vColor=uSelectedColor;}
#endif
}`,fragmentShader:hv[this.options.type]||"bubble",defines:this.options.enablePicked?["PICK"]:[]},this),this.buffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new Ke({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"});var l=[{stride:44,name:"aPos",buffer:this.buffer,size:3,type:"FLOAT",offset:0},{stride:44,name:"aSize",buffer:this.buffer,size:1,type:"FLOAT",offset:12},{stride:44,name:"aIndex",buffer:this.buffer,size:1,type:"FLOAT",offset:16},{stride:44,name:"aColor",buffer:this.buffer,size:4,type:"FLOAT",offset:20},{stride:44,name:"aRadius",buffer:this.buffer,size:1,type:"FLOAT",offset:36},{stride:44,name:"aStartTime",buffer:this.buffer,size:1,type:"FLOAT",offset:40}];l=l.concat(this.getCommonAttributes()),this.vertexArray=new pn({gl:n,program:this.program,attributes:l})}},{key:"onChanged",value:function(n,l){this.gl&&l&&(this.uniforms={duration:n.duration,trail:n.trail},this.data=l,this.processData(),n.enablePicked&&this.parsePickData(l))}},{key:"processData",value:function(){var n=this,l=[],v=[];this.data.forEach(function(d,x){var y=d.size||n.options.size,M=d.radius||n.options.radius||1.618*y;typeof M=="function"&&(M=M(y));var D=d.color||n.options.color;D=n.normizedColor(D),d=n.normizedPoint(d.geometry.coordinates);for(var U=n.options.random?Math.random()*n.data.length*9999:0,C=0;4>C;C++)l.push(d[0],d[1],d[2]||0,y,C),l.push(D[0],D[1],D[2],D[3]),l.push(M),l.push(U);y=4*x,0<x&&v.push(y-1,y),v.push(y,y+1,y+2,y+3)}),this.bufferData=l,this.indexData=v,this.buffer.updateData(new Float32Array(l)),this.indexBuffer.updateData(new Uint32Array(v))}},{key:"parsePickData",value:function(n){var l=[];if(this.getOptions().enablePicked){for(var v=0;v<n.length;v++){var d=this.indexToRgb(v);l.push(d[0]/255,d[1]/255,d[2]/255),l.push(d[0]/255,d[1]/255,d[2]/255),l.push(d[0]/255,d[1]/255,d[2]/255),l.push(d[0]/255,d[1]/255,d[2]/255)}this.pickBuffer.updateData(new Float32Array(l))}}},{key:"render",value:function(n){var l=this.getOptions(),v=this.program,d=n.gl,x=n.matrix;v.use(d);var y=this.map.getZoomUnits();Ur(this.uniforms,this.getCommonUniforms(n),{uTime:(new Date-this.initializeTime)/1e3,uZoomUnits:l.unit==="m"?1:y,uMatrix:x,uAntiAliasing:l.antialias?1:0}),v.setUniforms(this.uniforms),this.setGLState({blend:!0,blendEquation:d.FUNC_ADD,blendFunc:rs(d,l.blend||"lighter"),depthTest:l.depthTest,depthMask:l.depthWrite}),0<this.indexData.length&&(this.vertexArray.bind(),this.indexBuffer.bind(),d.drawElements(d.TRIANGLE_STRIP,this.indexData.length,d.UNSIGNED_INT,0))}}]),u}(Ui),tg=Un(hv),E1=Rt(function(a,u){u.__esModule=!0;var n=zo&&zo.__esModule?zo:{default:zo},l=Mc&&Mc.__esModule?Mc:{default:Mc};u.default=function v(d,x,y){d===null&&(d=Function.prototype);var M=(0,l.default)(d,x);if(M===void 0){if(d=(0,n.default)(d),d!==null)return v(d,x,y)}else return"value"in M?M.value:(x=M.get,x===void 0?void 0:x.call(y))}}),ga=Nt(E1);Ge.deviation=function(a,u,n,l){var v=u&&u.length,d=Math.abs(Tr(a,0,v?u[0]*n:a.length,n));if(v){v=0;for(var x=u.length;v<x;v++)d-=Math.abs(Tr(a,u[v]*n,v<x-1?u[v+1]*n:a.length,n))}for(v=u=0;v<l.length;v+=3){x=l[v]*n;var y=l[v+1]*n,M=l[v+2]*n;u+=Math.abs((a[x]-a[M])*(a[y+1]-a[x+1])-(a[x]-a[y])*(a[M+1]-a[x+1]))}return d===0&&u===0?0:Math.abs((u-d)/d)},Ge.flatten=function(a){for(var u=a[0][0].length,n={vertices:[],holes:[],dimensions:u},l=0,v=0;v<a.length;v++){for(var d=0;d<a[v].length;d++)for(var x=0;x<u;x++)n.vertices.push(a[v][d][x]);0<v&&(l+=a[v-1].length,n.holes.push(l))}return n},Ge.default=Ge;var L1=typeof j0=="undefined"?"__target":j0(),sA=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,zu=window.URL||window.webkitURL,Ll=window.Worker;if(Ll){var eg=zi("self.onmessage = function () {}"),R1=new Uint8Array(1);try{if(/(?:Trident|Edge)\/(?:[567]|12)/i.test(navigator.userAgent))throw Error("Not available");var rg=new Ll(eg);rg.postMessage(R1,[R1.buffer])}catch(a){Ll=null}finally{zu.revokeObjectURL(eg),rg&&rg.terminate()}}var aA=new function(a,u){return function(n){var l=this;if(u){if(Ll&&!n)return n=(""+u).replace(/^function.+?{/,"").slice(0,-1),n=zi(n),this[L1]=new Ll(n),zu.revokeObjectURL(n),this[L1];var v={postMessage:function(d){l.onmessage&&setTimeout(function(){return l.onmessage({data:d,target:v})})}};u.call(v),this.postMessage=function(d){setTimeout(function(){return v.onmessage({data:d,target:l})})},this.isThisThread=!0}else return new Ll(a)}}("./worker.js",function(a,u){}),P1={window:1,windowAnimation:2,gradual:3,ripple:4,water:6,repeat:7},Di=function(a){function u(n,l){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n,l)),n.name="ShapeLayer",n._isShow=!0,l=n.getOptions(),(l.style==="windowAnimation"||l.style==="ripple"||0<l.riseTime)&&(n.autoUpdate=!0),n.selectedColor=[-1,-1,-1],n.textureCache={},n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{color:"rgba(50, 50, 230, 1.0)",opacity:1,height:0,isTextureFull:!1,topColor:"rgba(76, 76, 76, 0.8)",textureRotate:0,textureScale:1,useLight:!0,useTopColor:!1,riseTime:0,polygonOffset:[0,0],depthTest:!0,depthFunc:"LEQUAL",zIndex:0,zFightFactor:0}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions();this.dataMgr=new gn(this,this.gl),this.texture=null,this.isUseTexture=!1;var v=[];l.enablePicked&&v.push("PICK"),l.texture&&v.push("USE_TEXTURE"),this.program=new ii(this.gl,{vertexShader:`precision highp float;uniform vec4 uSelectedColor;attribute vec4 a_pos;attribute vec3 a_normal;attribute vec4 a_color;attribute vec4 a_pre_color;attribute float a_height;attribute float a_pre_height;attribute float a_block_index;
#if defined(USE_TEXTURE)
attribute vec2 a_texture_coord;
#endif
uniform mat4 u_proj_matrix;uniform mat4 u_mv_matrix;uniform mat4 u_normal_matrix;uniform vec3 u_side_light_dir;uniform bool u_use_lighting;uniform bool u_use_texture;uniform vec3 u_ripple_center;uniform float u_radius;uniform float style;uniform float alpha;uniform float time;uniform float dataTime;uniform float riseTime;uniform vec2 uMapCenter;uniform float uMapZoom;uniform float u_zIndex;uniform float u_zFightFactor;varying float v_height;varying vec4 v_color;varying vec3 v_position;varying vec2 v_texture_coord;const vec3 point_color=vec3(0.06,0.06,0.06);const vec3 light_color=vec3(0.53,0.53,0.53);const vec3 light_color_2=vec3(0.4,0.4,0.4);const vec3 uAmbientColor=vec3(0.8,0.8,0.8);const vec3 uLightingDirection=vec3(0.0,1.0,1.0);const vec3 uDirectionalColor=vec3(1.0,1.0,1.0);float getTransitionValue(float pre_value,float to_value,float dataTime,float riseTime){float result=0.0;if(pre_value==to_value){result=to_value;}else{if(riseTime>0.0&&dataTime<riseTime){result=(pre_value+(to_value-pre_value)*(dataTime/riseTime));}else{result=to_value;}}return result;}void main(){vec4 pos=a_pos;pos.z=pos.z+pos.w*getTransitionValue(a_pre_height,a_height,dataTime,riseTime);v_position=pos.xyz;v_height=a_height;
#if defined(USE_TEXTURE)
if(u_use_texture){v_texture_coord=a_texture_coord;}
#endif
pos.z+=u_zIndex;vec4 position=u_proj_matrix*u_mv_matrix*vec4(pos.xyz,1.0);gl_Position=position;if(u_zFightFactor>0.){float v_z_offset=-a_block_index/u_zFightFactor;gl_Position.z=gl_Position.z+v_z_offset;}vec4 icolor=a_color;
#if defined(PICK)
if(mapvIsPicked()){icolor=uSelectedColor;}
#endif
if(u_use_lighting){vec3 N=normalize(vec3(u_normal_matrix*vec4(a_normal,1.0)));vec4 point_dir=u_mv_matrix*vec4(0,1,0,0);vec3 L_point=normalize(point_dir.xyz);float lambert_point=max(0.0,dot(N,-L_point));vec4 light_dir=u_mv_matrix*vec4(u_side_light_dir,0);vec3 L=normalize(light_dir.xyz);float lambert=max(0.0,dot(N,-L));if(pos.z<5.0){float deepGradientColor=(5.0-pos.z)/8.0;lambert=lambert-deepGradientColor;}vec4 light_dir_2=u_mv_matrix*vec4(0,0,-1,0);vec3 L2=normalize(light_dir_2.xyz);float lambert_2=max(0.0,dot(N,-L2));if(a_pre_color.r==a_color.r&&a_pre_color.g==a_color.g&&a_pre_color.b==a_color.b){}else{if(riseTime>0.0&&dataTime<riseTime){icolor.r=a_pre_color.r+(a_color.r-a_pre_color.r)*(dataTime/riseTime);icolor.g=a_pre_color.g+(a_color.g-a_pre_color.g)*(dataTime/riseTime);icolor.b=a_pre_color.b+(a_color.b-a_pre_color.b)*(dataTime/riseTime);}}v_color.rgb=icolor.rgb+icolor.rgb*light_color*lambert+icolor.rgb*light_color_2*lambert_2+icolor.rgb*point_color*lambert_point;v_color.a=icolor.a;if(u_use_texture){mat3 normalMatrix=mat3(u_normal_matrix);vec3 transformedNormal=normalMatrix*a_normal;vec3 dir=uLightingDirection;dir=vec3(normalMatrix*vec3(0.0,-1.0,2.0));float directionalLightWeighting=max(dot(normalize(transformedNormal),normalize(dir)),0.0);vec4 vLightWeighting;vLightWeighting=vec4(uAmbientColor+uDirectionalColor*directionalLightWeighting,1.0);v_color=vLightWeighting;}}else{v_color=icolor;}}`,fragmentShader:"precision highp float;varying vec4 v_color;varying vec3 v_position;varying float v_height;varying vec2 v_texture_coord;uniform vec3 u_ripple_center;uniform vec4 top_color;uniform float u_zoom_units;uniform float u_radius;uniform float style;uniform float alpha;uniform float time;uniform sampler2D u_sampler;uniform bool u_use_lighting;uniform bool u_use_texture;uniform bool u_use_top_color;void main(){vec4 color=vec4(v_color);vec4 textureColor=vec4(1.0,1.0,1.0,1.0);if(u_use_texture){if(style==6.0){float x=v_texture_coord.s;float y=v_texture_coord.t;vec2 cPos=-1.0+2.0*gl_FragCoord.xy/MAPV_resolution;float cLength=length(cPos);vec2 uv=gl_FragCoord.xy/MAPV_resolution+(cPos/cLength)*cos(cLength*12.0-time/1000.0*4.0)*0.03;textureColor=texture2D(u_sampler,uv/2.0+vec2(x,y));}else if(style==7.0){float tWidth=1.*u_zoom_units;float deltaX=mod(v_texture_coord.x,tWidth);float deltaY=mod(v_texture_coord.y,tWidth);if(deltaX>=0.&&deltaX<=tWidth){vec2 uv=vec2(deltaX,deltaY)/tWidth;vec4 texture=texture2D(u_sampler,uv);textureColor=texture.a>=0.1 ? texture : vec4(0.,0.,0.,0.);}}else{textureColor=texture2D(u_sampler,vec2(v_texture_coord.s,v_texture_coord.t));}if(u_use_lighting){color=vec4(textureColor*v_color*1.1);}else{color=textureColor;}}if(u_use_top_color&&v_position.z>=v_height){color=top_color;}if(style==1.0||style==2.0){float t=time/1000.0;float diffDistance=5.0;float modX=mod(v_position.x,diffDistance*2.0);float modZ=mod(v_position.z,diffDistance*2.0);if(modX<diffDistance&&modZ<diffDistance&&v_position.z<v_height){color*=1.05;if(time>0.0&&style==2.0){float iX=ceil(v_position.x/diffDistance);float iZ=ceil(v_position.z/diffDistance);float timeDistance=8.0;t+=tan(sin(iZ));color*=(1.0+mod(t,timeDistance)/timeDistance);}}}else if(style==5.0){float t=time/1000.0;float diffDistance=10.0;float modZ=mod(v_position.z-t*40.0,diffDistance*2.0);color.a=1.0-pow(v_position.z/v_height,0.5);if(v_position.z/v_height<0.3){color.r+=0.2;color.g+=0.2;color.b+=0.2;}if(modZ<diffDistance*2.0-4.0){discard;}}else if(style==3.0){float diffDistance=10.0;float modX=mod(v_position.x,diffDistance*2.0);color.a=1.0-pow(v_position.z/v_height,0.3);}else if(style==4.0){float dis=distance(u_ripple_center,v_position);float rSize=400.0;if(v_position.z>=v_height){color=top_color;}if(dis>u_radius-rSize&&dis<u_radius+rSize){color*=(1.0-abs(dis-u_radius)/rSize)*2.0+1.0;}}else if(style==6.0){}color.a*=alpha;gl_FragColor=color;}",defines:v},this),this.vertexBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.colorBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.heightBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.textureBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new Ke({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),v=[{name:"a_pos",buffer:this.vertexBuffer,stride:28,size:4,type:"FLOAT",offset:0},{name:"a_normal",buffer:this.vertexBuffer,size:3,stride:28,type:"FLOAT",offset:16},{name:"a_color",buffer:this.colorBuffer,size:4,stride:32,type:"FLOAT",offset:0},{name:"a_pre_color",buffer:this.colorBuffer,size:4,stride:32,type:"FLOAT",offset:16},{name:"a_height",buffer:this.heightBuffer,size:1,stride:12,type:"FLOAT",offset:0},{name:"a_pre_height",buffer:this.heightBuffer,size:1,stride:12,type:"FLOAT",offset:4},{name:"a_block_index",buffer:this.heightBuffer,size:1,stride:12,type:"FLOAT",offset:8}],l.texture&&v.push({name:"a_texture_coord",buffer:this.textureBuffer,size:2,stride:8,type:"FLOAT",offset:0}),v=v.concat(this.getCommonAttributes()),this.vertexArray=new pn({gl:n,program:this.program,attributes:v}),this.initializeTime=new Date,this.normalMatrix=rr.create()}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(n,l){var v=this;this.gl&&(this.loadTextureTime&&clearTimeout(this.loadTextureTime),this.loadTextureTime=setTimeout(function(){v.loadTexture(function(){v.dataMgr.parseData(l),v.dataTime=new Date,v.webglLayer.render()})},0))}},{key:"render",value:function(n){var l=n.gl,v=n.projectionMatrix,d=n.viewMatrix;if(this._isShow){var x=this.getData();if(x&&!(0>=x.length)){x=this.getOptions();var y=this.program;if(y.use(l),!x.texture||this.texture){var M=0;x.style&&P1[x.style]&&(M=P1[x.style]);var D=[l.ONE,l.ZERO];x.blend?D=rs(l,x.blend):(x.height===0||x.style==="gradual")&&(D=[l.ONE,l.ONE_MINUS_SRC_ALPHA]);var U=l.LEQUAL;x.depthFunc&&(U=l[x.depthFunc.toUpperCase()]),this.setGLState({cullFace:!1,blend:!0,blendEquation:l.FUNC_ADD,blendFunc:D,polygonOffset:x.polygonOffset,depthTest:x.depthTest,depthMask:x.style!=="gradual",depthFunc:U}),D=this.normizedColor(x.topColor),x.style==="ripple"&&x.rippleLayer&&x.rippleLayer.data&&x.rippleLayer.data[0]&&(U=this.normizedPoint(x.rippleLayer.data[0].geometry.coordinates),y.setUniforms({u_ripple_center:[U[0],U[1],0],u_radius:x.rippleLayer.options.size*x.rippleLayer.currentScale})),U=Dr.fromValues(0,-1,2),x.lightDir&&(U=Dr.fromValues(x.lightDir[0],x.lightDir[1],x.lightDir[2]));var C=this.normalMatrix;rr.invert(C,d),rr.transpose(C,C),y.setUniforms(Ur(this.getCommonUniforms(n),{u_normal_matrix:C,u_sampler:this.texture,u_proj_matrix:v,u_mv_matrix:d,u_zoom_units:this.map.getZoomUnits(),style:M,u_use_top_color:x.useTopColor,top_color:D,u_use_lighting:x.useLight,u_use_texture:this.isUseTexture,alpha:parseFloat(x.opacity),time:new Date-this.initializeTime,dataTime:new Date-this.dataTime,riseTime:x.riseTime,u_side_light_dir:U,u_zIndex:x.zIndex,u_zFightFactor:x.zFightFactor})),n=this.dataMgr.getData(),0<n.vertex.length&&(this.vertexArray.bind(),this.indexBuffer.bind(),l.drawElements(l.TRIANGLES,n.index.length,l.UNSIGNED_INT,0))}}}else this.webglLayer.clear()}},{key:"loadTexture",value:function(n){var l=this,v=this.getOptions();v.texture?(this.isUseTexture=!0,Bn(this.gl,v.texture,function(d,x){l.image=x,l.texture=d,n&&n(),l.webglLayer.render()})):(this.isUseTexture=!1,this.image=this.texture=null,n&&n())}}]),u}(Ui);gn.prototype.initData=function(){this.outBuilding3d={pickColorVertex:[],vertex:[],texture:[],color:[],height:[],index:[]}},gn.prototype.getData=function(){return this.outBuilding3d},gn.prototype.initWorker=function(){this.worker=new aA,this.worker.onmessage=function(a){}},gn.prototype.parseData=function(a){var u=this;this.initData();for(var n=this.shapeLayer.getOptions(),l=0;l<a.length;l++){var v=a[l],d=v.height||n.height;"properties"in v&&"height"in v.properties&&(d=v.properties.height),d*=1;var x=v.color||n.color;"properties"in v&&"color"in v.properties&&(x=v.properties.color),"properties"in v&&"fillColor"in v.properties&&(x=v.properties.fillColor),Object.prototype.toString.call(x)==="[object Function]"&&(x=x(v)),x=this.shapeLayer.normizedColor(x);var y=this.shapeLayer.getProperty("angle",n.textureRotate,v),M=void 0;n.enablePicked&&(M=this.shapeLayer.indexToRgb(l));var D=void 0,U=void 0;if(n.riseTime&&(U=v.preColor,"properties"in v&&"preColor"in v.properties&&(U=v.properties.preColor),D=v.preHeight,"properties"in v&&"preHeight"in v.properties&&(D=v.properties.preHeight),D===void 0&&(D=0)),v.geometry.coordinates){if(v.geometry.type==="LineString"){var C=v.geometry.coordinates.map(function(G){return u.shapeLayer.normizedPoint(G)}),E=Ge.flatten([C]);C=E.vertices,E=E.holes;for(var B=[],O=[],H=0;H<C.length;H+=3)B.push(C[H+0],C[H+1]),O.push(C[H+2]);this.parseBuilding3d(this.outBuilding3d,B,O,D,d,U,x,M,y,E,l)}if(v.geometry.type==="MultiPolygon"){for(C=v.geometry.coordinates,v=[],E=0;E<C.length;E++)v.push(C[E].map(function(G){return G.map(function(j){return u.shapeLayer.normizedPoint(j)})}));for(C=0;C<v.length;C++){E=[],B=[],H=Ge.flatten(v[C]),O=H.vertices,H=H.holes;for(var V=0;V<O.length;V+=3)E.push(O[V+0],O[V+1]),B.push(O[V+2]);this.parseBuilding3d(this.outBuilding3d,E,B,D,d,U,x,M,y,H,l)}}else{for(C=[],E=0;E<v.geometry.coordinates.length;E++)C.push(v.geometry.coordinates[E].map(function(G){return u.shapeLayer.normizedPoint(G)}));for(C=Ge.flatten(C),v=C.vertices,C=C.holes,E=[],B=[],O=0;O<v.length;O+=3)E.push(v[O+0],v[O+1]),B.push(v[O+2]);this.parseBuilding3d(this.outBuilding3d,E,B,D,d,U,x,M,y,C,l)}}}this.shapeLayer.vertexBuffer.updateData(new Float32Array(this.outBuilding3d.vertex)),this.shapeLayer.colorBuffer.updateData(new Float32Array(this.outBuilding3d.color)),this.shapeLayer.heightBuffer.updateData(new Float32Array(this.outBuilding3d.height)),this.shapeLayer.textureBuffer.updateData(new Float32Array(this.outBuilding3d.texture)),this.shapeLayer.indexBuffer.updateData(new Uint32Array(this.outBuilding3d.index)),n.enablePicked&&this.shapeLayer.pickBuffer.updateData(new Float32Array(this.outBuilding3d.pickColorVertex))},gn.prototype.getBounds=function(a,u){for(var n=a[0],l=a[1],v=a[0],d=a[1],x=0;x<a.length;x+=2)n=Math.min(a[x],n),l=Math.min(a[x+1],l),v=Math.max(a[x],v),d=Math.max(a[x+1],d);if(x=[(v-n)/2+n,(d-l)/2+l],u===0||!u)return{minX:n,minY:l,maxX:v,maxY:d,width:v-n,height:d-l,center:x};for(n=a.slice(0),l=0;l<n.length;l+=2)v=hn(a[l],a[l+1],x,u),n[l]=v[0],n[l+1]=v[1];return this.getBounds(n,0)},gn.prototype.parseBuilding3d=function(a,u,n,l,v,d,x,y,M,D,U){l===void 0&&(l=v);var C=this.shapeLayer.options,E=a.vertex,B=a.texture,O=a.color,H=a.height,V=a.pickColorVertex;a=a.index,d===void 0&&(d=x);var G=0,j=0;if(this.shapeLayer.image&&(G=this.shapeLayer.image.width*C.textureScale,j=this.shapeLayer.image.height*C.textureScale),C.style!=="gradual"){D=D&&D.length?Ge(u,D,2):Ge(u);var Y=D[0],$=D[1],it=D[2];Y=[u[2*Y],u[2*Y+1],1],$=[u[2*$],u[2*$+1],1];var nt=[u[2*it],u[2*it+1],1];it=[],Dr.cross(it,[nt[0]-$[0],nt[1]-$[1],nt[2]-$[2]],[Y[0]-$[0],Y[1]-$[1],Y[2]-$[2]]),$=E.length/7;var dt;C.texture&&(dt=this.getBounds(u,M)),Y=C.isTextureFull,nt=0;for(var Et=u.length;nt<Et;nt+=2){if(E.push(u[nt],u[nt+1],n[nt/2],1,it[0],it[1],it[2]),O.push(x[0],x[1],x[2],x[3],d[0],d[1],d[2],d[3]),H.push(v,l,U),C.texture){var St=hn(u[nt],u[nt+1],dt.center,M),Xt=Pi(St,2);St=Xt[0],Xt=Xt[1],Y?(St=(St-dt.minX)/dt.width,Xt=(Xt-dt.minY)/dt.height):(St=(St-dt.minX)/G,Xt=(Xt-dt.minY)/j),B.push(St,Xt)}y&&V.push(y[0]/255,y[1]/255,y[2]/255)}for(M=0,dt=D.length;M<dt;M++)a.push(D[M]+$)}if(!(v===l&&0>=v))for(M=0,D=u.length;M<D;M+=2)dt=E.length/7,Et=u[M],St=u[M+1],it=[Et,St,n[M/2],0],$=[Et,St,n[M/2],1],nt=M+2,Xt=M+3,M===D-2&&(nt=0,Xt=1),nt=u[nt],Xt=u[Xt],Et=Math.sqrt(Math.pow(nt-Et,2),Math.pow(Xt-St,2)),St=[nt,Xt,n[M/2],0],nt=[nt,Xt,n[M/2],1],Xt=[],Dr.cross(Xt,[St[0]-it[0],St[1]-it[1],St[2]-it[2]],[$[0]-it[0],$[1]-it[1],$[2]-it[2]]),E.push(it[0],it[1],it[2],it[3]),E.push(Xt[0],Xt[1],Xt[2]),E.push($[0],$[1],$[2],$[3]),E.push(Xt[0],Xt[1],Xt[2]),E.push(St[0],St[1],St[2],St[3]),E.push(Xt[0],Xt[1],Xt[2]),E.push(nt[0],nt[1],nt[2],nt[3]),E.push(Xt[0],Xt[1],Xt[2]),O.push(x[0],x[1],x[2],x[3]),O.push(d[0],d[1],d[2],d[3]),O.push(x[0],x[1],x[2],x[3]),O.push(d[0],d[1],d[2],d[3]),O.push(x[0],x[1],x[2],x[3]),O.push(d[0],d[1],d[2],d[3]),O.push(x[0],x[1],x[2],x[3]),O.push(d[0],d[1],d[2],d[3]),H.push(v),H.push(l),H.push(U),H.push(v),H.push(l),H.push(U),H.push(v),H.push(l),H.push(U),H.push(v),H.push(l),H.push(U),C.texture&&(Y?(B.push(0,0),B.push(0,1),B.push(1,0),B.push(1,1)):(B.push(0,0),B.push(0,v/j),B.push(Et/G,0),B.push(Et/G,v/j))),y&&(V.push(y[0]/255,y[1]/255,y[2]/255),V.push(y[0]/255,y[1]/255,y[2]/255),V.push(y[0]/255,y[1]/255,y[2]/255),V.push(y[0]/255,y[1]/255,y[2]/255)),a.push(dt,dt+2,dt+3,dt,dt+3,dt+1)};var ma=Rt(function(a,u){(function(n,l){a.exports=l()})(ll,function(){function n(G,j,Y,$,it){for(;$>Y;){if(600<$-Y){var nt=$-Y+1,dt=j-Y+1,Et=Math.log(nt),St=.5*Math.exp(2*Et/3);Et=.5*Math.sqrt(Et*St*(nt-St)/nt)*(0>dt-nt/2?-1:1),n(G,j,Math.max(Y,Math.floor(j-dt*St/nt+Et)),Math.min($,Math.floor(j+(nt-dt)*St/nt+Et)),it)}for(nt=G[j],dt=Y,St=$,l(G,Y,j),0<it(G[$],nt)&&l(G,Y,$);dt<St;){for(l(G,dt,St),dt++,St--;0>it(G[dt],nt);)dt++;for(;0<it(G[St],nt);)St--}it(G[Y],nt)===0?l(G,Y,St):(St++,l(G,St,$)),St<=j&&(Y=St+1),j<=St&&($=St-1)}}function l(G,j,Y){var $=G[j];G[j]=G[Y],G[Y]=$}function v(G,j){return G<j?-1:G>j?1:0}function d(G,j){x(G,0,G.children.length,j,G)}function x(G,j,Y,$,it){for(it||(it=O(null)),it.minX=Infinity,it.minY=Infinity,it.maxX=-Infinity,it.maxY=-Infinity;j<Y;j++){var nt=G.children[j];y(it,G.leaf?$(nt):nt)}return it}function y(G,j){return G.minX=Math.min(G.minX,j.minX),G.minY=Math.min(G.minY,j.minY),G.maxX=Math.max(G.maxX,j.maxX),G.maxY=Math.max(G.maxY,j.maxY),G}function M(G,j){return G.minX-j.minX}function D(G,j){return G.minY-j.minY}function U(G){return(G.maxX-G.minX)*(G.maxY-G.minY)}function C(G){return G.maxX-G.minX+(G.maxY-G.minY)}function E(G,j){return G.minX<=j.minX&&G.minY<=j.minY&&j.maxX<=G.maxX&&j.maxY<=G.maxY}function B(G,j){return j.minX<=G.maxX&&j.minY<=G.maxY&&j.maxX>=G.minX&&j.maxY>=G.minY}function O(G){return{children:G,height:1,leaf:!0,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function H(G,j,Y,$,it){for(var nt=[j,Y];nt.length;)if(Y=nt.pop(),j=nt.pop(),!(Y-j<=$)){var dt=j+Math.ceil((Y-j)/$/2)*$;n(G,dt,j||0,Y||G.length-1,it||v),nt.push(j,dt,dt,Y)}}var V=function(G){G===void 0&&(G=9),this._maxEntries=Math.max(4,G),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};return V.prototype.all=function(){return this._all(this.data,[])},V.prototype.search=function(G){var j=this.data,Y=[];if(!B(G,j))return Y;for(var $=this.toBBox,it=[];j;){for(var nt=0;nt<j.children.length;nt++){var dt=j.children[nt],Et=j.leaf?$(dt):dt;B(G,Et)&&(j.leaf?Y.push(dt):E(G,Et)?this._all(dt,Y):it.push(dt))}j=it.pop()}return Y},V.prototype.collides=function(G){var j=this.data;if(!B(G,j))return!1;for(var Y=[];j;){for(var $=0;$<j.children.length;$++){var it=j.children[$],nt=j.leaf?this.toBBox(it):it;if(B(G,nt)){if(j.leaf||E(G,nt))return!0;Y.push(it)}}j=Y.pop()}return!1},V.prototype.load=function(G){if(!G||!G.length)return this;if(G.length<this._minEntries){for(var j=0;j<G.length;j++)this.insert(G[j]);return this}return G=this._build(G.slice(),0,G.length-1,0),this.data.children.length?this.data.height===G.height?this._splitRoot(this.data,G):(this.data.height<G.height&&(j=this.data,this.data=G,G=j),this._insert(G,this.data.height-G.height-1,!0)):this.data=G,this},V.prototype.insert=function(G){return G&&this._insert(G,this.data.height-1),this},V.prototype.clear=function(){return this.data=O([]),this},V.prototype.remove=function(G,j){if(!G)return this;for(var Y=this.data,$=this.toBBox(G),it=[],nt=[],dt,Et,St;Y||it.length;){if(Y||(Y=it.pop(),Et=it[it.length-1],dt=nt.pop(),St=!0),Y.leaf){t:{var Xt=G,te=Y.children,Ie=j;if(Ie){for(var pe=0;pe<te.length;pe++)if(Ie(Xt,te[pe])){Xt=pe;break t}Xt=-1}else Xt=te.indexOf(Xt)}if(Xt!==-1){Y.children.splice(Xt,1),it.push(Y),this._condense(it);break}}St||Y.leaf||!E(Y,$)?Et?(dt++,Y=Et.children[dt],St=!1):Y=null:(it.push(Y),nt.push(dt),dt=0,Et=Y,Y=Y.children[0])}return this},V.prototype.toBBox=function(G){return G},V.prototype.compareMinX=function(G,j){return G.minX-j.minX},V.prototype.compareMinY=function(G,j){return G.minY-j.minY},V.prototype.toJSON=function(){return this.data},V.prototype.fromJSON=function(G){return this.data=G,this},V.prototype._all=function(G,j){for(var Y=[];G;)G.leaf?j.push.apply(j,G.children):Y.push.apply(Y,G.children),G=Y.pop();return j},V.prototype._build=function(G,j,Y,$){var it=Y-j+1,nt=this._maxEntries;if(it<=nt){var dt=O(G.slice(j,Y+1));return d(dt,this.toBBox),dt}for($||($=Math.ceil(Math.log(it)/Math.log(nt)),nt=Math.ceil(it/Math.pow(nt,$-1))),dt=O([]),dt.leaf=!1,dt.height=$,it=Math.ceil(it/nt),nt=it*Math.ceil(Math.sqrt(nt)),H(G,j,Y,nt,this.compareMinX);j<=Y;j+=nt){var Et=Math.min(j+nt-1,Y);H(G,j,Et,it,this.compareMinY);for(var St=j;St<=Et;St+=it)dt.children.push(this._build(G,St,Math.min(St+it-1,Et),$-1))}return d(dt,this.toBBox),dt},V.prototype._chooseSubtree=function(G,j,Y,$){for(;$.push(j),!(j.leaf||$.length-1===Y);){for(var it=Infinity,nt=Infinity,dt=void 0,Et=0;Et<j.children.length;Et++){var St=j.children[Et],Xt=U(St),te=(Math.max(St.maxX,G.maxX)-Math.min(St.minX,G.minX))*(Math.max(St.maxY,G.maxY)-Math.min(St.minY,G.minY))-Xt;te<nt?(nt=te,it=Xt<it?Xt:it,dt=St):te===nt&&Xt<it&&(it=Xt,dt=St)}j=dt||j.children[0]}return j},V.prototype._insert=function(G,j,Y){Y=Y?G:this.toBBox(G);var $=[],it=this._chooseSubtree(Y,this.data,j,$);for(it.children.push(G),y(it,Y);0<=j&&$[j].children.length>this._maxEntries;)this._split($,j),j--;this._adjustParentBBoxes(Y,$,j)},V.prototype._split=function(G,j){var Y=G[j],$=Y.children.length,it=this._minEntries;this._chooseSplitAxis(Y,it,$),$=this._chooseSplitIndex(Y,it,$),$=O(Y.children.splice($,Y.children.length-$)),$.height=Y.height,$.leaf=Y.leaf,d(Y,this.toBBox),d($,this.toBBox),j?G[j-1].children.push($):this._splitRoot(Y,$)},V.prototype._splitRoot=function(G,j){this.data=O([G,j]),this.data.height=G.height+1,this.data.leaf=!1,d(this.data,this.toBBox)},V.prototype._chooseSplitIndex=function(G,j,Y){for(var $,it=Infinity,nt=Infinity,dt=j;dt<=Y-j;dt++){var Et=x(G,0,dt,this.toBBox),St=x(G,dt,Y,this.toBBox),Xt=Math.max(0,Math.min(Et.maxX,St.maxX)-Math.max(Et.minX,St.minX))*Math.max(0,Math.min(Et.maxY,St.maxY)-Math.max(Et.minY,St.minY));Et=U(Et)+U(St),Xt<it?(it=Xt,$=dt,nt=Et<nt?Et:nt):Xt===it&&Et<nt&&(nt=Et,$=dt)}return $||Y-j},V.prototype._chooseSplitAxis=function(G,j,Y){var $=G.leaf?this.compareMinX:M,it=G.leaf?this.compareMinY:D,nt=this._allDistMargin(G,j,Y,$);j=this._allDistMargin(G,j,Y,it),nt<j&&G.children.sort($)},V.prototype._allDistMargin=function(G,j,Y,$){G.children.sort($),$=this.toBBox;for(var it=x(G,0,j,$),nt=x(G,Y-j,Y,$),dt=C(it)+C(nt),Et=j;Et<Y-j;Et++){var St=G.children[Et];y(it,G.leaf?$(St):St),dt+=C(it)}for(Y=Y-j-1;Y>=j;Y--)it=G.children[Y],y(nt,G.leaf?$(it):it),dt+=C(nt);return dt},V.prototype._adjustParentBBoxes=function(G,j,Y){for(;0<=Y;Y--)y(j[Y],G)},V.prototype._condense=function(G){for(var j=G.length-1,Y;0<=j;j--)G[j].children.length===0?0<j?(Y=G[j-1].children,Y.splice(Y.indexOf(G[j]),1)):this.clear():d(G[j],this.toBBox)},V})}),Uu=function(a){function u(n){Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n)),n.name="TextLayer",n.dataChanged=!1,n.currentZoom;var l=n.canvas=document.createElement("canvas");return l=n.ctx=l.getContext("2d"),l.textAlign="start",l.textBaseline="top",n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{depthWrite:!1,depthTest:!0,color:"#fff",fontFamily:"Microsoft Yahei",fontSize:14,lineWidth:2,lineHeight:20,textAlign:"center",flat:!1,collides:!0,textMaxWidth:0,textMaxHeight:0,unit:"px",angle:0,offset:[0,0],padding:[2,2],margin:[0,0],polygonOffset:[0,0],shadow:{},stroke:{color:""}}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions();this.texture=null,this.lastUpdateTime=0,this.program=new ii(this.gl,{vertexShader:"precision highp float;uniform mat4 matrix;uniform bool uFlat;uniform bool uUnitPx;uniform float zoomUnits;uniform float devicePixelRatio;uniform float zIndex;uniform vec2 offset;attribute vec3 position;attribute float corner;attribute float scale;attribute float rotation;attribute vec2 size;attribute vec2 aTextCoord;varying vec2 vTextCoord;/***\u70B9A(x,y)\uFF0C\u7ED5\u539F\u70B9\u987A\u65F6\u9488\u65CB\u8F6C\u89D2\u5EA6a\u65B0\u5750\u6807\u7684\u8BA1\u7B97\u516C\u5F0F*x1=x*cos(a)+y*sin(a)*y1=y*cos(a)-x*sin(a)*/vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;if(corner==1.0){x+=-size.x*cos(rotation)+size.y*sin(rotation);y+=size.y*cos(rotation)+size.x*sin(rotation);}else if(corner==2.0){x+=size.x*cos(rotation)+size.y*sin(rotation);y+=size.y*cos(rotation)-size.x*sin(rotation);}else if(corner==3.0){x+=size.x*cos(rotation)-size.y*sin(rotation);y+=-size.y*cos(rotation)-size.x*sin(rotation);}else{x+=-size.x*cos(rotation)-size.y*sin(rotation);y+=-size.y*cos(rotation)+size.x*sin(rotation);}return vec3(x,y,coord.z);}void main(){vTextCoord=aTextCoord;if(uFlat){vec2 pixelOffset=offset;vec2 halfSize=size/2.0*scale;if(uUnitPx){halfSize*=zoomUnits;pixelOffset*=zoomUnits;}vec3 current=transformCoord(position,halfSize,corner);current.z+=zIndex;gl_Position=matrix*vec4(current.x+pixelOffset[0],current.y-pixelOffset[1],current.z,1.0);}else{vec4 pos=matrix*vec4(position,1.0);vec3 screen=pos.xyz/pos.w;vec2 halfSize=size/MAPV_resolution*devicePixelRatio*scale;vec2 positionOffset=offset*2./MAPV_resolution*devicePixelRatio;if(!uUnitPx){halfSize/=zoomUnits;positionOffset/=zoomUnits;}vec3 current=transformCoord(screen,halfSize,corner);current.xy=current.xy-positionOffset;current.z+=zIndex;gl_Position=vec4(current,1.0);}}",fragmentShader:`precision highp float;uniform sampler2D textureImage;uniform vec4 uSelectedColor;varying vec2 vTextCoord;void main(){gl_FragColor=texture2D(textureImage,vec2(vTextCoord.x,1.0-vTextCoord.y));
#if defined(PICK)
if(mapvIsPicked()){gl_FragColor=vec4(uSelectedColor.rgb,gl_FragColor.a);}
#endif
}`,defines:l.enablePicked?["PICK"]:[]},this),this.vertexBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new Ke({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),l=[{name:"position",buffer:this.vertexBuffer,size:3,stride:32,type:"FLOAT",offset:0},{name:"corner",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:12},{name:"size",buffer:this.vertexBuffer,size:2,stride:32,type:"FLOAT",offset:16},{name:"scale",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:24},{name:"rotation",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:28},{name:"aTextCoord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}],l=l.concat(this.getCommonAttributes()),this.vertexArray=new pn({gl:n,program:this.program,attributes:l})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(n,l){this.gl&&this.processCache(n,l)}},{key:"processCache",value:function(n,l){this.cachedData=[],this.dataChanged=!0;for(var v=0;v<l.length;v++){var d=this.normizedPoint(l[v].geometry.coordinates),x=l[v].text;"properties"in l[v]&&"text"in l[v].properties&&(x=l[v].properties.text);var y=this.getProperty("angle",n.angle,l[v]),M=this.getProperty("color",n.color,l[v]);d&&x!==void 0&&this.cachedData.push({point:d,text:x,angle:y,color:M,index:v})}}},{key:"render",value:function(n){if(this.cachedData&&this.cachedData.length&&this.map){var l=n.gl,v=n.matrix,d=this.getOptions(),x=this.program;x.use(l);var y=this.map.getZoomUnits();(this.dataChanged||this.currentZoom!==y||!n.isPickRender)&&(this.throttleUpdate(n),this.currentZoom=y),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA],polygonOffset:d.polygonOffset,depthTest:d.depthTest,depthMask:d.depthWrite}),x.setUniforms(Ur(this.getCommonUniforms(n),{matrix:v,devicePixelRatio:1<(window.BMAPGL_FORCE_RATIO||window.devicePixelRatio)?2:1,textureImage:this.texture,uFlat:d.flat,offset:d.offset,zoomUnits:y,zIndex:d.zIndex,uUnitPx:d.unit==="px"})),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),l.drawElements(l.TRIANGLES,this.index.length,l.UNSIGNED_INT,0)),this.dataChanged=!1}}},{key:"throttleUpdate",value:function(n){this.updateText(n)}},{key:"updateText",value:function(n){var l=n.gl,v=n.matrix,d=this.getOptions(),x=d.fontSize,y=d.fontFamily,M=d.padding,D=d.margin,U=d.collides;n=d.enablePicked;var C=d.shadow,E=d.textMaxWidth,B=d.textMaxHeight,O=l.canvas.width/window.devicePixelRatio,H=l.canvas.height/window.devicePixelRatio;d=this.canvas,l=this.ctx,l.fillStyle="#6c0",l.save(),l.scale(window.devicePixelRatio,window.devicePixelRatio),l.textBaseline="top",l.font="20px "+y;for(var V=new ma,G=[],j=void 0,Y=0;Y<this.cachedData.length;Y++){var $=this.cachedData[Y],it=$.point,nt=$.text,dt=$.angle,Et=$.color;$=$.index;var St=Pi(it,3),Xt=sn.clone([St[0],St[1],St[2],1]);sn.transformMat4(Xt,Xt,v),sn.scale(Xt,Xt,1/Xt[3]);var te=this.map.getHeading()%360;St=(Xt[0]+1)/2*O,Xt=(-Xt[1]+1)/2*H;var Ie=St*Math.cos(te*Math.PI/180)-Xt*Math.sin(te*Math.PI/180),pe=St*Math.sin(te*Math.PI/180)+Xt*Math.cos(te*Math.PI/180),be=l.measureText(nt),yr=be.width+2*M[0];te=20,be.actualBoundingBoxAscent&&be.actualBoundingBoxDescent&&(te=be.actualBoundingBoxDescent-be.actualBoundingBoxAscent),te+=2*M[1],be=yr+D[0];var oe=te+D[1];Ie-=be/2,pe-=oe/2;var Be=Ie+be,wr=pe+oe;if(!(0>St+be/2||0>Xt+oe/2||St-be/2>O||Xt-oe/2>H)){if(U){if(St={minX:Ie,maxX:Be,minY:pe,maxY:wr},V.collides(St))continue;V.insert(St)}St=j=E||yr,G.push({w:St,h:B||te,point:it,text:nt,angle:dt,color:Et,dataIndex:$})}}l.restore(),D=mn(G),v=D.w,D=D.h,0>=v&&(v=1),0>=D&&(D=1),d.width=2*v,d.height=2*D,l.save(),l.scale(2,2),l.textBaseline="top",l.font="20px "+y,l.shadowColor=C&&C.color,l.shadowOffsetX=C&&C.offsetX,l.shadowOffsetY=C&&C.offsetY,l.shadowBlur=C&&C.blur,C=this.buildVertex(l,G,v,D,{padding:M,fontSize:x,defaultFontSize:20,enablePicked:n,cWidth:j}),x=C.vertex,y=C.textureCoord,M=C.indices,C=C.pick,l.restore(),this.loadTexture(),this.index=M,this.vertexBuffer.updateData(new Float32Array(x)),this.uvBuffer.updateData(new Float32Array(y)),this.indexBuffer.updateData(new Uint32Array(M)),n&&this.pickBuffer.updateData(new Float32Array(C))}},{key:"wrapText",value:function(n,l,v,d,x,y,M){if(l&&typeof l=="string"){var D=this.getOptions().stroke;l=l.split("");for(var U="",C=0;C<l.length;C++){var E=U+l[C];n.measureText(E).width>x&&0<C?(M==="left"?(D.color&&n.strokeText(U,v,d),n.fillText(U,v,d)):(D.color&&n.strokeText(U,v+(x-n.measureText(U).width)/2,d),n.fillText(U,v+(x-n.measureText(U).width)/2,d)),U=l[C],d+=y):U=E}M==="left"?(D.color&&n.strokeText(U,v,d),n.fillText(U,v,d)):(D.color&&n.strokeText(U,v+(x-n.measureText(U).width)/2,d),n.fillText(U,v+(x-n.measureText(U).width)/2,d))}}},{key:"buildVertex",value:function(n,l,v,d,x){var y=this.getOptions(),M=y.stroke,D=y.lineWidth,U=y.lineHeight,C=y.textMaxWidth;y=y.textAlign;var E=[],B=[],O=[],H=[];M.color&&(n.lineWidth=D,n.strokeStyle=M.color),D=0;for(var V=l.length;D<V;++D){var G=l[D],j=G.x+x.padding[0],Y=G.y+x.padding[1];n.fillStyle=G.color,C?this.wrapText(n,G.text,j,Y,x.cWidth,U,y):(M.color&&n.strokeText(G.text,j,Y),n.fillText(G.text,j,Y));var $=Pi(G.point,3);j=$[0],Y=$[1],$=$[2];for(var it=0;4>it;it++)E.push(j,Y,$),E.push(it),E.push(G.w,G.h),E.push(x.fontSize/x.defaultFontSize,G.angle*Math.PI/180);j=G.x/v,Y=(G.x+G.w)/v,$=(G.y+G.h)/d,it=G.y/d,B.push(j,$,j,it,Y,it,Y,$),j=4*D,O.push(j,j+2,j+1,j,j+3,j+2),x.enablePicked&&(G=this.indexToRgb(G.dataIndex),H.push(G[0]/255,G[1]/255,G[2]/255),H.push(G[0]/255,G[1]/255,G[2]/255),H.push(G[0]/255,G[1]/255,G[2]/255),H.push(G[0]/255,G[1]/255,G[2]/255))}return{vertex:E,textureCoord:B,indices:O,pick:H}}},{key:"loadTexture",value:function(){var n=this;this.canvas?Bn(this.gl,this.canvas,function(l){n.texture=l},{TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}):this.texture=null}}]),u}(Ui),hu=function(a){function u(n){return Ye(this,u),Pr(this,(u.__proto__||lr(u)).call(this,n))}return Rr(u,a),qe(u,[{key:"initialize",value:function(n){var l=this;this.children&&this.children.forEach(function(v){v.map=l.map,v.setWebglLayer(l.getWebglLayer()),v.commonInitialize&&v.commonInitialize(n),v.initialize&&v.initialize(n),v.onOptionsChanged(v.getOptions()),v.onDataChanged(v.getData()),v.onChanged(v.getOptions(),v.getData())})}},{key:"isRequestAnimation",value:function(){if(this.autoUpdate!==void 0)return ga(u.prototype.__proto__||lr(u.prototype),"isRequestAnimation",this).call(this);for(var n=!1,l=0;l<this.children.length;l++)if(this.children[l].isRequestAnimation()){n=!0;break}return n}},{key:"render",value:function(n){this.children&&this.children.forEach(function(l){l.render(n)})}},{key:"onDestroy",value:function(n){this.children&&this.children.forEach(function(l){l.onDestroy(n)})}}]),u}(da),uA=function(a){function u(n){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n)),n.preHeightMapper={},n.preColorMapper={},n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return Ur(ga(u.prototype.__proto__||lr(u.prototype),"getDefaultOptions",this).call(this),{style:"grid",gridSize:500,gridGap:5,height:function(){return 1e3},color:function(){return"rgb(200, 200, 20)"}})}},{key:"generateGrid",value:function(n,l){var v=l.gridSize,d=[],x={};l=n.length;for(var y=this.getPointOffset(),M=0;M<l;M++){var D=this.normizedPoint(n[M].geometry.coordinates);D=~~((D[0]+y[0])/v)+"_"+~~((D[1]+y[1])/v),x[D]===void 0&&(x[D]=0);var U=~~n[M].count||1;"properties"in n[M]&&"count"in n[M].properties&&(U=~~n[M].properties.count),x[D]+=U}return Un(x).forEach(function(C){var E=C.split("_");d.push([E[0]*v+v/2,E[1]*v+v/2,x[C]])}),d}},{key:"onChanged",value:function(n,l){l=this.processData(l),ga(u.prototype.__proto__||lr(u.prototype),"onChanged",this).call(this,n,l)}},{key:"getGridDataRange",value:function(){var n=this.gridData,l=void 0,v=void 0;n[0]&&(l=n[0][2],v=n[0][2]);for(var d=n.length,x=0;x<d;x++){var y=n[x];l=Math.max(y[2],l),v=Math.min(y[2],v)}return{max:l/2,min:v}}},{key:"processData",value:function(n){var l=this.getOptions(),v=l.gridSize,d=[];if(l.style==="normal")for(var x=this.getPointOffset(),y=0;y<n.length;y++){var M=this.normizedPoint(n[y].geometry.coordinates),D=M[0]+x[0];M=M[1]+x[1];var U=~~n[y].count||1;"properties"in n[y]&&"count"in n[y].properties&&(U=~~n[y].properties.count);var C=n[y].color;"properties"in n[y]&&"color"in n[y].properties&&(C=~~n[y].properties.color),d.push([D,M,U,C])}else d=this.generateGrid(n,l);for(n=[],this._preHeightMapper={},this._preColorMapper={},x=0;x<d.length;x++)y=d[x],y[0]=y[0],y[1]=y[1],D=y[2],l.height&&(D=typeof l.height=="function"?l.height({count:y[2],coordinates:[y[0],y[1]]}):l.height),M=v/2-l.gridGap,U=y[3],l.color&&(U=typeof l.color=="function"?l.color({count:y[2],color:y[3]}):Ft(U||l.color).unitArray()),C="p"+y[0]+y[1],n.push({geometry:{type:"Polygon",coordinates:[[[y[0]-M,y[1]-M],[y[0]-M,y[1]+M],[y[0]+M,y[1]+M],[y[0]+M,y[1]-M]]]},color:U,origin:y,count:y[2],preHeight:this.preHeightMapper[C],preColor:this.preColorMapper[C],height:D}),this._preHeightMapper[C]=D,this._preColorMapper[C]=U;return this.preHeightMapper=this._preHeightMapper,this.preColorMapper=this._preColorMapper,this.gridData=n}}]),u}(Di),D1=function(a){function u(n){Ye(this,u);var l=Pr(this,(u.__proto__||lr(u)).call(this,n));return l.gridLayer=new uA(n),l.options.textOptions=Ur({show:!1,flat:!0,unit:"m",fontSize:100,collides:!1},n.textOptions||{}),l.textLayer=new Uu(l.options.textOptions),l.children=[l.gridLayer,l.textLayer],l}return Rr(u,a),qe(u,[{key:"pick",value:function(n,l){return this.gridLayer.pick(n,l)}},{key:"setData",value:function(n){this.gridLayer.setData(n),this.options.textOptions.show&&this.setTextData()}},{key:"setTextData",value:function(){var n=this.gridLayer.gridData.map(function(l){return{geometry:{type:"Point",coordinates:[l.origin[0],l.origin[1],l.height+5]},properties:{text:l.count}}});this.textLayer.setData(n)}},{key:"setOptions",value:function(){var n=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},l=this.options.textOptions;Ur(this.options,n),this.gridLayer.setOptions(this.options),n.textOptions&&(this.options.textOptions.show&&this.setTextData(),this.options.textOptions=Ur(l||{},n.textOptions),this.textLayer.setOptions(this.options.textOptions))}},{key:"getData",value:function(){return this.gridLayer.getData()}},{key:"render",value:function(n){this.gridLayer.render(n),this.options.textOptions.show&&this.textLayer.render(n)}}]),u}(hu),Rl=function(a){function u(n){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n)),n.gridLayer=new D1(n.getGridOptions()),n.children=[n.gridLayer],n.options.riseTime&&(n.autoUpdate=!0),n}return Rr(u,a),qe(u,[{key:"pick",value:function(n,l){return this.gridLayer.pick(n,l)}},{key:"onDataChanged",value:function(n){this.gridLayer.setData(n)}},{key:"getGridOptions",value:function(){var n=this.getOptions(),l=n.max,v=n.min;l===void 0&&(v=this.gridLayer.getGridDataRange(),l=v.max,v=v.min);var d=new Wi({max:l,min:v,gradient:n.gradient,maxSize:n.maxHeight,minSize:n.minHeight});return n.height=function(x){var y=d.getSize(x.count);return"properties"in x&&"count"in x.properties&&(y=d.getSize(x.properties.count)),y},n.color=function(x){var y=d.getImageData(x.count);return"properties"in x&&"count"in x.properties&&(y=d.getImageData(x.properties.count)),[y[0]/255,y[1]/255,y[2]/255,y[3]/255]},n}},{key:"onOptionsChanged",value:function(n){this.gridLayer.setOptions(this.getGridOptions())}},{key:"getDefaultOptions",value:function(){return{enablePicked:!1,selectedIndex:-1,selectedColor:"#ff0000",autoSelect:!0,style:"grid",gridSize:500,maxHeight:8e3,minHeight:200,gradient:{0:"rgb(50, 50, 256)","0.1":"rgb(50, 250, 56)","0.5":"rgb(250, 250, 56)",1:"rgb(250, 50, 56)"}}}}]),u}(hu),ig=function(a){function u(n,l){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n,l)),n.name="SimpleLineLayer",n.bufferData=[],n}return Rr(u,a),qe(u,[{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions();this.program=new ii(this.gl,{vertexShader:`uniform mat4 u_matrix;attribute vec3 aPos;attribute vec4 aColor;varying vec4 vColor;
#if defined(DASH)
varying vec3 vPos;
#endif
void main(){if(aColor.w>=0.0&&aColor.w<=1.0){vColor=aColor;}else{vColor=vec4(aColor.xyz,1.0);}gl_Position=u_matrix*vec4(aPos,1.0);
#if defined(DASH)
vPos=aPos;
#endif
}`,fragmentShader:`precision highp float;varying vec4 vColor;varying vec3 vPos;void main(){
#if defined(DASH)
if(mod(vPos.x,3.0)<1.5){discard;}
#endif
gl_FragColor=vColor;}`,defines:l.useDash?["DASH"]:""},this),this.buffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexArray=new pn({gl:n,program:this.program,attributes:[{stride:28,name:"aPos",buffer:this.buffer,size:3,type:"FLOAT",offset:0},{stride:28,name:"aColor",buffer:this.buffer,size:4,type:"FLOAT",offset:12}]})}},{key:"onDestroy",value:function(){this.bufferData=[]}},{key:"onChanged",value:function(n,l){var v=this;if(this.gl){var d=[],x=function(C,E){if(C)for(var B=0;B<C.length-1;B++){var O=v.normizedPoint(C[B]);d.push(O[0]),d.push(O[1]),d.push(O[2]),d.push(E[0],E[1],E[2],E[3]),O=v.normizedPoint(C[B+1]),d.push(O[0]),d.push(O[1]),d.push(O[2]),d.push(E[0],E[1],E[2],E[3])}};n=n.color;for(var y=0;y<l.length;y++){var M=this.getProperty("color",n,l[y]);M=this.normizedColor(M);var D=l[y].geometry,U=D.coordinates;if(D.type==="MultiPolygon"){if(U)for(D=0;D<U.length;D++)x(U[D][0],M)}else if(D.type==="Polygon")U&&x(U[0],M);else if(D.type==="MultiLineString"){if(U)for(D=0;D<U.length;D++)x(U[D],M)}else x(U,M)}this.bufferData=d,this.buffer.updateData(new Float32Array(d))}}},{key:"render",value:function(n){var l=n.gl;if(n=n.matrix,this.bufferData&&!(0>=this.bufferData.length)){var v=this.program;v.use(l),this.vertexArray.bind(),v.setUniforms({u_matrix:n}),n=this.getOptions(),this.setGLState({blend:!0,blendFunc:n.blend==="lighter"?[l.SRC_ALPHA,l.ONE]:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA],blendEquation:l.FUNC_ADD}),l.drawArrays(l.LINES,0,this.bufferData.length/7)}}}]),u}(Ui),lA=Ff.f("species"),sp=Rt(function(a){a.exports={default:lA,__esModule:!0}});Nt(sp);var O1=typeof Dt.g!="undefined"?Dt.g:typeof self!="undefined"?self:typeof window!="undefined"?window:{},va=[],Es=[],hA=typeof Uint8Array!="undefined"?Uint8Array:Array,ng=!1,F1={}.toString,B1=Array.isArray||function(a){return F1.call(a)=="[object Array]"};xe.TYPED_ARRAY_SUPPORT=O1.TYPED_ARRAY_SUPPORT!==void 0?O1.TYPED_ARRAY_SUPPORT:!0,xe.poolSize=8192,xe._augment=function(a){return a.__proto__=xe.prototype,a},xe.from=function(a,u,n){return rn(null,a,u,n)},xe.TYPED_ARRAY_SUPPORT&&(xe.prototype.__proto__=Uint8Array.prototype,xe.__proto__=Uint8Array),xe.alloc=function(a,u,n){return cn(a),a=0>=a?Yi(null,a):u!==void 0?typeof n=="string"?Yi(null,a).fill(u,n):Yi(null,a).fill(u):Yi(null,a),a},xe.allocUnsafe=function(a){return vn(null,a)},xe.allocUnsafeSlow=function(a){return vn(null,a)},xe.isBuffer=function(a){return a!=null&&(!!a._isBuffer||id(a)||typeof a.readFloatLE=="function"&&typeof a.slice=="function"&&id(a.slice(0,0)))},xe.compare=function(a,u){if(!no(a)||!no(u))throw new TypeError("Arguments must be Buffers");if(a===u)return 0;for(var n=a.length,l=u.length,v=0,d=Math.min(n,l);v<d;++v)if(a[v]!==u[v]){n=a[v],l=u[v];break}return n<l?-1:l<n?1:0},xe.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},xe.concat=function(a,u){if(!B1(a))throw new TypeError('"list" argument must be an Array of Buffers');if(a.length===0)return xe.alloc(0);var n;if(u===void 0)for(n=u=0;n<a.length;++n)u+=a[n].length;u=xe.allocUnsafe(u);var l=0;for(n=0;n<a.length;++n){var v=a[n];if(!no(v))throw new TypeError('"list" argument must be an Array of Buffers');v.copy(u,l),l+=v.length}return u},xe.byteLength=qa,xe.prototype._isBuffer=!0,xe.prototype.swap16=function(){var a=this.length;if(a%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var u=0;u<a;u+=2)Ln(this,u,u+1);return this},xe.prototype.swap32=function(){var a=this.length;if(a%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var u=0;u<a;u+=4)Ln(this,u,u+3),Ln(this,u+1,u+2);return this},xe.prototype.swap64=function(){var a=this.length;if(a%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var u=0;u<a;u+=8)Ln(this,u,u+7),Ln(this,u+1,u+6),Ln(this,u+2,u+5),Ln(this,u+3,u+4);return this},xe.prototype.toString=function(){var a=this.length|0;return a===0?"":arguments.length===0?Hs(this,0,a):Sa.apply(this,arguments)},xe.prototype.equals=function(a){if(!no(a))throw new TypeError("Argument must be a Buffer");return this===a?!0:xe.compare(this,a)===0},xe.prototype.inspect=function(){var a="";return 0<this.length&&(a=this.toString("hex",0,50).match(/.{2}/g).join(" "),50<this.length&&(a+=" ... ")),"<Buffer "+a+">"},xe.prototype.compare=function(a,u,n,l,v){if(!no(a))throw new TypeError("Argument must be a Buffer");if(u===void 0&&(u=0),n===void 0&&(n=a?a.length:0),l===void 0&&(l=0),v===void 0&&(v=this.length),0>u||n>a.length||0>l||v>this.length)throw new RangeError("out of range index");if(l>=v&&u>=n)return 0;if(l>=v)return-1;if(u>=n)return 1;if(u>>>=0,n>>>=0,l>>>=0,v>>>=0,this===a)return 0;var d=v-l,x=n-u,y=Math.min(d,x);for(l=this.slice(l,v),a=a.slice(u,n),u=0;u<y;++u)if(l[u]!==a[u]){d=l[u],x=a[u];break}return d<x?-1:x<d?1:0},xe.prototype.includes=function(a,u,n){return this.indexOf(a,u,n)!==-1},xe.prototype.indexOf=function(a,u,n){return ds(this,a,u,n,!0)},xe.prototype.lastIndexOf=function(a,u,n){return ds(this,a,u,n,!1)},xe.prototype.write=function(a,u,n,l){if(u===void 0)l="utf8",n=this.length,u=0;else if(n===void 0&&typeof u=="string")l=u,n=this.length,u=0;else if(isFinite(u))u|=0,isFinite(n)?(n|=0,l===void 0&&(l="utf8")):(l=n,n=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var v=this.length-u;if((n===void 0||n>v)&&(n=v),0<a.length&&(0>n||0>u)||u>this.length)throw new RangeError("Attempt to write outside buffer bounds");for(l||(l="utf8"),v=!1;;)switch(l){case"hex":t:{if(u=Number(u)||0,l=this.length-u,n?(n=Number(n),n>l&&(n=l)):n=l,l=a.length,l%2!=0)throw new TypeError("Invalid hex string");for(n>l/2&&(n=l/2),l=0;l<n;++l){if(v=parseInt(a.substr(2*l,2),16),isNaN(v)){a=l;break t}this[u+l]=v}a=l}return a;case"utf8":case"utf-8":return ks(oa(a,this.length-u),this,u,n);case"ascii":return ks(oo(a),this,u,n);case"latin1":case"binary":return ks(oo(a),this,u,n);case"base64":return ks(_u(a),this,u,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":l=a,v=this.length-u;for(var d=[],x=0;x<l.length&&!(0>(v-=2));++x){var y=l.charCodeAt(x);a=y>>8,y%=256,d.push(y),d.push(a)}return ks(d,this,u,n);default:if(v)throw new TypeError("Unknown encoding: "+l);l=(""+l).toLowerCase(),v=!0}},xe.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var cv=4096;xe.prototype.slice=function(a,u){var n=this.length;if(a=~~a,u=u===void 0?n:~~u,0>a?(a+=n,0>a&&(a=0)):a>n&&(a=n),0>u?(u+=n,0>u&&(u=0)):u>n&&(u=n),u<a&&(u=a),xe.TYPED_ARRAY_SUPPORT)u=this.subarray(a,u),u.__proto__=xe.prototype;else{n=u-a,u=new xe(n,void 0);for(var l=0;l<n;++l)u[l]=this[l+a]}return u},xe.prototype.readUIntLE=function(a,u,n){a|=0,u|=0,n||Zi(a,u,this.length),n=this[a];for(var l=1,v=0;++v<u&&(l*=256);)n+=this[a+v]*l;return n},xe.prototype.readUIntBE=function(a,u,n){a|=0,u|=0,n||Zi(a,u,this.length),n=this[a+--u];for(var l=1;0<u&&(l*=256);)n+=this[a+--u]*l;return n},xe.prototype.readUInt8=function(a,u){return u||Zi(a,1,this.length),this[a]},xe.prototype.readUInt16LE=function(a,u){return u||Zi(a,2,this.length),this[a]|this[a+1]<<8},xe.prototype.readUInt16BE=function(a,u){return u||Zi(a,2,this.length),this[a]<<8|this[a+1]},xe.prototype.readUInt32LE=function(a,u){return u||Zi(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},xe.prototype.readUInt32BE=function(a,u){return u||Zi(a,4,this.length),16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},xe.prototype.readIntLE=function(a,u,n){a|=0,u|=0,n||Zi(a,u,this.length),n=this[a];for(var l=1,v=0;++v<u&&(l*=256);)n+=this[a+v]*l;return n>=128*l&&(n-=Math.pow(2,8*u)),n},xe.prototype.readIntBE=function(a,u,n){a|=0,u|=0,n||Zi(a,u,this.length),n=u;for(var l=1,v=this[a+--n];0<n&&(l*=256);)v+=this[a+--n]*l;return v>=128*l&&(v-=Math.pow(2,8*u)),v},xe.prototype.readInt8=function(a,u){return u||Zi(a,1,this.length),this[a]&128?-1*(255-this[a]+1):this[a]},xe.prototype.readInt16LE=function(a,u){return u||Zi(a,2,this.length),a=this[a]|this[a+1]<<8,a&32768?a|4294901760:a},xe.prototype.readInt16BE=function(a,u){return u||Zi(a,2,this.length),a=this[a+1]|this[a]<<8,a&32768?a|4294901760:a},xe.prototype.readInt32LE=function(a,u){return u||Zi(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},xe.prototype.readInt32BE=function(a,u){return u||Zi(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},xe.prototype.readFloatLE=function(a,u){return u||Zi(a,4,this.length),Vi(this,a,!0,23,4)},xe.prototype.readFloatBE=function(a,u){return u||Zi(a,4,this.length),Vi(this,a,!1,23,4)},xe.prototype.readDoubleLE=function(a,u){return u||Zi(a,8,this.length),Vi(this,a,!0,52,8)},xe.prototype.readDoubleBE=function(a,u){return u||Zi(a,8,this.length),Vi(this,a,!1,52,8)},xe.prototype.writeUIntLE=function(a,u,n,l){a=+a,u|=0,n|=0,l||qn(this,a,u,n,Math.pow(2,8*n)-1,0),l=1;var v=0;for(this[u]=a&255;++v<n&&(l*=256);)this[u+v]=a/l&255;return u+n},xe.prototype.writeUIntBE=function(a,u,n,l){a=+a,u|=0,n|=0,l||qn(this,a,u,n,Math.pow(2,8*n)-1,0),l=n-1;var v=1;for(this[u+l]=a&255;0<=--l&&(v*=256);)this[u+l]=a/v&255;return u+n},xe.prototype.writeUInt8=function(a,u,n){return a=+a,u|=0,n||qn(this,a,u,1,255,0),xe.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),this[u]=a&255,u+1},xe.prototype.writeUInt16LE=function(a,u,n){return a=+a,u|=0,n||qn(this,a,u,2,65535,0),xe.TYPED_ARRAY_SUPPORT?(this[u]=a&255,this[u+1]=a>>>8):Ia(this,a,u,!0),u+2},xe.prototype.writeUInt16BE=function(a,u,n){return a=+a,u|=0,n||qn(this,a,u,2,65535,0),xe.TYPED_ARRAY_SUPPORT?(this[u]=a>>>8,this[u+1]=a&255):Ia(this,a,u,!1),u+2},xe.prototype.writeUInt32LE=function(a,u,n){return a=+a,u|=0,n||qn(this,a,u,4,4294967295,0),xe.TYPED_ARRAY_SUPPORT?(this[u+3]=a>>>24,this[u+2]=a>>>16,this[u+1]=a>>>8,this[u]=a&255):Ka(this,a,u,!0),u+4},xe.prototype.writeUInt32BE=function(a,u,n){return a=+a,u|=0,n||qn(this,a,u,4,4294967295,0),xe.TYPED_ARRAY_SUPPORT?(this[u]=a>>>24,this[u+1]=a>>>16,this[u+2]=a>>>8,this[u+3]=a&255):Ka(this,a,u,!1),u+4},xe.prototype.writeIntLE=function(a,u,n,l){a=+a,u|=0,l||(l=Math.pow(2,8*n-1),qn(this,a,u,n,l-1,-l)),l=0;var v=1,d=0;for(this[u]=a&255;++l<n&&(v*=256);)0>a&&d===0&&this[u+l-1]!==0&&(d=1),this[u+l]=(a/v>>0)-d&255;return u+n},xe.prototype.writeIntBE=function(a,u,n,l){a=+a,u|=0,l||(l=Math.pow(2,8*n-1),qn(this,a,u,n,l-1,-l)),l=n-1;var v=1,d=0;for(this[u+l]=a&255;0<=--l&&(v*=256);)0>a&&d===0&&this[u+l+1]!==0&&(d=1),this[u+l]=(a/v>>0)-d&255;return u+n},xe.prototype.writeInt8=function(a,u,n){return a=+a,u|=0,n||qn(this,a,u,1,127,-128),xe.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),0>a&&(a=255+a+1),this[u]=a&255,u+1},xe.prototype.writeInt16LE=function(a,u,n){return a=+a,u|=0,n||qn(this,a,u,2,32767,-32768),xe.TYPED_ARRAY_SUPPORT?(this[u]=a&255,this[u+1]=a>>>8):Ia(this,a,u,!0),u+2},xe.prototype.writeInt16BE=function(a,u,n){return a=+a,u|=0,n||qn(this,a,u,2,32767,-32768),xe.TYPED_ARRAY_SUPPORT?(this[u]=a>>>8,this[u+1]=a&255):Ia(this,a,u,!1),u+2},xe.prototype.writeInt32LE=function(a,u,n){return a=+a,u|=0,n||qn(this,a,u,4,2147483647,-2147483648),xe.TYPED_ARRAY_SUPPORT?(this[u]=a&255,this[u+1]=a>>>8,this[u+2]=a>>>16,this[u+3]=a>>>24):Ka(this,a,u,!0),u+4},xe.prototype.writeInt32BE=function(a,u,n){return a=+a,u|=0,n||qn(this,a,u,4,2147483647,-2147483648),0>a&&(a=4294967295+a+1),xe.TYPED_ARRAY_SUPPORT?(this[u]=a>>>24,this[u+1]=a>>>16,this[u+2]=a>>>8,this[u+3]=a&255):Ka(this,a,u,!1),u+4},xe.prototype.writeFloatLE=function(a,u,n){return Ea(this,a,u,!0,n)},xe.prototype.writeFloatBE=function(a,u,n){return Ea(this,a,u,!1,n)},xe.prototype.writeDoubleLE=function(a,u,n){return Qa(this,a,u,!0,n)},xe.prototype.writeDoubleBE=function(a,u,n){return Qa(this,a,u,!1,n)},xe.prototype.copy=function(a,u,n,l){if(n||(n=0),l||l===0||(l=this.length),u>=a.length&&(u=a.length),u||(u=0),0<l&&l<n&&(l=n),l===n||a.length===0||this.length===0)return 0;if(0>u)throw new RangeError("targetStart out of bounds");if(0>n||n>=this.length)throw new RangeError("sourceStart out of bounds");if(0>l)throw new RangeError("sourceEnd out of bounds");l>this.length&&(l=this.length),a.length-u<l-n&&(l=a.length-u+n);var v=l-n;if(this===a&&n<u&&u<l)for(l=v-1;0<=l;--l)a[l+u]=this[l+n];else if(1e3>v||!xe.TYPED_ARRAY_SUPPORT)for(l=0;l<v;++l)a[l+u]=this[l+n];else Uint8Array.prototype.set.call(a,this.subarray(n,n+v),u);return v},xe.prototype.fill=function(a,u,n,l){if(typeof a=="string"){if(typeof u=="string"?(l=u,u=0,n=this.length):typeof n=="string"&&(l=n,n=this.length),a.length===1){var v=a.charCodeAt(0);256>v&&(a=v)}if(l!==void 0&&typeof l!="string")throw new TypeError("encoding must be a string");if(typeof l=="string"&&!xe.isEncoding(l))throw new TypeError("Unknown encoding: "+l)}else typeof a=="number"&&(a&=255);if(0>u||this.length<u||this.length<n)throw new RangeError("Out of range index");if(n<=u)return this;if(u>>>=0,n=n===void 0?this.length:n>>>0,a||(a=0),typeof a=="number")for(l=u;l<n;++l)this[l]=a;else for(a=no(a)?a:oa(new xe(a,l).toString()),v=a.length,l=0;l<n-u;++l)this[l+u]=a[l%v];return this};var N1=/[^+\/0-9A-Za-z-_]/g,og={normal:null,road:_f()},sg=function(a){function u(n,l){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n,l)),n.name="LineLayer3D",n.initData(),n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{color:"rgba(25, 25, 250, 1)",offset:0,blend:"normal",width:4,unit:"px",flat:!1,antialias:!1,style:"normal",dashArray:[0,0],dashOffset:0,polygonOffset:[0,0]}}},{key:"initData",value:function(){this.dataMgr={position:[],prev:[],next:[],direction:[],color:[],index:[],counter:[],uv:[]}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions(),v=[];l.enablePicked&&v.push("PICK"),og[l.style]&&(this.isUseTexture=!0,v.push("USE_TEXTURE")),this.program=new ii(this.gl,{vertexShader:`precision highp float;uniform vec4 uSelectedColor;uniform mat4 uMatrix;uniform bool uFlat;uniform bool uUnitPx;uniform vec2 uDashArray;uniform float thickness;uniform float zoomUnits;uniform float devicePixelRatio;uniform float uOffset;attribute vec3 position;attribute vec3 next;attribute vec3 previous;attribute float direction;attribute vec4 aColor;attribute float aDistance;attribute float aTotalDistance;
#if defined(USE_TEXTURE)
attribute vec2 uv;
#endif
varying vec4 vColor;varying vec2 vNormal;varying vec2 vUV;varying vec2 vDashArray;varying float vTotalDistance;varying float vCounter;vec2 project(vec4 coord){vec3 screen=coord.xyz/coord.w;vec2 clip=(screen.xy+1.0)/2.0;return clip*MAPV_resolution;}vec4 unproject(vec2 projected,float z,float w){vec2 clip=projected/MAPV_resolution;vec2 screen=clip*2.0-1.0;return vec4(screen*w,z,w);}vec3 getNormalAndWidth(vec2 currentScreen,vec2 previousScreen,vec2 nextScreen,float thickness){vec2 dir=vec2(0.0);if(currentScreen==previousScreen){dir=normalize(nextScreen-currentScreen);}else if(currentScreen==nextScreen){dir=normalize(currentScreen-previousScreen);}else{vec2 dirA=normalize((currentScreen-previousScreen));vec2 dirB=normalize((nextScreen-currentScreen));vec2 tangent=normalize(dirA+dirB);vec2 perp=vec2(-dirA.y,dirA.x);vec2 miter=vec2(-tangent.y,tangent.x);dir=tangent;float angle=40.0;if(dot(dirA,dirB)>cos(radians(angle))){thickness=thickness/dot(miter,perp);}}vec2 normal=vec2(-dir.y,dir.x);return vec3(normal,thickness);}void main(){vColor=aColor;vCounter=aDistance/aTotalDistance;vDashArray=uDashArray/aTotalDistance;if(uUnitPx){vDashArray*=zoomUnits;}vTotalDistance=aTotalDistance;
#if defined(USE_TEXTURE)
vUV=uv;
#endif
#if defined(PICK)
if(mapvIsPicked()){vColor=uSelectedColor;}
#endif
if(uFlat){float width=thickness;if(uUnitPx){width*=zoomUnits;}vec3 nw=getNormalAndWidth(position.xy,previous.xy,next.xy,width);width=nw.z;vec2 normal=nw.xy;vNormal=normal*direction;normal*=width/2.0;float offsetXy=uOffset;float offsetHeight=uOffset/100.0;if(uUnitPx){offsetXy/=zoomUnits;offsetHeight*=zoomUnits;}gl_Position=uMatrix*vec4(position.xy+normal*(direction+offsetXy),position.z+offsetHeight,1.0);}else{vec4 previousProjected=uMatrix*vec4(previous,1.0);vec4 currentProjected=uMatrix*vec4(position,1.0);vec4 nextProjected=uMatrix*vec4(next,1.0);vec2 currentScreen=project(currentProjected);vec2 previousScreen=project(previousProjected);vec2 nextScreen=project(nextProjected);float width=thickness*devicePixelRatio;if(!uUnitPx){width/=zoomUnits;}vec3 nw=getNormalAndWidth(currentScreen,previousScreen,nextScreen,width);width=nw.z;vec2 normal=nw.xy;vNormal=normal*direction;normal*=width/2.0;vec2 pos=currentScreen+normal*direction;vec4 finalPos=unproject(pos,currentProjected.z,currentProjected.w);gl_Position=finalPos;}}`,fragmentShader:`precision highp float;varying vec4 vColor;varying vec2 vNormal;varying vec2 vUV;varying vec2 vDashArray;varying float vCounter;varying float vTotalDistance;uniform bool uAntialias;uniform float uDashOffset;uniform float zoomUnits;uniform float thickness;
#if defined(USE_TEXTURE)
uniform float uTextureMargin;uniform sampler2D textureImage;
#endif
void main(){vec4 color=vColor;if(uAntialias){float blur=1.0;blur=1.0-smoothstep(0.8,1.0,length(vNormal));color.a*=blur;}
#if defined(USE_TEXTURE)
float segLen=uTextureMargin*zoomUnits;float textureLen=thickness*zoomUnits;float deltaX=mod(vUV.x,segLen);float middle=segLen/2.0;if(deltaX>=middle&&deltaX<=middle+textureLen){float uvx=(deltaX-middle)/textureLen;vec4 texture=texture2D(textureImage,vec2(uvx,vUV.y));color=texture.a>=0.5 ? texture : color;}
#endif
if(vDashArray.y>0.0){float offset=uDashOffset*zoomUnits/vTotalDistance;color.a*=(1.0-step(vDashArray.x,mod(vCounter+offset,vDashArray.x+vDashArray.y)));}gl_FragColor=color;}`,defines:v},this),this.prevBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.currentBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.nextBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.directionBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.colorBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.counterBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new Ke({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),v=[{stride:12,name:"previous",buffer:this.prevBuffer,size:3,type:"FLOAT",offset:0},{stride:12,name:"position",buffer:this.currentBuffer,size:3,type:"FLOAT",offset:0},{stride:12,name:"next",buffer:this.nextBuffer,size:3,type:"FLOAT",offset:0},{stride:4,name:"direction",buffer:this.directionBuffer,size:1,type:"FLOAT",offset:0},{stride:16,name:"aColor",buffer:this.colorBuffer,size:4,type:"FLOAT",offset:0},{stride:8,name:"aDistance",buffer:this.counterBuffer,size:1,type:"FLOAT",offset:0},{stride:8,name:"aTotalDistance",buffer:this.counterBuffer,size:1,type:"FLOAT",offset:4}],v=v.concat(this.getCommonAttributes()),og[l.style]&&(v.push({stride:8,name:"uv",buffer:this.uvBuffer,size:2,type:"FLOAT",offset:0}),this.setOptions({texture:og[l.style]}),this.loadTexture()),this.vertexArray=new pn({gl:n,program:this.program,attributes:v})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(n,l){var v=this;if(this.gl){this.initData();for(var d=n.color,x=[],y=0;y<l.length;y++){var M=[],D=l[y].geometry.coordinates;D&&0<D.length&&(M=l[y].geometry.type==="MultiPolygon"?D.reduce(function(E,B){return E.concat(B)})[0].map(function(E){return v.normizedPoint(E)}):l[y].geometry.type==="Polygon"||l[y].geometry.type==="MultiLineString"?D[0].map(function(E){return v.normizedPoint(E)}):D.map(function(E){return v.normizedPoint(E)})),D=this.getProperty("color",d,l[y]),D=this.getProperty("lineColor",d,l[y]),D=this.normizedColor(D);for(var U=this.addMultipleCoords(M),C=0;C<U.length;C++)this.processData(this.dataMgr,U[C],D);if(n.enablePicked)for(D=this.indexToRgb(y),U=0;U<M.length;U++)x.push(D[0]/255,D[1]/255,D[2]/255),x.push(D[0]/255,D[1]/255,D[2]/255),n.repeat&&(x.push(D[0]/255,D[1]/255,D[2]/255),x.push(D[0]/255,D[1]/255,D[2]/255),x.push(D[0]/255,D[1]/255,D[2]/255),x.push(D[0]/255,D[1]/255,D[2]/255))}this.counterBuffer.updateData(new Float32Array(this.dataMgr.counter)),this.currentBuffer.updateData(new Float32Array(this.dataMgr.position)),this.prevBuffer.updateData(new Float32Array(this.dataMgr.prev)),this.nextBuffer.updateData(new Float32Array(this.dataMgr.next)),this.directionBuffer.updateData(new Float32Array(this.dataMgr.direction)),this.colorBuffer.updateData(new Float32Array(this.dataMgr.color)),this.indexBuffer.updateData(new Uint32Array(this.dataMgr.index)),this.isUseTexture&&this.uvBuffer.updateData(new Float32Array(this.dataMgr.uv)),n.enablePicked&&this.pickBuffer.updateData(new Float32Array(x))}}},{key:"processData",value:function(n,l,v){var d,x,y,M,D,U,C,E,B=l.length,O=n.position.length/6,H=wf(l),V=H.arr,G=H.total;H=No(V.map(function(nt){return[nt,G]})),V=V.map(function(nt){return[nt,0,nt,1]});var j=No(l.map(function(nt){return-1}),!0),Y=No(l),$=No(l.map(nh(-1))),it=No(l.map(nh(1)));l=No(l.map(function(nt){return v})),B=nd(B,O),(d=n.uv).push.apply(d,ri(is(V))),(x=n.counter).push.apply(x,ri(is(H))),(y=n.position).push.apply(y,ri(is(Y))),(M=n.prev).push.apply(M,ri(is($))),(D=n.next).push.apply(D,ri(is(it))),(U=n.direction).push.apply(U,ri(j)),(C=n.color).push.apply(C,ri(is(l))),(E=n.index).push.apply(E,ri(B))}},{key:"render",value:function(n){var l=n.gl,v=n.matrix,d=this.dataMgr;if(d&&!(0>=d.index.length)&&this.map){var x=this.getOptions(),y=this.program;y.use(l),n=Ur(this.getCommonUniforms(n),{uMatrix:v,uFlat:x.flat,uUnitPx:x.unit==="px",zoomUnits:this.map.getZoomUnits(),devicePixelRatio:window.devicePixelRatio,thickness:x.width,uDashArray:x.dashArray,uDashOffset:x.dashOffset,uAntialias:x.antialias,uOffset:x.offset}),this.isUseTexture&&(n=Ur(n,{uTextureMargin:140,textureImage:this.texture})),y.setUniforms(n),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:x.blend==="lighter"?[l.SRC_ALPHA,l.ONE]:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA],polygonOffset:x.polygonOffset}),this.indexBuffer.bind(),this.vertexArray.bind(),l.drawElements(l.TRIANGLES,d.index.length,l.UNSIGNED_INT,0)}}},{key:"loadTexture",value:function(n){var l=this,v=this.getOptions();v.texture?Bn(this.gl,v.texture,function(d,x){l.image=x,l.texture=d,n&&n(),l.webglLayer.render()}):(this.image=this.texture=null,n&&n())}}]),u}(Ui),cA=function(){function a(u){Ye(this,a),this.join=u.join||"miter",this.cap=u.cap||"butt",this.thickness=u.thickness||4,this.miterLimit=u.miterLimit||2*this.thickness,this.dash=u.dash||!1,this.complex={positions:[],indices:[],normals:[],colors:[],uvs:[],startIndex:0,maxDistance:0},this._lastFlip=-1,this._started=!1,this._normal=null,this._totalDistance=0,this._colorFlag=!1,this._count=0}return qe(a,[{key:"extrude",value:function(u,n,l,v){var d=this.complex;if(1>=u.length)return d;this._lastFlip=-1,this._started=!1,this._normal=null,this._totalDistance=0;for(var x=u.length,y=d.startIndex,M=null,D=1;D<x;D++){var U=M||u[D-1],C=u[D],E=D<x-1?u[D+1]:null;E&&C[0]===E[0]&&C[1]===E[1]&&C[2]===E[2]?M=U:(U=this._segment(d,y,U,C,E,n,l,v),U!==-1&&(y+=U,M=null))}return this.dash&&(d.maxDistance=Math.max(this._totalDistance,d.maxDistance)),d.startIndex=d.positions.length/7,d}},{key:"_segment",value:function(u,n,l,v,d,x,y,M){M[0]instanceof Array&&(this._colorFlag=!0);var D=0,U=di.create(),C=di.create(),E=di.create(),B=di.create(),O=u.indices,H=u.positions,V=u.normals,G=u.colors;u=u.uvs;var j=this.cap==="square",Y=this.cap==="round",$=this.join==="bevel",it=this.join==="round",nt=[v[0],v[1]],dt=[l[0],l[1]];sd(C,nt,dt);var Et=0;if(this.dash&&(Et=this._calcDistance(nt,dt),this._totalDistance+=Et),this._normal||(this._normal=di.create(),Gs(this._normal,C)),!this._started)if(this._started=!0,j){dt=di.create();var St=di.create();di.add(dt,this._normal,C),di.sub(St,this._normal,C),V.push(St[0],St[1],0),V.push(dt[0],dt[1],0),H.push(l[0],l[1],l[2],this._totalDistance-Et,x,y,0),H.push(l[0],l[1],l[2],this._totalDistance-Et,-x,y,0),u.push(this._totalDistance-Et,0,this._totalDistance-Et,1),this._colorFlag?(G.push(M[0][0],M[0][1],M[0][2],M[0][3]),G.push(M[0][0],M[0][1],M[0][2],M[0][3])):(G.push(M[0],M[1],M[2],M[3]),G.push(M[0],M[1],M[2],M[3]))}else if(Y){dt=di.fromValues(-C[0],-C[1]),St=di.create(),di.sub(St,this._normal,C),di.normalize(St,St);var Xt=di.create();di.add(Xt,this._normal,C),di.normalize(Xt,Xt);var te=di.fromValues(this._normal[0],this._normal[1]),Ie=di.fromValues(-this._normal[0],-this._normal[1]);for(V.push(dt[0],dt[1],0),V.push(St[0],St[1],0),V.push(-Xt[0],-Xt[1],0),V.push(te[0],te[1],0),V.push(Ie[0],Ie[1],0),dt=0;5>dt;dt++)H.push(l[0],l[1],l[2],this._totalDistance-Et,x,y,0),u.push(this._totalDistance-Et,0),this._colorFlag?G.push(M[0][0],M[0][1],M[0][2],M[0][3]):G.push(M[0],M[1],M[2],M[3]);O.push(n+0,n+2,n+1,n+1,n+2,n+3,n+3,n+2,n+4),D+=3,n+=3}else this._extrusions(H,V,u,G,l,this._normal,x,this._totalDistance-Et,y,M,0);if(O.push.apply(O,ri(this._lastFlip===-1?[n+0,n+1,n+2]:[n+1,n+0,n+2])),d)sd(E,[d[0],d[1]],nt),this._count++,di.create(),di.add(B,C,E),di.normalize(B,B),Y=di.fromValues(-B[1],B[0]),C=di.fromValues(-C[1],C[0]),C=[x/di.dot(Y,C),Y],C=Pi(C,2),Y=C[0],C=C[1],B=0<di.dot(B,this._normal)?-1:1,$||this.join!=="miter"||Math.abs(Y)>this.miterLimit&&($=!0),$?(it=Math.min(2*x,Math.abs(Y)),V.push(this._normal[0],this._normal[1],0),V.push(C[0],C[1],0),H.push(v[0],v[1],v[2],this._totalDistance,x*B,y,0),H.push(v[0],v[1],v[2],this._totalDistance,-it*B,y,0),O.push.apply(O,ri(this._lastFlip===-B?[n+2,n+1,n+3]:[n+0,n+2,n+3])),Gs(U,E),di.copy(this._normal,U),V.push(this._normal[0],this._normal[1],0),H.push(v[0],v[1],v[2],this._totalDistance,x*B,y,0),O.push.apply(O,ri(B===1?[n+2,n+3,n+4]:[n+3,n+2,n+4])),this._flipedUV(u,this._totalDistance,B,!0),this._colorFlag?(G.push(M[this._count][0],M[this._count][1],M[this._count][2],M[this._count][3]),G.push(M[this._count][0],M[this._count][1],M[this._count][2],M[this._count][3]),G.push(M[this._count][0],M[this._count][1],M[this._count][2],M[this._count][3])):(G.push(M[0],M[1],M[2],M[3]),G.push(M[0],M[1],M[2],M[3]),G.push(M[0],M[1],M[2],M[3])),D+=3):it?(it=Math.min(2*x,Math.abs(Y)),V.push(this._normal[0],this._normal[1],0),V.push(C[0],C[1],0),V.push(C[0],C[1],0),H.push(v[0],v[1],v[2],this._totalDistance,x*B,y,0),H.push(v[0],v[1],v[2],this._totalDistance,x*B,y,0),H.push(v[0],v[1],v[2],this._totalDistance,-it*B,y,0),O.push.apply(O,ri(this._lastFlip===-B?[n+2,n+1,n+4,n+2,n+4,n+3]:[n+0,n+2,n+4,n+2,n+3,n+4])),Gs(U,E),di.copy(this._normal,U),V.push(this._normal[0],this._normal[1],0),H.push(v[0],v[1],v[2],this._totalDistance,x*B,y,0),O.push.apply(O,ri(B===1?[n+4,n+3,n+5]:[n+3,n+4,n+5])),this._flipedUV(u,this._totalDistance,B,!1),this._colorFlag?(G.push(M[this._count][0],M[this._count][1],M[this._count][2],M[this._count][3]),G.push(M[this._count][0],M[this._count][1],M[this._count][2],M[this._count][3]),G.push(M[this._count][0],M[this._count][1],M[this._count][2],M[this._count][3]),G.push(M[this._count][0],M[this._count][1],M[this._count][2],M[this._count][3])):(G.push(M[0],M[1],M[2],M[3]),G.push(M[0],M[1],M[2],M[3]),G.push(M[0],M[1],M[2],M[3]),G.push(M[0],M[1],M[2],M[3])),D+=4):(this._extrusions(H,V,u,G,v,C,Y,this._totalDistance,y,M,this._count),O.push.apply(O,ri(this._lastFlip===-1?[n+2,n+1,n+3]:[n+2,n+0,n+3])),B=-1,di.copy(this._normal,C),D+=2),this._lastFlip=B;else if(Gs(this._normal,C),U=M.length-1,j?(E=di.create(),it=di.create(),di.add(E,C,this._normal),di.sub(it,C,this._normal),V.push(E[0],E[1],0),V.push(it[0],it[1],0),H.push(v[0],v[1],v[2],this._totalDistance,x,y,0),H.push(v[0],v[1],v[2],this._totalDistance,x,y,0),u.push(this._totalDistance,0,this._totalDistance,1),this._colorFlag?(G.push(M[U][0],M[U][1],M[U][2],M[U][3]),G.push(M[U][0],M[U][1],M[U][2],M[U][3])):(G.push(M[0],M[1],M[2],M[3]),G.push(M[0],M[1],M[2],M[3]))):this._extrusions(H,V,u,G,v,this._normal,x,this._totalDistance,y,M,U),O.push.apply(O,ri(this._lastFlip===-1?[n+2,n+1,n+3]:[n+2,n+0,n+3])),D+=2,Y){for(E=di.create(),di.add(E,C,this._normal),di.normalize(E,E),it=di.create(),di.sub(it,C,this._normal),di.normalize(it,it),C=di.fromValues(C[0],C[1]),V.push(E[0],E[1],0),V.push(it[0],it[1],0),V.push(C[0],C[1],0),V=0;3>V;V++)H.push(v[0],v[1],v[2],this._totalDistance,x,y,0),u.push(this._totalDistance,0),this._colorFlag?G.push(M[U][0],M[U][1],M[U][2],M[U][3]):G.push(M[0],M[1],M[2],M[3]);O.push(n+2,n+3,n+4,n+4,n+3,n+5,n+4,n+5,n+6),D+=3}return D}},{key:"_extrusions",value:function(u,n,l,v,d,x,y,M,D,U,C){n.push(x[0],x[1],0),n.push(x[0],x[1],0),u.push(d[0],d[1],d[2],M,y,D,0),u.push(d[0],d[1],d[2],M,-y,D,0),l.push(M,0,M,1),this._colorFlag?(v.push(U[C][0],U[C][1],U[C][2],U[C][3]),v.push(U[C][0],U[C][1],U[C][2],U[C][3])):(v.push(U[0],U[1],U[2],U[3]),v.push(U[0],U[1],U[2],U[3]))}},{key:"_calcDistance",value:function(u,n){return Math.sqrt(Math.pow(u[0]-n[0],2)+Math.pow(u[1]-n[1],2))}},{key:"_flipedUV",value:function(u,n,l,v){v?l===-1?u.push(n,0,n,1,n,0):u.push(n,1,n,0,n,1):l===-1?u.push(n,0,n,0,n,1,n,0):u.push(n,1,n,1,n,0,n,1)}}]),a}(),ag={normal:null,road:_f,arrow:function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},u=a.width;a=a.color;var n=od(),l=n.canvas;return n=n.ctx,n.save(),n.moveTo(5,0),n.lineTo(32,16),n.lineTo(5,32),n.strokeStyle=a||"#fff",n.lineWidth=u||8,n.stroke(),n.restore(),l}},Hu=function(a){function u(n,l){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n,l)),n.name="LineLayer",n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{style:"normal",styleOptions:{},color:"rgba(25, 25, 250, 1)",blend:"default",lineJoin:"miter",lineCap:"butt",unit:"px",width:4,offset:0,antialias:!1,dashArray:[0,0],dashOffset:0,animation:!1,interval:.1,duration:2,trailLength:.5,minZoom:2,maxZoom:25,polygonOffset:[0,0],depthTest:!0,depthWrite:!0,depthFunc:"lequal"}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions(),v=[];l.enablePicked&&v.push("PICK"),ag[l.style]&&(this.isUseTexture=!0,this.prevStyle=l.style,this.prevStyleOptions=l.styleOptions,v.push("USE_TEXTURE")),l.animation===!0&&(this.isAnimateLine=!0,this.date=new Date,this.autoUpdate=!0,v.push("USE_LINE_ANIMATION")),l.useDash===!0&&v.push("USE_SIMPLE_DASH"),this.program=new ii(this.gl,{vertexShader:`precision highp float;uniform vec4 uSelectedColor;uniform mat4 u_matrix;uniform vec2 u_dash_array;uniform float u_zoom_units;uniform float u_zIndex;uniform bool u_unit_px;attribute vec4 a_color;attribute vec3 a_position;attribute vec3 a_normal;attribute float a_distance;attribute float a_total_distance;attribute float a_width;attribute float a_offset;
#if defined(USE_TEXTURE)
attribute vec2 uv;
#endif
varying vec4 v_color;varying vec2 v_normal;varying vec2 v_uv;varying vec2 v_dash_array;varying float v_total_distance;varying float v_counter;varying float v_width;
#if defined(USE_SIMPLE_DASH)
varying vec3 v_position;
#endif
void main(){v_width=a_width;v_color=a_color;v_counter=a_distance/a_total_distance;v_dash_array=u_dash_array/a_total_distance;if(u_unit_px){v_dash_array*=u_zoom_units;}v_total_distance=a_total_distance;v_normal=vec2(normalize(a_normal.xy)*sign(a_width));
#if defined(USE_TEXTURE)
v_uv=uv;
#endif
#if defined(PICK)
if(mapvIsPicked()){v_color=uSelectedColor;}
#endif
vec2 extrude=a_normal.xy*a_width/2.0;if(u_unit_px){extrude*=u_zoom_units;}vec2 offsetXY=a_normal.xy*-a_offset;float offsetZ=a_offset/100.0+u_zIndex;if(u_unit_px){offsetXY*=u_zoom_units;offsetZ*=u_zoom_units;}
#if defined(USE_SIMPLE_DASH)
v_position=a_position;
#endif
gl_Position=u_matrix*vec4(a_position.xy+extrude+offsetXY,a_position.z+offsetZ,1.0);}`,fragmentShader:`precision highp float;varying vec4 v_color;varying vec2 v_normal;varying vec2 v_uv;varying vec2 v_dash_array;varying float v_counter;varying float v_total_distance;varying float v_width;
#if defined(USE_SIMPLE_DASH)
varying vec3 v_position;
#endif
uniform bool u_antialias;uniform float u_dash_offset;uniform float u_zoom_units;
#if defined(USE_LINE_ANIMATION)
uniform bool u_animate;uniform float u_time;uniform float u_duration;uniform float u_interval;uniform float u_trail_length;
#endif
#if defined(USE_TEXTURE)
uniform float u_texture_width;uniform float u_texture_margin;uniform sampler2D u_sampler;
#endif
void main(){vec4 color=v_color;
#if defined(USE_SIMPLE_DASH)
if(mod(v_position.x,5.0)<3.0){discard;}
#endif
if(u_antialias){float blur=1.0;blur=1.0-smoothstep(0.8,1.0,length(v_normal));color.a*=blur;}
#if defined(USE_LINE_ANIMATION)
if(u_animate){float alpha=1.0-fract(mod(1.0-v_counter,u_interval)*(1.0/u_interval)+u_time/u_duration);alpha=(alpha+u_trail_length-1.0)/u_trail_length;color.a*=alpha;gl_FragColor=color;return;}
#endif
#if defined(USE_TEXTURE)
float margin_width=u_texture_margin*u_zoom_units;float margin_width_half=margin_width/2.0;float texture_width=u_texture_width*u_zoom_units;float delta=mod(v_uv.x,texture_width+margin_width);if(delta>=margin_width_half&&delta<=margin_width_half+texture_width){float uvx=(delta-margin_width_half)/texture_width;vec4 texture=texture2D(u_sampler,vec2(uvx,v_uv.y));color=texture.a>=0.5 ? texture : color;}
#endif
if(v_dash_array.y>0.0){float offset=u_dash_offset*u_zoom_units/v_total_distance;color.a*=(1.0-step(v_dash_array.x,mod(v_counter+offset,v_dash_array.x+v_dash_array.y)));}gl_FragColor=color;}`,defines:v},this),this.positionBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.colorBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.normalBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new Ke({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),v=[{stride:28,name:"a_position",buffer:this.positionBuffer,size:3,type:"FLOAT",offset:0},{stride:28,name:"a_distance",buffer:this.positionBuffer,size:1,type:"FLOAT",offset:12},{stride:28,name:"a_width",buffer:this.positionBuffer,size:1,type:"FLOAT",offset:16},{stride:28,name:"a_offset",buffer:this.positionBuffer,size:1,type:"FLOAT",offset:20},{stride:28,name:"a_total_distance",buffer:this.positionBuffer,size:1,type:"FLOAT",offset:24},{stride:12,name:"a_normal",buffer:this.normalBuffer,size:3,type:"FLOAT",offset:0},{stride:16,name:"a_color",buffer:this.colorBuffer,size:4,type:"FLOAT",offset:0}],v=v.concat(this.getCommonAttributes()),this.isUseTexture&&(this.uvBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),v.push({stride:8,name:"uv",buffer:this.uvBuffer,size:2,type:"FLOAT",offset:0}),l=(0,ag[l.style])(l.styleOptions),this.setOptions({texture:l}),this.loadTexture()),this.vertexArray=new pn({gl:n,program:this.program,attributes:v})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(n,l){var v=this,d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{};if(this.gl)if(!this.isUseTexture||this.prevStyle===n.style&&Ah(this.prevStyleOptions)===Ah(n.styleOptions))this.parseData(n,l,d);else{this.prevStyle=n.style,this.prevStyleOptions=n.styleOptions;var x=(0,ag[n.style])(n.styleOptions);this.setOptions({texture:x}),this.loadTextureTime&&clearTimeout(this.loadTextureTime),this.loadTextureTime=setTimeout(function(){v.loadTexture(function(){v.parseData(n,l,d)})},0)}}},{key:"onParseProperties",value:function(n){return this.normizedColor(n)}},{key:"parseData",value:function(n,l,v){var d=this,x=n.dashArray,y=n.width,M=n.color,D=n.offset;x=!!this.isUseTexture||!!x[1]||!!this.isAnimateLine;for(var U=new cA({dash:x,cap:n.lineCap,join:n.lineJoin,miterLimit:n.miterLimit,thickness:y}),C=[],E=function(O){var H=l[O].geometry.coordinates;H&&0<H.length&&(l[O].geometry.type==="MultiPolygon"?H=H.reduce(function(it,nt){return it.concat(nt)}):l[O].geometry.type==="LineString"&&(H=[H]),H=H.map(function(it){return it=it.map(function(nt){return d.normizedPoint(nt)}),v.closePath===!0&&it[0].toString()!==it[it.length-1].toString()&&it.push(it[0]),it}));var V=d.getProperty("color",M,l[O]);V=d.getProperty("lineColor",V,l[O]),V=d.onParseProperties(V,l[0].geometry.coordinates.length);var G=d.getProperty("width",y,l[O]);G=Number(G);var j=d.getProperty("offset",D,l[O]);j=Number(j);var Y=U.complex.startIndex;H=d.addMultipleCoords(H);for(var $=0;$<H.length;$++)H[$].forEach(function(it){U.extrude(it,G,j,V)});if(n.enablePicked)for(O=d.indexToRgb(O),H=U.complex.startIndex;Y<H;Y++)C.push(O[0]/255,O[1]/255,O[2]/255),n.repeat&&(C.push(O[0]/255,O[1]/255,O[2]/255),C.push(O[0]/255,O[1]/255,O[2]/255))},B=0;B<l.length;B++)E(B);if(E=U.complex,x)for(B=0;B<E.positions.length/7;B++)E.positions[7*B+6]=E.maxDistance;this.lineData=E,this.positionBuffer.updateData(new Float32Array(E.positions)),this.normalBuffer.updateData(new Float32Array(E.normals)),this.colorBuffer.updateData(new Float32Array(E.colors)),this.indexBuffer.updateData(new Uint32Array(E.indices)),this.isUseTexture&&this.uvBuffer.updateData(new Float32Array(E.uvs)),n.enablePicked&&this.pickBuffer.updateData(new Float32Array(C))}},{key:"render",value:function(n){var l=n.gl,v=n.matrix,d=this.lineData;if(d&&!(0>=d.indices.length)&&this.map){var x=this.getOptions(),y=this.program;y.use(l),n=Ur(this.getCommonUniforms(n),{u_matrix:v,u_zoom_units:this.map.getZoomUnits(),u_dash_array:x.dashArray,u_dash_offset:x.dashOffset,u_antialias:x.antialias,u_unit_px:x.unit==="px",u_zIndex:x.zIndex}),this.isUseTexture&&(n=Ur(n,{u_texture_width:x.width,u_texture_margin:140,u_sampler:this.texture})),this.isAnimateLine&&(v=this.map.getZoom(),n=Ur(n,{u_time:(new Date-this.date)/1e3,u_animate:!!(v>=x.minZoom&&v<=x.maxZoom&&this.autoUpdate),u_duration:x.duration,u_interval:x.interval,u_trail_length:x.trailLength})),y.setUniforms(n),y=l.LEQUAL,x.depthFunc&&(y=l[x.depthFunc.toUpperCase()]),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:rs(l,x.blend),polygonOffset:x.polygonOffset,depthTest:x.depthTest,depthMask:x.depthWrite,depthFunc:y}),this.indexBuffer.bind(),this.vertexArray.bind(),l.drawElements(l.TRIANGLES,d.indices.length,l.UNSIGNED_INT,0)}}},{key:"loadTexture",value:function(n){var l=this,v=this.getOptions();v.texture?Bn(this.gl,v.texture,function(d,x){l.image=x,l.texture=d,n&&n(),l.webglLayer.render()}):(this.image=this.texture=null,n&&n())}}]),u}(Ui),z1=function(a){function u(n,l){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n,l)),n.name="LineRainbowLayer",n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{style:"normal",styleOptions:{},color:"rgba(25, 25, 250, 1)",blend:"normal",lineJoin:"miter",lineCap:"butt",unit:"px",width:4,offset:0,antialias:!1,dashArray:[0,0],dashOffset:0,animation:!1,interval:.1,duration:2,trailLength:.5,minZoom:2,maxZoom:25,polygonOffset:[0,0],depthTest:!0,depthWrite:!0}}},{key:"onDestroy",value:function(){this.options&&this.options.enablePicked&&(this.pickBuffer=null),this.options=this.data=this.indexBuffer=this.normalBuffer=this.colorBuffer=this.positionBuffer=this.program=this.vertexArray=null}},{key:"onParseProperties",value:function(n,l){var v=n.length;if(n instanceof Array){var d=[];if(v<l){var x=Math.floor(l/v);l%=v;for(var y=0,M=0;y<v;y++,M++)for(var D=M<l?x+1:x,U=0;U<D;U++)d.push(n[y]);n=d}for(v=[],x=0;x<n.length;x++)v.push(this.normizedColor(n[x]))}else v=this.normizedColor(n);return v}}]),u}(Hu),Ls=function(){function a(u,n){Ye(this,a),this.layer=u,this.gl=n,this.initData()}return qe(a,[{key:"initData",value:function(){this.outWall3d={vertex:[],vertexBuffer:[],index:[],indexBuffer:[]},this.maxLength=0}},{key:"getData",value:function(){return this.outWall3d}},{key:"getMaxDataLength",value:function(){return this.maxLength}},{key:"onLayerChange",value:function(u,n){this.initData();var l=u.color,v=u.height,d=u.gradient;u=this.gl;for(var x=0;x<n.length;x++){var y=n[x].geometry.coordinates,M=y.length;this.maxLength=M>this.maxLength?M:this.maxLength;for(var D=[],U=0;U<M;U++){var C=this.layer.normizedPoint(y[U]);D.push(C)}M=n[x].color||l,"properties"in n[x]&&"color"in n[x].properties&&(M=n[x].properties.color),d||Object.prototype.toString.call(M)!=="[object Function]"||(M=M(n[x])),y=this.layer.normizedColor(d?d[0]:M),M=this.layer.normizedColor(d?d[1]:M),U=n[x].height||v,"properties"in n[x]&&"height"in n[x].properties&&(U=n[x].properties.height),Object.prototype.toString.call(U)==="[object Function]"&&(U=U(n[x])),this.processData(this.outWall3d,D,y,M,U)}for(n=0;n<this.outWall3d.vertex.length;n++){for(l=[],v=this.outWall3d.vertex[n].length,d=0;d<v;d++)l.push.apply(l,ri(this.outWall3d.vertex[n][d]));v=u.createBuffer(),u.bindBuffer(u.ARRAY_BUFFER,v),u.bufferData(u.ARRAY_BUFFER,new Float32Array(l),u.STATIC_DRAW),this.outWall3d.vertexBuffer[n]=v,u.bindBuffer(u.ARRAY_BUFFER,null),v=u.createBuffer(),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,v),u.bufferData(u.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.outWall3d.index[n]),u.STATIC_DRAW),this.outWall3d.indexBuffer[n]=v,u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,null)}}},{key:"processData",value:function(u,n,l,v,d){var x=u.vertex[u.vertex.length-1],y=u.index[u.index.length-1],M=n.length;(!y||65536<=y.length+2*M+2)&&(x=[],y=[],u.vertex.push(x),u.index.push(y)),(u=x.length)&&y.push(u-1,u);for(var D=u=0;D<M;D++){var U=[],C=[],E=n[D];U.push(E[0],E[1]),U.push(E[2]?Number(E[2])+d:d),U.push(E[3]?Number(E[3]):D),U.push(u),U.push(l[0],l[1],l[2],l[3]),C.push(E[0],E[1]),C.push(E[2]?Number(E[2]):0),C.push(E[3]?Number(E[3]):D),C.push(u),C.push(v[0],v[1],v[2],v[3]),E=x.length,x.push(U,C),y.push(E,E+1),D<M-1&&(u+=this.getDistance(n[D],n[D+1]))}}},{key:"getDistance",value:function(u,n){return Math.sqrt(Math.pow(Math.abs(u[0]-n[0]),2)+Math.pow(Math.abs(u[1]-n[1]),2))}}]),a}(),ug=function(a){function u(n,l){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n,l)),n.startTime=n.options.startTime||0,n.endTime=n.options.endTime,n.time=n.startTime,n.autoUpdate=!0,n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{height:100,color:[1,1,1,1],trailLength:3,step:.1}}},{key:"initialize",value:function(n){this.gl=n,this.dataMgr=new Ls(this,this.gl),this.program=new ii(this.gl,{vertexShader:"uniform mat4 u_matrix;uniform float currentTime;uniform float trailLength;attribute vec4 aPos;attribute float aDistance;attribute vec4 aColor;varying vec4 vColor;varying float vHeight;varying float vTime;varying float vDistance;void main(){vTime=1.0-((currentTime-aPos.w)/trailLength);vHeight=aPos.z;vColor=aColor;vDistance=aDistance;gl_Position=u_matrix*vec4(aPos.xyz,1.0);}",fragmentShader:"precision highp float;varying vec4 vColor;varying float vTime;varying float vDistance;varying float vHeight;uniform float currentTime;void main(){if(vTime>1.0||vTime<0.0){}float radius=2.5;float distance=vDistance+currentTime*20.0;float modDistance=mod(distance,9.0);float alpha=1.0;if(modDistance>radius*2.0){discard;}else{float x=abs(modDistance-radius);float y=abs(vHeight-radius);float dis=sqrt(pow(x,2.0)+pow(y,2.0));if(dis>radius){discard;}alpha=dis/radius;}gl_FragColor=vec4(vColor.rgb,1.0-alpha);}"})}},{key:"onChanged",value:function(n,l){this.gl&&(this.dataMgr.onLayerChange(n,l),n.endTime===void 0&&(this.endTime=this.dataMgr.getMaxDataLength()))}},{key:"render",value:function(n){var l=n.gl,v=n.matrix;if((n=this.dataMgr.getData())&&!(0>=n.vertex.length)){var d=this.getOptions(),x=this.program;for(l.useProgram(x.program),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA]}),l.enableVertexAttribArray(x.attributes.aPos),l.enableVertexAttribArray(x.attributes.aDistance),l.enableVertexAttribArray(x.attributes.aColor),l.uniformMatrix4fv(x.uniforms.u_matrix,!1,v),l.uniform1f(x.uniforms.currentTime,this.time),l.uniform1f(x.uniforms.trailLength,d.trailLength),v=0;v<n.vertex.length;v++)if(!(0>=n.vertex[v].length)){var y=n.vertex[v],M=new Float32Array(y[0]).BYTES_PER_ELEMENT;y=M*y[0].length,l.bindBuffer(l.ARRAY_BUFFER,n.vertexBuffer[v]),l.vertexAttribPointer(x.attributes.aPos,4,l.FLOAT,!1,y,0),l.vertexAttribPointer(x.attributes.aDistance,1,l.FLOAT,!1,y,4*M),l.vertexAttribPointer(x.attributes.aColor,4,l.FLOAT,!1,y,5*M),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n.indexBuffer[v]),l.drawElements(l.TRIANGLE_STRIP,n.index[v].length,l.UNSIGNED_SHORT,0),l.bindBuffer(l.ARRAY_BUFFER,null),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,null)}this.time+=d.step,this.time>this.endTime&&(this.time=this.startTime)}}}]),u}(Ui),Dh=function(a,u,n,l){if(!(a instanceof u)||l!==void 0&&l in a)throw TypeError(n+": incorrect invocation!");return a},po=Rt(function(a){var u={},n={};a=a.exports=function(l,v,d,x,y){y=y?function(){return l}:fa(l),d=Ao(d,x,v?2:1),x=0;var M,D;if(typeof y!="function")throw TypeError(l+" is not iterable!");if(y===void 0||_s.Array!==y&&Ed[In]!==y){for(x=y.call(l);!(D=x.next()).done;)if(y=xl(x,d,D.value,v),y===u||y===n)return y}else for(M=ki(l.length);M>x;x++)if(y=v?d(Yo(D=l[x])[0],D[1]):d(l[x]),y===u||y===n)return y},a.BREAK=u,a.RETURN=n}),U1=Sn("species"),H1=function(a,u){a=Yo(a).constructor;var n;return a===void 0||(n=Yo(a)[U1])==null?u:eu(n)},ap=function(a,u,n){var l=n===void 0;switch(u.length){case 0:return l?a():a.call(n);case 1:return l?a(u[0]):a.call(n,u[0]);case 2:return l?a(u[0],u[1]):a.call(n,u[0],u[1]);case 3:return l?a(u[0],u[1],u[2]):a.call(n,u[0],u[1],u[2]);case 4:return l?a(u[0],u[1],u[2],u[3]):a.call(n,u[0],u[1],u[2],u[3])}return a.apply(n,u)},cu=ei.process,Oh=ei.setImmediate,ya=ei.clearImmediate,Fh=ei.MessageChannel,up=ei.Dispatch,lp=0,Bh={},Dc=function(){var a=+this;if(Bh.hasOwnProperty(a)){var u=Bh[a];delete Bh[a],u()}},lg=function(a){Dc.call(a.data)};if(!Oh||!ya)if(Oh=function(a){for(var u=[],n=1;arguments.length>n;)u.push(arguments[n++]);return Bh[++lp]=function(){ap(typeof a=="function"?a:Function(a),u)},Pl(lp),lp},ya=function(a){delete Bh[a]},vs(cu)=="process")var Pl=function(a){cu.nextTick(Ao(Dc,a,1))};else if(up&&up.now)Pl=function(a){up.now(Ao(Dc,a,1))};else if(Fh){var fv=new Fh,k1=fv.port2;fv.port1.onmessage=lg,Pl=Ao(k1.postMessage,k1,1)}else ei.addEventListener&&typeof postMessage=="function"&&!ei.importScripts?(Pl=function(a){ei.postMessage(a+"","*")},ei.addEventListener("message",lg,!1)):Pl="onreadystatechange"in(hl?As.createElement("script"):{})?function(a){dc.appendChild(hl?As.createElement("script"):{}).onreadystatechange=function(){dc.removeChild(this),Dc.call(a)}}:function(a){setTimeout(Ao(Dc,a,1),0)};var hg=Oh,pv=ei.MutationObserver||ei.WebKitMutationObserver,cg=ei.process,fg=ei.Promise,dv=vs(cg)=="process",hp={f:function(a){return new sa(a)}},cp=function(a){try{return{e:!1,v:a()}}catch(u){return{e:!0,v:u}}},G1=ei.navigator,fp=G1&&G1.userAgent||"",Dl=function(a,u){if(Yo(a),Xo(u)&&u.constructor===a)return u;a=hp.f(a);var n=a.resolve;return n(u),a.promise},Ua=function(a,u,n){for(var l in u)n&&a[l]?a[l]=u[l]:aa(a,l,u[l]);return a},Rs=Sn("species"),b1=function(a){a=typeof Qr[a]=="function"?Qr[a]:ei[a],xs&&a&&!a[Rs]&&Zo.f(a,Rs,{configurable:!0,get:function(){return this}})},gv=function(){var a,u,n=function(){var y;for(dv&&(y=cg.domain)&&y.exit();a;){var M=a.fn;a=a.next;try{M()}catch(D){throw a?l():u=void 0,D}}u=void 0,y&&y.enter()};if(dv)var l=function(){cg.nextTick(n)};else if(!pv||ei.navigator&&ei.navigator.standalone)if(fg&&fg.resolve){var v=fg.resolve(void 0);l=function(){v.then(n)}}else l=function(){hg.call(ei,n)};else{var d=!0,x=document.createTextNode("");new pv(n).observe(x,{characterData:!0}),l=function(){x.data=d=!d}}return function(y){y={fn:y,next:void 0},u&&(u.next=y),a||(a=y,l()),u=y}}(),Oc=ei.TypeError,ku=ei.process,pg=ku&&ku.versions,fA=pg&&pg.v8||"",fu=ei.Promise,Ol=vl(ku)=="process",dg=function(){},V1,Fc=V1=hp.f,pp=!!function(){try{var a=fu.resolve(1),u=(a.constructor={})[Sn("species")]=function(n){n(dg,dg)};return(Ol||typeof PromiseRejectionEvent=="function")&&a.then(dg)instanceof u&&fA.indexOf("6.6")!==0&&fp.indexOf("Chrome/66")===-1}catch(n){}}(),mv=function(a){var u;return Xo(a)&&typeof(u=a.then)=="function"?u:!1},vv=function(a,u){if(!a._n){a._n=!0;var n=a._c;gv(function(){for(var l=a._v,v=a._s==1,d=0;n.length>d;){var x=void 0,y=void 0,M=void 0,D=n[d++],U=v?D.ok:D.fail,C=D.resolve,E=D.reject,B=D.domain;try{U?(v||(a._h==2&&yv(a),a._h=1),U===!0?M=l:(B&&B.enter(),M=U(l),B&&(B.exit(),x=!0)),M===D.promise?E(Oc("Promise-chain cycle")):(y=mv(M))?y.call(M,C,E):C(M)):E(l)}catch(O){B&&!x&&B.exit(),E(O)}}a._c=[],a._n=!1,u&&!a._h&&pA(a)})}},pA=function(a){hg.call(ei,function(){var u=a._v,n=a._h!==1&&(a._a||a._c).length===0,l,v;if(n){var d=cp(function(){Ol?ku.emit("unhandledRejection",u,a):(l=ei.onunhandledrejection)?l({promise:a,reason:u}):(v=ei.console)&&v.error&&v.error("Unhandled promise rejection",u)});a._h=Ol||a._h!==1&&(a._a||a._c).length===0?2:1}if(a._a=void 0,n&&d.e)throw d.v})},yv=function(a){hg.call(ei,function(){var u;Ol?ku.emit("rejectionHandled",a):(u=ei.onrejectionhandled)&&u({promise:a,reason:a._v})})},Bc=function(a){var u=this;u._d||(u._d=!0,u=u._w||u,u._v=a,u._s=2,u._a||(u._a=u._c.slice()),vv(u,!0))},xv=function(a){var u=this,n;if(!u._d){u._d=!0,u=u._w||u;try{if(u===a)throw Oc("Promise can't be resolved itself");(n=mv(a))?gv(function(){var l={_w:u,_d:!1};try{n.call(a,Ao(xv,l,1),Ao(Bc,l,1))}catch(v){Bc.call(l,v)}}):(u._v=a,u._s=1,vv(u,!1))}catch(l){Bc.call({_w:u,_d:!1},l)}}};if(!pp){fu=function(a){Dh(this,fu,"Promise","_h"),eu(a),Ha.call(this);try{a(Ao(xv,this,1),Ao(Bc,this,1))}catch(u){Bc.call(this,u)}};var Ha=function(a){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1};Ha.prototype=Ua(fu.prototype,{then:function(a,u){var n=Fc(H1(this,fu));return n.ok=typeof a=="function"?a:!0,n.fail=typeof u=="function"&&u,n.domain=Ol?ku.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&vv(this,!1),n.promise},catch:function(a){return this.then(void 0,a)}});var go=function(){var a=new Ha;this.promise=a,this.resolve=Ao(xv,a,1),this.reject=Ao(Bc,a,1)};hp.f=Fc=function(a){return a===fu||a===W1?new go(a):V1(a)}}Sr(Sr.G+Sr.W+Sr.F*!pp,{Promise:fu}),lh(fu,"Promise"),b1("Promise");var W1=Qr.Promise;Sr(Sr.S+Sr.F*!pp,"Promise",{reject:function(a){var u=Fc(this),n=u.reject;return n(a),u.promise}}),Sr(Sr.S+1*Sr.F,"Promise",{resolve:function(a){return Dl(this===W1?fu:this,a)}}),Sr(Sr.S+Sr.F*!(pp&&jf(function(a){fu.all(a).catch(dg)})),"Promise",{all:function(a){var u=this,n=Fc(u),l=n.resolve,v=n.reject,d=cp(function(){var x=[],y=0,M=1;po(a,!1,function(D){var U=y++,C=!1;x.push(void 0),M++,u.resolve(D).then(function(E){C||(C=!0,x[U]=E,--M||l(x))},v)}),--M||l(x)});return d.e&&v(d.v),n.promise},race:function(a){var u=this,n=Fc(u),l=n.reject,v=cp(function(){po(a,!1,function(d){u.resolve(d).then(n.resolve,l)})});return v.e&&l(v.v),n.promise}}),Sr(Sr.P+Sr.R,"Promise",{finally:function(a){var u=H1(this,Qr.Promise||ei.Promise),n=typeof a=="function";return this.then(n?function(l){return Dl(u,a()).then(function(){return l})}:a,n?function(l){return Dl(u,a()).then(function(){throw l})}:a)}}),Sr(Sr.S,"Promise",{try:function(a){var u=hp.f(this);return a=cp(a),(a.e?u.reject:u.resolve)(a.v),u.promise}});var an=Qr.Promise,Av=Rt(function(a){a.exports={default:an,__esModule:!0}}),Fl=Nt(Av),Bl=function(a,u){if(!Xo(a)||a._t!==u)throw TypeError("Incompatible receiver, "+u+" required!");return a},dA=Zo.f,dp=ua.fastKey,Nc=xs?"_s":"size",zc=function(a,u){var n=dp(u);if(n!=="F")return a._i[n];for(a=a._f;a;a=a.n)if(a.k==u)return a},Uc={getConstructor:function(a,u,n,l){var v=a(function(d,x){Dh(d,v,u,"_i"),d._t=u,d._i=Tu(null),d._f=void 0,d._l=void 0,d[Nc]=0,x!=null&&po(x,n,d[l],d)});return Ua(v.prototype,{clear:function(){for(var d=Bl(this,u),x=d._i,y=d._f;y;y=y.n)y.r=!0,y.p&&(y.p=y.p.n=void 0),delete x[y.i];d._f=d._l=void 0,d[Nc]=0},delete:function(d){var x=Bl(this,u);if(d=zc(x,d)){var y=d.n,M=d.p;delete x._i[d.i],d.r=!0,M&&(M.n=y),y&&(y.p=M),x._f==d&&(x._f=y),x._l==d&&(x._l=M),x[Nc]--}return!!d},forEach:function(d){Bl(this,u);for(var x=Ao(d,1<arguments.length?arguments[1]:void 0,3),y;y=y?y.n:this._f;)for(x(y.v,y.k,this);y&&y.r;)y=y.p},has:function(d){return!!zc(Bl(this,u),d)}}),xs&&dA(v.prototype,"size",{get:function(){return Bl(this,u)[Nc]}}),v},def:function(a,u,n){var l=zc(a,u),v;return l?l.v=n:(a._l=l={i:v=dp(u,!0),k:u,v:n,p:u=a._l,n:void 0,r:!1},a._f||(a._f=l),u&&(u.n=l),a[Nc]++,v!=="F"&&(a._i[v]=l)),a},getEntry:zc,setStrong:function(a,u,n){mc(a,u,function(l,v){this._t=Bl(l,u),this._k=v,this._l=void 0},function(){for(var l=this._k,v=this._l;v&&v.r;)v=v.p;return this._t&&(this._l=v=v?v.n:this._t._f)?l=="keys"?Da(0,v.k):l=="values"?Da(0,v.v):Da(0,[v.k,v.v]):(this._t=void 0,Da(1))},n?"entries":"values",!n,!0),b1(u)}},gA=Sn("species"),mA=function(a,u){if(hh(a)){var n=a.constructor;typeof n!="function"||n!==Array&&!hh(n.prototype)||(n=void 0),Xo(n)&&(n=n[gA],n===null&&(n=void 0))}return new(n===void 0?Array:n)(u)},An=Zo.f,vA=function(a,u){var n=a==1,l=a==2,v=a==3,d=a==4,x=a==6,y=a==5||x,M=u||mA;return function(D,U,C){var E=Object(ms(D)),B=Cf(E);U=Ao(U,C,3),C=ki(B.length);var O=0;D=n?M(D,C):l?M(D,0):void 0;for(var H,V;C>O;O++)if((y||O in B)&&(H=B[O],V=U(H,O,E),a)){if(n)D[O]=V;else if(V)switch(a){case 3:return!0;case 5:return H;case 6:return O;case 2:D.push(H)}else if(d)return!1}return x?-1:v||d?d:D}}(0);(function(a,u,n,l,v,d){var x=ei[a],y=x,M=v?"set":"add",D=y&&y.prototype,U={};return xs&&typeof y=="function"&&(d||D.forEach&&!ru(function(){new y().entries().next()}))?(y=u(function(C,E){Dh(C,y,a,"_c"),C._c=new x,E!=null&&po(E,v,C[M],C)}),vA("add clear delete forEach get has set keys values entries toJSON".split(" "),function(C){var E=C=="add"||C=="set";C in D&&(!d||C!="clear")&&aa(y.prototype,C,function(B,O){return Dh(this,y,C),!E&&d&&!Xo(B)?C=="get"?void 0:!1:(B=this._c[C](B===0?0:B,O),E?this:B)})}),d||An(y.prototype,"size",{get:function(){return this._c.size}})):(y=l.getConstructor(u,a,v,M),Ua(y.prototype,n),ua.NEED=!0),lh(y,a),U[a]=y,Sr(Sr.G+Sr.W+Sr.F,U),d||l.setStrong(y,a,v),y})("Map",function(a){return function(){return a(this,0<arguments.length?arguments[0]:void 0)}},{get:function(a){return(a=Uc.getEntry(Bl(this,"Map"),a))&&a.v},set:function(a,u){return Uc.def(Bl(this,"Map"),a===0?0:a,u)}},Uc,!0),Sr(Sr.P+Sr.R,"Map",{toJSON:function(a){return function(){if(vl(this)!=a)throw TypeError(a+"#toJSON isn't generic");var u=[];return po(this,!1,u.push,u,void 0),u}}("Map")}),function(a){Sr(Sr.S,a,{of:function(){for(var u=arguments.length,n=Array(u);u--;)n[u]=arguments[u];return new this(n)}})}("Map"),function(a){Sr(Sr.S,a,{from:function(u,n,l){var v;if(eu(this),(v=n!==void 0)&&eu(n),u==null)return new this;var d=[];if(v){var x=0,y=Ao(n,l,2);po(u,!1,function(M){d.push(y(M,x++))})}else po(u,!1,d.push,d);return new this(d)}})}("Map");var yA=Qr.Map,Mo=Rt(function(a){a.exports={default:yA,__esModule:!0}}),Nl=Nt(Mo),Ji=Rt(function(a,u){u.__esModule=!0;var n=ws&&ws.__esModule?ws:{default:ws};u.default=function(l,v,d){return v in l?(0,n.default)(l,v,{value:d,enumerable:!0,configurable:!0,writable:!0}):l[v]=d,l}}),Hc=Nt(Ji),jn,gp,xA=(jn={},Hc(jn,1,1),Hc(jn,2,1),Hc(jn,3,1),jn),j1=(gp={},Hc(gp,1,1),Hc(gp,2,1),Hc(gp,3,1),gp),Nh=function(a){function u(n,l){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n,l)),n.vertCount=0,n.bufferMap={},n.bufferData=[],n.autoUpdate=!0,l=n.canvas=document.createElement("canvas"),n.ctx=l.getContext("2d"),n.iconHash=new Nl,n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{color:[1,1,1,.8],speed:1,size:5,pointFade:!0,pointFadeBuffer:1,minLineLength:2,animationType:2,shapeType:2,depthTest:!1,delay:0,unit:"px",padding:0}}},{key:"initialize",value:function(n){this.gl=n,this.texture=null,this.isUseTexture=!1;var l=this.getOptions();this.updateUniformsFromOptions(l),this.program=new ii(this.gl,{vertexShader:"precision highp float;attribute vec3 aPos;attribute vec3 aNextPos;attribute vec4 aColor;attribute float aIndex;attribute float aNextIndex;attribute float aLength;attribute float aSpeed;attribute float aDelay;attribute vec3 aUV;uniform float uSize;uniform mat4 u_matrix;uniform float uOriginSpeed;uniform float uElapsedSteps;uniform int uAnimationType;uniform int uPointFade;uniform float uPointFadeBuffer;uniform float uZoomUnits;varying float vAddOpacity;varying vec3 vUV;varying vec4 vColor;void main(){vColor=aColor;if(uAnimationType==1){if(abs(aIndex-mod(uElapsedSteps,aLength))>.1){gl_Position=vec4(-2.,-2.,0,1.0);return;}gl_Position=u_matrix*vec4(aPos.xyz,1.0);vAddOpacity=1.;}else if(uAnimationType==2){float lineLength=aLength-1.;float cIndex=mod(uElapsedSteps,lineLength);float rest=cIndex-aIndex;if(rest<1.&&rest>=0.){if(uPointFade==1){if(cIndex<uPointFadeBuffer){vAddOpacity=cIndex/uPointFadeBuffer;}else if(cIndex>lineLength-uPointFadeBuffer){vAddOpacity=(lineLength-cIndex)/uPointFadeBuffer;}else{vAddOpacity=1.;}}else{vAddOpacity=1.;}gl_Position=u_matrix*vec4(aPos.x+(aNextPos.x-aPos.x)*rest,aPos.y+(aNextPos.y-aPos.y)*rest,aPos.z+(aNextPos.z-aPos.z)*rest,1.0);}else{gl_Position=vec4(-2.,-2.,0,1.0);return;}}else if(uAnimationType==3){float speedRatio=aSpeed/uOriginSpeed;float percent=mod(mod(uElapsedSteps*aSpeed,aLength)/aLength-aDelay,1.0);if(percent<=aNextIndex&&percent>=aIndex){if(uPointFade==1){float fadePercent=uPointFadeBuffer*1000./aLength;if(percent<fadePercent){vAddOpacity=percent/fadePercent;}else if(percent>1.-fadePercent){vAddOpacity=(1.-percent)/fadePercent;}else{vAddOpacity=1.;}}else{vAddOpacity=1.;}float rest=(percent-aIndex)/(aNextIndex-aIndex);gl_Position=u_matrix*vec4(aPos.x+(aNextPos.x-aPos.x)*rest,aPos.y+(aNextPos.y-aPos.y)*rest,aPos.z+(aNextPos.z-aPos.z)*rest,1.0);}else{gl_Position=vec4(-2.,-2.,0,1.0);return;}}vUV=aUV;gl_PointSize=uSize/uZoomUnits;}",fragmentShader:"precision highp float;uniform int ushapeType;uniform bool uUseTexture;uniform sampler2D uSampler;varying float vAddOpacity;varying vec4 vColor;varying vec3 vUV;void main(){if(ushapeType==2){float d=distance(gl_PointCoord,vec2(0.5,0.5));if(d>0.5){discard;}gl_FragColor=vec4(vColor.rgb,vColor.a*vAddOpacity);}else if(ushapeType==3){float d=distance(gl_PointCoord,vec2(0.5,0.5));if(d>0.5){discard;}gl_FragColor=vec4(vColor.rgb,vColor.a*smoothstep(1.0,0.0,d*2.)*vAddOpacity);}else{gl_FragColor=vec4(vColor.rgb,vColor.a*vAddOpacity);}if(uUseTexture){float ratio=vUV.z;vec2 uv=vUV.xy;gl_FragColor=texture2D(uSampler,vec2(gl_PointCoord.x*ratio+uv.x,1.0-(uv.y+gl_PointCoord.y*ratio)));}}"}),this.buffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.buffer)}},{key:"bindAttributeBufferData",value:function(n,l,v,d){var x=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,x),v=new Float32Array(v),n.bufferData(n.ARRAY_BUFFER,v,n.STATIC_DRAW),this.bufferMap[l]={buffer:x,data:v,elementSize:d}}},{key:"onChanged",value:function(n,l){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{};this.gl&&(Array.isArray(l)||(l=[]),this.processCache(n,l,v))}},{key:"processCache",value:function(n,l,v){var d=this;this.cachedData=[];for(var x=n.icon,y=n.speed,M=n.color,D=0;D<l.length;D++){var U=l[D].geometry.coordinates,C=this.getProperty("color",M,l[D]);C=this.normizedColor(C);var E=this.getProperty("icon",x,l[D]),B=this.getProperty("speed",y,l[D]),O=this.getProperty("delay",0,l[D]);U&&(this.cachedData.push({coordinates:U,color:C,icon:E,speed:B,delay:O}),this.iconHash.get(E)||this.iconHash.set(E,E))}l=Ba(this.iconHash.entries()).filter(function(H){return typeof H[1]=="string"}).map(function(H){var V=Pi(H,2)[0];return new Fl(function(G,j){d.url2canvas(V,function(Y){d.iconHash.set(V,Y),G()})})}),Fl.all(l).then(function(H){d.buildSprite(n),v.autoRender!==!1&&d.webglLayer&&d.webglLayer.render()})}},{key:"buildSprite",value:function(n){var l=n.padding,v=this.canvas,d=this.ctx,x=0,y=[],M=new Nl;if(n.icon){x=!0;var D=!1,U=void 0;try{for(var C=as(this.iconHash),E;!(x=(E=C.next()).done);x=!0){var B=Pi(E.value,2),O=B[1];if(typeof O!="string"){var H=O.width,V=H+l;y.push({w:V,h:V,width:H,key:B[0],icon:O})}}}catch(G){D=!0,U=G}finally{try{!x&&C.return&&C.return()}finally{if(D)throw U}}for(C=mn(y),E=0;E<y.length;E++)B=y[E],M.get(B.key)||M.set(B.key,B);for(x=Math.max(ye(C.w),ye(C.h)),v.width=x||1,v.height=x||1,d.save(),v=0;v<y.length;v++)C=y[v],d.drawImage(C.icon,C.x+l,C.y+l,C.width,C.width);d.restore()}this.loadTexture(),this.buildVertex(n,M,x)}},{key:"buildVertex",value:function(n,l,v){var d=this.gl;this.updateUniformsFromOptions(n);for(var x=[],y=[],M=[],D=[],U=[],C=[],E=[],B=[],O=[],H=n.minLineLength,V=0;V<this.cachedData.length;V++){var G=this.cachedData[V],j=G.coordinates,Y=G.icon,$=G.speed,it=G.delay;G=G.color;var nt=j.length,dt=[];if(!(nt<H)){for(n.icon&&(dt=(dt=l.get(Y))?[dt.x/v,dt.y/v,dt.w/v]:[0,0,0]),Y=0;Y<nt;++Y){var Et=this.normizedPoint(j[Y]);x.push(Et[0]),x.push(Et[1]),x.push(Et[2]||0),y.push.apply(y,ri(G)),O.push.apply(O,ri(dt)),this.animationType!==3&&(M.push(Y),U.push(nt))}if(this.animationType!==1){for(dt=x.length-3*nt+3,nt=x.length,j=dt;j<nt;++j)C.push(x[j]);if(x.splice(nt-3,3),O.splice(nt-3,2),y.splice(nt-3,4),this.animationType===2)M.pop(),U.pop();else if(this.animationType===3){for(dt-=3,nt=x.length-3,j=0,G=[],Y=dt;Y<=nt;Y+=3)dt=Math.sqrt(Math.pow(C[Y]-x[Y],2)+Math.pow(C[Y+1]-x[Y+1],2)+Math.pow(C[Y+2]-x[Y+2],2)),j+=dt,G.push(dt);for(M.push(0),E.push($),it/=j/$,B.push(it),Y=nt=0,Et=G.length-1;Y<Et;++Y)nt+=G[Y],dt=nt/j,M.push(dt),D.push(dt),U.push(j),E.push($),B.push(it);D.push(1),U.push(j)}}}}this.bindAttributeBufferData(d,"aPos",x,3),this.bindAttributeBufferData(d,"aIndex",M,1),this.bindAttributeBufferData(d,"aLength",U,1),this.bindAttributeBufferData(d,"aColor",y,4),this.animationType!==1&&(this.bindAttributeBufferData(d,"aNextPos",C,3),this.animationType===3&&(this.bindAttributeBufferData(d,"aNextIndex",D,1),this.bindAttributeBufferData(d,"aSpeed",E,1),this.bindAttributeBufferData(d,"aDelay",B,1))),n.icon&&this.bindAttributeBufferData(d,"aUV",O,3),this.vertCount=x.length/3}},{key:"updateUniformsFromOptions",value:function(n){this.startTime=new Date().getTime(),xA[n.animationType]||(n.animationType=2),j1[n.shapeType]||(n.shapeType=2),(isNaN(n.minLineLength)||2>n.minLineLength)&&(n.minLineLength=2),this.animationType=n.animationType}},{key:"renderAttributeArr",value:function(n,l,v){if(l.attributes[v]!==void 0){var d=this.bufferMap[v];d&&(n.bindBuffer(n.ARRAY_BUFFER,d.buffer),n.enableVertexAttribArray(l.attributes[v]),n.vertexAttribPointer(l.attributes[v],d.elementSize,n.FLOAT,!1,d.data.BYTES_PER_ELEMENT*d.elementSize,0))}}},{key:"render",value:function(n){var l=n.gl;if(n=n.matrix,!(0>=this.vertCount)){var v=this.getOptions(),d=this.program;l.useProgram(d.program),this.renderAttributeArr(l,d,"aPos"),this.renderAttributeArr(l,d,"aIndex"),this.renderAttributeArr(l,d,"aLength"),this.renderAttributeArr(l,d,"aColor"),this.animationType!==1&&(this.renderAttributeArr(l,d,"aNextPos"),this.animationType===3&&(this.renderAttributeArr(l,d,"aNextIndex"),this.renderAttributeArr(l,d,"aSpeed"),this.renderAttributeArr(l,d,"aDelay"))),v.icon&&this.texture&&(this.renderAttributeArr(l,d,"aUV"),l.activeTexture(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,this.texture),l.uniform1i(d.uniforms.uSampler,0)),l.uniform1i(d.uniforms.uUseTexture,this.isUseTexture);var x=new Date().getTime()-this.startTime;x<this.options.delay?x=0:(x-=this.options.delay,x=this.animationType===1?Math.round(x/1e3*this.options.speed*20):this.animationType===3?x/1e3*this.options.speed*1e3:x/1e3*this.options.speed);var y=this.options.size;if(Array.isArray(y)){var M=this.map.map.getMaxZoom(),D=this.map.map.getMinZoom();y=y[0]+(this.map.getZoom()-D)/(M-D)*(y[1]-y[0])}l.uniformMatrix4fv(d.uniforms.u_matrix,!1,n),l.uniform1f(d.uniforms.uSize,y),l.uniform1f(d.uniforms.uElapsedSteps,x),l.uniform1f(d.uniforms.uOriginSpeed,this.options.speed),l.uniform1i(d.uniforms.uAnimationType,this.animationType),l.uniform1i(d.uniforms.ushapeType,this.options.shapeType),l.uniform1i(d.uniforms.uPointFade,this.options.pointFade?1:0),l.uniform1f(d.uniforms.uPointFadeBuffer,this.options.pointFadeBuffer),l.uniform1f(d.uniforms.uZoomUnits,this.options.unit==="m"?this.map.getZoomUnits():1),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:v.blend==="lighter"?[l.SRC_ALPHA,l.ONE]:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA],depthTest:!!v.depthTest}),l.drawArrays(l.POINTS,0,this.vertCount)}}},{key:"url2canvas",value:function(n,l){if((typeof n=="undefined"?"undefined":si(n))==="object")l(n);else{var v=new Image;v.crossOrigin="anonymous",v.onload=function(){var d=document.createElement("canvas");d.width=128,d.height=128,d.getContext("2d").drawImage(v,0,0,128,128),l(d)},v.src=n}}},{key:"loadTexture",value:function(){var n=this;this.canvas&&this.getOptions().icon?Bn(this.gl,this.canvas,function(l){n.isUseTexture=!0,n.texture=l}):(this.isUseTexture=!1,this.texture=null)}}]),u}(Ui);Nh.ANIMATION_TYPE_LEAP=1,Nh.ANIMATION_TYPE_SMOOTH=2,Nh.ANIMATION_TYPE_UNIFORM_SPEED=3,Nh.SHAPE_TYPE_SQUARE=1,Nh.SHAPE_TYPE_CIRCLE=2,Nh.SHAPE_TYPE_CIRCLE_GRADIENT=3;var Co=function(){function a(u,n){Ye(this,a),this.layer=u,this.gl=n,this.initData()}return qe(a,[{key:"initData",value:function(){this.outWall3d={vertex:[],vertexBuffer:[],index:[],indexBuffer:[]}}},{key:"getData",value:function(){return this.outWall3d}},{key:"onLayerChange",value:function(u,n){this.initData();for(var l=u.color,v=u.height,d=u.gradient,x=u.enablePreciseMap,y=u.repeatMap,M=u.closePath,D=this.gl,U=0;U<n.length;U++){var C=n[U],E=C.color||l;"properties"in C&&"color"in C.properties&&(E=C.properties.color),d||Object.prototype.toString.call(E)!=="[object Function]"||(E=E(C));var B=this.layer.normizedColor(d?d[0]:E);E=this.layer.normizedColor(d?d[1]:E);var O=C.height||v;if("properties"in C&&"height"in C.properties&&(O=C.properties.height),Object.prototype.toString.call(O)==="[object Function]"&&(O=O(C)),C.geometry.type==="MultiLineString"||C.geometry.type==="Polygon")for(var H=0;H<C.geometry.coordinates.length;H++){var V=C.geometry.coordinates[H];M&&!Ce(V)&&V.push(V[0]);for(var G=[],j=[],Y=0,$=0;$<V.length;$++){var it=this.layer.normizedPoint(V[$]);if(0<$&&(x||y)){var nt=this.layer.normizedPoint(V[$-1]);Y+=Math.sqrt(Math.pow(it[0]-nt[0],2)+Math.pow(it[1]-nt[1],2))}G.push(it),j.push(Y)}this.processData(this.outWall3d,u,G,j,B,E,O)}else{for(C=C.geometry.coordinates,M&&!Ce(C)&&C.push(C[0]),H=[],V=[],j=G=0;j<C.length;j++)Y=this.layer.normizedPoint(C[j]),0<j&&(x||y)&&($=this.layer.normizedPoint(C[j-1]),G+=Math.sqrt(Math.pow(Y[0]-$[0],2)+Math.pow(Y[1]-$[1],2))),H.push(Y),V.push(G);this.processData(this.outWall3d,u,H,V,B,E,O)}}for(u=0;u<this.outWall3d.vertex.length;u++){for(n=[],l=this.outWall3d.vertex[u].length,v=0;v<l;v++)n.push.apply(n,ri(this.outWall3d.vertex[u][v]));l=D.createBuffer(),D.bindBuffer(D.ARRAY_BUFFER,l),D.bufferData(D.ARRAY_BUFFER,new Float32Array(n),D.STATIC_DRAW),this.outWall3d.vertexBuffer[u]=l,D.bindBuffer(D.ARRAY_BUFFER,null),l=D.createBuffer(),D.bindBuffer(D.ELEMENT_ARRAY_BUFFER,l),D.bufferData(D.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.outWall3d.index[u]),D.STATIC_DRAW),this.outWall3d.indexBuffer[u]=l,D.bindBuffer(D.ELEMENT_ARRAY_BUFFER,null)}}},{key:"processData",value:function(u,n,l,v,d,x,y){var M=v[v.length-1],D=u.vertex[u.vertex.length-1],U=u.index[u.index.length-1],C=l.length;for((!U||65536<=U.length+2*C+2)&&(D=[],U=[],u.vertex.push(D),u.index.push(U)),(u=D.length)&&U.push(u-1,u),u=0;u<C;u++){var E=[],B=[],O=l[u];E.push(O[0],O[1],O[2]+y),E.push(d[0],d[1],d[2],d[3]),B.push(O[0],O[1],O[2]),B.push(x[0],x[1],x[2],x[3]),n.texture&&(O=v[u],n.enablePreciseMap||n.repeatMap?(E.push(O,1,M),B.push(O,0,M)):(E.push(u,1,C-1),B.push(u,0,C-1))),O=D.length,D.push(E,B),U.push(O,O+1)}}}]),a}(),AA=function(a){function u(n,l){return Ye(this,u),Pr(this,(u.__proto__||lr(u)).call(this,n,l))}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{texture:null,enablePreciseMap:!1,repeatMap:0,height:100,closePath:!1,color:[1,1,1,1]}}},{key:"initialize",value:function(n){this.gl=n,this.dataMgr=new Co(this,this.gl),this.texture=null,this.isUseTexture=!1,this.vertexLength=10,this.program=new ii(this.gl,{vertexShader:"uniform mat4 u_matrix;uniform bool uUseTexture;attribute vec3 aPos;attribute vec4 aColor;attribute vec2 aTextureCoords;attribute float aTotalDistance;varying vec2 vTextureCoords;varying float vTotalDistance;varying vec4 vColor;void main(){if(aColor.w>=0.0&&aColor.w<=1.0){vColor=aColor;}else{vColor=vec4(aColor.xyz,1.0);}if(uUseTexture){vTextureCoords=aTextureCoords;vTotalDistance=aTotalDistance;}gl_Position=u_matrix*vec4(aPos,1.0);}",fragmentShader:"precision highp float;uniform bool uUseTexture;uniform float uDistance;uniform sampler2D uSampler;varying vec2 vTextureCoords;varying float vTotalDistance;varying vec4 vColor;void main(){if(uUseTexture){float uvx=vTextureCoords.x/vTotalDistance;if(uDistance>0.0){uvx=mod(vTextureCoords.x,uDistance)/uDistance;}gl_FragColor=vec4(1.0,1.0,1.0,1.0)*texture2D(uSampler,vec2(uvx,vTextureCoords.y));}else{gl_FragColor=vColor;}}"}),this.loadTexture()}},{key:"onChanged",value:function(n,l){var v=this;this.gl&&(this.loadTextureTime&&clearTimeout(this.loadTextureTime),this.loadTextureTime=setTimeout(function(){v.loadTexture(function(){v.dataMgr.onLayerChange(n,l),v.webglLayer.render()})},0))}},{key:"render",value:function(n){var l=n.gl,v=n.matrix;if((n=this.dataMgr.getData())&&!(0>=n.vertex.length)){var d=this.getOptions(),x=this.program;if(l.useProgram(x.program),d.texture){if(!this.texture)return;l.activeTexture(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,this.texture),l.uniform1i(x.uniforms.uSampler,0)}for(this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA],depthMask:!!d.texture,depthFunc:d.texture?l.LESS:l.LEQUAL}),d.texture?l.enableVertexAttribArray(x.attributes.aTextureCoords):l.disableVertexAttribArray(x.attributes.aTextureCoords),l.enableVertexAttribArray(x.attributes.aPos),l.enableVertexAttribArray(x.attributes.aColor),l.uniformMatrix4fv(x.uniforms.u_matrix,!1,v),l.uniform1i(x.uniforms.uUseTexture,this.isUseTexture),l.uniform1f(x.uniforms.uDistance,d.repeatMap),v=0;v<n.vertex.length;v++)if(!(0>=n.vertex[v].length)){var y=n.vertex[v],M=new Float32Array(y[0]).BYTES_PER_ELEMENT;y=M*y[0].length,l.bindBuffer(l.ARRAY_BUFFER,n.vertexBuffer[v]),l.vertexAttribPointer(x.attributes.aPos,3,l.FLOAT,!1,y,0),l.vertexAttribPointer(x.attributes.aColor,4,l.FLOAT,!1,y,3*M),d.texture&&(l.vertexAttribPointer(x.attributes.aTextureCoords,2,l.FLOAT,!1,y,7*M),l.vertexAttribPointer(x.attributes.aTotalDistance,1,l.FLOAT,!1,y,9*M)),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n.indexBuffer[v]),l.drawElements(l.TRIANGLE_STRIP,n.index[v].length,l.UNSIGNED_SHORT,0),l.bindBuffer(l.ARRAY_BUFFER,null),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,null)}}}},{key:"loadTexture",value:function(n){var l=this,v=this.getOptions();v.texture?(this.isUseTexture=!0,Bn(this.gl,v.texture,function(d,x){l.image=x,l.texture=d,n&&n(),l.webglLayer.render()})):(this.isUseTexture=!1,this.image=this.texture=null,n&&n())}}]),u}(Ui),wA=function(){function a(u,n){Ye(this,a),this.layer=u,this.gl=n,this.initData()}return qe(a,[{key:"initData",value:function(){this.outWall3d={vertex:[],vertexBuffer:[],index:[],indexBuffer:[]},this.maxLength=0}},{key:"getData",value:function(){return this.outWall3d}},{key:"getMaxDataLength",value:function(){return this.maxLength}},{key:"onLayerChange",value:function(u,n){this.initData();var l=u.color,v=u.height,d=u.gradient;u=this.gl;for(var x=0;x<n.length;x++){var y=n[x].geometry.coordinates,M=y.length;this.maxLength=M>this.maxLength?M:this.maxLength;for(var D=[],U=0;U<M;U++){var C=this.layer.normizedPoint(y[U]);D.push(C)}M=n[x].color||l,"properties"in n[x]&&"color"in n[x].properties&&(M=n[x].properties.color),d||Object.prototype.toString.call(M)!=="[object Function]"||(M=M(n[x])),y=this.layer.normizedColor(d?d[0]:M),M=this.layer.normizedColor(d?d[1]:M),U=n[x].height||v,"properties"in n[x]&&"height"in n[x].properties&&(U=n[x].properties.height),Object.prototype.toString.call(U)==="[object Function]"&&(U=U(n[x])),this.processData(this.outWall3d,D,y,M,U)}for(n=0;n<this.outWall3d.vertex.length;n++){for(l=[],v=this.outWall3d.vertex[n].length,d=0;d<v;d++)l.push.apply(l,ri(this.outWall3d.vertex[n][d]));v=u.createBuffer(),u.bindBuffer(u.ARRAY_BUFFER,v),u.bufferData(u.ARRAY_BUFFER,new Float32Array(l),u.STATIC_DRAW),this.outWall3d.vertexBuffer[n]=v,u.bindBuffer(u.ARRAY_BUFFER,null),v=u.createBuffer(),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,v),u.bufferData(u.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.outWall3d.index[n]),u.STATIC_DRAW),this.outWall3d.indexBuffer[n]=v,u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,null)}}},{key:"processData",value:function(u,n,l,v,d){var x=u.vertex[u.vertex.length-1],y=u.index[u.index.length-1],M=n.length;for((!y||65536<=y.length+2*M+2)&&(x=[],y=[],u.vertex.push(x),u.index.push(y)),(u=x.length)&&y.push(u-1,u),u=0;u<M;u++){var D=[],U=[],C=n[u];D.push(C[0],C[1]),D.push(C[2]?Number(C[2])+d:d),D.push(C[3]?Number(C[3]):u),D.push(l[0],l[1],l[2],l[3]),U.push(C[0],C[1]),U.push(C[2]?Number(C[2]):0),U.push(C[3]?Number(C[3]):u),U.push(v[0],v[1],v[2],v[3]),C=x.length,x.push(D,U),y.push(C,C+1)}}}]),a}(),qi=function(a){function u(n,l){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n,l)),n.startTime=n.options.startTime||0,n.endTime=n.options.endTime,n.time=n.startTime,n.autoUpdate=!0,n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{height:100,color:[1,1,1,1],trailLength:3,step:.1}}},{key:"initialize",value:function(n){this.gl=n,this.dataMgr=new wA(this,this.gl),this.program=new ii(this.gl,{vertexShader:"uniform mat4 u_matrix;uniform float currentTime;uniform float trailLength;attribute vec4 aPos;attribute vec4 aColor;varying vec4 vColor;varying float vTime;void main(){vTime=1.0-((currentTime-aPos.w)/trailLength);vColor=aColor;gl_Position=u_matrix*vec4(aPos.xyz,1.0);}",fragmentShader:"precision highp float;varying vec4 vColor;varying float vTime;void main(){if(vTime>1.0||vTime<0.0){discard;}gl_FragColor=vec4(vColor.rgb,1.0*vTime);}"})}},{key:"onChanged",value:function(n,l){this.gl&&(this.dataMgr.onLayerChange(n,l),n.endTime===void 0&&(this.endTime=this.dataMgr.getMaxDataLength()))}},{key:"render",value:function(n){var l=n.gl,v=n.matrix;if((n=this.dataMgr.getData())&&!(0>=n.vertex.length)){var d=this.getOptions(),x=this.program;for(l.useProgram(x.program),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA]}),l.enableVertexAttribArray(x.attributes.aPos),l.enableVertexAttribArray(x.attributes.aColor),l.uniformMatrix4fv(x.uniforms.u_matrix,!1,v),l.uniform1f(x.uniforms.currentTime,this.time),l.uniform1f(x.uniforms.trailLength,d.trailLength),v=0;v<n.vertex.length;v++)if(!(0>=n.vertex[v].length)){var y=n.vertex[v],M=new Float32Array(y[0]).BYTES_PER_ELEMENT;y=M*y[0].length,l.bindBuffer(l.ARRAY_BUFFER,n.vertexBuffer[v]),l.vertexAttribPointer(x.attributes.aPos,4,l.FLOAT,!1,y,0),l.vertexAttribPointer(x.attributes.aColor,4,l.FLOAT,!1,y,4*M),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n.indexBuffer[v]),l.drawElements(l.TRIANGLE_STRIP,n.index[v].length,l.UNSIGNED_SHORT,0),l.bindBuffer(l.ARRAY_BUFFER,null),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,null)}this.time+=d.step,this.time>this.endTime&&(this.time=this.startTime)}}}]),u}(Ui),X1=function(a){function u(n,l){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n,l)),n.simpleLineLayer=new ig(n.getHeatOptions()),n.children=[n.simpleLineLayer],n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{blend:"normal",gradient:{0:"rgb(50, 50, 256)","0.1":"rgb(50, 250, 56)","0.5":"rgb(250, 250, 56)",1:"rgb(250, 50, 56)"}}}},{key:"onDataChanged",value:function(n){this.simpleLineLayer.setData(n)}},{key:"onOptionsChanged",value:function(n){this.simpleLineLayer.setOptions(this.getHeatOptions())}},{key:"getHeatOptions",value:function(){var n=this.getOptions(),l=n.max,v=n.min;l===void 0&&(v=this.getDataRange(),l=v.max,v=v.min);var d=new Wi({max:l,min:v,gradient:n.gradient});return n.color=function(x){var y=~~x.count||1;return"properties"in x&&"count"in x.properties&&(y=~~x.properties.count),x=d.getImageData(y),[x[0]/255,x[1]/255,x[2]/255,x[3]/255]},n}},{key:"getDataRange",value:function(){var n=this.getData(),l=0,v=0;n[0]&&(l=~~n[0].count||1,v=~~n[0].count||1),"properties"in n[0]&&"count"in n[0].properties&&(l=~~n[0].properties.count,v=~~n[0].properties.count);for(var d=n.length,x=0;x<d;x++){var y=~~n[x].count||1;"properties"in n[x]&&"count"in n[x].properties&&(y=~~n[x].properties.count),l=Math.max(y,l),v=Math.min(y,v)}return{max:l/2,min:v}}}]),u}(hu),wv=Rt(function(a,u){(function(n,l){a.exports=l()})(ll,function(){function n(j,Y,$,it,nt,dt){if(!(nt-it<=$)){var Et=it+nt>>1;l(j,Y,Et,it,nt,dt%2),n(j,Y,$,it,Et-1,dt+1),n(j,Y,$,Et+1,nt,dt+1)}}function l(j,Y,$,it,nt,dt){for(;nt>it;){if(600<nt-it){var Et=nt-it+1,St=$-it+1,Xt=Math.log(Et),te=.5*Math.exp(2*Xt/3);Xt=.5*Math.sqrt(Xt*te*(Et-te)/Et)*(0>St-Et/2?-1:1),l(j,Y,$,Math.max(it,Math.floor($-St*te/Et+Xt)),Math.min(nt,Math.floor($+(Et-St)*te/Et+Xt)),dt)}for(Et=Y[2*$+dt],St=it,te=nt,v(j,Y,it,$),Y[2*nt+dt]>Et&&v(j,Y,it,nt);St<te;){for(v(j,Y,St,te),St++,te--;Y[2*St+dt]<Et;)St++;for(;Y[2*te+dt]>Et;)te--}Y[2*it+dt]===Et?v(j,Y,it,te):(te++,v(j,Y,te,nt)),te<=$&&(it=te+1),$<=te&&(nt=te-1)}}function v(j,Y,$,it){d(j,$,it),d(Y,2*$,2*it),d(Y,2*$+1,2*it+1)}function d(j,Y,$){var it=j[Y];j[Y]=j[$],j[$]=it}function x(j,Y){return j=j.geometry.coordinates,{x:j[0]/360+.5,y:D(j[1]),zoom:Infinity,index:Y,parentId:-1}}function y(j){var Y=j.id,$=M(j);return{type:"Feature",id:Y,properties:$,geometry:{type:"Point",coordinates:[360*(j.x-.5),360*Math.atan(Math.exp((180-360*j.y)*Math.PI/180))/Math.PI-90]}}}function M(j){var Y=j.numPoints,$=1e4<=Y?Math.round(Y/1e3)+"k":1e3<=Y?Math.round(Y/100)/10+"k":Y;return U(U({},j.properties),{cluster:!0,cluster_id:j.id,point_count:Y,point_count_abbreviated:$})}function D(j){return j=Math.sin(j*Math.PI/180),j=.5-.25*Math.log((1+j)/(1-j))/Math.PI,0>j?0:1<j?1:j}function U(j,Y){for(var $ in Y)j[$]=Y[$];return j}function C(j){return j.x}function E(j){return j.y}var B=function(j){return j[0]},O=function(j){return j[1]},H=function(j,Y,$,it,nt){Y===void 0&&(Y=B),$===void 0&&($=O),it===void 0&&(it=64),nt===void 0&&(nt=Float64Array),this.nodeSize=it,this.points=j;var dt=this.ids=new(65536>j.length?Uint16Array:Uint32Array)(j.length);nt=this.coords=new nt(2*j.length);for(var Et=0;Et<j.length;Et++)dt[Et]=Et,nt[2*Et]=Y(j[Et]),nt[2*Et+1]=$(j[Et]);n(dt,nt,it,0,dt.length-1,0)};H.prototype.range=function(j,Y,$,it){for(var nt=this.ids,dt=this.coords,Et=this.nodeSize,St=[0,nt.length-1,0],Xt=[],te,Ie;St.length;){var pe=St.pop(),be=St.pop(),yr=St.pop();if(be-yr<=Et)for(pe=yr;pe<=be;pe++)te=dt[2*pe],Ie=dt[2*pe+1],te>=j&&te<=$&&Ie>=Y&&Ie<=it&&Xt.push(nt[pe]);else{var oe=Math.floor((yr+be)/2);te=dt[2*oe],Ie=dt[2*oe+1],te>=j&&te<=$&&Ie>=Y&&Ie<=it&&Xt.push(nt[oe]);var Be=(pe+1)%2;(pe===0?j<=te:Y<=Ie)&&(St.push(yr),St.push(oe-1),St.push(Be)),(pe===0?$>=te:it>=Ie)&&(St.push(oe+1),St.push(be),St.push(Be))}}return Xt},H.prototype.within=function(j,Y,$){for(var it=this.ids,nt=this.coords,dt=this.nodeSize,Et=[0,it.length-1,0],St=[],Xt=$*$;Et.length;){var te=Et.pop(),Ie=Et.pop(),pe=Et.pop();if(Ie-pe<=dt)for(te=pe;te<=Ie;te++){pe=nt[2*te]-j;var be=nt[2*te+1]-Y;pe*pe+be*be<=Xt&&St.push(it[te])}else{be=Math.floor((pe+Ie)/2);var yr=nt[2*be],oe=nt[2*be+1],Be=yr-j,wr=oe-Y;Be*Be+wr*wr<=Xt&&St.push(it[be]),Be=(te+1)%2,(te===0?j-$<=yr:Y-$<=oe)&&(Et.push(pe),Et.push(be-1),Et.push(Be)),(te===0?j+$>=yr:Y+$>=oe)&&(Et.push(be+1),Et.push(Ie),Et.push(Be))}}return St};var V={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(j){return j}},G=function(j){this.options=U(ca(V),j),this.trees=Array(this.options.maxZoom+1)};return G.prototype.load=function(j){var Y=this.options,$=Y.minZoom,it=Y.maxZoom;Y=Y.nodeSize,this.points=j;for(var nt=[],dt=0;dt<j.length;dt++)j[dt].geometry&&nt.push(x(j[dt],dt));for(this.trees[it+1]=new H(nt,C,E,Y,Float32Array),j=it;j>=$;j--)nt=this._cluster(nt,j),this.trees[j]=new H(nt,C,E,Y,Float32Array);return this},G.prototype.getClusters=function(j,Y){var $=((j[0]+180)%360+360)%360-180,it=Math.max(-90,Math.min(90,j[1])),nt=j[2]===180?180:((j[2]+180)%360+360)%360-180,dt=Math.max(-90,Math.min(90,j[3]));if(360<=j[2]-j[0])$=-180,nt=180;else if($>nt)return $=this.getClusters([$,it,180,dt],Y),it=this.getClusters([-180,it,nt,dt],Y),$.concat(it);Y=this.trees[this._limitZoom(Y)],j=[];var Et=0;for(it=Y.range($/360+.5,D(dt),nt/360+.5,D(it));Et<it.length;Et+=1)nt=Y.points[it[Et]],j.push(nt.numPoints?y(nt):this.points[nt.index]);return j},G.prototype.getChildren=function(j){var Y=this._getOriginId(j),$=this._getOriginZoom(j),it=this.trees[$];if(!it)throw Error("No cluster with the specified id.");var nt=it.points[Y];if(!nt)throw Error("No cluster with the specified id.");Y=[];var dt=0;for($=it.within(nt.x,nt.y,this.options.radius/(this.options.extent*Math.pow(2,$-1)));dt<$.length;dt+=1)nt=it.points[$[dt]],nt.parentId===j&&Y.push(nt.numPoints?y(nt):this.points[nt.index]);if(Y.length===0)throw Error("No cluster with the specified id.");return Y},G.prototype.getLeaves=function(j,Y,$){var it=[];return this._appendLeaves(it,j,Y||10,$||0,0),it},G.prototype.getTile=function(j,Y,$){var it=this.trees[this._limitZoom(j)];j=Math.pow(2,j);var nt=this.options;nt=nt.radius/nt.extent;var dt=($-nt)/j,Et=($+1+nt)/j,St={features:[]};return this._addTileFeatures(it.range((Y-nt)/j,dt,(Y+1+nt)/j,Et),it.points,Y,$,j,St),Y===0&&this._addTileFeatures(it.range(1-nt/j,dt,1,Et),it.points,j,$,j,St),Y===j-1&&this._addTileFeatures(it.range(0,dt,nt/j,Et),it.points,-1,$,j,St),St.features.length?St:null},G.prototype.getClusterExpansionZoom=function(j){for(var Y=this._getOriginZoom(j)-1;Y<=this.options.maxZoom&&(j=this.getChildren(j),Y++,j.length===1);)j=j[0].properties.cluster_id;return Y},G.prototype._appendLeaves=function(j,Y,$,it,nt){var dt=0;for(Y=this.getChildren(Y);dt<Y.length;dt+=1){var Et=Y[dt],St=Et.properties;if(St&&St.cluster?nt=nt+St.point_count<=it?nt+St.point_count:this._appendLeaves(j,St.cluster_id,$,it,nt):nt<it?nt++:j.push(Et),j.length===$)break}return nt},G.prototype._addTileFeatures=function(j,Y,$,it,nt,dt){for(var Et=0;Et<j.length;Et+=1){var St=Y[j[Et]],Xt=St.numPoints,te={type:1,geometry:[[Math.round(this.options.extent*(St.x*nt-$)),Math.round(this.options.extent*(St.y*nt-it))]],tags:Xt?M(St):this.points[St.index].properties},Ie=void 0;Xt?Ie=St.id:this.options.generateId?Ie=St.index:this.points[St.index].id&&(Ie=this.points[St.index].id),Ie!==void 0&&(te.id=Ie),dt.features.push(te)}},G.prototype._limitZoom=function(j){return Math.max(this.options.minZoom,Math.min(+j,this.options.maxZoom+1))},G.prototype._cluster=function(j,Y){var $=[],it=this.options,nt=it.reduce,dt=it.minPoints;it=it.radius/(it.extent*Math.pow(2,Y));for(var Et=0;Et<j.length;Et++){var St=j[Et];if(!(St.zoom<=Y)){St.zoom=Y;for(var Xt=this.trees[Y+1],te=Xt.within(St.x,St.y,it),Ie=St.numPoints||1,pe=Ie,be=0,yr=te;be<yr.length;be+=1){var oe=Xt.points[yr[be]];oe.zoom>Y&&(pe+=oe.numPoints||1)}if(pe>=dt){be=St.x*Ie,yr=St.y*Ie,Ie=nt&&1<Ie?this._map(St,!0):null,oe=(Et<<5)+(Y+1)+this.points.length;for(var Be=0;Be<te.length;Be+=1){var wr=Xt.points[te[Be]];if(!(wr.zoom<=Y)){wr.zoom=Y;var _r=wr.numPoints||1;be+=wr.x*_r,yr+=wr.y*_r,wr.parentId=oe,nt&&(Ie||(Ie=this._map(St,!0)),nt(Ie,this._map(wr)))}}St.parentId=oe,$.push({x:be/pe,y:yr/pe,zoom:Infinity,id:oe,parentId:-1,numPoints:pe,properties:Ie})}else if($.push(St),1<pe)for(St=0,pe=te;St<pe.length;St+=1)te=Xt.points[pe[St]],te.zoom<=Y||(te.zoom=Y,$.push(te))}}return $},G.prototype._getOriginId=function(j){return j-this.points.length>>5},G.prototype._getOriginZoom=function(j){return(j-this.points.length)%32},G.prototype._map=function(j,Y){if(j.numPoints)return Y?U({},j.properties):j.properties;j=this.points[j.index].properties;var $=this.options.map(j);return Y&&$===j?U({},$):$},G})}),_A=function(a){function u(n){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n)),n.shapeLayer=new Di(n.options),n.textLayer=new Uu(n.options.textOptions),n.children=[n.shapeLayer,n.textLayer],n.max=[],n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{size:50,height:0,maxZoom:19,minZoom:5,gradient:{0:"rgb(50, 50, 256)","0.1":"rgb(50, 250, 56)","0.5":"rgb(250, 250, 56)",1:"rgb(250, 50, 56)"},enableCluster:!1,showText:!0,textOptions:{fontSize:13,color:"white"}}}},{key:"onOptionsChanged",value:function(n){this.textLayer.setOptions(n.textOptions)}},{key:"setOptions",value:function(){var n=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},l=this.options.textOptions;n.textOptions&&Ur(l,n.textOptions);var v=n.minZoom,d=n.maxZoom,x=n.size;v=d&&d!==this.options.maxZoom||v&&v!==this.options.minZoom||x&&x!==this.options.size,Ur(this.options,n,{textOptions:l}),v?this.onChanged(this.options,this.data):this.refreshLayer(),this.onOptionsChanged(this.getOptions())}},{key:"onChanged",value:function(n,l){if(l&&l.length){this.zoom=Math.floor(this.map.getZoom());var v=n.maxZoom,d=n.minZoom,x=n.enableCluster;n=n.size,this.zoom>v?this.zoom=v:this.zoom<d&&(this.zoom=d),x&&(this.supercluster=new wv({maxZoom:v,minZoom:d,radius:n/2}),this.supercluster.load(l)),this.refreshLayer()}}},{key:"refreshLayer",value:function(){var n=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this.options,l=1<arguments.length&&arguments[1]!==void 0?arguments[1]:this.data,v=this.map,d=this.zoom;if(n.enableCluster&&this.supercluster&&(l=this.getClusterData(n)),l&&l.length){var x=n.gradient,y=n.showText,M=n.textOptions,D=n.height,U=n.size;U*=Math.pow(2,18-d),l=$a(l,U,function(B){var O=Pi(B,2),H=O[0];return O=O[1],-180<=H&&180>=H&&-90<=O&&90>=O&&(O=v.lnglatToMercator(H,O),H=O[0],O=O[1]),B[0]=H,B[1]=O,B}),this.max[d]=Math.max(this.max[d]||0,l.max);var C=new Wi({max:this.max[d],min:0,maxSize:D*Math.pow(2,18-d),minSize:0,gradient:x});if(x=[],y){var E=M&&M.format;E=typeof E=="function"?E:null,x=l.map(function(B){return{geometry:{coordinates:[B.center.x,B.center.y,C.getSize(B.count)+M.fontSize/2*Math.pow(2,18-d)]},text:E?E(B.count):B.count}})}this.textLayer.setData(x),y=l.map(function(B){for(var O=B.center,H=l.r,V=[],G=0;6>G;G++)V.push(ac({x:O.x,y:O.y},H,G));return{geometry:{type:"Polygon",coordinates:[V]},properties:{height:C.getSize(B.count),color:C.getColor(B.count)}}}),this.shapeLayer.setData(y),n.enablePicked&&n.autoSelect&&this.pick(-1,-1)}}},{key:"getClusterData",value:function(){var n=this.map,l=n.getBounds(),v=this.ne=l.getNorthEast();l=this.sw=l.getSouthWest();var d=v,x=d.lng;d=d.lat;var y=[];return-180<=x&&180>=x&&-90<=d&&90>=d?y=[l.lng,l.lat,v.lng,v.lat]:(v=n.mercatorToLnglat(this.ne.lng,this.ne.lat),l=n.mercatorToLnglat(this.sw.lng,this.sw.lat),y=l.concat(v)),this.supercluster.getClusters(y,this.zoom).map(function(M){var D=0;return M.properties&&M.properties.point_count&&(D=M.properties.point_count),{geometry:M.geometry,count:D}})}},{key:"pick",value:function(n,l){return this.shapeLayer.pick(n,l)}},{key:"shouldUpdate",value:function(){if(!this.data)return!1;var n=this.map,l=Math.floor(n.getZoom()),v=this.options,d=v.maxZoom;if(v=v.minZoom,l>d?l=d:l<v&&(l=v),this.zoom!==l)return this.zoom=l,!0;if(!this.options.enableCluster||(l=n.getBounds(),n=l.ne,l=l.sw,!(n&&l&&this.ne&&this.sw)))return!1;if(this.ne.lng!==n.lng||this.ne.lat!==n.lat||this.sw.lng!==l.lng||this.sw.lat!==l.lat)return!0}},{key:"render",value:function(n){this.shouldUpdate()?this.refreshLayer():ga(u.prototype.__proto__||lr(u.prototype),"render",this).call(this,n)}}]),u}(hu),ls=function(a){function u(n){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n)),n.name="PointLayer",n.bufferData=[],n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{color:[.1,.1,.9,1],blend:"default",shape:"circle",size:5,unit:"px",borderWidth:0,borderColor:[1,1,1,.9],polygonOffset:[0,0],depthTest:!0}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions(),v=[];l.enablePicked&&v.push("PICK"),l.shape&&l.shape==="circle"&&v.push("SHAPE_CIRCLE"),this.program=new ii(this.gl,{vertexShader:`attribute vec3 aPos;attribute vec4 aColor;attribute float aSize;attribute float aBorderWidth;attribute vec4 aBorderColor;uniform mat4 uMatrix;uniform vec4 uSelectedColor;uniform bool uUnitPx;uniform float zoomUnits;uniform float devicePixelRatio;varying vec4 vColor;varying float vSize;varying float vBorderWidth;varying vec4 vBorderColor;void main(void){if(aColor.w>=0.0&&aColor.w<=1.0){vColor=aColor;}else{vColor=vec4(aColor.xyz,1.0);}float size=aSize*devicePixelRatio;float borderWidth=aBorderWidth*devicePixelRatio;gl_Position=uMatrix*vec4(aPos.xyz,1.0);gl_PointSize=uUnitPx ? size : size/zoomUnits;vSize=size;vBorderWidth=borderWidth;vBorderColor=aBorderColor;
#if defined(PICK)
if(mapvIsPicked()){vColor=uSelectedColor;}
#endif
}`,fragmentShader:`varying vec4 vColor;varying float vSize;varying float vBorderWidth;varying vec4 vBorderColor;void main(void){vec4 color=vColor;
#if defined(SHAPE_CIRCLE)
float d=distance(gl_PointCoord,vec2(0.5,0.5));float ratio=1.0-vBorderWidth/vSize*2.0;if(d>0.5){discard;}if(d>ratio*0.5){color=vBorderColor;}float blur=1.0;blur=1.0-smoothstep(0.49,0.5,d);color.a*=blur;
#else
float ratio=vBorderWidth/vSize;if(gl_PointCoord.x<ratio||gl_PointCoord.x>1.0-ratio||gl_PointCoord.y<ratio||gl_PointCoord.y>1.0-ratio){color=vBorderColor;}
#endif
gl_FragColor=color;}`,defines:v},this),this.buffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),l=[{stride:52,name:"aPos",buffer:this.buffer,size:3,type:"FLOAT",offset:0},{stride:52,name:"aColor",buffer:this.buffer,size:4,type:"FLOAT",offset:12},{stride:52,name:"aSize",buffer:this.buffer,size:1,type:"FLOAT",offset:28},{stride:52,name:"aBorderWidth",buffer:this.buffer,size:1,type:"FLOAT",offset:32},{stride:52,name:"aBorderColor",buffer:this.buffer,size:4,type:"FLOAT",offset:36}],l=l.concat(this.getCommonAttributes()),this.vertexArray=new pn({gl:n,program:this.program,attributes:l})}},{key:"onDestroy",value:function(){this.bufferData=[]}},{key:"onChanged",value:function(n,l){if(this.gl){for(var v=[],d=n.color,x=n.size,y=n.borderWidth,M=n.borderColor,D=0;D<l.length;D++){var U=this.normizedPoint(l[D].geometry.coordinates),C=this.getProperty("color",d,l[D]);C=this.normizedColor(C);var E=this.getProperty("size",x,l[D]);E=Number(E);var B=this.getProperty("borderWidth",y,l[D]);B=Number(B);var O=this.getProperty("borderColor",M,l[D]);O=this.normizedColor(O),U=this.addMultipleCoords(U);for(var H=0;H<U.length;H++){var V=U[H];v.push(V[0],V[1],Number(V[2]||0)),v.push(C[0],C[1],C[2],C[3]),v.push(E),v.push(B,O[0],O[1],O[2],O[3])}}this.bufferData=v,this.buffer.updateData(new Float32Array(v)),n.enablePicked&&this.parsePickData(l)}}},{key:"parsePickData",value:function(n){var l=this.getOptions(),v=[];if(l.enablePicked)for(var d=0;d<n.length;d++){var x=this.indexToRgb(d);v.push(x[0]/255,x[1]/255,x[2]/255),l.repeat&&(v.push(x[0]/255,x[1]/255,x[2]/255),v.push(x[0]/255,x[1]/255,x[2]/255))}l.enablePicked&&this.pickBuffer.updateData(new Float32Array(v))}},{key:"render",value:function(n){var l=n.gl,v=n.matrix,d=n.isPickRender;if(!(0>=this.bufferData.length)){var x=this.getOptions(),y=this.program;y.use(l),n=this.getCommonUniforms(n),n=Ur(n,{uMatrix:v,uUnitPx:x.unit==="px",zoomUnits:this.map.getZoomUnits(),devicePixelRatio:window.devicePixelRatio}),y.setUniforms(n),this.setGLState({blend:!d,blendFunc:rs(l,x.blend),blendEquation:l.FUNC_ADD,polygonOffset:x.polygonOffset,depthTest:x.depthTest}),this.vertexArray.bind(),l.drawArrays(l.POINTS,0,this.bufferData.length/13)}}}]),u}(Ui),MA=function(a){function u(n,l){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n,l)),n.name="GroundRippleLayer",n.bufferDataArr=[],n.indexDataArr=[],n.vertexBuffer=[],n.indexBuffer=[],n.position=[],n.opacity=1,n.currentScale=1,n.autoUpdate=!0,n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{color:[.1,.1,.9,1],size:5,segs:32,scale:2,unit:"m",step:.1}}},{key:"initialize",value:function(n){this.gl=n,this.program=new ii(this.gl,{vertexShader:"uniform mat4 u_projectionMatrix;uniform mat4 u_modelViewMatrix;uniform mat4 u_modelMatrix;uniform float u_opacity;attribute vec4 aPos;attribute vec4 aColor;varying vec4 vColor;void main(){vColor=aColor;vColor.a=u_opacity;gl_Position=u_projectionMatrix*u_modelViewMatrix*u_modelMatrix*vec4(aPos.xyz,1.0);}",fragmentShader:"precision highp float;varying vec4 vColor;void main(){if(vColor.a==0.0){discard;}gl_FragColor=vColor;}"})}},{key:"onDestroy",value:function(){this.bufferDataArr=[],this.indexDataArr=[],this.vertexBuffer=[],this.indexBuffer=[]}},{key:"onChanged",value:function(n,l){var v=this.gl;if(v&&(this.currentScale=this.opacity=1,(this.data=l)&&l.length)){var d=n.color,x=n.segs;n=n.size;for(var y=360/x,M=0;M<l.length;M++){var D=[],U=[],C=this.normizedPoint(l[M].geometry.coordinates),E=d;Object.prototype.toString.call(E)==="[object Function]"?E=E(l[M]):(E=l[M].color||d,"properties"in l[M]&&"color"in l[M].properties&&(E=l[M].properties.color)),E=this.normizedColor(E);var B=Object.prototype.toString.call(n)==="[object Function]"?n(l[M]):Number(n),O=C[0],H=C[1];D.push(0,0,-.5),D.push(E[0],E[1],E[2],0);for(var V=1,G=0;V<=x;V++,G+=y)D.push(C[0]-O+Math.cos(Math.PI/180*G)*B,C[1]-H+Math.sin(Math.PI/180*G)*B,-.5),D.push(E[0],E[1],E[2],this.opacity),V===x?U.push(0,0+V,1):U.push(0,0+V,0+V+1);E=v.createBuffer(),v.bindBuffer(v.ARRAY_BUFFER,E),v.bufferData(v.ARRAY_BUFFER,new Float32Array(D),v.STATIC_DRAW),this.vertexBuffer[M]=E,this.bufferDataArr[M]=D,v.bindBuffer(v.ARRAY_BUFFER,null),D=v.createBuffer(),v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,D),v.bufferData(v.ELEMENT_ARRAY_BUFFER,new Uint16Array(U),v.STATIC_DRAW),this.indexBuffer[M]=D,this.indexDataArr[M]=U,v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,null),this.position[M]=[C[0],C[1]]}this.webglLayer&&this.webglLayer.render()}}},{key:"render",value:function(n){var l=n.gl,v=n.projectionMatrix,d=n.viewMatrix;for(n=this.program,l.useProgram(n.program),l.uniformMatrix4fv(n.uniforms.u_projectionMatrix,!1,v),l.uniformMatrix4fv(n.uniforms.u_modelViewMatrix,!1,d),v=this.opacity,this.options.opacity!==void 0&&(v=this.options.opacity),l.uniform1f(n.uniforms.u_opacity,v),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:[l.SRC_ALPHA,l.DST_ALPHA]}),l.enableVertexAttribArray(n.attributes.aPos),l.enableVertexAttribArray(n.attributes.aColor),v=0;v<this.bufferDataArr.length;v++)if(!(0>=this.bufferDataArr[v].length)){d=new Float32Array(this.bufferDataArr[v]).BYTES_PER_ELEMENT,l.bindBuffer(l.ARRAY_BUFFER,this.vertexBuffer[v]),l.vertexAttribPointer(n.attributes.aColor,4,l.FLOAT,!1,7*d,3*d),l.vertexAttribPointer(n.attributes.aPos,3,l.FLOAT,!1,7*d,0),d=this.position[v];var x=rr.create(),y=[this.currentScale,this.currentScale,this.currentScale];this.options.unit==="px"&&this.map&&(y=this.map.getZoomUnits(),y=[this.currentScale*y,this.currentScale*y,this.currentScale]),rr.identity(x),rr.translate(x,x,[d[0],d[1],0]),rr.scale(x,x,y),l.uniformMatrix4fv(n.uniforms.u_modelMatrix,!1,x),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,this.indexBuffer[v]),l.drawElements(l.TRIANGLES,this.indexDataArr[v].length,l.UNSIGNED_SHORT,0),l.bindBuffer(l.ARRAY_BUFFER,null),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,null)}n=this.getOptions(),l=n.scale,n=n.step,this.opacity-=n/10,this.currentScale+=l*n,0>this.opacity&&(this.currentScale=this.opacity=1)}}]),u}(Ui),CA=function(a){function u(n){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n)),n.name="RippleLayer",n.bufferData=[],n.date=new Date,n.autoUpdate=!0,n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{depthTest:!0,polygonOffset:[0,0],color:[.1,.1,.9,1],blend:"normal",size:20,unit:"px",duration:2}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions();this.program=new ii(this.gl,{vertexShader:`attribute vec3 aPos;attribute vec4 aColor;attribute float aSize;uniform mat4 uMatrix;uniform vec4 uSelectedColor;uniform float uTime;uniform float duration;uniform float zoomUnits;varying vec4 vColor;void main(void){if(aColor.w>=0.0&&aColor.w<=1.0){vColor=aColor;}else{vColor=vec4(aColor.xyz,1.0);}float percent=mod(uTime,duration)/duration;vColor.a=1.-percent;gl_Position=uMatrix*vec4(aPos.xyz,1.0);gl_PointSize=aSize/zoomUnits*percent;
#if defined(PICK)
if(mapvIsPicked()){vColor=uSelectedColor;}
#endif
}`,fragmentShader:"varying vec4 vColor;void main(void){vec4 color=vColor;float d=distance(gl_PointCoord,vec2(0.5,0.5));if(d>0.5){discard;}float blur=1.0;blur=1.0-smoothstep(0.49,0.5,d);color.a*=blur;gl_FragColor=color;}",defines:l.enablePicked?["PICK"]:[]},this),this.buffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),l=[{stride:32,name:"aPos",buffer:this.buffer,size:3,type:"FLOAT",offset:0},{stride:32,name:"aColor",buffer:this.buffer,size:4,type:"FLOAT",offset:12},{stride:32,name:"aSize",buffer:this.buffer,size:1,type:"FLOAT",offset:28}],l=l.concat(this.getCommonAttributes()),this.vertexArray=new pn({gl:n,program:this.program,attributes:l})}},{key:"onDestroy",value:function(){this.bufferData=[]}},{key:"onChanged",value:function(n,l){if(this.gl){for(var v=[],d=n.color,x=n.size,y=0;y<l.length;y++){var M=l[y].geometry.coordinates,D=d;Object.prototype.toString.call(D)==="[object Function]"?D=D(l[y]):(D=l[y].color||d,"properties"in l[y]&&"color"in l[y].properties&&(D=l[y].properties.color)),D=this.normizedColor(D),M=this.normizedPoint(M);var U=l[y].size||x;"properties"in l[y]&&"size"in l[y].properties&&(U=l[y].properties.size),U=Object.prototype.toString.call(U)==="[object Function]"?U(l[y]):Number(U),v.push(M[0],M[1],Number(M[2]||0)),v.push(D[0],D[1],D[2],D[3]),v.push(U*window.devicePixelRatio)}this.bufferData=v,this.buffer.updateData(new Float32Array(v)),n.enablePicked&&this.parsePickData(l)}}},{key:"parsePickData",value:function(n){var l=this.getOptions(),v=[];if(l.enablePicked)for(var d=0;d<n.length;d++){var x=this.indexToRgb(d);v.push(x[0]/255,x[1]/255,x[2]/255)}l.enablePicked&&this.pickBuffer.updateData(new Float32Array(v))}},{key:"render",value:function(n){var l=n.gl,v=n.matrix,d=n.isPickRender;if(!(0>=this.bufferData.length)){var x=this.getOptions(),y=this.program;y.use(l),this.vertexArray.bind(),n=this.getCommonUniforms(n);var M=1;x.unit==="m"&&this.map&&(M=this.map.getZoomUnits()),n=Ur(n,{zoomUnits:M,uTime:(new Date-this.date)/1e3,duration:x.duration,uMatrix:v}),y.setUniforms(n),this.setGLState({blend:!d,blendFunc:x.blend==="lighter"?[l.SRC_ALPHA,l.ONE]:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA],blendEquation:l.FUNC_ADD,polygonOffset:x.polygonOffset,depthTest:x.depthTest}),l.drawArrays(l.POINTS,0,this.bufferData.length/8)}}}]),u}(Ui),TA=function(a){function u(n,l){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n,l)),n.name="SparkLayer",n.bufferData=[],n.startTime=Number(n.options.startTime)||0,n.endTime=Number(n.options.endTime),n.time=n.startTime,n.segs=Number(n.options.segs)||10,n.autoUpdate=!0,n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{color:[.9,.1,.1,1],trailLength:3,height:100,step:.1,segs:10,polygonOffset:[0,0]}}},{key:"setTime",value:function(n){this.time=n}},{key:"initialize",value:function(n){this.gl=n,this.program=new ii(this.gl,{vertexShader:"precision mediump float;attribute vec4 aPos;uniform mat4 u_matrix;uniform float currentTime;uniform float trailLength;varying float vTime;void main(){gl_Position=u_matrix*vec4(aPos.xyz,1.0);vTime=1.0-((currentTime-aPos.w)/trailLength);}",fragmentShader:"precision mediump float;uniform vec3 uFragColor;varying float vTime;void main(){if(vTime>1.0||vTime<0.0){discard;}gl_FragColor=vec4(uFragColor,1.0*vTime);}"}),this.buffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.buffer)}},{key:"onDestroy",value:function(){this.bufferData=[]}},{key:"onChanged",value:function(n,l){var v=this.gl;if(v){this.buffer=v.createBuffer(),v.bindBuffer(v.ARRAY_BUFFER,this.buffer);for(var d=[],x=n.height,y=0;y<l.length;y++)for(var M=l[y].geometry.coordinates,D=Object.prototype.toString.call(x)==="[object Function]"?x(l[y]):Number(x),U=0,C=0;C<this.segs;C++){var E=this.normizedPoint(M);d.push(E[0],E[1],U),M[2]===void 0?d.push(C):d.push(Number(M[2])),U+=D/this.segs,d.push(E[0],E[1],U),M[2]===void 0?d.push(C+1):d.push(Number(M[2]))}n.endTime===void 0&&(this.endTime=this.segs),this.bufferData=d,v.bufferData(v.ARRAY_BUFFER,new Float32Array(d),v.STATIC_DRAW),this.webglLayer&&this.webglLayer.render()}}},{key:"render",value:function(n){var l=n.gl,v=n.matrix;n=this.program,l.useProgram(n.program),l.uniformMatrix4fv(n.uniforms.u_matrix,!1,v),l.bindBuffer(l.ARRAY_BUFFER,this.buffer),l.enableVertexAttribArray(n.attributes.aPos),l.vertexAttribPointer(n.attributes.aPos,4,l.FLOAT,!1,0,0),v=this.normizedColor(this.options.color),l.uniform3f(n.uniforms.uFragColor,v[0],v[1],v[2]),l.uniform1f(n.uniforms.currentTime,this.time),l.uniform1f(n.uniforms.trailLength,this.options.trailLength),this.setGLState({blend:!0,blendFunc:[l.SRC_ALPHA,l.ONE],blendEquation:l.FUNC_ADD,polygonOffset:this.options.polygonOffset}),l.drawArrays(l.LINES,0,this.bufferData.length/4),this.time+=Number(this.options.step),this.time>1.5*this.endTime&&(this.time=this.startTime)}}]),u}(Ui),Xr=function(a){function u(n,l){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n,l)),n.name="IconLayer",n.index=[],l=n.canvas=document.createElement("canvas"),n.ctx=l.getContext("2d"),n.iconHash=new Nl,n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{depthWrite:!0,depthTest:!0,depthFunc:"lequal",blend:"default",flat:!1,unit:"px",scale:1,angle:0,opacity:1,offset:[0,0],padding:[0,0],polygonOffset:[0,0]}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions();this.texture=null,this.program=new ii(this.gl,{vertexShader:"precision highp float;attribute vec3 a_pos;attribute float a_corner;attribute float a_rotation;attribute vec2 a_size;attribute vec2 a_offset;attribute vec2 a_texture_coord;uniform mat4 u_matrix;uniform vec2 u_size;uniform float devicePixelRatio;uniform float u_zoom_units;uniform float u_zIndex;uniform float u_scale;uniform bool u_unit_px;uniform bool u_flat;varying vec2 v_texture_coord;/***\u70B9A(x,y)\uFF0C\u7ED5\u539F\u70B9\u987A\u65F6\u9488\u65CB\u8F6C\u89D2\u5EA6a\u65B0\u5750\u6807\u7684\u8BA1\u7B97\u516C\u5F0F*x1=x*cos(a)+y*sin(a)*y1=y*cos(a)-x*sin(a)*/vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;if(corner==1.0){x+=-size.x*cos(a_rotation)+size.y*sin(a_rotation);y+=size.y*cos(a_rotation)+size.x*sin(a_rotation);}else if(corner==2.0){x+=size.x*cos(a_rotation)+size.y*sin(a_rotation);y+=size.y*cos(a_rotation)-size.x*sin(a_rotation);}else if(corner==3.0){x+=size.x*cos(a_rotation)-size.y*sin(a_rotation);y+=-size.y*cos(a_rotation)-size.x*sin(a_rotation);}else{x+=-size.x*cos(a_rotation)-size.y*sin(a_rotation);y+=-size.y*cos(a_rotation)+size.x*sin(a_rotation);}return vec3(x,y,coord.z);}void main(){v_texture_coord=a_texture_coord;if(u_flat){vec2 offset=a_offset;vec2 halfSize=a_size/2.0*u_scale;if(u_unit_px){halfSize*=u_zoom_units;offset*=u_zoom_units;}vec3 current=transformCoord(a_pos,halfSize,a_corner);current.z+=u_zIndex;gl_Position=u_matrix*vec4(current.x+offset[0],current.y-offset[1],current.z,1.0);}else{vec4 position=u_matrix*vec4(a_pos,1.0);vec3 screen=position.xyz/position.w;vec2 halfSize=a_size/MAPV_resolution*devicePixelRatio*u_scale;vec2 offset=a_offset*2./MAPV_resolution*devicePixelRatio;if(!u_unit_px){halfSize/=u_zoom_units;offset/=u_zoom_units;}vec3 current=transformCoord(screen,halfSize,a_corner);current.xy=current.xy-offset;current.z+=u_zIndex;gl_Position=vec4(current,1.0);}}",fragmentShader:`precision highp float;varying vec2 v_texture_coord;uniform sampler2D u_icon;uniform float u_opacity;uniform vec4 uSelectedColor;void main(){vec4 textureColor=texture2D(u_icon,vec2(v_texture_coord.x,1.0-v_texture_coord.y));if(textureColor.a==0.0&&uIsPickRender==false){discard;}textureColor.a*=u_opacity;gl_FragColor=textureColor;
#if defined(PICK)
if(mapvIsPicked()){gl_FragColor=vec4(uSelectedColor.rgb,gl_FragColor.a);}
#endif
}`,defines:l.enablePicked?["PICK"]:[]},this),this.vertexBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new Ke({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),l=[{name:"a_pos",buffer:this.vertexBuffer,size:3,stride:36,type:"FLOAT",offset:0},{name:"a_corner",buffer:this.vertexBuffer,size:1,stride:36,type:"FLOAT",offset:12},{name:"a_size",buffer:this.vertexBuffer,size:2,stride:36,type:"FLOAT",offset:16},{name:"a_offset",buffer:this.vertexBuffer,size:2,stride:36,type:"FLOAT",offset:24},{name:"a_rotation",buffer:this.vertexBuffer,size:1,stride:36,type:"FLOAT",offset:32},{name:"a_texture_coord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}],l=l.concat(this.getCommonAttributes()),this.vertexArray=new pn({gl:n,program:this.program,attributes:l})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(n,l){this.gl&&this.processCache(n,l,2<arguments.length&&arguments[2]!==void 0?arguments[2]:{})}},{key:"processCache",value:function(n,l,v){var d=this;this.cachedData=[];for(var x=n.icon,y=n.width,M=n.height,D=n.offset,U=n.angle,C=0;C<l.length;C++){var E=this.normizedPoint(l[C].geometry.coordinates),B=this.getProperty("icon",x,l[C]),O=this.getProperty("width",y,l[C]),H=this.getProperty("height",M,l[C]),V=this.getProperty("offset",D,l[C]),G=this.getProperty("angle",U,l[C]);E&&B&&(this.cachedData.push({point:E,icon:B,width:O,height:H,offset:V,angle:G,index:C}),this.iconHash.get(B)||this.iconHash.set(B,B))}l=Ba(this.iconHash.entries()).filter(function(j){return typeof j[1]=="string"}).map(function(j){var Y=Pi(j,2)[0];return new Fl(function($,it){d.url2canvas(Y,function(nt){d.iconHash.set(Y,nt),$()})})}),Fl.all(l).then(function(j){d.buildSprite(n),v.autoRender!==!1&&d.webglLayer&&d.webglLayer.render()})}},{key:"buildSprite",value:function(n){var l=n.padding,v=this.canvas,d=this.ctx,x=[],y=new Nl,M=!0,D=!1,U=void 0;try{for(var C=as(this.iconHash),E;!(M=(E=C.next()).done);M=!0){var B=Pi(E.value,2),O=B[1];if(typeof O!="string"){var H=O.width,V=O.height;x.push({w:H+l[0],h:V+l[0],width:H,height:V,key:B[0],icon:O})}}}catch(G){D=!0,U=G}finally{try{!M&&C.return&&C.return()}finally{if(D)throw U}}for(D=mn(x),M=0;M<x.length;M++)U=x[M],y.get(U.key)||y.set(U.key,U);for(M=ye(D.w),D=ye(D.h),v.width=M||1,v.height=D||1,d.save(),v=0;v<x.length;v++)U=x[v],d.drawImage(U.icon,U.x+l[0],U.y+l[1],U.width,U.height);d.restore(),this.loadTexture(),this.buildVertex(n,y,M,D)}},{key:"buildVertex",value:function(n,l,v,d){n=n.enablePicked;for(var x=[],y=[],M=[],D=[],U=0;U<this.cachedData.length;U++){var C=this.cachedData[U],E=C.point,B=C.width,O=C.height,H=C.offset,V=C.angle,G=C.index;if(C=l.get(C.icon)){B=B||C.icon.width,O=O||C.icon.height;var j=Pi(E,3);E=j[0];var Y=j[1];j=j[2];for(var $=0;4>$;$++)x.push(E,Y,j),x.push($),x.push(B,O),x.push.apply(x,ri(H)),x.push(V*Math.PI/180);B=C.x/v,O=(C.x+C.w)/v,H=(C.y+C.h)/d,C=C.y/d,y.push(B,H,B,C,O,C,O,H),C=4*U,M.push(C,C+2,C+1,C,C+3,C+2),n&&(G=this.indexToRgb(G),D.push(G[0]/255,G[1]/255,G[2]/255),D.push(G[0]/255,G[1]/255,G[2]/255),D.push(G[0]/255,G[1]/255,G[2]/255),D.push(G[0]/255,G[1]/255,G[2]/255))}}this.index=M,this.vertexBuffer.updateData(new Float32Array(x)),this.uvBuffer.updateData(new Float32Array(y)),this.indexBuffer.updateData(new Uint32Array(M)),n&&this.pickBuffer.updateData(new Float32Array(D))}},{key:"render",value:function(n){if(this.cachedData&&this.cachedData.length&&this.iconHash&&this.texture){var l=n.gl,v=n.matrix,d=this.getOptions(),x=this.program;x.use(l);var y=n.isPickRender?rs(l,null):rs(l,d.blend),M=l.LEQUAL;d.depthFunc&&(M=l[d.depthFunc.toUpperCase()]),this.setGLState({blend:!0,blendFunc:y,polygonOffset:d.polygonOffset,depthTest:d.depthTest,depthMask:d.depthWrite,depthFunc:M}),x.setUniforms(Ur(this.getCommonUniforms(n),{u_icon:this.texture,u_matrix:v,u_flat:d.flat,u_unit_px:d.unit==="px",u_zoom_units:this.map.getZoomUnits(),u_scale:d.scale,u_opacity:d.opacity,u_zIndex:d.zIndex,devicePixelRatio:1<(window.BMAPGL_FORCE_RATIO||window.devicePixelRatio)?2:1})),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),l.drawElements(l.TRIANGLES,this.index.length,l.UNSIGNED_INT,0))}}},{key:"url2canvas",value:function(n,l){if((typeof n=="undefined"?"undefined":si(n))==="object")l(n);else{var v=new Image;v.crossOrigin="anonymous",v.onload=function(){var d=v.width,x=v.height,y=document.createElement("canvas");y.width=d,y.height=x,y.getContext("2d").drawImage(v,0,0,d,x),l(y)},v.onerror=function(){var d=document.createElement("canvas");d.width=20,d.height=40;var x=d.getContext("2d");x.fillStyle="red",x.beginPath(),x.lineTo(0,0),x.lineTo(20,0),x.lineTo(10,40),x.closePath(),x.fill(),l(d)},v.src=n}}},{key:"loadTexture",value:function(){var n=this;this.canvas?Bn(this.gl,this.canvas,function(l){n.texture=l}):this.texture=null}}]),u}(Ui),SA=function(a){function u(n){Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n));var l=Ur({blend:"default"},n.options);return n.pointLayer=new ls(l),n.options.textOptions=Ur({depthTest:!1,collides:!1},n.options.textOptions),n.textLayer=new Uu(n.options.textOptions),l=Ur({},n.options,n.options.iconOptions),n.iconLayer=new Xr(l),n.children=[n.pointLayer,n.textLayer,n.iconLayer],n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{minSize:25,maxSize:40,clusterRadius:200,minPoints:2,extent:400,showText:!0,maxZoom:19,minZoom:4,gradient:{0:"rgb(50, 50, 256)","0.1":"rgb(50, 250, 56)","0.5":"rgb(250, 250, 56)",1:"rgb(250, 50, 56)"},textOptions:{fontSize:12,color:"white"},iconOptions:{}}}},{key:"onOptionsChanged",value:function(n){this.textLayer.setOptions(n.textOptions)}},{key:"setOptions",value:function(){var n=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},l=this.options.textOptions;n.textOptions&&Ur(l,n.textOptions);var v=n.minZoom,d=n.maxZoom,x=n.clusterRadius;v=d&&d!==this.options.maxZoom||v&&v!==this.options.minZoom||x&&x!==this.options.clusterRadius,Ur(this.options,n,{textOptions:l}),v?this.onChanged(this.options,this.data):this.refreshCluster(),this.onOptionsChanged(this.getOptions())}},{key:"onChanged",value:function(n,l){var v=this;l&&l.length?(l.forEach(function(d){var x=Pi(d.geometry.coordinates,2),y=x[0];x=x[1],-180<=y&&180>=y&&-90<=x&&90>=x||(y=v.map.mercatorToLnglat(y,x),d.geometry.coordinates[0]=y[0],d.geometry.coordinates[1]=y[1])}),this.supercluster=new wv({maxZoom:n.maxZoom,minZoom:n.minZoom,radius:n.clusterRadius,minPoints:n.minPoints,extent:n.extent}),this.supercluster.load(l),this.supercluster.trees.forEach(function(d){var x=0,y=Infinity;d.points.forEach(function(M){x=Math.max(M.numPoints||0,x),y=Math.min(M.numPoints||Infinity,y)}),d.max=x,d.min=y}),this.refreshCluster()):(this.supercluster=null,this.pointLayer.setData([]),this.iconLayer.setData([]),this.textLayer.setData([]))}},{key:"refreshCluster",value:function(){var n=this,l=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this.options;if(this.supercluster){var v=this.getClusterData(l);if(v&&v.length)if(typeof l.beforeRender=="function"&&l.beforeRender(v)===!1)this.pointLayer.setData([]),this.iconLayer.setData([]),this.textLayer.setData([]);else{var d=[],x=[],y=[];v.forEach(function(M){M.properties.cluster?(d.push(M),y.push({geometry:M.geometry,properties:{text:M.properties.text}})):M.properties.icon||n.options.iconOptions.icon?x.push(M):d.push(M)}),this.pointLayer.setData(d),this.iconLayer.setData(x),this.textLayer.setData(l.showText?y:[]),l.enablePicked&&l.autoSelect&&this.pick(-1,-1)}}}},{key:"getClusterData",value:function(){var n=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this.options,l=this.map.getBounds(),v=this.ne=l.getNorthEast();l=this.sw=l.getSouthWest();var d=v,x=d.lng;return d=d.lat,-180<=x&&180>=x&&-90<=d&&90>=d?l=[l.lng,l.lat,v.lng,v.lat]:(v=this.map.mercatorToLnglat(this.ne.lng,this.ne.lat),l=this.map.mercatorToLnglat(this.sw.lng,this.sw.lat),l=l.concat(v)),v=Math.floor(this.map.getZoom()),l=this.supercluster.getClusters(l,v),this.zoom!==v&&0<l.length&&(this.zoom=v,d=this.supercluster.trees,x=d[v]&&d[v].max||this.max,v=d[v]&&d[v].min||this.min,x!==v&&(this.max=x,this.min=v)),this.processData(l,n)}},{key:"processData",value:function(n,l){var v=l.defaultColor,d=l.defaultSize,x=l.gradient,y=l.minSize,M=l.textOptions,D=new Wi({max:this.max,min:~~this.min||1,minSize:y||8,maxSize:l.maxSize||30,gradient:x});v=v||x[0]||"black",d=d||.5*y||5;var U=M&&M.format;return U=typeof U=="function"?U:null,n.map(function(C){var E=d,B=v,O="";return C.properties&&C.properties.point_count&&(O=C.properties.point_count,E=D.getSize(O)||E,B=D.getColor(O),O=U?U(O):O),E=Ur({},C.properties,{text:O,size:E,color:B}),Ur({},C,{properties:E,children:C.id})})}},{key:"pick",value:function(n,l){var v=this.pointLayer.pick(n,l);return 0>v.dataIndex&&(v=this.iconLayer.pick(n,l)),(n=v.dataItem)&&typeof n.children=="number"&&(n.children=this.getClusterPoints(n.children)),v}},{key:"getClusterPoints",value:function(n){var l=this;return n?this.supercluster.getChildren(n).map(function(v){return v.type==="Feature"?l.getClusterPoints(v.id):v}).flat():[]}},{key:"shouldUpdate",value:function(){if(!this.data||!this.supercluster)return!1;if(this.zoom!==Math.floor(this.map.getZoom()))return!0;var n=this.map.getBounds(),l=n.getNorthEast();if(n=n.getSouthWest(),this.ne.lng!==l.lng||this.ne.lat!==l.lat||this.sw.lng!==n.lng||this.sw.lat!==n.lat)return!0}},{key:"render",value:function(n){this.shouldUpdate()?this.refreshCluster():ga(u.prototype.__proto__||lr(u.prototype),"render",this).call(this,n)}}]),u}(hu),IA=function(a){function u(n){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n)),n.options.textOptions=Ur({collides:!1,depthWrite:!0},n.options.textOptions),n.textLayer=new Uu(n.options.textOptions),n.options.iconOptions=Ur({},n.options,n.options.iconOptions),n.iconLayer=new Xr(n.options.iconOptions),n.children=[n.iconLayer,n.textLayer],n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{clusterRadius:200,minPoints:2,showText:!0,maxZoom:19,minZoom:4,extent:400,textOptions:{fontSize:12,color:"white"},iconOptions:{}}}},{key:"setOptions",value:function(){var n=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},l=this.options.textOptions,v=this.options.iconOptions;n.textOptions&&Ur(l,n.textOptions),n.iconOptions&&Ur(v,n.textOptions),v=n.minZoom;var d=n.maxZoom,x=n.clusterRadius;v=d&&d!==this.options.maxZoom||v&&v!==this.options.minZoom||x&&x!==this.options.clusterRadius,Ur(this.options,n,{textOptions:l}),v?this.onChanged(this.options,this.data):this.refreshCluster(),this.onOptionsChanged(this.getOptions())}},{key:"onChanged",value:function(n,l){var v=this;l&&l.length?(l.forEach(function(d){var x=Pi(d.geometry.coordinates,2),y=x[0];x=x[1],-180<=y&&180>=y&&-90<=x&&90>=x||(y=v.map.mercatorToLngLat(y,x),d.geometry.coordinates[0]=y[0],d.geometry.coordinates[1]=y[1])}),this.supercluster=new wv({maxZoom:n.maxZoom,minZoom:n.minZoom,minPoints:n.minPoints,radius:n.clusterRadius,extent:n.extent}),this.supercluster.load(l),this.supercluster.trees.forEach(function(d){var x=0,y=Infinity;d.points.forEach(function(M){x=Math.max(M.numPoints||0,x),y=Math.min(M.numPoints||Infinity,y)}),d.max=x,d.min=y}),this.refreshCluster()):(this.supercluster=null,this.textLayer.setData([]),this.iconLayer.setData([]))}},{key:"refreshCluster",value:function(){var n=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this.options;if(this.supercluster){var l=this.getClusterData(n);if(l&&l.length)if(typeof n.beforeRender=="function"&&n.beforeRender(l)===!1)this.textLayer.setData([]),this.iconLayer.setData([]);else{var v=[],d=[];l.forEach(function(x){x.properties.cluster&&v.push({geometry:x.geometry,properties:{text:x.properties.text}}),d.push(x)}),this.textLayer.setData(n.showText?v:[]),this.iconLayer.setData(d),n.enablePicked&&n.autoSelect&&this.pick(-1,-1)}}}},{key:"getClusterData",value:function(n){var l=this.map.getBounds(),v=this.ne=l.getNorthEast();l=this.sw=l.getSouthWest();var d=v,x=d.lng;return d=d.lat,-180<=x&&180>=x&&-90<=d&&90>=d?l=[l.lng,l.lat,v.lng,v.lat]:(v=this.map.mercatorToLnglat(this.ne.lng,this.ne.lat),l=this.map.mercatorToLnglat(this.sw.lng,this.sw.lat),l=l.concat(v)),v=Math.floor(this.map.getZoom()),l=this.supercluster.getClusters(l,v),this.zoom!==v&&0<l.length&&(this.zoom=v,d=this.supercluster.trees,x=d[v]&&d[v].max||this.max,v=d[v]&&d[v].min||this.min,x!==v&&(this.max=x,this.min=v)),this.processData(l,n)}},{key:"processData",value:function(n,l){var v=this,d=(l=l.textOptions)&&l.format;return d=typeof d=="function"?d:null,n.map(function(x){var y=x.properties||{};if(x.properties&&x.properties.point_count){y=x.properties.point_count;var M=v.getClusterIcon(y);y=d&&d(y),y=Ur({},x.properties,{text:y,icon:M})}return Ur({},x,{properties:y,children:x.id})})}},{key:"getClusterIcon",value:function(n){var l=this.options.iconExtent,v=Un(l).map(function(D){return+D}),d=v.length;if(d!==0){for(var x=1,y=void 0,M=v[0];x<d;){if(y=M,M=v[x],y<=n&&M>n)return l[y];x++}if(n>M)return l[M]}}},{key:"pick",value:function(n,l){return n=this.iconLayer.pick(n,l),(l=n.dataItem)&&typeof l.children=="number"&&(l.children=this.getClusterPoints(l.children)),n}},{key:"getClusterPoints",value:function(n){var l=this;return n?this.supercluster.getChildren(n).map(function(v){return v.type==="Feature"?l.getClusterPoints(v.id):v}).flat():[]}},{key:"shouldUpdate",value:function(){if(!this.data||!this.supercluster)return!1;if(this.zoom!==Math.floor(this.map.getZoom()))return!0;var n=this.map.getBounds(),l=n.getNorthEast();if(n=n.getSouthWest(),this.ne.lng!==l.lng||this.ne.lat!==l.lat||this.sw.lng!==n.lng||this.sw.lat!==n.lat)return!0}},{key:"render",value:function(n){this.shouldUpdate()?this.refreshCluster():ga(u.prototype.__proto__||lr(u.prototype),"render",this).call(this,n)}}]),u}(hu),zl=function(a){function u(n,l){return Ye(this,u),Pr(this,(u.__proto__||lr(u)).call(this,n,l))}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return Ur(ga(u.prototype.__proto__||lr(u.prototype),"getDefaultOptions",this).call(this),{style:"grid",gridSize:500,gradient:{0:"rgb(50, 50, 256)","0.1":"rgb(50, 250, 56)","0.5":"rgb(250, 250, 56)",1:"rgb(250, 50, 56)"}})}},{key:"onChanged",value:function(n,l){this.gl&&(l=this.processData(l,n),ga(u.prototype.__proto__||lr(u.prototype),"onChanged",this).call(this,n,l))}},{key:"generateGrid",value:function(n,l){var v=l.gridSize,d=[],x={};l=n.length;for(var y=this.getPointOffset(),M=0;M<l;M++){var D=this.normizedPoint(n[M].geometry.coordinates),U=D[2];D=~~((D[0]+y[0])/v)+"_"+~~((D[1]+y[1])/v),x[D]===void 0&&(x[D]={count:0,num:0,z:0});var C=~~n[M].count||1;"properties"in n[M]&&"count"in n[M].properties&&(C=~~n[M].properties.count),x[D].count+=C,x[D].num+=1,x[D].z+=U}return Un(x).forEach(function(E){var B=E.split("_");d.push([B[0]*v+v/2,B[1]*v+v/2,x[E].z/x[E].num,x[E].count])}),d}},{key:"processData",value:function(n,l){var v=[];if(l.style==="normal")for(var d=this.getPointOffset(),x=0;x<n.length;x++){var y=this.normizedPoint(n[x].geometry.coordinates),M=y[0]+d[0],D=y[1]+d[1];y=y[2];var U=~~n[x].count||1;"properties"in n[x]&&"count"in n[x].properties&&(U=~~n[x].properties.count),v.push([M,D,y,U])}else v=this.generateGrid(n,l);if(d=n=0,l.max!==void 0&&l.min!==void 0)n=l.max,d=l.min;else{for(v[0]&&(n=v[0][3],d=v[0][3]),x=v.length,M=0;M<x;M++)D=v[M],n=Math.max(D[3],n),d=Math.min(D[3],d);n/=2}for(l=new Wi({max:~~n,min:d,gradient:l.gradient}),n=[],d=0;d<v.length;d++)x=v[d],x[0]=x[0],x[1]=x[1],M=l.getImageData(x[3]),n.push({geometry:{type:"Point",coordinates:[x[0],x[1],x[2]]},color:[M[0]/255,M[1]/255,M[2]/255,M[3]/255]});return n}}]),u}(ls),EA=function(a){function u(n,l){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n,l)),n.bufferData=[],n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{color:[1,.05,.05,1]}}},{key:"onChanged",value:function(n,l){var v=this;if(n=this.gl){this.buffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.buffer);for(var d=[],x=function(M){var D=5*M;for(M=0;M<l.length;M++)l[M].geometry.coordinates.forEach(function(U){for(var C=0;C<U.length-1;C++){var E=v.normizedPoint(U[C]);d.push(E[0]),d.push(E[1]),d.push(Number(D)),E=v.normizedPoint(U[C+1]),d.push(E[0]),d.push(E[1]),d.push(Number(D))}})},y=0;20>y;y++)x(y);n.bufferData(n.ARRAY_BUFFER,new Float32Array(d),n.STATIC_DRAW),this.bufferData=d,n.bindBuffer(n.ARRAY_BUFFER,null)}}},{key:"initialize",value:function(n){this.gl=n,this.program=new ii(n,{vertexShader:"uniform mat4 uMatrix;attribute vec3 aPos;void main(){gl_PointSize=10.0;gl_Position=uMatrix*vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform vec4 uFragColor;void main(){gl_FragColor=uFragColor;}"}),this.buffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.buffer)}},{key:"render",value:function(n){var l=n.gl;n=n.matrix;var v=this.program;l.useProgram(v.program);var d=this.normizedColor(this.options.color);l.uniform4f(v.uniforms.uFragColor,d[0],d[1],d[2],d[3]),l.uniformMatrix4fv(v.uniforms.uMatrix,!1,n),l.bindBuffer(l.ARRAY_BUFFER,this.buffer),l.enableVertexAttribArray(v.attributes.aPos),l.vertexAttribPointer(v.attributes.aPos,3,l.FLOAT,!1,0,0),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:[l.ONE,l.ONE]}),l.drawArrays(l.LINES,0,this.bufferData.length/3)}}]),u}(Ui),Y1={circle:1,square:2},LA=function(a){function u(n,l){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n,l)),n.bufferData=[],n.startTime=n.options.startTime||0,n.endTime=n.options.endTime,n.time=n.startTime,n.autoUpdate=!0,n}return Rr(u,a),qe(u,[{key:"initialize",value:function(n){this.gl=n,this.program=new ii(this.gl,{vertexShader:"attribute vec4 aPos;attribute vec4 aColor;attribute float aSize;uniform mat4 u_matrix;varying vec4 vColor;uniform float currentTime;uniform float trailLength;varying float vTime;void main(void){if(aColor.w>=0.0&&aColor.w<=1.0){vColor=aColor;}else{vColor=vec4(aColor.xyz,1.0);}gl_Position=u_matrix*vec4(aPos.xyz,1.0);gl_PointSize=aSize;vTime=1.0-((currentTime-aPos.w)/trailLength);}",fragmentShader:"precision highp float;varying vec4 vColor;uniform int uShape;varying float vTime;void main(void){if(vTime>1.0||vTime<0.0){discard;}if(uShape==1){float d=distance(gl_PointCoord,vec2(0.5,0.5));if(d<0.5){gl_FragColor=vColor;}else{discard;}}else{gl_FragColor=vec4(vColor.rgb,vColor.a*vTime);}}"}),this.f32BufferData=new Float32Array,this.buffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.buffer)}},{key:"onChanged",value:function(n,l){var v=this.gl;if(v){this.buffer=v.createBuffer(),v.bindBuffer(v.ARRAY_BUFFER,this.buffer);for(var d=[],x=n.color||[.1,.1,.9,1],y=n.size||5,M=0;M<l.length;M++){var D=l[M].geometry.coordinates,U=x;Object.prototype.toString.call(U)==="[object Function]"?U=U(l[M]):(U=l[M].color||x,"properties"in l[M]&&"color"in l[M].properties&&(U=l[M].properties.color)),U=this.normizedColor(U);var C=this.normizedPoint(D),E=y;E=Object.prototype.toString.call(E)==="[object Function]"?E(l[M]):Number(E);var B=l[M].time||M;"properties"in l[M]&&"time"in l[M].properties&&(B=l[M].properties.time),d.push(C[0],C[1],Number(D[2]||0),B),d.push(U[0],U[1],U[2],U[3]),d.push(E*window.devicePixelRatio)}n.endTime===void 0&&(this.endTime=l.length),this.bufferData=d,this.f32BufferData=new Float32Array(d),v.bufferData(v.ARRAY_BUFFER,this.f32BufferData,v.STATIC_DRAW)}}},{key:"render",value:function(n){var l=n.gl,v=n.matrix;0>=this.bufferData.length||(n=this.program,l.useProgram(n.program),l.uniformMatrix4fv(n.uniforms.u_matrix,!1,v),l.bindBuffer(l.ARRAY_BUFFER,this.buffer),v=this.f32BufferData.BYTES_PER_ELEMENT,l.enableVertexAttribArray(n.attributes.aPos),l.vertexAttribPointer(n.attributes.aPos,4,l.FLOAT,!1,9*v,0),l.enableVertexAttribArray(n.attributes.aColor),l.vertexAttribPointer(n.attributes.aColor,4,l.FLOAT,!1,9*v,4*v),l.enableVertexAttribArray(n.attributes.aSize),l.vertexAttribPointer(n.attributes.aSize,1,l.FLOAT,!1,9*v,8*v),l.uniform1f(n.uniforms.currentTime,this.time),l.uniform1f(n.uniforms.trailLength,this.options.trailLength||3),v=1,this.options.shape&&Y1[this.options.shape]&&(v=Y1[this.options.shape]),l.uniform1i(n.uniforms.uShape,v),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:this.options.blend==="lighter"?[l.SRC_ALPHA,l.ONE]:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA]}),l.drawArrays(l.POINTS,0,this.bufferData.length/9),this.time+=this.options.step||.1,this.time>this.endTime&&(this.time=this.startTime))}}]),u}(Ui),kc=function(a){function u(n,l){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n,l)),n.bufferData=[],n.startTime=n.options.startTime||0,n.endTime=n.options.endTime,n.time=n.startTime,n.autoUpdate=!0,n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{color:[1,.05,.05,1],trailLength:3,step:.1,polygonOffset:[0,0]}}},{key:"initialize",value:function(n){this.gl=n,this.program=new ii(this.gl,{vertexShader:"precision highp float;attribute vec4 aPos;attribute vec4 aColor;uniform mat4 u_matrix;uniform float currentTime;uniform float trailLength;varying float vTime;varying vec4 vColor;void main(){gl_Position=u_matrix*vec4(aPos.xyz,1.0);vColor=aColor;vTime=1.0-((currentTime-aPos.w)/trailLength);}",fragmentShader:"precision highp float;uniform vec3 uFragColor;varying vec4 vColor;varying float vTime;void main(){if(vTime>1.0||vTime<0.0){discard;}gl_FragColor=vec4(vColor.rgb,1.0*vTime);}"},this),this.buffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.buffer)}},{key:"setTime",value:function(n){this.time=n}},{key:"onChanged",value:function(n,l){var v=this.gl;if(v){this.buffer=v.createBuffer(),v.bindBuffer(v.ARRAY_BUFFER,this.buffer);for(var d=[],x=0,y=this.options.color,M=0;M<l.length;M++){var D=l[M].geometry.coordinates;l[M].color&&(y=l[M].color),"properties"in l[M]&&"color"in l[M].properties&&(y=l[M].properties.color),Object.prototype.toString.call(y)==="[object Function]"&&(y=y(l[M])),y=this.normizedColor(y),D.length>x&&(x=D.length);for(var U=0;U<D.length-1;U++){var C=this.normizedPoint(D[U]);d.push(C[0]),d.push(C[1]),d.push(C[2]),D[U][3]===void 0?d.push(U):d.push(Number(D[U][3])),d.push(y[0]),d.push(y[1]),d.push(y[2]),d.push(y[3]),C=this.normizedPoint(D[U+1]),d.push(C[0]),d.push(C[1]),d.push(C[2]),D[U+1][3]===void 0?d.push(U+1):d.push(Number(D[U+1][3])),d.push(y[0]),d.push(y[1]),d.push(y[2]),d.push(y[3])}}n.endTime===void 0&&(this.endTime=x),this.bufferData=d,this.f32BufferData=new Float32Array(d),v.bufferData(v.ARRAY_BUFFER,this.f32BufferData,v.STATIC_DRAW)}}},{key:"render",value:function(n){var l=n.gl,v=n.matrix;n=this.getOptions();var d=this.program;d.use(l),l.uniformMatrix4fv(d.uniforms.u_matrix,!1,v),l.bindBuffer(l.ARRAY_BUFFER,this.buffer),v=this.f32BufferData.BYTES_PER_ELEMENT,l.enableVertexAttribArray(d.attributes.aPos),l.vertexAttribPointer(d.attributes.aPos,4,l.FLOAT,!1,8*v,0),l.enableVertexAttribArray(d.attributes.aColor),l.vertexAttribPointer(d.attributes.aColor,4,l.FLOAT,!1,8*v,4*v),v=this.normizedColor(n.color),l.uniform3f(d.uniforms.uFragColor,v[0],v[1],v[2]),l.uniform1f(d.uniforms.currentTime,this.time),l.uniform1f(d.uniforms.trailLength,n.trailLength),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:n.blend==="lighter"?[l.ONE,l.ONE]:[l.SRC_ALPHA,l.ONE],polygonOffset:n.polygonOffset,depthMask:!1}),l.drawArrays(l.LINES,0,this.bufferData.length/8),this.time+=n.step,this.time>this.endTime&&(this.time=this.startTime)}}]),u}(Ui),RA=function(a){function u(n,l){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n,l)),n.name="IconCollidesLayer",n.index=[],l=n.canvas=document.createElement("canvas"),n.ctx=l.getContext("2d"),n.iconHash=new Nl,n.boxHash=new Nl,n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{flat:!1,unit:"px",scale:1,angle:0,offset:[0,0],padding:[0,0]}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions();this.texture=null,this.lastUpdateTime=0,this.program=new ii(this.gl,{vertexShader:"precision highp float;attribute vec3 a_pos;attribute float a_corner;attribute float a_rotation;attribute vec2 a_size;attribute vec2 a_offset;attribute vec2 a_texture_coord;uniform mat4 u_matrix;uniform vec2 u_size;uniform float devicePixelRatio;uniform float u_zoom_units;uniform float u_zIndex;uniform float u_scale;uniform bool u_unit_px;uniform bool u_flat;varying vec2 v_texture_coord;/***\u70B9A(x,y)\uFF0C\u7ED5\u539F\u70B9\u987A\u65F6\u9488\u65CB\u8F6C\u89D2\u5EA6a\u65B0\u5750\u6807\u7684\u8BA1\u7B97\u516C\u5F0F*x1=x*cos(a)+y*sin(a)*y1=y*cos(a)-x*sin(a)*/vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;if(corner==1.0){x+=-size.x*cos(a_rotation)+size.y*sin(a_rotation);y+=size.y*cos(a_rotation)+size.x*sin(a_rotation);}else if(corner==2.0){x+=size.x*cos(a_rotation)+size.y*sin(a_rotation);y+=size.y*cos(a_rotation)-size.x*sin(a_rotation);}else if(corner==3.0){x+=size.x*cos(a_rotation)-size.y*sin(a_rotation);y+=-size.y*cos(a_rotation)-size.x*sin(a_rotation);}else{x+=-size.x*cos(a_rotation)-size.y*sin(a_rotation);y+=-size.y*cos(a_rotation)+size.x*sin(a_rotation);}return vec3(x,y,coord.z);}void main(){v_texture_coord=a_texture_coord;if(u_flat){vec2 offset=a_offset;vec2 halfSize=a_size/2.0*u_scale;if(u_unit_px){halfSize*=u_zoom_units;offset*=u_zoom_units;}vec3 current=transformCoord(a_pos,halfSize,a_corner);current.z+=u_zIndex;gl_Position=u_matrix*vec4(current.x+offset[0],current.y-offset[1],current.z,1.0);}else{vec4 position=u_matrix*vec4(a_pos,1.0);vec3 screen=position.xyz/position.w;vec2 halfSize=a_size/MAPV_resolution*devicePixelRatio*u_scale;vec2 offset=a_offset*2./MAPV_resolution*devicePixelRatio;if(!u_unit_px){halfSize/=u_zoom_units;offset/=u_zoom_units;}vec3 current=transformCoord(screen,halfSize,a_corner);current.xy=current.xy-offset;current.z+=u_zIndex;gl_Position=vec4(current,1.0);}}",fragmentShader:`precision highp float;varying vec2 v_texture_coord;uniform sampler2D u_icon;uniform vec4 uSelectedColor;void main(){vec4 textureColor=texture2D(u_icon,vec2(v_texture_coord.x,1.0-v_texture_coord.y));if(textureColor.a==0.0&&uIsPickRender==false){discard;}gl_FragColor=textureColor;
#if defined(PICK)
if(mapvIsPicked()){gl_FragColor=vec4(uSelectedColor.rgb,gl_FragColor.a);}
#endif
}`,defines:l.enablePicked?["PICK"]:[]},this),this.vertexBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new Ke({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),l=[{name:"a_pos",buffer:this.vertexBuffer,size:3,stride:36,type:"FLOAT",offset:0},{name:"a_corner",buffer:this.vertexBuffer,size:1,stride:36,type:"FLOAT",offset:12},{name:"a_size",buffer:this.vertexBuffer,size:2,stride:36,type:"FLOAT",offset:16},{name:"a_offset",buffer:this.vertexBuffer,size:2,stride:36,type:"FLOAT",offset:24},{name:"a_rotation",buffer:this.vertexBuffer,size:1,stride:36,type:"FLOAT",offset:32},{name:"a_texture_coord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}],l=l.concat(this.getCommonAttributes()),this.vertexArray=new pn({gl:n,program:this.program,attributes:l})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(n,l){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{};this.gl&&(this.cachedData=[],this.boxHash.clear(),this.processCache(n,l,v))}},{key:"processCache",value:function(n,l,v){for(var d=this,x=n.icon,y=n.width,M=n.height,D=n.offset,U=n.angle,C=0;C<l.length;C++){var E=this.normizedPoint(l[C].geometry.coordinates),B=this.getProperty("icon",x,l[C]),O=this.getProperty("width",y,l[C]),H=this.getProperty("height",M,l[C]),V=this.getProperty("offset",D,l[C]),G=this.getProperty("angle",U,l[C]);E&&B&&(this.cachedData.push({point:E,icon:B,width:O,height:H,offset:V,angle:G,dataIndex:C}),this.iconHash.get(B)||this.iconHash.set(B,B))}l=Ba(this.iconHash.entries()).filter(function(j){return typeof j[1]=="string"}).map(function(j){var Y=Pi(j,2)[0];return new Fl(function($,it){d.url2canvas(Y,function(nt){d.iconHash.set(Y,nt),$()})})}),Fl.all(l).then(function(j){d.buildSprite(n),v.autoRender!==!1&&d.webglLayer&&d.webglLayer.render()})}},{key:"buildSprite",value:function(n){n=n.padding;var l=this.canvas,v=this.ctx,d=[],x=!0,y=!1,M=void 0;try{for(var D=as(this.iconHash),U;!(x=(U=D.next()).done);x=!0){var C=Pi(U.value,2),E=C[1];if(typeof E!="string"){var B=E.width,O=E.height;d.push({w:B+n[0],h:O+n[0],width:B,height:O,key:C[0],icon:E})}}}catch(H){y=!0,M=H}finally{try{!x&&D.return&&D.return()}finally{if(y)throw M}}for(D=mn(d),U=0;U<d.length;U++)C=d[U],this.boxHash.get(C.key)||this.boxHash.set(C.key,C);for(U=ye(D.w)||1,D=ye(D.h)||1,l.width=U,l.height=D,v.save(),l=0;l<d.length;l++)D=d[l],v.drawImage(D.icon,D.x+n[0],D.y+n[1],D.width,D.height);v.restore(),this.loadTexture()}},{key:"render",value:function(n){if(this.cachedData&&this.cachedData.length&&this.texture){var l=n.gl,v=n.matrix,d=this.getOptions(),x=this.program;x.use(l),this.throttleUpdate(n),this.setGLState({blend:!0,blendFunc:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA]}),x.setUniforms(Ur(this.getCommonUniforms(n),{u_icon:this.texture,u_matrix:v,u_flat:d.flat,u_unit_px:d.unit==="px",u_zoom_units:this.map.getZoomUnits(),u_scale:d.scale,u_zIndex:d.zIndex,devicePixelRatio:1<(window.BMAPGL_FORCE_RATIO||window.devicePixelRatio)?2:1})),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),l.drawElements(l.TRIANGLES,this.index.length,l.UNSIGNED_INT,0))}}},{key:"throttleUpdate",value:function(n){this.updateIcon(n)}},{key:"updateIcon",value:function(n){if(this.iconHash.size&&this.boxHash.size){var l=this.getOptions(),v=n.gl;n=n.matrix,l=l.enablePicked;var d=[],x=[],y=[],M=[],D=this.canvas.width,U=this.canvas.height,C=v.canvas.width/window.devicePixelRatio;v=v.canvas.height/window.devicePixelRatio;for(var E=new ma,B=0,O=0;O<this.cachedData.length;O++){var H=this.cachedData[O],V=H.point,G=H.width,j=H.height,Y=H.offset,$=H.angle,it=H.dataIndex;if(H=this.boxHash.get(H.icon)){G=G||H.icon.width,j=j||H.icon.height;var nt=Pi(V,3);V=nt[0];var dt=nt[1];nt=nt[2];var Et=sn.clone([V,dt,nt,1]);sn.transformMat4(Et,Et,n),sn.scale(Et,Et,1/Et[3]);var St=(Et[0]+1)/2*C-G/2;Et=(-Et[1]+1)/2*v-j/2;var Xt=St+G,te=Et+j;if(!(0>Xt||0>te||St>C||Et>v||(St={minX:St,maxX:Xt,minY:Et,maxY:te},E.collides(St)))){for(E.insert(St),St=0;4>St;St++)d.push(V,dt,nt),d.push(St),d.push(G,j),d.push.apply(d,ri(Y)),d.push($*Math.PI/180);G=H.x/D,j=(H.x+H.w)/D,Y=(H.y+H.h)/U,H=H.y/U,x.push(G,Y,G,H,j,H,j,Y),H=4*B,y.push(H,H+2,H+1,H,H+3,H+2),l&&(it=this.indexToRgb(it),M.push(it[0]/255,it[1]/255,it[2]/255),M.push(it[0]/255,it[1]/255,it[2]/255),M.push(it[0]/255,it[1]/255,it[2]/255),M.push(it[0]/255,it[1]/255,it[2]/255)),B+=1}}}this.index=y,this.vertexBuffer.updateData(new Float32Array(d)),this.uvBuffer.updateData(new Float32Array(x)),this.indexBuffer.updateData(new Uint32Array(y)),l&&this.pickBuffer.updateData(new Float32Array(M))}}},{key:"url2canvas",value:function(n,l){if((typeof n=="undefined"?"undefined":si(n))==="object")l(n);else{var v=new Image;v.crossOrigin="anonymous",v.onload=function(){var d=v.width,x=v.height,y=document.createElement("canvas");y.width=d,y.height=x,y.getContext("2d").drawImage(v,0,0,d,x),l(y)},v.onerror=function(){var d=document.createElement("canvas");d.width=20,d.height=40;var x=d.getContext("2d");x.fillStyle="red",x.beginPath(),x.lineTo(0,0),x.lineTo(20,0),x.lineTo(10,40),x.closePath(),x.fill(),l(d)},v.src=n}}},{key:"loadTexture",value:function(){var n=this;this.canvas?Bn(this.gl,this.canvas,function(l){n.texture=l}):this.texture=null}}]),u}(Ui),Z1=function(a){function u(n,l){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n,l)),n.name="LineFlowLayer",n.initData(),n.date=new Date,n.autoUpdate=!0,n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{color:"rgba(25, 25, 250, 1)",blend:"normal",width:2,antialias:!1,interval:.1,duration:2,trailLength:.5,minZoom:2,maxZoom:25,polygonOffset:[0,0]}}},{key:"initData",value:function(){this.dataMgr={position:[],prev:[],next:[],direction:[],color:[],index:[],counter:[]}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions();this.program=new ii(this.gl,{vertexShader:`uniform mat4 u_matrix;uniform float thickness;uniform vec4 uSelectedColor;attribute vec3 position;attribute vec3 next;attribute vec3 previous;attribute float direction;attribute vec4 aColor;attribute float aCounter;attribute vec2 uv;varying vec4 vColor;varying vec2 vNormal;varying float vCounter;vec2 project(vec4 coord){vec3 screen=coord.xyz/coord.w;vec2 clip=(screen.xy+1.0)/2.0;return clip*MAPV_resolution;}vec4 unproject(vec2 projected,float z,float w){vec2 clip=projected/MAPV_resolution;vec2 screen=clip*2.0-1.0;return vec4(screen*w,z,w);}void main(){vColor=aColor;vCounter=aCounter;
#if defined(PICK)
if(mapvIsPicked()){vColor=uSelectedColor;}
#endif
vec4 previousProjected=u_matrix*vec4(previous,1.0);vec4 currentProjected=u_matrix*vec4(position,1.0);vec4 nextProjected=u_matrix*vec4(next,1.0);vec2 currentScreen=project(currentProjected);vec2 previousScreen=project(previousProjected);vec2 nextScreen=project(nextProjected);float len=thickness;float orientation=direction;vec2 dir=vec2(0.0);if(currentScreen==previousScreen){dir=normalize(nextScreen-currentScreen);}else if(currentScreen==nextScreen){dir=normalize(currentScreen-previousScreen);}else{vec2 dirA=normalize((currentScreen-previousScreen));vec2 dirB=normalize((nextScreen-currentScreen));vec2 tangent=normalize(dirA+dirB);vec2 perp=vec2(-dirA.y,dirA.x);vec2 miter=vec2(-tangent.y,tangent.x);dir=tangent;float angle=40.0;if(dot(dirA,dirB)>cos(radians(angle))){len=thickness/dot(miter,perp);}}vec2 normal=vec2(-dir.y,dir.x);vNormal=normal*orientation;normal*=len/2.0;vec2 pos=currentScreen+normal*orientation;vec4 finalPos=unproject(pos,currentProjected.z,currentProjected.w);gl_Position=finalPos;}`,fragmentShader:"precision highp float;uniform bool uAntialias;uniform bool uAnimate;uniform float uTime;uniform float duration;uniform float interval;uniform float trailLength;varying vec4 vColor;varying vec2 vNormal;varying float vCounter;void main(){vec4 color=vColor;if(uAntialias){float blur=1.0;blur=1.0-smoothstep(0.98,1.0,length(vNormal));color.a*=blur;}if(uAnimate){float alpha=1.0-fract(mod(1.0-vCounter,interval)*(1.0/interval)+uTime/duration);alpha=(alpha+trailLength-1.0)/trailLength;color.a*=alpha;}gl_FragColor=color;}",defines:l.enablePicked?["PICK"]:[]},this),this.prevBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.currentBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.nextBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.directionBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.colorBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.counterBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new Ke({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),l=[{stride:12,name:"previous",buffer:this.prevBuffer,size:3,type:"FLOAT",offset:0},{stride:12,name:"position",buffer:this.currentBuffer,size:3,type:"FLOAT",offset:0},{stride:12,name:"next",buffer:this.nextBuffer,size:3,type:"FLOAT",offset:0},{stride:4,name:"direction",buffer:this.directionBuffer,size:1,type:"FLOAT",offset:0},{stride:16,name:"aColor",buffer:this.colorBuffer,size:4,type:"FLOAT",offset:0},{stride:4,name:"aCounter",buffer:this.counterBuffer,size:1,type:"FLOAT",offset:0}],l=l.concat(this.getCommonAttributes()),this.vertexArray=new pn({gl:n,program:this.program,attributes:l})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(n,l){var v=this;if(this.gl){this.initData();for(var d=1,x=[],y=0;y<l.length;y++){var M=[],D=l[y].geometry.coordinates;D&&0<D.length&&(M=l[y].geometry.type==="Polygon"?D[0].map(function(O){return v.normizedPoint(O)}):D.map(function(O){return v.normizedPoint(O)})),M=wf(M),D=M.total,x[y]=M.arr,d=Math.max(D,d)}for(y=[],M=n.color,D=0;D<l.length;D++){var U=[],C=l[D].geometry.coordinates;C&&0<C.length&&(U=l[D].geometry.type==="Polygon"?C[0].map(function(O){return v.normizedPoint(O)}):C.map(function(O){return v.normizedPoint(O)})),C=M,Object.prototype.toString.call(C)==="[object Function]"?C=C(l[D]):(C=l[D].color||M,"properties"in l[D]&&"color"in l[D].properties&&(C=l[D].properties.color)),C=this.normizedColor(C);for(var E=this.addMultipleCoords(U),B=0;B<E.length;B++)this.processData(this.dataMgr,E[B],x[D],d,C);if(n.enablePicked)for(C=this.indexToRgb(D),E=0;E<U.length;E++)y.push(C[0]/255,C[1]/255,C[2]/255),y.push(C[0]/255,C[1]/255,C[2]/255),n.repeat&&(y.push(C[0]/255,C[1]/255,C[2]/255),y.push(C[0]/255,C[1]/255,C[2]/255),y.push(C[0]/255,C[1]/255,C[2]/255),y.push(C[0]/255,C[1]/255,C[2]/255))}this.counterBuffer.updateData(new Float32Array(this.dataMgr.counter)),this.currentBuffer.updateData(new Float32Array(this.dataMgr.position)),this.prevBuffer.updateData(new Float32Array(this.dataMgr.prev)),this.nextBuffer.updateData(new Float32Array(this.dataMgr.next)),this.directionBuffer.updateData(new Float32Array(this.dataMgr.direction)),this.colorBuffer.updateData(new Float32Array(this.dataMgr.color)),this.indexBuffer.updateData(new Uint32Array(this.dataMgr.index)),n.enablePicked&&this.pickBuffer.updateData(new Float32Array(y))}}},{key:"processData",value:function(n,l,v,d,x){var y,M,D,U,C,E,B,O=l.length,H=n.position.length/6;v=No(v.map(function($){return $/d}));var V=No(l.map(function($){return-1}),!0),G=No(l),j=No(l.map(nh(-1))),Y=No(l.map(nh(1)));l=No(l.map(function($){return x})),O=nd(O,H),(y=n.counter).push.apply(y,ri(v)),(M=n.position).push.apply(M,ri(is(G))),(D=n.prev).push.apply(D,ri(is(j))),(U=n.next).push.apply(U,ri(is(Y))),(C=n.direction).push.apply(C,ri(V)),(E=n.color).push.apply(E,ri(is(l))),(B=n.index).push.apply(B,ri(O))}},{key:"render",value:function(n){var l=n.gl,v=n.matrix,d=this.dataMgr;if(d&&!(0>=d.index.length)){var x=this.getOptions(),y=this.program;if(y.use(l),this.map){var M=this.map.getZoom();M=!!(M>=x.minZoom&&M<=x.maxZoom&&this.autoUpdate)}else M=!0;y.setUniforms(Ur(this.getCommonUniforms(n),{u_matrix:v,thickness:x.width,uAntialias:x.antialias,uTime:(new Date-this.date)/1e3,uAnimate:M,duration:x.duration,interval:x.interval,trailLength:x.trailLength})),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:x.blend==="lighter"?[l.SRC_ALPHA,l.ONE]:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA],polygonOffset:x.polygonOffset}),this.indexBuffer.bind(),this.vertexArray.bind(),l.drawElements(l.TRIANGLES,d.index.length,l.UNSIGNED_INT,0)}}}]),u}(Ui),Dn=function(a){function u(n,l){return Ye(this,u),Pr(this,(u.__proto__||lr(u)).call(this,n,l))}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions();this.texture=null,this.program=new ii(this.gl,{vertexShader:`precision highp float;attribute vec3 a_pos;attribute vec2 a_texture_coord;uniform sampler2D uTerrain;uniform mat4 u_proj_matrix;uniform mat4 u_mv_matrix;varying vec2 v_texture_coord;void main(){v_texture_coord=a_texture_coord;vec3 pos=a_pos.xyz;
#if defined(TERRAIN)
vec4 terrainColor=texture2D(uTerrain,vec2(v_texture_coord.s,v_texture_coord.t));vec3 rgb=terrainColor.rgb*256.0;pos.z=-10000.0+((rgb.r*256.0*256.0+rgb.g*256.0+rgb.b)*0.1);pos.z=pos.z-60.0;
#endif
vec4 position=u_proj_matrix*u_mv_matrix*vec4(pos,1.0);gl_Position=position;}`,fragmentShader:"precision highp float;varying vec2 v_texture_coord;uniform sampler2D uTile;uniform bool uUseFilter;uniform vec4 uFilterColor;void main(){vec4 textureColor=texture2D(uTile,vec2(v_texture_coord.s,v_texture_coord.t));if(uUseFilter){textureColor=textureColor*uFilterColor;}gl_FragColor=textureColor;}",defines:l.terrain?["TERRAIN"]:""},this),this.vertexBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new Ke({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexArray=new pn({gl:n,program:this.program,attributes:[{name:"a_pos",buffer:this.vertexBuffer,stride:20,size:3,type:"FLOAT",offset:0},{name:"a_texture_coord",buffer:this.vertexBuffer,size:2,stride:20,type:"FLOAT",offset:12}]})}},{key:"onChanged",value:function(n,l){var v=this;this.gl&&(this.loadTextureTime&&clearTimeout(this.loadTextureTime),this.loadTextureTime=setTimeout(function(){v.loadTexture(function(){v.parseData(l),v.dataTime=new Date,v.webglLayer.render()})},0))}},{key:"render",value:function(n){var l=n.gl,v=n.projectionMatrix;n=n.viewMatrix;var d=this.getOptions(),x=this.program,y=x.uniforms;x.use(l),this.texture&&(l.activeTexture(l.TEXTURE0),l.uniform1i(y.uTile,0),l.bindTexture(l.TEXTURE_2D,this.texture),l.activeTexture(l.TEXTURE1),l.uniform1i(y.uTerrain,1),l.bindTexture(l.TEXTURE_2D,this.terrainSampler),this.setGLState({cullFace:!1}),x.setUniforms({u_proj_matrix:v,uUseFilter:!!d.filterColor,uFilterColor:this.normizedColor(d.filterColor||"rgba(0, 0, 100, 1.0)"),u_mv_matrix:n}),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),l.drawElements(l.TRIANGLES,this.index.length,l.UNSIGNED_INT,0)))}},{key:"loadTexture",value:function(n){var l=this,v=this.getOptions();v.tile?v.terrain?Bn(this.gl,v.terrain,function(d,x){l.terrainSampler=d,Bn(l.gl,v.tile,function(y,M){l.texture=y,n&&n(),l.webglLayer.render()})},{TEXTURE_WRAP_S:"MIRRORED_REPEAT",TEXTURE_WRAP_T:"MIRRORED_REPEAT"}):Bn(this.gl,v.tile,function(d,x){l.texture=d,n&&n(),l.webglLayer.render()}):(this.texture=null,n&&n())}},{key:"parseData",value:function(n){var l=this,v=[],d=[];if(n&&n[0]){var x=n[0].geometry.coordinates[0];x=x.map(function(O){return l.normizedPoint(O)}),n=x[0][0];var y=x[0][1],M=x[0][2],D=(x[2][0]-n)/16;x=(x[2][1]-y)/16;for(var U=0;16>=U;U++)for(var C=0;16>=C;C++)if(v.push(n+D*C,y+x*U,M),v.push(C/16,U/16),16>C&&16>U){var E=17*U+C,B=17*(U+1)+C;d.push(E,B+1,E+1),d.push(E,B,B+1)}}this.index=d,this.vertexBuffer.updateData(new Float32Array(v)),this.indexBuffer.updateData(new Uint32Array(d))}}]),u}(Ui),Vo=function(a){function u(n,l){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n,l)),n.name="BoardLayer",n.index=[],l=n.canvas=document.createElement("canvas"),n.ctx=l.getContext("2d"),n.iconHash=new Nl,n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{unit:"px",scale:1,angle:0,offsetZ:0,padding:[0,0],polygonOffset:[0,0],enableColorMix:!1,mixColor:"#fff",mixAmount:.5}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions();this.texture=null,this.vertexBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new Ke({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"});var v=[{name:"a_pos",buffer:this.vertexBuffer,size:3,stride:32,type:"FLOAT",offset:0},{name:"a_corner",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:12},{name:"a_size",buffer:this.vertexBuffer,size:2,stride:32,type:"FLOAT",offset:16},{name:"a_offsetZ",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:24},{name:"a_rotation",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:28},{name:"a_texture_coord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}];v=v.concat(this.getCommonAttributes());var d=[];l.enablePicked&&d.push("PICK"),this.options.enableColorMix&&(this.colorBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),v.push({stride:16,name:"a_color",buffer:this.colorBuffer,size:4,type:"FLOAT",offset:0}),d.push("USE_COLOR_MIX")),this.program=new ii(this.gl,{vertexShader:`precision highp float;attribute vec3 a_pos;attribute float a_corner;attribute float a_rotation;attribute float a_offsetZ;attribute vec2 a_size;attribute vec2 a_texture_coord;
#if defined(USE_COLOR_MIX)
attribute vec4 a_color;
#endif
uniform mat4 u_matrix;uniform vec2 u_size;uniform float u_zoom_units;uniform float u_scale;uniform bool u_unit_px;varying vec2 v_texture_coord;varying vec4 v_color;/***\u4E09\u7EF4\u7A7A\u95F4\u5185\uFF0C\u7ED5Z\u8F74\u65CB\u8F6C\u7684\u77E9\u9635\uFF0C\u53F3\u624B\u5750\u6807\u7CFB\u4E0B*[x'][cos0-sin0  0  0]*[y']=[sin0 cos0   0  0]*[z'][0     0     1  0]*[1][0     0     0  1]*/mat3 rotateZ(float angle){float cos0=cos(angle);float sin0=sin(angle);return mat3(cos0,sin0,0.,-sin0,cos0,0.,0.,0.,1.);}vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;float z=coord.z;mat3 mat=rotateZ(a_rotation);vec3 rotated=vec3(size[0],0.0,size[1]);if(corner==1.0){rotated=mat*vec3(-size[0],0.0,size[1]);}else if(corner==2.0){rotated=mat*vec3(size[0],0.0,size[1]);}else if(corner==3.0){rotated=mat*vec3(size[0],0.0,-size[1]);}else{rotated=mat*vec3(-size[0],0.0,-size[1]);}x+=rotated.x;y+=rotated.y;z+=rotated.z;return vec3(x,y,z);}void main(){
#if defined(USE_COLOR_MIX)
v_color=a_color;
#endif
v_texture_coord=a_texture_coord;vec2 halfSize=a_size/2.0*u_scale;if(u_unit_px){halfSize*=u_zoom_units;}vec3 current=transformCoord(a_pos,halfSize,a_corner);current.z+=a_offsetZ;gl_Position=u_matrix*vec4(current,1.0);}`,fragmentShader:`precision highp float;varying vec2 v_texture_coord;varying vec4 v_color;uniform sampler2D u_icon;uniform vec4 uSelectedColor;
#if defined(USE_COLOR_MIX)
uniform float u_mix_amount;
#endif
void main(){vec4 textureColor=texture2D(u_icon,vec2(v_texture_coord.x,1.0-v_texture_coord.y));if(textureColor.a==0.0&&uIsPickRender==false){discard;}gl_FragColor=textureColor;
#if defined(USE_COLOR_MIX)
gl_FragColor=mix(gl_FragColor,v_color,u_mix_amount);
#endif
#if defined(PICK)
if(mapvIsPicked()){gl_FragColor=vec4(uSelectedColor.rgb,gl_FragColor.a);}
#endif
}`,defines:d},this),this.vertexArray=new pn({gl:n,program:this.program,attributes:v})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(n,l){this.gl&&this.processCache(n,l)}},{key:"forceUpdate",value:function(){this.gl&&this.processCache(this.options,this.data)}},{key:"processCache",value:function(n,l){var v=this;this.cachedData=[];for(var d=n.icon,x=n.width,y=n.height,M=n.offsetZ,D=n.angle,U=n.mixColor,C=0;C<l.length;C++){var E=this.normizedPoint(l[C].geometry.coordinates),B=this.getProperty("icon",d,l[C]),O=this.getProperty("width",x,l[C]),H=this.getProperty("height",y,l[C]),V=this.getProperty("angle",D,l[C]),G=this.getProperty("offsetZ",M,l[C]),j=this.normizedColor(this.getProperty("mixColor",U,l[C]));E&&B&&(this.cachedData.push({point:E,icon:B,width:O,height:H,offsetZ:G,angle:V,mixColor:j,index:C}),this.iconHash.get(B)||this.iconHash.set(B,B))}l=Ba(this.iconHash.entries()).filter(function(Y){return typeof Y[1]=="string"}).map(function(Y){var $=Pi(Y,2)[0];return new Fl(function(it,nt){v.url2canvas($,function(dt){v.iconHash.set($,dt),it()})})}),Fl.all(l).then(function(Y){v.buildSprite(n),v.webglLayer.render()})}},{key:"buildSprite",value:function(n){var l=n.padding,v=this.canvas,d=this.ctx,x=[],y=new Nl,M=!0,D=!1,U=void 0;try{for(var C=as(this.iconHash),E;!(M=(E=C.next()).done);M=!0){var B=Pi(E.value,2),O=B[1];if(typeof O!="string"){var H=O.width,V=O.height;x.push({w:H+l[0],h:V+l[0],width:H,height:V,key:B[0],icon:O})}}}catch(G){D=!0,U=G}finally{try{!M&&C.return&&C.return()}finally{if(D)throw U}}for(D=mn(x),M=0;M<x.length;M++)U=x[M],y.get(U.key)||y.set(U.key,U);for(M=ye(D.w),D=ye(D.h),v.width=M||1,v.height=D||1,d.save(),v=0;v<x.length;v++)U=x[v],d.drawImage(U.icon,U.x+l[0],U.y+l[1],U.width,U.height);d.restore(),this.loadTexture(),this.buildVertex(n,y,M,D)}},{key:"buildVertex",value:function(n,l,v,d){var x=n.enablePicked;n=n.enableColorMix;for(var y=[],M=[],D=[],U=[],C=[],E=0;E<this.cachedData.length;E++){var B=this.cachedData[E],O=B.point,H=B.width,V=B.height,G=B.offsetZ,j=B.angle,Y=B.mixColor,$=B.index;if(B=l.get(B.icon)){H=H||B.icon.width,V=V||B.icon.height;var it=Pi(O,3);O=it[0];var nt=it[1];it=it[2];for(var dt=0;4>dt;dt++)y.push(O,nt,it),y.push(dt),y.push(H,V),y.push(G),y.push(j*Math.PI/180);H=B.x/v,V=(B.x+B.w)/v,G=(B.y+B.h)/d,B=B.y/d,M.push(H,G,H,B,V,B,V,G),B=4*E,D.push(B,B+2,B+1,B,B+3,B+2),x&&($=this.indexToRgb($),U.push($[0]/255,$[1]/255,$[2]/255),U.push($[0]/255,$[1]/255,$[2]/255),U.push($[0]/255,$[1]/255,$[2]/255),U.push($[0]/255,$[1]/255,$[2]/255)),n&&(C.push.apply(C,ri(Y)),C.push.apply(C,ri(Y)),C.push.apply(C,ri(Y)),C.push.apply(C,ri(Y)))}}this.index=D,this.vertexBuffer.updateData(new Float32Array(y)),this.uvBuffer.updateData(new Float32Array(M)),this.indexBuffer.updateData(new Uint32Array(D)),x&&this.pickBuffer.updateData(new Float32Array(U)),n&&this.colorBuffer.updateData(new Float32Array(C))}},{key:"render",value:function(n){if(this.cachedData&&this.cachedData.length&&this.iconHash&&this.texture){var l=n.gl,v=n.matrix,d=this.getOptions(),x=this.program;x.use(l),this.setGLState({blend:!0,blendFunc:rs(l,d.blend),polygonOffset:d.polygonOffset}),n=Ur(this.getCommonUniforms(n),{u_icon:this.texture,u_matrix:v,u_unit_px:d.unit==="px",u_zoom_units:this.map.getZoomUnits(),u_scale:d.scale}),d.enableColorMix&&(n=Ur(n,{u_mix_amount:d.mixAmount})),x.setUniforms(n),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),l.drawElements(l.TRIANGLES,this.index.length,l.UNSIGNED_INT,0))}}},{key:"url2canvas",value:function(n,l){if((typeof n=="undefined"?"undefined":si(n))==="object")l(n);else{var v=new Image;v.crossOrigin="anonymous",v.onload=function(){var d=v.width,x=v.height,y=document.createElement("canvas");y.width=d,y.height=x,y.getContext("2d").drawImage(v,0,0,d,x),l(y)},v.onerror=function(){var d=document.createElement("canvas");d.width=20,d.height=40;var x=d.getContext("2d");x.fillStyle="red",x.beginPath(),x.lineTo(0,0),x.lineTo(20,0),x.lineTo(10,40),x.closePath(),x.fill(),l(d)},v.src=n}}},{key:"loadTexture",value:function(){var n=this;this.canvas?Bn(this.gl,this.canvas,function(l){n.texture=l}):this.texture=null}}]),u}(Ui),mp=function(a){function u(n){Ye(this,u);var l=Pr(this,(u.__proto__||lr(u)).call(this,n));return n=l.getOptions(),l.shapeLayer=new Di({enablePicked:n.enablePicked}),l.lineLayer=new Hu,l.children=[l.shapeLayer,l.lineLayer],l}return Rr(u,a),qe(u,[{key:"pick",value:function(n,l){return this.shapeLayer.pick(n,l)}},{key:"onOptionsChanged",value:function(n){this.shapeLayer.setOptions({onClick:function(l){n.onClick&&n.onClick(l)},selectedIndex:n.selectedIndex,selectedColor:n.selectedColor,height:0,polygonOffset:[2,2],depthTest:n.depthTest,depthWrite:n.depthWrite,depthFunc:n.depthFunc,autoSelect:n.autoSelect,color:n.fillColor,opacity:n.fillOpacity,topColor:n.fillColor,useLight:!1,blend:n.blend}),this.lineLayer.setOptions({depthTest:n.depthTest,depthWrite:n.depthWrite,depthFunc:n.depthFunc,dashArray:n.dashArray,color:n.lineColor,width:n.lineWidth,lineJoin:n.lineJoin,blend:n.blend})}},{key:"onDataChanged",value:function(n){this.shapeLayer.setData(n),this.lineLayer.setData(n,{closePath:!0})}},{key:"getDefaultOptions",value:function(){return{enablePicked:!1,selectedIndex:-1,selectedColor:"#ff0000",autoSelect:!0,dashArray:[0,0],lineColor:"rgba(250, 250, 25, 1)",depthTest:!0,depthWrite:!0,depthFunc:"lequal",lineWidth:2,lineJoin:"miter",fillColor:"rgba(25, 25, 250, 1)",fillOpacity:1,blend:"default"}}}]),u}(hu),Ar=Ar||{},zh=0,Wo=null,PA=Ar.Scene=function(a,u){this.name=u.name!==void 0?u.name:null,this.nodes=Array(u.nodes.length);for(var n=0,l=u.nodes.length;n<l;n++)this.nodes[n]=a.nodes[u.nodes[n]];this.extensions=u.extensions!==void 0?u.extensions:null,this.extras=u.extras!==void 0?u.extras:null,this.boundingBox=null},ka=Ar.BoundingBox=function(a,u,n){a=a||Dr.fromValues(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),u=u||Dr.fromValues(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),n===void 0||n===!0?(this.min=Dr.clone(a),this.max=Dr.clone(u)):(this.min=a,this.max=u),this.transform=rr.create()};ka.prototype.updateBoundingBox=function(a){Dr.min(this.min,this.min,a.min),Dr.max(this.max,this.max,a.max)},ka.prototype.calculateTransform=function(){this.transform[0]=this.max[0]-this.min[0],this.transform[5]=this.max[1]-this.min[1],this.transform[10]=this.max[2]-this.min[2],this.transform[12]=this.min[0],this.transform[13]=this.min[1],this.transform[14]=this.min[2]},ka.getAABBFromOBB=function(){var a=Dr.create(),u=Dr.create(),n=Dr.create(),l=Dr.create(),v=Dr.create();return function(d,x){Dr.set(a,x[0],x[1],x[2]),Dr.set(u,x[4],x[5],x[6]),Dr.set(n,x[8],x[9],x[10]),x=Dr.fromValues(x[12],x[13],x[14]);var y=Dr.clone(x);return Dr.scale(l,a,d.min[0]),Dr.scale(v,a,d.max[0]),Dr.min(a,l,v),Dr.add(x,x,a),Dr.max(a,l,v),Dr.add(y,y,a),Dr.scale(l,u,d.min[1]),Dr.scale(v,u,d.max[1]),Dr.min(u,l,v),Dr.add(x,x,u),Dr.max(u,l,v),Dr.add(y,y,u),Dr.scale(l,n,d.min[2]),Dr.scale(v,n,d.max[2]),Dr.min(n,l,v),Dr.add(x,x,n),Dr.max(n,l,v),Dr.add(y,y,n),d=new ka(x,y,!1),d.calculateTransform(),d}}();var _v=Ar.Accessor=function(a,u){this.bufferView=u,this.componentType=a.componentType,this.byteOffset=a.byteOffset!==void 0?a.byteOffset:0,this.byteStride=u.byteStride,this.normalized=a.normalized!==void 0?a.normalized:!1,this.count=a.count,this.type=a.type,this.size=Uh[this.type],this.min=a.min,this.max=a.max,this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null};_v.prototype.prepareVertexAttrib=function(a,u){u.vertexAttribPointer(a,this.size,this.componentType,this.normalized,this.byteStride,this.byteOffset),u.enableVertexAttribArray(a)};var Ul=Ar.BufferView=function(a,u){this.byteLength=a.byteLength,this.byteOffset=a.byteOffset!==void 0?a.byteOffset:0,this.byteStride=a.byteStride!==void 0?a.byteStride:0,this.target=a.target!==void 0?a.target:null,this.data=u.slice(this.byteOffset,this.byteOffset+this.byteLength),this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null,this.buffer=null};Ul.prototype.createBuffer=function(a){this.buffer=a.createBuffer()},Ul.prototype.bindData=function(a){return this.target?(a.bindBuffer(this.target,this.buffer),a.bufferData(this.target,this.data,a.STATIC_DRAW),a.bindBuffer(this.target,null),!0):!1};var Ga=Ar.Camera=function(a){this.name=a.name!==void 0?a.name:null,this.type=a.type,this.othographic=a.othographic===void 0?null:a.othographic,this.perspective=a.perspective===void 0?null:{yfov:a.perspective.yfov,znear:a.perspective.znear,zfar:a.perspective.zfar!==void 0?a.perspective.zfar:null,aspectRatio:a.perspective.aspectRatio!==void 0?a.perspective.aspectRatio:null},this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null},Gc=Ar.Node=function(a,u){if(this.name=a.name!==void 0?a.name:null,this.nodeID=u,this.camera=a.camera!==void 0?a.camera:null,this.matrix=rr.create(),a.hasOwnProperty("matrix")){for(u=0;16>u;++u)this.matrix[u]=a.matrix[u];this.translation=Dr.create(),rr.getTranslation(this.translation,this.matrix),this.rotation=np.create(),rr.getRotation(this.rotation,this.matrix),this.scale=Dr.create(),rr.getScaling(this.scale,this.matrix)}else this.getTransformMatrixFromTRS(a.translation,a.rotation,a.scale);this.children=a.children||[],this.mesh=a.mesh!==void 0?Wo.glTF.meshes[a.mesh]:null,this.skin=a.skin!==void 0?a.skin:null,a.extensions!==void 0&&a.extensions.gl_avatar!==void 0&&Wo.enableGLAvatar===!0&&(this.skin=new vp(Wo.glTF,Wo.skeletonGltf.skins[Wo.skeletonGltf.json.extensions.gl_avatar.skins[a.extensions.gl_avatar.skin.name]],a.extensions.gl_avatar.skin.inverseBindMatrices)),this.weights=a.weights!==void 0?a.weights:null,this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null,this.aabb=null,this.bvh=new ka};Gc.prototype.traverse=function(a,u){u(this,a),a=0;for(var n=this.children.length;a<n;a++)this.children[a].traverse(this,u)},Gc.prototype.traversePostOrder=function(a,u){for(var n=0,l=this.children.length;n<l;n++)this.children[n].traversePostOrder(this,u);u(this,a)},Gc.prototype.traverseTwoExecFun=function(a,u,n){u(this,a);for(var l=0,v=this.children.length;l<v;l++)this.children[l].traverseTwoExecFun(this,u,n);n(this,a)};var J1=rr.create();Gc.prototype.getTransformMatrixFromTRS=function(a,u,n){this.translation=a!==void 0?Dr.fromValues(a[0],a[1],a[2]):Dr.fromValues(0,0,0),this.rotation=u!==void 0?sn.fromValues(u[0],u[1],u[2],u[3]):sn.fromValues(0,0,0,1),this.scale=n!==void 0?Dr.fromValues(n[0],n[1],n[2]):Dr.fromValues(1,1,1),this.updateMatrixFromTRS()},Gc.prototype.updateMatrixFromTRS=function(){rr.fromRotationTranslation(J1,this.rotation,this.translation),rr.scale(this.matrix,J1,this.scale)};var Hl=Ar.Mesh=function(a,u){this.meshID=u,this.name=a.name!==void 0?a.name:null,this.primitives=[],this.boundingBox=null,u=0;for(var n=a.primitives.length;u<n;++u){var l=a.primitives[u];l=new gg(Wo.glTF,l),this.primitives.push(l),l.boundingBox&&(this.boundingBox||(this.boundingBox=new ka),this.boundingBox.updateBoundingBox(l.boundingBox))}this.boundingBox&&this.boundingBox.calculateTransform(),this.weights=a.weights!==void 0?a.weights:null,this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null},gg=Ar.Primitive=function(a,u){this.attributes=u.attributes,this.indices=u.indices!==void 0?u.indices:null;var n;if(u.extensions!==void 0&&u.extensions.gl_avatar!==void 0&&Wo.enableGLAvatar===!0&&u.extensions.gl_avatar.attributes)for(n in u.extensions.gl_avatar.attributes)this.attributes[n]=u.extensions.gl_avatar.attributes[n];this.indices!==null?(this.indicesComponentType=a.json.accessors[this.indices].componentType,this.indicesLength=a.json.accessors[this.indices].count,this.indicesOffset=a.json.accessors[this.indices].byteOffset||0):(this.drawArraysCount=a.json.accessors[this.attributes.POSITION].count,this.drawArraysOffset=a.json.accessors[this.attributes.POSITION].byteOffset||0);for(n in this.attributes)this.attributes[n]=a.accessors[this.attributes[n]];this.material=u.material!==void 0?a.materials[u.material]:null,this.mode=u.mode!==void 0?u.mode:4,this.targets=u.targets,this.extensions=u.extensions!==void 0?u.extensions:null,this.extras=u.extras!==void 0?u.extras:null,this.boundingBox=this.shader=this.indexBuffer=this.vertexBuffer=this.vertexArray=null,this.attributes.POSITION!==void 0&&(a=this.attributes.POSITION,a.max&&a.type==="VEC3"&&(this.boundingBox=new ka(Dr.fromValues(a.min[0],a.min[1],a.min[2]),Dr.fromValues(a.max[0],a.max[1],a.max[2]),!1),this.boundingBox.calculateTransform()))},Ps=Ar.Texture=function(a){this.name=a.name!==void 0?a.name:null,this.sampler=a.sampler!==void 0?Wo.glTF.samplers[a.sampler]:null,this.source=a.source!==void 0?Wo.glTF.images[a.source]:null,this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null,this.texture=null};Ps.prototype.createTexture=function(a){this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.source),a.generateMipmap(a.TEXTURE_2D),a.bindTexture(a.TEXTURE_2D,null)};var Mv=Ar.Sampler=function(a){this.name=a.name!==void 0?a.name:null,this.magFilter=a.magFilter!==void 0?a.magFilter:null,this.minFilter=a.minFilter!==void 0?a.minFilter:null,this.wrapS=a.wrapS!==void 0?a.wrapS:10497,this.wrapT=a.wrapT!==void 0?a.wrapT:10497,this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null,this.sampler=null};Mv.prototype.createSampler=function(a){this.sampler=a.createSampler(),this.minFilter?a.samplerParameteri(this.sampler,a.TEXTURE_MIN_FILTER,this.minFilter):a.samplerParameteri(this.sampler,a.TEXTURE_MIN_FILTER,a.NEAREST_MIPMAP_LINEAR),this.magFilter?a.samplerParameteri(this.sampler,a.TEXTURE_MAG_FILTER,this.magFilter):a.samplerParameteri(this.sampler,a.TEXTURE_MAG_FILTER,a.LINEAR),a.samplerParameteri(this.sampler,a.TEXTURE_WRAP_S,this.wrapS),a.samplerParameteri(this.sampler,a.TEXTURE_WRAP_T,this.wrapT)};var mg=Ar.TextureInfo=function(a){this.index=a.index,this.texCoord=a.texCoord!==void 0?a.texCoord:0,this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null},q1=Ar.PbrMetallicRoughness=function(a){this.baseColorFactor=a.baseColorFactor!==void 0?a.baseColorFactor:[1,1,1,1],this.baseColorTexture=a.baseColorTexture!==void 0?new mg(a.baseColorTexture):null,this.metallicFactor=a.metallicFactor!==void 0?a.metallicFactor:1,this.roughnessFactor=a.roughnessFactor!==void 0?a.roughnessFactor:1,this.metallicRoughnessTexture=a.metallicRoughnessTexture!==void 0?new mg(a.metallicRoughnessTexture):null,this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null},K1=Ar.NormalTextureInfo=function(a){this.index=a.index,this.texCoord=a.texCoord!==void 0?a.texCoord:0,this.scale=a.scale!==void 0?a.scale:1,this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null},bc=Ar.OcclusionTextureInfo=function(a){this.index=a.index,this.texCoord=a.texCoord!==void 0?a.texCoord:0,this.strength=a.strength!==void 0?a.strength:1,this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null},Gu=Ar.Material=function(a){this.name=a.name!==void 0?a.name:null,this.pbrMetallicRoughness=a.pbrMetallicRoughness!==void 0?new q1(a.pbrMetallicRoughness):new q1({baseColorFactor:[1,1,1,1],metallicFactor:1,metallicRoughnessTexture:1}),this.normalTexture=a.normalTexture!==void 0?new K1(a.normalTexture):null,this.occlusionTexture=a.occlusionTexture!==void 0?new bc(a.occlusionTexture):null,this.emissiveTexture=a.emissiveTexture!==void 0?new mg(a.emissiveTexture):null,this.emissiveFactor=a.emissiveFactor!==void 0?a.emissiveFactor:[0,0,0],this.alphaMode=a.alphaMode!==void 0?a.alphaMode:"OPAQUE",this.alphaCutoff=a.alphaCutoff!==void 0?a.alphaCutoff:.5,this.doubleSided=a.doubleSided||!1,this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null},vg=Ar.Skin=function(a,u,n){this.name=u.name!==void 0?u.name:null,this.skinID=n,this.joints=Array(u.joints.length);var l;for(n=0,l=this.joints.length;n<l;n++)this.joints[n]=a.nodes[u.joints[n]];if(this.skeleton=u.skeleton!==void 0?a.nodes[u.skeleton]:null,this.inverseBindMatrices=u.inverseBindMatrices!==void 0?a.accessors[u.inverseBindMatrices]:null,this.extensions=u.extensions!==void 0?u.extensions:null,this.extras=u.extras!==void 0?u.extras:null,this.uniformBlockID=zh++,this.inverseBindMatrices)for(this.inverseBindMatricesData=gs(this.inverseBindMatrices),this.inverseBindMatrix=[],this.jointMatrixUniformBuffer=null,this.jointMatrixUnidormBufferData=new Float32Array(1040),n=0,l=this.inverseBindMatricesData.length;n<l;n+=16)this.inverseBindMatrix.push(rr.fromValues(this.inverseBindMatricesData[n],this.inverseBindMatricesData[n+1],this.inverseBindMatricesData[n+2],this.inverseBindMatricesData[n+3],this.inverseBindMatricesData[n+4],this.inverseBindMatricesData[n+5],this.inverseBindMatricesData[n+6],this.inverseBindMatricesData[n+7],this.inverseBindMatricesData[n+8],this.inverseBindMatricesData[n+9],this.inverseBindMatricesData[n+10],this.inverseBindMatricesData[n+11],this.inverseBindMatricesData[n+12],this.inverseBindMatricesData[n+13],this.inverseBindMatricesData[n+14],this.inverseBindMatricesData[n+15]))},vp=Ar.SkinLink=function(a,u,n){if(this.isLink=!0,a.skins||(a.skins=[]),a.skins.push(this),this.name=u.name,this.skinID=a.skins.length-1,this.joints=u.joints,this.skeleton=u.skeleton,this.inverseBindMatrices=n!==void 0?a.accessors[n]:null,this.uniformBlockID=zh++,this.inverseBindMatrices)for(this.inverseBindMatricesData=gs(this.inverseBindMatrices),this.inverseBindMatrix=[],this.jointMatrixUniformBuffer=null,this.jointMatrixUnidormBufferData=new Float32Array(1040),a=0,u=this.inverseBindMatricesData.length;a<u;a+=16)this.inverseBindMatrix.push(rr.fromValues(this.inverseBindMatricesData[a],this.inverseBindMatricesData[a+1],this.inverseBindMatricesData[a+2],this.inverseBindMatricesData[a+3],this.inverseBindMatricesData[a+4],this.inverseBindMatricesData[a+5],this.inverseBindMatricesData[a+6],this.inverseBindMatricesData[a+7],this.inverseBindMatricesData[a+8],this.inverseBindMatricesData[a+9],this.inverseBindMatricesData[a+10],this.inverseBindMatricesData[a+11],this.inverseBindMatricesData[a+12],this.inverseBindMatricesData[a+13],this.inverseBindMatricesData[a+14],this.inverseBindMatricesData[a+15]))},DA=Ar.Target=function(a){this.nodeID=a.node!==void 0?a.node:null,this.path=a.path,this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null},OA=Ar.Channel=function(a,u){this.sampler=u.samplers[a.sampler],this.target=new DA(a.target),this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null},Cv=Ar.AnimationSampler=function(a,u){this.input=a.accessors[u.input],this.output=a.accessors[u.output],this.inputTypedArray=gs(this.input),this.outputTypedArray=gs(this.output),this.interpolation=u.interpolation!==void 0?u.interpolation:"LINEAR",this.extensions=u.extensions!==void 0?u.extensions:null,this.extras=u.extras!==void 0?u.extras:null,this.curIdx=0,this.curValue=sn.create(),this.endT=this.inputTypedArray[this.inputTypedArray.length-1],this.inputMax=this.endT-this.inputTypedArray[0]},Tv=sn.create(),Sv=sn.create();Cv.prototype.getValue=function(a){a>this.endT&&(a-=this.inputMax*Math.ceil((a-this.endT)/this.inputMax),this.curIdx=0);for(var u=this.inputTypedArray.length;this.curIdx<=u-2&&a>=this.inputTypedArray[this.curIdx+1];)this.curIdx++;this.curIdx>=u-1&&(a-=this.inputMax,this.curIdx=0),u=Uh[this.output.type];var n=u===4?np.slerp:sn.lerp,l=this.curIdx,v=l*u,d=v+u;for(a=Math.max(0,a-this.inputTypedArray[l])/(this.inputTypedArray[l+1]-this.inputTypedArray[l]),l=0;l<u;l++)Tv[l]=this.outputTypedArray[v+l],Sv[l]=this.outputTypedArray[d+l];switch(this.interpolation){case"LINEAR":n(this.curValue,Tv,Sv,a)}};var FA=Ar.Animation=function(a,u){this.name=u.name!==void 0?u.name:null;var n;this.samplers=[];var l=0;for(n=u.samplers.length;l<n;l++)this.samplers[l]=new Cv(a,u.samplers[l]);for(this.channels=[],l=0,n=u.channels.length;l<n;l++)this.channels[l]=new OA(u.channels[l],this);this.extensions=u.extensions!==void 0?u.extensions:null,this.extras=u.extras!==void 0?u.extras:null},BA=Ar.glTFModel=function(a){this.json=a,this.defaultScene=a.scene!==void 0?a.scene:0,this.version=Number(a.asset.version),a.accessors&&(this.accessors=Array(a.accessors.length)),a.bufferViews&&(this.bufferViews=Array(a.bufferViews.length)),a.scenes&&(this.scenes=Array(a.scenes.length)),a.nodes&&(this.nodes=Array(a.nodes.length)),a.meshes&&(this.meshes=Array(a.meshes.length)),a.materials&&(this.materials=Array(a.materials.length)),a.textures&&(this.textures=Array(a.textures.length)),a.samplers&&(this.samplers=Array(a.samplers.length)),a.images&&(this.images=Array(a.images.length)),a.skins&&(this.skins=Array(a.skins.length)),a.animations&&(this.animations=Array(a.animations.length)),a.cameras&&(this.cameras=Array(a.cameras.length)),this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null},Ds=Ar.glTFLoader=function(a){this._init(),this.glTF=null,this.enableGLAvatar=!1,this.linkSkeletonGltf=null};Ds.prototype._init=function(){this._loadDone=!1,this._bufferLoaded=this._bufferRequested=0,this._buffers=[],this._bufferTasks={},this._finishedPendingTasks=this._pendingTasks=this._imageLoaded=this._imageRequested=this._shaderLoaded=this._shaderRequested=0,this.onload=null,Wo=this},Ds.prototype._checkComplete=function(){this._bufferRequested==this._bufferLoaded&&this._imageRequested==this._imageLoaded&&(this._loadDone=!0),this._loadDone&&this._pendingTasks==this._finishedPendingTasks&&(this._postprocess(),this.onload(this.glTF))},Ds.prototype.loadGLTF_GL_Avatar_Skin=function(a,u,n){this.enableGLAvatar=!0,this.skeletonGltf=u,this.loadGLTF(a,n)},Ds.prototype.loadGLTF=function(a,u){this._init(),this.onload=u||function(l){},this.baseUri=ad(a);var n=this;ud(a,function(l){l=JSON.parse(l),n.glTF=new BA(l);var v,d=function(M){if(n._buffers[v]=M,n._bufferLoaded++,n._bufferTasks[v]){var D,U=0;for(D=n._bufferTasks[v].length;U<D;++U)n._bufferTasks[v][U](M)}n._checkComplete()};if(l.buffers)for(v in l.buffers){n._bufferRequested++;var x=l.buffers[v].uri;x.indexOf("base64")===-1&&(x=n.baseUri+x),Mf(x,d)}d=function(M,D){n._imageLoaded++,n.glTF.images[D]=M,n._checkComplete()};var y;if(l.images)for(y in l.images)n._imageRequested++,Mu(n.baseUri+l.images[y].uri,y,d);n._checkComplete()})},Ds.prototype._postprocess=function(){function a(U,C){var E=M[U.nodeID];C!==null?rr.mul(E,M[C.nodeID],U.matrix):rr.copy(E,U.matrix)}function u(U,C){var E=M[U.nodeID];C=C!==null?C.bvh:D.boundingBox,U.mesh&&(v=U.mesh,v.boundingBox&&(U.aabb=ka.getAABBFromOBB(v.boundingBox,E),U.children.length===0&&(Dr.copy(U.bvh.min,U.aabb.min),Dr.copy(U.bvh.max,U.aabb.max)))),Dr.min(C.min,C.min,U.bvh.min),Dr.max(C.max,C.max,U.bvh.max)}Wo=this;var n,l,v;if(this.glTF.cameras){var d=0;for(n=this.glTF.cameras.length;d<n;d++)this.glTF.cameras[d]=new Ga(this.glTF.json.cameras[d])}if(this.glTF.bufferViews)for(d=0,n=this.glTF.bufferViews.length;d<n;d++)this.glTF.bufferViews[d]=new Ul(this.glTF.json.bufferViews[d],this._buffers[this.glTF.json.bufferViews[d].buffer]);if(this.glTF.accessors)for(d=0,n=this.glTF.accessors.length;d<n;d++)this.glTF.accessors[d]=new _v(this.glTF.json.accessors[d],this.glTF.bufferViews[this.glTF.json.accessors[d].bufferView]);if(this.glTF.materials)for(d=0,n=this.glTF.materials.length;d<n;d++)this.glTF.materials[d]=new Gu(this.glTF.json.materials[d]);if(this.glTF.samplers)for(d=0,n=this.glTF.samplers.length;d<n;d++)this.glTF.samplers[d]=new Mv(this.glTF.json.samplers[d]);if(this.glTF.textures)for(d=0,n=this.glTF.textures.length;d<n;d++)this.glTF.textures[d]=new Ps(this.glTF.json.textures[d]);for(d=0,n=this.glTF.meshes.length;d<n;d++)this.glTF.meshes[d]=new Hl(this.glTF.json.meshes[d],d);for(d=0,n=this.glTF.nodes.length;d<n;d++)this.glTF.nodes[d]=new Gc(this.glTF.json.nodes[d],d);for(d=0,n=this.glTF.nodes.length;d<n;d++){var x=this.glTF.nodes[d],y=0;for(l=x.children.length;y<l;y++)x.children[y]=this.glTF.nodes[x.children[y]]}var M=Array(this.glTF.nodes.length);for(d=0,n=M.length;d<n;d++)M[d]=rr.create();for(d=0,n=this.glTF.scenes.length;d<n;d++){var D=this.glTF.scenes[d]=new PA(this.glTF,this.glTF.json.scenes[d]);for(D.boundingBox=new ka,y=0,l=D.nodes.length;y<l;y++)x=D.nodes[y],x.traverseTwoExecFun(null,a,u);D.boundingBox.calculateTransform()}for(y=0,l=this.glTF.nodes.length;y<l;y++)x=this.glTF.nodes[y],x.bvh!==null&&x.bvh.calculateTransform();if(this.glTF.animations)for(d=0,n=this.glTF.animations.length;d<n;d++)this.glTF.animations[d]=new FA(this.glTF,this.glTF.json.animations[d]);if(this.glTF.json.skins)for(d=0,n=this.glTF.skins.length;d<n;d++)for(this.glTF.skins[d]=new vg(this.glTF,this.glTF.json.skins[d],d),x=this.glTF.skins[d].joints,y=0,l=x.length;y<l;y++)x[y].jointID=y;for(d=0,n=this.glTF.nodes.length;d<n;d++)x=this.glTF.nodes[d],x.skin!==null&&typeof x.skin=="number"&&(x.skin=this.glTF.skins[x.skin])};var Uh={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},yg=function(a){function u(n,l){return Ye(this,u),Pr(this,(u.__proto__||lr(u)).call(this,n,l))}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{scale:1}}},{key:"initialize",value:function(n){var l=this;this.gl=n;var v=this.getOptions();this.gltfObj=ld({gl:n,options:v}),new Ds().loadGLTF(v.url,function(d){l.gltfObj.setupScene(d),l.webglLayer.render()})}},{key:"onChanged",value:function(n,l){}},{key:"render",value:function(n){var l=n.gl;n=n.matrix;var v=this.getData(),d=this.getOptions(),x=d.scale,y=[x,x,x];for(d.unit==="px"&&this.map&&(y=this.map.getZoomUnits(),y=[x*y,x*y,x*y]),x=0;x<v.length;x++){var M=v[x].geometry.coordinates;d=rr.create();var D=rr.create();M=this.normizedPoint(M),rr.identity(d),rr.translate(d,d,[M[0],M[1],M[2]]),rr.rotateX(d,d,Math.PI/2),rr.rotateY(d,d,(v[x].angle||0)*Math.PI/180),rr.scale(d,d,y),rr.mul(D,n,d),this.gltfObj.render({gl:l,matrix:D})}}}]),u}(Ui),ba=ba||{};(function(){function a(n,l,v){return v=n.createShader(v),n.shaderSource(v,l),n.compileShader(v),v}ba.getShaderSource=function(n){return document.getElementById(n).textContent.replace(/^\s+|\s+$/g,"")},ba.createProgram=function(n,l,v){var d=n.createProgram();return l=a(n,l,n.VERTEX_SHADER),v=a(n,v,n.FRAGMENT_SHADER),n.attachShader(d,l),n.deleteShader(l),n.attachShader(d,v),n.deleteShader(v),n.linkProgram(d),n.getProgramInfoLog(d),n.getShaderInfoLog(l),n.getShaderInfoLog(v),d};var u=ba.loadImage=function(n,l){var v=new Image;return v.crossOrigin="Anonymous",v.src=n,v.onload=l,v};ba.loadImages=function(n,l){function v(){0>=--x&&l(d)}for(var d=[],x=n.length,y=0;y<x;++y)d.push(u(n[y],v))}})();var Vc=function(a){function u(n){Ye(this,u);var l=Pr(this,(u.__proto__||lr(u)).call(this,n));return n=l.getOptions(),l.gltfLayer=new yg({url:n.url,scale:n.scale}),l.children=[l.gltfLayer],l.autoUpdate=!0,l.index=[],l.newData=[],l.isStarted=n.autoPlay!==!1,l}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{url:"https://mapv-website.bj.bcebos.com/gl/examples/model/car.gltf",scale:1,step:1,defaultAngle:90}}},{key:"onOptionsChanged",value:function(n){this.gltfLayer.setOptions({})}},{key:"onDataChanged",value:function(n){var l=this;this.index=[],this.newData=[];for(var v=0;v<n.length;v++){this.index.push(0);var d=n[v].geometry.coordinates;n[v].geometry.type==="LineString"?this.newData.push(this._addPath(d)):d.forEach(function(x){l.newData.push(l._addPath(x))})}this.updatePoints()}},{key:"lnglatToMercator",value:function(n,l){return l=l*Math.PI/180,l=31890685e-1*Math.log((1+Math.sin(l))/(1-Math.sin(l))),[parseFloat((n*Math.PI/180*6378137).toFixed(2)),parseFloat(l.toFixed(2))]}},{key:"getDeg",value:function(n,l){-180<n[0]&&180>n[0]&&(n=this.lnglatToMercator(n[0],n[1]),l=this.lnglatToMercator(l[0],l[1]));var v=180*Math.atan((l[1]-n[1])/(l[0]-n[0]))/Math.PI;return l[0]>n[0]&&(v-=180),v}},{key:"getPoint",value:function(n,l,v){return[n[0]+(l[0]-n[0])*v,n[1]+(l[1]-n[1])*v,n[2]&&l[2]?n[2]+(l[2]-n[2])*v:0]}},{key:"updatePoints",value:function(){for(var n=this.getOptions(),l=this.newData,v=[],d=0;d<l.length;d++){for(var x=l[d],y=Math.floor(this.index[d]),M=y+1;x[M]&&x[M][0]===x[y][0]&&x[M][1]===x[y][1];)M++;M>=x.length-1&&(M=--y),M=this.getDeg(x[y],x[M]),v.push({geometry:{type:"Point",coordinates:this.getPoint(x[y],x[y+1],this.index[d]%1)},angle:M-n.defaultAngle})}this.pointData=v,this.gltfLayer.setData(v,{autoRender:!1})}},{key:"getCurrentPoint",value:function(){return this.pointData}},{key:"getDistance",value:function(n,l){var v=n[1]*Math.PI/180,d=l[1]*Math.PI/180;return n=2*Math.asin(Math.sqrt(Math.pow(Math.sin((v-d)/2),2)+Math.cos(v)*Math.cos(d)*Math.pow(Math.sin((n[0]*Math.PI/180-l[0]*Math.PI/180)/2),2))),n=Math.round(6378137e4*n)/1e4}},{key:"_addPath",value:function(n){for(var l=n.length,v=0,d=[],x=[],y=1;y<l;y++){var M=this.getDistance(n[y-1],n[y]);d.push(M),v+=M}for(M=[0],y=1;y<l;y++){var D=(d[y-1]/v).toFixed(2);M[y]=M[y-1]+parseFloat(D,10),x=x.concat(this._getPath(n[y-1],n[y],1e3*D))}return this._pathPercents=M,x}},{key:"_getPath",value:function(n,l,v){if(v===0)return[n];for(var d=[],x=0;x<=v;x++)d.push([(l[0]-n[0])/v*x+n[0],(l[1]-n[1])/v*x+n[1],l[2]&&n[2]?(l[2]-n[2])/v*x+n[2]:0]);return d}},{key:"start",value:function(){this.isStarted=!0}},{key:"stop",value:function(){this.isStarted=!1}},{key:"render",value:function(n){if(ga(u.prototype.__proto__||lr(u.prototype),"render",this).call(this,n),n=this.getOptions(),this.isStarted)for(var l=this.newData,v=0;v<this.index.length;v++)this.index[v]+=n.step,this.index[v]>l[v].length-2&&(this.index[v]=0);this.updatePoints()}}]),u}(hu),Wc=function(a){function u(n,l){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n,l)),n.name="BoardTextLayer",l=n.canvas=document.createElement("canvas"),l=n.ctx=l.getContext("2d"),l.textAlign="start",l.textBaseline="top",n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{depthWrite:!1,depthTest:!0,color:"#fff",fontFamily:"Microsoft Yahei",fontSize:14,collides:!0,unit:"px",angle:0,translateX:0,offset:[0,0],padding:[2,2],margin:[0,0],polygonOffset:[0,0],shadow:{},maxHeightLine:20,lineBreak:`
`}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions();this.texture=null,this.lastUpdateTime=0,this.program=new ii(this.gl,{vertexShader:"precision highp float;uniform mat4 matrix;uniform bool uUnitPx;uniform float zoomUnits;uniform float zIndex;uniform vec2 offset;attribute vec3 position;attribute float corner;attribute float scale;attribute float rotation;attribute vec2 size;attribute vec2 aTextCoord;varying vec2 vTextCoord;/***\u70B9A(x,y)\uFF0C\u7ED5\u539F\u70B9\u987A\u65F6\u9488\u65CB\u8F6C\u89D2\u5EA6a\u65B0\u5750\u6807\u7684\u8BA1\u7B97\u516C\u5F0F*x1=x*cos(a)+y*sin(a)*y1=y*cos(a)-x*sin(a)*/mat3 rotateZ(float angle){float cos0=cos(angle);float sin0=sin(angle);return mat3(cos0,sin0,0.,-sin0,cos0,0.,0.,0.,1.);}vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;float z=coord.z;mat3 mat=rotateZ(rotation);vec3 rotated=vec3(size[0],0.0,size[1]);if(corner==1.0){rotated=mat*vec3(-size[0],0.0,size[1]);}else if(corner==2.0){rotated=mat*vec3(size[0],0.0,size[1]);}else if(corner==3.0){rotated=mat*vec3(size[0],0.0,-size[1]);}else{rotated=mat*vec3(-size[0],0.0,-size[1]);}x+=rotated.x;y+=rotated.y;z+=rotated.z;return vec3(x,y,z);}void main(){vTextCoord=aTextCoord;vec2 pixelOffset=offset;vec2 halfSize=size/2.0*scale;if(uUnitPx){halfSize*=zoomUnits;pixelOffset*=zoomUnits;}vec3 current=transformCoord(position,halfSize,corner);current.z+=zIndex;gl_Position=matrix*vec4(current.x+pixelOffset[0],current.y-pixelOffset[1],current.z,1.0);}",fragmentShader:`precision highp float;uniform sampler2D textureImage;uniform vec4 uSelectedColor;varying vec2 vTextCoord;void main(){vec4 textureColor=texture2D(textureImage,vec2(vTextCoord.x,1.0-vTextCoord.y));if(textureColor.a<=0.1&&uIsPickRender==false){discard;}gl_FragColor=textureColor;
#if defined(PICK)
if(mapvIsPicked()){gl_FragColor=vec4(uSelectedColor.rgb,gl_FragColor.a);}
#endif
}`,defines:l.enablePicked?["PICK"]:[]},this),this.vertexBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new Ke({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),l=[{name:"position",buffer:this.vertexBuffer,size:3,stride:32,type:"FLOAT",offset:0},{name:"corner",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:12},{name:"size",buffer:this.vertexBuffer,size:2,stride:32,type:"FLOAT",offset:16},{name:"scale",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:24},{name:"rotation",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:28},{name:"aTextCoord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}],l=l.concat(this.getCommonAttributes()),this.vertexArray=new pn({gl:n,program:this.program,attributes:l})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(n,l){this.gl&&this.processCache(n,l)}},{key:"processCache",value:function(n,l){this.cachedData=[];for(var v=0;v<l.length;v++){var d=this.normizedPoint(l[v].geometry.coordinates),x=l[v].text;"properties"in l[v]&&"text"in l[v].properties&&(x=l[v].properties.text);var y=this.getProperty("angle",n.angle,l[v]),M=this.getProperty("color",n.color,l[v]),D=this.getProperty("maxHeightLine",n.maxHeightLine,l[v]);d&&x!==void 0&&this.cachedData.push({point:d,text:x,angle:y,color:M,maxHeightLine:D,index:v})}}},{key:"render",value:function(n){if(this.cachedData&&this.cachedData.length&&this.map){var l=n.gl,v=n.matrix,d=this.getOptions(),x=this.program;x.use(l),this.throttleUpdate(n),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:rs(l,d.blend),polygonOffset:d.polygonOffset,depthTest:d.depthTest,depthMask:d.depthWrite});var y=this.map.getZoomUnits();x.setUniforms(Ur(this.getCommonUniforms(n),{matrix:v,textureImage:this.texture,offset:d.offset,zoomUnits:y,zIndex:d.zIndex,uUnitPx:d.unit==="px"})),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),l.drawElements(l.TRIANGLES,this.index.length,l.UNSIGNED_INT,0))}}},{key:"throttleUpdate",value:function(n){this.updateText(n)}},{key:"updateText",value:function(n){var l=n.gl,v=n.matrix,d=this.getOptions();n=d.fontSize;var x=d.fontFamily,y=d.translateX,M=d.padding,D=d.margin,U=d.collides,C=d.enablePicked,E=d.shadow;d=d.lineBreak;var B=l.canvas.width/window.devicePixelRatio,O=l.canvas.height/window.devicePixelRatio,H=this.canvas,V=this.ctx;V.save(),V.scale(window.devicePixelRatio,window.devicePixelRatio),V.textBaseline="top",V.font="normal bold 20px "+x;var G=new ma;l=[];for(var j=0;j<this.cachedData.length;j++){var Y=this.cachedData[j],$=Y.point,it=Y.text,nt=Y.angle,dt=Y.index,Et=Y.color;Y=Y.maxHeightLine;var St=Pi($,3),Xt=sn.clone([St[0],St[1],St[2],1]);sn.transformMat4(Xt,Xt,v),sn.scale(Xt,Xt,1/Xt[3]),St=(Xt[0]+1)/2*B,Xt=(-Xt[1]+1)/2*O;var te=V.measureText(it),Ie=it.split(d),pe=Ie.map(function(oe){return V.measureText(oe).width});pe=Math.max.apply(Math,ri(pe));for(var be=20,yr=0;yr<Ie.length-1;yr++)be+=Y;if(Ie=be,te=Math.min(te.width,pe)+1,te+=2*M[0]+y,Ie+=2*M[1],be=te+D[0],pe=Ie+D[1],St-=be/2,Xt-=pe/2,be=St+be,pe=Xt+pe,!(0>be||0>pe||St>B||Xt>O)){if(U){if(St={minX:St,maxX:be,minY:Xt,maxY:pe},G.collides(St))continue;G.insert(St)}l.push({w:te,h:Ie,point:$,text:it,color:Et,angle:nt,maxHeightLine:Y,dataIndex:dt})}}for(V.restore(),v=[],D=[],U=[],B=[],G=mn(l),O=G.w,G=G.h,0>=O&&(O=1),0>=G&&(G=1),H.width=O*window.devicePixelRatio,H.height=G*window.devicePixelRatio,V.save(),V.scale(window.devicePixelRatio,window.devicePixelRatio),V.textBaseline="top",V.font="normal bold 20px "+x,V.shadowColor=E&&E.color,V.shadowOffsetX=E&&E.offsetX,V.shadowOffsetY=E&&E.offsetY,V.shadowBlur=E&&E.blur,x=0,E=l.length;x<E;++x){for(H=l[x],V.fillStyle=H.color,Sm(V,H.text,H.x+M[0]+y,H.y+M[1],H.maxHeightLine,d),it=Pi(H.point,3),j=it[0],$=it[1],it=it[2],nt=0;4>nt;nt++)v.push(j,$,it),v.push(nt),v.push(H.w,H.h),v.push(n/20,H.angle*Math.PI/180);j=H.x/O,$=(H.x+H.w)/O,it=(H.y+H.h)/G,nt=H.y/G,D.push(j,it,j,nt,$,nt,$,it),j=4*x,U.push(j,j+2,j+1,j,j+3,j+2),C&&(H=this.indexToRgb(H.dataIndex),B.push(H[0]/255,H[1]/255,H[2]/255),B.push(H[0]/255,H[1]/255,H[2]/255),B.push(H[0]/255,H[1]/255,H[2]/255),B.push(H[0]/255,H[1]/255,H[2]/255))}V.restore(),this.loadTexture(),this.index=U,this.vertexBuffer.updateData(new Float32Array(v)),this.uvBuffer.updateData(new Float32Array(D)),this.indexBuffer.updateData(new Uint32Array(U)),C&&this.pickBuffer.updateData(new Float32Array(B))}},{key:"loadTexture",value:function(){var n=this;this.canvas?Bn(this.gl,this.canvas,function(l){n.texture=l},{TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}):this.texture=null}}]),u}(Ui);typeof CanvasRenderingContext2D.prototype.roundRect!="function"&&(CanvasRenderingContext2D.prototype.roundRect=function(a,u,n,l,v){return n<2*v&&(v=n/2),l<2*v&&(v=l/2),this.beginPath(),this.moveTo(a+v,u),this.arcTo(a+n,u,a+n,u+l,v),this.arcTo(a+n,u+l,a,u+l,v),this.arcTo(a,u+l,a,u,v),this.arcTo(a,u,a+n,u,v),this.closePath(),this});var kl=function(a){function u(n){Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n)),n.name="LabelLayer",n.pickedIndex=null;var l=n.canvas=document.createElement("canvas");return n.ctx=l.getContext("2d"),n.arrowHeight=8,n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{depthWrite:!1,depthTest:!0,textColor:"#0f0",borderColor:"#f00",backgroundColor:"#fff",fontFamily:"Microsoft Yahei",fontSize:14,lineHeight:20,textAlign:"left",collides:!1,offset:[0,0],padding:[2,2],polygonOffset:[0,0],borderRadius:5,borderWidth:1,stroke:{color:"#fff",width:0}}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions();this.texture=null,this.lastUpdateTime=0,this.program=new ii(this.gl,{vertexShader:"precision highp float;uniform mat4 matrix;uniform float zoomUnits;uniform float devicePixelRatio;uniform float zIndex;uniform vec2 offset;attribute vec3 position;attribute float corner;attribute vec2 size;attribute vec2 aTextCoord;varying vec2 vTextCoord;/***\u70B9A(x,y)\uFF0C\u7ED5\u539F\u70B9\u987A\u65F6\u9488\u65CB\u8F6C\u89D2\u5EA6a\u65B0\u5750\u6807\u7684\u8BA1\u7B97\u516C\u5F0F*x1=x*cos(a)+y*sin(a)*y1=y*cos(a)-x*sin(a)*/vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;if(corner==1.0){x+=-size.x;y+=size.y;}else if(corner==2.0){x+=size.x;y+=size.y;}else if(corner==3.0){x+=size.x;y+=-size.y;}else{x+=-size.x;y+=-size.y;}return vec3(x,y+size.y,coord.z);}void main(){vTextCoord=aTextCoord;vec2 pixelOffset=offset*zoomUnits;vec4 projection=matrix*vec4(position.x+pixelOffset[0],position.y-pixelOffset[1],position.z+zIndex,1.0);vec3 screen=projection.xyz/projection.w;vec2 halfSize=size/MAPV_resolution*devicePixelRatio;vec3 current=transformCoord(screen,halfSize,corner);gl_Position=vec4(current,1.0);}",fragmentShader:"precision highp float;uniform sampler2D textureImage;varying vec2 vTextCoord;void main(){gl_FragColor=texture2D(textureImage,vec2(vTextCoord.x,1.0-vTextCoord.y));}",defines:l.enablePicked?["PICK"]:[]},this),this.vertexBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new Ke({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),l=[{name:"position",buffer:this.vertexBuffer,size:3,stride:24,type:"FLOAT",offset:0},{name:"corner",buffer:this.vertexBuffer,size:1,stride:24,type:"FLOAT",offset:12},{name:"size",buffer:this.vertexBuffer,size:2,stride:24,type:"FLOAT",offset:16},{name:"aTextCoord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}],l=l.concat(this.getCommonAttributes()),this.vertexArray=new pn({gl:n,program:this.program,attributes:l})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(n,l){this.gl&&this.processCache(n,l)}},{key:"processCache",value:function(n,l){for(this.cachedData=[],this.pickedIndex=null,n=0;n<l.length;n++){var v=l[n],d=this.normizedPoint(v.geometry.coordinates);d&&this.cachedData.push({point:d,item:v,index:n})}}},{key:"setPickedIndex",value:function(n,l){var v=this;l!=="onMousemove"?0<=n&&(this.pickedIndex=n,setTimeout(function(){v.webglLayer.render()})):this.pickedIndex=n}},{key:"render",value:function(n){if(this.cachedData&&this.cachedData.length&&this.map){var l=n.gl,v=n.matrix,d=this.getOptions(),x=this.program;x.use(l),this.updateText(n),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA],polygonOffset:d.polygonOffset,depthTest:d.depthTest,depthMask:d.depthWrite});var y=this.map.getZoomUnits();n=Ur(this.getCommonUniforms(n),{matrix:v,devicePixelRatio:window.devicePixelRatio,textureImage:this.texture,offset:d.offset,zoomUnits:y,zIndex:d.zIndex}),delete n.uSelectedColor,x.setUniforms(n),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),l.drawElements(l.TRIANGLES,this.index.length,l.UNSIGNED_INT,0))}}},{key:"updateText",value:function(n){var l=this,v=n.gl,d=n.matrix,x=this.getOptions().enablePicked;n=this.canvas;var y=this.ctx;v=this.createMapbox(y,v,d),d=mn(v);var M=d.w,D=d.h;0>=M&&(M=1),0>=D&&(D=1),n.width=M*window.devicePixelRatio,n.height=D*window.devicePixelRatio;var U=[],C=[],E=[],B=[];v.forEach(function(O,H){l.drawItem(y,O);var V=Pi(O.point,3),G=V[0],j=V[1];V=V[2];for(var Y=0;4>Y;Y++)U.push(G,j,V),U.push(Y),U.push(O.w,O.h);G=O.x/M,j=(O.x+O.w)/M,V=(O.y+O.h)/D,Y=O.y/D,C.push(G,V,G,Y,j,Y,j,V),H*=4,E.push(H,H+2,H+1,H,H+3,H+2),x&&(O=l.indexToRgb(O.dataIndex),B.push(O[0]/255,O[1]/255,O[2]/255),B.push(O[0]/255,O[1]/255,O[2]/255),B.push(O[0]/255,O[1]/255,O[2]/255),B.push(O[0]/255,O[1]/255,O[2]/255))}),this.loadTexture(),this.index=E,this.vertexBuffer.updateData(new Float32Array(U)),this.uvBuffer.updateData(new Float32Array(C)),this.indexBuffer.updateData(new Uint32Array(E)),x&&this.pickBuffer.updateData(new Float32Array(B))}},{key:"createMapbox",value:function(n,l,v){function d(H){var V=H.point,G=H.item;H=H.index;var j=Pi(V,3);j=sn.clone([j[0],j[1],j[2],1]),sn.transformMat4(j,j,v),sn.scale(j,j,1/j[3]);var Y=(j[0]+1)/2*C,$=(-j[1]+1)/2*E;j=this.computeTextWH(G,n,M,U);var it=Pi(j,2);j=it[0],it=it[1],Y-=j/2,$-=it/2;var nt=Y+j,dt=$+it;if(!(0>nt||0>dt||Y>C||$>E)){if(D){if(Y={minX:Y,maxX:nt,minY:$,maxY:dt},B.collides(Y))return;B.insert(Y)}O.push({w:j,h:it,point:V,item:G,dataIndex:H})}}var x=this,y=this.getOptions(),M=y.padding,D=y.collides,U=y.fontSize,C=l.canvas.width/window.devicePixelRatio,E=l.canvas.height/window.devicePixelRatio,B=new ma,O=[];return this.cachedData[this.pickedIndex]&&d.bind(this)(this.cachedData[this.pickedIndex]),this.cachedData.forEach(function(H){x.pickedIndex!==H.index&&d.bind(x)(H)}),O}},{key:"computeTextWH",value:function(n,l){var v=this.getOptions(),d=v.padding,x=v.fontSize,y=v.fontFamily,M=v.lineHeight;return v=v.borderWidth,l.save(),l.scale(window.devicePixelRatio,window.devicePixelRatio),l.font=x+"px "+y,n=n.properties.text.split(`
`),x=n.reduce(function(D,U){return U=l.measureText(U),D<U.width?U.width:D},0),l.restore(),[x+2*d[1]+2*v,2*d[0]+2*v+M*n.length+this.arrowHeight+v]}},{key:"drawItem",value:function(n,l){var v=this.getOptions(),d=v.padding,x=v.backgroundColor,y=v.textColor,M=v.fontSize,D=v.borderColor,U=v.borderRadius,C=v.fontFamily,E=v.lineHeight,B=v.textAlign,O=v.pickedTextColor,H=v.pickedBorderColor,V=v.pickedBackgroundColor,G=v.shadow,j=v.stroke,Y=v.borderWidth,$=l.x,it=l.y;v=l.w;var nt=l.h,dt=l.item;l=l.dataIndex;var Et="";si(dt.properties)==="object"&&(dt=dt.properties,Et=dt.text||"",G=dt.shadow||G,j=dt.stroke||j,M=dt.fontSize||M,B=dt.textAlign||B,E=dt.lineHeight||E,y=dt.textColor||y,C=dt.fontFamily||C,D=dt.borderColor||D,x=dt.backgroundColor||x),this.pickedIndex===l&&(y=O||y,D=H||D,x=V||x),O=Et.split(`
`),H=nt-this.arrowHeight-Y,n.save(),n.beginPath(),n.scale(window.devicePixelRatio,window.devicePixelRatio),n.textBaseline="top",n.font=M+"px "+C,n.translate($,it),n.fillStyle=x,n.strokeStyle=D,n.lineWidth=Y,C=Y/2,n.roundRect(C,C+.5,v-Y,H,U),n.closePath(),n.fill(),0<Y&&n.stroke(),n.beginPath(),U=this.arrowHeight+Y,$=v/2,it=U/2,n.moveTo($-it,H+C),n.lineTo($+it,H+C),n.lineTo($,H+C+.8*U),n.closePath(),n.fillStyle=0<Y?D:x,n.fill(),n.beginPath(),n.fillStyle=y,G&&(n.shadowColor=G.color,n.shadowOffsetX=G.offsetX,n.shadowOffsetY=G.offsetY,n.shadowBlur=G.blur);var St=B==="center"?$:B==="right"?v-C-d[1]:C+d[1];n.textAlign=B,O.forEach(function(Xt,te){te=Y+d[0]+(te+.5)*E-.5*M,0<j.width&&(n.lineWidth=j.width,n.strokeStyle=j.color,n.strokeText(Xt,St,te)),n.fillText(Xt,St,te)}),n.restore()}},{key:"loadTexture",value:function(){var n=this;this.canvas?Bn(this.gl,this.canvas,function(l){n.texture=l},{TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}):this.texture=null}}]),u}(Ui);Nn.prototype.parseColors=function(a){this.arrFeatureStyles=[[2,a[0]||"rgba(79,210,125,1)",2,2,0,[],0,0],[2,a[0]||"rgba(79,210,125,1)",3,2,0,[],0,0],[2,a[0]||"rgba(79,210,125,1)",3,2,0,[],0,0],[2,a[0]||"rgba(79,210,125,1)",5,2,0,[],0,0],[2,a[0]||"rgba(79,210,125,1)",6,2,0,[],0,0],[2,a[2]||"rgba(255,208,69,1)",2,2,0,[],0,0],[2,a[2]||"rgba(255,208,69,1)",3,2,0,[],0,0],[2,a[2]||"rgba(255,208,69,1)",3,2,0,[],0,0],[2,a[2]||"rgba(255,208,69,1)",5,2,0,[],0,0],[2,a[2]||"rgba(255,208,69,1)",6,2,0,[],0,0],[2,a[1]||"rgba(232,14,14,1)",2,2,0,[],0,0],[2,a[1]||"rgba(232,14,14,1)",3,2,0,[],0,0],[2,a[1]||"rgba(232,14,14,1)",3,2,0,[],0,0],[2,a[1]||"rgba(232,14,14,1)",5,2,0,[],0,0],[2,a[1]||"rgba(232,14,14,1)",6,2,0,[],0,0],[2,a[3]||"rgba(181,0,0,1)",2,2,0,[],0,0],[2,a[3]||"rgba(181,0,0,1)",3,2,0,[],0,0],[2,a[3]||"rgba(181,0,0,1)",3,2,0,[],0,0],[2,a[3]||"rgba(181,0,0,1)",5,2,0,[],0,0],[2,a[3]||"rgba(181,0,0,1)",6,2,0,[],0,0],[2,"rgba(255,255,255,1)",4,0,0,[],0,0],[2,"rgba(255,255,255,1)",5.5,0,0,[],0,0],[2,"rgba(255,255,255,1)",7,0,0,[],0,0],[2,"rgba(255,255,255,1)",8.5,0,0,[],0,0],[2,"rgba(255,255,255,1)",10,0,0,[],0,0]]},Nn.prototype.setColors=function(a){this.parseColors(a)},Nn.prototype.initialize=function(a){this._initialize||(this._initialize=!0)},Nn.prototype.clearCache=function(a){this.cache={}},Nn.prototype.setMap=function(a){a?(this.map=a,this._initialize?this.canvaslayer.show():this.initialize(a)):this.canvaslayer.hide()},Nn.prototype.draw=function(a){a=a||{},a.clearCache&&this.clearCache(),this.canvaslayer.draw()},Nn.prototype.clear=function(){},Nn.prototype.update=function(){var a=this.map,u=this.getDataZoom(),n=Math.pow(2,18-u),l=256*n,v=ti.convertLL2MC(a.getCenter()),d=Math.ceil(v.lng/l),x=Math.ceil(v.lat/l),y=this.tileSize,M=u-Math.round(a.getZoom());for(0<M&&(y/=Math.pow(2,M)),l=[d,x,(v.lng-d*l)/l*y,(v.lat-x*l)/l*y],d=a.getBounds(),v=d.getNorthEast(),d=d.getSouthWest(),a.getSize(),a.getSize(),a=(v.lng-d.lng)/n,n=(v.lat-d.lat)/n,v=l[1]-Math.ceil((n/2-l[3])/y),d=l[0]+Math.ceil((a/2+l[2])/y),x=l[1]+Math.ceil((n/2+l[3])/y),n=[],y=l[0]-Math.ceil((a/2-l[2])/y);y<d;y++)for(l=v;l<x;l++)n.push([y,l,u]);for(this.tilesOrder=n,this._loadCount={},y=0;y<n.length;y++)l=n[y][0],a=n[y][1],this._loadCount[l+"_"+a+"_"+n[y][2]]=!1;for(y=0;y<n.length;y++)l=n[y][0],a=n[y][1],this.showTile(l,a,u)},Nn.prototype.showTile=function(a,u,n){this._parseDataAndDraw(a,u,n)},Nn.prototype.drawCurrentData=function(){this.clear();for(var a=[],u=0;u<this.tilesOrder.length;u++){var n=this.tilesOrder[u][0],l=this.tilesOrder[u][1],v=this.tilesOrder[u][2],d=this.cache[this.getCacheKey(n,l,v)];if(d)for(n=this._drawFeatures(d,n,l,v),l=0;l<n.length;l++)a.push(n[l])}this.lineLayer.setData(a)},Nn.prototype.isAllLoaded=function(){var a=!0,u;for(u in this._loadCount)if(!this._loadCount[u]){a=!1;break}return a},Nn.prototype.getCacheKey=function(a,u,n){return a+"_"+u+"_"+n},Nn.prototype.getDataZoom=function(){var a=Math.round(this.map.getZoom());return 19<a&&(a=19),a},Nn.prototype._parseDataAndDraw=function(a,u,n){var l=this,v=l.map,d=v.getCenter(),x=Math.round(v.getZoom()),y=this.getCacheKey(a,u,n),M="_cbk"+(1e5*Math.random()).toFixed(0),D=this.getTileUrl(a,u,n,"BMapGL."+M);BMapGL[M]=function(U){l._loadCount[a+"_"+u+"_"+n]=!0;var C=v.getCenter(),E=Math.round(v.getZoom());C.equals(d)&&E===x?(C=U.content&&U.content.tf,U.data&&(C=U.data),l.cache[y]=C?{traffic:C,precision:U.precision}:null,l.drawTogether&&l.isAllLoaded()&&l.drawCurrentData()):E!==x&&l.clear(),delete BMapGL[M]},l.cache[y]!==void 0?(l._loadCount[a+"_"+u+"_"+n]=!0,l.drawTogether&&l.isAllLoaded()&&l.drawCurrentData()):this.request(D)},Nn.prototype.getTileUrl=function(a,u,n,l){return"https://sp3.baidu.com/7_AZsjOpB1gCo2Kml5_Y_DAcsMJiwa/traffic/?qt=vtraffic&x="+a+"&y="+u+"&z="+n+"&fn="+l+"&t="+new Date().getTime()},Nn.prototype._drawFeatures=function(a,u,n,l){var v=10;l=Math.pow(2,18-l),this.map.getCenter();var d=this.tileSize;if(u=[u*d*l,(n+1)*d*l],n=[],a&&a.traffic){v*=a.precision,a=a.traffic,d=0;for(var x=a.length;d<x;d++){var y=a[d],M=y[1];y=this.arrFeatureStyles[y[3]];var D=M[0]/v,U=-M[1]/v,C=[];C.push([u[0]+D*l,u[1]+U*l,1]);for(var E=2,B=M.length;E<B;E+=2)D+=M[E]/v,U-=M[E+1]/v,C.push([u[0]+D*l,u[1]+U*l,1]);n.push({color:y[1],geometry:{type:"LineString",coordinates:C}})}}return n},Nn.prototype.request=function(a,u){if(u){var n=(1e5*Math.random()).toFixed(0);BMapGL._rd["_cbk"+n]=function(v){u&&u(v),delete BMapGL._rd["_cbk"+n]},a+="&callback=BMapGL._rd._cbk"+n}var l=document.createElement("script");l.type="text/javascript",l.charset="utf-8",l.src=a,l.addEventListener?l.addEventListener("load",function(v){v=v.target,v.parentNode.removeChild(v)},!1):l.attachEvent&&l.attachEvent("onreadystatechange",function(v){v=window.event.srcElement,!v||v.readyState!=="loaded"&&v.readyState!=="complete"||v.parentNode.removeChild(v)}),setTimeout(function(){document.getElementsByTagName("head")[0].appendChild(l),l=null},1)},Nn.prototype.getRGBA=function(a){return a>>>=0,"rgba("+(a>>24&255)+","+(a>>16&255)+","+(a>>8&255)+","+(a&255)/256+")"},Nn.prototype.getLineCap=function(a){return["butt","square","round"][a]},Nn.prototype.getLineJoin=function(a){return["miter","bevel","round"][a]};var Gl=function(a){function u(n){Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n)),n.autoUpdate=!0,n.getOptions();var l=new Z1({color:"rgba(257, 254, 47, 0.9)",minZoom:18,duration:.8,interval:.2,trailLength:.4});return n.lineLayer=l,n.children=[l],n}return Rr(u,a),qe(u,[{key:"initialize",value:function(n){ga(u.prototype.__proto__||lr(u.prototype),"initialize",this).call(this,n),n=this.map.map;var l=new Nn({});l.lineLayer=this.lineLayer,this.trafficTileManager=l,l.setMap(n),l.update(),n.addEventListener("moveend",function(){l.update()}),n.addEventListener("zoomend",function(){l.update()}),n.addEventListener("ondraw",function(){})}},{key:"onOptionsChanged",value:function(n){}},{key:"onDataChanged",value:function(n){}},{key:"getDefaultOptions",value:function(){return{}}}]),u}(hu),Hh=function(a){function u(n,l){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n,l)),n.name="HeatmapLayer",n.bufferData=[],n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{size:13,unit:"px",height:0,max:100,min:0,opacity:1,minOpacity:0,maxOpacity:1,blend:"normal"}}},{key:"initialize",value:function(n){var l=this;this.gl=n;var v=this.getOptions();this.inverseMatrix=rr.create(Float64Array),this.frameBuffer=new ao(n),this.webglLayer.map.onResize(function(){l.frameBuffer=new ao(n)}),this.circle=oh(64),this.circleTexture=We(n,this.circle,{TEXTURE_MAG_FILTER:"LINEAR",TEXTURE_MIN_FILTER:"LINEAR",TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}).texture,this.intensity=new Wi({gradient:v.gradient}),this.paletteTexture=We(n,this.intensity.paletteCtx.canvas,{TEXTURE_MAG_FILTER:"LINEAR",TEXTURE_MIN_FILTER:"LINEAR",TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}).texture,this.offlineProgram=new ii(this.gl,{vertexShader:"uniform mat4 u_matrix;uniform mat4 pointToPixelMatrix;uniform mat4 pixelToViewMatrix;uniform mat4 projectionMatrix;uniform int unit;uniform float size;uniform float max;uniform float min;attribute vec3 aPos;attribute vec2 aOffset;attribute float aCount;varying vec2 vOffset;varying float vCount;varying vec3 vPosition;void main(){vOffset=aOffset;vCount=(aCount-min)/(max-min);if(unit==1){vec2 pos=(pointToPixelMatrix*vec4(aPos.xy,0.0,1.0)).xy+aOffset.xy*size/2.0;gl_Position=projectionMatrix*pixelToViewMatrix*vec4(pos,0.0,1.0);}else{vec2 pos=aPos.xy+aOffset.xy*size;gl_Position=u_matrix*vec4(pos,0.0,1.0);}vPosition=vec3(gl_Position.z/gl_Position.w);}",fragmentShader:"varying vec2 vOffset;varying float vCount;varying vec3 vPosition;uniform sampler2D uCircle;void main(){vec4 circle=texture2D(uCircle,(vOffset+1.0)/2.0);float intensity=circle.a*vCount;if(intensity<=0.0){discard;}gl_FragColor=vec4(vPosition,intensity);}"},this),this.offlineBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.offlineIndexBuffer=new Ke({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.offlineVertexArray=new pn({gl:n,program:this.offlineProgram,attributes:[{stride:24,name:"aPos",buffer:this.offlineBuffer,size:3,type:"FLOAT",offset:0},{stride:24,name:"aOffset",buffer:this.offlineBuffer,size:2,type:"FLOAT",offset:12},{stride:24,name:"aCount",buffer:this.offlineBuffer,size:1,type:"FLOAT",offset:20}]}),this.indexBuffer=new Ke({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.program=new ii(this.gl,{vertexShader:"attribute vec2 aPos;varying vec2 vPos;uniform float uHeight;uniform mat4 pixelToViewMatrix;uniform mat4 projectionMatrix;uniform sampler2D u_sampler;uniform mat4 inverseMatrix;void main(){vPos=aPos;if(uHeight<=0.0){gl_Position=vec4(aPos,0.0,1.0);}else{vec4 gray=texture2D(u_sampler,(aPos+1.0)/2.0);vec4 m0=inverseMatrix*vec4(aPos.xy,0.0,1.0);vec4 m1=inverseMatrix*vec4(aPos.xy,1.0,1.0);m0/=m0.w;m1/=m1.w;vec4 pixel=m0+(-m0.z/(m1.z-m0.z))*(m1-m0);pixel.z=uHeight*gray.a;gl_Position=projectionMatrix*pixelToViewMatrix*vec4(pixel.xyz,1.0);}}",fragmentShader:"uniform sampler2D u_sampler;uniform sampler2D u_samplerPalette;uniform float uHeight;uniform float opacity;uniform float minOpacity;uniform float maxOpacity;uniform bool u_strict;varying vec2 vPos;void main(){vec4 gray=texture2D(u_sampler,(vPos+1.0)/2.0);float grayAlpha=gray.a;if(grayAlpha<=0.0){discard;}gl_FragColor=texture2D(u_samplerPalette,vec2(grayAlpha,1.0));float addAlpha=1.0;if(gray.a<0.3){addAlpha=gray.a*3.3;}gl_FragColor.a*=addAlpha;gl_FragColor.a=max(gl_FragColor.a,minOpacity);gl_FragColor.a=min(gl_FragColor.a,maxOpacity);gl_FragColor.a*=opacity;}"},this),this.buffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexArray=new pn({gl:n,program:this.program,attributes:[{stride:8,name:"aPos",buffer:this.buffer,size:2,type:"FLOAT",offset:0}]}),v=[];for(var d=[],x=Math.floor(n.canvas.width/4),y=Math.floor(n.canvas.height/4),M=x+1,D=0;D<=y;D++)for(var U=0;U<=x;U++)if(v.push(2*U/x-1,2*D/y-1),U<x&&D<y){var C=M*D+U,E=M*(D+1)+U;d.push(C,C+1,E+1),d.push(C,E+1,E)}this.bufferData=v,this.buffer.updateData(new Float32Array(v)),this.indexData=d,this.indexBuffer.updateData(new Uint32Array(d))}},{key:"onDestroy",value:function(){this.bufferData=[]}},{key:"onOptionsChanged",value:function(n,l){var v=this.gl;v&&n.gradient!==l.gradient&&(this.intensity=new Wi({gradient:n.gradient}),this.paletteTexture=We(v,this.intensity.paletteCtx.canvas,{TEXTURE_MAG_FILTER:"LINEAR",TEXTURE_MIN_FILTER:"LINEAR",TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}).texture)}},{key:"onDataChanged",value:function(n){if(this.gl){var l=[],v=[];this.getOptions();for(var d=0;d<n.length;d++){var x=n[d],y=this.normizedPoint(n[d].geometry.coordinates),M=x.count===void 0?1:x.count;"properties"in x&&"count"in x.properties&&(M=x.properties.count),l.push(y[0],y[1],y[2]),l.push(-1,-1),l.push(M),l.push(y[0],y[1],y[2]),l.push(-1,1),l.push(M),l.push(y[0],y[1],y[2]),l.push(1,1),l.push(M),l.push(y[0],y[1],y[2]),l.push(1,-1),l.push(M),x=4*d,v.push(x+0,x+2,x+1),v.push(x+0,x+3,x+2)}this.offlineBufferData=l,this.offlineIndexData=v,this.offlineBuffer.updateData(new Float32Array(l)),this.offlineIndexBuffer.updateData(new Uint32Array(v))}}},{key:"render",value:function(n){var l=n.gl,v=n.matrix,d=n.pointToPixelMatrix,x=n.pixelToViewMatrix;if(n=n.projectionMatrix,this.offlineBufferData&&!(0>=this.offlineBufferData.length)){var y=this.getOptions();this.setGLState({blend:!0,blendFunc:[l.ONE,l.ONE],depthTest:!1}),l.bindFramebuffer(l.FRAMEBUFFER,this.frameBuffer.framebuffer),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT),this.offlineProgram.use(l),this.offlineProgram.setUniforms({u_matrix:v,uCircle:this.circleTexture,pointToPixelMatrix:d,pixelToViewMatrix:x,projectionMatrix:n,unit:y.unit==="px"?1:0,size:y.size,max:y.max,min:y.min}),this.offlineVertexArray.bind(),this.offlineIndexBuffer.bind(),l.drawElements(l.TRIANGLES,this.offlineIndexData.length,l.UNSIGNED_INT,0),l.bindFramebuffer(l.FRAMEBUFFER,null),this.program.use(l),this.vertexArray.bind(),v=this.inverseMatrix,rr.identity(v),rr.multiply(v,n,x),rr.invert(v,v),this.setGLState({blend:!0,blendFunc:rs(l,y.blend),depthTest:!!y.height}),this.program.setUniforms({u_sampler:this.frameBuffer.framebuffer.texture,u_samplerPalette:this.paletteTexture,uHeight:y.height,opacity:y.opacity,minOpacity:y.minOpacity,maxOpacity:y.maxOpacity,pixelToViewMatrix:x,inverseMatrix:v,projectionMatrix:n}),this.indexBuffer.bind(),l.drawElements(l.TRIANGLES,this.indexData.length,l.UNSIGNED_INT,0)}}}]),u}(Ui),yp=function(a){function u(n,l){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n,l)),n.name="BarLayer",n.selectedColor=[-1,-1,-1],n.textureCache={},n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{color:"rgba(0, 180, 0, 1.0)",edgeCount:4,unit:"m",height:1e5,type:"normal",size:5e4}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions(),v={normal:[`attribute vec3 aPos;attribute vec4 aColor;attribute float aSize;attribute float aEdgeIndex;attribute float aPointIndex;attribute float aEdgeCount;varying vec4 vColor;varying vec4 vPosition;varying vec4 vFragPosition;varying float vSize;varying float vEdgeIndex;varying float vPointIndex;varying float vEdgeCount;uniform mat4 uMatrix;uniform float uZoomUnits;uniform vec4 uSelectedColor;void main(){vColor=aColor;vEdgeIndex=aEdgeIndex;vEdgeCount=aEdgeCount;vPointIndex=aPointIndex;float z=aPos.z*uZoomUnits;float x=aPos.x;float y=aPos.y;vSize=aSize*uZoomUnits;float a=radians(360.0/aEdgeCount);float b=a/2.0;float r=vSize/cos(b);if(aEdgeIndex<0.0){float index=aPointIndex;float angle=0.0;if(mod(index,2.0)==0.0){angle=a*(index/2.0)-b;}else{angle=-a*((index-1.0)/2.0)-b;}y=y+r*sin(angle);x=x+r*cos(angle);}else{float i=aEdgeIndex-1.0;float j=aPointIndex;float angle=a*i+b;y=y+r*sin(angle);x=x+r*cos(angle);}vPosition=vec4(aPos,1.0);vFragPosition=vec4(x,y,z,1.0);gl_Position=uMatrix*vFragPosition;if(aEdgeIndex==1.0&&aPointIndex==1.0){gl_PointSize=20.0;}else{gl_PointSize=10.0;}
#if defined(PICK)
if(mapvIsPicked()){vColor=uSelectedColor;}
#endif
}`,"varying vec4 vColor;varying float vEdgeIndex;varying float vPointIndex;varying float vEdgeCount;varying vec4 vPosition;varying vec4 vFragPosition;uniform mat4 uMatrix;void main(){vec4 color=vColor;if(vEdgeIndex<0.0){color.r+=0.2;color.g+=0.2;color.b+=0.2;}else{float i=ceil(vEdgeIndex);;float d=i/vEdgeCount*0.5;if(i<=vEdgeCount/2.0){d=0.2*(i/vEdgeCount*0.5)-0.1;}else{d=0.2*(vEdgeCount-i)/vEdgeCount*0.5-0.1;}color.r+=d;color.g+=d;color.b+=d;}gl_FragColor=color;}"],light:[`attribute vec3 aPos;attribute vec4 aColor;attribute float aSize;attribute float aEdgeIndex;attribute float aPointIndex;attribute float aEdgeCount;varying vec4 vColor;varying vec4 vPosition;varying vec4 vFragPosition;varying float vSize;varying float vEdgeIndex;varying float vPointIndex;varying float vEdgeCount;uniform mat4 uMatrix;uniform float uZoomUnits;uniform vec4 uSelectedColor;void main(){vColor=aColor;vEdgeIndex=aEdgeIndex;vEdgeCount=aEdgeCount;vPointIndex=aPointIndex;float z=aPos.z*uZoomUnits;float x=aPos.x;float y=aPos.y;vSize=aSize*uZoomUnits;float a=radians(360.0/aEdgeCount);float b=a/2.0;float i=aEdgeIndex;float j=aPointIndex;float angle=a*(i-1.0)+b;float r=vSize/cos(b);y=y+r*sin(angle);x=x+r*cos(angle);if(j==1.0){z=0.0;}vPosition=vec4(aPos.xyz,1.0);vFragPosition=vec4(x,y,z,1.0);gl_Position=uMatrix*vFragPosition;
#if defined(PICK)
if(mapvIsPicked()){vColor=uSelectedColor;}
#endif
}`,"varying vec4 vColor;varying float vEdgeIndex;varying float vPointIndex;varying float vEdgeCount;varying vec4 vPosition;varying vec4 vFragPosition;uniform mat4 uMatrix;void main(){vec4 color=vColor;color.a=1.0-vFragPosition.z/vPosition.z;gl_FragColor=color;}"]};v=v[l.type]||v.normal,this.program=new ii(this.gl,{vertexShader:v[0],fragmentShader:v[1],defines:l.enablePicked?["PICK"]:[]},this),this.buffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new Ke({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),l=[{stride:44,name:"aPos",buffer:this.buffer,size:3,type:"FLOAT",offset:0},{stride:44,name:"aSize",buffer:this.buffer,size:1,type:"FLOAT",offset:12},{stride:44,name:"aEdgeIndex",buffer:this.buffer,size:1,type:"FLOAT",offset:16},{stride:44,name:"aPointIndex",buffer:this.buffer,size:1,type:"FLOAT",offset:20},{stride:44,name:"aEdgeCount",buffer:this.buffer,size:1,type:"FLOAT",offset:24},{stride:44,name:"aColor",buffer:this.buffer,size:4,type:"FLOAT",offset:28}],l=l.concat(this.getCommonAttributes()),this.vertexArray=new pn({gl:n,program:this.program,attributes:l})}},{key:"onChanged",value:function(n,l){this.gl&&l&&(this.uniforms={},this.data=l,this.options=n,this.processData(),n.enablePicked&&this.parsePickData(l))}},{key:"processData",value:function(){var n=[],l=[];this.options.type==="light"?this.createLightBuffer(this.data,n,l):this.createNormalBuffer(this.data,n,l),this.bufferData=n,this.indexData=l,this.buffer.updateData(new Float32Array(n)),this.indexBuffer.updateData(new Uint32Array(l))}},{key:"createNormalBuffer",value:function(n,l,v){var d=this,x=parseInt(this.options.edgeCount,10)||4;n.forEach(function(y,M){var D=y.color||d.options.color,U=y.size||d.options.size,C=Array.isArray(y.value)?y.value:typeof y.value=="number"?[y.value]:[1],E=d.normizedPoint(y.geometry.coordinates),B=y.height||d.options.height,O=C.reduce(function(G,j){return Number(G)+Number(j)}),H=0,V="blue";for(C.forEach(function(G,j){V=d.normizedColor(typeof D=="function"?D(G,j,C):Array.isArray(D)?D[j]:D),G=typeof B=="function"?B(G,j,C):Array.isArray(B)?B[j]:B/O*G;var Y=v[v.length-1],$=l.length/11;for(0<$&&(x%2==1&&j===0?v.push(Y,Y,$):v.push(Y,$)),j=1;j<=2*x;j++)j%2==0?l.push.apply(l,[E[0],E[1],H,U,j/2,2,x].concat(ri(V))):l.push.apply(l,[E[0],E[1],H+G,U,(j+1)/2,1,x].concat(ri(V))),v.push($+j-1),j===2*x&&(l.push.apply(l,[E[0],E[1],H+G,U,j/2+1,1,x].concat(ri(V))),l.push.apply(l,[E[0],E[1],H,U,j/2+1,2,x].concat(ri(V))),v.push($+j,$+j+1));H+=G}),M=v[v.length-1],y=l.length/11,0<y&&v.push(M,y),M=1;M<=x;M++)l.push.apply(l,[E[0],E[1],H,U,-1,M,x].concat(ri(V))),v.push(y+M-1)})}},{key:"createLightBuffer",value:function(n,l,v){var d=this,x=parseInt(this.options.edgeCount,10)||4;n.forEach(function(y,M){M=y.color||d.options.color,M=d.normizedColor(typeof M=="function"?M(y.value):typeof M=="string"?M:"blue");var D=y.size||d.options.size,U=d.normizedPoint(y.geometry.coordinates),C=y.height||d.options.height;for(C=typeof C=="function"?C(y.value):C,y=1;y<=x;y++){var E=v[v.length-1],B=l.length/11;for(0<B&&v.push(E,B),E=1;E<=2*x;E++)E%2==0?l.push.apply(l,[U[0],U[1],C,D,E/2,1,x].concat(ri(M))):l.push.apply(l,[U[0],U[1],C,D,(E+1)/2,2,x].concat(ri(M))),v.push(B+E-1),E===2*x&&v.push(B,B+1)}})}},{key:"render",value:function(n){var l=this.program,v=n.gl,d=n.matrix;this.setGLState({cullFace:this.options.type==="normal"}),l.use(v),this.vertexArray.bind(),this.indexBuffer.bind();var x=this.map.getZoomUnits();Ur(this.uniforms,this.getCommonUniforms(n),{uZoomUnits:this.options.unit==="px"?x:1,uMatrix:d}),l.setUniforms(this.uniforms),v.drawElements(v.TRIANGLE_STRIP,this.indexData.length,v.UNSIGNED_INT,0)}}]),u}(Ui),xg=function(a){function u(n){Ye(this,u);var l=Pr(this,(u.__proto__||lr(u)).call(this,n));return n=l.getOptions(),l.fillPoint=new ls({enablePicked:n.enablePicked,autoSelect:n.autoSelect}),l.shadowPoint=new ls,l.textPoint=new Uu,l.children=[l.shadowPoint,l.fillPoint,l.textPoint],l}return Rr(u,a),qe(u,[{key:"pick",value:function(n,l){return this.fillPoint.pick(n,l)}},{key:"onOptionsChanged",value:function(n){this.shadowPoint.setOptions({depthTest:!1,polygonOffset:[1,1],color:n.shadowColor,size:n.shadowSize,borderWidth:n.shadowBorderWidth,borderColor:n.shadowBorderColor}),this.fillPoint.setOptions({onClick:function(l){n.onClick&&n.onClick(l)},selectedIndex:n.selectedIndex,selectedColor:n.selectedColor,depthTest:!1,color:n.fillColor,size:n.fillSize,borderWidth:n.fillBorderWidth,borderColor:n.fillBorderColor}),this.textPoint.setOptions({collides:!1,polygonOffset:[-1,-1],color:n.fontColor,fontFamily:n.fontFamily,fontSize:n.fontSize})}},{key:"onDataChanged",value:function(n){var l=this,v=this.getOptions(),d=JSON.parse(Ah(n)).map(function(y){return y.properties.size=l.getProperty("shadowSize",v.shadowSize,y),y.properties.color=l.getProperty("shadowColor",v.shadowColor,y),y.properties.borderColor=l.getProperty("shadowBorderColor",v.shadowBorderColor,y),y.properties.borderWidth=l.getProperty("shadowBorderWidth",v.shadowBorderWidth,y),y}),x=JSON.parse(Ah(n)).map(function(y){return y.properties.size=l.getProperty("fillSize",v.fillSize,y),y.properties.color=l.getProperty("fillColor",v.fillColor,y),y.properties.borderColor=l.getProperty("fillBorderColor",v.fillBorderColor,y),y.properties.borderWidth=l.getProperty("fillBorderWidth",v.fillBorderWidth,y),y});this.shadowPoint.setData(d),this.fillPoint.setData(x),this.textPoint.setData(n)}},{key:"getProperty",value:function(n,l,v){return Object.prototype.toString.call(l)==="[object Function]"?l(v):(l=v[n]||l,"properties"in v&&n in v.properties&&(l=v.properties[n]),l)}},{key:"getDefaultOptions",value:function(){return{enablePicked:!1,selectedIndex:-1,selectedColor:"#ffff00",autoSelect:!0,fillColor:"rgba(255, 50, 10, 1)",fillSize:20,fillBorderColor:"#ffffff",fillBorderWidth:1.2,shadowColor:"rgba(255, 80, 110, 0.7)",shadowSize:40,shadowBorderColor:"rgba(255, 80, 110, 1)",shadowBorderWidth:1.2,fontSize:12,fontFamily:"Microsoft Yahei",fontColor:"#ffffff"}}}]),u}(hu),Ag=function(a){function u(n,l){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n,l)),n.name="MaskLayer",n.bufferData=[],n.indices=[],n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{blend:"deeper",color:"rgba(100, 100, 100, 0.6)",height:0,polygonOffset:[0,0],depthTest:!1,depthWrite:!1}}},{key:"initialize",value:function(n){this.gl=n,this.program=new ii(this.gl,{vertexShader:"precision highp float;attribute vec2 a_position;uniform mat4 u_matrix;uniform float u_height;void main(){vec4 position=u_matrix*vec4(a_position.xy,u_height,1.0);gl_Position=position;}",fragmentShader:"precision highp float;uniform vec4 u_color;void main(){gl_FragColor=u_color;}",defines:[]},this),this.vertexBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new Ke({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"});var l=[{stride:8,name:"a_position",buffer:this.vertexBuffer,size:2,type:"FLOAT",offset:0}];l=l.concat(this.getCommonAttributes()),this.vertexArray=new pn({gl:n,program:this.program,attributes:l})}},{key:"onDestroy",value:function(){this.bufferData=[],this.index=[]}},{key:"onChanged",value:function(n,l){var v=this;if(this.gl){n=[];for(var d=[],x=[],y=[[this.normizedPoint([-180,-90]),this.normizedPoint([180,-90]),this.normizedPoint([180,90]),this.normizedPoint([-180,90])]],M=0;M<l.length;M++)if(l[M].geometry.coordinates)if(l[M].geometry.type==="LineString"&&x.push(l[M].geometry.coordinates.map(function(C){return v.normizedPoint(C)})),l[M].geometry.type==="MultiPolygon")for(var D=l[M].geometry.coordinates,U=0;U<D.length;U++)x=x.concat(D[U].map(function(C){return C.map(function(E){return v.normizedPoint(E)})}));else for(D=0;D<l[M].geometry.coordinates.length;D++)x.push(l[M].geometry.coordinates[D].map(function(C){return v.normizedPoint(C)}));for(x=Ge.flatten(y.concat(x)),l=x.vertices,x=x.holes,y=[],M=0;M<l.length;M+=3)y.push(l[M+0],l[M+1]);this.parseBufferData(n,d,y,x),this.bufferData=n,this.index=d,this.vertexBuffer.updateData(new Float32Array(n)),this.indexBuffer.updateData(new Uint32Array(d))}}},{key:"parseBufferData",value:function(n,l,v,d){var x=n.length/2;for(d=d&&d.length?Ge(v,d,2):Ge(v),n.push.apply(n,ri(v)),n=0;n<d.length;n++)l.push(d[n]+x)}},{key:"render",value:function(n){if(this.index&&this.index.length){var l=n.gl,v=n.matrix,d=this.getOptions(),x=this.program;x.use(l),n=Ur(this.getCommonUniforms(n),{u_matrix:v,u_height:d.height,u_color:this.normizedColor(d.color)}),x.setUniforms(n),this.setGLState({blend:!0,blendFunc:rs(l,d.blend),polygonOffset:d.polygonOffset,depthTest:d.depthTest,depthMask:d.depthWrite}),this.indexBuffer.bind(),this.vertexArray.bind(),l.drawElements(l.TRIANGLES,this.index.length,l.UNSIGNED_INT,0)}}}]),u}(Ui),kh=function(a){function u(){return Ye(this,u),Pr(this,(u.__proto__||lr(u)).apply(this,arguments))}return Rr(u,a),qe(u,[{key:"toBBox",value:function(n){var l=Pi(n.item.geometry.coordinates,2);return n=l[0],l=l[1],{minX:n,minY:l,maxX:n,maxY:l}}},{key:"compareMinX",value:function(n,l){return n.item.geometry.coordinates[0]-l.item.geometry.coordinates[0]}},{key:"compareMinY",value:function(n,l){return n.item.geometry.coordinates[1]-l.item.geometry.coordinates[1]}}]),u}(ma),NA=function(a){function u(n,l){return Ye(this,u),n=Pr(this,(u.__proto__||lr(u)).call(this,n,l)),n.name="PointCanvasCustomLayer",l=n.canvas=document.createElement("canvas"),n.ctx=l.getContext("2d"),n.geoRBush=new kh,n}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{depthWrite:!1,depthTest:!0,color:"#fff",fontFamily:"Microsoft Yahei",fontSize:14,flat:!1,collides:!0,unit:"px",angle:0,offset:[0,0],padding:[2,2],margin:[0,0],polygonOffset:[0,0],itemDimension:[20,20],renderItem:this.defaultOptionRenderItem}}},{key:"defaultOptionRenderItem",value:function(n,l,v){v.fillStyle="red",v.fillRect(l.x,l.y,l.w,l.h)}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions();this.texture=null,this.lastUpdateTime=0,this.program=new ii(this.gl,{vertexShader:"precision highp float;uniform mat4 matrix;uniform bool uFlat;uniform bool uUnitPx;uniform float zoomUnits;uniform float devicePixelRatio;uniform float zIndex;uniform vec2 offset;attribute vec3 position;attribute float corner;attribute float scale;attribute float rotation;attribute vec2 size;attribute vec2 aTextCoord;varying vec2 vTextCoord;/***\u70B9A(x,y)\uFF0C\u7ED5\u539F\u70B9\u987A\u65F6\u9488\u65CB\u8F6C\u89D2\u5EA6a\u65B0\u5750\u6807\u7684\u8BA1\u7B97\u516C\u5F0F*x1=x*cos(a)+y*sin(a)*y1=y*cos(a)-x*sin(a)*/vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;if(corner==1.0){x+=-size.x*cos(rotation)+size.y*sin(rotation);y+=size.y*cos(rotation)+size.x*sin(rotation);}else if(corner==2.0){x+=size.x*cos(rotation)+size.y*sin(rotation);y+=size.y*cos(rotation)-size.x*sin(rotation);}else if(corner==3.0){x+=size.x*cos(rotation)-size.y*sin(rotation);y+=-size.y*cos(rotation)-size.x*sin(rotation);}else{x+=-size.x*cos(rotation)-size.y*sin(rotation);y+=-size.y*cos(rotation)+size.x*sin(rotation);}return vec3(x,y,coord.z);}void main(){vTextCoord=aTextCoord;if(uFlat){vec2 pixelOffset=offset;vec2 halfSize=size/2.0*scale;if(uUnitPx){halfSize*=zoomUnits;pixelOffset*=zoomUnits;}vec3 current=transformCoord(position,halfSize,corner);current.z+=zIndex;gl_Position=matrix*vec4(current.x+pixelOffset[0],current.y-pixelOffset[1],current.z,1.0);}else{vec2 pixelOffset=offset*zoomUnits;vec4 projection=matrix*vec4(position.x+pixelOffset[0],position.y-pixelOffset[1],position.z,1.0);vec3 screen=projection.xyz/projection.w;vec2 halfSize=size/MAPV_resolution*devicePixelRatio*scale;vec3 current=transformCoord(screen,halfSize,corner);current.z+=zIndex;gl_Position=vec4(current,1.0);}}",fragmentShader:`precision highp float;uniform sampler2D textureImage;uniform vec4 uSelectedColor;varying vec2 vTextCoord;void main(){gl_FragColor=texture2D(textureImage,vec2(vTextCoord.x,1.0-vTextCoord.y));
#if defined(PICK)
if(mapvIsPicked()){gl_FragColor=vec4(uSelectedColor.rgb,gl_FragColor.a);}
#endif
}`,defines:l.enablePicked?["PICK"]:[]},this),this.vertexBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new Ke({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),l=[{name:"position",buffer:this.vertexBuffer,size:3,stride:32,type:"FLOAT",offset:0},{name:"corner",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:12},{name:"size",buffer:this.vertexBuffer,size:2,stride:32,type:"FLOAT",offset:16},{name:"scale",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:24},{name:"rotation",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:28},{name:"aTextCoord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}],l=l.concat(this.getCommonAttributes()),this.vertexArray=new pn({gl:n,program:this.program,attributes:l})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(n,l){this.gl&&this.processCache(n,l)}},{key:"processCache",value:function(n,l){for(this.cachedData=[],this.geoRBush.clear(),n=0;n<l.length;n++){var v=l[n],d=this.normizedPoint(v.geometry.coordinates);d&&this.cachedData.push({point:d,item:v,extra:{},index:n})}this.geoRBush.load(this.cachedData)}},{key:"render",value:function(n){if(this.cachedData&&this.cachedData.length&&this.map){var l=n.gl,v=n.matrix,d=this.getOptions(),x=this.program;x.use(l),this.throttleUpdate(n),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA],polygonOffset:d.polygonOffset,depthTest:d.depthTest,depthMask:d.depthWrite});var y=this.map.getZoomUnits();x.setUniforms(Ur(this.getCommonUniforms(n),{matrix:v,devicePixelRatio:window.devicePixelRatio,textureImage:this.texture,uFlat:d.flat,offset:d.offset,zoomUnits:y,zIndex:d.zIndex,uUnitPx:d.unit==="px"})),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),l.drawElements(l.TRIANGLES,this.index.length,l.UNSIGNED_INT,0))}}},{key:"throttleUpdate",value:function(n){this.updateText(n)}},{key:"updateText",value:function(n){var l=n.gl,v=n.matrix,d=this.getOptions(),x=d.padding,y=d.margin,M=d.collides;n=d.enablePicked;var D=d.itemDimension,U=d.beforeRenderAll,C=d.beforeComputeDimension;d=d.renderItem;var E=this.map.getBounds(),B=l.canvas.width/window.devicePixelRatio,O=l.canvas.height/window.devicePixelRatio,H=this.canvas;l=this.ctx,l.save(),l.scale(window.devicePixelRatio,window.devicePixelRatio),C&&C(l),C=E.getNorthEast(),E=E.getSouthWest();var V=C.lng,G=E.lng;for(V<G&&(V+=360),E=this.geoRBush.search({minX:G,minY:E.lat,maxX:V,maxY:C.lat}),V=new ma,C=[],G=0;G<E.length;G++){var j=E[G],Y=j.point,$=j.item,it=j.extra;j=j.index;var nt=Pi(Y,3);nt=sn.clone([nt[0],nt[1],nt[2],1]),sn.transformMat4(nt,nt,v),sn.scale(nt,nt,1/nt[3]);var dt=(nt[0]+1)/2*B,Et=(-nt[1]+1)/2*O,St=Array.isArray(D)?D:D($,l,it);nt=St[0]+2*x[0],St=St[1]+2*x[1];var Xt=nt+y[0],te=St+y[1];if(dt-=Xt/2,Et-=te/2,Xt=dt+Xt,te=Et+te,!(0>Xt||0>te||dt>B||Et>O)){if(M){if(te={minX:dt,maxX:Xt,minY:Et,maxY:te},V.collides(te))continue;V.insert(te)}C.push({w:nt,h:St,point:Y,item:$,extra:it,dataIndex:j})}}for(l.restore(),x=mn(C),v=x.w,x=x.h,0>=v&&(v=1),0>=x&&(x=1),H.width=v*window.devicePixelRatio,H.height=x*window.devicePixelRatio,l.save(),l.scale(window.devicePixelRatio,window.devicePixelRatio),U&&U(l),U=[],H=[],y=[],M=[],D=0,B=C.length;D<B;++D){for(O=C[D],d(O.item,O,l,O.extra),G=Pi(O.point,3),E=G[0],V=G[1],G=G[2],Y=0;4>Y;Y++)U.push(E,V,G),U.push(Y),U.push(O.w,O.h),U.push(1,0);E=O.x/v,V=(O.x+O.w)/v,G=(O.y+O.h)/x,Y=O.y/x,H.push(E,G,E,Y,V,Y,V,G),E=4*D,y.push(E,E+2,E+1,E,E+3,E+2),n&&(O=this.indexToRgb(O.dataIndex),M.push(O[0]/255,O[1]/255,O[2]/255),M.push(O[0]/255,O[1]/255,O[2]/255),M.push(O[0]/255,O[1]/255,O[2]/255),M.push(O[0]/255,O[1]/255,O[2]/255))}l.restore(),this.loadTexture(),this.index=y,this.vertexBuffer.updateData(new Float32Array(U)),this.uvBuffer.updateData(new Float32Array(H)),this.indexBuffer.updateData(new Uint32Array(y)),n&&this.pickBuffer.updateData(new Float32Array(M))}},{key:"loadTexture",value:function(){var n=this;this.canvas?Bn(this.gl,this.canvas,function(l){n.texture=l},{TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}):this.texture=null}}]),u}(Ui),bu=function(){function a(u,n){Ye(this,a),this.name="Mask",this.webglLayer=u,this.options=n||{},this.bufferData=[],this.indices=[]}return qe(a,[{key:"initialize",value:function(u){return this.gl=u,this.program=new ii(this.gl,{vertexShader:"precision highp float;attribute vec2 a_position;uniform mat4 u_matrix;uniform float u_height;void main(){vec4 position=u_matrix*vec4(a_position.xy,u_height,1.0);gl_Position=position;}",fragmentShader:"precision highp float;uniform vec4 u_color;void main(){gl_FragColor=u_color;}",defines:[]},this),this.vertexBuffer=new Ke({gl:u,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new Ke({gl:u,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexArray=new pn({gl:u,program:this.program,attributes:[{stride:8,name:"a_position",buffer:this.vertexBuffer,size:2,type:"FLOAT",offset:0}]}),this}},{key:"onDestroy",value:function(){this.bufferData=[],this.index=[]}},{key:"setData",value:function(u){var n=this;if(this.gl){for(var l=[],v=[],d=0;d<u.length;d++)if(u[d].geometry.coordinates){var x=[];if(u[d].geometry.type==="LineString"&&(x=[u[d].geometry.coordinates.map(function(U){return n.normizedPoint(U)})]),u[d].geometry.type==="MultiPolygon")for(var y=u[d].geometry.coordinates,M=0;M<y.length;M++)x=x.concat(y[M].map(function(U){return U.map(function(C){return n.normizedPoint(C)})}));else for(y=0;y<u[d].geometry.coordinates.length;y++)x.push(u[d].geometry.coordinates[y].map(function(U){return n.normizedPoint(U)}));y=Ge.flatten(x),x=y.vertices,y=y.holes,M=[];for(var D=0;D<x.length;D+=3)M.push(x[D+0],x[D+1]);this.parseBufferData(l,v,M,y)}return this.bufferData=l,this.index=v,this.vertexBuffer.updateData(new Float32Array(l)),this.indexBuffer.updateData(new Uint32Array(v)),this}}},{key:"parseBufferData",value:function(u,n,l,v){var d=u.length/2;for(v=v&&v.length?Ge(l,v,2):Ge(l),u.push.apply(u,ri(l)),u=0;u<v.length;u++)n.push(v[u]+d)}},{key:"render",value:function(u){if(this.index&&this.index.length){var n=u.gl,l=u.matrix,v=this.options;u=this.program,u.use(n),l={u_matrix:l,u_height:v.height||0,u_color:this.normizedColor(v.color)},u.setUniforms(l),this.indexBuffer.bind(),this.vertexArray.bind(),n.drawElements(n.TRIANGLES,this.index.length,n.UNSIGNED_INT,0)}}},{key:"normizedColor",value:function(u){var n=u;return u instanceof Array||(n=Ft(u).unitArray()),n[3]===void 0&&(n[3]=1),n}},{key:"normizedPoint",value:function(u){var n=this.getPointOffset();if(!u||!u[0]||!u[1])return[n[0],n[1],0];var l=Number(u[0]),v=Number(u[1]);-180<=l&&180>=l&&-90<=v&&90>=v&&(v=this.webglLayer.map.lnglatToMercator(l,v),l=v[0],v=v[1]);var d=Number(u[2])||0;return this.webglLayer&&this.webglLayer.options.mapType==="cesium"&&window.Cesium?(l=this.convertLngLat([l,v]),d=window.Cesium.Cartesian3.fromDegrees(l[0],l[1],d),l=d.x,v=d.y,d=d.z):this.webglLayer&&this.webglLayer.options.mapType==="bmapgl"&&this.webglLayer.map.map.mapType==="B_EARTH_MAP"&&(l=this.convertLngLat([l,v]),d=this.webglLayer.map.map.getEarth().scene.fromLatLngToXYZ({lng:l[0],lat:l[1]}),l=d.x,v=d.y,d=d.z),3<u.length?[l-n[0],v-n[1],d].concat(ri(u.slice(3))):[l-n[0],v-n[1],d]}},{key:"convertLngLat",value:function(u){return[u[0]/2003750834e-2*180,180/Math.PI*(2*Math.atan(Math.exp(u[1]/2003750834e-2*180*Math.PI/180))-Math.PI/2)]}},{key:"getPointOffset",value:function(){var u=[0,0],n=this.options;return this.webglLayer&&this.webglLayer.options.pointOffset?u=this.webglLayer.options.pointOffset:n.pointOffset&&(u=n.pointOffset),u}}]),a}(),Iv=function(a){function u(n,l){return Ye(this,u),Pr(this,(u.__proto__||lr(u)).call(this,n,l))}return Rr(u,a),qe(u,[{key:"getDefaultOptions",value:function(){return{}}},{key:"initialize",value:function(n){var l=this.getOptions();if(l.source&&l.source.image&&l.domain&&(typeof l.source.image=="string"||l.source.width&&l.source.height)){var v=l.refColors,d=l.refImage;if((v||d)&&(!v||v.colors&&v.positions)&&(!d||typeof d.url=="string")){this.gl=n;var x=[];v?this.imageData=Af(v.colors,v.positions,v.clamp,v.color,v.height):(this.imageData={data:d.url},x.push("USE_IMAGE_TEXTURE"),this.imageTexture=!0),l.isTerrain&&(this.isTerrain=l.isTerrain,x.push("USE_TERRAIN"),this.gridRowMax=1600,l.gridRowMax&&(this.gridRowMax=l.gridRowMax),this.gridColMax=1600,l.gridColMax&&(this.gridColMax=l.gridColMax)),this.texture=null,v=`
        float generateValue(vec4 rgba){
            return rgba.r;
        }`,l.fomularC&&(v=l.fomularC),l=`precision highp float;attribute vec3 a_pos;attribute vec2 a_texture_coord;uniform mat4 u_proj_matrix;uniform mat4 u_mv_matrix;uniform sampler2D uTile;uniform float u_baseLine;uniform float u_elevationScale;varying vec2 v_texture_coord;void main(){v_texture_coord=a_texture_coord;vec3 pos=a_pos.xyz;
#if defined(USE_TERRAIN)
vec4 terrainColor=texture2D(uTile,vec2(a_texture_coord.s,a_texture_coord.t));float value=generateValue(terrainColor);float h=(value-u_baseLine)*u_elevationScale;pos.z=max(0.,h);
#endif
vec4 position=u_proj_matrix*u_mv_matrix*vec4(pos,1.0);gl_Position=position;}`.replace("void main()",v+`
void main()`),v=`precision highp float;varying vec2 v_texture_coord;uniform sampler2D uTile;uniform sampler2D uColorRamp;uniform bool uUseFilter;uniform vec4 uFilterColor;uniform float u_opacity;uniform float u_noData;uniform vec3 u_noTextureData;uniform vec2 u_clamp;uniform vec2 u_domain;uniform vec3 u_linearOpacity;uniform bool u_isOneBand;uniform float u_brightness;uniform float u_contrast;uniform float u_exposure;uniform float u_saturation;vec4 indexToRgba(float value){float index=value;float b=floor(index/65536.);index-=b*65536.;float g=floor(index/256.);index-=g*256.;float r=index;return vec4(r,g,b,255.);}vec3 adjustBrightness(vec3 color,float value){return color+value;}vec3 adjustContrast(vec3 color,float value){return 0.5+(1.0+value)*(color-0.5);}vec3 adjustExposure(vec3 color,float value){return color*(1.0+value);}vec3 adjustSaturation(vec3 color,float value){const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);vec3 grayscale=vec3(dot(color,luminosityFactor));return mix(grayscale,color,1.0+value);}void main(){vec4 data=texture2D(uTile,vec2(v_texture_coord.s,v_texture_coord.t));float value=generateValue(data);vec4 textureColor=vec4(0,0,0,0);if(value>=u_clamp.s&&value<=u_clamp.t){float normalisedValue=(value-u_domain.s)/(u_domain.t-u_domain.s);
#if defined(USE_IMAGE_TEXTURE)
vec4 color=texture2D(uColorRamp,vec2(v_texture_coord.s,v_texture_coord.t));if(vec3(color.rgb)==u_noTextureData){color=vec4(0,0,0,0);}
#else
vec4 color=texture2D(uColorRamp,vec2(normalisedValue,0));
#endif
color.a=smoothstep(u_linearOpacity.s,u_linearOpacity.t,color.a*normalisedValue)+u_linearOpacity.p;textureColor=color;textureColor.a=textureColor.a*u_opacity;vec3 mixColor=adjustBrightness(textureColor.rgb,u_brightness);mixColor=adjustContrast(mixColor,u_contrast);mixColor=adjustExposure(mixColor,u_exposure);mixColor=adjustSaturation(mixColor,u_saturation);textureColor=vec4(mixColor,textureColor.a);if(uIsPickRender&&u_isOneBand){textureColor=indexToRgba(value)/255.;}if(uIsPickRender&&!u_isOneBand){textureColor=data;}}if(value==u_noData){textureColor=vec4(0,0,0,0);}if(uUseFilter){textureColor=textureColor*uFilterColor;}gl_FragColor=textureColor;}`.replace("void main()",v+`
void main()`),this.program=new ii(this.gl,{vertexShader:l,fragmentShader:v,defines:x},this),this.vertexBuffer=new Ke({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new Ke({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexArray=new pn({gl:n,program:this.program,attributes:[{name:"a_pos",buffer:this.vertexBuffer,stride:20,size:3,type:"FLOAT",offset:0},{name:"a_texture_coord",buffer:this.vertexBuffer,size:2,stride:20,type:"FLOAT",offset:12}]})}}}},{key:"onChanged",value:function(n,l){var v=this;this.gl&&(this.loadDataTexture&&clearTimeout(this.loadDataTexture),this.loadDataTexture=setTimeout(function(){v.loadTexture(function(){v.parseData(l),v.webglLayer.render()})},0))}},{key:"drawMask",value:function(n){var l=n.gl,v=n.matrix,d=n.projectionMatrix,x=n.viewMatrix;if(n=n.polygons){var y=new bu(this.webglLayer,{color:"rgba(19, 14, 7, 0.8)"});this.setGLState({stencilTest:!0,depthTest:!1,depthMask:!1}),l.clear(l.STENCIL_BUFFER_BIT),l.stencilFunc(l.ALWAYS,1,255),l.stencilOp(l.KEEP,l.KEEP,l.REPLACE),l.colorMask(!1,!1,!1,!1),y.initialize(l).setData(n).render({gl:l,matrix:v,projectionMatrix:d,viewMatrix:x})}}},{key:"onOptionsChanged",value:function(n,l){this.gl&&(this.initialize(this.gl),this.loadTexture(),this.webglLayer.render())}},{key:"render",value:function(n){var l=n.gl,v=n.matrix,d=n.projectionMatrix,x=n.viewMatrix,y=n.isPickRender;n=this.getOptions();var M=this.program;(M||this.texture)&&(n.stencilData&&this.drawMask({gl:l,matrix:v,projectionMatrix:d,viewMatrix:x,polygons:n.stencilData}),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA],stencilTest:!!n.stencilData,depthTest:n.depthTest,depthMask:n.depthMask}),M.use(l),n.stencilData&&(l.stencilFunc(l.EQUAL,1,1),l.stencilOp(l.KEEP,l.KEEP,l.KEEP),l.colorMask(!0,!0,!0,!0)),this.colorRamp&&this.texture&&(v=[0,0,0],n.linearOpacity&&this.formaLinear(n.linearOpacity,v),d={uColorRamp:this.colorRamp,uTile:this.texture,u_proj_matrix:d,uUseFilter:!!n.filterColor,uFilterColor:this.normizedColor(n.filterColor||"rgba(0, 0, 100, 1.0)"),u_mv_matrix:x,uIsPickRender:!!y,u_noData:n.noData||-99999,u_domain:n.domain,u_clamp:n.clamp?n.clamp:n.domain,u_linearOpacity:v,u_opacity:n.opacity||1,u_isOneBand:!!this.isOneBand,u_brightness:n.brightness||0,u_contrast:n.contrast||0,u_exposure:n.exposure||0,u_saturation:n.saturation||0},this.isTerrain&&(d.u_baseLine=n.baseLine||0,d.u_elevationScale=n.elevationScale||1),this.imageTexture&&(d.u_noTextureData=n.baseLine||0),M.setUniforms(d),this.index&&0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),l.drawElements(l.TRIANGLES,this.index.length,l.UNSIGNED_INT,0)),n.stencilData&&!n.stencilAfter&&(l.clear(l.STENCIL_BUFFER_BIT),l.stencilMask(255),l.stencilFunc(l.ALWAYS,1,255))))}},{key:"onDestroy",value:function(){this.texturePixels=this.texture=this.colorRamp=this.indexBuffer=this.vertexBuffer=this.index=this.program=null}},{key:"pickAfter",value:function(n,l){var v,d;return this.isOneBand?(l=v=d=l,n=1):(l=n[0],v=n[1],d=n[2],n=n[3]),this.getOptions().fomularJS?this.getOptions().fomularJS({r:l,g:v,b:d,a:n}):l}},{key:"formaLinear",value:function(n,l){n.start&&(l[0]=n.start||0),n.end&&(l[1]=n.end||0),n.base&&(l[2]=n.base||0)}},{key:"loadTexture",value:function(n){var l=this,v=this.getOptions();v.source.image&&this.imageData?Bn(this.gl,this.imageData.data,function(d,x){l.colorRamp=d,si(v.source.image)==="object"?(l.isOneBand=!0,Bn(l.gl,v.source.image,function(y,M,D){l.texture=y,l.texturePixels=D,l.textureWidth=D.width,l.textureHeight=D.height,n&&n(),l.webglLayer.render()},{TEXTURE_MIN_FILTER:"NEAREST",TEXTURE_MAG_FILTER:"NEAREST",TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"},{width:v.source.width,height:v.source.height,format:"LUMINANCE",type:"FLOAT"})):(l.isOneBand=!1,Bn(l.gl,v.source.image,function(y,M,D){l.texture=y,l.texturePixels=D,l.textureWidth=D.width,l.textureHeight=D.height,n&&n(),l.webglLayer.render()},{TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}))},{TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"},{width:this.imageData.width,height:this.imageData.height,flipY:!0,format:"RGBA",type:"UNSIGNED_BYTE"}):(this.texture=null,n&&n())}},{key:"parseData",value:function(n){var l=this;if(this.vertexBuffer){var v=[],d=[];if(n&&n[0]){var x=n[0].geometry.coordinates[0];x=x.map(function(V){return l.normizedPoint(V)}),n=x[0][0];var y=x[0][1],M=x[2][0],D=x[2][1];this.bound=[n,y,M,D],this.gridRowMax>this.textureHeight&&(this.gridRowMax=this.textureHeight),this.gridColMax>this.textureWidth&&(this.gridColMax=this.textureWidth),x=this.isTerrain?this.gridColMax:1;var U=this.isTerrain?this.gridRowMax:1,C=x+1;M=(M-n)/x,D=(D-y)/U;for(var E=0;E<=U;E++)for(var B=0;B<=x;B++)if(v.push(n+M*B,y+D*E,0),v.push(B/x,E/U),B<x&&E<U){var O=C*E+B,H=C*(E+1)+B;d.push(O,H+1,O+1),d.push(O,H,H+1)}}this.index=d,this.vertexBuffer.updateData(new Float32Array(v)),this.indexBuffer.updateData(new Uint32Array(d))}}},{key:"getValue",value:function(n,l){return this.isTerrain&&n&&this.bound&&(n=this.normizedPoint(n),this.containsPoint(n,this.bound)&&(n=this.uvPoint(n,this.bound),l=this.pixelByUV(n,l,this.getOptions().fomularJS),l.result))?l:0}},{key:"containsPoint",value:function(n,l){if(n)return n[0]>=l[0]&&n[0]<=l[2]&&n[1]>=l[1]&&n[1]<=l[3]}},{key:"uvPoint",value:function(n,l){if(n)return[(n[0]-l[0])/(l[2]-l[0]),(l[3]-n[1])/(l[3]-l[1])]}},{key:"pixelByUV",value:function(n,l,v){if(this.texturePixels){var d=this.texturePixels,x=d.width,y=d.height,M=d.data,D=Math.floor(n[0]*(x-1));n=Math.floor(n[1]*(y-1));var U=1;return d.type==="RGBA"&&(U=4),this._getPixelBound(D,n,l,x,y,M,U,v)}return null}},{key:"_getPixelBound",value:function(n,l,v,d,x,y,M,D){var U=n-v;0>U&&(U=0),n+=v,n>d-1&&(n=d-1);var C=l-v;0>C&&(C=0),l+=v,l>x-1&&(l=x-1),v=x=0;for(var E=[0,0,0,1],B=U;B<=n;B++)for(var O=C;O<=l;O++){var H=(O*d+B)*M,V=y[H],G=y[H+this.min(0,M-3)],j=y[H+this.min(0,M-2)];H=M===4?y[H+3]:1;var Y=D?D({r:V,g:G,b:j,a:H}):V;Y>x&&(x=Y,E=[V,G,j,H]),v+=Y}return{result:v/((n-U+1)*(l-C+1)),pixel:E,max:x}}},{key:"min",value:function(n,l){return l<n?n:l}}]),u}(Ui);window._hmt_private||(window._hmt=window._hmt||[],function(){var a=document.createElement("script");a.src="https://hm.baidu.com/hm.js?e8002ef3d9e0d8274b5b74cc4a027d08";var u=document.getElementsByTagName("script")[0];u.parentNode.insertBefore(a,u)}()),Lt.version="1.0.0-beta.189",Lt.View=lv,Lt.CanvasLayer=ge,Lt.CircleLayer=function a(){var u=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return Ye(this,a),tg.includes(u.type)?new op(u):new $d(u)},Lt.GridLayer=D1,Lt.HeatGridLayer=Rl,Lt.ShapeLayer=Di,Lt.SimpleLineLayer=ig,Lt.LineLayer3D=sg,Lt.LineLayer=Hu,Lt.LineRainbowLayer=z1,Lt.WallSpriteLayer=ug,Lt.LinePointLayer=Nh,Lt.WallLayer=AA,Lt.WallTripLayer=qi,Lt.HeatLineLayer=X1,Lt.HoneycombLayer=_A,Lt.WebglLayer=Ph,Lt.PointLayer=ls,Lt.GroundRippleLayer=MA,Lt.RippleLayer=CA,Lt.SparkLayer=TA,Lt.ClusterLayer=SA,Lt.IconClusterLayer=IA,Lt.HeatPointLayer=zl,Lt.ShapeLineLayer=EA,Lt.PointTripLayer=LA,Lt.LineTripLayer=kc,Lt.IconCollidesLayer=RA,Lt.LineFlowLayer=Z1,Lt.TileLayer=Dn,Lt.IconLayer=Xr,Lt.BoardLayer=Vo,Lt.PolygonLayer=mp,Lt.CarLineLayer=Vc,Lt.Layer=Ui,Lt.TextLayer=Uu,Lt.BoardTextLayer=Wc,Lt.LabelLayer=kl,Lt.TrafficLayer=Gl,Lt.GltfLayer=yg,Lt.HeatmapLayer=Hh,Lt.BarLayer=yp,Lt.MarkerListLayer=xg,Lt.MaskLayer=Ag,Lt.PointCanvasCustomLayer=NA,Lt.PixelLayer=Iv,Lt.FXAA=av,Lt.SMAA=uv,Lt.BlurEffect=A1,Lt.BloomEffect=qd,Lt.BrightEffect=Kd,Lt.DepthEffect=w1,Lt.EffectManager=_1,Lt.getContext=al,Lt.createTexture=We,Lt.loadTextureImage=Bn,Lt.getBlend=rs,Lt.FrameBufferObject=ao,Lt.Program=ii,Lt.StateManager=sv,Lt.Buffer=Ke,Lt.VertexArray=pn,Lt.CommonLayer=da,Lt.MercatorProjection=ti,Lt.Canvas=xo,Lt.Intensity=Wi,Lt.BezierCurve=Xi,Lt.GeodesicCurve=jo,Lt.OdCurve=$0,Lt.utilCity={getProvinceNameByCityName:function(a){for(var u=0;u<Lu.length;u++)for(var n=Lu[u].n,l=Lu[u].cities,v=0;v<l.length;v++)if(l[v].n==a)return n;return null},getCenterByCityName:function(a){a=a.replace("\u5E02","");for(var u=0;u<Fd.length;u++)if(Fd[u].n==a)return ia(Fd[u].g);for(u=0;u<Bd.length;u++)if(Bd[u].n==a)return ia(Bd[u].g);for(u=0;u<Lu.length;u++){if(Lu[u].n==a)return ia(Lu[u].g);for(var n=Lu[u].cities,l=0;l<n.length;l++)if(n[l].n==a)return ia(n[l].g)}return null}},Lt.isMobile=Um,Lt.isIOSMobile=Hm,Lt.Encryptor={encode:function(a){a=rv.deflateRaw(a);for(var u=[],n=0;n<a.length;n++)u.push(a[n]^23);return new Uint8Array(u)},decode:function(a){a=new Uint8Array(a);for(var u=[],n=0;n<a.length;n++)u.push(a[n]^23);a=new Uint8Array(u);try{var l=window.flate.deflate_decode_raw(a);return new TextDecoder("utf-8").decode(l)}catch(v){return console.warn("inflate by pako!"),rv.inflateRaw(a,{to:"string"})}},download:function(a,u){var n=new Blob([a],{type:"application/octet-binary"});a=document.createElement("a"),n=window.URL.createObjectURL(n),a.href=n,a.download=u||"mapvgl_download",a.click()}},Lt.createFusionView=function(a,u){var n=void 0,l=!1;a.addEventListener("glmoduleloaded",function(v){l||(l=!0,setTimeout(function(){n=new lv({cameraNear:10,cameraFar:4e3,gl:a._webglPainter.gl,canvas:a._webglPainter.gl.canvas,autoUpdate:!1,map:a}),n.webglLayer.canvas.style.zIndex=1;var d=n.webglLayer.stateManager;a.insertRender=function(){d.setState({blend:!0,depthTest:!1}),n.render()},u&&u(n)},3e3))}),setTimeout(function(){if(!l&&a._webglMapScene&&a._webglPainter&&a._webglPainter.gl&&a._webglPainter.gl.canvas){l=!0,n=new lv({cameraNear:10,cameraFar:4e3,gl:a._webglPainter.gl,canvas:a._webglPainter.gl.canvas,autoUpdate:!1,map:a}),n.webglLayer.canvas.style.zIndex=1;var v=n.webglLayer.stateManager;a.insertRender=function(){v.setState({blend:!0,depthTest:!1}),n.render()},u&&u(n)}},4e3)},Lt.toRadian=he,Lt.toAngle=lt,Lt.ceilPowerOfTwo=ye,Lt.floorPowerOfTwo=ci,Lt.approximatelyEqual=Or,Lt.isClosed=Ce,Lt.generateColorRamp=Af,Lt.__moduleExports=$o,Lt.vec4=sn,Lt.vec3=Dr,Lt.vec2=di,Lt.quat2=oA,Lt.quat=np,Lt.mat4=rr,Lt.mat3=v1,Lt.mat2d=y1,Lt.mat2=nv,Lt.glMatrix=ov,Object.defineProperty(Lt,"__esModule",{value:!0})})},98762:function(oi,Qt,Dt){function ce(Lt,ge,Nt){for(var Rt=ge.length,ue=new Uint8Array(3*Rt/4-(ge[Rt-2]=="="?2:ge[Rt-1]=="="?1:0)),se=new Uint8Array(130),st=0;64>st;st++)se["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(st)]=st;for(var Ft=st=0;st<Rt;st+=4){var Pt=se[ge.charCodeAt(st+1)],It=se[ge.charCodeAt(st+2)];ue[Ft++]=se[ge.charCodeAt(st)]<<2|Pt>>4,ue[Ft++]=(Pt&15)<<4|It>>2,ue[Ft++]=(It&3)<<6|se[ge.charCodeAt(st+3)]&63}return Nt&&!Lt?WebAssembly.instantiate(ue,Nt):Nt||Lt?(Lt=new WebAssembly.Module(ue),Nt?new WebAssembly.Instance(Lt,Nt):Lt):WebAssembly.compile(ue)}(function(Lt,ge){ge(Qt)})(this,function(Lt){function ge(){throw Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function Nt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Rt(t,r){return r={exports:{}},t(r,r.exports),r.exports}function ue(t){var r,i;this.promise=new t(function(s,f){if(r!==void 0||i!==void 0)throw TypeError("Bad Promise constructor");r=s,i=f}),this.resolve=Th(r),this.reject=Th(i)}function se(){}function st(t,r){this.x=t||0,this.y=r||0}function Ft(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function Pt(t,r,i,s,f,c,g,p,A,S){Object.defineProperty(this,"id",{value:PA++}),this.uuid=Ar.generateUUID(),this.name="",this.image=t!==void 0?t:Pt.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=r!==void 0?r:Pt.DEFAULT_MAPPING,this.wrapS=i!==void 0?i:1001,this.wrapT=s!==void 0?s:1001,this.magFilter=f!==void 0?f:1006,this.minFilter=c!==void 0?c:1008,this.anisotropy=A!==void 0?A:1,this.format=g!==void 0?g:1023,this.internalFormat=null,this.type=p!==void 0?p:1009,this.offset=new st(0,0),this.repeat=new st(1,1),this.center=new st(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ft,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=S!==void 0?S:3e3,this.version=0,this.onUpdate=null}function It(t,r,i,s){this.x=t||0,this.y=r||0,this.z=i||0,this.w=s!==void 0?s:1}function bt(t,r,i){this.width=t,this.height=r,this.scissor=new It(0,0,t,r),this.scissorTest=!1,this.viewport=new It(0,0,t,r),i=i||{},this.texture=new Pt(void 0,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=r,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:1006,this.depthBuffer=i.depthBuffer!==void 0?i.depthBuffer:!0,this.stencilBuffer=i.stencilBuffer!==void 0?i.stencilBuffer:!0,this.depthTexture=i.depthTexture!==void 0?i.depthTexture:null}function re(t,r,i){bt.call(this,t,r,i),this.samples=4}function he(t,r,i,s){this._x=t||0,this._y=r||0,this._z=i||0,this._w=s!==void 0?s:1}function lt(t,r,i){this.x=t||0,this.y=r||0,this.z=i||0}function ye(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function ci(t,r,i,s){this._x=t||0,this._y=r||0,this._z=i||0,this._order=s||ci.DefaultOrder}function Or(){this.mask=1}function Ce(){Object.defineProperty(this,"id",{value:q1++}),this.uuid=Ar.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ce.DefaultUp.clone();var t=new lt,r=new ci,i=new he,s=new lt(1,1,1);r._onChange(function(){i.setFromEuler(r,!1)}),i._onChange(function(){r.setFromQuaternion(i,void 0,!1)}),Xr(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:r},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new ye},normalMatrix:{value:new Ft}}),this.matrix=new ye,this.matrixWorld=new ye,this.matrixAutoUpdate=Ce.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Or,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function ti(){Ce.call(this),this.type="Scene",this.overrideMaterial=this.fog=this.environment=this.background=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function Ai(t,r){this.min=t!==void 0?t:new lt(Infinity,Infinity,Infinity),this.max=r!==void 0?r:new lt(-Infinity,-Infinity,-Infinity)}function Ti(t,r,i,s,f){var c,g=0;for(c=t.length-3;g<=c;g+=3){kh.fromArray(t,g);var p=f.x*Math.abs(kh.x)+f.y*Math.abs(kh.y)+f.z*Math.abs(kh.z),A=r.dot(kh),S=i.dot(kh),N=s.dot(kh);if(Math.max(-Math.max(A,S,N),Math.min(A,S,N))>p)return!1}return!0}function Fn(t,r){this.center=t!==void 0?t:new lt,this.radius=r!==void 0?r:-1}function xo(t,r){this.origin=t!==void 0?t:new lt,this.direction=r!==void 0?r:new lt(0,0,-1)}function Wi(t,r){this.normal=t!==void 0?t:new lt(1,0,0),this.constant=r!==void 0?r:0}function Xi(t,r,i){this.a=t!==void 0?t:new lt,this.b=r!==void 0?r:new lt,this.c=i!==void 0?i:new lt}function Ue(t,r,i){return r===void 0&&i===void 0?this.set(t):this.setRGB(t,r,i)}function jo(t,r,i){return 0>i&&(i+=1),1<i&&--i,i<1/6?t+6*(r-t)*i:.5>i?r:i<2/3?t+6*(r-t)*(2/3-i):t}function Ma(t){return .04045>t?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function ia(t){return .0031308>t?12.92*t:1.055*Math.pow(t,.41666)-.055}function Ca(t,r,i,s,f,c){this.a=t,this.b=r,this.c=i,this.normal=s&&s.isVector3?s:new lt,this.vertexNormals=Array.isArray(s)?s:[],this.color=f&&f.isColor?f:new Ue,this.vertexColors=Array.isArray(f)?f:[],this.materialIndex=c!==void 0?c:0}function kr(){Object.defineProperty(this,"id",{value:it++}),this.uuid=Ar.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=this.flatShading=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null,this.depthFunc=3,this.depthWrite=this.depthTest=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilZPass=this.stencilZFail=this.stencilFail=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipShadows=this.clipIntersection=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetUnits=this.polygonOffsetFactor=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.toneMapped=this.visible=!0,this.userData={},this.version=0}function ro(t){kr.call(this),this.type="MeshBasicMaterial",this.color=new Ue(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphTargets=this.skinning=!1,this.setValues(t)}function Ir(t,r,i){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=r,this.count=t!==void 0?t.length/r:0,this.normalized=i===!0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function rd(t,r,i){Ir.call(this,new Int8Array(t),r,i)}function wu(t,r,i){Ir.call(this,new Uint8Array(t),r,i)}function ih(t,r,i){Ir.call(this,new Uint8ClampedArray(t),r,i)}function xf(t,r,i){Ir.call(this,new Int16Array(t),r,i)}function Ta(t,r,i){Ir.call(this,new Uint16Array(t),r,i)}function sl(t,r,i){Ir.call(this,new Int32Array(t),r,i)}function al(t,r,i){Ir.call(this,new Uint32Array(t),r,i)}function We(t,r,i){Ir.call(this,new Float32Array(t),r,i)}function Bn(t,r,i){Ir.call(this,new Float64Array(t),r,i)}function rs(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function Af(t){if(t.length===0)return-Infinity;for(var r=t[0],i=1,s=t.length;i<s;++i)t[i]>r&&(r=t[i]);return r}function Ge(){Object.defineProperty(this,"id",{value:dt+=2}),this.uuid=Ar.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingSphere=this.boundingBox=null,this.drawRange={start:0,count:Infinity},this.userData={}}function dn(t,r){Ce.call(this),this.type="Mesh",this.geometry=t!==void 0?t:new Ge,this.material=r!==void 0?r:new ro,this.updateMorphTargets()}function ne(t,r,i,s,f,c,g,p){return(r.side===1?s.intersectTriangle(g,c,f,!0,p):s.intersectTriangle(f,c,g,r.side!==2,p))===null?null:(Q1.copy(p),Q1.applyMatrix4(t.matrixWorld),r=i.ray.origin.distanceTo(Q1),r<i.near||r>i.far?null:{distance:r,point:Q1.clone(),object:t})}function Fr(t,r,i,s,f,c,g,p,A,S,N,_){if(Be.fromBufferAttribute(f,S),wr.fromBufferAttribute(f,N),_r.fromBufferAttribute(f,_),f=t.morphTargetInfluences,r.morphTargets&&c&&f){_n.set(0,0,0),jc.set(0,0,0),Xn.set(0,0,0);for(var I=0,L=c.length;I<L;I++){var P=f[I],F=c[I];P!==0&&(ke.fromBufferAttribute(F,S),Os.fromBufferAttribute(F,N),wn.fromBufferAttribute(F,_),g?(_n.addScaledVector(ke,P),jc.addScaledVector(Os,P),Xn.addScaledVector(wn,P)):(_n.addScaledVector(ke.sub(Be),P),jc.addScaledVector(Os.sub(wr),P),Xn.addScaledVector(wn.sub(_r),P)))}Be.add(_n),wr.add(jc),_r.add(Xn)}return t.isSkinnedMesh&&(t.boneTransform(S,Be),t.boneTransform(N,wr),t.boneTransform(_,_r)),(t=ne(t,r,i,s,Be,wr,_r,Ev))&&(p&&(bl.fromBufferAttribute(p,S),Xc.fromBufferAttribute(p,N),pu.fromBufferAttribute(p,_),t.uv=Xi.getUV(Ev,Be,wr,_r,bl,Xc,pu,new st)),A&&(bl.fromBufferAttribute(A,S),Xc.fromBufferAttribute(A,N),pu.fromBufferAttribute(A,_),t.uv2=Xi.getUV(Ev,Be,wr,_r,bl,Xc,pu,new st)),p=new Ca(S,N,_),Xi.getNormal(Be,wr,_r,p.normal),t.face=p),t}function Le(){Object.defineProperty(this,"id",{value:nC+=2}),this.uuid=Ar.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function Mr(t){var r={},i;for(i in t){r[i]={};for(var s in t[i]){var f=t[i][s];f&&(f.isColor||f.isMatrix3||f.isMatrix4||f.isVector2||f.isVector3||f.isVector4||f.isTexture)?r[i][s]=f.clone():Array.isArray(f)?r[i][s]=f.slice():r[i][s]=f}}return r}function Xe(t){for(var r={},i=0;i<t.length;i++){var s=Mr(t[i]),f;for(f in s)r[f]=s[f]}return r}function $e(t){kr.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,this.fragmentShader=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,t!==void 0&&(t.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function Gr(){Ce.call(this),this.type="Camera",this.matrixWorldInverse=new ye,this.projectionMatrix=new ye,this.projectionMatrixInverse=new ye}function Cr(t,r,i,s){Gr.call(this),this.type="PerspectiveCamera",this.fov=t!==void 0?t:50,this.zoom=1,this.near=i!==void 0?i:.1,this.far=s!==void 0?s:2e3,this.focus=10,this.aspect=r!==void 0?r:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function Br(t,r,i){if(Ce.call(this),this.type="CubeCamera",i.isWebGLCubeRenderTarget!==!0)console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");else{this.renderTarget=i;var s=new Cr(90,1,t,r);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new lt(1,0,0)),this.add(s);var f=new Cr(90,1,t,r);f.layers=this.layers,f.up.set(0,-1,0),f.lookAt(new lt(-1,0,0)),this.add(f);var c=new Cr(90,1,t,r);c.layers=this.layers,c.up.set(0,0,1),c.lookAt(new lt(0,1,0)),this.add(c);var g=new Cr(90,1,t,r);g.layers=this.layers,g.up.set(0,0,-1),g.lookAt(new lt(0,-1,0)),this.add(g);var p=new Cr(90,1,t,r);p.layers=this.layers,p.up.set(0,-1,0),p.lookAt(new lt(0,0,1)),this.add(p);var A=new Cr(90,1,t,r);A.layers=this.layers,A.up.set(0,-1,0),A.lookAt(new lt(0,0,-1)),this.add(A),this.update=function(S,N){this.parent===null&&this.updateMatrixWorld();var _=S.xr.enabled,I=S.getRenderTarget();S.xr.enabled=!1;var L=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,S.setRenderTarget(i,0),S.render(N,s),S.setRenderTarget(i,1),S.render(N,f),S.setRenderTarget(i,2),S.render(N,c),S.setRenderTarget(i,3),S.render(N,g),S.setRenderTarget(i,4),S.render(N,p),i.texture.generateMipmaps=L,S.setRenderTarget(i,5),S.render(N,A),S.setRenderTarget(I),S.xr.enabled=_},this.clear=function(S,N,_,I){for(var L=S.getRenderTarget(),P=0;6>P;P++)S.setRenderTarget(i,P),S.clear(N,_,I);S.setRenderTarget(L)}}}function Ni(t,r,i){kc(r)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),r=i),bt.call(this,t,t,r)}function Ri(t,r,i,s,f,c,g,p,A,S,N,_){Pt.call(this,null,c,g,p,A,S,s,f,N,_),this.image={data:t||null,width:r||1,height:i||1},this.magFilter=A!==void 0?A:1003,this.minFilter=S!==void 0?S:1003,this.flipY=this.generateMipmaps=!1,this.unpackAlignment=1,this.needsUpdate=!0}function mi(t,r,i,s,f,c){this.planes=[t!==void 0?t:new Wi,r!==void 0?r:new Wi,i!==void 0?i:new Wi,s!==void 0?s:new Wi,f!==void 0?f:new Wi,c!==void 0?c:new Wi]}function fi(){function t(f,c){i!==!1&&(s(f,c),r.requestAnimationFrame(t))}var r=null,i=!1,s=null;return{start:function(){i!==!0&&s!==null&&(r.requestAnimationFrame(t),i=!0)},stop:function(){i=!1},setAnimationLoop:function(f){s=f},setContext:function(f){r=f}}}function Er(t,r){function i(c,g){var p=c.array,A=c.usage,S=t.createBuffer();return t.bindBuffer(g,S),t.bufferData(g,p,A),c.onUploadCallback(),g=5126,p instanceof Float32Array?g=5126:p instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):p instanceof Uint16Array?g=5123:p instanceof Int16Array?g=5122:p instanceof Uint32Array?g=5125:p instanceof Int32Array?g=5124:p instanceof Int8Array?g=5120:p instanceof Uint8Array&&(g=5121),{buffer:S,type:g,bytesPerElement:p.BYTES_PER_ELEMENT,version:c.version}}var s=r.isWebGL2,f=new An;return{get:function(c){return c.isInterleavedBufferAttribute&&(c=c.data),f.get(c)},remove:function(c){c.isInterleavedBufferAttribute&&(c=c.data);var g=f.get(c);g&&(t.deleteBuffer(g.buffer),f.delete(c))},update:function(c,g){c.isInterleavedBufferAttribute&&(c=c.data);var p=f.get(c);if(p===void 0)f.set(c,i(c,g));else if(p.version<c.version){var A=c.array,S=c.updateRange;t.bindBuffer(g,p.buffer),S.count===-1?t.bufferSubData(g,0,A):(s?t.bufferSubData(g,S.offset*A.BYTES_PER_ELEMENT,A,S.offset,S.count):t.bufferSubData(g,S.offset*A.BYTES_PER_ELEMENT,A.subarray(S.offset,S.offset+S.count)),S.count=-1),p.version=c.version}}}}function Lr(t,r,i,s){Le.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:r,widthSegments:i,heightSegments:s},this.fromBufferGeometry(new br(t,r,i,s)),this.mergeVertices()}function br(t,r,i,s){Ge.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:r,widthSegments:i,heightSegments:s},t=t||1,r=r||1;var f=t/2,c=r/2;i=Math.floor(i)||1,s=Math.floor(s)||1;var g=i+1,p=s+1,A=t/i,S=r/s,N=[],_=[],I=[],L=[];for(t=0;t<p;t++){var P=t*S-c;for(r=0;r<g;r++)_.push(r*A-f,-P,0),I.push(0,0,1),L.push(r/i),L.push(1-t/s)}for(t=0;t<s;t++)for(r=0;r<i;r++)f=r+g*(t+1),c=r+1+g*(t+1),p=r+1+g*t,N.push(r+g*t,f,p),N.push(f,c,p);this.setIndex(N),this.setAttribute("position",new We(_,3)),this.setAttribute("normal",new We(I,3)),this.setAttribute("uv",new We(L,2))}function zr(t,r,i,s){function f(I,L){r.buffers.color.setClear(I.r,I.g,I.b,L,s)}var c=new Ue(0),g=0,p,A,S=null,N=0,_=null;return{getClearColor:function(){return c},setClearColor:function(I,L){c.set(I),g=L!==void 0?L:1,f(c,g)},getClearAlpha:function(){return g},setClearAlpha:function(I){g=I,f(c,g)},render:function(I,L,P,F){L=L.background,P=t.xr,(P=P.getSession&&P.getSession())&&P.environmentBlendMode==="additive"&&(L=null),L===null?f(c,g):L&&L.isColor&&(f(L,1),F=!0),(t.autoClear||F)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),L&&(L.isCubeTexture||L.isWebGLCubeRenderTarget||L.mapping===306)?(A===void 0&&(A=new dn(new ty(1,1,1),new $e({type:"BackgroundCubeMaterial",uniforms:Mr(Gh.cube.uniforms),vertexShader:Gh.cube.vertexShader,fragmentShader:Gh.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),A.geometry.deleteAttribute("normal"),A.geometry.deleteAttribute("uv"),A.onBeforeRender=function(W,X,Z){this.matrixWorld.copyPosition(Z.matrixWorld)},Object.defineProperty(A.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(A)),F=L.isWebGLCubeRenderTarget?L.texture:L,A.material.uniforms.envMap.value=F,A.material.uniforms.flipEnvMap.value=F.isCubeTexture?-1:1,(S!==L||N!==F.version||_!==t.toneMapping)&&(A.material.needsUpdate=!0,S=L,N=F.version,_=t.toneMapping),I.unshift(A,A.geometry,A.material,0,0,null)):L&&L.isTexture&&(p===void 0&&(p=new dn(new br(2,2),new $e({type:"BackgroundMaterial",uniforms:Mr(Gh.background.uniforms),vertexShader:Gh.background.vertexShader,fragmentShader:Gh.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),p.geometry.deleteAttribute("normal"),Object.defineProperty(p.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(p)),p.material.uniforms.t2D.value=L,L.matrixAutoUpdate===!0&&L.updateMatrix(),p.material.uniforms.uvTransform.value.copy(L.matrix),(S!==L||N!==L.version||_!==t.toneMapping)&&(p.material.needsUpdate=!0,S=L,N=L.version,_=t.toneMapping),I.unshift(p,p.geometry,p.material,0,0,null))}}}function pi(t,r,i,s){var f=s.isWebGL2,c;this.setMode=function(g){c=g},this.render=function(g,p){t.drawArrays(c,g,p),i.update(p,c)},this.renderInstances=function(g,p,A,S){if(S!==0){if(f){g=t;var N="drawArraysInstanced"}else if(g=r.get("ANGLE_instanced_arrays"),N="drawArraysInstancedANGLE",g===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}g[N](c,p,A,S),i.update(A,c,S)}}}function Tr(t,r,i){function s(tt){if(tt==="highp"){if(0<t.getShaderPrecisionFormat(35633,36338).precision&&0<t.getShaderPrecisionFormat(35632,36338).precision)return"highp";tt="mediump"}return tt==="mediump"&&0<t.getShaderPrecisionFormat(35633,36337).precision&&0<t.getShaderPrecisionFormat(35632,36337).precision?"mediump":"lowp"}var f,c=typeof WebGL2RenderingContext!="undefined"&&t instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&t instanceof WebGL2ComputeRenderingContext,g=i.precision!==void 0?i.precision:"highp",p=s(g);p!==g&&(console.warn("THREE.WebGLRenderer:",g,"not supported, using",p,"instead."),g=p),i=i.logarithmicDepthBuffer===!0,p=t.getParameter(34930);var A=t.getParameter(35660),S=t.getParameter(3379),N=t.getParameter(34076),_=t.getParameter(34921),I=t.getParameter(36347),L=t.getParameter(36348),P=t.getParameter(36349),F=0<A,W=c||!!r.get("OES_texture_float"),X=F&&W,Z=c?t.getParameter(36183):0;return{isWebGL2:c,getMaxAnisotropy:function(){if(f!==void 0)return f;var tt=r.get("EXT_texture_filter_anisotropic");return f=tt!==null?t.getParameter(tt.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:s,precision:g,logarithmicDepthBuffer:i,maxTextures:p,maxVertexTextures:A,maxTextureSize:S,maxCubemapSize:N,maxAttributes:_,maxVertexUniforms:I,maxVaryings:L,maxFragmentUniforms:P,vertexTextures:F,floatFragmentTextures:W,floatVertexTextures:X,maxSamples:Z}}function zi(){function t(){S.value!==s&&(S.value=s,S.needsUpdate=0<f),i.numPlanes=f,i.numIntersection=0}function r(N,_,I,L){var P=N!==null?N.length:0,F=null;if(P!==0){if(F=S.value,L!==!0||F===null)for(L=I+4*P,_=_.matrixWorldInverse,A.getNormalMatrix(_),(F===null||F.length<L)&&(F=new Float32Array(L)),L=0;L!==P;++L,I+=4)p.copy(N[L]).applyMatrix4(_,A),p.normal.toArray(F,I),F[I+3]=p.constant;S.value=F,S.needsUpdate=!0}return i.numPlanes=P,i.numIntersection=0,F}var i=this,s=null,f=0,c=!1,g=!1,p=new Wi,A=new Ft,S={value:null,needsUpdate:!1};this.uniform=S,this.numIntersection=this.numPlanes=0,this.init=function(N,_,I){var L=N.length!==0||_||f!==0||c;return c=_,s=r(N,I,0),f=N.length,L},this.beginShadows=function(){g=!0,r(null)},this.endShadows=function(){g=!1,t()},this.setState=function(N,_,I,L,P,F){if(!c||N===null||N.length===0||g&&!I)g?r(null):t();else{I=g?0:f;var W=4*I,X=P.clippingState||null;for(S.value=X,X=r(N,L,W,F),N=0;N!==W;++N)X[N]=s[N];P.clippingState=X,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=I}}}function gn(t){var r={};return{get:function(i){if(r[i]!==void 0)return r[i];switch(i){case"WEBGL_depth_texture":var s=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=t.getExtension(i)}return s===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r[i]=s}}}function hn(t,r,i){function s(p){var A=p.target;p=c.get(A),p.index!==null&&r.remove(p.index);for(var S in p.attributes)r.remove(p.attributes[S]);A.removeEventListener("dispose",s),c.delete(A),(S=g.get(p))&&(r.remove(S),g.delete(p)),i.memory.geometries--}function f(p){var A=[],S=p.index,N=p.attributes.position;if(S!==null){var _=S.array;S=S.version,N=0;for(var I=_.length;N<I;N+=3){var L=_[N+0],P=_[N+1],F=_[N+2];A.push(L,P,P,F,F,L)}}else for(_=N.array,S=N.version,N=0,I=_.length/3-1;N<I;N+=3)L=N+0,P=N+1,F=N+2,A.push(L,P,P,F,F,L);A=new(65535<Af(A)?al:Ta)(A,1),A.version=S,r.update(A,34963),(_=g.get(p))&&r.remove(_),g.set(p,A)}var c=new An,g=new An;return{get:function(p,A){var S=c.get(A);return S||(A.addEventListener("dispose",s),A.isBufferGeometry?S=A:A.isGeometry&&(A._bufferGeometry===void 0&&(A._bufferGeometry=new Ge().setFromObject(p)),S=A._bufferGeometry),c.set(A,S),i.memory.geometries++,S)},update:function(p){var A=p.index,S=p.attributes;A!==null&&r.update(A,34963);for(var N in S)r.update(S[N],34962);p=p.morphAttributes;for(N in p){A=p[N],S=0;for(var _=A.length;S<_;S++)r.update(A[S],34962)}},getWireframeAttribute:function(p){var A=g.get(p);if(A){var S=p.index;S!==null&&A.version<S.version&&f(p)}else f(p);return g.get(p)}}}function mn(t,r,i,s){var f=s.isWebGL2,c,g,p;this.setMode=function(A){c=A},this.setIndex=function(A){g=A.type,p=A.bytesPerElement},this.render=function(A,S){t.drawElements(c,S,g,A*p),i.update(S,c)},this.renderInstances=function(A,S,N,_){if(_!==0){if(f){A=t;var I="drawElementsInstanced"}else if(A=r.get("ANGLE_instanced_arrays"),I="drawElementsInstancedANGLE",A===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}A[I](c,N,g,S*p,_),i.update(N,c,_)}}}function Ki(t){var r={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:r,programs:null,autoReset:!0,reset:function(){r.frame++,r.calls=0,r.triangles=0,r.points=0,r.lines=0},update:function(i,s,f){switch(f=f||1,r.calls++,s){case 4:r.triangles+=i/3*f;break;case 1:r.lines+=i/2*f;break;case 3:r.lines+=f*(i-1);break;case 2:r.lines+=f*i;break;case 0:r.points+=f*i;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",s)}}}}function $i(t,r){return Math.abs(r[1])-Math.abs(t[1])}function tn(t){var r={},i=new Float32Array(8);return{update:function(s,f,c,g){var p=s.morphTargetInfluences,A=p===void 0?0:p.length;if(s=r[f.id],s===void 0){s=[];for(var S=0;S<A;S++)s[S]=[S,0];r[f.id]=s}var N=c.morphTargets&&f.morphAttributes.position;for(c=c.morphNormals&&f.morphAttributes.normal,S=0;S<A;S++){var _=s[S];_[1]!==0&&(N&&f.deleteAttribute("morphTarget"+S),c&&f.deleteAttribute("morphNormal"+S))}for(S=0;S<A;S++)_=s[S],_[0]=S,_[1]=p[S];for(s.sort($i),S=p=0;8>S;S++){if((_=s[S])&&(A=_[0],_=_[1])){N&&f.setAttribute("morphTarget"+S,N[A]),c&&f.setAttribute("morphNormal"+S,c[A]),i[S]=_,p+=_;continue}i[S]=0}f=f.morphTargetsRelative?1:1-p,g.getUniforms().setValue(t,"morphTargetBaseInfluence",f),g.getUniforms().setValue(t,"morphTargetInfluences",i)}}}function Vi(t,r,i,s){var f=new An;return{update:function(c){var g=s.render.frame,p=c.geometry,A=r.get(c,p);return f.get(A)!==g&&(p.isGeometry&&A.updateFromObject(c),r.update(A),f.set(A,g)),c.isInstancedMesh&&i.update(c.instanceMatrix,34962),A},dispose:function(){f=new An}}}function en(t,r,i,s,f,c,g,p,A,S){t=t!==void 0?t:[],Pt.call(this,t,r!==void 0?r:301,i,s,f,c,g!==void 0?g:1022,p,A,S),this.flipY=!1}function Yi(t,r,i,s){Pt.call(this,null),this.image={data:t||null,width:r||1,height:i||1,depth:s||1},this.minFilter=this.magFilter=1003,this.wrapR=1001,this.flipY=this.generateMipmaps=!1,this.needsUpdate=!0}function xe(t,r,i,s){Pt.call(this,null),this.image={data:t||null,width:r||1,height:i||1,depth:s||1},this.minFilter=this.magFilter=1003,this.wrapR=1001,this.flipY=this.generateMipmaps=!1,this.needsUpdate=!0}function rn(t,r,i){var s=t[0];if(0>=s||0<s)return t;var f=r*i,c=Iw[f];if(c===void 0&&(c=new Float32Array(f),Iw[f]=c),r!==0)for(s.toArray(c,0),s=1,f=0;s!==r;++s)f+=i,t[s].toArray(c,f);return c}function cn(t,r){if(t.length!==r.length)return!1;for(var i=0,s=t.length;i<s;i++)if(t[i]!==r[i])return!1;return!0}function vn(t,r){for(var i=0,s=r.length;i<s;i++)t[i]=r[i]}function nn(t,r){var i=Ew[r];i===void 0&&(i=new Int32Array(r),Ew[r]=i);for(var s=0;s!==r;++s)i[s]=t.allocateTextureUnit();return i}function Jn(t,r){var i=this.cache;i[0]!==r&&(t.uniform1f(this.addr,r),i[0]=r)}function io(t,r){var i=this.cache;r.x!==void 0?(i[0]!==r.x||i[1]!==r.y)&&(t.uniform2f(this.addr,r.x,r.y),i[0]=r.x,i[1]=r.y):cn(i,r)||(t.uniform2fv(this.addr,r),vn(i,r))}function no(t,r){var i=this.cache;r.x!==void 0?(i[0]!==r.x||i[1]!==r.y||i[2]!==r.z)&&(t.uniform3f(this.addr,r.x,r.y,r.z),i[0]=r.x,i[1]=r.y,i[2]=r.z):r.r!==void 0?(i[0]!==r.r||i[1]!==r.g||i[2]!==r.b)&&(t.uniform3f(this.addr,r.r,r.g,r.b),i[0]=r.r,i[1]=r.g,i[2]=r.b):cn(i,r)||(t.uniform3fv(this.addr,r),vn(i,r))}function qa(t,r){var i=this.cache;r.x!==void 0?(i[0]!==r.x||i[1]!==r.y||i[2]!==r.z||i[3]!==r.w)&&(t.uniform4f(this.addr,r.x,r.y,r.z,r.w),i[0]=r.x,i[1]=r.y,i[2]=r.z,i[3]=r.w):cn(i,r)||(t.uniform4fv(this.addr,r),vn(i,r))}function Sa(t,r){var i=this.cache,s=r.elements;s===void 0?cn(i,r)||(t.uniformMatrix2fv(this.addr,!1,r),vn(i,r)):cn(i,s)||(Pw.set(s),t.uniformMatrix2fv(this.addr,!1,Pw),vn(i,s))}function Ln(t,r){var i=this.cache,s=r.elements;s===void 0?cn(i,r)||(t.uniformMatrix3fv(this.addr,!1,r),vn(i,r)):cn(i,s)||(Rw.set(s),t.uniformMatrix3fv(this.addr,!1,Rw),vn(i,s))}function ds(t,r){var i=this.cache,s=r.elements;s===void 0?cn(i,r)||(t.uniformMatrix4fv(this.addr,!1,r),vn(i,r)):cn(i,s)||(Lw.set(s),t.uniformMatrix4fv(this.addr,!1,Lw),vn(i,s))}function na(t,r,i){var s=this.cache,f=i.allocateTextureUnit();s[0]!==f&&(t.uniform1i(this.addr,f),s[0]=f),i.safeSetTexture2D(r||Tw,f)}function Hs(t,r,i){var s=this.cache,f=i.allocateTextureUnit();s[0]!==f&&(t.uniform1i(this.addr,f),s[0]=f),i.setTexture2DArray(r||sC,f)}function Zi(t,r,i){var s=this.cache,f=i.allocateTextureUnit();s[0]!==f&&(t.uniform1i(this.addr,f),s[0]=f),i.setTexture3D(r||aC,f)}function qn(t,r,i){var s=this.cache,f=i.allocateTextureUnit();s[0]!==f&&(t.uniform1i(this.addr,f),s[0]=f),i.safeSetTextureCube(r||Sw,f)}function Ia(t,r){var i=this.cache;i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r)}function Ka(t,r){var i=this.cache;cn(i,r)||(t.uniform2iv(this.addr,r),vn(i,r))}function ul(t,r){var i=this.cache;cn(i,r)||(t.uniform3iv(this.addr,r),vn(i,r))}function Ea(t,r){var i=this.cache;cn(i,r)||(t.uniform4iv(this.addr,r),vn(i,r))}function Qa(t,r){var i=this.cache;i[0]!==r&&(t.uniform1ui(this.addr,r),i[0]=r)}function oa(t){switch(t){case 5126:return Jn;case 35664:return io;case 35665:return no;case 35666:return qa;case 35674:return Sa;case 35675:return Ln;case 35676:return ds;case 5124:case 35670:return Ia;case 35667:case 35671:return Ka;case 35668:case 35672:return ul;case 35669:case 35673:return Ea;case 5125:return Qa;case 35678:case 36198:case 36298:case 36306:case 35682:return na;case 35679:case 36299:case 36307:return Zi;case 35680:case 36300:case 36308:case 36293:return qn;case 36289:case 36303:case 36311:case 36292:return Hs}}function oo(t,r){t.uniform1fv(this.addr,r)}function _u(t,r){t.uniform1iv(this.addr,r)}function ks(t,r){t.uniform2iv(this.addr,r)}function id(t,r){t.uniform3iv(this.addr,r)}function No(t,r){t.uniform4iv(this.addr,r)}function nd(t,r){r=rn(r,this.size,2),t.uniform2fv(this.addr,r)}function nh(t,r){r=rn(r,this.size,3),t.uniform3fv(this.addr,r)}function is(t,r){r=rn(r,this.size,4),t.uniform4fv(this.addr,r)}function wf(t,r){r=rn(r,this.size,4),t.uniformMatrix2fv(this.addr,!1,r)}function od(t,r){r=rn(r,this.size,9),t.uniformMatrix3fv(this.addr,!1,r)}function _f(t,r){r=rn(r,this.size,16),t.uniformMatrix4fv(this.addr,!1,r)}function Gs(t,r,i){var s=r.length,f=nn(i,s);for(t.uniform1iv(this.addr,f),t=0;t!==s;++t)i.safeSetTexture2D(r[t]||Tw,f[t])}function sd(t,r,i){var s=r.length,f=nn(i,s);for(t.uniform1iv(this.addr,f),t=0;t!==s;++t)i.safeSetTextureCube(r[t]||Sw,f[t])}function sa(t){switch(t){case 5126:return oo;case 35664:return nd;case 35665:return nh;case 35666:return is;case 35674:return wf;case 35675:return od;case 35676:return _f;case 5124:case 35670:return _u;case 35667:case 35671:return ks;case 35668:case 35672:return id;case 35669:case 35673:return No;case 35678:case 36198:case 36298:case 36306:case 35682:return Gs;case 35680:case 36300:case 36308:case 36293:return sd}}function ac(t,r,i){this.id=t,this.addr=i,this.cache=[],this.setValue=oa(r.type)}function $a(t,r,i){this.id=t,this.addr=i,this.cache=[],this.size=r.size,this.setValue=sa(r.type)}function uc(t){this.id=t,this.seq=[],this.map={}}function gs(t,r){this.seq=[],this.map={};for(var i=t.getProgramParameter(r,35718),s=0;s<i;++s){var f=t.getActiveUniform(r,s),c=t.getUniformLocation(r,f.name),g=this,p=f.name,A=p.length;for(UA.lastIndex=0;;){var S=UA.exec(p),N=UA.lastIndex,_=S[1],I=S[3];if(S[2]==="]"&&(_|=0),I===void 0||I==="["&&N+2===A){p=g,f=I===void 0?new ac(_,f,c):new $a(_,f,c),p.seq.push(f),p.map[f.id]=f;break}else I=g.map[_],I===void 0&&(I=new uc(_),_=g,g=I,_.seq.push(g),_.map[g.id]=g),g=I}}}function ad(t,r,i){return r=t.createShader(r),t.shaderSource(r,i),t.compileShader(r),r}function ud(t){switch(t){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:throw Error("unsupported encoding: "+t)}}function Mf(t,r,i){var s=t.getShaderParameter(r,35713),f=t.getShaderInfoLog(r).trim();if(s&&f==="")return"";for(t=t.getShaderSource(r).split(`
`),r=0;r<t.length;r++)t[r]=r+1+": "+t[r];return t=t.join(`
`),"THREE.WebGLShader: gl.getShaderInfoLog() "+i+`
`+f+t}function Mu(t,r){return r=ud(r),"vec4 "+t+"( vec4 value ) { return "+r[0]+"ToLinear"+r[1]+"; }"}function ld(t,r){return r=ud(r),"vec4 "+t+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function Sm(t,r){switch(r){case 1:r="Linear";break;case 2:r="Reinhard";break;case 3:r="Uncharted2";break;case 4:r="OptimizedCineon";break;case 5:r="ACESFilmic";break;default:throw Error("unsupported toneMapping: "+r)}return"vec3 "+t+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function Nn(t){var r=[],i;for(i in t){var s=t[i];s!==!1&&r.push("#define "+i+" "+s)}return r.join(`
`)}function oh(t){return t!==""}function lc(t,r){return t.replace(/NUM_DIR_LIGHTS/g,r.numDirLights).replace(/NUM_SPOT_LIGHTS/g,r.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,r.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,r.numPointLights).replace(/NUM_HEMI_LIGHTS/g,r.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,r.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,r.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,r.numPointLightShadows)}function ll(t,r){return t.replace(/NUM_CLIPPING_PLANES/g,r.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,r.numClippingPlanes-r.numClipIntersection)}function hc(t,r){if(t=Gi[r],t===void 0)throw Error("Can not resolve #include <"+r+">");return t.replace(HA,hc)}function Ye(t,r,i,s){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),ms(t,r,i,s)}function ms(t,r,i,s){for(t="",r=parseInt(r);r<parseInt(i);r++)t+=s.replace(/\[ i \]/g,"[ "+r+" ]").replace(/UNROLLED_LOOP_INDEX/g,r);return t}function hd(t){var r="precision "+t.precision+` float;
precision `+t.precision+" int;";return t.precision==="highp"?r+=`
#define HIGH_PRECISION`:t.precision==="mediump"?r+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(r+=`
#define LOW_PRECISION`),r}function on(t){var r="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===1?r="SHADOWMAP_TYPE_PCF":t.shadowMapType===2?r="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===3&&(r="SHADOWMAP_TYPE_VSM"),r}function cd(t){var r="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case 301:case 302:r="ENVMAP_TYPE_CUBE";break;case 306:case 307:r="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:r="ENVMAP_TYPE_EQUIREC";break;case 305:r="ENVMAP_TYPE_SPHERE"}return r}function vs(t){var r="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case 302:case 304:r="ENVMAP_MODE_REFRACTION"}return r}function Cf(t){var r="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case 0:r="ENVMAP_BLENDING_MULTIPLY";break;case 1:r="ENVMAP_BLENDING_MIX";break;case 2:r="ENVMAP_BLENDING_ADD"}return r}function bs(t,r,i){var s=t.getContext(),f=i.defines,c=i.vertexShader,g=i.fragmentShader,p=on(i),A=cd(i),S=vs(i),N=Cf(i),_=0<t.gammaFactor?t.gammaFactor:1,I=i.isWebGL2?"":[i.extensionDerivatives||i.envMapCubeUV||i.bumpMap||i.tangentSpaceNormalMap||i.clearcoatNormalMap||i.flatShading||i.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(i.extensionFragDepth||i.logarithmicDepthBuffer)&&i.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",i.extensionDrawBuffers&&i.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(i.extensionShaderTextureLOD||i.envMap)&&i.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(oh).join(`
`),L=Nn(f),P=s.createProgram();i.isRawShaderMaterial?(f=[L].filter(oh).join(`
`),0<f.length&&(f+=`
`),p=[I,L].filter(oh).join(`
`),0<p.length&&(p+=`
`)):(f=[hd(i),"#define SHADER_NAME "+i.shaderName,L,i.instancing?"#define USE_INSTANCING":"",i.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+_,"#define MAX_BONES "+i.maxBones,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+S:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.useVertexTexture?"#define BONE_TEXTURE":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+p:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(oh).join(`
`),p=[I,hd(i),"#define SHADER_NAME "+i.shaderName,L,i.alphaTest?"#define ALPHATEST "+i.alphaTest+(i.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+_,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+A:"",i.envMap?"#define "+S:"",i.envMap?"#define "+N:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.sheen?"#define USE_SHEEN":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+p:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(i.extensionShaderTextureLOD||i.envMap)&&i.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==0?"#define TONE_MAPPING":"",i.toneMapping!==0?Gi.tonemapping_pars_fragment:"",i.toneMapping!==0?Sm("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.outputEncoding||i.mapEncoding||i.matcapEncoding||i.envMapEncoding||i.emissiveMapEncoding||i.lightMapEncoding?Gi.encodings_pars_fragment:"",i.mapEncoding?Mu("mapTexelToLinear",i.mapEncoding):"",i.matcapEncoding?Mu("matcapTexelToLinear",i.matcapEncoding):"",i.envMapEncoding?Mu("envMapTexelToLinear",i.envMapEncoding):"",i.emissiveMapEncoding?Mu("emissiveMapTexelToLinear",i.emissiveMapEncoding):"",i.lightMapEncoding?Mu("lightMapTexelToLinear",i.lightMapEncoding):"",i.outputEncoding?ld("linearToOutputTexel",i.outputEncoding):"",i.depthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(oh).join(`
`)),c=c.replace(HA,hc),c=lc(c,i),c=ll(c,i),g=g.replace(HA,hc),g=lc(g,i),g=ll(g,i),c=c.replace(Ow,ms).replace(Dw,Ye),g=g.replace(Ow,ms).replace(Dw,Ye),i.isWebGL2&&!i.isRawShaderMaterial&&(A=!1,S=/^\s*#version\s+300\s+es\s*\n/,i.isShaderMaterial&&c.match(S)!==null&&g.match(S)!==null&&(A=!0,c=c.replace(S,""),g=g.replace(S,"")),f=`#version 300 es

#define attribute in
#define varying out
#define texture2D texture
`+f,p=[`#version 300 es

#define varying in`,A?"":"out highp vec4 pc_fragColor;",A?"":"#define gl_FragColor pc_fragColor",`#define gl_FragDepthEXT gl_FragDepth
#define texture2D texture
#define textureCube texture
#define texture2DProj textureProj
#define texture2DLodEXT textureLod
#define texture2DProjLodEXT textureProjLod
#define textureCubeLodEXT textureLod
#define texture2DGradEXT textureGrad
#define texture2DProjGradEXT textureProjGrad
#define textureCubeGradEXT textureGrad`].join(`
`)+`
`+p),g=p+g,c=ad(s,35633,f+c),g=ad(s,35632,g),s.attachShader(P,c),s.attachShader(P,g),i.index0AttributeName!==void 0?s.bindAttribLocation(P,0,i.index0AttributeName):i.morphTargets===!0&&s.bindAttribLocation(P,0,"position"),s.linkProgram(P),t.debug.checkShaderErrors&&(t=s.getProgramInfoLog(P).trim(),A=s.getShaderInfoLog(c).trim(),S=s.getShaderInfoLog(g).trim(),_=N=!0,s.getProgramParameter(P,35714)===!1?(N=!1,I=Mf(s,c,"vertex"),L=Mf(s,g,"fragment"),console.error("THREE.WebGLProgram: shader error: ",s.getError(),"35715",s.getProgramParameter(P,35715),"gl.getProgramInfoLog",t,I,L)):t!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",t):(A===""||S==="")&&(_=!1),_&&(this.diagnostics={runnable:N,programLog:t,vertexShader:{log:A,prefix:f},fragmentShader:{log:S,prefix:p}})),s.deleteShader(c),s.deleteShader(g);var F;this.getUniforms=function(){return F===void 0&&(F=new gs(s,P)),F};var W;return this.getAttributes=function(){if(W===void 0){for(var X={},Z=s.getProgramParameter(P,35721),tt=0;tt<Z;tt++){var ot=s.getActiveAttrib(P,tt).name;X[ot]=s.getAttribLocation(P,ot)}W=X}return W},this.destroy=function(){s.deleteProgram(P),this.program=void 0},this.name=i.shaderName,this.id=uC++,this.cacheKey=r,this.usedTimes=1,this.program=P,this.vertexShader=c,this.fragmentShader=g,this}function fd(t,r,i){function s(L){if(L)L.isTexture?P=L.encoding:L.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),P=L.texture.encoding);else var P=3e3;return P}var f=[],c=i.isWebGL2,g=i.logarithmicDepthBuffer,p=i.floatVertexTextures,A=i.precision,S=i.maxVertexUniforms,N=i.vertexTextures,_={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},I="precision isWebGL2 supportsVertexTextures outputEncoding instancing map mapEncoding matcap matcapEncoding envMap envMapMode envMapEncoding envMapCubeUV lightMap lightMapEncoding aoMap emissiveMap emissiveMapEncoding bumpMap normalMap objectSpaceNormalMap tangentSpaceNormalMap clearcoatMap clearcoatRoughnessMap clearcoatNormalMap displacementMap specularMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors vertexTangents vertexUvs uvsVertexOnly fog useFog fogExp2 flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights numRectAreaLights numDirLightShadows numPointLightShadows numSpotLightShadows shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes numClipIntersection depthPacking dithering sheen".split(" ");this.getParameters=function(L,P,F,W,X,Z,tt){var ot=W.fog;W=L.isMeshStandardMaterial?W.environment:null,W=L.envMap||W;var xt=_[L.type];if(tt.isSkinnedMesh){var At=tt.skeleton.bones;if(p)At=1024;else{var yt=Math.min(Math.floor((S-20)/4),At.length);yt<At.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+At.length+" bones. This GPU supports "+yt+"."),At=0):At=yt}}else At=0;L.precision!==null&&(A=i.getMaxPrecision(L.precision),A!==L.precision&&console.warn("THREE.WebGLProgram.getParameters:",L.precision,"not supported, using",A,"instead.")),xt?(yt=Gh[xt],yt={name:L.type,uniforms:xp.clone(yt.uniforms),vertexShader:yt.vertexShader,fragmentShader:yt.fragmentShader}):yt={name:L.type,uniforms:L.uniforms,vertexShader:L.vertexShader,fragmentShader:L.fragmentShader},L.onBeforeCompile(yt,t);var zt=t.getRenderTarget();return{isWebGL2:c,shaderID:xt,shaderName:yt.name,uniforms:yt.uniforms,vertexShader:yt.vertexShader,fragmentShader:yt.fragmentShader,defines:L.defines,isRawShaderMaterial:L.isRawShaderMaterial,isShaderMaterial:L.isShaderMaterial,precision:A,instancing:tt.isInstancedMesh===!0,supportsVertexTextures:N,outputEncoding:zt!==null?s(zt.texture):t.outputEncoding,map:!!L.map,mapEncoding:s(L.map),matcap:!!L.matcap,matcapEncoding:s(L.matcap),envMap:!!W,envMapMode:W&&W.mapping,envMapEncoding:s(W),envMapCubeUV:!!W&&(W.mapping===306||W.mapping===307),lightMap:!!L.lightMap,lightMapEncoding:s(L.lightMap),aoMap:!!L.aoMap,emissiveMap:!!L.emissiveMap,emissiveMapEncoding:s(L.emissiveMap),bumpMap:!!L.bumpMap,normalMap:!!L.normalMap,objectSpaceNormalMap:L.normalMapType===1,tangentSpaceNormalMap:L.normalMapType===0,clearcoatMap:!!L.clearcoatMap,clearcoatRoughnessMap:!!L.clearcoatRoughnessMap,clearcoatNormalMap:!!L.clearcoatNormalMap,displacementMap:!!L.displacementMap,roughnessMap:!!L.roughnessMap,metalnessMap:!!L.metalnessMap,specularMap:!!L.specularMap,alphaMap:!!L.alphaMap,gradientMap:!!L.gradientMap,sheen:!!L.sheen,combine:L.combine,vertexTangents:L.normalMap&&L.vertexTangents,vertexColors:L.vertexColors,vertexUvs:!!L.map||!!L.bumpMap||!!L.normalMap||!!L.specularMap||!!L.alphaMap||!!L.emissiveMap||!!L.roughnessMap||!!L.metalnessMap||!!L.clearcoatMap||!!L.clearcoatRoughnessMap||!!L.clearcoatNormalMap||!!L.displacementMap,uvsVertexOnly:!(L.map||L.bumpMap||L.normalMap||L.specularMap||L.alphaMap||L.emissiveMap||L.roughnessMap||L.metalnessMap||L.clearcoatNormalMap)&&!!L.displacementMap,fog:!!ot,useFog:L.fog,fogExp2:ot&&ot.isFogExp2,flatShading:L.flatShading,sizeAttenuation:L.sizeAttenuation,logarithmicDepthBuffer:g,skinning:L.skinning&&0<At,maxBones:At,useVertexTexture:p,morphTargets:L.morphTargets,morphNormals:L.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:P.directional.length,numPointLights:P.point.length,numSpotLights:P.spot.length,numRectAreaLights:P.rectArea.length,numHemiLights:P.hemi.length,numDirLightShadows:P.directionalShadowMap.length,numPointLightShadows:P.pointShadowMap.length,numSpotLightShadows:P.spotShadowMap.length,numClippingPlanes:X,numClipIntersection:Z,dithering:L.dithering,shadowMapEnabled:t.shadowMap.enabled&&0<F.length,shadowMapType:t.shadowMap.type,toneMapping:L.toneMapped?t.toneMapping:0,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:L.premultipliedAlpha,alphaTest:L.alphaTest,doubleSided:L.side===2,flipSided:L.side===1,depthPacking:L.depthPacking!==void 0?L.depthPacking:!1,index0AttributeName:L.index0AttributeName,extensionDerivatives:L.extensions&&L.extensions.derivatives,extensionFragDepth:L.extensions&&L.extensions.fragDepth,extensionDrawBuffers:L.extensions&&L.extensions.drawBuffers,extensionShaderTextureLOD:L.extensions&&L.extensions.shaderTextureLOD,rendererExtensionFragDepth:c||r.get("EXT_frag_depth")!==null,rendererExtensionDrawBuffers:c||r.get("WEBGL_draw_buffers")!==null,rendererExtensionShaderTextureLod:c||r.get("EXT_shader_texture_lod")!==null,onBeforeCompile:L.onBeforeCompile}},this.getProgramCacheKey=function(L){var P=[];if(L.shaderID?P.push(L.shaderID):(P.push(L.fragmentShader),P.push(L.vertexShader)),L.defines!==void 0)for(var F in L.defines)P.push(F),P.push(L.defines[F]);if(L.isRawShaderMaterial===void 0){for(F=0;F<I.length;F++)P.push(L[I[F]]);P.push(t.outputEncoding),P.push(t.gammaFactor)}return P.push(L.onBeforeCompile.toString()),P.join()},this.acquireProgram=function(L,P){for(var F,W=0,X=f.length;W<X;W++){var Z=f[W];if(Z.cacheKey===P){F=Z,++F.usedTimes;break}}return F===void 0&&(F=new bs(t,P,L),f.push(F)),F},this.releaseProgram=function(L){if(--L.usedTimes==0){var P=f.indexOf(L);f[P]=f[f.length-1],f.pop(),L.destroy()}},this.programs=f}function pd(){var t=new An;return{get:function(r){var i=t.get(r);return i===void 0&&(i={},t.set(r,i)),i},remove:function(r){t.delete(r)},update:function(r,i,s){t.get(r)[i]=s},dispose:function(){t=new An}}}function Tf(t,r){return t.groupOrder!==r.groupOrder?t.groupOrder-r.groupOrder:t.renderOrder!==r.renderOrder?t.renderOrder-r.renderOrder:t.program!==r.program?t.program.id-r.program.id:t.material.id!==r.material.id?t.material.id-r.material.id:t.z!==r.z?t.z-r.z:t.id-r.id}function Kn(t,r){return t.groupOrder!==r.groupOrder?t.groupOrder-r.groupOrder:t.renderOrder!==r.renderOrder?t.renderOrder-r.renderOrder:t.z!==r.z?r.z-t.z:t.id-r.id}function ki(){function t(g,p,A,S,N,_){var I=r[i];return I===void 0?(I={id:g.id,object:g,geometry:p,material:A,program:A.program||c,groupOrder:S,renderOrder:g.renderOrder,z:N,group:_},r[i]=I):(I.id=g.id,I.object=g,I.geometry=p,I.material=A,I.program=A.program||c,I.groupOrder=S,I.renderOrder=g.renderOrder,I.z=N,I.group=_),i++,I}var r=[],i=0,s=[],f=[],c={id:-1};return{opaque:s,transparent:f,init:function(){i=0,s.length=0,f.length=0},push:function(g,p,A,S,N,_){g=t(g,p,A,S,N,_),(A.transparent===!0?f:s).push(g)},unshift:function(g,p,A,S,N,_){g=t(g,p,A,S,N,_),(A.transparent===!0?f:s).unshift(g)},finish:function(){for(var g=i,p=r.length;g<p;g++){var A=r[g];if(A.id===null)break;A.id=null,A.object=null,A.geometry=null,A.material=null,A.program=null,A.group=null}},sort:function(g,p){1<s.length&&s.sort(g||Tf),1<f.length&&f.sort(p||Kn)}}}function wi(){function t(i){i=i.target,i.removeEventListener("dispose",t),r.delete(i)}var r=new An;return{get:function(i,s){var f=r.get(i);if(f===void 0){var c=new ki;r.set(i,new An),r.get(i).set(s,c),i.addEventListener("dispose",t)}else c=f.get(s),c===void 0&&(c=new ki,f.set(s,c));return c},dispose:function(){r=new An}}}function co(){var t={};return{get:function(r){if(t[r.id]!==void 0)return t[r.id];switch(r.type){case"DirectionalLight":var i={direction:new lt,color:new Ue};break;case"SpotLight":i={position:new lt,direction:new lt,color:new Ue,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new lt,color:new Ue,distance:0,decay:0};break;case"HemisphereLight":i={direction:new lt,skyColor:new Ue,groundColor:new Ue};break;case"RectAreaLight":i={color:new Ue,position:new lt,halfWidth:new lt,halfHeight:new lt}}return t[r.id]=i}}}function Qr(){var t={};return{get:function(r){if(t[r.id]!==void 0)return t[r.id];switch(r.type){case"DirectionalLight":var i={shadowBias:0,shadowRadius:1,shadowMapSize:new st};break;case"SpotLight":i={shadowBias:0,shadowRadius:1,shadowMapSize:new st};break;case"PointLight":i={shadowBias:0,shadowRadius:1,shadowMapSize:new st,shadowCameraNear:1,shadowCameraFar:1e3}}return t[r.id]=i}}}function ei(t,r){return(r.castShadow?1:0)-(t.castShadow?1:0)}function Vs(){for(var t=new co,r=Qr(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},s=0;9>s;s++)i.probe.push(new lt);var f=new lt,c=new ye,g=new ye;return{setup:function(p,A,S){for(var N=0,_=0,I=0,L=0;9>L;L++)i.probe[L].set(0,0,0);var P=A=0,F=0,W=0,X=0,Z=0,tt=0,ot=0;S=S.matrixWorldInverse,p.sort(ei),L=0;for(var xt=p.length;L<xt;L++){var At=p[L],yt=At.color,zt=At.intensity,Ht=At.distance,$t=At.shadow&&At.shadow.map?At.shadow.map.texture:null;if(At.isAmbientLight)N+=yt.r*zt,_+=yt.g*zt,I+=yt.b*zt;else if(At.isLightProbe)for($t=0;9>$t;$t++)i.probe[$t].addScaledVector(At.sh.coefficients[$t],zt);else if(At.isDirectionalLight){var Vt=t.get(At);Vt.color.copy(At.color).multiplyScalar(At.intensity),Vt.direction.setFromMatrixPosition(At.matrixWorld),f.setFromMatrixPosition(At.target.matrixWorld),Vt.direction.sub(f),Vt.direction.transformDirection(S),At.castShadow&&(zt=At.shadow,yt=r.get(At),yt.shadowBias=zt.bias,yt.shadowRadius=zt.radius,yt.shadowMapSize=zt.mapSize,i.directionalShadow[A]=yt,i.directionalShadowMap[A]=$t,i.directionalShadowMatrix[A]=At.shadow.matrix,Z++),i.directional[A]=Vt,A++}else At.isSpotLight?(Vt=t.get(At),Vt.position.setFromMatrixPosition(At.matrixWorld),Vt.position.applyMatrix4(S),Vt.color.copy(yt).multiplyScalar(zt),Vt.distance=Ht,Vt.direction.setFromMatrixPosition(At.matrixWorld),f.setFromMatrixPosition(At.target.matrixWorld),Vt.direction.sub(f),Vt.direction.transformDirection(S),Vt.coneCos=Math.cos(At.angle),Vt.penumbraCos=Math.cos(At.angle*(1-At.penumbra)),Vt.decay=At.decay,At.castShadow&&(zt=At.shadow,yt=r.get(At),yt.shadowBias=zt.bias,yt.shadowRadius=zt.radius,yt.shadowMapSize=zt.mapSize,i.spotShadow[F]=yt,i.spotShadowMap[F]=$t,i.spotShadowMatrix[F]=At.shadow.matrix,ot++),i.spot[F]=Vt,F++):At.isRectAreaLight?(Vt=t.get(At),Vt.color.copy(yt).multiplyScalar(zt),Vt.position.setFromMatrixPosition(At.matrixWorld),Vt.position.applyMatrix4(S),g.identity(),c.copy(At.matrixWorld),c.premultiply(S),g.extractRotation(c),Vt.halfWidth.set(.5*At.width,0,0),Vt.halfHeight.set(0,.5*At.height,0),Vt.halfWidth.applyMatrix4(g),Vt.halfHeight.applyMatrix4(g),i.rectArea[W]=Vt,W++):At.isPointLight?(Vt=t.get(At),Vt.position.setFromMatrixPosition(At.matrixWorld),Vt.position.applyMatrix4(S),Vt.color.copy(At.color).multiplyScalar(At.intensity),Vt.distance=At.distance,Vt.decay=At.decay,At.castShadow&&(zt=At.shadow,yt=r.get(At),yt.shadowBias=zt.bias,yt.shadowRadius=zt.radius,yt.shadowMapSize=zt.mapSize,yt.shadowCameraNear=zt.camera.near,yt.shadowCameraFar=zt.camera.far,i.pointShadow[P]=yt,i.pointShadowMap[P]=$t,i.pointShadowMatrix[P]=At.shadow.matrix,tt++),i.point[P]=Vt,P++):At.isHemisphereLight&&(Vt=t.get(At),Vt.direction.setFromMatrixPosition(At.matrixWorld),Vt.direction.transformDirection(S),Vt.direction.normalize(),Vt.skyColor.copy(At.color).multiplyScalar(zt),Vt.groundColor.copy(At.groundColor).multiplyScalar(zt),i.hemi[X]=Vt,X++)}i.ambient[0]=N,i.ambient[1]=_,i.ambient[2]=I,p=i.hash,(p.directionalLength!==A||p.pointLength!==P||p.spotLength!==F||p.rectAreaLength!==W||p.hemiLength!==X||p.numDirectionalShadows!==Z||p.numPointShadows!==tt||p.numSpotShadows!==ot)&&(i.directional.length=A,i.spot.length=F,i.rectArea.length=W,i.point.length=P,i.hemi.length=X,i.directionalShadow.length=Z,i.directionalShadowMap.length=Z,i.pointShadow.length=tt,i.pointShadowMap.length=tt,i.spotShadow.length=ot,i.spotShadowMap.length=ot,i.directionalShadowMatrix.length=Z,i.pointShadowMatrix.length=tt,i.spotShadowMatrix.length=ot,p.directionalLength=A,p.pointLength=P,p.spotLength=F,p.rectAreaLength=W,p.hemiLength=X,p.numDirectionalShadows=Z,p.numPointShadows=tt,p.numSpotShadows=ot,i.version=lC++)},state:i}}function La(){var t=new Vs,r=[],i=[];return{init:function(){r.length=0,i.length=0},state:{lightsArray:r,shadowsArray:i,lights:t},setupLights:function(s){t.setup(r,i,s)},pushLight:function(s){r.push(s)},pushShadow:function(s){i.push(s)}}}function sh(){function t(i){i=i.target,i.removeEventListener("dispose",t),r.delete(i)}var r=new An;return{get:function(i,s){if(r.has(i)===!1){var f=new La;r.set(i,new An),r.get(i).set(s,f),i.addEventListener("dispose",t)}else r.get(i).has(s)===!1?(f=new La,r.get(i).set(s,f)):f=r.get(i).get(s);return f},dispose:function(){r=new An}}}function Ws(t){kr.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}function Ra(t){kr.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new lt,this.nearDistance=1,this.farDistance=1e3,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}function tu(t,r,i){function s(ot,xt,At){At=ot<<0|xt<<1|At<<2;var yt=_[At];return yt===void 0&&(yt=new Ws({depthPacking:3201,morphTargets:ot,skinning:xt}),_[At]=yt),yt}function f(ot,xt,At){At=ot<<0|xt<<1|At<<2;var yt=I[At];return yt===void 0&&(yt=new Ra({morphTargets:ot,skinning:xt}),I[At]=yt),yt}function c(ot,xt,At,yt,zt,Ht,$t){var Vt=s,Kt=ot.customDepthMaterial;return yt.isPointLight===!0&&(Vt=f,Kt=ot.customDistanceMaterial),Kt===void 0?(Kt=!1,At.morphTargets===!0&&(Kt=xt.morphAttributes&&xt.morphAttributes.position&&0<xt.morphAttributes.position.length),xt=!1,ot.isSkinnedMesh===!0&&(At.skinning===!0?xt=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",ot)),ot=Vt(Kt,xt,ot.isInstancedMesh===!0)):ot=Kt,t.localClippingEnabled&&At.clipShadows===!0&&At.clippingPlanes.length!==0&&(Kt=ot.uuid,Vt=At.uuid,xt=L[Kt],xt===void 0&&(xt={},L[Kt]=xt),Kt=xt[Vt],Kt===void 0&&(Kt=ot.clone(),xt[Vt]=Kt),ot=Kt),ot.visible=At.visible,ot.wireframe=At.wireframe,ot.side=$t===3?At.shadowSide!==null?At.shadowSide:At.side:At.shadowSide!==null?At.shadowSide:P[At.side],ot.clipShadows=At.clipShadows,ot.clippingPlanes=At.clippingPlanes,ot.clipIntersection=At.clipIntersection,ot.wireframeLinewidth=At.wireframeLinewidth,ot.linewidth=At.linewidth,yt.isPointLight===!0&&ot.isMeshDistanceMaterial===!0&&(ot.referencePosition.setFromMatrixPosition(yt.matrixWorld),ot.nearDistance=zt,ot.farDistance=Ht),ot}function g(ot,xt,At,yt,zt){if(ot.visible!==!1){if(ot.layers.test(xt.layers)&&(ot.isMesh||ot.isLine||ot.isPoints)&&(ot.castShadow||ot.receiveShadow&&zt===3)&&(!ot.frustumCulled||p.intersectsObject(ot))){ot.modelViewMatrix.multiplyMatrices(At.matrixWorldInverse,ot.matrixWorld);var Ht=r.update(ot),$t=ot.material;if(Array.isArray($t))for(var Vt=Ht.groups,Kt=0,ze=Vt.length;Kt<ze;Kt++){var ae=Vt[Kt],Qe=$t[ae.materialIndex];Qe&&Qe.visible&&(Qe=c(ot,Ht,Qe,yt,At.near,At.far,zt),t.renderBufferDirect(At,null,Ht,Qe,ot,ae))}else $t.visible&&(Qe=c(ot,Ht,$t,yt,At.near,At.far,zt),t.renderBufferDirect(At,null,Ht,Qe,ot,null))}for(ot=ot.children,Ht=0,$t=ot.length;Ht<$t;Ht++)g(ot[Ht],xt,At,yt,zt)}}var p=new mi,A=new st,S=new st,N=new It,_=[],I=[],L={},P={0:1,1:0,2:2},F=new $e({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:.125},uniforms:{shadow_pass:{value:null},resolution:{value:new st},radius:{value:4}},vertexShader:`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
  float mean = 0.0;
  float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );
  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
    #ifdef HORIZONAL_PASS
      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
      mean += distribution.x;
      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
    #else
      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );
      mean += depth;
      squared_mean += depth * depth;
    #endif
  }
  mean = mean * HALF_SAMPLE_RATE;
  squared_mean = squared_mean * HALF_SAMPLE_RATE;
  float std_dev = sqrt( squared_mean - mean * mean );
  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`}),W=F.clone();W.defines.HORIZONAL_PASS=1;var X=new Ge;X.setAttribute("position",new Ir(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var Z=new dn(X,F),tt=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(ot,xt,At){if(tt.enabled!==!1&&(tt.autoUpdate!==!1||tt.needsUpdate!==!1)&&ot.length!==0){var yt=t.getRenderTarget(),zt=t.getActiveCubeFace(),Ht=t.getActiveMipmapLevel(),$t=t.state;$t.setBlending(0),$t.buffers.color.setClear(1,1,1,1),$t.buffers.depth.setTest(!0),$t.setScissorTest(!1);for(var Vt=0,Kt=ot.length;Vt<Kt;Vt++){var ze=ot[Vt],ae=ze.shadow;if(ae===void 0)console.warn("THREE.WebGLShadowMap:",ze,"has no shadow.");else{A.copy(ae.mapSize);var Qe=ae.getFrameExtents();A.multiply(Qe),S.copy(ae.mapSize),(A.x>i||A.y>i)&&(A.x>i&&(S.x=Math.floor(i/Qe.x),A.x=S.x*Qe.x,ae.mapSize.x=S.x),A.y>i&&(S.y=Math.floor(i/Qe.y),A.y=S.y*Qe.y,ae.mapSize.y=S.y)),ae.map!==null||ae.isPointLightShadow||this.type!==3||(Qe={minFilter:1006,magFilter:1006,format:1023},ae.map=new bt(A.x,A.y,Qe),ae.map.texture.name=ze.name+".shadowMap",ae.mapPass=new bt(A.x,A.y,Qe),ae.camera.updateProjectionMatrix()),ae.map===null&&(Qe={minFilter:1003,magFilter:1003,format:1023},ae.map=new bt(A.x,A.y,Qe),ae.map.texture.name=ze.name+".shadowMap",ae.camera.updateProjectionMatrix()),t.setRenderTarget(ae.map),t.clear(),Qe=ae.getViewportCount();for(var gr=0;gr<Qe;gr++){var ir=ae.getViewport(gr);N.set(S.x*ir.x,S.y*ir.y,S.x*ir.z,S.y*ir.w),$t.viewport(N),ae.updateMatrices(ze,gr),p=ae.getFrustum(),g(xt,At,ae.camera,ze,this.type)}ae.isPointLightShadow||this.type!==3||(ze=ae,ae=At,Qe=r.update(Z),F.uniforms.shadow_pass.value=ze.map.texture,F.uniforms.resolution.value=ze.mapSize,F.uniforms.radius.value=ze.radius,t.setRenderTarget(ze.mapPass),t.clear(),t.renderBufferDirect(ae,null,Qe,F,Z,null),W.uniforms.shadow_pass.value=ze.mapPass.texture,W.uniforms.resolution.value=ze.mapSize,W.uniforms.radius.value=ze.radius,t.setRenderTarget(ze.map),t.clear(),t.renderBufferDirect(ae,null,Qe,W,Z,null))}}tt.needsUpdate=!1,t.setRenderTarget(yt,zt,Ht)}}}function Im(t,r,i){function s(pt,me,Ae){var de=new Uint8Array(4),ie=t.createTexture();for(t.bindTexture(pt,ie),t.texParameteri(pt,10241,9728),t.texParameteri(pt,10240,9728),pt=0;pt<Ae;pt++)t.texImage2D(me+pt,0,6408,1,1,0,6408,5121,de);return ie}function f(pt,me){Z[pt]=1,tt[pt]===0&&(t.enableVertexAttribArray(pt),tt[pt]=1),ot[pt]!==me&&((P?t:r.get("ANGLE_instanced_arrays"))[P?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](pt,me),ot[pt]=me)}function c(pt){xt[pt]!==!0&&(t.enable(pt),xt[pt]=!0)}function g(pt){xt[pt]!==!1&&(t.disable(pt),xt[pt]=!1)}function p(pt,me,Ae,de,ie,Te,mr,Nr){if(pt===0)yt&&(g(3042),yt=!1);else if(yt||(c(3042),yt=!0),pt!==5){if(pt!==zt||Nr!==Qe){if((Ht!==100||Kt!==100)&&(t.blendEquation(32774),Kt=Ht=100),Nr)switch(pt){case 1:t.blendFuncSeparate(1,771,1,771);break;case 2:t.blendFunc(1,1);break;case 3:t.blendFuncSeparate(0,0,769,771);break;case 4:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",pt)}else switch(pt){case 1:t.blendFuncSeparate(770,771,1,771);break;case 2:t.blendFunc(770,1);break;case 3:t.blendFunc(0,769);break;case 4:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",pt)}ae=ze=Vt=$t=null,zt=pt,Qe=Nr}}else ie=ie||me,Te=Te||Ae,mr=mr||de,(me!==Ht||ie!==Kt)&&(t.blendEquationSeparate(kt[me],kt[ie]),Ht=me,Kt=ie),(Ae!==$t||de!==Vt||Te!==ze||mr!==ae)&&(t.blendFuncSeparate(Jt[Ae],Jt[de],Jt[Te],Jt[mr]),$t=Ae,Vt=de,ze=Te,ae=mr),zt=pt,Qe=null}function A(pt){gr!==pt&&(pt?t.frontFace(2304):t.frontFace(2305),gr=pt)}function S(pt){pt!==0?(c(2884),pt!==ir&&(pt===1?t.cullFace(1029):pt===2?t.cullFace(1028):t.cullFace(1032))):g(2884),ir=pt}function N(pt,me,Ae){pt?(c(32823),(hr!==me||gt!==Ae)&&(t.polygonOffset(me,Ae),hr=me,gt=Ae)):g(32823)}function _(pt){pt===void 0&&(pt=33984+mt-1),Ct!==pt&&(t.activeTexture(pt),Ct=pt)}var I,L,P=i.isWebGL2,F=new function(){var pt=!1,me=new It,Ae=null,de=new It(0,0,0,0);return{setMask:function(ie){Ae===ie||pt||(t.colorMask(ie,ie,ie,ie),Ae=ie)},setLocked:function(ie){pt=ie},setClear:function(ie,Te,mr,Nr,we){we===!0&&(ie*=Nr,Te*=Nr,mr*=Nr),me.set(ie,Te,mr,Nr),de.equals(me)===!1&&(t.clearColor(ie,Te,mr,Nr),de.copy(me))},reset:function(){pt=!1,Ae=null,de.set(-1,0,0,0)}}},W=new function(){var pt=!1,me=null,Ae=null,de=null;return{setTest:function(ie){ie?c(2929):g(2929)},setMask:function(ie){me===ie||pt||(t.depthMask(ie),me=ie)},setFunc:function(ie){if(Ae!==ie){if(ie)switch(ie){case 0:t.depthFunc(512);break;case 1:t.depthFunc(519);break;case 2:t.depthFunc(513);break;case 3:t.depthFunc(515);break;case 4:t.depthFunc(514);break;case 5:t.depthFunc(518);break;case 6:t.depthFunc(516);break;case 7:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);Ae=ie}},setLocked:function(ie){pt=ie},setClear:function(ie){de!==ie&&(t.clearDepth(ie),de=ie)},reset:function(){pt=!1,de=Ae=me=null}}},X=new function(){var pt=!1,me=null,Ae=null,de=null,ie=null,Te=null,mr=null,Nr=null,we=null;return{setTest:function(nr){pt||(nr?c(2960):g(2960))},setMask:function(nr){me===nr||pt||(t.stencilMask(nr),me=nr)},setFunc:function(nr,Jr,je){(Ae!==nr||de!==Jr||ie!==je)&&(t.stencilFunc(nr,Jr,je),Ae=nr,de=Jr,ie=je)},setOp:function(nr,Jr,je){(Te!==nr||mr!==Jr||Nr!==je)&&(t.stencilOp(nr,Jr,je),Te=nr,mr=Jr,Nr=je)},setLocked:function(nr){pt=nr},setClear:function(nr){we!==nr&&(t.clearStencil(nr),we=nr)},reset:function(){pt=!1,we=Nr=mr=Te=ie=de=Ae=me=null}}};i=t.getParameter(34921);var Z=new Uint8Array(i),tt=new Uint8Array(i),ot=new Uint8Array(i),xt={},At=null,yt=null,zt=null,Ht=null,$t=null,Vt=null,Kt=null,ze=null,ae=null,Qe=!1,gr=null,ir=null,gi=null,hr=null,gt=null,mt=t.getParameter(35661),vt=!1;i=0,i=t.getParameter(7938),i.indexOf("WebGL")!==-1?(i=parseFloat(/^WebGL ([0-9])/.exec(i)[1]),vt=1<=i):i.indexOf("OpenGL ES")!==-1&&(i=parseFloat(/^OpenGL ES ([0-9])/.exec(i)[1]),vt=2<=i);var Ct=null,et={},ct=new It,ft=new It,Tt={};Tt[3553]=s(3553,3553,1),Tt[34067]=s(34067,34069,6),F.setClear(0,0,0,1),W.setClear(1),X.setClear(0),c(2929),W.setFunc(3),A(!1),S(1),c(2884),p(0);var kt=(I={},an(I,100,32774),an(I,101,32778),an(I,102,32779),I);P?(kt[103]=32775,kt[104]=32776):(I=r.get("EXT_blend_minmax"),I!==null&&(kt[103]=I.MIN_EXT,kt[104]=I.MAX_EXT));var Jt=(L={},an(L,200,0),an(L,201,1),an(L,202,768),an(L,204,770),an(L,210,776),an(L,208,774),an(L,206,772),an(L,203,769),an(L,205,771),an(L,209,775),an(L,207,773),L);return{buffers:{color:F,depth:W,stencil:X},initAttributes:function(){for(var pt=0,me=Z.length;pt<me;pt++)Z[pt]=0},enableAttribute:function(pt){f(pt,0)},enableAttributeAndDivisor:f,disableUnusedAttributes:function(){for(var pt=0,me=tt.length;pt!==me;++pt)tt[pt]!==Z[pt]&&(t.disableVertexAttribArray(pt),tt[pt]=0)},vertexAttribPointer:function(pt,me,Ae,de,ie,Te){P!==!0||Ae!==5124&&Ae!==5125?t.vertexAttribPointer(pt,me,Ae,de,ie,Te):t.vertexAttribIPointer(pt,me,Ae,de,ie,Te)},enable:c,disable:g,useProgram:function(pt){return At!==pt?(t.useProgram(pt),At=pt,!0):!1},setBlending:p,setMaterial:function(pt,me){pt.side===2?g(2884):c(2884);var Ae=pt.side===1;me&&(Ae=!Ae),A(Ae),pt.blending===1&&pt.transparent===!1?p(0):p(pt.blending,pt.blendEquation,pt.blendSrc,pt.blendDst,pt.blendEquationAlpha,pt.blendSrcAlpha,pt.blendDstAlpha,pt.premultipliedAlpha),W.setFunc(pt.depthFunc),W.setTest(pt.depthTest),W.setMask(pt.depthWrite),F.setMask(pt.colorWrite),me=pt.stencilWrite,X.setTest(me),me&&(X.setMask(pt.stencilWriteMask),X.setFunc(pt.stencilFunc,pt.stencilRef,pt.stencilFuncMask),X.setOp(pt.stencilFail,pt.stencilZFail,pt.stencilZPass)),N(pt.polygonOffset,pt.polygonOffsetFactor,pt.polygonOffsetUnits)},setFlipSided:A,setCullFace:S,setLineWidth:function(pt){pt!==gi&&(vt&&t.lineWidth(pt),gi=pt)},setPolygonOffset:N,setScissorTest:function(pt){pt?c(3089):g(3089)},activeTexture:_,bindTexture:function(pt,me){Ct===null&&_();var Ae=et[Ct];Ae===void 0&&(Ae={type:void 0,texture:void 0},et[Ct]=Ae),(Ae.type!==pt||Ae.texture!==me)&&(t.bindTexture(pt,me||Tt[pt]),Ae.type=pt,Ae.texture=me)},unbindTexture:function(){var pt=et[Ct];pt!==void 0&&pt.type!==void 0&&(t.bindTexture(pt.type,null),pt.type=void 0,pt.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(pt){console.error("THREE.WebGLState:",pt)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(pt){console.error("THREE.WebGLState:",pt)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(pt){console.error("THREE.WebGLState:",pt)}},scissor:function(pt){ct.equals(pt)===!1&&(t.scissor(pt.x,pt.y,pt.z,pt.w),ct.copy(pt))},viewport:function(pt){ft.equals(pt)===!1&&(t.viewport(pt.x,pt.y,pt.z,pt.w),ft.copy(pt))},reset:function(){for(var pt=0;pt<tt.length;pt++)tt[pt]===1&&(t.disableVertexAttribArray(pt),tt[pt]=0);xt={},Ct=null,et={},ir=gr=zt=At=null,F.reset(),W.reset(),X.reset()}}}function Yx(t,r,i,s,f,c,g){function p(et,ct){return gi?new OffscreenCanvas(et,ct):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function A(et,ct,ft,Tt){var kt=1;if((et.width>Tt||et.height>Tt)&&(kt=Tt/Math.max(et.width,et.height)),1>kt||ct===!0){if(typeof HTMLImageElement!="undefined"&&et instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&et instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&et instanceof ImageBitmap)return Tt=ct?Ar.floorPowerOfTwo:Math.floor,ct=Tt(kt*et.width),kt=Tt(kt*et.height),ir===void 0&&(ir=p(ct,kt)),ft=ft?p(ct,kt):ir,ft.width=ct,ft.height=kt,ft.getContext("2d").drawImage(et,0,0,ct,kt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+et.width+"x"+et.height+") to ("+ct+"x"+kt+")."),ft;"data"in et&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+et.width+"x"+et.height+").")}return et}function S(et){return Ar.isPowerOfTwo(et.width)&&Ar.isPowerOfTwo(et.height)}function N(et,ct){return et.generateMipmaps&&ct&&et.minFilter!==1003&&et.minFilter!==1006}function _(et,ct,ft,Tt){t.generateMipmap(et),s.get(ct).__maxMipLevel=Math.log(Math.max(ft,Tt))*Math.LOG2E}function I(et,ct,ft){if(Vt===!1)return ct;if(et!==null){if(t[et]!==void 0)return t[et];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+et+"'")}return et=ct,ct===6403&&(ft===5126&&(et=33326),ft===5131&&(et=33325),ft===5121&&(et=33321)),ct===6407&&(ft===5126&&(et=34837),ft===5131&&(et=34843),ft===5121&&(et=32849)),ct===6408&&(ft===5126&&(et=34836),ft===5131&&(et=34842),ft===5121&&(et=32856)),et!==33325&&et!==33326&&et!==34842&&et!==34836||r.get("EXT_color_buffer_float"),et}function L(et){return et===1003||et===1004||et===1005?9728:9729}function P(et){et=et.target,et.removeEventListener("dispose",P);var ct=s.get(et);ct.__webglInit!==void 0&&(t.deleteTexture(ct.__webglTexture),s.remove(et)),et.isVideoTexture&&gr.delete(et),g.memory.textures--}function F(et){et=et.target,et.removeEventListener("dispose",F);var ct=s.get(et),ft=s.get(et.texture);if(et){if(ft.__webglTexture!==void 0&&t.deleteTexture(ft.__webglTexture),et.depthTexture&&et.depthTexture.dispose(),et.isWebGLCubeRenderTarget)for(ft=0;6>ft;ft++)t.deleteFramebuffer(ct.__webglFramebuffer[ft]),ct.__webglDepthbuffer&&t.deleteRenderbuffer(ct.__webglDepthbuffer[ft]);else t.deleteFramebuffer(ct.__webglFramebuffer),ct.__webglDepthbuffer&&t.deleteRenderbuffer(ct.__webglDepthbuffer),ct.__webglMultisampledFramebuffer&&t.deleteFramebuffer(ct.__webglMultisampledFramebuffer),ct.__webglColorRenderbuffer&&t.deleteRenderbuffer(ct.__webglColorRenderbuffer),ct.__webglDepthRenderbuffer&&t.deleteRenderbuffer(ct.__webglDepthRenderbuffer);s.remove(et.texture),s.remove(et)}g.memory.textures--}function W(et,ct){var ft=s.get(et);if(et.isVideoTexture){var Tt=g.render.frame;gr.get(et)!==Tt&&(gr.set(et,Tt),et.update())}if(0<et.version&&ft.__version!==et.version)if(Tt=et.image,Tt===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(Tt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{xt(ft,et,ct);return}i.activeTexture(33984+ct),i.bindTexture(3553,ft.__webglTexture)}function X(et,ct){if(et.image.length===6){var ft=s.get(et);if(0<et.version&&ft.__version!==et.version){ot(ft,et),i.activeTexture(33984+ct),i.bindTexture(34067,ft.__webglTexture),t.pixelStorei(37440,et.flipY);var Tt=et&&(et.isCompressedTexture||et.image[0].isCompressedTexture);ct=et.image[0]&&et.image[0].isDataTexture;for(var kt=[],Jt=0;6>Jt;Jt++)kt[Jt]=Tt||ct?ct?et.image[Jt].image:et.image[Jt]:A(et.image[Jt],!1,!0,ze);var pt=kt[0],me=S(pt)||Vt,Ae=c.convert(et.format),de=c.convert(et.type),ie=I(et.internalFormat,Ae,de);if(tt(34067,et,me),Tt){for(Jt=0;6>Jt;Jt++){var Te=kt[Jt].mipmaps;for(Tt=0;Tt<Te.length;Tt++){var mr=Te[Tt];et.format!==1023&&et.format!==1022?Ae!==null?i.compressedTexImage2D(34069+Jt,Tt,ie,mr.width,mr.height,0,mr.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):i.texImage2D(34069+Jt,Tt,ie,mr.width,mr.height,0,Ae,de,mr.data)}}ft.__maxMipLevel=Te.length-1}else{for(Te=et.mipmaps,Jt=0;6>Jt;Jt++)if(ct)for(i.texImage2D(34069+Jt,0,ie,kt[Jt].width,kt[Jt].height,0,Ae,de,kt[Jt].data),Tt=0;Tt<Te.length;Tt++)mr=Te[Tt],mr=mr.image[Jt].image,i.texImage2D(34069+Jt,Tt+1,ie,mr.width,mr.height,0,Ae,de,mr.data);else for(i.texImage2D(34069+Jt,0,ie,Ae,de,kt[Jt]),Tt=0;Tt<Te.length;Tt++)mr=Te[Tt],i.texImage2D(34069+Jt,Tt+1,ie,Ae,de,mr.image[Jt]);ft.__maxMipLevel=Te.length}N(et,me)&&_(34067,et,pt.width,pt.height),ft.__version=et.version,et.onUpdate&&et.onUpdate(et)}else i.activeTexture(33984+ct),i.bindTexture(34067,ft.__webglTexture)}}function Z(et,ct){i.activeTexture(33984+ct),i.bindTexture(34067,s.get(et).__webglTexture)}function tt(et,ct,ft){ft?(t.texParameteri(et,10242,gt[ct.wrapS]),t.texParameteri(et,10243,gt[ct.wrapT]),et!==32879&&et!==35866||t.texParameteri(et,32882,gt[ct.wrapR]),t.texParameteri(et,10240,mt[ct.magFilter]),t.texParameteri(et,10241,mt[ct.minFilter])):(t.texParameteri(et,10242,33071),t.texParameteri(et,10243,33071),et!==32879&&et!==35866||t.texParameteri(et,32882,33071),ct.wrapS===1001&&ct.wrapT===1001||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(et,10240,L(ct.magFilter)),t.texParameteri(et,10241,L(ct.minFilter)),ct.minFilter!==1003&&ct.minFilter!==1006&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!(ft=r.get("EXT_texture_filter_anisotropic"))||ct.type===1015&&r.get("OES_texture_float_linear")===null||ct.type===1016&&(Vt||r.get("OES_texture_half_float_linear"))===null||!(1<ct.anisotropy||s.get(ct).__currentAnisotropy)||(t.texParameterf(et,ft.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ct.anisotropy,f.getMaxAnisotropy())),s.get(ct).__currentAnisotropy=ct.anisotropy)}function ot(et,ct){et.__webglInit===void 0&&(et.__webglInit=!0,ct.addEventListener("dispose",P),et.__webglTexture=t.createTexture(),g.memory.textures++)}function xt(et,ct,ft){var Tt=3553;ct.isDataTexture2DArray&&(Tt=35866),ct.isDataTexture3D&&(Tt=32879),ot(et,ct),i.activeTexture(33984+ft),i.bindTexture(Tt,et.__webglTexture),t.pixelStorei(37440,ct.flipY),t.pixelStorei(37441,ct.premultiplyAlpha),t.pixelStorei(3317,ct.unpackAlignment),ft=Vt?!1:ct.wrapS!==1001||ct.wrapT!==1001||ct.minFilter!==1003&&ct.minFilter!==1006,ft=ft&&S(ct.image)===!1,ft=A(ct.image,ft,!1,ae);var kt=S(ft)||Vt,Jt=c.convert(ct.format),pt=c.convert(ct.type),me=I(ct.internalFormat,Jt,pt);tt(Tt,ct,kt);var Ae=ct.mipmaps;if(ct.isDepthTexture)me=6402,Vt?me=ct.type===1015?36012:ct.type===1014?33190:ct.type===1020?35056:33189:ct.type===1015&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),ct.format===1026&&me===6402&&ct.type!==1012&&ct.type!==1014&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),ct.type=1012,pt=c.convert(ct.type)),ct.format===1027&&me===6402&&(me=34041,ct.type!==1020&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),ct.type=1020,pt=c.convert(ct.type))),i.texImage2D(3553,0,me,ft.width,ft.height,0,Jt,pt,null);else if(ct.isDataTexture)if(0<Ae.length&&kt){for(var de=0,ie=Ae.length;de<ie;de++){var Te=Ae[de];i.texImage2D(3553,de,me,Te.width,Te.height,0,Jt,pt,Te.data)}ct.generateMipmaps=!1,et.__maxMipLevel=Ae.length-1}else i.texImage2D(3553,0,me,ft.width,ft.height,0,Jt,pt,ft.data),et.__maxMipLevel=0;else if(ct.isCompressedTexture){for(de=0,ie=Ae.length;de<ie;de++)Te=Ae[de],ct.format!==1023&&ct.format!==1022?Jt!==null?i.compressedTexImage2D(3553,de,me,Te.width,Te.height,0,Te.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texImage2D(3553,de,me,Te.width,Te.height,0,Jt,pt,Te.data);et.__maxMipLevel=Ae.length-1}else if(ct.isDataTexture2DArray)i.texImage3D(35866,0,me,ft.width,ft.height,ft.depth,0,Jt,pt,ft.data),et.__maxMipLevel=0;else if(ct.isDataTexture3D)i.texImage3D(32879,0,me,ft.width,ft.height,ft.depth,0,Jt,pt,ft.data),et.__maxMipLevel=0;else if(0<Ae.length&&kt){for(de=0,ie=Ae.length;de<ie;de++)Te=Ae[de],i.texImage2D(3553,de,me,Jt,pt,Te);ct.generateMipmaps=!1,et.__maxMipLevel=Ae.length-1}else i.texImage2D(3553,0,me,Jt,pt,ft),et.__maxMipLevel=0;N(ct,kt)&&_(Tt,ct,ft.width,ft.height),et.__version=ct.version,ct.onUpdate&&ct.onUpdate(ct)}function At(et,ct,ft,Tt){var kt=c.convert(ct.texture.format),Jt=c.convert(ct.texture.type),pt=I(ct.texture.internalFormat,kt,Jt);i.texImage2D(Tt,0,pt,ct.width,ct.height,0,kt,Jt,null),t.bindFramebuffer(36160,et),t.framebufferTexture2D(36160,ft,Tt,s.get(ct.texture).__webglTexture,0),t.bindFramebuffer(36160,null)}function yt(et,ct,ft){if(t.bindRenderbuffer(36161,et),ct.depthBuffer&&!ct.stencilBuffer){var Tt=33189;ft?((ft=ct.depthTexture)&&ft.isDepthTexture&&(ft.type===1015?Tt=36012:ft.type===1014&&(Tt=33190)),ft=zt(ct),t.renderbufferStorageMultisample(36161,ft,Tt,ct.width,ct.height)):t.renderbufferStorage(36161,Tt,ct.width,ct.height),t.framebufferRenderbuffer(36160,36096,36161,et)}else ct.depthBuffer&&ct.stencilBuffer?(ft?(ft=zt(ct),t.renderbufferStorageMultisample(36161,ft,35056,ct.width,ct.height)):t.renderbufferStorage(36161,34041,ct.width,ct.height),t.framebufferRenderbuffer(36160,33306,36161,et)):(et=c.convert(ct.texture.format),Tt=c.convert(ct.texture.type),Tt=I(ct.texture.internalFormat,et,Tt),ft?(ft=zt(ct),t.renderbufferStorageMultisample(36161,ft,Tt,ct.width,ct.height)):t.renderbufferStorage(36161,Tt,ct.width,ct.height));t.bindRenderbuffer(36161,null)}function zt(et){return Vt&&et.isWebGLMultisampleRenderTarget?Math.min(Qe,et.samples):0}var Ht,$t,Vt=f.isWebGL2,Kt=f.maxTextures,ze=f.maxCubemapSize,ae=f.maxTextureSize,Qe=f.maxSamples,gr=new An,ir,gi=!1;try{gi=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch(et){}var hr=0,gt=(Ht={},an(Ht,1e3,10497),an(Ht,1001,33071),an(Ht,1002,33648),Ht),mt=($t={},an($t,1003,9728),an($t,1004,9984),an($t,1005,9986),an($t,1006,9729),an($t,1007,9985),an($t,1008,9987),$t),vt=!1,Ct=!1;this.allocateTextureUnit=function(){var et=hr;return et>=Kt&&console.warn("THREE.WebGLTextures: Trying to use "+et+" texture units while this GPU supports only "+Kt),hr+=1,et},this.resetTextureUnits=function(){hr=0},this.setTexture2D=W,this.setTexture2DArray=function(et,ct){var ft=s.get(et);0<et.version&&ft.__version!==et.version?xt(ft,et,ct):(i.activeTexture(33984+ct),i.bindTexture(35866,ft.__webglTexture))},this.setTexture3D=function(et,ct){var ft=s.get(et);0<et.version&&ft.__version!==et.version?xt(ft,et,ct):(i.activeTexture(33984+ct),i.bindTexture(32879,ft.__webglTexture))},this.setTextureCube=X,this.setTextureCubeDynamic=Z,this.setupRenderTarget=function(et){var ct=s.get(et),ft=s.get(et.texture);et.addEventListener("dispose",F),ft.__webglTexture=t.createTexture(),g.memory.textures++;var Tt=et.isWebGLCubeRenderTarget===!0,kt=et.isWebGLMultisampleRenderTarget===!0,Jt=S(et)||Vt;if(!Vt||et.texture.format!==1022||et.texture.type!==1015&&et.texture.type!==1016||(et.texture.format=1023,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),Tt)for(ct.__webglFramebuffer=[],kt=0;6>kt;kt++)ct.__webglFramebuffer[kt]=t.createFramebuffer();else if(ct.__webglFramebuffer=t.createFramebuffer(),kt)if(Vt){ct.__webglMultisampledFramebuffer=t.createFramebuffer(),ct.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,ct.__webglColorRenderbuffer),kt=c.convert(et.texture.format);var pt=c.convert(et.texture.type);kt=I(et.texture.internalFormat,kt,pt),pt=zt(et),t.renderbufferStorageMultisample(36161,pt,kt,et.width,et.height),t.bindFramebuffer(36160,ct.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,ct.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),et.depthBuffer&&(ct.__webglDepthRenderbuffer=t.createRenderbuffer(),yt(ct.__webglDepthRenderbuffer,et,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(Tt){for(i.bindTexture(34067,ft.__webglTexture),tt(34067,et.texture,Jt),kt=0;6>kt;kt++)At(ct.__webglFramebuffer[kt],et,36064,34069+kt);N(et.texture,Jt)&&_(34067,et.texture,et.width,et.height),i.bindTexture(34067,null)}else i.bindTexture(3553,ft.__webglTexture),tt(3553,et.texture,Jt),At(ct.__webglFramebuffer,et,36064,3553),N(et.texture,Jt)&&_(3553,et.texture,et.width,et.height),i.bindTexture(3553,null);if(et.depthBuffer){if(ct=s.get(et),ft=et.isWebGLCubeRenderTarget===!0,et.depthTexture){if(ft)throw Error("target.depthTexture not supported in Cube render targets");if(et&&et.isWebGLCubeRenderTarget)throw Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,ct.__webglFramebuffer),!et.depthTexture||!et.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");if(s.get(et.depthTexture).__webglTexture&&et.depthTexture.image.width===et.width&&et.depthTexture.image.height===et.height||(et.depthTexture.image.width=et.width,et.depthTexture.image.height=et.height,et.depthTexture.needsUpdate=!0),W(et.depthTexture,0),ct=s.get(et.depthTexture).__webglTexture,et.depthTexture.format===1026)t.framebufferTexture2D(36160,36096,3553,ct,0);else if(et.depthTexture.format===1027)t.framebufferTexture2D(36160,33306,3553,ct,0);else throw Error("Unknown depthTexture format")}else if(ft)for(ct.__webglDepthbuffer=[],ft=0;6>ft;ft++)t.bindFramebuffer(36160,ct.__webglFramebuffer[ft]),ct.__webglDepthbuffer[ft]=t.createRenderbuffer(),yt(ct.__webglDepthbuffer[ft],et,!1);else t.bindFramebuffer(36160,ct.__webglFramebuffer),ct.__webglDepthbuffer=t.createRenderbuffer(),yt(ct.__webglDepthbuffer,et,!1);t.bindFramebuffer(36160,null)}},this.updateRenderTargetMipmap=function(et){var ct=et.texture,ft=S(et)||Vt;if(N(ct,ft)){ft=et.isWebGLCubeRenderTarget?34067:3553;var Tt=s.get(ct).__webglTexture;i.bindTexture(ft,Tt),_(ft,ct,et.width,et.height),i.bindTexture(ft,null)}},this.updateMultisampleRenderTarget=function(et){if(et.isWebGLMultisampleRenderTarget)if(Vt){var ct=s.get(et);t.bindFramebuffer(36008,ct.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,ct.__webglFramebuffer);var ft=et.width,Tt=et.height,kt=16384;et.depthBuffer&&(kt|=256),et.stencilBuffer&&(kt|=1024),t.blitFramebuffer(0,0,ft,Tt,0,0,ft,Tt,kt,9728),t.bindFramebuffer(36160,ct.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(et,ct){et&&et.isWebGLRenderTarget&&(vt===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),vt=!0),et=et.texture),W(et,ct)},this.safeSetTextureCube=function(et,ct){et&&et.isWebGLCubeRenderTarget&&(Ct===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Ct=!0),et=et.texture),et&&et.isCubeTexture||Array.isArray(et.image)&&et.image.length===6?X(et,ct):Z(et,ct)}}function z0(t,r,i){var s=i.isWebGL2;return{convert:function(f){if(f===1009)return 5121;if(f===1017)return 32819;if(f===1018)return 32820;if(f===1019)return 33635;if(f===1010)return 5120;if(f===1011)return 5122;if(f===1012)return 5123;if(f===1013)return 5124;if(f===1014)return 5125;if(f===1015)return 5126;if(f===1016){if(s)return 5131;var c=r.get("OES_texture_half_float");return c!==null?c.HALF_FLOAT_OES:null}if(f===1021)return 6406;if(f===1022)return 6407;if(f===1023)return 6408;if(f===1024)return 6409;if(f===1025)return 6410;if(f===1026)return 6402;if(f===1027)return 34041;if(f===1028)return 6403;if(f===1029)return 36244;if(f===1030)return 33319;if(f===1031)return 33320;if(f===1032)return 36248;if(f===1033)return 36249;if(f===33776||f===33777||f===33778||f===33779)if(c=r.get("WEBGL_compressed_texture_s3tc"),c!==null){if(f===33776)return c.COMPRESSED_RGB_S3TC_DXT1_EXT;if(f===33777)return c.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(f===33778)return c.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(f===33779)return c.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(f===35840||f===35841||f===35842||f===35843)if(c=r.get("WEBGL_compressed_texture_pvrtc"),c!==null){if(f===35840)return c.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(f===35841)return c.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(f===35842)return c.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(f===35843)return c.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(f===36196)return c=r.get("WEBGL_compressed_texture_etc1"),c!==null?c.COMPRESSED_RGB_ETC1_WEBGL:null;if((f===37492||f===37496)&&(c=r.get("WEBGL_compressed_texture_etc"),c!==null)){if(f===37492)return c.COMPRESSED_RGB8_ETC2;if(f===37496)return c.COMPRESSED_RGBA8_ETC2_EAC}if(f===37808||f===37809||f===37810||f===37811||f===37812||f===37813||f===37814||f===37815||f===37816||f===37817||f===37818||f===37819||f===37820||f===37821||f===37840||f===37841||f===37842||f===37843||f===37844||f===37845||f===37846||f===37847||f===37848||f===37849||f===37850||f===37851||f===37852||f===37853)return c=r.get("WEBGL_compressed_texture_astc"),c!==null?f:null;if(f===36492)return c=r.get("EXT_texture_compression_bptc"),c!==null?f:null;if(f===1020)return s?34042:(c=r.get("WEBGL_depth_texture"),c!==null?c.UNSIGNED_INT_24_8_WEBGL:null)}}}function cc(t){Cr.call(this),this.cameras=t||[]}function ys(){Ce.call(this),this.type="Group"}function eu(){this._grip=this._targetRay=null}function Ao(t,r){function i(Ht){var $t=P.get(Ht.inputSource);$t&&$t.dispatchEvent({type:Ht.type})}function s(){P.forEach(function(Ht,$t){Ht.disconnect($t)}),P.clear(),t.setFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),zt.stop(),p.isPresenting=!1,p.dispatchEvent({type:"sessionend"})}function f(Ht){N=Ht,zt.setContext(A),zt.start(),p.isPresenting=!0,p.dispatchEvent({type:"sessionstart"})}function c(Ht){for(var $t=A.inputSources,Vt=0;Vt<L.length;Vt++)P.set($t[Vt],L[Vt]);for(Vt=0;Vt<Ht.removed.length;Vt++){$t=Ht.removed[Vt];var Kt=P.get($t);Kt&&(Kt.dispatchEvent({type:"disconnected",data:$t}),P.delete($t))}for(Vt=0;Vt<Ht.added.length;Vt++)$t=Ht.added[Vt],(Kt=P.get($t))&&Kt.dispatchEvent({type:"connected",data:$t})}function g(Ht,$t){$t===null?Ht.matrixWorld.copy(Ht.matrix):Ht.matrixWorld.multiplyMatrices($t.matrixWorld,Ht.matrix),Ht.matrixWorldInverse.getInverse(Ht.matrixWorld)}var p=this,A=null,S=1,N=null,_="local-floor",I=null,L=[],P=new yv,F=new Cr;F.layers.enable(1),F.viewport=new It;var W=new Cr;W.layers.enable(2),W.viewport=new It;var X=[F,W],Z=new cc;Z.layers.enable(1),Z.layers.enable(2);var tt=null,ot=null;this.isPresenting=this.enabled=!1,this.getController=function(Ht){var $t=L[Ht];return $t===void 0&&($t=new eu,L[Ht]=$t),$t.getTargetRaySpace()},this.getControllerGrip=function(Ht){var $t=L[Ht];return $t===void 0&&($t=new eu,L[Ht]=$t),$t.getGripSpace()},this.setFramebufferScaleFactor=function(Ht){S=Ht,p.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Ht){_=Ht,p.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return N},this.getSession=function(){return A},this.setSession=function(Ht){A=Ht,A!==null&&(A.addEventListener("select",i),A.addEventListener("selectstart",i),A.addEventListener("selectend",i),A.addEventListener("squeeze",i),A.addEventListener("squeezestart",i),A.addEventListener("squeezeend",i),A.addEventListener("end",s),Ht=r.getContextAttributes(),Ht.xrCompatible!==!0&&r.makeXRCompatible(),Ht=new XRWebGLLayer(A,r,{antialias:Ht.antialias,alpha:Ht.alpha,depth:Ht.depth,stencil:Ht.stencil,framebufferScaleFactor:S}),A.updateRenderState({baseLayer:Ht}),A.requestReferenceSpace(_).then(f),A.addEventListener("inputsourceschange",c))};var xt=new lt,At=new lt;this.getCamera=function(Ht){Z.near=W.near=F.near=Ht.near,Z.far=W.far=F.far=Ht.far,(tt!==Z.near||ot!==Z.far)&&(A.updateRenderState({depthNear:Z.near,depthFar:Z.far}),tt=Z.near,ot=Z.far);var $t=Ht.parent,Vt=Z.cameras;g(Z,$t);for(var Kt=0;Kt<Vt.length;Kt++)g(Vt[Kt],$t);for(Ht.matrixWorld.copy(Z.matrixWorld),Ht=Ht.children,Kt=0,$t=Ht.length;Kt<$t;Kt++)Ht[Kt].updateMatrixWorld(!0);if(Vt.length===2){xt.setFromMatrixPosition(F.matrixWorld),At.setFromMatrixPosition(W.matrixWorld),Vt=xt.distanceTo(At);var ze=F.projectionMatrix.elements,ae=W.projectionMatrix.elements,Qe=ze[14]/(ze[10]-1);Kt=ze[14]/(ze[10]+1),Ht=(ze[9]+1)/ze[5],$t=(ze[9]-1)/ze[5];var gr=(ze[8]-1)/ze[0],ir=(ae[8]+1)/ae[0];ae=Qe*gr,ze=Qe*ir,ir=Vt/(-gr+ir),gr=ir*-gr,F.matrixWorld.decompose(Z.position,Z.quaternion,Z.scale),Z.translateX(gr),Z.translateZ(ir),Z.matrixWorld.compose(Z.position,Z.quaternion,Z.scale),Z.matrixWorldInverse.getInverse(Z.matrixWorld),Qe+=ir,ir=Kt+ir,Z.projectionMatrix.makePerspective(ae-gr,ze+(Vt-gr),Ht*Kt/ir*Qe,$t*Kt/ir*Qe,Qe,ir)}else Z.projectionMatrix.copy(F.projectionMatrix);return Z};var yt=null,zt=new fi;zt.setAnimationLoop(function(Ht,$t){if(I=$t.getViewerPose(N),I!==null){var Vt=I.views,Kt=A.renderState.baseLayer;t.setFramebuffer(Kt.framebuffer);var ze=!1;Vt.length!==Z.cameras.length&&(Z.cameras.length=0,ze=!0);for(var ae=0;ae<Vt.length;ae++){var Qe=Vt[ae],gr=Kt.getViewport(Qe),ir=X[ae];ir.matrix.fromArray(Qe.transform.matrix),ir.projectionMatrix.fromArray(Qe.projectionMatrix),ir.viewport.set(gr.x,gr.y,gr.width,gr.height),ae===0&&Z.matrix.copy(ir.matrix),ze===!0&&Z.cameras.push(ir)}}for(Vt=A.inputSources,ae=0;ae<L.length;ae++)L[ae].update(Vt[ae],$t,N);yt&&yt(Ht,$t)}),this.setAnimationLoop=function(Ht){yt=Ht},this.dispose=function(){}}function Xo(t){function r(s,f,c){if(s.opacity.value=f.opacity,f.color&&s.diffuse.value.copy(f.color),f.emissive&&s.emissive.value.copy(f.emissive).multiplyScalar(f.emissiveIntensity),f.map&&(s.map.value=f.map),f.alphaMap&&(s.alphaMap.value=f.alphaMap),f.specularMap&&(s.specularMap.value=f.specularMap),(c=f.envMap||c)&&(s.envMap.value=c,s.flipEnvMap.value=c.isCubeTexture?-1:1,s.reflectivity.value=f.reflectivity,s.refractionRatio.value=f.refractionRatio,s.maxMipLevel.value=t.get(c).__maxMipLevel),f.lightMap&&(s.lightMap.value=f.lightMap,s.lightMapIntensity.value=f.lightMapIntensity),f.aoMap&&(s.aoMap.value=f.aoMap,s.aoMapIntensity.value=f.aoMapIntensity),f.map)var g=f.map;else f.specularMap?g=f.specularMap:f.displacementMap?g=f.displacementMap:f.normalMap?g=f.normalMap:f.bumpMap?g=f.bumpMap:f.roughnessMap?g=f.roughnessMap:f.metalnessMap?g=f.metalnessMap:f.alphaMap?g=f.alphaMap:f.emissiveMap&&(g=f.emissiveMap);if(g!==void 0&&(g.isWebGLRenderTarget&&(g=g.texture),g.matrixAutoUpdate===!0&&g.updateMatrix(),s.uvTransform.value.copy(g.matrix)),f.aoMap)var p=f.aoMap;else f.lightMap&&(p=f.lightMap);p!==void 0&&(p.isWebGLRenderTarget&&(p=p.texture),p.matrixAutoUpdate===!0&&p.updateMatrix(),s.uv2Transform.value.copy(p.matrix))}function i(s,f,c){s.roughness.value=f.roughness,s.metalness.value=f.metalness,f.roughnessMap&&(s.roughnessMap.value=f.roughnessMap),f.metalnessMap&&(s.metalnessMap.value=f.metalnessMap),f.emissiveMap&&(s.emissiveMap.value=f.emissiveMap),f.bumpMap&&(s.bumpMap.value=f.bumpMap,s.bumpScale.value=f.bumpScale,f.side===1&&(s.bumpScale.value*=-1)),f.normalMap&&(s.normalMap.value=f.normalMap,s.normalScale.value.copy(f.normalScale),f.side===1&&s.normalScale.value.negate()),f.displacementMap&&(s.displacementMap.value=f.displacementMap,s.displacementScale.value=f.displacementScale,s.displacementBias.value=f.displacementBias),(f.envMap||c)&&(s.envMapIntensity.value=f.envMapIntensity)}return{refreshFogUniforms:function(s,f){s.fogColor.value.copy(f.color),f.isFog?(s.fogNear.value=f.near,s.fogFar.value=f.far):f.isFogExp2&&(s.fogDensity.value=f.density)},refreshMaterialUniforms:function(s,f,c,g,p){if(f.isMeshBasicMaterial)r(s,f);else if(f.isMeshLambertMaterial)r(s,f),f.emissiveMap&&(s.emissiveMap.value=f.emissiveMap);else if(f.isMeshToonMaterial)r(s,f),s.specular.value.copy(f.specular),s.shininess.value=Math.max(f.shininess,1e-4),f.gradientMap&&(s.gradientMap.value=f.gradientMap),f.emissiveMap&&(s.emissiveMap.value=f.emissiveMap),f.bumpMap&&(s.bumpMap.value=f.bumpMap,s.bumpScale.value=f.bumpScale,f.side===1&&(s.bumpScale.value*=-1)),f.normalMap&&(s.normalMap.value=f.normalMap,s.normalScale.value.copy(f.normalScale),f.side===1&&s.normalScale.value.negate()),f.displacementMap&&(s.displacementMap.value=f.displacementMap,s.displacementScale.value=f.displacementScale,s.displacementBias.value=f.displacementBias);else if(f.isMeshPhongMaterial)r(s,f),s.specular.value.copy(f.specular),s.shininess.value=Math.max(f.shininess,1e-4),f.emissiveMap&&(s.emissiveMap.value=f.emissiveMap),f.bumpMap&&(s.bumpMap.value=f.bumpMap,s.bumpScale.value=f.bumpScale,f.side===1&&(s.bumpScale.value*=-1)),f.normalMap&&(s.normalMap.value=f.normalMap,s.normalScale.value.copy(f.normalScale),f.side===1&&s.normalScale.value.negate()),f.displacementMap&&(s.displacementMap.value=f.displacementMap,s.displacementScale.value=f.displacementScale,s.displacementBias.value=f.displacementBias);else if(f.isMeshStandardMaterial)r(s,f,c),f.isMeshPhysicalMaterial?(i(s,f,c),s.reflectivity.value=f.reflectivity,s.clearcoat.value=f.clearcoat,s.clearcoatRoughness.value=f.clearcoatRoughness,f.sheen&&s.sheen.value.copy(f.sheen),f.clearcoatMap&&(s.clearcoatMap.value=f.clearcoatMap),f.clearcoatRoughnessMap&&(s.clearcoatRoughnessMap.value=f.clearcoatRoughnessMap),f.clearcoatNormalMap&&(s.clearcoatNormalScale.value.copy(f.clearcoatNormalScale),s.clearcoatNormalMap.value=f.clearcoatNormalMap,f.side===1&&s.clearcoatNormalScale.value.negate()),s.transparency.value=f.transparency):i(s,f,c);else if(f.isMeshMatcapMaterial)r(s,f),f.matcap&&(s.matcap.value=f.matcap),f.bumpMap&&(s.bumpMap.value=f.bumpMap,s.bumpScale.value=f.bumpScale,f.side===1&&(s.bumpScale.value*=-1)),f.normalMap&&(s.normalMap.value=f.normalMap,s.normalScale.value.copy(f.normalScale),f.side===1&&s.normalScale.value.negate()),f.displacementMap&&(s.displacementMap.value=f.displacementMap,s.displacementScale.value=f.displacementScale,s.displacementBias.value=f.displacementBias);else if(f.isMeshDepthMaterial)r(s,f),f.displacementMap&&(s.displacementMap.value=f.displacementMap,s.displacementScale.value=f.displacementScale,s.displacementBias.value=f.displacementBias);else if(f.isMeshDistanceMaterial)r(s,f),f.displacementMap&&(s.displacementMap.value=f.displacementMap,s.displacementScale.value=f.displacementScale,s.displacementBias.value=f.displacementBias),s.referencePosition.value.copy(f.referencePosition),s.nearDistance.value=f.nearDistance,s.farDistance.value=f.farDistance;else if(f.isMeshNormalMaterial)r(s,f),f.bumpMap&&(s.bumpMap.value=f.bumpMap,s.bumpScale.value=f.bumpScale,f.side===1&&(s.bumpScale.value*=-1)),f.normalMap&&(s.normalMap.value=f.normalMap,s.normalScale.value.copy(f.normalScale),f.side===1&&s.normalScale.value.negate()),f.displacementMap&&(s.displacementMap.value=f.displacementMap,s.displacementScale.value=f.displacementScale,s.displacementBias.value=f.displacementBias);else if(f.isLineBasicMaterial)s.diffuse.value.copy(f.color),s.opacity.value=f.opacity,f.isLineDashedMaterial&&(s.dashSize.value=f.dashSize,s.totalSize.value=f.dashSize+f.gapSize,s.scale.value=f.scale);else if(f.isPointsMaterial){if(s.diffuse.value.copy(f.color),s.opacity.value=f.opacity,s.size.value=f.size*g,s.scale.value=.5*p,f.map&&(s.map.value=f.map),f.alphaMap&&(s.alphaMap.value=f.alphaMap),f.map)var A=f.map;else f.alphaMap&&(A=f.alphaMap);A!==void 0&&(A.matrixAutoUpdate===!0&&A.updateMatrix(),s.uvTransform.value.copy(A.matrix))}else if(f.isSpriteMaterial){if(s.diffuse.value.copy(f.color),s.opacity.value=f.opacity,s.rotation.value=f.rotation,f.map&&(s.map.value=f.map),f.alphaMap&&(s.alphaMap.value=f.alphaMap),f.map)var S=f.map;else f.alphaMap&&(S=f.alphaMap);S!==void 0&&(S.matrixAutoUpdate===!0&&S.updateMatrix(),s.uvTransform.value.copy(S.matrix))}else f.isShadowMaterial?(s.color.value.copy(f.color),s.opacity.value=f.opacity):f.isShaderMaterial&&(f.uniformsNeedUpdate=!1)}}}function Yo(t){var r;function i(){nr=new gn(we),Jr=new Tr(we,nr,t),Jr.isWebGL2===!1&&(nr.get("WEBGL_depth_texture"),nr.get("OES_texture_float"),nr.get("OES_texture_half_float"),nr.get("OES_texture_half_float_linear"),nr.get("OES_standard_derivatives"),nr.get("OES_element_index_uint"),nr.get("ANGLE_instanced_arrays")),nr.get("OES_texture_float_linear"),Bs=new z0(we,nr,Jr),je=new Im(we,nr,Jr),je.scissor(vt.copy(pt).multiplyScalar(ft).floor()),je.viewport(mt.copy(Jt).multiplyScalar(ft).floor()),$n=new Ki(we),Oi=new pd,hs=new Yx(we,nr,je,Oi,Jr,Bs,$n),gu=new Er(we,Jr),Vh=new hn(we,gu,$n),xa=new Vi(we,Vh,gu,$n),Ty=new tn(we),Wl=new fd(Ht,nr,Jr),jl=new Xo(Oi),ta=new wi,Xu=new sh,es=new zr(Ht,je,xa,tt),Sy=new pi(we,nr,$n,Jr),mu=new mn(we,nr,$n,Jr),$n.programs=Wl.programs,Ht.capabilities=Jr,Ht.extensions=nr,Ht.properties=Oi,Ht.renderLists=ta,Ht.state=je,Ht.info=$n}function s(_t){_t.preventDefault(),$t=!0}function f(){$t=!1,i()}function c(_t){_t=_t.target,_t.removeEventListener("dispose",c),g(_t),Oi.remove(_t)}function g(_t){var _e=Oi.get(_t).program;_t.program=void 0,_e!==void 0&&Wl.releaseProgram(_e)}function p(_t,_e){_t.render(function(Yt){Ht.renderBufferImmediate(Yt,_e)})}function A(_t,_e,Yt,Re){if(_t.visible!==!1){if(_t.layers.test(_e.layers)){if(_t.isGroup)Yt=_t.renderOrder;else if(_t.isLOD)_t.autoUpdate===!0&&_t.update(_e);else if(_t.isLight)zt.pushLight(_t),_t.castShadow&&zt.pushShadow(_t);else if(_t.isSprite){if(!_t.frustumCulled||Ae.intersectsSprite(_t)){Re&&Nr.setFromMatrixPosition(_t.matrixWorld).applyMatrix4(mr);var Je=xa.update(_t),yi=_t.material;yi.visible&&yt.push(_t,Je,yi,Yt,Nr.z,null)}}else if(_t.isImmediateRenderObject)Re&&Nr.setFromMatrixPosition(_t.matrixWorld).applyMatrix4(mr),yt.push(_t,null,_t.material,Yt,Nr.z,null);else if((_t.isMesh||_t.isLine||_t.isPoints)&&(_t.isSkinnedMesh&&_t.skeleton.frame!==$n.render.frame&&(_t.skeleton.update(),_t.skeleton.frame=$n.render.frame),!_t.frustumCulled||Ae.intersectsObject(_t)))if(Re&&Nr.setFromMatrixPosition(_t.matrixWorld).applyMatrix4(mr),Je=xa.update(_t),yi=_t.material,Array.isArray(yi))for(var ar=Je.groups,Wr=0,vi=ar.length;Wr<vi;Wr++){var ji=ar[Wr],Fi=yi[ji.materialIndex];Fi&&Fi.visible&&yt.push(_t,Je,Fi,Yt,Nr.z,ji)}else yi.visible&&yt.push(_t,Je,yi,Yt,Nr.z,null)}for(_t=_t.children,Wr=0,vi=_t.length;Wr<vi;Wr++)A(_t[Wr],_e,Yt,Re)}}function S(_t,_e,Yt,Re){for(var Je=0,yi=_t.length;Je<yi;Je++){var ar=_t[Je],Wr=ar.object,vi=ar.geometry,ji=Re===void 0?ar.material:Re;if(ar=ar.group,Yt.isArrayCamera){gt=Yt;for(var Fi=Yt.cameras,vu=0,Rn=Fi.length;vu<Rn;vu++){var vo=Fi[vu];Wr.layers.test(vo.layers)&&(je.viewport(mt.copy(vo.viewport)),zt.setupLights(vo),N(Wr,_e,vo,vi,ji,ar))}}else gt=null,N(Wr,_e,Yt,vi,ji,ar)}}function N(_t,_e,Yt,Re,Je,yi){if(_t.onBeforeRender(Ht,_e,Yt,Re,Je,yi),zt=Xu.get(_e,gt||Yt),_t.modelViewMatrix.multiplyMatrices(Yt.matrixWorldInverse,_t.matrixWorld),_t.normalMatrix.getNormalMatrix(_t.modelViewMatrix),_t.isImmediateRenderObject){var ar=I(Yt,_e,Je,_t);je.setMaterial(Je),ir=r=null,gi=!1,p(_t,ar)}else Ht.renderBufferDirect(Yt,_e,Re,Je,_t,yi);_t.onAfterRender(Ht,_e,Yt,Re,Je,yi),zt=Xu.get(_e,gt||Yt)}function _(_t,_e,Yt){var Re=Oi.get(_t),Je=zt.state.lights,yi=Je.state.version;Yt=Wl.getParameters(_t,Je.state,zt.state.shadowsArray,_e,de.numPlanes,de.numIntersection,Yt);var ar=Wl.getProgramCacheKey(Yt),Wr=Re.program,vi=!0;if(Wr===void 0)_t.addEventListener("dispose",c);else if(Wr.cacheKey!==ar)g(_t);else{if(Re.lightsStateVersion!==yi)Re.lightsStateVersion=yi;else if(Yt.shaderID!==void 0)return;vi=!1}if(vi&&(Wr=Wl.acquireProgram(Yt,ar),Re.program=Wr,Re.uniforms=Yt.uniforms,Re.outputEncoding=Yt.outputEncoding,_t.program=Wr),Yt=Wr.getAttributes(),_t.morphTargets)for(ar=_t.numSupportedMorphTargets=0;ar<Ht.maxMorphTargets;ar++)0<=Yt["morphTarget"+ar]&&_t.numSupportedMorphTargets++;if(_t.morphNormals)for(ar=_t.numSupportedMorphNormals=0;ar<Ht.maxMorphNormals;ar++)0<=Yt["morphNormal"+ar]&&_t.numSupportedMorphNormals++;Yt=Re.uniforms,(!_t.isShaderMaterial&&!_t.isRawShaderMaterial||_t.clipping===!0)&&(Re.numClippingPlanes=de.numPlanes,Re.numIntersection=de.numIntersection,Yt.clippingPlanes=de.uniform),Re.environment=_t.isMeshStandardMaterial?_e.environment:null,Re.fog=_e.fog,Re.needsLights=_t.isMeshLambertMaterial||_t.isMeshToonMaterial||_t.isMeshPhongMaterial||_t.isMeshStandardMaterial||_t.isShadowMaterial||_t.isShaderMaterial&&_t.lights===!0,Re.lightsStateVersion=yi,Re.needsLights&&(Yt.ambientLightColor.value=Je.state.ambient,Yt.lightProbe.value=Je.state.probe,Yt.directionalLights.value=Je.state.directional,Yt.directionalLightShadows.value=Je.state.directionalShadow,Yt.spotLights.value=Je.state.spot,Yt.spotLightShadows.value=Je.state.spotShadow,Yt.rectAreaLights.value=Je.state.rectArea,Yt.pointLights.value=Je.state.point,Yt.pointLightShadows.value=Je.state.pointShadow,Yt.hemisphereLights.value=Je.state.hemi,Yt.directionalShadowMap.value=Je.state.directionalShadowMap,Yt.directionalShadowMatrix.value=Je.state.directionalShadowMatrix,Yt.spotShadowMap.value=Je.state.spotShadowMap,Yt.spotShadowMatrix.value=Je.state.spotShadowMatrix,Yt.pointShadowMap.value=Je.state.pointShadowMap,Yt.pointShadowMatrix.value=Je.state.pointShadowMatrix),_t=Re.program.getUniforms(),_t=gs.seqWithValue(_t.seq,Yt),Re.uniformsList=_t}function I(_t,_e,Yt,Re){hs.resetTextureUnits();var Je=_e.fog,yi=Yt.isMeshStandardMaterial?_e.environment:null,ar=ae===null?Ht.outputEncoding:ae.texture.encoding,Wr=Oi.get(Yt),vi=zt.state.lights;ie&&(Te||_t!==hr)&&de.setState(Yt.clippingPlanes,Yt.clipIntersection,Yt.clipShadows,_t,Wr,_t===hr&&Yt.id===gr),Yt.version===Wr.__version?Wr.program===void 0||Yt.fog&&Wr.fog!==Je||Wr.environment!==yi||Wr.needsLights&&Wr.lightsStateVersion!==vi.state.version?_(Yt,_e,Re):Wr.numClippingPlanes===void 0||Wr.numClippingPlanes===de.numPlanes&&Wr.numIntersection===de.numIntersection?Wr.outputEncoding!==ar&&_(Yt,_e,Re):_(Yt,_e,Re):(_(Yt,_e,Re),Wr.__version=Yt.version);var ji=!1,Fi=!1,vu=!1;if(_e=Wr.program,ar=_e.getUniforms(),vi=Wr.uniforms,je.useProgram(_e.program)&&(vu=Fi=ji=!0),Yt.id!==gr&&(gr=Yt.id,Fi=!0),(ji||hr!==_t)&&(ar.setValue(we,"projectionMatrix",_t.projectionMatrix),Jr.logarithmicDepthBuffer&&ar.setValue(we,"logDepthBufFC",2/(Math.log(_t.far+1)/Math.LN2)),hr!==_t&&(hr=_t,vu=Fi=!0),(Yt.isShaderMaterial||Yt.isMeshPhongMaterial||Yt.isMeshToonMaterial||Yt.isMeshStandardMaterial||Yt.envMap)&&(ji=ar.map.cameraPosition,ji!==void 0&&ji.setValue(we,Nr.setFromMatrixPosition(_t.matrixWorld))),(Yt.isMeshPhongMaterial||Yt.isMeshToonMaterial||Yt.isMeshLambertMaterial||Yt.isMeshBasicMaterial||Yt.isMeshStandardMaterial||Yt.isShaderMaterial)&&ar.setValue(we,"isOrthographic",_t.isOrthographicCamera===!0),(Yt.isMeshPhongMaterial||Yt.isMeshToonMaterial||Yt.isMeshLambertMaterial||Yt.isMeshBasicMaterial||Yt.isMeshStandardMaterial||Yt.isShaderMaterial||Yt.skinning)&&ar.setValue(we,"viewMatrix",_t.matrixWorldInverse)),Yt.skinning&&(ar.setOptional(we,Re,"bindMatrix"),ar.setOptional(we,Re,"bindMatrixInverse"),_t=Re.skeleton))if(ji=_t.bones,Jr.floatVertexTextures){if(_t.boneTexture===void 0){ji=Math.sqrt(4*ji.length),ji=Ar.ceilPowerOfTwo(ji),ji=Math.max(ji,4);var Rn=new Float32Array(ji*ji*4);Rn.set(_t.boneMatrices);var vo=new Ri(Rn,ji,ji,1023,1015);_t.boneMatrices=Rn,_t.boneTexture=vo,_t.boneTextureSize=ji}ar.setValue(we,"boneTexture",_t.boneTexture,hs),ar.setValue(we,"boneTextureSize",_t.boneTextureSize)}else ar.setOptional(we,_t,"boneMatrices");return(Fi||Wr.receiveShadow!==Re.receiveShadow)&&(Wr.receiveShadow=Re.receiveShadow,ar.setValue(we,"receiveShadow",Re.receiveShadow)),Fi&&(ar.setValue(we,"toneMappingExposure",Ht.toneMappingExposure),ar.setValue(we,"toneMappingWhitePoint",Ht.toneMappingWhitePoint),Wr.needsLights&&(Fi=vu,vi.ambientLightColor.needsUpdate=Fi,vi.lightProbe.needsUpdate=Fi,vi.directionalLights.needsUpdate=Fi,vi.directionalLightShadows.needsUpdate=Fi,vi.pointLights.needsUpdate=Fi,vi.pointLightShadows.needsUpdate=Fi,vi.spotLights.needsUpdate=Fi,vi.spotLightShadows.needsUpdate=Fi,vi.rectAreaLights.needsUpdate=Fi,vi.hemisphereLights.needsUpdate=Fi),Je&&Yt.fog&&jl.refreshFogUniforms(vi,Je),jl.refreshMaterialUniforms(vi,Yt,yi,ft,ct),vi.ltc_1!==void 0&&(vi.ltc_1.value=fr.LTC_1),vi.ltc_2!==void 0&&(vi.ltc_2.value=fr.LTC_2),gs.upload(we,Wr.uniformsList,vi,hs)),Yt.isShaderMaterial&&Yt.uniformsNeedUpdate===!0&&(gs.upload(we,Wr.uniformsList,vi,hs),Yt.uniformsNeedUpdate=!1),Yt.isSpriteMaterial&&ar.setValue(we,"center",Re.center),ar.setValue(we,"modelViewMatrix",Re.modelViewMatrix),ar.setValue(we,"normalMatrix",Re.normalMatrix),ar.setValue(we,"modelMatrix",Re.matrixWorld),_e}t=t||{};var L=t.canvas!==void 0?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),P=t.context!==void 0?t.context:null,F=t.alpha!==void 0?t.alpha:!1,W=t.depth!==void 0?t.depth:!0,X=t.stencil!==void 0?t.stencil:!0,Z=t.antialias!==void 0?t.antialias:!1,tt=t.premultipliedAlpha!==void 0?t.premultipliedAlpha:!0,ot=t.preserveDrawingBuffer!==void 0?t.preserveDrawingBuffer:!1,xt=t.powerPreference!==void 0?t.powerPreference:"default",At=t.failIfMajorPerformanceCaveat!==void 0?t.failIfMajorPerformanceCaveat:!1,yt=null,zt=null;this.domElement=L,this.debug={checkShaderErrors:!0},this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=3e3,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingWhitePoint=this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var Ht=this,$t=!1,Vt=null,Kt=0,ze=0,ae=null,Qe=null,gr=-1,ir=r=null,gi=!1,hr=null,gt=null,mt=new It,vt=new It,Ct=null,et=L.width,ct=L.height,ft=1,Tt=null,kt=null,Jt=new It(0,0,et,ct),pt=new It(0,0,et,ct),me=!1,Ae=new mi,de=new zi,ie=!1,Te=!1,mr=new ye,Nr=new lt;try{F={alpha:F,depth:W,stencil:X,antialias:Z,premultipliedAlpha:tt,preserveDrawingBuffer:ot,powerPreference:xt,failIfMajorPerformanceCaveat:At},L.addEventListener("webglcontextlost",s,!1),L.addEventListener("webglcontextrestored",f,!1);var we=P||L.getContext("webgl",F)||L.getContext("experimental-webgl",F);if(we===null)throw L.getContext("webgl")!==null?Error("Error creating WebGL context with your selected attributes."):Error("Error creating WebGL context.");we.getShaderPrecisionFormat===void 0&&(we.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(_t){throw console.error("THREE.WebGLRenderer: "+_t.message),_t}var nr,Jr,je,$n,Oi,hs,gu,Vh,xa,Wl,jl,ta,Xu,es,Ty,Sy,mu,Bs;i();var ea=new Ao(Ht,we);this.xr=ea;var Wh=new tu(Ht,xa,Jr.maxTextureSize);this.shadowMap=Wh,this.getContext=function(){return we},this.getContextAttributes=function(){return we.getContextAttributes()},this.forceContextLoss=function(){var _t=nr.get("WEBGL_lose_context");_t&&_t.loseContext()},this.forceContextRestore=function(){var _t=nr.get("WEBGL_lose_context");_t&&_t.restoreContext()},this.getPixelRatio=function(){return ft},this.setPixelRatio=function(_t){_t!==void 0&&(ft=_t,this.setSize(et,ct,!1))},this.getSize=function(_t){return _t===void 0&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),_t=new st),_t.set(et,ct)},this.setSize=function(_t,_e,Yt){ea.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(et=_t,ct=_e,L.width=Math.floor(_t*ft),L.height=Math.floor(_e*ft),Yt!==!1&&(L.style.width=_t+"px",L.style.height=_e+"px"),this.setViewport(0,0,_t,_e))},this.getDrawingBufferSize=function(_t){return _t===void 0&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),_t=new st),_t.set(et*ft,ct*ft).floor()},this.setDrawingBufferSize=function(_t,_e,Yt){et=_t,ct=_e,ft=Yt,L.width=Math.floor(_t*Yt),L.height=Math.floor(_e*Yt),this.setViewport(0,0,_t,_e)},this.getCurrentViewport=function(_t){return _t===void 0&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),_t=new It),_t.copy(mt)},this.getViewport=function(_t){return _t.copy(Jt)},this.setViewport=function(_t,_e,Yt,Re){_t.isVector4?Jt.set(_t.x,_t.y,_t.z,_t.w):Jt.set(_t,_e,Yt,Re),je.viewport(mt.copy(Jt).multiplyScalar(ft).floor())},this.getScissor=function(_t){return _t.copy(pt)},this.setScissor=function(_t,_e,Yt,Re){_t.isVector4?pt.set(_t.x,_t.y,_t.z,_t.w):pt.set(_t,_e,Yt,Re),je.scissor(vt.copy(pt).multiplyScalar(ft).floor())},this.getScissorTest=function(){return me},this.setScissorTest=function(_t){je.setScissorTest(me=_t)},this.setOpaqueSort=function(_t){Tt=_t},this.setTransparentSort=function(_t){kt=_t},this.getClearColor=function(){return es.getClearColor()},this.setClearColor=function(){es.setClearColor.apply(es,arguments)},this.getClearAlpha=function(){return es.getClearAlpha()},this.setClearAlpha=function(){es.setClearAlpha.apply(es,arguments)},this.clear=function(_t,_e,Yt){var Re=0;(_t===void 0||_t)&&(Re|=16384),(_e===void 0||_e)&&(Re|=256),(Yt===void 0||Yt)&&(Re|=1024),we.clear(Re)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){L.removeEventListener("webglcontextlost",s,!1),L.removeEventListener("webglcontextrestored",f,!1),ta.dispose(),Xu.dispose(),Oi.dispose(),xa.dispose(),ea.dispose(),Ep.stop()},this.renderBufferImmediate=function(_t,_e){je.initAttributes();var Yt=Oi.get(_t);_t.hasPositions&&!Yt.position&&(Yt.position=we.createBuffer()),_t.hasNormals&&!Yt.normal&&(Yt.normal=we.createBuffer()),_t.hasUvs&&!Yt.uv&&(Yt.uv=we.createBuffer()),_t.hasColors&&!Yt.color&&(Yt.color=we.createBuffer()),_e=_e.getAttributes(),_t.hasPositions&&(we.bindBuffer(34962,Yt.position),we.bufferData(34962,_t.positionArray,35048),je.enableAttribute(_e.position),we.vertexAttribPointer(_e.position,3,5126,!1,0,0)),_t.hasNormals&&(we.bindBuffer(34962,Yt.normal),we.bufferData(34962,_t.normalArray,35048),je.enableAttribute(_e.normal),we.vertexAttribPointer(_e.normal,3,5126,!1,0,0)),_t.hasUvs&&(we.bindBuffer(34962,Yt.uv),we.bufferData(34962,_t.uvArray,35048),je.enableAttribute(_e.uv),we.vertexAttribPointer(_e.uv,2,5126,!1,0,0)),_t.hasColors&&(we.bindBuffer(34962,Yt.color),we.bufferData(34962,_t.colorArray,35048),je.enableAttribute(_e.color),we.vertexAttribPointer(_e.color,3,5126,!1,0,0)),je.disableUnusedAttributes(),we.drawArrays(4,0,_t.count),_t.count=0};var Aa=new ti;this.renderBufferDirect=function(_t,_e,Yt,Re,Je,yi){_e===null&&(_e=Aa);var ar=Je.isMesh&&0>Je.matrixWorld.determinant(),Wr=I(_t,_e,Re,Je);je.setMaterial(Re,ar);var vi=!1;if((r!==Yt.id||ir!==Wr.id||gi!==(Re.wireframe===!0))&&(r=Yt.id,ir=Wr.id,gi=Re.wireframe===!0,vi=!0),(Re.morphTargets||Re.morphNormals)&&(Ty.update(Je,Yt,Re,Wr),vi=!0),Je.isInstancedMesh===!0&&(vi=!0),_t=Yt.index,_e=Yt.attributes.position,_t===null){if(_e===void 0||_e.count===0)return}else if(_t.count===0)return;var ji=1;if(Re.wireframe===!0&&(_t=Vh.getWireframeAttribute(Yt),ji=2),ar=Sy,_t!==null){var Fi=gu.get(_t);ar=mu,ar.setIndex(Fi)}if(vi){if(Jr.isWebGL2!==!1||!Je.isInstancedMesh&&!Yt.isInstancedBufferGeometry||nr.get("ANGLE_instanced_arrays")!==null){je.initAttributes(),vi=Yt.attributes,Wr=Wr.getAttributes();var vu=Re.defaultAttributeValues;for(Xh in Wr){var Rn=Wr[Xh];if(0<=Rn){var vo=vi[Xh];if(vo!==void 0){var Yu=vo.normalized,Iy=vo.itemSize,Wa=gu.get(vo);if(Wa!==void 0){var Rg=Wa.buffer,jh=Wa.type;if(Wa=Wa.bytesPerElement,vo.isInterleavedBufferAttribute){var $c=vo.data,a2=$c.stride;vo=vo.offset,$c&&$c.isInstancedInterleavedBuffer?(je.enableAttributeAndDivisor(Rn,$c.meshPerAttribute),Yt._maxInstanceCount===void 0&&(Yt._maxInstanceCount=$c.meshPerAttribute*$c.count)):je.enableAttribute(Rn),we.bindBuffer(34962,Rg),je.vertexAttribPointer(Rn,Iy,jh,Yu,a2*Wa,vo*Wa)}else vo.isInstancedBufferAttribute?(je.enableAttributeAndDivisor(Rn,vo.meshPerAttribute),Yt._maxInstanceCount===void 0&&(Yt._maxInstanceCount=vo.meshPerAttribute*vo.count)):je.enableAttribute(Rn),we.bindBuffer(34962,Rg),je.vertexAttribPointer(Rn,Iy,jh,Yu,0,0)}}else if(Xh==="instanceMatrix")Wa=gu.get(Je.instanceMatrix),Wa!==void 0&&(Rg=Wa.buffer,jh=Wa.type,je.enableAttributeAndDivisor(Rn+0,1),je.enableAttributeAndDivisor(Rn+1,1),je.enableAttributeAndDivisor(Rn+2,1),je.enableAttributeAndDivisor(Rn+3,1),we.bindBuffer(34962,Rg),we.vertexAttribPointer(Rn+0,4,jh,!1,64,0),we.vertexAttribPointer(Rn+1,4,jh,!1,64,16),we.vertexAttribPointer(Rn+2,4,jh,!1,64,32),we.vertexAttribPointer(Rn+3,4,jh,!1,64,48));else if(vu!==void 0&&(Yu=vu[Xh],Yu!==void 0))switch(Yu.length){case 2:we.vertexAttrib2fv(Rn,Yu);break;case 3:we.vertexAttrib3fv(Rn,Yu);break;case 4:we.vertexAttrib4fv(Rn,Yu);break;default:we.vertexAttrib1fv(Rn,Yu)}}}je.disableUnusedAttributes()}_t!==null&&we.bindBuffer(34963,Fi.buffer)}var Xh=Yt.drawRange.start*ji;vi=yi!==null?yi.start*ji:0,Fi=Math.max(Xh,vi),yi=Math.max(0,Math.min(_t!==null?_t.count:_e.count,Xh+Yt.drawRange.count*ji,vi+(yi!==null?yi.count*ji:Infinity))-1-Fi+1),yi!==0&&(Je.isMesh?Re.wireframe===!0?(je.setLineWidth(Re.wireframeLinewidth*(ae===null?ft:1)),ar.setMode(1)):ar.setMode(4):Je.isLine?(Re=Re.linewidth,Re===void 0&&(Re=1),je.setLineWidth(Re*(ae===null?ft:1)),Je.isLineSegments?ar.setMode(1):Je.isLineLoop?ar.setMode(2):ar.setMode(3)):Je.isPoints?ar.setMode(0):Je.isSprite&&ar.setMode(4),Je.isInstancedMesh?ar.renderInstances(Yt,Fi,yi,Je.count):Yt.isInstancedBufferGeometry?ar.renderInstances(Yt,Fi,yi,Math.min(Yt.instanceCount,Yt._maxInstanceCount)):ar.render(Fi,yi))},this.compile=function(_t,_e){zt=Xu.get(_t,_e),zt.init(),_t.traverse(function(Re){Re.isLight&&(zt.pushLight(Re),Re.castShadow&&zt.pushShadow(Re))}),zt.setupLights(_e);var Yt={};_t.traverse(function(Re){var Je=Re.material;if(Je)if(Array.isArray(Je))for(var yi=0;yi<Je.length;yi++){var ar=Je[yi];!(ar.uuid in Yt)&&(_(ar,_t,Re),Yt[ar.uuid]=!0)}else!(Je.uuid in Yt)&&(_(Je,_t,Re),Yt[Je.uuid]=!0)})};var cs=null,Ep=new fi;Ep.setAnimationLoop(function(_t){ea.isPresenting||cs&&cs(_t)}),typeof window!="undefined"&&Ep.setContext(window),this.setAnimationLoop=function(_t){cs=_t,ea.setAnimationLoop(_t),Ep.start()},this.render=function(_t,_e,Yt,Re){if(Yt!==void 0){console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead.");var Je=Yt}if(Re!==void 0){console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead.");var yi=Re}_e&&_e.isCamera?$t||(ir=r=null,gi=!1,gr=-1,hr=null,_t.autoUpdate===!0&&_t.updateMatrixWorld(),_e.parent===null&&_e.updateMatrixWorld(),ea.enabled&&ea.isPresenting&&(_e=ea.getCamera(_e)),_t.onBeforeRender(Ht,_t,_e,Je||ae),zt=Xu.get(_t,_e),zt.init(),mr.multiplyMatrices(_e.projectionMatrix,_e.matrixWorldInverse),Ae.setFromProjectionMatrix(mr),Te=this.localClippingEnabled,ie=de.init(this.clippingPlanes,Te,_e),yt=ta.get(_t,_e),yt.init(),A(_t,_e,0,Ht.sortObjects),yt.finish(),Ht.sortObjects===!0&&yt.sort(Tt,kt),ie&&de.beginShadows(),Wh.render(zt.state.shadowsArray,_t,_e),zt.setupLights(_e),ie&&de.endShadows(),this.info.autoReset&&this.info.reset(),Je!==void 0&&this.setRenderTarget(Je),es.render(yt,_t,_e,yi),Yt=yt.opaque,Re=yt.transparent,_t.overrideMaterial?(Je=_t.overrideMaterial,Yt.length&&S(Yt,_t,_e,Je),Re.length&&S(Re,_t,_e,Je)):(Yt.length&&S(Yt,_t,_e),Re.length&&S(Re,_t,_e)),_t.onAfterRender(Ht,_t,_e),ae!==null&&(hs.updateRenderTargetMipmap(ae),hs.updateMultisampleRenderTarget(ae)),je.buffers.depth.setTest(!0),je.buffers.depth.setMask(!0),je.buffers.color.setMask(!0),je.setPolygonOffset(!1),zt=yt=null):console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(_t){Vt!==_t&&ae===null&&we.bindFramebuffer(36160,_t),Vt=_t},this.getActiveCubeFace=function(){return Kt},this.getActiveMipmapLevel=function(){return ze},this.getRenderTarget=function(){return ae},this.setRenderTarget=function(_t,_e,Yt){ae=_t,Kt=_e,ze=Yt,_t&&Oi.get(_t).__webglFramebuffer===void 0&&hs.setupRenderTarget(_t);var Re=Vt,Je=!1;_t?(Re=Oi.get(_t).__webglFramebuffer,_t.isWebGLCubeRenderTarget?(Re=Re[_e||0],Je=!0):Re=_t.isWebGLMultisampleRenderTarget?Oi.get(_t).__webglMultisampledFramebuffer:Re,mt.copy(_t.viewport),vt.copy(_t.scissor),Ct=_t.scissorTest):(mt.copy(Jt).multiplyScalar(ft).floor(),vt.copy(pt).multiplyScalar(ft).floor(),Ct=me),Qe!==Re&&(we.bindFramebuffer(36160,Re),Qe=Re),je.viewport(mt),je.scissor(vt),je.setScissorTest(Ct),Je&&(_t=Oi.get(_t.texture),we.framebufferTexture2D(36160,36064,34069+(_e||0),_t.__webglTexture,Yt||0))},this.readRenderTargetPixels=function(_t,_e,Yt,Re,Je,yi,ar){if(_t&&_t.isWebGLRenderTarget){var Wr=Oi.get(_t).__webglFramebuffer;if(_t.isWebGLCubeRenderTarget&&ar!==void 0&&(Wr=Wr[ar]),Wr){ar=!1,Wr!==Qe&&(we.bindFramebuffer(36160,Wr),ar=!0);try{var vi=_t.texture,ji=vi.format,Fi=vi.type;ji!==1023&&Bs.convert(ji)!==we.getParameter(35739)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):Fi===1009||Bs.convert(Fi)===we.getParameter(35738)||Fi===1015&&(Jr.isWebGL2||nr.get("OES_texture_float")||nr.get("WEBGL_color_buffer_float"))||Fi===1016&&(Jr.isWebGL2?nr.get("EXT_color_buffer_float"):nr.get("EXT_color_buffer_half_float"))?we.checkFramebufferStatus(36160)===36053?0<=_e&&_e<=_t.width-Re&&0<=Yt&&Yt<=_t.height-Je&&we.readPixels(_e,Yt,Re,Je,Bs.convert(ji),Bs.convert(Fi),yi):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{ar&&we.bindFramebuffer(36160,Qe)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(_t,_e,Yt){Yt===void 0&&(Yt=0);var Re=Math.pow(2,-Yt),Je=Math.floor(_e.image.width*Re);Re=Math.floor(_e.image.height*Re);var yi=Bs.convert(_e.format);hs.setTexture2D(_e,0),we.copyTexImage2D(3553,Yt,yi,_t.x,_t.y,Je,Re,0),je.unbindTexture()},this.copyTextureToTexture=function(_t,_e,Yt,Re){Re===void 0&&(Re=0);var Je=_e.image.width,yi=_e.image.height,ar=Bs.convert(Yt.format),Wr=Bs.convert(Yt.type);hs.setTexture2D(Yt,0),_e.isDataTexture?we.texSubImage2D(3553,Re,_t.x,_t.y,Je,yi,ar,Wr,_e.image.data):_e.isCompressedTexture?we.compressedTexSubImage2D(3553,Re,_t.x,_t.y,_e.mipmaps[0].width,_e.mipmaps[0].height,ar,_e.mipmaps[0].data):we.texSubImage2D(3553,Re,_t.x,_t.y,ar,Wr,_e.image),Re===0&&Yt.generateMipmaps&&we.generateMipmap(3553),je.unbindTexture()},this.initTexture=function(_t){hs.setTexture2D(_t,0),je.unbindTexture()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function ru(t,r){this.name="",this.color=new Ue(t),this.density=r!==void 0?r:25e-5}function xs(t,r,i){this.name="",this.color=new Ue(t),this.near=r!==void 0?r:1,this.far=i!==void 0?i:1e3}function As(t,r){this.array=t,this.stride=r,this.count=t!==void 0?t.length/r:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function hl(t,r,i,s){this.name="",this.data=t,this.itemSize=r,this.offset=i,this.normalized=s===!0}function cl(t){kr.call(this),this.type="SpriteMaterial",this.color=new Ue(16777215),this.alphaMap=this.map=null,this.rotation=0,this.transparent=this.sizeAttenuation=!0,this.setValues(t)}function ah(t){if(Ce.call(this),this.type="Sprite",_g===void 0){_g=new Ge;var r=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]);r=new As(r,5),_g.setIndex([0,1,2,0,2,3]),_g.setAttribute("position",new hl(r,3,0,!1)),_g.setAttribute("uv",new hl(r,2,3,!1))}this.geometry=_g,this.material=t!==void 0?t:new cl,this.center=new st(.5,.5)}function dd(t,r,i,s,f,c){Tg.subVectors(t,i).addScalar(.5).multiply(s),f!==void 0?(Rv.x=c*Tg.x-f*Tg.y,Rv.y=f*Tg.x+c*Tg.y):Rv.copy(Tg),t.copy(r),t.x+=Rv.x,t.y+=Rv.y,t.applyMatrix4(Fw)}function Zo(){Ce.call(this),this._currentLevel=0,this.type="LOD",Xr(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function Pa(t,r){t&&t.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),dn.call(this,t,r),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new ye,this.bindMatrixInverse=new ye}function aa(t,r){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,r===void 0)this.calculateInverses();else if(this.bones.length===r.length)this.boneInverses=r.slice(0);else for(console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[],t=0,r=this.bones.length;t<r;t++)this.boneInverses.push(new ye)}function Io(){Ce.call(this),this.type="Bone"}function Sr(t,r,i){dn.call(this,t,r),this.instanceMatrix=new Ir(new Float32Array(16*i),16),this.count=i,this.frustumCulled=!1}function yn(t){kr.call(this),this.type="LineBasicMaterial",this.color=new Ue(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.morphTargets=!1,this.setValues(t)}function js(t,r,i){i===1&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),Ce.call(this),this.type="Line",this.geometry=t!==void 0?t:new Ge,this.material=r!==void 0?r:new yn,this.updateMorphTargets()}function zn(t,r){js.call(this,t,r),this.type="LineSegments"}function Un(t,r){js.call(this,t,r),this.type="LineLoop"}function Xs(t){kr.call(this),this.type="PointsMaterial",this.color=new Ue(16777215),this.alphaMap=this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}function Cu(t,r){Ce.call(this),this.type="Points",this.geometry=t!==void 0?t:new Ge,this.material=r!==void 0?r:new Xs,this.updateMorphTargets()}function fc(t,r,i,s,f,c,g){var p=GA.distanceSqToPoint(t);p<i&&(i=new lt,GA.closestPointToPoint(t,i),i.applyMatrix4(s),t=f.ray.origin.distanceTo(i),t<f.near||t>f.far||c.push({distance:t,distanceToRay:Math.sqrt(p),point:i,index:r,face:null,object:g}))}function U0(t,r,i,s,f,c,g,p,A){Pt.call(this,t,r,i,s,f,c,g,p,A),this.format=g!==void 0?g:1022,this.minFilter=c!==void 0?c:1006,this.magFilter=f!==void 0?f:1006,this.generateMipmaps=!1}function Sf(t,r,i,s,f,c,g,p,A,S,N,_){Pt.call(this,null,c,g,p,A,S,s,f,N,_),this.image={width:r,height:i},this.mipmaps=t,this.generateMipmaps=this.flipY=!1}function gd(t,r,i,s,f,c,g,p,A){Pt.call(this,t,r,i,s,f,c,g,p,A),this.needsUpdate=!0}function Ur(t,r,i,s,f,c,g,p,A,S){if(S=S!==void 0?S:1026,S!==1026&&S!==1027)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&S===1026&&(i=1012),i===void 0&&S===1027&&(i=1020),Pt.call(this,null,s,f,c,g,p,S,i,A),this.image={width:t,height:r},this.magFilter=g!==void 0?g:1003,this.minFilter=p!==void 0?p:1003,this.generateMipmaps=this.flipY=!1}function If(t){Ge.call(this),this.type="WireframeGeometry";var r=[],i,s,f,c=[0,0],g={},p=["a","b","c"];if(t&&t.isGeometry){var A=t.faces,S=0;for(s=A.length;S<s;S++){var N=A[S];for(i=0;3>i;i++){var _=N[p[i]],I=N[p[(i+1)%3]];c[0]=Math.min(_,I),c[1]=Math.max(_,I),_=c[0]+","+c[1],g[_]===void 0&&(g[_]={index1:c[0],index2:c[1]})}}for(_ in g)S=g[_],p=t.vertices[S.index1],r.push(p.x,p.y,p.z),p=t.vertices[S.index2],r.push(p.x,p.y,p.z)}else if(t&&t.isBufferGeometry)if(p=new lt,t.index!==null){A=t.attributes.position,N=t.index;var L=t.groups;for(L.length===0&&(L=[{start:0,count:N.count,materialIndex:0}]),t=0,f=L.length;t<f;++t)for(S=L[t],i=S.start,s=S.count,S=i,s=i+s;S<s;S+=3)for(i=0;3>i;i++)_=N.getX(S+i),I=N.getX(S+(i+1)%3),c[0]=Math.min(_,I),c[1]=Math.max(_,I),_=c[0]+","+c[1],g[_]===void 0&&(g[_]={index1:c[0],index2:c[1]});for(_ in g)S=g[_],p.fromBufferAttribute(A,S.index1),r.push(p.x,p.y,p.z),p.fromBufferAttribute(A,S.index2),r.push(p.x,p.y,p.z)}else for(A=t.attributes.position,S=0,s=A.count/3;S<s;S++)for(i=0;3>i;i++)g=3*S+i,p.fromBufferAttribute(A,g),r.push(p.x,p.y,p.z),g=3*S+(i+1)%3,p.fromBufferAttribute(A,g),r.push(p.x,p.y,p.z);this.setAttribute("position",new We(r,3))}function md(t,r,i){Le.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:r,stacks:i},this.fromBufferGeometry(new pc(t,r,i)),this.mergeVertices()}function pc(t,r,i){Ge.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:r,stacks:i};var s=[],f=[],c=[],g=[],p=new lt,A=new lt,S=new lt,N=new lt,_=new lt,I,L;3>t.length&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var P=r+1;for(I=0;I<=i;I++){var F=I/i;for(L=0;L<=r;L++){var W=L/r;t(W,F,A),f.push(A.x,A.y,A.z),0<=W-1e-5?(t(W-1e-5,F,S),N.subVectors(A,S)):(t(W+1e-5,F,S),N.subVectors(S,A)),0<=F-1e-5?(t(W,F-1e-5,S),_.subVectors(A,S)):(t(W,F+1e-5,S),_.subVectors(S,A)),p.crossVectors(N,_).normalize(),c.push(p.x,p.y,p.z),g.push(W,F)}}for(I=0;I<i;I++)for(L=0;L<r;L++)t=I*P+L+1,p=(I+1)*P+L+1,A=(I+1)*P+L,s.push(I*P+L,t,A),s.push(t,p,A);this.setIndex(s),this.setAttribute("position",new We(f,3)),this.setAttribute("normal",new We(c,3)),this.setAttribute("uv",new We(g,2))}function vd(t,r,i,s){Le.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:r,radius:i,detail:s},this.fromBufferGeometry(new zo(t,r,i,s)),this.mergeVertices()}function zo(t,r,i,s){function f(S){p.push(S.x,S.y,S.z)}function c(S,N){S*=3,N.x=t[S+0],N.y=t[S+1],N.z=t[S+2]}function g(S,N,_,I){0>I&&S.x===1&&(A[N]=S.x-1),_.x===0&&_.z===0&&(A[N]=I/2/Math.PI+.5)}Ge.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:r,radius:i,detail:s},i=i||1,s=s||0;var p=[],A=[];(function(S){for(var N=new lt,_=new lt,I=new lt,L=0;L<r.length;L+=3){c(r[L+0],N),c(r[L+1],_),c(r[L+2],I);var P,F,W=N,X=_,Z=I,tt=Math.pow(2,S),ot=[];for(F=0;F<=tt;F++){ot[F]=[];var xt=W.clone().lerp(Z,F/tt),At=X.clone().lerp(Z,F/tt),yt=tt-F;for(P=0;P<=yt;P++)ot[F][P]=P===0&&F===tt?xt:xt.clone().lerp(At,P/yt)}for(F=0;F<tt;F++)for(P=0;P<2*(tt-F)-1;P++)W=Math.floor(P/2),P%2==0?(f(ot[F][W+1]),f(ot[F+1][W]),f(ot[F][W])):(f(ot[F][W+1]),f(ot[F+1][W+1]),f(ot[F+1][W]))}})(s),function(S){for(var N=new lt,_=0;_<p.length;_+=3)N.x=p[_+0],N.y=p[_+1],N.z=p[_+2],N.normalize().multiplyScalar(S),p[_+0]=N.x,p[_+1]=N.y,p[_+2]=N.z}(i),function(){for(var S=new lt,N=0;N<p.length;N+=3)S.x=p[N+0],S.y=p[N+1],S.z=p[N+2],A.push(Math.atan2(S.z,-S.x)/2/Math.PI+.5,1-(Math.atan2(-S.y,Math.sqrt(S.x*S.x+S.z*S.z))/Math.PI+.5));S=new lt,N=new lt;for(var _=new lt,I=new lt,L=new st,P=new st,F=new st,W=0,X=0;W<p.length;W+=9,X+=6){S.set(p[W+0],p[W+1],p[W+2]),N.set(p[W+3],p[W+4],p[W+5]),_.set(p[W+6],p[W+7],p[W+8]),L.set(A[X+0],A[X+1]),P.set(A[X+2],A[X+3]),F.set(A[X+4],A[X+5]),I.copy(S).add(N).add(_).divideScalar(3);var Z=Math.atan2(I.z,-I.x);g(L,X+0,S,Z),g(P,X+2,N,Z),g(F,X+4,_,Z)}for(S=0;S<A.length;S+=6)N=A[S+0],_=A[S+2],I=A[S+4],L=Math.min(N,_,I),.9<Math.max(N,_,I)&&.1>L&&(.2>N&&(A[S+0]+=1),.2>_&&(A[S+2]+=1),.2>I&&(A[S+4]+=1))}(),this.setAttribute("position",new We(p,3)),this.setAttribute("normal",new We(p.slice(),3)),this.setAttribute("uv",new We(A,2)),s===0?this.computeVertexNormals():this.normalizeNormals()}function lr(t,r){Le.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:r},this.fromBufferGeometry(new Ef(t,r)),this.mergeVertices()}function Ef(t,r){zo.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,r),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:r}}function yd(t,r){Le.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:r},this.fromBufferGeometry(new ws(t,r)),this.mergeVertices()}function ws(t,r){zo.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,r),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:r}}function Hn(t,r){Le.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:r},this.fromBufferGeometry(new Lf(t,r)),this.mergeVertices()}function Lf(t,r){var i=(1+Math.sqrt(5))/2;zo.call(this,[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,r),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:r}}function qe(t,r){Le.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:r},this.fromBufferGeometry(new _s(t,r)),this.mergeVertices()}function _s(t,r){var i=(1+Math.sqrt(5))/2,s=1/i;zo.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-s,-i,0,-s,i,0,s,-i,0,s,i,-s,-i,0,-s,i,0,s,-i,0,s,i,0,-i,0,-s,i,0,-s,-i,0,s,i,0,s],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,r),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:r}}function xd(t,r,i,s,f,c){Le.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:r,radius:i,radialSegments:s,closed:f},c!==void 0&&console.warn("THREE.TubeGeometry: taper has been removed."),t=new uh(t,r,i,s,f),this.tangents=t.tangents,this.normals=t.normals,this.binormals=t.binormals,this.fromBufferGeometry(t),this.mergeVertices()}function uh(t,r,i,s,f){function c(X){N=t.getPointAt(X/r,N);var Z=g.normals[X];for(X=g.binormals[X],I=0;I<=s;I++){var tt=I/s*Math.PI*2,ot=Math.sin(tt);tt=-Math.cos(tt),A.x=tt*Z.x+ot*X.x,A.y=tt*Z.y+ot*X.y,A.z=tt*Z.z+ot*X.z,A.normalize(),P.push(A.x,A.y,A.z),p.x=N.x+i*A.x,p.y=N.y+i*A.y,p.z=N.z+i*A.z,L.push(p.x,p.y,p.z)}}Ge.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:r,radius:i,radialSegments:s,closed:f},r=r||64,i=i||1,s=s||8,f=f||!1;var g=t.computeFrenetFrames(r,f);this.tangents=g.tangents,this.normals=g.normals,this.binormals=g.binormals;var p=new lt,A=new lt,S=new st,N=new lt,_,I,L=[],P=[],F=[],W=[];for(_=0;_<r;_++)c(_);for(c(f===!1?r:0),_=0;_<=r;_++)for(I=0;I<=s;I++)S.x=_/r,S.y=I/s,F.push(S.x,S.y);(function(){for(I=1;I<=r;I++)for(_=1;_<=s;_++){var X=(s+1)*I+(_-1),Z=(s+1)*I+_,tt=(s+1)*(I-1)+_;W.push((s+1)*(I-1)+(_-1),X,tt),W.push(X,Z,tt)}})(),this.setIndex(W),this.setAttribute("position",new We(L,3)),this.setAttribute("normal",new We(P,3)),this.setAttribute("uv",new We(F,2))}function dc(t,r,i,s,f,c,g){Le.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:r,tubularSegments:i,radialSegments:s,p:f,q:c},g!==void 0&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Rf(t,r,i,s,f,c)),this.mergeVertices()}function Rf(t,r,i,s,f,c){function g(At,yt,zt,Ht,$t){var Vt=Math.sin(At);yt=zt/yt*At,zt=Math.cos(yt),$t.x=Ht*(2+zt)*.5*Math.cos(At),$t.y=Ht*(2+zt)*Vt*.5,$t.z=Ht*Math.sin(yt)*.5}Ge.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:r,tubularSegments:i,radialSegments:s,p:f,q:c},t=t||1,r=r||.4,i=Math.floor(i)||64,s=Math.floor(s)||8,f=f||2,c=c||3;var p=[],A=[],S=[],N=[],_,I=new lt,L=new lt,P=new lt,F=new lt,W=new lt,X=new lt,Z=new lt;for(_=0;_<=i;++_){var tt=_/i*f*Math.PI*2;for(g(tt,f,c,t,P),g(tt+.01,f,c,t,F),X.subVectors(F,P),Z.addVectors(F,P),W.crossVectors(X,Z),Z.crossVectors(W,X),W.normalize(),Z.normalize(),tt=0;tt<=s;++tt){var ot=tt/s*Math.PI*2,xt=-r*Math.cos(ot);ot=r*Math.sin(ot),I.x=P.x+(xt*Z.x+ot*W.x),I.y=P.y+(xt*Z.y+ot*W.y),I.z=P.z+(xt*Z.z+ot*W.z),A.push(I.x,I.y,I.z),L.subVectors(I,P).normalize(),S.push(L.x,L.y,L.z),N.push(_/i),N.push(tt/s)}}for(tt=1;tt<=i;tt++)for(_=1;_<=s;_++)t=(s+1)*tt+(_-1),r=(s+1)*tt+_,f=(s+1)*(tt-1)+_,p.push((s+1)*(tt-1)+(_-1),t,f),p.push(t,r,f);this.setIndex(p),this.setAttribute("position",new We(A,3)),this.setAttribute("normal",new We(S,3)),this.setAttribute("uv",new We(N,2))}function gc(t,r,i,s,f){Le.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:r,radialSegments:i,tubularSegments:s,arc:f},this.fromBufferGeometry(new fl(t,r,i,s,f)),this.mergeVertices()}function fl(t,r,i,s,f){Ge.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:r,radialSegments:i,tubularSegments:s,arc:f},t=t||1,r=r||.4,i=Math.floor(i)||8,s=Math.floor(s)||6,f=f||2*Math.PI;var c=[],g=[],p=[],A=[],S=new lt,N=new lt,_=new lt,I,L;for(I=0;I<=i;I++)for(L=0;L<=s;L++){var P=L/s*f,F=I/i*Math.PI*2;N.x=(t+r*Math.cos(F))*Math.cos(P),N.y=(t+r*Math.cos(F))*Math.sin(P),N.z=r*Math.sin(F),g.push(N.x,N.y,N.z),S.x=t*Math.cos(P),S.y=t*Math.sin(P),_.subVectors(N,S).normalize(),p.push(_.x,_.y,_.z),A.push(L/s),A.push(I/i)}for(I=1;I<=i;I++)for(L=1;L<=s;L++)t=(s+1)*(I-1)+L-1,r=(s+1)*(I-1)+L,f=(s+1)*I+L,c.push((s+1)*I+L-1,t,f),c.push(t,r,f);this.setIndex(c),this.setAttribute("position",new We(g,3)),this.setAttribute("normal",new We(p,3)),this.setAttribute("uv",new We(A,2))}function Tu(t,r,i,s,f){for(var c,g=0,p=r,A=i-s;p<i;p+=s)g+=(t[A]-t[p])*(t[p+1]+t[A+1]),A=p;if(f===0<g)for(f=r;f<i;f+=s)c=wd(f,t[f],t[f+1],c);else for(f=i-s;f>=r;f-=s)c=wd(f,t[f],t[f+1],c);return c&&mc(c,c.next)&&(yc(c),c=c.next),c}function Sn(t,r){if(!t)return t;r||(r=t);do{var i=!1;if(t.steiner||!mc(t,t.next)&&kn(t.prev,t,t.next)!==0)t=t.next;else{if(yc(t),t=r=t.prev,t===t.next)break;i=!0}}while(i||t!==r);return r}function Pf(t,r,i,s,f,c,g){if(t){if(!g&&c){var p=t,A=p;do A.z===null&&(A.z=Em(A.x,A.y,s,f,c)),A.prevZ=A.prev,A=A.nextZ=A.next;while(A!==p);A.prevZ.nextZ=null,A.prevZ=null,p=A;var S,N,_,I,L=1;do{A=p;var P=p=null;for(N=0;A;){N++;var F=A;for(S=_=0;S<L&&(_++,F=F.nextZ,F);S++);for(I=L;0<_||0<I&&F;)_!==0&&(I===0||!F||A.z<=F.z)?(S=A,A=A.nextZ,_--):(S=F,F=F.nextZ,I--),P?P.nextZ=S:p=S,S.prevZ=P,P=S;A=F}P.nextZ=null,L*=2}while(1<N)}for(p=t;t.prev!==t.next;){if(A=t.prev,F=t.next,c)P=H0(t,s,f,c);else t:if(P=t,N=P.prev,_=P,L=P.next,0<=kn(N,_,L))P=!1;else{for(S=P.next.next;S!==P.prev;){if(pl(N.x,N.y,_.x,_.y,L.x,L.y,S.x,S.y)&&0<=kn(S.prev,S,S.next)){P=!1;break t}S=S.next}P=!0}if(P)r.push(A.i/i),r.push(t.i/i),r.push(F.i/i),yc(t),p=t=F.next;else if(t=F,t===p){if(!g)Pf(Sn(t),r,i,s,f,c,1);else if(g===1){t=Sn(t),g=r,p=i,A=t;do F=A.prev,P=A.next.next,!mc(F,P)&&G0(F,A,A.next,P)&&vc(F,P)&&vc(P,F)&&(g.push(F.i/p),g.push(A.i/p),g.push(P.i/p),yc(A),yc(A.next),A=t=P),A=A.next;while(A!==t);t=Sn(A),Pf(t,r,i,s,f,c,2)}else if(g===2)t:{g=t;do{for(p=g.next.next;p!==g.prev;){if(A=g.i!==p.i){if(A=g,F=p,P=A.next.i!==F.i&&A.prev.i!==F.i){e:{P=A;do{if(P.i!==A.i&&P.next.i!==A.i&&P.i!==F.i&&P.next.i!==F.i&&G0(P,P.next,A,F)){P=!0;break e}P=P.next}while(P!==A);P=!1}P=!P}if(P){if(P=vc(A,F)&&vc(F,A)){P=A,N=!1,_=(A.x+F.x)/2,L=(A.y+F.y)/2;do P.y>L!=P.next.y>L&&P.next.y!==P.y&&_<(P.next.x-P.x)*(L-P.y)/(P.next.y-P.y)+P.x&&(N=!N),P=P.next;while(P!==A);P=N}P=P&&(kn(A.prev,A,F.prev)||kn(A,F.prev,F))||mc(A,F)&&0<kn(A.prev,A,A.next)&&0<kn(F.prev,F,F.next)}A=P}if(A){t=Ad(g,p),g=Sn(g,g.next),t=Sn(t,t.next),Pf(g,r,i,s,f,c),Pf(t,r,i,s,f,c);break t}p=p.next}g=g.next}while(g!==t)}break}}}}function H0(t,r,i,s){var f=t.prev,c=t.next;if(0<=kn(f,t,c))return!1;var g=f.x>t.x?f.x>c.x?f.x:c.x:t.x>c.x?t.x:c.x,p=f.y>t.y?f.y>c.y?f.y:c.y:t.y>c.y?t.y:c.y,A=Em(f.x<t.x?f.x<c.x?f.x:c.x:t.x<c.x?t.x:c.x,f.y<t.y?f.y<c.y?f.y:c.y:t.y<c.y?t.y:c.y,r,i,s);for(r=Em(g,p,r,i,s),i=t.prevZ,s=t.nextZ;i&&i.z>=A&&s&&s.z<=r;){if(i!==t.prev&&i!==t.next&&pl(f.x,f.y,t.x,t.y,c.x,c.y,i.x,i.y)&&0<=kn(i.prev,i,i.next)||(i=i.prevZ,s!==t.prev&&s!==t.next&&pl(f.x,f.y,t.x,t.y,c.x,c.y,s.x,s.y)&&0<=kn(s.prev,s,s.next)))return!1;s=s.nextZ}for(;i&&i.z>=A;){if(i!==t.prev&&i!==t.next&&pl(f.x,f.y,t.x,t.y,c.x,c.y,i.x,i.y)&&0<=kn(i.prev,i,i.next))return!1;i=i.prevZ}for(;s&&s.z<=r;){if(s!==t.prev&&s!==t.next&&pl(f.x,f.y,t.x,t.y,c.x,c.y,s.x,s.y)&&0<=kn(s.prev,s,s.next))return!1;s=s.nextZ}return!0}function lh(t,r){return t.x-r.x}function k0(t,r){var i=r,s=t.x,f=t.y,c=-Infinity;do{if(f<=i.y&&f>=i.next.y&&i.next.y!==i.y){var g=i.x+(f-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(g<=s&&g>c){if(c=g,g===s){if(f===i.y)return i;if(f===i.next.y)return i.next}var p=i.x<i.next.x?i:i.next}}i=i.next}while(i!==r);if(!p)return null;if(s===c)return p;r=p,g=p.x;var A=p.y,S=Infinity;i=p;do{if(s>=i.x&&i.x>=g&&s!==i.x&&pl(f<A?s:c,f,g,A,f<A?c:s,f,i.x,i.y)){var N=Math.abs(f-i.y)/(s-i.x),_;if((_=vc(i,t))&&!(_=N<S)&&(_=N===S)&&!(_=i.x>p.x)&&(_=i.x===p.x)){_=p;var I=i;_=0>kn(_.prev,_,I.prev)&&0>kn(I.next,_,_.next)}_&&(p=i,S=N)}i=i.next}while(i!==r);return p}function Em(t,r,i,s,f){return t=32767*(t-i)*f,r=32767*(r-s)*f,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,(t|t<<1)&1431655765|((r|r<<1)&1431655765)<<1}function Lm(t){var r=t,i=t;do(r.x<i.x||r.x===i.x&&r.y<i.y)&&(i=r),r=r.next;while(r!==t);return i}function pl(t,r,i,s,f,c,g,p){return 0<=(f-g)*(r-p)-(t-g)*(c-p)&&0<=(t-g)*(s-p)-(i-g)*(r-p)&&0<=(i-g)*(c-p)-(f-g)*(s-p)}function kn(t,r,i){return(r.y-t.y)*(i.x-r.x)-(r.x-t.x)*(i.y-r.y)}function mc(t,r){return t.x===r.x&&t.y===r.y}function G0(t,r,i,s){var f=Df(kn(t,r,i)),c=Df(kn(t,r,s)),g=Df(kn(i,s,t)),p=Df(kn(i,s,r));return!!(f!==c&&g!==p||f===0&&Da(t,i,r)||c===0&&Da(t,s,r)||g===0&&Da(i,t,s)||p===0&&Da(i,r,s))}function Da(t,r,i){return r.x<=Math.max(t.x,i.x)&&r.x>=Math.min(t.x,i.x)&&r.y<=Math.max(t.y,i.y)&&r.y>=Math.min(t.y,i.y)}function Df(t){return 0<t?1:0>t?-1:0}function vc(t,r){return 0>kn(t.prev,t,t.next)?0<=kn(t,r,t.next)&&0<=kn(t,t.prev,r):0>kn(t,r,t.prev)||0>kn(t,t.next,r)}function Ad(t,r){var i=new Of(t.i,t.x,t.y),s=new Of(r.i,r.x,r.y),f=t.next,c=r.prev;return t.next=r,r.prev=t,i.next=f,f.prev=i,s.next=i,i.prev=s,c.next=s,s.prev=c,s}function wd(t,r,i,s){return t=new Of(t,r,i),s?(t.next=s.next,t.prev=s,s.next.prev=t,s.next=t):(t.prev=t,t.next=t),t}function yc(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Of(t,r,i){this.i=t,this.x=r,this.y=i,this.nextZ=this.prevZ=this.z=this.next=this.prev=null,this.steiner=!1}function Ff(t){var r=t.length;2<r&&t[r-1].equals(t[0])&&t.pop()}function b0(t,r){for(var i=0;i<r.length;i++)t.push(r[i].x),t.push(r[i].y)}function iu(t,r){Le.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:r},this.fromBufferGeometry(new ua(t,r)),this.mergeVertices()}function ua(t,r){function i(A){function S(ie,Te,mr){return Te||console.error("THREE.ExtrudeGeometry: vec does not exist"),Te.clone().multiplyScalar(mr).add(ie)}function N(ie,Te,mr){var Nr=ie.x-Te.x,we=ie.y-Te.y,nr=mr.x-ie.x,Jr=mr.y-ie.y,je=Nr*Nr+we*we;if(Math.abs(Nr*Jr-we*nr)>Dn){var $n=Math.sqrt(je),Oi=Math.sqrt(nr*nr+Jr*Jr);if(je=Te.x-we/$n,Te=Te.y+Nr/$n,Jr=((mr.x-Jr/Oi-je)*Jr-(mr.y+nr/Oi-Te)*nr)/(Nr*Jr-we*nr),nr=je+Nr*Jr-ie.x,Nr=Te+we*Jr-ie.y,we=nr*nr+Nr*Nr,2>=we)return new st(nr,Nr);we=Math.sqrt(we/2)}else ie=!1,Nr>Dn?nr>Dn&&(ie=!0):Nr<-Dn?nr<-Dn&&(ie=!0):zl(we)===zl(Jr)&&(ie=!0),ie?(nr=-we,we=Math.sqrt(je)):(nr=Nr,Nr=we,we=Math.sqrt(je/2));return new st(nr/we,Nr/we)}function _(ie,Te){for(Tt=ie.length;0<=--Tt;){var mr=Tt,Nr=Tt-1;0>Nr&&(Nr=ie.length-1);var we,nr=Z+2*zt;for(we=0;we<nr;we++){var Jr=et*we,je=et*(we+1),$n=Te+Nr+Jr,Oi=Te+Nr+je;je=Te+mr+je,P(Te+mr+Jr),P($n),P(je),P($n),P(Oi),P(je),Jr=f.length/3,Jr=$t.generateSideWallUV(s,f,Jr-6,Jr-3,Jr-2,Jr-1),F(Jr[0]),F(Jr[1]),F(Jr[3]),F(Jr[1]),F(Jr[2]),F(Jr[3])}}}function I(ie,Te,mr){W.push(ie),W.push(Te),W.push(mr)}function L(ie,Te,mr){P(ie),P(Te),P(mr),ie=f.length/3,ie=$t.generateTopUV(s,f,ie-3,ie-2,ie-1),F(ie[0]),F(ie[1]),F(ie[2])}function P(ie){f.push(W[3*ie]),f.push(W[3*ie+1]),f.push(W[3*ie+2])}function F(ie){c.push(ie.x),c.push(ie.y)}var W=[],X=r.curveSegments!==void 0?r.curveSegments:12,Z=r.steps!==void 0?r.steps:1,tt=r.depth!==void 0?r.depth:100,ot=r.bevelEnabled!==void 0?r.bevelEnabled:!0,xt=r.bevelThickness!==void 0?r.bevelThickness:6,At=r.bevelSize!==void 0?r.bevelSize:xt-2,yt=r.bevelOffset!==void 0?r.bevelOffset:0,zt=r.bevelSegments!==void 0?r.bevelSegments:3,Ht=r.extrudePath,$t=r.UVGenerator!==void 0?r.UVGenerator:fC;r.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),tt=r.amount);var Vt=!1;if(Ht){var Kt=Ht.getSpacedPoints(Z);Vt=!0,ot=!1;var ze=Ht.computeFrenetFrames(Z,!1),ae=new lt,Qe=new lt,gr=new lt}ot||(yt=At=xt=zt=0);var ir;X=A.extractPoints(X),A=X.shape;var gi=X.holes;if(!Yc.isClockWise(A)){A=A.reverse();var hr=0;for(ir=gi.length;hr<ir;hr++){var gt=gi[hr];Yc.isClockWise(gt)&&(gi[hr]=gt.reverse())}}var mt=Yc.triangulateShape(A,gi),vt=A;for(hr=0,ir=gi.length;hr<ir;hr++)gt=gi[hr],A=A.concat(gt);var Ct,et=A.length,ct,ft=mt.length;X=[];var Tt=0,kt=vt.length,Jt=kt-1;for(Ct=Tt+1;Tt<kt;Tt++,Jt++,Ct++)Jt===kt&&(Jt=0),Ct===kt&&(Ct=0),X[Tt]=N(vt[Tt],vt[Jt],vt[Ct]);Ht=[];var pt=X.concat();for(hr=0,ir=gi.length;hr<ir;hr++){gt=gi[hr];var me=[];for(Tt=0,kt=gt.length,Jt=kt-1,Ct=Tt+1;Tt<kt;Tt++,Jt++,Ct++)Jt===kt&&(Jt=0),Ct===kt&&(Ct=0),me[Tt]=N(gt[Tt],gt[Jt],gt[Ct]);Ht.push(me),pt=pt.concat(me)}for(Jt=0;Jt<zt;Jt++){kt=Jt/zt;var Ae=xt*Math.cos(kt*Math.PI/2);for(Ct=At*Math.sin(kt*Math.PI/2)+yt,Tt=0,kt=vt.length;Tt<kt;Tt++){var de=S(vt[Tt],X[Tt],Ct);I(de.x,de.y,-Ae)}for(hr=0,ir=gi.length;hr<ir;hr++)for(gt=gi[hr],me=Ht[hr],Tt=0,kt=gt.length;Tt<kt;Tt++)de=S(gt[Tt],me[Tt],Ct),I(de.x,de.y,-Ae)}for(Ct=At+yt,Tt=0;Tt<et;Tt++)de=ot?S(A[Tt],pt[Tt],Ct):A[Tt],Vt?(Qe.copy(ze.normals[0]).multiplyScalar(de.x),ae.copy(ze.binormals[0]).multiplyScalar(de.y),gr.copy(Kt[0]).add(Qe).add(ae),I(gr.x,gr.y,gr.z)):I(de.x,de.y,0);for(kt=1;kt<=Z;kt++)for(Tt=0;Tt<et;Tt++)de=ot?S(A[Tt],pt[Tt],Ct):A[Tt],Vt?(Qe.copy(ze.normals[kt]).multiplyScalar(de.x),ae.copy(ze.binormals[kt]).multiplyScalar(de.y),gr.copy(Kt[kt]).add(Qe).add(ae),I(gr.x,gr.y,gr.z)):I(de.x,de.y,tt/Z*kt);for(Jt=zt-1;0<=Jt;Jt--){for(kt=Jt/zt,Ae=xt*Math.cos(kt*Math.PI/2),Ct=At*Math.sin(kt*Math.PI/2)+yt,Tt=0,kt=vt.length;Tt<kt;Tt++)de=S(vt[Tt],X[Tt],Ct),I(de.x,de.y,tt+Ae);for(hr=0,ir=gi.length;hr<ir;hr++)for(gt=gi[hr],me=Ht[hr],Tt=0,kt=gt.length;Tt<kt;Tt++)de=S(gt[Tt],me[Tt],Ct),Vt?I(de.x,de.y+Kt[Z-1].y,Kt[Z-1].x+Ae):I(de.x,de.y,tt+Ae)}(function(){var ie=f.length/3;if(ot){var Te=0*et;for(Tt=0;Tt<ft;Tt++)ct=mt[Tt],L(ct[2]+Te,ct[1]+Te,ct[0]+Te);for(Te=et*(Z+2*zt),Tt=0;Tt<ft;Tt++)ct=mt[Tt],L(ct[0]+Te,ct[1]+Te,ct[2]+Te)}else{for(Tt=0;Tt<ft;Tt++)ct=mt[Tt],L(ct[2],ct[1],ct[0]);for(Tt=0;Tt<ft;Tt++)ct=mt[Tt],L(ct[0]+et*Z,ct[1]+et*Z,ct[2]+et*Z)}s.addGroup(ie,f.length/3-ie,0)})(),function(){var ie=f.length/3,Te=0;for(_(vt,Te),Te+=vt.length,hr=0,ir=gi.length;hr<ir;hr++)gt=gi[hr],_(gt,Te),Te+=gt.length;s.addGroup(ie,f.length/3-ie,1)}()}Ge.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:r},t=Array.isArray(t)?t:[t];for(var s=this,f=[],c=[],g=0,p=t.length;g<p;g++)i(t[g]);this.setAttribute("position",new We(f,3)),this.setAttribute("uv",new We(c,2)),this.computeVertexNormals()}function V0(t,r,i){if(i.shapes=[],Array.isArray(t))for(var s=0,f=t.length;s<f;s++)i.shapes.push(t[s].uuid);else i.shapes.push(t.uuid);return r.extrudePath!==void 0&&(i.options.extrudePath=r.extrudePath.toJSON()),i}function xc(t,r){Le.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:r},this.fromBufferGeometry(new hh(t,r)),this.mergeVertices()}function hh(t,r){r=r||{};var i=r.font;if(!i||!i.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Le;t=i.generateShapes(t,r.size),r.depth=r.height!==void 0?r.height:50,r.bevelThickness===void 0&&(r.bevelThickness=10),r.bevelSize===void 0&&(r.bevelSize=8),r.bevelEnabled===void 0&&(r.bevelEnabled=!1),ua.call(this,t,r),this.type="TextBufferGeometry"}function _d(t,r,i,s,f,c,g){Le.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:r,heightSegments:i,phiStart:s,phiLength:f,thetaStart:c,thetaLength:g},this.fromBufferGeometry(new ch(t,r,i,s,f,c,g)),this.mergeVertices()}function ch(t,r,i,s,f,c,g){Ge.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:r,heightSegments:i,phiStart:s,phiLength:f,thetaStart:c,thetaLength:g},t=t||1,r=Math.max(3,Math.floor(r)||8),i=Math.max(2,Math.floor(i)||6),s=s!==void 0?s:0,f=f!==void 0?f:2*Math.PI,c=c!==void 0?c:0,g=g!==void 0?g:Math.PI;var p=Math.min(c+g,Math.PI),A,S,N=0,_=[],I=new lt,L=new lt,P=[],F=[],W=[],X=[];for(S=0;S<=i;S++){var Z=[],tt=S/i,ot=0;for(S==0&&c==0?ot=.5/r:S==i&&p==Math.PI&&(ot=-.5/r),A=0;A<=r;A++){var xt=A/r;I.x=-t*Math.cos(s+xt*f)*Math.sin(c+tt*g),I.y=t*Math.cos(c+tt*g),I.z=t*Math.sin(s+xt*f)*Math.sin(c+tt*g),F.push(I.x,I.y,I.z),L.copy(I).normalize(),W.push(L.x,L.y,L.z),X.push(xt+ot,1-tt),Z.push(N++)}_.push(Z)}for(S=0;S<i;S++)for(A=0;A<r;A++)t=_[S][A+1],s=_[S][A],f=_[S+1][A],g=_[S+1][A+1],(S!==0||0<c)&&P.push(t,s,g),(S!==i-1||p<Math.PI)&&P.push(s,f,g);this.setIndex(P),this.setAttribute("position",new We(F,3)),this.setAttribute("normal",new We(W,3)),this.setAttribute("uv",new We(X,2))}function Bf(t,r,i,s,f,c){Le.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:r,thetaSegments:i,phiSegments:s,thetaStart:f,thetaLength:c},this.fromBufferGeometry(new Nf(t,r,i,s,f,c)),this.mergeVertices()}function Nf(t,r,i,s,f,c){Ge.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:r,thetaSegments:i,phiSegments:s,thetaStart:f,thetaLength:c},t=t||.5,r=r||1,f=f!==void 0?f:0,c=c!==void 0?c:2*Math.PI,i=i!==void 0?Math.max(3,i):8,s=s!==void 0?Math.max(1,s):1;var g=[],p=[],A=[],S=[],N=t,_=(r-t)/s,I=new lt,L=new st,P,F;for(P=0;P<=s;P++){for(F=0;F<=i;F++)t=f+F/i*c,I.x=N*Math.cos(t),I.y=N*Math.sin(t),p.push(I.x,I.y,I.z),A.push(0,0,1),L.x=(I.x/r+1)/2,L.y=(I.y/r+1)/2,S.push(L.x,L.y);N+=_}for(P=0;P<s;P++)for(r=P*(i+1),F=0;F<i;F++)t=F+r,f=t+i+1,c=t+i+2,N=t+1,g.push(t,f,N),g.push(f,c,N);this.setIndex(g),this.setAttribute("position",new We(p,3)),this.setAttribute("normal",new We(A,3)),this.setAttribute("uv",new We(S,2))}function zf(t,r,i,s){Le.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:r,phiStart:i,phiLength:s},this.fromBufferGeometry(new Ac(t,r,i,s)),this.mergeVertices()}function Ac(t,r,i,s){Ge.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:r,phiStart:i,phiLength:s},r=Math.floor(r)||12,i=i||0,s=s||2*Math.PI,s=Ar.clamp(s,0,2*Math.PI);var f=[],c=[],g=[],p=1/r,A=new lt,S=new st,N;for(N=0;N<=r;N++){var _=i+N*p*s,I=Math.sin(_),L=Math.cos(_);for(_=0;_<=t.length-1;_++)A.x=t[_].x*I,A.y=t[_].y,A.z=t[_].x*L,c.push(A.x,A.y,A.z),S.x=N/r,S.y=_/(t.length-1),g.push(S.x,S.y)}for(N=0;N<r;N++)for(_=0;_<t.length-1;_++)i=_+N*t.length,p=i+t.length,A=i+t.length+1,S=i+1,f.push(i,p,S),f.push(p,A,S);if(this.setIndex(f),this.setAttribute("position",new We(c,3)),this.setAttribute("uv",new We(g,2)),this.computeVertexNormals(),s===2*Math.PI)for(s=this.attributes.normal.array,f=new lt,c=new lt,g=new lt,i=r*t.length*3,_=N=0;N<t.length;N++,_+=3)f.x=s[_+0],f.y=s[_+1],f.z=s[_+2],c.x=s[i+_+0],c.y=s[i+_+1],c.z=s[i+_+2],g.addVectors(f,c).normalize(),s[_+0]=s[i+_+0]=g.x,s[_+1]=s[i+_+1]=g.y,s[_+2]=s[i+_+2]=g.z}function fh(t,r){Le.call(this),this.type="ShapeGeometry",(typeof r=="undefined"?"undefined":Ua(r))==="object"&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),r=r.curveSegments),this.parameters={shapes:t,curveSegments:r},this.fromBufferGeometry(new Su(t,r)),this.mergeVertices()}function Su(t,r){function i(N){var _,I=f.length/3;N=N.extractPoints(r);var L=N.shape,P=N.holes;for(Yc.isClockWise(L)===!1&&(L=L.reverse()),N=0,_=P.length;N<_;N++){var F=P[N];Yc.isClockWise(F)===!0&&(P[N]=F.reverse())}var W=Yc.triangulateShape(L,P);for(N=0,_=P.length;N<_;N++)F=P[N],L=L.concat(F);for(N=0,_=L.length;N<_;N++)F=L[N],f.push(F.x,F.y,0),c.push(0,0,1),g.push(F.x,F.y);for(N=0,_=W.length;N<_;N++)L=W[N],s.push(L[0]+I,L[1]+I,L[2]+I),A+=3}Ge.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:r},r=r||12;var s=[],f=[],c=[],g=[],p=0,A=0;if(Array.isArray(t)===!1)i(t);else for(var S=0;S<t.length;S++)i(t[S]),this.addGroup(p,A,S),p+=A,A=0;this.setIndex(s),this.setAttribute("position",new We(f,3)),this.setAttribute("normal",new We(c,3)),this.setAttribute("uv",new We(g,2))}function W0(t,r){if(r.shapes=[],Array.isArray(t))for(var i=0,s=t.length;i<s;i++)r.shapes.push(t[i].uuid);else r.shapes.push(t.uuid);return r}function Uf(t,r){Ge.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:r};var i=[];r=Math.cos(Ar.DEG2RAD*(r!==void 0?r:1));var s=[0,0],f={},c=["a","b","c"];if(t.isBufferGeometry){var g=new Le;g.fromBufferGeometry(t)}else g=t.clone();g.mergeVertices(),g.computeFaceNormals(),t=g.vertices,g=g.faces;for(var p=0,A=g.length;p<A;p++)for(var S=g[p],N=0;3>N;N++){var _=S[c[N]],I=S[c[(N+1)%3]];s[0]=Math.min(_,I),s[1]=Math.max(_,I),_=s[0]+","+s[1],f[_]===void 0?f[_]={index1:s[0],index2:s[1],face1:p,face2:void 0}:f[_].face2=p}for(_ in f)s=f[_],(s.face2===void 0||g[s.face1].normal.dot(g[s.face2].normal)<=r)&&(c=t[s.index1],i.push(c.x,c.y,c.z),c=t[s.index2],i.push(c.x,c.y,c.z));this.setAttribute("position",new We(i,3))}function la(t,r,i,s,f,c,g,p){Le.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:r,height:i,radialSegments:s,heightSegments:f,openEnded:c,thetaStart:g,thetaLength:p},this.fromBufferGeometry(new Iu(t,r,i,s,f,c,g,p)),this.mergeVertices()}function Iu(t,r,i,s,f,c,g,p){function A(Z){var tt,ot=new st,xt=new lt,At=0,yt=Z===!0?t:r,zt=Z===!0?1:-1,Ht=P;for(tt=1;tt<=s;tt++)_.push(0,W*zt,0),I.push(0,zt,0),L.push(.5,.5),P++;var $t=P;for(tt=0;tt<=s;tt++){var Vt=tt/s*p+g,Kt=Math.cos(Vt);Vt=Math.sin(Vt),xt.x=yt*Vt,xt.y=W*zt,xt.z=yt*Kt,_.push(xt.x,xt.y,xt.z),I.push(0,zt,0),ot.x=.5*Kt+.5,ot.y=.5*Vt*zt+.5,L.push(ot.x,ot.y),P++}for(tt=0;tt<s;tt++)ot=Ht+tt,xt=$t+tt,Z===!0?N.push(xt,xt+1,ot):N.push(xt+1,xt,ot),At+=3;S.addGroup(X,At,Z===!0?1:2),X+=At}Ge.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:r,height:i,radialSegments:s,heightSegments:f,openEnded:c,thetaStart:g,thetaLength:p};var S=this;t=t!==void 0?t:1,r=r!==void 0?r:1,i=i||1,s=Math.floor(s)||8,f=Math.floor(f)||1,c=c!==void 0?c:!1,g=g!==void 0?g:0,p=p!==void 0?p:2*Math.PI;var N=[],_=[],I=[],L=[],P=0,F=[],W=i/2,X=0;(function(){var Z,tt,ot=new lt,xt=new lt,At=0,yt=(r-t)/i;for(tt=0;tt<=f;tt++){var zt=[],Ht=tt/f,$t=Ht*(r-t)+t;for(Z=0;Z<=s;Z++){var Vt=Z/s,Kt=Vt*p+g,ze=Math.sin(Kt);Kt=Math.cos(Kt),xt.x=$t*ze,xt.y=-Ht*i+W,xt.z=$t*Kt,_.push(xt.x,xt.y,xt.z),ot.set(ze,yt,Kt).normalize(),I.push(ot.x,ot.y,ot.z),L.push(Vt,1-Ht),zt.push(P++)}F.push(zt)}for(Z=0;Z<s;Z++)for(tt=0;tt<f;tt++)ot=F[tt+1][Z],xt=F[tt+1][Z+1],yt=F[tt][Z+1],N.push(F[tt][Z],ot,yt),N.push(ot,xt,yt),At+=6;S.addGroup(X,At,0),X+=At})(),c===!1&&(0<t&&A(!0),0<r&&A(!1)),this.setIndex(N),this.setAttribute("position",new We(_,3)),this.setAttribute("normal",new We(I,3)),this.setAttribute("uv",new We(L,2))}function Uo(t,r,i,s,f,c,g){la.call(this,0,t,r,i,s,f,c,g),this.type="ConeGeometry",this.parameters={radius:t,height:r,radialSegments:i,heightSegments:s,openEnded:f,thetaStart:c,thetaLength:g}}function ph(t,r,i,s,f,c,g){Iu.call(this,0,t,r,i,s,f,c,g),this.type="ConeBufferGeometry",this.parameters={radius:t,height:r,radialSegments:i,heightSegments:s,openEnded:f,thetaStart:c,thetaLength:g}}function dh(t,r,i,s){Le.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:r,thetaStart:i,thetaLength:s},this.fromBufferGeometry(new Eo(t,r,i,s)),this.mergeVertices()}function Eo(t,r,i,s){Ge.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:r,thetaStart:i,thetaLength:s},t=t||1,r=r!==void 0?Math.max(3,r):8,i=i!==void 0?i:0,s=s!==void 0?s:2*Math.PI;var f=[],c=[],g=[],p=[],A,S=new lt,N=new st;c.push(0,0,0),g.push(0,0,1),p.push(.5,.5);var _=0;for(A=3;_<=r;_++,A+=3){var I=i+_/r*s;S.x=t*Math.cos(I),S.y=t*Math.sin(I),c.push(S.x,S.y,S.z),g.push(0,0,1),N.x=(c[A]/t+1)/2,N.y=(c[A+1]/t+1)/2,p.push(N.x,N.y)}for(A=1;A<=r;A++)f.push(A,A+1,0);this.setIndex(f),this.setAttribute("position",new We(c,3)),this.setAttribute("normal",new We(g,3)),this.setAttribute("uv",new We(p,2))}function gh(t){kr.call(this),this.type="ShadowMaterial",this.color=new Ue(0),this.transparent=!0,this.setValues(t)}function Hf(t){$e.call(this,t),this.type="RawShaderMaterial"}function Lo(t){kr.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ue(16777215),this.roughness=1,this.metalness=0,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ue(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new st(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexTangents=this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function ns(t){Lo.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new st(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transparency=0,this.setValues(t)}function Ys(t){kr.call(this),this.type="MeshPhongMaterial",this.color=new Ue(16777215),this.specular=new Ue(1118481),this.shininess=30,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ue(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new st(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function Jo(t){kr.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ue(16777215),this.specular=new Ue(1118481),this.shininess=30,this.lightMap=this.gradientMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ue(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new st(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=this.specularMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function Oa(t){kr.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new st(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.fog=!1,this.setValues(t)}function dl(t){kr.call(this),this.type="MeshLambertMaterial",this.color=new Ue(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ue(0),this.emissiveIntensity=1,this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function gl(t){kr.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ue(16777215),this.bumpMap=this.map=this.matcap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new st(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function ml(t){yn.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}function os(t,r,i,s){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new r.constructor(i),this.sampleValues=r,this.valueSize=i}function kf(t,r,i,s){os.call(this,t,r,i,s),this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0}function mh(t,r,i,s){os.call(this,t,r,i,s)}function Md(t,r,i,s){os.call(this,t,r,i,s)}function qo(t,r,i,s){if(t===void 0)throw Error("THREE.KeyframeTrack: track name is undefined");if(r===void 0||r.length===0)throw Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=uo.convertArray(r,this.TimeBufferType),this.values=uo.convertArray(i,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}function Cd(t,r,i){qo.call(this,t,r,i)}function Td(t,r,i,s){qo.call(this,t,r,i,s)}function vh(t,r,i,s){qo.call(this,t,r,i,s)}function Sd(t,r,i,s){os.call(this,t,r,i,s)}function wc(t,r,i,s){qo.call(this,t,r,i,s)}function Id(t,r,i,s){qo.call(this,t,r,i,s)}function yh(t,r,i,s){qo.call(this,t,r,i,s)}function ha(t,r,i,s){this.name=t,this.tracks=i,this.duration=r!==void 0?r:-1,this.blendMode=s!==void 0?s:2500,this.uuid=Ar.generateUUID(),0>this.duration&&this.resetDuration()}function Gf(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return vh;case"vector":case"vector2":case"vector3":case"vector4":return yh;case"color":return Td;case"quaternion":return wc;case"bool":case"boolean":return Cd;case"string":return Id}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function j0(t){if(t.type===void 0)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");var r=Gf(t.type);if(t.times===void 0){var i=[],s=[];uo.flattenJSON(t.keys,i,s,"value"),t.times=i,t.values=s}return r.parse!==void 0?r.parse(t):new r(t.name,t.times,t.values,t.interpolation)}function xh(t,r,i){var s=this,f=!1,c=0,g=0,p=void 0,A=[];this.onStart=void 0,this.onLoad=t,this.onProgress=r,this.onError=i,this.itemStart=function(S){g++,f===!1&&s.onStart!==void 0&&s.onStart(S,c,g),f=!0},this.itemEnd=function(S){c++,s.onProgress!==void 0&&s.onProgress(S,c,g),c===g&&(f=!1,s.onLoad!==void 0)&&s.onLoad()},this.itemError=function(S){s.onError!==void 0&&s.onError(S)},this.resolveURL=function(S){return p?p(S):S},this.setURLModifier=function(S){return p=S,this},this.addHandler=function(S,N){return A.push(S,N),this},this.removeHandler=function(S){return S=A.indexOf(S),S!==-1&&A.splice(S,2),this},this.getHandler=function(S){for(var N=0,_=A.length;N<_;N+=2){var I=A[N],L=A[N+1];if(I.global&&(I.lastIndex=0),I.test(S))return L}return null}}function si(t){this.manager=t!==void 0?t:jw,this.crossOrigin="anonymous",this.resourcePath=this.path="",this.requestHeader={}}function Ms(t){si.call(this,t)}function Pr(t){si.call(this,t)}function X0(t){si.call(this,t)}function Y0(t){si.call(this,t)}function _c(t){si.call(this,t)}function Rm(t){si.call(this,t)}function bf(t){si.call(this,t)}function Vr(){this.type="Curve",this.arcLengthDivisions=200}function ca(t,r,i,s,f,c,g,p){Vr.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=r||0,this.xRadius=i||1,this.yRadius=s||1,this.aStartAngle=f||0,this.aEndAngle=c||2*Math.PI,this.aClockwise=g||!1,this.aRotation=p||0}function Vf(t,r,i,s,f,c){ca.call(this,t,r,i,i,s,f,c),this.type="ArcCurve"}function Rr(){var t=0,r=0,i=0,s=0;return{initCatmullRom:function(f,c,g,p,A){f=A*(g-f),p=A*(p-c),t=c,r=f,i=-3*c+3*g-2*f-p,s=2*c-2*g+f+p},initNonuniformCatmullRom:function(f,c,g,p,A,S,N){f=((c-f)/A-(g-f)/(A+S)+(g-c)/S)*S,p=((g-c)/S-(p-c)/(S+N)+(p-g)/N)*S,t=c,r=f,i=-3*c+3*g-2*f-p,s=2*c-2*g+f+p},calc:function(f){var c=f*f;return t+r*f+i*c+s*c*f}}}function ss(t,r,i,s){Vr.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=r||!1,this.curveType=i||"centripetal",this.tension=s||.5}function Z0(t,r,i,s,f){r=.5*(s-r),f=.5*(f-i);var c=t*t;return(2*i-2*s+r+f)*t*c+(-3*i+3*s-2*r-f)*c+r*t+i}function vl(t,r,i,s){var f=1-t;return f*f*r+2*(1-t)*t*i+t*t*s}function Wf(t,r,i,s,f){var c=1-t,g=1-t;return c*c*c*r+3*g*g*t*i+3*(1-t)*t*t*s+t*t*t*f}function nu(t,r,i,s){Vr.call(this),this.type="CubicBezierCurve",this.v0=t||new st,this.v1=r||new st,this.v2=i||new st,this.v3=s||new st}function Zs(t,r,i,s){Vr.call(this),this.type="CubicBezierCurve3",this.v0=t||new lt,this.v1=r||new lt,this.v2=i||new lt,this.v3=s||new lt}function Js(t,r){Vr.call(this),this.type="LineCurve",this.v1=t||new st,this.v2=r||new st}function fa(t,r){Vr.call(this),this.type="LineCurve3",this.v1=t||new lt,this.v2=r||new lt}function ou(t,r,i){Vr.call(this),this.type="QuadraticBezierCurve",this.v0=t||new st,this.v1=r||new st,this.v2=i||new st}function qs(t,r,i){Vr.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new lt,this.v1=r||new lt,this.v2=i||new lt}function as(t){Vr.call(this),this.type="SplineCurve",this.points=t||[]}function yl(){Vr.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Pi(t){yl.call(this),this.type="Path",this.currentPoint=new st,t&&this.setFromPoints(t)}function xl(t){Pi.call(this,t),this.uuid=Ar.generateUUID(),this.type="Shape",this.holes=[]}function In(t,r){Ce.call(this),this.type="Light",this.color=new Ue(t),this.intensity=r!==void 0?r:1,this.receiveShadow=void 0}function Ed(t,r,i){In.call(this,t,i),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Ce.DefaultUp),this.updateMatrix(),this.groundColor=new Ue(r)}function Fa(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new st(512,512),this.mapPass=this.map=null,this.matrix=new ye,this._frustum=new mi,this._frameExtents=new st(1,1),this._viewportCount=1,this._viewports=[new It(0,0,1,1)]}function Ld(){Fa.call(this,new Cr(50,1,.5,500))}function jf(t,r,i,s,f,c){In.call(this,t,r),this.type="SpotLight",this.position.copy(Ce.DefaultUp),this.updateMatrix(),this.target=new Ce,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(g){this.intensity=g/Math.PI}}),this.distance=i!==void 0?i:0,this.angle=s!==void 0?s:Math.PI/3,this.penumbra=f!==void 0?f:0,this.decay=c!==void 0?c:1,this.shadow=new Ld}function Pm(){Fa.call(this,new Cr(90,1,.5,500)),this._frameExtents=new st(4,2),this._viewportCount=6,this._viewports=[new It(2,1,1,1),new It(0,1,1,1),new It(3,1,1,1),new It(1,1,1,1),new It(3,0,1,1),new It(1,0,1,1)],this._cubeDirections=[new lt(1,0,0),new lt(-1,0,0),new lt(0,0,1),new lt(0,0,-1),new lt(0,1,0),new lt(0,-1,0)],this._cubeUps=[new lt(0,1,0),new lt(0,1,0),new lt(0,1,0),new lt(0,1,0),new lt(0,0,1),new lt(0,0,-1)]}function Al(t,r,i,s){In.call(this,t,r),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(f){this.intensity=f/(4*Math.PI)}}),this.distance=i!==void 0?i:0,this.decay=s!==void 0?s:1,this.shadow=new Pm}function Ba(t,r,i,s,f,c){Gr.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t!==void 0?t:-1,this.right=r!==void 0?r:1,this.top=i!==void 0?i:1,this.bottom=s!==void 0?s:-1,this.near=f!==void 0?f:.1,this.far=c!==void 0?c:2e3,this.updateProjectionMatrix()}function Dm(){Fa.call(this,new Ba(-5,5,5,-5,.5,500))}function ri(t,r){In.call(this,t,r),this.type="DirectionalLight",this.position.copy(Ce.DefaultUp),this.updateMatrix(),this.target=new Ce,this.shadow=new Dm}function Om(t,r){In.call(this,t,r),this.type="AmbientLight",this.castShadow=void 0}function Fm(t,r,i,s){In.call(this,t,r),this.type="RectAreaLight",this.width=i!==void 0?i:10,this.height=s!==void 0?s:10}function Bm(){this.coefficients=[];for(var t=0;9>t;t++)this.coefficients.push(new lt)}function pa(t,r){In.call(this,void 0,r),this.type="LightProbe",this.sh=t!==void 0?t:new Bm}function Rd(t){si.call(this,t),this.textures={}}function Pd(){Ge.call(this),this.type="InstancedBufferGeometry",this.instanceCount=Infinity}function Nm(t,r,i,s){typeof i=="number"&&(s=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Ir.call(this,t,r,i),this.meshPerAttribute=s||1}function Ah(t){si.call(this,t)}function Ks(t){si.call(this,t)}function J0(t){typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),si.call(this,t),this.options=void 0}function q0(){this.type="ShapePath",this.color=new Ue,this.subPaths=[],this.currentPath=null}function K0(t){this.type="Font",this.data=t}function Mc(t){si.call(this,t)}function Gn(t){si.call(this,t)}function Cc(t,r,i){pa.call(this,void 0,i),t=new Ue().set(t),i=new Ue().set(r),r=new lt(t.r,t.g,t.b),t=new lt(i.r,i.g,i.b),i=Math.sqrt(Math.PI);var s=i*Math.sqrt(.75);this.sh.coefficients[0].copy(r).add(t).multiplyScalar(i),this.sh.coefficients[1].copy(r).sub(t).multiplyScalar(s)}function Tc(t,r){pa.call(this,void 0,r),t=new Ue().set(t),this.sh.coefficients[0].set(t.r,t.g,t.b).multiplyScalar(2*Math.sqrt(Math.PI))}function Eu(t){this.autoStart=t!==void 0?t:!0,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1}function Q0(){Ce.call(this),this.type="AudioListener",this.context=Zw.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Eu}function su(t){Ce.call(this),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.offset=this.loopEnd=this.loopStart=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._progress=this._startedAt=0,this.filters=[]}function Cs(t){su.call(this,t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function Dd(t,r){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=r!==void 0?r:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function zm(t,r,i){switch(this.binding=t,this.valueSize=i,r){case"quaternion":t=this._slerp,r=this._slerpAdditive;var s=this._setAdditiveIdentityQuaternion;this.buffer=new Float64Array(6*i),this._workIndex=5;break;case"string":case"bool":r=t=this._select,s=this._setAdditiveIdentityOther,this.buffer=Array(5*i);break;default:t=this._lerp,r=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*i)}this._mixBufferRegion=t,this._mixBufferRegionAdditive=r,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.referenceCount=this.useCount=this.cumulativeWeightAdditive=this.cumulativeWeight=0}function Od(t,r,i){i=i||wo.parseTrackName(r),this._targetGroup=t,this._bindings=t.subscribe_(r,i)}function wo(t,r,i){this.path=r,this.parsedPath=i||wo.parseTrackName(r),this.node=wo.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function $0(t,r,i,s){this._mixer=t,this._clip=r,this._localRoot=i||null,this.blendMode=s||r.blendMode,t=r.tracks,r=t.length,i=Array(r),s={endingStart:2400,endingEnd:2400};for(var f=0;f!==r;++f){var c=t[f].createInterpolant(null);i[f]=c,c.settings=s}this._interpolantSettings=s,this._interpolants=i,this._propertyBindings=Array(r),this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1,this.repetitions=Infinity,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}function Fd(t){this._root=t,this._initMemoryManager(),this.time=this._accuIndex=0,this.timeScale=1}function Lu(t,r){typeof t=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=r),this.value=t}function Bd(t,r,i){As.call(this,t,r),this.meshPerAttribute=i||1}function Sc(t,r,i,s){this.ray=new xo(t,r),this.near=i||0,this.far=s||Infinity,this.camera=null,this.layers=new Or,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Xr(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Um(t,r){return t.distance-r.distance}function wh(t,r,i,s){if(t.layers.test(r.layers)&&t.raycast(r,i),s===!0){t=t.children,s=0;for(var f=t.length;s<f;s++)wh(t[s],r,i,!0)}}function Hm(t,r){this.min=t!==void 0?t:new st(Infinity,Infinity),this.max=r!==void 0?r:new st(-Infinity,-Infinity)}function Nd(t,r){this.start=t!==void 0?t:new lt,this.end=r!==void 0?r:new lt}function _h(t){Ce.call(this),this.material=t,this.render=function(){},this.hasUvs=this.hasColors=this.hasNormals=this.hasPositions=!1,this.uvArray=this.colorArray=this.normalArray=this.positionArray=null,this.count=0}function Xf(t,r){Ce.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,t=new Ge,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(var i=0,s=1;32>i;i++,s++){var f=i/32*Math.PI*2,c=s/32*Math.PI*2;r.push(Math.cos(f),Math.sin(f),1,Math.cos(c),Math.sin(c),1)}t.setAttribute("position",new We(r,3)),r=new yn({fog:!1,toneMapped:!1}),this.cone=new zn(t,r),this.add(this.cone),this.update()}function km(t){var r=[];t&&t.isBone&&r.push(t);for(var i=0;i<t.children.length;i++)r.push.apply(r,km(t.children[i]));return r}function Ts(t){for(var r=km(t),i=new Ge,s=[],f=[],c=new Ue(0,0,1),g=new Ue(0,1,0),p=0;p<r.length;p++){var A=r[p];A.parent&&A.parent.isBone&&(s.push(0,0,0),s.push(0,0,0),f.push(c.r,c.g,c.b),f.push(g.r,g.g,g.b))}i.setAttribute("position",new We(s,3)),i.setAttribute("color",new We(f,3)),s=new yn({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0}),zn.call(this,i,s),this.type="SkeletonHelper",this.root=t,this.bones=r,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function Ru(t,r,i){this.light=t,this.light.updateMatrixWorld(),this.color=i,t=new ch(r,4,2),r=new ro({wireframe:!0,fog:!1,toneMapped:!1}),dn.call(this,t,r),this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Na(t,r,i){Ce.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,t=new ws(r),t.rotateY(.5*Math.PI),this.material=new ro({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0),r=t.getAttribute("position"),r=new Float32Array(3*r.count),t.setAttribute("color",new Ir(r,3)),this.add(new dn(t,this.material)),this.update()}function Mh(t,r,i,s){t=t||10,r=r||10,i=new Ue(i!==void 0?i:4473924),s=new Ue(s!==void 0?s:8947848);var f=r/2,c=t/r,g=t/2;t=[];for(var p=[],A=0,S=0,N=-g;A<=r;A++,N+=c){t.push(-g,0,N,g,0,N),t.push(N,0,-g,N,0,g);var _=A===f?i:s;_.toArray(p,S),S+=3,_.toArray(p,S),S+=3,_.toArray(p,S),S+=3,_.toArray(p,S),S+=3}r=new Ge,r.setAttribute("position",new We(t,3)),r.setAttribute("color",new We(p,3)),i=new yn({vertexColors:!0,toneMapped:!1}),zn.call(this,r,i),this.type="GridHelper"}function Yf(t,r,i,s,f,c){t=t||10,r=r||16,i=i||8,s=s||64,f=new Ue(f!==void 0?f:4473924),c=new Ue(c!==void 0?c:8947848);var g=[],p=[],A;for(A=0;A<=r;A++){var S=A/r*2*Math.PI,N=Math.sin(S)*t;S=Math.cos(S)*t,g.push(0,0,0),g.push(N,0,S);var _=A&1?f:c;p.push(_.r,_.g,_.b),p.push(_.r,_.g,_.b)}for(A=0;A<=i;A++){_=A&1?f:c;var I=t-t/i*A;for(r=0;r<s;r++)S=r/s*2*Math.PI,N=Math.sin(S)*I,S=Math.cos(S)*I,g.push(N,0,S),p.push(_.r,_.g,_.b),S=(r+1)/s*2*Math.PI,N=Math.sin(S)*I,S=Math.cos(S)*I,g.push(N,0,S),p.push(_.r,_.g,_.b)}t=new Ge,t.setAttribute("position",new We(g,3)),t.setAttribute("color",new We(p,3)),g=new yn({vertexColors:!0,toneMapped:!1}),zn.call(this,t,g),this.type="PolarGridHelper"}function wl(t,r,i){Ce.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,r===void 0&&(r=1),t=new Ge,t.setAttribute("position",new We([-r,r,0,r,r,0,r,-r,0,-r,-r,0,-r,r,0],3)),r=new yn({fog:!1,toneMapped:!1}),this.lightPlane=new js(t,r),this.add(this.lightPlane),t=new Ge,t.setAttribute("position",new We([0,0,0,0,0,1],3)),this.targetLine=new js(t,r),this.add(this.targetLine),this.update()}function Zf(t){function r(L,P,F){i(L,F),i(P,F)}function i(L,P){c.push(0,0,0),g.push(P.r,P.g,P.b),p[L]===void 0&&(p[L]=[]),p[L].push(c.length/3-1)}var s=new Ge,f=new yn({color:16777215,vertexColors:!0,toneMapped:!1}),c=[],g=[],p={},A=new Ue(16755200),S=new Ue(16711680),N=new Ue(43775),_=new Ue(16777215),I=new Ue(3355443);r("n1","n2",A),r("n2","n4",A),r("n4","n3",A),r("n3","n1",A),r("f1","f2",A),r("f2","f4",A),r("f4","f3",A),r("f3","f1",A),r("n1","f1",A),r("n2","f2",A),r("n3","f3",A),r("n4","f4",A),r("p","n1",S),r("p","n2",S),r("p","n3",S),r("p","n4",S),r("u1","u2",N),r("u2","u3",N),r("u3","u1",N),r("c","t",_),r("p","c",I),r("cn1","cn2",I),r("cn3","cn4",I),r("cf1","cf2",I),r("cf3","cf4",I),s.setAttribute("position",new We(c,3)),s.setAttribute("color",new We(g,3)),zn.call(this,s,f),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=p,this.update()}function Qn(t,r,i,s,f,c,g){if(vy.set(f,c,g).unproject(s),t=r[t],t!==void 0)for(i=i.getAttribute("position"),r=0,s=t.length;r<s;r++)i.setXYZ(t[r],vy.x,vy.y,vy.z)}function _l(t,r){this.object=t,r===void 0&&(r=16776960),t=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var i=new Float32Array(24),s=new Ge;s.setIndex(new Ir(t,1)),s.setAttribute("position",new Ir(i,3)),zn.call(this,s,new yn({color:r,toneMapped:!1})),this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}function Ml(t,r){this.type="Box3Helper",this.box=t,r=r||16776960,t=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var i=new Ge;i.setIndex(new Ir(t,1)),i.setAttribute("position",new We([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),zn.call(this,i,new yn({color:r,toneMapped:!1})),this.type="Box3Helper",this.geometry.computeBoundingSphere()}function Ho(t,r,i){this.plane=t,this.size=r===void 0?1:r,t=i!==void 0?i:16776960,r=new Ge,r.setAttribute("position",new We([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),r.computeBoundingSphere(),js.call(this,r,new yn({color:t,toneMapped:!1})),this.type="PlaneHelper",r=new Ge,r.setAttribute("position",new We([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),r.computeBoundingSphere(),this.add(new dn(r,new ro({color:t,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}function ko(t,r,i,s,f,c){Ce.call(this),this.type="ArrowHelper",t===void 0&&(t=new lt(0,0,1)),r===void 0&&(r=new lt(0,0,0)),i===void 0&&(i=1),s===void 0&&(s=16776960),f===void 0&&(f=.2*i),c===void 0&&(c=.2*f),xy===void 0&&(xy=new Ge,xy.setAttribute("position",new We([0,0,0,0,1,0],3)),ZA=new Iu(0,.5,1,5,1),ZA.translate(0,-.5,0)),this.position.copy(r),this.line=new js(xy,new yn({color:s,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new dn(ZA,new ro({color:s,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(i,f,c)}function zd(t){t=t||1;var r=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t];t=new Ge,t.setAttribute("position",new We(r,3)),t.setAttribute("color",new We([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),r=new yn({vertexColors:!0,toneMapped:!1}),zn.call(this,t,r),this.type="AxesHelper"}function Gm(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),ss.call(this,t),this.type="catmullrom"}function Pu(){}function Ud(t,r){for(var i in r)t[i]=r[i]}function us(t,r){this.lng=t,this.lat=r}function Hd(t,r){this.x=t,this.y=r}function Ch(t){for(var r=t.length;0<=--r;)t[r]=0}function bm(t,r){return function(i){return r(t(i))}}function t1(t){var r=function(i){return i==null?i:(1<arguments.length&&(i=Array.prototype.slice.call(arguments)),t(i))};return"conversion"in t&&(r.conversion=t.conversion),r}function e1(t){var r=function(i){if(i==null)return i;1<arguments.length&&(i=Array.prototype.slice.call(arguments));var s=t(i);if((typeof s=="undefined"?"undefined":Ua(s))==="object")for(var f=s.length,c=0;c<f;c++)s[c]=Math.round(s[c]);return s};return"conversion"in t&&(r.conversion=t.conversion),r}function Ro(t,r){if(!(this instanceof Ro))return new Ro(t,r);if(r&&r in l_&&(r=null),r&&!(r in Va))throw Error("Unknown model: "+r);if(typeof t=="undefined")this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(t instanceof Ro)this.model=t.model,this.color=t.color.slice(),this.valpha=t.valpha;else if(typeof t=="string"){if(r=Nv.get(t),r===null)throw Error("Unable to parse color from string: "+t);this.model=r.model;var i=Va[this.model].channels;this.color=r.value.slice(0,i),this.valpha=typeof r.value[i]=="number"?r.value[i]:1}else if(t.length)this.model=r||"rgb",i=Va[this.model].channels,r=qA.call(t,0,i),this.color=Vm(r,i),this.valpha=typeof t[i]=="number"?t[i]:1;else if(typeof t=="number")t&=16777215,this.model="rgb",this.color=[t>>16&255,t>>8&255,t&255],this.valpha=1;else{if(this.valpha=1,r=qi(t),"alpha"in t&&(r.splice(r.indexOf("alpha"),1),this.valpha=typeof t.alpha=="number"?t.alpha:0),r=r.sort().join(""),!(r in KA))throw Error("Unable to parse color from object: "+ls(t));this.model=KA[r],i=Va[this.model].labels;var s=[];for(r=0;r<i.length;r++)s.push(t[i[r]]);this.color=Vm(s)}if(Ay[this.model])for(i=Va[this.model].channels,r=0;r<i;r++)(t=Ay[this.model][r])&&(this.color[r]=t(this.color[r]));this.valpha=Math.max(0,Math.min(1,this.valpha)),Rl&&Rl(this)}function r1(t){return function(r){return Number(r.toFixed(t))}}function bn(t,r,i){return t=Array.isArray(t)?t:[t],t.forEach(function(s){(Ay[s]||(Ay[s]=[]))[r]=i}),t=t[0],function(s){if(arguments.length){i&&(s=i(s));var f=this[t]();return f.color[r]=s,f}return f=this[t]().color[r],i&&(f=i(f)),f}}function Vn(t){return function(r){return Math.max(0,Math.min(t,r))}}function Vm(t,r){for(var i=0;i<r;i++)typeof t[i]!="number"&&(t[i]=0);return t}function Po(t,r){for(var i=["webgl2","experimental-webgl2","webgl","experimental-webgl"],s=void 0,f=0;f<i.length;f++)try{if(s=t.getContext(i[f],{stencil:!0,alpha:!0,premultipliedAlpha:!1,antialias:r.antialias||!0,preserveDrawingBuffer:r.preserveDrawingBuffer||!1}))break}catch(c){}return s}function Wn(){this.needsSwap=this.enabled=!0,this.renderToScreen=this.clear=!1}var ai=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof Dt.g!="undefined"?Dt.g:typeof self!="undefined"?self:{},$r=Rt(function(t){t=t.exports=typeof window!="undefined"&&Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")(),typeof __g=="number"&&(__g=t)}),Li=Rt(function(t){t=t.exports={version:"2.6.5"},typeof __e=="number"&&(__e=t)}),Th=function(t){if(typeof t!="function")throw TypeError(t+" is not a function!");return t},Do=function(t,r,i){if(Th(t),r===void 0)return t;switch(i){case 1:return function(s){return t.call(r,s)};case 2:return function(s,f){return t.call(r,s,f)};case 3:return function(s,f,c){return t.call(r,s,f,c)}}return function(){return t.apply(r,arguments)}},xn=function(t){return typeof t=="object"?t!==null:typeof t=="function"},Go=function(t){if(!xn(t))throw TypeError(t+" is not an object!");return t},bo=function(t){try{return!!t()}catch(r){return!0}},Ss=!bo(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7}),Ko=$r.document,kd=xn(Ko)&&xn(Ko.createElement),Gd=!Ss&&!bo(function(){return Object.defineProperty(kd?Ko.createElement("div"):{},"a",{get:function(){return 7}}).a!=7}),Jf=function(t,r){if(!xn(t))return t;var i,s;if(r&&typeof(i=t.toString)=="function"&&!xn(s=i.call(t))||typeof(i=t.valueOf)=="function"&&!xn(s=i.call(t))||!r&&typeof(i=t.toString)=="function"&&!xn(s=i.call(t)))return s;throw TypeError("Can't convert object to primitive value")},Zx=Object.defineProperty,Qo={f:Ss?Object.defineProperty:function(t,r,i){if(Go(t),r=Jf(r,!0),Go(i),Gd)try{return Zx(t,r,i)}catch(s){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(t[r]=i.value),t}},Cl=function(t,r){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:r}},au=Ss?function(t,r,i){return Qo.f(t,r,Cl(1,i))}:function(t,r,i){return t[r]=i,t},Jx={}.hasOwnProperty,fn=function(t,r){return Jx.call(t,r)},_o=function(t,r,i){var s=t&_o.F,f=t&_o.G,c=t&_o.S,g=t&_o.P,p=t&_o.B,A=t&_o.W,S=f?Li:Li[r]||(Li[r]={}),N=S.prototype;c=f?$r:c?$r[r]:($r[r]||{}).prototype;var _;f&&(i=r);for(_ in i)if(r=!s&&c&&c[_]!==void 0,!r||!fn(S,_)){var I=r?c[_]:i[_];S[_]=f&&typeof c[_]!="function"?i[_]:p&&r?Do(I,$r):A&&c[_]==I?function(L){var P=function(F,W,X){if(this instanceof L){switch(arguments.length){case 0:return new L;case 1:return new L(F);case 2:return new L(F,W)}return new L(F,W,X)}return L.apply(this,arguments)};return P.prototype=L.prototype,P}(I):g&&typeof I=="function"?Do(Function.call,I):I,g&&((S.virtual||(S.virtual={}))[_]=I,t&_o.R&&N&&!N[_]&&au(N,_,I))}};_o.F=1,_o.G=2,_o.S=4,_o.P=8,_o.B=16,_o.W=32,_o.U=64,_o.R=128;var Ze=_o,Tl={}.toString,Is=function(t){return Tl.call(t).slice(8,-1)},uu=Object("z").propertyIsEnumerable(0)?Object:function(t){return Is(t)=="String"?t.split(""):Object(t)},Pn=function(t){if(t==null)throw TypeError("Can't call method on  "+t);return t},_i=function(t){return uu(Pn(t))},qf=Math.ceil,i1=Math.floor,Du=function(t){return isNaN(t=+t)?0:(0<t?i1:qf)(t)},Wm=Math.min,Ou=function(t){return 0<t?Wm(Du(t),9007199254740991):0},qx=Math.max,Kx=Math.min,Fu=Rt(function(t){var r=$r["__core-js_shared__"]||($r["__core-js_shared__"]={});(t.exports=function(i,s){return r[i]||(r[i]=s!==void 0?s:{})})("versions",[]).push({version:Li.version,mode:"pure",copyright:"\xA9 2019 Denis Pushkarev (zloirock.ru)"})}),n1=0,o1=Math.random(),Kf=function(t){return"Symbol(".concat(t===void 0?"":t,")_",(++n1+o1).toString(36))},Ic=Fu("keys"),Ec=function(t){return Ic[t]||(Ic[t]=Kf(t))},s1=function(t){return function(r,i,s){r=_i(r);var f=Ou(r.length);if(s=Du(s),s=0>s?qx(s+f,0):Kx(s,f),t&&i!=i){for(;f>s;)if(i=r[s++],i!=i)return!0}else for(;f>s;s++)if((t||s in r)&&r[s]===i)return t||s||0;return!t&&-1}}(!1),Qf=Ec("IE_PROTO"),Bu=function(t,r){t=_i(t);var i=0,s=[],f;for(f in t)f!=Qf&&fn(t,f)&&s.push(f);for(;r.length>i;)fn(t,f=r[i++])&&(~s1(s,f)||s.push(f));return s},Sl="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),Sh=Object.keys||function(t){return Bu(t,Sl)},jm=Ss?Object.defineProperties:function(t,r){Go(t);for(var i=Sh(r),s=i.length,f=0,c;s>f;)Qo.f(t,c=i[f++],r[c]);return t},a1=$r.document,Xm=a1&&a1.documentElement,Qx=Ec("IE_PROTO"),Ym=function(){},Ih=function(){var t=kd?Ko.createElement("iframe"):{},r=Sl.length;for(t.style.display="none",Xm.appendChild(t),t.src="javascript:",t=t.contentWindow.document,t.open(),t.write("<script>document.F=Object</script>"),t.close(),Ih=t.F;r--;)delete Ih.prototype[Sl[r]];return Ih()},Il=Object.create||function(t,r){if(t!==null){Ym.prototype=Go(t);var i=new Ym;Ym.prototype=null,i[Qx]=t}else i=Ih();return r===void 0?i:jm(i,r)};Ze(Ze.S,"Object",{create:Il});var $x=Li.Object,tA=function(t,r){return $x.create(t,r)},u1=Rt(function(t){t.exports={default:tA,__esModule:!0}}),at=Nt(u1),Zm=Object.getOwnPropertySymbols,bd={}.propertyIsEnumerable,Vd=Object.assign,Lc=!Vd||bo(function(){var t={},r={},i=Symbol();return t[i]=7,"abcdefghijklmnopqrst".split("").forEach(function(s){r[s]=s}),Vd({},t)[i]!=7||Object.keys(Vd({},r)).join("")!="abcdefghijklmnopqrst"})?function(t,r){for(var i=Object(Pn(t)),s=arguments.length,f=1,c=Zm,g=bd;s>f;)for(var p=uu(arguments[f++]),A=c?Sh(p).concat(c(p)):Sh(p),S=A.length,N=0,_;S>N;)g.call(p,_=A[N++])&&(i[_]=p[_]);return i}:Vd;Ze(Ze.S+Ze.F,"Object",{assign:Lc});var l1=Li.Object.assign,eA=Rt(function(t){t.exports={default:l1,__esModule:!0}}),ut=Nt(eA);Ze(Ze.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}});var Eh=Li.Math.log2,rA=Rt(function(t){t.exports={default:Eh,__esModule:!0}}),iA=Nt(rA),so={},fo=Rt(function(t){var r=Fu("wks"),i=$r.Symbol,s=typeof i=="function";(t.exports=function(f){return r[f]||(r[f]=s&&i[f]||(s?i:Kf)("Symbol."+f))}).store=r}),h1=Qo.f,c1=fo("toStringTag"),El=function(t,r,i){t&&!fn(t=i?t:t.prototype,c1)&&h1(t,c1,{configurable:!0,value:r})},Jm={};au(Jm,fo("iterator"),function(){return this});var f1=function(t,r,i){t.prototype=Il(Jm,{next:Cl(1,i)}),El(t,r+" Iterator")},qm=Ec("IE_PROTO"),p1=Object.prototype,Km=Object.getPrototypeOf||function(t){return t=Object(Pn(t)),fn(t,qm)?t[qm]:typeof t.constructor=="function"&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?p1:null},Wd=fo("iterator"),$f=!([].keys&&"next"in[].keys()),Qm=function(){return this},jd=function(t,r,i,s,f,c,g){f1(i,r,s),s=function(X){return!$f&&X in N?N[X]:function(){return new i(this,X)}};var p=r+" Iterator",A=f=="values",S=!1,N=t.prototype,_=N[Wd]||N["@@iterator"]||f&&N[f],I=_||s(f),L=f?A?s("entries"):I:void 0,P=r=="Array"&&N.entries||_,F;if(P&&(t=Km(P.call(new t)),t!==Object.prototype&&t.next&&El(t,p,!0)),A&&_&&_.name!=="values"&&(S=!0,I=function(){return _.call(this)}),g&&($f||S||!N[Wd])&&au(N,Wd,I),so[r]=I,so[p]=Qm,f){var W={values:A?I:s("values"),keys:c?I:s("keys"),entries:L};if(g)for(F in W)F in N||au(N,F,W[F]);else Ze(Ze.P+Ze.F*($f||S),r,W)}return W},Nu=function(t){return function(r,i){r=String(Pn(r)),i=Du(i);var s=r.length,f;if(0>i||i>=s)return t?"":void 0;var c=r.charCodeAt(i);return 55296>c||56319<c||i+1===s||56320>(f=r.charCodeAt(i+1))||57343<f?t?r.charAt(i):c:t?r.slice(i,i+2):(c-55296<<10)+(f-56320)+65536}}(!0);jd(String,"String",function(t){this._t=String(t),this._i=0},function(){var t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(t=Nu(t,r),this._i+=t.length,{value:t,done:!1})});var d1=function(t,r,i,s){try{return s?r(Go(i)[0],i[1]):r(i)}catch(f){throw r=t.return,r!==void 0&&Go(r.call(t)),f}},$m=fo("iterator"),g1=Array.prototype,nA=fo("toStringTag"),tp=Is(function(){return arguments}())=="Arguments",Rc=function(t){var r;if(t===void 0)var i="Undefined";else{if(t===null)var s="Null";else{t:{var f=t=Object(t);try{s=f[nA];break t}catch(c){}s=void 0}s=typeof(i=s)=="string"?i:tp?Is(t):(r=Is(t))=="Object"&&typeof t.callee=="function"?"Arguments":r}i=s}return i},tv=fo("iterator"),ev=Li.getIteratorMethod=function(t){if(t!=null)return t[tv]||t["@@iterator"]||so[Rc(t)]},Xd=fo("iterator"),m1=!1;try{[7][Xd]().return=function(){m1=!0}}catch(t){}var rv=function(t,r){if(!r&&!m1)return!1;var i=!1;try{r=[7];var s=r[Xd]();s.next=function(){return{done:i=!0}},r[Xd]=function(){return s},t(r)}catch(f){}return i};Ze(Ze.S+Ze.F*!rv(function(t){}),"Array",{from:function(t){var r=Object(Pn(t)),i=typeof this=="function"?this:Array,s=arguments.length,f=1<s?arguments[1]:void 0,c=f!==void 0,g=0,p=ev(r),A;if(c&&(f=Do(f,2<s?arguments[2]:void 0,2)),p!=null&&(i!=Array||p===void 0||so.Array!==p&&g1[$m]!==p))for(r=p.call(r),i=new i;!(A=r.next()).done;g++)s=i,p=g,A=c?d1(r,f,[A.value,g],!0):A.value,p in s?Qo.f(s,p,Cl(0,A)):s[p]=A;else for(s=Ou(r.length),i=new i(s);s>g;g++){p=i,A=g;var S=c?f(r[g],g):r[g];A in p?Qo.f(p,A,Cl(0,S)):p[A]=S}return i.length=g,i}});var za=Li.Array.from,Pc=Rt(function(t){t.exports={default:za,__esModule:!0}}),ep=Nt(Pc),lu=function(t,r){return{value:r,done:!!t}};jd(Array,"Array",function(t,r){this._t=_i(t),this._i=0,this._k=r},function(){var t=this._t,r=this._k,i=this._i++;return!t||i>=t.length?(this._t=void 0,lu(1)):r=="keys"?lu(0,i):r=="values"?lu(0,t[i]):lu(0,[i,t[i]])},"values"),so.Arguments=so.Array;for(var Yd=fo("toStringTag"),Zd="CSSRuleList CSSStyleDeclaration CSSValueList ClientRectList DOMRectList DOMStringList DOMTokenList DataTransferItemList FileList HTMLAllCollection HTMLCollection HTMLFormElement HTMLSelectElement MediaList MimeTypeArray NamedNodeMap NodeList PaintRequestList Plugin PluginArray SVGLengthList SVGNumberList SVGPathSegList SVGPointList SVGStringList SVGTransformList SourceBufferList StyleSheetList TextTrackCueList TextTrackList TouchList".split(" "),rp=0;rp<Zd.length;rp++){var ip=Zd[rp],iv=$r[ip],Jd=iv&&iv.prototype;Jd&&!Jd[Yd]&&au(Jd,Yd,ip),so[ip]=so.Array}var $o=function(t,r,i,s){if(!(t instanceof r)||s!==void 0&&s in t)throw TypeError(i+": incorrect invocation!");return t},sn=Rt(function(t){var r={},i={};t=t.exports=function(s,f,c,g,p){p=p?function(){return s}:ev(s),c=Do(c,g,f?2:1),g=0;var A,S;if(typeof p!="function")throw TypeError(s+" is not iterable!");if(p===void 0||so.Array!==p&&g1[$m]!==p){for(g=p.call(s);!(S=g.next()).done;)if(p=d1(g,c,S.value,f),p===r||p===i)return p}else for(A=Ou(s.length);A>g;g++)if(p=f?c(Go(S=s[g])[0],S[1]):c(s[g]),p===r||p===i)return p},t.BREAK=r,t.RETURN=i}),Dr=fo("species"),di=function(t,r){t=Go(t).constructor;var i;return t===void 0||(i=Go(t)[Dr])==null?r:Th(i)},oA=function(t,r,i){var s=i===void 0;switch(r.length){case 0:return s?t():t.call(i);case 1:return s?t(r[0]):t.call(i,r[0]);case 2:return s?t(r[0],r[1]):t.call(i,r[0],r[1]);case 3:return s?t(r[0],r[1],r[2]):t.call(i,r[0],r[1],r[2]);case 4:return s?t(r[0],r[1],r[2],r[3]):t.call(i,r[0],r[1],r[2],r[3])}return t.apply(i,r)},np=$r.process,rr=$r.setImmediate,v1=$r.clearImmediate,y1=$r.MessageChannel,nv=$r.Dispatch,ov=0,ii={},Qs=function(){var t=+this;if(ii.hasOwnProperty(t)){var r=ii[t];delete ii[t],r()}},sv=function(t){Qs.call(t.data)};if(!rr||!v1)if(rr=function(t){for(var r=[],i=1;arguments.length>i;)r.push(arguments[i++]);return ii[++ov]=function(){oA(typeof t=="function"?t:Function(t),r)},Ke(ov),ov},v1=function(t){delete ii[t]},Is(np)=="process")var Ke=function(t){np.nextTick(Do(Qs,t,1))};else if(nv&&nv.now)Ke=function(t){nv.now(Do(Qs,t,1))};else if(y1){var x1=new y1,pn=x1.port2;x1.port1.onmessage=sv,Ke=Do(pn.postMessage,pn,1)}else $r.addEventListener&&typeof postMessage=="function"&&!$r.importScripts?(Ke=function(t){$r.postMessage(t+"","*")},$r.addEventListener("message",sv,!1)):Ke="onreadystatechange"in(kd?Ko.createElement("script"):{})?function(t){Xm.appendChild(kd?Ko.createElement("script"):{}).onreadystatechange=function(){Xm.removeChild(this),Qs.call(t)}}:function(t){setTimeout(Do(Qs,t,1),0)};var ao=rr,Lh=$r.MutationObserver||$r.WebKitMutationObserver,av=$r.process,uv=$r.Promise,A1=Is(av)=="process",qd={f:function(t){return new ue(t)}},Kd=function(t){try{return{e:!1,v:t()}}catch(r){return{e:!0,v:r}}},w1=$r.navigator,_1=w1&&w1.userAgent||"",Rh=function(t,r){if(Go(t),xn(r)&&r.constructor===t)return r;t=qd.f(t);var i=t.resolve;return i(r),t.promise},Qd=function(t,r,i){for(var s in r)i&&t[s]?t[s]=r[s]:au(t,s,r[s]);return t},M1=fo("species"),C1=function(t){t=typeof Li[t]=="function"?Li[t]:$r[t],Ss&&t&&!t[M1]&&Qo.f(t,M1,{configurable:!0,get:function(){return this}})},T1=function(){var t,r,i=function(){var p;for(A1&&(p=av.domain)&&p.exit();t;){var A=t.fn;t=t.next;try{A()}catch(S){throw t?s():r=void 0,S}}r=void 0,p&&p.enter()};if(A1)var s=function(){av.nextTick(i)};else if(!Lh||$r.navigator&&$r.navigator.standalone)if(uv&&uv.resolve){var f=uv.resolve(void 0);s=function(){f.then(i)}}else s=function(){ao.call($r,i)};else{var c=!0,g=document.createTextNode("");new Lh(i).observe(g,{characterData:!0}),s=function(){g.data=c=!c}}return function(p){p={fn:p,next:void 0},r&&(r.next=p),t||(t=p,s()),r=p}}(),S1=$r.TypeError,Ph=$r.process,I1=Ph&&Ph.versions,lv=I1&&I1.v8||"",da=$r.Promise,Ui=Rc(Ph)=="process",$d=function(){},hv,op=hv=qd.f,tg=!!function(){try{var t=da.resolve(1),r=(t.constructor={})[fo("species")]=function(i){i($d,$d)};return(Ui||typeof PromiseRejectionEvent=="function")&&t.then($d)instanceof r&&lv.indexOf("6.6")!==0&&_1.indexOf("Chrome/66")===-1}catch(i){}}(),E1=function(t){var r;return xn(t)&&typeof(r=t.then)=="function"?r:!1},ga=function(t,r){if(!t._n){t._n=!0;var i=t._c;T1(function(){for(var s=t._v,f=t._s==1,c=0;i.length>c;){var g=void 0,p=void 0,A=void 0,S=i[c++],N=f?S.ok:S.fail,_=S.resolve,I=S.reject,L=S.domain;try{N?(f||(t._h==2&&sA(t),t._h=1),N===!0?A=s:(L&&L.enter(),A=N(s),L&&(L.exit(),g=!0)),A===S.promise?I(S1("Promise-chain cycle")):(p=E1(A))?p.call(A,_,I):_(A)):I(s)}catch(P){L&&!g&&L.exit(),I(P)}}t._c=[],t._n=!1,r&&!t._h&&L1(t)})}},L1=function(t){ao.call($r,function(){var r=t._v,i=t._h!==1&&(t._a||t._c).length===0,s,f;if(i){var c=Kd(function(){Ui?Ph.emit("unhandledRejection",r,t):(s=$r.onunhandledrejection)?s({promise:t,reason:r}):(f=$r.console)&&f.error&&f.error("Unhandled promise rejection",r)});t._h=Ui||t._h!==1&&(t._a||t._c).length===0?2:1}if(t._a=void 0,i&&c.e)throw c.v})},sA=function(t){ao.call($r,function(){var r;Ui?Ph.emit("rejectionHandled",t):(r=$r.onrejectionhandled)&&r({promise:t,reason:t._v})})},zu=function(t){var r=this;r._d||(r._d=!0,r=r._w||r,r._v=t,r._s=2,r._a||(r._a=r._c.slice()),ga(r,!0))},Ll=function(t){var r=this,i;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw S1("Promise can't be resolved itself");(i=E1(t))?T1(function(){var s={_w:r,_d:!1};try{i.call(t,Do(Ll,s,1),Do(zu,s,1))}catch(f){zu.call(s,f)}}):(r._v=t,r._s=1,ga(r,!1))}catch(s){zu.call({_w:r,_d:!1},s)}}};if(!tg){da=function(t){$o(this,da,"Promise","_h"),Th(t),eg.call(this);try{t(Do(Ll,this,1),Do(zu,this,1))}catch(r){zu.call(this,r)}};var eg=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1};eg.prototype=Qd(da.prototype,{then:function(t,r){var i=op(di(this,da));return i.ok=typeof t=="function"?t:!0,i.fail=typeof r=="function"&&r,i.domain=Ui?Ph.domain:void 0,this._c.push(i),this._a&&this._a.push(i),this._s&&ga(this,!1),i.promise},catch:function(t){return this.then(void 0,t)}});var R1=function(){var t=new eg;this.promise=t,this.resolve=Do(Ll,t,1),this.reject=Do(zu,t,1)};qd.f=op=function(t){return t===da||t===rg?new R1(t):hv(t)}}Ze(Ze.G+Ze.W+Ze.F*!tg,{Promise:da}),El(da,"Promise"),C1("Promise");var rg=Li.Promise;Ze(Ze.S+Ze.F*!tg,"Promise",{reject:function(t){var r=op(this),i=r.reject;return i(t),r.promise}}),Ze(Ze.S+1*Ze.F,"Promise",{resolve:function(t){return Rh(this===rg?da:this,t)}}),Ze(Ze.S+Ze.F*!(tg&&rv(function(t){da.all(t).catch($d)})),"Promise",{all:function(t){var r=this,i=op(r),s=i.resolve,f=i.reject,c=Kd(function(){var g=[],p=0,A=1;sn(t,!1,function(S){var N=p++,_=!1;g.push(void 0),A++,r.resolve(S).then(function(I){_||(_=!0,g[N]=I,--A||s(g))},f)}),--A||s(g)});return c.e&&f(c.v),i.promise},race:function(t){var r=this,i=op(r),s=i.reject,f=Kd(function(){sn(t,!1,function(c){r.resolve(c).then(i.resolve,s)})});return f.e&&s(f.v),i.promise}}),Ze(Ze.P+Ze.R,"Promise",{finally:function(t){var r=di(this,Li.Promise||$r.Promise),i=typeof t=="function";return this.then(i?function(s){return Rh(r,t()).then(function(){return s})}:t,i?function(s){return Rh(r,t()).then(function(){throw s})}:t)}}),Ze(Ze.S,"Promise",{try:function(t){var r=qd.f(this);return t=Kd(t),(t.e?r.reject:r.resolve)(t.v),r.promise}});var aA=Li.Promise,P1=Rt(function(t){t.exports={default:aA,__esModule:!0}}),Di=Nt(P1),ma=Rt(function(t){var r=Kf("meta"),i=Qo.f,s=0,f=Object.isExtensible||function(){return!0},c=!bo(function(){return f(Object.preventExtensions({}))}),g=function(A){i(A,r,{value:{i:"O"+ ++s,w:{}}})},p=t.exports={KEY:r,NEED:!1,fastKey:function(A,S){if(!xn(A))return typeof A=="symbol"?A:(typeof A=="string"?"S":"P")+A;if(!fn(A,r)){if(!f(A))return"F";if(!S)return"E";g(A)}return A[r].i},getWeak:function(A,S){if(!fn(A,r)){if(!f(A))return!0;if(!S)return!1;g(A)}return A[r].w},onFreeze:function(A){return c&&p.NEED&&f(A)&&!fn(A,r)&&g(A),A}}}),Uu=function(t,r){var i=(Li.Object||{})[t]||Object[t],s={};s[t]=r(i),Ze(Ze.S+Ze.F*bo(function(){i(1)}),"Object",s)},hu=ma.onFreeze;Uu("freeze",function(t){return function(r){return t&&xn(r)?t(hu(r)):r}});var uA=Li.Object.freeze,D1=Rt(function(t){t.exports={default:uA,__esModule:!0}}),Rl=Nt(D1),ig={f:fo},lA=ig.f("iterator"),sp=Rt(function(t){t.exports={default:lA,__esModule:!0}});Nt(sp);var O1=Qo.f,va=function(t){var r=Li.Symbol||(Li.Symbol={});t.charAt(0)=="_"||t in r||O1(r,t,{value:ig.f(t)})},Es=Array.isArray||function(t){return Is(t)=="Array"},hA=Sl.concat("length","prototype"),ng=Object.getOwnPropertyNames||function(t){return Bu(t,hA)},F1=ng,B1={}.toString,cv=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],N1=function(t){if(cv&&B1.call(t)=="[object Window]")try{var r=F1(t)}catch(i){r=cv.slice()}else r=F1(_i(t));return r},og=Object.getOwnPropertyDescriptor,sg={f:Ss?og:function(t,r){if(t=_i(t),r=Jf(r,!0),Gd)try{return og(t,r)}catch(i){}if(fn(t,r))return Cl(!bd.call(t,r),t[r])}},cA=ma.KEY,ag=sg.f,Hu=Qo.f,z1=N1,Ls=$r.Symbol,ug=$r.JSON,Dh=ug&&ug.stringify,po=fo("_hidden"),U1=fo("toPrimitive"),H1={}.propertyIsEnumerable,ap=Fu("symbol-registry"),cu=Fu("symbols"),Oh=Fu("op-symbols"),ya=Object.prototype,Fh=typeof Ls=="function",up=$r.QObject,lp=!up||!up.prototype||!up.prototype.findChild,Bh=Ss&&bo(function(){return Il(Hu({},"a",{get:function(){return Hu(this,"a",{value:7}).a}})).a!=7})?function(t,r,i){var s=ag(ya,r);s&&delete ya[r],Hu(t,r,i),s&&t!==ya&&Hu(ya,r,s)}:Hu,Dc=function(t){var r=cu[t]=Il(Ls.prototype);return r._k=t,r},lg=Fh&&typeof Ls.iterator=="symbol"?function(t){return typeof t=="symbol"}:function(t){return t instanceof Ls},Pl=function(t,r,i){return t===ya&&Pl(Oh,r,i),Go(t),r=Jf(r,!0),Go(i),fn(cu,r)?(i.enumerable?(fn(t,po)&&t[po][r]&&(t[po][r]=!1),i=Il(i,{enumerable:Cl(0,!1)})):(fn(t,po)||Hu(t,po,Cl(1,{})),t[po][r]=!0),Bh(t,r,i)):Hu(t,r,i)},fv=function(t,r){Go(t);var i=r=_i(r),s=Sh(i),f=Zm;if(f){f=f(i);for(var c=bd,g=0,p;f.length>g;)c.call(i,p=f[g++])&&s.push(p)}i=0,p=s.length;for(var A;p>i;)Pl(t,A=s[i++],r[A]);return t},k1=function(t){var r=H1.call(this,t=Jf(t,!0));return this===ya&&fn(cu,t)&&!fn(Oh,t)?!1:r||!fn(this,t)||!fn(cu,t)||fn(this,po)&&this[po][t]?r:!0},hg=function(t,r){if(t=_i(t),r=Jf(r,!0),t!==ya||!fn(cu,r)||fn(Oh,r)){var i=ag(t,r);return!i||!fn(cu,r)||fn(t,po)&&t[po][r]||(i.enumerable=!0),i}},pv=function(t){t=z1(_i(t));for(var r=[],i=0,s;t.length>i;)fn(cu,s=t[i++])||s==po||s==cA||r.push(s);return r},cg=function(t){var r=t===ya;t=z1(r?Oh:_i(t));for(var i=[],s=0,f;t.length>s;)fn(cu,f=t[s++])&&(r?fn(ya,f):1)&&i.push(cu[f]);return i};Fh||(Ls=function(){if(this instanceof Ls)throw TypeError("Symbol is not a constructor!");var t=Kf(0<arguments.length?arguments[0]:void 0),r=function(i){this===ya&&r.call(Oh,i),fn(this,po)&&fn(this[po],t)&&(this[po][t]=!1),Bh(this,t,Cl(1,i))};return Ss&&lp&&Bh(ya,t,{configurable:!0,set:r}),Dc(t)},au(Ls.prototype,"toString",function(){return this._k}),sg.f=hg,Qo.f=Pl,ng=N1=pv,bd=k1,Zm=cg,ig.f=function(t){return Dc(fo(t))}),Ze(Ze.G+Ze.W+Ze.F*!Fh,{Symbol:Ls});for(var fg="hasInstance isConcatSpreadable iterator match replace search species split toPrimitive toStringTag unscopables".split(" "),dv=0;fg.length>dv;)fo(fg[dv++]);for(var hp=Sh(fo.store),cp=0;hp.length>cp;)va(hp[cp++]);Ze(Ze.S+Ze.F*!Fh,"Symbol",{for:function(t){return fn(ap,t+="")?ap[t]:ap[t]=Ls(t)},keyFor:function(t){if(!lg(t))throw TypeError(t+" is not a symbol!");for(var r in ap)if(ap[r]===t)return r},useSetter:function(){lp=!0},useSimple:function(){lp=!1}}),Ze(Ze.S+Ze.F*!Fh,"Object",{create:function(t,r){return r===void 0?Il(t):fv(Il(t),r)},defineProperty:Pl,defineProperties:fv,getOwnPropertyDescriptor:hg,getOwnPropertyNames:pv,getOwnPropertySymbols:cg}),ug&&Ze(Ze.S+Ze.F*(!Fh||bo(function(){var t=Ls();return Dh([t])!="[null]"||Dh({a:t})!="{}"||Dh(Object(t))!="{}"})),"JSON",{stringify:function(t){for(var r=[t],i=1,s;arguments.length>i;)r.push(arguments[i++]);if(s=i=r[1],(xn(i)||t!==void 0)&&!lg(t))return Es(i)||(i=function(f,c){if(typeof s=="function"&&(c=s.call(this,f,c)),!lg(c))return c}),r[1]=i,Dh.apply(ug,r)}}),Ls.prototype[U1]||au(Ls.prototype,U1,Ls.prototype.valueOf),El(Ls,"Symbol"),El(Math,"Math",!0),El($r.JSON,"JSON",!0),va("asyncIterator"),va("observable");var G1=Li.Symbol,fp=Rt(function(t){t.exports={default:G1,__esModule:!0}});Nt(fp);var Dl=Rt(function(t,r){r.__esModule=!0,t=sp&&sp.__esModule?sp:{default:sp};var i=fp&&fp.__esModule?fp:{default:fp},s=typeof i.default=="function"&&typeof t.default=="symbol"?function(f){return typeof f}:function(f){return f&&typeof i.default=="function"&&f.constructor===i.default&&f!==i.default.prototype?"symbol":typeof f};r.default=typeof i.default=="function"&&s(t.default)==="symbol"?function(f){return typeof f=="undefined"?"undefined":s(f)}:function(f){return f&&typeof i.default=="function"&&f.constructor===i.default&&f!==i.default.prototype?"symbol":typeof f=="undefined"?"undefined":s(f)}}),Ua=Nt(Dl),Rs=function(t,r){if(!xn(t)||t._t!==r)throw TypeError("Incompatible receiver, "+r+" required!");return t},b1=Qo.f,gv=ma.fastKey,Oc=Ss?"_s":"size",ku=function(t,r){var i=gv(r);if(i!=="F")return t._i[i];for(t=t._f;t;t=t.n)if(t.k==r)return t},pg={getConstructor:function(t,r,i,s){var f=t(function(c,g){$o(c,f,r,"_i"),c._t=r,c._i=Il(null),c._f=void 0,c._l=void 0,c[Oc]=0,g!=null&&sn(g,i,c[s],c)});return Qd(f.prototype,{clear:function(){for(var c=Rs(this,r),g=c._i,p=c._f;p;p=p.n)p.r=!0,p.p&&(p.p=p.p.n=void 0),delete g[p.i];c._f=c._l=void 0,c[Oc]=0},delete:function(c){var g=Rs(this,r);if(c=ku(g,c)){var p=c.n,A=c.p;delete g._i[c.i],c.r=!0,A&&(A.n=p),p&&(p.p=A),g._f==c&&(g._f=p),g._l==c&&(g._l=A),g[Oc]--}return!!c},forEach:function(c){Rs(this,r);for(var g=Do(c,1<arguments.length?arguments[1]:void 0,3),p;p=p?p.n:this._f;)for(g(p.v,p.k,this);p&&p.r;)p=p.p},has:function(c){return!!ku(Rs(this,r),c)}}),Ss&&b1(f.prototype,"size",{get:function(){return Rs(this,r)[Oc]}}),f},def:function(t,r,i){var s=ku(t,r),f;return s?s.v=i:(t._l=s={i:f=gv(r,!0),k:r,v:i,p:r=t._l,n:void 0,r:!1},t._f||(t._f=s),r&&(r.n=s),t[Oc]++,f!=="F"&&(t._i[f]=s)),t},getEntry:ku,setStrong:function(t,r,i){jd(t,r,function(s,f){this._t=Rs(s,r),this._k=f,this._l=void 0},function(){for(var s=this._k,f=this._l;f&&f.r;)f=f.p;return this._t&&(this._l=f=f?f.n:this._t._f)?s=="keys"?lu(0,f.k):s=="values"?lu(0,f.v):lu(0,[f.k,f.v]):(this._t=void 0,lu(1))},i?"entries":"values",!i,!0),C1(r)}},fA=fo("species"),fu=function(t,r){if(Es(t)){var i=t.constructor;typeof i!="function"||i!==Array&&!Es(i.prototype)||(i=void 0),xn(i)&&(i=i[fA],i===null&&(i=void 0))}return new(i===void 0?Array:i)(r)},Ol=function(t,r){var i=t==1,s=t==2,f=t==3,c=t==4,g=t==6,p=t==5||g,A=r||fu;return function(S,N,_){var I=Object(Pn(S)),L=uu(I);N=Do(N,_,3),_=Ou(L.length);var P=0;S=i?A(S,_):s?A(S,0):void 0;for(var F,W;_>P;P++)if((p||P in L)&&(F=L[P],W=N(F,P,I),t)){if(i)S[P]=W;else if(W)switch(t){case 3:return!0;case 5:return F;case 6:return P;case 2:S.push(F)}else if(c)return!1}return g?-1:f||c?c:S}},dg=Qo.f,V1=Ol(0),Fc=function(t,r,i,s,f,c){var g=$r[t],p=g,A=f?"set":"add",S=p&&p.prototype,N={};return Ss&&typeof p=="function"&&(c||S.forEach&&!bo(function(){new p().entries().next()}))?(p=r(function(_,I){$o(_,p,t,"_c"),_._c=new g,I!=null&&sn(I,f,_[A],_)}),V1("add clear delete forEach get has set keys values entries toJSON".split(" "),function(_){var I=_=="add"||_=="set";_ in S&&(!c||_!="clear")&&au(p.prototype,_,function(L,P){return $o(this,p,_),!I&&c&&!xn(L)?_=="get"?void 0:!1:(L=this._c[_](L===0?0:L,P),I?this:L)})}),c||dg(p.prototype,"size",{get:function(){return this._c.size}})):(p=s.getConstructor(r,t,f,A),Qd(p.prototype,i),ma.NEED=!0),El(p,t),N[t]=p,Ze(Ze.G+Ze.W+Ze.F,N),c||s.setStrong(p,t,f),p};Fc("Map",function(t){return function(){return t(this,0<arguments.length?arguments[0]:void 0)}},{get:function(t){return(t=pg.getEntry(Rs(this,"Map"),t))&&t.v},set:function(t,r){return pg.def(Rs(this,"Map"),t===0?0:t,r)}},pg,!0),Ze(Ze.P+Ze.R,"Map",{toJSON:function(t){return function(){if(Rc(this)!=t)throw TypeError(t+"#toJSON isn't generic");var r=[];return sn(this,!1,r.push,r,void 0),r}}("Map")});var pp=function(t){Ze(Ze.S,t,{of:function(){for(var r=arguments.length,i=Array(r);r--;)i[r]=arguments[r];return new this(i)}})};pp("Map");var mv=function(t){Ze(Ze.S,t,{from:function(r,i,s){var f;if(Th(this),(f=i!==void 0)&&Th(i),r==null)return new this;var c=[];if(f){var g=0,p=Do(i,s,2);sn(r,!1,function(A){c.push(p(A,g++))})}else sn(r,!1,c.push,c);return new this(c)}})};mv("Map");var vv=Li.Map,pA=Rt(function(t){t.exports={default:vv,__esModule:!0}}),yv=Nt(pA);Ze(Ze.S+Ze.F*!Ss,"Object",{defineProperty:Qo.f});var Bc=Li.Object,xv=function(t,r,i){return Bc.defineProperty(t,r,i)},Ha=Rt(function(t){t.exports={default:xv,__esModule:!0}}),go=Nt(Ha),W1=Rt(function(t,r){r.__esModule=!0;var i=Ha&&Ha.__esModule?Ha:{default:Ha};r.default=function(s,f,c){return f in s?(0,i.default)(s,f,{value:c,enumerable:!0,configurable:!0,writable:!0}):s[f]=c,s}}),an=Nt(W1),Av=ma.getWeak,Fl=Ol(5),Bl=Ol(6),dA=0,dp=function(t){return t._l||(t._l=new Nc)},Nc=function(){this.a=[]},zc=function(t,r){return Fl(t.a,function(i){return i[0]===r})};Nc.prototype={get:function(t){if(t=zc(this,t))return t[1]},has:function(t){return!!zc(this,t)},set:function(t,r){var i=zc(this,t);i?i[1]=r:this.a.push([t,r])},delete:function(t){var r=Bl(this.a,function(i){return i[0]===t});return~r&&this.a.splice(r,1),!!~r}};var Uc={getConstructor:function(t,r,i,s){var f=t(function(c,g){$o(c,f,r,"_i"),c._t=r,c._i=dA++,c._l=void 0,g!=null&&sn(g,i,c[s],c)});return Qd(f.prototype,{delete:function(c){if(!xn(c))return!1;var g=Av(c);return g===!0?dp(Rs(this,r)).delete(c):g&&fn(g,this._i)&&delete g[this._i]},has:function(c){if(!xn(c))return!1;var g=Av(c);return g===!0?dp(Rs(this,r)).has(c):g&&fn(g,this._i)}}),f},def:function(t,r,i){var s=Av(Go(r),!0);return s===!0?dp(t).set(r,i):s[t._i]=i,t},ufstore:dp};Rt(function(t){var r=Ol(0),i=!$r.ActiveXObject&&"ActiveXObject"in $r,s=ma.getWeak,f=Object.isExtensible,c=Uc.ufstore,g=function(N){return function(){return N(this,0<arguments.length?arguments[0]:void 0)}},p={get:function(N){if(xn(N)){var _=s(N);return _===!0?c(Rs(this,"WeakMap")).get(N):_?_[this._i]:void 0}},set:function(N,_){return Uc.def(Rs(this,"WeakMap"),N,_)}},A=t.exports=Fc("WeakMap",g,p,Uc,!0,!0);if(Rs&&i){var S=Uc.getConstructor(g,"WeakMap");Lc(S.prototype,p),ma.NEED=!0,r(["delete","has","get","set"],function(N){var _=A.prototype,I=_[N];au(_,N,function(L,P){return xn(L)&&!f(L)?(this._f||(this._f=new S),L=this._f[N](L,P),N=="set"?this:L):I.call(this,L,P)})})}}),pp("WeakMap"),mv("WeakMap");var gA=Li.WeakMap,mA=Rt(function(t){t.exports={default:gA,__esModule:!0}}),An=Nt(mA);Uu("getPrototypeOf",function(){return function(t){return Km(Object(Pn(t)))}});var vA=Li.Object.getPrototypeOf,yA=Rt(function(t){t.exports={default:vA,__esModule:!0}}),Mo=Nt(yA),Nl=Rt(function(t,r){r.__esModule=!0,r.default=function(i,s){if(!(i instanceof s))throw new TypeError("Cannot call a class as a function")}}),Ji=Nt(Nl),Hc=Rt(function(t,r){r.__esModule=!0;var i=Dl&&Dl.__esModule?Dl:{default:Dl};r.default=function(s,f){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!f||(typeof f=="undefined"?"undefined":(0,i.default)(f))!=="object"&&typeof f!="function"?s:f}}),jn=Nt(Hc),gp=Object.setPrototypeOf||("__proto__"in{}?function(t,r,i){try{i=Do(Function.call,sg.f(Object.prototype,"__proto__").set,2),i(t,[]),r=!(t instanceof Array)}catch(s){r=!0}return function(s,f){if(Go(s),!xn(f)&&f!==null)throw TypeError(f+": can't set as prototype!");return r?s.__proto__=f:i(s,f),s}}({},!1):void 0);Ze(Ze.S,"Object",{setPrototypeOf:gp});var xA=Li.Object.setPrototypeOf,j1=Rt(function(t){t.exports={default:xA,__esModule:!0}});Nt(j1);var Nh=Rt(function(t,r){function i(g){return g&&g.__esModule?g:{default:g}}r.__esModule=!0;var s=i(j1),f=i(u1),c=i(Dl);r.default=function(g,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+(typeof p=="undefined"?"undefined":(0,c.default)(p)));g.prototype=(0,f.default)(p&&p.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),p&&(s.default?(0,s.default)(g,p):g.__proto__=p)}}),Co=Nt(Nh);Uu("keys",function(){return function(t){return Sh(Object(Pn(t)))}});var AA=Li.Object.keys,wA=Rt(function(t){t.exports={default:AA,__esModule:!0}}),qi=Nt(wA),X1=Li.JSON||(Li.JSON={stringify:JSON.stringify}),wv=function(t){return X1.stringify.apply(X1,arguments)},_A=Rt(function(t){t.exports={default:wv,__esModule:!0}}),ls=Nt(_A);Ze(Ze.S+Ze.F*!Ss,"Object",{defineProperties:jm});var MA=Li.Object,CA=function(t,r){return MA.defineProperties(t,r)},TA=Rt(function(t){t.exports={default:CA,__esModule:!0}}),Xr=Nt(TA);Ze(Ze.S,"Math",{sign:Math.sign||function(t){return(t=+t)==0||t!=t?t:0>t?-1:1}});var SA=Li.Math.sign,IA=Rt(function(t){t.exports={default:SA,__esModule:!0}}),zl=Nt(IA),EA=Math.floor;Ze(Ze.S,"Number",{isInteger:function(t){return!xn(t)&&isFinite(t)&&EA(t)===t}});var Y1=Li.Number.isInteger,LA=Rt(function(t){t.exports={default:Y1,__esModule:!0}}),kc=Nt(LA);Ze(Ze.S,"Number",{EPSILON:Math.pow(2,-52)});var RA=Math.pow(2,-52),Z1=Rt(function(t){t.exports={default:RA,__esModule:!0}}),Dn=Nt(Z1);Dn===void 0&&(Number.EPSILON=Math.pow(2,-52)),kc===void 0&&(Number.isInteger=function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}),zl===void 0&&(Math.sign=function(t){return 0>t?-1:0<t?1:+t}),!("name"in Function.prototype)&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),ut===void 0&&(Object.assign=function(t){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(t),i=1;i<arguments.length;i++){var s=arguments[i];if(s!=null)for(var f in s)Object.prototype.hasOwnProperty.call(s,f)&&(r[f]=s[f])}return r}),ut(se.prototype,{addEventListener:function(t,r){this._listeners===void 0&&(this._listeners={});var i=this._listeners;i[t]===void 0&&(i[t]=[]),i[t].indexOf(r)===-1&&i[t].push(r)},hasEventListener:function(t,r){if(this._listeners===void 0)return!1;var i=this._listeners;return i[t]!==void 0&&i[t].indexOf(r)!==-1},removeEventListener:function(t,r){this._listeners!==void 0&&(t=this._listeners[t],t!==void 0&&(r=t.indexOf(r),r!==-1&&t.splice(r,1)))},dispatchEvent:function(t){if(this._listeners!==void 0){var r=this._listeners[t.type];if(r!==void 0){t.target=this,r=r.slice(0);for(var i=0,s=r.length;i<s;i++)r[i].call(this,t)}}}});for(var Vo=[],mp=0;256>mp;mp++)Vo[mp]=(16>mp?"0":"")+mp.toString(16);var Ar={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0,s=4294967295*Math.random()|0;return(Vo[t&255]+Vo[t>>8&255]+Vo[t>>16&255]+Vo[t>>24&255]+"-"+Vo[r&255]+Vo[r>>8&255]+"-"+Vo[r>>16&15|64]+Vo[r>>24&255]+"-"+Vo[i&63|128]+Vo[i>>8&255]+"-"+Vo[i>>16&255]+Vo[i>>24&255]+Vo[s&255]+Vo[s>>8&255]+Vo[s>>16&255]+Vo[s>>24&255]).toUpperCase()},clamp:function(t,r,i){return Math.max(r,Math.min(i,t))},euclideanModulo:function(t,r){return(t%r+r)%r},mapLinear:function(t,r,i,s,f){return s+(t-r)*(f-s)/(i-r)},lerp:function(t,r,i){return(1-i)*t+i*r},smoothstep:function(t,r,i){return t<=r?0:t>=i?1:(t=(t-r)/(i-r),t*t*(3-2*t))},smootherstep:function(t,r,i){return t<=r?0:t>=i?1:(t=(t-r)/(i-r),t*t*t*(t*(6*t-15)+10))},randInt:function(t,r){return t+Math.floor(Math.random()*(r-t+1))},randFloat:function(t,r){return t+Math.random()*(r-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*Ar.DEG2RAD},radToDeg:function(t){return t*Ar.RAD2DEG},isPowerOfTwo:function(t){return(t&t-1)==0&&t!==0},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,r,i,s,f){var c=Math.cos,g=Math.sin,p=c(i/2);i=g(i/2);var A=c((r+s)/2),S=g((r+s)/2),N=c((r-s)/2),_=g((r-s)/2);switch(c=c((s-r)/2),r=g((s-r)/2),f){case"XYX":t.set(p*S,i*N,i*_,p*A);break;case"YZY":t.set(i*_,p*S,i*N,p*A);break;case"ZXZ":t.set(i*N,i*_,p*S,p*A);break;case"XZX":t.set(p*S,i*r,i*c,p*A);break;case"YXY":t.set(i*c,p*S,i*r,p*A);break;case"ZYZ":t.set(i*r,i*c,p*S,p*A);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+f)}}};Xr(st.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),ut(st.prototype,{isVector2:!0,set:function(t,r){return this.x=t,this.y=r,this},setScalar:function(t){return this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,r){switch(t){case 0:this.x=r;break;case 1:this.y=r;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,r){return r!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,r)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this},addScaledVector:function(t,r){return this.x+=t.x*r,this.y+=t.y*r,this},sub:function(t,r){return r!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,r)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var r=this.x,i=this.y;return t=t.elements,this.x=t[0]*r+t[3]*i+t[6],this.y=t[1]*r+t[4]*i+t[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,r){return this.x=Math.max(t.x,Math.min(r.x,this.x)),this.y=Math.max(t.y,Math.min(r.y,this.y)),this},clampScalar:function(t,r){return this.x=Math.max(t,Math.min(r,this.x)),this.y=Math.max(t,Math.min(r,this.y)),this},clampLength:function(t,r){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(r,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var r=this.x-t.x;return t=this.y-t.y,r*r+t*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,r){return this.x+=(t.x-this.x)*r,this.y+=(t.y-this.y)*r,this},lerpVectors:function(t,r,i){return this.x=t.x+(r.x-t.x)*i,this.y=t.y+(r.y-t.y)*i,this},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,r){return r===void 0&&(r=0),this.x=t[r],this.y=t[r+1],this},toArray:function(t,r){return t===void 0&&(t=[]),r===void 0&&(r=0),t[r]=this.x,t[r+1]=this.y,t},fromBufferAttribute:function(t,r,i){return i!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(r),this.y=t.getY(r),this},rotateAround:function(t,r){var i=Math.cos(r);r=Math.sin(r);var s=this.x-t.x,f=this.y-t.y;return this.x=s*i-f*r+t.x,this.y=s*r+f*i+t.y,this},random:function(){return this.x=Math.random(),this.y=Math.random(),this}}),ut(Ft.prototype,{isMatrix3:!0,set:function(t,r,i,s,f,c,g,p,A){var S=this.elements;return S[0]=t,S[1]=s,S[2]=g,S[3]=r,S[4]=f,S[5]=p,S[6]=i,S[7]=c,S[8]=A,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(t){var r=this.elements;return t=t.elements,r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],this},extractBasis:function(t,r,i){return t.setFromMatrix3Column(this,0),r.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){return t=t.elements,this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,r){var i=t.elements,s=r.elements;r=this.elements,t=i[0];var f=i[3],c=i[6],g=i[1],p=i[4],A=i[7],S=i[2],N=i[5];i=i[8];var _=s[0],I=s[3],L=s[6],P=s[1],F=s[4],W=s[7],X=s[2],Z=s[5];return s=s[8],r[0]=t*_+f*P+c*X,r[3]=t*I+f*F+c*Z,r[6]=t*L+f*W+c*s,r[1]=g*_+p*P+A*X,r[4]=g*I+p*F+A*Z,r[7]=g*L+p*W+A*s,r[2]=S*_+N*P+i*X,r[5]=S*I+N*F+i*Z,r[8]=S*L+N*W+i*s,this},multiplyScalar:function(t){var r=this.elements;return r[0]*=t,r[3]*=t,r[6]*=t,r[1]*=t,r[4]*=t,r[7]*=t,r[2]*=t,r[5]*=t,r[8]*=t,this},determinant:function(){var t=this.elements,r=t[0],i=t[1],s=t[2],f=t[3],c=t[4],g=t[5],p=t[6],A=t[7];return t=t[8],r*c*t-r*g*A-i*f*t+i*g*p+s*f*A-s*c*p},getInverse:function(t,r){r!==void 0&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var i=t.elements;t=this.elements,r=i[0];var s=i[1],f=i[2],c=i[3],g=i[4],p=i[5],A=i[6],S=i[7];i=i[8];var N=i*g-p*S,_=p*A-i*c,I=S*c-g*A,L=r*N+s*_+f*I;return L===0?this.set(0,0,0,0,0,0,0,0,0):(L=1/L,t[0]=N*L,t[1]=(f*S-i*s)*L,t[2]=(p*s-f*g)*L,t[3]=_*L,t[4]=(i*r-f*A)*L,t[5]=(f*c-p*r)*L,t[6]=I*L,t[7]=(s*A-S*r)*L,t[8]=(g*r-s*c)*L,this)},transpose:function(){var t=this.elements,r=t[1];return t[1]=t[3],t[3]=r,r=t[2],t[2]=t[6],t[6]=r,r=t[5],t[5]=t[7],t[7]=r,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var r=this.elements;return t[0]=r[0],t[1]=r[3],t[2]=r[6],t[3]=r[1],t[4]=r[4],t[5]=r[7],t[6]=r[2],t[7]=r[5],t[8]=r[8],this},setUvTransform:function(t,r,i,s,f,c,g){var p=Math.cos(f);f=Math.sin(f),this.set(i*p,i*f,-i*(p*c+f*g)+c+t,-s*f,s*p,-s*(-f*c+p*g)+g+r,0,0,1)},scale:function(t,r){var i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=r,i[4]*=r,i[7]*=r,this},rotate:function(t){var r=Math.cos(t);t=Math.sin(t);var i=this.elements,s=i[0],f=i[3],c=i[6],g=i[1],p=i[4],A=i[7];return i[0]=r*s+t*g,i[3]=r*f+t*p,i[6]=r*c+t*A,i[1]=-t*s+r*g,i[4]=-t*f+r*p,i[7]=-t*c+r*A,this},translate:function(t,r){var i=this.elements;return i[0]+=t*i[2],i[3]+=t*i[5],i[6]+=t*i[8],i[1]+=r*i[2],i[4]+=r*i[5],i[7]+=r*i[8],this},equals:function(t){var r=this.elements;t=t.elements;for(var i=0;9>i;i++)if(r[i]!==t[i])return!1;return!0},fromArray:function(t,r){r===void 0&&(r=0);for(var i=0;9>i;i++)this.elements[i]=t[i+r];return this},toArray:function(t,r){t===void 0&&(t=[]),r===void 0&&(r=0);var i=this.elements;return t[r]=i[0],t[r+1]=i[1],t[r+2]=i[2],t[r+3]=i[3],t[r+4]=i[4],t[r+5]=i[5],t[r+6]=i[6],t[r+7]=i[7],t[r+8]=i[8],t}});var zh,Wo={getDataURL:function(t){if(typeof HTMLCanvasElement=="undefined")return t.src;if(!(t instanceof HTMLCanvasElement)){zh===void 0&&(zh=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),zh.width=t.width,zh.height=t.height;var r=zh.getContext("2d");t instanceof ImageData?r.putImageData(t,0,0):r.drawImage(t,0,0,t.width,t.height),t=zh}return 2048<t.width||2048<t.height?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}},PA=0;Pt.DEFAULT_IMAGE=void 0,Pt.DEFAULT_MAPPING=300,Pt.prototype=ut(at(se.prototype),{constructor:Pt,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var r=t===void 0||typeof t=="string";if(!r&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];var i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){var s=this.image;if(s.uuid===void 0&&(s.uuid=Ar.generateUUID()),!r&&t.images[s.uuid]===void 0){if(Array.isArray(s))for(var f=[],c=0,g=s.length;c<g;c++)f.push(Wo.getDataURL(s[c]));else f=Wo.getDataURL(s);t.images[s.uuid]={uuid:s.uuid,url:f}}i.image=s.uuid}return r||(t.textures[this.uuid]=i),i},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping!==300)return t;if(t.applyMatrix3(this.matrix),0>t.x||1<t.x)switch(this.wrapS){case 1e3:t.x-=Math.floor(t.x);break;case 1001:t.x=0>t.x?0:1;break;case 1002:t.x=Math.abs(Math.floor(t.x)%2)===1?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(0>t.y||1<t.y)switch(this.wrapT){case 1e3:t.y-=Math.floor(t.y);break;case 1001:t.y=0>t.y?0:1;break;case 1002:t.y=Math.abs(Math.floor(t.y)%2)===1?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(Pt.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}}),Xr(It.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),ut(It.prototype,{isVector4:!0,set:function(t,r,i,s){return this.x=t,this.y=r,this.z=i,this.w=s,this},setScalar:function(t){return this.w=this.z=this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,r){switch(t){case 0:this.x=r;break;case 1:this.y=r;break;case 2:this.z=r;break;case 3:this.w=r;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this},add:function(t,r){return r!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,r)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this.z=t.z+r.z,this.w=t.w+r.w,this},addScaledVector:function(t,r){return this.x+=t.x*r,this.y+=t.y*r,this.z+=t.z*r,this.w+=t.w*r,this},sub:function(t,r){return r!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,r)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this.z=t.z-r.z,this.w=t.w-r.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var r=this.x,i=this.y,s=this.z,f=this.w;return t=t.elements,this.x=t[0]*r+t[4]*i+t[8]*s+t[12]*f,this.y=t[1]*r+t[5]*i+t[9]*s+t[13]*f,this.z=t[2]*r+t[6]*i+t[10]*s+t[14]*f,this.w=t[3]*r+t[7]*i+t[11]*s+t[15]*f,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var r=Math.sqrt(1-t.w*t.w);return 1e-4>r?(this.x=1,this.z=this.y=0):(this.x=t.x/r,this.y=t.y/r,this.z=t.z/r),this},setAxisAngleFromRotationMatrix:function(t){t=t.elements;var r=t[0],i=t[4],s=t[8],f=t[1],c=t[5],g=t[9],p=t[2],A=t[6],S=t[10];return .01>Math.abs(i-f)&&.01>Math.abs(s-p)&&.01>Math.abs(g-A)?.1>Math.abs(i+f)&&.1>Math.abs(s+p)&&.1>Math.abs(g+A)&&.1>Math.abs(r+c+S-3)?(this.set(1,0,0,0),this):(t=Math.PI,r=(r+1)/2,c=(c+1)/2,S=(S+1)/2,i=(i+f)/4,s=(s+p)/4,g=(g+A)/4,r>c&&r>S?.01>r?(A=0,i=p=.707106781):(A=Math.sqrt(r),p=i/A,i=s/A):c>S?.01>c?(A=.707106781,p=0,i=.707106781):(p=Math.sqrt(c),A=i/p,i=g/p):.01>S?(p=A=.707106781,i=0):(i=Math.sqrt(S),A=s/i,p=g/i),this.set(A,p,i,t),this):(t=Math.sqrt((A-g)*(A-g)+(s-p)*(s-p)+(f-i)*(f-i)),.001>Math.abs(t)&&(t=1),this.x=(A-g)/t,this.y=(s-p)/t,this.z=(f-i)/t,this.w=Math.acos((r+c+S-1)/2),this)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,r){return this.x=Math.max(t.x,Math.min(r.x,this.x)),this.y=Math.max(t.y,Math.min(r.y,this.y)),this.z=Math.max(t.z,Math.min(r.z,this.z)),this.w=Math.max(t.w,Math.min(r.w,this.w)),this},clampScalar:function(t,r){return this.x=Math.max(t,Math.min(r,this.x)),this.y=Math.max(t,Math.min(r,this.y)),this.z=Math.max(t,Math.min(r,this.z)),this.w=Math.max(t,Math.min(r,this.w)),this},clampLength:function(t,r){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(r,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,r){return this.x+=(t.x-this.x)*r,this.y+=(t.y-this.y)*r,this.z+=(t.z-this.z)*r,this.w+=(t.w-this.w)*r,this},lerpVectors:function(t,r,i){return this.x=t.x+(r.x-t.x)*i,this.y=t.y+(r.y-t.y)*i,this.z=t.z+(r.z-t.z)*i,this.w=t.w+(r.w-t.w)*i,this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,r){return r===void 0&&(r=0),this.x=t[r],this.y=t[r+1],this.z=t[r+2],this.w=t[r+3],this},toArray:function(t,r){return t===void 0&&(t=[]),r===void 0&&(r=0),t[r]=this.x,t[r+1]=this.y,t[r+2]=this.z,t[r+3]=this.w,t},fromBufferAttribute:function(t,r,i){return i!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(r),this.y=t.getY(r),this.z=t.getZ(r),this.w=t.getW(r),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}),bt.prototype=ut(at(se.prototype),{constructor:bt,isWebGLRenderTarget:!0,setSize:function(t,r){(this.width!==t||this.height!==r)&&(this.width=t,this.height=r,this.texture.image.width=t,this.texture.image.height=r,this.dispose()),this.viewport.set(0,0,t,r),this.scissor.set(0,0,t,r)},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),re.prototype=ut(at(bt.prototype),{constructor:re,isWebGLMultisampleRenderTarget:!0,copy:function(t){return bt.prototype.copy.call(this,t),this.samples=t.samples,this}}),ut(he,{slerp:function(t,r,i,s){return i.copy(t).slerp(r,s)},slerpFlat:function(t,r,i,s,f,c,g){var p=i[s+0],A=i[s+1],S=i[s+2];i=i[s+3],s=f[c+0];var N=f[c+1],_=f[c+2];if(f=f[c+3],i!==f||p!==s||A!==N||S!==_){c=1-g;var I=p*s+A*N+S*_+i*f,L=0<=I?1:-1,P=1-I*I;P>Dn&&(P=Math.sqrt(P),I=Math.atan2(P,I*L),c=Math.sin(c*I)/P,g=Math.sin(g*I)/P),L*=g,p=p*c+s*L,A=A*c+N*L,S=S*c+_*L,i=i*c+f*L,c===1-g&&(g=1/Math.sqrt(p*p+A*A+S*S+i*i),p*=g,A*=g,S*=g,i*=g)}t[r]=p,t[r+1]=A,t[r+2]=S,t[r+3]=i},multiplyQuaternionsFlat:function(t,r,i,s,f,c){var g=i[s],p=i[s+1],A=i[s+2];i=i[s+3],s=f[c];var S=f[c+1],N=f[c+2];return f=f[c+3],t[r]=g*f+i*s+p*N-A*S,t[r+1]=p*f+i*S+A*s-g*N,t[r+2]=A*f+i*N+g*S-p*s,t[r+3]=i*f-g*s-p*S-A*N,t}}),Xr(he.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),ut(he.prototype,{isQuaternion:!0,set:function(t,r,i,s){return this._x=t,this._y=r,this._z=i,this._w=s,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,r){if(!t||!t.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var i=t._x,s=t._y,f=t._z;t=t.order;var c=Math.cos,g=Math.sin,p=c(i/2),A=c(s/2);switch(c=c(f/2),i=g(i/2),s=g(s/2),f=g(f/2),t){case"XYZ":this._x=i*A*c+p*s*f,this._y=p*s*c-i*A*f,this._z=p*A*f+i*s*c,this._w=p*A*c-i*s*f;break;case"YXZ":this._x=i*A*c+p*s*f,this._y=p*s*c-i*A*f,this._z=p*A*f-i*s*c,this._w=p*A*c+i*s*f;break;case"ZXY":this._x=i*A*c-p*s*f,this._y=p*s*c+i*A*f,this._z=p*A*f+i*s*c,this._w=p*A*c-i*s*f;break;case"ZYX":this._x=i*A*c-p*s*f,this._y=p*s*c+i*A*f,this._z=p*A*f-i*s*c,this._w=p*A*c+i*s*f;break;case"YZX":this._x=i*A*c+p*s*f,this._y=p*s*c+i*A*f,this._z=p*A*f-i*s*c,this._w=p*A*c-i*s*f;break;case"XZY":this._x=i*A*c-p*s*f,this._y=p*s*c-i*A*f,this._z=p*A*f+i*s*c,this._w=p*A*c+i*s*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+t)}return r!==!1&&this._onChangeCallback(),this},setFromAxisAngle:function(t,r){r/=2;var i=Math.sin(r);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(r),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var r=t.elements,i=r[0];t=r[4];var s=r[8],f=r[1],c=r[5],g=r[9],p=r[2],A=r[6];r=r[10];var S=i+c+r;return 0<S?(i=.5/Math.sqrt(S+1),this._w=.25/i,this._x=(A-g)*i,this._y=(s-p)*i,this._z=(f-t)*i):i>c&&i>r?(i=2*Math.sqrt(1+i-c-r),this._w=(A-g)/i,this._x=.25*i,this._y=(t+f)/i,this._z=(s+p)/i):c>r?(i=2*Math.sqrt(1+c-i-r),this._w=(s-p)/i,this._x=(t+f)/i,this._y=.25*i,this._z=(g+A)/i):(i=2*Math.sqrt(1+r-i-c),this._w=(f-t)/i,this._x=(s+p)/i,this._y=(g+A)/i,this._z=.25*i),this._onChangeCallback(),this},setFromUnitVectors:function(t,r){var i=t.dot(r)+1;return 1e-6>i?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0):(this._x=0,this._y=-t.z,this._z=t.y)):(this._x=t.y*r.z-t.z*r.y,this._y=t.z*r.x-t.x*r.z,this._z=t.x*r.y-t.y*r.x),this._w=i,this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(Ar.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,r){var i=this.angleTo(t);return i===0?this:(this.slerp(t,Math.min(1,r/i)),this)},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return t===0?(this._z=this._y=this._x=0,this._w=1):(t=1/t,this._x*=t,this._y*=t,this._z*=t,this._w*=t),this._onChangeCallback(),this},multiply:function(t,r){return r!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,r)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,r){var i=t._x,s=t._y,f=t._z;t=t._w;var c=r._x,g=r._y,p=r._z;return r=r._w,this._x=i*r+t*c+s*p-f*g,this._y=s*r+t*g+f*c-i*p,this._z=f*r+t*p+i*g-s*c,this._w=t*r-i*c-s*g-f*p,this._onChangeCallback(),this},slerp:function(t,r){if(r===0)return this;if(r===1)return this.copy(t);var i=this._x,s=this._y,f=this._z,c=this._w,g=c*t._w+i*t._x+s*t._y+f*t._z;if(0>g?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,g=-g):this.copy(t),1<=g)return this._w=c,this._x=i,this._y=s,this._z=f,this;if(t=1-g*g,t<=Dn)return g=1-r,this._w=g*c+r*this._w,this._x=g*i+r*this._x,this._y=g*s+r*this._y,this._z=g*f+r*this._z,this.normalize(),this._onChangeCallback(),this;t=Math.sqrt(t);var p=Math.atan2(t,g);return g=Math.sin((1-r)*p)/t,r=Math.sin(r*p)/t,this._w=c*g+this._w*r,this._x=i*g+this._x*r,this._y=s*g+this._y*r,this._z=f*g+this._z*r,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,r){return r===void 0&&(r=0),this._x=t[r],this._y=t[r+1],this._z=t[r+2],this._w=t[r+3],this._onChangeCallback(),this},toArray:function(t,r){return t===void 0&&(t=[]),r===void 0&&(r=0),t[r]=this._x,t[r+1]=this._y,t[r+2]=this._z,t[r+3]=this._w,t},fromBufferAttribute:function(t,r){return this._x=t.getX(r),this._y=t.getY(r),this._z=t.getZ(r),this._w=t.getW(r),this},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});var ka=new lt,_v=new he;ut(lt.prototype,{isVector3:!0,set:function(t,r,i){return this.x=t,this.y=r,this.z=i,this},setScalar:function(t){return this.z=this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,r){switch(t){case 0:this.x=r;break;case 1:this.y=r;break;case 2:this.z=r;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,r){return r!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,r)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this.z=t.z+r.z,this},addScaledVector:function(t,r){return this.x+=t.x*r,this.y+=t.y*r,this.z+=t.z*r,this},sub:function(t,r){return r!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,r)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this.z=t.z-r.z,this},multiply:function(t,r){return r!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,r)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,r){return this.x=t.x*r.x,this.y=t.y*r.y,this.z=t.z*r.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(_v.setFromEuler(t))},applyAxisAngle:function(t,r){return this.applyQuaternion(_v.setFromAxisAngle(t,r))},applyMatrix3:function(t){var r=this.x,i=this.y,s=this.z;return t=t.elements,this.x=t[0]*r+t[3]*i+t[6]*s,this.y=t[1]*r+t[4]*i+t[7]*s,this.z=t[2]*r+t[5]*i+t[8]*s,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var r=this.x,i=this.y,s=this.z;t=t.elements;var f=1/(t[3]*r+t[7]*i+t[11]*s+t[15]);return this.x=(t[0]*r+t[4]*i+t[8]*s+t[12])*f,this.y=(t[1]*r+t[5]*i+t[9]*s+t[13])*f,this.z=(t[2]*r+t[6]*i+t[10]*s+t[14])*f,this},applyQuaternion:function(t){var r=this.x,i=this.y,s=this.z,f=t.x,c=t.y,g=t.z;t=t.w;var p=t*r+c*s-g*i,A=t*i+g*r-f*s,S=t*s+f*i-c*r;return r=-f*r-c*i-g*s,this.x=p*t+r*-f+A*-g-S*-c,this.y=A*t+r*-c+S*-f-p*-g,this.z=S*t+r*-g+p*-c-A*-f,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var r=this.x,i=this.y,s=this.z;return t=t.elements,this.x=t[0]*r+t[4]*i+t[8]*s,this.y=t[1]*r+t[5]*i+t[9]*s,this.z=t[2]*r+t[6]*i+t[10]*s,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,r){return this.x=Math.max(t.x,Math.min(r.x,this.x)),this.y=Math.max(t.y,Math.min(r.y,this.y)),this.z=Math.max(t.z,Math.min(r.z,this.z)),this},clampScalar:function(t,r){return this.x=Math.max(t,Math.min(r,this.x)),this.y=Math.max(t,Math.min(r,this.y)),this.z=Math.max(t,Math.min(r,this.z)),this},clampLength:function(t,r){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(r,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,r){return this.x+=(t.x-this.x)*r,this.y+=(t.y-this.y)*r,this.z+=(t.z-this.z)*r,this},lerpVectors:function(t,r,i){return this.x=t.x+(r.x-t.x)*i,this.y=t.y+(r.y-t.y)*i,this.z=t.z+(r.z-t.z)*i,this},cross:function(t,r){return r!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,r)):this.crossVectors(this,t)},crossVectors:function(t,r){var i=t.x,s=t.y;t=t.z;var f=r.x,c=r.y;return r=r.z,this.x=s*r-t*c,this.y=t*f-i*r,this.z=i*c-s*f,this},projectOnVector:function(t){var r=t.lengthSq();return r===0?this.set(0,0,0):(r=t.dot(this)/r,this.copy(t).multiplyScalar(r))},projectOnPlane:function(t){return ka.copy(this).projectOnVector(t),this.sub(ka)},reflect:function(t){return this.sub(ka.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var r=Math.sqrt(this.lengthSq()*t.lengthSq());return r===0?Math.PI/2:(t=this.dot(t)/r,Math.acos(Ar.clamp(t,-1,1)))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var r=this.x-t.x,i=this.y-t.y;return t=this.z-t.z,r*r+i*i+t*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,r,i){var s=Math.sin(r)*t;return this.x=s*Math.sin(i),this.y=Math.cos(r)*t,this.z=s*Math.cos(i),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,r,i){return this.x=t*Math.sin(r),this.y=i,this.z=t*Math.cos(r),this},setFromMatrixPosition:function(t){return t=t.elements,this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(t){var r=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length();return t=this.setFromMatrixColumn(t,2).length(),this.x=r,this.y=i,this.z=t,this},setFromMatrixColumn:function(t,r){return this.fromArray(t.elements,4*r)},setFromMatrix3Column:function(t,r){return this.fromArray(t.elements,3*r)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,r){return r===void 0&&(r=0),this.x=t[r],this.y=t[r+1],this.z=t[r+2],this},toArray:function(t,r){return t===void 0&&(t=[]),r===void 0&&(r=0),t[r]=this.x,t[r+1]=this.y,t[r+2]=this.z,t},fromBufferAttribute:function(t,r,i){return i!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(r),this.y=t.getY(r),this.z=t.getZ(r),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}});var Ul=new lt,Ga=new ye,Gc=new lt(0,0,0),J1=new lt(1,1,1),Hl=new lt,gg=new lt,Ps=new lt;ut(ye.prototype,{isMatrix4:!0,set:function(t,r,i,s,f,c,g,p,A,S,N,_,I,L,P,F){var W=this.elements;return W[0]=t,W[4]=r,W[8]=i,W[12]=s,W[1]=f,W[5]=c,W[9]=g,W[13]=p,W[2]=A,W[6]=S,W[10]=N,W[14]=_,W[3]=I,W[7]=L,W[11]=P,W[15]=F,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return new ye().fromArray(this.elements)},copy:function(t){var r=this.elements;return t=t.elements,r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],this},copyPosition:function(t){var r=this.elements;return t=t.elements,r[12]=t[12],r[13]=t[13],r[14]=t[14],this},extractBasis:function(t,r,i){return t.setFromMatrixColumn(this,0),r.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this},makeBasis:function(t,r,i){return this.set(t.x,r.x,i.x,0,t.y,r.y,i.y,0,t.z,r.z,i.z,0,0,0,0,1),this},extractRotation:function(t){var r=this.elements,i=t.elements,s=1/Ul.setFromMatrixColumn(t,0).length(),f=1/Ul.setFromMatrixColumn(t,1).length();return t=1/Ul.setFromMatrixColumn(t,2).length(),r[0]=i[0]*s,r[1]=i[1]*s,r[2]=i[2]*s,r[3]=0,r[4]=i[4]*f,r[5]=i[5]*f,r[6]=i[6]*f,r[7]=0,r[8]=i[8]*t,r[9]=i[9]*t,r[10]=i[10]*t,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var r=this.elements,i=t.x,s=t.y,f=t.z,c=Math.cos(i);i=Math.sin(i);var g=Math.cos(s);s=Math.sin(s);var p=Math.cos(f);if(f=Math.sin(f),t.order==="XYZ"){t=c*p;var A=c*f,S=i*p,N=i*f;r[0]=g*p,r[4]=-g*f,r[8]=s,r[1]=A+S*s,r[5]=t-N*s,r[9]=-i*g,r[2]=N-t*s,r[6]=S+A*s,r[10]=c*g}else t.order==="YXZ"?(t=g*p,A=g*f,S=s*p,N=s*f,r[0]=t+N*i,r[4]=S*i-A,r[8]=c*s,r[1]=c*f,r[5]=c*p,r[9]=-i,r[2]=A*i-S,r[6]=N+t*i,r[10]=c*g):t.order==="ZXY"?(t=g*p,A=g*f,S=s*p,N=s*f,r[0]=t-N*i,r[4]=-c*f,r[8]=S+A*i,r[1]=A+S*i,r[5]=c*p,r[9]=N-t*i,r[2]=-c*s,r[6]=i,r[10]=c*g):t.order==="ZYX"?(t=c*p,A=c*f,S=i*p,N=i*f,r[0]=g*p,r[4]=S*s-A,r[8]=t*s+N,r[1]=g*f,r[5]=N*s+t,r[9]=A*s-S,r[2]=-s,r[6]=i*g,r[10]=c*g):t.order==="YZX"?(t=c*g,A=c*s,S=i*g,N=i*s,r[0]=g*p,r[4]=N-t*f,r[8]=S*f+A,r[1]=f,r[5]=c*p,r[9]=-i*p,r[2]=-s*p,r[6]=A*f+S,r[10]=t-N*f):t.order==="XZY"&&(t=c*g,A=c*s,S=i*g,N=i*s,r[0]=g*p,r[4]=-f,r[8]=s*p,r[1]=t*f+N,r[5]=c*p,r[9]=A*f-S,r[2]=S*f-A,r[6]=i*p,r[10]=N*f+t);return r[3]=0,r[7]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(Gc,t,J1)},lookAt:function(t,r,i){var s=this.elements;return Ps.subVectors(t,r),Ps.lengthSq()===0&&(Ps.z=1),Ps.normalize(),Hl.crossVectors(i,Ps),Hl.lengthSq()===0&&(Math.abs(i.z)===1?Ps.x+=1e-4:Ps.z+=1e-4,Ps.normalize(),Hl.crossVectors(i,Ps)),Hl.normalize(),gg.crossVectors(Ps,Hl),s[0]=Hl.x,s[4]=gg.x,s[8]=Ps.x,s[1]=Hl.y,s[5]=gg.y,s[9]=Ps.y,s[2]=Hl.z,s[6]=gg.z,s[10]=Ps.z,this},multiply:function(t,r){return r!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,r)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,r){var i=t.elements,s=r.elements;r=this.elements,t=i[0];var f=i[4],c=i[8],g=i[12],p=i[1],A=i[5],S=i[9],N=i[13],_=i[2],I=i[6],L=i[10],P=i[14],F=i[3],W=i[7],X=i[11];i=i[15];var Z=s[0],tt=s[4],ot=s[8],xt=s[12],At=s[1],yt=s[5],zt=s[9],Ht=s[13],$t=s[2],Vt=s[6],Kt=s[10],ze=s[14],ae=s[3],Qe=s[7],gr=s[11];return s=s[15],r[0]=t*Z+f*At+c*$t+g*ae,r[4]=t*tt+f*yt+c*Vt+g*Qe,r[8]=t*ot+f*zt+c*Kt+g*gr,r[12]=t*xt+f*Ht+c*ze+g*s,r[1]=p*Z+A*At+S*$t+N*ae,r[5]=p*tt+A*yt+S*Vt+N*Qe,r[9]=p*ot+A*zt+S*Kt+N*gr,r[13]=p*xt+A*Ht+S*ze+N*s,r[2]=_*Z+I*At+L*$t+P*ae,r[6]=_*tt+I*yt+L*Vt+P*Qe,r[10]=_*ot+I*zt+L*Kt+P*gr,r[14]=_*xt+I*Ht+L*ze+P*s,r[3]=F*Z+W*At+X*$t+i*ae,r[7]=F*tt+W*yt+X*Vt+i*Qe,r[11]=F*ot+W*zt+X*Kt+i*gr,r[15]=F*xt+W*Ht+X*ze+i*s,this},multiplyScalar:function(t){var r=this.elements;return r[0]*=t,r[4]*=t,r[8]*=t,r[12]*=t,r[1]*=t,r[5]*=t,r[9]*=t,r[13]*=t,r[2]*=t,r[6]*=t,r[10]*=t,r[14]*=t,r[3]*=t,r[7]*=t,r[11]*=t,r[15]*=t,this},determinant:function(){var t=this.elements,r=t[0],i=t[4],s=t[8],f=t[12],c=t[1],g=t[5],p=t[9],A=t[13],S=t[2],N=t[6],_=t[10],I=t[14];return t[3]*(+f*p*N-s*A*N-f*g*_+i*A*_+s*g*I-i*p*I)+t[7]*(+r*p*I-r*A*_+f*c*_-s*c*I+s*A*S-f*p*S)+t[11]*(+r*A*N-r*g*I-f*c*N+i*c*I+f*g*S-i*A*S)+t[15]*(-s*g*S-r*p*N+r*g*_+s*c*N-i*c*_+i*p*S)},transpose:function(){var t=this.elements,r=t[1];return t[1]=t[4],t[4]=r,r=t[2],t[2]=t[8],t[8]=r,r=t[6],t[6]=t[9],t[9]=r,r=t[3],t[3]=t[12],t[12]=r,r=t[7],t[7]=t[13],t[13]=r,r=t[11],t[11]=t[14],t[14]=r,this},setPosition:function(t,r,i){var s=this.elements;return t.isVector3?(s[12]=t.x,s[13]=t.y,s[14]=t.z):(s[12]=t,s[13]=r,s[14]=i),this},getInverse:function(t,r){r!==void 0&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate."),r=this.elements;var i=t.elements;t=i[0];var s=i[1],f=i[2],c=i[3],g=i[4],p=i[5],A=i[6],S=i[7],N=i[8],_=i[9],I=i[10],L=i[11],P=i[12],F=i[13],W=i[14];i=i[15];var X=_*W*S-F*I*S+F*A*L-p*W*L-_*A*i+p*I*i,Z=P*I*S-N*W*S-P*A*L+g*W*L+N*A*i-g*I*i,tt=N*F*S-P*_*S+P*p*L-g*F*L-N*p*i+g*_*i,ot=P*_*A-N*F*A-P*p*I+g*F*I+N*p*W-g*_*W,xt=t*X+s*Z+f*tt+c*ot;return xt===0?this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0):(xt=1/xt,r[0]=X*xt,r[1]=(F*I*c-_*W*c-F*f*L+s*W*L+_*f*i-s*I*i)*xt,r[2]=(p*W*c-F*A*c+F*f*S-s*W*S-p*f*i+s*A*i)*xt,r[3]=(_*A*c-p*I*c-_*f*S+s*I*S+p*f*L-s*A*L)*xt,r[4]=Z*xt,r[5]=(N*W*c-P*I*c+P*f*L-t*W*L-N*f*i+t*I*i)*xt,r[6]=(P*A*c-g*W*c-P*f*S+t*W*S+g*f*i-t*A*i)*xt,r[7]=(g*I*c-N*A*c+N*f*S-t*I*S-g*f*L+t*A*L)*xt,r[8]=tt*xt,r[9]=(P*_*c-N*F*c-P*s*L+t*F*L+N*s*i-t*_*i)*xt,r[10]=(g*F*c-P*p*c+P*s*S-t*F*S-g*s*i+t*p*i)*xt,r[11]=(N*p*c-g*_*c-N*s*S+t*_*S+g*s*L-t*p*L)*xt,r[12]=ot*xt,r[13]=(N*F*f-P*_*f+P*s*I-t*F*I-N*s*W+t*_*W)*xt,r[14]=(P*p*f-g*F*f-P*s*A+t*F*A+g*s*W-t*p*W)*xt,r[15]=(g*_*f-N*p*f+N*s*A-t*_*A-g*s*I+t*p*I)*xt,this)},scale:function(t){var r=this.elements,i=t.x,s=t.y;return t=t.z,r[0]*=i,r[4]*=s,r[8]*=t,r[1]*=i,r[5]*=s,r[9]*=t,r[2]*=i,r[6]*=s,r[10]*=t,r[3]*=i,r[7]*=s,r[11]*=t,this},getMaxScaleOnAxis:function(){var t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))},makeTranslation:function(t,r,i){return this.set(1,0,0,t,0,1,0,r,0,0,1,i,0,0,0,1),this},makeRotationX:function(t){var r=Math.cos(t);return t=Math.sin(t),this.set(1,0,0,0,0,r,-t,0,0,t,r,0,0,0,0,1),this},makeRotationY:function(t){var r=Math.cos(t);return t=Math.sin(t),this.set(r,0,t,0,0,1,0,0,-t,0,r,0,0,0,0,1),this},makeRotationZ:function(t){var r=Math.cos(t);return t=Math.sin(t),this.set(r,-t,0,0,t,r,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,r){var i=Math.cos(r);r=Math.sin(r);var s=1-i,f=t.x,c=t.y;t=t.z;var g=s*f,p=s*c;return this.set(g*f+i,g*c-r*t,g*t+r*c,0,g*c+r*t,p*c+i,p*t-r*f,0,g*t-r*c,p*t+r*f,s*t*t+i,0,0,0,0,1),this},makeScale:function(t,r,i){return this.set(t,0,0,0,0,r,0,0,0,0,i,0,0,0,0,1),this},makeShear:function(t,r,i){return this.set(1,r,i,0,t,1,i,0,t,r,1,0,0,0,0,1),this},compose:function(t,r,i){var s=this.elements,f=r._x,c=r._y,g=r._z,p=r._w,A=f+f,S=c+c,N=g+g;r=f*A;var _=f*S;f*=N;var I=c*S;c*=N,g*=N,A*=p,S*=p,p*=N,N=i.x;var L=i.y;return i=i.z,s[0]=(1-(I+g))*N,s[1]=(_+p)*N,s[2]=(f-S)*N,s[3]=0,s[4]=(_-p)*L,s[5]=(1-(r+g))*L,s[6]=(c+A)*L,s[7]=0,s[8]=(f+S)*i,s[9]=(c-A)*i,s[10]=(1-(r+I))*i,s[11]=0,s[12]=t.x,s[13]=t.y,s[14]=t.z,s[15]=1,this},decompose:function(t,r,i){var s=this.elements,f=Ul.set(s[0],s[1],s[2]).length(),c=Ul.set(s[4],s[5],s[6]).length(),g=Ul.set(s[8],s[9],s[10]).length();0>this.determinant()&&(f=-f),t.x=s[12],t.y=s[13],t.z=s[14],Ga.copy(this),t=1/f,s=1/c;var p=1/g;return Ga.elements[0]*=t,Ga.elements[1]*=t,Ga.elements[2]*=t,Ga.elements[4]*=s,Ga.elements[5]*=s,Ga.elements[6]*=s,Ga.elements[8]*=p,Ga.elements[9]*=p,Ga.elements[10]*=p,r.setFromRotationMatrix(Ga),i.x=f,i.y=c,i.z=g,this},makePerspective:function(t,r,i,s,f,c){c===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var g=this.elements;return g[0]=2*f/(r-t),g[4]=0,g[8]=(r+t)/(r-t),g[12]=0,g[1]=0,g[5]=2*f/(i-s),g[9]=(i+s)/(i-s),g[13]=0,g[2]=0,g[6]=0,g[10]=-(c+f)/(c-f),g[14]=-2*c*f/(c-f),g[3]=0,g[7]=0,g[11]=-1,g[15]=0,this},makeOrthographic:function(t,r,i,s,f,c){var g=this.elements,p=1/(r-t),A=1/(i-s),S=1/(c-f);return g[0]=2*p,g[4]=0,g[8]=0,g[12]=-((r+t)*p),g[1]=0,g[5]=2*A,g[9]=0,g[13]=-((i+s)*A),g[2]=0,g[6]=0,g[10]=-2*S,g[14]=-((c+f)*S),g[3]=0,g[7]=0,g[11]=0,g[15]=1,this},equals:function(t){var r=this.elements;t=t.elements;for(var i=0;16>i;i++)if(r[i]!==t[i])return!1;return!0},fromArray:function(t,r){r===void 0&&(r=0);for(var i=0;16>i;i++)this.elements[i]=t[i+r];return this},toArray:function(t,r){t===void 0&&(t=[]),r===void 0&&(r=0);var i=this.elements;return t[r]=i[0],t[r+1]=i[1],t[r+2]=i[2],t[r+3]=i[3],t[r+4]=i[4],t[r+5]=i[5],t[r+6]=i[6],t[r+7]=i[7],t[r+8]=i[8],t[r+9]=i[9],t[r+10]=i[10],t[r+11]=i[11],t[r+12]=i[12],t[r+13]=i[13],t[r+14]=i[14],t[r+15]=i[15],t}});var Mv=new ye,mg=new he;ci.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" "),ci.DefaultOrder="XYZ",Xr(ci.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),ut(ci.prototype,{isEuler:!0,set:function(t,r,i,s){return this._x=t,this._y=r,this._z=i,this._order=s||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,r,i){var s=Ar.clamp,f=t.elements;t=f[0];var c=f[4],g=f[8],p=f[1],A=f[5],S=f[9],N=f[2],_=f[6];switch(f=f[10],r=r||this._order,r){case"XYZ":this._y=Math.asin(s(g,-1,1)),.9999999>Math.abs(g)?(this._x=Math.atan2(-S,f),this._z=Math.atan2(-c,t)):(this._x=Math.atan2(_,A),this._z=0);break;case"YXZ":this._x=Math.asin(-s(S,-1,1)),.9999999>Math.abs(S)?(this._y=Math.atan2(g,f),this._z=Math.atan2(p,A)):(this._y=Math.atan2(-N,t),this._z=0);break;case"ZXY":this._x=Math.asin(s(_,-1,1)),.9999999>Math.abs(_)?(this._y=Math.atan2(-N,f),this._z=Math.atan2(-c,A)):(this._y=0,this._z=Math.atan2(p,t));break;case"ZYX":this._y=Math.asin(-s(N,-1,1)),.9999999>Math.abs(N)?(this._x=Math.atan2(_,f),this._z=Math.atan2(p,t)):(this._x=0,this._z=Math.atan2(-c,A));break;case"YZX":this._z=Math.asin(s(p,-1,1)),.9999999>Math.abs(p)?(this._x=Math.atan2(-S,A),this._y=Math.atan2(-N,t)):(this._x=0,this._y=Math.atan2(g,f));break;case"XZY":this._z=Math.asin(-s(c,-1,1)),.9999999>Math.abs(c)?(this._x=Math.atan2(_,A),this._y=Math.atan2(g,t)):(this._x=Math.atan2(-S,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+r)}return this._order=r,i!==!1&&this._onChangeCallback(),this},setFromQuaternion:function(t,r,i){return Mv.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Mv,r,i)},setFromVector3:function(t,r){return this.set(t.x,t.y,t.z,r||this._order)},reorder:function(t){return mg.setFromEuler(this),this.setFromQuaternion(mg,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,r){return t===void 0&&(t=[]),r===void 0&&(r=0),t[r]=this._x,t[r+1]=this._y,t[r+2]=this._z,t[r+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new lt(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),ut(Or.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask=this.mask|1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return(this.mask&t.mask)!=0}});var q1=0,K1=new lt,bc=new he,Gu=new ye,vg=new lt,vp=new lt,DA=new lt,OA=new he,Cv=new lt(1,0,0),Tv=new lt(0,1,0),Sv=new lt(0,0,1),FA={type:"added"},BA={type:"removed"};Ce.DefaultUp=new lt(0,1,0),Ce.DefaultMatrixAutoUpdate=!0,Ce.prototype=ut(at(se.prototype),{constructor:Ce,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,r){this.quaternion.setFromAxisAngle(t,r)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,r){return bc.setFromAxisAngle(t,r),this.quaternion.multiply(bc),this},rotateOnWorldAxis:function(t,r){return bc.setFromAxisAngle(t,r),this.quaternion.premultiply(bc),this},rotateX:function(t){return this.rotateOnAxis(Cv,t)},rotateY:function(t){return this.rotateOnAxis(Tv,t)},rotateZ:function(t){return this.rotateOnAxis(Sv,t)},translateOnAxis:function(t,r){return K1.copy(t).applyQuaternion(this.quaternion),this.position.add(K1.multiplyScalar(r)),this},translateX:function(t){return this.translateOnAxis(Cv,t)},translateY:function(t){return this.translateOnAxis(Tv,t)},translateZ:function(t){return this.translateOnAxis(Sv,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(Gu.getInverse(this.matrixWorld))},lookAt:function(t,r,i){t.isVector3?vg.copy(t):vg.set(t,r,i),t=this.parent,this.updateWorldMatrix(!0,!1),vp.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Gu.lookAt(vp,vg,this.up):Gu.lookAt(vg,vp,this.up),this.quaternion.setFromRotationMatrix(Gu),t&&(Gu.extractRotation(t.matrixWorld),bc.setFromRotationMatrix(Gu),this.quaternion.premultiply(bc.inverse()))},add:function(t){if(1<arguments.length){for(var r=0;r<arguments.length;r++)this.add(arguments[r]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(FA)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(1<arguments.length){for(var r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}return r=this.children.indexOf(t),r!==-1&&(t.parent=null,this.children.splice(r,1),t.dispatchEvent(BA)),this},attach:function(t){return this.updateWorldMatrix(!0,!1),Gu.getInverse(this.matrixWorld),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),Gu.multiply(t.parent.matrixWorld)),t.applyMatrix4(Gu),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,r){if(this[t]===r)return this;for(var i=0,s=this.children.length;i<s;i++){var f=this.children[i].getObjectByProperty(t,r);if(f!==void 0)return f}},getWorldPosition:function(t){return t===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new lt),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return t===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new he),this.updateMatrixWorld(!0),this.matrixWorld.decompose(vp,t,DA),t},getWorldScale:function(t){return t===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new lt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(vp,OA,t),t},getWorldDirection:function(t){t===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new lt),this.updateMatrixWorld(!0);var r=this.matrixWorld.elements;return t.set(r[8],r[9],r[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var r=this.children,i=0,s=r.length;i<s;i++)r[i].traverse(t)},traverseVisible:function(t){if(this.visible!==!1){t(this);for(var r=this.children,i=0,s=r.length;i<s;i++)r[i].traverseVisible(t)}},traverseAncestors:function(t){var r=this.parent;r!==null&&(t(r),r.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var r=this.children,i=0,s=r.length;i<s;i++)r[i].updateMatrixWorld(t)},updateWorldMatrix:function(t,r){var i=this.parent;if(t===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),r===!0)for(t=this.children,r=0,i=t.length;r<i;r++)t[r].updateWorldMatrix(!1,!0)},toJSON:function(t){function r(N,_){return N[_.uuid]===void 0&&(N[_.uuid]=_.toJSON(t)),_.uuid}function i(N){var _=[],I;for(I in N){var L=N[I];delete L.metadata,_.push(L)}return _}var s=t===void 0||typeof t=="string",f={};s&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},f.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var c={};if(c.uuid=this.uuid,c.type=this.type,this.name!==""&&(c.name=this.name),this.castShadow===!0&&(c.castShadow=!0),this.receiveShadow===!0&&(c.receiveShadow=!0),this.visible===!1&&(c.visible=!1),this.frustumCulled===!1&&(c.frustumCulled=!1),this.renderOrder!==0&&(c.renderOrder=this.renderOrder),ls(this.userData)!=="{}"&&(c.userData=this.userData),c.layers=this.layers.mask,c.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(c.matrixAutoUpdate=!1),this.isInstancedMesh&&(c.type="InstancedMesh",c.count=this.count,c.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){c.geometry=r(t.geometries,this.geometry);var g=this.geometry.parameters;if(g!==void 0&&g.shapes!==void 0)if(g=g.shapes,Array.isArray(g))for(var p=0,A=g.length;p<A;p++)r(t.shapes,g[p]);else r(t.shapes,g)}if(this.material!==void 0)if(Array.isArray(this.material)){for(g=[],p=0,A=this.material.length;p<A;p++)g.push(r(t.materials,this.material[p]));c.material=g}else c.material=r(t.materials,this.material);if(0<this.children.length)for(c.children=[],p=0;p<this.children.length;p++)c.children.push(this.children[p].toJSON(t).object);if(s){s=i(t.geometries),p=i(t.materials),A=i(t.textures);var S=i(t.images);g=i(t.shapes),0<s.length&&(f.geometries=s),0<p.length&&(f.materials=p),0<A.length&&(f.textures=A),0<S.length&&(f.images=S),0<g.length&&(f.shapes=g)}return f.object=c,f},clone:function(t){return new this.constructor().copy(this,t)},copy:function(t,r){if(r===void 0&&(r=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(ls(t.userData)),r===!0)for(r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}),ti.prototype=ut(at(Ce.prototype),{constructor:ti,isScene:!0,copy:function(t,r){return Ce.prototype.copy.call(this,t,r),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var r=Ce.prototype.toJSON.call(this,t);return this.background!==null&&(r.object.background=this.background.toJSON(t)),this.environment!==null&&(r.object.environment=this.environment.toJSON(t)),this.fog!==null&&(r.object.fog=this.fog.toJSON()),r},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Ds=[new lt,new lt,new lt,new lt,new lt,new lt,new lt,new lt],Uh=new lt,yg=new Ai,ba=new lt,Vc=new lt,Wc=new lt,kl=new lt,Gl=new lt,Hh=new lt,yp=new lt,xg=new lt,Ag=new lt,kh=new lt;ut(Ai.prototype,{isBox3:!0,set:function(t,r){return this.min.copy(t),this.max.copy(r),this},setFromArray:function(t){for(var r=Infinity,i=Infinity,s=Infinity,f=-Infinity,c=-Infinity,g=-Infinity,p=0,A=t.length;p<A;p+=3){var S=t[p],N=t[p+1],_=t[p+2];S<r&&(r=S),N<i&&(i=N),_<s&&(s=_),S>f&&(f=S),N>c&&(c=N),_>g&&(g=_)}return this.min.set(r,i,s),this.max.set(f,c,g),this},setFromBufferAttribute:function(t){for(var r=Infinity,i=Infinity,s=Infinity,f=-Infinity,c=-Infinity,g=-Infinity,p=0,A=t.count;p<A;p++){var S=t.getX(p),N=t.getY(p),_=t.getZ(p);S<r&&(r=S),N<i&&(i=N),_<s&&(s=_),S>f&&(f=S),N>c&&(c=N),_>g&&(g=_)}return this.min.set(r,i,s),this.max.set(f,c,g),this},setFromPoints:function(t){this.makeEmpty();for(var r=0,i=t.length;r<i;r++)this.expandByPoint(t[r]);return this},setFromCenterAndSize:function(t,r){return r=Uh.copy(r).multiplyScalar(.5),this.min.copy(t).sub(r),this.max.copy(t).add(r),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=Infinity,this.max.x=this.max.y=this.max.z=-Infinity,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return t===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new lt),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return t===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new lt),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1);var r=t.geometry;r!==void 0&&(r.boundingBox===null&&r.computeBoundingBox(),yg.copy(r.boundingBox),yg.applyMatrix4(t.matrixWorld),this.union(yg)),t=t.children,r=0;for(var i=t.length;r<i;r++)this.expandByObject(t[r]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,r){return r===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),r=new lt),r.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,Uh),Uh.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){if(0<t.normal.x)var r=t.normal.x*this.min.x,i=t.normal.x*this.max.x;else r=t.normal.x*this.max.x,i=t.normal.x*this.min.x;return 0<t.normal.y?(r+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(r+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),0<t.normal.z?(r+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(r+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),r<=-t.constant&&i>=-t.constant},intersectsTriangle:function(t){return this.isEmpty()||(this.getCenter(yp),xg.subVectors(this.max,yp),ba.subVectors(t.a,yp),Vc.subVectors(t.b,yp),Wc.subVectors(t.c,yp),kl.subVectors(Vc,ba),Gl.subVectors(Wc,Vc),Hh.subVectors(ba,Wc),t=[0,-kl.z,kl.y,0,-Gl.z,Gl.y,0,-Hh.z,Hh.y,kl.z,0,-kl.x,Gl.z,0,-Gl.x,Hh.z,0,-Hh.x,-kl.y,kl.x,0,-Gl.y,Gl.x,0,-Hh.y,Hh.x,0],!Ti(t,ba,Vc,Wc,xg))||(t=[1,0,0,0,1,0,0,0,1],!Ti(t,ba,Vc,Wc,xg))?!1:(Ag.crossVectors(kl,Gl),t=[Ag.x,Ag.y,Ag.z],Ti(t,ba,Vc,Wc,xg))},clampPoint:function(t,r){return r===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),r=new lt),r.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return Uh.copy(t).clamp(this.min,this.max).sub(t).length()},getBoundingSphere:function(t){return t===void 0&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(Uh).length(),t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()?this:(Ds[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Ds[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Ds[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Ds[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Ds[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Ds[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Ds[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Ds[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Ds),this)},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var NA=new Ai;ut(Fn.prototype,{set:function(t,r){return this.center.copy(t),this.radius=r,this},setFromPoints:function(t,r){var i=this.center;r!==void 0?i.copy(r):NA.setFromPoints(t).getCenter(i);for(var s=r=0,f=t.length;s<f;s++)r=Math.max(r,i.distanceToSquared(t[s]));return this.radius=Math.sqrt(r),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},isEmpty:function(){return 0>this.radius},makeEmpty:function(){return this.center.set(0,0,0),this.radius=-1,this},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var r=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=r*r},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,r){var i=this.center.distanceToSquared(t);return r===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),r=new lt),r.copy(t),i>this.radius*this.radius&&(r.sub(this.center).normalize(),r.multiplyScalar(this.radius).add(this.center)),r},getBoundingBox:function(t){return t===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new Ai),this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius*=t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}});var bu=new lt,Iv=new lt,a=new lt,u=new lt,n=new lt,l=new lt,v=new lt;ut(xo.prototype,{set:function(t,r){return this.origin.copy(t),this.direction.copy(r),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,r){return r===void 0&&(console.warn("THREE.Ray: .at() target is now required"),r=new lt),r.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(t){return this.origin.copy(this.at(t,bu)),this},closestPointToPoint:function(t,r){return r===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),r=new lt),r.subVectors(t,this.origin),t=r.dot(this.direction),0>t?r.copy(this.origin):r.copy(this.direction).multiplyScalar(t).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(t){var r=bu.subVectors(t,this.origin).dot(this.direction);return 0>r?this.origin.distanceToSquared(t):(bu.copy(this.direction).multiplyScalar(r).add(this.origin),bu.distanceToSquared(t))},distanceSqToSegment:function(t,r,i,s){Iv.copy(t).add(r).multiplyScalar(.5),a.copy(r).sub(t).normalize(),u.copy(this.origin).sub(Iv);var f=.5*t.distanceTo(r),c=-this.direction.dot(a),g=u.dot(this.direction),p=-u.dot(a),A=u.lengthSq(),S=Math.abs(1-c*c);if(0<S){t=c*p-g,r=c*g-p;var N=f*S;0<=t?r>=-N?r<=N?(f=1/S,t*=f,r*=f,c=t*(t+c*r+2*g)+r*(c*t+r+2*p)+A):(r=f,t=Math.max(0,-(c*r+g)),c=-t*t+r*(r+2*p)+A):(r=-f,t=Math.max(0,-(c*r+g)),c=-t*t+r*(r+2*p)+A):r<=-N?(t=Math.max(0,-(-c*f+g)),r=0<t?-f:Math.min(Math.max(-f,-p),f),c=-t*t+r*(r+2*p)+A):r<=N?(t=0,r=Math.min(Math.max(-f,-p),f),c=r*(r+2*p)+A):(t=Math.max(0,-(c*f+g)),r=0<t?f:Math.min(Math.max(-f,-p),f),c=-t*t+r*(r+2*p)+A)}else r=0<c?-f:f,t=Math.max(0,-(c*r+g)),c=-t*t+r*(r+2*p)+A;return i&&i.copy(this.direction).multiplyScalar(t).add(this.origin),s&&s.copy(a).multiplyScalar(r).add(Iv),c},intersectSphere:function(t,r){bu.subVectors(t.center,this.origin);var i=bu.dot(this.direction),s=bu.dot(bu)-i*i;return t=t.radius*t.radius,s>t?null:(t=Math.sqrt(t-s),s=i-t,i+=t,0>s&&0>i?null:0>s?this.at(i,r):this.at(s,r))},intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){var r=t.normal.dot(this.direction);return r===0?t.distanceToPoint(this.origin)===0?0:null:(t=-(this.origin.dot(t.normal)+t.constant)/r,0<=t?t:null)},intersectPlane:function(t,r){return t=this.distanceToPlane(t),t===null?null:this.at(t,r)},intersectsPlane:function(t){var r=t.distanceToPoint(this.origin);return r===0||0>t.normal.dot(this.direction)*r},intersectBox:function(t,r){var i=1/this.direction.x,s=1/this.direction.y,f=1/this.direction.z,c=this.origin;if(0<=i){var g=(t.min.x-c.x)*i;i*=t.max.x-c.x}else g=(t.max.x-c.x)*i,i*=t.min.x-c.x;if(0<=s){var p=(t.min.y-c.y)*s;s*=t.max.y-c.y}else p=(t.max.y-c.y)*s,s*=t.min.y-c.y;return g>s||p>i||((p>g||g!==g)&&(g=p),(s<i||i!==i)&&(i=s),0<=f?(p=(t.min.z-c.z)*f,t=(t.max.z-c.z)*f):(p=(t.max.z-c.z)*f,t=(t.min.z-c.z)*f),g>t||p>i)?null:((p>g||g!==g)&&(g=p),(t<i||i!==i)&&(i=t),0>i?null:this.at(0<=g?g:i,r))},intersectsBox:function(t){return this.intersectBox(t,bu)!==null},intersectTriangle:function(t,r,i,s,f){if(n.subVectors(r,t),l.subVectors(i,t),v.crossVectors(n,l),r=this.direction.dot(v),0<r){if(s)return null;s=1}else if(0>r)s=-1,r=-r;else return null;return u.subVectors(this.origin,t),t=s*this.direction.dot(l.crossVectors(u,l)),0>t||(i=s*this.direction.dot(n.cross(u)),0>i||t+i>r)?null:(t=-s*u.dot(v),0>t?null:this.at(t/r,f))},applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}});var d=new lt,x=new lt,y=new Ft;ut(Wi.prototype,{isPlane:!0,set:function(t,r){return this.normal.copy(t),this.constant=r,this},setComponents:function(t,r,i,s){return this.normal.set(t,r,i),this.constant=s,this},setFromNormalAndCoplanarPoint:function(t,r){return this.normal.copy(t),this.constant=-r.dot(this.normal),this},setFromCoplanarPoints:function(t,r,i){return r=d.subVectors(i,r).cross(x.subVectors(t,r)).normalize(),this.setFromNormalAndCoplanarPoint(r,t),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,r){return r===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),r=new lt),r.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(t,r){r===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),r=new lt);var i=t.delta(d),s=this.normal.dot(i);if(s===0){if(this.distanceToPoint(t.start)===0)return r.copy(t.start)}else if(s=-(t.start.dot(this.normal)+this.constant)/s,!(0>s||1<s))return r.copy(i).multiplyScalar(s).add(t.start)},intersectsLine:function(t){var r=this.distanceToPoint(t.start);return t=this.distanceToPoint(t.end),0>r&&0<t||0>t&&0<r},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return t===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new lt),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(t,r){return r=r||y.getNormalMatrix(t),t=this.coplanarPoint(d).applyMatrix4(t),r=this.normal.applyMatrix3(r).normalize(),this.constant=-t.dot(r),this},translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}});var M=new lt,D=new lt,U=new lt,C=new lt,E=new lt,B=new lt,O=new lt,H=new lt,V=new lt,G=new lt;ut(Xi,{getNormal:function(t,r,i,s){return s===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),s=new lt),s.subVectors(i,r),M.subVectors(t,r),s.cross(M),t=s.lengthSq(),0<t?s.multiplyScalar(1/Math.sqrt(t)):s.set(0,0,0)},getBarycoord:function(t,r,i,s,f){M.subVectors(s,r),D.subVectors(i,r),U.subVectors(t,r),t=M.dot(M),r=M.dot(D),i=M.dot(U);var c=D.dot(D);s=D.dot(U);var g=t*c-r*r;return f===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),f=new lt),g===0?f.set(-2,-1,-1):(g=1/g,c=(c*i-r*s)*g,t=(t*s-r*i)*g,f.set(1-c-t,t,c))},containsPoint:function(t,r,i,s){return Xi.getBarycoord(t,r,i,s,C),0<=C.x&&0<=C.y&&1>=C.x+C.y},getUV:function(t,r,i,s,f,c,g,p){return this.getBarycoord(t,r,i,s,C),p.set(0,0),p.addScaledVector(f,C.x),p.addScaledVector(c,C.y),p.addScaledVector(g,C.z),p},isFrontFacing:function(t,r,i,s){return M.subVectors(i,r),D.subVectors(t,r),0>M.cross(D).dot(s)}}),ut(Xi.prototype,{set:function(t,r,i){return this.a.copy(t),this.b.copy(r),this.c.copy(i),this},setFromPointsAndIndices:function(t,r,i,s){return this.a.copy(t[r]),this.b.copy(t[i]),this.c.copy(t[s]),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){return M.subVectors(this.c,this.b),D.subVectors(this.a,this.b),.5*M.cross(D).length()},getMidpoint:function(t){return t===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new lt),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return Xi.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return t===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new Wi),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,r){return Xi.getBarycoord(t,this.a,this.b,this.c,r)},getUV:function(t,r,i,s,f){return Xi.getUV(t,this.a,this.b,this.c,r,i,s,f)},containsPoint:function(t){return Xi.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return Xi.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(t,r){r===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),r=new lt);var i=this.a,s=this.b,f=this.c;E.subVectors(s,i),B.subVectors(f,i),H.subVectors(t,i);var c=E.dot(H),g=B.dot(H);if(0>=c&&0>=g)return r.copy(i);V.subVectors(t,s);var p=E.dot(V),A=B.dot(V);if(0<=p&&A<=p)return r.copy(s);var S=c*A-p*g;if(0>=S&&0<=c&&0>=p)return s=c/(c-p),r.copy(i).addScaledVector(E,s);G.subVectors(t,f),t=E.dot(G);var N=B.dot(G);return 0<=N&&t<=N?r.copy(f):(c=t*g-c*N,0>=c&&0<=g&&0>=N?(S=g/(g-N),r.copy(i).addScaledVector(B,S)):(g=p*N-t*A,0>=g&&0<=A-p&&0<=t-N?(O.subVectors(f,s),S=(A-p)/(A-p+(t-N)),r.copy(s).addScaledVector(O,S)):(f=1/(g+c+S),s=c*f,S*=f,r.copy(i).addScaledVector(E,s).addScaledVector(B,S))))},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}});var j={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Y={h:0,s:0,l:0},$={h:0,s:0,l:0};ut(Ue.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):typeof t=="number"?this.setHex(t):typeof t=="string"&&this.setStyle(t),this},setScalar:function(t){return this.b=this.g=this.r=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,this},setRGB:function(t,r,i){return this.r=t,this.g=r,this.b=i,this},setHSL:function(t,r,i){return t=Ar.euclideanModulo(t,1),r=Ar.clamp(r,0,1),i=Ar.clamp(i,0,1),r===0?this.r=this.g=this.b=i:(r=.5>=i?i*(1+r):i+r-i*r,i=2*i-r,this.r=jo(i,r,t+1/3),this.g=jo(i,r,t),this.b=jo(i,r,t-1/3)),this},setStyle:function(t){function r(g){g!==void 0&&1>parseFloat(g)&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var i;if(i=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var s=i[2];switch(i[1]){case"rgb":case"rgba":if(i=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(s))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,r(i[5]),this;if(i=/^(\d+)%\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(s))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,r(i[5]),this;break;case"hsl":case"hsla":if(i=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(s)){s=parseFloat(i[1])/360;var f=parseInt(i[2],10)/100,c=parseInt(i[3],10)/100;return r(i[5]),this.setHSL(s,f,c)}}}else if(i=/^#([A-Fa-f0-9]+)$/.exec(t)){if(i=i[1],s=i.length,s===3)return this.r=parseInt(i.charAt(0)+i.charAt(0),16)/255,this.g=parseInt(i.charAt(1)+i.charAt(1),16)/255,this.b=parseInt(i.charAt(2)+i.charAt(2),16)/255,this;if(s===6)return this.r=parseInt(i.charAt(0)+i.charAt(1),16)/255,this.g=parseInt(i.charAt(2)+i.charAt(3),16)/255,this.b=parseInt(i.charAt(4)+i.charAt(5),16)/255,this}return t&&0<t.length?this.setColorName(t):this},setColorName:function(t){var r=j[t];return r!==void 0?this.setHex(r):console.warn("THREE.Color: Unknown color "+t),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,r){return r===void 0&&(r=2),this.r=Math.pow(t.r,r),this.g=Math.pow(t.g,r),this.b=Math.pow(t.b,r),this},copyLinearToGamma:function(t,r){return r===void 0&&(r=2),r=0<r?1/r:1,this.r=Math.pow(t.r,r),this.g=Math.pow(t.g,r),this.b=Math.pow(t.b,r),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=Ma(t.r),this.g=Ma(t.g),this.b=Ma(t.b),this},copyLinearToSRGB:function(t){return this.r=ia(t.r),this.g=ia(t.g),this.b=ia(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){t===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var r=this.r,i=this.g,s=this.b,f=Math.max(r,i,s),c=Math.min(r,i,s),g,p=(c+f)/2;if(c===f)c=g=0;else{var A=f-c;switch(c=.5>=p?A/(f+c):A/(2-f-c),f){case r:g=(i-s)/A+(i<s?6:0);break;case i:g=(s-r)/A+2;break;case s:g=(r-i)/A+4}g/=6}return t.h=g,t.s=c,t.l=p,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,r,i){return this.getHSL(Y),Y.h+=t,Y.s+=r,Y.l+=i,this.setHSL(Y.h,Y.s,Y.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,r){return this.r=t.r+r.r,this.g=t.g+r.g,this.b=t.b+r.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,r){return this.r+=(t.r-this.r)*r,this.g+=(t.g-this.g)*r,this.b+=(t.b-this.b)*r,this},lerpHSL:function(t,r){this.getHSL(Y),t.getHSL($),t=Ar.lerp(Y.h,$.h,r);var i=Ar.lerp(Y.s,$.s,r);return r=Ar.lerp(Y.l,$.l,r),this.setHSL(t,i,r),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,r){return r===void 0&&(r=0),this.r=t[r],this.g=t[r+1],this.b=t[r+2],this},toArray:function(t,r){return t===void 0&&(t=[]),r===void 0&&(r=0),t[r]=this.r,t[r+1]=this.g,t[r+2]=this.b,t},toJSON:function(){return this.getHex()}}),Ue.NAMES=j,ut(Ca.prototype,{clone:function(){return new this.constructor().copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var r=0,i=t.vertexNormals.length;r<i;r++)this.vertexNormals[r]=t.vertexNormals[r].clone();for(r=0,i=t.vertexColors.length;r<i;r++)this.vertexColors[r]=t.vertexColors[r].clone();return this}});var it=0;kr.prototype=ut(at(se.prototype),{constructor:kr,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(t!==void 0)for(var r in t){var i=t[r];if(i===void 0)console.warn("THREE.Material: '"+r+"' parameter is undefined.");else if(r==="shading")console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=i===1;else{var s=this[r];s===void 0?console.warn("THREE."+this.type+": '"+r+"' is not a property of this material."):s&&s.isColor?s.set(i):s&&s.isVector3&&i&&i.isVector3?s.copy(i):this[r]=i}}},toJSON:function(t){function r(f){var c=[],g;for(g in f){var p=f[g];delete p.metadata,c.push(p)}return c}var i=t===void 0||typeof t=="string";i&&(t={textures:{},images:{}});var s={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};return s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.color&&this.color.isColor&&(s.color=this.color.getHex()),this.roughness!==void 0&&(s.roughness=this.roughness),this.metalness!==void 0&&(s.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(s.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(s.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(s.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(s.specular=this.specular.getHex()),this.shininess!==void 0&&(s.shininess=this.shininess),this.clearcoat!==void 0&&(s.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(s.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(s.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(s.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,s.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(s.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(s.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(s.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(s.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(s.aoMap=this.aoMap.toJSON(t).uuid,s.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(s.bumpMap=this.bumpMap.toJSON(t).uuid,s.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(s.normalMap=this.normalMap.toJSON(t).uuid,s.normalMapType=this.normalMapType,s.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(s.displacementMap=this.displacementMap.toJSON(t).uuid,s.displacementScale=this.displacementScale,s.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(s.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(s.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(s.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(s.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(s.envMap=this.envMap.toJSON(t).uuid,s.reflectivity=this.reflectivity,s.refractionRatio=this.refractionRatio,this.combine!==void 0&&(s.combine=this.combine),this.envMapIntensity!==void 0&&(s.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(s.gradientMap=this.gradientMap.toJSON(t).uuid),this.size!==void 0&&(s.size=this.size),this.sizeAttenuation!==void 0&&(s.sizeAttenuation=this.sizeAttenuation),this.blending!==1&&(s.blending=this.blending),this.flatShading===!0&&(s.flatShading=this.flatShading),this.side!==0&&(s.side=this.side),this.vertexColors&&(s.vertexColors=!0),1>this.opacity&&(s.opacity=this.opacity),this.transparent===!0&&(s.transparent=this.transparent),s.depthFunc=this.depthFunc,s.depthTest=this.depthTest,s.depthWrite=this.depthWrite,s.stencilWrite=this.stencilWrite,s.stencilWriteMask=this.stencilWriteMask,s.stencilFunc=this.stencilFunc,s.stencilRef=this.stencilRef,s.stencilFuncMask=this.stencilFuncMask,s.stencilFail=this.stencilFail,s.stencilZFail=this.stencilZFail,s.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(s.rotation=this.rotation),this.polygonOffset===!0&&(s.polygonOffset=!0),this.polygonOffsetFactor!==0&&(s.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(s.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(s.linewidth=this.linewidth),this.dashSize!==void 0&&(s.dashSize=this.dashSize),this.gapSize!==void 0&&(s.gapSize=this.gapSize),this.scale!==void 0&&(s.scale=this.scale),this.dithering===!0&&(s.dithering=!0),0<this.alphaTest&&(s.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(s.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(s.wireframe=this.wireframe),1<this.wireframeLinewidth&&(s.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(s.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(s.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(s.morphTargets=!0),this.morphNormals===!0&&(s.morphNormals=!0),this.skinning===!0&&(s.skinning=!0),this.visible===!1&&(s.visible=!1),this.toneMapped===!1&&(s.toneMapped=!1),ls(this.userData)!=="{}"&&(s.userData=this.userData),i&&(i=r(t.textures),t=r(t.images),0<i.length&&(s.textures=i),0<t.length&&(s.images=t)),s},clone:function(){return new this.constructor().copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var r=t.clippingPlanes,i=null;if(r!==null){var s=r.length;i=Array(s);for(var f=0;f!==s;++f)i[f]=r[f].clone()}return this.clippingPlanes=i,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(ls(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(kr.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}}),ro.prototype=at(kr.prototype),ro.prototype.constructor=ro,ro.prototype.isMeshBasicMaterial=!0,ro.prototype.copy=function(t){return kr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this};var nt=new lt;Object.defineProperty(Ir.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}}),ut(Ir.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,r,i){t*=this.itemSize,i*=r.itemSize;for(var s=0,f=this.itemSize;s<f;s++)this.array[t+s]=r.array[i+s];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var r=this.array,i=0,s=0,f=t.length;s<f;s++){var c=t[s];c===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",s),c=new Ue),r[i++]=c.r,r[i++]=c.g,r[i++]=c.b}return this},copyVector2sArray:function(t){for(var r=this.array,i=0,s=0,f=t.length;s<f;s++){var c=t[s];c===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",s),c=new st),r[i++]=c.x,r[i++]=c.y}return this},copyVector3sArray:function(t){for(var r=this.array,i=0,s=0,f=t.length;s<f;s++){var c=t[s];c===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",s),c=new lt),r[i++]=c.x,r[i++]=c.y,r[i++]=c.z}return this},copyVector4sArray:function(t){for(var r=this.array,i=0,s=0,f=t.length;s<f;s++){var c=t[s];c===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",s),c=new It),r[i++]=c.x,r[i++]=c.y,r[i++]=c.z,r[i++]=c.w}return this},applyMatrix3:function(t){for(var r=0,i=this.count;r<i;r++)nt.x=this.getX(r),nt.y=this.getY(r),nt.z=this.getZ(r),nt.applyMatrix3(t),this.setXYZ(r,nt.x,nt.y,nt.z);return this},applyMatrix4:function(t){for(var r=0,i=this.count;r<i;r++)nt.x=this.getX(r),nt.y=this.getY(r),nt.z=this.getZ(r),nt.applyMatrix4(t),this.setXYZ(r,nt.x,nt.y,nt.z);return this},applyNormalMatrix:function(t){for(var r=0,i=this.count;r<i;r++)nt.x=this.getX(r),nt.y=this.getY(r),nt.z=this.getZ(r),nt.applyNormalMatrix(t),this.setXYZ(r,nt.x,nt.y,nt.z);return this},transformDirection:function(t){for(var r=0,i=this.count;r<i;r++)nt.x=this.getX(r),nt.y=this.getY(r),nt.z=this.getZ(r),nt.transformDirection(t),this.setXYZ(r,nt.x,nt.y,nt.z);return this},set:function(t,r){return r===void 0&&(r=0),this.array.set(t,r),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,r){return this.array[t*this.itemSize]=r,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,r){return this.array[t*this.itemSize+1]=r,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,r){return this.array[t*this.itemSize+2]=r,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,r){return this.array[t*this.itemSize+3]=r,this},setXY:function(t,r,i){return t*=this.itemSize,this.array[t+0]=r,this.array[t+1]=i,this},setXYZ:function(t,r,i,s){return t*=this.itemSize,this.array[t+0]=r,this.array[t+1]=i,this.array[t+2]=s,this},setXYZW:function(t,r,i,s,f){return t*=this.itemSize,this.array[t+0]=r,this.array[t+1]=i,this.array[t+2]=s,this.array[t+3]=f,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),rd.prototype=at(Ir.prototype),rd.prototype.constructor=rd,wu.prototype=at(Ir.prototype),wu.prototype.constructor=wu,ih.prototype=at(Ir.prototype),ih.prototype.constructor=ih,xf.prototype=at(Ir.prototype),xf.prototype.constructor=xf,Ta.prototype=at(Ir.prototype),Ta.prototype.constructor=Ta,sl.prototype=at(Ir.prototype),sl.prototype.constructor=sl,al.prototype=at(Ir.prototype),al.prototype.constructor=al,We.prototype=at(Ir.prototype),We.prototype.constructor=We,Bn.prototype=at(Ir.prototype),Bn.prototype.constructor=Bn,ut(rs.prototype,{computeGroups:function(t){var r=[],i=void 0;t=t.faces;for(var s=0;s<t.length;s++){var f=t[s];if(f.materialIndex!==i){i=f.materialIndex,c!==void 0&&(c.count=3*s-c.start,r.push(c));var c={start:3*s,materialIndex:i}}}c!==void 0&&(c.count=3*s-c.start,r.push(c)),this.groups=r},fromGeometry:function(t){var r=t.faces,i=t.vertices,s=t.faceVertexUvs,f=s[0]&&0<s[0].length,c=s[1]&&0<s[1].length,g=t.morphTargets,p=g.length;if(0<p){for(var A=[],S=0;S<p;S++)A[S]={name:g[S].name,data:[]};this.morphTargets.position=A}var N=t.morphNormals,_=N.length;if(0<_){var I=[];for(S=0;S<_;S++)I[S]={name:N[S].name,data:[]};this.morphTargets.normal=I}var L=t.skinIndices,P=t.skinWeights,F=L.length===i.length,W=P.length===i.length;for(0<i.length&&r.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported."),S=0;S<r.length;S++){var X=r[S];this.vertices.push(i[X.a],i[X.b],i[X.c]);var Z=X.vertexNormals;for(Z.length===3?this.normals.push(Z[0],Z[1],Z[2]):(Z=X.normal,this.normals.push(Z,Z,Z)),Z=X.vertexColors,Z.length===3?this.colors.push(Z[0],Z[1],Z[2]):(Z=X.color,this.colors.push(Z,Z,Z)),f===!0&&(Z=s[0][S],Z!==void 0?this.uvs.push(Z[0],Z[1],Z[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",S),this.uvs.push(new st,new st,new st))),c===!0&&(Z=s[1][S],Z!==void 0?this.uvs2.push(Z[0],Z[1],Z[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",S),this.uvs2.push(new st,new st,new st))),Z=0;Z<p;Z++){var tt=g[Z].vertices;A[Z].data.push(tt[X.a],tt[X.b],tt[X.c])}for(Z=0;Z<_;Z++)tt=N[Z].vertexNormals[S],I[Z].data.push(tt.a,tt.b,tt.c);F&&this.skinIndices.push(L[X.a],L[X.b],L[X.c]),W&&this.skinWeights.push(P[X.a],P[X.b],P[X.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),this}});var dt=1,Et=new ye,St=new Ce,Xt=new lt,te=new Ai,Ie=new Ai,pe=new lt;Ge.prototype=ut(at(se.prototype),{constructor:Ge,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(65535<Af(t)?al:Ta)(t,1):this.index=t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,r){return this.attributes[t]=r,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,r,i){this.groups.push({start:t,count:r,materialIndex:i!==void 0?i:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,r){this.drawRange.start=t,this.drawRange.count=r},applyMatrix4:function(t){var r=this.attributes.position;if(r!==void 0&&(r.applyMatrix4(t),r.needsUpdate=!0),r=this.attributes.normal,r!==void 0){var i=new Ft().getNormalMatrix(t);r.applyNormalMatrix(i),r.needsUpdate=!0}return r=this.attributes.tangent,r!==void 0&&(r.transformDirection(t),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(t){return Et.makeRotationX(t),this.applyMatrix4(Et),this},rotateY:function(t){return Et.makeRotationY(t),this.applyMatrix4(Et),this},rotateZ:function(t){return Et.makeRotationZ(t),this.applyMatrix4(Et),this},translate:function(t,r,i){return Et.makeTranslation(t,r,i),this.applyMatrix4(Et),this},scale:function(t,r,i){return Et.makeScale(t,r,i),this.applyMatrix4(Et),this},lookAt:function(t){return St.lookAt(t),St.updateMatrix(),this.applyMatrix4(St.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Xt).negate(),this.translate(Xt.x,Xt.y,Xt.z),this},setFromObject:function(t){var r=t.geometry;if(t.isPoints||t.isLine){t=new We(3*r.vertices.length,3);var i=new We(3*r.colors.length,3);this.setAttribute("position",t.copyVector3sArray(r.vertices)),this.setAttribute("color",i.copyColorsArray(r.colors)),r.lineDistances&&r.lineDistances.length===r.vertices.length&&(t=new We(r.lineDistances.length,1),this.setAttribute("lineDistance",t.copyArray(r.lineDistances))),r.boundingSphere!==null&&(this.boundingSphere=r.boundingSphere.clone()),r.boundingBox!==null&&(this.boundingBox=r.boundingBox.clone())}else t.isMesh&&r&&r.isGeometry&&this.fromGeometry(r);return this},setFromPoints:function(t){for(var r=[],i=0,s=t.length;i<s;i++){var f=t[i];r.push(f.x,f.y,f.z||0)}return this.setAttribute("position",new We(r,3)),this},updateFromObject:function(t){var r=t.geometry;if(t.isMesh){var i=r.__directGeometry;if(r.elementsNeedUpdate===!0&&(i=void 0,r.elementsNeedUpdate=!1),i===void 0)return this.fromGeometry(r);i.verticesNeedUpdate=r.verticesNeedUpdate,i.normalsNeedUpdate=r.normalsNeedUpdate,i.colorsNeedUpdate=r.colorsNeedUpdate,i.uvsNeedUpdate=r.uvsNeedUpdate,i.groupsNeedUpdate=r.groupsNeedUpdate,r.verticesNeedUpdate=!1,r.normalsNeedUpdate=!1,r.colorsNeedUpdate=!1,r.uvsNeedUpdate=!1,r.groupsNeedUpdate=!1,r=i}return r.verticesNeedUpdate===!0&&(i=this.attributes.position,i!==void 0&&(i.copyVector3sArray(r.vertices),i.needsUpdate=!0),r.verticesNeedUpdate=!1),r.normalsNeedUpdate===!0&&(i=this.attributes.normal,i!==void 0&&(i.copyVector3sArray(r.normals),i.needsUpdate=!0),r.normalsNeedUpdate=!1),r.colorsNeedUpdate===!0&&(i=this.attributes.color,i!==void 0&&(i.copyColorsArray(r.colors),i.needsUpdate=!0),r.colorsNeedUpdate=!1),r.uvsNeedUpdate&&(i=this.attributes.uv,i!==void 0&&(i.copyVector2sArray(r.uvs),i.needsUpdate=!0),r.uvsNeedUpdate=!1),r.lineDistancesNeedUpdate&&(i=this.attributes.lineDistance,i!==void 0&&(i.copyArray(r.lineDistances),i.needsUpdate=!0),r.lineDistancesNeedUpdate=!1),r.groupsNeedUpdate&&(r.computeGroups(t.geometry),this.groups=r.groups,r.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=new rs().fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var r=new Float32Array(3*t.vertices.length);this.setAttribute("position",new Ir(r,3).copyVector3sArray(t.vertices)),0<t.normals.length&&(r=new Float32Array(3*t.normals.length),this.setAttribute("normal",new Ir(r,3).copyVector3sArray(t.normals))),0<t.colors.length&&(r=new Float32Array(3*t.colors.length),this.setAttribute("color",new Ir(r,3).copyColorsArray(t.colors))),0<t.uvs.length&&(r=new Float32Array(2*t.uvs.length),this.setAttribute("uv",new Ir(r,2).copyVector2sArray(t.uvs))),0<t.uvs2.length&&(r=new Float32Array(2*t.uvs2.length),this.setAttribute("uv2",new Ir(r,2).copyVector2sArray(t.uvs2))),this.groups=t.groups;for(var i in t.morphTargets){r=[];for(var s=t.morphTargets[i],f=0,c=s.length;f<c;f++){var g=s[f],p=new We(3*g.data.length,3);p.name=g.name,r.push(p.copyVector3sArray(g.data))}this.morphAttributes[i]=r}return 0<t.skinIndices.length&&(i=new We(4*t.skinIndices.length,4),this.setAttribute("skinIndex",i.copyVector4sArray(t.skinIndices))),0<t.skinWeights.length&&(i=new We(4*t.skinWeights.length,4),this.setAttribute("skinWeight",i.copyVector4sArray(t.skinWeights))),t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new Ai);var t=this.attributes.position,r=this.morphAttributes.position;if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),r){t=0;for(var i=r.length;t<i;t++)te.setFromBufferAttribute(r[t]),this.morphTargetsRelative?(pe.addVectors(this.boundingBox.min,te.min),this.boundingBox.expandByPoint(pe),pe.addVectors(this.boundingBox.max,te.max),this.boundingBox.expandByPoint(pe)):(this.boundingBox.expandByPoint(te.min),this.boundingBox.expandByPoint(te.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new Fn);var t=this.attributes.position,r=this.morphAttributes.position;if(t){var i=this.boundingSphere.center;if(te.setFromBufferAttribute(t),r)for(var s=0,f=r.length;s<f;s++){var c=r[s];Ie.setFromBufferAttribute(c),this.morphTargetsRelative?(pe.addVectors(te.min,Ie.min),te.expandByPoint(pe),pe.addVectors(te.max,Ie.max),te.expandByPoint(pe)):(te.expandByPoint(Ie.min),te.expandByPoint(Ie.max))}te.getCenter(i);var g=0;for(s=0,f=t.count;s<f;s++)pe.fromBufferAttribute(t,s),g=Math.max(g,i.distanceToSquared(pe));if(r)for(s=0,f=r.length;s<f;s++){c=r[s];for(var p=this.morphTargetsRelative,A=0,S=c.count;A<S;A++)pe.fromBufferAttribute(c,A),p&&(Xt.fromBufferAttribute(t,A),pe.add(Xt)),g=Math.max(g,i.distanceToSquared(pe))}this.boundingSphere.radius=Math.sqrt(g),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,r=this.attributes;if(r.position){var i=r.position.array;if(r.normal===void 0)this.setAttribute("normal",new Ir(new Float32Array(i.length),3));else for(var s=r.normal.array,f=0,c=s.length;f<c;f++)s[f]=0;s=r.normal.array;var g=new lt,p=new lt,A=new lt,S=new lt,N=new lt;if(t){var _=t.array;for(f=0,c=t.count;f<c;f+=3){t=3*_[f+0];var I=3*_[f+1],L=3*_[f+2];g.fromArray(i,t),p.fromArray(i,I),A.fromArray(i,L),S.subVectors(A,p),N.subVectors(g,p),S.cross(N),s[t]+=S.x,s[t+1]+=S.y,s[t+2]+=S.z,s[I]+=S.x,s[I+1]+=S.y,s[I+2]+=S.z,s[L]+=S.x,s[L+1]+=S.y,s[L+2]+=S.z}}else for(f=0,c=i.length;f<c;f+=9)g.fromArray(i,f),p.fromArray(i,f+3),A.fromArray(i,f+6),S.subVectors(A,p),N.subVectors(g,p),S.cross(N),s[f]=S.x,s[f+1]=S.y,s[f+2]=S.z,s[f+3]=S.x,s[f+4]=S.y,s[f+5]=S.z,s[f+6]=S.x,s[f+7]=S.y,s[f+8]=S.z;this.normalizeNormals(),r.normal.needsUpdate=!0}},merge:function(t,r){if(t&&t.isBufferGeometry){r===void 0&&(r=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var i=this.attributes,s;for(s in i)if(t.attributes[s]!==void 0){var f=i[s].array,c=t.attributes[s],g=c.array,p=c.itemSize*r;c=Math.min(g.length,f.length-p);for(var A=0;A<c;A++,p++)f[p]=g[A]}return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){for(var t=this.attributes.normal,r=0,i=t.count;r<i;r++)pe.x=t.getX(r),pe.y=t.getY(r),pe.z=t.getZ(r),pe.normalize(),t.setXYZ(r,pe.x,pe.y,pe.z)},toNonIndexed:function(){function t(N,_){var I=N.array,L=N.itemSize;N=N.normalized;for(var P=new I.constructor(_.length*L),F,W=0,X=0,Z=_.length;X<Z;X++){F=_[X]*L;for(var tt=0;tt<L;tt++)P[W++]=I[F++]}return new Ir(P,L,N)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var r=new Ge,i=this.index.array,s=this.attributes,f;for(f in s){var c=s[f];c=t(c,i),r.setAttribute(f,c)}var g=this.morphAttributes;for(f in g){var p=[],A=g[f];s=0;for(var S=A.length;s<S;s++)c=A[s],c=t(c,i),p.push(c);r.morphAttributes[f]=p}for(r.morphTargetsRelative=this.morphTargetsRelative,i=this.groups,s=0,f=i.length;s<f;s++)c=i[s],r.addGroup(c.start,c.count,c.materialIndex);return r},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),0<qi(this.userData).length&&(t.userData=this.userData),this.parameters!==void 0){var r=this.parameters;for(S in r)r[S]!==void 0&&(t[S]=r[S]);return t}t.data={attributes:{}},r=this.index,r!==null&&(t.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(S in i){r=i[S];var s=r.toJSON();r.name!==""&&(s.name=r.name),t.data.attributes[S]=s}i={};var f=!1;for(S in this.morphAttributes){for(var c=this.morphAttributes[S],g=[],p=0,A=c.length;p<A;p++)r=c[p],s=r.toJSON(),r.name!==""&&(s.name=r.name),g.push(s);0<g.length&&(i[S]=g,f=!0)}f&&(t.data.morphAttributes=i,t.data.morphTargetsRelative=this.morphTargetsRelative);var S=this.groups;return 0<S.length&&(t.data.groups=JSON.parse(ls(S))),S=this.boundingSphere,S!==null&&(t.data.boundingSphere={center:S.center.toArray(),radius:S.radius}),t},clone:function(){return new Ge().copy(this)},copy:function(t){var r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.name=t.name;var i=t.index;i!==null&&this.setIndex(i.clone()),i=t.attributes;for(g in i)this.setAttribute(g,i[g].clone());var s=t.morphAttributes;for(g in s){var f=[],c=s[g];for(i=0,r=c.length;i<r;i++)f.push(c[i].clone());this.morphAttributes[g]=f}this.morphTargetsRelative=t.morphTargetsRelative;var g=t.groups;for(i=0,r=g.length;i<r;i++)s=g[i],this.addGroup(s.start,s.count,s.materialIndex);return g=t.boundingBox,g!==null&&(this.boundingBox=g.clone()),g=t.boundingSphere,g!==null&&(this.boundingSphere=g.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var be=new ye,yr=new xo,oe=new Fn,Be=new lt,wr=new lt,_r=new lt,ke=new lt,Os=new lt,wn=new lt,_n=new lt,jc=new lt,Xn=new lt,bl=new st,Xc=new st,pu=new st,Ev=new lt,Q1=new lt;dn.prototype=ut(at(Ce.prototype),{constructor:dn,isMesh:!0,copy:function(t){return Ce.prototype.copy.call(this,t),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=ut({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){t=t.morphAttributes;var r=qi(t);if(0<r.length){var i=t[r[0]];if(i!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,r=i.length;t<r;t++){var s=i[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=t}}}else t=t.morphTargets,t!==void 0&&0<t.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},raycast:function(t,r){var i=this.geometry,s=this.material,f=this.matrixWorld;if(s!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),oe.copy(i.boundingSphere),oe.applyMatrix4(f),t.ray.intersectsSphere(oe)!==!1&&(be.getInverse(f),yr.copy(t.ray).applyMatrix4(be),i.boundingBox===null||yr.intersectsBox(i.boundingBox)!==!1))){if(i.isBufferGeometry){var c=i.index;f=i.attributes.position;var g=i.morphAttributes.position,p=i.morphTargetsRelative,A=i.attributes.uv,S=i.attributes.uv2,N=i.groups,_=i.drawRange,I,L;if(c!==null)if(Array.isArray(s)){var P=0;for(I=N.length;P<I;P++){var F=N[P],W=s[F.materialIndex],X=Math.max(F.start,_.start);for(L=i=Math.min(F.start+F.count,_.start+_.count);X<L;X+=3){i=c.getX(X);var Z=c.getX(X+1),tt=c.getX(X+2);(i=Fr(this,W,t,yr,f,g,p,A,S,i,Z,tt))&&(i.faceIndex=Math.floor(X/3),i.face.materialIndex=F.materialIndex,r.push(i))}}}else for(X=Math.max(0,_.start),i=Math.min(c.count,_.start+_.count),P=X,I=i;P<I;P+=3)i=c.getX(P),Z=c.getX(P+1),tt=c.getX(P+2),(i=Fr(this,s,t,yr,f,g,p,A,S,i,Z,tt))&&(i.faceIndex=Math.floor(P/3),r.push(i));else if(f!==void 0)if(Array.isArray(s))for(P=0,I=N.length;P<I;P++)for(F=N[P],W=s[F.materialIndex],X=Math.max(F.start,_.start),L=i=Math.min(F.start+F.count,_.start+_.count);X<L;X+=3)i=X,Z=X+1,tt=X+2,(i=Fr(this,W,t,yr,f,g,p,A,S,i,Z,tt))&&(i.faceIndex=Math.floor(X/3),i.face.materialIndex=F.materialIndex,r.push(i));else for(X=Math.max(0,_.start),i=Math.min(f.count,_.start+_.count),P=X,I=i;P<I;P+=3)i=P,Z=P+1,tt=P+2,(i=Fr(this,s,t,yr,f,g,p,A,S,i,Z,tt))&&(i.faceIndex=Math.floor(P/3),r.push(i))}else if(i.isGeometry)for(f=Array.isArray(s),g=i.vertices,p=i.faces,i=i.faceVertexUvs[0],0<i.length&&(c=i),_=0,P=p.length;_<P;_++)I=p[_],i=f?s[I.materialIndex]:s,i!==void 0&&(A=g[I.a],S=g[I.b],N=g[I.c],i=ne(this,i,t,yr,A,S,N,Ev))&&(c&&c[_]&&(F=c[_],bl.copy(F[0]),Xc.copy(F[1]),pu.copy(F[2]),i.uv=Xi.getUV(Ev,A,S,N,bl,Xc,pu,new st)),i.face=I,i.faceIndex=_,r.push(i))}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var nC=0,Vl=new ye,zA=new Ce,$1=new lt;Le.prototype=ut(at(se.prototype),{constructor:Le,isGeometry:!0,applyMatrix4:function(t){for(var r=new Ft().getNormalMatrix(t),i=0,s=this.vertices.length;i<s;i++)this.vertices[i].applyMatrix4(t);for(i=0,s=this.faces.length;i<s;i++){t=this.faces[i],t.normal.applyMatrix3(r).normalize();for(var f=0,c=t.vertexNormals.length;f<c;f++)t.vertexNormals[f].applyMatrix3(r).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.normalsNeedUpdate=this.verticesNeedUpdate=!0,this},rotateX:function(t){return Vl.makeRotationX(t),this.applyMatrix4(Vl),this},rotateY:function(t){return Vl.makeRotationY(t),this.applyMatrix4(Vl),this},rotateZ:function(t){return Vl.makeRotationZ(t),this.applyMatrix4(Vl),this},translate:function(t,r,i){return Vl.makeTranslation(t,r,i),this.applyMatrix4(Vl),this},scale:function(t,r,i){return Vl.makeScale(t,r,i),this.applyMatrix4(Vl),this},lookAt:function(t){return zA.lookAt(t),zA.updateMatrix(),this.applyMatrix4(zA.matrix),this},fromBufferGeometry:function(t){function r(L,P,F,W){var X=p===void 0?[]:[i.colors[L].clone(),i.colors[P].clone(),i.colors[F].clone()],Z=g===void 0?[]:[new lt().fromArray(g,3*L),new lt().fromArray(g,3*P),new lt().fromArray(g,3*F)];W=new Ca(L,P,F,Z,X,W),i.faces.push(W),A!==void 0&&i.faceVertexUvs[0].push([new st().fromArray(A,2*L),new st().fromArray(A,2*P),new st().fromArray(A,2*F)]),S!==void 0&&i.faceVertexUvs[1].push([new st().fromArray(S,2*L),new st().fromArray(S,2*P),new st().fromArray(S,2*F)])}var i=this,s=t.index!==null?t.index.array:void 0,f=t.attributes;if(f.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var c=f.position.array,g=f.normal!==void 0?f.normal.array:void 0,p=f.color!==void 0?f.color.array:void 0,A=f.uv!==void 0?f.uv.array:void 0,S=f.uv2!==void 0?f.uv2.array:void 0;for(S!==void 0&&(this.faceVertexUvs[1]=[]),f=0;f<c.length;f+=3)i.vertices.push(new lt().fromArray(c,f)),p!==void 0&&i.colors.push(new Ue().fromArray(p,f));var N=t.groups;if(0<N.length)for(f=0;f<N.length;f++){c=N[f];var _=c.start,I=_;for(_+=c.count;I<_;I+=3)s!==void 0?r(s[I],s[I+1],s[I+2],c.materialIndex):r(I,I+1,I+2,c.materialIndex)}else if(s!==void 0)for(f=0;f<s.length;f+=3)r(s[f],s[f+1],s[f+2]);else for(f=0;f<c.length/3;f+=3)r(f,f+1,f+2);return this.computeFaceNormals(),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter($1).negate(),this.translate($1.x,$1.y,$1.z),this},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,r=this.boundingSphere.radius;r=r===0?1:1/r;var i=new ye;return i.set(r,0,0,-r*t.x,0,r,0,-r*t.y,0,0,r,-r*t.z,0,0,0,1),this.applyMatrix4(i),this},computeFaceNormals:function(){for(var t=new lt,r=new lt,i=0,s=this.faces.length;i<s;i++){var f=this.faces[i],c=this.vertices[f.a],g=this.vertices[f.b];t.subVectors(this.vertices[f.c],g),r.subVectors(c,g),t.cross(r),t.normalize(),f.normal.copy(t)}},computeVertexNormals:function(t){t===void 0&&(t=!0);var r,i=Array(this.vertices.length),s=0;for(r=this.vertices.length;s<r;s++)i[s]=new lt;if(t){var f=new lt,c=new lt;for(t=0,s=this.faces.length;t<s;t++){r=this.faces[t];var g=this.vertices[r.a],p=this.vertices[r.b],A=this.vertices[r.c];f.subVectors(A,p),c.subVectors(g,p),f.cross(c),i[r.a].add(f),i[r.b].add(f),i[r.c].add(f)}}else for(this.computeFaceNormals(),t=0,s=this.faces.length;t<s;t++)r=this.faces[t],i[r.a].add(r.normal),i[r.b].add(r.normal),i[r.c].add(r.normal);for(s=0,r=this.vertices.length;s<r;s++)i[s].normalize();for(t=0,s=this.faces.length;t<s;t++)r=this.faces[t],g=r.vertexNormals,g.length===3?(g[0].copy(i[r.a]),g[1].copy(i[r.b]),g[2].copy(i[r.c])):(g[0]=i[r.a].clone(),g[1]=i[r.b].clone(),g[2]=i[r.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t;this.computeFaceNormals();var r=0;for(t=this.faces.length;r<t;r++){var i=this.faces[r],s=i.vertexNormals;s.length===3?(s[0].copy(i.normal),s[1].copy(i.normal),s[2].copy(i.normal)):(s[0]=i.normal.clone(),s[1]=i.normal.clone(),s[2]=i.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,r,i=0;for(r=this.faces.length;i<r;i++){var s=this.faces[i];s.__originalFaceNormal?s.__originalFaceNormal.copy(s.normal):s.__originalFaceNormal=s.normal.clone(),s.__originalVertexNormals||(s.__originalVertexNormals=[]);var f=0;for(t=s.vertexNormals.length;f<t;f++)s.__originalVertexNormals[f]?s.__originalVertexNormals[f].copy(s.vertexNormals[f]):s.__originalVertexNormals[f]=s.vertexNormals[f].clone()}var c=new Le;for(c.faces=this.faces,f=0,t=this.morphTargets.length;f<t;f++){if(!this.morphNormals[f]){this.morphNormals[f]={},this.morphNormals[f].faceNormals=[],this.morphNormals[f].vertexNormals=[],s=this.morphNormals[f].faceNormals;var g=this.morphNormals[f].vertexNormals;for(i=0,r=this.faces.length;i<r;i++){var p=new lt,A={a:new lt,b:new lt,c:new lt};s.push(p),g.push(A)}}for(g=this.morphNormals[f],c.vertices=this.morphTargets[f].vertices,c.computeFaceNormals(),c.computeVertexNormals(),i=0,r=this.faces.length;i<r;i++)s=this.faces[i],p=g.faceNormals[i],A=g.vertexNormals[i],p.copy(s.normal),A.a.copy(s.vertexNormals[0]),A.b.copy(s.vertexNormals[1]),A.c.copy(s.vertexNormals[2])}for(i=0,r=this.faces.length;i<r;i++)s=this.faces[i],s.normal=s.__originalFaceNormal,s.vertexNormals=s.__originalVertexNormals},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new Ai),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new Fn),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,r,i){if(t&&t.isGeometry){var s,f=this.vertices.length,c=this.vertices,g=t.vertices,p=this.faces,A=t.faces,S=this.colors,N=t.colors;i===void 0&&(i=0),r!==void 0&&(s=new Ft().getNormalMatrix(r));for(var _=0,I=g.length;_<I;_++){var L=g[_].clone();r!==void 0&&L.applyMatrix4(r),c.push(L)}for(_=0,I=N.length;_<I;_++)S.push(N[_].clone());for(_=0,I=A.length;_<I;_++){g=A[_];var P=g.vertexNormals;for(N=g.vertexColors,S=new Ca(g.a+f,g.b+f,g.c+f),S.normal.copy(g.normal),s!==void 0&&S.normal.applyMatrix3(s).normalize(),r=0,c=P.length;r<c;r++)L=P[r].clone(),s!==void 0&&L.applyMatrix3(s).normalize(),S.vertexNormals.push(L);for(S.color.copy(g.color),r=0,c=N.length;r<c;r++)L=N[r],S.vertexColors.push(L.clone());S.materialIndex=g.materialIndex+i,p.push(S)}for(_=0,I=t.faceVertexUvs.length;_<I;_++)for(i=t.faceVertexUvs[_],this.faceVertexUvs[_]===void 0&&(this.faceVertexUvs[_]=[]),r=0,c=i.length;r<c;r++){for(s=i[r],f=[],p=0,A=s.length;p<A;p++)f.push(s[p].clone());this.faceVertexUvs[_].push(f)}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){var t={},r=[],i=[],s=Math.pow(10,4),f,c=0;for(f=this.vertices.length;c<f;c++){var g=this.vertices[c];g=Math.round(g.x*s)+"_"+Math.round(g.y*s)+"_"+Math.round(g.z*s),t[g]===void 0?(t[g]=c,r.push(this.vertices[c]),i[c]=r.length-1):i[c]=i[t[g]]}for(t=[],c=0,f=this.faces.length;c<f;c++)for(s=this.faces[c],s.a=i[s.a],s.b=i[s.b],s.c=i[s.c],s=[s.a,s.b,s.c],g=0;3>g;g++)if(s[g]===s[(g+1)%3]){t.push(c);break}for(c=t.length-1;0<=c;c--)for(s=t[c],this.faces.splice(s,1),i=0,f=this.faceVertexUvs.length;i<f;i++)this.faceVertexUvs[i].splice(s,1);return c=this.vertices.length-r.length,this.vertices=r,c},setFromPoints:function(t){this.vertices=[];for(var r=0,i=t.length;r<i;r++){var s=t[r];this.vertices.push(new lt(s.x,s.y,s.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,r=t.length,i=0;i<r;i++)t[i]._id=i;t.sort(function(A,S){return A.materialIndex-S.materialIndex});var s=this.faceVertexUvs[0],f=this.faceVertexUvs[1],c,g;for(s&&s.length===r&&(c=[]),f&&f.length===r&&(g=[]),i=0;i<r;i++){var p=t[i]._id;c&&c.push(s[p]),g&&g.push(f[p])}c&&(this.faceVertexUvs[0]=c),g&&(this.faceVertexUvs[1]=g)},toJSON:function(){function t(xt,At,yt){return yt?xt|1<<At:xt&~(1<<At)}function r(xt){var At=xt.x.toString()+xt.y.toString()+xt.z.toString();return S[At]!==void 0||(S[At]=A.length/3,A.push(xt.x,xt.y,xt.z)),S[At]}function i(xt){var At=xt.r.toString()+xt.g.toString()+xt.b.toString();return _[At]!==void 0||(_[At]=N.length,N.push(xt.getHex())),_[At]}function s(xt){var At=xt.x.toString()+xt.y.toString();return L[At]!==void 0||(L[At]=I.length/2,I.push(xt.x,xt.y)),L[At]}var f={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(f.uuid=this.uuid,f.type=this.type,this.name!==""&&(f.name=this.name),this.parameters!==void 0){var c=this.parameters,g;for(g in c)c[g]!==void 0&&(f[g]=c[g]);return f}for(c=[],g=0;g<this.vertices.length;g++){var p=this.vertices[g];c.push(p.x,p.y,p.z)}p=[];var A=[],S={},N=[],_={},I=[],L={};for(g=0;g<this.faces.length;g++){var P=this.faces[g],F=this.faceVertexUvs[0][g]!==void 0,W=0<P.normal.length(),X=0<P.vertexNormals.length,Z=P.color.r!==1||P.color.g!==1||P.color.b!==1,tt=0<P.vertexColors.length,ot=0;ot=t(ot,0,0),ot=t(ot,1,!0),ot=t(ot,2,!1),ot=t(ot,3,F),ot=t(ot,4,W),ot=t(ot,5,X),ot=t(ot,6,Z),ot=t(ot,7,tt),p.push(ot),p.push(P.a,P.b,P.c),p.push(P.materialIndex),F&&(F=this.faceVertexUvs[0][g],p.push(s(F[0]),s(F[1]),s(F[2]))),W&&p.push(r(P.normal)),X&&(W=P.vertexNormals,p.push(r(W[0]),r(W[1]),r(W[2]))),Z&&p.push(i(P.color)),tt&&(P=P.vertexColors,p.push(i(P[0]),i(P[1]),i(P[2])))}return f.data={},f.data.vertices=c,f.data.normals=A,0<N.length&&(f.data.colors=N),0<I.length&&(f.data.uvs=[I]),f.data.faces=p,f},clone:function(){return new Le().copy(this)},copy:function(t){var r,i,s;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.name=t.name;var f=t.vertices,c=0;for(r=f.length;c<r;c++)this.vertices.push(f[c].clone());for(f=t.colors,c=0,r=f.length;c<r;c++)this.colors.push(f[c].clone());for(f=t.faces,c=0,r=f.length;c<r;c++)this.faces.push(f[c].clone());for(c=0,r=t.faceVertexUvs.length;c<r;c++){var g=t.faceVertexUvs[c];for(this.faceVertexUvs[c]===void 0&&(this.faceVertexUvs[c]=[]),f=0,i=g.length;f<i;f++){var p=g[f],A=[],S=0;for(s=p.length;S<s;S++)A.push(p[S].clone());this.faceVertexUvs[c].push(A)}}for(S=t.morphTargets,c=0,r=S.length;c<r;c++){if(s={},s.name=S[c].name,S[c].vertices!==void 0)for(s.vertices=[],f=0,i=S[c].vertices.length;f<i;f++)s.vertices.push(S[c].vertices[f].clone());if(S[c].normals!==void 0)for(s.normals=[],f=0,i=S[c].normals.length;f<i;f++)s.normals.push(S[c].normals[f].clone());this.morphTargets.push(s)}for(S=t.morphNormals,c=0,r=S.length;c<r;c++){if(s={},S[c].vertexNormals!==void 0)for(s.vertexNormals=[],f=0,i=S[c].vertexNormals.length;f<i;f++)g=S[c].vertexNormals[f],p={},p.a=g.a.clone(),p.b=g.b.clone(),p.c=g.c.clone(),s.vertexNormals.push(p);if(S[c].faceNormals!==void 0)for(s.faceNormals=[],f=0,i=S[c].faceNormals.length;f<i;f++)s.faceNormals.push(S[c].faceNormals[f].clone());this.morphNormals.push(s)}for(f=t.skinWeights,c=0,r=f.length;c<r;c++)this.skinWeights.push(f[c].clone());for(f=t.skinIndices,c=0,r=f.length;c<r;c++)this.skinIndices.push(f[c].clone());for(f=t.lineDistances,c=0,r=f.length;c<r;c++)this.lineDistances.push(f[c]);return c=t.boundingBox,c!==null&&(this.boundingBox=c.clone()),c=t.boundingSphere,c!==null&&(this.boundingSphere=c.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var oC=function(t){function r(i,s,f,c,g,p){Ji(this,r);var A=jn(this,(r.__proto__||Mo(r)).call(this));return A.type="BoxGeometry",A.parameters={width:i,height:s,depth:f,widthSegments:c,heightSegments:g,depthSegments:p},A.fromBufferGeometry(new ty(i,s,f,c,g,p)),A.mergeVertices(),A}return Co(r,t),r}(Le),ty=function(t){function r(i,s,f,c,g,p){function A(X,Z,tt,ot,xt,At,yt,zt,Ht,$t,Vt){var Kt=At/Ht,ze=yt/$t,ae=At/2,Qe=yt/2,gr=zt/2;yt=Ht+1;for(var ir=$t+1,gi=At=0,hr=new lt,gt=0;gt<ir;gt++)for(var mt=gt*ze-Qe,vt=0;vt<yt;vt++)hr[X]=(vt*Kt-ae)*ot,hr[Z]=mt*xt,hr[tt]=gr,I.push(hr.x,hr.y,hr.z),hr[X]=0,hr[Z]=0,hr[tt]=0<zt?1:-1,L.push(hr.x,hr.y,hr.z),P.push(vt/Ht),P.push(1-gt/$t),At+=1;for(X=0;X<$t;X++)for(Z=0;Z<Ht;Z++)tt=F+Z+yt*(X+1),ot=F+(Z+1)+yt*(X+1),xt=F+(Z+1)+yt*X,_.push(F+Z+yt*X,tt,xt),_.push(tt,ot,xt),gi+=6;N.addGroup(W,gi,Vt),W+=gi,F+=At}Ji(this,r);var S=jn(this,(r.__proto__||Mo(r)).call(this));S.type="BoxBufferGeometry",S.parameters={width:i,height:s,depth:f,widthSegments:c,heightSegments:g,depthSegments:p};var N=S;i=i||1,s=s||1,f=f||1,c=Math.floor(c)||1,g=Math.floor(g)||1,p=Math.floor(p)||1;var _=[],I=[],L=[],P=[],F=0,W=0;return A("z","y","x",-1,-1,f,s,i,p,g,0),A("z","y","x",1,-1,f,s,-i,p,g,1),A("x","z","y",1,1,i,f,s,c,p,2),A("x","z","y",1,-1,i,f,-s,c,p,3),A("x","y","z",1,-1,i,s,f,c,g,4),A("x","y","z",-1,-1,i,s,-f,c,g,5),S.setIndex(_),S.setAttribute("position",new We(I,3)),S.setAttribute("normal",new We(L,3)),S.setAttribute("uv",new We(P,2)),S}return Co(r,t),r}(Ge),xp={clone:Mr,merge:Xe};$e.prototype=at(kr.prototype),$e.prototype.constructor=$e,$e.prototype.isShaderMaterial=!0,$e.prototype.copy=function(t){return kr.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Mr(t.uniforms),this.defines=ut({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=ut({},t.extensions),this},$e.prototype.toJSON=function(t){var r=kr.prototype.toJSON.call(this,t);r.uniforms={};for(var i in this.uniforms){var s=this.uniforms[i].value;r.uniforms[i]=s&&s.isTexture?{type:"t",value:s.toJSON(t).uuid}:s&&s.isColor?{type:"c",value:s.getHex()}:s&&s.isVector2?{type:"v2",value:s.toArray()}:s&&s.isVector3?{type:"v3",value:s.toArray()}:s&&s.isVector4?{type:"v4",value:s.toArray()}:s&&s.isMatrix3?{type:"m3",value:s.toArray()}:s&&s.isMatrix4?{type:"m4",value:s.toArray()}:{value:s}}0<qi(this.defines).length&&(r.defines=this.defines),r.vertexShader=this.vertexShader,r.fragmentShader=this.fragmentShader,t={};for(var f in this.extensions)this.extensions[f]===!0&&(t[f]=!0);return 0<qi(t).length&&(r.extensions=t),r},Gr.prototype=ut(at(Ce.prototype),{constructor:Gr,isCamera:!0,copy:function(t,r){return Ce.prototype.copy.call(this,t,r),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){t===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new lt),this.updateMatrixWorld(!0);var r=this.matrixWorld.elements;return t.set(-r[8],-r[9],-r[10]).normalize()},updateMatrixWorld:function(t){Ce.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(t,r){Ce.prototype.updateWorldMatrix.call(this,t,r),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}}),Cr.prototype=ut(at(Gr.prototype),{constructor:Cr,isPerspectiveCamera:!0,copy:function(t,r){return Gr.prototype.copy.call(this,t,r),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:ut({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){t=.5*this.getFilmHeight()/t,this.fov=2*Ar.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*Ar.DEG2RAD*this.fov);return .5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*Ar.RAD2DEG*Math.atan(Math.tan(.5*Ar.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,r,i,s,f,c){this.aspect=t/r,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=r,this.view.offsetX=i,this.view.offsetY=s,this.view.width=f,this.view.height=c,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,r=t*Math.tan(.5*Ar.DEG2RAD*this.fov)/this.zoom,i=2*r,s=this.aspect*i,f=-.5*s,c=this.view;if(this.view!==null&&this.view.enabled){var g=c.fullWidth,p=c.fullHeight;f+=c.offsetX*s/g,r-=c.offsetY*i/p,s*=c.width/g,i*=c.height/p}c=this.filmOffset,c!==0&&(f+=t*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(f,f+s,r,r-i,t,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){return t=Ce.prototype.toJSON.call(this,t),t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=ut({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),Br.prototype=at(Ce.prototype),Br.prototype.constructor=Br,Ni.prototype=at(bt.prototype),Ni.prototype.constructor=Ni,Ni.prototype.isWebGLCubeRenderTarget=!0,Ni.prototype.fromEquirectangularTexture=function(t,r){this.texture.type=r.type,this.texture.format=r.format,this.texture.encoding=r.encoding;var i=new ti,s=new $e({type:"CubemapFromEquirect",uniforms:Mr({tEquirect:{value:null}}),vertexShader:`varying vec3 vWorldDirection;
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,fragmentShader:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
}`,side:1,blending:0});return s.uniforms.tEquirect.value=r,r=new dn(new ty(5,5,5),s),i.add(r),new Br(1,10,this).update(t,i),r.geometry.dispose(),r.material.dispose(),this},Ri.prototype=at(Pt.prototype),Ri.prototype.constructor=Ri,Ri.prototype.isDataTexture=!0;var wg=new Fn,ey=new lt;ut(mi.prototype,{set:function(t,r,i,s,f,c){var g=this.planes;return g[0].copy(t),g[1].copy(r),g[2].copy(i),g[3].copy(s),g[4].copy(f),g[5].copy(c),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){for(var r=this.planes,i=0;6>i;i++)r[i].copy(t.planes[i]);return this},setFromProjectionMatrix:function(t){var r=this.planes,i=t.elements;t=i[0];var s=i[1],f=i[2],c=i[3],g=i[4],p=i[5],A=i[6],S=i[7],N=i[8],_=i[9],I=i[10],L=i[11],P=i[12],F=i[13],W=i[14];return i=i[15],r[0].setComponents(c-t,S-g,L-N,i-P).normalize(),r[1].setComponents(c+t,S+g,L+N,i+P).normalize(),r[2].setComponents(c+s,S+p,L+_,i+F).normalize(),r[3].setComponents(c-s,S-p,L-_,i-F).normalize(),r[4].setComponents(c-f,S-A,L-I,i-W).normalize(),r[5].setComponents(c+f,S+A,L+I,i+W).normalize(),this},intersectsObject:function(t){var r=t.geometry;return r.boundingSphere===null&&r.computeBoundingSphere(),wg.copy(r.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(wg)},intersectsSprite:function(t){return wg.center.set(0,0,0),wg.radius=.7071067811865476,wg.applyMatrix4(t.matrixWorld),this.intersectsSphere(wg)},intersectsSphere:function(t){var r=this.planes,i=t.center;t=-t.radius;for(var s=0;6>s;s++)if(r[s].distanceToPoint(i)<t)return!1;return!0},intersectsBox:function(t){for(var r=this.planes,i=0;6>i;i++){var s=r[i];if(ey.x=0<s.normal.x?t.max.x:t.min.x,ey.y=0<s.normal.y?t.max.y:t.min.y,ey.z=0<s.normal.z?t.max.z:t.min.z,0>s.distanceToPoint(ey))return!1}return!0},containsPoint:function(t){for(var r=this.planes,i=0;6>i;i++)if(0>r[i].distanceToPoint(t))return!1;return!0}});var fr={common:{diffuse:{value:new Ue(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ft},uv2Transform:{value:new Ft},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new st(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ue(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Ue(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Ft}},sprite:{diffuse:{value:new Ue(15658734)},opacity:{value:1},center:{value:new st(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Ft}}};Lr.prototype=at(Le.prototype),Lr.prototype.constructor=Lr,br.prototype=at(Ge.prototype),br.prototype.constructor=br;var Gi={alphamap_fragment:`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,alphamap_pars_fragment:`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment:`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,aomap_fragment:`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,aomap_pars_fragment:`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs:`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE  = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS  = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha  = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,bumpmap_pars_fragment:`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment:`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex:`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment:`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment:`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,color_pars_vertex:`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,color_vertex:`#ifdef USE_COLOR
	vColor.xyz = color.xyz;
#endif`,common:`#define PI 3.14159265359
#define PI2 6.28318530718
#define PI_HALF 1.5707963267949
#define RECIPROCAL_PI 0.31830988618
#define RECIPROCAL_PI2 0.15915494
#define LOG2 1.442695
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
  return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,cube_uv_reflection_fragment:`#ifdef ENVMAP_TYPE_CUBE_UV
#define cubeUV_maxMipLevel 8.0
#define cubeUV_minMipLevel 4.0
#define cubeUV_maxTileSize 256.0
#define cubeUV_minTileSize 16.0
float getFace(vec3 direction) {
    vec3 absDirection = abs(direction);
    float face = -1.0;
    if (absDirection.x > absDirection.z) {
      if (absDirection.x > absDirection.y)
        face = direction.x > 0.0 ? 0.0 : 3.0;
      else
        face = direction.y > 0.0 ? 1.0 : 4.0;
    } else {
      if (absDirection.z > absDirection.y)
        face = direction.z > 0.0 ? 2.0 : 5.0;
      else
        face = direction.y > 0.0 ? 1.0 : 4.0;
    }
    return face;
}
vec2 getUV(vec3 direction, float face) {
    vec2 uv;
    if (face == 0.0) {
      uv = vec2(direction.z, direction.y) / abs(direction.x);    } else if (face == 1.0) {
      uv = vec2(-direction.x, -direction.z) / abs(direction.y);    } else if (face == 2.0) {
      uv = vec2(-direction.x, direction.y) / abs(direction.z);    } else if (face == 3.0) {
      uv = vec2(-direction.z, direction.y) / abs(direction.x);    } else if (face == 4.0) {
      uv = vec2(-direction.x, direction.z) / abs(direction.y);    } else {
      uv = vec2(direction.x, direction.y) / abs(direction.z);    }
    return 0.5 * (uv + 1.0);
}
vec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
  float face = getFace(direction);
  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
  mipInt = max(mipInt, cubeUV_minMipLevel);
  float faceSize = exp2(mipInt);
  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
  vec2 uv = getUV(direction, face) * (faceSize - 1.0);
  vec2 f = fract(uv);
  uv += 0.5 - f;
  if (face > 2.0) {
    uv.y += faceSize;
    face -= 3.0;
  }
  uv.x += face * faceSize;
  if(mipInt < cubeUV_maxMipLevel){
    uv.y += 2.0 * cubeUV_maxTileSize;
  }
  uv.y += filterInt * 2.0 * cubeUV_minTileSize;
  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
  uv *= texelSize;
  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.x += texelSize;
  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.y += texelSize;
  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.x -= texelSize;
  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  vec3 tm = mix(tl, tr, f.x);
  vec3 bm = mix(bl, br, f.x);
  return mix(tm, bm, f.y);
}
#define r0 1.0
#define v0 0.339
#define m0 -2.0
#define r1 0.8
#define v1 0.276
#define m1 -1.0
#define r4 0.4
#define v4 0.046
#define m4 2.0
#define r5 0.305
#define v5 0.016
#define m5 3.0
#define r6 0.21
#define v6 0.0038
#define m6 4.0
float roughnessToMip(float roughness) {
  float mip = 0.0;
  if (roughness >= r1) {
    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
  } else if (roughness >= r4) {
    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
  } else if (roughness >= r5) {
    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
  } else if (roughness >= r6) {
    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
  } else {
    mip = -2.0 * log2(1.16 * roughness);  }
  return mip;
}
vec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {
  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);
  float mipF = fract(mip);
  float mipInt = floor(mip);
  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);
  if (mipF == 0.0) {
    return vec4(color0, 1.0);
  } else {
    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);
    return vec4(mix(color0, color1, mipF), 1.0);
  }
}
#endif`,defaultnormal_vertex:`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex:`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex:`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment:`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment:`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value )  {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,envmap_fragment:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		}  else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#elif defined( ENVMAP_TYPE_EQUIREC )
		reflectVec = normalize( reflectVec );
		vec2 sampleUV = equirectUv( reflectVec );
		vec4 envColor = texture2D( envMap, sampleUV );
	#elif defined( ENVMAP_TYPE_SPHERE )
		reflectVec = normalize( reflectVec );
		vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );
		vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment:`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment:`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex:`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_physical_pars_fragment:`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
		  vec3 reflectVec = reflect( -viewDir, normal );
		  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
		  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#elif defined( ENVMAP_TYPE_EQUIREC )
			vec2 sampleUV = equirectUv( reflectVec );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_SPHERE )
			vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,envmap_vertex:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) { 
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex:`#ifdef USE_FOG
	fogDepth = -mvPosition.z;
#endif`,fog_pars_vertex:`#ifdef USE_FOG
	varying float fogDepth;
#endif`,fog_fragment:`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment:`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment:`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,lightmap_fragment:`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,lightmap_pars_fragment:`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_vertex:`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,lights_pars_begin:`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
		struct PointLightShadow {
			float shadowBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,lights_toon_fragment:`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_toon_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,lights_phong_fragment:`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,lights_physical_fragment:`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,lights_physical_pars_fragment:`struct PhysicalMaterial {
	vec3	diffuseColor;
	float	specularRoughness;
	vec3	specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin:`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps:`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,lights_fragment_end:`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment:`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,map_pars_fragment:`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment:`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment:`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphnormal_vertex:`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,morphtarget_pars_vertex:`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
	uniform float morphTargetInfluences[ 8 ];
	#else
	uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,morphtarget_vertex:`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
	transformed += morphTarget4 * morphTargetInfluences[ 4 ];
	transformed += morphTarget5 * morphTargetInfluences[ 5 ];
	transformed += morphTarget6 * morphTargetInfluences[ 6 ];
	transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,normal_fragment_begin:`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps:`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif`,normalmap_pars_fragment:`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		float scale = sign( st1.t * st0.s - st0.t * st1.s );
		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
		vec3 N = normalize( surf_norm );
		mat3 tsn = mat3( S, T, N );
		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		return normalize( tsn * mapN );
	}
#endif`,clearcoat_normal_fragment_begin:`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps:`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );
	#endif
#endif`,clearcoat_pars_fragment:`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,packing:`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,premultiplied_alpha_fragment:`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex:`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment:`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment:`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment:`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment:`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,shadowmask_pars_fragment:`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex:`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex:`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,skinning_vertex:`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex:`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment:`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment:`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment:`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment:`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
uniform float toneMappingWhitePoint;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )
vec3 Uncharted2ToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );
}`,uv_pars_fragment:`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,uv_pars_vertex:`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,uv_vertex:`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,uv2_pars_fragment:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,uv2_pars_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,uv2_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,worldpos_vertex:`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,background_frag:`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,cube_frag:`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSPARENCY
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSPARENCY
	uniform float transparency;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSPARENCY
		diffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,normal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,normal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,shadow_vert:`#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`},Gh={basic:{uniforms:Xe([fr.common,fr.specularmap,fr.envmap,fr.aomap,fr.lightmap,fr.fog]),vertexShader:Gi.meshbasic_vert,fragmentShader:Gi.meshbasic_frag},lambert:{uniforms:Xe([fr.common,fr.specularmap,fr.envmap,fr.aomap,fr.lightmap,fr.emissivemap,fr.fog,fr.lights,{emissive:{value:new Ue(0)}}]),vertexShader:Gi.meshlambert_vert,fragmentShader:Gi.meshlambert_frag},phong:{uniforms:Xe([fr.common,fr.specularmap,fr.envmap,fr.aomap,fr.lightmap,fr.emissivemap,fr.bumpmap,fr.normalmap,fr.displacementmap,fr.fog,fr.lights,{emissive:{value:new Ue(0)},specular:{value:new Ue(1118481)},shininess:{value:30}}]),vertexShader:Gi.meshphong_vert,fragmentShader:Gi.meshphong_frag},standard:{uniforms:Xe([fr.common,fr.envmap,fr.aomap,fr.lightmap,fr.emissivemap,fr.bumpmap,fr.normalmap,fr.displacementmap,fr.roughnessmap,fr.metalnessmap,fr.fog,fr.lights,{emissive:{value:new Ue(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Gi.meshphysical_vert,fragmentShader:Gi.meshphysical_frag},toon:{uniforms:Xe([fr.common,fr.specularmap,fr.aomap,fr.lightmap,fr.emissivemap,fr.bumpmap,fr.normalmap,fr.displacementmap,fr.gradientmap,fr.fog,fr.lights,{emissive:{value:new Ue(0)},specular:{value:new Ue(1118481)},shininess:{value:30}}]),vertexShader:Gi.meshtoon_vert,fragmentShader:Gi.meshtoon_frag},matcap:{uniforms:Xe([fr.common,fr.bumpmap,fr.normalmap,fr.displacementmap,fr.fog,{matcap:{value:null}}]),vertexShader:Gi.meshmatcap_vert,fragmentShader:Gi.meshmatcap_frag},points:{uniforms:Xe([fr.points,fr.fog]),vertexShader:Gi.points_vert,fragmentShader:Gi.points_frag},dashed:{uniforms:Xe([fr.common,fr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Gi.linedashed_vert,fragmentShader:Gi.linedashed_frag},depth:{uniforms:Xe([fr.common,fr.displacementmap]),vertexShader:Gi.depth_vert,fragmentShader:Gi.depth_frag},normal:{uniforms:Xe([fr.common,fr.bumpmap,fr.normalmap,fr.displacementmap,{opacity:{value:1}}]),vertexShader:Gi.normal_vert,fragmentShader:Gi.normal_frag},sprite:{uniforms:Xe([fr.sprite,fr.fog]),vertexShader:Gi.sprite_vert,fragmentShader:Gi.sprite_frag},background:{uniforms:{uvTransform:{value:new Ft},t2D:{value:null}},vertexShader:Gi.background_vert,fragmentShader:Gi.background_frag},cube:{uniforms:Xe([fr.envmap,{opacity:{value:1}}]),vertexShader:Gi.cube_vert,fragmentShader:Gi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Gi.equirect_vert,fragmentShader:Gi.equirect_frag},distanceRGBA:{uniforms:Xe([fr.common,fr.displacementmap,{referencePosition:{value:new lt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Gi.distanceRGBA_vert,fragmentShader:Gi.distanceRGBA_frag},shadow:{uniforms:Xe([fr.lights,fr.fog,{color:{value:new Ue(0)},opacity:{value:1}}]),vertexShader:Gi.shadow_vert,fragmentShader:Gi.shadow_frag}};Gh.physical={uniforms:Xe([Gh.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new st(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Ue(0)},transparency:{value:0}}]),vertexShader:Gi.meshphysical_vert,fragmentShader:Gi.meshphysical_frag},en.prototype=at(Pt.prototype),en.prototype.constructor=en,en.prototype.isCubeTexture=!0,Object.defineProperty(en.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),Yi.prototype=at(Pt.prototype),Yi.prototype.constructor=Yi,Yi.prototype.isDataTexture2DArray=!0,xe.prototype=at(Pt.prototype),xe.prototype.constructor=xe,xe.prototype.isDataTexture3D=!0;var Tw=new Pt,sC=new Yi,aC=new xe,Sw=new en,Iw=[],Ew=[],Lw=new Float32Array(16),Rw=new Float32Array(9),Pw=new Float32Array(4);$a.prototype.updateCache=function(t){var r=this.cache;t instanceof Float32Array&&r.length!==t.length&&(this.cache=new Float32Array(t.length)),vn(r,t)},uc.prototype.setValue=function(t,r,i){for(var s=this.seq,f=0,c=s.length;f!==c;++f){var g=s[f];g.setValue(t,r[g.id],i)}};var UA=/([\w\d_]+)(\])?(\[|\.)?/g;gs.prototype.setValue=function(t,r,i,s){r=this.map[r],r!==void 0&&r.setValue(t,i,s)},gs.prototype.setOptional=function(t,r,i){r=r[i],r!==void 0&&this.setValue(t,i,r)},gs.upload=function(t,r,i,s){for(var f=0,c=r.length;f!==c;++f){var g=r[f],p=i[g.id];p.needsUpdate!==!1&&g.setValue(t,p.value,s)}},gs.seqWithValue=function(t,r){for(var i=[],s=0,f=t.length;s!==f;++s){var c=t[s];c.id in r&&i.push(c)}return i};var uC=0,HA=/^[ \t]*#include +<([\w\d./]+)>/gm,Dw=/#pragma unroll_loop[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Ow=/#pragma unroll_loop_start[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}[\s]+?#pragma unroll_loop_end/g,lC=0;Ws.prototype=at(kr.prototype),Ws.prototype.constructor=Ws,Ws.prototype.isMeshDepthMaterial=!0,Ws.prototype.copy=function(t){return kr.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},Ra.prototype=at(kr.prototype),Ra.prototype.constructor=Ra,Ra.prototype.isMeshDistanceMaterial=!0,Ra.prototype.copy=function(t){return kr.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},cc.prototype=ut(at(Cr.prototype),{constructor:cc,isArrayCamera:!0}),ys.prototype=ut(at(Ce.prototype),{constructor:ys,isGroup:!0}),ut(eu.prototype,{constructor:eu,getTargetRaySpace:function(){return this._targetRay===null&&(this._targetRay=new ys,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return this._grip===null&&(this._grip=new ys,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(t){return this._targetRay!==null&&this._targetRay.dispatchEvent(t),this._grip!==null&&this._grip.dispatchEvent(t),this},disconnect:function(t){return this.dispatchEvent({type:"disconnected",data:t}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this},update:function(t,r,i){var s=null,f=null,c=this._targetRay,g=this._grip;return t&&(c!==null&&(s=r.getPose(t.targetRaySpace,i),s!==null&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale))),g!==null&&t.gripSpace&&(f=r.getPose(t.gripSpace,i),f!==null&&(g.matrix.fromArray(f.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale)))),c!==null&&(c.visible=s!==null),g!==null&&(g.visible=f!==null),this}}),ut(Ao.prototype,se.prototype),ut(ru.prototype,{isFogExp2:!0,clone:function(){return new ru(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),ut(xs.prototype,{isFog:!0,clone:function(){return new xs(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(As.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}}),ut(As.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,r,i){t*=this.stride,i*=r.stride;for(var s=0,f=this.stride;s<f;s++)this.array[t+s]=r.array[i+s];return this},set:function(t,r){return r===void 0&&(r=0),this.array.set(t,r),this},clone:function(){return new this.constructor().copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}});var Ap=new lt;Xr(hl.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),ut(hl.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(var r=0,i=this.data.count;r<i;r++)Ap.x=this.getX(r),Ap.y=this.getY(r),Ap.z=this.getZ(r),Ap.applyMatrix4(t),this.setXYZ(r,Ap.x,Ap.y,Ap.z);return this},setX:function(t,r){return this.data.array[t*this.data.stride+this.offset]=r,this},setY:function(t,r){return this.data.array[t*this.data.stride+this.offset+1]=r,this},setZ:function(t,r){return this.data.array[t*this.data.stride+this.offset+2]=r,this},setW:function(t,r){return this.data.array[t*this.data.stride+this.offset+3]=r,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,r,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=r,this.data.array[t+1]=i,this},setXYZ:function(t,r,i,s){return t=t*this.data.stride+this.offset,this.data.array[t+0]=r,this.data.array[t+1]=i,this.data.array[t+2]=s,this},setXYZW:function(t,r,i,s,f){return t=t*this.data.stride+this.offset,this.data.array[t+0]=r,this.data.array[t+1]=i,this.data.array[t+2]=s,this.data.array[t+3]=f,this},clone:function(){for(var t=[],r=0;r<this.count;r++)for(var i=r*this.data.stride+this.offset,s=0;s<this.itemSize;s++)t.push(this.data.array[i+s]);return new Ir(new this.array.constructor(t),this.itemSize,this.normalized)},toJSON:function(){for(var t=[],r=0;r<this.count;r++)for(var i=r*this.data.stride+this.offset,s=0;s<this.itemSize;s++)t.push(this.data.array[i+s]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}}),cl.prototype=at(kr.prototype),cl.prototype.constructor=cl,cl.prototype.isSpriteMaterial=!0,cl.prototype.copy=function(t){return kr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};var _g,Lv=new lt,Mg=new lt,Cg=new lt,Tg=new st,Rv=new st,Fw=new ye,ry=new lt,Pv=new lt,iy=new lt,Bw=new st,kA=new st,Nw=new st;ah.prototype=ut(at(Ce.prototype),{constructor:ah,isSprite:!0,raycast:function(t,r){t.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Mg.setFromMatrixScale(this.matrixWorld),Fw.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),Cg.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Mg.multiplyScalar(-Cg.z);var i=this.material.rotation;if(i!==0)var s=Math.cos(i),f=Math.sin(i);i=this.center,dd(ry.set(-.5,-.5,0),Cg,i,Mg,f,s),dd(Pv.set(.5,-.5,0),Cg,i,Mg,f,s),dd(iy.set(.5,.5,0),Cg,i,Mg,f,s),Bw.set(0,0),kA.set(1,0),Nw.set(1,1);var c=t.ray.intersectTriangle(ry,Pv,iy,!1,Lv);c===null&&(dd(Pv.set(-.5,.5,0),Cg,i,Mg,f,s),kA.set(0,1),c=t.ray.intersectTriangle(ry,iy,Pv,!1,Lv),c===null)||(f=t.ray.origin.distanceTo(Lv),f<t.near||f>t.far||r.push({distance:f,point:Lv.clone(),uv:Xi.getUV(Lv,ry,Pv,iy,Bw,kA,Nw,new st),face:null,object:this}))},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(t){return Ce.prototype.copy.call(this,t),t.center!==void 0&&this.center.copy(t.center),this}});var ny=new lt,zw=new lt;Zo.prototype=ut(at(Ce.prototype),{constructor:Zo,isLOD:!0,copy:function(t){Ce.prototype.copy.call(this,t,!1);for(var r=t.levels,i=0,s=r.length;i<s;i++){var f=r[i];this.addLevel(f.object.clone(),f.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,r){r===void 0&&(r=0),r=Math.abs(r);for(var i=this.levels,s=0;s<i.length&&!(r<i[s].distance);s++);return i.splice(s,0,{distance:r,object:t}),this.add(t),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(t){var r=this.levels;if(0<r.length){for(var i=1,s=r.length;i<s&&!(t<r[i].distance);i++);return r[i-1].object}return null},raycast:function(t,r){if(0<this.levels.length){ny.setFromMatrixPosition(this.matrixWorld);var i=t.ray.origin.distanceTo(ny);this.getObjectForDistance(i).raycast(t,r)}},update:function(t){var r=this.levels;if(1<r.length){ny.setFromMatrixPosition(t.matrixWorld),zw.setFromMatrixPosition(this.matrixWorld),t=ny.distanceTo(zw)/t.zoom,r[0].object.visible=!0;for(var i=1,s=r.length;i<s&&t>=r[i].distance;i++)r[i-1].object.visible=!1,r[i].object.visible=!0;for(this._currentLevel=i-1;i<s;i++)r[i].object.visible=!1}},toJSON:function(t){t=Ce.prototype.toJSON.call(this,t),this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];for(var r=this.levels,i=0,s=r.length;i<s;i++){var f=r[i];t.object.levels.push({object:f.object.uuid,distance:f.distance})}return t}}),Pa.prototype=ut(at(dn.prototype),{constructor:Pa,isSkinnedMesh:!0,bind:function(t,r){this.skeleton=t,r===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),r=this.matrixWorld),this.bindMatrix.copy(r),this.bindMatrixInverse.getInverse(r)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var t=new It,r=this.geometry.attributes.skinWeight,i=0,s=r.count;i<s;i++){t.x=r.getX(i),t.y=r.getY(i),t.z=r.getZ(i),t.w=r.getW(i);var f=1/t.manhattanLength();f!==Infinity?t.multiplyScalar(f):t.set(1,0,0,0),r.setXYZW(i,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){dn.prototype.updateMatrixWorld.call(this,t),this.bindMode==="attached"?this.bindMatrixInverse.getInverse(this.matrixWorld):this.bindMode==="detached"?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)},boneTransform:function(){var t=new lt,r=new It,i=new It,s=new lt,f=new ye;return function(c,g){var p=this.skeleton,A=this.geometry;for(r.fromBufferAttribute(A.attributes.skinIndex,c),i.fromBufferAttribute(A.attributes.skinWeight,c),t.fromBufferAttribute(A.attributes.position,c).applyMatrix4(this.bindMatrix),g.set(0,0,0),c=0;4>c;c++)if(A=i.getComponent(c),A!==0){var S=r.getComponent(c);f.multiplyMatrices(p.bones[S].matrixWorld,p.boneInverses[S]),g.addScaledVector(s.copy(t).applyMatrix4(f),A)}return g.applyMatrix4(this.bindMatrixInverse)}}()});var Uw=new ye,hC=new ye;ut(aa.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,r=this.bones.length;t<r;t++){var i=new ye;this.bones[t]&&i.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(i)}},pose:function(){var t,r,i=0;for(r=this.bones.length;i<r;i++)(t=this.bones[i])&&t.matrixWorld.getInverse(this.boneInverses[i]);for(i=0,r=this.bones.length;i<r;i++)(t=this.bones[i])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){for(var t=this.bones,r=this.boneInverses,i=this.boneMatrices,s=this.boneTexture,f=0,c=t.length;f<c;f++)Uw.multiplyMatrices(t[f]?t[f].matrixWorld:hC,r[f]),Uw.toArray(i,16*f);s!==void 0&&(s.needsUpdate=!0)},clone:function(){return new aa(this.bones,this.boneInverses)},getBoneByName:function(t){for(var r=0,i=this.bones.length;r<i;r++){var s=this.bones[r];if(s.name===t)return s}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),Io.prototype=ut(at(Ce.prototype),{constructor:Io,isBone:!0});var Hw=new ye,kw=new ye,oy=[],Dv=new dn;Sr.prototype=ut(at(dn.prototype),{constructor:Sr,isInstancedMesh:!0,getMatrixAt:function(t,r){r.fromArray(this.instanceMatrix.array,16*t)},raycast:function(t,r){var i=this.matrixWorld,s=this.count;if(Dv.geometry=this.geometry,Dv.material=this.material,Dv.material!==void 0)for(var f=0;f<s;f++){this.getMatrixAt(f,Hw),kw.multiplyMatrices(i,Hw),Dv.matrixWorld=kw,Dv.raycast(t,oy);for(var c=0,g=oy.length;c<g;c++){var p=oy[c];p.instanceId=f,p.object=this,r.push(p)}oy.length=0}},setMatrixAt:function(t,r){r.toArray(this.instanceMatrix.array,16*t)},updateMorphTargets:function(){}}),yn.prototype=at(kr.prototype),yn.prototype.constructor=yn,yn.prototype.isLineBasicMaterial=!0,yn.prototype.copy=function(t){return kr.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.morphTargets=t.morphTargets,this};var Gw=new lt,bw=new lt,Vw=new ye,sy=new xo,ay=new Fn;js.prototype=ut(at(Ce.prototype),{constructor:js,isLine:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(t.index===null){for(var r=t.attributes.position,i=[0],s=1,f=r.count;s<f;s++)Gw.fromBufferAttribute(r,s-1),bw.fromBufferAttribute(r,s),i[s]=i[s-1],i[s]+=Gw.distanceTo(bw);t.setAttribute("lineDistance",new We(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry)for(r=t.vertices,i=t.lineDistances,i[0]=0,s=1,f=r.length;s<f;s++)i[s]=i[s-1],i[s]+=r[s-1].distanceTo(r[s]);return this},raycast:function(t,r){var i=this.geometry,s=this.matrixWorld,f=t.params.Line.threshold;if(i.boundingSphere===null&&i.computeBoundingSphere(),ay.copy(i.boundingSphere),ay.applyMatrix4(s),ay.radius+=f,t.ray.intersectsSphere(ay)!==!1){Vw.getInverse(s),sy.copy(t.ray).applyMatrix4(Vw),s=f/((this.scale.x+this.scale.y+this.scale.z)/3),s*=s;var c=new lt,g=new lt;f=new lt;var p=new lt,A=this&&this.isLineSegments?2:1;if(i.isBufferGeometry){var S=i.index,N=i.attributes.position.array;if(S!==null){S=S.array,i=0;for(var _=S.length-1;i<_;i+=A){var I=S[i+1];c.fromArray(N,3*S[i]),g.fromArray(N,3*I),I=sy.distanceSqToSegment(c,g,p,f),I>s||(p.applyMatrix4(this.matrixWorld),I=t.ray.origin.distanceTo(p),I<t.near||I>t.far||r.push({distance:I,point:f.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this}))}}else for(i=0,_=N.length/3-1;i<_;i+=A)c.fromArray(N,3*i),g.fromArray(N,3*i+3),I=sy.distanceSqToSegment(c,g,p,f),I>s||(p.applyMatrix4(this.matrixWorld),I=t.ray.origin.distanceTo(p),I<t.near||I>t.far||r.push({distance:I,point:f.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this}))}else if(i.isGeometry)for(c=i.vertices,g=c.length,i=0;i<g-1;i+=A)I=sy.distanceSqToSegment(c[i],c[i+1],p,f),I>s||(p.applyMatrix4(this.matrixWorld),I=t.ray.origin.distanceTo(p),I<t.near||I>t.far||r.push({distance:I,point:f.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this}))}},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){t=t.morphAttributes;var r=qi(t);if(0<r.length){var i=t[r[0]];if(i!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,r=i.length;t<r;t++){var s=i[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=t}}}else t=t.morphTargets,t!==void 0&&0<t.length&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var uy=new lt,ly=new lt;zn.prototype=ut(at(js.prototype),{constructor:zn,isLineSegments:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(t.index===null){for(var r=t.attributes.position,i=[],s=0,f=r.count;s<f;s+=2)uy.fromBufferAttribute(r,s),ly.fromBufferAttribute(r,s+1),i[s]=s===0?0:i[s-1],i[s+1]=i[s]+uy.distanceTo(ly);t.setAttribute("lineDistance",new We(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry)for(r=t.vertices,i=t.lineDistances,s=0,f=r.length;s<f;s+=2)uy.copy(r[s]),ly.copy(r[s+1]),i[s]=s===0?0:i[s-1],i[s+1]=i[s]+uy.distanceTo(ly);return this}}),Un.prototype=ut(at(js.prototype),{constructor:Un,isLineLoop:!0}),Xs.prototype=at(kr.prototype),Xs.prototype.constructor=Xs,Xs.prototype.isPointsMaterial=!0,Xs.prototype.copy=function(t){return kr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this};var Ww=new ye,GA=new xo,hy=new Fn,cy=new lt;Cu.prototype=ut(at(Ce.prototype),{constructor:Cu,isPoints:!0,raycast:function(t,r){var i=this.geometry,s=this.matrixWorld,f=t.params.Points.threshold;if(i.boundingSphere===null&&i.computeBoundingSphere(),hy.copy(i.boundingSphere),hy.applyMatrix4(s),hy.radius+=f,t.ray.intersectsSphere(hy)!==!1)if(Ww.getInverse(s),GA.copy(t.ray).applyMatrix4(Ww),f/=(this.scale.x+this.scale.y+this.scale.z)/3,f*=f,i.isBufferGeometry){var c=i.index;if(i=i.attributes.position.array,c!==null){var g=c.array;c=0;for(var p=g.length;c<p;c++){var A=g[c];cy.fromArray(i,3*A),fc(cy,A,f,s,t,r,this)}}else for(c=0,g=i.length/3;c<g;c++)cy.fromArray(i,3*c),fc(cy,c,f,s,t,r,this)}else for(i=i.vertices,c=0,g=i.length;c<g;c++)fc(i[c],c,f,s,t,r,this)},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){t=t.morphAttributes;var r=qi(t);if(0<r.length){var i=t[r[0]];if(i!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,r=i.length;t<r;t++){var s=i[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=t}}}else t=t.morphTargets,t!==void 0&&0<t.length&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),U0.prototype=ut(at(Pt.prototype),{constructor:U0,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Sf.prototype=at(Pt.prototype),Sf.prototype.constructor=Sf,Sf.prototype.isCompressedTexture=!0,gd.prototype=at(Pt.prototype),gd.prototype.constructor=gd,gd.prototype.isCanvasTexture=!0,Ur.prototype=at(Pt.prototype),Ur.prototype.constructor=Ur,Ur.prototype.isDepthTexture=!0,If.prototype=at(Ge.prototype),If.prototype.constructor=If,md.prototype=at(Le.prototype),md.prototype.constructor=md,pc.prototype=at(Ge.prototype),pc.prototype.constructor=pc,vd.prototype=at(Le.prototype),vd.prototype.constructor=vd,zo.prototype=at(Ge.prototype),zo.prototype.constructor=zo,lr.prototype=at(Le.prototype),lr.prototype.constructor=lr,Ef.prototype=at(zo.prototype),Ef.prototype.constructor=Ef,yd.prototype=at(Le.prototype),yd.prototype.constructor=yd,ws.prototype=at(zo.prototype),ws.prototype.constructor=ws,Hn.prototype=at(Le.prototype),Hn.prototype.constructor=Hn,Lf.prototype=at(zo.prototype),Lf.prototype.constructor=Lf,qe.prototype=at(Le.prototype),qe.prototype.constructor=qe,_s.prototype=at(zo.prototype),_s.prototype.constructor=_s,xd.prototype=at(Le.prototype),xd.prototype.constructor=xd,uh.prototype=at(Ge.prototype),uh.prototype.constructor=uh,uh.prototype.toJSON=function(){var t=Ge.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t},dc.prototype=at(Le.prototype),dc.prototype.constructor=dc,Rf.prototype=at(Ge.prototype),Rf.prototype.constructor=Rf,gc.prototype=at(Le.prototype),gc.prototype.constructor=gc,fl.prototype=at(Ge.prototype),fl.prototype.constructor=fl;var cC={triangulate:function(t,r,i){i=i||2;var s=r&&r.length,f=s?r[0]*i:t.length,c=Tu(t,0,f,i,!0),g=[];if(!c||c.next===c.prev)return g;var p;if(s){var A=i;s=[];var S,N=0;for(S=r.length;N<S;N++){var _=r[N]*A,I=N<S-1?r[N+1]*A:t.length;_=Tu(t,_,I,A,!1),_===_.next&&(_.steiner=!0),s.push(Lm(_))}for(s.sort(lh),N=0;N<s.length;N++)A=s[N],r=c,(r=k0(A,r))&&(A=Ad(r,A),Sn(r,r.next),Sn(A,A.next)),c=Sn(c,c.next)}if(t.length>80*i){var L=p=t[0],P=s=t[1];for(A=i;A<f;A+=i)N=t[A],r=t[A+1],N<L&&(L=N),r<P&&(P=r),N>p&&(p=N),r>s&&(s=r);p=Math.max(p-L,s-P),p=p!==0?1/p:0}return Pf(c,g,i,L,P,p),g}},Yc={area:function(t){for(var r=t.length,i=0,s=r-1,f=0;f<r;s=f++)i+=t[s].x*t[f].y-t[f].x*t[s].y;return .5*i},isClockWise:function(t){return 0>Yc.area(t)},triangulateShape:function(t,r){var i=[],s=[],f=[];Ff(t),b0(i,t);var c=t.length;for(r.forEach(Ff),t=0;t<r.length;t++)s.push(c),c+=r[t].length,b0(i,r[t]);for(r=cC.triangulate(i,s),t=0;t<r.length;t+=3)f.push(r.slice(t,t+3));return f}};iu.prototype=at(Le.prototype),iu.prototype.constructor=iu,iu.prototype.toJSON=function(){var t=Le.prototype.toJSON.call(this);return V0(this.parameters.shapes,this.parameters.options,t)},ua.prototype=at(Ge.prototype),ua.prototype.constructor=ua,ua.prototype.toJSON=function(){var t=Ge.prototype.toJSON.call(this);return V0(this.parameters.shapes,this.parameters.options,t)};var fC={generateTopUV:function(t,r,i,s,f){t=r[3*s],s=r[3*s+1];var c=r[3*f];return f=r[3*f+1],[new st(r[3*i],r[3*i+1]),new st(t,s),new st(c,f)]},generateSideWallUV:function(t,r,i,s,f,c){t=r[3*i];var g=r[3*i+1];i=r[3*i+2];var p=r[3*s],A=r[3*s+1];s=r[3*s+2];var S=r[3*f],N=r[3*f+1];f=r[3*f+2];var _=r[3*c],I=r[3*c+1];return r=r[3*c+2],.01>Math.abs(g-A)?[new st(t,1-i),new st(p,1-s),new st(S,1-f),new st(_,1-r)]:[new st(g,1-i),new st(A,1-s),new st(N,1-f),new st(I,1-r)]}};xc.prototype=at(Le.prototype),xc.prototype.constructor=xc,hh.prototype=at(ua.prototype),hh.prototype.constructor=hh,_d.prototype=at(Le.prototype),_d.prototype.constructor=_d,ch.prototype=at(Ge.prototype),ch.prototype.constructor=ch,Bf.prototype=at(Le.prototype),Bf.prototype.constructor=Bf,Nf.prototype=at(Ge.prototype),Nf.prototype.constructor=Nf,zf.prototype=at(Le.prototype),zf.prototype.constructor=zf,Ac.prototype=at(Ge.prototype),Ac.prototype.constructor=Ac,fh.prototype=at(Le.prototype),fh.prototype.constructor=fh,fh.prototype.toJSON=function(){var t=Le.prototype.toJSON.call(this);return W0(this.parameters.shapes,t)},Su.prototype=at(Ge.prototype),Su.prototype.constructor=Su,Su.prototype.toJSON=function(){var t=Ge.prototype.toJSON.call(this);return W0(this.parameters.shapes,t)},Uf.prototype=at(Ge.prototype),Uf.prototype.constructor=Uf,la.prototype=at(Le.prototype),la.prototype.constructor=la,Iu.prototype=at(Ge.prototype),Iu.prototype.constructor=Iu,Uo.prototype=at(la.prototype),Uo.prototype.constructor=Uo,ph.prototype=at(Iu.prototype),ph.prototype.constructor=ph,dh.prototype=at(Le.prototype),dh.prototype.constructor=dh,Eo.prototype=at(Ge.prototype),Eo.prototype.constructor=Eo;var $s=Rl({__proto__:null,WireframeGeometry:If,ParametricGeometry:md,ParametricBufferGeometry:pc,TetrahedronGeometry:lr,TetrahedronBufferGeometry:Ef,OctahedronGeometry:yd,OctahedronBufferGeometry:ws,IcosahedronGeometry:Hn,IcosahedronBufferGeometry:Lf,DodecahedronGeometry:qe,DodecahedronBufferGeometry:_s,PolyhedronGeometry:vd,PolyhedronBufferGeometry:zo,TubeGeometry:xd,TubeBufferGeometry:uh,TorusKnotGeometry:dc,TorusKnotBufferGeometry:Rf,TorusGeometry:gc,TorusBufferGeometry:fl,TextGeometry:xc,TextBufferGeometry:hh,SphereGeometry:_d,SphereBufferGeometry:ch,RingGeometry:Bf,RingBufferGeometry:Nf,PlaneGeometry:Lr,PlaneBufferGeometry:br,LatheGeometry:zf,LatheBufferGeometry:Ac,ShapeGeometry:fh,ShapeBufferGeometry:Su,ExtrudeGeometry:iu,ExtrudeBufferGeometry:ua,EdgesGeometry:Uf,ConeGeometry:Uo,ConeBufferGeometry:ph,CylinderGeometry:la,CylinderBufferGeometry:Iu,CircleGeometry:dh,CircleBufferGeometry:Eo,BoxGeometry:oC,BoxBufferGeometry:ty});gh.prototype=at(kr.prototype),gh.prototype.constructor=gh,gh.prototype.isShadowMaterial=!0,gh.prototype.copy=function(t){return kr.prototype.copy.call(this,t),this.color.copy(t.color),this},Hf.prototype=at($e.prototype),Hf.prototype.constructor=Hf,Hf.prototype.isRawShaderMaterial=!0,Lo.prototype=at(kr.prototype),Lo.prototype.constructor=Lo,Lo.prototype.isMeshStandardMaterial=!0,Lo.prototype.copy=function(t){return kr.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.vertexTangents=t.vertexTangents,this},ns.prototype=at(Lo.prototype),ns.prototype.constructor=ns,ns.prototype.isMeshPhysicalMaterial=!0,ns.prototype.copy=function(t){return Lo.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,this.sheen=t.sheen?(this.sheen||new Ue).copy(t.sheen):null,this.transparency=t.transparency,this},Ys.prototype=at(kr.prototype),Ys.prototype.constructor=Ys,Ys.prototype.isMeshPhongMaterial=!0,Ys.prototype.copy=function(t){return kr.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Jo.prototype=at(kr.prototype),Jo.prototype.constructor=Jo,Jo.prototype.isMeshToonMaterial=!0,Jo.prototype.copy=function(t){return kr.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Oa.prototype=at(kr.prototype),Oa.prototype.constructor=Oa,Oa.prototype.isMeshNormalMaterial=!0,Oa.prototype.copy=function(t){return kr.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},dl.prototype=at(kr.prototype),dl.prototype.constructor=dl,dl.prototype.isMeshLambertMaterial=!0,dl.prototype.copy=function(t){return kr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},gl.prototype=at(kr.prototype),gl.prototype.constructor=gl,gl.prototype.isMeshMatcapMaterial=!0,gl.prototype.copy=function(t){return kr.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},ml.prototype=at(yn.prototype),ml.prototype.constructor=ml,ml.prototype.isLineDashedMaterial=!0,ml.prototype.copy=function(t){return yn.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var pC=Rl({__proto__:null,ShadowMaterial:gh,SpriteMaterial:cl,RawShaderMaterial:Hf,ShaderMaterial:$e,PointsMaterial:Xs,MeshPhysicalMaterial:ns,MeshStandardMaterial:Lo,MeshPhongMaterial:Ys,MeshToonMaterial:Jo,MeshNormalMaterial:Oa,MeshLambertMaterial:dl,MeshDepthMaterial:Ws,MeshDistanceMaterial:Ra,MeshBasicMaterial:ro,MeshMatcapMaterial:gl,LineDashedMaterial:ml,LineBasicMaterial:yn,Material:kr}),uo={arraySlice:function(t,r,i){return uo.isTypedArray(t)?new t.constructor(t.subarray(r,i!==void 0?i:t.length)):t.slice(r,i)},convertArray:function(t,r,i){return!t||!i&&t.constructor===r?t:typeof r.BYTES_PER_ELEMENT=="number"?new r(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var r=t.length,i=Array(r),s=0;s!==r;++s)i[s]=s;return i.sort(function(f,c){return t[f]-t[c]}),i},sortedArray:function(t,r,i){for(var s=t.length,f=new t.constructor(s),c=0,g=0;g!==s;++c)for(var p=i[c]*r,A=0;A!==r;++A)f[g++]=t[p+A];return f},flattenJSON:function(t,r,i,s){for(var f=1,c=t[0];c!==void 0&&c[s]===void 0;)c=t[f++];if(c!==void 0){var g=c[s];if(g!==void 0)if(Array.isArray(g))do g=c[s],g!==void 0&&(r.push(c.time),i.push.apply(i,g)),c=t[f++];while(c!==void 0);else if(g.toArray!==void 0)do g=c[s],g!==void 0&&(r.push(c.time),g.toArray(i,i.length)),c=t[f++];while(c!==void 0);else do g=c[s],g!==void 0&&(r.push(c.time),i.push(g)),c=t[f++];while(c!==void 0)}},subclip:function(t,r,i,s,f){f=f||30,t=t.clone(),t.name=r;var c=[];for(r=0;r<t.tracks.length;++r){for(var g=t.tracks[r],p=g.getValueSize(),A=[],S=[],N=0;N<g.times.length;++N){var _=g.times[N]*f;if(!(_<i||_>=s))for(A.push(g.times[N]),_=0;_<p;++_)S.push(g.values[N*p+_])}A.length!==0&&(g.times=uo.convertArray(A,g.times.constructor),g.values=uo.convertArray(S,g.values.constructor),c.push(g))}for(t.tracks=c,i=Infinity,r=0;r<t.tracks.length;++r)i>t.tracks[r].times[0]&&(i=t.tracks[r].times[0]);for(r=0;r<t.tracks.length;++r)t.tracks[r].shift(-1*i);return t.resetDuration(),t},makeClipAdditive:function(t,r,i,s){r===void 0&&(r=0),i===void 0&&(i=t),(s===void 0||0>=s)&&(s=30);var f=t.tracks.length;for(r/=s,s=0;s<f;++s){var c=i.tracks[s],g=c.ValueTypeName;if(g!=="bool"&&g!=="string"){var p=t.tracks.find(function(P){return P.name===c.name&&P.ValueTypeName===g});if(p!==void 0){var A=c.getValueSize(),S=c.times.length-1;r<=c.times[0]?S=uo.arraySlice(c.values,0,c.valueSize):r>=c.times[S]?S=uo.arraySlice(c.values,S*A):(S=c.createInterpolant(),S.evaluate(r),S=S.resultBuffer),g==="quaternion"&&new he(S[0],S[1],S[2],S[3]).normalize().conjugate().toArray(S);for(var N=p.times.length,_=0;_<N;++_){var I=_*A;if(g==="quaternion")he.multiplyQuaternionsFlat(p.values,I,S,0,p.values,I);else for(var L=0;L<A;++L)p.values[I+L]-=S[L]}}}}return t.blendMode=2501,t}};ut(os.prototype,{evaluate:function(t){var r=this.parameterPositions,i=this._cachedIndex,s=r[i],f=r[i-1];t:{e:{r:{i:if(!(t<s)){for(var c=i+2;;){if(s===void 0){if(t<f)break i;return this._cachedIndex=i=r.length,this.afterEnd_(i-1,t,f)}if(i===c)break;if(f=s,s=r[++i],t<s)break e}s=r.length;break r}if(t>=f)break t;for(c=r[1],t<c&&(i=2,f=c),c=i-2;;){if(f===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,s);if(i===c)break;if(s=f,f=r[--i-1],t>=f)break e}s=i,i=0}for(;i<s;)f=i+s>>>1,t<r[f]?s=f:i=f+1;if(s=r[i],f=r[i-1],f===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,s);if(s===void 0)return this._cachedIndex=i=r.length,this.afterEnd_(i-1,f,t)}this._cachedIndex=i,this.intervalChanged_(i,f,s)}return this.interpolate_(i,f,t,s)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){var r=this.resultBuffer,i=this.sampleValues,s=this.valueSize;t*=s;for(var f=0;f!==s;++f)r[f]=i[t+f];return r},interpolate_:function(){throw Error("call to abstract method")},intervalChanged_:function(){}}),ut(os.prototype,{beforeStart_:os.prototype.copySampleValue_,afterEnd_:os.prototype.copySampleValue_}),kf.prototype=ut(at(os.prototype),{constructor:kf,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,r,i){var s=this.parameterPositions,f=t-2,c=t+1,g=s[f],p=s[c];if(g===void 0)switch(this.getSettings_().endingStart){case 2401:f=t,g=2*r-i;break;case 2402:f=s.length-2,g=r+s[f]-s[f+1];break;default:f=t,g=i}if(p===void 0)switch(this.getSettings_().endingEnd){case 2401:c=t,p=2*i-r;break;case 2402:c=1,p=i+s[1]-s[0];break;default:c=t-1,p=r}t=.5*(i-r),s=this.valueSize,this._weightPrev=t/(r-g),this._weightNext=t/(p-i),this._offsetPrev=f*s,this._offsetNext=c*s},interpolate_:function(t,r,i,s){var f=this.resultBuffer,c=this.sampleValues,g=this.valueSize;t*=g;var p=t-g,A=this._offsetPrev,S=this._offsetNext,N=this._weightPrev,_=this._weightNext,I=(i-r)/(s-r);for(i=I*I,s=i*I,r=-N*s+2*N*i-N*I,N=(1+N)*s+(-1.5-2*N)*i+(-.5+N)*I+1,I=(-1-_)*s+(1.5+_)*i+.5*I,_=_*s-_*i,i=0;i!==g;++i)f[i]=r*c[A+i]+N*c[p+i]+I*c[t+i]+_*c[S+i];return f}}),mh.prototype=ut(at(os.prototype),{constructor:mh,interpolate_:function(t,r,i,s){var f=this.resultBuffer,c=this.sampleValues,g=this.valueSize;t*=g;var p=t-g;for(r=(i-r)/(s-r),i=1-r,s=0;s!==g;++s)f[s]=c[p+s]*i+c[t+s]*r;return f}}),Md.prototype=ut(at(os.prototype),{constructor:Md,interpolate_:function(t){return this.copySampleValue_(t-1)}}),ut(qo,{toJSON:function(t){var r=t.constructor;if(r.toJSON!==void 0)r=r.toJSON(t);else{r={name:t.name,times:uo.convertArray(t.times,Array),values:uo.convertArray(t.values,Array)};var i=t.getInterpolation();i!==t.DefaultInterpolation&&(r.interpolation=i)}return r.type=t.ValueTypeName,r}}),ut(qo.prototype,{constructor:qo,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(t){return new Md(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new mh(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new kf(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){switch(t){case 2300:var r=this.InterpolantFactoryMethodDiscrete;break;case 2301:r=this.InterpolantFactoryMethodLinear;break;case 2302:r=this.InterpolantFactoryMethodSmooth}if(r===void 0){if(r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name,this.createInterpolant===void 0)if(t!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=r,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(t!==0)for(var r=this.times,i=0,s=r.length;i!==s;++i)r[i]+=t;return this},scale:function(t){if(t!==1)for(var r=this.times,i=0,s=r.length;i!==s;++i)r[i]*=t;return this},trim:function(t,r){for(var i=this.times,s=i.length,f=0,c=s-1;f!==s&&i[f]<t;)++f;for(;c!==-1&&i[c]>r;)--c;return++c,(f!==0||c!==s)&&(f>=c&&(c=Math.max(c,1),f=c-1),t=this.getValueSize(),this.times=uo.arraySlice(i,f,c),this.values=uo.arraySlice(this.values,f*t,c*t)),this},validate:function(){var t=!0,r=this.getValueSize();r-Math.floor(r)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var i=this.times;r=this.values;var s=i.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var f=null,c=0;c!==s;c++){var g=i[c];if(typeof g=="number"&&isNaN(g)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,c,g),t=!1;break}if(f!==null&&f>g){console.error("THREE.KeyframeTrack: Out of order keys.",this,c,g,f),t=!1;break}f=g}if(r!==void 0&&uo.isTypedArray(r)){for(c=0,i=r.length;c!==i;++c)if(s=r[c],isNaN(s)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,c,s),t=!1;break}}return t},optimize:function(){for(var t=uo.arraySlice(this.times),r=uo.arraySlice(this.values),i=this.getValueSize(),s=this.getInterpolation()===2302,f=1,c=t.length-1,g=1;g<c;++g){var p=!1,A=t[g];if(A!==t[g+1]&&(g!==1||A!==A[0]))if(s)p=!0;else{var S=g*i,N=S-i,_=S+i;for(A=0;A!==i;++A){var I=r[S+A];if(I!==r[N+A]||I!==r[_+A]){p=!0;break}}}if(p){if(g!==f)for(t[f]=t[g],p=g*i,S=f*i,A=0;A!==i;++A)r[S+A]=r[p+A];++f}}if(0<c){for(t[f]=t[c],p=c*i,S=f*i,A=0;A!==i;++A)r[S+A]=r[p+A];++f}return f!==t.length?(this.times=uo.arraySlice(t,0,f),this.values=uo.arraySlice(r,0,f*i)):(this.times=t,this.values=r),this},clone:function(){var t=uo.arraySlice(this.times,0),r=uo.arraySlice(this.values,0);return t=new this.constructor(this.name,t,r),t.createInterpolant=this.createInterpolant,t}}),Cd.prototype=ut(at(qo.prototype),{constructor:Cd,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Td.prototype=ut(at(qo.prototype),{constructor:Td,ValueTypeName:"color"}),vh.prototype=ut(at(qo.prototype),{constructor:vh,ValueTypeName:"number"}),Sd.prototype=ut(at(os.prototype),{constructor:Sd,interpolate_:function(t,r,i,s){var f=this.resultBuffer,c=this.sampleValues,g=this.valueSize;for(t*=g,r=(i-r)/(s-r),i=t+g;t!==i;t+=4)he.slerpFlat(f,0,c,t-g,c,t,r);return f}}),wc.prototype=ut(at(qo.prototype),{constructor:wc,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(t){return new Sd(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),Id.prototype=ut(at(qo.prototype),{constructor:Id,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),yh.prototype=ut(at(qo.prototype),{constructor:yh,ValueTypeName:"vector"}),ut(ha,{parse:function(t){for(var r=[],i=t.tracks,s=1/(t.fps||1),f=0,c=i.length;f!==c;++f)r.push(j0(i[f]).scale(s));return new ha(t.name,t.duration,r,t.blendMode)},toJSON:function(t){var r=[],i=t.tracks;t={name:t.name,duration:t.duration,tracks:r,uuid:t.uuid,blendMode:t.blendMode};for(var s=0,f=i.length;s!==f;++s)r.push(qo.toJSON(i[s]));return t},CreateFromMorphTargetSequence:function(t,r,i,s){for(var f=r.length,c=[],g=0;g<f;g++){var p=[],A=[];p.push((g+f-1)%f,g,(g+1)%f),A.push(0,1,0);var S=uo.getKeyframeOrder(p);p=uo.sortedArray(p,1,S),A=uo.sortedArray(A,1,S),s||p[0]!==0||(p.push(f),A.push(A[0])),c.push(new vh(".morphTargetInfluences["+r[g].name+"]",p,A).scale(1/i))}return new ha(t,-1,c)},findByName:function(t,r){var i=t;for(Array.isArray(t)||(i=t.geometry&&t.geometry.animations||t.animations),t=0;t<i.length;t++)if(i[t].name===r)return i[t];return null},CreateClipsFromMorphTargetSequences:function(t,r,i){for(var s={},f=/^([\w-]*?)([\d]+)$/,c=0,g=t.length;c<g;c++){var p=t[c],A=p.name.match(f);if(A&&1<A.length){var S=A[1];(A=s[S])||(s[S]=A=[]),A.push(p)}}t=[];for(S in s)t.push(ha.CreateFromMorphTargetSequence(S,s[S],r,i));return t},parseAnimation:function(t,r){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;var i=function(W,X,Z,tt,ot){if(Z.length!==0){var xt=[],At=[];uo.flattenJSON(Z,xt,At,tt),xt.length!==0&&ot.push(new W(X,xt,At))}},s=[],f=t.name||"default",c=t.length||-1,g=t.fps||30,p=t.blendMode;t=t.hierarchy||[];for(var A=0;A<t.length;A++){var S=t[A].keys;if(S&&S.length!==0)if(S[0].morphTargets){c={};for(var N=0;N<S.length;N++)if(S[N].morphTargets)for(var _=0;_<S[N].morphTargets.length;_++)c[S[N].morphTargets[_]]=-1;for(var I in c){var L=[],P=[];for(_=0;_!==S[N].morphTargets.length;++_){var F=S[N];L.push(F.time),P.push(F.morphTarget===I?1:0)}s.push(new vh(".morphTargetInfluence["+I+"]",L,P))}c=c.length*(g||1)}else N=".bones["+r[A].name+"]",i(yh,N+".position",S,"pos",s),i(wc,N+".quaternion",S,"rot",s),i(yh,N+".scale",S,"scl",s)}return s.length===0?null:new ha(f,c,s,p)}}),ut(ha.prototype,{resetDuration:function(){for(var t=0,r=0,i=this.tracks.length;r!==i;++r){var s=this.tracks[r];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){for(var t=!0,r=0;r<this.tracks.length;r++)t=t&&this.tracks[r].validate();return t},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){for(var t=[],r=0;r<this.tracks.length;r++)t.push(this.tracks[r].clone());return new ha(this.name,this.duration,t,this.blendMode)}});var Sg={enabled:!1,files:{},add:function(t,r){this.enabled!==!1&&(this.files[t]=r)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},jw=new xh;ut(si.prototype,{load:function(){},loadAsync:function(t,r){var i=this;return new Di(function(s,f){i.load(t,s,r,f)})},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}});var Vu={};Ms.prototype=ut(at(si.prototype),{constructor:Ms,load:function(t,r,i,s){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);var f=this,c=Sg.get(t);if(c!==void 0)return f.manager.itemStart(t),setTimeout(function(){r&&r(c),f.manager.itemEnd(t)},0),c;if(Vu[t]!==void 0)Vu[t].push({onLoad:r,onProgress:i,onError:s});else{var g=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(g){i=g[1];var p=!!g[2];g=g[3],g=decodeURIComponent(g),p&&(g=atob(g));try{var A=(this.responseType||"").toLowerCase();switch(A){case"arraybuffer":case"blob":var S=new Uint8Array(g.length);for(p=0;p<g.length;p++)S[p]=g.charCodeAt(p);var N=A==="blob"?new Blob([S.buffer],{type:i}):S.buffer;break;case"document":N=new DOMParser().parseFromString(g,i);break;case"json":N=JSON.parse(g);break;default:N=g}setTimeout(function(){r&&r(N),f.manager.itemEnd(t)},0)}catch(I){setTimeout(function(){s&&s(I),f.manager.itemError(t),f.manager.itemEnd(t)},0)}}else{Vu[t]=[],Vu[t].push({onLoad:r,onProgress:i,onError:s});var _=new XMLHttpRequest;_.open("GET",t,!0),_.addEventListener("load",function(I){var L=this.response,P=Vu[t];if(delete Vu[t],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Sg.add(t,L);for(var F=0,W=P.length;F<W;F++){var X=P[F];X.onLoad&&X.onLoad(L)}}else{for(F=0,W=P.length;F<W;F++)X=P[F],X.onError&&X.onError(I);f.manager.itemError(t)}f.manager.itemEnd(t)},!1),_.addEventListener("progress",function(I){for(var L=Vu[t],P=0,F=L.length;P<F;P++){var W=L[P];W.onProgress&&W.onProgress(I)}},!1),_.addEventListener("error",function(I){var L=Vu[t];delete Vu[t];for(var P=0,F=L.length;P<F;P++){var W=L[P];W.onError&&W.onError(I)}f.manager.itemError(t),f.manager.itemEnd(t)},!1),_.addEventListener("abort",function(I){var L=Vu[t];delete Vu[t];for(var P=0,F=L.length;P<F;P++){var W=L[P];W.onError&&W.onError(I)}f.manager.itemError(t),f.manager.itemEnd(t)},!1),this.responseType!==void 0&&(_.responseType=this.responseType),this.withCredentials!==void 0&&(_.withCredentials=this.withCredentials),_.overrideMimeType&&_.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(p in this.requestHeader)_.setRequestHeader(p,this.requestHeader[p]);_.send(null)}return f.manager.itemStart(t),_}},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this}}),Pr.prototype=ut(at(si.prototype),{constructor:Pr,load:function(t,r,i,s){var f=this,c=new Ms(f.manager);c.setPath(f.path),c.load(t,function(g){try{r(f.parse(JSON.parse(g)))}catch(p){s?s(p):console.error(p),f.manager.itemError(t)}},i,s)},parse:function(t){for(var r=[],i=0;i<t.length;i++){var s=ha.parse(t[i]);r.push(s)}return r}}),X0.prototype=ut(at(si.prototype),{constructor:X0,load:function(t,r,i,s){function f(I){A.load(t[I],function(L){L=c.parse(L,!0),g[I]={width:L.width,height:L.height,format:L.format,mipmaps:L.mipmaps},S+=1,S===6&&(L.mipmapCount===1&&(p.minFilter=1006),p.format=L.format,p.needsUpdate=!0,r&&r(p))},i,s)}var c=this,g=[],p=new Sf;p.image=g;var A=new Ms(this.manager);if(A.setPath(this.path),A.setResponseType("arraybuffer"),Array.isArray(t))for(var S=0,N=0,_=t.length;N<_;++N)f(N);else A.load(t,function(I){if(I=c.parse(I,!0),I.isCubemap)for(var L=I.mipmaps.length/I.mipmapCount,P=0;P<L;P++){g[P]={mipmaps:[]};for(var F=0;F<I.mipmapCount;F++)g[P].mipmaps.push(I.mipmaps[P*I.mipmapCount+F]),g[P].format=I.format,g[P].width=I.width,g[P].height=I.height}else p.image.width=I.width,p.image.height=I.height,p.mipmaps=I.mipmaps;I.mipmapCount===1&&(p.minFilter=1006),p.format=I.format,p.needsUpdate=!0,r&&r(p)},i,s);return p}}),Y0.prototype=ut(at(si.prototype),{constructor:Y0,load:function(t,r,i,s){var f=this,c=new Ri,g=new Ms(this.manager);return g.setResponseType("arraybuffer"),g.setPath(this.path),g.load(t,function(p){(p=f.parse(p))&&(p.image!==void 0?c.image=p.image:p.data!==void 0&&(c.image.width=p.width,c.image.height=p.height,c.image.data=p.data),c.wrapS=p.wrapS!==void 0?p.wrapS:1001,c.wrapT=p.wrapT!==void 0?p.wrapT:1001,c.magFilter=p.magFilter!==void 0?p.magFilter:1006,c.minFilter=p.minFilter!==void 0?p.minFilter:1006,c.anisotropy=p.anisotropy!==void 0?p.anisotropy:1,p.format!==void 0&&(c.format=p.format),p.type!==void 0&&(c.type=p.type),p.mipmaps!==void 0&&(c.mipmaps=p.mipmaps,c.minFilter=1008),p.mipmapCount===1&&(c.minFilter=1006),c.needsUpdate=!0,r&&r(c,p))},i,s),c}}),_c.prototype=ut(at(si.prototype),{constructor:_c,load:function(t,r,i,s){function f(){A.removeEventListener("load",f,!1),A.removeEventListener("error",c,!1),Sg.add(t,this),r&&r(this),g.manager.itemEnd(t)}function c(S){A.removeEventListener("load",f,!1),A.removeEventListener("error",c,!1),s&&s(S),g.manager.itemError(t),g.manager.itemEnd(t)}this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);var g=this,p=Sg.get(t);if(p!==void 0)return g.manager.itemStart(t),setTimeout(function(){r&&r(p),g.manager.itemEnd(t)},0),p;var A=document.createElementNS("http://www.w3.org/1999/xhtml","img");return A.addEventListener("load",f,!1),A.addEventListener("error",c,!1),t.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(A.crossOrigin=this.crossOrigin),g.manager.itemStart(t),A.src=t,A}}),Rm.prototype=ut(at(si.prototype),{constructor:Rm,load:function(t,r,i,s){function f(A){g.load(t[A],function(S){c.images[A]=S,p++,p===6&&(c.needsUpdate=!0,r&&r(c))},void 0,s)}var c=new en,g=new _c(this.manager);g.setCrossOrigin(this.crossOrigin),g.setPath(this.path);var p=0;for(i=0;i<t.length;++i)f(i);return c}}),bf.prototype=ut(at(si.prototype),{constructor:bf,load:function(t,r,i,s){var f=new Pt,c=new _c(this.manager);return c.setCrossOrigin(this.crossOrigin),c.setPath(this.path),c.load(t,function(g){f.image=g,g=0<t.search(/\.jpe?g($|\?)/i)||t.search(/^data:image\/jpeg/)===0,f.format=g?1022:1023,f.needsUpdate=!0,r!==void 0&&r(f)},i,s),f}}),ut(Vr.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,r){return t=this.getUtoTmapping(t),this.getPoint(t,r)},getPoints:function(t){t===void 0&&(t=5);for(var r=[],i=0;i<=t;i++)r.push(this.getPoint(i/t));return r},getSpacedPoints:function(t){t===void 0&&(t=5);for(var r=[],i=0;i<=t;i++)r.push(this.getPointAt(i/t));return r},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(t===void 0&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var r=[],i=this.getPoint(0),s,f=0;for(r.push(0),s=1;s<=t;s++){var c=this.getPoint(s/t);f+=c.distanceTo(i),r.push(f),i=c}return this.cacheArcLengths=r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,r){var i=this.getLengths(),s=i.length;r=r||t*i[s-1];for(var f=0,c=s-1,g;f<=c;)if(t=Math.floor(f+(c-f)/2),g=i[t]-r,0>g)f=t+1;else if(0<g)c=t-1;else{c=t;break}return t=c,i[t]===r?t/(s-1):(f=i[t],(t+(r-f)/(i[t+1]-f))/(s-1))},getTangent:function(t,r){var i=t-1e-4;return t+=1e-4,0>i&&(i=0),1<t&&(t=1),i=this.getPoint(i),t=this.getPoint(t),r=r||(i.isVector2?new st:new lt),r.copy(t).sub(i).normalize(),r},getTangentAt:function(t,r){return t=this.getUtoTmapping(t),this.getTangent(t,r)},computeFrenetFrames:function(t,r){var i=new lt,s=[],f=[],c=[],g=new lt,p=new ye,A;for(A=0;A<=t;A++){var S=A/t;s[A]=this.getTangentAt(S,new lt),s[A].normalize()}f[0]=new lt,c[0]=new lt,A=Number.MAX_VALUE,S=Math.abs(s[0].x);var N=Math.abs(s[0].y),_=Math.abs(s[0].z);for(S<=A&&(A=S,i.set(1,0,0)),N<=A&&(A=N,i.set(0,1,0)),_<=A&&i.set(0,0,1),g.crossVectors(s[0],i).normalize(),f[0].crossVectors(s[0],g),c[0].crossVectors(s[0],f[0]),A=1;A<=t;A++)f[A]=f[A-1].clone(),c[A]=c[A-1].clone(),g.crossVectors(s[A-1],s[A]),g.length()>Dn&&(g.normalize(),i=Math.acos(Ar.clamp(s[A-1].dot(s[A]),-1,1)),f[A].applyMatrix4(p.makeRotationAxis(g,i))),c[A].crossVectors(s[A],f[A]);if(r===!0)for(i=Math.acos(Ar.clamp(f[0].dot(f[t]),-1,1)),i/=t,0<s[0].dot(g.crossVectors(f[0],f[t]))&&(i=-i),A=1;A<=t;A++)f[A].applyMatrix4(p.makeRotationAxis(s[A],i*A)),c[A].crossVectors(s[A],f[A]);return{tangents:s,normals:f,binormals:c}},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),ca.prototype=at(Vr.prototype),ca.prototype.constructor=ca,ca.prototype.isEllipseCurve=!0,ca.prototype.getPoint=function(t,r){r=r||new st;for(var i=2*Math.PI,s=this.aEndAngle-this.aStartAngle,f=Math.abs(s)<Dn;0>s;)s+=i;for(;s>i;)s-=i;s<Dn&&(s=f?0:i),this.aClockwise!==!0||f||(s=s===i?-i:s-i),i=this.aStartAngle+t*s,t=this.aX+this.xRadius*Math.cos(i);var c=this.aY+this.yRadius*Math.sin(i);return this.aRotation!==0&&(i=Math.cos(this.aRotation),s=Math.sin(this.aRotation),f=t-this.aX,c-=this.aY,t=f*i-c*s+this.aX,c=f*s+c*i+this.aY),r.set(t,c)},ca.prototype.copy=function(t){return Vr.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},ca.prototype.toJSON=function(){var t=Vr.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},ca.prototype.fromJSON=function(t){return Vr.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Vf.prototype=at(ca.prototype),Vf.prototype.constructor=Vf,Vf.prototype.isArcCurve=!0;var fy=new lt,bA=new Rr,VA=new Rr,WA=new Rr;ss.prototype=at(Vr.prototype),ss.prototype.constructor=ss,ss.prototype.isCatmullRomCurve3=!0,ss.prototype.getPoint=function(t,r){r=r||new lt;var i=this.points,s=i.length;t*=s-(this.closed?0:1);var f=Math.floor(t);if(t-=f,this.closed?f+=0<f?0:(Math.floor(Math.abs(f)/s)+1)*s:t===0&&f===s-1&&(f=s-2,t=1),this.closed||0<f)var c=i[(f-1)%s];else fy.subVectors(i[0],i[1]).add(i[0]),c=fy;var g=i[f%s],p=i[(f+1)%s];if(this.closed||f+2<s?i=i[(f+2)%s]:(fy.subVectors(i[s-1],i[s-2]).add(i[s-1]),i=fy),this.curveType==="centripetal"||this.curveType==="chordal"){var A=this.curveType==="chordal"?.5:.25;s=Math.pow(c.distanceToSquared(g),A),f=Math.pow(g.distanceToSquared(p),A),A=Math.pow(p.distanceToSquared(i),A),1e-4>f&&(f=1),1e-4>s&&(s=f),1e-4>A&&(A=f),bA.initNonuniformCatmullRom(c.x,g.x,p.x,i.x,s,f,A),VA.initNonuniformCatmullRom(c.y,g.y,p.y,i.y,s,f,A),WA.initNonuniformCatmullRom(c.z,g.z,p.z,i.z,s,f,A)}else this.curveType==="catmullrom"&&(bA.initCatmullRom(c.x,g.x,p.x,i.x,this.tension),VA.initCatmullRom(c.y,g.y,p.y,i.y,this.tension),WA.initCatmullRom(c.z,g.z,p.z,i.z,this.tension));return r.set(bA.calc(t),VA.calc(t),WA.calc(t)),r},ss.prototype.copy=function(t){Vr.prototype.copy.call(this,t),this.points=[];for(var r=0,i=t.points.length;r<i;r++)this.points.push(t.points[r].clone());return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},ss.prototype.toJSON=function(){var t=Vr.prototype.toJSON.call(this);t.points=[];for(var r=0,i=this.points.length;r<i;r++)t.points.push(this.points[r].toArray());return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},ss.prototype.fromJSON=function(t){Vr.prototype.fromJSON.call(this,t),this.points=[];for(var r=0,i=t.points.length;r<i;r++){var s=t.points[r];this.points.push(new lt().fromArray(s))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},nu.prototype=at(Vr.prototype),nu.prototype.constructor=nu,nu.prototype.isCubicBezierCurve=!0,nu.prototype.getPoint=function(t,r){r=r||new st;var i=this.v0,s=this.v1,f=this.v2,c=this.v3;return r.set(Wf(t,i.x,s.x,f.x,c.x),Wf(t,i.y,s.y,f.y,c.y)),r},nu.prototype.copy=function(t){return Vr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},nu.prototype.toJSON=function(){var t=Vr.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},nu.prototype.fromJSON=function(t){return Vr.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},Zs.prototype=at(Vr.prototype),Zs.prototype.constructor=Zs,Zs.prototype.isCubicBezierCurve3=!0,Zs.prototype.getPoint=function(t,r){r=r||new lt;var i=this.v0,s=this.v1,f=this.v2,c=this.v3;return r.set(Wf(t,i.x,s.x,f.x,c.x),Wf(t,i.y,s.y,f.y,c.y),Wf(t,i.z,s.z,f.z,c.z)),r},Zs.prototype.copy=function(t){return Vr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Zs.prototype.toJSON=function(){var t=Vr.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Zs.prototype.fromJSON=function(t){return Vr.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},Js.prototype=at(Vr.prototype),Js.prototype.constructor=Js,Js.prototype.isLineCurve=!0,Js.prototype.getPoint=function(t,r){return r=r||new st,t===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(t).add(this.v1)),r},Js.prototype.getPointAt=function(t,r){return this.getPoint(t,r)},Js.prototype.getTangent=function(t,r){return t=r||new st,t=t.copy(this.v2).sub(this.v1).normalize()},Js.prototype.copy=function(t){return Vr.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Js.prototype.toJSON=function(){var t=Vr.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Js.prototype.fromJSON=function(t){return Vr.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},fa.prototype=at(Vr.prototype),fa.prototype.constructor=fa,fa.prototype.isLineCurve3=!0,fa.prototype.getPoint=function(t,r){return r=r||new lt,t===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(t).add(this.v1)),r},fa.prototype.getPointAt=function(t,r){return this.getPoint(t,r)},fa.prototype.copy=function(t){return Vr.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},fa.prototype.toJSON=function(){var t=Vr.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},fa.prototype.fromJSON=function(t){return Vr.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},ou.prototype=at(Vr.prototype),ou.prototype.constructor=ou,ou.prototype.isQuadraticBezierCurve=!0,ou.prototype.getPoint=function(t,r){r=r||new st;var i=this.v0,s=this.v1,f=this.v2;return r.set(vl(t,i.x,s.x,f.x),vl(t,i.y,s.y,f.y)),r},ou.prototype.copy=function(t){return Vr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ou.prototype.toJSON=function(){var t=Vr.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ou.prototype.fromJSON=function(t){return Vr.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},qs.prototype=at(Vr.prototype),qs.prototype.constructor=qs,qs.prototype.isQuadraticBezierCurve3=!0,qs.prototype.getPoint=function(t,r){r=r||new lt;var i=this.v0,s=this.v1,f=this.v2;return r.set(vl(t,i.x,s.x,f.x),vl(t,i.y,s.y,f.y),vl(t,i.z,s.z,f.z)),r},qs.prototype.copy=function(t){return Vr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},qs.prototype.toJSON=function(){var t=Vr.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},qs.prototype.fromJSON=function(t){return Vr.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},as.prototype=at(Vr.prototype),as.prototype.constructor=as,as.prototype.isSplineCurve=!0,as.prototype.getPoint=function(t,r){r=r||new st;var i=this.points,s=(i.length-1)*t;t=Math.floor(s),s-=t;var f=i[t===0?t:t-1],c=i[t],g=i[t>i.length-2?i.length-1:t+1];return i=i[t>i.length-3?i.length-1:t+2],r.set(Z0(s,f.x,c.x,g.x,i.x),Z0(s,f.y,c.y,g.y,i.y)),r},as.prototype.copy=function(t){Vr.prototype.copy.call(this,t),this.points=[];for(var r=0,i=t.points.length;r<i;r++)this.points.push(t.points[r].clone());return this},as.prototype.toJSON=function(){var t=Vr.prototype.toJSON.call(this);t.points=[];for(var r=0,i=this.points.length;r<i;r++)t.points.push(this.points[r].toArray());return t},as.prototype.fromJSON=function(t){Vr.prototype.fromJSON.call(this,t),this.points=[];for(var r=0,i=t.points.length;r<i;r++){var s=t.points[r];this.points.push(new st().fromArray(s))}return this};var jA=Rl({__proto__:null,ArcCurve:Vf,CatmullRomCurve3:ss,CubicBezierCurve:nu,CubicBezierCurve3:Zs,EllipseCurve:ca,LineCurve:Js,LineCurve3:fa,QuadraticBezierCurve:ou,QuadraticBezierCurve3:qs,SplineCurve:as});yl.prototype=ut(at(Vr.prototype),{constructor:yl,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),r=this.curves[this.curves.length-1].getPoint(1);t.equals(r)||this.curves.push(new Js(r,t))},getPoint:function(t){var r=t*this.getLength(),i=this.getCurveLengths();for(t=0;t<i.length;){if(i[t]>=r)return r=i[t]-r,t=this.curves[t],i=t.getLength(),t.getPointAt(i===0?0:1-r/i);t++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],r=0,i=0,s=this.curves.length;i<s;i++)r+=this.curves[i].getLength(),t.push(r);return this.cacheLengths=t},getSpacedPoints:function(t){t===void 0&&(t=40);for(var r=[],i=0;i<=t;i++)r.push(this.getPoint(i/t));return this.autoClose&&r.push(r[0]),r},getPoints:function(t){t=t||12;for(var r=[],i,s=0,f=this.curves;s<f.length;s++){var c=f[s];c=c.getPoints(c&&c.isEllipseCurve?2*t:c&&(c.isLineCurve||c.isLineCurve3)?1:c&&c.isSplineCurve?t*c.points.length:t);for(var g=0;g<c.length;g++){var p=c[g];i&&i.equals(p)||(r.push(p),i=p)}}return this.autoClose&&1<r.length&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r},copy:function(t){Vr.prototype.copy.call(this,t),this.curves=[];for(var r=0,i=t.curves.length;r<i;r++)this.curves.push(t.curves[r].clone());return this.autoClose=t.autoClose,this},toJSON:function(){var t=Vr.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var r=0,i=this.curves.length;r<i;r++)t.curves.push(this.curves[r].toJSON());return t},fromJSON:function(t){Vr.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var r=0,i=t.curves.length;r<i;r++){var s=t.curves[r];this.curves.push(new jA[s.type]().fromJSON(s))}return this}}),Pi.prototype=ut(at(yl.prototype),{constructor:Pi,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var r=1,i=t.length;r<i;r++)this.lineTo(t[r].x,t[r].y);return this},moveTo:function(t,r){return this.currentPoint.set(t,r),this},lineTo:function(t,r){var i=new Js(this.currentPoint.clone(),new st(t,r));return this.curves.push(i),this.currentPoint.set(t,r),this},quadraticCurveTo:function(t,r,i,s){return t=new ou(this.currentPoint.clone(),new st(t,r),new st(i,s)),this.curves.push(t),this.currentPoint.set(i,s),this},bezierCurveTo:function(t,r,i,s,f,c){return t=new nu(this.currentPoint.clone(),new st(t,r),new st(i,s),new st(f,c)),this.curves.push(t),this.currentPoint.set(f,c),this},splineThru:function(t){var r=[this.currentPoint.clone()].concat(t);return r=new as(r),this.curves.push(r),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,r,i,s,f,c){return this.absarc(t+this.currentPoint.x,r+this.currentPoint.y,i,s,f,c),this},absarc:function(t,r,i,s,f,c){return this.absellipse(t,r,i,i,s,f,c),this},ellipse:function(t,r,i,s,f,c,g,p){return this.absellipse(t+this.currentPoint.x,r+this.currentPoint.y,i,s,f,c,g,p),this},absellipse:function(t,r,i,s,f,c,g,p){return t=new ca(t,r,i,s,f,c,g,p),0<this.curves.length&&(r=t.getPoint(0),r.equals(this.currentPoint)||this.lineTo(r.x,r.y)),this.curves.push(t),t=t.getPoint(1),this.currentPoint.copy(t),this},copy:function(t){return yl.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=yl.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return yl.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),xl.prototype=ut(at(Pi.prototype),{constructor:xl,getPointsHoles:function(t){for(var r=[],i=0,s=this.holes.length;i<s;i++)r[i]=this.holes[i].getPoints(t);return r},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){Pi.prototype.copy.call(this,t),this.holes=[];for(var r=0,i=t.holes.length;r<i;r++)this.holes.push(t.holes[r].clone());return this},toJSON:function(){var t=Pi.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var r=0,i=this.holes.length;r<i;r++)t.holes.push(this.holes[r].toJSON());return t},fromJSON:function(t){Pi.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var r=0,i=t.holes.length;r<i;r++){var s=t.holes[r];this.holes.push(new Pi().fromJSON(s))}return this}}),In.prototype=ut(at(Ce.prototype),{constructor:In,isLight:!0,copy:function(t){return Ce.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){return t=Ce.prototype.toJSON.call(this,t),t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}),Ed.prototype=ut(at(In.prototype),{constructor:Ed,isHemisphereLight:!0,copy:function(t){return In.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),ut(Fa.prototype,{_projScreenMatrix:new ye,_lightPositionWorld:new lt,_lookTarget:new lt,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){var r=this.camera,i=this.matrix,s=this._projScreenMatrix,f=this._lookTarget,c=this._lightPositionWorld;c.setFromMatrixPosition(t.matrixWorld),r.position.copy(c),f.setFromMatrixPosition(t.target.matrixWorld),r.lookAt(f),r.updateMatrixWorld(),s.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(s),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(r.projectionMatrix),i.multiply(r.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var t={};return this.bias!==0&&(t.bias=this.bias),this.radius!==1&&(t.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),Ld.prototype=ut(at(Fa.prototype),{constructor:Ld,isSpotLightShadow:!0,updateMatrices:function(t){var r=this.camera,i=2*Ar.RAD2DEG*t.angle,s=this.mapSize.width/this.mapSize.height,f=t.distance||r.far;(i!==r.fov||s!==r.aspect||f!==r.far)&&(r.fov=i,r.aspect=s,r.far=f,r.updateProjectionMatrix()),Fa.prototype.updateMatrices.call(this,t)}}),jf.prototype=ut(at(In.prototype),{constructor:jf,isSpotLight:!0,copy:function(t){return In.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Pm.prototype=ut(at(Fa.prototype),{constructor:Pm,isPointLightShadow:!0,updateMatrices:function(t,r){r===void 0&&(r=0);var i=this.camera,s=this.matrix,f=this._lightPositionWorld,c=this._lookTarget,g=this._projScreenMatrix;f.setFromMatrixPosition(t.matrixWorld),i.position.copy(f),c.copy(i.position),c.add(this._cubeDirections[r]),i.up.copy(this._cubeUps[r]),i.lookAt(c),i.updateMatrixWorld(),s.makeTranslation(-f.x,-f.y,-f.z),g.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(g)}}),Al.prototype=ut(at(In.prototype),{constructor:Al,isPointLight:!0,copy:function(t){return In.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),Ba.prototype=ut(at(Gr.prototype),{constructor:Ba,isOrthographicCamera:!0,copy:function(t,r){return Gr.prototype.copy.call(this,t,r),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:ut({},t.view),this},setViewOffset:function(t,r,i,s,f,c){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=r,this.view.offsetX=i,this.view.offsetY=s,this.view.width=f,this.view.height=c,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),r=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,s=(this.top+this.bottom)/2,f=i-t;i+=t,t=s+r,r=s-r,this.view!==null&&this.view.enabled&&(s=(this.right-this.left)/this.view.fullWidth/this.zoom,r=(this.top-this.bottom)/this.view.fullHeight/this.zoom,f+=s*this.view.offsetX,i=f+s*this.view.width,t-=r*this.view.offsetY,r=t-r*this.view.height),this.projectionMatrix.makeOrthographic(f,i,t,r,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){return t=Ce.prototype.toJSON.call(this,t),t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=ut({},this.view)),t}}),Dm.prototype=ut(at(Fa.prototype),{constructor:Dm,isDirectionalLightShadow:!0,updateMatrices:function(t){Fa.prototype.updateMatrices.call(this,t)}}),ri.prototype=ut(at(In.prototype),{constructor:ri,isDirectionalLight:!0,copy:function(t){return In.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Om.prototype=ut(at(In.prototype),{constructor:Om,isAmbientLight:!0}),Fm.prototype=ut(at(In.prototype),{constructor:Fm,isRectAreaLight:!0,copy:function(t){return In.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){return t=In.prototype.toJSON.call(this,t),t.object.width=this.width,t.object.height=this.height,t}}),ut(Bm.prototype,{isSphericalHarmonics3:!0,set:function(t){for(var r=0;9>r;r++)this.coefficients[r].copy(t[r]);return this},zero:function(){for(var t=0;9>t;t++)this.coefficients[t].set(0,0,0);return this},getAt:function(t,r){var i=t.x,s=t.y;t=t.z;var f=this.coefficients;return r.copy(f[0]).multiplyScalar(.282095),r.addScaledVector(f[1],.488603*s),r.addScaledVector(f[2],.488603*t),r.addScaledVector(f[3],.488603*i),r.addScaledVector(f[4],1.092548*i*s),r.addScaledVector(f[5],1.092548*s*t),r.addScaledVector(f[6],.315392*(3*t*t-1)),r.addScaledVector(f[7],1.092548*i*t),r.addScaledVector(f[8],.546274*(i*i-s*s)),r},getIrradianceAt:function(t,r){var i=t.x,s=t.y;t=t.z;var f=this.coefficients;return r.copy(f[0]).multiplyScalar(.886227),r.addScaledVector(f[1],1.023328*s),r.addScaledVector(f[2],1.023328*t),r.addScaledVector(f[3],1.023328*i),r.addScaledVector(f[4],.858086*i*s),r.addScaledVector(f[5],.858086*s*t),r.addScaledVector(f[6],.743125*t*t-.247708),r.addScaledVector(f[7],.858086*i*t),r.addScaledVector(f[8],.429043*(i*i-s*s)),r},add:function(t){for(var r=0;9>r;r++)this.coefficients[r].add(t.coefficients[r]);return this},addScaledSH:function(t,r){for(var i=0;9>i;i++)this.coefficients[i].addScaledVector(t.coefficients[i],r);return this},scale:function(t){for(var r=0;9>r;r++)this.coefficients[r].multiplyScalar(t);return this},lerp:function(t,r){for(var i=0;9>i;i++)this.coefficients[i].lerp(t.coefficients[i],r);return this},equals:function(t){for(var r=0;9>r;r++)if(!this.coefficients[r].equals(t.coefficients[r]))return!1;return!0},copy:function(t){return this.set(t.coefficients)},clone:function(){return new this.constructor().copy(this)},fromArray:function(t,r){r===void 0&&(r=0);for(var i=this.coefficients,s=0;9>s;s++)i[s].fromArray(t,r+3*s);return this},toArray:function(t,r){t===void 0&&(t=[]),r===void 0&&(r=0);for(var i=this.coefficients,s=0;9>s;s++)i[s].toArray(t,r+3*s);return t}}),ut(Bm,{getBasisAt:function(t,r){var i=t.x,s=t.y;t=t.z,r[0]=.282095,r[1]=.488603*s,r[2]=.488603*t,r[3]=.488603*i,r[4]=1.092548*i*s,r[5]=1.092548*s*t,r[6]=.315392*(3*t*t-1),r[7]=1.092548*i*t,r[8]=.546274*(i*i-s*s)}}),pa.prototype=ut(at(In.prototype),{constructor:pa,isLightProbe:!0,copy:function(t){return In.prototype.copy.call(this,t),this.sh.copy(t.sh),this},fromJSON:function(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this},toJSON:function(t){return t=In.prototype.toJSON.call(this,t),t.object.sh=this.sh.toArray(),t}}),Rd.prototype=ut(at(si.prototype),{constructor:Rd,load:function(t,r,i,s){var f=this,c=new Ms(f.manager);c.setPath(f.path),c.load(t,function(g){try{r(f.parse(JSON.parse(g)))}catch(p){s?s(p):console.error(p),f.manager.itemError(t)}},i,s)},parse:function(t){function r(p){return i[p]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",p),i[p]}var i=this.textures,s=new pC[t.type];if(t.uuid!==void 0&&(s.uuid=t.uuid),t.name!==void 0&&(s.name=t.name),t.color!==void 0&&s.color.setHex(t.color),t.roughness!==void 0&&(s.roughness=t.roughness),t.metalness!==void 0&&(s.metalness=t.metalness),t.sheen!==void 0&&(s.sheen=new Ue().setHex(t.sheen)),t.emissive!==void 0&&s.emissive.setHex(t.emissive),t.specular!==void 0&&s.specular.setHex(t.specular),t.shininess!==void 0&&(s.shininess=t.shininess),t.clearcoat!==void 0&&(s.clearcoat=t.clearcoat),t.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=t.clearcoatRoughness),t.fog!==void 0&&(s.fog=t.fog),t.flatShading!==void 0&&(s.flatShading=t.flatShading),t.blending!==void 0&&(s.blending=t.blending),t.combine!==void 0&&(s.combine=t.combine),t.side!==void 0&&(s.side=t.side),t.opacity!==void 0&&(s.opacity=t.opacity),t.transparent!==void 0&&(s.transparent=t.transparent),t.alphaTest!==void 0&&(s.alphaTest=t.alphaTest),t.depthTest!==void 0&&(s.depthTest=t.depthTest),t.depthWrite!==void 0&&(s.depthWrite=t.depthWrite),t.colorWrite!==void 0&&(s.colorWrite=t.colorWrite),t.stencilWrite!==void 0&&(s.stencilWrite=t.stencilWrite),t.stencilWriteMask!==void 0&&(s.stencilWriteMask=t.stencilWriteMask),t.stencilFunc!==void 0&&(s.stencilFunc=t.stencilFunc),t.stencilRef!==void 0&&(s.stencilRef=t.stencilRef),t.stencilFuncMask!==void 0&&(s.stencilFuncMask=t.stencilFuncMask),t.stencilFail!==void 0&&(s.stencilFail=t.stencilFail),t.stencilZFail!==void 0&&(s.stencilZFail=t.stencilZFail),t.stencilZPass!==void 0&&(s.stencilZPass=t.stencilZPass),t.wireframe!==void 0&&(s.wireframe=t.wireframe),t.wireframeLinewidth!==void 0&&(s.wireframeLinewidth=t.wireframeLinewidth),t.wireframeLinecap!==void 0&&(s.wireframeLinecap=t.wireframeLinecap),t.wireframeLinejoin!==void 0&&(s.wireframeLinejoin=t.wireframeLinejoin),t.rotation!==void 0&&(s.rotation=t.rotation),t.linewidth!==1&&(s.linewidth=t.linewidth),t.dashSize!==void 0&&(s.dashSize=t.dashSize),t.gapSize!==void 0&&(s.gapSize=t.gapSize),t.scale!==void 0&&(s.scale=t.scale),t.polygonOffset!==void 0&&(s.polygonOffset=t.polygonOffset),t.polygonOffsetFactor!==void 0&&(s.polygonOffsetFactor=t.polygonOffsetFactor),t.polygonOffsetUnits!==void 0&&(s.polygonOffsetUnits=t.polygonOffsetUnits),t.skinning!==void 0&&(s.skinning=t.skinning),t.morphTargets!==void 0&&(s.morphTargets=t.morphTargets),t.morphNormals!==void 0&&(s.morphNormals=t.morphNormals),t.dithering!==void 0&&(s.dithering=t.dithering),t.vertexTangents!==void 0&&(s.vertexTangents=t.vertexTangents),t.visible!==void 0&&(s.visible=t.visible),t.toneMapped!==void 0&&(s.toneMapped=t.toneMapped),t.userData!==void 0&&(s.userData=t.userData),t.vertexColors!==void 0&&(s.vertexColors=typeof t.vertexColors=="number"?0<t.vertexColors:t.vertexColors),t.uniforms!==void 0)for(var f in t.uniforms){var c=t.uniforms[f];switch(s.uniforms[f]={},c.type){case"t":s.uniforms[f].value=r(c.value);break;case"c":s.uniforms[f].value=new Ue().setHex(c.value);break;case"v2":s.uniforms[f].value=new st().fromArray(c.value);break;case"v3":s.uniforms[f].value=new lt().fromArray(c.value);break;case"v4":s.uniforms[f].value=new It().fromArray(c.value);break;case"m3":s.uniforms[f].value=new Ft().fromArray(c.value);case"m4":s.uniforms[f].value=new ye().fromArray(c.value);break;default:s.uniforms[f].value=c.value}}if(t.defines!==void 0&&(s.defines=t.defines),t.vertexShader!==void 0&&(s.vertexShader=t.vertexShader),t.fragmentShader!==void 0&&(s.fragmentShader=t.fragmentShader),t.extensions!==void 0)for(var g in t.extensions)s.extensions[g]=t.extensions[g];return t.shading!==void 0&&(s.flatShading=t.shading===1),t.size!==void 0&&(s.size=t.size),t.sizeAttenuation!==void 0&&(s.sizeAttenuation=t.sizeAttenuation),t.map!==void 0&&(s.map=r(t.map)),t.matcap!==void 0&&(s.matcap=r(t.matcap)),t.alphaMap!==void 0&&(s.alphaMap=r(t.alphaMap)),t.bumpMap!==void 0&&(s.bumpMap=r(t.bumpMap)),t.bumpScale!==void 0&&(s.bumpScale=t.bumpScale),t.normalMap!==void 0&&(s.normalMap=r(t.normalMap)),t.normalMapType!==void 0&&(s.normalMapType=t.normalMapType),t.normalScale!==void 0&&(f=t.normalScale,Array.isArray(f)===!1&&(f=[f,f]),s.normalScale=new st().fromArray(f)),t.displacementMap!==void 0&&(s.displacementMap=r(t.displacementMap)),t.displacementScale!==void 0&&(s.displacementScale=t.displacementScale),t.displacementBias!==void 0&&(s.displacementBias=t.displacementBias),t.roughnessMap!==void 0&&(s.roughnessMap=r(t.roughnessMap)),t.metalnessMap!==void 0&&(s.metalnessMap=r(t.metalnessMap)),t.emissiveMap!==void 0&&(s.emissiveMap=r(t.emissiveMap)),t.emissiveIntensity!==void 0&&(s.emissiveIntensity=t.emissiveIntensity),t.specularMap!==void 0&&(s.specularMap=r(t.specularMap)),t.envMap!==void 0&&(s.envMap=r(t.envMap)),t.envMapIntensity!==void 0&&(s.envMapIntensity=t.envMapIntensity),t.reflectivity!==void 0&&(s.reflectivity=t.reflectivity),t.refractionRatio!==void 0&&(s.refractionRatio=t.refractionRatio),t.lightMap!==void 0&&(s.lightMap=r(t.lightMap)),t.lightMapIntensity!==void 0&&(s.lightMapIntensity=t.lightMapIntensity),t.aoMap!==void 0&&(s.aoMap=r(t.aoMap)),t.aoMapIntensity!==void 0&&(s.aoMapIntensity=t.aoMapIntensity),t.gradientMap!==void 0&&(s.gradientMap=r(t.gradientMap)),t.clearcoatMap!==void 0&&(s.clearcoatMap=r(t.clearcoatMap)),t.clearcoatRoughnessMap!==void 0&&(s.clearcoatRoughnessMap=r(t.clearcoatRoughnessMap)),t.clearcoatNormalMap!==void 0&&(s.clearcoatNormalMap=r(t.clearcoatNormalMap)),t.clearcoatNormalScale!==void 0&&(s.clearcoatNormalScale=new st().fromArray(t.clearcoatNormalScale)),s},setTextures:function(t){return this.textures=t,this}});var Zc={decodeText:function(t){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(t);for(var r="",i=0,s=t.length;i<s;i++)r+=String.fromCharCode(t[i]);try{return decodeURIComponent(escape(r))}catch(f){return r}},extractUrlBase:function(t){var r=t.lastIndexOf("/");return r===-1?"./":t.substr(0,r+1)}};Pd.prototype=ut(at(Ge.prototype),{constructor:Pd,isInstancedBufferGeometry:!0,copy:function(t){return Ge.prototype.copy.call(this,t),this.instanceCount=t.instanceCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var t=Ge.prototype.toJSON.call(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}),Nm.prototype=ut(at(Ir.prototype),{constructor:Nm,isInstancedBufferAttribute:!0,copy:function(t){return Ir.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){var t=Ir.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}),Ah.prototype=ut(at(si.prototype),{constructor:Ah,load:function(t,r,i,s){var f=this,c=new Ms(f.manager);c.setPath(f.path),c.load(t,function(g){try{r(f.parse(JSON.parse(g)))}catch(p){s?s(p):console.error(p),f.manager.itemError(t)}},i,s)},parse:function(t){var r=t.isInstancedBufferGeometry?new Pd:new Ge,i=t.data.index;if(i!==void 0){var s=new XA[i.type](i.array);r.setIndex(new Ir(s,1))}i=t.data.attributes;for(var f in i){var c=i[f];s=new XA[c.type](c.array),s=new(c.isInstancedBufferAttribute?Nm:Ir)(s,c.itemSize,c.normalized),c.name!==void 0&&(s.name=c.name),r.setAttribute(f,s)}var g=t.data.morphAttributes;if(g)for(f in g){var p=g[f],A=[];i=0;for(var S=p.length;i<S;i++)c=p[i],s=new XA[c.type](c.array),s=new Ir(s,c.itemSize,c.normalized),c.name!==void 0&&(s.name=c.name),A.push(s);r.morphAttributes[f]=A}if(t.data.morphTargetsRelative&&(r.morphTargetsRelative=!0),f=t.data.groups||t.data.drawcalls||t.data.offsets,f!==void 0)for(i=0,c=f.length;i!==c;++i)s=f[i],r.addGroup(s.start,s.count,s.materialIndex);return i=t.data.boundingSphere,i!==void 0&&(f=new lt,i.center!==void 0&&f.fromArray(i.center),r.boundingSphere=new Fn(f,i.radius)),t.name&&(r.name=t.name),t.userData&&(r.userData=t.userData),r}});var XA={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray!="undefined"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};Ks.prototype=ut(at(si.prototype),{constructor:Ks,load:function(t,r,i,s){var f=this,c=this.path===""?Zc.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||c,c=new Ms(f.manager),c.setPath(this.path),c.load(t,function(g){var p=null;try{p=JSON.parse(g)}catch(A){s!==void 0&&s(A),console.error("THREE:ObjectLoader: Can't parse "+t+".",A.message);return}g=p.metadata,g===void 0||g.type===void 0||g.type.toLowerCase()==="geometry"?console.error("THREE.ObjectLoader: Can't load "+t):f.parse(p,r)},i,s)},parse:function(t,r){var i=this.parseShape(t.shapes);i=this.parseGeometries(t.geometries,i);var s=this.parseImages(t.images,function(){r!==void 0&&r(f)});s=this.parseTextures(t.textures,s),s=this.parseMaterials(t.materials,s);var f=this.parseObject(t.object,i,s);return t.animations&&(f.animations=this.parseAnimations(t.animations)),t.images!==void 0&&t.images.length!==0||r===void 0||r(f),f},parseShape:function(t){var r={};if(t!==void 0)for(var i=0,s=t.length;i<s;i++){var f=new xl().fromJSON(t[i]);r[f.uuid]=f}return r},parseGeometries:function(t,r){var i={};if(t!==void 0)for(var s=new Ah,f=0,c=t.length;f<c;f++){var g=t[f];switch(g.type){case"PlaneGeometry":case"PlaneBufferGeometry":var p=new $s[g.type](g.width,g.height,g.widthSegments,g.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":p=new $s[g.type](g.width,g.height,g.depth,g.widthSegments,g.heightSegments,g.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":p=new $s[g.type](g.radius,g.segments,g.thetaStart,g.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":p=new $s[g.type](g.radiusTop,g.radiusBottom,g.height,g.radialSegments,g.heightSegments,g.openEnded,g.thetaStart,g.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":p=new $s[g.type](g.radius,g.height,g.radialSegments,g.heightSegments,g.openEnded,g.thetaStart,g.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":p=new $s[g.type](g.radius,g.widthSegments,g.heightSegments,g.phiStart,g.phiLength,g.thetaStart,g.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":p=new $s[g.type](g.radius,g.detail);break;case"RingGeometry":case"RingBufferGeometry":p=new $s[g.type](g.innerRadius,g.outerRadius,g.thetaSegments,g.phiSegments,g.thetaStart,g.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":p=new $s[g.type](g.radius,g.tube,g.radialSegments,g.tubularSegments,g.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":p=new $s[g.type](g.radius,g.tube,g.tubularSegments,g.radialSegments,g.p,g.q);break;case"TubeGeometry":case"TubeBufferGeometry":p=new $s[g.type](new jA[g.path.type]().fromJSON(g.path),g.tubularSegments,g.radius,g.radialSegments,g.closed);break;case"LatheGeometry":case"LatheBufferGeometry":p=new $s[g.type](g.points,g.segments,g.phiStart,g.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":p=new $s[g.type](g.vertices,g.indices,g.radius,g.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":p=[];for(var A=0,S=g.shapes.length;A<S;A++){var N=r[g.shapes[A]];p.push(N)}p=new $s[g.type](p,g.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(p=[],A=0,S=g.shapes.length;A<S;A++)N=r[g.shapes[A]],p.push(N);A=g.options.extrudePath,A!==void 0&&(g.options.extrudePath=new jA[A.type]().fromJSON(A)),p=new $s[g.type](p,g.options);break;case"BufferGeometry":case"InstancedBufferGeometry":p=s.parse(g);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+g.type+'"');continue}p.uuid=g.uuid,g.name!==void 0&&(p.name=g.name),p.isBufferGeometry===!0&&g.userData!==void 0&&(p.userData=g.userData),i[g.uuid]=p}return i},parseMaterials:function(t,r){var i={},s={};if(t!==void 0){var f=new Rd;f.setTextures(r),r=0;for(var c=t.length;r<c;r++){var g=t[r];if(g.type==="MultiMaterial"){for(var p=[],A=0;A<g.materials.length;A++){var S=g.materials[A];i[S.uuid]===void 0&&(i[S.uuid]=f.parse(S)),p.push(i[S.uuid])}s[g.uuid]=p}else i[g.uuid]===void 0&&(i[g.uuid]=f.parse(g)),s[g.uuid]=i[g.uuid]}}return s},parseAnimations:function(t){for(var r=[],i=0;i<t.length;i++){var s=t[i],f=ha.parse(s);s.uuid!==void 0&&(f.uuid=s.uuid),r.push(f)}return r},parseImages:function(t,r){function i(I){return s.manager.itemStart(I),c.load(I,function(){s.manager.itemEnd(I)},void 0,function(){s.manager.itemError(I),s.manager.itemEnd(I)})}var s=this,f={};if(t!==void 0&&0<t.length){r=new xh(r);var c=new _c(r);c.setCrossOrigin(this.crossOrigin),r=0;for(var g=t.length;r<g;r++){var p=t[r],A=p.url;if(Array.isArray(A)){f[p.uuid]=[];for(var S=0,N=A.length;S<N;S++){var _=A[S];_=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(_)?_:s.resourcePath+_,f[p.uuid].push(i(_))}}else _=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(p.url)?p.url:s.resourcePath+p.url,f[p.uuid]=i(_)}}return f},parseTextures:function(t,r){function i(A,S){return typeof A=="number"?A:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",A),S[A])}var s={};if(t!==void 0)for(var f=0,c=t.length;f<c;f++){var g=t[f];g.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',g.uuid),r[g.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",g.image);var p=Array.isArray(r[g.image])?new en(r[g.image]):new Pt(r[g.image]);p.needsUpdate=!0,p.uuid=g.uuid,g.name!==void 0&&(p.name=g.name),g.mapping!==void 0&&(p.mapping=i(g.mapping,dC)),g.offset!==void 0&&p.offset.fromArray(g.offset),g.repeat!==void 0&&p.repeat.fromArray(g.repeat),g.center!==void 0&&p.center.fromArray(g.center),g.rotation!==void 0&&(p.rotation=g.rotation),g.wrap!==void 0&&(p.wrapS=i(g.wrap[0],Xw),p.wrapT=i(g.wrap[1],Xw)),g.format!==void 0&&(p.format=g.format),g.type!==void 0&&(p.type=g.type),g.encoding!==void 0&&(p.encoding=g.encoding),g.minFilter!==void 0&&(p.minFilter=i(g.minFilter,Yw)),g.magFilter!==void 0&&(p.magFilter=i(g.magFilter,Yw)),g.anisotropy!==void 0&&(p.anisotropy=g.anisotropy),g.flipY!==void 0&&(p.flipY=g.flipY),g.premultiplyAlpha!==void 0&&(p.premultiplyAlpha=g.premultiplyAlpha),g.unpackAlignment!==void 0&&(p.unpackAlignment=g.unpackAlignment),s[g.uuid]=p}return s},parseObject:function(t,r,i){function s(S){return r[S]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",S),r[S]}function f(S){if(S!==void 0){if(Array.isArray(S)){for(var N=[],_=0,I=S.length;_<I;_++){var L=S[_];i[L]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",L),N.push(i[L])}return N}return i[S]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",S),i[S]}}switch(t.type){case"Scene":var c=new ti;t.background!==void 0&&kc(t.background)&&(c.background=new Ue(t.background)),t.fog!==void 0&&(t.fog.type==="Fog"?c.fog=new xs(t.fog.color,t.fog.near,t.fog.far):t.fog.type==="FogExp2"&&(c.fog=new ru(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":c=new Cr(t.fov,t.aspect,t.near,t.far),t.focus!==void 0&&(c.focus=t.focus),t.zoom!==void 0&&(c.zoom=t.zoom),t.filmGauge!==void 0&&(c.filmGauge=t.filmGauge),t.filmOffset!==void 0&&(c.filmOffset=t.filmOffset),t.view!==void 0&&(c.view=ut({},t.view));break;case"OrthographicCamera":c=new Ba(t.left,t.right,t.top,t.bottom,t.near,t.far),t.zoom!==void 0&&(c.zoom=t.zoom),t.view!==void 0&&(c.view=ut({},t.view));break;case"AmbientLight":c=new Om(t.color,t.intensity);break;case"DirectionalLight":c=new ri(t.color,t.intensity);break;case"PointLight":c=new Al(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":c=new Fm(t.color,t.intensity,t.width,t.height);break;case"SpotLight":c=new jf(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":c=new Ed(t.color,t.groundColor,t.intensity);break;case"LightProbe":c=new pa().fromJSON(t);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":c=s(t.geometry);var g=f(t.material);c=new dn(c,g);break;case"InstancedMesh":c=s(t.geometry),g=f(t.material);var p=t.instanceMatrix;c=new Sr(c,g,t.count),c.instanceMatrix=new Ir(new Float32Array(p.array),16);break;case"LOD":c=new Zo;break;case"Line":c=new js(s(t.geometry),f(t.material),t.mode);break;case"LineLoop":c=new Un(s(t.geometry),f(t.material));break;case"LineSegments":c=new zn(s(t.geometry),f(t.material));break;case"PointCloud":case"Points":c=new Cu(s(t.geometry),f(t.material));break;case"Sprite":c=new ah(f(t.material));break;case"Group":c=new ys;break;default:c=new Ce}if(c.uuid=t.uuid,t.name!==void 0&&(c.name=t.name),t.matrix!==void 0?(c.matrix.fromArray(t.matrix),t.matrixAutoUpdate!==void 0&&(c.matrixAutoUpdate=t.matrixAutoUpdate),c.matrixAutoUpdate&&c.matrix.decompose(c.position,c.quaternion,c.scale)):(t.position!==void 0&&c.position.fromArray(t.position),t.rotation!==void 0&&c.rotation.fromArray(t.rotation),t.quaternion!==void 0&&c.quaternion.fromArray(t.quaternion),t.scale!==void 0&&c.scale.fromArray(t.scale)),t.castShadow!==void 0&&(c.castShadow=t.castShadow),t.receiveShadow!==void 0&&(c.receiveShadow=t.receiveShadow),t.shadow&&(t.shadow.bias!==void 0&&(c.shadow.bias=t.shadow.bias),t.shadow.radius!==void 0&&(c.shadow.radius=t.shadow.radius),t.shadow.mapSize!==void 0&&c.shadow.mapSize.fromArray(t.shadow.mapSize),t.shadow.camera!==void 0&&(c.shadow.camera=this.parseObject(t.shadow.camera))),t.visible!==void 0&&(c.visible=t.visible),t.frustumCulled!==void 0&&(c.frustumCulled=t.frustumCulled),t.renderOrder!==void 0&&(c.renderOrder=t.renderOrder),t.userData!==void 0&&(c.userData=t.userData),t.layers!==void 0&&(c.layers.mask=t.layers),t.children!==void 0)for(p=t.children,g=0;g<p.length;g++)c.add(this.parseObject(p[g],r,i));if(t.type==="LOD")for(t.autoUpdate!==void 0&&(c.autoUpdate=t.autoUpdate),t=t.levels,p=0;p<t.length;p++){g=t[p];var A=c.getObjectByProperty("uuid",g.object);A!==void 0&&c.addLevel(A,g.distance)}return c}});var dC={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},Xw={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},Yw={NearestFilter:1003,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:1005,LinearFilter:1006,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:1008};J0.prototype=ut(at(si.prototype),{constructor:J0,setOptions:function(t){return this.options=t,this},load:function(t,r,i,s){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);var f=this,c=Sg.get(t);if(c!==void 0)return f.manager.itemStart(t),setTimeout(function(){r&&r(c),f.manager.itemEnd(t)},0),c;fetch(t).then(function(g){return g.blob()}).then(function(g){return f.options===void 0?createImageBitmap(g):createImageBitmap(g,f.options)}).then(function(g){Sg.add(t,g),r&&r(g),f.manager.itemEnd(t)}).catch(function(g){s&&s(g),f.manager.itemError(t),f.manager.itemEnd(t)}),f.manager.itemStart(t)}}),ut(q0.prototype,{moveTo:function(t,r){return this.currentPath=new Pi,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,r),this},lineTo:function(t,r){return this.currentPath.lineTo(t,r),this},quadraticCurveTo:function(t,r,i,s){return this.currentPath.quadraticCurveTo(t,r,i,s),this},bezierCurveTo:function(t,r,i,s,f,c){return this.currentPath.bezierCurveTo(t,r,i,s,f,c),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,r){function i(W){for(var X=[],Z=0,tt=W.length;Z<tt;Z++){var ot=W[Z],xt=new xl;xt.curves=ot.curves,X.push(xt)}return X}function s(W,X){for(var Z=X.length,tt=!1,ot=Z-1,xt=0;xt<Z;ot=xt++){var At=X[ot],yt=X[xt],zt=yt.x-At.x,Ht=yt.y-At.y;if(Math.abs(Ht)>Dn){if(0>Ht&&(At=X[xt],zt=-zt,yt=X[ot],Ht=-Ht),!(W.y<At.y||W.y>yt.y))if(W.y===At.y){if(W.x===At.x)return!0}else{if(ot=Ht*(W.x-At.x)-zt*(W.y-At.y),ot===0)return!0;0>ot||(tt=!tt)}}else if(W.y===At.y&&(yt.x<=W.x&&W.x<=At.x||At.x<=W.x&&W.x<=yt.x))return!0}return tt}var f=Yc.isClockWise,c=this.subPaths;if(c.length===0)return[];if(r===!0)return i(c);if(r=[],c.length===1){var g=c[0],p=new xl;return p.curves=g.curves,r.push(p),r}var A=!f(c[0].getPoints());A=t?!A:A,p=[];var S=[],N=[],_=0;S[_]=void 0,N[_]=[];for(var I=0,L=c.length;I<L;I++){g=c[I];var P=g.getPoints(),F=f(P);(F=t?!F:F)?(!A&&S[_]&&_++,S[_]={s:new xl,p:P},S[_].s.curves=g.curves,A&&_++,N[_]=[]):N[_].push({h:g,p:P[0]})}if(!S[0])return i(c);if(1<S.length){for(I=!1,t=[],f=0,c=S.length;f<c;f++)p[f]=[];for(f=0,c=S.length;f<c;f++)for(g=N[f],F=0;F<g.length;F++){for(A=g[F],_=!0,P=0;P<S.length;P++)s(A.p,S[P].p)&&(f!==P&&t.push({froms:f,tos:P,hole:F}),_?(_=!1,p[P].push(A)):I=!0);_&&p[f].push(A)}0<t.length&&(I||(N=p))}for(I=0,f=S.length;I<f;I++)for(p=S[I].s,r.push(p),t=N[I],c=0,g=t.length;c<g;c++)p.holes.push(t[c].h);return r}}),ut(K0.prototype,{isFont:!0,generateShapes:function(t,r){r===void 0&&(r=100);var i=[],s=r;r=this.data;var f=ep?ep(t):String(t).split("");s/=r.resolution;var c=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*s;t=[];for(var g=0,p=0,A=0;A<f.length;A++){var S=f[A];if(S===`
`)g=0,p-=c;else{var N=S;S=s;var _=g,I=p,L=r,P=L.glyphs[N]||L.glyphs["?"];if(P){if(N=new q0,P.o){L=P._cachedOutline||(P._cachedOutline=P.o.split(" "));for(var F=0,W=L.length;F<W;)switch(L[F++]){case"m":var X=L[F++]*S+_,Z=L[F++]*S+I;N.moveTo(X,Z);break;case"l":X=L[F++]*S+_,Z=L[F++]*S+I,N.lineTo(X,Z);break;case"q":var tt=L[F++]*S+_,ot=L[F++]*S+I,xt=L[F++]*S+_,At=L[F++]*S+I;N.quadraticCurveTo(xt,At,tt,ot);break;case"b":tt=L[F++]*S+_,ot=L[F++]*S+I,xt=L[F++]*S+_,At=L[F++]*S+I,X=L[F++]*S+_,Z=L[F++]*S+I,N.bezierCurveTo(xt,At,X,Z,tt,ot)}}S={offsetX:P.ha*S,path:N}}else console.error('THREE.Font: character "'+N+'" does not exists in font family '+L.familyName+"."),S=void 0;g+=S.offsetX,t.push(S.path)}}for(r=0,f=t.length;r<f;r++)Array.prototype.push.apply(i,t[r].toShapes());return i}}),Mc.prototype=ut(at(si.prototype),{constructor:Mc,load:function(t,r,i,s){var f=this,c=new Ms(this.manager);c.setPath(this.path),c.load(t,function(g){try{var p=JSON.parse(g)}catch(A){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),p=JSON.parse(g.substring(65,g.length-2))}g=f.parse(p),r&&r(g)},i,s)},parse:function(t){return new K0(t)}});var py,Zw={getContext:function(){return py===void 0&&(py=new(window.AudioContext||window.webkitAudioContext)),py},setContext:function(t){py=t}};Gn.prototype=ut(at(si.prototype),{constructor:Gn,load:function(t,r,i,s){var f=this,c=new Ms(f.manager);c.setResponseType("arraybuffer"),c.setPath(f.path),c.load(t,function(g){try{var p=g.slice(0);Zw.getContext().decodeAudioData(p,function(A){r(A)})}catch(A){s?s(A):console.error(A),f.manager.itemError(t)}},i,s)}}),Cc.prototype=ut(at(pa.prototype),{constructor:Cc,isHemisphereLightProbe:!0,copy:function(t){return pa.prototype.copy.call(this,t),this},toJSON:function(t){return pa.prototype.toJSON.call(this,t)}}),Tc.prototype=ut(at(pa.prototype),{constructor:Tc,isAmbientLightProbe:!0,copy:function(t){return pa.prototype.copy.call(this,t),this},toJSON:function(t){return pa.prototype.toJSON.call(this,t)}});var Jw=new ye,qw=new ye;ut(function(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Cr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Cr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}.prototype,{update:function(t){var r=this._cache;if(r.focus!==t.focus||r.fov!==t.fov||r.aspect!==t.aspect*this.aspect||r.near!==t.near||r.far!==t.far||r.zoom!==t.zoom||r.eyeSep!==this.eyeSep){r.focus=t.focus,r.fov=t.fov,r.aspect=t.aspect*this.aspect,r.near=t.near,r.far=t.far,r.zoom=t.zoom,r.eyeSep=this.eyeSep;var i=t.projectionMatrix.clone(),s=r.eyeSep/2,f=s*r.near/r.focus,c=r.near*Math.tan(Ar.DEG2RAD*r.fov*.5)/r.zoom;qw.elements[12]=-s,Jw.elements[12]=s,s=-c*r.aspect+f;var g=c*r.aspect+f;i.elements[0]=2*r.near/(g-s),i.elements[8]=(g+s)/(g-s),this.cameraL.projectionMatrix.copy(i),s=-c*r.aspect-f,g=c*r.aspect-f,i.elements[0]=2*r.near/(g-s),i.elements[8]=(g+s)/(g-s),this.cameraR.projectionMatrix.copy(i)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(qw),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(Jw)}}),ut(Eu.prototype,{start:function(){this.oldTime=this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.autoStart=this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var r=(typeof performance=="undefined"?Date:performance).now();t=(r-this.oldTime)/1e3,this.oldTime=r,this.elapsedTime+=t}return t}});var wp=new lt,Kw=new he,gC=new lt,_p=new lt;Q0.prototype=ut(at(Ce.prototype),{constructor:Q0,getInput:function(){return this.gain},removeFilter:function(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(t){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},updateMatrixWorld:function(t){Ce.prototype.updateMatrixWorld.call(this,t),t=this.context.listener;var r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(wp,Kw,gC),_p.set(0,0,-1).applyQuaternion(Kw),t.positionX){var i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(wp.x,i),t.positionY.linearRampToValueAtTime(wp.y,i),t.positionZ.linearRampToValueAtTime(wp.z,i),t.forwardX.linearRampToValueAtTime(_p.x,i),t.forwardY.linearRampToValueAtTime(_p.y,i),t.forwardZ.linearRampToValueAtTime(_p.z,i),t.upX.linearRampToValueAtTime(r.x,i),t.upY.linearRampToValueAtTime(r.y,i),t.upZ.linearRampToValueAtTime(r.z,i)}else t.setPosition(wp.x,wp.y,wp.z),t.setOrientation(_p.x,_p.y,_p.z,r.x,r.y,r.z)}}),su.prototype=ut(at(Ce.prototype),{constructor:su,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setMediaElementSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},setMediaStreamSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(t){if(t===void 0&&(t=0),this.isPlaying===!0)console.warn("THREE.Audio: Audio is already playing.");else if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this._startedAt=this.context.currentTime+t,t=this.context.createBufferSource(),t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},pause:function(){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress%=this.duration||this.buffer.duration),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this},stop:function(){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var t=1,r=this.filters.length;t<r;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var t=1,r=this.filters.length;t<r;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),this.isPlaying===!0?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},setDetune:function(t){if(this.detune=t,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this.playbackRate=t,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this.loop=t,this.isPlaying===!0&&(this.source.loop=this.loop),this},setLoopStart:function(t){return this.loopStart=t,this},setLoopEnd:function(t){return this.loopEnd=t,this},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}});var Mp=new lt,Qw=new he,mC=new lt,Cp=new lt;Cs.prototype=ut(at(su.prototype),{constructor:Cs,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){return this.panner.refDistance=t,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){return this.panner.rolloffFactor=t,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){return this.panner.distanceModel=t,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){return this.panner.maxDistance=t,this},setDirectionalCone:function(t,r,i){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=r,this.panner.coneOuterGain=i,this},updateMatrixWorld:function(t){if(Ce.prototype.updateMatrixWorld.call(this,t),this.hasPlaybackControl!==!0||this.isPlaying!==!1)if(this.matrixWorld.decompose(Mp,Qw,mC),Cp.set(0,0,1).applyQuaternion(Qw),t=this.panner,t.positionX){var r=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Mp.x,r),t.positionY.linearRampToValueAtTime(Mp.y,r),t.positionZ.linearRampToValueAtTime(Mp.z,r),t.orientationX.linearRampToValueAtTime(Cp.x,r),t.orientationY.linearRampToValueAtTime(Cp.y,r),t.orientationZ.linearRampToValueAtTime(Cp.z,r)}else t.setPosition(Mp.x,Mp.y,Mp.z),t.setOrientation(Cp.x,Cp.y,Cp.z)}}),ut(Dd.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,r=this.getFrequencyData(),i=0;i<r.length;i++)t+=r[i];return t/r.length}}),ut(zm.prototype,{accumulate:function(t,r){var i=this.buffer,s=this.valueSize;t=t*s+s;var f=this.cumulativeWeight;if(f===0){for(f=0;f!==s;++f)i[t+f]=i[f];f=r}else f+=r,this._mixBufferRegion(i,t,0,r/f,s);this.cumulativeWeight=f},accumulateAdditive:function(t){var r=this.buffer,i=this.valueSize,s=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(r,s,0,t,i),this.cumulativeWeightAdditive+=t},apply:function(t){var r=this.valueSize,i=this.buffer;t=t*r+r;var s=this.cumulativeWeight,f=this.cumulativeWeightAdditive,c=this.binding;for(this.cumulativeWeightAdditive=this.cumulativeWeight=0,1>s&&this._mixBufferRegion(i,t,r*this._origIndex,1-s,r),0<f&&this._mixBufferRegionAdditive(i,t,this._addIndex*r,1,r),s=r,f=r+r;s!==f;++s)if(i[s]!==i[s+r]){c.setValue(i,t);break}},saveOriginalState:function(){var t=this.buffer,r=this.valueSize,i=r*this._origIndex;this.binding.getValue(t,i);for(var s=r;s!==i;++s)t[s]=t[i+s%r];this._setIdentity(),this.cumulativeWeightAdditive=this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_setAdditiveIdentityNumeric:function(){for(var t=this._addIndex*this.valueSize,r=t+this.valueSize;t<r;t++)this.buffer[t]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[4*this._addIndex+3]=1},_setAdditiveIdentityOther:function(){for(var t=this._origIndex*this.valueSize,r=this._addIndex*this.valueSize,i=0;i<this.valueSize;i++)this.buffer[r+i]=this.buffer[t+i]},_select:function(t,r,i,s,f){if(.5<=s)for(s=0;s!==f;++s)t[r+s]=t[i+s]},_slerp:function(t,r,i,s){he.slerpFlat(t,r,t,r,t,i,s)},_slerpAdditive:function(t,r,i,s,f){f*=this._workIndex,he.multiplyQuaternionsFlat(t,f,t,r,t,i),he.slerpFlat(t,r,t,r,t,f,s)},_lerp:function(t,r,i,s,f){for(var c=1-s,g=0;g!==f;++g){var p=r+g;t[p]=t[p]*c+t[i+g]*s}},_lerpAdditive:function(t,r,i,s,f){for(var c=0;c!==f;++c){var g=r+c;t[g]+=t[i+c]*s}}});var vC=/[\[\]\.:\/]/g,yC="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",xC=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),AC=/(WCOD+)?/.source.replace("WCOD",yC),wC=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),_C=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),MC=new RegExp("^"+xC+AC+wC+_C+"$"),CC=["material","materials","bones"];ut(Od.prototype,{getValue:function(t,r){this.bind();var i=this._bindings[this._targetGroup.nCachedObjects_];i!==void 0&&i.getValue(t,r)},setValue:function(t,r){for(var i=this._bindings,s=this._targetGroup.nCachedObjects_,f=i.length;s!==f;++s)i[s].setValue(t,r)},bind:function(){for(var t=this._bindings,r=this._targetGroup.nCachedObjects_,i=t.length;r!==i;++r)t[r].bind()},unbind:function(){for(var t=this._bindings,r=this._targetGroup.nCachedObjects_,i=t.length;r!==i;++r)t[r].unbind()}}),ut(wo,{Composite:Od,create:function(t,r,i){return t&&t.isAnimationObjectGroup?new wo.Composite(t,r,i):new wo(t,r,i)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(vC,"")},parseTrackName:function(t){var r=MC.exec(t);if(!r)throw Error("PropertyBinding: Cannot parse trackName: "+t);r={nodeName:r[2],objectName:r[3],objectIndex:r[4],propertyName:r[5],propertyIndex:r[6]};var i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){var s=r.nodeName.substring(i+1);CC.indexOf(s)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=s)}if(r.propertyName===null||r.propertyName.length===0)throw Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r},findNode:function(t,r){if(!r||r===""||r==="."||r===-1||r===t.name||r===t.uuid)return t;if(t.skeleton){var i=t.skeleton.getBoneByName(r);if(i!==void 0)return i}return t.children&&(t=function s(f){for(var c=0;c<f.length;c++){var g=f[c];if(g.name===r||g.uuid===r||(g=s(g.children)))return g}return null}(t.children))?t:null}}),ut(wo.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,r){t[r]=this.node[this.propertyName]},function(t,r){for(var i=this.resolvedProperty,s=0,f=i.length;s!==f;++s)t[r++]=i[s]},function(t,r){t[r]=this.resolvedProperty[this.propertyIndex]},function(t,r){this.resolvedProperty.toArray(t,r)}],SetterByBindingTypeAndVersioning:[[function(t,r){this.targetObject[this.propertyName]=t[r]},function(t,r){this.targetObject[this.propertyName]=t[r],this.targetObject.needsUpdate=!0},function(t,r){this.targetObject[this.propertyName]=t[r],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,r){for(var i=this.resolvedProperty,s=0,f=i.length;s!==f;++s)i[s]=t[r++]},function(t,r){for(var i=this.resolvedProperty,s=0,f=i.length;s!==f;++s)i[s]=t[r++];this.targetObject.needsUpdate=!0},function(t,r){for(var i=this.resolvedProperty,s=0,f=i.length;s!==f;++s)i[s]=t[r++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,r){this.resolvedProperty[this.propertyIndex]=t[r]},function(t,r){this.resolvedProperty[this.propertyIndex]=t[r],this.targetObject.needsUpdate=!0},function(t,r){this.resolvedProperty[this.propertyIndex]=t[r],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,r){this.resolvedProperty.fromArray(t,r)},function(t,r){this.resolvedProperty.fromArray(t,r),this.targetObject.needsUpdate=!0},function(t,r){this.resolvedProperty.fromArray(t,r),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,r){this.bind(),this.getValue(t,r)},setValue:function(t,r){this.bind(),this.setValue(t,r)},bind:function(){var t=this.node,r=this.parsedPath,i=r.objectName,s=r.propertyName,f=r.propertyIndex;if(t||(this.node=t=wo.findNode(this.rootNode,r.nodeName)||this.rootNode),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(i){var c=r.objectIndex;switch(i){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}for(t=t.skeleton.bones,i=0;i<t.length;i++)if(t[i].name===c){c=i;break}break;default:if(t[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[i]}if(c!==void 0){if(t[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[c]}}if(c=t[s],c===void 0)console.error("THREE.PropertyBinding: Trying to update property for track: "+r.nodeName+"."+s+" but it wasn't found.",t);else{if(r=this.Versioning.None,this.targetObject=t,t.needsUpdate!==void 0?r=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(r=this.Versioning.MatrixWorldNeedsUpdate),i=this.BindingType.Direct,f!==void 0){if(s==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[f]!==void 0&&(f=t.morphTargetDictionary[f])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}i=this.BindingType.ArrayElement,this.resolvedProperty=c,this.propertyIndex=f}else c.fromArray!==void 0&&c.toArray!==void 0?(i=this.BindingType.HasFromToArray,this.resolvedProperty=c):Array.isArray(c)?(i=this.BindingType.EntireArray,this.resolvedProperty=c):this.propertyName=s;this.getValue=this.GetterByBindingType[i],this.setValue=this.SetterByBindingTypeAndVersioning[i][r]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),ut(wo.prototype,{_getValue_unbound:wo.prototype.getValue,_setValue_unbound:wo.prototype.setValue}),ut(function(){this.uuid=Ar.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var r=0,i=arguments.length;r!==i;++r)t[arguments[r].uuid]=r;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var s=this;this.stats={objects:{get total(){return s._objects.length},get inUse(){return this.total-s.nCachedObjects_}},get bindingsPerObject(){return s._bindings.length}}}.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,r=t.length,i=this.nCachedObjects_,s=this._indicesByUUID,f=this._paths,c=this._parsedPaths,g=this._bindings,p=g.length,A=void 0,S=0,N=arguments.length;S!==N;++S){var _=arguments[S],I=_.uuid,L=s[I];if(L===void 0){L=r++,s[I]=L,t.push(_),I=0;for(var P=p;I!==P;++I)g[I].push(new wo(_,f[I],c[I]))}else if(L<i){A=t[L];var F=--i;for(P=t[F],s[P.uuid]=L,t[L]=P,s[I]=F,t[F]=_,I=0,P=p;I!==P;++I){var W=g[I],X=W[L];W[L]=W[F],X===void 0&&(X=new wo(_,f[I],c[I])),W[F]=X}}else t[L]!==A&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=i},remove:function(){for(var t=this._objects,r=this.nCachedObjects_,i=this._indicesByUUID,s=this._bindings,f=s.length,c=0,g=arguments.length;c!==g;++c){var p=arguments[c],A=p.uuid,S=i[A];if(S!==void 0&&S>=r){var N=r++,_=t[N];for(i[_.uuid]=S,t[S]=_,i[A]=N,t[N]=p,p=0,A=f;p!==A;++p){_=s[p];var I=_[S];_[S]=_[N],_[N]=I}}}this.nCachedObjects_=r},uncache:function(){for(var t=this._objects,r=t.length,i=this.nCachedObjects_,s=this._indicesByUUID,f=this._bindings,c=f.length,g=0,p=arguments.length;g!==p;++g){var A=arguments[g].uuid,S=s[A];if(S!==void 0)if(delete s[A],S<i){A=--i;var N=t[A],_=--r,I=t[_];for(s[N.uuid]=S,t[S]=N,s[I.uuid]=A,t[A]=I,t.pop(),N=0,I=c;N!==I;++N){var L=f[N],P=L[_];L[S]=L[A],L[A]=P,L.pop()}}else for(_=--r,I=t[_],s[I.uuid]=S,t[S]=I,t.pop(),N=0,I=c;N!==I;++N)L=f[N],L[S]=L[_],L.pop()}this.nCachedObjects_=i},subscribe_:function(t,r){var i=this._bindingsIndicesByPath,s=i[t],f=this._bindings;if(s!==void 0)return f[s];var c=this._paths,g=this._parsedPaths,p=this._objects,A=this.nCachedObjects_,S=Array(p.length);for(s=f.length,i[t]=s,c.push(t),g.push(r),f.push(S),i=A,s=p.length;i!==s;++i)S[i]=new wo(p[i],t,r);return S},unsubscribe_:function(t){var r=this._bindingsIndicesByPath,i=r[t];if(i!==void 0){var s=this._paths,f=this._parsedPaths,c=this._bindings,g=c.length-1,p=c[g];r[t[g]]=i,c[i]=p,c.pop(),f[i]=f[g],f.pop(),s[i]=s[g],s.pop()}}}),ut($0.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,r){return this.loop=t,this.repetitions=r,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,r,i){if(t.fadeOut(r),this.fadeIn(r),i){i=this._clip.duration;var s=t._clip.duration,f=i/s;t.warp(1,s/i,r),this.warp(f,1,r)}return this},crossFadeTo:function(t,r,i){return t.crossFadeFrom(this,r,i)},stopFading:function(){var t=this._weightInterpolant;return t!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,r,i){var s=this._mixer,f=s.time,c=this._timeScaleInterpolant,g=this.timeScale;return c===null&&(this._timeScaleInterpolant=c=s._lendControlInterpolant()),s=c.parameterPositions,c=c.sampleValues,s[0]=f,s[1]=f+i,c[0]=t/g,c[1]=r/g,this},stopWarping:function(){var t=this._timeScaleInterpolant;return t!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,r,i,s){if(this.enabled){var f=this._startTime;if(f!==null){if(r=(t-f)*i,0>r||i===0)return;this._startTime=null,r*=i}if(r*=this._updateTimeScale(t),i=this._updateTime(r),t=this._updateWeight(t),0<t)switch(r=this._interpolants,f=this._propertyBindings,this.blendMode){case 2501:for(var c=0,g=r.length;c!==g;++c)r[c].evaluate(i),f[c].accumulateAdditive(t);break;default:for(c=0,g=r.length;c!==g;++c)r[c].evaluate(i),f[c].accumulate(s,t)}}else this._updateWeight(t)},_updateWeight:function(t){var r=0;if(this.enabled){r=this.weight;var i=this._weightInterpolant;if(i!==null){var s=i.evaluate(t)[0];r*=s,t>i.parameterPositions[1]&&(this.stopFading(),s===0&&(this.enabled=!1))}}return this._effectiveWeight=r},_updateTimeScale:function(t){var r=0;if(!this.paused){r=this.timeScale;var i=this._timeScaleInterpolant;if(i!==null){var s=i.evaluate(t)[0];r*=s,t>i.parameterPositions[1]&&(this.stopWarping(),r===0?this.paused=!0:this.timeScale=r)}}return this._effectiveTimeScale=r},_updateTime:function(t){var r=this.time+t,i=this._clip.duration,s=this.loop,f=this._loopCount,c=s===2202;if(t===0)return f===-1?r:c&&(f&1)==1?i-r:r;if(s===2200)t:{if(f===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1)),r>=i)r=i;else if(0>r)r=0;else{this.time=r;break t}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:0>t?-1:1})}else{if(f===-1&&(0<=t?(f=0,this._setEndings(!0,this.repetitions===0,c)):this._setEndings(this.repetitions===0,!0,c)),r>=i||0>r){s=Math.floor(r/i),r-=i*s,f+=Math.abs(s);var g=this.repetitions-f;0>=g?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r=0<t?i:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<t?1:-1})):(g===1?(t=0>t,this._setEndings(t,!t,c)):this._setEndings(!1,!1,c),this._loopCount=f,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:s}))}else this.time=r;if(c&&(f&1)==1)return i-r}return r},_setEndings:function(t,r,i){var s=this._interpolantSettings;i?(s.endingStart=2401,s.endingEnd=2401):(s.endingStart=t?this.zeroSlopeAtStart?2401:2400:2402,s.endingEnd=r?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(t,r,i){var s=this._mixer,f=s.time,c=this._weightInterpolant;return c===null&&(this._weightInterpolant=c=s._lendControlInterpolant()),s=c.parameterPositions,c=c.sampleValues,s[0]=f,c[0]=r,s[1]=f+t,c[1]=i,this}}),Fd.prototype=ut(at(se.prototype),{constructor:Fd,_bindAction:function(t,r){var i=t._localRoot||this._root,s=t._clip.tracks,f=s.length,c=t._propertyBindings;t=t._interpolants;var g=i.uuid,p=this._bindingsByRootAndName,A=p[g];for(A===void 0&&(A={},p[g]=A),p=0;p!==f;++p){var S=s[p],N=S.name,_=A[N];if(_===void 0){if(_=c[p],_!==void 0){_._cacheIndex===null&&(++_.referenceCount,this._addInactiveBinding(_,g,N));continue}_=new zm(wo.create(i,N,r&&r._propertyBindings[p].binding.parsedPath),S.ValueTypeName,S.getValueSize()),++_.referenceCount,this._addInactiveBinding(_,g,N)}c[p]=_,t[p].resultBuffer=_.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(t._cacheIndex===null){var r=(t._localRoot||this._root).uuid,i=t._clip.uuid,s=this._actionsByClip[i];this._bindAction(t,s&&s.knownActions[0]),this._addInactiveAction(t,i,r)}for(r=t._propertyBindings,i=0,s=r.length;i!==s;++i){var f=r[i];f.useCount++==0&&(this._lendBinding(f),f.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var r=t._propertyBindings,i=0,s=r.length;i!==s;++i){var f=r[i];--f.useCount==0&&(f.restoreOriginalState(),this._takeBackBinding(f))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){return t=t._cacheIndex,t!==null&&t<this._nActiveActions},_addInactiveAction:function(t,r,i){var s=this._actions,f=this._actionsByClip,c=f[r];c===void 0?(c={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,f[r]=c):(r=c.knownActions,t._byClipCacheIndex=r.length,r.push(t)),t._cacheIndex=s.length,s.push(t),c.actionByRoot[i]=t},_removeInactiveAction:function(t){var r=this._actions,i=r[r.length-1],s=t._cacheIndex;i._cacheIndex=s,r[s]=i,r.pop(),t._cacheIndex=null,r=t._clip.uuid,i=this._actionsByClip,s=i[r];var f=s.knownActions,c=f[f.length-1],g=t._byClipCacheIndex;c._byClipCacheIndex=g,f[g]=c,f.pop(),t._byClipCacheIndex=null,delete s.actionByRoot[(t._localRoot||this._root).uuid],f.length===0&&delete i[r],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){t=t._propertyBindings;for(var r=0,i=t.length;r!==i;++r){var s=t[r];--s.referenceCount==0&&this._removeInactiveBinding(s)}},_lendAction:function(t){var r=this._actions,i=t._cacheIndex,s=this._nActiveActions++,f=r[s];t._cacheIndex=s,r[s]=t,f._cacheIndex=i,r[i]=f},_takeBackAction:function(t){var r=this._actions,i=t._cacheIndex,s=--this._nActiveActions,f=r[s];t._cacheIndex=s,r[s]=t,f._cacheIndex=i,r[i]=f},_addInactiveBinding:function(t,r,i){var s=this._bindingsByRootAndName,f=s[r],c=this._bindings;f===void 0&&(f={},s[r]=f),f[i]=t,t._cacheIndex=c.length,c.push(t)},_removeInactiveBinding:function(t){var r=this._bindings,i=t.binding,s=i.rootNode.uuid;i=i.path;var f=this._bindingsByRootAndName,c=f[s],g=r[r.length-1];t=t._cacheIndex,g._cacheIndex=t,r[t]=g,r.pop(),delete c[i],qi(c).length===0&&delete f[s]},_lendBinding:function(t){var r=this._bindings,i=t._cacheIndex,s=this._nActiveBindings++,f=r[s];t._cacheIndex=s,r[s]=t,f._cacheIndex=i,r[i]=f},_takeBackBinding:function(t){var r=this._bindings,i=t._cacheIndex,s=--this._nActiveBindings,f=r[s];t._cacheIndex=s,r[s]=t,f._cacheIndex=i,r[i]=f},_lendControlInterpolant:function(){var t=this._controlInterpolants,r=this._nActiveControlInterpolants++,i=t[r];return i===void 0&&(i=new mh(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),i.__cacheIndex=r,t[r]=i),i},_takeBackControlInterpolant:function(t){var r=this._controlInterpolants,i=t.__cacheIndex,s=--this._nActiveControlInterpolants,f=r[s];t.__cacheIndex=s,r[s]=t,f.__cacheIndex=i,r[i]=f},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,r,i){var s=r||this._root,f=s.uuid;s=typeof t=="string"?ha.findByName(s,t):t,t=s!==null?s.uuid:t;var c=this._actionsByClip[t],g=null;if(i===void 0&&(i=s!==null?s.blendMode:2500),c!==void 0){if(g=c.actionByRoot[f],g!==void 0&&g.blendMode===i)return g;g=c.knownActions[0],s===null&&(s=g._clip)}return s===null?null:(r=new $0(this,s,r,i),this._bindAction(r,g),this._addInactiveAction(r,t,f),r)},existingAction:function(t,r){var i=r||this._root;return r=i.uuid,i=typeof t=="string"?ha.findByName(i,t):t,t=this._actionsByClip[i?i.uuid:t],t!==void 0&&t.actionByRoot[r]||null},stopAllAction:function(){for(var t=this._actions,r=this._nActiveActions-1;0<=r;--r)t[r].stop();return this},update:function(t){t*=this.timeScale;for(var r=this._actions,i=this._nActiveActions,s=this.time+=t,f=zl(t),c=this._accuIndex^=1,g=0;g!==i;++g)r[g]._update(s,t,f,c);for(t=this._bindings,r=this._nActiveBindings,g=0;g!==r;++g)t[g].apply(c);return this},setTime:function(t){for(var r=this.time=0;r<this._actions.length;r++)this._actions[r].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){var r=this._actions;t=t.uuid;var i=this._actionsByClip,s=i[t];if(s!==void 0){s=s.knownActions;for(var f=0,c=s.length;f!==c;++f){var g=s[f];this._deactivateAction(g);var p=g._cacheIndex,A=r[r.length-1];g._cacheIndex=null,g._byClipCacheIndex=null,A._cacheIndex=p,r[p]=A,r.pop(),this._removeInactiveBindingsForAction(g)}delete i[t]}},uncacheRoot:function(t){t=t.uuid;var r=this._actionsByClip;for(s in r){var i=r[s].actionByRoot[t];i!==void 0&&(this._deactivateAction(i),this._removeInactiveAction(i))}var s=this._bindingsByRootAndName[t];if(s!==void 0)for(var f in s)t=s[f],t.restoreOriginalState(),this._removeInactiveBinding(t)},uncacheAction:function(t,r){t=this.existingAction(t,r),t!==null&&(this._deactivateAction(t),this._removeInactiveAction(t))}}),Lu.prototype.clone=function(){return new Lu(this.value.clone===void 0?this.value:this.value.clone())},Bd.prototype=ut(at(As.prototype),{constructor:Bd,isInstancedInterleavedBuffer:!0,copy:function(t){return As.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),ut(Sc.prototype,{set:function(t,r){this.ray.set(t,r)},setFromCamera:function(t,r){r&&r.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(r.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(r).sub(this.ray.origin).normalize(),this.camera=r):r&&r.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(r.near+r.far)/(r.near-r.far)).unproject(r),this.ray.direction.set(0,0,-1).transformDirection(r.matrixWorld),this.camera=r):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,r,i){return i=i||[],wh(t,this,i,r),i.sort(Um),i},intersectObjects:function(t,r,i){if(i=i||[],Array.isArray(t)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(var s=0,f=t.length;s<f;s++)wh(t[s],this,i,r);return i.sort(Um),i}}),ut(function(t,r,i){return this.radius=t!==void 0?t:1,this.phi=r!==void 0?r:0,this.theta=i!==void 0?i:0,this}.prototype,{set:function(t,r,i){return this.radius=t,this.phi=r,this.theta=i,this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,r,i){return this.radius=Math.sqrt(t*t+r*r+i*i),this.radius===0?this.phi=this.theta=0:(this.theta=Math.atan2(t,i),this.phi=Math.acos(Ar.clamp(r/this.radius,-1,1))),this}}),ut(function(t,r,i){return this.radius=t!==void 0?t:1,this.theta=r!==void 0?r:0,this.y=i!==void 0?i:0,this}.prototype,{set:function(t,r,i){return this.radius=t,this.theta=r,this.y=i,this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,r,i){return this.radius=Math.sqrt(t*t+i*i),this.theta=Math.atan2(t,i),this.y=r,this}});var $w=new st;ut(Hm.prototype,{set:function(t,r){return this.min.copy(t),this.max.copy(r),this},setFromPoints:function(t){this.makeEmpty();for(var r=0,i=t.length;r<i;r++)this.expandByPoint(t[r]);return this},setFromCenterAndSize:function(t,r){return r=$w.copy(r).multiplyScalar(.5),this.min.copy(t).sub(r),this.max.copy(t).add(r),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=Infinity,this.max.x=this.max.y=-Infinity,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return t===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new st),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return t===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new st),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,r){return r===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),r=new st),r.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,r){return r===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),r=new st),r.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return $w.copy(t).clamp(this.min,this.max).sub(t).length()},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var t_=new lt,dy=new lt;ut(Nd.prototype,{set:function(t,r){return this.start.copy(t),this.end.copy(r),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return t===void 0&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new lt),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return t===void 0&&(console.warn("THREE.Line3: .delta() target is now required"),t=new lt),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,r){return r===void 0&&(console.warn("THREE.Line3: .at() target is now required"),r=new lt),this.delta(r).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(t,r){return t_.subVectors(t,this.start),dy.subVectors(this.end,this.start),t=dy.dot(dy),t=dy.dot(t_)/t,r&&(t=Ar.clamp(t,0,1)),t},closestPointToPoint:function(t,r,i){return t=this.closestPointToPointParameter(t,r),i===void 0&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),i=new lt),this.delta(i).multiplyScalar(t).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),_h.prototype=at(Ce.prototype),_h.prototype.constructor=_h,_h.prototype.isImmediateRenderObject=!0;var e_=new lt;Xf.prototype=at(Ce.prototype),Xf.prototype.constructor=Xf,Xf.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Xf.prototype.update=function(){this.light.updateMatrixWorld();var t=this.light.distance?this.light.distance:1e3,r=t*Math.tan(this.light.angle);this.cone.scale.set(r,r,t),e_.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e_),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var Jc=new lt,gy=new ye,YA=new ye;Ts.prototype=at(zn.prototype),Ts.prototype.constructor=Ts,Ts.prototype.isSkeletonHelper=!0,Ts.prototype.updateMatrixWorld=function(t){var r=this.bones,i=this.geometry,s=i.getAttribute("position");YA.getInverse(this.root.matrixWorld);for(var f=0,c=0;f<r.length;f++){var g=r[f];g.parent&&g.parent.isBone&&(gy.multiplyMatrices(YA,g.matrixWorld),Jc.setFromMatrixPosition(gy),s.setXYZ(c,Jc.x,Jc.y,Jc.z),gy.multiplyMatrices(YA,g.parent.matrixWorld),Jc.setFromMatrixPosition(gy),s.setXYZ(c+1,Jc.x,Jc.y,Jc.z),c+=2)}i.getAttribute("position").needsUpdate=!0,Ce.prototype.updateMatrixWorld.call(this,t)},Ru.prototype=at(dn.prototype),Ru.prototype.constructor=Ru,Ru.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Ru.prototype.update=function(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)};var TC=new lt,r_=new Ue,i_=new Ue;Na.prototype=at(Ce.prototype),Na.prototype.constructor=Na,Na.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Na.prototype.update=function(){var t=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{var r=t.geometry.getAttribute("color");r_.copy(this.light.color),i_.copy(this.light.groundColor);for(var i=0,s=r.count;i<s;i++){var f=i<s/2?r_:i_;r.setXYZ(i,f.r,f.g,f.b)}r.needsUpdate=!0}t.lookAt(TC.setFromMatrixPosition(this.light.matrixWorld).negate())},Mh.prototype=ut(at(zn.prototype),{constructor:Mh,copy:function(t){return zn.prototype.copy.call(this,t),this.geometry.copy(t.geometry),this.material.copy(t.material),this},clone:function(){return new this.constructor().copy(this)}}),Yf.prototype=at(zn.prototype),Yf.prototype.constructor=Yf;var n_=new lt,my=new lt,o_=new lt;wl.prototype=at(Ce.prototype),wl.prototype.constructor=wl,wl.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},wl.prototype.update=function(){n_.setFromMatrixPosition(this.light.matrixWorld),my.setFromMatrixPosition(this.light.target.matrixWorld),o_.subVectors(my,n_),this.lightPlane.lookAt(my),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(my),this.targetLine.scale.z=o_.length()};var vy=new lt,mo=new Gr;Zf.prototype=at(zn.prototype),Zf.prototype.constructor=Zf,Zf.prototype.update=function(){var t=this.geometry,r=this.pointMap;mo.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Qn("c",r,t,mo,0,0,-1),Qn("t",r,t,mo,0,0,1),Qn("n1",r,t,mo,-1,-1,-1),Qn("n2",r,t,mo,1,-1,-1),Qn("n3",r,t,mo,-1,1,-1),Qn("n4",r,t,mo,1,1,-1),Qn("f1",r,t,mo,-1,-1,1),Qn("f2",r,t,mo,1,-1,1),Qn("f3",r,t,mo,-1,1,1),Qn("f4",r,t,mo,1,1,1),Qn("u1",r,t,mo,.7,1.1,-1),Qn("u2",r,t,mo,-.7,1.1,-1),Qn("u3",r,t,mo,0,2,-1),Qn("cf1",r,t,mo,-1,0,1),Qn("cf2",r,t,mo,1,0,1),Qn("cf3",r,t,mo,0,-1,1),Qn("cf4",r,t,mo,0,1,1),Qn("cn1",r,t,mo,-1,0,-1),Qn("cn2",r,t,mo,1,0,-1),Qn("cn3",r,t,mo,0,-1,-1),Qn("cn4",r,t,mo,0,1,-1),t.getAttribute("position").needsUpdate=!0};var yy=new Ai;_l.prototype=at(zn.prototype),_l.prototype.constructor=_l,_l.prototype.update=function(t){if(t!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&yy.setFromObject(this.object),!yy.isEmpty()){t=yy.min;var r=yy.max,i=this.geometry.attributes.position,s=i.array;s[0]=r.x,s[1]=r.y,s[2]=r.z,s[3]=t.x,s[4]=r.y,s[5]=r.z,s[6]=t.x,s[7]=t.y,s[8]=r.z,s[9]=r.x,s[10]=t.y,s[11]=r.z,s[12]=r.x,s[13]=r.y,s[14]=t.z,s[15]=t.x,s[16]=r.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=r.x,s[22]=t.y,s[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}},_l.prototype.setFromObject=function(t){return this.object=t,this.update(),this},_l.prototype.copy=function(t){return zn.prototype.copy.call(this,t),this.object=t.object,this},_l.prototype.clone=function(){return new this.constructor().copy(this)},Ml.prototype=at(zn.prototype),Ml.prototype.constructor=Ml,Ml.prototype.updateMatrixWorld=function(t){var r=this.box;r.isEmpty()||(r.getCenter(this.position),r.getSize(this.scale),this.scale.multiplyScalar(.5),Ce.prototype.updateMatrixWorld.call(this,t))},Ho.prototype=at(js.prototype),Ho.prototype.constructor=Ho,Ho.prototype.updateMatrixWorld=function(t){var r=-this.plane.constant;1e-8>Math.abs(r)&&(r=1e-8),this.scale.set(.5*this.size,.5*this.size,r),this.children[0].material.side=0>r?1:0,this.lookAt(this.plane.normal),Ce.prototype.updateMatrixWorld.call(this,t)};var s_=new lt,xy,ZA;ko.prototype=at(Ce.prototype),ko.prototype.constructor=ko,ko.prototype.setDirection=function(t){.99999<t.y?this.quaternion.set(0,0,0,1):-.99999>t.y?this.quaternion.set(1,0,0,0):(s_.set(t.z,0,-t.x).normalize(),this.quaternion.setFromAxisAngle(s_,Math.acos(t.y)))},ko.prototype.setLength=function(t,r,i){r===void 0&&(r=.2*t),i===void 0&&(i=.2*r),this.line.scale.set(1,Math.max(1e-4,t-r),1),this.line.updateMatrix(),this.cone.scale.set(i,r,i),this.cone.position.y=t,this.cone.updateMatrix()},ko.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},ko.prototype.copy=function(t){return Ce.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this},ko.prototype.clone=function(){return new this.constructor().copy(this)},zd.prototype=at(zn.prototype),zd.prototype.constructor=zd;var a_=[.125,.215,.35,.446,.526,.582],SC=5+a_.length,Tp={};an(Tp,3e3,0),an(Tp,3001,1),an(Tp,3002,2),an(Tp,3004,3),an(Tp,3005,4),an(Tp,3006,5),an(Tp,3007,6),new Ba,function(){for(var t=[],r=[],i=[],s=8,f=0;f<SC;f++){var c=Math.pow(2,s);r.push(c);var g=1/c;4<f?g=a_[f-8+4-1]:f==0&&(g=0),i.push(g),g=1/(c-1),c=-g/2,g=1+g/2;var p=[c,c,g,c,g,g,c,c,g,g,c,g];c=new Float32Array(108),g=new Float32Array(72);for(var A=new Float32Array(36),S=0;6>S;S++){var N=S%3*2/3-1,_=2<S?0:-1;c.set([N,_,0,N+2/3,_,0,N+2/3,_+1,0,N,_,0,N+2/3,_+1,0,N,_+1,0],18*S),g.set(p,12*S),A.set([S,S,S,S,S,S],6*S)}p=new Ge,p.setAttribute("position",new Ir(c,3)),p.setAttribute("uv",new Ir(g,2)),p.setAttribute("faceIndex",new Ir(A,1)),t.push(p),4<s&&s--}return{_lodPlanes:t,_sizeLods:r,_sigmas:i}}(),Vr.create=function(t,r){return t.prototype=at(Vr.prototype),t.prototype.constructor=t,t.prototype.getPoint=r,t},ut(yl.prototype,{createPointsGeometry:function(t){return console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),t=this.getPoints(t),this.createGeometry(t)},createSpacedPointsGeometry:function(t){return console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),t=this.getSpacedPoints(t),this.createGeometry(t)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var r=new Le,i=0,s=t.length;i<s;i++){var f=t[i];r.vertices.push(new lt(f.x,f.y,f.z||0))}return r}}),ut(Pi.prototype,{fromPoints:function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),function(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),ss.call(this,t),this.type="catmullrom",this.closed=!0}.prototype=at(ss.prototype),function(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),ss.call(this,t),this.type="catmullrom"}.prototype=at(ss.prototype),Gm.prototype=at(ss.prototype),ut(Gm.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Mh.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Ts.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},ut(si.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Zc.extractUrlBase(t)}}),si.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},ut(Ks.prototype,{setTexturePath:function(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}),ut(Hm.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),ut(Ai.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),ut(Fn.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),mi.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},Nd.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},ut(Ar,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Ar.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Ar.ceilPowerOfTwo(t)}}),ut(Ft.prototype,{flattenToArrayOffset:function(t,r){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,r)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),ut(ye.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,r){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,r)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new lt().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,r,i,s,f,c){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,r,s,i,f,c)}}),Wi.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},he.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},ut(xo.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),ut(Xi.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,r)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),ut(Xi,{barycoordFromPoint:function(t,r,i,s,f){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Xi.getBarycoord(t,r,i,s,f)},normal:function(t,r,i,s){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Xi.getNormal(t,r,i,s)}}),ut(xl.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new iu(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new fh(this,t)}}),ut(st.prototype,{fromAttribute:function(t,r,i){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,r,i)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),ut(lt.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,r){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(r,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,r,i){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,r,i)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),ut(It.prototype,{fromAttribute:function(t,r,i){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,r,i)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),ut(Le.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),ut(Ce.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,r){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(r,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Xr(Ce.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),ut(dn.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Xr(dn.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Xr(Zo.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(aa.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Pa.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Vr.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),Cr.prototype.setLens=function(t,r){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),r!==void 0&&(this.filmGauge=r),this.setFocalLength(t)},Xr(In.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Xr(Ir.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===35048},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(35048)}}}),ut(Ir.prototype,{setDynamic:function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(t===!0?35048:35044),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),ut(Ge.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addAttribute:function(t,r,i){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),r&&r.isBufferAttribute||r&&r.isInterleavedBufferAttribute?t==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(r),this):this.setAttribute(t,r):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new Ir(r,i)))},addDrawCall:function(t,r,i){i!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,r)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},applyMatrix:function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Xr(Ge.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Xr(Pd.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(t){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=t}}}),Xr(Sc.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(t){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=t}}}),Xr(As.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===35048},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}}),ut(As.prototype,{setDynamic:function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(t===!0?35048:35044),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),ut(ua.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Xr(Lu.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Xr(kr.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Ue}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===1}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),Xr(Ys.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Xr($e.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),ut(Yo.prototype,{clearTarget:function(t,r,i,s){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(r,i,s)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Xr(Yo.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=t===!0?3001:3e3}}}),Xr(tu.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Xr(bt.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Xr(su.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var r=this;return new Gn().load(t,function(i){r.setBuffer(i)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),Dd.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Br.prototype.updateCubeMap=function(t,r){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,r)},Wo.crossOrigin=void 0,Wo.loadTexture=function(t,r,i,s){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var f=new bf;return f.setCrossOrigin(this.crossOrigin),t=f.load(t,i,void 0,s),r&&(t.mapping=r),t},Wo.loadTextureCube=function(t,r,i,s){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var f=new Rm;return f.setCrossOrigin(this.crossOrigin),t=f.load(t,i,void 0,s),r&&(t.mapping=r),t},Wo.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Wo.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"117"}}));var Sp=function(t){si.call(this,t)};Sp.prototype=ut(at(si.prototype),{constructor:Sp,load:function(t,r,i,s){var f=this,c=this.path===""?Zc.extractUrlBase(t):this.path,g=new Ms(this.manager);g.setPath(this.path),g.load(t,function(p){try{r(f.parse(p,c))}catch(A){s?s(A):console.error(A),f.manager.itemError(t)}},i,s)},setMaterialOptions:function(t){return this.materialOptions=t,this},parse:function(t,r){var i=t.split(`
`),s={},f=/\s+/;t={};for(var c=0;c<i.length;c++){var g=i[c];if(g=g.trim(),g.length!==0&&g.charAt(0)!=="#"){var p=g.indexOf(" "),A=0<=p?g.substring(0,p):g;A=A.toLowerCase(),g=0<=p?g.substring(p+1):"",g=g.trim(),A==="newmtl"?(s={name:g},t[g]=s):A==="ka"||A==="kd"||A==="ks"||A==="ke"?(g=g.split(f,3),s[A]=[parseFloat(g[0]),parseFloat(g[1]),parseFloat(g[2])]):s[A]=g}}return r=new Sp.MaterialCreator(this.resourcePath||r,this.materialOptions),r.setCrossOrigin(this.crossOrigin),r.setManager(this.manager),r.setMaterials(t),r}}),Sp.MaterialCreator=function(t,r){this.baseUrl=t||"",this.options=r,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:0,this.wrap=this.options&&this.options.wrap?this.options.wrap:1e3},Sp.MaterialCreator.prototype={constructor:Sp.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(t){return this.crossOrigin=t,this},setManager:function(t){this.manager=t},setMaterials:function(t){this.materialsInfo=this.convert(t),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(t){if(!this.options)return t;var r={},i;for(i in t){var s=t[i],f={};r[i]=f;for(var c in s){var g=!0,p=s[c],A=c.toLowerCase();switch(A){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(p=[p[0]/255,p[1]/255,p[2]/255]),this.options&&this.options.ignoreZeroRGBs&&p[0]===0&&p[1]===0&&p[2]===0&&(g=!1)}g&&(f[A]=p)}}return r},preload:function(){for(var t in this.materialsInfo)this.create(t)},getIndex:function(t){return this.nameLookup[t]},getAsArray:function(){var t=0,r;for(r in this.materialsInfo)this.materialsArray[t]=this.create(r),this.nameLookup[r]=t,t++;return this.materialsArray},create:function(t){return this.materials[t]===void 0&&this.createMaterial_(t),this.materials[t]},createMaterial_:function(t){function r(A,S){return typeof S!="string"||S===""?"":/^https?:\/\//i.test(S)?S:A+S}function i(A,S){if(!c[A]){S=s.getTextureParams(S,c);var N=s.loadTexture(r(s.baseUrl,S.url));N.repeat.copy(S.scale),N.offset.copy(S.offset),N.wrapS=s.wrap,N.wrapT=s.wrap,c[A]=N}}var s=this,f=this.materialsInfo[t],c={name:t,side:this.side},g;for(g in f){var p=f[g];if(p!=="")switch(g.toLowerCase()){case"kd":c.color=new Ue().fromArray(p);break;case"ks":c.specular=new Ue().fromArray(p);break;case"ke":c.emissive=new Ue().fromArray(p);break;case"map_kd":i("map",p);break;case"map_ks":i("specularMap",p);break;case"map_ke":i("emissiveMap",p);break;case"norm":i("normalMap",p);break;case"map_bump":case"bump":i("bumpMap",p);break;case"map_d":i("alphaMap",p),c.transparent=!0;break;case"ns":c.shininess=parseFloat(p);break;case"d":p=parseFloat(p),1>p&&(c.opacity=p,c.transparent=!0);break;case"tr":p=parseFloat(p),this.options&&this.options.invertTrProperty&&(p=1-p),0<p&&(c.opacity=1-p,c.transparent=!0)}}return this.materials[t]=new Ys(c),this.materials[t]},getTextureParams:function(t,r){var i={scale:new st(1,1),offset:new st(0,0)};t=t.split(/\s+/);var s=t.indexOf("-bm");return 0<=s&&(r.bumpScale=parseFloat(t[s+1]),t.splice(s,2)),s=t.indexOf("-s"),0<=s&&(i.scale.set(parseFloat(t[s+1]),parseFloat(t[s+2])),t.splice(s,4)),s=t.indexOf("-o"),0<=s&&(i.offset.set(parseFloat(t[s+1]),parseFloat(t[s+2])),t.splice(s,4)),i.url=t.join(" ").trim(),i},loadTexture:function(t,r,i,s,f){var c=this.manager!==void 0?this.manager:jw,g=c.getHandler(t);return g===null&&(g=new bf(c)),g.setCrossOrigin&&g.setCrossOrigin(this.crossOrigin),t=g.load(t,i,s,f),r!==void 0&&(t.mapping=r),t}};var IC=function(){function t(){var _={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(I,L){if(this.object&&this.object.fromDeclaration===!1)this.object.name=I,this.object.fromDeclaration=L!==!1;else{var P=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:I||"",fromDeclaration:L!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasNormalIndices:!1,hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(F,W){var X=this._finalize(!1);return X&&(X.inherited||0>=X.groupCount)&&this.materials.splice(X.index,1),F={index:this.materials.length,name:F||"",mtllib:Array.isArray(W)&&0<W.length?W[W.length-1]:"",smooth:X!==void 0?X.smooth:this.smooth,groupStart:X!==void 0?X.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(Z){return Z={index:typeof Z=="number"?Z:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1},Z.clone=this.clone.bind(Z),Z}},this.materials.push(F),F},currentMaterial:function(){if(0<this.materials.length)return this.materials[this.materials.length-1]},_finalize:function(F){var W=this.currentMaterial();if(W&&W.groupEnd===-1&&(W.groupEnd=this.geometry.vertices.length/3,W.groupCount=W.groupEnd-W.groupStart,W.inherited=!1),F&&1<this.materials.length)for(var X=this.materials.length-1;0<=X;X--)0>=this.materials[X].groupCount&&this.materials.splice(X,1);return F&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),W}},P&&P.name&&typeof P.clone=="function"&&(I=P.clone(0),I.inherited=!0,this.object.materials.push(I)),this.objects.push(this.object)}},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(I,L){return I=parseInt(I,10),3*(0<=I?I-1:I+L/3)},parseNormalIndex:function(I,L){return I=parseInt(I,10),3*(0<=I?I-1:I+L/3)},parseUVIndex:function(I,L){return I=parseInt(I,10),2*(0<=I?I-1:I+L/2)},addVertex:function(I,L,P){var F=this.vertices,W=this.object.geometry.vertices;W.push(F[I+0],F[I+1],F[I+2]),W.push(F[L+0],F[L+1],F[L+2]),W.push(F[P+0],F[P+1],F[P+2])},addVertexPoint:function(I){var L=this.vertices;this.object.geometry.vertices.push(L[I+0],L[I+1],L[I+2])},addVertexLine:function(I){var L=this.vertices;this.object.geometry.vertices.push(L[I+0],L[I+1],L[I+2])},addNormal:function(I,L,P){var F=this.normals,W=this.object.geometry.normals;W.push(F[I+0],F[I+1],F[I+2]),W.push(F[L+0],F[L+1],F[L+2]),W.push(F[P+0],F[P+1],F[P+2])},addFaceNormal:function(I,L,P){var F=this.vertices,W=this.object.geometry.normals;g.fromArray(F,I),p.fromArray(F,L),A.fromArray(F,P),N.subVectors(A,p),S.subVectors(g,p),N.cross(S),N.normalize(),W.push(N.x,N.y,N.z),W.push(N.x,N.y,N.z),W.push(N.x,N.y,N.z)},addColor:function(I,L,P){var F=this.colors,W=this.object.geometry.colors;F[I]!==void 0&&W.push(F[I+0],F[I+1],F[I+2]),F[L]!==void 0&&W.push(F[L+0],F[L+1],F[L+2]),F[P]!==void 0&&W.push(F[P+0],F[P+1],F[P+2])},addUV:function(I,L,P){var F=this.uvs,W=this.object.geometry.uvs;W.push(F[I+0],F[I+1]),W.push(F[L+0],F[L+1]),W.push(F[P+0],F[P+1])},addDefaultUV:function(){var I=this.object.geometry.uvs;I.push(0,0),I.push(0,0),I.push(0,0)},addUVLine:function(I){var L=this.uvs;this.object.geometry.uvs.push(L[I+0],L[I+1])},addFace:function(I,L,P,F,W,X,Z,tt,ot){var xt=this.vertices.length;I=this.parseVertexIndex(I,xt),L=this.parseVertexIndex(L,xt),P=this.parseVertexIndex(P,xt),this.addVertex(I,L,P),this.addColor(I,L,P),Z!==void 0&&Z!==""?(P=this.normals.length,I=this.parseNormalIndex(Z,P),L=this.parseNormalIndex(tt,P),P=this.parseNormalIndex(ot,P),this.addNormal(I,L,P),this.object.geometry.hasNormalIndices=!0):this.addFaceNormal(I,L,P),F!==void 0&&F!==""?(Z=this.uvs.length,I=this.parseUVIndex(F,Z),L=this.parseUVIndex(W,Z),P=this.parseUVIndex(X,Z),this.addUV(I,L,P),this.object.geometry.hasUVIndices=!0):this.addDefaultUV()},addPointGeometry:function(I){this.object.geometry.type="Points";for(var L=this.vertices.length,P=0,F=I.length;P<F;P++)this.addVertexPoint(this.parseVertexIndex(I[P],L))},addLineGeometry:function(I,L){this.object.geometry.type="Line";for(var P=this.vertices.length,F=this.uvs.length,W=0,X=I.length;W<X;W++)this.addVertexLine(this.parseVertexIndex(I[W],P));for(I=0,X=L.length;I<X;I++)this.addUVLine(this.parseUVIndex(L[I],F))}};return _.startObject("",!1),_}function r(_){si.call(this,_),this.materials=null}var i=/^[og]\s*(.+)?/,s=/^mtllib /,f=/^usemtl /,c=/^usemap /,g=new lt,p=new lt,A=new lt,S=new lt,N=new lt;return r.prototype=ut(at(si.prototype),{constructor:r,load:function(_,I,L,P){var F=this,W=new Ms(F.manager);W.setPath(this.path),W.load(_,function(X){try{I(F.parse(X))}catch(Z){P?P(Z):console.error(Z),F.manager.itemError(_)}},L,P)},setMaterials:function(_){return this.materials=_,this},parse:function(_){var I=new t;_.indexOf(`\r
`)!==-1&&(_=_.replace(/\r\n/g,`
`)),_.indexOf(`\\
`)!==-1&&(_=_.replace(/\\\n/g,""));var L=_.split(`
`),P,F=typeof"".trimLeft=="function";_=0;for(var W=L.length;_<W;_++){var X=L[_];X=F?X.trimLeft():X.trim();var Z=X.length;if(Z!==0&&(Z=X.charAt(0),Z!=="#"))if(Z==="v")switch(X=X.split(/\s+/),X[0]){case"v":I.vertices.push(parseFloat(X[1]),parseFloat(X[2]),parseFloat(X[3])),7<=X.length?I.colors.push(parseFloat(X[4]),parseFloat(X[5]),parseFloat(X[6])):I.colors.push(void 0,void 0,void 0);break;case"vn":I.normals.push(parseFloat(X[1]),parseFloat(X[2]),parseFloat(X[3]));break;case"vt":I.uvs.push(parseFloat(X[1]),parseFloat(X[2]))}else if(Z==="f"){X=X.substr(1).trim();var tt=X.split(/\s+/);for(X=[],Z=0,P=tt.length;Z<P;Z++){var ot=tt[Z];0<ot.length&&(ot=ot.split("/"),X.push(ot))}for(tt=X[0],Z=1,P=X.length-1;Z<P;Z++){ot=X[Z];var xt=X[Z+1];I.addFace(tt[0],ot[0],xt[0],tt[1],ot[1],xt[1],tt[2],ot[2],xt[2])}}else if(Z==="l"){if(Z=X.substring(1).trim().split(" "),P=[],tt=[],X.indexOf("/")===-1)P=Z;else for(X=0,ot=Z.length;X<ot;X++)xt=Z[X].split("/"),xt[0]!==""&&P.push(xt[0]),xt[1]!==""&&tt.push(xt[1]);I.addLineGeometry(P,tt)}else Z==="p"?(X=X.substr(1).trim(),X=X.split(" "),I.addPointGeometry(X)):(P=i.exec(X))!==null?(X=(" "+P[0].substr(1).trim()).substr(1),I.startObject(X)):f.test(X)?I.object.startMaterial(X.substring(7).trim(),I.materialLibraries):s.test(X)?I.materialLibraries.push(X.substring(7).trim()):c.test(X)?console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.'):Z==="s"?(P=X.split(" "),1<P.length?(X=P[1].trim().toLowerCase(),I.object.smooth=X!=="0"&&X!=="off"):I.object.smooth=!0,(X=I.object.currentMaterial())&&(X.smooth=I.object.smooth)):X!=="\0"&&console.warn('THREE.OBJLoader: Unexpected line: "'+X+'"')}for(I.finalize(),L=new ys,L.materialLibraries=[].concat(I.materialLibraries),_=0,W=I.objects.length;_<W;_++)if(F=I.objects[_],X=F.geometry,Z=F.materials,P=X.type==="Line",tt=X.type==="Points",ot=!1,X.vertices.length!==0){xt=new Ge,xt.setAttribute("position",new We(X.vertices,3)),X.hasNormalIndices===!0&&xt.setAttribute("normal",new We(X.normals,3)),0<X.colors.length&&(ot=!0,xt.setAttribute("color",new We(X.colors,3))),X.hasUVIndices===!0&&xt.setAttribute("uv",new We(X.uvs,2));for(var At=[],yt=0,zt=Z.length;yt<zt;yt++){var Ht=Z[yt],$t=Ht.name+"_"+Ht.smooth+"_"+ot;if(X=I.materials[$t],this.materials!==null)if(X=this.materials.create(Ht.name),!P||!X||X instanceof yn)!tt||!X||X instanceof Xs||(Vt=new Xs({size:10,sizeAttenuation:!1}),kr.prototype.copy.call(Vt,X),Vt.color.copy(X.color),Vt.map=X.map,X=Vt);else{var Vt=new yn;kr.prototype.copy.call(Vt,X),Vt.color.copy(X.color),X=Vt}X===void 0&&(X=P?new yn:tt?new Xs({size:1,sizeAttenuation:!1}):new Ys,X.name=Ht.name,X.flatShading=!Ht.smooth,X.vertexColors=ot,I.materials[$t]=X),At.push(X)}if(1<At.length){for(yt=0,zt=Z.length;yt<zt;yt++)Ht=Z[yt],xt.addGroup(Ht.groupStart,Ht.groupCount,yt);X=P?new zn(xt,At):tt?new Cu(xt,At):new dn(xt,At)}else X=P?new zn(xt,At[0]):tt?new Cu(xt,At[0]):new dn(xt,At[0]);X.name=F.name,L.add(X)}return L}}),r}(),EC=function(){function t(gt){si.call(this,gt),this.ddsLoader=this.dracoLoader=null}function r(){var gt={};return{get:function(mt){return gt[mt]},add:function(mt,vt){gt[mt]=vt},remove:function(mt){delete gt[mt]},removeAll:function(){gt={}}}}function i(gt){if(!gt)throw Error("THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=zt.MSFT_TEXTURE_DDS,this.ddsLoader=gt}function s(gt){this.name=zt.KHR_LIGHTS_PUNCTUAL,this.lightDefs=(gt.extensions&&gt.extensions[zt.KHR_LIGHTS_PUNCTUAL]||{}).lights||[]}function f(){this.name=zt.KHR_MATERIALS_UNLIT}function c(){this.name=zt.KHR_MATERIALS_CLEARCOAT}function g(gt){this.name=zt.KHR_BINARY_GLTF,this.body=this.content=null;var mt=new DataView(gt,0,$t);if(this.header={magic:Zc.decodeText(new Uint8Array(gt.slice(0,4))),version:mt.getUint32(4,!0),length:mt.getUint32(8,!0)},this.header.magic!==Ht)throw Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(2>this.header.version)throw Error("THREE.GLTFLoader: Legacy binary file detected.");mt=new DataView(gt,$t);for(var vt=0;vt<mt.byteLength;){var Ct=mt.getUint32(vt,!0);vt+=4;var et=mt.getUint32(vt,!0);vt+=4,et===Vt.JSON?(et=new Uint8Array(gt,$t+vt,Ct),this.content=Zc.decodeText(et)):et===Vt.BIN&&(et=$t+vt,this.body=gt.slice(et,et+Ct)),vt+=Ct}if(this.content===null)throw Error("THREE.GLTFLoader: JSON content not found.")}function p(gt,mt){if(!mt)throw Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=zt.KHR_DRACO_MESH_COMPRESSION,this.json=gt,this.dracoLoader=mt,this.dracoLoader.preload()}function A(){this.name=zt.KHR_TEXTURE_TRANSFORM}function S(gt){Lo.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var mt={specular:{value:new Ue().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=mt,this.onBeforeCompile=function(vt){for(var Ct in mt)vt.uniforms[Ct]=mt[Ct];vt.fragmentShader=vt.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;"),vt.fragmentShader=vt.fragmentShader.replace("uniform float metalness;","uniform float glossiness;"),vt.fragmentShader=vt.fragmentShader.replace("#include <roughnessmap_pars_fragment>",`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`),vt.fragmentShader=vt.fragmentShader.replace("#include <metalnessmap_pars_fragment>",`#ifdef USE_GLOSSINESSMAP
	uniform sampler2D glossinessMap;
#endif`),vt.fragmentShader=vt.fragmentShader.replace("#include <roughnessmap_fragment>",`vec3 specularFactor = specular;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	texelSpecular = sRGBToLinear( texelSpecular );
	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture
	specularFactor *= texelSpecular.rgb;
#endif`),vt.fragmentShader=vt.fragmentShader.replace("#include <metalnessmap_fragment>",`float glossinessFactor = glossiness;
#ifdef USE_GLOSSINESSMAP
	vec4 texelGlossiness = texture2D( glossinessMap, vUv );
	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture
	glossinessFactor *= texelGlossiness.a;
#endif`),vt.fragmentShader=vt.fragmentShader.replace("#include <lights_physical_fragment>",`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb;
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.
material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
material.specularColor = specularFactor.rgb;`)},Xr(this,{specular:{get:function(){return mt.specular.value},set:function(vt){mt.specular.value=vt}},specularMap:{get:function(){return mt.specularMap.value},set:function(vt){mt.specularMap.value=vt}},glossiness:{get:function(){return mt.glossiness.value},set:function(vt){mt.glossiness.value=vt}},glossinessMap:{get:function(){return mt.glossinessMap.value},set:function(vt){(mt.glossinessMap.value=vt)?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_ROUGHNESSMAP=""):(delete this.defines.USE_ROUGHNESSMAP,delete this.defines.USE_GLOSSINESSMAP)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(gt)}function N(){return{name:zt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:"color map lightMap lightMapIntensity aoMap aoMapIntensity emissive emissiveIntensity emissiveMap bumpMap bumpScale normalMap normalMapType displacementMap displacementScale displacementBias specularMap specular glossinessMap glossiness alphaMap envMap envMapIntensity refractionRatio".split(" "),getMaterialType:function(){return S},extendParams:function(gt,mt,vt){var Ct=mt.extensions[this.name];if(gt.color=new Ue(1,1,1),gt.opacity=1,mt=[],Array.isArray(Ct.diffuseFactor)){var et=Ct.diffuseFactor;gt.color.fromArray(et),gt.opacity=et[3]}return Ct.diffuseTexture!==void 0&&mt.push(vt.assignTexture(gt,"map",Ct.diffuseTexture)),gt.emissive=new Ue(0,0,0),gt.glossiness=Ct.glossinessFactor!==void 0?Ct.glossinessFactor:1,gt.specular=new Ue(1,1,1),Array.isArray(Ct.specularFactor)&&gt.specular.fromArray(Ct.specularFactor),Ct.specularGlossinessTexture!==void 0&&(Ct=Ct.specularGlossinessTexture,mt.push(vt.assignTexture(gt,"glossinessMap",Ct)),mt.push(vt.assignTexture(gt,"specularMap",Ct))),Di.all(mt)},createMaterial:function(gt){var mt=new S(gt);return mt.fog=!0,mt.color=gt.color,mt.map=gt.map===void 0?null:gt.map,mt.lightMap=null,mt.lightMapIntensity=1,mt.aoMap=gt.aoMap===void 0?null:gt.aoMap,mt.aoMapIntensity=1,mt.emissive=gt.emissive,mt.emissiveIntensity=1,mt.emissiveMap=gt.emissiveMap===void 0?null:gt.emissiveMap,mt.bumpMap=gt.bumpMap===void 0?null:gt.bumpMap,mt.bumpScale=1,mt.normalMap=gt.normalMap===void 0?null:gt.normalMap,mt.normalMapType=0,gt.normalScale&&(mt.normalScale=gt.normalScale),mt.displacementMap=null,mt.displacementScale=1,mt.displacementBias=0,mt.specularMap=gt.specularMap===void 0?null:gt.specularMap,mt.specular=gt.specular,mt.glossinessMap=gt.glossinessMap===void 0?null:gt.glossinessMap,mt.glossiness=gt.glossiness,mt.alphaMap=null,mt.envMap=gt.envMap===void 0?null:gt.envMap,mt.envMapIntensity=1,mt.refractionRatio=.98,mt}}}function _(){this.name=zt.KHR_MESH_QUANTIZATION}function I(gt,mt,vt,Ct){os.call(this,gt,mt,vt,Ct)}function L(gt,mt){return typeof gt!="string"||gt===""?"":(/^https?:\/\//i.test(mt)&&/^\//.test(gt)&&(mt=mt.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(gt)||/^data:.*,.*$/i.test(gt)||/^blob:.*$/i.test(gt)?gt:mt+gt)}function P(gt){return gt.DefaultMaterial===void 0&&(gt.DefaultMaterial=new Lo({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),gt.DefaultMaterial}function F(gt,mt,vt){for(var Ct in vt.extensions)gt[Ct]===void 0&&(mt.userData.gltfExtensions=mt.userData.gltfExtensions||{},mt.userData.gltfExtensions[Ct]=vt.extensions[Ct])}function W(gt,mt){mt.extras!==void 0&&(Ua(mt.extras)==="object"?ut(gt.userData,mt.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+mt.extras))}function X(gt,mt,vt){for(var Ct=!1,et=!1,ct=0,ft=mt.length;ct<ft;ct++){var Tt=mt[ct];if(Tt.POSITION!==void 0&&(Ct=!0),Tt.NORMAL!==void 0&&(et=!0),Ct&&et)break}if(!Ct&&!et)return Di.resolve(gt);var kt=[],Jt=[];for(ct=0,ft=mt.length;ct<ft;ct++){if(Tt=mt[ct],Ct){var pt=Tt.POSITION!==void 0?vt.getDependency("accessor",Tt.POSITION):gt.attributes.position;kt.push(pt)}et&&(pt=Tt.NORMAL!==void 0?vt.getDependency("accessor",Tt.NORMAL):gt.attributes.normal,Jt.push(pt))}return Di.all([Di.all(kt),Di.all(Jt)]).then(function(me){var Ae=me[0];return me=me[1],Ct&&(gt.morphAttributes.position=Ae),et&&(gt.morphAttributes.normal=me),gt.morphTargetsRelative=!0,gt})}function Z(gt){var mt=gt.extensions&&gt.extensions[zt.KHR_DRACO_MESH_COMPRESSION];return mt?"draco:"+mt.bufferView+":"+mt.indices+":"+tt(mt.attributes):gt.indices+":"+tt(gt.attributes)+":"+gt.mode}function tt(gt){for(var mt="",vt=qi(gt).sort(),Ct=0,et=vt.length;Ct<et;Ct++)mt+=vt[Ct]+":"+gt[vt[Ct]]+";";return mt}function ot(gt,mt,vt){this.json=gt||{},this.extensions=mt||{},this.options=vt||{},this.cache=new r,this.associations=new yv,this.primitiveCache={},this.textureLoader=new bf(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new Ms(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}function xt(gt,mt,vt){var Ct=mt.attributes,et=new Ai;if(Ct.POSITION!==void 0){var ct=vt.json.accessors[Ct.POSITION];if(Ct=ct.min,ct=ct.max,Ct!==void 0&&ct!==void 0){if(et.set(new lt(Ct[0],Ct[1],Ct[2]),new lt(ct[0],ct[1],ct[2])),mt=mt.targets,mt!==void 0){for(var ft=new lt,Tt=new lt,kt=0,Jt=mt.length;kt<Jt;kt++)Ct=mt[kt],Ct.POSITION!==void 0&&(ct=vt.json.accessors[Ct.POSITION],Ct=ct.min,ct=ct.max,Ct!==void 0&&ct!==void 0?(Tt.setX(Math.max(Math.abs(Ct[0]),Math.abs(ct[0]))),Tt.setY(Math.max(Math.abs(Ct[1]),Math.abs(ct[1]))),Tt.setZ(Math.max(Math.abs(Ct[2]),Math.abs(ct[2]))),ft.max(Tt)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION."));et.expandByVector(ft)}gt.boundingBox=et,vt=new Fn,et.getCenter(vt.center),vt.radius=et.min.distanceTo(et.max)/2,gt.boundingSphere=vt}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}function At(gt,mt,vt){function Ct(kt,Jt){return vt.getDependency("accessor",kt).then(function(pt){gt.setAttribute(Jt,pt)})}var et=mt.attributes,ct=[],ft;for(ft in et){var Tt=gr[ft]||ft.toLowerCase();Tt in gt.attributes||ct.push(Ct(et[ft],Tt))}return mt.indices===void 0||gt.index||(et=vt.getDependency("accessor",mt.indices).then(function(kt){gt.setIndex(kt)}),ct.push(et)),W(gt,mt),xt(gt,mt,vt),Di.all(ct).then(function(){return mt.targets!==void 0?X(gt,mt.targets,vt):gt})}function yt(gt,mt){var vt=gt.getIndex();if(vt===null){var Ct=[];if(vt=gt.getAttribute("position"),vt!==void 0){for(var et=0;et<vt.count;et++)Ct.push(et);gt.setIndex(Ct),vt=gt.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),gt}var ct=vt.count-2;if(Ct=[],mt===2)for(et=1;et<=ct;et++)Ct.push(vt.getX(0)),Ct.push(vt.getX(et)),Ct.push(vt.getX(et+1));else for(et=0;et<ct;et++)et%2==0?(Ct.push(vt.getX(et)),Ct.push(vt.getX(et+1)),Ct.push(vt.getX(et+2))):(Ct.push(vt.getX(et+2)),Ct.push(vt.getX(et+1)),Ct.push(vt.getX(et)));return Ct.length/3!==ct&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles."),gt=gt.clone(),gt.setIndex(Ct),gt}t.prototype=ut(at(si.prototype),{constructor:t,load:function(gt,mt,vt,Ct){var et=this,ct=this.resourcePath!==""?this.resourcePath:this.path!==""?this.path:Zc.extractUrlBase(gt);et.manager.itemStart(gt);var ft=function(kt){Ct?Ct(kt):console.error(kt),et.manager.itemError(gt),et.manager.itemEnd(gt)},Tt=new Ms(et.manager);Tt.setPath(this.path),Tt.setResponseType("arraybuffer"),Tt.setRequestHeader(this.requestHeader),et.crossOrigin==="use-credentials"&&Tt.setWithCredentials(!0),Tt.load(gt,function(kt){try{et.parse(kt,ct,function(Jt){mt(Jt),et.manager.itemEnd(gt)},ft)}catch(Jt){ft(Jt)}},vt,ft)},setDRACOLoader:function(gt){return this.dracoLoader=gt,this},setDDSLoader:function(gt){return this.ddsLoader=gt,this},parse:function(gt,mt,vt,Ct){var et={};if(typeof gt!="string")if(Zc.decodeText(new Uint8Array(gt,0,4))===Ht){try{et[zt.KHR_BINARY_GLTF]=new g(gt)}catch(kt){Ct&&Ct(kt);return}gt=et[zt.KHR_BINARY_GLTF].content}else gt=Zc.decodeText(new Uint8Array(gt));if(gt=JSON.parse(gt),gt.asset===void 0||2>gt.asset.version[0])Ct&&Ct(Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{if(gt.extensionsUsed)for(var ct=0;ct<gt.extensionsUsed.length;++ct){var ft=gt.extensionsUsed[ct],Tt=gt.extensionsRequired||[];switch(ft){case zt.KHR_LIGHTS_PUNCTUAL:et[ft]=new s(gt);break;case zt.KHR_MATERIALS_CLEARCOAT:et[ft]=new c;break;case zt.KHR_MATERIALS_UNLIT:et[ft]=new f;break;case zt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:et[ft]=new N;break;case zt.KHR_DRACO_MESH_COMPRESSION:et[ft]=new p(gt,this.dracoLoader);break;case zt.MSFT_TEXTURE_DDS:et[ft]=new i(this.ddsLoader);break;case zt.KHR_TEXTURE_TRANSFORM:et[ft]=new A;break;case zt.KHR_MESH_QUANTIZATION:et[ft]=new _;break;default:0<=Tt.indexOf(ft)&&console.warn('THREE.GLTFLoader: Unknown extension "'+ft+'".')}}mt=new ot(gt,et,{path:mt||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager}),mt.fileLoader.setRequestHeader(this.requestHeader),mt.parse(vt,Ct)}}});var zt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};s.prototype.loadLight=function(gt){var mt=this.lightDefs[gt],vt=new Ue(16777215);mt.color!==void 0&&vt.fromArray(mt.color);var Ct=mt.range!==void 0?mt.range:0;switch(mt.type){case"directional":vt=new ri(vt),vt.target.position.set(0,0,-1),vt.add(vt.target);break;case"point":vt=new Al(vt),vt.distance=Ct;break;case"spot":vt=new jf(vt),vt.distance=Ct,mt.spot=mt.spot||{},mt.spot.innerConeAngle=mt.spot.innerConeAngle!==void 0?mt.spot.innerConeAngle:0,mt.spot.outerConeAngle=mt.spot.outerConeAngle!==void 0?mt.spot.outerConeAngle:Math.PI/4,vt.angle=mt.spot.outerConeAngle,vt.penumbra=1-mt.spot.innerConeAngle/mt.spot.outerConeAngle,vt.target.position.set(0,0,-1),vt.add(vt.target);break;default:throw Error('THREE.GLTFLoader: Unexpected light type, "'+mt.type+'".')}return vt.position.set(0,0,0),vt.decay=2,mt.intensity!==void 0&&(vt.intensity=mt.intensity),vt.name=mt.name||"light_"+gt,Di.resolve(vt)},f.prototype.getMaterialType=function(){return ro},f.prototype.extendParams=function(gt,mt,vt){var Ct=[];if(gt.color=new Ue(1,1,1),gt.opacity=1,mt=mt.pbrMetallicRoughness){if(Array.isArray(mt.baseColorFactor)){var et=mt.baseColorFactor;gt.color.fromArray(et),gt.opacity=et[3]}mt.baseColorTexture!==void 0&&Ct.push(vt.assignTexture(gt,"map",mt.baseColorTexture))}return Di.all(Ct)},c.prototype.getMaterialType=function(){return ns},c.prototype.extendParams=function(gt,mt,vt){var Ct=[];return mt=mt.extensions[this.name],mt.clearcoatFactor!==void 0&&(gt.clearcoat=mt.clearcoatFactor),mt.clearcoatTexture!==void 0&&Ct.push(vt.assignTexture(gt,"clearcoatMap",mt.clearcoatTexture)),mt.clearcoatRoughnessFactor!==void 0&&(gt.clearcoatRoughness=mt.clearcoatRoughnessFactor),mt.clearcoatRoughnessTexture!==void 0&&Ct.push(vt.assignTexture(gt,"clearcoatRoughnessMap",mt.clearcoatRoughnessTexture)),mt.clearcoatNormalTexture!==void 0&&(Ct.push(vt.assignTexture(gt,"clearcoatNormalMap",mt.clearcoatNormalTexture)),mt.clearcoatNormalTexture.scale!==void 0&&(vt=mt.clearcoatNormalTexture.scale,gt.clearcoatNormalScale=new st(vt,vt))),Di.all(Ct)};var Ht="glTF",$t=12,Vt={JSON:1313821514,BIN:5130562};p.prototype.decodePrimitive=function(gt,mt){var vt=this.json,Ct=this.dracoLoader,et=gt.extensions[this.name].bufferView,ct=gt.extensions[this.name].attributes,ft={},Tt={},kt={},Jt;for(Jt in ct){var pt=gr[Jt]||Jt.toLowerCase();ft[pt]=ct[Jt]}for(Jt in gt.attributes)if(pt=gr[Jt]||Jt.toLowerCase(),ct[Jt]!==void 0){var me=vt.accessors[gt.attributes[Jt]];kt[pt]=Kt[me.componentType],Tt[pt]=me.normalized===!0}return mt.getDependency("bufferView",et).then(function(Ae){return new Di(function(de){Ct.decodeDracoFile(Ae,function(ie){for(var Te in ie.attributes){var mr=ie.attributes[Te],Nr=Tt[Te];Nr!==void 0&&(mr.normalized=Nr)}de(ie)},ft,kt)})})},A.prototype.extendTexture=function(gt,mt){return gt=gt.clone(),mt.offset!==void 0&&gt.offset.fromArray(mt.offset),mt.rotation!==void 0&&(gt.rotation=mt.rotation),mt.scale!==void 0&&gt.repeat.fromArray(mt.scale),mt.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),gt.needsUpdate=!0,gt},S.prototype=at(Lo.prototype),S.prototype.constructor=S,S.prototype.copy=function(gt){return Lo.prototype.copy.call(this,gt),this.specularMap=gt.specularMap,this.specular.copy(gt.specular),this.glossinessMap=gt.glossinessMap,this.glossiness=gt.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},I.prototype=at(os.prototype),I.prototype.constructor=I,I.prototype.copySampleValue_=function(gt){var mt=this.resultBuffer,vt=this.sampleValues,Ct=this.valueSize;gt=gt*Ct*3+Ct;for(var et=0;et!==Ct;et++)mt[et]=vt[gt+et];return mt},I.prototype.beforeStart_=I.prototype.copySampleValue_,I.prototype.afterEnd_=I.prototype.copySampleValue_,I.prototype.interpolate_=function(gt,mt,vt,Ct){var et=this.resultBuffer,ct=this.sampleValues,ft=this.valueSize,Tt=2*ft,kt=3*ft;Ct-=mt,mt=(vt-mt)/Ct,vt=mt*mt;var Jt=vt*mt;gt*=kt,kt=gt-kt;var pt=-2*Jt+3*vt;Jt-=vt;var me=1-pt;for(mt=Jt-vt+mt,vt=0;vt!==ft;vt++)et[vt]=me*ct[kt+vt+ft]+mt*ct[kt+vt+Tt]*Ct+pt*ct[gt+vt+ft]+Jt*ct[gt+vt]*Ct;return et};var Kt={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},ze={9728:1003,9729:1006,9984:1004,9985:1007,9986:1005,9987:1008},ae={33071:1001,33648:1002,10497:1e3},Qe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},gr={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},ir={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},gi={CUBICSPLINE:void 0,LINEAR:2301,STEP:2300},hr={"image/png":1023,"image/jpeg":1022};return ot.prototype.parse=function(gt,mt){var vt=this,Ct=this.json,et=this.extensions;this.cache.removeAll(),this.markDefs(),Di.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then(function(ct){ct={scene:ct[0][Ct.scene||0],scenes:ct[0],animations:ct[1],cameras:ct[2],asset:Ct.asset,parser:vt,userData:{}},F(et,ct,Ct),W(ct,Ct),gt(ct)}).catch(mt)},ot.prototype.markDefs=function(){for(var gt=this.json.nodes||[],mt=this.json.skins||[],vt=this.json.meshes||[],Ct={},et={},ct=0,ft=mt.length;ct<ft;ct++)for(var Tt=mt[ct].joints,kt=0,Jt=Tt.length;kt<Jt;kt++)gt[Tt[kt]].isBone=!0;for(mt=0,ct=gt.length;mt<ct;mt++)ft=gt[mt],ft.mesh!==void 0&&(Ct[ft.mesh]===void 0&&(Ct[ft.mesh]=et[ft.mesh]=0),Ct[ft.mesh]++,ft.skin!==void 0&&(vt[ft.mesh].isSkinnedMesh=!0));this.json.meshReferences=Ct,this.json.meshUses=et},ot.prototype.getDependency=function(gt,mt){var vt=gt+":"+mt,Ct=this.cache.get(vt);if(!Ct){switch(gt){case"scene":Ct=this.loadScene(mt);break;case"node":Ct=this.loadNode(mt);break;case"mesh":Ct=this.loadMesh(mt);break;case"accessor":Ct=this.loadAccessor(mt);break;case"bufferView":Ct=this.loadBufferView(mt);break;case"buffer":Ct=this.loadBuffer(mt);break;case"material":Ct=this.loadMaterial(mt);break;case"texture":Ct=this.loadTexture(mt);break;case"skin":Ct=this.loadSkin(mt);break;case"animation":Ct=this.loadAnimation(mt);break;case"camera":Ct=this.loadCamera(mt);break;case"light":Ct=this.extensions[zt.KHR_LIGHTS_PUNCTUAL].loadLight(mt);break;default:throw Error("Unknown type: "+gt)}this.cache.add(vt,Ct)}return Ct},ot.prototype.getDependencies=function(gt){var mt=this.cache.get(gt);if(!mt){var vt=this;mt=Di.all((this.json[gt+(gt==="mesh"?"es":"s")]||[]).map(function(Ct,et){return vt.getDependency(gt,et)})),this.cache.add(gt,mt)}return mt},ot.prototype.loadBuffer=function(gt){var mt=this.json.buffers[gt],vt=this.fileLoader;if(mt.type&&mt.type!=="arraybuffer")throw Error("THREE.GLTFLoader: "+mt.type+" buffer type is not supported.");if(mt.uri===void 0&&gt===0)return Di.resolve(this.extensions[zt.KHR_BINARY_GLTF].body);var Ct=this.options;return new Di(function(et,ct){vt.load(L(mt.uri,Ct.path),et,void 0,function(){ct(Error('THREE.GLTFLoader: Failed to load buffer "'+mt.uri+'".'))})})},ot.prototype.loadBufferView=function(gt){var mt=this.json.bufferViews[gt];return this.getDependency("buffer",mt.buffer).then(function(vt){var Ct=mt.byteOffset||0;return vt.slice(Ct,Ct+(mt.byteLength||0))})},ot.prototype.loadAccessor=function(gt){var mt=this,vt=this.json,Ct=this.json.accessors[gt];return Ct.bufferView===void 0&&Ct.sparse===void 0?Di.resolve(null):(gt=[],Ct.bufferView!==void 0?gt.push(this.getDependency("bufferView",Ct.bufferView)):gt.push(null),Ct.sparse!==void 0&&(gt.push(this.getDependency("bufferView",Ct.sparse.indices.bufferView)),gt.push(this.getDependency("bufferView",Ct.sparse.values.bufferView))),Di.all(gt).then(function(et){var ct=et[0],ft=Qe[Ct.type],Tt=Kt[Ct.componentType],kt=Tt.BYTES_PER_ELEMENT,Jt=Ct.byteOffset||0,pt=Ct.bufferView!==void 0?vt.bufferViews[Ct.bufferView].byteStride:void 0,me=Ct.normalized===!0;if(pt&&pt!==kt*ft){var Ae=Math.floor(Jt/pt),de="InterleavedBuffer:"+Ct.bufferView+":"+Ct.componentType+":"+Ae+":"+Ct.count,ie=mt.cache.get(de);ie||(Ae=new Tt(ct,Ae*pt,Ct.count*pt/kt),ie=new As(Ae,pt/kt),mt.cache.add(de,ie)),kt=new hl(ie,ft,Jt%pt/kt,me)}else Ae=ct===null?new Tt(Ct.count*ft):new Tt(ct,Jt,Ct.count*ft),kt=new Ir(Ae,ft,me);if(Ct.sparse!==void 0){for(pt=Ct.sparse.values.byteOffset||0,Jt=new Kt[Ct.sparse.indices.componentType](et[1],Ct.sparse.indices.byteOffset||0,Ct.sparse.count*Qe.SCALAR),et=new Tt(et[2],pt,Ct.sparse.count*ft),ct!==null&&(kt=new Ir(kt.array.slice(),kt.itemSize,kt.normalized)),ct=0,Tt=Jt.length;ct<Tt;ct++)if(pt=Jt[ct],kt.setX(pt,et[ct*ft]),2<=ft&&kt.setY(pt,et[ct*ft+1]),3<=ft&&kt.setZ(pt,et[ct*ft+2]),4<=ft&&kt.setW(pt,et[ct*ft+3]),5<=ft)throw Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}return kt}))},ot.prototype.loadTexture=function(gt){var mt=this,vt=this.json,Ct=this.options,et=this.textureLoader,ct=self.URL||self.webkitURL,ft=vt.textures[gt],Tt=ft.extensions||{},kt=Tt[zt.MSFT_TEXTURE_DDS]?vt.images[Tt[zt.MSFT_TEXTURE_DDS].source]:vt.images[ft.source],Jt=kt.uri,pt=!1;return kt.bufferView!==void 0&&(Jt=mt.getDependency("bufferView",kt.bufferView).then(function(me){return pt=!0,me=new Blob([me],{type:kt.mimeType}),Jt=ct.createObjectURL(me)})),Di.resolve(Jt).then(function(me){var Ae=Ct.manager.getHandler(me);return Ae||(Ae=Tt[zt.MSFT_TEXTURE_DDS]?mt.extensions[zt.MSFT_TEXTURE_DDS].ddsLoader:et),new Di(function(de,ie){Ae.load(L(me,Ct.path),de,void 0,ie)})}).then(function(me){pt===!0&&ct.revokeObjectURL(Jt),me.flipY=!1,ft.name&&(me.name=ft.name),kt.mimeType in hr&&(me.format=hr[kt.mimeType]);var Ae=(vt.samplers||{})[ft.sampler]||{};return me.magFilter=ze[Ae.magFilter]||1006,me.minFilter=ze[Ae.minFilter]||1008,me.wrapS=ae[Ae.wrapS]||1e3,me.wrapT=ae[Ae.wrapT]||1e3,mt.associations.set(me,{type:"textures",index:gt}),me})},ot.prototype.assignTexture=function(gt,mt,vt){var Ct=this;return this.getDependency("texture",vt.index).then(function(et){if(!et.isCompressedTexture)switch(mt){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":et.format=1022}if(vt.texCoord===void 0||vt.texCoord==0||mt==="aoMap"&&vt.texCoord==1||console.warn("THREE.GLTFLoader: Custom UV set "+vt.texCoord+" for texture "+mt+" not yet supported."),Ct.extensions[zt.KHR_TEXTURE_TRANSFORM]){var ct=vt.extensions!==void 0?vt.extensions[zt.KHR_TEXTURE_TRANSFORM]:void 0;if(ct){var ft=Ct.associations.get(et);et=Ct.extensions[zt.KHR_TEXTURE_TRANSFORM].extendTexture(et,ct),Ct.associations.set(et,ft)}}gt[mt]=et})},ot.prototype.assignFinalMaterial=function(gt){var mt=gt.geometry,vt=gt.material,Ct=mt.attributes.tangent!==void 0,et=mt.attributes.color!==void 0,ct=mt.attributes.normal===void 0,ft=gt.isSkinnedMesh===!0,Tt=0<qi(mt.morphAttributes).length,kt=Tt&&mt.morphAttributes.normal!==void 0;if(gt.isPoints){var Jt="PointsMaterial:"+vt.uuid,pt=this.cache.get(Jt);pt||(pt=new Xs,kr.prototype.copy.call(pt,vt),pt.color.copy(vt.color),pt.map=vt.map,pt.sizeAttenuation=!1,this.cache.add(Jt,pt)),vt=pt}else gt.isLine&&(Jt="LineBasicMaterial:"+vt.uuid,pt=this.cache.get(Jt),pt||(pt=new yn,kr.prototype.copy.call(pt,vt),pt.color.copy(vt.color),this.cache.add(Jt,pt)),vt=pt);(Ct||et||ct||ft||Tt)&&(Jt="ClonedMaterial:"+vt.uuid+":",vt.isGLTFSpecularGlossinessMaterial&&(Jt+="specular-glossiness:"),ft&&(Jt+="skinning:"),Ct&&(Jt+="vertex-tangents:"),et&&(Jt+="vertex-colors:"),ct&&(Jt+="flat-shading:"),Tt&&(Jt+="morph-targets:"),kt&&(Jt+="morph-normals:"),pt=this.cache.get(Jt),pt||(pt=vt.clone(),ft&&(pt.skinning=!0),Ct&&(pt.vertexTangents=!0),et&&(pt.vertexColors=!0),ct&&(pt.flatShading=!0),Tt&&(pt.morphTargets=!0),kt&&(pt.morphNormals=!0),this.cache.add(Jt,pt),this.associations.set(pt,this.associations.get(vt))),vt=pt),vt.aoMap&&mt.attributes.uv2===void 0&&mt.attributes.uv!==void 0&&mt.setAttribute("uv2",mt.attributes.uv),vt.normalScale&&!Ct&&(vt.normalScale.y=-vt.normalScale.y),vt.clearcoatNormalScale&&!Ct&&(vt.clearcoatNormalScale.y=-vt.clearcoatNormalScale.y),gt.material=vt},ot.prototype.loadMaterial=function(gt){var mt=this,vt=this.extensions,Ct=this.json.materials[gt],et={},ct=Ct.extensions||{},ft=[];if(ct[zt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var Tt=vt[zt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS],kt=Tt.getMaterialType();ft.push(Tt.extendParams(et,Ct,mt))}else if(ct[zt.KHR_MATERIALS_UNLIT])Tt=vt[zt.KHR_MATERIALS_UNLIT],kt=Tt.getMaterialType(),ft.push(Tt.extendParams(et,Ct,mt));else{if(kt=Lo,Tt=Ct.pbrMetallicRoughness||{},et.color=new Ue(1,1,1),et.opacity=1,Array.isArray(Tt.baseColorFactor)){var Jt=Tt.baseColorFactor;et.color.fromArray(Jt),et.opacity=Jt[3]}Tt.baseColorTexture!==void 0&&ft.push(mt.assignTexture(et,"map",Tt.baseColorTexture)),et.metalness=Tt.metallicFactor!==void 0?Tt.metallicFactor:1,et.roughness=Tt.roughnessFactor!==void 0?Tt.roughnessFactor:1,Tt.metallicRoughnessTexture!==void 0&&(ft.push(mt.assignTexture(et,"metalnessMap",Tt.metallicRoughnessTexture)),ft.push(mt.assignTexture(et,"roughnessMap",Tt.metallicRoughnessTexture)))}return Ct.doubleSided===!0&&(et.side=2),Tt=Ct.alphaMode||"OPAQUE",Tt==="BLEND"?(et.transparent=!0,et.depthWrite=!1):(et.transparent=!1,Tt==="MASK"&&(et.alphaTest=Ct.alphaCutoff!==void 0?Ct.alphaCutoff:.5)),Ct.normalTexture!==void 0&&kt!==ro&&(ft.push(mt.assignTexture(et,"normalMap",Ct.normalTexture)),et.normalScale=new st(1,1),Ct.normalTexture.scale!==void 0&&et.normalScale.set(Ct.normalTexture.scale,Ct.normalTexture.scale)),Ct.occlusionTexture!==void 0&&kt!==ro&&(ft.push(mt.assignTexture(et,"aoMap",Ct.occlusionTexture)),Ct.occlusionTexture.strength!==void 0&&(et.aoMapIntensity=Ct.occlusionTexture.strength)),Ct.emissiveFactor!==void 0&&kt!==ro&&(et.emissive=new Ue().fromArray(Ct.emissiveFactor)),Ct.emissiveTexture!==void 0&&kt!==ro&&ft.push(mt.assignTexture(et,"emissiveMap",Ct.emissiveTexture)),ct[zt.KHR_MATERIALS_CLEARCOAT]&&(Tt=vt[zt.KHR_MATERIALS_CLEARCOAT],kt=Tt.getMaterialType(),ft.push(Tt.extendParams(et,{extensions:ct},mt))),Di.all(ft).then(function(){var pt=kt===S?vt[zt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(et):new kt(et);return Ct.name&&(pt.name=Ct.name),pt.map&&(pt.map.encoding=3001),pt.emissiveMap&&(pt.emissiveMap.encoding=3001),W(pt,Ct),mt.associations.set(pt,{type:"materials",index:gt}),Ct.extensions&&F(vt,pt,Ct),pt})},ot.prototype.loadGeometries=function(gt){function mt(me){return Ct[zt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(me,vt).then(function(Ae){return At(Ae,me,vt)})}for(var vt=this,Ct=this.extensions,et=this.primitiveCache,ct=[],ft=0,Tt=gt.length;ft<Tt;ft++){var kt=gt[ft],Jt=Z(kt),pt=et[Jt];pt?ct.push(pt.promise):(pt=kt.extensions&&kt.extensions[zt.KHR_DRACO_MESH_COMPRESSION]?mt(kt):At(new Ge,kt,vt),et[Jt]={primitive:kt,promise:pt},ct.push(pt))}return Di.all(ct)},ot.prototype.loadMesh=function(gt){for(var mt=this,vt=this.json.meshes[gt],Ct=vt.primitives,et=[],ct=0,ft=Ct.length;ct<ft;ct++){var Tt=Ct[ct].material===void 0?P(this.cache):this.getDependency("material",Ct[ct].material);et.push(Tt)}return et.push(mt.loadGeometries(Ct)),Di.all(et).then(function(kt){var Jt=kt.slice(0,kt.length-1),pt=kt[kt.length-1];kt=[];for(var me=0,Ae=pt.length;me<Ae;me++){var de=pt[me],ie=Ct[me],Te=Jt[me];if(ie.mode===4||ie.mode===5||ie.mode===6||ie.mode===void 0)de=vt.isSkinnedMesh===!0?new Pa(de,Te):new dn(de,Te),de.isSkinnedMesh!==!0||de.geometry.attributes.skinWeight.normalized||de.normalizeSkinWeights(),ie.mode===5?de.geometry=yt(de.geometry,1):ie.mode===6&&(de.geometry=yt(de.geometry,2));else if(ie.mode===1)de=new zn(de,Te);else if(ie.mode===3)de=new js(de,Te);else if(ie.mode===2)de=new Un(de,Te);else if(ie.mode===0)de=new Cu(de,Te);else throw Error("THREE.GLTFLoader: Primitive mode unsupported: "+ie.mode);if(0<qi(de.geometry.morphAttributes).length){ie=de;var mr=vt;if(ie.updateMorphTargets(),mr.weights!==void 0){Te=0;for(var Nr=mr.weights.length;Te<Nr;Te++)ie.morphTargetInfluences[Te]=mr.weights[Te]}if(mr.extras&&Array.isArray(mr.extras.targetNames))if(mr=mr.extras.targetNames,ie.morphTargetInfluences.length===mr.length)for(ie.morphTargetDictionary={},Te=0,Nr=mr.length;Te<Nr;Te++)ie.morphTargetDictionary[mr[Te]]=Te;else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}de.name=vt.name||"mesh_"+gt,1<pt.length&&(de.name+="_"+me),W(de,vt),mt.assignFinalMaterial(de),kt.push(de)}if(kt.length===1)return kt[0];for(Jt=new ys,me=0,Ae=kt.length;me<Ae;me++)Jt.add(kt[me]);return Jt})},ot.prototype.loadCamera=function(gt){var mt;gt=this.json.cameras[gt];var vt=gt[gt.type];if(vt)return gt.type==="perspective"?mt=new Cr(Ar.radToDeg(vt.yfov),vt.aspectRatio||1,vt.znear||1,vt.zfar||2e6):gt.type==="orthographic"&&(mt=new Ba(-vt.xmag,vt.xmag,vt.ymag,-vt.ymag,vt.znear,vt.zfar)),gt.name&&(mt.name=gt.name),W(mt,gt),Di.resolve(mt);console.warn("THREE.GLTFLoader: Missing camera parameters.")},ot.prototype.loadSkin=function(gt){gt=this.json.skins[gt];var mt={joints:gt.joints};return gt.inverseBindMatrices===void 0?Di.resolve(mt):this.getDependency("accessor",gt.inverseBindMatrices).then(function(vt){return mt.inverseBindMatrices=vt,mt})},ot.prototype.loadAnimation=function(gt){for(var mt=this.json.animations[gt],vt=[],Ct=[],et=[],ct=[],ft=[],Tt=0,kt=mt.channels.length;Tt<kt;Tt++){var Jt=mt.channels[Tt],pt=mt.samplers[Jt.sampler];Jt=Jt.target;var me=mt.parameters!==void 0?mt.parameters[pt.input]:pt.input,Ae=mt.parameters!==void 0?mt.parameters[pt.output]:pt.output;vt.push(this.getDependency("node",Jt.node!==void 0?Jt.node:Jt.id)),Ct.push(this.getDependency("accessor",me)),et.push(this.getDependency("accessor",Ae)),ct.push(pt),ft.push(Jt)}return Di.all([Di.all(vt),Di.all(Ct),Di.all(et),Di.all(ct),Di.all(ft)]).then(function(de){var ie=de[0],Te=de[1],mr=de[2],Nr=de[3];de=de[4];for(var we=[],nr=0,Jr=ie.length;nr<Jr;nr++){var je=ie[nr],$n=Te[nr],Oi=mr[nr],hs=Nr[nr],gu=de[nr];if(je!==void 0){switch(je.updateMatrix(),je.matrixAutoUpdate=!0,ir[gu.path]){case ir.weights:var Vh=vh;break;case ir.rotation:Vh=wc;break;default:Vh=yh}var xa=je.name?je.name:je.uuid,Wl=hs.interpolation!==void 0?gi[hs.interpolation]:2301,jl=[];if(ir[gu.path]===ir.weights?je.traverse(function(es){es.isMesh===!0&&es.morphTargetInfluences&&jl.push(es.name?es.name:es.uuid)}):jl.push(xa),je=Oi.array,Oi.normalized){if(je.constructor===Int8Array)var ta=1/127;else if(je.constructor===Uint8Array)ta=1/255;else if(je.constructor==Int16Array)ta=1/32767;else if(je.constructor===Uint16Array)ta=1/65535;else throw Error("THREE.GLTFLoader: Unsupported output accessor component type.");var Xu=new Float32Array(je.length);for(Oi=0,xa=je.length;Oi<xa;Oi++)Xu[Oi]=je[Oi]*ta;je=Xu}for(Oi=0,xa=jl.length;Oi<xa;Oi++)ta=new Vh(jl[Oi]+"."+ir[gu.path],$n.array,je,Wl),hs.interpolation==="CUBICSPLINE"&&(ta.createInterpolant=function(es){return new I(this.times,this.values,this.getValueSize()/3,es)},ta.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),we.push(ta)}}return new ha(mt.name?mt.name:"animation_"+gt,void 0,we)})},ot.prototype.loadNode=function(gt){var mt=this.json,vt=this.extensions,Ct=this,et=mt.meshReferences,ct=mt.meshUses,ft=mt.nodes[gt];return function(){var Tt=[];return ft.mesh!==void 0&&Tt.push(Ct.getDependency("mesh",ft.mesh).then(function(kt){if(1<et[ft.mesh]){var Jt=ct[ft.mesh]++;kt=kt.clone(),kt.name+="_instance_"+Jt}return ft.weights!==void 0&&kt.traverse(function(pt){if(pt.isMesh)for(var me=0,Ae=ft.weights.length;me<Ae;me++)pt.morphTargetInfluences[me]=ft.weights[me]}),kt})),ft.camera!==void 0&&Tt.push(Ct.getDependency("camera",ft.camera)),ft.extensions&&ft.extensions[zt.KHR_LIGHTS_PUNCTUAL]&&ft.extensions[zt.KHR_LIGHTS_PUNCTUAL].light!==void 0&&Tt.push(Ct.getDependency("light",ft.extensions[zt.KHR_LIGHTS_PUNCTUAL].light)),Di.all(Tt)}().then(function(Tt){var kt=ft.isBone===!0?new Io:1<Tt.length?new ys:Tt.length===1?Tt[0]:new Ce;if(kt!==Tt[0])for(var Jt=0,pt=Tt.length;Jt<pt;Jt++)kt.add(Tt[Jt]);return ft.name&&(kt.userData.name=ft.name,kt.name=wo.sanitizeNodeName(ft.name)),W(kt,ft),ft.extensions&&F(vt,kt,ft),ft.matrix!==void 0?(Tt=new ye,Tt.fromArray(ft.matrix),kt.applyMatrix4(Tt)):(ft.translation!==void 0&&kt.position.fromArray(ft.translation),ft.rotation!==void 0&&kt.quaternion.fromArray(ft.rotation),ft.scale!==void 0&&kt.scale.fromArray(ft.scale)),Ct.associations.set(kt,{type:"nodes",index:gt}),kt})},ot.prototype.loadScene=function(){function gt(mt,vt,Ct,et){var ct=Ct.nodes[mt];return et.getDependency("node",mt).then(function(ft){if(ct.skin===void 0)return ft;var Tt;return et.getDependency("skin",ct.skin).then(function(kt){Tt=kt,kt=[];for(var Jt=0,pt=Tt.joints.length;Jt<pt;Jt++)kt.push(et.getDependency("node",Tt.joints[Jt]));return Di.all(kt)}).then(function(kt){return ft.traverse(function(Jt){if(Jt.isMesh){for(var pt=[],me=[],Ae=0,de=kt.length;Ae<de;Ae++){var ie=kt[Ae];ie?(pt.push(ie),ie=new ye,Tt.inverseBindMatrices!==void 0&&ie.fromArray(Tt.inverseBindMatrices.array,16*Ae),me.push(ie)):console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',Tt.joints[Ae])}Jt.bind(new aa(pt,me),Jt.matrixWorld)}}),ft})}).then(function(ft){vt.add(ft);var Tt=[];if(ct.children)for(var kt=ct.children,Jt=0,pt=kt.length;Jt<pt;Jt++)Tt.push(gt(kt[Jt],ft,Ct,et));return Di.all(Tt)})}return function(mt){var vt=this.json,Ct=this.extensions;mt=this.json.scenes[mt];var et=new ys;mt.name&&(et.name=mt.name),W(et,mt),mt.extensions&&F(Ct,et,mt),Ct=mt.nodes||[],mt=[];for(var ct=0,ft=Ct.length;ct<ft;ct++)mt.push(gt(Ct[ct],et,vt,this));return Di.all(mt).then(function(){return et})}}(),t}(),qc={};qc.MTLLoader=Sp,qc.OBJLoader=IC,qc.GLTFLoader=EC;var LC=Rt(function(t,r){r.__esModule=!0;var i=Ha&&Ha.__esModule?Ha:{default:Ha};r.default=function(){function s(f,c){for(var g=0;g<c.length;g++){var p=c[g];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),(0,i.default)(f,p.key,p)}}return function(f,c,g){return c&&s(f.prototype,c),g&&s(f,g),f}}()}),Cn=Nt(LC);Ud(us.prototype,{equals:function(t){return this.lat===t.lat&&this.lng===t.lng},clone:function(){return new us(this.lat,this.lng)},getLngSpan:function(t){return t=Math.abs(t-this.lng),180<t&&(t=360-t),t},sub:function(t){return new us(this.lat-t.lat,this.lng-t.lng)},toString:function(){return"Point"}}),Ud(Pu,{EARTHRADIUS:637099681e-2,MCBAND:[1289059486e-2,836237787e-2,5591021,348198983e-2,167804312e-2,0],LLBAND:[75,60,45,30,15,0],MC2LL:[[1410526172116255e-23,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,173379812e-1],[-7435856389565537e-24,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,1026014486e-2],[-3030883460898826e-23,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,685681737e-2],[-1981981304930552e-23,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,448277706e-2],[309191371068437e-23,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,25551644e-1],[2890871144776878e-24,8983055095805407e-21,-3068298e-14,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],LL2MC:[[-.0015702102444,111320.7020616939,1704480524535203,-10338987376042340,26112667856603880,-35149669176653700,26595700718403920,-10725012454188240,1800819912950474,82.5],[.0008277824516172526,111320.7020463578,6477955746671607e-7,-4082003173641316e-6,1077490566351142e-5,-1517187553151559e-5,1205306533862167e-5,-5124939663577472e-6,9133119359512032e-7,67.5],[.00337398766765,111320.7020202162,4481351045890365e-9,-2339375119931662e-8,7968221547186455e-8,-1159649932797253e-7,9723671115602145e-8,-4366194633752821e-8,8477230501135234e-9,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837749470245e-9,992013.7397791013,-122195221711287e-8,1340652697009075e-9,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758690035394e-9,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]],getDistanceByMC:function(t,r){if(!t||!r||(t=this.convertMC2LL(t),!t))return 0;var i=this.toRadians(t.lng);if(t=this.toRadians(t.lat),r=this.convertMC2LL(r),!r)return 0;var s=this.toRadians(r.lng);return r=this.toRadians(r.lat),this.getDistance(i,s,t,r)},getDistanceByLL:function(t,r){if(!t||!r)return 0;t.lng=this.getLoop(t.lng,-180,180),t.lat=this.getRange(t.lat,-74,74),r.lng=this.getLoop(r.lng,-180,180),r.lat=this.getRange(r.lat,-74,74);var i=this.toRadians(t.lng),s=this.toRadians(t.lat);return t=this.toRadians(r.lng),r=this.toRadians(r.lat),this.getDistance(i,t,s,r)},convertMC2LL:function(t){if(t==null)return new us(0,0);if(180>t.lng&&-180<t.lng&&90>t.lat&&-90<t.lat)return t;if(window.BMAPGL_84)return new us(180/Math.PI*(2*Math.atan(Math.exp(t.lat/2003750834e-2*180*Math.PI/180))-Math.PI/2),t.lng/2003750834e-2*180);for(var r=new us(Math.abs(t.lng),Math.abs(t.lat)),i=0;i<this.MCBAND.length;i++)if(r.lat>=this.MCBAND[i]){var s=this.MC2LL[i];break}return t=this.convertor(t,s),t=new us(t.lng.toFixed(6),t.lat.toFixed(6))},convertLL2MC:function(t){if(t==null)return new us(0,0);if(180<t.lng||-180>t.lng||90<t.lat||-90>t.lat)return t;if(window.BMAPGL_84){var r=t.lat*Math.PI/180;return new us(t.lng*Math.PI/180*6378137,31890685e-1*Math.log((1+Math.sin(r))/(1-Math.sin(r))))}t.lng=this.getLoop(t.lng,-180,180),t.lat=this.getRange(t.lat,-74,74),r=new us(t.lng,t.lat);for(var i=0;i<this.LLBAND.length;i++)if(r.lat>=this.LLBAND[i]){var s=this.LL2MC[i];break}if(!s){for(i=0;i<this.LLBAND.length;i++)if(r.lat<=-this.LLBAND[i]){s=this.LL2MC[i];break}}return t=this.convertor(t,s),t=new us(Number(t.lng.toFixed(2)),Number(t.lat.toFixed(2)))},convertor:function(t,r){if(t&&r){var i=r[0]+r[1]*Math.abs(t.lng),s=Math.abs(t.lat)/r[9];return r=r[2]+r[3]*s+r[4]*s*s+r[5]*s*s*s+r[6]*s*s*s*s+r[7]*s*s*s*s*s+r[8]*s*s*s*s*s*s,i*=0>t.lng?-1:1,r*=0>t.lat?-1:1,new us(i,r)}},getDistance:function(t,r,i,s){return this.EARTHRADIUS*Math.acos(Math.sin(i)*Math.sin(s)+Math.cos(i)*Math.cos(s)*Math.cos(r-t))},toRadians:function(t){return Math.PI*t/180},toDegrees:function(t){return 180*t/Math.PI},getRange:function(t,r,i){return r!=null&&(t=Math.max(t,r)),i!=null&&(t=Math.min(t,i)),t},getLoop:function(t,r,i){for(;t>i;)t-=i-r;for(;t<r;)t+=i-r;return t}}),Ud(Pu.prototype,{lngLatToMercator:function(t){return Pu.convertLL2MC(t)},lngLatToPoint:function(t){return t=Pu.convertLL2MC(t),new Hd(t.lng,t.lat)},mercatorToLngLat:function(t){return Pu.convertMC2LL(t)},pointToLngLat:function(t){return t=new us(t.x,t.y),Pu.convertMC2LL(t)},pointToPixel:function(t,r,i,s,f){if(t)return t=this.lngLatToMercator(t,f),r=this.getZoomUnits(r),new Hd(Math.round((t.lng-i.lng)/r+s.width/2),Math.round((i.lat-t.lat)/r+s.height/2))},pixelToPoint:function(t,r,i,s,f){if(t)return r=this.getZoomUnits(r),t=new us(i.lng+r*(t.x-s.width/2),i.lat-r*(t.y-s.height/2)),this.mercatorToLngLat(t,f)},getZoomUnits:function(t){return Math.pow(2,18-t)}});var RC=Rt(function(t,r){r.__esModule=!0;var i=Pc&&Pc.__esModule?Pc:{default:Pc};r.default=function(s){if(Array.isArray(s)){for(var f=0,c=Array(s.length);f<s.length;f++)c[f]=s[f];return c}return(0,i.default)(s)}}),u_=Nt(RC);(function(){function t(){var r=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};Ji(this,t),this.options=r,this._initialize()}return Cn(t,[{key:"_initialize",value:function(){this.points=this.options.points}},{key:"_normalizaCoord",value:function(r){return r?(r instanceof Array&&(r={lng:Number(r[0]),lat:Number(r[1])}),Pu.convertLL2MC(r)):null}},{key:"setOptions",value:function(){this.options=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},this._initialize()}},{key:"getPoints",value:function(r){for(var i=[],s=this.points,f=0;f<s.length-1;f++){var c=this.getCurveByTwoPoints(this._normalizaCoord(s[f]),this._normalizaCoord(s[f+1]),r);c&&0<c.length&&(i=i.concat(c))}return i}},{key:"getCurveByTwoPoints",value:function(r,i){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:20;if(!r||!i)return null;var f=[],c=0;if((typeof i=="undefined"?"undefined":Ua(i))===void 0)typeof f=="undefined"||Ua(f);else{var g=parseFloat(r.lat),p=parseFloat(i.lat),A=parseFloat(r.lng),S=parseFloat(i.lng);S>A&&180<parseFloat(S-A)&&0>A&&(A=parseFloat(360+A),S=parseFloat(360+S));var N=0;if(p===g)var _=0,I=A-S;else S===A?(_=Math.PI/2,I=g-p):(_=Math.atan((p-g)/(S-A)),I=(p-g)/Math.sin(_));for(N===0&&(N=_+Math.PI/5),I/=2,_=I*Math.cos(N)+A,N=I*Math.sin(N)+g,I=0;I<s+1;I++){var L=A*(1-2*c+c*c)+_*(2*c-2*c*c)+S*c*c,P=i.lng;f.push([0>r.lng&&0<P?L-360:L,g*(1-2*c+c*c)+N*(2*c-2*c*c)+p*c*c]),c+=1/s}return f}}}]),t})();var Ov=void 0,PC=function(){if(Ov!==void 0)return Ov;var t=navigator.userAgent,r="Android;iPhone;SymbianOS;Windows Phone;iPad;iPod".split(";");Ov=!1;for(var i=0;i<r.length;i++)if(0<t.indexOf(r[i])){Ov=!0;break}return Ov}(),Fv=void 0;(function(){if(Fv!==void 0)return Fv;var t=navigator.userAgent,r=["iPhone","iPad","iPod"];Fv=!1;for(var i=0;i<r.length;i++)if(0<t.indexOf(r[i])){Fv=!0;break}return Fv})(),Ch(Array(576)),Ch(Array(60)),Ch(Array(512)),Ch(Array(256)),Ch(Array(29)),Ch(Array(30)),new Uint32Array(function(){for(var t,r=[],i=0;256>i;i++){t=i;for(var s=0;8>s;s++)t=t&1?3988292384^t>>>1:t>>>1;r[i]=t}return r}());try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){}for(var JA=new Uint8Array(256),Kc=0;256>Kc;Kc++)JA[Kc]=252<=Kc?6:248<=Kc?5:240<=Kc?4:224<=Kc?3:192<=Kc?2:1;JA[254]=JA[254]=1;var Wu={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},DC=sg.f;Uu("getOwnPropertyDescriptor",function(){return function(t,r){return DC(_i(t),r)}});var OC=Li.Object,FC=function(t,r){return OC.getOwnPropertyDescriptor(t,r)},BC=Rt(function(t){t.exports={default:FC,__esModule:!0}}),To=Nt(BC),Bv=Rt(function(t){var r=Array.prototype.concat,i=Array.prototype.slice,s=t.exports=function(f){for(var c=[],g=0,p=f.length;g<p;g++){var A=f[g],S=(S=A)&&typeof S!="string"?S instanceof Array||Array.isArray(S)||0<=S.length&&(S.splice instanceof Function||To(S,S.length-1)&&S.constructor.name!=="String"):!1;S?c=r.call(c,i.call(A)):c.push(A)}return c};s.wrap=function(f){return function(){return f(s(arguments))}}}),Nv=Rt(function(t){function r(g,p,A){return Math.min(Math.max(p,g),A)}function i(g){return g=g.toString(16).toUpperCase(),2>g.length?"0"+g:g}var s={},f;for(f in Wu)Wu.hasOwnProperty(f)&&(s[Wu[f]]=f);var c=t.exports={to:{},get:{}};c.get=function(g){switch(g.substring(0,3).toLowerCase()){case"hsl":g=c.get.hsl(g);var p="hsl";break;case"hwb":g=c.get.hwb(g),p="hwb";break;default:g=c.get.rgb(g),p="rgb"}return g?{model:p,value:g}:null},c.get.rgb=function(g){if(!g)return null;var p=/^#([a-f0-9]{3,4})$/i,A=/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,S=/^rgba?\(\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,N=/(\D+)/,_=[0,0,0,1],I;if(I=g.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(p=I[2],I=I[1],g=0;3>g;g++)A=2*g,_[g]=parseInt(I.slice(A,A+2),16);p&&(_[3]=Math.round(parseInt(p,16)/255*100)/100)}else if(I=g.match(p)){for(I=I[1],p=I[3],g=0;3>g;g++)_[g]=parseInt(I[g]+I[g],16);p&&(_[3]=Math.round(parseInt(p+p,16)/255*100)/100)}else if(I=g.match(A)){for(g=0;3>g;g++)_[g]=parseInt(I[g+1],0);I[4]&&(_[3]=parseFloat(I[4]))}else if(I=g.match(S)){for(g=0;3>g;g++)_[g]=Math.round(2.55*parseFloat(I[g+1]));I[4]&&(_[3]=parseFloat(I[4]))}else return(I=g.match(N))?I[1]==="transparent"?[0,0,0,0]:(_=Wu[I[1]],_?(_[3]=1,_):null):null;for(g=0;3>g;g++)_[g]=r(_[g],0,255);return _[3]=r(_[3],0,1),_},c.get.hsl=function(g){if(!g)return null;var p=g.match(/^hsla?\(\s*([+-]?(?:\d*\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(p){var A=parseFloat(p[4]);g=(parseFloat(p[1])+360)%360;var S=r(parseFloat(p[2]),0,100);return p=r(parseFloat(p[3]),0,100),A=r(isNaN(A)?1:A,0,1),[g,S,p,A]}return null},c.get.hwb=function(g){if(!g)return null;var p=g.match(/^hwb\(\s*([+-]?\d*[\.]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(p){var A=parseFloat(p[4]);g=(parseFloat(p[1])%360+360)%360;var S=r(parseFloat(p[2]),0,100);return p=r(parseFloat(p[3]),0,100),A=r(isNaN(A)?1:A,0,1),[g,S,p,A]}return null},c.to.hex=function(){var g=Bv(arguments);return"#"+i(g[0])+i(g[1])+i(g[2])+(1>g[3]?i(Math.round(255*g[3])):"")},c.to.rgb=function(){var g=Bv(arguments);return 4>g.length||g[3]===1?"rgb("+Math.round(g[0])+", "+Math.round(g[1])+", "+Math.round(g[2])+")":"rgba("+Math.round(g[0])+", "+Math.round(g[1])+", "+Math.round(g[2])+", "+g[3]+")"},c.to.rgb.percent=function(){var g=Bv(arguments),p=Math.round(g[0]/255*100),A=Math.round(g[1]/255*100),S=Math.round(g[2]/255*100);return 4>g.length||g[3]===1?"rgb("+p+"%, "+A+"%, "+S+"%)":"rgba("+p+"%, "+A+"%, "+S+"%, "+g[3]+")"},c.to.hsl=function(){var g=Bv(arguments);return 4>g.length||g[3]===1?"hsl("+g[0]+", "+g[1]+"%, "+g[2]+"%)":"hsla("+g[0]+", "+g[1]+"%, "+g[2]+"%, "+g[3]+")"},c.to.hwb=function(){var g=Bv(arguments),p="";return 4<=g.length&&g[3]!==1&&(p=", "+g[3]),"hwb("+g[0]+", "+g[1]+"%, "+g[2]+"%"+p+")"},c.to.keyword=function(g){return s[g.slice(0,3)]}}),Ip=Rt(function(t){var r={};for(f in Wu)Wu.hasOwnProperty(f)&&(r[Wu[f]]=f);var i=t.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}},s;for(s in i)if(i.hasOwnProperty(s)){if(!("channels"in i[s]))throw Error("missing channels property: "+s);if(!("labels"in i[s]))throw Error("missing channel labels property: "+s);if(i[s].labels.length!==i[s].channels)throw Error("channel and label counts mismatch: "+s);t=i[s].channels;var f=i[s].labels;delete i[s].channels,delete i[s].labels,Object.defineProperty(i[s],"channels",{value:t}),Object.defineProperty(i[s],"labels",{value:f})}i.rgb.hsl=function(c){var g=c[0]/255,p=c[1]/255,A=c[2]/255;c=Math.min(g,p,A);var S=Math.max(g,p,A),N=S-c,_;return S===c?_=0:g===S?_=(p-A)/N:p===S?_=2+(A-g)/N:A===S&&(_=4+(g-p)/N),_=Math.min(60*_,360),0>_&&(_+=360),g=(c+S)/2,[_,100*(S===c?0:.5>=g?N/(S+c):N/(2-S-c)),100*g]},i.rgb.hsv=function(c){var g,p=c[0]/255,A=c[1]/255,S=c[2]/255,N=Math.max(p,A,S),_=N-Math.min(p,A,S);if(_===0)var I=g=0;else{g=_/N,c=(N-p)/6/_+.5;var L=(N-A)/6/_+.5;_=(N-S)/6/_+.5,p===N?I=_-L:A===N?I=1/3+c-_:S===N&&(I=2/3+L-c),0>I?I+=1:1<I&&--I}return[360*I,100*g,100*N]},i.rgb.hwb=function(c){var g=c[0],p=c[1],A=c[2];c=i.rgb.hsl(c)[0];var S=1/255*Math.min(g,Math.min(p,A));return A=1-1/255*Math.max(g,Math.max(p,A)),[c,100*S,100*A]},i.rgb.cmyk=function(c){var g=c[0]/255,p=c[1]/255;c=c[2]/255;var A=Math.min(1-g,1-p,1-c);return[100*((1-g-A)/(1-A)||0),100*((1-p-A)/(1-A)||0),100*((1-c-A)/(1-A)||0),100*A]},i.rgb.keyword=function(c){var g=r[c];if(g)return g;g=Infinity;var p;for(p in Wu)if(Wu.hasOwnProperty(p)){var A=Wu[p];if(A=Math.pow(c[0]-A[0],2)+Math.pow(c[1]-A[1],2)+Math.pow(c[2]-A[2],2),A<g){g=A;var S=p}}return S},i.keyword.rgb=function(c){return Wu[c]},i.rgb.xyz=function(c){var g=c[0]/255,p=c[1]/255;return c=c[2]/255,g=.04045<g?Math.pow((g+.055)/1.055,2.4):g/12.92,p=.04045<p?Math.pow((p+.055)/1.055,2.4):p/12.92,c=.04045<c?Math.pow((c+.055)/1.055,2.4):c/12.92,[100*(.4124*g+.3576*p+.1805*c),100*(.2126*g+.7152*p+.0722*c),100*(.0193*g+.1192*p+.9505*c)]},i.rgb.lab=function(c){var g=i.rgb.xyz(c);c=g[0];var p=g[1];return g=g[2],c/=95.047,p/=100,g/=108.883,c=.008856<c?Math.pow(c,1/3):7.787*c+16/116,p=.008856<p?Math.pow(p,1/3):7.787*p+16/116,g=.008856<g?Math.pow(g,1/3):7.787*g+16/116,[116*p-16,500*(c-p),200*(p-g)]},i.hsl.rgb=function(c){var g=c[0]/360,p=c[1]/100;if(c=c[2]/100,p===0){var A=255*c;return[A,A,A]}p=.5>c?c*(1+p):c+p-c*p,c=2*c-p;for(var S=[0,0,0],N=0;3>N;N++)A=g+1/3*-(N-1),0>A&&A++,1<A&&A--,A=1>6*A?c+6*(p-c)*A:1>2*A?p:2>3*A?c+(p-c)*(2/3-A)*6:c,S[N]=255*A;return S},i.hsl.hsv=function(c){var g=c[0],p=c[1]/100;c=c[2]/100;var A=p,S=Math.max(c,.01);return c*=2,p*=1>=c?c:2-c,A*=1>=S?S:2-S,[g,100*(c===0?2*A/(S+A):2*p/(c+p)),(c+p)/2*100]},i.hsv.rgb=function(c){var g=c[0]/60,p=c[1]/100;c=c[2]/100;var A=Math.floor(g)%6,S=g-Math.floor(g);g=255*c*(1-p);var N=255*c*(1-p*S);switch(p=255*c*(1-p*(1-S)),c*=255,A){case 0:return[c,p,g];case 1:return[N,c,g];case 2:return[g,c,p];case 3:return[g,N,c];case 4:return[p,g,c];case 5:return[c,g,N]}},i.hsv.hsl=function(c){var g=c[0],p=c[1]/100;c=c[2]/100;var A=Math.max(c,.01),S=(2-p)*A;return A=p*A/(1>=S?S:2-S)||0,[g,100*A,(2-p)*c/2*100]},i.hwb.rgb=function(c){var g=c[0]/360,p=c[1]/100;c=c[2]/100;var A=p+c;switch(1<A&&(p/=A,c/=A),A=Math.floor(6*g),c=1-c,g=6*g-A,(A&1)!=0&&(g=1-g),g=p+g*(c-p),A){default:case 6:case 0:A=c;var S=g;break;case 1:A=g,S=c;break;case 2:A=p,S=c,p=g;break;case 3:A=p,S=g,p=c;break;case 4:A=g,S=p,p=c;break;case 5:A=c,S=p,p=g}return[255*A,255*S,255*p]},i.cmyk.rgb=function(c){var g=c[3]/100;return[255*(1-Math.min(1,c[0]/100*(1-g)+g)),255*(1-Math.min(1,c[1]/100*(1-g)+g)),255*(1-Math.min(1,c[2]/100*(1-g)+g))]},i.xyz.rgb=function(c){var g=c[0]/100,p=c[1]/100,A=c[2]/100;c=3.2406*g+-1.5372*p+-.4986*A;var S=-.9689*g+1.8758*p+.0415*A;return g=.0557*g+-.204*p+1.057*A,c=.0031308<c?1.055*Math.pow(c,1/2.4)-.055:12.92*c,S=.0031308<S?1.055*Math.pow(S,1/2.4)-.055:12.92*S,g=.0031308<g?1.055*Math.pow(g,1/2.4)-.055:12.92*g,c=Math.min(Math.max(0,c),1),S=Math.min(Math.max(0,S),1),g=Math.min(Math.max(0,g),1),[255*c,255*S,255*g]},i.xyz.lab=function(c){var g=c[0],p=c[1];return c=c[2],g/=95.047,p/=100,c/=108.883,g=.008856<g?Math.pow(g,1/3):7.787*g+16/116,p=.008856<p?Math.pow(p,1/3):7.787*p+16/116,c=.008856<c?Math.pow(c,1/3):7.787*c+16/116,[116*p-16,500*(g-p),200*(p-c)]},i.lab.xyz=function(c){var g=c[1],p=c[2];c=(c[0]+16)/116,g=g/500+c,p=c-p/200;var A=Math.pow(c,3),S=Math.pow(g,3),N=Math.pow(p,3);return[95.047*(.008856<S?S:(g-16/116)/7.787),100*(.008856<A?A:(c-16/116)/7.787),108.883*(.008856<N?N:(p-16/116)/7.787)]},i.lab.lch=function(c){var g=c[0],p=c[1];c=c[2];var A=360*Math.atan2(c,p)/2/Math.PI;return 0>A&&(A+=360),[g,Math.sqrt(p*p+c*c),A]},i.lch.lab=function(c){var g=c[0],p=c[1];return c=c[2]/360*2*Math.PI,[g,p*Math.cos(c),p*Math.sin(c)]},i.rgb.ansi16=function(c){var g=c[0],p=c[1],A=c[2],S=1 in arguments?arguments[1]:i.rgb.hsv(c)[2];return S=Math.round(S/50),S===0?30:(g=30+(Math.round(A/255)<<2|Math.round(p/255)<<1|Math.round(g/255)),S===2&&(g+=60),g)},i.hsv.ansi16=function(c){return i.rgb.ansi16(i.hsv.rgb(c),c[2])},i.rgb.ansi256=function(c){var g=c[0],p=c[1];return c=c[2],g===p&&p===c?8>g?16:248<g?231:Math.round((g-8)/247*24)+232:16+36*Math.round(g/255*5)+6*Math.round(p/255*5)+Math.round(c/255*5)},i.ansi16.rgb=function(c){var g=c%10;return g===0||g===7?(50<c&&(g+=3.5),g=g/10.5*255,[g,g,g]):(c=.5*(~~(50<c)+1),[(g&1)*c*255,(g>>1&1)*c*255,(g>>2&1)*c*255])},i.ansi256.rgb=function(c){if(232<=c){var g=10*(c-232)+8;return[g,g,g]}c-=16,g=Math.floor(c/36)/5*255;var p=Math.floor((c%=36)/6)/5*255;return[g,p,c%6/5*255]},i.rgb.hex=function(c){return c=(((Math.round(c[0])&255)<<16)+((Math.round(c[1])&255)<<8)+(Math.round(c[2])&255)).toString(16).toUpperCase(),"000000".substring(c.length)+c},i.hex.rgb=function(c){if(c=c.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i),!c)return[0,0,0];var g=c[0];return c[0].length===3&&(g=g.split("").map(function(p){return p+p}).join("")),c=parseInt(g,16),[c>>16&255,c>>8&255,c&255]},i.rgb.hcg=function(c){var g=c[0]/255,p=c[1]/255;c=c[2]/255;var A=Math.max(Math.max(g,p),c),S=Math.min(Math.min(g,p),c),N=A-S;return[(0>=N?0:A===g?(p-c)/N%6:A===p?2+(c-g)/N:(g-p)/N+8)/6%1*360,100*N,100*(1>N?S/(1-N):0)]},i.hsl.hcg=function(c){var g=c[1]/100,p=c[2]/100,A=0;return g=.5>p?2*g*p:2*g*(1-p),1>g&&(A=(p-.5*g)/(1-g)),[c[0],100*g,100*A]},i.hsv.hcg=function(c){var g=c[2]/100,p=c[1]/100*g,A=0;return 1>p&&(A=(g-p)/(1-p)),[c[0],100*p,100*A]},i.hcg.rgb=function(c){var g=c[1]/100,p=c[2]/100;if(g===0)return[255*p,255*p,255*p];var A=[0,0,0];c=c[0]/360%1*6;var S=c%1,N=1-S;switch(Math.floor(c)){case 0:A[0]=1,A[1]=S,A[2]=0;break;case 1:A[0]=N,A[1]=1,A[2]=0;break;case 2:A[0]=0,A[1]=1,A[2]=S;break;case 3:A[0]=0,A[1]=N,A[2]=1;break;case 4:A[0]=S,A[1]=0,A[2]=1;break;default:A[0]=1,A[1]=0,A[2]=N}return p*=1-g,[255*(g*A[0]+p),255*(g*A[1]+p),255*(g*A[2]+p)]},i.hcg.hsv=function(c){var g=c[1]/100,p=g+c[2]/100*(1-g),A=0;return 0<p&&(A=g/p),[c[0],100*A,100*p]},i.hcg.hsl=function(c){var g=c[1]/100,p=c[2]/100*(1-g)+.5*g,A=0;return 0<p&&.5>p?A=g/(2*p):.5<=p&&1>p&&(A=g/(2*(1-p))),[c[0],100*A,100*p]},i.hcg.hwb=function(c){var g=c[1]/100,p=g+c[2]/100*(1-g);return[c[0],100*(p-g),100*(1-p)]},i.hwb.hcg=function(c){var g=1-c[2]/100,p=g-c[1]/100,A=0;return 1>p&&(A=(g-p)/(1-p)),[c[0],100*p,100*A]},i.apple.rgb=function(c){return[c[0]/65535*255,c[1]/65535*255,c[2]/65535*255]},i.rgb.apple=function(c){return[c[0]/255*65535,c[1]/255*65535,c[2]/255*65535]},i.gray.rgb=function(c){return[c[0]/100*255,c[0]/100*255,c[0]/100*255]},i.gray.hsl=i.gray.hsv=function(c){return[0,0,c[0]]},i.gray.hwb=function(c){return[0,100,c[0]]},i.gray.cmyk=function(c){return[0,0,0,c[0]]},i.gray.lab=function(c){return[c[0],0,0]},i.gray.hex=function(c){return c=Math.round(c[0]/100*255)&255,c=((c<<16)+(c<<8)+c).toString(16).toUpperCase(),"000000".substring(c.length)+c},i.rgb.gray=function(c){return[(c[0]+c[1]+c[2])/3/255*100]}}),NC=function(t){for(var r={},i=qi(Ip),s=i.length,f=0;f<s;f++)r[i[f]]={distance:-1,parent:null};for(i=[t],r[t].distance=0;i.length;){t=i.pop(),s=qi(Ip[t]),f=s.length;for(var c=0;c<f;c++){var g=s[c],p=r[g];p.distance===-1&&(p.distance=r[t].distance+1,p.parent=t,i.unshift(g))}}for(i={},t=qi(r),s=t.length,f=0;f<s;f++){var A=t[f];if(r[A].parent!==null){c=A,g=r,p=[g[A].parent,A];var S=Ip[g[A].parent][A];for(A=g[A].parent;g[A].parent;)p.unshift(g[A].parent),S=bm(Ip[g[A].parent][A],S),A=g[A].parent;S.conversion=p,i[c]=S}}return i},Ig={};qi(Ip).forEach(function(t){Ig[t]={},Object.defineProperty(Ig[t],"channels",{value:Ip[t].channels}),Object.defineProperty(Ig[t],"labels",{value:Ip[t].labels});var r=NC(t);qi(r).forEach(function(i){var s=r[i];Ig[t][i]=e1(s),Ig[t][i].raw=t1(s)})});var Va=Ig,qA=[].slice,l_=["keyword","gray","hex"],KA={};qi(Va).forEach(function(t){KA[qA.call(Va[t].labels).sort().join("")]=t});var Ay={};Ro.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(t){var r=this.model in Nv.to?this:this.rgb();return r=r.round(typeof t=="number"?t:1),t=r.valpha===1?r.color:r.color.concat(this.valpha),Nv.to[r.model](t)},percentString:function(t){return t=this.rgb().round(typeof t=="number"?t:1),t=t.valpha===1?t.color:t.color.concat(this.valpha),Nv.to.rgb.percent(t)},array:function(){return this.valpha===1?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var t={},r=Va[this.model].channels,i=Va[this.model].labels,s=0;s<r;s++)t[i[s]]=this.color[s];return this.valpha!==1&&(t.alpha=this.valpha),t},unitArray:function(){var t=this.rgb().color;return t[0]/=255,t[1]/=255,t[2]/=255,this.valpha!==1&&t.push(this.valpha),t},unitObject:function(){var t=this.rgb().object();return t.r/=255,t.g/=255,t.b/=255,this.valpha!==1&&(t.alpha=this.valpha),t},round:function(t){return t=Math.max(t||0,0),new Ro(this.color.map(r1(t)).concat(this.valpha),this.model)},alpha:function(t){return arguments.length?new Ro(this.color.concat(Math.max(0,Math.min(1,t))),this.model):this.valpha},red:bn("rgb",0,Vn(255)),green:bn("rgb",1,Vn(255)),blue:bn("rgb",2,Vn(255)),hue:bn(["hsl","hsv","hsl","hwb","hcg"],0,function(t){return(t%360+360)%360}),saturationl:bn("hsl",1,Vn(100)),lightness:bn("hsl",2,Vn(100)),saturationv:bn("hsv",1,Vn(100)),value:bn("hsv",2,Vn(100)),chroma:bn("hcg",1,Vn(100)),gray:bn("hcg",2,Vn(100)),white:bn("hwb",1,Vn(100)),wblack:bn("hwb",2,Vn(100)),cyan:bn("cmyk",0,Vn(100)),magenta:bn("cmyk",1,Vn(100)),yellow:bn("cmyk",2,Vn(100)),black:bn("cmyk",3,Vn(100)),x:bn("xyz",0,Vn(100)),y:bn("xyz",1,Vn(100)),z:bn("xyz",2,Vn(100)),l:bn("lab",0,Vn(100)),a:bn("lab",1),b:bn("lab",2),keyword:function(t){return arguments.length?new Ro(t):Va[this.model].keyword(this.color)},hex:function(t){return arguments.length?new Ro(t):Nv.to.hex(this.rgb().round().color)},rgbNumber:function(){var t=this.rgb().color;return(t[0]&255)<<16|(t[1]&255)<<8|t[2]&255},luminosity:function(){for(var t=this.rgb().color,r=[],i=0;i<t.length;i++){var s=t[i]/255;r[i]=.03928>=s?s/12.92:Math.pow((s+.055)/1.055,2.4)}return .2126*r[0]+.7152*r[1]+.0722*r[2]},contrast:function(t){var r=this.luminosity();return t=t.luminosity(),r>t?(r+.05)/(t+.05):(t+.05)/(r+.05)},level:function(t){return t=this.contrast(t),7.1<=t?"AAA":4.5<=t?"AA":""},isDark:function(){var t=this.rgb().color;return 128>(299*t[0]+587*t[1]+114*t[2])/1e3},isLight:function(){return!this.isDark()},negate:function(){for(var t=this.rgb(),r=0;3>r;r++)t.color[r]=255-t.color[r];return t},lighten:function(t){var r=this.hsl();return r.color[2]+=r.color[2]*t,r},darken:function(t){var r=this.hsl();return r.color[2]-=r.color[2]*t,r},saturate:function(t){var r=this.hsl();return r.color[1]+=r.color[1]*t,r},desaturate:function(t){var r=this.hsl();return r.color[1]-=r.color[1]*t,r},whiten:function(t){var r=this.hwb();return r.color[1]+=r.color[1]*t,r},blacken:function(t){var r=this.hwb();return r.color[2]+=r.color[2]*t,r},grayscale:function(){var t=this.rgb().color;return t=.3*t[0]+.59*t[1]+.11*t[2],Ro.rgb(t,t,t)},fade:function(t){return this.alpha(this.valpha-this.valpha*t)},opaquer:function(t){return this.alpha(this.valpha+this.valpha*t)},rotate:function(t){var r=this.hsl(),i=r.color[0];return i=(i+t)%360,r.color[0]=0>i?360+i:i,r},mix:function(t,r){if(!t||!t.rgb)throw Error('Argument to "mix" was not a Color instance, but rather an instance of '+(typeof t=="undefined"?"undefined":Ua(t)));t=t.rgb();var i=this.rgb();r=r===void 0?.5:r;var s=2*r-1,f=t.alpha()-i.alpha();return s=((s*f==-1?s:(s+f)/(1+s*f))+1)/2,f=1-s,Ro.rgb(s*t.red()+f*i.red(),s*t.green()+f*i.green(),s*t.blue()+f*i.blue(),t.alpha()*r+i.alpha()*(1-r))}},qi(Va).forEach(function(t){if(l_.indexOf(t)===-1){var r=Va[t].channels;Ro.prototype[t]=function(){if(this.model===t)return new Ro(this);if(arguments.length)return new Ro(arguments,t);var i=typeof arguments[r]=="number"?r:this.valpha,s=Va[this.model][t].raw(this.color);return s=Array.isArray(s)?s:[s],new Ro(s.concat(i),t)},Ro[t]=function(i){return typeof i=="number"&&(i=Vm(qA.call(arguments),r)),new Ro(i,t)}}});var ju=Rt(function(t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.setMatrixArrayType=function(c){r.ARRAY_TYPE=s=c},r.toRadian=function(c){return c*f},r.equals=function(c,g){return Math.abs(c-g)<=i*Math.max(1,Math.abs(c),Math.abs(g))},r.RANDOM=r.ARRAY_TYPE=r.EPSILON=void 0;var i=1e-6;r.EPSILON=i;var s=typeof Float32Array!="undefined"?Float32Array:Array;r.ARRAY_TYPE=s,r.RANDOM=Math.random;var f=Math.PI/180});Nt(ju);var h_=Rt(function(t,r){function i(c,g,p){var A=g[0],S=g[1],N=g[2];g=g[3];var _=p[0],I=p[1],L=p[2];return p=p[3],c[0]=A*_+N*I,c[1]=S*_+g*I,c[2]=A*L+N*p,c[3]=S*L+g*p,c}function s(c,g,p){return c[0]=g[0]-p[0],c[1]=g[1]-p[1],c[2]=g[2]-p[2],c[3]=g[3]-p[3],c}Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var c=new f.ARRAY_TYPE(4);return f.ARRAY_TYPE!=Float32Array&&(c[1]=0,c[2]=0),c[0]=1,c[3]=1,c},r.clone=function(c){var g=new f.ARRAY_TYPE(4);return g[0]=c[0],g[1]=c[1],g[2]=c[2],g[3]=c[3],g},r.copy=function(c,g){return c[0]=g[0],c[1]=g[1],c[2]=g[2],c[3]=g[3],c},r.identity=function(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=1,c},r.fromValues=function(c,g,p,A){var S=new f.ARRAY_TYPE(4);return S[0]=c,S[1]=g,S[2]=p,S[3]=A,S},r.set=function(c,g,p,A,S){return c[0]=g,c[1]=p,c[2]=A,c[3]=S,c},r.transpose=function(c,g){if(c===g){var p=g[1];c[1]=g[2],c[2]=p}else c[0]=g[0],c[1]=g[2],c[2]=g[1],c[3]=g[3];return c},r.invert=function(c,g){var p=g[0],A=g[1],S=g[2];g=g[3];var N=p*g-S*A;return N?(N=1/N,c[0]=g*N,c[1]=-A*N,c[2]=-S*N,c[3]=p*N,c):null},r.adjoint=function(c,g){var p=g[0];return c[0]=g[3],c[1]=-g[1],c[2]=-g[2],c[3]=p,c},r.determinant=function(c){return c[0]*c[3]-c[2]*c[1]},r.multiply=i,r.rotate=function(c,g,p){var A=g[0],S=g[1],N=g[2];g=g[3];var _=Math.sin(p);return p=Math.cos(p),c[0]=A*p+N*_,c[1]=S*p+g*_,c[2]=A*-_+N*p,c[3]=S*-_+g*p,c},r.scale=function(c,g,p){var A=g[1],S=g[2],N=g[3],_=p[0];return p=p[1],c[0]=g[0]*_,c[1]=A*_,c[2]=S*p,c[3]=N*p,c},r.fromRotation=function(c,g){var p=Math.sin(g);return g=Math.cos(g),c[0]=g,c[1]=p,c[2]=-p,c[3]=g,c},r.fromScaling=function(c,g){return c[0]=g[0],c[1]=0,c[2]=0,c[3]=g[1],c},r.str=function(c){return"mat2("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+")"},r.frob=function(c){return Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2)+Math.pow(c[2],2)+Math.pow(c[3],2))},r.LDU=function(c,g,p,A){return c[2]=A[2]/A[0],p[0]=A[0],p[1]=A[1],p[3]=A[3]-c[2]*p[1],[c,g,p]},r.add=function(c,g,p){return c[0]=g[0]+p[0],c[1]=g[1]+p[1],c[2]=g[2]+p[2],c[3]=g[3]+p[3],c},r.subtract=s,r.exactEquals=function(c,g){return c[0]===g[0]&&c[1]===g[1]&&c[2]===g[2]&&c[3]===g[3]},r.equals=function(c,g){var p=c[0],A=c[1],S=c[2];c=c[3];var N=g[0],_=g[1],I=g[2];return g=g[3],Math.abs(p-N)<=f.EPSILON*Math.max(1,Math.abs(p),Math.abs(N))&&Math.abs(A-_)<=f.EPSILON*Math.max(1,Math.abs(A),Math.abs(_))&&Math.abs(S-I)<=f.EPSILON*Math.max(1,Math.abs(S),Math.abs(I))&&Math.abs(c-g)<=f.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))},r.multiplyScalar=function(c,g,p){return c[0]=g[0]*p,c[1]=g[1]*p,c[2]=g[2]*p,c[3]=g[3]*p,c},r.multiplyScalarAndAdd=function(c,g,p,A){return c[0]=g[0]+p[0]*A,c[1]=g[1]+p[1]*A,c[2]=g[2]+p[2]*A,c[3]=g[3]+p[3]*A,c},r.sub=r.mul=void 0;var f=function(c){if(c&&c.__esModule)return c;var g={};if(c!=null){for(var p in c)if(Object.prototype.hasOwnProperty.call(c,p)){var A=go&&To?To(c,p):{};A.get||A.set?go(g,p,A):g[p]=c[p]}}return g.default=c,g}(ju);r.mul=i,r.sub=s});Nt(h_);var c_=Rt(function(t,r){function i(c,g,p){var A=g[0],S=g[1],N=g[2],_=g[3],I=g[4];g=g[5];var L=p[0],P=p[1],F=p[2],W=p[3],X=p[4];return p=p[5],c[0]=A*L+N*P,c[1]=S*L+_*P,c[2]=A*F+N*W,c[3]=S*F+_*W,c[4]=A*X+N*p+I,c[5]=S*X+_*p+g,c}function s(c,g,p){return c[0]=g[0]-p[0],c[1]=g[1]-p[1],c[2]=g[2]-p[2],c[3]=g[3]-p[3],c[4]=g[4]-p[4],c[5]=g[5]-p[5],c}Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var c=new f.ARRAY_TYPE(6);return f.ARRAY_TYPE!=Float32Array&&(c[1]=0,c[2]=0,c[4]=0,c[5]=0),c[0]=1,c[3]=1,c},r.clone=function(c){var g=new f.ARRAY_TYPE(6);return g[0]=c[0],g[1]=c[1],g[2]=c[2],g[3]=c[3],g[4]=c[4],g[5]=c[5],g},r.copy=function(c,g){return c[0]=g[0],c[1]=g[1],c[2]=g[2],c[3]=g[3],c[4]=g[4],c[5]=g[5],c},r.identity=function(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=1,c[4]=0,c[5]=0,c},r.fromValues=function(c,g,p,A,S,N){var _=new f.ARRAY_TYPE(6);return _[0]=c,_[1]=g,_[2]=p,_[3]=A,_[4]=S,_[5]=N,_},r.set=function(c,g,p,A,S,N,_){return c[0]=g,c[1]=p,c[2]=A,c[3]=S,c[4]=N,c[5]=_,c},r.invert=function(c,g){var p=g[0],A=g[1],S=g[2],N=g[3],_=g[4];g=g[5];var I=p*N-A*S;return I?(I=1/I,c[0]=N*I,c[1]=-A*I,c[2]=-S*I,c[3]=p*I,c[4]=(S*g-N*_)*I,c[5]=(A*_-p*g)*I,c):null},r.determinant=function(c){return c[0]*c[3]-c[1]*c[2]},r.multiply=i,r.rotate=function(c,g,p){var A=g[0],S=g[1],N=g[2],_=g[3],I=g[4];g=g[5];var L=Math.sin(p);return p=Math.cos(p),c[0]=A*p+N*L,c[1]=S*p+_*L,c[2]=A*-L+N*p,c[3]=S*-L+_*p,c[4]=I,c[5]=g,c},r.scale=function(c,g,p){var A=g[1],S=g[2],N=g[3],_=g[4],I=g[5],L=p[0];return p=p[1],c[0]=g[0]*L,c[1]=A*L,c[2]=S*p,c[3]=N*p,c[4]=_,c[5]=I,c},r.translate=function(c,g,p){var A=g[0],S=g[1],N=g[2],_=g[3],I=g[4];g=g[5];var L=p[0];return p=p[1],c[0]=A,c[1]=S,c[2]=N,c[3]=_,c[4]=A*L+N*p+I,c[5]=S*L+_*p+g,c},r.fromRotation=function(c,g){var p=Math.sin(g);return g=Math.cos(g),c[0]=g,c[1]=p,c[2]=-p,c[3]=g,c[4]=0,c[5]=0,c},r.fromScaling=function(c,g){return c[0]=g[0],c[1]=0,c[2]=0,c[3]=g[1],c[4]=0,c[5]=0,c},r.fromTranslation=function(c,g){return c[0]=1,c[1]=0,c[2]=0,c[3]=1,c[4]=g[0],c[5]=g[1],c},r.str=function(c){return"mat2d("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+", "+c[4]+", "+c[5]+")"},r.frob=function(c){return Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2)+Math.pow(c[2],2)+Math.pow(c[3],2)+Math.pow(c[4],2)+Math.pow(c[5],2)+1)},r.add=function(c,g,p){return c[0]=g[0]+p[0],c[1]=g[1]+p[1],c[2]=g[2]+p[2],c[3]=g[3]+p[3],c[4]=g[4]+p[4],c[5]=g[5]+p[5],c},r.subtract=s,r.multiplyScalar=function(c,g,p){return c[0]=g[0]*p,c[1]=g[1]*p,c[2]=g[2]*p,c[3]=g[3]*p,c[4]=g[4]*p,c[5]=g[5]*p,c},r.multiplyScalarAndAdd=function(c,g,p,A){return c[0]=g[0]+p[0]*A,c[1]=g[1]+p[1]*A,c[2]=g[2]+p[2]*A,c[3]=g[3]+p[3]*A,c[4]=g[4]+p[4]*A,c[5]=g[5]+p[5]*A,c},r.exactEquals=function(c,g){return c[0]===g[0]&&c[1]===g[1]&&c[2]===g[2]&&c[3]===g[3]&&c[4]===g[4]&&c[5]===g[5]},r.equals=function(c,g){var p=c[0],A=c[1],S=c[2],N=c[3],_=c[4];c=c[5];var I=g[0],L=g[1],P=g[2],F=g[3],W=g[4];return g=g[5],Math.abs(p-I)<=f.EPSILON*Math.max(1,Math.abs(p),Math.abs(I))&&Math.abs(A-L)<=f.EPSILON*Math.max(1,Math.abs(A),Math.abs(L))&&Math.abs(S-P)<=f.EPSILON*Math.max(1,Math.abs(S),Math.abs(P))&&Math.abs(N-F)<=f.EPSILON*Math.max(1,Math.abs(N),Math.abs(F))&&Math.abs(_-W)<=f.EPSILON*Math.max(1,Math.abs(_),Math.abs(W))&&Math.abs(c-g)<=f.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))},r.sub=r.mul=void 0;var f=function(c){if(c&&c.__esModule)return c;var g={};if(c!=null){for(var p in c)if(Object.prototype.hasOwnProperty.call(c,p)){var A=go&&To?To(c,p):{};A.get||A.set?go(g,p,A):g[p]=c[p]}}return g.default=c,g}(ju);r.mul=i,r.sub=s});Nt(c_);var QA=Rt(function(t,r){function i(c,g,p){var A=g[0],S=g[1],N=g[2],_=g[3],I=g[4],L=g[5],P=g[6],F=g[7];g=g[8];var W=p[0],X=p[1],Z=p[2],tt=p[3],ot=p[4],xt=p[5],At=p[6],yt=p[7];return p=p[8],c[0]=W*A+X*_+Z*P,c[1]=W*S+X*I+Z*F,c[2]=W*N+X*L+Z*g,c[3]=tt*A+ot*_+xt*P,c[4]=tt*S+ot*I+xt*F,c[5]=tt*N+ot*L+xt*g,c[6]=At*A+yt*_+p*P,c[7]=At*S+yt*I+p*F,c[8]=At*N+yt*L+p*g,c}function s(c,g,p){return c[0]=g[0]-p[0],c[1]=g[1]-p[1],c[2]=g[2]-p[2],c[3]=g[3]-p[3],c[4]=g[4]-p[4],c[5]=g[5]-p[5],c[6]=g[6]-p[6],c[7]=g[7]-p[7],c[8]=g[8]-p[8],c}Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var c=new f.ARRAY_TYPE(9);return f.ARRAY_TYPE!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c},r.fromMat4=function(c,g){return c[0]=g[0],c[1]=g[1],c[2]=g[2],c[3]=g[4],c[4]=g[5],c[5]=g[6],c[6]=g[8],c[7]=g[9],c[8]=g[10],c},r.clone=function(c){var g=new f.ARRAY_TYPE(9);return g[0]=c[0],g[1]=c[1],g[2]=c[2],g[3]=c[3],g[4]=c[4],g[5]=c[5],g[6]=c[6],g[7]=c[7],g[8]=c[8],g},r.copy=function(c,g){return c[0]=g[0],c[1]=g[1],c[2]=g[2],c[3]=g[3],c[4]=g[4],c[5]=g[5],c[6]=g[6],c[7]=g[7],c[8]=g[8],c},r.fromValues=function(c,g,p,A,S,N,_,I,L){var P=new f.ARRAY_TYPE(9);return P[0]=c,P[1]=g,P[2]=p,P[3]=A,P[4]=S,P[5]=N,P[6]=_,P[7]=I,P[8]=L,P},r.set=function(c,g,p,A,S,N,_,I,L,P){return c[0]=g,c[1]=p,c[2]=A,c[3]=S,c[4]=N,c[5]=_,c[6]=I,c[7]=L,c[8]=P,c},r.identity=function(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=1,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},r.transpose=function(c,g){if(c===g){var p=g[1],A=g[2],S=g[5];c[1]=g[3],c[2]=g[6],c[3]=p,c[5]=g[7],c[6]=A,c[7]=S}else c[0]=g[0],c[1]=g[3],c[2]=g[6],c[3]=g[1],c[4]=g[4],c[5]=g[7],c[6]=g[2],c[7]=g[5],c[8]=g[8];return c},r.invert=function(c,g){var p=g[0],A=g[1],S=g[2],N=g[3],_=g[4],I=g[5],L=g[6],P=g[7];g=g[8];var F=g*_-I*P,W=-g*N+I*L,X=P*N-_*L,Z=p*F+A*W+S*X;return Z?(Z=1/Z,c[0]=F*Z,c[1]=(-g*A+S*P)*Z,c[2]=(I*A-S*_)*Z,c[3]=W*Z,c[4]=(g*p-S*L)*Z,c[5]=(-I*p+S*N)*Z,c[6]=X*Z,c[7]=(-P*p+A*L)*Z,c[8]=(_*p-A*N)*Z,c):null},r.adjoint=function(c,g){var p=g[0],A=g[1],S=g[2],N=g[3],_=g[4],I=g[5],L=g[6],P=g[7];return g=g[8],c[0]=_*g-I*P,c[1]=S*P-A*g,c[2]=A*I-S*_,c[3]=I*L-N*g,c[4]=p*g-S*L,c[5]=S*N-p*I,c[6]=N*P-_*L,c[7]=A*L-p*P,c[8]=p*_-A*N,c},r.determinant=function(c){var g=c[3],p=c[4],A=c[5],S=c[6],N=c[7],_=c[8];return c[0]*(_*p-A*N)+c[1]*(-_*g+A*S)+c[2]*(N*g-p*S)},r.multiply=i,r.translate=function(c,g,p){var A=g[0],S=g[1],N=g[2],_=g[3],I=g[4],L=g[5],P=g[6],F=g[7];g=g[8];var W=p[0];return p=p[1],c[0]=A,c[1]=S,c[2]=N,c[3]=_,c[4]=I,c[5]=L,c[6]=W*A+p*_+P,c[7]=W*S+p*I+F,c[8]=W*N+p*L+g,c},r.rotate=function(c,g,p){var A=g[0],S=g[1],N=g[2],_=g[3],I=g[4],L=g[5],P=g[6],F=g[7];g=g[8];var W=Math.sin(p);return p=Math.cos(p),c[0]=p*A+W*_,c[1]=p*S+W*I,c[2]=p*N+W*L,c[3]=p*_-W*A,c[4]=p*I-W*S,c[5]=p*L-W*N,c[6]=P,c[7]=F,c[8]=g,c},r.scale=function(c,g,p){var A=p[0];return p=p[1],c[0]=A*g[0],c[1]=A*g[1],c[2]=A*g[2],c[3]=p*g[3],c[4]=p*g[4],c[5]=p*g[5],c[6]=g[6],c[7]=g[7],c[8]=g[8],c},r.fromTranslation=function(c,g){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=1,c[5]=0,c[6]=g[0],c[7]=g[1],c[8]=1,c},r.fromRotation=function(c,g){var p=Math.sin(g);return g=Math.cos(g),c[0]=g,c[1]=p,c[2]=0,c[3]=-p,c[4]=g,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},r.fromScaling=function(c,g){return c[0]=g[0],c[1]=0,c[2]=0,c[3]=0,c[4]=g[1],c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},r.fromMat2d=function(c,g){return c[0]=g[0],c[1]=g[1],c[2]=0,c[3]=g[2],c[4]=g[3],c[5]=0,c[6]=g[4],c[7]=g[5],c[8]=1,c},r.fromQuat=function(c,g){var p=g[0],A=g[1],S=g[2];g=g[3];var N=p+p,_=A+A,I=S+S;p*=N;var L=A*N;A*=_;var P=S*N,F=S*_;return S*=I,N*=g,_*=g,g*=I,c[0]=1-A-S,c[3]=L-g,c[6]=P+_,c[1]=L+g,c[4]=1-p-S,c[7]=F-N,c[2]=P-_,c[5]=F+N,c[8]=1-p-A,c},r.normalFromMat4=function(c,g){var p=g[0],A=g[1],S=g[2],N=g[3],_=g[4],I=g[5],L=g[6],P=g[7],F=g[8],W=g[9],X=g[10],Z=g[11],tt=g[12],ot=g[13],xt=g[14];g=g[15];var At=p*I-A*_,yt=p*L-S*_,zt=p*P-N*_,Ht=A*L-S*I,$t=A*P-N*I,Vt=S*P-N*L,Kt=F*ot-W*tt,ze=F*xt-X*tt;F=F*g-Z*tt;var ae=W*xt-X*ot;return W=W*g-Z*ot,X=X*g-Z*xt,Z=At*X-yt*W+zt*ae+Ht*F-$t*ze+Vt*Kt,Z?(Z=1/Z,c[0]=(I*X-L*W+P*ae)*Z,c[1]=(L*F-_*X-P*ze)*Z,c[2]=(_*W-I*F+P*Kt)*Z,c[3]=(S*W-A*X-N*ae)*Z,c[4]=(p*X-S*F+N*ze)*Z,c[5]=(A*F-p*W-N*Kt)*Z,c[6]=(ot*Vt-xt*$t+g*Ht)*Z,c[7]=(xt*zt-tt*Vt-g*yt)*Z,c[8]=(tt*$t-ot*zt+g*At)*Z,c):null},r.projection=function(c,g,p){return c[0]=2/g,c[1]=0,c[2]=0,c[3]=0,c[4]=-2/p,c[5]=0,c[6]=-1,c[7]=1,c[8]=1,c},r.str=function(c){return"mat3("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+", "+c[4]+", "+c[5]+", "+c[6]+", "+c[7]+", "+c[8]+")"},r.frob=function(c){return Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2)+Math.pow(c[2],2)+Math.pow(c[3],2)+Math.pow(c[4],2)+Math.pow(c[5],2)+Math.pow(c[6],2)+Math.pow(c[7],2)+Math.pow(c[8],2))},r.add=function(c,g,p){return c[0]=g[0]+p[0],c[1]=g[1]+p[1],c[2]=g[2]+p[2],c[3]=g[3]+p[3],c[4]=g[4]+p[4],c[5]=g[5]+p[5],c[6]=g[6]+p[6],c[7]=g[7]+p[7],c[8]=g[8]+p[8],c},r.subtract=s,r.multiplyScalar=function(c,g,p){return c[0]=g[0]*p,c[1]=g[1]*p,c[2]=g[2]*p,c[3]=g[3]*p,c[4]=g[4]*p,c[5]=g[5]*p,c[6]=g[6]*p,c[7]=g[7]*p,c[8]=g[8]*p,c},r.multiplyScalarAndAdd=function(c,g,p,A){return c[0]=g[0]+p[0]*A,c[1]=g[1]+p[1]*A,c[2]=g[2]+p[2]*A,c[3]=g[3]+p[3]*A,c[4]=g[4]+p[4]*A,c[5]=g[5]+p[5]*A,c[6]=g[6]+p[6]*A,c[7]=g[7]+p[7]*A,c[8]=g[8]+p[8]*A,c},r.exactEquals=function(c,g){return c[0]===g[0]&&c[1]===g[1]&&c[2]===g[2]&&c[3]===g[3]&&c[4]===g[4]&&c[5]===g[5]&&c[6]===g[6]&&c[7]===g[7]&&c[8]===g[8]},r.equals=function(c,g){var p=c[0],A=c[1],S=c[2],N=c[3],_=c[4],I=c[5],L=c[6],P=c[7];c=c[8];var F=g[0],W=g[1],X=g[2],Z=g[3],tt=g[4],ot=g[5],xt=g[6],At=g[7];return g=g[8],Math.abs(p-F)<=f.EPSILON*Math.max(1,Math.abs(p),Math.abs(F))&&Math.abs(A-W)<=f.EPSILON*Math.max(1,Math.abs(A),Math.abs(W))&&Math.abs(S-X)<=f.EPSILON*Math.max(1,Math.abs(S),Math.abs(X))&&Math.abs(N-Z)<=f.EPSILON*Math.max(1,Math.abs(N),Math.abs(Z))&&Math.abs(_-tt)<=f.EPSILON*Math.max(1,Math.abs(_),Math.abs(tt))&&Math.abs(I-ot)<=f.EPSILON*Math.max(1,Math.abs(I),Math.abs(ot))&&Math.abs(L-xt)<=f.EPSILON*Math.max(1,Math.abs(L),Math.abs(xt))&&Math.abs(P-At)<=f.EPSILON*Math.max(1,Math.abs(P),Math.abs(At))&&Math.abs(c-g)<=f.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))},r.sub=r.mul=void 0;var f=function(c){if(c&&c.__esModule)return c;var g={};if(c!=null){for(var p in c)if(Object.prototype.hasOwnProperty.call(c,p)){var A=go&&To?To(c,p):{};A.get||A.set?go(g,p,A):g[p]=c[p]}}return g.default=c,g}(ju);r.mul=i,r.sub=s});Nt(QA);var $A=Rt(function(t,r){function i(p){return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p}function s(p,A,S){var N=A[0],_=A[1],I=A[2],L=A[3],P=A[4],F=A[5],W=A[6],X=A[7],Z=A[8],tt=A[9],ot=A[10],xt=A[11],At=A[12],yt=A[13],zt=A[14];A=A[15];var Ht=S[0],$t=S[1],Vt=S[2],Kt=S[3];return p[0]=Ht*N+$t*P+Vt*Z+Kt*At,p[1]=Ht*_+$t*F+Vt*tt+Kt*yt,p[2]=Ht*I+$t*W+Vt*ot+Kt*zt,p[3]=Ht*L+$t*X+Vt*xt+Kt*A,Ht=S[4],$t=S[5],Vt=S[6],Kt=S[7],p[4]=Ht*N+$t*P+Vt*Z+Kt*At,p[5]=Ht*_+$t*F+Vt*tt+Kt*yt,p[6]=Ht*I+$t*W+Vt*ot+Kt*zt,p[7]=Ht*L+$t*X+Vt*xt+Kt*A,Ht=S[8],$t=S[9],Vt=S[10],Kt=S[11],p[8]=Ht*N+$t*P+Vt*Z+Kt*At,p[9]=Ht*_+$t*F+Vt*tt+Kt*yt,p[10]=Ht*I+$t*W+Vt*ot+Kt*zt,p[11]=Ht*L+$t*X+Vt*xt+Kt*A,Ht=S[12],$t=S[13],Vt=S[14],Kt=S[15],p[12]=Ht*N+$t*P+Vt*Z+Kt*At,p[13]=Ht*_+$t*F+Vt*tt+Kt*yt,p[14]=Ht*I+$t*W+Vt*ot+Kt*zt,p[15]=Ht*L+$t*X+Vt*xt+Kt*A,p}function f(p,A,S){var N=A[0],_=A[1],I=A[2],L=A[3],P=N+N,F=_+_,W=I+I;A=N*P;var X=N*F;N*=W;var Z=_*F;return _*=W,I*=W,P*=L,F*=L,L*=W,p[0]=1-(Z+I),p[1]=X+L,p[2]=N-F,p[3]=0,p[4]=X-L,p[5]=1-(A+I),p[6]=_+P,p[7]=0,p[8]=N+F,p[9]=_-P,p[10]=1-(A+Z),p[11]=0,p[12]=S[0],p[13]=S[1],p[14]=S[2],p[15]=1,p}function c(p,A,S){return p[0]=A[0]-S[0],p[1]=A[1]-S[1],p[2]=A[2]-S[2],p[3]=A[3]-S[3],p[4]=A[4]-S[4],p[5]=A[5]-S[5],p[6]=A[6]-S[6],p[7]=A[7]-S[7],p[8]=A[8]-S[8],p[9]=A[9]-S[9],p[10]=A[10]-S[10],p[11]=A[11]-S[11],p[12]=A[12]-S[12],p[13]=A[13]-S[13],p[14]=A[14]-S[14],p[15]=A[15]-S[15],p}Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var p=new g.ARRAY_TYPE(16);return g.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[11]=0,p[12]=0,p[13]=0,p[14]=0),p[0]=1,p[5]=1,p[10]=1,p[15]=1,p},r.clone=function(p){var A=new g.ARRAY_TYPE(16);return A[0]=p[0],A[1]=p[1],A[2]=p[2],A[3]=p[3],A[4]=p[4],A[5]=p[5],A[6]=p[6],A[7]=p[7],A[8]=p[8],A[9]=p[9],A[10]=p[10],A[11]=p[11],A[12]=p[12],A[13]=p[13],A[14]=p[14],A[15]=p[15],A},r.copy=function(p,A){return p[0]=A[0],p[1]=A[1],p[2]=A[2],p[3]=A[3],p[4]=A[4],p[5]=A[5],p[6]=A[6],p[7]=A[7],p[8]=A[8],p[9]=A[9],p[10]=A[10],p[11]=A[11],p[12]=A[12],p[13]=A[13],p[14]=A[14],p[15]=A[15],p},r.fromValues=function(p,A,S,N,_,I,L,P,F,W,X,Z,tt,ot,xt,At){var yt=new g.ARRAY_TYPE(16);return yt[0]=p,yt[1]=A,yt[2]=S,yt[3]=N,yt[4]=_,yt[5]=I,yt[6]=L,yt[7]=P,yt[8]=F,yt[9]=W,yt[10]=X,yt[11]=Z,yt[12]=tt,yt[13]=ot,yt[14]=xt,yt[15]=At,yt},r.set=function(p,A,S,N,_,I,L,P,F,W,X,Z,tt,ot,xt,At,yt){return p[0]=A,p[1]=S,p[2]=N,p[3]=_,p[4]=I,p[5]=L,p[6]=P,p[7]=F,p[8]=W,p[9]=X,p[10]=Z,p[11]=tt,p[12]=ot,p[13]=xt,p[14]=At,p[15]=yt,p},r.identity=i,r.transpose=function(p,A){if(p===A){var S=A[1],N=A[2],_=A[3],I=A[6],L=A[7],P=A[11];p[1]=A[4],p[2]=A[8],p[3]=A[12],p[4]=S,p[6]=A[9],p[7]=A[13],p[8]=N,p[9]=I,p[11]=A[14],p[12]=_,p[13]=L,p[14]=P}else p[0]=A[0],p[1]=A[4],p[2]=A[8],p[3]=A[12],p[4]=A[1],p[5]=A[5],p[6]=A[9],p[7]=A[13],p[8]=A[2],p[9]=A[6],p[10]=A[10],p[11]=A[14],p[12]=A[3],p[13]=A[7],p[14]=A[11],p[15]=A[15];return p},r.invert=function(p,A){var S=A[0],N=A[1],_=A[2],I=A[3],L=A[4],P=A[5],F=A[6],W=A[7],X=A[8],Z=A[9],tt=A[10],ot=A[11],xt=A[12],At=A[13],yt=A[14];A=A[15];var zt=S*P-N*L,Ht=S*F-_*L,$t=S*W-I*L,Vt=N*F-_*P,Kt=N*W-I*P,ze=_*W-I*F,ae=X*At-Z*xt,Qe=X*yt-tt*xt,gr=X*A-ot*xt,ir=Z*yt-tt*At,gi=Z*A-ot*At,hr=tt*A-ot*yt,gt=zt*hr-Ht*gi+$t*ir+Vt*gr-Kt*Qe+ze*ae;return gt?(gt=1/gt,p[0]=(P*hr-F*gi+W*ir)*gt,p[1]=(_*gi-N*hr-I*ir)*gt,p[2]=(At*ze-yt*Kt+A*Vt)*gt,p[3]=(tt*Kt-Z*ze-ot*Vt)*gt,p[4]=(F*gr-L*hr-W*Qe)*gt,p[5]=(S*hr-_*gr+I*Qe)*gt,p[6]=(yt*$t-xt*ze-A*Ht)*gt,p[7]=(X*ze-tt*$t+ot*Ht)*gt,p[8]=(L*gi-P*gr+W*ae)*gt,p[9]=(N*gr-S*gi-I*ae)*gt,p[10]=(xt*Kt-At*$t+A*zt)*gt,p[11]=(Z*$t-X*Kt-ot*zt)*gt,p[12]=(P*Qe-L*ir-F*ae)*gt,p[13]=(S*ir-N*Qe+_*ae)*gt,p[14]=(At*Ht-xt*Vt-yt*zt)*gt,p[15]=(X*Vt-Z*Ht+tt*zt)*gt,p):null},r.adjoint=function(p,A){var S=A[0],N=A[1],_=A[2],I=A[3],L=A[4],P=A[5],F=A[6],W=A[7],X=A[8],Z=A[9],tt=A[10],ot=A[11],xt=A[12],At=A[13],yt=A[14];return A=A[15],p[0]=P*(tt*A-ot*yt)-Z*(F*A-W*yt)+At*(F*ot-W*tt),p[1]=-(N*(tt*A-ot*yt)-Z*(_*A-I*yt)+At*(_*ot-I*tt)),p[2]=N*(F*A-W*yt)-P*(_*A-I*yt)+At*(_*W-I*F),p[3]=-(N*(F*ot-W*tt)-P*(_*ot-I*tt)+Z*(_*W-I*F)),p[4]=-(L*(tt*A-ot*yt)-X*(F*A-W*yt)+xt*(F*ot-W*tt)),p[5]=S*(tt*A-ot*yt)-X*(_*A-I*yt)+xt*(_*ot-I*tt),p[6]=-(S*(F*A-W*yt)-L*(_*A-I*yt)+xt*(_*W-I*F)),p[7]=S*(F*ot-W*tt)-L*(_*ot-I*tt)+X*(_*W-I*F),p[8]=L*(Z*A-ot*At)-X*(P*A-W*At)+xt*(P*ot-W*Z),p[9]=-(S*(Z*A-ot*At)-X*(N*A-I*At)+xt*(N*ot-I*Z)),p[10]=S*(P*A-W*At)-L*(N*A-I*At)+xt*(N*W-I*P),p[11]=-(S*(P*ot-W*Z)-L*(N*ot-I*Z)+X*(N*W-I*P)),p[12]=-(L*(Z*yt-tt*At)-X*(P*yt-F*At)+xt*(P*tt-F*Z)),p[13]=S*(Z*yt-tt*At)-X*(N*yt-_*At)+xt*(N*tt-_*Z),p[14]=-(S*(P*yt-F*At)-L*(N*yt-_*At)+xt*(N*F-_*P)),p[15]=S*(P*tt-F*Z)-L*(N*tt-_*Z)+X*(N*F-_*P),p},r.determinant=function(p){var A=p[0],S=p[1],N=p[2],_=p[3],I=p[4],L=p[5],P=p[6],F=p[7],W=p[8],X=p[9],Z=p[10],tt=p[11],ot=p[12],xt=p[13],At=p[14];return p=p[15],(A*L-S*I)*(Z*p-tt*At)-(A*P-N*I)*(X*p-tt*xt)+(A*F-_*I)*(X*At-Z*xt)+(S*P-N*L)*(W*p-tt*ot)-(S*F-_*L)*(W*At-Z*ot)+(N*F-_*P)*(W*xt-X*ot)},r.multiply=s,r.translate=function(p,A,S){var N=S[0],_=S[1];if(S=S[2],A===p)p[12]=A[0]*N+A[4]*_+A[8]*S+A[12],p[13]=A[1]*N+A[5]*_+A[9]*S+A[13],p[14]=A[2]*N+A[6]*_+A[10]*S+A[14],p[15]=A[3]*N+A[7]*_+A[11]*S+A[15];else{var I=A[0],L=A[1],P=A[2],F=A[3],W=A[4],X=A[5],Z=A[6],tt=A[7],ot=A[8],xt=A[9],At=A[10],yt=A[11];p[0]=I,p[1]=L,p[2]=P,p[3]=F,p[4]=W,p[5]=X,p[6]=Z,p[7]=tt,p[8]=ot,p[9]=xt,p[10]=At,p[11]=yt,p[12]=I*N+W*_+ot*S+A[12],p[13]=L*N+X*_+xt*S+A[13],p[14]=P*N+Z*_+At*S+A[14],p[15]=F*N+tt*_+yt*S+A[15]}return p},r.scale=function(p,A,S){var N=S[0],_=S[1];return S=S[2],p[0]=A[0]*N,p[1]=A[1]*N,p[2]=A[2]*N,p[3]=A[3]*N,p[4]=A[4]*_,p[5]=A[5]*_,p[6]=A[6]*_,p[7]=A[7]*_,p[8]=A[8]*S,p[9]=A[9]*S,p[10]=A[10]*S,p[11]=A[11]*S,p[12]=A[12],p[13]=A[13],p[14]=A[14],p[15]=A[15],p},r.rotate=function(p,A,S,N){var _=N[0],I=N[1];N=N[2];var L=Math.sqrt(_*_+I*I+N*N);if(L<g.EPSILON)return null;L=1/L,_*=L,I*=L,N*=L;var P=Math.sin(S),F=Math.cos(S),W=1-F;S=A[0],L=A[1];var X=A[2],Z=A[3],tt=A[4],ot=A[5],xt=A[6],At=A[7],yt=A[8],zt=A[9],Ht=A[10],$t=A[11],Vt=_*_*W+F,Kt=I*_*W+N*P,ze=N*_*W-I*P,ae=_*I*W-N*P,Qe=I*I*W+F,gr=N*I*W+_*P,ir=_*N*W+I*P;return _=I*N*W-_*P,I=N*N*W+F,p[0]=S*Vt+tt*Kt+yt*ze,p[1]=L*Vt+ot*Kt+zt*ze,p[2]=X*Vt+xt*Kt+Ht*ze,p[3]=Z*Vt+At*Kt+$t*ze,p[4]=S*ae+tt*Qe+yt*gr,p[5]=L*ae+ot*Qe+zt*gr,p[6]=X*ae+xt*Qe+Ht*gr,p[7]=Z*ae+At*Qe+$t*gr,p[8]=S*ir+tt*_+yt*I,p[9]=L*ir+ot*_+zt*I,p[10]=X*ir+xt*_+Ht*I,p[11]=Z*ir+At*_+$t*I,A!==p&&(p[12]=A[12],p[13]=A[13],p[14]=A[14],p[15]=A[15]),p},r.rotateX=function(p,A,S){var N=Math.sin(S);S=Math.cos(S);var _=A[4],I=A[5],L=A[6],P=A[7],F=A[8],W=A[9],X=A[10],Z=A[11];return A!==p&&(p[0]=A[0],p[1]=A[1],p[2]=A[2],p[3]=A[3],p[12]=A[12],p[13]=A[13],p[14]=A[14],p[15]=A[15]),p[4]=_*S+F*N,p[5]=I*S+W*N,p[6]=L*S+X*N,p[7]=P*S+Z*N,p[8]=F*S-_*N,p[9]=W*S-I*N,p[10]=X*S-L*N,p[11]=Z*S-P*N,p},r.rotateY=function(p,A,S){var N=Math.sin(S);S=Math.cos(S);var _=A[0],I=A[1],L=A[2],P=A[3],F=A[8],W=A[9],X=A[10],Z=A[11];return A!==p&&(p[4]=A[4],p[5]=A[5],p[6]=A[6],p[7]=A[7],p[12]=A[12],p[13]=A[13],p[14]=A[14],p[15]=A[15]),p[0]=_*S-F*N,p[1]=I*S-W*N,p[2]=L*S-X*N,p[3]=P*S-Z*N,p[8]=_*N+F*S,p[9]=I*N+W*S,p[10]=L*N+X*S,p[11]=P*N+Z*S,p},r.rotateZ=function(p,A,S){var N=Math.sin(S);S=Math.cos(S);var _=A[0],I=A[1],L=A[2],P=A[3],F=A[4],W=A[5],X=A[6],Z=A[7];return A!==p&&(p[8]=A[8],p[9]=A[9],p[10]=A[10],p[11]=A[11],p[12]=A[12],p[13]=A[13],p[14]=A[14],p[15]=A[15]),p[0]=_*S+F*N,p[1]=I*S+W*N,p[2]=L*S+X*N,p[3]=P*S+Z*N,p[4]=F*S-_*N,p[5]=W*S-I*N,p[6]=X*S-L*N,p[7]=Z*S-P*N,p},r.fromTranslation=function(p,A){return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=A[0],p[13]=A[1],p[14]=A[2],p[15]=1,p},r.fromScaling=function(p,A){return p[0]=A[0],p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=A[1],p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=A[2],p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},r.fromRotation=function(p,A,S){var N=S[0],_=S[1];S=S[2];var I=Math.sqrt(N*N+_*_+S*S);if(I<g.EPSILON)return null;I=1/I,N*=I,_*=I,S*=I,I=Math.sin(A),A=Math.cos(A);var L=1-A;return p[0]=N*N*L+A,p[1]=_*N*L+S*I,p[2]=S*N*L-_*I,p[3]=0,p[4]=N*_*L-S*I,p[5]=_*_*L+A,p[6]=S*_*L+N*I,p[7]=0,p[8]=N*S*L+_*I,p[9]=_*S*L-N*I,p[10]=S*S*L+A,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},r.fromXRotation=function(p,A){var S=Math.sin(A);return A=Math.cos(A),p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=A,p[6]=S,p[7]=0,p[8]=0,p[9]=-S,p[10]=A,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},r.fromYRotation=function(p,A){var S=Math.sin(A);return A=Math.cos(A),p[0]=A,p[1]=0,p[2]=-S,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=S,p[9]=0,p[10]=A,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},r.fromZRotation=function(p,A){var S=Math.sin(A);return A=Math.cos(A),p[0]=A,p[1]=S,p[2]=0,p[3]=0,p[4]=-S,p[5]=A,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},r.fromRotationTranslation=f,r.fromQuat2=function(p,A){var S=new g.ARRAY_TYPE(3),N=-A[0],_=-A[1],I=-A[2],L=A[3],P=A[4],F=A[5],W=A[6],X=A[7],Z=N*N+_*_+I*I+L*L;return 0<Z?(S[0]=2*(P*L+X*N+F*I-W*_)/Z,S[1]=2*(F*L+X*_+W*N-P*I)/Z,S[2]=2*(W*L+X*I+P*_-F*N)/Z):(S[0]=2*(P*L+X*N+F*I-W*_),S[1]=2*(F*L+X*_+W*N-P*I),S[2]=2*(W*L+X*I+P*_-F*N)),f(p,A,S),p},r.getTranslation=function(p,A){return p[0]=A[12],p[1]=A[13],p[2]=A[14],p},r.getScaling=function(p,A){var S=A[0],N=A[1],_=A[2],I=A[4],L=A[5],P=A[6],F=A[8],W=A[9];return A=A[10],p[0]=Math.sqrt(S*S+N*N+_*_),p[1]=Math.sqrt(I*I+L*L+P*P),p[2]=Math.sqrt(F*F+W*W+A*A),p},r.getRotation=function(p,A){var S=A[0]+A[5]+A[10];return 0<S?(S=2*Math.sqrt(S+1),p[3]=.25*S,p[0]=(A[6]-A[9])/S,p[1]=(A[8]-A[2])/S,p[2]=(A[1]-A[4])/S):A[0]>A[5]&&A[0]>A[10]?(S=2*Math.sqrt(1+A[0]-A[5]-A[10]),p[3]=(A[6]-A[9])/S,p[0]=.25*S,p[1]=(A[1]+A[4])/S,p[2]=(A[8]+A[2])/S):A[5]>A[10]?(S=2*Math.sqrt(1+A[5]-A[0]-A[10]),p[3]=(A[8]-A[2])/S,p[0]=(A[1]+A[4])/S,p[1]=.25*S,p[2]=(A[6]+A[9])/S):(S=2*Math.sqrt(1+A[10]-A[0]-A[5]),p[3]=(A[1]-A[4])/S,p[0]=(A[8]+A[2])/S,p[1]=(A[6]+A[9])/S,p[2]=.25*S),p},r.fromRotationTranslationScale=function(p,A,S,N){var _=A[0],I=A[1],L=A[2],P=A[3],F=_+_,W=I+I,X=L+L;A=_*F;var Z=_*W;_*=X;var tt=I*W;I*=X,L*=X,F*=P,W*=P,P*=X,X=N[0];var ot=N[1];return N=N[2],p[0]=(1-(tt+L))*X,p[1]=(Z+P)*X,p[2]=(_-W)*X,p[3]=0,p[4]=(Z-P)*ot,p[5]=(1-(A+L))*ot,p[6]=(I+F)*ot,p[7]=0,p[8]=(_+W)*N,p[9]=(I-F)*N,p[10]=(1-(A+tt))*N,p[11]=0,p[12]=S[0],p[13]=S[1],p[14]=S[2],p[15]=1,p},r.fromRotationTranslationScaleOrigin=function(p,A,S,N,_){var I=A[0],L=A[1],P=A[2],F=A[3],W=I+I,X=L+L,Z=P+P;A=I*W;var tt=I*X,ot=I*Z;I=L*X,L*=Z;var xt=P*Z;P=F*W,X*=F;var At=F*Z,yt=N[0],zt=N[1];Z=N[2],N=_[0],F=_[1],_=_[2],W=(1-(I+xt))*yt;var Ht=(tt+At)*yt;return yt*=ot-X,tt=(tt-At)*zt,xt=(1-(A+xt))*zt,zt*=L+P,ot=(ot+X)*Z,L=(L-P)*Z,A=(1-(A+I))*Z,p[0]=W,p[1]=Ht,p[2]=yt,p[3]=0,p[4]=tt,p[5]=xt,p[6]=zt,p[7]=0,p[8]=ot,p[9]=L,p[10]=A,p[11]=0,p[12]=S[0]+N-(W*N+tt*F+ot*_),p[13]=S[1]+F-(Ht*N+xt*F+L*_),p[14]=S[2]+_-(yt*N+zt*F+A*_),p[15]=1,p},r.fromQuat=function(p,A){var S=A[0],N=A[1],_=A[2];A=A[3];var I=S+S,L=N+N,P=_+_;S*=I;var F=N*I;N*=L;var W=_*I,X=_*L;return _*=P,I*=A,L*=A,A*=P,p[0]=1-N-_,p[1]=F+A,p[2]=W-L,p[3]=0,p[4]=F-A,p[5]=1-S-_,p[6]=X+I,p[7]=0,p[8]=W+L,p[9]=X-I,p[10]=1-S-N,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},r.frustum=function(p,A,S,N,_,I,L){var P=1/(S-A),F=1/(_-N),W=1/(I-L);return p[0]=2*I*P,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=2*I*F,p[6]=0,p[7]=0,p[8]=(S+A)*P,p[9]=(_+N)*F,p[10]=(L+I)*W,p[11]=-1,p[12]=0,p[13]=0,p[14]=L*I*2*W,p[15]=0,p},r.perspective=function(p,A,S,N,_){return A=1/Math.tan(A/2),p[0]=A/S,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=A,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[11]=-1,p[12]=0,p[13]=0,p[15]=0,_!=null&&_!==Infinity?(S=1/(N-_),p[10]=(_+N)*S,p[14]=2*_*N*S):(p[10]=-1,p[14]=-2*N),p},r.perspectiveFromFieldOfView=function(p,A,S,N){var _=Math.tan(A.upDegrees*Math.PI/180),I=Math.tan(A.downDegrees*Math.PI/180),L=Math.tan(A.leftDegrees*Math.PI/180);A=Math.tan(A.rightDegrees*Math.PI/180);var P=2/(L+A),F=2/(_+I);return p[0]=P,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=F,p[6]=0,p[7]=0,p[8]=-((L-A)*P*.5),p[9]=(_-I)*F*.5,p[10]=N/(S-N),p[11]=-1,p[12]=0,p[13]=0,p[14]=N*S/(S-N),p[15]=0,p},r.ortho=function(p,A,S,N,_,I,L){var P=1/(A-S),F=1/(N-_),W=1/(I-L);return p[0]=-2*P,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=-2*F,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=2*W,p[11]=0,p[12]=(A+S)*P,p[13]=(_+N)*F,p[14]=(L+I)*W,p[15]=1,p},r.lookAt=function(p,A,S,N){var _=A[0],I=A[1];A=A[2];var L=N[0],P=N[1],F=N[2],W=S[0];N=S[1];var X=S[2];if(Math.abs(_-W)<g.EPSILON&&Math.abs(I-N)<g.EPSILON&&Math.abs(A-X)<g.EPSILON)return i(p);S=_-W,N=I-N,W=A-X;var Z=1/Math.sqrt(S*S+N*N+W*W);S*=Z,N*=Z,W*=Z,X=P*W-F*N,F=F*S-L*W,L=L*N-P*S,(Z=Math.sqrt(X*X+F*F+L*L))?(Z=1/Z,X*=Z,F*=Z,L*=Z):L=F=X=0,P=N*L-W*F;var tt=W*X-S*L,ot=S*F-N*X;return(Z=Math.sqrt(P*P+tt*tt+ot*ot))?(Z=1/Z,P*=Z,tt*=Z,ot*=Z):ot=tt=P=0,p[0]=X,p[1]=P,p[2]=S,p[3]=0,p[4]=F,p[5]=tt,p[6]=N,p[7]=0,p[8]=L,p[9]=ot,p[10]=W,p[11]=0,p[12]=-(X*_+F*I+L*A),p[13]=-(P*_+tt*I+ot*A),p[14]=-(S*_+N*I+W*A),p[15]=1,p},r.targetTo=function(p,A,S,N){var _=A[0],I=A[1];A=A[2];var L=N[0],P=N[1],F=N[2];N=_-S[0];var W=I-S[1];S=A-S[2];var X=N*N+W*W+S*S;0<X&&(X=1/Math.sqrt(X),N*=X,W*=X,S*=X);var Z=P*S-F*W;return F=F*N-L*S,L=L*W-P*N,X=Z*Z+F*F+L*L,0<X&&(X=1/Math.sqrt(X),Z*=X,F*=X,L*=X),p[0]=Z,p[1]=F,p[2]=L,p[3]=0,p[4]=W*L-S*F,p[5]=S*Z-N*L,p[6]=N*F-W*Z,p[7]=0,p[8]=N,p[9]=W,p[10]=S,p[11]=0,p[12]=_,p[13]=I,p[14]=A,p[15]=1,p},r.str=function(p){return"mat4("+p[0]+", "+p[1]+", "+p[2]+", "+p[3]+", "+p[4]+", "+p[5]+", "+p[6]+", "+p[7]+", "+p[8]+", "+p[9]+", "+p[10]+", "+p[11]+", "+p[12]+", "+p[13]+", "+p[14]+", "+p[15]+")"},r.frob=function(p){return Math.sqrt(Math.pow(p[0],2)+Math.pow(p[1],2)+Math.pow(p[2],2)+Math.pow(p[3],2)+Math.pow(p[4],2)+Math.pow(p[5],2)+Math.pow(p[6],2)+Math.pow(p[7],2)+Math.pow(p[8],2)+Math.pow(p[9],2)+Math.pow(p[10],2)+Math.pow(p[11],2)+Math.pow(p[12],2)+Math.pow(p[13],2)+Math.pow(p[14],2)+Math.pow(p[15],2))},r.add=function(p,A,S){return p[0]=A[0]+S[0],p[1]=A[1]+S[1],p[2]=A[2]+S[2],p[3]=A[3]+S[3],p[4]=A[4]+S[4],p[5]=A[5]+S[5],p[6]=A[6]+S[6],p[7]=A[7]+S[7],p[8]=A[8]+S[8],p[9]=A[9]+S[9],p[10]=A[10]+S[10],p[11]=A[11]+S[11],p[12]=A[12]+S[12],p[13]=A[13]+S[13],p[14]=A[14]+S[14],p[15]=A[15]+S[15],p},r.subtract=c,r.multiplyScalar=function(p,A,S){return p[0]=A[0]*S,p[1]=A[1]*S,p[2]=A[2]*S,p[3]=A[3]*S,p[4]=A[4]*S,p[5]=A[5]*S,p[6]=A[6]*S,p[7]=A[7]*S,p[8]=A[8]*S,p[9]=A[9]*S,p[10]=A[10]*S,p[11]=A[11]*S,p[12]=A[12]*S,p[13]=A[13]*S,p[14]=A[14]*S,p[15]=A[15]*S,p},r.multiplyScalarAndAdd=function(p,A,S,N){return p[0]=A[0]+S[0]*N,p[1]=A[1]+S[1]*N,p[2]=A[2]+S[2]*N,p[3]=A[3]+S[3]*N,p[4]=A[4]+S[4]*N,p[5]=A[5]+S[5]*N,p[6]=A[6]+S[6]*N,p[7]=A[7]+S[7]*N,p[8]=A[8]+S[8]*N,p[9]=A[9]+S[9]*N,p[10]=A[10]+S[10]*N,p[11]=A[11]+S[11]*N,p[12]=A[12]+S[12]*N,p[13]=A[13]+S[13]*N,p[14]=A[14]+S[14]*N,p[15]=A[15]+S[15]*N,p},r.exactEquals=function(p,A){return p[0]===A[0]&&p[1]===A[1]&&p[2]===A[2]&&p[3]===A[3]&&p[4]===A[4]&&p[5]===A[5]&&p[6]===A[6]&&p[7]===A[7]&&p[8]===A[8]&&p[9]===A[9]&&p[10]===A[10]&&p[11]===A[11]&&p[12]===A[12]&&p[13]===A[13]&&p[14]===A[14]&&p[15]===A[15]},r.equals=function(p,A){var S=p[0],N=p[1],_=p[2],I=p[3],L=p[4],P=p[5],F=p[6],W=p[7],X=p[8],Z=p[9],tt=p[10],ot=p[11],xt=p[12],At=p[13],yt=p[14];p=p[15];var zt=A[0],Ht=A[1],$t=A[2],Vt=A[3],Kt=A[4],ze=A[5],ae=A[6],Qe=A[7],gr=A[8],ir=A[9],gi=A[10],hr=A[11],gt=A[12],mt=A[13],vt=A[14];return A=A[15],Math.abs(S-zt)<=g.EPSILON*Math.max(1,Math.abs(S),Math.abs(zt))&&Math.abs(N-Ht)<=g.EPSILON*Math.max(1,Math.abs(N),Math.abs(Ht))&&Math.abs(_-$t)<=g.EPSILON*Math.max(1,Math.abs(_),Math.abs($t))&&Math.abs(I-Vt)<=g.EPSILON*Math.max(1,Math.abs(I),Math.abs(Vt))&&Math.abs(L-Kt)<=g.EPSILON*Math.max(1,Math.abs(L),Math.abs(Kt))&&Math.abs(P-ze)<=g.EPSILON*Math.max(1,Math.abs(P),Math.abs(ze))&&Math.abs(F-ae)<=g.EPSILON*Math.max(1,Math.abs(F),Math.abs(ae))&&Math.abs(W-Qe)<=g.EPSILON*Math.max(1,Math.abs(W),Math.abs(Qe))&&Math.abs(X-gr)<=g.EPSILON*Math.max(1,Math.abs(X),Math.abs(gr))&&Math.abs(Z-ir)<=g.EPSILON*Math.max(1,Math.abs(Z),Math.abs(ir))&&Math.abs(tt-gi)<=g.EPSILON*Math.max(1,Math.abs(tt),Math.abs(gi))&&Math.abs(ot-hr)<=g.EPSILON*Math.max(1,Math.abs(ot),Math.abs(hr))&&Math.abs(xt-gt)<=g.EPSILON*Math.max(1,Math.abs(xt),Math.abs(gt))&&Math.abs(At-mt)<=g.EPSILON*Math.max(1,Math.abs(At),Math.abs(mt))&&Math.abs(yt-vt)<=g.EPSILON*Math.max(1,Math.abs(yt),Math.abs(vt))&&Math.abs(p-A)<=g.EPSILON*Math.max(1,Math.abs(p),Math.abs(A))},r.sub=r.mul=void 0;var g=function(p){if(p&&p.__esModule)return p;var A={};if(p!=null){for(var S in p)if(Object.prototype.hasOwnProperty.call(p,S)){var N=go&&To?To(p,S):{};N.get||N.set?go(A,S,N):A[S]=p[S]}}return A.default=p,A}(ju);r.mul=s,r.sub=c});Nt($A);var t2=Rt(function(t,r){function i(){var P=new L.ARRAY_TYPE(3);return L.ARRAY_TYPE!=Float32Array&&(P[0]=0,P[1]=0,P[2]=0),P}function s(P){var F=P[0],W=P[1];return P=P[2],Math.sqrt(F*F+W*W+P*P)}function f(P,F,W){var X=new L.ARRAY_TYPE(3);return X[0]=P,X[1]=F,X[2]=W,X}function c(P,F,W){return P[0]=F[0]-W[0],P[1]=F[1]-W[1],P[2]=F[2]-W[2],P}function g(P,F,W){return P[0]=F[0]*W[0],P[1]=F[1]*W[1],P[2]=F[2]*W[2],P}function p(P,F,W){return P[0]=F[0]/W[0],P[1]=F[1]/W[1],P[2]=F[2]/W[2],P}function A(P,F){var W=F[0]-P[0],X=F[1]-P[1];return P=F[2]-P[2],Math.sqrt(W*W+X*X+P*P)}function S(P,F){var W=F[0]-P[0],X=F[1]-P[1];return P=F[2]-P[2],W*W+X*X+P*P}function N(P){var F=P[0],W=P[1];return P=P[2],F*F+W*W+P*P}function _(P,F){var W=F[0],X=F[1],Z=F[2];return W=W*W+X*X+Z*Z,0<W&&(W=1/Math.sqrt(W)),P[0]=F[0]*W,P[1]=F[1]*W,P[2]=F[2]*W,P}function I(P,F){return P[0]*F[0]+P[1]*F[1]+P[2]*F[2]}Object.defineProperty(r,"__esModule",{value:!0}),r.create=i,r.clone=function(P){var F=new L.ARRAY_TYPE(3);return F[0]=P[0],F[1]=P[1],F[2]=P[2],F},r.length=s,r.fromValues=f,r.copy=function(P,F){return P[0]=F[0],P[1]=F[1],P[2]=F[2],P},r.set=function(P,F,W,X){return P[0]=F,P[1]=W,P[2]=X,P},r.add=function(P,F,W){return P[0]=F[0]+W[0],P[1]=F[1]+W[1],P[2]=F[2]+W[2],P},r.subtract=c,r.multiply=g,r.divide=p,r.ceil=function(P,F){return P[0]=Math.ceil(F[0]),P[1]=Math.ceil(F[1]),P[2]=Math.ceil(F[2]),P},r.floor=function(P,F){return P[0]=Math.floor(F[0]),P[1]=Math.floor(F[1]),P[2]=Math.floor(F[2]),P},r.min=function(P,F,W){return P[0]=Math.min(F[0],W[0]),P[1]=Math.min(F[1],W[1]),P[2]=Math.min(F[2],W[2]),P},r.max=function(P,F,W){return P[0]=Math.max(F[0],W[0]),P[1]=Math.max(F[1],W[1]),P[2]=Math.max(F[2],W[2]),P},r.round=function(P,F){return P[0]=Math.round(F[0]),P[1]=Math.round(F[1]),P[2]=Math.round(F[2]),P},r.scale=function(P,F,W){return P[0]=F[0]*W,P[1]=F[1]*W,P[2]=F[2]*W,P},r.scaleAndAdd=function(P,F,W,X){return P[0]=F[0]+W[0]*X,P[1]=F[1]+W[1]*X,P[2]=F[2]+W[2]*X,P},r.distance=A,r.squaredDistance=S,r.squaredLength=N,r.negate=function(P,F){return P[0]=-F[0],P[1]=-F[1],P[2]=-F[2],P},r.inverse=function(P,F){return P[0]=1/F[0],P[1]=1/F[1],P[2]=1/F[2],P},r.normalize=_,r.dot=I,r.cross=function(P,F,W){var X=F[0],Z=F[1];F=F[2];var tt=W[0],ot=W[1];return W=W[2],P[0]=Z*W-F*ot,P[1]=F*tt-X*W,P[2]=X*ot-Z*tt,P},r.lerp=function(P,F,W,X){var Z=F[0],tt=F[1];return F=F[2],P[0]=Z+X*(W[0]-Z),P[1]=tt+X*(W[1]-tt),P[2]=F+X*(W[2]-F),P},r.hermite=function(P,F,W,X,Z,tt){var ot=tt*tt,xt=ot*(2*tt-3)+1,At=ot*(tt-2)+tt,yt=ot*(tt-1);return tt=ot*(3-2*tt),P[0]=F[0]*xt+W[0]*At+X[0]*yt+Z[0]*tt,P[1]=F[1]*xt+W[1]*At+X[1]*yt+Z[1]*tt,P[2]=F[2]*xt+W[2]*At+X[2]*yt+Z[2]*tt,P},r.bezier=function(P,F,W,X,Z,tt){var ot=1-tt,xt=ot*ot,At=tt*tt,yt=xt*ot;return xt*=3*tt,ot*=3*At,tt*=At,P[0]=F[0]*yt+W[0]*xt+X[0]*ot+Z[0]*tt,P[1]=F[1]*yt+W[1]*xt+X[1]*ot+Z[1]*tt,P[2]=F[2]*yt+W[2]*xt+X[2]*ot+Z[2]*tt,P},r.random=function(P,F){F=F||1;var W=2*L.RANDOM()*Math.PI,X=2*L.RANDOM()-1,Z=Math.sqrt(1-X*X)*F;return P[0]=Math.cos(W)*Z,P[1]=Math.sin(W)*Z,P[2]=X*F,P},r.transformMat4=function(P,F,W){var X=F[0],Z=F[1];F=F[2];var tt=W[3]*X+W[7]*Z+W[11]*F+W[15];return tt=tt||1,P[0]=(W[0]*X+W[4]*Z+W[8]*F+W[12])/tt,P[1]=(W[1]*X+W[5]*Z+W[9]*F+W[13])/tt,P[2]=(W[2]*X+W[6]*Z+W[10]*F+W[14])/tt,P},r.transformMat3=function(P,F,W){var X=F[0],Z=F[1];return F=F[2],P[0]=X*W[0]+Z*W[3]+F*W[6],P[1]=X*W[1]+Z*W[4]+F*W[7],P[2]=X*W[2]+Z*W[5]+F*W[8],P},r.transformQuat=function(P,F,W){var X=W[0],Z=W[1],tt=W[2],ot=F[0],xt=F[1];F=F[2];var At=Z*F-tt*xt,yt=tt*ot-X*F,zt=X*xt-Z*ot;return W=2*W[3],P[0]=ot+At*W+2*(Z*zt-tt*yt),P[1]=xt+yt*W+2*(tt*At-X*zt),P[2]=F+zt*W+2*(X*yt-Z*At),P},r.rotateX=function(P,F,W,X){var Z=[],tt=[];return Z[0]=F[0]-W[0],Z[1]=F[1]-W[1],Z[2]=F[2]-W[2],tt[0]=Z[0],tt[1]=Z[1]*Math.cos(X)-Z[2]*Math.sin(X),tt[2]=Z[1]*Math.sin(X)+Z[2]*Math.cos(X),P[0]=tt[0]+W[0],P[1]=tt[1]+W[1],P[2]=tt[2]+W[2],P},r.rotateY=function(P,F,W,X){var Z=[],tt=[];return Z[0]=F[0]-W[0],Z[1]=F[1]-W[1],Z[2]=F[2]-W[2],tt[0]=Z[2]*Math.sin(X)+Z[0]*Math.cos(X),tt[1]=Z[1],tt[2]=Z[2]*Math.cos(X)-Z[0]*Math.sin(X),P[0]=tt[0]+W[0],P[1]=tt[1]+W[1],P[2]=tt[2]+W[2],P},r.rotateZ=function(P,F,W,X){var Z=[],tt=[];return Z[0]=F[0]-W[0],Z[1]=F[1]-W[1],Z[2]=F[2]-W[2],tt[0]=Z[0]*Math.cos(X)-Z[1]*Math.sin(X),tt[1]=Z[0]*Math.sin(X)+Z[1]*Math.cos(X),tt[2]=Z[2],P[0]=tt[0]+W[0],P[1]=tt[1]+W[1],P[2]=tt[2]+W[2],P},r.angle=function(P,F){return P=f(P[0],P[1],P[2]),F=f(F[0],F[1],F[2]),_(P,P),_(F,F),F=I(P,F),1<F?0:-1>F?Math.PI:Math.acos(F)},r.zero=function(P){return P[0]=0,P[1]=0,P[2]=0,P},r.str=function(P){return"vec3("+P[0]+", "+P[1]+", "+P[2]+")"},r.exactEquals=function(P,F){return P[0]===F[0]&&P[1]===F[1]&&P[2]===F[2]},r.equals=function(P,F){var W=P[0],X=P[1];P=P[2];var Z=F[0],tt=F[1];return F=F[2],Math.abs(W-Z)<=L.EPSILON*Math.max(1,Math.abs(W),Math.abs(Z))&&Math.abs(X-tt)<=L.EPSILON*Math.max(1,Math.abs(X),Math.abs(tt))&&Math.abs(P-F)<=L.EPSILON*Math.max(1,Math.abs(P),Math.abs(F))},r.forEach=r.sqrLen=r.len=r.sqrDist=r.dist=r.div=r.mul=r.sub=void 0;var L=function(P){if(P&&P.__esModule)return P;var F={};if(P!=null){for(var W in P)if(Object.prototype.hasOwnProperty.call(P,W)){var X=go&&To?To(P,W):{};X.get||X.set?go(F,W,X):F[W]=P[W]}}return F.default=P,F}(ju);r.sub=c,r.mul=g,r.div=p,r.dist=A,r.sqrDist=S,r.len=s,r.sqrLen=N,t=function(){var P=i();return function(F,W,X,Z,tt,ot){for(W||(W=3),X||(X=0),Z=Z?Math.min(Z*W+X,F.length):F.length;X<Z;X+=W)P[0]=F[X],P[1]=F[X+1],P[2]=F[X+2],tt(P,P,ot),F[X]=P[0],F[X+1]=P[1],F[X+2]=P[2];return F}}(),r.forEach=t});Nt(t2);var e2=Rt(function(t,r){function i(){var _=new N.ARRAY_TYPE(4);return N.ARRAY_TYPE!=Float32Array&&(_[0]=0,_[1]=0,_[2]=0,_[3]=0),_}function s(_,I,L){return _[0]=I[0]-L[0],_[1]=I[1]-L[1],_[2]=I[2]-L[2],_[3]=I[3]-L[3],_}function f(_,I,L){return _[0]=I[0]*L[0],_[1]=I[1]*L[1],_[2]=I[2]*L[2],_[3]=I[3]*L[3],_}function c(_,I,L){return _[0]=I[0]/L[0],_[1]=I[1]/L[1],_[2]=I[2]/L[2],_[3]=I[3]/L[3],_}function g(_,I){var L=I[0]-_[0],P=I[1]-_[1],F=I[2]-_[2];return _=I[3]-_[3],Math.sqrt(L*L+P*P+F*F+_*_)}function p(_,I){var L=I[0]-_[0],P=I[1]-_[1],F=I[2]-_[2];return _=I[3]-_[3],L*L+P*P+F*F+_*_}function A(_){var I=_[0],L=_[1],P=_[2];return _=_[3],Math.sqrt(I*I+L*L+P*P+_*_)}function S(_){var I=_[0],L=_[1],P=_[2];return _=_[3],I*I+L*L+P*P+_*_}Object.defineProperty(r,"__esModule",{value:!0}),r.create=i,r.clone=function(_){var I=new N.ARRAY_TYPE(4);return I[0]=_[0],I[1]=_[1],I[2]=_[2],I[3]=_[3],I},r.fromValues=function(_,I,L,P){var F=new N.ARRAY_TYPE(4);return F[0]=_,F[1]=I,F[2]=L,F[3]=P,F},r.copy=function(_,I){return _[0]=I[0],_[1]=I[1],_[2]=I[2],_[3]=I[3],_},r.set=function(_,I,L,P,F){return _[0]=I,_[1]=L,_[2]=P,_[3]=F,_},r.add=function(_,I,L){return _[0]=I[0]+L[0],_[1]=I[1]+L[1],_[2]=I[2]+L[2],_[3]=I[3]+L[3],_},r.subtract=s,r.multiply=f,r.divide=c,r.ceil=function(_,I){return _[0]=Math.ceil(I[0]),_[1]=Math.ceil(I[1]),_[2]=Math.ceil(I[2]),_[3]=Math.ceil(I[3]),_},r.floor=function(_,I){return _[0]=Math.floor(I[0]),_[1]=Math.floor(I[1]),_[2]=Math.floor(I[2]),_[3]=Math.floor(I[3]),_},r.min=function(_,I,L){return _[0]=Math.min(I[0],L[0]),_[1]=Math.min(I[1],L[1]),_[2]=Math.min(I[2],L[2]),_[3]=Math.min(I[3],L[3]),_},r.max=function(_,I,L){return _[0]=Math.max(I[0],L[0]),_[1]=Math.max(I[1],L[1]),_[2]=Math.max(I[2],L[2]),_[3]=Math.max(I[3],L[3]),_},r.round=function(_,I){return _[0]=Math.round(I[0]),_[1]=Math.round(I[1]),_[2]=Math.round(I[2]),_[3]=Math.round(I[3]),_},r.scale=function(_,I,L){return _[0]=I[0]*L,_[1]=I[1]*L,_[2]=I[2]*L,_[3]=I[3]*L,_},r.scaleAndAdd=function(_,I,L,P){return _[0]=I[0]+L[0]*P,_[1]=I[1]+L[1]*P,_[2]=I[2]+L[2]*P,_[3]=I[3]+L[3]*P,_},r.distance=g,r.squaredDistance=p,r.length=A,r.squaredLength=S,r.negate=function(_,I){return _[0]=-I[0],_[1]=-I[1],_[2]=-I[2],_[3]=-I[3],_},r.inverse=function(_,I){return _[0]=1/I[0],_[1]=1/I[1],_[2]=1/I[2],_[3]=1/I[3],_},r.normalize=function(_,I){var L=I[0],P=I[1],F=I[2];I=I[3];var W=L*L+P*P+F*F+I*I;return 0<W&&(W=1/Math.sqrt(W)),_[0]=L*W,_[1]=P*W,_[2]=F*W,_[3]=I*W,_},r.dot=function(_,I){return _[0]*I[0]+_[1]*I[1]+_[2]*I[2]+_[3]*I[3]},r.cross=function(_,I,L,P){var F=L[0]*P[1]-L[1]*P[0],W=L[0]*P[2]-L[2]*P[0],X=L[0]*P[3]-L[3]*P[0],Z=L[1]*P[2]-L[2]*P[1],tt=L[1]*P[3]-L[3]*P[1];L=L[2]*P[3]-L[3]*P[2],P=I[0];var ot=I[1],xt=I[2];return I=I[3],_[0]=ot*L-xt*tt+I*Z,_[1]=-(P*L)+xt*X-I*W,_[2]=P*tt-ot*X+I*F,_[3]=-(P*Z)+ot*W-xt*F,_},r.lerp=function(_,I,L,P){var F=I[0],W=I[1],X=I[2];return I=I[3],_[0]=F+P*(L[0]-F),_[1]=W+P*(L[1]-W),_[2]=X+P*(L[2]-X),_[3]=I+P*(L[3]-I),_},r.random=function(_,I){I=I||1;do var L=2*N.RANDOM()-1,P=2*N.RANDOM()-1,F=L*L+P*P;while(1<=F);do var W=2*N.RANDOM()-1,X=2*N.RANDOM()-1,Z=W*W+X*X;while(1<=Z);return F=Math.sqrt((1-F)/Z),_[0]=I*L,_[1]=I*P,_[2]=I*W*F,_[3]=I*X*F,_},r.transformMat4=function(_,I,L){var P=I[0],F=I[1],W=I[2];return I=I[3],_[0]=L[0]*P+L[4]*F+L[8]*W+L[12]*I,_[1]=L[1]*P+L[5]*F+L[9]*W+L[13]*I,_[2]=L[2]*P+L[6]*F+L[10]*W+L[14]*I,_[3]=L[3]*P+L[7]*F+L[11]*W+L[15]*I,_},r.transformQuat=function(_,I,L){var P=I[0],F=I[1],W=I[2],X=L[0],Z=L[1],tt=L[2];L=L[3];var ot=L*P+Z*W-tt*F,xt=L*F+tt*P-X*W,At=L*W+X*F-Z*P;return P=-X*P-Z*F-tt*W,_[0]=ot*L+P*-X+xt*-tt-At*-Z,_[1]=xt*L+P*-Z+At*-X-ot*-tt,_[2]=At*L+P*-tt+ot*-Z-xt*-X,_[3]=I[3],_},r.zero=function(_){return _[0]=0,_[1]=0,_[2]=0,_[3]=0,_},r.str=function(_){return"vec4("+_[0]+", "+_[1]+", "+_[2]+", "+_[3]+")"},r.exactEquals=function(_,I){return _[0]===I[0]&&_[1]===I[1]&&_[2]===I[2]&&_[3]===I[3]},r.equals=function(_,I){var L=_[0],P=_[1],F=_[2];_=_[3];var W=I[0],X=I[1],Z=I[2];return I=I[3],Math.abs(L-W)<=N.EPSILON*Math.max(1,Math.abs(L),Math.abs(W))&&Math.abs(P-X)<=N.EPSILON*Math.max(1,Math.abs(P),Math.abs(X))&&Math.abs(F-Z)<=N.EPSILON*Math.max(1,Math.abs(F),Math.abs(Z))&&Math.abs(_-I)<=N.EPSILON*Math.max(1,Math.abs(_),Math.abs(I))},r.forEach=r.sqrLen=r.len=r.sqrDist=r.dist=r.div=r.mul=r.sub=void 0;var N=function(_){if(_&&_.__esModule)return _;var I={};if(_!=null){for(var L in _)if(Object.prototype.hasOwnProperty.call(_,L)){var P=go&&To?To(_,L):{};P.get||P.set?go(I,L,P):I[L]=_[L]}}return I.default=_,I}(ju);r.sub=s,r.mul=f,r.div=c,r.dist=g,r.sqrDist=p,r.len=A,r.sqrLen=S,t=function(){var _=i();return function(I,L,P,F,W,X){for(L||(L=4),P||(P=0),F=F?Math.min(F*L+P,I.length):I.length;P<F;P+=L)_[0]=I[P],_[1]=I[P+1],_[2]=I[P+2],_[3]=I[P+3],W(_,_,X),I[P]=_[0],I[P+1]=_[1],I[P+2]=_[2],I[P+3]=_[3];return I}}(),r.forEach=t});Nt(e2);var r2=Rt(function(t,r){function i(L){if(L&&L.__esModule)return L;var P={};if(L!=null){for(var F in L)if(Object.prototype.hasOwnProperty.call(L,F)){var W=go&&To?To(L,F):{};W.get||W.set?go(P,F,W):P[F]=L[F]}}return P.default=L,P}function s(){var L=new A.ARRAY_TYPE(4);return A.ARRAY_TYPE!=Float32Array&&(L[0]=0,L[1]=0,L[2]=0),L[3]=1,L}function f(L,P,F){F*=.5;var W=Math.sin(F);return L[0]=W*P[0],L[1]=W*P[1],L[2]=W*P[2],L[3]=Math.cos(F),L}function c(L,P,F){var W=P[0],X=P[1],Z=P[2];P=P[3];var tt=F[0],ot=F[1],xt=F[2];return F=F[3],L[0]=W*F+P*tt+X*xt-Z*ot,L[1]=X*F+P*ot+Z*tt-W*xt,L[2]=Z*F+P*xt+W*ot-X*tt,L[3]=P*F-W*tt-X*ot-Z*xt,L}function g(L,P,F,W){var X=P[0],Z=P[1],tt=P[2];P=P[3];var ot=F[0],xt=F[1],At=F[2];F=F[3];var yt=X*ot+Z*xt+tt*At+P*F;if(0>yt&&(yt=-yt,ot=-ot,xt=-xt,At=-At,F=-F),1-yt>A.EPSILON){var zt=Math.acos(yt),Ht=Math.sin(zt);yt=Math.sin((1-W)*zt)/Ht,W=Math.sin(W*zt)/Ht}else yt=1-W;return L[0]=yt*X+W*ot,L[1]=yt*Z+W*xt,L[2]=yt*tt+W*At,L[3]=yt*P+W*F,L}function p(L,P){var F=P[0]+P[4]+P[8];if(0<F)F=Math.sqrt(F+1),L[3]=.5*F,F=.5/F,L[0]=(P[5]-P[7])*F,L[1]=(P[6]-P[2])*F,L[2]=(P[1]-P[3])*F;else{var W=0;P[4]>P[0]&&(W=1),P[8]>P[3*W+W]&&(W=2);var X=(W+1)%3,Z=(W+2)%3;F=Math.sqrt(P[3*W+W]-P[3*X+X]-P[3*Z+Z]+1),L[W]=.5*F,F=.5/F,L[3]=(P[3*X+Z]-P[3*Z+X])*F,L[X]=(P[3*X+W]+P[3*W+X])*F,L[Z]=(P[3*Z+W]+P[3*W+Z])*F}return L}Object.defineProperty(r,"__esModule",{value:!0}),r.create=s,r.identity=function(L){return L[0]=0,L[1]=0,L[2]=0,L[3]=1,L},r.setAxisAngle=f,r.getAxisAngle=function(L,P){var F=2*Math.acos(P[3]),W=Math.sin(F/2);return W>A.EPSILON?(L[0]=P[0]/W,L[1]=P[1]/W,L[2]=P[2]/W):(L[0]=1,L[1]=0,L[2]=0),F},r.multiply=c,r.rotateX=function(L,P,F){F*=.5;var W=P[0],X=P[1],Z=P[2];P=P[3];var tt=Math.sin(F);return F=Math.cos(F),L[0]=W*F+P*tt,L[1]=X*F+Z*tt,L[2]=Z*F-X*tt,L[3]=P*F-W*tt,L},r.rotateY=function(L,P,F){F*=.5;var W=P[0],X=P[1],Z=P[2];P=P[3];var tt=Math.sin(F);return F=Math.cos(F),L[0]=W*F-Z*tt,L[1]=X*F+P*tt,L[2]=Z*F+W*tt,L[3]=P*F-X*tt,L},r.rotateZ=function(L,P,F){F*=.5;var W=P[0],X=P[1],Z=P[2];P=P[3];var tt=Math.sin(F);return F=Math.cos(F),L[0]=W*F+X*tt,L[1]=X*F-W*tt,L[2]=Z*F+P*tt,L[3]=P*F-Z*tt,L},r.calculateW=function(L,P){var F=P[0],W=P[1];return P=P[2],L[0]=F,L[1]=W,L[2]=P,L[3]=Math.sqrt(Math.abs(1-F*F-W*W-P*P)),L},r.slerp=g,r.random=function(L){var P=A.RANDOM(),F=A.RANDOM(),W=A.RANDOM(),X=Math.sqrt(1-P);return P=Math.sqrt(P),L[0]=X*Math.sin(2*Math.PI*F),L[1]=X*Math.cos(2*Math.PI*F),L[2]=P*Math.sin(2*Math.PI*W),L[3]=P*Math.cos(2*Math.PI*W),L},r.invert=function(L,P){var F=P[0],W=P[1],X=P[2];P=P[3];var Z=F*F+W*W+X*X+P*P;return Z=Z?1/Z:0,L[0]=-F*Z,L[1]=-W*Z,L[2]=-X*Z,L[3]=P*Z,L},r.conjugate=function(L,P){return L[0]=-P[0],L[1]=-P[1],L[2]=-P[2],L[3]=P[3],L},r.fromMat3=p,r.fromEuler=function(L,P,F,W){var X=.5*Math.PI/180;P*=X,F*=X,W*=X,X=Math.sin(P),P=Math.cos(P);var Z=Math.sin(F);F=Math.cos(F);var tt=Math.sin(W);return W=Math.cos(W),L[0]=X*F*W-P*Z*tt,L[1]=P*Z*W+X*F*tt,L[2]=P*F*tt-X*Z*W,L[3]=P*F*W+X*Z*tt,L},r.str=function(L){return"quat("+L[0]+", "+L[1]+", "+L[2]+", "+L[3]+")"},r.setAxes=r.sqlerp=r.rotationTo=r.equals=r.exactEquals=r.normalize=r.sqrLen=r.squaredLength=r.len=r.length=r.lerp=r.dot=r.scale=r.mul=r.add=r.set=r.copy=r.fromValues=r.clone=void 0;var A=i(ju),S=i(QA),N=i(t2);t=i(e2),r.clone=t.clone,r.fromValues=t.fromValues,r.copy=t.copy,r.set=t.set,r.add=t.add,r.mul=c,r.scale=t.scale,r.dot=t.dot,r.lerp=t.lerp;var _=t.length;r.length=_,r.len=_,_=t.squaredLength,r.squaredLength=_,r.sqrLen=_;var I=t.normalize;r.normalize=I,r.exactEquals=t.exactEquals,r.equals=t.equals,t=function(){var L=N.create(),P=N.fromValues(1,0,0),F=N.fromValues(0,1,0);return function(W,X,Z){var tt=N.dot(X,Z);return-.999999>tt?(N.cross(L,P,X),1e-6>N.len(L)&&N.cross(L,F,X),N.normalize(L,L),f(W,L,Math.PI),W):.999999<tt?(W[0]=0,W[1]=0,W[2]=0,W[3]=1,W):(N.cross(L,X,Z),W[0]=L[0],W[1]=L[1],W[2]=L[2],W[3]=1+tt,I(W,W))}}(),r.rotationTo=t,t=function(){var L=s(),P=s();return function(F,W,X,Z,tt,ot){return g(L,W,tt,ot),g(P,X,Z,ot),g(F,L,P,2*ot*(1-ot)),F}}(),r.sqlerp=t,t=function(){var L=S.create();return function(P,F,W,X){return L[0]=W[0],L[3]=W[1],L[6]=W[2],L[1]=X[0],L[4]=X[1],L[7]=X[2],L[2]=-F[0],L[5]=-F[1],L[8]=-F[2],I(P,p(P,L))}}(),r.setAxes=t});Nt(r2);var f_=Rt(function(t,r){function i(_){if(_&&_.__esModule)return _;var I={};if(_!=null){for(var L in _)if(Object.prototype.hasOwnProperty.call(_,L)){var P=go&&To?To(_,L):{};P.get||P.set?go(I,L,P):I[L]=_[L]}}return I.default=_,I}function s(_,I,L){var P=.5*L[0],F=.5*L[1];L=.5*L[2];var W=I[0],X=I[1],Z=I[2];return I=I[3],_[0]=W,_[1]=X,_[2]=Z,_[3]=I,_[4]=P*I+F*Z-L*X,_[5]=F*I+L*W-P*Z,_[6]=L*I+P*X-F*W,_[7]=-P*W-F*X-L*Z,_}function f(_,I){return _[0]=I[0],_[1]=I[1],_[2]=I[2],_[3]=I[3],_[4]=I[4],_[5]=I[5],_[6]=I[6],_[7]=I[7],_}function c(_,I,L){var P=I[0],F=I[1],W=I[2],X=I[3],Z=L[4],tt=L[5],ot=L[6],xt=L[7],At=I[4],yt=I[5],zt=I[6];I=I[7];var Ht=L[0],$t=L[1],Vt=L[2];return L=L[3],_[0]=P*L+X*Ht+F*Vt-W*$t,_[1]=F*L+X*$t+W*Ht-P*Vt,_[2]=W*L+X*Vt+P*$t-F*Ht,_[3]=X*L-P*Ht-F*$t-W*Vt,_[4]=P*xt+X*Z+F*ot-W*tt+At*L+I*Ht+yt*Vt-zt*$t,_[5]=F*xt+X*tt+W*Z-P*ot+yt*L+I*$t+zt*Ht-At*Vt,_[6]=W*xt+X*ot+P*tt-F*Z+zt*L+I*Vt+At*$t-yt*Ht,_[7]=X*xt-P*Z-F*tt-W*ot+I*L-At*Ht-yt*$t-zt*Vt,_}Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var _=new g.ARRAY_TYPE(8);return g.ARRAY_TYPE!=Float32Array&&(_[0]=0,_[1]=0,_[2]=0,_[4]=0,_[5]=0,_[6]=0,_[7]=0),_[3]=1,_},r.clone=function(_){var I=new g.ARRAY_TYPE(8);return I[0]=_[0],I[1]=_[1],I[2]=_[2],I[3]=_[3],I[4]=_[4],I[5]=_[5],I[6]=_[6],I[7]=_[7],I},r.fromValues=function(_,I,L,P,F,W,X,Z){var tt=new g.ARRAY_TYPE(8);return tt[0]=_,tt[1]=I,tt[2]=L,tt[3]=P,tt[4]=F,tt[5]=W,tt[6]=X,tt[7]=Z,tt},r.fromRotationTranslationValues=function(_,I,L,P,F,W,X){var Z=new g.ARRAY_TYPE(8);return Z[0]=_,Z[1]=I,Z[2]=L,Z[3]=P,F*=.5,W*=.5,X*=.5,Z[4]=F*P+W*L-X*I,Z[5]=W*P+X*_-F*L,Z[6]=X*P+F*I-W*_,Z[7]=-F*_-W*I-X*L,Z},r.fromRotationTranslation=s,r.fromTranslation=function(_,I){return _[0]=0,_[1]=0,_[2]=0,_[3]=1,_[4]=.5*I[0],_[5]=.5*I[1],_[6]=.5*I[2],_[7]=0,_},r.fromRotation=function(_,I){return _[0]=I[0],_[1]=I[1],_[2]=I[2],_[3]=I[3],_[4]=0,_[5]=0,_[6]=0,_[7]=0,_},r.fromMat4=function(_,I){var L=p.create();A.getRotation(L,I);var P=new g.ARRAY_TYPE(3);return A.getTranslation(P,I),s(_,L,P),_},r.copy=f,r.identity=function(_){return _[0]=0,_[1]=0,_[2]=0,_[3]=1,_[4]=0,_[5]=0,_[6]=0,_[7]=0,_},r.set=function(_,I,L,P,F,W,X,Z,tt){return _[0]=I,_[1]=L,_[2]=P,_[3]=F,_[4]=W,_[5]=X,_[6]=Z,_[7]=tt,_},r.getDual=function(_,I){return _[0]=I[4],_[1]=I[5],_[2]=I[6],_[3]=I[7],_},r.setDual=function(_,I){return _[4]=I[0],_[5]=I[1],_[6]=I[2],_[7]=I[3],_},r.getTranslation=function(_,I){var L=I[4],P=I[5],F=I[6],W=I[7],X=-I[0],Z=-I[1],tt=-I[2];return I=I[3],_[0]=2*(L*I+W*X+P*tt-F*Z),_[1]=2*(P*I+W*Z+F*X-L*tt),_[2]=2*(F*I+W*tt+L*Z-P*X),_},r.translate=function(_,I,L){var P=I[0],F=I[1],W=I[2],X=I[3],Z=.5*L[0],tt=.5*L[1];L=.5*L[2];var ot=I[4],xt=I[5],At=I[6];return I=I[7],_[0]=P,_[1]=F,_[2]=W,_[3]=X,_[4]=X*Z+F*L-W*tt+ot,_[5]=X*tt+W*Z-P*L+xt,_[6]=X*L+P*tt-F*Z+At,_[7]=-P*Z-F*tt-W*L+I,_},r.rotateX=function(_,I,L){var P=-I[0],F=-I[1],W=-I[2],X=I[3],Z=I[4],tt=I[5],ot=I[6],xt=I[7],At=Z*X+xt*P+tt*W-ot*F,yt=tt*X+xt*F+ot*P-Z*W,zt=ot*X+xt*W+Z*F-tt*P;return Z=xt*X-Z*P-tt*F-ot*W,p.rotateX(_,I,L),P=_[0],F=_[1],W=_[2],X=_[3],_[4]=At*X+Z*P+yt*W-zt*F,_[5]=yt*X+Z*F+zt*P-At*W,_[6]=zt*X+Z*W+At*F-yt*P,_[7]=Z*X-At*P-yt*F-zt*W,_},r.rotateY=function(_,I,L){var P=-I[0],F=-I[1],W=-I[2],X=I[3],Z=I[4],tt=I[5],ot=I[6],xt=I[7],At=Z*X+xt*P+tt*W-ot*F,yt=tt*X+xt*F+ot*P-Z*W,zt=ot*X+xt*W+Z*F-tt*P;return Z=xt*X-Z*P-tt*F-ot*W,p.rotateY(_,I,L),P=_[0],F=_[1],W=_[2],X=_[3],_[4]=At*X+Z*P+yt*W-zt*F,_[5]=yt*X+Z*F+zt*P-At*W,_[6]=zt*X+Z*W+At*F-yt*P,_[7]=Z*X-At*P-yt*F-zt*W,_},r.rotateZ=function(_,I,L){var P=-I[0],F=-I[1],W=-I[2],X=I[3],Z=I[4],tt=I[5],ot=I[6],xt=I[7],At=Z*X+xt*P+tt*W-ot*F,yt=tt*X+xt*F+ot*P-Z*W,zt=ot*X+xt*W+Z*F-tt*P;return Z=xt*X-Z*P-tt*F-ot*W,p.rotateZ(_,I,L),P=_[0],F=_[1],W=_[2],X=_[3],_[4]=At*X+Z*P+yt*W-zt*F,_[5]=yt*X+Z*F+zt*P-At*W,_[6]=zt*X+Z*W+At*F-yt*P,_[7]=Z*X-At*P-yt*F-zt*W,_},r.rotateByQuatAppend=function(_,I,L){var P=L[0],F=L[1],W=L[2];L=L[3];var X=I[0],Z=I[1],tt=I[2],ot=I[3];return _[0]=X*L+ot*P+Z*W-tt*F,_[1]=Z*L+ot*F+tt*P-X*W,_[2]=tt*L+ot*W+X*F-Z*P,_[3]=ot*L-X*P-Z*F-tt*W,X=I[4],Z=I[5],tt=I[6],ot=I[7],_[4]=X*L+ot*P+Z*W-tt*F,_[5]=Z*L+ot*F+tt*P-X*W,_[6]=tt*L+ot*W+X*F-Z*P,_[7]=ot*L-X*P-Z*F-tt*W,_},r.rotateByQuatPrepend=function(_,I,L){var P=I[0],F=I[1],W=I[2];I=I[3];var X=L[0],Z=L[1],tt=L[2],ot=L[3];return _[0]=P*ot+I*X+F*tt-W*Z,_[1]=F*ot+I*Z+W*X-P*tt,_[2]=W*ot+I*tt+P*Z-F*X,_[3]=I*ot-P*X-F*Z-W*tt,X=L[4],Z=L[5],tt=L[6],ot=L[7],_[4]=P*ot+I*X+F*tt-W*Z,_[5]=F*ot+I*Z+W*X-P*tt,_[6]=W*ot+I*tt+P*Z-F*X,_[7]=I*ot-P*X-F*Z-W*tt,_},r.rotateAroundAxis=function(_,I,L,P){if(Math.abs(P)<g.EPSILON)return f(_,I);var F=Math.sqrt(L[0]*L[0]+L[1]*L[1]+L[2]*L[2]);P*=.5;var W=Math.sin(P),X=W*L[0]/F,Z=W*L[1]/F;L=W*L[2]/F,P=Math.cos(P),F=I[0],W=I[1];var tt=I[2],ot=I[3];return _[0]=F*P+ot*X+W*L-tt*Z,_[1]=W*P+ot*Z+tt*X-F*L,_[2]=tt*P+ot*L+F*Z-W*X,_[3]=ot*P-F*X-W*Z-tt*L,F=I[4],W=I[5],tt=I[6],I=I[7],_[4]=F*P+I*X+W*L-tt*Z,_[5]=W*P+I*Z+tt*X-F*L,_[6]=tt*P+I*L+F*Z-W*X,_[7]=I*P-F*X-W*Z-tt*L,_},r.add=function(_,I,L){return _[0]=I[0]+L[0],_[1]=I[1]+L[1],_[2]=I[2]+L[2],_[3]=I[3]+L[3],_[4]=I[4]+L[4],_[5]=I[5]+L[5],_[6]=I[6]+L[6],_[7]=I[7]+L[7],_},r.multiply=c,r.scale=function(_,I,L){return _[0]=I[0]*L,_[1]=I[1]*L,_[2]=I[2]*L,_[3]=I[3]*L,_[4]=I[4]*L,_[5]=I[5]*L,_[6]=I[6]*L,_[7]=I[7]*L,_},r.lerp=function(_,I,L,P){var F=1-P;return 0>S(I,L)&&(P=-P),_[0]=I[0]*F+L[0]*P,_[1]=I[1]*F+L[1]*P,_[2]=I[2]*F+L[2]*P,_[3]=I[3]*F+L[3]*P,_[4]=I[4]*F+L[4]*P,_[5]=I[5]*F+L[5]*P,_[6]=I[6]*F+L[6]*P,_[7]=I[7]*F+L[7]*P,_},r.invert=function(_,I){var L=N(I);return _[0]=-I[0]/L,_[1]=-I[1]/L,_[2]=-I[2]/L,_[3]=I[3]/L,_[4]=-I[4]/L,_[5]=-I[5]/L,_[6]=-I[6]/L,_[7]=I[7]/L,_},r.conjugate=function(_,I){return _[0]=-I[0],_[1]=-I[1],_[2]=-I[2],_[3]=I[3],_[4]=-I[4],_[5]=-I[5],_[6]=-I[6],_[7]=I[7],_},r.normalize=function(_,I){var L=N(I);if(0<L){L=Math.sqrt(L);var P=I[0]/L,F=I[1]/L,W=I[2]/L,X=I[3]/L,Z=I[4],tt=I[5],ot=I[6];I=I[7];var xt=P*Z+F*tt+W*ot+X*I;_[0]=P,_[1]=F,_[2]=W,_[3]=X,_[4]=(Z-P*xt)/L,_[5]=(tt-F*xt)/L,_[6]=(ot-W*xt)/L,_[7]=(I-X*xt)/L}return _},r.str=function(_){return"quat2("+_[0]+", "+_[1]+", "+_[2]+", "+_[3]+", "+_[4]+", "+_[5]+", "+_[6]+", "+_[7]+")"},r.exactEquals=function(_,I){return _[0]===I[0]&&_[1]===I[1]&&_[2]===I[2]&&_[3]===I[3]&&_[4]===I[4]&&_[5]===I[5]&&_[6]===I[6]&&_[7]===I[7]},r.equals=function(_,I){var L=_[0],P=_[1],F=_[2],W=_[3],X=_[4],Z=_[5],tt=_[6];_=_[7];var ot=I[0],xt=I[1],At=I[2],yt=I[3],zt=I[4],Ht=I[5],$t=I[6];return I=I[7],Math.abs(L-ot)<=g.EPSILON*Math.max(1,Math.abs(L),Math.abs(ot))&&Math.abs(P-xt)<=g.EPSILON*Math.max(1,Math.abs(P),Math.abs(xt))&&Math.abs(F-At)<=g.EPSILON*Math.max(1,Math.abs(F),Math.abs(At))&&Math.abs(W-yt)<=g.EPSILON*Math.max(1,Math.abs(W),Math.abs(yt))&&Math.abs(X-zt)<=g.EPSILON*Math.max(1,Math.abs(X),Math.abs(zt))&&Math.abs(Z-Ht)<=g.EPSILON*Math.max(1,Math.abs(Z),Math.abs(Ht))&&Math.abs(tt-$t)<=g.EPSILON*Math.max(1,Math.abs(tt),Math.abs($t))&&Math.abs(_-I)<=g.EPSILON*Math.max(1,Math.abs(_),Math.abs(I))},r.sqrLen=r.squaredLength=r.len=r.length=r.dot=r.mul=r.setReal=r.getReal=void 0;var g=i(ju),p=i(r2),A=i($A);r.getReal=p.copy,r.setReal=p.copy,r.mul=c;var S=p.dot;r.dot=S,t=p.length,r.length=t,r.len=t;var N=p.squaredLength;r.squaredLength=N,r.sqrLen=N});Nt(f_);var p_=Rt(function(t,r){function i(){var _=new N.ARRAY_TYPE(2);return N.ARRAY_TYPE!=Float32Array&&(_[0]=0,_[1]=0),_}function s(_,I,L){return _[0]=I[0]-L[0],_[1]=I[1]-L[1],_}function f(_,I,L){return _[0]=I[0]*L[0],_[1]=I[1]*L[1],_}function c(_,I,L){return _[0]=I[0]/L[0],_[1]=I[1]/L[1],_}function g(_,I){var L=I[0]-_[0];return _=I[1]-_[1],Math.sqrt(L*L+_*_)}function p(_,I){var L=I[0]-_[0];return _=I[1]-_[1],L*L+_*_}function A(_){var I=_[0];return _=_[1],Math.sqrt(I*I+_*_)}function S(_){var I=_[0];return _=_[1],I*I+_*_}Object.defineProperty(r,"__esModule",{value:!0}),r.create=i,r.clone=function(_){var I=new N.ARRAY_TYPE(2);return I[0]=_[0],I[1]=_[1],I},r.fromValues=function(_,I){var L=new N.ARRAY_TYPE(2);return L[0]=_,L[1]=I,L},r.copy=function(_,I){return _[0]=I[0],_[1]=I[1],_},r.set=function(_,I,L){return _[0]=I,_[1]=L,_},r.add=function(_,I,L){return _[0]=I[0]+L[0],_[1]=I[1]+L[1],_},r.subtract=s,r.multiply=f,r.divide=c,r.ceil=function(_,I){return _[0]=Math.ceil(I[0]),_[1]=Math.ceil(I[1]),_},r.floor=function(_,I){return _[0]=Math.floor(I[0]),_[1]=Math.floor(I[1]),_},r.min=function(_,I,L){return _[0]=Math.min(I[0],L[0]),_[1]=Math.min(I[1],L[1]),_},r.max=function(_,I,L){return _[0]=Math.max(I[0],L[0]),_[1]=Math.max(I[1],L[1]),_},r.round=function(_,I){return _[0]=Math.round(I[0]),_[1]=Math.round(I[1]),_},r.scale=function(_,I,L){return _[0]=I[0]*L,_[1]=I[1]*L,_},r.scaleAndAdd=function(_,I,L,P){return _[0]=I[0]+L[0]*P,_[1]=I[1]+L[1]*P,_},r.distance=g,r.squaredDistance=p,r.length=A,r.squaredLength=S,r.negate=function(_,I){return _[0]=-I[0],_[1]=-I[1],_},r.inverse=function(_,I){return _[0]=1/I[0],_[1]=1/I[1],_},r.normalize=function(_,I){var L=I[0],P=I[1];return L=L*L+P*P,0<L&&(L=1/Math.sqrt(L)),_[0]=I[0]*L,_[1]=I[1]*L,_},r.dot=function(_,I){return _[0]*I[0]+_[1]*I[1]},r.cross=function(_,I,L){return I=I[0]*L[1]-I[1]*L[0],_[0]=_[1]=0,_[2]=I,_},r.lerp=function(_,I,L,P){var F=I[0];return I=I[1],_[0]=F+P*(L[0]-F),_[1]=I+P*(L[1]-I),_},r.random=function(_,I){I=I||1;var L=2*N.RANDOM()*Math.PI;return _[0]=Math.cos(L)*I,_[1]=Math.sin(L)*I,_},r.transformMat2=function(_,I,L){var P=I[0];return I=I[1],_[0]=L[0]*P+L[2]*I,_[1]=L[1]*P+L[3]*I,_},r.transformMat2d=function(_,I,L){var P=I[0];return I=I[1],_[0]=L[0]*P+L[2]*I+L[4],_[1]=L[1]*P+L[3]*I+L[5],_},r.transformMat3=function(_,I,L){var P=I[0];return I=I[1],_[0]=L[0]*P+L[3]*I+L[6],_[1]=L[1]*P+L[4]*I+L[7],_},r.transformMat4=function(_,I,L){var P=I[0];return I=I[1],_[0]=L[0]*P+L[4]*I+L[12],_[1]=L[1]*P+L[5]*I+L[13],_},r.rotate=function(_,I,L,P){var F=I[0]-L[0];I=I[1]-L[1];var W=Math.sin(P);return P=Math.cos(P),_[0]=F*P-I*W+L[0],_[1]=F*W+I*P+L[1],_},r.angle=function(_,I){var L=_[0];_=_[1];var P=I[0];I=I[1];var F=L*L+_*_;0<F&&(F=1/Math.sqrt(F));var W=P*P+I*I;return 0<W&&(W=1/Math.sqrt(W)),L=(L*P+_*I)*F*W,1<L?0:-1>L?Math.PI:Math.acos(L)},r.zero=function(_){return _[0]=0,_[1]=0,_},r.str=function(_){return"vec2("+_[0]+", "+_[1]+")"},r.exactEquals=function(_,I){return _[0]===I[0]&&_[1]===I[1]},r.equals=function(_,I){var L=_[0];_=_[1];var P=I[0];return I=I[1],Math.abs(L-P)<=N.EPSILON*Math.max(1,Math.abs(L),Math.abs(P))&&Math.abs(_-I)<=N.EPSILON*Math.max(1,Math.abs(_),Math.abs(I))},r.forEach=r.sqrLen=r.sqrDist=r.dist=r.div=r.mul=r.sub=r.len=void 0;var N=function(_){if(_&&_.__esModule)return _;var I={};if(_!=null){for(var L in _)if(Object.prototype.hasOwnProperty.call(_,L)){var P=go&&To?To(_,L):{};P.get||P.set?go(I,L,P):I[L]=_[L]}}return I.default=_,I}(ju);r.len=A,r.sub=s,r.mul=f,r.div=c,r.dist=g,r.sqrDist=p,r.sqrLen=S,t=function(){var _=i();return function(I,L,P,F,W,X){for(L||(L=2),P||(P=0),F=F?Math.min(F*L+P,I.length):I.length;P<F;P+=L)_[0]=I[P],_[1]=I[P+1],W(_,_,X),I[P]=_[0],I[P+1]=_[1];return I}}(),r.forEach=t});Nt(p_);var d_=Rt(function(t,r){function i(s){if(s&&s.__esModule)return s;var f={};if(s!=null){for(var c in s)if(Object.prototype.hasOwnProperty.call(s,c)){var g=go&&To?To(s,c):{};g.get||g.set?go(f,c,g):f[c]=s[c]}}return f.default=s,f}Object.defineProperty(r,"__esModule",{value:!0}),r.vec4=r.vec3=r.vec2=r.quat2=r.quat=r.mat4=r.mat3=r.mat2d=r.mat2=r.glMatrix=void 0,t=i(ju),r.glMatrix=t,t=i(h_),r.mat2=t,t=i(c_),r.mat2d=t,t=i(QA),r.mat3=t,t=i($A),r.mat4=t,t=i(r2),r.quat=t,t=i(f_),r.quat2=t,t=i(p_),r.vec2=t,t=i(t2),r.vec3=t,t=i(e2),r.vec4=t});Nt(d_);var ts=d_.mat4,du=function(){function t(r,i,s){Ji(this,t),this.options=i,this.gl=r,s&&(this.map=s.map),s=this.getVertexShader(i.vertexShader);var f=this.getFragmentShader(i.fragmentShader);i=r.createShader(r.VERTEX_SHADER),r.shaderSource(i,s),r.compileShader(i),r.getShaderParameter(i,r.COMPILE_STATUS)?(s=r.createShader(r.FRAGMENT_SHADER),r.shaderSource(s,f),r.compileShader(s),r.getShaderParameter(s,r.COMPILE_STATUS)?(f=r.createProgram(),r.attachShader(f,i),r.attachShader(f,s),r.deleteShader(i),r.deleteShader(s),r.linkProgram(f),r.getProgramParameter(f,r.LINK_STATUS)?i=f:(i="Shader program failed to link.  The error log is:"+r.getProgramInfoLog(f),console.error(i),i=-1)):(i="Fragment shader failed to compile.  The error log is:"+r.getShaderInfoLog(s),console.error(i),i=-1)):(i="Vertex shader failed to compile.  The error log is:"+r.getShaderInfoLog(i),console.error(i),i=-1),i=this.program=i,s={},f=r.getProgramParameter(i,r.ACTIVE_ATTRIBUTES);for(var c=0;c<f;c++){var g=r.getActiveAttrib(i,c);s[g.name]=r.getAttribLocation(i,g.name)}c={},g={};for(var p=r.getProgramParameter(i,r.ACTIVE_UNIFORMS),A=0;A<p;A++){var S=r.getActiveUniform(i,A);c[S.name]=r.getUniformLocation(i,S.name),g[S.name]=S.type}this.parameter=r={attributes:s,numAttributes:f,uniformsType:g,uniforms:c},this.attributes=r.attributes,this.uniforms=r.uniforms,this.parameter=r}return Cn(t,[{key:"getVertexShader",value:function(r){var i="";return this.map&&this.map.type==="cesium"&&(i=`#define LOG_DEPTH
`),i+=`#ifdef LOG_DEPTH
uniform float currentFrustumX;varying float v_depthFromNearPlusOne;
#endif
uniform vec2 MAPV_resolution;
#if defined(PICK)
uniform bool uIsPickRender;attribute vec3 aPickColor;uniform vec3 uPickedColor;varying vec4 vPickColor;uniform bool uEnablePicked;bool mapvIsPicked(){return uEnablePicked&&aPickColor==uPickedColor;}
#endif
void afterMain(){
#if defined(LOG_DEPTH)
v_depthFromNearPlusOne=(gl_Position.w-currentFrustumX)+1.0;gl_Position.z=clamp(gl_Position.z/gl_Position.w,-1.0,1.0)*gl_Position.w;
#endif
#if defined(PICK)
vPickColor=vec4(aPickColor,0.0);if(mapvIsPicked()){vPickColor.a=1.0;}
#endif
}`,r=this.getDefines()+i+r,r=r.replace("void main","void originMain"),r+"void main() {originMain(); afterMain();}"}},{key:"getFragmentShader",value:function(r){var i="";return this.map&&this.map.type==="cesium"&&(i=`#define LOG_DEPTH
`),i+=`#if defined(LOG_DEPTH)
#extension GL_EXT_frag_depth : enable
#endif
precision highp float;uniform vec2 MAPV_resolution;uniform bool uIsPickRender;
#if defined(PICK)
varying vec4 vPickColor;bool mapvIsPicked(){return vPickColor.a==1.0;}
#endif
#if defined(LOG_DEPTH)
uniform float oneOverLog2FarDepthFromNearPlusOne;uniform float farDepthFromNearPlusOne;varying float v_depthFromNearPlusOne;void writeLogDepth(float depth){if(depth<=0.9999999||depth>farDepthFromNearPlusOne){discard;}gl_FragDepthEXT=log2(depth)*oneOverLog2FarDepthFromNearPlusOne;}
#endif
void afterMain(){
#if defined(PICK)
if(uIsPickRender){gl_FragColor=vec4(vPickColor.rgb,1.0);return;}
#endif
#if defined(LOG_DEPTH)
writeLogDepth(v_depthFromNearPlusOne);
#endif
}`,r=this.getDefines()+i+r,r=r.replace("void main","void originMain"),r+"void main() {originMain(); afterMain();}"}},{key:"getDefines",value:function(){var r="",i=this.options.defines;if(i)for(var s=0;s<i.length;s++)r+="#define "+i[s]+`
`;return r}},{key:"use",value:function(r,i){this.gl=r,r.useProgram(this.program),this.map&&this.map.type==="cesium"&&this.setUniforms({currentFrustumX:this.map.map.scene.camera.frustum.near,oneOverLog2FarDepthFromNearPlusOne:this.map.map.scene.context.uniformState.oneOverLog2FarDepthFromNearPlusOne,farDepthFromNearPlusOne:this.map.map.scene.context.uniformState.farDepthFromNearPlusOne}),this.uniforms.MAPV_resolution&&this.setUniforms({MAPV_resolution:[r.canvas.width,r.canvas.height]})}},{key:"setUniform",value:function(r,i){var s=this.gl,f=this.uniforms[r];if(f)switch(this.parameter.uniformsType[r]){case s.FLOAT:s.uniform1f(f,i);break;case s.FLOAT_VEC2:s.uniform2f(f,i[0],i[1]);break;case s.FLOAT_VEC3:s.uniform3f(f,i[0],i[1],i[2]);break;case s.FLOAT_VEC4:s.uniform4f(f,i[0],i[1],i[2],i[3]);break;case s.SAMPLER_2D:case s.SAMPLER_CUBE:s.activeTexture(s["TEXTURE"+this.textureIndex]),s.uniform1i(f,this.textureIndex),s.bindTexture(s.TEXTURE_2D,i),this.textureIndex++;break;case s.INT:case s.BOOL:s.uniform1i(f,i);break;case s.INT_VEC2:case s.BOOL_VEC2:s.uniform2i(f,i[0],i[1]);break;case s.INT_VEC3:case s.BOOL_VEC3:s.uniform3i(f,i[0],i[1],i[2]);break;case s.INT_VEC4:case s.BOOL_VEC4:s.uniform4i(f,i[0],i[1],i[2],i[3]);break;case s.FLOAT_MAT2:s.uniformMatrix2fv(f,!1,i);break;case s.FLOAT_MAT3:s.uniformMatrix3fv(f,!1,i);break;case s.FLOAT_MAT4:s.uniformMatrix4fv(f,!1,i);break;default:console.error("Unrecognized uniform type: "+r)}else console.warn("Unrecognized uniform type: "+r)}},{key:"setUniforms",value:function(r){this.textureIndex=0;for(var i in r)this.setUniform(i,r[i])}}]),t}(),bh=function(t,r,i,s){var f=i?i.call(s,t,r):void 0;if(f!==void 0)return!!f;if(t===r)return!0;if((typeof t=="undefined"?"undefined":Ua(t))!=="object"||!t||(typeof r=="undefined"?"undefined":Ua(r))!=="object"||!r)return!1;var c=qi(t),g=qi(r);if(c.length!==g.length)return!1;g=Object.prototype.hasOwnProperty.bind(r);for(var p=0;p<c.length;p++){if(f=c[p],!g(f))return!1;var A=t[f],S=r[f];if(f=i?i.call(s,A,S,f):void 0,f===!1||f===void 0&&A!==S)return!1}return!0},zC=function(){function t(r){Ji(this,t),this.options=r,this.gl=r.gl,this.savedState=[],this.currentState=this.getDefaultState()}return Cn(t,[{key:"setDefaultState",value:function(){this.setState()}},{key:"getDefaultState",value:function(){var r=this.gl;return{blend:!1,blendEquation:r.FUNC_ADD,blendFunc:[r.ONE,r.ZERO],depthMask:!0,depthTest:!0,depthFunc:r.LEQUAL,polygonOffset:[0,0],cullFace:!1,stencilTest:!1}}},{key:"getRealState",value:function(){var r=this.gl;return{blend:r.getParameter(r.BLEND),blendEquation:r.getParameter(r.BLEND_EQUATION),depthMask:r.getParameter(r.DEPTH_WRITEMASK),depthTest:r.getParameter(r.DEPTH_TEST),depthFunc:r.getParameter(r.DEPTH_FUNC),polygonOffset:[r.getParameter(r.POLYGON_OFFSET_FACTOR),r.getParameter(r.POLYGON_OFFSET_UNITS)],cullFace:r.getParameter(r.CULL_FACE),stencilTest:r.getParameter(r.STENCIL_TEST)}}},{key:"getCurrentState",value:function(){return this.currentState}},{key:"save",value:function(){this.savedState.push(this.getCurrentState())}},{key:"restore",value:function(){var r=this.savedState.pop();this.setState(r,{force:!0})}},{key:"setState",value:function(r){var i=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};r=ut(this.getDefaultState(),r),this.setBlend(r,i),this.setDepth(r,i),this.setCullFace(r,i),this.setPolygonOffset(r,i),this.setStencil(r,i),this.currentState=r}},{key:"setBlend",value:function(r,i){var s=this.gl,f=this.getCurrentState();((i=i.force)||!bh(r.blend,f.blend))&&(r.blend?s.enable(s.BLEND):s.disable(s.BLEND)),!i&&bh(r.blendEquation,f.blendEquation)||s.blendEquation(r.blendEquation),(i||!bh(r.blendFunc,f.blendFunc))&&(r.blendFunc.length===2?s.blendFunc(r.blendFunc[0],r.blendFunc[1]):r.blendFunc.length===4&&s.blendFuncSeparate(r.blendFunc[0],r.blendFunc[1],r.blendFunc[2],r.blendFunc[3]))}},{key:"setDepth",value:function(r,i){var s=this.gl,f=this.getCurrentState();((i=i.force)||!bh(r.depthTest,f.depthTest))&&(r.depthTest?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST)),(i||!bh(r.depthMask,f.depthMask))&&(r.depthMask?s.depthMask(!0):s.depthMask(!1)),!i&&bh(r.depthFunc,f.depthFunc)||s.depthFunc(r.depthFunc)}},{key:"setPolygonOffset",value:function(r,i){var s=this.gl,f=this.getCurrentState();(i.force||!bh(r.polygonOffset,f.polygonOffset))&&(r.polygonOffset[0]!==0&&r.polygonOffset[1]!==0?s.enable(s.POLYGON_OFFSET_FILL):s.disable(s.POLYGON_OFFSET_FILL),s.polygonOffset(r.polygonOffset[0],r.polygonOffset[1]))}},{key:"setCullFace",value:function(r,i){var s=this.gl,f=this.getCurrentState();(i.force||!bh(r.cullFace,f.cullFace))&&(r.cullFace?(s.enable(s.CULL_FACE),s.cullFace(s.BACK)):s.disable(s.CULL_FACE))}},{key:"setStencil",value:function(r,i){var s=this.gl,f=this.getCurrentState();(i.force||!bh(r.stencilTest,f.stencilTest))&&(r.stencilTest?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST))}}]),t}(),zv=function(){function t(r){Ji(this,t),this.options=r,this.gl=r.gl,this.buffer=this.gl.createBuffer(),r.data&&this.updateData(r.data)}return Cn(t,[{key:"updateData",value:function(r){var i=this.options,s=this.gl;this.bind(),s.bufferData(s[i.target],r,s[i.usage])}},{key:"bind",value:function(r){r=r||this.gl,r.bindBuffer(r[this.options.target],this.buffer)}},{key:"unBind",value:function(r){r=r||this.gl,r.bindBuffer(r[this.options.target],null)}},{key:"destroy",value:function(){this.buffer=null}}]),t}(),UC={BYTE:1,UNSIGNED_BYTE:1,SHORT:2,UNSIGNED_SHORT:2,FLOAT:4},wy=function(){function t(r){for(Ji(this,t),this.options=r,this.attributes=r.attributes,this.gl=r.gl,this.program=r.program,r=this.stride=0;r<this.attributes.length;r++)this.stride+=UC[this.attributes[r].type]*this.attributes[r].size}return Cn(t,[{key:"setVertexAttribPointers",value:function(){for(var r=this.gl,i=this.program,s=0;s<this.attributes.length;s++){var f=this.attributes[s],c=i.attributes[f.name];c!==void 0&&(f.buffer.bind(r),r.vertexAttribPointer(c,f.size,r[f.type],f.normalize||!1,f.stride!==void 0?f.stride:this.stride,f.offset),r.enableVertexAttribArray(c))}}},{key:"bind",value:function(){this.setVertexAttribPointers()}},{key:"destroy",value:function(){}}]),t}(),Fs=function t(r,i,s){Ji(this,t),i=i||r.canvas.width,s=s||r.canvas.height;var f=r.createFramebuffer(),c=r.createTexture();r.bindTexture(r.TEXTURE_2D,c),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,i,s,0,r.RGBA,r.UNSIGNED_BYTE,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),f.texture=c;var g=r.createRenderbuffer();r.bindRenderbuffer(r.RENDERBUFFER,g),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,i,s),f.depthBuffer=g,r.bindFramebuffer(r.FRAMEBUFFER,f),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,c,0),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,g),i=r.checkFramebufferStatus(r.FRAMEBUFFER),r.FRAMEBUFFER_COMPLETE===i&&(r.bindFramebuffer(r.FRAMEBUFFER,null),r.bindTexture(r.TEXTURE_2D,null),r.bindRenderbuffer(r.RENDERBUFFER,null),this.framebuffer=f)},Eg=function(){function t(r){Ji(this,t),this.options={},ut(this.options,r),this.vertex=[-1,1,0,-1,-1,0,1,1,0,1,1,0,-1,-1,0,1,-1,0],this.sampleCoord=[0,1,0,0,1,1,1,1,0,0,1,0]}return Cn(t,[{key:"getOptions",value:function(){return this.options}},{key:"onResize",value:function(r){}},{key:"render",value:function(r){var i=r.gl;r=r.texture;var s=this.programSample;i.useProgram(s.program);var f=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,f);var c=[-1,-1,0,-1,1,0,1,1,0,1,1,0,-1,-1,0,1,-1,0];i.bufferData(i.ARRAY_BUFFER,new Float32Array(c),i.STATIC_DRAW),i.enableVertexAttribArray(s.attributes.aPos),i.vertexAttribPointer(s.attributes.aPos,3,i.FLOAT,!1,0,0),f=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,f),i.bufferData(i.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,1,1,1,0,0,1,0]),i.STATIC_DRAW),i.enableVertexAttribArray(s.attributes.aTextureCoord),i.vertexAttribPointer(s.attributes.aTextureCoord,2,i.FLOAT,!1,0,0),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,r),i.uniform1i(s.uniforms.uSampler,0),i.drawArrays(i.TRIANGLES,0,c.length/3)}}]),t}();(function(t){function r(i){return Ji(this,r),jn(this,(r.__proto__||Mo(r)).call(this,i))}return Co(r,t),Cn(r,[{key:"getProgram",value:function(i){return this.programSample||(this.programSample=new du(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(void){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision highp float;uniform sampler2D uSampler;uniform vec2 canvasSize;varying vec2 vTextureCoord;vec4 fxaa_2_0(sampler2D tex,vec2 fragCoord,vec2 resolution,vec2 v_rgbNW,vec2 v_rgbNE,vec2 v_rgbSW,vec2 v_rgbSE,vec2 v_rgbM){vec4 color;mediump vec2 inverseVP=vec2(1.0/resolution.x,1.0/resolution.y);vec3 rgbNW=texture2D(tex,v_rgbNW).xyz;vec3 rgbNE=texture2D(tex,v_rgbNE).xyz;vec3 rgbSW=texture2D(tex,v_rgbSW).xyz;vec3 rgbSE=texture2D(tex,v_rgbSE).xyz;vec4 texColor=texture2D(tex,v_rgbM);vec3 rgbM=texColor.xyz;vec3 luma=vec3(0.299,0.587,0.114);float lumaNW=dot(rgbNW,luma);float lumaNE=dot(rgbNE,luma);float lumaSW=dot(rgbSW,luma);float lumaSE=dot(rgbSE,luma);float lumaM=dot(rgbM,luma);float lumaMin=min(lumaM,min(min(lumaNW,lumaNE),min(lumaSW,lumaSE)));float lumaMax=max(lumaM,max(max(lumaNW,lumaNE),max(lumaSW,lumaSE)));mediump vec2 dir;dir.x=-((lumaNW+lumaNE)-(lumaSW+lumaSE));dir.y=((lumaNW+lumaSW)-(lumaNE+lumaSE));float dirReduce=max((lumaNW+lumaNE+lumaSW+lumaSE)*(0.25*1.0/8.0),1.0/128.0);float rcpDirMin=1.0/(min(abs(dir.x),abs(dir.y))+dirReduce);dir=min(vec2(8.0,8.0),max(vec2(-8.0,-8.0),dir*rcpDirMin))*inverseVP;vec3 rgbA=0.5*(texture2D(tex,fragCoord*inverseVP+dir*(1.0/3.0-0.5)).xyz+texture2D(tex,fragCoord*inverseVP+dir*(2.0/3.0-0.5)).xyz);vec3 rgbB=rgbA*0.5+0.25*(texture2D(tex,fragCoord*inverseVP+dir*-0.5).xyz+texture2D(tex,fragCoord*inverseVP+dir*0.5).xyz);float lumaB=dot(rgbB,luma);if((lumaB<lumaMin)||(lumaB>lumaMax)){color=vec4(rgbA,texColor.a);}else{color=vec4(rgbB,texColor.a);}return color;}void texcoords_3_1(vec2 fragCoord,vec2 resolution,out vec2 v_rgbNW,out vec2 v_rgbNE,out vec2 v_rgbSW,out vec2 v_rgbSE,out vec2 v_rgbM){vec2 inverseVP=1.0/resolution.xy;v_rgbNW=(fragCoord+vec2(-1.0,-1.0))*inverseVP;v_rgbNE=(fragCoord+vec2(1.0,-1.0))*inverseVP;v_rgbSW=(fragCoord+vec2(-1.0,1.0))*inverseVP;v_rgbSE=(fragCoord+vec2(1.0,1.0))*inverseVP;v_rgbM=vec2(fragCoord*inverseVP);}vec4 apply_1_2(sampler2D tex,vec2 fragCoord,vec2 resolution){mediump vec2 v_rgbNW;mediump vec2 v_rgbNE;mediump vec2 v_rgbSW;mediump vec2 v_rgbSE;mediump vec2 v_rgbM;texcoords_3_1(fragCoord,resolution,v_rgbNW,v_rgbNE,v_rgbSW,v_rgbSE,v_rgbM);return fxaa_2_0(tex,fragCoord,resolution,v_rgbNW,v_rgbNE,v_rgbSW,v_rgbSE,v_rgbM);}void main(void){vec2 fragCoord=vTextureCoord*canvasSize;gl_FragColor=apply_1_2(uSampler,fragCoord,canvasSize);}"})),this.programSample}},{key:"render",value:function(i){var s=i.gl;i=i.texture,this.getOptions(),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);var f=this.getProgram(s);s.useProgram(f.program);var c=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,c),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.vertex),s.STATIC_DRAW),s.enableVertexAttribArray(f.attributes.aPos),s.vertexAttribPointer(f.attributes.aPos,3,s.FLOAT,!1,0,0),c=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,c),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.sampleCoord),s.STATIC_DRAW),s.enableVertexAttribArray(f.attributes.aTextureCoord),s.vertexAttribPointer(f.attributes.aTextureCoord,2,s.FLOAT,!1,0,0),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,i),s.uniform1i(f.uniforms.uSampler,1),s.uniform2fv(f.uniforms.canvasSize,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.bindBuffer(s.ARRAY_BUFFER,null),s.useProgram(null)}}]),r})(Eg),function(t){function r(i){return Ji(this,r),jn(this,(r.__proto__||Mo(r)).call(this,i))}return Co(r,t),Cn(r,[{key:"getProgram",value:function(i){if(this.program1||(this.program1=new du(i,{vertexShader:"attribute vec3 position;attribute vec2 uv;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];void SMAAEdgeDetectionVS(vec2 texcoord){vOffset[0]=texcoord.xyxy+resolution.xyxy*vec4(-1.0,0.0,0.0,1.0);vOffset[1]=texcoord.xyxy+resolution.xyxy*vec4(1.0,0.0,0.0,-1.0);vOffset[2]=texcoord.xyxy+resolution.xyxy*vec4(-2.0,0.0,0.0,2.0);}void main(){vUv=uv;SMAAEdgeDetectionVS(vUv);gl_Position=vec4(position,1.0);}",fragmentShader:`precision highp float;
#define SMAA_THRESHOLD 0.1
uniform sampler2D tDiffuse;varying vec2 vUv;varying vec4 vOffset[3];vec4 SMAAColorEdgeDetectionPS(vec2 texcoord,vec4 offset[3],sampler2D colorTex){vec2 threshold=vec2(SMAA_THRESHOLD,SMAA_THRESHOLD);vec4 delta;vec3 C=texture2D(colorTex,texcoord).rgb;vec3 Cleft=texture2D(colorTex,offset[0].xy).rgb;vec3 t=abs(C-Cleft);delta.x=max(max(t.r,t.g),t.b);vec3 Ctop=texture2D(colorTex,offset[0].zw).rgb;t=abs(C-Ctop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0,1.0))==0.0)discard;vec3 Cright=texture2D(colorTex,offset[1].xy).rgb;t=abs(C-Cright);delta.z=max(max(t.r,t.g),t.b);vec3 Cbottom=texture2D(colorTex,offset[1].zw).rgb;t=abs(C-Cbottom);delta.w=max(max(t.r,t.g),t.b);float maxDelta=max(max(max(delta.x,delta.y),delta.z),delta.w);vec3 Cleftleft=texture2D(colorTex,offset[2].xy).rgb;t=abs(C-Cleftleft);delta.z=max(max(t.r,t.g),t.b);vec3 Ctoptop=texture2D(colorTex,offset[2].zw).rgb;t=abs(C-Ctoptop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(max(maxDelta,delta.z),delta.w);edges.xy*=step(0.5*maxDelta,delta.xy);return vec4(edges,0.0,0.0);}void main(){gl_FragColor=SMAAColorEdgeDetectionPS(vUv,vOffset,tDiffuse);}`})),this.program2||(this.program2=new du(i,{vertexShader:`precision highp float;
#define SMAA_MAX_SEARCH_STEPS 8
#define SMAA_AREATEX_MAX_DISTANCE 16
#define SMAA_AREATEX_PIXEL_SIZE ( 1.0 / vec2( 160.0, 560.0 ) )
#define SMAA_AREATEX_SUBTEX_SIZE ( 1.0 / 7.0 )
attribute vec3 position;attribute vec2 uv;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixcoord;void SMAABlendingWeightCalculationVS(vec2 texcoord){vPixcoord=texcoord/resolution;vOffset[0]=texcoord.xyxy+resolution.xyxy*vec4(-0.25,0.125,1.25,0.125);vOffset[1]=texcoord.xyxy+resolution.xyxy*vec4(-0.125,0.25,-0.125,-1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*resolution.xxyy*float(SMAA_MAX_SEARCH_STEPS);}void main(){vUv=uv;SMAABlendingWeightCalculationVS(vUv);gl_Position=vec4(position,1.0);}`,fragmentShader:`precision highp float;
#define SMAA_MAX_SEARCH_STEPS 8
#define SMAA_AREATEX_MAX_DISTANCE 16
#define SMAA_AREATEX_PIXEL_SIZE ( 1.0 / vec2( 160.0, 560.0 ) )
#define SMAA_AREATEX_SUBTEX_SIZE ( 1.0 / 7.0 )
#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )
uniform sampler2D tDiffuse;uniform sampler2D tArea;uniform sampler2D tSearch;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixcoord;vec2 round(vec2 x){return sign(x)*floor(abs(x)+0.5);}float SMAASearchLength(sampler2D searchTex,vec2 e,float bias,float scale){e.r=bias+e.r*scale;return 255.0*texture2D(searchTex,e,0.0).r;}float SMAASearchXLeft(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){/***@PSEUDO_GATHER4*This texcoord has been offset by(-0.25,-0.125)in the vertex shader to*sample between edge,thus fetching four edges in a row.*Sampling with different offsets in each direction allows to disambiguate*which edges are active from the four fetched ones.*/vec2 e=vec2(0.0,1.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord-=vec2(2.0,0.0)*resolution;if(!(texcoord.x>end&&e.g>0.8281&&e.r==0.0))break;}texcoord.x+=0.25*resolution.x;texcoord.x+=resolution.x;texcoord.x+=2.0*resolution.x;texcoord.x-=resolution.x*SMAASearchLength(searchTex,e,0.0,0.5);return texcoord.x;}float SMAASearchXRight(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord+=vec2(2.0,0.0)*resolution;if(!(texcoord.x<end&&e.g>0.8281&&e.r==0.0))break;}texcoord.x-=0.25*resolution.x;texcoord.x-=resolution.x;texcoord.x-=2.0*resolution.x;texcoord.x+=resolution.x*SMAASearchLength(searchTex,e,0.5,0.5);return texcoord.x;}float SMAASearchYUp(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord+=vec2(0.0,2.0)*resolution;if(!(texcoord.y>end&&e.r>0.8281&&e.g==0.0))break;}texcoord.y-=0.25*resolution.y;texcoord.y-=resolution.y;texcoord.y-=2.0*resolution.y;texcoord.y+=resolution.y*SMAASearchLength(searchTex,e.gr,0.0,0.5);return texcoord.y;}float SMAASearchYDown(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord-=vec2(0.0,2.0)*resolution;if(!(texcoord.y<end&&e.r>0.8281&&e.g==0.0))break;}texcoord.y+=0.25*resolution.y;texcoord.y+=resolution.y;texcoord.y+=2.0*resolution.y;texcoord.y-=resolution.y*SMAASearchLength(searchTex,e.gr,0.5,0.5);return texcoord.y;}vec2 SMAAArea(sampler2D areaTex,vec2 dist,float e1,float e2,float offset){vec2 texcoord=float(SMAA_AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texcoord=SMAA_AREATEX_PIXEL_SIZE*texcoord+(0.5*SMAA_AREATEX_PIXEL_SIZE);texcoord.y+=SMAA_AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTex,texcoord,0.0).rg;}vec4 SMAABlendingWeightCalculationPS(vec2 texcoord,vec2 pixcoord,vec4 offset[3],sampler2D edgesTex,sampler2D areaTex,sampler2D searchTex,ivec4 subsampleIndices){vec4 weights=vec4(0.0,0.0,0.0,0.0);vec2 e=texture2D(edgesTex,texcoord).rg;if(e.g>0.0){vec2 d;vec2 coords;coords.x=SMAASearchXLeft(edgesTex,searchTex,offset[0].xy,offset[2].x);coords.y=offset[1].y;d.x=coords.x;float e1=texture2D(edgesTex,coords,0.0).r;coords.x=SMAASearchXRight(edgesTex,searchTex,offset[0].zw,offset[2].y);d.y=coords.x;d=d/resolution.x-pixcoord.x;vec2 sqrt_d=sqrt(abs(d));coords.y-=1.0*resolution.y;float e2=SMAASampleLevelZeroOffset(edgesTex,coords,ivec2(1,0)).r;weights.rg=SMAAArea(areaTex,sqrt_d,e1,e2,float(subsampleIndices.y));}if(e.r>0.0){vec2 d;vec2 coords;coords.y=SMAASearchYUp(edgesTex,searchTex,offset[1].xy,offset[2].z);coords.x=offset[0].x;d.x=coords.y;float e1=texture2D(edgesTex,coords,0.0).g;coords.y=SMAASearchYDown(edgesTex,searchTex,offset[1].zw,offset[2].w);d.y=coords.y;d=d/resolution.y-pixcoord.y;vec2 sqrt_d=sqrt(abs(d));coords.y-=1.0*resolution.y;float e2=SMAASampleLevelZeroOffset(edgesTex,coords,ivec2(0,1)).g;weights.ba=SMAAArea(areaTex,sqrt_d,e1,e2,float(subsampleIndices.x));}return weights;}void main(){gl_FragColor=SMAABlendingWeightCalculationPS(vUv,vPixcoord,vOffset,tDiffuse,tArea,tSearch,ivec4(0.0));}`})),this.program3||(this.program3=new du(i,{vertexShader:"precision highp float;uniform vec2 resolution;attribute vec3 position;attribute vec2 uv;varying vec2 vUv;varying vec4 vOffset[2];void SMAANeighborhoodBlendingVS(vec2 texcoord){vOffset[0]=texcoord.xyxy+resolution.xyxy*vec4(-1.0,0.0,0.0,1.0);vOffset[1]=texcoord.xyxy+resolution.xyxy*vec4(1.0,0.0,0.0,-1.0);}void main(){vUv=uv;SMAANeighborhoodBlendingVS(vUv);gl_Position=vec4(position,1.0);}",fragmentShader:"precision highp float;uniform sampler2D tDiffuse;uniform sampler2D tColor;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[2];vec4 SMAANeighborhoodBlendingPS(vec2 texcoord,vec4 offset[2],sampler2D colorTex,sampler2D blendTex){vec4 a;a.xz=texture2D(blendTex,texcoord).xz;a.y=texture2D(blendTex,offset[1].zw).g;a.w=texture2D(blendTex,offset[1].xy).a;if(dot(a,vec4(1.0,1.0,1.0,1.0))<1e-5){return texture2D(colorTex,texcoord,0.0);}else{vec2 offset;offset.x=a.a>a.b ? a.a :-a.b;offset.y=a.g>a.r ?-a.g : a.r;if(abs(offset.x)>abs(offset.y)){offset.y=0.0;}else{offset.x=0.0;}vec4 C=texture2D(colorTex,texcoord,0.0);texcoord+=sign(offset)*resolution;vec4 Cop=texture2D(colorTex,texcoord,0.0);float s=abs(offset.x)>abs(offset.y)? abs(offset.x): abs(offset.y);C.xyz=pow(C.xyz,vec3(2.2));Cop.xyz=pow(Cop.xyz,vec3(2.2));vec4 mixed=mix(C,Cop,s);mixed.xyz=pow(mixed.xyz,vec3(1.0/2.2));return mixed;}}void main(){gl_FragColor=SMAANeighborhoodBlendingPS(vUv,vOffset,tColor,tDiffuse);}"})),!this.vertexBuffer||!this.sampleBuffer){this.vertexBuffer=new zv({gl:i,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.sampleBuffer=new zv({gl:i,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexBuffer.updateData(new Float32Array(this.vertex)),this.sampleBuffer.updateData(new Float32Array(this.sampleCoord));var s=[{stride:12,name:"position",buffer:this.vertexBuffer,size:3,type:"FLOAT",offset:0},{stride:8,name:"uv",buffer:this.sampleBuffer,size:2,type:"FLOAT",offset:0}];this.vertexArray1=new wy({gl:i,program:this.program1,attributes:s}),this.vertexArray2=new wy({gl:i,program:this.program2,attributes:s}),this.vertexArray3=new wy({gl:i,program:this.program3,attributes:s})}return{program1:this.program1,program2:this.program2,program3:this.program3}}},{key:"onResize",value:function(i){this.collectBrightBuffer=new Fs(i),this.bloomBuffer=new Fs(i)}},{key:"getExtraFbo",value:function(i){return this.collectBrightBuffer||(this.collectBrightBuffer=new Fs(i)),this.bloomBuffer||(this.bloomBuffer=new Fs(i)),{collectBrightBuffer:this.collectBrightBuffer.framebuffer,bloomBuffer:this.bloomBuffer.framebuffer}}},{key:"render",value:function(i){var s=i.gl,f=i.texture;i=i.fbo,this.getOptions(),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);var c=this.getProgram(s),g=c.program1,p=c.program2;c=c.program3;var A=this.getExtraFbo(s),S=A.collectBrightBuffer;A=A.bloomBuffer;var N=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,N),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.vertex),s.STATIC_DRAW),s.enableVertexAttribArray(g.attributes.position),s.vertexAttribPointer(g.attributes.position,3,s.FLOAT,!1,0,0),s.enableVertexAttribArray(p.attributes.position),s.vertexAttribPointer(p.attributes.position,3,s.FLOAT,!1,0,0),s.enableVertexAttribArray(c.attributes.position),s.vertexAttribPointer(c.attributes.position,3,s.FLOAT,!1,0,0),N=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,N),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.sampleCoord),s.STATIC_DRAW),s.enableVertexAttribArray(g.attributes.uv),s.vertexAttribPointer(g.attributes.uv,2,s.FLOAT,!1,0,0),s.enableVertexAttribArray(p.attributes.uv),s.vertexAttribPointer(p.attributes.uv,2,s.FLOAT,!1,0,0),s.enableVertexAttribArray(c.attributes.uv),s.vertexAttribPointer(c.attributes.uv,2,s.FLOAT,!1,0,0),s.useProgram(g.program),s.bindFramebuffer(s.FRAMEBUFFER,S),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE2),s.bindTexture(s.TEXTURE_2D,f),s.uniform1i(g.uniforms.tDiffuse,2),s.uniform2fv(g.uniforms.resolution,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.useProgram(p.program),s.bindFramebuffer(s.FRAMEBUFFER,A),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE2),s.bindTexture(s.TEXTURE_2D,S.texture),s.uniform1i(p.uniforms.uSampler,2),s.uniform2fv(p.uniforms.resolution,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.useProgram(c.program),s.bindFramebuffer(s.FRAMEBUFFER,i),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE2),s.bindTexture(s.TEXTURE_2D,f),s.uniform1i(c.uniforms.tDiffuse,2),s.activeTexture(s.TEXTURE3),s.bindTexture(s.TEXTURE_2D,A.texture),s.uniform1i(c.uniforms.tColor,3),s.uniform2fv(c.uniforms.resolution,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.bindBuffer(s.ARRAY_BUFFER,null),s.useProgram(null)}},{key:"getAreaTexture",value:function(){return"data:image/png;base64,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"}},{key:"getSearchTexture",value:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAIAAADiVupLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAFZJREFUeNrs00EKgAAIRNEZ739mTQoiwmhRi4L/FiKiu9ERISkzbXdTVV3H4WhfOG6ehl1rNR7qDSF8hwkVcJXt+3A//I0Nv0GoCBUAAAAAAMA/LAIMAB+Dcg2OE2zsAAAAAElFTkSuQmCC"}}]),r}(Eg),function(t){function r(i){return Ji(this,r),jn(this,(r.__proto__||Mo(r)).call(this,i))}return Co(r,t),Cn(r,[{key:"getProgram",value:function(i){return this.programSample||(this.programSample=new du(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;varying vec2 vTextureCoord;void main(){float fStep=1.0/512.0;vec4 sample11=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample12=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t+1.0*fStep));vec4 sample13=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample21=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t));vec4 sample22=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t));vec4 sample23=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t));vec4 sample31=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 sample32=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t-1.0*fStep));vec4 sample33=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 blurSample=(sample11+sample12+sample13+sample21+2.0*sample22+sample23+sample31+sample32+sample33)/10.0;gl_FragColor=blurSample;}"}),this.vertexBuffer=new zv({gl:i,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.sampleBuffer=new zv({gl:i,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexBuffer.updateData(new Float32Array(this.vertex)),this.sampleBuffer.updateData(new Float32Array(this.sampleCoord)),this.vertexArray=new wy({gl:i,program:this.programSample,attributes:[{stride:12,name:"aPos",buffer:this.vertexBuffer,size:3,type:"FLOAT",offset:0},{stride:8,name:"aTextureCoord",buffer:this.sampleBuffer,size:2,type:"FLOAT",offset:0}]})),this.programSample}},{key:"render",value:function(i){var s=i.gl;i=i.texture,s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);var f=this.getProgram(s);f.use(s),this.vertexArray.bind(),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,i),s.uniform1i(f.uniforms.uSampler,1),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3)}}]),r}(Eg),function(t){function r(i){return Ji(this,r),jn(this,(r.__proto__||Mo(r)).call(this,i))}return Co(r,t),Cn(r,[{key:"getProgram",value:function(i){return this.programBright||(this.programBright=new du(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform float threshold;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(uSampler,vTextureCoord);vec4 lightColor=max(vec4(0.0),(color-(1.0-threshold)/5.0));float brightness=dot(color.rgb,vec3(0.2126,0.7152,0.0722));if(brightness>threshold){color=lightColor;}else{color=vec4(0.0);}gl_FragColor=color;}"})),this.programBloom||(this.programBloom=new du(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform bool isVertical;uniform vec2 canvasSize;uniform float blurSize;uniform float devicePixelRatio;varying vec2 vTextureCoord;void main(){float weight[10];weight[0]=0.2270270270;weight[1]=0.1945945946;weight[2]=0.1216216216;weight[3]=0.1135135135;weight[4]=0.0972972973;weight[5]=0.0608108108;weight[6]=0.0540540541;weight[7]=0.0270270270;weight[8]=0.0162162162;weight[9]=0.0081081081;vec2 offset=vec2(blurSize/canvasSize.x,blurSize/canvasSize.y)*devicePixelRatio;vec4 result=texture2D(uSampler,vTextureCoord)*weight[0];if(isVertical){for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(0.0,offset.y*float(i)))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(0.0,offset.y*float(i)))*weight[i];}}else{for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(offset.x*float(i),0.0))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(offset.x*float(i),0.0))*weight[i];}}gl_FragColor=result;}"})),this.programResult||(this.programResult=new du(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D originalTexture;uniform sampler2D bloomTexture;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(originalTexture,vTextureCoord);vec4 bloomColor=texture2D(bloomTexture,vTextureCoord);color+=bloomColor;gl_FragColor=color;}"})),{programBright:this.programBright,programBloom:this.programBloom,programResult:this.programResult}}},{key:"onResize",value:function(i){this.collectBrightBuffer=new Fs(i),this.bloomBuffer=new Fs(i)}},{key:"getExtraFbo",value:function(i){return this.collectBrightBuffer||(this.collectBrightBuffer=new Fs(i)),this.bloomBuffer||(this.bloomBuffer=new Fs(i)),{collectBrightBuffer:this.collectBrightBuffer.framebuffer,bloomBuffer:this.bloomBuffer.framebuffer}}},{key:"render",value:function(i){var s=i.gl,f=i.texture;i=i.fbo;var c=this.getOptions();s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);var g=this.getProgram(s),p=g.programBright,A=g.programBloom;g=g.programResult;var S=this.getExtraFbo(s),N=S.collectBrightBuffer;S=S.bloomBuffer;var _=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,_),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.vertex),s.STATIC_DRAW),s.enableVertexAttribArray(p.attributes.aPos),s.vertexAttribPointer(p.attributes.aPos,3,s.FLOAT,!1,0,0),s.enableVertexAttribArray(A.attributes.aPos),s.vertexAttribPointer(A.attributes.aPos,3,s.FLOAT,!1,0,0),s.enableVertexAttribArray(g.attributes.aPos),s.vertexAttribPointer(g.attributes.aPos,3,s.FLOAT,!1,0,0),_=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,_),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.sampleCoord),s.STATIC_DRAW),s.enableVertexAttribArray(p.attributes.aTextureCoord),s.vertexAttribPointer(p.attributes.aTextureCoord,2,s.FLOAT,!1,0,0),s.enableVertexAttribArray(A.attributes.aTextureCoord),s.vertexAttribPointer(A.attributes.aTextureCoord,2,s.FLOAT,!1,0,0),s.enableVertexAttribArray(g.attributes.aTextureCoord),s.vertexAttribPointer(g.attributes.aTextureCoord,2,s.FLOAT,!1,0,0),s.useProgram(p.program),s.bindFramebuffer(s.FRAMEBUFFER,N),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,f),s.uniform1i(p.uniforms.uSampler,1),s.uniform1f(p.uniforms.threshold,c.threshold||0),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.useProgram(A.program),s.bindFramebuffer(s.FRAMEBUFFER,S),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,N.texture),s.uniform1i(A.uniforms.uSampler,1),s.uniform1i(A.uniforms.isVertical,!0),s.uniform1f(A.uniforms.blurSize,c.blurSize||2),s.uniform1f(A.uniforms.devicePixelRatio,window.devicePixelRatio),s.uniform2fv(A.uniforms.canvasSize,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.useProgram(A.program),s.bindFramebuffer(s.FRAMEBUFFER,N),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,S.texture),s.uniform1i(A.uniforms.uSampler,1),s.uniform1i(A.uniforms.isVertical,!1),s.uniform1f(A.uniforms.blurSize,c.blurSize||2),s.uniform1f(A.uniforms.devicePixelRatio,window.devicePixelRatio),s.uniform2fv(A.uniforms.canvasSize,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.useProgram(g.program),s.bindFramebuffer(s.FRAMEBUFFER,i),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,f),s.uniform1i(g.uniforms.originalTexture,1),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,N.texture),s.uniform1i(g.uniforms.bloomTexture,0),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.bindBuffer(s.ARRAY_BUFFER,null),s.useProgram(null)}}]),r}(Eg),function(t){function r(i){return Ji(this,r),jn(this,(r.__proto__||Mo(r)).call(this,i))}return Co(r,t),Cn(r,[{key:"getProgram",value:function(i){return this.programBright||(this.programBright=new du(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform float threshold;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(uSampler,vTextureCoord);vec4 lightColor=max(vec4(0.0),(color-threshold));gl_FragColor=lightColor;}"})),this.programBloom||(this.programBloom=new du(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform bool isVertical;uniform vec2 canvasSize;uniform float blurSize;uniform float devicePixelRatio;varying vec2 vTextureCoord;void main(){float weight[10];weight[0]=0.2270270270;weight[1]=0.1945945946;weight[2]=0.1216216216;weight[3]=0.1135135135;weight[4]=0.0972972973;weight[5]=0.0608108108;weight[6]=0.0540540541;weight[7]=0.0270270270;weight[8]=0.0162162162;weight[9]=0.0081081081;vec2 offset=vec2(blurSize/canvasSize.x,blurSize/canvasSize.y)*devicePixelRatio;vec4 result=texture2D(uSampler,vTextureCoord)*weight[0];if(isVertical){for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(0.0,offset.y*float(i)))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(0.0,offset.y*float(i)))*weight[i];}}else{for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(offset.x*float(i),0.0))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(offset.x*float(i),0.0))*weight[i];}}gl_FragColor=result;}"})),this.programResult||(this.programResult=new du(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D originalTexture;uniform sampler2D bloomTexture;uniform float toneScale;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(originalTexture,vTextureCoord)*toneScale;vec4 bloomColor=texture2D(bloomTexture,vTextureCoord);color+=bloomColor;gl_FragColor=color;}"})),{programBright:this.programBright,programBloom:this.programBloom,programResult:this.programResult}}},{key:"onResize",value:function(i){this.collectBrightBuffer=new Fs(i),this.bloomBuffer=new Fs(i)}},{key:"getExtraFbo",value:function(i){return this.collectBrightBuffer||(this.collectBrightBuffer=new Fs(i)),this.bloomBuffer||(this.bloomBuffer=new Fs(i)),{collectBrightBuffer:this.collectBrightBuffer.framebuffer,bloomBuffer:this.bloomBuffer.framebuffer}}},{key:"render",value:function(i){var s=i.gl,f=i.texture;i=i.fbo;var c=this.getOptions(),g="clarity"in c?c.clarity:1;g=Math.max(0,g),g=Math.min(1,g),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);var p=this.getProgram(s),A=p.programBright,S=p.programBloom;p=p.programResult;var N=this.getExtraFbo(s),_=N.collectBrightBuffer;N=N.bloomBuffer;var I=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,I),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.vertex),s.STATIC_DRAW),s.enableVertexAttribArray(A.attributes.aPos),s.vertexAttribPointer(A.attributes.aPos,3,s.FLOAT,!1,0,0),s.enableVertexAttribArray(S.attributes.aPos),s.vertexAttribPointer(S.attributes.aPos,3,s.FLOAT,!1,0,0),s.enableVertexAttribArray(p.attributes.aPos),s.vertexAttribPointer(p.attributes.aPos,3,s.FLOAT,!1,0,0),I=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,I),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.sampleCoord),s.STATIC_DRAW),s.enableVertexAttribArray(A.attributes.aTextureCoord),s.vertexAttribPointer(A.attributes.aTextureCoord,2,s.FLOAT,!1,0,0),s.enableVertexAttribArray(S.attributes.aTextureCoord),s.vertexAttribPointer(S.attributes.aTextureCoord,2,s.FLOAT,!1,0,0),s.enableVertexAttribArray(p.attributes.aTextureCoord),s.vertexAttribPointer(p.attributes.aTextureCoord,2,s.FLOAT,!1,0,0),s.useProgram(A.program),s.bindFramebuffer(s.FRAMEBUFFER,_),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,f),s.uniform1i(A.uniforms.uSampler,1),s.uniform1f(A.uniforms.threshold,c.threshold||0),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.useProgram(S.program),s.bindFramebuffer(s.FRAMEBUFFER,N),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,_.texture),s.uniform1i(S.uniforms.uSampler,1),s.uniform1i(S.uniforms.isVertical,!0),s.uniform1f(S.uniforms.blurSize,c.blurSize||2),s.uniform1f(S.uniforms.devicePixelRatio,window.devicePixelRatio),s.uniform2fv(S.uniforms.canvasSize,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.useProgram(S.program),s.bindFramebuffer(s.FRAMEBUFFER,_),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,N.texture),s.uniform1i(S.uniforms.uSampler,1),s.uniform1i(S.uniforms.isVertical,!1),s.uniform1f(S.uniforms.blurSize,c.blurSize||2),s.uniform1f(S.uniforms.devicePixelRatio,window.devicePixelRatio),s.uniform2fv(S.uniforms.canvasSize,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.useProgram(p.program),s.bindFramebuffer(s.FRAMEBUFFER,i),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,f),s.uniform1i(p.uniforms.originalTexture,1),s.uniform1f(p.uniforms.toneScale,g),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,_.texture),s.uniform1i(p.uniforms.bloomTexture,0),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.bindBuffer(s.ARRAY_BUFFER,null),s.useProgram(null)}}]),r}(Eg),function(t){function r(i){return Ji(this,r),jn(this,(r.__proto__||Mo(r)).call(this,i))}return Co(r,t),Cn(r,[{key:"getProgram",value:function(i){return this.programSample||(this.programSample=new du(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform vec2 canvasSize;varying vec2 vTextureCoord;void main(){float fStep=1.0/312.0;vec4 sample11=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample12=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t+1.0*fStep));vec4 sample13=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample21=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t));vec4 sample22=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t));vec4 sample23=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t));vec4 sample31=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 sample32=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t-1.0*fStep));vec4 sample33=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 blurSample=(sample11+sample12+sample13+sample21+2.0*sample22+sample23+sample31+sample32+sample33)/10.0;float desX=abs((gl_FragCoord.x-canvasSize.x/2.0)/(canvasSize.x/2.0));float desY=abs((gl_FragCoord.y-canvasSize.y/2.0)/(canvasSize.y/2.0));float factor=max(desX,desY);gl_FragColor=(sample22*(1.0-factor)+blurSample*factor);}"})),this.programSample}},{key:"render",value:function(i){var s=i.gl;i=i.texture;var f=this.getProgram(s);s.useProgram(f.program);var c=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,c),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.vertex),s.STATIC_DRAW),s.enableVertexAttribArray(f.attributes.aPos),s.vertexAttribPointer(f.attributes.aPos,3,s.FLOAT,!1,0,0),c=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,c),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.sampleCoord),s.STATIC_DRAW),s.enableVertexAttribArray(f.attributes.aTextureCoord),s.vertexAttribPointer(f.attributes.aTextureCoord,2,s.FLOAT,!1,0,0),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,i),s.uniform1i(f.uniforms.uSampler,1),s.uniform2fv(f.uniforms.canvasSize,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3)}}]),r}(Eg);var HC=function(){function t(r){Ji(this,t),this.gl=r,this.effects=[],this.initFbo()}return Cn(t,[{key:"addEffect",value:function(r){this.effects.push(r)}},{key:"removeEffect",value:function(r){}},{key:"setEffects",value:function(r){this.effects=r}},{key:"onResize",value:function(){this.initFbo();var r=this.gl,i=this.effects;if(i&&1<i.length)for(var s=1;s<i.length;s++){var f=i[s];f.onResize&&f.onResize(r)}}},{key:"initFbo",value:function(){var r=this.gl;r&&(this.fbo=[new Fs(r),new Fs(r)])}},{key:"destroy",value:function(){this.effects=[],this.fbo=[],this.gl=null}},{key:"render",value:function(){var r=this.gl,i=this.effects;if(i&&0<i.length)for(var s={},f=0;f<i.length;f++){var c=this.fbo[f%2].framebuffer;f===i.length-1&&(c=null),r.bindFramebuffer(r.FRAMEBUFFER,c);var g=[0,0,0,0];r.clearColor(g[0],g[1],g[2],g[3]),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),i[f].render({isPickRender:!1,gl:r,texture:s.texture,fbo:c}),s=c}}}]),t}(),Uv=function(){function t(r,i){Ji(this,t),this.map=r,this.options=i||{},this.eventMap={}}return Cn(t,[{key:"onResize",value:function(r){}},{key:"onUpdate",value:function(r){throw"\u672A\u5B9E\u73B0onUpdate\u65B9\u6CD5"}},{key:"getContainer",value:function(){throw"\u672A\u5B9E\u73B0getContainer\u65B9\u6CD5"}},{key:"getSize",value:function(){throw"\u672A\u5B9E\u73B0getSize\u65B9\u6CD5"}},{key:"getTilt",value:function(){throw"\u672A\u5B9E\u73B0getTilt\u65B9\u6CD5"}},{key:"getHeading",value:function(){throw"\u672A\u5B9E\u73B0getHeading\u65B9\u6CD5"}},{key:"getZoomUnits",value:function(){throw"\u672A\u5B9E\u73B0getZoomUnits\u65B9\u6CD5"}},{key:"getCenter",value:function(){throw"\u672A\u5B9E\u73B0getCenter\u65B9\u6CD5"}},{key:"getMapType",value:function(){throw"\u672A\u5B9E\u73B0getMapType\u65B9\u6CD5"}},{key:"lnglatToMercator",value:function(r,i){return this.options.coordinateSystem==="gcj02"?(i=i*Math.PI/180,i=31890685e-1*Math.log((1+Math.sin(i))/(1-Math.sin(i))),[parseFloat((r*Math.PI/180*6378137).toFixed(2)),parseFloat(i.toFixed(2))]):(r=Pu.convertLL2MC({lng:r,lat:i}),[r.lng,r.lat])}}]),t}(),kC=function(t){function r(i){Ji(this,r);var s=jn(this,(r.__proto__||Mo(r)).call(this,i));return i._printLog&&i._printLog("mapvgl"),s.eventMap={},s}return Co(r,t),Cn(r,[{key:"onResize",value:function(i){this.map.addEventListener("resize",i),this.eventMap.resize=i}},{key:"onMousemove",value:function(i){i=this.extendCallback(i),this.map.addEventListener("mousemove",i),this.eventMap.mousemove=i}},{key:"onClick",value:function(i){i=this.extendCallback(i),this.map.addEventListener("click",i),this.eventMap.click=i}},{key:"onDblClick",value:function(i){i=this.extendCallback(i),this.map.addEventListener("dblclick",i),this.eventMap.dblclick=i}},{key:"onRightClick",value:function(i){i=this.extendCallback(i),this.map.addEventListener("rightclick",i),this.eventMap.rightclick=i}},{key:"onUpdate",value:function(i){this.map.addEventListener("update",i),this.map.addEventListener("onearthstatuschange",i),this.eventMap.update=i,this.eventMap.onearthstatuschange=i}},{key:"extendCallback",value:function(i){return function(s){i(ut(s,{x:s.x,y:s.y}))}}},{key:"unbind",value:function(i){var s=this;this.eventMap[i]?(this.map.removeEventListener(i,this.eventMap[i]),delete this.eventMap[i]):(qi(this.eventMap).forEach(function(f){s.map.removeEventListener(f,s.eventMap[f])}),this.eventMap={})}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getSize",value:function(){return this.map.getSize()}},{key:"getBounds",value:function(){return this.map.getBounds()}},{key:"getTilt",value:function(){return this.map.getTilt()}},{key:"getHeading",value:function(){return this.map.getHeading()}},{key:"getZoomUnits",value:function(){return this.map.getZoomUnits()}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"getCenter",value:function(){var i=this.map.getCenter();return-180<=i.lng&&180>=i.lng&&(i=this.map.lnglatToMercator(i.lng,i.lat),i={lng:i[0],lat:i[1]}),i}},{key:"getMapType",value:function(){return this.map.getMapType()}},{key:"lnglatToMercator",value:function(i,s){return this.map.lnglatToMercator(i,s)}},{key:"mercatorToLnglat",value:function(i,s){return this.map.mercatorToLnglat(i,s)}},{key:"pixelToPointIn",value:function(i){return i=this.map.pixelToPointIn(i),this.mercatorToLnglat(i.lng,i.lat)}}]),r}(Uv),GC=function(t){function r(i){return Ji(this,r),i=jn(this,(r.__proto__||Mo(r)).call(this,i)),i.div=document.createElement("div"),i.div.style.position="absolute",i.div.style.userSelect="none",i.map.getPanes().mapPane.appendChild(i.div),i.eventMap={},i}return Co(r,t),Cn(r,[{key:"onResize",value:function(i){this.map.addEventListener("resize",i),this.eventMap.resize=i}},{key:"onMousemove",value:function(i){i=this.extendCallback(i),this.map.addEventListener("mousemove",i),this.eventMap.mousemove=i}},{key:"onClick",value:function(i){i=this.extendCallback(i),PC?(this.map.addEventListener("touchend",i),this.eventMap.touchend=i):(this.map.addEventListener("click",i),this.eventMap.click=i)}},{key:"onDblClick",value:function(i){i=this.extendCallback(i),this.map.addEventListener("dblclick",i),this.eventMap.dblclick=i}},{key:"onRightClick",value:function(i){i=this.extendCallback(i),this.map.addEventListener("rightclick",i),this.eventMap.rightclick=i}},{key:"changeCanvas",value:function(){var i=this.map,s=i.getSize(),f=i.getCenter();i=i.pointToOverlayPixel(f),this.div.style.left=i.x-s.width/2+"px",this.div.style.top=i.y-s.height/2+"px"}},{key:"onUpdate",value:function(i){var s=this,f=function(){s.changeCanvas(),i()};this.map.addEventListener("moveend",f),this.map.addEventListener("moving",f),this.map.addEventListener("zoomend",f),this.eventMap.moveend=f,this.eventMap.moving=f,this.eventMap.zoomend=f}},{key:"extendCallback",value:function(i){return function(s){i(ut(s,{x:s.pixel.x,y:s.pixel.y}))}}},{key:"unbind",value:function(){var i=this;qi(this.eventMap).forEach(function(s){i.map.removeEventListener(s,i.eventMap[s])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.div}},{key:"getSize",value:function(){return this.map.getSize()}},{key:"getBounds",value:function(){return this.map.getBounds()}},{key:"getTilt",value:function(){return 0}},{key:"getHeading",value:function(){return 0}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"getZoomUnits",value:function(){var i=this.getZoom();return this.map.getMapType().getZoomUnits?this.map.getMapType().getZoomUnits(i):Math.pow(2,18-i)}},{key:"getCenter",value:function(){var i=this.map.getMapType().getProjection().lngLatToPoint(this.map.getCenter());return{lng:i.x,lat:i.y}}},{key:"lnglatToMercator",value:function(i,s){return i=this.map.getMapType().getProjection().lngLatToPoint({lng:i,lat:s}),[i.x,i.y]}},{key:"mercatorToLnglat",value:function(i,s){return i=this.map.getMapType().getProjection().pointToLngLat({lng:i,lat:s}),[i.lng,i.lat]}}]),r}(Uv),bC=function(t){function r(i){return Ji(this,r),i=jn(this,(r.__proto__||Mo(r)).call(this,i)),i.eventMap={},i}return Co(r,t),Cn(r,[{key:"onResize",value:function(i){window.addEventListener("resize",i),this.eventMap.resize=i}},{key:"onUpdate",value:function(i){}},{key:"unbind",value:function(){var i=this;qi(this.eventMap).forEach(function(s){window.removeEventListener(s,i.eventMap[s])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.map.container.getElementsByClassName("cesium-widget")[0]}},{key:"getSize",value:function(){var i=this.map;return{width:i.canvas.clientWidth,height:i.canvas.clientHeight}}},{key:"getTilt",value:function(){return 180*this.map.camera.pitch/Math.PI+90}},{key:"getHeading",value:function(){return 360-180*this.map.camera.heading/Math.PI}},{key:"getZoomUnits",value:function(){var i=this.map;return 6.8*i.scene.globe.ellipsoid.cartesianToCartographic(i.camera.position).height/6500}},{key:"getZoom",value:function(){return 10}},{key:"getCenter",value:function(){var i=this.map;return i=i.camera.pickEllipsoid(new Cesium.Cartesian2(i.canvas.clientWidth/2,i.canvas.clientHeight/2)),i=Cesium.Ellipsoid.WGS84.cartesianToCartographic(i),i=this.getMercator([180*i.longitude/Math.PI,180*i.latitude/Math.PI]),{lng:i[0],lat:i[1]}}},{key:"getMercator",value:function(i){var s=[];return s[0]=i[0]*Math.PI/180*6378137,i=i[1]*Math.PI/180,s[1]=31890685e-1*Math.log((1+Math.sin(i))/(1-Math.sin(i))),s}}]),r}(Uv),VC=function(t){function r(i){return Ji(this,r),i=jn(this,(r.__proto__||Mo(r)).call(this,i)),i.eventMap={},i}return Co(r,t),Cn(r,[{key:"onResize",value:function(i){window.addEventListener("resize",i),this.eventMap.resize=i}},{key:"onUpdate",value:function(i){}},{key:"unbind",value:function(){var i=this;qi(this.eventMap).forEach(function(s){window.removeEventListener(s,i.eventMap[s])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.map.container}},{key:"getSize",value:function(){return{width:this.map.container.clientWidth,height:this.map.container.clientHeight}}},{key:"getTilt",value:function(){return this.map.tilt}},{key:"getHeading",value:function(){return this.map.heading}},{key:"getZoomUnits",value:function(){return this.map.zoomUnits}},{key:"getZoom",value:function(){return this.map.zoom}},{key:"getCenter",value:function(){return this.map.center}}]),r}(Uv),WC=function(t){function r(i,s){return Ji(this,r),i=jn(this,(r.__proto__||Mo(r)).call(this,i,s)),i.eventMap={},i}return Co(r,t),Cn(r,[{key:"onResize",value:function(i){window.addEventListener("resize",i),this.eventMap.resize=i}},{key:"onUpdate",value:function(i){}},{key:"unbind",value:function(){var i=this;qi(this.eventMap).forEach(function(s){window.removeEventListener(s,i.eventMap[s])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.map.container}},{key:"getSize",value:function(){return{width:this.map.container.clientWidth,height:this.map.container.clientHeight}}},{key:"getTilt",value:function(){return this.map.tilt}},{key:"getHeading",value:function(){return this.map.heading}},{key:"getZoomUnits",value:function(){return this.map.zoomUnits}},{key:"getCenter",value:function(){return this.map.center}}]),r}(Uv),jC=function(){function t(r,i){var s=this;Ji(this,t),i=i||{},i.mapType==="bmap"?this.map=new GC(r,i):i.mapType==="blank"?this.map=new VC(r,i):i.mapType==="cesium"?this.map=new bC(r,i):i.mapType==="three"?this.map=new WC(r,i):(i.mapType="bmapgl",this.map=new kC(r,i)),this.map.type=i.mapType,this._dpr=window.devicePixelRatio,i.mapType==="bmapgl"&&(this._dpr=this.map.map.config.ratio),this.options=i||{},this.renderArr=[],(r=i.canvas)||(r=document.createElement("canvas")),this.canvas=r,this.gl=i.gl?i.gl:Po(r,i),["OES_texture_float","OES_element_index_uint","WEBGL_color_buffer_float","EXT_float_blend"].forEach(function(f){s.gl.getExtension(f)}),this.changeSize(),this.projectionMatrix=ts.create(Float64Array),this.orthoMatrix=ts.create(Float64Array),this.matrix=ts.create(Float64Array),this.viewMatrix=ts.create(Float64Array),this.pointToPixelMatrix=ts.create(Float64Array),this.pixelToViewMatrix=ts.create(Float64Array),this.fovy=35,this.fps=Math.min(i.fps,60)||60,this.renderTime=new Date().valueOf(),this._animation=this.animation.bind(this),this._update=this.update.bind(this),this.onInitialize(this.options.onInitialize),this.options.onRender&&this.renderArr.push(this.options.onRender),this.stateManager=new zC({gl:this.gl}),this.pickFBO=new Fs(this.gl),this.transferOptions={},this.bind()}return Cn(t,[{key:"bind",value:function(){var r=this,i=this.map;i.onResize(function(){r.changeSize(),r.render()}),i.onUpdate(this._update),i.onClick&&i.onClick(function(s){r.onClick&&r.onClick(s)}),i.onDblClick&&i.onDblClick(function(s){r.onDblClick&&r.onDblClick(s)}),i.onRightClick&&i.onRightClick(function(s){r.onRightClick&&r.onRightClick(s)}),i.onMousemove&&i.onMousemove(function(s){r.onMousemove&&r.onMousemove(s)}),this.options.canvas||i.getContainer().appendChild(this.canvas)}},{key:"unbind",value:function(){var r=this.map;r.unbind&&r.unbind()}},{key:"setOptions",value:function(r){this.options=r}},{key:"onInitialize",value:function(r){r&&(this.transferOptions=r.bind(this)(this.gl)||{})}},{key:"bindFramebuffer",value:function(r){var i=this.gl;r?i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer):i.bindFramebuffer(i.FRAMEBUFFER,null)}},{key:"saveFramebuffer",value:function(){var r=this.gl;this.preFramebuffer=r.getParameter(r.FRAMEBUFFER_BINDING)}},{key:"restoreFramebuffer",value:function(){var r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,this.preFramebuffer)}},{key:"onRender",value:function(r){this.renderArr.push(r)}},{key:"changeSize",value:function(){var r=this.canvas,i=this.options;if(r){var s=r.style,f=this.map.getSize(),c=this._dpr;r.width=f.width*c,r.height=f.height*c,s.cssText="position: absolute;left:0;top:0;width:"+f.width+"px;height:"+f.height+"px;z-index:2;",i.mapType!=="cesium"||i.canvas||(s.pointerEvents="none"),this.gl.viewport(0,0,r.width,r.height),this.pickFBO=new Fs(this.gl)}}},{key:"update",value:function(){this.options.autoUpdate===!1||this.isAnimation&&60<=this.fps||this.render()}},{key:"pixelToPointIn",value:function(r){return this.map.pixelToPointIn(r)}},{key:"render",value:function(){if(this.map&&this.gl){var r=this.options,i=this.projectionMatrix,s=this.viewMatrix;if(r.mapType==="three")s=this.map.map.camera,i=s.projectionMatrix.elements,s=s.matrixWorldInverse.elements;else if(r.mapType==="cesium"){s=this.map.map;var f=s.camera.frustum.projectionMatrix;i=new Float32Array([f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8],f[9],f[10],f[11],f[12],f[13],f[14],f[15]]),f=s.camera.viewMatrix,s=new Float32Array([f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8],f[9],f[10],f[11],f[12],f[13],f[14],f[15]])}else this.map.map.mapType==="B_EARTH_MAP"?(i=this.map.map.getEarth().scene._camera.getProjectionMatrix(),s=this.map.map.getEarth().scene._camera.getModelViewMatrix()):(this.updateProjectionMatrix(),this.updateModelViewMatrix());for(f=ts.multiply(this.matrix,i,s),ut(this.transferOptions,{gl:this.gl,matrix:f,pointToPixelMatrix:this.pointToPixelMatrix,pixelToViewMatrix:this.pixelToViewMatrix,projectionMatrix:i,orthoMatrix:this.orthoMatrix,viewMatrix:s,stateManager:this.stateManager}),r.mapType!=="three"&&r.mapType!=="cesium"&&r.autoUpdate!==!1&&this.clear(),r=0;r<this.renderArr.length;r++)this.renderArr[r]&&this.renderArr[r].bind(this)(this.transferOptions)}}},{key:"clear",value:function(r){var i=this.gl,s=this.options.clearColor||[0,0,0,0];i.clearColor(s[0],s[1],s[2],s[3]),r&&(r instanceof Array||(r=Ro(r).unitArray()),i.clearColor(r[0],r[1],r[2],r[3])),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT)}},{key:"updateProjectionMatrix",value:function(){var r=this.options.cameraNear||1,i=this.options.cameraFar||4e3;ts.perspective(this.projectionMatrix,this.fovy*Math.PI/180,this.gl.canvas.width/this.gl.canvas.height,r,i);var s=this.map.getSize();ts.ortho(this.orthoMatrix,-s.width/2,s.width/2,-s.height/2,s.height/2,r,i)}},{key:"updateModelViewMatrix",value:function(){var r=this.map,i=this.viewMatrix,s=this.pointToPixelMatrix,f=this.pixelToViewMatrix;ts.identity(i),ts.identity(s),ts.identity(f);var c=r.getSize();ts.translate(f,f,[0,0,Math.round(-c.height/(2*Math.tan(this.fovy*Math.PI/180/2)))]),ts.rotate(f,f,r.getTilt()*Math.PI/180,[-1,0,0]),ts.rotate(f,f,r.getHeading()*Math.PI/180,[0,0,-1]),c=r.getCenter();var g=this.options.pointOffset||[0,0];r=r.getZoomUnits(),ts.translate(s,s,[(g[0]-c.lng)/r,(g[1]-c.lat)/r,0]),r=1/r,ts.scale(s,s,[r,r,r]),ts.multiply(i,f,s)}},{key:"destroy",value:function(){this.stopAnimation(),this.unbind();var r=this.gl.getExtension("WEBGL_lose_context");r&&r.loseContext(),this.canvas.remove(),this.gl=this.canvas=null}},{key:"animation",value:function(){if(this.isAnimation){if(60<=this.fps)this.render();else{var r=new Date().valueOf(),i=Math.floor(1e3/this.fps),s=r-this.renderTime;s>i&&(this.render(),this.renderTime=r-s%i)}window.requestAnimationFrame(this._animation)}}},{key:"startAnimation",value:function(){this.isAnimation||(this.isAnimation=!0,window.requestAnimationFrame(this._animation))}},{key:"stopAnimation",value:function(){this.isAnimation=!1}}]),t}(),XC=function(){function t(r){Ji(this,t),this.layers=[],this.options=r,this.webglLayer=r.webglLayer}return Cn(t,[{key:"addLayer",value:function(r){for(var i=!1,s=0;s<this.layers.length;s++)if(this.layers[s]===r){i=!0;break}i||(r.map=this.webglLayer.map,r.layerType==="threeLayer"?(r.setWebglLayer(this.webglLayer),i=r.getThreeLayer(),this.addLayer(i),r.initialize&&r.initialize(i)):(r.setWebglLayer(this.webglLayer),r.commonInitialize&&r.commonInitialize(this.webglLayer.gl),r.initialize&&r.initialize(this.webglLayer.gl),r.onOptionsChanged(r.getOptions(),{}),r.onDataChanged(r.getData()),r.onChanged(r.getOptions(),r.getData())),this.putInLayer(r)),this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"putInLayer",value:function(r){r.options.renderOrder===void 0&&(r.options.renderOrder=this.layers.length),this.layers.push(r),this.layers=this.layers.sort(function(i,s){return i.options.renderOrder-s.options.renderOrder})}},{key:"removeLayer",value:function(r){for(var i=0;i<this.layers.length;i++)this.layers[i]===r&&this.layers.splice(i,1);this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"showLayer",value:function(r){for(var i=0;i<this.layers.length;i++)this.layers[i]===r&&r.show();this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"hideLayer",value:function(r){for(var i=0;i<this.layers.length;i++)this.layers[i]===r&&r.hide();this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"removeAllLayers",value:function(){this.layers=[],this.webglLayer.stopAnimation(),this.webglLayer.render()}},{key:"destroyAllLayers",value:function(){for(var r=0;r<this.layers.length;r++){var i=this.layers[r];i.destroy&&i.destroy()}}},{key:"getAllLayers",value:function(){return this.layers}},{key:"getAllThreeLayers",value:function(){for(var r=[],i=0;i<this.layers.length;i++){var s=this.layers[i];s.layerType==="ThreeLayer"&&r.push(s)}return r}},{key:"isRequestAnimation",value:function(){for(var r=!1,i=0;i<this.layers.length;i++)if(this.layers[i].isRequestAnimation()){r=!0;break}return r}},{key:"beforeRender",value:function(r){r.gl&&this.webglLayer.stateManager.setDefaultState()}},{key:"afterRender",value:function(r){(r=r.gl)&&(r.bindBuffer(r.ARRAY_BUFFER,null),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,null),r.useProgram(null))}},{key:"renderGLLayers",value:function(r){this.webglLayer.stateManager.save();for(var i=0;i<this.layers.length;i++){var s=this.layers[i];if(s._visible===!0&&s.layerType!=="threeLayer"&&s.layerType!=="ThreeLayer"){var f=s.map.getZoom(),c=s.getOptions().zoomThreshold;c&&(f<c[0]||f>=c[1])||(this.beforeRender(r),s.render(r),this.afterRender(r))}}this.webglLayer.stateManager.restore()}},{key:"renderThreeLayer",value:function(r){this.webglLayer.stateManager.save(),this.webglLayer.stateManager.setState({blendFunc:[r.gl.SRC_ALPHA,r.gl.ONE],depthMask:!1,depthTest:!0,depthFunc:r.gl.LESS,cullFace:!1});for(var i=0;i<this.layers.length;i++){var s=this.layers[i];if(s._visible===!0&&s.layerType==="ThreeLayer"){var f=s.map.getZoom(),c=s.getOptions().zoomThreshold;c&&(f<c[0]||f>=c[1])||s.render(r)}}this.webglLayer.stateManager.restore()}},{key:"renderThreeLayers",value:function(r){this.webglLayer.stateManager.save(),this.webglLayer.stateManager.setState({blendFunc:[r.gl.SRC_ALPHA,r.gl.ONE],depthMask:!1,depthTest:!0,depthFunc:r.gl.LESS,cullFace:!1});for(var i=0;i<this.layers.length;i++){var s=this.layers[i];if(s._visible===!0&&s.layerType==="threeLayer"){var f=s.map.getZoom(),c=s.getOptions().zoomThreshold;c&&(f<c[0]||f>=c[1])||s.render(r)}}this.webglLayer.stateManager.restore()}},{key:"onClick",value:function(r){for(var i=this.layers.length-1;0<=i;i--){var s=this.layers[i];if(s._visible===!0&&s.layerType!=="threeLayer"&&s.layerType!=="ThreeLayer"){var f=s.map.getZoom(),c=s.getOptions().zoomThreshold;if((!c||!(f<=c[0]||f>=c[1]))&&s.options.enablePicked&&s.options.onClick&&s.pick&&(f=s.pick(r.x,r.y,"onClick"),s.options.onClick(f,r),s.options.autoSelect&&this.webglLayer.render(),r.cancelBubble===!0))break}}}},{key:"onDblClick",value:function(r){for(var i=this.layers.length-1;0<=i;i--){var s=this.layers[i];if(s._visible===!0&&s.layerType!=="threeLayer"&&s.layerType!=="ThreeLayer"){var f=s.map.getZoom(),c=s.getOptions().zoomThreshold;if((!c||!(f<=c[0]||f>=c[1]))&&s.options.enablePicked&&s.options.onDblClick&&s.pick&&(f=s.pick(r.x,r.y,"onDblClick"),s.options.onDblClick(f,r),s.options.autoSelect&&this.webglLayer.render(),r.cancelBubble===!0))break}}}},{key:"onRightClick",value:function(r){for(var i=this.layers.length-1;0<=i;i--){var s=this.layers[i];if(s._visible===!0&&s.layerType!=="threeLayer"&&s.layerType!=="ThreeLayer"){var f=s.map.getZoom(),c=s.getOptions().zoomThreshold;if((!c||!(f<=c[0]||f>=c[1]))&&s.options.enablePicked&&s.options.onRightClick&&s.pick&&(f=s.pick(r.x,r.y,"onRightClick"),s.options.onRightClick(f,r),s.options.autoSelect&&this.webglLayer.render(),r.cancelBubble===!0))break}}}},{key:"onMousemove",value:function(r){for(var i=!1,s=!1,f=this.layers.length-1;0<=f;f--){var c=this.layers[f];if(c._visible===!0&&c.layerType!=="threeLayer"&&c.layerType!=="ThreeLayer"){var g=c.map.getZoom(),p=c.getOptions().zoomThreshold;if((!p||!(g<=p[0]||g>=p[1]))&&c.options.enablePicked&&c.pick&&(c.options.onMousemove||c.options.autoSelect)&&(g=c.pick(r.x,r.y,"onMousemove"),!s&&(this.webglLayer.map.map.platform.style.cursor="default",s=g.dataIndex!==-1)&&(this.webglLayer.map.map.platform.style.cursor="pointer"),c.options.onMousemove&&c.options.onMousemove(g,r),c.options.autoSelect&&(i=!0),r.cancelBubble===!0))break}}i&&(this.webglLayer.isAnimation||this.webglLayer.render())}},{key:"destroy",value:function(){this.destroyAllLayers(),this.removeAllLayers()}}]),t}();(function(){function t(r){var i=this;Ji(this,t),this.options={autoUpdate:!0},this._visible=!0,ut(this.options,r);var s=r.pointOffset;this.webglLayer=r.webglLayer||new jC(r.map,this.options),this.layerManager=new XC({autoUpdate:this.options.autoUpdate,webglLayer:this.webglLayer}),this.effectManager=new HC(this.webglLayer.gl),this.webglRender={render:function(){}},this.options.effects&&this.effectManager.setEffects([this.webglRender].concat(this.options.effects)),this.webglLayer.onRender(function(f){i._render(f)}),this.webglLayer.onClick=function(f){i._visible&&i.layerManager.onClick(f)},this.webglLayer.onDblClick=function(f){i._visible&&i.layerManager.onDblClick(f)},this.webglLayer.onRightClick=function(f){i._visible&&i.layerManager.onRightClick(f)},this.webglLayer.onMousemove=function(f){i._visible&&i.layerManager.onMousemove(f)},s||this.webglLayer.options.mapType==="cesium"||(s=this.webglLayer.map.getCenter(),this.webglLayer.options.pointOffset=[s.lng,s.lat]),this.webglLayer.map.onResize(function(){i.effectManager.onResize()}),(this.postProcessing=r.postProcessing)&&(this.postProcessing.setWebglLayer(this.webglLayer),r=this.postProcessing.getThreeLayer(),this.addLayer(r),this.postProcessing.initialize(r),r.postProcessing=this.postProcessing)}return Cn(t,[{key:"renderCanvas",value:function(r){var i=this;this.postProcessing?this.postProcessing.addRender(function(){i.layerManager.renderGLLayers(r)}):this.layerManager.renderGLLayers(r),this.layerManager.renderThreeLayers(r),this.layerManager.renderThreeLayer(r)}},{key:"render",value:function(){this.webglLayer&&this.webglLayer.render()}},{key:"_render",value:function(r){var i=this;if(this._visible){var s=this.options.effects;s&&0<s.length?(this.webglRender.render=function(){i.renderCanvas(r)},this.effectManager.render()):(this.webglLayer.saveFramebuffer(),this.renderCanvas(r),this.webglLayer.restoreFramebuffer())}}},{key:"onRender",value:function(r){this.webglLayer.onRender(r)}},{key:"destroy",value:function(){this.stopAnimation(),this.layerManager.destroy(),this.effectManager.destroy(),this.webglLayer.destroy()}},{key:"isRequestAnimation",value:function(){return this.layerManager.isRequestAnimation()}},{key:"startAnimation",value:function(){this.webglLayer.startAnimation()}},{key:"stopAnimation",value:function(){this.webglLayer.stopAnimation()}},{key:"show",value:function(){this._visible!==!0&&(this._visible=!0,this.webglLayer.render(),this.isRequestAnimation()&&this.startAnimation())}},{key:"hide",value:function(){this._visible!==!1&&(this._visible=!1,this.stopAnimation(),this.webglLayer.clear())}},{key:"showLayer",value:function(r){this.layerManager.showLayer(r)}},{key:"hideLayer",value:function(r){this.layerManager.hideLayer(r)}},{key:"add",value:function(r){this.addLayer(r)}},{key:"remove",value:function(r){this.removeLayer(r)}},{key:"addLayer",value:function(r){this.layerManager.addLayer(r)}},{key:"removeLayer",value:function(r){this.layerManager.removeLayer(r)}},{key:"removeAllLayers",value:function(){this.layerManager.removeAllLayers()}},{key:"getAllLayers",value:function(){return this.layerManager.getAllLayers()}},{key:"getAllThreeLayers",value:function(){return this.layerManager.getAllThreeLayers()}}]),t})();var g_=function(){function t(r){Ji(this,t),this._visible=!0,this.options=this.getCommonDefaultOptions(),this.options=ut(this.options,this.getDefaultOptions()),this.autoUpdate=!1,this.options=ut(this.options,r),this.options.data&&(this.data=this.options.data,delete this.options.data)}return Cn(t,[{key:"getCommonDefaultOptions",value:function(){return{}}},{key:"getDefaultOptions",value:function(){return{}}},{key:"initialize",value:function(r){}},{key:"destroy",value:function(){this.onDestroy&&this.onDestroy()}},{key:"show",value:function(){this._visible=!0}},{key:"hide",value:function(){this._visible=!1}},{key:"render",value:function(){}},{key:"clear",value:function(){this.setData([])}},{key:"setData",value:function(r,i){i=i||{},this.data=r,this.onDataChanged&&this.onDataChanged(this.getData()),this.onChanged&&this.onChanged(this.getOptions(),this.getData(),i),i.autoRender!==!1&&this.webglLayer&&this.webglLayer.render()}},{key:"getData",value:function(){return this.data||[]}},{key:"setOptions",value:function(r,i){r=r||{},i=i||{};var s=ut({},this.getOptions());ut(this.options,r),this.onOptionsChanged&&this.onOptionsChanged(this.getOptions(),s),this.onChanged&&this.onChanged(this.getOptions(),this.getData(),i),r.data?(this.setData(r.data,i),delete r.data):i.autoRender!==!1&&this.webglLayer&&this.webglLayer.render()}},{key:"getOptions",value:function(){return this.options||{}}},{key:"onOptionsChanged",value:function(r,i){}},{key:"onDataChanged",value:function(r){}},{key:"onChanged",value:function(r,i){}},{key:"onDestroy",value:function(){}},{key:"lnglatToMercator",value:function(r,i){}},{key:"setWebglLayer",value:function(r){this.webglLayer=r}},{key:"getWebglLayer",value:function(){return this.webglLayer}},{key:"isRequestAnimation",value:function(){return this.autoUpdate}}]),t}(),YC=fo("iterator"),ZC=Li.isIterable=function(t){return t=Object(t),t[YC]!==void 0||"@@iterator"in t||so.hasOwnProperty(Rc(t))},Hv=Rt(function(t){t.exports={default:ZC,__esModule:!0}});Nt(Hv);var JC=Li.getIterator=function(t){var r=ev(t);if(typeof r!="function")throw TypeError(t+" is not iterable!");return Go(r.call(t))},kv=Rt(function(t){t.exports={default:JC,__esModule:!0}});Nt(kv);var qC=Rt(function(t,r){r.__esModule=!0;var i=Hv&&Hv.__esModule?Hv:{default:Hv},s=kv&&kv.__esModule?kv:{default:kv};r.default=function(){return function(f,c){if(Array.isArray(f))return f;if((0,i.default)(Object(f))){var g=[],p=!0,A=!1,S=void 0;try{for(var N=(0,s.default)(f),_;!(p=(_=N.next()).done)&&(g.push(_.value),!c||g.length!==c);p=!0);}catch(I){A=!0,S=I}finally{try{!p&&N.return&&N.return()}finally{if(A)throw S}}return g}throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()}),i2=Nt(qC),KC=function(t){function r(i){return Ji(this,r),i=jn(this,(r.__proto__||Mo(r)).call(this,i)),i.pickedColor=[-1,-1,-1],i}return Co(r,t),Cn(r,[{key:"getCommonDefaultOptions",value:function(){return{pickWidth:1,pickHeight:1,blend:"default",zIndex:0,zoomThreshold:[0,30],repeat:!1,enablePicked:!1,autoSelect:!1,selectedIndex:-1,selectedColor:"rgba(20, 20, 200, 1.0)"}}},{key:"commonInitialize",value:function(i){var s=this.getOptions();this.gl=i,s.enablePicked&&(this.pickBuffer=new zv({gl:i,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}))}},{key:"getCommonAttributes",value:function(){var i=[];return this.getOptions().enablePicked&&i.push({name:"aPickColor",buffer:this.pickBuffer,size:3,type:"FLOAT",stride:12,offset:0}),i}},{key:"getProperty",value:function(i,s,f){return Object.prototype.toString.call(s)==="[object Function]"?s(f):(s=f[i]||s,"properties"in f&&i in f.properties&&(s=f.properties[i]),s)}},{key:"normizedColor",value:function(i){var s=i;return i instanceof Array||(s=Ro(i).unitArray()),s[3]===void 0&&(s[3]=1),s}},{key:"normizedPoint",value:function(i){var s=this.getPointOffset();if(!i||i[0]===void 0||i[1]===void 0)return[s[0],s[1],0];var f=Number(i[0]),c=Number(i[1]);-180<=f&&180>=f&&-90<=c&&90>=c&&(c=this.webglLayer.map.lnglatToMercator(f,c),f=c[0],c=c[1]);var g=Number(i[2])||0;return this.webglLayer&&this.webglLayer.options.mapType==="cesium"&&window.Cesium?(f=this.convertLngLat([f,c]),g=window.Cesium.Cartesian3.fromDegrees(f[0],f[1],g),f=g.x,c=g.y,g=g.z):this.webglLayer&&this.webglLayer.options.mapType==="bmapgl"&&this.webglLayer.map.map.mapType==="B_EARTH_MAP"&&(f=this.convertLngLat([f,c]),g=this.webglLayer.map.map.getEarth().scene.fromLatLngToXYZ({lng:f[0],lat:f[1]}),f=g.x,c=g.y,g=g.z),3<i.length?[f-s[0],c-s[1],g].concat(u_(i.slice(3))):[f-s[0],c-s[1],g]}},{key:"convertLngLat",value:function(i){return[i[0]/2003750834e-2*180,180/Math.PI*(2*Math.atan(Math.exp(i[1]/2003750834e-2*180*Math.PI/180))-Math.PI/2)]}},{key:"getPointOffset",value:function(){var i=[0,0],s=this.getOptions();return this.webglLayer&&this.webglLayer.options.pointOffset?i=this.webglLayer.options.pointOffset:s.pointOffset&&(i=s.pointOffset),i}},{key:"indexToRgb",value:function(i){i++;var s=Math.floor(i/65536);i-=65536*s;var f=Math.floor(i/256);return[i-256*f,f,s]}},{key:"rgbToIndex",value:function(i){for(var s=i.length/4,f=Math.floor(s/2),c=function(N){return i[N]+256*i[N+1]+65536*i[N+2]-1},g=0;;g++){var p=f+g,A=f-g;if(p===A){if(p=c(4*p),-1<p)return p}else{if(p<s){var S=c(4*p);if(-1<S)return S}if(0<=A&&(S=c(4*A),-1<S))return S;if(p>=s&&0>A)break}}return-1}},{key:"getCommonUniforms",value:function(i){i=i.isPickRender;var s=this.getOptions(),f={};if(s.enablePicked){var c=0<=s.selectedIndex?s.selectedIndex:-1;c=s.autoSelect?this.pickedColor:this.indexToRgb(c),f=ut(f,{uSelectedColor:this.normizedColor(s.selectedColor),uEnablePicked:s.enablePicked,uPickedColor:c.map(function(g){return g/255}),uIsPickRender:!!i})}return f}},{key:"pick",value:function(i,s,f){var c=this.getOptions(),g=this.gl,p=this.webglLayer._dpr;this.webglLayer.saveFramebuffer(),this.webglLayer.bindFramebuffer(this.webglLayer.pickFBO),this.webglLayer.clear(),this.render({gl:g,isPickRender:!0,matrix:this.webglLayer.matrix,projectionMatrix:this.webglLayer.projectionMatrix,viewMatrix:this.webglLayer.viewMatrix,orthoMatrix:this.webglLayer.orthoMatrix});var A=new Uint8Array(4*c.pickWidth*c.pickHeight);return g.readPixels(i*p-Math.floor(c.pickWidth/2),g.canvas.height-s*p-Math.floor(c.pickHeight/2),c.pickWidth,c.pickHeight,g.RGBA,g.UNSIGNED_BYTE,A),i=this.rgbToIndex(A),this.pickAfter&&(i=this.pickAfter(A,i+1)),this.setPickedIndex&&this.setPickedIndex(i,f),f=this.getData(),this.pickedColor=[A[0],A[1],A[2]],this.webglLayer.restoreFramebuffer(),{dataIndex:i,dataItem:f[i]}}},{key:"setGLState",value:function(i){this.webglLayer.stateManager.setState(i,this.options)}},{key:"addMultipleCoords",value:function(i,s,f){if(!this.options.repeat||!this.webglLayer||this.webglLayer.options.mapType!=="bmapgl"||this.webglLayer.map.map.mapType==="B_EARTH_MAP")return[i];var c=this.webglLayer.map.map;s=s||c.getZoom();var g=f?c.worldSize(s):4007545274461451e-8;if(s=function(L){return[[L[0]-g,L[1],L[2]||0],[L[0]+g,L[1],L[2]||0]]},i instanceof Array&&!(i[0]instanceof Array))return s=s(i),s=i2(s,2),[i,s[0],s[1]];if(i instanceof Array&&i[0]instanceof Array&&!(i[0][0]instanceof Array)){f=[],c=[];for(var p=0;p<i.length;p++){var A=s(i[p]);A=i2(A,2);var S=A[1];f.push(A[0]),c.push(S)}return[i,f,c]}for(f=[],c=[],p=0;p<i.length;p++){A=[],S=[];for(var N=0;N<i[p].length;N++){var _=s(i[p][N]);_=i2(_,2);var I=_[1];A.push(_[0]),S.push(I)}f.push(A),c.push(S)}return[i,f,c]}}]),r}(g_),m_=Rt(function(t,r){(function(i,s){s(r)})(ai,function(i){function s(){}function f(e,o){this.x=e||0,this.y=o||0}function c(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function g(e,o,h,m,w,T,R,z,k,b){Object.defineProperty(this,"id",{value:V3++}),this.uuid=Si.generateUUID(),this.name="",this.image=e!==void 0?e:g.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=o!==void 0?o:g.DEFAULT_MAPPING,this.wrapS=h!==void 0?h:1001,this.wrapT=m!==void 0?m:1001,this.magFilter=w!==void 0?w:1006,this.minFilter=T!==void 0?T:1008,this.anisotropy=k!==void 0?k:1,this.format=R!==void 0?R:1023,this.internalFormat=null,this.type=z!==void 0?z:1009,this.offset=new f(0,0),this.repeat=new f(1,1),this.center=new f(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new c,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=b!==void 0?b:3e3,this.version=0,this.onUpdate=null}function p(e,o,h,m){this.x=e||0,this.y=o||0,this.z=h||0,this.w=m!==void 0?m:1}function A(e,o,h){this.width=e,this.height=o,this.scissor=new p(0,0,e,o),this.scissorTest=!1,this.viewport=new p(0,0,e,o),h=h||{},this.texture=new g(void 0,h.mapping,h.wrapS,h.wrapT,h.magFilter,h.minFilter,h.format,h.type,h.anisotropy,h.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=o,this.texture.generateMipmaps=h.generateMipmaps!==void 0?h.generateMipmaps:!1,this.texture.minFilter=h.minFilter!==void 0?h.minFilter:1006,this.depthBuffer=h.depthBuffer!==void 0?h.depthBuffer:!0,this.stencilBuffer=h.stencilBuffer!==void 0?h.stencilBuffer:!0,this.depthTexture=h.depthTexture!==void 0?h.depthTexture:null}function S(e,o,h){A.call(this,e,o,h),this.samples=4}function N(e,o,h,m){this._x=e||0,this._y=o||0,this._z=h||0,this._w=m!==void 0?m:1}function _(e,o,h){this.x=e||0,this.y=o||0,this.z=h||0}function I(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function L(e,o,h,m){this._x=e||0,this._y=o||0,this._z=h||0,this._order=m||L.DefaultOrder}function P(){this.mask=1}function F(){Object.defineProperty(this,"id",{value:X3++}),this.uuid=Si.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=F.DefaultUp.clone();var e=new _,o=new L,h=new N,m=new _(1,1,1);o._onChange(function(){h.setFromEuler(o,!1)}),h._onChange(function(){o.setFromQuaternion(h,void 0,!1)}),Xr(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:o},quaternion:{configurable:!0,enumerable:!0,value:h},scale:{configurable:!0,enumerable:!0,value:m},modelViewMatrix:{value:new I},normalMatrix:{value:new c}}),this.matrix=new I,this.matrixWorld=new I,this.matrixAutoUpdate=F.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new P,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function W(){F.call(this),this.type="Scene",this.overrideMaterial=this.fog=this.environment=this.background=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function X(e,o){this.min=e!==void 0?e:new _(Infinity,Infinity,Infinity),this.max=o!==void 0?o:new _(-Infinity,-Infinity,-Infinity)}function Z(e,o,h,m,w){var T,R=0;for(T=e.length-3;R<=T;R+=3){jp.fromArray(e,R);var z=w.x*Math.abs(jp.x)+w.y*Math.abs(jp.y)+w.z*Math.abs(jp.z),k=o.dot(jp),b=h.dot(jp),q=m.dot(jp);if(Math.max(-Math.max(k,b,q),Math.min(k,b,q))>z)return!1}return!0}function tt(e,o){this.center=e!==void 0?e:new _,this.radius=o!==void 0?o:-1}function ot(e,o){this.origin=e!==void 0?e:new _,this.direction=o!==void 0?o:new _(0,0,-1)}function xt(e,o){this.normal=e!==void 0?e:new _(1,0,0),this.constant=o!==void 0?o:0}function At(e,o,h){this.a=e!==void 0?e:new _,this.b=o!==void 0?o:new _,this.c=h!==void 0?h:new _}function yt(e,o,h){return o===void 0&&h===void 0?this.set(e):this.setRGB(e,o,h)}function zt(e,o,h){return 0>h&&(h+=1),1<h&&--h,h<1/6?e+6*(o-e)*h:.5>h?o:h<2/3?e+6*(o-e)*(2/3-h):e}function Ht(e){return .04045>e?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function $t(e){return .0031308>e?12.92*e:1.055*Math.pow(e,.41666)-.055}function Vt(e,o,h,m,w,T){this.a=e,this.b=o,this.c=h,this.normal=m&&m.isVector3?m:new _,this.vertexNormals=Array.isArray(m)?m:[],this.color=w&&w.isColor?w:new yt,this.vertexColors=Array.isArray(w)?w:[],this.materialIndex=T!==void 0?T:0}function Kt(){Object.defineProperty(this,"id",{value:tT++}),this.uuid=Si.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=this.flatShading=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null,this.depthFunc=3,this.depthWrite=this.depthTest=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilZPass=this.stencilZFail=this.stencilFail=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipShadows=this.clipIntersection=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetUnits=this.polygonOffsetFactor=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.toneMapped=this.visible=!0,this.userData={},this.version=0}function ze(e){Kt.call(this),this.type="MeshBasicMaterial",this.color=new yt(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphTargets=this.skinning=!1,this.setValues(e)}function ae(e,o,h){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=o,this.count=e!==void 0?e.length/o:0,this.normalized=h===!0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function Qe(e,o,h){ae.call(this,new Int8Array(e),o,h)}function gr(e,o,h){ae.call(this,new Uint8Array(e),o,h)}function ir(e,o,h){ae.call(this,new Uint8ClampedArray(e),o,h)}function gi(e,o,h){ae.call(this,new Int16Array(e),o,h)}function hr(e,o,h){ae.call(this,new Uint16Array(e),o,h)}function gt(e,o,h){ae.call(this,new Int32Array(e),o,h)}function mt(e,o,h){ae.call(this,new Uint32Array(e),o,h)}function vt(e,o,h){ae.call(this,new Float32Array(e),o,h)}function Ct(e,o,h){ae.call(this,new Float64Array(e),o,h)}function et(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function ct(e){if(e.length===0)return-Infinity;for(var o=e[0],h=1,m=e.length;h<m;++h)e[h]>o&&(o=e[h]);return o}function ft(){Object.defineProperty(this,"id",{value:eT+=2}),this.uuid=Si.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingSphere=this.boundingBox=null,this.drawRange={start:0,count:Infinity},this.userData={}}function Tt(e,o){F.call(this),this.type="Mesh",this.geometry=e!==void 0?e:new ft,this.material=o!==void 0?o:new ze,this.updateMorphTargets()}function kt(e,o,h,m,w,T,R,z){return(o.side===1?m.intersectTriangle(R,T,w,!0,z):m.intersectTriangle(w,T,R,o.side!==2,z))===null?null:(_x.copy(z),_x.applyMatrix4(e.matrixWorld),o=h.ray.origin.distanceTo(_x),o<h.near||o>h.far?null:{distance:o,point:_x.clone(),object:e})}function Jt(e,o,h,m,w,T,R,z,k,b,q,J){if(pf.fromBufferAttribute(w,b),df.fromBufferAttribute(w,q),gf.fromBufferAttribute(w,J),w=e.morphTargetInfluences,o.morphTargets&&T&&w){xx.set(0,0,0),Ax.set(0,0,0),wx.set(0,0,0);for(var Q=0,K=T.length;Q<K;Q++){var rt=w[Q],ht=T[Q];rt!==0&&(ew.fromBufferAttribute(ht,b),rw.fromBufferAttribute(ht,q),iw.fromBufferAttribute(ht,J),R?(xx.addScaledVector(ew,rt),Ax.addScaledVector(rw,rt),wx.addScaledVector(iw,rt)):(xx.addScaledVector(ew.sub(pf),rt),Ax.addScaledVector(rw.sub(df),rt),wx.addScaledVector(iw.sub(gf),rt)))}pf.add(xx),df.add(Ax),gf.add(wx)}return e.isSkinnedMesh&&(e.boneTransform(b,pf),e.boneTransform(q,df),e.boneTransform(J,gf)),(e=kt(e,o,h,m,pf,df,gf,R0))&&(z&&(fm.fromBufferAttribute(z,b),pm.fromBufferAttribute(z,q),dm.fromBufferAttribute(z,J),e.uv=At.getUV(R0,pf,df,gf,fm,pm,dm,new f)),k&&(fm.fromBufferAttribute(k,b),pm.fromBufferAttribute(k,q),dm.fromBufferAttribute(k,J),e.uv2=At.getUV(R0,pf,df,gf,fm,pm,dm,new f)),z=new Vt(b,q,J),At.getNormal(pf,df,gf,z.normal),e.face=z),e}function pt(){Object.defineProperty(this,"id",{value:rT+=2}),this.uuid=Si.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function me(e){var o={},h;for(h in e){o[h]={};for(var m in e[h]){var w=e[h][m];w&&(w.isColor||w.isMatrix3||w.isMatrix4||w.isVector2||w.isVector3||w.isVector4||w.isTexture)?o[h][m]=w.clone():Array.isArray(w)?o[h][m]=w.slice():o[h][m]=w}}return o}function Ae(e){for(var o={},h=0;h<e.length;h++){var m=me(e[h]),w;for(w in m)o[w]=m[w]}return o}function de(e){Kt.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,this.fragmentShader=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function ie(){F.call(this),this.type="Camera",this.matrixWorldInverse=new I,this.projectionMatrix=new I,this.projectionMatrixInverse=new I}function Te(e,o,h,m){ie.call(this),this.type="PerspectiveCamera",this.fov=e!==void 0?e:50,this.zoom=1,this.near=h!==void 0?h:.1,this.far=m!==void 0?m:2e3,this.focus=10,this.aspect=o!==void 0?o:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function mr(e,o,h){if(F.call(this),this.type="CubeCamera",h.isWebGLCubeRenderTarget!==!0)console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");else{this.renderTarget=h;var m=new Te(90,1,e,o);m.layers=this.layers,m.up.set(0,-1,0),m.lookAt(new _(1,0,0)),this.add(m);var w=new Te(90,1,e,o);w.layers=this.layers,w.up.set(0,-1,0),w.lookAt(new _(-1,0,0)),this.add(w);var T=new Te(90,1,e,o);T.layers=this.layers,T.up.set(0,0,1),T.lookAt(new _(0,1,0)),this.add(T);var R=new Te(90,1,e,o);R.layers=this.layers,R.up.set(0,0,-1),R.lookAt(new _(0,-1,0)),this.add(R);var z=new Te(90,1,e,o);z.layers=this.layers,z.up.set(0,-1,0),z.lookAt(new _(0,0,1)),this.add(z);var k=new Te(90,1,e,o);k.layers=this.layers,k.up.set(0,-1,0),k.lookAt(new _(0,0,-1)),this.add(k),this.update=function(b,q){this.parent===null&&this.updateMatrixWorld();var J=b.xr.enabled,Q=b.getRenderTarget();b.xr.enabled=!1;var K=h.texture.generateMipmaps;h.texture.generateMipmaps=!1,b.setRenderTarget(h,0),b.render(q,m),b.setRenderTarget(h,1),b.render(q,w),b.setRenderTarget(h,2),b.render(q,T),b.setRenderTarget(h,3),b.render(q,R),b.setRenderTarget(h,4),b.render(q,z),h.texture.generateMipmaps=K,b.setRenderTarget(h,5),b.render(q,k),b.setRenderTarget(Q),b.xr.enabled=J},this.clear=function(b,q,J,Q){for(var K=b.getRenderTarget(),rt=0;6>rt;rt++)b.setRenderTarget(h,rt),b.clear(q,J,Q);b.setRenderTarget(K)}}}function Nr(e,o,h){kc(o)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),o=h),A.call(this,e,e,o)}function we(e,o,h,m,w,T,R,z,k,b,q,J){g.call(this,null,T,R,z,k,b,m,w,q,J),this.image={data:e||null,width:o||1,height:h||1},this.magFilter=k!==void 0?k:1003,this.minFilter=b!==void 0?b:1003,this.flipY=this.generateMipmaps=!1,this.unpackAlignment=1,this.needsUpdate=!0}function nr(e,o,h,m,w,T){this.planes=[e!==void 0?e:new xt,o!==void 0?o:new xt,h!==void 0?h:new xt,m!==void 0?m:new xt,w!==void 0?w:new xt,T!==void 0?T:new xt]}function Jr(){function e(w,T){h!==!1&&(m(w,T),o.requestAnimationFrame(e))}var o=null,h=!1,m=null;return{start:function(){h!==!0&&m!==null&&(o.requestAnimationFrame(e),h=!0)},stop:function(){h=!1},setAnimationLoop:function(w){m=w},setContext:function(w){o=w}}}function je(e,o){function h(T,R){var z=T.array,k=T.usage,b=e.createBuffer();return e.bindBuffer(R,b),e.bufferData(R,z,k),T.onUploadCallback(),R=5126,z instanceof Float32Array?R=5126:z instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):z instanceof Uint16Array?R=5123:z instanceof Int16Array?R=5122:z instanceof Uint32Array?R=5125:z instanceof Int32Array?R=5124:z instanceof Int8Array?R=5120:z instanceof Uint8Array&&(R=5121),{buffer:b,type:R,bytesPerElement:z.BYTES_PER_ELEMENT,version:T.version}}var m=o.isWebGL2,w=new An;return{get:function(T){return T.isInterleavedBufferAttribute&&(T=T.data),w.get(T)},remove:function(T){T.isInterleavedBufferAttribute&&(T=T.data);var R=w.get(T);R&&(e.deleteBuffer(R.buffer),w.delete(T))},update:function(T,R){T.isInterleavedBufferAttribute&&(T=T.data);var z=w.get(T);if(z===void 0)w.set(T,h(T,R));else if(z.version<T.version){var k=T.array,b=T.updateRange;e.bindBuffer(R,z.buffer),b.count===-1?e.bufferSubData(R,0,k):(m?e.bufferSubData(R,b.offset*k.BYTES_PER_ELEMENT,k,b.offset,b.count):e.bufferSubData(R,b.offset*k.BYTES_PER_ELEMENT,k.subarray(b.offset,b.offset+b.count)),b.count=-1),z.version=T.version}}}}function $n(e,o,h,m){pt.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:o,widthSegments:h,heightSegments:m},this.fromBufferGeometry(new Oi(e,o,h,m)),this.mergeVertices()}function Oi(e,o,h,m){ft.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:o,widthSegments:h,heightSegments:m},e=e||1,o=o||1;var w=e/2,T=o/2;h=Math.floor(h)||1,m=Math.floor(m)||1;var R=h+1,z=m+1,k=e/h,b=o/m,q=[],J=[],Q=[],K=[];for(e=0;e<z;e++){var rt=e*b-T;for(o=0;o<R;o++)J.push(o*k-w,-rt,0),Q.push(0,0,1),K.push(o/h),K.push(1-e/m)}for(e=0;e<m;e++)for(o=0;o<h;o++)w=o+R*(e+1),T=o+1+R*(e+1),z=o+1+R*e,q.push(o+R*e,w,z),q.push(w,T,z);this.setIndex(q),this.setAttribute("position",new vt(J,3)),this.setAttribute("normal",new vt(Q,3)),this.setAttribute("uv",new vt(K,2))}function hs(e,o,h,m){function w(Q,K){o.buffers.color.setClear(Q.r,Q.g,Q.b,K,m)}var T=new yt(0),R=0,z,k,b=null,q=0,J=null;return{getClearColor:function(){return T},setClearColor:function(Q,K){T.set(Q),R=K!==void 0?K:1,w(T,R)},getClearAlpha:function(){return R},setClearAlpha:function(Q){R=Q,w(T,R)},render:function(Q,K,rt,ht){K=K.background,rt=e.xr,(rt=rt.getSession&&rt.getSession())&&rt.environmentBlendMode==="additive"&&(K=null),K===null?w(T,R):K&&K.isColor&&(w(K,1),ht=!0),(e.autoClear||ht)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),K&&(K.isCubeTexture||K.isWebGLCubeRenderTarget||K.mapping===306)?(k===void 0&&(k=new Tt(new P0(1,1,1),new de({type:"BackgroundCubeMaterial",uniforms:me($l.cube.uniforms),vertexShader:$l.cube.vertexShader,fragmentShader:$l.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),k.geometry.deleteAttribute("normal"),k.geometry.deleteAttribute("uv"),k.onBeforeRender=function(Ot,jt,Gt){this.matrixWorld.copyPosition(Gt.matrixWorld)},Object.defineProperty(k.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),h.update(k)),ht=K.isWebGLCubeRenderTarget?K.texture:K,k.material.uniforms.envMap.value=ht,k.material.uniforms.flipEnvMap.value=ht.isCubeTexture?-1:1,(b!==K||q!==ht.version||J!==e.toneMapping)&&(k.material.needsUpdate=!0,b=K,q=ht.version,J=e.toneMapping),Q.unshift(k,k.geometry,k.material,0,0,null)):K&&K.isTexture&&(z===void 0&&(z=new Tt(new Oi(2,2),new de({type:"BackgroundMaterial",uniforms:me($l.background.uniforms),vertexShader:$l.background.vertexShader,fragmentShader:$l.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),z.geometry.deleteAttribute("normal"),Object.defineProperty(z.material,"map",{get:function(){return this.uniforms.t2D.value}}),h.update(z)),z.material.uniforms.t2D.value=K,K.matrixAutoUpdate===!0&&K.updateMatrix(),z.material.uniforms.uvTransform.value.copy(K.matrix),(b!==K||q!==K.version||J!==e.toneMapping)&&(z.material.needsUpdate=!0,b=K,q=K.version,J=e.toneMapping),Q.unshift(z,z.geometry,z.material,0,0,null))}}}function gu(e,o,h,m){var w=m.isWebGL2,T;this.setMode=function(R){T=R},this.render=function(R,z){e.drawArrays(T,R,z),h.update(z,T)},this.renderInstances=function(R,z,k,b){if(b!==0){if(w){R=e;var q="drawArraysInstanced"}else if(R=o.get("ANGLE_instanced_arrays"),q="drawArraysInstancedANGLE",R===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}R[q](T,z,k,b),h.update(k,T,b)}}}function Vh(e,o,h){function m(ee){if(ee==="highp"){if(0<e.getShaderPrecisionFormat(35633,36338).precision&&0<e.getShaderPrecisionFormat(35632,36338).precision)return"highp";ee="mediump"}return ee==="mediump"&&0<e.getShaderPrecisionFormat(35633,36337).precision&&0<e.getShaderPrecisionFormat(35632,36337).precision?"mediump":"lowp"}var w,T=typeof WebGL2RenderingContext!="undefined"&&e instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&e instanceof WebGL2ComputeRenderingContext,R=h.precision!==void 0?h.precision:"highp",z=m(R);z!==R&&(console.warn("THREE.WebGLRenderer:",R,"not supported, using",z,"instead."),R=z),h=h.logarithmicDepthBuffer===!0,z=e.getParameter(34930);var k=e.getParameter(35660),b=e.getParameter(3379),q=e.getParameter(34076),J=e.getParameter(34921),Q=e.getParameter(36347),K=e.getParameter(36348),rt=e.getParameter(36349),ht=0<k,Ot=T||!!o.get("OES_texture_float"),jt=ht&&Ot,Gt=T?e.getParameter(36183):0;return{isWebGL2:T,getMaxAnisotropy:function(){if(w!==void 0)return w;var ee=o.get("EXT_texture_filter_anisotropic");return w=ee!==null?e.getParameter(ee.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:m,precision:R,logarithmicDepthBuffer:h,maxTextures:z,maxVertexTextures:k,maxTextureSize:b,maxCubemapSize:q,maxAttributes:J,maxVertexUniforms:Q,maxVaryings:K,maxFragmentUniforms:rt,vertexTextures:ht,floatFragmentTextures:Ot,floatVertexTextures:jt,maxSamples:Gt}}function xa(){function e(){b.value!==m&&(b.value=m,b.needsUpdate=0<w),h.numPlanes=w,h.numIntersection=0}function o(q,J,Q,K){var rt=q!==null?q.length:0,ht=null;if(rt!==0){if(ht=b.value,K!==!0||ht===null)for(K=Q+4*rt,J=J.matrixWorldInverse,k.getNormalMatrix(J),(ht===null||ht.length<K)&&(ht=new Float32Array(K)),K=0;K!==rt;++K,Q+=4)z.copy(q[K]).applyMatrix4(J,k),z.normal.toArray(ht,Q),ht[Q+3]=z.constant;b.value=ht,b.needsUpdate=!0}return h.numPlanes=rt,h.numIntersection=0,ht}var h=this,m=null,w=0,T=!1,R=!1,z=new xt,k=new c,b={value:null,needsUpdate:!1};this.uniform=b,this.numIntersection=this.numPlanes=0,this.init=function(q,J,Q){var K=q.length!==0||J||w!==0||T;return T=J,m=o(q,Q,0),w=q.length,K},this.beginShadows=function(){R=!0,o(null)},this.endShadows=function(){R=!1,e()},this.setState=function(q,J,Q,K,rt,ht){if(!T||q===null||q.length===0||R&&!Q)R?o(null):e();else{Q=R?0:w;var Ot=4*Q,jt=rt.clippingState||null;for(b.value=jt,jt=o(q,K,Ot,ht),q=0;q!==Ot;++q)jt[q]=m[q];rt.clippingState=jt,this.numIntersection=J?this.numPlanes:0,this.numPlanes+=Q}}}function Wl(e){var o={};return{get:function(h){if(o[h]!==void 0)return o[h];switch(h){case"WEBGL_depth_texture":var m=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":m=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":m=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":m=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:m=e.getExtension(h)}return m===null&&console.warn("THREE.WebGLRenderer: "+h+" extension not supported."),o[h]=m}}}function jl(e,o,h){function m(z){var k=z.target;z=T.get(k),z.index!==null&&o.remove(z.index);for(var b in z.attributes)o.remove(z.attributes[b]);k.removeEventListener("dispose",m),T.delete(k),(b=R.get(z))&&(o.remove(b),R.delete(z)),h.memory.geometries--}function w(z){var k=[],b=z.index,q=z.attributes.position;if(b!==null){var J=b.array;b=b.version,q=0;for(var Q=J.length;q<Q;q+=3){var K=J[q+0],rt=J[q+1],ht=J[q+2];k.push(K,rt,rt,ht,ht,K)}}else for(J=q.array,b=q.version,q=0,Q=J.length/3-1;q<Q;q+=3)K=q+0,rt=q+1,ht=q+2,k.push(K,rt,rt,ht,ht,K);k=new(65535<ct(k)?mt:hr)(k,1),k.version=b,o.update(k,34963),(J=R.get(z))&&o.remove(J),R.set(z,k)}var T=new An,R=new An;return{get:function(z,k){var b=T.get(k);return b||(k.addEventListener("dispose",m),k.isBufferGeometry?b=k:k.isGeometry&&(k._bufferGeometry===void 0&&(k._bufferGeometry=new ft().setFromObject(z)),b=k._bufferGeometry),T.set(k,b),h.memory.geometries++,b)},update:function(z){var k=z.index,b=z.attributes;k!==null&&o.update(k,34963);for(var q in b)o.update(b[q],34962);z=z.morphAttributes;for(q in z){k=z[q],b=0;for(var J=k.length;b<J;b++)o.update(k[b],34962)}},getWireframeAttribute:function(z){var k=R.get(z);if(k){var b=z.index;b!==null&&k.version<b.version&&w(z)}else w(z);return R.get(z)}}}function ta(e,o,h,m){var w=m.isWebGL2,T,R,z;this.setMode=function(k){T=k},this.setIndex=function(k){R=k.type,z=k.bytesPerElement},this.render=function(k,b){e.drawElements(T,b,R,k*z),h.update(b,T)},this.renderInstances=function(k,b,q,J){if(J!==0){if(w){k=e;var Q="drawElementsInstanced"}else if(k=o.get("ANGLE_instanced_arrays"),Q="drawElementsInstancedANGLE",k===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}k[Q](T,q,R,b*z,J),h.update(q,T,J)}}}function Xu(e){var o={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:o,programs:null,autoReset:!0,reset:function(){o.frame++,o.calls=0,o.triangles=0,o.points=0,o.lines=0},update:function(h,m,w){switch(w=w||1,o.calls++,m){case 4:o.triangles+=h/3*w;break;case 1:o.lines+=h/2*w;break;case 3:o.lines+=w*(h-1);break;case 2:o.lines+=w*h;break;case 0:o.points+=w*h;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",m)}}}}function es(e,o){return Math.abs(o[1])-Math.abs(e[1])}function Ty(e){var o={},h=new Float32Array(8);return{update:function(m,w,T,R){var z=m.morphTargetInfluences,k=z===void 0?0:z.length;if(m=o[w.id],m===void 0){m=[];for(var b=0;b<k;b++)m[b]=[b,0];o[w.id]=m}var q=T.morphTargets&&w.morphAttributes.position;for(T=T.morphNormals&&w.morphAttributes.normal,b=0;b<k;b++){var J=m[b];J[1]!==0&&(q&&w.deleteAttribute("morphTarget"+b),T&&w.deleteAttribute("morphNormal"+b))}for(b=0;b<k;b++)J=m[b],J[0]=b,J[1]=z[b];for(m.sort(es),b=z=0;8>b;b++){if((J=m[b])&&(k=J[0],J=J[1])){q&&w.setAttribute("morphTarget"+b,q[k]),T&&w.setAttribute("morphNormal"+b,T[k]),h[b]=J,z+=J;continue}h[b]=0}w=w.morphTargetsRelative?1:1-z,R.getUniforms().setValue(e,"morphTargetBaseInfluence",w),R.getUniforms().setValue(e,"morphTargetInfluences",h)}}}function Sy(e,o,h,m){var w=new An;return{update:function(T){var R=m.render.frame,z=T.geometry,k=o.get(T,z);return w.get(k)!==R&&(z.isGeometry&&k.updateFromObject(T),o.update(k),w.set(k,R)),T.isInstancedMesh&&h.update(T.instanceMatrix,34962),k},dispose:function(){w=new An}}}function mu(e,o,h,m,w,T,R,z,k,b){e=e!==void 0?e:[],g.call(this,e,o!==void 0?o:301,h,m,w,T,R!==void 0?R:1022,z,k,b),this.flipY=!1}function Bs(e,o,h,m){g.call(this,null),this.image={data:e||null,width:o||1,height:h||1,depth:m||1},this.minFilter=this.magFilter=1003,this.wrapR=1001,this.flipY=this.generateMipmaps=!1,this.needsUpdate=!0}function ea(e,o,h,m){g.call(this,null),this.image={data:e||null,width:o||1,height:h||1,depth:m||1},this.minFilter=this.magFilter=1003,this.wrapR=1001,this.flipY=this.generateMipmaps=!1,this.needsUpdate=!0}function Wh(e,o,h){var m=e[0];if(0>=m||0<m)return e;var w=o*h,T=mM[w];if(T===void 0&&(T=new Float32Array(w),mM[w]=T),o!==0)for(m.toArray(T,0),m=1,w=0;m!==o;++m)w+=h,e[m].toArray(T,w);return T}function Aa(e,o){if(e.length!==o.length)return!1;for(var h=0,m=e.length;h<m;h++)if(e[h]!==o[h])return!1;return!0}function cs(e,o){for(var h=0,m=o.length;h<m;h++)e[h]=o[h]}function Ep(e,o){var h=vM[o];h===void 0&&(h=new Int32Array(o),vM[o]=h);for(var m=0;m!==o;++m)h[m]=e.allocateTextureUnit();return h}function _t(e,o){var h=this.cache;h[0]!==o&&(e.uniform1f(this.addr,o),h[0]=o)}function _e(e,o){var h=this.cache;o.x!==void 0?(h[0]!==o.x||h[1]!==o.y)&&(e.uniform2f(this.addr,o.x,o.y),h[0]=o.x,h[1]=o.y):Aa(h,o)||(e.uniform2fv(this.addr,o),cs(h,o))}function Yt(e,o){var h=this.cache;o.x!==void 0?(h[0]!==o.x||h[1]!==o.y||h[2]!==o.z)&&(e.uniform3f(this.addr,o.x,o.y,o.z),h[0]=o.x,h[1]=o.y,h[2]=o.z):o.r!==void 0?(h[0]!==o.r||h[1]!==o.g||h[2]!==o.b)&&(e.uniform3f(this.addr,o.r,o.g,o.b),h[0]=o.r,h[1]=o.g,h[2]=o.b):Aa(h,o)||(e.uniform3fv(this.addr,o),cs(h,o))}function Re(e,o){var h=this.cache;o.x!==void 0?(h[0]!==o.x||h[1]!==o.y||h[2]!==o.z||h[3]!==o.w)&&(e.uniform4f(this.addr,o.x,o.y,o.z,o.w),h[0]=o.x,h[1]=o.y,h[2]=o.z,h[3]=o.w):Aa(h,o)||(e.uniform4fv(this.addr,o),cs(h,o))}function Je(e,o){var h=this.cache,m=o.elements;m===void 0?Aa(h,o)||(e.uniformMatrix2fv(this.addr,!1,o),cs(h,o)):Aa(h,m)||(AM.set(m),e.uniformMatrix2fv(this.addr,!1,AM),cs(h,m))}function yi(e,o){var h=this.cache,m=o.elements;m===void 0?Aa(h,o)||(e.uniformMatrix3fv(this.addr,!1,o),cs(h,o)):Aa(h,m)||(xM.set(m),e.uniformMatrix3fv(this.addr,!1,xM),cs(h,m))}function ar(e,o){var h=this.cache,m=o.elements;m===void 0?Aa(h,o)||(e.uniformMatrix4fv(this.addr,!1,o),cs(h,o)):Aa(h,m)||(yM.set(m),e.uniformMatrix4fv(this.addr,!1,yM),cs(h,m))}function Wr(e,o,h){var m=this.cache,w=h.allocateTextureUnit();m[0]!==w&&(e.uniform1i(this.addr,w),m[0]=w),h.safeSetTexture2D(o||dM,w)}function vi(e,o,h){var m=this.cache,w=h.allocateTextureUnit();m[0]!==w&&(e.uniform1i(this.addr,w),m[0]=w),h.setTexture2DArray(o||iT,w)}function ji(e,o,h){var m=this.cache,w=h.allocateTextureUnit();m[0]!==w&&(e.uniform1i(this.addr,w),m[0]=w),h.setTexture3D(o||nT,w)}function Fi(e,o,h){var m=this.cache,w=h.allocateTextureUnit();m[0]!==w&&(e.uniform1i(this.addr,w),m[0]=w),h.safeSetTextureCube(o||gM,w)}function vu(e,o){var h=this.cache;h[0]!==o&&(e.uniform1i(this.addr,o),h[0]=o)}function Rn(e,o){var h=this.cache;Aa(h,o)||(e.uniform2iv(this.addr,o),cs(h,o))}function vo(e,o){var h=this.cache;Aa(h,o)||(e.uniform3iv(this.addr,o),cs(h,o))}function Yu(e,o){var h=this.cache;Aa(h,o)||(e.uniform4iv(this.addr,o),cs(h,o))}function Iy(e,o){var h=this.cache;h[0]!==o&&(e.uniform1ui(this.addr,o),h[0]=o)}function Wa(e){switch(e){case 5126:return _t;case 35664:return _e;case 35665:return Yt;case 35666:return Re;case 35674:return Je;case 35675:return yi;case 35676:return ar;case 5124:case 35670:return vu;case 35667:case 35671:return Rn;case 35668:case 35672:return vo;case 35669:case 35673:return Yu;case 5125:return Iy;case 35678:case 36198:case 36298:case 36306:case 35682:return Wr;case 35679:case 36299:case 36307:return ji;case 35680:case 36300:case 36308:case 36293:return Fi;case 36289:case 36303:case 36311:case 36292:return vi}}function Rg(e,o){e.uniform1fv(this.addr,o)}function jh(e,o){e.uniform1iv(this.addr,o)}function $c(e,o){e.uniform2iv(this.addr,o)}function a2(e,o){e.uniform3iv(this.addr,o)}function Xh(e,o){e.uniform4iv(this.addr,o)}function s3(e,o){o=Wh(o,this.size,2),e.uniform2fv(this.addr,o)}function a3(e,o){o=Wh(o,this.size,3),e.uniform3fv(this.addr,o)}function u3(e,o){o=Wh(o,this.size,4),e.uniform4fv(this.addr,o)}function l3(e,o){o=Wh(o,this.size,4),e.uniformMatrix2fv(this.addr,!1,o)}function h3(e,o){o=Wh(o,this.size,9),e.uniformMatrix3fv(this.addr,!1,o)}function c3(e,o){o=Wh(o,this.size,16),e.uniformMatrix4fv(this.addr,!1,o)}function f3(e,o,h){var m=o.length,w=Ep(h,m);for(e.uniform1iv(this.addr,w),e=0;e!==m;++e)h.safeSetTexture2D(o[e]||dM,w[e])}function p3(e,o,h){var m=o.length,w=Ep(h,m);for(e.uniform1iv(this.addr,w),e=0;e!==m;++e)h.safeSetTextureCube(o[e]||gM,w[e])}function d3(e){switch(e){case 5126:return Rg;case 35664:return s3;case 35665:return a3;case 35666:return u3;case 35674:return l3;case 35675:return h3;case 35676:return c3;case 5124:case 35670:return jh;case 35667:case 35671:return $c;case 35668:case 35672:return a2;case 35669:case 35673:return Xh;case 35678:case 36198:case 36298:case 36306:case 35682:return f3;case 35680:case 36300:case 36308:case 36293:return p3}}function g3(e,o,h){this.id=e,this.addr=h,this.cache=[],this.setValue=Wa(o.type)}function w_(e,o,h){this.id=e,this.addr=h,this.cache=[],this.size=o.size,this.setValue=d3(o.type)}function __(e){this.id=e,this.seq=[],this.map={}}function tf(e,o){this.seq=[],this.map={};for(var h=e.getProgramParameter(o,35718),m=0;m<h;++m){var w=e.getActiveUniform(o,m),T=e.getUniformLocation(o,w.name),R=this,z=w.name,k=z.length;for(sw.lastIndex=0;;){var b=sw.exec(z),q=sw.lastIndex,J=b[1],Q=b[3];if(b[2]==="]"&&(J|=0),Q===void 0||Q==="["&&q+2===k){z=R,w=Q===void 0?new g3(J,w,T):new w_(J,w,T),z.seq.push(w),z.map[w.id]=w;break}else Q=R.map[J],Q===void 0&&(Q=new __(J),J=R,R=Q,J.seq.push(R),J.map[R.id]=R),R=Q}}}function M_(e,o,h){return o=e.createShader(o),e.shaderSource(o,h),e.compileShader(o),o}function C_(e){switch(e){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:throw Error("unsupported encoding: "+e)}}function T_(e,o,h){var m=e.getShaderParameter(o,35713),w=e.getShaderInfoLog(o).trim();if(m&&w==="")return"";for(e=e.getShaderSource(o).split(`
`),o=0;o<e.length;o++)e[o]=o+1+": "+e[o];return e=e.join(`
`),"THREE.WebGLShader: gl.getShaderInfoLog() "+h+`
`+w+e}function Vv(e,o){return o=C_(o),"vec4 "+e+"( vec4 value ) { return "+o[0]+"ToLinear"+o[1]+"; }"}function m3(e,o){return o=C_(o),"vec4 "+e+"( vec4 value ) { return LinearTo"+o[0]+o[1]+"; }"}function v3(e,o){switch(o){case 1:o="Linear";break;case 2:o="Reinhard";break;case 3:o="Uncharted2";break;case 4:o="OptimizedCineon";break;case 5:o="ACESFilmic";break;default:throw Error("unsupported toneMapping: "+o)}return"vec3 "+e+"( vec3 color ) { return "+o+"ToneMapping( color ); }"}function y3(e){var o=[],h;for(h in e){var m=e[h];m!==!1&&o.push("#define "+h+" "+m)}return o.join(`
`)}function Wv(e){return e!==""}function S_(e,o){return e.replace(/NUM_DIR_LIGHTS/g,o.numDirLights).replace(/NUM_SPOT_LIGHTS/g,o.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,o.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,o.numPointLights).replace(/NUM_HEMI_LIGHTS/g,o.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,o.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,o.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,o.numPointLightShadows)}function I_(e,o){return e.replace(/NUM_CLIPPING_PLANES/g,o.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,o.numClippingPlanes-o.numClipIntersection)}function u2(e,o){if(e=Hi[o],e===void 0)throw Error("Can not resolve #include <"+o+">");return e.replace(aw,u2)}function E_(e,o,h,m){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),l2(e,o,h,m)}function l2(e,o,h,m){for(e="",o=parseInt(o);o<parseInt(h);o++)e+=m.replace(/\[ i \]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return e}function L_(e){var o="precision "+e.precision+` float;
precision `+e.precision+" int;";return e.precision==="highp"?o+=`
#define HIGH_PRECISION`:e.precision==="mediump"?o+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(o+=`
#define LOW_PRECISION`),o}function x3(e){var o="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===1?o="SHADOWMAP_TYPE_PCF":e.shadowMapType===2?o="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===3&&(o="SHADOWMAP_TYPE_VSM"),o}function A3(e){var o="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case 301:case 302:o="ENVMAP_TYPE_CUBE";break;case 306:case 307:o="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:o="ENVMAP_TYPE_EQUIREC";break;case 305:o="ENVMAP_TYPE_SPHERE"}return o}function w3(e){var o="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case 302:case 304:o="ENVMAP_MODE_REFRACTION"}return o}function _3(e){var o="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:o="ENVMAP_BLENDING_MULTIPLY";break;case 1:o="ENVMAP_BLENDING_MIX";break;case 2:o="ENVMAP_BLENDING_ADD"}return o}function M3(e,o,h){var m=e.getContext(),w=h.defines,T=h.vertexShader,R=h.fragmentShader,z=x3(h),k=A3(h),b=w3(h),q=_3(h),J=0<e.gammaFactor?e.gammaFactor:1,Q=h.isWebGL2?"":[h.extensionDerivatives||h.envMapCubeUV||h.bumpMap||h.tangentSpaceNormalMap||h.clearcoatNormalMap||h.flatShading||h.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(h.extensionFragDepth||h.logarithmicDepthBuffer)&&h.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",h.extensionDrawBuffers&&h.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(h.extensionShaderTextureLOD||h.envMap)&&h.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Wv).join(`
`),K=y3(w),rt=m.createProgram();h.isRawShaderMaterial?(w=[K].filter(Wv).join(`
`),0<w.length&&(w+=`
`),z=[Q,K].filter(Wv).join(`
`),0<z.length&&(z+=`
`)):(w=[L_(h),"#define SHADER_NAME "+h.shaderName,K,h.instancing?"#define USE_INSTANCING":"",h.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+J,"#define MAX_BONES "+h.maxBones,h.useFog&&h.fog?"#define USE_FOG":"",h.useFog&&h.fogExp2?"#define FOG_EXP2":"",h.map?"#define USE_MAP":"",h.envMap?"#define USE_ENVMAP":"",h.envMap?"#define "+b:"",h.lightMap?"#define USE_LIGHTMAP":"",h.aoMap?"#define USE_AOMAP":"",h.emissiveMap?"#define USE_EMISSIVEMAP":"",h.bumpMap?"#define USE_BUMPMAP":"",h.normalMap?"#define USE_NORMALMAP":"",h.normalMap&&h.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",h.normalMap&&h.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",h.clearcoatMap?"#define USE_CLEARCOATMAP":"",h.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",h.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",h.displacementMap&&h.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",h.specularMap?"#define USE_SPECULARMAP":"",h.roughnessMap?"#define USE_ROUGHNESSMAP":"",h.metalnessMap?"#define USE_METALNESSMAP":"",h.alphaMap?"#define USE_ALPHAMAP":"",h.vertexTangents?"#define USE_TANGENT":"",h.vertexColors?"#define USE_COLOR":"",h.vertexUvs?"#define USE_UV":"",h.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",h.flatShading?"#define FLAT_SHADED":"",h.skinning?"#define USE_SKINNING":"",h.useVertexTexture?"#define BONE_TEXTURE":"",h.morphTargets?"#define USE_MORPHTARGETS":"",h.morphNormals&&h.flatShading===!1?"#define USE_MORPHNORMALS":"",h.doubleSided?"#define DOUBLE_SIDED":"",h.flipSided?"#define FLIP_SIDED":"",h.shadowMapEnabled?"#define USE_SHADOWMAP":"",h.shadowMapEnabled?"#define "+z:"",h.sizeAttenuation?"#define USE_SIZEATTENUATION":"",h.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",h.logarithmicDepthBuffer&&h.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Wv).join(`
`),z=[Q,L_(h),"#define SHADER_NAME "+h.shaderName,K,h.alphaTest?"#define ALPHATEST "+h.alphaTest+(h.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+J,h.useFog&&h.fog?"#define USE_FOG":"",h.useFog&&h.fogExp2?"#define FOG_EXP2":"",h.map?"#define USE_MAP":"",h.matcap?"#define USE_MATCAP":"",h.envMap?"#define USE_ENVMAP":"",h.envMap?"#define "+k:"",h.envMap?"#define "+b:"",h.envMap?"#define "+q:"",h.lightMap?"#define USE_LIGHTMAP":"",h.aoMap?"#define USE_AOMAP":"",h.emissiveMap?"#define USE_EMISSIVEMAP":"",h.bumpMap?"#define USE_BUMPMAP":"",h.normalMap?"#define USE_NORMALMAP":"",h.normalMap&&h.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",h.normalMap&&h.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",h.clearcoatMap?"#define USE_CLEARCOATMAP":"",h.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",h.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",h.specularMap?"#define USE_SPECULARMAP":"",h.roughnessMap?"#define USE_ROUGHNESSMAP":"",h.metalnessMap?"#define USE_METALNESSMAP":"",h.alphaMap?"#define USE_ALPHAMAP":"",h.sheen?"#define USE_SHEEN":"",h.vertexTangents?"#define USE_TANGENT":"",h.vertexColors?"#define USE_COLOR":"",h.vertexUvs?"#define USE_UV":"",h.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",h.gradientMap?"#define USE_GRADIENTMAP":"",h.flatShading?"#define FLAT_SHADED":"",h.doubleSided?"#define DOUBLE_SIDED":"",h.flipSided?"#define FLIP_SIDED":"",h.shadowMapEnabled?"#define USE_SHADOWMAP":"",h.shadowMapEnabled?"#define "+z:"",h.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",h.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",h.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",h.logarithmicDepthBuffer&&h.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(h.extensionShaderTextureLOD||h.envMap)&&h.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",h.toneMapping!==0?"#define TONE_MAPPING":"",h.toneMapping!==0?Hi.tonemapping_pars_fragment:"",h.toneMapping!==0?v3("toneMapping",h.toneMapping):"",h.dithering?"#define DITHERING":"",h.outputEncoding||h.mapEncoding||h.matcapEncoding||h.envMapEncoding||h.emissiveMapEncoding||h.lightMapEncoding?Hi.encodings_pars_fragment:"",h.mapEncoding?Vv("mapTexelToLinear",h.mapEncoding):"",h.matcapEncoding?Vv("matcapTexelToLinear",h.matcapEncoding):"",h.envMapEncoding?Vv("envMapTexelToLinear",h.envMapEncoding):"",h.emissiveMapEncoding?Vv("emissiveMapTexelToLinear",h.emissiveMapEncoding):"",h.lightMapEncoding?Vv("lightMapTexelToLinear",h.lightMapEncoding):"",h.outputEncoding?m3("linearToOutputTexel",h.outputEncoding):"",h.depthPacking?"#define DEPTH_PACKING "+h.depthPacking:"",`
`].filter(Wv).join(`
`)),T=T.replace(aw,u2),T=S_(T,h),T=I_(T,h),R=R.replace(aw,u2),R=S_(R,h),R=I_(R,h),T=T.replace(_M,l2).replace(wM,E_),R=R.replace(_M,l2).replace(wM,E_),h.isWebGL2&&!h.isRawShaderMaterial&&(k=!1,b=/^\s*#version\s+300\s+es\s*\n/,h.isShaderMaterial&&T.match(b)!==null&&R.match(b)!==null&&(k=!0,T=T.replace(b,""),R=R.replace(b,"")),w=`#version 300 es

#define attribute in
#define varying out
#define texture2D texture
`+w,z=[`#version 300 es

#define varying in`,k?"":"out highp vec4 pc_fragColor;",k?"":"#define gl_FragColor pc_fragColor",`#define gl_FragDepthEXT gl_FragDepth
#define texture2D texture
#define textureCube texture
#define texture2DProj textureProj
#define texture2DLodEXT textureLod
#define texture2DProjLodEXT textureProjLod
#define textureCubeLodEXT textureLod
#define texture2DGradEXT textureGrad
#define texture2DProjGradEXT textureProjGrad
#define textureCubeGradEXT textureGrad`].join(`
`)+`
`+z),R=z+R,T=M_(m,35633,w+T),R=M_(m,35632,R),m.attachShader(rt,T),m.attachShader(rt,R),h.index0AttributeName!==void 0?m.bindAttribLocation(rt,0,h.index0AttributeName):h.morphTargets===!0&&m.bindAttribLocation(rt,0,"position"),m.linkProgram(rt),e.debug.checkShaderErrors&&(e=m.getProgramInfoLog(rt).trim(),k=m.getShaderInfoLog(T).trim(),b=m.getShaderInfoLog(R).trim(),J=q=!0,m.getProgramParameter(rt,35714)===!1?(q=!1,Q=T_(m,T,"vertex"),K=T_(m,R,"fragment"),console.error("THREE.WebGLProgram: shader error: ",m.getError(),"35715",m.getProgramParameter(rt,35715),"gl.getProgramInfoLog",e,Q,K)):e!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",e):(k===""||b==="")&&(J=!1),J&&(this.diagnostics={runnable:q,programLog:e,vertexShader:{log:k,prefix:w},fragmentShader:{log:b,prefix:z}})),m.deleteShader(T),m.deleteShader(R);var ht;this.getUniforms=function(){return ht===void 0&&(ht=new tf(m,rt)),ht};var Ot;return this.getAttributes=function(){if(Ot===void 0){for(var jt={},Gt=m.getProgramParameter(rt,35721),ee=0;ee<Gt;ee++){var Zt=m.getActiveAttrib(rt,ee).name;jt[Zt]=m.getAttribLocation(rt,Zt)}Ot=jt}return Ot},this.destroy=function(){m.deleteProgram(rt),this.program=void 0},this.name=h.shaderName,this.id=oT++,this.cacheKey=o,this.usedTimes=1,this.program=rt,this.vertexShader=T,this.fragmentShader=R,this}function C3(e,o,h){function m(K){if(K)K.isTexture?rt=K.encoding:K.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),rt=K.texture.encoding);else var rt=3e3;return rt}var w=[],T=h.isWebGL2,R=h.logarithmicDepthBuffer,z=h.floatVertexTextures,k=h.precision,b=h.maxVertexUniforms,q=h.vertexTextures,J={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},Q="precision isWebGL2 supportsVertexTextures outputEncoding instancing map mapEncoding matcap matcapEncoding envMap envMapMode envMapEncoding envMapCubeUV lightMap lightMapEncoding aoMap emissiveMap emissiveMapEncoding bumpMap normalMap objectSpaceNormalMap tangentSpaceNormalMap clearcoatMap clearcoatRoughnessMap clearcoatNormalMap displacementMap specularMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors vertexTangents vertexUvs uvsVertexOnly fog useFog fogExp2 flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights numRectAreaLights numDirLightShadows numPointLightShadows numSpotLightShadows shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes numClipIntersection depthPacking dithering sheen".split(" ");this.getParameters=function(K,rt,ht,Ot,jt,Gt,ee){var Zt=Ot.fog;Ot=K.isMeshStandardMaterial?Ot.environment:null,Ot=K.envMap||Ot;var le=J[K.type];if(ee.isSkinnedMesh){var Wt=ee.skeleton.bones;if(z)Wt=1024;else{var Me=Math.min(Math.floor((b-20)/4),Wt.length);Me<Wt.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+Wt.length+" bones. This GPU supports "+Me+"."),Wt=0):Wt=Me}}else Wt=0;K.precision!==null&&(k=h.getMaxPrecision(K.precision),k!==K.precision&&console.warn("THREE.WebGLProgram.getParameters:",K.precision,"not supported, using",k,"instead.")),le?(Me=$l[le],Me={name:K.type,uniforms:pM.clone(Me.uniforms),vertexShader:Me.vertexShader,fragmentShader:Me.fragmentShader}):Me={name:K.type,uniforms:K.uniforms,vertexShader:K.vertexShader,fragmentShader:K.fragmentShader},K.onBeforeCompile(Me,e);var Fe=e.getRenderTarget();return{isWebGL2:T,shaderID:le,shaderName:Me.name,uniforms:Me.uniforms,vertexShader:Me.vertexShader,fragmentShader:Me.fragmentShader,defines:K.defines,isRawShaderMaterial:K.isRawShaderMaterial,isShaderMaterial:K.isShaderMaterial,precision:k,instancing:ee.isInstancedMesh===!0,supportsVertexTextures:q,outputEncoding:Fe!==null?m(Fe.texture):e.outputEncoding,map:!!K.map,mapEncoding:m(K.map),matcap:!!K.matcap,matcapEncoding:m(K.matcap),envMap:!!Ot,envMapMode:Ot&&Ot.mapping,envMapEncoding:m(Ot),envMapCubeUV:!!Ot&&(Ot.mapping===306||Ot.mapping===307),lightMap:!!K.lightMap,lightMapEncoding:m(K.lightMap),aoMap:!!K.aoMap,emissiveMap:!!K.emissiveMap,emissiveMapEncoding:m(K.emissiveMap),bumpMap:!!K.bumpMap,normalMap:!!K.normalMap,objectSpaceNormalMap:K.normalMapType===1,tangentSpaceNormalMap:K.normalMapType===0,clearcoatMap:!!K.clearcoatMap,clearcoatRoughnessMap:!!K.clearcoatRoughnessMap,clearcoatNormalMap:!!K.clearcoatNormalMap,displacementMap:!!K.displacementMap,roughnessMap:!!K.roughnessMap,metalnessMap:!!K.metalnessMap,specularMap:!!K.specularMap,alphaMap:!!K.alphaMap,gradientMap:!!K.gradientMap,sheen:!!K.sheen,combine:K.combine,vertexTangents:K.normalMap&&K.vertexTangents,vertexColors:K.vertexColors,vertexUvs:!!K.map||!!K.bumpMap||!!K.normalMap||!!K.specularMap||!!K.alphaMap||!!K.emissiveMap||!!K.roughnessMap||!!K.metalnessMap||!!K.clearcoatMap||!!K.clearcoatRoughnessMap||!!K.clearcoatNormalMap||!!K.displacementMap,uvsVertexOnly:!(K.map||K.bumpMap||K.normalMap||K.specularMap||K.alphaMap||K.emissiveMap||K.roughnessMap||K.metalnessMap||K.clearcoatNormalMap)&&!!K.displacementMap,fog:!!Zt,useFog:K.fog,fogExp2:Zt&&Zt.isFogExp2,flatShading:K.flatShading,sizeAttenuation:K.sizeAttenuation,logarithmicDepthBuffer:R,skinning:K.skinning&&0<Wt,maxBones:Wt,useVertexTexture:z,morphTargets:K.morphTargets,morphNormals:K.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:rt.directional.length,numPointLights:rt.point.length,numSpotLights:rt.spot.length,numRectAreaLights:rt.rectArea.length,numHemiLights:rt.hemi.length,numDirLightShadows:rt.directionalShadowMap.length,numPointLightShadows:rt.pointShadowMap.length,numSpotLightShadows:rt.spotShadowMap.length,numClippingPlanes:jt,numClipIntersection:Gt,dithering:K.dithering,shadowMapEnabled:e.shadowMap.enabled&&0<ht.length,shadowMapType:e.shadowMap.type,toneMapping:K.toneMapped?e.toneMapping:0,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:K.premultipliedAlpha,alphaTest:K.alphaTest,doubleSided:K.side===2,flipSided:K.side===1,depthPacking:K.depthPacking!==void 0?K.depthPacking:!1,index0AttributeName:K.index0AttributeName,extensionDerivatives:K.extensions&&K.extensions.derivatives,extensionFragDepth:K.extensions&&K.extensions.fragDepth,extensionDrawBuffers:K.extensions&&K.extensions.drawBuffers,extensionShaderTextureLOD:K.extensions&&K.extensions.shaderTextureLOD,rendererExtensionFragDepth:T||o.get("EXT_frag_depth")!==null,rendererExtensionDrawBuffers:T||o.get("WEBGL_draw_buffers")!==null,rendererExtensionShaderTextureLod:T||o.get("EXT_shader_texture_lod")!==null,onBeforeCompile:K.onBeforeCompile}},this.getProgramCacheKey=function(K){var rt=[];if(K.shaderID?rt.push(K.shaderID):(rt.push(K.fragmentShader),rt.push(K.vertexShader)),K.defines!==void 0)for(var ht in K.defines)rt.push(ht),rt.push(K.defines[ht]);if(K.isRawShaderMaterial===void 0){for(ht=0;ht<Q.length;ht++)rt.push(K[Q[ht]]);rt.push(e.outputEncoding),rt.push(e.gammaFactor)}return rt.push(K.onBeforeCompile.toString()),rt.join()},this.acquireProgram=function(K,rt){for(var ht,Ot=0,jt=w.length;Ot<jt;Ot++){var Gt=w[Ot];if(Gt.cacheKey===rt){ht=Gt,++ht.usedTimes;break}}return ht===void 0&&(ht=new M3(e,rt,K),w.push(ht)),ht},this.releaseProgram=function(K){if(--K.usedTimes==0){var rt=w.indexOf(K);w[rt]=w[w.length-1],w.pop(),K.destroy()}},this.programs=w}function T3(){var e=new An;return{get:function(o){var h=e.get(o);return h===void 0&&(h={},e.set(o,h)),h},remove:function(o){e.delete(o)},update:function(o,h,m){e.get(o)[h]=m},dispose:function(){e=new An}}}function S3(e,o){return e.groupOrder!==o.groupOrder?e.groupOrder-o.groupOrder:e.renderOrder!==o.renderOrder?e.renderOrder-o.renderOrder:e.program!==o.program?e.program.id-o.program.id:e.material.id!==o.material.id?e.material.id-o.material.id:e.z!==o.z?e.z-o.z:e.id-o.id}function I3(e,o){return e.groupOrder!==o.groupOrder?e.groupOrder-o.groupOrder:e.renderOrder!==o.renderOrder?e.renderOrder-o.renderOrder:e.z!==o.z?o.z-e.z:e.id-o.id}function R_(){function e(R,z,k,b,q,J){var Q=o[h];return Q===void 0?(Q={id:R.id,object:R,geometry:z,material:k,program:k.program||T,groupOrder:b,renderOrder:R.renderOrder,z:q,group:J},o[h]=Q):(Q.id=R.id,Q.object=R,Q.geometry=z,Q.material=k,Q.program=k.program||T,Q.groupOrder=b,Q.renderOrder=R.renderOrder,Q.z=q,Q.group=J),h++,Q}var o=[],h=0,m=[],w=[],T={id:-1};return{opaque:m,transparent:w,init:function(){h=0,m.length=0,w.length=0},push:function(R,z,k,b,q,J){R=e(R,z,k,b,q,J),(k.transparent===!0?w:m).push(R)},unshift:function(R,z,k,b,q,J){R=e(R,z,k,b,q,J),(k.transparent===!0?w:m).unshift(R)},finish:function(){for(var R=h,z=o.length;R<z;R++){var k=o[R];if(k.id===null)break;k.id=null,k.object=null,k.geometry=null,k.material=null,k.program=null,k.group=null}},sort:function(R,z){1<m.length&&m.sort(R||S3),1<w.length&&w.sort(z||I3)}}}function E3(){function e(h){h=h.target,h.removeEventListener("dispose",e),o.delete(h)}var o=new An;return{get:function(h,m){var w=o.get(h);if(w===void 0){var T=new R_;o.set(h,new An),o.get(h).set(m,T),h.addEventListener("dispose",e)}else T=w.get(m),T===void 0&&(T=new R_,w.set(m,T));return T},dispose:function(){o=new An}}}function L3(){var e={};return{get:function(o){if(e[o.id]!==void 0)return e[o.id];switch(o.type){case"DirectionalLight":var h={direction:new _,color:new yt};break;case"SpotLight":h={position:new _,direction:new _,color:new yt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":h={position:new _,color:new yt,distance:0,decay:0};break;case"HemisphereLight":h={direction:new _,skyColor:new yt,groundColor:new yt};break;case"RectAreaLight":h={color:new yt,position:new _,halfWidth:new _,halfHeight:new _}}return e[o.id]=h}}}function R3(){var e={};return{get:function(o){if(e[o.id]!==void 0)return e[o.id];switch(o.type){case"DirectionalLight":var h={shadowBias:0,shadowRadius:1,shadowMapSize:new f};break;case"SpotLight":h={shadowBias:0,shadowRadius:1,shadowMapSize:new f};break;case"PointLight":h={shadowBias:0,shadowRadius:1,shadowMapSize:new f,shadowCameraNear:1,shadowCameraFar:1e3}}return e[o.id]=h}}}function P3(e,o){return(o.castShadow?1:0)-(e.castShadow?1:0)}function D3(){for(var e=new L3,o=R3(),h={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},m=0;9>m;m++)h.probe.push(new _);var w=new _,T=new I,R=new I;return{setup:function(z,k,b){for(var q=0,J=0,Q=0,K=0;9>K;K++)h.probe[K].set(0,0,0);var rt=k=0,ht=0,Ot=0,jt=0,Gt=0,ee=0,Zt=0;b=b.matrixWorldInverse,z.sort(P3),K=0;for(var le=z.length;K<le;K++){var Wt=z[K],Me=Wt.color,Fe=Wt.intensity,fe=Wt.distance,Ne=Wt.shadow&&Wt.shadow.map?Wt.shadow.map.texture:null;if(Wt.isAmbientLight)q+=Me.r*Fe,J+=Me.g*Fe,Q+=Me.b*Fe;else if(Wt.isLightProbe)for(Ne=0;9>Ne;Ne++)h.probe[Ne].addScaledVector(Wt.sh.coefficients[Ne],Fe);else if(Wt.isDirectionalLight){var Oe=e.get(Wt);Oe.color.copy(Wt.color).multiplyScalar(Wt.intensity),Oe.direction.setFromMatrixPosition(Wt.matrixWorld),w.setFromMatrixPosition(Wt.target.matrixWorld),Oe.direction.sub(w),Oe.direction.transformDirection(b),Wt.castShadow&&(Fe=Wt.shadow,Me=o.get(Wt),Me.shadowBias=Fe.bias,Me.shadowRadius=Fe.radius,Me.shadowMapSize=Fe.mapSize,h.directionalShadow[k]=Me,h.directionalShadowMap[k]=Ne,h.directionalShadowMatrix[k]=Wt.shadow.matrix,Gt++),h.directional[k]=Oe,k++}else Wt.isSpotLight?(Oe=e.get(Wt),Oe.position.setFromMatrixPosition(Wt.matrixWorld),Oe.position.applyMatrix4(b),Oe.color.copy(Me).multiplyScalar(Fe),Oe.distance=fe,Oe.direction.setFromMatrixPosition(Wt.matrixWorld),w.setFromMatrixPosition(Wt.target.matrixWorld),Oe.direction.sub(w),Oe.direction.transformDirection(b),Oe.coneCos=Math.cos(Wt.angle),Oe.penumbraCos=Math.cos(Wt.angle*(1-Wt.penumbra)),Oe.decay=Wt.decay,Wt.castShadow&&(Fe=Wt.shadow,Me=o.get(Wt),Me.shadowBias=Fe.bias,Me.shadowRadius=Fe.radius,Me.shadowMapSize=Fe.mapSize,h.spotShadow[ht]=Me,h.spotShadowMap[ht]=Ne,h.spotShadowMatrix[ht]=Wt.shadow.matrix,Zt++),h.spot[ht]=Oe,ht++):Wt.isRectAreaLight?(Oe=e.get(Wt),Oe.color.copy(Me).multiplyScalar(Fe),Oe.position.setFromMatrixPosition(Wt.matrixWorld),Oe.position.applyMatrix4(b),R.identity(),T.copy(Wt.matrixWorld),T.premultiply(b),R.extractRotation(T),Oe.halfWidth.set(.5*Wt.width,0,0),Oe.halfHeight.set(0,.5*Wt.height,0),Oe.halfWidth.applyMatrix4(R),Oe.halfHeight.applyMatrix4(R),h.rectArea[Ot]=Oe,Ot++):Wt.isPointLight?(Oe=e.get(Wt),Oe.position.setFromMatrixPosition(Wt.matrixWorld),Oe.position.applyMatrix4(b),Oe.color.copy(Wt.color).multiplyScalar(Wt.intensity),Oe.distance=Wt.distance,Oe.decay=Wt.decay,Wt.castShadow&&(Fe=Wt.shadow,Me=o.get(Wt),Me.shadowBias=Fe.bias,Me.shadowRadius=Fe.radius,Me.shadowMapSize=Fe.mapSize,Me.shadowCameraNear=Fe.camera.near,Me.shadowCameraFar=Fe.camera.far,h.pointShadow[rt]=Me,h.pointShadowMap[rt]=Ne,h.pointShadowMatrix[rt]=Wt.shadow.matrix,ee++),h.point[rt]=Oe,rt++):Wt.isHemisphereLight&&(Oe=e.get(Wt),Oe.direction.setFromMatrixPosition(Wt.matrixWorld),Oe.direction.transformDirection(b),Oe.direction.normalize(),Oe.skyColor.copy(Wt.color).multiplyScalar(Fe),Oe.groundColor.copy(Wt.groundColor).multiplyScalar(Fe),h.hemi[jt]=Oe,jt++)}h.ambient[0]=q,h.ambient[1]=J,h.ambient[2]=Q,z=h.hash,(z.directionalLength!==k||z.pointLength!==rt||z.spotLength!==ht||z.rectAreaLength!==Ot||z.hemiLength!==jt||z.numDirectionalShadows!==Gt||z.numPointShadows!==ee||z.numSpotShadows!==Zt)&&(h.directional.length=k,h.spot.length=ht,h.rectArea.length=Ot,h.point.length=rt,h.hemi.length=jt,h.directionalShadow.length=Gt,h.directionalShadowMap.length=Gt,h.pointShadow.length=ee,h.pointShadowMap.length=ee,h.spotShadow.length=Zt,h.spotShadowMap.length=Zt,h.directionalShadowMatrix.length=Gt,h.pointShadowMatrix.length=ee,h.spotShadowMatrix.length=Zt,z.directionalLength=k,z.pointLength=rt,z.spotLength=ht,z.rectAreaLength=Ot,z.hemiLength=jt,z.numDirectionalShadows=Gt,z.numPointShadows=ee,z.numSpotShadows=Zt,h.version=sT++)},state:h}}function P_(){var e=new D3,o=[],h=[];return{init:function(){o.length=0,h.length=0},state:{lightsArray:o,shadowsArray:h,lights:e},setupLights:function(m){e.setup(o,h,m)},pushLight:function(m){o.push(m)},pushShadow:function(m){h.push(m)}}}function O3(){function e(h){h=h.target,h.removeEventListener("dispose",e),o.delete(h)}var o=new An;return{get:function(h,m){if(o.has(h)===!1){var w=new P_;o.set(h,new An),o.get(h).set(m,w),h.addEventListener("dispose",e)}else o.get(h).has(m)===!1?(w=new P_,o.get(h).set(m,w)):w=o.get(h).get(m);return w},dispose:function(){o=new An}}}function ef(e){Kt.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}function rf(e){Kt.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new _,this.nearDistance=1,this.farDistance=1e3,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}function D_(e,o,h){function m(Zt,le,Wt){Wt=Zt<<0|le<<1|Wt<<2;var Me=J[Wt];return Me===void 0&&(Me=new ef({depthPacking:3201,morphTargets:Zt,skinning:le}),J[Wt]=Me),Me}function w(Zt,le,Wt){Wt=Zt<<0|le<<1|Wt<<2;var Me=Q[Wt];return Me===void 0&&(Me=new rf({morphTargets:Zt,skinning:le}),Q[Wt]=Me),Me}function T(Zt,le,Wt,Me,Fe,fe,Ne){var Oe=m,vr=Zt.customDepthMaterial;return Me.isPointLight===!0&&(Oe=w,vr=Zt.customDistanceMaterial),vr===void 0?(vr=!1,Wt.morphTargets===!0&&(vr=le.morphAttributes&&le.morphAttributes.position&&0<le.morphAttributes.position.length),le=!1,Zt.isSkinnedMesh===!0&&(Wt.skinning===!0?le=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",Zt)),Zt=Oe(vr,le,Zt.isInstancedMesh===!0)):Zt=vr,e.localClippingEnabled&&Wt.clipShadows===!0&&Wt.clippingPlanes.length!==0&&(vr=Zt.uuid,Oe=Wt.uuid,le=K[vr],le===void 0&&(le={},K[vr]=le),vr=le[Oe],vr===void 0&&(vr=Zt.clone(),le[Oe]=vr),Zt=vr),Zt.visible=Wt.visible,Zt.wireframe=Wt.wireframe,Zt.side=Ne===3?Wt.shadowSide!==null?Wt.shadowSide:Wt.side:Wt.shadowSide!==null?Wt.shadowSide:rt[Wt.side],Zt.clipShadows=Wt.clipShadows,Zt.clippingPlanes=Wt.clippingPlanes,Zt.clipIntersection=Wt.clipIntersection,Zt.wireframeLinewidth=Wt.wireframeLinewidth,Zt.linewidth=Wt.linewidth,Me.isPointLight===!0&&Zt.isMeshDistanceMaterial===!0&&(Zt.referencePosition.setFromMatrixPosition(Me.matrixWorld),Zt.nearDistance=Fe,Zt.farDistance=fe),Zt}function R(Zt,le,Wt,Me,Fe){if(Zt.visible!==!1){if(Zt.layers.test(le.layers)&&(Zt.isMesh||Zt.isLine||Zt.isPoints)&&(Zt.castShadow||Zt.receiveShadow&&Fe===3)&&(!Zt.frustumCulled||z.intersectsObject(Zt))){Zt.modelViewMatrix.multiplyMatrices(Wt.matrixWorldInverse,Zt.matrixWorld);var fe=o.update(Zt),Ne=Zt.material;if(Array.isArray(Ne))for(var Oe=fe.groups,vr=0,jr=Oe.length;vr<jr;vr++){var er=Oe[vr],Hr=Ne[er.materialIndex];Hr&&Hr.visible&&(Hr=T(Zt,fe,Hr,Me,Wt.near,Wt.far,Fe),e.renderBufferDirect(Wt,null,fe,Hr,Zt,er))}else Ne.visible&&(Hr=T(Zt,fe,Ne,Me,Wt.near,Wt.far,Fe),e.renderBufferDirect(Wt,null,fe,Hr,Zt,null))}for(Zt=Zt.children,fe=0,Ne=Zt.length;fe<Ne;fe++)R(Zt[fe],le,Wt,Me,Fe)}}var z=new nr,k=new f,b=new f,q=new p,J=[],Q=[],K={},rt={0:1,1:0,2:2},ht=new de({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:.125},uniforms:{shadow_pass:{value:null},resolution:{value:new f},radius:{value:4}},vertexShader:`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
  float mean = 0.0;
  float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );
  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
    #ifdef HORIZONAL_PASS
      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
      mean += distribution.x;
      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
    #else
      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );
      mean += depth;
      squared_mean += depth * depth;
    #endif
  }
  mean = mean * HALF_SAMPLE_RATE;
  squared_mean = squared_mean * HALF_SAMPLE_RATE;
  float std_dev = sqrt( squared_mean - mean * mean );
  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`}),Ot=ht.clone();Ot.defines.HORIZONAL_PASS=1;var jt=new ft;jt.setAttribute("position",new ae(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var Gt=new Tt(jt,ht),ee=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(Zt,le,Wt){if(ee.enabled!==!1&&(ee.autoUpdate!==!1||ee.needsUpdate!==!1)&&Zt.length!==0){var Me=e.getRenderTarget(),Fe=e.getActiveCubeFace(),fe=e.getActiveMipmapLevel(),Ne=e.state;Ne.setBlending(0),Ne.buffers.color.setClear(1,1,1,1),Ne.buffers.depth.setTest(!0),Ne.setScissorTest(!1);for(var Oe=0,vr=Zt.length;Oe<vr;Oe++){var jr=Zt[Oe],er=jr.shadow;if(er===void 0)console.warn("THREE.WebGLShadowMap:",jr,"has no shadow.");else{k.copy(er.mapSize);var Hr=er.getFrameExtents();k.multiply(Hr),b.copy(er.mapSize),(k.x>h||k.y>h)&&(k.x>h&&(b.x=Math.floor(h/Hr.x),k.x=b.x*Hr.x,er.mapSize.x=b.x),k.y>h&&(b.y=Math.floor(h/Hr.y),k.y=b.y*Hr.y,er.mapSize.y=b.y)),er.map!==null||er.isPointLightShadow||this.type!==3||(Hr={minFilter:1006,magFilter:1006,format:1023},er.map=new A(k.x,k.y,Hr),er.map.texture.name=jr.name+".shadowMap",er.mapPass=new A(k.x,k.y,Hr),er.camera.updateProjectionMatrix()),er.map===null&&(Hr={minFilter:1003,magFilter:1003,format:1023},er.map=new A(k.x,k.y,Hr),er.map.texture.name=jr.name+".shadowMap",er.camera.updateProjectionMatrix()),e.setRenderTarget(er.map),e.clear(),Hr=er.getViewportCount();for(var xi=0;xi<Hr;xi++){var ni=er.getViewport(xi);q.set(b.x*ni.x,b.y*ni.y,b.x*ni.z,b.y*ni.w),Ne.viewport(q),er.updateMatrices(jr,xi),z=er.getFrustum(),R(le,Wt,er.camera,jr,this.type)}er.isPointLightShadow||this.type!==3||(jr=er,er=Wt,Hr=o.update(Gt),ht.uniforms.shadow_pass.value=jr.map.texture,ht.uniforms.resolution.value=jr.mapSize,ht.uniforms.radius.value=jr.radius,e.setRenderTarget(jr.mapPass),e.clear(),e.renderBufferDirect(er,null,Hr,ht,Gt,null),Ot.uniforms.shadow_pass.value=jr.mapPass.texture,Ot.uniforms.resolution.value=jr.mapSize,Ot.uniforms.radius.value=jr.radius,e.setRenderTarget(jr.map),e.clear(),e.renderBufferDirect(er,null,Hr,Ot,Gt,null))}}ee.needsUpdate=!1,e.setRenderTarget(Me,Fe,fe)}}}function F3(e,o,h){function m(Ut,Ve,dr){var Yr=new Uint8Array(4),xr=e.createTexture();for(e.bindTexture(Ut,xr),e.texParameteri(Ut,10241,9728),e.texParameteri(Ut,10240,9728),Ut=0;Ut<dr;Ut++)e.texImage2D(Ve+Ut,0,6408,1,1,0,6408,5121,Yr);return xr}function w(Ut,Ve){Ot[Ut]=1,jt[Ut]===0&&(e.enableVertexAttribArray(Ut),jt[Ut]=1),Gt[Ut]!==Ve&&((Q?e:o.get("ANGLE_instanced_arrays"))[Q?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Ut,Ve),Gt[Ut]=Ve)}function T(Ut){ee[Ut]!==!0&&(e.enable(Ut),ee[Ut]=!0)}function R(Ut){ee[Ut]!==!1&&(e.disable(Ut),ee[Ut]=!1)}function z(Ut,Ve,dr,Yr,xr,or,sr,ui){if(Ut===0)le&&(R(3042),le=!1);else if(le||(T(3042),le=!0),Ut!==5){if(Ut!==Wt||ui!==jr){if((Me!==100||Ne!==100)&&(e.blendEquation(32774),Ne=Me=100),ui)switch(Ut){case 1:e.blendFuncSeparate(1,771,1,771);break;case 2:e.blendFunc(1,1);break;case 3:e.blendFuncSeparate(0,0,769,771);break;case 4:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ut)}else switch(Ut){case 1:e.blendFuncSeparate(770,771,1,771);break;case 2:e.blendFunc(770,1);break;case 3:e.blendFunc(0,769);break;case 4:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ut)}vr=Oe=fe=Fe=null,Wt=Ut,jr=ui}}else xr=xr||Ve,or=or||dr,sr=sr||Yr,(Ve!==Me||xr!==Ne)&&(e.blendEquationSeparate(ur[Ve],ur[xr]),Me=Ve,Ne=xr),(dr!==Fe||Yr!==fe||or!==Oe||sr!==vr)&&(e.blendFuncSeparate(Ee[dr],Ee[Yr],Ee[or],Ee[sr]),Fe=dr,fe=Yr,Oe=or,vr=sr),Wt=Ut,jr=null}function k(Ut){er!==Ut&&(Ut?e.frontFace(2304):e.frontFace(2305),er=Ut)}function b(Ut){Ut!==0?(T(2884),Ut!==Hr&&(Ut===1?e.cullFace(1029):Ut===2?e.cullFace(1028):e.cullFace(1032))):R(2884),Hr=Ut}function q(Ut,Ve,dr){Ut?(T(32823),(ni!==Ve||Bi!==dr)&&(e.polygonOffset(Ve,dr),ni=Ve,Bi=dr)):R(32823)}function J(Ut){Ut===void 0&&(Ut=33984+Mi-1),Tn!==Ut&&(e.activeTexture(Ut),Tn=Ut)}var Q=h.isWebGL2,K=new function(){var Ut=!1,Ve=new p,dr=null,Yr=new p(0,0,0,0);return{setMask:function(xr){dr===xr||Ut||(e.colorMask(xr,xr,xr,xr),dr=xr)},setLocked:function(xr){Ut=xr},setClear:function(xr,or,sr,ui,Yn){Yn===!0&&(xr*=ui,or*=ui,sr*=ui),Ve.set(xr,or,sr,ui),Yr.equals(Ve)===!1&&(e.clearColor(xr,or,sr,ui),Yr.copy(Ve))},reset:function(){Ut=!1,dr=null,Yr.set(-1,0,0,0)}}},rt=new function(){var Ut=!1,Ve=null,dr=null,Yr=null;return{setTest:function(xr){xr?T(2929):R(2929)},setMask:function(xr){Ve===xr||Ut||(e.depthMask(xr),Ve=xr)},setFunc:function(xr){if(dr!==xr){if(xr)switch(xr){case 0:e.depthFunc(512);break;case 1:e.depthFunc(519);break;case 2:e.depthFunc(513);break;case 3:e.depthFunc(515);break;case 4:e.depthFunc(514);break;case 5:e.depthFunc(518);break;case 6:e.depthFunc(516);break;case 7:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);dr=xr}},setLocked:function(xr){Ut=xr},setClear:function(xr){Yr!==xr&&(e.clearDepth(xr),Yr=xr)},reset:function(){Ut=!1,Yr=dr=Ve=null}}},ht=new function(){var Ut=!1,Ve=null,dr=null,Yr=null,xr=null,or=null,sr=null,ui=null,Yn=null;return{setTest:function(hi){Ut||(hi?T(2960):R(2960))},setMask:function(hi){Ve===hi||Ut||(e.stencilMask(hi),Ve=hi)},setFunc:function(hi,Pe,li){(dr!==hi||Yr!==Pe||xr!==li)&&(e.stencilFunc(hi,Pe,li),dr=hi,Yr=Pe,xr=li)},setOp:function(hi,Pe,li){(or!==hi||sr!==Pe||ui!==li)&&(e.stencilOp(hi,Pe,li),or=hi,sr=Pe,ui=li)},setLocked:function(hi){Ut=hi},setClear:function(hi){Yn!==hi&&(e.clearStencil(hi),Yn=hi)},reset:function(){Ut=!1,Yn=ui=sr=or=xr=Yr=dr=Ve=null}}};h=e.getParameter(34921);var Ot=new Uint8Array(h),jt=new Uint8Array(h),Gt=new Uint8Array(h),ee={},Zt=null,le=null,Wt=null,Me=null,Fe=null,fe=null,Ne=null,Oe=null,vr=null,jr=!1,er=null,Hr=null,xi=null,ni=null,Bi=null,Mi=e.getParameter(35661),ln=!1;h=0,h=e.getParameter(7938),h.indexOf("WebGL")!==-1?(h=parseFloat(/^WebGL ([0-9])/.exec(h)[1]),ln=1<=h):h.indexOf("OpenGL ES")!==-1&&(h=parseFloat(/^OpenGL ES ([0-9])/.exec(h)[1]),ln=2<=h);var Tn=null,wt={},Bt=new p,ve=new p,He={};He[3553]=m(3553,3553,1),He[34067]=m(34067,34069,6),K.setClear(0,0,0,1),rt.setClear(1),ht.setClear(0),T(2929),rt.setFunc(3),k(!1),b(1),T(2884),z(0);var ur={100:32774,101:32778,102:32779};Q?(ur[103]=32775,ur[104]=32776):(h=o.get("EXT_blend_minmax"),h!==null&&(ur[103]=h.MIN_EXT,ur[104]=h.MAX_EXT));var Ee={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};return{buffers:{color:K,depth:rt,stencil:ht},initAttributes:function(){for(var Ut=0,Ve=Ot.length;Ut<Ve;Ut++)Ot[Ut]=0},enableAttribute:function(Ut){w(Ut,0)},enableAttributeAndDivisor:w,disableUnusedAttributes:function(){for(var Ut=0,Ve=jt.length;Ut!==Ve;++Ut)jt[Ut]!==Ot[Ut]&&(e.disableVertexAttribArray(Ut),jt[Ut]=0)},vertexAttribPointer:function(Ut,Ve,dr,Yr,xr,or){Q!==!0||dr!==5124&&dr!==5125?e.vertexAttribPointer(Ut,Ve,dr,Yr,xr,or):e.vertexAttribIPointer(Ut,Ve,dr,Yr,xr,or)},enable:T,disable:R,useProgram:function(Ut){return Zt!==Ut?(e.useProgram(Ut),Zt=Ut,!0):!1},setBlending:z,setMaterial:function(Ut,Ve){Ut.side===2?R(2884):T(2884);var dr=Ut.side===1;Ve&&(dr=!dr),k(dr),Ut.blending===1&&Ut.transparent===!1?z(0):z(Ut.blending,Ut.blendEquation,Ut.blendSrc,Ut.blendDst,Ut.blendEquationAlpha,Ut.blendSrcAlpha,Ut.blendDstAlpha,Ut.premultipliedAlpha),rt.setFunc(Ut.depthFunc),rt.setTest(Ut.depthTest),rt.setMask(Ut.depthWrite),K.setMask(Ut.colorWrite),Ve=Ut.stencilWrite,ht.setTest(Ve),Ve&&(ht.setMask(Ut.stencilWriteMask),ht.setFunc(Ut.stencilFunc,Ut.stencilRef,Ut.stencilFuncMask),ht.setOp(Ut.stencilFail,Ut.stencilZFail,Ut.stencilZPass)),q(Ut.polygonOffset,Ut.polygonOffsetFactor,Ut.polygonOffsetUnits)},setFlipSided:k,setCullFace:b,setLineWidth:function(Ut){Ut!==xi&&(ln&&e.lineWidth(Ut),xi=Ut)},setPolygonOffset:q,setScissorTest:function(Ut){Ut?T(3089):R(3089)},activeTexture:J,bindTexture:function(Ut,Ve){Tn===null&&J();var dr=wt[Tn];dr===void 0&&(dr={type:void 0,texture:void 0},wt[Tn]=dr),(dr.type!==Ut||dr.texture!==Ve)&&(e.bindTexture(Ut,Ve||He[Ut]),dr.type=Ut,dr.texture=Ve)},unbindTexture:function(){var Ut=wt[Tn];Ut!==void 0&&Ut.type!==void 0&&(e.bindTexture(Ut.type,null),Ut.type=void 0,Ut.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(Ut){console.error("THREE.WebGLState:",Ut)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(Ut){console.error("THREE.WebGLState:",Ut)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(Ut){console.error("THREE.WebGLState:",Ut)}},scissor:function(Ut){Bt.equals(Ut)===!1&&(e.scissor(Ut.x,Ut.y,Ut.z,Ut.w),Bt.copy(Ut))},viewport:function(Ut){ve.equals(Ut)===!1&&(e.viewport(Ut.x,Ut.y,Ut.z,Ut.w),ve.copy(Ut))},reset:function(){for(var Ut=0;Ut<jt.length;Ut++)jt[Ut]===1&&(e.disableVertexAttribArray(Ut),jt[Ut]=0);ee={},Tn=null,wt={},Hr=er=Wt=Zt=null,K.reset(),rt.reset(),ht.reset()}}}function B3(e,o,h,m,w,T,R){function z(wt,Bt){return xi?new OffscreenCanvas(wt,Bt):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function k(wt,Bt,ve,He){var ur=1;if((wt.width>He||wt.height>He)&&(ur=He/Math.max(wt.width,wt.height)),1>ur||Bt===!0){if(typeof HTMLImageElement!="undefined"&&wt instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&wt instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&wt instanceof ImageBitmap)return He=Bt?Si.floorPowerOfTwo:Math.floor,Bt=He(ur*wt.width),ur=He(ur*wt.height),Hr===void 0&&(Hr=z(Bt,ur)),ve=ve?z(Bt,ur):Hr,ve.width=Bt,ve.height=ur,ve.getContext("2d").drawImage(wt,0,0,Bt,ur),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+wt.width+"x"+wt.height+") to ("+Bt+"x"+ur+")."),ve;"data"in wt&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+wt.width+"x"+wt.height+").")}return wt}function b(wt){return Si.isPowerOfTwo(wt.width)&&Si.isPowerOfTwo(wt.height)}function q(wt,Bt){return wt.generateMipmaps&&Bt&&wt.minFilter!==1003&&wt.minFilter!==1006}function J(wt,Bt,ve,He){e.generateMipmap(wt),m.get(Bt).__maxMipLevel=Math.log(Math.max(ve,He))*Math.LOG2E}function Q(wt,Bt,ve){if(fe===!1)return Bt;if(wt!==null){if(e[wt]!==void 0)return e[wt];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+wt+"'")}return wt=Bt,Bt===6403&&(ve===5126&&(wt=33326),ve===5131&&(wt=33325),ve===5121&&(wt=33321)),Bt===6407&&(ve===5126&&(wt=34837),ve===5131&&(wt=34843),ve===5121&&(wt=32849)),Bt===6408&&(ve===5126&&(wt=34836),ve===5131&&(wt=34842),ve===5121&&(wt=32856)),wt!==33325&&wt!==33326&&wt!==34842&&wt!==34836||o.get("EXT_color_buffer_float"),wt}function K(wt){return wt===1003||wt===1004||wt===1005?9728:9729}function rt(wt){wt=wt.target,wt.removeEventListener("dispose",rt);var Bt=m.get(wt);Bt.__webglInit!==void 0&&(e.deleteTexture(Bt.__webglTexture),m.remove(wt)),wt.isVideoTexture&&er.delete(wt),R.memory.textures--}function ht(wt){wt=wt.target,wt.removeEventListener("dispose",ht);var Bt=m.get(wt),ve=m.get(wt.texture);if(wt){if(ve.__webglTexture!==void 0&&e.deleteTexture(ve.__webglTexture),wt.depthTexture&&wt.depthTexture.dispose(),wt.isWebGLCubeRenderTarget)for(ve=0;6>ve;ve++)e.deleteFramebuffer(Bt.__webglFramebuffer[ve]),Bt.__webglDepthbuffer&&e.deleteRenderbuffer(Bt.__webglDepthbuffer[ve]);else e.deleteFramebuffer(Bt.__webglFramebuffer),Bt.__webglDepthbuffer&&e.deleteRenderbuffer(Bt.__webglDepthbuffer),Bt.__webglMultisampledFramebuffer&&e.deleteFramebuffer(Bt.__webglMultisampledFramebuffer),Bt.__webglColorRenderbuffer&&e.deleteRenderbuffer(Bt.__webglColorRenderbuffer),Bt.__webglDepthRenderbuffer&&e.deleteRenderbuffer(Bt.__webglDepthRenderbuffer);m.remove(wt.texture),m.remove(wt)}R.memory.textures--}function Ot(wt,Bt){var ve=m.get(wt);if(wt.isVideoTexture){var He=R.render.frame;er.get(wt)!==He&&(er.set(wt,He),wt.update())}if(0<wt.version&&ve.__version!==wt.version)if(He=wt.image,He===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(He.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{le(ve,wt,Bt);return}h.activeTexture(33984+Bt),h.bindTexture(3553,ve.__webglTexture)}function jt(wt,Bt){if(wt.image.length===6){var ve=m.get(wt);if(0<wt.version&&ve.__version!==wt.version){Zt(ve,wt),h.activeTexture(33984+Bt),h.bindTexture(34067,ve.__webglTexture),e.pixelStorei(37440,wt.flipY);var He=wt&&(wt.isCompressedTexture||wt.image[0].isCompressedTexture);Bt=wt.image[0]&&wt.image[0].isDataTexture;for(var ur=[],Ee=0;6>Ee;Ee++)ur[Ee]=He||Bt?Bt?wt.image[Ee].image:wt.image[Ee]:k(wt.image[Ee],!1,!0,Oe);var Ut=ur[0],Ve=b(Ut)||fe,dr=T.convert(wt.format),Yr=T.convert(wt.type),xr=Q(wt.internalFormat,dr,Yr);if(ee(34067,wt,Ve),He){for(Ee=0;6>Ee;Ee++){var or=ur[Ee].mipmaps;for(He=0;He<or.length;He++){var sr=or[He];wt.format!==1023&&wt.format!==1022?dr!==null?h.compressedTexImage2D(34069+Ee,He,xr,sr.width,sr.height,0,sr.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):h.texImage2D(34069+Ee,He,xr,sr.width,sr.height,0,dr,Yr,sr.data)}}ve.__maxMipLevel=or.length-1}else{for(or=wt.mipmaps,Ee=0;6>Ee;Ee++)if(Bt)for(h.texImage2D(34069+Ee,0,xr,ur[Ee].width,ur[Ee].height,0,dr,Yr,ur[Ee].data),He=0;He<or.length;He++)sr=or[He],sr=sr.image[Ee].image,h.texImage2D(34069+Ee,He+1,xr,sr.width,sr.height,0,dr,Yr,sr.data);else for(h.texImage2D(34069+Ee,0,xr,dr,Yr,ur[Ee]),He=0;He<or.length;He++)sr=or[He],h.texImage2D(34069+Ee,He+1,xr,dr,Yr,sr.image[Ee]);ve.__maxMipLevel=or.length}q(wt,Ve)&&J(34067,wt,Ut.width,Ut.height),ve.__version=wt.version,wt.onUpdate&&wt.onUpdate(wt)}else h.activeTexture(33984+Bt),h.bindTexture(34067,ve.__webglTexture)}}function Gt(wt,Bt){h.activeTexture(33984+Bt),h.bindTexture(34067,m.get(wt).__webglTexture)}function ee(wt,Bt,ve){ve?(e.texParameteri(wt,10242,Bi[Bt.wrapS]),e.texParameteri(wt,10243,Bi[Bt.wrapT]),wt!==32879&&wt!==35866||e.texParameteri(wt,32882,Bi[Bt.wrapR]),e.texParameteri(wt,10240,Mi[Bt.magFilter]),e.texParameteri(wt,10241,Mi[Bt.minFilter])):(e.texParameteri(wt,10242,33071),e.texParameteri(wt,10243,33071),wt!==32879&&wt!==35866||e.texParameteri(wt,32882,33071),Bt.wrapS===1001&&Bt.wrapT===1001||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(wt,10240,K(Bt.magFilter)),e.texParameteri(wt,10241,K(Bt.minFilter)),Bt.minFilter!==1003&&Bt.minFilter!==1006&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!(ve=o.get("EXT_texture_filter_anisotropic"))||Bt.type===1015&&o.get("OES_texture_float_linear")===null||Bt.type===1016&&(fe||o.get("OES_texture_half_float_linear"))===null||!(1<Bt.anisotropy||m.get(Bt).__currentAnisotropy)||(e.texParameterf(wt,ve.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Bt.anisotropy,w.getMaxAnisotropy())),m.get(Bt).__currentAnisotropy=Bt.anisotropy)}function Zt(wt,Bt){wt.__webglInit===void 0&&(wt.__webglInit=!0,Bt.addEventListener("dispose",rt),wt.__webglTexture=e.createTexture(),R.memory.textures++)}function le(wt,Bt,ve){var He=3553;Bt.isDataTexture2DArray&&(He=35866),Bt.isDataTexture3D&&(He=32879),Zt(wt,Bt),h.activeTexture(33984+ve),h.bindTexture(He,wt.__webglTexture),e.pixelStorei(37440,Bt.flipY),e.pixelStorei(37441,Bt.premultiplyAlpha),e.pixelStorei(3317,Bt.unpackAlignment),ve=fe?!1:Bt.wrapS!==1001||Bt.wrapT!==1001||Bt.minFilter!==1003&&Bt.minFilter!==1006,ve=ve&&b(Bt.image)===!1,ve=k(Bt.image,ve,!1,vr);var ur=b(ve)||fe,Ee=T.convert(Bt.format),Ut=T.convert(Bt.type),Ve=Q(Bt.internalFormat,Ee,Ut);ee(He,Bt,ur);var dr=Bt.mipmaps;if(Bt.isDepthTexture)Ve=6402,fe?Ve=Bt.type===1015?36012:Bt.type===1014?33190:Bt.type===1020?35056:33189:Bt.type===1015&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Bt.format===1026&&Ve===6402&&Bt.type!==1012&&Bt.type!==1014&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Bt.type=1012,Ut=T.convert(Bt.type)),Bt.format===1027&&Ve===6402&&(Ve=34041,Bt.type!==1020&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Bt.type=1020,Ut=T.convert(Bt.type))),h.texImage2D(3553,0,Ve,ve.width,ve.height,0,Ee,Ut,null);else if(Bt.isDataTexture)if(0<dr.length&&ur){for(var Yr=0,xr=dr.length;Yr<xr;Yr++){var or=dr[Yr];h.texImage2D(3553,Yr,Ve,or.width,or.height,0,Ee,Ut,or.data)}Bt.generateMipmaps=!1,wt.__maxMipLevel=dr.length-1}else h.texImage2D(3553,0,Ve,ve.width,ve.height,0,Ee,Ut,ve.data),wt.__maxMipLevel=0;else if(Bt.isCompressedTexture){for(Yr=0,xr=dr.length;Yr<xr;Yr++)or=dr[Yr],Bt.format!==1023&&Bt.format!==1022?Ee!==null?h.compressedTexImage2D(3553,Yr,Ve,or.width,or.height,0,or.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):h.texImage2D(3553,Yr,Ve,or.width,or.height,0,Ee,Ut,or.data);wt.__maxMipLevel=dr.length-1}else if(Bt.isDataTexture2DArray)h.texImage3D(35866,0,Ve,ve.width,ve.height,ve.depth,0,Ee,Ut,ve.data),wt.__maxMipLevel=0;else if(Bt.isDataTexture3D)h.texImage3D(32879,0,Ve,ve.width,ve.height,ve.depth,0,Ee,Ut,ve.data),wt.__maxMipLevel=0;else if(0<dr.length&&ur){for(Yr=0,xr=dr.length;Yr<xr;Yr++)or=dr[Yr],h.texImage2D(3553,Yr,Ve,Ee,Ut,or);Bt.generateMipmaps=!1,wt.__maxMipLevel=dr.length-1}else h.texImage2D(3553,0,Ve,Ee,Ut,ve),wt.__maxMipLevel=0;q(Bt,ur)&&J(He,Bt,ve.width,ve.height),wt.__version=Bt.version,Bt.onUpdate&&Bt.onUpdate(Bt)}function Wt(wt,Bt,ve,He){var ur=T.convert(Bt.texture.format),Ee=T.convert(Bt.texture.type),Ut=Q(Bt.texture.internalFormat,ur,Ee);h.texImage2D(He,0,Ut,Bt.width,Bt.height,0,ur,Ee,null),e.bindFramebuffer(36160,wt),e.framebufferTexture2D(36160,ve,He,m.get(Bt.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function Me(wt,Bt,ve){if(e.bindRenderbuffer(36161,wt),Bt.depthBuffer&&!Bt.stencilBuffer){var He=33189;ve?((ve=Bt.depthTexture)&&ve.isDepthTexture&&(ve.type===1015?He=36012:ve.type===1014&&(He=33190)),ve=Fe(Bt),e.renderbufferStorageMultisample(36161,ve,He,Bt.width,Bt.height)):e.renderbufferStorage(36161,He,Bt.width,Bt.height),e.framebufferRenderbuffer(36160,36096,36161,wt)}else Bt.depthBuffer&&Bt.stencilBuffer?(ve?(ve=Fe(Bt),e.renderbufferStorageMultisample(36161,ve,35056,Bt.width,Bt.height)):e.renderbufferStorage(36161,34041,Bt.width,Bt.height),e.framebufferRenderbuffer(36160,33306,36161,wt)):(wt=T.convert(Bt.texture.format),He=T.convert(Bt.texture.type),He=Q(Bt.texture.internalFormat,wt,He),ve?(ve=Fe(Bt),e.renderbufferStorageMultisample(36161,ve,He,Bt.width,Bt.height)):e.renderbufferStorage(36161,He,Bt.width,Bt.height));e.bindRenderbuffer(36161,null)}function Fe(wt){return fe&&wt.isWebGLMultisampleRenderTarget?Math.min(jr,wt.samples):0}var fe=w.isWebGL2,Ne=w.maxTextures,Oe=w.maxCubemapSize,vr=w.maxTextureSize,jr=w.maxSamples,er=new An,Hr,xi=!1;try{xi=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch(wt){}var ni=0,Bi={1e3:10497,1001:33071,1002:33648},Mi={1003:9728,1004:9984,1005:9986,1006:9729,1007:9985,1008:9987},ln=!1,Tn=!1;this.allocateTextureUnit=function(){var wt=ni;return wt>=Ne&&console.warn("THREE.WebGLTextures: Trying to use "+wt+" texture units while this GPU supports only "+Ne),ni+=1,wt},this.resetTextureUnits=function(){ni=0},this.setTexture2D=Ot,this.setTexture2DArray=function(wt,Bt){var ve=m.get(wt);0<wt.version&&ve.__version!==wt.version?le(ve,wt,Bt):(h.activeTexture(33984+Bt),h.bindTexture(35866,ve.__webglTexture))},this.setTexture3D=function(wt,Bt){var ve=m.get(wt);0<wt.version&&ve.__version!==wt.version?le(ve,wt,Bt):(h.activeTexture(33984+Bt),h.bindTexture(32879,ve.__webglTexture))},this.setTextureCube=jt,this.setTextureCubeDynamic=Gt,this.setupRenderTarget=function(wt){var Bt=m.get(wt),ve=m.get(wt.texture);wt.addEventListener("dispose",ht),ve.__webglTexture=e.createTexture(),R.memory.textures++;var He=wt.isWebGLCubeRenderTarget===!0,ur=wt.isWebGLMultisampleRenderTarget===!0,Ee=b(wt)||fe;if(!fe||wt.texture.format!==1022||wt.texture.type!==1015&&wt.texture.type!==1016||(wt.texture.format=1023,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),He)for(Bt.__webglFramebuffer=[],ur=0;6>ur;ur++)Bt.__webglFramebuffer[ur]=e.createFramebuffer();else if(Bt.__webglFramebuffer=e.createFramebuffer(),ur)if(fe){Bt.__webglMultisampledFramebuffer=e.createFramebuffer(),Bt.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,Bt.__webglColorRenderbuffer),ur=T.convert(wt.texture.format);var Ut=T.convert(wt.texture.type);ur=Q(wt.texture.internalFormat,ur,Ut),Ut=Fe(wt),e.renderbufferStorageMultisample(36161,Ut,ur,wt.width,wt.height),e.bindFramebuffer(36160,Bt.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,Bt.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),wt.depthBuffer&&(Bt.__webglDepthRenderbuffer=e.createRenderbuffer(),Me(Bt.__webglDepthRenderbuffer,wt,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(He){for(h.bindTexture(34067,ve.__webglTexture),ee(34067,wt.texture,Ee),ur=0;6>ur;ur++)Wt(Bt.__webglFramebuffer[ur],wt,36064,34069+ur);q(wt.texture,Ee)&&J(34067,wt.texture,wt.width,wt.height),h.bindTexture(34067,null)}else h.bindTexture(3553,ve.__webglTexture),ee(3553,wt.texture,Ee),Wt(Bt.__webglFramebuffer,wt,36064,3553),q(wt.texture,Ee)&&J(3553,wt.texture,wt.width,wt.height),h.bindTexture(3553,null);if(wt.depthBuffer){if(Bt=m.get(wt),ve=wt.isWebGLCubeRenderTarget===!0,wt.depthTexture){if(ve)throw Error("target.depthTexture not supported in Cube render targets");if(wt&&wt.isWebGLCubeRenderTarget)throw Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,Bt.__webglFramebuffer),!wt.depthTexture||!wt.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");if(m.get(wt.depthTexture).__webglTexture&&wt.depthTexture.image.width===wt.width&&wt.depthTexture.image.height===wt.height||(wt.depthTexture.image.width=wt.width,wt.depthTexture.image.height=wt.height,wt.depthTexture.needsUpdate=!0),Ot(wt.depthTexture,0),Bt=m.get(wt.depthTexture).__webglTexture,wt.depthTexture.format===1026)e.framebufferTexture2D(36160,36096,3553,Bt,0);else if(wt.depthTexture.format===1027)e.framebufferTexture2D(36160,33306,3553,Bt,0);else throw Error("Unknown depthTexture format")}else if(ve)for(Bt.__webglDepthbuffer=[],ve=0;6>ve;ve++)e.bindFramebuffer(36160,Bt.__webglFramebuffer[ve]),Bt.__webglDepthbuffer[ve]=e.createRenderbuffer(),Me(Bt.__webglDepthbuffer[ve],wt,!1);else e.bindFramebuffer(36160,Bt.__webglFramebuffer),Bt.__webglDepthbuffer=e.createRenderbuffer(),Me(Bt.__webglDepthbuffer,wt,!1);e.bindFramebuffer(36160,null)}},this.updateRenderTargetMipmap=function(wt){var Bt=wt.texture,ve=b(wt)||fe;if(q(Bt,ve)){ve=wt.isWebGLCubeRenderTarget?34067:3553;var He=m.get(Bt).__webglTexture;h.bindTexture(ve,He),J(ve,Bt,wt.width,wt.height),h.bindTexture(ve,null)}},this.updateMultisampleRenderTarget=function(wt){if(wt.isWebGLMultisampleRenderTarget)if(fe){var Bt=m.get(wt);e.bindFramebuffer(36008,Bt.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,Bt.__webglFramebuffer);var ve=wt.width,He=wt.height,ur=16384;wt.depthBuffer&&(ur|=256),wt.stencilBuffer&&(ur|=1024),e.blitFramebuffer(0,0,ve,He,0,0,ve,He,ur,9728),e.bindFramebuffer(36160,Bt.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(wt,Bt){wt&&wt.isWebGLRenderTarget&&(ln===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),ln=!0),wt=wt.texture),Ot(wt,Bt)},this.safeSetTextureCube=function(wt,Bt){wt&&wt.isWebGLCubeRenderTarget&&(Tn===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Tn=!0),wt=wt.texture),wt&&wt.isCubeTexture||Array.isArray(wt.image)&&wt.image.length===6?jt(wt,Bt):Gt(wt,Bt)}}function O_(e,o,h){var m=h.isWebGL2;return{convert:function(w){if(w===1009)return 5121;if(w===1017)return 32819;if(w===1018)return 32820;if(w===1019)return 33635;if(w===1010)return 5120;if(w===1011)return 5122;if(w===1012)return 5123;if(w===1013)return 5124;if(w===1014)return 5125;if(w===1015)return 5126;if(w===1016){if(m)return 5131;var T=o.get("OES_texture_half_float");return T!==null?T.HALF_FLOAT_OES:null}if(w===1021)return 6406;if(w===1022)return 6407;if(w===1023)return 6408;if(w===1024)return 6409;if(w===1025)return 6410;if(w===1026)return 6402;if(w===1027)return 34041;if(w===1028)return 6403;if(w===1029)return 36244;if(w===1030)return 33319;if(w===1031)return 33320;if(w===1032)return 36248;if(w===1033)return 36249;if(w===33776||w===33777||w===33778||w===33779)if(T=o.get("WEBGL_compressed_texture_s3tc"),T!==null){if(w===33776)return T.COMPRESSED_RGB_S3TC_DXT1_EXT;if(w===33777)return T.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(w===33778)return T.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(w===33779)return T.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(w===35840||w===35841||w===35842||w===35843)if(T=o.get("WEBGL_compressed_texture_pvrtc"),T!==null){if(w===35840)return T.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(w===35841)return T.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(w===35842)return T.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(w===35843)return T.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(w===36196)return T=o.get("WEBGL_compressed_texture_etc1"),T!==null?T.COMPRESSED_RGB_ETC1_WEBGL:null;if((w===37492||w===37496)&&(T=o.get("WEBGL_compressed_texture_etc"),T!==null)){if(w===37492)return T.COMPRESSED_RGB8_ETC2;if(w===37496)return T.COMPRESSED_RGBA8_ETC2_EAC}if(w===37808||w===37809||w===37810||w===37811||w===37812||w===37813||w===37814||w===37815||w===37816||w===37817||w===37818||w===37819||w===37820||w===37821||w===37840||w===37841||w===37842||w===37843||w===37844||w===37845||w===37846||w===37847||w===37848||w===37849||w===37850||w===37851||w===37852||w===37853)return T=o.get("WEBGL_compressed_texture_astc"),T!==null?w:null;if(w===36492)return T=o.get("EXT_texture_compression_bptc"),T!==null?w:null;if(w===1020)return m?34042:(T=o.get("WEBGL_depth_texture"),T!==null?T.UNSIGNED_INT_24_8_WEBGL:null)}}}function Ey(e){Te.call(this),this.cameras=e||[]}function Pg(){F.call(this),this.type="Group"}function Ly(){this._grip=this._targetRay=null}function F_(e,o){function h(fe){var Ne=rt.get(fe.inputSource);Ne&&Ne.dispatchEvent({type:fe.type})}function m(){rt.forEach(function(fe,Ne){fe.disconnect(Ne)}),rt.clear(),e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),Fe.stop(),z.isPresenting=!1,z.dispatchEvent({type:"sessionend"})}function w(fe){q=fe,Fe.setContext(k),Fe.start(),z.isPresenting=!0,z.dispatchEvent({type:"sessionstart"})}function T(fe){for(var Ne=k.inputSources,Oe=0;Oe<K.length;Oe++)rt.set(Ne[Oe],K[Oe]);for(Oe=0;Oe<fe.removed.length;Oe++){Ne=fe.removed[Oe];var vr=rt.get(Ne);vr&&(vr.dispatchEvent({type:"disconnected",data:Ne}),rt.delete(Ne))}for(Oe=0;Oe<fe.added.length;Oe++)Ne=fe.added[Oe],(vr=rt.get(Ne))&&vr.dispatchEvent({type:"connected",data:Ne})}function R(fe,Ne){Ne===null?fe.matrixWorld.copy(fe.matrix):fe.matrixWorld.multiplyMatrices(Ne.matrixWorld,fe.matrix),fe.matrixWorldInverse.getInverse(fe.matrixWorld)}var z=this,k=null,b=1,q=null,J="local-floor",Q=null,K=[],rt=new yv,ht=new Te;ht.layers.enable(1),ht.viewport=new p;var Ot=new Te;Ot.layers.enable(2),Ot.viewport=new p;var jt=[ht,Ot],Gt=new Ey;Gt.layers.enable(1),Gt.layers.enable(2);var ee=null,Zt=null;this.isPresenting=this.enabled=!1,this.getController=function(fe){var Ne=K[fe];return Ne===void 0&&(Ne=new Ly,K[fe]=Ne),Ne.getTargetRaySpace()},this.getControllerGrip=function(fe){var Ne=K[fe];return Ne===void 0&&(Ne=new Ly,K[fe]=Ne),Ne.getGripSpace()},this.setFramebufferScaleFactor=function(fe){b=fe,z.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(fe){J=fe,z.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return q},this.getSession=function(){return k},this.setSession=function(fe){k=fe,k!==null&&(k.addEventListener("select",h),k.addEventListener("selectstart",h),k.addEventListener("selectend",h),k.addEventListener("squeeze",h),k.addEventListener("squeezestart",h),k.addEventListener("squeezeend",h),k.addEventListener("end",m),fe=o.getContextAttributes(),fe.xrCompatible!==!0&&o.makeXRCompatible(),fe=new XRWebGLLayer(k,o,{antialias:fe.antialias,alpha:fe.alpha,depth:fe.depth,stencil:fe.stencil,framebufferScaleFactor:b}),k.updateRenderState({baseLayer:fe}),k.requestReferenceSpace(J).then(w),k.addEventListener("inputsourceschange",T))};var le=new _,Wt=new _;this.getCamera=function(fe){Gt.near=Ot.near=ht.near=fe.near,Gt.far=Ot.far=ht.far=fe.far,(ee!==Gt.near||Zt!==Gt.far)&&(k.updateRenderState({depthNear:Gt.near,depthFar:Gt.far}),ee=Gt.near,Zt=Gt.far);var Ne=fe.parent,Oe=Gt.cameras;R(Gt,Ne);for(var vr=0;vr<Oe.length;vr++)R(Oe[vr],Ne);for(fe.matrixWorld.copy(Gt.matrixWorld),fe=fe.children,vr=0,Ne=fe.length;vr<Ne;vr++)fe[vr].updateMatrixWorld(!0);if(Oe.length===2){le.setFromMatrixPosition(ht.matrixWorld),Wt.setFromMatrixPosition(Ot.matrixWorld),Oe=le.distanceTo(Wt);var jr=ht.projectionMatrix.elements,er=Ot.projectionMatrix.elements,Hr=jr[14]/(jr[10]-1);vr=jr[14]/(jr[10]+1),fe=(jr[9]+1)/jr[5],Ne=(jr[9]-1)/jr[5];var xi=(jr[8]-1)/jr[0],ni=(er[8]+1)/er[0];er=Hr*xi,jr=Hr*ni,ni=Oe/(-xi+ni),xi=ni*-xi,ht.matrixWorld.decompose(Gt.position,Gt.quaternion,Gt.scale),Gt.translateX(xi),Gt.translateZ(ni),Gt.matrixWorld.compose(Gt.position,Gt.quaternion,Gt.scale),Gt.matrixWorldInverse.getInverse(Gt.matrixWorld),Hr+=ni,ni=vr+ni,Gt.projectionMatrix.makePerspective(er-xi,jr+(Oe-xi),fe*vr/ni*Hr,Ne*vr/ni*Hr,Hr,ni)}else Gt.projectionMatrix.copy(ht.projectionMatrix);return Gt};var Me=null,Fe=new Jr;Fe.setAnimationLoop(function(fe,Ne){if(Q=Ne.getViewerPose(q),Q!==null){var Oe=Q.views,vr=k.renderState.baseLayer;e.setFramebuffer(vr.framebuffer);var jr=!1;Oe.length!==Gt.cameras.length&&(Gt.cameras.length=0,jr=!0);for(var er=0;er<Oe.length;er++){var Hr=Oe[er],xi=vr.getViewport(Hr),ni=jt[er];ni.matrix.fromArray(Hr.transform.matrix),ni.projectionMatrix.fromArray(Hr.projectionMatrix),ni.viewport.set(xi.x,xi.y,xi.width,xi.height),er===0&&Gt.matrix.copy(ni.matrix),jr===!0&&Gt.cameras.push(ni)}}for(Oe=k.inputSources,er=0;er<K.length;er++)K[er].update(Oe[er],Ne,q);Me&&Me(fe,Ne)}),this.setAnimationLoop=function(fe){Me=fe},this.dispose=function(){}}function N3(e){function o(m,w,T){if(m.opacity.value=w.opacity,w.color&&m.diffuse.value.copy(w.color),w.emissive&&m.emissive.value.copy(w.emissive).multiplyScalar(w.emissiveIntensity),w.map&&(m.map.value=w.map),w.alphaMap&&(m.alphaMap.value=w.alphaMap),w.specularMap&&(m.specularMap.value=w.specularMap),(T=w.envMap||T)&&(m.envMap.value=T,m.flipEnvMap.value=T.isCubeTexture?-1:1,m.reflectivity.value=w.reflectivity,m.refractionRatio.value=w.refractionRatio,m.maxMipLevel.value=e.get(T).__maxMipLevel),w.lightMap&&(m.lightMap.value=w.lightMap,m.lightMapIntensity.value=w.lightMapIntensity),w.aoMap&&(m.aoMap.value=w.aoMap,m.aoMapIntensity.value=w.aoMapIntensity),w.map)var R=w.map;else w.specularMap?R=w.specularMap:w.displacementMap?R=w.displacementMap:w.normalMap?R=w.normalMap:w.bumpMap?R=w.bumpMap:w.roughnessMap?R=w.roughnessMap:w.metalnessMap?R=w.metalnessMap:w.alphaMap?R=w.alphaMap:w.emissiveMap&&(R=w.emissiveMap);if(R!==void 0&&(R.isWebGLRenderTarget&&(R=R.texture),R.matrixAutoUpdate===!0&&R.updateMatrix(),m.uvTransform.value.copy(R.matrix)),w.aoMap)var z=w.aoMap;else w.lightMap&&(z=w.lightMap);z!==void 0&&(z.isWebGLRenderTarget&&(z=z.texture),z.matrixAutoUpdate===!0&&z.updateMatrix(),m.uv2Transform.value.copy(z.matrix))}function h(m,w,T){m.roughness.value=w.roughness,m.metalness.value=w.metalness,w.roughnessMap&&(m.roughnessMap.value=w.roughnessMap),w.metalnessMap&&(m.metalnessMap.value=w.metalnessMap),w.emissiveMap&&(m.emissiveMap.value=w.emissiveMap),w.bumpMap&&(m.bumpMap.value=w.bumpMap,m.bumpScale.value=w.bumpScale,w.side===1&&(m.bumpScale.value*=-1)),w.normalMap&&(m.normalMap.value=w.normalMap,m.normalScale.value.copy(w.normalScale),w.side===1&&m.normalScale.value.negate()),w.displacementMap&&(m.displacementMap.value=w.displacementMap,m.displacementScale.value=w.displacementScale,m.displacementBias.value=w.displacementBias),(w.envMap||T)&&(m.envMapIntensity.value=w.envMapIntensity)}return{refreshFogUniforms:function(m,w){m.fogColor.value.copy(w.color),w.isFog?(m.fogNear.value=w.near,m.fogFar.value=w.far):w.isFogExp2&&(m.fogDensity.value=w.density)},refreshMaterialUniforms:function(m,w,T,R,z){if(w.isMeshBasicMaterial)o(m,w);else if(w.isMeshLambertMaterial)o(m,w),w.emissiveMap&&(m.emissiveMap.value=w.emissiveMap);else if(w.isMeshToonMaterial)o(m,w),m.specular.value.copy(w.specular),m.shininess.value=Math.max(w.shininess,1e-4),w.gradientMap&&(m.gradientMap.value=w.gradientMap),w.emissiveMap&&(m.emissiveMap.value=w.emissiveMap),w.bumpMap&&(m.bumpMap.value=w.bumpMap,m.bumpScale.value=w.bumpScale,w.side===1&&(m.bumpScale.value*=-1)),w.normalMap&&(m.normalMap.value=w.normalMap,m.normalScale.value.copy(w.normalScale),w.side===1&&m.normalScale.value.negate()),w.displacementMap&&(m.displacementMap.value=w.displacementMap,m.displacementScale.value=w.displacementScale,m.displacementBias.value=w.displacementBias);else if(w.isMeshPhongMaterial)o(m,w),m.specular.value.copy(w.specular),m.shininess.value=Math.max(w.shininess,1e-4),w.emissiveMap&&(m.emissiveMap.value=w.emissiveMap),w.bumpMap&&(m.bumpMap.value=w.bumpMap,m.bumpScale.value=w.bumpScale,w.side===1&&(m.bumpScale.value*=-1)),w.normalMap&&(m.normalMap.value=w.normalMap,m.normalScale.value.copy(w.normalScale),w.side===1&&m.normalScale.value.negate()),w.displacementMap&&(m.displacementMap.value=w.displacementMap,m.displacementScale.value=w.displacementScale,m.displacementBias.value=w.displacementBias);else if(w.isMeshStandardMaterial)o(m,w,T),w.isMeshPhysicalMaterial?(h(m,w,T),m.reflectivity.value=w.reflectivity,m.clearcoat.value=w.clearcoat,m.clearcoatRoughness.value=w.clearcoatRoughness,w.sheen&&m.sheen.value.copy(w.sheen),w.clearcoatMap&&(m.clearcoatMap.value=w.clearcoatMap),w.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=w.clearcoatRoughnessMap),w.clearcoatNormalMap&&(m.clearcoatNormalScale.value.copy(w.clearcoatNormalScale),m.clearcoatNormalMap.value=w.clearcoatNormalMap,w.side===1&&m.clearcoatNormalScale.value.negate()),m.transparency.value=w.transparency):h(m,w,T);else if(w.isMeshMatcapMaterial)o(m,w),w.matcap&&(m.matcap.value=w.matcap),w.bumpMap&&(m.bumpMap.value=w.bumpMap,m.bumpScale.value=w.bumpScale,w.side===1&&(m.bumpScale.value*=-1)),w.normalMap&&(m.normalMap.value=w.normalMap,m.normalScale.value.copy(w.normalScale),w.side===1&&m.normalScale.value.negate()),w.displacementMap&&(m.displacementMap.value=w.displacementMap,m.displacementScale.value=w.displacementScale,m.displacementBias.value=w.displacementBias);else if(w.isMeshDepthMaterial)o(m,w),w.displacementMap&&(m.displacementMap.value=w.displacementMap,m.displacementScale.value=w.displacementScale,m.displacementBias.value=w.displacementBias);else if(w.isMeshDistanceMaterial)o(m,w),w.displacementMap&&(m.displacementMap.value=w.displacementMap,m.displacementScale.value=w.displacementScale,m.displacementBias.value=w.displacementBias),m.referencePosition.value.copy(w.referencePosition),m.nearDistance.value=w.nearDistance,m.farDistance.value=w.farDistance;else if(w.isMeshNormalMaterial)o(m,w),w.bumpMap&&(m.bumpMap.value=w.bumpMap,m.bumpScale.value=w.bumpScale,w.side===1&&(m.bumpScale.value*=-1)),w.normalMap&&(m.normalMap.value=w.normalMap,m.normalScale.value.copy(w.normalScale),w.side===1&&m.normalScale.value.negate()),w.displacementMap&&(m.displacementMap.value=w.displacementMap,m.displacementScale.value=w.displacementScale,m.displacementBias.value=w.displacementBias);else if(w.isLineBasicMaterial)m.diffuse.value.copy(w.color),m.opacity.value=w.opacity,w.isLineDashedMaterial&&(m.dashSize.value=w.dashSize,m.totalSize.value=w.dashSize+w.gapSize,m.scale.value=w.scale);else if(w.isPointsMaterial){if(m.diffuse.value.copy(w.color),m.opacity.value=w.opacity,m.size.value=w.size*R,m.scale.value=.5*z,w.map&&(m.map.value=w.map),w.alphaMap&&(m.alphaMap.value=w.alphaMap),w.map)var k=w.map;else w.alphaMap&&(k=w.alphaMap);k!==void 0&&(k.matrixAutoUpdate===!0&&k.updateMatrix(),m.uvTransform.value.copy(k.matrix))}else if(w.isSpriteMaterial){if(m.diffuse.value.copy(w.color),m.opacity.value=w.opacity,m.rotation.value=w.rotation,w.map&&(m.map.value=w.map),w.alphaMap&&(m.alphaMap.value=w.alphaMap),w.map)var b=w.map;else w.alphaMap&&(b=w.alphaMap);b!==void 0&&(b.matrixAutoUpdate===!0&&b.updateMatrix(),m.uvTransform.value.copy(b.matrix))}else w.isShadowMaterial?(m.color.value.copy(w.color),m.opacity.value=w.opacity):w.isShaderMaterial&&(w.uniformsNeedUpdate=!1)}}}function h2(e){var o;function h(){li=new Wl(Pe),Ii=new Vh(Pe,li,e),Ii.isWebGL2===!1&&(li.get("WEBGL_depth_texture"),li.get("OES_texture_float"),li.get("OES_texture_half_float"),li.get("OES_texture_half_float_linear"),li.get("OES_standard_derivatives"),li.get("OES_element_index_uint"),li.get("ANGLE_instanced_arrays")),li.get("OES_texture_float_linear"),oc=new O_(Pe,li,Ii),Zr=new F3(Pe,li,Ii),Zr.scissor(wt.copy(dr).multiplyScalar(ur).floor()),Zr.viewport(Tn.copy(Ve).multiplyScalar(ur).floor()),Us=new Xu(Pe),Fo=new T3,nl=new B3(Pe,li,Zr,Fo,Ii,oc,Us),wm=new je(Pe,Ii),_w=new jl(Pe,wm,Us),_m=new Sy(Pe,_w,wm,Us),$M=new Ty(Pe),Mm=new C3(fe,li,Ii),Mw=new N3(Fo),Wx=new E3,Cm=new O3,vf=new hs(fe,Zr,_m,ee),tC=new gu(Pe,li,Us,Ii),eC=new ta(Pe,li,Us,Ii),Us.programs=Mm.programs,fe.capabilities=Ii,fe.extensions=li,fe.properties=Fo,fe.renderLists=Wx,fe.state=Zr,fe.info=Us}function m(Mt){Mt.preventDefault(),Ne=!0}function w(){Ne=!1,h()}function T(Mt){Mt=Mt.target,Mt.removeEventListener("dispose",T),R(Mt),Fo.remove(Mt)}function R(Mt){var Se=Fo.get(Mt).program;Mt.program=void 0,Se!==void 0&&Mm.releaseProgram(Se)}function z(Mt,Se){Mt.render(function(qt){fe.renderBufferImmediate(qt,Se)})}function k(Mt,Se,qt,De){if(Mt.visible!==!1){if(Mt.layers.test(Se.layers)){if(Mt.isGroup)qt=Mt.renderOrder;else if(Mt.isLOD)Mt.autoUpdate===!0&&Mt.update(Se);else if(Mt.isLight)Fe.pushLight(Mt),Mt.castShadow&&Fe.pushShadow(Mt);else if(Mt.isSprite){if(!Mt.frustumCulled||xr.intersectsSprite(Mt)){De&&hi.setFromMatrixPosition(Mt.matrixWorld).applyMatrix4(Yn);var tr=_m.update(Mt),Ei=Mt.material;Ei.visible&&Me.push(Mt,tr,Ei,qt,hi.z,null)}}else if(Mt.isImmediateRenderObject)De&&hi.setFromMatrixPosition(Mt.matrixWorld).applyMatrix4(Yn),Me.push(Mt,null,Mt.material,qt,hi.z,null);else if((Mt.isMesh||Mt.isLine||Mt.isPoints)&&(Mt.isSkinnedMesh&&Mt.skeleton.frame!==Us.render.frame&&(Mt.skeleton.update(),Mt.skeleton.frame=Us.render.frame),!Mt.frustumCulled||xr.intersectsObject(Mt)))if(De&&hi.setFromMatrixPosition(Mt.matrixWorld).applyMatrix4(Yn),tr=_m.update(Mt),Ei=Mt.material,Array.isArray(Ei))for(var pr=tr.groups,Kr=0,Ci=pr.length;Kr<Ci;Kr++){var Qi=pr[Kr],bi=Ei[Qi.materialIndex];bi&&bi.visible&&Me.push(Mt,tr,bi,qt,hi.z,Qi)}else Ei.visible&&Me.push(Mt,tr,Ei,qt,hi.z,null)}for(Mt=Mt.children,Kr=0,Ci=Mt.length;Kr<Ci;Kr++)k(Mt[Kr],Se,qt,De)}}function b(Mt,Se,qt,De){for(var tr=0,Ei=Mt.length;tr<Ei;tr++){var pr=Mt[tr],Kr=pr.object,Ci=pr.geometry,Qi=De===void 0?pr.material:De;if(pr=pr.group,qt.isArrayCamera){ln=qt;for(var bi=qt.cameras,rh=0,Zn=bi.length;rh<Zn;rh++){var Bo=bi[rh];Kr.layers.test(Bo.layers)&&(Zr.viewport(Tn.copy(Bo.viewport)),Fe.setupLights(Bo),q(Kr,Se,Bo,Ci,Qi,pr))}}else ln=null,q(Kr,Se,qt,Ci,Qi,pr)}}function q(Mt,Se,qt,De,tr,Ei){if(Mt.onBeforeRender(fe,Se,qt,De,tr,Ei),Fe=Cm.get(Se,ln||qt),Mt.modelViewMatrix.multiplyMatrices(qt.matrixWorldInverse,Mt.matrixWorld),Mt.normalMatrix.getNormalMatrix(Mt.modelViewMatrix),Mt.isImmediateRenderObject){var pr=Q(qt,Se,tr,Mt);Zr.setMaterial(tr),ni=o=null,Bi=!1,z(Mt,pr)}else fe.renderBufferDirect(qt,Se,De,tr,Mt,Ei);Mt.onAfterRender(fe,Se,qt,De,tr,Ei),Fe=Cm.get(Se,ln||qt)}function J(Mt,Se,qt){var De=Fo.get(Mt),tr=Fe.state.lights,Ei=tr.state.version;qt=Mm.getParameters(Mt,tr.state,Fe.state.shadowsArray,Se,or.numPlanes,or.numIntersection,qt);var pr=Mm.getProgramCacheKey(qt),Kr=De.program,Ci=!0;if(Kr===void 0)Mt.addEventListener("dispose",T);else if(Kr.cacheKey!==pr)R(Mt);else{if(De.lightsStateVersion!==Ei)De.lightsStateVersion=Ei;else if(qt.shaderID!==void 0)return;Ci=!1}if(Ci&&(Kr=Mm.acquireProgram(qt,pr),De.program=Kr,De.uniforms=qt.uniforms,De.outputEncoding=qt.outputEncoding,Mt.program=Kr),qt=Kr.getAttributes(),Mt.morphTargets)for(pr=Mt.numSupportedMorphTargets=0;pr<fe.maxMorphTargets;pr++)0<=qt["morphTarget"+pr]&&Mt.numSupportedMorphTargets++;if(Mt.morphNormals)for(pr=Mt.numSupportedMorphNormals=0;pr<fe.maxMorphNormals;pr++)0<=qt["morphNormal"+pr]&&Mt.numSupportedMorphNormals++;qt=De.uniforms,(!Mt.isShaderMaterial&&!Mt.isRawShaderMaterial||Mt.clipping===!0)&&(De.numClippingPlanes=or.numPlanes,De.numIntersection=or.numIntersection,qt.clippingPlanes=or.uniform),De.environment=Mt.isMeshStandardMaterial?Se.environment:null,De.fog=Se.fog,De.needsLights=Mt.isMeshLambertMaterial||Mt.isMeshToonMaterial||Mt.isMeshPhongMaterial||Mt.isMeshStandardMaterial||Mt.isShadowMaterial||Mt.isShaderMaterial&&Mt.lights===!0,De.lightsStateVersion=Ei,De.needsLights&&(qt.ambientLightColor.value=tr.state.ambient,qt.lightProbe.value=tr.state.probe,qt.directionalLights.value=tr.state.directional,qt.directionalLightShadows.value=tr.state.directionalShadow,qt.spotLights.value=tr.state.spot,qt.spotLightShadows.value=tr.state.spotShadow,qt.rectAreaLights.value=tr.state.rectArea,qt.pointLights.value=tr.state.point,qt.pointLightShadows.value=tr.state.pointShadow,qt.hemisphereLights.value=tr.state.hemi,qt.directionalShadowMap.value=tr.state.directionalShadowMap,qt.directionalShadowMatrix.value=tr.state.directionalShadowMatrix,qt.spotShadowMap.value=tr.state.spotShadowMap,qt.spotShadowMatrix.value=tr.state.spotShadowMatrix,qt.pointShadowMap.value=tr.state.pointShadowMap,qt.pointShadowMatrix.value=tr.state.pointShadowMatrix),Mt=De.program.getUniforms(),Mt=tf.seqWithValue(Mt.seq,qt),De.uniformsList=Mt}function Q(Mt,Se,qt,De){nl.resetTextureUnits();var tr=Se.fog,Ei=qt.isMeshStandardMaterial?Se.environment:null,pr=er===null?fe.outputEncoding:er.texture.encoding,Kr=Fo.get(qt),Ci=Fe.state.lights;sr&&(ui||Mt!==Mi)&&or.setState(qt.clippingPlanes,qt.clipIntersection,qt.clipShadows,Mt,Kr,Mt===Mi&&qt.id===xi),qt.version===Kr.__version?Kr.program===void 0||qt.fog&&Kr.fog!==tr||Kr.environment!==Ei||Kr.needsLights&&Kr.lightsStateVersion!==Ci.state.version?J(qt,Se,De):Kr.numClippingPlanes===void 0||Kr.numClippingPlanes===or.numPlanes&&Kr.numIntersection===or.numIntersection?Kr.outputEncoding!==pr&&J(qt,Se,De):J(qt,Se,De):(J(qt,Se,De),Kr.__version=qt.version);var Qi=!1,bi=!1,rh=!1;if(Se=Kr.program,pr=Se.getUniforms(),Ci=Kr.uniforms,Zr.useProgram(Se.program)&&(rh=bi=Qi=!0),qt.id!==xi&&(xi=qt.id,bi=!0),(Qi||Mi!==Mt)&&(pr.setValue(Pe,"projectionMatrix",Mt.projectionMatrix),Ii.logarithmicDepthBuffer&&pr.setValue(Pe,"logDepthBufFC",2/(Math.log(Mt.far+1)/Math.LN2)),Mi!==Mt&&(Mi=Mt,rh=bi=!0),(qt.isShaderMaterial||qt.isMeshPhongMaterial||qt.isMeshToonMaterial||qt.isMeshStandardMaterial||qt.envMap)&&(Qi=pr.map.cameraPosition,Qi!==void 0&&Qi.setValue(Pe,hi.setFromMatrixPosition(Mt.matrixWorld))),(qt.isMeshPhongMaterial||qt.isMeshToonMaterial||qt.isMeshLambertMaterial||qt.isMeshBasicMaterial||qt.isMeshStandardMaterial||qt.isShaderMaterial)&&pr.setValue(Pe,"isOrthographic",Mt.isOrthographicCamera===!0),(qt.isMeshPhongMaterial||qt.isMeshToonMaterial||qt.isMeshLambertMaterial||qt.isMeshBasicMaterial||qt.isMeshStandardMaterial||qt.isShaderMaterial||qt.skinning)&&pr.setValue(Pe,"viewMatrix",Mt.matrixWorldInverse)),qt.skinning&&(pr.setOptional(Pe,De,"bindMatrix"),pr.setOptional(Pe,De,"bindMatrixInverse"),Mt=De.skeleton))if(Qi=Mt.bones,Ii.floatVertexTextures){if(Mt.boneTexture===void 0){Qi=Math.sqrt(4*Qi.length),Qi=Si.ceilPowerOfTwo(Qi),Qi=Math.max(Qi,4);var Zn=new Float32Array(Qi*Qi*4);Zn.set(Mt.boneMatrices);var Bo=new we(Zn,Qi,Qi,1023,1015);Mt.boneMatrices=Zn,Mt.boneTexture=Bo,Mt.boneTextureSize=Qi}pr.setValue(Pe,"boneTexture",Mt.boneTexture,nl),pr.setValue(Pe,"boneTextureSize",Mt.boneTextureSize)}else pr.setOptional(Pe,Mt,"boneMatrices");return(bi||Kr.receiveShadow!==De.receiveShadow)&&(Kr.receiveShadow=De.receiveShadow,pr.setValue(Pe,"receiveShadow",De.receiveShadow)),bi&&(pr.setValue(Pe,"toneMappingExposure",fe.toneMappingExposure),pr.setValue(Pe,"toneMappingWhitePoint",fe.toneMappingWhitePoint),Kr.needsLights&&(bi=rh,Ci.ambientLightColor.needsUpdate=bi,Ci.lightProbe.needsUpdate=bi,Ci.directionalLights.needsUpdate=bi,Ci.directionalLightShadows.needsUpdate=bi,Ci.pointLights.needsUpdate=bi,Ci.pointLightShadows.needsUpdate=bi,Ci.spotLights.needsUpdate=bi,Ci.spotLightShadows.needsUpdate=bi,Ci.rectAreaLights.needsUpdate=bi,Ci.hemisphereLights.needsUpdate=bi),tr&&qt.fog&&Mw.refreshFogUniforms(Ci,tr),Mw.refreshMaterialUniforms(Ci,qt,Ei,ur,He),Ci.ltc_1!==void 0&&(Ci.ltc_1.value=cr.LTC_1),Ci.ltc_2!==void 0&&(Ci.ltc_2.value=cr.LTC_2),tf.upload(Pe,Kr.uniformsList,Ci,nl)),qt.isShaderMaterial&&qt.uniformsNeedUpdate===!0&&(tf.upload(Pe,Kr.uniformsList,Ci,nl),qt.uniformsNeedUpdate=!1),qt.isSpriteMaterial&&pr.setValue(Pe,"center",De.center),pr.setValue(Pe,"modelViewMatrix",De.modelViewMatrix),pr.setValue(Pe,"normalMatrix",De.normalMatrix),pr.setValue(Pe,"modelMatrix",De.matrixWorld),Se}e=e||{};var K=e.canvas!==void 0?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),rt=e.context!==void 0?e.context:null,ht=e.alpha!==void 0?e.alpha:!1,Ot=e.depth!==void 0?e.depth:!0,jt=e.stencil!==void 0?e.stencil:!0,Gt=e.antialias!==void 0?e.antialias:!1,ee=e.premultipliedAlpha!==void 0?e.premultipliedAlpha:!0,Zt=e.preserveDrawingBuffer!==void 0?e.preserveDrawingBuffer:!1,le=e.powerPreference!==void 0?e.powerPreference:"default",Wt=e.failIfMajorPerformanceCaveat!==void 0?e.failIfMajorPerformanceCaveat:!1,Me=null,Fe=null;this.domElement=K,this.debug={checkShaderErrors:!0},this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=3e3,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingWhitePoint=this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var fe=this,Ne=!1,Oe=null,vr=0,jr=0,er=null,Hr=null,xi=-1,ni=o=null,Bi=!1,Mi=null,ln=null,Tn=new p,wt=new p,Bt=null,ve=K.width,He=K.height,ur=1,Ee=null,Ut=null,Ve=new p(0,0,ve,He),dr=new p(0,0,ve,He),Yr=!1,xr=new nr,or=new xa,sr=!1,ui=!1,Yn=new I,hi=new _;try{ht={alpha:ht,depth:Ot,stencil:jt,antialias:Gt,premultipliedAlpha:ee,preserveDrawingBuffer:Zt,powerPreference:le,failIfMajorPerformanceCaveat:Wt},K.addEventListener("webglcontextlost",m,!1),K.addEventListener("webglcontextrestored",w,!1);var Pe=rt||K.getContext("webgl",ht)||K.getContext("experimental-webgl",ht);if(Pe===null)throw K.getContext("webgl")!==null?Error("Error creating WebGL context with your selected attributes."):Error("Error creating WebGL context.");Pe.getShaderPrecisionFormat===void 0&&(Pe.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Mt){throw console.error("THREE.WebGLRenderer: "+Mt.message),Mt}var li,Ii,Zr,Us,Fo,nl,wm,_w,_m,Mm,Mw,Wx,Cm,vf,$M,tC,eC,oc;h();var yf=new F_(fe,Pe);this.xr=yf;var rC=new D_(fe,_m,Ii.maxTextureSize);this.shadowMap=rC,this.getContext=function(){return Pe},this.getContextAttributes=function(){return Pe.getContextAttributes()},this.forceContextLoss=function(){var Mt=li.get("WEBGL_lose_context");Mt&&Mt.loseContext()},this.forceContextRestore=function(){var Mt=li.get("WEBGL_lose_context");Mt&&Mt.restoreContext()},this.getPixelRatio=function(){return ur},this.setPixelRatio=function(Mt){Mt!==void 0&&(ur=Mt,this.setSize(ve,He,!1))},this.getSize=function(Mt){return Mt===void 0&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),Mt=new f),Mt.set(ve,He)},this.setSize=function(Mt,Se,qt){yf.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(ve=Mt,He=Se,K.width=Math.floor(Mt*ur),K.height=Math.floor(Se*ur),qt!==!1&&(K.style.width=Mt+"px",K.style.height=Se+"px"),this.setViewport(0,0,Mt,Se))},this.getDrawingBufferSize=function(Mt){return Mt===void 0&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),Mt=new f),Mt.set(ve*ur,He*ur).floor()},this.setDrawingBufferSize=function(Mt,Se,qt){ve=Mt,He=Se,ur=qt,K.width=Math.floor(Mt*qt),K.height=Math.floor(Se*qt),this.setViewport(0,0,Mt,Se)},this.getCurrentViewport=function(Mt){return Mt===void 0&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),Mt=new p),Mt.copy(Tn)},this.getViewport=function(Mt){return Mt.copy(Ve)},this.setViewport=function(Mt,Se,qt,De){Mt.isVector4?Ve.set(Mt.x,Mt.y,Mt.z,Mt.w):Ve.set(Mt,Se,qt,De),Zr.viewport(Tn.copy(Ve).multiplyScalar(ur).floor())},this.getScissor=function(Mt){return Mt.copy(dr)},this.setScissor=function(Mt,Se,qt,De){Mt.isVector4?dr.set(Mt.x,Mt.y,Mt.z,Mt.w):dr.set(Mt,Se,qt,De),Zr.scissor(wt.copy(dr).multiplyScalar(ur).floor())},this.getScissorTest=function(){return Yr},this.setScissorTest=function(Mt){Zr.setScissorTest(Yr=Mt)},this.setOpaqueSort=function(Mt){Ee=Mt},this.setTransparentSort=function(Mt){Ut=Mt},this.getClearColor=function(){return vf.getClearColor()},this.setClearColor=function(){vf.setClearColor.apply(vf,arguments)},this.getClearAlpha=function(){return vf.getClearAlpha()},this.setClearAlpha=function(){vf.setClearAlpha.apply(vf,arguments)},this.clear=function(Mt,Se,qt){var De=0;(Mt===void 0||Mt)&&(De|=16384),(Se===void 0||Se)&&(De|=256),(qt===void 0||qt)&&(De|=1024),Pe.clear(De)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){K.removeEventListener("webglcontextlost",m,!1),K.removeEventListener("webglcontextrestored",w,!1),Wx.dispose(),Cm.dispose(),Fo.dispose(),_m.dispose(),yf.dispose(),jx.stop()},this.renderBufferImmediate=function(Mt,Se){Zr.initAttributes();var qt=Fo.get(Mt);Mt.hasPositions&&!qt.position&&(qt.position=Pe.createBuffer()),Mt.hasNormals&&!qt.normal&&(qt.normal=Pe.createBuffer()),Mt.hasUvs&&!qt.uv&&(qt.uv=Pe.createBuffer()),Mt.hasColors&&!qt.color&&(qt.color=Pe.createBuffer()),Se=Se.getAttributes(),Mt.hasPositions&&(Pe.bindBuffer(34962,qt.position),Pe.bufferData(34962,Mt.positionArray,35048),Zr.enableAttribute(Se.position),Pe.vertexAttribPointer(Se.position,3,5126,!1,0,0)),Mt.hasNormals&&(Pe.bindBuffer(34962,qt.normal),Pe.bufferData(34962,Mt.normalArray,35048),Zr.enableAttribute(Se.normal),Pe.vertexAttribPointer(Se.normal,3,5126,!1,0,0)),Mt.hasUvs&&(Pe.bindBuffer(34962,qt.uv),Pe.bufferData(34962,Mt.uvArray,35048),Zr.enableAttribute(Se.uv),Pe.vertexAttribPointer(Se.uv,2,5126,!1,0,0)),Mt.hasColors&&(Pe.bindBuffer(34962,qt.color),Pe.bufferData(34962,Mt.colorArray,35048),Zr.enableAttribute(Se.color),Pe.vertexAttribPointer(Se.color,3,5126,!1,0,0)),Zr.disableUnusedAttributes(),Pe.drawArrays(4,0,Mt.count),Mt.count=0};var MT=new W;this.renderBufferDirect=function(Mt,Se,qt,De,tr,Ei){Se===null&&(Se=MT);var pr=tr.isMesh&&0>tr.matrixWorld.determinant(),Kr=Q(Mt,Se,De,tr);Zr.setMaterial(De,pr);var Ci=!1;if((o!==qt.id||ni!==Kr.id||Bi!==(De.wireframe===!0))&&(o=qt.id,ni=Kr.id,Bi=De.wireframe===!0,Ci=!0),(De.morphTargets||De.morphNormals)&&($M.update(tr,qt,De,Kr),Ci=!0),tr.isInstancedMesh===!0&&(Ci=!0),Mt=qt.index,Se=qt.attributes.position,Mt===null){if(Se===void 0||Se.count===0)return}else if(Mt.count===0)return;var Qi=1;if(De.wireframe===!0&&(Mt=_w.getWireframeAttribute(qt),Qi=2),pr=tC,Mt!==null){var bi=wm.get(Mt);pr=eC,pr.setIndex(bi)}if(Ci){if(Ii.isWebGL2!==!1||!tr.isInstancedMesh&&!qt.isInstancedBufferGeometry||li.get("ANGLE_instanced_arrays")!==null){Zr.initAttributes(),Ci=qt.attributes,Kr=Kr.getAttributes();var rh=De.defaultAttributeValues;for(ed in Kr){var Zn=Kr[ed];if(0<=Zn){var Bo=Ci[ed];if(Bo!==void 0){var sc=Bo.normalized,iC=Bo.itemSize,ol=wm.get(Bo);if(ol!==void 0){var Xx=ol.buffer,td=ol.type;if(ol=ol.bytesPerElement,Bo.isInterleavedBufferAttribute){var Tm=Bo.data,CT=Tm.stride;Bo=Bo.offset,Tm&&Tm.isInstancedInterleavedBuffer?(Zr.enableAttributeAndDivisor(Zn,Tm.meshPerAttribute),qt._maxInstanceCount===void 0&&(qt._maxInstanceCount=Tm.meshPerAttribute*Tm.count)):Zr.enableAttribute(Zn),Pe.bindBuffer(34962,Xx),Zr.vertexAttribPointer(Zn,iC,td,sc,CT*ol,Bo*ol)}else Bo.isInstancedBufferAttribute?(Zr.enableAttributeAndDivisor(Zn,Bo.meshPerAttribute),qt._maxInstanceCount===void 0&&(qt._maxInstanceCount=Bo.meshPerAttribute*Bo.count)):Zr.enableAttribute(Zn),Pe.bindBuffer(34962,Xx),Zr.vertexAttribPointer(Zn,iC,td,sc,0,0)}}else if(ed==="instanceMatrix")ol=wm.get(tr.instanceMatrix),ol!==void 0&&(Xx=ol.buffer,td=ol.type,Zr.enableAttributeAndDivisor(Zn+0,1),Zr.enableAttributeAndDivisor(Zn+1,1),Zr.enableAttributeAndDivisor(Zn+2,1),Zr.enableAttributeAndDivisor(Zn+3,1),Pe.bindBuffer(34962,Xx),Pe.vertexAttribPointer(Zn+0,4,td,!1,64,0),Pe.vertexAttribPointer(Zn+1,4,td,!1,64,16),Pe.vertexAttribPointer(Zn+2,4,td,!1,64,32),Pe.vertexAttribPointer(Zn+3,4,td,!1,64,48));else if(rh!==void 0&&(sc=rh[ed],sc!==void 0))switch(sc.length){case 2:Pe.vertexAttrib2fv(Zn,sc);break;case 3:Pe.vertexAttrib3fv(Zn,sc);break;case 4:Pe.vertexAttrib4fv(Zn,sc);break;default:Pe.vertexAttrib1fv(Zn,sc)}}}Zr.disableUnusedAttributes()}Mt!==null&&Pe.bindBuffer(34963,bi.buffer)}var ed=qt.drawRange.start*Qi;Ci=Ei!==null?Ei.start*Qi:0,bi=Math.max(ed,Ci),Ei=Math.max(0,Math.min(Mt!==null?Mt.count:Se.count,ed+qt.drawRange.count*Qi,Ci+(Ei!==null?Ei.count*Qi:Infinity))-1-bi+1),Ei!==0&&(tr.isMesh?De.wireframe===!0?(Zr.setLineWidth(De.wireframeLinewidth*(er===null?ur:1)),pr.setMode(1)):pr.setMode(4):tr.isLine?(De=De.linewidth,De===void 0&&(De=1),Zr.setLineWidth(De*(er===null?ur:1)),tr.isLineSegments?pr.setMode(1):tr.isLineLoop?pr.setMode(2):pr.setMode(3)):tr.isPoints?pr.setMode(0):tr.isSprite&&pr.setMode(4),tr.isInstancedMesh?pr.renderInstances(qt,bi,Ei,tr.count):qt.isInstancedBufferGeometry?pr.renderInstances(qt,bi,Ei,Math.min(qt.instanceCount,qt._maxInstanceCount)):pr.render(bi,Ei))},this.compile=function(Mt,Se){Fe=Cm.get(Mt,Se),Fe.init(),Mt.traverse(function(De){De.isLight&&(Fe.pushLight(De),De.castShadow&&Fe.pushShadow(De))}),Fe.setupLights(Se);var qt={};Mt.traverse(function(De){var tr=De.material;if(tr)if(Array.isArray(tr))for(var Ei=0;Ei<tr.length;Ei++){var pr=tr[Ei];!(pr.uuid in qt)&&(J(pr,Mt,De),qt[pr.uuid]=!0)}else!(tr.uuid in qt)&&(J(tr,Mt,De),qt[tr.uuid]=!0)})};var Cw=null,jx=new Jr;jx.setAnimationLoop(function(Mt){yf.isPresenting||Cw&&Cw(Mt)}),typeof window!="undefined"&&jx.setContext(window),this.setAnimationLoop=function(Mt){Cw=Mt,yf.setAnimationLoop(Mt),jx.start()},this.render=function(Mt,Se,qt,De){if(qt!==void 0){console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead.");var tr=qt}if(De!==void 0){console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead.");var Ei=De}Se&&Se.isCamera?Ne||(ni=o=null,Bi=!1,xi=-1,Mi=null,Mt.autoUpdate===!0&&Mt.updateMatrixWorld(),Se.parent===null&&Se.updateMatrixWorld(),yf.enabled&&yf.isPresenting&&(Se=yf.getCamera(Se)),Mt.onBeforeRender(fe,Mt,Se,tr||er),Fe=Cm.get(Mt,Se),Fe.init(),Yn.multiplyMatrices(Se.projectionMatrix,Se.matrixWorldInverse),xr.setFromProjectionMatrix(Yn),ui=this.localClippingEnabled,sr=or.init(this.clippingPlanes,ui,Se),Me=Wx.get(Mt,Se),Me.init(),k(Mt,Se,0,fe.sortObjects),Me.finish(),fe.sortObjects===!0&&Me.sort(Ee,Ut),sr&&or.beginShadows(),rC.render(Fe.state.shadowsArray,Mt,Se),Fe.setupLights(Se),sr&&or.endShadows(),this.info.autoReset&&this.info.reset(),tr!==void 0&&this.setRenderTarget(tr),vf.render(Me,Mt,Se,Ei),qt=Me.opaque,De=Me.transparent,Mt.overrideMaterial?(tr=Mt.overrideMaterial,qt.length&&b(qt,Mt,Se,tr),De.length&&b(De,Mt,Se,tr)):(qt.length&&b(qt,Mt,Se),De.length&&b(De,Mt,Se)),Mt.onAfterRender(fe,Mt,Se),er!==null&&(nl.updateRenderTargetMipmap(er),nl.updateMultisampleRenderTarget(er)),Zr.buffers.depth.setTest(!0),Zr.buffers.depth.setMask(!0),Zr.buffers.color.setMask(!0),Zr.setPolygonOffset(!1),Fe=Me=null):console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(Mt){Oe!==Mt&&er===null&&Pe.bindFramebuffer(36160,Mt),Oe=Mt},this.getActiveCubeFace=function(){return vr},this.getActiveMipmapLevel=function(){return jr},this.getRenderTarget=function(){return er},this.setRenderTarget=function(Mt,Se,qt){er=Mt,vr=Se,jr=qt,Mt&&Fo.get(Mt).__webglFramebuffer===void 0&&nl.setupRenderTarget(Mt);var De=Oe,tr=!1;Mt?(De=Fo.get(Mt).__webglFramebuffer,Mt.isWebGLCubeRenderTarget?(De=De[Se||0],tr=!0):De=Mt.isWebGLMultisampleRenderTarget?Fo.get(Mt).__webglMultisampledFramebuffer:De,Tn.copy(Mt.viewport),wt.copy(Mt.scissor),Bt=Mt.scissorTest):(Tn.copy(Ve).multiplyScalar(ur).floor(),wt.copy(dr).multiplyScalar(ur).floor(),Bt=Yr),Hr!==De&&(Pe.bindFramebuffer(36160,De),Hr=De),Zr.viewport(Tn),Zr.scissor(wt),Zr.setScissorTest(Bt),tr&&(Mt=Fo.get(Mt.texture),Pe.framebufferTexture2D(36160,36064,34069+(Se||0),Mt.__webglTexture,qt||0))},this.readRenderTargetPixels=function(Mt,Se,qt,De,tr,Ei,pr){if(Mt&&Mt.isWebGLRenderTarget){var Kr=Fo.get(Mt).__webglFramebuffer;if(Mt.isWebGLCubeRenderTarget&&pr!==void 0&&(Kr=Kr[pr]),Kr){pr=!1,Kr!==Hr&&(Pe.bindFramebuffer(36160,Kr),pr=!0);try{var Ci=Mt.texture,Qi=Ci.format,bi=Ci.type;Qi!==1023&&oc.convert(Qi)!==Pe.getParameter(35739)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):bi===1009||oc.convert(bi)===Pe.getParameter(35738)||bi===1015&&(Ii.isWebGL2||li.get("OES_texture_float")||li.get("WEBGL_color_buffer_float"))||bi===1016&&(Ii.isWebGL2?li.get("EXT_color_buffer_float"):li.get("EXT_color_buffer_half_float"))?Pe.checkFramebufferStatus(36160)===36053?0<=Se&&Se<=Mt.width-De&&0<=qt&&qt<=Mt.height-tr&&Pe.readPixels(Se,qt,De,tr,oc.convert(Qi),oc.convert(bi),Ei):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{pr&&Pe.bindFramebuffer(36160,Hr)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(Mt,Se,qt){qt===void 0&&(qt=0);var De=Math.pow(2,-qt),tr=Math.floor(Se.image.width*De);De=Math.floor(Se.image.height*De);var Ei=oc.convert(Se.format);nl.setTexture2D(Se,0),Pe.copyTexImage2D(3553,qt,Ei,Mt.x,Mt.y,tr,De,0),Zr.unbindTexture()},this.copyTextureToTexture=function(Mt,Se,qt,De){De===void 0&&(De=0);var tr=Se.image.width,Ei=Se.image.height,pr=oc.convert(qt.format),Kr=oc.convert(qt.type);nl.setTexture2D(qt,0),Se.isDataTexture?Pe.texSubImage2D(3553,De,Mt.x,Mt.y,tr,Ei,pr,Kr,Se.image.data):Se.isCompressedTexture?Pe.compressedTexSubImage2D(3553,De,Mt.x,Mt.y,Se.mipmaps[0].width,Se.mipmaps[0].height,pr,Se.mipmaps[0].data):Pe.texSubImage2D(3553,De,Mt.x,Mt.y,pr,Kr,Se.image),De===0&&qt.generateMipmaps&&Pe.generateMipmap(3553),Zr.unbindTexture()},this.initTexture=function(Mt){nl.setTexture2D(Mt,0),Zr.unbindTexture()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function Ry(e,o){this.name="",this.color=new yt(e),this.density=o!==void 0?o:25e-5}function Py(e,o,h){this.name="",this.color=new yt(e),this.near=o!==void 0?o:1,this.far=h!==void 0?h:1e3}function Yh(e,o){this.array=e,this.stride=o,this.count=e!==void 0?e.length/o:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function jv(e,o,h,m){this.name="",this.data=e,this.itemSize=o,this.offset=h,this.normalized=m===!0}function nf(e){Kt.call(this),this.type="SpriteMaterial",this.color=new yt(16777215),this.alphaMap=this.map=null,this.rotation=0,this.transparent=this.sizeAttenuation=!0,this.setValues(e)}function Xv(e){if(F.call(this),this.type="Sprite",mm===void 0){mm=new ft;var o=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]);o=new Yh(o,5),mm.setIndex([0,1,2,0,2,3]),mm.setAttribute("position",new jv(o,3,0,!1)),mm.setAttribute("uv",new jv(o,2,3,!1))}this.geometry=mm,this.material=e!==void 0?e:new nf,this.center=new f(.5,.5)}function Dy(e,o,h,m,w,T){xm.subVectors(e,h).addScalar(.5).multiply(m),w!==void 0?(O0.x=T*xm.x-w*xm.y,O0.y=w*xm.x+T*xm.y):O0.copy(xm),e.copy(o),e.x+=O0.x,e.y+=O0.y,e.applyMatrix4(MM)}function Yv(){F.call(this),this._currentLevel=0,this.type="LOD",Xr(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function Oy(e,o){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Tt.call(this,e,o),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new I,this.bindMatrixInverse=new I}function Fy(e,o){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,o===void 0)this.calculateInverses();else if(this.bones.length===o.length)this.boneInverses=o.slice(0);else for(console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[],e=0,o=this.bones.length;e<o;e++)this.boneInverses.push(new I)}function c2(){F.call(this),this.type="Bone"}function By(e,o,h){Tt.call(this,e,o),this.instanceMatrix=new ae(new Float32Array(16*h),16),this.count=h,this.frustumCulled=!1}function to(e){Kt.call(this),this.type="LineBasicMaterial",this.color=new yt(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.morphTargets=!1,this.setValues(e)}function ja(e,o,h){h===1&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),F.call(this),this.type="Line",this.geometry=e!==void 0?e:new ft,this.material=o!==void 0?o:new to,this.updateMorphTargets()}function lo(e,o){ja.call(this,e,o),this.type="LineSegments"}function Ny(e,o){ja.call(this,e,o),this.type="LineLoop"}function Zu(e){Kt.call(this),this.type="PointsMaterial",this.color=new yt(16777215),this.alphaMap=this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}function Dg(e,o){F.call(this),this.type="Points",this.geometry=e!==void 0?e:new ft,this.material=o!==void 0?o:new Zu,this.updateMorphTargets()}function f2(e,o,h,m,w,T,R){var z=lw.distanceSqToPoint(e);z<h&&(h=new _,lw.closestPointToPoint(e,h),h.applyMatrix4(m),e=w.ray.origin.distanceTo(h),e<w.near||e>w.far||T.push({distance:e,distanceToRay:Math.sqrt(z),point:h,index:o,face:null,object:R}))}function p2(e,o,h,m,w,T,R,z,k){g.call(this,e,o,h,m,w,T,R,z,k),this.format=R!==void 0?R:1022,this.minFilter=T!==void 0?T:1006,this.magFilter=w!==void 0?w:1006,this.generateMipmaps=!1}function Og(e,o,h,m,w,T,R,z,k,b,q,J){g.call(this,null,T,R,z,k,b,m,w,q,J),this.image={width:o,height:h},this.mipmaps=e,this.generateMipmaps=this.flipY=!1}function Zv(e,o,h,m,w,T,R,z,k){g.call(this,e,o,h,m,w,T,R,z,k),this.needsUpdate=!0}function Jv(e,o,h,m,w,T,R,z,k,b){if(b=b!==void 0?b:1026,b!==1026&&b!==1027)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");h===void 0&&b===1026&&(h=1012),h===void 0&&b===1027&&(h=1020),g.call(this,null,m,w,T,R,z,b,h,k),this.image={width:e,height:o},this.magFilter=R!==void 0?R:1003,this.minFilter=z!==void 0?z:1003,this.generateMipmaps=this.flipY=!1}function Fg(e){ft.call(this),this.type="WireframeGeometry";var o=[],h,m,w,T=[0,0],R={},z=["a","b","c"];if(e&&e.isGeometry){var k=e.faces,b=0;for(m=k.length;b<m;b++){var q=k[b];for(h=0;3>h;h++){var J=q[z[h]],Q=q[z[(h+1)%3]];T[0]=Math.min(J,Q),T[1]=Math.max(J,Q),J=T[0]+","+T[1],R[J]===void 0&&(R[J]={index1:T[0],index2:T[1]})}}for(J in R)b=R[J],z=e.vertices[b.index1],o.push(z.x,z.y,z.z),z=e.vertices[b.index2],o.push(z.x,z.y,z.z)}else if(e&&e.isBufferGeometry)if(z=new _,e.index!==null){k=e.attributes.position,q=e.index;var K=e.groups;for(K.length===0&&(K=[{start:0,count:q.count,materialIndex:0}]),e=0,w=K.length;e<w;++e)for(b=K[e],h=b.start,m=b.count,b=h,m=h+m;b<m;b+=3)for(h=0;3>h;h++)J=q.getX(b+h),Q=q.getX(b+(h+1)%3),T[0]=Math.min(J,Q),T[1]=Math.max(J,Q),J=T[0]+","+T[1],R[J]===void 0&&(R[J]={index1:T[0],index2:T[1]});for(J in R)b=R[J],z.fromBufferAttribute(k,b.index1),o.push(z.x,z.y,z.z),z.fromBufferAttribute(k,b.index2),o.push(z.x,z.y,z.z)}else for(k=e.attributes.position,b=0,m=k.count/3;b<m;b++)for(h=0;3>h;h++)R=3*b+h,z.fromBufferAttribute(k,R),o.push(z.x,z.y,z.z),R=3*b+(h+1)%3,z.fromBufferAttribute(k,R),o.push(z.x,z.y,z.z);this.setAttribute("position",new vt(o,3))}function qv(e,o,h){pt.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:o,stacks:h},this.fromBufferGeometry(new Bg(e,o,h)),this.mergeVertices()}function Bg(e,o,h){ft.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:o,stacks:h};var m=[],w=[],T=[],R=[],z=new _,k=new _,b=new _,q=new _,J=new _,Q,K;3>e.length&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var rt=o+1;for(Q=0;Q<=h;Q++){var ht=Q/h;for(K=0;K<=o;K++){var Ot=K/o;e(Ot,ht,k),w.push(k.x,k.y,k.z),0<=Ot-1e-5?(e(Ot-1e-5,ht,b),q.subVectors(k,b)):(e(Ot+1e-5,ht,b),q.subVectors(b,k)),0<=ht-1e-5?(e(Ot,ht-1e-5,b),J.subVectors(k,b)):(e(Ot,ht+1e-5,b),J.subVectors(b,k)),z.crossVectors(q,J).normalize(),T.push(z.x,z.y,z.z),R.push(Ot,ht)}}for(Q=0;Q<h;Q++)for(K=0;K<o;K++)e=Q*rt+K+1,z=(Q+1)*rt+K+1,k=(Q+1)*rt+K,m.push(Q*rt+K,e,k),m.push(e,z,k);this.setIndex(m),this.setAttribute("position",new vt(w,3)),this.setAttribute("normal",new vt(T,3)),this.setAttribute("uv",new vt(R,2))}function Kv(e,o,h,m){pt.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:o,radius:h,detail:m},this.fromBufferGeometry(new wa(e,o,h,m)),this.mergeVertices()}function wa(e,o,h,m){function w(b){z.push(b.x,b.y,b.z)}function T(b,q){b*=3,q.x=e[b+0],q.y=e[b+1],q.z=e[b+2]}function R(b,q,J,Q){0>Q&&b.x===1&&(k[q]=b.x-1),J.x===0&&J.z===0&&(k[q]=Q/2/Math.PI+.5)}ft.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:o,radius:h,detail:m},h=h||1,m=m||0;var z=[],k=[];(function(b){for(var q=new _,J=new _,Q=new _,K=0;K<o.length;K+=3){T(o[K+0],q),T(o[K+1],J),T(o[K+2],Q);var rt,ht,Ot=q,jt=J,Gt=Q,ee=Math.pow(2,b),Zt=[];for(ht=0;ht<=ee;ht++){Zt[ht]=[];var le=Ot.clone().lerp(Gt,ht/ee),Wt=jt.clone().lerp(Gt,ht/ee),Me=ee-ht;for(rt=0;rt<=Me;rt++)Zt[ht][rt]=rt===0&&ht===ee?le:le.clone().lerp(Wt,rt/Me)}for(ht=0;ht<ee;ht++)for(rt=0;rt<2*(ee-ht)-1;rt++)Ot=Math.floor(rt/2),rt%2==0?(w(Zt[ht][Ot+1]),w(Zt[ht+1][Ot]),w(Zt[ht][Ot])):(w(Zt[ht][Ot+1]),w(Zt[ht+1][Ot+1]),w(Zt[ht+1][Ot]))}})(m),function(b){for(var q=new _,J=0;J<z.length;J+=3)q.x=z[J+0],q.y=z[J+1],q.z=z[J+2],q.normalize().multiplyScalar(b),z[J+0]=q.x,z[J+1]=q.y,z[J+2]=q.z}(h),function(){for(var b=new _,q=0;q<z.length;q+=3)b.x=z[q+0],b.y=z[q+1],b.z=z[q+2],k.push(Math.atan2(b.z,-b.x)/2/Math.PI+.5,1-(Math.atan2(-b.y,Math.sqrt(b.x*b.x+b.z*b.z))/Math.PI+.5));b=new _,q=new _;for(var J=new _,Q=new _,K=new f,rt=new f,ht=new f,Ot=0,jt=0;Ot<z.length;Ot+=9,jt+=6){b.set(z[Ot+0],z[Ot+1],z[Ot+2]),q.set(z[Ot+3],z[Ot+4],z[Ot+5]),J.set(z[Ot+6],z[Ot+7],z[Ot+8]),K.set(k[jt+0],k[jt+1]),rt.set(k[jt+2],k[jt+3]),ht.set(k[jt+4],k[jt+5]),Q.copy(b).add(q).add(J).divideScalar(3);var Gt=Math.atan2(Q.z,-Q.x);R(K,jt+0,b,Gt),R(rt,jt+2,q,Gt),R(ht,jt+4,J,Gt)}for(b=0;b<k.length;b+=6)q=k[b+0],J=k[b+2],Q=k[b+4],K=Math.min(q,J,Q),.9<Math.max(q,J,Q)&&.1>K&&(.2>q&&(k[b+0]+=1),.2>J&&(k[b+2]+=1),.2>Q&&(k[b+4]+=1))}(),this.setAttribute("position",new vt(z,3)),this.setAttribute("normal",new vt(z.slice(),3)),this.setAttribute("uv",new vt(k,2)),m===0?this.computeVertexNormals():this.normalizeNormals()}function Qv(e,o){pt.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:o},this.fromBufferGeometry(new Ng(e,o)),this.mergeVertices()}function Ng(e,o){wa.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,o),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:o}}function $v(e,o){pt.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:o},this.fromBufferGeometry(new Lp(e,o)),this.mergeVertices()}function Lp(e,o){wa.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,o),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:o}}function t0(e,o){pt.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:o},this.fromBufferGeometry(new zg(e,o)),this.mergeVertices()}function zg(e,o){var h=(1+Math.sqrt(5))/2;wa.call(this,[-1,h,0,1,h,0,-1,-h,0,1,-h,0,0,-1,h,0,1,h,0,-1,-h,0,1,-h,h,0,-1,h,0,1,-h,0,-1,-h,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,o),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:o}}function e0(e,o){pt.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:o},this.fromBufferGeometry(new Ug(e,o)),this.mergeVertices()}function Ug(e,o){var h=(1+Math.sqrt(5))/2,m=1/h;wa.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-m,-h,0,-m,h,0,m,-h,0,m,h,-m,-h,0,-m,h,0,m,-h,0,m,h,0,-h,0,-m,h,0,-m,-h,0,m,h,0,m],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,o),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:o}}function r0(e,o,h,m,w,T){pt.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:o,radius:h,radialSegments:m,closed:w},T!==void 0&&console.warn("THREE.TubeGeometry: taper has been removed."),e=new Rp(e,o,h,m,w),this.tangents=e.tangents,this.normals=e.normals,this.binormals=e.binormals,this.fromBufferGeometry(e),this.mergeVertices()}function Rp(e,o,h,m,w){function T(jt){q=e.getPointAt(jt/o,q);var Gt=R.normals[jt];for(jt=R.binormals[jt],Q=0;Q<=m;Q++){var ee=Q/m*Math.PI*2,Zt=Math.sin(ee);ee=-Math.cos(ee),k.x=ee*Gt.x+Zt*jt.x,k.y=ee*Gt.y+Zt*jt.y,k.z=ee*Gt.z+Zt*jt.z,k.normalize(),rt.push(k.x,k.y,k.z),z.x=q.x+h*k.x,z.y=q.y+h*k.y,z.z=q.z+h*k.z,K.push(z.x,z.y,z.z)}}ft.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:o,radius:h,radialSegments:m,closed:w},o=o||64,h=h||1,m=m||8,w=w||!1;var R=e.computeFrenetFrames(o,w);this.tangents=R.tangents,this.normals=R.normals,this.binormals=R.binormals;var z=new _,k=new _,b=new f,q=new _,J,Q,K=[],rt=[],ht=[],Ot=[];for(J=0;J<o;J++)T(J);for(T(w===!1?o:0),J=0;J<=o;J++)for(Q=0;Q<=m;Q++)b.x=J/o,b.y=Q/m,ht.push(b.x,b.y);(function(){for(Q=1;Q<=o;Q++)for(J=1;J<=m;J++){var jt=(m+1)*Q+(J-1),Gt=(m+1)*Q+J,ee=(m+1)*(Q-1)+J;Ot.push((m+1)*(Q-1)+(J-1),jt,ee),Ot.push(jt,Gt,ee)}})(),this.setIndex(Ot),this.setAttribute("position",new vt(K,3)),this.setAttribute("normal",new vt(rt,3)),this.setAttribute("uv",new vt(ht,2))}function i0(e,o,h,m,w,T,R){pt.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:o,tubularSegments:h,radialSegments:m,p:w,q:T},R!==void 0&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Hg(e,o,h,m,w,T)),this.mergeVertices()}function Hg(e,o,h,m,w,T){function R(Wt,Me,Fe,fe,Ne){var Oe=Math.sin(Wt);Me=Fe/Me*Wt,Fe=Math.cos(Me),Ne.x=fe*(2+Fe)*.5*Math.cos(Wt),Ne.y=fe*(2+Fe)*Oe*.5,Ne.z=fe*Math.sin(Me)*.5}ft.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:o,tubularSegments:h,radialSegments:m,p:w,q:T},e=e||1,o=o||.4,h=Math.floor(h)||64,m=Math.floor(m)||8,w=w||2,T=T||3;var z=[],k=[],b=[],q=[],J,Q=new _,K=new _,rt=new _,ht=new _,Ot=new _,jt=new _,Gt=new _;for(J=0;J<=h;++J){var ee=J/h*w*Math.PI*2;for(R(ee,w,T,e,rt),R(ee+.01,w,T,e,ht),jt.subVectors(ht,rt),Gt.addVectors(ht,rt),Ot.crossVectors(jt,Gt),Gt.crossVectors(Ot,jt),Ot.normalize(),Gt.normalize(),ee=0;ee<=m;++ee){var Zt=ee/m*Math.PI*2,le=-o*Math.cos(Zt);Zt=o*Math.sin(Zt),Q.x=rt.x+(le*Gt.x+Zt*Ot.x),Q.y=rt.y+(le*Gt.y+Zt*Ot.y),Q.z=rt.z+(le*Gt.z+Zt*Ot.z),k.push(Q.x,Q.y,Q.z),K.subVectors(Q,rt).normalize(),b.push(K.x,K.y,K.z),q.push(J/h),q.push(ee/m)}}for(ee=1;ee<=h;ee++)for(J=1;J<=m;J++)e=(m+1)*ee+(J-1),o=(m+1)*ee+J,w=(m+1)*(ee-1)+J,z.push((m+1)*(ee-1)+(J-1),e,w),z.push(e,o,w);this.setIndex(z),this.setAttribute("position",new vt(k,3)),this.setAttribute("normal",new vt(b,3)),this.setAttribute("uv",new vt(q,2))}function n0(e,o,h,m,w){pt.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:o,radialSegments:h,tubularSegments:m,arc:w},this.fromBufferGeometry(new kg(e,o,h,m,w)),this.mergeVertices()}function kg(e,o,h,m,w){ft.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:o,radialSegments:h,tubularSegments:m,arc:w},e=e||1,o=o||.4,h=Math.floor(h)||8,m=Math.floor(m)||6,w=w||2*Math.PI;var T=[],R=[],z=[],k=[],b=new _,q=new _,J=new _,Q,K;for(Q=0;Q<=h;Q++)for(K=0;K<=m;K++){var rt=K/m*w,ht=Q/h*Math.PI*2;q.x=(e+o*Math.cos(ht))*Math.cos(rt),q.y=(e+o*Math.cos(ht))*Math.sin(rt),q.z=o*Math.sin(ht),R.push(q.x,q.y,q.z),b.x=e*Math.cos(rt),b.y=e*Math.sin(rt),J.subVectors(q,b).normalize(),z.push(J.x,J.y,J.z),k.push(K/m),k.push(Q/h)}for(Q=1;Q<=h;Q++)for(K=1;K<=m;K++)e=(m+1)*(Q-1)+K-1,o=(m+1)*(Q-1)+K,w=(m+1)*Q+K,T.push((m+1)*Q+K-1,e,w),T.push(e,o,w);this.setIndex(T),this.setAttribute("position",new vt(R,3)),this.setAttribute("normal",new vt(z,3)),this.setAttribute("uv",new vt(k,2))}function B_(e,o,h,m,w){for(var T,R=0,z=o,k=h-m;z<h;z+=m)R+=(e[k]-e[z])*(e[z+1]+e[k+1]),k=z;if(w===0<R)for(w=o;w<h;w+=m)T=U_(w,e[w],e[w+1],T);else for(w=h-m;w>=o;w-=m)T=U_(w,e[w],e[w+1],T);return T&&zy(T,T.next)&&(a0(T),T=T.next),T}function of(e,o){if(!e)return e;o||(o=e);do{var h=!1;if(e.steiner||!zy(e,e.next)&&ho(e.prev,e,e.next)!==0)e=e.next;else{if(a0(e),e=o=e.prev,e===e.next)break;h=!0}}while(h||e!==o);return o}function o0(e,o,h,m,w,T,R){if(e){if(!R&&T){var z=e,k=z;do k.z===null&&(k.z=d2(k.x,k.y,m,w,T)),k.prevZ=k.prev,k=k.nextZ=k.next;while(k!==z);k.prevZ.nextZ=null,k.prevZ=null,z=k;var b,q,J,Q,K=1;do{k=z;var rt=z=null;for(q=0;k;){q++;var ht=k;for(b=J=0;b<K&&(J++,ht=ht.nextZ,ht);b++);for(Q=K;0<J||0<Q&&ht;)J!==0&&(Q===0||!ht||k.z<=ht.z)?(b=k,k=k.nextZ,J--):(b=ht,ht=ht.nextZ,Q--),rt?rt.nextZ=b:z=b,b.prevZ=rt,rt=b;k=ht}rt.nextZ=null,K*=2}while(1<q)}for(z=e;e.prev!==e.next;){if(k=e.prev,ht=e.next,T)rt=z3(e,m,w,T);else t:if(rt=e,q=rt.prev,J=rt,K=rt.next,0<=ho(q,J,K))rt=!1;else{for(b=rt.next.next;b!==rt.prev;){if(Gg(q.x,q.y,J.x,J.y,K.x,K.y,b.x,b.y)&&0<=ho(b.prev,b,b.next)){rt=!1;break t}b=b.next}rt=!0}if(rt)o.push(k.i/h),o.push(e.i/h),o.push(ht.i/h),a0(e),z=e=ht.next;else if(e=ht,e===z){if(!R)o0(of(e),o,h,m,w,T,1);else if(R===1){e=of(e),R=o,z=h,k=e;do ht=k.prev,rt=k.next.next,!zy(ht,rt)&&N_(ht,k,k.next,rt)&&s0(ht,rt)&&s0(rt,ht)&&(R.push(ht.i/z),R.push(k.i/z),R.push(rt.i/z),a0(k),a0(k.next),k=e=rt),k=k.next;while(k!==e);e=of(k),o0(e,o,h,m,w,T,2)}else if(R===2)t:{R=e;do{for(z=R.next.next;z!==R.prev;){if(k=R.i!==z.i){if(k=R,ht=z,rt=k.next.i!==ht.i&&k.prev.i!==ht.i){e:{rt=k;do{if(rt.i!==k.i&&rt.next.i!==k.i&&rt.i!==ht.i&&rt.next.i!==ht.i&&N_(rt,rt.next,k,ht)){rt=!0;break e}rt=rt.next}while(rt!==k);rt=!1}rt=!rt}if(rt){if(rt=s0(k,ht)&&s0(ht,k)){rt=k,q=!1,J=(k.x+ht.x)/2,K=(k.y+ht.y)/2;do rt.y>K!=rt.next.y>K&&rt.next.y!==rt.y&&J<(rt.next.x-rt.x)*(K-rt.y)/(rt.next.y-rt.y)+rt.x&&(q=!q),rt=rt.next;while(rt!==k);rt=q}rt=rt&&(ho(k.prev,k,ht.prev)||ho(k,ht.prev,ht))||zy(k,ht)&&0<ho(k.prev,k,k.next)&&0<ho(ht.prev,ht,ht.next)}k=rt}if(k){e=z_(R,z),R=of(R,R.next),e=of(e,e.next),o0(R,o,h,m,w,T),o0(e,o,h,m,w,T);break t}z=z.next}R=R.next}while(R!==e)}break}}}}function z3(e,o,h,m){var w=e.prev,T=e.next;if(0<=ho(w,e,T))return!1;var R=w.x>e.x?w.x>T.x?w.x:T.x:e.x>T.x?e.x:T.x,z=w.y>e.y?w.y>T.y?w.y:T.y:e.y>T.y?e.y:T.y,k=d2(w.x<e.x?w.x<T.x?w.x:T.x:e.x<T.x?e.x:T.x,w.y<e.y?w.y<T.y?w.y:T.y:e.y<T.y?e.y:T.y,o,h,m);for(o=d2(R,z,o,h,m),h=e.prevZ,m=e.nextZ;h&&h.z>=k&&m&&m.z<=o;){if(h!==e.prev&&h!==e.next&&Gg(w.x,w.y,e.x,e.y,T.x,T.y,h.x,h.y)&&0<=ho(h.prev,h,h.next)||(h=h.prevZ,m!==e.prev&&m!==e.next&&Gg(w.x,w.y,e.x,e.y,T.x,T.y,m.x,m.y)&&0<=ho(m.prev,m,m.next)))return!1;m=m.nextZ}for(;h&&h.z>=k;){if(h!==e.prev&&h!==e.next&&Gg(w.x,w.y,e.x,e.y,T.x,T.y,h.x,h.y)&&0<=ho(h.prev,h,h.next))return!1;h=h.prevZ}for(;m&&m.z<=o;){if(m!==e.prev&&m!==e.next&&Gg(w.x,w.y,e.x,e.y,T.x,T.y,m.x,m.y)&&0<=ho(m.prev,m,m.next))return!1;m=m.nextZ}return!0}function U3(e,o){return e.x-o.x}function H3(e,o){var h=o,m=e.x,w=e.y,T=-Infinity;do{if(w<=h.y&&w>=h.next.y&&h.next.y!==h.y){var R=h.x+(w-h.y)*(h.next.x-h.x)/(h.next.y-h.y);if(R<=m&&R>T){if(T=R,R===m){if(w===h.y)return h;if(w===h.next.y)return h.next}var z=h.x<h.next.x?h:h.next}}h=h.next}while(h!==o);if(!z)return null;if(m===T)return z;o=z,R=z.x;var k=z.y,b=Infinity;h=z;do{if(m>=h.x&&h.x>=R&&m!==h.x&&Gg(w<k?m:T,w,R,k,w<k?T:m,w,h.x,h.y)){var q=Math.abs(w-h.y)/(m-h.x),J;if((J=s0(h,e))&&!(J=q<b)&&(J=q===b)&&!(J=h.x>z.x)&&(J=h.x===z.x)){J=z;var Q=h;J=0>ho(J.prev,J,Q.prev)&&0>ho(Q.next,J,J.next)}J&&(z=h,b=q)}h=h.next}while(h!==o);return z}function d2(e,o,h,m,w){return e=32767*(e-h)*w,o=32767*(o-m)*w,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,o=(o|o<<8)&16711935,o=(o|o<<4)&252645135,o=(o|o<<2)&858993459,(e|e<<1)&1431655765|((o|o<<1)&1431655765)<<1}function k3(e){var o=e,h=e;do(o.x<h.x||o.x===h.x&&o.y<h.y)&&(h=o),o=o.next;while(o!==e);return h}function Gg(e,o,h,m,w,T,R,z){return 0<=(w-R)*(o-z)-(e-R)*(T-z)&&0<=(e-R)*(m-z)-(h-R)*(o-z)&&0<=(h-R)*(T-z)-(w-R)*(m-z)}function ho(e,o,h){return(o.y-e.y)*(h.x-o.x)-(o.x-e.x)*(h.y-o.y)}function zy(e,o){return e.x===o.x&&e.y===o.y}function N_(e,o,h,m){var w=Hy(ho(e,o,h)),T=Hy(ho(e,o,m)),R=Hy(ho(h,m,e)),z=Hy(ho(h,m,o));return!!(w!==T&&R!==z||w===0&&Uy(e,h,o)||T===0&&Uy(e,m,o)||R===0&&Uy(h,e,m)||z===0&&Uy(h,o,m))}function Uy(e,o,h){return o.x<=Math.max(e.x,h.x)&&o.x>=Math.min(e.x,h.x)&&o.y<=Math.max(e.y,h.y)&&o.y>=Math.min(e.y,h.y)}function Hy(e){return 0<e?1:0>e?-1:0}function s0(e,o){return 0>ho(e.prev,e,e.next)?0<=ho(e,o,e.next)&&0<=ho(e,e.prev,o):0>ho(e,o,e.prev)||0>ho(e,e.next,o)}function z_(e,o){var h=new g2(e.i,e.x,e.y),m=new g2(o.i,o.x,o.y),w=e.next,T=o.prev;return e.next=o,o.prev=e,h.next=w,w.prev=h,m.next=h,h.prev=m,T.next=m,m.prev=T,m}function U_(e,o,h,m){return e=new g2(e,o,h),m?(e.next=m.next,e.prev=m,m.next.prev=e,m.next=e):(e.prev=e,e.next=e),e}function a0(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function g2(e,o,h){this.i=e,this.x=o,this.y=h,this.nextZ=this.prevZ=this.z=this.next=this.prev=null,this.steiner=!1}function H_(e){var o=e.length;2<o&&e[o-1].equals(e[0])&&e.pop()}function k_(e,o){for(var h=0;h<o.length;h++)e.push(o[h].x),e.push(o[h].y)}function Pp(e,o){pt.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:o},this.fromBufferGeometry(new Xl(e,o)),this.mergeVertices()}function Xl(e,o){function h(k){function b(sr,ui,Yn){return ui||console.error("THREE.ExtrudeGeometry: vec does not exist"),ui.clone().multiplyScalar(Yn).add(sr)}function q(sr,ui,Yn){var hi=sr.x-ui.x,Pe=sr.y-ui.y,li=Yn.x-sr.x,Ii=Yn.y-sr.y,Zr=hi*hi+Pe*Pe;if(Math.abs(hi*Ii-Pe*li)>Dn){var Us=Math.sqrt(Zr),Fo=Math.sqrt(li*li+Ii*Ii);if(Zr=ui.x-Pe/Us,ui=ui.y+hi/Us,Ii=((Yn.x-Ii/Fo-Zr)*Ii-(Yn.y+li/Fo-ui)*li)/(hi*Ii-Pe*li),li=Zr+hi*Ii-sr.x,hi=ui+Pe*Ii-sr.y,Pe=li*li+hi*hi,2>=Pe)return new f(li,hi);Pe=Math.sqrt(Pe/2)}else sr=!1,hi>Dn?li>Dn&&(sr=!0):hi<-Dn?li<-Dn&&(sr=!0):zl(Pe)===zl(Ii)&&(sr=!0),sr?(li=-Pe,Pe=Math.sqrt(Zr)):(li=hi,hi=Pe,Pe=Math.sqrt(Zr/2));return new f(li/Pe,hi/Pe)}function J(sr,ui){for(Ee=sr.length;0<=--Ee;){var Yn=Ee,hi=Ee-1;0>hi&&(hi=sr.length-1);var Pe,li=Gt+2*Fe;for(Pe=0;Pe<li;Pe++){var Ii=ve*Pe,Zr=ve*(Pe+1),Us=ui+hi+Ii,Fo=ui+hi+Zr;Zr=ui+Yn+Zr,rt(ui+Yn+Ii),rt(Us),rt(Zr),rt(Us),rt(Fo),rt(Zr),Ii=w.length/3,Ii=Ne.generateSideWallUV(m,w,Ii-6,Ii-3,Ii-2,Ii-1),ht(Ii[0]),ht(Ii[1]),ht(Ii[3]),ht(Ii[1]),ht(Ii[2]),ht(Ii[3])}}}function Q(sr,ui,Yn){Ot.push(sr),Ot.push(ui),Ot.push(Yn)}function K(sr,ui,Yn){rt(sr),rt(ui),rt(Yn),sr=w.length/3,sr=Ne.generateTopUV(m,w,sr-3,sr-2,sr-1),ht(sr[0]),ht(sr[1]),ht(sr[2])}function rt(sr){w.push(Ot[3*sr]),w.push(Ot[3*sr+1]),w.push(Ot[3*sr+2])}function ht(sr){T.push(sr.x),T.push(sr.y)}var Ot=[],jt=o.curveSegments!==void 0?o.curveSegments:12,Gt=o.steps!==void 0?o.steps:1,ee=o.depth!==void 0?o.depth:100,Zt=o.bevelEnabled!==void 0?o.bevelEnabled:!0,le=o.bevelThickness!==void 0?o.bevelThickness:6,Wt=o.bevelSize!==void 0?o.bevelSize:le-2,Me=o.bevelOffset!==void 0?o.bevelOffset:0,Fe=o.bevelSegments!==void 0?o.bevelSegments:3,fe=o.extrudePath,Ne=o.UVGenerator!==void 0?o.UVGenerator:lT;o.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),ee=o.amount);var Oe=!1;if(fe){var vr=fe.getSpacedPoints(Gt);Oe=!0,Zt=!1;var jr=fe.computeFrenetFrames(Gt,!1),er=new _,Hr=new _,xi=new _}Zt||(Me=Wt=le=Fe=0);var ni;jt=k.extractPoints(jt),k=jt.shape;var Bi=jt.holes;if(!nc.isClockWise(k)){k=k.reverse();var Mi=0;for(ni=Bi.length;Mi<ni;Mi++){var ln=Bi[Mi];nc.isClockWise(ln)&&(Bi[Mi]=ln.reverse())}}var Tn=nc.triangulateShape(k,Bi),wt=k;for(Mi=0,ni=Bi.length;Mi<ni;Mi++)ln=Bi[Mi],k=k.concat(ln);var Bt,ve=k.length,He,ur=Tn.length;jt=[];var Ee=0,Ut=wt.length,Ve=Ut-1;for(Bt=Ee+1;Ee<Ut;Ee++,Ve++,Bt++)Ve===Ut&&(Ve=0),Bt===Ut&&(Bt=0),jt[Ee]=q(wt[Ee],wt[Ve],wt[Bt]);fe=[];var dr=jt.concat();for(Mi=0,ni=Bi.length;Mi<ni;Mi++){ln=Bi[Mi];var Yr=[];for(Ee=0,Ut=ln.length,Ve=Ut-1,Bt=Ee+1;Ee<Ut;Ee++,Ve++,Bt++)Ve===Ut&&(Ve=0),Bt===Ut&&(Bt=0),Yr[Ee]=q(ln[Ee],ln[Ve],ln[Bt]);fe.push(Yr),dr=dr.concat(Yr)}for(Ve=0;Ve<Fe;Ve++){Ut=Ve/Fe;var xr=le*Math.cos(Ut*Math.PI/2);for(Bt=Wt*Math.sin(Ut*Math.PI/2)+Me,Ee=0,Ut=wt.length;Ee<Ut;Ee++){var or=b(wt[Ee],jt[Ee],Bt);Q(or.x,or.y,-xr)}for(Mi=0,ni=Bi.length;Mi<ni;Mi++)for(ln=Bi[Mi],Yr=fe[Mi],Ee=0,Ut=ln.length;Ee<Ut;Ee++)or=b(ln[Ee],Yr[Ee],Bt),Q(or.x,or.y,-xr)}for(Bt=Wt+Me,Ee=0;Ee<ve;Ee++)or=Zt?b(k[Ee],dr[Ee],Bt):k[Ee],Oe?(Hr.copy(jr.normals[0]).multiplyScalar(or.x),er.copy(jr.binormals[0]).multiplyScalar(or.y),xi.copy(vr[0]).add(Hr).add(er),Q(xi.x,xi.y,xi.z)):Q(or.x,or.y,0);for(Ut=1;Ut<=Gt;Ut++)for(Ee=0;Ee<ve;Ee++)or=Zt?b(k[Ee],dr[Ee],Bt):k[Ee],Oe?(Hr.copy(jr.normals[Ut]).multiplyScalar(or.x),er.copy(jr.binormals[Ut]).multiplyScalar(or.y),xi.copy(vr[Ut]).add(Hr).add(er),Q(xi.x,xi.y,xi.z)):Q(or.x,or.y,ee/Gt*Ut);for(Ve=Fe-1;0<=Ve;Ve--){for(Ut=Ve/Fe,xr=le*Math.cos(Ut*Math.PI/2),Bt=Wt*Math.sin(Ut*Math.PI/2)+Me,Ee=0,Ut=wt.length;Ee<Ut;Ee++)or=b(wt[Ee],jt[Ee],Bt),Q(or.x,or.y,ee+xr);for(Mi=0,ni=Bi.length;Mi<ni;Mi++)for(ln=Bi[Mi],Yr=fe[Mi],Ee=0,Ut=ln.length;Ee<Ut;Ee++)or=b(ln[Ee],Yr[Ee],Bt),Oe?Q(or.x,or.y+vr[Gt-1].y,vr[Gt-1].x+xr):Q(or.x,or.y,ee+xr)}(function(){var sr=w.length/3;if(Zt){var ui=0*ve;for(Ee=0;Ee<ur;Ee++)He=Tn[Ee],K(He[2]+ui,He[1]+ui,He[0]+ui);for(ui=ve*(Gt+2*Fe),Ee=0;Ee<ur;Ee++)He=Tn[Ee],K(He[0]+ui,He[1]+ui,He[2]+ui)}else{for(Ee=0;Ee<ur;Ee++)He=Tn[Ee],K(He[2],He[1],He[0]);for(Ee=0;Ee<ur;Ee++)He=Tn[Ee],K(He[0]+ve*Gt,He[1]+ve*Gt,He[2]+ve*Gt)}m.addGroup(sr,w.length/3-sr,0)})(),function(){var sr=w.length/3,ui=0;for(J(wt,ui),ui+=wt.length,Mi=0,ni=Bi.length;Mi<ni;Mi++)ln=Bi[Mi],J(ln,ui),ui+=ln.length;m.addGroup(sr,w.length/3-sr,1)}()}ft.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:o},e=Array.isArray(e)?e:[e];for(var m=this,w=[],T=[],R=0,z=e.length;R<z;R++)h(e[R]);this.setAttribute("position",new vt(w,3)),this.setAttribute("uv",new vt(T,2)),this.computeVertexNormals()}function G_(e,o,h){if(h.shapes=[],Array.isArray(e))for(var m=0,w=e.length;m<w;m++)h.shapes.push(e[m].uuid);else h.shapes.push(e.uuid);return o.extrudePath!==void 0&&(h.options.extrudePath=o.extrudePath.toJSON()),h}function u0(e,o){pt.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:o},this.fromBufferGeometry(new bg(e,o)),this.mergeVertices()}function bg(e,o){o=o||{};var h=o.font;if(!h||!h.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new pt;e=h.generateShapes(e,o.size),o.depth=o.height!==void 0?o.height:50,o.bevelThickness===void 0&&(o.bevelThickness=10),o.bevelSize===void 0&&(o.bevelSize=8),o.bevelEnabled===void 0&&(o.bevelEnabled=!1),Xl.call(this,e,o),this.type="TextBufferGeometry"}function l0(e,o,h,m,w,T,R){pt.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:o,heightSegments:h,phiStart:m,phiLength:w,thetaStart:T,thetaLength:R},this.fromBufferGeometry(new Dp(e,o,h,m,w,T,R)),this.mergeVertices()}function Dp(e,o,h,m,w,T,R){ft.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:o,heightSegments:h,phiStart:m,phiLength:w,thetaStart:T,thetaLength:R},e=e||1,o=Math.max(3,Math.floor(o)||8),h=Math.max(2,Math.floor(h)||6),m=m!==void 0?m:0,w=w!==void 0?w:2*Math.PI,T=T!==void 0?T:0,R=R!==void 0?R:Math.PI;var z=Math.min(T+R,Math.PI),k,b,q=0,J=[],Q=new _,K=new _,rt=[],ht=[],Ot=[],jt=[];for(b=0;b<=h;b++){var Gt=[],ee=b/h,Zt=0;for(b==0&&T==0?Zt=.5/o:b==h&&z==Math.PI&&(Zt=-.5/o),k=0;k<=o;k++){var le=k/o;Q.x=-e*Math.cos(m+le*w)*Math.sin(T+ee*R),Q.y=e*Math.cos(T+ee*R),Q.z=e*Math.sin(m+le*w)*Math.sin(T+ee*R),ht.push(Q.x,Q.y,Q.z),K.copy(Q).normalize(),Ot.push(K.x,K.y,K.z),jt.push(le+Zt,1-ee),Gt.push(q++)}J.push(Gt)}for(b=0;b<h;b++)for(k=0;k<o;k++)e=J[b][k+1],m=J[b][k],w=J[b+1][k],R=J[b+1][k+1],(b!==0||0<T)&&rt.push(e,m,R),(b!==h-1||z<Math.PI)&&rt.push(m,w,R);this.setIndex(rt),this.setAttribute("position",new vt(ht,3)),this.setAttribute("normal",new vt(Ot,3)),this.setAttribute("uv",new vt(jt,2))}function h0(e,o,h,m,w,T){pt.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:o,thetaSegments:h,phiSegments:m,thetaStart:w,thetaLength:T},this.fromBufferGeometry(new Vg(e,o,h,m,w,T)),this.mergeVertices()}function Vg(e,o,h,m,w,T){ft.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:o,thetaSegments:h,phiSegments:m,thetaStart:w,thetaLength:T},e=e||.5,o=o||1,w=w!==void 0?w:0,T=T!==void 0?T:2*Math.PI,h=h!==void 0?Math.max(3,h):8,m=m!==void 0?Math.max(1,m):1;var R=[],z=[],k=[],b=[],q=e,J=(o-e)/m,Q=new _,K=new f,rt,ht;for(rt=0;rt<=m;rt++){for(ht=0;ht<=h;ht++)e=w+ht/h*T,Q.x=q*Math.cos(e),Q.y=q*Math.sin(e),z.push(Q.x,Q.y,Q.z),k.push(0,0,1),K.x=(Q.x/o+1)/2,K.y=(Q.y/o+1)/2,b.push(K.x,K.y);q+=J}for(rt=0;rt<m;rt++)for(o=rt*(h+1),ht=0;ht<h;ht++)e=ht+o,w=e+h+1,T=e+h+2,q=e+1,R.push(e,w,q),R.push(w,T,q);this.setIndex(R),this.setAttribute("position",new vt(z,3)),this.setAttribute("normal",new vt(k,3)),this.setAttribute("uv",new vt(b,2))}function c0(e,o,h,m){pt.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:o,phiStart:h,phiLength:m},this.fromBufferGeometry(new Wg(e,o,h,m)),this.mergeVertices()}function Wg(e,o,h,m){ft.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:o,phiStart:h,phiLength:m},o=Math.floor(o)||12,h=h||0,m=m||2*Math.PI,m=Si.clamp(m,0,2*Math.PI);var w=[],T=[],R=[],z=1/o,k=new _,b=new f,q;for(q=0;q<=o;q++){var J=h+q*z*m,Q=Math.sin(J),K=Math.cos(J);for(J=0;J<=e.length-1;J++)k.x=e[J].x*Q,k.y=e[J].y,k.z=e[J].x*K,T.push(k.x,k.y,k.z),b.x=q/o,b.y=J/(e.length-1),R.push(b.x,b.y)}for(q=0;q<o;q++)for(J=0;J<e.length-1;J++)h=J+q*e.length,z=h+e.length,k=h+e.length+1,b=h+1,w.push(h,z,b),w.push(z,k,b);if(this.setIndex(w),this.setAttribute("position",new vt(T,3)),this.setAttribute("uv",new vt(R,2)),this.computeVertexNormals(),m===2*Math.PI)for(m=this.attributes.normal.array,w=new _,T=new _,R=new _,h=o*e.length*3,J=q=0;q<e.length;q++,J+=3)w.x=m[J+0],w.y=m[J+1],w.z=m[J+2],T.x=m[h+J+0],T.y=m[h+J+1],T.z=m[h+J+2],R.addVectors(w,T).normalize(),m[J+0]=m[h+J+0]=R.x,m[J+1]=m[h+J+1]=R.y,m[J+2]=m[h+J+2]=R.z}function Op(e,o){pt.call(this),this.type="ShapeGeometry",(typeof o=="undefined"?"undefined":Ua(o))==="object"&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),o=o.curveSegments),this.parameters={shapes:e,curveSegments:o},this.fromBufferGeometry(new Fp(e,o)),this.mergeVertices()}function Fp(e,o){function h(q){var J,Q=w.length/3;q=q.extractPoints(o);var K=q.shape,rt=q.holes;for(nc.isClockWise(K)===!1&&(K=K.reverse()),q=0,J=rt.length;q<J;q++){var ht=rt[q];nc.isClockWise(ht)===!0&&(rt[q]=ht.reverse())}var Ot=nc.triangulateShape(K,rt);for(q=0,J=rt.length;q<J;q++)ht=rt[q],K=K.concat(ht);for(q=0,J=K.length;q<J;q++)ht=K[q],w.push(ht.x,ht.y,0),T.push(0,0,1),R.push(ht.x,ht.y);for(q=0,J=Ot.length;q<J;q++)K=Ot[q],m.push(K[0]+Q,K[1]+Q,K[2]+Q),k+=3}ft.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:o},o=o||12;var m=[],w=[],T=[],R=[],z=0,k=0;if(Array.isArray(e)===!1)h(e);else for(var b=0;b<e.length;b++)h(e[b]),this.addGroup(z,k,b),z+=k,k=0;this.setIndex(m),this.setAttribute("position",new vt(w,3)),this.setAttribute("normal",new vt(T,3)),this.setAttribute("uv",new vt(R,2))}function b_(e,o){if(o.shapes=[],Array.isArray(e))for(var h=0,m=e.length;h<m;h++)o.shapes.push(e[h].uuid);else o.shapes.push(e.uuid);return o}function jg(e,o){ft.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:o};var h=[];o=Math.cos(Si.DEG2RAD*(o!==void 0?o:1));var m=[0,0],w={},T=["a","b","c"];if(e.isBufferGeometry){var R=new pt;R.fromBufferGeometry(e)}else R=e.clone();R.mergeVertices(),R.computeFaceNormals(),e=R.vertices,R=R.faces;for(var z=0,k=R.length;z<k;z++)for(var b=R[z],q=0;3>q;q++){var J=b[T[q]],Q=b[T[(q+1)%3]];m[0]=Math.min(J,Q),m[1]=Math.max(J,Q),J=m[0]+","+m[1],w[J]===void 0?w[J]={index1:m[0],index2:m[1],face1:z,face2:void 0}:w[J].face2=z}for(J in w)m=w[J],(m.face2===void 0||R[m.face1].normal.dot(R[m.face2].normal)<=o)&&(T=e[m.index1],h.push(T.x,T.y,T.z),T=e[m.index2],h.push(T.x,T.y,T.z));this.setAttribute("position",new vt(h,3))}function Bp(e,o,h,m,w,T,R,z){pt.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:o,height:h,radialSegments:m,heightSegments:w,openEnded:T,thetaStart:R,thetaLength:z},this.fromBufferGeometry(new Zh(e,o,h,m,w,T,R,z)),this.mergeVertices()}function Zh(e,o,h,m,w,T,R,z){function k(Gt){var ee,Zt=new f,le=new _,Wt=0,Me=Gt===!0?e:o,Fe=Gt===!0?1:-1,fe=rt;for(ee=1;ee<=m;ee++)J.push(0,Ot*Fe,0),Q.push(0,Fe,0),K.push(.5,.5),rt++;var Ne=rt;for(ee=0;ee<=m;ee++){var Oe=ee/m*z+R,vr=Math.cos(Oe);Oe=Math.sin(Oe),le.x=Me*Oe,le.y=Ot*Fe,le.z=Me*vr,J.push(le.x,le.y,le.z),Q.push(0,Fe,0),Zt.x=.5*vr+.5,Zt.y=.5*Oe*Fe+.5,K.push(Zt.x,Zt.y),rt++}for(ee=0;ee<m;ee++)Zt=fe+ee,le=Ne+ee,Gt===!0?q.push(le,le+1,Zt):q.push(le+1,le,Zt),Wt+=3;b.addGroup(jt,Wt,Gt===!0?1:2),jt+=Wt}ft.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:o,height:h,radialSegments:m,heightSegments:w,openEnded:T,thetaStart:R,thetaLength:z};var b=this;e=e!==void 0?e:1,o=o!==void 0?o:1,h=h||1,m=Math.floor(m)||8,w=Math.floor(w)||1,T=T!==void 0?T:!1,R=R!==void 0?R:0,z=z!==void 0?z:2*Math.PI;var q=[],J=[],Q=[],K=[],rt=0,ht=[],Ot=h/2,jt=0;(function(){var Gt,ee,Zt=new _,le=new _,Wt=0,Me=(o-e)/h;for(ee=0;ee<=w;ee++){var Fe=[],fe=ee/w,Ne=fe*(o-e)+e;for(Gt=0;Gt<=m;Gt++){var Oe=Gt/m,vr=Oe*z+R,jr=Math.sin(vr);vr=Math.cos(vr),le.x=Ne*jr,le.y=-fe*h+Ot,le.z=Ne*vr,J.push(le.x,le.y,le.z),Zt.set(jr,Me,vr).normalize(),Q.push(Zt.x,Zt.y,Zt.z),K.push(Oe,1-fe),Fe.push(rt++)}ht.push(Fe)}for(Gt=0;Gt<m;Gt++)for(ee=0;ee<w;ee++)Zt=ht[ee+1][Gt],le=ht[ee+1][Gt+1],Me=ht[ee][Gt+1],q.push(ht[ee][Gt],Zt,Me),q.push(Zt,le,Me),Wt+=6;b.addGroup(jt,Wt,0),jt+=Wt})(),T===!1&&(0<e&&k(!0),0<o&&k(!1)),this.setIndex(q),this.setAttribute("position",new vt(J,3)),this.setAttribute("normal",new vt(Q,3)),this.setAttribute("uv",new vt(K,2))}function f0(e,o,h,m,w,T,R){Bp.call(this,0,e,o,h,m,w,T,R),this.type="ConeGeometry",this.parameters={radius:e,height:o,radialSegments:h,heightSegments:m,openEnded:w,thetaStart:T,thetaLength:R}}function p0(e,o,h,m,w,T,R){Zh.call(this,0,e,o,h,m,w,T,R),this.type="ConeBufferGeometry",this.parameters={radius:e,height:o,radialSegments:h,heightSegments:m,openEnded:w,thetaStart:T,thetaLength:R}}function d0(e,o,h,m){pt.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:o,thetaStart:h,thetaLength:m},this.fromBufferGeometry(new Xg(e,o,h,m)),this.mergeVertices()}function Xg(e,o,h,m){ft.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:o,thetaStart:h,thetaLength:m},e=e||1,o=o!==void 0?Math.max(3,o):8,h=h!==void 0?h:0,m=m!==void 0?m:2*Math.PI;var w=[],T=[],R=[],z=[],k,b=new _,q=new f;T.push(0,0,0),R.push(0,0,1),z.push(.5,.5);var J=0;for(k=3;J<=o;J++,k+=3){var Q=h+J/o*m;b.x=e*Math.cos(Q),b.y=e*Math.sin(Q),T.push(b.x,b.y,b.z),R.push(0,0,1),q.x=(T[k]/e+1)/2,q.y=(T[k+1]/e+1)/2,z.push(q.x,q.y)}for(k=1;k<=o;k++)w.push(k,k+1,0);this.setIndex(w),this.setAttribute("position",new vt(T,3)),this.setAttribute("normal",new vt(R,3)),this.setAttribute("uv",new vt(z,2))}function Np(e){Kt.call(this),this.type="ShadowMaterial",this.color=new yt(0),this.transparent=!0,this.setValues(e)}function Jh(e){de.call(this,e),this.type="RawShaderMaterial"}function Yl(e){Kt.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new yt(16777215),this.roughness=1,this.metalness=0,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new yt(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new f(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexTangents=this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function zp(e){Yl.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new f(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transparency=0,this.setValues(e)}function sf(e){Kt.call(this),this.type="MeshPhongMaterial",this.color=new yt(16777215),this.specular=new yt(1118481),this.shininess=30,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new yt(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new f(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function Up(e){Kt.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new yt(16777215),this.specular=new yt(1118481),this.shininess=30,this.lightMap=this.gradientMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new yt(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new f(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=this.specularMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function Hp(e){Kt.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new f(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.fog=!1,this.setValues(e)}function kp(e){Kt.call(this),this.type="MeshLambertMaterial",this.color=new yt(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new yt(0),this.emissiveIntensity=1,this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function Gp(e){Kt.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new yt(16777215),this.bumpMap=this.map=this.matcap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new f(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function bp(e){to.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}function Xa(e,o,h,m){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=m!==void 0?m:new o.constructor(h),this.sampleValues=o,this.valueSize=h}function ky(e,o,h,m){Xa.call(this,e,o,h,m),this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0}function g0(e,o,h,m){Xa.call(this,e,o,h,m)}function Gy(e,o,h,m){Xa.call(this,e,o,h,m)}function fs(e,o,h,m){if(e===void 0)throw Error("THREE.KeyframeTrack: track name is undefined");if(o===void 0||o.length===0)throw Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=eo.convertArray(o,this.TimeBufferType),this.values=eo.convertArray(h,this.ValueBufferType),this.setInterpolation(m||this.DefaultInterpolation)}function by(e,o,h){fs.call(this,e,o,h)}function Vy(e,o,h,m){fs.call(this,e,o,h,m)}function Yg(e,o,h,m){fs.call(this,e,o,h,m)}function Wy(e,o,h,m){Xa.call(this,e,o,h,m)}function m0(e,o,h,m){fs.call(this,e,o,h,m)}function jy(e,o,h,m){fs.call(this,e,o,h,m)}function Zg(e,o,h,m){fs.call(this,e,o,h,m)}function yu(e,o,h,m){this.name=e,this.tracks=h,this.duration=o!==void 0?o:-1,this.blendMode=m!==void 0?m:2500,this.uuid=Si.generateUUID(),0>this.duration&&this.resetDuration()}function G3(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Yg;case"vector":case"vector2":case"vector3":case"vector4":return Zg;case"color":return Vy;case"quaternion":return m0;case"bool":case"boolean":return by;case"string":return jy}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function b3(e){if(e.type===void 0)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");var o=G3(e.type);if(e.times===void 0){var h=[],m=[];eo.flattenJSON(e.keys,h,m,"value"),e.times=h,e.values=m}return o.parse!==void 0?o.parse(e):new o(e.name,e.times,e.values,e.interpolation)}function m2(e,o,h){var m=this,w=!1,T=0,R=0,z=void 0,k=[];this.onStart=void 0,this.onLoad=e,this.onProgress=o,this.onError=h,this.itemStart=function(b){R++,w===!1&&m.onStart!==void 0&&m.onStart(b,T,R),w=!0},this.itemEnd=function(b){T++,m.onProgress!==void 0&&m.onProgress(b,T,R),T===R&&(w=!1,m.onLoad!==void 0)&&m.onLoad()},this.itemError=function(b){m.onError!==void 0&&m.onError(b)},this.resolveURL=function(b){return z?z(b):b},this.setURLModifier=function(b){return z=b,this},this.addHandler=function(b,q){return k.push(b,q),this},this.removeHandler=function(b){return b=k.indexOf(b),b!==-1&&k.splice(b,2),this},this.getHandler=function(b){for(var q=0,J=k.length;q<J;q+=2){var Q=k[q],K=k[q+1];if(Q.global&&(Q.lastIndex=0),Q.test(b))return K}return null}}function Mn(e){this.manager=e!==void 0?e:FM,this.crossOrigin="anonymous",this.resourcePath=this.path="",this.requestHeader={}}function xu(e){Mn.call(this,e)}function v2(e){Mn.call(this,e)}function y2(e){Mn.call(this,e)}function Xy(e){Mn.call(this,e)}function Jg(e){Mn.call(this,e)}function Yy(e){Mn.call(this,e)}function Zy(e){Mn.call(this,e)}function qr(){this.type="Curve",this.arcLengthDivisions=200}function Ya(e,o,h,m,w,T,R,z){qr.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=o||0,this.xRadius=h||1,this.yRadius=m||1,this.aStartAngle=w||0,this.aEndAngle=T||2*Math.PI,this.aClockwise=R||!1,this.aRotation=z||0}function qg(e,o,h,m,w,T){Ya.call(this,e,o,h,h,m,w,T),this.type="ArcCurve"}function x2(){var e=0,o=0,h=0,m=0;return{initCatmullRom:function(w,T,R,z,k){w=k*(R-w),z=k*(z-T),e=T,o=w,h=-3*T+3*R-2*w-z,m=2*T-2*R+w+z},initNonuniformCatmullRom:function(w,T,R,z,k,b,q){w=((T-w)/k-(R-w)/(k+b)+(R-T)/b)*b,z=((R-T)/b-(z-T)/(b+q)+(z-R)/q)*b,e=T,o=w,h=-3*T+3*R-2*w-z,m=2*T-2*R+w+z},calc:function(w){var T=w*w;return e+o*w+h*T+m*T*w}}}function Ns(e,o,h,m){qr.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=o||!1,this.curveType=h||"centripetal",this.tension=m||.5}function V_(e,o,h,m,w){o=.5*(m-o),w=.5*(w-h);var T=e*e;return(2*h-2*m+o+w)*e*T+(-3*h+3*m-2*o-w)*T+o*e+h}function v0(e,o,h,m){var w=1-e;return w*w*o+2*(1-e)*e*h+e*e*m}function y0(e,o,h,m,w){var T=1-e,R=1-e;return T*T*T*o+3*R*R*e*h+3*(1-e)*e*e*m+e*e*e*w}function Ju(e,o,h,m){qr.call(this),this.type="CubicBezierCurve",this.v0=e||new f,this.v1=o||new f,this.v2=h||new f,this.v3=m||new f}function Zl(e,o,h,m){qr.call(this),this.type="CubicBezierCurve3",this.v0=e||new _,this.v1=o||new _,this.v2=h||new _,this.v3=m||new _}function _a(e,o){qr.call(this),this.type="LineCurve",this.v1=e||new f,this.v2=o||new f}function qu(e,o){qr.call(this),this.type="LineCurve3",this.v1=e||new _,this.v2=o||new _}function Ku(e,o,h){qr.call(this),this.type="QuadraticBezierCurve",this.v0=e||new f,this.v1=o||new f,this.v2=h||new f}function Jl(e,o,h){qr.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new _,this.v1=o||new _,this.v2=h||new _}function Qu(e){qr.call(this),this.type="SplineCurve",this.points=e||[]}function qh(){qr.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function $u(e){qh.call(this),this.type="Path",this.currentPoint=new f,e&&this.setFromPoints(e)}function af(e){$u.call(this,e),this.uuid=Si.generateUUID(),this.type="Shape",this.holes=[]}function On(e,o){F.call(this),this.type="Light",this.color=new yt(e),this.intensity=o!==void 0?o:1,this.receiveShadow=void 0}function Jy(e,o,h){On.call(this,e,h),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(F.DefaultUp),this.updateMatrix(),this.groundColor=new yt(o)}function ql(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new f(512,512),this.mapPass=this.map=null,this.matrix=new I,this._frustum=new nr,this._frameExtents=new f(1,1),this._viewportCount=1,this._viewports=[new p(0,0,1,1)]}function qy(){ql.call(this,new Te(50,1,.5,500))}function Ky(e,o,h,m,w,T){On.call(this,e,o),this.type="SpotLight",this.position.copy(F.DefaultUp),this.updateMatrix(),this.target=new F,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(R){this.intensity=R/Math.PI}}),this.distance=h!==void 0?h:0,this.angle=m!==void 0?m:Math.PI/3,this.penumbra=w!==void 0?w:0,this.decay=T!==void 0?T:1,this.shadow=new qy}function A2(){ql.call(this,new Te(90,1,.5,500)),this._frameExtents=new f(4,2),this._viewportCount=6,this._viewports=[new p(2,1,1,1),new p(0,1,1,1),new p(3,1,1,1),new p(1,1,1,1),new p(3,0,1,1),new p(1,0,1,1)],this._cubeDirections=[new _(1,0,0),new _(-1,0,0),new _(0,0,1),new _(0,0,-1),new _(0,1,0),new _(0,-1,0)],this._cubeUps=[new _(0,1,0),new _(0,1,0),new _(0,1,0),new _(0,1,0),new _(0,0,1),new _(0,0,-1)]}function Qy(e,o,h,m){On.call(this,e,o),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(w){this.intensity=w/(4*Math.PI)}}),this.distance=h!==void 0?h:0,this.decay=m!==void 0?m:1,this.shadow=new A2}function Kg(e,o,h,m,w,T){ie.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e!==void 0?e:-1,this.right=o!==void 0?o:1,this.top=h!==void 0?h:1,this.bottom=m!==void 0?m:-1,this.near=w!==void 0?w:.1,this.far=T!==void 0?T:2e3,this.updateProjectionMatrix()}function $y(){ql.call(this,new Kg(-5,5,5,-5,.5,500))}function tx(e,o){On.call(this,e,o),this.type="DirectionalLight",this.position.copy(F.DefaultUp),this.updateMatrix(),this.target=new F,this.shadow=new $y}function ex(e,o){On.call(this,e,o),this.type="AmbientLight",this.castShadow=void 0}function rx(e,o,h,m){On.call(this,e,o),this.type="RectAreaLight",this.width=h!==void 0?h:10,this.height=m!==void 0?m:10}function ix(){this.coefficients=[];for(var e=0;9>e;e++)this.coefficients.push(new _)}function Au(e,o){On.call(this,void 0,o),this.type="LightProbe",this.sh=e!==void 0?e:new ix}function nx(e){Mn.call(this,e),this.textures={}}function x0(){ft.call(this),this.type="InstancedBufferGeometry",this.instanceCount=Infinity}function ox(e,o,h,m){typeof h=="number"&&(m=h,h=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),ae.call(this,e,o,h),this.meshPerAttribute=m||1}function sx(e){Mn.call(this,e)}function ax(e){Mn.call(this,e)}function w2(e){typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Mn.call(this,e),this.options=void 0}function _2(){this.type="ShapePath",this.color=new yt,this.subPaths=[],this.currentPath=null}function M2(e){this.type="Font",this.data=e}function C2(e){Mn.call(this,e)}function ux(e){Mn.call(this,e)}function T2(e,o,h){Au.call(this,void 0,h),e=new yt().set(e),h=new yt().set(o),o=new _(e.r,e.g,e.b),e=new _(h.r,h.g,h.b),h=Math.sqrt(Math.PI);var m=h*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(e).multiplyScalar(h),this.sh.coefficients[1].copy(o).sub(e).multiplyScalar(m)}function S2(e,o){Au.call(this,void 0,o),e=new yt().set(e),this.sh.coefficients[0].set(e.r,e.g,e.b).multiplyScalar(2*Math.sqrt(Math.PI))}function W_(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Te,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Te,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}function I2(e){this.autoStart=e!==void 0?e:!0,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1}function E2(){F.call(this),this.type="AudioListener",this.context=mw.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new I2}function Qg(e){F.call(this),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.offset=this.loopEnd=this.loopStart=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._progress=this._startedAt=0,this.filters=[]}function L2(e){Qg.call(this,e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function R2(e,o){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=o!==void 0?o:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function P2(e,o,h){switch(this.binding=e,this.valueSize=h,o){case"quaternion":e=this._slerp,o=this._slerpAdditive;var m=this._setAdditiveIdentityQuaternion;this.buffer=new Float64Array(6*h),this._workIndex=5;break;case"string":case"bool":o=e=this._select,m=this._setAdditiveIdentityOther,this.buffer=Array(5*h);break;default:e=this._lerp,o=this._lerpAdditive,m=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*h)}this._mixBufferRegion=e,this._mixBufferRegionAdditive=o,this._setIdentity=m,this._origIndex=3,this._addIndex=4,this.referenceCount=this.useCount=this.cumulativeWeightAdditive=this.cumulativeWeight=0}function j_(e,o,h){h=h||zs.parseTrackName(o),this._targetGroup=e,this._bindings=e.subscribe_(o,h)}function zs(e,o,h){this.path=o,this.parsedPath=h||zs.parseTrackName(o),this.node=zs.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function X_(){this.uuid=Si.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var o=0,h=arguments.length;o!==h;++o)e[arguments[o].uuid]=o;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var m=this;this.stats={objects:{get total(){return m._objects.length},get inUse(){return this.total-m.nCachedObjects_}},get bindingsPerObject(){return m._bindings.length}}}function Y_(e,o,h,m){this._mixer=e,this._clip=o,this._localRoot=h||null,this.blendMode=m||o.blendMode,e=o.tracks,o=e.length,h=Array(o),m={endingStart:2400,endingEnd:2400};for(var w=0;w!==o;++w){var T=e[w].createInterpolant(null);h[w]=T,T.settings=m}this._interpolantSettings=m,this._interpolants=h,this._propertyBindings=Array(o),this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1,this.repetitions=Infinity,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}function D2(e){this._root=e,this._initMemoryManager(),this.time=this._accuIndex=0,this.timeScale=1}function lx(e,o){typeof e=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=o),this.value=e}function O2(e,o,h){Yh.call(this,e,o),this.meshPerAttribute=h||1}function F2(e,o,h,m){this.ray=new ot(e,o),this.near=h||0,this.far=m||Infinity,this.camera=null,this.layers=new P,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Xr(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Z_(e,o){return e.distance-o.distance}function B2(e,o,h,m){if(e.layers.test(o.layers)&&e.raycast(o,h),m===!0){e=e.children,m=0;for(var w=e.length;m<w;m++)B2(e[m],o,h,!0)}}function J_(e,o,h){return this.radius=e!==void 0?e:1,this.phi=o!==void 0?o:0,this.theta=h!==void 0?h:0,this}function q_(e,o,h){return this.radius=e!==void 0?e:1,this.theta=o!==void 0?o:0,this.y=h!==void 0?h:0,this}function N2(e,o){this.min=e!==void 0?e:new f(Infinity,Infinity),this.max=o!==void 0?o:new f(-Infinity,-Infinity)}function z2(e,o){this.start=e!==void 0?e:new _,this.end=o!==void 0?o:new _}function A0(e){F.call(this),this.material=e,this.render=function(){},this.hasUvs=this.hasColors=this.hasNormals=this.hasPositions=!1,this.uvArray=this.colorArray=this.normalArray=this.positionArray=null,this.count=0}function $g(e,o){F.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=o,e=new ft,o=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(var h=0,m=1;32>h;h++,m++){var w=h/32*Math.PI*2,T=m/32*Math.PI*2;o.push(Math.cos(w),Math.sin(w),1,Math.cos(T),Math.sin(T),1)}e.setAttribute("position",new vt(o,3)),o=new to({fog:!1,toneMapped:!1}),this.cone=new lo(e,o),this.add(this.cone),this.update()}function K_(e){var o=[];e&&e.isBone&&o.push(e);for(var h=0;h<e.children.length;h++)o.push.apply(o,K_(e.children[h]));return o}function Vp(e){for(var o=K_(e),h=new ft,m=[],w=[],T=new yt(0,0,1),R=new yt(0,1,0),z=0;z<o.length;z++){var k=o[z];k.parent&&k.parent.isBone&&(m.push(0,0,0),m.push(0,0,0),w.push(T.r,T.g,T.b),w.push(R.r,R.g,R.b))}h.setAttribute("position",new vt(m,3)),h.setAttribute("color",new vt(w,3)),m=new to({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0}),lo.call(this,h,m),this.type="SkeletonHelper",this.root=e,this.bones=o,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function tm(e,o,h){this.light=e,this.light.updateMatrixWorld(),this.color=h,e=new Dp(o,4,2),o=new ze({wireframe:!0,fog:!1,toneMapped:!1}),Tt.call(this,e,o),this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function em(e,o,h){F.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=h,e=new Lp(o),e.rotateY(.5*Math.PI),this.material=new ze({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0),o=e.getAttribute("position"),o=new Float32Array(3*o.count),e.setAttribute("color",new ae(o,3)),this.add(new Tt(e,this.material)),this.update()}function hx(e,o,h,m){e=e||10,o=o||10,h=new yt(h!==void 0?h:4473924),m=new yt(m!==void 0?m:8947848);var w=o/2,T=e/o,R=e/2;e=[];for(var z=[],k=0,b=0,q=-R;k<=o;k++,q+=T){e.push(-R,0,q,R,0,q),e.push(q,0,-R,q,0,R);var J=k===w?h:m;J.toArray(z,b),b+=3,J.toArray(z,b),b+=3,J.toArray(z,b),b+=3,J.toArray(z,b),b+=3}o=new ft,o.setAttribute("position",new vt(e,3)),o.setAttribute("color",new vt(z,3)),h=new to({vertexColors:!0,toneMapped:!1}),lo.call(this,o,h),this.type="GridHelper"}function cx(e,o,h,m,w,T){e=e||10,o=o||16,h=h||8,m=m||64,w=new yt(w!==void 0?w:4473924),T=new yt(T!==void 0?T:8947848);var R=[],z=[],k;for(k=0;k<=o;k++){var b=k/o*2*Math.PI,q=Math.sin(b)*e;b=Math.cos(b)*e,R.push(0,0,0),R.push(q,0,b);var J=k&1?w:T;z.push(J.r,J.g,J.b),z.push(J.r,J.g,J.b)}for(k=0;k<=h;k++){J=k&1?w:T;var Q=e-e/h*k;for(o=0;o<m;o++)b=o/m*2*Math.PI,q=Math.sin(b)*Q,b=Math.cos(b)*Q,R.push(q,0,b),z.push(J.r,J.g,J.b),b=(o+1)/m*2*Math.PI,q=Math.sin(b)*Q,b=Math.cos(b)*Q,R.push(q,0,b),z.push(J.r,J.g,J.b)}e=new ft,e.setAttribute("position",new vt(R,3)),e.setAttribute("color",new vt(z,3)),R=new to({vertexColors:!0,toneMapped:!1}),lo.call(this,e,R),this.type="PolarGridHelper"}function rm(e,o,h){F.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=h,o===void 0&&(o=1),e=new ft,e.setAttribute("position",new vt([-o,o,0,o,o,0,o,-o,0,-o,-o,0,-o,o,0],3)),o=new to({fog:!1,toneMapped:!1}),this.lightPlane=new ja(e,o),this.add(this.lightPlane),e=new ft,e.setAttribute("position",new vt([0,0,0,0,0,1],3)),this.targetLine=new ja(e,o),this.add(this.targetLine),this.update()}function w0(e){function o(K,rt,ht){h(K,ht),h(rt,ht)}function h(K,rt){T.push(0,0,0),R.push(rt.r,rt.g,rt.b),z[K]===void 0&&(z[K]=[]),z[K].push(T.length/3-1)}var m=new ft,w=new to({color:16777215,vertexColors:!0,toneMapped:!1}),T=[],R=[],z={},k=new yt(16755200),b=new yt(16711680),q=new yt(43775),J=new yt(16777215),Q=new yt(3355443);o("n1","n2",k),o("n2","n4",k),o("n4","n3",k),o("n3","n1",k),o("f1","f2",k),o("f2","f4",k),o("f4","f3",k),o("f3","f1",k),o("n1","f1",k),o("n2","f2",k),o("n3","f3",k),o("n4","f4",k),o("p","n1",b),o("p","n2",b),o("p","n3",b),o("p","n4",b),o("u1","u2",q),o("u2","u3",q),o("u3","u1",q),o("c","t",J),o("p","c",Q),o("cn1","cn2",Q),o("cn3","cn4",Q),o("cf1","cf2",Q),o("cf3","cf4",Q),m.setAttribute("position",new vt(T,3)),m.setAttribute("color",new vt(R,3)),lo.call(this,m,w),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=z,this.update()}function So(e,o,h,m,w,T,R){if(kx.set(w,T,R).unproject(m),e=o[e],e!==void 0)for(h=h.getAttribute("position"),o=0,m=e.length;o<m;o++)h.setXYZ(e[o],kx.x,kx.y,kx.z)}function Kh(e,o){this.object=e,o===void 0&&(o=16776960),e=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var h=new Float32Array(24),m=new ft;m.setIndex(new ae(e,1)),m.setAttribute("position",new ae(h,3)),lo.call(this,m,new to({color:o,toneMapped:!1})),this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}function _0(e,o){this.type="Box3Helper",this.box=e,o=o||16776960,e=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var h=new ft;h.setIndex(new ae(e,1)),h.setAttribute("position",new vt([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),lo.call(this,h,new to({color:o,toneMapped:!1})),this.type="Box3Helper",this.geometry.computeBoundingSphere()}function M0(e,o,h){this.plane=e,this.size=o===void 0?1:o,e=h!==void 0?h:16776960,o=new ft,o.setAttribute("position",new vt([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),o.computeBoundingSphere(),ja.call(this,o,new to({color:e,toneMapped:!1})),this.type="PlaneHelper",o=new ft,o.setAttribute("position",new vt([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),o.computeBoundingSphere(),this.add(new Tt(o,new ze({color:e,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}function Qh(e,o,h,m,w,T){F.call(this),this.type="ArrowHelper",e===void 0&&(e=new _(0,0,1)),o===void 0&&(o=new _(0,0,0)),h===void 0&&(h=1),m===void 0&&(m=16776960),w===void 0&&(w=.2*h),T===void 0&&(T=.2*w),bx===void 0&&(bx=new ft,bx.setAttribute("position",new vt([0,0,0,0,1,0],3)),yw=new Zh(0,.5,1,5,1),yw.translate(0,-.5,0)),this.position.copy(o),this.line=new ja(bx,new to({color:m,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Tt(yw,new ze({color:m,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(h,w,T)}function C0(e){e=e||1;var o=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e];e=new ft,e.setAttribute("position",new vt(o,3)),e.setAttribute("color",new vt([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),o=new to({vertexColors:!0,toneMapped:!1}),lo.call(this,e,o),this.type="AxesHelper"}function U2(e){this._renderer=e,this._pingPongRenderTarget=null,e=new Float32Array(20);var o=new _(0,1,0);e=new Jh({defines:{n:20},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:e},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:o},inputEncoding:{value:eh[3e3]},outputEncoding:{value:eh[3e3]}},vertexShader:k2(),fragmentShader:`
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform sampler2D envMap;
uniform int samples;
uniform float weights[n];
uniform bool latitudinal;
uniform float dTheta;
uniform float mipInt;
uniform vec3 poleAxis;

`+G2()+`

#define ENVMAP_TYPE_CUBE_UV
#include <cube_uv_reflection_fragment>

vec3 getSample(float theta, vec3 axis) {
	float cosTheta = cos(theta);
	// Rodrigues' axis-angle rotation
	vec3 sampleDirection = vOutputDirection * cosTheta
		+ cross(axis, vOutputDirection) * sin(theta)
		+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);
	return bilinearCubeUV(envMap, sampleDirection, mipInt);
}

void main() {
	vec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);
	if (all(equal(axis, vec3(0.0))))
		axis = vec3(vOutputDirection.z, 0.0, - vOutputDirection.x);
	axis = normalize(axis);
	gl_FragColor = vec4(0.0);
	gl_FragColor.rgb += weights[0] * getSample(0.0, axis);
	for (int i = 1; i < n; i++) {
		if (i >= samples)
			break;
		float theta = dTheta * float(i);
		gl_FragColor.rgb += weights[i] * getSample(-1.0 * theta, axis);
		gl_FragColor.rgb += weights[i] * getSample(theta, axis);
	}
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,blending:0,depthTest:!1,depthWrite:!1}),e.type="SphericalGaussianBlur",this._blurMaterial=e,this._cubemapShader=this._equirectShader=null,this._compileMaterial(this._blurMaterial)}function Q_(e){return e=new A(3*th,3*th,e),e.texture.mapping=306,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function H2(e,o,h,m,w){e.viewport.set(o,h,m,w),e.scissor.set(o,h,m,w)}function $_(){var e=new f(1,1);return e=new Jh({uniforms:{envMap:{value:null},texelSize:{value:e},inputEncoding:{value:eh[3e3]},outputEncoding:{value:eh[3e3]}},vertexShader:k2(),fragmentShader:`
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform sampler2D envMap;
uniform vec2 texelSize;

`+G2()+`

#include <common>

void main() {
	gl_FragColor = vec4(0.0);
	vec3 outputDirection = normalize(vOutputDirection);
	vec2 uv = equirectUv( outputDirection );
	vec2 f = fract(uv / texelSize - 0.5);
	uv -= f * texelSize;
	vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.x += texelSize.x;
	vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.y += texelSize.y;
	vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.x -= texelSize.x;
	vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	vec3 tm = mix(tl, tr, f.x);
	vec3 bm = mix(bl, br, f.x);
	gl_FragColor.rgb = mix(tm, bm, f.y);
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,blending:0,depthTest:!1,depthWrite:!1}),e.type="EquirectangularToCubeUV",e}function tM(){var e=new Jh({uniforms:{envMap:{value:null},inputEncoding:{value:eh[3e3]},outputEncoding:{value:eh[3e3]}},vertexShader:k2(),fragmentShader:`
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform samplerCube envMap;

`+G2()+`

void main() {
	gl_FragColor = vec4(0.0);
	gl_FragColor.rgb = envMapTexelToLinear(textureCube(envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ))).rgb;
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,blending:0,depthTest:!1,depthWrite:!1});return e.type="CubemapToCubeUV",e}function k2(){return`
precision mediump float;
precision mediump int;
attribute vec3 position;
attribute vec2 uv;
attribute float faceIndex;
varying vec3 vOutputDirection;

// RH coordinate system; PMREM face-indexing convention
vec3 getDirection(vec2 uv, float face) {
	uv = 2.0 * uv - 1.0;
	vec3 direction = vec3(uv, 1.0);
	if (face == 0.0) {
		direction = direction.zyx; // ( 1, v, u ) pos x
	} else if (face == 1.0) {
		direction = direction.xzy;
		direction.xz *= -1.0; // ( -u, 1, -v ) pos y
	} else if (face == 2.0) {
		direction.x *= -1.0; // ( -u, v, 1 ) pos z
	} else if (face == 3.0) {
		direction = direction.zyx;
		direction.xz *= -1.0; // ( -1, v, -u ) neg x
	} else if (face == 4.0) {
		direction = direction.xzy;
		direction.xy *= -1.0; // ( -u, -1, v ) neg y
	} else if (face == 5.0) {
		direction.z *= -1.0; // ( u, v, -1 ) neg z
	}
	return direction;
}

void main() {
	vOutputDirection = getDirection(uv, faceIndex);
	gl_Position = vec4( position, 1.0 );
}
	`}function G2(){return`
uniform int inputEncoding;
uniform int outputEncoding;

#include <encodings_pars_fragment>

vec4 inputTexelToLinear(vec4 value){
	if(inputEncoding == 0){
		return value;
	}else if(inputEncoding == 1){
		return sRGBToLinear(value);
	}else if(inputEncoding == 2){
		return RGBEToLinear(value);
	}else if(inputEncoding == 3){
		return RGBMToLinear(value, 7.0);
	}else if(inputEncoding == 4){
		return RGBMToLinear(value, 16.0);
	}else if(inputEncoding == 5){
		return RGBDToLinear(value, 256.0);
	}else{
		return GammaToLinear(value, 2.2);
	}
}

vec4 linearToOutputTexel(vec4 value){
	if(outputEncoding == 0){
		return value;
	}else if(outputEncoding == 1){
		return LinearTosRGB(value);
	}else if(outputEncoding == 2){
		return LinearToRGBE(value);
	}else if(outputEncoding == 3){
		return LinearToRGBM(value, 7.0);
	}else if(outputEncoding == 4){
		return LinearToRGBM(value, 16.0);
	}else if(outputEncoding == 5){
		return LinearToRGBD(value, 256.0);
	}else{
		return LinearToGamma(value, 2.2);
	}
}

vec4 envMapTexelToLinear(vec4 color) {
	return inputTexelToLinear(color);
}
	`}function eM(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Ns.call(this,e),this.type="catmullrom",this.closed=!0}function rM(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Ns.call(this,e),this.type="catmullrom"}function b2(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Ns.call(this,e),this.type="catmullrom"}Dn===void 0&&(Number.EPSILON=Math.pow(2,-52)),kc===void 0&&(Number.isInteger=function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}),zl===void 0&&(Math.sign=function(e){return 0>e?-1:0<e?1:+e}),!("name"in Function.prototype)&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),ut===void 0&&(Object.assign=function(e){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(e),h=1;h<arguments.length;h++){var m=arguments[h];if(m!=null)for(var w in m)Object.prototype.hasOwnProperty.call(m,w)&&(o[w]=m[w])}return o}),ut(s.prototype,{addEventListener:function(e,o){this._listeners===void 0&&(this._listeners={});var h=this._listeners;h[e]===void 0&&(h[e]=[]),h[e].indexOf(o)===-1&&h[e].push(o)},hasEventListener:function(e,o){if(this._listeners===void 0)return!1;var h=this._listeners;return h[e]!==void 0&&h[e].indexOf(o)!==-1},removeEventListener:function(e,o){this._listeners!==void 0&&(e=this._listeners[e],e!==void 0&&(o=e.indexOf(o),o!==-1&&e.splice(o,1)))},dispatchEvent:function(e){if(this._listeners!==void 0){var o=this._listeners[e.type];if(o!==void 0){e.target=this,o=o.slice(0);for(var h=0,m=o.length;h<m;h++)o[h].call(this,e)}}}});for(var ps=[],T0=0;256>T0;T0++)ps[T0]=(16>T0?"0":"")+T0.toString(16);var Si={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=4294967295*Math.random()|0,o=4294967295*Math.random()|0,h=4294967295*Math.random()|0,m=4294967295*Math.random()|0;return(ps[e&255]+ps[e>>8&255]+ps[e>>16&255]+ps[e>>24&255]+"-"+ps[o&255]+ps[o>>8&255]+"-"+ps[o>>16&15|64]+ps[o>>24&255]+"-"+ps[h&63|128]+ps[h>>8&255]+"-"+ps[h>>16&255]+ps[h>>24&255]+ps[m&255]+ps[m>>8&255]+ps[m>>16&255]+ps[m>>24&255]).toUpperCase()},clamp:function(e,o,h){return Math.max(o,Math.min(h,e))},euclideanModulo:function(e,o){return(e%o+o)%o},mapLinear:function(e,o,h,m,w){return m+(e-o)*(w-m)/(h-o)},lerp:function(e,o,h){return(1-h)*e+h*o},smoothstep:function(e,o,h){return e<=o?0:e>=h?1:(e=(e-o)/(h-o),e*e*(3-2*e))},smootherstep:function(e,o,h){return e<=o?0:e>=h?1:(e=(e-o)/(h-o),e*e*e*(e*(6*e-15)+10))},randInt:function(e,o){return e+Math.floor(Math.random()*(o-e+1))},randFloat:function(e,o){return e+Math.random()*(o-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*Si.DEG2RAD},radToDeg:function(e){return e*Si.RAD2DEG},isPowerOfTwo:function(e){return(e&e-1)==0&&e!==0},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,o,h,m,w){var T=Math.cos,R=Math.sin,z=T(h/2);h=R(h/2);var k=T((o+m)/2),b=R((o+m)/2),q=T((o-m)/2),J=R((o-m)/2);switch(T=T((m-o)/2),o=R((m-o)/2),w){case"XYX":e.set(z*b,h*q,h*J,z*k);break;case"YZY":e.set(h*J,z*b,h*q,z*k);break;case"ZXZ":e.set(h*q,h*J,z*b,z*k);break;case"XZX":e.set(z*b,h*o,h*T,z*k);break;case"YXY":e.set(h*T,z*b,h*o,z*k);break;case"ZYZ":e.set(h*o,h*T,z*b,z*k);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+w)}}};Xr(f.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),ut(f.prototype,{isVector2:!0,set:function(e,o){return this.x=e,this.y=o,this},setScalar:function(e){return this.y=this.x=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,o){switch(e){case 0:this.x=o;break;case 1:this.y=o;break;default:throw Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,o){return o!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,o)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,o){return this.x=e.x+o.x,this.y=e.y+o.y,this},addScaledVector:function(e,o){return this.x+=e.x*o,this.y+=e.y*o,this},sub:function(e,o){return o!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,o)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,o){return this.x=e.x-o.x,this.y=e.y-o.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var o=this.x,h=this.y;return e=e.elements,this.x=e[0]*o+e[3]*h+e[6],this.y=e[1]*o+e[4]*h+e[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,o){return this.x=Math.max(e.x,Math.min(o.x,this.x)),this.y=Math.max(e.y,Math.min(o.y,this.y)),this},clampScalar:function(e,o){return this.x=Math.max(e,Math.min(o,this.x)),this.y=Math.max(e,Math.min(o,this.y)),this},clampLength:function(e,o){var h=this.length();return this.divideScalar(h||1).multiplyScalar(Math.max(e,Math.min(o,h)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var o=this.x-e.x;return e=this.y-e.y,o*o+e*e},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,o){return this.x+=(e.x-this.x)*o,this.y+=(e.y-this.y)*o,this},lerpVectors:function(e,o,h){return this.x=e.x+(o.x-e.x)*h,this.y=e.y+(o.y-e.y)*h,this},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,o){return o===void 0&&(o=0),this.x=e[o],this.y=e[o+1],this},toArray:function(e,o){return e===void 0&&(e=[]),o===void 0&&(o=0),e[o]=this.x,e[o+1]=this.y,e},fromBufferAttribute:function(e,o,h){return h!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(o),this.y=e.getY(o),this},rotateAround:function(e,o){var h=Math.cos(o);o=Math.sin(o);var m=this.x-e.x,w=this.y-e.y;return this.x=m*h-w*o+e.x,this.y=m*o+w*h+e.y,this},random:function(){return this.x=Math.random(),this.y=Math.random(),this}}),ut(c.prototype,{isMatrix3:!0,set:function(e,o,h,m,w,T,R,z,k){var b=this.elements;return b[0]=e,b[1]=m,b[2]=R,b[3]=o,b[4]=w,b[5]=z,b[6]=h,b[7]=T,b[8]=k,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(e){var o=this.elements;return e=e.elements,o[0]=e[0],o[1]=e[1],o[2]=e[2],o[3]=e[3],o[4]=e[4],o[5]=e[5],o[6]=e[6],o[7]=e[7],o[8]=e[8],this},extractBasis:function(e,o,h){return e.setFromMatrix3Column(this,0),o.setFromMatrix3Column(this,1),h.setFromMatrix3Column(this,2),this},setFromMatrix4:function(e){return e=e.elements,this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,o){var h=e.elements,m=o.elements;o=this.elements,e=h[0];var w=h[3],T=h[6],R=h[1],z=h[4],k=h[7],b=h[2],q=h[5];h=h[8];var J=m[0],Q=m[3],K=m[6],rt=m[1],ht=m[4],Ot=m[7],jt=m[2],Gt=m[5];return m=m[8],o[0]=e*J+w*rt+T*jt,o[3]=e*Q+w*ht+T*Gt,o[6]=e*K+w*Ot+T*m,o[1]=R*J+z*rt+k*jt,o[4]=R*Q+z*ht+k*Gt,o[7]=R*K+z*Ot+k*m,o[2]=b*J+q*rt+h*jt,o[5]=b*Q+q*ht+h*Gt,o[8]=b*K+q*Ot+h*m,this},multiplyScalar:function(e){var o=this.elements;return o[0]*=e,o[3]*=e,o[6]*=e,o[1]*=e,o[4]*=e,o[7]*=e,o[2]*=e,o[5]*=e,o[8]*=e,this},determinant:function(){var e=this.elements,o=e[0],h=e[1],m=e[2],w=e[3],T=e[4],R=e[5],z=e[6],k=e[7];return e=e[8],o*T*e-o*R*k-h*w*e+h*R*z+m*w*k-m*T*z},getInverse:function(e,o){o!==void 0&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var h=e.elements;e=this.elements,o=h[0];var m=h[1],w=h[2],T=h[3],R=h[4],z=h[5],k=h[6],b=h[7];h=h[8];var q=h*R-z*b,J=z*k-h*T,Q=b*T-R*k,K=o*q+m*J+w*Q;return K===0?this.set(0,0,0,0,0,0,0,0,0):(K=1/K,e[0]=q*K,e[1]=(w*b-h*m)*K,e[2]=(z*m-w*R)*K,e[3]=J*K,e[4]=(h*o-w*k)*K,e[5]=(w*T-z*o)*K,e[6]=Q*K,e[7]=(m*k-b*o)*K,e[8]=(R*o-m*T)*K,this)},transpose:function(){var e=this.elements,o=e[1];return e[1]=e[3],e[3]=o,o=e[2],e[2]=e[6],e[6]=o,o=e[5],e[5]=e[7],e[7]=o,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var o=this.elements;return e[0]=o[0],e[1]=o[3],e[2]=o[6],e[3]=o[1],e[4]=o[4],e[5]=o[7],e[6]=o[2],e[7]=o[5],e[8]=o[8],this},setUvTransform:function(e,o,h,m,w,T,R){var z=Math.cos(w);w=Math.sin(w),this.set(h*z,h*w,-h*(z*T+w*R)+T+e,-m*w,m*z,-m*(-w*T+z*R)+R+o,0,0,1)},scale:function(e,o){var h=this.elements;return h[0]*=e,h[3]*=e,h[6]*=e,h[1]*=o,h[4]*=o,h[7]*=o,this},rotate:function(e){var o=Math.cos(e);e=Math.sin(e);var h=this.elements,m=h[0],w=h[3],T=h[6],R=h[1],z=h[4],k=h[7];return h[0]=o*m+e*R,h[3]=o*w+e*z,h[6]=o*T+e*k,h[1]=-e*m+o*R,h[4]=-e*w+o*z,h[7]=-e*T+o*k,this},translate:function(e,o){var h=this.elements;return h[0]+=e*h[2],h[3]+=e*h[5],h[6]+=e*h[8],h[1]+=o*h[2],h[4]+=o*h[5],h[7]+=o*h[8],this},equals:function(e){var o=this.elements;e=e.elements;for(var h=0;9>h;h++)if(o[h]!==e[h])return!1;return!0},fromArray:function(e,o){o===void 0&&(o=0);for(var h=0;9>h;h++)this.elements[h]=e[h+o];return this},toArray:function(e,o){e===void 0&&(e=[]),o===void 0&&(o=0);var h=this.elements;return e[o]=h[0],e[o+1]=h[1],e[o+2]=h[2],e[o+3]=h[3],e[o+4]=h[4],e[o+5]=h[5],e[o+6]=h[6],e[o+7]=h[7],e[o+8]=h[8],e}});var im,uf={getDataURL:function(e){if(typeof HTMLCanvasElement=="undefined")return e.src;if(!(e instanceof HTMLCanvasElement)){im===void 0&&(im=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),im.width=e.width,im.height=e.height;var o=im.getContext("2d");e instanceof ImageData?o.putImageData(e,0,0):o.drawImage(e,0,0,e.width,e.height),e=im}return 2048<e.width||2048<e.height?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}},V3=0;g.DEFAULT_IMAGE=void 0,g.DEFAULT_MAPPING=300,g.prototype=ut(at(s.prototype),{constructor:g,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var o=e===void 0||typeof e=="string";if(!o&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];var h={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){var m=this.image;if(m.uuid===void 0&&(m.uuid=Si.generateUUID()),!o&&e.images[m.uuid]===void 0){if(Array.isArray(m))for(var w=[],T=0,R=m.length;T<R;T++)w.push(uf.getDataURL(m[T]));else w=uf.getDataURL(m);e.images[m.uuid]={uuid:m.uuid,url:w}}h.image=m.uuid}return o||(e.textures[this.uuid]=h),h},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping!==300)return e;if(e.applyMatrix3(this.matrix),0>e.x||1<e.x)switch(this.wrapS){case 1e3:e.x-=Math.floor(e.x);break;case 1001:e.x=0>e.x?0:1;break;case 1002:e.x=Math.abs(Math.floor(e.x)%2)===1?Math.ceil(e.x)-e.x:e.x-Math.floor(e.x)}if(0>e.y||1<e.y)switch(this.wrapT){case 1e3:e.y-=Math.floor(e.y);break;case 1001:e.y=0>e.y?0:1;break;case 1002:e.y=Math.abs(Math.floor(e.y)%2)===1?Math.ceil(e.y)-e.y:e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(g.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),Xr(p.prototype,{width:{get:function(){return this.z},set:function(e){this.z=e}},height:{get:function(){return this.w},set:function(e){this.w=e}}}),ut(p.prototype,{isVector4:!0,set:function(e,o,h,m){return this.x=e,this.y=o,this.z=h,this.w=m,this},setScalar:function(e){return this.w=this.z=this.y=this.x=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,o){switch(e){case 0:this.x=o;break;case 1:this.y=o;break;case 2:this.z=o;break;case 3:this.w=o;break;default:throw Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this},add:function(e,o){return o!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,o)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,o){return this.x=e.x+o.x,this.y=e.y+o.y,this.z=e.z+o.z,this.w=e.w+o.w,this},addScaledVector:function(e,o){return this.x+=e.x*o,this.y+=e.y*o,this.z+=e.z*o,this.w+=e.w*o,this},sub:function(e,o){return o!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,o)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,o){return this.x=e.x-o.x,this.y=e.y-o.y,this.z=e.z-o.z,this.w=e.w-o.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var o=this.x,h=this.y,m=this.z,w=this.w;return e=e.elements,this.x=e[0]*o+e[4]*h+e[8]*m+e[12]*w,this.y=e[1]*o+e[5]*h+e[9]*m+e[13]*w,this.z=e[2]*o+e[6]*h+e[10]*m+e[14]*w,this.w=e[3]*o+e[7]*h+e[11]*m+e[15]*w,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var o=Math.sqrt(1-e.w*e.w);return 1e-4>o?(this.x=1,this.z=this.y=0):(this.x=e.x/o,this.y=e.y/o,this.z=e.z/o),this},setAxisAngleFromRotationMatrix:function(e){e=e.elements;var o=e[0],h=e[4],m=e[8],w=e[1],T=e[5],R=e[9],z=e[2],k=e[6],b=e[10];return .01>Math.abs(h-w)&&.01>Math.abs(m-z)&&.01>Math.abs(R-k)?.1>Math.abs(h+w)&&.1>Math.abs(m+z)&&.1>Math.abs(R+k)&&.1>Math.abs(o+T+b-3)?(this.set(1,0,0,0),this):(e=Math.PI,o=(o+1)/2,T=(T+1)/2,b=(b+1)/2,h=(h+w)/4,m=(m+z)/4,R=(R+k)/4,o>T&&o>b?.01>o?(k=0,h=z=.707106781):(k=Math.sqrt(o),z=h/k,h=m/k):T>b?.01>T?(k=.707106781,z=0,h=.707106781):(z=Math.sqrt(T),k=h/z,h=R/z):.01>b?(z=k=.707106781,h=0):(h=Math.sqrt(b),k=m/h,z=R/h),this.set(k,z,h,e),this):(e=Math.sqrt((k-R)*(k-R)+(m-z)*(m-z)+(w-h)*(w-h)),.001>Math.abs(e)&&(e=1),this.x=(k-R)/e,this.y=(m-z)/e,this.z=(w-h)/e,this.w=Math.acos((o+T+b-1)/2),this)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,o){return this.x=Math.max(e.x,Math.min(o.x,this.x)),this.y=Math.max(e.y,Math.min(o.y,this.y)),this.z=Math.max(e.z,Math.min(o.z,this.z)),this.w=Math.max(e.w,Math.min(o.w,this.w)),this},clampScalar:function(e,o){return this.x=Math.max(e,Math.min(o,this.x)),this.y=Math.max(e,Math.min(o,this.y)),this.z=Math.max(e,Math.min(o,this.z)),this.w=Math.max(e,Math.min(o,this.w)),this},clampLength:function(e,o){var h=this.length();return this.divideScalar(h||1).multiplyScalar(Math.max(e,Math.min(o,h)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,o){return this.x+=(e.x-this.x)*o,this.y+=(e.y-this.y)*o,this.z+=(e.z-this.z)*o,this.w+=(e.w-this.w)*o,this},lerpVectors:function(e,o,h){return this.x=e.x+(o.x-e.x)*h,this.y=e.y+(o.y-e.y)*h,this.z=e.z+(o.z-e.z)*h,this.w=e.w+(o.w-e.w)*h,this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,o){return o===void 0&&(o=0),this.x=e[o],this.y=e[o+1],this.z=e[o+2],this.w=e[o+3],this},toArray:function(e,o){return e===void 0&&(e=[]),o===void 0&&(o=0),e[o]=this.x,e[o+1]=this.y,e[o+2]=this.z,e[o+3]=this.w,e},fromBufferAttribute:function(e,o,h){return h!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(o),this.y=e.getY(o),this.z=e.getZ(o),this.w=e.getW(o),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}),A.prototype=ut(at(s.prototype),{constructor:A,isWebGLRenderTarget:!0,setSize:function(e,o){(this.width!==e||this.height!==o)&&(this.width=e,this.height=o,this.texture.image.width=e,this.texture.image.height=o,this.dispose()),this.viewport.set(0,0,e,o),this.scissor.set(0,0,e,o)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),S.prototype=ut(at(A.prototype),{constructor:S,isWebGLMultisampleRenderTarget:!0,copy:function(e){return A.prototype.copy.call(this,e),this.samples=e.samples,this}}),ut(N,{slerp:function(e,o,h,m){return h.copy(e).slerp(o,m)},slerpFlat:function(e,o,h,m,w,T,R){var z=h[m+0],k=h[m+1],b=h[m+2];h=h[m+3],m=w[T+0];var q=w[T+1],J=w[T+2];if(w=w[T+3],h!==w||z!==m||k!==q||b!==J){T=1-R;var Q=z*m+k*q+b*J+h*w,K=0<=Q?1:-1,rt=1-Q*Q;rt>Dn&&(rt=Math.sqrt(rt),Q=Math.atan2(rt,Q*K),T=Math.sin(T*Q)/rt,R=Math.sin(R*Q)/rt),K*=R,z=z*T+m*K,k=k*T+q*K,b=b*T+J*K,h=h*T+w*K,T===1-R&&(R=1/Math.sqrt(z*z+k*k+b*b+h*h),z*=R,k*=R,b*=R,h*=R)}e[o]=z,e[o+1]=k,e[o+2]=b,e[o+3]=h},multiplyQuaternionsFlat:function(e,o,h,m,w,T){var R=h[m],z=h[m+1],k=h[m+2];h=h[m+3],m=w[T];var b=w[T+1],q=w[T+2];return w=w[T+3],e[o]=R*w+h*m+z*q-k*b,e[o+1]=z*w+h*b+k*m-R*q,e[o+2]=k*w+h*q+R*b-z*m,e[o+3]=h*w-R*m-z*b-k*q,e}}),Xr(N.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}}}),ut(N.prototype,{isQuaternion:!0,set:function(e,o,h,m){return this._x=e,this._y=o,this._z=h,this._w=m,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this},setFromEuler:function(e,o){if(!e||!e.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var h=e._x,m=e._y,w=e._z;e=e.order;var T=Math.cos,R=Math.sin,z=T(h/2),k=T(m/2);switch(T=T(w/2),h=R(h/2),m=R(m/2),w=R(w/2),e){case"XYZ":this._x=h*k*T+z*m*w,this._y=z*m*T-h*k*w,this._z=z*k*w+h*m*T,this._w=z*k*T-h*m*w;break;case"YXZ":this._x=h*k*T+z*m*w,this._y=z*m*T-h*k*w,this._z=z*k*w-h*m*T,this._w=z*k*T+h*m*w;break;case"ZXY":this._x=h*k*T-z*m*w,this._y=z*m*T+h*k*w,this._z=z*k*w+h*m*T,this._w=z*k*T-h*m*w;break;case"ZYX":this._x=h*k*T-z*m*w,this._y=z*m*T+h*k*w,this._z=z*k*w-h*m*T,this._w=z*k*T+h*m*w;break;case"YZX":this._x=h*k*T+z*m*w,this._y=z*m*T+h*k*w,this._z=z*k*w-h*m*T,this._w=z*k*T-h*m*w;break;case"XZY":this._x=h*k*T-z*m*w,this._y=z*m*T-h*k*w,this._z=z*k*w+h*m*T,this._w=z*k*T+h*m*w;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+e)}return o!==!1&&this._onChangeCallback(),this},setFromAxisAngle:function(e,o){o/=2;var h=Math.sin(o);return this._x=e.x*h,this._y=e.y*h,this._z=e.z*h,this._w=Math.cos(o),this._onChangeCallback(),this},setFromRotationMatrix:function(e){var o=e.elements,h=o[0];e=o[4];var m=o[8],w=o[1],T=o[5],R=o[9],z=o[2],k=o[6];o=o[10];var b=h+T+o;return 0<b?(h=.5/Math.sqrt(b+1),this._w=.25/h,this._x=(k-R)*h,this._y=(m-z)*h,this._z=(w-e)*h):h>T&&h>o?(h=2*Math.sqrt(1+h-T-o),this._w=(k-R)/h,this._x=.25*h,this._y=(e+w)/h,this._z=(m+z)/h):T>o?(h=2*Math.sqrt(1+T-h-o),this._w=(m-z)/h,this._x=(e+w)/h,this._y=.25*h,this._z=(R+k)/h):(h=2*Math.sqrt(1+o-h-T),this._w=(w-e)/h,this._x=(m+z)/h,this._y=(R+k)/h,this._z=.25*h),this._onChangeCallback(),this},setFromUnitVectors:function(e,o){var h=e.dot(o)+1;return 1e-6>h?(h=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0):(this._x=0,this._y=-e.z,this._z=e.y)):(this._x=e.y*o.z-e.z*o.y,this._y=e.z*o.x-e.x*o.z,this._z=e.x*o.y-e.y*o.x),this._w=h,this.normalize()},angleTo:function(e){return 2*Math.acos(Math.abs(Si.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,o){var h=this.angleTo(e);return h===0?this:(this.slerp(e,Math.min(1,o/h)),this)},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return e===0?(this._z=this._y=this._x=0,this._w=1):(e=1/e,this._x*=e,this._y*=e,this._z*=e,this._w*=e),this._onChangeCallback(),this},multiply:function(e,o){return o!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,o)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,o){var h=e._x,m=e._y,w=e._z;e=e._w;var T=o._x,R=o._y,z=o._z;return o=o._w,this._x=h*o+e*T+m*z-w*R,this._y=m*o+e*R+w*T-h*z,this._z=w*o+e*z+h*R-m*T,this._w=e*o-h*T-m*R-w*z,this._onChangeCallback(),this},slerp:function(e,o){if(o===0)return this;if(o===1)return this.copy(e);var h=this._x,m=this._y,w=this._z,T=this._w,R=T*e._w+h*e._x+m*e._y+w*e._z;if(0>R?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,R=-R):this.copy(e),1<=R)return this._w=T,this._x=h,this._y=m,this._z=w,this;if(e=1-R*R,e<=Dn)return R=1-o,this._w=R*T+o*this._w,this._x=R*h+o*this._x,this._y=R*m+o*this._y,this._z=R*w+o*this._z,this.normalize(),this._onChangeCallback(),this;e=Math.sqrt(e);var z=Math.atan2(e,R);return R=Math.sin((1-o)*z)/e,o=Math.sin(o*z)/e,this._w=T*R+this._w*o,this._x=h*R+this._x*o,this._y=m*R+this._y*o,this._z=w*R+this._z*o,this._onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,o){return o===void 0&&(o=0),this._x=e[o],this._y=e[o+1],this._z=e[o+2],this._w=e[o+3],this._onChangeCallback(),this},toArray:function(e,o){return e===void 0&&(e=[]),o===void 0&&(o=0),e[o]=this._x,e[o+1]=this._y,e[o+2]=this._z,e[o+3]=this._w,e},fromBufferAttribute:function(e,o){return this._x=e.getX(o),this._y=e.getY(o),this._z=e.getZ(o),this._w=e.getW(o),this},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}});var V2=new _,iM=new N;ut(_.prototype,{isVector3:!0,set:function(e,o,h){return this.x=e,this.y=o,this.z=h,this},setScalar:function(e){return this.z=this.y=this.x=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,o){switch(e){case 0:this.x=o;break;case 1:this.y=o;break;case 2:this.z=o;break;default:throw Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,o){return o!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,o)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,o){return this.x=e.x+o.x,this.y=e.y+o.y,this.z=e.z+o.z,this},addScaledVector:function(e,o){return this.x+=e.x*o,this.y+=e.y*o,this.z+=e.z*o,this},sub:function(e,o){return o!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,o)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,o){return this.x=e.x-o.x,this.y=e.y-o.y,this.z=e.z-o.z,this},multiply:function(e,o){return o!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,o)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,o){return this.x=e.x*o.x,this.y=e.y*o.y,this.z=e.z*o.z,this},applyEuler:function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(iM.setFromEuler(e))},applyAxisAngle:function(e,o){return this.applyQuaternion(iM.setFromAxisAngle(e,o))},applyMatrix3:function(e){var o=this.x,h=this.y,m=this.z;return e=e.elements,this.x=e[0]*o+e[3]*h+e[6]*m,this.y=e[1]*o+e[4]*h+e[7]*m,this.z=e[2]*o+e[5]*h+e[8]*m,this},applyNormalMatrix:function(e){return this.applyMatrix3(e).normalize()},applyMatrix4:function(e){var o=this.x,h=this.y,m=this.z;e=e.elements;var w=1/(e[3]*o+e[7]*h+e[11]*m+e[15]);return this.x=(e[0]*o+e[4]*h+e[8]*m+e[12])*w,this.y=(e[1]*o+e[5]*h+e[9]*m+e[13])*w,this.z=(e[2]*o+e[6]*h+e[10]*m+e[14])*w,this},applyQuaternion:function(e){var o=this.x,h=this.y,m=this.z,w=e.x,T=e.y,R=e.z;e=e.w;var z=e*o+T*m-R*h,k=e*h+R*o-w*m,b=e*m+w*h-T*o;return o=-w*o-T*h-R*m,this.x=z*e+o*-w+k*-R-b*-T,this.y=k*e+o*-T+b*-w-z*-R,this.z=b*e+o*-R+z*-T-k*-w,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){var o=this.x,h=this.y,m=this.z;return e=e.elements,this.x=e[0]*o+e[4]*h+e[8]*m,this.y=e[1]*o+e[5]*h+e[9]*m,this.z=e[2]*o+e[6]*h+e[10]*m,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,o){return this.x=Math.max(e.x,Math.min(o.x,this.x)),this.y=Math.max(e.y,Math.min(o.y,this.y)),this.z=Math.max(e.z,Math.min(o.z,this.z)),this},clampScalar:function(e,o){return this.x=Math.max(e,Math.min(o,this.x)),this.y=Math.max(e,Math.min(o,this.y)),this.z=Math.max(e,Math.min(o,this.z)),this},clampLength:function(e,o){var h=this.length();return this.divideScalar(h||1).multiplyScalar(Math.max(e,Math.min(o,h)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,o){return this.x+=(e.x-this.x)*o,this.y+=(e.y-this.y)*o,this.z+=(e.z-this.z)*o,this},lerpVectors:function(e,o,h){return this.x=e.x+(o.x-e.x)*h,this.y=e.y+(o.y-e.y)*h,this.z=e.z+(o.z-e.z)*h,this},cross:function(e,o){return o!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,o)):this.crossVectors(this,e)},crossVectors:function(e,o){var h=e.x,m=e.y;e=e.z;var w=o.x,T=o.y;return o=o.z,this.x=m*o-e*T,this.y=e*w-h*o,this.z=h*T-m*w,this},projectOnVector:function(e){var o=e.lengthSq();return o===0?this.set(0,0,0):(o=e.dot(this)/o,this.copy(e).multiplyScalar(o))},projectOnPlane:function(e){return V2.copy(this).projectOnVector(e),this.sub(V2)},reflect:function(e){return this.sub(V2.copy(e).multiplyScalar(2*this.dot(e)))},angleTo:function(e){var o=Math.sqrt(this.lengthSq()*e.lengthSq());return o===0?Math.PI/2:(e=this.dot(e)/o,Math.acos(Si.clamp(e,-1,1)))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var o=this.x-e.x,h=this.y-e.y;return e=this.z-e.z,o*o+h*h+e*e},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,o,h){var m=Math.sin(o)*e;return this.x=m*Math.sin(h),this.y=Math.cos(o)*e,this.z=m*Math.cos(h),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,o,h){return this.x=e*Math.sin(o),this.y=h,this.z=e*Math.cos(o),this},setFromMatrixPosition:function(e){return e=e.elements,this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(e){var o=this.setFromMatrixColumn(e,0).length(),h=this.setFromMatrixColumn(e,1).length();return e=this.setFromMatrixColumn(e,2).length(),this.x=o,this.y=h,this.z=e,this},setFromMatrixColumn:function(e,o){return this.fromArray(e.elements,4*o)},setFromMatrix3Column:function(e,o){return this.fromArray(e.elements,3*o)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,o){return o===void 0&&(o=0),this.x=e[o],this.y=e[o+1],this.z=e[o+2],this},toArray:function(e,o){return e===void 0&&(e=[]),o===void 0&&(o=0),e[o]=this.x,e[o+1]=this.y,e[o+2]=this.z,e},fromBufferAttribute:function(e,o,h){return h!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(o),this.y=e.getY(o),this.z=e.getZ(o),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}});var nm=new _,tl=new I,W3=new _(0,0,0),j3=new _(1,1,1),lf=new _,fx=new _,Za=new _;ut(I.prototype,{isMatrix4:!0,set:function(e,o,h,m,w,T,R,z,k,b,q,J,Q,K,rt,ht){var Ot=this.elements;return Ot[0]=e,Ot[4]=o,Ot[8]=h,Ot[12]=m,Ot[1]=w,Ot[5]=T,Ot[9]=R,Ot[13]=z,Ot[2]=k,Ot[6]=b,Ot[10]=q,Ot[14]=J,Ot[3]=Q,Ot[7]=K,Ot[11]=rt,Ot[15]=ht,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return new I().fromArray(this.elements)},copy:function(e){var o=this.elements;return e=e.elements,o[0]=e[0],o[1]=e[1],o[2]=e[2],o[3]=e[3],o[4]=e[4],o[5]=e[5],o[6]=e[6],o[7]=e[7],o[8]=e[8],o[9]=e[9],o[10]=e[10],o[11]=e[11],o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15],this},copyPosition:function(e){var o=this.elements;return e=e.elements,o[12]=e[12],o[13]=e[13],o[14]=e[14],this},extractBasis:function(e,o,h){return e.setFromMatrixColumn(this,0),o.setFromMatrixColumn(this,1),h.setFromMatrixColumn(this,2),this},makeBasis:function(e,o,h){return this.set(e.x,o.x,h.x,0,e.y,o.y,h.y,0,e.z,o.z,h.z,0,0,0,0,1),this},extractRotation:function(e){var o=this.elements,h=e.elements,m=1/nm.setFromMatrixColumn(e,0).length(),w=1/nm.setFromMatrixColumn(e,1).length();return e=1/nm.setFromMatrixColumn(e,2).length(),o[0]=h[0]*m,o[1]=h[1]*m,o[2]=h[2]*m,o[3]=0,o[4]=h[4]*w,o[5]=h[5]*w,o[6]=h[6]*w,o[7]=0,o[8]=h[8]*e,o[9]=h[9]*e,o[10]=h[10]*e,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,this},makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var o=this.elements,h=e.x,m=e.y,w=e.z,T=Math.cos(h);h=Math.sin(h);var R=Math.cos(m);m=Math.sin(m);var z=Math.cos(w);if(w=Math.sin(w),e.order==="XYZ"){e=T*z;var k=T*w,b=h*z,q=h*w;o[0]=R*z,o[4]=-R*w,o[8]=m,o[1]=k+b*m,o[5]=e-q*m,o[9]=-h*R,o[2]=q-e*m,o[6]=b+k*m,o[10]=T*R}else e.order==="YXZ"?(e=R*z,k=R*w,b=m*z,q=m*w,o[0]=e+q*h,o[4]=b*h-k,o[8]=T*m,o[1]=T*w,o[5]=T*z,o[9]=-h,o[2]=k*h-b,o[6]=q+e*h,o[10]=T*R):e.order==="ZXY"?(e=R*z,k=R*w,b=m*z,q=m*w,o[0]=e-q*h,o[4]=-T*w,o[8]=b+k*h,o[1]=k+b*h,o[5]=T*z,o[9]=q-e*h,o[2]=-T*m,o[6]=h,o[10]=T*R):e.order==="ZYX"?(e=T*z,k=T*w,b=h*z,q=h*w,o[0]=R*z,o[4]=b*m-k,o[8]=e*m+q,o[1]=R*w,o[5]=q*m+e,o[9]=k*m-b,o[2]=-m,o[6]=h*R,o[10]=T*R):e.order==="YZX"?(e=T*R,k=T*m,b=h*R,q=h*m,o[0]=R*z,o[4]=q-e*w,o[8]=b*w+k,o[1]=w,o[5]=T*z,o[9]=-h*z,o[2]=-m*z,o[6]=k*w+b,o[10]=e-q*w):e.order==="XZY"&&(e=T*R,k=T*m,b=h*R,q=h*m,o[0]=R*z,o[4]=-w,o[8]=m*z,o[1]=e*w+q,o[5]=T*z,o[9]=k*w-b,o[2]=b*w-k,o[6]=h*z,o[10]=q*w+e);return o[3]=0,o[7]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,this},makeRotationFromQuaternion:function(e){return this.compose(W3,e,j3)},lookAt:function(e,o,h){var m=this.elements;return Za.subVectors(e,o),Za.lengthSq()===0&&(Za.z=1),Za.normalize(),lf.crossVectors(h,Za),lf.lengthSq()===0&&(Math.abs(h.z)===1?Za.x+=1e-4:Za.z+=1e-4,Za.normalize(),lf.crossVectors(h,Za)),lf.normalize(),fx.crossVectors(Za,lf),m[0]=lf.x,m[4]=fx.x,m[8]=Za.x,m[1]=lf.y,m[5]=fx.y,m[9]=Za.y,m[2]=lf.z,m[6]=fx.z,m[10]=Za.z,this},multiply:function(e,o){return o!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,o)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,o){var h=e.elements,m=o.elements;o=this.elements,e=h[0];var w=h[4],T=h[8],R=h[12],z=h[1],k=h[5],b=h[9],q=h[13],J=h[2],Q=h[6],K=h[10],rt=h[14],ht=h[3],Ot=h[7],jt=h[11];h=h[15];var Gt=m[0],ee=m[4],Zt=m[8],le=m[12],Wt=m[1],Me=m[5],Fe=m[9],fe=m[13],Ne=m[2],Oe=m[6],vr=m[10],jr=m[14],er=m[3],Hr=m[7],xi=m[11];return m=m[15],o[0]=e*Gt+w*Wt+T*Ne+R*er,o[4]=e*ee+w*Me+T*Oe+R*Hr,o[8]=e*Zt+w*Fe+T*vr+R*xi,o[12]=e*le+w*fe+T*jr+R*m,o[1]=z*Gt+k*Wt+b*Ne+q*er,o[5]=z*ee+k*Me+b*Oe+q*Hr,o[9]=z*Zt+k*Fe+b*vr+q*xi,o[13]=z*le+k*fe+b*jr+q*m,o[2]=J*Gt+Q*Wt+K*Ne+rt*er,o[6]=J*ee+Q*Me+K*Oe+rt*Hr,o[10]=J*Zt+Q*Fe+K*vr+rt*xi,o[14]=J*le+Q*fe+K*jr+rt*m,o[3]=ht*Gt+Ot*Wt+jt*Ne+h*er,o[7]=ht*ee+Ot*Me+jt*Oe+h*Hr,o[11]=ht*Zt+Ot*Fe+jt*vr+h*xi,o[15]=ht*le+Ot*fe+jt*jr+h*m,this},multiplyScalar:function(e){var o=this.elements;return o[0]*=e,o[4]*=e,o[8]*=e,o[12]*=e,o[1]*=e,o[5]*=e,o[9]*=e,o[13]*=e,o[2]*=e,o[6]*=e,o[10]*=e,o[14]*=e,o[3]*=e,o[7]*=e,o[11]*=e,o[15]*=e,this},determinant:function(){var e=this.elements,o=e[0],h=e[4],m=e[8],w=e[12],T=e[1],R=e[5],z=e[9],k=e[13],b=e[2],q=e[6],J=e[10],Q=e[14];return e[3]*(+w*z*q-m*k*q-w*R*J+h*k*J+m*R*Q-h*z*Q)+e[7]*(+o*z*Q-o*k*J+w*T*J-m*T*Q+m*k*b-w*z*b)+e[11]*(+o*k*q-o*R*Q-w*T*q+h*T*Q+w*R*b-h*k*b)+e[15]*(-m*R*b-o*z*q+o*R*J+m*T*q-h*T*J+h*z*b)},transpose:function(){var e=this.elements,o=e[1];return e[1]=e[4],e[4]=o,o=e[2],e[2]=e[8],e[8]=o,o=e[6],e[6]=e[9],e[9]=o,o=e[3],e[3]=e[12],e[12]=o,o=e[7],e[7]=e[13],e[13]=o,o=e[11],e[11]=e[14],e[14]=o,this},setPosition:function(e,o,h){var m=this.elements;return e.isVector3?(m[12]=e.x,m[13]=e.y,m[14]=e.z):(m[12]=e,m[13]=o,m[14]=h),this},getInverse:function(e,o){o!==void 0&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate."),o=this.elements;var h=e.elements;e=h[0];var m=h[1],w=h[2],T=h[3],R=h[4],z=h[5],k=h[6],b=h[7],q=h[8],J=h[9],Q=h[10],K=h[11],rt=h[12],ht=h[13],Ot=h[14];h=h[15];var jt=J*Ot*b-ht*Q*b+ht*k*K-z*Ot*K-J*k*h+z*Q*h,Gt=rt*Q*b-q*Ot*b-rt*k*K+R*Ot*K+q*k*h-R*Q*h,ee=q*ht*b-rt*J*b+rt*z*K-R*ht*K-q*z*h+R*J*h,Zt=rt*J*k-q*ht*k-rt*z*Q+R*ht*Q+q*z*Ot-R*J*Ot,le=e*jt+m*Gt+w*ee+T*Zt;return le===0?this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0):(le=1/le,o[0]=jt*le,o[1]=(ht*Q*T-J*Ot*T-ht*w*K+m*Ot*K+J*w*h-m*Q*h)*le,o[2]=(z*Ot*T-ht*k*T+ht*w*b-m*Ot*b-z*w*h+m*k*h)*le,o[3]=(J*k*T-z*Q*T-J*w*b+m*Q*b+z*w*K-m*k*K)*le,o[4]=Gt*le,o[5]=(q*Ot*T-rt*Q*T+rt*w*K-e*Ot*K-q*w*h+e*Q*h)*le,o[6]=(rt*k*T-R*Ot*T-rt*w*b+e*Ot*b+R*w*h-e*k*h)*le,o[7]=(R*Q*T-q*k*T+q*w*b-e*Q*b-R*w*K+e*k*K)*le,o[8]=ee*le,o[9]=(rt*J*T-q*ht*T-rt*m*K+e*ht*K+q*m*h-e*J*h)*le,o[10]=(R*ht*T-rt*z*T+rt*m*b-e*ht*b-R*m*h+e*z*h)*le,o[11]=(q*z*T-R*J*T-q*m*b+e*J*b+R*m*K-e*z*K)*le,o[12]=Zt*le,o[13]=(q*ht*w-rt*J*w+rt*m*Q-e*ht*Q-q*m*Ot+e*J*Ot)*le,o[14]=(rt*z*w-R*ht*w-rt*m*k+e*ht*k+R*m*Ot-e*z*Ot)*le,o[15]=(R*J*w-q*z*w+q*m*k-e*J*k-R*m*Q+e*z*Q)*le,this)},scale:function(e){var o=this.elements,h=e.x,m=e.y;return e=e.z,o[0]*=h,o[4]*=m,o[8]*=e,o[1]*=h,o[5]*=m,o[9]*=e,o[2]*=h,o[6]*=m,o[10]*=e,o[3]*=h,o[7]*=m,o[11]*=e,this},getMaxScaleOnAxis:function(){var e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))},makeTranslation:function(e,o,h){return this.set(1,0,0,e,0,1,0,o,0,0,1,h,0,0,0,1),this},makeRotationX:function(e){var o=Math.cos(e);return e=Math.sin(e),this.set(1,0,0,0,0,o,-e,0,0,e,o,0,0,0,0,1),this},makeRotationY:function(e){var o=Math.cos(e);return e=Math.sin(e),this.set(o,0,e,0,0,1,0,0,-e,0,o,0,0,0,0,1),this},makeRotationZ:function(e){var o=Math.cos(e);return e=Math.sin(e),this.set(o,-e,0,0,e,o,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,o){var h=Math.cos(o);o=Math.sin(o);var m=1-h,w=e.x,T=e.y;e=e.z;var R=m*w,z=m*T;return this.set(R*w+h,R*T-o*e,R*e+o*T,0,R*T+o*e,z*T+h,z*e-o*w,0,R*e-o*T,z*e+o*w,m*e*e+h,0,0,0,0,1),this},makeScale:function(e,o,h){return this.set(e,0,0,0,0,o,0,0,0,0,h,0,0,0,0,1),this},makeShear:function(e,o,h){return this.set(1,o,h,0,e,1,h,0,e,o,1,0,0,0,0,1),this},compose:function(e,o,h){var m=this.elements,w=o._x,T=o._y,R=o._z,z=o._w,k=w+w,b=T+T,q=R+R;o=w*k;var J=w*b;w*=q;var Q=T*b;T*=q,R*=q,k*=z,b*=z,z*=q,q=h.x;var K=h.y;return h=h.z,m[0]=(1-(Q+R))*q,m[1]=(J+z)*q,m[2]=(w-b)*q,m[3]=0,m[4]=(J-z)*K,m[5]=(1-(o+R))*K,m[6]=(T+k)*K,m[7]=0,m[8]=(w+b)*h,m[9]=(T-k)*h,m[10]=(1-(o+Q))*h,m[11]=0,m[12]=e.x,m[13]=e.y,m[14]=e.z,m[15]=1,this},decompose:function(e,o,h){var m=this.elements,w=nm.set(m[0],m[1],m[2]).length(),T=nm.set(m[4],m[5],m[6]).length(),R=nm.set(m[8],m[9],m[10]).length();0>this.determinant()&&(w=-w),e.x=m[12],e.y=m[13],e.z=m[14],tl.copy(this),e=1/w,m=1/T;var z=1/R;return tl.elements[0]*=e,tl.elements[1]*=e,tl.elements[2]*=e,tl.elements[4]*=m,tl.elements[5]*=m,tl.elements[6]*=m,tl.elements[8]*=z,tl.elements[9]*=z,tl.elements[10]*=z,o.setFromRotationMatrix(tl),h.x=w,h.y=T,h.z=R,this},makePerspective:function(e,o,h,m,w,T){T===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var R=this.elements;return R[0]=2*w/(o-e),R[4]=0,R[8]=(o+e)/(o-e),R[12]=0,R[1]=0,R[5]=2*w/(h-m),R[9]=(h+m)/(h-m),R[13]=0,R[2]=0,R[6]=0,R[10]=-(T+w)/(T-w),R[14]=-2*T*w/(T-w),R[3]=0,R[7]=0,R[11]=-1,R[15]=0,this},makeOrthographic:function(e,o,h,m,w,T){var R=this.elements,z=1/(o-e),k=1/(h-m),b=1/(T-w);return R[0]=2*z,R[4]=0,R[8]=0,R[12]=-((o+e)*z),R[1]=0,R[5]=2*k,R[9]=0,R[13]=-((h+m)*k),R[2]=0,R[6]=0,R[10]=-2*b,R[14]=-((T+w)*b),R[3]=0,R[7]=0,R[11]=0,R[15]=1,this},equals:function(e){var o=this.elements;e=e.elements;for(var h=0;16>h;h++)if(o[h]!==e[h])return!1;return!0},fromArray:function(e,o){o===void 0&&(o=0);for(var h=0;16>h;h++)this.elements[h]=e[h+o];return this},toArray:function(e,o){e===void 0&&(e=[]),o===void 0&&(o=0);var h=this.elements;return e[o]=h[0],e[o+1]=h[1],e[o+2]=h[2],e[o+3]=h[3],e[o+4]=h[4],e[o+5]=h[5],e[o+6]=h[6],e[o+7]=h[7],e[o+8]=h[8],e[o+9]=h[9],e[o+10]=h[10],e[o+11]=h[11],e[o+12]=h[12],e[o+13]=h[13],e[o+14]=h[14],e[o+15]=h[15],e}});var nM=new I,oM=new N;L.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" "),L.DefaultOrder="XYZ",Xr(L.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}}}),ut(L.prototype,{isEuler:!0,set:function(e,o,h,m){return this._x=e,this._y=o,this._z=h,this._order=m||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this},setFromRotationMatrix:function(e,o,h){var m=Si.clamp,w=e.elements;e=w[0];var T=w[4],R=w[8],z=w[1],k=w[5],b=w[9],q=w[2],J=w[6];switch(w=w[10],o=o||this._order,o){case"XYZ":this._y=Math.asin(m(R,-1,1)),.9999999>Math.abs(R)?(this._x=Math.atan2(-b,w),this._z=Math.atan2(-T,e)):(this._x=Math.atan2(J,k),this._z=0);break;case"YXZ":this._x=Math.asin(-m(b,-1,1)),.9999999>Math.abs(b)?(this._y=Math.atan2(R,w),this._z=Math.atan2(z,k)):(this._y=Math.atan2(-q,e),this._z=0);break;case"ZXY":this._x=Math.asin(m(J,-1,1)),.9999999>Math.abs(J)?(this._y=Math.atan2(-q,w),this._z=Math.atan2(-T,k)):(this._y=0,this._z=Math.atan2(z,e));break;case"ZYX":this._y=Math.asin(-m(q,-1,1)),.9999999>Math.abs(q)?(this._x=Math.atan2(J,w),this._z=Math.atan2(z,e)):(this._x=0,this._z=Math.atan2(-T,k));break;case"YZX":this._z=Math.asin(m(z,-1,1)),.9999999>Math.abs(z)?(this._x=Math.atan2(-b,k),this._y=Math.atan2(-q,e)):(this._x=0,this._y=Math.atan2(R,w));break;case"XZY":this._z=Math.asin(-m(T,-1,1)),.9999999>Math.abs(T)?(this._x=Math.atan2(J,k),this._y=Math.atan2(R,e)):(this._x=Math.atan2(-b,w),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+o)}return this._order=o,h!==!1&&this._onChangeCallback(),this},setFromQuaternion:function(e,o,h){return nM.makeRotationFromQuaternion(e),this.setFromRotationMatrix(nM,o,h)},setFromVector3:function(e,o){return this.set(e.x,e.y,e.z,o||this._order)},reorder:function(e){return oM.setFromEuler(this),this.setFromQuaternion(oM,e)},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this},toArray:function(e,o){return e===void 0&&(e=[]),o===void 0&&(o=0),e[o]=this._x,e[o+1]=this._y,e[o+2]=this._z,e[o+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new _(this._x,this._y,this._z)},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}}),ut(P.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask=this.mask|1<<e|0},enableAll:function(){this.mask=-1},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},disableAll:function(){this.mask=0},test:function(e){return(this.mask&e.mask)!=0}});var X3=0,sM=new _,om=new N,$h=new I,px=new _,S0=new _,Y3=new _,Z3=new N,aM=new _(1,0,0),uM=new _(0,1,0),lM=new _(0,0,1),J3={type:"added"},q3={type:"removed"};F.DefaultUp=new _(0,1,0),F.DefaultMatrixAutoUpdate=!0,F.prototype=ut(at(s.prototype),{constructor:F,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,o){this.quaternion.setFromAxisAngle(e,o)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,o){return om.setFromAxisAngle(e,o),this.quaternion.multiply(om),this},rotateOnWorldAxis:function(e,o){return om.setFromAxisAngle(e,o),this.quaternion.premultiply(om),this},rotateX:function(e){return this.rotateOnAxis(aM,e)},rotateY:function(e){return this.rotateOnAxis(uM,e)},rotateZ:function(e){return this.rotateOnAxis(lM,e)},translateOnAxis:function(e,o){return sM.copy(e).applyQuaternion(this.quaternion),this.position.add(sM.multiplyScalar(o)),this},translateX:function(e){return this.translateOnAxis(aM,e)},translateY:function(e){return this.translateOnAxis(uM,e)},translateZ:function(e){return this.translateOnAxis(lM,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4($h.getInverse(this.matrixWorld))},lookAt:function(e,o,h){e.isVector3?px.copy(e):px.set(e,o,h),e=this.parent,this.updateWorldMatrix(!0,!1),S0.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?$h.lookAt(S0,px,this.up):$h.lookAt(px,S0,this.up),this.quaternion.setFromRotationMatrix($h),e&&($h.extractRotation(e.matrixWorld),om.setFromRotationMatrix($h),this.quaternion.premultiply(om.inverse()))},add:function(e){if(1<arguments.length){for(var o=0;o<arguments.length;o++)this.add(arguments[o]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(J3)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(1<arguments.length){for(var o=0;o<arguments.length;o++)this.remove(arguments[o]);return this}return o=this.children.indexOf(e),o!==-1&&(e.parent=null,this.children.splice(o,1),e.dispatchEvent(q3)),this},attach:function(e){return this.updateWorldMatrix(!0,!1),$h.getInverse(this.matrixWorld),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),$h.multiply(e.parent.matrixWorld)),e.applyMatrix4($h),e.updateWorldMatrix(!1,!1),this.add(e),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,o){if(this[e]===o)return this;for(var h=0,m=this.children.length;h<m;h++){var w=this.children[h].getObjectByProperty(e,o);if(w!==void 0)return w}},getWorldPosition:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new _),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new N),this.updateMatrixWorld(!0),this.matrixWorld.decompose(S0,e,Y3),e},getWorldScale:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new _),this.updateMatrixWorld(!0),this.matrixWorld.decompose(S0,Z3,e),e},getWorldDirection:function(e){e===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new _),this.updateMatrixWorld(!0);var o=this.matrixWorld.elements;return e.set(o[8],o[9],o[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var o=this.children,h=0,m=o.length;h<m;h++)o[h].traverse(e)},traverseVisible:function(e){if(this.visible!==!1){e(this);for(var o=this.children,h=0,m=o.length;h<m;h++)o[h].traverseVisible(e)}},traverseAncestors:function(e){var o=this.parent;o!==null&&(e(o),o.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var o=this.children,h=0,m=o.length;h<m;h++)o[h].updateMatrixWorld(e)},updateWorldMatrix:function(e,o){var h=this.parent;if(e===!0&&h!==null&&h.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),o===!0)for(e=this.children,o=0,h=e.length;o<h;o++)e[o].updateWorldMatrix(!1,!0)},toJSON:function(e){function o(q,J){return q[J.uuid]===void 0&&(q[J.uuid]=J.toJSON(e)),J.uuid}function h(q){var J=[],Q;for(Q in q){var K=q[Q];delete K.metadata,J.push(K)}return J}var m=e===void 0||typeof e=="string",w={};m&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},w.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var T={};if(T.uuid=this.uuid,T.type=this.type,this.name!==""&&(T.name=this.name),this.castShadow===!0&&(T.castShadow=!0),this.receiveShadow===!0&&(T.receiveShadow=!0),this.visible===!1&&(T.visible=!1),this.frustumCulled===!1&&(T.frustumCulled=!1),this.renderOrder!==0&&(T.renderOrder=this.renderOrder),ls(this.userData)!=="{}"&&(T.userData=this.userData),T.layers=this.layers.mask,T.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(T.matrixAutoUpdate=!1),this.isInstancedMesh&&(T.type="InstancedMesh",T.count=this.count,T.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){T.geometry=o(e.geometries,this.geometry);var R=this.geometry.parameters;if(R!==void 0&&R.shapes!==void 0)if(R=R.shapes,Array.isArray(R))for(var z=0,k=R.length;z<k;z++)o(e.shapes,R[z]);else o(e.shapes,R)}if(this.material!==void 0)if(Array.isArray(this.material)){for(R=[],z=0,k=this.material.length;z<k;z++)R.push(o(e.materials,this.material[z]));T.material=R}else T.material=o(e.materials,this.material);if(0<this.children.length)for(T.children=[],z=0;z<this.children.length;z++)T.children.push(this.children[z].toJSON(e).object);if(m){m=h(e.geometries),z=h(e.materials),k=h(e.textures);var b=h(e.images);R=h(e.shapes),0<m.length&&(w.geometries=m),0<z.length&&(w.materials=z),0<k.length&&(w.textures=k),0<b.length&&(w.images=b),0<R.length&&(w.shapes=R)}return w.object=T,w},clone:function(e){return new this.constructor().copy(this,e)},copy:function(e,o){if(o===void 0&&(o=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(ls(e.userData)),o===!0)for(o=0;o<e.children.length;o++)this.add(e.children[o].clone());return this}}),W.prototype=ut(at(F.prototype),{constructor:W,isScene:!0,copy:function(e,o){return F.prototype.copy.call(this,e,o),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var o=F.prototype.toJSON.call(this,e);return this.background!==null&&(o.object.background=this.background.toJSON(e)),this.environment!==null&&(o.object.environment=this.environment.toJSON(e)),this.fog!==null&&(o.object.fog=this.fog.toJSON()),o},dispose:function(){this.dispatchEvent({type:"dispose"})}});var tc=[new _,new _,new _,new _,new _,new _,new _,new _],I0=new _,W2=new X,sm=new _,am=new _,um=new _,hf=new _,cf=new _,Wp=new _,E0=new _,dx=new _,gx=new _,jp=new _;ut(X.prototype,{isBox3:!0,set:function(e,o){return this.min.copy(e),this.max.copy(o),this},setFromArray:function(e){for(var o=Infinity,h=Infinity,m=Infinity,w=-Infinity,T=-Infinity,R=-Infinity,z=0,k=e.length;z<k;z+=3){var b=e[z],q=e[z+1],J=e[z+2];b<o&&(o=b),q<h&&(h=q),J<m&&(m=J),b>w&&(w=b),q>T&&(T=q),J>R&&(R=J)}return this.min.set(o,h,m),this.max.set(w,T,R),this},setFromBufferAttribute:function(e){for(var o=Infinity,h=Infinity,m=Infinity,w=-Infinity,T=-Infinity,R=-Infinity,z=0,k=e.count;z<k;z++){var b=e.getX(z),q=e.getY(z),J=e.getZ(z);b<o&&(o=b),q<h&&(h=q),J<m&&(m=J),b>w&&(w=b),q>T&&(T=q),J>R&&(R=J)}return this.min.set(o,h,m),this.max.set(w,T,R),this},setFromPoints:function(e){this.makeEmpty();for(var o=0,h=e.length;o<h;o++)this.expandByPoint(e[o]);return this},setFromCenterAndSize:function(e,o){return o=I0.copy(o).multiplyScalar(.5),this.min.copy(e).sub(o),this.max.copy(e).add(o),this},setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=Infinity,this.max.x=this.max.y=this.max.z=-Infinity,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return e===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new _),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return e===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new _),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(e){e.updateWorldMatrix(!1,!1);var o=e.geometry;o!==void 0&&(o.boundingBox===null&&o.computeBoundingBox(),W2.copy(o.boundingBox),W2.applyMatrix4(e.matrixWorld),this.union(W2)),e=e.children,o=0;for(var h=e.length;o<h;o++)this.expandByObject(e[o]);return this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,o){return o===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),o=new _),o.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(e){return this.clampPoint(e.center,I0),I0.distanceToSquared(e.center)<=e.radius*e.radius},intersectsPlane:function(e){if(0<e.normal.x)var o=e.normal.x*this.min.x,h=e.normal.x*this.max.x;else o=e.normal.x*this.max.x,h=e.normal.x*this.min.x;return 0<e.normal.y?(o+=e.normal.y*this.min.y,h+=e.normal.y*this.max.y):(o+=e.normal.y*this.max.y,h+=e.normal.y*this.min.y),0<e.normal.z?(o+=e.normal.z*this.min.z,h+=e.normal.z*this.max.z):(o+=e.normal.z*this.max.z,h+=e.normal.z*this.min.z),o<=-e.constant&&h>=-e.constant},intersectsTriangle:function(e){return this.isEmpty()||(this.getCenter(E0),dx.subVectors(this.max,E0),sm.subVectors(e.a,E0),am.subVectors(e.b,E0),um.subVectors(e.c,E0),hf.subVectors(am,sm),cf.subVectors(um,am),Wp.subVectors(sm,um),e=[0,-hf.z,hf.y,0,-cf.z,cf.y,0,-Wp.z,Wp.y,hf.z,0,-hf.x,cf.z,0,-cf.x,Wp.z,0,-Wp.x,-hf.y,hf.x,0,-cf.y,cf.x,0,-Wp.y,Wp.x,0],!Z(e,sm,am,um,dx))||(e=[1,0,0,0,1,0,0,0,1],!Z(e,sm,am,um,dx))?!1:(gx.crossVectors(hf,cf),e=[gx.x,gx.y,gx.z],Z(e,sm,am,um,dx))},clampPoint:function(e,o){return o===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),o=new _),o.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return I0.copy(e).clamp(this.min,this.max).sub(e).length()},getBoundingSphere:function(e){return e===void 0&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(I0).length(),e},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(e){return this.isEmpty()?this:(tc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),tc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),tc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),tc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),tc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),tc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),tc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),tc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(tc),this)},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var K3=new X;ut(tt.prototype,{set:function(e,o){return this.center.copy(e),this.radius=o,this},setFromPoints:function(e,o){var h=this.center;o!==void 0?h.copy(o):K3.setFromPoints(e).getCenter(h);for(var m=o=0,w=e.length;m<w;m++)o=Math.max(o,h.distanceToSquared(e[m]));return this.radius=Math.sqrt(o),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},isEmpty:function(){return 0>this.radius},makeEmpty:function(){return this.center.set(0,0,0),this.radius=-1,this},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var o=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=o*o},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,o){var h=this.center.distanceToSquared(e);return o===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),o=new _),o.copy(e),h>this.radius*this.radius&&(o.sub(this.center).normalize(),o.multiplyScalar(this.radius).add(this.center)),o},getBoundingBox:function(e){return e===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new X),this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius*=e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}});var ec=new _,j2=new _,mx=new _,ff=new _,X2=new _,vx=new _,Y2=new _;ut(ot.prototype,{set:function(e,o){return this.origin.copy(e),this.direction.copy(o),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,o){return o===void 0&&(console.warn("THREE.Ray: .at() target is now required"),o=new _),o.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(e){return this.origin.copy(this.at(e,ec)),this},closestPointToPoint:function(e,o){return o===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),o=new _),o.subVectors(e,this.origin),e=o.dot(this.direction),0>e?o.copy(this.origin):o.copy(this.direction).multiplyScalar(e).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(e){var o=ec.subVectors(e,this.origin).dot(this.direction);return 0>o?this.origin.distanceToSquared(e):(ec.copy(this.direction).multiplyScalar(o).add(this.origin),ec.distanceToSquared(e))},distanceSqToSegment:function(e,o,h,m){j2.copy(e).add(o).multiplyScalar(.5),mx.copy(o).sub(e).normalize(),ff.copy(this.origin).sub(j2);var w=.5*e.distanceTo(o),T=-this.direction.dot(mx),R=ff.dot(this.direction),z=-ff.dot(mx),k=ff.lengthSq(),b=Math.abs(1-T*T);if(0<b){e=T*z-R,o=T*R-z;var q=w*b;0<=e?o>=-q?o<=q?(w=1/b,e*=w,o*=w,T=e*(e+T*o+2*R)+o*(T*e+o+2*z)+k):(o=w,e=Math.max(0,-(T*o+R)),T=-e*e+o*(o+2*z)+k):(o=-w,e=Math.max(0,-(T*o+R)),T=-e*e+o*(o+2*z)+k):o<=-q?(e=Math.max(0,-(-T*w+R)),o=0<e?-w:Math.min(Math.max(-w,-z),w),T=-e*e+o*(o+2*z)+k):o<=q?(e=0,o=Math.min(Math.max(-w,-z),w),T=o*(o+2*z)+k):(e=Math.max(0,-(T*w+R)),o=0<e?w:Math.min(Math.max(-w,-z),w),T=-e*e+o*(o+2*z)+k)}else o=0<T?-w:w,e=Math.max(0,-(T*o+R)),T=-e*e+o*(o+2*z)+k;return h&&h.copy(this.direction).multiplyScalar(e).add(this.origin),m&&m.copy(mx).multiplyScalar(o).add(j2),T},intersectSphere:function(e,o){ec.subVectors(e.center,this.origin);var h=ec.dot(this.direction),m=ec.dot(ec)-h*h;return e=e.radius*e.radius,m>e?null:(e=Math.sqrt(e-m),m=h-e,h+=e,0>m&&0>h?null:0>m?this.at(h,o):this.at(m,o))},intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){var o=e.normal.dot(this.direction);return o===0?e.distanceToPoint(this.origin)===0?0:null:(e=-(this.origin.dot(e.normal)+e.constant)/o,0<=e?e:null)},intersectPlane:function(e,o){return e=this.distanceToPlane(e),e===null?null:this.at(e,o)},intersectsPlane:function(e){var o=e.distanceToPoint(this.origin);return o===0||0>e.normal.dot(this.direction)*o},intersectBox:function(e,o){var h=1/this.direction.x,m=1/this.direction.y,w=1/this.direction.z,T=this.origin;if(0<=h){var R=(e.min.x-T.x)*h;h*=e.max.x-T.x}else R=(e.max.x-T.x)*h,h*=e.min.x-T.x;if(0<=m){var z=(e.min.y-T.y)*m;m*=e.max.y-T.y}else z=(e.max.y-T.y)*m,m*=e.min.y-T.y;return R>m||z>h||((z>R||R!==R)&&(R=z),(m<h||h!==h)&&(h=m),0<=w?(z=(e.min.z-T.z)*w,e=(e.max.z-T.z)*w):(z=(e.max.z-T.z)*w,e=(e.min.z-T.z)*w),R>e||z>h)?null:((z>R||R!==R)&&(R=z),(e<h||h!==h)&&(h=e),0>h?null:this.at(0<=R?R:h,o))},intersectsBox:function(e){return this.intersectBox(e,ec)!==null},intersectTriangle:function(e,o,h,m,w){if(X2.subVectors(o,e),vx.subVectors(h,e),Y2.crossVectors(X2,vx),o=this.direction.dot(Y2),0<o){if(m)return null;m=1}else if(0>o)m=-1,o=-o;else return null;return ff.subVectors(this.origin,e),e=m*this.direction.dot(vx.crossVectors(ff,vx)),0>e||(h=m*this.direction.dot(X2.cross(ff)),0>h||e+h>o)?null:(e=-m*ff.dot(Y2),0>e?null:this.at(e/o,w))},applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}});var Z2=new _,Q3=new _,$3=new c;ut(xt.prototype,{isPlane:!0,set:function(e,o){return this.normal.copy(e),this.constant=o,this},setComponents:function(e,o,h,m){return this.normal.set(e,o,h),this.constant=m,this},setFromNormalAndCoplanarPoint:function(e,o){return this.normal.copy(e),this.constant=-o.dot(this.normal),this},setFromCoplanarPoints:function(e,o,h){return o=Z2.subVectors(h,o).cross(Q3.subVectors(e,o)).normalize(),this.setFromNormalAndCoplanarPoint(o,e),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,o){return o===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),o=new _),o.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(e,o){o===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),o=new _);var h=e.delta(Z2),m=this.normal.dot(h);if(m===0){if(this.distanceToPoint(e.start)===0)return o.copy(e.start)}else if(m=-(e.start.dot(this.normal)+this.constant)/m,!(0>m||1<m))return o.copy(h).multiplyScalar(m).add(e.start)},intersectsLine:function(e){var o=this.distanceToPoint(e.start);return e=this.distanceToPoint(e.end),0>o&&0<e||0>e&&0<o},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return e===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new _),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(e,o){return o=o||$3.getNormalMatrix(e),e=this.coplanarPoint(Z2).applyMatrix4(e),o=this.normal.applyMatrix3(o).normalize(),this.constant=-e.dot(o),this},translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}});var el=new _,rc=new _,J2=new _,ic=new _,lm=new _,hm=new _,hM=new _,q2=new _,K2=new _,Q2=new _;ut(At,{getNormal:function(e,o,h,m){return m===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),m=new _),m.subVectors(h,o),el.subVectors(e,o),m.cross(el),e=m.lengthSq(),0<e?m.multiplyScalar(1/Math.sqrt(e)):m.set(0,0,0)},getBarycoord:function(e,o,h,m,w){el.subVectors(m,o),rc.subVectors(h,o),J2.subVectors(e,o),e=el.dot(el),o=el.dot(rc),h=el.dot(J2);var T=rc.dot(rc);m=rc.dot(J2);var R=e*T-o*o;return w===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),w=new _),R===0?w.set(-2,-1,-1):(R=1/R,T=(T*h-o*m)*R,e=(e*m-o*h)*R,w.set(1-T-e,e,T))},containsPoint:function(e,o,h,m){return At.getBarycoord(e,o,h,m,ic),0<=ic.x&&0<=ic.y&&1>=ic.x+ic.y},getUV:function(e,o,h,m,w,T,R,z){return this.getBarycoord(e,o,h,m,ic),z.set(0,0),z.addScaledVector(w,ic.x),z.addScaledVector(T,ic.y),z.addScaledVector(R,ic.z),z},isFrontFacing:function(e,o,h,m){return el.subVectors(h,o),rc.subVectors(e,o),0>el.cross(rc).dot(m)}}),ut(At.prototype,{set:function(e,o,h){return this.a.copy(e),this.b.copy(o),this.c.copy(h),this},setFromPointsAndIndices:function(e,o,h,m){return this.a.copy(e[o]),this.b.copy(e[h]),this.c.copy(e[m]),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){return el.subVectors(this.c,this.b),rc.subVectors(this.a,this.b),.5*el.cross(rc).length()},getMidpoint:function(e){return e===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new _),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return At.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return e===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new xt),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,o){return At.getBarycoord(e,this.a,this.b,this.c,o)},getUV:function(e,o,h,m,w){return At.getUV(e,this.a,this.b,this.c,o,h,m,w)},containsPoint:function(e){return At.containsPoint(e,this.a,this.b,this.c)},isFrontFacing:function(e){return At.isFrontFacing(this.a,this.b,this.c,e)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(e,o){o===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),o=new _);var h=this.a,m=this.b,w=this.c;lm.subVectors(m,h),hm.subVectors(w,h),q2.subVectors(e,h);var T=lm.dot(q2),R=hm.dot(q2);if(0>=T&&0>=R)return o.copy(h);K2.subVectors(e,m);var z=lm.dot(K2),k=hm.dot(K2);if(0<=z&&k<=z)return o.copy(m);var b=T*k-z*R;if(0>=b&&0<=T&&0>=z)return m=T/(T-z),o.copy(h).addScaledVector(lm,m);Q2.subVectors(e,w),e=lm.dot(Q2);var q=hm.dot(Q2);return 0<=q&&e<=q?o.copy(w):(T=e*R-T*q,0>=T&&0<=R&&0>=q?(b=R/(R-q),o.copy(h).addScaledVector(hm,b)):(R=z*q-e*k,0>=R&&0<=k-z&&0<=e-q?(hM.subVectors(w,m),b=(k-z)/(k-z+(e-q)),o.copy(m).addScaledVector(hM,b)):(w=1/(R+T+b),m=T*w,b*=w,o.copy(h).addScaledVector(lm,m).addScaledVector(hm,b))))},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}});var cM={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},rl={h:0,s:0,l:0},yx={h:0,s:0,l:0};ut(yt.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this},setScalar:function(e){return this.b=this.g=this.r=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,this},setRGB:function(e,o,h){return this.r=e,this.g=o,this.b=h,this},setHSL:function(e,o,h){return e=Si.euclideanModulo(e,1),o=Si.clamp(o,0,1),h=Si.clamp(h,0,1),o===0?this.r=this.g=this.b=h:(o=.5>=h?h*(1+o):h+o-h*o,h=2*h-o,this.r=zt(h,o,e+1/3),this.g=zt(h,o,e),this.b=zt(h,o,e-1/3)),this},setStyle:function(e){function o(R){R!==void 0&&1>parseFloat(R)&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var h;if(h=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var m=h[2];switch(h[1]){case"rgb":case"rgba":if(h=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(m))return this.r=Math.min(255,parseInt(h[1],10))/255,this.g=Math.min(255,parseInt(h[2],10))/255,this.b=Math.min(255,parseInt(h[3],10))/255,o(h[5]),this;if(h=/^(\d+)%\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(m))return this.r=Math.min(100,parseInt(h[1],10))/100,this.g=Math.min(100,parseInt(h[2],10))/100,this.b=Math.min(100,parseInt(h[3],10))/100,o(h[5]),this;break;case"hsl":case"hsla":if(h=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(m)){m=parseFloat(h[1])/360;var w=parseInt(h[2],10)/100,T=parseInt(h[3],10)/100;return o(h[5]),this.setHSL(m,w,T)}}}else if(h=/^#([A-Fa-f0-9]+)$/.exec(e)){if(h=h[1],m=h.length,m===3)return this.r=parseInt(h.charAt(0)+h.charAt(0),16)/255,this.g=parseInt(h.charAt(1)+h.charAt(1),16)/255,this.b=parseInt(h.charAt(2)+h.charAt(2),16)/255,this;if(m===6)return this.r=parseInt(h.charAt(0)+h.charAt(1),16)/255,this.g=parseInt(h.charAt(2)+h.charAt(3),16)/255,this.b=parseInt(h.charAt(4)+h.charAt(5),16)/255,this}return e&&0<e.length?this.setColorName(e):this},setColorName:function(e){var o=cM[e];return o!==void 0?this.setHex(o):console.warn("THREE.Color: Unknown color "+e),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,o){return o===void 0&&(o=2),this.r=Math.pow(e.r,o),this.g=Math.pow(e.g,o),this.b=Math.pow(e.b,o),this},copyLinearToGamma:function(e,o){return o===void 0&&(o=2),o=0<o?1/o:1,this.r=Math.pow(e.r,o),this.g=Math.pow(e.g,o),this.b=Math.pow(e.b,o),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(e){return this.r=Ht(e.r),this.g=Ht(e.g),this.b=Ht(e.b),this},copyLinearToSRGB:function(e){return this.r=$t(e.r),this.g=$t(e.g),this.b=$t(e.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){e===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var o=this.r,h=this.g,m=this.b,w=Math.max(o,h,m),T=Math.min(o,h,m),R,z=(T+w)/2;if(T===w)T=R=0;else{var k=w-T;switch(T=.5>=z?k/(w+T):k/(2-w-T),w){case o:R=(h-m)/k+(h<m?6:0);break;case h:R=(m-o)/k+2;break;case m:R=(o-h)/k+4}R/=6}return e.h=R,e.s=T,e.l=z,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,o,h){return this.getHSL(rl),rl.h+=e,rl.s+=o,rl.l+=h,this.setHSL(rl.h,rl.s,rl.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,o){return this.r=e.r+o.r,this.g=e.g+o.g,this.b=e.b+o.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,o){return this.r+=(e.r-this.r)*o,this.g+=(e.g-this.g)*o,this.b+=(e.b-this.b)*o,this},lerpHSL:function(e,o){this.getHSL(rl),e.getHSL(yx),e=Si.lerp(rl.h,yx.h,o);var h=Si.lerp(rl.s,yx.s,o);return o=Si.lerp(rl.l,yx.l,o),this.setHSL(e,h,o),this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,o){return o===void 0&&(o=0),this.r=e[o],this.g=e[o+1],this.b=e[o+2],this},toArray:function(e,o){return e===void 0&&(e=[]),o===void 0&&(o=0),e[o]=this.r,e[o+1]=this.g,e[o+2]=this.b,e},toJSON:function(){return this.getHex()}}),yt.NAMES=cM,ut(Vt.prototype,{clone:function(){return new this.constructor().copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var o=0,h=e.vertexNormals.length;o<h;o++)this.vertexNormals[o]=e.vertexNormals[o].clone();for(o=0,h=e.vertexColors.length;o<h;o++)this.vertexColors[o]=e.vertexColors[o].clone();return this}});var tT=0;Kt.prototype=ut(at(s.prototype),{constructor:Kt,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(e!==void 0)for(var o in e){var h=e[o];if(h===void 0)console.warn("THREE.Material: '"+o+"' parameter is undefined.");else if(o==="shading")console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=h===1;else{var m=this[o];m===void 0?console.warn("THREE."+this.type+": '"+o+"' is not a property of this material."):m&&m.isColor?m.set(h):m&&m.isVector3&&h&&h.isVector3?m.copy(h):this[o]=h}}},toJSON:function(e){function o(w){var T=[],R;for(R in w){var z=w[R];delete z.metadata,T.push(z)}return T}var h=e===void 0||typeof e=="string";h&&(e={textures:{},images:{}});var m={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};return m.uuid=this.uuid,m.type=this.type,this.name!==""&&(m.name=this.name),this.color&&this.color.isColor&&(m.color=this.color.getHex()),this.roughness!==void 0&&(m.roughness=this.roughness),this.metalness!==void 0&&(m.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(m.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(m.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(m.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(m.specular=this.specular.getHex()),this.shininess!==void 0&&(m.shininess=this.shininess),this.clearcoat!==void 0&&(m.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(m.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(m.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(m.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(m.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,m.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(m.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(m.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(m.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(m.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(m.aoMap=this.aoMap.toJSON(e).uuid,m.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(m.bumpMap=this.bumpMap.toJSON(e).uuid,m.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(m.normalMap=this.normalMap.toJSON(e).uuid,m.normalMapType=this.normalMapType,m.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(m.displacementMap=this.displacementMap.toJSON(e).uuid,m.displacementScale=this.displacementScale,m.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(m.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(m.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(m.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(m.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(m.envMap=this.envMap.toJSON(e).uuid,m.reflectivity=this.reflectivity,m.refractionRatio=this.refractionRatio,this.combine!==void 0&&(m.combine=this.combine),this.envMapIntensity!==void 0&&(m.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(m.gradientMap=this.gradientMap.toJSON(e).uuid),this.size!==void 0&&(m.size=this.size),this.sizeAttenuation!==void 0&&(m.sizeAttenuation=this.sizeAttenuation),this.blending!==1&&(m.blending=this.blending),this.flatShading===!0&&(m.flatShading=this.flatShading),this.side!==0&&(m.side=this.side),this.vertexColors&&(m.vertexColors=!0),1>this.opacity&&(m.opacity=this.opacity),this.transparent===!0&&(m.transparent=this.transparent),m.depthFunc=this.depthFunc,m.depthTest=this.depthTest,m.depthWrite=this.depthWrite,m.stencilWrite=this.stencilWrite,m.stencilWriteMask=this.stencilWriteMask,m.stencilFunc=this.stencilFunc,m.stencilRef=this.stencilRef,m.stencilFuncMask=this.stencilFuncMask,m.stencilFail=this.stencilFail,m.stencilZFail=this.stencilZFail,m.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(m.rotation=this.rotation),this.polygonOffset===!0&&(m.polygonOffset=!0),this.polygonOffsetFactor!==0&&(m.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(m.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(m.linewidth=this.linewidth),this.dashSize!==void 0&&(m.dashSize=this.dashSize),this.gapSize!==void 0&&(m.gapSize=this.gapSize),this.scale!==void 0&&(m.scale=this.scale),this.dithering===!0&&(m.dithering=!0),0<this.alphaTest&&(m.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(m.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(m.wireframe=this.wireframe),1<this.wireframeLinewidth&&(m.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(m.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(m.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(m.morphTargets=!0),this.morphNormals===!0&&(m.morphNormals=!0),this.skinning===!0&&(m.skinning=!0),this.visible===!1&&(m.visible=!1),this.toneMapped===!1&&(m.toneMapped=!1),ls(this.userData)!=="{}"&&(m.userData=this.userData),h&&(h=o(e.textures),e=o(e.images),0<h.length&&(m.textures=h),0<e.length&&(m.images=e)),m},clone:function(){return new this.constructor().copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var o=e.clippingPlanes,h=null;if(o!==null){var m=o.length;h=Array(m);for(var w=0;w!==m;++w)h[w]=o[w].clone()}return this.clippingPlanes=h,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(ls(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Kt.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),ze.prototype=at(Kt.prototype),ze.prototype.constructor=ze,ze.prototype.isMeshBasicMaterial=!0,ze.prototype.copy=function(e){return Kt.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this};var En=new _;Object.defineProperty(ae.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),ut(ae.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,o,h){e*=this.itemSize,h*=o.itemSize;for(var m=0,w=this.itemSize;m<w;m++)this.array[e+m]=o.array[h+m];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var o=this.array,h=0,m=0,w=e.length;m<w;m++){var T=e[m];T===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",m),T=new yt),o[h++]=T.r,o[h++]=T.g,o[h++]=T.b}return this},copyVector2sArray:function(e){for(var o=this.array,h=0,m=0,w=e.length;m<w;m++){var T=e[m];T===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",m),T=new f),o[h++]=T.x,o[h++]=T.y}return this},copyVector3sArray:function(e){for(var o=this.array,h=0,m=0,w=e.length;m<w;m++){var T=e[m];T===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",m),T=new _),o[h++]=T.x,o[h++]=T.y,o[h++]=T.z}return this},copyVector4sArray:function(e){for(var o=this.array,h=0,m=0,w=e.length;m<w;m++){var T=e[m];T===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",m),T=new p),o[h++]=T.x,o[h++]=T.y,o[h++]=T.z,o[h++]=T.w}return this},applyMatrix3:function(e){for(var o=0,h=this.count;o<h;o++)En.x=this.getX(o),En.y=this.getY(o),En.z=this.getZ(o),En.applyMatrix3(e),this.setXYZ(o,En.x,En.y,En.z);return this},applyMatrix4:function(e){for(var o=0,h=this.count;o<h;o++)En.x=this.getX(o),En.y=this.getY(o),En.z=this.getZ(o),En.applyMatrix4(e),this.setXYZ(o,En.x,En.y,En.z);return this},applyNormalMatrix:function(e){for(var o=0,h=this.count;o<h;o++)En.x=this.getX(o),En.y=this.getY(o),En.z=this.getZ(o),En.applyNormalMatrix(e),this.setXYZ(o,En.x,En.y,En.z);return this},transformDirection:function(e){for(var o=0,h=this.count;o<h;o++)En.x=this.getX(o),En.y=this.getY(o),En.z=this.getZ(o),En.transformDirection(e),this.setXYZ(o,En.x,En.y,En.z);return this},set:function(e,o){return o===void 0&&(o=0),this.array.set(e,o),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,o){return this.array[e*this.itemSize]=o,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,o){return this.array[e*this.itemSize+1]=o,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,o){return this.array[e*this.itemSize+2]=o,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,o){return this.array[e*this.itemSize+3]=o,this},setXY:function(e,o,h){return e*=this.itemSize,this.array[e+0]=o,this.array[e+1]=h,this},setXYZ:function(e,o,h,m){return e*=this.itemSize,this.array[e+0]=o,this.array[e+1]=h,this.array[e+2]=m,this},setXYZW:function(e,o,h,m,w){return e*=this.itemSize,this.array[e+0]=o,this.array[e+1]=h,this.array[e+2]=m,this.array[e+3]=w,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),Qe.prototype=at(ae.prototype),Qe.prototype.constructor=Qe,gr.prototype=at(ae.prototype),gr.prototype.constructor=gr,ir.prototype=at(ae.prototype),ir.prototype.constructor=ir,gi.prototype=at(ae.prototype),gi.prototype.constructor=gi,hr.prototype=at(ae.prototype),hr.prototype.constructor=hr,gt.prototype=at(ae.prototype),gt.prototype.constructor=gt,mt.prototype=at(ae.prototype),mt.prototype.constructor=mt,vt.prototype=at(ae.prototype),vt.prototype.constructor=vt,Ct.prototype=at(ae.prototype),Ct.prototype.constructor=Ct,ut(et.prototype,{computeGroups:function(e){var o=[],h=void 0;e=e.faces;for(var m=0;m<e.length;m++){var w=e[m];if(w.materialIndex!==h){h=w.materialIndex,T!==void 0&&(T.count=3*m-T.start,o.push(T));var T={start:3*m,materialIndex:h}}}T!==void 0&&(T.count=3*m-T.start,o.push(T)),this.groups=o},fromGeometry:function(e){var o=e.faces,h=e.vertices,m=e.faceVertexUvs,w=m[0]&&0<m[0].length,T=m[1]&&0<m[1].length,R=e.morphTargets,z=R.length;if(0<z){for(var k=[],b=0;b<z;b++)k[b]={name:R[b].name,data:[]};this.morphTargets.position=k}var q=e.morphNormals,J=q.length;if(0<J){var Q=[];for(b=0;b<J;b++)Q[b]={name:q[b].name,data:[]};this.morphTargets.normal=Q}var K=e.skinIndices,rt=e.skinWeights,ht=K.length===h.length,Ot=rt.length===h.length;for(0<h.length&&o.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported."),b=0;b<o.length;b++){var jt=o[b];this.vertices.push(h[jt.a],h[jt.b],h[jt.c]);var Gt=jt.vertexNormals;for(Gt.length===3?this.normals.push(Gt[0],Gt[1],Gt[2]):(Gt=jt.normal,this.normals.push(Gt,Gt,Gt)),Gt=jt.vertexColors,Gt.length===3?this.colors.push(Gt[0],Gt[1],Gt[2]):(Gt=jt.color,this.colors.push(Gt,Gt,Gt)),w===!0&&(Gt=m[0][b],Gt!==void 0?this.uvs.push(Gt[0],Gt[1],Gt[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",b),this.uvs.push(new f,new f,new f))),T===!0&&(Gt=m[1][b],Gt!==void 0?this.uvs2.push(Gt[0],Gt[1],Gt[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",b),this.uvs2.push(new f,new f,new f))),Gt=0;Gt<z;Gt++){var ee=R[Gt].vertices;k[Gt].data.push(ee[jt.a],ee[jt.b],ee[jt.c])}for(Gt=0;Gt<J;Gt++)ee=q[Gt].vertexNormals[b],Q[Gt].data.push(ee.a,ee.b,ee.c);ht&&this.skinIndices.push(K[jt.a],K[jt.b],K[jt.c]),Ot&&this.skinWeights.push(rt[jt.a],rt[jt.b],rt[jt.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this}});var eT=1,Kl=new I,$2=new F,cm=new _,Ja=new X,L0=new X,Oo=new _;ft.prototype=ut(at(s.prototype),{constructor:ft,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(65535<ct(e)?mt:hr)(e,1):this.index=e},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,o){return this.attributes[e]=o,this},deleteAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,o,h){this.groups.push({start:e,count:o,materialIndex:h!==void 0?h:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,o){this.drawRange.start=e,this.drawRange.count=o},applyMatrix4:function(e){var o=this.attributes.position;if(o!==void 0&&(o.applyMatrix4(e),o.needsUpdate=!0),o=this.attributes.normal,o!==void 0){var h=new c().getNormalMatrix(e);o.applyNormalMatrix(h),o.needsUpdate=!0}return o=this.attributes.tangent,o!==void 0&&(o.transformDirection(e),o.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(e){return Kl.makeRotationX(e),this.applyMatrix4(Kl),this},rotateY:function(e){return Kl.makeRotationY(e),this.applyMatrix4(Kl),this},rotateZ:function(e){return Kl.makeRotationZ(e),this.applyMatrix4(Kl),this},translate:function(e,o,h){return Kl.makeTranslation(e,o,h),this.applyMatrix4(Kl),this},scale:function(e,o,h){return Kl.makeScale(e,o,h),this.applyMatrix4(Kl),this},lookAt:function(e){return $2.lookAt(e),$2.updateMatrix(),this.applyMatrix4($2.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(cm).negate(),this.translate(cm.x,cm.y,cm.z),this},setFromObject:function(e){var o=e.geometry;if(e.isPoints||e.isLine){e=new vt(3*o.vertices.length,3);var h=new vt(3*o.colors.length,3);this.setAttribute("position",e.copyVector3sArray(o.vertices)),this.setAttribute("color",h.copyColorsArray(o.colors)),o.lineDistances&&o.lineDistances.length===o.vertices.length&&(e=new vt(o.lineDistances.length,1),this.setAttribute("lineDistance",e.copyArray(o.lineDistances))),o.boundingSphere!==null&&(this.boundingSphere=o.boundingSphere.clone()),o.boundingBox!==null&&(this.boundingBox=o.boundingBox.clone())}else e.isMesh&&o&&o.isGeometry&&this.fromGeometry(o);return this},setFromPoints:function(e){for(var o=[],h=0,m=e.length;h<m;h++){var w=e[h];o.push(w.x,w.y,w.z||0)}return this.setAttribute("position",new vt(o,3)),this},updateFromObject:function(e){var o=e.geometry;if(e.isMesh){var h=o.__directGeometry;if(o.elementsNeedUpdate===!0&&(h=void 0,o.elementsNeedUpdate=!1),h===void 0)return this.fromGeometry(o);h.verticesNeedUpdate=o.verticesNeedUpdate,h.normalsNeedUpdate=o.normalsNeedUpdate,h.colorsNeedUpdate=o.colorsNeedUpdate,h.uvsNeedUpdate=o.uvsNeedUpdate,h.groupsNeedUpdate=o.groupsNeedUpdate,o.verticesNeedUpdate=!1,o.normalsNeedUpdate=!1,o.colorsNeedUpdate=!1,o.uvsNeedUpdate=!1,o.groupsNeedUpdate=!1,o=h}return o.verticesNeedUpdate===!0&&(h=this.attributes.position,h!==void 0&&(h.copyVector3sArray(o.vertices),h.needsUpdate=!0),o.verticesNeedUpdate=!1),o.normalsNeedUpdate===!0&&(h=this.attributes.normal,h!==void 0&&(h.copyVector3sArray(o.normals),h.needsUpdate=!0),o.normalsNeedUpdate=!1),o.colorsNeedUpdate===!0&&(h=this.attributes.color,h!==void 0&&(h.copyColorsArray(o.colors),h.needsUpdate=!0),o.colorsNeedUpdate=!1),o.uvsNeedUpdate&&(h=this.attributes.uv,h!==void 0&&(h.copyVector2sArray(o.uvs),h.needsUpdate=!0),o.uvsNeedUpdate=!1),o.lineDistancesNeedUpdate&&(h=this.attributes.lineDistance,h!==void 0&&(h.copyArray(o.lineDistances),h.needsUpdate=!0),o.lineDistancesNeedUpdate=!1),o.groupsNeedUpdate&&(o.computeGroups(e.geometry),this.groups=o.groups,o.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=new et().fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var o=new Float32Array(3*e.vertices.length);this.setAttribute("position",new ae(o,3).copyVector3sArray(e.vertices)),0<e.normals.length&&(o=new Float32Array(3*e.normals.length),this.setAttribute("normal",new ae(o,3).copyVector3sArray(e.normals))),0<e.colors.length&&(o=new Float32Array(3*e.colors.length),this.setAttribute("color",new ae(o,3).copyColorsArray(e.colors))),0<e.uvs.length&&(o=new Float32Array(2*e.uvs.length),this.setAttribute("uv",new ae(o,2).copyVector2sArray(e.uvs))),0<e.uvs2.length&&(o=new Float32Array(2*e.uvs2.length),this.setAttribute("uv2",new ae(o,2).copyVector2sArray(e.uvs2))),this.groups=e.groups;for(var h in e.morphTargets){o=[];for(var m=e.morphTargets[h],w=0,T=m.length;w<T;w++){var R=m[w],z=new vt(3*R.data.length,3);z.name=R.name,o.push(z.copyVector3sArray(R.data))}this.morphAttributes[h]=o}return 0<e.skinIndices.length&&(h=new vt(4*e.skinIndices.length,4),this.setAttribute("skinIndex",h.copyVector4sArray(e.skinIndices))),0<e.skinWeights.length&&(h=new vt(4*e.skinWeights.length,4),this.setAttribute("skinWeight",h.copyVector4sArray(e.skinWeights))),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new X);var e=this.attributes.position,o=this.morphAttributes.position;if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),o){e=0;for(var h=o.length;e<h;e++)Ja.setFromBufferAttribute(o[e]),this.morphTargetsRelative?(Oo.addVectors(this.boundingBox.min,Ja.min),this.boundingBox.expandByPoint(Oo),Oo.addVectors(this.boundingBox.max,Ja.max),this.boundingBox.expandByPoint(Oo)):(this.boundingBox.expandByPoint(Ja.min),this.boundingBox.expandByPoint(Ja.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new tt);var e=this.attributes.position,o=this.morphAttributes.position;if(e){var h=this.boundingSphere.center;if(Ja.setFromBufferAttribute(e),o)for(var m=0,w=o.length;m<w;m++){var T=o[m];L0.setFromBufferAttribute(T),this.morphTargetsRelative?(Oo.addVectors(Ja.min,L0.min),Ja.expandByPoint(Oo),Oo.addVectors(Ja.max,L0.max),Ja.expandByPoint(Oo)):(Ja.expandByPoint(L0.min),Ja.expandByPoint(L0.max))}Ja.getCenter(h);var R=0;for(m=0,w=e.count;m<w;m++)Oo.fromBufferAttribute(e,m),R=Math.max(R,h.distanceToSquared(Oo));if(o)for(m=0,w=o.length;m<w;m++){T=o[m];for(var z=this.morphTargetsRelative,k=0,b=T.count;k<b;k++)Oo.fromBufferAttribute(T,k),z&&(cm.fromBufferAttribute(e,k),Oo.add(cm)),R=Math.max(R,h.distanceToSquared(Oo))}this.boundingSphere.radius=Math.sqrt(R),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,o=this.attributes;if(o.position){var h=o.position.array;if(o.normal===void 0)this.setAttribute("normal",new ae(new Float32Array(h.length),3));else for(var m=o.normal.array,w=0,T=m.length;w<T;w++)m[w]=0;m=o.normal.array;var R=new _,z=new _,k=new _,b=new _,q=new _;if(e){var J=e.array;for(w=0,T=e.count;w<T;w+=3){e=3*J[w+0];var Q=3*J[w+1],K=3*J[w+2];R.fromArray(h,e),z.fromArray(h,Q),k.fromArray(h,K),b.subVectors(k,z),q.subVectors(R,z),b.cross(q),m[e]+=b.x,m[e+1]+=b.y,m[e+2]+=b.z,m[Q]+=b.x,m[Q+1]+=b.y,m[Q+2]+=b.z,m[K]+=b.x,m[K+1]+=b.y,m[K+2]+=b.z}}else for(w=0,T=h.length;w<T;w+=9)R.fromArray(h,w),z.fromArray(h,w+3),k.fromArray(h,w+6),b.subVectors(k,z),q.subVectors(R,z),b.cross(q),m[w]=b.x,m[w+1]=b.y,m[w+2]=b.z,m[w+3]=b.x,m[w+4]=b.y,m[w+5]=b.z,m[w+6]=b.x,m[w+7]=b.y,m[w+8]=b.z;this.normalizeNormals(),o.normal.needsUpdate=!0}},merge:function(e,o){if(e&&e.isBufferGeometry){o===void 0&&(o=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var h=this.attributes,m;for(m in h)if(e.attributes[m]!==void 0){var w=h[m].array,T=e.attributes[m],R=T.array,z=T.itemSize*o;T=Math.min(R.length,w.length-z);for(var k=0;k<T;k++,z++)w[z]=R[k]}return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){for(var e=this.attributes.normal,o=0,h=e.count;o<h;o++)Oo.x=e.getX(o),Oo.y=e.getY(o),Oo.z=e.getZ(o),Oo.normalize(),e.setXYZ(o,Oo.x,Oo.y,Oo.z)},toNonIndexed:function(){function e(q,J){var Q=q.array,K=q.itemSize;q=q.normalized;for(var rt=new Q.constructor(J.length*K),ht,Ot=0,jt=0,Gt=J.length;jt<Gt;jt++){ht=J[jt]*K;for(var ee=0;ee<K;ee++)rt[Ot++]=Q[ht++]}return new ae(rt,K,q)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var o=new ft,h=this.index.array,m=this.attributes,w;for(w in m){var T=m[w];T=e(T,h),o.setAttribute(w,T)}var R=this.morphAttributes;for(w in R){var z=[],k=R[w];m=0;for(var b=k.length;m<b;m++)T=k[m],T=e(T,h),z.push(T);o.morphAttributes[w]=z}for(o.morphTargetsRelative=this.morphTargetsRelative,h=this.groups,m=0,w=h.length;m<w;m++)T=h[m],o.addGroup(T.start,T.count,T.materialIndex);return o},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),0<qi(this.userData).length&&(e.userData=this.userData),this.parameters!==void 0){var o=this.parameters;for(b in o)o[b]!==void 0&&(e[b]=o[b]);return e}e.data={attributes:{}},o=this.index,o!==null&&(e.data.index={type:o.array.constructor.name,array:Array.prototype.slice.call(o.array)});var h=this.attributes;for(b in h){o=h[b];var m=o.toJSON();o.name!==""&&(m.name=o.name),e.data.attributes[b]=m}h={};var w=!1;for(b in this.morphAttributes){for(var T=this.morphAttributes[b],R=[],z=0,k=T.length;z<k;z++)o=T[z],m=o.toJSON(),o.name!==""&&(m.name=o.name),R.push(m);0<R.length&&(h[b]=R,w=!0)}w&&(e.data.morphAttributes=h,e.data.morphTargetsRelative=this.morphTargetsRelative);var b=this.groups;return 0<b.length&&(e.data.groups=JSON.parse(ls(b))),b=this.boundingSphere,b!==null&&(e.data.boundingSphere={center:b.center.toArray(),radius:b.radius}),e},clone:function(){return new ft().copy(this)},copy:function(e){var o;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.name=e.name;var h=e.index;h!==null&&this.setIndex(h.clone()),h=e.attributes;for(R in h)this.setAttribute(R,h[R].clone());var m=e.morphAttributes;for(R in m){var w=[],T=m[R];for(h=0,o=T.length;h<o;h++)w.push(T[h].clone());this.morphAttributes[R]=w}this.morphTargetsRelative=e.morphTargetsRelative;var R=e.groups;for(h=0,o=R.length;h<o;h++)m=R[h],this.addGroup(m.start,m.count,m.materialIndex);return R=e.boundingBox,R!==null&&(this.boundingBox=R.clone()),R=e.boundingSphere,R!==null&&(this.boundingSphere=R.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var fM=new I,Xp=new ot,tw=new tt,pf=new _,df=new _,gf=new _,ew=new _,rw=new _,iw=new _,xx=new _,Ax=new _,wx=new _,fm=new f,pm=new f,dm=new f,R0=new _,_x=new _;Tt.prototype=ut(at(F.prototype),{constructor:Tt,isMesh:!0,copy:function(e){return F.prototype.copy.call(this,e),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=ut({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){e=e.morphAttributes;var o=qi(e);if(0<o.length){var h=e[o[0]];if(h!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,o=h.length;e<o;e++){var m=h[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[m]=e}}}else e=e.morphTargets,e!==void 0&&0<e.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},raycast:function(e,o){var h=this.geometry,m=this.material,w=this.matrixWorld;if(m!==void 0&&(h.boundingSphere===null&&h.computeBoundingSphere(),tw.copy(h.boundingSphere),tw.applyMatrix4(w),e.ray.intersectsSphere(tw)!==!1&&(fM.getInverse(w),Xp.copy(e.ray).applyMatrix4(fM),h.boundingBox===null||Xp.intersectsBox(h.boundingBox)!==!1))){if(h.isBufferGeometry){var T=h.index;w=h.attributes.position;var R=h.morphAttributes.position,z=h.morphTargetsRelative,k=h.attributes.uv,b=h.attributes.uv2,q=h.groups,J=h.drawRange,Q,K;if(T!==null)if(Array.isArray(m)){var rt=0;for(Q=q.length;rt<Q;rt++){var ht=q[rt],Ot=m[ht.materialIndex],jt=Math.max(ht.start,J.start);for(K=h=Math.min(ht.start+ht.count,J.start+J.count);jt<K;jt+=3){h=T.getX(jt);var Gt=T.getX(jt+1),ee=T.getX(jt+2);(h=Jt(this,Ot,e,Xp,w,R,z,k,b,h,Gt,ee))&&(h.faceIndex=Math.floor(jt/3),h.face.materialIndex=ht.materialIndex,o.push(h))}}}else for(jt=Math.max(0,J.start),h=Math.min(T.count,J.start+J.count),rt=jt,Q=h;rt<Q;rt+=3)h=T.getX(rt),Gt=T.getX(rt+1),ee=T.getX(rt+2),(h=Jt(this,m,e,Xp,w,R,z,k,b,h,Gt,ee))&&(h.faceIndex=Math.floor(rt/3),o.push(h));else if(w!==void 0)if(Array.isArray(m))for(rt=0,Q=q.length;rt<Q;rt++)for(ht=q[rt],Ot=m[ht.materialIndex],jt=Math.max(ht.start,J.start),K=h=Math.min(ht.start+ht.count,J.start+J.count);jt<K;jt+=3)h=jt,Gt=jt+1,ee=jt+2,(h=Jt(this,Ot,e,Xp,w,R,z,k,b,h,Gt,ee))&&(h.faceIndex=Math.floor(jt/3),h.face.materialIndex=ht.materialIndex,o.push(h));else for(jt=Math.max(0,J.start),h=Math.min(w.count,J.start+J.count),rt=jt,Q=h;rt<Q;rt+=3)h=rt,Gt=rt+1,ee=rt+2,(h=Jt(this,m,e,Xp,w,R,z,k,b,h,Gt,ee))&&(h.faceIndex=Math.floor(rt/3),o.push(h))}else if(h.isGeometry)for(w=Array.isArray(m),R=h.vertices,z=h.faces,h=h.faceVertexUvs[0],0<h.length&&(T=h),J=0,rt=z.length;J<rt;J++)Q=z[J],h=w?m[Q.materialIndex]:m,h!==void 0&&(k=R[Q.a],b=R[Q.b],q=R[Q.c],h=kt(this,h,e,Xp,k,b,q,R0))&&(T&&T[J]&&(ht=T[J],fm.copy(ht[0]),pm.copy(ht[1]),dm.copy(ht[2]),h.uv=At.getUV(R0,k,b,q,fm,pm,dm,new f)),h.face=Q,h.faceIndex=J,o.push(h))}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var rT=0,Ql=new I,nw=new F,Mx=new _;pt.prototype=ut(at(s.prototype),{constructor:pt,isGeometry:!0,applyMatrix4:function(e){for(var o=new c().getNormalMatrix(e),h=0,m=this.vertices.length;h<m;h++)this.vertices[h].applyMatrix4(e);for(h=0,m=this.faces.length;h<m;h++){e=this.faces[h],e.normal.applyMatrix3(o).normalize();for(var w=0,T=e.vertexNormals.length;w<T;w++)e.vertexNormals[w].applyMatrix3(o).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.normalsNeedUpdate=this.verticesNeedUpdate=!0,this},rotateX:function(e){return Ql.makeRotationX(e),this.applyMatrix4(Ql),this},rotateY:function(e){return Ql.makeRotationY(e),this.applyMatrix4(Ql),this},rotateZ:function(e){return Ql.makeRotationZ(e),this.applyMatrix4(Ql),this},translate:function(e,o,h){return Ql.makeTranslation(e,o,h),this.applyMatrix4(Ql),this},scale:function(e,o,h){return Ql.makeScale(e,o,h),this.applyMatrix4(Ql),this},lookAt:function(e){return nw.lookAt(e),nw.updateMatrix(),this.applyMatrix4(nw.matrix),this},fromBufferGeometry:function(e){function o(K,rt,ht,Ot){var jt=z===void 0?[]:[h.colors[K].clone(),h.colors[rt].clone(),h.colors[ht].clone()],Gt=R===void 0?[]:[new _().fromArray(R,3*K),new _().fromArray(R,3*rt),new _().fromArray(R,3*ht)];Ot=new Vt(K,rt,ht,Gt,jt,Ot),h.faces.push(Ot),k!==void 0&&h.faceVertexUvs[0].push([new f().fromArray(k,2*K),new f().fromArray(k,2*rt),new f().fromArray(k,2*ht)]),b!==void 0&&h.faceVertexUvs[1].push([new f().fromArray(b,2*K),new f().fromArray(b,2*rt),new f().fromArray(b,2*ht)])}var h=this,m=e.index!==null?e.index.array:void 0,w=e.attributes;if(w.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var T=w.position.array,R=w.normal!==void 0?w.normal.array:void 0,z=w.color!==void 0?w.color.array:void 0,k=w.uv!==void 0?w.uv.array:void 0,b=w.uv2!==void 0?w.uv2.array:void 0;for(b!==void 0&&(this.faceVertexUvs[1]=[]),w=0;w<T.length;w+=3)h.vertices.push(new _().fromArray(T,w)),z!==void 0&&h.colors.push(new yt().fromArray(z,w));var q=e.groups;if(0<q.length)for(w=0;w<q.length;w++){T=q[w];var J=T.start,Q=J;for(J+=T.count;Q<J;Q+=3)m!==void 0?o(m[Q],m[Q+1],m[Q+2],T.materialIndex):o(Q,Q+1,Q+2,T.materialIndex)}else if(m!==void 0)for(w=0;w<m.length;w+=3)o(m[w],m[w+1],m[w+2]);else for(w=0;w<T.length/3;w+=3)o(w,w+1,w+2);return this.computeFaceNormals(),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Mx).negate(),this.translate(Mx.x,Mx.y,Mx.z),this},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,o=this.boundingSphere.radius;o=o===0?1:1/o;var h=new I;return h.set(o,0,0,-o*e.x,0,o,0,-o*e.y,0,0,o,-o*e.z,0,0,0,1),this.applyMatrix4(h),this},computeFaceNormals:function(){for(var e=new _,o=new _,h=0,m=this.faces.length;h<m;h++){var w=this.faces[h],T=this.vertices[w.a],R=this.vertices[w.b];e.subVectors(this.vertices[w.c],R),o.subVectors(T,R),e.cross(o),e.normalize(),w.normal.copy(e)}},computeVertexNormals:function(e){e===void 0&&(e=!0);var o,h=Array(this.vertices.length),m=0;for(o=this.vertices.length;m<o;m++)h[m]=new _;if(e){var w=new _,T=new _;for(e=0,m=this.faces.length;e<m;e++){o=this.faces[e];var R=this.vertices[o.a],z=this.vertices[o.b],k=this.vertices[o.c];w.subVectors(k,z),T.subVectors(R,z),w.cross(T),h[o.a].add(w),h[o.b].add(w),h[o.c].add(w)}}else for(this.computeFaceNormals(),e=0,m=this.faces.length;e<m;e++)o=this.faces[e],h[o.a].add(o.normal),h[o.b].add(o.normal),h[o.c].add(o.normal);for(m=0,o=this.vertices.length;m<o;m++)h[m].normalize();for(e=0,m=this.faces.length;e<m;e++)o=this.faces[e],R=o.vertexNormals,R.length===3?(R[0].copy(h[o.a]),R[1].copy(h[o.b]),R[2].copy(h[o.c])):(R[0]=h[o.a].clone(),R[1]=h[o.b].clone(),R[2]=h[o.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e;this.computeFaceNormals();var o=0;for(e=this.faces.length;o<e;o++){var h=this.faces[o],m=h.vertexNormals;m.length===3?(m[0].copy(h.normal),m[1].copy(h.normal),m[2].copy(h.normal)):(m[0]=h.normal.clone(),m[1]=h.normal.clone(),m[2]=h.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,o,h=0;for(o=this.faces.length;h<o;h++){var m=this.faces[h];m.__originalFaceNormal?m.__originalFaceNormal.copy(m.normal):m.__originalFaceNormal=m.normal.clone(),m.__originalVertexNormals||(m.__originalVertexNormals=[]);var w=0;for(e=m.vertexNormals.length;w<e;w++)m.__originalVertexNormals[w]?m.__originalVertexNormals[w].copy(m.vertexNormals[w]):m.__originalVertexNormals[w]=m.vertexNormals[w].clone()}var T=new pt;for(T.faces=this.faces,w=0,e=this.morphTargets.length;w<e;w++){if(!this.morphNormals[w]){this.morphNormals[w]={},this.morphNormals[w].faceNormals=[],this.morphNormals[w].vertexNormals=[],m=this.morphNormals[w].faceNormals;var R=this.morphNormals[w].vertexNormals;for(h=0,o=this.faces.length;h<o;h++){var z=new _,k={a:new _,b:new _,c:new _};m.push(z),R.push(k)}}for(R=this.morphNormals[w],T.vertices=this.morphTargets[w].vertices,T.computeFaceNormals(),T.computeVertexNormals(),h=0,o=this.faces.length;h<o;h++)m=this.faces[h],z=R.faceNormals[h],k=R.vertexNormals[h],z.copy(m.normal),k.a.copy(m.vertexNormals[0]),k.b.copy(m.vertexNormals[1]),k.c.copy(m.vertexNormals[2])}for(h=0,o=this.faces.length;h<o;h++)m=this.faces[h],m.normal=m.__originalFaceNormal,m.vertexNormals=m.__originalVertexNormals},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new X),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new tt),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,o,h){if(e&&e.isGeometry){var m,w=this.vertices.length,T=this.vertices,R=e.vertices,z=this.faces,k=e.faces,b=this.colors,q=e.colors;h===void 0&&(h=0),o!==void 0&&(m=new c().getNormalMatrix(o));for(var J=0,Q=R.length;J<Q;J++){var K=R[J].clone();o!==void 0&&K.applyMatrix4(o),T.push(K)}for(J=0,Q=q.length;J<Q;J++)b.push(q[J].clone());for(J=0,Q=k.length;J<Q;J++){R=k[J];var rt=R.vertexNormals;for(q=R.vertexColors,b=new Vt(R.a+w,R.b+w,R.c+w),b.normal.copy(R.normal),m!==void 0&&b.normal.applyMatrix3(m).normalize(),o=0,T=rt.length;o<T;o++)K=rt[o].clone(),m!==void 0&&K.applyMatrix3(m).normalize(),b.vertexNormals.push(K);for(b.color.copy(R.color),o=0,T=q.length;o<T;o++)K=q[o],b.vertexColors.push(K.clone());b.materialIndex=R.materialIndex+h,z.push(b)}for(J=0,Q=e.faceVertexUvs.length;J<Q;J++)for(h=e.faceVertexUvs[J],this.faceVertexUvs[J]===void 0&&(this.faceVertexUvs[J]=[]),o=0,T=h.length;o<T;o++){for(m=h[o],w=[],z=0,k=m.length;z<k;z++)w.push(m[z].clone());this.faceVertexUvs[J].push(w)}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e={},o=[],h=[],m=Math.pow(10,4),w,T=0;for(w=this.vertices.length;T<w;T++){var R=this.vertices[T];R=Math.round(R.x*m)+"_"+Math.round(R.y*m)+"_"+Math.round(R.z*m),e[R]===void 0?(e[R]=T,o.push(this.vertices[T]),h[T]=o.length-1):h[T]=h[e[R]]}for(e=[],T=0,w=this.faces.length;T<w;T++)for(m=this.faces[T],m.a=h[m.a],m.b=h[m.b],m.c=h[m.c],m=[m.a,m.b,m.c],R=0;3>R;R++)if(m[R]===m[(R+1)%3]){e.push(T);break}for(T=e.length-1;0<=T;T--)for(m=e[T],this.faces.splice(m,1),h=0,w=this.faceVertexUvs.length;h<w;h++)this.faceVertexUvs[h].splice(m,1);return T=this.vertices.length-o.length,this.vertices=o,T},setFromPoints:function(e){this.vertices=[];for(var o=0,h=e.length;o<h;o++){var m=e[o];this.vertices.push(new _(m.x,m.y,m.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,o=e.length,h=0;h<o;h++)e[h]._id=h;e.sort(function(k,b){return k.materialIndex-b.materialIndex});var m=this.faceVertexUvs[0],w=this.faceVertexUvs[1],T,R;for(m&&m.length===o&&(T=[]),w&&w.length===o&&(R=[]),h=0;h<o;h++){var z=e[h]._id;T&&T.push(m[z]),R&&R.push(w[z])}T&&(this.faceVertexUvs[0]=T),R&&(this.faceVertexUvs[1]=R)},toJSON:function(){function e(le,Wt,Me){return Me?le|1<<Wt:le&~(1<<Wt)}function o(le){var Wt=le.x.toString()+le.y.toString()+le.z.toString();return b[Wt]!==void 0||(b[Wt]=k.length/3,k.push(le.x,le.y,le.z)),b[Wt]}function h(le){var Wt=le.r.toString()+le.g.toString()+le.b.toString();return J[Wt]!==void 0||(J[Wt]=q.length,q.push(le.getHex())),J[Wt]}function m(le){var Wt=le.x.toString()+le.y.toString();return K[Wt]!==void 0||(K[Wt]=Q.length/2,Q.push(le.x,le.y)),K[Wt]}var w={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(w.uuid=this.uuid,w.type=this.type,this.name!==""&&(w.name=this.name),this.parameters!==void 0){var T=this.parameters,R;for(R in T)T[R]!==void 0&&(w[R]=T[R]);return w}for(T=[],R=0;R<this.vertices.length;R++){var z=this.vertices[R];T.push(z.x,z.y,z.z)}z=[];var k=[],b={},q=[],J={},Q=[],K={};for(R=0;R<this.faces.length;R++){var rt=this.faces[R],ht=this.faceVertexUvs[0][R]!==void 0,Ot=0<rt.normal.length(),jt=0<rt.vertexNormals.length,Gt=rt.color.r!==1||rt.color.g!==1||rt.color.b!==1,ee=0<rt.vertexColors.length,Zt=0;Zt=e(Zt,0,0),Zt=e(Zt,1,!0),Zt=e(Zt,2,!1),Zt=e(Zt,3,ht),Zt=e(Zt,4,Ot),Zt=e(Zt,5,jt),Zt=e(Zt,6,Gt),Zt=e(Zt,7,ee),z.push(Zt),z.push(rt.a,rt.b,rt.c),z.push(rt.materialIndex),ht&&(ht=this.faceVertexUvs[0][R],z.push(m(ht[0]),m(ht[1]),m(ht[2]))),Ot&&z.push(o(rt.normal)),jt&&(Ot=rt.vertexNormals,z.push(o(Ot[0]),o(Ot[1]),o(Ot[2]))),Gt&&z.push(h(rt.color)),ee&&(rt=rt.vertexColors,z.push(h(rt[0]),h(rt[1]),h(rt[2])))}return w.data={},w.data.vertices=T,w.data.normals=k,0<q.length&&(w.data.colors=q),0<Q.length&&(w.data.uvs=[Q]),w.data.faces=z,w},clone:function(){return new pt().copy(this)},copy:function(e){var o,h,m;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.name=e.name;var w=e.vertices,T=0;for(o=w.length;T<o;T++)this.vertices.push(w[T].clone());for(w=e.colors,T=0,o=w.length;T<o;T++)this.colors.push(w[T].clone());for(w=e.faces,T=0,o=w.length;T<o;T++)this.faces.push(w[T].clone());for(T=0,o=e.faceVertexUvs.length;T<o;T++){var R=e.faceVertexUvs[T];for(this.faceVertexUvs[T]===void 0&&(this.faceVertexUvs[T]=[]),w=0,h=R.length;w<h;w++){var z=R[w],k=[],b=0;for(m=z.length;b<m;b++)k.push(z[b].clone());this.faceVertexUvs[T].push(k)}}for(b=e.morphTargets,T=0,o=b.length;T<o;T++){if(m={},m.name=b[T].name,b[T].vertices!==void 0)for(m.vertices=[],w=0,h=b[T].vertices.length;w<h;w++)m.vertices.push(b[T].vertices[w].clone());if(b[T].normals!==void 0)for(m.normals=[],w=0,h=b[T].normals.length;w<h;w++)m.normals.push(b[T].normals[w].clone());this.morphTargets.push(m)}for(b=e.morphNormals,T=0,o=b.length;T<o;T++){if(m={},b[T].vertexNormals!==void 0)for(m.vertexNormals=[],w=0,h=b[T].vertexNormals.length;w<h;w++)R=b[T].vertexNormals[w],z={},z.a=R.a.clone(),z.b=R.b.clone(),z.c=R.c.clone(),m.vertexNormals.push(z);if(b[T].faceNormals!==void 0)for(m.faceNormals=[],w=0,h=b[T].faceNormals.length;w<h;w++)m.faceNormals.push(b[T].faceNormals[w].clone());this.morphNormals.push(m)}for(w=e.skinWeights,T=0,o=w.length;T<o;T++)this.skinWeights.push(w[T].clone());for(w=e.skinIndices,T=0,o=w.length;T<o;T++)this.skinIndices.push(w[T].clone());for(w=e.lineDistances,T=0,o=w.length;T<o;T++)this.lineDistances.push(w[T]);return T=e.boundingBox,T!==null&&(this.boundingBox=T.clone()),T=e.boundingSphere,T!==null&&(this.boundingSphere=T.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var ow=function(e){function o(h,m,w,T,R,z){e.call(this),this.type="BoxGeometry",this.parameters={width:h,height:m,depth:w,widthSegments:T,heightSegments:R,depthSegments:z},this.fromBufferGeometry(new P0(h,m,w,T,R,z)),this.mergeVertices()}return e&&(o.__proto__=e),o.prototype=at(e&&e.prototype),o.prototype.constructor=o}(pt),P0=function(e){function o(h,m,w,T,R,z){function k(Ot,jt,Gt,ee,Zt,le,Wt,Me,Fe,fe,Ne){var Oe=le/Fe,vr=Wt/fe,jr=le/2,er=Wt/2,Hr=Me/2;Wt=Fe+1;for(var xi=fe+1,ni=le=0,Bi=new _,Mi=0;Mi<xi;Mi++)for(var ln=Mi*vr-er,Tn=0;Tn<Wt;Tn++)Bi[Ot]=(Tn*Oe-jr)*ee,Bi[jt]=ln*Zt,Bi[Gt]=Hr,J.push(Bi.x,Bi.y,Bi.z),Bi[Ot]=0,Bi[jt]=0,Bi[Gt]=0<Me?1:-1,Q.push(Bi.x,Bi.y,Bi.z),K.push(Tn/Fe),K.push(1-Mi/fe),le+=1;for(Ot=0;Ot<fe;Ot++)for(jt=0;jt<Fe;jt++)Gt=rt+jt+Wt*(Ot+1),ee=rt+(jt+1)+Wt*(Ot+1),Zt=rt+(jt+1)+Wt*Ot,q.push(rt+jt+Wt*Ot,Gt,Zt),q.push(Gt,ee,Zt),ni+=6;b.addGroup(ht,ni,Ne),ht+=ni,rt+=le}e.call(this),this.type="BoxBufferGeometry",this.parameters={width:h,height:m,depth:w,widthSegments:T,heightSegments:R,depthSegments:z};var b=this;h=h||1,m=m||1,w=w||1,T=Math.floor(T)||1,R=Math.floor(R)||1,z=Math.floor(z)||1;var q=[],J=[],Q=[],K=[],rt=0,ht=0;k("z","y","x",-1,-1,w,m,h,z,R,0),k("z","y","x",1,-1,w,m,-h,z,R,1),k("x","z","y",1,1,h,w,m,T,z,2),k("x","z","y",1,-1,h,w,-m,T,z,3),k("x","y","z",1,-1,h,m,w,T,R,4),k("x","y","z",-1,-1,h,m,-w,T,R,5),this.setIndex(q),this.setAttribute("position",new vt(J,3)),this.setAttribute("normal",new vt(Q,3)),this.setAttribute("uv",new vt(K,2))}return e&&(o.__proto__=e),o.prototype=at(e&&e.prototype),o.prototype.constructor=o}(ft),pM={clone:me,merge:Ae};de.prototype=at(Kt.prototype),de.prototype.constructor=de,de.prototype.isShaderMaterial=!0,de.prototype.copy=function(e){return Kt.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=me(e.uniforms),this.defines=ut({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=ut({},e.extensions),this},de.prototype.toJSON=function(e){var o=Kt.prototype.toJSON.call(this,e);o.uniforms={};for(var h in this.uniforms){var m=this.uniforms[h].value;o.uniforms[h]=m&&m.isTexture?{type:"t",value:m.toJSON(e).uuid}:m&&m.isColor?{type:"c",value:m.getHex()}:m&&m.isVector2?{type:"v2",value:m.toArray()}:m&&m.isVector3?{type:"v3",value:m.toArray()}:m&&m.isVector4?{type:"v4",value:m.toArray()}:m&&m.isMatrix3?{type:"m3",value:m.toArray()}:m&&m.isMatrix4?{type:"m4",value:m.toArray()}:{value:m}}0<qi(this.defines).length&&(o.defines=this.defines),o.vertexShader=this.vertexShader,o.fragmentShader=this.fragmentShader,e={};for(var w in this.extensions)this.extensions[w]===!0&&(e[w]=!0);return 0<qi(e).length&&(o.extensions=e),o},ie.prototype=ut(at(F.prototype),{constructor:ie,isCamera:!0,copy:function(e,o){return F.prototype.copy.call(this,e,o),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){e===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new _),this.updateMatrixWorld(!0);var o=this.matrixWorld.elements;return e.set(-o[8],-o[9],-o[10]).normalize()},updateMatrixWorld:function(e){F.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(e,o){F.prototype.updateWorldMatrix.call(this,e,o),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}}),Te.prototype=ut(at(ie.prototype),{constructor:Te,isPerspectiveCamera:!0,copy:function(e,o){return ie.prototype.copy.call(this,e,o),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:ut({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){e=.5*this.getFilmHeight()/e,this.fov=2*Si.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*Si.DEG2RAD*this.fov);return .5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*Si.RAD2DEG*Math.atan(Math.tan(.5*Si.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,o,h,m,w,T){this.aspect=e/o,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=o,this.view.offsetX=h,this.view.offsetY=m,this.view.width=w,this.view.height=T,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,o=e*Math.tan(.5*Si.DEG2RAD*this.fov)/this.zoom,h=2*o,m=this.aspect*h,w=-.5*m,T=this.view;if(this.view!==null&&this.view.enabled){var R=T.fullWidth,z=T.fullHeight;w+=T.offsetX*m/R,o-=T.offsetY*h/z,m*=T.width/R,h*=T.height/z}T=this.filmOffset,T!==0&&(w+=e*T/this.getFilmWidth()),this.projectionMatrix.makePerspective(w,w+m,o,o-h,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){return e=F.prototype.toJSON.call(this,e),e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,this.view!==null&&(e.object.view=ut({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}),mr.prototype=at(F.prototype),mr.prototype.constructor=mr,Nr.prototype=at(A.prototype),Nr.prototype.constructor=Nr,Nr.prototype.isWebGLCubeRenderTarget=!0,Nr.prototype.fromEquirectangularTexture=function(e,o){this.texture.type=o.type,this.texture.format=o.format,this.texture.encoding=o.encoding;var h=new W,m=new de({type:"CubemapFromEquirect",uniforms:me({tEquirect:{value:null}}),vertexShader:`varying vec3 vWorldDirection;
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,fragmentShader:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
}`,side:1,blending:0});return m.uniforms.tEquirect.value=o,o=new Tt(new P0(5,5,5),m),h.add(o),new mr(1,10,this).update(e,h),o.geometry.dispose(),o.material.dispose(),this},we.prototype=at(g.prototype),we.prototype.constructor=we,we.prototype.isDataTexture=!0;var gm=new tt,Cx=new _;ut(nr.prototype,{set:function(e,o,h,m,w,T){var R=this.planes;return R[0].copy(e),R[1].copy(o),R[2].copy(h),R[3].copy(m),R[4].copy(w),R[5].copy(T),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){for(var o=this.planes,h=0;6>h;h++)o[h].copy(e.planes[h]);return this},setFromProjectionMatrix:function(e){var o=this.planes,h=e.elements;e=h[0];var m=h[1],w=h[2],T=h[3],R=h[4],z=h[5],k=h[6],b=h[7],q=h[8],J=h[9],Q=h[10],K=h[11],rt=h[12],ht=h[13],Ot=h[14];return h=h[15],o[0].setComponents(T-e,b-R,K-q,h-rt).normalize(),o[1].setComponents(T+e,b+R,K+q,h+rt).normalize(),o[2].setComponents(T+m,b+z,K+J,h+ht).normalize(),o[3].setComponents(T-m,b-z,K-J,h-ht).normalize(),o[4].setComponents(T-w,b-k,K-Q,h-Ot).normalize(),o[5].setComponents(T+w,b+k,K+Q,h+Ot).normalize(),this},intersectsObject:function(e){var o=e.geometry;return o.boundingSphere===null&&o.computeBoundingSphere(),gm.copy(o.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(gm)},intersectsSprite:function(e){return gm.center.set(0,0,0),gm.radius=.7071067811865476,gm.applyMatrix4(e.matrixWorld),this.intersectsSphere(gm)},intersectsSphere:function(e){var o=this.planes,h=e.center;e=-e.radius;for(var m=0;6>m;m++)if(o[m].distanceToPoint(h)<e)return!1;return!0},intersectsBox:function(e){for(var o=this.planes,h=0;6>h;h++){var m=o[h];if(Cx.x=0<m.normal.x?e.max.x:e.min.x,Cx.y=0<m.normal.y?e.max.y:e.min.y,Cx.z=0<m.normal.z?e.max.z:e.min.z,0>m.distanceToPoint(Cx))return!1}return!0},containsPoint:function(e){for(var o=this.planes,h=0;6>h;h++)if(0>o[h].distanceToPoint(e))return!1;return!0}});var cr={common:{diffuse:{value:new yt(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new c},uv2Transform:{value:new c},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new f(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new yt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new yt(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new c}},sprite:{diffuse:{value:new yt(15658734)},opacity:{value:1},center:{value:new f(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new c}}};$n.prototype=at(pt.prototype),$n.prototype.constructor=$n,Oi.prototype=at(ft.prototype),Oi.prototype.constructor=Oi;var Hi={alphamap_fragment:`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,alphamap_pars_fragment:`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment:`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,aomap_fragment:`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,aomap_pars_fragment:`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs:`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE  = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS  = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha  = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,bumpmap_pars_fragment:`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment:`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex:`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment:`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment:`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,color_pars_vertex:`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,color_vertex:`#ifdef USE_COLOR
	vColor.xyz = color.xyz;
#endif`,common:`#define PI 3.14159265359
#define PI2 6.28318530718
#define PI_HALF 1.5707963267949
#define RECIPROCAL_PI 0.31830988618
#define RECIPROCAL_PI2 0.15915494
#define LOG2 1.442695
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
  return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,cube_uv_reflection_fragment:`#ifdef ENVMAP_TYPE_CUBE_UV
#define cubeUV_maxMipLevel 8.0
#define cubeUV_minMipLevel 4.0
#define cubeUV_maxTileSize 256.0
#define cubeUV_minTileSize 16.0
float getFace(vec3 direction) {
    vec3 absDirection = abs(direction);
    float face = -1.0;
    if (absDirection.x > absDirection.z) {
      if (absDirection.x > absDirection.y)
        face = direction.x > 0.0 ? 0.0 : 3.0;
      else
        face = direction.y > 0.0 ? 1.0 : 4.0;
    } else {
      if (absDirection.z > absDirection.y)
        face = direction.z > 0.0 ? 2.0 : 5.0;
      else
        face = direction.y > 0.0 ? 1.0 : 4.0;
    }
    return face;
}
vec2 getUV(vec3 direction, float face) {
    vec2 uv;
    if (face == 0.0) {
      uv = vec2(direction.z, direction.y) / abs(direction.x);    } else if (face == 1.0) {
      uv = vec2(-direction.x, -direction.z) / abs(direction.y);    } else if (face == 2.0) {
      uv = vec2(-direction.x, direction.y) / abs(direction.z);    } else if (face == 3.0) {
      uv = vec2(-direction.z, direction.y) / abs(direction.x);    } else if (face == 4.0) {
      uv = vec2(-direction.x, direction.z) / abs(direction.y);    } else {
      uv = vec2(direction.x, direction.y) / abs(direction.z);    }
    return 0.5 * (uv + 1.0);
}
vec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
  float face = getFace(direction);
  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
  mipInt = max(mipInt, cubeUV_minMipLevel);
  float faceSize = exp2(mipInt);
  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
  vec2 uv = getUV(direction, face) * (faceSize - 1.0);
  vec2 f = fract(uv);
  uv += 0.5 - f;
  if (face > 2.0) {
    uv.y += faceSize;
    face -= 3.0;
  }
  uv.x += face * faceSize;
  if(mipInt < cubeUV_maxMipLevel){
    uv.y += 2.0 * cubeUV_maxTileSize;
  }
  uv.y += filterInt * 2.0 * cubeUV_minTileSize;
  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
  uv *= texelSize;
  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.x += texelSize;
  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.y += texelSize;
  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.x -= texelSize;
  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  vec3 tm = mix(tl, tr, f.x);
  vec3 bm = mix(bl, br, f.x);
  return mix(tm, bm, f.y);
}
#define r0 1.0
#define v0 0.339
#define m0 -2.0
#define r1 0.8
#define v1 0.276
#define m1 -1.0
#define r4 0.4
#define v4 0.046
#define m4 2.0
#define r5 0.305
#define v5 0.016
#define m5 3.0
#define r6 0.21
#define v6 0.0038
#define m6 4.0
float roughnessToMip(float roughness) {
  float mip = 0.0;
  if (roughness >= r1) {
    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
  } else if (roughness >= r4) {
    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
  } else if (roughness >= r5) {
    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
  } else if (roughness >= r6) {
    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
  } else {
    mip = -2.0 * log2(1.16 * roughness);  }
  return mip;
}
vec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {
  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);
  float mipF = fract(mip);
  float mipInt = floor(mip);
  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);
  if (mipF == 0.0) {
    return vec4(color0, 1.0);
  } else {
    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);
    return vec4(mix(color0, color1, mipF), 1.0);
  }
}
#endif`,defaultnormal_vertex:`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex:`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex:`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment:`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment:`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value )  {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,envmap_fragment:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		}  else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#elif defined( ENVMAP_TYPE_EQUIREC )
		reflectVec = normalize( reflectVec );
		vec2 sampleUV = equirectUv( reflectVec );
		vec4 envColor = texture2D( envMap, sampleUV );
	#elif defined( ENVMAP_TYPE_SPHERE )
		reflectVec = normalize( reflectVec );
		vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );
		vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment:`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment:`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex:`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_physical_pars_fragment:`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
		  vec3 reflectVec = reflect( -viewDir, normal );
		  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
		  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#elif defined( ENVMAP_TYPE_EQUIREC )
			vec2 sampleUV = equirectUv( reflectVec );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_SPHERE )
			vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,envmap_vertex:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) { 
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex:`#ifdef USE_FOG
	fogDepth = -mvPosition.z;
#endif`,fog_pars_vertex:`#ifdef USE_FOG
	varying float fogDepth;
#endif`,fog_fragment:`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment:`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment:`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,lightmap_fragment:`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,lightmap_pars_fragment:`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_vertex:`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,lights_pars_begin:`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
		struct PointLightShadow {
			float shadowBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,lights_toon_fragment:`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_toon_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,lights_phong_fragment:`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,lights_physical_fragment:`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,lights_physical_pars_fragment:`struct PhysicalMaterial {
	vec3	diffuseColor;
	float	specularRoughness;
	vec3	specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin:`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps:`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,lights_fragment_end:`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment:`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,map_pars_fragment:`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment:`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment:`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphnormal_vertex:`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,morphtarget_pars_vertex:`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
	uniform float morphTargetInfluences[ 8 ];
	#else
	uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,morphtarget_vertex:`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
	transformed += morphTarget4 * morphTargetInfluences[ 4 ];
	transformed += morphTarget5 * morphTargetInfluences[ 5 ];
	transformed += morphTarget6 * morphTargetInfluences[ 6 ];
	transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,normal_fragment_begin:`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps:`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif`,normalmap_pars_fragment:`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		float scale = sign( st1.t * st0.s - st0.t * st1.s );
		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
		vec3 N = normalize( surf_norm );
		mat3 tsn = mat3( S, T, N );
		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		return normalize( tsn * mapN );
	}
#endif`,clearcoat_normal_fragment_begin:`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps:`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );
	#endif
#endif`,clearcoat_pars_fragment:`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,packing:`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,premultiplied_alpha_fragment:`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex:`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment:`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment:`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment:`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment:`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,shadowmask_pars_fragment:`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex:`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex:`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,skinning_vertex:`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex:`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment:`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment:`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment:`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment:`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
uniform float toneMappingWhitePoint;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )
vec3 Uncharted2ToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );
}`,uv_pars_fragment:`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,uv_pars_vertex:`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,uv_vertex:`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,uv2_pars_fragment:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,uv2_pars_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,uv2_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,worldpos_vertex:`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,background_frag:`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,cube_frag:`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSPARENCY
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSPARENCY
	uniform float transparency;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSPARENCY
		diffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,normal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,normal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,shadow_vert:`#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`},$l={basic:{uniforms:Ae([cr.common,cr.specularmap,cr.envmap,cr.aomap,cr.lightmap,cr.fog]),vertexShader:Hi.meshbasic_vert,fragmentShader:Hi.meshbasic_frag},lambert:{uniforms:Ae([cr.common,cr.specularmap,cr.envmap,cr.aomap,cr.lightmap,cr.emissivemap,cr.fog,cr.lights,{emissive:{value:new yt(0)}}]),vertexShader:Hi.meshlambert_vert,fragmentShader:Hi.meshlambert_frag},phong:{uniforms:Ae([cr.common,cr.specularmap,cr.envmap,cr.aomap,cr.lightmap,cr.emissivemap,cr.bumpmap,cr.normalmap,cr.displacementmap,cr.fog,cr.lights,{emissive:{value:new yt(0)},specular:{value:new yt(1118481)},shininess:{value:30}}]),vertexShader:Hi.meshphong_vert,fragmentShader:Hi.meshphong_frag},standard:{uniforms:Ae([cr.common,cr.envmap,cr.aomap,cr.lightmap,cr.emissivemap,cr.bumpmap,cr.normalmap,cr.displacementmap,cr.roughnessmap,cr.metalnessmap,cr.fog,cr.lights,{emissive:{value:new yt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Hi.meshphysical_vert,fragmentShader:Hi.meshphysical_frag},toon:{uniforms:Ae([cr.common,cr.specularmap,cr.aomap,cr.lightmap,cr.emissivemap,cr.bumpmap,cr.normalmap,cr.displacementmap,cr.gradientmap,cr.fog,cr.lights,{emissive:{value:new yt(0)},specular:{value:new yt(1118481)},shininess:{value:30}}]),vertexShader:Hi.meshtoon_vert,fragmentShader:Hi.meshtoon_frag},matcap:{uniforms:Ae([cr.common,cr.bumpmap,cr.normalmap,cr.displacementmap,cr.fog,{matcap:{value:null}}]),vertexShader:Hi.meshmatcap_vert,fragmentShader:Hi.meshmatcap_frag},points:{uniforms:Ae([cr.points,cr.fog]),vertexShader:Hi.points_vert,fragmentShader:Hi.points_frag},dashed:{uniforms:Ae([cr.common,cr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Hi.linedashed_vert,fragmentShader:Hi.linedashed_frag},depth:{uniforms:Ae([cr.common,cr.displacementmap]),vertexShader:Hi.depth_vert,fragmentShader:Hi.depth_frag},normal:{uniforms:Ae([cr.common,cr.bumpmap,cr.normalmap,cr.displacementmap,{opacity:{value:1}}]),vertexShader:Hi.normal_vert,fragmentShader:Hi.normal_frag},sprite:{uniforms:Ae([cr.sprite,cr.fog]),vertexShader:Hi.sprite_vert,fragmentShader:Hi.sprite_frag},background:{uniforms:{uvTransform:{value:new c},t2D:{value:null}},vertexShader:Hi.background_vert,fragmentShader:Hi.background_frag},cube:{uniforms:Ae([cr.envmap,{opacity:{value:1}}]),vertexShader:Hi.cube_vert,fragmentShader:Hi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Hi.equirect_vert,fragmentShader:Hi.equirect_frag},distanceRGBA:{uniforms:Ae([cr.common,cr.displacementmap,{referencePosition:{value:new _},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Hi.distanceRGBA_vert,fragmentShader:Hi.distanceRGBA_frag},shadow:{uniforms:Ae([cr.lights,cr.fog,{color:{value:new yt(0)},opacity:{value:1}}]),vertexShader:Hi.shadow_vert,fragmentShader:Hi.shadow_frag}};$l.physical={uniforms:Ae([$l.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new f(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new yt(0)},transparency:{value:0}}]),vertexShader:Hi.meshphysical_vert,fragmentShader:Hi.meshphysical_frag},mu.prototype=at(g.prototype),mu.prototype.constructor=mu,mu.prototype.isCubeTexture=!0,Object.defineProperty(mu.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}}),Bs.prototype=at(g.prototype),Bs.prototype.constructor=Bs,Bs.prototype.isDataTexture2DArray=!0,ea.prototype=at(g.prototype),ea.prototype.constructor=ea,ea.prototype.isDataTexture3D=!0;var dM=new g,iT=new Bs,nT=new ea,gM=new mu,mM=[],vM=[],yM=new Float32Array(16),xM=new Float32Array(9),AM=new Float32Array(4);w_.prototype.updateCache=function(e){var o=this.cache;e instanceof Float32Array&&o.length!==e.length&&(this.cache=new Float32Array(e.length)),cs(o,e)},__.prototype.setValue=function(e,o,h){for(var m=this.seq,w=0,T=m.length;w!==T;++w){var R=m[w];R.setValue(e,o[R.id],h)}};var sw=/([\w\d_]+)(\])?(\[|\.)?/g;tf.prototype.setValue=function(e,o,h,m){o=this.map[o],o!==void 0&&o.setValue(e,h,m)},tf.prototype.setOptional=function(e,o,h){o=o[h],o!==void 0&&this.setValue(e,h,o)},tf.upload=function(e,o,h,m){for(var w=0,T=o.length;w!==T;++w){var R=o[w],z=h[R.id];z.needsUpdate!==!1&&R.setValue(e,z.value,m)}},tf.seqWithValue=function(e,o){for(var h=[],m=0,w=e.length;m!==w;++m){var T=e[m];T.id in o&&h.push(T)}return h};var oT=0,aw=/^[ \t]*#include +<([\w\d./]+)>/gm,wM=/#pragma unroll_loop[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}/g,_M=/#pragma unroll_loop_start[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}[\s]+?#pragma unroll_loop_end/g,sT=0;ef.prototype=at(Kt.prototype),ef.prototype.constructor=ef,ef.prototype.isMeshDepthMaterial=!0,ef.prototype.copy=function(e){return Kt.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},rf.prototype=at(Kt.prototype),rf.prototype.constructor=rf,rf.prototype.isMeshDistanceMaterial=!0,rf.prototype.copy=function(e){return Kt.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},Ey.prototype=ut(at(Te.prototype),{constructor:Ey,isArrayCamera:!0}),Pg.prototype=ut(at(F.prototype),{constructor:Pg,isGroup:!0}),ut(Ly.prototype,{constructor:Ly,getTargetRaySpace:function(){return this._targetRay===null&&(this._targetRay=new Pg,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return this._grip===null&&(this._grip=new Pg,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this},disconnect:function(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this},update:function(e,o,h){var m=null,w=null,T=this._targetRay,R=this._grip;return e&&(T!==null&&(m=o.getPose(e.targetRaySpace,h),m!==null&&(T.matrix.fromArray(m.transform.matrix),T.matrix.decompose(T.position,T.rotation,T.scale))),R!==null&&e.gripSpace&&(w=o.getPose(e.gripSpace,h),w!==null&&(R.matrix.fromArray(w.transform.matrix),R.matrix.decompose(R.position,R.rotation,R.scale)))),T!==null&&(T.visible=m!==null),R!==null&&(R.visible=w!==null),this}}),ut(F_.prototype,s.prototype),ut(Ry.prototype,{isFogExp2:!0,clone:function(){return new Ry(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),ut(Py.prototype,{isFog:!0,clone:function(){return new Py(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(Yh.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),ut(Yh.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,o,h){e*=this.stride,h*=o.stride;for(var m=0,w=this.stride;m<w;m++)this.array[e+m]=o.array[h+m];return this},set:function(e,o){return o===void 0&&(o=0),this.array.set(e,o),this},clone:function(){return new this.constructor().copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}});var Yp=new _;Xr(jv.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),ut(jv.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(var o=0,h=this.data.count;o<h;o++)Yp.x=this.getX(o),Yp.y=this.getY(o),Yp.z=this.getZ(o),Yp.applyMatrix4(e),this.setXYZ(o,Yp.x,Yp.y,Yp.z);return this},setX:function(e,o){return this.data.array[e*this.data.stride+this.offset]=o,this},setY:function(e,o){return this.data.array[e*this.data.stride+this.offset+1]=o,this},setZ:function(e,o){return this.data.array[e*this.data.stride+this.offset+2]=o,this},setW:function(e,o){return this.data.array[e*this.data.stride+this.offset+3]=o,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,o,h){return e=e*this.data.stride+this.offset,this.data.array[e+0]=o,this.data.array[e+1]=h,this},setXYZ:function(e,o,h,m){return e=e*this.data.stride+this.offset,this.data.array[e+0]=o,this.data.array[e+1]=h,this.data.array[e+2]=m,this},setXYZW:function(e,o,h,m,w){return e=e*this.data.stride+this.offset,this.data.array[e+0]=o,this.data.array[e+1]=h,this.data.array[e+2]=m,this.data.array[e+3]=w,this},clone:function(){for(var e=[],o=0;o<this.count;o++)for(var h=o*this.data.stride+this.offset,m=0;m<this.itemSize;m++)e.push(this.data.array[h+m]);return new ae(new this.array.constructor(e),this.itemSize,this.normalized)},toJSON:function(){for(var e=[],o=0;o<this.count;o++)for(var h=o*this.data.stride+this.offset,m=0;m<this.itemSize;m++)e.push(this.data.array[h+m]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}}),nf.prototype=at(Kt.prototype),nf.prototype.constructor=nf,nf.prototype.isSpriteMaterial=!0,nf.prototype.copy=function(e){return Kt.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this};var mm,D0=new _,vm=new _,ym=new _,xm=new f,O0=new f,MM=new I,Tx=new _,F0=new _,Sx=new _,CM=new f,uw=new f,TM=new f;Xv.prototype=ut(at(F.prototype),{constructor:Xv,isSprite:!0,raycast:function(e,o){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),vm.setFromMatrixScale(this.matrixWorld),MM.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),ym.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&vm.multiplyScalar(-ym.z);var h=this.material.rotation;if(h!==0)var m=Math.cos(h),w=Math.sin(h);h=this.center,Dy(Tx.set(-.5,-.5,0),ym,h,vm,w,m),Dy(F0.set(.5,-.5,0),ym,h,vm,w,m),Dy(Sx.set(.5,.5,0),ym,h,vm,w,m),CM.set(0,0),uw.set(1,0),TM.set(1,1);var T=e.ray.intersectTriangle(Tx,F0,Sx,!1,D0);T===null&&(Dy(F0.set(-.5,.5,0),ym,h,vm,w,m),uw.set(0,1),T=e.ray.intersectTriangle(Tx,Sx,F0,!1,D0),T===null)||(w=e.ray.origin.distanceTo(D0),w<e.near||w>e.far||o.push({distance:w,point:D0.clone(),uv:At.getUV(D0,Tx,F0,Sx,CM,uw,TM,new f),face:null,object:this}))},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return F.prototype.copy.call(this,e),e.center!==void 0&&this.center.copy(e.center),this}});var Ix=new _,SM=new _;Yv.prototype=ut(at(F.prototype),{constructor:Yv,isLOD:!0,copy:function(e){F.prototype.copy.call(this,e,!1);for(var o=e.levels,h=0,m=o.length;h<m;h++){var w=o[h];this.addLevel(w.object.clone(),w.distance)}return this.autoUpdate=e.autoUpdate,this},addLevel:function(e,o){o===void 0&&(o=0),o=Math.abs(o);for(var h=this.levels,m=0;m<h.length&&!(o<h[m].distance);m++);return h.splice(m,0,{distance:o,object:e}),this.add(e),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(e){var o=this.levels;if(0<o.length){for(var h=1,m=o.length;h<m&&!(e<o[h].distance);h++);return o[h-1].object}return null},raycast:function(e,o){if(0<this.levels.length){Ix.setFromMatrixPosition(this.matrixWorld);var h=e.ray.origin.distanceTo(Ix);this.getObjectForDistance(h).raycast(e,o)}},update:function(e){var o=this.levels;if(1<o.length){Ix.setFromMatrixPosition(e.matrixWorld),SM.setFromMatrixPosition(this.matrixWorld),e=Ix.distanceTo(SM)/e.zoom,o[0].object.visible=!0;for(var h=1,m=o.length;h<m&&e>=o[h].distance;h++)o[h-1].object.visible=!1,o[h].object.visible=!0;for(this._currentLevel=h-1;h<m;h++)o[h].object.visible=!1}},toJSON:function(e){e=F.prototype.toJSON.call(this,e),this.autoUpdate===!1&&(e.object.autoUpdate=!1),e.object.levels=[];for(var o=this.levels,h=0,m=o.length;h<m;h++){var w=o[h];e.object.levels.push({object:w.object.uuid,distance:w.distance})}return e}}),Oy.prototype=ut(at(Tt.prototype),{constructor:Oy,isSkinnedMesh:!0,bind:function(e,o){this.skeleton=e,o===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),o=this.matrixWorld),this.bindMatrix.copy(o),this.bindMatrixInverse.getInverse(o)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new p,o=this.geometry.attributes.skinWeight,h=0,m=o.count;h<m;h++){e.x=o.getX(h),e.y=o.getY(h),e.z=o.getZ(h),e.w=o.getW(h);var w=1/e.manhattanLength();w!==Infinity?e.multiplyScalar(w):e.set(1,0,0,0),o.setXYZW(h,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){Tt.prototype.updateMatrixWorld.call(this,e),this.bindMode==="attached"?this.bindMatrixInverse.getInverse(this.matrixWorld):this.bindMode==="detached"?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)},boneTransform:function(){var e=new _,o=new p,h=new p,m=new _,w=new I;return function(T,R){var z=this.skeleton,k=this.geometry;for(o.fromBufferAttribute(k.attributes.skinIndex,T),h.fromBufferAttribute(k.attributes.skinWeight,T),e.fromBufferAttribute(k.attributes.position,T).applyMatrix4(this.bindMatrix),R.set(0,0,0),T=0;4>T;T++)if(k=h.getComponent(T),k!==0){var b=o.getComponent(T);w.multiplyMatrices(z.bones[b].matrixWorld,z.boneInverses[b]),R.addScaledVector(m.copy(e).applyMatrix4(w),k)}return R.applyMatrix4(this.bindMatrixInverse)}}()});var IM=new I,aT=new I;ut(Fy.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,o=this.bones.length;e<o;e++){var h=new I;this.bones[e]&&h.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(h)}},pose:function(){var e,o,h=0;for(o=this.bones.length;h<o;h++)(e=this.bones[h])&&e.matrixWorld.getInverse(this.boneInverses[h]);for(h=0,o=this.bones.length;h<o;h++)(e=this.bones[h])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:function(){for(var e=this.bones,o=this.boneInverses,h=this.boneMatrices,m=this.boneTexture,w=0,T=e.length;w<T;w++)IM.multiplyMatrices(e[w]?e[w].matrixWorld:aT,o[w]),IM.toArray(h,16*w);m!==void 0&&(m.needsUpdate=!0)},clone:function(){return new Fy(this.bones,this.boneInverses)},getBoneByName:function(e){for(var o=0,h=this.bones.length;o<h;o++){var m=this.bones[o];if(m.name===e)return m}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),c2.prototype=ut(at(F.prototype),{constructor:c2,isBone:!0});var EM=new I,LM=new I,Ex=[],B0=new Tt;By.prototype=ut(at(Tt.prototype),{constructor:By,isInstancedMesh:!0,getMatrixAt:function(e,o){o.fromArray(this.instanceMatrix.array,16*e)},raycast:function(e,o){var h=this.matrixWorld,m=this.count;if(B0.geometry=this.geometry,B0.material=this.material,B0.material!==void 0)for(var w=0;w<m;w++){this.getMatrixAt(w,EM),LM.multiplyMatrices(h,EM),B0.matrixWorld=LM,B0.raycast(e,Ex);for(var T=0,R=Ex.length;T<R;T++){var z=Ex[T];z.instanceId=w,z.object=this,o.push(z)}Ex.length=0}},setMatrixAt:function(e,o){o.toArray(this.instanceMatrix.array,16*e)},updateMorphTargets:function(){}}),to.prototype=at(Kt.prototype),to.prototype.constructor=to,to.prototype.isLineBasicMaterial=!0,to.prototype.copy=function(e){return Kt.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.morphTargets=e.morphTargets,this};var RM=new _,PM=new _,DM=new I,Lx=new ot,Rx=new tt;ja.prototype=ut(at(F.prototype),{constructor:ja,isLine:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(e.index===null){for(var o=e.attributes.position,h=[0],m=1,w=o.count;m<w;m++)RM.fromBufferAttribute(o,m-1),PM.fromBufferAttribute(o,m),h[m]=h[m-1],h[m]+=RM.distanceTo(PM);e.setAttribute("lineDistance",new vt(h,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry)for(o=e.vertices,h=e.lineDistances,h[0]=0,m=1,w=o.length;m<w;m++)h[m]=h[m-1],h[m]+=o[m-1].distanceTo(o[m]);return this},raycast:function(e,o){var h=this.geometry,m=this.matrixWorld,w=e.params.Line.threshold;if(h.boundingSphere===null&&h.computeBoundingSphere(),Rx.copy(h.boundingSphere),Rx.applyMatrix4(m),Rx.radius+=w,e.ray.intersectsSphere(Rx)!==!1){DM.getInverse(m),Lx.copy(e.ray).applyMatrix4(DM),m=w/((this.scale.x+this.scale.y+this.scale.z)/3),m*=m;var T=new _,R=new _;w=new _;var z=new _,k=this&&this.isLineSegments?2:1;if(h.isBufferGeometry){var b=h.index,q=h.attributes.position.array;if(b!==null){b=b.array,h=0;for(var J=b.length-1;h<J;h+=k){var Q=b[h+1];T.fromArray(q,3*b[h]),R.fromArray(q,3*Q),Q=Lx.distanceSqToSegment(T,R,z,w),Q>m||(z.applyMatrix4(this.matrixWorld),Q=e.ray.origin.distanceTo(z),Q<e.near||Q>e.far||o.push({distance:Q,point:w.clone().applyMatrix4(this.matrixWorld),index:h,face:null,faceIndex:null,object:this}))}}else for(h=0,J=q.length/3-1;h<J;h+=k)T.fromArray(q,3*h),R.fromArray(q,3*h+3),Q=Lx.distanceSqToSegment(T,R,z,w),Q>m||(z.applyMatrix4(this.matrixWorld),Q=e.ray.origin.distanceTo(z),Q<e.near||Q>e.far||o.push({distance:Q,point:w.clone().applyMatrix4(this.matrixWorld),index:h,face:null,faceIndex:null,object:this}))}else if(h.isGeometry)for(T=h.vertices,R=T.length,h=0;h<R-1;h+=k)Q=Lx.distanceSqToSegment(T[h],T[h+1],z,w),Q>m||(z.applyMatrix4(this.matrixWorld),Q=e.ray.origin.distanceTo(z),Q<e.near||Q>e.far||o.push({distance:Q,point:w.clone().applyMatrix4(this.matrixWorld),index:h,face:null,faceIndex:null,object:this}))}},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){e=e.morphAttributes;var o=qi(e);if(0<o.length){var h=e[o[0]];if(h!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,o=h.length;e<o;e++){var m=h[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[m]=e}}}else e=e.morphTargets,e!==void 0&&0<e.length&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Px=new _,Dx=new _;lo.prototype=ut(at(ja.prototype),{constructor:lo,isLineSegments:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(e.index===null){for(var o=e.attributes.position,h=[],m=0,w=o.count;m<w;m+=2)Px.fromBufferAttribute(o,m),Dx.fromBufferAttribute(o,m+1),h[m]=m===0?0:h[m-1],h[m+1]=h[m]+Px.distanceTo(Dx);e.setAttribute("lineDistance",new vt(h,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry)for(o=e.vertices,h=e.lineDistances,m=0,w=o.length;m<w;m+=2)Px.copy(o[m]),Dx.copy(o[m+1]),h[m]=m===0?0:h[m-1],h[m+1]=h[m]+Px.distanceTo(Dx);return this}}),Ny.prototype=ut(at(ja.prototype),{constructor:Ny,isLineLoop:!0}),Zu.prototype=at(Kt.prototype),Zu.prototype.constructor=Zu,Zu.prototype.isPointsMaterial=!0,Zu.prototype.copy=function(e){return Kt.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this};var OM=new I,lw=new ot,Ox=new tt,Fx=new _;Dg.prototype=ut(at(F.prototype),{constructor:Dg,isPoints:!0,raycast:function(e,o){var h=this.geometry,m=this.matrixWorld,w=e.params.Points.threshold;if(h.boundingSphere===null&&h.computeBoundingSphere(),Ox.copy(h.boundingSphere),Ox.applyMatrix4(m),Ox.radius+=w,e.ray.intersectsSphere(Ox)!==!1)if(OM.getInverse(m),lw.copy(e.ray).applyMatrix4(OM),w/=(this.scale.x+this.scale.y+this.scale.z)/3,w*=w,h.isBufferGeometry){var T=h.index;if(h=h.attributes.position.array,T!==null){var R=T.array;T=0;for(var z=R.length;T<z;T++){var k=R[T];Fx.fromArray(h,3*k),f2(Fx,k,w,m,e,o,this)}}else for(T=0,R=h.length/3;T<R;T++)Fx.fromArray(h,3*T),f2(Fx,T,w,m,e,o,this)}else for(h=h.vertices,T=0,R=h.length;T<R;T++)f2(h[T],T,w,m,e,o,this)},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){e=e.morphAttributes;var o=qi(e);if(0<o.length){var h=e[o[0]];if(h!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,o=h.length;e<o;e++){var m=h[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[m]=e}}}else e=e.morphTargets,e!==void 0&&0<e.length&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),p2.prototype=ut(at(g.prototype),{constructor:p2,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Og.prototype=at(g.prototype),Og.prototype.constructor=Og,Og.prototype.isCompressedTexture=!0,Zv.prototype=at(g.prototype),Zv.prototype.constructor=Zv,Zv.prototype.isCanvasTexture=!0,Jv.prototype=at(g.prototype),Jv.prototype.constructor=Jv,Jv.prototype.isDepthTexture=!0,Fg.prototype=at(ft.prototype),Fg.prototype.constructor=Fg,qv.prototype=at(pt.prototype),qv.prototype.constructor=qv,Bg.prototype=at(ft.prototype),Bg.prototype.constructor=Bg,Kv.prototype=at(pt.prototype),Kv.prototype.constructor=Kv,wa.prototype=at(ft.prototype),wa.prototype.constructor=wa,Qv.prototype=at(pt.prototype),Qv.prototype.constructor=Qv,Ng.prototype=at(wa.prototype),Ng.prototype.constructor=Ng,$v.prototype=at(pt.prototype),$v.prototype.constructor=$v,Lp.prototype=at(wa.prototype),Lp.prototype.constructor=Lp,t0.prototype=at(pt.prototype),t0.prototype.constructor=t0,zg.prototype=at(wa.prototype),zg.prototype.constructor=zg,e0.prototype=at(pt.prototype),e0.prototype.constructor=e0,Ug.prototype=at(wa.prototype),Ug.prototype.constructor=Ug,r0.prototype=at(pt.prototype),r0.prototype.constructor=r0,Rp.prototype=at(ft.prototype),Rp.prototype.constructor=Rp,Rp.prototype.toJSON=function(){var e=ft.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e},i0.prototype=at(pt.prototype),i0.prototype.constructor=i0,Hg.prototype=at(ft.prototype),Hg.prototype.constructor=Hg,n0.prototype=at(pt.prototype),n0.prototype.constructor=n0,kg.prototype=at(ft.prototype),kg.prototype.constructor=kg;var uT={triangulate:function(e,o,h){h=h||2;var m=o&&o.length,w=m?o[0]*h:e.length,T=B_(e,0,w,h,!0),R=[];if(!T||T.next===T.prev)return R;var z;if(m){var k=h;m=[];var b,q=0;for(b=o.length;q<b;q++){var J=o[q]*k,Q=q<b-1?o[q+1]*k:e.length;J=B_(e,J,Q,k,!1),J===J.next&&(J.steiner=!0),m.push(k3(J))}for(m.sort(U3),q=0;q<m.length;q++)k=m[q],o=T,(o=H3(k,o))&&(k=z_(o,k),of(o,o.next),of(k,k.next)),T=of(T,T.next)}if(e.length>80*h){var K=z=e[0],rt=m=e[1];for(k=h;k<w;k+=h)q=e[k],o=e[k+1],q<K&&(K=q),o<rt&&(rt=o),q>z&&(z=q),o>m&&(m=o);z=Math.max(z-K,m-rt),z=z!==0?1/z:0}return o0(T,R,h,K,rt,z),R}},nc={area:function(e){for(var o=e.length,h=0,m=o-1,w=0;w<o;m=w++)h+=e[m].x*e[w].y-e[w].x*e[m].y;return .5*h},isClockWise:function(e){return 0>nc.area(e)},triangulateShape:function(e,o){var h=[],m=[],w=[];H_(e),k_(h,e);var T=e.length;for(o.forEach(H_),e=0;e<o.length;e++)m.push(T),T+=o[e].length,k_(h,o[e]);for(o=uT.triangulate(h,m),e=0;e<o.length;e+=3)w.push(o.slice(e,e+3));return w}};Pp.prototype=at(pt.prototype),Pp.prototype.constructor=Pp,Pp.prototype.toJSON=function(){var e=pt.prototype.toJSON.call(this);return G_(this.parameters.shapes,this.parameters.options,e)},Xl.prototype=at(ft.prototype),Xl.prototype.constructor=Xl,Xl.prototype.toJSON=function(){var e=ft.prototype.toJSON.call(this);return G_(this.parameters.shapes,this.parameters.options,e)};var lT={generateTopUV:function(e,o,h,m,w){e=o[3*m],m=o[3*m+1];var T=o[3*w];return w=o[3*w+1],[new f(o[3*h],o[3*h+1]),new f(e,m),new f(T,w)]},generateSideWallUV:function(e,o,h,m,w,T){e=o[3*h];var R=o[3*h+1];h=o[3*h+2];var z=o[3*m],k=o[3*m+1];m=o[3*m+2];var b=o[3*w],q=o[3*w+1];w=o[3*w+2];var J=o[3*T],Q=o[3*T+1];return o=o[3*T+2],.01>Math.abs(R-k)?[new f(e,1-h),new f(z,1-m),new f(b,1-w),new f(J,1-o)]:[new f(R,1-h),new f(k,1-m),new f(q,1-w),new f(Q,1-o)]}};u0.prototype=at(pt.prototype),u0.prototype.constructor=u0,bg.prototype=at(Xl.prototype),bg.prototype.constructor=bg,l0.prototype=at(pt.prototype),l0.prototype.constructor=l0,Dp.prototype=at(ft.prototype),Dp.prototype.constructor=Dp,h0.prototype=at(pt.prototype),h0.prototype.constructor=h0,Vg.prototype=at(ft.prototype),Vg.prototype.constructor=Vg,c0.prototype=at(pt.prototype),c0.prototype.constructor=c0,Wg.prototype=at(ft.prototype),Wg.prototype.constructor=Wg,Op.prototype=at(pt.prototype),Op.prototype.constructor=Op,Op.prototype.toJSON=function(){var e=pt.prototype.toJSON.call(this);return b_(this.parameters.shapes,e)},Fp.prototype=at(ft.prototype),Fp.prototype.constructor=Fp,Fp.prototype.toJSON=function(){var e=ft.prototype.toJSON.call(this);return b_(this.parameters.shapes,e)},jg.prototype=at(ft.prototype),jg.prototype.constructor=jg,Bp.prototype=at(pt.prototype),Bp.prototype.constructor=Bp,Zh.prototype=at(ft.prototype),Zh.prototype.constructor=Zh,f0.prototype=at(Bp.prototype),f0.prototype.constructor=f0,p0.prototype=at(Zh.prototype),p0.prototype.constructor=p0,d0.prototype=at(pt.prototype),d0.prototype.constructor=d0,Xg.prototype=at(ft.prototype),Xg.prototype.constructor=Xg;var ra=Rl({__proto__:null,WireframeGeometry:Fg,ParametricGeometry:qv,ParametricBufferGeometry:Bg,TetrahedronGeometry:Qv,TetrahedronBufferGeometry:Ng,OctahedronGeometry:$v,OctahedronBufferGeometry:Lp,IcosahedronGeometry:t0,IcosahedronBufferGeometry:zg,DodecahedronGeometry:e0,DodecahedronBufferGeometry:Ug,PolyhedronGeometry:Kv,PolyhedronBufferGeometry:wa,TubeGeometry:r0,TubeBufferGeometry:Rp,TorusKnotGeometry:i0,TorusKnotBufferGeometry:Hg,TorusGeometry:n0,TorusBufferGeometry:kg,TextGeometry:u0,TextBufferGeometry:bg,SphereGeometry:l0,SphereBufferGeometry:Dp,RingGeometry:h0,RingBufferGeometry:Vg,PlaneGeometry:$n,PlaneBufferGeometry:Oi,LatheGeometry:c0,LatheBufferGeometry:Wg,ShapeGeometry:Op,ShapeBufferGeometry:Fp,ExtrudeGeometry:Pp,ExtrudeBufferGeometry:Xl,EdgesGeometry:jg,ConeGeometry:f0,ConeBufferGeometry:p0,CylinderGeometry:Bp,CylinderBufferGeometry:Zh,CircleGeometry:d0,CircleBufferGeometry:Xg,BoxGeometry:ow,BoxBufferGeometry:P0});Np.prototype=at(Kt.prototype),Np.prototype.constructor=Np,Np.prototype.isShadowMaterial=!0,Np.prototype.copy=function(e){return Kt.prototype.copy.call(this,e),this.color.copy(e.color),this},Jh.prototype=at(de.prototype),Jh.prototype.constructor=Jh,Jh.prototype.isRawShaderMaterial=!0,Yl.prototype=at(Kt.prototype),Yl.prototype.constructor=Yl,Yl.prototype.isMeshStandardMaterial=!0,Yl.prototype.copy=function(e){return Kt.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.vertexTangents=e.vertexTangents,this},zp.prototype=at(Yl.prototype),zp.prototype.constructor=zp,zp.prototype.isMeshPhysicalMaterial=!0,zp.prototype.copy=function(e){return Yl.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.reflectivity=e.reflectivity,this.sheen=e.sheen?(this.sheen||new yt).copy(e.sheen):null,this.transparency=e.transparency,this},sf.prototype=at(Kt.prototype),sf.prototype.constructor=sf,sf.prototype.isMeshPhongMaterial=!0,sf.prototype.copy=function(e){return Kt.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Up.prototype=at(Kt.prototype),Up.prototype.constructor=Up,Up.prototype.isMeshToonMaterial=!0,Up.prototype.copy=function(e){return Kt.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Hp.prototype=at(Kt.prototype),Hp.prototype.constructor=Hp,Hp.prototype.isMeshNormalMaterial=!0,Hp.prototype.copy=function(e){return Kt.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},kp.prototype=at(Kt.prototype),kp.prototype.constructor=kp,kp.prototype.isMeshLambertMaterial=!0,kp.prototype.copy=function(e){return Kt.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Gp.prototype=at(Kt.prototype),Gp.prototype.constructor=Gp,Gp.prototype.isMeshMatcapMaterial=!0,Gp.prototype.copy=function(e){return Kt.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},bp.prototype=at(to.prototype),bp.prototype.constructor=bp,bp.prototype.isLineDashedMaterial=!0,bp.prototype.copy=function(e){return to.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var hT=Rl({__proto__:null,ShadowMaterial:Np,SpriteMaterial:nf,RawShaderMaterial:Jh,ShaderMaterial:de,PointsMaterial:Zu,MeshPhysicalMaterial:zp,MeshStandardMaterial:Yl,MeshPhongMaterial:sf,MeshToonMaterial:Up,MeshNormalMaterial:Hp,MeshLambertMaterial:kp,MeshDepthMaterial:ef,MeshDistanceMaterial:rf,MeshBasicMaterial:ze,MeshMatcapMaterial:Gp,LineDashedMaterial:bp,LineBasicMaterial:to,Material:Kt}),eo={arraySlice:function(e,o,h){return eo.isTypedArray(e)?new e.constructor(e.subarray(o,h!==void 0?h:e.length)):e.slice(o,h)},convertArray:function(e,o,h){return!e||!h&&e.constructor===o?e:typeof o.BYTES_PER_ELEMENT=="number"?new o(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var o=e.length,h=Array(o),m=0;m!==o;++m)h[m]=m;return h.sort(function(w,T){return e[w]-e[T]}),h},sortedArray:function(e,o,h){for(var m=e.length,w=new e.constructor(m),T=0,R=0;R!==m;++T)for(var z=h[T]*o,k=0;k!==o;++k)w[R++]=e[z+k];return w},flattenJSON:function(e,o,h,m){for(var w=1,T=e[0];T!==void 0&&T[m]===void 0;)T=e[w++];if(T!==void 0){var R=T[m];if(R!==void 0)if(Array.isArray(R))do R=T[m],R!==void 0&&(o.push(T.time),h.push.apply(h,R)),T=e[w++];while(T!==void 0);else if(R.toArray!==void 0)do R=T[m],R!==void 0&&(o.push(T.time),R.toArray(h,h.length)),T=e[w++];while(T!==void 0);else do R=T[m],R!==void 0&&(o.push(T.time),h.push(R)),T=e[w++];while(T!==void 0)}},subclip:function(e,o,h,m,w){w=w||30,e=e.clone(),e.name=o;var T=[];for(o=0;o<e.tracks.length;++o){for(var R=e.tracks[o],z=R.getValueSize(),k=[],b=[],q=0;q<R.times.length;++q){var J=R.times[q]*w;if(!(J<h||J>=m))for(k.push(R.times[q]),J=0;J<z;++J)b.push(R.values[q*z+J])}k.length!==0&&(R.times=eo.convertArray(k,R.times.constructor),R.values=eo.convertArray(b,R.values.constructor),T.push(R))}for(e.tracks=T,h=Infinity,o=0;o<e.tracks.length;++o)h>e.tracks[o].times[0]&&(h=e.tracks[o].times[0]);for(o=0;o<e.tracks.length;++o)e.tracks[o].shift(-1*h);return e.resetDuration(),e},makeClipAdditive:function(e,o,h,m){o===void 0&&(o=0),h===void 0&&(h=e),(m===void 0||0>=m)&&(m=30);var w=e.tracks.length;for(o/=m,m=0;m<w;++m){var T=h.tracks[m],R=T.ValueTypeName;if(R!=="bool"&&R!=="string"){var z=e.tracks.find(function(rt){return rt.name===T.name&&rt.ValueTypeName===R});if(z!==void 0){var k=T.getValueSize(),b=T.times.length-1;o<=T.times[0]?b=eo.arraySlice(T.values,0,T.valueSize):o>=T.times[b]?b=eo.arraySlice(T.values,b*k):(b=T.createInterpolant(),b.evaluate(o),b=b.resultBuffer),R==="quaternion"&&new N(b[0],b[1],b[2],b[3]).normalize().conjugate().toArray(b);for(var q=z.times.length,J=0;J<q;++J){var Q=J*k;if(R==="quaternion")N.multiplyQuaternionsFlat(z.values,Q,b,0,z.values,Q);else for(var K=0;K<k;++K)z.values[Q+K]-=b[K]}}}}return e.blendMode=2501,e}};ut(Xa.prototype,{evaluate:function(e){var o=this.parameterPositions,h=this._cachedIndex,m=o[h],w=o[h-1];t:{e:{r:{i:if(!(e<m)){for(var T=h+2;;){if(m===void 0){if(e<w)break i;return this._cachedIndex=h=o.length,this.afterEnd_(h-1,e,w)}if(h===T)break;if(w=m,m=o[++h],e<m)break e}m=o.length;break r}if(e>=w)break t;for(T=o[1],e<T&&(h=2,w=T),T=h-2;;){if(w===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,m);if(h===T)break;if(m=w,w=o[--h-1],e>=w)break e}m=h,h=0}for(;h<m;)w=h+m>>>1,e<o[w]?m=w:h=w+1;if(m=o[h],w=o[h-1],w===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,m);if(m===void 0)return this._cachedIndex=h=o.length,this.afterEnd_(h-1,w,e)}this._cachedIndex=h,this.intervalChanged_(h,w,m)}return this.interpolate_(h,w,e,m)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){var o=this.resultBuffer,h=this.sampleValues,m=this.valueSize;e*=m;for(var w=0;w!==m;++w)o[w]=h[e+w];return o},interpolate_:function(){throw Error("call to abstract method")},intervalChanged_:function(){}}),ut(Xa.prototype,{beforeStart_:Xa.prototype.copySampleValue_,afterEnd_:Xa.prototype.copySampleValue_}),ky.prototype=ut(at(Xa.prototype),{constructor:ky,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(e,o,h){var m=this.parameterPositions,w=e-2,T=e+1,R=m[w],z=m[T];if(R===void 0)switch(this.getSettings_().endingStart){case 2401:w=e,R=2*o-h;break;case 2402:w=m.length-2,R=o+m[w]-m[w+1];break;default:w=e,R=h}if(z===void 0)switch(this.getSettings_().endingEnd){case 2401:T=e,z=2*h-o;break;case 2402:T=1,z=h+m[1]-m[0];break;default:T=e-1,z=o}e=.5*(h-o),m=this.valueSize,this._weightPrev=e/(o-R),this._weightNext=e/(z-h),this._offsetPrev=w*m,this._offsetNext=T*m},interpolate_:function(e,o,h,m){var w=this.resultBuffer,T=this.sampleValues,R=this.valueSize;e*=R;var z=e-R,k=this._offsetPrev,b=this._offsetNext,q=this._weightPrev,J=this._weightNext,Q=(h-o)/(m-o);for(h=Q*Q,m=h*Q,o=-q*m+2*q*h-q*Q,q=(1+q)*m+(-1.5-2*q)*h+(-.5+q)*Q+1,Q=(-1-J)*m+(1.5+J)*h+.5*Q,J=J*m-J*h,h=0;h!==R;++h)w[h]=o*T[k+h]+q*T[z+h]+Q*T[e+h]+J*T[b+h];return w}}),g0.prototype=ut(at(Xa.prototype),{constructor:g0,interpolate_:function(e,o,h,m){var w=this.resultBuffer,T=this.sampleValues,R=this.valueSize;e*=R;var z=e-R;for(o=(h-o)/(m-o),h=1-o,m=0;m!==R;++m)w[m]=T[z+m]*h+T[e+m]*o;return w}}),Gy.prototype=ut(at(Xa.prototype),{constructor:Gy,interpolate_:function(e){return this.copySampleValue_(e-1)}}),ut(fs,{toJSON:function(e){var o=e.constructor;if(o.toJSON!==void 0)o=o.toJSON(e);else{o={name:e.name,times:eo.convertArray(e.times,Array),values:eo.convertArray(e.values,Array)};var h=e.getInterpolation();h!==e.DefaultInterpolation&&(o.interpolation=h)}return o.type=e.ValueTypeName,o}}),ut(fs.prototype,{constructor:fs,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(e){return new Gy(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new g0(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new ky(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){switch(e){case 2300:var o=this.InterpolantFactoryMethodDiscrete;break;case 2301:o=this.InterpolantFactoryMethodLinear;break;case 2302:o=this.InterpolantFactoryMethodSmooth}if(o===void 0){if(o="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name,this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(o);return console.warn("THREE.KeyframeTrack:",o),this}return this.createInterpolant=o,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(e!==0)for(var o=this.times,h=0,m=o.length;h!==m;++h)o[h]+=e;return this},scale:function(e){if(e!==1)for(var o=this.times,h=0,m=o.length;h!==m;++h)o[h]*=e;return this},trim:function(e,o){for(var h=this.times,m=h.length,w=0,T=m-1;w!==m&&h[w]<e;)++w;for(;T!==-1&&h[T]>o;)--T;return++T,(w!==0||T!==m)&&(w>=T&&(T=Math.max(T,1),w=T-1),e=this.getValueSize(),this.times=eo.arraySlice(h,w,T),this.values=eo.arraySlice(this.values,w*e,T*e)),this},validate:function(){var e=!0,o=this.getValueSize();o-Math.floor(o)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var h=this.times;o=this.values;var m=h.length;m===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var w=null,T=0;T!==m;T++){var R=h[T];if(typeof R=="number"&&isNaN(R)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,T,R),e=!1;break}if(w!==null&&w>R){console.error("THREE.KeyframeTrack: Out of order keys.",this,T,R,w),e=!1;break}w=R}if(o!==void 0&&eo.isTypedArray(o)){for(T=0,h=o.length;T!==h;++T)if(m=o[T],isNaN(m)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,T,m),e=!1;break}}return e},optimize:function(){for(var e=eo.arraySlice(this.times),o=eo.arraySlice(this.values),h=this.getValueSize(),m=this.getInterpolation()===2302,w=1,T=e.length-1,R=1;R<T;++R){var z=!1,k=e[R];if(k!==e[R+1]&&(R!==1||k!==k[0]))if(m)z=!0;else{var b=R*h,q=b-h,J=b+h;for(k=0;k!==h;++k){var Q=o[b+k];if(Q!==o[q+k]||Q!==o[J+k]){z=!0;break}}}if(z){if(R!==w)for(e[w]=e[R],z=R*h,b=w*h,k=0;k!==h;++k)o[b+k]=o[z+k];++w}}if(0<T){for(e[w]=e[T],z=T*h,b=w*h,k=0;k!==h;++k)o[b+k]=o[z+k];++w}return w!==e.length?(this.times=eo.arraySlice(e,0,w),this.values=eo.arraySlice(o,0,w*h)):(this.times=e,this.values=o),this},clone:function(){var e=eo.arraySlice(this.times,0),o=eo.arraySlice(this.values,0);return e=new this.constructor(this.name,e,o),e.createInterpolant=this.createInterpolant,e}}),by.prototype=ut(at(fs.prototype),{constructor:by,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Vy.prototype=ut(at(fs.prototype),{constructor:Vy,ValueTypeName:"color"}),Yg.prototype=ut(at(fs.prototype),{constructor:Yg,ValueTypeName:"number"}),Wy.prototype=ut(at(Xa.prototype),{constructor:Wy,interpolate_:function(e,o,h,m){var w=this.resultBuffer,T=this.sampleValues,R=this.valueSize;for(e*=R,o=(h-o)/(m-o),h=e+R;e!==h;e+=4)N.slerpFlat(w,0,T,e-R,T,e,o);return w}}),m0.prototype=ut(at(fs.prototype),{constructor:m0,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(e){return new Wy(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),jy.prototype=ut(at(fs.prototype),{constructor:jy,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Zg.prototype=ut(at(fs.prototype),{constructor:Zg,ValueTypeName:"vector"}),ut(yu,{parse:function(e){for(var o=[],h=e.tracks,m=1/(e.fps||1),w=0,T=h.length;w!==T;++w)o.push(b3(h[w]).scale(m));return new yu(e.name,e.duration,o,e.blendMode)},toJSON:function(e){var o=[],h=e.tracks;e={name:e.name,duration:e.duration,tracks:o,uuid:e.uuid,blendMode:e.blendMode};for(var m=0,w=h.length;m!==w;++m)o.push(fs.toJSON(h[m]));return e},CreateFromMorphTargetSequence:function(e,o,h,m){for(var w=o.length,T=[],R=0;R<w;R++){var z=[],k=[];z.push((R+w-1)%w,R,(R+1)%w),k.push(0,1,0);var b=eo.getKeyframeOrder(z);z=eo.sortedArray(z,1,b),k=eo.sortedArray(k,1,b),m||z[0]!==0||(z.push(w),k.push(k[0])),T.push(new Yg(".morphTargetInfluences["+o[R].name+"]",z,k).scale(1/h))}return new yu(e,-1,T)},findByName:function(e,o){var h=e;for(Array.isArray(e)||(h=e.geometry&&e.geometry.animations||e.animations),e=0;e<h.length;e++)if(h[e].name===o)return h[e];return null},CreateClipsFromMorphTargetSequences:function(e,o,h){for(var m={},w=/^([\w-]*?)([\d]+)$/,T=0,R=e.length;T<R;T++){var z=e[T],k=z.name.match(w);if(k&&1<k.length){var b=k[1];(k=m[b])||(m[b]=k=[]),k.push(z)}}e=[];for(b in m)e.push(yu.CreateFromMorphTargetSequence(b,m[b],o,h));return e},parseAnimation:function(e,o){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;var h=function(Ot,jt,Gt,ee,Zt){if(Gt.length!==0){var le=[],Wt=[];eo.flattenJSON(Gt,le,Wt,ee),le.length!==0&&Zt.push(new Ot(jt,le,Wt))}},m=[],w=e.name||"default",T=e.length||-1,R=e.fps||30,z=e.blendMode;e=e.hierarchy||[];for(var k=0;k<e.length;k++){var b=e[k].keys;if(b&&b.length!==0)if(b[0].morphTargets){T={};for(var q=0;q<b.length;q++)if(b[q].morphTargets)for(var J=0;J<b[q].morphTargets.length;J++)T[b[q].morphTargets[J]]=-1;for(var Q in T){var K=[],rt=[];for(J=0;J!==b[q].morphTargets.length;++J){var ht=b[q];K.push(ht.time),rt.push(ht.morphTarget===Q?1:0)}m.push(new Yg(".morphTargetInfluence["+Q+"]",K,rt))}T=T.length*(R||1)}else q=".bones["+o[k].name+"]",h(Zg,q+".position",b,"pos",m),h(m0,q+".quaternion",b,"rot",m),h(Zg,q+".scale",b,"scl",m)}return m.length===0?null:new yu(w,T,m,z)}}),ut(yu.prototype,{resetDuration:function(){for(var e=0,o=0,h=this.tracks.length;o!==h;++o){var m=this.tracks[o];e=Math.max(e,m.times[m.times.length-1])}return this.duration=e,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,o=0;o<this.tracks.length;o++)e=e&&this.tracks[o].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],o=0;o<this.tracks.length;o++)e.push(this.tracks[o].clone());return new yu(this.name,this.duration,e,this.blendMode)}});var Zp={enabled:!1,files:{},add:function(e,o){this.enabled!==!1&&(this.files[e]=o)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},FM=new m2;ut(Mn.prototype,{load:function(){},loadAsync:function(e,o){var h=this;return new Di(function(m,w){h.load(e,m,o,w)})},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}});var il={};xu.prototype=ut(at(Mn.prototype),{constructor:xu,load:function(e,o,h,m){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var w=this,T=Zp.get(e);if(T!==void 0)return w.manager.itemStart(e),setTimeout(function(){o&&o(T),w.manager.itemEnd(e)},0),T;if(il[e]!==void 0)il[e].push({onLoad:o,onProgress:h,onError:m});else{var R=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(R){h=R[1];var z=!!R[2];R=R[3],R=decodeURIComponent(R),z&&(R=atob(R));try{var k=(this.responseType||"").toLowerCase();switch(k){case"arraybuffer":case"blob":var b=new Uint8Array(R.length);for(z=0;z<R.length;z++)b[z]=R.charCodeAt(z);var q=k==="blob"?new Blob([b.buffer],{type:h}):b.buffer;break;case"document":q=new DOMParser().parseFromString(R,h);break;case"json":q=JSON.parse(R);break;default:q=R}setTimeout(function(){o&&o(q),w.manager.itemEnd(e)},0)}catch(Q){setTimeout(function(){m&&m(Q),w.manager.itemError(e),w.manager.itemEnd(e)},0)}}else{il[e]=[],il[e].push({onLoad:o,onProgress:h,onError:m});var J=new XMLHttpRequest;J.open("GET",e,!0),J.addEventListener("load",function(Q){var K=this.response,rt=il[e];if(delete il[e],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Zp.add(e,K);for(var ht=0,Ot=rt.length;ht<Ot;ht++){var jt=rt[ht];jt.onLoad&&jt.onLoad(K)}}else{for(ht=0,Ot=rt.length;ht<Ot;ht++)jt=rt[ht],jt.onError&&jt.onError(Q);w.manager.itemError(e)}w.manager.itemEnd(e)},!1),J.addEventListener("progress",function(Q){for(var K=il[e],rt=0,ht=K.length;rt<ht;rt++){var Ot=K[rt];Ot.onProgress&&Ot.onProgress(Q)}},!1),J.addEventListener("error",function(Q){var K=il[e];delete il[e];for(var rt=0,ht=K.length;rt<ht;rt++){var Ot=K[rt];Ot.onError&&Ot.onError(Q)}w.manager.itemError(e),w.manager.itemEnd(e)},!1),J.addEventListener("abort",function(Q){var K=il[e];delete il[e];for(var rt=0,ht=K.length;rt<ht;rt++){var Ot=K[rt];Ot.onError&&Ot.onError(Q)}w.manager.itemError(e),w.manager.itemEnd(e)},!1),this.responseType!==void 0&&(J.responseType=this.responseType),this.withCredentials!==void 0&&(J.withCredentials=this.withCredentials),J.overrideMimeType&&J.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(z in this.requestHeader)J.setRequestHeader(z,this.requestHeader[z]);J.send(null)}return w.manager.itemStart(e),J}},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this}}),v2.prototype=ut(at(Mn.prototype),{constructor:v2,load:function(e,o,h,m){var w=this,T=new xu(w.manager);T.setPath(w.path),T.load(e,function(R){try{o(w.parse(JSON.parse(R)))}catch(z){m?m(z):console.error(z),w.manager.itemError(e)}},h,m)},parse:function(e){for(var o=[],h=0;h<e.length;h++){var m=yu.parse(e[h]);o.push(m)}return o}}),y2.prototype=ut(at(Mn.prototype),{constructor:y2,load:function(e,o,h,m){function w(Q){k.load(e[Q],function(K){K=T.parse(K,!0),R[Q]={width:K.width,height:K.height,format:K.format,mipmaps:K.mipmaps},b+=1,b===6&&(K.mipmapCount===1&&(z.minFilter=1006),z.format=K.format,z.needsUpdate=!0,o&&o(z))},h,m)}var T=this,R=[],z=new Og;z.image=R;var k=new xu(this.manager);if(k.setPath(this.path),k.setResponseType("arraybuffer"),Array.isArray(e))for(var b=0,q=0,J=e.length;q<J;++q)w(q);else k.load(e,function(Q){if(Q=T.parse(Q,!0),Q.isCubemap)for(var K=Q.mipmaps.length/Q.mipmapCount,rt=0;rt<K;rt++){R[rt]={mipmaps:[]};for(var ht=0;ht<Q.mipmapCount;ht++)R[rt].mipmaps.push(Q.mipmaps[rt*Q.mipmapCount+ht]),R[rt].format=Q.format,R[rt].width=Q.width,R[rt].height=Q.height}else z.image.width=Q.width,z.image.height=Q.height,z.mipmaps=Q.mipmaps;Q.mipmapCount===1&&(z.minFilter=1006),z.format=Q.format,z.needsUpdate=!0,o&&o(z)},h,m);return z}}),Xy.prototype=ut(at(Mn.prototype),{constructor:Xy,load:function(e,o,h,m){var w=this,T=new we,R=new xu(this.manager);return R.setResponseType("arraybuffer"),R.setPath(this.path),R.load(e,function(z){(z=w.parse(z))&&(z.image!==void 0?T.image=z.image:z.data!==void 0&&(T.image.width=z.width,T.image.height=z.height,T.image.data=z.data),T.wrapS=z.wrapS!==void 0?z.wrapS:1001,T.wrapT=z.wrapT!==void 0?z.wrapT:1001,T.magFilter=z.magFilter!==void 0?z.magFilter:1006,T.minFilter=z.minFilter!==void 0?z.minFilter:1006,T.anisotropy=z.anisotropy!==void 0?z.anisotropy:1,z.format!==void 0&&(T.format=z.format),z.type!==void 0&&(T.type=z.type),z.mipmaps!==void 0&&(T.mipmaps=z.mipmaps,T.minFilter=1008),z.mipmapCount===1&&(T.minFilter=1006),T.needsUpdate=!0,o&&o(T,z))},h,m),T}}),Jg.prototype=ut(at(Mn.prototype),{constructor:Jg,load:function(e,o,h,m){function w(){k.removeEventListener("load",w,!1),k.removeEventListener("error",T,!1),Zp.add(e,this),o&&o(this),R.manager.itemEnd(e)}function T(b){k.removeEventListener("load",w,!1),k.removeEventListener("error",T,!1),m&&m(b),R.manager.itemError(e),R.manager.itemEnd(e)}this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var R=this,z=Zp.get(e);if(z!==void 0)return R.manager.itemStart(e),setTimeout(function(){o&&o(z),R.manager.itemEnd(e)},0),z;var k=document.createElementNS("http://www.w3.org/1999/xhtml","img");return k.addEventListener("load",w,!1),k.addEventListener("error",T,!1),e.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(k.crossOrigin=this.crossOrigin),R.manager.itemStart(e),k.src=e,k}}),Yy.prototype=ut(at(Mn.prototype),{constructor:Yy,load:function(e,o,h,m){function w(k){R.load(e[k],function(b){T.images[k]=b,z++,z===6&&(T.needsUpdate=!0,o&&o(T))},void 0,m)}var T=new mu,R=new Jg(this.manager);R.setCrossOrigin(this.crossOrigin),R.setPath(this.path);var z=0;for(h=0;h<e.length;++h)w(h);return T}}),Zy.prototype=ut(at(Mn.prototype),{constructor:Zy,load:function(e,o,h,m){var w=new g,T=new Jg(this.manager);return T.setCrossOrigin(this.crossOrigin),T.setPath(this.path),T.load(e,function(R){w.image=R,R=0<e.search(/\.jpe?g($|\?)/i)||e.search(/^data:image\/jpeg/)===0,w.format=R?1022:1023,w.needsUpdate=!0,o!==void 0&&o(w)},h,m),w}}),ut(qr.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,o){return e=this.getUtoTmapping(e),this.getPoint(e,o)},getPoints:function(e){e===void 0&&(e=5);for(var o=[],h=0;h<=e;h++)o.push(this.getPoint(h/e));return o},getSpacedPoints:function(e){e===void 0&&(e=5);for(var o=[],h=0;h<=e;h++)o.push(this.getPointAt(h/e));return o},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(e===void 0&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var o=[],h=this.getPoint(0),m,w=0;for(o.push(0),m=1;m<=e;m++){var T=this.getPoint(m/e);w+=T.distanceTo(h),o.push(w),h=T}return this.cacheArcLengths=o},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,o){var h=this.getLengths(),m=h.length;o=o||e*h[m-1];for(var w=0,T=m-1,R;w<=T;)if(e=Math.floor(w+(T-w)/2),R=h[e]-o,0>R)w=e+1;else if(0<R)T=e-1;else{T=e;break}return e=T,h[e]===o?e/(m-1):(w=h[e],(e+(o-w)/(h[e+1]-w))/(m-1))},getTangent:function(e,o){var h=e-1e-4;return e+=1e-4,0>h&&(h=0),1<e&&(e=1),h=this.getPoint(h),e=this.getPoint(e),o=o||(h.isVector2?new f:new _),o.copy(e).sub(h).normalize(),o},getTangentAt:function(e,o){return e=this.getUtoTmapping(e),this.getTangent(e,o)},computeFrenetFrames:function(e,o){var h=new _,m=[],w=[],T=[],R=new _,z=new I,k;for(k=0;k<=e;k++){var b=k/e;m[k]=this.getTangentAt(b,new _),m[k].normalize()}w[0]=new _,T[0]=new _,k=Number.MAX_VALUE,b=Math.abs(m[0].x);var q=Math.abs(m[0].y),J=Math.abs(m[0].z);for(b<=k&&(k=b,h.set(1,0,0)),q<=k&&(k=q,h.set(0,1,0)),J<=k&&h.set(0,0,1),R.crossVectors(m[0],h).normalize(),w[0].crossVectors(m[0],R),T[0].crossVectors(m[0],w[0]),k=1;k<=e;k++)w[k]=w[k-1].clone(),T[k]=T[k-1].clone(),R.crossVectors(m[k-1],m[k]),R.length()>Dn&&(R.normalize(),h=Math.acos(Si.clamp(m[k-1].dot(m[k]),-1,1)),w[k].applyMatrix4(z.makeRotationAxis(R,h))),T[k].crossVectors(m[k],w[k]);if(o===!0)for(h=Math.acos(Si.clamp(w[0].dot(w[e]),-1,1)),h/=e,0<m[0].dot(R.crossVectors(w[0],w[e]))&&(h=-h),k=1;k<=e;k++)w[k].applyMatrix4(z.makeRotationAxis(m[k],h*k)),T[k].crossVectors(m[k],w[k]);return{tangents:m,normals:w,binormals:T}},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),Ya.prototype=at(qr.prototype),Ya.prototype.constructor=Ya,Ya.prototype.isEllipseCurve=!0,Ya.prototype.getPoint=function(e,o){o=o||new f;for(var h=2*Math.PI,m=this.aEndAngle-this.aStartAngle,w=Math.abs(m)<Dn;0>m;)m+=h;for(;m>h;)m-=h;m<Dn&&(m=w?0:h),this.aClockwise!==!0||w||(m=m===h?-h:m-h),h=this.aStartAngle+e*m,e=this.aX+this.xRadius*Math.cos(h);var T=this.aY+this.yRadius*Math.sin(h);return this.aRotation!==0&&(h=Math.cos(this.aRotation),m=Math.sin(this.aRotation),w=e-this.aX,T-=this.aY,e=w*h-T*m+this.aX,T=w*m+T*h+this.aY),o.set(e,T)},Ya.prototype.copy=function(e){return qr.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},Ya.prototype.toJSON=function(){var e=qr.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},Ya.prototype.fromJSON=function(e){return qr.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},qg.prototype=at(Ya.prototype),qg.prototype.constructor=qg,qg.prototype.isArcCurve=!0;var Bx=new _,hw=new x2,cw=new x2,fw=new x2;Ns.prototype=at(qr.prototype),Ns.prototype.constructor=Ns,Ns.prototype.isCatmullRomCurve3=!0,Ns.prototype.getPoint=function(e,o){o=o||new _;var h=this.points,m=h.length;e*=m-(this.closed?0:1);var w=Math.floor(e);if(e-=w,this.closed?w+=0<w?0:(Math.floor(Math.abs(w)/m)+1)*m:e===0&&w===m-1&&(w=m-2,e=1),this.closed||0<w)var T=h[(w-1)%m];else Bx.subVectors(h[0],h[1]).add(h[0]),T=Bx;var R=h[w%m],z=h[(w+1)%m];if(this.closed||w+2<m?h=h[(w+2)%m]:(Bx.subVectors(h[m-1],h[m-2]).add(h[m-1]),h=Bx),this.curveType==="centripetal"||this.curveType==="chordal"){var k=this.curveType==="chordal"?.5:.25;m=Math.pow(T.distanceToSquared(R),k),w=Math.pow(R.distanceToSquared(z),k),k=Math.pow(z.distanceToSquared(h),k),1e-4>w&&(w=1),1e-4>m&&(m=w),1e-4>k&&(k=w),hw.initNonuniformCatmullRom(T.x,R.x,z.x,h.x,m,w,k),cw.initNonuniformCatmullRom(T.y,R.y,z.y,h.y,m,w,k),fw.initNonuniformCatmullRom(T.z,R.z,z.z,h.z,m,w,k)}else this.curveType==="catmullrom"&&(hw.initCatmullRom(T.x,R.x,z.x,h.x,this.tension),cw.initCatmullRom(T.y,R.y,z.y,h.y,this.tension),fw.initCatmullRom(T.z,R.z,z.z,h.z,this.tension));return o.set(hw.calc(e),cw.calc(e),fw.calc(e)),o},Ns.prototype.copy=function(e){qr.prototype.copy.call(this,e),this.points=[];for(var o=0,h=e.points.length;o<h;o++)this.points.push(e.points[o].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},Ns.prototype.toJSON=function(){var e=qr.prototype.toJSON.call(this);e.points=[];for(var o=0,h=this.points.length;o<h;o++)e.points.push(this.points[o].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},Ns.prototype.fromJSON=function(e){qr.prototype.fromJSON.call(this,e),this.points=[];for(var o=0,h=e.points.length;o<h;o++){var m=e.points[o];this.points.push(new _().fromArray(m))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},Ju.prototype=at(qr.prototype),Ju.prototype.constructor=Ju,Ju.prototype.isCubicBezierCurve=!0,Ju.prototype.getPoint=function(e,o){o=o||new f;var h=this.v0,m=this.v1,w=this.v2,T=this.v3;return o.set(y0(e,h.x,m.x,w.x,T.x),y0(e,h.y,m.y,w.y,T.y)),o},Ju.prototype.copy=function(e){return qr.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Ju.prototype.toJSON=function(){var e=qr.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Ju.prototype.fromJSON=function(e){return qr.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},Zl.prototype=at(qr.prototype),Zl.prototype.constructor=Zl,Zl.prototype.isCubicBezierCurve3=!0,Zl.prototype.getPoint=function(e,o){o=o||new _;var h=this.v0,m=this.v1,w=this.v2,T=this.v3;return o.set(y0(e,h.x,m.x,w.x,T.x),y0(e,h.y,m.y,w.y,T.y),y0(e,h.z,m.z,w.z,T.z)),o},Zl.prototype.copy=function(e){return qr.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Zl.prototype.toJSON=function(){var e=qr.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Zl.prototype.fromJSON=function(e){return qr.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},_a.prototype=at(qr.prototype),_a.prototype.constructor=_a,_a.prototype.isLineCurve=!0,_a.prototype.getPoint=function(e,o){return o=o||new f,e===1?o.copy(this.v2):(o.copy(this.v2).sub(this.v1),o.multiplyScalar(e).add(this.v1)),o},_a.prototype.getPointAt=function(e,o){return this.getPoint(e,o)},_a.prototype.getTangent=function(e,o){return e=o||new f,e=e.copy(this.v2).sub(this.v1).normalize()},_a.prototype.copy=function(e){return qr.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},_a.prototype.toJSON=function(){var e=qr.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},_a.prototype.fromJSON=function(e){return qr.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},qu.prototype=at(qr.prototype),qu.prototype.constructor=qu,qu.prototype.isLineCurve3=!0,qu.prototype.getPoint=function(e,o){return o=o||new _,e===1?o.copy(this.v2):(o.copy(this.v2).sub(this.v1),o.multiplyScalar(e).add(this.v1)),o},qu.prototype.getPointAt=function(e,o){return this.getPoint(e,o)},qu.prototype.copy=function(e){return qr.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},qu.prototype.toJSON=function(){var e=qr.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},qu.prototype.fromJSON=function(e){return qr.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Ku.prototype=at(qr.prototype),Ku.prototype.constructor=Ku,Ku.prototype.isQuadraticBezierCurve=!0,Ku.prototype.getPoint=function(e,o){o=o||new f;var h=this.v0,m=this.v1,w=this.v2;return o.set(v0(e,h.x,m.x,w.x),v0(e,h.y,m.y,w.y)),o},Ku.prototype.copy=function(e){return qr.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Ku.prototype.toJSON=function(){var e=qr.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Ku.prototype.fromJSON=function(e){return qr.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Jl.prototype=at(qr.prototype),Jl.prototype.constructor=Jl,Jl.prototype.isQuadraticBezierCurve3=!0,Jl.prototype.getPoint=function(e,o){o=o||new _;var h=this.v0,m=this.v1,w=this.v2;return o.set(v0(e,h.x,m.x,w.x),v0(e,h.y,m.y,w.y),v0(e,h.z,m.z,w.z)),o},Jl.prototype.copy=function(e){return qr.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Jl.prototype.toJSON=function(){var e=qr.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Jl.prototype.fromJSON=function(e){return qr.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Qu.prototype=at(qr.prototype),Qu.prototype.constructor=Qu,Qu.prototype.isSplineCurve=!0,Qu.prototype.getPoint=function(e,o){o=o||new f;var h=this.points,m=(h.length-1)*e;e=Math.floor(m),m-=e;var w=h[e===0?e:e-1],T=h[e],R=h[e>h.length-2?h.length-1:e+1];return h=h[e>h.length-3?h.length-1:e+2],o.set(V_(m,w.x,T.x,R.x,h.x),V_(m,w.y,T.y,R.y,h.y)),o},Qu.prototype.copy=function(e){qr.prototype.copy.call(this,e),this.points=[];for(var o=0,h=e.points.length;o<h;o++)this.points.push(e.points[o].clone());return this},Qu.prototype.toJSON=function(){var e=qr.prototype.toJSON.call(this);e.points=[];for(var o=0,h=this.points.length;o<h;o++)e.points.push(this.points[o].toArray());return e},Qu.prototype.fromJSON=function(e){qr.prototype.fromJSON.call(this,e),this.points=[];for(var o=0,h=e.points.length;o<h;o++){var m=e.points[o];this.points.push(new f().fromArray(m))}return this};var pw=Rl({__proto__:null,ArcCurve:qg,CatmullRomCurve3:Ns,CubicBezierCurve:Ju,CubicBezierCurve3:Zl,EllipseCurve:Ya,LineCurve:_a,LineCurve3:qu,QuadraticBezierCurve:Ku,QuadraticBezierCurve3:Jl,SplineCurve:Qu});qh.prototype=ut(at(qr.prototype),{constructor:qh,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),o=this.curves[this.curves.length-1].getPoint(1);e.equals(o)||this.curves.push(new _a(o,e))},getPoint:function(e){var o=e*this.getLength(),h=this.getCurveLengths();for(e=0;e<h.length;){if(h[e]>=o)return o=h[e]-o,e=this.curves[e],h=e.getLength(),e.getPointAt(h===0?0:1-o/h);e++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],o=0,h=0,m=this.curves.length;h<m;h++)o+=this.curves[h].getLength(),e.push(o);return this.cacheLengths=e},getSpacedPoints:function(e){e===void 0&&(e=40);for(var o=[],h=0;h<=e;h++)o.push(this.getPoint(h/e));return this.autoClose&&o.push(o[0]),o},getPoints:function(e){e=e||12;for(var o=[],h,m=0,w=this.curves;m<w.length;m++){var T=w[m];T=T.getPoints(T&&T.isEllipseCurve?2*e:T&&(T.isLineCurve||T.isLineCurve3)?1:T&&T.isSplineCurve?e*T.points.length:e);for(var R=0;R<T.length;R++){var z=T[R];h&&h.equals(z)||(o.push(z),h=z)}}return this.autoClose&&1<o.length&&!o[o.length-1].equals(o[0])&&o.push(o[0]),o},copy:function(e){qr.prototype.copy.call(this,e),this.curves=[];for(var o=0,h=e.curves.length;o<h;o++)this.curves.push(e.curves[o].clone());return this.autoClose=e.autoClose,this},toJSON:function(){var e=qr.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var o=0,h=this.curves.length;o<h;o++)e.curves.push(this.curves[o].toJSON());return e},fromJSON:function(e){qr.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var o=0,h=e.curves.length;o<h;o++){var m=e.curves[o];this.curves.push(new pw[m.type]().fromJSON(m))}return this}}),$u.prototype=ut(at(qh.prototype),{constructor:$u,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var o=1,h=e.length;o<h;o++)this.lineTo(e[o].x,e[o].y);return this},moveTo:function(e,o){return this.currentPoint.set(e,o),this},lineTo:function(e,o){var h=new _a(this.currentPoint.clone(),new f(e,o));return this.curves.push(h),this.currentPoint.set(e,o),this},quadraticCurveTo:function(e,o,h,m){return e=new Ku(this.currentPoint.clone(),new f(e,o),new f(h,m)),this.curves.push(e),this.currentPoint.set(h,m),this},bezierCurveTo:function(e,o,h,m,w,T){return e=new Ju(this.currentPoint.clone(),new f(e,o),new f(h,m),new f(w,T)),this.curves.push(e),this.currentPoint.set(w,T),this},splineThru:function(e){var o=[this.currentPoint.clone()].concat(e);return o=new Qu(o),this.curves.push(o),this.currentPoint.copy(e[e.length-1]),this},arc:function(e,o,h,m,w,T){return this.absarc(e+this.currentPoint.x,o+this.currentPoint.y,h,m,w,T),this},absarc:function(e,o,h,m,w,T){return this.absellipse(e,o,h,h,m,w,T),this},ellipse:function(e,o,h,m,w,T,R,z){return this.absellipse(e+this.currentPoint.x,o+this.currentPoint.y,h,m,w,T,R,z),this},absellipse:function(e,o,h,m,w,T,R,z){return e=new Ya(e,o,h,m,w,T,R,z),0<this.curves.length&&(o=e.getPoint(0),o.equals(this.currentPoint)||this.lineTo(o.x,o.y)),this.curves.push(e),e=e.getPoint(1),this.currentPoint.copy(e),this},copy:function(e){return qh.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=qh.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return qh.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),af.prototype=ut(at($u.prototype),{constructor:af,getPointsHoles:function(e){for(var o=[],h=0,m=this.holes.length;h<m;h++)o[h]=this.holes[h].getPoints(e);return o},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){$u.prototype.copy.call(this,e),this.holes=[];for(var o=0,h=e.holes.length;o<h;o++)this.holes.push(e.holes[o].clone());return this},toJSON:function(){var e=$u.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var o=0,h=this.holes.length;o<h;o++)e.holes.push(this.holes[o].toJSON());return e},fromJSON:function(e){$u.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var o=0,h=e.holes.length;o<h;o++){var m=e.holes[o];this.holes.push(new $u().fromJSON(m))}return this}}),On.prototype=ut(at(F.prototype),{constructor:On,isLight:!0,copy:function(e){return F.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){return e=F.prototype.toJSON.call(this,e),e.object.color=this.color.getHex(),e.object.intensity=this.intensity,this.groundColor!==void 0&&(e.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(e.object.distance=this.distance),this.angle!==void 0&&(e.object.angle=this.angle),this.decay!==void 0&&(e.object.decay=this.decay),this.penumbra!==void 0&&(e.object.penumbra=this.penumbra),this.shadow!==void 0&&(e.object.shadow=this.shadow.toJSON()),e}}),Jy.prototype=ut(at(On.prototype),{constructor:Jy,isHemisphereLight:!0,copy:function(e){return On.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),ut(ql.prototype,{_projScreenMatrix:new I,_lightPositionWorld:new _,_lookTarget:new _,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(e){var o=this.camera,h=this.matrix,m=this._projScreenMatrix,w=this._lookTarget,T=this._lightPositionWorld;T.setFromMatrixPosition(e.matrixWorld),o.position.copy(T),w.setFromMatrixPosition(e.target.matrixWorld),o.lookAt(w),o.updateMatrixWorld(),m.multiplyMatrices(o.projectionMatrix,o.matrixWorldInverse),this._frustum.setFromProjectionMatrix(m),h.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),h.multiply(o.projectionMatrix),h.multiply(o.matrixWorldInverse)},getViewport:function(e){return this._viewports[e]},getFrameExtents:function(){return this._frameExtents},copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var e={};return this.bias!==0&&(e.bias=this.bias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),qy.prototype=ut(at(ql.prototype),{constructor:qy,isSpotLightShadow:!0,updateMatrices:function(e){var o=this.camera,h=2*Si.RAD2DEG*e.angle,m=this.mapSize.width/this.mapSize.height,w=e.distance||o.far;(h!==o.fov||m!==o.aspect||w!==o.far)&&(o.fov=h,o.aspect=m,o.far=w,o.updateProjectionMatrix()),ql.prototype.updateMatrices.call(this,e)}}),Ky.prototype=ut(at(On.prototype),{constructor:Ky,isSpotLight:!0,copy:function(e){return On.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),A2.prototype=ut(at(ql.prototype),{constructor:A2,isPointLightShadow:!0,updateMatrices:function(e,o){o===void 0&&(o=0);var h=this.camera,m=this.matrix,w=this._lightPositionWorld,T=this._lookTarget,R=this._projScreenMatrix;w.setFromMatrixPosition(e.matrixWorld),h.position.copy(w),T.copy(h.position),T.add(this._cubeDirections[o]),h.up.copy(this._cubeUps[o]),h.lookAt(T),h.updateMatrixWorld(),m.makeTranslation(-w.x,-w.y,-w.z),R.multiplyMatrices(h.projectionMatrix,h.matrixWorldInverse),this._frustum.setFromProjectionMatrix(R)}}),Qy.prototype=ut(at(On.prototype),{constructor:Qy,isPointLight:!0,copy:function(e){return On.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),Kg.prototype=ut(at(ie.prototype),{constructor:Kg,isOrthographicCamera:!0,copy:function(e,o){return ie.prototype.copy.call(this,e,o),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:ut({},e.view),this},setViewOffset:function(e,o,h,m,w,T){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=o,this.view.offsetX=h,this.view.offsetY=m,this.view.width=w,this.view.height=T,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),o=(this.top-this.bottom)/(2*this.zoom),h=(this.right+this.left)/2,m=(this.top+this.bottom)/2,w=h-e;h+=e,e=m+o,o=m-o,this.view!==null&&this.view.enabled&&(m=(this.right-this.left)/this.view.fullWidth/this.zoom,o=(this.top-this.bottom)/this.view.fullHeight/this.zoom,w+=m*this.view.offsetX,h=w+m*this.view.width,e-=o*this.view.offsetY,o=e-o*this.view.height),this.projectionMatrix.makeOrthographic(w,h,e,o,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){return e=F.prototype.toJSON.call(this,e),e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,this.view!==null&&(e.object.view=ut({},this.view)),e}}),$y.prototype=ut(at(ql.prototype),{constructor:$y,isDirectionalLightShadow:!0,updateMatrices:function(e){ql.prototype.updateMatrices.call(this,e)}}),tx.prototype=ut(at(On.prototype),{constructor:tx,isDirectionalLight:!0,copy:function(e){return On.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),ex.prototype=ut(at(On.prototype),{constructor:ex,isAmbientLight:!0}),rx.prototype=ut(at(On.prototype),{constructor:rx,isRectAreaLight:!0,copy:function(e){return On.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){return e=On.prototype.toJSON.call(this,e),e.object.width=this.width,e.object.height=this.height,e}}),ut(ix.prototype,{isSphericalHarmonics3:!0,set:function(e){for(var o=0;9>o;o++)this.coefficients[o].copy(e[o]);return this},zero:function(){for(var e=0;9>e;e++)this.coefficients[e].set(0,0,0);return this},getAt:function(e,o){var h=e.x,m=e.y;e=e.z;var w=this.coefficients;return o.copy(w[0]).multiplyScalar(.282095),o.addScaledVector(w[1],.488603*m),o.addScaledVector(w[2],.488603*e),o.addScaledVector(w[3],.488603*h),o.addScaledVector(w[4],1.092548*h*m),o.addScaledVector(w[5],1.092548*m*e),o.addScaledVector(w[6],.315392*(3*e*e-1)),o.addScaledVector(w[7],1.092548*h*e),o.addScaledVector(w[8],.546274*(h*h-m*m)),o},getIrradianceAt:function(e,o){var h=e.x,m=e.y;e=e.z;var w=this.coefficients;return o.copy(w[0]).multiplyScalar(.886227),o.addScaledVector(w[1],1.023328*m),o.addScaledVector(w[2],1.023328*e),o.addScaledVector(w[3],1.023328*h),o.addScaledVector(w[4],.858086*h*m),o.addScaledVector(w[5],.858086*m*e),o.addScaledVector(w[6],.743125*e*e-.247708),o.addScaledVector(w[7],.858086*h*e),o.addScaledVector(w[8],.429043*(h*h-m*m)),o},add:function(e){for(var o=0;9>o;o++)this.coefficients[o].add(e.coefficients[o]);return this},addScaledSH:function(e,o){for(var h=0;9>h;h++)this.coefficients[h].addScaledVector(e.coefficients[h],o);return this},scale:function(e){for(var o=0;9>o;o++)this.coefficients[o].multiplyScalar(e);return this},lerp:function(e,o){for(var h=0;9>h;h++)this.coefficients[h].lerp(e.coefficients[h],o);return this},equals:function(e){for(var o=0;9>o;o++)if(!this.coefficients[o].equals(e.coefficients[o]))return!1;return!0},copy:function(e){return this.set(e.coefficients)},clone:function(){return new this.constructor().copy(this)},fromArray:function(e,o){o===void 0&&(o=0);for(var h=this.coefficients,m=0;9>m;m++)h[m].fromArray(e,o+3*m);return this},toArray:function(e,o){e===void 0&&(e=[]),o===void 0&&(o=0);for(var h=this.coefficients,m=0;9>m;m++)h[m].toArray(e,o+3*m);return e}}),ut(ix,{getBasisAt:function(e,o){var h=e.x,m=e.y;e=e.z,o[0]=.282095,o[1]=.488603*m,o[2]=.488603*e,o[3]=.488603*h,o[4]=1.092548*h*m,o[5]=1.092548*m*e,o[6]=.315392*(3*e*e-1),o[7]=1.092548*h*e,o[8]=.546274*(h*h-m*m)}}),Au.prototype=ut(at(On.prototype),{constructor:Au,isLightProbe:!0,copy:function(e){return On.prototype.copy.call(this,e),this.sh.copy(e.sh),this},fromJSON:function(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this},toJSON:function(e){return e=On.prototype.toJSON.call(this,e),e.object.sh=this.sh.toArray(),e}}),nx.prototype=ut(at(Mn.prototype),{constructor:nx,load:function(e,o,h,m){var w=this,T=new xu(w.manager);T.setPath(w.path),T.load(e,function(R){try{o(w.parse(JSON.parse(R)))}catch(z){m?m(z):console.error(z),w.manager.itemError(e)}},h,m)},parse:function(e){function o(z){return h[z]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",z),h[z]}var h=this.textures,m=new hT[e.type];if(e.uuid!==void 0&&(m.uuid=e.uuid),e.name!==void 0&&(m.name=e.name),e.color!==void 0&&m.color.setHex(e.color),e.roughness!==void 0&&(m.roughness=e.roughness),e.metalness!==void 0&&(m.metalness=e.metalness),e.sheen!==void 0&&(m.sheen=new yt().setHex(e.sheen)),e.emissive!==void 0&&m.emissive.setHex(e.emissive),e.specular!==void 0&&m.specular.setHex(e.specular),e.shininess!==void 0&&(m.shininess=e.shininess),e.clearcoat!==void 0&&(m.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(m.clearcoatRoughness=e.clearcoatRoughness),e.fog!==void 0&&(m.fog=e.fog),e.flatShading!==void 0&&(m.flatShading=e.flatShading),e.blending!==void 0&&(m.blending=e.blending),e.combine!==void 0&&(m.combine=e.combine),e.side!==void 0&&(m.side=e.side),e.opacity!==void 0&&(m.opacity=e.opacity),e.transparent!==void 0&&(m.transparent=e.transparent),e.alphaTest!==void 0&&(m.alphaTest=e.alphaTest),e.depthTest!==void 0&&(m.depthTest=e.depthTest),e.depthWrite!==void 0&&(m.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(m.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(m.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(m.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(m.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(m.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(m.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(m.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(m.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(m.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(m.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(m.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(m.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(m.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(m.rotation=e.rotation),e.linewidth!==1&&(m.linewidth=e.linewidth),e.dashSize!==void 0&&(m.dashSize=e.dashSize),e.gapSize!==void 0&&(m.gapSize=e.gapSize),e.scale!==void 0&&(m.scale=e.scale),e.polygonOffset!==void 0&&(m.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(m.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(m.polygonOffsetUnits=e.polygonOffsetUnits),e.skinning!==void 0&&(m.skinning=e.skinning),e.morphTargets!==void 0&&(m.morphTargets=e.morphTargets),e.morphNormals!==void 0&&(m.morphNormals=e.morphNormals),e.dithering!==void 0&&(m.dithering=e.dithering),e.vertexTangents!==void 0&&(m.vertexTangents=e.vertexTangents),e.visible!==void 0&&(m.visible=e.visible),e.toneMapped!==void 0&&(m.toneMapped=e.toneMapped),e.userData!==void 0&&(m.userData=e.userData),e.vertexColors!==void 0&&(m.vertexColors=typeof e.vertexColors=="number"?0<e.vertexColors:e.vertexColors),e.uniforms!==void 0)for(var w in e.uniforms){var T=e.uniforms[w];switch(m.uniforms[w]={},T.type){case"t":m.uniforms[w].value=o(T.value);break;case"c":m.uniforms[w].value=new yt().setHex(T.value);break;case"v2":m.uniforms[w].value=new f().fromArray(T.value);break;case"v3":m.uniforms[w].value=new _().fromArray(T.value);break;case"v4":m.uniforms[w].value=new p().fromArray(T.value);break;case"m3":m.uniforms[w].value=new c().fromArray(T.value);case"m4":m.uniforms[w].value=new I().fromArray(T.value);break;default:m.uniforms[w].value=T.value}}if(e.defines!==void 0&&(m.defines=e.defines),e.vertexShader!==void 0&&(m.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(m.fragmentShader=e.fragmentShader),e.extensions!==void 0)for(var R in e.extensions)m.extensions[R]=e.extensions[R];return e.shading!==void 0&&(m.flatShading=e.shading===1),e.size!==void 0&&(m.size=e.size),e.sizeAttenuation!==void 0&&(m.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(m.map=o(e.map)),e.matcap!==void 0&&(m.matcap=o(e.matcap)),e.alphaMap!==void 0&&(m.alphaMap=o(e.alphaMap)),e.bumpMap!==void 0&&(m.bumpMap=o(e.bumpMap)),e.bumpScale!==void 0&&(m.bumpScale=e.bumpScale),e.normalMap!==void 0&&(m.normalMap=o(e.normalMap)),e.normalMapType!==void 0&&(m.normalMapType=e.normalMapType),e.normalScale!==void 0&&(w=e.normalScale,Array.isArray(w)===!1&&(w=[w,w]),m.normalScale=new f().fromArray(w)),e.displacementMap!==void 0&&(m.displacementMap=o(e.displacementMap)),e.displacementScale!==void 0&&(m.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(m.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(m.roughnessMap=o(e.roughnessMap)),e.metalnessMap!==void 0&&(m.metalnessMap=o(e.metalnessMap)),e.emissiveMap!==void 0&&(m.emissiveMap=o(e.emissiveMap)),e.emissiveIntensity!==void 0&&(m.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(m.specularMap=o(e.specularMap)),e.envMap!==void 0&&(m.envMap=o(e.envMap)),e.envMapIntensity!==void 0&&(m.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(m.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(m.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(m.lightMap=o(e.lightMap)),e.lightMapIntensity!==void 0&&(m.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(m.aoMap=o(e.aoMap)),e.aoMapIntensity!==void 0&&(m.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(m.gradientMap=o(e.gradientMap)),e.clearcoatMap!==void 0&&(m.clearcoatMap=o(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(m.clearcoatRoughnessMap=o(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(m.clearcoatNormalMap=o(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(m.clearcoatNormalScale=new f().fromArray(e.clearcoatNormalScale)),m},setTextures:function(e){return this.textures=e,this}});var dw={decodeText:function(e){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(e);for(var o="",h=0,m=e.length;h<m;h++)o+=String.fromCharCode(e[h]);try{return decodeURIComponent(escape(o))}catch(w){return o}},extractUrlBase:function(e){var o=e.lastIndexOf("/");return o===-1?"./":e.substr(0,o+1)}};x0.prototype=ut(at(ft.prototype),{constructor:x0,isInstancedBufferGeometry:!0,copy:function(e){return ft.prototype.copy.call(this,e),this.instanceCount=e.instanceCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var e=ft.prototype.toJSON.call(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}),ox.prototype=ut(at(ae.prototype),{constructor:ox,isInstancedBufferAttribute:!0,copy:function(e){return ae.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=ae.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}),sx.prototype=ut(at(Mn.prototype),{constructor:sx,load:function(e,o,h,m){var w=this,T=new xu(w.manager);T.setPath(w.path),T.load(e,function(R){try{o(w.parse(JSON.parse(R)))}catch(z){m?m(z):console.error(z),w.manager.itemError(e)}},h,m)},parse:function(e){var o=e.isInstancedBufferGeometry?new x0:new ft,h=e.data.index;if(h!==void 0){var m=new gw[h.type](h.array);o.setIndex(new ae(m,1))}h=e.data.attributes;for(var w in h){var T=h[w];m=new gw[T.type](T.array),m=new(T.isInstancedBufferAttribute?ox:ae)(m,T.itemSize,T.normalized),T.name!==void 0&&(m.name=T.name),o.setAttribute(w,m)}var R=e.data.morphAttributes;if(R)for(w in R){var z=R[w],k=[];h=0;for(var b=z.length;h<b;h++)T=z[h],m=new gw[T.type](T.array),m=new ae(m,T.itemSize,T.normalized),T.name!==void 0&&(m.name=T.name),k.push(m);o.morphAttributes[w]=k}if(e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0),w=e.data.groups||e.data.drawcalls||e.data.offsets,w!==void 0)for(h=0,T=w.length;h!==T;++h)m=w[h],o.addGroup(m.start,m.count,m.materialIndex);return h=e.data.boundingSphere,h!==void 0&&(w=new _,h.center!==void 0&&w.fromArray(h.center),o.boundingSphere=new tt(w,h.radius)),e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}});var gw={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray!="undefined"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};ax.prototype=ut(at(Mn.prototype),{constructor:ax,load:function(e,o,h,m){var w=this,T=this.path===""?dw.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||T,T=new xu(w.manager),T.setPath(this.path),T.load(e,function(R){var z=null;try{z=JSON.parse(R)}catch(k){m!==void 0&&m(k),console.error("THREE:ObjectLoader: Can't parse "+e+".",k.message);return}R=z.metadata,R===void 0||R.type===void 0||R.type.toLowerCase()==="geometry"?console.error("THREE.ObjectLoader: Can't load "+e):w.parse(z,o)},h,m)},parse:function(e,o){var h=this.parseShape(e.shapes);h=this.parseGeometries(e.geometries,h);var m=this.parseImages(e.images,function(){o!==void 0&&o(w)});m=this.parseTextures(e.textures,m),m=this.parseMaterials(e.materials,m);var w=this.parseObject(e.object,h,m);return e.animations&&(w.animations=this.parseAnimations(e.animations)),e.images!==void 0&&e.images.length!==0||o===void 0||o(w),w},parseShape:function(e){var o={};if(e!==void 0)for(var h=0,m=e.length;h<m;h++){var w=new af().fromJSON(e[h]);o[w.uuid]=w}return o},parseGeometries:function(e,o){var h={};if(e!==void 0)for(var m=new sx,w=0,T=e.length;w<T;w++){var R=e[w];switch(R.type){case"PlaneGeometry":case"PlaneBufferGeometry":var z=new ra[R.type](R.width,R.height,R.widthSegments,R.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":z=new ra[R.type](R.width,R.height,R.depth,R.widthSegments,R.heightSegments,R.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":z=new ra[R.type](R.radius,R.segments,R.thetaStart,R.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":z=new ra[R.type](R.radiusTop,R.radiusBottom,R.height,R.radialSegments,R.heightSegments,R.openEnded,R.thetaStart,R.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":z=new ra[R.type](R.radius,R.height,R.radialSegments,R.heightSegments,R.openEnded,R.thetaStart,R.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":z=new ra[R.type](R.radius,R.widthSegments,R.heightSegments,R.phiStart,R.phiLength,R.thetaStart,R.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":z=new ra[R.type](R.radius,R.detail);break;case"RingGeometry":case"RingBufferGeometry":z=new ra[R.type](R.innerRadius,R.outerRadius,R.thetaSegments,R.phiSegments,R.thetaStart,R.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":z=new ra[R.type](R.radius,R.tube,R.radialSegments,R.tubularSegments,R.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":z=new ra[R.type](R.radius,R.tube,R.tubularSegments,R.radialSegments,R.p,R.q);break;case"TubeGeometry":case"TubeBufferGeometry":z=new ra[R.type](new pw[R.path.type]().fromJSON(R.path),R.tubularSegments,R.radius,R.radialSegments,R.closed);break;case"LatheGeometry":case"LatheBufferGeometry":z=new ra[R.type](R.points,R.segments,R.phiStart,R.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":z=new ra[R.type](R.vertices,R.indices,R.radius,R.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":z=[];for(var k=0,b=R.shapes.length;k<b;k++){var q=o[R.shapes[k]];z.push(q)}z=new ra[R.type](z,R.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(z=[],k=0,b=R.shapes.length;k<b;k++)q=o[R.shapes[k]],z.push(q);k=R.options.extrudePath,k!==void 0&&(R.options.extrudePath=new pw[k.type]().fromJSON(k)),z=new ra[R.type](z,R.options);break;case"BufferGeometry":case"InstancedBufferGeometry":z=m.parse(R);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+R.type+'"');continue}z.uuid=R.uuid,R.name!==void 0&&(z.name=R.name),z.isBufferGeometry===!0&&R.userData!==void 0&&(z.userData=R.userData),h[R.uuid]=z}return h},parseMaterials:function(e,o){var h={},m={};if(e!==void 0){var w=new nx;w.setTextures(o),o=0;for(var T=e.length;o<T;o++){var R=e[o];if(R.type==="MultiMaterial"){for(var z=[],k=0;k<R.materials.length;k++){var b=R.materials[k];h[b.uuid]===void 0&&(h[b.uuid]=w.parse(b)),z.push(h[b.uuid])}m[R.uuid]=z}else h[R.uuid]===void 0&&(h[R.uuid]=w.parse(R)),m[R.uuid]=h[R.uuid]}}return m},parseAnimations:function(e){for(var o=[],h=0;h<e.length;h++){var m=e[h],w=yu.parse(m);m.uuid!==void 0&&(w.uuid=m.uuid),o.push(w)}return o},parseImages:function(e,o){function h(Q){return m.manager.itemStart(Q),T.load(Q,function(){m.manager.itemEnd(Q)},void 0,function(){m.manager.itemError(Q),m.manager.itemEnd(Q)})}var m=this,w={};if(e!==void 0&&0<e.length){o=new m2(o);var T=new Jg(o);T.setCrossOrigin(this.crossOrigin),o=0;for(var R=e.length;o<R;o++){var z=e[o],k=z.url;if(Array.isArray(k)){w[z.uuid]=[];for(var b=0,q=k.length;b<q;b++){var J=k[b];J=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(J)?J:m.resourcePath+J,w[z.uuid].push(h(J))}}else J=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(z.url)?z.url:m.resourcePath+z.url,w[z.uuid]=h(J)}}return w},parseTextures:function(e,o){function h(k,b){return typeof k=="number"?k:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",k),b[k])}var m={};if(e!==void 0)for(var w=0,T=e.length;w<T;w++){var R=e[w];R.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',R.uuid),o[R.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",R.image);var z=Array.isArray(o[R.image])?new mu(o[R.image]):new g(o[R.image]);z.needsUpdate=!0,z.uuid=R.uuid,R.name!==void 0&&(z.name=R.name),R.mapping!==void 0&&(z.mapping=h(R.mapping,cT)),R.offset!==void 0&&z.offset.fromArray(R.offset),R.repeat!==void 0&&z.repeat.fromArray(R.repeat),R.center!==void 0&&z.center.fromArray(R.center),R.rotation!==void 0&&(z.rotation=R.rotation),R.wrap!==void 0&&(z.wrapS=h(R.wrap[0],BM),z.wrapT=h(R.wrap[1],BM)),R.format!==void 0&&(z.format=R.format),R.type!==void 0&&(z.type=R.type),R.encoding!==void 0&&(z.encoding=R.encoding),R.minFilter!==void 0&&(z.minFilter=h(R.minFilter,NM)),R.magFilter!==void 0&&(z.magFilter=h(R.magFilter,NM)),R.anisotropy!==void 0&&(z.anisotropy=R.anisotropy),R.flipY!==void 0&&(z.flipY=R.flipY),R.premultiplyAlpha!==void 0&&(z.premultiplyAlpha=R.premultiplyAlpha),R.unpackAlignment!==void 0&&(z.unpackAlignment=R.unpackAlignment),m[R.uuid]=z}return m},parseObject:function(e,o,h){function m(b){return o[b]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",b),o[b]}function w(b){if(b!==void 0){if(Array.isArray(b)){for(var q=[],J=0,Q=b.length;J<Q;J++){var K=b[J];h[K]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",K),q.push(h[K])}return q}return h[b]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",b),h[b]}}switch(e.type){case"Scene":var T=new W;e.background!==void 0&&kc(e.background)&&(T.background=new yt(e.background)),e.fog!==void 0&&(e.fog.type==="Fog"?T.fog=new Py(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(T.fog=new Ry(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":T=new Te(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(T.focus=e.focus),e.zoom!==void 0&&(T.zoom=e.zoom),e.filmGauge!==void 0&&(T.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(T.filmOffset=e.filmOffset),e.view!==void 0&&(T.view=ut({},e.view));break;case"OrthographicCamera":T=new Kg(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(T.zoom=e.zoom),e.view!==void 0&&(T.view=ut({},e.view));break;case"AmbientLight":T=new ex(e.color,e.intensity);break;case"DirectionalLight":T=new tx(e.color,e.intensity);break;case"PointLight":T=new Qy(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":T=new rx(e.color,e.intensity,e.width,e.height);break;case"SpotLight":T=new Ky(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":T=new Jy(e.color,e.groundColor,e.intensity);break;case"LightProbe":T=new Au().fromJSON(e);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":T=m(e.geometry);var R=w(e.material);T=new Tt(T,R);break;case"InstancedMesh":T=m(e.geometry),R=w(e.material);var z=e.instanceMatrix;T=new By(T,R,e.count),T.instanceMatrix=new ae(new Float32Array(z.array),16);break;case"LOD":T=new Yv;break;case"Line":T=new ja(m(e.geometry),w(e.material),e.mode);break;case"LineLoop":T=new Ny(m(e.geometry),w(e.material));break;case"LineSegments":T=new lo(m(e.geometry),w(e.material));break;case"PointCloud":case"Points":T=new Dg(m(e.geometry),w(e.material));break;case"Sprite":T=new Xv(w(e.material));break;case"Group":T=new Pg;break;default:T=new F}if(T.uuid=e.uuid,e.name!==void 0&&(T.name=e.name),e.matrix!==void 0?(T.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(T.matrixAutoUpdate=e.matrixAutoUpdate),T.matrixAutoUpdate&&T.matrix.decompose(T.position,T.quaternion,T.scale)):(e.position!==void 0&&T.position.fromArray(e.position),e.rotation!==void 0&&T.rotation.fromArray(e.rotation),e.quaternion!==void 0&&T.quaternion.fromArray(e.quaternion),e.scale!==void 0&&T.scale.fromArray(e.scale)),e.castShadow!==void 0&&(T.castShadow=e.castShadow),e.receiveShadow!==void 0&&(T.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(T.shadow.bias=e.shadow.bias),e.shadow.radius!==void 0&&(T.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&T.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(T.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(T.visible=e.visible),e.frustumCulled!==void 0&&(T.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(T.renderOrder=e.renderOrder),e.userData!==void 0&&(T.userData=e.userData),e.layers!==void 0&&(T.layers.mask=e.layers),e.children!==void 0)for(z=e.children,R=0;R<z.length;R++)T.add(this.parseObject(z[R],o,h));if(e.type==="LOD")for(e.autoUpdate!==void 0&&(T.autoUpdate=e.autoUpdate),e=e.levels,z=0;z<e.length;z++){R=e[z];var k=T.getObjectByProperty("uuid",R.object);k!==void 0&&T.addLevel(k,R.distance)}return T}});var cT={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},BM={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},NM={NearestFilter:1003,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:1005,LinearFilter:1006,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:1008};w2.prototype=ut(at(Mn.prototype),{constructor:w2,setOptions:function(e){return this.options=e,this},load:function(e,o,h,m){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var w=this,T=Zp.get(e);if(T!==void 0)return w.manager.itemStart(e),setTimeout(function(){o&&o(T),w.manager.itemEnd(e)},0),T;fetch(e).then(function(R){return R.blob()}).then(function(R){return w.options===void 0?createImageBitmap(R):createImageBitmap(R,w.options)}).then(function(R){Zp.add(e,R),o&&o(R),w.manager.itemEnd(e)}).catch(function(R){m&&m(R),w.manager.itemError(e),w.manager.itemEnd(e)}),w.manager.itemStart(e)}}),ut(_2.prototype,{moveTo:function(e,o){return this.currentPath=new $u,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,o),this},lineTo:function(e,o){return this.currentPath.lineTo(e,o),this},quadraticCurveTo:function(e,o,h,m){return this.currentPath.quadraticCurveTo(e,o,h,m),this},bezierCurveTo:function(e,o,h,m,w,T){return this.currentPath.bezierCurveTo(e,o,h,m,w,T),this},splineThru:function(e){return this.currentPath.splineThru(e),this},toShapes:function(e,o){function h(Ot){for(var jt=[],Gt=0,ee=Ot.length;Gt<ee;Gt++){var Zt=Ot[Gt],le=new af;le.curves=Zt.curves,jt.push(le)}return jt}function m(Ot,jt){for(var Gt=jt.length,ee=!1,Zt=Gt-1,le=0;le<Gt;Zt=le++){var Wt=jt[Zt],Me=jt[le],Fe=Me.x-Wt.x,fe=Me.y-Wt.y;if(Math.abs(fe)>Dn){if(0>fe&&(Wt=jt[le],Fe=-Fe,Me=jt[Zt],fe=-fe),!(Ot.y<Wt.y||Ot.y>Me.y))if(Ot.y===Wt.y){if(Ot.x===Wt.x)return!0}else{if(Zt=fe*(Ot.x-Wt.x)-Fe*(Ot.y-Wt.y),Zt===0)return!0;0>Zt||(ee=!ee)}}else if(Ot.y===Wt.y&&(Me.x<=Ot.x&&Ot.x<=Wt.x||Wt.x<=Ot.x&&Ot.x<=Me.x))return!0}return ee}var w=nc.isClockWise,T=this.subPaths;if(T.length===0)return[];if(o===!0)return h(T);if(o=[],T.length===1){var R=T[0],z=new af;return z.curves=R.curves,o.push(z),o}var k=!w(T[0].getPoints());k=e?!k:k,z=[];var b=[],q=[],J=0;b[J]=void 0,q[J]=[];for(var Q=0,K=T.length;Q<K;Q++){R=T[Q];var rt=R.getPoints(),ht=w(rt);(ht=e?!ht:ht)?(!k&&b[J]&&J++,b[J]={s:new af,p:rt},b[J].s.curves=R.curves,k&&J++,q[J]=[]):q[J].push({h:R,p:rt[0]})}if(!b[0])return h(T);if(1<b.length){for(Q=!1,e=[],w=0,T=b.length;w<T;w++)z[w]=[];for(w=0,T=b.length;w<T;w++)for(R=q[w],ht=0;ht<R.length;ht++){for(k=R[ht],J=!0,rt=0;rt<b.length;rt++)m(k.p,b[rt].p)&&(w!==rt&&e.push({froms:w,tos:rt,hole:ht}),J?(J=!1,z[rt].push(k)):Q=!0);J&&z[w].push(k)}0<e.length&&(Q||(q=z))}for(Q=0,w=b.length;Q<w;Q++)for(z=b[Q].s,o.push(z),e=q[Q],T=0,R=e.length;T<R;T++)z.holes.push(e[T].h);return o}}),ut(M2.prototype,{isFont:!0,generateShapes:function(e,o){o===void 0&&(o=100);var h=[],m=o;o=this.data;var w=ep?ep(e):String(e).split("");m/=o.resolution;var T=(o.boundingBox.yMax-o.boundingBox.yMin+o.underlineThickness)*m;e=[];for(var R=0,z=0,k=0;k<w.length;k++){var b=w[k];if(b===`
`)R=0,z-=T;else{var q=b;b=m;var J=R,Q=z,K=o,rt=K.glyphs[q]||K.glyphs["?"];if(rt){if(q=new _2,rt.o){K=rt._cachedOutline||(rt._cachedOutline=rt.o.split(" "));for(var ht=0,Ot=K.length;ht<Ot;)switch(K[ht++]){case"m":var jt=K[ht++]*b+J,Gt=K[ht++]*b+Q;q.moveTo(jt,Gt);break;case"l":jt=K[ht++]*b+J,Gt=K[ht++]*b+Q,q.lineTo(jt,Gt);break;case"q":var ee=K[ht++]*b+J,Zt=K[ht++]*b+Q,le=K[ht++]*b+J,Wt=K[ht++]*b+Q;q.quadraticCurveTo(le,Wt,ee,Zt);break;case"b":ee=K[ht++]*b+J,Zt=K[ht++]*b+Q,le=K[ht++]*b+J,Wt=K[ht++]*b+Q,jt=K[ht++]*b+J,Gt=K[ht++]*b+Q,q.bezierCurveTo(le,Wt,jt,Gt,ee,Zt)}}b={offsetX:rt.ha*b,path:q}}else console.error('THREE.Font: character "'+q+'" does not exists in font family '+K.familyName+"."),b=void 0;R+=b.offsetX,e.push(b.path)}}for(o=0,w=e.length;o<w;o++)Array.prototype.push.apply(h,e[o].toShapes());return h}}),C2.prototype=ut(at(Mn.prototype),{constructor:C2,load:function(e,o,h,m){var w=this,T=new xu(this.manager);T.setPath(this.path),T.load(e,function(R){try{var z=JSON.parse(R)}catch(k){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),z=JSON.parse(R.substring(65,R.length-2))}R=w.parse(z),o&&o(R)},h,m)},parse:function(e){return new M2(e)}});var Nx,mw={getContext:function(){return Nx===void 0&&(Nx=new(window.AudioContext||window.webkitAudioContext)),Nx},setContext:function(e){Nx=e}};ux.prototype=ut(at(Mn.prototype),{constructor:ux,load:function(e,o,h,m){var w=this,T=new xu(w.manager);T.setResponseType("arraybuffer"),T.setPath(w.path),T.load(e,function(R){try{var z=R.slice(0);mw.getContext().decodeAudioData(z,function(k){o(k)})}catch(k){m?m(k):console.error(k),w.manager.itemError(e)}},h,m)}}),T2.prototype=ut(at(Au.prototype),{constructor:T2,isHemisphereLightProbe:!0,copy:function(e){return Au.prototype.copy.call(this,e),this},toJSON:function(e){return Au.prototype.toJSON.call(this,e)}}),S2.prototype=ut(at(Au.prototype),{constructor:S2,isAmbientLightProbe:!0,copy:function(e){return Au.prototype.copy.call(this,e),this},toJSON:function(e){return Au.prototype.toJSON.call(this,e)}});var zM=new I,UM=new I;ut(W_.prototype,{update:function(e){var o=this._cache;if(o.focus!==e.focus||o.fov!==e.fov||o.aspect!==e.aspect*this.aspect||o.near!==e.near||o.far!==e.far||o.zoom!==e.zoom||o.eyeSep!==this.eyeSep){o.focus=e.focus,o.fov=e.fov,o.aspect=e.aspect*this.aspect,o.near=e.near,o.far=e.far,o.zoom=e.zoom,o.eyeSep=this.eyeSep;var h=e.projectionMatrix.clone(),m=o.eyeSep/2,w=m*o.near/o.focus,T=o.near*Math.tan(Si.DEG2RAD*o.fov*.5)/o.zoom;UM.elements[12]=-m,zM.elements[12]=m,m=-T*o.aspect+w;var R=T*o.aspect+w;h.elements[0]=2*o.near/(R-m),h.elements[8]=(R+m)/(R-m),this.cameraL.projectionMatrix.copy(h),m=-T*o.aspect-w,R=T*o.aspect-w,h.elements[0]=2*o.near/(R-m),h.elements[8]=(R+m)/(R-m),this.cameraR.projectionMatrix.copy(h)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(UM),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(zM)}}),ut(I2.prototype,{start:function(){this.oldTime=this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.autoStart=this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var o=(typeof performance=="undefined"?Date:performance).now();e=(o-this.oldTime)/1e3,this.oldTime=o,this.elapsedTime+=e}return e}});var Jp=new _,HM=new N,fT=new _,qp=new _;E2.prototype=ut(at(F.prototype),{constructor:E2,getInput:function(){return this.gain},removeFilter:function(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(e){F.prototype.updateMatrixWorld.call(this,e),e=this.context.listener;var o=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Jp,HM,fT),qp.set(0,0,-1).applyQuaternion(HM),e.positionX){var h=this.context.currentTime+this.timeDelta;e.positionX.linearRampToValueAtTime(Jp.x,h),e.positionY.linearRampToValueAtTime(Jp.y,h),e.positionZ.linearRampToValueAtTime(Jp.z,h),e.forwardX.linearRampToValueAtTime(qp.x,h),e.forwardY.linearRampToValueAtTime(qp.y,h),e.forwardZ.linearRampToValueAtTime(qp.z,h),e.upX.linearRampToValueAtTime(o.x,h),e.upY.linearRampToValueAtTime(o.y,h),e.upZ.linearRampToValueAtTime(o.z,h)}else e.setPosition(Jp.x,Jp.y,Jp.z),e.setOrientation(qp.x,qp.y,qp.z,o.x,o.y,o.z)}}),Qg.prototype=ut(at(F.prototype),{constructor:Qg,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setMediaStreamSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(e){if(e===void 0&&(e=0),this.isPlaying===!0)console.warn("THREE.Audio: Audio is already playing.");else if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this._startedAt=this.context.currentTime+e,e=this.context.createBufferSource(),e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},pause:function(){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress%=this.duration||this.buffer.duration),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this},stop:function(){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var e=1,o=this.filters.length;e<o;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var e=1,o=this.filters.length;e<o;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),this.isPlaying===!0?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},setDetune:function(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this},setLoopStart:function(e){return this.loopStart=e,this},setLoopEnd:function(e){return this.loopEnd=e,this},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}});var Kp=new _,kM=new N,pT=new _,Qp=new _;L2.prototype=ut(at(Qg.prototype),{constructor:L2,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,o,h){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=o,this.panner.coneOuterGain=h,this},updateMatrixWorld:function(e){if(F.prototype.updateMatrixWorld.call(this,e),this.hasPlaybackControl!==!0||this.isPlaying!==!1)if(this.matrixWorld.decompose(Kp,kM,pT),Qp.set(0,0,1).applyQuaternion(kM),e=this.panner,e.positionX){var o=this.context.currentTime+this.listener.timeDelta;e.positionX.linearRampToValueAtTime(Kp.x,o),e.positionY.linearRampToValueAtTime(Kp.y,o),e.positionZ.linearRampToValueAtTime(Kp.z,o),e.orientationX.linearRampToValueAtTime(Qp.x,o),e.orientationY.linearRampToValueAtTime(Qp.y,o),e.orientationZ.linearRampToValueAtTime(Qp.z,o)}else e.setPosition(Kp.x,Kp.y,Kp.z),e.setOrientation(Qp.x,Qp.y,Qp.z)}}),ut(R2.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,o=this.getFrequencyData(),h=0;h<o.length;h++)e+=o[h];return e/o.length}}),ut(P2.prototype,{accumulate:function(e,o){var h=this.buffer,m=this.valueSize;e=e*m+m;var w=this.cumulativeWeight;if(w===0){for(w=0;w!==m;++w)h[e+w]=h[w];w=o}else w+=o,this._mixBufferRegion(h,e,0,o/w,m);this.cumulativeWeight=w},accumulateAdditive:function(e){var o=this.buffer,h=this.valueSize,m=h*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(o,m,0,e,h),this.cumulativeWeightAdditive+=e},apply:function(e){var o=this.valueSize,h=this.buffer;e=e*o+o;var m=this.cumulativeWeight,w=this.cumulativeWeightAdditive,T=this.binding;for(this.cumulativeWeightAdditive=this.cumulativeWeight=0,1>m&&this._mixBufferRegion(h,e,o*this._origIndex,1-m,o),0<w&&this._mixBufferRegionAdditive(h,e,this._addIndex*o,1,o),m=o,w=o+o;m!==w;++m)if(h[m]!==h[m+o]){T.setValue(h,e);break}},saveOriginalState:function(){var e=this.buffer,o=this.valueSize,h=o*this._origIndex;this.binding.getValue(e,h);for(var m=o;m!==h;++m)e[m]=e[h+m%o];this._setIdentity(),this.cumulativeWeightAdditive=this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_setAdditiveIdentityNumeric:function(){for(var e=this._addIndex*this.valueSize,o=e+this.valueSize;e<o;e++)this.buffer[e]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[4*this._addIndex+3]=1},_setAdditiveIdentityOther:function(){for(var e=this._origIndex*this.valueSize,o=this._addIndex*this.valueSize,h=0;h<this.valueSize;h++)this.buffer[o+h]=this.buffer[e+h]},_select:function(e,o,h,m,w){if(.5<=m)for(m=0;m!==w;++m)e[o+m]=e[h+m]},_slerp:function(e,o,h,m){N.slerpFlat(e,o,e,o,e,h,m)},_slerpAdditive:function(e,o,h,m,w){w*=this._workIndex,N.multiplyQuaternionsFlat(e,w,e,o,e,h),N.slerpFlat(e,o,e,o,e,w,m)},_lerp:function(e,o,h,m,w){for(var T=1-m,R=0;R!==w;++R){var z=o+R;e[z]=e[z]*T+e[h+R]*m}},_lerpAdditive:function(e,o,h,m,w){for(var T=0;T!==w;++T){var R=o+T;e[R]+=e[h+T]*m}}});var dT=/[\[\]\.:\/]/g,gT="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",mT=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),vT=/(WCOD+)?/.source.replace("WCOD",gT),yT=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),xT=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),AT=new RegExp("^"+mT+vT+yT+xT+"$"),wT=["material","materials","bones"];ut(j_.prototype,{getValue:function(e,o){this.bind();var h=this._bindings[this._targetGroup.nCachedObjects_];h!==void 0&&h.getValue(e,o)},setValue:function(e,o){for(var h=this._bindings,m=this._targetGroup.nCachedObjects_,w=h.length;m!==w;++m)h[m].setValue(e,o)},bind:function(){for(var e=this._bindings,o=this._targetGroup.nCachedObjects_,h=e.length;o!==h;++o)e[o].bind()},unbind:function(){for(var e=this._bindings,o=this._targetGroup.nCachedObjects_,h=e.length;o!==h;++o)e[o].unbind()}}),ut(zs,{Composite:j_,create:function(e,o,h){return e&&e.isAnimationObjectGroup?new zs.Composite(e,o,h):new zs(e,o,h)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(dT,"")},parseTrackName:function(e){var o=AT.exec(e);if(!o)throw Error("PropertyBinding: Cannot parse trackName: "+e);o={nodeName:o[2],objectName:o[3],objectIndex:o[4],propertyName:o[5],propertyIndex:o[6]};var h=o.nodeName&&o.nodeName.lastIndexOf(".");if(h!==void 0&&h!==-1){var m=o.nodeName.substring(h+1);wT.indexOf(m)!==-1&&(o.nodeName=o.nodeName.substring(0,h),o.objectName=m)}if(o.propertyName===null||o.propertyName.length===0)throw Error("PropertyBinding: can not parse propertyName from trackName: "+e);return o},findNode:function(e,o){if(!o||o===""||o==="."||o===-1||o===e.name||o===e.uuid)return e;if(e.skeleton){var h=e.skeleton.getBoneByName(o);if(h!==void 0)return h}return e.children&&(e=function m(w){for(var T=0;T<w.length;T++){var R=w[T];if(R.name===o||R.uuid===o||(R=m(R.children)))return R}return null}(e.children))?e:null}}),ut(zs.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,o){e[o]=this.node[this.propertyName]},function(e,o){for(var h=this.resolvedProperty,m=0,w=h.length;m!==w;++m)e[o++]=h[m]},function(e,o){e[o]=this.resolvedProperty[this.propertyIndex]},function(e,o){this.resolvedProperty.toArray(e,o)}],SetterByBindingTypeAndVersioning:[[function(e,o){this.targetObject[this.propertyName]=e[o]},function(e,o){this.targetObject[this.propertyName]=e[o],this.targetObject.needsUpdate=!0},function(e,o){this.targetObject[this.propertyName]=e[o],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,o){for(var h=this.resolvedProperty,m=0,w=h.length;m!==w;++m)h[m]=e[o++]},function(e,o){for(var h=this.resolvedProperty,m=0,w=h.length;m!==w;++m)h[m]=e[o++];this.targetObject.needsUpdate=!0},function(e,o){for(var h=this.resolvedProperty,m=0,w=h.length;m!==w;++m)h[m]=e[o++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,o){this.resolvedProperty[this.propertyIndex]=e[o]},function(e,o){this.resolvedProperty[this.propertyIndex]=e[o],this.targetObject.needsUpdate=!0},function(e,o){this.resolvedProperty[this.propertyIndex]=e[o],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,o){this.resolvedProperty.fromArray(e,o)},function(e,o){this.resolvedProperty.fromArray(e,o),this.targetObject.needsUpdate=!0},function(e,o){this.resolvedProperty.fromArray(e,o),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,o){this.bind(),this.getValue(e,o)},setValue:function(e,o){this.bind(),this.setValue(e,o)},bind:function(){var e=this.node,o=this.parsedPath,h=o.objectName,m=o.propertyName,w=o.propertyIndex;if(e||(this.node=e=zs.findNode(this.rootNode,o.nodeName)||this.rootNode),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(h){var T=o.objectIndex;switch(h){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}for(e=e.skeleton.bones,h=0;h<e.length;h++)if(e[h].name===T){T=h;break}break;default:if(e[h]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[h]}if(T!==void 0){if(e[T]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[T]}}if(T=e[m],T===void 0)console.error("THREE.PropertyBinding: Trying to update property for track: "+o.nodeName+"."+m+" but it wasn't found.",e);else{if(o=this.Versioning.None,this.targetObject=e,e.needsUpdate!==void 0?o=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(o=this.Versioning.MatrixWorldNeedsUpdate),h=this.BindingType.Direct,w!==void 0){if(m==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[w]!==void 0&&(w=e.morphTargetDictionary[w])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}h=this.BindingType.ArrayElement,this.resolvedProperty=T,this.propertyIndex=w}else T.fromArray!==void 0&&T.toArray!==void 0?(h=this.BindingType.HasFromToArray,this.resolvedProperty=T):Array.isArray(T)?(h=this.BindingType.EntireArray,this.resolvedProperty=T):this.propertyName=m;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][o]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),ut(zs.prototype,{_getValue_unbound:zs.prototype.getValue,_setValue_unbound:zs.prototype.setValue}),ut(X_.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,o=e.length,h=this.nCachedObjects_,m=this._indicesByUUID,w=this._paths,T=this._parsedPaths,R=this._bindings,z=R.length,k=void 0,b=0,q=arguments.length;b!==q;++b){var J=arguments[b],Q=J.uuid,K=m[Q];if(K===void 0){K=o++,m[Q]=K,e.push(J),Q=0;for(var rt=z;Q!==rt;++Q)R[Q].push(new zs(J,w[Q],T[Q]))}else if(K<h){k=e[K];var ht=--h;for(rt=e[ht],m[rt.uuid]=K,e[K]=rt,m[Q]=ht,e[ht]=J,Q=0,rt=z;Q!==rt;++Q){var Ot=R[Q],jt=Ot[K];Ot[K]=Ot[ht],jt===void 0&&(jt=new zs(J,w[Q],T[Q])),Ot[ht]=jt}}else e[K]!==k&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=h},remove:function(){for(var e=this._objects,o=this.nCachedObjects_,h=this._indicesByUUID,m=this._bindings,w=m.length,T=0,R=arguments.length;T!==R;++T){var z=arguments[T],k=z.uuid,b=h[k];if(b!==void 0&&b>=o){var q=o++,J=e[q];for(h[J.uuid]=b,e[b]=J,h[k]=q,e[q]=z,z=0,k=w;z!==k;++z){J=m[z];var Q=J[b];J[b]=J[q],J[q]=Q}}}this.nCachedObjects_=o},uncache:function(){for(var e=this._objects,o=e.length,h=this.nCachedObjects_,m=this._indicesByUUID,w=this._bindings,T=w.length,R=0,z=arguments.length;R!==z;++R){var k=arguments[R].uuid,b=m[k];if(b!==void 0)if(delete m[k],b<h){k=--h;var q=e[k],J=--o,Q=e[J];for(m[q.uuid]=b,e[b]=q,m[Q.uuid]=k,e[k]=Q,e.pop(),q=0,Q=T;q!==Q;++q){var K=w[q],rt=K[J];K[b]=K[k],K[k]=rt,K.pop()}}else for(J=--o,Q=e[J],m[Q.uuid]=b,e[b]=Q,e.pop(),q=0,Q=T;q!==Q;++q)K=w[q],K[b]=K[J],K.pop()}this.nCachedObjects_=h},subscribe_:function(e,o){var h=this._bindingsIndicesByPath,m=h[e],w=this._bindings;if(m!==void 0)return w[m];var T=this._paths,R=this._parsedPaths,z=this._objects,k=this.nCachedObjects_,b=Array(z.length);for(m=w.length,h[e]=m,T.push(e),R.push(o),w.push(b),h=k,m=z.length;h!==m;++h)b[h]=new zs(z[h],e,o);return b},unsubscribe_:function(e){var o=this._bindingsIndicesByPath,h=o[e];if(h!==void 0){var m=this._paths,w=this._parsedPaths,T=this._bindings,R=T.length-1,z=T[R];o[e[R]]=h,T[h]=z,T.pop(),w[h]=w[R],w.pop(),m[h]=m[R],m.pop()}}}),ut(Y_.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,o){return this.loop=e,this.repetitions=o,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,o,h){if(e.fadeOut(o),this.fadeIn(o),h){h=this._clip.duration;var m=e._clip.duration,w=h/m;e.warp(1,m/h,o),this.warp(w,1,o)}return this},crossFadeTo:function(e,o,h){return e.crossFadeFrom(this,o,h)},stopFading:function(){var e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,o,h){var m=this._mixer,w=m.time,T=this._timeScaleInterpolant,R=this.timeScale;return T===null&&(this._timeScaleInterpolant=T=m._lendControlInterpolant()),m=T.parameterPositions,T=T.sampleValues,m[0]=w,m[1]=w+h,T[0]=e/R,T[1]=o/R,this},stopWarping:function(){var e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,o,h,m){if(this.enabled){var w=this._startTime;if(w!==null){if(o=(e-w)*h,0>o||h===0)return;this._startTime=null,o*=h}if(o*=this._updateTimeScale(e),h=this._updateTime(o),e=this._updateWeight(e),0<e)switch(o=this._interpolants,w=this._propertyBindings,this.blendMode){case 2501:for(var T=0,R=o.length;T!==R;++T)o[T].evaluate(h),w[T].accumulateAdditive(e);break;default:for(T=0,R=o.length;T!==R;++T)o[T].evaluate(h),w[T].accumulate(m,e)}}else this._updateWeight(e)},_updateWeight:function(e){var o=0;if(this.enabled){o=this.weight;var h=this._weightInterpolant;if(h!==null){var m=h.evaluate(e)[0];o*=m,e>h.parameterPositions[1]&&(this.stopFading(),m===0&&(this.enabled=!1))}}return this._effectiveWeight=o},_updateTimeScale:function(e){var o=0;if(!this.paused){o=this.timeScale;var h=this._timeScaleInterpolant;if(h!==null){var m=h.evaluate(e)[0];o*=m,e>h.parameterPositions[1]&&(this.stopWarping(),o===0?this.paused=!0:this.timeScale=o)}}return this._effectiveTimeScale=o},_updateTime:function(e){var o=this.time+e,h=this._clip.duration,m=this.loop,w=this._loopCount,T=m===2202;if(e===0)return w===-1?o:T&&(w&1)==1?h-o:o;if(m===2200)t:{if(w===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1)),o>=h)o=h;else if(0>o)o=0;else{this.time=o;break t}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=o,this._mixer.dispatchEvent({type:"finished",action:this,direction:0>e?-1:1})}else{if(w===-1&&(0<=e?(w=0,this._setEndings(!0,this.repetitions===0,T)):this._setEndings(this.repetitions===0,!0,T)),o>=h||0>o){m=Math.floor(o/h),o-=h*m,w+=Math.abs(m);var R=this.repetitions-w;0>=R?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=o=0<e?h:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<e?1:-1})):(R===1?(e=0>e,this._setEndings(e,!e,T)):this._setEndings(!1,!1,T),this._loopCount=w,this.time=o,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:m}))}else this.time=o;if(T&&(w&1)==1)return h-o}return o},_setEndings:function(e,o,h){var m=this._interpolantSettings;h?(m.endingStart=2401,m.endingEnd=2401):(m.endingStart=e?this.zeroSlopeAtStart?2401:2400:2402,m.endingEnd=o?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(e,o,h){var m=this._mixer,w=m.time,T=this._weightInterpolant;return T===null&&(this._weightInterpolant=T=m._lendControlInterpolant()),m=T.parameterPositions,T=T.sampleValues,m[0]=w,T[0]=o,m[1]=w+e,T[1]=h,this}}),D2.prototype=ut(at(s.prototype),{constructor:D2,_bindAction:function(e,o){var h=e._localRoot||this._root,m=e._clip.tracks,w=m.length,T=e._propertyBindings;e=e._interpolants;var R=h.uuid,z=this._bindingsByRootAndName,k=z[R];for(k===void 0&&(k={},z[R]=k),z=0;z!==w;++z){var b=m[z],q=b.name,J=k[q];if(J===void 0){if(J=T[z],J!==void 0){J._cacheIndex===null&&(++J.referenceCount,this._addInactiveBinding(J,R,q));continue}J=new P2(zs.create(h,q,o&&o._propertyBindings[z].binding.parsedPath),b.ValueTypeName,b.getValueSize()),++J.referenceCount,this._addInactiveBinding(J,R,q)}T[z]=J,e[z].resultBuffer=J.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){var o=(e._localRoot||this._root).uuid,h=e._clip.uuid,m=this._actionsByClip[h];this._bindAction(e,m&&m.knownActions[0]),this._addInactiveAction(e,h,o)}for(o=e._propertyBindings,h=0,m=o.length;h!==m;++h){var w=o[h];w.useCount++==0&&(this._lendBinding(w),w.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var o=e._propertyBindings,h=0,m=o.length;h!==m;++h){var w=o[h];--w.useCount==0&&(w.restoreOriginalState(),this._takeBackBinding(w))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){return e=e._cacheIndex,e!==null&&e<this._nActiveActions},_addInactiveAction:function(e,o,h){var m=this._actions,w=this._actionsByClip,T=w[o];T===void 0?(T={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,w[o]=T):(o=T.knownActions,e._byClipCacheIndex=o.length,o.push(e)),e._cacheIndex=m.length,m.push(e),T.actionByRoot[h]=e},_removeInactiveAction:function(e){var o=this._actions,h=o[o.length-1],m=e._cacheIndex;h._cacheIndex=m,o[m]=h,o.pop(),e._cacheIndex=null,o=e._clip.uuid,h=this._actionsByClip,m=h[o];var w=m.knownActions,T=w[w.length-1],R=e._byClipCacheIndex;T._byClipCacheIndex=R,w[R]=T,w.pop(),e._byClipCacheIndex=null,delete m.actionByRoot[(e._localRoot||this._root).uuid],w.length===0&&delete h[o],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){e=e._propertyBindings;for(var o=0,h=e.length;o!==h;++o){var m=e[o];--m.referenceCount==0&&this._removeInactiveBinding(m)}},_lendAction:function(e){var o=this._actions,h=e._cacheIndex,m=this._nActiveActions++,w=o[m];e._cacheIndex=m,o[m]=e,w._cacheIndex=h,o[h]=w},_takeBackAction:function(e){var o=this._actions,h=e._cacheIndex,m=--this._nActiveActions,w=o[m];e._cacheIndex=m,o[m]=e,w._cacheIndex=h,o[h]=w},_addInactiveBinding:function(e,o,h){var m=this._bindingsByRootAndName,w=m[o],T=this._bindings;w===void 0&&(w={},m[o]=w),w[h]=e,e._cacheIndex=T.length,T.push(e)},_removeInactiveBinding:function(e){var o=this._bindings,h=e.binding,m=h.rootNode.uuid;h=h.path;var w=this._bindingsByRootAndName,T=w[m],R=o[o.length-1];e=e._cacheIndex,R._cacheIndex=e,o[e]=R,o.pop(),delete T[h],qi(T).length===0&&delete w[m]},_lendBinding:function(e){var o=this._bindings,h=e._cacheIndex,m=this._nActiveBindings++,w=o[m];e._cacheIndex=m,o[m]=e,w._cacheIndex=h,o[h]=w},_takeBackBinding:function(e){var o=this._bindings,h=e._cacheIndex,m=--this._nActiveBindings,w=o[m];e._cacheIndex=m,o[m]=e,w._cacheIndex=h,o[h]=w},_lendControlInterpolant:function(){var e=this._controlInterpolants,o=this._nActiveControlInterpolants++,h=e[o];return h===void 0&&(h=new g0(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),h.__cacheIndex=o,e[o]=h),h},_takeBackControlInterpolant:function(e){var o=this._controlInterpolants,h=e.__cacheIndex,m=--this._nActiveControlInterpolants,w=o[m];e.__cacheIndex=m,o[m]=e,w.__cacheIndex=h,o[h]=w},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,o,h){var m=o||this._root,w=m.uuid;m=typeof e=="string"?yu.findByName(m,e):e,e=m!==null?m.uuid:e;var T=this._actionsByClip[e],R=null;if(h===void 0&&(h=m!==null?m.blendMode:2500),T!==void 0){if(R=T.actionByRoot[w],R!==void 0&&R.blendMode===h)return R;R=T.knownActions[0],m===null&&(m=R._clip)}return m===null?null:(o=new Y_(this,m,o,h),this._bindAction(o,R),this._addInactiveAction(o,e,w),o)},existingAction:function(e,o){var h=o||this._root;return o=h.uuid,h=typeof e=="string"?yu.findByName(h,e):e,e=this._actionsByClip[h?h.uuid:e],e!==void 0&&e.actionByRoot[o]||null},stopAllAction:function(){for(var e=this._actions,o=this._nActiveActions-1;0<=o;--o)e[o].stop();return this},update:function(e){e*=this.timeScale;for(var o=this._actions,h=this._nActiveActions,m=this.time+=e,w=zl(e),T=this._accuIndex^=1,R=0;R!==h;++R)o[R]._update(m,e,w,T);for(e=this._bindings,o=this._nActiveBindings,R=0;R!==o;++R)e[R].apply(T);return this},setTime:function(e){for(var o=this.time=0;o<this._actions.length;o++)this._actions[o].time=0;return this.update(e)},getRoot:function(){return this._root},uncacheClip:function(e){var o=this._actions;e=e.uuid;var h=this._actionsByClip,m=h[e];if(m!==void 0){m=m.knownActions;for(var w=0,T=m.length;w!==T;++w){var R=m[w];this._deactivateAction(R);var z=R._cacheIndex,k=o[o.length-1];R._cacheIndex=null,R._byClipCacheIndex=null,k._cacheIndex=z,o[z]=k,o.pop(),this._removeInactiveBindingsForAction(R)}delete h[e]}},uncacheRoot:function(e){e=e.uuid;var o=this._actionsByClip;for(m in o){var h=o[m].actionByRoot[e];h!==void 0&&(this._deactivateAction(h),this._removeInactiveAction(h))}var m=this._bindingsByRootAndName[e];if(m!==void 0)for(var w in m)e=m[w],e.restoreOriginalState(),this._removeInactiveBinding(e)},uncacheAction:function(e,o){e=this.existingAction(e,o),e!==null&&(this._deactivateAction(e),this._removeInactiveAction(e))}}),lx.prototype.clone=function(){return new lx(this.value.clone===void 0?this.value:this.value.clone())},O2.prototype=ut(at(Yh.prototype),{constructor:O2,isInstancedInterleavedBuffer:!0,copy:function(e){return Yh.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),ut(F2.prototype,{set:function(e,o){this.ray.set(e,o)},setFromCamera:function(e,o){o&&o.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(o.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(o).sub(this.ray.origin).normalize(),this.camera=o):o&&o.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(o.near+o.far)/(o.near-o.far)).unproject(o),this.ray.direction.set(0,0,-1).transformDirection(o.matrixWorld),this.camera=o):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,o,h){return h=h||[],B2(e,this,h,o),h.sort(Z_),h},intersectObjects:function(e,o,h){if(h=h||[],Array.isArray(e)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),h;for(var m=0,w=e.length;m<w;m++)B2(e[m],this,h,o);return h.sort(Z_),h}}),ut(J_.prototype,{set:function(e,o,h){return this.radius=e,this.phi=o,this.theta=h,this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,o,h){return this.radius=Math.sqrt(e*e+o*o+h*h),this.radius===0?this.phi=this.theta=0:(this.theta=Math.atan2(e,h),this.phi=Math.acos(Si.clamp(o/this.radius,-1,1))),this}}),ut(q_.prototype,{set:function(e,o,h){return this.radius=e,this.theta=o,this.y=h,this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,o,h){return this.radius=Math.sqrt(e*e+h*h),this.theta=Math.atan2(e,h),this.y=o,this}});var GM=new f;ut(N2.prototype,{set:function(e,o){return this.min.copy(e),this.max.copy(o),this},setFromPoints:function(e){this.makeEmpty();for(var o=0,h=e.length;o<h;o++)this.expandByPoint(e[o]);return this},setFromCenterAndSize:function(e,o){return o=GM.copy(o).multiplyScalar(.5),this.min.copy(e).sub(o),this.max.copy(e).add(o),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=Infinity,this.max.x=this.max.y=-Infinity,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return e===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new f),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return e===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new f),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,o){return o===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),o=new f),o.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,o){return o===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),o=new f),o.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return GM.copy(e).clamp(this.min,this.max).sub(e).length()},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var bM=new _,zx=new _;ut(z2.prototype,{set:function(e,o){return this.start.copy(e),this.end.copy(o),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return e===void 0&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new _),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return e===void 0&&(console.warn("THREE.Line3: .delta() target is now required"),e=new _),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,o){return o===void 0&&(console.warn("THREE.Line3: .at() target is now required"),o=new _),this.delta(o).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(e,o){return bM.subVectors(e,this.start),zx.subVectors(this.end,this.start),e=zx.dot(zx),e=zx.dot(bM)/e,o&&(e=Si.clamp(e,0,1)),e},closestPointToPoint:function(e,o,h){return e=this.closestPointToPointParameter(e,o),h===void 0&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),h=new _),this.delta(h).multiplyScalar(e).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),A0.prototype=at(F.prototype),A0.prototype.constructor=A0,A0.prototype.isImmediateRenderObject=!0;var VM=new _;$g.prototype=at(F.prototype),$g.prototype.constructor=$g,$g.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},$g.prototype.update=function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,o=e*Math.tan(this.light.angle);this.cone.scale.set(o,o,e),VM.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(VM),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var mf=new _,Ux=new I,vw=new I;Vp.prototype=at(lo.prototype),Vp.prototype.constructor=Vp,Vp.prototype.isSkeletonHelper=!0,Vp.prototype.updateMatrixWorld=function(e){var o=this.bones,h=this.geometry,m=h.getAttribute("position");vw.getInverse(this.root.matrixWorld);for(var w=0,T=0;w<o.length;w++){var R=o[w];R.parent&&R.parent.isBone&&(Ux.multiplyMatrices(vw,R.matrixWorld),mf.setFromMatrixPosition(Ux),m.setXYZ(T,mf.x,mf.y,mf.z),Ux.multiplyMatrices(vw,R.parent.matrixWorld),mf.setFromMatrixPosition(Ux),m.setXYZ(T+1,mf.x,mf.y,mf.z),T+=2)}h.getAttribute("position").needsUpdate=!0,F.prototype.updateMatrixWorld.call(this,e)},tm.prototype=at(Tt.prototype),tm.prototype.constructor=tm,tm.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},tm.prototype.update=function(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)};var _T=new _,WM=new yt,jM=new yt;em.prototype=at(F.prototype),em.prototype.constructor=em,em.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},em.prototype.update=function(){var e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{var o=e.geometry.getAttribute("color");WM.copy(this.light.color),jM.copy(this.light.groundColor);for(var h=0,m=o.count;h<m;h++){var w=h<m/2?WM:jM;o.setXYZ(h,w.r,w.g,w.b)}o.needsUpdate=!0}e.lookAt(_T.setFromMatrixPosition(this.light.matrixWorld).negate())},hx.prototype=ut(at(lo.prototype),{constructor:hx,copy:function(e){return lo.prototype.copy.call(this,e),this.geometry.copy(e.geometry),this.material.copy(e.material),this},clone:function(){return new this.constructor().copy(this)}}),cx.prototype=at(lo.prototype),cx.prototype.constructor=cx;var XM=new _,Hx=new _,YM=new _;rm.prototype=at(F.prototype),rm.prototype.constructor=rm,rm.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},rm.prototype.update=function(){XM.setFromMatrixPosition(this.light.matrixWorld),Hx.setFromMatrixPosition(this.light.target.matrixWorld),YM.subVectors(Hx,XM),this.lightPlane.lookAt(Hx),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Hx),this.targetLine.scale.z=YM.length()};var kx=new _,yo=new ie;w0.prototype=at(lo.prototype),w0.prototype.constructor=w0,w0.prototype.update=function(){var e=this.geometry,o=this.pointMap;yo.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),So("c",o,e,yo,0,0,-1),So("t",o,e,yo,0,0,1),So("n1",o,e,yo,-1,-1,-1),So("n2",o,e,yo,1,-1,-1),So("n3",o,e,yo,-1,1,-1),So("n4",o,e,yo,1,1,-1),So("f1",o,e,yo,-1,-1,1),So("f2",o,e,yo,1,-1,1),So("f3",o,e,yo,-1,1,1),So("f4",o,e,yo,1,1,1),So("u1",o,e,yo,.7,1.1,-1),So("u2",o,e,yo,-.7,1.1,-1),So("u3",o,e,yo,0,2,-1),So("cf1",o,e,yo,-1,0,1),So("cf2",o,e,yo,1,0,1),So("cf3",o,e,yo,0,-1,1),So("cf4",o,e,yo,0,1,1),So("cn1",o,e,yo,-1,0,-1),So("cn2",o,e,yo,1,0,-1),So("cn3",o,e,yo,0,-1,-1),So("cn4",o,e,yo,0,1,-1),e.getAttribute("position").needsUpdate=!0};var Gx=new X;Kh.prototype=at(lo.prototype),Kh.prototype.constructor=Kh,Kh.prototype.update=function(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Gx.setFromObject(this.object),!Gx.isEmpty()){e=Gx.min;var o=Gx.max,h=this.geometry.attributes.position,m=h.array;m[0]=o.x,m[1]=o.y,m[2]=o.z,m[3]=e.x,m[4]=o.y,m[5]=o.z,m[6]=e.x,m[7]=e.y,m[8]=o.z,m[9]=o.x,m[10]=e.y,m[11]=o.z,m[12]=o.x,m[13]=o.y,m[14]=e.z,m[15]=e.x,m[16]=o.y,m[17]=e.z,m[18]=e.x,m[19]=e.y,m[20]=e.z,m[21]=o.x,m[22]=e.y,m[23]=e.z,h.needsUpdate=!0,this.geometry.computeBoundingSphere()}},Kh.prototype.setFromObject=function(e){return this.object=e,this.update(),this},Kh.prototype.copy=function(e){return lo.prototype.copy.call(this,e),this.object=e.object,this},Kh.prototype.clone=function(){return new this.constructor().copy(this)},_0.prototype=at(lo.prototype),_0.prototype.constructor=_0,_0.prototype.updateMatrixWorld=function(e){var o=this.box;o.isEmpty()||(o.getCenter(this.position),o.getSize(this.scale),this.scale.multiplyScalar(.5),F.prototype.updateMatrixWorld.call(this,e))},M0.prototype=at(ja.prototype),M0.prototype.constructor=M0,M0.prototype.updateMatrixWorld=function(e){var o=-this.plane.constant;1e-8>Math.abs(o)&&(o=1e-8),this.scale.set(.5*this.size,.5*this.size,o),this.children[0].material.side=0>o?1:0,this.lookAt(this.plane.normal),F.prototype.updateMatrixWorld.call(this,e)};var ZM=new _,bx,yw;Qh.prototype=at(F.prototype),Qh.prototype.constructor=Qh,Qh.prototype.setDirection=function(e){.99999<e.y?this.quaternion.set(0,0,0,1):-.99999>e.y?this.quaternion.set(1,0,0,0):(ZM.set(e.z,0,-e.x).normalize(),this.quaternion.setFromAxisAngle(ZM,Math.acos(e.y)))},Qh.prototype.setLength=function(e,o,h){o===void 0&&(o=.2*e),h===void 0&&(h=.2*o),this.line.scale.set(1,Math.max(1e-4,e-o),1),this.line.updateMatrix(),this.cone.scale.set(h,o,h),this.cone.position.y=e,this.cone.updateMatrix()},Qh.prototype.setColor=function(e){this.line.material.color.set(e),this.cone.material.color.set(e)},Qh.prototype.copy=function(e){return F.prototype.copy.call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this},Qh.prototype.clone=function(){return new this.constructor().copy(this)},C0.prototype=at(lo.prototype),C0.prototype.constructor=C0;var th=Math.pow(2,8),JM=[.125,.215,.35,.446,.526,.582],qM=5+JM.length,eh={3e3:0,3001:1,3002:2,3004:3,3005:4,3006:5,3007:6},xw=new Kg,Aw=function(){for(var e=[],o=[],h=[],m=8,w=0;w<qM;w++){var T=Math.pow(2,m);o.push(T);var R=1/T;4<w?R=JM[w-8+4-1]:w==0&&(R=0),h.push(R),R=1/(T-1),T=-R/2,R=1+R/2;var z=[T,T,R,T,R,R,T,T,R,R,T,R];T=new Float32Array(108),R=new Float32Array(72);for(var k=new Float32Array(36),b=0;6>b;b++){var q=b%3*2/3-1,J=2<b?0:-1;T.set([q,J,0,q+2/3,J,0,q+2/3,J+1,0,q,J,0,q+2/3,J+1,0,q,J+1,0],18*b),R.set(z,12*b),k.set([b,b,b,b,b,b],6*b)}z=new ft,z.setAttribute("position",new ae(T,3)),z.setAttribute("uv",new ae(R,2)),z.setAttribute("faceIndex",new ae(k,1)),e.push(z),4<m&&m--}return{_lodPlanes:e,_sizeLods:o,_sigmas:h}}(),N0=Aw._lodPlanes,KM=Aw._sizeLods,Vx=Aw._sigmas,ww=null,$p=(1+Math.sqrt(5))/2,Am=1/$p,QM=[new _(1,1,1),new _(-1,1,1),new _(1,1,-1),new _(-1,1,-1),new _(0,$p,Am),new _(0,$p,-Am),new _(Am,0,$p),new _(-Am,0,$p),new _($p,Am,0),new _(-$p,Am,0)];U2.prototype={constructor:U2,fromScene:function(e,o,h,m){o===void 0&&(o=0),h===void 0&&(h=.1),m===void 0&&(m=100),ww=this._renderer.getRenderTarget();var w=this._allocateTargets();return this._sceneToCubeUV(e,h,m,w),0<o&&this._blur(w,0,0,o),this._applyPMREM(w),this._cleanup(w),w},fromEquirectangular:function(e){return e.magFilter=1003,e.minFilter=1003,e.generateMipmaps=!1,this.fromCubemap(e)},fromCubemap:function(e){ww=this._renderer.getRenderTarget();var o=this._allocateTargets(e);return this._textureToCubeUV(e,o),this._applyPMREM(o),this._cleanup(o),o},compileCubemapShader:function(){this._cubemapShader===null&&(this._cubemapShader=tM(),this._compileMaterial(this._cubemapShader))},compileEquirectangularShader:function(){this._equirectShader===null&&(this._equirectShader=$_(),this._compileMaterial(this._equirectShader))},dispose:function(){this._blurMaterial.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(var e=0;e<N0.length;e++)N0[e].dispose()},_cleanup:function(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(ww),e.scissorTest=!1,e.setSize(e.width,e.height)},_allocateTargets:function(e){var o=e===void 0||e.type!==1009?!1:e.encoding===3e3||e.encoding===3001||e.encoding===3007;o={magFilter:1003,minFilter:1003,generateMipmaps:!1,type:1009,format:1023,encoding:o?e.encoding:3002,depthBuffer:!1,stencilBuffer:!1};var h=Q_(o);return h.depthBuffer=!e,this._pingPongRenderTarget=Q_(o),h},_compileMaterial:function(e){e=new Tt(N0[0],e),this._renderer.compile(e,xw)},_sceneToCubeUV:function(e,o,h,m){o=new Te(90,1,o,h),h=[1,-1,1,1,1,1];var w=[1,1,1,-1,-1,-1],T=this._renderer,R=T.outputEncoding,z=T.toneMapping,k=T.toneMappingExposure,b=T.getClearColor(),q=T.getClearAlpha();T.toneMapping=1,T.toneMappingExposure=1,T.outputEncoding=3e3;var J=e.background;if(J&&J.isColor){J.convertSRGBToLinear();var Q=Math.min(Math.max(Math.ceil(iA(Math.max(J.r,J.g,J.b))),-128),127);J=J.multiplyScalar(Math.pow(2,-Q)),T.setClearColor(J,(Q+128)/255),e.background=null}for(J=0;6>J;J++)Q=J%3,Q==0?(o.up.set(0,h[J],0),o.lookAt(w[J],0,0)):Q==1?(o.up.set(0,0,h[J]),o.lookAt(0,w[J],0)):(o.up.set(0,h[J],0),o.lookAt(0,0,w[J])),H2(m,Q*th,2<J?th:0,th,th),T.setRenderTarget(m),T.render(e,o);T.toneMapping=z,T.toneMappingExposure=k,T.outputEncoding=R,T.setClearColor(b,q)},_textureToCubeUV:function(e,o){var h=this._renderer;e.isCubeTexture?this._cubemapShader==null&&(this._cubemapShader=tM()):this._equirectShader==null&&(this._equirectShader=$_());var m=e.isCubeTexture?this._cubemapShader:this._equirectShader,w=new Tt(N0[0],m);m=m.uniforms,m.envMap.value=e,e.isCubeTexture||m.texelSize.value.set(1/e.image.width,1/e.image.height),m.inputEncoding.value=eh[e.encoding],m.outputEncoding.value=eh[o.texture.encoding],H2(o,0,0,3*th,2*th),h.setRenderTarget(o),h.render(w,xw)},_applyPMREM:function(e){var o=this._renderer,h=o.autoClear;o.autoClear=!1;for(var m=1;m<qM;m++)this._blur(e,m-1,m,Math.sqrt(Vx[m]*Vx[m]-Vx[m-1]*Vx[m-1]),QM[(m-1)%QM.length]);o.autoClear=h},_blur:function(e,o,h,m,w){var T=this._pingPongRenderTarget;this._halfBlur(e,T,o,h,m,"latitudinal",w),this._halfBlur(T,e,h,h,m,"longitudinal",w)},_halfBlur:function(e,o,h,m,w,T,R){var z=this._renderer,k=this._blurMaterial;T!=="latitudinal"&&T!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");var b=new Tt(N0[m],k);k=k.uniforms;var q=KM[h]-1;q=isFinite(w)?Math.PI/(2*q):2*Math.PI/39;var J=w/q,Q=isFinite(w)?1+Math.floor(3*J):20;20<Q&&console.warn("sigmaRadians, "+w+", is too large and will clip, as it requested "+Q+" samples when the maximum is set to 20"),w=[];for(var K=0,rt=0;20>rt;++rt){var ht=rt/J;ht=Math.exp(-ht*ht/2),w.push(ht),rt==0?K+=ht:rt<Q&&(K+=2*ht)}for(rt=0;rt<w.length;rt++)w[rt]/=K;k.envMap.value=e.texture,k.samples.value=Q,k.weights.value=w,k.latitudinal.value=T==="latitudinal",R&&(k.poleAxis.value=R),k.dTheta.value=q,k.mipInt.value=8-h,k.inputEncoding.value=eh[e.texture.encoding],k.outputEncoding.value=eh[e.texture.encoding],e=KM[m],ht=3*Math.max(0,th-2*e),H2(o,ht,(m===0?0:2*th)+2*e*(4<m?m-8+4:0),3*e,2*e),z.setRenderTarget(o),z.render(b,xw)}},qr.create=function(e,o){return e.prototype=at(qr.prototype),e.prototype.constructor=e,e.prototype.getPoint=o,e},ut(qh.prototype,{createPointsGeometry:function(e){return console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),e=this.getPoints(e),this.createGeometry(e)},createSpacedPointsGeometry:function(e){return console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),e=this.getSpacedPoints(e),this.createGeometry(e)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var o=new pt,h=0,m=e.length;h<m;h++){var w=e[h];o.vertices.push(new _(w.x,w.y,w.z||0))}return o}}),ut($u.prototype,{fromPoints:function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),eM.prototype=at(Ns.prototype),rM.prototype=at(Ns.prototype),b2.prototype=at(Ns.prototype),ut(b2.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),hx.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Vp.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},ut(Mn.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),dw.extractUrlBase(e)}}),Mn.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},ut(ax.prototype,{setTexturePath:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}),ut(N2.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),ut(X.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),ut(tt.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),nr.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},z2.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},ut(Si,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Si.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Si.ceilPowerOfTwo(e)}}),ut(c.prototype,{flattenToArrayOffset:function(e,o){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,o)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),ut(I.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,o){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,o)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new _().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,o,h,m,w,T){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,o,m,h,w,T)}}),xt.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},N.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},ut(ot.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),ut(At.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,o){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,o)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),ut(At,{barycoordFromPoint:function(e,o,h,m,w){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),At.getBarycoord(e,o,h,m,w)},normal:function(e,o,h,m){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),At.getNormal(e,o,h,m)}}),ut(af.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Pp(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Op(this,e)}}),ut(f.prototype,{fromAttribute:function(e,o,h){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,o,h)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),ut(_.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,o){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(o,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,o,h){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,o,h)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),ut(p.prototype,{fromAttribute:function(e,o,h){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,o,h)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),ut(pt.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),ut(F.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,o){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(o,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Xr(F.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),ut(Tt.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Xr(Tt.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Xr(Yv.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Fy.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Oy.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(qr.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),Te.prototype.setLens=function(e,o){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),o!==void 0&&(this.filmGauge=o),this.setFocalLength(e)},Xr(On.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Xr(ae.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===35048},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(35048)}}}),ut(ae.prototype,{setDynamic:function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(e===!0?35048:35044),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),ut(ft.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addAttribute:function(e,o,h){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),o&&o.isBufferAttribute||o&&o.isInterleavedBufferAttribute?e==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(o),this):this.setAttribute(e,o):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new ae(o,h)))},addDrawCall:function(e,o,h){h!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,o)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},applyMatrix:function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Xr(ft.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Xr(x0.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(e){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=e}}}),Xr(F2.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(e){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=e}}}),Xr(Yh.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===35048},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}}),ut(Yh.prototype,{setDynamic:function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(e===!0?35048:35044),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),ut(Xl.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Xr(lx.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Xr(Kt.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new yt}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===1}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Xr(sf.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Xr(de.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),ut(h2.prototype,{clearTarget:function(e,o,h,m){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(o,h,m)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Xr(h2.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=e===!0?3001:3e3}}}),Xr(D_.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Xr(A.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Xr(Qg.prototype,{load:{value:function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var o=this;return new ux().load(e,function(h){o.setBuffer(h)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),R2.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},mr.prototype.updateCubeMap=function(e,o){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,o)},uf.crossOrigin=void 0,uf.loadTexture=function(e,o,h,m){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var w=new Zy;return w.setCrossOrigin(this.crossOrigin),e=w.load(e,h,void 0,m),o&&(e.mapping=o),e},uf.loadTextureCube=function(e,o,h,m){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var w=new Yy;return w.setCrossOrigin(this.crossOrigin),e=w.load(e,h,void 0,m),o&&(e.mapping=o),e},uf.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},uf.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"117"}})),i.ACESFilmicToneMapping=5,i.AddEquation=100,i.AddOperation=2,i.AdditiveAnimationBlendMode=2501,i.AdditiveBlending=2,i.AlphaFormat=1021,i.AlwaysDepth=1,i.AlwaysStencilFunc=519,i.AmbientLight=ex,i.AmbientLightProbe=S2,i.AnimationClip=yu,i.AnimationLoader=v2,i.AnimationMixer=D2,i.AnimationObjectGroup=X_,i.AnimationUtils=eo,i.ArcCurve=qg,i.ArrayCamera=Ey,i.ArrowHelper=Qh,i.Audio=Qg,i.AudioAnalyser=R2,i.AudioContext=mw,i.AudioListener=E2,i.AudioLoader=ux,i.AxesHelper=C0,i.AxisHelper=function(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new C0(e)},i.BackSide=1,i.BasicDepthPacking=3200,i.BasicShadowMap=0,i.BinaryTextureLoader=function(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Xy(e)},i.Bone=c2,i.BooleanKeyframeTrack=by,i.BoundingBoxHelper=function(e,o){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Kh(e,o)},i.Box2=N2,i.Box3=X,i.Box3Helper=_0,i.BoxBufferGeometry=P0,i.BoxGeometry=ow,i.BoxHelper=Kh,i.BufferAttribute=ae,i.BufferGeometry=ft,i.BufferGeometryLoader=sx,i.ByteType=1010,i.Cache=Zp,i.Camera=ie,i.CameraHelper=w0,i.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")},i.CanvasTexture=Zv,i.CatmullRomCurve3=Ns,i.CineonToneMapping=4,i.CircleBufferGeometry=Xg,i.CircleGeometry=d0,i.ClampToEdgeWrapping=1001,i.Clock=I2,i.ClosedSplineCurve3=eM,i.Color=yt,i.ColorKeyframeTrack=Vy,i.CompressedTexture=Og,i.CompressedTextureLoader=y2,i.ConeBufferGeometry=p0,i.ConeGeometry=f0,i.CubeCamera=mr,i.CubeGeometry=ow,i.CubeReflectionMapping=301,i.CubeRefractionMapping=302,i.CubeTexture=mu,i.CubeTextureLoader=Yy,i.CubeUVReflectionMapping=306,i.CubeUVRefractionMapping=307,i.CubicBezierCurve=Ju,i.CubicBezierCurve3=Zl,i.CubicInterpolant=ky,i.CullFaceBack=1,i.CullFaceFront=2,i.CullFaceFrontBack=3,i.CullFaceNone=0,i.Curve=qr,i.CurvePath=qh,i.CustomBlending=5,i.CylinderBufferGeometry=Zh,i.CylinderGeometry=Bp,i.Cylindrical=q_,i.DataTexture=we,i.DataTexture2DArray=Bs,i.DataTexture3D=ea,i.DataTextureLoader=Xy,i.DecrementStencilOp=7683,i.DecrementWrapStencilOp=34056,i.DefaultLoadingManager=FM,i.DepthFormat=1026,i.DepthStencilFormat=1027,i.DepthTexture=Jv,i.DirectionalLight=tx,i.DirectionalLightHelper=rm,i.DirectionalLightShadow=$y,i.DiscreteInterpolant=Gy,i.DodecahedronBufferGeometry=Ug,i.DodecahedronGeometry=e0,i.DoubleSide=2,i.DstAlphaFactor=206,i.DstColorFactor=208,i.DynamicBufferAttribute=function(e,o){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new ae(e,o).setUsage(35048)},i.DynamicCopyUsage=35050,i.DynamicDrawUsage=35048,i.DynamicReadUsage=35049,i.EdgesGeometry=jg,i.EdgesHelper=function(e,o){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new lo(new jg(e.geometry),new to({color:o!==void 0?o:16777215}))},i.EllipseCurve=Ya,i.EqualDepth=4,i.EqualStencilFunc=514,i.EquirectangularReflectionMapping=303,i.EquirectangularRefractionMapping=304,i.Euler=L,i.EventDispatcher=s,i.ExtrudeBufferGeometry=Xl,i.ExtrudeGeometry=Pp,i.Face3=Vt,i.Face4=function(e,o,h,m,w,T,R){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new Vt(e,o,h,w,T,R)},i.FaceColors=1,i.FileLoader=xu,i.FlatShading=1,i.Float32Attribute=function(e,o){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new vt(e,o)},i.Float32BufferAttribute=vt,i.Float64Attribute=function(e,o){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Ct(e,o)},i.Float64BufferAttribute=Ct,i.FloatType=1015,i.Fog=Py,i.FogExp2=Ry,i.Font=M2,i.FontLoader=C2,i.FrontFaceDirectionCCW=1,i.FrontFaceDirectionCW=0,i.FrontSide=0,i.Frustum=nr,i.GammaEncoding=3007,i.Geometry=pt,i.GeometryUtils={merge:function(e,o,h){if(console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),o.isMesh){o.matrixAutoUpdate&&o.updateMatrix();var m=o.matrix;o=o.geometry}e.merge(o,m,h)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},i.GreaterDepth=6,i.GreaterEqualDepth=5,i.GreaterEqualStencilFunc=518,i.GreaterStencilFunc=516,i.GridHelper=hx,i.Group=Pg,i.HalfFloatType=1016,i.HemisphereLight=Jy,i.HemisphereLightHelper=em,i.HemisphereLightProbe=T2,i.IcosahedronBufferGeometry=zg,i.IcosahedronGeometry=t0,i.ImageBitmapLoader=w2,i.ImageLoader=Jg,i.ImageUtils=uf,i.ImmediateRenderObject=A0,i.IncrementStencilOp=7682,i.IncrementWrapStencilOp=34055,i.InstancedBufferAttribute=ox,i.InstancedBufferGeometry=x0,i.InstancedInterleavedBuffer=O2,i.InstancedMesh=By,i.Int16Attribute=function(e,o){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new gi(e,o)},i.Int16BufferAttribute=gi,i.Int32Attribute=function(e,o){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new gt(e,o)},i.Int32BufferAttribute=gt,i.Int8Attribute=function(e,o){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Qe(e,o)},i.Int8BufferAttribute=Qe,i.IntType=1013,i.InterleavedBuffer=Yh,i.InterleavedBufferAttribute=jv,i.Interpolant=Xa,i.InterpolateDiscrete=2300,i.InterpolateLinear=2301,i.InterpolateSmooth=2302,i.InvertStencilOp=5386,i.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")},i.KeepStencilOp=7680,i.KeyframeTrack=fs,i.LOD=Yv,i.LatheBufferGeometry=Wg,i.LatheGeometry=c0,i.Layers=P,i.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")},i.LessDepth=2,i.LessEqualDepth=3,i.LessEqualStencilFunc=515,i.LessStencilFunc=513,i.Light=On,i.LightProbe=Au,i.LightShadow=ql,i.Line=ja,i.Line3=z2,i.LineBasicMaterial=to,i.LineCurve=_a,i.LineCurve3=qu,i.LineDashedMaterial=bp,i.LineLoop=Ny,i.LinePieces=1,i.LineSegments=lo,i.LineStrip=0,i.LinearEncoding=3e3,i.LinearFilter=1006,i.LinearInterpolant=g0,i.LinearMipMapLinearFilter=1008,i.LinearMipMapNearestFilter=1007,i.LinearMipmapLinearFilter=1008,i.LinearMipmapNearestFilter=1007,i.LinearToneMapping=1,i.Loader=Mn,i.LoaderUtils=dw,i.LoadingManager=m2,i.LogLuvEncoding=3003,i.LoopOnce=2200,i.LoopPingPong=2202,i.LoopRepeat=2201,i.LuminanceAlphaFormat=1025,i.LuminanceFormat=1024,i.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},i.Material=Kt,i.MaterialLoader=nx,i.Math=Si,i.MathUtils=Si,i.Matrix3=c,i.Matrix4=I,i.MaxEquation=104,i.Mesh=Tt,i.MeshBasicMaterial=ze,i.MeshDepthMaterial=ef,i.MeshDistanceMaterial=rf,i.MeshFaceMaterial=function(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e},i.MeshLambertMaterial=kp,i.MeshMatcapMaterial=Gp,i.MeshNormalMaterial=Hp,i.MeshPhongMaterial=sf,i.MeshPhysicalMaterial=zp,i.MeshStandardMaterial=Yl,i.MeshToonMaterial=Up,i.MinEquation=103,i.MirroredRepeatWrapping=1002,i.MixOperation=1,i.MultiMaterial=function(e){return e===void 0&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e},i.MultiplyBlending=4,i.MultiplyOperation=0,i.NearestFilter=1003,i.NearestMipMapLinearFilter=1005,i.NearestMipMapNearestFilter=1004,i.NearestMipmapLinearFilter=1005,i.NearestMipmapNearestFilter=1004,i.NeverDepth=0,i.NeverStencilFunc=512,i.NoBlending=0,i.NoColors=0,i.NoToneMapping=0,i.NormalAnimationBlendMode=2500,i.NormalBlending=1,i.NotEqualDepth=7,i.NotEqualStencilFunc=517,i.NumberKeyframeTrack=Yg,i.Object3D=F,i.ObjectLoader=ax,i.ObjectSpaceNormalMap=1,i.OctahedronBufferGeometry=Lp,i.OctahedronGeometry=$v,i.OneFactor=201,i.OneMinusDstAlphaFactor=207,i.OneMinusDstColorFactor=209,i.OneMinusSrcAlphaFactor=205,i.OneMinusSrcColorFactor=203,i.OrthographicCamera=Kg,i.PCFShadowMap=1,i.PCFSoftShadowMap=2,i.PMREMGenerator=U2,i.ParametricBufferGeometry=Bg,i.ParametricGeometry=qv,i.Particle=function(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Xv(e)},i.ParticleBasicMaterial=function(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Zu(e)},i.ParticleSystem=function(e,o){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Dg(e,o)},i.ParticleSystemMaterial=function(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Zu(e)},i.Path=$u,i.PerspectiveCamera=Te,i.Plane=xt,i.PlaneBufferGeometry=Oi,i.PlaneGeometry=$n,i.PlaneHelper=M0,i.PointCloud=function(e,o){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Dg(e,o)},i.PointCloudMaterial=function(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Zu(e)},i.PointLight=Qy,i.PointLightHelper=tm,i.Points=Dg,i.PointsMaterial=Zu,i.PolarGridHelper=cx,i.PolyhedronBufferGeometry=wa,i.PolyhedronGeometry=Kv,i.PositionalAudio=L2,i.PropertyBinding=zs,i.PropertyMixer=P2,i.QuadraticBezierCurve=Ku,i.QuadraticBezierCurve3=Jl,i.Quaternion=N,i.QuaternionKeyframeTrack=m0,i.QuaternionLinearInterpolant=Wy,i.REVISION="117",i.RGBADepthPacking=3201,i.RGBAFormat=1023,i.RGBAIntegerFormat=1033,i.RGBA_ASTC_10x10_Format=37819,i.RGBA_ASTC_10x5_Format=37816,i.RGBA_ASTC_10x6_Format=37817,i.RGBA_ASTC_10x8_Format=37818,i.RGBA_ASTC_12x10_Format=37820,i.RGBA_ASTC_12x12_Format=37821,i.RGBA_ASTC_4x4_Format=37808,i.RGBA_ASTC_5x4_Format=37809,i.RGBA_ASTC_5x5_Format=37810,i.RGBA_ASTC_6x5_Format=37811,i.RGBA_ASTC_6x6_Format=37812,i.RGBA_ASTC_8x5_Format=37813,i.RGBA_ASTC_8x6_Format=37814,i.RGBA_ASTC_8x8_Format=37815,i.RGBA_BPTC_Format=36492,i.RGBA_ETC2_EAC_Format=37496,i.RGBA_PVRTC_2BPPV1_Format=35843,i.RGBA_PVRTC_4BPPV1_Format=35842,i.RGBA_S3TC_DXT1_Format=33777,i.RGBA_S3TC_DXT3_Format=33778,i.RGBA_S3TC_DXT5_Format=33779,i.RGBDEncoding=3006,i.RGBEEncoding=3002,i.RGBEFormat=1023,i.RGBFormat=1022,i.RGBIntegerFormat=1032,i.RGBM16Encoding=3005,i.RGBM7Encoding=3004,i.RGB_ETC1_Format=36196,i.RGB_ETC2_Format=37492,i.RGB_PVRTC_2BPPV1_Format=35841,i.RGB_PVRTC_4BPPV1_Format=35840,i.RGB_S3TC_DXT1_Format=33776,i.RGFormat=1030,i.RGIntegerFormat=1031,i.RawShaderMaterial=Jh,i.Ray=ot,i.Raycaster=F2,i.RectAreaLight=rx,i.RedFormat=1028,i.RedIntegerFormat=1029,i.ReinhardToneMapping=2,i.RepeatWrapping=1e3,i.ReplaceStencilOp=7681,i.ReverseSubtractEquation=102,i.RingBufferGeometry=Vg,i.RingGeometry=h0,i.SRGB8_ALPHA8_ASTC_10x10_Format=37851,i.SRGB8_ALPHA8_ASTC_10x5_Format=37848,i.SRGB8_ALPHA8_ASTC_10x6_Format=37849,i.SRGB8_ALPHA8_ASTC_10x8_Format=37850,i.SRGB8_ALPHA8_ASTC_12x10_Format=37852,i.SRGB8_ALPHA8_ASTC_12x12_Format=37853,i.SRGB8_ALPHA8_ASTC_4x4_Format=37840,i.SRGB8_ALPHA8_ASTC_5x4_Format=37841,i.SRGB8_ALPHA8_ASTC_5x5_Format=37842,i.SRGB8_ALPHA8_ASTC_6x5_Format=37843,i.SRGB8_ALPHA8_ASTC_6x6_Format=37844,i.SRGB8_ALPHA8_ASTC_8x5_Format=37845,i.SRGB8_ALPHA8_ASTC_8x6_Format=37846,i.SRGB8_ALPHA8_ASTC_8x8_Format=37847,i.Scene=W,i.SceneUtils={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}},i.ShaderChunk=Hi,i.ShaderLib=$l,i.ShaderMaterial=de,i.ShadowMaterial=Np,i.Shape=af,i.ShapeBufferGeometry=Fp,i.ShapeGeometry=Op,i.ShapePath=_2,i.ShapeUtils=nc,i.ShortType=1011,i.Skeleton=Fy,i.SkeletonHelper=Vp,i.SkinnedMesh=Oy,i.SmoothShading=2,i.Sphere=tt,i.SphereBufferGeometry=Dp,i.SphereGeometry=l0,i.Spherical=J_,i.SphericalHarmonics3=ix,i.SphericalReflectionMapping=305,i.Spline=b2,i.SplineCurve=Qu,i.SplineCurve3=rM,i.SpotLight=Ky,i.SpotLightHelper=$g,i.SpotLightShadow=qy,i.Sprite=Xv,i.SpriteMaterial=nf,i.SrcAlphaFactor=204,i.SrcAlphaSaturateFactor=210,i.SrcColorFactor=202,i.StaticCopyUsage=35046,i.StaticDrawUsage=35044,i.StaticReadUsage=35045,i.StereoCamera=W_,i.StreamCopyUsage=35042,i.StreamDrawUsage=35040,i.StreamReadUsage=35041,i.StringKeyframeTrack=jy,i.SubtractEquation=101,i.SubtractiveBlending=3,i.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},i.TangentSpaceNormalMap=0,i.TetrahedronBufferGeometry=Ng,i.TetrahedronGeometry=Qv,i.TextBufferGeometry=bg,i.TextGeometry=u0,i.Texture=g,i.TextureLoader=Zy,i.TorusBufferGeometry=kg,i.TorusGeometry=n0,i.TorusKnotBufferGeometry=Hg,i.TorusKnotGeometry=i0,i.Triangle=At,i.TriangleFanDrawMode=2,i.TriangleStripDrawMode=1,i.TrianglesDrawMode=0,i.TubeBufferGeometry=Rp,i.TubeGeometry=r0,i.UVMapping=300,i.Uint16Attribute=function(e,o){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new hr(e,o)},i.Uint16BufferAttribute=hr,i.Uint32Attribute=function(e,o){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new mt(e,o)},i.Uint32BufferAttribute=mt,i.Uint8Attribute=function(e,o){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new gr(e,o)},i.Uint8BufferAttribute=gr,i.Uint8ClampedAttribute=function(e,o){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new ir(e,o)},i.Uint8ClampedBufferAttribute=ir,i.Uncharted2ToneMapping=3,i.Uniform=lx,i.UniformsLib=cr,i.UniformsUtils=pM,i.UnsignedByteType=1009,i.UnsignedInt248Type=1020,i.UnsignedIntType=1014,i.UnsignedShort4444Type=1017,i.UnsignedShort5551Type=1018,i.UnsignedShort565Type=1019,i.UnsignedShortType=1012,i.VSMShadowMap=3,i.Vector2=f,i.Vector3=_,i.Vector4=p,i.VectorKeyframeTrack=Zg,i.Vertex=function(e,o,h){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new _(e,o,h)},i.VertexColors=2,i.VideoTexture=p2,i.WebGLCubeRenderTarget=Nr,i.WebGLMultisampleRenderTarget=S,i.WebGLRenderTarget=A,i.WebGLRenderTargetCube=function(e,o,h){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Nr(e,h)},i.WebGLRenderer=h2,i.WebGLUtils=O_,i.WireframeGeometry=Fg,i.WireframeHelper=function(e,o){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new lo(new Fg(e.geometry),new to({color:o!==void 0?o:16777215}))},i.WrapAroundEnding=2402,i.XHRLoader=function(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new xu(e)},i.ZeroCurvatureEnding=2400,i.ZeroFactor=200,i.ZeroSlopeEnding=2401,i.ZeroStencilOp=0,i.sRGBEncoding=3001,Object.defineProperty(i,"__esModule",{value:!0})})}),un=Nt(m_),v_=function(t){function r(i){return Ji(this,r),i=jn(this,(r.__proto__||Mo(r)).call(this,i)),i.layerType="ThreeLayer",i}return Co(r,t),Cn(r,[{key:"initialize",value:function(i){this.getOptions();var s=this.webglLayer.map.map;this.webglLayer.map.type==="three"?(this.camera=s.camera,this.scene=s.scene):(this.camera=new un.PerspectiveCamera,this.scene=new un.Scene),this.world=new un.Group,this.scene.add(this.world),this.webglLayer.map.type!=="three"&&(this.camera.matrixAutoUpdate=!1,this.world.matrixAutoUpdate=!1,this.renderer=new un.WebGLRenderer({alpha:!0,antialias:!0,canvas:i.canvas,context:i}),this.renderer.autoClear=!1,this.renderer.outputEncoding=un.sRGBEncoding)}},{key:"_add",value:function(i,s){var f=[0,0];if(this.getOptions().enabledPointOffset===!0&&(f=this.getPointOffset()),s){var c=new un.Group;return c.isGeoGroup=!0,c.object=i,c.point=s,c.add(i),c.position.x=s.lng-f[0],c.position.y=s.lat-f[1],c.position.z=i.position.z,this.world.add(c),c}return this.world.add(i),i}},{key:"add",value:function(i,s){return i=this._add(i,s),this.update(),i}},{key:"update",value:function(){this.webglLayer.render()}},{key:"getCamera",value:function(){return this.camera}},{key:"getScene",value:function(){return this.scene}},{key:"getRenderer",value:function(){return this.renderer}},{key:"getWorld",value:function(){return this.world}},{key:"updatePoint",value:function(i,s){for(var f=this.world.children,c=0;c<f.length;c++)if(f[c].isGeoGroup&&f[c].object===i){var g=f[c];g.position.x=s.lng,g.position.y=s.lat,g.position.z=i.position.z}}},{key:"remove",value:function(i){this.world.remove(i);for(var s=this.world.children,f=0;f<s.length;f++)s[f].children&&0<s[f].children.length&&s[f].children[0]===i&&this.world.remove(s[f]);this.update()}},{key:"updateCamera",value:function(){if(!this.getOptions().notUpdateSize){var i=this.world,s=this.map.getZoomUnits();i=i.children;for(var f=0;f<i.length;f++)i[f].point&&i[f].scale.set(s,s,s)}}},{key:"render",value:function(i){var s=this.getOptions();if(i){if(!this.webglLayer.map.map.camera){this.updateCamera();var f=this.getPointOffset(),c=new un.Matrix4().fromArray(i.viewMatrix);this.camera.projectionMatrix=new un.Matrix4().fromArray(i.projectionMatrix),this.camera.projectionMatrixInverse.getInverse(this.camera.projectionMatrix),s.enabledPointOffset===!0?this.world.matrix=c:(i=new un.Matrix4().makeTranslation(-f[0],-f[1],0),this.world.matrix=c.multiply(i)),this.renderer.state.reset(),this.postProcessing?this.postProcessing.render():this.renderer.render(this.scene,this.camera)}}else this.update()}}]),r}(KC),n2=function(t){function r(i){Ji(this,r);var s=jn(this,(r.__proto__||Mo(r)).call(this,i));return s.layerType="threeLayer",s.setOptions(i),s}return Co(r,t),Cn(r,[{key:"getCommonDefaultOptions",value:function(){return{zIndex:0,zoomThreshold:[0,30]}}},{key:"setWebglLayer",value:function(i){i.threeLayer||(i.threeLayer=new v_({enabledPointOffset:!0,webglLayer:i})),this.threeLayer=i.threeLayer}},{key:"getPointOffset",value:function(){return this.threeLayer.getPointOffset()}},{key:"getThreeLayer",value:function(){return this.threeLayer}}]),r}(g_),Lg={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`varying vec2 vUv;
void main() {
	vUv = uv;
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,fragmentShader:`uniform float opacity;
uniform sampler2D tDiffuse;
varying vec2 vUv;
void main() {
	vec4 texel = texture2D( tDiffuse, vUv );
	gl_FragColor = opacity * texel;
}`};ut(Wn.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),Wn.FullScreenQuad=function(){var t=new Ba(-1,1,1,-1,0,1),r=new br(2,2),i=function(s){this._mesh=new dn(r,s)};return Object.defineProperty(i.prototype,"material",{get:function(){return this._mesh.material},set:function(s){this._mesh.material=s}}),ut(i.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(s){s.render(this._mesh,t)}}),i}();var _y=function(t,r){Wn.call(this),this.textureID=r!==void 0?r:"tDiffuse",t instanceof $e?(this.uniforms=t.uniforms,this.material=t):t&&(this.uniforms=xp.clone(t.uniforms),this.material=new $e({defines:ut({},t.defines),uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader})),this.fsQuad=new Wn.FullScreenQuad(this.material)};_y.prototype=ut(at(Wn.prototype),{constructor:_y,render:function(t,r,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?t.setRenderTarget(null):(t.setRenderTarget(r),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil)),this.fsQuad.render(t)}});var My=function(t,r){Wn.call(this),this.scene=t,this.camera=r,this.clear=!0,this.inverse=this.needsSwap=!1};My.prototype=ut(at(Wn.prototype),{constructor:My,render:function(t,r,i){var s=t.getContext(),f=t.state;if(f.buffers.color.setMask(!1),f.buffers.depth.setMask(!1),f.buffers.color.setLocked(!0),f.buffers.depth.setLocked(!0),this.inverse)var c=0,g=1;else c=1,g=0;f.buffers.stencil.setTest(!0),f.buffers.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),f.buffers.stencil.setFunc(s.ALWAYS,c,4294967295),f.buffers.stencil.setClear(g),f.buffers.stencil.setLocked(!0),t.setRenderTarget(i),this.clear&&t.clear(),t.render(this.scene,this.camera),t.setRenderTarget(r),this.clear&&t.clear(),t.render(this.scene,this.camera),f.buffers.color.setLocked(!1),f.buffers.depth.setLocked(!1),f.buffers.stencil.setLocked(!1),f.buffers.stencil.setFunc(s.EQUAL,1,4294967295),f.buffers.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),f.buffers.stencil.setLocked(!0)}});var o2=function(){Wn.call(this),this.needsSwap=!1};o2.prototype=at(Wn.prototype),ut(o2.prototype,{render:function(t){t.state.buffers.stencil.setLocked(!1),t.state.buffers.stencil.setTest(!1)}});var y_=function(t,r){this.renderer=t,r===void 0?(r=t.getSize(new st),this._pixelRatio=t.getPixelRatio(),this._width=r.width,this._height=r.height,r=new bt(this._width*this._pixelRatio,this._height*this._pixelRatio,{minFilter:1006,magFilter:1006,format:1023,stencilBuffer:!1}),r.texture.name="EffectComposer.rt1"):(this._pixelRatio=1,this._width=r.width,this._height=r.height),this.renderTarget1=r,this.renderTarget2=r.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],Lg===void 0&&console.error("THREE.EffectComposer relies on CopyShader"),_y===void 0&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new _y(Lg),this.clock=new Eu};ut(y_.prototype,{swapBuffers:function(){var t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t},addPass:function(t){this.passes.push(t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)},insertPass:function(t,r){this.passes.splice(r,0,t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)},isLastEnabledPass:function(t){for(t+=1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0},render:function(t){t===void 0&&(t=this.clock.getDelta());var r=this.renderer.getRenderTarget(),i=!1,s,f=this.passes.length;for(s=0;s<f;s++){var c=this.passes[s];if(c.enabled!==!1){if(c.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(s),c.render(this.renderer,this.writeBuffer,this.readBuffer,t,i),c.needsSwap){if(i){var g=this.renderer.getContext(),p=this.renderer.state.buffers.stencil;p.setFunc(g.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,t),p.setFunc(g.EQUAL,1,4294967295)}this.swapBuffers()}My!==void 0&&(c instanceof My?i=!0:c instanceof o2&&(i=!1))}}this.renderer.setRenderTarget(r)},reset:function(t){t===void 0&&(t=this.renderer.getSize(new st),this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,t=this.renderTarget1.clone(),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)),this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=t,this.renderTarget2=t.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(t,r){this._width=t,this._height=r,t=this._width*this._pixelRatio,r=this._height*this._pixelRatio,this.renderTarget1.setSize(t,r),this.renderTarget2.setSize(t,r);for(var i=0;i<this.passes.length;i++)this.passes[i].setSize(t,r)},setPixelRatio:function(t){this._pixelRatio=t,this.setSize(this._width,this._height)}});var x_=function(){this.needsSwap=this.enabled=!0,this.renderToScreen=this.clear=!1};ut(x_.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),x_.FullScreenQuad=function(){var t=new Ba(-1,1,1,-1,0,1),r=new br(2,2),i=function(s){this._mesh=new dn(r,s)};return Object.defineProperty(i.prototype,"material",{get:function(){return this._mesh.material},set:function(s){this._mesh.material=s}}),ut(i.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(s){s.render(this._mesh,t)}}),i}();var Gv=function(t,r,i,s,f){Wn.call(this),this.scene=t,this.camera=r,this.overrideMaterial=i,this.clearColor=s,this.clearAlpha=f!==void 0?f:0,this.clear=!0,this.needsSwap=this.clearDepth=!1};Gv.prototype=ut(at(Wn.prototype),{constructor:Gv,render:function(t,r,i){if(r=t.autoClear,t.autoClear=!1,this.overrideMaterial!==void 0){var s=this.scene.overrideMaterial;this.scene.overrideMaterial=this.overrideMaterial}if(this.clearColor){var f=t.getClearColor().getHex(),c=t.getClearAlpha();t.setClearColor(this.clearColor,this.clearAlpha)}this.clearDepth&&t.clearDepth(),t.setRenderTarget(this.renderToScreen?null:i),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),t.render(this.scene,this.camera),this.clearColor&&t.setClearColor(f,c),this.overrideMaterial!==void 0&&(this.scene.overrideMaterial=s),t.autoClear=r}});var bv={defines:{SMAA_THRESHOLD:"0.1"},uniforms:{tDiffuse:{value:null},resolution:{value:new st(1/1024,1/512)}},vertexShader:`uniform vec2 resolution;
varying vec2 vUv;
varying vec4 vOffset[ 3 ];
void SMAAEdgeDetectionVS( vec2 texcoord ) {
	vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 );
	vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 );
	vOffset[ 2 ] = texcoord.xyxy + resolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 );
}
void main() {
	vUv = uv;
	SMAAEdgeDetectionVS( vUv );
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D tDiffuse;
varying vec2 vUv;
varying vec4 vOffset[ 3 ];
vec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {
	vec2 threshold = vec2( SMAA_THRESHOLD, SMAA_THRESHOLD );
	vec4 delta;
	vec3 C = texture2D( colorTex, texcoord ).rgb;
	vec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;
	vec3 t = abs( C - Cleft );
	delta.x = max( max( t.r, t.g ), t.b );
	vec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;
	t = abs( C - Ctop );
	delta.y = max( max( t.r, t.g ), t.b );
	vec2 edges = step( threshold, delta.xy );
	if ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )
		discard;
	vec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;
	t = abs( C - Cright );
	delta.z = max( max( t.r, t.g ), t.b );
	vec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;
	t = abs( C - Cbottom );
	delta.w = max( max( t.r, t.g ), t.b );
	float maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );
	vec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;
	t = abs( C - Cleftleft );
	delta.z = max( max( t.r, t.g ), t.b );
	vec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;
	t = abs( C - Ctoptop );
	delta.w = max( max( t.r, t.g ), t.b );
	maxDelta = max( max( maxDelta, delta.z ), delta.w );
	edges.xy *= step( 0.5 * maxDelta, delta.xy );
	return vec4( edges, 0.0, 0.0 );
}
void main() {
	gl_FragColor = SMAAColorEdgeDetectionPS( vUv, vOffset, tDiffuse );
}`},QC={SMAA_MAX_SEARCH_STEPS:"8",SMAA_AREATEX_MAX_DISTANCE:"16",SMAA_AREATEX_PIXEL_SIZE:"( 1.0 / vec2( 160.0, 560.0 ) )",SMAA_AREATEX_SUBTEX_SIZE:"( 1.0 / 7.0 )"},$C={tDiffuse:{value:null},tArea:{value:null},tSearch:{value:null},resolution:{value:new st(1/1024,1/512)}},t3={tDiffuse:{value:null},tColor:{value:null},resolution:{value:new st(1/1024,1/512)}},s2=function(t,r){Wn.call(this),this.edgesRT=new bt(t,r,{depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1,minFilter:1006,format:1022}),this.edgesRT.texture.name="SMAAPass.edges",this.weightsRT=new bt(t,r,{depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1,minFilter:1006,format:1023}),this.weightsRT.texture.name="SMAAPass.weights";var i=this,s=new Image;s.src=this.getAreaTexture(),s.onload=function(){i.areaTexture.needsUpdate=!0},this.areaTexture=new Pt,this.areaTexture.name="SMAAPass.area",this.areaTexture.image=s,this.areaTexture.format=1022,this.areaTexture.minFilter=1006,this.areaTexture.generateMipmaps=!1,this.areaTexture.flipY=!1,s=new Image,s.src=this.getSearchTexture(),s.onload=function(){i.searchTexture.needsUpdate=!0},this.searchTexture=new Pt,this.searchTexture.name="SMAAPass.search",this.searchTexture.image=s,this.searchTexture.magFilter=1003,this.searchTexture.minFilter=1003,this.searchTexture.generateMipmaps=!1,this.searchTexture.flipY=!1,bv===void 0&&console.error("SMAAPass relies on SMAAShader"),this.uniformsEdges=xp.clone(bv.uniforms),this.uniformsEdges.resolution.value.set(1/t,1/r),this.materialEdges=new $e({defines:ut({},bv.defines),uniforms:this.uniformsEdges,vertexShader:bv.vertexShader,fragmentShader:bv.fragmentShader}),this.uniformsWeights=xp.clone($C),this.uniformsWeights.resolution.value.set(1/t,1/r),this.uniformsWeights.tDiffuse.value=this.edgesRT.texture,this.uniformsWeights.tArea.value=this.areaTexture,this.uniformsWeights.tSearch.value=this.searchTexture,this.materialWeights=new $e({defines:ut({},QC),uniforms:this.uniformsWeights,vertexShader:`uniform vec2 resolution;
varying vec2 vUv;
varying vec4 vOffset[ 3 ];
varying vec2 vPixcoord;
void SMAABlendingWeightCalculationVS( vec2 texcoord ) {
	vPixcoord = texcoord / resolution;
	vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 );
	vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 );
	vOffset[ 2 ] = vec4( vOffset[ 0 ].xz, vOffset[ 1 ].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * resolution.xxyy * float( SMAA_MAX_SEARCH_STEPS );
}
void main() {
	vUv = uv;
	SMAABlendingWeightCalculationVS( vUv );
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,fragmentShader:`#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )
uniform sampler2D tDiffuse;
uniform sampler2D tArea;
uniform sampler2D tSearch;
uniform vec2 resolution;
varying vec2 vUv;
varying vec4 vOffset[3];
varying vec2 vPixcoord;
#if __VERSION__ == 100
vec2 round( vec2 x ) {
	return sign( x ) * floor( abs( x ) + 0.5 );
}
#endif
float SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {
	e.r = bias + e.r * scale;
	return 255.0 * texture2D( searchTex, e, 0.0 ).r;
}
float SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
	vec2 e = vec2( 0.0, 1.0 );
	for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {
		e = texture2D( edgesTex, texcoord, 0.0 ).rg;
		texcoord -= vec2( 2.0, 0.0 ) * resolution;
		if ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;
	}
	texcoord.x += 0.25 * resolution.x;
	texcoord.x += resolution.x;
	texcoord.x += 2.0 * resolution.x;
	texcoord.x -= resolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);
	return texcoord.x;
}
float SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
	vec2 e = vec2( 0.0, 1.0 );
	for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {
		e = texture2D( edgesTex, texcoord, 0.0 ).rg;
		texcoord += vec2( 2.0, 0.0 ) * resolution;
		if ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;
	}
	texcoord.x -= 0.25 * resolution.x;
	texcoord.x -= resolution.x;
	texcoord.x -= 2.0 * resolution.x;
	texcoord.x += resolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );
	return texcoord.x;
}
float SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
	vec2 e = vec2( 1.0, 0.0 );
	for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {
		e = texture2D( edgesTex, texcoord, 0.0 ).rg;
		texcoord += vec2( 0.0, 2.0 ) * resolution;
		if ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;
	}
	texcoord.y -= 0.25 * resolution.y;
	texcoord.y -= resolution.y;
	texcoord.y -= 2.0 * resolution.y;
	texcoord.y += resolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 );
	return texcoord.y;
}
float SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
	vec2 e = vec2( 1.0, 0.0 );
	for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {
		e = texture2D( edgesTex, texcoord, 0.0 ).rg;
		texcoord -= vec2( 0.0, 2.0 ) * resolution;
		if ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;
	}
	texcoord.y += 0.25 * resolution.y;
	texcoord.y += resolution.y;
	texcoord.y += 2.0 * resolution.y;
	texcoord.y -= resolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 );
	return texcoord.y;
}
vec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {
	vec2 texcoord = float( SMAA_AREATEX_MAX_DISTANCE ) * round( 4.0 * vec2( e1, e2 ) ) + dist;
	texcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );
	texcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;
	return texture2D( areaTex, texcoord, 0.0 ).rg;
}
vec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {
	vec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );
	vec2 e = texture2D( edgesTex, texcoord ).rg;
	if ( e.g > 0.0 ) {
		vec2 d;
		vec2 coords;
		coords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );
		coords.y = offset[ 1 ].y;
		d.x = coords.x;
		float e1 = texture2D( edgesTex, coords, 0.0 ).r;
		coords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );
		d.y = coords.x;
		d = d / resolution.x - pixcoord.x;
		vec2 sqrt_d = sqrt( abs( d ) );
		coords.y -= 1.0 * resolution.y;
		float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 1, 0 ) ).r;
		weights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );
	}
	if ( e.r > 0.0 ) {
		vec2 d;
		vec2 coords;
		coords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );
		coords.x = offset[ 0 ].x;
		d.x = coords.y;
		float e1 = texture2D( edgesTex, coords, 0.0 ).g;
		coords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );
		d.y = coords.y;
		d = d / resolution.y - pixcoord.y;
		vec2 sqrt_d = sqrt( abs( d ) );
		coords.y -= 1.0 * resolution.y;
		float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 0, 1 ) ).g;
		weights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );
	}
	return weights;
}
void main() {
	gl_FragColor = SMAABlendingWeightCalculationPS( vUv, vPixcoord, vOffset, tDiffuse, tArea, tSearch, ivec4( 0.0 ) );
}`}),this.uniformsBlend=xp.clone(t3),this.uniformsBlend.resolution.value.set(1/t,1/r),this.uniformsBlend.tDiffuse.value=this.weightsRT.texture,this.materialBlend=new $e({uniforms:this.uniformsBlend,vertexShader:`uniform vec2 resolution;
varying vec2 vUv;
varying vec4 vOffset[ 2 ];
void SMAANeighborhoodBlendingVS( vec2 texcoord ) {
	vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 );
	vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 );
}
void main() {
	vUv = uv;
	SMAANeighborhoodBlendingVS( vUv );
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D tDiffuse;
uniform sampler2D tColor;
uniform vec2 resolution;
varying vec2 vUv;
varying vec4 vOffset[ 2 ];
vec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {
	vec4 a;
	a.xz = texture2D( blendTex, texcoord ).xz;
	a.y = texture2D( blendTex, offset[ 1 ].zw ).g;
	a.w = texture2D( blendTex, offset[ 1 ].xy ).a;
	if ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {
		return texture2D( colorTex, texcoord, 0.0 );
	} else {
		vec2 offset;
		offset.x = a.a > a.b ? a.a : -a.b;
		offset.y = a.g > a.r ? -a.g : a.r;
		if ( abs( offset.x ) > abs( offset.y )) {
			offset.y = 0.0;
		} else {
			offset.x = 0.0;
		}
		vec4 C = texture2D( colorTex, texcoord, 0.0 );
		texcoord += sign( offset ) * resolution;
		vec4 Cop = texture2D( colorTex, texcoord, 0.0 );
		float s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );
		C.xyz = pow(C.xyz, vec3(2.2));
		Cop.xyz = pow(Cop.xyz, vec3(2.2));
		vec4 mixed = mix(C, Cop, s);
		mixed.xyz = pow(mixed.xyz, vec3(1.0 / 2.2));
		return mixed;
	}
}
void main() {
	gl_FragColor = SMAANeighborhoodBlendingPS( vUv, vOffset, tColor, tDiffuse );
}`}),this.needsSwap=!1,this.fsQuad=new Wn.FullScreenQuad(null)};s2.prototype=ut(at(Wn.prototype),{constructor:s2,render:function(t,r,i){this.uniformsEdges.tDiffuse.value=i.texture,this.fsQuad.material=this.materialEdges,t.setRenderTarget(this.edgesRT),this.clear&&t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.materialWeights,t.setRenderTarget(this.weightsRT),this.clear&&t.clear(),this.fsQuad.render(t),this.uniformsBlend.tColor.value=i.texture,this.fsQuad.material=this.materialBlend,this.renderToScreen?t.setRenderTarget(null):(t.setRenderTarget(r),this.clear&&t.clear()),this.fsQuad.render(t)},setSize:function(t,r){this.edgesRT.setSize(t,r),this.weightsRT.setSize(t,r),this.materialEdges.uniforms.resolution.value.set(1/t,1/r),this.materialWeights.uniforms.resolution.value.set(1/t,1/r),this.materialBlend.uniforms.resolution.value.set(1/t,1/r)},getAreaTexture:function(){return"data:image/png;base64,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"},getSearchTexture:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII="}});var Cy={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new Ue(0)},defaultOpacity:{value:0}},vertexShader:`varying vec2 vUv;
void main() {
	vUv = uv;
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D tDiffuse;
uniform vec3 defaultColor;
uniform float defaultOpacity;
uniform float luminosityThreshold;
uniform float smoothWidth;
varying vec2 vUv;
void main() {
	vec4 texel = texture2D( tDiffuse, vUv );
	vec3 luma = vec3( 0.299, 0.587, 0.114 );
	float v = dot( texel.xyz, luma );
	vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );
	float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );
	gl_FragColor = mix( outputColor, texel, alpha );
}`},Qc=function(t,r,i,s){Wn.call(this),this.strength=r!==void 0?r:1,this.radius=i,this.threshold=s,this.resolution=t!==void 0?new st(t.x,t.y):new st(256,256),this.clearColor=new Ue(0,0,0);var f={minFilter:1006,magFilter:1006,format:1023};this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5,t=Math.round(this.resolution.x/2),i=Math.round(this.resolution.y/2),this.renderTargetBright=new bt(t,i,f),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(var c=0;c<this.nMips;c++){var g=new bt(t,i,f);g.texture.name="UnrealBloomPass.h"+c,g.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(g),g=new bt(t,i,f),g.texture.name="UnrealBloomPass.v"+c,g.texture.generateMipmaps=!1,this.renderTargetsVertical.push(g),t=Math.round(t/2),i=Math.round(i/2)}for(Cy===void 0&&console.error("UnrealBloomPass relies on LuminosityHighPassShader"),this.highPassUniforms=xp.clone(Cy.uniforms),this.highPassUniforms.luminosityThreshold.value=s,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new $e({uniforms:this.highPassUniforms,vertexShader:Cy.vertexShader,fragmentShader:Cy.fragmentShader,defines:{}}),this.separableBlurMaterials=[],s=[3,5,7,9,11],t=Math.round(this.resolution.x/2),i=Math.round(this.resolution.y/2),c=0;c<this.nMips;c++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(s[c])),this.separableBlurMaterials[c].uniforms.texSize.value=new st(t,i),t=Math.round(t/2),i=Math.round(i/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=r,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0,this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new lt(1,1,1),new lt(1,1,1),new lt(1,1,1),new lt(1,1,1),new lt(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,Lg===void 0&&console.error("UnrealBloomPass relies on CopyShader"),this.copyUniforms=xp.clone(Lg.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new $e({uniforms:this.copyUniforms,vertexShader:Lg.vertexShader,fragmentShader:Lg.fragmentShader,blending:2,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new Ue,this.oldClearAlpha=1,this.basic=new ro,this.fsQuad=new Wn.FullScreenQuad(null)};Qc.prototype=ut(at(Wn.prototype),{constructor:Qc,dispose:function(){for(var t=0;t<this.renderTargetsHorizontal.length;t++)this.renderTargetsHorizontal[t].dispose();for(t=0;t<this.renderTargetsVertical.length;t++)this.renderTargetsVertical[t].dispose();this.renderTargetBright.dispose()},setSize:function(t,r){t=Math.round(t/2),r=Math.round(r/2),this.renderTargetBright.setSize(t,r);for(var i=0;i<this.nMips;i++)this.renderTargetsHorizontal[i].setSize(t,r),this.renderTargetsVertical[i].setSize(t,r),this.separableBlurMaterials[i].uniforms.texSize.value=new st(t,r),t=Math.round(t/2),r=Math.round(r/2)},render:function(t,r,i,s,f){this.oldClearColor.copy(t.getClearColor()),this.oldClearAlpha=t.getClearAlpha(),r=t.autoClear,t.autoClear=!1,t.setClearColor(this.clearColor,0),f&&t.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=i.texture,t.setRenderTarget(null),t.clear(),this.fsQuad.render(t)),this.highPassUniforms.tDiffuse.value=i.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,t.setRenderTarget(this.renderTargetBright),t.clear(),this.fsQuad.render(t),s=this.renderTargetBright;for(var c=0;c<this.nMips;c++)this.fsQuad.material=this.separableBlurMaterials[c],this.separableBlurMaterials[c].uniforms.colorTexture.value=s.texture,this.separableBlurMaterials[c].uniforms.direction.value=Qc.BlurDirectionX,t.setRenderTarget(this.renderTargetsHorizontal[c]),t.clear(),this.fsQuad.render(t),this.separableBlurMaterials[c].uniforms.colorTexture.value=this.renderTargetsHorizontal[c].texture,this.separableBlurMaterials[c].uniforms.direction.value=Qc.BlurDirectionY,t.setRenderTarget(this.renderTargetsVertical[c]),t.clear(),this.fsQuad.render(t),s=this.renderTargetsVertical[c];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,t.setRenderTarget(this.renderTargetsHorizontal[0]),t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,f&&t.state.buffers.stencil.setTest(!0),this.renderToScreen?t.setRenderTarget(null):t.setRenderTarget(i),this.fsQuad.render(t),t.setClearColor(this.oldClearColor,this.oldClearAlpha),t.autoClear=r},getSeperableBlurMaterial:function(t){return new $e({defines:{KERNEL_RADIUS:t,SIGMA:t},uniforms:{colorTexture:{value:null},texSize:{value:new st(.5,.5)},direction:{value:new st(.5,.5)}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 texSize;				uniform vec2 direction;								float gaussianPdf(in float x, in float sigma) {					return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;				}				void main() {
					vec2 invSize = 1.0 / texSize;					float fSigma = float(SIGMA);					float weightSum = gaussianPdf(0.0, fSigma);					vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;					for( int i = 1; i < KERNEL_RADIUS; i ++ ) {						float x = float(i);						float w = gaussianPdf(x, fSigma);						vec2 uvOffset = direction * invSize * x;						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;						diffuseSum += (sample1 + sample2) * w;						weightSum += 2.0 * w;					}					gl_FragColor = vec4(diffuseSum/weightSum, 1.0);
				}`})},getCompositeMaterial:function(t){return new $e({defines:{NUM_MIPS:t},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:"varying vec2 vUv;				uniform sampler2D blurTexture1;				uniform sampler2D blurTexture2;				uniform sampler2D blurTexture3;				uniform sampler2D blurTexture4;				uniform sampler2D blurTexture5;				uniform sampler2D dirtTexture;				uniform float bloomStrength;				uniform float bloomRadius;				uniform float bloomFactors[NUM_MIPS];				uniform vec3 bloomTintColors[NUM_MIPS];								float lerpBloomFactor(const in float factor) { 					float mirrorFactor = 1.2 - factor;					return mix(factor, mirrorFactor, bloomRadius);				}								void main() {					gl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) + 													 lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) + 													 lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) + 													 lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) + 													 lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );				}"})}}),Qc.BlurDirectionX=new st(1,0),Qc.BlurDirectionY=new st(0,1);var e3=function(t){function r(i){return Ji(this,r),jn(this,(r.__proto__||Mo(r)).call(this,i))}return Co(r,t),Cn(r,[{key:"initialize",value:function(i){var s=i.camera,f=i.renderer;if(!this._initialize){if(this.scene=i.scene,this.camera=s,this.renderer=f,i=this.options.passes,this._initialize=!0,this.renderScene=new Gv(this.scene,this.camera),s=new y_(this.renderer),s.addPass(this.renderScene),this.passes=[],i)for(var c=0;c<i.length;c++){var g=i[c],p=void 0;switch(g.name){case"unrealBloom":p=g.strength||1;var A=g.radius||0,S=g.threshold||.5;p=new Qc(new qc.Vector2(window.innerWidth*f.getPixelRatio(),window.innerHeight*f.getPixelRatio()),p,A,S);break;case"SMAA":p=new s2(window.innerWidth*f.getPixelRatio(),window.innerHeight*f.getPixelRatio())}if(p){for(var N in g)p[N]=g[N];s.addPass(p)}}this.composer=s}}},{key:"addRender",value:function(i){this.renderScene&&this.renderScene.addRender(i)}},{key:"render",value:function(){this.composer.render(this.scene,this.camera)}}]),r}(n2);Qc.prototype.getSeperableBlurMaterial=function(t){return new qc.ShaderMaterial({defines:{KERNEL_RADIUS:t,SIGMA:t},uniforms:{colorTexture:{value:null},texSize:{value:new qc.Vector2(.5,.5)},direction:{value:new qc.Vector2(.5,.5)}},vertexShader:`varying vec2 vUv;
            void main() {
                vUv = uv;
                gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
            }`,fragmentShader:`#include <common>            varying vec2 vUv;
            uniform sampler2D colorTexture;
            uniform vec2 texSize;            uniform vec2 direction;                        float gaussianPdf(in float x, in float sigma) {                return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;            }            void main() {
                vec2 invSize = 1.0 / texSize;                float fSigma = float(SIGMA);                float weightSum = gaussianPdf(0.0, fSigma);                vec4 diffuseSum = texture2D( colorTexture, vUv).rgba * weightSum;                for( int i = 1; i < KERNEL_RADIUS; i ++ ) {                    float x = float(i);                    float w = gaussianPdf(x, fSigma);                    vec2 uvOffset = direction * invSize * x;                    vec4 sample1 = texture2D( colorTexture, vUv + uvOffset).rgba;                    vec4 sample2 = texture2D( colorTexture, vUv - uvOffset).rgba;                    diffuseSum += (sample1 + sample2) * w;                    weightSum += 2.0 * w;                }                gl_FragColor = vec4(diffuseSum/weightSum);
            }`})},Gv.prototype.addRender=function(t){this.renderCbk=t},Gv.prototype.render=function(t,r,i){if(r=t.autoClear,t.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial,this.clearColor){var s=t.getClearColor().getHex(),f=t.getClearAlpha();t.setClearColor(this.clearColor,this.clearAlpha)}this.clearDepth&&t.clearDepth(),t.setRenderTarget(this.renderToScreen?null:i),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),t.render(this.scene,this.camera),this.renderCbk&&this.renderCbk(),this.clearColor&&t.setClearColor(s,f),this.scene.overrideMaterial=null,t.autoClear=r};var r3=function(t){function r(i){return Ji(this,r),i=jn(this,(r.__proto__||Mo(r)).call(this,i)),i.time=0,i.autoUpdate=!0,i}return Co(r,t),Cn(r,[{key:"getDefaultOptions",value:function(){return{totalRadian:Math.PI,color:16711680,radius:50,step:.1}}},{key:"initialize",value:function(i){this.threeLayer=i,this.addOverlay()}},{key:"onChanged",value:function(i,s){this.threeLayer&&(this.removeOverlay(),this.addOverlay())}},{key:"onDestroy",value:function(){this.removeOverlay()}},{key:"render",value:function(){this.time+=this.options.step/10,1<this.time&&(this.time=0);for(var i=this.shapeMarker.children,s=0;s<i.length;s++)i[s].material.uniforms.periodRatio.value=this.time}},{key:"removeOverlay",value:function(){this.threeLayer.remove(this.shapeMarker)}},{key:"addOverlay",value:function(){this.shapeMarker=new un.Group;for(var i=this.threeLayer,s=this.getData(),f=0;f<s.length;f++){var c=i.normizedPoint(s[f].geometry.coordinates);c=this.create3dCanvasRipple({originalData:s[f],normizedData:c}),this.shapeMarker.add(c)}i.add(this.shapeMarker)}},{key:"create3dCanvasRipple",value:function(i){var s=this.options,f=s.totalRadian,c=s.color;s=s.size;var g=i.originalData;i=i.normizedData,Object.prototype.toString.call(c)==="[object Function]"&&(c=c(g)),s=Object.prototype.toString.call(s)==="[object Function]"?s(g):Number(s),g={totalRadian:{type:"f",value:f},glowColor:{type:"c",value:new un.Color(c)},radius:{type:"f",value:s},periodRatio:{type:"f",value:0}},c=new un.Geometry;for(var p=f/(s/2),A=p;A<=f;A+=p){var S=s*Math.sin(A),N=s*Math.cos(A);c.vertices.push(new un.Vector3(0,0,A/f)),c.vertices.push(new un.Vector3(N,S,A/f))}for(f=0,s=c.vertices.length;f<s-2;++f)c.faces.push(new un.Face3(f,f+1,f+3));return f=new un.ShaderMaterial({uniforms:g,vertexShader:"varying vec4 vFragColor;varying vec4 vPosition;uniform float radius;uniform float totalRadian;uniform float periodRatio;uniform vec3 glowColor;void main(){float radian=radians(360.0*periodRatio);float s=sin(radian);float c=cos(radian);vec2 rotatedPostion=vec2(position.x*s+position.y*c,position.y*s-position.x*c);gl_Position=projectionMatrix*modelViewMatrix*vec4(rotatedPostion,0,1.0);vFragColor=vec4(glowColor,pow(position.z,1.3));}",fragmentShader:"varying vec4 vFragColor;void main(){gl_FragColor=vFragColor;}",blending:un.NormalBlending,transparent:!0,depthWrite:!1}),f=new un.Mesh(c,f),f.position.set(i[0],i[1],i[2]||0),f}}]),r}(n2),A_=Rt(function(t,r){(function(){function i(){this.positions=[],this.previous=[],this.next=[],this.side=[],this.width=[],this.indices_array=[],this.uvs=[],this.counters=[],this.geometry=new c.BufferGeometry,this.widthCallback=null,this.matrixWorld=new c.Matrix4}function s(g,p,A,S,N){if(g=g.subarray||g.slice?g:g.buffer,A=A.subarray||A.slice?A:A.buffer,g=p?g.subarray?g.subarray(p,N&&p+N):g.slice(p,N&&p+N):g,A.set)A.set(g,S);else for(p=0;p<g.length;p++)A[p+S]=g[p];return A}function f(g){c.ShaderMaterial.call(this,{uniforms:ut({},c.UniformsLib.fog,{lineWidth:{value:1},map:{value:null},useMap:{value:0},alphaMap:{value:null},useAlphaMap:{value:0},color:{value:new c.Color(16777215)},opacity:{value:1},resolution:{value:new c.Vector2(1,1)},sizeAttenuation:{value:1},near:{value:1},far:{value:1},dashArray:{value:0},dashOffset:{value:0},dashRatio:{value:.5},useDash:{value:0},visibility:{value:1},alphaTest:{value:0},repeat:{value:new c.Vector2(1,1)}}),vertexShader:c.ShaderChunk.meshline_vert,fragmentShader:c.ShaderChunk.meshline_frag}),this.type="MeshLineMaterial",Xr(this,{lineWidth:{enumerable:!0,get:function(){return this.uniforms.lineWidth.value},set:function(p){this.uniforms.lineWidth.value=p}},map:{enumerable:!0,get:function(){return this.uniforms.map.value},set:function(p){this.uniforms.map.value=p}},useMap:{enumerable:!0,get:function(){return this.uniforms.useMap.value},set:function(p){this.uniforms.useMap.value=p}},alphaMap:{enumerable:!0,get:function(){return this.uniforms.alphaMap.value},set:function(p){this.uniforms.alphaMap.value=p}},useAlphaMap:{enumerable:!0,get:function(){return this.uniforms.useAlphaMap.value},set:function(p){this.uniforms.useAlphaMap.value=p}},color:{enumerable:!0,get:function(){return this.uniforms.color.value},set:function(p){this.uniforms.color.value=p}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(p){this.uniforms.opacity.value=p}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(p){this.uniforms.resolution.value.copy(p)}},sizeAttenuation:{enumerable:!0,get:function(){return this.uniforms.sizeAttenuation.value},set:function(p){this.uniforms.sizeAttenuation.value=p}},near:{enumerable:!0,get:function(){return this.uniforms.near.value},set:function(p){this.uniforms.near.value=p}},far:{enumerable:!0,get:function(){return this.uniforms.far.value},set:function(p){this.uniforms.far.value=p}},dashArray:{enumerable:!0,get:function(){return this.uniforms.dashArray.value},set:function(p){this.uniforms.dashArray.value=p,this.useDash=p!==0?1:0}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(p){this.uniforms.dashOffset.value=p}},dashRatio:{enumerable:!0,get:function(){return this.uniforms.dashRatio.value},set:function(p){this.uniforms.dashRatio.value=p}},useDash:{enumerable:!0,get:function(){return this.uniforms.useDash.value},set:function(p){this.uniforms.useDash.value=p}},visibility:{enumerable:!0,get:function(){return this.uniforms.visibility.value},set:function(p){this.uniforms.visibility.value=p}},alphaTest:{enumerable:!0,get:function(){return this.uniforms.alphaTest.value},set:function(p){this.uniforms.alphaTest.value=p}},repeat:{enumerable:!0,get:function(){return this.uniforms.repeat.value},set:function(p){this.uniforms.repeat.value.copy(p)}}}),this.setValues(g)}var c=typeof ge!="undefined"&&m_||this.THREE;if(!c)throw Error("MeshLine requires three.js");i.prototype.setMatrixWorld=function(g){this.matrixWorld=g},i.prototype.setGeometry=function(g,p){if(this.widthCallback=p,this.positions=[],this.counters=[],g instanceof c.Geometry)for(var A=0;A<g.vertices.length;A++){var S=g.vertices[A];p=A/g.vertices.length,this.positions.push(S.x,S.y,S.z),this.positions.push(S.x,S.y,S.z),this.counters.push(p),this.counters.push(p)}if(g instanceof Float32Array||g instanceof Array)for(A=0;A<g.length;A+=3)p=A/g.length,this.positions.push(g[A],g[A+1],g[A+2]),this.positions.push(g[A],g[A+1],g[A+2]),this.counters.push(p),this.counters.push(p);this.process()},i.prototype.raycast=function(){var g=new c.Matrix4,p=new c.Ray,A=new c.Sphere;return function(S,N){var _=S.linePrecision;_*=_;var I=this.geometry;if(I.boundingSphere===null&&I.computeBoundingSphere(),A.copy(I.boundingSphere),A.applyMatrix4(this.matrixWorld),S.ray.intersectSphere(A)!==!1){g.getInverse(this.matrixWorld),p.copy(S.ray).applyMatrix4(g);var L=new c.Vector3,P=new c.Vector3,F=new c.Vector3,W=new c.Vector3,X=this instanceof c.LineSegments?2:1;if(I instanceof c.BufferGeometry){var Z=I.index,tt=I.attributes;if(Z!==null){I=Z.array,tt=tt.position.array,Z=0;for(var ot=I.length-1;Z<ot;Z+=X){var xt=I[Z+1];L.fromArray(tt,3*I[Z]),P.fromArray(tt,3*xt),xt=p.distanceSqToSegment(L,P,W,F),xt>_||(W.applyMatrix4(this.matrixWorld),xt=S.ray.origin.distanceTo(W),xt<S.near||xt>S.far||N.push({distance:xt,point:F.clone().applyMatrix4(this.matrixWorld),index:Z,face:null,faceIndex:null,object:this}))}}else for(tt=tt.position.array,Z=0,ot=tt.length/3-1;Z<ot;Z+=X)L.fromArray(tt,3*Z),P.fromArray(tt,3*Z+3),xt=p.distanceSqToSegment(L,P,W,F),xt>_||(W.applyMatrix4(this.matrixWorld),xt=S.ray.origin.distanceTo(W),xt<S.near||xt>S.far||N.push({distance:xt,point:F.clone().applyMatrix4(this.matrixWorld),index:Z,face:null,faceIndex:null,object:this}))}else if(I instanceof c.Geometry)for(L=I.vertices,P=L.length,Z=0;Z<P-1;Z+=X)xt=p.distanceSqToSegment(L[Z],L[Z+1],W,F),xt>_||(W.applyMatrix4(this.matrixWorld),xt=S.ray.origin.distanceTo(W),xt<S.near||xt>S.far||N.push({distance:xt,point:F.clone().applyMatrix4(this.matrixWorld),index:Z,face:null,faceIndex:null,object:this}))}}}(),i.prototype.compareV3=function(g,p){return g*=6,p*=6,this.positions[g]===this.positions[p]&&this.positions[g+1]===this.positions[p+1]&&this.positions[g+2]===this.positions[p+2]},i.prototype.copyV3=function(g){return g*=6,[this.positions[g],this.positions[g+1],this.positions[g+2]]},i.prototype.process=function(){var g=this.positions.length/6;this.previous=[],this.next=[],this.side=[],this.width=[],this.indices_array=[],this.uvs=[];for(var p=0;p<g;p++)this.side.push(1),this.side.push(-1);for(p=0;p<g;p++){var A=this.widthCallback?this.widthCallback(p/(g-1)):1;this.width.push(A),this.width.push(A)}for(p=0;p<g;p++)this.uvs.push(p/(g-1),0),this.uvs.push(p/(g-1),1);for(A=this.compareV3(0,g-1)?this.copyV3(g-2):this.copyV3(0),this.previous.push(A[0],A[1],A[2]),this.previous.push(A[0],A[1],A[2]),p=0;p<g-1;p++)A=this.copyV3(p),this.previous.push(A[0],A[1],A[2]),this.previous.push(A[0],A[1],A[2]);for(p=1;p<g;p++)A=this.copyV3(p),this.next.push(A[0],A[1],A[2]),this.next.push(A[0],A[1],A[2]);for(A=this.compareV3(g-1,0)?this.copyV3(1):this.copyV3(g-1),this.next.push(A[0],A[1],A[2]),this.next.push(A[0],A[1],A[2]),p=0;p<g-1;p++)A=2*p,this.indices_array.push(A,A+1,A+2),this.indices_array.push(A+2,A+1,A+3);this.attributes?(this.attributes.position.copyArray(new Float32Array(this.positions)),this.attributes.position.needsUpdate=!0,this.attributes.previous.copyArray(new Float32Array(this.previous)),this.attributes.previous.needsUpdate=!0,this.attributes.next.copyArray(new Float32Array(this.next)),this.attributes.next.needsUpdate=!0,this.attributes.side.copyArray(new Float32Array(this.side)),this.attributes.side.needsUpdate=!0,this.attributes.width.copyArray(new Float32Array(this.width)),this.attributes.width.needsUpdate=!0,this.attributes.uv.copyArray(new Float32Array(this.uvs)),this.attributes.uv.needsUpdate=!0,this.attributes.index.copyArray(new Uint16Array(this.indices_array)),this.attributes.index.needsUpdate=!0):this.attributes={position:new c.BufferAttribute(new Float32Array(this.positions),3),previous:new c.BufferAttribute(new Float32Array(this.previous),3),next:new c.BufferAttribute(new Float32Array(this.next),3),side:new c.BufferAttribute(new Float32Array(this.side),1),width:new c.BufferAttribute(new Float32Array(this.width),1),uv:new c.BufferAttribute(new Float32Array(this.uvs),2),index:new c.BufferAttribute(new Uint16Array(this.indices_array),1),counters:new c.BufferAttribute(new Float32Array(this.counters),1)},this.geometry.setAttribute("position",this.attributes.position),this.geometry.setAttribute("previous",this.attributes.previous),this.geometry.setAttribute("next",this.attributes.next),this.geometry.setAttribute("side",this.attributes.side),this.geometry.setAttribute("width",this.attributes.width),this.geometry.setAttribute("uv",this.attributes.uv),this.geometry.setAttribute("counters",this.attributes.counters),this.geometry.setIndex(this.attributes.index)},i.prototype.advance=function(g){var p=this.attributes.position.array,A=this.attributes.next.array,S=p.length;s(p,0,this.attributes.previous.array,0,S),s(p,6,p,0,S-6),p[S-6]=g.x,p[S-5]=g.y,p[S-4]=g.z,p[S-3]=g.x,p[S-2]=g.y,p[S-1]=g.z,s(p,6,A,0,S-6),A[S-6]=g.x,A[S-5]=g.y,A[S-4]=g.z,A[S-3]=g.x,A[S-2]=g.y,A[S-1]=g.z,this.attributes.position.needsUpdate=!0,this.attributes.previous.needsUpdate=!0,this.attributes.next.needsUpdate=!0},c.ShaderChunk.meshline_vert=["",c.ShaderChunk.logdepthbuf_pars_vertex,c.ShaderChunk.fog_pars_vertex,`\r
attribute vec3 previous;\r
attribute vec3 next;\r
attribute float side;\r
attribute float width;\r
attribute float counters;\r
\r
uniform vec2 resolution;\r
uniform float lineWidth;\r
uniform vec3 color;\r
uniform float opacity;\r
uniform float near;\r
uniform float far;\r
uniform float sizeAttenuation;\r
\r
varying vec2 vUV;\r
varying vec4 vColor;\r
varying float vCounters;\r
\r
vec2 fix( vec4 i, float aspect ) {\r
\r
    vec2 res = i.xy / i.w;\r
    res.x *= aspect;\r
	 vCounters = counters;\r
    return res;\r
\r
}\r
\r
void main() {\r
\r
    float aspect = resolution.x / resolution.y;\r
    float pixelWidthRatio = 1. / (resolution.x * projectionMatrix[0][0]);\r
\r
    vColor = vec4( color, opacity );\r
    vUV = uv;\r
\r
    mat4 m = projectionMatrix * modelViewMatrix;\r
    vec4 finalPosition = m * vec4( position, 1.0 );\r
    vec4 prevPos = m * vec4( previous, 1.0 );\r
    vec4 nextPos = m * vec4( next, 1.0 );\r
\r
    vec2 currentP = fix( finalPosition, aspect );\r
    vec2 prevP = fix( prevPos, aspect );\r
    vec2 nextP = fix( nextPos, aspect );\r
\r
    float pixelWidth = finalPosition.w * pixelWidthRatio;\r
    float w = 1.8 * pixelWidth * lineWidth * width;\r
\r
    if( sizeAttenuation == 1. ) {\r
        w = 1.8 * lineWidth * width;\r
    }\r
\r
    vec2 dir;\r
    if( nextP == currentP ) dir = normalize( currentP - prevP );\r
    else if( prevP == currentP ) dir = normalize( nextP - currentP );\r
    else {\r
        vec2 dir1 = normalize( currentP - prevP );\r
        vec2 dir2 = normalize( nextP - currentP );\r
        dir = normalize( dir1 + dir2 );\r
\r
        vec2 perp = vec2( -dir1.y, dir1.x );\r
        vec2 miter = vec2( -dir.y, dir.x );\r
        //w = clamp( w / dot( miter, perp ), 0., 4. * lineWidth * width );\r
\r
    }\r
\r
    //vec2 normal = ( cross( vec3( dir, 0. ), vec3( 0., 0., 1. ) ) ).xy;\r
    vec2 normal = vec2( -dir.y, dir.x );\r
    normal.x /= aspect;\r
    normal *= .5 * w;\r
\r
    vec4 offset = vec4( normal * side, 0.0, 1.0 );\r
    finalPosition.xy += offset.xy;\r
\r
    gl_Position = finalPosition;\r
`,c.ShaderChunk.logdepthbuf_vertex,c.ShaderChunk.fog_vertex&&"    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",c.ShaderChunk.fog_vertex,"}"].join(`\r
`),c.ShaderChunk.meshline_frag=["",c.ShaderChunk.fog_pars_fragment,c.ShaderChunk.logdepthbuf_pars_fragment,`\r
uniform sampler2D map;\r
uniform sampler2D alphaMap;\r
uniform float useMap;\r
uniform float useAlphaMap;\r
uniform float useDash;\r
uniform float dashArray;\r
uniform float dashOffset;\r
uniform float dashRatio;\r
uniform float visibility;\r
uniform float alphaTest;\r
uniform vec2 repeat;\r
\r
varying vec2 vUV;\r
varying vec4 vColor;\r
varying float vCounters;\r
\r
void main() {\r
`,c.ShaderChunk.logdepthbuf_fragment,`\r
    vec4 c = vColor;\r
    if( useMap == 1. ) c *= texture2D( map, vUV * repeat );\r
    if( useAlphaMap == 1. ) c.a *= texture2D( alphaMap, vUV * repeat ).a;\r
    if( c.a < alphaTest ) discard;\r
    if( useDash == 1. ){\r
        c.a *= ceil(mod(vCounters + dashOffset, dashArray) - (dashArray * dashRatio));\r
    }\r
    gl_FragColor = c;\r
    gl_FragColor.a *= step(vCounters, visibility);\r
`,c.ShaderChunk.fog_fragment,"}"].join(`\r
`),f.prototype=at(c.ShaderMaterial.prototype),f.prototype.constructor=f,f.prototype.isMeshLineMaterial=!0,f.prototype.copy=function(g){return c.ShaderMaterial.prototype.copy.call(this,g),this.lineWidth=g.lineWidth,this.map=g.map,this.useMap=g.useMap,this.alphaMap=g.alphaMap,this.useAlphaMap=g.useAlphaMap,this.color.copy(g.color),this.opacity=g.opacity,this.resolution.copy(g.resolution),this.sizeAttenuation=g.sizeAttenuation,this.near=g.near,this.far=g.far,this.dashArray.copy(g.dashArray),this.dashOffset.copy(g.dashOffset),this.dashRatio.copy(g.dashRatio),this.useDash=g.useDash,this.visibility=g.visibility,this.alphaTest=g.alphaTest,this.repeat.copy(g.repeat),this},t.exports&&(r=t.exports={MeshLine:i,MeshLineMaterial:f}),r.MeshLine=i,r.MeshLineMaterial=f}).call(ai)}),i3=A_.MeshLine,n3=A_.MeshLineMaterial,o3=function(t){function r(i){return Ji(this,r),i=jn(this,(r.__proto__||Mo(r)).call(this,i)),i.staticDashArray=2,i.time=0,i.autoUpdate=!0,i}return Co(r,t),Cn(r,[{key:"getDefaultOptions",value:function(){return{color:16777215,textureColor:16777215,textureWidth:10,textureLength:30,step:.1}}},{key:"initialize",value:function(i){this.threeLayer=i,this.addOverlay()}},{key:"onChanged",value:function(i,s){this.threeLayer&&(this.removeOverlay(),this.addOverlay())}},{key:"onDestroy",value:function(){this.removeOverlay()}},{key:"render",value:function(){var i=this.getOptions(),s=i.textureWidth,f=i.style;i=i.step/10,this.time+=i,2<this.time&&(this.time=0);for(var c=this.flyLine.children,g=0;g<c.length;g++){var p=c[g],A=p.hash;p.children[0].material.uniforms.lineWidth.value=s*(1+.2*Math.sin(5*this.time)),p.children[0].material.uniforms.dashOffset.value=f==="chaos"?p.children[0].material.uniforms.dashOffset.value-i:(this.staticDashArray+A)*(1-this.time/2)}}},{key:"removeOverlay",value:function(){this.threeLayer.remove(this.flyLine)}},{key:"addOverlay",value:function(){var i=this;this.flyLine=new un.Group;var s=this.threeLayer,f=new un.TextureLoader,c=this.getData();f.load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFkAAABZCAQAAAD/AkAkAAAACXBIWXMAAAsTAAALEwEAmpwYAAADGWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjaY2BgnuDo4uTKJMDAUFBUUuQe5BgZERmlwH6egY2BmYGBgYGBITG5uMAxIMCHgYGBIS8/L5UBA3y7xsDIwMDAcFnX0cXJlYE0wJpcUFTCwMBwgIGBwSgltTiZgYHhCwMDQ3p5SUEJAwNjDAMDg0hSdkEJAwNjAQMDg0h2SJAzAwNjCwMDE09JakUJAwMDg3N+QWVRZnpGiYKhpaWlgmNKflKqQnBlcUlqbrGCZ15yflFBflFiSWoKAwMD1A4GBgYGXpf8EgX3xMw8BUNTVQYqg4jIKAX08EGIIUByaVEZhMXIwMDAIMCgxeDHUMmwiuEBozRjFOM8xqdMhkwNTJeYNZgbme+y2LDMY2VmzWa9yubEtoldhX0mhwBHJycrZzMXM1cbNzf3RB4pnqW8xryH+IL5nvFXCwgJrBZ0E3wk1CisKHxYJF2UV3SrWJw4p/hWiRRJYcmjUhXSutJPZObIhsoJyp2V71HwUeRVvKA0RTlKRUnltepWtUZ1Pw1Zjbea+7QmaqfqWOsK6b7SO6I/36DGMMrI0ljS+LfJPdPDZivM+y0qLBOtfKwtbFRtRexY7L7aP3e47XjB6ZjzXpetruvdVrov9VjkudBrgfdCn8W+y/xW+a8P2Bq4N+hY8PmQW6HPwr5EMEUKRilFG8e4xUbF5cW3JMxO3Jx0Nvl5KlOaXLpNRlRmVdas7D059/KY8tULfAqLi2YXHy55WyZR7lJRWDmv6mz131q9uvj6SQ3HGn83G7Skt85ru94h2Ond1d59uJehz76/bsK+if8nO05pnXpiOu+M4JmzZj2aozW3ZN6+BVwLwxYtXvxxqcOyCcsfrjRe1br65lrddU3rb2402NSx+cFWq21Tt3/Y6btr1R6Oven7jh9QP9h56PURv6Obj4ufqD355LT3mS3nZM+3X/h0Ke7yqasW15bdEL3ZeuvrnfS7N+/7PDjwyPTx6qeKz2a+EHzZ9Zr5Td3bn+9LP3z6VPD53de8b+9+5P/88Lv4z7d/Vf//AwAqvx2K829RWwAAOGtpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+Cjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIgogICAgICAgICAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICAgICAgICAgIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIKICAgICAgICAgICAgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iCiAgICAgICAgICAgIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+CiAgICAgICAgIDx4bXA6Q3JlYXRvclRvb2w+QWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCk8L3htcDpDcmVhdG9yVG9vbD4KICAgICAgICAgPHhtcDpDcmVhdGVEYXRlPjIwMTktMDYtMjdUMTk6MzE6MTUrMDg6MDA8L3htcDpDcmVhdGVEYXRlPgogICAgICAgICA8eG1wOk1vZGlmeURhdGU+MjAxOS0wOC0xOVQxNjo1Nzo1MCswODowMDwveG1wOk1vZGlmeURhdGU+CiAgICAgICAgIDx4bXA6TWV0YWRhdGFEYXRlPjIwMTktMDgtMTlUMTY6NTc6NTArMDg6MDA8L3htcDpNZXRhZGF0YURhdGU+CiAgICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2UvcG5nPC9kYzpmb3JtYXQ+CiAgICAgICAgIDxwaG90b3Nob3A6Q29sb3JNb2RlPjE8L3Bob3Rvc2hvcDpDb2xvck1vZGU+CiAgICAgICAgIDxwaG90b3Nob3A6SUNDUHJvZmlsZT5Eb3QgR2FpbiAxNSU8L3Bob3Rvc2hvcDpJQ0NQcm9maWxlPgogICAgICAgICA8eG1wTU06SW5zdGFuY2VJRD54bXAuaWlkOjQ5MmI1NTQ1LWIwNmQtNGI0Yi1iMWExLTZiN2NiNzExNzA5MjwveG1wTU06SW5zdGFuY2VJRD4KICAgICAgICAgPHhtcE1NOkRvY3VtZW50SUQ+eG1wLmRpZDo0OTJiNTU0NS1iMDZkLTRiNGItYjFhMS02YjdjYjcxMTcwOTI8L3htcE1NOkRvY3VtZW50SUQ+CiAgICAgICAgIDx4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+eG1wLmRpZDo0OTJiNTU0NS1iMDZkLTRiNGItYjFhMS02YjdjYjcxMTcwOTI8L3htcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAgICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJkZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmFjdGlvbj5jcmVhdGVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDppbnN0YW5jZUlEPnhtcC5paWQ6NDkyYjU1NDUtYjA2ZC00YjRiLWIxYTEtNmI3Y2I3MTE3MDkyPC9zdEV2dDppbnN0YW5jZUlEPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6d2hlbj4yMDE5LTA2LTI3VDE5OjMxOjE1KzA4OjAwPC9zdEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVBZ2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNyAoTWFjaW50b3NoKTwvc3RFdnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAgPC9yZGY6bGk+CiAgICAgICAgICAgIDwvcmRmOlNlcT4KICAgICAgICAgPC94bXBNTTpIaXN0b3J5PgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8dGlmZjpYUmVzb2x1dGlvbj43MjAwMDAvMTAwMDA8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNvbHV0aW9uPjcyMDAwMC8xMDAwMDwvdGlmZjpZUmVzb2x1dGlvbj4KICAgICAgICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5pdD4KICAgICAgICAgPGV4aWY6Q29sb3JTcGFjZT42NTUzNTwvZXhpZjpDb2xvclNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+ODk8L2V4aWY6UGl4ZWxYRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+ODk8L2V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0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",function(g){for(var p=0;p<c.length;p++){var A=c[p].geometry.coordinates.map(function(S){return new(Function.prototype.bind.apply(un.Vector3,[null].concat(u_(s.normizedPoint(S)))))});A=i.createFlyLine({originalData:c[p],curveData:A,texture:g}),i.flyLine.add(A)}s.add(i.flyLine)})}},{key:"createFlyLine",value:function(i){var s=this.options,f=s.color,c=s.textureColor,g=s.textureWidth,p=i.originalData,A=i.curveData;i=i.texture;var S=Math.random();s=Math.min(1,1-s.textureLength/100),s=Math.max(0,s),Object.prototype.toString.call(f)==="[object Function]"&&(f=f(p)),Object.prototype.toString.call(c)==="[object Function]"&&(c=c(p)),p=new un.Geometry,p.vertices=A,p.verticesNeedUpdate=!0,f=new un.LineBasicMaterial({linewidth:1,color:new un.Color(f),blending:un.AdditiveBlending,depthTest:!0,depthWrite:!1,transparent:!0,opacity:.3,linecap:"round",linejoin:"round"}),f=new un.Line(p,f),f.renderDepth=!1,f.hash=S,p=new i3;for(var N=new un.Geometry,_=0;_<A.length;_++){var I=A[_];N.vertices.push(new un.Vector3(I.x,I.y,I.z))}return p.setGeometry(N,function(L){return 1-L}),c=new n3({map:i,useMap:!0,color:new un.Color(c),opacity:1,dashArray:this.staticDashArray+S,dashOffset:0,dashRatio:s,sizeAttenuation:!0,lineWidth:g,depthWrite:!1,depthTest:!0,alphaTest:!1,transparent:!0,blending:un.AdditiveBlending,side:un.DoubleSide}),c=new un.Mesh(p.geometry,c),f.add(c),f}}]),r}(n2);Lt.THREELoader=qc,Lt.PostProcessing=e3,Lt.FanLayer=r3,Lt.FlyLineLayer=o3,Lt.ThreeLayer=v_,Object.defineProperty(Lt,"__esModule",{value:!0})})},18771:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(65353),Lt=ce.__importDefault(Dt(16382)),ge=function(Nt){ce.__extends(Rt,Nt);function Rt(ue){return Nt.call(this,ue)||this}return Rt.prototype.getControl=function(){return new BMapGL.CityListControl(this.getOptions())},Rt.prototype.render=function(){return null},Rt}(Lt.default);Qt.default=ge},16382:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(65353),Lt=Dt(39001),ge=ce.__importDefault(Dt(96774)),Nt=Dt(40671),Rt=function(ue){ce.__extends(se,ue);function se(st){var Ft=ue.call(this,st)||this;return Ft.options=["anchor","offset"],Ft}return se.prototype.componentDidUpdate=function(st){if(!this.map){this.initialize();return}var Ft=this.props,Pt=Ft.anchor,It=Ft.offset,bt=st.anchor,re=st.offset,he=!ge.default(Pt,bt),lt=!ge.default(It,re);Pt&&he&&this.control.setAnchor(Pt),It&&lt&&this.control.setOffset(It)},se.prototype.componentDidMount=function(){this.initialize()},se.prototype.componentWillUnmount=function(){this.destroy()},se.prototype.destroy=function(){this.control&&this.map&&!this.map._destroyed&&(this.map.removeControl(this.control),this.control=null)},se.prototype.initialize=function(){var st=this.map=this.getMap();!st||(this.destroy(),this.control=this.getControl(),st.addControl(this.control))},se.prototype.getControl=function(){throw new Error("Method getControl not implemented.")},se.contextType=Nt.MapContext,se}(Lt.Component);Qt.default=Rt},15639:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(65353),Lt=ce.__importDefault(Dt(16382)),ge=function(Nt){ce.__extends(Rt,Nt);function Rt(ue){return Nt.call(this,ue)||this}return Rt.prototype.getControl=function(){return new BMapGL.MapTypeControl(this.getOptions())},Rt.prototype.render=function(){return null},Rt}(Lt.default);Qt.default=ge},32066:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(65353),Lt=ce.__importDefault(Dt(16382)),ge=function(Nt){ce.__extends(Rt,Nt);function Rt(ue){return Nt.call(this,ue)||this}return Rt.prototype.getControl=function(){return new BMapGL.NavigationControl3D(this.getOptions())},Rt.prototype.render=function(){return null},Rt}(Lt.default);Qt.default=ge},21303:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(65353),Lt=ce.__importDefault(Dt(16382)),ge=function(Nt){ce.__extends(Rt,Nt);function Rt(ue){return Nt.call(this,ue)||this}return Rt.prototype.getControl=function(){return new BMapGL.ScaleControl(this.getOptions())},Rt.prototype.render=function(){return null},Rt}(Lt.default);Qt.default=ge},36565:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(65353),Lt=ce.__importDefault(Dt(16382)),ge=function(Nt){ce.__extends(Rt,Nt);function Rt(ue){return Nt.call(this,ue)||this}return Rt.prototype.getControl=function(){return new BMapGL.ZoomControl(this.getOptions())},Rt.prototype.render=function(){return null},Rt}(Lt.default);Qt.default=ge},95e3:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(65353),Lt=Dt(70507),ge=ce.__importDefault(Dt(96774)),Nt=Dt(39001),Rt="rgba(60, 50, 200, 0.9)",ue=function(se){ce.__extends(st,se);function st(Ft){var Pt=se.call(this,Ft)||this;return Pt._createLayer=!1,Pt}return st.prototype.componentDidMount=function(){this.initialize()},st.prototype.componentDidUpdate=function(Ft){ge.default(this.props,Ft)||this.initialize()},st.prototype.componentWillUnmount=function(){this.destroy()},st.prototype.destroy=function(){this._createLayer=!1,this.view.destroy(),this.view=void 0,this.linelayer=void 0,this.arrowlayer=void 0,this.flowlayer=void 0,this.pointlayer=void 0,this.textlayer=void 0,this.colorarrowlayers=[]},st.prototype.initialize=function(){var Ft=this,Pt=this.map=this.getMap();if(!!Pt){this._createLayer||this.createLayers();var It=[],bt=[],re=new Map;if(this.colorarrowlayers&&this.colorarrowlayers.length)for(var he=0;he<this.colorarrowlayers.length;he++){var lt=this.colorarrowlayers[he];this.view.removeLayer(lt)}if(this.colorarrowlayers=[],this.props.data){var ye=[],ci=new Lt.OdCurve;this.props.data.forEach(function(Or){var Ce=Or.from.point||Lt.utilCity.getCenterByCityName(Or.from.city),ti=Or.to.point||Lt.utilCity.getCenterByCityName(Or.to.city);Ce=new BMapGL.Point(Ce.lng,Ce.lat),ti=new BMapGL.Point(ti.lng,ti.lat),ci.setOptions({points:[Ce,ti]});var Ai=ci.getPoints();Ft.props.coordType==="bd09mc"?(ye.push(BMapGL.Projection.convertMC2LL(Ce)),ye.push(BMapGL.Projection.convertMC2LL(ti))):(ye.push(Ce),ye.push(ti)),It.push({geometry:{type:"LineString",coordinates:Ai},color:Or.color});var Ti=re.get(Or.color)||[];Ti.push({geometry:{type:"LineString",coordinates:Ai}}),re.set(Or.color,Ti),Ft.props.showEndPoint!==!1&&bt.push({geometry:{type:"Point",coordinates:[ti.lng,ti.lat]},color:Or.color,properties:{text:Or.to.name||Or.to.city}}),Ft.props.showStartPoint!==!1&&bt.push({geometry:{type:"Point",coordinates:[Ce.lng,Ce.lat]},color:Or.color,properties:{text:Or.from.name||Or.from.city}}),ye.length>0&&Ft.props.autoViewport===!0&&Pt.setViewport(ye,Ft.props.viewportOptions||{})})}this.linelayer.setData(It),this.props.lineOptions&&this.linelayer.setOptions(this.props.lineOptions),this.pointlayer.setData(bt),this.props.pointOptions&&this.pointlayer.setOptions(this.props.pointOptions),this.textlayer.setData(bt),this.props.textOptions&&this.textlayer.setOptions(this.props.textOptions),Array.from(re.keys()).forEach(function(Or){if(Or===void 0)Ft.arrowlayer.setData(re.get(void 0)),Ft.props.arrowOptions&&Ft.arrowlayer.setOptions(Ft.props.arrowOptions);else{var Ce=new Lt.LineLayer(ce.__assign(ce.__assign({blend:"lighter",width:10},Ft.props.arrowOptions),{style:"arrow",color:"rgba(255, 255, 255, 0)",styleOptions:{color:Or}}));Ft.view.addLayer(Ce),Ce.setData(re.get(Or)),Ft.colorarrowlayers.push(Ce)}}),this.props.enableAnimation&&(this.flowlayer.setData(It),this.props.animationOptions&&this.flowlayer.setOptions(this.props.animationOptions))}},st.prototype.createLayers=function(){this._createLayer=!0;var Ft=this.map,Pt=this.view=new Lt.View({map:Ft}),It=this.linelayer=new Lt.LineLayer({blend:"lighter",color:Rt,width:4});Pt.addLayer(It);var bt=this.arrowlayer=new Lt.LineLayer({blend:"lighter",width:10,style:"arrow",color:"rgba(255, 255, 255, 0)",styleOptions:{color:Rt}});Pt.addLayer(bt);var re=this.pointlayer=new Lt.PointLayer({blend:"lighter",depthTest:!1,color:Rt,size:10});Pt.addLayer(re);var he=this.textlayer=new Lt.TextLayer({offset:[0,15],depthTest:!1,color:"#333"});Pt.addLayer(he);var lt=this.flowlayer=new Lt.LineLayer({blend:"lighter",color:function(){return"rgb(240, 200, 200)"},width:2,animation:!0,interval:.4,duration:1,trailLength:.8});Pt.addLayer(lt)},st.prototype.render=function(){return null},st.defaultProps={enableAnimation:!0,showStartPoint:!0,showEndPoint:!0},st}(Nt.Component);Qt.default=ue},14901:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(65353),Lt=ce.__importStar(Dt(70507)),ge=ce.__importStar(Dt(98762)),Nt=Dt(39001),Rt=Dt(12840),ue=function(se){ce.__extends(st,se);function st(Ft){var Pt=se.call(this,Ft)||this;Pt._createLayer=!1;var It=Pt;return Pt.props.getMethods&&Pt.props.getMethods({setViewport:Pt.setViewport.bind(It)}),Pt}return st.prototype.componentDidMount=function(){this.initialize()},st.prototype.componentWillUnmount=function(){this.destroy()},st.prototype.componentDidUpdate=function(Ft){var Pt=this.props,It=Pt.type,bt=Pt.data,re=Pt.options,he=Pt.autoViewport,lt=Ft.type,ye=Ft.data,ci=Ft.options,Or=Ft.autoViewport;if(!this.map||!this.layer){this.initialize();return}if(It!==lt){this.destroy(),this.initialize();return}JSON.stringify(ci)!==JSON.stringify(re)&&this.layer.setOptions(re),JSON.stringify(ye)!==JSON.stringify(bt)&&this.layer.setData(bt),he&&(JSON.stringify(ye)!==JSON.stringify(bt)||he!==Or)&&this.setViewport()},st.prototype.destroy=function(){this.layer&&this.view&&(this._createLayer=!1,this.view.removeLayer(this.layer),this.layer.destroy(),this.layer=null)},st.prototype.initialize=function(){var Ft=this.map=this.getMap(),Pt=this.view=this.props.view||this.context.view;!Ft||!Pt||(this._createLayer||this.createLayers(),this.layer.setData(this.props.data),this.props.autoViewport&&this.setViewport())},st.prototype.setViewport=function(){var Ft=this.props.coordType==="bd09mc",Pt=function(bt){var re=new BMapGL.Point(bt[0],bt[1]);return Ft?BMapGL.Projection.convertMC2LL(re):re},It=[];this.props.data.forEach(function(bt){bt.geometry.type==="Point"?It.push(Pt(bt.geometry.coordinates)):bt.geometry.type==="LineString"?bt.geometry.coordinates.forEach(function(re){It.push(Pt(re))}):bt.geometry.type==="Polygon"?bt.geometry.coordinates[0].forEach(function(re){It.push(Pt(re))}):bt.geometry.type==="MultiPolygon"&&bt.geometry.coordinates.forEach(function(re){re[0].forEach(function(he){It.push(Pt(he))})})}),It.length>0&&this.map.setViewport(It,this.props.viewportOptions||{})},st.prototype.createLayers=function(){if(Lt[this.props.type]||ge[this.props.type]){this._createLayer=!0;var Ft=Lt[this.props.type]?Lt:ge;this.layer=new Ft[this.props.type](this.props.options),this.view.addLayer(this.layer)}else console.error("mapvgl doesn't have layer "+this.props.type+"!")},st.prototype.render=function(){return null},st.contextType=Rt.ViewContext,st}(Nt.Component);Qt.default=ue},12840:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.ViewContext=void 0;var ce=Dt(65353),Lt=Dt(70507),ge=ce.__importStar(Dt(67294)),Nt=Dt(39001),Rt=Dt(40671);Qt.ViewContext=ge.default.createContext({view:void 0});var ue=function(se){ce.__extends(st,se);function st(Ft){return se.call(this,Ft)||this}return st.prototype.componentDidMount=function(){this.initialize(),this.forceUpdate()},st.prototype.componentWillUnmount=function(){this.view&&(this.view.destroy(),this.view=null)},st.prototype.componentDidUpdate=function(Ft){(!this.map||!this.view)&&this.initialize()},st.prototype.initialize=function(){var Ft=this.map=this.getMap();if(!(!Ft||this.view)&&!this.view){var Pt=[],It=this.props.effects,bt=this.props.preserveDrawingBuffer;It&&It.length&&It.forEach(function(re){re==="bloom"?Pt.push(new Lt.BloomEffect):re==="bright"?Pt.push(new Lt.BrightEffect):re==="blur"&&Pt.push(new Lt.BlurEffect)}),this.view=new Lt.View({effects:Pt,preserveDrawingBuffer:bt,map:Ft})}},st.prototype.renderChildren=function(Ft){var Pt=this;if(!(!Ft||!this.map||!this.view))return ge.default.Children.map(Ft,function(It){if(!!It)return typeof It.type=="string"?It:ge.default.cloneElement(It,{map:Pt.map,view:Pt.view})})},st.prototype.render=function(){return ge.default.createElement(ge.Fragment,null,ge.default.createElement(Qt.ViewContext.Provider,{value:{map:this.map,view:this.view}},this.renderChildren(this.props.children)))},st.contextType=Rt.MapContext,st}(Nt.Component);Qt.default=ue},39647:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(65353),Lt=Dt(40671),ge=Dt(39001),Nt=function(Rt){ce.__extends(ue,Rt);function ue(se){return Rt.call(this,se)||this}return ue.prototype.componentDidMount=function(){this.initialize()},ue.prototype.componentDidUpdate=function(se){this.initialize()},ue.prototype.componentWillUnmount=function(){this.destroy()},ue.prototype.destroy=function(){this.tilelayer&&this.map&&!this.map._destroyed&&(this.map.removeTileLayer(this.tilelayer),this.tilelayer=void 0)},ue.prototype.initialize=function(){var se=this.map=this.getMap();if(!!se){this.destroy();var st="pl",Ft="20190102",Pt=this.tilelayer=new BMapGL.TileLayer({transparentPng:!0});Pt.zIndex=110,Pt.getTilesUrl=function(It,bt){if(!It||bt<0)return"";var re=It.x,he=It.y,lt="//mapsv0.bdimg.com/tile/?udt="+Ft+"&qt=tile&styles="+st+"&x="+re+"&y="+he+"&z="+bt;return lt},se.addTileLayer(this.tilelayer)}},ue.prototype.render=function(){return null},ue.contextType=Lt.MapContext,ue}(ge.Component);Qt.default=Nt},50249:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(65353),Lt=Dt(40671),ge=Dt(39001),Nt=function(Rt){ce.__extends(ue,Rt);function ue(se){var st=Rt.call(this,se)||this;return st._showLayer=!1,st}return ue.prototype.componentDidMount=function(){this.initialize()},ue.prototype.componentDidUpdate=function(se){this.initialize()},ue.prototype.componentWillUnmount=function(){this._showLayer&&this.map&&!this.map._destroyed&&(this.map.setTrafficOff(),this._showLayer=!1)},ue.prototype.initialize=function(){var se=this.map=this.getMap();!se||this._showLayer||(se.setTrafficOn(),this._showLayer=!0)},ue.prototype.render=function(){return null},ue.contextType=Lt.MapContext,ue}(ge.Component);Qt.default=Nt},34418:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(65353),Lt=Dt(39001),ge=Dt(77233),Nt=ce.__importStar(Dt(77818)),Rt=Dt(40671),ue=["drawend","addpoint","removepolyline"],se={},st=function(Ft){ce.__extends(Pt,Ft);function Pt(It){var bt=Ft.call(this,It)||this;return bt.options=["tips","followText","unit","lineColor","lineStroke","opacity","lineStyle","cursor","secIcon","closeIcon"],bt}return Pt.prototype.componentDidMount=function(){this.initialize()},Pt.prototype.componentWillUnmount=function(){this.destroy()},Pt.prototype.destroy=function(){this.distancetool&&(this.distancetool.close(),this.instance=this.distancetool=void 0)},Pt.prototype.initialize=function(){var It=this,bt=this.map=this.getMap();if(!!bt){this.destroy();var re=this.getOptions();if(window.BMapGLLib&&BMapGLLib.DistanceTool&&(this.instance=this.distancetool=new BMapGLLib.DistanceTool(bt,re),this.props.defaultOpen&&this.distancetool.open()),!window.BMapGLLib||!BMapGLLib.DistanceTool){var he=this.props.scriptUrl||"//mapopen.bj.bcebos.com/github/BMapGLLib/DistanceTool/src/DistanceTool.js";ge.requireScript(he).then(function(){It.instance=It.distancetool=new BMapGLLib.DistanceTool(bt,re),Nt.registerEvents(It,It.getInstance(It),ue),Nt.toggleMethods(It,It.getInstance(It),se),It.props.defaultOpen&&It.distancetool.open()})}}},Pt.prototype.render=function(){return null},Pt.contextType=Rt.MapContext,Pt}(Lt.Component);st.defaultProps={defaultOpen:!0},Qt.default=Nt.default(st,ue,se)},77079:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(65353),Lt=ce.__importDefault(Dt(67294)),ge=Dt(39001),Nt=Dt(77233),Rt=ce.__importStar(Dt(77818)),ue=Dt(40671),se=["overlaycomplete","overlaycancel"],st={enableCalculate:["enableCalculate","disableCalculate"],enableSorption:["enableSorption","disableSorption"],enableGpc:["enableGpc","disableGpc"]},Ft={strokeColor:"#5E87DB",fillColor:"#5E87DB",strokeWeight:2,strokeOpacity:1,fillOpacity:.2},Pt={borderRadius:"2px",background:"#FFFBCC",border:"1px solid #E1E1E1",color:"#703A04",fontSize:"12px",letterSpacing:"0",padding:"5px"},It=function(bt){ce.__extends(re,bt);function re(he){var lt=bt.call(this,he)||this;return lt.el=Lt.default.createRef(),lt.options=["isOpen","drawingMode","enableDrawingTool","enableCalculate","enableSorption","enableGpc","enableLimit","sorptionDistance","limitOptions","drawingToolOptions","markerOptions","circleOptions","polylineOptions","polygonOptions","rectangleOptions","labelOptions"],lt}return re.prototype.componentDidMount=function(){this.initialize()},re.prototype.componentWillUnmount=function(){this.destroy()},re.prototype.destroy=function(){this.drawingmanager&&(this.drawingmanager.close(),this.instance=this.drawingmanager=void 0)},re.prototype.initialize=function(){var he=this,lt=this.map=this.getMap();if(!!lt){this.destroy();for(var ye=this.getOptions(),ci=["circleOptions","polylineOptions","polygonOptions","rectangleOptions"],Or=0;Or<ci.length;Or++){var Ce=ci[Or];ye[Ce]||(ye[Ce]=Ft)}if(ye.labelOptions||(ye.labelOptions=Pt),ye.drawingToolOptions.customContainer=this.el.current,window.BMapGLLib&&BMapGLLib.DrawingManager&&(this.instance=this.drawingmanager=new BMapGLLib.DrawingManager(lt,ye)),!window.BMapGLLib||!BMapGLLib.DrawingManager){var ti=this.props.cssUrl||"//mapopen.bj.bcebos.com/github/BMapGLLib/DrawingManager/src/DrawingManager.min.css",Ai=this.props.scriptUrl||"//mapopen.bj.bcebos.com/github/BMapGLLib/DrawingManager/src/DrawingManager.min.js";Nt.requireCss(ti).then(function(){}),Nt.requireScript(Ai).then(function(){he.instance=he.drawingmanager=new BMapGLLib.DrawingManager(lt,ye),Rt.registerEvents(he,he.getInstance(he),se),Rt.toggleMethods(he,he.getInstance(he),st)})}}},re.prototype.render=function(){return Lt.default.createElement("div",{className:"react-bmapgl-drawingmanager",ref:this.el,style:this.props.style})},re.contextType=ue.MapContext,re}(ge.Component);It.defaultProps={isOpen:!1,enableDrawingTool:!0,enableCalculate:!1,enableSorption:!1,enableGpc:!1,enableLimit:!1,sorptionDistance:20,limitOptions:{area:5e7,distance:3e4},drawingToolOptions:{},style:{position:"absolute",left:0,top:0,width:360}},Qt.default=Rt.default(It,se,st)},40671:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.MapContext=void 0;var ce=Dt(65353),Lt=ce.__importDefault(Dt(67294)),ge=Dt(39001),Nt=ce.__importDefault(Dt(77818)),Rt=ce.__importDefault(Dt(96774)),ue=ce.__importDefault(Dt(62155)),se=["click","dblclick","rightclick","rightdblclick","maptypechange","mousemove","mouseover","mouseout","movestart","moving","moveend","zoomstart","zoomend","addoverlay","addcontrol","removecontrol","removeoverlay","clearoverlays","dragstart","dragging","dragend","addtilelayer","removetilelayer","load","resize","hotspotclick","hotspotover","hotspotout","tilesloaded","touchstart","touchmove","touchend","longpress"],st={enableScrollWheelZoom:["enableScrollWheelZoom","disableScrollWheelZoom"],enableDragging:["enableDragging","disableDragging"],enableDoubleClickZoom:["enableDoubleClickZoom","disableDoubleClickZoom"],enableKeyboard:["enableKeyboard","disableKeyboard"],enableInertialDragging:["enableInertialDragging","disableInertialDragging"],enableContinuousZoom:["enableContinuousZoom","disableContinuousZoom"],enablePinchToZoom:["enablePinchToZoom","disablePinchToZoom"],enableRotate:["enableRotate","disableRotate"],enableTilt:["enableTilt","disableTilt"],enableAutoResize:["enableAutoResize","disableAutoResize"]};Qt.MapContext=Lt.default.createContext({map:void 0});var Ft=function(It){ce.__extends(bt,It);function bt(re){var he=It.call(this,re)||this;return he.el=Lt.default.createRef(),he.options=["minZoom","maxZoom","mapType","backgroundColor","displayOptions"],he}return bt.prototype.componentDidMount=function(){this.initialize(),this.forceUpdate()},bt.prototype.componentDidUpdate=function(re){var he=re.center,lt=re.zoom,ye=this.props,ci=ye.center,Or=ye.zoom,Ce=!!ci&&!Rt.default(he,ci),ti=!!(Or&&!Rt.default(lt,Or)),Ai;if(ue.default(ci))Ai=ci;else{var Ti=ci,Fn=Ti.lng,xo=Ti.lat;Ai=new BMapGL.Point(Fn,xo)}Ce&&ti?this.map.centerAndZoom(Ai,Or):Ce?this.map.setCenter(Ai):ti&&this.map.setZoom(Or)},bt.prototype.componentWillUnmount=function(){this.map&&(this.map.destroy(),this.instance=this.map=void 0)},bt.prototype.initialize=function(){if(!this.map){var re=Object.assign({},this.props.defaultOptions,this.getOptions());re.mapType&&(re.mapType=re.mapType==="normal"?BMAP_NORMAL_MAP:re.mapType,re.mapType=re.mapType==="earth"?BMAP_EARTH_MAP:re.mapType),this.props.mapStyleV2&&(re.style=this.props.mapStyleV2);var he=new BMapGL.Map(this.el.current,re);if(this.map=he,this.instance=he,ue.default(this.props.center))he.centerAndZoom(this.props.center,this.props.zoom);else{var lt=this.props.center,ye=lt.lng,ci=lt.lat,Or=new BMapGL.Point(ye,ci);he.centerAndZoom(Or,this.props.zoom)}this.props.heading&&he.setHeading(this.props.heading),this.props.tilt&&he.setTilt(this.props.tilt)}},bt.prototype.renderChildren=function(re,he){var lt=this;if(!(!re||!he))return Lt.default.Children.map(re,function(ye){return ye?typeof ye.type=="string"||!ye.props?ye:Lt.default.cloneElement(ye,{map:he},lt.renderChildren(ye.props.children,he)):null})},bt.prototype.render=function(){return Lt.default.createElement("div",{style:this.props.style},Lt.default.createElement("div",{ref:this.el,className:this.props.className,style:{height:"100%"}},"\u52A0\u8F7D\u5730\u56FE\u4E2D..."),Lt.default.createElement(Qt.MapContext.Provider,{value:{map:this.map}},this.renderChildren(this.props.children,this.map)))},bt}(ge.Component);Ft.defaultProps={center:{lng:116.404449,lat:39.914889},zoom:12,defaultOptions:{},style:{position:"relative",height:"360px"}},Qt.default=Nt.default(Ft,se,st);var Pt=Dt(44605);Object.defineProperty(Qt,"MapApiLoaderHOC",{enumerable:!0,get:function(){return Pt.default}})},44605:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(65353),Lt=ce.__importStar(Dt(67294)),ge=ce.__importDefault(Dt(36608));Qt.default=function(Nt){return function(Rt){var ue;return ue=function(se){ce.__extends(st,se);function st(Ft){var Pt=se.call(this,Ft)||this;return Pt.state={loaded:Pt.isLoadReady()},Pt.loadJSAPI=Pt.loadJSAPI.bind(Pt),Pt.handleLoaded=Pt.handleLoaded.bind(Pt),Pt}return st.prototype.isLoadReady=function(){return!!(window.BMapGL&&window.BMapGL.Map)},st.prototype.componentDidMount=function(){if(!this.isLoadReady()){if(!Nt.ak)throw new TypeError("MapApiLoaderHOC: ak is required");this.loadJSAPI()}},st.prototype.componentWillUnmount=function(){this.apiTimer&&clearTimeout(this.apiTimer),this.loadedTimer&&clearTimeout(this.loadedTimer)},st.prototype.loadJSAPI=function(){var Ft=this;if(this.isLoadReady()){this.handleLoaded();return}if(window.loadingMap)this.apiTimer=window.setTimeout(function(){Ft.loadJSAPI()},300);else if(!window.MapApiLoaderCallback){window.loadingMap=!0,window.MapApiLoaderCallback=function(){delete window.loadingMap,delete window.MapApiLoaderCallback};var Pt=Nt.ak,It=Nt.booter,bt=document.createElement("script");bt.type="text/javascript",bt.src="//api.map.baidu.com/api?type=webgl&v=1.0&ak="+Pt+"&callback=MapApiLoaderCallback",It&&(window.BMAP_AUTHENTIC_KEY=Pt,bt.src=It),document.body.appendChild(bt),this.loadedTimer=window.setTimeout(function(){Ft.handleLoaded()},300)}},st.prototype.handleLoaded=function(){var Ft=this;if(!this.isLoadReady()){this.loadedTimer=window.setTimeout(function(){Ft.handleLoaded()},300);return}this.setState({loaded:!0})},st.prototype.render=function(){var Ft=this.state.loaded;return Ft?Lt.default.createElement(Rt,ce.__assign({},this.props)):Lt.default.createElement("div",null,"loading...")},st}(Lt.Component),ue.displayName="MapApiLoaderHOC("+ge.default(Rt)+")",ue}}},74989:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(65353),Lt=ce.__importDefault(Dt(14746)),ge=ce.__importDefault(Dt(96774)),Nt=function(Rt){ce.__extends(ue,Rt);function ue(se){var st=Rt.call(this,se)||this;return st.options=["strokeColor","strokeWeight","strokeOpacity","strokeStyle","fillColor","fillOpacity","enableMassClear","enableEditing"],st}return ue.prototype.onDataUpdate=function(se){var st=this.props,Ft=st.center,Pt=st.radius,It=st.autoViewport,bt=se.center,re=se.radius,he=se.autoViewport,lt=Ft&&!ge.default(Ft,bt),ye=!!(Pt&&!ge.default(Pt,re)),ci=!ge.default(It,he);if(lt&&this.overlay.setCenter(this.parseCenter(Ft)),ye&&this.overlay.setRadius(Pt),It&&(lt||ye||ci)){var Or=this.overlay.getBounds(),Ce=this.props.map.getViewport(Or,this.props.viewportOptions||{});this.props.map.setViewport(Ce)}},ue.prototype.getOverlay=function(){var se=this.props,st=se.center,Ft=se.radius;return new BMapGL.Circle(this.parseCenter(st),Ft,this.getOptions())},ue.prototype.parseCenter=function(se){var st=this.props.coordType==="bd09mc",Ft;return se instanceof Array?Ft=new BMapGL.Point(se[0],se[1]):se instanceof BMapGL.Point?Ft=se:Ft=new BMapGL.Point(se.lng,se.lat),st&&(Ft=BMapGL.Projection.convertMC2LL(Ft)),Ft},ue.prototype.render=function(){return null},ue}(Lt.default);Qt.default=Nt},23358:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(65353),Lt=Dt(39001),ge=ce.__importDefault(Dt(96774)),Nt=ce.__importDefault(Dt(92425)),Rt=Dt(40671),ue=function(se){ce.__extends(st,se);function st(Ft){var Pt=se.call(this,Ft)||this;return Pt.options=["zIndex","offset","unit"],Pt}return st.prototype.componentDidUpdate=function(Ft){ge.default(this.props,Ft)||this.initialize()},st.prototype.componentDidMount=function(){this.initialize()},st.prototype.componentWillUnmount=function(){this.destroy()},st.prototype.destroy=function(){this.overlay&&this.map&&!this.map._destroyed&&(this.overlay.destroy(),this.map.removeOverlay(this.overlay),this.instance=this.overlay=void 0)},st.prototype.initialize=function(){var Ft=this.map=this.getMap();if(!!Ft){this.destroy();var Pt=this.getOptions();Pt.html=this.props.children;var It=this.parsePosition(this.props.position);this.instance=this.overlay=new Nt.default(It,Pt),Ft.addOverlay(this.overlay),this.props.autoViewport&&Ft.setCenter(It)}},st.prototype.parsePosition=function(Ft){var Pt=this.props.coordType==="bd09mc",It;return Ft instanceof Array?It=new BMapGL.Point(Ft[0],Ft[1]):Ft instanceof BMapGL.Point?It=Ft:It=new BMapGL.Point(Ft.lng,Ft.lat),Pt&&(It=BMapGL.Projection.convertMC2LL(It)),It},st.prototype.render=function(){return null},st.contextType=Rt.MapContext,st}(Lt.Component);Qt.default=ue},92425:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(73935);function Lt(ge,Nt){this._point=new BMapGL.Point(ge.lng,ge.lat),this._options=Nt||{},this._html=Nt.html||"";var Rt=new BMapGL.Overlay;for(var ue in Rt)ue!=="initialize"&&ue!=="draw"&&ue!=="destroy"&&(this.__proto__[ue]=Rt[ue])}Lt.prototype.initialize=function(ge){return this._map=ge,this._div=document.createElement("div"),this._div.style.position="absolute",this._div.style.zIndex=this._options.zIndex||BMapGL.Overlay.getZIndex(this._point.lat),ce.render(this._html,this._div),this._div.onmousedown=function(Nt){return Nt=Nt||window.event,Nt.preventDefault?Nt.preventDefault():Nt.returnValue=!1,!1},ge.getPanes().floatShadow.appendChild(this._div),this._div},Lt.prototype.destroy=function(){ce.unmountComponentAtNode(this._div)},Lt.prototype.draw=function(){var ge=this._map,Nt=ge.pointToOverlayPixel(this._point),Rt={width:0,height:0};this._options&&this._options.offset&&(Rt=this._options.offset);var ue=Rt.width,se=Rt.height;this._options&&this._options.unit&&this._options.unit==="m"&&(ue/=ge.getZoomUnits(),se/=ge.getZoomUnits()),this._div.style.left=Nt.x+ue+"px",this._div.style.top=Nt.y+se+"px",this._div.style.transform="translate(-50%, -100%)"},Qt.default=Lt},14746:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(65353),Lt=Dt(39001),ge=ce.__importDefault(Dt(77818)),Nt=ce.__importDefault(Dt(96774)),Rt=Dt(40671),ue=["click","dblclick","rightclick","mousedown","mouseup","mouseout","mouseover","mousemove","remove","lineupdate"],se={enableMassClear:["enableMassClear","disableMassClear"],enableEditing:["enableEditing","disableEditing"]},st=function(Ft){ce.__extends(Pt,Ft);function Pt(It){var bt=Ft.call(this,It)||this;return bt.options=["strokeColor","strokeWeight","strokeOpacity","strokeStyle","fillColor","fillOpacity","enableMassClear","enableEditing","enableClicking"],bt}return Pt.prototype.componentDidUpdate=function(It){var bt=this.props,re=bt.strokeColor,he=bt.strokeWeight,lt=bt.strokeOpacity,ye=bt.strokeStyle,ci=bt.fillColor,Or=bt.fillOpacity,Ce=It.strokeColor,ti=It.strokeWeight,Ai=It.strokeOpacity,Ti=It.strokeStyle,Fn=It.fillColor,xo=It.fillOpacity,Wi=!Nt.default(re,Ce),Xi=!Nt.default(he,ti),Ue=!Nt.default(lt,Ai),jo=!Nt.default(ye,Ti),Ma=!Nt.default(ci,Fn),ia=!Nt.default(Or,xo);(Wi||Xi||Ue||jo||Ma||ia)&&this.overlay.setOptions(this.getOptions()),this.onDataUpdate(It)},Pt.prototype.componentDidMount=function(){this.initialize()},Pt.prototype.componentWillUnmount=function(){this.destroy()},Pt.prototype.destroy=function(){this.overlay&&this.map&&!this.map._destroyed&&(this.map.removeOverlay(this.overlay),this.instance=this.overlay=void 0)},Pt.prototype.initialize=function(){var It=this.map=this.getMap();if(!!It){this.destroy(),this.instance=this.overlay=this.getOverlay(),It.addOverlay(this.overlay);var bt;if(this.overlay instanceof BMapGL.Polyline||this.overlay instanceof BMapGL.Polygon){var re=this.overlay.getPath();bt=It.getViewport(re,this.props.viewportOptions||{})}else if(this.overlay instanceof BMapGL.Circle){var he=this.overlay.getBounds();bt=It.getViewport(he,this.props.viewportOptions||{})}bt&&this.props.autoViewport&&It.setViewport(bt)}},Pt.prototype.getOverlay=function(){throw new Error("Method getOverlay not implemented.")},Pt.prototype.onDataUpdate=function(It){throw new Error("Method onDataUpdate not implemented.")},Pt.contextType=Rt.MapContext,Pt}(Lt.Component);Qt.default=ge.default(st,ue,se)},92725:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(65353),Lt=Dt(39001),ge=ce.__importDefault(Dt(77818)),Nt=Dt(73935),Rt=Dt(40671),ue=["close","open","maximize","restore","clickclose"],se={enableMaximize:["enableMaximize","disableMaximize"],enableAutoPan:["enableAutoPan","disableAutoPan"],enableCloseOnClick:["enableCloseOnClick","disableCloseOnClick"]},st=function(Ft){ce.__extends(Pt,Ft);function Pt(It){var bt=Ft.call(this,It)||this;return bt.options=["width","height","maxWidth","offset","title","enableMassClear"],bt}return Pt.prototype.componentDidUpdate=function(It){this.initialize()},Pt.prototype.componentDidMount=function(){this.initialize()},Pt.prototype.componentWillUnmount=function(){this.destroy()},Pt.prototype.destroy=function(){this.content&&Nt.unmountComponentAtNode(this.content),this.infoWindow&&this.map&&!this.map._destroyed&&(this.map.closeInfoWindow(),this.instance=this.infoWindow=void 0)},Pt.prototype.initialize=function(){var It=this.map=this.getMap();if(!!It){this.destroy();var bt=this.getOptions(),re=this.parsePosition(this.props.position);if(this.instance=this.infoWindow=new BMapGL.InfoWindow(this.props.text||"",bt),It.openInfoWindow(this.infoWindow,re),this.props.children!==void 0){var he=this.content=document.createElement("div");Nt.render(this.props.children,he),this.infoWindow.setContent(he)}}},Pt.prototype.parsePosition=function(It){var bt=this.props.coordType==="bd09mc",re;return It instanceof Array?re=new BMapGL.Point(It[0],It[1]):It instanceof BMapGL.Point?re=It:re=new BMapGL.Point(It.lng,It.lat),bt&&(re=BMapGL.Projection.convertMC2LL(re)),re},Pt.prototype.render=function(){return null},Pt.contextType=Rt.MapContext,Pt}(Lt.Component);st.defaultProps={},Qt.default=ge.default(st,ue,se)},76108:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(65353),Lt=Dt(39001),ge=ce.__importDefault(Dt(77818)),Nt=ce.__importDefault(Dt(96774)),Rt=Dt(40671),ue=["click","dblclick","rightclick","mousedown","mouseup","mouseout","mouseover","mousemove","remove"],se={enableMassClear:["enableMassClear","disableMassClear"]},st=function(Ft){ce.__extends(Pt,Ft);function Pt(It){var bt=Ft.call(this,It)||this;return bt.options=["position","offset","enableMassClear"],bt}return Pt.prototype.componentDidUpdate=function(It){var bt=this.props,re=bt.position,he=bt.offset,lt=bt.text,ye=bt.style,ci=It.position,Or=It.offset,Ce=It.text,ti=It.style,Ai=re&&!Nt.default(re,ci),Ti=!!(he&&!Nt.default(he,Or)),Fn=!Nt.default(lt,Ce),xo=!!(ye&&!Nt.default(ye,ti)),Wi=this.parsePosition(re);Ai&&this.label.setPosition(Wi),Ti&&this.label.setOffset(he),Fn&&this.label.setContent(lt),xo&&this.label.setStyle(ye)},Pt.prototype.componentDidMount=function(){this.initialize()},Pt.prototype.componentWillUnmount=function(){this.destroy()},Pt.prototype.destroy=function(){this.label&&this.map&&!this.map._destroyed&&(this.map.removeOverlay(this.label),this.instance=this.label=void 0)},Pt.prototype.initialize=function(){var It=this.map=this.getMap();if(!!It){this.destroy();var bt=this.getOptions(),re=this.parsePosition(this.props.position);bt.position=re,this.instance=this.label=new BMapGL.Label(this.props.text||"",bt),It.addOverlay(this.label),this.props.style&&this.label.setStyle(this.props.style)}},Pt.prototype.parsePosition=function(It){var bt=this.props.coordType==="bd09mc",re;return It instanceof Array?re=new BMapGL.Point(It[0],It[1]):It instanceof BMapGL.Point?re=It:re=new BMapGL.Point(It.lng,It.lat),bt&&(re=BMapGL.Projection.convertMC2LL(re)),re},Pt.prototype.render=function(){return null},Pt.contextType=Rt.MapContext,Pt}(Lt.Component);st.defaultProps={style:{color:"red"}},Qt.default=ge.default(st,ue,se)},5848:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(65353),Lt=Dt(39001),ge=ce.__importDefault(Dt(77818)),Nt=ce.__importDefault(Dt(96774)),Rt=Dt(40671);function ue(){for(var Pt="//mapopen.bj.bcebos.com/cms/react-bmap/markers_new2x_fbb9e99.png",It={simple_red:new BMapGL.Icon(Pt,new BMapGL.Size(42/2,66/2),{imageOffset:new BMapGL.Size(454/2,378/2),imageSize:new BMapGL.Size(600/2,600/2)}),simple_blue:new BMapGL.Icon(Pt,new BMapGL.Size(42/2,66/2),{imageOffset:new BMapGL.Size(454/2,450/2),imageSize:new BMapGL.Size(600/2,600/2)}),loc_red:new BMapGL.Icon(Pt,new BMapGL.Size(46/2,70/2),{imageOffset:new BMapGL.Size(400/2,378/2),imageSize:new BMapGL.Size(600/2,600/2)}),loc_blue:new BMapGL.Icon(Pt,new BMapGL.Size(46/2,70/2),{imageOffset:new BMapGL.Size(400/2,450/2),imageSize:new BMapGL.Size(600/2,600/2)}),start:new BMapGL.Icon(Pt,new BMapGL.Size(50/2,80/2),{imageOffset:new BMapGL.Size(400/2,278/2),imageSize:new BMapGL.Size(600/2,600/2)}),end:new BMapGL.Icon(Pt,new BMapGL.Size(50/2,80/2),{imageOffset:new BMapGL.Size(450/2,278/2),imageSize:new BMapGL.Size(600/2,600/2)}),location:new BMapGL.Icon(Pt,new BMapGL.Size(28/2,40/2),{imageOffset:new BMapGL.Size(248/2,466/2),imageSize:new BMapGL.Size(600/2,600/2)})},bt=1;bt<=10;bt++)It["red"+bt]=new BMapGL.Icon(Pt,new BMapGL.Size(42/2,66/2),{imageOffset:new BMapGL.Size(42/2*(bt-1),0),imageSize:new BMapGL.Size(600/2,600/2)});for(var bt=1;bt<=10;bt++)It["blue"+bt]=new BMapGL.Icon(Pt,new BMapGL.Size(42/2,66/2),{imageOffset:new BMapGL.Size(42/2*(bt-1),132/2),imageSize:new BMapGL.Size(600/2,600/2)});return It}var se=["click","dblclick","mousedown","mouseup","mouseout","mouseover","remove","infowindowclose","infowindowopen","dragstart","dragging","dragend","rightclick"],st={enableMassClear:["enableMassClear","disableMassClear"],enableDragging:["enableDragging","disableDragging"]},Ft=function(Pt){ce.__extends(It,Pt);function It(bt){var re=Pt.call(this,bt)||this;return re.options=["offset","icon","enableMassClear","enableDragging","enableClicking","raiseOnDrag","draggingCursor","rotation","title"],re.defaultIcons=ue(),re}return It.prototype.componentDidUpdate=function(bt){if(!this.map){this.initialize();return}var re=this.props,he=re.position,lt=re.icon,ye=re.autoViewport,ci=re.offset,Or=re.isTop,Ce=bt.position,ti=bt.icon,Ai=bt.autoViewport,Ti=bt.offset,Fn=bt.isTop,xo=he&&!Nt.default(he,Ce),Wi=!!(lt&&!Nt.default(lt,ti)),Xi=!Nt.default(ye,Ai),Ue=!!(ci&&!Nt.default(ci,Ti)),jo=!Nt.default(Or,Fn),Ma=this.parsePosition(he);if(xo&&this.marker.setPosition(Ma),Wi){var ia=this.parseIcon(lt);this.marker.setIcon(ia)}Ue&&this.marker.setOffset(ci),jo&&this.marker.setTop(!!Or),ye&&(xo||Xi)&&this.map.setCenter(Ma)},It.prototype.componentDidMount=function(){this.initialize()},It.prototype.componentWillUnmount=function(){this.destroy()},It.prototype.destroy=function(){this.marker&&this.map&&!this.map._destroyed&&(this.map.removeOverlay(this.marker),this.instance=this.marker=void 0)},It.prototype.initialize=function(){var bt=this.map=this.getMap();if(!!bt){this.destroy();var re=this.parseIcon(this.props.icon),he=this.parsePosition(this.props.position),lt=this.getOptions();lt.icon=re,this.instance=this.marker=new BMapGL.Marker(he,lt),this.props.isTop&&this.marker.setTop(!0),bt.addOverlay(this.marker),this.props.autoViewport&&bt.setCenter(he)}},It.prototype.parsePosition=function(bt){var re=this.props.coordType==="bd09mc",he;return bt instanceof Array?he=new BMapGL.Point(bt[0],bt[1]):bt instanceof BMapGL.Point?he=bt:he=new BMapGL.Point(bt.lng,bt.lat),re&&(he=BMapGL.Projection.convertMC2LL(he)),he},It.prototype.parseIcon=function(bt){var re;return bt&&bt instanceof BMapGL.Icon?re=bt:bt&&this.defaultIcons[bt]?re=this.defaultIcons[bt]:re=this.defaultIcons.simple_red,re},It.prototype.render=function(){return null},It.contextType=Rt.MapContext,It}(Lt.Component);Ft.defaultProps={icon:"simple_red"},Qt.default=ge.default(Ft,se,st)},53950:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(65353),Lt=ce.__importDefault(Dt(14746)),ge=ce.__importDefault(Dt(96774)),Nt=function(Rt){ce.__extends(ue,Rt);function ue(se){var st=Rt.call(this,se)||this;return st.options=["strokeColor","strokeWeight","strokeOpacity","strokeStyle","fillColor","fillOpacity","enableMassClear","enableEditing"],st}return ue.prototype.onDataUpdate=function(se){var st=this.props,Ft=st.path,Pt=st.autoViewport,It=se.path,bt=se.autoViewport,re=Ft&&!ge.default(Ft,It),he=!ge.default(Pt,bt);if(re&&this.overlay.setPath(this.parsePath(Ft)),Pt&&(re||he)){var lt=this.overlay.getPath(),ye=this.props.map.getViewport(lt,this.props.viewportOptions||{});this.props.map.setViewport(ye)}},ue.prototype.getOverlay=function(){var se=this.parsePath(this.props.path);return new BMapGL.Polygon(se,this.getOptions())},ue.prototype.parsePath=function(se){var st=this.props.coordType==="bd09mc",Ft=se.map(function(Pt){var It;return Pt instanceof Array?It=new BMapGL.Point(Pt[0],Pt[1]):Pt instanceof BMapGL.Point?It=Pt:It=new BMapGL.Point(Pt.lng,Pt.lat),st&&(It=BMapGL.Projection.convertMC2LL(It)),It});return Ft},ue.prototype.render=function(){return null},ue}(Lt.default);Qt.default=Nt},37636:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(65353),Lt=ce.__importDefault(Dt(14746)),ge=ce.__importDefault(Dt(96774)),Nt=function(Rt){ce.__extends(ue,Rt);function ue(se){var st=Rt.call(this,se)||this;return st.options=["strokeColor","strokeWeight","strokeOpacity","strokeStyle","dashArray","enableMassClear","enableEditing"],st}return ue.prototype.onDataUpdate=function(se){var st=this.props,Ft=st.path,Pt=st.autoViewport,It=se.path,bt=se.autoViewport,re=Ft&&!ge.default(Ft,It),he=!ge.default(Pt,bt);if(re&&this.overlay.setPath(this.parsePath(Ft)),Pt&&(re||he)){var lt=this.overlay.getPath(),ye=this.props.map.getViewport(lt,this.props.viewportOptions||{});this.props.map.setViewport(ye)}},ue.prototype.getOverlay=function(){var se=this.parsePath(this.props.path);return new BMapGL.Polyline(se,this.getOptions())},ue.prototype.parsePath=function(se){var st=this.props.coordType==="bd09mc",Ft=se.map(function(Pt){var It;return Pt instanceof Array?It=new BMapGL.Point(Pt[0],Pt[1]):Pt instanceof BMapGL.Point?It=Pt:It=new BMapGL.Point(Pt.lng,Pt.lat),st&&(It=BMapGL.Projection.convertMC2LL(It)),It});return Ft},ue.prototype.render=function(){return null},ue}(Lt.default);Qt.default=Nt},66242:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(65353),Lt=ce.__importStar(Dt(67294)),ge=Dt(39001),Nt=ce.__importDefault(Dt(77818)),Rt=["confirm","highlight"],ue={},se=function(st){ce.__extends(Ft,st);function Ft(Pt){var It=st.call(this,Pt)||this;return It.el=Lt.default.createRef(),It.options=["location","onSearchComplete","input","types"],It}return Ft.prototype.componentDidMount=function(){this.initialize()},Ft.prototype.componentWillUnmount=function(){this.destroy()},Ft.prototype.destroy=function(){this.ac&&(this.ac.dispose(),this.instance=this.ac=void 0)},Ft.prototype.initialize=function(){this.destroy();var Pt=this.getOptions();Pt.input||(Pt.input=this.el.current),this.ac=this.instance=new BMapGL.Autocomplete(Pt)},Ft.prototype.render=function(){return Lt.default.createElement(Lt.Fragment,null,!this.props.input&&Lt.default.createElement("input",{className:"react-bmapgl-autocomplete",ref:this.el,style:this.props.style}))},Ft}(ge.Component);se.defaultProps={},Qt.default=Nt.default(se,Rt,ue)},19549:function(){"use strict";window._hmt_private||(window._hmt=window._hmt||[],function(){var oi=document.createElement("script");oi.src="https://hm.baidu.com/hm.js?b97569d26a525941d8d163729d284198";var Qt=document.getElementsByTagName("script")[0];Qt.parentNode.insertBefore(oi,Qt)}())},13425:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(65353),Lt=Dt(67294),ge=function(Nt){ce.__extends(Rt,Nt);function Rt(){var ue=Nt!==null&&Nt.apply(this,arguments)||this;return ue.options=[],ue}return Rt.prototype.getMap=function(){return this.props.map||this.context.map},Rt.prototype.getInstance=function(ue){return ue.instance},Rt.prototype.getOptions=function(ue){ue===void 0&&(ue=this.props);var se={};return this.options.map(function(st){ue[st]!==void 0&&(se[st]=ue[st])}),se},Rt}(Lt.PureComponent);Qt.default=ge},77818:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.toggleMethods=Qt.unregisterEvents=Qt.registerEvents=void 0;var ce=Dt(65353),Lt=ce.__importDefault(Dt(96774));function ge(Ft,Pt,It){It&&Pt&&Pt.addEventListener&&(Ft.registeredEvents={},It.forEach(function(bt){var re="on"+bt.substr(0,1).toUpperCase()+bt.substr(1);Ft.props[re]&&typeof Ft.props[re]=="function"&&(Pt.addEventListener(bt,Ft.props[re]),Ft.registeredEvents[bt]=Ft.props[re])}))}Qt.registerEvents=ge;function Nt(Ft,Pt){Ft.registeredEvents&&Pt&&Pt.removeEventListener&&(Object.keys(Ft.registeredEvents).forEach(function(It){Pt.removeEventListener(It,Ft.registeredEvents[It])}),Ft.registeredEvents=null)}Qt.unregisterEvents=Nt;function Rt(Ft,Pt,It,bt){It&&Pt&&Object.keys(It).forEach(function(re){(bt===void 0&&Ft.props[re]!==void 0||bt!==void 0&&!Lt.default(Ft.props[re],bt[re]))&&(Ft.props[re]?Pt&&Pt[It[re][0]]():Pt&&Pt[It[re][1]]())})}Qt.toggleMethods=Rt;function ue(Ft,Pt){var It=Ft.prototype.getInstance,bt=Ft.prototype.componentDidMount,re=Ft.prototype.componentDidUpdate;return It&&Pt&&Object.keys(Pt).length>0&&(Ft.prototype.componentDidMount=function(){bt&&bt.call(this),Rt(this,It(this),Pt)},Ft.prototype.componentDidUpdate=function(he,lt){Rt(this,It(this),Pt,he),re&&re.call(this,he,lt)}),Ft}function se(Ft,Pt){var It=Ft.prototype.getInstance,bt=Ft.prototype.componentDidUpdate,re=Ft.prototype.componentDidMount,he=Ft.prototype.componentWillUnmount;return Pt&&Pt.length>0&&(Ft.prototype.componentDidMount=function(){re&&re.call(this),ge(this,It(this),Pt)},Ft.prototype.componentDidUpdate=function(lt,ye){Lt.default(this.props,lt)||Nt(this,It(this)),bt&&bt.call(this,lt,ye),Lt.default(this.props,lt)||ge(this,It(this),Pt)},Ft.prototype.componentWillUnmount=function(){Nt(this,It(this)),he&&he.call(this)}),Ft}function st(Ft,Pt,It){var bt=ue(Ft,It);return bt=se(bt,Pt),bt}Qt.default=st},39001:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(77818);Object.defineProperty(Qt,"Wrapper",{enumerable:!0,get:function(){return ce.default}});var Lt=Dt(13425);Object.defineProperty(Qt,"Component",{enumerable:!0,get:function(){return Lt.default}})},47636:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(65353);Dt(19549);var Lt=Dt(40671);Object.defineProperty(Qt,"Map",{enumerable:!0,get:function(){return Lt.default}});var ge=Dt(44605);Object.defineProperty(Qt,"MapApiLoaderHOC",{enumerable:!0,get:function(){return ge.default}});var Nt=Dt(15639);Object.defineProperty(Qt,"MapTypeControl",{enumerable:!0,get:function(){return Nt.default}});var Rt=Dt(21303);Object.defineProperty(Qt,"ScaleControl",{enumerable:!0,get:function(){return Rt.default}});var ue=Dt(36565);Object.defineProperty(Qt,"ZoomControl",{enumerable:!0,get:function(){return ue.default}});var se=Dt(32066);Object.defineProperty(Qt,"NavigationControl",{enumerable:!0,get:function(){return se.default}});var st=Dt(18771);Object.defineProperty(Qt,"CityListControl",{enumerable:!0,get:function(){return st.default}});var Ft=Dt(5848);Object.defineProperty(Qt,"Marker",{enumerable:!0,get:function(){return Ft.default}});var Pt=Dt(37636);Object.defineProperty(Qt,"Polyline",{enumerable:!0,get:function(){return Pt.default}});var It=Dt(53950);Object.defineProperty(Qt,"Polygon",{enumerable:!0,get:function(){return It.default}});var bt=Dt(74989);Object.defineProperty(Qt,"Circle",{enumerable:!0,get:function(){return bt.default}});var re=Dt(92725);Object.defineProperty(Qt,"InfoWindow",{enumerable:!0,get:function(){return re.default}});var he=Dt(76108);Object.defineProperty(Qt,"Label",{enumerable:!0,get:function(){return he.default}});var lt=Dt(23358);Object.defineProperty(Qt,"CustomOverlay",{enumerable:!0,get:function(){return lt.default}});var ye=Dt(12840);Object.defineProperty(Qt,"MapvglView",{enumerable:!0,get:function(){return ye.default}});var ci=Dt(14901);Object.defineProperty(Qt,"MapvglLayer",{enumerable:!0,get:function(){return ci.default}});var Or=Dt(50249);Object.defineProperty(Qt,"TrafficLayer",{enumerable:!0,get:function(){return Or.default}});var Ce=Dt(39647);Object.defineProperty(Qt,"PanoramaLayer",{enumerable:!0,get:function(){return Ce.default}});var ti=Dt(77079);Object.defineProperty(Qt,"DrawingManager",{enumerable:!0,get:function(){return ti.default}});var Ai=Dt(34418);Object.defineProperty(Qt,"DistanceTool",{enumerable:!0,get:function(){return Ai.default}});var Ti=Dt(66242);Object.defineProperty(Qt,"AutoComplete",{enumerable:!0,get:function(){return Ti.default}});var Fn=Dt(95e3);Object.defineProperty(Qt,"Arc",{enumerable:!0,get:function(){return Fn.default}}),Qt.mapvgl=ce.__importStar(Dt(70507)),ce.__exportStar(Dt(31889),Qt)},36608:function(oi,Qt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});function Dt(ce){if(typeof ce=="string")return ce;if(!!ce)return ce.displayName||ce.name||"Component"}Qt.default=Dt},31889:function(oi,Qt,Dt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});var ce=Dt(65353);ce.__exportStar(Dt(77233),Qt);var Lt=Dt(62155);Object.defineProperty(Qt,"isString",{enumerable:!0,get:function(){return Lt.default}});var ge=Dt(36608);Object.defineProperty(Qt,"getDisplayName",{enumerable:!0,get:function(){return ge.default}})},62155:function(oi,Qt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0});function Dt(ce){return Object.prototype.toString.call(ce)==="[object String]"}Qt.default=Dt},77233:function(oi,Qt){"use strict";Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.requireScript=Qt.requireCss=void 0;var Dt=document.head||document.getElementsByTagName("head")[0],ce={};function Lt(Rt){return new Promise(function(ue,se){if(Rt in ce){ue();return}var st=document.createElement("link");st.type="text/css",st.rel="stylesheet",st.href=Rt,st.onerror=function(Ft){Dt.removeChild(st),se(new URIError("The css "+Rt+" is no accessible."))},st.onload=function(){ce[Rt]=!0,ue()},Dt.appendChild(st)})}Qt.requireCss=Lt;function ge(Rt){return new Promise(function(ue,se){if(Rt in ce){ue();return}var st=document.createElement("script");st.type="text/javascript",st.src=Rt,st.onerror=function(Ft){Dt.removeChild(st),se(new URIError("The Script "+Rt+" is no accessible."))},Nt(st)?st.onload=function(){ce[Rt]=!0,ue()}:st.onreadystatechange=function(){(st.readyState=="loaded"||st.readyState=="complete")&&(st.onreadystatechange=null,ce[Rt]=!0,ue())},Dt.appendChild(st)})}Qt.requireScript=ge;function Nt(Rt){return Rt=Rt||document.createElement("script"),"onload"in Rt?!0:(Rt.setAttribute("onload",""),typeof Rt.onload=="function")}},96774:function(oi){oi.exports=function(Dt,ce,Lt,ge){var Nt=Lt?Lt.call(ge,Dt,ce):void 0;if(Nt!==void 0)return!!Nt;if(Dt===ce)return!0;if(typeof Dt!="object"||!Dt||typeof ce!="object"||!ce)return!1;var Rt=Object.keys(Dt),ue=Object.keys(ce);if(Rt.length!==ue.length)return!1;for(var se=Object.prototype.hasOwnProperty.bind(ce),st=0;st<Rt.length;st++){var Ft=Rt[st];if(!se(Ft))return!1;var Pt=Dt[Ft],It=ce[Ft];if(Nt=Lt?Lt.call(ge,Pt,It,Ft):void 0,Nt===!1||Nt===void 0&&Pt!==It)return!1}return!0}}}]);
