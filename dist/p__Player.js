(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[131],{98679:function(x,_,t){"use strict";t.r(_),t.d(_,{default:function(){return C}});var c=t(25952),h=t(45782),g=t(59301),w=t(23491),a=t(37712);function C(){var o=(0,w.Z)({list:[],path:""}),L=(0,g.useState)(!1),E=(0,h.Z)(L,2),M=E[0],m=E[1],l=(0,g.useRef)(null),f=(0,g.useRef)(null),n=(0,g.useRef)(null),s=function(){var e=document.getElementById("video");return new Promise(function(v,i){var d,b="",P=document.createElement("canvas"),k=e==null?void 0:e.width,R=e==null?void 0:e.height;P.width=k,P.height=R,(d=P.getContext("2d"))===null||d===void 0||d.drawImage(e,0,0,k,R),setTimeout(function(){b=P.toDataURL("image/jpeg"),console.log(b),document.getElementById("testImg").src=b,v(b)},0)})},r=function(e){var v=[];return e?v=e:v=o.list,v.length<1?"":v.map(function(i,d){return i?d===0?"M ".concat(i[0]," ").concat(i[1]):d===1?"L ".concat(i[0]," ").concat(i[1]):d===v.length-1?"".concat(i[0]," ").concat(i[1]," Z"):"".concat(i[0]," ").concat(i[1]):""}).join(",")},y=function(e){o.list.push([e.layerX,e.layerY]),o.path=r()},p=function(e){o.path=r([].concat((0,c.Z)(o.list),[[e.layerX,e.layerY]]))},O=function(e){o.list.push([e.offsetX,e.offsetY]),o.path=r()},j=function(){o.path=r()};return(0,g.useEffect)(function(){var u,e,v,i;if(!!l.current)return(u=l.current)===null||u===void 0||u.addEventListener("click",y),(e=l.current)===null||e===void 0||e.addEventListener("mousemove",p),(v=f.current)===null||v===void 0||v.addEventListener("click",O),(i=n.current)===null||i===void 0||i.addEventListener("mouseleave",j),function(){var d,b,P,k;(d=l.current)===null||d===void 0||d.removeEventListener("click",y),(b=l.current)===null||b===void 0||b.removeEventListener("mousemove",p),(P=f.current)===null||P===void 0||P.removeEventListener("click",O),(k=n.current)===null||k===void 0||k.removeEventListener("mouseleave",j)}},[]),(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{onClick:s,children:"\u622A\u56FE"}),(0,a.jsx)("button",{onClick:function(){return m(!0)},children:"\u6807\u8BB0\u70B9"}),(0,a.jsx)("button",{onClick:function(){console.log(o.list),m(!1),o.list=[],o.path=""},children:"\u63D0\u4EA4"}),(0,a.jsx)("br",{}),(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"500",height:"300",ref:n,children:[(0,a.jsxs)("foreignObject",{x:"0",y:"0",width:"500",height:"300",children:[(0,a.jsx)("div",{ref:l,className:"video-marker-cover",style:{width:"500px",height:"300px",display:M?"block":"none"}}),(0,a.jsx)("video",{autoPlay:!0,muted:!0,src:"/antdpro-base-demo/public/video/big_buck_bunny.mp4",width:500,height:300,id:"video",controls:!0})]}),(0,a.jsx)("path",{ref:f,fill:"none",stroke:"red",d:o.path})]}),(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"500",height:"300",children:[(0,a.jsx)("foreignObject",{x:"0",y:"0",width:"500",height:"300",children:(0,a.jsx)("div",{children:(0,a.jsx)("img",{src:"",width:"500",height:"300",id:"testImg",alt:""})})}),(0,a.jsx)("path",{fill:"none",stroke:"red",d:o.path})]})]})}},23491:function(x,_,t){"use strict";t.d(_,{Z:function(){return f}});var c=t(59301),h=t(19308),g=t.n(h);function w(n,s){if(n===s)return!0;for(var r=0;r<n.length;r++)if(!Object.is(n[r],s[r]))return!1;return!0}function a(n,s){var r=(0,c.useRef)({deps:s,obj:void 0,initialized:!1}).current;return(r.initialized===!1||!w(r.deps,s))&&(r.deps=s,r.obj=n(),r.initialized=!0),r.obj}var C=t(72131),o=function(){var n=(0,C.__read)((0,c.useState)({}),2),s=n[1];return(0,c.useCallback)(function(){return s({})},[])},L=o,E=new WeakMap,M=new WeakMap;function m(n,s){var r=E.get(n);if(r)return r;if(M.has(n))return n;var y=new Proxy(n,{get:function(p,O,j){var u=Reflect.get(p,O,j);return g()(u)||Array.isArray(u)?m(u,s):u},set:function(p,O,j){var u=Reflect.set(p,O,j);return s(),u},deleteProperty:function(p,O){var j=Reflect.deleteProperty(p,O);return s(),j}});return E.set(n,y),M.set(y,n),y}function l(n){var s=L(),r=(0,c.useRef)(n),y=a(function(){return m(r.current,function(){s()})},[]);return y}var f=l},49217:function(x,_,t){var c=t(31030),h=c(Object.getPrototypeOf,Object);x.exports=h},31030:function(x){function _(t,c){return function(h){return t(c(h))}}x.exports=_},19308:function(x,_,t){var c=t(86756),h=t(49217),g=t(93913),w="[object Object]",a=Function.prototype,C=Object.prototype,o=a.toString,L=C.hasOwnProperty,E=o.call(Object);function M(m){if(!g(m)||c(m)!=w)return!1;var l=h(m);if(l===null)return!0;var f=L.call(l,"constructor")&&l.constructor;return typeof f=="function"&&f instanceof f&&o.call(f)==E}x.exports=M}}]);
