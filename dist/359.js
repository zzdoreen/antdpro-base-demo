var x0=Math.pow;(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[359],{67154:function(Kt){function Ut(){return Kt.exports=Ut=Object.assign?Object.assign.bind():function(mt){for(var ct=1;ct<arguments.length;ct++){var ne=arguments[ct];for(var We in ne)({}).hasOwnProperty.call(ne,We)&&(mt[We]=ne[We])}return mt},Kt.exports.__esModule=!0,Kt.exports.default=Kt.exports,Ut.apply(null,arguments)}Kt.exports=Ut,Kt.exports.__esModule=!0,Kt.exports.default=Kt.exports},74020:function(Kt,Ut,mt){var ct=mt(34155);(function(We,ve){Kt.exports=ve()})(self,function(){return function(){var ne={"./node_modules/es6-promise/dist/es6-promise.js":function(we,ye,se){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */(function(te,Y){we.exports=Y()})(this,function(){"use strict";function te(Ze){var ke=typeof Ze;return Ze!==null&&(ke==="object"||ke==="function")}function Y(Ze){return typeof Ze=="function"}var I=void 0;Array.isArray?I=Array.isArray:I=function(ke){return Object.prototype.toString.call(ke)==="[object Array]"};var A=I,M=0,k=void 0,V=void 0,J=function(ke,rt){be[M]=ke,be[M+1]=rt,M+=2,M===2&&(V?V(Be):Le())};function F(Ze){V=Ze}function G(Ze){J=Ze}var $=typeof window!="undefined"?window:void 0,H=$||{},C=H.MutationObserver||H.WebKitMutationObserver,Q=typeof self=="undefined"&&typeof ct!="undefined"&&{}.toString.call(ct)==="[object process]",ae=typeof Uint8ClampedArray!="undefined"&&typeof importScripts!="undefined"&&typeof MessageChannel!="undefined";function ue(){return function(){return ct.nextTick(Be)}}function j(){return typeof k!="undefined"?function(){k(Be)}:ce()}function X(){var Ze=0,ke=new C(Be),rt=document.createTextNode("");return ke.observe(rt,{characterData:!0}),function(){rt.data=Ze=++Ze%2}}function oe(){var Ze=new MessageChannel;return Ze.port1.onmessage=Be,function(){return Ze.port2.postMessage(0)}}function ce(){var Ze=setTimeout;return function(){return Ze(Be,1)}}var be=new Array(1e3);function Be(){for(var Ze=0;Ze<M;Ze+=2){var ke=be[Ze],rt=be[Ze+1];ke(rt),be[Ze]=void 0,be[Ze+1]=void 0}M=0}function Ce(){try{var Ze=Function("return this")().require("vertx");return k=Ze.runOnLoop||Ze.runOnContext,j()}catch(ke){return ce()}}var Le=void 0;Q?Le=ue():C?Le=X():ae?Le=oe():$===void 0?Le=Ce():Le=ce();function Pe(Ze,ke){var rt=this,Lt=new this.constructor(Oe);Lt[Ve]===void 0&&mn(Lt);var Yt=rt._state;if(Yt){var Dt=arguments[Yt-1];J(function(){return ji(Yt,Lt,Dt,rt._result)})}else di(rt,Lt,Ze,ke);return Lt}function De(Ze){var ke=this;if(Ze&&typeof Ze=="object"&&Ze.constructor===ke)return Ze;var rt=new ke(Oe);return ai(rt,Ze),rt}var Ve=Math.random().toString(36).substring(2);function Oe(){}var dt=void 0,Nt=1,It=2;function gt(){return new TypeError("You cannot resolve a promise with itself")}function nt(){return new TypeError("A promises callback cannot return that same promise.")}function Ht(Ze,ke,rt,Lt){try{Ze.call(ke,rt,Lt)}catch(Yt){return Yt}}function Tt(Ze,ke,rt){J(function(Lt){var Yt=!1,Dt=Ht(rt,ke,function(ki){Yt||(Yt=!0,ke!==ki?ai(Lt,ki):Ai(Lt,ki))},function(ki){Yt||(Yt=!0,Ct(Lt,ki))},"Settle: "+(Lt._label||" unknown promise"));!Yt&&Dt&&(Yt=!0,Ct(Lt,Dt))},Ze)}function Gt(Ze,ke){ke._state===Nt?Ai(Ze,ke._result):ke._state===It?Ct(Ze,ke._result):di(ke,void 0,function(rt){return ai(Ze,rt)},function(rt){return Ct(Ze,rt)})}function hi(Ze,ke,rt){ke.constructor===Ze.constructor&&rt===Pe&&ke.constructor.resolve===De?Gt(Ze,ke):rt===void 0?Ai(Ze,ke):Y(rt)?Tt(Ze,ke,rt):Ai(Ze,ke)}function ai(Ze,ke){if(Ze===ke)Ct(Ze,gt());else if(te(ke)){var rt=void 0;try{rt=ke.then}catch(Lt){Ct(Ze,Lt);return}hi(Ze,ke,rt)}else Ai(Ze,ke)}function Ei(Ze){Ze._onerror&&Ze._onerror(Ze._result),ui(Ze)}function Ai(Ze,ke){Ze._state===dt&&(Ze._result=ke,Ze._state=Nt,Ze._subscribers.length!==0&&J(ui,Ze))}function Ct(Ze,ke){Ze._state===dt&&(Ze._state=It,Ze._result=ke,J(Ei,Ze))}function di(Ze,ke,rt,Lt){var Yt=Ze._subscribers,Dt=Yt.length;Ze._onerror=null,Yt[Dt]=ke,Yt[Dt+Nt]=rt,Yt[Dt+It]=Lt,Dt===0&&Ze._state&&J(ui,Ze)}function ui(Ze){var ke=Ze._subscribers,rt=Ze._state;if(ke.length!==0){for(var Lt=void 0,Yt=void 0,Dt=Ze._result,ki=0;ki<ke.length;ki+=3)Lt=ke[ki],Yt=ke[ki+rt],Lt?ji(rt,Lt,Yt,Dt):Yt(Dt);Ze._subscribers.length=0}}function ji(Ze,ke,rt,Lt){var Yt=Y(rt),Dt=void 0,ki=void 0,mi=!0;if(Yt){try{Dt=rt(Lt)}catch(Pn){mi=!1,ki=Pn}if(ke===Dt){Ct(ke,nt());return}}else Dt=Lt;ke._state!==dt||(Yt&&mi?ai(ke,Dt):mi===!1?Ct(ke,ki):Ze===Nt?Ai(ke,Dt):Ze===It&&Ct(ke,Dt))}function un(Ze,ke){try{ke(function(Lt){ai(Ze,Lt)},function(Lt){Ct(Ze,Lt)})}catch(rt){Ct(Ze,rt)}}var $i=0;function wt(){return $i++}function mn(Ze){Ze[Ve]=$i++,Ze._state=void 0,Ze._result=void 0,Ze._subscribers=[]}function pi(){return new Error("Array Methods must be provided an Array")}var ti=function(){function Ze(ke,rt){this._instanceConstructor=ke,this.promise=new ke(Oe),this.promise[Ve]||mn(this.promise),A(rt)?(this.length=rt.length,this._remaining=rt.length,this._result=new Array(this.length),this.length===0?Ai(this.promise,this._result):(this.length=this.length||0,this._enumerate(rt),this._remaining===0&&Ai(this.promise,this._result))):Ct(this.promise,pi())}return Ze.prototype._enumerate=function(rt){for(var Lt=0;this._state===dt&&Lt<rt.length;Lt++)this._eachEntry(rt[Lt],Lt)},Ze.prototype._eachEntry=function(rt,Lt){var Yt=this._instanceConstructor,Dt=Yt.resolve;if(Dt===De){var ki=void 0,mi=void 0,Pn=!1;try{ki=rt.then}catch(mr){Pn=!0,mi=mr}if(ki===Pe&&rt._state!==dt)this._settledAt(rt._state,Lt,rt._result);else if(typeof ki!="function")this._remaining--,this._result[Lt]=rt;else if(Yt===nn){var Mt=new Yt(Oe);Pn?Ct(Mt,mi):hi(Mt,rt,ki),this._willSettleAt(Mt,Lt)}else this._willSettleAt(new Yt(function(mr){return mr(rt)}),Lt)}else this._willSettleAt(Dt(rt),Lt)},Ze.prototype._settledAt=function(rt,Lt,Yt){var Dt=this.promise;Dt._state===dt&&(this._remaining--,rt===It?Ct(Dt,Yt):this._result[Lt]=Yt),this._remaining===0&&Ai(Dt,this._result)},Ze.prototype._willSettleAt=function(rt,Lt){var Yt=this;di(rt,void 0,function(Dt){return Yt._settledAt(Nt,Lt,Dt)},function(Dt){return Yt._settledAt(It,Lt,Dt)})},Ze}();function _i(Ze){return new ti(this,Ze).promise}function Vi(Ze){var ke=this;return A(Ze)?new ke(function(rt,Lt){for(var Yt=Ze.length,Dt=0;Dt<Yt;Dt++)ke.resolve(Ze[Dt]).then(rt,Lt)}):new ke(function(rt,Lt){return Lt(new TypeError("You must pass an array to race."))})}function nr(Ze){var ke=this,rt=new ke(Oe);return Ct(rt,Ze),rt}function Bs(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function cs(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var nn=function(){function Ze(ke){this[Ve]=wt(),this._result=this._state=void 0,this._subscribers=[],Oe!==ke&&(typeof ke!="function"&&Bs(),this instanceof Ze?un(this,ke):cs())}return Ze.prototype.catch=function(rt){return this.then(null,rt)},Ze.prototype.finally=function(rt){var Lt=this,Yt=Lt.constructor;return Y(rt)?Lt.then(function(Dt){return Yt.resolve(rt()).then(function(){return Dt})},function(Dt){return Yt.resolve(rt()).then(function(){throw Dt})}):Lt.then(rt,rt)},Ze}();nn.prototype.then=Pe,nn.all=_i,nn.race=Vi,nn.resolve=De,nn.reject=nr,nn._setScheduler=F,nn._setAsap=G,nn._asap=J;function Ms(){var Ze=void 0;if(typeof se.g!="undefined")Ze=se.g;else if(typeof self!="undefined")Ze=self;else try{Ze=Function("return this")()}catch(Lt){throw new Error("polyfill failed because global object is unavailable in this environment")}var ke=Ze.Promise;if(ke){var rt=null;try{rt=Object.prototype.toString.call(ke.resolve())}catch(Lt){}if(rt==="[object Promise]"&&!ke.cast)return}Ze.Promise=nn}return nn.polyfill=Ms,nn.Promise=nn,nn})},"./node_modules/events/events.js":function(we){"use strict";var ye=typeof Reflect=="object"?Reflect:null,se=ye&&typeof ye.apply=="function"?ye.apply:function(ce,be,Be){return Function.prototype.apply.call(ce,be,Be)},te;ye&&typeof ye.ownKeys=="function"?te=ye.ownKeys:Object.getOwnPropertySymbols?te=function(ce){return Object.getOwnPropertyNames(ce).concat(Object.getOwnPropertySymbols(ce))}:te=function(ce){return Object.getOwnPropertyNames(ce)};function Y(oe){console&&console.warn&&console.warn(oe)}var I=Number.isNaN||function(ce){return ce!==ce};function A(){A.init.call(this)}we.exports=A,we.exports.once=ue,A.EventEmitter=A,A.prototype._events=void 0,A.prototype._eventsCount=0,A.prototype._maxListeners=void 0;var M=10;function k(oe){if(typeof oe!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof oe)}Object.defineProperty(A,"defaultMaxListeners",{enumerable:!0,get:function(){return M},set:function(ce){if(typeof ce!="number"||ce<0||I(ce))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+ce+".");M=ce}}),A.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},A.prototype.setMaxListeners=function(ce){if(typeof ce!="number"||ce<0||I(ce))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+ce+".");return this._maxListeners=ce,this};function V(oe){return oe._maxListeners===void 0?A.defaultMaxListeners:oe._maxListeners}A.prototype.getMaxListeners=function(){return V(this)},A.prototype.emit=function(ce){for(var be=[],Be=1;Be<arguments.length;Be++)be.push(arguments[Be]);var Ce=ce==="error",Le=this._events;if(Le!==void 0)Ce=Ce&&Le.error===void 0;else if(!Ce)return!1;if(Ce){var Pe;if(be.length>0&&(Pe=be[0]),Pe instanceof Error)throw Pe;var De=new Error("Unhandled error."+(Pe?" ("+Pe.message+")":""));throw De.context=Pe,De}var Ve=Le[ce];if(Ve===void 0)return!1;if(typeof Ve=="function")se(Ve,this,be);else for(var Oe=Ve.length,dt=C(Ve,Oe),Be=0;Be<Oe;++Be)se(dt[Be],this,be);return!0};function J(oe,ce,be,Be){var Ce,Le,Pe;if(k(be),Le=oe._events,Le===void 0?(Le=oe._events=Object.create(null),oe._eventsCount=0):(Le.newListener!==void 0&&(oe.emit("newListener",ce,be.listener?be.listener:be),Le=oe._events),Pe=Le[ce]),Pe===void 0)Pe=Le[ce]=be,++oe._eventsCount;else if(typeof Pe=="function"?Pe=Le[ce]=Be?[be,Pe]:[Pe,be]:Be?Pe.unshift(be):Pe.push(be),Ce=V(oe),Ce>0&&Pe.length>Ce&&!Pe.warned){Pe.warned=!0;var De=new Error("Possible EventEmitter memory leak detected. "+Pe.length+" "+String(ce)+" listeners added. Use emitter.setMaxListeners() to increase limit");De.name="MaxListenersExceededWarning",De.emitter=oe,De.type=ce,De.count=Pe.length,Y(De)}return oe}A.prototype.addListener=function(ce,be){return J(this,ce,be,!1)},A.prototype.on=A.prototype.addListener,A.prototype.prependListener=function(ce,be){return J(this,ce,be,!0)};function F(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function G(oe,ce,be){var Be={fired:!1,wrapFn:void 0,target:oe,type:ce,listener:be},Ce=F.bind(Be);return Ce.listener=be,Be.wrapFn=Ce,Ce}A.prototype.once=function(ce,be){return k(be),this.on(ce,G(this,ce,be)),this},A.prototype.prependOnceListener=function(ce,be){return k(be),this.prependListener(ce,G(this,ce,be)),this},A.prototype.removeListener=function(ce,be){var Be,Ce,Le,Pe,De;if(k(be),Ce=this._events,Ce===void 0)return this;if(Be=Ce[ce],Be===void 0)return this;if(Be===be||Be.listener===be)--this._eventsCount==0?this._events=Object.create(null):(delete Ce[ce],Ce.removeListener&&this.emit("removeListener",ce,Be.listener||be));else if(typeof Be!="function"){for(Le=-1,Pe=Be.length-1;Pe>=0;Pe--)if(Be[Pe]===be||Be[Pe].listener===be){De=Be[Pe].listener,Le=Pe;break}if(Le<0)return this;Le===0?Be.shift():Q(Be,Le),Be.length===1&&(Ce[ce]=Be[0]),Ce.removeListener!==void 0&&this.emit("removeListener",ce,De||be)}return this},A.prototype.off=A.prototype.removeListener,A.prototype.removeAllListeners=function(ce){var be,Be,Ce;if(Be=this._events,Be===void 0)return this;if(Be.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):Be[ce]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete Be[ce]),this;if(arguments.length===0){var Le=Object.keys(Be),Pe;for(Ce=0;Ce<Le.length;++Ce)Pe=Le[Ce],Pe!=="removeListener"&&this.removeAllListeners(Pe);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(be=Be[ce],typeof be=="function")this.removeListener(ce,be);else if(be!==void 0)for(Ce=be.length-1;Ce>=0;Ce--)this.removeListener(ce,be[Ce]);return this};function $(oe,ce,be){var Be=oe._events;if(Be===void 0)return[];var Ce=Be[ce];return Ce===void 0?[]:typeof Ce=="function"?be?[Ce.listener||Ce]:[Ce]:be?ae(Ce):C(Ce,Ce.length)}A.prototype.listeners=function(ce){return $(this,ce,!0)},A.prototype.rawListeners=function(ce){return $(this,ce,!1)},A.listenerCount=function(oe,ce){return typeof oe.listenerCount=="function"?oe.listenerCount(ce):H.call(oe,ce)},A.prototype.listenerCount=H;function H(oe){var ce=this._events;if(ce!==void 0){var be=ce[oe];if(typeof be=="function")return 1;if(be!==void 0)return be.length}return 0}A.prototype.eventNames=function(){return this._eventsCount>0?te(this._events):[]};function C(oe,ce){for(var be=new Array(ce),Be=0;Be<ce;++Be)be[Be]=oe[Be];return be}function Q(oe,ce){for(;ce+1<oe.length;ce++)oe[ce]=oe[ce+1];oe.pop()}function ae(oe){for(var ce=new Array(oe.length),be=0;be<ce.length;++be)ce[be]=oe[be].listener||oe[be];return ce}function ue(oe,ce){return new Promise(function(be,Be){function Ce(Pe){oe.removeListener(ce,Le),Be(Pe)}function Le(){typeof oe.removeListener=="function"&&oe.removeListener("error",Ce),be([].slice.call(arguments))}X(oe,ce,Le,{once:!0}),ce!=="error"&&j(oe,Ce,{once:!0})})}function j(oe,ce,be){typeof oe.on=="function"&&X(oe,"error",ce,be)}function X(oe,ce,be,Be){if(typeof oe.on=="function")Be.once?oe.once(ce,be):oe.on(ce,be);else if(typeof oe.addEventListener=="function")oe.addEventListener(ce,function Ce(Le){Be.once&&oe.removeEventListener(ce,Ce),be(Le)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof oe)}},"./node_modules/webworkify-webpack/index.js":function(we,ye,se){function te(F){var G={};function $(C){if(G[C])return G[C].exports;var Q=G[C]={i:C,l:!1,exports:{}};return F[C].call(Q.exports,Q,Q.exports,$),Q.l=!0,Q.exports}$.m=F,$.c=G,$.i=function(C){return C},$.d=function(C,Q,ae){$.o(C,Q)||Object.defineProperty(C,Q,{configurable:!1,enumerable:!0,get:ae})},$.r=function(C){Object.defineProperty(C,"__esModule",{value:!0})},$.n=function(C){var Q=C&&C.__esModule?function(){return C.default}:function(){return C};return $.d(Q,"a",Q),Q},$.o=function(C,Q){return Object.prototype.hasOwnProperty.call(C,Q)},$.p="/",$.oe=function(C){throw console.error(C),C};var H=$($.s=ENTRY_MODULE);return H.default||H}var Y="[\\.|\\-|\\+|\\w|/|@]+",I="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+Y+").*?\\)";function A(F){return(F+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function M(F){return!isNaN(1*F)}function k(F,G,$){var H={};H[$]=[];var C=G.toString(),Q=C.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!Q)return H;for(var ae=Q[1],ue=new RegExp("(\\\\n|\\W)"+A(ae)+I,"g"),j;j=ue.exec(C);)j[3]!=="dll-reference"&&H[$].push(j[3]);for(ue=new RegExp("\\("+A(ae)+'\\("(dll-reference\\s('+Y+'))"\\)\\)'+I,"g");j=ue.exec(C);)F[j[2]]||(H[$].push(j[1]),F[j[2]]=se(j[1]).m),H[j[2]]=H[j[2]]||[],H[j[2]].push(j[4]);for(var X=Object.keys(H),oe=0;oe<X.length;oe++)for(var ce=0;ce<H[X[oe]].length;ce++)M(H[X[oe]][ce])&&(H[X[oe]][ce]=1*H[X[oe]][ce]);return H}function V(F){var G=Object.keys(F);return G.reduce(function($,H){return $||F[H].length>0},!1)}function J(F,G){for(var $={main:[G]},H={main:[]},C={main:{}};V($);)for(var Q=Object.keys($),ae=0;ae<Q.length;ae++){var ue=Q[ae],j=$[ue],X=j.pop();if(C[ue]=C[ue]||{},!(C[ue][X]||!F[ue][X])){C[ue][X]=!0,H[ue]=H[ue]||[],H[ue].push(X);for(var oe=k(F,F[ue][X],ue),ce=Object.keys(oe),be=0;be<ce.length;be++)$[ce[be]]=$[ce[be]]||[],$[ce[be]]=$[ce[be]].concat(oe[ce[be]])}}return H}we.exports=function(F,G){G=G||{};var $={main:se.m},H=G.all?{main:Object.keys($.main)}:J($,F),C="";Object.keys(H).filter(function(X){return X!=="main"}).forEach(function(X){for(var oe=0;H[X][oe];)oe++;H[X].push(oe),$[X][oe]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",C=C+"var "+X+" = ("+te.toString().replace("ENTRY_MODULE",JSON.stringify(oe))+")({"+H[X].map(function(ce){return""+JSON.stringify(ce)+": "+$[X][ce].toString()}).join(",")+`});
`}),C=C+"new (("+te.toString().replace("ENTRY_MODULE",JSON.stringify(F))+")({"+H.main.map(function(X){return""+JSON.stringify(X)+": "+$.main[X].toString()}).join(",")+"}))(self);";var Q=new window.Blob([C],{type:"text/javascript"});if(G.bare)return Q;var ae=window.URL||window.webkitURL||window.mozURL||window.msURL,ue=ae.createObjectURL(Q),j=new window.Worker(ue);return j.objectURL=ue,j}},"./src/config.js":function(we,ye,se){"use strict";se.r(ye),se.d(ye,{defaultConfig:function(){return te},createDefaultConfig:function(){return Y}});var te={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,lazyLoad:!0,lazyLoadMaxDuration:3*60,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:3*60,autoCleanupMinBackwardDuration:2*60,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function Y(){return Object.assign({},te)}},"./src/core/features.js":function(we,ye,se){"use strict";se.r(ye);var te=se("./src/io/io-controller.js"),Y=se("./src/config.js"),I=function(){function A(){}return A.supportMSEH264Playback=function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')},A.supportNetworkStreamIO=function(){var M=new te.default({},(0,Y.createDefaultConfig)()),k=M.loaderType;return M.destroy(),k=="fetch-stream-loader"||k=="xhr-moz-chunked-loader"},A.getNetworkLoaderTypeName=function(){var M=new te.default({},(0,Y.createDefaultConfig)()),k=M.loaderType;return M.destroy(),k},A.supportNativeMediaPlayback=function(M){A.videoElement==null&&(A.videoElement=window.document.createElement("video"));var k=A.videoElement.canPlayType(M);return k==="probably"||k=="maybe"},A.getFeatureList=function(){var M={mseFlvPlayback:!1,mseLiveFlvPlayback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return M.mseFlvPlayback=A.supportMSEH264Playback(),M.networkStreamIO=A.supportNetworkStreamIO(),M.networkLoaderName=A.getNetworkLoaderTypeName(),M.mseLiveFlvPlayback=M.mseFlvPlayback&&M.networkStreamIO,M.nativeMP4H264Playback=A.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),M.nativeWebmVP8Playback=A.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),M.nativeWebmVP9Playback=A.supportNativeMediaPlayback('video/webm; codecs="vp9"'),M},A}();ye.default=I},"./src/core/media-info.js":function(we,ye,se){"use strict";se.r(ye);var te=function(){function Y(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return Y.prototype.isComplete=function(){var I=this.hasAudio===!1||this.hasAudio===!0&&this.audioCodec!=null&&this.audioSampleRate!=null&&this.audioChannelCount!=null,A=this.hasVideo===!1||this.hasVideo===!0&&this.videoCodec!=null&&this.width!=null&&this.height!=null&&this.fps!=null&&this.profile!=null&&this.level!=null&&this.refFrames!=null&&this.chromaFormat!=null&&this.sarNum!=null&&this.sarDen!=null;return this.mimeType!=null&&this.duration!=null&&this.metadata!=null&&this.hasKeyframesIndex!=null&&I&&A},Y.prototype.isSeekable=function(){return this.hasKeyframesIndex===!0},Y.prototype.getNearestKeyframe=function(I){if(this.keyframesIndex==null)return null;var A=this.keyframesIndex,M=this._search(A.times,I);return{index:M,milliseconds:A.times[M],fileposition:A.filepositions[M]}},Y.prototype._search=function(I,A){var M=0,k=I.length-1,V=0,J=0,F=k;for(A<I[0]&&(M=0,J=F+1);J<=F;)if(V=J+Math.floor((F-J)/2),V===k||A>=I[V]&&A<I[V+1]){M=V;break}else I[V]<A?J=V+1:F=V-1;return M},Y}();ye.default=te},"./src/core/media-segment-info.js":function(we,ye,se){"use strict";se.r(ye),se.d(ye,{SampleInfo:function(){return te},MediaSegmentInfo:function(){return Y},IDRSampleList:function(){return I},MediaSegmentInfoList:function(){return A}});var te=function(){function M(k,V,J,F,G){this.dts=k,this.pts=V,this.duration=J,this.originalDts=F,this.isSyncPoint=G,this.fileposition=null}return M}(),Y=function(){function M(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return M.prototype.appendSyncPoint=function(k){k.isSyncPoint=!0,this.syncPoints.push(k)},M}(),I=function(){function M(){this._list=[]}return M.prototype.clear=function(){this._list=[]},M.prototype.appendArray=function(k){var V=this._list;k.length!==0&&(V.length>0&&k[0].originalDts<V[V.length-1].originalDts&&this.clear(),Array.prototype.push.apply(V,k))},M.prototype.getLastSyncPointBeforeDts=function(k){if(this._list.length==0)return null;var V=this._list,J=0,F=V.length-1,G=0,$=0,H=F;for(k<V[0].dts&&(J=0,$=H+1);$<=H;)if(G=$+Math.floor((H-$)/2),G===F||k>=V[G].dts&&k<V[G+1].dts){J=G;break}else V[G].dts<k?$=G+1:H=G-1;return this._list[J]},M}(),A=function(){function M(k){this._type=k,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(M.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),M.prototype.isEmpty=function(){return this._list.length===0},M.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},M.prototype._searchNearestSegmentBefore=function(k){var V=this._list;if(V.length===0)return-2;var J=V.length-1,F=0,G=0,$=J,H=0;if(k<V[0].originalBeginDts)return H=-1,H;for(;G<=$;)if(F=G+Math.floor(($-G)/2),F===J||k>V[F].lastSample.originalDts&&k<V[F+1].originalBeginDts){H=F;break}else V[F].originalBeginDts<k?G=F+1:$=F-1;return H},M.prototype._searchNearestSegmentAfter=function(k){return this._searchNearestSegmentBefore(k)+1},M.prototype.append=function(k){var V=this._list,J=k,F=this._lastAppendLocation,G=0;F!==-1&&F<V.length&&J.originalBeginDts>=V[F].lastSample.originalDts&&(F===V.length-1||F<V.length-1&&J.originalBeginDts<V[F+1].originalBeginDts)?G=F+1:V.length>0&&(G=this._searchNearestSegmentBefore(J.originalBeginDts)+1),this._lastAppendLocation=G,this._list.splice(G,0,J)},M.prototype.getLastSegmentBefore=function(k){var V=this._searchNearestSegmentBefore(k);return V>=0?this._list[V]:null},M.prototype.getLastSampleBefore=function(k){var V=this.getLastSegmentBefore(k);return V!=null?V.lastSample:null},M.prototype.getLastSyncPointBefore=function(k){for(var V=this._searchNearestSegmentBefore(k),J=this._list[V].syncPoints;J.length===0&&V>0;)V--,J=this._list[V].syncPoints;return J.length>0?J[J.length-1]:null},M}()},"./src/core/mse-controller.js":function(we,ye,se){"use strict";se.r(ye);var te=se("./node_modules/events/events.js"),Y=se.n(te),I=se("./src/utils/logger.js"),A=se("./src/utils/browser.js"),M=se("./src/core/mse-events.js"),k=se("./src/core/media-segment-info.js"),V=se("./src/utils/exception.js"),J=function(){function F(G){this.TAG="MSEController",this._config=G,this._emitter=new(Y()),this._config.isLive&&this._config.autoCleanupSourceBuffer==null&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new k.IDRSampleList}return F.prototype.destroy=function(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},F.prototype.on=function(G,$){this._emitter.addListener(G,$)},F.prototype.off=function(G,$){this._emitter.removeListener(G,$)},F.prototype.attachMediaElement=function(G){if(this._mediaSource)throw new V.IllegalStateException("MediaSource has been attached to an HTMLMediaElement!");var $=this._mediaSource=new window.MediaSource;$.addEventListener("sourceopen",this.e.onSourceOpen),$.addEventListener("sourceended",this.e.onSourceEnded),$.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=G,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),G.src=this._mediaSourceObjectURL},F.prototype.detachMediaElement=function(){if(this._mediaSource){var G=this._mediaSource;for(var $ in this._sourceBuffers){var H=this._pendingSegments[$];H.splice(0,H.length),this._pendingSegments[$]=null,this._pendingRemoveRanges[$]=null,this._lastInitSegments[$]=null;var C=this._sourceBuffers[$];if(C){if(G.readyState!=="closed"){try{G.removeSourceBuffer(C)}catch(Q){I.default.e(this.TAG,Q.message)}C.removeEventListener("error",this.e.onSourceBufferError),C.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[$]=null,this._sourceBuffers[$]=null}}if(G.readyState==="open")try{G.endOfStream()}catch(Q){I.default.e(this.TAG,Q.message)}G.removeEventListener("sourceopen",this.e.onSourceOpen),G.removeEventListener("sourceended",this.e.onSourceEnded),G.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},F.prototype.appendInitSegment=function(G,$){if(!this._mediaSource||this._mediaSource.readyState!=="open"){this._pendingSourceBufferInit.push(G),this._pendingSegments[G.type].push(G);return}var H=G,C=""+H.container;H.codec&&H.codec.length>0&&(C+=";codecs="+H.codec);var Q=!1;if(I.default.v(this.TAG,"Received Initialization Segment, mimeType: "+C),this._lastInitSegments[H.type]=H,C!==this._mimeTypes[H.type]){if(this._mimeTypes[H.type])I.default.v(this.TAG,"Notice: "+H.type+" mimeType changed, origin: "+this._mimeTypes[H.type]+", target: "+C);else{Q=!0;try{var ae=this._sourceBuffers[H.type]=this._mediaSource.addSourceBuffer(C);ae.addEventListener("error",this.e.onSourceBufferError),ae.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(ue){I.default.e(this.TAG,ue.message),this._emitter.emit(M.default.ERROR,{code:ue.code,msg:ue.message});return}}this._mimeTypes[H.type]=C}$||this._pendingSegments[H.type].push(H),Q||this._sourceBuffers[H.type]&&!this._sourceBuffers[H.type].updating&&this._doAppendSegments(),A.default.safari&&H.container==="audio/mpeg"&&H.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=H.mediaDuration/1e3,this._updateMediaSourceDuration())},F.prototype.appendMediaSegment=function(G){var $=G;this._pendingSegments[$.type].push($),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var H=this._sourceBuffers[$.type];H&&!H.updating&&!this._hasPendingRemoveRanges()&&this._doAppendSegments()},F.prototype.seek=function(G){for(var $ in this._sourceBuffers)if(!!this._sourceBuffers[$]){var H=this._sourceBuffers[$];if(this._mediaSource.readyState==="open")try{H.abort()}catch(X){I.default.e(this.TAG,X.message)}this._idrList.clear();var C=this._pendingSegments[$];if(C.splice(0,C.length),this._mediaSource.readyState!=="closed"){for(var Q=0;Q<H.buffered.length;Q++){var ae=H.buffered.start(Q),ue=H.buffered.end(Q);this._pendingRemoveRanges[$].push({start:ae,end:ue})}if(H.updating||this._doRemoveRanges(),A.default.safari){var j=this._lastInitSegments[$];j&&(this._pendingSegments[$].push(j),H.updating||this._doAppendSegments())}}}},F.prototype.endOfStream=function(){var G=this._mediaSource,$=this._sourceBuffers;if(!G||G.readyState!=="open"){G&&G.readyState==="closed"&&this._hasPendingSegments()&&(this._hasPendingEos=!0);return}$.video&&$.video.updating||$.audio&&$.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,G.endOfStream())},F.prototype.getNearestKeyframe=function(G){return this._idrList.getLastSyncPointBeforeDts(G)},F.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var G=this._mediaElement.currentTime;for(var $ in this._sourceBuffers){var H=this._sourceBuffers[$];if(H){var C=H.buffered;if(C.length>=1&&G-C.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},F.prototype._doCleanupSourceBuffer=function(){var G=this._mediaElement.currentTime;for(var $ in this._sourceBuffers){var H=this._sourceBuffers[$];if(H){for(var C=H.buffered,Q=!1,ae=0;ae<C.length;ae++){var ue=C.start(ae),j=C.end(ae);if(ue<=G&&G<j+3){if(G-ue>=this._config.autoCleanupMaxBackwardDuration){Q=!0;var X=G-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[$].push({start:ue,end:X})}}else j<G&&(Q=!0,this._pendingRemoveRanges[$].push({start:ue,end:j}))}Q&&!H.updating&&this._doRemoveRanges()}}},F.prototype._updateMediaSourceDuration=function(){var G=this._sourceBuffers;if(!(this._mediaElement.readyState===0||this._mediaSource.readyState!=="open")&&!(G.video&&G.video.updating||G.audio&&G.audio.updating)){var $=this._mediaSource.duration,H=this._pendingMediaDuration;H>0&&(isNaN($)||H>$)&&(I.default.v(this.TAG,"Update MediaSource duration from "+$+" to "+H),this._mediaSource.duration=H),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},F.prototype._doRemoveRanges=function(){for(var G in this._pendingRemoveRanges)if(!(!this._sourceBuffers[G]||this._sourceBuffers[G].updating))for(var $=this._sourceBuffers[G],H=this._pendingRemoveRanges[G];H.length&&!$.updating;){var C=H.shift();$.remove(C.start,C.end)}},F.prototype._doAppendSegments=function(){var G=this._pendingSegments;for(var $ in G)if(!(!this._sourceBuffers[$]||this._sourceBuffers[$].updating)&&G[$].length>0){var H=G[$].shift();if(H.timestampOffset){var C=this._sourceBuffers[$].timestampOffset,Q=H.timestampOffset/1e3,ae=Math.abs(C-Q);ae>.1&&(I.default.v(this.TAG,"Update MPEG audio timestampOffset from "+C+" to "+Q),this._sourceBuffers[$].timestampOffset=Q),delete H.timestampOffset}if(!H.data||H.data.byteLength===0)continue;try{this._sourceBuffers[$].appendBuffer(H.data),this._isBufferFull=!1,$==="video"&&H.hasOwnProperty("info")&&this._idrList.appendArray(H.info.syncPoints)}catch(ue){this._pendingSegments[$].unshift(H),ue.code===22?(this._isBufferFull||this._emitter.emit(M.default.BUFFER_FULL),this._isBufferFull=!0):(I.default.e(this.TAG,ue.message),this._emitter.emit(M.default.ERROR,{code:ue.code,msg:ue.message}))}}},F.prototype._onSourceOpen=function(){if(I.default.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var G=this._pendingSourceBufferInit;G.length;){var $=G.shift();this.appendInitSegment($,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(M.default.SOURCE_OPEN)},F.prototype._onSourceEnded=function(){I.default.v(this.TAG,"MediaSource onSourceEnded")},F.prototype._onSourceClose=function(){I.default.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&this.e!=null&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))},F.prototype._hasPendingSegments=function(){var G=this._pendingSegments;return G.video.length>0||G.audio.length>0},F.prototype._hasPendingRemoveRanges=function(){var G=this._pendingRemoveRanges;return G.video.length>0||G.audio.length>0},F.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(M.default.UPDATE_END)},F.prototype._onSourceBufferError=function(G){I.default.e(this.TAG,"SourceBuffer Error: "+G)},F}();ye.default=J},"./src/core/mse-events.js":function(we,ye,se){"use strict";se.r(ye);var te={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"};ye.default=te},"./src/core/transmuxer.js":function(we,ye,se){"use strict";se.r(ye);var te=se("./node_modules/events/events.js"),Y=se.n(te),I=se("./node_modules/webworkify-webpack/index.js"),A=se.n(I),M=se("./src/utils/logger.js"),k=se("./src/utils/logging-control.js"),V=se("./src/core/transmuxing-controller.js"),J=se("./src/core/transmuxing-events.js"),F=se("./src/core/media-info.js"),G=function(){function $(H,C){if(this.TAG="Transmuxer",this._emitter=new(Y()),C.enableWorker&&typeof Worker!="undefined")try{this._worker=A()("./src/core/transmuxing-worker.js"),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[H,C]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},k.default.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:k.default.getConfig()})}catch(ae){M.default.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new V.default(H,C)}else this._controller=new V.default(H,C);if(this._controller){var Q=this._controller;Q.on(J.default.IO_ERROR,this._onIOError.bind(this)),Q.on(J.default.DEMUX_ERROR,this._onDemuxError.bind(this)),Q.on(J.default.INIT_SEGMENT,this._onInitSegment.bind(this)),Q.on(J.default.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),Q.on(J.default.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),Q.on(J.default.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),Q.on(J.default.MEDIA_INFO,this._onMediaInfo.bind(this)),Q.on(J.default.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),Q.on(J.default.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),Q.on(J.default.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),Q.on(J.default.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return $.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),k.default.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},$.prototype.on=function(H,C){this._emitter.addListener(H,C)},$.prototype.off=function(H,C){this._emitter.removeListener(H,C)},$.prototype.hasWorker=function(){return this._worker!=null},$.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},$.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},$.prototype.seek=function(H){this._worker?this._worker.postMessage({cmd:"seek",param:H}):this._controller.seek(H)},$.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},$.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},$.prototype._onInitSegment=function(H,C){var Q=this;Promise.resolve().then(function(){Q._emitter.emit(J.default.INIT_SEGMENT,H,C)})},$.prototype._onMediaSegment=function(H,C){var Q=this;Promise.resolve().then(function(){Q._emitter.emit(J.default.MEDIA_SEGMENT,H,C)})},$.prototype._onLoadingComplete=function(){var H=this;Promise.resolve().then(function(){H._emitter.emit(J.default.LOADING_COMPLETE)})},$.prototype._onRecoveredEarlyEof=function(){var H=this;Promise.resolve().then(function(){H._emitter.emit(J.default.RECOVERED_EARLY_EOF)})},$.prototype._onMediaInfo=function(H){var C=this;Promise.resolve().then(function(){C._emitter.emit(J.default.MEDIA_INFO,H)})},$.prototype._onMetaDataArrived=function(H){var C=this;Promise.resolve().then(function(){C._emitter.emit(J.default.METADATA_ARRIVED,H)})},$.prototype._onScriptDataArrived=function(H){var C=this;Promise.resolve().then(function(){C._emitter.emit(J.default.SCRIPTDATA_ARRIVED,H)})},$.prototype._onStatisticsInfo=function(H){var C=this;Promise.resolve().then(function(){C._emitter.emit(J.default.STATISTICS_INFO,H)})},$.prototype._onIOError=function(H,C){var Q=this;Promise.resolve().then(function(){Q._emitter.emit(J.default.IO_ERROR,H,C)})},$.prototype._onDemuxError=function(H,C){var Q=this;Promise.resolve().then(function(){Q._emitter.emit(J.default.DEMUX_ERROR,H,C)})},$.prototype._onRecommendSeekpoint=function(H){var C=this;Promise.resolve().then(function(){C._emitter.emit(J.default.RECOMMEND_SEEKPOINT,H)})},$.prototype._onLoggingConfigChanged=function(H){this._worker&&this._worker.postMessage({cmd:"logging_config",param:H})},$.prototype._onWorkerMessage=function(H){var C=H.data,Q=C.data;if(C.msg==="destroyed"||this._workerDestroying){this._workerDestroying=!1,this._worker.terminate(),this._worker=null;return}switch(C.msg){case J.default.INIT_SEGMENT:case J.default.MEDIA_SEGMENT:this._emitter.emit(C.msg,Q.type,Q.data);break;case J.default.LOADING_COMPLETE:case J.default.RECOVERED_EARLY_EOF:this._emitter.emit(C.msg);break;case J.default.MEDIA_INFO:Object.setPrototypeOf(Q,F.default.prototype),this._emitter.emit(C.msg,Q);break;case J.default.METADATA_ARRIVED:case J.default.SCRIPTDATA_ARRIVED:case J.default.STATISTICS_INFO:this._emitter.emit(C.msg,Q);break;case J.default.IO_ERROR:case J.default.DEMUX_ERROR:this._emitter.emit(C.msg,Q.type,Q.info);break;case J.default.RECOMMEND_SEEKPOINT:this._emitter.emit(C.msg,Q);break;case"logcat_callback":M.default.emitter.emit("log",Q.type,Q.logcat);break;default:break}},$}();ye.default=G},"./src/core/transmuxing-controller.js":function(we,ye,se){"use strict";se.r(ye);var te=se("./node_modules/events/events.js"),Y=se.n(te),I=se("./src/utils/logger.js"),A=se("./src/utils/browser.js"),M=se("./src/core/media-info.js"),k=se("./src/demux/flv-demuxer.js"),V=se("./src/remux/mp4-remuxer.js"),J=se("./src/demux/demux-errors.js"),F=se("./src/io/io-controller.js"),G=se("./src/core/transmuxing-events.js"),$=function(){function H(C,Q){this.TAG="TransmuxingController",this._emitter=new(Y()),this._config=Q,C.segments||(C.segments=[{duration:C.duration,filesize:C.filesize,url:C.url}]),typeof C.cors!="boolean"&&(C.cors=!0),typeof C.withCredentials!="boolean"&&(C.withCredentials=!1),this._mediaDataSource=C,this._currentSegmentIndex=0;var ae=0;this._mediaDataSource.segments.forEach(function(ue){ue.timestampBase=ae,ae+=ue.duration,ue.cors=C.cors,ue.withCredentials=C.withCredentials,Q.referrerPolicy&&(ue.referrerPolicy=Q.referrerPolicy)}),!isNaN(ae)&&this._mediaDataSource.duration!==ae&&(this._mediaDataSource.duration=ae),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return H.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},H.prototype.on=function(C,Q){this._emitter.addListener(C,Q)},H.prototype.off=function(C,Q){this._emitter.removeListener(C,Q)},H.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},H.prototype._loadSegment=function(C,Q){this._currentSegmentIndex=C;var ae=this._mediaDataSource.segments[C],ue=this._ioctl=new F.default(ae,this._config,C);ue.onError=this._onIOException.bind(this),ue.onSeeked=this._onIOSeeked.bind(this),ue.onComplete=this._onIOComplete.bind(this),ue.onRedirect=this._onIORedirect.bind(this),ue.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),Q?this._demuxer.bindDataSource(this._ioctl):ue.onDataArrival=this._onInitChunkArrival.bind(this),ue.open(Q)},H.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},H.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},H.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},H.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},H.prototype.seek=function(C){if(!(this._mediaInfo==null||!this._mediaInfo.isSeekable())){var Q=this._searchSegmentIndexContains(C);if(Q===this._currentSegmentIndex){var ae=this._mediaInfo.segments[Q];if(ae==null)this._pendingSeekTime=C;else{var ue=ae.getNearestKeyframe(C);this._remuxer.seek(ue.milliseconds),this._ioctl.seek(ue.fileposition),this._pendingResolveSeekPoint=ue.milliseconds}}else{var j=this._mediaInfo.segments[Q];if(j==null)this._pendingSeekTime=C,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(Q);else{var ue=j.getNearestKeyframe(C);this._internalAbort(),this._remuxer.seek(C),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[Q].timestampBase,this._loadSegment(Q,ue.fileposition),this._pendingResolveSeekPoint=ue.milliseconds,this._reportSegmentMediaInfo(Q)}}this._enableStatisticsReporter()}},H.prototype._searchSegmentIndexContains=function(C){for(var Q=this._mediaDataSource.segments,ae=Q.length-1,ue=0;ue<Q.length;ue++)if(C<Q[ue].timestampBase){ae=ue-1;break}return ae},H.prototype._onInitChunkArrival=function(C,Q){var ae=this,ue=null,j=0;if(Q>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,j=this._demuxer.parseChunks(C,Q);else if((ue=k.default.probe(C)).match){this._demuxer=new k.default(ue,this._config),this._remuxer||(this._remuxer=new V.default(this._config));var X=this._mediaDataSource;X.duration!=null&&!isNaN(X.duration)&&(this._demuxer.overridedDuration=X.duration),typeof X.hasAudio=="boolean"&&(this._demuxer.overridedHasAudio=X.hasAudio),typeof X.hasVideo=="boolean"&&(this._demuxer.overridedHasVideo=X.hasVideo),this._demuxer.timestampBase=X.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this),j=this._demuxer.parseChunks(C,Q)}else ue=null,I.default.e(this.TAG,"Non-FLV, Unsupported media type!"),Promise.resolve().then(function(){ae._internalAbort()}),this._emitter.emit(G.default.DEMUX_ERROR,J.default.FORMAT_UNSUPPORTED,"Non-FLV, Unsupported media type"),j=0;return j},H.prototype._onMediaInfo=function(C){var Q=this;this._mediaInfo==null&&(this._mediaInfo=Object.assign({},C),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,M.default.prototype));var ae=Object.assign({},C);Object.setPrototypeOf(ae,M.default.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=ae,this._reportSegmentMediaInfo(this._currentSegmentIndex),this._pendingSeekTime!=null&&Promise.resolve().then(function(){var ue=Q._pendingSeekTime;Q._pendingSeekTime=null,Q.seek(ue)})},H.prototype._onMetaDataArrived=function(C){this._emitter.emit(G.default.METADATA_ARRIVED,C)},H.prototype._onScriptDataArrived=function(C){this._emitter.emit(G.default.SCRIPTDATA_ARRIVED,C)},H.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},H.prototype._onIOComplete=function(C){var Q=C,ae=Q+1;ae<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer.flushStashedSamples(),this._loadSegment(ae)):(this._remuxer.flushStashedSamples(),this._emitter.emit(G.default.LOADING_COMPLETE),this._disableStatisticsReporter())},H.prototype._onIORedirect=function(C){var Q=this._ioctl.extraData;this._mediaDataSource.segments[Q].redirectedURL=C},H.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(G.default.RECOVERED_EARLY_EOF)},H.prototype._onIOException=function(C,Q){I.default.e(this.TAG,"IOException: type = "+C+", code = "+Q.code+", msg = "+Q.msg),this._emitter.emit(G.default.IO_ERROR,C,Q),this._disableStatisticsReporter()},H.prototype._onDemuxException=function(C,Q){I.default.e(this.TAG,"DemuxException: type = "+C+", info = "+Q),this._emitter.emit(G.default.DEMUX_ERROR,C,Q)},H.prototype._onRemuxerInitSegmentArrival=function(C,Q){this._emitter.emit(G.default.INIT_SEGMENT,C,Q)},H.prototype._onRemuxerMediaSegmentArrival=function(C,Q){if(this._pendingSeekTime==null&&(this._emitter.emit(G.default.MEDIA_SEGMENT,C,Q),this._pendingResolveSeekPoint!=null&&C==="video")){var ae=Q.info.syncPoints,ue=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,A.default.safari&&ae.length>0&&ae[0].originalDts===ue&&(ue=ae[0].pts),this._emitter.emit(G.default.RECOMMEND_SEEKPOINT,ue)}},H.prototype._enableStatisticsReporter=function(){this._statisticsReporter==null&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},H.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},H.prototype._reportSegmentMediaInfo=function(C){var Q=this._mediaInfo.segments[C],ae=Object.assign({},Q);ae.duration=this._mediaInfo.duration,ae.segmentCount=this._mediaInfo.segmentCount,delete ae.segments,delete ae.keyframesIndex,this._emitter.emit(G.default.MEDIA_INFO,ae)},H.prototype._reportStatisticsInfo=function(){var C={};C.url=this._ioctl.currentURL,C.hasRedirect=this._ioctl.hasRedirect,C.hasRedirect&&(C.redirectedURL=this._ioctl.currentRedirectedURL),C.speed=this._ioctl.currentSpeed,C.loaderType=this._ioctl.loaderType,C.currentSegmentIndex=this._currentSegmentIndex,C.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(G.default.STATISTICS_INFO,C)},H}();ye.default=$},"./src/core/transmuxing-events.js":function(we,ye,se){"use strict";se.r(ye);var te={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint"};ye.default=te},"./src/core/transmuxing-worker.js":function(we,ye,se){"use strict";se.r(ye);var te=se("./src/utils/logging-control.js"),Y=se("./src/utils/polyfill.js"),I=se("./src/core/transmuxing-controller.js"),A=se("./src/core/transmuxing-events.js"),M=function(V){var J="TransmuxingWorker",F=null,G=Be.bind(this);Y.default.install(),V.addEventListener("message",function(Ce){switch(Ce.data.cmd){case"init":F=new I.default(Ce.data.param[0],Ce.data.param[1]),F.on(A.default.IO_ERROR,oe.bind(this)),F.on(A.default.DEMUX_ERROR,ce.bind(this)),F.on(A.default.INIT_SEGMENT,$.bind(this)),F.on(A.default.MEDIA_SEGMENT,H.bind(this)),F.on(A.default.LOADING_COMPLETE,C.bind(this)),F.on(A.default.RECOVERED_EARLY_EOF,Q.bind(this)),F.on(A.default.MEDIA_INFO,ae.bind(this)),F.on(A.default.METADATA_ARRIVED,ue.bind(this)),F.on(A.default.SCRIPTDATA_ARRIVED,j.bind(this)),F.on(A.default.STATISTICS_INFO,X.bind(this)),F.on(A.default.RECOMMEND_SEEKPOINT,be.bind(this));break;case"destroy":F&&(F.destroy(),F=null),V.postMessage({msg:"destroyed"});break;case"start":F.start();break;case"stop":F.stop();break;case"seek":F.seek(Ce.data.param);break;case"pause":F.pause();break;case"resume":F.resume();break;case"logging_config":{var Le=Ce.data.param;te.default.applyConfig(Le),Le.enableCallback===!0?te.default.addLogListener(G):te.default.removeLogListener(G);break}}});function $(Ce,Le){var Pe={msg:A.default.INIT_SEGMENT,data:{type:Ce,data:Le}};V.postMessage(Pe,[Le.data])}function H(Ce,Le){var Pe={msg:A.default.MEDIA_SEGMENT,data:{type:Ce,data:Le}};V.postMessage(Pe,[Le.data])}function C(){var Ce={msg:A.default.LOADING_COMPLETE};V.postMessage(Ce)}function Q(){var Ce={msg:A.default.RECOVERED_EARLY_EOF};V.postMessage(Ce)}function ae(Ce){var Le={msg:A.default.MEDIA_INFO,data:Ce};V.postMessage(Le)}function ue(Ce){var Le={msg:A.default.METADATA_ARRIVED,data:Ce};V.postMessage(Le)}function j(Ce){var Le={msg:A.default.SCRIPTDATA_ARRIVED,data:Ce};V.postMessage(Le)}function X(Ce){var Le={msg:A.default.STATISTICS_INFO,data:Ce};V.postMessage(Le)}function oe(Ce,Le){V.postMessage({msg:A.default.IO_ERROR,data:{type:Ce,info:Le}})}function ce(Ce,Le){V.postMessage({msg:A.default.DEMUX_ERROR,data:{type:Ce,info:Le}})}function be(Ce){V.postMessage({msg:A.default.RECOMMEND_SEEKPOINT,data:Ce})}function Be(Ce,Le){V.postMessage({msg:"logcat_callback",data:{type:Ce,logcat:Le}})}};ye.default=M},"./src/demux/amf-parser.js":function(we,ye,se){"use strict";se.r(ye);var te=se("./src/utils/logger.js"),Y=se("./src/utils/utf8-conv.js"),I=se("./src/utils/exception.js"),A=function(){var k=new ArrayBuffer(2);return new DataView(k).setInt16(0,256,!0),new Int16Array(k)[0]===256}(),M=function(){function k(){}return k.parseScriptData=function(V,J,F){var G={};try{var $=k.parseValue(V,J,F),H=k.parseValue(V,J+$.size,F-$.size);G[$.data]=H.data}catch(C){te.default.e("AMF",C.toString())}return G},k.parseObject=function(V,J,F){if(F<3)throw new I.IllegalStateException("Data not enough when parse ScriptDataObject");var G=k.parseString(V,J,F),$=k.parseValue(V,J+G.size,F-G.size),H=$.objectEnd;return{data:{name:G.data,value:$.data},size:G.size+$.size,objectEnd:H}},k.parseVariable=function(V,J,F){return k.parseObject(V,J,F)},k.parseString=function(V,J,F){if(F<2)throw new I.IllegalStateException("Data not enough when parse String");var G=new DataView(V,J,F),$=G.getUint16(0,!A),H;return $>0?H=(0,Y.default)(new Uint8Array(V,J+2,$)):H="",{data:H,size:2+$}},k.parseLongString=function(V,J,F){if(F<4)throw new I.IllegalStateException("Data not enough when parse LongString");var G=new DataView(V,J,F),$=G.getUint32(0,!A),H;return $>0?H=(0,Y.default)(new Uint8Array(V,J+4,$)):H="",{data:H,size:4+$}},k.parseDate=function(V,J,F){if(F<10)throw new I.IllegalStateException("Data size invalid when parse Date");var G=new DataView(V,J,F),$=G.getFloat64(0,!A),H=G.getInt16(8,!A);return $+=H*60*1e3,{data:new Date($),size:8+2}},k.parseValue=function(V,J,F){if(F<1)throw new I.IllegalStateException("Data not enough when parse Value");var G=new DataView(V,J,F),$=1,H=G.getUint8(0),C,Q=!1;try{switch(H){case 0:C=G.getFloat64(1,!A),$+=8;break;case 1:{var ae=G.getUint8(1);C=!!ae,$+=1;break}case 2:{var ue=k.parseString(V,J+1,F-1);C=ue.data,$+=ue.size;break}case 3:{C={};var j=0;for((G.getUint32(F-4,!A)&16777215)==9&&(j=3);$<F-4;){var X=k.parseObject(V,J+$,F-$-j);if(X.objectEnd)break;C[X.data.name]=X.data.value,$+=X.size}if($<=F-3){var oe=G.getUint32($-1,!A)&16777215;oe===9&&($+=3)}break}case 8:{C={},$+=4;var j=0;for((G.getUint32(F-4,!A)&16777215)==9&&(j=3);$<F-8;){var ce=k.parseVariable(V,J+$,F-$-j);if(ce.objectEnd)break;C[ce.data.name]=ce.data.value,$+=ce.size}if($<=F-3){var oe=G.getUint32($-1,!A)&16777215;oe===9&&($+=3)}break}case 9:C=void 0,$=1,Q=!0;break;case 10:{C=[];var be=G.getUint32(1,!A);$+=4;for(var Be=0;Be<be;Be++){var Ce=k.parseValue(V,J+$,F-$);C.push(Ce.data),$+=Ce.size}break}case 11:{var Le=k.parseDate(V,J+1,F-1);C=Le.data,$+=Le.size;break}case 12:{var Pe=k.parseString(V,J+1,F-1);C=Pe.data,$+=Pe.size;break}default:$=F,te.default.w("AMF","Unsupported AMF value type "+H)}}catch(De){te.default.e("AMF",De.toString())}return{data:C,size:$,objectEnd:Q}},k}();ye.default=M},"./src/demux/demux-errors.js":function(we,ye,se){"use strict";se.r(ye);var te={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"};ye.default=te},"./src/demux/exp-golomb.js":function(we,ye,se){"use strict";se.r(ye);var te=se("./src/utils/exception.js"),Y=function(){function I(A){this.TAG="ExpGolomb",this._buffer=A,this._buffer_index=0,this._total_bytes=A.byteLength,this._total_bits=A.byteLength*8,this._current_word=0,this._current_word_bits_left=0}return I.prototype.destroy=function(){this._buffer=null},I.prototype._fillCurrentWord=function(){var A=this._total_bytes-this._buffer_index;if(A<=0)throw new te.IllegalStateException("ExpGolomb: _fillCurrentWord() but no bytes available");var M=Math.min(4,A),k=new Uint8Array(4);k.set(this._buffer.subarray(this._buffer_index,this._buffer_index+M)),this._current_word=new DataView(k.buffer).getUint32(0,!1),this._buffer_index+=M,this._current_word_bits_left=M*8},I.prototype.readBits=function(A){if(A>32)throw new te.InvalidArgumentException("ExpGolomb: readBits() bits exceeded max 32bits!");if(A<=this._current_word_bits_left){var M=this._current_word>>>32-A;return this._current_word<<=A,this._current_word_bits_left-=A,M}var k=this._current_word_bits_left?this._current_word:0;k=k>>>32-this._current_word_bits_left;var V=A-this._current_word_bits_left;this._fillCurrentWord();var J=Math.min(V,this._current_word_bits_left),F=this._current_word>>>32-J;return this._current_word<<=J,this._current_word_bits_left-=J,k=k<<J|F,k},I.prototype.readBool=function(){return this.readBits(1)===1},I.prototype.readByte=function(){return this.readBits(8)},I.prototype._skipLeadingZero=function(){var A;for(A=0;A<this._current_word_bits_left;A++)if((this._current_word&2147483648>>>A)!=0)return this._current_word<<=A,this._current_word_bits_left-=A,A;return this._fillCurrentWord(),A+this._skipLeadingZero()},I.prototype.readUEG=function(){var A=this._skipLeadingZero();return this.readBits(A+1)-1},I.prototype.readSEG=function(){var A=this.readUEG();return A&1?A+1>>>1:-1*(A>>>1)},I}();ye.default=Y},"./src/demux/flv-demuxer.js":function(we,ye,se){"use strict";se.r(ye);var te=se("./src/utils/logger.js"),Y=se("./src/demux/amf-parser.js"),I=se("./src/demux/sps-parser.js"),A=se("./src/demux/demux-errors.js"),M=se("./src/core/media-info.js"),k=se("./src/utils/exception.js");function V($){return $>>>8&255|($&255)<<8}function J($){return($&4278190080)>>>24|($&16711680)>>>8|($&65280)<<8|($&255)<<24}function F($,H){return $[H]<<24|$[H+1]<<16|$[H+2]<<8|$[H+3]}var G=function(){function $(H,C){this.TAG="FLVDemuxer",this._config=C,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=H.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=H.hasAudioTrack,this._hasVideo=H.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new M.default,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var Q=new ArrayBuffer(2);return new DataView(Q).setInt16(0,256,!0),new Int16Array(Q)[0]===256}()}return $.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},$.probe=function(H){var C=new Uint8Array(H),Q={match:!1};if(C[0]!==70||C[1]!==76||C[2]!==86||C[3]!==1)return Q;var ae=(C[4]&4)>>>2!=0,ue=(C[4]&1)!=0,j=F(C,5);return j<9?Q:{match:!0,consumed:j,dataOffset:j,hasAudioTrack:ae,hasVideoTrack:ue}},$.prototype.bindDataSource=function(H){return H.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty($.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(C){this._onTrackMetadata=C},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(C){this._onMediaInfo=C},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(C){this._onMetaDataArrived=C},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(C){this._onScriptDataArrived=C},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"onError",{get:function(){return this._onError},set:function(C){this._onError=C},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(C){this._onDataAvailable=C},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(C){this._timestampBase=C},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"overridedDuration",{get:function(){return this._duration},set:function(C){this._durationOverrided=!0,this._duration=C,this._mediaInfo.duration=C},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"overridedHasAudio",{set:function(C){this._hasAudioFlagOverrided=!0,this._hasAudio=C,this._mediaInfo.hasAudio=C},enumerable:!1,configurable:!0}),Object.defineProperty($.prototype,"overridedHasVideo",{set:function(C){this._hasVideoFlagOverrided=!0,this._hasVideo=C,this._mediaInfo.hasVideo=C},enumerable:!1,configurable:!0}),$.prototype.resetMediaInfo=function(){this._mediaInfo=new M.default},$.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!this._hasAudio&&this._hasVideo?this._videoInitialMetadataDispatched:!1},$.prototype.parseChunks=function(H,C){if(!this._onError||!this._onMediaInfo||!this._onTrackMetadata||!this._onDataAvailable)throw new k.IllegalStateException("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var Q=0,ae=this._littleEndian;if(C===0)if(H.byteLength>13){var ue=$.probe(H);Q=ue.dataOffset}else return 0;if(this._firstParse){this._firstParse=!1,C+Q!==this._dataOffset&&te.default.w(this.TAG,"First time parsing but chunk byteStart invalid!");var j=new DataView(H,Q),X=j.getUint32(0,!ae);X!==0&&te.default.w(this.TAG,"PrevTagSize0 !== 0 !!!"),Q+=4}for(;Q<H.byteLength;){this._dispatch=!0;var j=new DataView(H,Q);if(Q+11+4>H.byteLength)break;var oe=j.getUint8(0),ce=j.getUint32(0,!ae)&16777215;if(Q+11+ce+4>H.byteLength)break;if(oe!==8&&oe!==9&&oe!==18){te.default.w(this.TAG,"Unsupported tag type "+oe+", skipped"),Q+=11+ce+4;continue}var be=j.getUint8(4),Be=j.getUint8(5),Ce=j.getUint8(6),Le=j.getUint8(7),Pe=Ce|Be<<8|be<<16|Le<<24,De=j.getUint32(7,!ae)&16777215;De!==0&&te.default.w(this.TAG,"Meet tag which has StreamID != 0!");var Ve=Q+11;switch(oe){case 8:this._parseAudioData(H,Ve,ce,Pe);break;case 9:this._parseVideoData(H,Ve,ce,Pe,C+Q);break;case 18:this._parseScriptData(H,Ve,ce);break}var Oe=j.getUint32(11+ce,!ae);Oe!==11+ce&&te.default.w(this.TAG,"Invalid PrevTagSize "+Oe),Q+=11+ce+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),Q},$.prototype._parseScriptData=function(H,C,Q){var ae=Y.default.parseScriptData(H,C,Q);if(ae.hasOwnProperty("onMetaData")){if(ae.onMetaData==null||typeof ae.onMetaData!="object"){te.default.w(this.TAG,"Invalid onMetaData structure!");return}this._metadata&&te.default.w(this.TAG,"Found another onMetaData tag!"),this._metadata=ae;var ue=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},ue)),typeof ue.hasAudio=="boolean"&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=ue.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),typeof ue.hasVideo=="boolean"&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=ue.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),typeof ue.audiodatarate=="number"&&(this._mediaInfo.audioDataRate=ue.audiodatarate),typeof ue.videodatarate=="number"&&(this._mediaInfo.videoDataRate=ue.videodatarate),typeof ue.width=="number"&&(this._mediaInfo.width=ue.width),typeof ue.height=="number"&&(this._mediaInfo.height=ue.height),typeof ue.duration=="number"){if(!this._durationOverrided){var j=Math.floor(ue.duration*this._timescale);this._duration=j,this._mediaInfo.duration=j}}else this._mediaInfo.duration=0;if(typeof ue.framerate=="number"){var X=Math.floor(ue.framerate*1e3);if(X>0){var oe=X/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=oe,this._referenceFrameRate.fps_num=X,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=oe}}if(typeof ue.keyframes=="object"){this._mediaInfo.hasKeyframesIndex=!0;var ce=ue.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(ce),ue.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=ue,te.default.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(ae).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},ae))},$.prototype._parseKeyframesIndex=function(H){for(var C=[],Q=[],ae=1;ae<H.times.length;ae++){var ue=this._timestampBase+Math.floor(H.times[ae]*1e3);C.push(ue),Q.push(H.filepositions[ae])}return{times:C,filepositions:Q}},$.prototype._parseAudioData=function(H,C,Q,ae){if(Q<=1){te.default.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");return}if(!(this._hasAudioFlagOverrided===!0&&this._hasAudio===!1)){var ue=this._littleEndian,j=new DataView(H,C,Q),X=j.getUint8(0),oe=X>>>4;if(oe!==2&&oe!==10){this._onError(A.default.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+oe);return}var ce=0,be=(X&12)>>>2;if(be>=0&&be<=4)ce=this._flvSoundRateTable[be];else{this._onError(A.default.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+be);return}var Be=(X&2)>>>1,Ce=X&1,Le=this._audioMetadata,Pe=this._audioTrack;if(Le||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),Le=this._audioMetadata={},Le.type="audio",Le.id=Pe.id,Le.timescale=this._timescale,Le.duration=this._duration,Le.audioSampleRate=ce,Le.channelCount=Ce===0?1:2),oe===10){var De=this._parseAACAudioData(H,C+1,Q-1);if(De==null)return;if(De.packetType===0){Le.config&&te.default.w(this.TAG,"Found another AudioSpecificConfig!");var Ve=De.data;Le.audioSampleRate=Ve.samplingRate,Le.channelCount=Ve.channelCount,Le.codec=Ve.codec,Le.originalCodec=Ve.originalCodec,Le.config=Ve.config,Le.refSampleDuration=1024/Le.audioSampleRate*Le.timescale,te.default.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",Le);var Oe=this._mediaInfo;Oe.audioCodec=Le.originalCodec,Oe.audioSampleRate=Le.audioSampleRate,Oe.audioChannelCount=Le.channelCount,Oe.hasVideo?Oe.videoCodec!=null&&(Oe.mimeType='video/x-flv; codecs="'+Oe.videoCodec+","+Oe.audioCodec+'"'):Oe.mimeType='video/x-flv; codecs="'+Oe.audioCodec+'"',Oe.isComplete()&&this._onMediaInfo(Oe)}else if(De.packetType===1){var dt=this._timestampBase+ae,Nt={unit:De.data,length:De.data.byteLength,dts:dt,pts:dt};Pe.samples.push(Nt),Pe.length+=De.data.length}else te.default.e(this.TAG,"Flv: Unsupported AAC data type "+De.packetType)}else if(oe===2){if(!Le.codec){var Ve=this._parseMP3AudioData(H,C+1,Q-1,!0);if(Ve==null)return;Le.audioSampleRate=Ve.samplingRate,Le.channelCount=Ve.channelCount,Le.codec=Ve.codec,Le.originalCodec=Ve.originalCodec,Le.refSampleDuration=1152/Le.audioSampleRate*Le.timescale,te.default.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",Le);var Oe=this._mediaInfo;Oe.audioCodec=Le.codec,Oe.audioSampleRate=Le.audioSampleRate,Oe.audioChannelCount=Le.channelCount,Oe.audioDataRate=Ve.bitRate,Oe.hasVideo?Oe.videoCodec!=null&&(Oe.mimeType='video/x-flv; codecs="'+Oe.videoCodec+","+Oe.audioCodec+'"'):Oe.mimeType='video/x-flv; codecs="'+Oe.audioCodec+'"',Oe.isComplete()&&this._onMediaInfo(Oe)}var It=this._parseMP3AudioData(H,C+1,Q-1,!1);if(It==null)return;var dt=this._timestampBase+ae,gt={unit:It,length:It.byteLength,dts:dt,pts:dt};Pe.samples.push(gt),Pe.length+=It.length}}},$.prototype._parseAACAudioData=function(H,C,Q){if(Q<=1){te.default.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!");return}var ae={},ue=new Uint8Array(H,C,Q);return ae.packetType=ue[0],ue[0]===0?ae.data=this._parseAACAudioSpecificConfig(H,C+1,Q-1):ae.data=ue.subarray(1),ae},$.prototype._parseAACAudioSpecificConfig=function(H,C,Q){var ae=new Uint8Array(H,C,Q),ue=null,j=0,X=0,oe=null,ce=0,be=null;if(j=X=ae[0]>>>3,ce=(ae[0]&7)<<1|ae[1]>>>7,ce<0||ce>=this._mpegSamplingRates.length){this._onError(A.default.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");return}var Be=this._mpegSamplingRates[ce],Ce=(ae[1]&120)>>>3;if(Ce<0||Ce>=8){this._onError(A.default.FORMAT_ERROR,"Flv: AAC invalid channel configuration");return}j===5&&(be=(ae[1]&7)<<1|ae[2]>>>7,oe=(ae[2]&124)>>>2);var Le=self.navigator.userAgent.toLowerCase();return Le.indexOf("firefox")!==-1?ce>=6?(j=5,ue=new Array(4),be=ce-3):(j=2,ue=new Array(2),be=ce):Le.indexOf("android")!==-1?(j=2,ue=new Array(2),be=ce):(j=5,be=ce,ue=new Array(4),ce>=6?be=ce-3:Ce===1&&(j=2,ue=new Array(2),be=ce)),ue[0]=j<<3,ue[0]|=(ce&15)>>>1,ue[1]=(ce&15)<<7,ue[1]|=(Ce&15)<<3,j===5&&(ue[1]|=(be&15)>>>1,ue[2]=(be&1)<<7,ue[2]|=2<<2,ue[3]=0),{config:ue,samplingRate:Be,channelCount:Ce,codec:"mp4a.40."+j,originalCodec:"mp4a.40."+X}},$.prototype._parseMP3AudioData=function(H,C,Q,ae){if(Q<4){te.default.w(this.TAG,"Flv: Invalid MP3 packet, header missing!");return}var ue=this._littleEndian,j=new Uint8Array(H,C,Q),X=null;if(ae){if(j[0]!==255)return;var oe=j[1]>>>3&3,ce=(j[1]&6)>>1,be=(j[2]&240)>>>4,Be=(j[2]&12)>>>2,Ce=j[3]>>>6&3,Le=Ce!==3?2:1,Pe=0,De=0,Ve=34,Oe="mp3";switch(oe){case 0:Pe=this._mpegAudioV25SampleRateTable[Be];break;case 2:Pe=this._mpegAudioV20SampleRateTable[Be];break;case 3:Pe=this._mpegAudioV10SampleRateTable[Be];break}switch(ce){case 1:Ve=34,be<this._mpegAudioL3BitRateTable.length&&(De=this._mpegAudioL3BitRateTable[be]);break;case 2:Ve=33,be<this._mpegAudioL2BitRateTable.length&&(De=this._mpegAudioL2BitRateTable[be]);break;case 3:Ve=32,be<this._mpegAudioL1BitRateTable.length&&(De=this._mpegAudioL1BitRateTable[be]);break}X={bitRate:De,samplingRate:Pe,channelCount:Le,codec:Oe,originalCodec:Oe}}else X=j;return X},$.prototype._parseVideoData=function(H,C,Q,ae,ue){if(Q<=1){te.default.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");return}if(!(this._hasVideoFlagOverrided===!0&&this._hasVideo===!1)){var j=new Uint8Array(H,C,Q)[0],X=(j&240)>>>4,oe=j&15;if(oe!==7){this._onError(A.default.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+oe);return}this._parseAVCVideoPacket(H,C+1,Q-1,ae,ue,X)}},$.prototype._parseAVCVideoPacket=function(H,C,Q,ae,ue,j){if(Q<4){te.default.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");return}var X=this._littleEndian,oe=new DataView(H,C,Q),ce=oe.getUint8(0),be=oe.getUint32(0,!X)&16777215,Be=be<<8>>8;if(ce===0)this._parseAVCDecoderConfigurationRecord(H,C+4,Q-4);else if(ce===1)this._parseAVCVideoData(H,C+4,Q-4,ae,ue,j,Be);else if(ce!==2){this._onError(A.default.FORMAT_ERROR,"Flv: Invalid video packet type "+ce);return}},$.prototype._parseAVCDecoderConfigurationRecord=function(H,C,Q){if(Q<7){te.default.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");return}var ae=this._videoMetadata,ue=this._videoTrack,j=this._littleEndian,X=new DataView(H,C,Q);ae?typeof ae.avcc!="undefined"&&te.default.w(this.TAG,"Found another AVCDecoderConfigurationRecord!"):(this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),ae=this._videoMetadata={},ae.type="video",ae.id=ue.id,ae.timescale=this._timescale,ae.duration=this._duration);var oe=X.getUint8(0),ce=X.getUint8(1),be=X.getUint8(2),Be=X.getUint8(3);if(oe!==1||ce===0){this._onError(A.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord");return}if(this._naluLengthSize=(X.getUint8(4)&3)+1,this._naluLengthSize!==3&&this._naluLengthSize!==4){this._onError(A.default.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));return}var Ce=X.getUint8(5)&31;if(Ce===0){this._onError(A.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS");return}else Ce>1&&te.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+Ce);for(var Le=6,Pe=0;Pe<Ce;Pe++){var De=X.getUint16(Le,!j);if(Le+=2,De!==0){var Ve=new Uint8Array(H,C+Le,De);Le+=De;var Oe=I.default.parseSPS(Ve);if(Pe===0){ae.codecWidth=Oe.codec_size.width,ae.codecHeight=Oe.codec_size.height,ae.presentWidth=Oe.present_size.width,ae.presentHeight=Oe.present_size.height,ae.profile=Oe.profile_string,ae.level=Oe.level_string,ae.bitDepth=Oe.bit_depth,ae.chromaFormat=Oe.chroma_format,ae.sarRatio=Oe.sar_ratio,ae.frameRate=Oe.frame_rate,(Oe.frame_rate.fixed===!1||Oe.frame_rate.fps_num===0||Oe.frame_rate.fps_den===0)&&(ae.frameRate=this._referenceFrameRate);var dt=ae.frameRate.fps_den,Nt=ae.frameRate.fps_num;ae.refSampleDuration=ae.timescale*(dt/Nt);for(var It=Ve.subarray(1,4),gt="avc1.",nt=0;nt<3;nt++){var Ht=It[nt].toString(16);Ht.length<2&&(Ht="0"+Ht),gt+=Ht}ae.codec=gt;var Tt=this._mediaInfo;Tt.width=ae.codecWidth,Tt.height=ae.codecHeight,Tt.fps=ae.frameRate.fps,Tt.profile=ae.profile,Tt.level=ae.level,Tt.refFrames=Oe.ref_frames,Tt.chromaFormat=Oe.chroma_format_string,Tt.sarNum=ae.sarRatio.width,Tt.sarDen=ae.sarRatio.height,Tt.videoCodec=gt,Tt.hasAudio?Tt.audioCodec!=null&&(Tt.mimeType='video/x-flv; codecs="'+Tt.videoCodec+","+Tt.audioCodec+'"'):Tt.mimeType='video/x-flv; codecs="'+Tt.videoCodec+'"',Tt.isComplete()&&this._onMediaInfo(Tt)}}}var Gt=X.getUint8(Le);if(Gt===0){this._onError(A.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS");return}else Gt>1&&te.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = "+Gt);Le++;for(var Pe=0;Pe<Gt;Pe++){var De=X.getUint16(Le,!j);Le+=2,De!==0&&(Le+=De)}ae.avcc=new Uint8Array(Q),ae.avcc.set(new Uint8Array(H,C,Q),0),te.default.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",ae)},$.prototype._parseAVCVideoData=function(H,C,Q,ae,ue,j,X){for(var oe=this._littleEndian,ce=new DataView(H,C,Q),be=[],Be=0,Ce=0,Le=this._naluLengthSize,Pe=this._timestampBase+ae,De=j===1;Ce<Q;){if(Ce+4>=Q){te.default.w(this.TAG,"Malformed Nalu near timestamp "+Pe+", offset = "+Ce+", dataSize = "+Q);break}var Ve=ce.getUint32(Ce,!oe);if(Le===3&&(Ve>>>=8),Ve>Q-Le){te.default.w(this.TAG,"Malformed Nalus near timestamp "+Pe+", NaluSize > DataSize!");return}var Oe=ce.getUint8(Ce+Le)&31;Oe===5&&(De=!0);var dt=new Uint8Array(H,C+Ce,Le+Ve),Nt={type:Oe,data:dt};be.push(Nt),Be+=dt.byteLength,Ce+=Le+Ve}if(be.length){var It=this._videoTrack,gt={units:be,length:Be,isKeyframe:De,dts:Pe,cts:X,pts:Pe+X};De&&(gt.fileposition=ue),It.samples.push(gt),It.length+=Be}},$}();ye.default=G},"./src/demux/sps-parser.js":function(we,ye,se){"use strict";se.r(ye);var te=se("./src/demux/exp-golomb.js"),Y=function(){function I(){}return I._ebsp2rbsp=function(A){for(var M=A,k=M.byteLength,V=new Uint8Array(k),J=0,F=0;F<k;F++)F>=2&&M[F]===3&&M[F-1]===0&&M[F-2]===0||(V[J]=M[F],J++);return new Uint8Array(V.buffer,0,J)},I.parseSPS=function(A){var M=I._ebsp2rbsp(A),k=new te.default(M);k.readByte();var V=k.readByte();k.readByte();var J=k.readByte();k.readUEG();var F=I.getProfileString(V),G=I.getLevelString(J),$=1,H=420,C=[0,420,422,444],Q=8;if((V===100||V===110||V===122||V===244||V===44||V===83||V===86||V===118||V===128||V===138||V===144)&&($=k.readUEG(),$===3&&k.readBits(1),$<=3&&(H=C[$]),Q=k.readUEG()+8,k.readUEG(),k.readBits(1),k.readBool()))for(var ae=$!==3?8:12,ue=0;ue<ae;ue++)k.readBool()&&(ue<6?I._skipScalingList(k,16):I._skipScalingList(k,64));k.readUEG();var j=k.readUEG();if(j===0)k.readUEG();else if(j===1){k.readBits(1),k.readSEG(),k.readSEG();for(var X=k.readUEG(),ue=0;ue<X;ue++)k.readSEG()}var oe=k.readUEG();k.readBits(1);var ce=k.readUEG(),be=k.readUEG(),Be=k.readBits(1);Be===0&&k.readBits(1),k.readBits(1);var Ce=0,Le=0,Pe=0,De=0,Ve=k.readBool();Ve&&(Ce=k.readUEG(),Le=k.readUEG(),Pe=k.readUEG(),De=k.readUEG());var Oe=1,dt=1,Nt=0,It=!0,gt=0,nt=0,Ht=k.readBool();if(Ht){if(k.readBool()){var Tt=k.readByte(),Gt=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],hi=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];Tt>0&&Tt<16?(Oe=Gt[Tt-1],dt=hi[Tt-1]):Tt===255&&(Oe=k.readByte()<<8|k.readByte(),dt=k.readByte()<<8|k.readByte())}if(k.readBool()&&k.readBool(),k.readBool()&&(k.readBits(4),k.readBool()&&k.readBits(24)),k.readBool()&&(k.readUEG(),k.readUEG()),k.readBool()){var ai=k.readBits(32),Ei=k.readBits(32);It=k.readBool(),gt=Ei,nt=ai*2,Nt=gt/nt}}var Ai=1;(Oe!==1||dt!==1)&&(Ai=Oe/dt);var Ct=0,di=0;if($===0)Ct=1,di=2-Be;else{var ui=$===3?1:2,ji=$===1?2:1;Ct=ui,di=ji*(2-Be)}var un=(ce+1)*16,$i=(2-Be)*((be+1)*16);un-=(Ce+Le)*Ct,$i-=(Pe+De)*di;var wt=Math.ceil(un*Ai);return k.destroy(),k=null,{profile_string:F,level_string:G,bit_depth:Q,ref_frames:oe,chroma_format:H,chroma_format_string:I.getChromaFormatString(H),frame_rate:{fixed:It,fps:Nt,fps_den:nt,fps_num:gt},sar_ratio:{width:Oe,height:dt},codec_size:{width:un,height:$i},present_size:{width:wt,height:$i}}},I._skipScalingList=function(A,M){for(var k=8,V=8,J=0,F=0;F<M;F++)V!==0&&(J=A.readSEG(),V=(k+J+256)%256),k=V===0?k:V},I.getProfileString=function(A){switch(A){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},I.getLevelString=function(A){return(A/10).toFixed(1)},I.getChromaFormatString=function(A){switch(A){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},I}();ye.default=Y},"./src/flv.js":function(we,ye,se){"use strict";se.r(ye);var te=se("./src/utils/polyfill.js"),Y=se("./src/core/features.js"),I=se("./src/io/loader.js"),A=se("./src/player/flv-player.js"),M=se("./src/player/native-player.js"),k=se("./src/player/player-events.js"),V=se("./src/player/player-errors.js"),J=se("./src/utils/logging-control.js"),F=se("./src/utils/exception.js");te.default.install();function G(Q,ae){var ue=Q;if(ue==null||typeof ue!="object")throw new F.InvalidArgumentException("MediaDataSource must be an javascript object!");if(!ue.hasOwnProperty("type"))throw new F.InvalidArgumentException("MediaDataSource must has type field to indicate video file type!");switch(ue.type){case"flv":return new A.default(ue,ae);default:return new M.default(ue,ae)}}function $(){return Y.default.supportMSEH264Playback()}function H(){return Y.default.getFeatureList()}var C={};C.createPlayer=G,C.isSupported=$,C.getFeatureList=H,C.BaseLoader=I.BaseLoader,C.LoaderStatus=I.LoaderStatus,C.LoaderErrors=I.LoaderErrors,C.Events=k.default,C.ErrorTypes=V.ErrorTypes,C.ErrorDetails=V.ErrorDetails,C.FlvPlayer=A.default,C.NativePlayer=M.default,C.LoggingControl=J.default,Object.defineProperty(C,"version",{enumerable:!0,get:function(){return"1.6.2"}}),ye.default=C},"./src/index.js":function(we,ye,se){we.exports=se("./src/flv.js").default},"./src/io/fetch-stream-loader.js":function(we,ye,se){"use strict";se.r(ye);var te=se("./src/utils/browser.js"),Y=se("./src/io/loader.js"),I=se("./src/utils/exception.js"),A=function(){var k=function(J,F){return k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(G,$){G.__proto__=$}||function(G,$){for(var H in $)Object.prototype.hasOwnProperty.call($,H)&&(G[H]=$[H])},k(J,F)};return function(V,J){if(typeof J!="function"&&J!==null)throw new TypeError("Class extends value "+String(J)+" is not a constructor or null");k(V,J);function F(){this.constructor=V}V.prototype=J===null?Object.create(J):(F.prototype=J.prototype,new F)}}(),M=function(k){A(V,k);function V(J,F){var G=k.call(this,"fetch-stream-loader")||this;return G.TAG="FetchStreamLoader",G._seekHandler=J,G._config=F,G._needStash=!0,G._requestAbort=!1,G._contentLength=null,G._receivedLength=0,G}return V.isSupported=function(){try{var J=te.default.msedge&&te.default.version.minor>=15048,F=te.default.msedge?J:!0;return self.fetch&&self.ReadableStream&&F}catch(G){return!1}},V.prototype.destroy=function(){this.isWorking()&&this.abort(),k.prototype.destroy.call(this)},V.prototype.open=function(J,F){var G=this;this._dataSource=J,this._range=F;var $=J.url;this._config.reuseRedirectedURL&&J.redirectedURL!=null&&($=J.redirectedURL);var H=this._seekHandler.getConfig($,F),C=new self.Headers;if(typeof H.headers=="object"){var Q=H.headers;for(var ae in Q)Q.hasOwnProperty(ae)&&C.append(ae,Q[ae])}var ue={method:"GET",headers:C,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(typeof this._config.headers=="object")for(var ae in this._config.headers)C.append(ae,this._config.headers[ae]);J.cors===!1&&(ue.mode="same-origin"),J.withCredentials&&(ue.credentials="include"),J.referrerPolicy&&(ue.referrerPolicy=J.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,ue.signal=this._abortController.signal),this._status=Y.LoaderStatus.kConnecting,self.fetch(H.url,ue).then(function(j){if(G._requestAbort){G._status=Y.LoaderStatus.kIdle,j.body.cancel();return}if(j.ok&&j.status>=200&&j.status<=299){if(j.url!==H.url&&G._onURLRedirect){var X=G._seekHandler.removeURLParameters(j.url);G._onURLRedirect(X)}var oe=j.headers.get("Content-Length");return oe!=null&&(G._contentLength=parseInt(oe),G._contentLength!==0&&G._onContentLengthKnown&&G._onContentLengthKnown(G._contentLength)),G._pump.call(G,j.body.getReader())}else if(G._status=Y.LoaderStatus.kError,G._onError)G._onError(Y.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:j.status,msg:j.statusText});else throw new I.RuntimeException("FetchStreamLoader: Http code invalid, "+j.status+" "+j.statusText)}).catch(function(j){if(!(G._abortController&&G._abortController.signal.aborted))if(G._status=Y.LoaderStatus.kError,G._onError)G._onError(Y.LoaderErrors.EXCEPTION,{code:-1,msg:j.message});else throw j})},V.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==Y.LoaderStatus.kBuffering||!te.default.chrome)&&this._abortController)try{this._abortController.abort()}catch(J){}},V.prototype._pump=function(J){var F=this;return J.read().then(function(G){if(G.done)if(F._contentLength!==null&&F._receivedLength<F._contentLength){F._status=Y.LoaderStatus.kError;var $=Y.LoaderErrors.EARLY_EOF,H={code:-1,msg:"Fetch stream meet Early-EOF"};if(F._onError)F._onError($,H);else throw new I.RuntimeException(H.msg)}else F._status=Y.LoaderStatus.kComplete,F._onComplete&&F._onComplete(F._range.from,F._range.from+F._receivedLength-1);else{if(F._abortController&&F._abortController.signal.aborted){F._status=Y.LoaderStatus.kComplete;return}else if(F._requestAbort===!0)return F._status=Y.LoaderStatus.kComplete,J.cancel();F._status=Y.LoaderStatus.kBuffering;var C=G.value.buffer,Q=F._range.from+F._receivedLength;F._receivedLength+=C.byteLength,F._onDataArrival&&F._onDataArrival(C,Q,F._receivedLength),F._pump(J)}}).catch(function(G){if(F._abortController&&F._abortController.signal.aborted){F._status=Y.LoaderStatus.kComplete;return}if(!(G.code===11&&te.default.msedge)){F._status=Y.LoaderStatus.kError;var $=0,H=null;if((G.code===19||G.message==="network error")&&(F._contentLength===null||F._contentLength!==null&&F._receivedLength<F._contentLength)?($=Y.LoaderErrors.EARLY_EOF,H={code:G.code,msg:"Fetch stream meet Early-EOF"}):($=Y.LoaderErrors.EXCEPTION,H={code:G.code,msg:G.message}),F._onError)F._onError($,H);else throw new I.RuntimeException(H.msg)}})},V}(Y.BaseLoader);ye.default=M},"./src/io/io-controller.js":function(we,ye,se){"use strict";se.r(ye);var te=se("./src/utils/logger.js"),Y=se("./src/io/speed-sampler.js"),I=se("./src/io/loader.js"),A=se("./src/io/fetch-stream-loader.js"),M=se("./src/io/xhr-moz-chunked-loader.js"),k=se("./src/io/xhr-range-loader.js"),V=se("./src/io/websocket-loader.js"),J=se("./src/io/range-seek-handler.js"),F=se("./src/io/param-seek-handler.js"),G=se("./src/utils/exception.js"),$=function(){function H(C,Q,ae){this.TAG="IOController",this._config=Q,this._extraData=ae,this._stashInitialSize=1024*384,Q.stashInitialSize!=null&&Q.stashInitialSize>0&&(this._stashInitialSize=Q.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=1024*1024*3,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,Q.enableStashBuffer===!1&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=C,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(C.url),this._refTotalLength=C.filesize?C.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new Y.default,this._speedNormalizeList=[64,128,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return H.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},H.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},H.prototype.isPaused=function(){return this._paused},Object.defineProperty(H.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"extraData",{get:function(){return this._extraData},set:function(Q){this._extraData=Q},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(Q){this._onDataArrival=Q},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(Q){this._onSeeked=Q},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"onError",{get:function(){return this._onError},set:function(Q){this._onError=Q},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"onComplete",{get:function(){return this._onComplete},set:function(Q){this._onComplete=Q},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(Q){this._onRedirect=Q},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(Q){this._onRecoveredEarlyEof=Q},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"hasRedirect",{get:function(){return this._redirectedURL!=null||this._dataSource.redirectedURL!=null},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"currentSpeed",{get:function(){return this._loaderClass===k.default?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(H.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),H.prototype._selectSeekHandler=function(){var C=this._config;if(C.seekType==="range")this._seekHandler=new J.default(this._config.rangeLoadZeroStart);else if(C.seekType==="param"){var Q=C.seekParamStart||"bstart",ae=C.seekParamEnd||"bend";this._seekHandler=new F.default(Q,ae)}else if(C.seekType==="custom"){if(typeof C.customSeekHandler!="function")throw new G.InvalidArgumentException("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new C.customSeekHandler}else throw new G.InvalidArgumentException("Invalid seekType in config: "+C.seekType)},H.prototype._selectLoader=function(){if(this._config.customLoader!=null)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=V.default;else if(A.default.isSupported())this._loaderClass=A.default;else if(M.default.isSupported())this._loaderClass=M.default;else if(k.default.isSupported())this._loaderClass=k.default;else throw new G.RuntimeException("Your browser doesn't support xhr with arraybuffer responseType!")},H.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),this._loader.needStashBuffer===!1&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},H.prototype.open=function(C){this._currentRange={from:0,to:-1},C&&(this._currentRange.from=C),this._speedSampler.reset(),C||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},H.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},H.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),this._stashUsed!==0?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},H.prototype.resume=function(){if(this._paused){this._paused=!1;var C=this._resumeFrom;this._resumeFrom=0,this._internalSeek(C,!0)}},H.prototype.seek=function(C){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(C,!0)},H.prototype._internalSeek=function(C,Q){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(Q),this._loader.destroy(),this._loader=null;var ae={from:C,to:-1};this._currentRange={from:ae.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,ae),this._onSeeked&&this._onSeeked()},H.prototype.updateUrl=function(C){if(!C||typeof C!="string"||C.length===0)throw new G.InvalidArgumentException("Url must be a non-empty string!");this._dataSource.url=C},H.prototype._expandBuffer=function(C){for(var Q=this._stashSize;Q+1024*1024*1<C;)Q*=2;if(Q+=1024*1024*1,Q!==this._bufferSize){var ae=new ArrayBuffer(Q);if(this._stashUsed>0){var ue=new Uint8Array(this._stashBuffer,0,this._stashUsed),j=new Uint8Array(ae,0,Q);j.set(ue,0)}this._stashBuffer=ae,this._bufferSize=Q}},H.prototype._normalizeSpeed=function(C){var Q=this._speedNormalizeList,ae=Q.length-1,ue=0,j=0,X=ae;if(C<Q[0])return Q[0];for(;j<=X;){if(ue=j+Math.floor((X-j)/2),ue===ae||C>=Q[ue]&&C<Q[ue+1])return Q[ue];Q[ue]<C?j=ue+1:X=ue-1}},H.prototype._adjustStashSize=function(C){var Q=0;this._config.isLive||C<512?Q=C:C>=512&&C<=1024?Q=Math.floor(C*1.5):Q=C*2,Q>8192&&(Q=8192);var ae=Q*1024+1024*1024*1;this._bufferSize<ae&&this._expandBuffer(ae),this._stashSize=Q*1024},H.prototype._dispatchChunks=function(C,Q){return this._currentRange.to=Q+C.byteLength-1,this._onDataArrival(C,Q)},H.prototype._onURLRedirect=function(C){this._redirectedURL=C,this._onRedirect&&this._onRedirect(C)},H.prototype._onContentLengthKnown=function(C){C&&this._fullRequestFlag&&(this._totalLength=C,this._fullRequestFlag=!1)},H.prototype._onLoaderChunkArrival=function(C,Q,ae){if(!this._onDataArrival)throw new G.IllegalStateException("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(C.byteLength);var ue=this._speedSampler.lastSecondKBps;if(ue!==0){var j=this._normalizeSpeed(ue);this._speedNormalized!==j&&(this._speedNormalized=j,this._adjustStashSize(j))}if(this._enableStash)if(this._stashUsed===0&&this._stashByteStart===0&&(this._stashByteStart=Q),this._stashUsed+C.byteLength<=this._stashSize){var ce=new Uint8Array(this._stashBuffer,0,this._stashSize);ce.set(new Uint8Array(C),this._stashUsed),this._stashUsed+=C.byteLength}else{var ce=new Uint8Array(this._stashBuffer,0,this._bufferSize);if(this._stashUsed>0){var Be=this._stashBuffer.slice(0,this._stashUsed),X=this._dispatchChunks(Be,this._stashByteStart);if(X<Be.byteLength){if(X>0){var be=new Uint8Array(Be,X);ce.set(be,0),this._stashUsed=be.byteLength,this._stashByteStart+=X}}else this._stashUsed=0,this._stashByteStart+=X;this._stashUsed+C.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+C.byteLength),ce=new Uint8Array(this._stashBuffer,0,this._bufferSize)),ce.set(new Uint8Array(C),this._stashUsed),this._stashUsed+=C.byteLength}else{var X=this._dispatchChunks(C,Q);if(X<C.byteLength){var oe=C.byteLength-X;oe>this._bufferSize&&(this._expandBuffer(oe),ce=new Uint8Array(this._stashBuffer,0,this._bufferSize)),ce.set(new Uint8Array(C,X),0),this._stashUsed+=oe,this._stashByteStart=Q+X}}}else if(this._stashUsed===0){var X=this._dispatchChunks(C,Q);if(X<C.byteLength){var oe=C.byteLength-X;oe>this._bufferSize&&this._expandBuffer(oe);var ce=new Uint8Array(this._stashBuffer,0,this._bufferSize);ce.set(new Uint8Array(C,X),0),this._stashUsed+=oe,this._stashByteStart=Q+X}}else{this._stashUsed+C.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+C.byteLength);var ce=new Uint8Array(this._stashBuffer,0,this._bufferSize);ce.set(new Uint8Array(C),this._stashUsed),this._stashUsed+=C.byteLength;var X=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart);if(X<this._stashUsed&&X>0){var be=new Uint8Array(this._stashBuffer,X);ce.set(be,0)}this._stashUsed-=X,this._stashByteStart+=X}}},H.prototype._flushStashBuffer=function(C){if(this._stashUsed>0){var Q=this._stashBuffer.slice(0,this._stashUsed),ae=this._dispatchChunks(Q,this._stashByteStart),ue=Q.byteLength-ae;if(ae<Q.byteLength)if(C)te.default.w(this.TAG,ue+" bytes unconsumed data remain when flush buffer, dropped");else{if(ae>0){var j=new Uint8Array(this._stashBuffer,0,this._bufferSize),X=new Uint8Array(Q,ae);j.set(X,0),this._stashUsed=X.byteLength,this._stashByteStart+=ae}return 0}return this._stashUsed=0,this._stashByteStart=0,ue}return 0},H.prototype._onLoaderComplete=function(C,Q){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},H.prototype._onLoaderError=function(C,Q){switch(te.default.e(this.TAG,"Loader error, code = "+Q.code+", msg = "+Q.msg),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,C=I.LoaderErrors.UNRECOVERABLE_EARLY_EOF),C){case I.LoaderErrors.EARLY_EOF:{if(!this._config.isLive&&this._totalLength){var ae=this._currentRange.to+1;ae<this._totalLength&&(te.default.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(ae,!1));return}C=I.LoaderErrors.UNRECOVERABLE_EARLY_EOF;break}case I.LoaderErrors.UNRECOVERABLE_EARLY_EOF:case I.LoaderErrors.CONNECTING_TIMEOUT:case I.LoaderErrors.HTTP_STATUS_CODE_INVALID:case I.LoaderErrors.EXCEPTION:break}if(this._onError)this._onError(C,Q);else throw new G.RuntimeException("IOException: "+Q.msg)},H}();ye.default=$},"./src/io/loader.js":function(we,ye,se){"use strict";se.r(ye),se.d(ye,{LoaderStatus:function(){return Y},LoaderErrors:function(){return I},BaseLoader:function(){return A}});var te=se("./src/utils/exception.js"),Y={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},I={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},A=function(){function M(k){this._type=k||"undefined",this._status=Y.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return M.prototype.destroy=function(){this._status=Y.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},M.prototype.isWorking=function(){return this._status===Y.kConnecting||this._status===Y.kBuffering},Object.defineProperty(M.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(V){this._onContentLengthKnown=V},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(V){this._onURLRedirect=V},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(V){this._onDataArrival=V},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"onError",{get:function(){return this._onError},set:function(V){this._onError=V},enumerable:!1,configurable:!0}),Object.defineProperty(M.prototype,"onComplete",{get:function(){return this._onComplete},set:function(V){this._onComplete=V},enumerable:!1,configurable:!0}),M.prototype.open=function(k,V){throw new te.NotImplementedException("Unimplemented abstract function!")},M.prototype.abort=function(){throw new te.NotImplementedException("Unimplemented abstract function!")},M}()},"./src/io/param-seek-handler.js":function(we,ye,se){"use strict";se.r(ye);var te=function(){function Y(I,A){this._startName=I,this._endName=A}return Y.prototype.getConfig=function(I,A){var M=I;if(A.from!==0||A.to!==-1){var k=!0;M.indexOf("?")===-1&&(M+="?",k=!1),k&&(M+="&"),M+=this._startName+"="+A.from.toString(),A.to!==-1&&(M+="&"+this._endName+"="+A.to.toString())}return{url:M,headers:{}}},Y.prototype.removeURLParameters=function(I){var A=I.split("?")[0],M=void 0,k=I.indexOf("?");k!==-1&&(M=I.substring(k+1));var V="";if(M!=null&&M.length>0)for(var J=M.split("&"),F=0;F<J.length;F++){var G=J[F].split("="),$=F>0;G[0]!==this._startName&&G[0]!==this._endName&&($&&(V+="&"),V+=J[F])}return V.length===0?A:A+"?"+V},Y}();ye.default=te},"./src/io/range-seek-handler.js":function(we,ye,se){"use strict";se.r(ye);var te=function(){function Y(I){this._zeroStart=I||!1}return Y.prototype.getConfig=function(I,A){var M={};if(A.from!==0||A.to!==-1){var k=void 0;A.to!==-1?k="bytes="+A.from.toString()+"-"+A.to.toString():k="bytes="+A.from.toString()+"-",M.Range=k}else this._zeroStart&&(M.Range="bytes=0-");return{url:I,headers:M}},Y.prototype.removeURLParameters=function(I){return I},Y}();ye.default=te},"./src/io/speed-sampler.js":function(we,ye,se){"use strict";se.r(ye);var te=function(){function Y(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return Y.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},Y.prototype.addBytes=function(I){this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=I,this._totalBytes+=I):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=I,this._totalBytes+=I):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=I,this._totalBytes+=I,this._lastCheckpoint=this._now())},Object.defineProperty(Y.prototype,"currentKBps",{get:function(){this.addBytes(0);var A=(this._now()-this._lastCheckpoint)/1e3;return A==0&&(A=1),this._intervalBytes/A/1024},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),this._lastSecondBytes!==0?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(Y.prototype,"averageKBps",{get:function(){var A=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/A/1024},enumerable:!1,configurable:!0}),Y}();ye.default=te},"./src/io/websocket-loader.js":function(we,ye,se){"use strict";se.r(ye);var te=se("./src/io/loader.js"),Y=se("./src/utils/exception.js"),I=function(){var M=function(V,J){return M=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(F,G){F.__proto__=G}||function(F,G){for(var $ in G)Object.prototype.hasOwnProperty.call(G,$)&&(F[$]=G[$])},M(V,J)};return function(k,V){if(typeof V!="function"&&V!==null)throw new TypeError("Class extends value "+String(V)+" is not a constructor or null");M(k,V);function J(){this.constructor=k}k.prototype=V===null?Object.create(V):(J.prototype=V.prototype,new J)}}(),A=function(M){I(k,M);function k(){var V=M.call(this,"websocket-loader")||this;return V.TAG="WebSocketLoader",V._needStash=!0,V._ws=null,V._requestAbort=!1,V._receivedLength=0,V}return k.isSupported=function(){try{return typeof self.WebSocket!="undefined"}catch(V){return!1}},k.prototype.destroy=function(){this._ws&&this.abort(),M.prototype.destroy.call(this)},k.prototype.open=function(V){try{var J=this._ws=new self.WebSocket(V.url);J.binaryType="arraybuffer",J.onopen=this._onWebSocketOpen.bind(this),J.onclose=this._onWebSocketClose.bind(this),J.onmessage=this._onWebSocketMessage.bind(this),J.onerror=this._onWebSocketError.bind(this),this._status=te.LoaderStatus.kConnecting}catch(G){this._status=te.LoaderStatus.kError;var F={code:G.code,msg:G.message};if(this._onError)this._onError(te.LoaderErrors.EXCEPTION,F);else throw new Y.RuntimeException(F.msg)}},k.prototype.abort=function(){var V=this._ws;V&&(V.readyState===0||V.readyState===1)&&(this._requestAbort=!0,V.close()),this._ws=null,this._status=te.LoaderStatus.kComplete},k.prototype._onWebSocketOpen=function(V){this._status=te.LoaderStatus.kBuffering},k.prototype._onWebSocketClose=function(V){if(this._requestAbort===!0){this._requestAbort=!1;return}this._status=te.LoaderStatus.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)},k.prototype._onWebSocketMessage=function(V){var J=this;if(V.data instanceof ArrayBuffer)this._dispatchArrayBuffer(V.data);else if(V.data instanceof Blob){var F=new FileReader;F.onload=function(){J._dispatchArrayBuffer(F.result)},F.readAsArrayBuffer(V.data)}else{this._status=te.LoaderStatus.kError;var G={code:-1,msg:"Unsupported WebSocket message type: "+V.data.constructor.name};if(this._onError)this._onError(te.LoaderErrors.EXCEPTION,G);else throw new Y.RuntimeException(G.msg)}},k.prototype._dispatchArrayBuffer=function(V){var J=V,F=this._receivedLength;this._receivedLength+=J.byteLength,this._onDataArrival&&this._onDataArrival(J,F,this._receivedLength)},k.prototype._onWebSocketError=function(V){this._status=te.LoaderStatus.kError;var J={code:V.code,msg:V.message};if(this._onError)this._onError(te.LoaderErrors.EXCEPTION,J);else throw new Y.RuntimeException(J.msg)},k}(te.BaseLoader);ye.default=A},"./src/io/xhr-moz-chunked-loader.js":function(we,ye,se){"use strict";se.r(ye);var te=se("./src/utils/logger.js"),Y=se("./src/io/loader.js"),I=se("./src/utils/exception.js"),A=function(){var k=function(J,F){return k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(G,$){G.__proto__=$}||function(G,$){for(var H in $)Object.prototype.hasOwnProperty.call($,H)&&(G[H]=$[H])},k(J,F)};return function(V,J){if(typeof J!="function"&&J!==null)throw new TypeError("Class extends value "+String(J)+" is not a constructor or null");k(V,J);function F(){this.constructor=V}V.prototype=J===null?Object.create(J):(F.prototype=J.prototype,new F)}}(),M=function(k){A(V,k);function V(J,F){var G=k.call(this,"xhr-moz-chunked-loader")||this;return G.TAG="MozChunkedLoader",G._seekHandler=J,G._config=F,G._needStash=!0,G._xhr=null,G._requestAbort=!1,G._contentLength=null,G._receivedLength=0,G}return V.isSupported=function(){try{var J=new XMLHttpRequest;return J.open("GET","https://example.com",!0),J.responseType="moz-chunked-arraybuffer",J.responseType==="moz-chunked-arraybuffer"}catch(F){return te.default.w("MozChunkedLoader",F.message),!1}},V.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),k.prototype.destroy.call(this)},V.prototype.open=function(J,F){this._dataSource=J,this._range=F;var G=J.url;this._config.reuseRedirectedURL&&J.redirectedURL!=null&&(G=J.redirectedURL);var $=this._seekHandler.getConfig(G,F);this._requestURL=$.url;var H=this._xhr=new XMLHttpRequest;if(H.open("GET",$.url,!0),H.responseType="moz-chunked-arraybuffer",H.onreadystatechange=this._onReadyStateChange.bind(this),H.onprogress=this._onProgress.bind(this),H.onloadend=this._onLoadEnd.bind(this),H.onerror=this._onXhrError.bind(this),J.withCredentials&&(H.withCredentials=!0),typeof $.headers=="object"){var C=$.headers;for(var Q in C)C.hasOwnProperty(Q)&&H.setRequestHeader(Q,C[Q])}if(typeof this._config.headers=="object"){var C=this._config.headers;for(var Q in C)C.hasOwnProperty(Q)&&H.setRequestHeader(Q,C[Q])}this._status=Y.LoaderStatus.kConnecting,H.send()},V.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=Y.LoaderStatus.kComplete},V.prototype._onReadyStateChange=function(J){var F=J.target;if(F.readyState===2){if(F.responseURL!=null&&F.responseURL!==this._requestURL&&this._onURLRedirect){var G=this._seekHandler.removeURLParameters(F.responseURL);this._onURLRedirect(G)}if(F.status!==0&&(F.status<200||F.status>299))if(this._status=Y.LoaderStatus.kError,this._onError)this._onError(Y.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:F.status,msg:F.statusText});else throw new I.RuntimeException("MozChunkedLoader: Http code invalid, "+F.status+" "+F.statusText);else this._status=Y.LoaderStatus.kBuffering}},V.prototype._onProgress=function(J){if(this._status!==Y.LoaderStatus.kError){this._contentLength===null&&J.total!==null&&J.total!==0&&(this._contentLength=J.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var F=J.target.response,G=this._range.from+this._receivedLength;this._receivedLength+=F.byteLength,this._onDataArrival&&this._onDataArrival(F,G,this._receivedLength)}},V.prototype._onLoadEnd=function(J){if(this._requestAbort===!0){this._requestAbort=!1;return}else if(this._status===Y.LoaderStatus.kError)return;this._status=Y.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)},V.prototype._onXhrError=function(J){this._status=Y.LoaderStatus.kError;var F=0,G=null;if(this._contentLength&&J.loaded<this._contentLength?(F=Y.LoaderErrors.EARLY_EOF,G={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(F=Y.LoaderErrors.EXCEPTION,G={code:-1,msg:J.constructor.name+" "+J.type}),this._onError)this._onError(F,G);else throw new I.RuntimeException(G.msg)},V}(Y.BaseLoader);ye.default=M},"./src/io/xhr-range-loader.js":function(we,ye,se){"use strict";se.r(ye);var te=se("./src/utils/logger.js"),Y=se("./src/io/speed-sampler.js"),I=se("./src/io/loader.js"),A=se("./src/utils/exception.js"),M=function(){var V=function(F,G){return V=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function($,H){$.__proto__=H}||function($,H){for(var C in H)Object.prototype.hasOwnProperty.call(H,C)&&($[C]=H[C])},V(F,G)};return function(J,F){if(typeof F!="function"&&F!==null)throw new TypeError("Class extends value "+String(F)+" is not a constructor or null");V(J,F);function G(){this.constructor=J}J.prototype=F===null?Object.create(F):(G.prototype=F.prototype,new G)}}(),k=function(V){M(J,V);function J(F,G){var $=V.call(this,"xhr-range-loader")||this;return $.TAG="RangeLoader",$._seekHandler=F,$._config=G,$._needStash=!1,$._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],$._currentChunkSizeKB=384,$._currentSpeedNormalized=0,$._zeroSpeedChunkCount=0,$._xhr=null,$._speedSampler=new Y.default,$._requestAbort=!1,$._waitForTotalLength=!1,$._totalLengthReceived=!1,$._currentRequestURL=null,$._currentRedirectedURL=null,$._currentRequestRange=null,$._totalLength=null,$._contentLength=null,$._receivedLength=0,$._lastTimeLoaded=0,$}return J.isSupported=function(){try{var F=new XMLHttpRequest;return F.open("GET","https://example.com",!0),F.responseType="arraybuffer",F.responseType==="arraybuffer"}catch(G){return te.default.w("RangeLoader",G.message),!1}},J.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),V.prototype.destroy.call(this)},Object.defineProperty(J.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),J.prototype.open=function(F,G){this._dataSource=F,this._range=G,this._status=I.LoaderStatus.kConnecting;var $=!1;this._dataSource.filesize!=null&&this._dataSource.filesize!==0&&($=!0,this._totalLength=this._dataSource.filesize),!this._totalLengthReceived&&!$?(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1})):this._openSubRange()},J.prototype._openSubRange=function(){var F=this._currentChunkSizeKB*1024,G=this._range.from+this._receivedLength,$=G+F;this._contentLength!=null&&$-this._range.from>=this._contentLength&&($=this._range.from+this._contentLength-1),this._currentRequestRange={from:G,to:$},this._internalOpen(this._dataSource,this._currentRequestRange)},J.prototype._internalOpen=function(F,G){this._lastTimeLoaded=0;var $=F.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?$=this._currentRedirectedURL:F.redirectedURL!=null&&($=F.redirectedURL));var H=this._seekHandler.getConfig($,G);this._currentRequestURL=H.url;var C=this._xhr=new XMLHttpRequest;if(C.open("GET",H.url,!0),C.responseType="arraybuffer",C.onreadystatechange=this._onReadyStateChange.bind(this),C.onprogress=this._onProgress.bind(this),C.onload=this._onLoad.bind(this),C.onerror=this._onXhrError.bind(this),F.withCredentials&&(C.withCredentials=!0),typeof H.headers=="object"){var Q=H.headers;for(var ae in Q)Q.hasOwnProperty(ae)&&C.setRequestHeader(ae,Q[ae])}if(typeof this._config.headers=="object"){var Q=this._config.headers;for(var ae in Q)Q.hasOwnProperty(ae)&&C.setRequestHeader(ae,Q[ae])}C.send()},J.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=I.LoaderStatus.kComplete},J.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},J.prototype._onReadyStateChange=function(F){var G=F.target;if(G.readyState===2){if(G.responseURL!=null){var $=this._seekHandler.removeURLParameters(G.responseURL);G.responseURL!==this._currentRequestURL&&$!==this._currentRedirectedURL&&(this._currentRedirectedURL=$,this._onURLRedirect&&this._onURLRedirect($))}if(G.status>=200&&G.status<=299){if(this._waitForTotalLength)return;this._status=I.LoaderStatus.kBuffering}else if(this._status=I.LoaderStatus.kError,this._onError)this._onError(I.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:G.status,msg:G.statusText});else throw new A.RuntimeException("RangeLoader: Http code invalid, "+G.status+" "+G.statusText)}},J.prototype._onProgress=function(F){if(this._status!==I.LoaderStatus.kError){if(this._contentLength===null){var G=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,G=!0;var $=F.total;this._internalAbort(),$!=null&$!==0&&(this._totalLength=$)}if(this._range.to===-1?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,G){this._openSubRange();return}this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var H=F.loaded-this._lastTimeLoaded;this._lastTimeLoaded=F.loaded,this._speedSampler.addBytes(H)}},J.prototype._normalizeSpeed=function(F){var G=this._chunkSizeKBList,$=G.length-1,H=0,C=0,Q=$;if(F<G[0])return G[0];for(;C<=Q;){if(H=C+Math.floor((Q-C)/2),H===$||F>=G[H]&&F<G[H+1])return G[H];G[H]<F?C=H+1:Q=H-1}},J.prototype._onLoad=function(F){if(this._status!==I.LoaderStatus.kError){if(this._waitForTotalLength){this._waitForTotalLength=!1;return}this._lastTimeLoaded=0;var G=this._speedSampler.lastSecondKBps;if(G===0&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(G=this._speedSampler.currentKBps)),G!==0){var $=this._normalizeSpeed(G);this._currentSpeedNormalized!==$&&(this._currentSpeedNormalized=$,this._currentChunkSizeKB=$)}var H=F.target.response,C=this._range.from+this._receivedLength;this._receivedLength+=H.byteLength;var Q=!1;this._contentLength!=null&&this._receivedLength<this._contentLength?this._openSubRange():Q=!0,this._onDataArrival&&this._onDataArrival(H,C,this._receivedLength),Q&&(this._status=I.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},J.prototype._onXhrError=function(F){this._status=I.LoaderStatus.kError;var G=0,$=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(G=I.LoaderErrors.EARLY_EOF,$={code:-1,msg:"RangeLoader meet Early-Eof"}):(G=I.LoaderErrors.EXCEPTION,$={code:-1,msg:F.constructor.name+" "+F.type}),this._onError)this._onError(G,$);else throw new A.RuntimeException($.msg)},J}(I.BaseLoader);ye.default=k},"./src/player/flv-player.js":function(we,ye,se){"use strict";se.r(ye);var te=se("./node_modules/events/events.js"),Y=se.n(te),I=se("./src/utils/logger.js"),A=se("./src/utils/browser.js"),M=se("./src/player/player-events.js"),k=se("./src/core/transmuxer.js"),V=se("./src/core/transmuxing-events.js"),J=se("./src/core/mse-controller.js"),F=se("./src/core/mse-events.js"),G=se("./src/player/player-errors.js"),$=se("./src/config.js"),H=se("./src/utils/exception.js"),C=function(){function Q(ae,ue){if(this.TAG="FlvPlayer",this._type="FlvPlayer",this._emitter=new(Y()),this._config=(0,$.createDefaultConfig)(),typeof ue=="object"&&Object.assign(this._config,ue),ae.type.toLowerCase()!=="flv")throw new H.InvalidArgumentException("FlvPlayer requires an flv MediaDataSource input!");ae.isLive===!0&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=ae,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;var j=A.default.chrome&&(A.default.version.major<50||A.default.version.major===50&&A.default.version.build<2661);this._alwaysSeekKeyframe=!!(j||A.default.msedge||A.default.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}return Q.prototype.destroy=function(){this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},Q.prototype.on=function(ae,ue){var j=this;ae===M.default.MEDIA_INFO?this._mediaInfo!=null&&Promise.resolve().then(function(){j._emitter.emit(M.default.MEDIA_INFO,j.mediaInfo)}):ae===M.default.STATISTICS_INFO&&this._statisticsInfo!=null&&Promise.resolve().then(function(){j._emitter.emit(M.default.STATISTICS_INFO,j.statisticsInfo)}),this._emitter.addListener(ae,ue)},Q.prototype.off=function(ae,ue){this._emitter.removeListener(ae,ue)},Q.prototype.attachMediaElement=function(ae){var ue=this;if(this._mediaElement=ae,ae.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),ae.addEventListener("seeking",this.e.onvSeeking),ae.addEventListener("canplay",this.e.onvCanPlay),ae.addEventListener("stalled",this.e.onvStalled),ae.addEventListener("progress",this.e.onvProgress),this._msectl=new J.default(this._config),this._msectl.on(F.default.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(F.default.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(F.default.SOURCE_OPEN,function(){ue._mseSourceOpened=!0,ue._hasPendingLoad&&(ue._hasPendingLoad=!1,ue.load())}),this._msectl.on(F.default.ERROR,function(j){ue._emitter.emit(M.default.ERROR,G.ErrorTypes.MEDIA_ERROR,G.ErrorDetails.MEDIA_MSE_ERROR,j)}),this._msectl.attachMediaElement(ae),this._pendingSeekTime!=null)try{ae.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(j){}},Q.prototype.detachMediaElement=function(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)},Q.prototype.load=function(){var ae=this;if(!this._mediaElement)throw new H.IllegalStateException("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new H.IllegalStateException("FlvPlayer.load() has been called, please call unload() first!");if(!this._hasPendingLoad){if(this._config.deferLoadAfterSourceOpen&&this._mseSourceOpened===!1){this._hasPendingLoad=!0;return}this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new k.default(this._mediaDataSource,this._config),this._transmuxer.on(V.default.INIT_SEGMENT,function(ue,j){ae._msectl.appendInitSegment(j)}),this._transmuxer.on(V.default.MEDIA_SEGMENT,function(ue,j){if(ae._msectl.appendMediaSegment(j),ae._config.lazyLoad&&!ae._config.isLive){var X=ae._mediaElement.currentTime;j.info.endDts>=(X+ae._config.lazyLoadMaxDuration)*1e3&&ae._progressChecker==null&&(I.default.v(ae.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),ae._suspendTransmuxer())}}),this._transmuxer.on(V.default.LOADING_COMPLETE,function(){ae._msectl.endOfStream(),ae._emitter.emit(M.default.LOADING_COMPLETE)}),this._transmuxer.on(V.default.RECOVERED_EARLY_EOF,function(){ae._emitter.emit(M.default.RECOVERED_EARLY_EOF)}),this._transmuxer.on(V.default.IO_ERROR,function(ue,j){ae._emitter.emit(M.default.ERROR,G.ErrorTypes.NETWORK_ERROR,ue,j)}),this._transmuxer.on(V.default.DEMUX_ERROR,function(ue,j){ae._emitter.emit(M.default.ERROR,G.ErrorTypes.MEDIA_ERROR,ue,{code:-1,msg:j})}),this._transmuxer.on(V.default.MEDIA_INFO,function(ue){ae._mediaInfo=ue,ae._emitter.emit(M.default.MEDIA_INFO,Object.assign({},ue))}),this._transmuxer.on(V.default.METADATA_ARRIVED,function(ue){ae._emitter.emit(M.default.METADATA_ARRIVED,ue)}),this._transmuxer.on(V.default.SCRIPTDATA_ARRIVED,function(ue){ae._emitter.emit(M.default.SCRIPTDATA_ARRIVED,ue)}),this._transmuxer.on(V.default.STATISTICS_INFO,function(ue){ae._statisticsInfo=ae._fillStatisticsInfo(ue),ae._emitter.emit(M.default.STATISTICS_INFO,Object.assign({},ae._statisticsInfo))}),this._transmuxer.on(V.default.RECOMMEND_SEEKPOINT,function(ue){ae._mediaElement&&!ae._config.accurateSeek&&(ae._requestSetTime=!0,ae._mediaElement.currentTime=ue/1e3)}),this._transmuxer.open()}},Q.prototype.unload=function(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)},Q.prototype.play=function(){return this._mediaElement.play()},Q.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(Q.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(Q.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(Q.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(Q.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(ue){this._mediaElement.volume=ue},enumerable:!1,configurable:!0}),Object.defineProperty(Q.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(ue){this._mediaElement.muted=ue},enumerable:!1,configurable:!0}),Object.defineProperty(Q.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(ue){this._mediaElement?this._internalSeek(ue):this._pendingSeekTime=ue},enumerable:!1,configurable:!0}),Object.defineProperty(Q.prototype,"mediaInfo",{get:function(){return Object.assign({},this._mediaInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(Q.prototype,"statisticsInfo",{get:function(){return this._statisticsInfo==null&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)},enumerable:!1,configurable:!0}),Q.prototype._fillStatisticsInfo=function(ae){if(ae.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return ae;var ue=!0,j=0,X=0;if(this._mediaElement.getVideoPlaybackQuality){var oe=this._mediaElement.getVideoPlaybackQuality();j=oe.totalVideoFrames,X=oe.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(j=this._mediaElement.webkitDecodedFrameCount,X=this._mediaElement.webkitDroppedFrameCount):ue=!1;return ue&&(ae.decodedFrames=j,ae.droppedFrames=X),ae},Q.prototype._onmseUpdateEnd=function(){if(!(!this._config.lazyLoad||this._config.isLive)){for(var ae=this._mediaElement.buffered,ue=this._mediaElement.currentTime,j=0,X=0,oe=0;oe<ae.length;oe++){var ce=ae.start(oe),be=ae.end(oe);if(ce<=ue&&ue<be){j=ce,X=be;break}}X>=ue+this._config.lazyLoadMaxDuration&&this._progressChecker==null&&(I.default.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}},Q.prototype._onmseBufferFull=function(){I.default.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._progressChecker==null&&this._suspendTransmuxer()},Q.prototype._suspendTransmuxer=function(){this._transmuxer&&(this._transmuxer.pause(),this._progressChecker==null&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))},Q.prototype._checkProgressAndResume=function(){for(var ae=this._mediaElement.currentTime,ue=this._mediaElement.buffered,j=!1,X=0;X<ue.length;X++){var oe=ue.start(X),ce=ue.end(X);if(ae>=oe&&ae<ce){ae>=ce-this._config.lazyLoadRecoverDuration&&(j=!0);break}}j&&(window.clearInterval(this._progressChecker),this._progressChecker=null,j&&(I.default.v(this.TAG,"Continue loading from paused position"),this._transmuxer.resume()))},Q.prototype._isTimepointBuffered=function(ae){for(var ue=this._mediaElement.buffered,j=0;j<ue.length;j++){var X=ue.start(j),oe=ue.end(j);if(ae>=X&&ae<oe)return!0}return!1},Q.prototype._internalSeek=function(ae){var ue=this._isTimepointBuffered(ae),j=!1,X=0;if(ae<1&&this._mediaElement.buffered.length>0){var oe=this._mediaElement.buffered.start(0);(oe<1&&ae<oe||A.default.safari)&&(j=!0,X=A.default.safari?.1:oe)}if(j)this._requestSetTime=!0,this._mediaElement.currentTime=X;else if(ue){if(!this._alwaysSeekKeyframe)this._requestSetTime=!0,this._mediaElement.currentTime=ae;else{var ce=this._msectl.getNearestKeyframe(Math.floor(ae*1e3));this._requestSetTime=!0,ce!=null?this._mediaElement.currentTime=ce.dts/1e3:this._mediaElement.currentTime=ae}this._progressChecker!=null&&this._checkProgressAndResume()}else this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(ae),this._transmuxer.seek(Math.floor(ae*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=ae)},Q.prototype._checkAndApplyUnbufferedSeekpoint=function(){if(this._seekpointRecord)if(this._seekpointRecord.recordTime<=this._now()-100){var ae=this._mediaElement.currentTime;this._seekpointRecord=null,this._isTimepointBuffered(ae)||(this._progressChecker!=null&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(ae),this._transmuxer.seek(Math.floor(ae*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=ae))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},Q.prototype._checkAndResumeStuckPlayback=function(ae){var ue=this._mediaElement;if(ae||!this._receivedCanPlay||ue.readyState<2){var j=ue.buffered;j.length>0&&ue.currentTime<j.start(0)&&(I.default.w(this.TAG,"Playback seems stuck at "+ue.currentTime+", seek to "+j.start(0)),this._requestSetTime=!0,this._mediaElement.currentTime=j.start(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress))}else this._mediaElement.removeEventListener("progress",this.e.onvProgress)},Q.prototype._onvLoadedMetadata=function(ae){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)},Q.prototype._onvSeeking=function(ae){var ue=this._mediaElement.currentTime,j=this._mediaElement.buffered;if(this._requestSetTime){this._requestSetTime=!1;return}if(ue<1&&j.length>0){var X=j.start(0);if(X<1&&ue<X||A.default.safari){this._requestSetTime=!0,this._mediaElement.currentTime=A.default.safari?.1:X;return}}if(this._isTimepointBuffered(ue)){if(this._alwaysSeekKeyframe){var oe=this._msectl.getNearestKeyframe(Math.floor(ue*1e3));oe!=null&&(this._requestSetTime=!0,this._mediaElement.currentTime=oe.dts/1e3)}this._progressChecker!=null&&this._checkProgressAndResume();return}this._seekpointRecord={seekPoint:ue,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},Q.prototype._onvCanPlay=function(ae){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)},Q.prototype._onvStalled=function(ae){this._checkAndResumeStuckPlayback(!0)},Q.prototype._onvProgress=function(ae){this._checkAndResumeStuckPlayback()},Q}();ye.default=C},"./src/player/native-player.js":function(we,ye,se){"use strict";se.r(ye);var te=se("./node_modules/events/events.js"),Y=se.n(te),I=se("./src/player/player-events.js"),A=se("./src/config.js"),M=se("./src/utils/exception.js"),k=function(){function V(J,F){if(this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new(Y()),this._config=(0,A.createDefaultConfig)(),typeof F=="object"&&Object.assign(this._config,F),J.type.toLowerCase()==="flv")throw new M.InvalidArgumentException("NativePlayer does't support flv MediaDataSource input!");if(J.hasOwnProperty("segments"))throw new M.InvalidArgumentException("NativePlayer("+J.type+") doesn't support multipart playback!");this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=J,this._mediaElement=null}return V.prototype.destroy=function(){this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},V.prototype.on=function(J,F){var G=this;J===I.default.MEDIA_INFO?this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){G._emitter.emit(I.default.MEDIA_INFO,G.mediaInfo)}):J===I.default.STATISTICS_INFO&&this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){G._emitter.emit(I.default.STATISTICS_INFO,G.statisticsInfo)}),this._emitter.addListener(J,F)},V.prototype.off=function(J,F){this._emitter.removeListener(J,F)},V.prototype.attachMediaElement=function(J){if(this._mediaElement=J,J.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._pendingSeekTime!=null)try{J.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(F){}},V.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},V.prototype.load=function(){if(!this._mediaElement)throw new M.IllegalStateException("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},V.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},V.prototype.play=function(){return this._mediaElement.play()},V.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(V.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(F){this._mediaElement.volume=F},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(F){this._mediaElement.muted=F},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(F){this._mediaElement?this._mediaElement.currentTime=F:this._pendingSeekTime=F},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"mediaInfo",{get:function(){var F=this._mediaElement instanceof HTMLAudioElement?"audio/":"video/",G={mimeType:F+this._mediaDataSource.type};return this._mediaElement&&(G.duration=Math.floor(this._mediaElement.duration*1e3),this._mediaElement instanceof HTMLVideoElement&&(G.width=this._mediaElement.videoWidth,G.height=this._mediaElement.videoHeight)),G},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"statisticsInfo",{get:function(){var F={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return F;var G=!0,$=0,H=0;if(this._mediaElement.getVideoPlaybackQuality){var C=this._mediaElement.getVideoPlaybackQuality();$=C.totalVideoFrames,H=C.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?($=this._mediaElement.webkitDecodedFrameCount,H=this._mediaElement.webkitDroppedFrameCount):G=!1;return G&&(F.decodedFrames=$,F.droppedFrames=H),F},enumerable:!1,configurable:!0}),V.prototype._onvLoadedMetadata=function(J){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(I.default.MEDIA_INFO,this.mediaInfo)},V.prototype._reportStatisticsInfo=function(){this._emitter.emit(I.default.STATISTICS_INFO,this.statisticsInfo)},V}();ye.default=k},"./src/player/player-errors.js":function(we,ye,se){"use strict";se.r(ye),se.d(ye,{ErrorTypes:function(){return I},ErrorDetails:function(){return A}});var te=se("./src/io/loader.js"),Y=se("./src/demux/demux-errors.js"),I={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},A={NETWORK_EXCEPTION:te.LoaderErrors.EXCEPTION,NETWORK_STATUS_CODE_INVALID:te.LoaderErrors.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:te.LoaderErrors.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:te.LoaderErrors.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:Y.default.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:Y.default.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:Y.default.CODEC_UNSUPPORTED}},"./src/player/player-events.js":function(we,ye,se){"use strict";se.r(ye);var te={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info"};ye.default=te},"./src/remux/aac-silent.js":function(we,ye,se){"use strict";se.r(ye);var te=function(){function Y(){}return Y.getSilentFrame=function(I,A){if(I==="mp4a.40.2"){if(A===1)return new Uint8Array([0,200,0,128,35,128]);if(A===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(A===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(A===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(A===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(A===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(A===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(A===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(A===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},Y}();ye.default=te},"./src/remux/mp4-generator.js":function(we,ye,se){"use strict";se.r(ye);var te=function(){function Y(){}return Y.init=function(){Y.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[]};for(var I in Y.types)Y.types.hasOwnProperty(I)&&(Y.types[I]=[I.charCodeAt(0),I.charCodeAt(1),I.charCodeAt(2),I.charCodeAt(3)]);var A=Y.constants={};A.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),A.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),A.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),A.STSC=A.STCO=A.STTS,A.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),A.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),A.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),A.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),A.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),A.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},Y.box=function(I){for(var A=8,M=null,k=Array.prototype.slice.call(arguments,1),V=k.length,J=0;J<V;J++)A+=k[J].byteLength;M=new Uint8Array(A),M[0]=A>>>24&255,M[1]=A>>>16&255,M[2]=A>>>8&255,M[3]=A&255,M.set(I,4);for(var F=8,J=0;J<V;J++)M.set(k[J],F),F+=k[J].byteLength;return M},Y.generateInitSegment=function(I){var A=Y.box(Y.types.ftyp,Y.constants.FTYP),M=Y.moov(I),k=new Uint8Array(A.byteLength+M.byteLength);return k.set(A,0),k.set(M,A.byteLength),k},Y.moov=function(I){var A=Y.mvhd(I.timescale,I.duration),M=Y.trak(I),k=Y.mvex(I);return Y.box(Y.types.moov,A,M,k)},Y.mvhd=function(I,A){return Y.box(Y.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,I>>>24&255,I>>>16&255,I>>>8&255,I&255,A>>>24&255,A>>>16&255,A>>>8&255,A&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},Y.trak=function(I){return Y.box(Y.types.trak,Y.tkhd(I),Y.mdia(I))},Y.tkhd=function(I){var A=I.id,M=I.duration,k=I.presentWidth,V=I.presentHeight;return Y.box(Y.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,A>>>24&255,A>>>16&255,A>>>8&255,A&255,0,0,0,0,M>>>24&255,M>>>16&255,M>>>8&255,M&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,k>>>8&255,k&255,0,0,V>>>8&255,V&255,0,0]))},Y.mdia=function(I){return Y.box(Y.types.mdia,Y.mdhd(I),Y.hdlr(I),Y.minf(I))},Y.mdhd=function(I){var A=I.timescale,M=I.duration;return Y.box(Y.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,A>>>24&255,A>>>16&255,A>>>8&255,A&255,M>>>24&255,M>>>16&255,M>>>8&255,M&255,85,196,0,0]))},Y.hdlr=function(I){var A=null;return I.type==="audio"?A=Y.constants.HDLR_AUDIO:A=Y.constants.HDLR_VIDEO,Y.box(Y.types.hdlr,A)},Y.minf=function(I){var A=null;return I.type==="audio"?A=Y.box(Y.types.smhd,Y.constants.SMHD):A=Y.box(Y.types.vmhd,Y.constants.VMHD),Y.box(Y.types.minf,A,Y.dinf(),Y.stbl(I))},Y.dinf=function(){var I=Y.box(Y.types.dinf,Y.box(Y.types.dref,Y.constants.DREF));return I},Y.stbl=function(I){var A=Y.box(Y.types.stbl,Y.stsd(I),Y.box(Y.types.stts,Y.constants.STTS),Y.box(Y.types.stsc,Y.constants.STSC),Y.box(Y.types.stsz,Y.constants.STSZ),Y.box(Y.types.stco,Y.constants.STCO));return A},Y.stsd=function(I){return I.type==="audio"?I.codec==="mp3"?Y.box(Y.types.stsd,Y.constants.STSD_PREFIX,Y.mp3(I)):Y.box(Y.types.stsd,Y.constants.STSD_PREFIX,Y.mp4a(I)):Y.box(Y.types.stsd,Y.constants.STSD_PREFIX,Y.avc1(I))},Y.mp3=function(I){var A=I.channelCount,M=I.audioSampleRate,k=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,A,0,16,0,0,0,0,M>>>8&255,M&255,0,0]);return Y.box(Y.types[".mp3"],k)},Y.mp4a=function(I){var A=I.channelCount,M=I.audioSampleRate,k=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,A,0,16,0,0,0,0,M>>>8&255,M&255,0,0]);return Y.box(Y.types.mp4a,k,Y.esds(I))},Y.esds=function(I){var A=I.config||[],M=A.length,k=new Uint8Array([0,0,0,0,3,23+M,0,1,0,4,15+M,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([M]).concat(A).concat([6,1,2]));return Y.box(Y.types.esds,k)},Y.avc1=function(I){var A=I.avcc,M=I.codecWidth,k=I.codecHeight,V=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,M>>>8&255,M&255,k>>>8&255,k&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return Y.box(Y.types.avc1,V,Y.box(Y.types.avcC,A))},Y.mvex=function(I){return Y.box(Y.types.mvex,Y.trex(I))},Y.trex=function(I){var A=I.id,M=new Uint8Array([0,0,0,0,A>>>24&255,A>>>16&255,A>>>8&255,A&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return Y.box(Y.types.trex,M)},Y.moof=function(I,A){return Y.box(Y.types.moof,Y.mfhd(I.sequenceNumber),Y.traf(I,A))},Y.mfhd=function(I){var A=new Uint8Array([0,0,0,0,I>>>24&255,I>>>16&255,I>>>8&255,I&255]);return Y.box(Y.types.mfhd,A)},Y.traf=function(I,A){var M=I.id,k=Y.box(Y.types.tfhd,new Uint8Array([0,0,0,0,M>>>24&255,M>>>16&255,M>>>8&255,M&255])),V=Y.box(Y.types.tfdt,new Uint8Array([0,0,0,0,A>>>24&255,A>>>16&255,A>>>8&255,A&255])),J=Y.sdtp(I),F=Y.trun(I,J.byteLength+16+16+8+16+8+8);return Y.box(Y.types.traf,k,V,F,J)},Y.sdtp=function(I){for(var A=I.samples||[],M=A.length,k=new Uint8Array(4+M),V=0;V<M;V++){var J=A[V].flags;k[V+4]=J.isLeading<<6|J.dependsOn<<4|J.isDependedOn<<2|J.hasRedundancy}return Y.box(Y.types.sdtp,k)},Y.trun=function(I,A){var M=I.samples||[],k=M.length,V=12+16*k,J=new Uint8Array(V);A+=8+V,J.set([0,0,15,1,k>>>24&255,k>>>16&255,k>>>8&255,k&255,A>>>24&255,A>>>16&255,A>>>8&255,A&255],0);for(var F=0;F<k;F++){var G=M[F].duration,$=M[F].size,H=M[F].flags,C=M[F].cts;J.set([G>>>24&255,G>>>16&255,G>>>8&255,G&255,$>>>24&255,$>>>16&255,$>>>8&255,$&255,H.isLeading<<2|H.dependsOn,H.isDependedOn<<6|H.hasRedundancy<<4|H.isNonSync,0,0,C>>>24&255,C>>>16&255,C>>>8&255,C&255],12+16*F)}return Y.box(Y.types.trun,J)},Y.mdat=function(I){return Y.box(Y.types.mdat,I)},Y}();te.init(),ye.default=te},"./src/remux/mp4-remuxer.js":function(we,ye,se){"use strict";se.r(ye);var te=se("./src/utils/logger.js"),Y=se("./src/remux/mp4-generator.js"),I=se("./src/remux/aac-silent.js"),A=se("./src/utils/browser.js"),M=se("./src/core/media-segment-info.js"),k=se("./src/utils/exception.js"),V=function(){function J(F){this.TAG="MP4Remuxer",this._config=F,this._isLive=F.isLive===!0,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=Infinity,this._videoDtsBase=Infinity,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new M.MediaSegmentInfoList("audio"),this._videoSegmentInfoList=new M.MediaSegmentInfoList("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!!(A.default.chrome&&(A.default.version.major<50||A.default.version.major===50&&A.default.version.build<2661)),this._fillSilentAfterSeek=A.default.msedge||A.default.msie,this._mp3UseMpegAudio=!A.default.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return J.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},J.prototype.bindDataSource=function(F){return F.onDataAvailable=this.remux.bind(this),F.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(J.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(G){this._onInitSegment=G},enumerable:!1,configurable:!0}),Object.defineProperty(J.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(G){this._onMediaSegment=G},enumerable:!1,configurable:!0}),J.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},J.prototype.seek=function(F){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},J.prototype.remux=function(F,G){if(!this._onMediaSegment)throw new k.IllegalStateException("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(F,G),this._remuxVideo(G),this._remuxAudio(F)},J.prototype._onTrackMetadataReceived=function(F,G){var $=null,H="mp4",C=G.codec;if(F==="audio")this._audioMeta=G,G.codec==="mp3"&&this._mp3UseMpegAudio?(H="mpeg",C="",$=new Uint8Array):$=Y.default.generateInitSegment(G);else if(F==="video")this._videoMeta=G,$=Y.default.generateInitSegment(G);else return;if(!this._onInitSegment)throw new k.IllegalStateException("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(F,{type:F,data:$.buffer,codec:C,container:F+"/"+H,mediaDuration:G.duration})},J.prototype._calculateDtsBase=function(F,G){this._dtsBaseInited||(F.samples&&F.samples.length&&(this._audioDtsBase=F.samples[0].dts),G.samples&&G.samples.length&&(this._videoDtsBase=G.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},J.prototype.flushStashedSamples=function(){var F=this._videoStashedLastSample,G=this._audioStashedLastSample,$={type:"video",id:1,sequenceNumber:0,samples:[],length:0};F!=null&&($.samples.push(F),$.length=F.length);var H={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};G!=null&&(H.samples.push(G),H.length=G.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo($,!0),this._remuxAudio(H,!0)},J.prototype._remuxAudio=function(F,G){if(this._audioMeta!=null){var $=F,H=$.samples,C=void 0,Q=-1,ae=-1,ue=-1,j=this._audioMeta.refSampleDuration,X=this._audioMeta.codec==="mp3"&&this._mp3UseMpegAudio,oe=this._dtsBaseInited&&this._audioNextDts===void 0,ce=!1;if(!(!H||H.length===0)&&!(H.length===1&&!G)){var be=0,Be=null,Ce=0;X?(be=0,Ce=$.length):(be=8,Ce=8+$.length);var Le=null;if(H.length>1&&(Le=H.pop(),Ce-=Le.length),this._audioStashedLastSample!=null){var Pe=this._audioStashedLastSample;this._audioStashedLastSample=null,H.unshift(Pe),Ce+=Pe.length}Le!=null&&(this._audioStashedLastSample=Le);var De=H[0].dts-this._dtsBase;if(this._audioNextDts)C=De-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())C=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&this._audioMeta.originalCodec!=="mp3"&&(ce=!0);else{var Ve=this._audioSegmentInfoList.getLastSampleBefore(De);if(Ve!=null){var Oe=De-(Ve.originalDts+Ve.duration);Oe<=3&&(Oe=0);var dt=Ve.dts+Ve.duration+Oe;C=De-dt}else C=0}if(ce){var Nt=De-C,It=this._videoSegmentInfoList.getLastSegmentBefore(De);if(It!=null&&It.beginDts<Nt){var gt=I.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);if(gt){var nt=It.beginDts,Ht=Nt-It.beginDts;te.default.v(this.TAG,"InsertPrefixSilentAudio: dts: "+nt+", duration: "+Ht),H.unshift({unit:gt,dts:nt,pts:nt}),Ce+=gt.byteLength}}else ce=!1}for(var Tt=[],Gt=0;Gt<H.length;Gt++){var Pe=H[Gt],hi=Pe.unit,ai=Pe.dts-this._dtsBase,nt=ai,Ei=!1,Ai=null,Ct=0;if(!(ai<-.001)){if(this._audioMeta.codec!=="mp3"){var di=ai,ui=3;if(this._audioNextDts&&(di=this._audioNextDts),C=ai-di,C<=-ui*j){te.default.w(this.TAG,"Dropping 1 audio frame (originalDts: "+ai+" ms ,curRefDts: "+di+" ms)  due to dtsCorrection: "+C+" ms overlap.");continue}else if(C>=ui*j&&this._fillAudioTimestampGap&&!A.default.safari){Ei=!0;var ji=Math.floor(C/j);te.default.w(this.TAG,`Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.
`+("originalDts: "+ai+" ms, curRefDts: "+di+" ms, ")+("dtsCorrection: "+Math.round(C)+" ms, generate: "+ji+" frames")),nt=Math.floor(di),Ct=Math.floor(di+j)-nt;var gt=I.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);gt==null&&(te.default.w(this.TAG,"Unable to generate silent frame for "+(this._audioMeta.originalCodec+" with "+this._audioMeta.channelCount+" channels, repeat last frame")),gt=hi),Ai=[];for(var un=0;un<ji;un++){di=di+j;var $i=Math.floor(di),wt=Math.floor(di+j)-$i,mn={dts:$i,pts:$i,cts:0,unit:gt,size:gt.byteLength,duration:wt,originalDts:ai,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};Ai.push(mn),Ce+=mn.size}this._audioNextDts=di+j}else nt=Math.floor(di),Ct=Math.floor(di+j)-nt,this._audioNextDts=di+j}else{if(nt=ai-C,Gt!==H.length-1){var pi=H[Gt+1].dts-this._dtsBase-C;Ct=pi-nt}else if(Le!=null){var pi=Le.dts-this._dtsBase-C;Ct=pi-nt}else Tt.length>=1?Ct=Tt[Tt.length-1].duration:Ct=Math.floor(j);this._audioNextDts=nt+Ct}Q===-1&&(Q=nt),Tt.push({dts:nt,pts:nt,cts:0,unit:Pe.unit,size:Pe.unit.byteLength,duration:Ct,originalDts:ai,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),Ei&&Tt.push.apply(Tt,Ai)}}if(Tt.length===0){$.samples=[],$.length=0;return}X?Be=new Uint8Array(Ce):(Be=new Uint8Array(Ce),Be[0]=Ce>>>24&255,Be[1]=Ce>>>16&255,Be[2]=Ce>>>8&255,Be[3]=Ce&255,Be.set(Y.default.types.mdat,4));for(var Gt=0;Gt<Tt.length;Gt++){var hi=Tt[Gt].unit;Be.set(hi,be),be+=hi.byteLength}var ti=Tt[Tt.length-1];ae=ti.dts+ti.duration;var _i=new M.MediaSegmentInfo;_i.beginDts=Q,_i.endDts=ae,_i.beginPts=Q,_i.endPts=ae,_i.originalBeginDts=Tt[0].originalDts,_i.originalEndDts=ti.originalDts+ti.duration,_i.firstSample=new M.SampleInfo(Tt[0].dts,Tt[0].pts,Tt[0].duration,Tt[0].originalDts,!1),_i.lastSample=new M.SampleInfo(ti.dts,ti.pts,ti.duration,ti.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(_i),$.samples=Tt,$.sequenceNumber++;var Vi=null;X?Vi=new Uint8Array:Vi=Y.default.moof($,Q),$.samples=[],$.length=0;var nr={type:"audio",data:this._mergeBoxes(Vi,Be).buffer,sampleCount:Tt.length,info:_i};X&&oe&&(nr.timestampOffset=Q),this._onMediaSegment("audio",nr)}}},J.prototype._remuxVideo=function(F,G){if(this._videoMeta!=null){var $=F,H=$.samples,C=void 0,Q=-1,ae=-1,ue=-1,j=-1;if(!(!H||H.length===0)&&!(H.length===1&&!G)){var X=8,oe=null,ce=8+F.length,be=null;if(H.length>1&&(be=H.pop(),ce-=be.length),this._videoStashedLastSample!=null){var Be=this._videoStashedLastSample;this._videoStashedLastSample=null,H.unshift(Be),ce+=Be.length}be!=null&&(this._videoStashedLastSample=be);var Ce=H[0].dts-this._dtsBase;if(this._videoNextDts)C=Ce-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())C=0;else{var Le=this._videoSegmentInfoList.getLastSampleBefore(Ce);if(Le!=null){var Pe=Ce-(Le.originalDts+Le.duration);Pe<=3&&(Pe=0);var De=Le.dts+Le.duration+Pe;C=Ce-De}else C=0}for(var Ve=new M.MediaSegmentInfo,Oe=[],dt=0;dt<H.length;dt++){var Be=H[dt],Nt=Be.dts-this._dtsBase,It=Be.isKeyframe,gt=Nt-C,nt=Be.cts,Ht=gt+nt;Q===-1&&(Q=gt,ue=Ht);var Tt=0;if(dt!==H.length-1){var Gt=H[dt+1].dts-this._dtsBase-C;Tt=Gt-gt}else if(be!=null){var Gt=be.dts-this._dtsBase-C;Tt=Gt-gt}else Oe.length>=1?Tt=Oe[Oe.length-1].duration:Tt=Math.floor(this._videoMeta.refSampleDuration);if(It){var hi=new M.SampleInfo(gt,Ht,Tt,Be.dts,!0);hi.fileposition=Be.fileposition,Ve.appendSyncPoint(hi)}Oe.push({dts:gt,pts:Ht,cts:nt,units:Be.units,size:Be.length,isKeyframe:It,duration:Tt,originalDts:Nt,flags:{isLeading:0,dependsOn:It?2:1,isDependedOn:It?1:0,hasRedundancy:0,isNonSync:It?0:1}})}oe=new Uint8Array(ce),oe[0]=ce>>>24&255,oe[1]=ce>>>16&255,oe[2]=ce>>>8&255,oe[3]=ce&255,oe.set(Y.default.types.mdat,4);for(var dt=0;dt<Oe.length;dt++)for(var ai=Oe[dt].units;ai.length;){var Ei=ai.shift(),Ai=Ei.data;oe.set(Ai,X),X+=Ai.byteLength}var Ct=Oe[Oe.length-1];if(ae=Ct.dts+Ct.duration,j=Ct.pts+Ct.duration,this._videoNextDts=ae,Ve.beginDts=Q,Ve.endDts=ae,Ve.beginPts=ue,Ve.endPts=j,Ve.originalBeginDts=Oe[0].originalDts,Ve.originalEndDts=Ct.originalDts+Ct.duration,Ve.firstSample=new M.SampleInfo(Oe[0].dts,Oe[0].pts,Oe[0].duration,Oe[0].originalDts,Oe[0].isKeyframe),Ve.lastSample=new M.SampleInfo(Ct.dts,Ct.pts,Ct.duration,Ct.originalDts,Ct.isKeyframe),this._isLive||this._videoSegmentInfoList.append(Ve),$.samples=Oe,$.sequenceNumber++,this._forceFirstIDR){var di=Oe[0].flags;di.dependsOn=2,di.isNonSync=0}var ui=Y.default.moof($,Q);$.samples=[],$.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(ui,oe).buffer,sampleCount:Oe.length,info:Ve})}}},J.prototype._mergeBoxes=function(F,G){var $=new Uint8Array(F.byteLength+G.byteLength);return $.set(F,0),$.set(G,F.byteLength),$},J}();ye.default=V},"./src/utils/browser.js":function(we,ye,se){"use strict";se.r(ye);var te={};function Y(){var I=self.navigator.userAgent.toLowerCase(),A=/(edge)\/([\w.]+)/.exec(I)||/(opr)[\/]([\w.]+)/.exec(I)||/(chrome)[ \/]([\w.]+)/.exec(I)||/(iemobile)[\/]([\w.]+)/.exec(I)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(I)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(I)||/(webkit)[ \/]([\w.]+)/.exec(I)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(I)||/(msie) ([\w.]+)/.exec(I)||I.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(I)||I.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(I)||[],M=/(ipad)/.exec(I)||/(ipod)/.exec(I)||/(windows phone)/.exec(I)||/(iphone)/.exec(I)||/(kindle)/.exec(I)||/(android)/.exec(I)||/(windows)/.exec(I)||/(mac)/.exec(I)||/(linux)/.exec(I)||/(cros)/.exec(I)||[],k={browser:A[5]||A[3]||A[1]||"",version:A[2]||A[4]||"0",majorVersion:A[4]||A[2]||"0",platform:M[0]||""},V={};if(k.browser){V[k.browser]=!0;var J=k.majorVersion.split(".");V.version={major:parseInt(k.majorVersion,10),string:k.version},J.length>1&&(V.version.minor=parseInt(J[1],10)),J.length>2&&(V.version.build=parseInt(J[2],10))}if(k.platform&&(V[k.platform]=!0),(V.chrome||V.opr||V.safari)&&(V.webkit=!0),V.rv||V.iemobile){V.rv&&delete V.rv;var F="msie";k.browser=F,V[F]=!0}if(V.edge){delete V.edge;var G="msedge";k.browser=G,V[G]=!0}if(V.opr){var $="opera";k.browser=$,V[$]=!0}if(V.safari&&V.android){var H="android";k.browser=H,V[H]=!0}V.name=k.browser,V.platform=k.platform;for(var C in te)te.hasOwnProperty(C)&&delete te[C];Object.assign(te,V)}Y(),ye.default=te},"./src/utils/exception.js":function(we,ye,se){"use strict";se.r(ye),se.d(ye,{RuntimeException:function(){return Y},IllegalStateException:function(){return I},InvalidArgumentException:function(){return A},NotImplementedException:function(){return M}});var te=function(){var k=function(J,F){return k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(G,$){G.__proto__=$}||function(G,$){for(var H in $)Object.prototype.hasOwnProperty.call($,H)&&(G[H]=$[H])},k(J,F)};return function(V,J){if(typeof J!="function"&&J!==null)throw new TypeError("Class extends value "+String(J)+" is not a constructor or null");k(V,J);function F(){this.constructor=V}V.prototype=J===null?Object.create(J):(F.prototype=J.prototype,new F)}}(),Y=function(){function k(V){this._message=V}return Object.defineProperty(k.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),k.prototype.toString=function(){return this.name+": "+this.message},k}(),I=function(k){te(V,k);function V(J){return k.call(this,J)||this}return Object.defineProperty(V.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),V}(Y),A=function(k){te(V,k);function V(J){return k.call(this,J)||this}return Object.defineProperty(V.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),V}(Y),M=function(k){te(V,k);function V(J){return k.call(this,J)||this}return Object.defineProperty(V.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),V}(Y)},"./src/utils/logger.js":function(we,ye,se){"use strict";se.r(ye);var te=se("./node_modules/events/events.js"),Y=se.n(te),I=function(){function A(){}return A.e=function(M,k){(!M||A.FORCE_GLOBAL_TAG)&&(M=A.GLOBAL_TAG);var V="["+M+"] > "+k;A.ENABLE_CALLBACK&&A.emitter.emit("log","error",V),!!A.ENABLE_ERROR&&(console.error?console.error(V):console.warn?console.warn(V):console.log(V))},A.i=function(M,k){(!M||A.FORCE_GLOBAL_TAG)&&(M=A.GLOBAL_TAG);var V="["+M+"] > "+k;A.ENABLE_CALLBACK&&A.emitter.emit("log","info",V),!!A.ENABLE_INFO&&(console.info?console.info(V):console.log(V))},A.w=function(M,k){(!M||A.FORCE_GLOBAL_TAG)&&(M=A.GLOBAL_TAG);var V="["+M+"] > "+k;A.ENABLE_CALLBACK&&A.emitter.emit("log","warn",V),!!A.ENABLE_WARN&&(console.warn?console.warn(V):console.log(V))},A.d=function(M,k){(!M||A.FORCE_GLOBAL_TAG)&&(M=A.GLOBAL_TAG);var V="["+M+"] > "+k;A.ENABLE_CALLBACK&&A.emitter.emit("log","debug",V),!!A.ENABLE_DEBUG&&(console.debug?console.debug(V):console.log(V))},A.v=function(M,k){(!M||A.FORCE_GLOBAL_TAG)&&(M=A.GLOBAL_TAG);var V="["+M+"] > "+k;A.ENABLE_CALLBACK&&A.emitter.emit("log","verbose",V),!!A.ENABLE_VERBOSE&&console.log(V)},A}();I.GLOBAL_TAG="flv.js",I.FORCE_GLOBAL_TAG=!1,I.ENABLE_ERROR=!0,I.ENABLE_INFO=!0,I.ENABLE_WARN=!0,I.ENABLE_DEBUG=!0,I.ENABLE_VERBOSE=!0,I.ENABLE_CALLBACK=!1,I.emitter=new(Y()),ye.default=I},"./src/utils/logging-control.js":function(we,ye,se){"use strict";se.r(ye);var te=se("./node_modules/events/events.js"),Y=se.n(te),I=se("./src/utils/logger.js"),A=function(){function M(){}return Object.defineProperty(M,"forceGlobalTag",{get:function(){return I.default.FORCE_GLOBAL_TAG},set:function(V){I.default.FORCE_GLOBAL_TAG=V,M._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(M,"globalTag",{get:function(){return I.default.GLOBAL_TAG},set:function(V){I.default.GLOBAL_TAG=V,M._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(M,"enableAll",{get:function(){return I.default.ENABLE_VERBOSE&&I.default.ENABLE_DEBUG&&I.default.ENABLE_INFO&&I.default.ENABLE_WARN&&I.default.ENABLE_ERROR},set:function(V){I.default.ENABLE_VERBOSE=V,I.default.ENABLE_DEBUG=V,I.default.ENABLE_INFO=V,I.default.ENABLE_WARN=V,I.default.ENABLE_ERROR=V,M._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(M,"enableDebug",{get:function(){return I.default.ENABLE_DEBUG},set:function(V){I.default.ENABLE_DEBUG=V,M._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(M,"enableVerbose",{get:function(){return I.default.ENABLE_VERBOSE},set:function(V){I.default.ENABLE_VERBOSE=V,M._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(M,"enableInfo",{get:function(){return I.default.ENABLE_INFO},set:function(V){I.default.ENABLE_INFO=V,M._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(M,"enableWarn",{get:function(){return I.default.ENABLE_WARN},set:function(V){I.default.ENABLE_WARN=V,M._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(M,"enableError",{get:function(){return I.default.ENABLE_ERROR},set:function(V){I.default.ENABLE_ERROR=V,M._notifyChange()},enumerable:!1,configurable:!0}),M.getConfig=function(){return{globalTag:I.default.GLOBAL_TAG,forceGlobalTag:I.default.FORCE_GLOBAL_TAG,enableVerbose:I.default.ENABLE_VERBOSE,enableDebug:I.default.ENABLE_DEBUG,enableInfo:I.default.ENABLE_INFO,enableWarn:I.default.ENABLE_WARN,enableError:I.default.ENABLE_ERROR,enableCallback:I.default.ENABLE_CALLBACK}},M.applyConfig=function(k){I.default.GLOBAL_TAG=k.globalTag,I.default.FORCE_GLOBAL_TAG=k.forceGlobalTag,I.default.ENABLE_VERBOSE=k.enableVerbose,I.default.ENABLE_DEBUG=k.enableDebug,I.default.ENABLE_INFO=k.enableInfo,I.default.ENABLE_WARN=k.enableWarn,I.default.ENABLE_ERROR=k.enableError,I.default.ENABLE_CALLBACK=k.enableCallback},M._notifyChange=function(){var k=M.emitter;if(k.listenerCount("change")>0){var V=M.getConfig();k.emit("change",V)}},M.registerListener=function(k){M.emitter.addListener("change",k)},M.removeListener=function(k){M.emitter.removeListener("change",k)},M.addLogListener=function(k){I.default.emitter.addListener("log",k),I.default.emitter.listenerCount("log")>0&&(I.default.ENABLE_CALLBACK=!0,M._notifyChange())},M.removeLogListener=function(k){I.default.emitter.removeListener("log",k),I.default.emitter.listenerCount("log")===0&&(I.default.ENABLE_CALLBACK=!1,M._notifyChange())},M}();A.emitter=new(Y()),ye.default=A},"./src/utils/polyfill.js":function(we,ye,se){"use strict";se.r(ye);var te=function(){function Y(){}return Y.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(I,A){return I.__proto__=A,I},Object.assign=Object.assign||function(I){if(I==null)throw new TypeError("Cannot convert undefined or null to object");for(var A=Object(I),M=1;M<arguments.length;M++){var k=arguments[M];if(k!=null)for(var V in k)k.hasOwnProperty(V)&&(A[V]=k[V])}return A},typeof self.Promise!="function"&&se("./node_modules/es6-promise/dist/es6-promise.js").polyfill()},Y}();te.install(),ye.default=te},"./src/utils/utf8-conv.js":function(we,ye,se){"use strict";se.r(ye);function te(I,A,M){var k=I;if(A+M<k.length){for(;M--;)if((k[++A]&192)!=128)return!1;return!0}else return!1}function Y(I){for(var A=[],M=I,k=0,V=I.length;k<V;){if(M[k]<128){A.push(String.fromCharCode(M[k])),++k;continue}else if(!(M[k]<192)){if(M[k]<224){if(te(M,k,1)){var J=(M[k]&31)<<6|M[k+1]&63;if(J>=128){A.push(String.fromCharCode(J&65535)),k+=2;continue}}}else if(M[k]<240){if(te(M,k,2)){var J=(M[k]&15)<<12|(M[k+1]&63)<<6|M[k+2]&63;if(J>=2048&&(J&63488)!=55296){A.push(String.fromCharCode(J&65535)),k+=3;continue}}}else if(M[k]<248&&te(M,k,3)){var J=(M[k]&7)<<18|(M[k+1]&63)<<12|(M[k+2]&63)<<6|M[k+3]&63;if(J>65536&&J<1114112){J-=65536,A.push(String.fromCharCode(J>>>10|55296)),A.push(String.fromCharCode(J&1023|56320)),k+=4;continue}}}A.push(String.fromCharCode(65533)),++k}return A.join("")}ye.default=Y}},We={};function ve(_e){var we=We[_e];if(we!==void 0)return we.exports;var ye=We[_e]={exports:{}};return ne[_e].call(ye.exports,ye,ye.exports,ve),ye.exports}ve.m=ne,function(){ve.n=function(_e){var we=_e&&_e.__esModule?function(){return _e.default}:function(){return _e};return ve.d(we,{a:we}),we}}(),function(){ve.d=function(_e,we){for(var ye in we)ve.o(we,ye)&&!ve.o(_e,ye)&&Object.defineProperty(_e,ye,{enumerable:!0,get:we[ye]})}}(),function(){ve.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(_e){if(typeof window=="object")return window}}()}(),function(){ve.o=function(_e,we){return Object.prototype.hasOwnProperty.call(_e,we)}}(),function(){ve.r=function(_e){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(_e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(_e,"__esModule",{value:!0})}}();var ze=ve("./src/index.js");return ze}()})},13490:function(Kt,Ut,mt){"use strict";var ct=mt(58908),ne=function(ze,_e){return _e===void 0&&(_e=!1),function(we,ye,se){if(we){ze(we);return}if(ye.statusCode>=400&&ye.statusCode<=599){var te=se;if(_e)if(ct.TextDecoder){var Y=We(ye.headers&&ye.headers["content-type"]);try{te=new TextDecoder(Y).decode(se)}catch(I){}}else te=String.fromCharCode.apply(null,new Uint8Array(se));ze({cause:te});return}ze(null,se)}};function We(ve){return ve===void 0&&(ve=""),ve.toLowerCase().split(";").reduce(function(ze,_e){var we=_e.split("="),ye=we[0],se=we[1];return ye.trim()==="charset"?se.trim():ze},"utf-8")}Kt.exports=ne},9603:function(Kt,Ut,mt){"use strict";var ct=mt(58908),ne=mt(67154),We=mt(27376),ve=mt(61608),ze=mt(75973);te.httpHandler=mt(13490),te.requestInterceptorsStorage=new ve,te.responseInterceptorsStorage=new ve,te.retryManager=new ze;/**
 * @license
 * slighly modified parse-headers 2.0.2 <https://github.com/kesla/parse-headers/>
 * Copyright (c) 2014 David Bjrklund
 * Available under the MIT license
 * <https://github.com/kesla/parse-headers/blob/master/LICENCE>
 */var _e=function(k){var V={};return k&&k.trim().split(`
`).forEach(function(J){var F=J.indexOf(":"),G=J.slice(0,F).trim().toLowerCase(),$=J.slice(F+1).trim();typeof V[G]=="undefined"?V[G]=$:Array.isArray(V[G])?V[G].push($):V[G]=[V[G],$]}),V};Kt.exports=te,Kt.exports.default=te,te.XMLHttpRequest=ct.XMLHttpRequest||A,te.XDomainRequest="withCredentials"in new te.XMLHttpRequest?te.XMLHttpRequest:ct.XDomainRequest,we(["get","put","post","patch","head","delete"],function(M){te[M==="delete"?"del":M]=function(k,V,J){return V=se(k,V,J),V.method=M.toUpperCase(),Y(V)}});function we(M,k){for(var V=0;V<M.length;V++)k(M[V])}function ye(M){for(var k in M)if(M.hasOwnProperty(k))return!1;return!0}function se(M,k,V){var J=M;return We(k)?(V=k,typeof M=="string"&&(J={uri:M})):J=ne({},k,{uri:M}),J.callback=V,J}function te(M,k,V){return k=se(M,k,V),Y(k)}function Y(M){if(typeof M.callback=="undefined")throw new Error("callback argument missing");if(M.requestType&&te.requestInterceptorsStorage.getIsEnabled()){var k={uri:M.uri||M.url,headers:M.headers||{},body:M.body,metadata:M.metadata||{},retry:M.retry,timeout:M.timeout},V=te.requestInterceptorsStorage.execute(M.requestType,k);M.uri=V.uri,M.headers=V.headers,M.body=V.body,M.metadata=V.metadata,M.retry=V.retry,M.timeout=V.timeout}var J=!1,F=function(De,Ve,Oe){J||(J=!0,M.callback(De,Ve,Oe))};function G(){Q.readyState===4&&!te.responseInterceptorsStorage.getIsEnabled()&&setTimeout(C,0)}function $(){var Pe=void 0;if(Q.response?Pe=Q.response:Pe=Q.responseText||I(Q),Be)try{Pe=JSON.parse(Pe)}catch(De){}return Pe}function H(Pe){if(clearTimeout(Ce),clearTimeout(M.retryTimeout),Pe instanceof Error||(Pe=new Error(""+(Pe||"Unknown XMLHttpRequest Error"))),Pe.statusCode=0,!ue&&te.retryManager.getIsEnabled()&&M.retry&&M.retry.shouldRetry()){M.retryTimeout=setTimeout(function(){M.retry.moveToNextAttempt(),M.xhr=Q,Y(M)},M.retry.getCurrentFuzzedDelay());return}if(M.requestType&&te.responseInterceptorsStorage.getIsEnabled()){var De={headers:Le.headers||{},body:Le.body,responseUrl:Q.responseURL,responseType:Q.responseType},Ve=te.responseInterceptorsStorage.execute(M.requestType,De);Le.body=Ve.body,Le.headers=Ve.headers}return F(Pe,Le)}function C(){if(!ue){var Pe;clearTimeout(Ce),clearTimeout(M.retryTimeout),M.useXDR&&Q.status===void 0?Pe=200:Pe=Q.status===1223?204:Q.status;var De=Le,Ve=null;if(Pe!==0?(De={body:$(),statusCode:Pe,method:X,headers:{},url:j,rawRequest:Q},Q.getAllResponseHeaders&&(De.headers=_e(Q.getAllResponseHeaders()))):Ve=new Error("Internal XMLHttpRequest Error"),M.requestType&&te.responseInterceptorsStorage.getIsEnabled()){var Oe={headers:De.headers||{},body:De.body,responseUrl:Q.responseURL,responseType:Q.responseType},dt=te.responseInterceptorsStorage.execute(M.requestType,Oe);De.body=dt.body,De.headers=dt.headers}return F(Ve,De,De.body)}}var Q=M.xhr||null;Q||(M.cors||M.useXDR?Q=new te.XDomainRequest:Q=new te.XMLHttpRequest);var ae,ue,j=Q.url=M.uri||M.url,X=Q.method=M.method||"GET",oe=M.body||M.data,ce=Q.headers=M.headers||{},be=!!M.sync,Be=!1,Ce,Le={body:void 0,headers:{},statusCode:0,method:X,url:j,rawRequest:Q};if("json"in M&&M.json!==!1&&(Be=!0,ce.accept||ce.Accept||(ce.Accept="application/json"),X!=="GET"&&X!=="HEAD"&&(ce["content-type"]||ce["Content-Type"]||(ce["Content-Type"]="application/json"),oe=JSON.stringify(M.json===!0?oe:M.json))),Q.onreadystatechange=G,Q.onload=C,Q.onerror=H,Q.onprogress=function(){},Q.onabort=function(){ue=!0,clearTimeout(M.retryTimeout)},Q.ontimeout=H,Q.open(X,j,!be,M.username,M.password),be||(Q.withCredentials=!!M.withCredentials),!be&&M.timeout>0&&(Ce=setTimeout(function(){if(!ue){ue=!0,Q.abort("timeout");var Pe=new Error("XMLHttpRequest timeout");Pe.code="ETIMEDOUT",H(Pe)}},M.timeout)),Q.setRequestHeader)for(ae in ce)ce.hasOwnProperty(ae)&&Q.setRequestHeader(ae,ce[ae]);else if(M.headers&&!ye(M.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in M&&(Q.responseType=M.responseType),"beforeSend"in M&&typeof M.beforeSend=="function"&&M.beforeSend(Q),Q.send(oe||null),Q}function I(M){try{if(M.responseType==="document")return M.responseXML;var k=M.responseXML&&M.responseXML.documentElement.nodeName==="parsererror";if(M.responseType===""&&!k)return M.responseXML}catch(V){}return null}function A(){}},61608:function(Kt){"use strict";function Ut(We,ve){var ze=typeof Symbol!="undefined"&&We[Symbol.iterator]||We["@@iterator"];if(ze)return(ze=ze.call(We)).next.bind(ze);if(Array.isArray(We)||(ze=mt(We))||ve&&We&&typeof We.length=="number"){ze&&(We=ze);var _e=0;return function(){return _e>=We.length?{done:!0}:{done:!1,value:We[_e++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mt(We,ve){if(!!We){if(typeof We=="string")return ct(We,ve);var ze=Object.prototype.toString.call(We).slice(8,-1);if(ze==="Object"&&We.constructor&&(ze=We.constructor.name),ze==="Map"||ze==="Set")return Array.from(We);if(ze==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ze))return ct(We,ve)}}function ct(We,ve){(ve==null||ve>We.length)&&(ve=We.length);for(var ze=0,_e=new Array(ve);ze<ve;ze++)_e[ze]=We[ze];return _e}var ne=function(){function We(){this.typeToInterceptorsMap_=new Map,this.enabled_=!1}var ve=We.prototype;return ve.getIsEnabled=function(){return this.enabled_},ve.enable=function(){this.enabled_=!0},ve.disable=function(){this.enabled_=!1},ve.reset=function(){this.typeToInterceptorsMap_=new Map,this.enabled_=!1},ve.addInterceptor=function(_e,we){this.typeToInterceptorsMap_.has(_e)||this.typeToInterceptorsMap_.set(_e,new Set);var ye=this.typeToInterceptorsMap_.get(_e);return ye.has(we)?!1:(ye.add(we),!0)},ve.removeInterceptor=function(_e,we){var ye=this.typeToInterceptorsMap_.get(_e);return ye&&ye.has(we)?(ye.delete(we),!0):!1},ve.clearInterceptorsByType=function(_e){var we=this.typeToInterceptorsMap_.get(_e);return we?(this.typeToInterceptorsMap_.delete(_e),this.typeToInterceptorsMap_.set(_e,new Set),!0):!1},ve.clear=function(){return this.typeToInterceptorsMap_.size?(this.typeToInterceptorsMap_=new Map,!0):!1},ve.getForType=function(_e){return this.typeToInterceptorsMap_.get(_e)||new Set},ve.execute=function(_e,we){for(var ye=this.getForType(_e),se=Ut(ye),te;!(te=se()).done;){var Y=te.value;try{we=Y(we)}catch(I){}}return we},We}();Kt.exports=ne},75973:function(Kt){"use strict";var Ut=function(){function ct(){this.maxAttempts_=1,this.delayFactor_=.1,this.fuzzFactor_=.1,this.initialDelay_=1e3,this.enabled_=!1}var ne=ct.prototype;return ne.getIsEnabled=function(){return this.enabled_},ne.enable=function(){this.enabled_=!0},ne.disable=function(){this.enabled_=!1},ne.reset=function(){this.maxAttempts_=1,this.delayFactor_=.1,this.fuzzFactor_=.1,this.initialDelay_=1e3,this.enabled_=!1},ne.getMaxAttempts=function(){return this.maxAttempts_},ne.setMaxAttempts=function(ve){this.maxAttempts_=ve},ne.getDelayFactor=function(){return this.delayFactor_},ne.setDelayFactor=function(ve){this.delayFactor_=ve},ne.getFuzzFactor=function(){return this.fuzzFactor_},ne.setFuzzFactor=function(ve){this.fuzzFactor_=ve},ne.getInitialDelay=function(){return this.initialDelay_},ne.setInitialDelay=function(ve){this.initialDelay_=ve},ne.createRetry=function(ve){var ze=ve===void 0?{}:ve,_e=ze.maxAttempts,we=ze.delayFactor,ye=ze.fuzzFactor,se=ze.initialDelay;return new mt({maxAttempts:_e||this.maxAttempts_,delayFactor:we||this.delayFactor_,fuzzFactor:ye||this.fuzzFactor_,initialDelay:se||this.initialDelay_})},ct}(),mt=function(){function ct(We){this.maxAttempts_=We.maxAttempts,this.delayFactor_=We.delayFactor,this.fuzzFactor_=We.fuzzFactor,this.currentDelay_=We.initialDelay,this.currentAttempt_=1}var ne=ct.prototype;return ne.moveToNextAttempt=function(){this.currentAttempt_++;var ve=this.currentDelay_*this.delayFactor_;this.currentDelay_=this.currentDelay_+ve},ne.shouldRetry=function(){return this.currentAttempt_<this.maxAttempts_},ne.getCurrentDelay=function(){return this.currentDelay_},ne.getCurrentMinPossibleDelay=function(){return(1-this.fuzzFactor_)*this.currentDelay_},ne.getCurrentMaxPossibleDelay=function(){return(1+this.fuzzFactor_)*this.currentDelay_},ne.getCurrentFuzzedDelay=function(){var ve=this.getCurrentMinPossibleDelay(),ze=this.getCurrentMaxPossibleDelay();return ve+Math.random()*(ze-ve)},ct}();Kt.exports=Ut},72167:function(Kt,Ut){"use strict";function mt(ze,_e,we){if(we===void 0&&(we=Array.prototype),ze&&typeof we.find=="function")return we.find.call(ze,_e);for(var ye=0;ye<ze.length;ye++)if(Object.prototype.hasOwnProperty.call(ze,ye)){var se=ze[ye];if(_e.call(void 0,se,ye,ze))return se}}function ct(ze,_e){return _e===void 0&&(_e=Object),_e&&typeof _e.freeze=="function"?_e.freeze(ze):ze}function ne(ze,_e){if(ze===null||typeof ze!="object")throw new TypeError("target is not an object");for(var we in _e)Object.prototype.hasOwnProperty.call(_e,we)&&(ze[we]=_e[we]);return ze}var We=ct({HTML:"text/html",isHTML:function(ze){return ze===We.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),ve=ct({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(ze){return ze===ve.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});Ut.assign=ne,Ut.find=mt,Ut.freeze=ct,Ut.MIME_TYPE=We,Ut.NAMESPACE=ve},86129:function(Kt,Ut,mt){var ct,ne=mt(72167),We=mt(41146),ve=mt(31045),ze=mt(76925),_e=We.DOMImplementation,we=ne.NAMESPACE,ye=ze.ParseError,se=ze.XMLReader;function te(F){return F.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028]/g,`
`)}function Y(F){this.options=F||{locator:{}}}Y.prototype.parseFromString=function(F,G){var $=this.options,H=new se,C=$.domBuilder||new A,Q=$.errorHandler,ae=$.locator,ue=$.xmlns||{},j=/\/x?html?$/.test(G),X=j?ve.HTML_ENTITIES:ve.XML_ENTITIES;ae&&C.setDocumentLocator(ae),H.errorHandler=I(Q,C,ae),H.domBuilder=$.domBuilder||C,j&&(ue[""]=we.HTML),ue.xml=ue.xml||we.XML;var oe=$.normalizeLineEndings||te;return F&&typeof F=="string"?H.parse(oe(F),ue,X):H.errorHandler.error("invalid doc source"),C.doc};function I(F,G,$){if(!F){if(G instanceof A)return G;F=G}var H={},C=F instanceof Function;$=$||{};function Q(ae){var ue=F[ae];!ue&&C&&(ue=F.length==2?function(j){F(ae,j)}:F),H[ae]=ue&&function(j){ue("[xmldom "+ae+"]	"+j+k($))}||function(){}}return Q("warning"),Q("error"),Q("fatalError"),H}function A(){this.cdata=!1}function M(F,G){G.lineNumber=F.lineNumber,G.columnNumber=F.columnNumber}A.prototype={startDocument:function(){this.doc=new _e().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(F,G,$,H){var C=this.doc,Q=C.createElementNS(F,$||G),ae=H.length;J(this,Q),this.currentElement=Q,this.locator&&M(this.locator,Q);for(var ue=0;ue<ae;ue++){var F=H.getURI(ue),j=H.getValue(ue),$=H.getQName(ue),X=C.createAttributeNS(F,$);this.locator&&M(H.getLocator(ue),X),X.value=X.nodeValue=j,Q.setAttributeNode(X)}},endElement:function(F,G,$){var H=this.currentElement,C=H.tagName;this.currentElement=H.parentNode},startPrefixMapping:function(F,G){},endPrefixMapping:function(F){},processingInstruction:function(F,G){var $=this.doc.createProcessingInstruction(F,G);this.locator&&M(this.locator,$),J(this,$)},ignorableWhitespace:function(F,G,$){},characters:function(F,G,$){if(F=V.apply(this,arguments),F){if(this.cdata)var H=this.doc.createCDATASection(F);else var H=this.doc.createTextNode(F);this.currentElement?this.currentElement.appendChild(H):/^\s*$/.test(F)&&this.doc.appendChild(H),this.locator&&M(this.locator,H)}},skippedEntity:function(F){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(F){(this.locator=F)&&(F.lineNumber=0)},comment:function(F,G,$){F=V.apply(this,arguments);var H=this.doc.createComment(F);this.locator&&M(this.locator,H),J(this,H)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(F,G,$){var H=this.doc.implementation;if(H&&H.createDocumentType){var C=H.createDocumentType(F,G,$);this.locator&&M(this.locator,C),J(this,C),this.doc.doctype=C}},warning:function(F){console.warn("[xmldom warning]	"+F,k(this.locator))},error:function(F){console.error("[xmldom error]	"+F,k(this.locator))},fatalError:function(F){throw new ye(F,this.locator)}};function k(F){if(F)return`
@`+(F.systemId||"")+"#[line:"+F.lineNumber+",col:"+F.columnNumber+"]"}function V(F,G,$){return typeof F=="string"?F.substr(G,$):F.length>=G+$||G?new java.lang.String(F,G,$)+"":F}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(F){A.prototype[F]=function(){return null}});function J(F,G){F.currentElement?F.currentElement.appendChild(G):F.doc.appendChild(G)}ct=A,ct=te,Ut.DOMParser=Y},41146:function(Kt,Ut,mt){var ct=mt(72167),ne=ct.find,We=ct.NAMESPACE;function ve(ie){return ie!==""}function ze(ie){return ie?ie.split(/[\t\n\f\r ]+/).filter(ve):[]}function _e(ie,le){return ie.hasOwnProperty(le)||(ie[le]=!0),ie}function we(ie){if(!ie)return[];var le=ze(ie);return Object.keys(le.reduce(_e,{}))}function ye(ie){return function(le){return ie&&ie.indexOf(le)!==-1}}function se(ie,le){for(var Se in ie)Object.prototype.hasOwnProperty.call(ie,Se)&&(le[Se]=ie[Se])}function te(ie,le){var Se=ie.prototype;if(!(Se instanceof le)){let ft=function(){};var Xe=ft;ft.prototype=le.prototype,ft=new ft,se(Se,ft),ie.prototype=Se=ft}Se.constructor!=ie&&(typeof ie!="function"&&console.error("unknown Class:"+ie),Se.constructor=ie)}var Y={},I=Y.ELEMENT_NODE=1,A=Y.ATTRIBUTE_NODE=2,M=Y.TEXT_NODE=3,k=Y.CDATA_SECTION_NODE=4,V=Y.ENTITY_REFERENCE_NODE=5,J=Y.ENTITY_NODE=6,F=Y.PROCESSING_INSTRUCTION_NODE=7,G=Y.COMMENT_NODE=8,$=Y.DOCUMENT_NODE=9,H=Y.DOCUMENT_TYPE_NODE=10,C=Y.DOCUMENT_FRAGMENT_NODE=11,Q=Y.NOTATION_NODE=12,ae={},ue={},j=ae.INDEX_SIZE_ERR=(ue[1]="Index size error",1),X=ae.DOMSTRING_SIZE_ERR=(ue[2]="DOMString size error",2),oe=ae.HIERARCHY_REQUEST_ERR=(ue[3]="Hierarchy request error",3),ce=ae.WRONG_DOCUMENT_ERR=(ue[4]="Wrong document",4),be=ae.INVALID_CHARACTER_ERR=(ue[5]="Invalid character",5),Be=ae.NO_DATA_ALLOWED_ERR=(ue[6]="No data allowed",6),Ce=ae.NO_MODIFICATION_ALLOWED_ERR=(ue[7]="No modification allowed",7),Le=ae.NOT_FOUND_ERR=(ue[8]="Not found",8),Pe=ae.NOT_SUPPORTED_ERR=(ue[9]="Not supported",9),De=ae.INUSE_ATTRIBUTE_ERR=(ue[10]="Attribute in use",10),Ve=ae.INVALID_STATE_ERR=(ue[11]="Invalid state",11),Oe=ae.SYNTAX_ERR=(ue[12]="Syntax error",12),dt=ae.INVALID_MODIFICATION_ERR=(ue[13]="Invalid modification",13),Nt=ae.NAMESPACE_ERR=(ue[14]="Invalid namespace",14),It=ae.INVALID_ACCESS_ERR=(ue[15]="Invalid access",15);function gt(ie,le){if(le instanceof Error)var Se=le;else Se=this,Error.call(this,ue[ie]),this.message=ue[ie],Error.captureStackTrace&&Error.captureStackTrace(this,gt);return Se.code=ie,le&&(this.message=this.message+": "+le),Se}gt.prototype=Error.prototype,se(ae,gt);function nt(){}nt.prototype={length:0,item:function(ie){return ie>=0&&ie<this.length?this[ie]:null},toString:function(ie,le){for(var Se=[],Xe=0;Xe<this.length;Xe++)Yi(this[Xe],Se,ie,le);return Se.join("")},filter:function(ie){return Array.prototype.filter.call(this,ie)},indexOf:function(ie){return Array.prototype.indexOf.call(this,ie)}};function Ht(ie,le){this._node=ie,this._refresh=le,Tt(this)}function Tt(ie){var le=ie._node._inc||ie._node.ownerDocument._inc;if(ie._inc!==le){var Se=ie._refresh(ie._node);if(Yr(ie,"length",Se.length),!ie.$$length||Se.length<ie.$$length)for(var Xe=Se.length;Xe in ie;Xe++)Object.prototype.hasOwnProperty.call(ie,Xe)&&delete ie[Xe];se(Se,ie),ie._inc=le}}Ht.prototype.item=function(ie){return Tt(this),this[ie]||null},te(Ht,nt);function Gt(){}function hi(ie,le){for(var Se=ie.length;Se--;)if(ie[Se]===le)return Se}function ai(ie,le,Se,Xe){if(Xe?le[hi(le,Xe)]=Se:le[le.length++]=Se,ie){Se.ownerElement=ie;var ft=ie.ownerDocument;ft&&(Xe&&$i(ft,ie,Xe),un(ft,ie,Se))}}function Ei(ie,le,Se){var Xe=hi(le,Se);if(Xe>=0){for(var ft=le.length-1;Xe<ft;)le[Xe]=le[++Xe];if(le.length=ft,ie){var jt=ie.ownerDocument;jt&&($i(jt,ie,Se),Se.ownerElement=null)}}else throw new gt(Le,new Error(ie.tagName+"@"+Se))}Gt.prototype={length:0,item:nt.prototype.item,getNamedItem:function(ie){for(var le=this.length;le--;){var Se=this[le];if(Se.nodeName==ie)return Se}},setNamedItem:function(ie){var le=ie.ownerElement;if(le&&le!=this._ownerElement)throw new gt(De);var Se=this.getNamedItem(ie.nodeName);return ai(this._ownerElement,this,ie,Se),Se},setNamedItemNS:function(ie){var le=ie.ownerElement,Se;if(le&&le!=this._ownerElement)throw new gt(De);return Se=this.getNamedItemNS(ie.namespaceURI,ie.localName),ai(this._ownerElement,this,ie,Se),Se},removeNamedItem:function(ie){var le=this.getNamedItem(ie);return Ei(this._ownerElement,this,le),le},removeNamedItemNS:function(ie,le){var Se=this.getNamedItemNS(ie,le);return Ei(this._ownerElement,this,Se),Se},getNamedItemNS:function(ie,le){for(var Se=this.length;Se--;){var Xe=this[Se];if(Xe.localName==le&&Xe.namespaceURI==ie)return Xe}return null}};function Ai(){}Ai.prototype={hasFeature:function(ie,le){return!0},createDocument:function(ie,le,Se){var Xe=new ji;if(Xe.implementation=this,Xe.childNodes=new nt,Xe.doctype=Se||null,Se&&Xe.appendChild(Se),le){var ft=Xe.createElementNS(ie,le);Xe.appendChild(ft)}return Xe},createDocumentType:function(ie,le,Se){var Xe=new Mt;return Xe.name=ie,Xe.nodeName=ie,Xe.publicId=le||"",Xe.systemId=Se||"",Xe}};function Ct(){}Ct.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(ie,le){return ke(this,ie,le)},replaceChild:function(ie,le){ke(this,ie,le,Ze),le&&this.removeChild(le)},removeChild:function(ie){return mn(this,ie)},appendChild:function(ie){return this.insertBefore(ie,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(ie){return Fs(this.ownerDocument||this,this,ie)},normalize:function(){for(var ie=this.firstChild;ie;){var le=ie.nextSibling;le&&le.nodeType==M&&ie.nodeType==M?(this.removeChild(le),ie.appendData(le.data)):(ie.normalize(),ie=le)}},isSupported:function(ie,le){return this.ownerDocument.implementation.hasFeature(ie,le)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(ie){for(var le=this;le;){var Se=le._nsMap;if(Se){for(var Xe in Se)if(Object.prototype.hasOwnProperty.call(Se,Xe)&&Se[Xe]===ie)return Xe}le=le.nodeType==A?le.ownerDocument:le.parentNode}return null},lookupNamespaceURI:function(ie){for(var le=this;le;){var Se=le._nsMap;if(Se&&Object.prototype.hasOwnProperty.call(Se,ie))return Se[ie];le=le.nodeType==A?le.ownerDocument:le.parentNode}return null},isDefaultNamespace:function(ie){var le=this.lookupPrefix(ie);return le==null}};function di(ie){return ie=="<"&&"&lt;"||ie==">"&&"&gt;"||ie=="&"&&"&amp;"||ie=='"'&&"&quot;"||"&#"+ie.charCodeAt()+";"}se(Y,Ct),se(Y,Ct.prototype);function ui(ie,le){if(le(ie))return!0;if(ie=ie.firstChild)do if(ui(ie,le))return!0;while(ie=ie.nextSibling)}function ji(){this.ownerDocument=this}function un(ie,le,Se){ie&&ie._inc++;var Xe=Se.namespaceURI;Xe===We.XMLNS&&(le._nsMap[Se.prefix?Se.localName:""]=Se.value)}function $i(ie,le,Se,Xe){ie&&ie._inc++;var ft=Se.namespaceURI;ft===We.XMLNS&&delete le._nsMap[Se.prefix?Se.localName:""]}function wt(ie,le,Se){if(ie&&ie._inc){ie._inc++;var Xe=le.childNodes;if(Se)Xe[Xe.length++]=Se;else{for(var ft=le.firstChild,jt=0;ft;)Xe[jt++]=ft,ft=ft.nextSibling;Xe.length=jt,delete Xe[Xe.length]}}}function mn(ie,le){var Se=le.previousSibling,Xe=le.nextSibling;return Se?Se.nextSibling=Xe:ie.firstChild=Xe,Xe?Xe.previousSibling=Se:ie.lastChild=Se,le.parentNode=null,le.previousSibling=null,le.nextSibling=null,wt(ie.ownerDocument,ie),le}function pi(ie){return ie&&(ie.nodeType===Ct.DOCUMENT_NODE||ie.nodeType===Ct.DOCUMENT_FRAGMENT_NODE||ie.nodeType===Ct.ELEMENT_NODE)}function ti(ie){return ie&&(Vi(ie)||nr(ie)||_i(ie)||ie.nodeType===Ct.DOCUMENT_FRAGMENT_NODE||ie.nodeType===Ct.COMMENT_NODE||ie.nodeType===Ct.PROCESSING_INSTRUCTION_NODE)}function _i(ie){return ie&&ie.nodeType===Ct.DOCUMENT_TYPE_NODE}function Vi(ie){return ie&&ie.nodeType===Ct.ELEMENT_NODE}function nr(ie){return ie&&ie.nodeType===Ct.TEXT_NODE}function Bs(ie,le){var Se=ie.childNodes||[];if(ne(Se,Vi)||_i(le))return!1;var Xe=ne(Se,_i);return!(le&&Xe&&Se.indexOf(Xe)>Se.indexOf(le))}function cs(ie,le){var Se=ie.childNodes||[];function Xe(jt){return Vi(jt)&&jt!==le}if(ne(Se,Xe))return!1;var ft=ne(Se,_i);return!(le&&ft&&Se.indexOf(ft)>Se.indexOf(le))}function nn(ie,le,Se){if(!pi(ie))throw new gt(oe,"Unexpected parent node type "+ie.nodeType);if(Se&&Se.parentNode!==ie)throw new gt(Le,"child not in parent");if(!ti(le)||_i(le)&&ie.nodeType!==Ct.DOCUMENT_NODE)throw new gt(oe,"Unexpected node type "+le.nodeType+" for parent node type "+ie.nodeType)}function Ms(ie,le,Se){var Xe=ie.childNodes||[],ft=le.childNodes||[];if(le.nodeType===Ct.DOCUMENT_FRAGMENT_NODE){var jt=ft.filter(Vi);if(jt.length>1||ne(ft,nr))throw new gt(oe,"More than one element or text in fragment");if(jt.length===1&&!Bs(ie,Se))throw new gt(oe,"Element in fragment can not be inserted before doctype")}if(Vi(le)&&!Bs(ie,Se))throw new gt(oe,"Only one element can be added and only after doctype");if(_i(le)){if(ne(Xe,_i))throw new gt(oe,"Only one doctype is allowed");var bi=ne(Xe,Vi);if(Se&&Xe.indexOf(bi)<Xe.indexOf(Se))throw new gt(oe,"Doctype can only be inserted before an element");if(!Se&&bi)throw new gt(oe,"Doctype can not be appended since element is present")}}function Ze(ie,le,Se){var Xe=ie.childNodes||[],ft=le.childNodes||[];if(le.nodeType===Ct.DOCUMENT_FRAGMENT_NODE){var jt=ft.filter(Vi);if(jt.length>1||ne(ft,nr))throw new gt(oe,"More than one element or text in fragment");if(jt.length===1&&!cs(ie,Se))throw new gt(oe,"Element in fragment can not be inserted before doctype")}if(Vi(le)&&!cs(ie,Se))throw new gt(oe,"Only one element can be added and only after doctype");if(_i(le)){let cn=function(hn){return _i(hn)&&hn!==Se};var Di=cn;if(ne(Xe,cn))throw new gt(oe,"Only one doctype is allowed");var bi=ne(Xe,Vi);if(Se&&Xe.indexOf(bi)<Xe.indexOf(Se))throw new gt(oe,"Doctype can only be inserted before an element")}}function ke(ie,le,Se,Xe){nn(ie,le,Se),ie.nodeType===Ct.DOCUMENT_NODE&&(Xe||Ms)(ie,le,Se);var ft=le.parentNode;if(ft&&ft.removeChild(le),le.nodeType===C){var jt=le.firstChild;if(jt==null)return le;var bi=le.lastChild}else jt=bi=le;var Di=Se?Se.previousSibling:ie.lastChild;jt.previousSibling=Di,bi.nextSibling=Se,Di?Di.nextSibling=jt:ie.firstChild=jt,Se==null?ie.lastChild=bi:Se.previousSibling=bi;do jt.parentNode=ie;while(jt!==bi&&(jt=jt.nextSibling));return wt(ie.ownerDocument||ie,ie),le.nodeType==C&&(le.firstChild=le.lastChild=null),le}function rt(ie,le){return le.parentNode&&le.parentNode.removeChild(le),le.parentNode=ie,le.previousSibling=ie.lastChild,le.nextSibling=null,le.previousSibling?le.previousSibling.nextSibling=le:ie.firstChild=le,ie.lastChild=le,wt(ie.ownerDocument,ie,le),le}ji.prototype={nodeName:"#document",nodeType:$,doctype:null,documentElement:null,_inc:1,insertBefore:function(ie,le){if(ie.nodeType==C){for(var Se=ie.firstChild;Se;){var Xe=Se.nextSibling;this.insertBefore(Se,le),Se=Xe}return ie}return ke(this,ie,le),ie.ownerDocument=this,this.documentElement===null&&ie.nodeType===I&&(this.documentElement=ie),ie},removeChild:function(ie){return this.documentElement==ie&&(this.documentElement=null),mn(this,ie)},replaceChild:function(ie,le){ke(this,ie,le,Ze),ie.ownerDocument=this,le&&this.removeChild(le),Vi(ie)&&(this.documentElement=ie)},importNode:function(ie,le){return dn(this,ie,le)},getElementById:function(ie){var le=null;return ui(this.documentElement,function(Se){if(Se.nodeType==I&&Se.getAttribute("id")==ie)return le=Se,!0}),le},getElementsByClassName:function(ie){var le=we(ie);return new Ht(this,function(Se){var Xe=[];return le.length>0&&ui(Se.documentElement,function(ft){if(ft!==Se&&ft.nodeType===I){var jt=ft.getAttribute("class");if(jt){var bi=ie===jt;if(!bi){var Di=we(jt);bi=le.every(ye(Di))}bi&&Xe.push(ft)}}}),Xe})},createElement:function(ie){var le=new Lt;le.ownerDocument=this,le.nodeName=ie,le.tagName=ie,le.localName=ie,le.childNodes=new nt;var Se=le.attributes=new Gt;return Se._ownerElement=le,le},createDocumentFragment:function(){var ie=new Lr;return ie.ownerDocument=this,ie.childNodes=new nt,ie},createTextNode:function(ie){var le=new ki;return le.ownerDocument=this,le.appendData(ie),le},createComment:function(ie){var le=new mi;return le.ownerDocument=this,le.appendData(ie),le},createCDATASection:function(ie){var le=new Pn;return le.ownerDocument=this,le.appendData(ie),le},createProcessingInstruction:function(ie,le){var Se=new Jt;return Se.ownerDocument=this,Se.tagName=Se.nodeName=Se.target=ie,Se.nodeValue=Se.data=le,Se},createAttribute:function(ie){var le=new Yt;return le.ownerDocument=this,le.name=ie,le.nodeName=ie,le.localName=ie,le.specified=!0,le},createEntityReference:function(ie){var le=new Ti;return le.ownerDocument=this,le.nodeName=ie,le},createElementNS:function(ie,le){var Se=new Lt,Xe=le.split(":"),ft=Se.attributes=new Gt;return Se.childNodes=new nt,Se.ownerDocument=this,Se.nodeName=le,Se.tagName=le,Se.namespaceURI=ie,Xe.length==2?(Se.prefix=Xe[0],Se.localName=Xe[1]):Se.localName=le,ft._ownerElement=Se,Se},createAttributeNS:function(ie,le){var Se=new Yt,Xe=le.split(":");return Se.ownerDocument=this,Se.nodeName=le,Se.name=le,Se.namespaceURI=ie,Se.specified=!0,Xe.length==2?(Se.prefix=Xe[0],Se.localName=Xe[1]):Se.localName=le,Se}},te(ji,Ct);function Lt(){this._nsMap={}}Lt.prototype={nodeType:I,hasAttribute:function(ie){return this.getAttributeNode(ie)!=null},getAttribute:function(ie){var le=this.getAttributeNode(ie);return le&&le.value||""},getAttributeNode:function(ie){return this.attributes.getNamedItem(ie)},setAttribute:function(ie,le){var Se=this.ownerDocument.createAttribute(ie);Se.value=Se.nodeValue=""+le,this.setAttributeNode(Se)},removeAttribute:function(ie){var le=this.getAttributeNode(ie);le&&this.removeAttributeNode(le)},appendChild:function(ie){return ie.nodeType===C?this.insertBefore(ie,null):rt(this,ie)},setAttributeNode:function(ie){return this.attributes.setNamedItem(ie)},setAttributeNodeNS:function(ie){return this.attributes.setNamedItemNS(ie)},removeAttributeNode:function(ie){return this.attributes.removeNamedItem(ie.nodeName)},removeAttributeNS:function(ie,le){var Se=this.getAttributeNodeNS(ie,le);Se&&this.removeAttributeNode(Se)},hasAttributeNS:function(ie,le){return this.getAttributeNodeNS(ie,le)!=null},getAttributeNS:function(ie,le){var Se=this.getAttributeNodeNS(ie,le);return Se&&Se.value||""},setAttributeNS:function(ie,le,Se){var Xe=this.ownerDocument.createAttributeNS(ie,le);Xe.value=Xe.nodeValue=""+Se,this.setAttributeNode(Xe)},getAttributeNodeNS:function(ie,le){return this.attributes.getNamedItemNS(ie,le)},getElementsByTagName:function(ie){return new Ht(this,function(le){var Se=[];return ui(le,function(Xe){Xe!==le&&Xe.nodeType==I&&(ie==="*"||Xe.tagName==ie)&&Se.push(Xe)}),Se})},getElementsByTagNameNS:function(ie,le){return new Ht(this,function(Se){var Xe=[];return ui(Se,function(ft){ft!==Se&&ft.nodeType===I&&(ie==="*"||ft.namespaceURI===ie)&&(le==="*"||ft.localName==le)&&Xe.push(ft)}),Xe})}},ji.prototype.getElementsByTagName=Lt.prototype.getElementsByTagName,ji.prototype.getElementsByTagNameNS=Lt.prototype.getElementsByTagNameNS,te(Lt,Ct);function Yt(){}Yt.prototype.nodeType=A,te(Yt,Ct);function Dt(){}Dt.prototype={data:"",substringData:function(ie,le){return this.data.substring(ie,ie+le)},appendData:function(ie){ie=this.data+ie,this.nodeValue=this.data=ie,this.length=ie.length},insertData:function(ie,le){this.replaceData(ie,0,le)},appendChild:function(ie){throw new Error(ue[oe])},deleteData:function(ie,le){this.replaceData(ie,le,"")},replaceData:function(ie,le,Se){var Xe=this.data.substring(0,ie),ft=this.data.substring(ie+le);Se=Xe+Se+ft,this.nodeValue=this.data=Se,this.length=Se.length}},te(Dt,Ct);function ki(){}ki.prototype={nodeName:"#text",nodeType:M,splitText:function(ie){var le=this.data,Se=le.substring(ie);le=le.substring(0,ie),this.data=this.nodeValue=le,this.length=le.length;var Xe=this.ownerDocument.createTextNode(Se);return this.parentNode&&this.parentNode.insertBefore(Xe,this.nextSibling),Xe}},te(ki,Dt);function mi(){}mi.prototype={nodeName:"#comment",nodeType:G},te(mi,Dt);function Pn(){}Pn.prototype={nodeName:"#cdata-section",nodeType:k},te(Pn,Dt);function Mt(){}Mt.prototype.nodeType=H,te(Mt,Ct);function mr(){}mr.prototype.nodeType=Q,te(mr,Ct);function hs(){}hs.prototype.nodeType=J,te(hs,Ct);function Ti(){}Ti.prototype.nodeType=V,te(Ti,Ct);function Lr(){}Lr.prototype.nodeName="#document-fragment",Lr.prototype.nodeType=C,te(Lr,Ct);function Jt(){}Jt.prototype.nodeType=F,te(Jt,Ct);function rr(){}rr.prototype.serializeToString=function(ie,le,Se){return Kr.call(ie,le,Se)},Ct.prototype.toString=Kr;function Kr(ie,le){var Se=[],Xe=this.nodeType==9&&this.documentElement||this,ft=Xe.prefix,jt=Xe.namespaceURI;if(jt&&ft==null){var ft=Xe.lookupPrefix(jt);if(ft==null)var bi=[{namespace:jt,prefix:null}]}return Yi(this,Se,ie,le,bi),Se.join("")}function ca(ie,le,Se){var Xe=ie.prefix||"",ft=ie.namespaceURI;if(!ft||Xe==="xml"&&ft===We.XML||ft===We.XMLNS)return!1;for(var jt=Se.length;jt--;){var bi=Se[jt];if(bi.prefix===Xe)return bi.namespace!==ft}return!0}function Dr(ie,le,Se){ie.push(" ",le,'="',Se.replace(/[<>&"\t\n\r]/g,di),'"')}function Yi(ie,le,Se,Xe,ft){if(ft||(ft=[]),Xe)if(ie=Xe(ie),ie){if(typeof ie=="string"){le.push(ie);return}}else return;switch(ie.nodeType){case I:var jt=ie.attributes,bi=jt.length,Di=ie.firstChild,cn=ie.tagName;Se=We.isHTML(ie.namespaceURI)||Se;var hn=cn;if(!Se&&!ie.prefix&&ie.namespaceURI){for(var Wn,sr=0;sr<jt.length;sr++)if(jt.item(sr).name==="xmlns"){Wn=jt.item(sr).value;break}if(!Wn)for(var On=ft.length-1;On>=0;On--){var Fn=ft[On];if(Fn.prefix===""&&Fn.namespace===ie.namespaceURI){Wn=Fn.namespace;break}}if(Wn!==ie.namespaceURI)for(var On=ft.length-1;On>=0;On--){var Fn=ft[On];if(Fn.namespace===ie.namespaceURI){Fn.prefix&&(hn=Fn.prefix+":"+cn);break}}}le.push("<",hn);for(var An=0;An<bi;An++){var Xi=jt.item(An);Xi.prefix=="xmlns"?ft.push({prefix:Xi.localName,namespace:Xi.value}):Xi.nodeName=="xmlns"&&ft.push({prefix:"",namespace:Xi.value})}for(var An=0;An<bi;An++){var Xi=jt.item(An);if(ca(Xi,Se,ft)){var Nn=Xi.prefix||"",gr=Xi.namespaceURI;Dr(le,Nn?"xmlns:"+Nn:"xmlns",gr),ft.push({prefix:Nn,namespace:gr})}Yi(Xi,le,Se,Xe,ft)}if(cn===hn&&ca(ie,Se,ft)){var Nn=ie.prefix||"",gr=ie.namespaceURI;Dr(le,Nn?"xmlns:"+Nn:"xmlns",gr),ft.push({prefix:Nn,namespace:gr})}if(Di||Se&&!/^(?:meta|link|img|br|hr|input)$/i.test(cn)){if(le.push(">"),Se&&/^script$/i.test(cn))for(;Di;)Di.data?le.push(Di.data):Yi(Di,le,Se,Xe,ft.slice()),Di=Di.nextSibling;else for(;Di;)Yi(Di,le,Se,Xe,ft.slice()),Di=Di.nextSibling;le.push("</",hn,">")}else le.push("/>");return;case $:case C:for(var Di=ie.firstChild;Di;)Yi(Di,le,Se,Xe,ft.slice()),Di=Di.nextSibling;return;case A:return Dr(le,ie.name,ie.value);case M:return le.push(ie.data.replace(/[<&>]/g,di));case k:return le.push("<![CDATA[",ie.data,"]]>");case G:return le.push("<!--",ie.data,"-->");case H:var kr=ie.publicId,xi=ie.systemId;if(le.push("<!DOCTYPE ",ie.name),kr)le.push(" PUBLIC ",kr),xi&&xi!="."&&le.push(" ",xi),le.push(">");else if(xi&&xi!=".")le.push(" SYSTEM ",xi,">");else{var Ir=ie.internalSubset;Ir&&le.push(" [",Ir,"]"),le.push(">")}return;case F:return le.push("<?",ie.target," ",ie.data,"?>");case V:return le.push("&",ie.nodeName,";");default:le.push("??",ie.nodeName)}}function dn(ie,le,Se){var Xe;switch(le.nodeType){case I:Xe=le.cloneNode(!1),Xe.ownerDocument=ie;case C:break;case A:Se=!0;break}if(Xe||(Xe=le.cloneNode(!1)),Xe.ownerDocument=ie,Xe.parentNode=null,Se)for(var ft=le.firstChild;ft;)Xe.appendChild(dn(ie,ft,Se)),ft=ft.nextSibling;return Xe}function Fs(ie,le,Se){var Xe=new le.constructor;for(var ft in le)if(Object.prototype.hasOwnProperty.call(le,ft)){var jt=le[ft];typeof jt!="object"&&jt!=Xe[ft]&&(Xe[ft]=jt)}switch(le.childNodes&&(Xe.childNodes=new nt),Xe.ownerDocument=ie,Xe.nodeType){case I:var bi=le.attributes,Di=Xe.attributes=new Gt,cn=bi.length;Di._ownerElement=Xe;for(var hn=0;hn<cn;hn++)Xe.setAttributeNode(Fs(ie,bi.item(hn),!0));break;case A:Se=!0}if(Se)for(var Wn=le.firstChild;Wn;)Xe.appendChild(Fs(ie,Wn,Se)),Wn=Wn.nextSibling;return Xe}function Yr(ie,le,Se){ie[le]=Se}try{if(Object.defineProperty){let ie=function(le){switch(le.nodeType){case I:case C:var Se=[];for(le=le.firstChild;le;)le.nodeType!==7&&le.nodeType!==8&&Se.push(ie(le)),le=le.nextSibling;return Se.join("");default:return le.nodeValue}};var ko=ie;Object.defineProperty(Ht.prototype,"length",{get:function(){return Tt(this),this.$$length}}),Object.defineProperty(Ct.prototype,"textContent",{get:function(){return ie(this)},set:function(le){switch(this.nodeType){case I:case C:for(;this.firstChild;)this.removeChild(this.firstChild);(le||String(le))&&this.appendChild(this.ownerDocument.createTextNode(le));break;default:this.data=le,this.value=le,this.nodeValue=le}}}),Yr=function(le,Se,Xe){le["$$"+Se]=Xe}}}catch(ie){}Ut.DocumentType=Mt,Ut.DOMException=gt,Ut.DOMImplementation=Ai,Ut.Element=Lt,Ut.Node=Ct,Ut.NodeList=nt,Ut.XMLSerializer=rr},31045:function(Kt,Ut,mt){"use strict";var ct=mt(72167).freeze;Ut.XML_ENTITIES=ct({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),Ut.HTML_ENTITIES=ct({Aacute:"\xC1",aacute:"\xE1",Abreve:"\u0102",abreve:"\u0103",ac:"\u223E",acd:"\u223F",acE:"\u223E\u0333",Acirc:"\xC2",acirc:"\xE2",acute:"\xB4",Acy:"\u0410",acy:"\u0430",AElig:"\xC6",aelig:"\xE6",af:"\u2061",Afr:"\u{1D504}",afr:"\u{1D51E}",Agrave:"\xC0",agrave:"\xE0",alefsym:"\u2135",aleph:"\u2135",Alpha:"\u0391",alpha:"\u03B1",Amacr:"\u0100",amacr:"\u0101",amalg:"\u2A3F",AMP:"&",amp:"&",And:"\u2A53",and:"\u2227",andand:"\u2A55",andd:"\u2A5C",andslope:"\u2A58",andv:"\u2A5A",ang:"\u2220",ange:"\u29A4",angle:"\u2220",angmsd:"\u2221",angmsdaa:"\u29A8",angmsdab:"\u29A9",angmsdac:"\u29AA",angmsdad:"\u29AB",angmsdae:"\u29AC",angmsdaf:"\u29AD",angmsdag:"\u29AE",angmsdah:"\u29AF",angrt:"\u221F",angrtvb:"\u22BE",angrtvbd:"\u299D",angsph:"\u2222",angst:"\xC5",angzarr:"\u237C",Aogon:"\u0104",aogon:"\u0105",Aopf:"\u{1D538}",aopf:"\u{1D552}",ap:"\u2248",apacir:"\u2A6F",apE:"\u2A70",ape:"\u224A",apid:"\u224B",apos:"'",ApplyFunction:"\u2061",approx:"\u2248",approxeq:"\u224A",Aring:"\xC5",aring:"\xE5",Ascr:"\u{1D49C}",ascr:"\u{1D4B6}",Assign:"\u2254",ast:"*",asymp:"\u2248",asympeq:"\u224D",Atilde:"\xC3",atilde:"\xE3",Auml:"\xC4",auml:"\xE4",awconint:"\u2233",awint:"\u2A11",backcong:"\u224C",backepsilon:"\u03F6",backprime:"\u2035",backsim:"\u223D",backsimeq:"\u22CD",Backslash:"\u2216",Barv:"\u2AE7",barvee:"\u22BD",Barwed:"\u2306",barwed:"\u2305",barwedge:"\u2305",bbrk:"\u23B5",bbrktbrk:"\u23B6",bcong:"\u224C",Bcy:"\u0411",bcy:"\u0431",bdquo:"\u201E",becaus:"\u2235",Because:"\u2235",because:"\u2235",bemptyv:"\u29B0",bepsi:"\u03F6",bernou:"\u212C",Bernoullis:"\u212C",Beta:"\u0392",beta:"\u03B2",beth:"\u2136",between:"\u226C",Bfr:"\u{1D505}",bfr:"\u{1D51F}",bigcap:"\u22C2",bigcirc:"\u25EF",bigcup:"\u22C3",bigodot:"\u2A00",bigoplus:"\u2A01",bigotimes:"\u2A02",bigsqcup:"\u2A06",bigstar:"\u2605",bigtriangledown:"\u25BD",bigtriangleup:"\u25B3",biguplus:"\u2A04",bigvee:"\u22C1",bigwedge:"\u22C0",bkarow:"\u290D",blacklozenge:"\u29EB",blacksquare:"\u25AA",blacktriangle:"\u25B4",blacktriangledown:"\u25BE",blacktriangleleft:"\u25C2",blacktriangleright:"\u25B8",blank:"\u2423",blk12:"\u2592",blk14:"\u2591",blk34:"\u2593",block:"\u2588",bne:"=\u20E5",bnequiv:"\u2261\u20E5",bNot:"\u2AED",bnot:"\u2310",Bopf:"\u{1D539}",bopf:"\u{1D553}",bot:"\u22A5",bottom:"\u22A5",bowtie:"\u22C8",boxbox:"\u29C9",boxDL:"\u2557",boxDl:"\u2556",boxdL:"\u2555",boxdl:"\u2510",boxDR:"\u2554",boxDr:"\u2553",boxdR:"\u2552",boxdr:"\u250C",boxH:"\u2550",boxh:"\u2500",boxHD:"\u2566",boxHd:"\u2564",boxhD:"\u2565",boxhd:"\u252C",boxHU:"\u2569",boxHu:"\u2567",boxhU:"\u2568",boxhu:"\u2534",boxminus:"\u229F",boxplus:"\u229E",boxtimes:"\u22A0",boxUL:"\u255D",boxUl:"\u255C",boxuL:"\u255B",boxul:"\u2518",boxUR:"\u255A",boxUr:"\u2559",boxuR:"\u2558",boxur:"\u2514",boxV:"\u2551",boxv:"\u2502",boxVH:"\u256C",boxVh:"\u256B",boxvH:"\u256A",boxvh:"\u253C",boxVL:"\u2563",boxVl:"\u2562",boxvL:"\u2561",boxvl:"\u2524",boxVR:"\u2560",boxVr:"\u255F",boxvR:"\u255E",boxvr:"\u251C",bprime:"\u2035",Breve:"\u02D8",breve:"\u02D8",brvbar:"\xA6",Bscr:"\u212C",bscr:"\u{1D4B7}",bsemi:"\u204F",bsim:"\u223D",bsime:"\u22CD",bsol:"\\",bsolb:"\u29C5",bsolhsub:"\u27C8",bull:"\u2022",bullet:"\u2022",bump:"\u224E",bumpE:"\u2AAE",bumpe:"\u224F",Bumpeq:"\u224E",bumpeq:"\u224F",Cacute:"\u0106",cacute:"\u0107",Cap:"\u22D2",cap:"\u2229",capand:"\u2A44",capbrcup:"\u2A49",capcap:"\u2A4B",capcup:"\u2A47",capdot:"\u2A40",CapitalDifferentialD:"\u2145",caps:"\u2229\uFE00",caret:"\u2041",caron:"\u02C7",Cayleys:"\u212D",ccaps:"\u2A4D",Ccaron:"\u010C",ccaron:"\u010D",Ccedil:"\xC7",ccedil:"\xE7",Ccirc:"\u0108",ccirc:"\u0109",Cconint:"\u2230",ccups:"\u2A4C",ccupssm:"\u2A50",Cdot:"\u010A",cdot:"\u010B",cedil:"\xB8",Cedilla:"\xB8",cemptyv:"\u29B2",cent:"\xA2",CenterDot:"\xB7",centerdot:"\xB7",Cfr:"\u212D",cfr:"\u{1D520}",CHcy:"\u0427",chcy:"\u0447",check:"\u2713",checkmark:"\u2713",Chi:"\u03A7",chi:"\u03C7",cir:"\u25CB",circ:"\u02C6",circeq:"\u2257",circlearrowleft:"\u21BA",circlearrowright:"\u21BB",circledast:"\u229B",circledcirc:"\u229A",circleddash:"\u229D",CircleDot:"\u2299",circledR:"\xAE",circledS:"\u24C8",CircleMinus:"\u2296",CirclePlus:"\u2295",CircleTimes:"\u2297",cirE:"\u29C3",cire:"\u2257",cirfnint:"\u2A10",cirmid:"\u2AEF",cirscir:"\u29C2",ClockwiseContourIntegral:"\u2232",CloseCurlyDoubleQuote:"\u201D",CloseCurlyQuote:"\u2019",clubs:"\u2663",clubsuit:"\u2663",Colon:"\u2237",colon:":",Colone:"\u2A74",colone:"\u2254",coloneq:"\u2254",comma:",",commat:"@",comp:"\u2201",compfn:"\u2218",complement:"\u2201",complexes:"\u2102",cong:"\u2245",congdot:"\u2A6D",Congruent:"\u2261",Conint:"\u222F",conint:"\u222E",ContourIntegral:"\u222E",Copf:"\u2102",copf:"\u{1D554}",coprod:"\u2210",Coproduct:"\u2210",COPY:"\xA9",copy:"\xA9",copysr:"\u2117",CounterClockwiseContourIntegral:"\u2233",crarr:"\u21B5",Cross:"\u2A2F",cross:"\u2717",Cscr:"\u{1D49E}",cscr:"\u{1D4B8}",csub:"\u2ACF",csube:"\u2AD1",csup:"\u2AD0",csupe:"\u2AD2",ctdot:"\u22EF",cudarrl:"\u2938",cudarrr:"\u2935",cuepr:"\u22DE",cuesc:"\u22DF",cularr:"\u21B6",cularrp:"\u293D",Cup:"\u22D3",cup:"\u222A",cupbrcap:"\u2A48",CupCap:"\u224D",cupcap:"\u2A46",cupcup:"\u2A4A",cupdot:"\u228D",cupor:"\u2A45",cups:"\u222A\uFE00",curarr:"\u21B7",curarrm:"\u293C",curlyeqprec:"\u22DE",curlyeqsucc:"\u22DF",curlyvee:"\u22CE",curlywedge:"\u22CF",curren:"\xA4",curvearrowleft:"\u21B6",curvearrowright:"\u21B7",cuvee:"\u22CE",cuwed:"\u22CF",cwconint:"\u2232",cwint:"\u2231",cylcty:"\u232D",Dagger:"\u2021",dagger:"\u2020",daleth:"\u2138",Darr:"\u21A1",dArr:"\u21D3",darr:"\u2193",dash:"\u2010",Dashv:"\u2AE4",dashv:"\u22A3",dbkarow:"\u290F",dblac:"\u02DD",Dcaron:"\u010E",dcaron:"\u010F",Dcy:"\u0414",dcy:"\u0434",DD:"\u2145",dd:"\u2146",ddagger:"\u2021",ddarr:"\u21CA",DDotrahd:"\u2911",ddotseq:"\u2A77",deg:"\xB0",Del:"\u2207",Delta:"\u0394",delta:"\u03B4",demptyv:"\u29B1",dfisht:"\u297F",Dfr:"\u{1D507}",dfr:"\u{1D521}",dHar:"\u2965",dharl:"\u21C3",dharr:"\u21C2",DiacriticalAcute:"\xB4",DiacriticalDot:"\u02D9",DiacriticalDoubleAcute:"\u02DD",DiacriticalGrave:"`",DiacriticalTilde:"\u02DC",diam:"\u22C4",Diamond:"\u22C4",diamond:"\u22C4",diamondsuit:"\u2666",diams:"\u2666",die:"\xA8",DifferentialD:"\u2146",digamma:"\u03DD",disin:"\u22F2",div:"\xF7",divide:"\xF7",divideontimes:"\u22C7",divonx:"\u22C7",DJcy:"\u0402",djcy:"\u0452",dlcorn:"\u231E",dlcrop:"\u230D",dollar:"$",Dopf:"\u{1D53B}",dopf:"\u{1D555}",Dot:"\xA8",dot:"\u02D9",DotDot:"\u20DC",doteq:"\u2250",doteqdot:"\u2251",DotEqual:"\u2250",dotminus:"\u2238",dotplus:"\u2214",dotsquare:"\u22A1",doublebarwedge:"\u2306",DoubleContourIntegral:"\u222F",DoubleDot:"\xA8",DoubleDownArrow:"\u21D3",DoubleLeftArrow:"\u21D0",DoubleLeftRightArrow:"\u21D4",DoubleLeftTee:"\u2AE4",DoubleLongLeftArrow:"\u27F8",DoubleLongLeftRightArrow:"\u27FA",DoubleLongRightArrow:"\u27F9",DoubleRightArrow:"\u21D2",DoubleRightTee:"\u22A8",DoubleUpArrow:"\u21D1",DoubleUpDownArrow:"\u21D5",DoubleVerticalBar:"\u2225",DownArrow:"\u2193",Downarrow:"\u21D3",downarrow:"\u2193",DownArrowBar:"\u2913",DownArrowUpArrow:"\u21F5",DownBreve:"\u0311",downdownarrows:"\u21CA",downharpoonleft:"\u21C3",downharpoonright:"\u21C2",DownLeftRightVector:"\u2950",DownLeftTeeVector:"\u295E",DownLeftVector:"\u21BD",DownLeftVectorBar:"\u2956",DownRightTeeVector:"\u295F",DownRightVector:"\u21C1",DownRightVectorBar:"\u2957",DownTee:"\u22A4",DownTeeArrow:"\u21A7",drbkarow:"\u2910",drcorn:"\u231F",drcrop:"\u230C",Dscr:"\u{1D49F}",dscr:"\u{1D4B9}",DScy:"\u0405",dscy:"\u0455",dsol:"\u29F6",Dstrok:"\u0110",dstrok:"\u0111",dtdot:"\u22F1",dtri:"\u25BF",dtrif:"\u25BE",duarr:"\u21F5",duhar:"\u296F",dwangle:"\u29A6",DZcy:"\u040F",dzcy:"\u045F",dzigrarr:"\u27FF",Eacute:"\xC9",eacute:"\xE9",easter:"\u2A6E",Ecaron:"\u011A",ecaron:"\u011B",ecir:"\u2256",Ecirc:"\xCA",ecirc:"\xEA",ecolon:"\u2255",Ecy:"\u042D",ecy:"\u044D",eDDot:"\u2A77",Edot:"\u0116",eDot:"\u2251",edot:"\u0117",ee:"\u2147",efDot:"\u2252",Efr:"\u{1D508}",efr:"\u{1D522}",eg:"\u2A9A",Egrave:"\xC8",egrave:"\xE8",egs:"\u2A96",egsdot:"\u2A98",el:"\u2A99",Element:"\u2208",elinters:"\u23E7",ell:"\u2113",els:"\u2A95",elsdot:"\u2A97",Emacr:"\u0112",emacr:"\u0113",empty:"\u2205",emptyset:"\u2205",EmptySmallSquare:"\u25FB",emptyv:"\u2205",EmptyVerySmallSquare:"\u25AB",emsp:"\u2003",emsp13:"\u2004",emsp14:"\u2005",ENG:"\u014A",eng:"\u014B",ensp:"\u2002",Eogon:"\u0118",eogon:"\u0119",Eopf:"\u{1D53C}",eopf:"\u{1D556}",epar:"\u22D5",eparsl:"\u29E3",eplus:"\u2A71",epsi:"\u03B5",Epsilon:"\u0395",epsilon:"\u03B5",epsiv:"\u03F5",eqcirc:"\u2256",eqcolon:"\u2255",eqsim:"\u2242",eqslantgtr:"\u2A96",eqslantless:"\u2A95",Equal:"\u2A75",equals:"=",EqualTilde:"\u2242",equest:"\u225F",Equilibrium:"\u21CC",equiv:"\u2261",equivDD:"\u2A78",eqvparsl:"\u29E5",erarr:"\u2971",erDot:"\u2253",Escr:"\u2130",escr:"\u212F",esdot:"\u2250",Esim:"\u2A73",esim:"\u2242",Eta:"\u0397",eta:"\u03B7",ETH:"\xD0",eth:"\xF0",Euml:"\xCB",euml:"\xEB",euro:"\u20AC",excl:"!",exist:"\u2203",Exists:"\u2203",expectation:"\u2130",ExponentialE:"\u2147",exponentiale:"\u2147",fallingdotseq:"\u2252",Fcy:"\u0424",fcy:"\u0444",female:"\u2640",ffilig:"\uFB03",fflig:"\uFB00",ffllig:"\uFB04",Ffr:"\u{1D509}",ffr:"\u{1D523}",filig:"\uFB01",FilledSmallSquare:"\u25FC",FilledVerySmallSquare:"\u25AA",fjlig:"fj",flat:"\u266D",fllig:"\uFB02",fltns:"\u25B1",fnof:"\u0192",Fopf:"\u{1D53D}",fopf:"\u{1D557}",ForAll:"\u2200",forall:"\u2200",fork:"\u22D4",forkv:"\u2AD9",Fouriertrf:"\u2131",fpartint:"\u2A0D",frac12:"\xBD",frac13:"\u2153",frac14:"\xBC",frac15:"\u2155",frac16:"\u2159",frac18:"\u215B",frac23:"\u2154",frac25:"\u2156",frac34:"\xBE",frac35:"\u2157",frac38:"\u215C",frac45:"\u2158",frac56:"\u215A",frac58:"\u215D",frac78:"\u215E",frasl:"\u2044",frown:"\u2322",Fscr:"\u2131",fscr:"\u{1D4BB}",gacute:"\u01F5",Gamma:"\u0393",gamma:"\u03B3",Gammad:"\u03DC",gammad:"\u03DD",gap:"\u2A86",Gbreve:"\u011E",gbreve:"\u011F",Gcedil:"\u0122",Gcirc:"\u011C",gcirc:"\u011D",Gcy:"\u0413",gcy:"\u0433",Gdot:"\u0120",gdot:"\u0121",gE:"\u2267",ge:"\u2265",gEl:"\u2A8C",gel:"\u22DB",geq:"\u2265",geqq:"\u2267",geqslant:"\u2A7E",ges:"\u2A7E",gescc:"\u2AA9",gesdot:"\u2A80",gesdoto:"\u2A82",gesdotol:"\u2A84",gesl:"\u22DB\uFE00",gesles:"\u2A94",Gfr:"\u{1D50A}",gfr:"\u{1D524}",Gg:"\u22D9",gg:"\u226B",ggg:"\u22D9",gimel:"\u2137",GJcy:"\u0403",gjcy:"\u0453",gl:"\u2277",gla:"\u2AA5",glE:"\u2A92",glj:"\u2AA4",gnap:"\u2A8A",gnapprox:"\u2A8A",gnE:"\u2269",gne:"\u2A88",gneq:"\u2A88",gneqq:"\u2269",gnsim:"\u22E7",Gopf:"\u{1D53E}",gopf:"\u{1D558}",grave:"`",GreaterEqual:"\u2265",GreaterEqualLess:"\u22DB",GreaterFullEqual:"\u2267",GreaterGreater:"\u2AA2",GreaterLess:"\u2277",GreaterSlantEqual:"\u2A7E",GreaterTilde:"\u2273",Gscr:"\u{1D4A2}",gscr:"\u210A",gsim:"\u2273",gsime:"\u2A8E",gsiml:"\u2A90",Gt:"\u226B",GT:">",gt:">",gtcc:"\u2AA7",gtcir:"\u2A7A",gtdot:"\u22D7",gtlPar:"\u2995",gtquest:"\u2A7C",gtrapprox:"\u2A86",gtrarr:"\u2978",gtrdot:"\u22D7",gtreqless:"\u22DB",gtreqqless:"\u2A8C",gtrless:"\u2277",gtrsim:"\u2273",gvertneqq:"\u2269\uFE00",gvnE:"\u2269\uFE00",Hacek:"\u02C7",hairsp:"\u200A",half:"\xBD",hamilt:"\u210B",HARDcy:"\u042A",hardcy:"\u044A",hArr:"\u21D4",harr:"\u2194",harrcir:"\u2948",harrw:"\u21AD",Hat:"^",hbar:"\u210F",Hcirc:"\u0124",hcirc:"\u0125",hearts:"\u2665",heartsuit:"\u2665",hellip:"\u2026",hercon:"\u22B9",Hfr:"\u210C",hfr:"\u{1D525}",HilbertSpace:"\u210B",hksearow:"\u2925",hkswarow:"\u2926",hoarr:"\u21FF",homtht:"\u223B",hookleftarrow:"\u21A9",hookrightarrow:"\u21AA",Hopf:"\u210D",hopf:"\u{1D559}",horbar:"\u2015",HorizontalLine:"\u2500",Hscr:"\u210B",hscr:"\u{1D4BD}",hslash:"\u210F",Hstrok:"\u0126",hstrok:"\u0127",HumpDownHump:"\u224E",HumpEqual:"\u224F",hybull:"\u2043",hyphen:"\u2010",Iacute:"\xCD",iacute:"\xED",ic:"\u2063",Icirc:"\xCE",icirc:"\xEE",Icy:"\u0418",icy:"\u0438",Idot:"\u0130",IEcy:"\u0415",iecy:"\u0435",iexcl:"\xA1",iff:"\u21D4",Ifr:"\u2111",ifr:"\u{1D526}",Igrave:"\xCC",igrave:"\xEC",ii:"\u2148",iiiint:"\u2A0C",iiint:"\u222D",iinfin:"\u29DC",iiota:"\u2129",IJlig:"\u0132",ijlig:"\u0133",Im:"\u2111",Imacr:"\u012A",imacr:"\u012B",image:"\u2111",ImaginaryI:"\u2148",imagline:"\u2110",imagpart:"\u2111",imath:"\u0131",imof:"\u22B7",imped:"\u01B5",Implies:"\u21D2",in:"\u2208",incare:"\u2105",infin:"\u221E",infintie:"\u29DD",inodot:"\u0131",Int:"\u222C",int:"\u222B",intcal:"\u22BA",integers:"\u2124",Integral:"\u222B",intercal:"\u22BA",Intersection:"\u22C2",intlarhk:"\u2A17",intprod:"\u2A3C",InvisibleComma:"\u2063",InvisibleTimes:"\u2062",IOcy:"\u0401",iocy:"\u0451",Iogon:"\u012E",iogon:"\u012F",Iopf:"\u{1D540}",iopf:"\u{1D55A}",Iota:"\u0399",iota:"\u03B9",iprod:"\u2A3C",iquest:"\xBF",Iscr:"\u2110",iscr:"\u{1D4BE}",isin:"\u2208",isindot:"\u22F5",isinE:"\u22F9",isins:"\u22F4",isinsv:"\u22F3",isinv:"\u2208",it:"\u2062",Itilde:"\u0128",itilde:"\u0129",Iukcy:"\u0406",iukcy:"\u0456",Iuml:"\xCF",iuml:"\xEF",Jcirc:"\u0134",jcirc:"\u0135",Jcy:"\u0419",jcy:"\u0439",Jfr:"\u{1D50D}",jfr:"\u{1D527}",jmath:"\u0237",Jopf:"\u{1D541}",jopf:"\u{1D55B}",Jscr:"\u{1D4A5}",jscr:"\u{1D4BF}",Jsercy:"\u0408",jsercy:"\u0458",Jukcy:"\u0404",jukcy:"\u0454",Kappa:"\u039A",kappa:"\u03BA",kappav:"\u03F0",Kcedil:"\u0136",kcedil:"\u0137",Kcy:"\u041A",kcy:"\u043A",Kfr:"\u{1D50E}",kfr:"\u{1D528}",kgreen:"\u0138",KHcy:"\u0425",khcy:"\u0445",KJcy:"\u040C",kjcy:"\u045C",Kopf:"\u{1D542}",kopf:"\u{1D55C}",Kscr:"\u{1D4A6}",kscr:"\u{1D4C0}",lAarr:"\u21DA",Lacute:"\u0139",lacute:"\u013A",laemptyv:"\u29B4",lagran:"\u2112",Lambda:"\u039B",lambda:"\u03BB",Lang:"\u27EA",lang:"\u27E8",langd:"\u2991",langle:"\u27E8",lap:"\u2A85",Laplacetrf:"\u2112",laquo:"\xAB",Larr:"\u219E",lArr:"\u21D0",larr:"\u2190",larrb:"\u21E4",larrbfs:"\u291F",larrfs:"\u291D",larrhk:"\u21A9",larrlp:"\u21AB",larrpl:"\u2939",larrsim:"\u2973",larrtl:"\u21A2",lat:"\u2AAB",lAtail:"\u291B",latail:"\u2919",late:"\u2AAD",lates:"\u2AAD\uFE00",lBarr:"\u290E",lbarr:"\u290C",lbbrk:"\u2772",lbrace:"{",lbrack:"[",lbrke:"\u298B",lbrksld:"\u298F",lbrkslu:"\u298D",Lcaron:"\u013D",lcaron:"\u013E",Lcedil:"\u013B",lcedil:"\u013C",lceil:"\u2308",lcub:"{",Lcy:"\u041B",lcy:"\u043B",ldca:"\u2936",ldquo:"\u201C",ldquor:"\u201E",ldrdhar:"\u2967",ldrushar:"\u294B",ldsh:"\u21B2",lE:"\u2266",le:"\u2264",LeftAngleBracket:"\u27E8",LeftArrow:"\u2190",Leftarrow:"\u21D0",leftarrow:"\u2190",LeftArrowBar:"\u21E4",LeftArrowRightArrow:"\u21C6",leftarrowtail:"\u21A2",LeftCeiling:"\u2308",LeftDoubleBracket:"\u27E6",LeftDownTeeVector:"\u2961",LeftDownVector:"\u21C3",LeftDownVectorBar:"\u2959",LeftFloor:"\u230A",leftharpoondown:"\u21BD",leftharpoonup:"\u21BC",leftleftarrows:"\u21C7",LeftRightArrow:"\u2194",Leftrightarrow:"\u21D4",leftrightarrow:"\u2194",leftrightarrows:"\u21C6",leftrightharpoons:"\u21CB",leftrightsquigarrow:"\u21AD",LeftRightVector:"\u294E",LeftTee:"\u22A3",LeftTeeArrow:"\u21A4",LeftTeeVector:"\u295A",leftthreetimes:"\u22CB",LeftTriangle:"\u22B2",LeftTriangleBar:"\u29CF",LeftTriangleEqual:"\u22B4",LeftUpDownVector:"\u2951",LeftUpTeeVector:"\u2960",LeftUpVector:"\u21BF",LeftUpVectorBar:"\u2958",LeftVector:"\u21BC",LeftVectorBar:"\u2952",lEg:"\u2A8B",leg:"\u22DA",leq:"\u2264",leqq:"\u2266",leqslant:"\u2A7D",les:"\u2A7D",lescc:"\u2AA8",lesdot:"\u2A7F",lesdoto:"\u2A81",lesdotor:"\u2A83",lesg:"\u22DA\uFE00",lesges:"\u2A93",lessapprox:"\u2A85",lessdot:"\u22D6",lesseqgtr:"\u22DA",lesseqqgtr:"\u2A8B",LessEqualGreater:"\u22DA",LessFullEqual:"\u2266",LessGreater:"\u2276",lessgtr:"\u2276",LessLess:"\u2AA1",lesssim:"\u2272",LessSlantEqual:"\u2A7D",LessTilde:"\u2272",lfisht:"\u297C",lfloor:"\u230A",Lfr:"\u{1D50F}",lfr:"\u{1D529}",lg:"\u2276",lgE:"\u2A91",lHar:"\u2962",lhard:"\u21BD",lharu:"\u21BC",lharul:"\u296A",lhblk:"\u2584",LJcy:"\u0409",ljcy:"\u0459",Ll:"\u22D8",ll:"\u226A",llarr:"\u21C7",llcorner:"\u231E",Lleftarrow:"\u21DA",llhard:"\u296B",lltri:"\u25FA",Lmidot:"\u013F",lmidot:"\u0140",lmoust:"\u23B0",lmoustache:"\u23B0",lnap:"\u2A89",lnapprox:"\u2A89",lnE:"\u2268",lne:"\u2A87",lneq:"\u2A87",lneqq:"\u2268",lnsim:"\u22E6",loang:"\u27EC",loarr:"\u21FD",lobrk:"\u27E6",LongLeftArrow:"\u27F5",Longleftarrow:"\u27F8",longleftarrow:"\u27F5",LongLeftRightArrow:"\u27F7",Longleftrightarrow:"\u27FA",longleftrightarrow:"\u27F7",longmapsto:"\u27FC",LongRightArrow:"\u27F6",Longrightarrow:"\u27F9",longrightarrow:"\u27F6",looparrowleft:"\u21AB",looparrowright:"\u21AC",lopar:"\u2985",Lopf:"\u{1D543}",lopf:"\u{1D55D}",loplus:"\u2A2D",lotimes:"\u2A34",lowast:"\u2217",lowbar:"_",LowerLeftArrow:"\u2199",LowerRightArrow:"\u2198",loz:"\u25CA",lozenge:"\u25CA",lozf:"\u29EB",lpar:"(",lparlt:"\u2993",lrarr:"\u21C6",lrcorner:"\u231F",lrhar:"\u21CB",lrhard:"\u296D",lrm:"\u200E",lrtri:"\u22BF",lsaquo:"\u2039",Lscr:"\u2112",lscr:"\u{1D4C1}",Lsh:"\u21B0",lsh:"\u21B0",lsim:"\u2272",lsime:"\u2A8D",lsimg:"\u2A8F",lsqb:"[",lsquo:"\u2018",lsquor:"\u201A",Lstrok:"\u0141",lstrok:"\u0142",Lt:"\u226A",LT:"<",lt:"<",ltcc:"\u2AA6",ltcir:"\u2A79",ltdot:"\u22D6",lthree:"\u22CB",ltimes:"\u22C9",ltlarr:"\u2976",ltquest:"\u2A7B",ltri:"\u25C3",ltrie:"\u22B4",ltrif:"\u25C2",ltrPar:"\u2996",lurdshar:"\u294A",luruhar:"\u2966",lvertneqq:"\u2268\uFE00",lvnE:"\u2268\uFE00",macr:"\xAF",male:"\u2642",malt:"\u2720",maltese:"\u2720",Map:"\u2905",map:"\u21A6",mapsto:"\u21A6",mapstodown:"\u21A7",mapstoleft:"\u21A4",mapstoup:"\u21A5",marker:"\u25AE",mcomma:"\u2A29",Mcy:"\u041C",mcy:"\u043C",mdash:"\u2014",mDDot:"\u223A",measuredangle:"\u2221",MediumSpace:"\u205F",Mellintrf:"\u2133",Mfr:"\u{1D510}",mfr:"\u{1D52A}",mho:"\u2127",micro:"\xB5",mid:"\u2223",midast:"*",midcir:"\u2AF0",middot:"\xB7",minus:"\u2212",minusb:"\u229F",minusd:"\u2238",minusdu:"\u2A2A",MinusPlus:"\u2213",mlcp:"\u2ADB",mldr:"\u2026",mnplus:"\u2213",models:"\u22A7",Mopf:"\u{1D544}",mopf:"\u{1D55E}",mp:"\u2213",Mscr:"\u2133",mscr:"\u{1D4C2}",mstpos:"\u223E",Mu:"\u039C",mu:"\u03BC",multimap:"\u22B8",mumap:"\u22B8",nabla:"\u2207",Nacute:"\u0143",nacute:"\u0144",nang:"\u2220\u20D2",nap:"\u2249",napE:"\u2A70\u0338",napid:"\u224B\u0338",napos:"\u0149",napprox:"\u2249",natur:"\u266E",natural:"\u266E",naturals:"\u2115",nbsp:"\xA0",nbump:"\u224E\u0338",nbumpe:"\u224F\u0338",ncap:"\u2A43",Ncaron:"\u0147",ncaron:"\u0148",Ncedil:"\u0145",ncedil:"\u0146",ncong:"\u2247",ncongdot:"\u2A6D\u0338",ncup:"\u2A42",Ncy:"\u041D",ncy:"\u043D",ndash:"\u2013",ne:"\u2260",nearhk:"\u2924",neArr:"\u21D7",nearr:"\u2197",nearrow:"\u2197",nedot:"\u2250\u0338",NegativeMediumSpace:"\u200B",NegativeThickSpace:"\u200B",NegativeThinSpace:"\u200B",NegativeVeryThinSpace:"\u200B",nequiv:"\u2262",nesear:"\u2928",nesim:"\u2242\u0338",NestedGreaterGreater:"\u226B",NestedLessLess:"\u226A",NewLine:`
`,nexist:"\u2204",nexists:"\u2204",Nfr:"\u{1D511}",nfr:"\u{1D52B}",ngE:"\u2267\u0338",nge:"\u2271",ngeq:"\u2271",ngeqq:"\u2267\u0338",ngeqslant:"\u2A7E\u0338",nges:"\u2A7E\u0338",nGg:"\u22D9\u0338",ngsim:"\u2275",nGt:"\u226B\u20D2",ngt:"\u226F",ngtr:"\u226F",nGtv:"\u226B\u0338",nhArr:"\u21CE",nharr:"\u21AE",nhpar:"\u2AF2",ni:"\u220B",nis:"\u22FC",nisd:"\u22FA",niv:"\u220B",NJcy:"\u040A",njcy:"\u045A",nlArr:"\u21CD",nlarr:"\u219A",nldr:"\u2025",nlE:"\u2266\u0338",nle:"\u2270",nLeftarrow:"\u21CD",nleftarrow:"\u219A",nLeftrightarrow:"\u21CE",nleftrightarrow:"\u21AE",nleq:"\u2270",nleqq:"\u2266\u0338",nleqslant:"\u2A7D\u0338",nles:"\u2A7D\u0338",nless:"\u226E",nLl:"\u22D8\u0338",nlsim:"\u2274",nLt:"\u226A\u20D2",nlt:"\u226E",nltri:"\u22EA",nltrie:"\u22EC",nLtv:"\u226A\u0338",nmid:"\u2224",NoBreak:"\u2060",NonBreakingSpace:"\xA0",Nopf:"\u2115",nopf:"\u{1D55F}",Not:"\u2AEC",not:"\xAC",NotCongruent:"\u2262",NotCupCap:"\u226D",NotDoubleVerticalBar:"\u2226",NotElement:"\u2209",NotEqual:"\u2260",NotEqualTilde:"\u2242\u0338",NotExists:"\u2204",NotGreater:"\u226F",NotGreaterEqual:"\u2271",NotGreaterFullEqual:"\u2267\u0338",NotGreaterGreater:"\u226B\u0338",NotGreaterLess:"\u2279",NotGreaterSlantEqual:"\u2A7E\u0338",NotGreaterTilde:"\u2275",NotHumpDownHump:"\u224E\u0338",NotHumpEqual:"\u224F\u0338",notin:"\u2209",notindot:"\u22F5\u0338",notinE:"\u22F9\u0338",notinva:"\u2209",notinvb:"\u22F7",notinvc:"\u22F6",NotLeftTriangle:"\u22EA",NotLeftTriangleBar:"\u29CF\u0338",NotLeftTriangleEqual:"\u22EC",NotLess:"\u226E",NotLessEqual:"\u2270",NotLessGreater:"\u2278",NotLessLess:"\u226A\u0338",NotLessSlantEqual:"\u2A7D\u0338",NotLessTilde:"\u2274",NotNestedGreaterGreater:"\u2AA2\u0338",NotNestedLessLess:"\u2AA1\u0338",notni:"\u220C",notniva:"\u220C",notnivb:"\u22FE",notnivc:"\u22FD",NotPrecedes:"\u2280",NotPrecedesEqual:"\u2AAF\u0338",NotPrecedesSlantEqual:"\u22E0",NotReverseElement:"\u220C",NotRightTriangle:"\u22EB",NotRightTriangleBar:"\u29D0\u0338",NotRightTriangleEqual:"\u22ED",NotSquareSubset:"\u228F\u0338",NotSquareSubsetEqual:"\u22E2",NotSquareSuperset:"\u2290\u0338",NotSquareSupersetEqual:"\u22E3",NotSubset:"\u2282\u20D2",NotSubsetEqual:"\u2288",NotSucceeds:"\u2281",NotSucceedsEqual:"\u2AB0\u0338",NotSucceedsSlantEqual:"\u22E1",NotSucceedsTilde:"\u227F\u0338",NotSuperset:"\u2283\u20D2",NotSupersetEqual:"\u2289",NotTilde:"\u2241",NotTildeEqual:"\u2244",NotTildeFullEqual:"\u2247",NotTildeTilde:"\u2249",NotVerticalBar:"\u2224",npar:"\u2226",nparallel:"\u2226",nparsl:"\u2AFD\u20E5",npart:"\u2202\u0338",npolint:"\u2A14",npr:"\u2280",nprcue:"\u22E0",npre:"\u2AAF\u0338",nprec:"\u2280",npreceq:"\u2AAF\u0338",nrArr:"\u21CF",nrarr:"\u219B",nrarrc:"\u2933\u0338",nrarrw:"\u219D\u0338",nRightarrow:"\u21CF",nrightarrow:"\u219B",nrtri:"\u22EB",nrtrie:"\u22ED",nsc:"\u2281",nsccue:"\u22E1",nsce:"\u2AB0\u0338",Nscr:"\u{1D4A9}",nscr:"\u{1D4C3}",nshortmid:"\u2224",nshortparallel:"\u2226",nsim:"\u2241",nsime:"\u2244",nsimeq:"\u2244",nsmid:"\u2224",nspar:"\u2226",nsqsube:"\u22E2",nsqsupe:"\u22E3",nsub:"\u2284",nsubE:"\u2AC5\u0338",nsube:"\u2288",nsubset:"\u2282\u20D2",nsubseteq:"\u2288",nsubseteqq:"\u2AC5\u0338",nsucc:"\u2281",nsucceq:"\u2AB0\u0338",nsup:"\u2285",nsupE:"\u2AC6\u0338",nsupe:"\u2289",nsupset:"\u2283\u20D2",nsupseteq:"\u2289",nsupseteqq:"\u2AC6\u0338",ntgl:"\u2279",Ntilde:"\xD1",ntilde:"\xF1",ntlg:"\u2278",ntriangleleft:"\u22EA",ntrianglelefteq:"\u22EC",ntriangleright:"\u22EB",ntrianglerighteq:"\u22ED",Nu:"\u039D",nu:"\u03BD",num:"#",numero:"\u2116",numsp:"\u2007",nvap:"\u224D\u20D2",nVDash:"\u22AF",nVdash:"\u22AE",nvDash:"\u22AD",nvdash:"\u22AC",nvge:"\u2265\u20D2",nvgt:">\u20D2",nvHarr:"\u2904",nvinfin:"\u29DE",nvlArr:"\u2902",nvle:"\u2264\u20D2",nvlt:"<\u20D2",nvltrie:"\u22B4\u20D2",nvrArr:"\u2903",nvrtrie:"\u22B5\u20D2",nvsim:"\u223C\u20D2",nwarhk:"\u2923",nwArr:"\u21D6",nwarr:"\u2196",nwarrow:"\u2196",nwnear:"\u2927",Oacute:"\xD3",oacute:"\xF3",oast:"\u229B",ocir:"\u229A",Ocirc:"\xD4",ocirc:"\xF4",Ocy:"\u041E",ocy:"\u043E",odash:"\u229D",Odblac:"\u0150",odblac:"\u0151",odiv:"\u2A38",odot:"\u2299",odsold:"\u29BC",OElig:"\u0152",oelig:"\u0153",ofcir:"\u29BF",Ofr:"\u{1D512}",ofr:"\u{1D52C}",ogon:"\u02DB",Ograve:"\xD2",ograve:"\xF2",ogt:"\u29C1",ohbar:"\u29B5",ohm:"\u03A9",oint:"\u222E",olarr:"\u21BA",olcir:"\u29BE",olcross:"\u29BB",oline:"\u203E",olt:"\u29C0",Omacr:"\u014C",omacr:"\u014D",Omega:"\u03A9",omega:"\u03C9",Omicron:"\u039F",omicron:"\u03BF",omid:"\u29B6",ominus:"\u2296",Oopf:"\u{1D546}",oopf:"\u{1D560}",opar:"\u29B7",OpenCurlyDoubleQuote:"\u201C",OpenCurlyQuote:"\u2018",operp:"\u29B9",oplus:"\u2295",Or:"\u2A54",or:"\u2228",orarr:"\u21BB",ord:"\u2A5D",order:"\u2134",orderof:"\u2134",ordf:"\xAA",ordm:"\xBA",origof:"\u22B6",oror:"\u2A56",orslope:"\u2A57",orv:"\u2A5B",oS:"\u24C8",Oscr:"\u{1D4AA}",oscr:"\u2134",Oslash:"\xD8",oslash:"\xF8",osol:"\u2298",Otilde:"\xD5",otilde:"\xF5",Otimes:"\u2A37",otimes:"\u2297",otimesas:"\u2A36",Ouml:"\xD6",ouml:"\xF6",ovbar:"\u233D",OverBar:"\u203E",OverBrace:"\u23DE",OverBracket:"\u23B4",OverParenthesis:"\u23DC",par:"\u2225",para:"\xB6",parallel:"\u2225",parsim:"\u2AF3",parsl:"\u2AFD",part:"\u2202",PartialD:"\u2202",Pcy:"\u041F",pcy:"\u043F",percnt:"%",period:".",permil:"\u2030",perp:"\u22A5",pertenk:"\u2031",Pfr:"\u{1D513}",pfr:"\u{1D52D}",Phi:"\u03A6",phi:"\u03C6",phiv:"\u03D5",phmmat:"\u2133",phone:"\u260E",Pi:"\u03A0",pi:"\u03C0",pitchfork:"\u22D4",piv:"\u03D6",planck:"\u210F",planckh:"\u210E",plankv:"\u210F",plus:"+",plusacir:"\u2A23",plusb:"\u229E",pluscir:"\u2A22",plusdo:"\u2214",plusdu:"\u2A25",pluse:"\u2A72",PlusMinus:"\xB1",plusmn:"\xB1",plussim:"\u2A26",plustwo:"\u2A27",pm:"\xB1",Poincareplane:"\u210C",pointint:"\u2A15",Popf:"\u2119",popf:"\u{1D561}",pound:"\xA3",Pr:"\u2ABB",pr:"\u227A",prap:"\u2AB7",prcue:"\u227C",prE:"\u2AB3",pre:"\u2AAF",prec:"\u227A",precapprox:"\u2AB7",preccurlyeq:"\u227C",Precedes:"\u227A",PrecedesEqual:"\u2AAF",PrecedesSlantEqual:"\u227C",PrecedesTilde:"\u227E",preceq:"\u2AAF",precnapprox:"\u2AB9",precneqq:"\u2AB5",precnsim:"\u22E8",precsim:"\u227E",Prime:"\u2033",prime:"\u2032",primes:"\u2119",prnap:"\u2AB9",prnE:"\u2AB5",prnsim:"\u22E8",prod:"\u220F",Product:"\u220F",profalar:"\u232E",profline:"\u2312",profsurf:"\u2313",prop:"\u221D",Proportion:"\u2237",Proportional:"\u221D",propto:"\u221D",prsim:"\u227E",prurel:"\u22B0",Pscr:"\u{1D4AB}",pscr:"\u{1D4C5}",Psi:"\u03A8",psi:"\u03C8",puncsp:"\u2008",Qfr:"\u{1D514}",qfr:"\u{1D52E}",qint:"\u2A0C",Qopf:"\u211A",qopf:"\u{1D562}",qprime:"\u2057",Qscr:"\u{1D4AC}",qscr:"\u{1D4C6}",quaternions:"\u210D",quatint:"\u2A16",quest:"?",questeq:"\u225F",QUOT:'"',quot:'"',rAarr:"\u21DB",race:"\u223D\u0331",Racute:"\u0154",racute:"\u0155",radic:"\u221A",raemptyv:"\u29B3",Rang:"\u27EB",rang:"\u27E9",rangd:"\u2992",range:"\u29A5",rangle:"\u27E9",raquo:"\xBB",Rarr:"\u21A0",rArr:"\u21D2",rarr:"\u2192",rarrap:"\u2975",rarrb:"\u21E5",rarrbfs:"\u2920",rarrc:"\u2933",rarrfs:"\u291E",rarrhk:"\u21AA",rarrlp:"\u21AC",rarrpl:"\u2945",rarrsim:"\u2974",Rarrtl:"\u2916",rarrtl:"\u21A3",rarrw:"\u219D",rAtail:"\u291C",ratail:"\u291A",ratio:"\u2236",rationals:"\u211A",RBarr:"\u2910",rBarr:"\u290F",rbarr:"\u290D",rbbrk:"\u2773",rbrace:"}",rbrack:"]",rbrke:"\u298C",rbrksld:"\u298E",rbrkslu:"\u2990",Rcaron:"\u0158",rcaron:"\u0159",Rcedil:"\u0156",rcedil:"\u0157",rceil:"\u2309",rcub:"}",Rcy:"\u0420",rcy:"\u0440",rdca:"\u2937",rdldhar:"\u2969",rdquo:"\u201D",rdquor:"\u201D",rdsh:"\u21B3",Re:"\u211C",real:"\u211C",realine:"\u211B",realpart:"\u211C",reals:"\u211D",rect:"\u25AD",REG:"\xAE",reg:"\xAE",ReverseElement:"\u220B",ReverseEquilibrium:"\u21CB",ReverseUpEquilibrium:"\u296F",rfisht:"\u297D",rfloor:"\u230B",Rfr:"\u211C",rfr:"\u{1D52F}",rHar:"\u2964",rhard:"\u21C1",rharu:"\u21C0",rharul:"\u296C",Rho:"\u03A1",rho:"\u03C1",rhov:"\u03F1",RightAngleBracket:"\u27E9",RightArrow:"\u2192",Rightarrow:"\u21D2",rightarrow:"\u2192",RightArrowBar:"\u21E5",RightArrowLeftArrow:"\u21C4",rightarrowtail:"\u21A3",RightCeiling:"\u2309",RightDoubleBracket:"\u27E7",RightDownTeeVector:"\u295D",RightDownVector:"\u21C2",RightDownVectorBar:"\u2955",RightFloor:"\u230B",rightharpoondown:"\u21C1",rightharpoonup:"\u21C0",rightleftarrows:"\u21C4",rightleftharpoons:"\u21CC",rightrightarrows:"\u21C9",rightsquigarrow:"\u219D",RightTee:"\u22A2",RightTeeArrow:"\u21A6",RightTeeVector:"\u295B",rightthreetimes:"\u22CC",RightTriangle:"\u22B3",RightTriangleBar:"\u29D0",RightTriangleEqual:"\u22B5",RightUpDownVector:"\u294F",RightUpTeeVector:"\u295C",RightUpVector:"\u21BE",RightUpVectorBar:"\u2954",RightVector:"\u21C0",RightVectorBar:"\u2953",ring:"\u02DA",risingdotseq:"\u2253",rlarr:"\u21C4",rlhar:"\u21CC",rlm:"\u200F",rmoust:"\u23B1",rmoustache:"\u23B1",rnmid:"\u2AEE",roang:"\u27ED",roarr:"\u21FE",robrk:"\u27E7",ropar:"\u2986",Ropf:"\u211D",ropf:"\u{1D563}",roplus:"\u2A2E",rotimes:"\u2A35",RoundImplies:"\u2970",rpar:")",rpargt:"\u2994",rppolint:"\u2A12",rrarr:"\u21C9",Rrightarrow:"\u21DB",rsaquo:"\u203A",Rscr:"\u211B",rscr:"\u{1D4C7}",Rsh:"\u21B1",rsh:"\u21B1",rsqb:"]",rsquo:"\u2019",rsquor:"\u2019",rthree:"\u22CC",rtimes:"\u22CA",rtri:"\u25B9",rtrie:"\u22B5",rtrif:"\u25B8",rtriltri:"\u29CE",RuleDelayed:"\u29F4",ruluhar:"\u2968",rx:"\u211E",Sacute:"\u015A",sacute:"\u015B",sbquo:"\u201A",Sc:"\u2ABC",sc:"\u227B",scap:"\u2AB8",Scaron:"\u0160",scaron:"\u0161",sccue:"\u227D",scE:"\u2AB4",sce:"\u2AB0",Scedil:"\u015E",scedil:"\u015F",Scirc:"\u015C",scirc:"\u015D",scnap:"\u2ABA",scnE:"\u2AB6",scnsim:"\u22E9",scpolint:"\u2A13",scsim:"\u227F",Scy:"\u0421",scy:"\u0441",sdot:"\u22C5",sdotb:"\u22A1",sdote:"\u2A66",searhk:"\u2925",seArr:"\u21D8",searr:"\u2198",searrow:"\u2198",sect:"\xA7",semi:";",seswar:"\u2929",setminus:"\u2216",setmn:"\u2216",sext:"\u2736",Sfr:"\u{1D516}",sfr:"\u{1D530}",sfrown:"\u2322",sharp:"\u266F",SHCHcy:"\u0429",shchcy:"\u0449",SHcy:"\u0428",shcy:"\u0448",ShortDownArrow:"\u2193",ShortLeftArrow:"\u2190",shortmid:"\u2223",shortparallel:"\u2225",ShortRightArrow:"\u2192",ShortUpArrow:"\u2191",shy:"\xAD",Sigma:"\u03A3",sigma:"\u03C3",sigmaf:"\u03C2",sigmav:"\u03C2",sim:"\u223C",simdot:"\u2A6A",sime:"\u2243",simeq:"\u2243",simg:"\u2A9E",simgE:"\u2AA0",siml:"\u2A9D",simlE:"\u2A9F",simne:"\u2246",simplus:"\u2A24",simrarr:"\u2972",slarr:"\u2190",SmallCircle:"\u2218",smallsetminus:"\u2216",smashp:"\u2A33",smeparsl:"\u29E4",smid:"\u2223",smile:"\u2323",smt:"\u2AAA",smte:"\u2AAC",smtes:"\u2AAC\uFE00",SOFTcy:"\u042C",softcy:"\u044C",sol:"/",solb:"\u29C4",solbar:"\u233F",Sopf:"\u{1D54A}",sopf:"\u{1D564}",spades:"\u2660",spadesuit:"\u2660",spar:"\u2225",sqcap:"\u2293",sqcaps:"\u2293\uFE00",sqcup:"\u2294",sqcups:"\u2294\uFE00",Sqrt:"\u221A",sqsub:"\u228F",sqsube:"\u2291",sqsubset:"\u228F",sqsubseteq:"\u2291",sqsup:"\u2290",sqsupe:"\u2292",sqsupset:"\u2290",sqsupseteq:"\u2292",squ:"\u25A1",Square:"\u25A1",square:"\u25A1",SquareIntersection:"\u2293",SquareSubset:"\u228F",SquareSubsetEqual:"\u2291",SquareSuperset:"\u2290",SquareSupersetEqual:"\u2292",SquareUnion:"\u2294",squarf:"\u25AA",squf:"\u25AA",srarr:"\u2192",Sscr:"\u{1D4AE}",sscr:"\u{1D4C8}",ssetmn:"\u2216",ssmile:"\u2323",sstarf:"\u22C6",Star:"\u22C6",star:"\u2606",starf:"\u2605",straightepsilon:"\u03F5",straightphi:"\u03D5",strns:"\xAF",Sub:"\u22D0",sub:"\u2282",subdot:"\u2ABD",subE:"\u2AC5",sube:"\u2286",subedot:"\u2AC3",submult:"\u2AC1",subnE:"\u2ACB",subne:"\u228A",subplus:"\u2ABF",subrarr:"\u2979",Subset:"\u22D0",subset:"\u2282",subseteq:"\u2286",subseteqq:"\u2AC5",SubsetEqual:"\u2286",subsetneq:"\u228A",subsetneqq:"\u2ACB",subsim:"\u2AC7",subsub:"\u2AD5",subsup:"\u2AD3",succ:"\u227B",succapprox:"\u2AB8",succcurlyeq:"\u227D",Succeeds:"\u227B",SucceedsEqual:"\u2AB0",SucceedsSlantEqual:"\u227D",SucceedsTilde:"\u227F",succeq:"\u2AB0",succnapprox:"\u2ABA",succneqq:"\u2AB6",succnsim:"\u22E9",succsim:"\u227F",SuchThat:"\u220B",Sum:"\u2211",sum:"\u2211",sung:"\u266A",Sup:"\u22D1",sup:"\u2283",sup1:"\xB9",sup2:"\xB2",sup3:"\xB3",supdot:"\u2ABE",supdsub:"\u2AD8",supE:"\u2AC6",supe:"\u2287",supedot:"\u2AC4",Superset:"\u2283",SupersetEqual:"\u2287",suphsol:"\u27C9",suphsub:"\u2AD7",suplarr:"\u297B",supmult:"\u2AC2",supnE:"\u2ACC",supne:"\u228B",supplus:"\u2AC0",Supset:"\u22D1",supset:"\u2283",supseteq:"\u2287",supseteqq:"\u2AC6",supsetneq:"\u228B",supsetneqq:"\u2ACC",supsim:"\u2AC8",supsub:"\u2AD4",supsup:"\u2AD6",swarhk:"\u2926",swArr:"\u21D9",swarr:"\u2199",swarrow:"\u2199",swnwar:"\u292A",szlig:"\xDF",Tab:"	",target:"\u2316",Tau:"\u03A4",tau:"\u03C4",tbrk:"\u23B4",Tcaron:"\u0164",tcaron:"\u0165",Tcedil:"\u0162",tcedil:"\u0163",Tcy:"\u0422",tcy:"\u0442",tdot:"\u20DB",telrec:"\u2315",Tfr:"\u{1D517}",tfr:"\u{1D531}",there4:"\u2234",Therefore:"\u2234",therefore:"\u2234",Theta:"\u0398",theta:"\u03B8",thetasym:"\u03D1",thetav:"\u03D1",thickapprox:"\u2248",thicksim:"\u223C",ThickSpace:"\u205F\u200A",thinsp:"\u2009",ThinSpace:"\u2009",thkap:"\u2248",thksim:"\u223C",THORN:"\xDE",thorn:"\xFE",Tilde:"\u223C",tilde:"\u02DC",TildeEqual:"\u2243",TildeFullEqual:"\u2245",TildeTilde:"\u2248",times:"\xD7",timesb:"\u22A0",timesbar:"\u2A31",timesd:"\u2A30",tint:"\u222D",toea:"\u2928",top:"\u22A4",topbot:"\u2336",topcir:"\u2AF1",Topf:"\u{1D54B}",topf:"\u{1D565}",topfork:"\u2ADA",tosa:"\u2929",tprime:"\u2034",TRADE:"\u2122",trade:"\u2122",triangle:"\u25B5",triangledown:"\u25BF",triangleleft:"\u25C3",trianglelefteq:"\u22B4",triangleq:"\u225C",triangleright:"\u25B9",trianglerighteq:"\u22B5",tridot:"\u25EC",trie:"\u225C",triminus:"\u2A3A",TripleDot:"\u20DB",triplus:"\u2A39",trisb:"\u29CD",tritime:"\u2A3B",trpezium:"\u23E2",Tscr:"\u{1D4AF}",tscr:"\u{1D4C9}",TScy:"\u0426",tscy:"\u0446",TSHcy:"\u040B",tshcy:"\u045B",Tstrok:"\u0166",tstrok:"\u0167",twixt:"\u226C",twoheadleftarrow:"\u219E",twoheadrightarrow:"\u21A0",Uacute:"\xDA",uacute:"\xFA",Uarr:"\u219F",uArr:"\u21D1",uarr:"\u2191",Uarrocir:"\u2949",Ubrcy:"\u040E",ubrcy:"\u045E",Ubreve:"\u016C",ubreve:"\u016D",Ucirc:"\xDB",ucirc:"\xFB",Ucy:"\u0423",ucy:"\u0443",udarr:"\u21C5",Udblac:"\u0170",udblac:"\u0171",udhar:"\u296E",ufisht:"\u297E",Ufr:"\u{1D518}",ufr:"\u{1D532}",Ugrave:"\xD9",ugrave:"\xF9",uHar:"\u2963",uharl:"\u21BF",uharr:"\u21BE",uhblk:"\u2580",ulcorn:"\u231C",ulcorner:"\u231C",ulcrop:"\u230F",ultri:"\u25F8",Umacr:"\u016A",umacr:"\u016B",uml:"\xA8",UnderBar:"_",UnderBrace:"\u23DF",UnderBracket:"\u23B5",UnderParenthesis:"\u23DD",Union:"\u22C3",UnionPlus:"\u228E",Uogon:"\u0172",uogon:"\u0173",Uopf:"\u{1D54C}",uopf:"\u{1D566}",UpArrow:"\u2191",Uparrow:"\u21D1",uparrow:"\u2191",UpArrowBar:"\u2912",UpArrowDownArrow:"\u21C5",UpDownArrow:"\u2195",Updownarrow:"\u21D5",updownarrow:"\u2195",UpEquilibrium:"\u296E",upharpoonleft:"\u21BF",upharpoonright:"\u21BE",uplus:"\u228E",UpperLeftArrow:"\u2196",UpperRightArrow:"\u2197",Upsi:"\u03D2",upsi:"\u03C5",upsih:"\u03D2",Upsilon:"\u03A5",upsilon:"\u03C5",UpTee:"\u22A5",UpTeeArrow:"\u21A5",upuparrows:"\u21C8",urcorn:"\u231D",urcorner:"\u231D",urcrop:"\u230E",Uring:"\u016E",uring:"\u016F",urtri:"\u25F9",Uscr:"\u{1D4B0}",uscr:"\u{1D4CA}",utdot:"\u22F0",Utilde:"\u0168",utilde:"\u0169",utri:"\u25B5",utrif:"\u25B4",uuarr:"\u21C8",Uuml:"\xDC",uuml:"\xFC",uwangle:"\u29A7",vangrt:"\u299C",varepsilon:"\u03F5",varkappa:"\u03F0",varnothing:"\u2205",varphi:"\u03D5",varpi:"\u03D6",varpropto:"\u221D",vArr:"\u21D5",varr:"\u2195",varrho:"\u03F1",varsigma:"\u03C2",varsubsetneq:"\u228A\uFE00",varsubsetneqq:"\u2ACB\uFE00",varsupsetneq:"\u228B\uFE00",varsupsetneqq:"\u2ACC\uFE00",vartheta:"\u03D1",vartriangleleft:"\u22B2",vartriangleright:"\u22B3",Vbar:"\u2AEB",vBar:"\u2AE8",vBarv:"\u2AE9",Vcy:"\u0412",vcy:"\u0432",VDash:"\u22AB",Vdash:"\u22A9",vDash:"\u22A8",vdash:"\u22A2",Vdashl:"\u2AE6",Vee:"\u22C1",vee:"\u2228",veebar:"\u22BB",veeeq:"\u225A",vellip:"\u22EE",Verbar:"\u2016",verbar:"|",Vert:"\u2016",vert:"|",VerticalBar:"\u2223",VerticalLine:"|",VerticalSeparator:"\u2758",VerticalTilde:"\u2240",VeryThinSpace:"\u200A",Vfr:"\u{1D519}",vfr:"\u{1D533}",vltri:"\u22B2",vnsub:"\u2282\u20D2",vnsup:"\u2283\u20D2",Vopf:"\u{1D54D}",vopf:"\u{1D567}",vprop:"\u221D",vrtri:"\u22B3",Vscr:"\u{1D4B1}",vscr:"\u{1D4CB}",vsubnE:"\u2ACB\uFE00",vsubne:"\u228A\uFE00",vsupnE:"\u2ACC\uFE00",vsupne:"\u228B\uFE00",Vvdash:"\u22AA",vzigzag:"\u299A",Wcirc:"\u0174",wcirc:"\u0175",wedbar:"\u2A5F",Wedge:"\u22C0",wedge:"\u2227",wedgeq:"\u2259",weierp:"\u2118",Wfr:"\u{1D51A}",wfr:"\u{1D534}",Wopf:"\u{1D54E}",wopf:"\u{1D568}",wp:"\u2118",wr:"\u2240",wreath:"\u2240",Wscr:"\u{1D4B2}",wscr:"\u{1D4CC}",xcap:"\u22C2",xcirc:"\u25EF",xcup:"\u22C3",xdtri:"\u25BD",Xfr:"\u{1D51B}",xfr:"\u{1D535}",xhArr:"\u27FA",xharr:"\u27F7",Xi:"\u039E",xi:"\u03BE",xlArr:"\u27F8",xlarr:"\u27F5",xmap:"\u27FC",xnis:"\u22FB",xodot:"\u2A00",Xopf:"\u{1D54F}",xopf:"\u{1D569}",xoplus:"\u2A01",xotime:"\u2A02",xrArr:"\u27F9",xrarr:"\u27F6",Xscr:"\u{1D4B3}",xscr:"\u{1D4CD}",xsqcup:"\u2A06",xuplus:"\u2A04",xutri:"\u25B3",xvee:"\u22C1",xwedge:"\u22C0",Yacute:"\xDD",yacute:"\xFD",YAcy:"\u042F",yacy:"\u044F",Ycirc:"\u0176",ycirc:"\u0177",Ycy:"\u042B",ycy:"\u044B",yen:"\xA5",Yfr:"\u{1D51C}",yfr:"\u{1D536}",YIcy:"\u0407",yicy:"\u0457",Yopf:"\u{1D550}",yopf:"\u{1D56A}",Yscr:"\u{1D4B4}",yscr:"\u{1D4CE}",YUcy:"\u042E",yucy:"\u044E",Yuml:"\u0178",yuml:"\xFF",Zacute:"\u0179",zacute:"\u017A",Zcaron:"\u017D",zcaron:"\u017E",Zcy:"\u0417",zcy:"\u0437",Zdot:"\u017B",zdot:"\u017C",zeetrf:"\u2128",ZeroWidthSpace:"\u200B",Zeta:"\u0396",zeta:"\u03B6",Zfr:"\u2128",zfr:"\u{1D537}",ZHcy:"\u0416",zhcy:"\u0436",zigrarr:"\u21DD",Zopf:"\u2124",zopf:"\u{1D56B}",Zscr:"\u{1D4B5}",zscr:"\u{1D4CF}",zwj:"\u200D",zwnj:"\u200C"}),Ut.entityMap=Ut.HTML_ENTITIES},3969:function(Kt,Ut,mt){var ct,ne=mt(41146);ct=ne.DOMImplementation,ct=ne.XMLSerializer,Ut.DOMParser=mt(86129).DOMParser},76925:function(Kt,Ut,mt){var ct=mt(72167).NAMESPACE,ne=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,We=new RegExp("[\\-\\.0-9"+ne.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),ve=new RegExp("^"+ne.source+We.source+"*(?::"+ne.source+We.source+"*)?$"),ze=0,_e=1,we=2,ye=3,se=4,te=5,Y=6,I=7;function A(j,X){this.message=j,this.locator=X,Error.captureStackTrace&&Error.captureStackTrace(this,A)}A.prototype=new Error,A.prototype.name=A.name;function M(){}M.prototype={parse:function(j,X,oe){var ce=this.domBuilder;ce.startDocument(),H(X,X={}),k(j,X,oe,ce,this.errorHandler),ce.endDocument()}};function k(j,X,oe,ce,be){function Be(pi){if(pi>65535){pi-=65536;var ti=55296+(pi>>10),_i=56320+(pi&1023);return String.fromCharCode(ti,_i)}else return String.fromCharCode(pi)}function Ce(pi){var ti=pi.slice(1,-1);return Object.hasOwnProperty.call(oe,ti)?oe[ti]:ti.charAt(0)==="#"?Be(parseInt(ti.substr(1).replace("x","0x"))):(be.error("entity not found:"+pi),pi)}function Le(pi){if(pi>gt){var ti=j.substring(gt,pi).replace(/&#?\w+;/g,Ce);dt&&Pe(gt),ce.characters(ti,0,pi-gt),gt=pi}}function Pe(pi,ti){for(;pi>=Ve&&(ti=Oe.exec(j));)De=ti.index,Ve=De+ti[0].length,dt.lineNumber++;dt.columnNumber=pi-De+1}for(var De=0,Ve=0,Oe=/.*(?:\r\n?|\n)|.*$/g,dt=ce.locator,Nt=[{currentNSMap:X}],It={},gt=0;;){try{var nt=j.indexOf("<",gt);if(nt<0){if(!j.substr(gt).match(/^\s*$/)){var Ht=ce.doc,Tt=Ht.createTextNode(j.substr(gt));Ht.appendChild(Tt),ce.currentElement=Tt}return}switch(nt>gt&&Le(nt),j.charAt(nt+1)){case"/":var Gt=j.indexOf(">",nt+3),hi=j.substring(nt+2,Gt).replace(/[ \t\n\r]+$/g,""),ai=Nt.pop();Gt<0?(hi=j.substring(nt+2).replace(/[\s<].*/,""),be.error("end tag name: "+hi+" is not complete:"+ai.tagName),Gt=nt+1+hi.length):hi.match(/\s</)&&(hi=hi.replace(/[\s<].*/,""),be.error("end tag name: "+hi+" maybe not complete"),Gt=nt+1+hi.length);var Ei=ai.localNSMap,Ai=ai.tagName==hi,Ct=Ai||ai.tagName&&ai.tagName.toLowerCase()==hi.toLowerCase();if(Ct){if(ce.endElement(ai.uri,ai.localName,hi),Ei)for(var di in Ei)Object.prototype.hasOwnProperty.call(Ei,di)&&ce.endPrefixMapping(di);Ai||be.fatalError("end tag name: "+hi+" is not match the current start tagName:"+ai.tagName)}else Nt.push(ai);Gt++;break;case"?":dt&&Pe(nt),Gt=Q(j,nt,ce);break;case"!":dt&&Pe(nt),Gt=C(j,nt,ce,be);break;default:dt&&Pe(nt);var ui=new ae,ji=Nt[Nt.length-1].currentNSMap,Gt=J(j,nt,ui,ji,Ce,be),un=ui.length;if(!ui.closed&&$(j,Gt,ui.tagName,It)&&(ui.closed=!0,oe.nbsp||be.warning("unclosed xml attribute")),dt&&un){for(var $i=V(dt,{}),wt=0;wt<un;wt++){var mn=ui[wt];Pe(mn.offset),mn.locator=V(dt,{})}ce.locator=$i,F(ui,ce,ji)&&Nt.push(ui),ce.locator=dt}else F(ui,ce,ji)&&Nt.push(ui);ct.isHTML(ui.uri)&&!ui.closed?Gt=G(j,Gt,ui.tagName,Ce,ce):Gt++}}catch(pi){if(pi instanceof A)throw pi;be.error("element parse error: "+pi),Gt=-1}Gt>gt?gt=Gt:Le(Math.max(nt,gt)+1)}}function V(j,X){return X.lineNumber=j.lineNumber,X.columnNumber=j.columnNumber,X}function J(j,X,oe,ce,be,Be){function Ce(Nt,It,gt){oe.attributeNames.hasOwnProperty(Nt)&&Be.fatalError("Attribute "+Nt+" redefined"),oe.addValue(Nt,It.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,be),gt)}for(var Le,Pe,De=++X,Ve=ze;;){var Oe=j.charAt(De);switch(Oe){case"=":if(Ve===_e)Le=j.slice(X,De),Ve=ye;else if(Ve===we)Ve=ye;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(Ve===ye||Ve===_e)if(Ve===_e&&(Be.warning('attribute value must after "="'),Le=j.slice(X,De)),X=De+1,De=j.indexOf(Oe,X),De>0)Pe=j.slice(X,De),Ce(Le,Pe,X-1),Ve=te;else throw new Error("attribute value no end '"+Oe+"' match");else if(Ve==se)Pe=j.slice(X,De),Ce(Le,Pe,X),Be.warning('attribute "'+Le+'" missed start quot('+Oe+")!!"),X=De+1,Ve=te;else throw new Error('attribute value must after "="');break;case"/":switch(Ve){case ze:oe.setTagName(j.slice(X,De));case te:case Y:case I:Ve=I,oe.closed=!0;case se:case _e:break;case we:oe.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return Be.error("unexpected end of input"),Ve==ze&&oe.setTagName(j.slice(X,De)),De;case">":switch(Ve){case ze:oe.setTagName(j.slice(X,De));case te:case Y:case I:break;case se:case _e:Pe=j.slice(X,De),Pe.slice(-1)==="/"&&(oe.closed=!0,Pe=Pe.slice(0,-1));case we:Ve===we&&(Pe=Le),Ve==se?(Be.warning('attribute "'+Pe+'" missed quot(")!'),Ce(Le,Pe,X)):((!ct.isHTML(ce[""])||!Pe.match(/^(?:disabled|checked|selected)$/i))&&Be.warning('attribute "'+Pe+'" missed value!! "'+Pe+'" instead!!'),Ce(Pe,Pe,X));break;case ye:throw new Error("attribute value missed!!")}return De;case"\x80":Oe=" ";default:if(Oe<=" ")switch(Ve){case ze:oe.setTagName(j.slice(X,De)),Ve=Y;break;case _e:Le=j.slice(X,De),Ve=we;break;case se:var Pe=j.slice(X,De);Be.warning('attribute "'+Pe+'" missed quot(")!!'),Ce(Le,Pe,X);case te:Ve=Y;break}else switch(Ve){case we:var dt=oe.tagName;(!ct.isHTML(ce[""])||!Le.match(/^(?:disabled|checked|selected)$/i))&&Be.warning('attribute "'+Le+'" missed value!! "'+Le+'" instead2!!'),Ce(Le,Le,X),X=De,Ve=_e;break;case te:Be.warning('attribute space is required"'+Le+'"!!');case Y:Ve=_e,X=De;break;case ye:Ve=se,X=De;break;case I:throw new Error("elements closed character '/' and '>' must be connected to")}}De++}}function F(j,X,oe){for(var ce=j.tagName,be=null,Be=j.length;Be--;){var Ce=j[Be],Le=Ce.qName,Pe=Ce.value,dt=Le.indexOf(":");if(dt>0)var De=Ce.prefix=Le.slice(0,dt),Ve=Le.slice(dt+1),Oe=De==="xmlns"&&Ve;else Ve=Le,De=null,Oe=Le==="xmlns"&&"";Ce.localName=Ve,Oe!==!1&&(be==null&&(be={},H(oe,oe={})),oe[Oe]=be[Oe]=Pe,Ce.uri=ct.XMLNS,X.startPrefixMapping(Oe,Pe))}for(var Be=j.length;Be--;){Ce=j[Be];var De=Ce.prefix;De&&(De==="xml"&&(Ce.uri=ct.XML),De!=="xmlns"&&(Ce.uri=oe[De||""]))}var dt=ce.indexOf(":");dt>0?(De=j.prefix=ce.slice(0,dt),Ve=j.localName=ce.slice(dt+1)):(De=null,Ve=j.localName=ce);var Nt=j.uri=oe[De||""];if(X.startElement(Nt,Ve,ce,j),j.closed){if(X.endElement(Nt,Ve,ce),be)for(De in be)Object.prototype.hasOwnProperty.call(be,De)&&X.endPrefixMapping(De)}else return j.currentNSMap=oe,j.localNSMap=be,!0}function G(j,X,oe,ce,be){if(/^(?:script|textarea)$/i.test(oe)){var Be=j.indexOf("</"+oe+">",X),Ce=j.substring(X+1,Be);if(/[&<]/.test(Ce))return/^script$/i.test(oe)?(be.characters(Ce,0,Ce.length),Be):(Ce=Ce.replace(/&#?\w+;/g,ce),be.characters(Ce,0,Ce.length),Be)}return X+1}function $(j,X,oe,ce){var be=ce[oe];return be==null&&(be=j.lastIndexOf("</"+oe+">"),be<X&&(be=j.lastIndexOf("</"+oe)),ce[oe]=be),be<X}function H(j,X){for(var oe in j)Object.prototype.hasOwnProperty.call(j,oe)&&(X[oe]=j[oe])}function C(j,X,oe,ce){var be=j.charAt(X+2);switch(be){case"-":if(j.charAt(X+3)==="-"){var Be=j.indexOf("-->",X+4);return Be>X?(oe.comment(j,X+4,Be-X-4),Be+3):(ce.error("Unclosed comment"),-1)}else return-1;default:if(j.substr(X+3,6)=="CDATA["){var Be=j.indexOf("]]>",X+9);return oe.startCDATA(),oe.characters(j,X+9,Be-X-9),oe.endCDATA(),Be+3}var Ce=ue(j,X),Le=Ce.length;if(Le>1&&/!doctype/i.test(Ce[0][0])){var Pe=Ce[1][0],De=!1,Ve=!1;Le>3&&(/^public$/i.test(Ce[2][0])?(De=Ce[3][0],Ve=Le>4&&Ce[4][0]):/^system$/i.test(Ce[2][0])&&(Ve=Ce[3][0]));var Oe=Ce[Le-1];return oe.startDTD(Pe,De,Ve),oe.endDTD(),Oe.index+Oe[0].length}}return-1}function Q(j,X,oe){var ce=j.indexOf("?>",X);if(ce){var be=j.substring(X,ce).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(be){var Be=be[0].length;return oe.processingInstruction(be[1],be[2]),ce+2}else return-1}return-1}function ae(){this.attributeNames={}}ae.prototype={setTagName:function(j){if(!ve.test(j))throw new Error("invalid tagName:"+j);this.tagName=j},addValue:function(j,X,oe){if(!ve.test(j))throw new Error("invalid attribute:"+j);this.attributeNames[j]=this.length,this[this.length++]={qName:j,value:X,offset:oe}},length:0,getLocalName:function(j){return this[j].localName},getLocator:function(j){return this[j].locator},getQName:function(j){return this[j].qName},getURI:function(j){return this[j].uri},getValue:function(j){return this[j].value}};function ue(j,X){var oe,ce=[],be=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(be.lastIndex=X,be.exec(j);oe=be.exec(j);)if(ce.push(oe),oe[1])return ce}Ut.XMLReader=M,Ut.ParseError=A},5953:function(Kt,Ut,mt){var ct=mt(48764).Buffer;(function(ne,We){Kt.exports=We()})(self,()=>(()=>{var ne={916:(_e,we,ye)=>{var se=ye(471);_e.exports=function(te){"use strict";var Y,I="",A=(te=te||{}).video,M=te.options,k=se.$escape,V=te.tran,J=te.icons,F=te.index,G=se.$each;return te.$value,te.$index,I+=`<div class="dplayer-mask"></div>
<div class="dplayer-video-wrap">
    `,Y=ye(568)(A),I+=Y,I+=`
    `,M.logo&&(I+=`
    <div class="dplayer-logo">
        <img src="`,I+=k(M.logo),I+=`">
    </div>
    `),I+=`
    <div class="dplayer-danmaku"`,M.danmaku&&M.danmaku.bottom&&(I+=' style="margin-bottom:',I+=k(M.danmaku.bottom),I+='"'),I+=`>
        <div class="dplayer-danmaku-item dplayer-danmaku-item--demo"></div>
    </div>
    <div class="dplayer-subtitle"></div>
    <div class="dplayer-bezel">
        <span class="dplayer-bezel-icon"></span>
        `,M.danmaku&&(I+=`
        <span class="dplayer-danloading">`,I+=k(V("danmaku-loading")),I+=`</span>
        `),I+=`
        <span class="diplayer-loading-icon">`,I+=J.loading,I+=`</span>
    </div>
</div>
<div class="dplayer-controller-mask"></div>
<div class="dplayer-controller">
    <div class="dplayer-icons dplayer-comment-box">
        <button class="dplayer-icon dplayer-comment-setting-icon" data-balloon="`,I+=k(V("setting")),I+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,I+=J.pallette,I+=`</span>
        </button>
        <div class="dplayer-comment-setting-box">
            <div class="dplayer-comment-setting-color">
                <div class="dplayer-comment-setting-title">`,I+=k(V("set-danmaku-color")),I+=`</div>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,I+=k(F),I+=`" value="#fff" checked>
                    <span style="background: #fff;"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,I+=k(F),I+=`" value="#e54256">
                    <span style="background: #e54256"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,I+=k(F),I+=`" value="#ffe133">
                    <span style="background: #ffe133"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,I+=k(F),I+=`" value="#64DD17">
                    <span style="background: #64DD17"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,I+=k(F),I+=`" value="#39ccff">
                    <span style="background: #39ccff"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,I+=k(F),I+=`" value="#D500F9">
                    <span style="background: #D500F9"></span>
                </label>
            </div>
            <div class="dplayer-comment-setting-type">
                <div class="dplayer-comment-setting-title">`,I+=k(V("set-danmaku-type")),I+=`</div>
                <label>
                    <input type="radio" name="dplayer-danmaku-type-`,I+=k(F),I+=`" value="1">
                    <span>`,I+=k(V("top")),I+=`</span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-type-`,I+=k(F),I+=`" value="0" checked>
                    <span>`,I+=k(V("rolling")),I+=`</span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-type-`,I+=k(F),I+=`" value="2">
                    <span>`,I+=k(V("bottom")),I+=`</span>
                </label>
            </div>
        </div>
        <input class="dplayer-comment-input" type="text" placeholder="`,I+=k(V("input-danmaku-enter")),I+=`" maxlength="30">
        <button class="dplayer-icon dplayer-send-icon" data-balloon="`,I+=k(V("send")),I+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,I+=J.send,I+=`</span>
        </button>
    </div>
    <div class="dplayer-icons dplayer-icons-left">
        <button class="dplayer-icon dplayer-play-icon">
            <span class="dplayer-icon-content">`,I+=J.play,I+=`</span>
        </button>
        <div class="dplayer-volume">
            <button class="dplayer-icon dplayer-volume-icon">
                <span class="dplayer-icon-content">`,I+=J.volumeDown,I+=`</span>
            </button>
            <div class="dplayer-volume-bar-wrap" data-balloon-pos="up">
                <div class="dplayer-volume-bar">
                    <div class="dplayer-volume-bar-inner" style="background: `,I+=k(M.theme),I+=`;">
                        <span class="dplayer-thumb" style="background: `,I+=k(M.theme),I+=`"></span>
                    </div>
                </div>
            </div>
        </div>
        <span class="dplayer-time">
            <span class="dplayer-ptime">0:00</span> /
            <span class="dplayer-dtime">0:00</span>
        </span>
        `,M.live&&(I+=`
        <span class="dplayer-live-badge"><span class="dplayer-live-dot" style="background: `,I+=k(M.theme),I+=';"></span>',I+=k(V("live")),I+=`</span>
        `),I+=`
    </div>
    <div class="dplayer-icons dplayer-icons-right">
        `,M.video.quality&&(I+=`
        <div class="dplayer-quality">
            <button class="dplayer-icon dplayer-quality-icon">`,I+=k(M.video.quality[M.video.defaultQuality].name),I+=`</button>
            <div class="dplayer-quality-mask">
                <div class="dplayer-quality-list">
                `,G(M.video.quality,function($,H){I+=`
                    <div class="dplayer-quality-item" data-index="`,I+=k(H),I+='">',I+=k($.name),I+=`</div>
                `}),I+=`
                </div>
            </div>
        </div>
        `),I+=`
        `,M.screenshot&&(I+=`
        <div class="dplayer-icon dplayer-camera-icon" data-balloon="`,I+=k(V("screenshot")),I+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,I+=J.camera,I+=`</span>
        </div>
        `),I+=`
        `,M.airplay&&(I+=`
        <div class="dplayer-icon dplayer-airplay-icon" data-balloon="`,I+=k(V("airplay")),I+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,I+=J.airplay,I+=`</span>
        </div>
        `),I+=`
        `,M.chromecast&&(I+=`
        <div class="dplayer-icon dplayer-chromecast-icon" data-balloon="`,I+=k(V("chromecast")),I+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,I+=J.chromecast,I+=`</span>
        </div>
        `),I+=`
        <div class="dplayer-comment">
            <button class="dplayer-icon dplayer-comment-icon" data-balloon="`,I+=k(V("send-danmaku")),I+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,I+=J.comment,I+=`</span>
            </button>
        </div>
        `,M.subtitle&&(I+=`
        `,typeof M.subtitle.url=="string"?(I+=`
        <div class="dplayer-subtitle-btn">
            <button class="dplayer-icon dplayer-subtitle-icon" data-balloon="`,I+=k(V("hide-subs")),I+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,I+=J.subtitle,I+=`</span>
            </button>
        </div>
        `):(I+=`
        <div class="dplayer-subtitles">
            <button class="dplayer-icon dplayer-subtitles-icon" data-balloon="`,I+=k(V("subtitle")),I+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,I+=J.subtitle,I+=`</span>
            </button>
            <div class="dplayer-subtitles-box">
                <div class="dplayer-subtitles-panel">
                    `,G(M.subtitle.url,function($,H){I+=`
                        <div class="dplayer-subtitles-item" data-subtitle="`,I+=k($.url),I+=`">
                            <!-- if lang, show tran(lang). if lang and name, show name + (tran(lang)). if name, show name. off option use lang for translation. -->
                            <span class="dplayer-label">`,I+=k($.lang?$.name?$.name+" ("+V($.lang)+")":V($.lang):$.name),I+=`</span>
                        </div>
                    `}),I+=`
                </div>
            </div>
        </div>
        `),I+=`
        `),I+=`
        <div class="dplayer-setting">
            <button class="dplayer-icon dplayer-setting-icon" data-balloon="`,I+=k(V("setting")),I+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,I+=J.setting,I+=`</span>
            </button>
            <div class="dplayer-setting-box">
                <div class="dplayer-setting-origin-panel">
                    <div class="dplayer-setting-item dplayer-setting-speed">
                        <span class="dplayer-label">`,I+=k(V("speed")),I+=`</span>
                        <div class="dplayer-toggle">`,I+=J.right,I+=`</div>
                    </div>
                    <div class="dplayer-setting-item dplayer-setting-loop">
                        <span class="dplayer-label">`,I+=k(V("loop")),I+=`</span>
                        <div class="dplayer-toggle">
                            <input class="dplayer-toggle-setting-input" type="checkbox" name="dplayer-toggle">
                            <label for="dplayer-toggle"></label>
                        </div>
                    </div>
                    <div class="dplayer-setting-item dplayer-setting-showdan">
                        <span class="dplayer-label">`,I+=k(V("show-danmaku")),I+=`</span>
                        <div class="dplayer-toggle">
                            <input class="dplayer-showdan-setting-input" type="checkbox" name="dplayer-toggle-dan">
                            <label for="dplayer-toggle-dan"></label>
                        </div>
                    </div>
                    <div class="dplayer-setting-item dplayer-setting-danunlimit">
                        <span class="dplayer-label">`,I+=k(V("unlimited-danmaku")),I+=`</span>
                        <div class="dplayer-toggle">
                            <input class="dplayer-danunlimit-setting-input" type="checkbox" name="dplayer-toggle-danunlimit">
                            <label for="dplayer-toggle-danunlimit"></label>
                        </div>
                    </div>
                    <div class="dplayer-setting-item dplayer-setting-danmaku">
                        <span class="dplayer-label">`,I+=k(V("opacity-danmaku")),I+=`</span>
                        <div class="dplayer-danmaku-bar-wrap">
                            <div class="dplayer-danmaku-bar">
                                <div class="dplayer-danmaku-bar-inner">
                                    <span class="dplayer-thumb"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="dplayer-setting-speed-panel">
                    `,G(M.playbackSpeed,function($,H){I+=`
                        <div class="dplayer-setting-speed-item" data-speed="`,I+=k($),I+=`">
                            <span class="dplayer-label">`,I+=k($===1?V("normal"):$),I+=`</span>
                        </div>
                    `}),I+=`
                </div>
            </div>
        </div>
        <div class="dplayer-full">
            <button class="dplayer-icon dplayer-full-in-icon" data-balloon="`,I+=k(V("web-fullscreen")),I+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,I+=J.fullWeb,I+=`</span>
            </button>
            <button class="dplayer-icon dplayer-full-icon" data-balloon="`,I+=k(V("fullscreen")),I+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,I+=J.full,I+=`</span>
            </button>
        </div>
    </div>
    <div class="dplayer-bar-wrap">
        <div class="dplayer-bar-time hidden">00:00</div>
        <div class="dplayer-bar-preview"></div>
        <div class="dplayer-bar">
            <div class="dplayer-loaded" style="width: 0;"></div>
            <div class="dplayer-played" style="width: 0; background: `,I+=k(M.theme),I+=`">
                <span class="dplayer-thumb" style="background: `,I+=k(M.theme),I+=`"></span>
            </div>
        </div>
    </div>
</div>
<div class="dplayer-info-panel dplayer-info-panel-hide">
    <div class="dplayer-info-panel-close">[x]</div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-version">
        <span class="dplayer-info-panel-item-title">Player version</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-fps">
        <span class="dplayer-info-panel-item-title">Player FPS</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-type">
        <span class="dplayer-info-panel-item-title">Video type</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-url">
        <span class="dplayer-info-panel-item-title">Video url</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-resolution">
        <span class="dplayer-info-panel-item-title">Video resolution</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-duration">
        <span class="dplayer-info-panel-item-title">Video duration</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    `,M.danmaku&&(I+=`
    <div class="dplayer-info-panel-item dplayer-info-panel-item-danmaku-id">
        <span class="dplayer-info-panel-item-title">Danmaku id</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-danmaku-api">
        <span class="dplayer-info-panel-item-title">Danmaku api</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-danmaku-amount">
        <span class="dplayer-info-panel-item-title">Danmaku amount</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    `),I+=`
</div>
<div class="dplayer-menu">
    `,G(M.contextmenu,function($,H){I+=`
        <div class="dplayer-menu-item">
            <a`,$.link&&(I+=' target="_blank"'),I+=' href="',I+=k($.link||"javascript:void(0);"),I+='">',$.key&&(I+=" ",I+=k(V($.key))),$.text&&(I+=" ",I+=k($.text)),I+=`</a>
        </div>
    `}),I+=`
</div>
<div class="dplayer-notice-list"></div>
<button class="dplayer-mobile-play">
    `,I+=J.play,I+=`
</button>`}},568:(_e,we,ye)=>{var se=ye(471);_e.exports=function(te){"use strict";var Y="",I=(te=te||{}).enableSubtitle,A=te.subtitle,M=te.current,k=te.airplay,V=te.pic,J=se.$escape,F=te.screenshot,G=te.preload,$=te.url;return I=A&&A.type==="webvtt",Y+=`
<video
    class="dplayer-video `,M&&(Y+="dplayer-video-current"),Y+=`"
    webkit-playsinline
    `,k&&(Y+=' x-webkit-airplay="allow" '),Y+=`
    playsinline
    `,V&&(Y+='poster="',Y+=J(V),Y+='"'),Y+=`
    `,(F||I)&&(Y+='crossorigin="anonymous"'),Y+=`
    `,G&&(Y+='preload="',Y+=J(G),Y+='"'),Y+=`
    `,k?Y+=`
    nosrc
    `:$&&(Y+=`
    src="`,Y+=J($),Y+=`"
    `),Y+=`
    >
    `,k&&(Y+=`
    <source src="`,Y+=J($),Y+=`">
    `),Y+=`
    `,I&&(Y+=`
    <track class="dplayer-subtrack" kind="metadata" default src="`,Y+=J(typeof A.url=="string"?A.url:A.url[A.index].url),Y+=`"></track>
    `),Y+`
</video>`}},49:(_e,we,ye)=>{"use strict";ye.d(we,{Z:()=>A});var se=ye(415),te=ye.n(se),Y=ye(352),I=ye.n(Y)()(te());I.push([_e.id,`:root {
  --balloon-border-radius: 2px;
  --balloon-color: rgba(16, 16, 16, 0.95);
  --balloon-text-color: #fff;
  --balloon-font-size: 12px;
  --balloon-move: 4px; }

button[aria-label][data-balloon-pos] {
  overflow: visible; }

[aria-label][data-balloon-pos] {
  position: relative;
  cursor: pointer; }
  [aria-label][data-balloon-pos]:after {
    opacity: 0;
    pointer-events: none;
    transition: all 0.18s ease-out 0.18s;
    text-indent: 0;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
    font-weight: normal;
    font-style: normal;
    text-shadow: none;
    font-size: 12px;
    font-size: var(--balloon-font-size);
    background: rgba(16, 16, 16, 0.95);
    background: var(--balloon-color);
    border-radius: 2px;
    color: #fff;
    color: var(--balloon-text-color);
    border-radius: var(--balloon-border-radius);
    content: attr(aria-label);
    padding: .5em 1em;
    position: absolute;
    white-space: nowrap;
    z-index: 10; }
  [aria-label][data-balloon-pos]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-top-color: rgba(16, 16, 16, 0.95);
    border-top-color: var(--balloon-color);
    opacity: 0;
    pointer-events: none;
    transition: all 0.18s ease-out 0.18s;
    content: "";
    position: absolute;
    z-index: 10; }
  [aria-label][data-balloon-pos]:hover:before, [aria-label][data-balloon-pos]:hover:after, [aria-label][data-balloon-pos][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-visible]:after, [aria-label][data-balloon-pos]:not([data-balloon-nofocus]):focus:before, [aria-label][data-balloon-pos]:not([data-balloon-nofocus]):focus:after {
    opacity: 1;
    pointer-events: none; }
  [aria-label][data-balloon-pos].font-awesome:after {
    font-family: FontAwesome, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; }
  [aria-label][data-balloon-pos][data-balloon-break]:after {
    white-space: pre; }
  [aria-label][data-balloon-pos][data-balloon-break][data-balloon-length]:after {
    white-space: pre-line;
    word-break: break-word; }
  [aria-label][data-balloon-pos][data-balloon-blunt]:before, [aria-label][data-balloon-pos][data-balloon-blunt]:after {
    transition: none; }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="up"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos="down"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="down"][data-balloon-visible]:after {
    transform: translate(-50%, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="up"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos="down"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="down"][data-balloon-visible]:before {
    transform: translate(-50%, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos*="-left"]:after {
    left: 0; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-left"]:before {
    left: 5px; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:after {
    right: 0; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:before {
    right: 5px; }
  [aria-label][data-balloon-pos][data-balloon-po*="-left"]:hover:after, [aria-label][data-balloon-pos][data-balloon-po*="-left"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos*="-right"][data-balloon-visible]:after {
    transform: translate(0, 0); }
  [aria-label][data-balloon-pos][data-balloon-po*="-left"]:hover:before, [aria-label][data-balloon-pos][data-balloon-po*="-left"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos*="-right"][data-balloon-visible]:before {
    transform: translate(0, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos^="up"]:before, [aria-label][data-balloon-pos][data-balloon-pos^="up"]:after {
    bottom: 100%;
    transform-origin: top;
    transform: translate(0, 4px);
    transform: translate(0, var(--balloon-move)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="up"]:after {
    margin-bottom: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:before, [aria-label][data-balloon-pos][data-balloon-pos="up"]:after {
    left: 50%;
    transform: translate(-50%, 4px);
    transform: translate(-50%, var(--balloon-move)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:before, [aria-label][data-balloon-pos][data-balloon-pos^="down"]:after {
    top: 100%;
    transform: translate(0, calc(4px * -1));
    transform: translate(0, calc(var(--balloon-move) * -1)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:after {
    margin-top: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-bottom-color: rgba(16, 16, 16, 0.95);
    border-bottom-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-pos="down"]:after, [aria-label][data-balloon-pos][data-balloon-pos="down"]:before {
    left: 50%;
    transform: translate(-50%, calc(4px * -1));
    transform: translate(-50%, calc(var(--balloon-move) * -1)); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="left"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos="right"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="right"][data-balloon-visible]:after {
    transform: translate(0, -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="left"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos="right"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="right"][data-balloon-visible]:before {
    transform: translate(0, -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:after, [aria-label][data-balloon-pos][data-balloon-pos="left"]:before {
    right: 100%;
    top: 50%;
    transform: translate(4px, -50%);
    transform: translate(var(--balloon-move), -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:after {
    margin-right: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-left-color: rgba(16, 16, 16, 0.95);
    border-left-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:after, [aria-label][data-balloon-pos][data-balloon-pos="right"]:before {
    left: 100%;
    top: 50%;
    transform: translate(calc(4px * -1), -50%);
    transform: translate(calc(var(--balloon-move) * -1), -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:after {
    margin-left: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-right-color: rgba(16, 16, 16, 0.95);
    border-right-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-length]:after {
    white-space: normal; }
  [aria-label][data-balloon-pos][data-balloon-length="small"]:after {
    width: 80px; }
  [aria-label][data-balloon-pos][data-balloon-length="medium"]:after {
    width: 150px; }
  [aria-label][data-balloon-pos][data-balloon-length="large"]:after {
    width: 260px; }
  [aria-label][data-balloon-pos][data-balloon-length="xlarge"]:after {
    width: 380px; }
    @media screen and (max-width: 768px) {
      [aria-label][data-balloon-pos][data-balloon-length="xlarge"]:after {
        width: 90vw; } }
  [aria-label][data-balloon-pos][data-balloon-length="fit"]:after {
    width: 100%; }
`,"",{version:3,sources:["webpack://./node_modules/.pnpm/balloon-css@1.2.0/node_modules/balloon-css/balloon.css"],names:[],mappings:"AAAA;EACE,4BAA4B;EAC5B,uCAAuC;EACvC,0BAA0B;EAC1B,yBAAyB;EACzB,mBAAmB,EAAE;;AAEvB;EACE,iBAAiB,EAAE;;AAErB;EACE,kBAAkB;EAClB,eAAe,EAAE;EACjB;IACE,UAAU;IACV,oBAAoB;IACpB,oCAAoC;IACpC,cAAc;IACd,wIAAwI;IACxI,mBAAmB;IACnB,kBAAkB;IAClB,iBAAiB;IACjB,eAAmC;IAAnC,mCAAmC;IACnC,kCAAgC;IAAhC,gCAAgC;IAChC,kBAAkB;IAClB,WAAgC;IAAhC,gCAAgC;IAChC,2CAA2C;IAC3C,yBAAyB;IACzB,iBAAiB;IACjB,kBAAkB;IAClB,mBAAmB;IACnB,WAAW,EAAE;EACf;IACE,QAAQ;IACR,SAAS;IACT,6BAA6B;IAC7B,wCAAsC;IAAtC,sCAAsC;IACtC,UAAU;IACV,oBAAoB;IACpB,oCAAoC;IACpC,WAAW;IACX,kBAAkB;IAClB,WAAW,EAAE;EACf;IACE,UAAU;IACV,oBAAoB,EAAE;EACxB;IACE,qJAAqJ,EAAE;EACzJ;IACE,gBAAgB,EAAE;EACpB;IACE,qBAAqB;IACrB,sBAAsB,EAAE;EAC1B;IACE,gBAAgB,EAAE;EACpB;IACE,6BAA6B,EAAE;EACjC;IACE,6BAA6B,EAAE;EACjC;IACE,OAAO,EAAE;EACX;IACE,SAAS,EAAE;EACb;IACE,QAAQ,EAAE;EACZ;IACE,UAAU,EAAE;EACd;IACE,0BAA0B,EAAE;EAC9B;IACE,0BAA0B,EAAE;EAC9B;IACE,YAAY;IACZ,qBAAqB;IACrB,4BAA4C;IAA5C,4CAA4C,EAAE;EAChD;IACE,mBAAmB,EAAE;EACvB;IACE,SAAS;IACT,+BAA+C;IAA/C,+CAA+C,EAAE;EACnD;IACE,SAAS;IACT,uCAAuD;IAAvD,uDAAuD,EAAE;EAC3D;IACE,gBAAgB,EAAE;EACpB;IACE,QAAQ;IACR,SAAS;IACT,6BAA6B;IAC7B,2CAAyC;IAAzC,yCAAyC,EAAE;EAC7C;IACE,SAAS;IACT,0CAA0D;IAA1D,0DAA0D,EAAE;EAC9D;IACE,6BAA6B,EAAE;EACjC;IACE,6BAA6B,EAAE;EACjC;IACE,WAAW;IACX,QAAQ;IACR,+BAA+C;IAA/C,+CAA+C,EAAE;EACnD;IACE,kBAAkB,EAAE;EACtB;IACE,QAAQ;IACR,SAAS;IACT,6BAA6B;IAC7B,yCAAuC;IAAvC,uCAAuC,EAAE;EAC3C;IACE,UAAU;IACV,QAAQ;IACR,0CAA0D;IAA1D,0DAA0D,EAAE;EAC9D;IACE,iBAAiB,EAAE;EACrB;IACE,QAAQ;IACR,SAAS;IACT,6BAA6B;IAC7B,0CAAwC;IAAxC,wCAAwC,EAAE;EAC5C;IACE,mBAAmB,EAAE;EACvB;IACE,WAAW,EAAE;EACf;IACE,YAAY,EAAE;EAChB;IACE,YAAY,EAAE;EAChB;IACE,YAAY,EAAE;IACd;MACE;QACE,WAAW,EAAE,EAAE;EACrB;IACE,WAAW,EAAE",sourcesContent:[`:root {
  --balloon-border-radius: 2px;
  --balloon-color: rgba(16, 16, 16, 0.95);
  --balloon-text-color: #fff;
  --balloon-font-size: 12px;
  --balloon-move: 4px; }

button[aria-label][data-balloon-pos] {
  overflow: visible; }

[aria-label][data-balloon-pos] {
  position: relative;
  cursor: pointer; }
  [aria-label][data-balloon-pos]:after {
    opacity: 0;
    pointer-events: none;
    transition: all 0.18s ease-out 0.18s;
    text-indent: 0;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
    font-weight: normal;
    font-style: normal;
    text-shadow: none;
    font-size: var(--balloon-font-size);
    background: var(--balloon-color);
    border-radius: 2px;
    color: var(--balloon-text-color);
    border-radius: var(--balloon-border-radius);
    content: attr(aria-label);
    padding: .5em 1em;
    position: absolute;
    white-space: nowrap;
    z-index: 10; }
  [aria-label][data-balloon-pos]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-top-color: var(--balloon-color);
    opacity: 0;
    pointer-events: none;
    transition: all 0.18s ease-out 0.18s;
    content: "";
    position: absolute;
    z-index: 10; }
  [aria-label][data-balloon-pos]:hover:before, [aria-label][data-balloon-pos]:hover:after, [aria-label][data-balloon-pos][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-visible]:after, [aria-label][data-balloon-pos]:not([data-balloon-nofocus]):focus:before, [aria-label][data-balloon-pos]:not([data-balloon-nofocus]):focus:after {
    opacity: 1;
    pointer-events: none; }
  [aria-label][data-balloon-pos].font-awesome:after {
    font-family: FontAwesome, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; }
  [aria-label][data-balloon-pos][data-balloon-break]:after {
    white-space: pre; }
  [aria-label][data-balloon-pos][data-balloon-break][data-balloon-length]:after {
    white-space: pre-line;
    word-break: break-word; }
  [aria-label][data-balloon-pos][data-balloon-blunt]:before, [aria-label][data-balloon-pos][data-balloon-blunt]:after {
    transition: none; }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="up"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos="down"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="down"][data-balloon-visible]:after {
    transform: translate(-50%, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="up"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos="down"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="down"][data-balloon-visible]:before {
    transform: translate(-50%, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos*="-left"]:after {
    left: 0; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-left"]:before {
    left: 5px; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:after {
    right: 0; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:before {
    right: 5px; }
  [aria-label][data-balloon-pos][data-balloon-po*="-left"]:hover:after, [aria-label][data-balloon-pos][data-balloon-po*="-left"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos*="-right"][data-balloon-visible]:after {
    transform: translate(0, 0); }
  [aria-label][data-balloon-pos][data-balloon-po*="-left"]:hover:before, [aria-label][data-balloon-pos][data-balloon-po*="-left"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos*="-right"][data-balloon-visible]:before {
    transform: translate(0, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos^="up"]:before, [aria-label][data-balloon-pos][data-balloon-pos^="up"]:after {
    bottom: 100%;
    transform-origin: top;
    transform: translate(0, var(--balloon-move)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="up"]:after {
    margin-bottom: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:before, [aria-label][data-balloon-pos][data-balloon-pos="up"]:after {
    left: 50%;
    transform: translate(-50%, var(--balloon-move)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:before, [aria-label][data-balloon-pos][data-balloon-pos^="down"]:after {
    top: 100%;
    transform: translate(0, calc(var(--balloon-move) * -1)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:after {
    margin-top: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-bottom-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-pos="down"]:after, [aria-label][data-balloon-pos][data-balloon-pos="down"]:before {
    left: 50%;
    transform: translate(-50%, calc(var(--balloon-move) * -1)); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="left"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos="right"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="right"][data-balloon-visible]:after {
    transform: translate(0, -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="left"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos="right"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="right"][data-balloon-visible]:before {
    transform: translate(0, -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:after, [aria-label][data-balloon-pos][data-balloon-pos="left"]:before {
    right: 100%;
    top: 50%;
    transform: translate(var(--balloon-move), -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:after {
    margin-right: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-left-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:after, [aria-label][data-balloon-pos][data-balloon-pos="right"]:before {
    left: 100%;
    top: 50%;
    transform: translate(calc(var(--balloon-move) * -1), -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:after {
    margin-left: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-right-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-length]:after {
    white-space: normal; }
  [aria-label][data-balloon-pos][data-balloon-length="small"]:after {
    width: 80px; }
  [aria-label][data-balloon-pos][data-balloon-length="medium"]:after {
    width: 150px; }
  [aria-label][data-balloon-pos][data-balloon-length="large"]:after {
    width: 260px; }
  [aria-label][data-balloon-pos][data-balloon-length="xlarge"]:after {
    width: 380px; }
    @media screen and (max-width: 768px) {
      [aria-label][data-balloon-pos][data-balloon-length="xlarge"]:after {
        width: 90vw; } }
  [aria-label][data-balloon-pos][data-balloon-length="fit"]:after {
    width: 100%; }
`],sourceRoot:""}]);const A=I},685:(_e,we,ye)=>{"use strict";ye.d(we,{Z:()=>G});var se=ye(415),te=ye.n(se),Y=ye(352),I=ye.n(Y),A=ye(49),M=ye(80),k=ye.n(M),V=new URL(ye(831),ye.b),J=I()(te());J.i(A.Z);var F=k()(V);J.push([_e.id,`@keyframes my-face {
  2% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  4% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  6% {
    transform: translate(0, 1.5px) rotate(-1.5deg);
  }
  8% {
    transform: translate(0, -1.5px) rotate(-1.5deg);
  }
  10% {
    transform: translate(0, 2.5px) rotate(1.5deg);
  }
  12% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  14% {
    transform: translate(0, -1.5px) rotate(1.5deg);
  }
  16% {
    transform: translate(0, -0.5px) rotate(-1.5deg);
  }
  18% {
    transform: translate(0, 0.5px) rotate(-1.5deg);
  }
  20% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  22% {
    transform: translate(0, 0.5px) rotate(-1.5deg);
  }
  24% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  26% {
    transform: translate(0, 0.5px) rotate(0.5deg);
  }
  28% {
    transform: translate(0, 0.5px) rotate(1.5deg);
  }
  30% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  32% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  34% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  36% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  38% {
    transform: translate(0, 1.5px) rotate(-1.5deg);
  }
  40% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  42% {
    transform: translate(0, 2.5px) rotate(-1.5deg);
  }
  44% {
    transform: translate(0, 1.5px) rotate(0.5deg);
  }
  46% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  48% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  50% {
    transform: translate(0, 0.5px) rotate(0.5deg);
  }
  52% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  54% {
    transform: translate(0, -1.5px) rotate(1.5deg);
  }
  56% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  58% {
    transform: translate(0, 0.5px) rotate(2.5deg);
  }
  60% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  62% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  64% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  66% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  68% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  70% {
    transform: translate(0, 1.5px) rotate(0.5deg);
  }
  72% {
    transform: translate(0, 2.5px) rotate(1.5deg);
  }
  74% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  76% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  78% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  80% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  82% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  84% {
    transform: translate(0, 1.5px) rotate(2.5deg);
  }
  86% {
    transform: translate(0, -1.5px) rotate(-1.5deg);
  }
  88% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  90% {
    transform: translate(0, 2.5px) rotate(-0.5deg);
  }
  92% {
    transform: translate(0, 0.5px) rotate(-0.5deg);
  }
  94% {
    transform: translate(0, 2.5px) rotate(0.5deg);
  }
  96% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  98% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  0%,
  100% {
    transform: translate(0, 0) rotate(0deg);
  }
}
.dplayer {
  position: relative;
  overflow: hidden;
  -webkit-user-select: none;
     -moz-user-select: none;
          user-select: none;
  line-height: 1;
}
.dplayer * {
  box-sizing: content-box;
}
.dplayer svg {
  width: 100%;
  height: 100%;
}
.dplayer svg path,
.dplayer svg circle {
  fill: #fff;
}
.dplayer:-webkit-full-screen {
  width: 100%;
  height: 100%;
  background: #000;
  position: fixed;
  z-index: 100000;
  left: 0;
  top: 0;
  margin: 0;
  padding: 0;
  transform: translate(0, 0);
}
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-showdan,
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-danmaku,
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-danunlimit {
  display: none;
}
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-comment {
  display: none;
}
.dplayer.dplayer-no-danmaku .dplayer-danmaku {
  display: none;
}
.dplayer.dplayer-live .dplayer-time {
  display: none;
}
.dplayer.dplayer-live .dplayer-bar-wrap {
  display: none;
}
.dplayer.dplayer-live .dplayer-setting-speed {
  display: none;
}
.dplayer.dplayer-live .dplayer-setting-loop {
  display: none;
}
.dplayer.dplayer-live.dplayer-no-danmaku .dplayer-setting {
  display: none;
}
.dplayer.dplayer-arrow .dplayer-danmaku {
  font-size: 18px;
}
.dplayer.dplayer-arrow .dplayer-icon {
  margin: 0 -3px;
}
.dplayer.dplayer-playing .dplayer-danmaku .dplayer-danmaku-move {
  animation-play-state: running;
}
@media (min-width: 900px) {
  .dplayer.dplayer-playing .dplayer-controller-mask {
    opacity: 0;
  }
  .dplayer.dplayer-playing .dplayer-controller {
    opacity: 0;
  }
  .dplayer.dplayer-playing:hover .dplayer-controller-mask {
    opacity: 1;
  }
  .dplayer.dplayer-playing:hover .dplayer-controller {
    opacity: 1;
  }
}
.dplayer.dplayer-loading .dplayer-bezel .diplayer-loading-icon {
  display: block;
}
.dplayer.dplayer-loading .dplayer-danmaku,
.dplayer.dplayer-paused .dplayer-danmaku,
.dplayer.dplayer-loading .dplayer-danmaku-move,
.dplayer.dplayer-paused .dplayer-danmaku-move {
  animation-play-state: paused;
}
.dplayer.dplayer-hide-controller {
  cursor: none;
}
.dplayer.dplayer-hide-controller .dplayer-controller-mask {
  opacity: 0;
  transform: translateY(100%);
}
.dplayer.dplayer-hide-controller .dplayer-controller {
  opacity: 0;
  transform: translateY(100%);
}
.dplayer.dplayer-show-controller .dplayer-controller-mask {
  opacity: 1;
}
.dplayer.dplayer-show-controller .dplayer-controller {
  opacity: 1;
}
.dplayer.dplayer-fulled {
  width: 100% !important;
  height: 100% !important;
}
.dplayer.dplayer-fulled {
  position: fixed;
  z-index: 100000;
  left: 0;
  top: 0;
}
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-volume,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-camera-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-airplay-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-chromecast-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-play-icon {
  display: none;
}
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-full .dplayer-full-in-icon {
  position: static;
  display: inline-block;
}
.dplayer.dplayer-mobile .dplayer-bar-time {
  display: none;
}
.dplayer.dplayer-mobile.dplayer-hide-controller .dplayer-mobile-play {
  display: none;
}
.dplayer.dplayer-mobile .dplayer-mobile-play {
  display: block;
}
.dplayer-web-fullscreen-fix {
  position: fixed;
  top: 0;
  left: 0;
  margin: 0;
  padding: 0;
}
[data-balloon]:before {
  display: none;
}
[data-balloon]:after {
  padding: 0.3em 0.7em;
  background: rgba(17, 17, 17, 0.7);
}
[data-balloon][data-balloon-pos="up"]:after {
  margin-bottom: 0;
}
.dplayer-bezel {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  font-size: 22px;
  color: #fff;
  pointer-events: none;
}
.dplayer-bezel .dplayer-bezel-icon {
  position: absolute;
  top: 50%;
  left: 50%;
  margin: -26px 0 0 -26px;
  height: 52px;
  width: 52px;
  padding: 12px;
  box-sizing: border-box;
  background: rgba(0, 0, 0, 0.5);
  border-radius: 50%;
  opacity: 0;
  pointer-events: none;
}
.dplayer-bezel .dplayer-bezel-icon.dplayer-bezel-transition {
  animation: bezel-hide 0.5s linear;
}
@keyframes bezel-hide {
  from {
    opacity: 1;
    transform: scale(1);
  }
  to {
    opacity: 0;
    transform: scale(2);
  }
}
.dplayer-bezel .dplayer-danloading {
  position: absolute;
  top: 50%;
  margin-top: -7px;
  width: 100%;
  text-align: center;
  font-size: 14px;
  line-height: 14px;
  animation: my-face 5s infinite ease-in-out;
}
.dplayer-bezel .diplayer-loading-icon {
  display: none;
  position: absolute;
  top: 50%;
  left: 50%;
  margin: -18px 0 0 -18px;
  height: 36px;
  width: 36px;
  pointer-events: none;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-hide {
  display: none;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot {
  animation: diplayer-loading-dot-fade 0.8s ease infinite;
  opacity: 0;
  transform-origin: 4px 4px;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-1 {
  animation-delay: 0.1s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-2 {
  animation-delay: 0.2s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-3 {
  animation-delay: 0.3s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-4 {
  animation-delay: 0.4s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-5 {
  animation-delay: 0.5s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-6 {
  animation-delay: 0.6s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-7 {
  animation-delay: 0.7s;
}
@keyframes diplayer-loading-dot-fade {
  0% {
    opacity: 0.7;
    transform: scale(1.2, 1.2);
  }
  50% {
    opacity: 0.25;
    transform: scale(0.9, 0.9);
  }
  to {
    opacity: 0.25;
    transform: scale(0.85, 0.85);
  }
}
.dplayer-controller-mask {
  background: url(`+F+`) repeat-x bottom;
  height: 98px;
  width: 100%;
  position: absolute;
  bottom: 0;
  transition: all 0.3s ease;
}
.dplayer-controller {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 41px;
  padding: 0 20px;
  -webkit-user-select: none;
     -moz-user-select: none;
          user-select: none;
  transition: all 0.3s ease;
}
.dplayer-controller.dplayer-controller-comment .dplayer-icons {
  display: none;
}
.dplayer-controller.dplayer-controller-comment .dplayer-icons.dplayer-comment-box {
  display: block;
}
.dplayer-controller .dplayer-bar-wrap {
  padding: 5px 0;
  cursor: pointer;
  position: absolute;
  bottom: 33px;
  width: calc(100% - 40px);
  height: 3px;
}
.dplayer-controller .dplayer-bar-wrap:hover .dplayer-bar .dplayer-played .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-bar-wrap:hover .dplayer-highlight {
  display: block;
  width: 8px;
  transform: translateX(-4px);
  top: 4px;
  height: 40%;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight {
  z-index: 12;
  position: absolute;
  top: 5px;
  width: 6px;
  height: 20%;
  border-radius: 6px;
  background-color: #fff;
  text-align: center;
  transform: translateX(-3px);
  transition: all 0.2s ease-in-out;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover .dplayer-highlight-text {
  display: block;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover ~ .dplayer-bar-preview {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover ~ .dplayer-bar-time {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight .dplayer-highlight-text {
  display: none;
  position: absolute;
  left: 50%;
  top: -24px;
  padding: 5px 8px;
  background-color: rgba(0, 0, 0, 0.62);
  color: #fff;
  border-radius: 4px;
  font-size: 12px;
  white-space: nowrap;
  transform: translateX(-50%);
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-preview {
  position: absolute;
  background: #fff;
  pointer-events: none;
  display: none;
  background-size: 16000px 100%;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-preview-canvas {
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: 1;
  pointer-events: none;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-time {
  position: absolute;
  left: 0px;
  top: -20px;
  border-radius: 4px;
  padding: 5px 7px;
  background-color: rgba(0, 0, 0, 0.62);
  color: #fff;
  font-size: 12px;
  text-align: center;
  opacity: 1;
  transition: opacity 0.1s ease-in-out;
  word-wrap: normal;
  word-break: normal;
  z-index: 2;
  pointer-events: none;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-time.hidden {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar {
  position: relative;
  height: 3px;
  width: 100%;
  background: rgba(255, 255, 255, 0.2);
  cursor: pointer;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-loaded {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  background: rgba(255, 255, 255, 0.4);
  height: 3px;
  transition: all 0.5s ease;
  will-change: width;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-played {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  height: 3px;
  will-change: width;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-played .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons {
  height: 38px;
  position: absolute;
  bottom: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box {
  display: none;
  position: absolute;
  transition: all 0.3s ease-in-out;
  z-index: 2;
  height: 38px;
  bottom: 0;
  left: 20px;
  right: 20px;
  color: #fff;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-icon {
  padding: 7px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-icon {
  position: absolute;
  left: 0;
  top: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-send-icon {
  position: absolute;
  right: 0;
  top: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box {
  position: absolute;
  background: rgba(28, 28, 28, 0.9);
  bottom: 41px;
  left: 0;
  box-shadow: 0 0 25px rgba(0, 0, 0, 0.3);
  border-radius: 4px;
  padding: 10px 10px 16px;
  font-size: 14px;
  width: 204px;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box.dplayer-comment-setting-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box input[type=radio] {
  display: none;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box label {
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-title {
  font-size: 13px;
  color: #fff;
  line-height: 30px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type {
  font-size: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type .dplayer-comment-setting-title {
  margin-bottom: 6px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type label:nth-child(2) span {
  border-radius: 4px 0 0 4px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type label:nth-child(4) span {
  border-radius: 0 4px 4px 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type span {
  width: 33%;
  padding: 4px 6px;
  line-height: 16px;
  display: inline-block;
  font-size: 12px;
  color: #fff;
  border: 1px solid #fff;
  margin-right: -1px;
  box-sizing: border-box;
  text-align: center;
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type input:checked + span {
  background: #E4E4E6;
  color: #1c1c1c;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color {
  font-size: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color label {
  font-size: 0;
  padding: 6px;
  display: inline-block;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color span {
  width: 22px;
  height: 22px;
  display: inline-block;
  border-radius: 50%;
  box-sizing: border-box;
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color span:hover {
  animation: my-face 5s infinite ease-in-out;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input {
  outline: none;
  border: none;
  padding: 8px 31px;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  border-radius: 4px;
  background: none;
  margin: 0;
  height: 100%;
  box-sizing: border-box;
  width: 100%;
  color: #fff;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::-moz-placeholder {
  color: #fff;
  opacity: 0.8;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::placeholder {
  color: #fff;
  opacity: 0.8;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::-ms-clear {
  display: none;
}
.dplayer-controller .dplayer-icons.dplayer-icons-left .dplayer-icon {
  padding: 7px;
}
.dplayer-controller .dplayer-icons.dplayer-icons-right {
  right: 20px;
}
.dplayer-controller .dplayer-icons.dplayer-icons-right .dplayer-icon {
  padding: 8px;
}
.dplayer-controller .dplayer-icons .dplayer-time,
.dplayer-controller .dplayer-icons .dplayer-live-badge {
  line-height: 38px;
  color: #eee;
  text-shadow: 0 0 2px rgba(0, 0, 0, 0.5);
  vertical-align: middle;
  font-size: 13px;
  cursor: default;
}
.dplayer-controller .dplayer-icons .dplayer-live-dot {
  display: inline-block;
  width: 6px;
  height: 6px;
  vertical-align: 4%;
  margin-right: 5px;
  content: '';
  border-radius: 6px;
}
.dplayer-controller .dplayer-icons .dplayer-icon {
  width: 40px;
  height: 100%;
  border: none;
  background-color: transparent;
  outline: none;
  cursor: pointer;
  vertical-align: middle;
  box-sizing: border-box;
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-icon .dplayer-icon-content {
  transition: all 0.2s ease-in-out;
  opacity: 0.8;
}
.dplayer-controller .dplayer-icons .dplayer-icon:hover .dplayer-icon-content {
  opacity: 1;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-quality-icon {
  color: #fff;
  width: auto;
  line-height: 22px;
  font-size: 14px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-comment-icon {
  padding: 10px 9px 9px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-setting-icon {
  padding-top: 8.5px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-volume-icon {
  width: 43px;
}
.dplayer-controller .dplayer-icons .dplayer-volume {
  position: relative;
  display: inline-block;
  cursor: pointer;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-volume:hover .dplayer-volume-bar-wrap .dplayer-volume-bar {
  width: 45px;
}
.dplayer-controller .dplayer-icons .dplayer-volume:hover .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-volume.dplayer-volume-active .dplayer-volume-bar-wrap .dplayer-volume-bar {
  width: 45px;
}
.dplayer-controller .dplayer-icons .dplayer-volume.dplayer-volume-active .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap {
  display: inline-block;
  margin: 0 10px 0 -5px;
  vertical-align: middle;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar {
  position: relative;
  top: 17px;
  width: 0;
  height: 3px;
  background: #aaa;
  transition: all 0.3s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 100%;
  transition: all 0.1s ease;
  will-change: width;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons .dplayer-subtitle-btn {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box {
  position: absolute;
  right: 0;
  bottom: 50px;
  transform: scale(0);
  width: -moz-fit-content;
  width: fit-content;
  max-width: 240px;
  min-width: 120px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 7px 0;
  transition: all 0.3s ease-in-out;
  overflow: auto;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box.dplayer-subtitles-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box.dplayer-subtitles-box-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-item {
  height: 30px;
  padding: 5px 10px;
  box-sizing: border-box;
  cursor: pointer;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-setting {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box {
  position: absolute;
  right: 0;
  bottom: 50px;
  transform: scale(0);
  width: 150px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 7px 0;
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box > div {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box > div.dplayer-setting-origin-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-narrow {
  width: 70px;
  text-align: center;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-speed .dplayer-setting-origin-panel {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-speed .dplayer-setting-speed-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-item,
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-speed-item {
  height: 30px;
  padding: 5px 10px;
  box-sizing: border-box;
  cursor: pointer;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-item:hover,
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-speed-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku {
  padding: 5px 0;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-label {
  padding: 0 10px;
  display: inline;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku:hover .dplayer-label {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku:hover .dplayer-danmaku-bar-wrap {
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-label {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-danmaku-bar-wrap {
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap {
  padding: 0 10px;
  box-sizing: border-box;
  display: none;
  vertical-align: middle;
  height: 100%;
  width: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar {
  position: relative;
  top: 8.5px;
  width: 100%;
  height: 3px;
  background: #fff;
  transition: all 0.3s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar .dplayer-danmaku-bar-inner {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 100%;
  transition: all 0.1s ease;
  background: #aaa;
  will-change: width;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar .dplayer-danmaku-bar-inner .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  background: #aaa;
}
.dplayer-controller .dplayer-icons .dplayer-full {
  display: inline-block;
  height: 100%;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-full:hover .dplayer-full-in-icon {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-full .dplayer-full-in-icon {
  position: absolute;
  top: -30px;
  z-index: 1;
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-quality {
  position: relative;
  display: inline-block;
  height: 100%;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-quality:hover .dplayer-quality-list {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-quality:hover .dplayer-quality-mask {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-mask {
  display: none;
  position: absolute;
  bottom: 38px;
  left: -18px;
  width: 80px;
  padding-bottom: 12px;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-list {
  display: none;
  font-size: 12px;
  width: 80px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 5px 0;
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  color: #fff;
  text-align: center;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-item {
  height: 25px;
  box-sizing: border-box;
  cursor: pointer;
  line-height: 25px;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-comment {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-label {
  color: #eee;
  font-size: 13px;
  display: inline-block;
  vertical-align: middle;
  white-space: nowrap;
}
.dplayer-controller .dplayer-icons .dplayer-toggle {
  width: 32px;
  height: 20px;
  text-align: center;
  font-size: 0;
  vertical-align: middle;
  position: absolute;
  top: 5px;
  right: 10px;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input {
  max-height: 0;
  max-width: 0;
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label {
  display: inline-block;
  position: relative;
  box-shadow: #dfdfdf 0 0 0 0 inset;
  border: 1px solid #dfdfdf;
  height: 20px;
  width: 32px;
  border-radius: 10px;
  box-sizing: border-box;
  cursor: pointer;
  transition: 0.2s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label:before {
  content: "";
  position: absolute;
  display: block;
  height: 18px;
  width: 18px;
  top: 0;
  left: 0;
  border-radius: 15px;
  transition: 0.2s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label:after {
  content: "";
  position: absolute;
  display: block;
  left: 0;
  top: 0;
  border-radius: 15px;
  background: #fff;
  transition: 0.2s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
  height: 18px;
  width: 18px;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label {
  border-color: rgba(255, 255, 255, 0.5);
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label:before {
  width: 30px;
  background: rgba(255, 255, 255, 0.5);
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label:after {
  left: 12px;
}
.dplayer-mobile-play {
  display: none;
  width: 50px;
  height: 50px;
  border: none;
  background-color: transparent;
  outline: none;
  cursor: pointer;
  box-sizing: border-box;
  bottom: 0;
  opacity: 0.8;
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
}
.dplayer-danmaku {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  font-size: 22px;
  color: #fff;
}
.dplayer-danmaku .dplayer-danmaku-item {
  display: inline-block;
  pointer-events: none;
  -webkit-user-select: none;
     -moz-user-select: none;
          user-select: none;
  cursor: default;
  white-space: nowrap;
  text-shadow: 0.5px 0.5px 0.5px rgba(0, 0, 0, 0.5);
}
.dplayer-danmaku .dplayer-danmaku-item--demo {
  position: absolute;
  visibility: hidden;
}
.dplayer-danmaku .dplayer-danmaku-right {
  position: absolute;
  right: 0;
  transform: translateX(100%);
}
.dplayer-danmaku .dplayer-danmaku-right.dplayer-danmaku-move {
  will-change: transform;
  animation-name: 'danmaku';
  animation-timing-function: linear;
  animation-play-state: paused;
}
@keyframes danmaku {
  from {
    transform: translateX(100%);
  }
}
.dplayer-danmaku .dplayer-danmaku-top,
.dplayer-danmaku .dplayer-danmaku-bottom {
  position: absolute;
  width: 100%;
  text-align: center;
  visibility: hidden;
}
.dplayer-danmaku .dplayer-danmaku-top.dplayer-danmaku-move,
.dplayer-danmaku .dplayer-danmaku-bottom.dplayer-danmaku-move {
  will-change: visibility;
  animation-name: 'danmaku-center';
  animation-timing-function: linear;
  animation-play-state: paused;
}
@keyframes danmaku-center {
  from {
    visibility: visible;
  }
  to {
    visibility: visible;
  }
}
.dplayer-logo {
  pointer-events: none;
  position: absolute;
  left: 20px;
  top: 20px;
  max-width: 50px;
  max-height: 50px;
}
.dplayer-logo img {
  max-width: 100%;
  max-height: 100%;
  background: none;
}
.dplayer-menu {
  position: absolute;
  width: 170px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.85);
  padding: 5px 0;
  overflow: hidden;
  z-index: 3;
  display: none;
}
.dplayer-menu.dplayer-menu-show {
  display: block;
}
.dplayer-menu .dplayer-menu-item {
  height: 30px;
  box-sizing: border-box;
  cursor: pointer;
}
.dplayer-menu .dplayer-menu-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-menu .dplayer-menu-item a {
  padding: 0 10px;
  line-height: 30px;
  color: #eee;
  font-size: 13px;
  display: inline-block;
  vertical-align: middle;
  width: 100%;
  box-sizing: border-box;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
.dplayer-menu .dplayer-menu-item a:hover {
  text-decoration: none;
}
.dplayer-notice-list {
  position: absolute;
  bottom: 60px;
  left: 20px;
}
.dplayer-notice-list .dplayer-notice {
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  color: #fff;
  display: table;
  pointer-events: none;
  animation: showNotice 0.3s ease 1 forwards;
}
.dplayer-notice-list .remove-notice {
  animation: removeNotice 0.3s ease 1 forwards;
}
@keyframes showNotice {
  from {
    padding: 0;
    font-size: 0;
    margin-top: 0;
  }
  to {
    padding: 7px 20px;
    font-size: 14px;
    margin-top: 5px;
  }
}
@keyframes removeNotice {
  0% {
    padding: 7px 20px;
    font-size: 14px;
    margin-top: 5px;
  }
  20% {
    font-size: 12px;
  }
  21% {
    font-size: 0;
    padding: 7px 10px;
  }
  100% {
    padding: 0;
    margin-top: 0;
    font-size: 0;
  }
}
.dplayer-subtitle {
  position: absolute;
  bottom: 40px;
  width: 90%;
  left: 5%;
  text-align: center;
  color: #fff;
  text-shadow: 0.5px 0.5px 0.5px rgba(0, 0, 0, 0.5);
  font-size: 20px;
}
.dplayer-subtitle.dplayer-subtitle-hide {
  display: none;
}
.dplayer-mask {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 1;
  display: none;
}
.dplayer-mask.dplayer-mask-show {
  display: block;
}
.dplayer-video-wrap {
  position: relative;
  background: #000;
  font-size: 0;
  width: 100%;
  height: 100%;
}
.dplayer-video-wrap .dplayer-video {
  width: 100%;
  height: 100%;
  display: none;
}
.dplayer-video-wrap .dplayer-video-current {
  display: block;
}
.dplayer-video-wrap .dplayer-video-prepare {
  display: none;
}
.dplayer-info-panel {
  position: absolute;
  top: 10px;
  left: 10px;
  width: 400px;
  background: rgba(28, 28, 28, 0.8);
  padding: 10px;
  color: #fff;
  font-size: 12px;
  border-radius: 2px;
}
.dplayer-info-panel-hide {
  display: none;
}
.dplayer-info-panel .dplayer-info-panel-close {
  cursor: pointer;
  position: absolute;
  right: 10px;
  top: 10px;
}
.dplayer-info-panel .dplayer-info-panel-item > span {
  display: inline-block;
  vertical-align: middle;
  line-height: 15px;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
.dplayer-info-panel .dplayer-info-panel-item-title {
  width: 100px;
  text-align: right;
  margin-right: 10px;
}
.dplayer-info-panel .dplayer-info-panel-item-data {
  width: 260px;
}
`,"",{version:3,sources:["webpack://./src/css/global.less","webpack://./src/css/index.less","webpack://./src/css/player.less","webpack://./src/css/balloon.less","webpack://./src/css/bezel.less","webpack://./src/css/notice.less","webpack://./src/css/controller.less","webpack://./src/css/danmaku.less","webpack://./src/css/logo.less","webpack://./src/css/menu.less","webpack://./src/css/subtitle.less","webpack://./src/css/video.less","webpack://./src/css/info-panel.less"],names:[],mappings:"AAAA;EACI;IACI,6CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;;IAEI,uCAAA;ECEN;AACF;ACzJA;EACI,kBAAA;EACA,gBAAA;EACA,yBAAA;KAAA,sBAAA;UAAA,iBAAA;EACA,cAAA;AD2JJ;AC/JA;EAOQ,uBAAA;AD2JR;AClKA;EAWQ,WAAA;EACA,YAAA;AD0JR;ACtKA;;EAgBY,UAAA;AD0JZ;ACtJI;EACI,WAAA;EACA,YAAA;EACA,gBAAA;EACA,eAAA;EACA,eAAA;EACA,OAAA;EACA,MAAA;EACA,SAAA;EACA,UAAA;EACA,0BAAA;ADwJR;ACpJI;;;EAKY,aAAA;ADoJhB;ACzJI;EAUQ,aAAA;ADkJZ;AC5JI;EAcQ,aAAA;ADiJZ;AC7II;EAEQ,aAAA;AD8IZ;AChJI;EAKQ,aAAA;AD8IZ;ACnJI;EAQQ,aAAA;AD8IZ;ACtJI;EAWQ,aAAA;AD8IZ;AC3IQ;EAEQ,aAAA;AD4IhB;ACvII;EAEQ,eAAA;ADwIZ;AC1II;EAKQ,cAAA;ADwIZ;ACpII;EAEQ,6BAAA;ADqIZ;AClIQ;EAAA;IAEQ,UAAA;EDoId;ECtIM;IAKQ,UAAA;EDoId;ECjIU;IAEQ,UAAA;EDkIlB;ECpIU;IAKQ,UAAA;EDkIlB;AACF;AC7HI;EAEQ,cAAA;AD8HZ;AC1HI;;;;EAIQ,4BAAA;AD4HZ;ACxHI;EACI,YAAA;AD0HR;AC3HI;EAIQ,UAAA;EACA,2BAAA;AD0HZ;AC/HI;EAQQ,UAAA;EACA,2BAAA;AD0HZ;ACvHI;EAEQ,UAAA;ADwHZ;AC1HI;EAKQ,UAAA;ADwHZ;ACrHI;EAKI,sBAAA;EACA,uBAAA;ADuHR;AC7HI;EACI,eAAA;EACA,eAAA;EACA,OAAA;EACA,MAAA;ADyHR;ACrHI;;;;;EAOY,aAAA;ADqHhB;AC5HI;EAUY,gBAAA;EACA,qBAAA;ADqHhB;AChII;EAgBQ,aAAA;ADmHZ;AChHQ;EAEQ,aAAA;ADiHhB;ACtII;EA0BQ,cAAA;AD+GZ;ACzGA;EACI,eAAA;EACA,MAAA;EACA,OAAA;EACA,SAAA;EACA,UAAA;AD2GJ;AElSA;EACI,aAAA;AFoSJ;AEjSA;EACI,oBAAA;EACA,iCAAA;AFmSJ;AEhSA;EACI,gBAAA;AFkSJ;AG9SA;EACI,kBAAA;EACA,OAAA;EACA,QAAA;EACA,MAAA;EACA,SAAA;EACA,eAAA;EACA,WAAA;EACA,oBAAA;AHgTJ;AGxTA;EAUQ,kBAAA;EACA,QAAA;EACA,SAAA;EACA,uBAAA;EACA,YAAA;EACA,WAAA;EACA,aAAA;EACA,sBAAA;EACA,8BAAA;EACA,kBAAA;EACA,UAAA;EACA,oBAAA;AHiTR;AGhTQ;EACI,iCAAA;AHkTZ;AGhTQ;EACI;IACI,UAAA;IACA,mBAAA;EHkTd;EGhTU;IACI,UAAA;IACA,mBAAA;EHkTd;AACF;AGnVA;EAqCQ,kBAAA;EACA,QAAA;EACA,gBAAA;EACA,WAAA;EACA,kBAAA;EACA,eAAA;EACA,iBAAA;EACA,0CAAA;AHiTR;AG7VA;EA+CQ,aAAA;EACA,kBAAA;EACA,QAAA;EACA,SAAA;EACA,uBAAA;EACA,YAAA;EACA,WAAA;EACA,oBAAA;AHiTR;AGvWA;EAwDY,aAAA;AHkTZ;AG1WA;EA2DY,uDAAA;EACA,UAAA;EACA,yBAAA;AHkTZ;AI/WC;EDgEmB,qBAAA;AHkTpB;AIlXC;EDgEmB,qBAAA;AHqTpB;AIrXC;EDgEmB,qBAAA;AHwTpB;AIxXC;EDgEmB,qBAAA;AH2TpB;AI3XC;EDgEmB,qBAAA;AH8TpB;AI9XC;EDgEmB,qBAAA;AHiUpB;AIjYC;EDgEmB,qBAAA;AHoUpB;AGhUQ;EACI;IACI,YAAA;IACA,0BAAA;EHkUd;EGhUU;IACI,aAAA;IACA,0BAAA;EHkUd;EGhUU;IACI,aAAA;IACA,4BAAA;EHkUd;AACF;AKlZA;EACI,mEAAA;EACA,YAAA;EACA,WAAA;EACA,kBAAA;EACA,SAAA;EACA,yBAAA;ALoZJ;AKjZA;EACI,kBAAA;EACA,SAAA;EACA,OAAA;EACA,QAAA;EACA,YAAA;EACA,eAAA;EACA,yBAAA;KAAA,sBAAA;UAAA,iBAAA;EACA,yBAAA;ALmZJ;AKlZI;EAEQ,aAAA;ALmZZ;AKrZI;EAKQ,cAAA;ALmZZ;AKjaA;EAkBQ,cAAA;EACA,eAAA;EACA,kBAAA;EACA,YAAA;EACA,wBAAA;EACA,WAAA;ALkZR;AKjZQ;EAEQ,mBAAA;ALkZhB;AKpZQ;EAKQ,cAAA;EACA,UAAA;EACA,2BAAA;EACA,QAAA;EACA,WAAA;ALkZhB;AKnbA;EAqCY,WAAA;EACA,kBAAA;EACA,QAAA;EACA,UAAA;EACA,WAAA;EACA,kBAAA;EACA,sBAAA;EACA,kBAAA;EACA,2BAAA;EACA,gCAAA;ALiZZ;AKhZY;EAEQ,cAAA;ALiZpB;AK/YgB;EACI,UAAA;ALiZpB;AK/YgB;EACI,UAAA;ALiZpB;AKxcA;EA2DgB,aAAA;EACA,kBAAA;EACA,SAAA;EACA,UAAA;EACA,gBAAA;EACA,qCAAA;EACA,WAAA;EACA,kBAAA;EACA,eAAA;EACA,mBAAA;EACA,2BAAA;ALgZhB;AKrdA;EAyEY,kBAAA;EACA,gBAAA;EACA,oBAAA;EACA,aAAA;EACA,6BAAA;AL+YZ;AK5dA;EAgFY,kBAAA;EACA,WAAA;EACA,YAAA;EACA,UAAA;EACA,oBAAA;AL+YZ;AKneA;EA0FY,kBAAA;EACA,SAAA;EACA,UAAA;EACA,kBAAA;EACA,gBAAA;EACA,qCAAA;EACA,WAAA;EACA,eAAA;EACA,kBAAA;EACA,UAAA;EACA,oCAAA;EACA,iBAAA;EACA,kBAAA;EACA,UAAA;EACA,oBAAA;AL4YZ;AK7ZY;EACI,UAAA;AL+ZhB;AKvfA;EA2GY,kBAAA;EACA,WAAA;EACA,WAAA;EACA,oCAAA;EACA,eAAA;AL+YZ;AK9fA;EAiHgB,kBAAA;EACA,OAAA;EACA,MAAA;EACA,SAAA;EACA,oCAAA;EACA,WAAA;EACA,yBAAA;EACA,kBAAA;ALgZhB;AKxgBA;EA2HgB,kBAAA;EACA,OAAA;EACA,MAAA;EACA,SAAA;EACA,WAAA;EACA,kBAAA;ALgZhB;AKhhBA;EAkIoB,kBAAA;EACA,MAAA;EACA,UAAA;EACA,gBAAA;EACA,mBAAA;EACA,YAAA;EACA,WAAA;EACA,kBAAA;EACA,eAAA;EACA,gCAAA;EACA,mBAAA;ALiZpB;AK7hBA;EAkJQ,YAAA;EACA,kBAAA;EACA,SAAA;AL8YR;AK7YQ;EACI,aAAA;EACA,kBAAA;EACA,gCAAA;EACA,UAAA;EACA,YAAA;EACA,SAAA;EACA,UAAA;EACA,WAAA;EACA,WAAA;AL+YZ;AKxZQ;EAWQ,YAAA;ALgZhB;AK3ZQ;EAcQ,kBAAA;EACA,OAAA;EACA,MAAA;ALgZhB;AKhaQ;EAmBQ,kBAAA;EACA,QAAA;EACA,MAAA;ALgZhB;AKraQ;EAwBQ,kBAAA;EACA,iCAAA;EACA,YAAA;EACA,OAAA;EACA,uCAAA;EACA,kBAAA;EACA,uBAAA;EACA,eAAA;EACA,YAAA;EACA,gCAAA;EACA,mBAAA;ALgZhB;AK/YgB;EACI,mBAAA;ALiZpB;AKrbQ;EAuCY,aAAA;ALiZpB;AKxbQ;EA0CY,eAAA;ALiZpB;AK3bQ;EA6CY,eAAA;EACA,WAAA;EACA,iBAAA;ALiZpB;AKhcQ;EAkDY,YAAA;ALiZpB;AKncQ;EAoDgB,kBAAA;ALkZxB;AK/YwB;EAEQ,0BAAA;ALgZhC;AK7YwB;EAEQ,0BAAA;AL8YhC;AK5cQ;EAmEgB,UAAA;EACA,gBAAA;EACA,iBAAA;EACA,qBAAA;EACA,eAAA;EACA,WAAA;EACA,sBAAA;EACA,kBAAA;EACA,sBAAA;EACA,kBAAA;EACA,eAAA;AL4YxB;AKzdQ;EAgFgB,mBAAA;EACA,cAAA;AL4YxB;AK7dQ;EAqFY,YAAA;AL2YpB;AKheQ;EAuFgB,YAAA;EACA,YAAA;EACA,qBAAA;AL4YxB;AKreQ;EA4FgB,WAAA;EACA,YAAA;EACA,qBAAA;EACA,kBAAA;EACA,sBAAA;EACA,eAAA;AL4YxB;AK3YwB;EACI,0CAAA;AL6Y5B;AKhfQ;EAyGQ,aAAA;EACA,YAAA;EACA,iBAAA;EACA,eAAA;EACA,iBAAA;EACA,kBAAA;EACA,kBAAA;EACA,gBAAA;EACA,SAAA;EACA,YAAA;EACA,sBAAA;EACA,WAAA;EACA,WAAA;AL0YhB;AKzYgB;EACI,WAAA;EACA,YAAA;AL2YpB;AK7YgB;EACI,WAAA;EACA,YAAA;AL2YpB;AKzYgB;EACI,aAAA;AL2YpB;AKvYQ;EAEQ,YAAA;ALwYhB;AKrYQ;EACI,WAAA;ALuYZ;AKxYQ;EAGQ,YAAA;ALwYhB;AKpqBA;;EAiSY,iBAAA;EACA,WAAA;EACA,uCAAA;EACA,sBAAA;EACA,eAAA;EACA,eAAA;ALuYZ;AK7qBA;EAySY,qBAAA;EACA,UAAA;EACA,WAAA;EACA,kBAAA;EACA,iBAAA;EACA,WAAA;EACA,kBAAA;ALuYZ;AKtrBA;EAkTY,WAAA;EACA,YAAA;EACA,YAAA;EACA,6BAAA;EACA,aAAA;EACA,eAAA;EACA,sBAAA;EACA,sBAAA;EACA,qBAAA;ALuYZ;AKjsBA;EA4TgB,gCAAA;EACA,YAAA;ALwYhB;AKtYY;EAEQ,UAAA;ALuYpB;AKpYY;EACI,WAAA;EACA,WAAA;EACA,iBAAA;EACA,eAAA;ALsYhB;AKpYY;EACI,qBAAA;ALsYhB;AKpYY;EACI,kBAAA;ALsYhB;AKpYY;EACI,WAAA;ALsYhB;AKvtBA;EAqVY,kBAAA;EACA,qBAAA;EACA,eAAA;EACA,YAAA;ALqYZ;AKpYY;EAEQ,WAAA;ALqYpB;AKvYY;EAKQ,mBAAA;ALqYpB;AKlYY;EAEQ,WAAA;ALmYpB;AKrYY;EAKQ,mBAAA;ALmYpB;AKzuBA;EA0WgB,qBAAA;EACA,qBAAA;EACA,sBAAA;EACA,YAAA;ALkYhB;AK/uBA;EA+WoB,kBAAA;EACA,SAAA;EACA,QAAA;EACA,WAAA;EACA,gBAAA;EACA,gCAAA;ALmYpB;AKvvBA;EAsXwB,kBAAA;EACA,SAAA;EACA,OAAA;EACA,YAAA;EACA,yBAAA;EACA,kBAAA;ALoYxB;AK/vBA;EA6X4B,kBAAA;EACA,MAAA;EACA,UAAA;EACA,gBAAA;EACA,mBAAA;EACA,YAAA;EACA,WAAA;EACA,kBAAA;EACA,eAAA;EACA,gCAAA;EACA,mBAAA;ALqY5B;AK5wBA;EA8YY,qBAAA;EACA,YAAA;ALiYZ;AKhxBA;EAkZY,qBAAA;EACA,YAAA;ALiYZ;AKpxBA;EAqZgB,kBAAA;EACA,QAAA;EACA,YAAA;EACA,mBAAA;EACA,uBAAA;EAAA,kBAAA;EACA,gBAAA;EACA,gBAAA;EACA,kBAAA;EACA,iCAAA;EACA,cAAA;EACA,gCAAA;EACA,cAAA;EACA,UAAA;ALkYhB;AKjYgB;EACI,cAAA;ALmYpB;AKjYgB;EACI,mBAAA;ALmYpB;AKzyBA;EA0agB,YAAA;EACA,iBAAA;EACA,sBAAA;EACA,eAAA;EACA,kBAAA;ALkYhB;AKjYgB;EACI,0CAAA;ALmYpB;AKnzBA;EAqbY,qBAAA;EACA,YAAA;ALiYZ;AKvzBA;EAwbgB,kBAAA;EACA,QAAA;EACA,YAAA;EACA,mBAAA;EACA,YAAA;EACA,kBAAA;EACA,iCAAA;EACA,cAAA;EACA,gCAAA;EACA,gBAAA;EACA,UAAA;ALkYhB;AKjYgB;EACI,aAAA;ALmYpB;AKlYoB;EACI,cAAA;ALoYxB;AKjYgB;EACI,mBAAA;ALmYpB;AKjYgB;EACI,WAAA;EACA,kBAAA;ALmYpB;AKjYgB;EAEQ,aAAA;ALkYxB;AKpYgB;EAKQ,cAAA;ALkYxB;AKv1BA;;EA2dgB,YAAA;EACA,iBAAA;EACA,sBAAA;EACA,eAAA;EACA,kBAAA;ALgYhB;AK/XgB;;EACI,0CAAA;ALkYpB;AKn2BA;EAqegB,cAAA;ALiYhB;AKt2BA;EAueoB,eAAA;EACA,eAAA;ALkYpB;AKhYgB;EAEQ,aAAA;ALiYxB;AKnYgB;EAKQ,qBAAA;ALiYxB;AK9XgB;EAEQ,aAAA;AL+XxB;AKjYgB;EAKQ,qBAAA;AL+XxB;AKt3BA;EA2foB,eAAA;EACA,sBAAA;EACA,aAAA;EACA,sBAAA;EACA,YAAA;EACA,WAAA;AL8XpB;AK93BA;EAkgBwB,kBAAA;EACA,UAAA;EACA,WAAA;EACA,WAAA;EACA,gBAAA;EACA,gCAAA;AL+XxB;AKt4BA;EAygB4B,kBAAA;EACA,SAAA;EACA,OAAA;EACA,YAAA;EACA,yBAAA;EACA,gBAAA;EACA,kBAAA;ALgY5B;AK/4BA;EAihBgC,kBAAA;EACA,MAAA;EACA,UAAA;EACA,gBAAA;EACA,mBAAA;EACA,YAAA;EACA,WAAA;EACA,kBAAA;EACA,eAAA;EACA,gCAAA;EACA,gBAAA;ALiYhC;AK55BA;EAmiBY,qBAAA;EACA,YAAA;EACA,kBAAA;AL4XZ;AK3XY;EAEQ,cAAA;AL4XpB;AKp6BA;EA4iBgB,kBAAA;EACA,UAAA;EACA,UAAA;EACA,aAAA;AL2XhB;AK16BA;EAmjBY,kBAAA;EACA,qBAAA;EACA,YAAA;EACA,UAAA;AL0XZ;AKzXY;EAEQ,cAAA;AL0XpB;AK5XY;EAKQ,cAAA;AL0XpB;AKt7BA;EAgkBgB,aAAA;EACA,kBAAA;EACA,YAAA;EACA,WAAA;EACA,WAAA;EACA,oBAAA;ALyXhB;AK97BA;EAwkBgB,aAAA;EACA,eAAA;EACA,WAAA;EACA,kBAAA;EACA,iCAAA;EACA,cAAA;EACA,gCAAA;EACA,gBAAA;EACA,WAAA;EACA,kBAAA;ALyXhB;AK18BA;EAolBgB,YAAA;EACA,sBAAA;EACA,eAAA;EACA,iBAAA;ALyXhB;AKxXgB;EACI,0CAAA;AL0XpB;AKn9BA;EA8lBY,qBAAA;EACA,YAAA;ALwXZ;AKv9BA;EAkmBY,WAAA;EACA,eAAA;EACA,qBAAA;EACA,sBAAA;EACA,mBAAA;ALwXZ;AK99BA;EAymBY,WAAA;EACA,YAAA;EACA,kBAAA;EACA,YAAA;EACA,sBAAA;EACA,kBAAA;EACA,QAAA;EACA,WAAA;ALwXZ;AKx+BA;EAknBgB,aAAA;EACA,YAAA;EACA,aAAA;ALyXhB;AK7+BA;EAunBgB,qBAAA;EACA,kBAAA;EACA,iCAAA;EACA,yBAAA;EACA,YAAA;EACA,WAAA;EACA,mBAAA;EACA,sBAAA;EACA,eAAA;EACA,4BAAA;ALyXhB;AKz/BA;EAmoBgB,WAAA;EACA,kBAAA;EACA,cAAA;EACA,YAAA;EACA,WAAA;EACA,MAAA;EACA,OAAA;EACA,mBAAA;EACA,4BAAA;ALyXhB;AKpgCA;EA8oBgB,WAAA;EACA,kBAAA;EACA,cAAA;EACA,OAAA;EACA,MAAA;EACA,mBAAA;EACA,gBAAA;EACA,4BAAA;EACA,wCAAA;EACA,YAAA;EACA,WAAA;ALyXhB;AKjhCA;EA2pBgB,sCAAA;ALyXhB;AKphCA;EA8pBgB,WAAA;EACA,oCAAA;ALyXhB;AKxhCA;EAkqBgB,UAAA;ALyXhB;AKnXA;EACI,aAAA;EACA,WAAA;EACA,YAAA;EACA,YAAA;EACA,6BAAA;EACA,aAAA;EACA,eAAA;EACA,sBAAA;EAEA,SAAA;EACA,YAAA;EACA,kBAAA;EACA,SAAA;EACA,QAAA;EACA,gCAAA;ALoXJ;AMpjCA;EACI,kBAAA;EACA,OAAA;EACA,QAAA;EACA,MAAA;EACA,SAAA;EACA,eAAA;EACA,WAAA;ANsjCJ;AM7jCA;EASQ,qBAAA;EACA,oBAAA;EACA,yBAAA;KAAA,sBAAA;UAAA,iBAAA;EACA,eAAA;EACA,mBAAA;EACA,iDAAA;ANujCR;AMtjCQ;EACI,kBAAA;EACA,kBAAA;ANwjCZ;AMzkCA;EAqBQ,kBAAA;EACA,QAAA;EACA,2BAAA;ANujCR;AMtjCQ;EACI,sBAAA;EACA,yBAAA;EACA,iCAAA;EACA,4BAAA;ANwjCZ;AMrjCI;EACI;IACI,2BAAA;ENujCV;AACF;AMzlCA;;EAsCQ,kBAAA;EACA,WAAA;EACA,kBAAA;EACA,kBAAA;ANujCR;AMtjCQ;;EACI,uBAAA;EACA,gCAAA;EACA,iCAAA;EACA,4BAAA;ANyjCZ;AMtjCI;EACI;IACI,mBAAA;ENwjCV;EMtjCM;IACI,mBAAA;ENwjCV;AACF;AO/mCA;EACI,oBAAA;EACA,kBAAA;EACA,UAAA;EACA,SAAA;EACA,eAAA;EACA,gBAAA;APinCJ;AOvnCA;EAQQ,eAAA;EACA,gBAAA;EACA,gBAAA;APknCR;AQ5nCA;EACI,kBAAA;EACA,YAAA;EACA,kBAAA;EACA,kCAAA;EACA,cAAA;EACA,gBAAA;EACA,UAAA;EACA,aAAA;AR8nCJ;AQ7nCI;EACI,cAAA;AR+nCR;AQzoCA;EAaQ,YAAA;EACA,sBAAA;EACA,eAAA;AR+nCR;AQ9nCQ;EACI,0CAAA;ARgoCZ;AQjpCA;EAqBY,eAAA;EACA,iBAAA;EACA,WAAA;EACA,eAAA;EACA,qBAAA;EACA,sBAAA;EACA,WAAA;EACA,sBAAA;EACA,mBAAA;EACA,uBAAA;EACA,gBAAA;AR+nCZ;AQ9nCY;EACI,qBAAA;ARgoChB;AIjqCA;EACI,kBAAA;EACA,YAAA;EACA,UAAA;AJmqCJ;AItqCA;EAMQ,kBAAA;EACA,iCAAA;EACA,gCAAA;EACA,gBAAA;EACA,WAAA;EACA,cAAA;EACA,oBAAA;EACA,0CAAA;AJmqCR;AIhrCA;EAiBQ,4CAAA;AJkqCR;AI9pCA;EACI;IACI,UAAA;IACA,YAAA;IACA,aAAA;EJgqCN;EI9pCE;IACI,iBAAA;IACA,eAAA;IACA,eAAA;EJgqCN;AACF;AI7pCA;EACI;IACI,iBAAA;IACA,eAAA;IACA,eAAA;EJ+pCN;EI7pCE;IACI,eAAA;EJ+pCN;EI7pCE;IACI,YAAA;IACA,iBAAA;EJ+pCN;EI7pCE;IACI,UAAA;IACA,aAAA;IACA,YAAA;EJ+pCN;AACF;ASltCA;EACI,kBAAA;EACA,YAAA;EACA,UAAA;EACA,QAAA;EACA,kBAAA;EACA,WAAA;EACA,iDAAA;EACA,eAAA;ATotCJ;ASntCI;EACI,aAAA;ATqtCR;AU/tCA;EACI,kBAAA;EACA,MAAA;EACA,SAAA;EACA,OAAA;EACA,QAAA;EACA,UAAA;EACA,aAAA;AViuCJ;AUhuCI;EACI,cAAA;AVkuCR;AU9tCA;EACI,kBAAA;EACA,gBAAA;EACA,YAAA;EACA,WAAA;EACA,YAAA;AVguCJ;AUruCA;EAOQ,WAAA;EACA,YAAA;EACA,aAAA;AViuCR;AU1uCA;EAYQ,cAAA;AViuCR;AU7uCA;EAeQ,aAAA;AViuCR;AW7vCA;EACI,kBAAA;EACA,SAAA;EACA,UAAA;EACA,YAAA;EACA,iCAAA;EACA,aAAA;EACA,WAAA;EACA,eAAA;EACA,kBAAA;AX+vCJ;AW7vCI;EACI,aAAA;AX+vCR;AW3wCA;EAgBQ,eAAA;EACA,kBAAA;EACA,WAAA;EACA,SAAA;AX8vCR;AW1vCQ;EACI,qBAAA;EACA,sBAAA;EACA,iBAAA;EACA,mBAAA;EACA,uBAAA;EACA,gBAAA;AX4vCZ;AWzxCA;EAkCQ,YAAA;EACA,iBAAA;EACA,kBAAA;AX0vCR;AW9xCA;EAwCQ,YAAA;AXyvCR",sourcesContent:[`@keyframes my-face {
    2% {
        transform: translate(0, 1.5px) rotate(1.5deg);
    }
    4% {
        transform: translate(0, -1.5px) rotate(-0.5deg);
    }
    6% {
        transform: translate(0, 1.5px) rotate(-1.5deg);
    }
    8% {
        transform: translate(0, -1.5px) rotate(-1.5deg);
    }
    10% {
        transform: translate(0, 2.5px) rotate(1.5deg);
    }
    12% {
        transform: translate(0, -0.5px) rotate(1.5deg);
    }
    14% {
        transform: translate(0, -1.5px) rotate(1.5deg);
    }
    16% {
        transform: translate(0, -0.5px) rotate(-1.5deg);
    }
    18% {
        transform: translate(0, 0.5px) rotate(-1.5deg);
    }
    20% {
        transform: translate(0, -1.5px) rotate(2.5deg);
    }
    22% {
        transform: translate(0, 0.5px) rotate(-1.5deg);
    }
    24% {
        transform: translate(0, 1.5px) rotate(1.5deg);
    }
    26% {
        transform: translate(0, 0.5px) rotate(0.5deg);
    }
    28% {
        transform: translate(0, 0.5px) rotate(1.5deg);
    }
    30% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    32% {
        transform: translate(0, 1.5px) rotate(-0.5deg);
    }
    34% {
        transform: translate(0, 1.5px) rotate(-0.5deg);
    }
    36% {
        transform: translate(0, -1.5px) rotate(2.5deg);
    }
    38% {
        transform: translate(0, 1.5px) rotate(-1.5deg);
    }
    40% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    42% {
        transform: translate(0, 2.5px) rotate(-1.5deg);
    }
    44% {
        transform: translate(0, 1.5px) rotate(0.5deg);
    }
    46% {
        transform: translate(0, -1.5px) rotate(2.5deg);
    }
    48% {
        transform: translate(0, -0.5px) rotate(0.5deg);
    }
    50% {
        transform: translate(0, 0.5px) rotate(0.5deg);
    }
    52% {
        transform: translate(0, 2.5px) rotate(2.5deg);
    }
    54% {
        transform: translate(0, -1.5px) rotate(1.5deg);
    }
    56% {
        transform: translate(0, 2.5px) rotate(2.5deg);
    }
    58% {
        transform: translate(0, 0.5px) rotate(2.5deg);
    }
    60% {
        transform: translate(0, 2.5px) rotate(2.5deg);
    }
    62% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    64% {
        transform: translate(0, -0.5px) rotate(1.5deg);
    }
    66% {
        transform: translate(0, 1.5px) rotate(-0.5deg);
    }
    68% {
        transform: translate(0, -1.5px) rotate(-0.5deg);
    }
    70% {
        transform: translate(0, 1.5px) rotate(0.5deg);
    }
    72% {
        transform: translate(0, 2.5px) rotate(1.5deg);
    }
    74% {
        transform: translate(0, -0.5px) rotate(0.5deg);
    }
    76% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    78% {
        transform: translate(0, -0.5px) rotate(1.5deg);
    }
    80% {
        transform: translate(0, 1.5px) rotate(1.5deg);
    }
    82% {
        transform: translate(0, -0.5px) rotate(0.5deg);
    }
    84% {
        transform: translate(0, 1.5px) rotate(2.5deg);
    }
    86% {
        transform: translate(0, -1.5px) rotate(-1.5deg);
    }
    88% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    90% {
        transform: translate(0, 2.5px) rotate(-0.5deg);
    }
    92% {
        transform: translate(0, 0.5px) rotate(-0.5deg);
    }
    94% {
        transform: translate(0, 2.5px) rotate(0.5deg);
    }
    96% {
        transform: translate(0, -0.5px) rotate(1.5deg);
    }
    98% {
        transform: translate(0, -1.5px) rotate(-0.5deg);
    }
    0%,
    100% {
        transform: translate(0, 0) rotate(0deg);
    }
}`,`@import '../../node_modules/balloon-css/balloon.css';
@keyframes my-face {
  2% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  4% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  6% {
    transform: translate(0, 1.5px) rotate(-1.5deg);
  }
  8% {
    transform: translate(0, -1.5px) rotate(-1.5deg);
  }
  10% {
    transform: translate(0, 2.5px) rotate(1.5deg);
  }
  12% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  14% {
    transform: translate(0, -1.5px) rotate(1.5deg);
  }
  16% {
    transform: translate(0, -0.5px) rotate(-1.5deg);
  }
  18% {
    transform: translate(0, 0.5px) rotate(-1.5deg);
  }
  20% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  22% {
    transform: translate(0, 0.5px) rotate(-1.5deg);
  }
  24% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  26% {
    transform: translate(0, 0.5px) rotate(0.5deg);
  }
  28% {
    transform: translate(0, 0.5px) rotate(1.5deg);
  }
  30% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  32% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  34% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  36% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  38% {
    transform: translate(0, 1.5px) rotate(-1.5deg);
  }
  40% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  42% {
    transform: translate(0, 2.5px) rotate(-1.5deg);
  }
  44% {
    transform: translate(0, 1.5px) rotate(0.5deg);
  }
  46% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  48% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  50% {
    transform: translate(0, 0.5px) rotate(0.5deg);
  }
  52% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  54% {
    transform: translate(0, -1.5px) rotate(1.5deg);
  }
  56% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  58% {
    transform: translate(0, 0.5px) rotate(2.5deg);
  }
  60% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  62% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  64% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  66% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  68% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  70% {
    transform: translate(0, 1.5px) rotate(0.5deg);
  }
  72% {
    transform: translate(0, 2.5px) rotate(1.5deg);
  }
  74% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  76% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  78% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  80% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  82% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  84% {
    transform: translate(0, 1.5px) rotate(2.5deg);
  }
  86% {
    transform: translate(0, -1.5px) rotate(-1.5deg);
  }
  88% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  90% {
    transform: translate(0, 2.5px) rotate(-0.5deg);
  }
  92% {
    transform: translate(0, 0.5px) rotate(-0.5deg);
  }
  94% {
    transform: translate(0, 2.5px) rotate(0.5deg);
  }
  96% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  98% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  0%,
  100% {
    transform: translate(0, 0) rotate(0deg);
  }
}
.dplayer {
  position: relative;
  overflow: hidden;
  user-select: none;
  line-height: 1;
}
.dplayer * {
  box-sizing: content-box;
}
.dplayer svg {
  width: 100%;
  height: 100%;
}
.dplayer svg path,
.dplayer svg circle {
  fill: #fff;
}
.dplayer:-webkit-full-screen {
  width: 100%;
  height: 100%;
  background: #000;
  position: fixed;
  z-index: 100000;
  left: 0;
  top: 0;
  margin: 0;
  padding: 0;
  transform: translate(0, 0);
}
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-showdan,
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-danmaku,
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-danunlimit {
  display: none;
}
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-comment {
  display: none;
}
.dplayer.dplayer-no-danmaku .dplayer-danmaku {
  display: none;
}
.dplayer.dplayer-live .dplayer-time {
  display: none;
}
.dplayer.dplayer-live .dplayer-bar-wrap {
  display: none;
}
.dplayer.dplayer-live .dplayer-setting-speed {
  display: none;
}
.dplayer.dplayer-live .dplayer-setting-loop {
  display: none;
}
.dplayer.dplayer-live.dplayer-no-danmaku .dplayer-setting {
  display: none;
}
.dplayer.dplayer-arrow .dplayer-danmaku {
  font-size: 18px;
}
.dplayer.dplayer-arrow .dplayer-icon {
  margin: 0 -3px;
}
.dplayer.dplayer-playing .dplayer-danmaku .dplayer-danmaku-move {
  animation-play-state: running;
}
@media (min-width: 900px) {
  .dplayer.dplayer-playing .dplayer-controller-mask {
    opacity: 0;
  }
  .dplayer.dplayer-playing .dplayer-controller {
    opacity: 0;
  }
  .dplayer.dplayer-playing:hover .dplayer-controller-mask {
    opacity: 1;
  }
  .dplayer.dplayer-playing:hover .dplayer-controller {
    opacity: 1;
  }
}
.dplayer.dplayer-loading .dplayer-bezel .diplayer-loading-icon {
  display: block;
}
.dplayer.dplayer-loading .dplayer-danmaku,
.dplayer.dplayer-paused .dplayer-danmaku,
.dplayer.dplayer-loading .dplayer-danmaku-move,
.dplayer.dplayer-paused .dplayer-danmaku-move {
  animation-play-state: paused;
}
.dplayer.dplayer-hide-controller {
  cursor: none;
}
.dplayer.dplayer-hide-controller .dplayer-controller-mask {
  opacity: 0;
  transform: translateY(100%);
}
.dplayer.dplayer-hide-controller .dplayer-controller {
  opacity: 0;
  transform: translateY(100%);
}
.dplayer.dplayer-show-controller .dplayer-controller-mask {
  opacity: 1;
}
.dplayer.dplayer-show-controller .dplayer-controller {
  opacity: 1;
}
.dplayer.dplayer-fulled {
  position: fixed;
  z-index: 100000;
  left: 0;
  top: 0;
  width: 100% !important;
  height: 100% !important;
}
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-volume,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-camera-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-airplay-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-chromecast-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-play-icon {
  display: none;
}
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-full .dplayer-full-in-icon {
  position: static;
  display: inline-block;
}
.dplayer.dplayer-mobile .dplayer-bar-time {
  display: none;
}
.dplayer.dplayer-mobile.dplayer-hide-controller .dplayer-mobile-play {
  display: none;
}
.dplayer.dplayer-mobile .dplayer-mobile-play {
  display: block;
}
.dplayer-web-fullscreen-fix {
  position: fixed;
  top: 0;
  left: 0;
  margin: 0;
  padding: 0;
}
[data-balloon]:before {
  display: none;
}
[data-balloon]:after {
  padding: 0.3em 0.7em;
  background: rgba(17, 17, 17, 0.7);
}
[data-balloon][data-balloon-pos="up"]:after {
  margin-bottom: 0;
}
.dplayer-bezel {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  font-size: 22px;
  color: #fff;
  pointer-events: none;
}
.dplayer-bezel .dplayer-bezel-icon {
  position: absolute;
  top: 50%;
  left: 50%;
  margin: -26px 0 0 -26px;
  height: 52px;
  width: 52px;
  padding: 12px;
  box-sizing: border-box;
  background: rgba(0, 0, 0, 0.5);
  border-radius: 50%;
  opacity: 0;
  pointer-events: none;
}
.dplayer-bezel .dplayer-bezel-icon.dplayer-bezel-transition {
  animation: bezel-hide 0.5s linear;
}
@keyframes bezel-hide {
  from {
    opacity: 1;
    transform: scale(1);
  }
  to {
    opacity: 0;
    transform: scale(2);
  }
}
.dplayer-bezel .dplayer-danloading {
  position: absolute;
  top: 50%;
  margin-top: -7px;
  width: 100%;
  text-align: center;
  font-size: 14px;
  line-height: 14px;
  animation: my-face 5s infinite ease-in-out;
}
.dplayer-bezel .diplayer-loading-icon {
  display: none;
  position: absolute;
  top: 50%;
  left: 50%;
  margin: -18px 0 0 -18px;
  height: 36px;
  width: 36px;
  pointer-events: none;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-hide {
  display: none;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot {
  animation: diplayer-loading-dot-fade 0.8s ease infinite;
  opacity: 0;
  transform-origin: 4px 4px;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-1 {
  animation-delay: 0.1s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-2 {
  animation-delay: 0.2s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-3 {
  animation-delay: 0.3s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-4 {
  animation-delay: 0.4s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-5 {
  animation-delay: 0.5s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-6 {
  animation-delay: 0.6s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-7 {
  animation-delay: 0.7s;
}
@keyframes diplayer-loading-dot-fade {
  0% {
    opacity: 0.7;
    transform: scale(1.2, 1.2);
  }
  50% {
    opacity: 0.25;
    transform: scale(0.9, 0.9);
  }
  to {
    opacity: 0.25;
    transform: scale(0.85, 0.85);
  }
}
.dplayer-controller-mask {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAADGCAYAAAAT+OqFAAAAdklEQVQoz42QQQ7AIAgEF/T/D+kbq/RWAlnQyyazA4aoAB4FsBSA/bFjuF1EOL7VbrIrBuusmrt4ZZORfb6ehbWdnRHEIiITaEUKa5EJqUakRSaEYBJSCY2dEstQY7AuxahwXFrvZmWl2rh4JZ07z9dLtesfNj5q0FU3A5ObbwAAAABJRU5ErkJggg==) repeat-x bottom;
  height: 98px;
  width: 100%;
  position: absolute;
  bottom: 0;
  transition: all 0.3s ease;
}
.dplayer-controller {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 41px;
  padding: 0 20px;
  user-select: none;
  transition: all 0.3s ease;
}
.dplayer-controller.dplayer-controller-comment .dplayer-icons {
  display: none;
}
.dplayer-controller.dplayer-controller-comment .dplayer-icons.dplayer-comment-box {
  display: block;
}
.dplayer-controller .dplayer-bar-wrap {
  padding: 5px 0;
  cursor: pointer;
  position: absolute;
  bottom: 33px;
  width: calc(100% - 40px);
  height: 3px;
}
.dplayer-controller .dplayer-bar-wrap:hover .dplayer-bar .dplayer-played .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-bar-wrap:hover .dplayer-highlight {
  display: block;
  width: 8px;
  transform: translateX(-4px);
  top: 4px;
  height: 40%;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight {
  z-index: 12;
  position: absolute;
  top: 5px;
  width: 6px;
  height: 20%;
  border-radius: 6px;
  background-color: #fff;
  text-align: center;
  transform: translateX(-3px);
  transition: all 0.2s ease-in-out;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover .dplayer-highlight-text {
  display: block;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover ~ .dplayer-bar-preview {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover ~ .dplayer-bar-time {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight .dplayer-highlight-text {
  display: none;
  position: absolute;
  left: 50%;
  top: -24px;
  padding: 5px 8px;
  background-color: rgba(0, 0, 0, 0.62);
  color: #fff;
  border-radius: 4px;
  font-size: 12px;
  white-space: nowrap;
  transform: translateX(-50%);
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-preview {
  position: absolute;
  background: #fff;
  pointer-events: none;
  display: none;
  background-size: 16000px 100%;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-preview-canvas {
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: 1;
  pointer-events: none;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-time {
  position: absolute;
  left: 0px;
  top: -20px;
  border-radius: 4px;
  padding: 5px 7px;
  background-color: rgba(0, 0, 0, 0.62);
  color: #fff;
  font-size: 12px;
  text-align: center;
  opacity: 1;
  transition: opacity 0.1s ease-in-out;
  word-wrap: normal;
  word-break: normal;
  z-index: 2;
  pointer-events: none;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-time.hidden {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar {
  position: relative;
  height: 3px;
  width: 100%;
  background: rgba(255, 255, 255, 0.2);
  cursor: pointer;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-loaded {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  background: rgba(255, 255, 255, 0.4);
  height: 3px;
  transition: all 0.5s ease;
  will-change: width;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-played {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  height: 3px;
  will-change: width;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-played .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons {
  height: 38px;
  position: absolute;
  bottom: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box {
  display: none;
  position: absolute;
  transition: all 0.3s ease-in-out;
  z-index: 2;
  height: 38px;
  bottom: 0;
  left: 20px;
  right: 20px;
  color: #fff;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-icon {
  padding: 7px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-icon {
  position: absolute;
  left: 0;
  top: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-send-icon {
  position: absolute;
  right: 0;
  top: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box {
  position: absolute;
  background: rgba(28, 28, 28, 0.9);
  bottom: 41px;
  left: 0;
  box-shadow: 0 0 25px rgba(0, 0, 0, 0.3);
  border-radius: 4px;
  padding: 10px 10px 16px;
  font-size: 14px;
  width: 204px;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box.dplayer-comment-setting-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box input[type=radio] {
  display: none;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box label {
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-title {
  font-size: 13px;
  color: #fff;
  line-height: 30px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type {
  font-size: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type .dplayer-comment-setting-title {
  margin-bottom: 6px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type label:nth-child(2) span {
  border-radius: 4px 0 0 4px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type label:nth-child(4) span {
  border-radius: 0 4px 4px 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type span {
  width: 33%;
  padding: 4px 6px;
  line-height: 16px;
  display: inline-block;
  font-size: 12px;
  color: #fff;
  border: 1px solid #fff;
  margin-right: -1px;
  box-sizing: border-box;
  text-align: center;
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type input:checked + span {
  background: #E4E4E6;
  color: #1c1c1c;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color {
  font-size: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color label {
  font-size: 0;
  padding: 6px;
  display: inline-block;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color span {
  width: 22px;
  height: 22px;
  display: inline-block;
  border-radius: 50%;
  box-sizing: border-box;
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color span:hover {
  animation: my-face 5s infinite ease-in-out;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input {
  outline: none;
  border: none;
  padding: 8px 31px;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  border-radius: 4px;
  background: none;
  margin: 0;
  height: 100%;
  box-sizing: border-box;
  width: 100%;
  color: #fff;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::placeholder {
  color: #fff;
  opacity: 0.8;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::-ms-clear {
  display: none;
}
.dplayer-controller .dplayer-icons.dplayer-icons-left .dplayer-icon {
  padding: 7px;
}
.dplayer-controller .dplayer-icons.dplayer-icons-right {
  right: 20px;
}
.dplayer-controller .dplayer-icons.dplayer-icons-right .dplayer-icon {
  padding: 8px;
}
.dplayer-controller .dplayer-icons .dplayer-time,
.dplayer-controller .dplayer-icons .dplayer-live-badge {
  line-height: 38px;
  color: #eee;
  text-shadow: 0 0 2px rgba(0, 0, 0, 0.5);
  vertical-align: middle;
  font-size: 13px;
  cursor: default;
}
.dplayer-controller .dplayer-icons .dplayer-live-dot {
  display: inline-block;
  width: 6px;
  height: 6px;
  vertical-align: 4%;
  margin-right: 5px;
  content: '';
  border-radius: 6px;
}
.dplayer-controller .dplayer-icons .dplayer-icon {
  width: 40px;
  height: 100%;
  border: none;
  background-color: transparent;
  outline: none;
  cursor: pointer;
  vertical-align: middle;
  box-sizing: border-box;
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-icon .dplayer-icon-content {
  transition: all 0.2s ease-in-out;
  opacity: 0.8;
}
.dplayer-controller .dplayer-icons .dplayer-icon:hover .dplayer-icon-content {
  opacity: 1;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-quality-icon {
  color: #fff;
  width: auto;
  line-height: 22px;
  font-size: 14px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-comment-icon {
  padding: 10px 9px 9px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-setting-icon {
  padding-top: 8.5px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-volume-icon {
  width: 43px;
}
.dplayer-controller .dplayer-icons .dplayer-volume {
  position: relative;
  display: inline-block;
  cursor: pointer;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-volume:hover .dplayer-volume-bar-wrap .dplayer-volume-bar {
  width: 45px;
}
.dplayer-controller .dplayer-icons .dplayer-volume:hover .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-volume.dplayer-volume-active .dplayer-volume-bar-wrap .dplayer-volume-bar {
  width: 45px;
}
.dplayer-controller .dplayer-icons .dplayer-volume.dplayer-volume-active .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap {
  display: inline-block;
  margin: 0 10px 0 -5px;
  vertical-align: middle;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar {
  position: relative;
  top: 17px;
  width: 0;
  height: 3px;
  background: #aaa;
  transition: all 0.3s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 100%;
  transition: all 0.1s ease;
  will-change: width;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons .dplayer-subtitle-btn {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box {
  position: absolute;
  right: 0;
  bottom: 50px;
  transform: scale(0);
  width: fit-content;
  max-width: 240px;
  min-width: 120px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 7px 0;
  transition: all 0.3s ease-in-out;
  overflow: auto;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box.dplayer-subtitles-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box.dplayer-subtitles-box-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-item {
  height: 30px;
  padding: 5px 10px;
  box-sizing: border-box;
  cursor: pointer;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-setting {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box {
  position: absolute;
  right: 0;
  bottom: 50px;
  transform: scale(0);
  width: 150px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 7px 0;
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box > div {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box > div.dplayer-setting-origin-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-narrow {
  width: 70px;
  text-align: center;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-speed .dplayer-setting-origin-panel {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-speed .dplayer-setting-speed-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-item,
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-speed-item {
  height: 30px;
  padding: 5px 10px;
  box-sizing: border-box;
  cursor: pointer;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-item:hover,
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-speed-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku {
  padding: 5px 0;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-label {
  padding: 0 10px;
  display: inline;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku:hover .dplayer-label {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku:hover .dplayer-danmaku-bar-wrap {
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-label {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-danmaku-bar-wrap {
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap {
  padding: 0 10px;
  box-sizing: border-box;
  display: none;
  vertical-align: middle;
  height: 100%;
  width: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar {
  position: relative;
  top: 8.5px;
  width: 100%;
  height: 3px;
  background: #fff;
  transition: all 0.3s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar .dplayer-danmaku-bar-inner {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 100%;
  transition: all 0.1s ease;
  background: #aaa;
  will-change: width;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar .dplayer-danmaku-bar-inner .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  background: #aaa;
}
.dplayer-controller .dplayer-icons .dplayer-full {
  display: inline-block;
  height: 100%;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-full:hover .dplayer-full-in-icon {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-full .dplayer-full-in-icon {
  position: absolute;
  top: -30px;
  z-index: 1;
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-quality {
  position: relative;
  display: inline-block;
  height: 100%;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-quality:hover .dplayer-quality-list {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-quality:hover .dplayer-quality-mask {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-mask {
  display: none;
  position: absolute;
  bottom: 38px;
  left: -18px;
  width: 80px;
  padding-bottom: 12px;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-list {
  display: none;
  font-size: 12px;
  width: 80px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 5px 0;
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  color: #fff;
  text-align: center;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-item {
  height: 25px;
  box-sizing: border-box;
  cursor: pointer;
  line-height: 25px;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-comment {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-label {
  color: #eee;
  font-size: 13px;
  display: inline-block;
  vertical-align: middle;
  white-space: nowrap;
}
.dplayer-controller .dplayer-icons .dplayer-toggle {
  width: 32px;
  height: 20px;
  text-align: center;
  font-size: 0;
  vertical-align: middle;
  position: absolute;
  top: 5px;
  right: 10px;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input {
  max-height: 0;
  max-width: 0;
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label {
  display: inline-block;
  position: relative;
  box-shadow: #dfdfdf 0 0 0 0 inset;
  border: 1px solid #dfdfdf;
  height: 20px;
  width: 32px;
  border-radius: 10px;
  box-sizing: border-box;
  cursor: pointer;
  transition: 0.2s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label:before {
  content: "";
  position: absolute;
  display: block;
  height: 18px;
  width: 18px;
  top: 0;
  left: 0;
  border-radius: 15px;
  transition: 0.2s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label:after {
  content: "";
  position: absolute;
  display: block;
  left: 0;
  top: 0;
  border-radius: 15px;
  background: #fff;
  transition: 0.2s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
  height: 18px;
  width: 18px;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label {
  border-color: rgba(255, 255, 255, 0.5);
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label:before {
  width: 30px;
  background: rgba(255, 255, 255, 0.5);
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label:after {
  left: 12px;
}
.dplayer-mobile-play {
  display: none;
  width: 50px;
  height: 50px;
  border: none;
  background-color: transparent;
  outline: none;
  cursor: pointer;
  box-sizing: border-box;
  bottom: 0;
  opacity: 0.8;
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
}
.dplayer-danmaku {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  font-size: 22px;
  color: #fff;
}
.dplayer-danmaku .dplayer-danmaku-item {
  display: inline-block;
  pointer-events: none;
  user-select: none;
  cursor: default;
  white-space: nowrap;
  text-shadow: 0.5px 0.5px 0.5px rgba(0, 0, 0, 0.5);
}
.dplayer-danmaku .dplayer-danmaku-item--demo {
  position: absolute;
  visibility: hidden;
}
.dplayer-danmaku .dplayer-danmaku-right {
  position: absolute;
  right: 0;
  transform: translateX(100%);
}
.dplayer-danmaku .dplayer-danmaku-right.dplayer-danmaku-move {
  will-change: transform;
  animation-name: 'danmaku';
  animation-timing-function: linear;
  animation-play-state: paused;
}
@keyframes danmaku {
  from {
    transform: translateX(100%);
  }
}
.dplayer-danmaku .dplayer-danmaku-top,
.dplayer-danmaku .dplayer-danmaku-bottom {
  position: absolute;
  width: 100%;
  text-align: center;
  visibility: hidden;
}
.dplayer-danmaku .dplayer-danmaku-top.dplayer-danmaku-move,
.dplayer-danmaku .dplayer-danmaku-bottom.dplayer-danmaku-move {
  will-change: visibility;
  animation-name: 'danmaku-center';
  animation-timing-function: linear;
  animation-play-state: paused;
}
@keyframes danmaku-center {
  from {
    visibility: visible;
  }
  to {
    visibility: visible;
  }
}
.dplayer-logo {
  pointer-events: none;
  position: absolute;
  left: 20px;
  top: 20px;
  max-width: 50px;
  max-height: 50px;
}
.dplayer-logo img {
  max-width: 100%;
  max-height: 100%;
  background: none;
}
.dplayer-menu {
  position: absolute;
  width: 170px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.85);
  padding: 5px 0;
  overflow: hidden;
  z-index: 3;
  display: none;
}
.dplayer-menu.dplayer-menu-show {
  display: block;
}
.dplayer-menu .dplayer-menu-item {
  height: 30px;
  box-sizing: border-box;
  cursor: pointer;
}
.dplayer-menu .dplayer-menu-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-menu .dplayer-menu-item a {
  padding: 0 10px;
  line-height: 30px;
  color: #eee;
  font-size: 13px;
  display: inline-block;
  vertical-align: middle;
  width: 100%;
  box-sizing: border-box;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
.dplayer-menu .dplayer-menu-item a:hover {
  text-decoration: none;
}
.dplayer-notice-list {
  position: absolute;
  bottom: 60px;
  left: 20px;
}
.dplayer-notice-list .dplayer-notice {
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  color: #fff;
  display: table;
  pointer-events: none;
  animation: showNotice 0.3s ease 1 forwards;
}
.dplayer-notice-list .remove-notice {
  animation: removeNotice 0.3s ease 1 forwards;
}
@keyframes showNotice {
  from {
    padding: 0;
    font-size: 0;
    margin-top: 0;
  }
  to {
    padding: 7px 20px;
    font-size: 14px;
    margin-top: 5px;
  }
}
@keyframes removeNotice {
  0% {
    padding: 7px 20px;
    font-size: 14px;
    margin-top: 5px;
  }
  20% {
    font-size: 12px;
  }
  21% {
    font-size: 0;
    padding: 7px 10px;
  }
  100% {
    padding: 0;
    margin-top: 0;
    font-size: 0;
  }
}
.dplayer-subtitle {
  position: absolute;
  bottom: 40px;
  width: 90%;
  left: 5%;
  text-align: center;
  color: #fff;
  text-shadow: 0.5px 0.5px 0.5px rgba(0, 0, 0, 0.5);
  font-size: 20px;
}
.dplayer-subtitle.dplayer-subtitle-hide {
  display: none;
}
.dplayer-mask {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 1;
  display: none;
}
.dplayer-mask.dplayer-mask-show {
  display: block;
}
.dplayer-video-wrap {
  position: relative;
  background: #000;
  font-size: 0;
  width: 100%;
  height: 100%;
}
.dplayer-video-wrap .dplayer-video {
  width: 100%;
  height: 100%;
  display: none;
}
.dplayer-video-wrap .dplayer-video-current {
  display: block;
}
.dplayer-video-wrap .dplayer-video-prepare {
  display: none;
}
.dplayer-info-panel {
  position: absolute;
  top: 10px;
  left: 10px;
  width: 400px;
  background: rgba(28, 28, 28, 0.8);
  padding: 10px;
  color: #fff;
  font-size: 12px;
  border-radius: 2px;
}
.dplayer-info-panel-hide {
  display: none;
}
.dplayer-info-panel .dplayer-info-panel-close {
  cursor: pointer;
  position: absolute;
  right: 10px;
  top: 10px;
}
.dplayer-info-panel .dplayer-info-panel-item > span {
  display: inline-block;
  vertical-align: middle;
  line-height: 15px;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
.dplayer-info-panel .dplayer-info-panel-item-title {
  width: 100px;
  text-align: right;
  margin-right: 10px;
}
.dplayer-info-panel .dplayer-info-panel-item-data {
  width: 260px;
}
`,`.dplayer {
    position: relative;
    overflow: hidden;
    user-select: none;
    line-height: 1;

    * {
        box-sizing: content-box;
    }

    svg {
        width: 100%;
        height: 100%;

        path,
        circle {
            fill: #fff;
        }
    }

    &:-webkit-full-screen {
        width: 100%;
        height: 100%;
        background: #000;
        position: fixed;
        z-index: 100000;
        left: 0;
        top: 0;
        margin: 0;
        padding: 0;
        transform: translate(0, 0);
        
    }

    &.dplayer-no-danmaku {
        .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box {
            .dplayer-setting-showdan,
            .dplayer-setting-danmaku,
            .dplayer-setting-danunlimit {
                display: none;
            }
        }

        .dplayer-controller .dplayer-icons .dplayer-comment {
            display: none;
        }

        .dplayer-danmaku {
            display: none;
        }
    }

    &.dplayer-live {
        .dplayer-time {
            display: none;
        }
        .dplayer-bar-wrap {
            display: none;
        }
        .dplayer-setting-speed {
            display: none;
        }
        .dplayer-setting-loop {
            display: none;
        }

        &.dplayer-no-danmaku {
            .dplayer-setting {
                display: none;
            }
        }
    }

    &.dplayer-arrow {
        .dplayer-danmaku {
            font-size: 18px;
        }
        .dplayer-icon {
            margin: 0 -3px;
        }
    }

    &.dplayer-playing {
        .dplayer-danmaku .dplayer-danmaku-move {
            animation-play-state: running;
        }

        @media (min-width: 900px) {
            .dplayer-controller-mask {
                opacity: 0;
            }
            .dplayer-controller {
                opacity: 0;
            }

            &:hover {
                .dplayer-controller-mask {
                    opacity: 1;
                }
                .dplayer-controller {
                    opacity: 1;
                }
            }
        }
    }

    &.dplayer-loading {
        .dplayer-bezel .diplayer-loading-icon {
            display: block;
        }
    }

    &.dplayer-loading,
    &.dplayer-paused {
        .dplayer-danmaku,
        .dplayer-danmaku-move {
            animation-play-state: paused;
        }
    }

    &.dplayer-hide-controller {
        cursor: none;

        .dplayer-controller-mask {
            opacity: 0;
            transform: translateY(100%);
        }
        .dplayer-controller {
            opacity: 0;
            transform: translateY(100%);
        }
    }
    &.dplayer-show-controller {
        .dplayer-controller-mask {
            opacity: 1;
        }
        .dplayer-controller {
            opacity: 1;
        }
    }
    &.dplayer-fulled {
        position: fixed;
        z-index: 100000;
        left: 0;
        top: 0;
        width: 100% !important;
        height: 100% !important;
    }
    &.dplayer-mobile {
        .dplayer-controller .dplayer-icons {
            .dplayer-volume,
            .dplayer-camera-icon,
            .dplayer-airplay-icon,
            .dplayer-chromecast-icon,
            .dplayer-play-icon {
                display: none;
            }
            .dplayer-full .dplayer-full-in-icon {
                position: static;
                display: inline-block;
            }
        }

        .dplayer-bar-time {
            display: none;
        }

        &.dplayer-hide-controller {
            .dplayer-mobile-play {
                display: none;
            }
        }

        .dplayer-mobile-play {
            display: block;
        }
    }
}

// To hide scroll bar, apply this class to <body>
.dplayer-web-fullscreen-fix {
    position: fixed;
    top: 0;
    left: 0;
    margin: 0;
    padding: 0;
}
`,`@import '../../node_modules/balloon-css/balloon.css';

[data-balloon]:before {
    display: none;
}

[data-balloon]:after {
    padding: 0.3em 0.7em;
    background: rgba(17, 17, 17, 0.7);
}

[data-balloon][data-balloon-pos="up"]:after {
    margin-bottom: 0;
}`,`.dplayer-bezel {
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    font-size: 22px;
    color: #fff;
    pointer-events: none;
    .dplayer-bezel-icon {
        position: absolute;
        top: 50%;
        left: 50%;
        margin: -26px 0 0 -26px;
        height: 52px;
        width: 52px;
        padding: 12px;
        box-sizing: border-box;
        background: rgba(0, 0, 0, .5);
        border-radius: 50%;
        opacity: 0;
        pointer-events: none;
        &.dplayer-bezel-transition {
            animation: bezel-hide .5s linear;
        }
        @keyframes bezel-hide {
            from {
                opacity: 1;
                transform: scale(1);
            }
            to {
                opacity: 0;
                transform: scale(2);
            }
        }
    }
    .dplayer-danloading {
        position: absolute;
        top: 50%;
        margin-top: -7px;
        width: 100%;
        text-align: center;
        font-size: 14px;
        line-height: 14px;
        animation: my-face 5s infinite ease-in-out;
    }
    .diplayer-loading-icon {
        display: none;
        position: absolute;
        top: 50%;
        left: 50%;
        margin: -18px 0 0 -18px;
        height: 36px;
        width: 36px;
        pointer-events: none;
        .diplayer-loading-hide {
            display: none;
        }
        .diplayer-loading-dot {
            animation: diplayer-loading-dot-fade .8s ease infinite;
            opacity: 0;
            transform-origin: 4px 4px;
            each(range(7), {
                &.diplayer-loading-dot-@{value} {
                    animation-delay: (@value * 0.1s);
                }
            });
        }
        @keyframes diplayer-loading-dot-fade {
            0% {
                opacity: .7;
                transform: scale(1.2, 1.2)
            }
            50% {
                opacity: .25;
                transform: scale(.9, .9)
            }
            to {
                opacity: .25;
                transform: scale(.85, .85)
            }
        }
    }
}`,`.dplayer-notice-list{
    position: absolute;
    bottom: 60px;
    left: 20px;

    .dplayer-notice {
        border-radius: 2px;
        background: rgba(28, 28, 28, 0.9);
        transition: all .3s ease-in-out;
        overflow: hidden;
        color: #fff;
        display: table;
        pointer-events: none;
        animation: showNotice .3s ease 1 forwards;
    }

    .remove-notice{
        animation: removeNotice .3s ease 1 forwards;
    }
}

@keyframes showNotice {
    from {
        padding: 0;
        font-size: 0;
        margin-top: 0;
    }
    to {
        padding: 7px 20px;
        font-size: 14px;
        margin-top: 5px;
    }
}

@keyframes removeNotice {
    0%{
        padding: 7px 20px;
        font-size: 14px;
        margin-top: 5px;
    }
    20%{
        font-size: 12px;
    }
    21%{
        font-size: 0;
        padding: 7px 10px;
    }
    100%{
        padding: 0;
        margin-top: 0;
        font-size: 0;
    }
}
`,`.dplayer-controller-mask {
    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAADGCAYAAAAT+OqFAAAAdklEQVQoz42QQQ7AIAgEF/T/D+kbq/RWAlnQyyazA4aoAB4FsBSA/bFjuF1EOL7VbrIrBuusmrt4ZZORfb6ehbWdnRHEIiITaEUKa5EJqUakRSaEYBJSCY2dEstQY7AuxahwXFrvZmWl2rh4JZ07z9dLtesfNj5q0FU3A5ObbwAAAABJRU5ErkJggg==) repeat-x bottom;
    height: 98px;
    width: 100%;
    position: absolute;
    bottom: 0;
    transition: all 0.3s ease;
}

.dplayer-controller {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 41px;
    padding: 0 20px;
    user-select: none;
    transition: all 0.3s ease;
    &.dplayer-controller-comment {
        .dplayer-icons {
            display: none;
        }
        .dplayer-icons.dplayer-comment-box {
            display: block;
        }
    }
    .dplayer-bar-wrap {
        padding: 5px 0;
        cursor: pointer;
        position: absolute;
        bottom: 33px;
        width: calc(100% - 40px);
        height: 3px;
        &:hover {
            .dplayer-bar .dplayer-played .dplayer-thumb {
                transform: scale(1);
            }
            .dplayer-highlight {
                display: block;
                width: 8px;
                transform: translateX(-4px);
                top: 4px;
                height: 40%;
            }
        }
        .dplayer-highlight {
            z-index: 12;
            position: absolute;
            top: 5px;
            width: 6px;
            height: 20%;
            border-radius: 6px;
            background-color: #fff;
            text-align: center;
            transform: translateX(-3px);
            transition: all .2s ease-in-out;
            &:hover {
                .dplayer-highlight-text {
                    display: block;
                }
                &~.dplayer-bar-preview {
                    opacity: 0;
                }
                &~.dplayer-bar-time {
                    opacity: 0;
                }
            }
            .dplayer-highlight-text {
                display: none;
                position: absolute;
                left: 50%;
                top: -24px;
                padding: 5px 8px;
                background-color: rgba(0, 0, 0, .62);
                color: #fff;
                border-radius: 4px;
                font-size: 12px;
                white-space: nowrap;
                transform: translateX(-50%);
            }
        }
        .dplayer-bar-preview {
            position: absolute;
            background: #fff;
            pointer-events: none;
            display: none;
            background-size: 16000px 100%;
        }
        .dplayer-bar-preview-canvas {
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }
        .dplayer-bar-time {
            &.hidden {
                opacity: 0;
            }
            position: absolute;
            left: 0px;
            top: -20px;
            border-radius: 4px;
            padding: 5px 7px;
            background-color: rgba(0, 0, 0, 0.62);
            color: #fff;
            font-size: 12px;
            text-align: center;
            opacity: 1;
            transition: opacity .1s ease-in-out;
            word-wrap: normal;
            word-break: normal;
            z-index: 2;
            pointer-events: none;
        }
        .dplayer-bar {
            position: relative;
            height: 3px;
            width: 100%;
            background: rgba(255, 255, 255, .2);
            cursor: pointer;
            .dplayer-loaded {
                position: absolute;
                left: 0;
                top: 0;
                bottom: 0;
                background: rgba(255, 255, 255, .4);
                height: 3px;
                transition: all 0.5s ease;
                will-change: width;
            }
            .dplayer-played {
                position: absolute;
                left: 0;
                top: 0;
                bottom: 0;
                height: 3px;
                will-change: width;
                .dplayer-thumb {
                    position: absolute;
                    top: 0;
                    right: 5px;
                    margin-top: -4px;
                    margin-right: -10px;
                    height: 11px;
                    width: 11px;
                    border-radius: 50%;
                    cursor: pointer;
                    transition: all .3s ease-in-out;
                    transform: scale(0);
                }
            }
        }
    }
    .dplayer-icons {
        height: 38px;
        position: absolute;
        bottom: 0;
        &.dplayer-comment-box {
            display: none;
            position: absolute;
            transition: all .3s ease-in-out;
            z-index: 2;
            height: 38px;
            bottom: 0;
            left: 20px;
            right: 20px;
            color: #fff;
            .dplayer-icon {
                padding: 7px;
            }
            .dplayer-comment-setting-icon {
                position: absolute;
                left: 0;
                top: 0;
            }
            .dplayer-send-icon {
                position: absolute;
                right: 0;
                top: 0;
            }
            .dplayer-comment-setting-box {
                position: absolute;
                background: rgba(28, 28, 28, 0.9);
                bottom: 41px;
                left: 0;
                box-shadow: 0 0 25px rgba(0, 0, 0, .3);
                border-radius: 4px;
                padding: 10px 10px 16px;
                font-size: 14px;
                width: 204px;
                transition: all .3s ease-in-out;
                transform: scale(0);
                &.dplayer-comment-setting-open {
                    transform: scale(1);
                }
                input[type=radio] {
                    display: none;
                }
                label {
                    cursor: pointer;
                }
                .dplayer-comment-setting-title {
                    font-size: 13px;
                    color: #fff;
                    line-height: 30px;
                }
                .dplayer-comment-setting-type {
                    font-size: 0;
                    .dplayer-comment-setting-title {
                        margin-bottom: 6px;
                    }
                    label {
                        &:nth-child(2) {
                            span {
                                border-radius: 4px 0 0 4px;
                            }
                        }
                        &:nth-child(4) {
                            span {
                                border-radius: 0 4px 4px 0;
                            }
                        }
                    }
                    span {
                        width: 33%;
                        padding: 4px 6px;
                        line-height: 16px;
                        display: inline-block;
                        font-size: 12px;
                        color: #fff;
                        border: 1px solid #fff;
                        margin-right: -1px;
                        box-sizing: border-box;
                        text-align: center;
                        cursor: pointer;
                    }
                    input:checked+span {
                        background: #E4E4E6;
                        color: #1c1c1c;
                    }
                }
                .dplayer-comment-setting-color {
                    font-size: 0;
                    label {
                        font-size: 0;
                        padding: 6px;
                        display: inline-block;
                    }
                    span {
                        width: 22px;
                        height: 22px;
                        display: inline-block;
                        border-radius: 50%;
                        box-sizing: border-box;
                        cursor: pointer;
                        &:hover {
                            animation: my-face 5s infinite ease-in-out;
                        }
                    }
                }
            }
            .dplayer-comment-input {
                outline: none;
                border: none;
                padding: 8px 31px;
                font-size: 14px;
                line-height: 18px;
                text-align: center;
                border-radius: 4px;
                background: none;
                margin: 0;
                height: 100%;
                box-sizing: border-box;
                width: 100%;
                color: #fff;
                &::placeholder {
                    color: #fff;
                    opacity: 0.8;
                }
                &::-ms-clear {
                    display: none;
                }
            }
        }
        &.dplayer-icons-left {
            .dplayer-icon {
                padding: 7px;
            }
        }
        &.dplayer-icons-right {
            right: 20px;
            .dplayer-icon {
                padding: 8px;
            }
        }
        .dplayer-time,
        .dplayer-live-badge {
            line-height: 38px;
            color: #eee;
            text-shadow: 0 0 2px rgba(0, 0, 0, .5);
            vertical-align: middle;
            font-size: 13px;
            cursor: default;
        }
        .dplayer-live-dot {
            display: inline-block;
            width: 6px;
            height: 6px;
            vertical-align: 4%;
            margin-right: 5px;
            content: '';
            border-radius: 6px;
        }
        .dplayer-icon {
            width: 40px;
            height: 100%;
            border: none;
            background-color: transparent;
            outline: none;
            cursor: pointer;
            vertical-align: middle;
            box-sizing: border-box;
            display: inline-block;
            .dplayer-icon-content {
                transition: all .2s ease-in-out;
                opacity: .8;
            }
            &:hover {
                .dplayer-icon-content {
                    opacity: 1;
                }
            }
            &.dplayer-quality-icon {
                color: #fff;
                width: auto;
                line-height: 22px;
                font-size: 14px;
            }
            &.dplayer-comment-icon {
                padding: 10px 9px 9px;
            }
            &.dplayer-setting-icon {
                padding-top: 8.5px;
            }
            &.dplayer-volume-icon {
                width: 43px;
            }
        }
        .dplayer-volume {
            position: relative;
            display: inline-block;
            cursor: pointer;
            height: 100%;
            &:hover {
                .dplayer-volume-bar-wrap .dplayer-volume-bar {
                    width: 45px;
                }
                .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
                    transform: scale(1);
                }
            }
            &.dplayer-volume-active {
                .dplayer-volume-bar-wrap .dplayer-volume-bar {
                    width: 45px;
                }
                .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
                    transform: scale(1);
                }
            }
            .dplayer-volume-bar-wrap {
                display: inline-block;
                margin: 0 10px 0 -5px;
                vertical-align: middle;
                height: 100%;
                .dplayer-volume-bar {
                    position: relative;
                    top: 17px;
                    width: 0;
                    height: 3px;
                    background: #aaa;
                    transition: all 0.3s ease-in-out;
                    .dplayer-volume-bar-inner {
                        position: absolute;
                        bottom: 0;
                        left: 0;
                        height: 100%;
                        transition: all 0.1s ease;
                        will-change: width;
                        .dplayer-thumb {
                            position: absolute;
                            top: 0;
                            right: 5px;
                            margin-top: -4px;
                            margin-right: -10px;
                            height: 11px;
                            width: 11px;
                            border-radius: 50%;
                            cursor: pointer;
                            transition: all .3s ease-in-out;
                            transform: scale(0);
                        }
                    }
                }
            }
        }
        .dplayer-subtitle-btn {
            display: inline-block;
            height: 100%;
        }
        .dplayer-subtitles {
            display: inline-block;
            height: 100%;
            .dplayer-subtitles-box {
                position: absolute;
                right: 0;
                bottom: 50px;
                transform: scale(0);
                width: fit-content;
                max-width: 240px;
                min-width: 120px;
                border-radius: 2px;
                background: rgba(28, 28, 28, 0.9);
                padding: 7px 0;
                transition: all .3s ease-in-out;
                overflow: auto;
                z-index: 2;
                &.dplayer-subtitles-panel {
                    display: block;
                }
                &.dplayer-subtitles-box-open {
                    transform: scale(1);
                }
            }
            .dplayer-subtitles-item {
                height: 30px;
                padding: 5px 10px;
                box-sizing: border-box;
                cursor: pointer;
                position: relative;
                &:hover {
                    background-color: rgba(255, 255, 255, .1);
                }
            }
        }
        .dplayer-setting {
            display: inline-block;
            height: 100%;
            .dplayer-setting-box {
                position: absolute;
                right: 0;
                bottom: 50px;
                transform: scale(0);
                width: 150px;
                border-radius: 2px;
                background: rgba(28, 28, 28, 0.9);
                padding: 7px 0;
                transition: all .3s ease-in-out;
                overflow: hidden;
                z-index: 2;
                &>div {
                    display: none;
                    &.dplayer-setting-origin-panel {
                        display: block;
                    }
                }
                &.dplayer-setting-box-open {
                    transform: scale(1);
                }
                &.dplayer-setting-box-narrow {
                    width: 70px;
                    text-align: center;
                }
                &.dplayer-setting-box-speed {
                    .dplayer-setting-origin-panel {
                        display: none;
                    }
                    .dplayer-setting-speed-panel {
                        display: block;
                    }
                }
            }
            .dplayer-setting-item,
            .dplayer-setting-speed-item {
                height: 30px;
                padding: 5px 10px;
                box-sizing: border-box;
                cursor: pointer;
                position: relative;
                &:hover {
                    background-color: rgba(255, 255, 255, .1);
                }
            }
            .dplayer-setting-danmaku {
                padding: 5px 0;
                .dplayer-label {
                    padding: 0 10px;
                    display: inline;
                }
                &:hover {
                    .dplayer-label {
                        display: none;
                    }
                    .dplayer-danmaku-bar-wrap {
                        display: inline-block;
                    }
                }
                &.dplayer-setting-danmaku-active {
                    .dplayer-label {
                        display: none;
                    }
                    .dplayer-danmaku-bar-wrap {
                        display: inline-block;
                    }
                }
                .dplayer-danmaku-bar-wrap {
                    padding: 0 10px;
                    box-sizing: border-box;
                    display: none;
                    vertical-align: middle;
                    height: 100%;
                    width: 100%;
                    .dplayer-danmaku-bar {
                        position: relative;
                        top: 8.5px;
                        width: 100%;
                        height: 3px;
                        background: #fff;
                        transition: all 0.3s ease-in-out;
                        .dplayer-danmaku-bar-inner {
                            position: absolute;
                            bottom: 0;
                            left: 0;
                            height: 100%;
                            transition: all 0.1s ease;
                            background: #aaa;
                            will-change: width;
                            .dplayer-thumb {
                                position: absolute;
                                top: 0;
                                right: 5px;
                                margin-top: -4px;
                                margin-right: -10px;
                                height: 11px;
                                width: 11px;
                                border-radius: 50%;
                                cursor: pointer;
                                transition: all .3s ease-in-out;
                                background: #aaa;
                            }
                        }
                    }
                }
            }
        }
        .dplayer-full {
            display: inline-block;
            height: 100%;
            position: relative;
            &:hover {
                .dplayer-full-in-icon {
                    display: block;
                }
            }
            .dplayer-full-in-icon {
                position: absolute;
                top: -30px;
                z-index: 1;
                display: none;
            }
        }
        .dplayer-quality {
            position: relative;
            display: inline-block;
            height: 100%;
            z-index: 2;
            &:hover {
                .dplayer-quality-list {
                    display: block;
                }
                .dplayer-quality-mask {
                    display: block;
                }
            }
            .dplayer-quality-mask {
                display: none;
                position: absolute;
                bottom: 38px;
                left: -18px;
                width: 80px;
                padding-bottom: 12px;
            }
            .dplayer-quality-list {
                display: none;
                font-size: 12px;
                width: 80px;
                border-radius: 2px;
                background: rgba(28, 28, 28, 0.9);
                padding: 5px 0;
                transition: all .3s ease-in-out;
                overflow: hidden;
                color: #fff;
                text-align: center;
            }
            .dplayer-quality-item {
                height: 25px;
                box-sizing: border-box;
                cursor: pointer;
                line-height: 25px;
                &:hover {
                    background-color: rgba(255, 255, 255, .1);
                }
            }
        }
        .dplayer-comment {
            display: inline-block;
            height: 100%;
        }
        .dplayer-label {
            color: #eee;
            font-size: 13px;
            display: inline-block;
            vertical-align: middle;
            white-space: nowrap;
        }
        .dplayer-toggle {
            width: 32px;
            height: 20px;
            text-align: center;
            font-size: 0;
            vertical-align: middle;
            position: absolute;
            top: 5px;
            right: 10px;
            input {
                max-height: 0;
                max-width: 0;
                display: none;
            }
            input+label {
                display: inline-block;
                position: relative;
                box-shadow: rgb(223, 223, 223) 0 0 0 0 inset;
                border: 1px solid rgb(223, 223, 223);
                height: 20px;
                width: 32px;
                border-radius: 10px;
                box-sizing: border-box;
                cursor: pointer;
                transition: .2s ease-in-out;
            }
            input+label:before {
                content: "";
                position: absolute;
                display: block;
                height: 18px;
                width: 18px;
                top: 0;
                left: 0;
                border-radius: 15px;
                transition: .2s ease-in-out;
            }
            input+label:after {
                content: "";
                position: absolute;
                display: block;
                left: 0;
                top: 0;
                border-radius: 15px;
                background: #fff;
                transition: .2s ease-in-out;
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
                height: 18px;
                width: 18px;
            }
            input:checked+label {
                border-color: rgba(255, 255, 255, 0.5);
            }
            input:checked+label:before {
                width: 30px;
                background: rgba(255, 255, 255, 0.5);
            }
            input:checked+label:after {
                left: 12px;
            }
        }
    }
}

.dplayer-mobile-play {
    display: none;
    width: 50px;
    height: 50px;
    border: none;
    background-color: transparent;
    outline: none;
    cursor: pointer;
    box-sizing: border-box;
    position: absolute;
    bottom: 0;
    opacity: 0.8;
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
}`,`.dplayer-danmaku {
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    font-size: 22px;
    color: #fff;
    .dplayer-danmaku-item {
        display: inline-block;
        pointer-events: none;
        user-select: none;
        cursor: default;
        white-space: nowrap;
        text-shadow: .5px .5px .5px rgba(0, 0, 0, .5);
        &--demo {
            position: absolute;
            visibility: hidden;
        }
    }
    .dplayer-danmaku-right {
        position: absolute;
        right: 0;
        transform: translateX(100%);
        &.dplayer-danmaku-move {
            will-change: transform;
            animation-name: 'danmaku';
            animation-timing-function: linear;
            animation-play-state: paused;
        }
    }
    @keyframes danmaku {
        from {
            transform: translateX(100%);
        }
    }
    .dplayer-danmaku-top,
    .dplayer-danmaku-bottom {
        position: absolute;
        width: 100%;
        text-align: center;
        visibility: hidden;
        &.dplayer-danmaku-move {
            will-change: visibility;
            animation-name: 'danmaku-center';
            animation-timing-function: linear;
            animation-play-state: paused;
        }
    }
    @keyframes danmaku-center {
        from {
            visibility: visible;
        }
        to {
            visibility: visible;
        }
    }
}`,`.dplayer-logo {
    pointer-events: none;
    position: absolute;
    left: 20px;
    top: 20px;
    max-width: 50px;
    max-height: 50px;
    img {
        max-width: 100%;
        max-height: 100%;
        background: none;
    }
}`,`.dplayer-menu {
    position: absolute;
    width: 170px;
    border-radius: 2px;
    background: rgba(28, 28, 28, 0.85);
    padding: 5px 0;
    overflow: hidden;
    z-index: 3;
    display: none;
    &.dplayer-menu-show {
        display: block;
    }
    .dplayer-menu-item {
        height: 30px;
        box-sizing: border-box;
        cursor: pointer;
        &:hover {
            background-color: rgba(255, 255, 255, .1);
        }
        a {
            display: inline-block;
            padding: 0 10px;
            line-height: 30px;
            color: #eee;
            font-size: 13px;
            display: inline-block;
            vertical-align: middle;
            width: 100%;
            box-sizing: border-box;
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
            &:hover {
                text-decoration: none;
            }
        }
    }
}`,`.dplayer-subtitle {
    position: absolute;
    bottom: 40px;
    width: 90%;
    left: 5%;
    text-align: center;
    color: #fff;
    text-shadow: 0.5px 0.5px 0.5px rgba(0, 0, 0, 0.5);
    font-size: 20px;
    &.dplayer-subtitle-hide {
        display: none;
    }
}`,`.dplayer-mask {
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 1;
    display: none;
    &.dplayer-mask-show {
        display: block;
    }
}

.dplayer-video-wrap {
    position: relative;
    background: #000;
    font-size: 0;
    width: 100%;
    height: 100%;
    .dplayer-video {
        width: 100%;
        height: 100%;
        display: none;
    }
    .dplayer-video-current {
        display: block;
    }
    .dplayer-video-prepare {
        display: none;
    }
}`,`.dplayer-info-panel {
    position: absolute;
    top: 10px;
    left: 10px;
    width: 400px;
    background: rgba(28, 28, 28, 0.8);
    padding: 10px;
    color: #fff;
    font-size: 12px;
    border-radius: 2px;

    &-hide {
        display: none;
    }

    .dplayer-info-panel-close {
        cursor: pointer;
        position: absolute;
        right: 10px;
        top: 10px;
    }

    .dplayer-info-panel-item {
        & > span {
            display: inline-block;
            vertical-align: middle;
            line-height: 15px;
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
        }
    }

    .dplayer-info-panel-item-title {
        width: 100px;
        text-align: right;
        margin-right: 10px;
    }
    
    .dplayer-info-panel-item-data {
        width: 260px;
    }
}`],sourceRoot:""}]);const G=J},856:_e=>{"use strict";var we=[];function ye(Y){for(var I=-1,A=0;A<we.length;A++)if(we[A].identifier===Y){I=A;break}return I}function se(Y,I){for(var A={},M=[],k=0;k<Y.length;k++){var V=Y[k],J=I.base?V[0]+I.base:V[0],F=A[J]||0,G="".concat(J," ").concat(F);A[J]=F+1;var $=ye(G),H={css:V[1],media:V[2],sourceMap:V[3],supports:V[4],layer:V[5]};if($!==-1)we[$].references++,we[$].updater(H);else{var C=te(H,I);I.byIndex=k,we.splice(k,0,{identifier:G,updater:C,references:1})}M.push(G)}return M}function te(Y,I){var A=I.domAPI(I);return A.update(Y),function(M){if(M){if(M.css===Y.css&&M.media===Y.media&&M.sourceMap===Y.sourceMap&&M.supports===Y.supports&&M.layer===Y.layer)return;A.update(Y=M)}else A.remove()}}_e.exports=function(Y,I){var A=se(Y=Y||[],I=I||{});return function(M){M=M||[];for(var k=0;k<A.length;k++){var V=ye(A[k]);we[V].references--}for(var J=se(M,I),F=0;F<A.length;F++){var G=ye(A[F]);we[G].references===0&&(we[G].updater(),we.splice(G,1))}A=J}}},370:_e=>{"use strict";var we={};_e.exports=function(ye,se){var te=function(Y){if(we[Y]===void 0){var I=document.querySelector(Y);if(window.HTMLIFrameElement&&I instanceof window.HTMLIFrameElement)try{I=I.contentDocument.head}catch(A){I=null}we[Y]=I}return we[Y]}(ye);if(!te)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");te.appendChild(se)}},278:_e=>{"use strict";_e.exports=function(we){var ye=document.createElement("style");return we.setAttributes(ye,we.attributes),we.insert(ye,we.options),ye}},458:(_e,we,ye)=>{"use strict";_e.exports=function(se){var te=ye.nc;te&&se.setAttribute("nonce",te)}},470:_e=>{"use strict";_e.exports=function(we){var ye=we.insertStyleElement(we);return{update:function(se){(function(te,Y,I){var A="";I.supports&&(A+="@supports (".concat(I.supports,") {")),I.media&&(A+="@media ".concat(I.media," {"));var M=I.layer!==void 0;M&&(A+="@layer".concat(I.layer.length>0?" ".concat(I.layer):""," {")),A+=I.css,M&&(A+="}"),I.media&&(A+="}"),I.supports&&(A+="}");var k=I.sourceMap;k&&typeof btoa!="undefined"&&(A+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(k))))," */")),Y.styleTagTransform(A,te,Y.options)})(ye,we,se)},remove:function(){(function(se){if(se.parentNode===null)return!1;se.parentNode.removeChild(se)})(ye)}}}},488:_e=>{"use strict";_e.exports=function(we,ye){if(ye.styleSheet)ye.styleSheet.cssText=we;else{for(;ye.firstChild;)ye.removeChild(ye.firstChild);ye.appendChild(document.createTextNode(we))}}},251:_e=>{_e.exports='<svg viewBox="0 0 288 288" xmlns="http://www.w3.org/2000/svg"><path d="M288 90v96c0 20-16 36-36 36h-10c-16 0-16-24 0-24h10c7 0 12-5 12-12V90c0-7-5-12-12-12H36c-7 0-12 5-12 12v96c0 7 5 12 12 12h10c16 0 16 24 0 24H36c-20 0-36-16-36-36V90c0-20 16-36 36-36h216c20 0 36 16 36 36zm-120 62l48 68c14 20 1 38-20 38H92c-21 0-34-18-20-38l48-68c13-18 35-18 48 0z"></path></svg>'},113:_e=>{_e.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M16 23c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6zM16 13c-2.206 0-4 1.794-4 4s1.794 4 4 4c2.206 0 4-1.794 4-4s-1.794-4-4-4zM27 28h-22c-1.654 0-3-1.346-3-3v-16c0-1.654 1.346-3 3-3h3c0.552 0 1 0.448 1 1s-0.448 1-1 1h-3c-0.551 0-1 0.449-1 1v16c0 0.552 0.449 1 1 1h22c0.552 0 1-0.448 1-1v-16c0-0.551-0.448-1-1-1h-11c-0.552 0-1-0.448-1-1s0.448-1 1-1h11c1.654 0 3 1.346 3 3v16c0 1.654-1.346 3-3 3zM24 10.5c0 0.828 0.672 1.5 1.5 1.5s1.5-0.672 1.5-1.5c0-0.828-0.672-1.5-1.5-1.5s-1.5 0.672-1.5 1.5zM15 4c0 0.552-0.448 1-1 1h-4c-0.552 0-1-0.448-1-1v0c0-0.552 0.448-1 1-1h4c0.552 0 1 0.448 1 1v0z"></path></svg>'},193:_e=>{_e.exports='<svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="chromecast" class="svg-inline--fa fa-chromecast fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M447.8,64H64c-23.6,0-42.7,19.1-42.7,42.7v63.9H64v-63.9h383.8v298.6H298.6V448H448c23.6,0,42.7-19.1,42.7-42.7V106.7 C490.7,83.1,471.4,64,447.8,64z M21.3,383.6L21.3,383.6l0,63.9h63.9C85.2,412.2,56.6,383.6,21.3,383.6L21.3,383.6z M21.3,298.6V341 c58.9,0,106.6,48.1,106.6,107h42.7C170.7,365.6,103.7,298.7,21.3,298.6z M213.4,448h42.7c-0.5-129.5-105.3-234.3-234.8-234.6l0,42.4 C127.3,255.6,213.3,342,213.4,448z"></path></svg>'},338:_e=>{_e.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M27.090 0.131h-22.731c-2.354 0-4.262 1.839-4.262 4.109v16.401c0 2.269 1.908 4.109 4.262 4.109h4.262v-2.706h8.469l-8.853 8.135 1.579 1.451 7.487-6.88h9.787c2.353 0 4.262-1.84 4.262-4.109v-16.401c0-2.27-1.909-4.109-4.262-4.109v0zM28.511 19.304c0 1.512-1.272 2.738-2.841 2.738h-8.425l-0.076-0.070-0.076 0.070h-11.311c-1.569 0-2.841-1.226-2.841-2.738v-13.696c0-1.513 1.272-2.739 2.841-2.739h19.889c1.569 0 2.841-0.142 2.841 1.37v15.064z"></path></svg>'},807:_e=>{_e.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M27.128 0.38h-22.553c-2.336 0-4.229 1.825-4.229 4.076v16.273c0 2.251 1.893 4.076 4.229 4.076h4.229v-2.685h8.403l-8.784 8.072 1.566 1.44 7.429-6.827h9.71c2.335 0 4.229-1.825 4.229-4.076v-16.273c0-2.252-1.894-4.076-4.229-4.076zM28.538 19.403c0 1.5-1.262 2.717-2.819 2.717h-8.36l-0.076-0.070-0.076 0.070h-11.223c-1.557 0-2.819-1.217-2.819-2.717v-13.589c0-1.501 1.262-2.718 2.819-2.718h19.734c1.557 0 2.819-0.141 2.819 1.359v14.947zM9.206 10.557c-1.222 0-2.215 0.911-2.215 2.036s0.992 2.035 2.215 2.035c1.224 0 2.216-0.911 2.216-2.035s-0.992-2.036-2.216-2.036zM22.496 10.557c-1.224 0-2.215 0.911-2.215 2.036s0.991 2.035 2.215 2.035c1.224 0 2.215-0.911 2.215-2.035s-0.991-2.036-2.215-2.036zM15.852 10.557c-1.224 0-2.215 0.911-2.215 2.036s0.991 2.035 2.215 2.035c1.222 0 2.215-0.911 2.215-2.035s-0.992-2.036-2.215-2.036z"></path></svg>'},300:_e=>{_e.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 33"><path d="M24.965 24.38h-18.132c-1.366 0-2.478-1.113-2.478-2.478v-11.806c0-1.364 1.111-2.478 2.478-2.478h18.132c1.366 0 2.478 1.113 2.478 2.478v11.806c0 1.364-1.11 2.478-2.478 2.478zM6.833 10.097v11.806h18.134l-0.002-11.806h-18.132zM2.478 28.928h5.952c0.684 0 1.238-0.554 1.238-1.239 0-0.684-0.554-1.238-1.238-1.238h-5.952v-5.802c0-0.684-0.554-1.239-1.238-1.239s-1.239 0.556-1.239 1.239v5.802c0 1.365 1.111 2.478 2.478 2.478zM30.761 19.412c-0.684 0-1.238 0.554-1.238 1.238v5.801h-5.951c-0.686 0-1.239 0.554-1.239 1.238 0 0.686 0.554 1.239 1.239 1.239h5.951c1.366 0 2.478-1.111 2.478-2.478v-5.801c0-0.683-0.554-1.238-1.239-1.238zM0 5.55v5.802c0 0.683 0.554 1.238 1.238 1.238s1.238-0.555 1.238-1.238v-5.802h5.952c0.684 0 1.238-0.554 1.238-1.238s-0.554-1.238-1.238-1.238h-5.951c-1.366-0.001-2.478 1.111-2.478 2.476zM32 11.35v-5.801c0-1.365-1.11-2.478-2.478-2.478h-5.951c-0.686 0-1.239 0.554-1.239 1.238s0.554 1.238 1.239 1.238h5.951v5.801c0 0.683 0.554 1.237 1.238 1.237 0.686 0.002 1.239-0.553 1.239-1.236z"></path></svg>'},574:_e=>{_e.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 33"><path d="M6.667 28h-5.333c-0.8 0-1.333-0.533-1.333-1.333v-5.333c0-0.8 0.533-1.333 1.333-1.333s1.333 0.533 1.333 1.333v4h4c0.8 0 1.333 0.533 1.333 1.333s-0.533 1.333-1.333 1.333zM30.667 28h-5.333c-0.8 0-1.333-0.533-1.333-1.333s0.533-1.333 1.333-1.333h4v-4c0-0.8 0.533-1.333 1.333-1.333s1.333 0.533 1.333 1.333v5.333c0 0.8-0.533 1.333-1.333 1.333zM30.667 12c-0.8 0-1.333-0.533-1.333-1.333v-4h-4c-0.8 0-1.333-0.533-1.333-1.333s0.533-1.333 1.333-1.333h5.333c0.8 0 1.333 0.533 1.333 1.333v5.333c0 0.8-0.533 1.333-1.333 1.333zM1.333 12c-0.8 0-1.333-0.533-1.333-1.333v-5.333c0-0.8 0.533-1.333 1.333-1.333h5.333c0.8 0 1.333 0.533 1.333 1.333s-0.533 1.333-1.333 1.333h-4v4c0 0.8-0.533 1.333-1.333 1.333z"></path></svg>'},182:_e=>{_e.exports='<svg version="1.1" viewBox="0 0 22 22"><svg x="7" y="1"><circle class="diplayer-loading-dot diplayer-loading-dot-0" cx="4" cy="4" r="2"></circle></svg><svg x="11" y="3"><circle class="diplayer-loading-dot diplayer-loading-dot-1" cx="4" cy="4" r="2"></circle></svg><svg x="13" y="7"><circle class="diplayer-loading-dot diplayer-loading-dot-2" cx="4" cy="4" r="2"></circle></svg><svg x="11" y="11"><circle class="diplayer-loading-dot diplayer-loading-dot-3" cx="4" cy="4" r="2"></circle></svg><svg x="7" y="13"><circle class="diplayer-loading-dot diplayer-loading-dot-4" cx="4" cy="4" r="2"></circle></svg><svg x="3" y="11"><circle class="diplayer-loading-dot diplayer-loading-dot-5" cx="4" cy="4" r="2"></circle></svg><svg x="1" y="7"><circle class="diplayer-loading-dot diplayer-loading-dot-6" cx="4" cy="4" r="2"></circle></svg><svg x="3" y="3"><circle class="diplayer-loading-dot diplayer-loading-dot-7" cx="4" cy="4" r="2"></circle></svg></svg>'},965:_e=>{_e.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M19.357 2.88c1.749 0 3.366 0.316 4.851 0.946 1.485 0.632 2.768 1.474 3.845 2.533s1.922 2.279 2.532 3.661c0.611 1.383 0.915 2.829 0.915 4.334 0 1.425-0.304 2.847-0.915 4.271-0.611 1.425-1.587 2.767-2.928 4.028-0.855 0.813-1.811 1.607-2.869 2.38s-2.136 1.465-3.233 2.075c-1.099 0.61-2.198 1.098-3.296 1.465-1.098 0.366-2.115 0.549-3.051 0.549-1.343 0-2.441-0.438-3.296-1.311-0.854-0.876-1.281-2.41-1.281-4.608 0-0.366 0.020-0.773 0.060-1.221s0.062-0.895 0.062-1.343c0-0.773-0.183-1.353-0.55-1.738-0.366-0.387-0.793-0.58-1.281-0.58-0.652 0-1.21 0.295-1.678 0.886s-0.926 1.23-1.373 1.921c-0.447 0.693-0.905 1.334-1.372 1.923s-1.028 0.886-1.679 0.886c-0.529 0-1.048-0.427-1.556-1.282s-0.763-2.259-0.763-4.212c0-2.197 0.529-4.241 1.587-6.133s2.462-3.529 4.21-4.912c1.75-1.383 3.762-2.471 6.041-3.264 2.277-0.796 4.617-1.212 7.018-1.253zM7.334 15.817c0.569 0 1.047-0.204 1.434-0.611s0.579-0.875 0.579-1.404c0-0.569-0.193-1.047-0.579-1.434s-0.864-0.579-1.434-0.579c-0.529 0-0.987 0.193-1.373 0.579s-0.58 0.864-0.58 1.434c0 0.53 0.194 0.998 0.58 1.404 0.388 0.407 0.845 0.611 1.373 0.611zM12.216 11.79c0.691 0 1.292-0.254 1.8-0.763s0.762-1.107 0.762-1.8c0-0.732-0.255-1.343-0.762-1.831-0.509-0.489-1.109-0.732-1.8-0.732-0.732 0-1.342 0.244-1.831 0.732-0.488 0.488-0.732 1.098-0.732 1.831 0 0.693 0.244 1.292 0.732 1.8s1.099 0.763 1.831 0.763zM16.366 25.947c0.692 0 1.282-0.214 1.77-0.64s0.732-0.987 0.732-1.678-0.244-1.261-0.732-1.709c-0.489-0.448-1.078-0.671-1.77-0.671-0.65 0-1.21 0.223-1.678 0.671s-0.702 1.018-0.702 1.709c0 0.692 0.234 1.25 0.702 1.678s1.027 0.64 1.678 0.64zM19.113 9.592c0.651 0 1.129-0.203 1.433-0.611 0.305-0.406 0.459-0.874 0.459-1.404 0-0.488-0.154-0.947-0.459-1.373-0.304-0.427-0.782-0.641-1.433-0.641-0.529 0-1.008 0.193-1.434 0.58s-0.64 0.865-0.64 1.434c0 0.571 0.213 1.049 0.64 1.434 0.427 0.389 0.905 0.581 1.434 0.581zM24.848 12.826c0.57 0 1.067-0.213 1.495-0.64 0.427-0.427 0.64-0.947 0.64-1.556 0-0.57-0.214-1.068-0.64-1.495-0.428-0.427-0.927-0.64-1.495-0.64-0.611 0-1.129 0.213-1.555 0.64-0.428 0.427-0.642 0.926-0.642 1.495 0 0.611 0.213 1.129 0.642 1.556s0.947 0.64 1.555 0.64z"></path></svg>'},74:_e=>{_e.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 17 32"><path d="M14.080 4.8q2.88 0 2.88 2.048v18.24q0 2.112-2.88 2.112t-2.88-2.112v-18.24q0-2.048 2.88-2.048zM2.88 4.8q2.88 0 2.88 2.048v18.24q0 2.112-2.88 2.112t-2.88-2.112v-18.24q0-2.048 2.88-2.048z"></path></svg>'},730:_e=>{_e.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 16 32"><path d="M15.552 15.168q0.448 0.32 0.448 0.832 0 0.448-0.448 0.768l-13.696 8.512q-0.768 0.512-1.312 0.192t-0.544-1.28v-16.448q0-0.96 0.544-1.28t1.312 0.192z"></path></svg>'},428:_e=>{_e.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M22 16l-10.105-10.6-1.895 1.987 8.211 8.613-8.211 8.612 1.895 1.988 8.211-8.613z"></path></svg>'},254:_e=>{_e.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M13.725 30l3.9-5.325-3.9-1.125v6.45zM0 17.5l11.050 3.35 13.6-11.55-10.55 12.425 11.8 3.65 6.1-23.375-32 15.5z"></path></svg>'},934:_e=>{_e.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 28"><path d="M28.633 17.104c0.035 0.21 0.026 0.463-0.026 0.76s-0.14 0.598-0.262 0.904c-0.122 0.306-0.271 0.581-0.445 0.825s-0.367 0.419-0.576 0.524c-0.209 0.105-0.393 0.157-0.55 0.157s-0.332-0.035-0.524-0.105c-0.175-0.052-0.393-0.1-0.655-0.144s-0.528-0.052-0.799-0.026c-0.271 0.026-0.541 0.083-0.812 0.17s-0.502 0.236-0.694 0.445c-0.419 0.437-0.664 0.934-0.734 1.493s0.009 1.092 0.236 1.598c0.175 0.349 0.148 0.699-0.079 1.048-0.105 0.14-0.271 0.284-0.498 0.432s-0.476 0.284-0.747 0.406-0.555 0.218-0.851 0.288c-0.297 0.070-0.559 0.105-0.786 0.105-0.157 0-0.306-0.061-0.445-0.183s-0.236-0.253-0.288-0.393h-0.026c-0.192-0.541-0.52-1.009-0.982-1.402s-1-0.589-1.611-0.589c-0.594 0-1.131 0.197-1.611 0.589s-0.816 0.851-1.009 1.375c-0.087 0.21-0.218 0.362-0.393 0.458s-0.367 0.144-0.576 0.144c-0.244 0-0.52-0.044-0.825-0.131s-0.611-0.197-0.917-0.327c-0.306-0.131-0.581-0.284-0.825-0.458s-0.428-0.349-0.55-0.524c-0.087-0.122-0.135-0.266-0.144-0.432s0.057-0.397 0.197-0.694c0.192-0.402 0.266-0.86 0.223-1.375s-0.266-0.991-0.668-1.428c-0.244-0.262-0.541-0.432-0.891-0.511s-0.681-0.109-0.995-0.092c-0.367 0.017-0.742 0.087-1.127 0.21-0.244 0.070-0.489 0.052-0.734-0.052-0.192-0.070-0.371-0.231-0.537-0.485s-0.314-0.533-0.445-0.838c-0.131-0.306-0.231-0.62-0.301-0.943s-0.087-0.59-0.052-0.799c0.052-0.384 0.227-0.629 0.524-0.734 0.524-0.21 0.995-0.555 1.415-1.035s0.629-1.017 0.629-1.611c0-0.611-0.21-1.144-0.629-1.598s-0.891-0.786-1.415-0.996c-0.157-0.052-0.288-0.179-0.393-0.38s-0.157-0.406-0.157-0.616c0-0.227 0.035-0.48 0.105-0.76s0.162-0.55 0.275-0.812 0.244-0.502 0.393-0.72c0.148-0.218 0.31-0.38 0.485-0.485 0.14-0.087 0.275-0.122 0.406-0.105s0.275 0.052 0.432 0.105c0.524 0.21 1.070 0.275 1.637 0.197s1.070-0.327 1.506-0.747c0.21-0.209 0.362-0.467 0.458-0.773s0.157-0.607 0.183-0.904c0.026-0.297 0.026-0.568 0-0.812s-0.048-0.419-0.065-0.524c-0.035-0.105-0.066-0.227-0.092-0.367s-0.013-0.262 0.039-0.367c0.105-0.244 0.293-0.458 0.563-0.642s0.563-0.336 0.878-0.458c0.314-0.122 0.62-0.214 0.917-0.275s0.533-0.092 0.707-0.092c0.227 0 0.406 0.074 0.537 0.223s0.223 0.301 0.275 0.458c0.192 0.471 0.507 0.886 0.943 1.244s0.952 0.537 1.546 0.537c0.611 0 1.153-0.17 1.624-0.511s0.803-0.773 0.996-1.297c0.070-0.14 0.179-0.284 0.327-0.432s0.301-0.223 0.458-0.223c0.244 0 0.511 0.035 0.799 0.105s0.572 0.166 0.851 0.288c0.279 0.122 0.537 0.279 0.773 0.472s0.423 0.402 0.563 0.629c0.087 0.14 0.113 0.293 0.079 0.458s-0.070 0.284-0.105 0.354c-0.227 0.506-0.297 1.039-0.21 1.598s0.341 1.048 0.76 1.467c0.419 0.419 0.934 0.651 1.546 0.694s1.179-0.057 1.703-0.301c0.14-0.087 0.31-0.122 0.511-0.105s0.371 0.096 0.511 0.236c0.262 0.244 0.493 0.616 0.694 1.113s0.336 1 0.406 1.506c0.035 0.297-0.013 0.528-0.144 0.694s-0.266 0.275-0.406 0.327c-0.542 0.192-1.004 0.528-1.388 1.009s-0.576 1.026-0.576 1.637c0 0.594 0.162 1.113 0.485 1.559s0.747 0.764 1.27 0.956c0.122 0.070 0.227 0.14 0.314 0.21 0.192 0.157 0.323 0.358 0.393 0.602v0zM16.451 19.462c0.786 0 1.528-0.149 2.227-0.445s1.305-0.707 1.821-1.231c0.515-0.524 0.921-1.131 1.218-1.821s0.445-1.428 0.445-2.214c0-0.786-0.148-1.524-0.445-2.214s-0.703-1.292-1.218-1.808c-0.515-0.515-1.122-0.921-1.821-1.218s-1.441-0.445-2.227-0.445c-0.786 0-1.524 0.148-2.214 0.445s-1.292 0.703-1.808 1.218c-0.515 0.515-0.921 1.118-1.218 1.808s-0.445 1.428-0.445 2.214c0 0.786 0.149 1.524 0.445 2.214s0.703 1.297 1.218 1.821c0.515 0.524 1.118 0.934 1.808 1.231s1.428 0.445 2.214 0.445v0z"></path></svg>'},410:_e=>{_e.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M26.667 5.333h-21.333c-0 0-0.001 0-0.001 0-1.472 0-2.666 1.194-2.666 2.666 0 0 0 0.001 0 0.001v-0 16c0 0 0 0.001 0 0.001 0 1.472 1.194 2.666 2.666 2.666 0 0 0.001 0 0.001 0h21.333c0 0 0.001 0 0.001 0 1.472 0 2.666-1.194 2.666-2.666 0-0 0-0.001 0-0.001v0-16c0-0 0-0.001 0-0.001 0-1.472-1.194-2.666-2.666-2.666-0 0-0.001 0-0.001 0h0zM5.333 16h5.333v2.667h-5.333v-2.667zM18.667 24h-13.333v-2.667h13.333v2.667zM26.667 24h-5.333v-2.667h5.333v2.667zM26.667 18.667h-13.333v-2.667h13.333v2.667z"></path></svg>'},644:_e=>{_e.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8zM20.576 16q0 1.344-0.768 2.528t-2.016 1.664q-0.16 0.096-0.448 0.096-0.448 0-0.8-0.32t-0.32-0.832q0-0.384 0.192-0.64t0.544-0.448 0.608-0.384 0.512-0.64 0.192-1.024-0.192-1.024-0.512-0.64-0.608-0.384-0.544-0.448-0.192-0.64q0-0.48 0.32-0.832t0.8-0.32q0.288 0 0.448 0.096 1.248 0.48 2.016 1.664t0.768 2.528z"></path></svg>'},324:_e=>{_e.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8z"></path></svg>'},437:_e=>{_e.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8zM20.576 16q0 1.344-0.768 2.528t-2.016 1.664q-0.16 0.096-0.448 0.096-0.448 0-0.8-0.32t-0.32-0.832q0-0.384 0.192-0.64t0.544-0.448 0.608-0.384 0.512-0.64 0.192-1.024-0.192-1.024-0.512-0.64-0.608-0.384-0.544-0.448-0.192-0.64q0-0.48 0.32-0.832t0.8-0.32q0.288 0 0.448 0.096 1.248 0.48 2.016 1.664t0.768 2.528zM25.152 16q0 2.72-1.536 5.056t-4 3.36q-0.256 0.096-0.448 0.096-0.48 0-0.832-0.352t-0.32-0.8q0-0.704 0.672-1.056 1.024-0.512 1.376-0.8 1.312-0.96 2.048-2.4t0.736-3.104-0.736-3.104-2.048-2.4q-0.352-0.288-1.376-0.8-0.672-0.352-0.672-1.056 0-0.448 0.32-0.8t0.8-0.352q0.224 0 0.48 0.096 2.496 1.056 4 3.36t1.536 5.056z"></path></svg>'},897:(_e,we,ye)=>{"use strict";var se=typeof self!="undefined"?self:typeof window!="undefined"?window:ye.g!==void 0?ye.g:{},te=Object.create(se),Y=/["&'<>]/;function I(A){return typeof A!="string"&&(A=A==null?"":typeof A=="function"?I(A.call(A)):JSON.stringify(A)),A}te.$escape=function(A){return function(M){var k=""+M,V=Y.exec(k);if(!V)return M;var J="",F=void 0,G=void 0,$=void 0;for(F=V.index,G=0;F<k.length;F++){switch(k.charCodeAt(F)){case 34:$="&#34;";break;case 38:$="&#38;";break;case 39:$="&#39;";break;case 60:$="&#60;";break;case 62:$="&#62;";break;default:continue}G!==F&&(J+=k.substring(G,F)),G=F+1,J+=$}return G!==F?J+k.substring(G,F):J}(I(A))},te.$each=function(A,M){if(Array.isArray(A))for(var k=0,V=A.length;k<V;k++)M(A[k],k);else for(var J in A)M(A[J],J)},_e.exports=te},471:(_e,we,ye)=>{"use strict";_e.exports=ye(897)},352:_e=>{"use strict";_e.exports=function(we){var ye=[];return ye.toString=function(){return this.map(function(se){var te="",Y=se[5]!==void 0;return se[4]&&(te+="@supports (".concat(se[4],") {")),se[2]&&(te+="@media ".concat(se[2]," {")),Y&&(te+="@layer".concat(se[5].length>0?" ".concat(se[5]):""," {")),te+=we(se),Y&&(te+="}"),se[2]&&(te+="}"),se[4]&&(te+="}"),te}).join("")},ye.i=function(se,te,Y,I,A){typeof se=="string"&&(se=[[null,se,void 0]]);var M={};if(Y)for(var k=0;k<this.length;k++){var V=this[k][0];V!=null&&(M[V]=!0)}for(var J=0;J<se.length;J++){var F=[].concat(se[J]);Y&&M[F[0]]||(A!==void 0&&(F[5]===void 0||(F[1]="@layer".concat(F[5].length>0?" ".concat(F[5]):""," {").concat(F[1],"}")),F[5]=A),te&&(F[2]&&(F[1]="@media ".concat(F[2]," {").concat(F[1],"}")),F[2]=te),I&&(F[4]?(F[1]="@supports (".concat(F[4],") {").concat(F[1],"}"),F[4]=I):F[4]="".concat(I)),ye.push(F))}},ye}},80:_e=>{"use strict";_e.exports=function(we,ye){return ye||(ye={}),we&&(we=String(we.__esModule?we.default:we),/^['"].*['"]$/.test(we)&&(we=we.slice(1,-1)),ye.hash&&(we+=ye.hash),/["'() \t\n]|(%20)/.test(we)||ye.needQuotes?'"'.concat(we.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):we)}},415:_e=>{"use strict";_e.exports=function(we){var ye=we[1],se=we[3];if(!se)return ye;if(typeof btoa=="function"){var te=btoa(unescape(encodeURIComponent(JSON.stringify(se)))),Y="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(te),I="/*# ".concat(Y," */");return[ye].concat([I]).join(`
`)}return[ye].join(`
`)}},937:_e=>{function we(ye){return we=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(se){return typeof se}:function(se){return se&&typeof Symbol=="function"&&se.constructor===Symbol&&se!==Symbol.prototype?"symbol":typeof se},we(ye)}_e.exports=(typeof self=="undefined"?"undefined":we(self))=="object"?self.FormData:window.FormData},831:_e=>{"use strict";_e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAADGCAYAAAAT+OqFAAAAdklEQVQoz42QQQ7AIAgEF/T/D+kbq/RWAlnQyyazA4aoAB4FsBSA/bFjuF1EOL7VbrIrBuusmrt4ZZORfb6ehbWdnRHEIiITaEUKa5EJqUakRSaEYBJSCY2dEstQY7AuxahwXFrvZmWl2rh4JZ07z9dLtesfNj5q0FU3A5ObbwAAAABJRU5ErkJggg=="}},We={};function ve(_e){var we=We[_e];if(we!==void 0)return we.exports;var ye=We[_e]={id:_e,exports:{}};return ne[_e](ye,ye.exports,ve),ye.exports}ve.m=ne,ve.n=_e=>{var we=_e&&_e.__esModule?()=>_e.default:()=>_e;return ve.d(we,{a:we}),we},ve.d=(_e,we)=>{for(var ye in we)ve.o(we,ye)&&!ve.o(_e,ye)&&Object.defineProperty(_e,ye,{enumerable:!0,get:we[ye]})},ve.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(_e){if(typeof window=="object")return window}}(),ve.o=(_e,we)=>Object.prototype.hasOwnProperty.call(_e,we),ve.b=document.baseURI||self.location.href,ve.nc=void 0;var ze={};return(()=>{"use strict";ve.d(ze,{default:()=>xr});var _e=ve(856),we=ve.n(_e),ye=ve(470),se=ve.n(ye),te=ve(370),Y=ve.n(te),I=ve(458),A=ve.n(I),M=ve(278),k=ve.n(M),V=ve(488),J=ve.n(V),F=ve(685),G={};G.styleTagTransform=J(),G.setAttributes=A(),G.insert=Y().bind(null,"head"),G.domAPI=se(),G.insertStyleElement=k(),we()(F.Z,G),F.Z&&F.Z.locals&&F.Z.locals;function $(E){return $=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},$(E)}function H(E,D){this.name="AggregateError",this.errors=E,this.message=D||""}H.prototype=Error.prototype;function C(E){return C=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},C(E)}var Q=setTimeout;function ae(E){return Boolean(E&&E.length!==void 0)}function ue(){}function j(E){if(!(this instanceof j))throw new TypeError("Promises must be constructed via new");if(typeof E!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],Ce(E,this)}function X(E,D){for(;E._state===3;)E=E._value;E._state!==0?(E._handled=!0,j._immediateFn(function(){var z=E._state===1?D.onFulfilled:D.onRejected;if(z!==null){var x;try{x=z(E._value)}catch(P){return void ce(D.promise,P)}oe(D.promise,x)}else(E._state===1?oe:ce)(D.promise,E._value)})):E._deferreds.push(D)}function oe(E,D){try{if(D===E)throw new TypeError("A promise cannot be resolved with itself.");if(D&&(C(D)==="object"||typeof D=="function")){var z=D.then;if(D instanceof j)return E._state=3,E._value=D,void be(E);if(typeof z=="function")return void Ce((x=z,P=D,function(){x.apply(P,arguments)}),E)}E._state=1,E._value=D,be(E)}catch(N){ce(E,N)}var x,P}function ce(E,D){E._state=2,E._value=D,be(E)}function be(E){E._state===2&&E._deferreds.length===0&&j._immediateFn(function(){E._handled||j._unhandledRejectionFn(E._value)});for(var D=0,z=E._deferreds.length;D<z;D++)X(E,E._deferreds[D]);E._deferreds=null}function Be(E,D,z){this.onFulfilled=typeof E=="function"?E:null,this.onRejected=typeof D=="function"?D:null,this.promise=z}function Ce(E,D){var z=!1;try{E(function(x){z||(z=!0,oe(D,x))},function(x){z||(z=!0,ce(D,x))})}catch(x){if(z)return;z=!0,ce(D,x)}}j.prototype.catch=function(E){return this.then(null,E)},j.prototype.then=function(E,D){var z=new this.constructor(ue);return X(this,new Be(E,D,z)),z},j.prototype.finally=function(E){var D=this.constructor;return this.then(function(z){return D.resolve(E()).then(function(){return z})},function(z){return D.resolve(E()).then(function(){return D.reject(z)})})},j.all=function(E){return new j(function(D,z){if(!ae(E))return z(new TypeError("Promise.all accepts an array"));var x=Array.prototype.slice.call(E);if(x.length===0)return D([]);var P=x.length;function N(fe,pe){try{if(pe&&(C(pe)==="object"||typeof pe=="function")){var He=pe.then;if(typeof He=="function")return void He.call(pe,function(tt){N(fe,tt)},z)}x[fe]=pe,--P==0&&D(x)}catch(tt){z(tt)}}for(var Z=0;Z<x.length;Z++)N(Z,x[Z])})},j.any=function(E){var D=this;return new D(function(z,x){if(!E||E.length===void 0)return x(new TypeError("Promise.any accepts an array"));var P=Array.prototype.slice.call(E);if(P.length===0)return x();for(var N=[],Z=0;Z<P.length;Z++)try{D.resolve(P[Z]).then(z).catch(function(fe){N.push(fe),N.length===P.length&&x(new H(N,"All promises were rejected"))})}catch(fe){x(fe)}})},j.allSettled=function(E){return new this(function(D,z){if(!E||E.length===void 0)return z(new TypeError($(E)+" "+E+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var x=Array.prototype.slice.call(E);if(x.length===0)return D([]);var P=x.length;function N(fe,pe){if(pe&&($(pe)==="object"||typeof pe=="function")){var He=pe.then;if(typeof He=="function")return void He.call(pe,function(tt){N(fe,tt)},function(tt){x[fe]={status:"rejected",reason:tt},--P==0&&D(x)})}x[fe]={status:"fulfilled",value:pe},--P==0&&D(x)}for(var Z=0;Z<x.length;Z++)N(Z,x[Z])})},j.resolve=function(E){return E&&C(E)==="object"&&E.constructor===j?E:new j(function(D){D(E)})},j.reject=function(E){return new j(function(D,z){z(E)})},j.race=function(E){return new j(function(D,z){if(!ae(E))return z(new TypeError("Promise.race accepts an array"));for(var x=0,P=E.length;x<P;x++)j.resolve(E[x]).then(D,z)})},j._immediateFn=typeof setImmediate=="function"&&function(E){setImmediate(E)}||function(E){Q(E,0)},j._unhandledRejectionFn=function(E){typeof console!="undefined"&&console&&console.warn("Possible Unhandled Promise Rejection:",E)};const Le=j;var Pe=/mobile/i.test(window.navigator.userAgent);const De={secondToTime:function(E){if((E=E||0)===0||E===1/0||E.toString()==="NaN")return"00:00";var D=Math.floor(E/3600),z=Math.floor((E-3600*D)/60),x=Math.floor(E-3600*D-60*z);return(D>0?[D,z,x]:[z,x]).map(function(P){return P<10?"0"+P:""+P}).join(":")},getElementViewLeft:function(E){var D=E.offsetLeft,z=E.offsetParent,x=document.body.scrollLeft+document.documentElement.scrollLeft;if(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement)for(;z!==null&&z!==E;)D+=z.offsetLeft,z=z.offsetParent;else for(;z!==null;)D+=z.offsetLeft,z=z.offsetParent;return D-x},getBoundingClientRectViewLeft:function(E){var D=window.scrollY||window.pageYOffset||document.body.scrollTop+(document.documentElement&&document.documentElement.scrollTop||0);if(E.getBoundingClientRect){if(typeof this.getBoundingClientRectViewLeft.offset!="number"){var z=document.createElement("div");z.style.cssText="position:absolute;top:0;left:0;",document.body.appendChild(z),this.getBoundingClientRectViewLeft.offset=-z.getBoundingClientRect().top-D,document.body.removeChild(z),z=null}var x=E.getBoundingClientRect(),P=this.getBoundingClientRectViewLeft.offset;return x.left+P}return this.getElementViewLeft(E)},getScrollPosition:function(){return{left:window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0,top:window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0}},setScrollPosition:function(E){var D=E.left,z=D===void 0?0:D,x=E.top,P=x===void 0?0:x;this.isFirefox?(document.documentElement.scrollLeft=z,document.documentElement.scrollTop=P):window.scrollTo(z,P)},isMobile:Pe,isFirefox:/firefox/i.test(window.navigator.userAgent),isChrome:/chrome/i.test(window.navigator.userAgent),isSafari:/safari/i.test(window.navigator.userAgent),storage:{set:function(E,D){localStorage.setItem(E,D)},get:function(E){return localStorage.getItem(E)}},nameMap:{dragStart:Pe?"touchstart":"mousedown",dragMove:Pe?"touchmove":"mousemove",dragEnd:Pe?"touchend":"mouseup"},color2Number:function(E){return E[0]==="#"&&(E=E.substr(1)),E.length===3&&(E="".concat(E[0]).concat(E[0]).concat(E[1]).concat(E[1]).concat(E[2]).concat(E[2])),parseInt(E,16)+0&16777215},number2Color:function(E){return"#"+("00000"+E.toString(16)).slice(-6)},number2Type:function(E){switch(E){case 0:default:return"right";case 1:return"top";case 2:return"bottom"}}};function Ve(E,D){return function(){return E.apply(D,arguments)}}function Oe(E){return Oe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},Oe(E)}var dt,Nt=Object.prototype.toString,It=Object.getPrototypeOf,gt=(dt=Object.create(null),function(E){var D=Nt.call(E);return dt[D]||(dt[D]=D.slice(8,-1).toLowerCase())}),nt=function(E){return E=E.toLowerCase(),function(D){return gt(D)===E}},Ht=function(E){return function(D){return Oe(D)===E}},Tt=Array.isArray,Gt=Ht("undefined"),hi=nt("ArrayBuffer"),ai=Ht("string"),Ei=Ht("function"),Ai=Ht("number"),Ct=function(E){return E!==null&&Oe(E)==="object"},di=function(E){if(gt(E)!=="object")return!1;var D=It(E);return!(D!==null&&D!==Object.prototype&&Object.getPrototypeOf(D)!==null||Symbol.toStringTag in E||Symbol.iterator in E)},ui=nt("Date"),ji=nt("File"),un=nt("Blob"),$i=nt("FileList"),wt=nt("URLSearchParams");function mn(E,D){var z,x,P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},N=P.allOwnKeys,Z=N!==void 0&&N;if(E!=null)if(Oe(E)!=="object"&&(E=[E]),Tt(E))for(z=0,x=E.length;z<x;z++)D.call(null,E[z],z,E);else{var fe,pe=Z?Object.getOwnPropertyNames(E):Object.keys(E),He=pe.length;for(z=0;z<He;z++)fe=pe[z],D.call(null,E[fe],fe,E)}}function pi(E,D){D=D.toLowerCase();for(var z,x=Object.keys(E),P=x.length;P-- >0;)if(D===(z=x[P]).toLowerCase())return z;return null}var ti,_i,Vi=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:mt.g,nr=function(E){return!Gt(E)&&E!==Vi},Bs=(ti=typeof Uint8Array!="undefined"&&It(Uint8Array),function(E){return ti&&E instanceof ti}),cs=nt("HTMLFormElement"),nn=(_i=Object.prototype.hasOwnProperty,function(E,D){return _i.call(E,D)}),Ms=nt("RegExp"),Ze=function(E,D){var z=Object.getOwnPropertyDescriptors(E),x={};mn(z,function(P,N){D(P,N,E)!==!1&&(x[N]=P)}),Object.defineProperties(E,x)};const ke={isArray:Tt,isArrayBuffer:hi,isBuffer:function(E){return E!==null&&!Gt(E)&&E.constructor!==null&&!Gt(E.constructor)&&Ei(E.constructor.isBuffer)&&E.constructor.isBuffer(E)},isFormData:function(E){var D="[object FormData]";return E&&(typeof FormData=="function"&&E instanceof FormData||Nt.call(E)===D||Ei(E.toString)&&E.toString()===D)},isArrayBufferView:function(E){return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?ArrayBuffer.isView(E):E&&E.buffer&&hi(E.buffer)},isString:ai,isNumber:Ai,isBoolean:function(E){return E===!0||E===!1},isObject:Ct,isPlainObject:di,isUndefined:Gt,isDate:ui,isFile:ji,isBlob:un,isRegExp:Ms,isFunction:Ei,isStream:function(E){return Ct(E)&&Ei(E.pipe)},isURLSearchParams:wt,isTypedArray:Bs,isFileList:$i,forEach:mn,merge:function E(){for(var D=nr(this)&&this||{},z=D.caseless,x={},P=function(fe,pe){var He=z&&pi(x,pe)||pe;di(x[He])&&di(fe)?x[He]=E(x[He],fe):di(fe)?x[He]=E({},fe):Tt(fe)?x[He]=fe.slice():x[He]=fe},N=0,Z=arguments.length;N<Z;N++)arguments[N]&&mn(arguments[N],P);return x},extend:function(E,D,z){var x=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},P=x.allOwnKeys;return mn(D,function(N,Z){z&&Ei(N)?E[Z]=Ve(N,z):E[Z]=N},{allOwnKeys:P}),E},trim:function(E){return E.trim?E.trim():E.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},stripBOM:function(E){return E.charCodeAt(0)===65279&&(E=E.slice(1)),E},inherits:function(E,D,z,x){E.prototype=Object.create(D.prototype,x),E.prototype.constructor=E,Object.defineProperty(E,"super",{value:D.prototype}),z&&Object.assign(E.prototype,z)},toFlatObject:function(E,D,z,x){var P,N,Z,fe={};if(D=D||{},E==null)return D;do{for(N=(P=Object.getOwnPropertyNames(E)).length;N-- >0;)Z=P[N],x&&!x(Z,E,D)||fe[Z]||(D[Z]=E[Z],fe[Z]=!0);E=z!==!1&&It(E)}while(E&&(!z||z(E,D))&&E!==Object.prototype);return D},kindOf:gt,kindOfTest:nt,endsWith:function(E,D,z){E=String(E),(z===void 0||z>E.length)&&(z=E.length),z-=D.length;var x=E.indexOf(D,z);return x!==-1&&x===z},toArray:function(E){if(!E)return null;if(Tt(E))return E;var D=E.length;if(!Ai(D))return null;for(var z=new Array(D);D-- >0;)z[D]=E[D];return z},forEachEntry:function(E,D){for(var z,x=(E&&E[Symbol.iterator]).call(E);(z=x.next())&&!z.done;){var P=z.value;D.call(E,P[0],P[1])}},matchAll:function(E,D){for(var z,x=[];(z=E.exec(D))!==null;)x.push(z);return x},isHTMLForm:cs,hasOwnProperty:nn,hasOwnProp:nn,reduceDescriptors:Ze,freezeMethods:function(E){Ze(E,function(D,z){if(Ei(E)&&["arguments","caller","callee"].indexOf(z)!==-1)return!1;var x=E[z];Ei(x)&&(D.enumerable=!1,"writable"in D?D.writable=!1:D.set||(D.set=function(){throw Error("Can not rewrite read-only method '"+z+"'")}))})},toObjectSet:function(E,D){var z={},x=function(P){P.forEach(function(N){z[N]=!0})};return Tt(E)?x(E):x(String(E).split(D)),z},toCamelCase:function(E){return E.toLowerCase().replace(/[_-\s]([a-z\d])(\w*)/g,function(D,z,x){return z.toUpperCase()+x})},noop:function(){},toFiniteNumber:function(E,D){return E=+E,Number.isFinite(E)?E:D},findKey:pi,global:Vi,isContextDefined:nr,toJSONObject:function(E){var D=new Array(10);return function z(x,P){if(Ct(x)){if(D.indexOf(x)>=0)return;if(!("toJSON"in x)){D[P]=x;var N=Tt(x)?[]:{};return mn(x,function(Z,fe){var pe=z(Z,P+1);!Gt(pe)&&(N[fe]=pe)}),D[P]=void 0,N}}return x}(E,0)}};function rt(E,D,z,x,P){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=E,this.name="AxiosError",D&&(this.code=D),z&&(this.config=z),x&&(this.request=x),P&&(this.response=P)}ke.inherits(rt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ke.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var Lt=rt.prototype,Yt={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(function(E){Yt[E]={value:E}}),Object.defineProperties(rt,Yt),Object.defineProperty(Lt,"isAxiosError",{value:!0}),rt.from=function(E,D,z,x,P,N){var Z=Object.create(Lt);return ke.toFlatObject(E,Z,function(fe){return fe!==Error.prototype},function(fe){return fe!=="isAxiosError"}),rt.call(Z,E.message,D,z,x,P),Z.cause=E,Z.name=E.name,N&&Object.assign(Z,N),Z};const Dt=rt,ki=ve(937);function mi(E){return mi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},mi(E)}function Pn(E){return ke.isPlainObject(E)||ke.isArray(E)}function Mt(E){return ke.endsWith(E,"[]")?E.slice(0,-2):E}function mr(E,D,z){return E?E.concat(D).map(function(x,P){return x=Mt(x),!z&&P?"["+x+"]":x}).join(z?".":""):D}var hs=ke.toFlatObject(ke,{},null,function(E){return/^is[A-Z]/.test(E)});const Ti=function(E,D,z){if(!ke.isObject(E))throw new TypeError("target must be an object");D=D||new(ki||FormData);var x,P=(z=ke.toFlatObject(z,{metaTokens:!0,dots:!1,indexes:!1},!1,function(Rt,Et){return!ke.isUndefined(Et[Rt])})).metaTokens,N=z.visitor||tt,Z=z.dots,fe=z.indexes,pe=(z.Blob||typeof Blob!="undefined"&&Blob)&&(x=D)&&ke.isFunction(x.append)&&x[Symbol.toStringTag]==="FormData"&&x[Symbol.iterator];if(!ke.isFunction(N))throw new TypeError("visitor must be a function");function He(Rt){if(Rt===null)return"";if(ke.isDate(Rt))return Rt.toISOString();if(!pe&&ke.isBlob(Rt))throw new Dt("Blob is not supported. Use a Buffer instead.");return ke.isArrayBuffer(Rt)||ke.isTypedArray(Rt)?pe&&typeof Blob=="function"?new Blob([Rt]):ct.from(Rt):Rt}function tt(Rt,Et,bt){var Ot=Rt;if(Rt&&!bt&&mi(Rt)==="object"){if(ke.endsWith(Et,"{}"))Et=P?Et:Et.slice(0,-2),Rt=JSON.stringify(Rt);else if(ke.isArray(Rt)&&function(Zt){return ke.isArray(Zt)&&!Zt.some(Pn)}(Rt)||ke.isFileList(Rt)||ke.endsWith(Et,"[]")&&(Ot=ke.toArray(Rt)))return Et=Mt(Et),Ot.forEach(function(Zt,Gi){!ke.isUndefined(Zt)&&Zt!==null&&D.append(fe===!0?mr([Et],Gi,Z):fe===null?Et:Et+"[]",He(Zt))}),!1}return!!Pn(Rt)||(D.append(mr(bt,Et,Z),He(Rt)),!1)}var vt=[],_t=Object.assign(hs,{defaultVisitor:tt,convertValue:He,isVisitable:Pn});if(!ke.isObject(E))throw new TypeError("data must be an object");return function Rt(Et,bt){if(!ke.isUndefined(Et)){if(vt.indexOf(Et)!==-1)throw Error("Circular reference detected in "+bt.join("."));vt.push(Et),ke.forEach(Et,function(Ot,Zt){(!(ke.isUndefined(Ot)||Ot===null)&&N.call(D,Ot,ke.isString(Zt)?Zt.trim():Zt,bt,_t))===!0&&Rt(Ot,bt?bt.concat(Zt):[Zt])}),vt.pop()}}(E),D};function Lr(E){var D={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(E).replace(/[!'()~]|%20|%00/g,function(z){return D[z]})}function Jt(E,D){this._pairs=[],E&&Ti(E,this,D)}var rr=Jt.prototype;rr.append=function(E,D){this._pairs.push([E,D])},rr.toString=function(E){var D=E?function(z){return E.call(this,z,Lr)}:Lr;return this._pairs.map(function(z){return D(z[0])+"="+D(z[1])},"").join("&")};const Kr=Jt;function ca(E){return encodeURIComponent(E).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Dr(E,D,z){if(!D)return E;var x,P=z&&z.encode||ca,N=z&&z.serialize;if(x=N?N(D,z):ke.isURLSearchParams(D)?D.toString():new Kr(D,z).toString(P)){var Z=E.indexOf("#");Z!==-1&&(E=E.slice(0,Z)),E+=(E.indexOf("?")===-1?"?":"&")+x}return E}function Yi(E){return Yi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},Yi(E)}function dn(E,D){for(var z=0;z<D.length;z++){var x=D[z];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(E,(P=function(N,Z){if(Yi(N)!=="object"||N===null)return N;var fe=N[Symbol.toPrimitive];if(fe!==void 0){var pe=fe.call(N,"string");if(Yi(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(N)}(x.key),Yi(P)==="symbol"?P:String(P)),x)}var P}var Fs=function(){function E(){(function(x,P){if(!(x instanceof P))throw new TypeError("Cannot call a class as a function")})(this,E),this.handlers=[]}var D,z;return D=E,z=[{key:"use",value:function(x,P,N){return this.handlers.push({fulfilled:x,rejected:P,synchronous:!!N&&N.synchronous,runWhen:N?N.runWhen:null}),this.handlers.length-1}},{key:"eject",value:function(x){this.handlers[x]&&(this.handlers[x]=null)}},{key:"clear",value:function(){this.handlers&&(this.handlers=[])}},{key:"forEach",value:function(x){ke.forEach(this.handlers,function(P){P!==null&&x(P)})}}],z&&dn(D.prototype,z),Object.defineProperty(D,"prototype",{writable:!1}),E}();const Yr=Fs,ko={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ie=typeof URLSearchParams!="undefined"?URLSearchParams:Kr,le=FormData;var Se,Xe=(typeof navigator=="undefined"||(Se=navigator.product)!=="ReactNative"&&Se!=="NativeScript"&&Se!=="NS")&&typeof window!="undefined"&&typeof document!="undefined",ft=typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function";const jt={isBrowser:!0,classes:{URLSearchParams:ie,FormData:le,Blob},isStandardBrowserEnv:Xe,isStandardBrowserWebWorkerEnv:ft,protocols:["http","https","file","blob","url","data"]},bi=function(E){function D(x,P,N,Z){var fe=x[Z++],pe=Number.isFinite(+fe),He=Z>=x.length;return fe=!fe&&ke.isArray(N)?N.length:fe,He?(ke.hasOwnProp(N,fe)?N[fe]=[N[fe],P]:N[fe]=P,!pe):(N[fe]&&ke.isObject(N[fe])||(N[fe]=[]),D(x,P,N[fe],Z)&&ke.isArray(N[fe])&&(N[fe]=function(tt){var vt,_t,Rt={},Et=Object.keys(tt),bt=Et.length;for(vt=0;vt<bt;vt++)Rt[_t=Et[vt]]=tt[_t];return Rt}(N[fe])),!pe)}if(ke.isFormData(E)&&ke.isFunction(E.entries)){var z={};return ke.forEachEntry(E,function(x,P){D(function(N){return ke.matchAll(/\w+|\[(\w*)]/g,N).map(function(Z){return Z[0]==="[]"?"":Z[1]||Z[0]})}(x),P,z,0)}),z}return null};var Di={"Content-Type":void 0},cn={transitional:ko,adapter:["xhr","http"],transformRequest:[function(E,D){var z,x=D.getContentType()||"",P=x.indexOf("application/json")>-1,N=ke.isObject(E);if(N&&ke.isHTMLForm(E)&&(E=new FormData(E)),ke.isFormData(E))return P&&P?JSON.stringify(bi(E)):E;if(ke.isArrayBuffer(E)||ke.isBuffer(E)||ke.isStream(E)||ke.isFile(E)||ke.isBlob(E))return E;if(ke.isArrayBufferView(E))return E.buffer;if(ke.isURLSearchParams(E))return D.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),E.toString();if(N){if(x.indexOf("application/x-www-form-urlencoded")>-1)return function(fe,pe){return Ti(fe,new jt.classes.URLSearchParams,Object.assign({visitor:function(He,tt,vt,_t){return jt.isNode&&ke.isBuffer(He)?(this.append(tt,He.toString("base64")),!1):_t.defaultVisitor.apply(this,arguments)}},pe))}(E,this.formSerializer).toString();if((z=ke.isFileList(E))||x.indexOf("multipart/form-data")>-1){var Z=this.env&&this.env.FormData;return Ti(z?{"files[]":E}:E,Z&&new Z,this.formSerializer)}}return N||P?(D.setContentType("application/json",!1),function(fe,pe,He){if(ke.isString(fe))try{return(0,JSON.parse)(fe),ke.trim(fe)}catch(tt){if(tt.name!=="SyntaxError")throw tt}return(0,JSON.stringify)(fe)}(E)):E}],transformResponse:[function(E){var D=this.transitional||cn.transitional,z=D&&D.forcedJSONParsing,x=this.responseType==="json";if(E&&ke.isString(E)&&(z&&!this.responseType||x)){var P=!(D&&D.silentJSONParsing)&&x;try{return JSON.parse(E)}catch(N){if(P)throw N.name==="SyntaxError"?Dt.from(N,Dt.ERR_BAD_RESPONSE,this,null,this.response):N}}return E}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:jt.classes.FormData,Blob:jt.classes.Blob},validateStatus:function(E){return E>=200&&E<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};ke.forEach(["delete","get","head"],function(E){cn.headers[E]={}}),ke.forEach(["post","put","patch"],function(E){cn.headers[E]=ke.merge(Di)});const hn=cn;var Wn=ke.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]);function sr(E){return sr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},sr(E)}function On(E,D){(D==null||D>E.length)&&(D=E.length);for(var z=0,x=new Array(D);z<D;z++)x[z]=E[z];return x}function Fn(E,D){for(var z=0;z<D.length;z++){var x=D[z];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(E,(P=function(N,Z){if(sr(N)!=="object"||N===null)return N;var fe=N[Symbol.toPrimitive];if(fe!==void 0){var pe=fe.call(N,"string");if(sr(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(N)}(x.key),sr(P)==="symbol"?P:String(P)),x)}var P}var An=Symbol("internals");function Xi(E){return E&&String(E).trim().toLowerCase()}function Nn(E){return E===!1||E==null?E:ke.isArray(E)?E.map(Nn):String(E)}function gr(E,D,z,x){return ke.isFunction(x)?x.call(this,D,z):ke.isString(D)?ke.isString(x)?D.indexOf(x)!==-1:ke.isRegExp(x)?x.test(D):void 0:void 0}var kr=function(E,D){function z(Z){(function(fe,pe){if(!(fe instanceof pe))throw new TypeError("Cannot call a class as a function")})(this,z),Z&&this.set(Z)}var x,P,N;return x=z,P=[{key:"set",value:function(Z,fe,pe){var He=this;function tt(Zt,Gi,qi){var vi=Xi(Gi);if(!vi)throw new Error("header name must be a non-empty string");var hr=ke.findKey(He,vi);(!hr||He[hr]===void 0||qi===!0||qi===void 0&&He[hr]!==!1)&&(He[hr||Gi]=Nn(Zt))}var vt,_t,Rt,Et,bt,Ot=function(Zt,Gi){return ke.forEach(Zt,function(qi,vi){return tt(qi,vi,Gi)})};return ke.isPlainObject(Z)||Z instanceof this.constructor?Ot(Z,fe):ke.isString(Z)&&(Z=Z.trim())&&!/^[-_a-zA-Z]+$/.test(Z.trim())?Ot((bt={},(vt=Z)&&vt.split(`
`).forEach(function(Zt){Et=Zt.indexOf(":"),_t=Zt.substring(0,Et).trim().toLowerCase(),Rt=Zt.substring(Et+1).trim(),!_t||bt[_t]&&Wn[_t]||(_t==="set-cookie"?bt[_t]?bt[_t].push(Rt):bt[_t]=[Rt]:bt[_t]=bt[_t]?bt[_t]+", "+Rt:Rt)}),bt),fe):Z!=null&&tt(fe,Z,pe),this}},{key:"get",value:function(Z,fe){if(Z=Xi(Z)){var pe=ke.findKey(this,Z);if(pe){var He=this[pe];if(!fe)return He;if(fe===!0)return function(tt){for(var vt,_t=Object.create(null),Rt=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;vt=Rt.exec(tt);)_t[vt[1]]=vt[2];return _t}(He);if(ke.isFunction(fe))return fe.call(this,He,pe);if(ke.isRegExp(fe))return fe.exec(He);throw new TypeError("parser must be boolean|regexp|function")}}}},{key:"has",value:function(Z,fe){if(Z=Xi(Z)){var pe=ke.findKey(this,Z);return!(!pe||fe&&!gr(0,this[pe],pe,fe))}return!1}},{key:"delete",value:function(Z,fe){var pe=this,He=!1;function tt(vt){if(vt=Xi(vt)){var _t=ke.findKey(pe,vt);!_t||fe&&!gr(0,pe[_t],_t,fe)||(delete pe[_t],He=!0)}}return ke.isArray(Z)?Z.forEach(tt):tt(Z),He}},{key:"clear",value:function(){return Object.keys(this).forEach(this.delete.bind(this))}},{key:"normalize",value:function(Z){var fe=this,pe={};return ke.forEach(this,function(He,tt){var vt=ke.findKey(pe,tt);if(vt)return fe[vt]=Nn(He),void delete fe[tt];var _t=Z?function(Rt){return Rt.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,function(Et,bt,Ot){return bt.toUpperCase()+Ot})}(tt):String(tt).trim();_t!==tt&&delete fe[tt],fe[_t]=Nn(He),pe[_t]=!0}),this}},{key:"concat",value:function(){for(var Z,fe=arguments.length,pe=new Array(fe),He=0;He<fe;He++)pe[He]=arguments[He];return(Z=this.constructor).concat.apply(Z,[this].concat(pe))}},{key:"toJSON",value:function(Z){var fe=Object.create(null);return ke.forEach(this,function(pe,He){pe!=null&&pe!==!1&&(fe[He]=Z&&ke.isArray(pe)?pe.join(", "):pe)}),fe}},{key:Symbol.iterator,value:function(){return Object.entries(this.toJSON())[Symbol.iterator]()}},{key:"toString",value:function(){return Object.entries(this.toJSON()).map(function(Z){var fe,pe,He=(pe=2,function(tt){if(Array.isArray(tt))return tt}(fe=Z)||function(tt,vt){var _t=tt==null?null:typeof Symbol!="undefined"&&tt[Symbol.iterator]||tt["@@iterator"];if(_t!=null){var Rt,Et,bt,Ot,Zt=[],Gi=!0,qi=!1;try{if(bt=(_t=_t.call(tt)).next,vt===0){if(Object(_t)!==_t)return;Gi=!1}else for(;!(Gi=(Rt=bt.call(_t)).done)&&(Zt.push(Rt.value),Zt.length!==vt);Gi=!0);}catch(vi){qi=!0,Et=vi}finally{try{if(!Gi&&_t.return!=null&&(Ot=_t.return(),Object(Ot)!==Ot))return}finally{if(qi)throw Et}}return Zt}}(fe,pe)||function(tt,vt){if(tt){if(typeof tt=="string")return On(tt,vt);var _t=Object.prototype.toString.call(tt).slice(8,-1);return _t==="Object"&&tt.constructor&&(_t=tt.constructor.name),_t==="Map"||_t==="Set"?Array.from(tt):_t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_t)?On(tt,vt):void 0}}(fe,pe)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}());return He[0]+": "+He[1]}).join(`
`)}},{key:Symbol.toStringTag,get:function(){return"AxiosHeaders"}}],N=[{key:"from",value:function(Z){return Z instanceof this?Z:new this(Z)}},{key:"concat",value:function(Z){for(var fe=new this(Z),pe=arguments.length,He=new Array(pe>1?pe-1:0),tt=1;tt<pe;tt++)He[tt-1]=arguments[tt];return He.forEach(function(vt){return fe.set(vt)}),fe}},{key:"accessor",value:function(Z){var fe=(this[An]=this[An]={accessors:{}}).accessors,pe=this.prototype;function He(tt){var vt=Xi(tt);fe[vt]||(function(_t,Rt){var Et=ke.toCamelCase(" "+Rt);["get","set","has"].forEach(function(bt){Object.defineProperty(_t,bt+Et,{value:function(Ot,Zt,Gi){return this[bt].call(this,Rt,Ot,Zt,Gi)},configurable:!0})})}(pe,tt),fe[vt]=!0)}return ke.isArray(Z)?Z.forEach(He):He(Z),this}}],P&&Fn(x.prototype,P),N&&Fn(x,N),Object.defineProperty(x,"prototype",{writable:!1}),z}();kr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent"]),ke.freezeMethods(kr.prototype),ke.freezeMethods(kr);const xi=kr;function Ir(E,D){var z=this||hn,x=D||z,P=xi.from(x.headers),N=x.data;return ke.forEach(E,function(Z){N=Z.call(z,N,P.normalize(),D?D.status:void 0)}),P.normalize(),N}function Ga(E){return!(!E||!E.__CANCEL__)}function Io(E,D,z){Dt.call(this,E==null?"canceled":E,Dt.ERR_CANCELED,D,z),this.name="CanceledError"}ke.inherits(Io,Dt,{__CANCEL__:!0});const ar=Io,Il=jt.isStandardBrowserEnv?{write:function(E,D,z,x,P,N){var Z=[];Z.push(E+"="+encodeURIComponent(D)),ke.isNumber(z)&&Z.push("expires="+new Date(z).toGMTString()),ke.isString(x)&&Z.push("path="+x),ke.isString(P)&&Z.push("domain="+P),N===!0&&Z.push("secure"),document.cookie=Z.join("; ")},read:function(E){var D=document.cookie.match(new RegExp("(^|;\\s*)("+E+")=([^;]*)"));return D?decodeURIComponent(D[3]):null},remove:function(E){this.write(E,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}};function Ns(E,D){return E&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(D)?function(z,x){return x?z.replace(/\/+$/,"")+"/"+x.replace(/^\/+/,""):z}(E,D):D}const Ro=jt.isStandardBrowserEnv?function(){var E,D=/(msie|trident)/i.test(navigator.userAgent),z=document.createElement("a");function x(P){var N=P;return D&&(z.setAttribute("href",N),N=z.href),z.setAttribute("href",N),{href:z.href,protocol:z.protocol?z.protocol.replace(/:$/,""):"",host:z.host,search:z.search?z.search.replace(/^\?/,""):"",hash:z.hash?z.hash.replace(/^#/,""):"",hostname:z.hostname,port:z.port,pathname:z.pathname.charAt(0)==="/"?z.pathname:"/"+z.pathname}}return E=x(window.location.href),function(P){var N=ke.isString(P)?x(P):P;return N.protocol===E.protocol&&N.host===E.host}}():function(){return!0};function ha(E,D){var z=0,x=function(P,N){P=P||10;var Z,fe=new Array(P),pe=new Array(P),He=0,tt=0;return N=N!==void 0?N:1e3,function(vt){var _t=Date.now(),Rt=pe[tt];Z||(Z=_t),fe[He]=vt,pe[He]=_t;for(var Et=tt,bt=0;Et!==He;)bt+=fe[Et++],Et%=P;if((He=(He+1)%P)===tt&&(tt=(tt+1)%P),!(_t-Z<N)){var Ot=Rt&&_t-Rt;return Ot?Math.round(1e3*bt/Ot):void 0}}}(50,250);return function(P){var N=P.loaded,Z=P.lengthComputable?P.total:void 0,fe=N-z,pe=x(fe);z=N;var He={loaded:N,total:Z,progress:Z?N/Z:void 0,bytes:fe,rate:pe||void 0,estimated:pe&&Z&&N<=Z?(Z-N)/pe:void 0,event:P};He[D?"download":"upload"]=!0,E(He)}}const Po=typeof XMLHttpRequest!="undefined"&&function(E){return new Promise(function(D,z){var x,P=E.data,N=xi.from(E.headers).normalize(),Z=E.responseType;function fe(){E.cancelToken&&E.cancelToken.unsubscribe(x),E.signal&&E.signal.removeEventListener("abort",x)}ke.isFormData(P)&&(jt.isStandardBrowserEnv||jt.isStandardBrowserWebWorkerEnv)&&N.setContentType(!1);var pe=new XMLHttpRequest;if(E.auth){var He=E.auth.username||"",tt=E.auth.password?unescape(encodeURIComponent(E.auth.password)):"";N.set("Authorization","Basic "+btoa(He+":"+tt))}var vt=Ns(E.baseURL,E.url);function _t(){if(pe){var Ot=xi.from("getAllResponseHeaders"in pe&&pe.getAllResponseHeaders());(function(Zt,Gi,qi){var vi=qi.config.validateStatus;qi.status&&vi&&!vi(qi.status)?Gi(new Dt("Request failed with status code "+qi.status,[Dt.ERR_BAD_REQUEST,Dt.ERR_BAD_RESPONSE][Math.floor(qi.status/100)-4],qi.config,qi.request,qi)):Zt(qi)})(function(Zt){D(Zt),fe()},function(Zt){z(Zt),fe()},{data:Z&&Z!=="text"&&Z!=="json"?pe.response:pe.responseText,status:pe.status,statusText:pe.statusText,headers:Ot,config:E,request:pe}),pe=null}}if(pe.open(E.method.toUpperCase(),Dr(vt,E.params,E.paramsSerializer),!0),pe.timeout=E.timeout,"onloadend"in pe?pe.onloadend=_t:pe.onreadystatechange=function(){pe&&pe.readyState===4&&(pe.status!==0||pe.responseURL&&pe.responseURL.indexOf("file:")===0)&&setTimeout(_t)},pe.onabort=function(){pe&&(z(new Dt("Request aborted",Dt.ECONNABORTED,E,pe)),pe=null)},pe.onerror=function(){z(new Dt("Network Error",Dt.ERR_NETWORK,E,pe)),pe=null},pe.ontimeout=function(){var Ot=E.timeout?"timeout of "+E.timeout+"ms exceeded":"timeout exceeded",Zt=E.transitional||ko;E.timeoutErrorMessage&&(Ot=E.timeoutErrorMessage),z(new Dt(Ot,Zt.clarifyTimeoutError?Dt.ETIMEDOUT:Dt.ECONNABORTED,E,pe)),pe=null},jt.isStandardBrowserEnv){var Rt=(E.withCredentials||Ro(vt))&&E.xsrfCookieName&&Il.read(E.xsrfCookieName);Rt&&N.set(E.xsrfHeaderName,Rt)}P===void 0&&N.setContentType(null),"setRequestHeader"in pe&&ke.forEach(N.toJSON(),function(Ot,Zt){pe.setRequestHeader(Zt,Ot)}),ke.isUndefined(E.withCredentials)||(pe.withCredentials=!!E.withCredentials),Z&&Z!=="json"&&(pe.responseType=E.responseType),typeof E.onDownloadProgress=="function"&&pe.addEventListener("progress",ha(E.onDownloadProgress,!0)),typeof E.onUploadProgress=="function"&&pe.upload&&pe.upload.addEventListener("progress",ha(E.onUploadProgress)),(E.cancelToken||E.signal)&&(x=function(Ot){pe&&(z(!Ot||Ot.type?new ar(null,E,pe):Ot),pe.abort(),pe=null)},E.cancelToken&&E.cancelToken.subscribe(x),E.signal&&(E.signal.aborted?x():E.signal.addEventListener("abort",x)));var Et,bt=(Et=/^([-+\w]{1,25})(:?\/\/|:)/.exec(vt))&&Et[1]||"";bt&&jt.protocols.indexOf(bt)===-1?z(new Dt("Unsupported protocol "+bt+":",Dt.ERR_BAD_REQUEST,E)):pe.send(P||null)})};var Rr={http:null,xhr:Po};ke.forEach(Rr,function(E,D){if(E){try{Object.defineProperty(E,"name",{value:D})}catch(z){}Object.defineProperty(E,"adapterName",{value:D})}});function fa(E){if(E.cancelToken&&E.cancelToken.throwIfRequested(),E.signal&&E.signal.aborted)throw new ar(null,E)}function Us(E){return fa(E),E.headers=xi.from(E.headers),E.data=Ir.call(E,E.transformRequest),["post","put","patch"].indexOf(E.method)!==-1&&E.headers.setContentType("application/x-www-form-urlencoded",!1),function(D){for(var z,x,P=(D=ke.isArray(D)?D:[D]).length,N=0;N<P&&(z=D[N],!(x=ke.isString(z)?Rr[z.toLowerCase()]:z));N++);if(!x)throw x===!1?new Dt("Adapter ".concat(z," is not supported by the environment"),"ERR_NOT_SUPPORT"):new Error(ke.hasOwnProp(Rr,z)?"Adapter '".concat(z,"' is not available in the build"):"Unknown adapter '".concat(z,"'"));if(!ke.isFunction(x))throw new TypeError("adapter is not a function");return x}(E.adapter||hn.adapter)(E).then(function(D){return fa(E),D.data=Ir.call(E,E.transformResponse,D),D.headers=xi.from(D.headers),D},function(D){return Ga(D)||(fa(E),D&&D.response&&(D.response.data=Ir.call(E,E.transformResponse,D.response),D.response.headers=xi.from(D.response.headers))),Promise.reject(D)})}var js=function(E){return E instanceof xi?E.toJSON():E};function fs(E,D){D=D||{};var z={};function x(He,tt,vt){return ke.isPlainObject(He)&&ke.isPlainObject(tt)?ke.merge.call({caseless:vt},He,tt):ke.isPlainObject(tt)?ke.merge({},tt):ke.isArray(tt)?tt.slice():tt}function P(He,tt,vt){return ke.isUndefined(tt)?ke.isUndefined(He)?void 0:x(void 0,He,vt):x(He,tt,vt)}function N(He,tt){if(!ke.isUndefined(tt))return x(void 0,tt)}function Z(He,tt){return ke.isUndefined(tt)?ke.isUndefined(He)?void 0:x(void 0,He):x(void 0,tt)}function fe(He,tt,vt){return vt in D?x(He,tt):vt in E?x(void 0,He):void 0}var pe={url:N,method:N,data:N,baseURL:Z,transformRequest:Z,transformResponse:Z,paramsSerializer:Z,timeout:Z,timeoutMessage:Z,withCredentials:Z,adapter:Z,responseType:Z,xsrfCookieName:Z,xsrfHeaderName:Z,onUploadProgress:Z,onDownloadProgress:Z,decompress:Z,maxContentLength:Z,maxBodyLength:Z,beforeRedirect:Z,transport:Z,httpAgent:Z,httpsAgent:Z,cancelToken:Z,socketPath:Z,responseEncoding:Z,validateStatus:fe,headers:function(He,tt){return P(js(He),js(tt),!0)}};return ke.forEach(Object.keys(E).concat(Object.keys(D)),function(He){var tt=pe[He]||P,vt=tt(E[He],D[He],He);ke.isUndefined(vt)&&tt!==fe||(z[He]=vt)}),z}function pa(E){return pa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},pa(E)}var ps={};["object","boolean","number","function","string","symbol"].forEach(function(E,D){ps[E]=function(z){return pa(z)===E||"a"+(D<1?"n ":" ")+E}});var qa={};ps.transitional=function(E,D,z){function x(P,N){return"[Axios v1.2.3] Transitional option '"+P+"'"+N+(z?". "+z:"")}return function(P,N,Z){if(E===!1)throw new Dt(x(N," has been removed"+(D?" in "+D:"")),Dt.ERR_DEPRECATED);return D&&!qa[N]&&(qa[N]=!0,console.warn(x(N," has been deprecated since v"+D+" and will be removed in the near future"))),!E||E(P,N,Z)}};const za={assertOptions:function(E,D,z){if(pa(E)!=="object")throw new Dt("options must be an object",Dt.ERR_BAD_OPTION_VALUE);for(var x=Object.keys(E),P=x.length;P-- >0;){var N=x[P],Z=D[N];if(Z){var fe=E[N],pe=fe===void 0||Z(fe,N,E);if(pe!==!0)throw new Dt("option "+N+" must be "+pe,Dt.ERR_BAD_OPTION_VALUE)}else if(z!==!0)throw new Dt("Unknown option "+N,Dt.ERR_BAD_OPTION)}},validators:ps};function ms(E){return ms=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},ms(E)}function Ii(E,D){for(var z=0;z<D.length;z++){var x=D[z];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(E,(P=function(N,Z){if(ms(N)!=="object"||N===null)return N;var fe=N[Symbol.toPrimitive];if(fe!==void 0){var pe=fe.call(N,"string");if(ms(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(N)}(x.key),ms(P)==="symbol"?P:String(P)),x)}var P}var Un=za.validators,$s=function(){function E(x){(function(P,N){if(!(P instanceof N))throw new TypeError("Cannot call a class as a function")})(this,E),this.defaults=x,this.interceptors={request:new Yr,response:new Yr}}var D,z;return D=E,(z=[{key:"request",value:function(x,P){typeof x=="string"?(P=P||{}).url=x:P=x||{};var N,Z=P=fs(this.defaults,P),fe=Z.transitional,pe=Z.paramsSerializer,He=Z.headers;fe!==void 0&&za.assertOptions(fe,{silentJSONParsing:Un.transitional(Un.boolean),forcedJSONParsing:Un.transitional(Un.boolean),clarifyTimeoutError:Un.transitional(Un.boolean)},!1),pe!==void 0&&za.assertOptions(pe,{encode:Un.function,serialize:Un.function},!0),P.method=(P.method||this.defaults.method||"get").toLowerCase(),(N=He&&ke.merge(He.common,He[P.method]))&&ke.forEach(["delete","get","head","post","put","patch","common"],function(vi){delete He[vi]}),P.headers=xi.concat(N,He);var tt=[],vt=!0;this.interceptors.request.forEach(function(vi){typeof vi.runWhen=="function"&&vi.runWhen(P)===!1||(vt=vt&&vi.synchronous,tt.unshift(vi.fulfilled,vi.rejected))});var _t,Rt=[];this.interceptors.response.forEach(function(vi){Rt.push(vi.fulfilled,vi.rejected)});var Et,bt=0;if(!vt){var Ot=[Us.bind(this),void 0];for(Ot.unshift.apply(Ot,tt),Ot.push.apply(Ot,Rt),Et=Ot.length,_t=Promise.resolve(P);bt<Et;)_t=_t.then(Ot[bt++],Ot[bt++]);return _t}Et=tt.length;var Zt=P;for(bt=0;bt<Et;){var Gi=tt[bt++],qi=tt[bt++];try{Zt=Gi(Zt)}catch(vi){qi.call(this,vi);break}}try{_t=Us.call(this,Zt)}catch(vi){return Promise.reject(vi)}for(bt=0,Et=Rt.length;bt<Et;)_t=_t.then(Rt[bt++],Rt[bt++]);return _t}},{key:"getUri",value:function(x){return Dr(Ns((x=fs(this.defaults,x)).baseURL,x.url),x.params,x.paramsSerializer)}}])&&Ii(D.prototype,z),Object.defineProperty(D,"prototype",{writable:!1}),E}();ke.forEach(["delete","get","head","options"],function(E){$s.prototype[E]=function(D,z){return this.request(fs(z||{},{method:E,url:D,data:(z||{}).data}))}}),ke.forEach(["post","put","patch"],function(E){function D(z){return function(x,P,N){return this.request(fs(N||{},{method:E,headers:z?{"Content-Type":"multipart/form-data"}:{},url:x,data:P}))}}$s.prototype[E]=D(),$s.prototype[E+"Form"]=D(!0)});const yr=$s;function Tn(E){return Tn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},Tn(E)}function ma(E,D){for(var z=0;z<D.length;z++){var x=D[z];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(E,(P=function(N,Z){if(Tn(N)!=="object"||N===null)return N;var fe=N[Symbol.toPrimitive];if(fe!==void 0){var pe=fe.call(N,"string");if(Tn(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(N)}(x.key),Tn(P)==="symbol"?P:String(P)),x)}var P}var Hi=function(){function E(P){if(function(fe,pe){if(!(fe instanceof pe))throw new TypeError("Cannot call a class as a function")}(this,E),typeof P!="function")throw new TypeError("executor must be a function.");var N;this.promise=new Promise(function(fe){N=fe});var Z=this;this.promise.then(function(fe){if(Z._listeners){for(var pe=Z._listeners.length;pe-- >0;)Z._listeners[pe](fe);Z._listeners=null}}),this.promise.then=function(fe){var pe,He=new Promise(function(tt){Z.subscribe(tt),pe=tt}).then(fe);return He.cancel=function(){Z.unsubscribe(pe)},He},P(function(fe,pe,He){Z.reason||(Z.reason=new ar(fe,pe,He),N(Z.reason))})}var D,z,x;return D=E,z=[{key:"throwIfRequested",value:function(){if(this.reason)throw this.reason}},{key:"subscribe",value:function(P){this.reason?P(this.reason):this._listeners?this._listeners.push(P):this._listeners=[P]}},{key:"unsubscribe",value:function(P){if(this._listeners){var N=this._listeners.indexOf(P);N!==-1&&this._listeners.splice(N,1)}}}],x=[{key:"source",value:function(){var P;return{token:new E(function(N){P=N}),cancel:P}}}],z&&ma(D.prototype,z),x&&ma(D,x),Object.defineProperty(D,"prototype",{writable:!1}),E}();const Rl=Hi;function gs(E,D){(D==null||D>E.length)&&(D=E.length);for(var z=0,x=new Array(D);z<D;z++)x[z]=E[z];return x}var Vs={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Vs).forEach(function(E){var D,z,x=(z=2,function(Z){if(Array.isArray(Z))return Z}(D=E)||function(Z,fe){var pe=Z==null?null:typeof Symbol!="undefined"&&Z[Symbol.iterator]||Z["@@iterator"];if(pe!=null){var He,tt,vt,_t,Rt=[],Et=!0,bt=!1;try{if(vt=(pe=pe.call(Z)).next,fe===0){if(Object(pe)!==pe)return;Et=!1}else for(;!(Et=(He=vt.call(pe)).done)&&(Rt.push(He.value),Rt.length!==fe);Et=!0);}catch(Ot){bt=!0,tt=Ot}finally{try{if(!Et&&pe.return!=null&&(_t=pe.return(),Object(_t)!==_t))return}finally{if(bt)throw tt}}return Rt}}(D,z)||function(Z,fe){if(Z){if(typeof Z=="string")return gs(Z,fe);var pe=Object.prototype.toString.call(Z).slice(8,-1);return pe==="Object"&&Z.constructor&&(pe=Z.constructor.name),pe==="Map"||pe==="Set"?Array.from(Z):pe==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(pe)?gs(Z,fe):void 0}}(D,z)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()),P=x[0],N=x[1];Vs[N]=P});const Oo=Vs;var Qi=function E(D){var z=new yr(D),x=Ve(yr.prototype.request,z);return ke.extend(x,yr.prototype,z,{allOwnKeys:!0}),ke.extend(x,z,null,{allOwnKeys:!0}),x.create=function(P){return E(fs(D,P))},x}(hn);Qi.Axios=yr,Qi.CanceledError=ar,Qi.CancelToken=Rl,Qi.isCancel=Ga,Qi.VERSION="1.2.3",Qi.toFormData=Ti,Qi.AxiosError=Dt,Qi.Cancel=Qi.CanceledError,Qi.all=function(E){return Promise.all(E)},Qi.spread=function(E){return function(D){return E.apply(null,D)}},Qi.isAxiosError=function(E){return ke.isObject(E)&&E.isAxiosError===!0},Qi.mergeConfig=fs,Qi.AxiosHeaders=xi,Qi.formToJSON=function(E){return bi(ke.isHTMLForm(E)?new FormData(E):E)},Qi.HttpStatusCode=Oo,Qi.default=Qi;const Wa=Qi,fi={send:function(E){Wa.post(E.url,E.data).then(function(D){var z=D.data;z&&z.code===0?E.success&&E.success(z):E.error&&E.error(z&&z.msg)}).catch(function(D){console.error(D),E.error&&E.error()})},read:function(E){Wa.get(E.url).then(function(D){var z=D.data;z&&z.code===0?E.success&&E.success(z.data.map(function(x){return{time:x[0],type:x[1],color:x[2],author:x[3],text:x[4]}})):E.error&&E.error(z&&z.msg)}).catch(function(D){console.error(D),E.error&&E.error()})}};function qt(E){return qt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},qt(E)}function Bo(E){var D=this;this.lang=E,this.fallbackLang=this.lang.includes("-")?this.lang.split("-")[0]:this.lang,this.tran=function(z){return z=z.toLowerCase(),ys[D.lang]&&ys[D.lang][z]?ys[D.lang][z]:ys[D.fallbackLang]&&ys[D.fallbackLang][z]?ys[D.fallbackLang][z]:Hs[z]?Hs[z]:z}}var Hs={"danmaku-loading":"Danmaku is loading",top:"Top",bottom:"Bottom",rolling:"Rolling","input-danmaku-enter":"Input danmaku, hit Enter","about-author":"About author","dplayer-feedback":"DPlayer feedback","about-dplayer":"About DPlayer",loop:"Loop",speed:"Speed","opacity-danmaku":"Opacity for danmaku",normal:"Normal","please-input-danmaku":"Please input danmaku content!","set-danmaku-color":"Set danmaku color","set-danmaku-type":"Set danmaku type","show-danmaku":"Show danmaku","video-failed":"Video load failed","danmaku-failed":"Danmaku load failed","danmaku-send-failed":"Danmaku send failed","switching-quality":"Switching to %q quality","switched-quality":"Switched to %q quality",ff:"FF %s s",rew:"REW %s s","unlimited-danmaku":"Unlimited danmaku","send-danmaku":"Send danmaku",setting:"Setting",fullscreen:"Full screen","web-fullscreen":"Web full screen",send:"Send",screenshot:"Screenshot",airplay:"AirPlay",chromecast:"ChromeCast",subtitle:"Subtitle",off:"Off","show-subs":"Show subtitle","hide-subs":"Hide subtitle",volume:"Volume",live:"Live","video-info":"Video info"},ys={en:Hs,"zh-cn":{"danmaku-loading":"\u5F39\u5E55\u52A0\u8F7D\u4E2D",top:"\u9876\u90E8",bottom:"\u5E95\u90E8",rolling:"\u6EDA\u52A8","input-danmaku-enter":"\u8F93\u5165\u5F39\u5E55\uFF0C\u56DE\u8F66\u53D1\u9001","about-author":"\u5173\u4E8E\u4F5C\u8005","dplayer-feedback":"\u64AD\u653E\u5668\u610F\u89C1\u53CD\u9988","about-dplayer":"\u5173\u4E8E DPlayer \u64AD\u653E\u5668",loop:"\u6D17\u8111\u5FAA\u73AF",speed:"\u901F\u5EA6","opacity-danmaku":"\u5F39\u5E55\u900F\u660E\u5EA6",normal:"\u6B63\u5E38","please-input-danmaku":"\u8981\u8F93\u5165\u5F39\u5E55\u5185\u5BB9\u554A\u5582\uFF01","set-danmaku-color":"\u8BBE\u7F6E\u5F39\u5E55\u989C\u8272","set-danmaku-type":"\u8BBE\u7F6E\u5F39\u5E55\u7C7B\u578B","show-danmaku":"\u663E\u793A\u5F39\u5E55","video-failed":"\u89C6\u9891\u52A0\u8F7D\u5931\u8D25","danmaku-failed":"\u5F39\u5E55\u52A0\u8F7D\u5931\u8D25","danmaku-send-failed":"\u5F39\u5E55\u53D1\u9001\u5931\u8D25","switching-quality":"\u6B63\u5728\u5207\u6362\u81F3 %q \u753B\u8D28","switched-quality":"\u5DF2\u7ECF\u5207\u6362\u81F3 %q \u753B\u8D28",ff:"\u5FEB\u8FDB %s \u79D2",rew:"\u5FEB\u9000 %s \u79D2","unlimited-danmaku":"\u6D77\u91CF\u5F39\u5E55","send-danmaku":"\u53D1\u9001\u5F39\u5E55",setting:"\u8BBE\u7F6E",fullscreen:"\u5168\u5C4F","web-fullscreen":"\u9875\u9762\u5168\u5C4F",send:"\u53D1\u9001",screenshot:"\u622A\u56FE",airplay:"\u65E0\u7EBF\u6295\u5C4F",chromecast:"ChromeCast",subtitle:"\u5B57\u5E55",off:"\u5173\u95ED","show-subs":"\u663E\u793A\u5B57\u5E55","hide-subs":"\u9690\u85CF\u5B57\u5E55",volume:"\u97F3\u91CF",live:"\u76F4\u64AD","video-info":"\u89C6\u9891\u7EDF\u8BA1\u4FE1\u606F"},"zh-tw":{"danmaku-loading":"\u5F48\u5E55\u8F09\u5165\u4E2D",top:"\u9802\u90E8",bottom:"\u5E95\u90E8",rolling:"\u6EFE\u52D5","input-danmaku-enter":"\u8F38\u5165\u5F48\u5E55\uFF0CEnter \u767C\u9001","about-author":"\u95DC\u65BC\u4F5C\u8005","dplayer-feedback":"\u64AD\u653E\u5668\u610F\u898B\u56DE\u994B","about-dplayer":"\u95DC\u65BC DPlayer \u64AD\u653E\u5668",loop:"\u5FAA\u74B0\u64AD\u653E",speed:"\u901F\u5EA6","opacity-danmaku":"\u5F48\u5E55\u900F\u660E\u5EA6",normal:"\u6B63\u5E38","please-input-danmaku":"\u8ACB\u8F38\u5165\u5F48\u5E55\u5167\u5BB9\u554A\uFF01","set-danmaku-color":"\u8A2D\u5B9A\u5F48\u5E55\u984F\u8272","set-danmaku-type":"\u8A2D\u5B9A\u5F48\u5E55\u985E\u578B","show-danmaku":"\u986F\u793A\u5F48\u5E55","video-failed":"\u5F71\u7247\u8F09\u5165\u5931\u6557","danmaku-failed":"\u5F48\u5E55\u8F09\u5165\u5931\u6557","danmaku-send-failed":"\u5F48\u5E55\u767C\u9001\u5931\u6557","switching-quality":"\u6B63\u5728\u5207\u63DB\u81F3 %q \u756B\u8CEA","switched-quality":"\u5DF2\u7D93\u5207\u63DB\u81F3 %q \u756B\u8CEA",ff:"\u5FEB\u9032 %s \u79D2",rew:"\u5FEB\u9000 %s \u79D2","unlimited-danmaku":"\u5DE8\u91CF\u5F48\u5E55","send-danmaku":"\u767C\u9001\u5F48\u5E55",setting:"\u8A2D\u5B9A",fullscreen:"\u5168\u87A2\u5E55","web-fullscreen":"\u9801\u9762\u5168\u87A2\u5E55",send:"\u767C\u9001",screenshot:"\u622A\u5716",airplay:"\u7121\u7DDA\u6295\u5C4F",chromecast:"ChromeCast",subtitle:"\u5B57\u5E55",off:"\u95DC\u9589","show-subs":"\u986F\u793A\u5B57\u5E55","hide-subs":"\u96B1\u85CF\u5B57\u5E55",volume:"\u97F3\u91CF",live:"\u76F4\u64AD","video-info":"\u5F71\u7247\u7D71\u8A08\u8A0A\u606F"},"ko-kr":{"danmaku-loading":"Danmaku\uB97C \uBD88\uB7EC\uC624\uB294 \uC911\uC785\uB2C8\uB2E4.",top:"Top",bottom:"Bottom",rolling:"Rolling","input-danmaku-enter":"Danmaku\uB97C \uC785\uB825\uD558\uACE0 Enter\uB97C \uB204\uB974\uC138\uC694.","about-author":"\uB9CC\uB4E0\uC774","dplayer-feedback":"\uD53C\uB4DC\uBC31 \uBCF4\uB0B4\uAE30","about-dplayer":"DPlayer \uC815\uBCF4",loop:"\uBC18\uBCF5",speed:"\uBC30\uC18D","opacity-danmaku":"Danmaku \uBD88\uD22C\uBA85\uB3C4",normal:"\uD45C\uC900","please-input-danmaku":"Danmaku\uB97C \uC785\uB825\uD558\uC138\uC694!","set-danmaku-color":"Danmaku \uC0C9\uC0C1","set-danmaku-type":"Danmaku \uC124\uC815","show-danmaku":"Danmaku \uD45C\uC2DC","video-failed":"\uBE44\uB514\uC624\uB97C \uBD88\uB7EC\uC624\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4.","danmaku-failed":"Danmaku\uB97C \uBD88\uB7EC\uC624\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4.","danmaku-send-failed":"Danmaku \uC804\uC1A1\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.","Switching to":"","Switched to":"","switching-quality":"\uC804\uD658 %q \uD654\uC9C8","switched-quality":"\uC804\uD658 \uB428 %q \uD654\uC9C8",ff:"\uC55E\uC73C\uB85C %s \uCD08",rew:"\uB4A4\uB85C %s \uCD08","unlimited-danmaku":"\uB05D\uC5C6\uB294 Danmaku","send-danmaku":"Danmaku \uBCF4\uB0B4\uAE30",setting:"\uC124\uC815",fullscreen:"\uC804\uCCB4 \uD654\uBA74","web-fullscreen":"\uC6F9 \uB0B4 \uC804\uCCB4\uD654\uBA74",send:"\uBCF4\uB0B4\uAE30",screenshot:"\uD654\uBA74 \uCEA1\uCCD0",airplay:"\uC5D0\uC5B4\uD50C\uB808\uC774",chromecast:"ChromeCast",subtitle:"\uBD80\uC81C",off:"\uB044\uB2E4","show-subs":"\uC790\uB9C9 \uBCF4\uC774\uAE30","hide-subs":"\uC790\uB9C9 \uC228\uAE30\uAE30",Volume:"\uBCFC\uB968",live:"\uC0DD\uBC29\uC1A1","video-info":"\uBE44\uB514\uC624 \uC815\uBCF4"},de:{"danmaku-loading":"Danmaku l\xE4dt...",top:"Oben",bottom:"Unten",rolling:"Rollend","input-danmaku-enter":"Dr\xFCcke Enter nach dem Einf\xFCgen vom Danmaku","about-author":"\xDCber den Autor","dplayer-feedback":"DPlayer Feedback","about-dplayer":"\xDCber DPlayer",loop:"Wiederholen",speed:"Geschwindigkeit","opacity-danmaku":"Transparenz f\xFCr Danmaku",normal:"Normal","please-input-danmaku":"Bitte Danmaku Inhalt eingeben!","set-danmaku-color":"Danmaku Farbe festlegen","set-danmaku-type":"Danmaku Typ festlegen","show-danmaku":"Zeige Danmaku","video-failed":"Das Video konnte nicht geladen werden","danmaku-failed":"Danmaku konnte nicht geladen werden","danmaku-send-failed":"Das senden von Danmaku ist fehgeschlagen","switching-quality":"Wechsle zur %q Qualit\xE4t","switched-quality":"Zur %q Qualit\xE4t gewechselt",ff:"%s s Vorw\xE4rts",rew:"%s s Zur\xFCck","unlimited-danmaku":"Unlimitiertes Danmaku","send-danmaku":"Sende Danmaku",setting:"Einstellungen",fullscreen:"Vollbild","web-fullscreen":"Browser Vollbild",send:"Senden",screenshot:"Screenshot",airplay:"AirPlay","show-subs":"Zeige Untertitel",chromecast:"ChromeCast",subtitle:"Untertitel",off:"Schlie\xDFung","hide-subs":"Verstecke Untertitel",volume:"Lautst\xE4rke",live:"Live","video-info":"Video Info"}},Mo=ve(730),Ka=ve.n(Mo),vs=ve(74),Fo=ve.n(vs),Pl=ve(437),Ol=ve.n(Pl),ga=ve(644),Kn=ve.n(ga),Bl=ve(324),Ya=ve.n(Bl),As=ve(574),Xa=ve.n(As),No=ve(300),Qu=ve.n(No),Ju=ve(934),Zu=ve.n(Ju),Uo=ve(428),Qa=ve.n(Uo),ya=ve(807),Ja=ve.n(ya),_s=ve(338),_n=ve.n(_s),Xr=ve(254),or=ve.n(Xr),jo=ve(965),Za=ve.n(jo),Ml=ve(113),ed=ve.n(Ml),Ri=ve(251),eo=ve.n(Ri),Fl=ve(410),Pr=ve.n(Fl),va=ve(182),Nl=ve.n(va),Ul=ve(193),Fi=ve.n(Ul);const jn={play:Ka(),pause:Fo(),volumeUp:Ol(),volumeDown:Kn(),volumeOff:Ya(),full:Xa(),fullWeb:Qu(),setting:Zu(),right:Qa(),comment:Ja(),commentOff:_n(),send:or(),pallette:Za(),camera:ed(),subtitle:Pr(),loading:Nl(),airplay:eo(),chromecast:Fi()};var $o=ve(916),Aa=ve.n($o);function Gs(E){return Gs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},Gs(E)}function _a(E,D){for(var z=0;z<D.length;z++){var x=D[z];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(E,(P=function(N,Z){if(Gs(N)!=="object"||N===null)return N;var fe=N[Symbol.toPrimitive];if(fe!==void 0){var pe=fe.call(N,"string");if(Gs(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(N)}(x.key),Gs(P)==="symbol"?P:String(P)),x)}var P}var Vo=function(){function E(P){(function(N,Z){if(!(N instanceof Z))throw new TypeError("Cannot call a class as a function")})(this,E),this.container=P.container,this.options=P.options,this.index=P.index,this.tran=P.tran,this.init()}var D,z,x;return D=E,x=[{key:"NewNotice",value:function(P,N,Z){var fe=document.createElement("div");return fe.classList.add("dplayer-notice"),fe.style.opacity=N,fe.innerText=P,Z&&(fe.id="dplayer-notice-".concat(Z)),fe}}],(z=[{key:"init",value:function(){this.container.innerHTML=Aa()({options:this.options,index:this.index,tran:this.tran,icons:jn,mobile:De.isMobile,video:{current:!0,pic:this.options.video.pic,screenshot:this.options.screenshot,airplay:!(!De.isSafari||De.isChrome)&&this.options.airplay,chromecast:this.options.chromecast,preload:this.options.preload,url:this.options.video.url,subtitle:this.options.subtitle}}),this.volumeBar=this.container.querySelector(".dplayer-volume-bar-inner"),this.volumeBarWrap=this.container.querySelector(".dplayer-volume-bar"),this.volumeBarWrapWrap=this.container.querySelector(".dplayer-volume-bar-wrap"),this.volumeButton=this.container.querySelector(".dplayer-volume"),this.volumeButtonIcon=this.container.querySelector(".dplayer-volume-icon"),this.volumeIcon=this.container.querySelector(".dplayer-volume-icon .dplayer-icon-content"),this.playedBar=this.container.querySelector(".dplayer-played"),this.loadedBar=this.container.querySelector(".dplayer-loaded"),this.playedBarWrap=this.container.querySelector(".dplayer-bar-wrap"),this.playedBarTime=this.container.querySelector(".dplayer-bar-time"),this.danmaku=this.container.querySelector(".dplayer-danmaku"),this.danmakuLoading=this.container.querySelector(".dplayer-danloading"),this.video=this.container.querySelector(".dplayer-video-current"),this.bezel=this.container.querySelector(".dplayer-bezel-icon"),this.playButton=this.container.querySelector(".dplayer-play-icon"),this.mobilePlayButton=this.container.querySelector(".dplayer-mobile-play"),this.videoWrap=this.container.querySelector(".dplayer-video-wrap"),this.controllerMask=this.container.querySelector(".dplayer-controller-mask"),this.ptime=this.container.querySelector(".dplayer-ptime"),this.settingButton=this.container.querySelector(".dplayer-setting-icon"),this.settingBox=this.container.querySelector(".dplayer-setting-box"),this.mask=this.container.querySelector(".dplayer-mask"),this.loop=this.container.querySelector(".dplayer-setting-loop"),this.loopToggle=this.container.querySelector(".dplayer-setting-loop .dplayer-toggle-setting-input"),this.showDanmaku=this.container.querySelector(".dplayer-setting-showdan"),this.showDanmakuToggle=this.container.querySelector(".dplayer-showdan-setting-input"),this.unlimitDanmaku=this.container.querySelector(".dplayer-setting-danunlimit"),this.unlimitDanmakuToggle=this.container.querySelector(".dplayer-danunlimit-setting-input"),this.speed=this.container.querySelector(".dplayer-setting-speed"),this.speedItem=this.container.querySelectorAll(".dplayer-setting-speed-item"),this.danmakuOpacityBar=this.container.querySelector(".dplayer-danmaku-bar-inner"),this.danmakuOpacityBarWrap=this.container.querySelector(".dplayer-danmaku-bar"),this.danmakuOpacityBarWrapWrap=this.container.querySelector(".dplayer-danmaku-bar-wrap"),this.danmakuOpacityBox=this.container.querySelector(".dplayer-setting-danmaku"),this.dtime=this.container.querySelector(".dplayer-dtime"),this.controller=this.container.querySelector(".dplayer-controller"),this.commentInput=this.container.querySelector(".dplayer-comment-input"),this.commentButton=this.container.querySelector(".dplayer-comment-icon"),this.commentSettingBox=this.container.querySelector(".dplayer-comment-setting-box"),this.commentSettingButton=this.container.querySelector(".dplayer-comment-setting-icon"),this.commentSettingFill=this.container.querySelector(".dplayer-comment-setting-icon path"),this.commentSendButton=this.container.querySelector(".dplayer-send-icon"),this.commentSendFill=this.container.querySelector(".dplayer-send-icon path"),this.commentColorSettingBox=this.container.querySelector(".dplayer-comment-setting-color"),this.browserFullButton=this.container.querySelector(".dplayer-full-icon"),this.webFullButton=this.container.querySelector(".dplayer-full-in-icon"),this.menu=this.container.querySelector(".dplayer-menu"),this.menuItem=this.container.querySelectorAll(".dplayer-menu-item"),this.qualityList=this.container.querySelector(".dplayer-quality-list"),this.camareButton=this.container.querySelector(".dplayer-camera-icon"),this.airplayButton=this.container.querySelector(".dplayer-airplay-icon"),this.chromecastButton=this.container.querySelector(".dplayer-chromecast-icon"),this.subtitleButton=this.container.querySelector(".dplayer-subtitle-icon"),this.subtitleButtonInner=this.container.querySelector(".dplayer-subtitle-icon .dplayer-icon-content"),this.subtitlesButton=this.container.querySelector(".dplayer-subtitles-icon"),this.subtitlesBox=this.container.querySelector(".dplayer-subtitles-box"),this.subtitlesItem=this.container.querySelectorAll(".dplayer-subtitles-item"),this.subtitle=this.container.querySelector(".dplayer-subtitle"),this.subtrack=this.container.querySelector(".dplayer-subtrack"),this.qualityButton=this.container.querySelector(".dplayer-quality-icon"),this.barPreview=this.container.querySelector(".dplayer-bar-preview"),this.barWrap=this.container.querySelector(".dplayer-bar-wrap"),this.noticeList=this.container.querySelector(".dplayer-notice-list"),this.infoPanel=this.container.querySelector(".dplayer-info-panel"),this.infoPanelClose=this.container.querySelector(".dplayer-info-panel-close"),this.infoVersion=this.container.querySelector(".dplayer-info-panel-item-version .dplayer-info-panel-item-data"),this.infoFPS=this.container.querySelector(".dplayer-info-panel-item-fps .dplayer-info-panel-item-data"),this.infoType=this.container.querySelector(".dplayer-info-panel-item-type .dplayer-info-panel-item-data"),this.infoUrl=this.container.querySelector(".dplayer-info-panel-item-url .dplayer-info-panel-item-data"),this.infoResolution=this.container.querySelector(".dplayer-info-panel-item-resolution .dplayer-info-panel-item-data"),this.infoDuration=this.container.querySelector(".dplayer-info-panel-item-duration .dplayer-info-panel-item-data"),this.infoDanmakuId=this.container.querySelector(".dplayer-info-panel-item-danmaku-id .dplayer-info-panel-item-data"),this.infoDanmakuApi=this.container.querySelector(".dplayer-info-panel-item-danmaku-api .dplayer-info-panel-item-data"),this.infoDanmakuAmount=this.container.querySelector(".dplayer-info-panel-item-danmaku-amount .dplayer-info-panel-item-data")}}])&&_a(D.prototype,z),x&&_a(D,x),Object.defineProperty(D,"prototype",{writable:!1}),E}();const qs=Vo;function bs(E){return bs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},bs(E)}function to(E,D){for(var z=0;z<D.length;z++){var x=D[z];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(E,(P=function(N,Z){if(bs(N)!=="object"||N===null)return N;var fe=N[Symbol.toPrimitive];if(fe!==void 0){var pe=fe.call(N,"string");if(bs(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(N)}(x.key),bs(P)==="symbol"?P:String(P)),x)}var P}var jl=function(){function E(x){(function(P,N){if(!(P instanceof N))throw new TypeError("Cannot call a class as a function")})(this,E),this.options=x,this.player=this.options.player,this.container=this.options.container,this.danTunnel={right:{},top:{},bottom:{}},this.danIndex=0,this.dan=[],this.showing=!0,this._opacity=this.options.opacity,this.events=this.options.events,this.unlimited=this.options.unlimited,this._measure(""),this.load()}var D,z;return D=E,z=[{key:"load",value:function(){var x,P=this;x=this.options.api.maximum?"".concat(this.options.api.address,"v3/?id=").concat(this.options.api.id,"&max=").concat(this.options.api.maximum):"".concat(this.options.api.address,"v3/?id=").concat(this.options.api.id);var N=(this.options.api.addition||[]).slice(0);N.push(x),this.events&&this.events.trigger("danmaku_load_start",N),this._readAllEndpoints(N,function(Z){P.dan=[].concat.apply([],Z).sort(function(fe,pe){return fe.time-pe.time}),window.requestAnimationFrame(function(){P.frame()}),P.options.callback(),P.events&&P.events.trigger("danmaku_load_end")})}},{key:"reload",value:function(x){this.options.api=x,this.dan=[],this.clear(),this.load()}},{key:"_readAllEndpoints",value:function(x,P){for(var N=this,Z=[],fe=0,pe=function(tt){N.options.apiBackend.read({url:x[tt],success:function(vt){Z[tt]=vt,++fe===x.length&&P(Z)},error:function(vt){N.options.error(vt||N.options.tran("danmaku-failed")),Z[tt]=[],++fe===x.length&&P(Z)}})},He=0;He<x.length;++He)pe(He)}},{key:"send",value:function(x,P){var N=this,Z={token:this.options.api.token,id:this.options.api.id,author:this.options.api.user,time:this.options.time(),text:x.text,color:x.color,type:x.type};this.options.apiBackend.send({url:this.options.api.address+"v3/",data:Z,success:P,error:function(pe){N.options.error(pe||N.options.tran("danmaku-failed"))}}),this.dan.splice(this.danIndex,0,Z),this.danIndex++;var fe={text:this.htmlEncode(Z.text),color:Z.color,type:Z.type,border:"2px solid ".concat(this.options.borderColor)};this.draw(fe),this.events&&this.events.trigger("danmaku_send",Z)}},{key:"frame",value:function(){var x=this;if(this.dan.length&&!this.paused&&this.showing){for(var P=this.dan[this.danIndex],N=[];P&&this.options.time()>parseFloat(P.time);)N.push(P),P=this.dan[++this.danIndex];this.draw(N)}window.requestAnimationFrame(function(){x.frame()})}},{key:"opacity",value:function(x){if(x!==void 0){for(var P=this.container.getElementsByClassName("dplayer-danmaku-item"),N=0;N<P.length;N++)P[N].style.opacity=x;this._opacity=x,this.events&&this.events.trigger("danmaku_opacity",this._opacity)}return this._opacity}},{key:"draw",value:function(x){var P=this;if(this.showing){var N=this.options.height,Z=this.container.offsetWidth,fe=this.container.offsetHeight,pe=parseInt(fe/N),He=function(bt){var Ot=bt.offsetWidth||parseInt(bt.style.width),Zt=bt.getBoundingClientRect().right||P.container.getBoundingClientRect().right+Ot;return P.container.getBoundingClientRect().right-Zt},tt=function(bt){return(Z+bt)/5},vt=function(bt,Ot,Zt){for(var Gi=Z/tt(Zt),qi=function(Er){var ns=P.danTunnel[Ot][Er+""];if(!ns||!ns.length)return P.danTunnel[Ot][Er+""]=[bt],bt.addEventListener("animationend",function(){P.danTunnel[Ot][Er+""].splice(0,1)}),{v:Er%pe};if(Ot!=="right")return"continue";for(var Zi=0;Zi<ns.length;Zi++){var Hl=He(ns[Zi])-10;if(Hl<=Z-Gi*tt(parseInt(ns[Zi].style.width))||Hl<=0)break;if(Zi===ns.length-1)return P.danTunnel[Ot][Er+""].push(bt),bt.addEventListener("animationend",function(){P.danTunnel[Ot][Er+""].splice(0,1)}),{v:Er%pe}}},vi=0;P.unlimited||vi<pe;vi++){var hr=qi(vi);if(hr!=="continue"&&bs(hr)==="object")return hr.v}return-1};Object.prototype.toString.call(x)!=="[object Array]"&&(x=[x]);for(var _t=document.createDocumentFragment(),Rt=function(){x[Et].type=De.number2Type(x[Et].type),x[Et].color||(x[Et].color=16777215);var bt=document.createElement("div");bt.classList.add("dplayer-danmaku-item"),bt.classList.add("dplayer-danmaku-".concat(x[Et].type)),x[Et].border?bt.innerHTML='<span style="border:'.concat(x[Et].border,'">').concat(x[Et].text,"</span>"):bt.innerHTML=x[Et].text,bt.style.opacity=P._opacity,bt.style.color=De.number2Color(x[Et].color),bt.addEventListener("animationend",function(){P.container.removeChild(bt)});var Ot,Zt=P._measure(x[Et].text);switch(x[Et].type){case"right":(Ot=vt(bt,x[Et].type,Zt))>=0&&(bt.style.width=Zt+1+"px",bt.style.top=N*Ot+"px",bt.style.transform="translateX(-".concat(Z,"px)"));break;case"top":(Ot=vt(bt,x[Et].type))>=0&&(bt.style.top=N*Ot+"px");break;case"bottom":(Ot=vt(bt,x[Et].type))>=0&&(bt.style.bottom=N*Ot+"px");break;default:console.error("Can't handled danmaku type: ".concat(x[Et].type))}Ot>=0&&(bt.classList.add("dplayer-danmaku-move"),bt.style.animationDuration=P._danAnimation(x[Et].type),_t.appendChild(bt))},Et=0;Et<x.length;Et++)Rt();return this.container.appendChild(_t),_t}}},{key:"play",value:function(){this.paused=!1}},{key:"pause",value:function(){this.paused=!0}},{key:"_measure",value:function(x){if(!this.context){var P=getComputedStyle(this.container.getElementsByClassName("dplayer-danmaku-item")[0],null);this.context=document.createElement("canvas").getContext("2d"),this.context.font=P.getPropertyValue("font")}return this.context.measureText(x).width}},{key:"seek",value:function(){this.clear();for(var x=0;x<this.dan.length;x++){if(this.dan[x].time>=this.options.time()){this.danIndex=x;break}this.danIndex=this.dan.length}}},{key:"clear",value:function(){this.danTunnel={right:{},top:{},bottom:{}},this.danIndex=0,this.options.container.innerHTML="",this.events&&this.events.trigger("danmaku_clear")}},{key:"htmlEncode",value:function(x){return x.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2f;")}},{key:"resize",value:function(){for(var x=this.container.offsetWidth,P=this.container.getElementsByClassName("dplayer-danmaku-item"),N=0;N<P.length;N++)P[N].style.transform="translateX(-".concat(x,"px)")}},{key:"hide",value:function(){this.showing=!1,this.pause(),this.clear(),this.events&&this.events.trigger("danmaku_hide")}},{key:"show",value:function(){this.seek(),this.showing=!0,this.play(),this.events&&this.events.trigger("danmaku_show")}},{key:"unlimit",value:function(x){this.unlimited=x}},{key:"speed",value:function(x){this.options.api.speedRate=x}},{key:"_danAnimation",value:function(x){var P=this.options.api.speedRate||1,N=!!this.player.fullScreen.isFullScreen();return{top:"".concat((N?6:4)/P,"s"),right:"".concat((N?8:5)/P,"s"),bottom:"".concat((N?6:4)/P,"s")}[x]}}],z&&to(D.prototype,z),Object.defineProperty(D,"prototype",{writable:!1}),E}();const ba=jl;function rn(E){return rn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},rn(E)}function Or(E,D){for(var z=0;z<D.length;z++){var x=D[z];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(E,(P=function(N,Z){if(rn(N)!=="object"||N===null)return N;var fe=N[Symbol.toPrimitive];if(fe!==void 0){var pe=fe.call(N,"string");if(rn(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(N)}(x.key),rn(P)==="symbol"?P:String(P)),x)}var P}const io=function(){function E(){(function(x,P){if(!(x instanceof P))throw new TypeError("Cannot call a class as a function")})(this,E),this.events={},this.videoEvents=["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","mozaudioavailable","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],this.playerEvents=["screenshot","thumbnails_show","thumbnails_hide","danmaku_show","danmaku_hide","danmaku_clear","danmaku_loaded","danmaku_send","danmaku_opacity","contextmenu_show","contextmenu_hide","notice_show","notice_hide","quality_start","quality_end","destroy","resize","fullscreen","fullscreen_cancel","webfullscreen","webfullscreen_cancel","subtitle_show","subtitle_hide","subtitle_change"]}var D,z;return D=E,(z=[{key:"on",value:function(x,P){this.type(x)&&typeof P=="function"&&(this.events[x]||(this.events[x]=[]),this.events[x].push(P))}},{key:"trigger",value:function(x,P){if(this.events[x]&&this.events[x].length)for(var N=0;N<this.events[x].length;N++)this.events[x][N](P)}},{key:"type",value:function(x){return this.playerEvents.indexOf(x)!==-1?"player":this.videoEvents.indexOf(x)!==-1?"video":(console.error("Unknown event name: ".concat(x)),null)}}])&&Or(D.prototype,z),Object.defineProperty(D,"prototype",{writable:!1}),E}();function zs(E){return zs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},zs(E)}function Ji(E,D){for(var z=0;z<D.length;z++){var x=D[z];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(E,(P=function(N,Z){if(zs(N)!=="object"||N===null)return N;var fe=N[Symbol.toPrimitive];if(fe!==void 0){var pe=fe.call(N,"string");if(zs(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(N)}(x.key),zs(P)==="symbol"?P:String(P)),x)}var P}var Yn=function(){function E(x){var P=this;(function(N,Z){if(!(N instanceof Z))throw new TypeError("Cannot call a class as a function")})(this,E),this.player=x,this.lastScrollPosition={left:0,top:0},this.player.events.on("webfullscreen",function(){P.player.resize()}),this.player.events.on("webfullscreen_cancel",function(){P.player.resize(),De.setScrollPosition(P.lastScrollPosition)}),this.fullscreenchange=function(){P.player.resize(),P.isFullScreen("browser")?P.player.events.trigger("fullscreen"):(De.setScrollPosition(P.lastScrollPosition),P.player.events.trigger("fullscreen_cancel"))},this.docfullscreenchange=function(){var N=document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;N&&N!==P.player.container||(P.player.resize(),N?P.player.events.trigger("fullscreen"):(De.setScrollPosition(P.lastScrollPosition),P.player.events.trigger("fullscreen_cancel")))},/Firefox/.test(navigator.userAgent)?(document.addEventListener("mozfullscreenchange",this.docfullscreenchange),document.addEventListener("fullscreenchange",this.docfullscreenchange)):(this.player.container.addEventListener("fullscreenchange",this.fullscreenchange),this.player.container.addEventListener("webkitfullscreenchange",this.fullscreenchange),document.addEventListener("msfullscreenchange",this.docfullscreenchange),document.addEventListener("MSFullscreenChange",this.docfullscreenchange))}var D,z;return D=E,z=[{key:"isFullScreen",value:function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"browser";switch(x){case"browser":return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;case"web":return this.player.container.classList.contains("dplayer-fulled")}}},{key:"request",value:function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"browser",P=x==="browser"?"web":"browser",N=this.isFullScreen(P);switch(N||(this.lastScrollPosition=De.getScrollPosition()),x){case"browser":this.player.container.requestFullscreen?this.player.container.requestFullscreen():this.player.container.mozRequestFullScreen?this.player.container.mozRequestFullScreen():this.player.container.webkitRequestFullscreen?this.player.container.webkitRequestFullscreen():this.player.video.webkitEnterFullscreen?this.player.video.webkitEnterFullscreen():this.player.video.webkitEnterFullScreen?this.player.video.webkitEnterFullScreen():this.player.container.msRequestFullscreen&&this.player.container.msRequestFullscreen();break;case"web":this.player.container.classList.add("dplayer-fulled"),document.body.classList.add("dplayer-web-fullscreen-fix"),this.player.events.trigger("webfullscreen")}N&&this.cancel(P)}},{key:"cancel",value:function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"browser";switch(x){case"browser":document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.webkitCancelFullscreen?document.webkitCancelFullscreen():document.msCancelFullScreen?document.msCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen();break;case"web":this.player.container.classList.remove("dplayer-fulled"),document.body.classList.remove("dplayer-web-fullscreen-fix"),this.player.events.trigger("webfullscreen_cancel")}}},{key:"toggle",value:function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"browser";this.isFullScreen(x)?this.cancel(x):this.request(x)}},{key:"destroy",value:function(){/Firefox/.test(navigator.userAgent)?(document.removeEventListener("mozfullscreenchange",this.docfullscreenchange),document.removeEventListener("fullscreenchange",this.docfullscreenchange)):(this.player.container.removeEventListener("fullscreenchange",this.fullscreenchange),this.player.container.removeEventListener("webkitfullscreenchange",this.fullscreenchange),document.removeEventListener("msfullscreenchange",this.docfullscreenchange),document.removeEventListener("MSFullscreenChange",this.docfullscreenchange))}}],z&&Ji(D.prototype,z),Object.defineProperty(D,"prototype",{writable:!1}),E}();const Qr=Yn;function vr(E){return vr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},vr(E)}function Sn(E,D){for(var z=0;z<D.length;z++){var x=D[z];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(E,(P=function(N,Z){if(vr(N)!=="object"||N===null)return N;var fe=N[Symbol.toPrimitive];if(fe!==void 0){var pe=fe.call(N,"string");if(vr(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(N)}(x.key),vr(P)==="symbol"?P:String(P)),x)}var P}var Br=function(){function E(x){(function(P,N){if(!(P instanceof N))throw new TypeError("Cannot call a class as a function")})(this,E),this.storageName={opacity:"dplayer-danmaku-opacity",volume:"dplayer-volume",unlimited:"dplayer-danmaku-unlimited",danmaku:"dplayer-danmaku-show",subtitle:"dplayer-subtitle-show"},this.default={opacity:.7,volume:x.options.hasOwnProperty("volume")?x.options.volume:.7,unlimited:(x.options.danmaku&&x.options.danmaku.unlimited?1:0)||0,danmaku:1,subtitle:1},this.data={},this.init()}var D,z;return D=E,(z=[{key:"init",value:function(){for(var x in this.storageName){var P=this.storageName[x];this.data[x]=parseFloat(De.storage.get(P)||this.default[x])}}},{key:"get",value:function(x){return this.data[x]}},{key:"set",value:function(x,P){this.data[x]=P,De.storage.set(this.storageName[x],P)}}])&&Sn(D.prototype,z),Object.defineProperty(D,"prototype",{writable:!1}),E}();const Ho=Br;function Jr(E){return Jr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},Jr(E)}function $l(E,D){for(var z=0;z<D.length;z++){var x=D[z];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(E,(P=function(N,Z){if(Jr(N)!=="object"||N===null)return N;var fe=N[Symbol.toPrimitive];if(fe!==void 0){var pe=fe.call(N,"string");if(Jr(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(N)}(x.key),Jr(P)==="symbol"?P:String(P)),x)}var P}var xa=function(){function E(x,P,N,Z){(function(fe,pe){if(!(fe instanceof pe))throw new TypeError("Cannot call a class as a function")})(this,E),this.container=x,this.video=P,this.options=N,this.events=Z,this.init()}var D,z;return D=E,z=[{key:"init",value:function(){var x=this;if(this.container.style.fontSize=this.options.fontSize,this.container.style.bottom=this.options.bottom,this.container.style.color=this.options.color,this.video.textTracks&&this.video.textTracks[0]){var P=this.video.textTracks[0];P.oncuechange=function(){var N=P.activeCues[P.activeCues.length-1];if(x.container.innerHTML="",N){var Z=document.createElement("div");Z.appendChild(N.getCueAsHTML());var fe=Z.innerHTML.split(/\r?\n/).map(function(pe){return"<p>".concat(pe,"</p>")}).join("");x.container.innerHTML=fe}x.events.trigger("subtitle_change")}}}},{key:"show",value:function(){this.container.classList.remove("dplayer-subtitle-hide"),this.events.trigger("subtitle_show")}},{key:"hide",value:function(){this.container.classList.add("dplayer-subtitle-hide"),this.events.trigger("subtitle_hide")}},{key:"toggle",value:function(){this.container.classList.contains("dplayer-subtitle-hide")?this.show():this.hide()}}],z&&$l(D.prototype,z),Object.defineProperty(D,"prototype",{writable:!1}),E}();const Ea=xa;function xs(E){return xs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},xs(E)}function Ws(E,D){for(var z=0;z<D.length;z++){var x=D[z];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(E,(P=function(N,Z){if(xs(N)!=="object"||N===null)return N;var fe=N[Symbol.toPrimitive];if(fe!==void 0){var pe=fe.call(N,"string");if(xs(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(N)}(x.key),xs(P)==="symbol"?P:String(P)),x)}var P}var Cn=function(){function E(x){var P=this;(function(pe,He){if(!(pe instanceof He))throw new TypeError("Cannot call a class as a function")})(this,E),this.player=x,this.player.template.mask.addEventListener("click",function(){P.hide()}),this.player.template.subtitlesButton.addEventListener("click",function(){P.adaptiveHeight(),P.show()});for(var N=this.player.template.subtitlesItem.length-1,Z=function(pe){P.player.template.subtitlesItem[pe].addEventListener("click",function(){P.hide(),P.player.options.subtitle.index!==pe&&(P.player.template.subtitle.innerHTML="<p></p>",P.player.template.subtrack.src=P.player.template.subtitlesItem[pe].dataset.subtitle,P.player.options.subtitle.index=pe,P.player.template.subtitle.classList.contains("dplayer-subtitle-hide")&&P.subContainerShow())})},fe=0;fe<N;fe++)Z(fe);this.player.template.subtitlesItem[N].addEventListener("click",function(){P.hide(),P.player.options.subtitle.index!==N&&(P.player.template.subtitle.innerHTML="<p></p>",P.player.template.subtrack.src="",P.player.options.subtitle.index=N,P.subContainerHide())})}var D,z;return D=E,(z=[{key:"subContainerShow",value:function(){this.player.template.subtitle.classList.remove("dplayer-subtitle-hide"),this.player.events.trigger("subtitle_show")}},{key:"subContainerHide",value:function(){this.player.template.subtitle.classList.add("dplayer-subtitle-hide"),this.player.events.trigger("subtitle_hide")}},{key:"hide",value:function(){this.player.template.subtitlesBox.classList.remove("dplayer-subtitles-box-open"),this.player.template.mask.classList.remove("dplayer-mask-show"),this.player.controller.disableAutoHide=!1}},{key:"show",value:function(){this.player.template.subtitlesBox.classList.add("dplayer-subtitles-box-open"),this.player.template.mask.classList.add("dplayer-mask-show"),this.player.controller.disableAutoHide=!0}},{key:"adaptiveHeight",value:function(){var x=30*this.player.template.subtitlesItem.length+14,P=.8*this.player.template.videoWrap.offsetHeight;x>=P-50?(this.player.template.subtitlesBox.style.bottom="8px",this.player.template.subtitlesBox.style["max-height"]=P-8+"px"):(this.player.template.subtitlesBox.style.bottom="50px",this.player.template.subtitlesBox.style["max-height"]=P-50+"px")}}])&&Ws(D.prototype,z),Object.defineProperty(D,"prototype",{writable:!1}),E}();const Ar=Cn;function Zr(E){return Zr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},Zr(E)}function ci(E,D){for(var z=0;z<D.length;z++){var x=D[z];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(E,(P=function(N,Z){if(Zr(N)!=="object"||N===null)return N;var fe=N[Symbol.toPrimitive];if(fe!==void 0){var pe=fe.call(N,"string");if(Zr(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(N)}(x.key),Zr(P)==="symbol"?P:String(P)),x)}var P}var Xn=function(){function E(x){(function(P,N){if(!(P instanceof N))throw new TypeError("Cannot call a class as a function")})(this,E),this.elements={},this.elements.volume=x.volumeBar,this.elements.played=x.playedBar,this.elements.loaded=x.loadedBar,this.elements.danmaku=x.danmakuOpacityBar}var D,z;return D=E,(z=[{key:"set",value:function(x,P,N){P=Math.max(P,0),P=Math.min(P,1),this.elements[x].style[N]=100*P+"%"}},{key:"get",value:function(x){return parseFloat(this.elements[x].style.width)/100}}])&&ci(D.prototype,z),Object.defineProperty(D,"prototype",{writable:!1}),E}();const Es=Xn;function Ts(E){return Ts=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},Ts(E)}function Qn(E,D){for(var z=0;z<D.length;z++){var x=D[z];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(E,(P=function(N,Z){if(Ts(N)!=="object"||N===null)return N;var fe=N[Symbol.toPrimitive];if(fe!==void 0){var pe=fe.call(N,"string");if(Ts(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(N)}(x.key),Ts(P)==="symbol"?P:String(P)),x)}var P}var Go=function(){function E(x){(function(P,N){if(!(P instanceof N))throw new TypeError("Cannot call a class as a function")})(this,E),this.player=x,window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(P){window.setTimeout(P,1e3/60)},this.types=["loading","info","fps"],this.init()}var D,z;return D=E,(z=[{key:"init",value:function(){var x=this;this.types.map(function(P){return P!=="fps"&&x["init".concat(P,"Checker")](),P})}},{key:"initloadingChecker",value:function(){var x=this,P=0,N=0,Z=!1;this.loadingChecker=setInterval(function(){x.enableloadingChecker&&(N=x.player.video.currentTime,Z||N!==P||x.player.video.paused||(x.player.container.classList.add("dplayer-loading"),Z=!0),Z&&N>P&&!x.player.video.paused&&(x.player.container.classList.remove("dplayer-loading"),Z=!1),P=N)},100)}},{key:"initfpsChecker",value:function(){var x=this;window.requestAnimationFrame(function(){if(x.enablefpsChecker)if(x.initfpsChecker(),x.fpsStart){x.fpsIndex++;var P=new Date;P-x.fpsStart>1e3&&(x.player.infoPanel.fps(x.fpsIndex/(P-x.fpsStart)*1e3),x.fpsStart=new Date,x.fpsIndex=0)}else x.fpsStart=new Date,x.fpsIndex=0;else x.fpsStart=0,x.fpsIndex=0})}},{key:"initinfoChecker",value:function(){var x=this;this.infoChecker=setInterval(function(){x.enableinfoChecker&&x.player.infoPanel.update()},1e3)}},{key:"enable",value:function(x){this["enable".concat(x,"Checker")]=!0,x==="fps"&&this.initfpsChecker()}},{key:"disable",value:function(x){this["enable".concat(x,"Checker")]=!1}},{key:"destroy",value:function(){var x=this;this.types.map(function(P){return x["enable".concat(P,"Checker")]=!1,x["".concat(P,"Checker")]&&clearInterval(x["".concat(P,"Checker")]),P})}}])&&Qn(D.prototype,z),Object.defineProperty(D,"prototype",{writable:!1}),E}();const Jn=Go;function lr(E){return lr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},lr(E)}function Si(E,D){for(var z=0;z<D.length;z++){var x=D[z];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(E,(P=function(N,Z){if(lr(N)!=="object"||N===null)return N;var fe=N[Symbol.toPrimitive];if(fe!==void 0){var pe=fe.call(N,"string");if(lr(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(N)}(x.key),lr(P)==="symbol"?P:String(P)),x)}var P}const sn=function(){function E(x){var P=this;(function(N,Z){if(!(N instanceof Z))throw new TypeError("Cannot call a class as a function")})(this,E),this.container=x,this.container.addEventListener("animationend",function(){P.container.classList.remove("dplayer-bezel-transition")})}var D,z;return D=E,(z=[{key:"switch",value:function(x){this.container.innerHTML=x,this.container.classList.add("dplayer-bezel-transition")}}])&&Si(D.prototype,z),Object.defineProperty(D,"prototype",{writable:!1}),E}();function Mr(E){return Mr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},Mr(E)}function Ta(E,D){for(var z=0;z<D.length;z++){var x=D[z];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(E,(P=function(N,Z){if(Mr(N)!=="object"||N===null)return N;var fe=N[Symbol.toPrimitive];if(fe!==void 0){var pe=fe.call(N,"string");if(Mr(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(N)}(x.key),Mr(P)==="symbol"?P:String(P)),x)}var P}var Fr=function(){function E(x){(function(P,N){if(!(P instanceof N))throw new TypeError("Cannot call a class as a function")})(this,E),this.container=x.container,this.barWidth=x.barWidth,this.container.style.backgroundImage="url('".concat(x.url,"')"),this.events=x.events}var D,z;return D=E,(z=[{key:"resize",value:function(x,P,N){this.container.style.width="".concat(x,"px"),this.container.style.height="".concat(P,"px"),this.container.style.top="".concat(2-P,"px"),this.barWidth=N}},{key:"show",value:function(){this.container.style.display="block",this.events&&this.events.trigger("thumbnails_show")}},{key:"move",value:function(x){this.container.style.backgroundPosition="-".concat(160*(Math.ceil(x/this.barWidth*100)-1),"px 0"),this.container.style.left="".concat(Math.min(Math.max(x-this.container.offsetWidth/2,-10),this.barWidth-150),"px")}},{key:"hide",value:function(){this.container.style.display="none",this.events&&this.events.trigger("thumbnails_hide")}}])&&Ta(D.prototype,z),Object.defineProperty(D,"prototype",{writable:!1}),E}();const qo=Fr;function oi(E){return oi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},oi(E)}function Sa(E,D){for(var z=0;z<D.length;z++){var x=D[z];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(E,(P=function(N,Z){if(oi(N)!=="object"||N===null)return N;var fe=N[Symbol.toPrimitive];if(fe!==void 0){var pe=fe.call(N,"string");if(oi(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(N)}(x.key),oi(P)==="symbol"?P:String(P)),x)}var P}var $n,ur=!0,Nr=!1,dr=function(){function E(x){(function(P,N){if(!(P instanceof N))throw new TypeError("Cannot call a class as a function")})(this,E),this.player=x,this.autoHideTimer=0,De.isMobile||(this.setAutoHideHandler=this.setAutoHide.bind(this),this.player.container.addEventListener("mousemove",this.setAutoHideHandler),this.player.container.addEventListener("click",this.setAutoHideHandler),this.player.on("play",this.setAutoHideHandler),this.player.on("pause",this.setAutoHideHandler)),this.initPlayButton(),this.initThumbnails(),this.initPlayedBar(),this.initFullButton(),this.initQualityButton(),this.initScreenshotButton(),this.player.options.subtitle&&typeof this.player.options.subtitle.url=="string"&&this.initSubtitleButton(),this.initHighlights(),this.initAirplayButton(),this.initChromecastButton(),De.isMobile||this.initVolumeButton()}var D,z;return D=E,(z=[{key:"initPlayButton",value:function(){var x=this;this.player.template.playButton.addEventListener("click",function(){x.player.toggle()}),this.player.template.mobilePlayButton.addEventListener("click",function(){x.player.toggle()}),De.isMobile?(this.player.template.videoWrap.addEventListener("click",function(){x.toggle()}),this.player.template.controllerMask.addEventListener("click",function(){x.toggle()})):this.player.options.preventClickToggle||(this.player.template.videoWrap.addEventListener("click",function(){x.player.toggle()}),this.player.template.controllerMask.addEventListener("click",function(){x.player.toggle()}))}},{key:"initHighlights",value:function(){var x=this;this.player.on("durationchange",function(){if(x.player.video.duration!==1&&x.player.video.duration!==1/0&&x.player.options.highlight){var P=x.player.template.playedBarWrap.querySelectorAll(".dplayer-highlight");[].slice.call(P,0).forEach(function(fe){x.player.template.playedBarWrap.removeChild(fe)});for(var N=0;N<x.player.options.highlight.length;N++)if(x.player.options.highlight[N].text&&x.player.options.highlight[N].time){var Z=document.createElement("div");Z.classList.add("dplayer-highlight"),Z.style.left=x.player.options.highlight[N].time/x.player.video.duration*100+"%",Z.innerHTML='<span class="dplayer-highlight-text">'+x.player.options.highlight[N].text+"</span>",x.player.template.playedBarWrap.insertBefore(Z,x.player.template.playedBarTime)}}})}},{key:"initThumbnails",value:function(){var x=this;this.player.options.video.thumbnails&&(this.thumbnails=new qo({container:this.player.template.barPreview,barWidth:this.player.template.barWrap.offsetWidth,url:this.player.options.video.thumbnails,events:this.player.events}),this.player.on("loadedmetadata",function(){x.thumbnails.resize(160,x.player.video.videoHeight/x.player.video.videoWidth*160,x.player.template.barWrap.offsetWidth)}))}},{key:"initPlayedBar",value:function(){var x=this,P=function(Z){var fe=((Z.clientX||Z.changedTouches[0].clientX)-De.getBoundingClientRectViewLeft(x.player.template.playedBarWrap))/x.player.template.playedBarWrap.clientWidth;fe=Math.max(fe,0),fe=Math.min(fe,1),x.player.bar.set("played",fe,"width"),x.player.template.ptime.innerHTML=De.secondToTime(fe*x.player.video.duration)},N=function Z(fe){document.removeEventListener(De.nameMap.dragEnd,Z),document.removeEventListener(De.nameMap.dragMove,P);var pe=((fe.clientX||fe.changedTouches[0].clientX)-De.getBoundingClientRectViewLeft(x.player.template.playedBarWrap))/x.player.template.playedBarWrap.clientWidth;pe=Math.max(pe,0),pe=Math.min(pe,1),x.player.bar.set("played",pe,"width"),x.player.seek(x.player.bar.get("played")*x.player.video.duration),x.player.timer.enable("progress")};this.player.template.playedBarWrap.addEventListener(De.nameMap.dragStart,function(){x.player.timer.disable("progress"),document.addEventListener(De.nameMap.dragMove,P),document.addEventListener(De.nameMap.dragEnd,N)}),this.player.template.playedBarWrap.addEventListener(De.nameMap.dragMove,function(Z){if(x.player.video.duration){var fe=x.player.template.playedBarWrap.getBoundingClientRect().left,pe=(Z.clientX||Z.changedTouches[0].clientX)-fe;if(pe<0||pe>x.player.template.playedBarWrap.offsetWidth)return;var He=x.player.video.duration*(pe/x.player.template.playedBarWrap.offsetWidth);De.isMobile&&x.thumbnails&&x.thumbnails.show(),x.thumbnails&&x.thumbnails.move(pe),x.player.template.playedBarTime.style.left="".concat(pe-(He>=3600?25:20),"px"),x.player.template.playedBarTime.innerText=De.secondToTime(He),x.player.template.playedBarTime.classList.remove("hidden")}}),this.player.template.playedBarWrap.addEventListener(De.nameMap.dragEnd,function(){De.isMobile&&x.thumbnails&&x.thumbnails.hide()}),De.isMobile||(this.player.template.playedBarWrap.addEventListener("mouseenter",function(){x.player.video.duration&&(x.thumbnails&&x.thumbnails.show(),x.player.template.playedBarTime.classList.remove("hidden"))}),this.player.template.playedBarWrap.addEventListener("mouseleave",function(){x.player.video.duration&&(x.thumbnails&&x.thumbnails.hide(),x.player.template.playedBarTime.classList.add("hidden"))}))}},{key:"initFullButton",value:function(){var x=this;this.player.template.browserFullButton.addEventListener("click",function(){x.player.fullScreen.toggle("browser")}),this.player.template.webFullButton.addEventListener("click",function(){x.player.fullScreen.toggle("web")})}},{key:"initVolumeButton",value:function(){var x=this,P=function(Z){var fe=Z||window.event,pe=((fe.clientX||fe.changedTouches[0].clientX)-De.getBoundingClientRectViewLeft(x.player.template.volumeBarWrap)-5.5)/35;x.player.volume(pe)},N=function Z(){document.removeEventListener(De.nameMap.dragEnd,Z),document.removeEventListener(De.nameMap.dragMove,P),x.player.template.volumeButton.classList.remove("dplayer-volume-active")};this.player.template.volumeBarWrapWrap.addEventListener("click",function(Z){var fe=Z||window.event,pe=((fe.clientX||fe.changedTouches[0].clientX)-De.getBoundingClientRectViewLeft(x.player.template.volumeBarWrap)-5.5)/35;x.player.volume(pe)}),this.player.template.volumeBarWrapWrap.addEventListener(De.nameMap.dragStart,function(){document.addEventListener(De.nameMap.dragMove,P),document.addEventListener(De.nameMap.dragEnd,N),x.player.template.volumeButton.classList.add("dplayer-volume-active")}),this.player.template.volumeButtonIcon.addEventListener("click",function(){x.player.video.muted?(x.player.video.muted=!1,x.player.switchVolumeIcon(),x.player.bar.set("volume",x.player.volume(),"width")):(x.player.video.muted=!0,x.player.template.volumeIcon.innerHTML=jn.volumeOff,x.player.bar.set("volume",0,"width"))})}},{key:"initQualityButton",value:function(){var x=this;this.player.options.video.quality&&this.player.template.qualityList.addEventListener("click",function(P){P.target.classList.contains("dplayer-quality-item")&&x.player.switchQuality(P.target.dataset.index)})}},{key:"initScreenshotButton",value:function(){var x=this;this.player.options.screenshot&&this.player.template.camareButton.addEventListener("click",function(){var P,N=document.createElement("canvas");N.width=x.player.video.videoWidth,N.height=x.player.video.videoHeight,N.getContext("2d").drawImage(x.player.video,0,0,N.width,N.height),N.toBlob(function(Z){P=URL.createObjectURL(Z);var fe=document.createElement("a");fe.href=P,fe.download="DPlayer.png",fe.style.display="none",document.body.appendChild(fe),fe.click(),document.body.removeChild(fe),URL.revokeObjectURL(P),x.player.events.trigger("screenshot",P)})})}},{key:"initAirplayButton",value:function(){this.player.options.airplay&&(window.WebKitPlaybackTargetAvailabilityEvent?this.player.video.addEventListener("webkitplaybacktargetavailabilitychanged",function(x){x.availability==="available"?this.template.airplayButton.disable=!1:this.template.airplayButton.disable=!0,this.template.airplayButton.addEventListener("click",function(){this.video.webkitShowPlaybackTargetPicker()}.bind(this))}.bind(this.player)):this.player.template.airplayButton.style.display="none")}},{key:"initChromecast",value:function(){var x=window.document.createElement("script");x.setAttribute("type","text/javascript"),x.setAttribute("src","https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1"),window.document.body.appendChild(x),window.__onGCastApiAvailable=function(P){if(P){var N=new($n=window.chrome.cast).SessionRequest($n.media.DEFAULT_MEDIA_RECEIVER_APP_ID),Z=new $n.ApiConfig(N,function(){},function(fe){fe===$n.ReceiverAvailability.AVAILABLE&&console.log("chromecast: ",fe)});$n.initialize(Z,function(){})}}}},{key:"initChromecastButton",value:function(){var x=this;if(this.player.options.chromecast){ur&&(ur=!1,this.initChromecast());var P=function(Z,fe){x.currentMedia=fe},N=function(Z){console.error("Error launching media",Z)};this.player.template.chromecastButton.addEventListener("click",function(){Nr?(Nr=!1,x.currentMedia.stop(),x.session.stop(),x.initChromecast()):(Nr=!0,$n.requestSession(function(Z){var fe,pe,He;x.session=Z,fe=x.player.options.video.url,pe=new $n.media.MediaInfo(fe),He=new $n.media.LoadRequest(pe),x.session?x.session.loadMedia(He,P.bind(x,"loadMedia"),N).play():window.open(fe)},function(Z){Z.code==="cancel"?x.session=void 0:console.error("Error selecting a cast device",Z)}))})}}},{key:"initSubtitleButton",value:function(){var x=this;this.player.events.on("subtitle_show",function(){x.player.template.subtitleButton.dataset.balloon=x.player.tran("hide-subs"),x.player.template.subtitleButtonInner.style.opacity="",x.player.user.set("subtitle",1)}),this.player.events.on("subtitle_hide",function(){x.player.template.subtitleButton.dataset.balloon=x.player.tran("show-subs"),x.player.template.subtitleButtonInner.style.opacity="0.4",x.player.user.set("subtitle",0)}),this.player.template.subtitleButton.addEventListener("click",function(){x.player.subtitle.toggle()})}},{key:"setAutoHide",value:function(){var x=this;this.show(),clearTimeout(this.autoHideTimer),this.autoHideTimer=setTimeout(function(){!x.player.video.played.length||x.player.paused||x.disableAutoHide||x.hide()},3e3)}},{key:"show",value:function(){this.player.container.classList.remove("dplayer-hide-controller")}},{key:"hide",value:function(){this.player.container.classList.add("dplayer-hide-controller"),this.player.setting.hide(),this.player.comment&&this.player.comment.hide()}},{key:"isShow",value:function(){return!this.player.container.classList.contains("dplayer-hide-controller")}},{key:"toggle",value:function(){this.isShow()?this.hide():this.show()}},{key:"destroy",value:function(){De.isMobile||(this.player.container.removeEventListener("mousemove",this.setAutoHideHandler),this.player.container.removeEventListener("click",this.setAutoHideHandler)),clearTimeout(this.autoHideTimer)}}])&&Sa(D.prototype,z),Object.defineProperty(D,"prototype",{writable:!1}),E}();const Ca=dr;function _r(E){return _r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},_r(E)}function Vl(E,D){for(var z=0;z<D.length;z++){var x=D[z];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(E,(P=function(N,Z){if(_r(N)!=="object"||N===null)return N;var fe=N[Symbol.toPrimitive];if(fe!==void 0){var pe=fe.call(N,"string");if(_r(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(N)}(x.key),_r(P)==="symbol"?P:String(P)),x)}var P}var zo=function(){function E(x){var P=this;(function(He,tt){if(!(He instanceof tt))throw new TypeError("Cannot call a class as a function")})(this,E),this.player=x,this.player.template.mask.addEventListener("click",function(){P.hide()}),this.player.template.settingButton.addEventListener("click",function(){P.show()}),this.loop=this.player.options.loop,this.player.template.loopToggle.checked=this.loop,this.player.template.loop.addEventListener("click",function(){P.player.template.loopToggle.checked=!P.player.template.loopToggle.checked,P.player.template.loopToggle.checked?P.loop=!0:P.loop=!1,P.hide()}),this.showDanmaku=this.player.user.get("danmaku"),this.showDanmaku||this.player.danmaku&&this.player.danmaku.hide(),this.player.template.showDanmakuToggle.checked=this.showDanmaku,this.player.template.showDanmaku.addEventListener("click",function(){P.player.template.showDanmakuToggle.checked=!P.player.template.showDanmakuToggle.checked,P.player.template.showDanmakuToggle.checked?(P.showDanmaku=!0,P.player.danmaku.show()):(P.showDanmaku=!1,P.player.danmaku.hide()),P.player.user.set("danmaku",P.showDanmaku?1:0),P.hide()}),this.unlimitDanmaku=this.player.user.get("unlimited"),this.player.template.unlimitDanmakuToggle.checked=this.unlimitDanmaku,this.player.template.unlimitDanmaku.addEventListener("click",function(){P.player.template.unlimitDanmakuToggle.checked=!P.player.template.unlimitDanmakuToggle.checked,P.player.template.unlimitDanmakuToggle.checked?(P.unlimitDanmaku=!0,P.player.danmaku.unlimit(!0)):(P.unlimitDanmaku=!1,P.player.danmaku.unlimit(!1)),P.player.user.set("unlimited",P.unlimitDanmaku?1:0),P.hide()}),this.player.template.speed.addEventListener("click",function(){P.player.template.settingBox.classList.add("dplayer-setting-box-narrow"),P.player.template.settingBox.classList.add("dplayer-setting-box-speed")});for(var N=function(He){P.player.template.speedItem[He].addEventListener("click",function(){P.player.speed(P.player.template.speedItem[He].dataset.speed),P.hide()})},Z=0;Z<this.player.template.speedItem.length;Z++)N(Z);if(this.player.danmaku){this.player.on("danmaku_opacity",function(He){P.player.bar.set("danmaku",He,"width"),P.player.user.set("opacity",He)}),this.player.danmaku.opacity(this.player.user.get("opacity"));var fe=function(He){var tt=He||window.event,vt=((tt.clientX||tt.changedTouches[0].clientX)-De.getBoundingClientRectViewLeft(P.player.template.danmakuOpacityBarWrap))/130;vt=Math.max(vt,0),vt=Math.min(vt,1),P.player.danmaku.opacity(vt)},pe=function He(){document.removeEventListener(De.nameMap.dragEnd,He),document.removeEventListener(De.nameMap.dragMove,fe),P.player.template.danmakuOpacityBox.classList.remove("dplayer-setting-danmaku-active")};this.player.template.danmakuOpacityBarWrapWrap.addEventListener("click",function(He){var tt=He||window.event,vt=((tt.clientX||tt.changedTouches[0].clientX)-De.getBoundingClientRectViewLeft(P.player.template.danmakuOpacityBarWrap))/130;vt=Math.max(vt,0),vt=Math.min(vt,1),P.player.danmaku.opacity(vt)}),this.player.template.danmakuOpacityBarWrapWrap.addEventListener(De.nameMap.dragStart,function(){document.addEventListener(De.nameMap.dragMove,fe),document.addEventListener(De.nameMap.dragEnd,pe),P.player.template.danmakuOpacityBox.classList.add("dplayer-setting-danmaku-active")})}}var D,z;return D=E,(z=[{key:"hide",value:function(){var x=this;this.player.template.settingBox.classList.remove("dplayer-setting-box-open"),this.player.template.mask.classList.remove("dplayer-mask-show"),setTimeout(function(){x.player.template.settingBox.classList.remove("dplayer-setting-box-narrow"),x.player.template.settingBox.classList.remove("dplayer-setting-box-speed")},300),this.player.controller.disableAutoHide=!1}},{key:"show",value:function(){this.player.template.settingBox.classList.add("dplayer-setting-box-open"),this.player.template.mask.classList.add("dplayer-mask-show"),this.player.controller.disableAutoHide=!0}}])&&Vl(D.prototype,z),Object.defineProperty(D,"prototype",{writable:!1}),E}();const es=zo;function br(E){return br=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},br(E)}function wa(E,D){for(var z=0;z<D.length;z++){var x=D[z];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(E,(P=function(N,Z){if(br(N)!=="object"||N===null)return N;var fe=N[Symbol.toPrimitive];if(fe!==void 0){var pe=fe.call(N,"string");if(br(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(N)}(x.key),br(P)==="symbol"?P:String(P)),x)}var P}var Ks=function(){function E(x){var P=this;(function(N,Z){if(!(N instanceof Z))throw new TypeError("Cannot call a class as a function")})(this,E),this.player=x,this.player.template.mask.addEventListener("click",function(){P.hide()}),this.player.template.commentButton.addEventListener("click",function(){P.show()}),this.player.template.commentSettingButton.addEventListener("click",function(){P.toggleSetting()}),this.player.template.commentColorSettingBox.addEventListener("click",function(){if(P.player.template.commentColorSettingBox.querySelector("input:checked+span")){var N=P.player.template.commentColorSettingBox.querySelector("input:checked").value;P.player.template.commentSettingFill.style.fill=N,P.player.template.commentInput.style.color=N,P.player.template.commentSendFill.style.fill=N}}),this.player.template.commentInput.addEventListener("click",function(){P.hideSetting()}),this.player.template.commentInput.addEventListener("keydown",function(N){(N||window.event).keyCode===13&&P.send()}),this.player.template.commentSendButton.addEventListener("click",function(){P.send()})}var D,z;return D=E,(z=[{key:"show",value:function(){this.player.controller.disableAutoHide=!0,this.player.template.controller.classList.add("dplayer-controller-comment"),this.player.template.mask.classList.add("dplayer-mask-show"),this.player.container.classList.add("dplayer-show-controller"),this.player.template.commentInput.focus()}},{key:"hide",value:function(){this.player.template.controller.classList.remove("dplayer-controller-comment"),this.player.template.mask.classList.remove("dplayer-mask-show"),this.player.container.classList.remove("dplayer-show-controller"),this.player.controller.disableAutoHide=!1,this.hideSetting()}},{key:"showSetting",value:function(){this.player.template.commentSettingBox.classList.add("dplayer-comment-setting-open")}},{key:"hideSetting",value:function(){this.player.template.commentSettingBox.classList.remove("dplayer-comment-setting-open")}},{key:"toggleSetting",value:function(){this.player.template.commentSettingBox.classList.contains("dplayer-comment-setting-open")?this.hideSetting():this.showSetting()}},{key:"send",value:function(){var x=this;this.player.template.commentInput.blur(),this.player.template.commentInput.value.replace(/^\s+|\s+$/g,"")?this.player.danmaku.send({text:this.player.template.commentInput.value,color:De.color2Number(this.player.container.querySelector(".dplayer-comment-setting-color input:checked").value),type:parseInt(this.player.container.querySelector(".dplayer-comment-setting-type input:checked").value)},function(){x.player.template.commentInput.value="",x.hide()}):this.player.notice(this.player.tran("please-input-danmaku"))}}])&&wa(D.prototype,z),Object.defineProperty(D,"prototype",{writable:!1}),E}();const Ys=Ks;function gn(E){return gn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},gn(E)}function no(E,D){for(var z=0;z<D.length;z++){var x=D[z];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(E,(P=function(N,Z){if(gn(N)!=="object"||N===null)return N;var fe=N[Symbol.toPrimitive];if(fe!==void 0){var pe=fe.call(N,"string");if(gn(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(N)}(x.key),gn(P)==="symbol"?P:String(P)),x)}var P}var Xs=function(){function E(x){(function(P,N){if(!(P instanceof N))throw new TypeError("Cannot call a class as a function")})(this,E),this.player=x,this.doHotKeyHandler=this.doHotKey.bind(this),this.cancelFullScreenHandler=this.cancelFullScreen.bind(this),this.player.options.hotkey&&document.addEventListener("keydown",this.doHotKeyHandler),document.addEventListener("keydown",this.cancelFullScreenHandler)}var D,z;return D=E,(z=[{key:"doHotKey",value:function(x){if(this.player.focus){var P=document.activeElement.tagName.toUpperCase(),N=document.activeElement.getAttribute("contenteditable");if(P!=="INPUT"&&P!=="TEXTAREA"&&N!==""&&N!=="true"){var Z,fe=x||window.event;switch(fe.keyCode){case 32:fe.preventDefault(),this.player.toggle();break;case 37:if(fe.preventDefault(),this.player.options.live)break;this.player.seek(this.player.video.currentTime-5),this.player.controller.setAutoHide();break;case 39:if(fe.preventDefault(),this.player.options.live)break;this.player.seek(this.player.video.currentTime+5),this.player.controller.setAutoHide();break;case 38:fe.preventDefault(),Z=this.player.volume()+.1,this.player.volume(Z);break;case 40:fe.preventDefault(),Z=this.player.volume()-.1,this.player.volume(Z)}}}}},{key:"cancelFullScreen",value:function(x){(x||window.event).keyCode===27&&this.player.fullScreen.isFullScreen("web")&&this.player.fullScreen.cancel("web")}},{key:"destroy",value:function(){this.player.options.hotkey&&document.removeEventListener("keydown",this.doHotKeyHandler),document.removeEventListener("keydown",this.cancelFullScreenHandler)}}])&&no(D.prototype,z),Object.defineProperty(D,"prototype",{writable:!1}),E}();const Ur=Xs;function an(E){return an=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},an(E)}function La(E,D){for(var z=0;z<D.length;z++){var x=D[z];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(E,(P=function(N,Z){if(an(N)!=="object"||N===null)return N;var fe=N[Symbol.toPrimitive];if(fe!==void 0){var pe=fe.call(N,"string");if(an(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(N)}(x.key),an(P)==="symbol"?P:String(P)),x)}var P}var Da=function(){function E(x){var P=this;(function(N,Z){if(!(N instanceof Z))throw new TypeError("Cannot call a class as a function")})(this,E),this.player=x,this.shown=!1,Array.prototype.slice.call(this.player.template.menuItem).forEach(function(N,Z){P.player.options.contextmenu[Z].click&&N.addEventListener("click",function(){P.player.options.contextmenu[Z].click(P.player),P.hide()})}),this.contextmenuHandler=function(N){if(P.shown)P.hide();else{var Z=N||window.event;Z.preventDefault();var fe=P.player.container.getBoundingClientRect();P.show(Z.clientX-fe.left,Z.clientY-fe.top),P.player.template.mask.addEventListener("click",function(){P.hide()})}},this.player.container.addEventListener("contextmenu",this.contextmenuHandler)}var D,z;return D=E,(z=[{key:"show",value:function(x,P){this.player.template.menu.classList.add("dplayer-menu-show");var N=this.player.container.getBoundingClientRect();x+this.player.template.menu.offsetWidth>=N.width?(this.player.template.menu.style.right=N.width-x+"px",this.player.template.menu.style.left="initial"):(this.player.template.menu.style.left=x+"px",this.player.template.menu.style.right="initial"),P+this.player.template.menu.offsetHeight>=N.height?(this.player.template.menu.style.bottom=N.height-P+"px",this.player.template.menu.style.top="initial"):(this.player.template.menu.style.top=P+"px",this.player.template.menu.style.bottom="initial"),this.player.template.mask.classList.add("dplayer-mask-show"),this.shown=!0,this.player.events.trigger("contextmenu_show")}},{key:"hide",value:function(){this.player.template.mask.classList.remove("dplayer-mask-show"),this.player.template.menu.classList.remove("dplayer-menu-show"),this.shown=!1,this.player.events.trigger("contextmenu_hide")}},{key:"destroy",value:function(){this.player.container.removeEventListener("contextmenu",this.contextmenuHandler)}}])&&La(D.prototype,z),Object.defineProperty(D,"prototype",{writable:!1}),E}();const Wo=Da;function st(E){return st=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},st(E)}function jr(E,D){for(var z=0;z<D.length;z++){var x=D[z];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(E,(P=function(N,Z){if(st(N)!=="object"||N===null)return N;var fe=N[Symbol.toPrimitive];if(fe!==void 0){var pe=fe.call(N,"string");if(st(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(N)}(x.key),st(P)==="symbol"?P:String(P)),x)}var P}var ts=function(){function E(x){var P=this;(function(N,Z){if(!(N instanceof Z))throw new TypeError("Cannot call a class as a function")})(this,E),this.container=x.template.infoPanel,this.template=x.template,this.video=x.video,this.player=x,this.template.infoPanelClose.addEventListener("click",function(){P.hide()})}var D,z;return D=E,(z=[{key:"show",value:function(){this.beginTime=Date.now(),this.update(),this.player.timer.enable("info"),this.player.timer.enable("fps"),this.container.classList.remove("dplayer-info-panel-hide")}},{key:"hide",value:function(){this.player.timer.disable("info"),this.player.timer.disable("fps"),this.container.classList.add("dplayer-info-panel-hide")}},{key:"triggle",value:function(){this.container.classList.contains("dplayer-info-panel-hide")?this.show():this.hide()}},{key:"update",value:function(){this.template.infoVersion.innerHTML="v".concat("1.27.1"," ").concat("v1.27.0-12-g4f61091"),this.template.infoType.innerHTML=this.player.type,this.template.infoUrl.innerHTML=this.player.options.video.url,this.template.infoResolution.innerHTML="".concat(this.player.video.videoWidth," x ").concat(this.player.video.videoHeight),this.template.infoDuration.innerHTML=this.player.video.duration,this.player.options.danmaku&&(this.template.infoDanmakuId.innerHTML=this.player.options.danmaku.id,this.template.infoDanmakuApi.innerHTML=this.player.options.danmaku.api,this.template.infoDanmakuAmount.innerHTML=this.player.danmaku.dan.length)}},{key:"fps",value:function(x){this.template.infoFPS.innerHTML="".concat(x.toFixed(1))}}])&&jr(D.prototype,z),Object.defineProperty(D,"prototype",{writable:!1}),E}();const Ko=ts;var Yo=ve(568),Xt=ve.n(Yo);function Vn(E){return Vn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(D){return typeof D}:function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},Vn(E)}function Bn(E,D){var z=Object.keys(E);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(E);D&&(x=x.filter(function(P){return Object.getOwnPropertyDescriptor(E,P).enumerable})),z.push.apply(z,x)}return z}function is(E,D,z){return(D=Qs(D))in E?Object.defineProperty(E,D,{value:z,enumerable:!0,configurable:!0,writable:!0}):E[D]=z,E}function $r(E,D){for(var z=0;z<D.length;z++){var x=D[z];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(E,Qs(x.key),x)}}function Qs(E){var D=function(z,x){if(Vn(z)!=="object"||z===null)return z;var P=z[Symbol.toPrimitive];if(P!==void 0){var N=P.call(z,"string");if(Vn(N)!=="object")return N;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(z)}(E);return Vn(D)==="symbol"?D:String(D)}var ka=0,Vr=[],cr=function(){function E(P){var N=this;(function(Z,fe){if(!(Z instanceof fe))throw new TypeError("Cannot call a class as a function")})(this,E),this.options=function(Z){var fe={container:Z.element||document.getElementsByClassName("dplayer")[0],live:!1,autoplay:!1,theme:"#b7daff",loop:!1,lang:(navigator.language||navigator.browserLanguage).toLowerCase(),screenshot:!1,airplay:!0,chromecast:!1,hotkey:!0,preload:"metadata",volume:.7,playbackSpeed:[.5,.75,1,1.25,1.5,2],apiBackend:fi,video:{},contextmenu:[],mutex:!0,pluginOptions:{hls:{},flv:{},dash:{},webtorrent:{}},preventClickToggle:!1};for(var pe in fe)fe.hasOwnProperty(pe)&&!Z.hasOwnProperty(pe)&&(Z[pe]=fe[pe]);return Z.video&&!Z.video.type&&(Z.video.type="auto"),qt(Z.danmaku)==="object"&&Z.danmaku&&!Z.danmaku.user&&(Z.danmaku.user="DIYgod"),Z.subtitle&&(!Z.subtitle.type&&(Z.subtitle.type="webvtt"),!Z.subtitle.fontSize&&(Z.subtitle.fontSize="20px"),!Z.subtitle.bottom&&(Z.subtitle.bottom="40px"),!Z.subtitle.color&&(Z.subtitle.color="#fff")),Z.video.quality&&(Z.video.url=Z.video.quality[Z.video.defaultQuality].url),Z.lang&&(Z.lang=Z.lang.toLowerCase()),Z.contextmenu=Z.contextmenu.concat([{key:"video-info",click:function(He){He.infoPanel.triggle()}},{key:"about-author",link:"https://diygod.me"},{text:"DPlayer v".concat("1.27.1"),link:"https://github.com/MoePlayer/DPlayer"}]),Z}(function(Z){for(var fe=1;fe<arguments.length;fe++){var pe=arguments[fe]!=null?arguments[fe]:{};fe%2?Bn(Object(pe),!0).forEach(function(He){is(Z,He,pe[He])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Z,Object.getOwnPropertyDescriptors(pe)):Bn(Object(pe)).forEach(function(He){Object.defineProperty(Z,He,Object.getOwnPropertyDescriptor(pe,He))})}return Z}({preload:P.video.type==="webtorrent"?"none":"metadata"},P)),this.options.video.quality&&(this.qualityIndex=this.options.video.defaultQuality,this.quality=this.options.video.quality[this.options.video.defaultQuality]),this.tran=new Bo(this.options.lang).tran,this.events=new io,this.user=new Ho(this),this.container=this.options.container,this.noticeList={},this.container.classList.add("dplayer"),this.options.danmaku||this.container.classList.add("dplayer-no-danmaku"),this.options.live?this.container.classList.add("dplayer-live"):this.container.classList.remove("dplayer-live"),De.isMobile&&this.container.classList.add("dplayer-mobile"),this.arrow=this.container.offsetWidth<=500,this.arrow&&this.container.classList.add("dplayer-arrow"),this.options.subtitle&&Array.isArray(this.options.subtitle.url)&&(this.options.subtitle.url.push({subtitle:"",lang:"off"}),this.options.subtitle.defaultSubtitle&&(typeof this.options.subtitle.defaultSubtitle=="string"?this.options.subtitle.index=this.options.subtitle.url.findIndex(function(Z){return Z.lang===N.options.subtitle.defaultSubtitle||Z.name===N.options.subtitle.defaultSubtitle}):typeof this.options.subtitle.defaultSubtitle=="number"&&(this.options.subtitle.index=this.options.subtitle.defaultSubtitle)),(this.options.subtitle.index===-1||!this.options.subtitle.index||this.options.subtitle.index>this.options.subtitle.url.length-1)&&(this.options.subtitle.index=this.options.subtitle.url.findIndex(function(Z){return Z.lang===N.options.lang})),this.options.subtitle.index===-1&&(this.options.subtitle.index=this.options.subtitle.url.length-1)),this.template=new qs({container:this.container,options:this.options,index:ka,tran:this.tran}),this.video=this.template.video,this.bar=new Es(this.template),this.bezel=new sn(this.template.bezel),this.fullScreen=new Qr(this),this.controller=new Ca(this),this.options.danmaku&&(this.danmaku=new ba({player:this,container:this.template.danmaku,opacity:this.user.get("opacity"),callback:function(){setTimeout(function(){N.template.danmakuLoading.style.display="none",N.options.autoplay&&N.play()},0)},error:function(Z){N.notice(Z)},apiBackend:this.options.apiBackend,borderColor:this.options.theme,height:this.arrow?24:30,time:function(){return N.video.currentTime},unlimited:this.user.get("unlimited"),api:{id:this.options.danmaku.id,address:this.options.danmaku.api,token:this.options.danmaku.token,maximum:this.options.danmaku.maximum,addition:this.options.danmaku.addition,user:this.options.danmaku.user,speedRate:this.options.danmaku.speedRate},events:this.events,tran:function(Z){return N.tran(Z)}}),this.comment=new Ys(this)),this.setting=new es(this),this.plugins={},this.docClickFun=function(){N.focus=!1},this.containerClickFun=function(){N.focus=!0},document.addEventListener("click",this.docClickFun,!0),this.container.addEventListener("click",this.containerClickFun,!0),this.paused=!0,this.timer=new Jn(this),this.hotkey=new Ur(this),this.contextmenu=new Wo(this),this.initVideo(this.video,this.quality&&this.quality.type||this.options.video.type),this.infoPanel=new Ko(this),!this.danmaku&&this.options.autoplay&&this.play(),ka++,Vr.push(this)}var D,z,x;return D=E,z=[{key:"seek",value:function(P){P=Math.max(P,0),this.video.duration&&(P=Math.min(P,this.video.duration)),this.video.currentTime<P?this.notice("".concat(this.tran("ff").replace("%s",(P-this.video.currentTime).toFixed(0)))):this.video.currentTime>P&&this.notice("".concat(this.tran("rew").replace("%s",(this.video.currentTime-P).toFixed(0)))),this.video.currentTime=P,this.danmaku&&this.danmaku.seek(),this.bar.set("played",P/this.video.duration,"width"),this.template.ptime.innerHTML=De.secondToTime(P)}},{key:"play",value:function(P){var N=this;if(this.paused=!1,this.video.paused&&!De.isMobile&&this.bezel.switch(jn.play),this.template.playButton.innerHTML=jn.pause,this.template.mobilePlayButton.innerHTML=jn.pause,P||Le.resolve(this.video.play()).catch(function(){N.pause()}).then(function(){}),this.timer.enable("loading"),this.container.classList.remove("dplayer-paused"),this.container.classList.add("dplayer-playing"),this.danmaku&&this.danmaku.play(),this.options.mutex)for(var Z=0;Z<Vr.length;Z++)this!==Vr[Z]&&Vr[Z].pause()}},{key:"pause",value:function(P){this.paused=!0,this.container.classList.remove("dplayer-loading"),this.video.paused||De.isMobile||this.bezel.switch(jn.pause),this.template.playButton.innerHTML=jn.play,this.template.mobilePlayButton.innerHTML=jn.play,P||this.video.pause(),this.timer.disable("loading"),this.container.classList.remove("dplayer-playing"),this.container.classList.add("dplayer-paused"),this.danmaku&&this.danmaku.pause()}},{key:"switchVolumeIcon",value:function(){this.volume()>=.95?this.template.volumeIcon.innerHTML=jn.volumeUp:this.volume()>0?this.template.volumeIcon.innerHTML=jn.volumeDown:this.template.volumeIcon.innerHTML=jn.volumeOff}},{key:"volume",value:function(P,N,Z){if(P=parseFloat(P),!isNaN(P)){P=Math.max(P,0),P=Math.min(P,1),this.bar.set("volume",P,"width");var fe="".concat((100*P).toFixed(0),"%");this.template.volumeBarWrapWrap.dataset.balloon=fe,N||this.user.set("volume",P),Z||this.notice("".concat(this.tran("volume")," ").concat((100*P).toFixed(0),"%"),void 0,void 0,"volume"),this.video.volume=P,this.video.muted&&(this.video.muted=!1),this.switchVolumeIcon()}return this.video.volume}},{key:"toggle",value:function(){this.video.paused?this.play():this.pause()}},{key:"on",value:function(P,N){this.events.on(P,N)}},{key:"switchVideo",value:function(P,N){this.pause(),this.video.poster=P.pic?P.pic:"",this.video.src=P.url,this.initMSE(this.video,P.type||"auto"),N&&(this.template.danmakuLoading.style.display="block",this.bar.set("played",0,"width"),this.bar.set("loaded",0,"width"),this.template.ptime.innerHTML="00:00",this.template.danmaku.innerHTML="",this.danmaku&&this.danmaku.reload({id:N.id,address:N.api,token:N.token,maximum:N.maximum,addition:N.addition,user:N.user}))}},{key:"initMSE",value:function(P,N){var Z=this;if(this.type=N,this.options.video.customType&&this.options.video.customType[N])Object.prototype.toString.call(this.options.video.customType[N])==="[object Function]"?this.options.video.customType[N](this.video,this):console.error("Illegal customType: ".concat(N));else switch(this.type==="auto"&&(/m3u8(#|\?|$)/i.exec(P.src)?this.type="hls":/.flv(#|\?|$)/i.exec(P.src)?this.type="flv":/.mpd(#|\?|$)/i.exec(P.src)?this.type="dash":this.type="normal"),this.type==="hls"&&(P.canPlayType("application/x-mpegURL")||P.canPlayType("application/vnd.apple.mpegURL"))&&(this.type="normal"),this.type){case"hls":if(window.Hls)if(window.Hls.isSupported()){var fe=this.options.pluginOptions.hls,pe=new window.Hls(fe);this.plugins.hls=pe,pe.loadSource(P.src),pe.attachMedia(P),this.events.on("destroy",function(){pe.destroy(),delete Z.plugins.hls})}else this.notice("Error: Hls is not supported.");else this.notice("Error: Can't find Hls.");break;case"flv":if(window.flvjs)if(window.flvjs.isSupported()){var He=window.flvjs.createPlayer(Object.assign(this.options.pluginOptions.flv.mediaDataSource||{},{type:"flv",url:P.src}),this.options.pluginOptions.flv.config);this.plugins.flvjs=He,He.attachMediaElement(P),He.load(),this.events.on("destroy",function(){He.unload(),He.detachMediaElement(),He.destroy(),delete Z.plugins.flvjs})}else this.notice("Error: flvjs is not supported.");else this.notice("Error: Can't find flvjs.");break;case"dash":if(window.dashjs){var tt=window.dashjs.MediaPlayer().create().initialize(P,P.src,!1),vt=this.options.pluginOptions.dash;tt.updateSettings(vt),this.plugins.dash=tt,this.events.on("destroy",function(){window.dashjs.MediaPlayer().reset(),delete Z.plugins.dash})}else this.notice("Error: Can't find dashjs.");break;case"webtorrent":if(window.WebTorrent)if(window.WebTorrent.WEBRTC_SUPPORT){this.container.classList.add("dplayer-loading");var _t=this.options.pluginOptions.webtorrent,Rt=new window.WebTorrent(_t);this.plugins.webtorrent=Rt;var Et=P.src;P.src="",P.preload="metadata",P.addEventListener("durationchange",function(){return Z.container.classList.remove("dplayer-loading")},{once:!0}),Rt.add(Et,function(bt){bt.files.find(function(Ot){return Ot.name.endsWith(".mp4")}).renderTo(Z.video,{autoplay:Z.options.autoplay,controls:!1})}),this.events.on("destroy",function(){Rt.remove(Et),Rt.destroy(),delete Z.plugins.webtorrent})}else this.notice("Error: Webtorrent is not supported.");else this.notice("Error: Can't find Webtorrent.")}}},{key:"initVideo",value:function(P,N){var Z=this;this.initMSE(P,N),this.on("durationchange",function(){P.duration!==1&&P.duration!==1/0&&(Z.template.dtime.innerHTML=De.secondToTime(P.duration))}),this.on("progress",function(){var He=P.buffered.length?P.buffered.end(P.buffered.length-1)/P.duration:0;Z.bar.set("loaded",He,"width")}),this.on("error",function(){Z.video.error&&Z.tran&&Z.notice&&Z.type!=="webtorrent"&&Z.notice(Z.tran("video-failed"))}),this.on("ended",function(){Z.bar.set("played",1,"width"),Z.setting.loop?(Z.seek(0),Z.play()):Z.pause(),Z.danmaku&&(Z.danmaku.danIndex=0)}),this.on("play",function(){Z.paused&&Z.play(!0)}),this.on("pause",function(){Z.paused||Z.pause(!0)}),this.on("timeupdate",function(){Z.bar.set("played",Z.video.currentTime/Z.video.duration,"width");var He=De.secondToTime(Z.video.currentTime);Z.template.ptime.innerHTML!==He&&(Z.template.ptime.innerHTML=He)});for(var fe=function(He){P.addEventListener(Z.events.videoEvents[He],function(tt){Z.events.trigger(Z.events.videoEvents[He],tt)})},pe=0;pe<this.events.videoEvents.length;pe++)fe(pe);this.volume(this.user.get("volume"),!0,!0),this.options.subtitle&&(this.subtitle=new Ea(this.template.subtitle,this.video,this.options.subtitle,this.events),Array.isArray(this.options.subtitle.url)&&(this.subtitles=new Ar(this)),this.user.get("subtitle")||this.subtitle.hide())}},{key:"switchQuality",value:function(P){var N=this;if(P=typeof P=="string"?parseInt(P):P,this.qualityIndex!==P&&!this.switchingQuality){this.prevIndex=this.qualityIndex,this.qualityIndex=P,this.switchingQuality=!0,this.quality=this.options.video.quality[P],this.template.qualityButton.innerHTML=this.quality.name;var Z=this.video.paused;this.video.pause();var fe=Xt()({current:!1,pic:null,screenshot:this.options.screenshot,preload:"auto",url:this.quality.url,subtitle:this.options.subtitle}),pe=new DOMParser().parseFromString(fe,"text/html").body.firstChild;this.template.videoWrap.insertBefore(pe,this.template.videoWrap.getElementsByTagName("div")[0]),this.prevVideo=this.video,this.video=pe,this.initVideo(this.video,this.quality.type||this.options.video.type),this.seek(this.prevVideo.currentTime),this.notice("".concat(this.tran("switching-quality").replace("%q",this.quality.name)),-1,void 0,"switch-quality"),this.events.trigger("quality_start",this.quality),this.on("canplay",function(){if(N.prevVideo){if(N.video.currentTime!==N.prevVideo.currentTime)return void N.seek(N.prevVideo.currentTime);N.template.videoWrap.removeChild(N.prevVideo),N.video.classList.add("dplayer-video-current"),Z||N.video.play(),N.prevVideo=null,N.notice("".concat(N.tran("switched-quality").replace("%q",N.quality.name)),void 0,void 0,"switch-quality"),N.switchingQuality=!1,N.events.trigger("quality_end")}}),this.on("error",function(){N.video.error&&N.prevVideo&&(N.template.videoWrap.removeChild(N.video),N.video=N.prevVideo,Z||N.video.play(),N.qualityIndex=N.prevIndex,N.quality=N.options.video.quality[N.qualityIndex],N.noticeTime=setTimeout(function(){N.template.notice.style.opacity=0,N.events.trigger("notice_hide")},3e3),N.prevVideo=null,N.switchingQuality=!1)})}}},{key:"notice",value:function(P){var N,Z,fe,pe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2e3,He=arguments.length>2&&arguments[2]!==void 0?arguments[2]:.8,tt=arguments.length>3?arguments[3]:void 0;if(tt&&((N=document.getElementById("dplayer-notice-".concat(tt)))&&(N.innerHTML=P),this.noticeList[tt]&&(clearTimeout(this.noticeList[tt]),this.noticeList[tt]=null)),!N){var vt=qs.NewNotice(P,He,tt);this.template.noticeList.appendChild(vt),N=vt}this.events.trigger("notice_show",N),pe>0&&(this.noticeList[tt]=setTimeout((Z=N,fe=this,function(){Z.addEventListener("animationend",function(){fe.template.noticeList.removeChild(Z)}),Z.classList.add("remove-notice"),fe.events.trigger("notice_hide"),fe.noticeList[tt]=null}),pe))}},{key:"resize",value:function(){this.danmaku&&this.danmaku.resize(),this.controller.thumbnails&&this.controller.thumbnails.resize(160,this.video.videoHeight/this.video.videoWidth*160,this.template.barWrap.offsetWidth),this.events.trigger("resize")}},{key:"speed",value:function(P){this.video.playbackRate=P}},{key:"destroy",value:function(){Vr.splice(Vr.indexOf(this),1),this.pause(),document.removeEventListener("click",this.docClickFun,!0),this.container.removeEventListener("click",this.containerClickFun,!0),this.fullScreen.destroy(),this.hotkey.destroy(),this.contextmenu.destroy(),this.controller.destroy(),this.timer.destroy(),this.video.src="",this.container.innerHTML="",this.events.trigger("destroy")}}],x=[{key:"version",get:function(){return"1.27.1"}}],z&&$r(D.prototype,z),x&&$r(D,x),Object.defineProperty(D,"prototype",{writable:!1}),E}();const Xo=cr;console.log(`
`.concat(" %c DPlayer v","1.27.1"," ").concat("v1.27.0-12-g4f61091"," %c https://dplayer.diygod.dev ",`
`,`
`),"color: #fadfa3; background: #030307; padding:5px 0;","background: #fadfa3; padding:5px 0;");const xr=Xo})(),ze.default})())},89144:function(Kt,Ut,mt){var ct=typeof mt.g!="undefined"?mt.g:typeof window!="undefined"?window:{},ne=mt(25893),We;typeof document!="undefined"?We=document:(We=ct["__GLOBAL_DOCUMENT_CACHE@4"],We||(We=ct["__GLOBAL_DOCUMENT_CACHE@4"]=ne)),Kt.exports=We},58908:function(Kt,Ut,mt){var ct;typeof window!="undefined"?ct=window:typeof mt.g!="undefined"?ct=mt.g:typeof self!="undefined"?ct=self:ct={},Kt.exports=ct},44756:function(Kt,Ut,mt){"use strict";mt.d(Ut,{ZP:function(){return sa}});function ct(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var ne={exports:{}};(function(h,t){(function(n){var a=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,l=/^(?=([^\/?#]*))\1([^]*)$/,u=/(?:\/|^)\.(?=\/)/g,d=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,p={buildAbsoluteURL:function(g,v,b){if(b=b||{},g=g.trim(),v=v.trim(),!v){if(!b.alwaysNormalize)return g;var L=p.parseURL(g);if(!L)throw new Error("Error trying to parse base URL.");return L.path=p.normalizePath(L.path),p.buildURLFromParts(L)}var B=p.parseURL(v);if(!B)throw new Error("Error trying to parse relative URL.");if(B.scheme)return b.alwaysNormalize?(B.path=p.normalizePath(B.path),p.buildURLFromParts(B)):v;var W=p.parseURL(g);if(!W)throw new Error("Error trying to parse base URL.");if(!W.netLoc&&W.path&&W.path[0]!=="/"){var K=l.exec(W.path);W.netLoc=K[1],W.path=K[2]}W.netLoc&&!W.path&&(W.path="/");var ee={scheme:W.scheme,netLoc:B.netLoc,path:null,params:B.params,query:B.query,fragment:B.fragment};if(!B.netLoc&&(ee.netLoc=W.netLoc,B.path[0]!=="/"))if(!B.path)ee.path=W.path,B.params||(ee.params=W.params,B.query||(ee.query=W.query));else{var re=W.path,xe=re.substring(0,re.lastIndexOf("/")+1)+B.path;ee.path=p.normalizePath(xe)}return ee.path===null&&(ee.path=b.alwaysNormalize?p.normalizePath(B.path):B.path),p.buildURLFromParts(ee)},parseURL:function(g){var v=a.exec(g);return v?{scheme:v[1]||"",netLoc:v[2]||"",path:v[3]||"",params:v[4]||"",query:v[5]||"",fragment:v[6]||""}:null},normalizePath:function(g){for(g=g.split("").reverse().join("").replace(u,"");g.length!==(g=g.replace(d,"")).length;);return g.split("").reverse().join("")},buildURLFromParts:function(g){return g.scheme+g.netLoc+g.path+g.params+g.query+g.fragment}};h.exports=p})()})(ne);var We=ne.exports;function ve(h,t){var n=Object.keys(h);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(h);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(h,l).enumerable})),n.push.apply(n,a)}return n}function ze(h){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ve(Object(n),!0).forEach(function(a){ye(h,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(n)):ve(Object(n)).forEach(function(a){Object.defineProperty(h,a,Object.getOwnPropertyDescriptor(n,a))})}return h}function _e(h,t){if(typeof h!="object"||!h)return h;var n=h[Symbol.toPrimitive];if(n!==void 0){var a=n.call(h,t||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(h)}function we(h){var t=_e(h,"string");return typeof t=="symbol"?t:String(t)}function ye(h,t,n){return t=we(t),t in h?Object.defineProperty(h,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):h[t]=n,h}function se(){return se=Object.assign?Object.assign.bind():function(h){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(h[a]=n[a])}return h},se.apply(this,arguments)}const te=Number.isFinite||function(h){return typeof h=="number"&&isFinite(h)},Y=Number.isSafeInteger||function(h){return typeof h=="number"&&Math.abs(h)<=I},I=Number.MAX_SAFE_INTEGER||9007199254740991;let A=function(h){return h.MEDIA_ATTACHING="hlsMediaAttaching",h.MEDIA_ATTACHED="hlsMediaAttached",h.MEDIA_DETACHING="hlsMediaDetaching",h.MEDIA_DETACHED="hlsMediaDetached",h.BUFFER_RESET="hlsBufferReset",h.BUFFER_CODECS="hlsBufferCodecs",h.BUFFER_CREATED="hlsBufferCreated",h.BUFFER_APPENDING="hlsBufferAppending",h.BUFFER_APPENDED="hlsBufferAppended",h.BUFFER_EOS="hlsBufferEos",h.BUFFER_FLUSHING="hlsBufferFlushing",h.BUFFER_FLUSHED="hlsBufferFlushed",h.MANIFEST_LOADING="hlsManifestLoading",h.MANIFEST_LOADED="hlsManifestLoaded",h.MANIFEST_PARSED="hlsManifestParsed",h.LEVEL_SWITCHING="hlsLevelSwitching",h.LEVEL_SWITCHED="hlsLevelSwitched",h.LEVEL_LOADING="hlsLevelLoading",h.LEVEL_LOADED="hlsLevelLoaded",h.LEVEL_UPDATED="hlsLevelUpdated",h.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",h.LEVELS_UPDATED="hlsLevelsUpdated",h.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",h.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",h.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",h.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",h.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",h.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",h.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",h.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",h.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",h.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",h.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",h.CUES_PARSED="hlsCuesParsed",h.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",h.INIT_PTS_FOUND="hlsInitPtsFound",h.FRAG_LOADING="hlsFragLoading",h.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",h.FRAG_LOADED="hlsFragLoaded",h.FRAG_DECRYPTED="hlsFragDecrypted",h.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",h.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",h.FRAG_PARSING_METADATA="hlsFragParsingMetadata",h.FRAG_PARSED="hlsFragParsed",h.FRAG_BUFFERED="hlsFragBuffered",h.FRAG_CHANGED="hlsFragChanged",h.FPS_DROP="hlsFpsDrop",h.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",h.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",h.ERROR="hlsError",h.DESTROYING="hlsDestroying",h.KEY_LOADING="hlsKeyLoading",h.KEY_LOADED="hlsKeyLoaded",h.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",h.BACK_BUFFER_REACHED="hlsBackBufferReached",h.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",h}({}),M=function(h){return h.NETWORK_ERROR="networkError",h.MEDIA_ERROR="mediaError",h.KEY_SYSTEM_ERROR="keySystemError",h.MUX_ERROR="muxError",h.OTHER_ERROR="otherError",h}({}),k=function(h){return h.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",h.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",h.KEY_SYSTEM_NO_SESSION="keySystemNoSession",h.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",h.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",h.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",h.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",h.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",h.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",h.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",h.MANIFEST_LOAD_ERROR="manifestLoadError",h.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",h.MANIFEST_PARSING_ERROR="manifestParsingError",h.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",h.LEVEL_EMPTY_ERROR="levelEmptyError",h.LEVEL_LOAD_ERROR="levelLoadError",h.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",h.LEVEL_PARSING_ERROR="levelParsingError",h.LEVEL_SWITCH_ERROR="levelSwitchError",h.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",h.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",h.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",h.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",h.FRAG_LOAD_ERROR="fragLoadError",h.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",h.FRAG_DECRYPT_ERROR="fragDecryptError",h.FRAG_PARSING_ERROR="fragParsingError",h.FRAG_GAP="fragGap",h.REMUX_ALLOC_ERROR="remuxAllocError",h.KEY_LOAD_ERROR="keyLoadError",h.KEY_LOAD_TIMEOUT="keyLoadTimeOut",h.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",h.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",h.BUFFER_APPEND_ERROR="bufferAppendError",h.BUFFER_APPENDING_ERROR="bufferAppendingError",h.BUFFER_STALLED_ERROR="bufferStalledError",h.BUFFER_FULL_ERROR="bufferFullError",h.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",h.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",h.INTERNAL_EXCEPTION="internalException",h.INTERNAL_ABORTED="aborted",h.UNKNOWN="unknown",h}({});const V=function(){},J={trace:V,debug:V,log:V,warn:V,info:V,error:V};let F=J;function G(h){const t=self.console[h];return t?t.bind(self.console,`[${h}] >`):V}function $(h,...t){t.forEach(function(n){F[n]=h[n]?h[n].bind(h):G(n)})}function H(h,t){if(typeof console=="object"&&h===!0||typeof h=="object"){$(h,"debug","log","info","warn","error");try{F.log(`Debug logs enabled for "${t}" in hls.js version 1.5.14`)}catch(n){F=J}}else F=J}const C=F,Q=/^(\d+)x(\d+)$/,ae=/(.+?)=(".*?"|.*?)(?:,|$)/g;class ue{constructor(t){typeof t=="string"&&(t=ue.parseAttrList(t)),se(this,t)}get clientAttrs(){return Object.keys(this).filter(t=>t.substring(0,2)==="X-")}decimalInteger(t){const n=parseInt(this[t],10);return n>Number.MAX_SAFE_INTEGER?Infinity:n}hexadecimalInteger(t){if(this[t]){let n=(this[t]||"0x").slice(2);n=(n.length&1?"0":"")+n;const a=new Uint8Array(n.length/2);for(let l=0;l<n.length/2;l++)a[l]=parseInt(n.slice(l*2,l*2+2),16);return a}else return null}hexadecimalIntegerAsNumber(t){const n=parseInt(this[t],16);return n>Number.MAX_SAFE_INTEGER?Infinity:n}decimalFloatingPoint(t){return parseFloat(this[t])}optionalFloat(t,n){const a=this[t];return a?parseFloat(a):n}enumeratedString(t){return this[t]}bool(t){return this[t]==="YES"}decimalResolution(t){const n=Q.exec(this[t]);if(n!==null)return{width:parseInt(n[1],10),height:parseInt(n[2],10)}}static parseAttrList(t){let n;const a={},l='"';for(ae.lastIndex=0;(n=ae.exec(t))!==null;){let u=n[2];u.indexOf(l)===0&&u.lastIndexOf(l)===u.length-1&&(u=u.slice(1,-1));const d=n[1].trim();a[d]=u}return a}}function j(h){return h!=="ID"&&h!=="CLASS"&&h!=="START-DATE"&&h!=="DURATION"&&h!=="END-DATE"&&h!=="END-ON-NEXT"}function X(h){return h==="SCTE35-OUT"||h==="SCTE35-IN"}class oe{constructor(t,n){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,n){const a=n.attr;for(const l in a)if(Object.prototype.hasOwnProperty.call(t,l)&&t[l]!==a[l]){C.warn(`DATERANGE tag attribute: "${l}" does not match for tags with ID: "${t.ID}"`),this._badValueForSameId=l;break}t=se(new ue({}),a,t)}if(this.attr=t,this._startDate=new Date(t["START-DATE"]),"END-DATE"in this.attr){const a=new Date(this.attr["END-DATE"]);te(a.getTime())&&(this._endDate=a)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const t=this.duration;return t!==null?new Date(this._startDate.getTime()+t*1e3):null}get duration(){if("DURATION"in this.attr){const t=this.attr.decimalFloatingPoint("DURATION");if(te(t))return t}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&te(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class ce{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var be={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class Be{constructor(t){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[be.AUDIO]:null,[be.VIDEO]:null,[be.AUDIOVIDEO]:null},this.baseurl=t}setByteRange(t,n){const a=t.split("@",2);let l;a.length===1?l=(n==null?void 0:n.byteRangeEndOffset)||0:l=parseInt(a[1]),this._byteRange=[l,parseInt(a[0])+l]}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=We.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(t){this._url=t}}class Ce extends Be{constructor(t,n){super(n);this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new ce,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=t}get decryptdata(){const{levelkeys:t}=this;if(!t&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const n=this.levelkeys.identity;if(n)this._decryptdata=n.getDecryptData(this.sn);else{const a=Object.keys(this.levelkeys);if(a.length===1)return this._decryptdata=this.levelkeys[a[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null||!te(this.programDateTime))return null;const t=te(this.duration)?this.duration:0;return this.programDateTime+t*1e3}get encrypted(){var t;if((t=this._decryptdata)!=null&&t.encrypted)return!0;if(this.levelkeys){const n=Object.keys(this.levelkeys),a=n.length;if(a>1||a===1&&this.levelkeys[n[0]].encrypted)return!0}return!1}setKeyFormat(t){if(this.levelkeys){const n=this.levelkeys[t];n&&!this._decryptdata&&(this._decryptdata=n.getDecryptData(this.sn))}}abortRequests(){var t,n;(t=this.loader)==null||t.abort(),(n=this.keyLoader)==null||n.abort()}setElementaryStreamInfo(t,n,a,l,u,d=!1){const{elementaryStreams:p}=this,g=p[t];if(!g){p[t]={startPTS:n,endPTS:a,startDTS:l,endDTS:u,partial:d};return}g.startPTS=Math.min(g.startPTS,n),g.endPTS=Math.max(g.endPTS,a),g.startDTS=Math.min(g.startDTS,l),g.endDTS=Math.max(g.endDTS,u)}clearElementaryStreamInfo(){const{elementaryStreams:t}=this;t[be.AUDIO]=null,t[be.VIDEO]=null,t[be.AUDIOVIDEO]=null}}class Le extends Be{constructor(t,n,a,l,u){super(a);this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new ce,this.duration=t.decimalFloatingPoint("DURATION"),this.gap=t.bool("GAP"),this.independent=t.bool("INDEPENDENT"),this.relurl=t.enumeratedString("URI"),this.fragment=n,this.index=l;const d=t.enumeratedString("BYTERANGE");d&&this.setByteRange(d,u),u&&(this.fragOffset=u.fragOffset+u.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:t}=this;return!!(t.audio||t.video||t.audiovideo)}}const Pe=10;class De{constructor(t){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=t}reloaded(t){if(!t){this.advanced=!0,this.updated=!0;return}const n=this.lastPartSn-t.lastPartSn,a=this.lastPartIndex-t.lastPartIndex;this.updated=this.endSN!==t.endSN||!!a||!!n||!this.live,this.advanced=this.endSN>t.endSN||n>0||n===0&&a>0,this.updated||this.advanced?this.misses=Math.floor(t.misses*.6):this.misses=t.misses+1,this.availabilityDelay=t.availabilityDelay}get hasProgramDateTime(){return this.fragments.length?te(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||Pe}get drift(){const t=this.driftEndTime-this.driftStartTime;return t>0?(this.driftEnd-this.driftStart)*1e3/t:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var t;return(t=this.partList)!=null&&t.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var t;return(t=this.fragments)!=null&&t.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var t;return(t=this.partList)!=null&&t.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var t;return(t=this.partList)!=null&&t.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function Ve(h){return Uint8Array.from(atob(h),t=>t.charCodeAt(0))}function Oe(h){const t=It(h).subarray(0,16),n=new Uint8Array(16);return n.set(t,16-t.length),n}function dt(h){const t=function(a,l,u){const d=a[l];a[l]=a[u],a[u]=d};t(h,0,3),t(h,1,2),t(h,4,5),t(h,6,7)}function Nt(h){const t=h.split(":");let n=null;if(t[0]==="data"&&t.length===2){const a=t[1].split(";"),l=a[a.length-1].split(",");if(l.length===2){const u=l[0]==="base64",d=l[1];u?(a.splice(-1,1),n=Ve(d)):n=Oe(d)}}return n}function It(h){return Uint8Array.from(unescape(encodeURIComponent(h)),t=>t.charCodeAt(0))}const gt=typeof self!="undefined"?self:void 0;var nt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Ht={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function Tt(h){switch(h){case Ht.FAIRPLAY:return nt.FAIRPLAY;case Ht.PLAYREADY:return nt.PLAYREADY;case Ht.WIDEVINE:return nt.WIDEVINE;case Ht.CLEARKEY:return nt.CLEARKEY}}var Gt={WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function hi(h){if(h===Gt.WIDEVINE)return nt.WIDEVINE}function ai(h){switch(h){case nt.FAIRPLAY:return Ht.FAIRPLAY;case nt.PLAYREADY:return Ht.PLAYREADY;case nt.WIDEVINE:return Ht.WIDEVINE;case nt.CLEARKEY:return Ht.CLEARKEY}}function Ei(h){const{drmSystems:t,widevineLicenseUrl:n}=h,a=t?[nt.FAIRPLAY,nt.WIDEVINE,nt.PLAYREADY,nt.CLEARKEY].filter(l=>!!t[l]):[];return!a[nt.WIDEVINE]&&n&&a.push(nt.WIDEVINE),a}const Ai=function(h){return gt!=null&&(h=gt.navigator)!=null&&h.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function Ct(h,t,n,a){let l;switch(h){case nt.FAIRPLAY:l=["cenc","sinf"];break;case nt.WIDEVINE:case nt.PLAYREADY:l=["cenc"];break;case nt.CLEARKEY:l=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${h}`)}return di(l,t,n,a)}function di(h,t,n,a){return[{initDataTypes:h,persistentState:a.persistentState||"optional",distinctiveIdentifier:a.distinctiveIdentifier||"optional",sessionTypes:a.sessionTypes||[a.sessionType||"temporary"],audioCapabilities:t.map(u=>({contentType:`audio/mp4; codecs="${u}"`,robustness:a.audioRobustness||"",encryptionScheme:a.audioEncryptionScheme||null})),videoCapabilities:n.map(u=>({contentType:`video/mp4; codecs="${u}"`,robustness:a.videoRobustness||"",encryptionScheme:a.videoEncryptionScheme||null}))}]}function ui(h,t,n){return Uint8Array.prototype.slice?h.slice(t,n):new Uint8Array(Array.prototype.slice.call(h,t,n))}const ji=(h,t)=>t+10<=h.length&&h[t]===73&&h[t+1]===68&&h[t+2]===51&&h[t+3]<255&&h[t+4]<255&&h[t+6]<128&&h[t+7]<128&&h[t+8]<128&&h[t+9]<128,un=(h,t)=>t+10<=h.length&&h[t]===51&&h[t+1]===68&&h[t+2]===73&&h[t+3]<255&&h[t+4]<255&&h[t+6]<128&&h[t+7]<128&&h[t+8]<128&&h[t+9]<128,$i=(h,t)=>{const n=t;let a=0;for(;ji(h,t);)a+=10,a+=wt(h,t+6),un(h,t+10)&&(a+=10),t+=a;if(a>0)return h.subarray(n,n+a)},wt=(h,t)=>{let n=0;return n=(h[t]&127)<<21,n|=(h[t+1]&127)<<14,n|=(h[t+2]&127)<<7,n|=h[t+3]&127,n},mn=(h,t)=>ji(h,t)&&wt(h,t+6)+10<=h.length-t,pi=h=>{const t=Vi(h);for(let n=0;n<t.length;n++){const a=t[n];if(ti(a))return Ms(a)}},ti=h=>h&&h.key==="PRIV"&&h.info==="com.apple.streaming.transportStreamTimestamp",_i=h=>{const t=String.fromCharCode(h[0],h[1],h[2],h[3]),n=wt(h,4),a=10;return{type:t,size:n,data:h.subarray(a,a+n)}},Vi=h=>{let t=0;const n=[];for(;ji(h,t);){const a=wt(h,t+6);t+=10;const l=t+a;for(;t+8<l;){const u=_i(h.subarray(t)),d=nr(u);d&&n.push(d),t+=u.size+10}un(h,t)&&(t+=10)}return n},nr=h=>h.type==="PRIV"?Bs(h):h.type[0]==="W"?nn(h):cs(h),Bs=h=>{if(h.size<2)return;const t=Ze(h.data,!0),n=new Uint8Array(h.data.subarray(t.length+1));return{key:h.type,info:t,data:n.buffer}},cs=h=>{if(h.size<2)return;if(h.type==="TXXX"){let n=1;const a=Ze(h.data.subarray(n),!0);n+=a.length+1;const l=Ze(h.data.subarray(n));return{key:h.type,info:a,data:l}}const t=Ze(h.data.subarray(1));return{key:h.type,data:t}},nn=h=>{if(h.type==="WXXX"){if(h.size<2)return;let n=1;const a=Ze(h.data.subarray(n),!0);n+=a.length+1;const l=Ze(h.data.subarray(n));return{key:h.type,info:a,data:l}}const t=Ze(h.data);return{key:h.type,data:t}},Ms=h=>{if(h.data.byteLength===8){const t=new Uint8Array(h.data),n=t[3]&1;let a=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return a/=45,n&&(a+=4772185884e-2),Math.round(a)}},Ze=(h,t=!1)=>{const n=rt();if(n){const v=n.decode(h);if(t){const b=v.indexOf("\0");return b!==-1?v.substring(0,b):v}return v.replace(/\0/g,"")}const a=h.length;let l,u,d,p="",g=0;for(;g<a;){if(l=h[g++],l===0&&t)return p;if(l===0||l===3)continue;switch(l>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:p+=String.fromCharCode(l);break;case 12:case 13:u=h[g++],p+=String.fromCharCode((l&31)<<6|u&63);break;case 14:u=h[g++],d=h[g++],p+=String.fromCharCode((l&15)<<12|(u&63)<<6|(d&63)<<0);break}}return p};let ke;function rt(){if(!navigator.userAgent.includes("PlayStation 4"))return!ke&&typeof self.TextDecoder!="undefined"&&(ke=new self.TextDecoder("utf-8")),ke}const Lt={hexDump:function(h){let t="";for(let n=0;n<h.length;n++){let a=h[n].toString(16);a.length<2&&(a="0"+a),t+=a}return t}},Yt=Math.pow(2,32)-1,Dt=[].push,ki={video:1,audio:2,id3:3,text:4};function mi(h){return String.fromCharCode.apply(null,h)}function Pn(h,t){const n=h[t]<<8|h[t+1];return n<0?65536+n:n}function Mt(h,t){const n=hs(h,t);return n<0?4294967296+n:n}function mr(h,t){let n=Mt(h,t);return n*=Math.pow(2,32),n+=Mt(h,t+4),n}function hs(h,t){return h[t]<<24|h[t+1]<<16|h[t+2]<<8|h[t+3]}function Ti(h,t,n){h[t]=n>>24,h[t+1]=n>>16&255,h[t+2]=n>>8&255,h[t+3]=n&255}function Lr(h){const t=h.byteLength;for(let n=0;n<t;){const a=Mt(h,n);if(a>8&&h[n+4]===109&&h[n+5]===111&&h[n+6]===111&&h[n+7]===102)return!0;n=a>1?n+a:t}return!1}function Jt(h,t){const n=[];if(!t.length)return n;const a=h.byteLength;for(let l=0;l<a;){const u=Mt(h,l),d=mi(h.subarray(l+4,l+8)),p=u>1?l+u:a;if(d===t[0])if(t.length===1)n.push(h.subarray(l+8,p));else{const g=Jt(h.subarray(l+8,p),t.slice(1));g.length&&Dt.apply(n,g)}l=p}return n}function rr(h){const t=[],n=h[0];let a=8;const l=Mt(h,a);a+=4;let u=0,d=0;n===0?(u=Mt(h,a),d=Mt(h,a+4),a+=8):(u=mr(h,a),d=mr(h,a+8),a+=16),a+=2;let p=h.length+d;const g=Pn(h,a);a+=2;for(let v=0;v<g;v++){let b=a;const L=Mt(h,b);b+=4;const B=L&2147483647;if((L&2147483648)>>>31===1)return C.warn("SIDX has hierarchical references (not supported)"),null;const K=Mt(h,b);b+=4,t.push({referenceSize:B,subsegmentDuration:K,info:{duration:K/l,start:p,end:p+B-1}}),p+=B,b+=4,a=b}return{earliestPresentationTime:u,timescale:l,version:n,referencesCount:g,references:t}}function Kr(h){const t=[],n=Jt(h,["moov","trak"]);for(let l=0;l<n.length;l++){const u=n[l],d=Jt(u,["tkhd"])[0];if(d){let p=d[0];const g=Mt(d,p===0?12:20),v=Jt(u,["mdia","mdhd"])[0];if(v){p=v[0];const b=Mt(v,p===0?12:20),L=Jt(u,["mdia","hdlr"])[0];if(L){const B=mi(L.subarray(8,12)),W={soun:be.AUDIO,vide:be.VIDEO}[B];if(W){const K=Jt(u,["mdia","minf","stbl","stsd"])[0],ee=ca(K);t[g]={timescale:b,type:W},t[W]=ze({timescale:b,id:g},ee)}}}}}return Jt(h,["moov","mvex","trex"]).forEach(l=>{const u=Mt(l,4),d=t[u];d&&(d.default={duration:Mt(l,12),flags:Mt(l,20)})}),t}function ca(h){const t=h.subarray(8),n=t.subarray(8+78),a=mi(t.subarray(4,8));let l=a;const u=a==="enca"||a==="encv";if(u){const p=Jt(t,[a])[0].subarray(a==="enca"?28:78);Jt(p,["sinf"]).forEach(v=>{const b=Jt(v,["schm"])[0];if(b){const L=mi(b.subarray(4,8));if(L==="cbcs"||L==="cenc"){const B=Jt(v,["frma"])[0];B&&(l=mi(B))}}})}switch(l){case"avc1":case"avc2":case"avc3":case"avc4":{const d=Jt(n,["avcC"])[0];l+="."+Yi(d[1])+Yi(d[2])+Yi(d[3]);break}case"mp4a":{const d=Jt(t,[a])[0],p=Jt(d.subarray(28),["esds"])[0];if(p&&p.length>12){let g=4;if(p[g++]!==3)break;g=Dr(p,g),g+=2;const v=p[g++];if(v&128&&(g+=2),v&64&&(g+=p[g++]),p[g++]!==4)break;g=Dr(p,g);const b=p[g++];if(b===64)l+="."+Yi(b);else break;if(g+=12,p[g++]!==5)break;g=Dr(p,g);const L=p[g++];let B=(L&248)>>3;B===31&&(B+=1+((L&7)<<3)+((p[g]&224)>>5)),l+="."+B}break}case"hvc1":case"hev1":{const d=Jt(n,["hvcC"])[0],p=d[1],g=["","A","B","C"][p>>6],v=p&31,b=Mt(d,2),L=(p&32)>>5?"H":"L",B=d[12],W=d.subarray(6,12);l+="."+g+v,l+="."+b.toString(16).toUpperCase(),l+="."+L+B;let K="";for(let ee=W.length;ee--;){const re=W[ee];if(re||K){const xe=re.toString(16).toUpperCase();K="."+xe+K}}l+=K;break}case"dvh1":case"dvhe":{const d=Jt(n,["dvcC"])[0],p=d[2]>>1&127,g=d[2]<<5&32|d[3]>>3&31;l+="."+dn(p)+"."+dn(g);break}case"vp09":{const d=Jt(n,["vpcC"])[0],p=d[4],g=d[5],v=d[6]>>4&15;l+="."+dn(p)+"."+dn(g)+"."+dn(v);break}case"av01":{const d=Jt(n,["av1C"])[0],p=d[1]>>>5,g=d[1]&31,v=d[2]>>>7?"H":"M",b=(d[2]&64)>>6,L=(d[2]&32)>>5,B=p===2&&b?L?12:10:b?10:8,W=(d[2]&16)>>4,K=(d[2]&8)>>3,ee=(d[2]&4)>>2,re=d[2]&3,xe=1,Fe=1,Me=1,it=0;l+="."+p+"."+dn(g)+v+"."+dn(B)+"."+W+"."+K+ee+re+"."+dn(xe)+"."+dn(Fe)+"."+dn(Me)+"."+it;break}}return{codec:l,encrypted:u}}function Dr(h,t){const n=t+5;for(;h[t++]&128&&t<n;);return t}function Yi(h){return("0"+h.toString(16).toUpperCase()).slice(-2)}function dn(h){return(h<10?"0":"")+h}function Fs(h,t){if(!h||!t)return h;const n=t.keyId;return n&&t.isCommonEncryption&&Jt(h,["moov","trak"]).forEach(l=>{const d=Jt(l,["mdia","minf","stbl","stsd"])[0].subarray(8);let p=Jt(d,["enca"]);const g=p.length>0;g||(p=Jt(d,["encv"])),p.forEach(v=>{const b=g?v.subarray(28):v.subarray(78);Jt(b,["sinf"]).forEach(B=>{const W=Yr(B);if(W){const K=W.subarray(8,24);K.some(ee=>ee!==0)||(C.log(`[eme] Patching keyId in 'enc${g?"a":"v"}>sinf>>tenc' box: ${Lt.hexDump(K)} -> ${Lt.hexDump(n)}`),W.set(n,8))}})})}),h}function Yr(h){const t=Jt(h,["schm"])[0];if(t){const n=mi(t.subarray(4,8));if(n==="cbcs"||n==="cenc")return Jt(h,["schi","tenc"])[0]}return C.error("[eme] missing 'schm' box"),null}function ko(h,t){return Jt(t,["moof","traf"]).reduce((n,a)=>{const l=Jt(a,["tfdt"])[0],u=l[0],d=Jt(a,["tfhd"]).reduce((p,g)=>{const v=Mt(g,4),b=h[v];if(b){let L=Mt(l,4);if(u===1){if(L===Yt)return C.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),p;L*=Yt+1,L+=Mt(l,8)}const B=b.timescale||9e4,W=L/B;if(te(W)&&(p===null||W<p))return W}return p},null);return d!==null&&te(d)&&(n===null||d<n)?d:n},null)}function ie(h,t){let n=0,a=0,l=0;const u=Jt(h,["moof","traf"]);for(let d=0;d<u.length;d++){const p=u[d],g=Jt(p,["tfhd"])[0],v=Mt(g,4),b=t[v];if(!b)continue;const L=b.default,B=Mt(g,0)|(L==null?void 0:L.flags);let W=L==null?void 0:L.duration;B&8&&(B&2?W=Mt(g,12):W=Mt(g,8));const K=b.timescale||9e4,ee=Jt(p,["trun"]);for(let re=0;re<ee.length;re++){if(n=le(ee[re]),!n&&W){const xe=Mt(ee[re],4);n=W*xe}b.type===be.VIDEO?a+=n/K:b.type===be.AUDIO&&(l+=n/K)}}if(a===0&&l===0){let d=Infinity,p=0,g=0;const v=Jt(h,["sidx"]);for(let b=0;b<v.length;b++){const L=rr(v[b]);if(L!=null&&L.references){d=Math.min(d,L.earliestPresentationTime/L.timescale);const B=L.references.reduce((W,K)=>W+K.info.duration||0,0);p=Math.max(p,B+L.earliestPresentationTime/L.timescale),g=p-d}}if(g&&te(g))return g}return a||l}function le(h){const t=Mt(h,0);let n=8;t&1&&(n+=4),t&4&&(n+=4);let a=0;const l=Mt(h,4);for(let u=0;u<l;u++)t&256&&(a+=Mt(h,n),n+=4),t&512&&(n+=4),t&1024&&(n+=4),t&2048&&(n+=4);return a}function Se(h,t,n){Jt(t,["moof","traf"]).forEach(a=>{Jt(a,["tfhd"]).forEach(l=>{const u=Mt(l,4),d=h[u];if(!d)return;const p=d.timescale||9e4;Jt(a,["tfdt"]).forEach(g=>{const v=g[0],b=n*p;if(b){let L=Mt(g,4);if(v===0)L-=b,L=Math.max(L,0),Ti(g,4,L);else{L*=Math.pow(2,32),L+=Mt(g,8),L-=b,L=Math.max(L,0);const B=Math.floor(L/(Yt+1)),W=Math.floor(L%(Yt+1));Ti(g,4,B),Ti(g,8,W)}}})})})}function Xe(h){const t={valid:null,remainder:null},n=Jt(h,["moof"]);if(n.length<2)return t.remainder=h,t;const a=n[n.length-1];return t.valid=ui(h,0,a.byteOffset-8),t.remainder=ui(h,a.byteOffset-8),t}function ft(h,t){const n=new Uint8Array(h.length+t.length);return n.set(h),n.set(t,h.length),n}function jt(h,t){const n=[],a=t.samples,l=t.timescale,u=t.id;let d=!1;return Jt(a,["moof"]).map(g=>{const v=g.byteOffset-8;Jt(g,["traf"]).map(L=>{const B=Jt(L,["tfdt"]).map(W=>{const K=W[0];let ee=Mt(W,4);return K===1&&(ee*=Math.pow(2,32),ee+=Mt(W,8)),ee/l})[0];return B!==void 0&&(h=B),Jt(L,["tfhd"]).map(W=>{const K=Mt(W,4),ee=Mt(W,0)&16777215,re=(ee&1)!=0,xe=(ee&2)!=0,Fe=(ee&8)!=0;let Me=0;const it=(ee&16)!=0;let $e=0;const ut=(ee&32)!=0;let Qe=8;K===u&&(re&&(Qe+=8),xe&&(Qe+=4),Fe&&(Me=Mt(W,Qe),Qe+=4),it&&($e=Mt(W,Qe),Qe+=4),ut&&(Qe+=4),t.type==="video"&&(d=bi(t.codec)),Jt(L,["trun"]).map(yt=>{const xt=yt[0],ot=Mt(yt,0)&16777215,At=(ot&1)!=0;let Re=0;const Pt=(ot&4)!=0,ii=(ot&256)!=0;let ri=0;const Qt=(ot&512)!=0;let gi=0;const li=(ot&1024)!=0,Ft=(ot&2048)!=0;let St=0;const $t=Mt(yt,4);let zt=8;At&&(Re=Mt(yt,zt),zt+=4),Pt&&(zt+=4);let wi=Re+v;for(let Li=0;Li<$t;Li++){if(ii?(ri=Mt(yt,zt),zt+=4):ri=Me,Qt?(gi=Mt(yt,zt),zt+=4):gi=$e,li&&(zt+=4),Ft&&(xt===0?St=Mt(yt,zt):St=hs(yt,zt),zt+=4),t.type===be.VIDEO){let Pi=0;for(;Pi<gi;){const vn=Mt(a,wi);if(wi+=4,Di(d,a[wi])){const xn=a.subarray(wi,wi+vn);cn(xn,d?2:1,h+St/l,n)}wi+=vn,Pi+=vn+4}}h+=ri/l}}))})})}),n}function bi(h){if(!h)return!1;const t=h.indexOf("."),n=t<0?h:h.substring(0,t);return n==="hvc1"||n==="hev1"||n==="dvh1"||n==="dvhe"}function Di(h,t){if(h){const n=t>>1&63;return n===39||n===40}else return(t&31)===6}function cn(h,t,n,a){const l=hn(h);let u=0;u+=t;let d=0,p=0,g=0;for(;u<l.length;){d=0;do{if(u>=l.length)break;g=l[u++],d+=g}while(g===255);p=0;do{if(u>=l.length)break;g=l[u++],p+=g}while(g===255);const v=l.length-u;let b=u;if(p<v)u+=p;else if(p>v){C.error(`Malformed SEI payload. ${p} is too small, only ${v} bytes left to parse.`);break}if(d===4){if(l[b++]===181){const B=Pn(l,b);if(b+=2,B===49){const W=Mt(l,b);if(b+=4,W===1195456820){const K=l[b++];if(K===3){const ee=l[b++],re=31&ee,xe=64&ee,Fe=xe?2+re*3:0,Me=new Uint8Array(Fe);if(xe){Me[0]=ee;for(let it=1;it<Fe;it++)Me[it]=l[b++]}a.push({type:K,payloadType:d,pts:n,bytes:Me})}}}}}else if(d===5&&p>16){const L=[];for(let K=0;K<16;K++){const ee=l[b++].toString(16);L.push(ee.length==1?"0"+ee:ee),(K===3||K===5||K===7||K===9)&&L.push("-")}const B=p-16,W=new Uint8Array(B);for(let K=0;K<B;K++)W[K]=l[b++];a.push({payloadType:d,pts:n,uuid:L.join(""),userData:Ze(W),userDataBytes:W})}}}function hn(h){const t=h.byteLength,n=[];let a=1;for(;a<t-2;)h[a]===0&&h[a+1]===0&&h[a+2]===3?(n.push(a+2),a+=2):a++;if(n.length===0)return h;const l=t-n.length,u=new Uint8Array(l);let d=0;for(a=0;a<l;d++,a++)d===n[0]&&(d++,n.shift()),u[a]=h[d];return u}function Wn(h){const t=h[0];let n="",a="",l=0,u=0,d=0,p=0,g=0,v=0;if(t===0){for(;mi(h.subarray(v,v+1))!=="\0";)n+=mi(h.subarray(v,v+1)),v+=1;for(n+=mi(h.subarray(v,v+1)),v+=1;mi(h.subarray(v,v+1))!=="\0";)a+=mi(h.subarray(v,v+1)),v+=1;a+=mi(h.subarray(v,v+1)),v+=1,l=Mt(h,12),u=Mt(h,16),p=Mt(h,20),g=Mt(h,24),v=28}else if(t===1){v+=4,l=Mt(h,v),v+=4;const L=Mt(h,v);v+=4;const B=Mt(h,v);for(v+=4,d=x0(2,32)*L+B,Y(d)||(d=Number.MAX_SAFE_INTEGER,C.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),p=Mt(h,v),v+=4,g=Mt(h,v),v+=4;mi(h.subarray(v,v+1))!=="\0";)n+=mi(h.subarray(v,v+1)),v+=1;for(n+=mi(h.subarray(v,v+1)),v+=1;mi(h.subarray(v,v+1))!=="\0";)a+=mi(h.subarray(v,v+1)),v+=1;a+=mi(h.subarray(v,v+1)),v+=1}const b=h.subarray(v,h.byteLength);return{schemeIdUri:n,value:a,timeScale:l,presentationTime:d,presentationTimeDelta:u,eventDuration:p,id:g,payload:b}}function sr(h,...t){const n=t.length;let a=8,l=n;for(;l--;)a+=t[l].byteLength;const u=new Uint8Array(a);for(u[0]=a>>24&255,u[1]=a>>16&255,u[2]=a>>8&255,u[3]=a&255,u.set(h,4),l=0,a=8;l<n;l++)u.set(t[l],a),a+=t[l].byteLength;return u}function On(h,t,n){if(h.byteLength!==16)throw new RangeError("Invalid system id");let a,l;if(t){a=1,l=new Uint8Array(t.length*16);for(let p=0;p<t.length;p++){const g=t[p];if(g.byteLength!==16)throw new RangeError("Invalid key");l.set(g,p*16)}}else a=0,l=new Uint8Array;let u;a>0?(u=new Uint8Array(4),t.length>0&&new DataView(u.buffer).setUint32(0,t.length,!1)):u=new Uint8Array;const d=new Uint8Array(4);return n&&n.byteLength>0&&new DataView(d.buffer).setUint32(0,n.byteLength,!1),sr([112,115,115,104],new Uint8Array([a,0,0,0]),h,u,l,d,n||new Uint8Array)}function Fn(h){if(!(h instanceof ArrayBuffer)||h.byteLength<32)return null;const t={version:0,systemId:"",kids:null,data:null},n=new DataView(h),a=n.getUint32(0);if(h.byteLength!==a&&a>44||n.getUint32(4)!==1886614376||(t.version=n.getUint32(8)>>>24,t.version>1))return null;t.systemId=Lt.hexDump(new Uint8Array(h,12,16));const u=n.getUint32(28);if(t.version===0){if(a-32<u)return null;t.data=new Uint8Array(h,32,u)}else if(t.version===1){t.kids=[];for(let d=0;d<u;d++)t.kids.push(new Uint8Array(h,32+d*16,16))}return t}let An={};class Xi{static clearKeyUriToKeyIdMap(){An={}}constructor(t,n,a,l=[1],u=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=t,this.uri=n,this.keyFormat=a,this.keyFormatVersions=l,this.iv=u,this.encrypted=t?t!=="NONE":!1,this.isCommonEncryption=this.encrypted&&t!=="AES-128"}isSupported(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Ht.FAIRPLAY:case Ht.WIDEVINE:case Ht.PLAYREADY:case Ht.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(t){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof t!="number"&&(this.method==="AES-128"&&!this.iv&&C.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),t=0);const a=Nn(t);return new Xi(this.method,this.uri,"identity",this.keyFormatVersions,a)}const n=Nt(this.uri);if(n)switch(this.keyFormat){case Ht.WIDEVINE:this.pssh=n,n.length>=22&&(this.keyId=n.subarray(n.length-22,n.length-6));break;case Ht.PLAYREADY:{const a=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=On(a,null,n);const l=new Uint16Array(n.buffer,n.byteOffset,n.byteLength/2),u=String.fromCharCode.apply(null,Array.from(l)),d=u.substring(u.indexOf("<"),u.length),v=new DOMParser().parseFromString(d,"text/xml").getElementsByTagName("KID")[0];if(v){const b=v.childNodes[0]?v.childNodes[0].nodeValue:v.getAttribute("VALUE");if(b){const L=Ve(b).subarray(0,16);dt(L),this.keyId=L}}break}default:{let a=n.subarray(0,16);if(a.length!==16){const l=new Uint8Array(16);l.set(a,16-a.length),a=l}this.keyId=a;break}}if(!this.keyId||this.keyId.byteLength!==16){let a=An[this.uri];if(!a){const l=Object.keys(An).length%Number.MAX_SAFE_INTEGER;a=new Uint8Array(16),new DataView(a.buffer,12,4).setUint32(0,l),An[this.uri]=a}this.keyId=a}return this}}function Nn(h){const t=new Uint8Array(16);for(let n=12;n<16;n++)t[n]=h>>8*(15-n)&255;return t}const gr=/\{\$([a-zA-Z0-9-_]+)\}/g;function kr(h){return gr.test(h)}function xi(h,t,n){if(h.variableList!==null||h.hasVariableRefs)for(let a=n.length;a--;){const l=n[a],u=t[l];u&&(t[l]=Ir(h,u))}}function Ir(h,t){if(h.variableList!==null||h.hasVariableRefs){const n=h.variableList;return t.replace(gr,a=>{const l=a.substring(2,a.length-1),u=n==null?void 0:n[l];return u===void 0?(h.playlistParsingError||(h.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${l}"`)),a):u})}return t}function Ga(h,t,n){let a=h.variableList;a||(h.variableList=a={});let l,u;if("QUERYPARAM"in t){l=t.QUERYPARAM;try{const d=new self.URL(n).searchParams;if(d.has(l))u=d.get(l);else throw new Error(`"${l}" does not match any query parameter in URI: "${n}"`)}catch(d){h.playlistParsingError||(h.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${d.message}`))}}else l=t.NAME,u=t.VALUE;l in a?h.playlistParsingError||(h.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${l}"`)):a[l]=u||""}function Io(h,t,n){const a=t.IMPORT;if(n&&a in n){let l=h.variableList;l||(h.variableList=l={}),l[a]=n[a]}else h.playlistParsingError||(h.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${a}"`))}function ar(h=!0){return typeof self=="undefined"?void 0:(h||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function Il(h){return typeof self!="undefined"&&h===self.ManagedMediaSource}const Ns={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function Ro(h,t){const n=Ns[t];return!!n&&!!n[h.slice(0,4)]}function ha(h,t,n=!0){return!h.split(",").some(a=>!Po(a,t,n))}function Po(h,t,n=!0){var a;const l=ar(n);return(a=l==null?void 0:l.isTypeSupported(Rr(h,t)))!=null?a:!1}function Rr(h,t){return`${t}/mp4;codecs="${h}"`}function fa(h){if(h){const t=h.substring(0,4);return Ns.video[t]}return 2}function Us(h){return h.split(",").reduce((t,n)=>{const a=Ns.video[n];return a?(a*2+t)/(t?3:2):(Ns.audio[n]+t)/(t?2:1)},0)}const js={};function fs(h,t=!0){if(js[h])return js[h];const n={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"]}[h];for(let a=0;a<n.length;a++)if(Po(n[a],"audio",t))return js[h]=n[a],n[a];return h}const pa=/flac|opus/i;function ps(h,t=!0){return h.replace(pa,n=>fs(n.toLowerCase(),t))}function qa(h,t){return h&&h!=="mp4a"?h:t&&t.split(",")[0]}function za(h){const t=h.split(",");for(let n=0;n<t.length;n++){const a=t[n].split(".");if(a.length>2){let l=a.shift()+".";l+=parseInt(a.shift()).toString(16),l+=("000"+parseInt(a.shift()).toString(16)).slice(-4),t[n]=l}}return t.join(",")}const ms=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Ii=/#EXT-X-MEDIA:(.*)/g,Un=/^#EXT(?:INF|-X-TARGETDURATION):/m,$s=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),yr=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class Tn{static findGroup(t,n){for(let a=0;a<t.length;a++){const l=t[a];if(l.id===n)return l}}static resolve(t,n){return We.buildAbsoluteURL(n,t,{alwaysNormalize:!0})}static isMediaPlaylist(t){return Un.test(t)}static parseMasterPlaylist(t,n){const a=kr(t),l={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:a},u=[];ms.lastIndex=0;let d;for(;(d=ms.exec(t))!=null;)if(d[1]){var p;const v=new ue(d[1]);xi(l,v,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const b=Ir(l,d[2]),L={attrs:v,bitrate:v.decimalInteger("BANDWIDTH")||v.decimalInteger("AVERAGE-BANDWIDTH"),name:v.NAME,url:Tn.resolve(b,n)},B=v.decimalResolution("RESOLUTION");B&&(L.width=B.width,L.height=B.height),Rl(v.CODECS,L),(p=L.unknownCodecs)!=null&&p.length||u.push(L),l.levels.push(L)}else if(d[3]){const v=d[3],b=d[4];switch(v){case"SESSION-DATA":{const L=new ue(b);xi(l,L,["DATA-ID","LANGUAGE","VALUE","URI"]);const B=L["DATA-ID"];B&&(l.sessionData===null&&(l.sessionData={}),l.sessionData[B]=L);break}case"SESSION-KEY":{const L=ma(b,n,l);L.encrypted&&L.isSupported()?(l.sessionKeys===null&&(l.sessionKeys=[]),l.sessionKeys.push(L)):C.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${b}"`);break}case"DEFINE":{{const L=new ue(b);xi(l,L,["NAME","VALUE","QUERYPARAM"]),Ga(l,L,n)}break}case"CONTENT-STEERING":{const L=new ue(b);xi(l,L,["SERVER-URI","PATHWAY-ID"]),l.contentSteering={uri:Tn.resolve(L["SERVER-URI"],n),pathwayId:L["PATHWAY-ID"]||"."};break}case"START":{l.startTimeOffset=Hi(b);break}}}const g=u.length>0&&u.length<l.levels.length;return l.levels=g?u:l.levels,l.levels.length===0&&(l.playlistParsingError=new Error("no levels found in manifest")),l}static parseMasterPlaylistMedia(t,n,a){let l;const u={},d=a.levels,p={AUDIO:d.map(v=>({id:v.attrs.AUDIO,audioCodec:v.audioCodec})),SUBTITLES:d.map(v=>({id:v.attrs.SUBTITLES,textCodec:v.textCodec})),"CLOSED-CAPTIONS":[]};let g=0;for(Ii.lastIndex=0;(l=Ii.exec(t))!==null;){const v=new ue(l[1]),b=v.TYPE;if(b){const L=p[b],B=u[b]||[];u[b]=B,xi(a,v,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const W=v.LANGUAGE,K=v["ASSOC-LANGUAGE"],ee=v.CHANNELS,re=v.CHARACTERISTICS,xe=v["INSTREAM-ID"],Fe={attrs:v,bitrate:0,id:g++,groupId:v["GROUP-ID"]||"",name:v.NAME||W||"",type:b,default:v.bool("DEFAULT"),autoselect:v.bool("AUTOSELECT"),forced:v.bool("FORCED"),lang:W,url:v.URI?Tn.resolve(v.URI,n):""};if(K&&(Fe.assocLang=K),ee&&(Fe.channels=ee),re&&(Fe.characteristics=re),xe&&(Fe.instreamId=xe),L!=null&&L.length){const Me=Tn.findGroup(L,Fe.groupId)||L[0];gs(Fe,Me,"audioCodec"),gs(Fe,Me,"textCodec")}B.push(Fe)}}return u}static parseLevelPlaylist(t,n,a,l,u,d){const p=new De(n),g=p.fragments;let v=null,b=0,L=0,B=0,W=0,K=null,ee=new Ce(l,n),re,xe,Fe,Me=-1,it=!1,$e=null;for($s.lastIndex=0,p.m3u8=t,p.hasVariableRefs=kr(t);(re=$s.exec(t))!==null;){it&&(it=!1,ee=new Ce(l,n),ee.start=B,ee.sn=b,ee.cc=W,ee.level=a,v&&(ee.initSegment=v,ee.rawProgramDateTime=v.rawProgramDateTime,v.rawProgramDateTime=null,$e&&(ee.setByteRange($e),$e=null)));const xt=re[1];if(xt){ee.duration=parseFloat(xt);const ot=(" "+re[2]).slice(1);ee.title=ot||null,ee.tagList.push(ot?["INF",xt,ot]:["INF",xt])}else if(re[3]){if(te(ee.duration)){ee.start=B,Fe&&Wa(ee,Fe,p),ee.sn=b,ee.level=a,ee.cc=W,g.push(ee);const ot=(" "+re[3]).slice(1);ee.relurl=Ir(p,ot),Oo(ee,K),K=ee,B+=ee.duration,b++,L=0,it=!0}}else if(re[4]){const ot=(" "+re[4]).slice(1);K?ee.setByteRange(ot,K):ee.setByteRange(ot)}else if(re[5])ee.rawProgramDateTime=(" "+re[5]).slice(1),ee.tagList.push(["PROGRAM-DATE-TIME",ee.rawProgramDateTime]),Me===-1&&(Me=g.length);else{if(re=re[0].match(yr),!re){C.warn("No matches on slow regex match for level playlist!");continue}for(xe=1;xe<re.length&&typeof re[xe]=="undefined";xe++);const ot=(" "+re[xe]).slice(1),At=(" "+re[xe+1]).slice(1),Re=re[xe+2]?(" "+re[xe+2]).slice(1):"";switch(ot){case"PLAYLIST-TYPE":p.type=At.toUpperCase();break;case"MEDIA-SEQUENCE":b=p.startSN=parseInt(At);break;case"SKIP":{const Pt=new ue(At);xi(p,Pt,["RECENTLY-REMOVED-DATERANGES"]);const ii=Pt.decimalInteger("SKIPPED-SEGMENTS");if(te(ii)){p.skippedSegments=ii;for(let Qt=ii;Qt--;)g.unshift(null);b+=ii}const ri=Pt.enumeratedString("RECENTLY-REMOVED-DATERANGES");ri&&(p.recentlyRemovedDateranges=ri.split("	"));break}case"TARGETDURATION":p.targetduration=Math.max(parseInt(At),1);break;case"VERSION":p.version=parseInt(At);break;case"INDEPENDENT-SEGMENTS":case"EXTM3U":break;case"ENDLIST":p.live=!1;break;case"#":(At||Re)&&ee.tagList.push(Re?[At,Re]:[At]);break;case"DISCONTINUITY":W++,ee.tagList.push(["DIS"]);break;case"GAP":ee.gap=!0,ee.tagList.push([ot]);break;case"BITRATE":ee.tagList.push([ot,At]);break;case"DATERANGE":{const Pt=new ue(At);xi(p,Pt,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),xi(p,Pt,Pt.clientAttrs);const ii=new oe(Pt,p.dateRanges[Pt.ID]);ii.isValid||p.skippedSegments?p.dateRanges[ii.id]=ii:C.warn(`Ignoring invalid DATERANGE tag: "${At}"`),ee.tagList.push(["EXT-X-DATERANGE",At]);break}case"DEFINE":{{const Pt=new ue(At);xi(p,Pt,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in Pt?Io(p,Pt,d):Ga(p,Pt,n)}break}case"DISCONTINUITY-SEQUENCE":W=parseInt(At);break;case"KEY":{const Pt=ma(At,n,p);if(Pt.isSupported()){if(Pt.method==="NONE"){Fe=void 0;break}Fe||(Fe={}),Fe[Pt.keyFormat]&&(Fe=se({},Fe)),Fe[Pt.keyFormat]=Pt}else C.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${At}"`);break}case"START":p.startTimeOffset=Hi(At);break;case"MAP":{const Pt=new ue(At);if(xi(p,Pt,["BYTERANGE","URI"]),ee.duration){const ii=new Ce(l,n);Qi(ii,Pt,a,Fe),v=ii,ee.initSegment=v,v.rawProgramDateTime&&!ee.rawProgramDateTime&&(ee.rawProgramDateTime=v.rawProgramDateTime)}else{const ii=ee.byteRangeEndOffset;if(ii){const ri=ee.byteRangeStartOffset;$e=`${ii-ri}@${ri}`}else $e=null;Qi(ee,Pt,a,Fe),v=ee,it=!0}break}case"SERVER-CONTROL":{const Pt=new ue(At);p.canBlockReload=Pt.bool("CAN-BLOCK-RELOAD"),p.canSkipUntil=Pt.optionalFloat("CAN-SKIP-UNTIL",0),p.canSkipDateRanges=p.canSkipUntil>0&&Pt.bool("CAN-SKIP-DATERANGES"),p.partHoldBack=Pt.optionalFloat("PART-HOLD-BACK",0),p.holdBack=Pt.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const Pt=new ue(At);p.partTarget=Pt.decimalFloatingPoint("PART-TARGET");break}case"PART":{let Pt=p.partList;Pt||(Pt=p.partList=[]);const ii=L>0?Pt[Pt.length-1]:void 0,ri=L++,Qt=new ue(At);xi(p,Qt,["BYTERANGE","URI"]);const gi=new Le(Qt,ee,n,ri,ii);Pt.push(gi),ee.duration+=gi.duration;break}case"PRELOAD-HINT":{const Pt=new ue(At);xi(p,Pt,["URI"]),p.preloadHint=Pt;break}case"RENDITION-REPORT":{const Pt=new ue(At);xi(p,Pt,["URI"]),p.renditionReports=p.renditionReports||[],p.renditionReports.push(Pt);break}default:C.warn(`line parsed but not handled: ${re}`);break}}}K&&!K.relurl?(g.pop(),B-=K.duration,p.partList&&(p.fragmentHint=K)):p.partList&&(Oo(ee,K),ee.cc=W,p.fragmentHint=ee,Fe&&Wa(ee,Fe,p));const ut=g.length,Qe=g[0],yt=g[ut-1];if(B+=p.skippedSegments*p.targetduration,B>0&&ut&&yt){p.averagetargetduration=B/ut;const xt=yt.sn;p.endSN=xt!=="initSegment"?xt:0,p.live||(yt.endList=!0),Qe&&(p.startCC=Qe.cc)}else p.endSN=0,p.startCC=0;return p.fragmentHint&&(B+=p.fragmentHint.duration),p.totalduration=B,p.endCC=W,Me>0&&Vs(g,Me),p}}function ma(h,t,n){var a,l;const u=new ue(h);xi(n,u,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const d=(a=u.METHOD)!=null?a:"",p=u.URI,g=u.hexadecimalInteger("IV"),v=u.KEYFORMATVERSIONS,b=(l=u.KEYFORMAT)!=null?l:"identity";p&&u.IV&&!g&&C.error(`Invalid IV: ${u.IV}`);const L=p?Tn.resolve(p,t):"",B=(v||"1").split("/").map(Number).filter(Number.isFinite);return new Xi(d,L,b,B,g)}function Hi(h){const n=new ue(h).decimalFloatingPoint("TIME-OFFSET");return te(n)?n:null}function Rl(h,t){let n=(h||"").split(/[ ,]+/).filter(a=>a);["video","audio","text"].forEach(a=>{const l=n.filter(u=>Ro(u,a));l.length&&(t[`${a}Codec`]=l.join(","),n=n.filter(u=>l.indexOf(u)===-1))}),t.unknownCodecs=n}function gs(h,t,n){const a=t[n];a&&(h[n]=a)}function Vs(h,t){let n=h[t];for(let a=t;a--;){const l=h[a];if(!l)return;l.programDateTime=n.programDateTime-l.duration*1e3,n=l}}function Oo(h,t){h.rawProgramDateTime?h.programDateTime=Date.parse(h.rawProgramDateTime):t!=null&&t.programDateTime&&(h.programDateTime=t.endProgramDateTime),te(h.programDateTime)||(h.programDateTime=null,h.rawProgramDateTime=null)}function Qi(h,t,n,a){h.relurl=t.URI,t.BYTERANGE&&h.setByteRange(t.BYTERANGE),h.level=n,h.sn="initSegment",a&&(h.levelkeys=a),h.initSegment=null}function Wa(h,t,n){h.levelkeys=t;const{encryptedFragments:a}=n;(!a.length||a[a.length-1].levelkeys!==t)&&Object.keys(t).some(l=>t[l].isCommonEncryption)&&a.push(h)}var fi={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},qt={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function Bo(h){const{type:t}=h;switch(t){case fi.AUDIO_TRACK:return qt.AUDIO;case fi.SUBTITLE_TRACK:return qt.SUBTITLE;default:return qt.MAIN}}function Hs(h,t){let n=h.url;return(n===void 0||n.indexOf("data:")===0)&&(n=t.url),n}class ys{constructor(t){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=t,this.registerListeners()}startLoad(t){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:t}=this;t.on(A.MANIFEST_LOADING,this.onManifestLoading,this),t.on(A.LEVEL_LOADING,this.onLevelLoading,this),t.on(A.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.on(A.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:t}=this;t.off(A.MANIFEST_LOADING,this.onManifestLoading,this),t.off(A.LEVEL_LOADING,this.onLevelLoading,this),t.off(A.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.off(A.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(t){const n=this.hls.config,a=n.pLoader,l=n.loader,u=a||l,d=new u(n);return this.loaders[t.type]=d,d}getInternalLoader(t){return this.loaders[t.type]}resetInternalLoader(t){this.loaders[t]&&delete this.loaders[t]}destroyInternalLoaders(){for(const t in this.loaders){const n=this.loaders[t];n&&n.destroy(),this.resetInternalLoader(t)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(t,n){const{url:a}=n;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:fi.MANIFEST,url:a,deliveryDirectives:null})}onLevelLoading(t,n){const{id:a,level:l,pathwayId:u,url:d,deliveryDirectives:p}=n;this.load({id:a,level:l,pathwayId:u,responseType:"text",type:fi.LEVEL,url:d,deliveryDirectives:p})}onAudioTrackLoading(t,n){const{id:a,groupId:l,url:u,deliveryDirectives:d}=n;this.load({id:a,groupId:l,level:null,responseType:"text",type:fi.AUDIO_TRACK,url:u,deliveryDirectives:d})}onSubtitleTrackLoading(t,n){const{id:a,groupId:l,url:u,deliveryDirectives:d}=n;this.load({id:a,groupId:l,level:null,responseType:"text",type:fi.SUBTITLE_TRACK,url:u,deliveryDirectives:d})}load(t){var n;const a=this.hls.config;let l=this.getInternalLoader(t);if(l){const v=l.context;if(v&&v.url===t.url&&v.level===t.level){C.trace("[playlist-loader]: playlist request ongoing");return}C.log(`[playlist-loader]: aborting previous loader for type: ${t.type}`),l.abort()}let u;if(t.type===fi.MANIFEST?u=a.manifestLoadPolicy.default:u=se({},a.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),l=this.createInternalLoader(t),te((n=t.deliveryDirectives)==null?void 0:n.part)){let v;if(t.type===fi.LEVEL&&t.level!==null?v=this.hls.levels[t.level].details:t.type===fi.AUDIO_TRACK&&t.id!==null?v=this.hls.audioTracks[t.id].details:t.type===fi.SUBTITLE_TRACK&&t.id!==null&&(v=this.hls.subtitleTracks[t.id].details),v){const b=v.partTarget,L=v.targetduration;if(b&&L){const B=Math.max(b*3,L*.8)*1e3;u=se({},u,{maxTimeToFirstByteMs:Math.min(B,u.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(B,u.maxTimeToFirstByteMs)})}}}const d=u.errorRetry||u.timeoutRetry||{},p={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:d.maxNumRetry||0,retryDelay:d.retryDelayMs||0,maxRetryDelay:d.maxRetryDelayMs||0},g={onSuccess:(v,b,L,B)=>{const W=this.getInternalLoader(L);this.resetInternalLoader(L.type);const K=v.data;if(K.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(v,L,new Error("no EXTM3U delimiter"),B||null,b);return}b.parsing.start=performance.now(),Tn.isMediaPlaylist(K)?this.handleTrackOrLevelPlaylist(v,b,L,B||null,W):this.handleMasterPlaylist(v,b,L,B)},onError:(v,b,L,B)=>{this.handleNetworkError(b,L,!1,v,B)},onTimeout:(v,b,L)=>{this.handleNetworkError(b,L,!0,void 0,v)}};l.load(t,p,g)}handleMasterPlaylist(t,n,a,l){const u=this.hls,d=t.data,p=Hs(t,a),g=Tn.parseMasterPlaylist(d,p);if(g.playlistParsingError){this.handleManifestParsingError(t,a,g.playlistParsingError,l,n);return}const{contentSteering:v,levels:b,sessionData:L,sessionKeys:B,startTimeOffset:W,variableList:K}=g;this.variableList=K;const{AUDIO:ee=[],SUBTITLES:re,"CLOSED-CAPTIONS":xe}=Tn.parseMasterPlaylistMedia(d,p,g);ee.length&&!ee.some(Me=>!Me.url)&&b[0].audioCodec&&!b[0].attrs.AUDIO&&(C.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),ee.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new ue({}),bitrate:0,url:""})),u.trigger(A.MANIFEST_LOADED,{levels:b,audioTracks:ee,subtitles:re,captions:xe,contentSteering:v,url:p,stats:n,networkDetails:l,sessionData:L,sessionKeys:B,startTimeOffset:W,variableList:K})}handleTrackOrLevelPlaylist(t,n,a,l,u){const d=this.hls,{id:p,level:g,type:v}=a,b=Hs(t,a),L=0,B=te(g)?g:te(p)?p:0,W=Bo(a),K=Tn.parseLevelPlaylist(t.data,b,B,W,L,this.variableList);if(v===fi.MANIFEST){const ee={attrs:new ue({}),bitrate:0,details:K,name:"",url:b};d.trigger(A.MANIFEST_LOADED,{levels:[ee],audioTracks:[],url:b,stats:n,networkDetails:l,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}n.parsing.end=performance.now(),a.levelDetails=K,this.handlePlaylistLoaded(K,t,n,a,l,u)}handleManifestParsingError(t,n,a,l,u){this.hls.trigger(A.ERROR,{type:M.NETWORK_ERROR,details:k.MANIFEST_PARSING_ERROR,fatal:n.type===fi.MANIFEST,url:t.url,err:a,error:a,reason:a.message,response:t,context:n,networkDetails:l,stats:u})}handleNetworkError(t,n,a=!1,l,u){let d=`A network ${a?"timeout":"error"+(l?" (status "+l.code+")":"")} occurred while loading ${t.type}`;t.type===fi.LEVEL?d+=`: ${t.level} id: ${t.id}`:(t.type===fi.AUDIO_TRACK||t.type===fi.SUBTITLE_TRACK)&&(d+=` id: ${t.id} group-id: "${t.groupId}"`);const p=new Error(d);C.warn(`[playlist-loader]: ${d}`);let g=k.UNKNOWN,v=!1;const b=this.getInternalLoader(t);switch(t.type){case fi.MANIFEST:g=a?k.MANIFEST_LOAD_TIMEOUT:k.MANIFEST_LOAD_ERROR,v=!0;break;case fi.LEVEL:g=a?k.LEVEL_LOAD_TIMEOUT:k.LEVEL_LOAD_ERROR,v=!1;break;case fi.AUDIO_TRACK:g=a?k.AUDIO_TRACK_LOAD_TIMEOUT:k.AUDIO_TRACK_LOAD_ERROR,v=!1;break;case fi.SUBTITLE_TRACK:g=a?k.SUBTITLE_TRACK_LOAD_TIMEOUT:k.SUBTITLE_LOAD_ERROR,v=!1;break}b&&this.resetInternalLoader(t.type);const L={type:M.NETWORK_ERROR,details:g,fatal:v,url:t.url,loader:b,context:t,error:p,networkDetails:n,stats:u};if(l){const B=(n==null?void 0:n.url)||t.url;L.response=ze({url:B,data:void 0},l)}this.hls.trigger(A.ERROR,L)}handlePlaylistLoaded(t,n,a,l,u,d){const p=this.hls,{type:g,level:v,id:b,groupId:L,deliveryDirectives:B}=l,W=Hs(n,l),K=Bo(l),ee=typeof l.level=="number"&&K===qt.MAIN?v:void 0;if(!t.fragments.length){const xe=new Error("No Segments found in Playlist");p.trigger(A.ERROR,{type:M.NETWORK_ERROR,details:k.LEVEL_EMPTY_ERROR,fatal:!1,url:W,error:xe,reason:xe.message,response:n,context:l,level:ee,parent:K,networkDetails:u,stats:a});return}t.targetduration||(t.playlistParsingError=new Error("Missing Target Duration"));const re=t.playlistParsingError;if(re){p.trigger(A.ERROR,{type:M.NETWORK_ERROR,details:k.LEVEL_PARSING_ERROR,fatal:!1,url:W,error:re,reason:re.message,response:n,context:l,level:ee,parent:K,networkDetails:u,stats:a});return}switch(t.live&&d&&(d.getCacheAge&&(t.ageHeader=d.getCacheAge()||0),(!d.getCacheAge||isNaN(t.ageHeader))&&(t.ageHeader=0)),g){case fi.MANIFEST:case fi.LEVEL:p.trigger(A.LEVEL_LOADED,{details:t,level:ee||0,id:b||0,stats:a,networkDetails:u,deliveryDirectives:B});break;case fi.AUDIO_TRACK:p.trigger(A.AUDIO_TRACK_LOADED,{details:t,id:b||0,groupId:L||"",stats:a,networkDetails:u,deliveryDirectives:B});break;case fi.SUBTITLE_TRACK:p.trigger(A.SUBTITLE_TRACK_LOADED,{details:t,id:b||0,groupId:L||"",stats:a,networkDetails:u,deliveryDirectives:B});break}}}function Mo(h,t){let n;try{n=new Event("addtrack")}catch(a){n=document.createEvent("Event"),n.initEvent("addtrack",!1,!1)}n.track=h,t.dispatchEvent(n)}function Ka(h,t){const n=h.mode;if(n==="disabled"&&(h.mode="hidden"),h.cues&&!h.cues.getCueById(t.id))try{if(h.addCue(t),!h.cues.getCueById(t.id))throw new Error(`addCue is failed for: ${t}`)}catch(a){C.debug(`[texttrack-utils]: ${a}`);try{const l=new self.TextTrackCue(t.startTime,t.endTime,t.text);l.id=t.id,h.addCue(l)}catch(l){C.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${l}`)}}n==="disabled"&&(h.mode=n)}function vs(h){const t=h.mode;if(t==="disabled"&&(h.mode="hidden"),h.cues)for(let n=h.cues.length;n--;)h.removeCue(h.cues[n]);t==="disabled"&&(h.mode=t)}function Fo(h,t,n,a){const l=h.mode;if(l==="disabled"&&(h.mode="hidden"),h.cues&&h.cues.length>0){const u=Ol(h.cues,t,n);for(let d=0;d<u.length;d++)(!a||a(u[d]))&&h.removeCue(u[d])}l==="disabled"&&(h.mode=l)}function Pl(h,t){if(t<h[0].startTime)return 0;const n=h.length-1;if(t>h[n].endTime)return-1;let a=0,l=n;for(;a<=l;){const u=Math.floor((l+a)/2);if(t<h[u].startTime)l=u-1;else if(t>h[u].startTime&&a<n)a=u+1;else return u}return h[a].startTime-t<t-h[l].startTime?a:l}function Ol(h,t,n){const a=[],l=Pl(h,t);if(l>-1)for(let u=l,d=h.length;u<d;u++){const p=h[u];if(p.startTime>=t&&p.endTime<=n)a.push(p);else if(p.startTime>n)return a}return a}function ga(h){const t=[];for(let n=0;n<h.length;n++){const a=h[n];(a.kind==="subtitles"||a.kind==="captions")&&a.label&&t.push(h[n])}return t}var Kn={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};const Bl=.25;function Ya(){if(typeof self!="undefined")return self.VTTCue||self.TextTrackCue}function As(h,t,n,a,l){let u=new h(t,n,"");try{u.value=a,l&&(u.type=l)}catch(d){u=new h(t,n,JSON.stringify(l?ze({type:l},a):a))}return u}const Xa=(()=>{const h=Ya();try{h&&new h(0,Number.POSITIVE_INFINITY,"")}catch(t){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function No(h,t){return h.getTime()/1e3-t}function Qu(h){return Uint8Array.from(h.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class Ju{constructor(t){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=t,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:t}=this;t.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(A.MANIFEST_LOADING,this.onManifestLoading,this),t.on(A.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.on(A.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(A.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:t}=this;t.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(A.MANIFEST_LOADING,this.onManifestLoading,this),t.off(A.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.off(A.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(A.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(t,n){this.media=n.media}onMediaDetaching(){!this.id3Track||(vs(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(t){const n=this.getID3Track(t.textTracks);return n.mode="hidden",n}getID3Track(t){if(!!this.media){for(let n=0;n<t.length;n++){const a=t[n];if(a.kind==="metadata"&&a.label==="id3")return Mo(a,this.media),a}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(t,n){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:a,enableID3MetadataCues:l}}}=this;if(!a&&!l)return;const{samples:u}=n;this.id3Track||(this.id3Track=this.createTrack(this.media));const d=Ya();if(!!d)for(let p=0;p<u.length;p++){const g=u[p].type;if(g===Kn.emsg&&!a||!l)continue;const v=Vi(u[p].data);if(v){const b=u[p].pts;let L=b+u[p].duration;L>Xa&&(L=Xa),L-b<=0&&(L=b+Bl);for(let W=0;W<v.length;W++){const K=v[W];if(!ti(K)){this.updateId3CueEnds(b,g);const ee=As(d,b,L,K,g);ee&&this.id3Track.addCue(ee)}}}}}updateId3CueEnds(t,n){var a;const l=(a=this.id3Track)==null?void 0:a.cues;if(l)for(let u=l.length;u--;){const d=l[u];d.type===n&&d.startTime<t&&d.endTime===Xa&&(d.endTime=t)}}onBufferFlushing(t,{startOffset:n,endOffset:a,type:l}){const{id3Track:u,hls:d}=this;if(!d)return;const{config:{enableEmsgMetadataCues:p,enableID3MetadataCues:g}}=d;if(u&&(p||g)){let v;l==="audio"?v=b=>b.type===Kn.audioId3&&g:l==="video"?v=b=>b.type===Kn.emsg&&p:v=b=>b.type===Kn.audioId3&&g||b.type===Kn.emsg&&p,Fo(u,n,a,v)}}onLevelUpdated(t,{details:n}){if(!this.media||!n.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:a,id3Track:l}=this,{dateRanges:u}=n,d=Object.keys(u);if(l){const b=Object.keys(a).filter(L=>!d.includes(L));for(let L=b.length;L--;){const B=b[L];Object.keys(a[B].cues).forEach(W=>{l.removeCue(a[B].cues[W])}),delete a[B]}}const p=n.fragments[n.fragments.length-1];if(d.length===0||!te(p==null?void 0:p.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const g=p.programDateTime/1e3-p.start,v=Ya();for(let b=0;b<d.length;b++){const L=d[b],B=u[L],W=No(B.startDate,g),K=a[L],ee=(K==null?void 0:K.cues)||{};let re=(K==null?void 0:K.durationKnown)||!1,xe=Xa;const Fe=B.endDate;if(Fe)xe=No(Fe,g),re=!0;else if(B.endOnNext&&!re){const it=d.reduce(($e,ut)=>{if(ut!==B.id){const Qe=u[ut];if(Qe.class===B.class&&Qe.startDate>B.startDate&&(!$e||B.startDate<$e.startDate))return Qe}return $e},null);it&&(xe=No(it.startDate,g),re=!0)}const Me=Object.keys(B.attr);for(let it=0;it<Me.length;it++){const $e=Me[it];if(!j($e))continue;const ut=ee[$e];if(ut)re&&!K.durationKnown&&(ut.endTime=xe);else if(v){let Qe=B.attr[$e];X($e)&&(Qe=Qu(Qe));const yt=As(v,W,xe,{key:$e,data:Qe},Kn.dateRange);yt&&(yt.id=L,this.id3Track.addCue(yt),ee[$e]=yt)}}a[L]={cues:ee,dateRange:B,durationKnown:re}}}}class Zu{constructor(t){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=t,this.config=t.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:t,levelDetails:n}=this;return t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:n?t.liveMaxLatencyDurationCount*n.targetduration:0}get targetLatency(){const{levelDetails:t}=this;if(t===null)return null;const{holdBack:n,partHoldBack:a,targetduration:l}=t,{liveSyncDuration:u,liveSyncDurationCount:d,lowLatencyMode:p}=this.config,g=this.hls.userConfig;let v=p&&a||n;(g.liveSyncDuration||g.liveSyncDurationCount||v===0)&&(v=u!==void 0?u:d*l);const b=l,L=1;return v+Math.min(this.stallCount*L,b)}get liveSyncPosition(){const t=this.estimateLiveEdge(),n=this.targetLatency,a=this.levelDetails;if(t===null||n===null||a===null)return null;const l=a.edge,u=t-n-this.edgeStalled,d=l-a.totalduration,p=l-(this.config.lowLatencyMode&&a.partTarget||a.targetduration);return Math.min(Math.max(d,u),p)}get drift(){const{levelDetails:t}=this;return t===null?1:t.drift}get edgeStalled(){const{levelDetails:t}=this;if(t===null)return 0;const n=(this.config.lowLatencyMode&&t.partTarget||t.targetduration)*3;return Math.max(t.age-n,0)}get forwardBufferLength(){const{media:t,levelDetails:n}=this;if(!t||!n)return 0;const a=t.buffered.length;return(a?t.buffered.end(a-1):n.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(A.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(A.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(A.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(A.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(A.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(A.ERROR,this.onError,this)}onMediaAttached(t,n){this.media=n.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(t,{details:n}){this.levelDetails=n,n.advanced&&this.timeupdate(),!n.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(t,n){var a;n.details===k.BUFFER_STALLED_ERROR&&(this.stallCount++,(a=this.levelDetails)!=null&&a.live&&C.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:t,levelDetails:n}=this;if(!t||!n)return;this.currentTime=t.currentTime;const a=this.computeLatency();if(a===null)return;this._latency=a;const{lowLatencyMode:l,maxLiveSyncPlaybackRate:u}=this.config;if(!l||u===1||!n.live)return;const d=this.targetLatency;if(d===null)return;const p=a-d,g=Math.min(this.maxLatency,d+n.targetduration);if(p<g&&p>.05&&this.forwardBufferLength>1){const b=Math.min(2,Math.max(1,u)),L=Math.round(2/(1+Math.exp(-.75*p-this.edgeStalled))*20)/20;t.playbackRate=Math.min(b,Math.max(1,L))}else t.playbackRate!==1&&t.playbackRate!==0&&(t.playbackRate=1)}estimateLiveEdge(){const{levelDetails:t}=this;return t===null?null:t.edge+t.age}computeLatency(){const t=this.estimateLiveEdge();return t===null?null:t-this.currentTime}}const Uo=["NONE","TYPE-0","TYPE-1",null];function Qa(h){return Uo.indexOf(h)>-1}const ya=["SDR","PQ","HLG"];function Ja(h){return!!h&&ya.indexOf(h)>-1}var _s={No:"",Yes:"YES",v2:"v2"};function _n(h){const{canSkipUntil:t,canSkipDateRanges:n,age:a}=h,l=a<t/2;return t&&l?n?_s.v2:_s.Yes:_s.No}class Xr{constructor(t,n,a){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=t,this.part=n,this.skip=a}addDirectives(t){const n=new self.URL(t);return this.msn!==void 0&&n.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&n.searchParams.set("_HLS_part",this.part.toString()),this.skip&&n.searchParams.set("_HLS_skip",this.skip),n.href}}class or{constructor(t){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[t.url],this._attrs=[t.attrs],this.bitrate=t.bitrate,t.details&&(this.details=t.details),this.id=t.id||0,this.name=t.name,this.width=t.width||0,this.height=t.height||0,this.frameRate=t.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=t.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=t.audioCodec,this.videoCodec=t.videoCodec,this.codecSet=[t.videoCodec,t.audioCodec].filter(n=>!!n).map(n=>n.substring(0,4)).join(","),this.addGroupId("audio",t.attrs.AUDIO),this.addGroupId("text",t.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(t){return jo(this._audioGroups,t)}hasSubtitleGroup(t){return jo(this._subtitleGroups,t)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(t,n){if(!!n){if(t==="audio"){let a=this._audioGroups;a||(a=this._audioGroups=[]),a.indexOf(n)===-1&&a.push(n)}else if(t==="text"){let a=this._subtitleGroups;a||(a=this._subtitleGroups=[]),a.indexOf(n)===-1&&a.push(n)}}}get urlId(){return 0}set urlId(t){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var t;return(t=this.audioGroups)==null?void 0:t[0]}get textGroupId(){var t;return(t=this.subtitleGroups)==null?void 0:t[0]}addFallback(){}}function jo(h,t){return!t||!h?!1:h.indexOf(t)!==-1}function Za(h,t){const n=t.startPTS;if(te(n)){let a=0,l;t.sn>h.sn?(a=n-h.start,l=h):(a=h.start-n,l=t),l.duration!==a&&(l.duration=a)}else t.sn>h.sn?h.cc===t.cc&&h.minEndPTS?t.start=h.start+(h.minEndPTS-h.start):t.start=h.start+h.duration:t.start=Math.max(h.start-t.duration,0)}function Ml(h,t,n,a,l,u){a-n<=0&&(C.warn("Fragment should have a positive duration",t),a=n+t.duration,u=l+t.duration);let p=n,g=a;const v=t.startPTS,b=t.endPTS;if(te(v)){const re=Math.abs(v-n);te(t.deltaPTS)?t.deltaPTS=Math.max(re,t.deltaPTS):t.deltaPTS=re,p=Math.max(n,v),n=Math.min(n,v),l=Math.min(l,t.startDTS),g=Math.min(a,b),a=Math.max(a,b),u=Math.max(u,t.endDTS)}const L=n-t.start;t.start!==0&&(t.start=n),t.duration=a-t.start,t.startPTS=n,t.maxStartPTS=p,t.startDTS=l,t.endPTS=a,t.minEndPTS=g,t.endDTS=u;const B=t.sn;if(!h||B<h.startSN||B>h.endSN)return 0;let W;const K=B-h.startSN,ee=h.fragments;for(ee[K]=t,W=K;W>0;W--)Za(ee[W],ee[W-1]);for(W=K;W<ee.length-1;W++)Za(ee[W],ee[W+1]);return h.fragmentHint&&Za(ee[ee.length-1],h.fragmentHint),h.PTSKnown=h.alignedSliding=!0,L}function ed(h,t){let n=null;const a=h.fragments;for(let g=a.length-1;g>=0;g--){const v=a[g].initSegment;if(v){n=v;break}}h.fragmentHint&&delete h.fragmentHint.endPTS;let l=0,u;if(Fl(h,t,(g,v)=>{g.relurl&&(l=g.cc-v.cc),te(g.startPTS)&&te(g.endPTS)&&(v.start=v.startPTS=g.startPTS,v.startDTS=g.startDTS,v.maxStartPTS=g.maxStartPTS,v.endPTS=g.endPTS,v.endDTS=g.endDTS,v.minEndPTS=g.minEndPTS,v.duration=g.endPTS-g.startPTS,v.duration&&(u=v),t.PTSKnown=t.alignedSliding=!0),v.elementaryStreams=g.elementaryStreams,v.loader=g.loader,v.stats=g.stats,g.initSegment&&(v.initSegment=g.initSegment,n=g.initSegment)}),n&&(t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments).forEach(v=>{var b;v&&(!v.initSegment||v.initSegment.relurl===((b=n)==null?void 0:b.relurl))&&(v.initSegment=n)}),t.skippedSegments)if(t.deltaUpdateFailed=t.fragments.some(g=>!g),t.deltaUpdateFailed){C.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let g=t.skippedSegments;g--;)t.fragments.shift();t.startSN=t.fragments[0].sn,t.startCC=t.fragments[0].cc}else t.canSkipDateRanges&&(t.dateRanges=Ri(h.dateRanges,t.dateRanges,t.recentlyRemovedDateranges));const d=t.fragments;if(l){C.warn("discontinuity sliding from playlist, take drift into account");for(let g=0;g<d.length;g++)d[g].cc+=l}t.skippedSegments&&(t.startCC=t.fragments[0].cc),eo(h.partList,t.partList,(g,v)=>{v.elementaryStreams=g.elementaryStreams,v.stats=g.stats}),u?Ml(t,u,u.startPTS,u.endPTS,u.startDTS,u.endDTS):Pr(h,t),d.length&&(t.totalduration=t.edge-d[0].start),t.driftStartTime=h.driftStartTime,t.driftStart=h.driftStart;const p=t.advancedDateTime;if(t.advanced&&p){const g=t.edge;t.driftStart||(t.driftStartTime=p,t.driftStart=g),t.driftEndTime=p,t.driftEnd=g}else t.driftEndTime=h.driftEndTime,t.driftEnd=h.driftEnd,t.advancedDateTime=h.advancedDateTime}function Ri(h,t,n){const a=se({},h);return n&&n.forEach(l=>{delete a[l]}),Object.keys(t).forEach(l=>{const u=new oe(t[l].attr,a[l]);u.isValid?a[l]=u:C.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(t[l].attr)}"`)}),a}function eo(h,t,n){if(h&&t){let a=0;for(let l=0,u=h.length;l<=u;l++){const d=h[l],p=t[l+a];d&&p&&d.index===p.index&&d.fragment.sn===p.fragment.sn?n(d,p):a--}}}function Fl(h,t,n){const a=t.skippedSegments,l=Math.max(h.startSN,t.startSN)-t.startSN,u=(h.fragmentHint?1:0)+(a?t.endSN:Math.min(h.endSN,t.endSN))-t.startSN,d=t.startSN-h.startSN,p=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,g=h.fragmentHint?h.fragments.concat(h.fragmentHint):h.fragments;for(let v=l;v<=u;v++){const b=g[d+v];let L=p[v];a&&!L&&v<a&&(L=t.fragments[v]=b),b&&L&&n(b,L)}}function Pr(h,t){const n=t.startSN+t.skippedSegments-h.startSN,a=h.fragments;n<0||n>=a.length||va(t,a[n].start)}function va(h,t){if(t){const n=h.fragments;for(let a=h.skippedSegments;a<n.length;a++)n[a].start+=t;h.fragmentHint&&(h.fragmentHint.start+=t)}}function Nl(h,t=Infinity){let n=1e3*h.targetduration;if(h.updated){const a=h.fragments,l=4;if(a.length&&n*l>t){const u=a[a.length-1].duration*1e3;u<n&&(n=u)}}else n/=2;return Math.round(n)}function Ul(h,t,n){if(!(h!=null&&h.details))return null;const a=h.details;let l=a.fragments[t-a.startSN];return l||(l=a.fragmentHint,l&&l.sn===t)?l:t<a.startSN&&n&&n.sn===t?n:null}function Fi(h,t,n){var a;return h!=null&&h.details?jn((a=h.details)==null?void 0:a.partList,t,n):null}function jn(h,t,n){if(h)for(let a=h.length;a--;){const l=h[a];if(l.index===n&&l.fragment.sn===t)return l}return null}function $o(h){h.forEach((t,n)=>{const{details:a}=t;a!=null&&a.fragments&&a.fragments.forEach(l=>{l.level=n})})}function Aa(h){switch(h.details){case k.FRAG_LOAD_TIMEOUT:case k.KEY_LOAD_TIMEOUT:case k.LEVEL_LOAD_TIMEOUT:case k.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Gs(h,t){const n=Aa(t);return h.default[`${n?"timeout":"error"}Retry`]}function _a(h,t){const n=h.backoff==="linear"?1:Math.pow(2,t);return Math.min(n*h.retryDelayMs,h.maxRetryDelayMs)}function Vo(h){return ze(ze({},h),{errorRetry:null,timeoutRetry:null})}function qs(h,t,n,a){if(!h)return!1;const l=a==null?void 0:a.code,u=t<h.maxNumRetry&&(bs(l)||!!n);return h.shouldRetry?h.shouldRetry(h,t,n,a,u):u}function bs(h){return h===0&&navigator.onLine===!1||!!h&&(h<400||h>499)}const to={search:function(h,t){let n=0,a=h.length-1,l=null,u=null;for(;n<=a;){l=(n+a)/2|0,u=h[l];const d=t(u);if(d>0)n=l+1;else if(d<0)a=l-1;else return u}return null}};function jl(h,t,n){if(t===null||!Array.isArray(h)||!h.length||!te(t))return null;const a=h[0].programDateTime;if(t<(a||0))return null;const l=h[h.length-1].endProgramDateTime;if(t>=(l||0))return null;n=n||0;for(let u=0;u<h.length;++u){const d=h[u];if(io(t,n,d))return d}return null}function ba(h,t,n=0,a=0,l=.005){let u=null;if(h){u=t[h.sn-t[0].sn+1]||null;const p=h.endDTS-n;p>0&&p<15e-7&&(n+=15e-7)}else n===0&&t[0].start===0&&(u=t[0]);if(u&&((!h||h.level===u.level)&&Or(n,a,u)===0||rn(u,h,Math.min(l,a))))return u;const d=to.search(t,Or.bind(null,n,a));return d&&(d!==h||!u)?d:u}function rn(h,t,n){if(t&&t.start===0&&t.level<h.level&&(t.endPTS||0)>0){const a=t.tagList.reduce((l,u)=>(u[0]==="INF"&&(l+=parseFloat(u[1])),l),n);return h.start<=a}return!1}function Or(h=0,t=0,n){if(n.start<=h&&n.start+n.duration>h)return 0;const a=Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0));return n.start+n.duration-a<=h?1:n.start-a>h&&n.start?-1:0}function io(h,t,n){const a=Math.min(t,n.duration+(n.deltaPTS?n.deltaPTS:0))*1e3;return(n.endProgramDateTime||0)-a>h}function zs(h,t){return to.search(h,n=>n.cc<t?1:n.cc>t?-1:0)}var Ji={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},Yn={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4};class Qr{constructor(t){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=t,this.log=C.log.bind(C,"[info]:"),this.warn=C.warn.bind(C,"[warning]:"),this.error=C.error.bind(C,"[error]:"),this.registerListeners()}registerListeners(){const t=this.hls;t.on(A.ERROR,this.onError,this),t.on(A.MANIFEST_LOADING,this.onManifestLoading,this),t.on(A.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const t=this.hls;!t||(t.off(A.ERROR,this.onError,this),t.off(A.ERROR,this.onErrorOut,this),t.off(A.MANIFEST_LOADING,this.onManifestLoading,this),t.off(A.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(t){}stopLoad(){this.playlistError=0}getVariantLevelIndex(t){return(t==null?void 0:t.type)===qt.MAIN?t.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(t,n){var a,l;if(n.fatal)return;const u=this.hls,d=n.context;switch(n.details){case k.FRAG_LOAD_ERROR:case k.FRAG_LOAD_TIMEOUT:case k.KEY_LOAD_ERROR:case k.KEY_LOAD_TIMEOUT:n.errorAction=this.getFragRetryOrSwitchAction(n);return;case k.FRAG_PARSING_ERROR:if((a=n.frag)!=null&&a.gap){n.errorAction={action:Ji.DoNothing,flags:Yn.None};return}case k.FRAG_GAP:case k.FRAG_DECRYPT_ERROR:{n.errorAction=this.getFragRetryOrSwitchAction(n),n.errorAction.action=Ji.SendAlternateToPenaltyBox;return}case k.LEVEL_EMPTY_ERROR:case k.LEVEL_PARSING_ERROR:{var p,g;const v=n.parent===qt.MAIN?n.level:u.loadLevel;n.details===k.LEVEL_EMPTY_ERROR&&!!((p=n.context)!=null&&(g=p.levelDetails)!=null&&g.live)?n.errorAction=this.getPlaylistRetryOrSwitchAction(n,v):(n.levelRetry=!1,n.errorAction=this.getLevelSwitchAction(n,v))}return;case k.LEVEL_LOAD_ERROR:case k.LEVEL_LOAD_TIMEOUT:typeof(d==null?void 0:d.level)=="number"&&(n.errorAction=this.getPlaylistRetryOrSwitchAction(n,d.level));return;case k.AUDIO_TRACK_LOAD_ERROR:case k.AUDIO_TRACK_LOAD_TIMEOUT:case k.SUBTITLE_LOAD_ERROR:case k.SUBTITLE_TRACK_LOAD_TIMEOUT:if(d){const v=u.levels[u.loadLevel];if(v&&(d.type===fi.AUDIO_TRACK&&v.hasAudioGroup(d.groupId)||d.type===fi.SUBTITLE_TRACK&&v.hasSubtitleGroup(d.groupId))){n.errorAction=this.getPlaylistRetryOrSwitchAction(n,u.loadLevel),n.errorAction.action=Ji.SendAlternateToPenaltyBox,n.errorAction.flags=Yn.MoveAllAlternatesMatchingHost;return}}return;case k.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const v=u.levels[u.loadLevel],b=v==null?void 0:v.attrs["HDCP-LEVEL"];b?n.errorAction={action:Ji.SendAlternateToPenaltyBox,flags:Yn.MoveAllAlternatesMatchingHDCP,hdcpLevel:b}:this.keySystemError(n)}return;case k.BUFFER_ADD_CODEC_ERROR:case k.REMUX_ALLOC_ERROR:case k.BUFFER_APPEND_ERROR:n.errorAction=this.getLevelSwitchAction(n,(l=n.level)!=null?l:u.loadLevel);return;case k.INTERNAL_EXCEPTION:case k.BUFFER_APPENDING_ERROR:case k.BUFFER_FULL_ERROR:case k.LEVEL_SWITCH_ERROR:case k.BUFFER_STALLED_ERROR:case k.BUFFER_SEEK_OVER_HOLE:case k.BUFFER_NUDGE_ON_STALL:n.errorAction={action:Ji.DoNothing,flags:Yn.None};return}n.type===M.KEY_SYSTEM_ERROR&&this.keySystemError(n)}keySystemError(t){const n=this.getVariantLevelIndex(t.frag);t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,n)}getPlaylistRetryOrSwitchAction(t,n){const a=this.hls,l=Gs(a.config.playlistLoadPolicy,t),u=this.playlistError++;if(qs(l,u,Aa(t),t.response))return{action:Ji.RetryRequest,flags:Yn.None,retryConfig:l,retryCount:u};const p=this.getLevelSwitchAction(t,n);return l&&(p.retryConfig=l,p.retryCount=u),p}getFragRetryOrSwitchAction(t){const n=this.hls,a=this.getVariantLevelIndex(t.frag),l=n.levels[a],{fragLoadPolicy:u,keyLoadPolicy:d}=n.config,p=Gs(t.details.startsWith("key")?d:u,t),g=n.levels.reduce((b,L)=>b+L.fragmentError,0);if(l&&(t.details!==k.FRAG_GAP&&l.fragmentError++,qs(p,g,Aa(t),t.response)))return{action:Ji.RetryRequest,flags:Yn.None,retryConfig:p,retryCount:g};const v=this.getLevelSwitchAction(t,a);return p&&(v.retryConfig=p,v.retryCount=g),v}getLevelSwitchAction(t,n){const a=this.hls;n==null&&(n=a.loadLevel);const l=this.hls.levels[n];if(l){var u,d;const v=t.details;l.loadError++,v===k.BUFFER_APPEND_ERROR&&l.fragmentError++;let b=-1;const{levels:L,loadLevel:B,minAutoLevel:W,maxAutoLevel:K}=a;a.autoLevelEnabled||(a.loadLevel=-1);const ee=(u=t.frag)==null?void 0:u.type,xe=(ee===qt.AUDIO&&v===k.FRAG_PARSING_ERROR||t.sourceBufferName==="audio"&&(v===k.BUFFER_ADD_CODEC_ERROR||v===k.BUFFER_APPEND_ERROR))&&L.some(({audioCodec:ut})=>l.audioCodec!==ut),Me=t.sourceBufferName==="video"&&(v===k.BUFFER_ADD_CODEC_ERROR||v===k.BUFFER_APPEND_ERROR)&&L.some(({codecSet:ut,audioCodec:Qe})=>l.codecSet!==ut&&l.audioCodec===Qe),{type:it,groupId:$e}=(d=t.context)!=null?d:{};for(let ut=L.length;ut--;){const Qe=(ut+B)%L.length;if(Qe!==B&&Qe>=W&&Qe<=K&&L[Qe].loadError===0){var p,g;const yt=L[Qe];if(v===k.FRAG_GAP&&ee===qt.MAIN&&t.frag){const xt=L[Qe].details;if(xt){const ot=ba(t.frag,xt.fragments,t.frag.start);if(ot!=null&&ot.gap)continue}}else{if(it===fi.AUDIO_TRACK&&yt.hasAudioGroup($e)||it===fi.SUBTITLE_TRACK&&yt.hasSubtitleGroup($e))continue;if(ee===qt.AUDIO&&(p=l.audioGroups)!=null&&p.some(xt=>yt.hasAudioGroup(xt))||ee===qt.SUBTITLE&&(g=l.subtitleGroups)!=null&&g.some(xt=>yt.hasSubtitleGroup(xt))||xe&&l.audioCodec===yt.audioCodec||!xe&&l.audioCodec!==yt.audioCodec||Me&&l.codecSet===yt.codecSet)continue}b=Qe;break}}if(b>-1&&a.loadLevel!==b)return t.levelRetry=!0,this.playlistError=0,{action:Ji.SendAlternateToPenaltyBox,flags:Yn.None,nextAutoLevel:b}}return{action:Ji.SendAlternateToPenaltyBox,flags:Yn.MoveAllAlternatesMatchingHost}}onErrorOut(t,n){var a;switch((a=n.errorAction)==null?void 0:a.action){case Ji.DoNothing:break;case Ji.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(n),!n.errorAction.resolved&&n.details!==k.FRAG_GAP?n.fatal=!0:/MediaSource readyState: ended/.test(n.error.message)&&(this.warn(`MediaSource ended after "${n.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break;case Ji.RetryRequest:break}if(n.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(t){const n=this.hls,a=t.errorAction;if(!a)return;const{flags:l,hdcpLevel:u,nextAutoLevel:d}=a;switch(l){case Yn.None:this.switchLevel(t,d);break;case Yn.MoveAllAlternatesMatchingHDCP:u&&(n.maxHdcpLevel=Uo[Uo.indexOf(u)-1],a.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${n.maxHdcpLevel}" or lower`);break}a.resolved||this.switchLevel(t,d)}switchLevel(t,n){n!==void 0&&t.errorAction&&(this.warn(`switching to level ${n} after ${t.details}`),this.hls.nextAutoLevel=n,t.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}}class vr{constructor(t,n){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=C.log.bind(C,`${n}:`),this.warn=C.warn.bind(C,`${n}:`),this.hls=t}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(t,n,a){const l=n==null?void 0:n.renditionReports;if(l){let u=-1;for(let d=0;d<l.length;d++){const p=l[d];let g;try{g=new self.URL(p.URI,n.url).href}catch(v){C.warn(`Could not construct new URL for Rendition Report: ${v}`),g=p.URI||""}if(g===t){u=d;break}else g===t.substring(0,g.length)&&(u=d)}if(u!==-1){const d=l[u],p=parseInt(d["LAST-MSN"])||(n==null?void 0:n.lastPartSn);let g=parseInt(d["LAST-PART"])||(n==null?void 0:n.lastPartIndex);if(this.hls.config.lowLatencyMode){const b=Math.min(n.age-n.partTarget,n.targetduration);g>=0&&b>n.partTarget&&(g+=1)}const v=a&&_n(a);return new Xr(p,g>=0?g:void 0,v)}}}loadPlaylist(t){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(t){return this.canLoad&&!!t&&!!t.url&&(!t.details||t.details.live)}shouldReloadPlaylist(t){return this.timer===-1&&this.requestScheduled===-1&&this.shouldLoadPlaylist(t)}playlistLoaded(t,n,a){const{details:l,stats:u}=n,d=self.performance.now(),p=u.loading.first?Math.max(0,d-u.loading.first):0;if(l.advancedDateTime=Date.now()-p,l.live||a!=null&&a.live){if(l.reloaded(a),a&&this.log(`live playlist ${t} ${l.advanced?"REFRESHED "+l.lastPartSn+"-"+l.lastPartIndex:l.updated?"UPDATED":"MISSED"}`),a&&l.fragments.length>0&&ed(a,l),!this.canLoad||!l.live)return;let g,v,b;if(l.canBlockReload&&l.endSN&&l.advanced){const re=this.hls.config.lowLatencyMode,xe=l.lastPartSn,Fe=l.endSN,Me=l.lastPartIndex,it=Me!==-1,$e=xe===Fe,ut=re?0:Me;it?(v=$e?Fe+1:xe,b=$e?ut:Me+1):v=Fe+1;const Qe=l.age,yt=Qe+l.ageHeader;let xt=Math.min(yt-l.partTarget,l.targetduration*1.5);if(xt>0){if(a&&xt>a.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${a.tuneInGoal} to: ${xt} with playlist age: ${l.age}`),xt=0;else{const ot=Math.floor(xt/l.targetduration);v+=ot,b!==void 0&&(b+=Math.round(xt%l.targetduration/l.partTarget)),this.log(`CDN Tune-in age: ${l.ageHeader}s last advanced ${Qe.toFixed(2)}s goal: ${xt} skip sn ${ot} to part ${b}`)}l.tuneInGoal=xt}if(g=this.getDeliveryDirectives(l,n.deliveryDirectives,v,b),re||!$e){this.loadPlaylist(g);return}}else(l.canBlockReload||l.canSkipUntil)&&(g=this.getDeliveryDirectives(l,n.deliveryDirectives,v,b));const L=this.hls.mainForwardBufferInfo,B=L?L.end-L.len:0,W=(l.edge-B)*1e3,K=Nl(l,W);l.updated&&d>this.requestScheduled+K&&(this.requestScheduled=u.loading.start),v!==void 0&&l.canBlockReload?this.requestScheduled=u.loading.first+K-(l.partTarget*1e3||1e3):this.requestScheduled===-1||this.requestScheduled+K<d?this.requestScheduled=d:this.requestScheduled-d<=0&&(this.requestScheduled+=K);let ee=this.requestScheduled-d;ee=Math.max(0,ee),this.log(`reload live playlist ${t} in ${Math.round(ee)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(g),ee)}else this.clearTimer()}getDeliveryDirectives(t,n,a,l){let u=_n(t);return n!=null&&n.skip&&t.deltaUpdateFailed&&(a=n.msn,l=n.part,u=_s.No),new Xr(a,l,u)}checkRetry(t){const n=t.details,a=Aa(t),l=t.errorAction,{action:u,retryCount:d=0,retryConfig:p}=l||{},g=!!l&&!!p&&(u===Ji.RetryRequest||!l.resolved&&u===Ji.SendAlternateToPenaltyBox);if(g){var v;if(this.requestScheduled=-1,d>=p.maxNumRetry)return!1;if(a&&(v=t.context)!=null&&v.deliveryDirectives)this.warn(`Retrying playlist loading ${d+1}/${p.maxNumRetry} after "${n}" without delivery-directives`),this.loadPlaylist();else{const b=_a(p,d);this.timer=self.setTimeout(()=>this.loadPlaylist(),b),this.warn(`Retrying playlist loading ${d+1}/${p.maxNumRetry} after "${n}" in ${b}ms`)}t.levelRetry=!0,l.resolved=!0}return g}}class Sn{constructor(t,n=0,a=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=t,this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=n,this.totalWeight_=a}sample(t,n){const a=Math.pow(this.alpha_,t);this.estimate_=n*(1-a)+a*this.estimate_,this.totalWeight_+=t}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const t=1-Math.pow(this.alpha_,this.totalWeight_);if(t)return this.estimate_/t}return this.estimate_}}class Br{constructor(t,n,a,l=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=a,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Sn(t),this.fast_=new Sn(n),this.defaultTTFB_=l,this.ttfb_=new Sn(t)}update(t,n){const{slow_:a,fast_:l,ttfb_:u}=this;a.halfLife!==t&&(this.slow_=new Sn(t,a.getEstimate(),a.getTotalWeight())),l.halfLife!==n&&(this.fast_=new Sn(n,l.getEstimate(),l.getTotalWeight())),u.halfLife!==t&&(this.ttfb_=new Sn(t,u.getEstimate(),u.getTotalWeight()))}sample(t,n){t=Math.max(t,this.minDelayMs_);const a=8*n,l=t/1e3,u=a/l;this.fast_.sample(l,u),this.slow_.sample(l,u)}sampleTTFB(t){const n=t/1e3,a=Math.sqrt(2)*Math.exp(-Math.pow(n,2)/2);this.ttfb_.sample(a,Math.max(t,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}const Ho={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},Jr={};function $l(h,t,n,a,l,u){const d=h.audioCodec?h.audioGroups:null,p=u==null?void 0:u.audioCodec,g=u==null?void 0:u.channels,v=g?parseInt(g):p?Infinity:2;let b=null;if(d!=null&&d.length)try{d.length===1&&d[0]?b=t.groups[d[0]].channels:b=d.reduce((L,B)=>{if(B){const W=t.groups[B];if(!W)throw new Error(`Audio track group ${B} not found`);Object.keys(W.channels).forEach(K=>{L[K]=(L[K]||0)+W.channels[K]})}return L},{2:0})}catch(L){return!0}return h.videoCodec!==void 0&&(h.width>1920&&h.height>1088||h.height>1920&&h.width>1088||h.frameRate>Math.max(a,30)||h.videoRange!=="SDR"&&h.videoRange!==n||h.bitrate>Math.max(l,8e6))||!!b&&te(v)&&Object.keys(b).some(L=>parseInt(L)>v)}function xa(h,t,n){const a=h.videoCodec,l=h.audioCodec;if(!a||!l||!n)return Promise.resolve(Ho);const u={width:h.width,height:h.height,bitrate:Math.ceil(Math.max(h.bitrate*.9,h.averageBitrate)),framerate:h.frameRate||30},d=h.videoRange;d!=="SDR"&&(u.transferFunction=d.toLowerCase());const p=a.split(",").map(g=>({type:"media-source",video:ze(ze({},u),{},{contentType:Rr(g,"video")})}));return l&&h.audioGroups&&h.audioGroups.forEach(g=>{var v;!g||(v=t.groups[g])==null||v.tracks.forEach(b=>{if(b.groupId===g){const L=b.channels||"",B=parseFloat(L);te(B)&&B>2&&p.push.apply(p,l.split(",").map(W=>({type:"media-source",audio:{contentType:Rr(W,"audio"),channels:""+B}})))}})}),Promise.all(p.map(g=>{const v=Ea(g);return Jr[v]||(Jr[v]=n.decodingInfo(g))})).then(g=>({supported:!g.some(v=>!v.supported),configurations:p,decodingInfoResults:g})).catch(g=>({supported:!1,configurations:p,decodingInfoResults:[],error:g}))}function Ea(h){const{audio:t,video:n}=h,a=n||t;if(a){const l=a.contentType.split('"')[1];if(n)return`r${n.height}x${n.width}f${Math.ceil(n.framerate)}${n.transferFunction||"sd"}_${l}_${Math.ceil(n.bitrate/1e5)}`;if(t)return`c${t.channels}${t.spatialRendering?"s":"n"}_${l}`}return""}function xs(){if(typeof matchMedia=="function"){const h=matchMedia("(dynamic-range: high)"),t=matchMedia("bad query");if(h.media!==t.media)return h.matches===!0}return!1}function Ws(h,t){let n=!1,a=[];return h&&(n=h!=="SDR",a=[h]),t&&(a=t.allowedVideoRanges||ya.slice(0),n=t.preferHDR!==void 0?t.preferHDR:xs(),n?a=a.filter(l=>l!=="SDR"):a=["SDR"]),{preferHDR:n,allowedVideoRanges:a}}function Cn(h,t,n,a,l){const u=Object.keys(h),d=a==null?void 0:a.channels,p=a==null?void 0:a.audioCodec,g=d&&parseInt(d)===2;let v=!0,b=!1,L=Infinity,B=Infinity,W=Infinity,K=0,ee=[];const{preferHDR:re,allowedVideoRanges:xe}=Ws(t,l);for(let $e=u.length;$e--;){const ut=h[u[$e]];v=ut.channels[2]>0,L=Math.min(L,ut.minHeight),B=Math.min(B,ut.minFramerate),W=Math.min(W,ut.minBitrate);const Qe=xe.filter(yt=>ut.videoRanges[yt]>0);Qe.length>0&&(b=!0,ee=Qe)}L=te(L)?L:0,B=te(B)?B:0;const Fe=Math.max(1080,L),Me=Math.max(30,B);return W=te(W)?W:n,n=Math.max(W,n),b||(t=void 0,ee=[]),{codecSet:u.reduce(($e,ut)=>{const Qe=h[ut];if(ut===$e)return $e;if(Qe.minBitrate>n)return Ar(ut,`min bitrate of ${Qe.minBitrate} > current estimate of ${n}`),$e;if(!Qe.hasDefaultAudio)return Ar(ut,"no renditions with default or auto-select sound found"),$e;if(p&&ut.indexOf(p.substring(0,4))%5!=0)return Ar(ut,`audio codec preference "${p}" not found`),$e;if(d&&!g){if(!Qe.channels[d])return Ar(ut,`no renditions with ${d} channel sound found (channels options: ${Object.keys(Qe.channels)})`),$e}else if((!p||g)&&v&&Qe.channels["2"]===0)return Ar(ut,"no renditions with stereo sound found"),$e;return Qe.minHeight>Fe?(Ar(ut,`min resolution of ${Qe.minHeight} > maximum of ${Fe}`),$e):Qe.minFramerate>Me?(Ar(ut,`min framerate of ${Qe.minFramerate} > maximum of ${Me}`),$e):ee.some(yt=>Qe.videoRanges[yt]>0)?Qe.maxScore<K?(Ar(ut,`max score of ${Qe.maxScore} < selected max of ${K}`),$e):$e&&(Us(ut)>=Us($e)||Qe.fragmentError>h[$e].fragmentError)?$e:(K=Qe.maxScore,ut):(Ar(ut,`no variants with VIDEO-RANGE of ${JSON.stringify(ee)} found`),$e)},void 0),videoRanges:ee,preferHDR:re,minFramerate:B,minBitrate:W}}function Ar(h,t){C.log(`[abr] start candidates with "${h}" ignored because ${t}`)}function Zr(h){return h.reduce((t,n)=>{let a=t.groups[n.groupId];a||(a=t.groups[n.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),a.tracks.push(n);const l=n.channels||"2";return a.channels[l]=(a.channels[l]||0)+1,a.hasDefault=a.hasDefault||n.default,a.hasAutoSelect=a.hasAutoSelect||n.autoselect,a.hasDefault&&(t.hasDefaultAudio=!0),a.hasAutoSelect&&(t.hasAutoSelectAudio=!0),t},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function ci(h,t,n,a){return h.slice(n,a+1).reduce((l,u)=>{if(!u.codecSet)return l;const d=u.audioGroups;let p=l[u.codecSet];p||(l[u.codecSet]=p={minBitrate:Infinity,minHeight:Infinity,minFramerate:Infinity,maxScore:0,videoRanges:{SDR:0},channels:{"2":0},hasDefaultAudio:!d,fragmentError:0}),p.minBitrate=Math.min(p.minBitrate,u.bitrate);const g=Math.min(u.height,u.width);return p.minHeight=Math.min(p.minHeight,g),p.minFramerate=Math.min(p.minFramerate,u.frameRate),p.maxScore=Math.max(p.maxScore,u.score),p.fragmentError+=u.fragmentError,p.videoRanges[u.videoRange]=(p.videoRanges[u.videoRange]||0)+1,d&&d.forEach(v=>{if(!v)return;const b=t.groups[v];!b||(p.hasDefaultAudio=p.hasDefaultAudio||t.hasDefaultAudio?b.hasDefault:b.hasAutoSelect||!t.hasDefaultAudio&&!t.hasAutoSelectAudio,Object.keys(b.channels).forEach(L=>{p.channels[L]=(p.channels[L]||0)+b.channels[L]}))}),l},{})}function Xn(h,t,n){if("attrs"in h){const a=t.indexOf(h);if(a!==-1)return a}for(let a=0;a<t.length;a++){const l=t[a];if(Es(h,l,n))return a}return-1}function Es(h,t,n){const{groupId:a,name:l,lang:u,assocLang:d,characteristics:p,default:g}=h,v=h.forced;return(a===void 0||t.groupId===a)&&(l===void 0||t.name===l)&&(u===void 0||t.lang===u)&&(u===void 0||t.assocLang===d)&&(g===void 0||t.default===g)&&(v===void 0||t.forced===v)&&(p===void 0||Ts(p,t.characteristics))&&(n===void 0||n(h,t))}function Ts(h,t=""){const n=h.split(","),a=t.split(",");return n.length===a.length&&!n.some(l=>a.indexOf(l)===-1)}function Qn(h,t){const{audioCodec:n,channels:a}=h;return(n===void 0||(t.audioCodec||"").substring(0,4)===n.substring(0,4))&&(a===void 0||a===(t.channels||"2"))}function Go(h,t,n,a,l){const u=t[a],p=t.reduce((B,W,K)=>{const ee=W.uri;return(B[ee]||(B[ee]=[])).push(K),B},{})[u.uri];p.length>1&&(a=Math.max.apply(Math,p));const g=u.videoRange,v=u.frameRate,b=u.codecSet.substring(0,4),L=Jn(t,a,B=>{if(B.videoRange!==g||B.frameRate!==v||B.codecSet.substring(0,4)!==b)return!1;const W=B.audioGroups,K=n.filter(ee=>!W||W.indexOf(ee.groupId)!==-1);return Xn(h,K,l)>-1});return L>-1?L:Jn(t,a,B=>{const W=B.audioGroups,K=n.filter(ee=>!W||W.indexOf(ee.groupId)!==-1);return Xn(h,K,l)>-1})}function Jn(h,t,n){for(let a=t;a;a--)if(n(h[a]))return a;for(let a=t+1;a<h.length;a++)if(n(h[a]))return a;return-1}class lr{constructor(t){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this._abandonRulesCheck=()=>{const{fragCurrent:n,partCurrent:a,hls:l}=this,{autoLevelEnabled:u,media:d}=l;if(!n||!d)return;const p=performance.now(),g=a?a.stats:n.stats,v=a?a.duration:n.duration,b=p-g.loading.start,L=l.minAutoLevel;if(g.aborted||g.loaded&&g.loaded===g.total||n.level<=L){this.clearTimer(),this._nextAutoLevel=-1;return}if(!u||d.paused||!d.playbackRate||!d.readyState)return;const B=l.mainForwardBufferInfo;if(B===null)return;const W=this.bwEstimator.getEstimateTTFB(),K=Math.abs(d.playbackRate);if(b<=Math.max(W,1e3*(v/(K*2))))return;const ee=B.len/K,re=g.loading.first?g.loading.first-g.loading.start:-1,xe=g.loaded&&re>-1,Fe=this.getBwEstimate(),Me=l.levels,it=Me[n.level],$e=g.total||Math.max(g.loaded,Math.round(v*it.averageBitrate/8));let ut=xe?b-re:b;ut<1&&xe&&(ut=Math.min(b,g.loaded*8/Fe));const Qe=xe?g.loaded*1e3/ut:0,yt=Qe?($e-g.loaded)/Qe:$e*8/Fe+W/1e3;if(yt<=ee)return;const xt=Qe?Qe*8:Fe;let ot=Number.POSITIVE_INFINITY,At;for(At=n.level-1;At>L;At--){const Pt=Me[At].maxBitrate;if(ot=this.getTimeToLoadFrag(W/1e3,xt,v*Pt,!Me[At].details),ot<ee)break}if(ot>=yt||ot>v*10)return;l.nextLoadLevel=l.nextAutoLevel=At,xe?this.bwEstimator.sample(b-Math.min(W,re),g.loaded):this.bwEstimator.sampleTTFB(b);const Re=Me[At].maxBitrate;this.getBwEstimate()*this.hls.config.abrBandWidthUpFactor>Re&&this.resetEstimator(Re),this.clearTimer(),C.warn(`[abr] Fragment ${n.sn}${a?" part "+a.index:""} of level ${n.level} is loading too slowly;
      Time to underbuffer: ${ee.toFixed(3)} s
      Estimated load time for current fragment: ${yt.toFixed(3)} s
      Estimated load time for down switch fragment: ${ot.toFixed(3)} s
      TTFB estimate: ${re|0} ms
      Current BW estimate: ${te(Fe)?Fe|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${At} @ ${Re|0} bps`),l.trigger(A.FRAG_LOAD_EMERGENCY_ABORTED,{frag:n,part:a,stats:g})},this.hls=t,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(t){t&&(C.log(`setting initial bwe to ${t}`),this.hls.config.abrEwmaDefaultEstimate=t),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const t=this.hls.config;return new Br(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate)}registerListeners(){const{hls:t}=this;t.on(A.MANIFEST_LOADING,this.onManifestLoading,this),t.on(A.FRAG_LOADING,this.onFragLoading,this),t.on(A.FRAG_LOADED,this.onFragLoaded,this),t.on(A.FRAG_BUFFERED,this.onFragBuffered,this),t.on(A.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(A.LEVEL_LOADED,this.onLevelLoaded,this),t.on(A.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(A.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),t.on(A.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;!t||(t.off(A.MANIFEST_LOADING,this.onManifestLoading,this),t.off(A.FRAG_LOADING,this.onFragLoading,this),t.off(A.FRAG_LOADED,this.onFragLoaded,this),t.off(A.FRAG_BUFFERED,this.onFragBuffered,this),t.off(A.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(A.LEVEL_LOADED,this.onLevelLoaded,this),t.off(A.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(A.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),t.off(A.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(t,n){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(t,n){const a=n.frag;if(!this.ignoreFragment(a)){if(!a.bitrateTest){var l;this.fragCurrent=a,this.partCurrent=(l=n.part)!=null?l:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(t,n){this.clearTimer()}onError(t,n){if(!n.fatal)switch(n.details){case k.BUFFER_ADD_CODEC_ERROR:case k.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case k.FRAG_LOAD_TIMEOUT:{const a=n.frag,{fragCurrent:l,partCurrent:u}=this;if(a&&l&&a.sn===l.sn&&a.level===l.level){const d=performance.now(),p=u?u.stats:a.stats,g=d-p.loading.start,v=p.loading.first?p.loading.first-p.loading.start:-1;if(p.loaded&&v>-1){const L=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(g-Math.min(L,v),p.loaded)}else this.bwEstimator.sampleTTFB(g)}break}}}getTimeToLoadFrag(t,n,a,l){const u=t+a/n,d=l?this.lastLevelLoadSec:0;return u+d}onLevelLoaded(t,n){const a=this.hls.config,{loading:l}=n.stats,u=l.end-l.start;te(u)&&(this.lastLevelLoadSec=u/1e3),n.details.live?this.bwEstimator.update(a.abrEwmaSlowLive,a.abrEwmaFastLive):this.bwEstimator.update(a.abrEwmaSlowVoD,a.abrEwmaFastVoD)}onFragLoaded(t,{frag:n,part:a}){const l=a?a.stats:n.stats;if(n.type===qt.MAIN&&this.bwEstimator.sampleTTFB(l.loading.first-l.loading.start),!this.ignoreFragment(n)){if(this.clearTimer(),n.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const u=a?a.duration:n.duration,d=this.hls.levels[n.level],p=(d.loaded?d.loaded.bytes:0)+l.loaded,g=(d.loaded?d.loaded.duration:0)+u;d.loaded={bytes:p,duration:g},d.realBitrate=Math.round(8*p/g)}if(n.bitrateTest){const u={stats:l,frag:n,part:a,id:n.type};this.onFragBuffered(A.FRAG_BUFFERED,u),n.bitrateTest=!1}else this.lastLoadedFragLevel=n.level}}onFragBuffered(t,n){const{frag:a,part:l}=n,u=l!=null&&l.stats.loaded?l.stats:a.stats;if(u.aborted||this.ignoreFragment(a))return;const d=u.parsing.end-u.loading.start-Math.min(u.loading.first-u.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(d,u.loaded),u.bwEstimate=this.getBwEstimate(),a.bitrateTest?this.bitrateTestDelay=d/1e3:this.bitrateTestDelay=0}ignoreFragment(t){return t.type!==qt.MAIN||t.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:t,minAutoLevel:n}=this.hls,a=this.getBwEstimate(),l=this.hls.config.maxStarvationDelay,u=this.findBestLevel(a,n,t,0,l,1,1);if(u>-1)return u;const d=this.hls.firstLevel,p=Math.min(Math.max(d,n),t);return C.warn(`[abr] Could not find best starting auto level. Defaulting to first in playlist ${d} clamped to ${p}`),p}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const t=this.forcedAutoLevel,a=this.bwEstimator.canEstimate(),l=this.lastLoadedFragLevel>-1;if(t!==-1&&(!a||!l||this.nextAutoLevelKey===this.getAutoLevelKey()))return t;const u=a&&l?this.getNextABRAutoLevel():this.firstAutoLevel;if(t!==-1){const d=this.hls.levels;if(d.length>Math.max(t,u)&&d[t].loadError<=d[u].loadError)return t}return this._nextAutoLevel=u,this.nextAutoLevelKey=this.getAutoLevelKey(),u}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:t,partCurrent:n,hls:a}=this,{maxAutoLevel:l,config:u,minAutoLevel:d}=a,p=n?n.duration:t?t.duration:0,g=this.getBwEstimate(),v=this.getStarvationDelay();let b=u.abrBandWidthFactor,L=u.abrBandWidthUpFactor;if(v){const re=this.findBestLevel(g,d,l,v,0,b,L);if(re>=0)return re}let B=p?Math.min(p,u.maxStarvationDelay):u.maxStarvationDelay;if(!v){const re=this.bitrateTestDelay;re&&(B=(p?Math.min(p,u.maxLoadingDelay):u.maxLoadingDelay)-re,C.info(`[abr] bitrate test took ${Math.round(1e3*re)}ms, set first fragment max fetchDuration to ${Math.round(1e3*B)} ms`),b=L=1)}const W=this.findBestLevel(g,d,l,v,B,b,L);if(C.info(`[abr] ${v?"rebuffering expected":"buffer is empty"}, optimal quality level ${W}`),W>-1)return W;const K=a.levels[d],ee=a.levels[a.loadLevel];return(K==null?void 0:K.bitrate)<(ee==null?void 0:ee.bitrate)?d:a.loadLevel}getStarvationDelay(){const t=this.hls,n=t.media;if(!n)return Infinity;const a=n&&n.playbackRate!==0?Math.abs(n.playbackRate):1,l=t.mainForwardBufferInfo;return(l?l.len:0)/a}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(t,n,a,l,u,d,p){var g;const v=l+u,b=this.lastLoadedFragLevel,L=b===-1?this.hls.firstLevel:b,{fragCurrent:B,partCurrent:W}=this,{levels:K,allAudioTracks:ee,loadLevel:re,config:xe}=this.hls;if(K.length===1)return 0;const Fe=K[L],Me=!!(Fe!=null&&(g=Fe.details)!=null&&g.live),it=re===-1||b===-1;let $e,ut="SDR",Qe=(Fe==null?void 0:Fe.frameRate)||0;const{audioPreference:yt,videoPreference:xt}=xe,ot=this.audioTracksByGroup||(this.audioTracksByGroup=Zr(ee));if(it){if(this.firstSelection!==-1)return this.firstSelection;const ri=this.codecTiers||(this.codecTiers=ci(K,ot,n,a)),Qt=Cn(ri,ut,t,yt,xt),{codecSet:gi,videoRanges:li,minFramerate:Ft,minBitrate:St,preferHDR:$t}=Qt;$e=gi,ut=$t?li[li.length-1]:li[0],Qe=Ft,t=Math.max(t,St),C.log(`[abr] picked start tier ${JSON.stringify(Qt)}`)}else $e=Fe==null?void 0:Fe.codecSet,ut=Fe==null?void 0:Fe.videoRange;const At=W?W.duration:B?B.duration:0,Re=this.bwEstimator.getEstimateTTFB()/1e3,Pt=[];for(let ri=a;ri>=n;ri--){var ii;const Qt=K[ri],gi=ri>L;if(!Qt)continue;if(xe.useMediaCapabilities&&!Qt.supportedResult&&!Qt.supportedPromise){const Li=navigator.mediaCapabilities;typeof(Li==null?void 0:Li.decodingInfo)=="function"&&$l(Qt,ot,ut,Qe,t,yt)?(Qt.supportedPromise=xa(Qt,ot,Li),Qt.supportedPromise.then(Pi=>{if(!this.hls)return;Qt.supportedResult=Pi;const vn=this.hls.levels,xn=vn.indexOf(Qt);Pi.error?C.warn(`[abr] MediaCapabilities decodingInfo error: "${Pi.error}" for level ${xn} ${JSON.stringify(Pi)}`):Pi.supported||(C.warn(`[abr] Unsupported MediaCapabilities decodingInfo result for level ${xn} ${JSON.stringify(Pi)}`),xn>-1&&vn.length>1&&(C.log(`[abr] Removing unsupported level ${xn}`),this.hls.removeLevel(xn)))})):Qt.supportedResult=Ho}if($e&&Qt.codecSet!==$e||ut&&Qt.videoRange!==ut||gi&&Qe>Qt.frameRate||!gi&&Qe>0&&Qe<Qt.frameRate||Qt.supportedResult&&!((ii=Qt.supportedResult.decodingInfoResults)!=null&&ii[0].smooth)){Pt.push(ri);continue}const li=Qt.details,Ft=(W?li==null?void 0:li.partTarget:li==null?void 0:li.averagetargetduration)||At;let St;gi?St=p*t:St=d*t;const $t=At&&l>=At*2&&u===0?K[ri].averageBitrate:K[ri].maxBitrate,zt=this.getTimeToLoadFrag(Re,St,$t*Ft,li===void 0);if(St>=$t&&(ri===b||Qt.loadError===0&&Qt.fragmentError===0)&&(zt<=Re||!te(zt)||Me&&!this.bitrateTestDelay||zt<v)){const Li=this.forcedAutoLevel;return ri!==re&&(Li===-1||Li!==re)&&(Pt.length&&C.trace(`[abr] Skipped level(s) ${Pt.join(",")} of ${a} max with CODECS and VIDEO-RANGE:"${K[Pt[0]].codecs}" ${K[Pt[0]].videoRange}; not compatible with "${Fe.codecs}" ${ut}`),C.info(`[abr] switch candidate:${L}->${ri} adjustedbw(${Math.round(St)})-bitrate=${Math.round(St-$t)} ttfb:${Re.toFixed(1)} avgDuration:${Ft.toFixed(1)} maxFetchDuration:${v.toFixed(1)} fetchDuration:${zt.toFixed(1)} firstSelection:${it} codecSet:${$e} videoRange:${ut} hls.loadLevel:${re}`)),it&&(this.firstSelection=ri),ri}}return-1}set nextAutoLevel(t){const{maxAutoLevel:n,minAutoLevel:a}=this.hls,l=Math.min(Math.max(t,a),n);this._nextAutoLevel!==l&&(this.nextAutoLevelKey="",this._nextAutoLevel=l)}}class Si{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(t){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,t),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}var sn={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class Mr{constructor(t){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=t,this._registerListeners()}_registerListeners(){const{hls:t}=this;t.on(A.BUFFER_APPENDED,this.onBufferAppended,this),t.on(A.FRAG_BUFFERED,this.onFragBuffered,this),t.on(A.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:t}=this;t.off(A.BUFFER_APPENDED,this.onBufferAppended,this),t.off(A.FRAG_BUFFERED,this.onFragBuffered,this),t.off(A.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(t,n){const a=this.activePartLists[n];if(a)for(let l=a.length;l--;){const u=a[l];if(!u)break;const d=u.end;if(u.start<=t&&d!==null&&t<=d)return u}return this.getBufferedFrag(t,n)}getBufferedFrag(t,n){const{fragments:a}=this,l=Object.keys(a);for(let u=l.length;u--;){const d=a[l[u]];if((d==null?void 0:d.body.type)===n&&d.buffered){const p=d.body;if(p.start<=t&&t<=p.end)return p}}return null}detectEvictedFragments(t,n,a,l){this.timeRanges&&(this.timeRanges[t]=n);const u=(l==null?void 0:l.fragment.sn)||-1;Object.keys(this.fragments).forEach(d=>{const p=this.fragments[d];if(!p||u>=p.body.sn)return;if(!p.buffered&&!p.loaded){p.body.type===a&&this.removeFragment(p.body);return}const g=p.range[t];!g||g.time.some(v=>{const b=!this.isTimeBuffered(v.startPTS,v.endPTS,n);return b&&this.removeFragment(p.body),b})})}detectPartialFragments(t){const n=this.timeRanges,{frag:a,part:l}=t;if(!n||a.sn==="initSegment")return;const u=Fr(a),d=this.fragments[u];if(!d||d.buffered&&a.gap)return;const p=!a.relurl;Object.keys(n).forEach(g=>{const v=a.elementaryStreams[g];if(!v)return;const b=n[g],L=p||v.partial===!0;d.range[g]=this.getBufferedTimes(a,l,L,b)}),d.loaded=null,Object.keys(d.range).length?(d.buffered=!0,(d.body.endList=a.endList||d.body.endList)&&(this.endListFragments[d.body.type]=d),Ta(d)||this.removeParts(a.sn-1,a.type)):this.removeFragment(d.body)}removeParts(t,n){const a=this.activePartLists[n];!a||(this.activePartLists[n]=a.filter(l=>l.fragment.sn>=t))}fragBuffered(t,n){const a=Fr(t);let l=this.fragments[a];!l&&n&&(l=this.fragments[a]={body:t,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},t.gap&&(this.hasGaps=!0)),l&&(l.loaded=null,l.buffered=!0)}getBufferedTimes(t,n,a,l){const u={time:[],partial:a},d=t.start,p=t.end,g=t.minEndPTS||p,v=t.maxStartPTS||d;for(let b=0;b<l.length;b++){const L=l.start(b)-this.bufferPadding,B=l.end(b)+this.bufferPadding;if(v>=L&&g<=B){u.time.push({startPTS:Math.max(d,l.start(b)),endPTS:Math.min(p,l.end(b))});break}else if(d<B&&p>L){const W=Math.max(d,l.start(b)),K=Math.min(p,l.end(b));K>W&&(u.partial=!0,u.time.push({startPTS:W,endPTS:K}))}else if(p<=L)break}return u}getPartialFragment(t){let n=null,a,l,u,d=0;const{bufferPadding:p,fragments:g}=this;return Object.keys(g).forEach(v=>{const b=g[v];!b||Ta(b)&&(l=b.body.start-p,u=b.body.end+p,t>=l&&t<=u&&(a=Math.min(t-l,u-t),d<=a&&(n=b.body,d=a)))}),n}isEndListAppended(t){const n=this.endListFragments[t];return n!==void 0&&(n.buffered||Ta(n))}getState(t){const n=Fr(t),a=this.fragments[n];return a?a.buffered?Ta(a)?sn.PARTIAL:sn.OK:sn.APPENDING:sn.NOT_LOADED}isTimeBuffered(t,n,a){let l,u;for(let d=0;d<a.length;d++){if(l=a.start(d)-this.bufferPadding,u=a.end(d)+this.bufferPadding,t>=l&&n<=u)return!0;if(n<=l)return!1}return!1}onFragLoaded(t,n){const{frag:a,part:l}=n;if(a.sn==="initSegment"||a.bitrateTest)return;const u=l?null:n,d=Fr(a);this.fragments[d]={body:a,appendedPTS:null,loaded:u,buffered:!1,range:Object.create(null)}}onBufferAppended(t,n){const{frag:a,part:l,timeRanges:u}=n;if(a.sn==="initSegment")return;const d=a.type;if(l){let p=this.activePartLists[d];p||(this.activePartLists[d]=p=[]),p.push(l)}this.timeRanges=u,Object.keys(u).forEach(p=>{const g=u[p];this.detectEvictedFragments(p,g,d,l)})}onFragBuffered(t,n){this.detectPartialFragments(n)}hasFragment(t){const n=Fr(t);return!!this.fragments[n]}hasParts(t){var n;return!!((n=this.activePartLists[t])!=null&&n.length)}removeFragmentsInRange(t,n,a,l,u){l&&!this.hasGaps||Object.keys(this.fragments).forEach(d=>{const p=this.fragments[d];if(!p)return;const g=p.body;g.type!==a||l&&!g.gap||g.start<n&&g.end>t&&(p.buffered||u)&&this.removeFragment(g)})}removeFragment(t){const n=Fr(t);t.stats.loaded=0,t.clearElementaryStreamInfo();const a=this.activePartLists[t.type];if(a){const l=t.sn;this.activePartLists[t.type]=a.filter(u=>u.fragment.sn!==l)}delete this.fragments[n],t.endList&&delete this.endListFragments[t.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function Ta(h){var t,n,a;return h.buffered&&(h.body.gap||((t=h.range.video)==null?void 0:t.partial)||((n=h.range.audio)==null?void 0:n.partial)||((a=h.range.audiovideo)==null?void 0:a.partial))}function Fr(h){return`${h.type}_${h.level}_${h.sn}`}const qo={length:0,start:()=>0,end:()=>0};class oi{static isBuffered(t,n){try{if(t){const a=oi.getBuffered(t);for(let l=0;l<a.length;l++)if(n>=a.start(l)&&n<=a.end(l))return!0}}catch(a){}return!1}static bufferInfo(t,n,a){try{if(t){const l=oi.getBuffered(t),u=[];let d;for(d=0;d<l.length;d++)u.push({start:l.start(d),end:l.end(d)});return this.bufferedInfo(u,n,a)}}catch(l){}return{len:0,start:n,end:n,nextStart:void 0}}static bufferedInfo(t,n,a){n=Math.max(0,n),t.sort(function(v,b){const L=v.start-b.start;return L||b.end-v.end});let l=[];if(a)for(let v=0;v<t.length;v++){const b=l.length;if(b){const L=l[b-1].end;t[v].start-L<a?t[v].end>L&&(l[b-1].end=t[v].end):l.push(t[v])}else l.push(t[v])}else l=t;let u=0,d,p=n,g=n;for(let v=0;v<l.length;v++){const b=l[v].start,L=l[v].end;if(n+a>=b&&n<L)p=b,g=L,u=g-n;else if(n+a<b){d=b;break}}return{len:u,start:p||0,end:g||0,nextStart:d}}static getBuffered(t){try{return t.buffered}catch(n){return C.log("failed to get media.buffered",n),qo}}}class Sa{constructor(t,n,a,l=0,u=-1,d=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=$n(),this.buffering={audio:$n(),video:$n(),audiovideo:$n()},this.level=t,this.sn=n,this.id=a,this.size=l,this.part=u,this.partial=d}}function $n(){return{start:0,executeStart:0,executeEnd:0,end:0}}function ur(h,t){for(let a=0,l=h.length;a<l;a++){var n;if(((n=h[a])==null?void 0:n.cc)===t)return h[a]}return null}function Nr(h,t,n){return!!(t&&(n.endCC>n.startCC||h&&h.cc<n.startCC))}function dr(h,t){const n=h.fragments,a=t.fragments;if(!a.length||!n.length){C.log("No fragments to align");return}const l=ur(n,a[0].cc);if(!l||l&&!l.startPTS){C.log("No frag in previous level to align on");return}return l}function Ca(h,t){if(h){const n=h.start+t;h.start=h.startPTS=n,h.endPTS=n+h.duration}}function _r(h,t){const n=t.fragments;for(let a=0,l=n.length;a<l;a++)Ca(n[a],h);t.fragmentHint&&Ca(t.fragmentHint,h),t.alignedSliding=!0}function Vl(h,t,n){!t||(zo(h,n,t),!n.alignedSliding&&t&&es(n,t),!n.alignedSliding&&t&&!n.skippedSegments&&Pr(t,n))}function zo(h,t,n){if(Nr(h,n,t)){const a=dr(n,t);a&&te(a.start)&&(C.log(`Adjusting PTS using last level due to CC increase within current level ${t.url}`),_r(a.start,t))}}function es(h,t){if(!h.hasProgramDateTime||!t.hasProgramDateTime)return;const n=h.fragments,a=t.fragments;if(!n.length||!a.length)return;let l,u;const d=Math.min(t.endCC,h.endCC);t.startCC<d&&h.startCC<d&&(l=ur(a,d),u=ur(n,d)),(!l||!u)&&(l=a[Math.floor(a.length/2)],u=ur(n,l.cc)||n[Math.floor(n.length/2)]);const p=l.programDateTime,g=u.programDateTime;if(!p||!g)return;const v=(g-p)/1e3-(u.start-l.start);_r(v,h)}const br=Math.pow(2,17);class wa{constructor(t){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=t}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(t,n){const a=t.url;if(!a)return Promise.reject(new gn({type:M.NETWORK_ERROR,details:k.FRAG_LOAD_ERROR,fatal:!1,frag:t,error:new Error(`Fragment does not have a ${a?"part list":"url"}`),networkDetails:null}));this.abort();const l=this.config,u=l.fLoader,d=l.loader;return new Promise((p,g)=>{if(this.loader&&this.loader.destroy(),t.gap)if(t.tagList.some(W=>W[0]==="GAP")){g(Ys(t));return}else t.gap=!1;const v=this.loader=t.loader=u?new u(l):new d(l),b=Ks(t),L=Vo(l.fragLoadPolicy.default),B={loadPolicy:L,timeout:L.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:t.sn==="initSegment"?Infinity:br};t.stats=v.stats,v.load(b,B,{onSuccess:(W,K,ee,re)=>{this.resetLoader(t,v);let xe=W.data;ee.resetIV&&t.decryptdata&&(t.decryptdata.iv=new Uint8Array(xe.slice(0,16)),xe=xe.slice(16)),p({frag:t,part:null,payload:xe,networkDetails:re})},onError:(W,K,ee,re)=>{this.resetLoader(t,v),g(new gn({type:M.NETWORK_ERROR,details:k.FRAG_LOAD_ERROR,fatal:!1,frag:t,response:ze({url:a,data:void 0},W),error:new Error(`HTTP Error ${W.code} ${W.text}`),networkDetails:ee,stats:re}))},onAbort:(W,K,ee)=>{this.resetLoader(t,v),g(new gn({type:M.NETWORK_ERROR,details:k.INTERNAL_ABORTED,fatal:!1,frag:t,error:new Error("Aborted"),networkDetails:ee,stats:W}))},onTimeout:(W,K,ee)=>{this.resetLoader(t,v),g(new gn({type:M.NETWORK_ERROR,details:k.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,error:new Error(`Timeout after ${B.timeout}ms`),networkDetails:ee,stats:W}))},onProgress:(W,K,ee,re)=>{n&&n({frag:t,part:null,payload:ee,networkDetails:re})}})})}loadPart(t,n,a){this.abort();const l=this.config,u=l.fLoader,d=l.loader;return new Promise((p,g)=>{if(this.loader&&this.loader.destroy(),t.gap||n.gap){g(Ys(t,n));return}const v=this.loader=t.loader=u?new u(l):new d(l),b=Ks(t,n),L=Vo(l.fragLoadPolicy.default),B={loadPolicy:L,timeout:L.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:br};n.stats=v.stats,v.load(b,B,{onSuccess:(W,K,ee,re)=>{this.resetLoader(t,v),this.updateStatsFromPart(t,n);const xe={frag:t,part:n,payload:W.data,networkDetails:re};a(xe),p(xe)},onError:(W,K,ee,re)=>{this.resetLoader(t,v),g(new gn({type:M.NETWORK_ERROR,details:k.FRAG_LOAD_ERROR,fatal:!1,frag:t,part:n,response:ze({url:b.url,data:void 0},W),error:new Error(`HTTP Error ${W.code} ${W.text}`),networkDetails:ee,stats:re}))},onAbort:(W,K,ee)=>{t.stats.aborted=n.stats.aborted,this.resetLoader(t,v),g(new gn({type:M.NETWORK_ERROR,details:k.INTERNAL_ABORTED,fatal:!1,frag:t,part:n,error:new Error("Aborted"),networkDetails:ee,stats:W}))},onTimeout:(W,K,ee)=>{this.resetLoader(t,v),g(new gn({type:M.NETWORK_ERROR,details:k.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,part:n,error:new Error(`Timeout after ${B.timeout}ms`),networkDetails:ee,stats:W}))}})})}updateStatsFromPart(t,n){const a=t.stats,l=n.stats,u=l.total;if(a.loaded+=l.loaded,u){const g=Math.round(t.duration/n.duration),v=Math.min(Math.round(a.loaded/u),g),L=(g-v)*Math.round(a.loaded/v);a.total=a.loaded+L}else a.total=Math.max(a.loaded,a.total);const d=a.loading,p=l.loading;d.start?d.first+=p.first-p.start:(d.start=p.start,d.first=p.first),d.end=p.end}resetLoader(t,n){t.loader=null,this.loader===n&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),n.destroy()}}function Ks(h,t=null){const n=t||h,a={frag:h,part:t,responseType:"arraybuffer",url:n.url,headers:{},rangeStart:0,rangeEnd:0},l=n.byteRangeStartOffset,u=n.byteRangeEndOffset;if(te(l)&&te(u)){var d;let p=l,g=u;if(h.sn==="initSegment"&&((d=h.decryptdata)==null?void 0:d.method)==="AES-128"){const v=u-l;v%16&&(g=u+(16-v%16)),l!==0&&(a.resetIV=!0,p=l-16)}a.rangeStart=p,a.rangeEnd=g}return a}function Ys(h,t){const n=new Error(`GAP ${h.gap?"tag":"attribute"} found`),a={type:M.MEDIA_ERROR,details:k.FRAG_GAP,fatal:!1,frag:h,error:n,networkDetails:null};return t&&(a.part=t),(t||h).stats.aborted=!0,new gn(a)}class gn extends Error{constructor(t){super(t.error.message);this.data=void 0,this.data=t}}class no{constructor(t,n){this.subtle=void 0,this.aesIV=void 0,this.subtle=t,this.aesIV=n}decrypt(t,n){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},n,t)}}class Xs{constructor(t,n){this.subtle=void 0,this.key=void 0,this.subtle=t,this.key=n}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}function Ur(h){const t=h.byteLength,n=t&&new DataView(h.buffer).getUint8(t-1);return n?ui(h,0,t-n):h}class an{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(t){const n=new DataView(t),a=new Uint32Array(4);for(let l=0;l<4;l++)a[l]=n.getUint32(l*4);return a}initTable(){const t=this.sBox,n=this.invSBox,a=this.subMix,l=a[0],u=a[1],d=a[2],p=a[3],g=this.invSubMix,v=g[0],b=g[1],L=g[2],B=g[3],W=new Uint32Array(256);let K=0,ee=0,re=0;for(re=0;re<256;re++)re<128?W[re]=re<<1:W[re]=re<<1^283;for(re=0;re<256;re++){let xe=ee^ee<<1^ee<<2^ee<<3^ee<<4;xe=xe>>>8^xe&255^99,t[K]=xe,n[xe]=K;const Fe=W[K],Me=W[Fe],it=W[Me];let $e=W[xe]*257^xe*16843008;l[K]=$e<<24|$e>>>8,u[K]=$e<<16|$e>>>16,d[K]=$e<<8|$e>>>24,p[K]=$e,$e=it*16843009^Me*65537^Fe*257^K*16843008,v[xe]=$e<<24|$e>>>8,b[xe]=$e<<16|$e>>>16,L[xe]=$e<<8|$e>>>24,B[xe]=$e,K?(K=Fe^W[W[W[it^Fe]]],ee^=W[W[ee]]):K=ee=1}}expandKey(t){const n=this.uint8ArrayToUint32Array_(t);let a=!0,l=0;for(;l<n.length&&a;)a=n[l]===this.key[l],l++;if(a)return;this.key=n;const u=this.keySize=n.length;if(u!==4&&u!==6&&u!==8)throw new Error("Invalid aes key size="+u);const d=this.ksRows=(u+6+1)*4;let p,g;const v=this.keySchedule=new Uint32Array(d),b=this.invKeySchedule=new Uint32Array(d),L=this.sBox,B=this.rcon,W=this.invSubMix,K=W[0],ee=W[1],re=W[2],xe=W[3];let Fe,Me;for(p=0;p<d;p++){if(p<u){Fe=v[p]=n[p];continue}Me=Fe,p%u==0?(Me=Me<<8|Me>>>24,Me=L[Me>>>24]<<24|L[Me>>>16&255]<<16|L[Me>>>8&255]<<8|L[Me&255],Me^=B[p/u|0]<<24):u>6&&p%u==4&&(Me=L[Me>>>24]<<24|L[Me>>>16&255]<<16|L[Me>>>8&255]<<8|L[Me&255]),v[p]=Fe=(v[p-u]^Me)>>>0}for(g=0;g<d;g++)p=d-g,g&3?Me=v[p]:Me=v[p-4],g<4||p<=4?b[g]=Me:b[g]=K[L[Me>>>24]]^ee[L[Me>>>16&255]]^re[L[Me>>>8&255]]^xe[L[Me&255]],b[g]=b[g]>>>0}networkToHostOrderSwap(t){return t<<24|(t&65280)<<8|(t&16711680)>>8|t>>>24}decrypt(t,n,a){const l=this.keySize+6,u=this.invKeySchedule,d=this.invSBox,p=this.invSubMix,g=p[0],v=p[1],b=p[2],L=p[3],B=this.uint8ArrayToUint32Array_(a);let W=B[0],K=B[1],ee=B[2],re=B[3];const xe=new Int32Array(t),Fe=new Int32Array(xe.length);let Me,it,$e,ut,Qe,yt,xt,ot,At,Re,Pt,ii,ri,Qt;const gi=this.networkToHostOrderSwap;for(;n<xe.length;){for(At=gi(xe[n]),Re=gi(xe[n+1]),Pt=gi(xe[n+2]),ii=gi(xe[n+3]),Qe=At^u[0],yt=ii^u[1],xt=Pt^u[2],ot=Re^u[3],ri=4,Qt=1;Qt<l;Qt++)Me=g[Qe>>>24]^v[yt>>16&255]^b[xt>>8&255]^L[ot&255]^u[ri],it=g[yt>>>24]^v[xt>>16&255]^b[ot>>8&255]^L[Qe&255]^u[ri+1],$e=g[xt>>>24]^v[ot>>16&255]^b[Qe>>8&255]^L[yt&255]^u[ri+2],ut=g[ot>>>24]^v[Qe>>16&255]^b[yt>>8&255]^L[xt&255]^u[ri+3],Qe=Me,yt=it,xt=$e,ot=ut,ri=ri+4;Me=d[Qe>>>24]<<24^d[yt>>16&255]<<16^d[xt>>8&255]<<8^d[ot&255]^u[ri],it=d[yt>>>24]<<24^d[xt>>16&255]<<16^d[ot>>8&255]<<8^d[Qe&255]^u[ri+1],$e=d[xt>>>24]<<24^d[ot>>16&255]<<16^d[Qe>>8&255]<<8^d[yt&255]^u[ri+2],ut=d[ot>>>24]<<24^d[Qe>>16&255]<<16^d[yt>>8&255]<<8^d[xt&255]^u[ri+3],Fe[n]=gi(Me^W),Fe[n+1]=gi(ut^K),Fe[n+2]=gi($e^ee),Fe[n+3]=gi(it^re),W=At,K=Re,ee=Pt,re=ii,n=n+4}return Fe.buffer}}const La=16;class Da{constructor(t,{removePKCS7Padding:n=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=t.enableSoftwareAES,this.removePKCS7Padding=n,n)try{const a=self.crypto;a&&(this.subtle=a.subtle||a.webkitSubtle)}catch(a){}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:t,remainderData:n}=this;if(!t||n)return this.reset(),null;const a=new Uint8Array(t);return this.reset(),this.removePKCS7Padding?Ur(a):a}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(t,n,a){return this.useSoftware?new Promise((l,u)=>{this.softwareDecrypt(new Uint8Array(t),n,a);const d=this.flush();d?l(d.buffer):u(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(t),n,a)}softwareDecrypt(t,n,a){const{currentIV:l,currentResult:u,remainderData:d}=this;this.logOnce("JS AES decrypt"),d&&(t=ft(d,t),this.remainderData=null);const p=this.getValidChunk(t);if(!p.length)return null;l&&(a=l);let g=this.softwareDecrypter;g||(g=this.softwareDecrypter=new an),g.expandKey(n);const v=u;return this.currentResult=g.decrypt(p.buffer,0,a),this.currentIV=ui(p,-16).buffer,v||null}webCryptoDecrypt(t,n,a){if(this.key!==n||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(t,n,a));this.key=n,this.fastAesKey=new Xs(this.subtle,n)}return this.fastAesKey.expandKey().then(l=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new no(this.subtle,new Uint8Array(a)).decrypt(t.buffer,l)):Promise.reject(new Error("web crypto not initialized"))).catch(l=>(C.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${l.name}: ${l.message}`),this.onWebCryptoError(t,n,a)))}onWebCryptoError(t,n,a){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(t,n,a);const l=this.flush();if(l)return l.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(t){let n=t;const a=t.length-t.length%La;return a!==t.length&&(n=ui(t,0,a),this.remainderData=ui(t,a)),n}logOnce(t){!this.logEnabled||(C.log(`[decrypter]: ${t}`),this.logEnabled=!1)}}const Wo={toString:function(h){let t="";const n=h.length;for(let a=0;a<n;a++)t+=`[${h.start(a).toFixed(3)}-${h.end(a).toFixed(3)}]`;return t}},st={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class jr extends Si{constructor(t,n,a,l,u){super();this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=st.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=u,this.logPrefix=l,this.log=C.log.bind(C,`${l}:`),this.warn=C.warn.bind(C,`${l}:`),this.hls=t,this.fragmentLoader=new wa(t.config),this.keyLoader=a,this.fragmentTracker=n,this.config=t.config,this.decrypter=new Da(t.config),t.on(A.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(t){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const t=this.fragCurrent;t!=null&&t.loader&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=st.STOPPED}_streamEnded(t,n){if(n.live||t.nextStart||!t.end||!this.media)return!1;const a=n.partList;if(a!=null&&a.length){const u=a[a.length-1];return oi.isBuffered(this.media,u.start+u.duration/2)}const l=n.fragments[n.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(l)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var t;return(t=this.levelLastLoaded)==null?void 0:t.details}}onMediaAttached(t,n){const a=this.media=this.mediaBuffer=n.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),a.addEventListener("seeking",this.onvseeking),a.addEventListener("ended",this.onvended);const l=this.config;this.levels&&l.autoStartLoad&&this.state===st.STOPPED&&this.startLoad(l.startPosition)}onMediaDetaching(){const t=this.media;t!=null&&t.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),t&&this.onvseeking&&this.onvended&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:t,fragCurrent:n,media:a,mediaBuffer:l,state:u}=this,d=a?a.currentTime:0,p=oi.bufferInfo(l||a,d,t.maxBufferHole);if(this.log(`media seeking to ${te(d)?d.toFixed(3):d}, state: ${u}`),this.state===st.ENDED)this.resetLoadingState();else if(n){const g=t.maxFragLookUpTolerance,v=n.start-g,b=n.start+n.duration+g;if(!p.len||b<p.start||v>p.end){const L=d>b;(d<v||L)&&(L&&n.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),n.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}a&&(this.fragmentTracker.removeFragmentsInRange(d,Infinity,this.playlistType,!0),this.lastCurrentTime=d),!this.loadedmetadata&&!p.len&&(this.nextLoadPosition=this.startPosition=d),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(t,n){this.startTimeOffset=n.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.hls.off(A.MANIFEST_LOADED,this.onManifestLoaded,this),this.stopLoad(),super.onHandlerDestroying(),this.hls=null}onHandlerDestroyed(){this.state=st.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(t,n,a){this._loadFragForPlayback(t,n,a)}_loadFragForPlayback(t,n,a){const l=u=>{if(this.fragContextChanged(t)){this.warn(`Fragment ${t.sn}${u.part?" p: "+u.part.index:""} of level ${t.level} was dropped during download.`),this.fragmentTracker.removeFragment(t);return}t.stats.chunkCount++,this._handleFragmentLoadProgress(u)};this._doFragLoad(t,n,a,l).then(u=>{if(!u)return;const d=this.state;if(this.fragContextChanged(t)){(d===st.FRAG_LOADING||!this.fragCurrent&&d===st.PARSING)&&(this.fragmentTracker.removeFragment(t),this.state=st.IDLE);return}"payload"in u&&(this.log(`Loaded fragment ${t.sn} of level ${t.level}`),this.hls.trigger(A.FRAG_LOADED,u)),this._handleFragmentLoadComplete(u)}).catch(u=>{this.state===st.STOPPED||this.state===st.ERROR||(this.warn(`Frag error: ${(u==null?void 0:u.message)||u}`),this.resetFragmentLoading(t))})}clearTrackerIfNeeded(t){var n;const{fragmentTracker:a}=this;if(a.getState(t)===sn.APPENDING){const u=t.type,d=this.getFwdBufferInfo(this.mediaBuffer,u),p=Math.max(t.duration,d?d.len:this.config.maxBufferLength),g=this.backtrackFragment;((g?t.sn-g.sn:0)===1||this.reduceMaxBufferLength(p,t.duration))&&a.removeFragment(t)}else((n=this.mediaBuffer)==null?void 0:n.buffered.length)===0?a.removeAllFragments():a.hasParts(t.type)&&(a.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type}),a.getState(t)===sn.PARTIAL&&a.removeFragment(t))}checkLiveUpdate(t){if(t.updated&&!t.live){const n=t.fragments[t.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:n,part:null,stats:n.stats,id:n.type})}t.fragments[0]||(t.deltaUpdateFailed=!0)}flushMainBuffer(t,n,a=null){if(!(t-n))return;const l={startOffset:t,endOffset:n,type:a};this.hls.trigger(A.BUFFER_FLUSHING,l)}_loadInitSegment(t,n){this._doFragLoad(t,n).then(a=>{if(!a||this.fragContextChanged(t)||!this.levels)throw new Error("init load aborted");return a}).then(a=>{const{hls:l}=this,{payload:u}=a,d=t.decryptdata;if(u&&u.byteLength>0&&d!=null&&d.key&&d.iv&&d.method==="AES-128"){const p=self.performance.now();return this.decrypter.decrypt(new Uint8Array(u),d.key.buffer,d.iv.buffer).catch(g=>{throw l.trigger(A.ERROR,{type:M.MEDIA_ERROR,details:k.FRAG_DECRYPT_ERROR,fatal:!1,error:g,reason:g.message,frag:t}),g}).then(g=>{const v=self.performance.now();return l.trigger(A.FRAG_DECRYPTED,{frag:t,payload:g,stats:{tstart:p,tdecrypt:v}}),a.payload=g,this.completeInitSegmentLoad(a)})}return this.completeInitSegmentLoad(a)}).catch(a=>{this.state===st.STOPPED||this.state===st.ERROR||(this.warn(a),this.resetFragmentLoading(t))})}completeInitSegmentLoad(t){const{levels:n}=this;if(!n)throw new Error("init load aborted, missing levels");const a=t.frag.stats;this.state=st.IDLE,t.frag.data=new Uint8Array(t.payload),a.parsing.start=a.buffering.start=self.performance.now(),a.parsing.end=a.buffering.end=self.performance.now(),this.tick()}fragContextChanged(t){const{fragCurrent:n}=this;return!t||!n||t.sn!==n.sn||t.level!==n.level}fragBufferedComplete(t,n){var a,l,u,d;const p=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${t.type} sn: ${t.sn}${n?" part: "+n.index:""} of ${this.playlistType===qt.MAIN?"level":"track"} ${t.level} (frag:[${((a=t.startPTS)!=null?a:NaN).toFixed(3)}-${((l=t.endPTS)!=null?l:NaN).toFixed(3)}] > buffer:${p?Wo.toString(oi.getBuffered(p)):"(detached)"})`),t.sn!=="initSegment"){var g;if(t.type!==qt.SUBTITLE){const b=t.elementaryStreams;if(!Object.keys(b).some(L=>!!b[L])){this.state=st.IDLE;return}}const v=(g=this.levels)==null?void 0:g[t.level];v!=null&&v.fragmentError&&(this.log(`Resetting level fragment error count of ${v.fragmentError} on frag buffered`),v.fragmentError=0)}this.state=st.IDLE,!!p&&(!this.loadedmetadata&&t.type==qt.MAIN&&p.buffered.length&&((u=this.fragCurrent)==null?void 0:u.sn)===((d=this.fragPrevious)==null?void 0:d.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(t){const{transmuxer:n}=this;if(!n)return;const{frag:a,part:l,partsLoaded:u}=t,d=!u||u.length===0||u.some(g=>!g),p=new Sa(a.level,a.sn,a.stats.chunkCount+1,0,l?l.index:-1,!d);n.flush(p)}_handleFragmentLoadProgress(t){}_doFragLoad(t,n,a=null,l){var u;const d=n==null?void 0:n.details;if(!this.levels||!d)throw new Error(`frag load aborted, missing level${d?"":" detail"}s`);let p=null;if(t.encrypted&&!((u=t.decryptdata)!=null&&u.key)?(this.log(`Loading key for ${t.sn} of [${d.startSN}-${d.endSN}], ${this.logPrefix==="[stream-controller]"?"level":"track"} ${t.level}`),this.state=st.KEY_LOADING,this.fragCurrent=t,p=this.keyLoader.load(t).then(b=>{if(!this.fragContextChanged(b.frag))return this.hls.trigger(A.KEY_LOADED,b),this.state===st.KEY_LOADING&&(this.state=st.IDLE),b}),this.hls.trigger(A.KEY_LOADING,{frag:t}),this.fragCurrent===null&&(p=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!t.encrypted&&d.encryptedFragments.length&&this.keyLoader.loadClear(t,d.encryptedFragments),a=Math.max(t.start,a||0),this.config.lowLatencyMode&&t.sn!=="initSegment"){const b=d.partList;if(b&&l){a>t.end&&d.fragmentHint&&(t=d.fragmentHint);const L=this.getNextPart(b,t,a);if(L>-1){const B=b[L];this.log(`Loading part sn: ${t.sn} p: ${B.index} cc: ${t.cc} of playlist [${d.startSN}-${d.endSN}] parts [0-${L}-${b.length-1}] ${this.logPrefix==="[stream-controller]"?"level":"track"}: ${t.level}, target: ${parseFloat(a.toFixed(3))}`),this.nextLoadPosition=B.start+B.duration,this.state=st.FRAG_LOADING;let W;return p?W=p.then(K=>!K||this.fragContextChanged(K.frag)?null:this.doFragPartsLoad(t,B,n,l)).catch(K=>this.handleFragLoadError(K)):W=this.doFragPartsLoad(t,B,n,l).catch(K=>this.handleFragLoadError(K)),this.hls.trigger(A.FRAG_LOADING,{frag:t,part:B,targetBufferTime:a}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):W}else if(!t.url||this.loadedEndOfParts(b,a))return Promise.resolve(null)}}this.log(`Loading fragment ${t.sn} cc: ${t.cc} ${d?"of ["+d.startSN+"-"+d.endSN+"] ":""}${this.logPrefix==="[stream-controller]"?"level":"track"}: ${t.level}, target: ${parseFloat(a.toFixed(3))}`),te(t.sn)&&!this.bitrateTest&&(this.nextLoadPosition=t.start+t.duration),this.state=st.FRAG_LOADING;const g=this.config.progressive;let v;return g&&p?v=p.then(b=>!b||this.fragContextChanged(b==null?void 0:b.frag)?null:this.fragmentLoader.load(t,l)).catch(b=>this.handleFragLoadError(b)):v=Promise.all([this.fragmentLoader.load(t,g?l:void 0),p]).then(([b])=>(!g&&b&&l&&l(b),b)).catch(b=>this.handleFragLoadError(b)),this.hls.trigger(A.FRAG_LOADING,{frag:t,targetBufferTime:a}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):v}doFragPartsLoad(t,n,a,l){return new Promise((u,d)=>{var p;const g=[],v=(p=a.details)==null?void 0:p.partList,b=L=>{this.fragmentLoader.loadPart(t,L,l).then(B=>{g[L.index]=B;const W=B.part;this.hls.trigger(A.FRAG_LOADED,B);const K=Fi(a,t.sn,L.index+1)||jn(v,t.sn,L.index+1);if(K)b(K);else return u({frag:t,part:W,partsLoaded:g})}).catch(d)};b(n)})}handleFragLoadError(t){if("data"in t){const n=t.data;t.data&&n.details===k.INTERNAL_ABORTED?this.handleFragLoadAborted(n.frag,n.part):this.hls.trigger(A.ERROR,n)}else this.hls.trigger(A.ERROR,{type:M.OTHER_ERROR,details:k.INTERNAL_EXCEPTION,err:t,error:t,fatal:!0});return null}_handleTransmuxerFlush(t){const n=this.getCurrentContext(t);if(!n||this.state!==st.PARSING){!this.fragCurrent&&this.state!==st.STOPPED&&this.state!==st.ERROR&&(this.state=st.IDLE);return}const{frag:a,part:l,level:u}=n,d=self.performance.now();a.stats.parsing.end=d,l&&(l.stats.parsing.end=d),this.updateLevelTiming(a,l,u,t.partial)}getCurrentContext(t){const{levels:n,fragCurrent:a}=this,{level:l,sn:u,part:d}=t;if(!(n!=null&&n[l]))return this.warn(`Levels object was unset while buffering fragment ${u} of level ${l}. The current chunk will not be buffered.`),null;const p=n[l],g=d>-1?Fi(p,u,d):null,v=g?g.fragment:Ul(p,u,a);return v?(a&&a!==v&&(v.stats=a.stats),{frag:v,part:g,level:p}):null}bufferFragmentData(t,n,a,l,u){var d;if(!t||this.state!==st.PARSING)return;const{data1:p,data2:g}=t;let v=p;if(p&&g&&(v=ft(p,g)),!((d=v)!=null&&d.length))return;const b={type:t.type,frag:n,part:a,chunkMeta:l,parent:n.type,data:v};if(this.hls.trigger(A.BUFFER_APPENDING,b),t.dropped&&t.independent&&!a){if(u)return;this.flushBufferGap(n)}}flushBufferGap(t){const n=this.media;if(!n)return;if(!oi.isBuffered(n,n.currentTime)){this.flushMainBuffer(0,t.start);return}const a=n.currentTime,l=oi.bufferInfo(n,a,0),u=t.duration,d=Math.min(this.config.maxFragLookUpTolerance*2,u*.25),p=Math.max(Math.min(t.start-d,l.end-d),a+d);t.start-p>d&&this.flushMainBuffer(p,t.start)}getFwdBufferInfo(t,n){const a=this.getLoadPosition();return te(a)?this.getFwdBufferInfoAtPos(t,a,n):null}getFwdBufferInfoAtPos(t,n,a){const{config:{maxBufferHole:l}}=this,u=oi.bufferInfo(t,n,l);if(u.len===0&&u.nextStart!==void 0){const d=this.fragmentTracker.getBufferedFrag(n,a);if(d&&u.nextStart<d.end)return oi.bufferInfo(t,n,Math.max(u.nextStart,l))}return u}getMaxBufferLength(t){const{config:n}=this;let a;return t?a=Math.max(8*n.maxBufferSize/t,n.maxBufferLength):a=n.maxBufferLength,Math.min(a,n.maxMaxBufferLength)}reduceMaxBufferLength(t,n){const a=this.config,l=Math.max(Math.min(t-n,a.maxBufferLength),n),u=Math.max(t-n*3,a.maxMaxBufferLength/2,l);return u>=l?(a.maxMaxBufferLength=u,this.warn(`Reduce max buffer length to ${u}s`),!0):!1}getAppendedFrag(t,n=qt.MAIN){const a=this.fragmentTracker.getAppendedFrag(t,qt.MAIN);return a&&"fragment"in a?a.fragment:a}getNextFragment(t,n){const a=n.fragments,l=a.length;if(!l)return null;const{config:u}=this,d=a[0].start;let p;if(n.live){const g=u.initialLiveManifestSize;if(l<g)return this.warn(`Not enough fragments to start playback (have: ${l}, need: ${g})`),null;(!n.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||t<d)&&(p=this.getInitialLiveFragment(n,a),this.startPosition=this.nextLoadPosition=p?this.hls.liveSyncPosition||p.start:t)}else t<=d&&(p=a[0]);if(!p){const g=u.lowLatencyMode?n.partEnd:n.fragmentEnd;p=this.getFragmentAtPosition(t,g,n)}return this.mapToInitFragWhenRequired(p)}isLoopLoading(t,n){const a=this.fragmentTracker.getState(t);return(a===sn.OK||a===sn.PARTIAL&&!!t.gap)&&this.nextLoadPosition>n}getNextFragmentLoopLoading(t,n,a,l,u){const d=t.gap,p=this.getNextFragment(this.nextLoadPosition,n);if(p===null)return p;if(t=p,d&&t&&!t.gap&&a.nextStart){const g=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,a.nextStart,l);if(g!==null&&a.len+g.len>=u)return this.log(`buffer full after gaps in "${l}" playlist starting at sn: ${t.sn}`),null}return t}mapToInitFragWhenRequired(t){return t!=null&&t.initSegment&&!(t!=null&&t.initSegment.data)&&!this.bitrateTest?t.initSegment:t}getNextPart(t,n,a){let l=-1,u=!1,d=!0;for(let p=0,g=t.length;p<g;p++){const v=t[p];if(d=d&&!v.independent,l>-1&&a<v.start)break;const b=v.loaded;b?l=-1:(u||v.independent||d)&&v.fragment===n&&(l=p),u=b}return l}loadedEndOfParts(t,n){const a=t[t.length-1];return a&&n>a.start&&a.loaded}getInitialLiveFragment(t,n){const a=this.fragPrevious;let l=null;if(a){if(t.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${a.programDateTime}`),l=jl(n,a.endProgramDateTime,this.config.maxFragLookUpTolerance)),!l){const u=a.sn+1;if(u>=t.startSN&&u<=t.endSN){const d=n[u-t.startSN];a.cc===d.cc&&(l=d,this.log(`Live playlist, switching playlist, load frag with next SN: ${l.sn}`))}l||(l=zs(n,a.cc),l&&this.log(`Live playlist, switching playlist, load frag with same CC: ${l.sn}`))}}else{const u=this.hls.liveSyncPosition;u!==null&&(l=this.getFragmentAtPosition(u,this.bitrateTest?t.fragmentEnd:t.edge,t))}return l}getFragmentAtPosition(t,n,a){const{config:l}=this;let{fragPrevious:u}=this,{fragments:d,endSN:p}=a;const{fragmentHint:g}=a,{maxFragLookUpTolerance:v}=l,b=a.partList,L=!!(l.lowLatencyMode&&b!=null&&b.length&&g);L&&g&&!this.bitrateTest&&(d=d.concat(g),p=g.sn);let B;if(t<n){const W=t>n-v?0:v;B=ba(u,d,t,W)}else B=d[d.length-1];if(B){const W=B.sn-a.startSN,K=this.fragmentTracker.getState(B);if((K===sn.OK||K===sn.PARTIAL&&B.gap)&&(u=B),u&&B.sn===u.sn&&(!L||b[0].fragment.sn>B.sn)&&u&&B.level===u.level){const re=d[W+1];B.sn<p&&this.fragmentTracker.getState(re)!==sn.OK?B=re:B=null}}return B}synchronizeToLiveEdge(t){const{config:n,media:a}=this;if(!a)return;const l=this.hls.liveSyncPosition,u=a.currentTime,d=t.fragments[0].start,p=t.edge,g=u>=d-n.maxFragLookUpTolerance&&u<=p;if(l!==null&&a.duration>l&&(u<l||!g)){const v=n.liveMaxLatencyDuration!==void 0?n.liveMaxLatencyDuration:n.liveMaxLatencyDurationCount*t.targetduration;(!g&&a.readyState<4||u<p-v)&&(this.loadedmetadata||(this.nextLoadPosition=l),a.readyState&&(this.warn(`Playback: ${u.toFixed(3)} is located too far from the end of live sliding playlist: ${p}, reset currentTime to : ${l.toFixed(3)}`),a.currentTime=l))}}alignPlaylists(t,n,a){const l=t.fragments.length;if(!l)return this.warn("No fragments in live playlist"),0;const u=t.fragments[0].start,d=!n,p=t.alignedSliding&&te(u);if(d||!p&&!u){const{fragPrevious:g}=this;Vl(g,a,t);const v=t.fragments[0].start;return this.log(`Live playlist sliding: ${v.toFixed(2)} start-sn: ${n?n.startSN:"na"}->${t.startSN} prev-sn: ${g?g.sn:"na"} fragments: ${l}`),v}return u}waitForCdnTuneIn(t){const n=3;return t.live&&t.canBlockReload&&t.partTarget&&t.tuneInGoal>Math.max(t.partHoldBack,t.partTarget*n)}setStartPosition(t,n){let a=this.startPosition;if(a<n&&(a=-1),a===-1||this.lastCurrentTime===-1){const l=this.startTimeOffset!==null,u=l?this.startTimeOffset:t.startTimeOffset;u!==null&&te(u)?(a=n+u,u<0&&(a+=t.totalduration),a=Math.min(Math.max(n,a),n+t.totalduration),this.log(`Start time offset ${u} found in ${l?"multivariant":"media"} playlist, adjust startPosition to ${a}`),this.startPosition=a):t.live?a=this.hls.liveSyncPosition||n:this.startPosition=a=0,this.lastCurrentTime=a}this.nextLoadPosition=a}getLoadPosition(){const{media:t}=this;let n=0;return this.loadedmetadata&&t?n=t.currentTime:this.nextLoadPosition&&(n=this.nextLoadPosition),n}handleFragLoadAborted(t,n){this.transmuxer&&t.sn!=="initSegment"&&t.stats.aborted&&(this.warn(`Fragment ${t.sn}${n?" part "+n.index:""} of level ${t.level} was aborted`),this.resetFragmentLoading(t))}resetFragmentLoading(t){(!this.fragCurrent||!this.fragContextChanged(t)&&this.state!==st.FRAG_LOADING_WAITING_RETRY)&&(this.state=st.IDLE)}onFragmentOrKeyLoadError(t,n){if(n.chunkMeta&&!n.frag){const b=this.getCurrentContext(n.chunkMeta);b&&(n.frag=b.frag)}const a=n.frag;if(!a||a.type!==t||!this.levels)return;if(this.fragContextChanged(a)){var l;this.warn(`Frag load error must match current frag to retry ${a.url} > ${(l=this.fragCurrent)==null?void 0:l.url}`);return}const u=n.details===k.FRAG_GAP;u&&this.fragmentTracker.fragBuffered(a,!0);const d=n.errorAction,{action:p,retryCount:g=0,retryConfig:v}=d||{};if(d&&p===Ji.RetryRequest&&v){this.resetStartWhenNotLoaded(this.levelLastLoaded);const b=_a(v,g);this.warn(`Fragment ${a.sn} of ${t} ${a.level} errored with ${n.details}, retrying loading ${g+1}/${v.maxNumRetry} in ${b}ms`),d.resolved=!0,this.retryDate=self.performance.now()+b,this.state=st.FRAG_LOADING_WAITING_RETRY}else if(v&&d)if(this.resetFragmentErrors(t),g<v.maxNumRetry)!u&&p!==Ji.RemoveAlternatePermanently&&(d.resolved=!0);else{C.warn(`${n.details} reached or exceeded max retry (${g})`);return}else(d==null?void 0:d.action)===Ji.SendAlternateToPenaltyBox?this.state=st.WAITING_LEVEL:this.state=st.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(t){if(this.state===st.PARSING||this.state===st.PARSED){const n=t.frag,a=t.parent,l=this.getFwdBufferInfo(this.mediaBuffer,a),u=l&&l.len>.5;u&&this.reduceMaxBufferLength(l.len,(n==null?void 0:n.duration)||10);const d=!u;return d&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${a} buffer`),n&&(this.fragmentTracker.removeFragment(n),this.nextLoadPosition=n.start),this.resetLoadingState(),d}return!1}resetFragmentErrors(t){t===qt.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==st.STOPPED&&(this.state=st.IDLE)}afterBufferFlushed(t,n,a){if(!t)return;const l=oi.getBuffered(t);this.fragmentTracker.detectEvictedFragments(n,l,a),this.state===st.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=st.IDLE}resetStartWhenNotLoaded(t){if(!this.loadedmetadata){this.startFragRequested=!1;const n=t?t.details:null;n!=null&&n.live?(this.startPosition=-1,this.setStartPosition(n,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(t){this.warn(`The loading context changed while buffering fragment ${t.sn} of level ${t.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(t=0){this.fragmentTracker.removeFragmentsInRange(t,Infinity,this.playlistType,!1,!0)}updateLevelTiming(t,n,a,l){var u;const d=a.details;if(!d){this.warn("level.details undefined");return}if(!Object.keys(t.elementaryStreams).reduce((g,v)=>{const b=t.elementaryStreams[v];if(b){const L=b.endPTS-b.startPTS;if(L<=0)return this.warn(`Could not parse fragment ${t.sn} ${v} duration reliably (${L})`),g||!1;const B=l?0:Ml(d,t,b.startPTS,b.endPTS,b.startDTS,b.endDTS);return this.hls.trigger(A.LEVEL_PTS_UPDATED,{details:d,level:a,drift:B,type:v,frag:t,start:b.startPTS,end:b.endPTS}),!0}return g},!1)&&((u=this.transmuxer)==null?void 0:u.error)===null){const g=new Error(`Found no media in fragment ${t.sn} of level ${t.level} resetting transmuxer to fallback to playlist timing`);if(a.fragmentError===0&&(a.fragmentError++,t.gap=!0,this.fragmentTracker.removeFragment(t),this.fragmentTracker.fragBuffered(t,!0)),this.warn(g.message),this.hls.trigger(A.ERROR,{type:M.MEDIA_ERROR,details:k.FRAG_PARSING_ERROR,fatal:!1,error:g,frag:t,reason:`Found no media in msn ${t.sn} of level "${a.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=st.PARSED,this.hls.trigger(A.FRAG_PARSED,{frag:t,part:n})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(t){t.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(t){const n=this._state;n!==t&&(this._state=t,this.log(`${n}->${t}`))}get state(){return this._state}}class ts{constructor(){this.chunks=[],this.dataLength=0}push(t){this.chunks.push(t),this.dataLength+=t.length}flush(){const{chunks:t,dataLength:n}=this;let a;if(t.length)t.length===1?a=t[0]:a=Ko(t,n);else return new Uint8Array(0);return this.reset(),a}reset(){this.chunks.length=0,this.dataLength=0}}function Ko(h,t){const n=new Uint8Array(t);let a=0;for(let l=0;l<h.length;l++){const u=h[l];n.set(u,a),a+=u.length}return n}function Yo(){return typeof __HLS_WORKER_BUNDLE__=="function"}function Xt(){const h=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(h);return{worker:new self.Worker(t),objectURL:t}}function Vn(h){const t=new self.URL(h,self.location.href).href;return{worker:new self.Worker(t),scriptURL:t}}function Bn(h="",t=9e4){return{type:h,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}class is{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(t,n,a,l){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(t){this.initPTS=t,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(t,n){return!1}appendFrame(t,n,a){}demux(t,n){this.cachedData&&(t=ft(this.cachedData,t),this.cachedData=null);let a=$i(t,0),l=a?a.length:0,u;const d=this._audioTrack,p=this._id3Track,g=a?pi(a):void 0,v=t.length;for((this.basePTS===null||this.frameIndex===0&&te(g))&&(this.basePTS=$r(g,n,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),a&&a.length>0&&p.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:a,type:Kn.audioId3,duration:Number.POSITIVE_INFINITY});l<v;){if(this.canParse(t,l)){const b=this.appendFrame(d,t,l);b?(this.frameIndex++,this.lastPTS=b.sample.pts,l+=b.length,u=l):l=v}else mn(t,l)?(a=$i(t,l),p.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:a,type:Kn.audioId3,duration:Number.POSITIVE_INFINITY}),l+=a.length,u=l):l++;if(l===v&&u!==v){const b=ui(t,u);this.cachedData?this.cachedData=ft(this.cachedData,b):this.cachedData=b}}return{audioTrack:d,videoTrack:Bn(),id3Track:p,textTrack:Bn()}}demuxSampleAes(t,n,a){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(t){const n=this.cachedData;return n&&(this.cachedData=null,this.demux(n,0)),{audioTrack:this._audioTrack,videoTrack:Bn(),id3Track:this._id3Track,textTrack:Bn()}}destroy(){}}const $r=(h,t,n)=>{if(te(h))return h*90;const a=n?n.baseTime*9e4/n.timescale:0;return t*9e4+a};function Qs(h,t,n,a){let l,u,d,p;const g=navigator.userAgent.toLowerCase(),v=a,b=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];l=((t[n+2]&192)>>>6)+1;const L=(t[n+2]&60)>>>2;if(L>b.length-1){const B=new Error(`invalid ADTS sampling index:${L}`);h.emit(A.ERROR,A.ERROR,{type:M.MEDIA_ERROR,details:k.FRAG_PARSING_ERROR,fatal:!0,error:B,reason:B.message});return}return d=(t[n+2]&1)<<2,d|=(t[n+3]&192)>>>6,C.log(`manifest codec:${a}, ADTS type:${l}, samplingIndex:${L}`),/firefox/i.test(g)?L>=6?(l=5,p=new Array(4),u=L-3):(l=2,p=new Array(2),u=L):g.indexOf("android")!==-1?(l=2,p=new Array(2),u=L):(l=5,p=new Array(4),a&&(a.indexOf("mp4a.40.29")!==-1||a.indexOf("mp4a.40.5")!==-1)||!a&&L>=6?u=L-3:((a&&a.indexOf("mp4a.40.2")!==-1&&(L>=6&&d===1||/vivaldi/i.test(g))||!a&&d===1)&&(l=2,p=new Array(2)),u=L)),p[0]=l<<3,p[0]|=(L&14)>>1,p[1]|=(L&1)<<7,p[1]|=d<<3,l===5&&(p[1]|=(u&14)>>1,p[2]=(u&1)<<7,p[2]|=2<<2,p[3]=0),{config:p,samplerate:b[L],channelCount:d,codec:"mp4a.40."+l,manifestCodec:v}}function ka(h,t){return h[t]===255&&(h[t+1]&246)==240}function Vr(h,t){return h[t+1]&1?7:9}function cr(h,t){return(h[t+3]&3)<<11|h[t+4]<<3|(h[t+5]&224)>>>5}function Xo(h,t){return t+5<h.length}function xr(h,t){return t+1<h.length&&ka(h,t)}function E(h,t){return Xo(h,t)&&ka(h,t)&&cr(h,t)<=h.length-t}function D(h,t){if(xr(h,t)){const n=Vr(h,t);if(t+n>=h.length)return!1;const a=cr(h,t);if(a<=n)return!1;const l=t+a;return l===h.length||xr(h,l)}return!1}function z(h,t,n,a,l){if(!h.samplerate){const u=Qs(t,n,a,l);if(!u)return;h.config=u.config,h.samplerate=u.samplerate,h.channelCount=u.channelCount,h.codec=u.codec,h.manifestCodec=u.manifestCodec,C.log(`parsed codec:${h.codec}, rate:${u.samplerate}, channels:${u.channelCount}`)}}function x(h){return 1024*9e4/h}function P(h,t){const n=Vr(h,t);if(t+n<=h.length){const a=cr(h,t)-n;if(a>0)return{headerLength:n,frameLength:a}}}function N(h,t,n,a,l){const u=x(h.samplerate),d=a+l*u,p=P(t,n);let g;if(p){const{frameLength:L,headerLength:B}=p,W=B+L,K=Math.max(0,n+W-t.length);K?(g=new Uint8Array(W-B),g.set(t.subarray(n+B,t.length),0)):g=t.subarray(n+B,n+W);const ee={unit:g,pts:d};return K||h.samples.push(ee),{sample:ee,length:W,missing:K}}const v=t.length-n;return g=new Uint8Array(v),g.set(t.subarray(n,t.length),0),{sample:{unit:g,pts:d},length:v,missing:-1}}let Z=null;const fe=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],pe=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],He=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],tt=[0,1,1,4];function vt(h,t,n,a,l){if(n+24>t.length)return;const u=_t(t,n);if(u&&n+u.frameLength<=t.length){const d=u.samplesPerFrame*9e4/u.sampleRate,p=a+l*d,g={unit:t.subarray(n,n+u.frameLength),pts:p,dts:p};return h.config=[],h.channelCount=u.channelCount,h.samplerate=u.sampleRate,h.samples.push(g),{sample:g,length:u.frameLength,missing:0}}}function _t(h,t){const n=h[t+1]>>3&3,a=h[t+1]>>1&3,l=h[t+2]>>4&15,u=h[t+2]>>2&3;if(n!==1&&l!==0&&l!==15&&u!==3){const d=h[t+2]>>1&1,p=h[t+3]>>6,g=n===3?3-a:a===3?3:4,v=fe[g*14+l-1]*1e3,L=pe[(n===3?0:n===2?1:2)*3+u],B=p===3?1:2,W=He[n][a],K=tt[a],ee=W*8*K,re=Math.floor(W*v/L+d)*K;if(Z===null){const Me=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Z=Me?parseInt(Me[1]):0}return!!Z&&Z<=87&&a===2&&v>=224e3&&p===0&&(h[t+3]=h[t+3]|128),{sampleRate:L,channelCount:B,frameLength:re,samplesPerFrame:ee}}}function Rt(h,t){return h[t]===255&&(h[t+1]&224)==224&&(h[t+1]&6)!=0}function Et(h,t){return t+1<h.length&&Rt(h,t)}function bt(h,t){const n=4;return Rt(h,t)&&n<=h.length-t}function Ot(h,t){if(t+1<h.length&&Rt(h,t)){const n=4,a=_t(h,t);let l=n;a!=null&&a.frameLength&&(l=a.frameLength);const u=t+l;return u===h.length||Et(h,u)}return!1}class Zt extends is{constructor(t,n){super();this.observer=void 0,this.config=void 0,this.observer=t,this.config=n}resetInitSegment(t,n,a,l){super.resetInitSegment(t,n,a,l),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:n,duration:l,inputTimeScale:9e4,dropped:0}}static probe(t){if(!t)return!1;const n=$i(t,0);let a=(n==null?void 0:n.length)||0;if(Ot(t,a))return!1;for(let l=t.length;a<l;a++)if(D(t,a))return C.log("ADTS sync word found !"),!0;return!1}canParse(t,n){return E(t,n)}appendFrame(t,n,a){z(t,this.observer,n,a,t.manifestCodec);const l=N(t,n,a,this.basePTS,this.frameIndex);if(l&&l.missing===0)return l}}const Gi=/\/emsg[-/]ID3/i;class qi{constructor(t,n){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=n}resetTimeStamp(){}resetInitSegment(t,n,a,l){const u=this.videoTrack=Bn("video",1),d=this.audioTrack=Bn("audio",1),p=this.txtTrack=Bn("text",1);if(this.id3Track=Bn("id3",1),this.timeOffset=0,!(t!=null&&t.byteLength))return;const g=Kr(t);if(g.video){const{id:v,timescale:b,codec:L}=g.video;u.id=v,u.timescale=p.timescale=b,u.codec=L}if(g.audio){const{id:v,timescale:b,codec:L}=g.audio;d.id=v,d.timescale=b,d.codec=L}p.id=ki.text,u.sampleDuration=0,u.duration=d.duration=l}resetContiguity(){this.remainderData=null}static probe(t){return Lr(t)}demux(t,n){this.timeOffset=n;let a=t;const l=this.videoTrack,u=this.txtTrack;if(this.config.progressive){this.remainderData&&(a=ft(this.remainderData,t));const p=Xe(a);this.remainderData=p.remainder,l.samples=p.valid||new Uint8Array}else l.samples=a;const d=this.extractID3Track(l,n);return u.samples=jt(n,l),{videoTrack:l,audioTrack:this.audioTrack,id3Track:d,textTrack:this.txtTrack}}flush(){const t=this.timeOffset,n=this.videoTrack,a=this.txtTrack;n.samples=this.remainderData||new Uint8Array,this.remainderData=null;const l=this.extractID3Track(n,this.timeOffset);return a.samples=jt(t,n),{videoTrack:n,audioTrack:Bn(),id3Track:l,textTrack:Bn()}}extractID3Track(t,n){const a=this.id3Track;if(t.samples.length){const l=Jt(t.samples,["emsg"]);l&&l.forEach(u=>{const d=Wn(u);if(Gi.test(d.schemeIdUri)){const p=te(d.presentationTime)?d.presentationTime/d.timeScale:n+d.presentationTimeDelta/d.timeScale;let g=d.eventDuration===4294967295?Number.POSITIVE_INFINITY:d.eventDuration/d.timeScale;g<=.001&&(g=Number.POSITIVE_INFINITY);const v=d.payload;a.samples.push({data:v,len:v.byteLength,dts:p,pts:p,type:Kn.emsg,duration:g})}})}return a}demuxSampleAes(t,n,a){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}}const vi=(h,t)=>{let n=0,a=5;t+=a;const l=new Uint32Array(1),u=new Uint32Array(1),d=new Uint8Array(1);for(;a>0;){d[0]=h[t];const p=Math.min(a,8),g=8-p;u[0]=4278190080>>>24+g<<g,l[0]=(d[0]&u[0])>>g,n=n?n<<p|l[0]:l[0],t+=1,a-=p}return n};class hr extends is{constructor(t){super();this.observer=void 0,this.observer=t}resetInitSegment(t,n,a,l){super.resetInitSegment(t,n,a,l),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:n,duration:l,inputTimeScale:9e4,dropped:0}}canParse(t,n){return n+64<t.length}appendFrame(t,n,a){const l=Er(t,n,a,this.basePTS,this.frameIndex);if(l!==-1)return{sample:t.samples[t.samples.length-1],length:l,missing:0}}static probe(t){if(!t)return!1;const n=$i(t,0);if(!n)return!1;const a=n.length;return t[a]===11&&t[a+1]===119&&pi(n)!==void 0&&vi(t,a)<16}}function Er(h,t,n,a,l){if(n+8>t.length||t[n]!==11||t[n+1]!==119)return-1;const u=t[n+4]>>6;if(u>=3)return-1;const p=[48e3,44100,32e3][u],g=t[n+4]&63,b=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][g*3+u]*2;if(n+b>t.length)return-1;const L=t[n+6]>>5;let B=0;L===2?B+=2:(L&1&&L!==1&&(B+=2),L&4&&(B+=2));const W=(t[n+6]<<8|t[n+7])>>12-B&1,ee=[2,1,2,3,3,4,4,5][L]+W,re=t[n+5]>>3,xe=t[n+5]&7,Fe=new Uint8Array([u<<6|re<<1|xe>>2,(xe&3)<<6|L<<3|W<<2|g>>4,g<<4&224]),Me=1536/p*9e4,it=a+l*Me,$e=t.subarray(n,n+b);return h.config=Fe,h.channelCount=ee,h.samplerate=p,h.samples.push({unit:$e,pts:it}),b}class ns{constructor(){this.VideoSample=null}createVideoSample(t,n,a,l){return{key:t,frame:!1,pts:n,dts:a,units:[],debug:l,length:0}}getLastNalUnit(t){var n;let a=this.VideoSample,l;if((!a||a.units.length===0)&&(a=t[t.length-1]),(n=a)!=null&&n.units){const u=a.units;l=u[u.length-1]}return l}pushAccessUnit(t,n){if(t.units.length&&t.frame){if(t.pts===void 0){const a=n.samples,l=a.length;if(l){const u=a[l-1];t.pts=u.pts,t.dts=u.dts}else{n.dropped++;return}}n.samples.push(t)}t.debug.length&&C.log(t.pts+"/"+t.dts+":"+t.debug)}}class Zi{constructor(t){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const t=this.data,n=this.bytesAvailable,a=t.byteLength-n,l=new Uint8Array(4),u=Math.min(4,n);if(u===0)throw new Error("no bytes available");l.set(t.subarray(a,a+u)),this.word=new DataView(l.buffer).getUint32(0),this.bitsAvailable=u*8,this.bytesAvailable-=u}skipBits(t){let n;t=Math.min(t,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>t?(this.word<<=t,this.bitsAvailable-=t):(t-=this.bitsAvailable,n=t>>3,t-=n<<3,this.bytesAvailable-=n,this.loadWord(),this.word<<=t,this.bitsAvailable-=t)}readBits(t){let n=Math.min(this.bitsAvailable,t);const a=this.word>>>32-n;if(t>32&&C.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=n,this.bitsAvailable>0)this.word<<=n;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return n=t-n,n>0&&this.bitsAvailable?a<<n|this.readBits(n):a}skipLZ(){let t;for(t=0;t<this.bitsAvailable;++t)if((this.word&2147483648>>>t)!=0)return this.word<<=t,this.bitsAvailable-=t,t;return this.loadWord(),t+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const t=this.skipLZ();return this.readBits(t+1)-1}readEG(){const t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(t){let n=8,a=8,l;for(let u=0;u<t;u++)a!==0&&(l=this.readEG(),a=(n+l+256)%256),n=a===0?n:a}readSPS(){let t=0,n=0,a=0,l=0,u,d,p;const g=this.readUByte.bind(this),v=this.readBits.bind(this),b=this.readUEG.bind(this),L=this.readBoolean.bind(this),B=this.skipBits.bind(this),W=this.skipEG.bind(this),K=this.skipUEG.bind(this),ee=this.skipScalingList.bind(this);g();const re=g();if(v(5),B(3),g(),K(),re===100||re===110||re===122||re===244||re===44||re===83||re===86||re===118||re===128){const ut=b();if(ut===3&&B(1),K(),K(),B(1),L())for(d=ut!==3?8:12,p=0;p<d;p++)L()&&(p<6?ee(16):ee(64))}K();const xe=b();if(xe===0)b();else if(xe===1)for(B(1),W(),W(),u=b(),p=0;p<u;p++)W();K(),B(1);const Fe=b(),Me=b(),it=v(1);it===0&&B(1),B(1),L()&&(t=b(),n=b(),a=b(),l=b());let $e=[1,1];if(L()&&L())switch(g()){case 1:$e=[1,1];break;case 2:$e=[12,11];break;case 3:$e=[10,11];break;case 4:$e=[16,11];break;case 5:$e=[40,33];break;case 6:$e=[24,11];break;case 7:$e=[20,11];break;case 8:$e=[32,11];break;case 9:$e=[80,33];break;case 10:$e=[18,11];break;case 11:$e=[15,11];break;case 12:$e=[64,33];break;case 13:$e=[160,99];break;case 14:$e=[4,3];break;case 15:$e=[3,2];break;case 16:$e=[2,1];break;case 255:{$e=[g()<<8|g(),g()<<8|g()];break}}return{width:Math.ceil((Fe+1)*16-t*2-n*2),height:(2-it)*(Me+1)*16-(it?2:4)*(a+l),pixelRatio:$e}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class Hl extends ns{parseAVCPES(t,n,a,l,u){const d=this.parseAVCNALu(t,a.data);let p=this.VideoSample,g,v=!1;a.data=null,p&&d.length&&!t.audFound&&(this.pushAccessUnit(p,t),p=this.VideoSample=this.createVideoSample(!1,a.pts,a.dts,"")),d.forEach(b=>{var L;switch(b.type){case 1:{let ee=!1;g=!0;const re=b.data;if(v&&re.length>4){const xe=new Zi(re).readSliceType();(xe===2||xe===4||xe===7||xe===9)&&(ee=!0)}if(ee){var B;(B=p)!=null&&B.frame&&!p.key&&(this.pushAccessUnit(p,t),p=this.VideoSample=null)}p||(p=this.VideoSample=this.createVideoSample(!0,a.pts,a.dts,"")),p.frame=!0,p.key=ee;break}case 5:g=!0,(L=p)!=null&&L.frame&&!p.key&&(this.pushAccessUnit(p,t),p=this.VideoSample=null),p||(p=this.VideoSample=this.createVideoSample(!0,a.pts,a.dts,"")),p.key=!0,p.frame=!0;break;case 6:{g=!0,cn(b.data,1,a.pts,n.samples);break}case 7:{var W,K;g=!0,v=!0;const ee=b.data,xe=new Zi(ee).readSPS();if(!t.sps||t.width!==xe.width||t.height!==xe.height||((W=t.pixelRatio)==null?void 0:W[0])!==xe.pixelRatio[0]||((K=t.pixelRatio)==null?void 0:K[1])!==xe.pixelRatio[1]){t.width=xe.width,t.height=xe.height,t.pixelRatio=xe.pixelRatio,t.sps=[ee],t.duration=u;const Fe=ee.subarray(1,4);let Me="avc1.";for(let it=0;it<3;it++){let $e=Fe[it].toString(16);$e.length<2&&($e="0"+$e),Me+=$e}t.codec=Me}break}case 8:g=!0,t.pps=[b.data];break;case 9:g=!0,t.audFound=!0,p&&this.pushAccessUnit(p,t),p=this.VideoSample=this.createVideoSample(!1,a.pts,a.dts,"");break;case 12:g=!0;break;default:g=!1,p&&(p.debug+="unknown NAL "+b.type+" ");break}p&&g&&p.units.push(b)}),l&&p&&(this.pushAccessUnit(p,t),this.VideoSample=null)}parseAVCNALu(t,n){const a=n.byteLength;let l=t.naluState||0;const u=l,d=[];let p=0,g,v,b,L=-1,B=0;for(l===-1&&(L=0,B=n[0]&31,l=0,p=1);p<a;){if(g=n[p++],!l){l=g?0:1;continue}if(l===1){l=g?0:2;continue}if(!g)l=3;else if(g===1){if(v=p-l-1,L>=0){const W={data:n.subarray(L,v),type:B};d.push(W)}else{const W=this.getLastNalUnit(t.samples);W&&(u&&p<=4-u&&W.state&&(W.data=W.data.subarray(0,W.data.byteLength-u)),v>0&&(W.data=ft(W.data,n.subarray(0,v)),W.state=0))}p<a?(b=n[p]&31,L=p,B=b,l=0):l=-1}else l=0}if(L>=0&&l>=0){const W={data:n.subarray(L,a),type:B,state:l};d.push(W)}if(d.length===0){const W=this.getLastNalUnit(t.samples);W&&(W.data=ft(W.data,n))}return t.naluState=l,d}}class Oc{constructor(t,n,a){this.keyData=void 0,this.decrypter=void 0,this.keyData=a,this.decrypter=new Da(n,{removePKCS7Padding:!1})}decryptBuffer(t){return this.decrypter.decrypt(t,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(t,n,a){const l=t[n].unit;if(l.length<=16)return;const u=l.subarray(16,l.length-l.length%16),d=u.buffer.slice(u.byteOffset,u.byteOffset+u.length);this.decryptBuffer(d).then(p=>{const g=new Uint8Array(p);l.set(g,16),this.decrypter.isSync()||this.decryptAacSamples(t,n+1,a)})}decryptAacSamples(t,n,a){for(;;n++){if(n>=t.length){a();return}if(!(t[n].unit.length<32)&&(this.decryptAacSample(t,n,a),!this.decrypter.isSync()))return}}getAvcEncryptedData(t){const n=Math.floor((t.length-48)/160)*16+16,a=new Int8Array(n);let l=0;for(let u=32;u<t.length-16;u+=160,l+=16)a.set(t.subarray(u,u+16),l);return a}getAvcDecryptedUnit(t,n){const a=new Uint8Array(n);let l=0;for(let u=32;u<t.length-16;u+=160,l+=16)t.set(a.subarray(l,l+16),u);return t}decryptAvcSample(t,n,a,l,u){const d=hn(u.data),p=this.getAvcEncryptedData(d);this.decryptBuffer(p.buffer).then(g=>{u.data=this.getAvcDecryptedUnit(d,g),this.decrypter.isSync()||this.decryptAvcSamples(t,n,a+1,l)})}decryptAvcSamples(t,n,a,l){if(t instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;n++,a=0){if(n>=t.length){l();return}const u=t[n].units;for(;!(a>=u.length);a++){const d=u[a];if(!(d.data.length<=48||d.type!==1&&d.type!==5)&&(this.decryptAvcSample(t,n,a,l,d),!this.decrypter.isSync()))return}}}}const Ci=188;class rs{constructor(t,n,a){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=t,this.config=n,this.typeSupported=a,this.videoParser=new Hl}static probe(t){const n=rs.syncOffset(t);return n>0&&C.warn(`MPEG2-TS detected but first sync word found @ offset ${n}`),n!==-1}static syncOffset(t){const n=t.length;let a=Math.min(Ci*5,n-Ci)+1,l=0;for(;l<a;){let u=!1,d=-1,p=0;for(let g=l;g<n;g+=Ci)if(t[g]===71&&(n-g===Ci||t[g+Ci]===71)){if(p++,d===-1&&(d=g,d!==0&&(a=Math.min(d+Ci*99,t.length-Ci)+1)),u||(u=ro(t,g)===0),u&&p>1&&(d===0&&p>2||g+Ci>a))return d}else{if(p)return-1;break}l++}return-1}static createTrack(t,n){return{container:t==="video"||t==="audio"?"video/mp2t":void 0,type:t,id:ki[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:t==="audio"?n:void 0}}resetInitSegment(t,n,a,l){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=rs.createTrack("video"),this._audioTrack=rs.createTrack("audio",l),this._id3Track=rs.createTrack("id3"),this._txtTrack=rs.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=n,this.videoCodec=a,this._duration=l}resetTimeStamp(){}resetContiguity(){const{_audioTrack:t,_videoTrack:n,_id3Track:a}=this;t&&(t.pesData=null),n&&(n.pesData=null),a&&(a.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(t,n,a=!1,l=!1){a||(this.sampleAes=null);let u;const d=this._videoTrack,p=this._audioTrack,g=this._id3Track,v=this._txtTrack;let b=d.pid,L=d.pesData,B=p.pid,W=g.pid,K=p.pesData,ee=g.pesData,re=null,xe=this.pmtParsed,Fe=this._pmtId,Me=t.length;if(this.remainderData&&(t=ft(this.remainderData,t),Me=t.length,this.remainderData=null),Me<Ci&&!l)return this.remainderData=t,{audioTrack:p,videoTrack:d,id3Track:g,textTrack:v};const it=Math.max(0,rs.syncOffset(t));Me-=(Me-it)%Ci,Me<t.byteLength&&!l&&(this.remainderData=new Uint8Array(t.buffer,Me,t.buffer.byteLength-Me));let $e=0;for(let Qe=it;Qe<Me;Qe+=Ci)if(t[Qe]===71){const yt=!!(t[Qe+1]&64),xt=ro(t,Qe),ot=(t[Qe+3]&48)>>4;let At;if(ot>1){if(At=Qe+5+t[Qe+4],At===Qe+Ci)continue}else At=Qe+4;switch(xt){case b:yt&&(L&&(u=yn(L))&&this.videoParser.parseAVCPES(d,v,u,!1,this._duration),L={data:[],size:0}),L&&(L.data.push(t.subarray(At,Qe+Ci)),L.size+=Qe+Ci-At);break;case B:if(yt){if(K&&(u=yn(K)))switch(p.segmentCodec){case"aac":this.parseAACPES(p,u);break;case"mp3":this.parseMPEGPES(p,u);break;case"ac3":this.parseAC3PES(p,u);break}K={data:[],size:0}}K&&(K.data.push(t.subarray(At,Qe+Ci)),K.size+=Qe+Ci-At);break;case W:yt&&(ee&&(u=yn(ee))&&this.parseID3PES(g,u),ee={data:[],size:0}),ee&&(ee.data.push(t.subarray(At,Qe+Ci)),ee.size+=Qe+Ci-At);break;case 0:yt&&(At+=t[At]+1),Fe=this._pmtId=Qo(t,At);break;case Fe:{yt&&(At+=t[At]+1);const Re=Jo(t,At,this.typeSupported,a,this.observer);b=Re.videoPid,b>0&&(d.pid=b,d.segmentCodec=Re.segmentVideoCodec),B=Re.audioPid,B>0&&(p.pid=B,p.segmentCodec=Re.segmentAudioCodec),W=Re.id3Pid,W>0&&(g.pid=W),re!==null&&!xe&&(C.warn(`MPEG-TS PMT found at ${Qe} after unknown PID '${re}'. Backtracking to sync byte @${it} to parse all TS packets.`),re=null,Qe=it-188),xe=this.pmtParsed=!0;break}case 17:case 8191:break;default:re=xt;break}}else $e++;$e>0&&Zo(this.observer,new Error(`Found ${$e} TS packet/s that do not start with 0x47`)),d.pesData=L,p.pesData=K,g.pesData=ee;const ut={audioTrack:p,videoTrack:d,id3Track:g,textTrack:v};return l&&this.extractRemainingSamples(ut),ut}flush(){const{remainderData:t}=this;this.remainderData=null;let n;return t?n=this.demux(t,-1,!1,!0):n={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(n),this.sampleAes?this.decrypt(n,this.sampleAes):n}extractRemainingSamples(t){const{audioTrack:n,videoTrack:a,id3Track:l,textTrack:u}=t,d=a.pesData,p=n.pesData,g=l.pesData;let v;if(d&&(v=yn(d))?(this.videoParser.parseAVCPES(a,u,v,!0,this._duration),a.pesData=null):a.pesData=d,p&&(v=yn(p))){switch(n.segmentCodec){case"aac":this.parseAACPES(n,v);break;case"mp3":this.parseMPEGPES(n,v);break;case"ac3":this.parseAC3PES(n,v);break}n.pesData=null}else p!=null&&p.size&&C.log("last AAC PES packet truncated,might overlap between fragments"),n.pesData=p;g&&(v=yn(g))?(this.parseID3PES(l,v),l.pesData=null):l.pesData=g}demuxSampleAes(t,n,a){const l=this.demux(t,a,!0,!this.config.progressive),u=this.sampleAes=new Oc(this.observer,this.config,n);return this.decrypt(l,u)}decrypt(t,n){return new Promise(a=>{const{audioTrack:l,videoTrack:u}=t;l.samples&&l.segmentCodec==="aac"?n.decryptAacSamples(l.samples,0,()=>{u.samples?n.decryptAvcSamples(u.samples,0,0,()=>{a(t)}):a(t)}):u.samples&&n.decryptAvcSamples(u.samples,0,0,()=>{a(t)})})}destroy(){this._duration=0}parseAACPES(t,n){let a=0;const l=this.aacOverFlow;let u=n.data;if(l){this.aacOverFlow=null;const L=l.missing,B=l.sample.unit.byteLength;if(L===-1)u=ft(l.sample.unit,u);else{const W=B-L;l.sample.unit.set(u.subarray(0,L),W),t.samples.push(l.sample),a=l.missing}}let d,p;for(d=a,p=u.length;d<p-1&&!xr(u,d);d++);if(d!==a){let L;const B=d<p-1;if(B?L=`AAC PES did not start with ADTS header,offset:${d}`:L="No ADTS header found in AAC PES",Zo(this.observer,new Error(L),B),!B)return}z(t,this.observer,u,d,this.audioCodec);let g;if(n.pts!==void 0)g=n.pts;else if(l){const L=x(t.samplerate);g=l.sample.pts+L}else{C.warn("[tsdemuxer]: AAC PES unknown PTS");return}let v=0,b;for(;d<p;)if(b=N(t,u,d,g,v),d+=b.length,b.missing){this.aacOverFlow=b;break}else for(v++;d<p-1&&!xr(u,d);d++);}parseMPEGPES(t,n){const a=n.data,l=a.length;let u=0,d=0;const p=n.pts;if(p===void 0){C.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;d<l;)if(Et(a,d)){const g=vt(t,a,d,p,u);if(g)d+=g.length,u++;else break}else d++}parseAC3PES(t,n){{const a=n.data,l=n.pts;if(l===void 0){C.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const u=a.length;let d=0,p=0,g;for(;p<u&&(g=Er(t,a,p,l,d++))>0;)p+=g}}parseID3PES(t,n){if(n.pts===void 0){C.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const a=se({},n,{type:this._videoTrack?Kn.emsg:Kn.audioId3,duration:Number.POSITIVE_INFINITY});t.samples.push(a)}}function ro(h,t){return((h[t+1]&31)<<8)+h[t+2]}function Qo(h,t){return(h[t+10]&31)<<8|h[t+11]}function Jo(h,t,n,a,l){const u={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},d=(h[t+1]&15)<<8|h[t+2],p=t+3+d-4,g=(h[t+10]&15)<<8|h[t+11];for(t+=12+g;t<p;){const v=ro(h,t),b=(h[t+3]&15)<<8|h[t+4];switch(h[t]){case 207:if(!a){Gl("ADTS AAC");break}case 15:u.audioPid===-1&&(u.audioPid=v);break;case 21:u.id3Pid===-1&&(u.id3Pid=v);break;case 219:if(!a){Gl("H.264");break}case 27:u.videoPid===-1&&(u.videoPid=v,u.segmentVideoCodec="avc");break;case 3:case 4:!n.mpeg&&!n.mp3?C.log("MPEG audio found, not supported in this browser"):u.audioPid===-1&&(u.audioPid=v,u.segmentAudioCodec="mp3");break;case 193:if(!a){Gl("AC-3");break}case 129:n.ac3?u.audioPid===-1&&(u.audioPid=v,u.segmentAudioCodec="ac3"):C.log("AC-3 audio found, not supported in this browser");break;case 6:if(u.audioPid===-1&&b>0){let L=t+5,B=b;for(;B>2;){switch(h[L]){case 106:n.ac3!==!0?C.log("AC-3 audio found, not supported in this browser for now"):(u.audioPid=v,u.segmentAudioCodec="ac3");break}const K=h[L+1]+2;L+=K,B-=K}}break;case 194:case 135:return Zo(l,new Error("Unsupported EC-3 in M2TS found")),u;case 36:return Zo(l,new Error("Unsupported HEVC in M2TS found")),u}t+=b+5}return u}function Zo(h,t,n){C.warn(`parsing error: ${t.message}`),h.emit(A.ERROR,A.ERROR,{type:M.MEDIA_ERROR,details:k.FRAG_PARSING_ERROR,fatal:!1,levelRetry:n,error:t,reason:t.message})}function Gl(h){C.log(`${h} with AES-128-CBC encryption found in unencrypted stream`)}function yn(h){let t=0,n,a,l,u,d;const p=h.data;if(!h||h.size===0)return null;for(;p[0].length<19&&p.length>1;)p[0]=ft(p[0],p[1]),p.splice(1,1);if(n=p[0],(n[0]<<16)+(n[1]<<8)+n[2]===1){if(a=(n[4]<<8)+n[5],a&&a>h.size-6)return null;const v=n[7];v&192&&(u=(n[9]&14)*536870912+(n[10]&255)*4194304+(n[11]&254)*16384+(n[12]&255)*128+(n[13]&254)/2,v&64?(d=(n[14]&14)*536870912+(n[15]&255)*4194304+(n[16]&254)*16384+(n[17]&255)*128+(n[18]&254)/2,u-d>60*9e4&&(C.warn(`${Math.round((u-d)/9e4)}s delta between PTS and DTS, align them`),u=d)):d=u),l=n[8];let b=l+9;if(h.size<=b)return null;h.size-=b;const L=new Uint8Array(h.size);for(let B=0,W=p.length;B<W;B++){n=p[B];let K=n.byteLength;if(b)if(b>K){b-=K;continue}else n=n.subarray(b),K-=b,b=0;L.set(n,t),t+=K}return a&&(a-=l+3),{data:L,pts:u,dts:d,len:a}}return null}class wn extends is{resetInitSegment(t,n,a,l){super.resetInitSegment(t,n,a,l),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:n,duration:l,inputTimeScale:9e4,dropped:0}}static probe(t){if(!t)return!1;const n=$i(t,0);let a=(n==null?void 0:n.length)||0;if(n&&t[a]===11&&t[a+1]===119&&pi(n)!==void 0&&vi(t,a)<=16)return!1;for(let l=t.length;a<l;a++)if(Ot(t,a))return C.log("MPEG Audio sync word found !"),!0;return!1}canParse(t,n){return bt(t,n)}appendFrame(t,n,a){if(this.basePTS!==null)return vt(t,n,a,this.basePTS,this.frameIndex)}}class Js{static getSilentFrame(t,n){switch(t){case"mp4a.40.2":if(n===1)return new Uint8Array([0,200,0,128,35,128]);if(n===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(n===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(n===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(n===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(n===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(n===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(n===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(n===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const Tr=Math.pow(2,32)-1;class Ge{static init(){Ge.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let t;for(t in Ge.types)Ge.types.hasOwnProperty(t)&&(Ge.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);const n=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),a=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);Ge.HDLR_TYPES={video:n,audio:a};const l=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),u=new Uint8Array([0,0,0,0,0,0,0,0]);Ge.STTS=Ge.STSC=Ge.STCO=u,Ge.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Ge.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Ge.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Ge.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const d=new Uint8Array([105,115,111,109]),p=new Uint8Array([97,118,99,49]),g=new Uint8Array([0,0,0,1]);Ge.FTYP=Ge.box(Ge.types.ftyp,d,g,d,p),Ge.DINF=Ge.box(Ge.types.dinf,Ge.box(Ge.types.dref,l))}static box(t,...n){let a=8,l=n.length;const u=l;for(;l--;)a+=n[l].byteLength;const d=new Uint8Array(a);for(d[0]=a>>24&255,d[1]=a>>16&255,d[2]=a>>8&255,d[3]=a&255,d.set(t,4),l=0,a=8;l<u;l++)d.set(n[l],a),a+=n[l].byteLength;return d}static hdlr(t){return Ge.box(Ge.types.hdlr,Ge.HDLR_TYPES[t])}static mdat(t){return Ge.box(Ge.types.mdat,t)}static mdhd(t,n){n*=t;const a=Math.floor(n/(Tr+1)),l=Math.floor(n%(Tr+1));return Ge.box(Ge.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,a>>24,a>>16&255,a>>8&255,a&255,l>>24,l>>16&255,l>>8&255,l&255,85,196,0,0]))}static mdia(t){return Ge.box(Ge.types.mdia,Ge.mdhd(t.timescale,t.duration),Ge.hdlr(t.type),Ge.minf(t))}static mfhd(t){return Ge.box(Ge.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255]))}static minf(t){return t.type==="audio"?Ge.box(Ge.types.minf,Ge.box(Ge.types.smhd,Ge.SMHD),Ge.DINF,Ge.stbl(t)):Ge.box(Ge.types.minf,Ge.box(Ge.types.vmhd,Ge.VMHD),Ge.DINF,Ge.stbl(t))}static moof(t,n,a){return Ge.box(Ge.types.moof,Ge.mfhd(t),Ge.traf(a,n))}static moov(t){let n=t.length;const a=[];for(;n--;)a[n]=Ge.trak(t[n]);return Ge.box.apply(null,[Ge.types.moov,Ge.mvhd(t[0].timescale,t[0].duration)].concat(a).concat(Ge.mvex(t)))}static mvex(t){let n=t.length;const a=[];for(;n--;)a[n]=Ge.trex(t[n]);return Ge.box.apply(null,[Ge.types.mvex,...a])}static mvhd(t,n){n*=t;const a=Math.floor(n/(Tr+1)),l=Math.floor(n%(Tr+1)),u=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,a>>24,a>>16&255,a>>8&255,a&255,l>>24,l>>16&255,l>>8&255,l&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Ge.box(Ge.types.mvhd,u)}static sdtp(t){const n=t.samples||[],a=new Uint8Array(4+n.length);let l,u;for(l=0;l<n.length;l++)u=n[l].flags,a[l+4]=u.dependsOn<<4|u.isDependedOn<<2|u.hasRedundancy;return Ge.box(Ge.types.sdtp,a)}static stbl(t){return Ge.box(Ge.types.stbl,Ge.stsd(t),Ge.box(Ge.types.stts,Ge.STTS),Ge.box(Ge.types.stsc,Ge.STSC),Ge.box(Ge.types.stsz,Ge.STSZ),Ge.box(Ge.types.stco,Ge.STCO))}static avc1(t){let n=[],a=[],l,u,d;for(l=0;l<t.sps.length;l++)u=t.sps[l],d=u.byteLength,n.push(d>>>8&255),n.push(d&255),n=n.concat(Array.prototype.slice.call(u));for(l=0;l<t.pps.length;l++)u=t.pps[l],d=u.byteLength,a.push(d>>>8&255),a.push(d&255),a=a.concat(Array.prototype.slice.call(u));const p=Ge.box(Ge.types.avcC,new Uint8Array([1,n[3],n[4],n[5],252|3,224|t.sps.length].concat(n).concat([t.pps.length]).concat(a))),g=t.width,v=t.height,b=t.pixelRatio[0],L=t.pixelRatio[1];return Ge.box(Ge.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,g>>8&255,g&255,v>>8&255,v&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),p,Ge.box(Ge.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Ge.box(Ge.types.pasp,new Uint8Array([b>>24,b>>16&255,b>>8&255,b&255,L>>24,L>>16&255,L>>8&255,L&255])))}static esds(t){const n=t.config.length;return new Uint8Array([0,0,0,0,3,23+n,0,1,0,4,15+n,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([n]).concat(t.config).concat([6,1,2]))}static audioStsd(t){const n=t.samplerate;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,n>>8&255,n&255,0,0])}static mp4a(t){return Ge.box(Ge.types.mp4a,Ge.audioStsd(t),Ge.box(Ge.types.esds,Ge.esds(t)))}static mp3(t){return Ge.box(Ge.types[".mp3"],Ge.audioStsd(t))}static ac3(t){return Ge.box(Ge.types["ac-3"],Ge.audioStsd(t),Ge.box(Ge.types.dac3,t.config))}static stsd(t){return t.type==="audio"?t.segmentCodec==="mp3"&&t.codec==="mp3"?Ge.box(Ge.types.stsd,Ge.STSD,Ge.mp3(t)):t.segmentCodec==="ac3"?Ge.box(Ge.types.stsd,Ge.STSD,Ge.ac3(t)):Ge.box(Ge.types.stsd,Ge.STSD,Ge.mp4a(t)):Ge.box(Ge.types.stsd,Ge.STSD,Ge.avc1(t))}static tkhd(t){const n=t.id,a=t.duration*t.timescale,l=t.width,u=t.height,d=Math.floor(a/(Tr+1)),p=Math.floor(a%(Tr+1));return Ge.box(Ge.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,n>>24&255,n>>16&255,n>>8&255,n&255,0,0,0,0,d>>24,d>>16&255,d>>8&255,d&255,p>>24,p>>16&255,p>>8&255,p&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,l>>8&255,l&255,0,0,u>>8&255,u&255,0,0]))}static traf(t,n){const a=Ge.sdtp(t),l=t.id,u=Math.floor(n/(Tr+1)),d=Math.floor(n%(Tr+1));return Ge.box(Ge.types.traf,Ge.box(Ge.types.tfhd,new Uint8Array([0,0,0,0,l>>24,l>>16&255,l>>8&255,l&255])),Ge.box(Ge.types.tfdt,new Uint8Array([1,0,0,0,u>>24,u>>16&255,u>>8&255,u&255,d>>24,d>>16&255,d>>8&255,d&255])),Ge.trun(t,a.length+16+20+8+16+8+8),a)}static trak(t){return t.duration=t.duration||4294967295,Ge.box(Ge.types.trak,Ge.tkhd(t),Ge.mdia(t))}static trex(t){const n=t.id;return Ge.box(Ge.types.trex,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,n&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(t,n){const a=t.samples||[],l=a.length,u=12+16*l,d=new Uint8Array(u);let p,g,v,b,L,B;for(n+=8+u,d.set([t.type==="video"?1:0,0,15,1,l>>>24&255,l>>>16&255,l>>>8&255,l&255,n>>>24&255,n>>>16&255,n>>>8&255,n&255],0),p=0;p<l;p++)g=a[p],v=g.duration,b=g.size,L=g.flags,B=g.cts,d.set([v>>>24&255,v>>>16&255,v>>>8&255,v&255,b>>>24&255,b>>>16&255,b>>>8&255,b&255,L.isLeading<<2|L.dependsOn,L.isDependedOn<<6|L.hasRedundancy<<4|L.paddingValue<<1|L.isNonSync,L.degradPrio&240<<8,L.degradPrio&15,B>>>24&255,B>>>16&255,B>>>8&255,B&255],12+16*p);return Ge.box(Ge.types.trun,d)}static initSegment(t){Ge.types||Ge.init();const n=Ge.moov(t);return ft(Ge.FTYP,n)}}Ge.types=void 0,Ge.HDLR_TYPES=void 0,Ge.STTS=void 0,Ge.STSC=void 0,Ge.STCO=void 0,Ge.STSZ=void 0,Ge.VMHD=void 0,Ge.SMHD=void 0,Ge.STSD=void 0,Ge.FTYP=void 0,Ge.DINF=void 0;const td=9e4;function Hn(h,t,n=1,a=!1){const l=h*t*n;return a?Math.round(l):l}function Ni(h,t,n=1,a=!1){return Hn(h,t,1/n,a)}function Gn(h,t=!1){return Hn(h,1e3,1/td,t)}function id(h,t=1){return Hn(h,td,1/t)}const Bc=10*1e3,Ia=1024,Zn=1152,el=1536;let qn=null,ql=null;class Ra{constructor(t,n,a,l=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=t,this.config=n,this.typeSupported=a,this.ISGenerated=!1,qn===null){const d=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);qn=d?parseInt(d[1]):0}if(ql===null){const u=navigator.userAgent.match(/Safari\/(\d+)/i);ql=u?parseInt(u[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(t){C.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=t}resetNextTimestamp(){C.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){C.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(t){let n=!1;const a=t.reduce((l,u)=>{const d=u.pts-l;return d<-4294967296?(n=!0,Mn(l,u.pts)):d>0?l:u.pts},t[0].pts);return n&&C.debug("PTS rollover detected"),a}remux(t,n,a,l,u,d,p,g){let v,b,L,B,W,K,ee=u,re=u;const xe=t.pid>-1,Fe=n.pid>-1,Me=n.samples.length,it=t.samples.length>0,$e=p&&Me>0||Me>1;if((!xe||it)&&(!Fe||$e)||this.ISGenerated||p){if(this.ISGenerated){var Qe,yt,xt,ot;const ii=this.videoTrackConfig;ii&&(n.width!==ii.width||n.height!==ii.height||((Qe=n.pixelRatio)==null?void 0:Qe[0])!==((yt=ii.pixelRatio)==null?void 0:yt[0])||((xt=n.pixelRatio)==null?void 0:xt[1])!==((ot=ii.pixelRatio)==null?void 0:ot[1]))&&this.resetInitSegment()}else L=this.generateIS(t,n,u,d);const At=this.isVideoContiguous;let Re=-1,Pt;if($e&&(Re=nd(n.samples),!At&&this.config.forceKeyFrameOnDiscontinuity))if(K=!0,Re>0){C.warn(`[mp4-remuxer]: Dropped ${Re} out of ${Me} video samples due to a missing keyframe`);const ii=this.getVideoStartPts(n.samples);n.samples=n.samples.slice(Re),n.dropped+=Re,re+=(n.samples[0].pts-ii)/n.inputTimeScale,Pt=re}else Re===-1&&(C.warn(`[mp4-remuxer]: No keyframe found out of ${Me} video samples`),K=!1);if(this.ISGenerated){if(it&&$e){const ii=this.getVideoStartPts(n.samples),Qt=(Mn(t.samples[0].pts,ii)-ii)/n.inputTimeScale;ee+=Math.max(0,Qt),re+=Math.max(0,-Qt)}if(it){if(t.samplerate||(C.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),L=this.generateIS(t,n,u,d)),b=this.remuxAudio(t,ee,this.isAudioContiguous,d,Fe||$e||g===qt.AUDIO?re:void 0),$e){const ii=b?b.endPTS-b.startPTS:0;n.inputTimeScale||(C.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),L=this.generateIS(t,n,u,d)),v=this.remuxVideo(n,re,At,ii)}}else $e&&(v=this.remuxVideo(n,re,At,0));v&&(v.firstKeyFrame=Re,v.independent=Re!==-1,v.firstKeyFramePTS=Pt)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(a.samples.length&&(W=zl(a,u,this._initPTS,this._initDTS)),l.samples.length&&(B=tl(l,u,this._initPTS))),{audio:b,video:v,initSegment:L,independent:K,text:B,id3:W}}generateIS(t,n,a,l){const u=t.samples,d=n.samples,p=this.typeSupported,g={},v=this._initPTS;let b=!v||l,L="audio/mp4",B,W,K;if(b&&(B=W=Infinity),t.config&&u.length){switch(t.timescale=t.samplerate,t.segmentCodec){case"mp3":p.mpeg?(L="audio/mpeg",t.codec=""):p.mp3&&(t.codec="mp3");break;case"ac3":t.codec="ac-3";break}g.audio={id:"audio",container:L,codec:t.codec,initSegment:t.segmentCodec==="mp3"&&p.mpeg?new Uint8Array(0):Ge.initSegment([t]),metadata:{channelCount:t.channelCount}},b&&(K=t.inputTimeScale,!v||K!==v.timescale?B=W=u[0].pts-Math.round(K*a):b=!1)}if(n.sps&&n.pps&&d.length){if(n.timescale=n.inputTimeScale,g.video={id:"main",container:"video/mp4",codec:n.codec,initSegment:Ge.initSegment([n]),metadata:{width:n.width,height:n.height}},b)if(K=n.inputTimeScale,!v||K!==v.timescale){const ee=this.getVideoStartPts(d),re=Math.round(K*a);W=Math.min(W,Mn(d[0].dts,ee)-re),B=Math.min(B,ee-re)}else b=!1;this.videoTrackConfig={width:n.width,height:n.height,pixelRatio:n.pixelRatio}}if(Object.keys(g).length)return this.ISGenerated=!0,b?(this._initPTS={baseTime:B,timescale:K},this._initDTS={baseTime:W,timescale:K}):B=K=void 0,{tracks:g,initPTS:B,timescale:K}}remuxVideo(t,n,a,l){const u=t.inputTimeScale,d=t.samples,p=[],g=d.length,v=this._initPTS;let b=this.nextAvcDts,L=8,B=this.videoSampleDuration,W,K,ee=Number.POSITIVE_INFINITY,re=Number.NEGATIVE_INFINITY,xe=!1;if(!a||b===null){const Ft=n*u,St=d[0].pts-Mn(d[0].dts,d[0].pts);qn&&b!==null&&Math.abs(Ft-St-b)<15e3?a=!0:b=Ft-St}const Fe=v.baseTime*u/v.timescale;for(let Ft=0;Ft<g;Ft++){const St=d[Ft];St.pts=Mn(St.pts-Fe,b),St.dts=Mn(St.dts-Fe,b),St.dts<d[Ft>0?Ft-1:Ft].dts&&(xe=!0)}xe&&d.sort(function(Ft,St){const $t=Ft.dts-St.dts,zt=Ft.pts-St.pts;return $t||zt}),W=d[0].dts,K=d[d.length-1].dts;const Me=K-W,it=Me?Math.round(Me/(g-1)):B||t.inputTimeScale/30;if(a){const Ft=W-b,St=Ft>it,$t=Ft<-1;if((St||$t)&&(St?C.warn(`AVC: ${Gn(Ft,!0)} ms (${Ft}dts) hole between fragments detected at ${n.toFixed(3)}`):C.warn(`AVC: ${Gn(-Ft,!0)} ms (${Ft}dts) overlapping between fragments detected at ${n.toFixed(3)}`),!$t||b>=d[0].pts||qn)){W=b;const zt=d[0].pts-Ft;if(St)d[0].dts=W,d[0].pts=zt;else for(let wi=0;wi<d.length&&!(d[wi].dts>zt);wi++)d[wi].dts-=Ft,d[wi].pts-=Ft;C.log(`Video: Initial PTS/DTS adjusted: ${Gn(zt,!0)}/${Gn(W,!0)}, delta: ${Gn(Ft,!0)} ms`)}}W=Math.max(0,W);let $e=0,ut=0,Qe=W;for(let Ft=0;Ft<g;Ft++){const St=d[Ft],$t=St.units,zt=$t.length;let wi=0;for(let Li=0;Li<zt;Li++)wi+=$t[Li].data.length;ut+=wi,$e+=zt,St.length=wi,St.dts<Qe?(St.dts=Qe,Qe+=it/4|0||1):Qe=St.dts,ee=Math.min(St.pts,ee),re=Math.max(St.pts,re)}K=d[g-1].dts;const yt=ut+4*$e+8;let xt;try{xt=new Uint8Array(yt)}catch(Ft){this.observer.emit(A.ERROR,A.ERROR,{type:M.MUX_ERROR,details:k.REMUX_ALLOC_ERROR,fatal:!1,error:Ft,bytes:yt,reason:`fail allocating video mdat ${yt}`});return}const ot=new DataView(xt.buffer);ot.setUint32(0,yt),xt.set(Ge.types.mdat,4);let At=!1,Re=Number.POSITIVE_INFINITY,Pt=Number.POSITIVE_INFINITY,ii=Number.NEGATIVE_INFINITY,ri=Number.NEGATIVE_INFINITY;for(let Ft=0;Ft<g;Ft++){const St=d[Ft],$t=St.units;let zt=0;for(let Pi=0,vn=$t.length;Pi<vn;Pi++){const xn=$t[Pi],Is=xn.data,Ru=xn.data.byteLength;ot.setUint32(L,Ru),L+=4,xt.set(Is,L),L+=Ru,zt+=4+Ru}let wi;if(Ft<g-1)B=d[Ft+1].dts-St.dts,wi=d[Ft+1].pts-St.pts;else{const Pi=this.config,vn=Ft>0?St.dts-d[Ft-1].dts:it;if(wi=Ft>0?St.pts-d[Ft-1].pts:it,Pi.stretchShortVideoTrack&&this.nextAudioPts!==null){const xn=Math.floor(Pi.maxBufferHole*u),Is=(l?ee+l*u:this.nextAudioPts)-St.pts;Is>xn?(B=Is-vn,B<0?B=vn:At=!0,C.log(`[mp4-remuxer]: It is approximately ${Is/90} ms to the next segment; using duration ${B/90} ms for the last video frame.`)):B=vn}else B=vn}const Li=Math.round(St.pts-St.dts);Re=Math.min(Re,B),ii=Math.max(ii,B),Pt=Math.min(Pt,wi),ri=Math.max(ri,wi),p.push(new Ss(St.key,B,zt,Li))}if(p.length){if(qn){if(qn<70){const Ft=p[0].flags;Ft.dependsOn=2,Ft.isNonSync=0}}else if(ql&&ri-Pt<ii-Re&&it/ii<.025&&p[0].cts===0){C.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let Ft=W;for(let St=0,$t=p.length;St<$t;St++){const zt=Ft+p[St].duration,wi=Ft+p[St].cts;if(St<$t-1){const Li=zt+p[St+1].cts;p[St].duration=Li-wi}else p[St].duration=St?p[St-1].duration:it;p[St].cts=0,Ft=zt}}}B=At||!B?it:B,this.nextAvcDts=b=K+B,this.videoSampleDuration=B,this.isVideoContiguous=!0;const Qt=Ge.moof(t.sequenceNumber++,W,se({},t,{samples:p})),gi="video",li={data1:Qt,data2:xt,startPTS:ee/u,endPTS:(re+B)/u,startDTS:W/u,endDTS:b/u,type:gi,hasAudio:!1,hasVideo:!0,nb:p.length,dropped:t.dropped};return t.samples=[],t.dropped=0,li}getSamplesPerFrame(t){switch(t.segmentCodec){case"mp3":return Zn;case"ac3":return el;default:return Ia}}remuxAudio(t,n,a,l,u){const d=t.inputTimeScale,p=t.samplerate?t.samplerate:d,g=d/p,v=this.getSamplesPerFrame(t),b=v*g,L=this._initPTS,B=t.segmentCodec==="mp3"&&this.typeSupported.mpeg,W=[],K=u!==void 0;let ee=t.samples,re=B?0:8,xe=this.nextAudioPts||-1;const Fe=n*d,Me=L.baseTime*d/L.timescale;if(this.isAudioContiguous=a=a||ee.length&&xe>0&&(l&&Math.abs(Fe-xe)<9e3||Math.abs(Mn(ee[0].pts-Me,Fe)-xe)<20*b),ee.forEach(function(Qt){Qt.pts=Mn(Qt.pts-Me,Fe)}),!a||xe<0){if(ee=ee.filter(Qt=>Qt.pts>=0),!ee.length)return;u===0?xe=0:l&&!K?xe=Math.max(0,Fe):xe=ee[0].pts}if(t.segmentCodec==="aac"){const Qt=this.config.maxAudioFramesDrift;for(let gi=0,li=xe;gi<ee.length;gi++){const Ft=ee[gi],St=Ft.pts,$t=St-li,zt=Math.abs(1e3*$t/d);if($t<=-Qt*b&&K)gi===0&&(C.warn(`Audio frame @ ${(St/d).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*$t/d)} ms.`),this.nextAudioPts=xe=li=St);else if($t>=Qt*b&&zt<Bc&&K){let wi=Math.round($t/b);li=St-wi*b,li<0&&(wi--,li+=b),gi===0&&(this.nextAudioPts=xe=li),C.warn(`[mp4-remuxer]: Injecting ${wi} audio frame @ ${(li/d).toFixed(3)}s due to ${Math.round(1e3*$t/d)} ms gap.`);for(let Li=0;Li<wi;Li++){const Pi=Math.max(li,0);let vn=Js.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);vn||(C.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),vn=Ft.unit.subarray()),ee.splice(gi,0,{unit:vn,pts:Pi}),li+=b,gi++}}Ft.pts=li,li+=b}}let it=null,$e=null,ut,Qe=0,yt=ee.length;for(;yt--;)Qe+=ee[yt].unit.byteLength;for(let Qt=0,gi=ee.length;Qt<gi;Qt++){const li=ee[Qt],Ft=li.unit;let St=li.pts;if($e!==null){const zt=W[Qt-1];zt.duration=Math.round((St-$e)/g)}else if(a&&t.segmentCodec==="aac"&&(St=xe),it=St,Qe>0){Qe+=re;try{ut=new Uint8Array(Qe)}catch(zt){this.observer.emit(A.ERROR,A.ERROR,{type:M.MUX_ERROR,details:k.REMUX_ALLOC_ERROR,fatal:!1,error:zt,bytes:Qe,reason:`fail allocating audio mdat ${Qe}`});return}B||(new DataView(ut.buffer).setUint32(0,Qe),ut.set(Ge.types.mdat,4))}else return;ut.set(Ft,re);const $t=Ft.byteLength;re+=$t,W.push(new Ss(!0,v,$t,0)),$e=St}const xt=W.length;if(!xt)return;const ot=W[W.length-1];this.nextAudioPts=xe=$e+g*ot.duration;const At=B?new Uint8Array(0):Ge.moof(t.sequenceNumber++,it/g,se({},t,{samples:W}));t.samples=[];const Re=it/d,Pt=xe/d,ri={data1:At,data2:ut,startPTS:Re,endPTS:Pt,startDTS:Re,endDTS:Pt,type:"audio",hasAudio:!0,hasVideo:!1,nb:xt};return this.isAudioContiguous=!0,ri}remuxEmptyAudio(t,n,a,l){const u=t.inputTimeScale,d=t.samplerate?t.samplerate:u,p=u/d,g=this.nextAudioPts,v=this._initDTS,b=v.baseTime*9e4/v.timescale,L=(g!==null?g:l.startDTS*u)+b,B=l.endDTS*u+b,W=p*Ia,K=Math.ceil((B-L)/W),ee=Js.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(C.warn("[mp4-remuxer]: remux empty Audio"),!ee){C.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}const re=[];for(let xe=0;xe<K;xe++){const Fe=L+xe*W;re.push({unit:ee,pts:Fe,dts:Fe})}return t.samples=re,this.remuxAudio(t,n,a,!1)}}function Mn(h,t){let n;if(t===null)return h;for(t<h?n=-8589934592:n=8589934592;Math.abs(h-t)>4294967296;)h+=n;return h}function nd(h){for(let t=0;t<h.length;t++)if(h[t].key)return t;return-1}function zl(h,t,n,a){const l=h.samples.length;if(!l)return;const u=h.inputTimeScale;for(let p=0;p<l;p++){const g=h.samples[p];g.pts=Mn(g.pts-n.baseTime*u/n.timescale,t*u)/u,g.dts=Mn(g.dts-a.baseTime*u/a.timescale,t*u)/u}const d=h.samples;return h.samples=[],{samples:d}}function tl(h,t,n){const a=h.samples.length;if(!a)return;const l=h.inputTimeScale;for(let d=0;d<a;d++){const p=h.samples[d];p.pts=Mn(p.pts-n.baseTime*l/n.timescale,t*l)/l}h.samples.sort((d,p)=>d.pts-p.pts);const u=h.samples;return h.samples=[],{samples:u}}class Ss{constructor(t,n,a,l){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=n,this.size=a,this.cts=l,this.flags={isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:t?2:1,isNonSync:t?0:1}}}class Mc{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(t){this.initPTS=t,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(t,n,a,l){this.audioCodec=n,this.videoCodec=a,this.generateInitSegment(Fs(t,l)),this.emitInitSegment=!0}generateInitSegment(t){let{audioCodec:n,videoCodec:a}=this;if(!(t!=null&&t.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const l=this.initData=Kr(t);l.audio&&(n=rd(l.audio,be.AUDIO)),l.video&&(a=rd(l.video,be.VIDEO));const u={};l.audio&&l.video?u.audiovideo={container:"video/mp4",codec:n+","+a,initSegment:t,id:"main"}:l.audio?u.audio={container:"audio/mp4",codec:n,initSegment:t,id:"audio"}:l.video?u.video={container:"video/mp4",codec:a,initSegment:t,id:"main"}:C.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=u}remux(t,n,a,l,u,d){var p,g;let{initPTS:v,lastEndTime:b}=this;const L={audio:void 0,video:void 0,text:l,id3:a,initSegment:void 0};te(b)||(b=this.lastEndTime=u||0);const B=n.samples;if(!(B!=null&&B.length))return L;const W={initPTS:void 0,timescale:1};let K=this.initData;if((p=K)!=null&&p.length||(this.generateInitSegment(B),K=this.initData),!((g=K)!=null&&g.length))return C.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),L;this.emitInitSegment&&(W.tracks=this.initTracks,this.emitInitSegment=!1);const ee=ie(B,K),re=ko(K,B),xe=re===null?u:re;(Wl(v,xe,u,ee)||W.timescale!==v.timescale&&d)&&(W.initPTS=xe-u,v&&v.timescale===1&&C.warn(`Adjusting initPTS by ${W.initPTS-v.baseTime}`),this.initPTS=v={baseTime:W.initPTS,timescale:1});const Fe=t?xe-v.baseTime/v.timescale:b,Me=Fe+ee;Se(K,B,v.baseTime/v.timescale),ee>0?this.lastEndTime=Me:(C.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const it=!!K.audio,$e=!!K.video;let ut="";it&&(ut+="audio"),$e&&(ut+="video");const Qe={data1:B,startPTS:Fe,startDTS:Fe,endPTS:Me,endDTS:Me,type:ut,hasAudio:it,hasVideo:$e,nb:1,dropped:0};return L.audio=Qe.type==="audio"?Qe:void 0,L.video=Qe.type!=="audio"?Qe:void 0,L.initSegment=W,L.id3=zl(a,u,v,v),l.samples.length&&(L.text=tl(l,u,v)),L}}function Wl(h,t,n,a){if(h===null)return!0;const l=Math.max(a,1),u=t-h.baseTime/h.timescale;return Math.abs(u-n)>l}function rd(h,t){const n=h==null?void 0:h.codec;if(n&&n.length>4)return n;if(t===be.AUDIO){if(n==="ec-3"||n==="ac-3"||n==="alac")return n;if(n==="fLaC"||n==="Opus")return ps(n,!1);const a="mp4a.40.5";return C.info(`Parsed audio codec "${n}" or audio object type not handled. Using "${a}"`),a}return C.warn(`Unhandled video codec "${n}"`),n==="hvc1"||n==="hev1"?"hvc1.1.6.L120.90":n==="av01"?"av01.0.04M.08":"avc1.42e01e"}let Hr;try{Hr=self.performance.now.bind(self.performance)}catch(h){C.debug("Unable to use Performance API on this environment"),Hr=gt==null?void 0:gt.Date.now}const Cs=[{demux:qi,remux:Mc},{demux:rs,remux:Ra},{demux:Zt,remux:Ra},{demux:wn,remux:Ra}];Cs.splice(2,0,{demux:hr,remux:Ra});class zi{constructor(t,n,a,l,u){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=t,this.typeSupported=n,this.config=a,this.vendor=l,this.id=u}configure(t){this.transmuxConfig=t,this.decrypter&&this.decrypter.reset()}push(t,n,a,l){const u=a.transmuxing;u.executeStart=Hr();let d=new Uint8Array(t);const{currentTransmuxState:p,transmuxConfig:g}=this;l&&(this.currentTransmuxState=l);const{contiguous:v,discontinuity:b,trackSwitch:L,accurateTimeOffset:B,timeOffset:W,initSegmentChange:K}=l||p,{audioCodec:ee,videoCodec:re,defaultInitPts:xe,duration:Fe,initSegmentData:Me}=g,it=sd(d,n);if(it&&it.method==="AES-128"){const yt=this.getDecrypter();if(yt.isSync()){let xt=yt.softwareDecrypt(d,it.key.buffer,it.iv.buffer);if(a.part>-1&&(xt=yt.flush()),!xt)return u.executeEnd=Hr(),Kl(a);d=new Uint8Array(xt)}else return this.decryptionPromise=yt.webCryptoDecrypt(d,it.key.buffer,it.iv.buffer).then(xt=>{const ot=this.push(xt,null,a);return this.decryptionPromise=null,ot}),this.decryptionPromise}const $e=this.needsProbing(b,L);if($e){const yt=this.configureTransmuxer(d);if(yt)return C.warn(`[transmuxer] ${yt.message}`),this.observer.emit(A.ERROR,A.ERROR,{type:M.MEDIA_ERROR,details:k.FRAG_PARSING_ERROR,fatal:!1,error:yt,reason:yt.message}),u.executeEnd=Hr(),Kl(a)}(b||L||K||$e)&&this.resetInitSegment(Me,ee,re,Fe,n),(b||K||$e)&&this.resetInitialTimestamp(xe),v||this.resetContiguity();const ut=this.transmux(d,it,W,B,a),Qe=this.currentTransmuxState;return Qe.contiguous=!0,Qe.discontinuity=!1,Qe.trackSwitch=!1,u.executeEnd=Hr(),ut}flush(t){const n=t.transmuxing;n.executeStart=Hr();const{decrypter:a,currentTransmuxState:l,decryptionPromise:u}=this;if(u)return u.then(()=>this.flush(t));const d=[],{timeOffset:p}=l;if(a){const L=a.flush();L&&d.push(this.push(L,null,t))}const{demuxer:g,remuxer:v}=this;if(!g||!v)return n.executeEnd=Hr(),[Kl(t)];const b=g.flush(p);return et(b)?b.then(L=>(this.flushRemux(d,L,t),d)):(this.flushRemux(d,b,t),d)}flushRemux(t,n,a){const{audioTrack:l,videoTrack:u,id3Track:d,textTrack:p}=n,{accurateTimeOffset:g,timeOffset:v}=this.currentTransmuxState;C.log(`[transmuxer.ts]: Flushed fragment ${a.sn}${a.part>-1?" p: "+a.part:""} of level ${a.level}`);const b=this.remuxer.remux(l,u,d,p,v,g,!0,this.id);t.push({remuxResult:b,chunkMeta:a}),a.transmuxing.executeEnd=Hr()}resetInitialTimestamp(t){const{demuxer:n,remuxer:a}=this;!n||!a||(n.resetTimeStamp(t),a.resetTimeStamp(t))}resetContiguity(){const{demuxer:t,remuxer:n}=this;!t||!n||(t.resetContiguity(),n.resetNextTimestamp())}resetInitSegment(t,n,a,l,u){const{demuxer:d,remuxer:p}=this;!d||!p||(d.resetInitSegment(t,n,a,l),p.resetInitSegment(t,n,a,u))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(t,n,a,l,u){let d;return n&&n.method==="SAMPLE-AES"?d=this.transmuxSampleAes(t,n,a,l,u):d=this.transmuxUnencrypted(t,a,l,u),d}transmuxUnencrypted(t,n,a,l){const{audioTrack:u,videoTrack:d,id3Track:p,textTrack:g}=this.demuxer.demux(t,n,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(u,d,p,g,n,a,!1,this.id),chunkMeta:l}}transmuxSampleAes(t,n,a,l,u){return this.demuxer.demuxSampleAes(t,n,a).then(d=>({remuxResult:this.remuxer.remux(d.audioTrack,d.videoTrack,d.id3Track,d.textTrack,a,l,!1,this.id),chunkMeta:u}))}configureTransmuxer(t){const{config:n,observer:a,typeSupported:l,vendor:u}=this;let d;for(let B=0,W=Cs.length;B<W;B++){var p;if((p=Cs[B].demux)!=null&&p.probe(t)){d=Cs[B];break}}if(!d)return new Error("Failed to find demuxer by probing fragment data");const g=this.demuxer,v=this.remuxer,b=d.remux,L=d.demux;(!v||!(v instanceof b))&&(this.remuxer=new b(a,n,l,u)),(!g||!(g instanceof L))&&(this.demuxer=new L(a,n,l),this.probe=L.probe)}needsProbing(t,n){return!this.demuxer||!this.remuxer||t||n}getDecrypter(){let t=this.decrypter;return t||(t=this.decrypter=new Da(this.config)),t}}function sd(h,t){let n=null;return h.byteLength>0&&(t==null?void 0:t.key)!=null&&t.iv!==null&&t.method!=null&&(n=t),n}const Kl=h=>({remuxResult:{},chunkMeta:h});function et(h){return"then"in h&&h.then instanceof Function}class Fc{constructor(t,n,a,l,u){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=t,this.videoCodec=n,this.initSegmentData=a,this.duration=l,this.defaultInitPts=u||null}}class ad{constructor(t,n,a,l,u,d){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=t,this.contiguous=n,this.accurateTimeOffset=a,this.trackSwitch=l,this.timeOffset=u,this.initSegmentChange=d}}var il={exports:{}};(function(h){var t=Object.prototype.hasOwnProperty,n="~";function a(){}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(n=!1));function l(g,v,b){this.fn=g,this.context=v,this.once=b||!1}function u(g,v,b,L,B){if(typeof b!="function")throw new TypeError("The listener must be a function");var W=new l(b,L||g,B),K=n?n+v:v;return g._events[K]?g._events[K].fn?g._events[K]=[g._events[K],W]:g._events[K].push(W):(g._events[K]=W,g._eventsCount++),g}function d(g,v){--g._eventsCount==0?g._events=new a:delete g._events[v]}function p(){this._events=new a,this._eventsCount=0}p.prototype.eventNames=function(){var v=[],b,L;if(this._eventsCount===0)return v;for(L in b=this._events)t.call(b,L)&&v.push(n?L.slice(1):L);return Object.getOwnPropertySymbols?v.concat(Object.getOwnPropertySymbols(b)):v},p.prototype.listeners=function(v){var b=n?n+v:v,L=this._events[b];if(!L)return[];if(L.fn)return[L.fn];for(var B=0,W=L.length,K=new Array(W);B<W;B++)K[B]=L[B].fn;return K},p.prototype.listenerCount=function(v){var b=n?n+v:v,L=this._events[b];return L?L.fn?1:L.length:0},p.prototype.emit=function(v,b,L,B,W,K){var ee=n?n+v:v;if(!this._events[ee])return!1;var re=this._events[ee],xe=arguments.length,Fe,Me;if(re.fn){switch(re.once&&this.removeListener(v,re.fn,void 0,!0),xe){case 1:return re.fn.call(re.context),!0;case 2:return re.fn.call(re.context,b),!0;case 3:return re.fn.call(re.context,b,L),!0;case 4:return re.fn.call(re.context,b,L,B),!0;case 5:return re.fn.call(re.context,b,L,B,W),!0;case 6:return re.fn.call(re.context,b,L,B,W,K),!0}for(Me=1,Fe=new Array(xe-1);Me<xe;Me++)Fe[Me-1]=arguments[Me];re.fn.apply(re.context,Fe)}else{var it=re.length,$e;for(Me=0;Me<it;Me++)switch(re[Me].once&&this.removeListener(v,re[Me].fn,void 0,!0),xe){case 1:re[Me].fn.call(re[Me].context);break;case 2:re[Me].fn.call(re[Me].context,b);break;case 3:re[Me].fn.call(re[Me].context,b,L);break;case 4:re[Me].fn.call(re[Me].context,b,L,B);break;default:if(!Fe)for($e=1,Fe=new Array(xe-1);$e<xe;$e++)Fe[$e-1]=arguments[$e];re[Me].fn.apply(re[Me].context,Fe)}}return!0},p.prototype.on=function(v,b,L){return u(this,v,b,L,!1)},p.prototype.once=function(v,b,L){return u(this,v,b,L,!0)},p.prototype.removeListener=function(v,b,L,B){var W=n?n+v:v;if(!this._events[W])return this;if(!b)return d(this,W),this;var K=this._events[W];if(K.fn)K.fn===b&&(!B||K.once)&&(!L||K.context===L)&&d(this,W);else{for(var ee=0,re=[],xe=K.length;ee<xe;ee++)(K[ee].fn!==b||B&&!K[ee].once||L&&K[ee].context!==L)&&re.push(K[ee]);re.length?this._events[W]=re.length===1?re[0]:re:d(this,W)}return this},p.prototype.removeAllListeners=function(v){var b;return v?(b=n?n+v:v,this._events[b]&&d(this,b)):(this._events=new a,this._eventsCount=0),this},p.prototype.off=p.prototype.removeListener,p.prototype.addListener=p.prototype.on,p.prefixed=n,p.EventEmitter=p,h.exports=p})(il);var Sr=il.exports,nl=ct(Sr);class rl{constructor(t,n,a,l){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const u=t.config;this.hls=t,this.id=n,this.useWorker=!!u.enableWorker,this.onTransmuxComplete=a,this.onFlush=l;const d=(v,b)=>{b=b||{},b.frag=this.frag,b.id=this.id,v===A.ERROR&&(this.error=b.error),this.hls.trigger(v,b)};this.observer=new nl,this.observer.on(A.FRAG_DECRYPTED,d),this.observer.on(A.ERROR,d);const p=ar(u.preferManagedMediaSource)||{isTypeSupported:()=>!1},g={mpeg:p.isTypeSupported("audio/mpeg"),mp3:p.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:p.isTypeSupported('audio/mp4; codecs="ac-3"')};if(this.useWorker&&typeof Worker!="undefined"&&(u.workerPath||Yo())){try{u.workerPath?(C.log(`loading Web Worker ${u.workerPath} for "${n}"`),this.workerContext=Vn(u.workerPath)):(C.log(`injecting Web Worker for "${n}"`),this.workerContext=Xt()),this.onwmsg=L=>this.onWorkerMessage(L);const{worker:b}=this.workerContext;b.addEventListener("message",this.onwmsg),b.onerror=L=>{const B=new Error(`${L.message}  (${L.filename}:${L.lineno})`);u.enableWorker=!1,C.warn(`Error in "${n}" Web Worker, fallback to inline`),this.hls.trigger(A.ERROR,{type:M.OTHER_ERROR,details:k.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:B})},b.postMessage({cmd:"init",typeSupported:g,vendor:"",id:n,config:JSON.stringify(u)})}catch(b){C.warn(`Error setting up "${n}" Web Worker, fallback to inline`,b),this.resetWorker(),this.error=null,this.transmuxer=new zi(this.observer,g,u,"",n)}return}this.transmuxer=new zi(this.observer,g,u,"",n)}resetWorker(){if(this.workerContext){const{worker:t,objectURL:n}=this.workerContext;n&&self.URL.revokeObjectURL(n),t.removeEventListener("message",this.onwmsg),t.onerror=null,t.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const n=this.transmuxer;n&&(n.destroy(),this.transmuxer=null)}const t=this.observer;t&&t.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(t,n,a,l,u,d,p,g,v,b){var L,B;v.transmuxing.start=self.performance.now();const{transmuxer:W}=this,K=d?d.start:u.start,ee=u.decryptdata,re=this.frag,xe=!(re&&u.cc===re.cc),Fe=!(re&&v.level===re.level),Me=re?v.sn-re.sn:-1,it=this.part?v.part-this.part.index:-1,$e=Me===0&&v.id>1&&v.id===(re==null?void 0:re.stats.chunkCount),ut=!Fe&&(Me===1||Me===0&&(it===1||$e&&it<=0)),Qe=self.performance.now();(Fe||Me||u.stats.parsing.start===0)&&(u.stats.parsing.start=Qe),d&&(it||!ut)&&(d.stats.parsing.start=Qe);const yt=!(re&&((L=u.initSegment)==null?void 0:L.url)===((B=re.initSegment)==null?void 0:B.url)),xt=new ad(xe,ut,g,Fe,K,yt);if(!ut||xe||yt){C.log(`[transmuxer-interface, ${u.type}]: Starting new transmux session for sn: ${v.sn} p: ${v.part} level: ${v.level} id: ${v.id}
        discontinuity: ${xe}
        trackSwitch: ${Fe}
        contiguous: ${ut}
        accurateTimeOffset: ${g}
        timeOffset: ${K}
        initSegmentChange: ${yt}`);const ot=new Fc(a,l,n,p,b);this.configureTransmuxer(ot)}if(this.frag=u,this.part=d,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:t,decryptdata:ee,chunkMeta:v,state:xt},t instanceof ArrayBuffer?[t]:[]);else if(W){const ot=W.push(t,ee,v,xt);et(ot)?(W.async=!0,ot.then(At=>{this.handleTransmuxComplete(At)}).catch(At=>{this.transmuxerError(At,v,"transmuxer-interface push error")})):(W.async=!1,this.handleTransmuxComplete(ot))}}flush(t){t.transmuxing.start=self.performance.now();const{transmuxer:n}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:t});else if(n){let a=n.flush(t);et(a)||n.async?(et(a)||(a=Promise.resolve(a)),a.then(u=>{this.handleFlushResult(u,t)}).catch(u=>{this.transmuxerError(u,t,"transmuxer-interface flush error")})):this.handleFlushResult(a,t)}}transmuxerError(t,n,a){!this.hls||(this.error=t,this.hls.trigger(A.ERROR,{type:M.MEDIA_ERROR,details:k.FRAG_PARSING_ERROR,chunkMeta:n,frag:this.frag||void 0,fatal:!1,error:t,err:t,reason:a}))}handleFlushResult(t,n){t.forEach(a=>{this.handleTransmuxComplete(a)}),this.onFlush(n)}onWorkerMessage(t){const n=t.data;if(!(n!=null&&n.event)){C.warn(`worker message received with no ${n?"event name":"data"}`);return}const a=this.hls;if(!!this.hls)switch(n.event){case"init":{var l;const u=(l=this.workerContext)==null?void 0:l.objectURL;u&&self.URL.revokeObjectURL(u);break}case"transmuxComplete":{this.handleTransmuxComplete(n.data);break}case"flush":{this.onFlush(n.data);break}case"workerLog":C[n.data.logType]&&C[n.data.logType](n.data.message);break;default:{n.data=n.data||{},n.data.frag=this.frag,n.data.id=this.id,a.trigger(n.event,n.data);break}}}configureTransmuxer(t){const{transmuxer:n}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:t}):n&&n.configure(t)}handleTransmuxComplete(t){t.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(t)}}function Yl(h,t){if(h.length!==t.length)return!1;for(let n=0;n<h.length;n++)if(!Zs(h[n].attrs,t[n].attrs))return!1;return!0}function Zs(h,t,n){const a=h["STABLE-RENDITION-ID"];return a&&!n?a===t["STABLE-RENDITION-ID"]:!(n||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(l=>h[l]!==t[l])}function ss(h,t){return t.label.toLowerCase()===h.name.toLowerCase()&&(!t.language||t.language.toLowerCase()===(h.lang||"").toLowerCase())}const od=100;class ld extends jr{constructor(t,n,a){super(t,n,a,"[audio-stream-controller]",qt.AUDIO);this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:t}=this;t.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(A.MANIFEST_LOADING,this.onManifestLoading,this),t.on(A.LEVEL_LOADED,this.onLevelLoaded,this),t.on(A.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.on(A.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(A.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(A.ERROR,this.onError,this),t.on(A.BUFFER_RESET,this.onBufferReset,this),t.on(A.BUFFER_CREATED,this.onBufferCreated,this),t.on(A.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(A.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(A.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(A.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:t}=this;t.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(A.MANIFEST_LOADING,this.onManifestLoading,this),t.off(A.LEVEL_LOADED,this.onLevelLoaded,this),t.off(A.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),t.off(A.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(A.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(A.ERROR,this.onError,this),t.off(A.BUFFER_RESET,this.onBufferReset,this),t.off(A.BUFFER_CREATED,this.onBufferCreated,this),t.off(A.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(A.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(A.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(A.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(t,{frag:n,id:a,initPTS:l,timescale:u}){if(a==="main"){const d=n.cc;this.initPTS[n.cc]={baseTime:l,timescale:u},this.log(`InitPTS for cc: ${d} found from main: ${l}`),this.videoTrackCC=d,this.state===st.WAITING_INIT_PTS&&this.tick()}}startLoad(t){if(!this.levels){this.startPosition=t,this.state=st.STOPPED;return}const n=this.lastCurrentTime;this.stopLoad(),this.setInterval(od),n>0&&t===-1?(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),t=n,this.state=st.IDLE):(this.loadedmetadata=!1,this.state=st.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}doTick(){switch(this.state){case st.IDLE:this.doTickIdle();break;case st.WAITING_TRACK:{var t;const{levels:a,trackId:l}=this,u=a==null||(t=a[l])==null?void 0:t.details;if(u){if(this.waitForCdnTuneIn(u))break;this.state=st.WAITING_INIT_PTS}break}case st.FRAG_LOADING_WAITING_RETRY:{var n;const a=performance.now(),l=this.retryDate;if(!l||a>=l||(n=this.media)!=null&&n.seeking){const{levels:u,trackId:d}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((u==null?void 0:u[d])||null),this.state=st.IDLE}break}case st.WAITING_INIT_PTS:{const a=this.waitingData;if(a){const{frag:l,part:u,cache:d,complete:p}=a;if(this.initPTS[l.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=st.FRAG_LOADING;const g=d.flush(),v={frag:l,part:u,payload:g,networkDetails:null};this._handleFragmentLoadProgress(v),p&&super._handleFragmentLoadComplete(v)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${l.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const g=this.getLoadPosition(),v=oi.bufferInfo(this.mediaBuffer,g,this.config.maxBufferHole);Or(v.end,this.config.maxFragLookUpTolerance,l)<0&&(this.log(`Waiting fragment cc (${l.cc}) @ ${l.start} cancelled because another fragment at ${v.end} is needed`),this.clearWaitingFragment())}}else this.state=st.IDLE}}this.onTickEnd()}clearWaitingFragment(){const t=this.waitingData;t&&(this.fragmentTracker.removeFragment(t.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=st.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:t}=this;!(t!=null&&t.readyState)||(this.lastCurrentTime=t.currentTime)}doTickIdle(){const{hls:t,levels:n,media:a,trackId:l}=this,u=t.config;if(!a&&(this.startFragRequested||!u.startFragPrefetch)||!(n!=null&&n[l]))return;const d=n[l],p=d.details;if(!p||p.live&&this.levelLastLoaded!==d||this.waitForCdnTuneIn(p)){this.state=st.WAITING_TRACK;return}const g=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&g&&(this.bufferFlushed=!1,this.afterBufferFlushed(g,be.AUDIO,qt.AUDIO));const v=this.getFwdBufferInfo(g,qt.AUDIO);if(v===null)return;const{bufferedTrack:b,switchingTrack:L}=this;if(!L&&this._streamEnded(v,p)){t.trigger(A.BUFFER_EOS,{type:"audio"}),this.state=st.ENDED;return}const B=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,qt.MAIN),W=v.len,K=this.getMaxBufferLength(B==null?void 0:B.len),ee=p.fragments,re=ee[0].start;let xe=this.flushing?this.getLoadPosition():v.end;if(L&&a){const $e=this.getLoadPosition();b&&!Zs(L.attrs,b.attrs)&&(xe=$e),p.PTSKnown&&$e<re&&(v.end>re||v.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),a.currentTime=re+.05)}if(W>=K&&!L&&xe<ee[ee.length-1].start)return;let Fe=this.getNextFragment(xe,p),Me=!1;if(Fe&&this.isLoopLoading(Fe,xe)&&(Me=!!Fe.gap,Fe=this.getNextFragmentLoopLoading(Fe,p,v,qt.MAIN,K)),!Fe){this.bufferFlushed=!0;return}const it=B&&Fe.start>B.end+p.targetduration;if(it||!(B!=null&&B.len)&&v.len){const $e=this.getAppendedFrag(Fe.start,qt.MAIN);if($e===null||(Me||(Me=!!$e.gap||!!it&&B.len===0),it&&!Me||Me&&v.nextStart&&v.nextStart<$e.end))return}this.loadFragment(Fe,d,xe)}getMaxBufferLength(t){const n=super.getMaxBufferLength();return t?Math.min(Math.max(n,t),this.config.maxMaxBufferLength):n}onMediaDetaching(){this.videoBuffer=null,this.bufferFlushed=this.flushing=!1,super.onMediaDetaching()}onAudioTracksUpdated(t,{audioTracks:n}){this.resetTransmuxer(),this.levels=n.map(a=>new or(a))}onAudioTrackSwitching(t,n){const a=!!n.url;this.trackId=n.id;const{fragCurrent:l}=this;l&&(l.abortRequests(),this.removeUnbufferedFrags(l.start)),this.resetLoadingState(),a?this.setInterval(od):this.resetTransmuxer(),a?(this.switchingTrack=n,this.state=st.IDLE,this.flushAudioIfNeeded(n)):(this.switchingTrack=null,this.bufferedTrack=n,this.state=st.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=this.flushing=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(t,n){this.mainDetails=n.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(A.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(t,n){var a;if(this.mainDetails==null){this.cachedTrackLoadedData=n;return}const{levels:l}=this,{details:u,id:d}=n;if(!l){this.warn(`Audio tracks were reset while loading level ${d}`);return}this.log(`Audio track ${d} loaded [${u.startSN},${u.endSN}]${u.lastPartSn?`[part-${u.lastPartSn}-${u.lastPartIndex}]`:""},duration:${u.totalduration}`);const p=l[d];let g=0;if(u.live||(a=p.details)!=null&&a.live){this.checkLiveUpdate(u);const b=this.mainDetails;if(u.deltaUpdateFailed||!b)return;if(!p.details&&u.hasProgramDateTime&&b.hasProgramDateTime)es(u,b),g=u.fragments[0].start;else{var v;g=this.alignPlaylists(u,p.details,(v=this.levelLastLoaded)==null?void 0:v.details)}}p.details=u,this.levelLastLoaded=p,!this.startFragRequested&&(this.mainDetails||!u.live)&&this.setStartPosition(this.mainDetails||u,g),this.state===st.WAITING_TRACK&&!this.waitForCdnTuneIn(u)&&(this.state=st.IDLE),this.tick()}_handleFragmentLoadProgress(t){var n;const{frag:a,part:l,payload:u}=t,{config:d,trackId:p,levels:g}=this;if(!g){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${a.sn} of level ${a.level} will not be buffered`);return}const v=g[p];if(!v){this.warn("Audio track is undefined on fragment load progress");return}const b=v.details;if(!b){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(a.start);return}const L=d.defaultAudioCodec||v.audioCodec||"mp4a.40.2";let B=this.transmuxer;B||(B=this.transmuxer=new rl(this.hls,qt.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const W=this.initPTS[a.cc],K=(n=a.initSegment)==null?void 0:n.data;if(W!==void 0){const ee=!1,re=l?l.index:-1,xe=re!==-1,Fe=new Sa(a.level,a.sn,a.stats.chunkCount,u.byteLength,re,xe);B.push(u,K,L,"",a,l,b.totalduration,ee,Fe,W)}else{this.log(`Unknown video PTS for cc ${a.cc}, waiting for video PTS before demuxing audio frag ${a.sn} of [${b.startSN} ,${b.endSN}],track ${p}`);const{cache:ee}=this.waitingData=this.waitingData||{frag:a,part:l,cache:new ts,complete:!1};ee.push(new Uint8Array(u)),this.waitingVideoCC=this.videoTrackCC,this.state=st.WAITING_INIT_PTS}}_handleFragmentLoadComplete(t){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(t)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(t,n){const a=n.tracks.audio;a&&(this.mediaBuffer=a.buffer||null),n.tracks.video&&(this.videoBuffer=n.tracks.video.buffer||null)}onFragBuffered(t,n){const{frag:a,part:l}=n;if(a.type!==qt.AUDIO){if(!this.loadedmetadata&&a.type===qt.MAIN){const u=this.videoBuffer||this.media;u&&oi.getBuffered(u).length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(a)){this.warn(`Fragment ${a.sn}${l?" p: "+l.index:""} of level ${a.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(a.sn!=="initSegment"){this.fragPrevious=a;const u=this.switchingTrack;u&&(this.bufferedTrack=u,this.switchingTrack=null,this.hls.trigger(A.AUDIO_TRACK_SWITCHED,ze({},u)))}this.fragBufferedComplete(a,l)}onError(t,n){var a;if(n.fatal){this.state=st.ERROR;return}switch(n.details){case k.FRAG_GAP:case k.FRAG_PARSING_ERROR:case k.FRAG_DECRYPT_ERROR:case k.FRAG_LOAD_ERROR:case k.FRAG_LOAD_TIMEOUT:case k.KEY_LOAD_ERROR:case k.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(qt.AUDIO,n);break;case k.AUDIO_TRACK_LOAD_ERROR:case k.AUDIO_TRACK_LOAD_TIMEOUT:case k.LEVEL_PARSING_ERROR:!n.levelRetry&&this.state===st.WAITING_TRACK&&((a=n.context)==null?void 0:a.type)===fi.AUDIO_TRACK&&(this.state=st.IDLE);break;case k.BUFFER_APPEND_ERROR:case k.BUFFER_FULL_ERROR:if(!n.parent||n.parent!=="audio")return;if(n.details===k.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(n)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case k.INTERNAL_EXCEPTION:this.recoverWorkerError(n);break}}onBufferFlushing(t,{type:n}){n!==be.VIDEO&&(this.flushing=!0)}onBufferFlushed(t,{type:n}){if(n!==be.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===st.ENDED&&(this.state=st.IDLE);const a=this.mediaBuffer||this.media;a&&(this.afterBufferFlushed(a,n,qt.AUDIO),this.tick())}}_handleTransmuxComplete(t){var n;const a="audio",{hls:l}=this,{remuxResult:u,chunkMeta:d}=t,p=this.getCurrentContext(d);if(!p){this.resetWhenMissingContext(d);return}const{frag:g,part:v,level:b}=p,{details:L}=b,{audio:B,text:W,id3:K,initSegment:ee}=u;if(this.fragContextChanged(g)||!L){this.fragmentTracker.removeFragment(g);return}if(this.state=st.PARSING,this.switchingTrack&&B&&this.completeAudioSwitch(this.switchingTrack),ee!=null&&ee.tracks){const re=g.initSegment||g;this._bufferInitSegment(b,ee.tracks,re,d),l.trigger(A.FRAG_PARSING_INIT_SEGMENT,{frag:re,id:a,tracks:ee.tracks})}if(B){const{startPTS:re,endPTS:xe,startDTS:Fe,endDTS:Me}=B;v&&(v.elementaryStreams[be.AUDIO]={startPTS:re,endPTS:xe,startDTS:Fe,endDTS:Me}),g.setElementaryStreamInfo(be.AUDIO,re,xe,Fe,Me),this.bufferFragmentData(B,g,v,d)}if(K!=null&&(n=K.samples)!=null&&n.length){const re=se({id:a,frag:g,details:L},K);l.trigger(A.FRAG_PARSING_METADATA,re)}if(W){const re=se({id:a,frag:g,details:L},W);l.trigger(A.FRAG_PARSING_USERDATA,re)}}_bufferInitSegment(t,n,a,l){if(this.state!==st.PARSING)return;n.video&&delete n.video;const u=n.audio;if(!u)return;u.id="audio";const d=t.audioCodec;this.log(`Init audio buffer, container:${u.container}, codecs[level/parsed]=[${d}/${u.codec}]`),d&&d.split(",").length===1&&(u.levelCodec=d),this.hls.trigger(A.BUFFER_CODECS,n);const p=u.initSegment;if(p!=null&&p.byteLength){const g={type:"audio",frag:a,part:null,chunkMeta:l,parent:a.type,data:p};this.hls.trigger(A.BUFFER_APPENDING,g)}this.tickImmediate()}loadFragment(t,n,a){const l=this.fragmentTracker.getState(t);if(this.fragCurrent=t,this.switchingTrack||l===sn.NOT_LOADED||l===sn.PARTIAL){var u;if(t.sn==="initSegment")this._loadInitSegment(t,n);else if((u=n.details)!=null&&u.live&&!this.initPTS[t.cc]){this.log(`Waiting for video PTS in continuity counter ${t.cc} of live stream before loading audio fragment ${t.sn} of level ${this.trackId}`),this.state=st.WAITING_INIT_PTS;const d=this.mainDetails;d&&d.fragments[0].start!==n.details.fragments[0].start&&es(n.details,d)}else this.startFragRequested=!0,super.loadFragment(t,n,a)}else this.clearTrackerIfNeeded(t)}flushAudioIfNeeded(t){const{media:n,bufferedTrack:a}=this,l=a==null?void 0:a.attrs,u=t.attrs;n&&l&&(l.CHANNELS!==u.CHANNELS||a.name!==t.name||a.lang!==t.lang)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null)}completeAudioSwitch(t){const{hls:n}=this;this.flushAudioIfNeeded(t),this.bufferedTrack=t,this.switchingTrack=null,n.trigger(A.AUDIO_TRACK_SWITCHED,ze({},t))}}class Wi extends vr{constructor(t){super(t,"[audio-track-controller]");this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:t}=this;t.on(A.MANIFEST_LOADING,this.onManifestLoading,this),t.on(A.MANIFEST_PARSED,this.onManifestParsed,this),t.on(A.LEVEL_LOADING,this.onLevelLoading,this),t.on(A.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(A.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.on(A.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(A.MANIFEST_LOADING,this.onManifestLoading,this),t.off(A.MANIFEST_PARSED,this.onManifestParsed,this),t.off(A.LEVEL_LOADING,this.onLevelLoading,this),t.off(A.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(A.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),t.off(A.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(t,n){this.tracks=n.audioTracks||[]}onAudioTrackLoaded(t,n){const{id:a,groupId:l,details:u}=n,d=this.tracksInGroup[a];if(!d||d.groupId!==l){this.warn(`Audio track with id:${a} and group:${l} not found in active group ${d==null?void 0:d.groupId}`);return}const p=d.details;d.details=n.details,this.log(`Audio track ${a} "${d.name}" lang:${d.lang} group:${l} loaded [${u.startSN}-${u.endSN}]`),a===this.trackId&&this.playlistLoaded(a,n,p)}onLevelLoading(t,n){this.switchLevel(n.level)}onLevelSwitching(t,n){this.switchLevel(n.level)}switchLevel(t){const n=this.hls.levels[t];if(!n)return;const a=n.audioGroups||null,l=this.groupIds;let u=this.currentTrack;if(!a||(l==null?void 0:l.length)!==(a==null?void 0:a.length)||a!=null&&a.some(p=>(l==null?void 0:l.indexOf(p))===-1)){this.groupIds=a,this.trackId=-1,this.currentTrack=null;const p=this.tracks.filter(B=>!a||a.indexOf(B.groupId)!==-1);if(p.length)this.selectDefaultTrack&&!p.some(B=>B.default)&&(this.selectDefaultTrack=!1),p.forEach((B,W)=>{B.id=W});else if(!u&&!this.tracksInGroup.length)return;this.tracksInGroup=p;const g=this.hls.config.audioPreference;if(!u&&g){const B=Xn(g,p,Qn);if(B>-1)u=p[B];else{const W=Xn(g,this.tracks);u=this.tracks[W]}}let v=this.findTrackId(u);v===-1&&u&&(v=this.findTrackId(null));const b={audioTracks:p};this.log(`Updating audio tracks, ${p.length} track(s) found in group(s): ${a==null?void 0:a.join(",")}`),this.hls.trigger(A.AUDIO_TRACKS_UPDATED,b);const L=this.trackId;if(v!==-1&&L===-1)this.setAudioTrack(v);else if(p.length&&L===-1){var d;const B=new Error(`No audio track selected for current audio group-ID(s): ${(d=this.groupIds)==null?void 0:d.join(",")} track count: ${p.length}`);this.warn(B.message),this.hls.trigger(A.ERROR,{type:M.MEDIA_ERROR,details:k.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:B})}}else this.shouldReloadPlaylist(u)&&this.setAudioTrack(this.trackId)}onError(t,n){n.fatal||!n.context||n.context.type===fi.AUDIO_TRACK&&n.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(n.context.groupId)!==-1)&&(this.requestScheduled=-1,this.checkRetry(n))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(t){this.selectDefaultTrack=!1,this.setAudioTrack(t)}setAudioOption(t){const n=this.hls;if(n.config.audioPreference=t,t){const a=this.allAudioTracks;if(this.selectDefaultTrack=!1,a.length){const l=this.currentTrack;if(l&&Es(t,l,Qn))return l;const u=Xn(t,this.tracksInGroup,Qn);if(u>-1){const d=this.tracksInGroup[u];return this.setAudioTrack(u),d}else if(l){let d=n.loadLevel;d===-1&&(d=n.firstAutoLevel);const p=Go(t,n.levels,a,d,Qn);if(p===-1)return null;n.nextLoadLevel=p}if(t.channels||t.audioCodec){const d=Xn(t,a);if(d>-1)return a[d]}}}return null}setAudioTrack(t){const n=this.tracksInGroup;if(t<0||t>=n.length){this.warn(`Invalid audio track id: ${t}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const a=this.currentTrack,l=n[t],u=l.details&&!l.details.live;if(t===this.trackId&&l===a&&u||(this.log(`Switching to audio-track ${t} "${l.name}" lang:${l.lang} group:${l.groupId} channels:${l.channels}`),this.trackId=t,this.currentTrack=l,this.hls.trigger(A.AUDIO_TRACK_SWITCHING,ze({},l)),u))return;const d=this.switchParams(l.url,a==null?void 0:a.details,l.details);this.loadPlaylist(d)}findTrackId(t){const n=this.tracksInGroup;for(let a=0;a<n.length;a++){const l=n[a];if(!(this.selectDefaultTrack&&!l.default)&&(!t||Es(t,l,Qn)))return a}if(t){const{name:a,lang:l,assocLang:u,characteristics:d,audioCodec:p,channels:g}=t;for(let v=0;v<n.length;v++){const b=n[v];if(Es({name:a,lang:l,assocLang:u,characteristics:d,audioCodec:p,channels:g},b,Qn))return v}for(let v=0;v<n.length;v++){const b=n[v];if(Zs(t.attrs,b.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return v}for(let v=0;v<n.length;v++){const b=n[v];if(Zs(t.attrs,b.attrs,["LANGUAGE"]))return v}}return-1}loadPlaylist(t){const n=this.currentTrack;if(this.shouldLoadPlaylist(n)&&n){super.loadPlaylist();const a=n.id,l=n.groupId;let u=n.url;if(t)try{u=t.addDirectives(u)}catch(d){this.warn(`Could not construct new URL with HLS Delivery Directives: ${d}`)}this.log(`loading audio-track playlist ${a} "${n.name}" lang:${n.lang} group:${l}`),this.clearTimer(),this.hls.trigger(A.AUDIO_TRACK_LOADING,{url:u,id:a,groupId:l,deliveryDirectives:t||null})}}}const Pa=500;class Gr extends jr{constructor(t,n,a){super(t,n,a,"[subtitle-stream-controller]",qt.SUBTITLE);this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}_registerListeners(){const{hls:t}=this;t.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(A.MANIFEST_LOADING,this.onManifestLoading,this),t.on(A.LEVEL_LOADED,this.onLevelLoaded,this),t.on(A.ERROR,this.onError,this),t.on(A.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(A.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.on(A.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(A.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.on(A.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(A.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:t}=this;t.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(A.MANIFEST_LOADING,this.onManifestLoading,this),t.off(A.LEVEL_LOADED,this.onLevelLoaded,this),t.off(A.ERROR,this.onError,this),t.off(A.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(A.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),t.off(A.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(A.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),t.off(A.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(A.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(t){this.stopLoad(),this.state=st.IDLE,this.setInterval(Pa),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(t,n){this.mainDetails=n.details}onSubtitleFragProcessed(t,n){const{frag:a,success:l}=n;if(this.fragPrevious=a,this.state=st.IDLE,!l)return;const u=this.tracksBuffered[this.currentTrackId];if(!u)return;let d;const p=a.start;for(let v=0;v<u.length;v++)if(p>=u[v].start&&p<=u[v].end){d=u[v];break}const g=a.start+a.duration;d?d.end=g:(d={start:p,end:g},u.push(d)),this.fragmentTracker.fragBuffered(a),this.fragBufferedComplete(a,null)}onBufferFlushing(t,n){const{startOffset:a,endOffset:l}=n;if(a===0&&l!==Number.POSITIVE_INFINITY){const u=l-1;if(u<=0)return;n.endOffsetSubtitles=Math.max(0,u),this.tracksBuffered.forEach(d=>{for(let p=0;p<d.length;){if(d[p].end<=u){d.shift();continue}else if(d[p].start<u)d[p].start=u;else break;p++}}),this.fragmentTracker.removeFragmentsInRange(a,u,qt.SUBTITLE)}}onFragBuffered(t,n){if(!this.loadedmetadata&&n.frag.type===qt.MAIN){var a;(a=this.media)!=null&&a.buffered.length&&(this.loadedmetadata=!0)}}onError(t,n){const a=n.frag;(a==null?void 0:a.type)===qt.SUBTITLE&&(n.details===k.FRAG_GAP&&this.fragmentTracker.fragBuffered(a,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==st.STOPPED&&(this.state=st.IDLE))}onSubtitleTracksUpdated(t,{subtitleTracks:n}){if(this.levels&&Yl(this.levels,n)){this.levels=n.map(a=>new or(a));return}this.tracksBuffered=[],this.levels=n.map(a=>{const l=new or(a);return this.tracksBuffered[l.id]=[],l}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,qt.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(t,n){var a;if(this.currentTrackId=n.id,!((a=this.levels)!=null&&a.length)||this.currentTrackId===-1){this.clearInterval();return}const l=this.levels[this.currentTrackId];l!=null&&l.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,l&&this.setInterval(Pa)}onSubtitleTrackLoaded(t,n){var a;const{currentTrackId:l,levels:u}=this,{details:d,id:p}=n;if(!u){this.warn(`Subtitle tracks were reset while loading level ${p}`);return}const g=u[p];if(p>=u.length||!g)return;this.log(`Subtitle track ${p} loaded [${d.startSN},${d.endSN}]${d.lastPartSn?`[part-${d.lastPartSn}-${d.lastPartIndex}]`:""},duration:${d.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let v=0;if(d.live||(a=g.details)!=null&&a.live){const L=this.mainDetails;if(d.deltaUpdateFailed||!L)return;const B=L.fragments[0];if(!g.details)d.hasProgramDateTime&&L.hasProgramDateTime?(es(d,L),v=d.fragments[0].start):B&&(v=B.start,va(d,v));else{var b;v=this.alignPlaylists(d,g.details,(b=this.levelLastLoaded)==null?void 0:b.details),v===0&&B&&(v=B.start,va(d,v))}}g.details=d,this.levelLastLoaded=g,p===l&&(!this.startFragRequested&&(this.mainDetails||!d.live)&&this.setStartPosition(this.mainDetails||d,v),this.tick(),d.live&&!this.fragCurrent&&this.media&&this.state===st.IDLE&&(ba(null,d.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),g.details=void 0)))}_handleFragmentLoadComplete(t){const{frag:n,payload:a}=t,l=n.decryptdata,u=this.hls;if(!this.fragContextChanged(n)&&a&&a.byteLength>0&&l!=null&&l.key&&l.iv&&l.method==="AES-128"){const d=performance.now();this.decrypter.decrypt(new Uint8Array(a),l.key.buffer,l.iv.buffer).catch(p=>{throw u.trigger(A.ERROR,{type:M.MEDIA_ERROR,details:k.FRAG_DECRYPT_ERROR,fatal:!1,error:p,reason:p.message,frag:n}),p}).then(p=>{const g=performance.now();u.trigger(A.FRAG_DECRYPTED,{frag:n,payload:p,stats:{tstart:d,tdecrypt:g}})}).catch(p=>{this.warn(`${p.name}: ${p.message}`),this.state=st.IDLE})}}doTick(){if(!this.media){this.state=st.IDLE;return}if(this.state===st.IDLE){const{currentTrackId:t,levels:n}=this,a=n==null?void 0:n[t];if(!a||!n.length||!a.details)return;const{config:l}=this,u=this.getLoadPosition(),d=oi.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],u,l.maxBufferHole),{end:p,len:g}=d,v=this.getFwdBufferInfo(this.media,qt.MAIN),b=a.details,L=this.getMaxBufferLength(v==null?void 0:v.len)+b.levelTargetDuration;if(g>L)return;const B=b.fragments,W=B.length,K=b.edge;let ee=null;const re=this.fragPrevious;if(p<K){const xe=l.maxFragLookUpTolerance,Fe=p>K-xe?0:xe;ee=ba(re,B,Math.max(B[0].start,p),Fe),!ee&&re&&re.start<B[0].start&&(ee=B[0])}else ee=B[W-1];if(!ee)return;if(ee=this.mapToInitFragWhenRequired(ee),ee.sn!=="initSegment"){const xe=ee.sn-b.startSN,Fe=B[xe-1];Fe&&Fe.cc===ee.cc&&this.fragmentTracker.getState(Fe)===sn.NOT_LOADED&&(ee=Fe)}this.fragmentTracker.getState(ee)===sn.NOT_LOADED&&this.loadFragment(ee,a,p)}}getMaxBufferLength(t){const n=super.getMaxBufferLength();return t?Math.max(n,t):n}loadFragment(t,n,a){this.fragCurrent=t,t.sn==="initSegment"?this._loadInitSegment(t,n):(this.startFragRequested=!0,super.loadFragment(t,n,a))}get mediaBufferTimeRanges(){return new Xl(this.tracksBuffered[this.currentTrackId]||[])}}class Xl{constructor(t){this.buffered=void 0;const n=(a,l,u)=>{if(l=l>>>0,l>u-1)throw new DOMException(`Failed to execute '${a}' on 'TimeRanges': The index provided (${l}) is greater than the maximum bound (${u})`);return t[l][a]};this.buffered={get length(){return t.length},end(a){return n("end",a,t.length)},start(a){return n("start",a,t.length)}}}}class Jh extends vr{constructor(t){super(t,"[subtitle-track-controller]");this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let n=null;const a=ga(this.media.textTracks);for(let u=0;u<a.length;u++)if(a[u].mode==="hidden")n=a[u];else if(a[u].mode==="showing"){n=a[u];break}const l=this.findTrackForTextTrack(n);this.subtitleTrack!==l&&this.setSubtitleTrack(l)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(t){this._subtitleDisplay=t,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:t}=this;t.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(A.MANIFEST_LOADING,this.onManifestLoading,this),t.on(A.MANIFEST_PARSED,this.onManifestParsed,this),t.on(A.LEVEL_LOADING,this.onLevelLoading,this),t.on(A.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(A.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(A.ERROR,this.onError,this)}unregisterListeners(){const{hls:t}=this;t.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(A.MANIFEST_LOADING,this.onManifestLoading,this),t.off(A.MANIFEST_PARSED,this.onManifestParsed,this),t.off(A.LEVEL_LOADING,this.onLevelLoading,this),t.off(A.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(A.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(A.ERROR,this.onError,this)}onMediaAttached(t,n){this.media=n.media,!!this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(t){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,t)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),ga(this.media.textTracks).forEach(n=>{vs(n)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(t,n){this.tracks=n.subtitleTracks}onSubtitleTrackLoaded(t,n){const{id:a,groupId:l,details:u}=n,d=this.tracksInGroup[a];if(!d||d.groupId!==l){this.warn(`Subtitle track with id:${a} and group:${l} not found in active group ${d==null?void 0:d.groupId}`);return}const p=d.details;d.details=n.details,this.log(`Subtitle track ${a} "${d.name}" lang:${d.lang} group:${l} loaded [${u.startSN}-${u.endSN}]`),a===this.trackId&&this.playlistLoaded(a,n,p)}onLevelLoading(t,n){this.switchLevel(n.level)}onLevelSwitching(t,n){this.switchLevel(n.level)}switchLevel(t){const n=this.hls.levels[t];if(!n)return;const a=n.subtitleGroups||null,l=this.groupIds;let u=this.currentTrack;if(!a||(l==null?void 0:l.length)!==(a==null?void 0:a.length)||a!=null&&a.some(d=>(l==null?void 0:l.indexOf(d))===-1)){this.groupIds=a,this.trackId=-1,this.currentTrack=null;const d=this.tracks.filter(b=>!a||a.indexOf(b.groupId)!==-1);if(d.length)this.selectDefaultTrack&&!d.some(b=>b.default)&&(this.selectDefaultTrack=!1),d.forEach((b,L)=>{b.id=L});else if(!u&&!this.tracksInGroup.length)return;this.tracksInGroup=d;const p=this.hls.config.subtitlePreference;if(!u&&p){this.selectDefaultTrack=!1;const b=Xn(p,d);if(b>-1)u=d[b];else{const L=Xn(p,this.tracks);u=this.tracks[L]}}let g=this.findTrackId(u);g===-1&&u&&(g=this.findTrackId(null));const v={subtitleTracks:d};this.log(`Updating subtitle tracks, ${d.length} track(s) found in "${a==null?void 0:a.join(",")}" group-id`),this.hls.trigger(A.SUBTITLE_TRACKS_UPDATED,v),g!==-1&&this.trackId===-1&&this.setSubtitleTrack(g)}else this.shouldReloadPlaylist(u)&&this.setSubtitleTrack(this.trackId)}findTrackId(t){const n=this.tracksInGroup,a=this.selectDefaultTrack;for(let l=0;l<n.length;l++){const u=n[l];if(!(a&&!u.default||!a&&!t)&&(!t||Es(u,t)))return l}if(t){for(let l=0;l<n.length;l++){const u=n[l];if(Zs(t.attrs,u.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return l}for(let l=0;l<n.length;l++){const u=n[l];if(Zs(t.attrs,u.attrs,["LANGUAGE"]))return l}}return-1}findTrackForTextTrack(t){if(t){const n=this.tracksInGroup;for(let a=0;a<n.length;a++){const l=n[a];if(ss(l,t))return a}}return-1}onError(t,n){n.fatal||!n.context||n.context.type===fi.SUBTITLE_TRACK&&n.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(n.context.groupId)!==-1)&&this.checkRetry(n)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(t){this.selectDefaultTrack=!1,this.setSubtitleTrack(t)}setSubtitleOption(t){if(this.hls.config.subtitlePreference=t,t){const n=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,n.length){const a=this.currentTrack;if(a&&Es(t,a))return a;const l=Xn(t,this.tracksInGroup);if(l>-1){const u=this.tracksInGroup[l];return this.setSubtitleTrack(l),u}else{if(a)return null;{const u=Xn(t,n);if(u>-1)return n[u]}}}}return null}loadPlaylist(t){super.loadPlaylist();const n=this.currentTrack;if(this.shouldLoadPlaylist(n)&&n){const a=n.id,l=n.groupId;let u=n.url;if(t)try{u=t.addDirectives(u)}catch(d){this.warn(`Could not construct new URL with HLS Delivery Directives: ${d}`)}this.log(`Loading subtitle playlist for id ${a}`),this.hls.trigger(A.SUBTITLE_TRACK_LOADING,{url:u,id:a,groupId:l,deliveryDirectives:t||null})}}toggleTrackModes(){const{media:t}=this;if(!t)return;const n=ga(t.textTracks),a=this.currentTrack;let l;if(a&&(l=n.filter(u=>ss(a,u))[0],l||this.warn(`Unable to find subtitle TextTrack with name "${a.name}" and language "${a.lang}"`)),[].slice.call(n).forEach(u=>{u.mode!=="disabled"&&u!==l&&(u.mode="disabled")}),l){const u=this.subtitleDisplay?"showing":"hidden";l.mode!==u&&(l.mode=u)}}setSubtitleTrack(t){const n=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=t;return}if(t<-1||t>=n.length||!te(t)){this.warn(`Invalid subtitle track id: ${t}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const a=this.currentTrack,l=n[t]||null;if(this.trackId=t,this.currentTrack=l,this.toggleTrackModes(),!l){this.hls.trigger(A.SUBTITLE_TRACK_SWITCH,{id:t});return}const u=!!l.details&&!l.details.live;if(t===this.trackId&&l===a&&u)return;this.log(`Switching to subtitle-track ${t}`+(l?` "${l.name}" lang:${l.lang} group:${l.groupId}`:""));const{id:d,groupId:p="",name:g,type:v,url:b}=l;this.hls.trigger(A.SUBTITLE_TRACK_SWITCH,{id:d,groupId:p,name:g,type:v,url:b});const L=this.switchParams(l.url,a==null?void 0:a.details,l.details);this.loadPlaylist(L)}}class Zh{constructor(t){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=t}append(t,n,a){const l=this.queues[n];l.push(t),l.length===1&&!a&&this.executeNext(n)}insertAbort(t,n){this.queues[n].unshift(t),this.executeNext(n)}appendBlocker(t){let n;const a=new Promise(u=>{n=u}),l={execute:n,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(l,t),a}executeNext(t){const n=this.queues[t];if(n.length){const a=n[0];try{a.execute()}catch(l){C.warn(`[buffer-operation-queue]: Exception executing "${t}" SourceBuffer operation: ${l}`),a.onError(l);const u=this.buffers[t];u!=null&&u.updating||this.shiftAndExecuteNext(t)}}}shiftAndExecuteNext(t){this.queues[t].shift(),this.executeNext(t)}current(t){return this.queues[t][0]}}const Ql=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/;class Jl{constructor(t){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendSource=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this.log=void 0,this.warn=void 0,this.error=void 0,this._onEndStreaming=a=>{!this.hls||this.hls.pauseBuffering()},this._onStartStreaming=a=>{!this.hls||this.hls.resumeBuffering()},this._onMediaSourceOpen=()=>{const{media:a,mediaSource:l}=this;this.log("Media source opened"),a&&(a.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(A.MEDIA_ATTACHED,{media:a,mediaSource:l})),l&&l.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:a,_objectUrl:l}=this;a!==l&&C.error(`Media element src was set while attaching MediaSource (${l} > ${a})`)},this.hls=t;const n="[buffer-controller]";this.appendSource=Il(ar(t.config.preferManagedMediaSource)),this.log=C.log.bind(C,n),this.warn=C.warn.bind(C,n),this.error=C.error.bind(C,n),this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null,this.hls=null}registerListeners(){const{hls:t}=this;t.on(A.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(A.MANIFEST_LOADING,this.onManifestLoading,this),t.on(A.MANIFEST_PARSED,this.onManifestParsed,this),t.on(A.BUFFER_RESET,this.onBufferReset,this),t.on(A.BUFFER_APPENDING,this.onBufferAppending,this),t.on(A.BUFFER_CODECS,this.onBufferCodecs,this),t.on(A.BUFFER_EOS,this.onBufferEos,this),t.on(A.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(A.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(A.FRAG_PARSED,this.onFragParsed,this),t.on(A.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:t}=this;t.off(A.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(A.MANIFEST_LOADING,this.onManifestLoading,this),t.off(A.MANIFEST_PARSED,this.onManifestParsed,this),t.off(A.BUFFER_RESET,this.onBufferReset,this),t.off(A.BUFFER_APPENDING,this.onBufferAppending,this),t.off(A.BUFFER_CODECS,this.onBufferCodecs,this),t.off(A.BUFFER_EOS,this.onBufferEos,this),t.off(A.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(A.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(A.FRAG_PARSED,this.onFragParsed,this),t.off(A.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new Zh(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.appendErrors={audio:0,video:0,audiovideo:0},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(t,n){let a=2;(n.audio&&!n.video||!n.altAudio)&&(a=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=a,this.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(t,n){const a=this.media=n.media,l=ar(this.appendSource);if(a&&l){var u;const d=this.mediaSource=new l;this.log(`created media source: ${(u=d.constructor)==null?void 0:u.name}`),d.addEventListener("sourceopen",this._onMediaSourceOpen),d.addEventListener("sourceended",this._onMediaSourceEnded),d.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(d.addEventListener("startstreaming",this._onStartStreaming),d.addEventListener("endstreaming",this._onEndStreaming));const p=this._objectUrl=self.URL.createObjectURL(d);if(this.appendSource)try{a.removeAttribute("src");const g=self.ManagedMediaSource;a.disableRemotePlayback=a.disableRemotePlayback||g&&d instanceof g,ea(a),Oa(a,p),a.load()}catch(g){a.src=p}else a.src=p;a.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:t,mediaSource:n,_objectUrl:a}=this;if(n){if(this.log("media source detaching"),n.readyState==="open")try{n.endOfStream()}catch(l){this.warn(`onMediaDetaching: ${l.message} while calling endOfStream`)}this.onBufferReset(),n.removeEventListener("sourceopen",this._onMediaSourceOpen),n.removeEventListener("sourceended",this._onMediaSourceEnded),n.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(n.removeEventListener("startstreaming",this._onStartStreaming),n.removeEventListener("endstreaming",this._onEndStreaming)),t&&(t.removeEventListener("emptied",this._onMediaEmptied),a&&self.URL.revokeObjectURL(a),this.mediaSrc===a?(t.removeAttribute("src"),this.appendSource&&ea(t),t.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(A.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(t=>{this.resetBuffer(t)}),this._initSourceBuffer()}resetBuffer(t){const n=this.sourceBuffer[t];try{if(n){var a;this.removeBufferListeners(t),this.sourceBuffer[t]=void 0,(a=this.mediaSource)!=null&&a.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(n)}}catch(l){this.warn(`onBufferReset ${t}`,l)}}onBufferCodecs(t,n){const a=this.getSourceBufferTypes().length,l=Object.keys(n);if(l.forEach(d=>{if(a){const g=this.tracks[d];if(g&&typeof g.buffer.changeType=="function"){var p;const{id:v,codec:b,levelCodec:L,container:B,metadata:W}=n[d],K=qa(g.codec,g.levelCodec),ee=K==null?void 0:K.replace(Ql,"$1");let re=qa(b,L);const xe=(p=re)==null?void 0:p.replace(Ql,"$1");if(re&&ee!==xe){d.slice(0,5)==="audio"&&(re=ps(re,this.appendSource));const Fe=`${B};codecs=${re}`;this.appendChangeType(d,Fe),this.log(`switching codec ${K} to ${re}`),this.tracks[d]={buffer:g.buffer,codec:b,container:B,levelCodec:L,metadata:W,id:v}}}}else this.pendingTracks[d]=n[d]}),a)return;const u=Math.max(this.bufferCodecEventsExpected-1,0);this.bufferCodecEventsExpected!==u&&(this.log(`${u} bufferCodec event(s) expected ${l.join(",")}`),this.bufferCodecEventsExpected=u),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks()}appendChangeType(t,n){const{operationQueue:a}=this,l={execute:()=>{const u=this.sourceBuffer[t];u&&(this.log(`changing ${t} sourceBuffer type to ${n}`),u.changeType(n)),a.shiftAndExecuteNext(t)},onStart:()=>{},onComplete:()=>{},onError:u=>{this.warn(`Failed to change ${t} SourceBuffer type`,u)}};a.append(l,t,!!this.pendingTracks[t])}onBufferAppending(t,n){const{hls:a,operationQueue:l,tracks:u}=this,{data:d,type:p,frag:g,part:v,chunkMeta:b}=n,L=b.buffering[p],B=self.performance.now();L.start=B;const W=g.stats.buffering,K=v?v.stats.buffering:null;W.start===0&&(W.start=B),K&&K.start===0&&(K.start=B);const ee=u.audio;let re=!1;p==="audio"&&(ee==null?void 0:ee.container)==="audio/mpeg"&&(re=!this.lastMpegAudioChunk||b.id===1||this.lastMpegAudioChunk.sn!==b.sn,this.lastMpegAudioChunk=b);const xe=g.start,Fe={execute:()=>{if(L.executeStart=self.performance.now(),re){const Me=this.sourceBuffer[p];if(Me){const it=xe-Me.timestampOffset;Math.abs(it)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${xe} (delta: ${it}) sn: ${g.sn})`),Me.timestampOffset=xe)}}this.appendExecutor(d,p)},onStart:()=>{},onComplete:()=>{const Me=self.performance.now();L.executeEnd=L.end=Me,W.first===0&&(W.first=Me),K&&K.first===0&&(K.first=Me);const{sourceBuffer:it}=this,$e={};for(const ut in it)$e[ut]=oi.getBuffered(it[ut]);this.appendErrors[p]=0,p==="audio"||p==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(A.BUFFER_APPENDED,{type:p,frag:g,part:v,chunkMeta:b,parent:g.type,timeRanges:$e})},onError:Me=>{const it={type:M.MEDIA_ERROR,parent:g.type,details:k.BUFFER_APPEND_ERROR,sourceBufferName:p,frag:g,part:v,chunkMeta:b,error:Me,err:Me,fatal:!1};if(Me.code===DOMException.QUOTA_EXCEEDED_ERR)it.details=k.BUFFER_FULL_ERROR;else{const $e=++this.appendErrors[p];it.details=k.BUFFER_APPEND_ERROR,this.warn(`Failed ${$e}/${a.config.appendErrorMaxRetry} times to append segment in "${p}" sourceBuffer`),$e>=a.config.appendErrorMaxRetry&&(it.fatal=!0)}a.trigger(A.ERROR,it)}};l.append(Fe,p,!!this.pendingTracks[p])}onBufferFlushing(t,n){const{operationQueue:a}=this,l=u=>({execute:this.removeExecutor.bind(this,u,n.startOffset,n.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(A.BUFFER_FLUSHED,{type:u})},onError:d=>{this.warn(`Failed to remove from ${u} SourceBuffer`,d)}});n.type?a.append(l(n.type),n.type):this.getSourceBufferTypes().forEach(u=>{a.append(l(u),u)})}onFragParsed(t,n){const{frag:a,part:l}=n,u=[],d=l?l.elementaryStreams:a.elementaryStreams;d[be.AUDIOVIDEO]?u.push("audiovideo"):(d[be.AUDIO]&&u.push("audio"),d[be.VIDEO]&&u.push("video"));const p=()=>{const g=self.performance.now();a.stats.buffering.end=g,l&&(l.stats.buffering.end=g);const v=l?l.stats:a.stats;this.hls.trigger(A.FRAG_BUFFERED,{frag:a,part:l,stats:v,id:a.type})};u.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${a.type} level: ${a.level} sn: ${a.sn}`),this.blockBuffers(p,u)}onFragChanged(t,n){this.trimBuffers()}onBufferEos(t,n){this.getSourceBufferTypes().reduce((l,u)=>{const d=this.sourceBuffer[u];return d&&(!n.type||n.type===u)&&(d.ending=!0,d.ended||(d.ended=!0,this.log(`${u} sourceBuffer now EOS`))),l&&!!(!d||d.ended)},!0)&&(this.log("Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(u=>{const d=this.sourceBuffer[u];d&&(d.ending=!1)});const{mediaSource:l}=this;if(!l||l.readyState!=="open"){l&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${l.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),l.endOfStream()}))}onLevelUpdated(t,{details:n}){!n.fragments.length||(this.details=n,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}trimBuffers(){const{hls:t,details:n,media:a}=this;if(!a||n===null||!this.getSourceBufferTypes().length)return;const u=t.config,d=a.currentTime,p=n.levelTargetDuration,g=n.live&&u.liveBackBufferLength!==null?u.liveBackBufferLength:u.backBufferLength;if(te(g)&&g>0){const v=Math.max(g,p),b=Math.floor(d/p)*p-v;this.flushBackBuffer(d,p,b)}if(te(u.frontBufferFlushThreshold)&&u.frontBufferFlushThreshold>0){const v=Math.max(u.maxBufferLength,u.frontBufferFlushThreshold),b=Math.max(v,p),L=Math.floor(d/p)*p+b;this.flushFrontBuffer(d,p,L)}}flushBackBuffer(t,n,a){const{details:l,sourceBuffer:u}=this;this.getSourceBufferTypes().forEach(p=>{const g=u[p];if(g){const v=oi.getBuffered(g);if(v.length>0&&a>v.start(0)){if(this.hls.trigger(A.BACK_BUFFER_REACHED,{bufferEnd:a}),l!=null&&l.live)this.hls.trigger(A.LIVE_BACK_BUFFER_REACHED,{bufferEnd:a});else if(g.ended&&v.end(v.length-1)-t<n*2){this.log(`Cannot flush ${p} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(A.BUFFER_FLUSHING,{startOffset:0,endOffset:a,type:p})}}})}flushFrontBuffer(t,n,a){const{sourceBuffer:l}=this;this.getSourceBufferTypes().forEach(d=>{const p=l[d];if(p){const g=oi.getBuffered(p),v=g.length;if(v<2)return;const b=g.start(v-1),L=g.end(v-1);if(a>b||t>=b&&t<=L)return;if(p.ended&&t-L<2*n){this.log(`Cannot flush ${d} front buffer while SourceBuffer is in ended state`);return}this.hls.trigger(A.BUFFER_FLUSHING,{startOffset:b,endOffset:Infinity,type:d})}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")return;const{details:t,hls:n,media:a,mediaSource:l}=this,u=t.fragments[0].start+t.totalduration,d=a.duration,p=te(l.duration)?l.duration:0;t.live&&n.config.liveDurationInfinity?(l.duration=Infinity,this.updateSeekableRange(t)):(u>p&&u>d||!te(d))&&(this.log(`Updating Media Source duration to ${u.toFixed(3)}`),l.duration=u)}updateSeekableRange(t){const n=this.mediaSource,a=t.fragments;if(a.length&&t.live&&n!=null&&n.setLiveSeekableRange){const u=Math.max(0,a[0].start),d=Math.max(u,u+t.totalduration);this.log(`Media Source duration is set to ${n.duration}. Setting seekable range to ${u}-${d}.`),n.setLiveSeekableRange(u,d)}}checkPendingTracks(){const{bufferCodecEventsExpected:t,operationQueue:n,pendingTracks:a}=this,l=Object.keys(a).length;if(l&&(!t||l===2||"audiovideo"in a)){this.createSourceBuffers(a),this.pendingTracks={};const u=this.getSourceBufferTypes();if(u.length)this.hls.trigger(A.BUFFER_CREATED,{tracks:this.tracks}),u.forEach(d=>{n.executeNext(d)});else{const d=new Error("could not create source buffer for media codec(s)");this.hls.trigger(A.ERROR,{type:M.MEDIA_ERROR,details:k.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:d,reason:d.message})}}}createSourceBuffers(t){const{sourceBuffer:n,mediaSource:a}=this;if(!a)throw Error("createSourceBuffers called when mediaSource was null");for(const u in t)if(!n[u]){var l;const d=t[u];if(!d)throw Error(`source buffer exists for track ${u}, however track does not`);let p=((l=d.levelCodec)==null?void 0:l.indexOf(","))===-1?d.levelCodec:d.codec;p&&u.slice(0,5)==="audio"&&(p=ps(p,this.appendSource));const g=`${d.container};codecs=${p}`;this.log(`creating sourceBuffer(${g})`);try{const v=n[u]=a.addSourceBuffer(g),b=u;this.addBufferListener(b,"updatestart",this._onSBUpdateStart),this.addBufferListener(b,"updateend",this._onSBUpdateEnd),this.addBufferListener(b,"error",this._onSBUpdateError),this.appendSource&&this.addBufferListener(b,"bufferedchange",(L,B)=>{const W=B.removedRanges;W!=null&&W.length&&this.hls.trigger(A.BUFFER_FLUSHED,{type:u})}),this.tracks[u]={buffer:v,codec:p,container:d.container,levelCodec:d.levelCodec,metadata:d.metadata,id:d.id}}catch(v){this.error(`error while trying to add sourceBuffer: ${v.message}`),this.hls.trigger(A.ERROR,{type:M.MEDIA_ERROR,details:k.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:v,sourceBufferName:u,mimeType:g})}}}get mediaSrc(){var t,n;const a=((t=this.media)==null||(n=t.querySelector)==null?void 0:n.call(t,"source"))||this.media;return a==null?void 0:a.src}_onSBUpdateStart(t){const{operationQueue:n}=this;n.current(t).onStart()}_onSBUpdateEnd(t){var n;if(((n=this.mediaSource)==null?void 0:n.readyState)==="closed"){this.resetBuffer(t);return}const{operationQueue:a}=this;a.current(t).onComplete(),a.shiftAndExecuteNext(t)}_onSBUpdateError(t,n){var a;const l=new Error(`${t} SourceBuffer error. MediaSource readyState: ${(a=this.mediaSource)==null?void 0:a.readyState}`);this.error(`${l}`,n),this.hls.trigger(A.ERROR,{type:M.MEDIA_ERROR,details:k.BUFFER_APPENDING_ERROR,sourceBufferName:t,error:l,fatal:!1});const u=this.operationQueue.current(t);u&&u.onError(l)}removeExecutor(t,n,a){const{media:l,mediaSource:u,operationQueue:d,sourceBuffer:p}=this,g=p[t];if(!l||!u||!g){this.warn(`Attempting to remove from the ${t} SourceBuffer, but it does not exist`),d.shiftAndExecuteNext(t);return}const v=te(l.duration)?l.duration:Infinity,b=te(u.duration)?u.duration:Infinity,L=Math.max(0,n),B=Math.min(a,v,b);B>L&&(!g.ending||g.ended)?(g.ended=!1,this.log(`Removing [${L},${B}] from the ${t} SourceBuffer`),g.remove(L,B)):d.shiftAndExecuteNext(t)}appendExecutor(t,n){const a=this.sourceBuffer[n];if(!a){if(!this.pendingTracks[n])throw new Error(`Attempting to append to the ${n} SourceBuffer, but it does not exist`);return}a.ended=!1,a.appendBuffer(t)}blockBuffers(t,n=this.getSourceBufferTypes()){if(!n.length){this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(t);return}const{operationQueue:a}=this,l=n.map(u=>a.appendBlocker(u));Promise.all(l).then(()=>{t(),n.forEach(u=>{const d=this.sourceBuffer[u];d!=null&&d.updating||a.shiftAndExecuteNext(u)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(t,n,a){const l=this.sourceBuffer[t];if(!l)return;const u=a.bind(this,t);this.listeners[t].push({event:n,listener:u}),l.addEventListener(n,u)}removeBufferListeners(t){const n=this.sourceBuffer[t];!n||this.listeners[t].forEach(a=>{n.removeEventListener(a.event,a.listener)})}}function ea(h){const t=h.querySelectorAll("source");[].slice.call(t).forEach(n=>{h.removeChild(n)})}function Oa(h,t){const n=self.document.createElement("source");n.type="video/mp4",n.src=t,h.appendChild(n)}const Zl={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},ud=h=>String.fromCharCode(Zl[h]||h),er=15,as=100,dd={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Nc={17:2,18:4,21:6,22:8,23:10,19:13,20:15},sl={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Uc={25:2,26:4,29:6,30:8,31:10,27:13,28:15},jc=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class $c{constructor(){this.time=null,this.verboseLevel=0}log(t,n){if(this.verboseLevel>=t){const a=typeof n=="function"?n():n;C.log(`${this.time} [${t}] ${a}`)}}}const ws=function(t){const n=[];for(let a=0;a<t.length;a++)n.push(t[a].toString(16));return n};class al{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(t){const n=["foreground","underline","italics","background","flash"];for(let a=0;a<n.length;a++){const l=n[a];t.hasOwnProperty(l)&&(this[l]=t[l])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash}copy(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class eu{constructor(){this.uchar=" ",this.penState=new al}reset(){this.uchar=" ",this.penState.reset()}setChar(t,n){this.uchar=t,this.penState.copy(n)}setPenState(t){this.penState.copy(t)}equals(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)}copy(t){this.uchar=t.uchar,this.penState.copy(t.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class cd{constructor(t){this.chars=[],this.pos=0,this.currPenState=new al,this.cueStartTime=null,this.logger=void 0;for(let n=0;n<as;n++)this.chars.push(new eu);this.logger=t}equals(t){for(let n=0;n<as;n++)if(!this.chars[n].equals(t.chars[n]))return!1;return!0}copy(t){for(let n=0;n<as;n++)this.chars[n].copy(t.chars[n])}isEmpty(){let t=!0;for(let n=0;n<as;n++)if(!this.chars[n].isEmpty()){t=!1;break}return t}setCursor(t){this.pos!==t&&(this.pos=t),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>as&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=as)}moveCursor(t){const n=this.pos+t;if(t>1)for(let a=this.pos+1;a<n+1;a++)this.chars[a].setPenState(this.currPenState);this.setCursor(n)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(t){t>=144&&this.backSpace();const n=ud(t);if(this.pos>=as){this.logger.log(0,()=>"Cannot insert "+t.toString(16)+" ("+n+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(n,this.currPenState),this.moveCursor(1)}clearFromPos(t){let n;for(n=t;n<as;n++)this.chars[n].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const t=[];let n=!0;for(let a=0;a<as;a++){const l=this.chars[a].uchar;l!==" "&&(n=!1),t.push(l)}return n?"":t.join("")}setPenStyles(t){this.currPenState.setStyles(t),this.chars[this.pos].setPenState(this.currPenState)}}class so{constructor(t){this.rows=[],this.currRow=er-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let n=0;n<er;n++)this.rows.push(new cd(t));this.logger=t}reset(){for(let t=0;t<er;t++)this.rows[t].clear();this.currRow=er-1}equals(t){let n=!0;for(let a=0;a<er;a++)if(!this.rows[a].equals(t.rows[a])){n=!1;break}return n}copy(t){for(let n=0;n<er;n++)this.rows[n].copy(t.rows[n])}isEmpty(){let t=!0;for(let n=0;n<er;n++)if(!this.rows[n].isEmpty()){t=!1;break}return t}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(t){this.rows[this.currRow].insertChar(t)}setPen(t){this.rows[this.currRow].setPenStyles(t)}moveCursor(t){this.rows[this.currRow].moveCursor(t)}setCursor(t){this.logger.log(2,"setCursor: "+t),this.rows[this.currRow].setCursor(t)}setPAC(t){this.logger.log(2,()=>"pacData = "+JSON.stringify(t));let n=t.row-1;if(this.nrRollUpRows&&n<this.nrRollUpRows-1&&(n=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==n){for(let p=0;p<er;p++)this.rows[p].clear();const u=this.currRow+1-this.nrRollUpRows,d=this.lastOutputScreen;if(d){const p=d.rows[u].cueStartTime,g=this.logger.time;if(p!==null&&g!==null&&p<g)for(let v=0;v<this.nrRollUpRows;v++)this.rows[n-this.nrRollUpRows+v+1].copy(d.rows[u+v])}}this.currRow=n;const a=this.rows[this.currRow];if(t.indent!==null){const u=t.indent,d=Math.max(u-1,0);a.setCursor(t.indent),t.color=a.chars[d].penState.foreground}const l={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1};this.setPen(l)}setBkgData(t){this.logger.log(2,()=>"bkgData = "+JSON.stringify(t)),this.backSpace(),this.setPen(t),this.insertChar(32)}setRollUpRows(t){this.nrRollUpRows=t}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const t=this.currRow+1-this.nrRollUpRows,n=this.rows.splice(t,1)[0];n.clear(),this.rows.splice(this.currRow,0,n),this.logger.log(2,"Rolling up")}getDisplayText(t){t=t||!1;const n=[];let a="",l=-1;for(let u=0;u<er;u++){const d=this.rows[u].getTextString();d&&(l=u+1,t?n.push("Row "+l+": '"+d+"'"):n.push(d.trim()))}return n.length>0&&(t?a="["+n.join(" | ")+"]":a=n.join(`
`)),a}getTextAndFormat(){return this.rows}}class ao{constructor(t,n,a){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=t,this.outputFilter=n,this.mode=null,this.verbose=0,this.displayedMemory=new so(a),this.nonDisplayedMemory=new so(a),this.lastOutputScreen=new so(a),this.currRollUpRow=this.displayedMemory.rows[er-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=a}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[er-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(t){this.outputFilter=t}setPAC(t){this.writeScreen.setPAC(t)}setBkgData(t){this.writeScreen.setBkgData(t)}setMode(t){t!==this.mode&&(this.mode=t,this.logger.log(2,()=>"MODE="+t),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)}insertChars(t){for(let a=0;a<t.length;a++)this.writeScreen.insertChar(t[a]);const n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>n+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(t){this.logger.log(2,"RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(t){this.logger.log(2,"TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)}ccMIDROW(t){const n={flash:!1};if(n.underline=t%2==1,n.italics=t>=46,n.italics)n.foreground="white";else{const a=Math.floor(t/2)-16,l=["white","green","blue","cyan","red","yellow","magenta"];n.foreground=l[a]}this.logger.log(2,"MIDROW: "+JSON.stringify(n)),this.writeScreen.setPen(n)}outputDataUpdate(t=!1){const n=this.logger.time;n!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=n:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,n,this.lastOutputScreen),t&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:n),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))}}class hd{constructor(t,n,a){this.channels=void 0,this.currentChannel=0,this.cmdHistory=lo(),this.logger=void 0;const l=this.logger=new $c;this.channels=[null,new ao(t,n,l),new ao(t+1,a,l)]}getHandler(t){return this.channels[t].getHandler()}setHandler(t,n){this.channels[t].setHandler(n)}addData(t,n){this.logger.time=t;for(let a=0;a<n.length;a+=2){const l=n[a]&127,u=n[a+1]&127;let d=!1,p=null;if(l===0&&u===0)continue;this.logger.log(3,()=>"["+ws([n[a],n[a+1]])+"] -> ("+ws([l,u])+")");const g=this.cmdHistory;if(l>=16&&l<=31){if(fd(l,u,g)){oo(null,null,g),this.logger.log(3,()=>"Repeated command ("+ws([l,u])+") is dropped");continue}oo(l,u,this.cmdHistory),d=this.parseCmd(l,u),d||(d=this.parseMidrow(l,u)),d||(d=this.parsePAC(l,u)),d||(d=this.parseBackgroundAttributes(l,u))}else oo(null,null,g);if(!d&&(p=this.parseChars(l,u),p)){const b=this.currentChannel;b&&b>0?this.channels[b].insertChars(p):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!d&&!p&&this.logger.log(2,()=>"Couldn't parse cleaned data "+ws([l,u])+" orig: "+ws([n[a],n[a+1]]))}}parseCmd(t,n){const a=(t===20||t===28||t===21||t===29)&&n>=32&&n<=47,l=(t===23||t===31)&&n>=33&&n<=35;if(!(a||l))return!1;const u=t===20||t===21||t===23?1:2,d=this.channels[u];return t===20||t===21||t===28||t===29?n===32?d.ccRCL():n===33?d.ccBS():n===34?d.ccAOF():n===35?d.ccAON():n===36?d.ccDER():n===37?d.ccRU(2):n===38?d.ccRU(3):n===39?d.ccRU(4):n===40?d.ccFON():n===41?d.ccRDC():n===42?d.ccTR():n===43?d.ccRTD():n===44?d.ccEDM():n===45?d.ccCR():n===46?d.ccENM():n===47&&d.ccEOC():d.ccTO(n-32),this.currentChannel=u,!0}parseMidrow(t,n){let a=0;if((t===17||t===25)&&n>=32&&n<=47){if(t===17?a=1:a=2,a!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const l=this.channels[a];return l?(l.ccMIDROW(n),this.logger.log(3,()=>"MIDROW ("+ws([t,n])+")"),!0):!1}return!1}parsePAC(t,n){let a;const l=(t>=17&&t<=23||t>=25&&t<=31)&&n>=64&&n<=127,u=(t===16||t===24)&&n>=64&&n<=95;if(!(l||u))return!1;const d=t<=23?1:2;n>=64&&n<=95?a=d===1?dd[t]:sl[t]:a=d===1?Nc[t]:Uc[t];const p=this.channels[d];return p?(p.setPAC(this.interpretPAC(a,n)),this.currentChannel=d,!0):!1}interpretPAC(t,n){let a;const l={color:null,italics:!1,indent:null,underline:!1,row:t};return n>95?a=n-96:a=n-64,l.underline=(a&1)==1,a<=13?l.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(a/2)]:a<=15?(l.italics=!0,l.color="white"):l.indent=Math.floor((a-16)/2)*4,l}parseChars(t,n){let a,l=null,u=null;if(t>=25?(a=2,u=t-8):(a=1,u=t),u>=17&&u<=19){let d;u===17?d=n+80:u===18?d=n+112:d=n+144,this.logger.log(2,()=>"Special char '"+ud(d)+"' in channel "+a),l=[d]}else t>=32&&t<=127&&(l=n===0?[t]:[t,n]);return l&&this.logger.log(3,()=>"Char codes =  "+ws(l).join(",")),l}parseBackgroundAttributes(t,n){const a=(t===16||t===24)&&n>=32&&n<=47,l=(t===23||t===31)&&n>=45&&n<=47;if(!(a||l))return!1;let u;const d={};t===16||t===24?(u=Math.floor((n-32)/2),d.background=jc[u],n%2==1&&(d.background=d.background+"_semi")):n===45?d.background="transparent":(d.foreground="black",n===47&&(d.underline=!0));const p=t<=23?1:2;return this.channels[p].setBkgData(d),!0}reset(){for(let t=0;t<Object.keys(this.channels).length;t++){const n=this.channels[t];n&&n.reset()}oo(null,null,this.cmdHistory)}cueSplitAtTime(t){for(let n=0;n<this.channels.length;n++){const a=this.channels[n];a&&a.cueSplitAtTime(t)}}}function oo(h,t,n){n.a=h,n.b=t}function fd(h,t,n){return n.a===h&&n.b===t}function lo(){return{a:null,b:null}}class uo{constructor(t,n){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=t,this.trackName=n}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(t,n,a){(this.startTime===null||this.startTime>t)&&(this.startTime=t),this.endTime=n,this.screen=a,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var ol=function(){if(gt!=null&&gt.VTTCue)return self.VTTCue;const h=["","lr","rl"],t=["start","middle","end","left","right"];function n(p,g){if(typeof g!="string"||!Array.isArray(p))return!1;const v=g.toLowerCase();return~p.indexOf(v)?v:!1}function a(p){return n(h,p)}function l(p){return n(t,p)}function u(p,...g){let v=1;for(;v<arguments.length;v++){const b=arguments[v];for(const L in b)p[L]=b[L]}return p}function d(p,g,v){const b=this,L={enumerable:!0};b.hasBeenReset=!1;let B="",W=!1,K=p,ee=g,re=v,xe=null,Fe="",Me=!0,it="auto",$e="start",ut=50,Qe="middle",yt=50,xt="middle";Object.defineProperty(b,"id",u({},L,{get:function(){return B},set:function(ot){B=""+ot}})),Object.defineProperty(b,"pauseOnExit",u({},L,{get:function(){return W},set:function(ot){W=!!ot}})),Object.defineProperty(b,"startTime",u({},L,{get:function(){return K},set:function(ot){if(typeof ot!="number")throw new TypeError("Start time must be set to a number.");K=ot,this.hasBeenReset=!0}})),Object.defineProperty(b,"endTime",u({},L,{get:function(){return ee},set:function(ot){if(typeof ot!="number")throw new TypeError("End time must be set to a number.");ee=ot,this.hasBeenReset=!0}})),Object.defineProperty(b,"text",u({},L,{get:function(){return re},set:function(ot){re=""+ot,this.hasBeenReset=!0}})),Object.defineProperty(b,"region",u({},L,{get:function(){return xe},set:function(ot){xe=ot,this.hasBeenReset=!0}})),Object.defineProperty(b,"vertical",u({},L,{get:function(){return Fe},set:function(ot){const At=a(ot);if(At===!1)throw new SyntaxError("An invalid or illegal string was specified.");Fe=At,this.hasBeenReset=!0}})),Object.defineProperty(b,"snapToLines",u({},L,{get:function(){return Me},set:function(ot){Me=!!ot,this.hasBeenReset=!0}})),Object.defineProperty(b,"line",u({},L,{get:function(){return it},set:function(ot){if(typeof ot!="number"&&ot!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");it=ot,this.hasBeenReset=!0}})),Object.defineProperty(b,"lineAlign",u({},L,{get:function(){return $e},set:function(ot){const At=l(ot);if(!At)throw new SyntaxError("An invalid or illegal string was specified.");$e=At,this.hasBeenReset=!0}})),Object.defineProperty(b,"position",u({},L,{get:function(){return ut},set:function(ot){if(ot<0||ot>100)throw new Error("Position must be between 0 and 100.");ut=ot,this.hasBeenReset=!0}})),Object.defineProperty(b,"positionAlign",u({},L,{get:function(){return Qe},set:function(ot){const At=l(ot);if(!At)throw new SyntaxError("An invalid or illegal string was specified.");Qe=At,this.hasBeenReset=!0}})),Object.defineProperty(b,"size",u({},L,{get:function(){return yt},set:function(ot){if(ot<0||ot>100)throw new Error("Size must be between 0 and 100.");yt=ot,this.hasBeenReset=!0}})),Object.defineProperty(b,"align",u({},L,{get:function(){return xt},set:function(ot){const At=l(ot);if(!At)throw new SyntaxError("An invalid or illegal string was specified.");xt=At,this.hasBeenReset=!0}})),b.displayState=void 0}return d.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},d}();class os{decode(t,n){if(!t)return"";if(typeof t!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}function tr(h){function t(a,l,u,d){return(a|0)*3600+(l|0)*60+(u|0)+parseFloat(d||0)}const n=h.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return n?parseFloat(n[2])>59?t(n[2],n[3],0,n[4]):t(n[1],n[2],n[3],n[4]):null}class Ba{constructor(){this.values=Object.create(null)}set(t,n){!this.get(t)&&n!==""&&(this.values[t]=n)}get(t,n,a){return a?this.has(t)?this.values[t]:n[a]:this.has(t)?this.values[t]:n}has(t){return t in this.values}alt(t,n,a){for(let l=0;l<a.length;++l)if(n===a[l]){this.set(t,n);break}}integer(t,n){/^-?\d+$/.test(n)&&this.set(t,parseInt(n,10))}percent(t,n){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(n)){const a=parseFloat(n);if(a>=0&&a<=100)return this.set(t,a),!0}return!1}}function Ln(h,t,n,a){const l=a?h.split(a):[h];for(const u in l){if(typeof l[u]!="string")continue;const d=l[u].split(n);if(d.length!==2)continue;const p=d[0],g=d[1];t(p,g)}}const tu=new ol(0,0,""),ni=tu.align==="middle"?"middle":"center";function ta(h,t,n){const a=h;function l(){const p=tr(h);if(p===null)throw new Error("Malformed timestamp: "+a);return h=h.replace(/^[^\sa-zA-Z-]+/,""),p}function u(p,g){const v=new Ba;Ln(p,function(B,W){let K;switch(B){case"region":for(let ee=n.length-1;ee>=0;ee--)if(n[ee].id===W){v.set(B,n[ee].region);break}break;case"vertical":v.alt(B,W,["rl","lr"]);break;case"line":K=W.split(","),v.integer(B,K[0]),v.percent(B,K[0])&&v.set("snapToLines",!1),v.alt(B,K[0],["auto"]),K.length===2&&v.alt("lineAlign",K[1],["start",ni,"end"]);break;case"position":K=W.split(","),v.percent(B,K[0]),K.length===2&&v.alt("positionAlign",K[1],["start",ni,"end","line-left","line-right","auto"]);break;case"size":v.percent(B,W);break;case"align":v.alt(B,W,["start",ni,"end","left","right"]);break}},/:/,/\s/),g.region=v.get("region",null),g.vertical=v.get("vertical","");let b=v.get("line","auto");b==="auto"&&tu.line===-1&&(b=-1),g.line=b,g.lineAlign=v.get("lineAlign","start"),g.snapToLines=v.get("snapToLines",!0),g.size=v.get("size",100),g.align=v.get("align",ni);let L=v.get("position","auto");L==="auto"&&tu.position===50&&(L=g.align==="start"||g.align==="left"?0:g.align==="end"||g.align==="right"?100:50),g.position=L}function d(){h=h.replace(/^\s+/,"")}if(d(),t.startTime=l(),d(),h.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+a);h=h.slice(3),d(),t.endTime=l(),d(),u(h,t)}function co(h){return h.replace(/<br(?: \/)?>/gi,`
`)}class ll{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new os,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(t){const n=this;t&&(n.buffer+=n.decoder.decode(t,{stream:!0}));function a(){let u=n.buffer,d=0;for(u=co(u);d<u.length&&u[d]!=="\r"&&u[d]!==`
`;)++d;const p=u.slice(0,d);return u[d]==="\r"&&++d,u[d]===`
`&&++d,n.buffer=u.slice(d),p}function l(u){Ln(u,function(d,p){},/:/)}try{let u="";if(n.state==="INITIAL"){if(!/\r\n|\n/.test(n.buffer))return this;u=a();const p=u.match(/^()?WEBVTT([ \t].*)?$/);if(!(p!=null&&p[0]))throw new Error("Malformed WebVTT signature.");n.state="HEADER"}let d=!1;for(;n.buffer;){if(!/\r\n|\n/.test(n.buffer))return this;switch(d?d=!1:u=a(),n.state){case"HEADER":/:/.test(u)?l(u):u||(n.state="ID");continue;case"NOTE":u||(n.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(u)){n.state="NOTE";break}if(!u)continue;if(n.cue=new ol(0,0,""),n.state="CUE",u.indexOf("-->")===-1){n.cue.id=u;continue}case"CUE":if(!n.cue){n.state="BADCUE";continue}try{ta(u,n.cue,n.regionList)}catch(p){n.cue=null,n.state="BADCUE";continue}n.state="CUETEXT";continue;case"CUETEXT":{const p=u.indexOf("-->")!==-1;if(!u||p&&(d=!0)){n.oncue&&n.cue&&n.oncue(n.cue),n.cue=null,n.state="ID";continue}if(n.cue===null)continue;n.cue.text&&(n.cue.text+=`
`),n.cue.text+=u}continue;case"BADCUE":u||(n.state="ID")}}}catch(u){n.state==="CUETEXT"&&n.cue&&n.oncue&&n.oncue(n.cue),n.cue=null,n.state=n.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const t=this;try{if((t.cue||t.state==="HEADER")&&(t.buffer+=`

`,t.parse()),t.state==="INITIAL"||t.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(n){t.onparsingerror&&t.onparsingerror(n)}return t.onflush&&t.onflush(),this}}const Vc=/\r\n|\n\r|\n|\r/g,iu=function(t,n,a=0){return t.slice(a,a+n.length)===n},Hc=function(t){let n=parseInt(t.slice(-3));const a=parseInt(t.slice(-6,-4)),l=parseInt(t.slice(-9,-7)),u=t.length>9?parseInt(t.substring(0,t.indexOf(":"))):0;if(!te(n)||!te(a)||!te(l)||!te(u))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${t}`);return n+=1e3*a,n+=60*1e3*l,n+=60*60*1e3*u,n},nu=function(t){let n=5381,a=t.length;for(;a;)n=n*33^t.charCodeAt(--a);return(n>>>0).toString()};function ru(h,t,n){return nu(h.toString())+nu(t.toString())+nu(n)}const pd=function(t,n,a){let l=t[n],u=t[l.prevCC];if(!u||!u.new&&l.new){t.ccOffset=t.presentationOffset=l.start,l.new=!1;return}for(;(d=u)!=null&&d.new;){var d;t.ccOffset+=l.start-u.start,l.new=!1,l=u,u=t[l.prevCC]}t.presentationOffset=a};function Gc(h,t,n,a,l,u,d){const p=new ll,g=Ze(new Uint8Array(h)).trim().replace(Vc,`
`).split(`
`),v=[],b=t?id(t.baseTime,t.timescale):0;let L="00:00.000",B=0,W=0,K,ee=!0;p.oncue=function(re){const xe=n[a];let Fe=n.ccOffset;const Me=(B-b)/9e4;if(xe!=null&&xe.new&&(W!==void 0?Fe=n.ccOffset=xe.start:pd(n,a,Me)),Me){if(!t){K=new Error("Missing initPTS for VTT MPEGTS");return}Fe=Me-n.presentationOffset}const it=re.endTime-re.startTime,$e=Mn((re.startTime+Fe-W)*9e4,l*9e4)/9e4;re.startTime=Math.max($e,0),re.endTime=Math.max($e+it,0);const ut=re.text.trim();re.text=decodeURIComponent(encodeURIComponent(ut)),re.id||(re.id=ru(re.startTime,re.endTime,ut)),re.endTime>0&&v.push(re)},p.onparsingerror=function(re){K=re},p.onflush=function(){if(K){d(K);return}u(v)},g.forEach(re=>{if(ee)if(iu(re,"X-TIMESTAMP-MAP=")){ee=!1,re.slice(16).split(",").forEach(xe=>{iu(xe,"LOCAL:")?L=xe.slice(6):iu(xe,"MPEGTS:")&&(B=parseInt(xe.slice(7)))});try{W=Hc(L)/1e3}catch(xe){K=xe}return}else re===""&&(ee=!1);p.parse(re+`
`)}),p.flush()}const su="stpp.ttml.im1t",au=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,ul=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,qc={left:"start",center:"center",right:"end",start:"start",end:"end"};function md(h,t,n,a){const l=Jt(new Uint8Array(h),["mdat"]);if(l.length===0){a(new Error("Could not parse IMSC1 mdat"));return}const u=l.map(p=>Ze(p)),d=Ni(t.baseTime,1,t.timescale);try{u.forEach(p=>n(zc(p,d)))}catch(p){a(p)}}function zc(h,t){const l=new DOMParser().parseFromString(h,"text/xml").getElementsByTagName("tt")[0];if(!l)throw new Error("Invalid ttml");const u={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},d=Object.keys(u).reduce((L,B)=>(L[B]=l.getAttribute(`ttp:${B}`)||u[B],L),{}),p=l.getAttribute("xml:space")!=="preserve",g=gd(ls(l,"styling","style")),v=gd(ls(l,"layout","region")),b=ls(l,"body","[begin]");return[].map.call(b,L=>{const B=ho(L,p);if(!B||!L.hasAttribute("begin"))return null;const W=lu(L.getAttribute("begin"),d),K=lu(L.getAttribute("dur"),d);let ee=lu(L.getAttribute("end"),d);if(W===null)throw ou(L);if(ee===null){if(K===null)throw ou(L);ee=W+K}const re=new ol(W-t,ee-t,B);re.id=ru(re.startTime,re.endTime,re.text);const xe=v[L.getAttribute("region")],Fe=g[L.getAttribute("style")],Me=Wc(xe,Fe,g),{textAlign:it}=Me;if(it){const $e=qc[it];$e&&(re.lineAlign=$e),re.align=it}return se(re,Me),re}).filter(L=>L!==null)}function ls(h,t,n){const a=h.getElementsByTagName(t)[0];return a?[].slice.call(a.querySelectorAll(n)):[]}function gd(h){return h.reduce((t,n)=>{const a=n.getAttribute("xml:id");return a&&(t[a]=n),t},{})}function ho(h,t){return[].slice.call(h.childNodes).reduce((n,a,l)=>{var u;return a.nodeName==="br"&&l?n+`
`:(u=a.childNodes)!=null&&u.length?ho(a,t):t?n+a.textContent.trim().replace(/\s+/g," "):n+a.textContent},"")}function Wc(h,t,n){const a="http://www.w3.org/ns/ttml#styling";let l=null;const u=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],d=h!=null&&h.hasAttribute("style")?h.getAttribute("style"):null;return d&&n.hasOwnProperty(d)&&(l=n[d]),u.reduce((p,g)=>{const v=dl(t,a,g)||dl(h,a,g)||dl(l,a,g);return v&&(p[g]=v),p},{})}function dl(h,t,n){return h&&h.hasAttributeNS(t,n)?h.getAttributeNS(t,n):null}function ou(h){return new Error(`Could not parse ttml timestamp ${h}`)}function lu(h,t){if(!h)return null;let n=tr(h);return n===null&&(au.test(h)?n=yd(h,t):ul.test(h)&&(n=Ma(h,t))),n}function yd(h,t){const n=au.exec(h),a=(n[4]|0)+(n[5]|0)/t.subFrameRate;return(n[1]|0)*3600+(n[2]|0)*60+(n[3]|0)+a/t.frameRate}function Ma(h,t){const n=ul.exec(h),a=Number(n[1]);switch(n[2]){case"h":return a*3600;case"m":return a*60;case"ms":return a*1e3;case"f":return a/t.frameRate;case"t":return a/t.tickRate}return a}class vd{constructor(t){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=hl(),this.captionsProperties=void 0,this.hls=t,this.config=t.config,this.Cues=t.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},t.on(A.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(A.MANIFEST_LOADING,this.onManifestLoading,this),t.on(A.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(A.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(A.FRAG_LOADING,this.onFragLoading,this),t.on(A.FRAG_LOADED,this.onFragLoaded,this),t.on(A.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.on(A.FRAG_DECRYPTED,this.onFragDecrypted,this),t.on(A.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(A.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.on(A.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:t}=this;t.off(A.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(A.MANIFEST_LOADING,this.onManifestLoading,this),t.off(A.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(A.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(A.FRAG_LOADING,this.onFragLoading,this),t.off(A.FRAG_LOADED,this.onFragLoaded,this),t.off(A.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.off(A.FRAG_DECRYPTED,this.onFragDecrypted,this),t.off(A.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(A.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.off(A.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){if(this.config.enableCEA708Captions&&(!this.cea608Parser1||!this.cea608Parser2)){const t=new uo(this,"textTrack1"),n=new uo(this,"textTrack2"),a=new uo(this,"textTrack3"),l=new uo(this,"textTrack4");this.cea608Parser1=new hd(1,t,n),this.cea608Parser2=new hd(3,a,l)}}addCues(t,n,a,l,u){let d=!1;for(let p=u.length;p--;){const g=u[p],v=cl(g[0],g[1],n,a);if(v>=0&&(g[0]=Math.min(g[0],n),g[1]=Math.max(g[1],a),d=!0,v/(a-n)>.5))return}if(d||u.push([n,a]),this.config.renderTextTracksNatively){const p=this.captionsTracks[t];this.Cues.newCue(p,n,a,l)}else{const p=this.Cues.newCue(null,n,a,l);this.hls.trigger(A.CUES_PARSED,{type:"captions",cues:p,track:t})}}onInitPtsFound(t,{frag:n,id:a,initPTS:l,timescale:u}){const{unparsedVttFrags:d}=this;a==="main"&&(this.initPTS[n.cc]={baseTime:l,timescale:u}),d.length&&(this.unparsedVttFrags=[],d.forEach(p=>{this.onFragLoaded(A.FRAG_LOADED,p)}))}getExistingTrack(t,n){const{media:a}=this;if(a)for(let l=0;l<a.textTracks.length;l++){const u=a.textTracks[l];if(_d(u,{name:t,lang:n,attrs:{}}))return u}return null}createCaptionsTrack(t){this.config.renderTextTracksNatively?this.createNativeTrack(t):this.createNonNativeTrack(t)}createNativeTrack(t){if(this.captionsTracks[t])return;const{captionsProperties:n,captionsTracks:a,media:l}=this,{label:u,languageCode:d}=n[t],p=this.getExistingTrack(u,d);if(p)a[t]=p,vs(a[t]),Mo(a[t],l);else{const g=this.createTextTrack("captions",u,d);g&&(g[t]=!0,a[t]=g)}}createNonNativeTrack(t){if(this.nonNativeCaptionsTracks[t])return;const n=this.captionsProperties[t];if(!n)return;const a=n.label,l={_id:t,label:a,kind:"captions",default:n.media?!!n.media.default:!1,closedCaptions:n.media};this.nonNativeCaptionsTracks[t]=l,this.hls.trigger(A.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[l]})}createTextTrack(t,n,a){const l=this.media;if(!!l)return l.addTextTrack(t,n,a)}onMediaAttaching(t,n){this.media=n.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:t}=this;Object.keys(t).forEach(n=>{vs(t[n]),delete t[n]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=hl(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:t}=this;if(!t)return;const n=t.textTracks;if(n)for(let a=0;a<n.length;a++)vs(n[a])}onSubtitleTracksUpdated(t,n){const a=n.subtitleTracks||[],l=a.some(u=>u.textCodec===su);if(this.config.enableWebVTT||l&&this.config.enableIMSC1){if(Yl(this.tracks,a)){this.tracks=a;return}if(this.textTracks=[],this.tracks=a,this.config.renderTextTracksNatively){const d=this.media,p=d?ga(d.textTracks):null;if(this.tracks.forEach((g,v)=>{let b;if(p){let L=null;for(let B=0;B<p.length;B++)if(p[B]&&_d(p[B],g)){L=p[B],p[B]=null;break}L&&(b=L)}if(b)vs(b);else{const L=Ad(g);b=this.createTextTrack(L,g.name,g.lang),b&&(b.mode="disabled")}b&&this.textTracks.push(b)}),p!=null&&p.length){const g=p.filter(v=>v!==null).map(v=>v.label);g.length&&C.warn(`Media element contains unused subtitle tracks: ${g.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const d=this.tracks.map(p=>({label:p.name,kind:p.type.toLowerCase(),default:p.default,subtitleTrack:p}));this.hls.trigger(A.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:d})}}}onManifestLoaded(t,n){this.config.enableCEA708Captions&&n.captions&&n.captions.forEach(a=>{const l=/(?:CC|SERVICE)([1-4])/.exec(a.instreamId);if(!l)return;const u=`textTrack${l[1]}`,d=this.captionsProperties[u];!d||(d.label=a.name,a.lang&&(d.languageCode=a.lang),d.media=a)})}closedCaptionsForLevel(t){const n=this.hls.levels[t.level];return n==null?void 0:n.attrs["CLOSED-CAPTIONS"]}onFragLoading(t,n){if(this.enabled&&n.frag.type===qt.MAIN){var a,l;const{cea608Parser1:u,cea608Parser2:d,lastSn:p}=this,{cc:g,sn:v}=n.frag,b=(a=(l=n.part)==null?void 0:l.index)!=null?a:-1;u&&d&&(v!==p+1||v===p&&b!==this.lastPartIndex+1||g!==this.lastCc)&&(u.reset(),d.reset()),this.lastCc=g,this.lastSn=v,this.lastPartIndex=b}}onFragLoaded(t,n){const{frag:a,payload:l}=n;if(a.type===qt.SUBTITLE)if(l.byteLength){const u=a.decryptdata,d="stats"in n;if(u==null||!u.encrypted||d){const p=this.tracks[a.level],g=this.vttCCs;g[a.cc]||(g[a.cc]={start:a.start,prevCC:this.prevCC,new:!0},this.prevCC=a.cc),p&&p.textCodec===su?this._parseIMSC1(a,l):this._parseVTTs(n)}}else this.hls.trigger(A.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:a,error:new Error("Empty subtitle payload")})}_parseIMSC1(t,n){const a=this.hls;md(n,this.initPTS[t.cc],l=>{this._appendCues(l,t.level),a.trigger(A.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})},l=>{C.log(`Failed to parse IMSC1: ${l}`),a.trigger(A.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t,error:l})})}_parseVTTs(t){var n;const{frag:a,payload:l}=t,{initPTS:u,unparsedVttFrags:d}=this,p=u.length-1;if(!u[a.cc]&&p===-1){d.push(t);return}const g=this.hls,v=(n=a.initSegment)!=null&&n.data?ft(a.initSegment.data,new Uint8Array(l)):l;Gc(v,this.initPTS[a.cc],this.vttCCs,a.cc,a.start,b=>{this._appendCues(b,a.level),g.trigger(A.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:a})},b=>{const L=b.message==="Missing initPTS for VTT MPEGTS";L?d.push(t):this._fallbackToIMSC1(a,l),C.log(`Failed to parse VTT cue: ${b}`),!(L&&p>a.cc)&&g.trigger(A.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:a,error:b})})}_fallbackToIMSC1(t,n){const a=this.tracks[t.level];a.textCodec||md(n,this.initPTS[t.cc],()=>{a.textCodec=su,this._parseIMSC1(t,n)},()=>{a.textCodec="wvtt"})}_appendCues(t,n){const a=this.hls;if(this.config.renderTextTracksNatively){const l=this.textTracks[n];if(!l||l.mode==="disabled")return;t.forEach(u=>Ka(l,u))}else{const l=this.tracks[n];if(!l)return;const u=l.default?"default":"subtitles"+n;a.trigger(A.CUES_PARSED,{type:"subtitles",cues:t,track:u})}}onFragDecrypted(t,n){const{frag:a}=n;a.type===qt.SUBTITLE&&this.onFragLoaded(A.FRAG_LOADED,n)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(t,n){this.initCea608Parsers();const{cea608Parser1:a,cea608Parser2:l}=this;if(!this.enabled||!a||!l)return;const{frag:u,samples:d}=n;if(!(u.type===qt.MAIN&&this.closedCaptionsForLevel(u)==="NONE"))for(let p=0;p<d.length;p++){const g=d[p].bytes;if(g){const v=this.extractCea608Data(g);a.addData(d[p].pts,v[0]),l.addData(d[p].pts,v[1])}}}onBufferFlushing(t,{startOffset:n,endOffset:a,endOffsetSubtitles:l,type:u}){const{media:d}=this;if(!(!d||d.currentTime<a)){if(!u||u==="video"){const{captionsTracks:p}=this;Object.keys(p).forEach(g=>Fo(p[g],n,a))}if(this.config.renderTextTracksNatively&&n===0&&l!==void 0){const{textTracks:p}=this;Object.keys(p).forEach(g=>Fo(p[g],n,l))}}}extractCea608Data(t){const n=[[],[]],a=t[0]&31;let l=2;for(let u=0;u<a;u++){const d=t[l++],p=127&t[l++],g=127&t[l++];if(p===0&&g===0)continue;if((4&d)!=0){const b=3&d;(b===0||b===1)&&(n[b].push(p),n[b].push(g))}}return n}}function Ad(h){return h.characteristics&&/transcribes-spoken-dialog/gi.test(h.characteristics)&&/describes-music-and-sound/gi.test(h.characteristics)?"captions":"subtitles"}function _d(h,t){return!!h&&h.kind===Ad(t)&&ss(t,h)}function cl(h,t,n,a){return Math.min(t,a)-Math.max(h,n)}function hl(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class zn{constructor(t){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=t,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(t){this.streamController=t}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:t}=this;t.on(A.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.on(A.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(A.MANIFEST_PARSED,this.onManifestParsed,this),t.on(A.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(A.BUFFER_CODECS,this.onBufferCodecs,this),t.on(A.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:t}=this;t.off(A.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),t.off(A.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(A.MANIFEST_PARSED,this.onManifestParsed,this),t.off(A.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(A.BUFFER_CODECS,this.onBufferCodecs,this),t.off(A.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(t,n){const a=this.hls.levels[n.droppedLevel];this.isLevelAllowed(a)&&this.restrictedLevels.push({bitrate:a.bitrate,height:a.height,width:a.width})}onMediaAttaching(t,n){this.media=n.media instanceof HTMLVideoElement?n.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(t,n){const a=this.hls;this.restrictedLevels=[],this.firstLevel=n.firstLevel,a.config.capLevelToPlayerSize&&n.video&&this.startCapping()}onLevelsUpdated(t,n){this.timer&&te(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(t,n){this.hls.config.capLevelToPlayerSize&&n.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const t=this.hls.levels;if(t.length){const n=this.hls,a=this.getMaxLevel(t.length-1);a!==this.autoLevelCapping&&C.log(`Setting autoLevelCapping to ${a}: ${t[a].height}p@${t[a].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),n.autoLevelCapping=a,n.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=n.autoLevelCapping}}}getMaxLevel(t){const n=this.hls.levels;if(!n.length)return-1;const a=n.filter((l,u)=>this.isLevelAllowed(l)&&u<=t);return this.clientRect=null,zn.getMaxLevelByMediaSize(a,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const t=this.media,n={width:0,height:0};if(t){const a=t.getBoundingClientRect();n.width=a.width,n.height=a.height,!n.width&&!n.height&&(n.width=a.right-a.left||t.width||0,n.height=a.bottom-a.top||t.height||0)}return this.clientRect=n,n}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let t=1;if(!this.hls.config.ignoreDevicePixelRatio)try{t=self.devicePixelRatio}catch(n){}return t}isLevelAllowed(t){return!this.restrictedLevels.some(a=>t.bitrate===a.bitrate&&t.width===a.width&&t.height===a.height)}static getMaxLevelByMediaSize(t,n,a){if(!(t!=null&&t.length))return-1;const l=(p,g)=>g?p.width!==g.width||p.height!==g.height:!0;let u=t.length-1;const d=Math.max(n,a);for(let p=0;p<t.length;p+=1){const g=t[p];if((g.width>=d||g.height>=d)&&l(g,t[p+1])){u=p;break}}return u}}class bd{constructor(t){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=t,this.registerListeners()}setStreamController(t){this.streamController=t}registerListeners(){this.hls.on(A.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(A.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(t,n){const a=this.hls.config;if(a.capLevelOnFPSDrop){const l=n.media instanceof self.HTMLVideoElement?n.media:null;this.media=l,l&&typeof l.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),a.fpsDroppedMonitoringPeriod)}}checkFPS(t,n,a){const l=performance.now();if(n){if(this.lastTime){const u=l-this.lastTime,d=a-this.lastDroppedFrames,p=n-this.lastDecodedFrames,g=1e3*d/u,v=this.hls;if(v.trigger(A.FPS_DROP,{currentDropped:d,currentDecoded:p,totalDroppedFrames:a}),g>0&&d>v.config.fpsDroppedMonitoringThreshold*p){let b=v.currentLevel;C.warn("drop FPS ratio greater than max allowed value for currentLevel: "+b),b>0&&(v.autoLevelCapping===-1||v.autoLevelCapping>=b)&&(b=b-1,v.trigger(A.FPS_DROP_LEVEL_CAPPING,{level:b,droppedLevel:v.currentLevel}),v.autoLevelCapping=b,this.streamController.nextLevelSwitch())}}this.lastTime=l,this.lastDroppedFrames=a,this.lastDecodedFrames=n}}checkFPSInterval(){const t=this.media;if(t)if(this.isVideoPlaybackQualityAvailable){const n=t.getVideoPlaybackQuality();this.checkFPS(t,n.totalVideoFrames,n.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)}}const fl="[eme]";class Ls{constructor(t){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=Ls.CDMCleanupPromise?[Ls.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=C.debug.bind(C,fl),this.log=C.log.bind(C,fl),this.warn=C.warn.bind(C,fl),this.error=C.error.bind(C,fl),this.hls=t,this.config=t.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const t=this.config;t.requestMediaKeySystemAccessFunc=null,t.licenseXhrSetup=t.licenseResponseCallback=void 0,t.drmSystems=t.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(A.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(A.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(A.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(A.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(A.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(A.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(t){const{drmSystems:n,widevineLicenseUrl:a}=this.config,l=n[t];if(l)return l.licenseUrl;if(t===nt.WIDEVINE&&a)return a;throw new Error(`no license server URL configured for key-system "${t}"`)}getServerCertificateUrl(t){const{drmSystems:n}=this.config,a=n[t];if(a)return a.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${t}"]`)}attemptKeySystemAccess(t){const n=this.hls.levels,a=(d,p,g)=>!!d&&g.indexOf(d)===p,l=n.map(d=>d.audioCodec).filter(a),u=n.map(d=>d.videoCodec).filter(a);return l.length+u.length===0&&u.push("avc1.42e01e"),new Promise((d,p)=>{const g=v=>{const b=v.shift();this.getMediaKeysPromise(b,l,u).then(L=>d({keySystem:b,mediaKeys:L})).catch(L=>{v.length?g(v):L instanceof Dn?p(L):p(new Dn({type:M.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_NO_ACCESS,error:L,fatal:!0},L.message))})};g(t)})}requestMediaKeySystemAccess(t,n){const{requestMediaKeySystemAccessFunc:a}=this.config;if(typeof a!="function"){let l=`Configured requestMediaKeySystemAccess is not a function ${a}`;return Ai===null&&self.location.protocol==="http:"&&(l=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(l))}return a(t,n)}getMediaKeysPromise(t,n,a){const l=Ct(t,n,a,this.config.drmSystemOptions),u=this.keySystemAccessPromises[t];let d=u==null?void 0:u.keySystemAccess;if(!d){this.log(`Requesting encrypted media "${t}" key-system access with config: ${JSON.stringify(l)}`),d=this.requestMediaKeySystemAccess(t,l);const p=this.keySystemAccessPromises[t]={keySystemAccess:d};return d.catch(g=>{this.log(`Failed to obtain access to key-system "${t}": ${g}`)}),d.then(g=>{this.log(`Access for key-system "${g.keySystem}" obtained`);const v=this.fetchServerCertificate(t);return this.log(`Create media-keys for "${t}"`),p.mediaKeys=g.createMediaKeys().then(b=>(this.log(`Media-keys created for "${t}"`),v.then(L=>L?this.setMediaKeysServerCertificate(b,t,L):b))),p.mediaKeys.catch(b=>{this.error(`Failed to create media-keys for "${t}"}: ${b}`)}),p.mediaKeys})}return d.then(()=>u.mediaKeys)}createMediaKeySessionContext({decryptdata:t,keySystem:n,mediaKeys:a}){this.log(`Creating key-system session "${n}" keyId: ${Lt.hexDump(t.keyId||[])}`);const l=a.createSession(),u={decryptdata:t,keySystem:n,mediaKeys:a,mediaKeysSession:l,keyStatus:"status-pending"};return this.mediaKeySessions.push(u),u}renewKeySession(t){const n=t.decryptdata;if(n.pssh){const a=this.createMediaKeySessionContext(t),l=this.getKeyIdString(n),u="cenc";this.keyIdToKeySessionPromise[l]=this.generateRequestWithPreferredKeySession(a,u,n.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(t)}getKeyIdString(t){if(!t)throw new Error("Could not read keyId of undefined decryptdata");if(t.keyId===null)throw new Error("keyId is null");return Lt.hexDump(t.keyId)}updateKeySession(t,n){var a;const l=t.mediaKeysSession;return this.log(`Updating key-session "${l.sessionId}" for keyID ${Lt.hexDump(((a=t.decryptdata)==null?void 0:a.keyId)||[])}
      } (data length: ${n&&n.byteLength})`),l.update(n)}selectKeySystemFormat(t){const n=Object.keys(t.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${t.sn} ${t.type}: ${t.level}) key formats ${n.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(n)),this.keyFormatPromise}getKeyFormatPromise(t){return new Promise((n,a)=>{const l=Ei(this.config),u=t.map(Tt).filter(d=>!!d&&l.indexOf(d)!==-1);return this.getKeySystemSelectionPromise(u).then(({keySystem:d})=>{const p=ai(d);p?n(p):a(new Error(`Unable to find format for key-system "${d}"`))}).catch(a)})}loadKey(t){const n=t.keyInfo.decryptdata,a=this.getKeyIdString(n),l=`(keyId: ${a} format: "${n.keyFormat}" method: ${n.method} uri: ${n.uri})`;this.log(`Starting session for key ${l}`);let u=this.keyIdToKeySessionPromise[a];return u||(u=this.keyIdToKeySessionPromise[a]=this.getKeySystemForKeyPromise(n).then(({keySystem:d,mediaKeys:p})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${t.frag.sn} ${t.frag.type}: ${t.frag.level} using key ${l}`),this.attemptSetMediaKeys(d,p).then(()=>{this.throwIfDestroyed();const g=this.createMediaKeySessionContext({keySystem:d,mediaKeys:p,decryptdata:n}),v="cenc";return this.generateRequestWithPreferredKeySession(g,v,n.pssh,"playlist-key")}))),u.catch(d=>this.handleError(d))),u}throwIfDestroyed(t="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(t){!this.hls||(this.error(t.message),t instanceof Dn?this.hls.trigger(A.ERROR,t.data):this.hls.trigger(A.ERROR,{type:M.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_NO_KEYS,error:t,fatal:!0}))}getKeySystemForKeyPromise(t){const n=this.getKeyIdString(t),a=this.keyIdToKeySessionPromise[n];if(!a){const l=Tt(t.keyFormat),u=l?[l]:Ei(this.config);return this.attemptKeySystemAccess(u)}return a}getKeySystemSelectionPromise(t){if(t.length||(t=Ei(this.config)),t.length===0)throw new Dn({type:M.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(t)}_onMediaEncrypted(t){const{initDataType:n,initData:a}=t;if(this.debug(`"${t.type}" event: init data type: "${n}"`),a===null)return;let l,u;if(n==="sinf"&&this.config.drmSystems[nt.FAIRPLAY]){const b=mi(new Uint8Array(a));try{const L=Ve(JSON.parse(b).sinf),B=Yr(new Uint8Array(L));if(!B)return;l=B.subarray(8,24),u=nt.FAIRPLAY}catch(L){this.warn('Failed to parse sinf "encrypted" event message initData');return}}else{const b=Fn(a);if(b===null)return;b.version===0&&b.systemId===Gt.WIDEVINE&&b.data&&(l=b.data.subarray(8,24)),u=hi(b.systemId)}if(!u||!l)return;const d=Lt.hexDump(l),{keyIdToKeySessionPromise:p,mediaKeySessions:g}=this;let v=p[d];for(let b=0;b<g.length;b++){const L=g[b],B=L.decryptdata;if(B.pssh||!B.keyId)continue;const W=Lt.hexDump(B.keyId);if(d===W||B.uri.replace(/-/g,"").indexOf(d)!==-1){v=p[W],delete p[W],B.pssh=new Uint8Array(a),B.keyId=l,v=p[d]=v.then(()=>this.generateRequestWithPreferredKeySession(L,n,a,"encrypted-event-key-match"));break}}v||(v=p[d]=this.getKeySystemSelectionPromise([u]).then(({keySystem:b,mediaKeys:L})=>{var B;this.throwIfDestroyed();const W=new Xi("ISO-23001-7",d,(B=ai(b))!=null?B:"");return W.pssh=new Uint8Array(a),W.keyId=l,this.attemptSetMediaKeys(b,L).then(()=>{this.throwIfDestroyed();const K=this.createMediaKeySessionContext({decryptdata:W,keySystem:b,mediaKeys:L});return this.generateRequestWithPreferredKeySession(K,n,a,"encrypted-event-no-match")})})),v.catch(b=>this.handleError(b))}_onWaitingForKey(t){this.log(`"${t.type}" event`)}attemptSetMediaKeys(t,n){const a=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${t}"`);const l=Promise.all(a).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(n)});return this.setMediaKeysQueue.push(l),l.then(()=>{this.log(`Media-keys set for "${t}"`),a.push(l),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(u=>a.indexOf(u)===-1)})}generateRequestWithPreferredKeySession(t,n,a,l){var u,d;const p=(u=this.config.drmSystems)==null||(d=u[t.keySystem])==null?void 0:d.generateRequest;if(p)try{const K=p.call(this.hls,n,a,t);if(!K)throw new Error("Invalid response from configured generateRequest filter");n=K.initDataType,a=t.decryptdata.pssh=K.initData?new Uint8Array(K.initData):null}catch(K){var g;if(this.warn(K.message),(g=this.hls)!=null&&g.config.debug)throw K}if(a===null)return this.log(`Skipping key-session request for "${l}" (no initData)`),Promise.resolve(t);const v=this.getKeyIdString(t.decryptdata);this.log(`Generating key-session request for "${l}": ${v} (init data type: ${n} length: ${a?a.byteLength:null})`);const b=new nl,L=t._onmessage=K=>{const ee=t.mediaKeysSession;if(!ee){b.emit("error",new Error("invalid state"));return}const{messageType:re,message:xe}=K;this.log(`"${re}" message event for session "${ee.sessionId}" message size: ${xe.byteLength}`),re==="license-request"||re==="license-renewal"?this.renewLicense(t,xe).catch(Fe=>{this.handleError(Fe),b.emit("error",Fe)}):re==="license-release"?t.keySystem===nt.FAIRPLAY&&(this.updateKeySession(t,It("acknowledged")),this.removeSession(t)):this.warn(`unhandled media key message type "${re}"`)},B=t._onkeystatuseschange=K=>{if(!t.mediaKeysSession){b.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(t);const re=t.keyStatus;b.emit("keyStatus",re),re==="expired"&&(this.warn(`${t.keySystem} expired for key ${v}`),this.renewKeySession(t))};t.mediaKeysSession.addEventListener("message",L),t.mediaKeysSession.addEventListener("keystatuseschange",B);const W=new Promise((K,ee)=>{b.on("error",ee),b.on("keyStatus",re=>{re.startsWith("usable")?K():re==="output-restricted"?ee(new Dn({type:M.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):re==="internal-error"?ee(new Dn({type:M.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${re}"`)):re==="expired"?ee(new Error("key expired while generating request")):this.warn(`unhandled key status change "${re}"`)})});return t.mediaKeysSession.generateRequest(n,a).then(()=>{var K;this.log(`Request generated for key-session "${(K=t.mediaKeysSession)==null?void 0:K.sessionId}" keyId: ${v}`)}).catch(K=>{throw new Dn({type:M.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_NO_SESSION,error:K,fatal:!1},`Error generating key-session request: ${K}`)}).then(()=>W).catch(K=>{throw b.removeAllListeners(),this.removeSession(t),K}).then(()=>(b.removeAllListeners(),t))}onKeyStatusChange(t){t.mediaKeysSession.keyStatuses.forEach((n,a)=>{this.log(`key status change "${n}" for keyStatuses keyId: ${Lt.hexDump("buffer"in a?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):new Uint8Array(a))} session keyId: ${Lt.hexDump(new Uint8Array(t.decryptdata.keyId||[]))} uri: ${t.decryptdata.uri}`),t.keyStatus=n})}fetchServerCertificate(t){const n=this.config,a=n.loader,l=new a(n),u=this.getServerCertificateUrl(t);return u?(this.log(`Fetching server certificate for "${t}"`),new Promise((d,p)=>{const g={responseType:"arraybuffer",url:u},v=n.certLoadPolicy.default,b={loadPolicy:v,timeout:v.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},L={onSuccess:(B,W,K,ee)=>{d(B.data)},onError:(B,W,K,ee)=>{p(new Dn({type:M.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:K,response:ze({url:g.url,data:void 0},B)},`"${t}" certificate request failed (${u}). Status: ${B.code} (${B.text})`))},onTimeout:(B,W,K)=>{p(new Dn({type:M.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:K,response:{url:g.url,data:void 0}},`"${t}" certificate request timed out (${u})`))},onAbort:(B,W,K)=>{p(new Error("aborted"))}};l.load(g,b,L)})):Promise.resolve()}setMediaKeysServerCertificate(t,n,a){return new Promise((l,u)=>{t.setServerCertificate(a).then(d=>{this.log(`setServerCertificate ${d?"success":"not supported by CDM"} (${a==null?void 0:a.byteLength}) on "${n}"`),l(t)}).catch(d=>{u(new Dn({type:M.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:d,fatal:!0},d.message))})})}renewLicense(t,n){return this.requestLicense(t,new Uint8Array(n)).then(a=>this.updateKeySession(t,new Uint8Array(a)).catch(l=>{throw new Dn({type:M.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:l,fatal:!0},l.message)}))}unpackPlayReadyKeyMessage(t,n){const a=String.fromCharCode.apply(null,new Uint16Array(n.buffer));if(!a.includes("PlayReadyKeyMessage"))return t.setRequestHeader("Content-Type","text/xml; charset=utf-8"),n;const l=new DOMParser().parseFromString(a,"application/xml"),u=l.querySelectorAll("HttpHeader");if(u.length>0){let b;for(let L=0,B=u.length;L<B;L++){var d,p;b=u[L];const W=(d=b.querySelector("name"))==null?void 0:d.textContent,K=(p=b.querySelector("value"))==null?void 0:p.textContent;W&&K&&t.setRequestHeader(W,K)}}const g=l.querySelector("Challenge"),v=g==null?void 0:g.textContent;if(!v)throw new Error("Cannot find <Challenge> in key message");return It(atob(v))}setupLicenseXHR(t,n,a,l){const u=this.config.licenseXhrSetup;return u?Promise.resolve().then(()=>{if(!a.decryptdata)throw new Error("Key removed");return u.call(this.hls,t,n,a,l)}).catch(d=>{if(!a.decryptdata)throw d;return t.open("POST",n,!0),u.call(this.hls,t,n,a,l)}).then(d=>(t.readyState||t.open("POST",n,!0),{xhr:t,licenseChallenge:d||l})):(t.open("POST",n,!0),Promise.resolve({xhr:t,licenseChallenge:l}))}requestLicense(t,n){const a=this.config.keyLoadPolicy.default;return new Promise((l,u)=>{const d=this.getLicenseServerUrl(t.keySystem);this.log(`Sending license request to URL: ${d}`);const p=new XMLHttpRequest;p.responseType="arraybuffer",p.onreadystatechange=()=>{if(!this.hls||!t.mediaKeysSession)return u(new Error("invalid state"));if(p.readyState===4)if(p.status===200){this._requestLicenseFailureCount=0;let g=p.response;this.log(`License received ${g instanceof ArrayBuffer?g.byteLength:g}`);const v=this.config.licenseResponseCallback;if(v)try{g=v.call(this.hls,p,d,t)}catch(b){this.error(b)}l(g)}else{const g=a.errorRetry,v=g?g.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>v||p.status>=400&&p.status<500)u(new Dn({type:M.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:p,response:{url:d,data:void 0,code:p.status,text:p.statusText}},`License Request XHR failed (${d}). Status: ${p.status} (${p.statusText})`));else{const b=v-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${b} attempts left`),this.requestLicense(t,n).then(l,u)}}},t.licenseXhr&&t.licenseXhr.readyState!==XMLHttpRequest.DONE&&t.licenseXhr.abort(),t.licenseXhr=p,this.setupLicenseXHR(p,d,t,n).then(({xhr:g,licenseChallenge:v})=>{t.keySystem==nt.PLAYREADY&&(v=this.unpackPlayReadyKeyMessage(g,v)),g.send(v)})})}onMediaAttached(t,n){if(!this.config.emeEnabled)return;const a=n.media;this.media=a,a.addEventListener("encrypted",this.onMediaEncrypted),a.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const t=this.media,n=this.mediaKeySessions;t&&(t.removeEventListener("encrypted",this.onMediaEncrypted),t.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},Xi.clearKeyUriToKeyIdMap();const a=n.length;Ls.CDMCleanupPromise=Promise.all(n.map(l=>this.removeSession(l)).concat(t==null?void 0:t.setMediaKeys(null).catch(l=>{this.log(`Could not clear media keys: ${l}`)}))).then(()=>{a&&(this.log("finished closing key sessions and clearing media keys"),n.length=0)}).catch(l=>{this.log(`Could not close sessions and clear media keys: ${l}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(t,{sessionKeys:n}){if(!(!n||!this.config.emeEnabled)&&!this.keyFormatPromise){const a=n.reduce((l,u)=>(l.indexOf(u.keyFormat)===-1&&l.push(u.keyFormat),l),[]);this.log(`Selecting key-system from session-keys ${a.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(a)}}removeSession(t){const{mediaKeysSession:n,licenseXhr:a}=t;if(n){this.log(`Remove licenses and keys and close session ${n.sessionId}`),t._onmessage&&(n.removeEventListener("message",t._onmessage),t._onmessage=void 0),t._onkeystatuseschange&&(n.removeEventListener("keystatuseschange",t._onkeystatuseschange),t._onkeystatuseschange=void 0),a&&a.readyState!==XMLHttpRequest.DONE&&a.abort(),t.mediaKeysSession=t.decryptdata=t.licenseXhr=void 0;const l=this.mediaKeySessions.indexOf(t);return l>-1&&this.mediaKeySessions.splice(l,1),n.remove().catch(u=>{this.log(`Could not remove session: ${u}`)}).then(()=>n.close()).catch(u=>{this.log(`Could not close session: ${u}`)})}}}Ls.CDMCleanupPromise=void 0;class Dn extends Error{constructor(t,n){super(n);this.data=void 0,t.error||(t.error=new Error(n)),this.data=t,t.err=t.error}}var bn;(function(h){h.MANIFEST="m",h.AUDIO="a",h.VIDEO="v",h.MUXED="av",h.INIT="i",h.CAPTION="c",h.TIMED_TEXT="tt",h.KEY="k",h.OTHER="o"})(bn||(bn={}));var uu;(function(h){h.DASH="d",h.HLS="h",h.SMOOTH="s",h.OTHER="o"})(uu||(uu={}));var ia;(function(h){h.OBJECT="CMCD-Object",h.REQUEST="CMCD-Request",h.SESSION="CMCD-Session",h.STATUS="CMCD-Status"})(ia||(ia={}));const kn={[ia.OBJECT]:["br","d","ot","tb"],[ia.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[ia.SESSION]:["cid","pr","sf","sid","st","v"],[ia.STATUS]:["bs","rtp"]};class na{constructor(t,n){this.value=void 0,this.params=void 0,Array.isArray(t)&&(t=t.map(a=>a instanceof na?a:new na(a))),this.value=t,this.params=n}}class xd{constructor(t){this.description=void 0,this.description=t}}const Ed="Dict";function Fa(h){return Array.isArray(h)?JSON.stringify(h):h instanceof Map?"Map{}":h instanceof Set?"Set{}":typeof h=="object"?JSON.stringify(h):String(h)}function du(h,t,n,a){return new Error(`failed to ${h} "${Fa(t)}" as ${n}`,{cause:a})}const pl="Bare Item",Kc="Boolean",cu="Byte Sequence",Yc="Decimal",Td="Integer";function fo(h){return h<-999999999999999||999999999999999<h}const Xc=/[\x00-\x1f\x7f]+/,hu="Token",fu="Key";function qr(h,t,n){return du("serialize",h,t,n)}function Qc(h){if(typeof h!="boolean")throw qr(h,Kc);return h?"?1":"?0"}function pu(h){return btoa(String.fromCharCode(...h))}function Sd(h){if(ArrayBuffer.isView(h)===!1)throw qr(h,cu);return`:${pu(h)}:`}function po(h){if(fo(h))throw qr(h,Td);return h.toString()}function Cd(h){return`@${po(h.getTime()/1e3)}`}function ml(h,t){if(h<0)return-ml(-h,t);const n=Math.pow(10,t);if(Math.abs(h*n%1-.5)<Number.EPSILON){const l=Math.floor(h*n);return(l%2==0?l:l+1)/n}else return Math.round(h*n)/n}function wd(h){const t=ml(h,3);if(Math.floor(Math.abs(t)).toString().length>12)throw qr(h,Yc);const n=t.toString();return n.includes(".")?n:`${n}.0`}const Ld="String";function Dd(h){if(Xc.test(h))throw qr(h,Ld);return`"${h.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function Jc(h){return h.description||h.toString().slice(7,-1)}function kd(h){const t=Jc(h);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(t)===!1)throw qr(t,hu);return t}function mu(h){switch(typeof h){case"number":if(!te(h))throw qr(h,pl);return Number.isInteger(h)?po(h):wd(h);case"string":return Dd(h);case"symbol":return kd(h);case"boolean":return Qc(h);case"object":if(h instanceof Date)return Cd(h);if(h instanceof Uint8Array)return Sd(h);if(h instanceof xd)return kd(h);default:throw qr(h,pl)}}function gl(h){if(/^[a-z*][a-z0-9\-_.*]*$/.test(h)===!1)throw qr(h,fu);return h}function Na(h){return h==null?"":Object.entries(h).map(([t,n])=>n===!0?`;${gl(t)}`:`;${gl(t)}=${mu(n)}`).join("")}function gu(h){return h instanceof na?`${mu(h.value)}${Na(h.params)}`:mu(h)}function Zc(h){return`(${h.value.map(gu).join(" ")})${Na(h.params)}`}function Id(h,t={whitespace:!0}){if(typeof h!="object")throw qr(h,Ed);const n=h instanceof Map?h.entries():Object.entries(h),a=t!=null&&t.whitespace?" ":"";return Array.from(n).map(([l,u])=>{u instanceof na||(u=new na(u));let d=gl(l);return u.value===!0?d+=Na(u.params):(d+="=",Array.isArray(u.value)?d+=Zc(u):d+=gu(u)),d}).join(`,${a}`)}function Rd(h,t){return Id(h,t)}const Pd=h=>h==="ot"||h==="sf"||h==="st",Od=h=>typeof h=="number"?te(h):h!=null&&h!==""&&h!==!1;function Bd(h,t){const n=new URL(h),a=new URL(t);if(n.origin!==a.origin)return h;const l=n.pathname.split("/").slice(1),u=a.pathname.split("/").slice(1,-1);for(;l[0]===u[0];)l.shift(),u.shift();for(;u.length;)u.shift(),l.unshift("..");return l.join("/")}function yu(){try{return crypto.randomUUID()}catch(h){try{const t=URL.createObjectURL(new Blob),n=t.toString();return URL.revokeObjectURL(t),n.slice(n.lastIndexOf("/")+1)}catch(t){let n=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,l=>{const u=(n+Math.random()*16)%16|0;return n=Math.floor(n/16),(l=="x"?u:u&3|8).toString(16)})}}}const Ua=h=>Math.round(h),mo=(h,t)=>(t!=null&&t.baseUrl&&(h=Bd(h,t.baseUrl)),encodeURIComponent(h)),Ds=h=>Ua(h/100)*100,Md={br:Ua,d:Ua,bl:Ds,dl:Ds,mtp:Ds,nor:mo,rtp:Ds,tb:Ua};function ja(h,t){const n={};if(h==null||typeof h!="object")return n;const a=Object.keys(h).sort(),l=se({},Md,t==null?void 0:t.formatters),u=t==null?void 0:t.filter;return a.forEach(d=>{if(u!=null&&u(d))return;let p=h[d];const g=l[d];g&&(p=g(p,t)),!(d==="v"&&p===1)&&(d=="pr"&&p===1||!Od(p)||(Pd(d)&&typeof p=="string"&&(p=new xd(p)),n[d]=p))}),n}function vu(h,t={}){return h?Rd(ja(h,t),se({whitespace:!1},t)):""}function Au(h,t={}){if(!h)return{};const n=Object.entries(h),a=Object.entries(kn).concat(Object.entries((t==null?void 0:t.customHeaderMap)||{})),l=n.reduce((u,d)=>{var p,g;const[v,b]=d,L=((p=a.find(B=>B[1].includes(v)))==null?void 0:p[0])||ia.REQUEST;return(g=u[L])!=null||(u[L]={}),u[L][v]=b,u},{});return Object.entries(l).reduce((u,[d,p])=>(u[d]=vu(p,t),u),{})}function _u(h,t,n){return se(h,Au(t,n))}const bu="CMCD";function xu(h,t={}){if(!h)return"";const n=vu(h,t);return`${bu}=${encodeURIComponent(n)}`}const yl=/CMCD=[^&#]+/;function Fd(h,t,n){const a=xu(t,n);if(!a)return h;if(yl.test(h))return h.replace(yl,a);const l=h.includes("?")?"&":"?";return`${h}${l}${a}`}class Eu{constructor(t){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=l=>{try{this.apply(l,{ot:bn.MANIFEST,su:!this.initialized})}catch(u){C.warn("Could not generate manifest CMCD data.",u)}},this.applyFragmentData=l=>{try{const u=l.frag,d=this.hls.levels[u.level],p=this.getObjectType(u),g={d:u.duration*1e3,ot:p};(p===bn.VIDEO||p===bn.AUDIO||p==bn.MUXED)&&(g.br=d.bitrate/1e3,g.tb=this.getTopBandwidth(p)/1e3,g.bl=this.getBufferLength(p)),this.apply(l,g)}catch(u){C.warn("Could not generate segment CMCD data.",u)}},this.hls=t;const n=this.config=t.config,{cmcd:a}=n;a!=null&&(n.pLoader=this.createPlaylistLoader(),n.fLoader=this.createFragmentLoader(),this.sid=a.sessionId||yu(),this.cid=a.contentId,this.useHeaders=a.useHeaders===!0,this.includeKeys=a.includeKeys,this.registerListeners())}registerListeners(){const t=this.hls;t.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(A.MEDIA_DETACHED,this.onMediaDetached,this),t.on(A.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const t=this.hls;t.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(A.MEDIA_DETACHED,this.onMediaDetached,this),t.off(A.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=null}onMediaAttached(t,n){this.media=n.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){!this.media||(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(t,n){var a,l;this.audioBuffer=(a=n.tracks.audio)==null?void 0:a.buffer,this.videoBuffer=(l=n.tracks.video)==null?void 0:l.buffer}createData(){var t;return{v:1,sf:uu.HLS,sid:this.sid,cid:this.cid,pr:(t=this.media)==null?void 0:t.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(t,n={}){se(n,this.createData());const a=n.ot===bn.INIT||n.ot===bn.VIDEO||n.ot===bn.MUXED;this.starved&&a&&(n.bs=!0,n.su=!0,this.starved=!1),n.su==null&&(n.su=this.buffering);const{includeKeys:l}=this;l&&(n=Object.keys(n).reduce((u,d)=>(l.includes(d)&&(u[d]=n[d]),u),{})),this.useHeaders?(t.headers||(t.headers={}),_u(t.headers,n)):t.url=Fd(t.url,n)}getObjectType(t){const{type:n}=t;if(n==="subtitle")return bn.TIMED_TEXT;if(t.sn==="initSegment")return bn.INIT;if(n==="audio")return bn.AUDIO;if(n==="main")return this.hls.audioTracks.length?bn.VIDEO:bn.MUXED}getTopBandwidth(t){let n=0,a;const l=this.hls;if(t===bn.AUDIO)a=l.audioTracks;else{const u=l.maxAutoLevel,d=u>-1?u+1:l.levels.length;a=l.levels.slice(0,d)}for(const u of a)u.bitrate>n&&(n=u.bitrate);return n>0?n:NaN}getBufferLength(t){const n=this.hls.media,a=t===bn.AUDIO?this.audioBuffer:this.videoBuffer;return!a||!n?NaN:oi.bufferInfo(a,n.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:t}=this.config,n=this.applyPlaylistData,a=t||this.config.loader;return class{constructor(u){this.loader=void 0,this.loader=new a(u)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(u,d,p){n(u),this.loader.load(u,d,p)}}}createFragmentLoader(){const{fLoader:t}=this.config,n=this.applyFragmentData,a=t||this.config.loader;return class{constructor(u){this.loader=void 0,this.loader=new a(u)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(u,d,p){n(u),this.loader.load(u,d,p)}}}}const Nd=3e5;class Ud{constructor(t){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=t,this.log=C.log.bind(C,"[content-steering]:"),this.registerListeners()}registerListeners(){const t=this.hls;t.on(A.MANIFEST_LOADING,this.onManifestLoading,this),t.on(A.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(A.MANIFEST_PARSED,this.onManifestParsed,this),t.on(A.ERROR,this.onError,this)}unregisterListeners(){const t=this.hls;!t||(t.off(A.MANIFEST_LOADING,this.onManifestLoading,this),t.off(A.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(A.MANIFEST_PARSED,this.onManifestParsed,this),t.off(A.ERROR,this.onError,this))}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const t=this.timeToLoad*1e3-(performance.now()-this.updated);if(t>0){this.scheduleRefresh(this.uri,t);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(t){const n=this.levels;n&&(this.levels=n.filter(a=>a!==t))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(t,n){const{contentSteering:a}=n;a!==null&&(this.pathwayId=a.pathwayId,this.uri=a.uri,this.started&&this.startLoad())}onManifestParsed(t,n){this.audioTracks=n.audioTracks,this.subtitleTracks=n.subtitleTracks}onError(t,n){const{errorAction:a}=n;if((a==null?void 0:a.action)===Ji.SendAlternateToPenaltyBox&&a.flags===Yn.MoveAllAlternatesMatchingHost){const l=this.levels;let u=this.pathwayPriority,d=this.pathwayId;if(n.context){const{groupId:p,pathwayId:g,type:v}=n.context;p&&l?d=this.getPathwayForGroupId(p,v,d):g&&(d=g)}d in this.penalizedPathways||(this.penalizedPathways[d]=performance.now()),!u&&l&&(u=l.reduce((p,g)=>(p.indexOf(g.pathwayId)===-1&&p.push(g.pathwayId),p),[])),u&&u.length>1&&(this.updatePathwayPriority(u),a.resolved=this.pathwayId!==d),a.resolved||C.warn(`Could not resolve ${n.details} ("${n.error.message}") with content-steering for Pathway: ${d} levels: ${l&&l.length} priorities: ${JSON.stringify(u)} penalized: ${JSON.stringify(this.penalizedPathways)}`)}}filterParsedLevels(t){this.levels=t;let n=this.getLevelsForPathway(this.pathwayId);if(n.length===0){const a=t[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${a}"`),n=this.getLevelsForPathway(a),this.pathwayId=a}return n.length!==t.length?(this.log(`Found ${n.length}/${t.length} levels in Pathway "${this.pathwayId}"`),n):t}getLevelsForPathway(t){return this.levels===null?[]:this.levels.filter(n=>t===n.pathwayId)}updatePathwayPriority(t){this.pathwayPriority=t;let n;const a=this.penalizedPathways,l=performance.now();Object.keys(a).forEach(u=>{l-a[u]>Nd&&delete a[u]});for(let u=0;u<t.length;u++){const d=t[u];if(d in a)continue;if(d===this.pathwayId)return;const p=this.hls.nextLoadLevel,g=this.hls.levels[p];if(n=this.getLevelsForPathway(d),n.length>0){this.log(`Setting Pathway to "${d}"`),this.pathwayId=d,$o(n),this.hls.trigger(A.LEVELS_UPDATED,{levels:n});const v=this.hls.levels[p];g&&v&&this.levels&&(v.attrs["STABLE-VARIANT-ID"]!==g.attrs["STABLE-VARIANT-ID"]&&v.bitrate!==g.bitrate&&this.log(`Unstable Pathways change from bitrate ${g.bitrate} to ${v.bitrate}`),this.hls.nextLoadLevel=p);break}}}getPathwayForGroupId(t,n,a){const l=this.getLevelsForPathway(a).concat(this.levels||[]);for(let u=0;u<l.length;u++)if(n===fi.AUDIO_TRACK&&l[u].hasAudioGroup(t)||n===fi.SUBTITLE_TRACK&&l[u].hasSubtitleGroup(t))return l[u].pathwayId;return a}clonePathways(t){const n=this.levels;if(!n)return;const a={},l={};t.forEach(u=>{const{ID:d,"BASE-ID":p,"URI-REPLACEMENT":g}=u;if(n.some(b=>b.pathwayId===d))return;const v=this.getLevelsForPathway(p).map(b=>{const L=new ue(b.attrs);L["PATHWAY-ID"]=d;const B=L.AUDIO&&`${L.AUDIO}_clone_${d}`,W=L.SUBTITLES&&`${L.SUBTITLES}_clone_${d}`;B&&(a[L.AUDIO]=B,L.AUDIO=B),W&&(l[L.SUBTITLES]=W,L.SUBTITLES=W);const K=Tu(b.uri,L["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",g),ee=new or({attrs:L,audioCodec:b.audioCodec,bitrate:b.bitrate,height:b.height,name:b.name,url:K,videoCodec:b.videoCodec,width:b.width});if(b.audioGroups)for(let re=1;re<b.audioGroups.length;re++)ee.addGroupId("audio",`${b.audioGroups[re]}_clone_${d}`);if(b.subtitleGroups)for(let re=1;re<b.subtitleGroups.length;re++)ee.addGroupId("text",`${b.subtitleGroups[re]}_clone_${d}`);return ee});n.push(...v),vl(this.audioTracks,a,g,d),vl(this.subtitleTracks,l,g,d)})}loadSteeringManifest(t){const n=this.hls.config,a=n.loader;this.loader&&this.loader.destroy(),this.loader=new a(n);let l;try{l=new self.URL(t)}catch(b){this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${t}`);return}if(l.protocol!=="data:"){const b=(this.hls.bandwidthEstimate||n.abrEwmaDefaultEstimate)|0;l.searchParams.set("_HLS_pathway",this.pathwayId),l.searchParams.set("_HLS_throughput",""+b)}const u={responseType:"json",url:l.href},d=n.steeringManifestLoadPolicy.default,p=d.errorRetry||d.timeoutRetry||{},g={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:p.maxNumRetry||0,retryDelay:p.retryDelayMs||0,maxRetryDelay:p.maxRetryDelayMs||0},v={onSuccess:(b,L,B,W)=>{this.log(`Loaded steering manifest: "${l}"`);const K=b.data;if(K.VERSION!==1){this.log(`Steering VERSION ${K.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=K.TTL;const{"RELOAD-URI":ee,"PATHWAY-CLONES":re,"PATHWAY-PRIORITY":xe}=K;if(ee)try{this.uri=new self.URL(ee,l).href}catch(Me){this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${ee}`);return}this.scheduleRefresh(this.uri||B.url),re&&this.clonePathways(re);const Fe={steeringManifest:K,url:l.toString()};this.hls.trigger(A.STEERING_MANIFEST_LOADED,Fe),xe&&this.updatePathwayPriority(xe)},onError:(b,L,B,W)=>{if(this.log(`Error loading steering manifest: ${b.code} ${b.text} (${L.url})`),this.stopLoad(),b.code===410){this.enabled=!1,this.log(`Steering manifest ${L.url} no longer available`);return}let K=this.timeToLoad*1e3;if(b.code===429){const ee=this.loader;if(typeof(ee==null?void 0:ee.getResponseHeader)=="function"){const re=ee.getResponseHeader("Retry-After");re&&(K=parseFloat(re)*1e3)}this.log(`Steering manifest ${L.url} rate limited`);return}this.scheduleRefresh(this.uri||L.url,K)},onTimeout:(b,L,B)=>{this.log(`Timeout loading steering manifest (${L.url})`),this.scheduleRefresh(this.uri||L.url)}};this.log(`Requesting steering manifest: ${l}`),this.loader.load(u,g,v)}scheduleRefresh(t,n=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var a;const l=(a=this.hls)==null?void 0:a.media;if(l&&!l.ended){this.loadSteeringManifest(t);return}this.scheduleRefresh(t,this.timeToLoad*1e3)},n)}}function vl(h,t,n,a){!h||Object.keys(t).forEach(l=>{const u=h.filter(d=>d.groupId===l).map(d=>{const p=se({},d);return p.details=void 0,p.attrs=new ue(p.attrs),p.url=p.attrs.URI=Tu(d.url,d.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",n),p.groupId=p.attrs["GROUP-ID"]=t[l],p.attrs["PATHWAY-ID"]=a,p});h.push(...u)})}function Tu(h,t,n,a){const{HOST:l,PARAMS:u,[n]:d}=a;let p;t&&(p=d==null?void 0:d[t],p&&(h=p));const g=new self.URL(h);return l&&!p&&(g.host=l),u&&Object.keys(u).sort().forEach(v=>{v&&g.searchParams.set(v,u[v])}),g.href}const jd=/^age:\s*[\d.]+\s*$/im;class $d{constructor(t){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=t&&t.xhrSetup||null,this.stats=new ce,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const t=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),t&&(t.onreadystatechange=null,t.onprogress=null,t.readyState!==4&&(this.stats.aborted=!0,t.abort()))}abort(){var t;this.abortInternal(),(t=this.callbacks)!=null&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(t,n,a){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=t,this.config=n,this.callbacks=a,this.loadInternal()}loadInternal(){const{config:t,context:n}=this;if(!t||!n)return;const a=this.loader=new self.XMLHttpRequest,l=this.stats;l.loading.first=0,l.loaded=0,l.aborted=!1;const u=this.xhrSetup;u?Promise.resolve().then(()=>{if(!(this.loader!==a||this.stats.aborted))return u(a,n.url)}).catch(d=>{if(!(this.loader!==a||this.stats.aborted))return a.open("GET",n.url,!0),u(a,n.url)}).then(()=>{this.loader!==a||this.stats.aborted||this.openAndSendXhr(a,n,t)}).catch(d=>{this.callbacks.onError({code:a.status,text:d.message},n,a,l)}):this.openAndSendXhr(a,n,t)}openAndSendXhr(t,n,a){t.readyState||t.open("GET",n.url,!0);const l=n.headers,{maxTimeToFirstByteMs:u,maxLoadTimeMs:d}=a.loadPolicy;if(l)for(const p in l)t.setRequestHeader(p,l[p]);n.rangeEnd&&t.setRequestHeader("Range","bytes="+n.rangeStart+"-"+(n.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=n.responseType,self.clearTimeout(this.requestTimeout),a.timeout=u&&te(u)?u:d,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),a.timeout),t.send()}readystatechange(){const{context:t,loader:n,stats:a}=this;if(!t||!n)return;const l=n.readyState,u=this.config;if(!a.aborted&&l>=2&&(a.loading.first===0&&(a.loading.first=Math.max(self.performance.now(),a.loading.start),u.timeout!==u.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),u.timeout=u.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),u.loadPolicy.maxLoadTimeMs-(a.loading.first-a.loading.start)))),l===4)){self.clearTimeout(this.requestTimeout),n.onreadystatechange=null,n.onprogress=null;const d=n.status,p=n.responseType!=="text";if(d>=200&&d<300&&(p&&n.response||n.responseText!==null)){a.loading.end=Math.max(self.performance.now(),a.loading.first);const g=p?n.response:n.responseText,v=n.responseType==="arraybuffer"?g.byteLength:g.length;if(a.loaded=a.total=v,a.bwEstimate=a.total*8e3/(a.loading.end-a.loading.first),!this.callbacks)return;const b=this.callbacks.onProgress;if(b&&b(a,t,g,n),!this.callbacks)return;const L={url:n.responseURL,data:g,code:d};this.callbacks.onSuccess(L,a,t,n)}else{const g=u.loadPolicy.errorRetry,v=a.retry,b={url:t.url,data:void 0,code:d};qs(g,v,!1,b)?this.retry(g):(C.error(`${d} while loading ${t.url}`),this.callbacks.onError({code:d,text:n.statusText},t,n,a))}}}loadtimeout(){if(!this.config)return;const t=this.config.loadPolicy.timeoutRetry,n=this.stats.retry;if(qs(t,n,!0))this.retry(t);else{var a;C.warn(`timeout while loading ${(a=this.context)==null?void 0:a.url}`);const l=this.callbacks;l&&(this.abortInternal(),l.onTimeout(this.stats,this.context,this.loader))}}retry(t){const{context:n,stats:a}=this;this.retryDelay=_a(t,a.retry),a.retry++,C.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${n==null?void 0:n.url}, retrying ${a.retry}/${t.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(t){const n=this.stats;n.loaded=t.loaded,t.lengthComputable&&(n.total=t.total)}getCacheAge(){let t=null;if(this.loader&&jd.test(this.loader.getAllResponseHeaders())){const n=this.loader.getResponseHeader("age");t=n?parseFloat(n):null}return t}getResponseHeader(t){return this.loader&&new RegExp(`^${t}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(t):null}}function Vd(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(h){}return!1}const Hd=/(\d+)-(\d+)\/(\d+)/;class Su{constructor(t){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=t.fetchSetup||zd,this.controller=new self.AbortController,this.stats=new ce}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var t;this.abortInternal(),(t=this.callbacks)!=null&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(t,n,a){const l=this.stats;if(l.loading.start)throw new Error("Loader can only be used once.");l.loading.start=self.performance.now();const u=ra(t,this.controller.signal),d=a.onProgress,p=t.responseType==="arraybuffer",g=p?"byteLength":"length",{maxTimeToFirstByteMs:v,maxLoadTimeMs:b}=n.loadPolicy;this.context=t,this.config=n,this.callbacks=a,this.request=this.fetchSetup(t,u),self.clearTimeout(this.requestTimeout),n.timeout=v&&te(v)?v:b,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),a.onTimeout(l,t,this.response)},n.timeout),self.fetch(this.request).then(L=>{this.response=this.loader=L;const B=Math.max(self.performance.now(),l.loading.start);if(self.clearTimeout(this.requestTimeout),n.timeout=b,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),a.onTimeout(l,t,this.response)},b-(B-l.loading.start)),!L.ok){const{status:W,statusText:K}=L;throw new Cu(K||"fetch, bad network response",W,L)}return l.loading.first=B,l.total=qd(L.headers)||l.total,d&&te(n.highWaterMark)?this.loadProgressively(L,l,t,n.highWaterMark,d):p?L.arrayBuffer():t.responseType==="json"?L.json():L.text()}).then(L=>{const B=this.response;if(!B)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),l.loading.end=Math.max(self.performance.now(),l.loading.first);const W=L[g];W&&(l.loaded=l.total=W);const K={url:B.url,data:L,code:B.status};d&&!te(n.highWaterMark)&&d(l,t,L,B),a.onSuccess(K,l,t,B)}).catch(L=>{if(self.clearTimeout(this.requestTimeout),l.aborted)return;const B=L&&L.code||0,W=L?L.message:null;a.onError({code:B,text:W},t,L?L.details:null,l)})}getCacheAge(){let t=null;if(this.response){const n=this.response.headers.get("age");t=n?parseFloat(n):null}return t}getResponseHeader(t){return this.response?this.response.headers.get(t):null}loadProgressively(t,n,a,l=0,u){const d=new ts,p=t.body.getReader(),g=()=>p.read().then(v=>{if(v.done)return d.dataLength&&u(n,a,d.flush(),t),Promise.resolve(new ArrayBuffer(0));const b=v.value,L=b.length;return n.loaded+=L,L<l||d.dataLength?(d.push(b),d.dataLength>=l&&u(n,a,d.flush(),t)):u(n,a,b,t),g()}).catch(()=>Promise.reject());return g()}}function ra(h,t){const n={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(se({},h.headers))};return h.rangeEnd&&n.headers.set("Range","bytes="+h.rangeStart+"-"+String(h.rangeEnd-1)),n}function Gd(h){const t=Hd.exec(h);if(t)return parseInt(t[2])-parseInt(t[1])+1}function qd(h){const t=h.get("Content-Range");if(t){const a=Gd(t);if(te(a))return a}const n=h.get("Content-Length");if(n)return parseInt(n)}function zd(h,t){return new self.Request(h.url,t)}class Cu extends Error{constructor(t,n,a){super(t);this.code=void 0,this.details=void 0,this.code=n,this.details=a}}const Wd=/\s/,Kd={newCue(h,t,n,a){const l=[];let u,d,p,g,v;const b=self.VTTCue||self.TextTrackCue;for(let B=0;B<a.rows.length;B++)if(u=a.rows[B],p=!0,g=0,v="",!u.isEmpty()){var L;for(let ee=0;ee<u.chars.length;ee++)Wd.test(u.chars[ee].uchar)&&p?g++:(v+=u.chars[ee].uchar,p=!1);u.cueStartTime=t,t===n&&(n+=1e-4),g>=16?g--:g++;const W=co(v.trim()),K=ru(t,n,W);h!=null&&(L=h.cues)!=null&&L.getCueById(K)||(d=new b(t,n,W),d.id=K,d.line=B+1,d.align="left",d.position=10+Math.min(80,Math.floor(g*8/32)*10),l.push(d))}return h&&l.length&&(l.sort((B,W)=>B.line==="auto"||W.line==="auto"?0:B.line>8&&W.line>8?W.line-B.line:B.line-W.line),l.forEach(B=>Ka(h,B))),l}},Yd={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},wu=ze(ze({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:Infinity,frontBufferFlushThreshold:Infinity,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:Infinity,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:$d,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:lr,bufferController:Jl,capLevelController:zn,errorController:Qr,fpsController:bd,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:Ai,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,useMediaCapabilities:!0,certLoadPolicy:{default:Yd},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:Infinity,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},Xd()),{},{subtitleStreamController:Gr,subtitleTrackController:Jh,timelineController:vd,audioStreamController:ld,audioTrackController:Wi,emeController:Ls,cmcdController:Eu,contentSteeringController:Ud});function Xd(){return{cueHandler:Kd,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function Qd(h,t){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(t.liveMaxLatencyDurationCount!==void 0&&(t.liveSyncDurationCount===void 0||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(t.liveMaxLatencyDuration!==void 0&&(t.liveSyncDuration===void 0||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const n=Al(h),a=["manifest","level","frag"],l=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return a.forEach(u=>{const d=`${u==="level"?"playlist":u}LoadPolicy`,p=t[d]===void 0,g=[];l.forEach(v=>{const b=`${u}Loading${v}`,L=t[b];if(L!==void 0&&p){g.push(b);const B=n[d].default;switch(t[d]={default:B},v){case"TimeOut":B.maxLoadTimeMs=L,B.maxTimeToFirstByteMs=L;break;case"MaxRetry":B.errorRetry.maxNumRetry=L,B.timeoutRetry.maxNumRetry=L;break;case"RetryDelay":B.errorRetry.retryDelayMs=L,B.timeoutRetry.retryDelayMs=L;break;case"MaxRetryTimeout":B.errorRetry.maxRetryDelayMs=L,B.timeoutRetry.maxRetryDelayMs=L;break}}}),g.length&&C.warn(`hls.js config: "${g.join('", "')}" setting(s) are deprecated, use "${d}": ${JSON.stringify(t[d])}`)}),ze(ze({},n),t)}function Al(h){return h&&typeof h=="object"?Array.isArray(h)?h.map(Al):Object.keys(h).reduce((t,n)=>(t[n]=Al(h[n]),t),{}):h}function Jd(h){const t=h.loader;t!==Su&&t!==$d?(C.log("[config]: Custom loader detected, cannot enable progressive streaming"),h.progressive=!1):Vd()&&(h.loader=Su,h.progressive=!0,h.enableSoftwareAES=!0,C.log("[config]: Progressive streaming enabled, using FetchLoader"))}let go;class Lu extends vr{constructor(t,n){super(t,"[level-controller]");this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=n,this._registerListeners()}_registerListeners(){const{hls:t}=this;t.on(A.MANIFEST_LOADING,this.onManifestLoading,this),t.on(A.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(A.LEVEL_LOADED,this.onLevelLoaded,this),t.on(A.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(A.FRAG_BUFFERED,this.onFragBuffered,this),t.on(A.ERROR,this.onError,this)}_unregisterListeners(){const{hls:t}=this;t.off(A.MANIFEST_LOADING,this.onManifestLoading,this),t.off(A.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(A.LEVEL_LOADED,this.onLevelLoaded,this),t.off(A.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(A.FRAG_BUFFERED,this.onFragBuffered,this),t.off(A.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(n=>{n.loadError=0,n.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(t,n){this.resetLevels()}onManifestLoaded(t,n){const a=this.hls.config.preferManagedMediaSource,l=[],u={},d={};let p=!1,g=!1,v=!1;n.levels.forEach(b=>{var L,B;const W=b.attrs;let{audioCodec:K,videoCodec:ee}=b;((L=K)==null?void 0:L.indexOf("mp4a.40.34"))!==-1&&(go||(go=/chrome|firefox/i.test(navigator.userAgent)),go&&(b.audioCodec=K=void 0)),K&&(b.audioCodec=K=ps(K,a)),((B=ee)==null?void 0:B.indexOf("avc1"))===0&&(ee=b.videoCodec=za(ee));const{width:re,height:xe,unknownCodecs:Fe}=b;if(p||(p=!!(re&&xe)),g||(g=!!ee),v||(v=!!K),Fe!=null&&Fe.length||K&&!ha(K,"audio",a)||ee&&!ha(ee,"video",a))return;const{CODECS:Me,"FRAME-RATE":it,"HDCP-LEVEL":$e,"PATHWAY-ID":ut,RESOLUTION:Qe,"VIDEO-RANGE":yt}=W,ot=`${`${ut||"."}-`}${b.bitrate}-${Qe}-${it}-${Me}-${yt}-${$e}`;if(u[ot])if(u[ot].uri!==b.url&&!b.attrs["PATHWAY-ID"]){const At=d[ot]+=1;b.attrs["PATHWAY-ID"]=new Array(At+1).join(".");const Re=new or(b);u[ot]=Re,l.push(Re)}else u[ot].addGroupId("audio",W.AUDIO),u[ot].addGroupId("text",W.SUBTITLES);else{const At=new or(b);u[ot]=At,d[ot]=1,l.push(At)}}),this.filterAndSortMediaOptions(l,n,p,g,v)}filterAndSortMediaOptions(t,n,a,l,u){let d=[],p=[],g=t;if((a||l)&&u&&(g=g.filter(({videoCodec:K,videoRange:ee,width:re,height:xe})=>(!!K||!!(re&&xe))&&Ja(ee))),g.length===0){Promise.resolve().then(()=>{if(this.hls){n.levels.length&&this.warn(`One or more CODECS in variant not supported: ${JSON.stringify(n.levels[0].attrs)}`);const K=new Error("no level with compatible codecs found in manifest");this.hls.trigger(A.ERROR,{type:M.MEDIA_ERROR,details:k.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:n.url,error:K,reason:K.message})}});return}if(n.audioTracks){const{preferManagedMediaSource:K}=this.hls.config;d=n.audioTracks.filter(ee=>!ee.audioCodec||ha(ee.audioCodec,"audio",K)),Du(d)}n.subtitles&&(p=n.subtitles,Du(p));const v=g.slice(0);g.sort((K,ee)=>{if(K.attrs["HDCP-LEVEL"]!==ee.attrs["HDCP-LEVEL"])return(K.attrs["HDCP-LEVEL"]||"")>(ee.attrs["HDCP-LEVEL"]||"")?1:-1;if(a&&K.height!==ee.height)return K.height-ee.height;if(K.frameRate!==ee.frameRate)return K.frameRate-ee.frameRate;if(K.videoRange!==ee.videoRange)return ya.indexOf(K.videoRange)-ya.indexOf(ee.videoRange);if(K.videoCodec!==ee.videoCodec){const re=fa(K.videoCodec),xe=fa(ee.videoCodec);if(re!==xe)return xe-re}if(K.uri===ee.uri&&K.codecSet!==ee.codecSet){const re=Us(K.codecSet),xe=Us(ee.codecSet);if(re!==xe)return xe-re}return K.averageBitrate!==ee.averageBitrate?K.averageBitrate-ee.averageBitrate:0});let b=v[0];if(this.steering&&(g=this.steering.filterParsedLevels(g),g.length!==v.length)){for(let K=0;K<v.length;K++)if(v[K].pathwayId===g[0].pathwayId){b=v[K];break}}this._levels=g;for(let K=0;K<g.length;K++)if(g[K]===b){var L;this._firstLevel=K;const ee=b.bitrate,re=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${g.length} level(s) found, first bitrate: ${ee}`),((L=this.hls.userConfig)==null?void 0:L.abrEwmaDefaultEstimate)===void 0){const xe=Math.min(ee,this.hls.config.abrEwmaDefaultEstimateMax);xe>re&&re===wu.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=xe)}break}const B=u&&!l,W={levels:g,audioTracks:d,subtitleTracks:p,sessionData:n.sessionData,sessionKeys:n.sessionKeys,firstLevel:this._firstLevel,stats:n.stats,audio:u,video:l,altAudio:!B&&d.some(K=>!!K.url)};this.hls.trigger(A.MANIFEST_PARSED,W),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return this._levels.length===0?null:this._levels}get level(){return this.currentLevelIndex}set level(t){const n=this._levels;if(n.length===0)return;if(t<0||t>=n.length){const b=new Error("invalid level idx"),L=t<0;if(this.hls.trigger(A.ERROR,{type:M.OTHER_ERROR,details:k.LEVEL_SWITCH_ERROR,level:t,fatal:L,error:b,reason:b.message}),L)return;t=Math.min(t,n.length-1)}const a=this.currentLevelIndex,l=this.currentLevel,u=l?l.attrs["PATHWAY-ID"]:void 0,d=n[t],p=d.attrs["PATHWAY-ID"];if(this.currentLevelIndex=t,this.currentLevel=d,a===t&&d.details&&l&&u===p)return;this.log(`Switching to level ${t} (${d.height?d.height+"p ":""}${d.videoRange?d.videoRange+" ":""}${d.codecSet?d.codecSet+" ":""}@${d.bitrate})${p?" with Pathway "+p:""} from level ${a}${u?" with Pathway "+u:""}`);const g={level:t,attrs:d.attrs,details:d.details,bitrate:d.bitrate,averageBitrate:d.averageBitrate,maxBitrate:d.maxBitrate,realBitrate:d.realBitrate,width:d.width,height:d.height,codecSet:d.codecSet,audioCodec:d.audioCodec,videoCodec:d.videoCodec,audioGroups:d.audioGroups,subtitleGroups:d.subtitleGroups,loaded:d.loaded,loadError:d.loadError,fragmentError:d.fragmentError,name:d.name,id:d.id,uri:d.uri,url:d.url,urlId:0,audioGroupIds:d.audioGroupIds,textGroupIds:d.textGroupIds};this.hls.trigger(A.LEVEL_SWITCHING,g);const v=d.details;if(!v||v.live){const b=this.switchParams(d.uri,l==null?void 0:l.details,v);this.loadPlaylist(b)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(t){this.manualLevelIndex=t,this._startLevel===void 0&&(this._startLevel=t),t!==-1&&(this.level=t)}get firstLevel(){return this._firstLevel}set firstLevel(t){this._firstLevel=t}get startLevel(){if(this._startLevel===void 0){const t=this.hls.config.startLevel;return t!==void 0?t:this.hls.firstAutoLevel}return this._startLevel}set startLevel(t){this._startLevel=t}onError(t,n){n.fatal||!n.context||n.context.type===fi.LEVEL&&n.context.level===this.level&&this.checkRetry(n)}onFragBuffered(t,{frag:n}){if(n!==void 0&&n.type===qt.MAIN){const a=n.elementaryStreams;if(!Object.keys(a).some(u=>!!a[u]))return;const l=this._levels[n.level];l!=null&&l.loadError&&(this.log(`Resetting level error count of ${l.loadError} on frag buffered`),l.loadError=0)}}onLevelLoaded(t,n){var a;const{level:l,details:u}=n,d=this._levels[l];if(!d){var p;this.warn(`Invalid level index ${l}`),(p=n.deliveryDirectives)!=null&&p.skip&&(u.deltaUpdateFailed=!0);return}l===this.currentLevelIndex?(d.fragmentError===0&&(d.loadError=0),this.playlistLoaded(l,n,d.details)):(a=n.deliveryDirectives)!=null&&a.skip&&(u.deltaUpdateFailed=!0)}loadPlaylist(t){super.loadPlaylist();const n=this.currentLevelIndex,a=this.currentLevel;if(a&&this.shouldLoadPlaylist(a)){let l=a.uri;if(t)try{l=t.addDirectives(l)}catch(d){this.warn(`Could not construct new URL with HLS Delivery Directives: ${d}`)}const u=a.attrs["PATHWAY-ID"];this.log(`Loading level index ${n}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""} with${u?" Pathway "+u:""} ${l}`),this.clearTimer(),this.hls.trigger(A.LEVEL_LOADING,{url:l,level:n,pathwayId:a.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(t){this.level=t,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=t)}removeLevel(t){var n;const a=this._levels.filter((l,u)=>u!==t?!0:(this.steering&&this.steering.removeLevel(l),l===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,l.details&&l.details.fragments.forEach(d=>d.level=-1)),!1));$o(a),this._levels=a,this.currentLevelIndex>-1&&(n=this.currentLevel)!=null&&n.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.hls.trigger(A.LEVELS_UPDATED,{levels:a})}onLevelsUpdated(t,{levels:n}){this._levels=n}checkMaxAutoUpdated(){const{autoLevelCapping:t,maxAutoLevel:n,maxHdcpLevel:a}=this.hls;this._maxAutoLevel!==n&&(this._maxAutoLevel=n,this.hls.trigger(A.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:t,levels:this.levels,maxAutoLevel:n,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:a}))}}function Du(h){const t={};h.forEach(n=>{const a=n.groupId||"";n.id=t[a]=t[a]||0,t[a]++})}class ks{constructor(t){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=t}abort(t){for(const a in this.keyUriToKeyInfo){const l=this.keyUriToKeyInfo[a].loader;if(l){var n;if(t&&t!==((n=l.context)==null?void 0:n.frag.type))return;l.abort()}}}detach(){for(const t in this.keyUriToKeyInfo){const n=this.keyUriToKeyInfo[t];(n.mediaKeySessionContext||n.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[t]}}destroy(){this.detach();for(const t in this.keyUriToKeyInfo){const n=this.keyUriToKeyInfo[t].loader;n&&n.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(t,n=k.KEY_LOAD_ERROR,a,l,u){return new gn({type:M.NETWORK_ERROR,details:n,fatal:!1,frag:t,response:u,error:a,networkDetails:l})}loadClear(t,n){if(this.emeController&&this.config.emeEnabled){const{sn:a,cc:l}=t;for(let u=0;u<n.length;u++){const d=n[u];if(l<=d.cc&&(a==="initSegment"||d.sn==="initSegment"||a<d.sn)){this.emeController.selectKeySystemFormat(d).then(p=>{d.setKeyFormat(p)});break}}}}load(t){return!t.decryptdata&&t.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(t).then(n=>this.loadInternal(t,n)):this.loadInternal(t)}loadInternal(t,n){var a,l;n&&t.setKeyFormat(n);const u=t.decryptdata;if(!u){const v=new Error(n?`Expected frag.decryptdata to be defined after setting format ${n}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(t,k.KEY_LOAD_ERROR,v))}const d=u.uri;if(!d)return Promise.reject(this.createKeyLoadError(t,k.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${d}"`)));let p=this.keyUriToKeyInfo[d];if((a=p)!=null&&a.decryptdata.key)return u.key=p.decryptdata.key,Promise.resolve({frag:t,keyInfo:p});if((l=p)!=null&&l.keyLoadPromise){var g;switch((g=p.mediaKeySessionContext)==null?void 0:g.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return p.keyLoadPromise.then(v=>(u.key=v.keyInfo.decryptdata.key,{frag:t,keyInfo:p}))}}switch(p=this.keyUriToKeyInfo[d]={decryptdata:u,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},u.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return u.keyFormat==="identity"?this.loadKeyHTTP(p,t):this.loadKeyEME(p,t);case"AES-128":return this.loadKeyHTTP(p,t);default:return Promise.reject(this.createKeyLoadError(t,k.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${u.method}"`)))}}loadKeyEME(t,n){const a={frag:n,keyInfo:t};if(this.emeController&&this.config.emeEnabled){const l=this.emeController.loadKey(a);if(l)return(t.keyLoadPromise=l.then(u=>(t.mediaKeySessionContext=u,a))).catch(u=>{throw t.keyLoadPromise=null,u})}return Promise.resolve(a)}loadKeyHTTP(t,n){const a=this.config,l=a.loader,u=new l(a);return n.keyLoader=t.loader=u,t.keyLoadPromise=new Promise((d,p)=>{const g={keyInfo:t,frag:n,responseType:"arraybuffer",url:t.decryptdata.uri},v=a.keyLoadPolicy.default,b={loadPolicy:v,timeout:v.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},L={onSuccess:(B,W,K,ee)=>{const{frag:re,keyInfo:xe,url:Fe}=K;if(!re.decryptdata||xe!==this.keyUriToKeyInfo[Fe])return p(this.createKeyLoadError(re,k.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),ee));xe.decryptdata.key=re.decryptdata.key=new Uint8Array(B.data),re.keyLoader=null,xe.loader=null,d({frag:re,keyInfo:xe})},onError:(B,W,K,ee)=>{this.resetLoader(W),p(this.createKeyLoadError(n,k.KEY_LOAD_ERROR,new Error(`HTTP Error ${B.code} loading key ${B.text}`),K,ze({url:g.url,data:void 0},B)))},onTimeout:(B,W,K)=>{this.resetLoader(W),p(this.createKeyLoadError(n,k.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),K))},onAbort:(B,W,K)=>{this.resetLoader(W),p(this.createKeyLoadError(n,k.INTERNAL_ABORTED,new Error("key loading aborted"),K))}};u.load(g,b,L)})}resetLoader(t){const{frag:n,keyInfo:a,url:l}=t,u=a.loader;n.keyLoader===u&&(n.keyLoader=null,a.loader=null),delete this.keyUriToKeyInfo[l],u&&u.destroy()}}function ku(){return self.SourceBuffer||self.WebKitSourceBuffer}function Zd(){if(!ar())return!1;const t=ku();return!t||t.prototype&&typeof t.prototype.appendBuffer=="function"&&typeof t.prototype.remove=="function"}function eh(){if(!Zd())return!1;const h=ar();return typeof(h==null?void 0:h.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(t=>h.isTypeSupported(Rr(t,"video")))||["mp4a.40.2","fLaC"].some(t=>h.isTypeSupported(Rr(t,"audio"))))}function th(){var h;const t=ku();return typeof(t==null||(h=t.prototype)==null?void 0:h.changeType)=="function"}const ih=250,_l=2,nh=.1,rh=.05;class sh{constructor(t,n,a,l){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=t,this.media=n,this.fragmentTracker=a,this.hls=l}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(t,n){const{config:a,media:l,stalled:u}=this;if(l===null)return;const{currentTime:d,seeking:p}=l,g=this.seeking&&!p,v=!this.seeking&&p;if(this.seeking=p,d!==t){if(this.moved=!0,p||(this.nudgeRetry=0),u!==null){if(this.stallReported){const re=self.performance.now()-u;C.warn(`playback not stuck anymore @${d}, after ${Math.round(re)}ms`),this.stallReported=!1}this.stalled=null}return}if(v||g){this.stalled=null;return}if(l.paused&&!p||l.ended||l.playbackRate===0||!oi.getBuffered(l).length){this.nudgeRetry=0;return}const b=oi.bufferInfo(l,d,0),L=b.nextStart||0;if(p){const re=b.len>_l,xe=!L||n&&n.start<=d||L-d>_l&&!this.fragmentTracker.getPartialFragment(d);if(re||xe)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var B;if(!(b.len>0)&&!L)return;const xe=Math.max(L,b.start||0)-d,Fe=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,it=(Fe==null||(B=Fe.details)==null?void 0:B.live)?Fe.details.targetduration*2:_l,$e=this.fragmentTracker.getPartialFragment(d);if(xe>0&&(xe<=it||$e)){l.paused||this._trySkipBufferHole($e);return}}const W=self.performance.now();if(u===null){this.stalled=W;return}const K=W-u;if(!p&&K>=ih&&(this._reportStall(b),!this.media))return;const ee=oi.bufferInfo(l,d,a.maxBufferHole);this._tryFixBufferStall(ee,K)}_tryFixBufferStall(t,n){const{config:a,fragmentTracker:l,media:u}=this;if(u===null)return;const d=u.currentTime,p=l.getPartialFragment(d);p&&(this._trySkipBufferHole(p)||!this.media)||(t.len>a.maxBufferHole||t.nextStart&&t.nextStart-d<a.maxBufferHole)&&n>a.highBufferWatchdogPeriod*1e3&&(C.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(t){const{hls:n,media:a,stallReported:l}=this;if(!l&&a){this.stallReported=!0;const u=new Error(`Playback stalling at @${a.currentTime} due to low buffer (${JSON.stringify(t)})`);C.warn(u.message),n.trigger(A.ERROR,{type:M.MEDIA_ERROR,details:k.BUFFER_STALLED_ERROR,fatal:!1,error:u,buffer:t.len})}}_trySkipBufferHole(t){const{config:n,hls:a,media:l}=this;if(l===null)return 0;const u=l.currentTime,d=oi.bufferInfo(l,u,0),p=u<d.start?d.start:d.nextStart;if(p){const g=d.len<=n.maxBufferHole,v=d.len>0&&d.len<1&&l.readyState<3,b=p-u;if(b>0&&(g||v)){if(b>n.maxBufferHole){const{fragmentTracker:B}=this;let W=!1;if(u===0){const K=B.getAppendedFrag(0,qt.MAIN);K&&p<K.end&&(W=!0)}if(!W){const K=t||B.getAppendedFrag(u,qt.MAIN);if(K){let ee=!1,re=K.end;for(;re<p;){const xe=B.getPartialFragment(re);if(xe)re+=xe.duration;else{ee=!0;break}}if(ee)return 0}}}const L=Math.max(p+rh,u+nh);if(C.warn(`skipping hole, adjusting currentTime from ${u} to ${L}`),this.moved=!0,this.stalled=null,l.currentTime=L,t&&!t.gap){const B=new Error(`fragment loaded with buffer holes, seeking from ${u} to ${L}`);a.trigger(A.ERROR,{type:M.MEDIA_ERROR,details:k.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:B,reason:B.message,frag:t})}return L}}return 0}_tryNudgeBuffer(){const{config:t,hls:n,media:a,nudgeRetry:l}=this;if(a===null)return;const u=a.currentTime;if(this.nudgeRetry++,l<t.nudgeMaxRetry){const d=u+(l+1)*t.nudgeOffset,p=new Error(`Nudging 'currentTime' from ${u} to ${d}`);C.warn(p.message),a.currentTime=d,n.trigger(A.ERROR,{type:M.MEDIA_ERROR,details:k.BUFFER_NUDGE_ON_STALL,error:p,fatal:!1})}else{const d=new Error(`Playhead still not moving while enough data buffered @${u} after ${t.nudgeMaxRetry} nudges`);C.error(d.message),n.trigger(A.ERROR,{type:M.MEDIA_ERROR,details:k.BUFFER_STALLED_ERROR,error:d,fatal:!0})}}}const ah=100;class Iu extends jr{constructor(t,n,a){super(t,n,a,"[stream-controller]",qt.MAIN);this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:t}=this;t.on(A.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(A.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(A.MANIFEST_LOADING,this.onManifestLoading,this),t.on(A.MANIFEST_PARSED,this.onManifestParsed,this),t.on(A.LEVEL_LOADING,this.onLevelLoading,this),t.on(A.LEVEL_LOADED,this.onLevelLoaded,this),t.on(A.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.on(A.ERROR,this.onError,this),t.on(A.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.on(A.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.on(A.BUFFER_CREATED,this.onBufferCreated,this),t.on(A.BUFFER_FLUSHED,this.onBufferFlushed,this),t.on(A.LEVELS_UPDATED,this.onLevelsUpdated,this),t.on(A.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:t}=this;t.off(A.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(A.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(A.MANIFEST_LOADING,this.onManifestLoading,this),t.off(A.MANIFEST_PARSED,this.onManifestParsed,this),t.off(A.LEVEL_LOADED,this.onLevelLoaded,this),t.off(A.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),t.off(A.ERROR,this.onError,this),t.off(A.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),t.off(A.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),t.off(A.BUFFER_CREATED,this.onBufferCreated,this),t.off(A.BUFFER_FLUSHED,this.onBufferFlushed,this),t.off(A.LEVELS_UPDATED,this.onLevelsUpdated,this),t.off(A.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying()}startLoad(t){if(this.levels){const{lastCurrentTime:n,hls:a}=this;if(this.stopLoad(),this.setInterval(ah),this.level=-1,!this.startFragRequested){let l=a.startLevel;l===-1&&(a.config.testBandwidth&&this.levels.length>1?(l=0,this.bitrateTest=!0):l=a.firstAutoLevel),a.nextLoadLevel=l,this.level=a.loadLevel,this.loadedmetadata=!1}n>0&&t===-1&&(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),t=n),this.state=st.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}else this._forceStartLoad=!0,this.state=st.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case st.WAITING_LEVEL:{const{levels:n,level:a}=this,l=n==null?void 0:n[a],u=l==null?void 0:l.details;if(u&&(!u.live||this.levelLastLoaded===l)){if(this.waitForCdnTuneIn(u))break;this.state=st.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=st.IDLE;break}break}case st.FRAG_LOADING_WAITING_RETRY:{var t;const n=self.performance.now(),a=this.retryDate;if(!a||n>=a||(t=this.media)!=null&&t.seeking){const{levels:l,level:u}=this,d=l==null?void 0:l[u];this.resetStartWhenNotLoaded(d||null),this.state=st.IDLE}}break}this.state===st.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:t,levelLastLoaded:n,levels:a,media:l}=this;if(n===null||!l&&(this.startFragRequested||!t.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const u=t.nextLoadLevel;if(!(a!=null&&a[u]))return;const d=a[u],p=this.getMainFwdBufferInfo();if(p===null)return;const g=this.getLevelDetails();if(g&&this._streamEnded(p,g)){const ee={};this.altAudio&&(ee.type="video"),this.hls.trigger(A.BUFFER_EOS,ee),this.state=st.ENDED;return}t.loadLevel!==u&&t.manualLevel===-1&&this.log(`Adapting to level ${u} from level ${this.level}`),this.level=t.nextLoadLevel=u;const v=d.details;if(!v||this.state===st.WAITING_LEVEL||v.live&&this.levelLastLoaded!==d){this.level=u,this.state=st.WAITING_LEVEL;return}const b=p.len,L=this.getMaxBufferLength(d.maxBitrate);if(b>=L)return;this.backtrackFragment&&this.backtrackFragment.start>p.end&&(this.backtrackFragment=null);const B=this.backtrackFragment?this.backtrackFragment.start:p.end;let W=this.getNextFragment(B,v);if(this.couldBacktrack&&!this.fragPrevious&&W&&W.sn!=="initSegment"&&this.fragmentTracker.getState(W)!==sn.OK){var K;const re=((K=this.backtrackFragment)!=null?K:W).sn-v.startSN,xe=v.fragments[re-1];xe&&W.cc===xe.cc&&(W=xe,this.fragmentTracker.removeFragment(xe))}else this.backtrackFragment&&p.len&&(this.backtrackFragment=null);if(W&&this.isLoopLoading(W,B)){if(!W.gap){const re=this.audioOnly&&!this.altAudio?be.AUDIO:be.VIDEO,xe=(re===be.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;xe&&this.afterBufferFlushed(xe,re,qt.MAIN)}W=this.getNextFragmentLoopLoading(W,v,p,qt.MAIN,L)}!W||(W.initSegment&&!W.initSegment.data&&!this.bitrateTest&&(W=W.initSegment),this.loadFragment(W,d,B))}loadFragment(t,n,a){const l=this.fragmentTracker.getState(t);this.fragCurrent=t,l===sn.NOT_LOADED||l===sn.PARTIAL?t.sn==="initSegment"?this._loadInitSegment(t,n):this.bitrateTest?(this.log(`Fragment ${t.sn} of level ${t.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(t,n)):(this.startFragRequested=!0,super.loadFragment(t,n,a)):this.clearTrackerIfNeeded(t)}getBufferedFrag(t){return this.fragmentTracker.getBufferedFrag(t,qt.MAIN)}followingBufferedFrag(t){return t?this.getBufferedFrag(t.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:t,media:n}=this;if(n!=null&&n.readyState){let a;const l=this.getAppendedFrag(n.currentTime);l&&l.start>1&&this.flushMainBuffer(0,l.start-1);const u=this.getLevelDetails();if(u!=null&&u.live){const p=this.getMainFwdBufferInfo();if(!p||p.len<u.targetduration*2)return}if(!n.paused&&t){const p=this.hls.nextLoadLevel,g=t[p],v=this.fragLastKbps;v&&this.fragCurrent?a=this.fragCurrent.duration*g.maxBitrate/(1e3*v)+1:a=0}else a=0;const d=this.getBufferedFrag(n.currentTime+a);if(d){const p=this.followingBufferedFrag(d);if(p){this.abortCurrentFrag();const g=p.maxStartPTS?p.maxStartPTS:p.start,v=p.duration,b=Math.max(d.end,g+Math.min(Math.max(v-this.config.maxFragLookUpTolerance,v*(this.couldBacktrack?.5:.125)),v*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(b,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const t=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,t&&(t.abortRequests(),this.fragmentTracker.removeFragment(t)),this.state){case st.KEY_LOADING:case st.FRAG_LOADING:case st.FRAG_LOADING_WAITING_RETRY:case st.PARSING:case st.PARSED:this.state=st.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(t,n){super.flushMainBuffer(t,n,this.altAudio?"video":null)}onMediaAttached(t,n){super.onMediaAttached(t,n);const a=n.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),a.addEventListener("playing",this.onvplaying),a.addEventListener("seeked",this.onvseeked),this.gapController=new sh(this.config,a,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:t}=this;t&&this.onvplaying&&this.onvseeked&&(t.removeEventListener("playing",this.onvplaying),t.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const t=this.media,n=t?t.currentTime:null;te(n)&&this.log(`Media seeked to ${n.toFixed(3)}`);const a=this.getMainFwdBufferInfo();if(a===null||a.len===0){this.warn(`Main forward buffer length on "seeked" event ${a?a.len:"empty"})`);return}this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(A.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=this.fragLastKbps=0,this.levels=this.fragPlaying=this.backtrackFragment=this.levelLastLoaded=null,this.altAudio=this.audioOnly=this.startFragRequested=!1}onManifestParsed(t,n){let a=!1,l=!1;n.levels.forEach(u=>{const d=u.audioCodec;d&&(a=a||d.indexOf("mp4a.40.2")!==-1,l=l||d.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=a&&l&&!th(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=n.levels,this.startFragRequested=!1}onLevelLoading(t,n){const{levels:a}=this;if(!a||this.state!==st.IDLE)return;const l=a[n.level];(!l.details||l.details.live&&this.levelLastLoaded!==l||this.waitForCdnTuneIn(l.details))&&(this.state=st.WAITING_LEVEL)}onLevelLoaded(t,n){var a;const{levels:l}=this,u=n.level,d=n.details,p=d.totalduration;if(!l){this.warn(`Levels were reset while loading level ${u}`);return}this.log(`Level ${u} loaded [${d.startSN},${d.endSN}]${d.lastPartSn?`[part-${d.lastPartSn}-${d.lastPartIndex}]`:""}, cc [${d.startCC}, ${d.endCC}] duration:${p}`);const g=l[u],v=this.fragCurrent;v&&(this.state===st.FRAG_LOADING||this.state===st.FRAG_LOADING_WAITING_RETRY)&&v.level!==n.level&&v.loader&&this.abortCurrentFrag();let b=0;if(d.live||(a=g.details)!=null&&a.live){var L;if(this.checkLiveUpdate(d),d.deltaUpdateFailed)return;b=this.alignPlaylists(d,g.details,(L=this.levelLastLoaded)==null?void 0:L.details)}if(g.details=d,this.levelLastLoaded=g,this.hls.trigger(A.LEVEL_UPDATED,{details:d,level:u}),this.state===st.WAITING_LEVEL){if(this.waitForCdnTuneIn(d))return;this.state=st.IDLE}this.startFragRequested?d.live&&this.synchronizeToLiveEdge(d):this.setStartPosition(d,b),this.tick()}_handleFragmentLoadProgress(t){var n;const{frag:a,part:l,payload:u}=t,{levels:d}=this;if(!d){this.warn(`Levels were reset while fragment load was in progress. Fragment ${a.sn} of level ${a.level} will not be buffered`);return}const p=d[a.level],g=p.details;if(!g){this.warn(`Dropping fragment ${a.sn} of level ${a.level} after level details were reset`),this.fragmentTracker.removeFragment(a);return}const v=p.videoCodec,b=g.PTSKnown||!g.live,L=(n=a.initSegment)==null?void 0:n.data,B=this._getAudioCodec(p),W=this.transmuxer=this.transmuxer||new rl(this.hls,qt.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),K=l?l.index:-1,ee=K!==-1,re=new Sa(a.level,a.sn,a.stats.chunkCount,u.byteLength,K,ee),xe=this.initPTS[a.cc];W.push(u,L,B,v,a,l,g.totalduration,b,re,xe)}onAudioTrackSwitching(t,n){const a=this.altAudio;if(!!!n.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const d=this.fragCurrent;d&&(this.log("Switching to main audio track, cancel main fragment load"),d.abortRequests(),this.fragmentTracker.removeFragment(d)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const u=this.hls;a&&(u.trigger(A.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),u.trigger(A.AUDIO_TRACK_SWITCHED,n)}}onAudioTrackSwitched(t,n){const a=n.id,l=!!this.hls.audioTracks[a].url;if(l){const u=this.videoBuffer;u&&this.mediaBuffer!==u&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=u)}this.altAudio=l,this.tick()}onBufferCreated(t,n){const a=n.tracks;let l,u,d=!1;for(const p in a){const g=a[p];if(g.id==="main"){if(u=p,l=g,p==="video"){const v=a[p];v&&(this.videoBuffer=v.buffer)}}else d=!0}d&&l?(this.log(`Alternate track found, use ${u}.buffered to schedule main fragment loading`),this.mediaBuffer=l.buffer):this.mediaBuffer=this.media}onFragBuffered(t,n){const{frag:a,part:l}=n;if(a&&a.type!==qt.MAIN)return;if(this.fragContextChanged(a)){this.warn(`Fragment ${a.sn}${l?" p: "+l.index:""} of level ${a.level} finished buffering, but was aborted. state: ${this.state}`),this.state===st.PARSED&&(this.state=st.IDLE);return}const u=l?l.stats:a.stats;this.fragLastKbps=Math.round(8*u.total/(u.buffering.end-u.loading.first)),a.sn!=="initSegment"&&(this.fragPrevious=a),this.fragBufferedComplete(a,l)}onError(t,n){var a;if(n.fatal){this.state=st.ERROR;return}switch(n.details){case k.FRAG_GAP:case k.FRAG_PARSING_ERROR:case k.FRAG_DECRYPT_ERROR:case k.FRAG_LOAD_ERROR:case k.FRAG_LOAD_TIMEOUT:case k.KEY_LOAD_ERROR:case k.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(qt.MAIN,n);break;case k.LEVEL_LOAD_ERROR:case k.LEVEL_LOAD_TIMEOUT:case k.LEVEL_PARSING_ERROR:!n.levelRetry&&this.state===st.WAITING_LEVEL&&((a=n.context)==null?void 0:a.type)===fi.LEVEL&&(this.state=st.IDLE);break;case k.BUFFER_APPEND_ERROR:case k.BUFFER_FULL_ERROR:if(!n.parent||n.parent!=="main")return;if(n.details===k.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(n)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case k.INTERNAL_EXCEPTION:this.recoverWorkerError(n);break}}checkBuffer(){const{media:t,gapController:n}=this;if(!(!t||!n||!t.readyState)){if(this.loadedmetadata||!oi.getBuffered(t).length){const a=this.state!==st.IDLE?this.fragCurrent:null;n.poll(this.lastCurrentTime,a)}this.lastCurrentTime=t.currentTime}}onFragLoadEmergencyAborted(){this.state=st.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(t,{type:n}){if(n!==be.AUDIO||this.audioOnly&&!this.altAudio){const a=(n===be.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(a,n,qt.MAIN),this.tick()}}onLevelsUpdated(t,n){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level),this.levels=n.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:t}=this;if(!t)return;const n=t.currentTime;let a=this.startPosition;if(a>=0&&n<a){if(t.seeking){this.log(`could not seek to ${a}, already seeking at ${n}`);return}const l=oi.getBuffered(t),d=(l.length?l.start(0):0)-a;d>0&&(d<this.config.maxBufferHole||d<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${d} to match buffer start`),a+=d,this.startPosition=a),this.log(`seek to target start position ${a} from current time ${n}`),t.currentTime=a}}_getAudioCodec(t){let n=this.config.defaultAudioCodec||t.audioCodec;return this.audioCodecSwap&&n&&(this.log("Swapping audio codec"),n.indexOf("mp4a.40.5")!==-1?n="mp4a.40.2":n="mp4a.40.5"),n}_loadBitrateTestFrag(t,n){t.bitrateTest=!0,this._doFragLoad(t,n).then(a=>{const{hls:l}=this;if(!a||this.fragContextChanged(t))return;n.fragmentError=0,this.state=st.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const u=t.stats;u.parsing.start=u.parsing.end=u.buffering.start=u.buffering.end=self.performance.now(),l.trigger(A.FRAG_LOADED,a),t.bitrateTest=!1})}_handleTransmuxComplete(t){var n;const a="main",{hls:l}=this,{remuxResult:u,chunkMeta:d}=t,p=this.getCurrentContext(d);if(!p){this.resetWhenMissingContext(d);return}const{frag:g,part:v,level:b}=p,{video:L,text:B,id3:W,initSegment:K}=u,{details:ee}=b,re=this.altAudio?void 0:u.audio;if(this.fragContextChanged(g)){this.fragmentTracker.removeFragment(g);return}if(this.state=st.PARSING,K){if(K!=null&&K.tracks){const Me=g.initSegment||g;this._bufferInitSegment(b,K.tracks,Me,d),l.trigger(A.FRAG_PARSING_INIT_SEGMENT,{frag:Me,id:a,tracks:K.tracks})}const xe=K.initPTS,Fe=K.timescale;te(xe)&&(this.initPTS[g.cc]={baseTime:xe,timescale:Fe},l.trigger(A.INIT_PTS_FOUND,{frag:g,id:a,initPTS:xe,timescale:Fe}))}if(L&&ee&&g.sn!=="initSegment"){const xe=ee.fragments[g.sn-1-ee.startSN],Fe=g.sn===ee.startSN,Me=!xe||g.cc>xe.cc;if(u.independent!==!1){const{startPTS:it,endPTS:$e,startDTS:ut,endDTS:Qe}=L;if(v)v.elementaryStreams[L.type]={startPTS:it,endPTS:$e,startDTS:ut,endDTS:Qe};else if(L.firstKeyFrame&&L.independent&&d.id===1&&!Me&&(this.couldBacktrack=!0),L.dropped&&L.independent){const yt=this.getMainFwdBufferInfo(),xt=(yt?yt.end:this.getLoadPosition())+this.config.maxBufferHole,ot=L.firstKeyFramePTS?L.firstKeyFramePTS:it;if(!Fe&&xt<ot-this.config.maxBufferHole&&!Me){this.backtrack(g);return}else Me&&(g.gap=!0);g.setElementaryStreamInfo(L.type,g.start,$e,g.start,Qe,!0)}else Fe&&it>_l&&(g.gap=!0);g.setElementaryStreamInfo(L.type,it,$e,ut,Qe),this.backtrackFragment&&(this.backtrackFragment=g),this.bufferFragmentData(L,g,v,d,Fe||Me)}else if(Fe||Me)g.gap=!0;else{this.backtrack(g);return}}if(re){const{startPTS:xe,endPTS:Fe,startDTS:Me,endDTS:it}=re;v&&(v.elementaryStreams[be.AUDIO]={startPTS:xe,endPTS:Fe,startDTS:Me,endDTS:it}),g.setElementaryStreamInfo(be.AUDIO,xe,Fe,Me,it),this.bufferFragmentData(re,g,v,d)}if(ee&&W!=null&&(n=W.samples)!=null&&n.length){const xe={id:a,frag:g,details:ee,samples:W.samples};l.trigger(A.FRAG_PARSING_METADATA,xe)}if(ee&&B){const xe={id:a,frag:g,details:ee,samples:B.samples};l.trigger(A.FRAG_PARSING_USERDATA,xe)}}_bufferInitSegment(t,n,a,l){if(this.state!==st.PARSING)return;this.audioOnly=!!n.audio&&!n.video,this.altAudio&&!this.audioOnly&&delete n.audio;const{audio:u,video:d,audiovideo:p}=n;if(u){let g=t.audioCodec;const v=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){g&&(g.indexOf("mp4a.40.5")!==-1?g="mp4a.40.2":g="mp4a.40.5");const b=u.metadata;b&&"channelCount"in b&&(b.channelCount||1)!==1&&v.indexOf("firefox")===-1&&(g="mp4a.40.5")}g&&g.indexOf("mp4a.40.5")!==-1&&v.indexOf("android")!==-1&&u.container!=="audio/mpeg"&&(g="mp4a.40.2",this.log(`Android: force audio codec to ${g}`)),t.audioCodec&&t.audioCodec!==g&&this.log(`Swapping manifest audio codec "${t.audioCodec}" for "${g}"`),u.levelCodec=g,u.id="main",this.log(`Init audio buffer, container:${u.container}, codecs[selected/level/parsed]=[${g||""}/${t.audioCodec||""}/${u.codec}]`)}d&&(d.levelCodec=t.videoCodec,d.id="main",this.log(`Init video buffer, container:${d.container}, codecs[level/parsed]=[${t.videoCodec||""}/${d.codec}]`)),p&&this.log(`Init audiovideo buffer, container:${p.container}, codecs[level/parsed]=[${t.codecs}/${p.codec}]`),this.hls.trigger(A.BUFFER_CODECS,n),Object.keys(n).forEach(g=>{const b=n[g].initSegment;b!=null&&b.byteLength&&this.hls.trigger(A.BUFFER_APPENDING,{type:g,data:b,frag:a,part:null,chunkMeta:l,parent:a.type})}),this.tickImmediate()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,qt.MAIN)}backtrack(t){this.couldBacktrack=!0,this.backtrackFragment=t,this.resetTransmuxer(),this.flushBufferGap(t),this.fragmentTracker.removeFragment(t),this.fragPrevious=null,this.nextLoadPosition=t.start,this.state=st.IDLE}checkFragmentChanged(){const t=this.media;let n=null;if(t&&t.readyState>1&&t.seeking===!1){const a=t.currentTime;if(oi.isBuffered(t,a)?n=this.getAppendedFrag(a):oi.isBuffered(t,a+.1)&&(n=this.getAppendedFrag(a+.1)),n){this.backtrackFragment=null;const l=this.fragPlaying,u=n.level;(!l||n.sn!==l.sn||l.level!==u)&&(this.fragPlaying=n,this.hls.trigger(A.FRAG_CHANGED,{frag:n}),(!l||l.level!==u)&&this.hls.trigger(A.LEVEL_SWITCHED,{level:u}))}}}get nextLevel(){const t=this.nextBufferedFrag;return t?t.level:-1}get currentFrag(){const t=this.media;return t?this.fragPlaying||this.getAppendedFrag(t.currentTime):null}get currentProgramDateTime(){const t=this.media;if(t){const n=t.currentTime,a=this.currentFrag;if(a&&te(n)&&te(a.programDateTime)){const l=a.programDateTime+(n-a.start)*1e3;return new Date(l)}}return null}get currentLevel(){const t=this.currentFrag;return t?t.level:-1}get nextBufferedFrag(){const t=this.currentFrag;return t?this.followingBufferedFrag(t):null}get forceStartLoad(){return this._forceStartLoad}}class sa{static get version(){return"1.5.14"}static isMSESupported(){return Zd()}static isSupported(){return eh()}static getMediaSource(){return ar()}static get Events(){return A}static get ErrorTypes(){return M}static get ErrorDetails(){return k}static get DefaultConfig(){return sa.defaultConfig?sa.defaultConfig:wu}static set DefaultConfig(t){sa.defaultConfig=t}constructor(t={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this.started=!1,this._emitter=new nl,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,this.triggeringException=void 0,H(t.debug||!1,"Hls instance");const n=this.config=Qd(sa.DefaultConfig,t);this.userConfig=t,n.progressive&&Jd(n);const{abrController:a,bufferController:l,capLevelController:u,errorController:d,fpsController:p}=n,g=new d(this),v=this.abrController=new a(this),b=this.bufferController=new l(this),L=this.capLevelController=new u(this),B=new p(this),W=new ys(this),K=new Ju(this),ee=n.contentSteeringController,re=ee?new ee(this):null,xe=this.levelController=new Lu(this,re),Fe=new Mr(this),Me=new ks(this.config),it=this.streamController=new Iu(this,Fe,Me);L.setStreamController(it),B.setStreamController(it);const $e=[W,xe,it];re&&$e.splice(1,0,re),this.networkControllers=$e;const ut=[v,b,L,B,K,Fe];this.audioTrackController=this.createController(n.audioTrackController,$e);const Qe=n.audioStreamController;Qe&&$e.push(new Qe(this,Fe,Me)),this.subtitleTrackController=this.createController(n.subtitleTrackController,$e);const yt=n.subtitleStreamController;yt&&$e.push(new yt(this,Fe,Me)),this.createController(n.timelineController,ut),Me.emeController=this.emeController=this.createController(n.emeController,ut),this.cmcdController=this.createController(n.cmcdController,ut),this.latencyController=this.createController(Zu,ut),this.coreComponents=ut,$e.push(g);const xt=g.onErrorOut;typeof xt=="function"&&this.on(A.ERROR,xt,g)}createController(t,n){if(t){const a=new t(this);return n&&n.push(a),a}return null}on(t,n,a=this){this._emitter.on(t,n,a)}once(t,n,a=this){this._emitter.once(t,n,a)}removeAllListeners(t){this._emitter.removeAllListeners(t)}off(t,n,a=this,l){this._emitter.off(t,n,a,l)}listeners(t){return this._emitter.listeners(t)}emit(t,n,a){return this._emitter.emit(t,n,a)}trigger(t,n){if(this.config.debug)return this.emit(t,t,n);try{return this.emit(t,t,n)}catch(a){if(C.error("An internal error happened while handling event "+t+'. Error message: "'+a.message+'". Here is a stacktrace:',a),!this.triggeringException){this.triggeringException=!0;const l=t===A.ERROR;this.trigger(A.ERROR,{type:M.OTHER_ERROR,details:k.INTERNAL_EXCEPTION,fatal:l,event:t,error:a}),this.triggeringException=!1}}return!1}listenerCount(t){return this._emitter.listenerCount(t)}destroy(){C.log("destroy"),this.trigger(A.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(n=>n.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(n=>n.destroy()),this.coreComponents.length=0;const t=this.config;t.xhrSetup=t.fetchSetup=void 0,this.userConfig=null}attachMedia(t){C.log("attachMedia"),this._media=t,this.trigger(A.MEDIA_ATTACHING,{media:t})}detachMedia(){C.log("detachMedia"),this.trigger(A.MEDIA_DETACHING,void 0),this._media=null}loadSource(t){this.stopLoad();const n=this.media,a=this.url,l=this.url=We.buildAbsoluteURL(self.location.href,t,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,C.log(`loadSource:${l}`),n&&a&&(a!==l||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(n)),this.trigger(A.MANIFEST_LOADING,{url:t})}startLoad(t=-1){C.log(`startLoad(${t})`),this.started=!0,this.networkControllers.forEach(n=>{n.startLoad(t)})}stopLoad(){C.log("stopLoad"),this.started=!1,this.networkControllers.forEach(t=>{t.stopLoad()})}resumeBuffering(){this.started&&this.networkControllers.forEach(t=>{"fragmentLoader"in t&&t.startLoad(-1)})}pauseBuffering(){this.networkControllers.forEach(t=>{"fragmentLoader"in t&&t.stopLoad()})}swapAudioCodec(){C.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){C.log("recoverMediaError");const t=this._media;this.detachMedia(),t&&this.attachMedia(t)}removeLevel(t){this.levelController.removeLevel(t)}get levels(){const t=this.levelController.levels;return t||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(t){C.log(`set currentLevel:${t}`),this.levelController.manualLevel=t,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(t){C.log(`set nextLevel:${t}`),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(t){C.log(`set loadLevel:${t}`),this.levelController.manualLevel=t}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(t){this.levelController.nextLoadLevel=t}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(t){C.log(`set firstLevel:${t}`),this.levelController.firstLevel=t}get startLevel(){const t=this.levelController.startLevel;return t===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:t}set startLevel(t){C.log(`set startLevel:${t}`),t!==-1&&(t=Math.max(t,this.minAutoLevel)),this.levelController.startLevel=t}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(t){const n=!!t;n!==this.config.capLevelToPlayerSize&&(n?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=n)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimate():NaN}set bandwidthEstimate(t){this.abrController.resetEstimator(t)}get ttfbEstimate(){const{bwEstimator:t}=this.abrController;return t?t.getEstimateTTFB():NaN}set autoLevelCapping(t){this._autoLevelCapping!==t&&(C.log(`set autoLevelCapping:${t}`),this._autoLevelCapping=t,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(t){Qa(t)&&this._maxHdcpLevel!==t&&(this._maxHdcpLevel=t,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:t,config:{minAutoBitrate:n}}=this;if(!t)return 0;const a=t.length;for(let l=0;l<a;l++)if(t[l].maxBitrate>=n)return l;return 0}get maxAutoLevel(){const{levels:t,autoLevelCapping:n,maxHdcpLevel:a}=this;let l;if(n===-1&&t!=null&&t.length?l=t.length-1:l=n,a)for(let u=l;u--;){const d=t[u].attrs["HDCP-LEVEL"];if(d&&d<=a)return u}return l}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(t){this.abrController.nextAutoLevel=t}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}setAudioOption(t){var n;return(n=this.audioTrackController)==null?void 0:n.setAudioOption(t)}setSubtitleOption(t){var n;return(n=this.subtitleTrackController)==null||n.setSubtitleOption(t),null}get allAudioTracks(){const t=this.audioTrackController;return t?t.allAudioTracks:[]}get audioTracks(){const t=this.audioTrackController;return t?t.audioTracks:[]}get audioTrack(){const t=this.audioTrackController;return t?t.audioTrack:-1}set audioTrack(t){const n=this.audioTrackController;n&&(n.audioTrack=t)}get allSubtitleTracks(){const t=this.subtitleTrackController;return t?t.allSubtitleTracks:[]}get subtitleTracks(){const t=this.subtitleTrackController;return t?t.subtitleTracks:[]}get subtitleTrack(){const t=this.subtitleTrackController;return t?t.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(t){const n=this.subtitleTrackController;n&&(n.subtitleTrack=t)}get subtitleDisplay(){const t=this.subtitleTrackController;return t?t.subtitleDisplay:!1}set subtitleDisplay(t){const n=this.subtitleTrackController;n&&(n.subtitleDisplay=t)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(t){this.config.lowLatencyMode=t}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}sa.defaultConfig=void 0},27376:function(Kt){Kt.exports=mt;var Ut=Object.prototype.toString;function mt(ct){if(!ct)return!1;var ne=Ut.call(ct);return ne==="[object Function]"||typeof ct=="function"&&ne!=="[object RegExp]"||typeof window!="undefined"&&(ct===window.setTimeout||ct===window.alert||ct===window.confirm||ct===window.prompt)}},84221:function(Kt,Ut,mt){var ct=mt(46894).getUint64,ne=function(We){var ve=new DataView(We.buffer,We.byteOffset,We.byteLength),ze={version:We[0],flags:new Uint8Array(We.subarray(1,4)),references:[],referenceId:ve.getUint32(4),timescale:ve.getUint32(8)},_e=12;ze.version===0?(ze.earliestPresentationTime=ve.getUint32(_e),ze.firstOffset=ve.getUint32(_e+4),_e+=8):(ze.earliestPresentationTime=ct(We.subarray(_e)),ze.firstOffset=ct(We.subarray(_e+8)),_e+=16),_e+=2;var we=ve.getUint16(_e);for(_e+=2;we>0;_e+=12,we--)ze.references.push({referenceType:(We[_e]&128)>>>7,referencedSize:ve.getUint32(_e)&2147483647,subsegmentDuration:ve.getUint32(_e+4),startsWithSap:!!(We[_e+8]&128),sapType:(We[_e+8]&112)>>>4,sapDeltaTime:ve.getUint32(_e+8)&268435455});return ze};Kt.exports=ne},51489:function(Kt){var Ut=9e4,mt,ct,ne,We,ve,ze,_e;mt=function(we){return we*Ut},ct=function(we,ye){return we*ye},ne=function(we){return we/Ut},We=function(we,ye){return we/ye},ve=function(we,ye){return mt(We(we,ye))},ze=function(we,ye){return ct(ne(we),ye)},_e=function(we,ye,se){return ne(se?we:we-ye)},Kt.exports={ONE_SECOND_IN_TS:Ut,secondsToVideoTs:mt,secondsToAudioTs:ct,videoTsToSeconds:ne,audioTsToSeconds:We,audioTsToVideoTs:ve,videoTsToAudioTs:ze,metadataTsToSeconds:_e}},46894:function(Kt){var Ut=Math.pow(2,32),mt=function(ct){var ne=new DataView(ct.buffer,ct.byteOffset,ct.byteLength),We;return ne.getBigUint64?(We=ne.getBigUint64(0),We<Number.MAX_SAFE_INTEGER?Number(We):We):ne.getUint32(0)*Ut+ne.getUint32(4)};Kt.exports={getUint64:mt,MAX_UINT32:Ut}},75974:function(Kt){Kt.exports=Ut;function Ut(mt,ct){var ne,We=null;try{ne=JSON.parse(mt,ct)}catch(ve){We=ve}return[We,ne]}},49945:function(Kt){(function(Ut){var mt=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,ct=/^(?=([^\/?#]*))\1([^]*)$/,ne=/(?:\/|^)\.(?=\/)/g,We=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,ve={buildAbsoluteURL:function(ze,_e,we){if(we=we||{},ze=ze.trim(),_e=_e.trim(),!_e){if(!we.alwaysNormalize)return ze;var ye=ve.parseURL(ze);if(!ye)throw new Error("Error trying to parse base URL.");return ye.path=ve.normalizePath(ye.path),ve.buildURLFromParts(ye)}var se=ve.parseURL(_e);if(!se)throw new Error("Error trying to parse relative URL.");if(se.scheme)return we.alwaysNormalize?(se.path=ve.normalizePath(se.path),ve.buildURLFromParts(se)):_e;var te=ve.parseURL(ze);if(!te)throw new Error("Error trying to parse base URL.");if(!te.netLoc&&te.path&&te.path[0]!=="/"){var Y=ct.exec(te.path);te.netLoc=Y[1],te.path=Y[2]}te.netLoc&&!te.path&&(te.path="/");var I={scheme:te.scheme,netLoc:se.netLoc,path:null,params:se.params,query:se.query,fragment:se.fragment};if(!se.netLoc&&(I.netLoc=te.netLoc,se.path[0]!=="/"))if(!se.path)I.path=te.path,se.params||(I.params=te.params,se.query||(I.query=te.query));else{var A=te.path,M=A.substring(0,A.lastIndexOf("/")+1)+se.path;I.path=ve.normalizePath(M)}return I.path===null&&(I.path=we.alwaysNormalize?ve.normalizePath(se.path):se.path),ve.buildURLFromParts(I)},parseURL:function(ze){var _e=mt.exec(ze);return _e?{scheme:_e[1]||"",netLoc:_e[2]||"",path:_e[3]||"",params:_e[4]||"",query:_e[5]||"",fragment:_e[6]||""}:null},normalizePath:function(ze){for(ze=ze.split("").reverse().join("").replace(ne,"");ze.length!==(ze=ze.replace(We,"")).length;);return ze.split("").reverse().join("")},buildURLFromParts:function(ze){return ze.scheme+ze.netLoc+ze.path+ze.params+ze.query+ze.fragment}};Kt.exports=ve})(this)},43033:function(Kt,Ut,mt){"use strict";mt.d(Ut,{Z:function(){return Re}});var ct=mt(58908),ne=mt.n(ct),We=mt(89144),ve=mt.n(We),ze=mt(75974),_e=mt.n(ze),we=mt(9603),ye=mt.n(we),se=mt(13407),te=mt.n(se),Y=mt(22122),I=mt(49945),A=mt.n(I),M="http://example.com",k=function(e,i){if(/^[a-z]+:/i.test(i))return i;/^data:/.test(e)&&(e=ne().location&&ne().location.href||"");var r=typeof ne().URL=="function",o=/^\/\//.test(e),c=!ne().location&&!/\/\//i.test(e);if(r?e=new(ne()).URL(e,ne().location||M):/\/\//i.test(e)||(e=A().buildAbsoluteURL(ne().location&&ne().location.href||"",e)),r){var f=new URL(i,e);return c?f.href.slice(M.length):o?f.href.slice(f.protocol.length):f.href}return A().buildAbsoluteURL(e,i)},V=k,J=function(){function s(){this.listeners={}}var e=s.prototype;return e.on=function(r,o){this.listeners[r]||(this.listeners[r]=[]),this.listeners[r].push(o)},e.off=function(r,o){if(!this.listeners[r])return!1;var c=this.listeners[r].indexOf(o);return this.listeners[r]=this.listeners[r].slice(0),this.listeners[r].splice(c,1),c>-1},e.trigger=function(r){var o=this.listeners[r];if(!!o)if(arguments.length===2)for(var c=o.length,f=0;f<c;++f)o[f].call(this,arguments[1]);else for(var y=Array.prototype.slice.call(arguments,1),S=o.length,O=0;O<S;++O)o[O].apply(this,y)},e.dispose=function(){this.listeners={}},e.pipe=function(r){this.on("data",function(o){r.push(o)})},s}(),F=mt(48764).Buffer,G=function(e){return ne().atob?ne().atob(e):F.from(e,"base64").toString("binary")};function $(s){for(var e=G(s),i=new Uint8Array(e.length),r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return i}/*! @name m3u8-parser @version 7.1.0 @license Apache-2.0 */class H extends J{constructor(){super();this.buffer=""}push(e){let i;for(this.buffer+=e,i=this.buffer.indexOf(`
`);i>-1;i=this.buffer.indexOf(`
`))this.trigger("data",this.buffer.substring(0,i)),this.buffer=this.buffer.substring(i+1)}}const C=String.fromCharCode(9),Q=function(s){const e=/([0-9.]*)?@?([0-9.]*)?/.exec(s||""),i={};return e[1]&&(i.length=parseInt(e[1],10)),e[2]&&(i.offset=parseInt(e[2],10)),i},ae=function(){const s="[^=]*",e='"[^"]*"|[^,]*',i="(?:"+s+")=(?:"+e+")";return new RegExp("(?:^|,)("+i+")")},ue=function(s){const e={};if(!s)return e;const i=s.split(ae());let r=i.length,o;for(;r--;)i[r]!==""&&(o=/([^=]*)=(.*)/.exec(i[r]).slice(1),o[0]=o[0].replace(/^\s+|\s+$/g,""),o[1]=o[1].replace(/^\s+|\s+$/g,""),o[1]=o[1].replace(/^['"](.*)['"]$/g,"$1"),e[o[0]]=o[1]);return e};class j extends J{constructor(){super();this.customParsers=[],this.tagMappers=[]}push(e){let i,r;if(e=e.trim(),e.length===0)return;if(e[0]!=="#"){this.trigger("data",{type:"uri",uri:e});return}this.tagMappers.reduce((c,f)=>{const y=f(e);return y===e?c:c.concat([y])},[e]).forEach(c=>{for(let f=0;f<this.customParsers.length;f++)if(this.customParsers[f].call(this,c))return;if(c.indexOf("#EXT")!==0){this.trigger("data",{type:"comment",text:c.slice(1)});return}if(c=c.replace("\r",""),i=/^#EXTM3U/.exec(c),i){this.trigger("data",{type:"tag",tagType:"m3u"});return}if(i=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(c),i){r={type:"tag",tagType:"inf"},i[1]&&(r.duration=parseFloat(i[1])),i[2]&&(r.title=i[2]),this.trigger("data",r);return}if(i=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(c),i){r={type:"tag",tagType:"targetduration"},i[1]&&(r.duration=parseInt(i[1],10)),this.trigger("data",r);return}if(i=/^#EXT-X-VERSION:([0-9.]*)?/.exec(c),i){r={type:"tag",tagType:"version"},i[1]&&(r.version=parseInt(i[1],10)),this.trigger("data",r);return}if(i=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(c),i){r={type:"tag",tagType:"media-sequence"},i[1]&&(r.number=parseInt(i[1],10)),this.trigger("data",r);return}if(i=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(c),i){r={type:"tag",tagType:"discontinuity-sequence"},i[1]&&(r.number=parseInt(i[1],10)),this.trigger("data",r);return}if(i=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(c),i){r={type:"tag",tagType:"playlist-type"},i[1]&&(r.playlistType=i[1]),this.trigger("data",r);return}if(i=/^#EXT-X-BYTERANGE:(.*)?$/.exec(c),i){r=(0,Y.Z)(Q(i[1]),{type:"tag",tagType:"byterange"}),this.trigger("data",r);return}if(i=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(c),i){r={type:"tag",tagType:"allow-cache"},i[1]&&(r.allowed=!/NO/.test(i[1])),this.trigger("data",r);return}if(i=/^#EXT-X-MAP:(.*)$/.exec(c),i){if(r={type:"tag",tagType:"map"},i[1]){const f=ue(i[1]);f.URI&&(r.uri=f.URI),f.BYTERANGE&&(r.byterange=Q(f.BYTERANGE))}this.trigger("data",r);return}if(i=/^#EXT-X-STREAM-INF:(.*)$/.exec(c),i){if(r={type:"tag",tagType:"stream-inf"},i[1]){if(r.attributes=ue(i[1]),r.attributes.RESOLUTION){const f=r.attributes.RESOLUTION.split("x"),y={};f[0]&&(y.width=parseInt(f[0],10)),f[1]&&(y.height=parseInt(f[1],10)),r.attributes.RESOLUTION=y}r.attributes.BANDWIDTH&&(r.attributes.BANDWIDTH=parseInt(r.attributes.BANDWIDTH,10)),r.attributes["FRAME-RATE"]&&(r.attributes["FRAME-RATE"]=parseFloat(r.attributes["FRAME-RATE"])),r.attributes["PROGRAM-ID"]&&(r.attributes["PROGRAM-ID"]=parseInt(r.attributes["PROGRAM-ID"],10))}this.trigger("data",r);return}if(i=/^#EXT-X-MEDIA:(.*)$/.exec(c),i){r={type:"tag",tagType:"media"},i[1]&&(r.attributes=ue(i[1])),this.trigger("data",r);return}if(i=/^#EXT-X-ENDLIST/.exec(c),i){this.trigger("data",{type:"tag",tagType:"endlist"});return}if(i=/^#EXT-X-DISCONTINUITY/.exec(c),i){this.trigger("data",{type:"tag",tagType:"discontinuity"});return}if(i=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(c),i){r={type:"tag",tagType:"program-date-time"},i[1]&&(r.dateTimeString=i[1],r.dateTimeObject=new Date(i[1])),this.trigger("data",r);return}if(i=/^#EXT-X-KEY:(.*)$/.exec(c),i){r={type:"tag",tagType:"key"},i[1]&&(r.attributes=ue(i[1]),r.attributes.IV&&(r.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(r.attributes.IV=r.attributes.IV.substring(2)),r.attributes.IV=r.attributes.IV.match(/.{8}/g),r.attributes.IV[0]=parseInt(r.attributes.IV[0],16),r.attributes.IV[1]=parseInt(r.attributes.IV[1],16),r.attributes.IV[2]=parseInt(r.attributes.IV[2],16),r.attributes.IV[3]=parseInt(r.attributes.IV[3],16),r.attributes.IV=new Uint32Array(r.attributes.IV))),this.trigger("data",r);return}if(i=/^#EXT-X-START:(.*)$/.exec(c),i){r={type:"tag",tagType:"start"},i[1]&&(r.attributes=ue(i[1]),r.attributes["TIME-OFFSET"]=parseFloat(r.attributes["TIME-OFFSET"]),r.attributes.PRECISE=/YES/.test(r.attributes.PRECISE)),this.trigger("data",r);return}if(i=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(c),i){r={type:"tag",tagType:"cue-out-cont"},i[1]?r.data=i[1]:r.data="",this.trigger("data",r);return}if(i=/^#EXT-X-CUE-OUT:(.*)?$/.exec(c),i){r={type:"tag",tagType:"cue-out"},i[1]?r.data=i[1]:r.data="",this.trigger("data",r);return}if(i=/^#EXT-X-CUE-IN:(.*)?$/.exec(c),i){r={type:"tag",tagType:"cue-in"},i[1]?r.data=i[1]:r.data="",this.trigger("data",r);return}if(i=/^#EXT-X-SKIP:(.*)$/.exec(c),i&&i[1]){r={type:"tag",tagType:"skip"},r.attributes=ue(i[1]),r.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(r.attributes["SKIPPED-SEGMENTS"]=parseInt(r.attributes["SKIPPED-SEGMENTS"],10)),r.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(r.attributes["RECENTLY-REMOVED-DATERANGES"]=r.attributes["RECENTLY-REMOVED-DATERANGES"].split(C)),this.trigger("data",r);return}if(i=/^#EXT-X-PART:(.*)$/.exec(c),i&&i[1]){r={type:"tag",tagType:"part"},r.attributes=ue(i[1]),["DURATION"].forEach(function(f){r.attributes.hasOwnProperty(f)&&(r.attributes[f]=parseFloat(r.attributes[f]))}),["INDEPENDENT","GAP"].forEach(function(f){r.attributes.hasOwnProperty(f)&&(r.attributes[f]=/YES/.test(r.attributes[f]))}),r.attributes.hasOwnProperty("BYTERANGE")&&(r.attributes.byterange=Q(r.attributes.BYTERANGE)),this.trigger("data",r);return}if(i=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(c),i&&i[1]){r={type:"tag",tagType:"server-control"},r.attributes=ue(i[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(f){r.attributes.hasOwnProperty(f)&&(r.attributes[f]=parseFloat(r.attributes[f]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(f){r.attributes.hasOwnProperty(f)&&(r.attributes[f]=/YES/.test(r.attributes[f]))}),this.trigger("data",r);return}if(i=/^#EXT-X-PART-INF:(.*)$/.exec(c),i&&i[1]){r={type:"tag",tagType:"part-inf"},r.attributes=ue(i[1]),["PART-TARGET"].forEach(function(f){r.attributes.hasOwnProperty(f)&&(r.attributes[f]=parseFloat(r.attributes[f]))}),this.trigger("data",r);return}if(i=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(c),i&&i[1]){r={type:"tag",tagType:"preload-hint"},r.attributes=ue(i[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(f){if(r.attributes.hasOwnProperty(f)){r.attributes[f]=parseInt(r.attributes[f],10);const y=f==="BYTERANGE-LENGTH"?"length":"offset";r.attributes.byterange=r.attributes.byterange||{},r.attributes.byterange[y]=r.attributes[f],delete r.attributes[f]}}),this.trigger("data",r);return}if(i=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(c),i&&i[1]){r={type:"tag",tagType:"rendition-report"},r.attributes=ue(i[1]),["LAST-MSN","LAST-PART"].forEach(function(f){r.attributes.hasOwnProperty(f)&&(r.attributes[f]=parseInt(r.attributes[f],10))}),this.trigger("data",r);return}if(i=/^#EXT-X-DATERANGE:(.*)$/.exec(c),i&&i[1]){r={type:"tag",tagType:"daterange"},r.attributes=ue(i[1]),["ID","CLASS"].forEach(function(y){r.attributes.hasOwnProperty(y)&&(r.attributes[y]=String(r.attributes[y]))}),["START-DATE","END-DATE"].forEach(function(y){r.attributes.hasOwnProperty(y)&&(r.attributes[y]=new Date(r.attributes[y]))}),["DURATION","PLANNED-DURATION"].forEach(function(y){r.attributes.hasOwnProperty(y)&&(r.attributes[y]=parseFloat(r.attributes[y]))}),["END-ON-NEXT"].forEach(function(y){r.attributes.hasOwnProperty(y)&&(r.attributes[y]=/YES/i.test(r.attributes[y]))}),["SCTE35-CMD"," SCTE35-OUT","SCTE35-IN"].forEach(function(y){r.attributes.hasOwnProperty(y)&&(r.attributes[y]=r.attributes[y].toString(16))});const f=/^X-([A-Z]+-)+[A-Z]+$/;for(const y in r.attributes){if(!f.test(y))continue;const S=/[0-9A-Fa-f]{6}/g.test(r.attributes[y]),O=/^\d+(\.\d+)?$/.test(r.attributes[y]);r.attributes[y]=S?r.attributes[y].toString(16):O?parseFloat(r.attributes[y]):String(r.attributes[y])}this.trigger("data",r);return}if(i=/^#EXT-X-INDEPENDENT-SEGMENTS/.exec(c),i){this.trigger("data",{type:"tag",tagType:"independent-segments"});return}if(i=/^#EXT-X-CONTENT-STEERING:(.*)$/.exec(c),i){r={type:"tag",tagType:"content-steering"},r.attributes=ue(i[1]),this.trigger("data",r);return}this.trigger("data",{type:"tag",data:c.slice(4)})})}addParser({expression:e,customType:i,dataParser:r,segment:o}){typeof r!="function"&&(r=c=>c),this.customParsers.push(c=>{if(e.exec(c))return this.trigger("data",{type:"custom",data:r(c),customType:i,segment:o}),!0})}addTagMapper({expression:e,map:i}){const r=o=>e.test(o)?i(o):o;this.tagMappers.push(r)}}const X=s=>s.toLowerCase().replace(/-(\w)/g,e=>e[1].toUpperCase()),oe=function(s){const e={};return Object.keys(s).forEach(function(i){e[X(i)]=s[i]}),e},ce=function(s){const{serverControl:e,targetDuration:i,partTargetDuration:r}=s;if(!e)return;const o="#EXT-X-SERVER-CONTROL",c="holdBack",f="partHoldBack",y=i&&i*3,S=r&&r*2;i&&!e.hasOwnProperty(c)&&(e[c]=y,this.trigger("info",{message:`${o} defaulting HOLD-BACK to targetDuration * 3 (${y}).`})),y&&e[c]<y&&(this.trigger("warn",{message:`${o} clamping HOLD-BACK (${e[c]}) to targetDuration * 3 (${y})`}),e[c]=y),r&&!e.hasOwnProperty(f)&&(e[f]=r*3,this.trigger("info",{message:`${o} defaulting PART-HOLD-BACK to partTargetDuration * 3 (${e[f]}).`})),r&&e[f]<S&&(this.trigger("warn",{message:`${o} clamping PART-HOLD-BACK (${e[f]}) to partTargetDuration * 2 (${S}).`}),e[f]=S)};class be extends J{constructor(){super();this.lineStream=new H,this.parseStream=new j,this.lineStream.pipe(this.parseStream),this.lastProgramDateTime=null;const e=this,i=[];let r={},o,c,f=!1;const y=function(){},S={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},O="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";let q=0;this.manifest={allowCache:!0,discontinuityStarts:[],dateRanges:[],segments:[]};let de=0,Te=0;const Ie={};this.on("end",()=>{r.uri||!r.parts&&!r.preloadHints||(!r.map&&o&&(r.map=o),!r.key&&c&&(r.key=c),!r.timeline&&typeof q=="number"&&(r.timeline=q),this.manifest.preloadSegment=r)}),this.parseStream.on("data",function(ge){let je,Ke;({tag(){({version(){ge.version&&(this.manifest.version=ge.version)},"allow-cache"(){this.manifest.allowCache=ge.allowed,"allowed"in ge||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){const Ye={};"length"in ge&&(r.byterange=Ye,Ye.length=ge.length,"offset"in ge||(ge.offset=de)),"offset"in ge&&(r.byterange=Ye,Ye.offset=ge.offset),de=Ye.offset+Ye.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),ge.title&&(r.title=ge.title),ge.duration>0&&(r.duration=ge.duration),ge.duration===0&&(r.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=i},key(){if(!ge.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(ge.attributes.METHOD==="NONE"){c=null;return}if(!ge.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(ge.attributes.KEYFORMAT==="com.apple.streamingkeydelivery"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:ge.attributes};return}if(ge.attributes.KEYFORMAT==="com.microsoft.playready"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:ge.attributes.URI};return}if(ge.attributes.KEYFORMAT===O){if(["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(ge.attributes.METHOD)===-1){this.trigger("warn",{message:"invalid key method provided for Widevine"});return}if(ge.attributes.METHOD==="SAMPLE-AES-CENC"&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),ge.attributes.URI.substring(0,23)!=="data:text/plain;base64,"){this.trigger("warn",{message:"invalid key URI provided for Widevine"});return}if(!(ge.attributes.KEYID&&ge.attributes.KEYID.substring(0,2)==="0x")){this.trigger("warn",{message:"invalid key ID provided for Widevine"});return}this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:ge.attributes.KEYFORMAT,keyId:ge.attributes.KEYID.substring(2)},pssh:$(ge.attributes.URI.split(",")[1])};return}ge.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),c={method:ge.attributes.METHOD||"AES-128",uri:ge.attributes.URI},typeof ge.attributes.IV!="undefined"&&(c.iv=ge.attributes.IV)},"media-sequence"(){if(!isFinite(ge.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+ge.number});return}this.manifest.mediaSequence=ge.number},"discontinuity-sequence"(){if(!isFinite(ge.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+ge.number});return}this.manifest.discontinuitySequence=ge.number,q=ge.number},"playlist-type"(){if(!/VOD|EVENT/.test(ge.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+ge.playlist});return}this.manifest.playlistType=ge.playlistType},map(){o={},ge.uri&&(o.uri=ge.uri),ge.byterange&&(o.byterange=ge.byterange),c&&(o.key=c)},"stream-inf"(){if(this.manifest.playlists=i,this.manifest.mediaGroups=this.manifest.mediaGroups||S,!ge.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}r.attributes||(r.attributes={}),(0,Y.Z)(r.attributes,ge.attributes)},media(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||S,!(ge.attributes&&ge.attributes.TYPE&&ge.attributes["GROUP-ID"]&&ge.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}const Ye=this.manifest.mediaGroups[ge.attributes.TYPE];Ye[ge.attributes["GROUP-ID"]]=Ye[ge.attributes["GROUP-ID"]]||{},je=Ye[ge.attributes["GROUP-ID"]],Ke={default:/yes/i.test(ge.attributes.DEFAULT)},Ke.default?Ke.autoselect=!0:Ke.autoselect=/yes/i.test(ge.attributes.AUTOSELECT),ge.attributes.LANGUAGE&&(Ke.language=ge.attributes.LANGUAGE),ge.attributes.URI&&(Ke.uri=ge.attributes.URI),ge.attributes["INSTREAM-ID"]&&(Ke.instreamId=ge.attributes["INSTREAM-ID"]),ge.attributes.CHARACTERISTICS&&(Ke.characteristics=ge.attributes.CHARACTERISTICS),ge.attributes.FORCED&&(Ke.forced=/yes/i.test(ge.attributes.FORCED)),je[ge.attributes.NAME]=Ke},discontinuity(){q+=1,r.discontinuity=!0,this.manifest.discontinuityStarts.push(i.length)},"program-date-time"(){typeof this.manifest.dateTimeString=="undefined"&&(this.manifest.dateTimeString=ge.dateTimeString,this.manifest.dateTimeObject=ge.dateTimeObject),r.dateTimeString=ge.dateTimeString,r.dateTimeObject=ge.dateTimeObject;const{lastProgramDateTime:Ye}=this;this.lastProgramDateTime=new Date(ge.dateTimeString).getTime(),Ye===null&&this.manifest.segments.reduceRight((qe,at)=>(at.programDateTime=qe-at.duration*1e3,at.programDateTime),this.lastProgramDateTime)},targetduration(){if(!isFinite(ge.duration)||ge.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+ge.duration});return}this.manifest.targetDuration=ge.duration,ce.call(this,this.manifest)},start(){if(!ge.attributes||isNaN(ge.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:ge.attributes["TIME-OFFSET"],precise:ge.attributes.PRECISE}},"cue-out"(){r.cueOut=ge.data},"cue-out-cont"(){r.cueOutCont=ge.data},"cue-in"(){r.cueIn=ge.data},skip(){this.manifest.skip=oe(ge.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",ge.attributes,["SKIPPED-SEGMENTS"])},part(){f=!0;const Ye=this.manifest.segments.length,qe=oe(ge.attributes);r.parts=r.parts||[],r.parts.push(qe),qe.byterange&&(qe.byterange.hasOwnProperty("offset")||(qe.byterange.offset=Te),Te=qe.byterange.offset+qe.byterange.length);const at=r.parts.length-1;this.warnOnMissingAttributes_(`#EXT-X-PART #${at} for segment #${Ye}`,ge.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((ht,Ue)=>{ht.hasOwnProperty("lastPart")||this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${Ue} lacks required attribute(s): LAST-PART`})})},"server-control"(){const Ye=this.manifest.serverControl=oe(ge.attributes);Ye.hasOwnProperty("canBlockReload")||(Ye.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),ce.call(this,this.manifest),Ye.canSkipDateranges&&!Ye.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){const Ye=this.manifest.segments.length,qe=oe(ge.attributes),at=qe.type&&qe.type==="PART";r.preloadHints=r.preloadHints||[],r.preloadHints.push(qe),qe.byterange&&(qe.byterange.hasOwnProperty("offset")||(qe.byterange.offset=at?Te:0,at&&(Te=qe.byterange.offset+qe.byterange.length)));const ht=r.preloadHints.length-1;if(this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${ht} for segment #${Ye}`,ge.attributes,["TYPE","URI"]),!!qe.type)for(let Ue=0;Ue<r.preloadHints.length-1;Ue++){const pt=r.preloadHints[Ue];!pt.type||pt.type===qe.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${ht} for segment #${Ye} has the same TYPE ${qe.type} as preload hint #${Ue}`})}},"rendition-report"(){const Ye=oe(ge.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(Ye);const qe=this.manifest.renditionReports.length-1,at=["LAST-MSN","URI"];f&&at.push("LAST-PART"),this.warnOnMissingAttributes_(`#EXT-X-RENDITION-REPORT #${qe}`,ge.attributes,at)},"part-inf"(){this.manifest.partInf=oe(ge.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",ge.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),ce.call(this,this.manifest)},daterange(){this.manifest.dateRanges.push(oe(ge.attributes));const Ye=this.manifest.dateRanges.length-1;this.warnOnMissingAttributes_(`#EXT-X-DATERANGE #${Ye}`,ge.attributes,["ID","START-DATE"]);const qe=this.manifest.dateRanges[Ye];qe.endDate&&qe.startDate&&new Date(qe.endDate)<new Date(qe.startDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE END-DATE must be equal to or later than the value of the START-DATE"}),qe.duration&&qe.duration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE DURATION must not be negative"}),qe.plannedDuration&&qe.plannedDuration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE PLANNED-DURATION must not be negative"});const at=!!qe.endOnNext;if(at&&!qe.class&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must have a CLASS attribute"}),at&&(qe.duration||qe.endDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must not contain DURATION or END-DATE attributes"}),qe.duration&&qe.endDate){const Ue=qe.startDate.getTime()+qe.duration*1e3;this.manifest.dateRanges[Ye].endDate=new Date(Ue)}if(!Ie[qe.id])Ie[qe.id]=qe;else{for(const Ue in Ie[qe.id])if(!!qe[Ue]&&JSON.stringify(Ie[qe.id][Ue])!==JSON.stringify(qe[Ue])){this.trigger("warn",{message:"EXT-X-DATERANGE tags with the same ID in a playlist must have the same attributes values"});break}const ht=this.manifest.dateRanges.findIndex(Ue=>Ue.id===qe.id);this.manifest.dateRanges[ht]=(0,Y.Z)(this.manifest.dateRanges[ht],qe),Ie[qe.id]=(0,Y.Z)(Ie[qe.id],qe),this.manifest.dateRanges.pop()}},"independent-segments"(){this.manifest.independentSegments=!0},"content-steering"(){this.manifest.contentSteering=oe(ge.attributes),this.warnOnMissingAttributes_("#EXT-X-CONTENT-STEERING",ge.attributes,["SERVER-URI"])}}[ge.tagType]||y).call(e)},uri(){r.uri=ge.uri,i.push(r),this.manifest.targetDuration&&!("duration"in r)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),r.duration=this.manifest.targetDuration),c&&(r.key=c),r.timeline=q,o&&(r.map=o),Te=0,this.lastProgramDateTime!==null&&(r.programDateTime=this.lastProgramDateTime,this.lastProgramDateTime+=r.duration*1e3),r={}},comment(){},custom(){ge.segment?(r.custom=r.custom||{},r.custom[ge.customType]=ge.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[ge.customType]=ge.data)}})[ge.type].call(e)})}warnOnMissingAttributes_(e,i,r){const o=[];r.forEach(function(c){i.hasOwnProperty(c)||o.push(c)}),o.length&&this.trigger("warn",{message:`${e} lacks required attribute(s): ${o.join(", ")}`})}push(e){this.lineStream.push(e)}end(){this.lineStream.push(`
`),this.manifest.dateRanges.length&&this.lastProgramDateTime===null&&this.trigger("warn",{message:"A playlist with EXT-X-DATERANGE tag must contain atleast one EXT-X-PROGRAM-DATE-TIME tag"}),this.lastProgramDateTime=null,this.trigger("end")}addParser(e){this.parseStream.addParser(e)}addTagMapper(e){this.parseStream.addTagMapper(e)}}var Be={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},Ce=["video","audio","text"],Le=["Video","Audio","Text"],Pe=function(e){return e&&e.replace(/avc1\.(\d+)\.(\d+)/i,function(i,r,o){var c=("00"+Number(r).toString(16)).slice(-2),f=("00"+Number(o).toString(16)).slice(-2);return"avc1."+c+"00"+f})},De=function(e){return e.map(Pe)},Ve=function(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,function(i){return De([i])[0]})},Oe=function(e){e===void 0&&(e="");var i=e.split(","),r=[];return i.forEach(function(o){o=o.trim();var c;Ce.forEach(function(f){var y=Be[f].exec(o.toLowerCase());if(!(!y||y.length<=1)){c=f;var S=o.substring(0,y[1].length),O=o.replace(S,"");r.push({type:S,details:O,mediaType:f})}}),c||r.push({type:o,details:"",mediaType:"unknown"})}),r},dt=function(e,i){if(!e.mediaGroups.AUDIO||!i)return null;var r=e.mediaGroups.AUDIO[i];if(!r)return null;for(var o in r){var c=r[o];if(c.default&&c.playlists)return Oe(c.playlists[0].attributes.CODECS)}return null},Nt=function(e){return e===void 0&&(e=""),Be.video.test(e.trim().toLowerCase())},It=function(e){return e===void 0&&(e=""),Be.audio.test(e.trim().toLowerCase())},gt=function(e){return e===void 0&&(e=""),Be.text.test(e.trim().toLowerCase())},nt=function(e){if(!(!e||typeof e!="string")){var i=e.toLowerCase().split(",").map(function(c){return Pe(c.trim())}),r="video";i.length===1&&It(i[0])?r="audio":i.length===1&&gt(i[0])&&(r="application");var o="mp4";return i.every(function(c){return Be.mp4.test(c)})?o="mp4":i.every(function(c){return Be.webm.test(c)})?o="webm":i.every(function(c){return Be.ogg.test(c)})&&(o="ogg"),r+"/"+o+';codecs="'+e+'"'}},Ht=function(e){return e===void 0&&(e=""),ne().MediaSource&&ne().MediaSource.isTypeSupported&&ne().MediaSource.isTypeSupported(nt(e))||!1},Tt=function(e){return e===void 0&&(e=""),e.toLowerCase().split(",").every(function(i){i=i.trim();for(var r=0;r<Le.length;r++){var o=Le[r];if(Be["muxer"+o].test(i))return!0}return!1})},Gt="mp4a.40.2",hi="avc1.4d400d",ai=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,Ei=/^application\/dash\+xml/i,Ai=function(e){return ai.test(e)?"hls":Ei.test(e)?"dash":e==="application/vnd.videojs.vhs+json"?"vhs-json":null},Ct=function(e,i){for(var r="";i--;)r+=e;return r},di=function(e){return e.toString(2).length},ui=function(e){return Math.ceil(di(e)/8)},ji=function(e,i,r){return r===void 0&&(r=" "),(Ct(r,i)+e.toString()).slice(-i)},un=function(e){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer},$i=function(e){return un(e)},wt=function(e){return e instanceof Uint8Array?e:(!Array.isArray(e)&&!$i(e)&&!(e instanceof ArrayBuffer)&&(typeof e!="number"||typeof e=="number"&&e!==e?e=0:e=[e]),new Uint8Array(e&&e.buffer||e,e&&e.byteOffset||0,e&&e.byteLength||0))},mn=function(e){e=wt(e);for(var i="",r=0;r<e.length;r++)i+=ji(e[r].toString(16),2,"0");return i},pi=function(e){e=wt(e);for(var i="",r=0;r<e.length;r++)i+=ji(e[r].toString(2),8,"0");return i},ti=ne().BigInt||Number,_i=[ti("0x1"),ti("0x100"),ti("0x10000"),ti("0x1000000"),ti("0x100000000"),ti("0x10000000000"),ti("0x1000000000000"),ti("0x100000000000000"),ti("0x10000000000000000")],Vi=function(){var s=new Uint16Array([65484]),e=new Uint8Array(s.buffer,s.byteOffset,s.byteLength);return e[0]===255?"big":e[0]===204?"little":"unknown"}(),nr=Vi==="big",Bs=Vi==="little",cs=function(e,i){var r=i===void 0?{}:i,o=r.signed,c=o===void 0?!1:o,f=r.le,y=f===void 0?!1:f;e=wt(e);var S=y?"reduce":"reduceRight",O=e[S]?e[S]:Array.prototype[S],q=O.call(e,function(Te,Ie,ge){var je=y?ge:Math.abs(ge+1-e.length);return Te+ti(Ie)*_i[je]},ti(0));if(c){var de=_i[e.length]/ti(2)-ti(1);q=ti(q),q>de&&(q-=de,q-=de,q-=ti(2))}return Number(q)},nn=function(e,i){var r=i===void 0?{}:i,o=r.le,c=o===void 0?!1:o;(typeof e!="bigint"&&typeof e!="number"||typeof e=="number"&&e!==e)&&(e=0),e=ti(e);for(var f=ui(e),y=new Uint8Array(new ArrayBuffer(f)),S=0;S<f;S++){var O=c?S:Math.abs(S+1-y.length);y[O]=Number(e/_i[S]&ti(255)),e<0&&(y[O]=Math.abs(~y[O]),y[O]-=S===0?1:2)}return y},Ms=function(e){if(!e)return"";e=Array.prototype.slice.call(e);var i=String.fromCharCode.apply(null,wt(e));try{return decodeURIComponent(escape(i))}catch(r){}return i},Ze=function(e,i){if(typeof e!="string"&&e&&typeof e.toString=="function"&&(e=e.toString()),typeof e!="string")return new Uint8Array;i||(e=unescape(encodeURIComponent(e)));for(var r=new Uint8Array(e.length),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);return r},ke=function(){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];if(i=i.filter(function(y){return y&&(y.byteLength||y.length)&&typeof y!="string"}),i.length<=1)return wt(i[0]);var o=i.reduce(function(y,S,O){return y+(S.byteLength||S.length)},0),c=new Uint8Array(o),f=0;return i.forEach(function(y){y=wt(y),c.set(y,f),f+=y.byteLength}),c},rt=function(e,i,r){var o=r===void 0?{}:r,c=o.offset,f=c===void 0?0:c,y=o.mask,S=y===void 0?[]:y;e=wt(e),i=wt(i);var O=i.every?i.every:Array.prototype.every;return i.length&&e.length-f>=i.length&&O.call(i,function(q,de){var Te=S[de]?S[de]&e[f+de]:e[f+de];return q===Te})},Lt=function(e,i,r){return Uint8Array.prototype.slice?Uint8Array.prototype.slice.call(e,i,r):new Uint8Array(Array.prototype.slice.call(e,i,r))},Yt=function(e){return e.reverse?e.reverse():Array.prototype.reverse.call(e)},Dt=function(e,i,r){i.forEach(function(o){for(var c in e.mediaGroups[o])for(var f in e.mediaGroups[o][c]){var y=e.mediaGroups[o][c][f];r(y,o,c,f)}})},ki=mt(48764).Buffer,mi=function(e){return ne().atob?ne().atob(e):ki.from(e,"base64").toString("binary")};function Pn(s){for(var e=mi(s),i=new Uint8Array(e.length),r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return i}var Mt=mt(3969);/*! @name mpd-parser @version 1.3.0 @license Apache-2.0 */var mr="1.3.0";const hs=s=>!!s&&typeof s=="object",Ti=(...s)=>s.reduce((e,i)=>(typeof i!="object"||Object.keys(i).forEach(r=>{Array.isArray(e[r])&&Array.isArray(i[r])?e[r]=e[r].concat(i[r]):hs(e[r])&&hs(i[r])?e[r]=Ti(e[r],i[r]):e[r]=i[r]}),e),{}),Lr=s=>Object.keys(s).map(e=>s[e]),Jt=(s,e)=>{const i=[];for(let r=s;r<e;r++)i.push(r);return i},rr=s=>s.reduce((e,i)=>e.concat(i),[]),Kr=s=>{if(!s.length)return[];const e=[];for(let i=0;i<s.length;i++)e.push(s[i]);return e},ca=(s,e)=>s.reduce((i,r,o)=>(r[e]&&i.push(o),i),[]),Dr=(s,e)=>Lr(s.reduce((i,r)=>(r.forEach(o=>{i[e(o)]=o}),i),{}));var Yi={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",INVALID_NUMBER_OF_CONTENT_STEERING:"INVALID_NUMBER_OF_CONTENT_STEERING",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",MISSING_SEGMENT_INFORMATION:"MISSING_SEGMENT_INFORMATION",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"};const dn=({baseUrl:s="",source:e="",range:i="",indexRange:r=""})=>{const o={uri:e,resolvedUri:V(s||"",e)};if(i||r){const f=(i||r).split("-");let y=ne().BigInt?ne().BigInt(f[0]):parseInt(f[0],10),S=ne().BigInt?ne().BigInt(f[1]):parseInt(f[1],10);y<Number.MAX_SAFE_INTEGER&&typeof y=="bigint"&&(y=Number(y)),S<Number.MAX_SAFE_INTEGER&&typeof S=="bigint"&&(S=Number(S));let O;typeof S=="bigint"||typeof y=="bigint"?O=ne().BigInt(S)-ne().BigInt(y)+ne().BigInt(1):O=S-y+1,typeof O=="bigint"&&O<Number.MAX_SAFE_INTEGER&&(O=Number(O)),o.byterange={length:O,offset:y}}return o},Fs=s=>{let e;return typeof s.offset=="bigint"||typeof s.length=="bigint"?e=ne().BigInt(s.offset)+ne().BigInt(s.length)-ne().BigInt(1):e=s.offset+s.length-1,`${s.offset}-${e}`},Yr=s=>(s&&typeof s!="number"&&(s=parseInt(s,10)),isNaN(s)?null:s),ko={static(s){const{duration:e,timescale:i=1,sourceDuration:r,periodDuration:o}=s,c=Yr(s.endNumber),f=e/i;return typeof c=="number"?{start:0,end:c}:typeof o=="number"?{start:0,end:o/f}:{start:0,end:r/f}},dynamic(s){const{NOW:e,clientOffset:i,availabilityStartTime:r,timescale:o=1,duration:c,periodStart:f=0,minimumUpdatePeriod:y=0,timeShiftBufferDepth:S=Infinity}=s,O=Yr(s.endNumber),q=(e+i)/1e3,de=r+f,Ie=q+y-de,ge=Math.ceil(Ie*o/c),je=Math.floor((q-de-S)*o/c),Ke=Math.floor((q-de)*o/c);return{start:Math.max(0,je),end:typeof O=="number"?O:Math.min(ge,Ke)}}},ie=s=>e=>{const{duration:i,timescale:r=1,periodStart:o,startNumber:c=1}=s;return{number:c+e,duration:i/r,timeline:o,time:e*i}},le=s=>{const{type:e,duration:i,timescale:r=1,periodDuration:o,sourceDuration:c}=s,{start:f,end:y}=ko[e](s),S=Jt(f,y).map(ie(s));if(e==="static"){const O=S.length-1,q=typeof o=="number"?o:c;S[O].duration=q-i/r*O}return S},Se=s=>{const{baseUrl:e,initialization:i={},sourceDuration:r,indexRange:o="",periodStart:c,presentationTime:f,number:y=0,duration:S}=s;if(!e)throw new Error(Yi.NO_BASE_URL);const O=dn({baseUrl:e,source:i.sourceURL,range:i.range}),q=dn({baseUrl:e,source:e,indexRange:o});if(q.map=O,S){const de=le(s);de.length&&(q.duration=de[0].duration,q.timeline=de[0].timeline)}else r&&(q.duration=r,q.timeline=c);return q.presentationTime=f||c,q.number=y,[q]},Xe=(s,e,i)=>{const r=s.sidx.map?s.sidx.map:null,o=s.sidx.duration,c=s.timeline||0,f=s.sidx.byterange,y=f.offset+f.length,S=e.timescale,O=e.references.filter(Ke=>Ke.referenceType!==1),q=[],de=s.endList?"static":"dynamic",Te=s.sidx.timeline;let Ie=Te,ge=s.mediaSequence||0,je;typeof e.firstOffset=="bigint"?je=ne().BigInt(y)+e.firstOffset:je=y+e.firstOffset;for(let Ke=0;Ke<O.length;Ke++){const Ye=e.references[Ke],qe=Ye.referencedSize,at=Ye.subsegmentDuration;let ht;typeof je=="bigint"?ht=je+ne().BigInt(qe)-ne().BigInt(1):ht=je+qe-1;const Ue=`${je}-${ht}`,Vt=Se({baseUrl:i,timescale:S,timeline:c,periodStart:Te,presentationTime:Ie,number:ge,duration:at,sourceDuration:o,indexRange:Ue,type:de})[0];r&&(Vt.map=r),q.push(Vt),typeof je=="bigint"?je+=ne().BigInt(qe):je+=qe,Ie+=at/S,ge++}return s.segments=q,s},ft=["AUDIO","SUBTITLES"],jt=1/60,bi=s=>Dr(s,({timeline:e})=>e).sort((e,i)=>e.timeline>i.timeline?1:-1),Di=(s,e)=>{for(let i=0;i<s.length;i++)if(s[i].attributes.NAME===e)return s[i];return null},cn=s=>{let e=[];return Dt(s,ft,(i,r,o,c)=>{e=e.concat(i.playlists||[])}),e},hn=({playlist:s,mediaSequence:e})=>{s.mediaSequence=e,s.segments.forEach((i,r)=>{i.number=s.mediaSequence+r})},Wn=({oldPlaylists:s,newPlaylists:e,timelineStarts:i})=>{e.forEach(r=>{r.discontinuitySequence=i.findIndex(function({timeline:S}){return S===r.timeline});const o=Di(s,r.attributes.NAME);if(!o||r.sidx)return;const c=r.segments[0],f=o.segments.findIndex(function(S){return Math.abs(S.presentationTime-c.presentationTime)<jt});if(f===-1){hn({playlist:r,mediaSequence:o.mediaSequence+o.segments.length}),r.segments[0].discontinuity=!0,r.discontinuityStarts.unshift(0),(!o.segments.length&&r.timeline>o.timeline||o.segments.length&&r.timeline>o.segments[o.segments.length-1].timeline)&&r.discontinuitySequence--;return}o.segments[f].discontinuity&&!c.discontinuity&&(c.discontinuity=!0,r.discontinuityStarts.unshift(0),r.discontinuitySequence--),hn({playlist:r,mediaSequence:o.segments[f].number})})},sr=({oldManifest:s,newManifest:e})=>{const i=s.playlists.concat(cn(s)),r=e.playlists.concat(cn(e));return e.timelineStarts=bi([s.timelineStarts,e.timelineStarts]),Wn({oldPlaylists:i,newPlaylists:r,timelineStarts:e.timelineStarts}),e},On=s=>s&&s.uri+"-"+Fs(s.byterange),Fn=s=>{const e=s.reduce(function(r,o){return r[o.attributes.baseUrl]||(r[o.attributes.baseUrl]=[]),r[o.attributes.baseUrl].push(o),r},{});let i=[];return Object.values(e).forEach(r=>{const o=Lr(r.reduce((c,f)=>{const y=f.attributes.id+(f.attributes.lang||"");return c[y]?(f.segments&&(f.segments[0]&&(f.segments[0].discontinuity=!0),c[y].segments.push(...f.segments)),f.attributes.contentProtection&&(c[y].attributes.contentProtection=f.attributes.contentProtection)):(c[y]=f,c[y].attributes.timelineStarts=[]),c[y].attributes.timelineStarts.push({start:f.attributes.periodStart,timeline:f.attributes.periodStart}),c},{}));i=i.concat(o)}),i.map(r=>(r.discontinuityStarts=ca(r.segments||[],"discontinuity"),r))},An=(s,e)=>{const i=On(s.sidx),r=i&&e[i]&&e[i].sidx;return r&&Xe(s,r,s.sidx.resolvedUri),s},Xi=(s,e={})=>{if(!Object.keys(e).length)return s;for(const i in s)s[i]=An(s[i],e);return s},Nn=({attributes:s,segments:e,sidx:i,mediaSequence:r,discontinuitySequence:o,discontinuityStarts:c},f)=>{const y={attributes:{NAME:s.id,BANDWIDTH:s.bandwidth,CODECS:s.codecs,["PROGRAM-ID"]:1},uri:"",endList:s.type==="static",timeline:s.periodStart,resolvedUri:s.baseUrl||"",targetDuration:s.duration,discontinuitySequence:o,discontinuityStarts:c,timelineStarts:s.timelineStarts,mediaSequence:r,segments:e};return s.contentProtection&&(y.contentProtection=s.contentProtection),s.serviceLocation&&(y.attributes.serviceLocation=s.serviceLocation),i&&(y.sidx=i),f&&(y.attributes.AUDIO="audio",y.attributes.SUBTITLES="subs"),y},gr=({attributes:s,segments:e,mediaSequence:i,discontinuityStarts:r,discontinuitySequence:o})=>{typeof e=="undefined"&&(e=[{uri:s.baseUrl,timeline:s.periodStart,resolvedUri:s.baseUrl||"",duration:s.sourceDuration,number:0}],s.duration=s.sourceDuration);const c={NAME:s.id,BANDWIDTH:s.bandwidth,["PROGRAM-ID"]:1};s.codecs&&(c.CODECS=s.codecs);const f={attributes:c,uri:"",endList:s.type==="static",timeline:s.periodStart,resolvedUri:s.baseUrl||"",targetDuration:s.duration,timelineStarts:s.timelineStarts,discontinuityStarts:r,discontinuitySequence:o,mediaSequence:i,segments:e};return s.serviceLocation&&(f.attributes.serviceLocation=s.serviceLocation),f},kr=(s,e={},i=!1)=>{let r;const o=s.reduce((c,f)=>{const y=f.attributes.role&&f.attributes.role.value||"",S=f.attributes.lang||"";let O=f.attributes.label||"main";if(S&&!f.attributes.label){const de=y?` (${y})`:"";O=`${f.attributes.lang}${de}`}c[O]||(c[O]={language:S,autoselect:!0,default:y==="main",playlists:[],uri:""});const q=An(Nn(f,i),e);return c[O].playlists.push(q),typeof r=="undefined"&&y==="main"&&(r=f,r.default=!0),c},{});if(!r){const c=Object.keys(o)[0];o[c].default=!0}return o},xi=(s,e={})=>s.reduce((i,r)=>{const o=r.attributes.label||r.attributes.lang||"text";return i[o]||(i[o]={language:o,default:!1,autoselect:!1,playlists:[],uri:""}),i[o].playlists.push(An(gr(r),e)),i},{}),Ir=s=>s.reduce((e,i)=>(i&&i.forEach(r=>{const{channel:o,language:c}=r;e[c]={autoselect:!1,default:!1,instreamId:o,language:c},r.hasOwnProperty("aspectRatio")&&(e[c].aspectRatio=r.aspectRatio),r.hasOwnProperty("easyReader")&&(e[c].easyReader=r.easyReader),r.hasOwnProperty("3D")&&(e[c]["3D"]=r["3D"])}),e),{}),Ga=({attributes:s,segments:e,sidx:i,discontinuityStarts:r})=>{const o={attributes:{NAME:s.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:s.width,height:s.height},CODECS:s.codecs,BANDWIDTH:s.bandwidth,["PROGRAM-ID"]:1},uri:"",endList:s.type==="static",timeline:s.periodStart,resolvedUri:s.baseUrl||"",targetDuration:s.duration,discontinuityStarts:r,timelineStarts:s.timelineStarts,segments:e};return s.frameRate&&(o.attributes["FRAME-RATE"]=s.frameRate),s.contentProtection&&(o.contentProtection=s.contentProtection),s.serviceLocation&&(o.attributes.serviceLocation=s.serviceLocation),i&&(o.sidx=i),o},Io=({attributes:s})=>s.mimeType==="video/mp4"||s.mimeType==="video/webm"||s.contentType==="video",ar=({attributes:s})=>s.mimeType==="audio/mp4"||s.mimeType==="audio/webm"||s.contentType==="audio",Il=({attributes:s})=>s.mimeType==="text/vtt"||s.contentType==="text",Ns=(s,e)=>{s.forEach(i=>{i.mediaSequence=0,i.discontinuitySequence=e.findIndex(function({timeline:r}){return r===i.timeline}),!!i.segments&&i.segments.forEach((r,o)=>{r.number=o})})},Ro=s=>s?Object.keys(s).reduce((e,i)=>{const r=s[i];return e.concat(r.playlists)},[]):[],ha=({dashPlaylists:s,locations:e,contentSteering:i,sidxMapping:r={},previousManifest:o,eventStream:c})=>{if(!s.length)return{};const{sourceDuration:f,type:y,suggestedPresentationDelay:S,minimumUpdatePeriod:O}=s[0].attributes,q=Fn(s.filter(Io)).map(Ga),de=Fn(s.filter(ar)),Te=Fn(s.filter(Il)),Ie=s.map(ht=>ht.attributes.captionServices).filter(Boolean),ge={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:{AUDIO:{},VIDEO:{},["CLOSED-CAPTIONS"]:{},SUBTITLES:{}},uri:"",duration:f,playlists:Xi(q,r)};O>=0&&(ge.minimumUpdatePeriod=O*1e3),e&&(ge.locations=e),i&&(ge.contentSteering=i),y==="dynamic"&&(ge.suggestedPresentationDelay=S),c&&c.length>0&&(ge.eventStream=c);const je=ge.playlists.length===0,Ke=de.length?kr(de,r,je):null,Ye=Te.length?xi(Te,r):null,qe=q.concat(Ro(Ke),Ro(Ye)),at=qe.map(({timelineStarts:ht})=>ht);return ge.timelineStarts=bi(at),Ns(qe,ge.timelineStarts),Ke&&(ge.mediaGroups.AUDIO.audio=Ke),Ye&&(ge.mediaGroups.SUBTITLES.subs=Ye),Ie.length&&(ge.mediaGroups["CLOSED-CAPTIONS"].cc=Ir(Ie)),o?sr({oldManifest:o,newManifest:ge}):ge},Po=(s,e,i)=>{const{NOW:r,clientOffset:o,availabilityStartTime:c,timescale:f=1,periodStart:y=0,minimumUpdatePeriod:S=0}=s,O=(r+o)/1e3,q=c+y,Te=O+S-q;return Math.ceil((Te*f-e)/i)},Rr=(s,e)=>{const{type:i,minimumUpdatePeriod:r=0,media:o="",sourceDuration:c,timescale:f=1,startNumber:y=1,periodStart:S}=s,O=[];let q=-1;for(let de=0;de<e.length;de++){const Te=e[de],Ie=Te.d,ge=Te.r||0,je=Te.t||0;q<0&&(q=je),je&&je>q&&(q=je);let Ke;if(ge<0){const at=de+1;at===e.length?i==="dynamic"&&r>0&&o.indexOf("$Number$")>0?Ke=Po(s,q,Ie):Ke=(c*f-q)/Ie:Ke=(e[at].t-q)/Ie}else Ke=ge+1;const Ye=y+O.length+Ke;let qe=y+O.length;for(;qe<Ye;)O.push({number:qe,duration:Ie/f,time:q,timeline:S}),q+=Ie,qe++}return O},fa=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,Us=s=>(e,i,r,o)=>{if(e==="$$")return"$";if(typeof s[i]=="undefined")return e;const c=""+s[i];return i==="RepresentationID"||(r?o=parseInt(o,10):o=1,c.length>=o)?c:`${new Array(o-c.length+1).join("0")}${c}`},js=(s,e)=>s.replace(fa,Us(e)),fs=(s,e)=>!s.duration&&!e?[{number:s.startNumber||1,duration:s.sourceDuration,time:0,timeline:s.periodStart}]:s.duration?le(s):Rr(s,e),pa=(s,e)=>{const i={RepresentationID:s.id,Bandwidth:s.bandwidth||0},{initialization:r={sourceURL:"",range:""}}=s,o=dn({baseUrl:s.baseUrl,source:js(r.sourceURL,i),range:r.range});return fs(s,e).map(f=>{i.Number=f.number,i.Time=f.time;const y=js(s.media||"",i),S=s.timescale||1,O=s.presentationTimeOffset||0,q=s.periodStart+(f.time-O)/S;return{uri:y,timeline:f.timeline,duration:f.duration,resolvedUri:V(s.baseUrl||"",y),map:o,number:f.number,presentationTime:q}})},ps=(s,e)=>{const{baseUrl:i,initialization:r={}}=s,o=dn({baseUrl:i,source:r.sourceURL,range:r.range}),c=dn({baseUrl:i,source:e.media,range:e.mediaRange});return c.map=o,c},qa=(s,e)=>{const{duration:i,segmentUrls:r=[],periodStart:o}=s;if(!i&&!e||i&&e)throw new Error(Yi.SEGMENT_TIME_UNSPECIFIED);const c=r.map(S=>ps(s,S));let f;return i&&(f=le(s)),e&&(f=Rr(s,e)),f.map((S,O)=>{if(c[O]){const q=c[O],de=s.timescale||1,Te=s.presentationTimeOffset||0;return q.timeline=S.timeline,q.duration=S.duration,q.number=S.number,q.presentationTime=o+(S.time-Te)/de,q}}).filter(S=>S)},za=({attributes:s,segmentInfo:e})=>{let i,r;e.template?(r=pa,i=Ti(s,e.template)):e.base?(r=Se,i=Ti(s,e.base)):e.list&&(r=qa,i=Ti(s,e.list));const o={attributes:s};if(!r)return o;const c=r(i,e.segmentTimeline);if(i.duration){const{duration:f,timescale:y=1}=i;i.duration=f/y}else c.length?i.duration=c.reduce((f,y)=>Math.max(f,Math.ceil(y.duration)),0):i.duration=0;return o.attributes=i,o.segments=c,e.base&&i.indexRange&&(o.sidx=c[0],o.segments=[]),o},ms=s=>s.map(za),Ii=(s,e)=>Kr(s.childNodes).filter(({tagName:i})=>i===e),Un=s=>s.textContent.trim(),$s=s=>parseFloat(s.split("/").reduce((e,i)=>e/i)),yr=s=>{const e=365*24*60*60,i=30*24*60*60,r=24*60*60,o=60*60,c=60,y=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(s);if(!y)return 0;const[S,O,q,de,Te,Ie]=y.slice(1);return parseFloat(S||0)*e+parseFloat(O||0)*i+parseFloat(q||0)*r+parseFloat(de||0)*o+parseFloat(Te||0)*c+parseFloat(Ie||0)},Tn=s=>(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(s)&&(s+="Z"),Date.parse(s)),ma={mediaPresentationDuration(s){return yr(s)},availabilityStartTime(s){return Tn(s)/1e3},minimumUpdatePeriod(s){return yr(s)},suggestedPresentationDelay(s){return yr(s)},type(s){return s},timeShiftBufferDepth(s){return yr(s)},start(s){return yr(s)},width(s){return parseInt(s,10)},height(s){return parseInt(s,10)},bandwidth(s){return parseInt(s,10)},frameRate(s){return $s(s)},startNumber(s){return parseInt(s,10)},timescale(s){return parseInt(s,10)},presentationTimeOffset(s){return parseInt(s,10)},duration(s){const e=parseInt(s,10);return isNaN(e)?yr(s):e},d(s){return parseInt(s,10)},t(s){return parseInt(s,10)},r(s){return parseInt(s,10)},presentationTime(s){return parseInt(s,10)},DEFAULT(s){return s}},Hi=s=>s&&s.attributes?Kr(s.attributes).reduce((e,i)=>{const r=ma[i.name]||ma.DEFAULT;return e[i.name]=r(i.value),e},{}):{},Rl={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime","urn:mpeg:dash:mp4protection:2011":"mp4protection"},gs=(s,e)=>e.length?rr(s.map(function(i){return e.map(function(r){const o=Un(r),c=V(i.baseUrl,o),f=Ti(Hi(r),{baseUrl:c});return c!==o&&!f.serviceLocation&&i.serviceLocation&&(f.serviceLocation=i.serviceLocation),f})})):s,Vs=s=>{const e=Ii(s,"SegmentTemplate")[0],i=Ii(s,"SegmentList")[0],r=i&&Ii(i,"SegmentURL").map(de=>Ti({tag:"SegmentURL"},Hi(de))),o=Ii(s,"SegmentBase")[0],c=i||e,f=c&&Ii(c,"SegmentTimeline")[0],y=i||o||e,S=y&&Ii(y,"Initialization")[0],O=e&&Hi(e);O&&S?O.initialization=S&&Hi(S):O&&O.initialization&&(O.initialization={sourceURL:O.initialization});const q={template:O,segmentTimeline:f&&Ii(f,"S").map(de=>Hi(de)),list:i&&Ti(Hi(i),{segmentUrls:r,initialization:Hi(S)}),base:o&&Ti(Hi(o),{initialization:Hi(S)})};return Object.keys(q).forEach(de=>{q[de]||delete q[de]}),q},Oo=(s,e,i)=>r=>{const o=Ii(r,"BaseURL"),c=gs(e,o),f=Ti(s,Hi(r)),y=Vs(r);return c.map(S=>({segmentInfo:Ti(i,y),attributes:Ti(f,S)}))},Qi=s=>s.reduce((e,i)=>{const r=Hi(i);r.schemeIdUri&&(r.schemeIdUri=r.schemeIdUri.toLowerCase());const o=Rl[r.schemeIdUri];if(o){e[o]={attributes:r};const c=Ii(i,"cenc:pssh")[0];if(c){const f=Un(c);e[o].pssh=f&&Pn(f)}}return e},{}),Wa=s=>{if(s.schemeIdUri==="urn:scte:dash:cc:cea-608:2015")return(typeof s.value!="string"?[]:s.value.split(";")).map(i=>{let r,o;return o=i,/^CC\d=/.test(i)?[r,o]=i.split("="):/^CC\d$/.test(i)&&(r=i),{channel:r,language:o}});if(s.schemeIdUri==="urn:scte:dash:cc:cea-708:2015")return(typeof s.value!="string"?[]:s.value.split(";")).map(i=>{const r={channel:void 0,language:void 0,aspectRatio:1,easyReader:0,"3D":0};if(/=/.test(i)){const[o,c=""]=i.split("=");r.channel=o,r.language=i,c.split(",").forEach(f=>{const[y,S]=f.split(":");y==="lang"?r.language=S:y==="er"?r.easyReader=Number(S):y==="war"?r.aspectRatio=Number(S):y==="3D"&&(r["3D"]=Number(S))})}else r.language=i;return r.channel&&(r.channel="SERVICE"+r.channel),r})},fi=s=>rr(Ii(s.node,"EventStream").map(e=>{const i=Hi(e),r=i.schemeIdUri;return Ii(e,"Event").map(o=>{const c=Hi(o),f=c.presentationTime||0,y=i.timescale||1,S=c.duration||0,O=f/y+s.attributes.start;return{schemeIdUri:r,value:i.value,id:c.id,start:O,end:O+S/y,messageData:Un(o)||c.messageData,contentEncoding:i.contentEncoding,presentationTimeOffset:i.presentationTimeOffset||0}})})),qt=(s,e,i)=>r=>{const o=Hi(r),c=gs(e,Ii(r,"BaseURL")),f=Ii(r,"Role")[0],y={role:Hi(f)};let S=Ti(s,o,y);const O=Ii(r,"Accessibility")[0],q=Wa(Hi(O));q&&(S=Ti(S,{captionServices:q}));const de=Ii(r,"Label")[0];if(de&&de.childNodes.length){const Ke=de.childNodes[0].nodeValue.trim();S=Ti(S,{label:Ke})}const Te=Qi(Ii(r,"ContentProtection"));Object.keys(Te).length&&(S=Ti(S,{contentProtection:Te}));const Ie=Vs(r),ge=Ii(r,"Representation"),je=Ti(i,Ie);return rr(ge.map(Oo(S,c,je)))},Bo=(s,e)=>(i,r)=>{const o=gs(e,Ii(i.node,"BaseURL")),c=Ti(s,{periodStart:i.attributes.start});typeof i.attributes.duration=="number"&&(c.periodDuration=i.attributes.duration);const f=Ii(i.node,"AdaptationSet"),y=Vs(i.node);return rr(f.map(qt(c,o,y)))},Hs=(s,e)=>{if(s.length>1&&e({type:"warn",message:"The MPD manifest should contain no more than one ContentSteering tag"}),!s.length)return null;const i=Ti({serverURL:Un(s[0])},Hi(s[0]));return i.queryBeforeStart=i.queryBeforeStart==="true",i},ys=({attributes:s,priorPeriodAttributes:e,mpdType:i})=>typeof s.start=="number"?s.start:e&&typeof e.start=="number"&&typeof e.duration=="number"?e.start+e.duration:!e&&i==="static"?0:null,Mo=(s,e={})=>{const{manifestUri:i="",NOW:r=Date.now(),clientOffset:o=0,eventHandler:c=function(){}}=e,f=Ii(s,"Period");if(!f.length)throw new Error(Yi.INVALID_NUMBER_OF_PERIOD);const y=Ii(s,"Location"),S=Hi(s),O=gs([{baseUrl:i}],Ii(s,"BaseURL")),q=Ii(s,"ContentSteering");S.type=S.type||"static",S.sourceDuration=S.mediaPresentationDuration||0,S.NOW=r,S.clientOffset=o,y.length&&(S.locations=y.map(Un));const de=[];return f.forEach((Te,Ie)=>{const ge=Hi(Te),je=de[Ie-1];ge.start=ys({attributes:ge,priorPeriodAttributes:je?je.attributes:null,mpdType:S.type}),de.push({node:Te,attributes:ge})}),{locations:S.locations,contentSteeringInfo:Hs(q,c),representationInfo:rr(de.map(Bo(S,O))),eventStream:rr(de.map(fi))}},Ka=s=>{if(s==="")throw new Error(Yi.DASH_EMPTY_MANIFEST);const e=new Mt.DOMParser;let i,r;try{i=e.parseFromString(s,"application/xml"),r=i&&i.documentElement.tagName==="MPD"?i.documentElement:null}catch(o){}if(!r||r&&r.getElementsByTagName("parsererror").length>0)throw new Error(Yi.DASH_INVALID_XML);return r},vs=s=>{const e=Ii(s,"UTCTiming")[0];if(!e)return null;const i=Hi(e);switch(i.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":i.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":i.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":i.method="DIRECT",i.value=Date.parse(i.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(Yi.UNSUPPORTED_UTC_TIMING_SCHEME)}return i},Fo=null,Pl=(s,e={})=>{const i=Mo(Ka(s),e),r=ms(i.representationInfo);return ha({dashPlaylists:r,locations:i.locations,contentSteering:i.contentSteeringInfo,sidxMapping:e.sidxMapping,previousManifest:e.previousManifest,eventStream:i.eventStream})},Ol=s=>vs(Ka(s));var ga=mt(84221),Kn=mt.n(ga),Bl=wt([73,68,51]),Ya=function(e,i){i===void 0&&(i=0),e=wt(e);var r=e[i+5],o=e[i+6]<<21|e[i+7]<<14|e[i+8]<<7|e[i+9],c=(r&16)>>4;return c?o+20:o+10},As=function s(e,i){return i===void 0&&(i=0),e=wt(e),e.length-i<10||!rt(e,Bl,{offset:i})?i:(i+=Ya(e,i),s(e,i))},Xa=function(e){var i="",r=e[1]>>>3,o=e[1]&31,c=e[2]>>>7,f=(e[2]&64)>>6,y=(e[2]&32)>>5,S=(e[2]&16)>>4,O=(e[2]&8)>>3,q=(e[2]&4)>>2,de=e[2]&3;i+=r+"."+padStart(o,2,"0"),c===0?i+="M":c===1&&(i+="H");var Te;return r===2&&f?Te=y?12:10:Te=f?10:8,i+="."+padStart(Te,2,"0"),i+="."+S,i+="."+O+q+de,i},No=function(e){var i=toHexString(e[1]),r=toHexString(e[2]&252),o=toHexString(e[3]);return""+i+r+o},Qu=function(e){var i="",r=e[1]>>6,o=e[1]&31,c=(e[1]&32)>>5,f=e.subarray(2,6),y=e.subarray(6,12),S=e[12];r===1?i+="A":r===2?i+="B":r===3&&(i+="C"),i+=o+".";var O=parseInt(toBinaryString(f).split("").reverse().join(""),2);O>255&&(O=parseInt(toBinaryString(f),2)),i+=O.toString(16)+".",c===0?i+="L":i+="H",i+=S;for(var q="",de=0;de<y.length;de++){var Te=y[de];Te&&(q&&(q+="."),q+=Te.toString(16))}return q&&(i+="."+q),i},Ju=new Uint8Array([79,112,117,115,72,101,97,100]),Zu=function(e){var i=new DataView(e.buffer,e.byteOffset,e.byteLength),r=i.getUint8(0),o=r!==0,c={version:r,channels:i.getUint8(1),preSkip:i.getUint16(2,o),sampleRate:i.getUint32(4,o),outputGain:i.getUint16(8,o),channelMappingFamily:i.getUint8(10)};if(c.channelMappingFamily>0&&e.length>10){c.streamCount=i.getUint8(11),c.twoChannelStreamCount=i.getUint8(12),c.channelMapping=[];for(var f=0;f<c.channels;f++)c.channelMapping.push(i.getUint8(13+f))}return c},Uo=function(e){var i=e.channelMappingFamily<=0?11:12+e.channels,r=new DataView(new ArrayBuffer(i)),o=e.version!==0;return r.setUint8(0,e.version),r.setUint8(1,e.channels),r.setUint16(2,e.preSkip,o),r.setUint32(4,e.sampleRate,o),r.setUint16(8,e.outputGain,o),r.setUint8(10,e.channelMappingFamily),e.channelMappingFamily>0&&(r.setUint8(11,e.streamCount),e.channelMapping.foreach(function(c,f){r.setUint8(12+f,c)})),new Uint8Array(r.buffer)},Qa=function(e){return typeof e=="string"?Ze(e):(typeof e=="number",e)},ya=function(e){return Array.isArray(e)?e.map(function(i){return Qa(i)}):[Qa(e)]},Ja,_s=function(e){e=wt(e);for(var i=[],r=0;e.length>r;){var o=e[r],c=0,f=0;f++;var y=e[f];for(f++;y&128;)c=(y&127)<<7,y=e[f],f++;c+=y&127;for(var S=0;S<Ja.length;S++){var O=Ja[S],q=O.id,de=O.parser;if(o===q){i.push(de(e.subarray(f,f+c)));break}}r+=c+f}return i};Ja=[{id:3,parser:function(e){var i={tag:3,id:e[0]<<8|e[1],flags:e[2],size:3,dependsOnEsId:0,ocrEsId:0,descriptors:[],url:""};if(i.flags&128&&(i.dependsOnEsId=e[i.size]<<8|e[i.size+1],i.size+=2),i.flags&64){var r=e[i.size];i.url=Ms(e.subarray(i.size+1,i.size+1+r)),i.size+=r}return i.flags&32&&(i.ocrEsId=e[i.size]<<8|e[i.size+1],i.size+=2),i.descriptors=_s(e.subarray(i.size))||[],i}},{id:4,parser:function(e){var i={tag:4,oti:e[0],streamType:e[1],bufferSize:e[2]<<16|e[3]<<8|e[4],maxBitrate:e[5]<<24|e[6]<<16|e[7]<<8|e[8],avgBitrate:e[9]<<24|e[10]<<16|e[11]<<8|e[12],descriptors:_s(e.subarray(13))};return i}},{id:5,parser:function(e){return{tag:5,bytes:e}}},{id:6,parser:function(e){return{tag:6,bytes:e}}}];var _n=function s(e,i,r){r===void 0&&(r=!1),i=ya(i),e=wt(e);var o=[];if(!i.length)return o;for(var c=0;c<e.length;){var f=(e[c]<<24|e[c+1]<<16|e[c+2]<<8|e[c+3])>>>0,y=e.subarray(c+4,c+8);if(f===0)break;var S=c+f;if(S>e.length){if(r)break;S=e.length}var O=e.subarray(c+8,S);rt(y,i[0])&&(i.length===1?o.push(O):o.push.apply(o,s(O,i.slice(1),r))),c=S}return o},Xr=function(e,i){if(i=Qa(i),!i.length)return e.subarray(e.length);for(var r=0;r<e.length;){if(bytesMatch(e.subarray(r,r+i.length),i)){var o=(e[r-4]<<24|e[r-3]<<16|e[r-2]<<8|e[r-1])>>>0,c=o>1?r+o:e.byteLength;return e.subarray(r+4,c)}r++}return e.subarray(e.length)},or=function(e,i,r){i===void 0&&(i=4),r===void 0&&(r=function(S){return bytesToNumber(S)});var o=[];if(!e||!e.length)return o;for(var c=bytesToNumber(e.subarray(4,8)),f=8;c;f+=i,c--)o.push(r(e.subarray(f,f+i)));return o},jo=function(e,i){for(var r=or(_n(e,["stss"])[0]),o=or(_n(e,["stco"])[0]),c=or(_n(e,["stts"])[0],8,function(yi){return{sampleCount:bytesToNumber(yi.subarray(0,4)),sampleDelta:bytesToNumber(yi.subarray(4,8))}}),f=or(_n(e,["stsc"])[0],12,function(yi){return{firstChunk:bytesToNumber(yi.subarray(0,4)),samplesPerChunk:bytesToNumber(yi.subarray(4,8)),sampleDescriptionIndex:bytesToNumber(yi.subarray(8,12))}}),y=_n(e,["stsz"])[0],S=or(y&&y.length&&y.subarray(4)||null),O=[],q=0;q<o.length;q++){for(var de=void 0,Te=0;Te<f.length;Te++){var Ie=f[Te],ge=q+1>=Ie.firstChunk&&(Te+1>=f.length||q+1<f[Te+1].firstChunk);if(ge){de=Ie.samplesPerChunk;break}}for(var je=o[q],Ke=0;Ke<de;Ke++){var Ye=S[O.length],qe=!r.length;r.length&&r.indexOf(O.length+1)!==-1&&(qe=!0);for(var at={keyframe:qe,start:je,end:je+Ye},ht=0;ht<c.length;ht++){var Ue=c[ht],pt=Ue.sampleCount,Vt=Ue.sampleDelta;if(O.length<=pt){var Bt=O.length?O[O.length-1].timestamp:0;at.timestamp=Bt+Vt/i*1e3,at.duration=Vt;break}}O.push(at),je+=Ye}}return O},Za=function(e,i){var r=bytesToString(i.subarray(0,4));if(e.type==="video"?(e.info=e.info||{},e.info.width=i[28]<<8|i[29],e.info.height=i[30]<<8|i[31]):e.type==="audio"&&(e.info=e.info||{},e.info.channels=i[20]<<8|i[21],e.info.bitDepth=i[22]<<8|i[23],e.info.sampleRate=i[28]<<8|i[29]),r==="avc1"){var o=Xr(i,"avcC");r+="."+getAvcCodec(o),e.info.avcC=o}else if(r==="hvc1"||r==="hev1")r+="."+getHvcCodec(Xr(i,"hvcC"));else if(r==="mp4a"||r==="mp4v"){var c=Xr(i,"esds"),f=_s(c.subarray(4))[0],y=f&&f.descriptors.filter(function(qe){var at=qe.tag;return at===4})[0];y?(r+="."+toHexString(y.oti),y.oti===64?r+="."+(y.descriptors[0].bytes[0]>>3).toString():y.oti===32?r+="."+y.descriptors[0].bytes[4].toString():y.oti===221&&(r="vorbis")):e.type==="audio"?r+=".40.2":r+=".20.9"}else if(r==="av01")r+="."+getAv1Codec(Xr(i,"av1C"));else if(r==="vp09"){var S=Xr(i,"vpcC"),O=S[0],q=S[1],de=S[2]>>4,Te=(S[2]&15)>>1,Ie=(S[2]&15)>>3,ge=S[3],je=S[4],Ke=S[5];r+="."+padStart(O,2,"0"),r+="."+padStart(q,2,"0"),r+="."+padStart(de,2,"0"),r+="."+padStart(Te,2,"0"),r+="."+padStart(ge,2,"0"),r+="."+padStart(je,2,"0"),r+="."+padStart(Ke,2,"0"),r+="."+padStart(Ie,2,"0")}else if(r==="theo")r="theora";else if(r==="spex")r="speex";else if(r===".mp3")r="mp4a.40.34";else if(r==="msVo")r="vorbis";else if(r==="Opus"){r="opus";var Ye=Xr(i,"dOps");e.info.opus=parseOpusHead(Ye),e.info.codecDelay=65e5}else r=r.toLowerCase();e.codec=r},Ml=function(e,i){i===void 0&&(i=!0),e=toUint8(e);var r=_n(e,["moov","trak"],!0),o=[];return r.forEach(function(c){var f={bytes:c},y=_n(c,["mdia"])[0],S=_n(y,["hdlr"])[0],O=bytesToString(S.subarray(8,12));O==="soun"?f.type="audio":O==="vide"?f.type="video":f.type=O;var q=_n(c,["tkhd"])[0];if(q){var de=new DataView(q.buffer,q.byteOffset,q.byteLength),Te=de.getUint8(0);f.number=Te===0?de.getUint32(12):de.getUint32(20)}var Ie=_n(y,["mdhd"])[0];if(Ie){var ge=Ie[0],je=ge===0?12:20;f.timescale=(Ie[je]<<24|Ie[je+1]<<16|Ie[je+2]<<8|Ie[je+3])>>>0}for(var Ke=_n(y,["minf","stbl"])[0],Ye=_n(Ke,["stsd"])[0],qe=bytesToNumber(Ye.subarray(4,8)),at=8;qe--;){var ht=bytesToNumber(Ye.subarray(at,at+4)),Ue=Ye.subarray(at+4,at+4+ht);Za(f,Ue),at+=4+ht}i&&(f.frameTable=jo(Ke,f.timescale)),o.push(f)}),o},ed=function(e){var i=_n(e,["moov","mvhd"],!0)[0];if(!(!i||!i.length)){var r={};return i[0]===1?(r.timestampScale=bytesToNumber(i.subarray(20,24)),r.duration=bytesToNumber(i.subarray(24,32))):(r.timestampScale=bytesToNumber(i.subarray(12,16)),r.duration=bytesToNumber(i.subarray(16,20))),r.bytes=i,r}},Ri={EBML:wt([26,69,223,163]),DocType:wt([66,130]),Segment:wt([24,83,128,103]),SegmentInfo:wt([21,73,169,102]),Tracks:wt([22,84,174,107]),Track:wt([174]),TrackNumber:wt([215]),DefaultDuration:wt([35,227,131]),TrackEntry:wt([174]),TrackType:wt([131]),FlagDefault:wt([136]),CodecID:wt([134]),CodecPrivate:wt([99,162]),VideoTrack:wt([224]),AudioTrack:wt([225]),Cluster:wt([31,67,182,117]),Timestamp:wt([231]),TimestampScale:wt([42,215,177]),BlockGroup:wt([160]),BlockDuration:wt([155]),Block:wt([161]),SimpleBlock:wt([163])},eo=[128,64,32,16,8,4,2,1],Fl=function(e){for(var i=1,r=0;r<eo.length&&!(e&eo[r]);r++)i++;return i},Pr=function(e,i,r,o){r===void 0&&(r=!0),o===void 0&&(o=!1);var c=Fl(e[i]),f=e.subarray(i,i+c);return r&&(f=Array.prototype.slice.call(e,i,i+c),f[0]^=eo[c-1]),{length:c,value:cs(f,{signed:o}),bytes:f}},va=function s(e){return typeof e=="string"?e.match(/.{1,2}/g).map(function(i){return s(i)}):typeof e=="number"?nn(e):e},Nl=function(e){return Array.isArray(e)?e.map(function(i){return va(i)}):[va(e)]},Ul=function s(e,i,r){if(r>=i.length)return i.length;var o=Pr(i,r,!1);if(rt(e.bytes,o.bytes))return r;var c=Pr(i,r+o.length);return s(e,i,r+c.length+c.value+o.length)},Fi=function s(e,i){i=Nl(i),e=wt(e);var r=[];if(!i.length)return r;for(var o=0;o<e.length;){var c=Pr(e,o,!1),f=Pr(e,o+c.length),y=o+c.length+f.length;f.value===127&&(f.value=Ul(c,e,y),f.value!==e.length&&(f.value-=y));var S=y+f.value>e.length?e.length:y+f.value,O=e.subarray(y,S);rt(i[0],c.bytes)&&(i.length===1?r.push(O):r=r.concat(s(O,i.slice(1))));var q=c.length+f.length+O.length;o+=q}return r},jn=function(e,i,r,o){var c;i==="group"&&(c=Fi(e,[Ri.BlockDuration])[0],c&&(c=bytesToNumber(c),c=1/r*c*r/1e3),e=Fi(e,[Ri.Block])[0],i="block");var f=new DataView(e.buffer,e.byteOffset,e.byteLength),y=Pr(e,0),S=f.getInt16(y.length,!1),O=e[y.length+2],q=e.subarray(y.length+3),de=1/r*(o+S)*r/1e3,Te={duration:c,trackNumber:y.value,keyframe:i==="simple"&&O>>7==1,invisible:(O&8)>>3==1,lacing:(O&6)>>1,discardable:i==="simple"&&(O&1)==1,frames:[],pts:de,dts:de,timestamp:S};if(!Te.lacing)return Te.frames.push(q),Te;var Ie=q[0]+1,ge=[],je=1;if(Te.lacing===2)for(var Ke=(q.length-je)/Ie,Ye=0;Ye<Ie;Ye++)ge.push(Ke);if(Te.lacing===1)for(var qe=0;qe<Ie-1;qe++){var at=0;do at+=q[je],je++;while(q[je-1]===255);ge.push(at)}if(Te.lacing===3)for(var ht=0,Ue=0;Ue<Ie-1;Ue++){var pt=Ue===0?Pr(q,je):Pr(q,je,!0,!0);ht+=pt.value,ge.push(ht),je+=pt.length}return ge.forEach(function(Vt){Te.frames.push(q.subarray(je,je+Vt)),je+=Vt}),Te},$o=function(e){for(var i=0,r={};i<e.length;){var o=e[i]&127,c=e[i+1],f=void 0;c===1?f=e[i+2]:f=e.subarray(i+2,i+2+c),o===1?r.profile=f:o===2?r.level=f:o===3?r.bitDepth=f:o===4?r.chromaSubsampling=f:r[o]=f,i+=2+c}return r},Aa=function(e){e=toUint8(e);var i=[],r=Fi(e,[Ri.Segment,Ri.Tracks,Ri.Track]);return r.length||(r=Fi(e,[Ri.Tracks,Ri.Track])),r.length||(r=Fi(e,[Ri.Track])),r.length?(r.forEach(function(o){var c=Fi(o,Ri.TrackType)[0];if(!(!c||!c.length)){if(c[0]===1)c="video";else if(c[0]===2)c="audio";else if(c[0]===17)c="subtitle";else return;var f={rawCodec:bytesToString(Fi(o,[Ri.CodecID])[0]),type:c,codecPrivate:Fi(o,[Ri.CodecPrivate])[0],number:bytesToNumber(Fi(o,[Ri.TrackNumber])[0]),defaultDuration:bytesToNumber(Fi(o,[Ri.DefaultDuration])[0]),default:Fi(o,[Ri.FlagDefault])[0],rawData:o},y="";if(/V_MPEG4\/ISO\/AVC/.test(f.rawCodec))y="avc1."+getAvcCodec(f.codecPrivate);else if(/V_MPEGH\/ISO\/HEVC/.test(f.rawCodec))y="hev1."+getHvcCodec(f.codecPrivate);else if(/V_MPEG4\/ISO\/ASP/.test(f.rawCodec))f.codecPrivate?y="mp4v.20."+f.codecPrivate[4].toString():y="mp4v.20.9";else if(/^V_THEORA/.test(f.rawCodec))y="theora";else if(/^V_VP8/.test(f.rawCodec))y="vp8";else if(/^V_VP9/.test(f.rawCodec))if(f.codecPrivate){var S=$o(f.codecPrivate),O=S.profile,q=S.level,de=S.bitDepth,Te=S.chromaSubsampling;y="vp09.",y+=padStart(O,2,"0")+".",y+=padStart(q,2,"0")+".",y+=padStart(de,2,"0")+".",y+=""+padStart(Te,2,"0");var Ie=Fi(o,[224,[85,176],[85,177]])[0]||[],ge=Fi(o,[224,[85,176],[85,185]])[0]||[],je=Fi(o,[224,[85,176],[85,186]])[0]||[],Ke=Fi(o,[224,[85,176],[85,187]])[0]||[];(Ie.length||ge.length||je.length||Ke.length)&&(y+="."+padStart(Ke[0],2,"0"),y+="."+padStart(je[0],2,"0"),y+="."+padStart(Ie[0],2,"0"),y+="."+padStart(ge[0],2,"0"))}else y="vp9";else/^V_AV1/.test(f.rawCodec)?y="av01."+getAv1Codec(f.codecPrivate):/A_ALAC/.test(f.rawCodec)?y="alac":/A_MPEG\/L2/.test(f.rawCodec)?y="mp2":/A_MPEG\/L3/.test(f.rawCodec)?y="mp3":/^A_AAC/.test(f.rawCodec)?f.codecPrivate?y="mp4a.40."+(f.codecPrivate[0]>>>3).toString():y="mp4a.40.2":/^A_AC3/.test(f.rawCodec)?y="ac-3":/^A_PCM/.test(f.rawCodec)?y="pcm":/^A_MS\/ACM/.test(f.rawCodec)?y="speex":/^A_EAC3/.test(f.rawCodec)?y="ec-3":/^A_VORBIS/.test(f.rawCodec)?y="vorbis":/^A_FLAC/.test(f.rawCodec)?y="flac":/^A_OPUS/.test(f.rawCodec)&&(y="opus");f.codec=y,i.push(f)}}),i.sort(function(o,c){return o.number-c.number})):i},Gs=function(e,i){var r=[],o=Fi(e,[Ri.Segment])[0],c=Fi(o,[Ri.SegmentInfo,Ri.TimestampScale])[0];c&&c.length?c=bytesToNumber(c):c=1e6;var f=Fi(o,[Ri.Cluster]);return i||(i=Aa(o)),f.forEach(function(y,S){var O=Fi(y,[Ri.SimpleBlock]).map(function(Ie){return{type:"simple",data:Ie}}),q=Fi(y,[Ri.BlockGroup]).map(function(Ie){return{type:"group",data:Ie}}),de=Fi(y,[Ri.Timestamp])[0]||0;de&&de.length&&(de=bytesToNumber(de));var Te=O.concat(q).sort(function(Ie,ge){return Ie.data.byteOffset-ge.data.byteOffset});Te.forEach(function(Ie,ge){var je=jn(Ie.data,Ie.type,c,de);r.push(je)})}),{tracks:i,blocks:r}},_a=wt([0,0,0,1]),Vo=wt([0,0,1]),qs=wt([0,0,3]),bs=function(e){for(var i=[],r=1;r<e.length-2;)rt(e.subarray(r,r+3),qs)&&(i.push(r+2),r++),r++;if(i.length===0)return e;var o=e.length-i.length,c=new Uint8Array(o),f=0;for(r=0;r<o;f++,r++)f===i[0]&&(f++,i.shift()),c[r]=e[f];return c},to=function(e,i,r,o){o===void 0&&(o=Infinity),e=wt(e),r=[].concat(r);for(var c=0,f,y=0;c<e.length&&(y<o||f);){var S=void 0;if(rt(e.subarray(c),_a)?S=4:rt(e.subarray(c),Vo)&&(S=3),!S){c++;continue}if(y++,f)return bs(e.subarray(f,c));var O=void 0;i==="h264"?O=e[c+S]&31:i==="h265"&&(O=e[c+S]>>1&63),r.indexOf(O)!==-1&&(f=c+S),c+=S+(i==="h264"?1:2)}return e.subarray(0,0)},jl=function(e,i,r){return to(e,"h264",i,r)},ba=function(e,i,r){return to(e,"h265",i,r)},rn={webm:wt([119,101,98,109]),matroska:wt([109,97,116,114,111,115,107,97]),flac:wt([102,76,97,67]),ogg:wt([79,103,103,83]),ac3:wt([11,119]),riff:wt([82,73,70,70]),avi:wt([65,86,73]),wav:wt([87,65,86,69]),"3gp":wt([102,116,121,112,51,103]),mp4:wt([102,116,121,112]),fmp4:wt([115,116,121,112]),mov:wt([102,116,121,112,113,116]),moov:wt([109,111,111,118]),moof:wt([109,111,111,102])},Or={aac:function(e){var i=As(e);return rt(e,[255,16],{offset:i,mask:[255,22]})},mp3:function(e){var i=As(e);return rt(e,[255,2],{offset:i,mask:[255,6]})},webm:function(e){var i=Fi(e,[Ri.EBML,Ri.DocType])[0];return rt(i,rn.webm)},mkv:function(e){var i=Fi(e,[Ri.EBML,Ri.DocType])[0];return rt(i,rn.matroska)},mp4:function(e){if(Or["3gp"](e)||Or.mov(e))return!1;if(rt(e,rn.mp4,{offset:4})||rt(e,rn.fmp4,{offset:4})||rt(e,rn.moof,{offset:4})||rt(e,rn.moov,{offset:4}))return!0},mov:function(e){return rt(e,rn.mov,{offset:4})},"3gp":function(e){return rt(e,rn["3gp"],{offset:4})},ac3:function(e){var i=As(e);return rt(e,rn.ac3,{offset:i})},ts:function(e){if(e.length<189&&e.length>=1)return e[0]===71;for(var i=0;i+188<e.length&&i<188;){if(e[i]===71&&e[i+188]===71)return!0;i+=1}return!1},flac:function(e){var i=As(e);return rt(e,rn.flac,{offset:i})},ogg:function(e){return rt(e,rn.ogg)},avi:function(e){return rt(e,rn.riff)&&rt(e,rn.avi,{offset:8})},wav:function(e){return rt(e,rn.riff)&&rt(e,rn.wav,{offset:8})},h264:function(e){return jl(e,7,3).length},h265:function(e){return ba(e,[32,33],3).length}},io=Object.keys(Or).filter(function(s){return s!=="ts"&&s!=="h264"&&s!=="h265"}).concat(["ts","h264","h265"]);io.forEach(function(s){var e=Or[s];Or[s]=function(i){return e(wt(i))}});var zs=Or,Ji=function(e){e=wt(e);for(var i=0;i<io.length;i++){var r=io[i];if(zs[r](e))return r}return""},Yn=function(e){return _n(e,["moof"]).length>0},Qr=mt(51489);/**
 * @license
 * Video.js 8.17.2 <http://videojs.com/>
 * Copyright Brightcove, Inc. <https://www.brightcove.com/>
 * Available under Apache License Version 2.0
 * <https://github.com/videojs/video.js/blob/main/LICENSE>
 *
 * Includes vtt.js <https://github.com/mozilla/vtt.js>
 * Available under Apache License Version 2.0
 * <https://github.com/mozilla/vtt.js/blob/main/LICENSE>
 */var vr="8.17.2";const Sn={},Br=function(s,e){return Sn[s]=Sn[s]||[],e&&(Sn[s]=Sn[s].concat(e)),Sn[s]},Ho=function(s,e){Br(s,e)},Jr=function(s,e){const i=Br(s).indexOf(e);return i<=-1?!1:(Sn[s]=Sn[s].slice(),Sn[s].splice(i,1),!0)},$l=function(s,e){Br(s,[].concat(e).map(i=>{const r=(...o)=>(Jr(s,r),i(...o));return r}))},xa={prefixed:!0},Ea=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"]],xs=Ea[0];let Ws;for(let s=0;s<Ea.length;s++)if(Ea[s][1]in ve()){Ws=Ea[s];break}if(Ws){for(let s=0;s<Ws.length;s++)xa[xs[s]]=Ws[s];xa.prefixed=Ws[0]!==xs[0]}let Cn=[];const Ar=(s,e,i)=>(r,o,c)=>{const f=e.levels[o],y=new RegExp(`^(${f})$`);let S=s;if(r!=="log"&&c.unshift(r.toUpperCase()+":"),i&&(S=`%c${s}`,c.unshift(i)),c.unshift(S+":"),Cn){Cn.push([].concat(c));const q=Cn.length-1e3;Cn.splice(0,q>0?q:0)}if(!ne().console)return;let O=ne().console[r];!O&&r==="debug"&&(O=ne().console.info||ne().console.log),!(!O||!f||!y.test(r))&&O[Array.isArray(c)?"apply":"call"](ne().console,c)};function Zr(s,e=":",i=""){let r="info",o;function c(...f){o("log",r,f)}return o=Ar(s,c,i),c.createLogger=(f,y,S)=>{const O=y!==void 0?y:e,q=S!==void 0?S:i,de=`${s} ${O} ${f}`;return Zr(de,O,q)},c.createNewLogger=(f,y,S)=>Zr(f,y,S),c.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:r},c.level=f=>{if(typeof f=="string"){if(!c.levels.hasOwnProperty(f))throw new Error(`"${f}" in not a valid log level`);r=f}return r},c.history=()=>Cn?[].concat(Cn):[],c.history.filter=f=>(Cn||[]).filter(y=>new RegExp(`.*${f}.*`).test(y[0])),c.history.clear=()=>{Cn&&(Cn.length=0)},c.history.disable=()=>{Cn!==null&&(Cn.length=0,Cn=null)},c.history.enable=()=>{Cn===null&&(Cn=[])},c.error=(...f)=>o("error",r,f),c.warn=(...f)=>o("warn",r,f),c.debug=(...f)=>o("debug",r,f),c}const ci=Zr("VIDEOJS"),Xn=ci.createLogger,Es=Object.prototype.toString,Ts=function(s){return Jn(s)?Object.keys(s):[]};function Qn(s,e){Ts(s).forEach(i=>e(s[i],i))}function Go(s,e,i=0){return Ts(s).reduce((r,o)=>e(r,s[o],o),i)}function Jn(s){return!!s&&typeof s=="object"}function lr(s){return Jn(s)&&Es.call(s)==="[object Object]"&&s.constructor===Object}function Si(...s){const e={};return s.forEach(i=>{!i||Qn(i,(r,o)=>{if(!lr(r)){e[o]=r;return}lr(e[o])||(e[o]={}),e[o]=Si(e[o],r)})}),e}function sn(s={}){const e=[];for(const i in s)if(s.hasOwnProperty(i)){const r=s[i];e.push(r)}return e}function Mr(s,e,i,r=!0){const o=f=>Object.defineProperty(s,e,{value:f,enumerable:!0,writable:!0}),c={configurable:!0,enumerable:!0,get(){const f=i();return o(f),f}};return r&&(c.set=o),Object.defineProperty(s,e,c)}var Ta=Object.freeze({__proto__:null,each:Qn,reduce:Go,isObject:Jn,isPlain:lr,merge:Si,values:sn,defineLazyProperty:Mr});let Fr=!1,qo=null,oi=!1,Sa,$n=!1,ur=!1,Nr=!1,dr=!1,Ca=null,_r=null;const Vl=Boolean(ne().cast&&ne().cast.framework&&ne().cast.framework.CastReceiverContext);let zo=null,es=!1,br=!1,wa=!1,Ks=!1,Ys=!1,gn=!1,no=!1;const Xs=Boolean(jr()&&("ontouchstart"in ne()||ne().navigator.maxTouchPoints||ne().DocumentTouch&&ne().document instanceof ne().DocumentTouch)),Ur=ne().navigator&&ne().navigator.userAgentData;if(Ur&&Ur.platform&&Ur.brands&&(oi=Ur.platform==="Android",ur=Boolean(Ur.brands.find(s=>s.brand==="Microsoft Edge")),Nr=Boolean(Ur.brands.find(s=>s.brand==="Chromium")),dr=!ur&&Nr,Ca=_r=(Ur.brands.find(s=>s.brand==="Chromium")||{}).version||null,br=Ur.platform==="Windows"),!Nr){const s=ne().navigator&&ne().navigator.userAgent||"";Fr=/iPod/i.test(s),qo=function(){const e=s.match(/OS (\d+)_/i);return e&&e[1]?e[1]:null}(),oi=/Android/i.test(s),Sa=function(){const e=s.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;const i=e[1]&&parseFloat(e[1]),r=e[2]&&parseFloat(e[2]);return i&&r?parseFloat(e[1]+"."+e[2]):i||null}(),$n=/Firefox/i.test(s),ur=/Edg/i.test(s),Nr=/Chrome/i.test(s)||/CriOS/i.test(s),dr=!ur&&Nr,Ca=_r=function(){const e=s.match(/(Chrome|CriOS)\/(\d+)/);return e&&e[2]?parseFloat(e[2]):null}(),zo=function(){const e=/MSIE\s(\d+)\.\d/.exec(s);let i=e&&parseFloat(e[1]);return!i&&/Trident\/7.0/i.test(s)&&/rv:11.0/.test(s)&&(i=11),i}(),Ys=/Tizen/i.test(s),gn=/Web0S/i.test(s),no=Ys||gn,es=/Safari/i.test(s)&&!dr&&!oi&&!ur&&!no,br=/Windows/i.test(s),wa=/iPad/i.test(s)||es&&Xs&&!/iPhone/i.test(s),Ks=/iPhone/i.test(s)&&!wa}const an=Ks||wa||Fr,La=(es||an)&&!dr;var Da=Object.freeze({__proto__:null,get IS_IPOD(){return Fr},get IOS_VERSION(){return qo},get IS_ANDROID(){return oi},get ANDROID_VERSION(){return Sa},get IS_FIREFOX(){return $n},get IS_EDGE(){return ur},get IS_CHROMIUM(){return Nr},get IS_CHROME(){return dr},get CHROMIUM_VERSION(){return Ca},get CHROME_VERSION(){return _r},IS_CHROMECAST_RECEIVER:Vl,get IE_VERSION(){return zo},get IS_SAFARI(){return es},get IS_WINDOWS(){return br},get IS_IPAD(){return wa},get IS_IPHONE(){return Ks},get IS_TIZEN(){return Ys},get IS_WEBOS(){return gn},get IS_SMART_TV(){return no},TOUCH_ENABLED:Xs,IS_IOS:an,IS_ANY_SAFARI:La});function Wo(s){return typeof s=="string"&&Boolean(s.trim())}function st(s){if(s.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}function jr(){return ve()===ne().document}function ts(s){return Jn(s)&&s.nodeType===1}function Ko(){try{return ne().parent!==ne().self}catch(s){return!0}}function Yo(s){return function(e,i){if(!Wo(e))return ve()[s](null);Wo(i)&&(i=ve().querySelector(i));const r=ts(i)?i:ve();return r[s]&&r[s](e)}}function Xt(s="div",e={},i={},r){const o=ve().createElement(s);return Object.getOwnPropertyNames(e).forEach(function(c){const f=e[c];c==="textContent"?Vn(o,f):(o[c]!==f||c==="tabIndex")&&(o[c]=f)}),Object.getOwnPropertyNames(i).forEach(function(c){o.setAttribute(c,i[c])}),r&&He(o,r),o}function Vn(s,e){return typeof s.textContent=="undefined"?s.innerText=e:s.textContent=e,s}function Bn(s,e){e.firstChild?e.insertBefore(s,e.firstChild):e.appendChild(s)}function is(s,e){return st(e),s.classList.contains(e)}function $r(s,...e){return s.classList.add(...e.reduce((i,r)=>i.concat(r.split(/\s+/)),[])),s}function Qs(s,...e){return s?(s.classList.remove(...e.reduce((i,r)=>i.concat(r.split(/\s+/)),[])),s):(ci.warn("removeClass was called with an element that doesn't exist"),null)}function ka(s,e,i){return typeof i=="function"&&(i=i(s,e)),typeof i!="boolean"&&(i=void 0),e.split(/\s+/).forEach(r=>s.classList.toggle(r,i)),s}function Vr(s,e){Object.getOwnPropertyNames(e).forEach(function(i){const r=e[i];r===null||typeof r=="undefined"||r===!1?s.removeAttribute(i):s.setAttribute(i,r===!0?"":r)})}function cr(s){const e={},i=["autoplay","controls","playsinline","loop","muted","default","defaultMuted"];if(s&&s.attributes&&s.attributes.length>0){const r=s.attributes;for(let o=r.length-1;o>=0;o--){const c=r[o].name;let f=r[o].value;i.includes(c)&&(f=f!==null),e[c]=f}}return e}function Xo(s,e){return s.getAttribute(e)}function xr(s,e,i){s.setAttribute(e,i)}function E(s,e){s.removeAttribute(e)}function D(){ve().body.focus(),ve().onselectstart=function(){return!1}}function z(){ve().onselectstart=function(){return!0}}function x(s){if(s&&s.getBoundingClientRect&&s.parentNode){const e=s.getBoundingClientRect(),i={};return["bottom","height","left","right","top","width"].forEach(r=>{e[r]!==void 0&&(i[r]=e[r])}),i.height||(i.height=parseFloat(Et(s,"height"))),i.width||(i.width=parseFloat(Et(s,"width"))),i}}function P(s){if(!s||s&&!s.offsetParent)return{left:0,top:0,width:0,height:0};const e=s.offsetWidth,i=s.offsetHeight;let r=0,o=0;for(;s.offsetParent&&s!==ve()[xa.fullscreenElement];)r+=s.offsetLeft,o+=s.offsetTop,s=s.offsetParent;return{left:r,top:o,width:e,height:i}}function N(s,e){const i={x:0,y:0};if(an){let q=s;for(;q&&q.nodeName.toLowerCase()!=="html";){const de=Et(q,"transform");if(/^matrix/.test(de)){const Te=de.slice(7,-1).split(/,\s/).map(Number);i.x+=Te[4],i.y+=Te[5]}else if(/^matrix3d/.test(de)){const Te=de.slice(9,-1).split(/,\s/).map(Number);i.x+=Te[12],i.y+=Te[13]}if(q.assignedSlot&&q.assignedSlot.parentElement&&ne().WebKitCSSMatrix){const Te=ne().getComputedStyle(q.assignedSlot.parentElement).transform,Ie=new(ne()).WebKitCSSMatrix(Te);i.x+=Ie.m41,i.y+=Ie.m42}q=q.parentNode||q.host}}const r={},o=P(e.target),c=P(s),f=c.width,y=c.height;let S=e.offsetY-(c.top-o.top),O=e.offsetX-(c.left-o.left);return e.changedTouches&&(O=e.changedTouches[0].pageX-c.left,S=e.changedTouches[0].pageY+c.top,an&&(O-=i.x,S-=i.y)),r.y=1-Math.max(0,Math.min(1,S/y)),r.x=Math.max(0,Math.min(1,O/f)),r}function Z(s){return Jn(s)&&s.nodeType===3}function fe(s){for(;s.firstChild;)s.removeChild(s.firstChild);return s}function pe(s){return typeof s=="function"&&(s=s()),(Array.isArray(s)?s:[s]).map(e=>{if(typeof e=="function"&&(e=e()),ts(e)||Z(e))return e;if(typeof e=="string"&&/\S/.test(e))return ve().createTextNode(e)}).filter(e=>e)}function He(s,e){return pe(e).forEach(i=>s.appendChild(i)),s}function tt(s,e){return He(fe(s),e)}function vt(s){return s.button===void 0&&s.buttons===void 0||s.button===0&&s.buttons===void 0||s.type==="mouseup"&&s.button===0&&s.buttons===0||s.type==="mousedown"&&s.button===0&&s.buttons===0?!0:!(s.button!==0||s.buttons!==1)}const _t=Yo("querySelector"),Rt=Yo("querySelectorAll");function Et(s,e){if(!s||!e)return"";if(typeof ne().getComputedStyle=="function"){let i;try{i=ne().getComputedStyle(s)}catch(r){return""}return i?i.getPropertyValue(e)||i[e]:""}return""}function bt(s){[...ve().styleSheets].forEach(e=>{try{const i=[...e.cssRules].map(o=>o.cssText).join(""),r=ve().createElement("style");r.textContent=i,s.document.head.appendChild(r)}catch(i){const r=ve().createElement("link");r.rel="stylesheet",r.type=e.type,r.media=e.media.mediaText,r.href=e.href,s.document.head.appendChild(r)}})}var Ot=Object.freeze({__proto__:null,isReal:jr,isEl:ts,isInFrame:Ko,createEl:Xt,textContent:Vn,prependTo:Bn,hasClass:is,addClass:$r,removeClass:Qs,toggleClass:ka,setAttributes:Vr,getAttributes:cr,getAttribute:Xo,setAttribute:xr,removeAttribute:E,blockTextSelection:D,unblockTextSelection:z,getBoundingClientRect:x,findPosition:P,getPointerPosition:N,isTextNode:Z,emptyEl:fe,normalizeContent:pe,appendContent:He,insertContent:tt,isSingleLeftClick:vt,$:_t,$$:Rt,computedStyle:Et,copyStyleSheetsToWindow:bt});let Zt=!1,Gi;const qi=function(){if(Gi.options.autoSetup===!1)return;const s=Array.prototype.slice.call(ve().getElementsByTagName("video")),e=Array.prototype.slice.call(ve().getElementsByTagName("audio")),i=Array.prototype.slice.call(ve().getElementsByTagName("video-js")),r=s.concat(e,i);if(r&&r.length>0)for(let o=0,c=r.length;o<c;o++){const f=r[o];if(f&&f.getAttribute)f.player===void 0&&f.getAttribute("data-setup")!==null&&Gi(f);else{vi(1);break}}else Zt||vi(1)};function vi(s,e){!jr()||(e&&(Gi=e),ne().setTimeout(qi,s))}function hr(){Zt=!0,ne().removeEventListener("load",hr)}jr()&&(ve().readyState==="complete"?hr():ne().addEventListener("load",hr));const Er=function(s){const e=ve().createElement("style");return e.className=s,e},ns=function(s,e){s.styleSheet?s.styleSheet.cssText=e:s.textContent=e};var Zi=new WeakMap;let Oc=3;function Ci(){return Oc++}function rs(s,e){if(!Zi.has(s))return;const i=Zi.get(s);i.handlers[e].length===0&&(delete i.handlers[e],s.removeEventListener?s.removeEventListener(e,i.dispatcher,!1):s.detachEvent&&s.detachEvent("on"+e,i.dispatcher)),Object.getOwnPropertyNames(i.handlers).length<=0&&(delete i.handlers,delete i.dispatcher,delete i.disabled),Object.getOwnPropertyNames(i).length===0&&Zi.delete(s)}function ro(s,e,i,r){i.forEach(function(o){s(e,o,r)})}function Qo(s){if(s.fixed_)return s;function e(){return!0}function i(){return!1}if(!s||!s.isPropagationStopped||!s.isImmediatePropagationStopped){const r=s||ne().event;s={};const o=["layerX","layerY","keyLocation","path","webkitMovementX","webkitMovementY","mozPressure","mozInputSource"];for(const c in r)o.includes(c)||c==="returnValue"&&r.preventDefault||(s[c]=r[c]);if(s.target||(s.target=s.srcElement||ve()),s.relatedTarget||(s.relatedTarget=s.fromElement===s.target?s.toElement:s.fromElement),s.preventDefault=function(){r.preventDefault&&r.preventDefault(),s.returnValue=!1,r.returnValue=!1,s.defaultPrevented=!0},s.defaultPrevented=!1,s.stopPropagation=function(){r.stopPropagation&&r.stopPropagation(),s.cancelBubble=!0,r.cancelBubble=!0,s.isPropagationStopped=e},s.isPropagationStopped=i,s.stopImmediatePropagation=function(){r.stopImmediatePropagation&&r.stopImmediatePropagation(),s.isImmediatePropagationStopped=e,s.stopPropagation()},s.isImmediatePropagationStopped=i,s.clientX!==null&&s.clientX!==void 0){const c=ve().documentElement,f=ve().body;s.pageX=s.clientX+(c&&c.scrollLeft||f&&f.scrollLeft||0)-(c&&c.clientLeft||f&&f.clientLeft||0),s.pageY=s.clientY+(c&&c.scrollTop||f&&f.scrollTop||0)-(c&&c.clientTop||f&&f.clientTop||0)}s.which=s.charCode||s.keyCode,s.button!==null&&s.button!==void 0&&(s.button=s.button&1?0:s.button&4?1:s.button&2?2:0)}return s.fixed_=!0,s}let Jo;const Zo=function(){if(typeof Jo!="boolean"){Jo=!1;try{const s=Object.defineProperty({},"passive",{get(){Jo=!0}});ne().addEventListener("test",null,s),ne().removeEventListener("test",null,s)}catch(s){}}return Jo},Gl=["touchstart","touchmove"];function yn(s,e,i){if(Array.isArray(e))return ro(yn,s,e,i);Zi.has(s)||Zi.set(s,{});const r=Zi.get(s);if(r.handlers||(r.handlers={}),r.handlers[e]||(r.handlers[e]=[]),i.guid||(i.guid=Ci()),r.handlers[e].push(i),r.dispatcher||(r.disabled=!1,r.dispatcher=function(o,c){if(r.disabled)return;o=Qo(o);const f=r.handlers[o.type];if(f){const y=f.slice(0);for(let S=0,O=y.length;S<O&&!o.isImmediatePropagationStopped();S++)try{y[S].call(s,o,c)}catch(q){ci.error(q)}}}),r.handlers[e].length===1)if(s.addEventListener){let o=!1;Zo()&&Gl.indexOf(e)>-1&&(o={passive:!0}),s.addEventListener(e,r.dispatcher,o)}else s.attachEvent&&s.attachEvent("on"+e,r.dispatcher)}function wn(s,e,i){if(!Zi.has(s))return;const r=Zi.get(s);if(!r.handlers)return;if(Array.isArray(e))return ro(wn,s,e,i);const o=function(f,y){r.handlers[y]=[],rs(f,y)};if(e===void 0){for(const f in r.handlers)Object.prototype.hasOwnProperty.call(r.handlers||{},f)&&o(s,f);return}const c=r.handlers[e];if(!!c){if(!i){o(s,e);return}if(i.guid)for(let f=0;f<c.length;f++)c[f].guid===i.guid&&c.splice(f--,1);rs(s,e)}}function Js(s,e,i){const r=Zi.has(s)?Zi.get(s):{},o=s.parentNode||s.ownerDocument;if(typeof e=="string"?e={type:e,target:s}:e.target||(e.target=s),e=Qo(e),r.dispatcher&&r.dispatcher.call(s,e,i),o&&!e.isPropagationStopped()&&e.bubbles===!0)Js.call(null,o,e,i);else if(!o&&!e.defaultPrevented&&e.target&&e.target[e.type]){Zi.has(e.target)||Zi.set(e.target,{});const c=Zi.get(e.target);e.target[e.type]&&(c.disabled=!0,typeof e.target[e.type]=="function"&&e.target[e.type](),c.disabled=!1)}return!e.defaultPrevented}function Tr(s,e,i){if(Array.isArray(e))return ro(Tr,s,e,i);const r=function(){wn(s,e,r),i.apply(this,arguments)};r.guid=i.guid=i.guid||Ci(),yn(s,e,r)}function Ge(s,e,i){const r=function(){wn(s,e,r),i.apply(this,arguments)};r.guid=i.guid=i.guid||Ci(),yn(s,e,r)}var td=Object.freeze({__proto__:null,fixEvent:Qo,on:yn,off:wn,trigger:Js,one:Tr,any:Ge});const Hn=30,Ni=function(s,e,i){e.guid||(e.guid=Ci());const r=e.bind(s);return r.guid=i?i+"_"+e.guid:e.guid,r},Gn=function(s,e){let i=ne().performance.now();return function(...o){const c=ne().performance.now();c-i>=e&&(s(...o),i=c)}},id=function(s,e,i,r=ne()){let o;const c=()=>{r.clearTimeout(o),o=null},f=function(){const y=this,S=arguments;let O=function(){o=null,O=null,i||s.apply(y,S)};!o&&i&&s.apply(y,S),r.clearTimeout(o),o=r.setTimeout(O,e)};return f.cancel=c,f};var Bc=Object.freeze({__proto__:null,UPDATE_REFRESH_INTERVAL:Hn,bind_:Ni,throttle:Gn,debounce:id});let Ia;class Zn{on(e,i){const r=this.addEventListener;this.addEventListener=()=>{},yn(this,e,i),this.addEventListener=r}off(e,i){wn(this,e,i)}one(e,i){const r=this.addEventListener;this.addEventListener=()=>{},Tr(this,e,i),this.addEventListener=r}any(e,i){const r=this.addEventListener;this.addEventListener=()=>{},Ge(this,e,i),this.addEventListener=r}trigger(e){const i=e.type||e;typeof e=="string"&&(e={type:i}),e=Qo(e),this.allowedEvents_[i]&&this["on"+i]&&this["on"+i](e),Js(this,e)}queueTrigger(e){Ia||(Ia=new Map);const i=e.type||e;let r=Ia.get(this);r||(r=new Map,Ia.set(this,r));const o=r.get(i);r.delete(i),ne().clearTimeout(o);const c=ne().setTimeout(()=>{r.delete(i),r.size===0&&(r=null,Ia.delete(this)),this.trigger(e)},0);r.set(i,c)}}Zn.prototype.allowedEvents_={},Zn.prototype.addEventListener=Zn.prototype.on,Zn.prototype.removeEventListener=Zn.prototype.off,Zn.prototype.dispatchEvent=Zn.prototype.trigger;const el=s=>typeof s.name=="function"?s.name():typeof s.name=="string"?s.name:s.name_?s.name_:s.constructor&&s.constructor.name?s.constructor.name:typeof s,qn=s=>s instanceof Zn||!!s.eventBusEl_&&["on","one","off","trigger"].every(e=>typeof s[e]=="function"),ql=(s,e)=>{qn(s)?e():(s.eventedCallbacks||(s.eventedCallbacks=[]),s.eventedCallbacks.push(e))},Ra=s=>typeof s=="string"&&/\S/.test(s)||Array.isArray(s)&&!!s.length,Mn=(s,e,i)=>{if(!s||!s.nodeName&&!qn(s))throw new Error(`Invalid target for ${el(e)}#${i}; must be a DOM node or evented object.`)},nd=(s,e,i)=>{if(!Ra(s))throw new Error(`Invalid event type for ${el(e)}#${i}; must be a non-empty string or array.`)},zl=(s,e,i)=>{if(typeof s!="function")throw new Error(`Invalid listener for ${el(e)}#${i}; must be a function.`)},tl=(s,e,i)=>{const r=e.length<3||e[0]===s||e[0]===s.eventBusEl_;let o,c,f;return r?(o=s.eventBusEl_,e.length>=3&&e.shift(),[c,f]=e):[o,c,f]=e,Mn(o,s,i),nd(c,s,i),zl(f,s,i),f=Ni(s,f),{isTargetingSelf:r,target:o,type:c,listener:f}},Ss=(s,e,i,r)=>{Mn(s,s,e),s.nodeName?td[e](s,i,r):s[e](i,r)},Mc={on(...s){const{isTargetingSelf:e,target:i,type:r,listener:o}=tl(this,s,"on");if(Ss(i,"on",r,o),!e){const c=()=>this.off(i,r,o);c.guid=o.guid;const f=()=>this.off("dispose",c);f.guid=o.guid,Ss(this,"on","dispose",c),Ss(i,"on","dispose",f)}},one(...s){const{isTargetingSelf:e,target:i,type:r,listener:o}=tl(this,s,"one");if(e)Ss(i,"one",r,o);else{const c=(...f)=>{this.off(i,r,c),o.apply(null,f)};c.guid=o.guid,Ss(i,"one",r,c)}},any(...s){const{isTargetingSelf:e,target:i,type:r,listener:o}=tl(this,s,"any");if(e)Ss(i,"any",r,o);else{const c=(...f)=>{this.off(i,r,c),o.apply(null,f)};c.guid=o.guid,Ss(i,"any",r,c)}},off(s,e,i){if(!s||Ra(s))wn(this.eventBusEl_,s,e);else{const r=s,o=e;Mn(r,this,"off"),nd(o,this,"off"),zl(i,this,"off"),i=Ni(this,i),this.off("dispose",i),r.nodeName?(wn(r,o,i),wn(r,"dispose",i)):qn(r)&&(r.off(o,i),r.off("dispose",i))}},trigger(s,e){Mn(this.eventBusEl_,this,"trigger");const i=s&&typeof s!="string"?s.type:s;if(!Ra(i))throw new Error(`Invalid event type for ${el(this)}#trigger; must be a non-empty string or object with a type key that has a non-empty value.`);return Js(this.eventBusEl_,s,e)}};function Wl(s,e={}){const{eventBusKey:i}=e;if(i){if(!s[i].nodeName)throw new Error(`The eventBusKey "${i}" does not refer to an element.`);s.eventBusEl_=s[i]}else s.eventBusEl_=Xt("span",{className:"vjs-event-bus"});return Object.assign(s,Mc),s.eventedCallbacks&&s.eventedCallbacks.forEach(r=>{r()}),s.on("dispose",()=>{s.off(),[s,s.el_,s.eventBusEl_].forEach(function(r){r&&Zi.has(r)&&Zi.delete(r)}),ne().setTimeout(()=>{s.eventBusEl_=null},0)}),s}const rd={state:{},setState(s){typeof s=="function"&&(s=s());let e;return Qn(s,(i,r)=>{this.state[r]!==i&&(e=e||{},e[r]={from:this.state[r],to:i}),this.state[r]=i}),e&&qn(this)&&this.trigger({changes:e,type:"statechanged"}),e}};function Hr(s,e){return Object.assign(s,rd),s.state=Object.assign({},s.state,e),typeof s.handleStateChanged=="function"&&qn(s)&&s.on("statechanged",s.handleStateChanged),s}const Cs=function(s){return typeof s!="string"?s:s.replace(/./,e=>e.toLowerCase())},zi=function(s){return typeof s!="string"?s:s.replace(/./,e=>e.toUpperCase())},sd=function(s,e){return zi(s)===zi(e)};var Kl=Object.freeze({__proto__:null,toLowerCase:Cs,toTitleCase:zi,titleCaseEquals:sd});class et{constructor(e,i,r){if(!e&&this.play?this.player_=e=this:this.player_=e,this.isDisposed_=!1,this.parentComponent_=null,this.options_=Si({},this.options_),i=this.options_=Si(this.options_,i),this.id_=i.id||i.el&&i.el.id,!this.id_){const o=e&&e.id&&e.id()||"no_player";this.id_=`${o}_component_${Ci()}`}this.name_=i.name||null,i.el?this.el_=i.el:i.createEl!==!1&&(this.el_=this.createEl()),i.className&&this.el_&&i.className.split(" ").forEach(o=>this.addClass(o)),["on","off","one","any","trigger"].forEach(o=>{this[o]=void 0}),i.evented!==!1&&(Wl(this,{eventBusKey:this.el_?"el_":null}),this.handleLanguagechange=this.handleLanguagechange.bind(this),this.on(this.player_,"languagechange",this.handleLanguagechange)),Hr(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Set,this.setIntervalIds_=new Set,this.rafIds_=new Set,this.namedRafs_=new Map,this.clearingTimersOnDispose_=!1,i.initChildren!==!1&&this.initChildren(),this.ready(r),i.reportTouchActivity!==!1&&this.enableTouchActivity()}on(e,i){}off(e,i){}one(e,i){}any(e,i){}trigger(e,i){}dispose(e={}){if(!this.isDisposed_){if(this.readyQueue_&&(this.readyQueue_.length=0),this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(let i=this.children_.length-1;i>=0;i--)this.children_[i].dispose&&this.children_[i].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&(e.restoreEl?this.el_.parentNode.replaceChild(e.restoreEl,this.el_):this.el_.parentNode.removeChild(this.el_)),this.el_=null),this.player_=null}}isDisposed(){return Boolean(this.isDisposed_)}player(){return this.player_}options(e){return e?(this.options_=Si(this.options_,e),this.options_):this.options_}el(){return this.el_}createEl(e,i,r){return Xt(e,i,r)}localize(e,i,r=e){const o=this.player_.language&&this.player_.language(),c=this.player_.languages&&this.player_.languages(),f=c&&c[o],y=o&&o.split("-")[0],S=c&&c[y];let O=r;return f&&f[e]?O=f[e]:S&&S[e]&&(O=S[e]),i&&(O=O.replace(/\{(\d+)\}/g,function(q,de){const Te=i[de-1];let Ie=Te;return typeof Te=="undefined"&&(Ie=q),Ie})),O}handleLanguagechange(){}contentEl(){return this.contentEl_||this.el_}id(){return this.id_}name(){return this.name_}children(){return this.children_}getChildById(e){return this.childIndex_[e]}getChild(e){if(!!e)return this.childNameIndex_[e]}getDescendant(...e){e=e.reduce((r,o)=>r.concat(o),[]);let i=this;for(let r=0;r<e.length;r++)if(i=i.getChild(e[r]),!i||!i.getChild)return;return i}setIcon(e,i=this.el()){if(!this.player_.options_.experimentalSvgIcons)return;const r="http://www.w3.org/2000/svg",o=Xt("span",{className:"vjs-icon-placeholder vjs-svg-icon"},{"aria-hidden":"true"}),c=ve().createElementNS(r,"svg");c.setAttributeNS(null,"viewBox","0 0 512 512");const f=ve().createElementNS(r,"use");return c.appendChild(f),f.setAttributeNS(null,"href",`#vjs-icon-${e}`),o.appendChild(c),this.iconIsSet_?i.replaceChild(o,i.querySelector(".vjs-icon-placeholder")):i.appendChild(o),this.iconIsSet_=!0,o}addChild(e,i={},r=this.children_.length){let o,c;if(typeof e=="string"){c=zi(e);const f=i.componentClass||c;i.name=c;const y=et.getComponent(f);if(!y)throw new Error(`Component ${f} does not exist`);if(typeof y!="function")return null;o=new y(this.player_||this,i)}else o=e;if(o.parentComponent_&&o.parentComponent_.removeChild(o),this.children_.splice(r,0,o),o.parentComponent_=this,typeof o.id=="function"&&(this.childIndex_[o.id()]=o),c=c||o.name&&zi(o.name()),c&&(this.childNameIndex_[c]=o,this.childNameIndex_[Cs(c)]=o),typeof o.el=="function"&&o.el()){let f=null;this.children_[r+1]&&(this.children_[r+1].el_?f=this.children_[r+1].el_:ts(this.children_[r+1])&&(f=this.children_[r+1])),this.contentEl().insertBefore(o.el(),f)}return o}removeChild(e){if(typeof e=="string"&&(e=this.getChild(e)),!e||!this.children_)return;let i=!1;for(let o=this.children_.length-1;o>=0;o--)if(this.children_[o]===e){i=!0,this.children_.splice(o,1);break}if(!i)return;e.parentComponent_=null,this.childIndex_[e.id()]=null,this.childNameIndex_[zi(e.name())]=null,this.childNameIndex_[Cs(e.name())]=null;const r=e.el();r&&r.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}initChildren(){const e=this.options_.children;if(e){const i=this.options_,r=f=>{const y=f.name;let S=f.opts;if(i[y]!==void 0&&(S=i[y]),S===!1)return;S===!0&&(S={}),S.playerOptions=this.options_.playerOptions;const O=this.addChild(y,S);O&&(this[y]=O)};let o;const c=et.getComponent("Tech");Array.isArray(e)?o=e:o=Object.keys(e),o.concat(Object.keys(this.options_).filter(function(f){return!o.some(function(y){return typeof y=="string"?f===y:f===y.name})})).map(f=>{let y,S;return typeof f=="string"?(y=f,S=e[y]||this.options_[y]||{}):(y=f.name,S=f),{name:y,opts:S}}).filter(f=>{const y=et.getComponent(f.opts.componentClass||zi(f.name));return y&&!c.isTech(y)}).forEach(r)}}buildCSSClass(){return""}ready(e,i=!1){if(!!e){if(!this.isReady_){this.readyQueue_=this.readyQueue_||[],this.readyQueue_.push(e);return}i?e.call(this):this.setTimeout(e,1)}}triggerReady(){this.isReady_=!0,this.setTimeout(function(){const e=this.readyQueue_;this.readyQueue_=[],e&&e.length>0&&e.forEach(function(i){i.call(this)},this),this.trigger("ready")},1)}$(e,i){return _t(e,i||this.contentEl())}$$(e,i){return Rt(e,i||this.contentEl())}hasClass(e){return is(this.el_,e)}addClass(...e){$r(this.el_,...e)}removeClass(...e){Qs(this.el_,...e)}toggleClass(e,i){ka(this.el_,e,i)}show(){this.removeClass("vjs-hidden")}hide(){this.addClass("vjs-hidden")}lockShowing(){this.addClass("vjs-lock-showing")}unlockShowing(){this.removeClass("vjs-lock-showing")}getAttribute(e){return Xo(this.el_,e)}setAttribute(e,i){xr(this.el_,e,i)}removeAttribute(e){E(this.el_,e)}width(e,i){return this.dimension("width",e,i)}height(e,i){return this.dimension("height",e,i)}dimensions(e,i){this.width(e,!0),this.height(i)}dimension(e,i,r){if(i!==void 0){(i===null||i!==i)&&(i=0),(""+i).indexOf("%")!==-1||(""+i).indexOf("px")!==-1?this.el_.style[e]=i:i==="auto"?this.el_.style[e]="":this.el_.style[e]=i+"px",r||this.trigger("componentresize");return}if(!this.el_)return 0;const o=this.el_.style[e],c=o.indexOf("px");return parseInt(c!==-1?o.slice(0,c):this.el_["offset"+zi(e)],10)}currentDimension(e){let i=0;if(e!=="width"&&e!=="height")throw new Error("currentDimension only accepts width or height value");if(i=Et(this.el_,e),i=parseFloat(i),i===0||isNaN(i)){const r=`offset${zi(e)}`;i=this.el_[r]}return i}currentDimensions(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}}currentWidth(){return this.currentDimension("width")}currentHeight(){return this.currentDimension("height")}getPositions(){const e=this.el_.getBoundingClientRect(),i={x:e.x,y:e.y,width:e.width,height:e.height,top:e.top,right:e.right,bottom:e.bottom,left:e.left},r={x:e.left+e.width/2,y:e.top+e.height/2,width:0,height:0,top:e.top+e.height/2,right:e.left+e.width/2,bottom:e.top+e.height/2,left:e.left+e.width/2};return{boundingClientRect:i,center:r}}focus(){this.el_.focus()}blur(){this.el_.blur()}handleKeyDown(e){this.player_&&(e.key!=="Tab"&&!(this.player_.options_.playerOptions.spatialNavigation&&this.player_.options_.playerOptions.spatialNavigation.enabled)&&e.stopPropagation(),this.player_.handleKeyDown(e))}handleKeyPress(e){this.handleKeyDown(e)}emitTapEvents(){let e=0,i=null;const r=10,o=200;let c;this.on("touchstart",function(y){y.touches.length===1&&(i={pageX:y.touches[0].pageX,pageY:y.touches[0].pageY},e=ne().performance.now(),c=!0)}),this.on("touchmove",function(y){if(y.touches.length>1)c=!1;else if(i){const S=y.touches[0].pageX-i.pageX,O=y.touches[0].pageY-i.pageY;Math.sqrt(S*S+O*O)>r&&(c=!1)}});const f=function(){c=!1};this.on("touchleave",f),this.on("touchcancel",f),this.on("touchend",function(y){i=null,c===!0&&ne().performance.now()-e<o&&(y.preventDefault(),this.trigger("tap"))})}enableTouchActivity(){if(!this.player()||!this.player().reportUserActivity)return;const e=Ni(this.player(),this.player().reportUserActivity);let i;this.on("touchstart",function(){e(),this.clearInterval(i),i=this.setInterval(e,250)});const r=function(o){e(),this.clearInterval(i)};this.on("touchmove",e),this.on("touchend",r),this.on("touchcancel",r)}setTimeout(e,i){var r;return e=Ni(this,e),this.clearTimersOnDispose_(),r=ne().setTimeout(()=>{this.setTimeoutIds_.has(r)&&this.setTimeoutIds_.delete(r),e()},i),this.setTimeoutIds_.add(r),r}clearTimeout(e){return this.setTimeoutIds_.has(e)&&(this.setTimeoutIds_.delete(e),ne().clearTimeout(e)),e}setInterval(e,i){e=Ni(this,e),this.clearTimersOnDispose_();const r=ne().setInterval(e,i);return this.setIntervalIds_.add(r),r}clearInterval(e){return this.setIntervalIds_.has(e)&&(this.setIntervalIds_.delete(e),ne().clearInterval(e)),e}requestAnimationFrame(e){this.clearTimersOnDispose_();var i;return e=Ni(this,e),i=ne().requestAnimationFrame(()=>{this.rafIds_.has(i)&&this.rafIds_.delete(i),e()}),this.rafIds_.add(i),i}requestNamedAnimationFrame(e,i){if(this.namedRafs_.has(e))return;this.clearTimersOnDispose_(),i=Ni(this,i);const r=this.requestAnimationFrame(()=>{i(),this.namedRafs_.has(e)&&this.namedRafs_.delete(e)});return this.namedRafs_.set(e,r),e}cancelNamedAnimationFrame(e){!this.namedRafs_.has(e)||(this.cancelAnimationFrame(this.namedRafs_.get(e)),this.namedRafs_.delete(e))}cancelAnimationFrame(e){return this.rafIds_.has(e)&&(this.rafIds_.delete(e),ne().cancelAnimationFrame(e)),e}clearTimersOnDispose_(){this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",()=>{[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(([e,i])=>{this[e].forEach((r,o)=>this[i](o))}),this.clearingTimersOnDispose_=!1}))}getIsDisabled(){return Boolean(this.el_.disabled)}getIsExpresslyInert(){return this.el_.inert&&!this.el_.ownerDocument.documentElement.inert}getIsFocusable(e){return(e||this.el_).tabIndex>=0&&!(this.getIsDisabled()||this.getIsExpresslyInert())}getIsAvailableToBeFocused(e){function i(c){const f=ne().getComputedStyle(c,null),y=f.getPropertyValue("visibility");return f.getPropertyValue("display")!=="none"&&!["hidden","collapse"].includes(y)}function r(c){return!(!i(c.parentElement)||!i(c)||c.style.opacity==="0"||ne().getComputedStyle(c).height==="0px"||ne().getComputedStyle(c).width==="0px")}function o(c){if(c.offsetWidth+c.offsetHeight+c.getBoundingClientRect().height+c.getBoundingClientRect().width===0)return!1;const f={x:c.getBoundingClientRect().left+c.offsetWidth/2,y:c.getBoundingClientRect().top+c.offsetHeight/2};if(f.x<0||f.x>(ve().documentElement.clientWidth||ne().innerWidth)||f.y<0||f.y>(ve().documentElement.clientHeight||ne().innerHeight))return!1;let y=ve().elementFromPoint(f.x,f.y);for(;y;){if(y===c)return!0;if(y.parentNode)y=y.parentNode;else return!1}}return e||(e=this.el()),!!(o(e)&&r(e)&&(!e.parentElement||e.tabIndex>=0))}static registerComponent(e,i){if(typeof e!="string"||!e)throw new Error(`Illegal component name, "${e}"; must be a non-empty string.`);const r=et.getComponent("Tech"),o=r&&r.isTech(i),c=et===i||et.prototype.isPrototypeOf(i.prototype);if(o||!c){let y;throw o?y="techs must be registered using Tech.registerTech()":y="must be a Component subclass",new Error(`Illegal component, "${e}"; ${y}.`)}e=zi(e),et.components_||(et.components_={});const f=et.getComponent("Player");if(e==="Player"&&f&&f.players){const y=f.players,S=Object.keys(y);if(y&&S.length>0&&S.map(O=>y[O]).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return et.components_[e]=i,et.components_[Cs(e)]=i,i}static getComponent(e){if(!(!e||!et.components_))return et.components_[e]}}et.registerComponent("Component",et);function Fc(s,e,i){if(typeof e!="number"||e<0||e>i)throw new Error(`Failed to execute '${s}' on 'TimeRanges': The index provided (${e}) is non-numeric or out of bounds (0-${i}).`)}function ad(s,e,i,r){return Fc(s,r,i.length-1),i[r][e]}function il(s){let e;return s===void 0||s.length===0?e={length:0,start(){throw new Error("This TimeRanges object is empty")},end(){throw new Error("This TimeRanges object is empty")}}:e={length:s.length,start:ad.bind(null,"start",0,s),end:ad.bind(null,"end",1,s)},ne().Symbol&&ne().Symbol.iterator&&(e[ne().Symbol.iterator]=()=>(s||[]).values()),e}function Sr(s,e){return Array.isArray(s)?il(s):s===void 0||e===void 0?il():il([[s,e]])}const nl=function(s,e){s=s<0?0:s;let i=Math.floor(s%60),r=Math.floor(s/60%60),o=Math.floor(s/3600);const c=Math.floor(e/60%60),f=Math.floor(e/3600);return(isNaN(s)||s===Infinity)&&(o=r=i="-"),o=o>0||f>0?o+":":"",r=((o||c>=10)&&r<10?"0"+r:r)+":",i=i<10?"0"+i:i,o+r+i};let rl=nl;function Yl(s){rl=s}function Zs(){rl=nl}function ss(s,e=s){return rl(s,e)}var od=Object.freeze({__proto__:null,createTimeRanges:Sr,createTimeRange:Sr,setFormatTime:Yl,resetFormatTime:Zs,formatTime:ss});function ld(s,e){let i=0,r,o;if(!e)return 0;(!s||!s.length)&&(s=Sr(0,0));for(let c=0;c<s.length;c++)r=s.start(c),o=s.end(c),o>e&&(o=e),i+=o-r;return i/e}function Wi(s){if(s instanceof Wi)return s;typeof s=="number"?this.code=s:typeof s=="string"?this.message=s:Jn(s)&&(typeof s.code=="number"&&(this.code=s.code),Object.assign(this,s)),this.message||(this.message=Wi.defaultMessages[this.code]||"")}Wi.prototype.code=0,Wi.prototype.message="",Wi.prototype.status=null,Wi.prototype.metadata=null,Wi.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],Wi.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."},Wi.MEDIA_ERR_CUSTOM=0,Wi.prototype.MEDIA_ERR_CUSTOM=0,Wi.MEDIA_ERR_ABORTED=1,Wi.prototype.MEDIA_ERR_ABORTED=1,Wi.MEDIA_ERR_NETWORK=2,Wi.prototype.MEDIA_ERR_NETWORK=2,Wi.MEDIA_ERR_DECODE=3,Wi.prototype.MEDIA_ERR_DECODE=3,Wi.MEDIA_ERR_SRC_NOT_SUPPORTED=4,Wi.prototype.MEDIA_ERR_SRC_NOT_SUPPORTED=4,Wi.MEDIA_ERR_ENCRYPTED=5,Wi.prototype.MEDIA_ERR_ENCRYPTED=5;function Pa(s){return s!=null&&typeof s.then=="function"}function Gr(s){Pa(s)&&s.then(null,e=>{})}const Xl=function(s){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce((i,r,o)=>(s[r]&&(i[r]=s[r]),i),{cues:s.cues&&Array.prototype.map.call(s.cues,function(i){return{startTime:i.startTime,endTime:i.endTime,text:i.text,id:i.id}})})};var Ql={textTracksToJson:function(s){const e=s.$$("track"),i=Array.prototype.map.call(e,o=>o.track);return Array.prototype.map.call(e,function(o){const c=Xl(o.track);return o.src&&(c.src=o.src),c}).concat(Array.prototype.filter.call(s.textTracks(),function(o){return i.indexOf(o)===-1}).map(Xl))},jsonToTextTracks:function(s,e){return s.forEach(function(i){const r=e.addRemoteTextTrack(i).track;!i.src&&i.cues&&i.cues.forEach(o=>r.addCue(o))}),e.textTracks()},trackToJson_:Xl};const Jl="vjs-modal-dialog";class ea extends et{constructor(e,i){super(e,i);this.handleKeyDown_=r=>this.handleKeyDown(r),this.close_=r=>this.close(r),this.opened_=this.hasBeenOpened_=this.hasBeenFilled_=!1,this.closeable(!this.options_.uncloseable),this.content(this.options_.content),this.contentEl_=Xt("div",{className:`${Jl}-content`},{role:"document"}),this.descEl_=Xt("p",{className:`${Jl}-description vjs-control-text`,id:this.el().getAttribute("aria-describedby")}),Vn(this.descEl_,this.description()),this.el_.appendChild(this.descEl_),this.el_.appendChild(this.contentEl_)}createEl(){return super.createEl("div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":`${this.id()}_description`,"aria-hidden":"true","aria-label":this.label(),role:"dialog","aria-live":"polite"})}dispose(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,super.dispose()}buildCSSClass(){return`${Jl} vjs-hidden ${super.buildCSSClass()}`}label(){return this.localize(this.options_.label||"Modal Window")}description(){let e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e}open(){if(this.opened_){this.options_.fillAlways&&this.fill();return}const e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.on("keydown",this.handleKeyDown_),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}opened(e){return typeof e=="boolean"&&this[e?"open":"close"](),this.opened_}close(){if(!this.opened_)return;const e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.off("keydown",this.handleKeyDown_),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger({type:"modalclose",bubbles:!0}),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}closeable(e){if(typeof e=="boolean"){const i=this.closeable_=!!e;let r=this.getChild("closeButton");if(i&&!r){const o=this.contentEl_;this.contentEl_=this.el_,r=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=o,this.on(r,"close",this.close_)}!i&&r&&(this.off(r,"close",this.close_),this.removeChild(r),r.dispose())}return this.closeable_}fill(){this.fillWith(this.content())}fillWith(e){const i=this.contentEl(),r=i.parentNode,o=i.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,r.removeChild(i),this.empty(),tt(i,e),this.trigger("modalfill"),o?r.insertBefore(i,o):r.appendChild(i);const c=this.getChild("closeButton");c&&r.appendChild(c.el_)}empty(){this.trigger("beforemodalempty"),fe(this.contentEl()),this.trigger("modalempty")}content(e){return typeof e!="undefined"&&(this.content_=e),this.content_}conditionalFocus_(){const e=ve().activeElement,i=this.player_.el_;this.previouslyActiveEl_=null,(i.contains(e)||i===e)&&(this.previouslyActiveEl_=e,this.focus())}conditionalBlur_(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)}handleKeyDown(e){if(this.trigger({type:"modalKeydown",originalEvent:e,target:this,bubbles:!0}),e.stopPropagation(),e.key==="Escape"&&this.closeable()){e.preventDefault(),this.close();return}if(e.key!=="Tab")return;const i=this.focusableEls_(),r=this.el_.querySelector(":focus");let o;for(let c=0;c<i.length;c++)if(r===i[c]){o=c;break}ve().activeElement===this.el_&&(o=0),e.shiftKey&&o===0?(i[i.length-1].focus(),e.preventDefault()):!e.shiftKey&&o===i.length-1&&(i[0].focus(),e.preventDefault())}focusableEls_(){const e=this.el_.querySelectorAll("*");return Array.prototype.filter.call(e,i=>(i instanceof ne().HTMLAnchorElement||i instanceof ne().HTMLAreaElement)&&i.hasAttribute("href")||(i instanceof ne().HTMLInputElement||i instanceof ne().HTMLSelectElement||i instanceof ne().HTMLTextAreaElement||i instanceof ne().HTMLButtonElement)&&!i.hasAttribute("disabled")||i instanceof ne().HTMLIFrameElement||i instanceof ne().HTMLObjectElement||i instanceof ne().HTMLEmbedElement||i.hasAttribute("tabindex")&&i.getAttribute("tabindex")!==-1||i.hasAttribute("contenteditable"))}}ea.prototype.options_={pauseOnOpen:!0,temporary:!0},et.registerComponent("ModalDialog",ea);class Oa extends Zn{constructor(e=[]){super();this.tracks_=[],Object.defineProperty(this,"length",{get(){return this.tracks_.length}});for(let i=0;i<e.length;i++)this.addTrack(e[i])}addTrack(e){const i=this.tracks_.length;""+i in this||Object.defineProperty(this,i,{get(){return this.tracks_[i]}}),this.tracks_.indexOf(e)===-1&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack",target:this})),e.labelchange_=()=>{this.trigger({track:e,type:"labelchange",target:this})},qn(e)&&e.addEventListener("labelchange",e.labelchange_)}removeTrack(e){let i;for(let r=0,o=this.length;r<o;r++)if(this[r]===e){i=this[r],i.off&&i.off(),this.tracks_.splice(r,1);break}!i||this.trigger({track:i,type:"removetrack",target:this})}getTrackById(e){let i=null;for(let r=0,o=this.length;r<o;r++){const c=this[r];if(c.id===e){i=c;break}}return i}}Oa.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"};for(const s in Oa.prototype.allowedEvents_)Oa.prototype["on"+s]=null;const Zl=function(s,e){for(let i=0;i<s.length;i++)!Object.keys(s[i]).length||e.id===s[i].id||(s[i].enabled=!1)};class ud extends Oa{constructor(e=[]){for(let i=e.length-1;i>=0;i--)if(e[i].enabled){Zl(e,e[i]);break}super(e);this.changing_=!1}addTrack(e){e.enabled&&Zl(this,e),super.addTrack(e),!!e.addEventListener&&(e.enabledChange_=()=>{this.changing_||(this.changing_=!0,Zl(this,e),this.changing_=!1,this.trigger("change"))},e.addEventListener("enabledchange",e.enabledChange_))}removeTrack(e){super.removeTrack(e),e.removeEventListener&&e.enabledChange_&&(e.removeEventListener("enabledchange",e.enabledChange_),e.enabledChange_=null)}}const er=function(s,e){for(let i=0;i<s.length;i++)!Object.keys(s[i]).length||e.id===s[i].id||(s[i].selected=!1)};class as extends Oa{constructor(e=[]){for(let i=e.length-1;i>=0;i--)if(e[i].selected){er(e,e[i]);break}super(e);this.changing_=!1,Object.defineProperty(this,"selectedIndex",{get(){for(let i=0;i<this.length;i++)if(this[i].selected)return i;return-1},set(){}})}addTrack(e){e.selected&&er(this,e),super.addTrack(e),!!e.addEventListener&&(e.selectedChange_=()=>{this.changing_||(this.changing_=!0,er(this,e),this.changing_=!1,this.trigger("change"))},e.addEventListener("selectedchange",e.selectedChange_))}removeTrack(e){super.removeTrack(e),e.removeEventListener&&e.selectedChange_&&(e.removeEventListener("selectedchange",e.selectedChange_),e.selectedChange_=null)}}class dd extends Oa{addTrack(e){super.addTrack(e),this.queueChange_||(this.queueChange_=()=>this.queueTrigger("change")),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=()=>this.trigger("selectedlanguagechange")),e.addEventListener("modechange",this.queueChange_),["metadata","chapters"].indexOf(e.kind)===-1&&e.addEventListener("modechange",this.triggerSelectedlanguagechange_)}removeTrack(e){super.removeTrack(e),e.removeEventListener&&(this.queueChange_&&e.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&e.removeEventListener("modechange",this.triggerSelectedlanguagechange_))}}class Nc{constructor(e=[]){this.trackElements_=[],Object.defineProperty(this,"length",{get(){return this.trackElements_.length}});for(let i=0,r=e.length;i<r;i++)this.addTrackElement_(e[i])}addTrackElement_(e){const i=this.trackElements_.length;""+i in this||Object.defineProperty(this,i,{get(){return this.trackElements_[i]}}),this.trackElements_.indexOf(e)===-1&&this.trackElements_.push(e)}getTrackElementByTrack_(e){let i;for(let r=0,o=this.trackElements_.length;r<o;r++)if(e===this.trackElements_[r].track){i=this.trackElements_[r];break}return i}removeTrackElement_(e){for(let i=0,r=this.trackElements_.length;i<r;i++)if(e===this.trackElements_[i]){this.trackElements_[i].track&&typeof this.trackElements_[i].track.off=="function"&&this.trackElements_[i].track.off(),typeof this.trackElements_[i].off=="function"&&this.trackElements_[i].off(),this.trackElements_.splice(i,1);break}}}class sl{constructor(e){sl.prototype.setCues_.call(this,e),Object.defineProperty(this,"length",{get(){return this.length_}})}setCues_(e){const i=this.length||0;let r=0;const o=e.length;this.cues_=e,this.length_=e.length;const c=function(f){""+f in this||Object.defineProperty(this,""+f,{get(){return this.cues_[f]}})};if(i<o)for(r=i;r<o;r++)c.call(this,r)}getCueById(e){let i=null;for(let r=0,o=this.length;r<o;r++){const c=this[r];if(c.id===e){i=c;break}}return i}}const Uc={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},jc={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},$c={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},ws={disabled:"disabled",hidden:"hidden",showing:"showing"};class al extends Zn{constructor(e={}){super();const i={id:e.id||"vjs_track_"+Ci(),kind:e.kind||"",language:e.language||""};let r=e.label||"";for(const o in i)Object.defineProperty(this,o,{get(){return i[o]},set(){}});Object.defineProperty(this,"label",{get(){return r},set(o){o!==r&&(r=o,this.trigger("labelchange"))}})}}const eu=function(s){return new URL(s,ve().baseURI)},cd=function(s){return new URL(s,ve().baseURI).href},so=function(s){if(typeof s=="string"){const i=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(s);if(i)return i.pop().toLowerCase()}return""},ao=function(s,e=ne().location){return eu(s).origin!==e.origin};var hd=Object.freeze({__proto__:null,parseUrl:eu,getAbsoluteURL:cd,getFileExtension:so,isCrossOrigin:ao});const oo=function(s,e){const i=new(ne()).WebVTT.Parser(ne(),ne().vttjs,ne().WebVTT.StringDecoder()),r=[];i.oncue=function(o){e.addCue(o)},i.onparsingerror=function(o){r.push(o)},i.onflush=function(){e.trigger({type:"loadeddata",target:e})},i.parse(s),r.length>0&&(ne().console&&ne().console.groupCollapsed&&ne().console.groupCollapsed(`Text Track parsing errors for ${e.src}`),r.forEach(o=>ci.error(o)),ne().console&&ne().console.groupEnd&&ne().console.groupEnd()),i.flush()},fd=function(s,e){const i={uri:s},r=ao(s);r&&(i.cors=r);const o=e.tech_.crossOrigin()==="use-credentials";o&&(i.withCredentials=o),ye()(i,Ni(this,function(c,f,y){if(c)return ci.error(c,f);e.loaded_=!0,typeof ne().WebVTT!="function"?e.tech_&&e.tech_.any(["vttjsloaded","vttjserror"],S=>{if(S.type==="vttjserror"){ci.error(`vttjs failed to load, stopping trying to process ${e.src}`);return}return oo(y,e)}):oo(y,e)}))};class lo extends al{constructor(e={}){if(!e.tech)throw new Error("A tech was not provided.");const i=Si(e,{kind:$c[e.kind]||"subtitles",language:e.language||e.srclang||""});let r=ws[i.mode]||"disabled";const o=i.default;(i.kind==="metadata"||i.kind==="chapters")&&(r="hidden"),super(i),this.tech_=i.tech,this.cues_=[],this.activeCues_=[],this.preload_=this.tech_.preloadTextTracks!==!1;const c=new sl(this.cues_),f=new sl(this.activeCues_);let y=!1;this.timeupdateHandler=Ni(this,function(O={}){if(!this.tech_.isDisposed()){if(!this.tech_.isReady_){O.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler));return}this.activeCues=this.activeCues,y&&(this.trigger("cuechange"),y=!1),O.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler))}});const S=()=>{this.stopTracking()};this.tech_.one("dispose",S),r!=="disabled"&&this.startTracking(),Object.defineProperties(this,{default:{get(){return o},set(){}},mode:{get(){return r},set(O){!ws[O]||r!==O&&(r=O,!this.preload_&&r!=="disabled"&&this.cues.length===0&&fd(this.src,this),this.stopTracking(),r!=="disabled"&&this.startTracking(),this.trigger("modechange"))}},cues:{get(){return this.loaded_?c:null},set(){}},activeCues:{get(){if(!this.loaded_)return null;if(this.cues.length===0)return f;const O=this.tech_.currentTime(),q=[];for(let de=0,Te=this.cues.length;de<Te;de++){const Ie=this.cues[de];Ie.startTime<=O&&Ie.endTime>=O&&q.push(Ie)}if(y=!1,q.length!==this.activeCues_.length)y=!0;else for(let de=0;de<q.length;de++)this.activeCues_.indexOf(q[de])===-1&&(y=!0);return this.activeCues_=q,f.setCues_(this.activeCues_),f},set(){}}}),i.src?(this.src=i.src,this.preload_||(this.loaded_=!0),(this.preload_||i.kind!=="subtitles"&&i.kind!=="captions")&&fd(this.src,this)):this.loaded_=!0}startTracking(){this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler),this.tech_.on("timeupdate",this.timeupdateHandler)}stopTracking(){this.rvf_&&(this.tech_.cancelVideoFrameCallback(this.rvf_),this.rvf_=void 0),this.tech_.off("timeupdate",this.timeupdateHandler)}addCue(e){let i=e;if(!("getCueAsHTML"in i)){i=new(ne()).vttjs.VTTCue(e.startTime,e.endTime,e.text);for(const o in e)o in i||(i[o]=e[o]);i.id=e.id,i.originalCue_=e}const r=this.tech_.textTracks();for(let o=0;o<r.length;o++)r[o]!==this&&r[o].removeCue(i);this.cues_.push(i),this.cues.setCues_(this.cues_)}removeCue(e){let i=this.cues_.length;for(;i--;){const r=this.cues_[i];if(r===e||r.originalCue_&&r.originalCue_===e){this.cues_.splice(i,1),this.cues.setCues_(this.cues_);break}}}}lo.prototype.allowedEvents_={cuechange:"cuechange"};class uo extends al{constructor(e={}){const i=Si(e,{kind:jc[e.kind]||""});super(i);let r=!1;Object.defineProperty(this,"enabled",{get(){return r},set(o){typeof o!="boolean"||o===r||(r=o,this.trigger("enabledchange"))}}),i.enabled&&(this.enabled=i.enabled),this.loaded_=!0}}class ol extends al{constructor(e={}){const i=Si(e,{kind:Uc[e.kind]||""});super(i);let r=!1;Object.defineProperty(this,"selected",{get(){return r},set(o){typeof o!="boolean"||o===r||(r=o,this.trigger("selectedchange"))}}),i.selected&&(this.selected=i.selected)}}class os extends Zn{constructor(e={}){super();let i;const r=new lo(e);this.kind=r.kind,this.src=r.src,this.srclang=r.language,this.label=r.label,this.default=r.default,Object.defineProperties(this,{readyState:{get(){return i}},track:{get(){return r}}}),i=os.NONE,r.addEventListener("loadeddata",()=>{i=os.LOADED,this.trigger({type:"load",target:this})})}}os.prototype.allowedEvents_={load:"load"},os.NONE=0,os.LOADING=1,os.LOADED=2,os.ERROR=3;const tr={audio:{ListClass:ud,TrackClass:uo,capitalName:"Audio"},video:{ListClass:as,TrackClass:ol,capitalName:"Video"},text:{ListClass:dd,TrackClass:lo,capitalName:"Text"}};Object.keys(tr).forEach(function(s){tr[s].getterName=`${s}Tracks`,tr[s].privateName=`${s}Tracks_`});const Ba={remoteText:{ListClass:dd,TrackClass:lo,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:Nc,TrackClass:os,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},Ln=Object.assign({},tr,Ba);Ba.names=Object.keys(Ba),tr.names=Object.keys(tr),Ln.names=[].concat(Ba.names).concat(tr.names);function tu(s,e,i,r,o={}){const c=s.textTracks();o.kind=e,i&&(o.label=i),r&&(o.language=r),o.tech=s;const f=new Ln.text.TrackClass(o);return c.addTrack(f),f}class ni extends et{constructor(e={},i=function(){}){e.reportTouchActivity=!1,super(null,e,i),this.onDurationChange_=r=>this.onDurationChange(r),this.trackProgress_=r=>this.trackProgress(r),this.trackCurrentTime_=r=>this.trackCurrentTime(r),this.stopTrackingCurrentTime_=r=>this.stopTrackingCurrentTime(r),this.disposeSourceHandler_=r=>this.disposeSourceHandler(r),this.queuedHanders_=new Set,this.hasStarted_=!1,this.on("playing",function(){this.hasStarted_=!0}),this.on("loadstart",function(){this.hasStarted_=!1}),Ln.names.forEach(r=>{const o=Ln[r];e&&e[o.getterName]&&(this[o.privateName]=e[o.getterName])}),this.featuresProgressEvents||this.manualProgressOn(),this.featuresTimeupdateEvents||this.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(r=>{e[`native${r}Tracks`]===!1&&(this[`featuresNative${r}Tracks`]=!1)}),e.nativeCaptions===!1||e.nativeTextTracks===!1?this.featuresNativeTextTracks=!1:(e.nativeCaptions===!0||e.nativeTextTracks===!0)&&(this.featuresNativeTextTracks=!0),this.featuresNativeTextTracks||this.emulateTextTracks(),this.preloadTextTracks=e.preloadTextTracks!==!1,this.autoRemoteTextTracks_=new Ln.text.ListClass,this.initTrackListeners(),e.nativeControlsForTouch||this.emitTapEvents(),this.constructor&&(this.name_=this.constructor.name||"Unknown Tech")}triggerSourceset(e){this.isReady_||this.one("ready",()=>this.setTimeout(()=>this.triggerSourceset(e),1)),this.trigger({src:e,type:"sourceset"})}manualProgressOn(){this.on("durationchange",this.onDurationChange_),this.manualProgress=!0,this.one("ready",this.trackProgress_)}manualProgressOff(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange_)}trackProgress(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(Ni(this,function(){const i=this.bufferedPercent();this.bufferedPercent_!==i&&this.trigger("progress"),this.bufferedPercent_=i,i===1&&this.stopTrackingProgress()}),500)}onDurationChange(e){this.duration_=this.duration()}buffered(){return Sr(0,0)}bufferedPercent(){return ld(this.buffered(),this.duration_)}stopTrackingProgress(){this.clearInterval(this.progressInterval)}manualTimeUpdatesOn(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime_),this.on("pause",this.stopTrackingCurrentTime_)}manualTimeUpdatesOff(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime_),this.off("pause",this.stopTrackingCurrentTime_)}trackCurrentTime(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)}stopTrackingCurrentTime(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}dispose(){this.clearTracks(tr.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),super.dispose()}clearTracks(e){e=[].concat(e),e.forEach(i=>{const r=this[`${i}Tracks`]()||[];let o=r.length;for(;o--;){const c=r[o];i==="text"&&this.removeRemoteTextTrack(c),r.removeTrack(c)}})}cleanupAutoTextTracks(){const e=this.autoRemoteTextTracks_||[];let i=e.length;for(;i--;){const r=e[i];this.removeRemoteTextTrack(r)}}reset(){}crossOrigin(){}setCrossOrigin(){}error(e){return e!==void 0&&(this.error_=new Wi(e),this.trigger("error")),this.error_}played(){return this.hasStarted_?Sr(0,0):Sr()}play(){}setScrubbing(e){}scrubbing(){}setCurrentTime(e){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}initTrackListeners(){tr.names.forEach(e=>{const i=tr[e],r=()=>{this.trigger(`${e}trackchange`)},o=this[i.getterName]();o.addEventListener("removetrack",r),o.addEventListener("addtrack",r),this.on("dispose",()=>{o.removeEventListener("removetrack",r),o.removeEventListener("addtrack",r)})})}addWebVttScript_(){if(!ne().WebVTT)if(ve().body.contains(this.el())){if(!this.options_["vtt.js"]&&lr(te())&&Object.keys(te()).length>0){this.trigger("vttjsloaded");return}const e=ve().createElement("script");e.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",e.onload=()=>{this.trigger("vttjsloaded")},e.onerror=()=>{this.trigger("vttjserror")},this.on("dispose",()=>{e.onload=null,e.onerror=null}),ne().WebVTT=!0,this.el().parentNode.appendChild(e)}else this.ready(this.addWebVttScript_)}emulateTextTracks(){const e=this.textTracks(),i=this.remoteTextTracks(),r=y=>e.addTrack(y.track),o=y=>e.removeTrack(y.track);i.on("addtrack",r),i.on("removetrack",o),this.addWebVttScript_();const c=()=>this.trigger("texttrackchange"),f=()=>{c();for(let y=0;y<e.length;y++){const S=e[y];S.removeEventListener("cuechange",c),S.mode==="showing"&&S.addEventListener("cuechange",c)}};f(),e.addEventListener("change",f),e.addEventListener("addtrack",f),e.addEventListener("removetrack",f),this.on("dispose",function(){i.off("addtrack",r),i.off("removetrack",o),e.removeEventListener("change",f),e.removeEventListener("addtrack",f),e.removeEventListener("removetrack",f);for(let y=0;y<e.length;y++)e[y].removeEventListener("cuechange",c)})}addTextTrack(e,i,r){if(!e)throw new Error("TextTrack kind is required but was not provided");return tu(this,e,i,r)}createRemoteTextTrack(e){const i=Si(e,{tech:this});return new Ba.remoteTextEl.TrackClass(i)}addRemoteTextTrack(e={},i){const r=this.createRemoteTextTrack(e);return typeof i!="boolean"&&(i=!1),this.remoteTextTrackEls().addTrackElement_(r),this.remoteTextTracks().addTrack(r.track),i===!1&&this.ready(()=>this.autoRemoteTextTracks_.addTrack(r.track)),r}removeRemoteTextTrack(e){const i=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(i),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)}getVideoPlaybackQuality(){return{}}requestPictureInPicture(){return Promise.reject()}disablePictureInPicture(){return!0}setDisablePictureInPicture(){}requestVideoFrameCallback(e){const i=Ci();return!this.isReady_||this.paused()?(this.queuedHanders_.add(i),this.one("playing",()=>{this.queuedHanders_.has(i)&&(this.queuedHanders_.delete(i),e())})):this.requestNamedAnimationFrame(i,e),i}cancelVideoFrameCallback(e){this.queuedHanders_.has(e)?this.queuedHanders_.delete(e):this.cancelNamedAnimationFrame(e)}setPoster(){}playsinline(){}setPlaysinline(){}overrideNativeAudioTracks(e){}overrideNativeVideoTracks(e){}canPlayType(e){return""}static canPlayType(e){return""}static canPlaySource(e,i){return ni.canPlayType(e.type)}static isTech(e){return e.prototype instanceof ni||e instanceof ni||e===ni}static registerTech(e,i){if(ni.techs_||(ni.techs_={}),!ni.isTech(i))throw new Error(`Tech ${e} must be a Tech`);if(!ni.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!ni.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=zi(e),ni.techs_[e]=i,ni.techs_[Cs(e)]=i,e!=="Tech"&&ni.defaultTechOrder_.push(e),i}static getTech(e){if(!!e){if(ni.techs_&&ni.techs_[e])return ni.techs_[e];if(e=zi(e),ne()&&ne().videojs&&ne().videojs[e])return ci.warn(`The ${e} tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)`),ne().videojs[e]}}}Ln.names.forEach(function(s){const e=Ln[s];ni.prototype[e.getterName]=function(){return this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName]}}),ni.prototype.featuresVolumeControl=!0,ni.prototype.featuresMuteControl=!0,ni.prototype.featuresFullscreenResize=!1,ni.prototype.featuresPlaybackRate=!1,ni.prototype.featuresProgressEvents=!1,ni.prototype.featuresSourceset=!1,ni.prototype.featuresTimeupdateEvents=!1,ni.prototype.featuresNativeTextTracks=!1,ni.prototype.featuresVideoFrameCallback=!1,ni.withSourceHandlers=function(s){s.registerSourceHandler=function(i,r){let o=s.sourceHandlers;o||(o=s.sourceHandlers=[]),r===void 0&&(r=o.length),o.splice(r,0,i)},s.canPlayType=function(i){const r=s.sourceHandlers||[];let o;for(let c=0;c<r.length;c++)if(o=r[c].canPlayType(i),o)return o;return""},s.selectSourceHandler=function(i,r){const o=s.sourceHandlers||[];let c;for(let f=0;f<o.length;f++)if(c=o[f].canHandleSource(i,r),c)return o[f];return null},s.canPlaySource=function(i,r){const o=s.selectSourceHandler(i,r);return o?o.canHandleSource(i,r):""},["seekable","seeking","duration"].forEach(function(i){const r=this[i];typeof r=="function"&&(this[i]=function(){return this.sourceHandler_&&this.sourceHandler_[i]?this.sourceHandler_[i].apply(this.sourceHandler_,arguments):r.apply(this,arguments)})},s.prototype),s.prototype.setSource=function(i){let r=s.selectSourceHandler(i,this.options_);r||(s.nativeSourceHandler?r=s.nativeSourceHandler:ci.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler_),r!==s.nativeSourceHandler&&(this.currentSource_=i),this.sourceHandler_=r.handleSource(i,this,this.options_),this.one("dispose",this.disposeSourceHandler_)},s.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},et.registerComponent("Tech",ni),ni.registerTech("Tech",ni),ni.defaultTechOrder_=[];const ta={},co={},ll={};function Vc(s,e){ta[s]=ta[s]||[],ta[s].push(e)}function iu(s,e,i){s.setTimeout(()=>ls(e,ta[e.type],i,s),1)}function Hc(s,e){s.forEach(i=>i.setTech&&i.setTech(e))}function nu(s,e,i){return s.reduceRight(ul(i),e[i]())}function ru(s,e,i,r){return e[i](s.reduce(ul(i),r))}function pd(s,e,i,r=null){const o="call"+zi(i),c=s.reduce(ul(o),r),f=c===ll,y=f?null:e[i](c);return qc(s,i,y,f),y}const Gc={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1,ended:1},su={setCurrentTime:1,setMuted:1,setVolume:1},au={play:1,pause:1};function ul(s){return(e,i)=>e===ll?ll:i[s]?i[s](e):e}function qc(s,e,i,r){for(let o=s.length-1;o>=0;o--){const c=s[o];c[e]&&c[e](r,i)}}function md(s){co.hasOwnProperty(s.id())&&delete co[s.id()]}function zc(s,e){const i=co[s.id()];let r=null;if(i==null)return r=e(s),co[s.id()]=[[e,r]],r;for(let o=0;o<i.length;o++){const[c,f]=i[o];c===e&&(r=f)}return r===null&&(r=e(s),i.push([e,r])),r}function ls(s={},e=[],i,r,o=[],c=!1){const[f,...y]=e;if(typeof f=="string")ls(s,ta[f],i,r,o,c);else if(f){const S=zc(r,f);if(!S.setSource)return o.push(S),ls(s,y,i,r,o,c);S.setSource(Object.assign({},s),function(O,q){if(O)return ls(s,y,i,r,o,c);o.push(S),ls(q,s.type===q.type?y:ta[q.type],i,r,o,c)})}else y.length?ls(s,y,i,r,o,c):c?i(s,o):ls(s,ta["*"],i,r,o,!0)}const gd={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",mpd:"application/dash+xml",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},ho=function(s=""){const e=so(s);return gd[e.toLowerCase()]||""},Wc=(s,e)=>{if(!e)return"";if(s.cache_.source.src===e&&s.cache_.source.type)return s.cache_.source.type;const i=s.cache_.sources.filter(o=>o.src===e);if(i.length)return i[0].type;const r=s.$$("source");for(let o=0;o<r.length;o++){const c=r[o];if(c.type&&c.src&&c.src===e)return c.type}return ho(e)},dl=function(s){if(Array.isArray(s)){let e=[];s.forEach(function(i){i=dl(i),Array.isArray(i)?e=e.concat(i):Jn(i)&&e.push(i)}),s=e}else typeof s=="string"&&s.trim()?s=[ou({src:s})]:Jn(s)&&typeof s.src=="string"&&s.src&&s.src.trim()?s=[ou(s)]:s=[];return s};function ou(s){if(!s.type){const e=ho(s.src);e&&(s.type=e)}return s}var lu=`<svg xmlns="http://www.w3.org/2000/svg">
  <defs>
    <symbol viewBox="0 0 48 48" id="vjs-icon-play">
      <path d="M16 10v28l22-14z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-pause">
      <path d="M12 38h8V10h-8v28zm16-28v28h8V10h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-audio">
      <path d="M24 2C14.06 2 6 10.06 6 20v14c0 3.31 2.69 6 6 6h6V24h-8v-4c0-7.73 6.27-14 14-14s14 6.27 14 14v4h-8v16h6c3.31 0 6-2.69 6-6V20c0-9.94-8.06-18-18-18z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-captions">
      <path d="M38 8H10c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h28c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM22 22h-3v-1h-4v6h4v-1h3v2a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2zm14 0h-3v-1h-4v6h4v-1h3v2a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-subtitles">
      <path d="M40 8H8c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h32c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM8 24h8v4H8v-4zm20 12H8v-4h20v4zm12 0h-8v-4h8v4zm0-8H20v-4h20v4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-fullscreen-enter">
      <path d="M14 28h-4v10h10v-4h-6v-6zm-4-8h4v-6h6v-4H10v10zm24 14h-6v4h10V28h-4v6zm-6-24v4h6v6h4V10H28z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-fullscreen-exit">
      <path d="M10 32h6v6h4V28H10v4zm6-16h-6v4h10V10h-4v6zm12 22h4v-6h6v-4H28v10zm4-22v-6h-4v10h10v-4h-6z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-play-circle">
      <path d="M20 33l12-9-12-9v18zm4-29C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-mute">
      <path d="M33 24c0-3.53-2.04-6.58-5-8.05v4.42l4.91 4.91c.06-.42.09-.85.09-1.28zm5 0c0 1.88-.41 3.65-1.08 5.28l3.03 3.03C41.25 29.82 42 27 42 24c0-8.56-5.99-15.72-14-17.54v4.13c5.78 1.72 10 7.07 10 13.41zM8.55 6L6 8.55 15.45 18H6v12h8l10 10V26.55l8.51 8.51c-1.34 1.03-2.85 1.86-4.51 2.36v4.13a17.94 17.94 0 0 0 7.37-3.62L39.45 42 42 39.45l-18-18L8.55 6zM24 8l-4.18 4.18L24 16.36V8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-low">
      <path d="M14 18v12h8l10 10V8L22 18h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-medium">
      <path d="M37 24c0-3.53-2.04-6.58-5-8.05v16.11c2.96-1.48 5-4.53 5-8.06zm-27-6v12h8l10 10V8L18 18h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-high">
      <path d="M6 18v12h8l10 10V8L14 18H6zm27 6c0-3.53-2.04-6.58-5-8.05v16.11c2.96-1.48 5-4.53 5-8.06zM28 6.46v4.13c5.78 1.72 10 7.07 10 13.41s-4.22 11.69-10 13.41v4.13c8.01-1.82 14-8.97 14-17.54S36.01 8.28 28 6.46z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-spinner">
      <path d="M18.8 21l9.53-16.51C26.94 4.18 25.49 4 24 4c-4.8 0-9.19 1.69-12.64 4.51l7.33 12.69.11-.2zm24.28-3c-1.84-5.85-6.3-10.52-11.99-12.68L23.77 18h19.31zm.52 2H28.62l.58 1 9.53 16.5C41.99 33.94 44 29.21 44 24c0-1.37-.14-2.71-.4-4zm-26.53 4l-7.8-13.5C6.01 14.06 4 18.79 4 24c0 1.37.14 2.71.4 4h14.98l-2.31-4zM4.92 30c1.84 5.85 6.3 10.52 11.99 12.68L24.23 30H4.92zm22.54 0l-7.8 13.51c1.4.31 2.85.49 4.34.49 4.8 0 9.19-1.69 12.64-4.51L29.31 26.8 27.46 30z"></path>
    </symbol>
    <symbol viewBox="0 0 24 24" id="vjs-icon-hd">
      <path d="M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-8 12H9.5v-2h-2v2H6V9h1.5v2.5h2V9H11v6zm2-6h4c.55 0 1 .45 1 1v4c0 .55-.45 1-1 1h-4V9zm1.5 4.5h2v-3h-2v3z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-chapters">
      <path d="M6 26h4v-4H6v4zm0 8h4v-4H6v4zm0-16h4v-4H6v4zm8 8h28v-4H14v4zm0 8h28v-4H14v4zm0-20v4h28v-4H14z"></path>
    </symbol>
    <symbol viewBox="0 0 40 40" id="vjs-icon-downloading">
      <path d="M18.208 36.875q-3.208-.292-5.979-1.729-2.771-1.438-4.812-3.729-2.042-2.292-3.188-5.229-1.146-2.938-1.146-6.23 0-6.583 4.334-11.416 4.333-4.834 10.833-5.5v3.166q-5.167.75-8.583 4.646Q6.25 14.75 6.25 19.958q0 5.209 3.396 9.104 3.396 3.896 8.562 4.646zM20 28.417L11.542 20l2.083-2.083 4.917 4.916v-11.25h2.916v11.25l4.875-4.916L28.417 20zm1.792 8.458v-3.167q1.833-.25 3.541-.958 1.709-.708 3.167-1.875l2.333 2.292q-1.958 1.583-4.25 2.541-2.291.959-4.791 1.167zm6.791-27.792q-1.541-1.125-3.25-1.854-1.708-.729-3.541-1.021V3.042q2.5.25 4.77 1.208 2.271.958 4.271 2.5zm4.584 21.584l-2.25-2.25q1.166-1.5 1.854-3.209.687-1.708.937-3.541h3.209q-.292 2.5-1.229 4.791-.938 2.292-2.521 4.209zm.541-12.417q-.291-1.833-.958-3.562-.667-1.73-1.833-3.188l2.375-2.208q1.541 1.916 2.458 4.208.917 2.292 1.167 4.75z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download">
      <path d="M10.8 40.55q-1.35 0-2.375-1T7.4 37.15v-7.7h3.4v7.7h26.35v-7.7h3.4v7.7q0 1.4-1 2.4t-2.4 1zM24 32.1L13.9 22.05l2.45-2.45 5.95 5.95V7.15h3.4v18.4l5.95-5.95 2.45 2.45z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download-done">
      <path d="M9.8 40.5v-3.45h28.4v3.45zm9.2-9.05L7.4 19.85l2.45-2.35L19 26.65l19.2-19.2 2.4 2.4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download-off">
      <path d="M4.9 4.75L43.25 43.1 41 45.3l-4.75-4.75q-.05.05-.075.025-.025-.025-.075-.025H10.8q-1.35 0-2.375-1T7.4 37.15v-7.7h3.4v7.7h22.05l-7-7-1.85 1.8L13.9 21.9l1.85-1.85L2.7 7zm26.75 14.7l2.45 2.45-3.75 3.8-2.45-2.5zM25.7 7.15V21.1l-3.4-3.45V7.15z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-share">
      <path d="M36 32.17c-1.52 0-2.89.59-3.93 1.54L17.82 25.4c.11-.45.18-.92.18-1.4s-.07-.95-.18-1.4l14.1-8.23c1.07 1 2.5 1.62 4.08 1.62 3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6c0 .48.07.95.18 1.4l-14.1 8.23c-1.07-1-2.5-1.62-4.08-1.62-3.31 0-6 2.69-6 6s2.69 6 6 6c1.58 0 3.01-.62 4.08-1.62l14.25 8.31c-.1.42-.16.86-.16 1.31A5.83 5.83 0 1 0 36 32.17z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cog">
      <path d="M38.86 25.95c.08-.64.14-1.29.14-1.95s-.06-1.31-.14-1.95l4.23-3.31c.38-.3.49-.84.24-1.28l-4-6.93c-.25-.43-.77-.61-1.22-.43l-4.98 2.01c-1.03-.79-2.16-1.46-3.38-1.97L29 4.84c-.09-.47-.5-.84-1-.84h-8c-.5 0-.91.37-.99.84l-.75 5.3a14.8 14.8 0 0 0-3.38 1.97L9.9 10.1a1 1 0 0 0-1.22.43l-4 6.93c-.25.43-.14.97.24 1.28l4.22 3.31C9.06 22.69 9 23.34 9 24s.06 1.31.14 1.95l-4.22 3.31c-.38.3-.49.84-.24 1.28l4 6.93c.25.43.77.61 1.22.43l4.98-2.01c1.03.79 2.16 1.46 3.38 1.97l.75 5.3c.08.47.49.84.99.84h8c.5 0 .91-.37.99-.84l.75-5.3a14.8 14.8 0 0 0 3.38-1.97l4.98 2.01a1 1 0 0 0 1.22-.43l4-6.93c.25-.43.14-.97-.24-1.28l-4.22-3.31zM24 31c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-square">
      <path d="M36 8H12c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h24c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zm0 28H12V12h24v24z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle">
      <circle cx="24" cy="24" r="20"></circle>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle-outline">
      <path d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle-inner-circle">
      <path d="M24 4C12.97 4 4 12.97 4 24s8.97 20 20 20 20-8.97 20-20S35.03 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16zm6-16c0 3.31-2.69 6-6 6s-6-2.69-6-6 2.69-6 6-6 6 2.69 6 6z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cancel">
      <path d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm10 27.17L31.17 34 24 26.83 16.83 34 14 31.17 21.17 24 14 16.83 16.83 14 24 21.17 31.17 14 34 16.83 26.83 24 34 31.17z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-replay">
      <path d="M24 10V2L14 12l10 10v-8c6.63 0 12 5.37 12 12s-5.37 12-12 12-12-5.37-12-12H8c0 8.84 7.16 16 16 16s16-7.16 16-16-7.16-16-16-16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-repeat">
      <path d="M14 14h20v6l8-8-8-8v6H10v12h4v-8zm20 20H14v-6l-8 8 8 8v-6h24V26h-4v8z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-5">
      <path d="M17.689 98l-8.697 8.696 8.697 8.697 2.486-2.485-4.32-4.319h1.302c4.93 0 9.071 1.722 12.424 5.165 3.352 3.443 5.029 7.638 5.029 12.584h3.55c0-2.958-.553-5.73-1.658-8.313-1.104-2.583-2.622-4.841-4.555-6.774-1.932-1.932-4.19-3.45-6.773-4.555-2.584-1.104-5.355-1.657-8.313-1.657H15.5l4.615-4.615zm-8.08 21.659v13.861h11.357v5.008H9.609V143h12.7c.834 0 1.55-.298 2.146-.894.596-.597.895-1.31.895-2.145v-7.781c0-.835-.299-1.55-.895-2.147a2.929 2.929 0 0 0-2.147-.894h-8.227v-5.096H25.35v-4.384z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-10">
      <path d="M42.315 125.63c0-4.997-1.694-9.235-5.08-12.713-3.388-3.479-7.571-5.218-12.552-5.218h-1.315l4.363 4.363-2.51 2.51-8.787-8.786L25.221 97l2.45 2.45-4.662 4.663h1.375c2.988 0 5.788.557 8.397 1.673 2.61 1.116 4.892 2.65 6.844 4.602 1.953 1.953 3.487 4.234 4.602 6.844 1.116 2.61 1.674 5.41 1.674 8.398zM8.183 142v-19.657H3.176V117.8h9.643V142zm13.63 0c-1.156 0-2.127-.393-2.912-1.178-.778-.778-1.168-1.746-1.168-2.902v-16.04c0-1.156.393-2.127 1.178-2.912.779-.779 1.746-1.168 2.902-1.168h7.696c1.156 0 2.126.392 2.911 1.177.779.78 1.168 1.747 1.168 2.903v16.04c0 1.156-.392 2.127-1.177 2.912-.779.779-1.746 1.168-2.902 1.168zm.556-4.636h6.583v-15.02H22.37z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-30">
      <path d="M26.047 97l-8.733 8.732 8.733 8.733 2.496-2.494-4.336-4.338h1.307c4.95 0 9.108 1.73 12.474 5.187 3.367 3.458 5.051 7.668 5.051 12.635h3.565c0-2.97-.556-5.751-1.665-8.346-1.109-2.594-2.633-4.862-4.574-6.802-1.94-1.941-4.208-3.466-6.803-4.575-2.594-1.109-5.375-1.664-8.345-1.664H23.85l4.634-4.634zM2.555 117.531v4.688h10.297v5.25H5.873v4.687h6.979v5.156H2.555V142H13.36c1.061 0 1.95-.395 2.668-1.186.718-.79 1.076-1.772 1.076-2.94v-16.218c0-1.168-.358-2.149-1.076-2.94-.717-.79-1.607-1.185-2.668-1.185zm22.482.14c-1.149 0-2.11.39-2.885 1.165-.78.78-1.172 1.744-1.172 2.893v15.943c0 1.149.388 2.11 1.163 2.885.78.78 1.745 1.172 2.894 1.172h7.649c1.148 0 2.11-.388 2.884-1.163.78-.78 1.17-1.745 1.17-2.894v-15.943c0-1.15-.386-2.111-1.16-2.885-.78-.78-1.746-1.172-2.894-1.172zm.553 4.518h6.545v14.93H25.59z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-5">
      <path d="M29.508 97l-2.431 2.43 4.625 4.625h-1.364c-2.965 0-5.742.554-8.332 1.66-2.589 1.107-4.851 2.629-6.788 4.566-1.937 1.937-3.458 4.2-4.565 6.788-1.107 2.59-1.66 5.367-1.66 8.331h3.557c0-4.957 1.68-9.16 5.04-12.611 3.36-3.45 7.51-5.177 12.451-5.177h1.304l-4.326 4.33 2.49 2.49 8.715-8.716zm-9.783 21.61v13.89h11.382v5.018H19.725V142h12.727a2.93 2.93 0 0 0 2.15-.896 2.93 2.93 0 0 0 .896-2.15v-7.798c0-.837-.299-1.554-.896-2.152a2.93 2.93 0 0 0-2.15-.896h-8.245V123h11.29v-4.392z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-10">
      <path d="M23.119 97l-2.386 2.383 4.538 4.538h-1.339c-2.908 0-5.633.543-8.173 1.63-2.54 1.085-4.76 2.577-6.66 4.478-1.9 1.9-3.392 4.12-4.478 6.66-1.085 2.54-1.629 5.264-1.629 8.172h3.49c0-4.863 1.648-8.986 4.944-12.372 3.297-3.385 7.368-5.078 12.216-5.078h1.279l-4.245 4.247 2.443 2.442 8.55-8.55zm-9.52 21.45v4.42h4.871V142h4.513v-23.55zm18.136 0c-1.125 0-2.066.377-2.824 1.135-.764.764-1.148 1.709-1.148 2.834v15.612c0 1.124.38 2.066 1.139 2.824.764.764 1.708 1.145 2.833 1.145h7.489c1.125 0 2.066-.378 2.824-1.136.764-.764 1.145-1.709 1.145-2.833v-15.612c0-1.125-.378-2.067-1.136-2.825-.764-.764-1.708-1.145-2.833-1.145zm.54 4.42h6.408v14.617h-6.407z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-30">
      <path d="M25.549 97l-2.437 2.434 4.634 4.635H26.38c-2.97 0-5.753.555-8.347 1.664-2.594 1.109-4.861 2.633-6.802 4.574-1.94 1.94-3.465 4.207-4.574 6.802-1.109 2.594-1.664 5.377-1.664 8.347h3.565c0-4.967 1.683-9.178 5.05-12.636 3.366-3.458 7.525-5.187 12.475-5.187h1.307l-4.335 4.338 2.495 2.494 8.732-8.732zm-11.553 20.53v4.689h10.297v5.249h-6.978v4.688h6.978v5.156H13.996V142h10.808c1.06 0 1.948-.395 2.666-1.186.718-.79 1.077-1.771 1.077-2.94v-16.217c0-1.169-.36-2.15-1.077-2.94-.718-.79-1.605-1.186-2.666-1.186zm21.174.168c-1.149 0-2.11.389-2.884 1.163-.78.78-1.172 1.745-1.172 2.894v15.942c0 1.15.388 2.11 1.162 2.885.78.78 1.745 1.17 2.894 1.17h7.649c1.149 0 2.11-.386 2.885-1.16.78-.78 1.17-1.746 1.17-2.895v-15.942c0-1.15-.387-2.11-1.161-2.885-.78-.78-1.745-1.172-2.894-1.172zm.552 4.516h6.542v14.931h-6.542z"></path>
    </symbol>
    <symbol viewBox="0 0 512 512" id="vjs-icon-audio-description">
      <g fill-rule="evenodd"><path d="M227.29 381.351V162.993c50.38-1.017 89.108-3.028 117.631 17.126 27.374 19.342 48.734 56.965 44.89 105.325-4.067 51.155-41.335 94.139-89.776 98.475-24.085 2.155-71.972 0-71.972 0s-.84-1.352-.773-2.568m48.755-54.804c31.43 1.26 53.208-16.633 56.495-45.386 4.403-38.51-21.188-63.552-58.041-60.796v103.612c-.036 1.466.575 2.22 1.546 2.57"></path><path d="M383.78 381.328c13.336 3.71 17.387-11.06 23.215-21.408 12.722-22.571 22.294-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.51c-.587 3.874 2.226 7.315 3.865 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894"></path><path d="M425.154 381.328c13.336 3.71 17.384-11.061 23.215-21.408 12.721-22.571 22.291-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.511c-.586 3.874 2.226 7.315 3.866 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894"></path><path d="M466.26 381.328c13.337 3.71 17.385-11.061 23.216-21.408 12.722-22.571 22.292-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.51c-.587 3.874 2.225 7.315 3.865 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894M4.477 383.005H72.58l18.573-28.484 64.169-.135s.065 19.413.065 28.62h48.756V160.307h-58.816c-5.653 9.537-140.85 222.697-140.85 222.697zm152.667-145.282v71.158l-40.453-.27 40.453-70.888z"></path></g>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-next-item">
      <path d="M12 36l17-12-17-12v24zm20-24v24h4V12h-4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-previous-item">
      <path d="M12 12h4v24h-4zm7 12l17 12V12z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-shuffle">
      <path d="M21.17 18.34L10.83 8 8 10.83l10.34 10.34 2.83-2.83zM29 8l4.09 4.09L8 37.17 10.83 40l25.09-25.09L40 19V8H29zm.66 18.83l-2.83 2.83 6.26 6.26L29 40h11V29l-4.09 4.09-6.25-6.26z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cast">
      <path d="M42 6H6c-2.21 0-4 1.79-4 4v6h4v-6h36v28H28v4h14c2.21 0 4-1.79 4-4V10c0-2.21-1.79-4-4-4zM2 36v6h6c0-3.31-2.69-6-6-6zm0-8v4c5.52 0 10 4.48 10 10h4c0-7.73-6.27-14-14-14zm0-8v4c9.94 0 18 8.06 18 18h4c0-12.15-9.85-22-22-22z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-picture-in-picture-enter">
      <path d="M38 22H22v11.99h16V22zm8 16V9.96C46 7.76 44.2 6 42 6H6C3.8 6 2 7.76 2 9.96V38c0 2.2 1.8 4 4 4h36c2.2 0 4-1.8 4-4zm-4 .04H6V9.94h36v28.1z"></path>
    </symbol>
    <symbol viewBox="0 0 22 18" id="vjs-icon-picture-in-picture-exit">
      <path d="M18 4H4v10h14V4zm4 12V1.98C22 .88 21.1 0 20 0H2C.9 0 0 .88 0 1.98V16c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2zm-2 .02H2V1.97h18v14.05z"></path>
      <path fill="none" d="M-1-3h24v24H-1z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-facebook">
      <path d="M1343 12v264h-157q-86 0-116 36t-30 108v189h293l-39 296h-254v759H734V905H479V609h255V391q0-186 104-288.5T1115 0q147 0 228 12z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-linkedin">
      <path d="M477 625v991H147V625h330zm21-306q1 73-50.5 122T312 490h-2q-82 0-132-49t-50-122q0-74 51.5-122.5T314 148t133 48.5T498 319zm1166 729v568h-329v-530q0-105-40.5-164.5T1168 862q-63 0-105.5 34.5T999 982q-11 30-11 81v553H659q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5T1285 602q171 0 275 113.5t104 332.5z"></path>
    </symbol>
    <symbol viewBox="0 0 1200 1227" id="vjs-icon-twitter">
      <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z"/>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-tumblr">
      <path d="M1328 1329l80 237q-23 35-111 66t-177 32q-104 2-190.5-26T787 1564t-95-106-55.5-120-16.5-118V676H452V461q72-26 129-69.5t91-90 58-102 34-99T779 12q1-5 4.5-8.5T791 0h244v424h333v252h-334v518q0 30 6.5 56t22.5 52.5 49.5 41.5 81.5 14q78-2 134-29z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-pinterest">
      <path d="M1664 896q0 209-103 385.5T1281.5 1561 896 1664q-111 0-218-32 59-93 78-164 9-34 54-211 20 39 73 67.5t114 28.5q121 0 216-68.5t147-188.5 52-270q0-114-59.5-214T1180 449t-255-63q-105 0-196 29t-154.5 77-109 110.5-67 129.5T377 866q0 104 40 183t117 111q30 12 38-20 2-7 8-31t8-30q6-23-11-43-51-61-51-151 0-151 104.5-259.5T904 517q151 0 235.5 82t84.5 213q0 170-68.5 289T980 1220q-61 0-98-43.5T859 1072q8-35 26.5-93.5t30-103T927 800q0-50-27-83t-77-33q-62 0-105 57t-43 142q0 73 25 122l-99 418q-17 70-13 177-206-91-333-281T128 896q0-209 103-385.5T510.5 231 896 128t385.5 103T1561 510.5 1664 896z"></path>
    </symbol>
  </defs>
</svg>`;const yd=Ys?10009:gn?461:8,Ma={codes:{play:415,pause:19,ff:417,rw:412,back:yd},names:{415:"play",19:"pause",417:"ff",412:"rw",[yd]:"back"},isEventKey(s,e){return e=e.toLowerCase(),!!(this.names[s.keyCode]&&this.names[s.keyCode]===e)},getEventName(s){if(this.names[s.keyCode])return this.names[s.keyCode];if(this.codes[s.code]){const e=this.codes[s.code];return this.names[e]}return null}},vd=5;class Ad extends Zn{constructor(e){super();this.player_=e,this.focusableComponents=[],this.isListening_=!1,this.isPaused_=!1,this.onKeyDown_=this.onKeyDown_.bind(this),this.lastFocusedComponent_=null}start(){this.isListening_||(this.player_.on("keydown",this.onKeyDown_),this.player_.on("modalKeydown",this.onKeyDown_),this.player_.on("loadedmetadata",()=>{this.focus(this.updateFocusableComponents()[0])}),this.player_.on("modalclose",()=>{this.refocusComponent()}),this.player_.on("focusin",this.handlePlayerFocus_.bind(this)),this.player_.on("focusout",this.handlePlayerBlur_.bind(this)),this.isListening_=!0)}stop(){this.player_.off("keydown",this.onKeyDown_),this.isListening_=!1}onKeyDown_(e){const i=e.originalEvent?e.originalEvent:e;if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(i.key)){if(this.isPaused_)return;i.preventDefault();const r=i.key.substring(5).toLowerCase();this.move(r)}else if(Ma.isEventKey(i,"play")||Ma.isEventKey(i,"pause")||Ma.isEventKey(i,"ff")||Ma.isEventKey(i,"rw")){i.preventDefault();const r=Ma.getEventName(i);this.performMediaAction_(r)}else Ma.isEventKey(i,"Back")&&e.target&&e.target.closeable()&&(i.preventDefault(),e.target.close())}performMediaAction_(e){if(this.player_)switch(e){case"play":this.player_.paused()&&this.player_.play();break;case"pause":this.player_.paused()||this.player_.pause();break;case"ff":this.userSeek_(this.player_.currentTime()+vd);break;case"rw":this.userSeek_(this.player_.currentTime()-vd);break}}userSeek_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(e)}pause(){this.isPaused_=!0}resume(){this.isPaused_=!1}handlePlayerBlur_(e){const i=e.relatedTarget;let r=null;const o=this.getCurrentComponent(e.target);i&&(r=Boolean(i.closest(".video-js")),i.classList.contains("vjs-text-track-settings")&&!this.isPaused_&&this.searchForTrackSelect_()),(!e.currentTarget.contains(e.relatedTarget)&&!r||!i)&&(o.name()==="CloseButton"?this.refocusComponent():(this.pause(),o&&o.el()&&(this.lastFocusedComponent_=o)))}handlePlayerFocus_(){this.getCurrentComponent()&&this.getCurrentComponent().getIsFocusable()&&this.resume()}updateFocusableComponents(){const e=this.player_,i=[];function r(o){for(const c of o)c.hasOwnProperty("el_")&&c.getIsFocusable()&&c.getIsAvailableToBeFocused(c.el())&&i.push(c),c.hasOwnProperty("children_")&&c.children_.length>0&&r(c.children_)}return e.children_.forEach(o=>{if(o.hasOwnProperty("el_"))if(o.getIsFocusable&&o.getIsAvailableToBeFocused&&o.getIsFocusable()&&o.getIsAvailableToBeFocused(o.el())){i.push(o);return}else o.hasOwnProperty("children_")&&o.children_.length>0?r(o.children_):o.hasOwnProperty("items")&&o.items.length>0?r(o.items):this.findSuitableDOMChild(o)&&i.push(o)}),this.focusableComponents=i,this.focusableComponents}findSuitableDOMChild(e){function i(r){if(e.getIsFocusable(r)&&e.getIsAvailableToBeFocused(r))return r;for(let o=0;o<r.children.length;o++){const c=r.children[o],f=i(c);if(f)return f}return null}return i(e.el())}getCurrentComponent(e){this.updateFocusableComponents();const i=e||document.activeElement;if(this.focusableComponents.length){for(const r of this.focusableComponents)if(r.el()===i)return r}}add(e){const i=[...this.focusableComponents];e.hasOwnProperty("el_")&&e.getIsFocusable()&&e.getIsAvailableToBeFocused(e.el())&&i.push(e),this.focusableComponents=i,this.trigger({type:"focusableComponentsChanged",focusableComponents:this.focusableComponents})}remove(e){for(let i=0;i<this.focusableComponents.length;i++)if(this.focusableComponents[i].name()===e.name()){this.focusableComponents.splice(i,1),this.trigger({type:"focusableComponentsChanged",focusableComponents:this.focusableComponents});return}}clear(){this.focusableComponents.length>0&&(this.focusableComponents=[],this.trigger({type:"focusableComponentsChanged",focusableComponents:this.focusableComponents}))}move(e){const i=this.getCurrentComponent();if(!i)return;const r=i.getPositions(),o=this.focusableComponents.filter(f=>f!==i&&this.isInDirection_(r.boundingClientRect,f.getPositions().boundingClientRect,e)),c=this.findBestCandidate_(r.center,o,e);c?this.focus(c):this.trigger({type:"endOfFocusableComponents",direction:e,focusedComponent:i})}findBestCandidate_(e,i,r){let o=Infinity,c=null;for(const f of i){const y=f.getPositions().center,S=this.calculateDistance_(e,y,r);S<o&&(o=S,c=f)}return c}isInDirection_(e,i,r){switch(r){case"right":return i.left>=e.right;case"left":return i.right<=e.left;case"down":return i.top>=e.bottom;case"up":return i.bottom<=e.top;default:return!1}}refocusComponent(){if(this.lastFocusedComponent_){this.player_.userActive()||this.player_.userActive(!0),this.updateFocusableComponents();for(let e=0;e<this.focusableComponents.length;e++)if(this.focusableComponents[e].name()===this.lastFocusedComponent_.name()){this.focus(this.focusableComponents[e]);return}}else this.focus(this.updateFocusableComponents()[0])}focus(e){e.getIsAvailableToBeFocused(e.el())?e.focus():this.findSuitableDOMChild(e)&&this.findSuitableDOMChild(e).focus()}calculateDistance_(e,i,r){const o=Math.abs(e.x-i.x),c=Math.abs(e.y-i.y);let f;switch(r){case"right":case"left":f=o+c*100;break;case"up":f=c*2+o*.5;break;case"down":f=c*5+o;break;default:f=o+c}return f}searchForTrackSelect_(){const e=this;for(const i of e.updateFocusableComponents())if(i.constructor.name==="TextTrackSelect"){e.focus(i);break}}}class _d extends et{constructor(e,i,r){const o=Si({createEl:!1},i);super(e,o,r);if(!i.playerOptions.sources||i.playerOptions.sources.length===0)for(let c=0,f=i.playerOptions.techOrder;c<f.length;c++){const y=zi(f[c]);let S=ni.getTech(y);if(y||(S=et.getComponent(y)),S&&S.isSupported()){e.loadTech_(y);break}}else e.src(i.playerOptions.sources)}}et.registerComponent("MediaLoader",_d);class cl extends et{constructor(e,i){super(e,i);this.options_.controlText&&this.controlText(this.options_.controlText),this.handleMouseOver_=r=>this.handleMouseOver(r),this.handleMouseOut_=r=>this.handleMouseOut(r),this.handleClick_=r=>this.handleClick(r),this.handleKeyDown_=r=>this.handleKeyDown(r),this.emitTapEvents(),this.enable()}createEl(e="div",i={},r={}){i=Object.assign({className:this.buildCSSClass(),tabIndex:0},i),e==="button"&&ci.error(`Creating a ClickableComponent with an HTML element of ${e} is not supported; use a Button instead.`),r=Object.assign({role:"button"},r),this.tabIndex_=i.tabIndex;const o=Xt(e,i,r);return this.player_.options_.experimentalSvgIcons||o.appendChild(Xt("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(o),o}dispose(){this.controlTextEl_=null,super.dispose()}createControlTextEl(e){return this.controlTextEl_=Xt("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_}controlText(e,i=this.el()){if(e===void 0)return this.controlText_||"Need Text";const r=this.localize(e);this.controlText_=e,Vn(this.controlTextEl_,r),!this.nonIconControl&&!this.player_.options_.noUITitleAttributes&&i.setAttribute("title",r)}buildCSSClass(){return`vjs-control vjs-button ${super.buildCSSClass()}`}enable(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),typeof this.tabIndex_!="undefined"&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick_),this.on("keydown",this.handleKeyDown_))}disable(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),typeof this.tabIndex_!="undefined"&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver_),this.off("mouseout",this.handleMouseOut_),this.off(["tap","click"],this.handleClick_),this.off("keydown",this.handleKeyDown_)}handleLanguagechange(){this.controlText(this.controlText_)}handleClick(e){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)}handleKeyDown(e){e.key===" "||e.key==="Enter"?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):super.handleKeyDown(e)}}et.registerComponent("ClickableComponent",cl);class hl extends cl{constructor(e,i){super(e,i);this.update(),this.update_=r=>this.update(r),e.on("posterchange",this.update_)}dispose(){this.player().off("posterchange",this.update_),super.dispose()}createEl(){return Xt("div",{className:"vjs-poster"})}crossOrigin(e){if(typeof e=="undefined")return this.$("img")?this.$("img").crossOrigin:this.player_.tech_&&this.player_.tech_.isReady_?this.player_.crossOrigin():this.player_.options_.crossOrigin||this.player_.options_.crossorigin||null;if(e!==null&&e!=="anonymous"&&e!=="use-credentials"){this.player_.log.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${e}"`);return}this.$("img")&&(this.$("img").crossOrigin=e)}update(e){const i=this.player().poster();this.setSrc(i),i?this.show():this.hide()}setSrc(e){if(!e){this.el_.textContent="";return}this.$("img")||this.el_.appendChild(Xt("picture",{className:"vjs-poster",tabIndex:-1},{},Xt("img",{loading:"lazy",crossOrigin:this.crossOrigin()},{alt:""}))),this.$("img").src=e}handleClick(e){!this.player_.controls()||(this.player_.tech(!0)&&this.player_.tech(!0).focus(),this.player_.paused()?Gr(this.player_.play()):this.player_.pause())}}hl.prototype.crossorigin=hl.prototype.crossOrigin,et.registerComponent("PosterImage",hl);const zn="#222",bd="#ccc",fl={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function Ls(s,e){let i;if(s.length===4)i=s[1]+s[1]+s[2]+s[2]+s[3]+s[3];else if(s.length===7)i=s.slice(1);else throw new Error("Invalid color code provided, "+s+"; must be formatted as e.g. #f0e or #f604e2.");return"rgba("+parseInt(i.slice(0,2),16)+","+parseInt(i.slice(2,4),16)+","+parseInt(i.slice(4,6),16)+","+e+")"}function Dn(s,e,i){try{s.style[e]=i}catch(r){return}}function bn(s){return s?`${s}px`:""}class uu extends et{constructor(e,i,r){super(e,i,r);const o=f=>this.updateDisplay(f),c=f=>{this.updateDisplayOverlay(),this.updateDisplay(f)};e.on("loadstart",f=>this.toggleDisplay(f)),e.on("texttrackchange",o),e.on("loadedmetadata",f=>{this.updateDisplayOverlay(),this.preselectTrack(f)}),e.ready(Ni(this,function(){if(e.tech_&&e.tech_.featuresNativeTextTracks){this.hide();return}e.on("fullscreenchange",c),e.on("playerresize",c);const f=ne().screen.orientation||ne(),y=ne().screen.orientation?"change":"orientationchange";f.addEventListener(y,c),e.on("dispose",()=>f.removeEventListener(y,c));const S=this.options_.playerOptions.tracks||[];for(let O=0;O<S.length;O++)this.player_.addRemoteTextTrack(S[O],!0);this.preselectTrack()}))}preselectTrack(){const e={captions:1,subtitles:1},i=this.player_.textTracks(),r=this.player_.cache_.selectedLanguage;let o,c,f;for(let y=0;y<i.length;y++){const S=i[y];r&&r.enabled&&r.language&&r.language===S.language&&S.kind in e?S.kind===r.kind?f=S:f||(f=S):r&&!r.enabled?(f=null,o=null,c=null):S.default&&(S.kind==="descriptions"&&!o?o=S:S.kind in e&&!c&&(c=S))}f?f.mode="showing":c?c.mode="showing":o&&(o.mode="showing")}toggleDisplay(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()}createEl(){return super.createEl("div",{className:"vjs-text-track-display"},{translate:"yes","aria-live":"off","aria-atomic":"true"})}clearDisplay(){typeof ne().WebVTT=="function"&&ne().WebVTT.processCues(ne(),[],this.el_)}updateDisplay(){const e=this.player_.textTracks(),i=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),i){const f=[];for(let y=0;y<e.length;++y){const S=e[y];S.mode==="showing"&&f.push(S)}this.updateForTrack(f);return}let r=null,o=null,c=e.length;for(;c--;){const f=e[c];f.mode==="showing"&&(f.kind==="descriptions"?r=f:o=f)}o?(this.getAttribute("aria-live")!=="off"&&this.setAttribute("aria-live","off"),this.updateForTrack(o)):r&&(this.getAttribute("aria-live")!=="assertive"&&this.setAttribute("aria-live","assertive"),this.updateForTrack(r))}updateDisplayOverlay(){if(!this.player_.videoHeight()||!ne().CSS.supports("inset-inline: 10px"))return;const e=this.player_.currentWidth(),i=this.player_.currentHeight(),r=e/i,o=this.player_.videoWidth()/this.player_.videoHeight();let c=0,f=0;Math.abs(r-o)>.1&&(r>o?c=Math.round((e-i*o)/2):f=Math.round((i-e/o)/2)),Dn(this.el_,"insetInline",bn(c)),Dn(this.el_,"insetBlock",bn(f))}updateDisplayState(e){const i=this.player_.textTrackSettings.getValues(),r=e.activeCues;let o=r.length;for(;o--;){const c=r[o];if(!c)continue;const f=c.displayState;if(i.color&&(f.firstChild.style.color=i.color),i.textOpacity&&Dn(f.firstChild,"color",Ls(i.color||"#fff",i.textOpacity)),i.backgroundColor&&(f.firstChild.style.backgroundColor=i.backgroundColor),i.backgroundOpacity&&Dn(f.firstChild,"backgroundColor",Ls(i.backgroundColor||"#000",i.backgroundOpacity)),i.windowColor&&(i.windowOpacity?Dn(f,"backgroundColor",Ls(i.windowColor,i.windowOpacity)):f.style.backgroundColor=i.windowColor),i.edgeStyle&&(i.edgeStyle==="dropshadow"?f.firstChild.style.textShadow=`2px 2px 3px ${zn}, 2px 2px 4px ${zn}, 2px 2px 5px ${zn}`:i.edgeStyle==="raised"?f.firstChild.style.textShadow=`1px 1px ${zn}, 2px 2px ${zn}, 3px 3px ${zn}`:i.edgeStyle==="depressed"?f.firstChild.style.textShadow=`1px 1px ${bd}, 0 1px ${bd}, -1px -1px ${zn}, 0 -1px ${zn}`:i.edgeStyle==="uniform"&&(f.firstChild.style.textShadow=`0 0 4px ${zn}, 0 0 4px ${zn}, 0 0 4px ${zn}, 0 0 4px ${zn}`)),i.fontPercent&&i.fontPercent!==1){const y=ne().parseFloat(f.style.fontSize);f.style.fontSize=y*i.fontPercent+"px",f.style.height="auto",f.style.top="auto"}i.fontFamily&&i.fontFamily!=="default"&&(i.fontFamily==="small-caps"?f.firstChild.style.fontVariant="small-caps":f.firstChild.style.fontFamily=fl[i.fontFamily])}}updateForTrack(e){if(Array.isArray(e)||(e=[e]),typeof ne().WebVTT!="function"||e.every(r=>!r.activeCues))return;const i=[];for(let r=0;r<e.length;++r){const o=e[r];for(let c=0;c<o.activeCues.length;++c)i.push(o.activeCues[c])}ne().WebVTT.processCues(ne(),i,this.el_);for(let r=0;r<e.length;++r){const o=e[r];for(let c=0;c<o.activeCues.length;++c){const f=o.activeCues[c].displayState;$r(f,"vjs-text-track-cue","vjs-text-track-cue-"+(o.language?o.language:r)),o.language&&xr(f,"lang",o.language)}this.player_.textTrackSettings&&this.updateDisplayState(o)}}}et.registerComponent("TextTrackDisplay",uu);class ia extends et{createEl(){const e=this.player_.isAudio(),i=this.localize(e?"Audio Player":"Video Player"),r=Xt("span",{className:"vjs-control-text",textContent:this.localize("{1} is loading.",[i])}),o=super.createEl("div",{className:"vjs-loading-spinner",dir:"ltr"});return o.appendChild(r),o}handleLanguagechange(){this.$(".vjs-control-text").textContent=this.localize("{1} is loading.",[this.player_.isAudio()?"Audio Player":"Video Player"])}}et.registerComponent("LoadingSpinner",ia);class kn extends cl{createEl(e,i={},r={}){e="button",i=Object.assign({className:this.buildCSSClass()},i),r=Object.assign({type:"button"},r);const o=Xt(e,i,r);return this.player_.options_.experimentalSvgIcons||o.appendChild(Xt("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(o),o}addChild(e,i={}){const r=this.constructor.name;return ci.warn(`Adding an actionable (user controllable) child to a Button (${r}) is not supported; use a ClickableComponent instead.`),et.prototype.addChild.call(this,e,i)}enable(){super.enable(),this.el_.removeAttribute("disabled")}disable(){super.disable(),this.el_.setAttribute("disabled","disabled")}handleKeyDown(e){if(e.key===" "||e.key==="Enter"){e.stopPropagation();return}super.handleKeyDown(e)}}et.registerComponent("Button",kn);class na extends kn{constructor(e,i){super(e,i);this.mouseused_=!1,this.setIcon("play"),this.on("mousedown",r=>this.handleMouseDown(r))}buildCSSClass(){return"vjs-big-play-button"}handleClick(e){const i=this.player_.play();if(this.mouseused_&&"clientX"in e&&"clientY"in e){Gr(i),this.player_.tech(!0)&&this.player_.tech(!0).focus();return}const r=this.player_.getChild("controlBar"),o=r&&r.getChild("playToggle");if(!o){this.player_.tech(!0).focus();return}const c=()=>o.focus();Pa(i)?i.then(c,()=>{}):this.setTimeout(c,1)}handleKeyDown(e){this.mouseused_=!1,super.handleKeyDown(e)}handleMouseDown(e){this.mouseused_=!0}}na.prototype.controlText_="Play Video",et.registerComponent("BigPlayButton",na);class xd extends kn{constructor(e,i){super(e,i);this.setIcon("cancel"),this.controlText(i&&i.controlText||this.localize("Close"))}buildCSSClass(){return`vjs-close-button ${super.buildCSSClass()}`}handleClick(e){this.trigger({type:"close",bubbles:!1})}handleKeyDown(e){e.key==="Escape"?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):super.handleKeyDown(e)}}et.registerComponent("CloseButton",xd);class Ed extends kn{constructor(e,i={}){super(e,i);i.replay=i.replay===void 0||i.replay,this.setIcon("play"),this.on(e,"play",r=>this.handlePlay(r)),this.on(e,"pause",r=>this.handlePause(r)),i.replay&&this.on(e,"ended",r=>this.handleEnded(r))}buildCSSClass(){return`vjs-play-control ${super.buildCSSClass()}`}handleClick(e){this.player_.paused()?Gr(this.player_.play()):this.player_.pause()}handleSeeked(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)}handlePlay(e){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.setIcon("pause"),this.controlText("Pause")}handlePause(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.setIcon("play"),this.controlText("Play")}handleEnded(e){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.setIcon("replay"),this.controlText("Replay"),this.one(this.player_,"seeked",i=>this.handleSeeked(i))}}Ed.prototype.controlText_="Play",et.registerComponent("PlayToggle",Ed);class Fa extends et{constructor(e,i){super(e,i);this.on(e,["timeupdate","ended","seeking"],r=>this.update(r)),this.updateTextNode_()}createEl(){const e=this.buildCSSClass(),i=super.createEl("div",{className:`${e} vjs-time-control vjs-control`}),r=Xt("span",{className:"vjs-control-text",textContent:`${this.localize(this.labelText_)}\xA0`},{role:"presentation"});return i.appendChild(r),this.contentEl_=Xt("span",{className:`${e}-display`},{role:"presentation"}),i.appendChild(this.contentEl_),i}dispose(){this.contentEl_=null,this.textNode_=null,super.dispose()}update(e){!this.player_.options_.enableSmoothSeeking&&e.type==="seeking"||this.updateContent(e)}updateTextNode_(e=0){e=ss(e),this.formattedTime_!==e&&(this.formattedTime_=e,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",()=>{if(!this.contentEl_)return;let i=this.textNode_;i&&this.contentEl_.firstChild!==i&&(i=null,ci.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")),this.textNode_=ve().createTextNode(this.formattedTime_),!!this.textNode_&&(i?this.contentEl_.replaceChild(this.textNode_,i):this.contentEl_.appendChild(this.textNode_))}))}updateContent(e){}}Fa.prototype.labelText_="Time",Fa.prototype.controlText_="Time",et.registerComponent("TimeDisplay",Fa);class du extends Fa{buildCSSClass(){return"vjs-current-time"}updateContent(e){let i;this.player_.ended()?i=this.player_.duration():i=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(i)}}du.prototype.labelText_="Current Time",du.prototype.controlText_="Current Time",et.registerComponent("CurrentTimeDisplay",du);class pl extends Fa{constructor(e,i){super(e,i);const r=o=>this.updateContent(o);this.on(e,"durationchange",r),this.on(e,"loadstart",r),this.on(e,"loadedmetadata",r)}buildCSSClass(){return"vjs-duration"}updateContent(e){const i=this.player_.duration();this.updateTextNode_(i)}}pl.prototype.labelText_="Duration",pl.prototype.controlText_="Duration",et.registerComponent("DurationDisplay",pl);class Kc extends et{createEl(){const e=super.createEl("div",{className:"vjs-time-control vjs-time-divider"},{"aria-hidden":!0}),i=super.createEl("div"),r=super.createEl("span",{textContent:"/"});return i.appendChild(r),e.appendChild(i),e}}et.registerComponent("TimeDivider",Kc);class cu extends Fa{constructor(e,i){super(e,i);this.on(e,"durationchange",r=>this.updateContent(r))}buildCSSClass(){return"vjs-remaining-time"}createEl(){const e=super.createEl();return this.options_.displayNegative!==!1&&e.insertBefore(Xt("span",{},{"aria-hidden":!0},"-"),this.contentEl_),e}updateContent(e){if(typeof this.player_.duration()!="number")return;let i;this.player_.ended()?i=0:this.player_.remainingTimeDisplay?i=this.player_.remainingTimeDisplay():i=this.player_.remainingTime(),this.updateTextNode_(i)}}cu.prototype.labelText_="Remaining Time",cu.prototype.controlText_="Remaining Time",et.registerComponent("RemainingTimeDisplay",cu);class Yc extends et{constructor(e,i){super(e,i);this.updateShowing(),this.on(this.player(),"durationchange",r=>this.updateShowing(r))}createEl(){const e=super.createEl("div",{className:"vjs-live-control vjs-control"});return this.contentEl_=Xt("div",{className:"vjs-live-display"},{"aria-live":"off"}),this.contentEl_.appendChild(Xt("span",{className:"vjs-control-text",textContent:`${this.localize("Stream Type")}\xA0`})),this.contentEl_.appendChild(ve().createTextNode(this.localize("LIVE"))),e.appendChild(this.contentEl_),e}dispose(){this.contentEl_=null,super.dispose()}updateShowing(e){this.player().duration()===Infinity?this.show():this.hide()}}et.registerComponent("LiveDisplay",Yc);class Td extends kn{constructor(e,i){super(e,i);this.updateLiveEdgeStatus(),this.player_.liveTracker&&(this.updateLiveEdgeStatusHandler_=r=>this.updateLiveEdgeStatus(r),this.on(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_))}createEl(){const e=super.createEl("button",{className:"vjs-seek-to-live-control vjs-control"});return this.setIcon("circle",e),this.textEl_=Xt("span",{className:"vjs-seek-to-live-text",textContent:this.localize("LIVE")},{"aria-hidden":"true"}),e.appendChild(this.textEl_),e}updateLiveEdgeStatus(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))}handleClick(){this.player_.liveTracker.seekToLiveEdge()}dispose(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_),this.textEl_=null,super.dispose()}}Td.prototype.controlText_="Seek to live, currently playing live",et.registerComponent("SeekToLive",Td);function fo(s,e,i){return s=Number(s),Math.min(i,Math.max(e,isNaN(s)?e:s))}var Xc=Object.freeze({__proto__:null,clamp:fo});class hu extends et{constructor(e,i){super(e,i);this.handleMouseDown_=r=>this.handleMouseDown(r),this.handleMouseUp_=r=>this.handleMouseUp(r),this.handleKeyDown_=r=>this.handleKeyDown(r),this.handleClick_=r=>this.handleClick(r),this.handleMouseMove_=r=>this.handleMouseMove(r),this.update_=r=>this.update(r),this.bar=this.getChild(this.options_.barName),this.vertical(!!this.options_.vertical),this.enable()}enabled(){return this.enabled_}enable(){this.enabled()||(this.on("mousedown",this.handleMouseDown_),this.on("touchstart",this.handleMouseDown_),this.on("keydown",this.handleKeyDown_),this.on("click",this.handleClick_),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)}disable(){if(!this.enabled())return;const e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown_),this.off("touchstart",this.handleMouseDown_),this.off("keydown",this.handleKeyDown_),this.off("click",this.handleClick_),this.off(this.player_,"controlsvisible",this.update_),this.off(e,"mousemove",this.handleMouseMove_),this.off(e,"mouseup",this.handleMouseUp_),this.off(e,"touchmove",this.handleMouseMove_),this.off(e,"touchend",this.handleMouseUp_),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}createEl(e,i={},r={}){return i.className=i.className+" vjs-slider",i=Object.assign({tabIndex:0},i),r=Object.assign({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100},r),super.createEl(e,i,r)}handleMouseDown(e){const i=this.bar.el_.ownerDocument;e.type==="mousedown"&&e.preventDefault(),e.type==="touchstart"&&!dr&&e.preventDefault(),D(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(i,"mousemove",this.handleMouseMove_),this.on(i,"mouseup",this.handleMouseUp_),this.on(i,"touchmove",this.handleMouseMove_),this.on(i,"touchend",this.handleMouseUp_),this.handleMouseMove(e,!0)}handleMouseMove(e){}handleMouseUp(e){const i=this.bar.el_.ownerDocument;z(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(i,"mousemove",this.handleMouseMove_),this.off(i,"mouseup",this.handleMouseUp_),this.off(i,"touchmove",this.handleMouseMove_),this.off(i,"touchend",this.handleMouseUp_),this.update()}update(){if(!this.el_||!this.bar)return;const e=this.getProgress();return e===this.progress_||(this.progress_=e,this.requestNamedAnimationFrame("Slider#update",()=>{const i=this.vertical()?"height":"width";this.bar.el().style[i]=(e*100).toFixed(2)+"%"})),e}getProgress(){return Number(fo(this.getPercent(),0,1).toFixed(4))}calculateDistance(e){const i=N(this.el_,e);return this.vertical()?i.y:i.x}handleKeyDown(e){const i=this.options_.playerOptions.spatialNavigation,r=i&&i.enabled,o=i&&i.horizontalSeek;r?o&&e.key==="ArrowLeft"||!o&&e.key==="ArrowDown"?(e.preventDefault(),e.stopPropagation(),this.stepBack()):o&&e.key==="ArrowRight"||!o&&e.key==="ArrowUp"?(e.preventDefault(),e.stopPropagation(),this.stepForward()):super.handleKeyDown(e):e.key==="ArrowLeft"||e.key==="ArrowDown"?(e.preventDefault(),e.stopPropagation(),this.stepBack()):e.key==="ArrowUp"||e.key==="ArrowRight"?(e.preventDefault(),e.stopPropagation(),this.stepForward()):super.handleKeyDown(e)}handleClick(e){e.stopPropagation(),e.preventDefault()}vertical(e){if(e===void 0)return this.vertical_||!1;this.vertical_=!!e,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")}}et.registerComponent("Slider",hu);const fu=(s,e)=>fo(s/e*100,0,100).toFixed(2)+"%";class qr extends et{constructor(e,i){super(e,i);this.partEls_=[],this.on(e,"progress",r=>this.update(r))}createEl(){const e=super.createEl("div",{className:"vjs-load-progress"}),i=Xt("span",{className:"vjs-control-text"}),r=Xt("span",{textContent:this.localize("Loaded")}),o=ve().createTextNode(": ");return this.percentageEl_=Xt("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),e.appendChild(i),i.appendChild(r),i.appendChild(o),i.appendChild(this.percentageEl_),e}dispose(){this.partEls_=null,this.percentageEl_=null,super.dispose()}update(e){this.requestNamedAnimationFrame("LoadProgressBar#update",()=>{const i=this.player_.liveTracker,r=this.player_.buffered(),o=i&&i.isLive()?i.seekableEnd():this.player_.duration(),c=this.player_.bufferedEnd(),f=this.partEls_,y=fu(c,o);this.percent_!==y&&(this.el_.style.width=y,Vn(this.percentageEl_,y),this.percent_=y);for(let S=0;S<r.length;S++){const O=r.start(S),q=r.end(S);let de=f[S];de||(de=this.el_.appendChild(Xt()),f[S]=de),!(de.dataset.start===O&&de.dataset.end===q)&&(de.dataset.start=O,de.dataset.end=q,de.style.left=fu(O,c),de.style.width=fu(q-O,c))}for(let S=f.length;S>r.length;S--)this.el_.removeChild(f[S-1]);f.length=r.length})}}et.registerComponent("LoadProgressBar",qr);class Qc extends et{constructor(e,i){super(e,i);this.update=Gn(Ni(this,this.update),Hn)}createEl(){return super.createEl("div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})}update(e,i,r){const o=P(this.el_),c=x(this.player_.el()),f=e.width*i;if(!c||!o)return;let y=e.left-c.left+f,S=e.width-f+(c.right-e.right);S||(S=e.width-f,y=f);let O=o.width/2;y<O?O+=O-y:S<O&&(O=S),O<0?O=0:O>o.width&&(O=o.width),O=Math.round(O),this.el_.style.right=`-${O}px`,this.write(r)}write(e){Vn(this.el_,e)}updateTime(e,i,r,o){this.requestNamedAnimationFrame("TimeTooltip#updateTime",()=>{let c;const f=this.player_.duration();if(this.player_.liveTracker&&this.player_.liveTracker.isLive()){const y=this.player_.liveTracker.liveWindow(),S=y-i*y;c=(S<1?"":"-")+ss(S,y)}else c=ss(r,f);this.update(e,i,c),o&&o()})}}et.registerComponent("TimeTooltip",Qc);class pu extends et{constructor(e,i){super(e,i);this.setIcon("circle"),this.update=Gn(Ni(this,this.update),Hn)}createEl(){return super.createEl("div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})}update(e,i){const r=this.getChild("timeTooltip");if(!r)return;const o=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();r.updateTime(e,i,o)}}pu.prototype.options_={children:[]},!an&&!oi&&pu.prototype.options_.children.push("timeTooltip"),et.registerComponent("PlayProgressBar",pu);class Sd extends et{constructor(e,i){super(e,i);this.update=Gn(Ni(this,this.update),Hn)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(e,i){const r=i*this.player_.duration();this.getChild("timeTooltip").updateTime(e,i,r,()=>{this.el_.style.left=`${e.width*i}px`})}}Sd.prototype.options_={children:["timeTooltip"]},et.registerComponent("MouseTimeDisplay",Sd);const po=5,Cd=12;class ml extends hu{constructor(e,i){super(e,i);this.setEventHandlers_()}setEventHandlers_(){this.update_=Ni(this,this.update),this.update=Gn(this.update_,Hn),this.on(this.player_,["durationchange","timeupdate"],this.update),this.on(this.player_,["ended"],this.update_),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.enableIntervalHandler_=e=>this.enableInterval_(e),this.disableIntervalHandler_=e=>this.disableInterval_(e),this.on(this.player_,["playing"],this.enableIntervalHandler_),this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in ve()&&"visibilityState"in ve()&&this.on(ve(),"visibilitychange",this.toggleVisibility_)}toggleVisibility_(e){ve().visibilityState==="hidden"?(this.cancelNamedAnimationFrame("SeekBar#update"),this.cancelNamedAnimationFrame("Slider#update"),this.disableInterval_(e)):(!this.player_.ended()&&!this.player_.paused()&&this.enableInterval_(),this.update())}enableInterval_(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,Hn))}disableInterval_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&e&&e.type!=="ended"||!this.updateInterval||(this.clearInterval(this.updateInterval),this.updateInterval=null)}createEl(){return super.createEl("div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})}update(e){if(ve().visibilityState==="hidden")return;const i=super.update();return this.requestNamedAnimationFrame("SeekBar#update",()=>{const r=this.player_.ended()?this.player_.duration():this.getCurrentTime_(),o=this.player_.liveTracker;let c=this.player_.duration();o&&o.isLive()&&(c=this.player_.liveTracker.liveCurrentTime()),this.percent_!==i&&(this.el_.setAttribute("aria-valuenow",(i*100).toFixed(2)),this.percent_=i),(this.currentTime_!==r||this.duration_!==c)&&(this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[ss(r,c),ss(c,c)],"{1} of {2}")),this.currentTime_=r,this.duration_=c),this.bar&&this.bar.update(x(this.el()),this.getProgress())}),i}userSeek_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(e)}getCurrentTime_(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()}getPercent(){const e=this.getCurrentTime_();let i;const r=this.player_.liveTracker;return r&&r.isLive()?(i=(e-r.seekableStart())/r.liveWindow(),r.atLiveEdge()&&(i=1)):i=e/this.player_.duration(),i}handleMouseDown(e){!vt(e)||(e.stopPropagation(),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),super.handleMouseDown(e))}handleMouseMove(e,i=!1){if(!vt(e)||isNaN(this.player_.duration()))return;!i&&!this.player_.scrubbing()&&this.player_.scrubbing(!0);let r;const o=this.calculateDistance(e),c=this.player_.liveTracker;if(!c||!c.isLive())r=o*this.player_.duration(),r===this.player_.duration()&&(r=r-.1);else{if(o>=.99){c.seekToLiveEdge();return}const f=c.seekableStart(),y=c.liveCurrentTime();if(r=f+o*c.liveWindow(),r>=y&&(r=y),r<=f&&(r=f+.1),r===Infinity)return}this.userSeek_(r),this.player_.options_.enableSmoothSeeking&&this.update()}enable(){super.enable();const e=this.getChild("mouseTimeDisplay");!e||e.show()}disable(){super.disable();const e=this.getChild("mouseTimeDisplay");!e||e.hide()}handleMouseUp(e){super.handleMouseUp(e),e&&e.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?Gr(this.player_.play()):this.update_()}stepForward(){this.userSeek_(this.player_.currentTime()+po)}stepBack(){this.userSeek_(this.player_.currentTime()-po)}handleAction(e){this.player_.paused()?this.player_.play():this.player_.pause()}handleKeyDown(e){const i=this.player_.liveTracker;if(e.key===" "||e.key==="Enter")e.preventDefault(),e.stopPropagation(),this.handleAction(e);else if(e.key==="Home")e.preventDefault(),e.stopPropagation(),this.userSeek_(0);else if(e.key==="End")e.preventDefault(),e.stopPropagation(),i&&i.isLive()?this.userSeek_(i.liveCurrentTime()):this.userSeek_(this.player_.duration());else if(/^[0-9]$/.test(e.key)){e.preventDefault(),e.stopPropagation();const r=parseInt(e.key,10)*.1;i&&i.isLive()?this.userSeek_(i.seekableStart()+i.liveWindow()*r):this.userSeek_(this.player_.duration()*r)}else e.key==="PageDown"?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()-po*Cd)):e.key==="PageUp"?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()+po*Cd)):super.handleKeyDown(e)}dispose(){this.disableInterval_(),this.off(this.player_,["durationchange","timeupdate"],this.update),this.off(this.player_,["ended"],this.update_),this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableIntervalHandler_),this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in ve()&&"visibilityState"in ve()&&this.off(ve(),"visibilitychange",this.toggleVisibility_),super.dispose()}}ml.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},!an&&!oi&&ml.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),et.registerComponent("SeekBar",ml);class wd extends et{constructor(e,i){super(e,i);this.handleMouseMove=Gn(Ni(this,this.handleMouseMove),Hn),this.throttledHandleMouseSeek=Gn(Ni(this,this.handleMouseSeek),Hn),this.handleMouseUpHandler_=r=>this.handleMouseUp(r),this.handleMouseDownHandler_=r=>this.handleMouseDown(r),this.enable()}createEl(){return super.createEl("div",{className:"vjs-progress-control vjs-control"})}handleMouseMove(e){const i=this.getChild("seekBar");if(!i)return;const r=i.getChild("playProgressBar"),o=i.getChild("mouseTimeDisplay");if(!r&&!o)return;const c=i.el(),f=P(c);let y=N(c,e).x;y=fo(y,0,1),o&&o.update(f,y),r&&r.update(f,i.getProgress())}handleMouseSeek(e){const i=this.getChild("seekBar");i&&i.handleMouseMove(e)}enabled(){return this.enabled_}disable(){if(this.children().forEach(e=>e.disable&&e.disable()),!!this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDownHandler_),this.off(this.el_,"mousemove",this.handleMouseMove),this.removeListenersAddedOnMousedownAndTouchstart(),this.addClass("disabled"),this.enabled_=!1,this.player_.scrubbing())){const e=this.getChild("seekBar");this.player_.scrubbing(!1),e.videoWasPlaying&&Gr(this.player_.play())}}enable(){this.children().forEach(e=>e.enable&&e.enable()),!this.enabled()&&(this.on(["mousedown","touchstart"],this.handleMouseDownHandler_),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)}removeListenersAddedOnMousedownAndTouchstart(){const e=this.el_.ownerDocument;this.off(e,"mousemove",this.throttledHandleMouseSeek),this.off(e,"touchmove",this.throttledHandleMouseSeek),this.off(e,"mouseup",this.handleMouseUpHandler_),this.off(e,"touchend",this.handleMouseUpHandler_)}handleMouseDown(e){const i=this.el_.ownerDocument,r=this.getChild("seekBar");r&&r.handleMouseDown(e),this.on(i,"mousemove",this.throttledHandleMouseSeek),this.on(i,"touchmove",this.throttledHandleMouseSeek),this.on(i,"mouseup",this.handleMouseUpHandler_),this.on(i,"touchend",this.handleMouseUpHandler_)}handleMouseUp(e){const i=this.getChild("seekBar");i&&i.handleMouseUp(e),this.removeListenersAddedOnMousedownAndTouchstart()}}wd.prototype.options_={children:["seekBar"]},et.registerComponent("ProgressControl",wd);class Ld extends kn{constructor(e,i){super(e,i);this.setIcon("picture-in-picture-enter"),this.on(e,["enterpictureinpicture","leavepictureinpicture"],r=>this.handlePictureInPictureChange(r)),this.on(e,["disablepictureinpicturechanged","loadedmetadata"],r=>this.handlePictureInPictureEnabledChange(r)),this.on(e,["loadedmetadata","audioonlymodechange","audiopostermodechange"],()=>this.handlePictureInPictureAudioModeChange()),this.disable()}buildCSSClass(){return`vjs-picture-in-picture-control vjs-hidden ${super.buildCSSClass()}`}handlePictureInPictureAudioModeChange(){if(!(this.player_.currentType().substring(0,5)==="audio"||this.player_.audioPosterMode()||this.player_.audioOnlyMode())){this.show();return}this.player_.isInPictureInPicture()&&this.player_.exitPictureInPicture(),this.hide()}handlePictureInPictureEnabledChange(){ve().pictureInPictureEnabled&&this.player_.disablePictureInPicture()===!1||this.player_.options_.enableDocumentPictureInPicture&&"documentPictureInPicture"in ne()?this.enable():this.disable()}handlePictureInPictureChange(e){this.player_.isInPictureInPicture()?(this.setIcon("picture-in-picture-exit"),this.controlText("Exit Picture-in-Picture")):(this.setIcon("picture-in-picture-enter"),this.controlText("Picture-in-Picture")),this.handlePictureInPictureEnabledChange()}handleClick(e){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()}show(){typeof ve().exitPictureInPicture=="function"&&super.show()}}Ld.prototype.controlText_="Picture-in-Picture",et.registerComponent("PictureInPictureToggle",Ld);class Dd extends kn{constructor(e,i){super(e,i);this.setIcon("fullscreen-enter"),this.on(e,"fullscreenchange",r=>this.handleFullscreenChange(r)),ve()[e.fsApi_.fullscreenEnabled]===!1&&this.disable()}buildCSSClass(){return`vjs-fullscreen-control ${super.buildCSSClass()}`}handleFullscreenChange(e){this.player_.isFullscreen()?(this.controlText("Exit Fullscreen"),this.setIcon("fullscreen-exit")):(this.controlText("Fullscreen"),this.setIcon("fullscreen-enter"))}handleClick(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()}}Dd.prototype.controlText_="Fullscreen",et.registerComponent("FullscreenToggle",Dd);const Jc=function(s,e){e.tech_&&!e.tech_.featuresVolumeControl&&s.addClass("vjs-hidden"),s.on(e,"loadstart",function(){e.tech_.featuresVolumeControl?s.removeClass("vjs-hidden"):s.addClass("vjs-hidden")})};class kd extends et{createEl(){const e=super.createEl("div",{className:"vjs-volume-level"});return this.setIcon("circle",e),e.appendChild(super.createEl("span",{className:"vjs-control-text"})),e}}et.registerComponent("VolumeLevel",kd);class mu extends et{constructor(e,i){super(e,i);this.update=Gn(Ni(this,this.update),Hn)}createEl(){return super.createEl("div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})}update(e,i,r,o){if(!r){const c=x(this.el_),f=x(this.player_.el()),y=e.width*i;if(!f||!c)return;const S=e.left-f.left+y,O=e.width-y+(f.right-e.right);let q=c.width/2;S<q?q+=q-S:O<q&&(q=O),q<0?q=0:q>c.width&&(q=c.width),this.el_.style.right=`-${q}px`}this.write(`${o}%`)}write(e){Vn(this.el_,e)}updateVolume(e,i,r,o,c){this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",()=>{this.update(e,i,r,o.toFixed(0)),c&&c()})}}et.registerComponent("VolumeLevelTooltip",mu);class gl extends et{constructor(e,i){super(e,i);this.update=Gn(Ni(this,this.update),Hn)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(e,i,r){const o=100*i;this.getChild("volumeLevelTooltip").updateVolume(e,i,r,o,()=>{r?this.el_.style.bottom=`${e.height*i}px`:this.el_.style.left=`${e.width*i}px`})}}gl.prototype.options_={children:["volumeLevelTooltip"]},et.registerComponent("MouseVolumeLevelDisplay",gl);class Na extends hu{constructor(e,i){super(e,i);this.on("slideractive",r=>this.updateLastVolume_(r)),this.on(e,"volumechange",r=>this.updateARIAAttributes(r)),e.ready(()=>this.updateARIAAttributes())}createEl(){return super.createEl("div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})}handleMouseDown(e){!vt(e)||super.handleMouseDown(e)}handleMouseMove(e){const i=this.getChild("mouseVolumeLevelDisplay");if(i){const r=this.el(),o=x(r),c=this.vertical();let f=N(r,e);f=c?f.y:f.x,f=fo(f,0,1),i.update(o,f,c)}!vt(e)||(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))}checkMuted(){this.player_.muted()&&this.player_.muted(!1)}getPercent(){return this.player_.muted()?0:this.player_.volume()}stepForward(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)}stepBack(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)}updateARIAAttributes(e){const i=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",i),this.el_.setAttribute("aria-valuetext",i+"%")}volumeAsPercentage_(){return Math.round(this.player_.volume()*100)}updateLastVolume_(){const e=this.player_.volume();this.one("sliderinactive",()=>{this.player_.volume()===0&&this.player_.lastVolume_(e)})}}Na.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},!an&&!oi&&Na.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay"),Na.prototype.playerEvent="volumechange",et.registerComponent("VolumeBar",Na);class gu extends et{constructor(e,i={}){i.vertical=i.vertical||!1,(typeof i.volumeBar=="undefined"||lr(i.volumeBar))&&(i.volumeBar=i.volumeBar||{},i.volumeBar.vertical=i.vertical),super(e,i),Jc(this,e),this.throttledHandleMouseMove=Gn(Ni(this,this.handleMouseMove),Hn),this.handleMouseUpHandler_=r=>this.handleMouseUp(r),this.on("mousedown",r=>this.handleMouseDown(r)),this.on("touchstart",r=>this.handleMouseDown(r)),this.on("mousemove",r=>this.handleMouseMove(r)),this.on(this.volumeBar,["focus","slideractive"],()=>{this.volumeBar.addClass("vjs-slider-active"),this.addClass("vjs-slider-active"),this.trigger("slideractive")}),this.on(this.volumeBar,["blur","sliderinactive"],()=>{this.volumeBar.removeClass("vjs-slider-active"),this.removeClass("vjs-slider-active"),this.trigger("sliderinactive")})}createEl(){let e="vjs-volume-horizontal";return this.options_.vertical&&(e="vjs-volume-vertical"),super.createEl("div",{className:`vjs-volume-control vjs-control ${e}`})}handleMouseDown(e){const i=this.el_.ownerDocument;this.on(i,"mousemove",this.throttledHandleMouseMove),this.on(i,"touchmove",this.throttledHandleMouseMove),this.on(i,"mouseup",this.handleMouseUpHandler_),this.on(i,"touchend",this.handleMouseUpHandler_)}handleMouseUp(e){const i=this.el_.ownerDocument;this.off(i,"mousemove",this.throttledHandleMouseMove),this.off(i,"touchmove",this.throttledHandleMouseMove),this.off(i,"mouseup",this.handleMouseUpHandler_),this.off(i,"touchend",this.handleMouseUpHandler_)}handleMouseMove(e){this.volumeBar.handleMouseMove(e)}}gu.prototype.options_={children:["volumeBar"]},et.registerComponent("VolumeControl",gu);const Zc=function(s,e){e.tech_&&!e.tech_.featuresMuteControl&&s.addClass("vjs-hidden"),s.on(e,"loadstart",function(){e.tech_.featuresMuteControl?s.removeClass("vjs-hidden"):s.addClass("vjs-hidden")})};class Id extends kn{constructor(e,i){super(e,i);Zc(this,e),this.on(e,["loadstart","volumechange"],r=>this.update(r))}buildCSSClass(){return`vjs-mute-control ${super.buildCSSClass()}`}handleClick(e){const i=this.player_.volume(),r=this.player_.lastVolume_();if(i===0){const o=r<.1?.1:r;this.player_.volume(o),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())}update(e){this.updateIcon_(),this.updateControlText_()}updateIcon_(){const e=this.player_.volume();let i=3;this.setIcon("volume-high"),an&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),e===0||this.player_.muted()?(this.setIcon("volume-mute"),i=0):e<.33?(this.setIcon("volume-low"),i=1):e<.67&&(this.setIcon("volume-medium"),i=2),Qs(this.el_,[0,1,2,3].reduce((r,o)=>r+`${o?" ":""}vjs-vol-${o}`,"")),$r(this.el_,`vjs-vol-${i}`)}updateControlText_(){const i=this.player_.muted()||this.player_.volume()===0?"Unmute":"Mute";this.controlText()!==i&&this.controlText(i)}}Id.prototype.controlText_="Mute",et.registerComponent("MuteToggle",Id);class Rd extends et{constructor(e,i={}){typeof i.inline!="undefined"?i.inline=i.inline:i.inline=!0,(typeof i.volumeControl=="undefined"||lr(i.volumeControl))&&(i.volumeControl=i.volumeControl||{},i.volumeControl.vertical=!i.inline),super(e,i),this.handleKeyPressHandler_=r=>this.handleKeyPress(r),this.on(e,["loadstart"],r=>this.volumePanelState_(r)),this.on(this.muteToggle,"keyup",r=>this.handleKeyPress(r)),this.on(this.volumeControl,"keyup",r=>this.handleVolumeControlKeyUp(r)),this.on("keydown",r=>this.handleKeyPress(r)),this.on("mouseover",r=>this.handleMouseOver(r)),this.on("mouseout",r=>this.handleMouseOut(r)),this.on(this.volumeControl,["slideractive"],this.sliderActive_),this.on(this.volumeControl,["sliderinactive"],this.sliderInactive_)}sliderActive_(){this.addClass("vjs-slider-active")}sliderInactive_(){this.removeClass("vjs-slider-active")}volumePanelState_(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")}createEl(){let e="vjs-volume-panel-horizontal";return this.options_.inline||(e="vjs-volume-panel-vertical"),super.createEl("div",{className:`vjs-volume-panel vjs-control ${e}`})}dispose(){this.handleMouseOut(),super.dispose()}handleVolumeControlKeyUp(e){e.key==="Escape"&&this.muteToggle.focus()}handleMouseOver(e){this.addClass("vjs-hover"),yn(ve(),"keyup",this.handleKeyPressHandler_)}handleMouseOut(e){this.removeClass("vjs-hover"),wn(ve(),"keyup",this.handleKeyPressHandler_)}handleKeyPress(e){e.key==="Escape"&&this.handleMouseOut()}}Rd.prototype.options_={children:["muteToggle","volumeControl"]},et.registerComponent("VolumePanel",Rd);class Pd extends kn{constructor(e,i){super(e,i);this.validOptions=[5,10,30],this.skipTime=this.getSkipForwardTime(),this.skipTime&&this.validOptions.includes(this.skipTime)?(this.setIcon(`forward-${this.skipTime}`),this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime.toLocaleString(e.language())])),this.show()):this.hide()}getSkipForwardTime(){const e=this.options_.playerOptions;return e.controlBar&&e.controlBar.skipButtons&&e.controlBar.skipButtons.forward}buildCSSClass(){return`vjs-skip-forward-${this.getSkipForwardTime()} ${super.buildCSSClass()}`}handleClick(e){if(isNaN(this.player_.duration()))return;const i=this.player_.currentTime(),r=this.player_.liveTracker,o=r&&r.isLive()?r.seekableEnd():this.player_.duration();let c;i+this.skipTime<=o?c=i+this.skipTime:c=o,this.player_.currentTime(c)}handleLanguagechange(){this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime]))}}Pd.prototype.controlText_="Skip Forward",et.registerComponent("SkipForward",Pd);class Od extends kn{constructor(e,i){super(e,i);this.validOptions=[5,10,30],this.skipTime=this.getSkipBackwardTime(),this.skipTime&&this.validOptions.includes(this.skipTime)?(this.setIcon(`replay-${this.skipTime}`),this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime.toLocaleString(e.language())])),this.show()):this.hide()}getSkipBackwardTime(){const e=this.options_.playerOptions;return e.controlBar&&e.controlBar.skipButtons&&e.controlBar.skipButtons.backward}buildCSSClass(){return`vjs-skip-backward-${this.getSkipBackwardTime()} ${super.buildCSSClass()}`}handleClick(e){const i=this.player_.currentTime(),r=this.player_.liveTracker,o=r&&r.isLive()&&r.seekableStart();let c;o&&i-this.skipTime<=o?c=o:i>=this.skipTime?c=i-this.skipTime:c=0,this.player_.currentTime(c)}handleLanguagechange(){this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime]))}}Od.prototype.controlText_="Skip Backward",et.registerComponent("SkipBackward",Od);class Bd extends et{constructor(e,i){super(e,i);i&&(this.menuButton_=i.menuButton),this.focusedChild_=-1,this.on("keydown",r=>this.handleKeyDown(r)),this.boundHandleBlur_=r=>this.handleBlur(r),this.boundHandleTapClick_=r=>this.handleTapClick(r)}addEventListenerForItem(e){e instanceof et&&(this.on(e,"blur",this.boundHandleBlur_),this.on(e,["tap","click"],this.boundHandleTapClick_))}removeEventListenerForItem(e){e instanceof et&&(this.off(e,"blur",this.boundHandleBlur_),this.off(e,["tap","click"],this.boundHandleTapClick_))}removeChild(e){typeof e=="string"&&(e=this.getChild(e)),this.removeEventListenerForItem(e),super.removeChild(e)}addItem(e){const i=this.addChild(e);i&&this.addEventListenerForItem(i)}createEl(){const e=this.options_.contentElType||"ul";this.contentEl_=Xt(e,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");const i=super.createEl("div",{append:this.contentEl_,className:"vjs-menu"});return i.appendChild(this.contentEl_),yn(i,"click",function(r){r.preventDefault(),r.stopImmediatePropagation()}),i}dispose(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,super.dispose()}handleBlur(e){const i=e.relatedTarget||ve().activeElement;if(!this.children().some(r=>r.el()===i)){const r=this.menuButton_;r&&r.buttonPressed_&&i!==r.el().firstChild&&r.unpressButton()}}handleTapClick(e){if(this.menuButton_){this.menuButton_.unpressButton();const i=this.children();if(!Array.isArray(i))return;const r=i.filter(o=>o.el()===e.target)[0];if(!r)return;r.name()!=="CaptionSettingsMenuItem"&&this.menuButton_.focus()}}handleKeyDown(e){e.key==="ArrowLeft"||e.key==="ArrowDown"?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(e.key==="ArrowRight"||e.key==="ArrowUp")&&(e.preventDefault(),e.stopPropagation(),this.stepBack())}stepForward(){let e=0;this.focusedChild_!==void 0&&(e=this.focusedChild_+1),this.focus(e)}stepBack(){let e=0;this.focusedChild_!==void 0&&(e=this.focusedChild_-1),this.focus(e)}focus(e=0){const i=this.children().slice();i.length&&i[0].hasClass("vjs-menu-title")&&i.shift(),i.length>0&&(e<0?e=0:e>=i.length&&(e=i.length-1),this.focusedChild_=e,i[e].el_.focus())}}et.registerComponent("Menu",Bd);class yu extends et{constructor(e,i={}){super(e,i);this.menuButton_=new kn(e,i),this.menuButton_.controlText(this.controlText_),this.menuButton_.el_.setAttribute("aria-haspopup","true");const r=kn.prototype.buildCSSClass();this.menuButton_.el_.className=this.buildCSSClass()+" "+r,this.menuButton_.removeClass("vjs-control"),this.addChild(this.menuButton_),this.update(),this.enabled_=!0;const o=c=>this.handleClick(c);this.handleMenuKeyUp_=c=>this.handleMenuKeyUp(c),this.on(this.menuButton_,"tap",o),this.on(this.menuButton_,"click",o),this.on(this.menuButton_,"keydown",c=>this.handleKeyDown(c)),this.on(this.menuButton_,"mouseenter",()=>{this.addClass("vjs-hover"),this.menu.show(),yn(ve(),"keyup",this.handleMenuKeyUp_)}),this.on("mouseleave",c=>this.handleMouseLeave(c)),this.on("keydown",c=>this.handleSubmenuKeyDown(c))}update(){const e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?(this.hide(),this.menu.contentEl_.removeAttribute("role")):(this.show(),this.menu.contentEl_.setAttribute("role","menu"))}createMenu(){const e=new Bd(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){const i=Xt("li",{className:"vjs-menu-title",textContent:zi(this.options_.title),tabIndex:-1}),r=new et(this.player_,{el:i});e.addItem(r)}if(this.items=this.createItems(),this.items)for(let i=0;i<this.items.length;i++)e.addItem(this.items[i]);return e}createItems(){}createEl(){return super.createEl("div",{className:this.buildWrapperCSSClass()},{})}setIcon(e){super.setIcon(e,this.menuButton_.el_)}buildWrapperCSSClass(){let e="vjs-menu-button";this.options_.inline===!0?e+="-inline":e+="-popup";const i=kn.prototype.buildCSSClass();return`vjs-menu-button ${e} ${i} ${super.buildCSSClass()}`}buildCSSClass(){let e="vjs-menu-button";return this.options_.inline===!0?e+="-inline":e+="-popup",`vjs-menu-button ${e} ${super.buildCSSClass()}`}controlText(e,i=this.menuButton_.el()){return this.menuButton_.controlText(e,i)}dispose(){this.handleMouseLeave(),super.dispose()}handleClick(e){this.buttonPressed_?this.unpressButton():this.pressButton()}handleMouseLeave(e){this.removeClass("vjs-hover"),wn(ve(),"keyup",this.handleMenuKeyUp_)}focus(){this.menuButton_.focus()}blur(){this.menuButton_.blur()}handleKeyDown(e){e.key==="Esc"||e.key==="Tab"?(this.buttonPressed_&&this.unpressButton(),!e.key==="Tab"&&(e.preventDefault(),this.menuButton_.focus())):(e.key==="Up"||e.key==="Down"&&!(this.player_.options_.playerOptions.spatialNavigation&&this.player_.options_.playerOptions.spatialNavigation.enabled))&&(this.buttonPressed_||(e.preventDefault(),this.pressButton()))}handleMenuKeyUp(e){(e.key==="Esc"||e.key==="Tab")&&this.removeClass("vjs-hover")}handleSubmenuKeyPress(e){this.handleSubmenuKeyDown(e)}handleSubmenuKeyDown(e){(e.key==="Esc"||e.key==="Tab")&&(this.buttonPressed_&&this.unpressButton(),!e.key==="Tab"&&(e.preventDefault(),this.menuButton_.focus()))}pressButton(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),an&&Ko())return;this.menu.focus()}}unpressButton(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))}disable(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()}enable(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()}}et.registerComponent("MenuButton",yu);class Ua extends yu{constructor(e,i){const r=i.tracks;super(e,i);if(this.items.length<=1&&this.hide(),!r)return;const o=Ni(this,this.update);r.addEventListener("removetrack",o),r.addEventListener("addtrack",o),r.addEventListener("labelchange",o),this.player_.on("ready",o),this.player_.on("dispose",function(){r.removeEventListener("removetrack",o),r.removeEventListener("addtrack",o),r.removeEventListener("labelchange",o)})}}et.registerComponent("TrackButton",Ua);class mo extends cl{constructor(e,i){super(e,i);this.selectable=i.selectable,this.isSelected_=i.selected||!1,this.multiSelectable=i.multiSelectable,this.selected(this.isSelected_),this.selectable?this.multiSelectable?this.el_.setAttribute("role","menuitemcheckbox"):this.el_.setAttribute("role","menuitemradio"):this.el_.setAttribute("role","menuitem")}createEl(e,i,r){this.nonIconControl=!0;const o=super.createEl("li",Object.assign({className:"vjs-menu-item",tabIndex:-1},i),r),c=Xt("span",{className:"vjs-menu-item-text",textContent:this.localize(this.options_.label)});return this.player_.options_.experimentalSvgIcons?o.appendChild(c):o.replaceChild(c,o.querySelector(".vjs-icon-placeholder")),o}handleKeyDown(e){["Tab","Escape","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"].includes(e.key)||super.handleKeyDown(e)}handleClick(e){this.selected(!0)}selected(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))}}et.registerComponent("MenuItem",mo);class Ds extends mo{constructor(e,i){const r=i.track,o=e.textTracks();i.label=r.label||r.language||"Unknown",i.selected=r.mode==="showing",super(e,i),this.track=r,this.kinds=(i.kinds||[i.kind||this.track.kind]).filter(Boolean);const c=(...y)=>{this.handleTracksChange.apply(this,y)},f=(...y)=>{this.handleSelectedLanguageChange.apply(this,y)};if(e.on(["loadstart","texttrackchange"],c),o.addEventListener("change",c),o.addEventListener("selectedlanguagechange",f),this.on("dispose",function(){e.off(["loadstart","texttrackchange"],c),o.removeEventListener("change",c),o.removeEventListener("selectedlanguagechange",f)}),o.onchange===void 0){let y;this.on(["tap","click"],function(){if(typeof ne().Event!="object")try{y=new(ne()).Event("change")}catch(S){}y||(y=ve().createEvent("Event"),y.initEvent("change",!0,!0)),o.dispatchEvent(y)})}this.handleTracksChange()}handleClick(e){const i=this.track,r=this.player_.textTracks();if(super.handleClick(e),!!r)for(let o=0;o<r.length;o++){const c=r[o];this.kinds.indexOf(c.kind)!==-1&&(c===i?c.mode!=="showing"&&(c.mode="showing"):c.mode!=="disabled"&&(c.mode="disabled"))}}handleTracksChange(e){const i=this.track.mode==="showing";i!==this.isSelected_&&this.selected(i)}handleSelectedLanguageChange(e){if(this.track.mode==="showing"){const i=this.player_.cache_.selectedLanguage;if(i&&i.enabled&&i.language===this.track.language&&i.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}}dispose(){this.track=null,super.dispose()}}et.registerComponent("TextTrackMenuItem",Ds);class Md extends Ds{constructor(e,i){i.track={player:e,kind:i.kind,kinds:i.kinds,default:!1,mode:"disabled"},i.kinds||(i.kinds=[i.kind]),i.label?i.track.label=i.label:i.track.label=i.kinds.join(" and ")+" off",i.selectable=!0,i.multiSelectable=!1,super(e,i)}handleTracksChange(e){const i=this.player().textTracks();let r=!0;for(let o=0,c=i.length;o<c;o++){const f=i[o];if(this.options_.kinds.indexOf(f.kind)>-1&&f.mode==="showing"){r=!1;break}}r!==this.isSelected_&&this.selected(r)}handleSelectedLanguageChange(e){const i=this.player().textTracks();let r=!0;for(let o=0,c=i.length;o<c;o++){const f=i[o];if(["captions","descriptions","subtitles"].indexOf(f.kind)>-1&&f.mode==="showing"){r=!1;break}}r&&(this.player_.cache_.selectedLanguage={enabled:!1})}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.label),super.handleLanguagechange()}}et.registerComponent("OffTextTrackMenuItem",Md);class ja extends Ua{constructor(e,i={}){i.tracks=e.textTracks(),super(e,i)}createItems(e=[],i=Ds){let r;this.label_&&(r=`${this.label_} off`),e.push(new Md(this.player_,{kinds:this.kinds_,kind:this.kind_,label:r})),this.hideThreshold_+=1;const o=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(let c=0;c<o.length;c++){const f=o[c];if(this.kinds_.indexOf(f.kind)>-1){const y=new i(this.player_,{track:f,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});y.addClass(`vjs-${f.kind}-menu-item`),e.push(y)}}return e}}et.registerComponent("TextTrackButton",ja);class vu extends mo{constructor(e,i){const r=i.track,o=i.cue,c=e.currentTime();i.selectable=!0,i.multiSelectable=!1,i.label=o.text,i.selected=o.startTime<=c&&c<o.endTime,super(e,i),this.track=r,this.cue=o}handleClick(e){super.handleClick(),this.player_.currentTime(this.cue.startTime)}}et.registerComponent("ChaptersTrackMenuItem",vu);class Au extends ja{constructor(e,i,r){super(e,i,r);this.setIcon("chapters"),this.selectCurrentItem_=()=>{this.items.forEach(o=>{o.selected(this.track_.activeCues[0]===o.cue)})}}buildCSSClass(){return`vjs-chapters-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-chapters-button ${super.buildWrapperCSSClass()}`}update(e){if(e&&e.track&&e.track.kind!=="chapters")return;const i=this.findChaptersTrack();i!==this.track_?(this.setTrack(i),super.update()):(!this.items||i&&i.cues&&i.cues.length!==this.items.length)&&super.update()}setTrack(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){const i=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);i&&i.removeEventListener("load",this.updateHandler_),this.track_.removeEventListener("cuechange",this.selectCurrentItem_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";const i=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);i&&i.addEventListener("load",this.updateHandler_),this.track_.addEventListener("cuechange",this.selectCurrentItem_)}}}findChaptersTrack(){const e=this.player_.textTracks()||[];for(let i=e.length-1;i>=0;i--){const r=e[i];if(r.kind===this.kind_)return r}}getMenuCaption(){return this.track_&&this.track_.label?this.track_.label:this.localize(zi(this.kind_))}createMenu(){return this.options_.title=this.getMenuCaption(),super.createMenu()}createItems(){const e=[];if(!this.track_)return e;const i=this.track_.cues;if(!i)return e;for(let r=0,o=i.length;r<o;r++){const c=i[r],f=new vu(this.player_,{track:this.track_,cue:c});e.push(f)}return e}}Au.prototype.kind_="chapters",Au.prototype.controlText_="Chapters",et.registerComponent("ChaptersButton",Au);class _u extends ja{constructor(e,i,r){super(e,i,r);this.setIcon("audio-description");const o=e.textTracks(),c=Ni(this,this.handleTracksChange);o.addEventListener("change",c),this.on("dispose",function(){o.removeEventListener("change",c)})}handleTracksChange(e){const i=this.player().textTracks();let r=!1;for(let o=0,c=i.length;o<c;o++){const f=i[o];if(f.kind!==this.kind_&&f.mode==="showing"){r=!0;break}}r?this.disable():this.enable()}buildCSSClass(){return`vjs-descriptions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-descriptions-button ${super.buildWrapperCSSClass()}`}}_u.prototype.kind_="descriptions",_u.prototype.controlText_="Descriptions",et.registerComponent("DescriptionsButton",_u);class bu extends ja{constructor(e,i,r){super(e,i,r);this.setIcon("subtitles")}buildCSSClass(){return`vjs-subtitles-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subtitles-button ${super.buildWrapperCSSClass()}`}}bu.prototype.kind_="subtitles",bu.prototype.controlText_="Subtitles",et.registerComponent("SubtitlesButton",bu);class xu extends Ds{constructor(e,i){i.track={player:e,kind:i.kind,label:i.kind+" settings",selectable:!1,default:!1,mode:"disabled"},i.selectable=!1,i.name="CaptionSettingsMenuItem",super(e,i),this.addClass("vjs-texttrack-settings"),this.controlText(", opens "+i.kind+" settings dialog")}handleClick(e){this.player().getChild("textTrackSettings").open()}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.kind+" settings"),super.handleLanguagechange()}}et.registerComponent("CaptionSettingsMenuItem",xu);class yl extends ja{constructor(e,i,r){super(e,i,r);this.setIcon("captions")}buildCSSClass(){return`vjs-captions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-captions-button ${super.buildWrapperCSSClass()}`}createItems(){const e=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(e.push(new xu(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),super.createItems(e)}}yl.prototype.kind_="captions",yl.prototype.controlText_="Captions",et.registerComponent("CaptionsButton",yl);class Fd extends Ds{createEl(e,i,r){const o=super.createEl(e,i,r),c=o.querySelector(".vjs-menu-item-text");return this.options_.track.kind==="captions"&&(this.player_.options_.experimentalSvgIcons?this.setIcon("captions",o):c.appendChild(Xt("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),c.appendChild(Xt("span",{className:"vjs-control-text",textContent:` ${this.localize("Captions")}`}))),o}}et.registerComponent("SubsCapsMenuItem",Fd);class Eu extends ja{constructor(e,i={}){super(e,i);this.label_="subtitles",this.setIcon("subtitles"),["en","en-us","en-ca","fr-ca"].indexOf(this.player_.language_)>-1&&(this.label_="captions",this.setIcon("captions")),this.menuButton_.controlText(zi(this.label_))}buildCSSClass(){return`vjs-subs-caps-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subs-caps-button ${super.buildWrapperCSSClass()}`}createItems(){let e=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(e.push(new xu(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e=super.createItems(e,Fd),e}}Eu.prototype.kinds_=["captions","subtitles"],Eu.prototype.controlText_="Subtitles",et.registerComponent("SubsCapsButton",Eu);class Nd extends mo{constructor(e,i){const r=i.track,o=e.audioTracks();i.label=r.label||r.language||"Unknown",i.selected=r.enabled,super(e,i),this.track=r,this.addClass(`vjs-${r.kind}-menu-item`);const c=(...f)=>{this.handleTracksChange.apply(this,f)};o.addEventListener("change",c),this.on("dispose",()=>{o.removeEventListener("change",c)})}createEl(e,i,r){const o=super.createEl(e,i,r),c=o.querySelector(".vjs-menu-item-text");return["main-desc","descriptions"].indexOf(this.options_.track.kind)>=0&&(c.appendChild(Xt("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),c.appendChild(Xt("span",{className:"vjs-control-text",textContent:" "+this.localize("Descriptions")}))),o}handleClick(e){if(super.handleClick(e),this.track.enabled=!0,this.player_.tech_.featuresNativeAudioTracks){const i=this.player_.audioTracks();for(let r=0;r<i.length;r++){const o=i[r];o!==this.track&&(o.enabled=o===this.track)}}}handleTracksChange(e){this.selected(this.track.enabled)}}et.registerComponent("AudioTrackMenuItem",Nd);class Ud extends Ua{constructor(e,i={}){i.tracks=e.audioTracks(),super(e,i),this.setIcon("audio")}buildCSSClass(){return`vjs-audio-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-audio-button ${super.buildWrapperCSSClass()}`}createItems(e=[]){this.hideThreshold_=1;const i=this.player_.audioTracks();for(let r=0;r<i.length;r++){const o=i[r];e.push(new Nd(this.player_,{track:o,selectable:!0,multiSelectable:!1}))}return e}}Ud.prototype.controlText_="Audio Track",et.registerComponent("AudioTrackButton",Ud);class vl extends mo{constructor(e,i){const r=i.rate,o=parseFloat(r,10);i.label=r,i.selected=o===e.playbackRate(),i.selectable=!0,i.multiSelectable=!1,super(e,i),this.label=r,this.rate=o,this.on(e,"ratechange",c=>this.update(c))}handleClick(e){super.handleClick(),this.player().playbackRate(this.rate)}update(e){this.selected(this.player().playbackRate()===this.rate)}}vl.prototype.contentElType="button",et.registerComponent("PlaybackRateMenuItem",vl);class Tu extends yu{constructor(e,i){super(e,i);this.menuButton_.el_.setAttribute("aria-describedby",this.labelElId_),this.updateVisibility(),this.updateLabel(),this.on(e,"loadstart",r=>this.updateVisibility(r)),this.on(e,"ratechange",r=>this.updateLabel(r)),this.on(e,"playbackrateschange",r=>this.handlePlaybackRateschange(r))}createEl(){const e=super.createEl();return this.labelElId_="vjs-playback-rate-value-label-"+this.id_,this.labelEl_=Xt("div",{className:"vjs-playback-rate-value",id:this.labelElId_,textContent:"1x"}),e.appendChild(this.labelEl_),e}dispose(){this.labelEl_=null,super.dispose()}buildCSSClass(){return`vjs-playback-rate ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-playback-rate ${super.buildWrapperCSSClass()}`}createItems(){const e=this.playbackRates(),i=[];for(let r=e.length-1;r>=0;r--)i.push(new vl(this.player(),{rate:e[r]+"x"}));return i}handlePlaybackRateschange(e){this.update()}playbackRates(){const e=this.player();return e.playbackRates&&e.playbackRates()||[]}playbackRateSupported(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0}updateVisibility(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")}updateLabel(e){this.playbackRateSupported()&&(this.labelEl_.textContent=this.player().playbackRate()+"x")}}Tu.prototype.controlText_="Playback Rate",et.registerComponent("PlaybackRateMenuButton",Tu);class jd extends et{buildCSSClass(){return`vjs-spacer ${super.buildCSSClass()}`}createEl(e="div",i={},r={}){return i.className||(i.className=this.buildCSSClass()),super.createEl(e,i,r)}}et.registerComponent("Spacer",jd);class $d extends jd{buildCSSClass(){return`vjs-custom-control-spacer ${super.buildCSSClass()}`}createEl(){return super.createEl("div",{className:this.buildCSSClass(),textContent:"\xA0"})}}et.registerComponent("CustomControlSpacer",$d);class Vd extends et{createEl(){return super.createEl("div",{className:"vjs-control-bar",dir:"ltr"})}}Vd.prototype.options_={children:["playToggle","skipBackward","skipForward","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","pictureInPictureToggle","fullscreenToggle"]},et.registerComponent("ControlBar",Vd);class Hd extends ea{constructor(e,i){super(e,i);this.on(e,"error",r=>{this.open(r)})}buildCSSClass(){return`vjs-error-display ${super.buildCSSClass()}`}content(){const e=this.player().error();return e?this.localize(e.message):""}}Hd.prototype.options_=Object.assign({},ea.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),et.registerComponent("ErrorDisplay",Hd);class Su extends et{constructor(e,i={}){super(e,i);this.el_.setAttribute("aria-labelledby",this.selectLabelledbyIds)}createEl(){return this.selectLabelledbyIds=[this.options_.legendId,this.options_.labelId].join(" ").trim(),Xt("select",{id:this.options_.id},{},this.options_.SelectOptions.map(i=>{const r=(this.options_.labelId?this.options_.labelId:`vjs-track-option-${Ci()}`)+"-"+i[1].replace(/\W+/g,""),o=Xt("option",{id:r,value:this.localize(i[0]),textContent:i[1]});return o.setAttribute("aria-labelledby",`${this.selectLabelledbyIds} ${r}`),o}))}}et.registerComponent("TextTrackSelect",Su);class ra extends et{constructor(e,i={}){super(e,i);const r=Xt("legend",{textContent:this.localize(this.options_.legendText),id:this.options_.legendId});this.el().appendChild(r);const o=this.options_.selects;for(const c of o){const f=this.options_.selectConfigs[c],y=f.className,S=f.id.replace("%s",this.options_.id_);let O=null;const q=`vjs_select_${Ci()}`;if(this.options_.type==="colors"){O=Xt("span",{className:y});const Te=Xt("label",{id:S,className:"vjs-label",textContent:f.label});Te.setAttribute("for",q),O.appendChild(Te)}const de=new Su(e,{SelectOptions:f.options,legendId:this.options_.legendId,id:q,labelId:S});this.addChild(de),this.options_.type==="colors"&&(O.appendChild(de.el()),this.el().appendChild(O))}}createEl(){return Xt("fieldset",{className:this.options_.className})}}et.registerComponent("TextTrackFieldset",ra);class Gd extends et{constructor(e,i={}){super(e,i);const r=this.options_.textTrackComponentid,o=new ra(e,{id_:r,legendId:`captions-text-legend-${r}`,legendText:this.localize("Text"),className:"vjs-fg vjs-track-setting",selects:this.options_.fieldSets[0],selectConfigs:this.options_.selectConfigs,type:"colors"});this.addChild(o);const c=new ra(e,{id_:r,legendId:`captions-background-${r}`,legendText:this.localize("Text Background"),className:"vjs-bg vjs-track-setting",selects:this.options_.fieldSets[1],selectConfigs:this.options_.selectConfigs,type:"colors"});this.addChild(c);const f=new ra(e,{id_:r,legendId:`captions-window-${r}`,legendText:this.localize("Caption Area Background"),className:"vjs-window vjs-track-setting",selects:this.options_.fieldSets[2],selectConfigs:this.options_.selectConfigs,type:"colors"});this.addChild(f)}createEl(){return Xt("div",{className:"vjs-track-settings-colors"})}}et.registerComponent("TextTrackSettingsColors",Gd);class qd extends et{constructor(e,i={}){super(e,i);const r=this.options_.textTrackComponentid,o=new ra(e,{id_:r,legendId:`captions-font-size-${r}`,legendText:"Font Size",className:"vjs-font-percent vjs-track-setting",selects:this.options_.fieldSets[0],selectConfigs:this.options_.selectConfigs,type:"font"});this.addChild(o);const c=new ra(e,{id_:r,legendId:`captions-edge-style-${r}`,legendText:this.localize("Text Edge Style"),className:"vjs-edge-style vjs-track-setting",selects:this.options_.fieldSets[1],selectConfigs:this.options_.selectConfigs,type:"font"});this.addChild(c);const f=new ra(e,{id_:r,legendId:`captions-font-family-${r}`,legendText:this.localize("Font Family"),className:"vjs-font-family vjs-track-setting",selects:this.options_.fieldSets[2],selectConfigs:this.options_.selectConfigs,type:"font"});this.addChild(f)}createEl(){return Xt("div",{className:"vjs-track-settings-font"})}}et.registerComponent("TextTrackSettingsFont",qd);class zd extends et{constructor(e,i={}){super(e,i);const r=this.localize("restore all settings to the default values"),o=new kn(e,{controlText:r,className:"vjs-default-button"});o.el().classList.remove("vjs-control","vjs-button"),o.el().textContent=this.localize("Reset"),this.addChild(o);const c=new kn(e,{controlText:r,className:"vjs-done-button"});c.el().classList.remove("vjs-control","vjs-button"),c.el().textContent=this.localize("Done"),this.addChild(c)}createEl(){return Xt("div",{className:"vjs-track-settings-controls"})}}et.registerComponent("TrackSettingsControls",zd);const Cu="vjs-text-track-settings",Wd=["#000","Black"],Kd=["#00F","Blue"],Yd=["#0FF","Cyan"],wu=["#0F0","Green"],Xd=["#F0F","Magenta"],Qd=["#F00","Red"],Al=["#FFF","White"],Jd=["#FF0","Yellow"],go=["1","Opaque"],Lu=["0.5","Semi-Transparent"],Du=["0","Transparent"],ks={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[Wd,Al,Qd,wu,Kd,Jd,Xd,Yd],className:"vjs-bg-color"},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Opacity",options:[go,Lu,Du],className:"vjs-bg-opacity vjs-opacity"},color:{selector:".vjs-text-color > select",id:"captions-foreground-color-%s",label:"Color",options:[Al,Wd,Qd,wu,Kd,Jd,Xd,Yd],className:"vjs-text-color"},edgeStyle:{selector:".vjs-edge-style > select",id:"",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Drop shadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:s=>s==="1.00"?null:Number(s)},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Opacity",options:[go,Lu],className:"vjs-text-opacity vjs-opacity"},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color",className:"vjs-window-color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Opacity",options:[Du,Lu,go],className:"vjs-window-opacity vjs-opacity"}};ks.windowColor.options=ks.backgroundColor.options;function ku(s,e){if(e&&(s=e(s)),s&&s!=="none")return s}function Zd(s,e){const i=s.options[s.options.selectedIndex].value;return ku(i,e)}function eh(s,e,i){if(!!e){for(let r=0;r<s.options.length;r++)if(ku(s.options[r].value,i)===e){s.selectedIndex=r;break}}}class th extends ea{constructor(e,i){i.temporary=!1,super(e,i),this.updateDisplay=this.updateDisplay.bind(this),this.fill(),this.hasBeenOpened_=this.hasBeenFilled_=!0,this.renderModalComponents(e),this.endDialog=Xt("p",{className:"vjs-control-text",textContent:this.localize("End of dialog window.")}),this.el().appendChild(this.endDialog),this.setDefaults(),i.persistTextTrackSettings===void 0&&(this.options_.persistTextTrackSettings=this.options_.playerOptions.persistTextTrackSettings),this.bindFunctionsToSelectsAndButtons(),this.options_.persistTextTrackSettings&&this.restoreSettings()}renderModalComponents(e){const i=new Gd(e,{textTrackComponentid:this.id_,selectConfigs:ks,fieldSets:[["color","textOpacity"],["backgroundColor","backgroundOpacity"],["windowColor","windowOpacity"]]});this.addChild(i);const r=new qd(e,{textTrackComponentid:this.id_,selectConfigs:ks,fieldSets:[["fontPercent"],["edgeStyle"],["fontFamily"]]});this.addChild(r);const o=new zd(e);this.addChild(o)}bindFunctionsToSelectsAndButtons(){this.on(this.$(".vjs-done-button"),"click",()=>{this.saveSettings(),this.close()}),this.on(this.$(".vjs-default-button"),"click",()=>{this.setDefaults(),this.updateDisplay()}),Qn(ks,e=>{this.on(this.$(e.selector),"change",this.updateDisplay)})}dispose(){this.endDialog=null,super.dispose()}label(){return this.localize("Caption Settings Dialog")}description(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")}buildCSSClass(){return super.buildCSSClass()+" vjs-text-track-settings"}getValues(){return Go(ks,(e,i,r)=>{const o=Zd(this.$(i.selector),i.parser);return o!==void 0&&(e[r]=o),e},{})}setValues(e){Qn(ks,(i,r)=>{eh(this.$(i.selector),e[r],i.parser)})}setDefaults(){Qn(ks,e=>{const i=e.hasOwnProperty("default")?e.default:0;this.$(e.selector).selectedIndex=i})}restoreSettings(){let e;try{e=JSON.parse(ne().localStorage.getItem(Cu))}catch(i){ci.warn(i)}e&&this.setValues(e)}saveSettings(){if(!this.options_.persistTextTrackSettings)return;const e=this.getValues();try{Object.keys(e).length?ne().localStorage.setItem(Cu,JSON.stringify(e)):ne().localStorage.removeItem(Cu)}catch(i){ci.warn(i)}}updateDisplay(){const e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()}handleLanguagechange(){this.fill(),this.renderModalComponents(this.player_),this.bindFunctionsToSelectsAndButtons()}}et.registerComponent("TextTrackSettings",th);class ih extends et{constructor(e,i){let r=i.ResizeObserver||ne().ResizeObserver;i.ResizeObserver===null&&(r=!1);const o=Si({createEl:!r,reportTouchActivity:!1},i);super(e,o);this.ResizeObserver=i.ResizeObserver||ne().ResizeObserver,this.loadListener_=null,this.resizeObserver_=null,this.debouncedHandler_=id(()=>{this.resizeHandler()},100,!1,this),r?(this.resizeObserver_=new this.ResizeObserver(this.debouncedHandler_),this.resizeObserver_.observe(e.el())):(this.loadListener_=()=>{if(!this.el_||!this.el_.contentWindow)return;const c=this.debouncedHandler_;let f=this.unloadListener_=function(){wn(this,"resize",c),wn(this,"unload",f),f=null};yn(this.el_.contentWindow,"unload",f),yn(this.el_.contentWindow,"resize",c)},this.one("load",this.loadListener_))}createEl(){return super.createEl("iframe",{className:"vjs-resize-manager",tabIndex:-1,title:this.localize("No content")},{"aria-hidden":"true"})}resizeHandler(){!this.player_||!this.player_.trigger||this.player_.trigger("playerresize")}dispose(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,super.dispose()}}et.registerComponent("ResizeManager",ih);const _l={trackingThreshold:20,liveTolerance:15};class nh extends et{constructor(e,i){const r=Si(_l,i,{createEl:!1});super(e,r);this.trackLiveHandler_=()=>this.trackLive_(),this.handlePlay_=o=>this.handlePlay(o),this.handleFirstTimeupdate_=o=>this.handleFirstTimeupdate(o),this.handleSeeked_=o=>this.handleSeeked(o),this.seekToLiveEdge_=o=>this.seekToLiveEdge(o),this.reset_(),this.on(this.player_,"durationchange",o=>this.handleDurationchange(o)),this.on(this.player_,"canplay",()=>this.toggleTracking())}trackLive_(){const e=this.player_.seekable();if(!e||!e.length)return;const i=Number(ne().performance.now().toFixed(4)),r=this.lastTime_===-1?0:(i-this.lastTime_)/1e3;this.lastTime_=i,this.pastSeekEnd_=this.pastSeekEnd()+r;const o=this.liveCurrentTime(),c=this.player_.currentTime();let f=this.player_.paused()||this.seekedBehindLive_||Math.abs(o-c)>this.options_.liveTolerance;(!this.timeupdateSeen_||o===Infinity)&&(f=!1),f!==this.behindLiveEdge_&&(this.behindLiveEdge_=f,this.trigger("liveedgechange"))}handleDurationchange(){this.toggleTracking()}toggleTracking(){this.player_.duration()===Infinity&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())}startTracking(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLiveHandler_,Hn),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLiveHandler_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked_):(this.one(this.player_,"play",this.handlePlay_),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)))}handleFirstTimeupdate(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked_)}handleSeeked(){const e=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&e>2,this.nextSeekedFromUser_=!1,this.trackLive_()}handlePlay(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)}reset_(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.nextSeekedFromUser_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLiveHandler_),this.off(this.player_,"seeked",this.handleSeeked_),this.off(this.player_,"play",this.handlePlay_),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_),this.off(this.player_,"timeupdate",this.seekToLiveEdge_)}nextSeekedFromUser(){this.nextSeekedFromUser_=!0}stopTracking(){!this.isTracking()||(this.reset_(),this.trigger("liveedgechange"))}seekableEnd(){const e=this.player_.seekable(),i=[];let r=e?e.length:0;for(;r--;)i.push(e.end(r));return i.length?i.sort()[i.length-1]:Infinity}seekableStart(){const e=this.player_.seekable(),i=[];let r=e?e.length:0;for(;r--;)i.push(e.start(r));return i.length?i.sort()[0]:0}liveWindow(){const e=this.liveCurrentTime();return e===Infinity?0:e-this.seekableStart()}isLive(){return this.isTracking()}atLiveEdge(){return!this.behindLiveEdge()}liveCurrentTime(){return this.pastSeekEnd()+this.seekableEnd()}pastSeekEnd(){const e=this.seekableEnd();return this.lastSeekEnd_!==-1&&e!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=e,this.pastSeekEnd_}behindLiveEdge(){return this.behindLiveEdge_}isTracking(){return typeof this.trackingInterval_=="number"}seekToLiveEdge(){this.seekedBehindLive_=!1,!this.atLiveEdge()&&(this.nextSeekedFromUser_=!1,this.player_.currentTime(this.liveCurrentTime()))}dispose(){this.stopTracking(),super.dispose()}}et.registerComponent("LiveTracker",nh);class rh extends et{constructor(e,i){super(e,i);this.on("statechanged",r=>this.updateDom_()),this.updateDom_()}createEl(){return this.els={title:Xt("div",{className:"vjs-title-bar-title",id:`vjs-title-bar-title-${Ci()}`}),description:Xt("div",{className:"vjs-title-bar-description",id:`vjs-title-bar-description-${Ci()}`})},Xt("div",{className:"vjs-title-bar"},{},sn(this.els))}updateDom_(){const e=this.player_.tech_,i=e&&e.el_,r={title:"aria-labelledby",description:"aria-describedby"};["title","description"].forEach(o=>{const c=this.state[o],f=this.els[o],y=r[o];fe(f),c&&Vn(f,c),i&&(i.removeAttribute(y),c&&i.setAttribute(y,f.id))}),this.state.title||this.state.description?this.show():this.hide()}update(e){this.setState(e)}dispose(){const e=this.player_.tech_,i=e&&e.el_;i&&(i.removeAttribute("aria-labelledby"),i.removeAttribute("aria-describedby")),super.dispose(),this.els=null}}et.registerComponent("TitleBar",rh);const sh={initialDisplay:4e3,position:[],takeFocus:!1};class ah extends kn{constructor(e,i){i=Si(sh,i),super(e,i),this.controlText(i.controlText),this.hide(),this.on(this.player_,["useractive","userinactive"],r=>{this.removeClass("force-display")})}buildCSSClass(){return`vjs-transient-button focus-visible ${this.options_.position.map(e=>`vjs-${e}`).join(" ")}`}createEl(){const e=Xt("button",{},{type:"button",class:this.buildCSSClass()},Xt("span"));return this.controlTextEl_=e.querySelector("span"),e}show(){super.show(),this.addClass("force-display"),this.options_.takeFocus&&this.el().focus({preventScroll:!0}),this.forceDisplayTimeout=this.player_.setTimeout(()=>{this.removeClass("force-display")},this.options_.initialDisplay)}hide(){this.removeClass("force-display"),super.hide()}dispose(){this.player_.clearTimeout(this.forceDisplayTimeout),super.dispose()}}et.registerComponent("TransientButton",ah);const Iu=s=>{const e=s.el();if(e.hasAttribute("src"))return s.triggerSourceset(e.src),!0;const i=s.$$("source"),r=[];let o="";if(!i.length)return!1;for(let c=0;c<i.length;c++){const f=i[c].src;f&&r.indexOf(f)===-1&&r.push(f)}return r.length?(r.length===1&&(o=r[0]),s.triggerSourceset(o),!0):!1},sa=Object.defineProperty({},"innerHTML",{get(){return this.cloneNode(!0).innerHTML},set(s){const e=ve().createElement(this.nodeName.toLowerCase());e.innerHTML=s;const i=ve().createDocumentFragment();for(;e.childNodes.length;)i.appendChild(e.childNodes[0]);return this.innerText="",ne().Element.prototype.appendChild.call(this,i),this.innerHTML}}),h=(s,e)=>{let i={};for(let r=0;r<s.length&&(i=Object.getOwnPropertyDescriptor(s[r],e),!(i&&i.set&&i.get));r++);return i.enumerable=!0,i.configurable=!0,i},t=s=>h([s.el(),ne().HTMLMediaElement.prototype,ne().Element.prototype,sa],"innerHTML"),n=function(s){const e=s.el();if(e.resetSourceWatch_)return;const i={},r=t(s),o=c=>(...f)=>{const y=c.apply(e,f);return Iu(s),y};["append","appendChild","insertAdjacentHTML"].forEach(c=>{!e[c]||(i[c]=e[c],e[c]=o(i[c]))}),Object.defineProperty(e,"innerHTML",Si(r,{set:o(r.set)})),e.resetSourceWatch_=()=>{e.resetSourceWatch_=null,Object.keys(i).forEach(c=>{e[c]=i[c]}),Object.defineProperty(e,"innerHTML",r)},s.one("sourceset",e.resetSourceWatch_)},a=Object.defineProperty({},"src",{get(){return this.hasAttribute("src")?cd(ne().Element.prototype.getAttribute.call(this,"src")):""},set(s){return ne().Element.prototype.setAttribute.call(this,"src",s),s}}),l=s=>h([s.el(),ne().HTMLMediaElement.prototype,a],"src"),u=function(s){if(!s.featuresSourceset)return;const e=s.el();if(e.resetSourceset_)return;const i=l(s),r=e.setAttribute,o=e.load;Object.defineProperty(e,"src",Si(i,{set:c=>{const f=i.set.call(e,c);return s.triggerSourceset(e.src),f}})),e.setAttribute=(c,f)=>{const y=r.call(e,c,f);return/src/i.test(c)&&s.triggerSourceset(e.src),y},e.load=()=>{const c=o.call(e);return Iu(s)||(s.triggerSourceset(""),n(s)),c},e.currentSrc?s.triggerSourceset(e.currentSrc):Iu(s)||n(s),e.resetSourceset_=()=>{e.resetSourceset_=null,e.load=o,e.setAttribute=r,Object.defineProperty(e,"src",i),e.resetSourceWatch_&&e.resetSourceWatch_()}};class d extends ni{constructor(e,i){super(e,i);const r=e.source;let o=!1;if(this.featuresVideoFrameCallback=this.featuresVideoFrameCallback&&this.el_.tagName==="VIDEO",r&&(this.el_.currentSrc!==r.src||e.tag&&e.tag.initNetworkState_===3)?this.setSource(r):this.handleLateInit_(this.el_),e.enableSourceset&&this.setupSourcesetHandling_(),this.isScrubbing_=!1,this.el_.hasChildNodes()){const c=this.el_.childNodes;let f=c.length;const y=[];for(;f--;){const S=c[f];S.nodeName.toLowerCase()==="track"&&(this.featuresNativeTextTracks?(this.remoteTextTrackEls().addTrackElement_(S),this.remoteTextTracks().addTrack(S.track),this.textTracks().addTrack(S.track),!o&&!this.el_.hasAttribute("crossorigin")&&ao(S.src)&&(o=!0)):y.push(S))}for(let S=0;S<y.length;S++)this.el_.removeChild(y[S])}this.proxyNativeTracks_(),this.featuresNativeTextTracks&&o&&ci.warn(`Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.
This may prevent text tracks from loading.`),this.restoreMetadataTracksInIOSNativePlayer_(),(Xs||Ks)&&e.nativeControlsForTouch===!0&&this.setControls(!0),this.proxyWebkitFullscreen_(),this.triggerReady()}dispose(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),d.disposeMediaElement(this.el_),this.options_=null,super.dispose()}setupSourcesetHandling_(){u(this)}restoreMetadataTracksInIOSNativePlayer_(){const e=this.textTracks();let i;const r=()=>{i=[];for(let c=0;c<e.length;c++){const f=e[c];f.kind==="metadata"&&i.push({track:f,storedMode:f.mode})}};r(),e.addEventListener("change",r),this.on("dispose",()=>e.removeEventListener("change",r));const o=()=>{for(let c=0;c<i.length;c++){const f=i[c];f.track.mode==="disabled"&&f.track.mode!==f.storedMode&&(f.track.mode=f.storedMode)}e.removeEventListener("change",o)};this.on("webkitbeginfullscreen",()=>{e.removeEventListener("change",r),e.removeEventListener("change",o),e.addEventListener("change",o)}),this.on("webkitendfullscreen",()=>{e.removeEventListener("change",r),e.addEventListener("change",r),e.removeEventListener("change",o)})}overrideNative_(e,i){if(i!==this[`featuresNative${e}Tracks`])return;const r=e.toLowerCase();this[`${r}TracksListeners_`]&&Object.keys(this[`${r}TracksListeners_`]).forEach(o=>{this.el()[`${r}Tracks`].removeEventListener(o,this[`${r}TracksListeners_`][o])}),this[`featuresNative${e}Tracks`]=!i,this[`${r}TracksListeners_`]=null,this.proxyNativeTracksForType_(r)}overrideNativeAudioTracks(e){this.overrideNative_("Audio",e)}overrideNativeVideoTracks(e){this.overrideNative_("Video",e)}proxyNativeTracksForType_(e){const i=tr[e],r=this.el()[i.getterName],o=this[i.getterName]();if(!this[`featuresNative${i.capitalName}Tracks`]||!r||!r.addEventListener)return;const c={change:y=>{const S={type:"change",target:o,currentTarget:o,srcElement:o};o.trigger(S),e==="text"&&this[Ba.remoteText.getterName]().trigger(S)},addtrack(y){o.addTrack(y.track)},removetrack(y){o.removeTrack(y.track)}},f=function(){const y=[];for(let S=0;S<o.length;S++){let O=!1;for(let q=0;q<r.length;q++)if(r[q]===o[S]){O=!0;break}O||y.push(o[S])}for(;y.length;)o.removeTrack(y.shift())};this[i.getterName+"Listeners_"]=c,Object.keys(c).forEach(y=>{const S=c[y];r.addEventListener(y,S),this.on("dispose",O=>r.removeEventListener(y,S))}),this.on("loadstart",f),this.on("dispose",y=>this.off("loadstart",f))}proxyNativeTracks_(){tr.names.forEach(e=>{this.proxyNativeTracksForType_(e)})}createEl(){let e=this.options_.tag;if(!e||!(this.options_.playerElIngest||this.movingMediaElementInDOM)){if(e){const r=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(r,e),d.disposeMediaElement(e),e=r}else{e=ve().createElement("video");const r=this.options_.tag&&cr(this.options_.tag),o=Si({},r);(!Xs||this.options_.nativeControlsForTouch!==!0)&&delete o.controls,Vr(e,Object.assign(o,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}typeof this.options_.preload!="undefined"&&xr(e,"preload",this.options_.preload),this.options_.disablePictureInPicture!==void 0&&(e.disablePictureInPicture=this.options_.disablePictureInPicture);const i=["loop","muted","playsinline","autoplay"];for(let r=0;r<i.length;r++){const o=i[r],c=this.options_[o];typeof c!="undefined"&&(c?xr(e,o,o):E(e,o),e[o]=c)}return e}handleLateInit_(e){if(e.networkState===0||e.networkState===3)return;if(e.readyState===0){let r=!1;const o=function(){r=!0};this.on("loadstart",o);const c=function(){r||this.trigger("loadstart")};this.on("loadedmetadata",c),this.ready(function(){this.off("loadstart",o),this.off("loadedmetadata",c),r||this.trigger("loadstart")});return}const i=["loadstart"];i.push("loadedmetadata"),e.readyState>=2&&i.push("loadeddata"),e.readyState>=3&&i.push("canplay"),e.readyState>=4&&i.push("canplaythrough"),this.ready(function(){i.forEach(function(r){this.trigger(r)},this)})}setScrubbing(e){this.isScrubbing_=e}scrubbing(){return this.isScrubbing_}setCurrentTime(e){try{this.isScrubbing_&&this.el_.fastSeek&&La?this.el_.fastSeek(e):this.el_.currentTime=e}catch(i){ci(i,"Video is not ready. (Video.js)")}}duration(){if(this.el_.duration===Infinity&&oi&&dr&&this.el_.currentTime===0){const e=()=>{this.el_.currentTime>0&&(this.el_.duration===Infinity&&this.trigger("durationchange"),this.off("timeupdate",e))};return this.on("timeupdate",e),NaN}return this.el_.duration||NaN}width(){return this.el_.offsetWidth}height(){return this.el_.offsetHeight}proxyWebkitFullscreen_(){if(!("webkitDisplayingFullscreen"in this.el_))return;const e=function(){this.trigger("fullscreenchange",{isFullscreen:!1}),this.el_.controls&&!this.options_.nativeControlsForTouch&&this.controls()&&(this.el_.controls=!1)},i=function(){"webkitPresentationMode"in this.el_&&this.el_.webkitPresentationMode!=="picture-in-picture"&&(this.one("webkitendfullscreen",e),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",i),this.on("dispose",()=>{this.off("webkitbeginfullscreen",i),this.off("webkitendfullscreen",e)})}supportsFullScreen(){return typeof this.el_.webkitEnterFullScreen=="function"}enterFullScreen(){const e=this.el_;if(e.paused&&e.networkState<=e.HAVE_METADATA)Gr(this.el_.play()),this.setTimeout(function(){e.pause();try{e.webkitEnterFullScreen()}catch(i){this.trigger("fullscreenerror",i)}},0);else try{e.webkitEnterFullScreen()}catch(i){this.trigger("fullscreenerror",i)}}exitFullScreen(){if(!this.el_.webkitDisplayingFullscreen){this.trigger("fullscreenerror",new Error("The video is not fullscreen"));return}this.el_.webkitExitFullScreen()}requestPictureInPicture(){return this.el_.requestPictureInPicture()}requestVideoFrameCallback(e){return this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.requestVideoFrameCallback(e):super.requestVideoFrameCallback(e)}cancelVideoFrameCallback(e){this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.cancelVideoFrameCallback(e):super.cancelVideoFrameCallback(e)}src(e){if(e===void 0)return this.el_.src;this.setSrc(e)}reset(){d.resetMediaElement(this.el_)}currentSrc(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc}setControls(e){this.el_.controls=!!e}addTextTrack(e,i,r){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,i,r):super.addTextTrack(e,i,r)}createRemoteTextTrack(e){if(!this.featuresNativeTextTracks)return super.createRemoteTextTrack(e);const i=ve().createElement("track");return e.kind&&(i.kind=e.kind),e.label&&(i.label=e.label),(e.language||e.srclang)&&(i.srclang=e.language||e.srclang),e.default&&(i.default=e.default),e.id&&(i.id=e.id),e.src&&(i.src=e.src),i}addRemoteTextTrack(e,i){const r=super.addRemoteTextTrack(e,i);return this.featuresNativeTextTracks&&this.el().appendChild(r),r}removeRemoteTextTrack(e){if(super.removeRemoteTextTrack(e),this.featuresNativeTextTracks){const i=this.$$("track");let r=i.length;for(;r--;)(e===i[r]||e===i[r].track)&&this.el().removeChild(i[r])}}getVideoPlaybackQuality(){if(typeof this.el().getVideoPlaybackQuality=="function")return this.el().getVideoPlaybackQuality();const e={};return typeof this.el().webkitDroppedFrameCount!="undefined"&&typeof this.el().webkitDecodedFrameCount!="undefined"&&(e.droppedVideoFrames=this.el().webkitDroppedFrameCount,e.totalVideoFrames=this.el().webkitDecodedFrameCount),ne().performance&&(e.creationTime=ne().performance.now()),e}}Mr(d,"TEST_VID",function(){if(!jr())return;const s=ve().createElement("video"),e=ve().createElement("track");return e.kind="captions",e.srclang="en",e.label="English",s.appendChild(e),s}),d.isSupported=function(){try{d.TEST_VID.volume=.5}catch(s){return!1}return!!(d.TEST_VID&&d.TEST_VID.canPlayType)},d.canPlayType=function(s){return d.TEST_VID.canPlayType(s)},d.canPlaySource=function(s,e){return d.canPlayType(s.type)},d.canControlVolume=function(){try{const s=d.TEST_VID.volume;d.TEST_VID.volume=s/2+.1;const e=s!==d.TEST_VID.volume;return e&&an?(ne().setTimeout(()=>{d&&d.prototype&&(d.prototype.featuresVolumeControl=s!==d.TEST_VID.volume)}),!1):e}catch(s){return!1}},d.canMuteVolume=function(){try{const s=d.TEST_VID.muted;return d.TEST_VID.muted=!s,d.TEST_VID.muted?xr(d.TEST_VID,"muted","muted"):E(d.TEST_VID,"muted","muted"),s!==d.TEST_VID.muted}catch(s){return!1}},d.canControlPlaybackRate=function(){if(oi&&dr&&_r<58)return!1;try{const s=d.TEST_VID.playbackRate;return d.TEST_VID.playbackRate=s/2+.1,s!==d.TEST_VID.playbackRate}catch(s){return!1}},d.canOverrideAttributes=function(){try{const s=()=>{};Object.defineProperty(ve().createElement("video"),"src",{get:s,set:s}),Object.defineProperty(ve().createElement("audio"),"src",{get:s,set:s}),Object.defineProperty(ve().createElement("video"),"innerHTML",{get:s,set:s}),Object.defineProperty(ve().createElement("audio"),"innerHTML",{get:s,set:s})}catch(s){return!1}return!0},d.supportsNativeTextTracks=function(){return La||an&&dr},d.supportsNativeVideoTracks=function(){return!!(d.TEST_VID&&d.TEST_VID.videoTracks)},d.supportsNativeAudioTracks=function(){return!!(d.TEST_VID&&d.TEST_VID.audioTracks)},d.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],[["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach(function([s,e]){Mr(d.prototype,s,()=>d[e](),!0)}),d.prototype.featuresVolumeControl=d.canControlVolume(),d.prototype.movingMediaElementInDOM=!an,d.prototype.featuresFullscreenResize=!0,d.prototype.featuresProgressEvents=!0,d.prototype.featuresTimeupdateEvents=!0,d.prototype.featuresVideoFrameCallback=!!(d.TEST_VID&&d.TEST_VID.requestVideoFrameCallback),d.disposeMediaElement=function(s){if(!!s){for(s.parentNode&&s.parentNode.removeChild(s);s.hasChildNodes();)s.removeChild(s.firstChild);s.removeAttribute("src"),typeof s.load=="function"&&function(){try{s.load()}catch(e){}}()}},d.resetMediaElement=function(s){if(!s)return;const e=s.querySelectorAll("source");let i=e.length;for(;i--;)s.removeChild(e[i]);s.removeAttribute("src"),typeof s.load=="function"&&function(){try{s.load()}catch(r){}}()},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(s){d.prototype[s]=function(){return this.el_[s]||this.el_.hasAttribute(s)}}),["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(s){d.prototype["set"+zi(s)]=function(e){this.el_[s]=e,e?this.el_.setAttribute(s,s):this.el_.removeAttribute(s)}}),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach(function(s){d.prototype[s]=function(){return this.el_[s]}}),["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach(function(s){d.prototype["set"+zi(s)]=function(e){this.el_[s]=e}}),["pause","load","play"].forEach(function(s){d.prototype[s]=function(){return this.el_[s]()}}),ni.withSourceHandlers(d),d.nativeSourceHandler={},d.nativeSourceHandler.canPlayType=function(s){try{return d.TEST_VID.canPlayType(s)}catch(e){return""}},d.nativeSourceHandler.canHandleSource=function(s,e){if(s.type)return d.nativeSourceHandler.canPlayType(s.type);if(s.src){const i=so(s.src);return d.nativeSourceHandler.canPlayType(`video/${i}`)}return""},d.nativeSourceHandler.handleSource=function(s,e,i){e.setSrc(s.src)},d.nativeSourceHandler.dispose=function(){},d.registerSourceHandler(d.nativeSourceHandler),ni.registerTech("Html5",d);const p=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],g={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},v=["tiny","xsmall","small","medium","large","xlarge","huge"],b={};v.forEach(s=>{const e=s.charAt(0)==="x"?`x-${s.substring(1)}`:s;b[s]=`vjs-layout-${e}`});const L={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:Infinity};class B extends et{constructor(e,i,r){if(e.id=e.id||i.id||`vjs_video_${Ci()}`,i=Object.assign(B.getTagSettings(e),i),i.initChildren=!1,i.createEl=!1,i.evented=!1,i.reportTouchActivity=!1,!i.language){const f=e.closest("[lang]");f&&(i.language=f.getAttribute("lang"))}super(null,i,r);if(this.boundDocumentFullscreenChange_=f=>this.documentFullscreenChange_(f),this.boundFullWindowOnEscKey_=f=>this.fullWindowOnEscKey(f),this.boundUpdateStyleEl_=f=>this.updateStyleEl_(f),this.boundApplyInitTime_=f=>this.applyInitTime_(f),this.boundUpdateCurrentBreakpoint_=f=>this.updateCurrentBreakpoint_(f),this.boundHandleTechClick_=f=>this.handleTechClick_(f),this.boundHandleTechDoubleClick_=f=>this.handleTechDoubleClick_(f),this.boundHandleTechTouchStart_=f=>this.handleTechTouchStart_(f),this.boundHandleTechTouchMove_=f=>this.handleTechTouchMove_(f),this.boundHandleTechTouchEnd_=f=>this.handleTechTouchEnd_(f),this.boundHandleTechTap_=f=>this.handleTechTap_(f),this.boundUpdatePlayerHeightOnAudioOnlyMode_=f=>this.updatePlayerHeightOnAudioOnlyMode_(f),this.isFullscreen_=!1,this.log=Xn(this.id_),this.fsApi_=xa,this.isPosterFromTech_=!1,this.queuedCallbacks_=[],this.isReady_=!1,this.hasStarted_=!1,this.userActive_=!1,this.debugEnabled_=!1,this.audioOnlyMode_=!1,this.audioPosterMode_=!1,this.audioOnlyCache_={controlBarHeight:null,playerHeight:null,hiddenChildren:[]},!this.options_||!this.options_.techOrder||!this.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(this.tag=e,this.tagAttributes=e&&cr(e),this.language(this.options_.language),i.languages){const f={};Object.getOwnPropertyNames(i.languages).forEach(function(y){f[y.toLowerCase()]=i.languages[y]}),this.languages_=f}else this.languages_=B.prototype.options_.languages;this.resetCache_(),this.poster_=i.poster||"",this.controls_=!!i.controls,e.controls=!1,e.removeAttribute("controls"),this.changingSrc_=!1,this.playCallbacks_=[],this.playTerminatedQueue_=[],e.hasAttribute("autoplay")?this.autoplay(!0):this.autoplay(this.options_.autoplay),i.plugins&&Object.keys(i.plugins).forEach(f=>{if(typeof this[f]!="function")throw new Error(`plugin "${f}" does not exist`)}),this.scrubbing_=!1,this.el_=this.createEl(),Wl(this,{eventBusKey:"el_"}),this.fsApi_.requestFullscreen&&(yn(ve(),this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.on(this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_)),this.fluid_&&this.on(["playerreset","resize"],this.boundUpdateStyleEl_);const o=Si(this.options_);if(i.plugins&&Object.keys(i.plugins).forEach(f=>{this[f](i.plugins[f])}),i.debug&&this.debug(!0),this.options_.playerOptions=o,this.middleware_=[],this.playbackRates(i.playbackRates),i.experimentalSvgIcons){const y=new(ne()).DOMParser().parseFromString(lu,"image/svg+xml");if(y.querySelector("parsererror"))ci.warn("Failed to load SVG Icons. Falling back to Font Icons."),this.options_.experimentalSvgIcons=null;else{const O=y.documentElement;O.style.display="none",this.el_.appendChild(O),this.addClass("vjs-svg-icons-enabled")}}this.initChildren(),this.isAudio(e.nodeName.toLowerCase()==="audio"),this.controls()?this.addClass("vjs-controls-enabled"):this.addClass("vjs-controls-disabled"),this.el_.setAttribute("role","region"),this.isAudio()?this.el_.setAttribute("aria-label",this.localize("Audio Player")):this.el_.setAttribute("aria-label",this.localize("Video Player")),this.isAudio()&&this.addClass("vjs-audio"),i.spatialNavigation&&i.spatialNavigation.enabled&&(this.spatialNavigation=new Ad(this),this.addClass("vjs-spatial-navigation-enabled")),Xs&&this.addClass("vjs-touch-enabled"),an||this.addClass("vjs-workinghover"),B.players[this.id_]=this;const c=vr.split(".")[0];this.addClass(`vjs-v${c}`),this.userActive(!0),this.reportUserActivity(),this.one("play",f=>this.listenForUserActivity_(f)),this.on("keydown",f=>this.handleKeyDown(f)),this.on("languagechange",f=>this.handleLanguagechange(f)),this.breakpoints(this.options_.breakpoints),this.responsive(this.options_.responsive),this.on("ready",()=>{this.audioPosterMode(this.options_.audioPosterMode),this.audioOnlyMode(this.options_.audioOnlyMode)})}dispose(){this.trigger("dispose"),this.off("dispose"),wn(ve(),this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),wn(ve(),"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),B.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),md(this),Ln.names.forEach(e=>{const i=Ln[e],r=this[i.getterName]();r&&r.off&&r.off()}),super.dispose({restoreEl:this.options_.restoreEl})}createEl(){let e=this.tag,i,r=this.playerElIngest_=e.parentNode&&e.parentNode.hasAttribute&&e.parentNode.hasAttribute("data-vjs-player");const o=this.tag.tagName.toLowerCase()==="video-js";r?i=this.el_=e.parentNode:o||(i=this.el_=super.createEl("div"));const c=cr(e);if(o){for(i=this.el_=e,e=this.tag=ve().createElement("video");i.children.length;)e.appendChild(i.firstChild);is(i,"video-js")||$r(i,"video-js"),i.appendChild(e),r=this.playerElIngest_=i,Object.keys(i).forEach(S=>{try{e[S]=i[S]}catch(O){}})}e.setAttribute("tabindex","-1"),c.tabindex="-1",dr&&br&&(e.setAttribute("role","application"),c.role="application"),e.removeAttribute("width"),e.removeAttribute("height"),"width"in c&&delete c.width,"height"in c&&delete c.height,Object.getOwnPropertyNames(c).forEach(function(S){o&&S==="class"||i.setAttribute(S,c[S]),o&&e.setAttribute(S,c[S])}),e.playerId=e.id,e.id+="_html5_api",e.className="vjs-tech",e.player=i.player=this,this.addClass("vjs-paused");const f=["IS_SMART_TV","IS_TIZEN","IS_WEBOS","IS_ANDROID","IS_IPAD","IS_IPHONE","IS_CHROMECAST_RECEIVER"].filter(S=>Da[S]).map(S=>"vjs-device-"+S.substring(3).toLowerCase().replace(/\_/g,"-"));if(this.addClass(...f),ne().VIDEOJS_NO_DYNAMIC_STYLE!==!0){this.styleEl_=Er("vjs-styles-dimensions");const S=_t(".vjs-styles-defaults"),O=_t("head");O.insertBefore(this.styleEl_,S?S.nextSibling:O.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);const y=e.getElementsByTagName("a");for(let S=0;S<y.length;S++){const O=y.item(S);$r(O,"vjs-hidden"),O.setAttribute("hidden","hidden")}return e.initNetworkState_=e.networkState,e.parentNode&&!r&&e.parentNode.insertBefore(i,e),Bn(e,i),this.children_.unshift(e),this.el_.setAttribute("lang",this.language_),this.el_.setAttribute("translate","no"),this.el_=i,i}crossOrigin(e){if(typeof e=="undefined")return this.techGet_("crossOrigin");if(e!==null&&e!=="anonymous"&&e!=="use-credentials"){ci.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${e}"`);return}this.techCall_("setCrossOrigin",e),this.posterImage&&this.posterImage.crossOrigin(e)}width(e){return this.dimension("width",e)}height(e){return this.dimension("height",e)}dimension(e,i){const r=e+"_";if(i===void 0)return this[r]||0;if(i===""||i==="auto"){this[r]=void 0,this.updateStyleEl_();return}const o=parseFloat(i);if(isNaN(o)){ci.error(`Improper value "${i}" supplied for for ${e}`);return}this[r]=o,this.updateStyleEl_()}fluid(e){if(e===void 0)return!!this.fluid_;this.fluid_=!!e,qn(this)&&this.off(["playerreset","resize"],this.boundUpdateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),ql(this,()=>{this.on(["playerreset","resize"],this.boundUpdateStyleEl_)})):this.removeClass("vjs-fluid"),this.updateStyleEl_()}fill(e){if(e===void 0)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")}aspectRatio(e){if(e===void 0)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()}updateStyleEl_(){if(ne().VIDEOJS_NO_DYNAMIC_STYLE===!0){const y=typeof this.width_=="number"?this.width_:this.options_.width,S=typeof this.height_=="number"?this.height_:this.options_.height,O=this.tech_&&this.tech_.el();O&&(y>=0&&(O.width=y),S>=0&&(O.height=S));return}let e,i,r,o;this.aspectRatio_!==void 0&&this.aspectRatio_!=="auto"?r=this.aspectRatio_:this.videoWidth()>0?r=this.videoWidth()+":"+this.videoHeight():r="16:9";const c=r.split(":"),f=c[1]/c[0];this.width_!==void 0?e=this.width_:this.height_!==void 0?e=this.height_/f:e=this.videoWidth()||300,this.height_!==void 0?i=this.height_:i=e*f,/^[^a-zA-Z]/.test(this.id())?o="dimensions-"+this.id():o=this.id()+"-dimensions",this.addClass(o),ns(this.styleEl_,`
      .${o} {
        width: ${e}px;
        height: ${i}px;
      }

      .${o}.vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: ${f*100}%;
      }
    `)}loadTech_(e,i){this.tech_&&this.unloadTech_();const r=zi(e),o=e.charAt(0).toLowerCase()+e.slice(1);r!=="Html5"&&this.tag&&(ni.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=r,this.isReady_=!1;let c=this.autoplay();(typeof this.autoplay()=="string"||this.autoplay()===!0&&this.options_.normalizeAutoplay)&&(c=!1);const f={source:i,autoplay:c,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:`${this.id()}_${o}_api`,playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};Ln.names.forEach(S=>{const O=Ln[S];f[O.getterName]=this[O.privateName]}),Object.assign(f,this.options_[r]),Object.assign(f,this.options_[o]),Object.assign(f,this.options_[e.toLowerCase()]),this.tag&&(f.tag=this.tag),i&&i.src===this.cache_.src&&this.cache_.currentTime>0&&(f.startTime=this.cache_.currentTime);const y=ni.getTech(e);if(!y)throw new Error(`No Tech named '${r}' exists! '${r}' should be registered using videojs.registerTech()'`);this.tech_=new y(f),this.tech_.ready(Ni(this,this.handleTechReady_),!0),Ql.jsonToTextTracks(this.textTracksJson_||[],this.tech_),p.forEach(S=>{this.on(this.tech_,S,O=>this[`handleTech${zi(S)}_`](O))}),Object.keys(g).forEach(S=>{this.on(this.tech_,S,O=>{if(this.tech_.playbackRate()===0&&this.tech_.seeking()){this.queuedCallbacks_.push({callback:this[`handleTech${g[S]}_`].bind(this),event:O});return}this[`handleTech${g[S]}_`](O)})}),this.on(this.tech_,"loadstart",S=>this.handleTechLoadStart_(S)),this.on(this.tech_,"sourceset",S=>this.handleTechSourceset_(S)),this.on(this.tech_,"waiting",S=>this.handleTechWaiting_(S)),this.on(this.tech_,"ended",S=>this.handleTechEnded_(S)),this.on(this.tech_,"seeking",S=>this.handleTechSeeking_(S)),this.on(this.tech_,"play",S=>this.handleTechPlay_(S)),this.on(this.tech_,"pause",S=>this.handleTechPause_(S)),this.on(this.tech_,"durationchange",S=>this.handleTechDurationChange_(S)),this.on(this.tech_,"fullscreenchange",(S,O)=>this.handleTechFullscreenChange_(S,O)),this.on(this.tech_,"fullscreenerror",(S,O)=>this.handleTechFullscreenError_(S,O)),this.on(this.tech_,"enterpictureinpicture",S=>this.handleTechEnterPictureInPicture_(S)),this.on(this.tech_,"leavepictureinpicture",S=>this.handleTechLeavePictureInPicture_(S)),this.on(this.tech_,"error",S=>this.handleTechError_(S)),this.on(this.tech_,"posterchange",S=>this.handleTechPosterChange_(S)),this.on(this.tech_,"textdata",S=>this.handleTechTextData_(S)),this.on(this.tech_,"ratechange",S=>this.handleTechRateChange_(S)),this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode!==this.el()&&(r!=="Html5"||!this.tag)&&Bn(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)}unloadTech_(){Ln.names.forEach(e=>{const i=Ln[e];this[i.privateName]=this[i.getterName]()}),this.textTracksJson_=Ql.textTracksToJson(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1}tech(e){return e===void 0&&ci.warn(`Using the tech directly can be dangerous. I hope you know what you're doing.
See https://github.com/videojs/video.js/issues/2617 for more info.
`),this.tech_}version(){return{"video.js":vr}}addTechControlsListeners_(){this.removeTechControlsListeners_(),this.on(this.tech_,"click",this.boundHandleTechClick_),this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_),this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.on(this.tech_,"tap",this.boundHandleTechTap_)}removeTechControlsListeners_(){this.off(this.tech_,"tap",this.boundHandleTechTap_),this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.off(this.tech_,"click",this.boundHandleTechClick_),this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)}handleTechReady_(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()}handleTechLoadStart_(){this.removeClass("vjs-ended","vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):this.trigger("loadstart"),this.manualAutoplay_(this.autoplay()===!0&&this.options_.normalizeAutoplay?"play":this.autoplay())}manualAutoplay_(e){if(!this.tech_||typeof e!="string")return;const i=()=>{const o=this.muted();this.muted(!0);const c=()=>{this.muted(o)};this.playTerminatedQueue_.push(c);const f=this.play();if(!!Pa(f))return f.catch(y=>{throw c(),new Error(`Rejection at manualAutoplay. Restoring muted value. ${y||""}`)})};let r;if(e==="any"&&!this.muted()?(r=this.play(),Pa(r)&&(r=r.catch(i))):e==="muted"&&!this.muted()?r=i():r=this.play(),!!Pa(r))return r.then(()=>{this.trigger({type:"autoplay-success",autoplay:e})}).catch(()=>{this.trigger({type:"autoplay-failure",autoplay:e})})}updateSourceCaches_(e=""){let i=e,r="";typeof i!="string"&&(i=e.src,r=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],i&&!r&&(r=Wc(this,i)),this.cache_.source=Si({},e,{src:i,type:r});const o=this.cache_.sources.filter(S=>S.src&&S.src===i),c=[],f=this.$$("source"),y=[];for(let S=0;S<f.length;S++){const O=cr(f[S]);c.push(O),O.src&&O.src===i&&y.push(O.src)}y.length&&!o.length?this.cache_.sources=c:o.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=i}handleTechSourceset_(e){if(!this.changingSrc_){let i=c=>this.updateSourceCaches_(c);const r=this.currentSource().src,o=e.src;r&&!/^blob:/.test(r)&&/^blob:/.test(o)&&(!this.lastSource_||this.lastSource_.tech!==o&&this.lastSource_.player!==r)&&(i=()=>{}),i(o),e.src||this.tech_.any(["sourceset","loadstart"],c=>{if(c.type==="sourceset")return;const f=this.techGet_("currentSrc");this.lastSource_.tech=f,this.updateSourceCaches_(f)})}this.lastSource_={player:this.currentSource().src,tech:e.src},this.trigger({src:e.src,type:"sourceset"})}hasStarted(e){if(e===void 0)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?this.addClass("vjs-has-started"):this.removeClass("vjs-has-started"))}handleTechPlay_(){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")}handleTechRateChange_(){this.tech_.playbackRate()>0&&this.cache_.lastPlaybackRate===0&&(this.queuedCallbacks_.forEach(e=>e.callback(e.event)),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")}handleTechWaiting_(){this.addClass("vjs-waiting"),this.trigger("waiting");const e=this.currentTime(),i=()=>{e!==this.currentTime()&&(this.removeClass("vjs-waiting"),this.off("timeupdate",i))};this.on("timeupdate",i)}handleTechCanPlay_(){this.removeClass("vjs-waiting"),this.trigger("canplay")}handleTechCanPlayThrough_(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")}handleTechPlaying_(){this.removeClass("vjs-waiting"),this.trigger("playing")}handleTechSeeking_(){this.addClass("vjs-seeking"),this.trigger("seeking")}handleTechSeeked_(){this.removeClass("vjs-seeking","vjs-ended"),this.trigger("seeked")}handleTechPause_(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")}handleTechEnded_(){this.addClass("vjs-ended"),this.removeClass("vjs-waiting"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")}handleTechDurationChange_(){this.duration(this.techGet_("duration"))}handleTechClick_(e){!this.controls_||(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.click===void 0||this.options_.userActions.click!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.click=="function"?this.options_.userActions.click.call(this,e):this.paused()?Gr(this.play()):this.pause())}handleTechDoubleClick_(e){if(!this.controls_)return;Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),r=>r.contains(e.target))||(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.doubleClick===void 0||this.options_.userActions.doubleClick!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.doubleClick=="function"?this.options_.userActions.doubleClick.call(this,e):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen())}handleTechTap_(){this.userActive(!this.userActive())}handleTechTouchStart_(){this.userWasActive=this.userActive()}handleTechTouchMove_(){this.userWasActive&&this.reportUserActivity()}handleTechTouchEnd_(e){e.cancelable&&e.preventDefault()}toggleFullscreenClass_(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")}documentFullscreenChange_(e){const i=e.target.player;if(i&&i!==this)return;const r=this.el();let o=ve()[this.fsApi_.fullscreenElement]===r;!o&&r.matches&&(o=r.matches(":"+this.fsApi_.fullscreen)),this.isFullscreen(o)}handleTechFullscreenChange_(e,i){i&&(i.nativeIOSFullscreen&&(this.addClass("vjs-ios-native-fs"),this.tech_.one("webkitendfullscreen",()=>{this.removeClass("vjs-ios-native-fs")})),this.isFullscreen(i.isFullscreen))}handleTechFullscreenError_(e,i){this.trigger("fullscreenerror",i)}togglePictureInPictureClass_(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")}handleTechEnterPictureInPicture_(e){this.isInPictureInPicture(!0)}handleTechLeavePictureInPicture_(e){this.isInPictureInPicture(!1)}handleTechError_(){const e=this.tech_.error();e&&this.error(e)}handleTechTextData_(){let e=null;arguments.length>1&&(e=arguments[1]),this.trigger("textdata",e)}getCache(){return this.cache_}resetCache_(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}}techCall_(e,i){this.ready(function(){if(e in su)return ru(this.middleware_,this.tech_,e,i);if(e in au)return pd(this.middleware_,this.tech_,e,i);try{this.tech_&&this.tech_[e](i)}catch(r){throw ci(r),r}},!0)}techGet_(e){if(!(!this.tech_||!this.tech_.isReady_)){if(e in Gc)return nu(this.middleware_,this.tech_,e);if(e in au)return pd(this.middleware_,this.tech_,e);try{return this.tech_[e]()}catch(i){throw this.tech_[e]===void 0?(ci(`Video.js: ${e} method not defined for ${this.techName_} playback technology.`,i),i):i.name==="TypeError"?(ci(`Video.js: ${e} unavailable on ${this.techName_} playback technology element.`,i),this.tech_.isReady_=!1,i):(ci(i),i)}}}play(){return new Promise(e=>{this.play_(e)})}play_(e=Gr){this.playCallbacks_.push(e);const i=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc())),r=Boolean(La||an);if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!i){this.waitToPlay_=f=>{this.play_()},this.one(["ready","loadstart"],this.waitToPlay_),!i&&r&&this.load();return}const o=this.techGet_("play");r&&this.hasClass("vjs-ended")&&this.resetProgressBar_(),o===null?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(o)}runPlayTerminatedQueue_(){const e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],e.forEach(function(i){i()})}runPlayCallbacks_(e){const i=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],i.forEach(function(r){r(e)})}pause(){this.techCall_("pause")}paused(){return this.techGet_("paused")!==!1}played(){return this.techGet_("played")||Sr(0,0)}scrubbing(e){if(typeof e=="undefined")return this.scrubbing_;this.scrubbing_=!!e,this.techCall_("setScrubbing",this.scrubbing_),e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")}currentTime(e){if(e===void 0)return this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime;if(e<0&&(e=0),!this.isReady_||this.changingSrc_||!this.tech_||!this.tech_.isReady_){this.cache_.initTime=e,this.off("canplay",this.boundApplyInitTime_),this.one("canplay",this.boundApplyInitTime_);return}this.techCall_("setCurrentTime",e),this.cache_.initTime=0,isFinite(e)&&(this.cache_.currentTime=Number(e))}applyInitTime_(){this.currentTime(this.cache_.initTime)}duration(e){if(e===void 0)return this.cache_.duration!==void 0?this.cache_.duration:NaN;e=parseFloat(e),e<0&&(e=Infinity),e!==this.cache_.duration&&(this.cache_.duration=e,e===Infinity?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(e)||this.trigger("durationchange"))}remainingTime(){return this.duration()-this.currentTime()}remainingTimeDisplay(){return Math.floor(this.duration())-Math.floor(this.currentTime())}buffered(){let e=this.techGet_("buffered");return(!e||!e.length)&&(e=Sr(0,0)),e}seekable(){let e=this.techGet_("seekable");return(!e||!e.length)&&(e=Sr(0,0)),e}seeking(){return this.techGet_("seeking")}ended(){return this.techGet_("ended")}networkState(){return this.techGet_("networkState")}readyState(){return this.techGet_("readyState")}bufferedPercent(){return ld(this.buffered(),this.duration())}bufferedEnd(){const e=this.buffered(),i=this.duration();let r=e.end(e.length-1);return r>i&&(r=i),r}volume(e){let i;if(e!==void 0){i=Math.max(0,Math.min(1,e)),this.cache_.volume=i,this.techCall_("setVolume",i),i>0&&this.lastVolume_(i);return}return i=parseFloat(this.techGet_("volume")),isNaN(i)?1:i}muted(e){if(e!==void 0){this.techCall_("setMuted",e);return}return this.techGet_("muted")||!1}defaultMuted(e){return e!==void 0&&this.techCall_("setDefaultMuted",e),this.techGet_("defaultMuted")||!1}lastVolume_(e){if(e!==void 0&&e!==0){this.cache_.lastVolume=e;return}return this.cache_.lastVolume}supportsFullScreen(){return this.techGet_("supportsFullScreen")||!1}isFullscreen(e){if(e!==void 0){const i=this.isFullscreen_;this.isFullscreen_=Boolean(e),this.isFullscreen_!==i&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),this.toggleFullscreenClass_();return}return this.isFullscreen_}requestFullscreen(e){this.isInPictureInPicture()&&this.exitPictureInPicture();const i=this;return new Promise((r,o)=>{function c(){i.off("fullscreenerror",y),i.off("fullscreenchange",f)}function f(){c(),r()}function y(O,q){c(),o(q)}i.one("fullscreenchange",f),i.one("fullscreenerror",y);const S=i.requestFullscreenHelper_(e);S&&(S.then(c,c),S.then(r,o))})}requestFullscreenHelper_(e){let i;if(this.fsApi_.prefixed||(i=this.options_.fullscreen&&this.options_.fullscreen.options||{},e!==void 0&&(i=e)),this.fsApi_.requestFullscreen){const r=this.el_[this.fsApi_.requestFullscreen](i);return r&&r.then(()=>this.isFullscreen(!0),()=>this.isFullscreen(!1)),r}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("enterFullScreen"):this.enterFullWindow()}exitFullscreen(){const e=this;return new Promise((i,r)=>{function o(){e.off("fullscreenerror",f),e.off("fullscreenchange",c)}function c(){o(),i()}function f(S,O){o(),r(O)}e.one("fullscreenchange",c),e.one("fullscreenerror",f);const y=e.exitFullscreenHelper_();y&&(y.then(o,o),y.then(i,r))})}exitFullscreenHelper_(){if(this.fsApi_.requestFullscreen){const e=ve()[this.fsApi_.exitFullscreen]();return e&&Gr(e.then(()=>this.isFullscreen(!1))),e}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("exitFullScreen"):this.exitFullWindow()}enterFullWindow(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=ve().documentElement.style.overflow,yn(ve(),"keydown",this.boundFullWindowOnEscKey_),ve().documentElement.style.overflow="hidden",$r(ve().body,"vjs-full-window"),this.trigger("enterFullWindow")}fullWindowOnEscKey(e){e.key==="Escape"&&this.isFullscreen()===!0&&(this.isFullWindow?this.exitFullWindow():this.exitFullscreen())}exitFullWindow(){this.isFullscreen(!1),this.isFullWindow=!1,wn(ve(),"keydown",this.boundFullWindowOnEscKey_),ve().documentElement.style.overflow=this.docOrigOverflow,Qs(ve().body,"vjs-full-window"),this.trigger("exitFullWindow")}disablePictureInPicture(e){if(e===void 0)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",e),this.options_.disablePictureInPicture=e,this.trigger("disablepictureinpicturechanged")}isInPictureInPicture(e){if(e!==void 0){this.isInPictureInPicture_=!!e,this.togglePictureInPictureClass_();return}return!!this.isInPictureInPicture_}requestPictureInPicture(){if(this.options_.enableDocumentPictureInPicture&&ne().documentPictureInPicture){const e=ve().createElement(this.el().tagName);return e.classList=this.el().classList,e.classList.add("vjs-pip-container"),this.posterImage&&e.appendChild(this.posterImage.el().cloneNode(!0)),this.titleBar&&e.appendChild(this.titleBar.el().cloneNode(!0)),e.appendChild(Xt("p",{className:"vjs-pip-text"},{},this.localize("Playing in picture-in-picture"))),ne().documentPictureInPicture.requestWindow({width:this.videoWidth(),height:this.videoHeight()}).then(i=>(bt(i),this.el_.parentNode.insertBefore(e,this.el_),i.document.body.appendChild(this.el_),i.document.body.classList.add("vjs-pip-window"),this.player_.isInPictureInPicture(!0),this.player_.trigger({type:"enterpictureinpicture",pipWindow:i}),i.addEventListener("pagehide",r=>{const o=r.target.querySelector(".video-js");e.parentNode.replaceChild(o,e),this.player_.isInPictureInPicture(!1),this.player_.trigger("leavepictureinpicture")}),i))}return"pictureInPictureEnabled"in ve()&&this.disablePictureInPicture()===!1?this.techGet_("requestPictureInPicture"):Promise.reject("No PiP mode is available")}exitPictureInPicture(){if(ne().documentPictureInPicture&&ne().documentPictureInPicture.window)return ne().documentPictureInPicture.window.close(),Promise.resolve();if("pictureInPictureEnabled"in ve())return ve().exitPictureInPicture()}handleKeyDown(e){const{userActions:i}=this.options_;!i||!i.hotkeys||(o=>{const c=o.tagName.toLowerCase();if(o.isContentEditable)return!0;const f=["button","checkbox","hidden","radio","reset","submit"];return c==="input"?f.indexOf(o.type)===-1:["textarea"].indexOf(c)!==-1})(this.el_.ownerDocument.activeElement)||(typeof i.hotkeys=="function"?i.hotkeys.call(this,e):this.handleHotkeys(e))}handleHotkeys(e){const i=this.options_.userActions?this.options_.userActions.hotkeys:{},{fullscreenKey:r=f=>e.key.toLowerCase()==="f",muteKey:o=f=>e.key.toLowerCase()==="m",playPauseKey:c=f=>e.key.toLowerCase()==="k"||e.key.toLowerCase()===" "}=i;if(r.call(this,e)){e.preventDefault(),e.stopPropagation();const f=et.getComponent("FullscreenToggle");ve()[this.fsApi_.fullscreenEnabled]!==!1&&f.prototype.handleClick.call(this,e)}else o.call(this,e)?(e.preventDefault(),e.stopPropagation(),et.getComponent("MuteToggle").prototype.handleClick.call(this,e)):c.call(this,e)&&(e.preventDefault(),e.stopPropagation(),et.getComponent("PlayToggle").prototype.handleClick.call(this,e))}canPlayType(e){let i;for(let r=0,o=this.options_.techOrder;r<o.length;r++){const c=o[r];let f=ni.getTech(c);if(f||(f=et.getComponent(c)),!f){ci.error(`The "${c}" tech is undefined. Skipped browser support check for that tech.`);continue}if(f.isSupported()&&(i=f.canPlayType(e),i))return i}return""}selectSource(e){const i=this.options_.techOrder.map(y=>[y,ni.getTech(y)]).filter(([y,S])=>S?S.isSupported():(ci.error(`The "${y}" tech is undefined. Skipped browser support check for that tech.`),!1)),r=function(y,S,O){let q;return y.some(de=>S.some(Te=>{if(q=O(de,Te),q)return!0})),q};let o;const c=y=>(S,O)=>y(O,S),f=([y,S],O)=>{if(S.canPlaySource(O,this.options_[y.toLowerCase()]))return{source:O,tech:y}};return this.options_.sourceOrder?o=r(e,i,c(f)):o=r(i,e,f),o||!1}handleSrc_(e,i){if(typeof e=="undefined")return this.cache_.src||"";this.resetRetryOnError_&&this.resetRetryOnError_();const r=dl(e);if(!r.length){this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0);return}if(this.changingSrc_=!0,i||(this.cache_.sources=r),this.updateSourceCaches_(r[0]),iu(this,r[0],(o,c)=>{if(this.middleware_=c,i||(this.cache_.sources=r),this.updateSourceCaches_(o),this.src_(o)){if(r.length>1)return this.handleSrc_(r.slice(1));this.changingSrc_=!1,this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0),this.triggerReady();return}Hc(c,this.tech_)}),r.length>1){const o=()=>{this.error(null),this.handleSrc_(r.slice(1),!0)},c=()=>{this.off("error",o)};this.one("error",o),this.one("playing",c),this.resetRetryOnError_=()=>{this.off("error",o),this.off("playing",c)}}}src(e){return this.handleSrc_(e,!1)}src_(e){const i=this.selectSource([e]);return i?sd(i.tech,this.techName_)?(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1},!0),!1):(this.changingSrc_=!0,this.loadTech_(i.tech,i.source),this.tech_.ready(()=>{this.changingSrc_=!1}),!1):!0}load(){if(this.tech_&&this.tech_.vhs){this.src(this.currentSource());return}this.techCall_("load")}reset(){if(this.paused())this.doReset_();else{const e=this.play();Gr(e.then(()=>this.doReset_()))}}doReset_(){this.tech_&&this.tech_.clearTracks("text"),this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),this.error(null),this.titleBar&&this.titleBar.update({title:void 0,description:void 0}),qn(this)&&this.trigger("playerreset")}resetControlBarUI_(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()}resetProgressBar_(){this.currentTime(0);const{currentTimeDisplay:e,durationDisplay:i,progressControl:r,remainingTimeDisplay:o}=this.controlBar||{},{seekBar:c}=r||{};e&&e.updateContent(),i&&i.updateContent(),o&&o.updateContent(),c&&(c.update(),c.loadProgressBar&&c.loadProgressBar.update())}resetPlaybackRate_(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()}resetVolumeBar_(){this.volume(1),this.trigger("volumechange")}currentSources(){const e=this.currentSource(),i=[];return Object.keys(e).length!==0&&i.push(e),this.cache_.sources||i}currentSource(){return this.cache_.source||{}}currentSrc(){return this.currentSource()&&this.currentSource().src||""}currentType(){return this.currentSource()&&this.currentSource().type||""}preload(e){if(e!==void 0){this.techCall_("setPreload",e),this.options_.preload=e;return}return this.techGet_("preload")}autoplay(e){if(e===void 0)return this.options_.autoplay||!1;let i;typeof e=="string"&&/(any|play|muted)/.test(e)||e===!0&&this.options_.normalizeAutoplay?(this.options_.autoplay=e,this.manualAutoplay_(typeof e=="string"?e:"play"),i=!1):e?this.options_.autoplay=!0:this.options_.autoplay=!1,i=typeof i=="undefined"?this.options_.autoplay:i,this.tech_&&this.techCall_("setAutoplay",i)}playsinline(e){return e!==void 0&&(this.techCall_("setPlaysinline",e),this.options_.playsinline=e),this.techGet_("playsinline")}loop(e){if(e!==void 0){this.techCall_("setLoop",e),this.options_.loop=e;return}return this.techGet_("loop")}poster(e){if(e===void 0)return this.poster_;e||(e=""),e!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))}handleTechPosterChange_(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){const e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}}controls(e){if(e===void 0)return!!this.controls_;e=!!e,this.controls_!==e&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))}usingNativeControls(e){if(e===void 0)return!!this.usingNativeControls_;e=!!e,this.usingNativeControls_!==e&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))}error(e){if(e===void 0)return this.error_||null;if(Br("beforeerror").forEach(i=>{const r=i(this,e);if(!(Jn(r)&&!Array.isArray(r)||typeof r=="string"||typeof r=="number"||r===null)){this.log.error("please return a value that MediaError expects in beforeerror hooks");return}e=r}),this.options_.suppressNotSupportedError&&e&&e.code===4){const i=function(){this.error(e)};this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],i),this.one("loadstart",function(){this.off(["click","touchstart"],i)});return}if(e===null){this.error_=null,this.removeClass("vjs-error"),this.errorDisplay&&this.errorDisplay.close();return}this.error_=new Wi(e),this.addClass("vjs-error"),ci.error(`(CODE:${this.error_.code} ${Wi.errorTypes[this.error_.code]})`,this.error_.message,this.error_),this.trigger("error"),Br("error").forEach(i=>i(this,this.error_))}reportUserActivity(e){this.userActivity_=!0}userActive(e){if(e===void 0)return this.userActive_;if(e=!!e,e!==this.userActive_){if(this.userActive_=e,this.userActive_){this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive");return}this.tech_&&this.tech_.one("mousemove",function(i){i.stopPropagation(),i.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}}listenForUserActivity_(){let e,i,r;const o=Ni(this,this.reportUserActivity),c=function(de){(de.screenX!==i||de.screenY!==r)&&(i=de.screenX,r=de.screenY,o())},f=function(){o(),this.clearInterval(e),e=this.setInterval(o,250)},y=function(de){o(),this.clearInterval(e)};this.on("mousedown",f),this.on("mousemove",c),this.on("mouseup",y),this.on("mouseleave",y);const S=this.getChild("controlBar");S&&!an&&!oi&&(S.on("mouseenter",function(de){this.player().options_.inactivityTimeout!==0&&(this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout),this.player().options_.inactivityTimeout=0}),S.on("mouseleave",function(de){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",o),this.on("keyup",o);let O;const q=function(){if(!this.userActivity_)return;this.userActivity_=!1,this.userActive(!0),this.clearTimeout(O);const de=this.options_.inactivityTimeout;de<=0||(O=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},de))};this.setInterval(q,250)}playbackRate(e){if(e!==void 0){this.techCall_("setPlaybackRate",e);return}return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1}defaultPlaybackRate(e){return e!==void 0?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1}isAudio(e){if(e!==void 0){this.isAudio_=!!e;return}return!!this.isAudio_}updatePlayerHeightOnAudioOnlyMode_(){const e=this.getChild("ControlBar");!e||this.audioOnlyCache_.controlBarHeight===e.currentHeight()||(this.audioOnlyCache_.controlBarHeight=e.currentHeight(),this.height(this.audioOnlyCache_.controlBarHeight))}enableAudioOnlyUI_(){this.addClass("vjs-audio-only-mode");const e=this.children(),i=this.getChild("ControlBar"),r=i&&i.currentHeight();e.forEach(o=>{o!==i&&o.el_&&!o.hasClass("vjs-hidden")&&(o.hide(),this.audioOnlyCache_.hiddenChildren.push(o))}),this.audioOnlyCache_.playerHeight=this.currentHeight(),this.audioOnlyCache_.controlBarHeight=r,this.on("playerresize",this.boundUpdatePlayerHeightOnAudioOnlyMode_),this.height(r),this.trigger("audioonlymodechange")}disableAudioOnlyUI_(){this.removeClass("vjs-audio-only-mode"),this.off("playerresize",this.boundUpdatePlayerHeightOnAudioOnlyMode_),this.audioOnlyCache_.hiddenChildren.forEach(e=>e.show()),this.height(this.audioOnlyCache_.playerHeight),this.trigger("audioonlymodechange")}audioOnlyMode(e){if(typeof e!="boolean"||e===this.audioOnlyMode_)return this.audioOnlyMode_;if(this.audioOnlyMode_=e,e){const i=[];return this.isInPictureInPicture()&&i.push(this.exitPictureInPicture()),this.isFullscreen()&&i.push(this.exitFullscreen()),this.audioPosterMode()&&i.push(this.audioPosterMode(!1)),Promise.all(i).then(()=>this.enableAudioOnlyUI_())}return Promise.resolve().then(()=>this.disableAudioOnlyUI_())}enablePosterModeUI_(){(this.tech_&&this.tech_).hide(),this.addClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}disablePosterModeUI_(){(this.tech_&&this.tech_).show(),this.removeClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}audioPosterMode(e){return typeof e!="boolean"||e===this.audioPosterMode_?this.audioPosterMode_:(this.audioPosterMode_=e,e?this.audioOnlyMode()?this.audioOnlyMode(!1).then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.disablePosterModeUI_()}))}addTextTrack(e,i,r){if(this.tech_)return this.tech_.addTextTrack(e,i,r)}addRemoteTextTrack(e,i){if(this.tech_)return this.tech_.addRemoteTextTrack(e,i)}removeRemoteTextTrack(e={}){let{track:i}=e;if(i||(i=e),this.tech_)return this.tech_.removeRemoteTextTrack(i)}getVideoPlaybackQuality(){return this.techGet_("getVideoPlaybackQuality")}videoWidth(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0}videoHeight(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0}language(e){if(e===void 0)return this.language_;this.language_!==String(e).toLowerCase()&&(this.language_=String(e).toLowerCase(),qn(this)&&this.trigger("languagechange"))}languages(){return Si(B.prototype.options_.languages,this.languages_)}toJSON(){const e=Si(this.options_),i=e.tracks;e.tracks=[];for(let r=0;r<i.length;r++){let o=i[r];o=Si(o),o.player=void 0,e.tracks[r]=o}return e}createModal(e,i){i=i||{},i.content=e||"";const r=new ea(this,i);return this.addChild(r),r.on("dispose",()=>{this.removeChild(r)}),r.open(),r}updateCurrentBreakpoint_(){if(!this.responsive())return;const e=this.currentBreakpoint(),i=this.currentWidth();for(let r=0;r<v.length;r++){const o=v[r],c=this.breakpoints_[o];if(i<=c){if(e===o)return;e&&this.removeClass(b[e]),this.addClass(b[o]),this.breakpoint_=o;break}}}removeCurrentBreakpoint_(){const e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)}breakpoints(e){return e===void 0?Object.assign(this.breakpoints_):(this.breakpoint_="",this.breakpoints_=Object.assign({},L,e),this.updateCurrentBreakpoint_(),Object.assign(this.breakpoints_))}responsive(e){if(e===void 0)return this.responsive_;e=Boolean(e);const i=this.responsive_;if(e!==i)return this.responsive_=e,e?(this.on("playerresize",this.boundUpdateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.boundUpdateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e}currentBreakpoint(){return this.breakpoint_}currentBreakpointClass(){return b[this.breakpoint_]||""}loadMedia(e,i){if(!e||typeof e!="object")return;const r=this.crossOrigin();this.reset(),this.cache_.media=Si(e);const{artist:o,artwork:c,description:f,poster:y,src:S,textTracks:O,title:q}=this.cache_.media;!c&&y&&(this.cache_.media.artwork=[{src:y,type:ho(y)}]),r&&this.crossOrigin(r),S&&this.src(S),y&&this.poster(y),Array.isArray(O)&&O.forEach(de=>this.addRemoteTextTrack(de,!1)),this.titleBar&&this.titleBar.update({title:q,description:f||o||""}),this.ready(i)}getMedia(){if(!this.cache_.media){const e=this.poster(),i=this.currentSources(),r=Array.prototype.map.call(this.remoteTextTracks(),c=>({kind:c.kind,label:c.label,language:c.language,src:c.src})),o={src:i,textTracks:r};return e&&(o.poster=e,o.artwork=[{src:o.poster,type:ho(o.poster)}]),o}return Si(this.cache_.media)}static getTagSettings(e){const i={sources:[],tracks:[]},r=cr(e),o=r["data-setup"];if(is(e,"vjs-fill")&&(r.fill=!0),is(e,"vjs-fluid")&&(r.fluid=!0),o!==null){const[c,f]=_e()(o||"{}");c&&ci.error(c),Object.assign(r,f)}if(Object.assign(i,r),e.hasChildNodes()){const c=e.childNodes;for(let f=0,y=c.length;f<y;f++){const S=c[f],O=S.nodeName.toLowerCase();O==="source"?i.sources.push(cr(S)):O==="track"&&i.tracks.push(cr(S))}}return i}debug(e){if(e===void 0)return this.debugEnabled_;e?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)}playbackRates(e){if(e===void 0)return this.cache_.playbackRates;!Array.isArray(e)||!e.every(i=>typeof i=="number")||(this.cache_.playbackRates=e,this.trigger("playbackrateschange"))}}Ln.names.forEach(function(s){const e=Ln[s];B.prototype[e.getterName]=function(){return this.tech_?this.tech_[e.getterName]():(this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName])}}),B.prototype.crossorigin=B.prototype.crossOrigin,B.players={};const W=ne().navigator;B.prototype.options_={techOrder:ni.defaultTechOrder_,html5:{},enableSourceset:!0,inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","titleBar","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:W&&(W.languages&&W.languages[0]||W.userLanguage||W.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",normalizeAutoplay:!1,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1,audioOnlyMode:!1,audioPosterMode:!1,spatialNavigation:{enabled:!1,horizontalSeek:!1},enableSmoothSeeking:!1},p.forEach(function(s){B.prototype[`handleTech${zi(s)}_`]=function(){return this.trigger(s)}}),et.registerComponent("Player",B);const K="plugin",ee="activePlugins_",re={},xe=s=>re.hasOwnProperty(s),Fe=s=>xe(s)?re[s]:void 0,Me=(s,e)=>{s[ee]=s[ee]||{},s[ee][e]=!0},it=(s,e,i)=>{const r=(i?"before":"")+"pluginsetup";s.trigger(r,e),s.trigger(r+":"+e.name,e)},$e=function(s,e){const i=function(){it(this,{name:s,plugin:e,instance:null},!0);const r=e.apply(this,arguments);return Me(this,s),it(this,{name:s,plugin:e,instance:r}),r};return Object.keys(e).forEach(function(r){i[r]=e[r]}),i},ut=(s,e)=>(e.prototype.name=s,function(...i){it(this,{name:s,plugin:e,instance:null},!0);const r=new e(...[this,...i]);return this[s]=()=>r,it(this,r.getEventHash()),r});class Qe{constructor(e){if(this.constructor===Qe)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=e,this.log||(this.log=this.player.log.createLogger(this.name)),Wl(this),delete this.trigger,Hr(this,this.constructor.defaultState),Me(e,this.name),this.dispose=this.dispose.bind(this),e.on("dispose",this.dispose)}version(){return this.constructor.VERSION}getEventHash(e={}){return e.name=this.name,e.plugin=this.constructor,e.instance=this,e}trigger(e,i={}){return Js(this.eventBusEl_,e,this.getEventHash(i))}handleStateChanged(e){}dispose(){const{name:e,player:i}=this;this.trigger("dispose"),this.off(),i.off("dispose",this.dispose),i[ee][e]=!1,this.player=this.state=null,i[e]=ut(e,re[e])}static isBasic(e){const i=typeof e=="string"?Fe(e):e;return typeof i=="function"&&!Qe.prototype.isPrototypeOf(i.prototype)}static registerPlugin(e,i){if(typeof e!="string")throw new Error(`Illegal plugin name, "${e}", must be a string, was ${typeof e}.`);if(xe(e))ci.warn(`A plugin named "${e}" already exists. You may want to avoid re-registering plugins!`);else if(B.prototype.hasOwnProperty(e))throw new Error(`Illegal plugin name, "${e}", cannot share a name with an existing player method!`);if(typeof i!="function")throw new Error(`Illegal plugin for "${e}", must be a function, was ${typeof i}.`);return re[e]=i,e!==K&&(Qe.isBasic(i)?B.prototype[e]=$e(e,i):B.prototype[e]=ut(e,i)),i}static deregisterPlugin(e){if(e===K)throw new Error("Cannot de-register base plugin.");xe(e)&&(delete re[e],delete B.prototype[e])}static getPlugins(e=Object.keys(re)){let i;return e.forEach(r=>{const o=Fe(r);o&&(i=i||{},i[r]=o)}),i}static getPluginVersion(e){const i=Fe(e);return i&&i.VERSION||""}}Qe.getPlugin=Fe,Qe.BASE_PLUGIN_NAME=K,Qe.registerPlugin(K,Qe),B.prototype.usingPlugin=function(s){return!!this[ee]&&this[ee][s]===!0},B.prototype.hasPlugin=function(s){return!!xe(s)};function yt(s,e){let i=!1;return function(...r){return i||ci.warn(s),i=!0,e.apply(this,r)}}function xt(s,e,i,r){return yt(`${e} is deprecated and will be removed in ${s}.0; please use ${i} instead.`,r)}var ot={NetworkBadStatus:"networkbadstatus",NetworkRequestFailed:"networkrequestfailed",NetworkRequestAborted:"networkrequestaborted",NetworkRequestTimeout:"networkrequesttimeout",NetworkBodyParserFailed:"networkbodyparserfailed",StreamingHlsPlaylistParserError:"streaminghlsplaylistparsererror",StreamingDashManifestParserError:"streamingdashmanifestparsererror",StreamingContentSteeringParserError:"streamingcontentsteeringparsererror",StreamingVttParserError:"streamingvttparsererror",StreamingFailedToSelectNextSegment:"streamingfailedtoselectnextsegment",StreamingFailedToDecryptSegment:"streamingfailedtodecryptsegment",StreamingFailedToTransmuxSegment:"streamingfailedtotransmuxsegment",StreamingFailedToAppendSegment:"streamingfailedtoappendsegment",StreamingCodecsChangeError:"streamingcodecschangeerror"};const At=s=>s.indexOf("#")===0?s.slice(1):s;function Re(s,e,i){let r=Re.getPlayer(s);if(r)return e&&ci.warn(`Player "${s}" is already initialised. Options will not be applied.`),i&&r.ready(i),r;const o=typeof s=="string"?_t("#"+At(s)):s;if(!ts(o))throw new TypeError("The element or ID supplied is not valid. (videojs)");const f=("getRootNode"in o?o.getRootNode()instanceof ne().ShadowRoot:!1)?o.getRootNode():o.ownerDocument.body;(!o.ownerDocument.defaultView||!f.contains(o))&&ci.warn("The element supplied is not included in the DOM"),e=e||{},e.restoreEl===!0&&(e.restoreEl=(o.parentNode&&o.parentNode.hasAttribute&&o.parentNode.hasAttribute("data-vjs-player")?o.parentNode:o).cloneNode(!0)),Br("beforesetup").forEach(S=>{const O=S(o,Si(e));if(!Jn(O)||Array.isArray(O)){ci.error("please return an object in beforesetup hooks");return}e=Si(e,O)});const y=et.getComponent("Player");return r=new y(o,e,i),Br("setup").forEach(S=>S(r)),r}if(Re.hooks_=Sn,Re.hooks=Br,Re.hook=Ho,Re.hookOnce=$l,Re.removeHook=Jr,ne().VIDEOJS_NO_DYNAMIC_STYLE!==!0&&jr()){let s=_t(".vjs-styles-defaults");if(!s){s=Er("vjs-styles-defaults");const e=_t("head");e&&e.insertBefore(s,e.firstChild),ns(s,`
      .video-js {
        width: 300px;
        height: 150px;
      }

      .vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: 56.25%
      }
    `)}}vi(1,Re),Re.VERSION=vr,Re.options=B.prototype.options_,Re.getPlayers=()=>B.players,Re.getPlayer=s=>{const e=B.players;let i;if(typeof s=="string"){const r=At(s),o=e[r];if(o)return o;i=_t("#"+r)}else i=s;if(ts(i)){const{player:r,playerId:o}=i;if(r||e[o])return r||e[o]}},Re.getAllPlayers=()=>Object.keys(B.players).map(s=>B.players[s]).filter(Boolean),Re.players=B.players,Re.getComponent=et.getComponent,Re.registerComponent=(s,e)=>(ni.isTech(e)&&ci.warn(`The ${s} tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)`),et.registerComponent.call(et,s,e)),Re.getTech=ni.getTech,Re.registerTech=ni.registerTech,Re.use=Vc,Object.defineProperty(Re,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(Re.middleware,"TERMINATOR",{value:ll,writeable:!1,enumerable:!0}),Re.browser=Da,Re.obj=Ta,Re.mergeOptions=xt(9,"videojs.mergeOptions","videojs.obj.merge",Si),Re.defineLazyProperty=xt(9,"videojs.defineLazyProperty","videojs.obj.defineLazyProperty",Mr),Re.bind=xt(9,"videojs.bind","native Function.prototype.bind",Ni),Re.registerPlugin=Qe.registerPlugin,Re.deregisterPlugin=Qe.deregisterPlugin,Re.plugin=(s,e)=>(ci.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),Qe.registerPlugin(s,e)),Re.getPlugins=Qe.getPlugins,Re.getPlugin=Qe.getPlugin,Re.getPluginVersion=Qe.getPluginVersion,Re.addLanguage=function(s,e){return s=(""+s).toLowerCase(),Re.options.languages=Si(Re.options.languages,{[s]:e}),Re.options.languages[s]},Re.log=ci,Re.createLogger=Xn,Re.time=od,Re.createTimeRange=xt(9,"videojs.createTimeRange","videojs.time.createTimeRanges",Sr),Re.createTimeRanges=xt(9,"videojs.createTimeRanges","videojs.time.createTimeRanges",Sr),Re.formatTime=xt(9,"videojs.formatTime","videojs.time.formatTime",ss),Re.setFormatTime=xt(9,"videojs.setFormatTime","videojs.time.setFormatTime",Yl),Re.resetFormatTime=xt(9,"videojs.resetFormatTime","videojs.time.resetFormatTime",Zs),Re.parseUrl=xt(9,"videojs.parseUrl","videojs.url.parseUrl",eu),Re.isCrossOrigin=xt(9,"videojs.isCrossOrigin","videojs.url.isCrossOrigin",ao),Re.EventTarget=Zn,Re.any=Ge,Re.on=yn,Re.one=Tr,Re.off=wn,Re.trigger=Js,Re.xhr=ye(),Re.TextTrack=lo,Re.AudioTrack=uo,Re.VideoTrack=ol,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(s=>{Re[s]=function(){return ci.warn(`videojs.${s}() is deprecated; use videojs.dom.${s}() instead`),Ot[s].apply(null,arguments)}}),Re.computedStyle=xt(9,"videojs.computedStyle","videojs.dom.computedStyle",Et),Re.dom=Ot,Re.fn=Bc,Re.num=Xc,Re.str=Kl,Re.url=hd,Re.Error=ot;/*! @name videojs-contrib-quality-levels @version 4.1.0 @license Apache-2.0 */class Pt{constructor(e){let i=this;return i.id=e.id,i.label=i.id,i.width=e.width,i.height=e.height,i.bitrate=e.bandwidth,i.frameRate=e.frameRate,i.enabled_=e.enabled,Object.defineProperty(i,"enabled",{get(){return i.enabled_()},set(r){i.enabled_(r)}}),i}}class ii extends Re.EventTarget{constructor(){super();let e=this;return e.levels_=[],e.selectedIndex_=-1,Object.defineProperty(e,"selectedIndex",{get(){return e.selectedIndex_}}),Object.defineProperty(e,"length",{get(){return e.levels_.length}}),e[Symbol.iterator]=()=>e.levels_.values(),e}addQualityLevel(e){let i=this.getQualityLevelById(e.id);if(i)return i;const r=this.levels_.length;return i=new Pt(e),""+r in this||Object.defineProperty(this,r,{get(){return this.levels_[r]}}),this.levels_.push(i),this.trigger({qualityLevel:i,type:"addqualitylevel"}),i}removeQualityLevel(e){let i=null;for(let r=0,o=this.length;r<o;r++)if(this[r]===e){i=this.levels_.splice(r,1)[0],this.selectedIndex_===r?this.selectedIndex_=-1:this.selectedIndex_>r&&this.selectedIndex_--;break}return i&&this.trigger({qualityLevel:e,type:"removequalitylevel"}),i}getQualityLevelById(e){for(let i=0,r=this.length;i<r;i++){const o=this[i];if(o.id===e)return o}return null}dispose(){this.selectedIndex_=-1,this.levels_.length=0}}ii.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"};for(const s in ii.prototype.allowedEvents_)ii.prototype["on"+s]=null;var ri="4.1.0";const Qt=function(s,e){const i=s.qualityLevels,r=new ii,o=function(){r.dispose(),s.qualityLevels=i,s.off("dispose",o)};return s.on("dispose",o),s.qualityLevels=()=>r,s.qualityLevels.VERSION=ri,r},gi=function(s){return Qt(this,Re.obj.merge({},s))};Re.registerPlugin("qualityLevels",gi),gi.VERSION=ri;/*! @name @videojs/http-streaming @version 3.13.2 @license Apache-2.0 */const li=V,Ft=(s,e)=>e&&e.responseURL&&s!==e.responseURL?e.responseURL:s,St=s=>Re.log.debug?Re.log.debug.bind(Re,"VHS:",`${s} >`):function(){};function $t(...s){const e=Re.obj||Re;return(e.merge||e.mergeOptions).apply(e,s)}function zt(...s){const e=Re.time||Re;return(e.createTimeRanges||e.createTimeRanges).apply(e,s)}function wi(s){if(s.length===0)return"Buffered Ranges are empty";let e=`Buffered Ranges: 
`;for(let i=0;i<s.length;i++){const r=s.start(i),o=s.end(i);e+=`${r} --> ${o}. Duration (${o-r})
`}return e}const Li=1/30,Pi=Li*3,vn=function(s,e){const i=[];let r;if(s&&s.length)for(r=0;r<s.length;r++)e(s.start(r),s.end(r))&&i.push([s.start(r),s.end(r)]);return zt(i)},xn=function(s,e){return vn(s,function(i,r){return i-Pi<=e&&r+Pi>=e})},Is=function(s,e){return vn(s,function(i){return i-Li>=e})},Ru=function(s){if(s.length<2)return zt();const e=[];for(let i=1;i<s.length;i++){const r=s.end(i-1),o=s.start(i);e.push([r,o])}return zt(e)},E0=function(s,e){let i=null,r=null,o=0;const c=[],f=[];if(!s||!s.length||!e||!e.length)return zt();let y=s.length;for(;y--;)c.push({time:s.start(y),type:"start"}),c.push({time:s.end(y),type:"end"});for(y=e.length;y--;)c.push({time:e.start(y),type:"start"}),c.push({time:e.end(y),type:"end"});for(c.sort(function(S,O){return S.time-O.time}),y=0;y<c.length;y++)c[y].type==="start"?(o++,o===2&&(i=c[y].time)):c[y].type==="end"&&(o--,o===1&&(r=c[y].time)),i!==null&&r!==null&&(f.push([i,r]),i=null,r=null);return zt(f)},ef=s=>{const e=[];if(!s||!s.length)return"";for(let i=0;i<s.length;i++)e.push(s.start(i)+" => "+s.end(i));return e.join(", ")},T0=function(s,e,i=1){return((s.length?s.end(s.length-1):0)-e)/i},yo=s=>{const e=[];for(let i=0;i<s.length;i++)e.push({start:s.start(i),end:s.end(i)});return e},S0=function(s,e){if(s===e)return!1;if(!s&&e||!e&&s||s.length!==e.length)return!0;for(let i=0;i<s.length;i++)if(s.start(i)!==e.start(i)||s.end(i)!==e.end(i))return!0;return!1},oh=function(s){if(!(!s||!s.length||!s.end))return s.end(s.length-1)},lh=function(s,e){let i=0;if(!s||!s.length)return i;for(let r=0;r<s.length;r++){const o=s.start(r),c=s.end(r);if(!(e>c)){if(e>o&&e<=c){i+=c-e;continue}i+=c-o}}return i},uh=(s,e)=>{if(!e.preload)return e.duration;let i=0;return(e.parts||[]).forEach(function(r){i+=r.duration}),(e.preloadHints||[]).forEach(function(r){r.type==="PART"&&(i+=s.partTargetDuration)}),i},dh=s=>(s.segments||[]).reduce((e,i,r)=>(i.parts?i.parts.forEach(function(o,c){e.push({duration:o.duration,segmentIndex:r,partIndex:c,part:o,segment:i})}):e.push({duration:i.duration,segmentIndex:r,partIndex:null,segment:i,part:null}),e),[]),tf=s=>{const e=s.segments&&s.segments.length&&s.segments[s.segments.length-1];return e&&e.parts||[]},nf=({preloadSegment:s})=>{if(!s)return;const{parts:e,preloadHints:i}=s;let r=(i||[]).reduce((o,c)=>o+(c.type==="PART"?1:0),0);return r+=e&&e.length?e.length:0,r},rf=(s,e)=>{if(e.endList)return 0;if(s&&s.suggestedPresentationDelay)return s.suggestedPresentationDelay;const i=tf(e).length>0;return i&&e.serverControl&&e.serverControl.partHoldBack?e.serverControl.partHoldBack:i&&e.partTargetDuration?e.partTargetDuration*3:e.serverControl&&e.serverControl.holdBack?e.serverControl.holdBack:e.targetDuration?e.targetDuration*3:0},C0=function(s,e){let i=0,r=e-s.mediaSequence,o=s.segments[r];if(o){if(typeof o.start!="undefined")return{result:o.start,precise:!0};if(typeof o.end!="undefined")return{result:o.end-o.duration,precise:!0}}for(;r--;){if(o=s.segments[r],typeof o.end!="undefined")return{result:i+o.end,precise:!0};if(i+=uh(s,o),typeof o.start!="undefined")return{result:i+o.start,precise:!0}}return{result:i,precise:!1}},w0=function(s,e){let i=0,r,o=e-s.mediaSequence;for(;o<s.segments.length;o++){if(r=s.segments[o],typeof r.start!="undefined")return{result:r.start-i,precise:!0};if(i+=uh(s,r),typeof r.end!="undefined")return{result:r.end-i,precise:!0}}return{result:-1,precise:!1}},sf=function(s,e,i){if(typeof e=="undefined"&&(e=s.mediaSequence+s.segments.length),e<s.mediaSequence)return 0;const r=C0(s,e);if(r.precise)return r.result;const o=w0(s,e);return o.precise?o.result:r.result+i},af=function(s,e,i){if(!s)return 0;if(typeof i!="number"&&(i=0),typeof e=="undefined"){if(s.totalDuration)return s.totalDuration;if(!s.endList)return ne()[Infinity]}return sf(s,e,i)},Pu=function({defaultDuration:s,durationList:e,startIndex:i,endIndex:r}){let o=0;if(i>r&&([i,r]=[r,i]),i<0){for(let c=i;c<Math.min(0,r);c++)o+=s;i=0}for(let c=i;c<r;c++)o+=e[c].duration;return o},of=function(s,e,i,r){if(!s||!s.segments)return null;if(s.endList)return af(s);if(e===null)return null;e=e||0;let o=sf(s,s.mediaSequence+s.segments.length,e);return i&&(r=typeof r=="number"?r:rf(null,s),o-=r),Math.max(0,o)},L0=function(s,e,i){const r=!0,o=e||0;let c=of(s,e,r,i);return c===null?zt():(c<o&&(c=o),zt(o,c))},D0=function({playlist:s,currentTime:e,startingSegmentIndex:i,startingPartIndex:r,startTime:o,exactManifestTimings:c}){let f=e-o;const y=dh(s);let S=0;for(let O=0;O<y.length;O++){const q=y[O];if(i===q.segmentIndex&&!(typeof r=="number"&&typeof q.partIndex=="number"&&r!==q.partIndex)){S=O;break}}if(f<0){if(S>0)for(let O=S-1;O>=0;O--){const q=y[O];if(f+=q.duration,c){if(f<0)continue}else if(f+Li<=0)continue;return{partIndex:q.partIndex,segmentIndex:q.segmentIndex,startTime:o-Pu({defaultDuration:s.targetDuration,durationList:y,startIndex:S,endIndex:O})}}return{partIndex:y[0]&&y[0].partIndex||null,segmentIndex:y[0]&&y[0].segmentIndex||0,startTime:e}}if(S<0){for(let O=S;O<0;O++)if(f-=s.targetDuration,f<0)return{partIndex:y[0]&&y[0].partIndex||null,segmentIndex:y[0]&&y[0].segmentIndex||0,startTime:e};S=0}for(let O=S;O<y.length;O++){const q=y[O];f-=q.duration;const de=q.duration>Li,Te=f===0,Ie=de&&f+Li>=0;if(!((Te||Ie)&&O!==y.length-1)){if(c){if(f>0)continue}else if(f-Li>=0)continue;return{partIndex:q.partIndex,segmentIndex:q.segmentIndex,startTime:o+Pu({defaultDuration:s.targetDuration,durationList:y,startIndex:S,endIndex:O})}}}return{segmentIndex:y[y.length-1].segmentIndex,partIndex:y[y.length-1].partIndex,startTime:e}},lf=function(s){return s.excludeUntil&&s.excludeUntil>Date.now()},ch=function(s){return s.excludeUntil&&s.excludeUntil===Infinity},ec=function(s){const e=lf(s);return!s.disabled&&!e},k0=function(s){return s.disabled},I0=function(s){for(let e=0;e<s.segments.length;e++)if(s.segments[e].key)return!0;return!1},uf=function(s,e){return e.attributes&&e.attributes[s]},R0=function(s,e,i,r=0){return uf("BANDWIDTH",i)?(s*i.attributes.BANDWIDTH-r*8)/e:NaN},hh=(s,e)=>{if(s.playlists.length===1)return!0;const i=e.attributes.BANDWIDTH||Number.MAX_VALUE;return s.playlists.filter(r=>ec(r)?(r.attributes.BANDWIDTH||0)<i:!1).length===0},fh=(s,e)=>!s&&!e||!s&&e||s&&!e?!1:!!(s===e||s.id&&e.id&&s.id===e.id||s.resolvedUri&&e.resolvedUri&&s.resolvedUri===e.resolvedUri||s.uri&&e.uri&&s.uri===e.uri),df=function(s,e){const i=s&&s.mediaGroups&&s.mediaGroups.AUDIO||{};let r=!1;for(const o in i){for(const c in i[o])if(r=e(i[o][c]),r)break;if(r)break}return!!r},Ou=s=>{if(!s||!s.playlists||!s.playlists.length)return df(s,i=>i.playlists&&i.playlists.length||i.uri);for(let e=0;e<s.playlists.length;e++){const i=s.playlists[e],r=i.attributes&&i.attributes.CODECS;if(!(r&&r.split(",").every(c=>It(c))||df(s,c=>fh(i,c))))return!1}return!0};var fr={liveEdgeDelay:rf,duration:af,seekable:L0,getMediaInfoForTime:D0,isEnabled:ec,isDisabled:k0,isExcluded:lf,isIncompatible:ch,playlistEnd:of,isAes:I0,hasAttribute:uf,estimateSegmentRequestTime:R0,isLowestEnabledRendition:hh,isAudioOnly:Ou,playlistMatch:fh,segmentDurationWithParts:uh};const{log:cf}=Re,bl=(s,e)=>`${s}-${e}`,hf=(s,e,i)=>`placeholder-uri-${s}-${e}-${i}`,P0=({onwarn:s,oninfo:e,manifestString:i,customTagParsers:r=[],customTagMappers:o=[],llhls:c})=>{const f=new be;s&&f.on("warn",s),e&&f.on("info",e),r.forEach(O=>f.addParser(O)),o.forEach(O=>f.addTagMapper(O)),f.push(i),f.end();const y=f.manifest;if(c||(["preloadSegment","skip","serverControl","renditionReports","partInf","partTargetDuration"].forEach(function(O){y.hasOwnProperty(O)&&delete y[O]}),y.segments&&y.segments.forEach(function(O){["parts","preloadHints"].forEach(function(q){O.hasOwnProperty(q)&&delete O[q]})})),!y.targetDuration){let O=10;y.segments&&y.segments.length&&(O=y.segments.reduce((q,de)=>Math.max(q,de.duration),0)),s&&s({message:`manifest has no targetDuration defaulting to ${O}`}),y.targetDuration=O}const S=tf(y);if(S.length&&!y.partTargetDuration){const O=S.reduce((q,de)=>Math.max(q,de.duration),0);s&&(s({message:`manifest has no partTargetDuration defaulting to ${O}`}),cf.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")),y.partTargetDuration=O}return y},xl=(s,e)=>{!s.mediaGroups||["AUDIO","SUBTITLES"].forEach(i=>{if(!!s.mediaGroups[i])for(const r in s.mediaGroups[i])for(const o in s.mediaGroups[i][r]){const c=s.mediaGroups[i][r][o];e(c,i,r,o)}})},ff=({playlist:s,uri:e,id:i})=>{s.id=i,s.playlistErrors_=0,e&&(s.uri=e),s.attributes=s.attributes||{}},O0=s=>{let e=s.playlists.length;for(;e--;){const i=s.playlists[e];ff({playlist:i,id:bl(e,i.uri)}),i.resolvedUri=li(s.uri,i.uri),s.playlists[i.id]=i,s.playlists[i.uri]=i,i.attributes.BANDWIDTH||cf.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}},B0=s=>{xl(s,e=>{e.uri&&(e.resolvedUri=li(s.uri,e.uri))})},M0=(s,e)=>{const i=bl(0,e),r={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:ne().location.href,resolvedUri:ne().location.href,playlists:[{uri:e,id:i,resolvedUri:e,attributes:{}}]};return r.playlists[i]=r.playlists[0],r.playlists[e]=r.playlists[0],r},pf=(s,e,i=hf)=>{s.uri=e;for(let o=0;o<s.playlists.length;o++)if(!s.playlists[o].uri){const c=`placeholder-uri-${o}`;s.playlists[o].uri=c}const r=Ou(s);xl(s,(o,c,f,y)=>{if(!o.playlists||!o.playlists.length){if(r&&c==="AUDIO"&&!o.uri)for(let S=0;S<s.playlists.length;S++){const O=s.playlists[S];if(O.attributes&&O.attributes.AUDIO&&O.attributes.AUDIO===f)return}o.playlists=[(0,Y.Z)({},o)]}o.playlists.forEach(function(S,O){const q=i(c,f,y,S),de=bl(O,q);S.uri?S.resolvedUri=S.resolvedUri||li(s.uri,S.uri):(S.uri=O===0?q:de,S.resolvedUri=S.uri),S.id=S.id||de,S.attributes=S.attributes||{},s.playlists[S.id]=S,s.playlists[S.uri]=S})}),O0(s),B0(s)};class mf{constructor(){this.offset_=null,this.pendingDateRanges_=new Map,this.processedDateRanges_=new Map}setOffset(e=[]){if(this.offset_!==null||!e.length)return;const[i]=e;i.programDateTime!==void 0&&(this.offset_=i.programDateTime/1e3)}setPendingDateRanges(e=[]){if(!e.length)return;const[i]=e,r=i.startDate.getTime();this.trimProcessedDateRanges_(r),this.pendingDateRanges_=e.reduce((o,c)=>(o.set(c.id,c),o),new Map)}processDateRange(e){this.pendingDateRanges_.delete(e.id),this.processedDateRanges_.set(e.id,e)}getDateRangesToProcess(){if(this.offset_===null)return[];const e={},i=[];this.pendingDateRanges_.forEach((r,o)=>{if(!this.processedDateRanges_.has(o)&&(r.startTime=r.startDate.getTime()/1e3-this.offset_,r.processDateRange=()=>this.processDateRange(r),i.push(r),!!r.class))if(e[r.class]){const c=e[r.class].push(r);r.classListIndex=c-1}else e[r.class]=[r],r.classListIndex=0});for(const r of i){const o=e[r.class]||[];r.endDate?r.endTime=r.endDate.getTime()/1e3-this.offset_:r.endOnNext&&o[r.classListIndex+1]?r.endTime=o[r.classListIndex+1].startTime:r.duration?r.endTime=r.startTime+r.duration:r.plannedDuration?r.endTime=r.startTime+r.plannedDuration:r.endTime=r.startTime}return i}trimProcessedDateRanges_(e){new Map(this.processedDateRanges_).forEach((r,o)=>{r.startDate.getTime()<e&&this.processedDateRanges_.delete(o)})}}const gf=22,vo=({requestType:s,request:e,error:i,parseFailure:r})=>{const o=e.status<200||e.status>299,c=e.status>=400&&e.status<=499,f={uri:e.uri,requestType:s},y=o&&!c||r;if(i&&c)f.error=(0,Y.Z)({},i),f.errorType=Re.Error.NetworkRequestFailed;else if(e.aborted)f.errorType=Re.Error.NetworkRequestAborted;else if(e.timedout)f.erroType=Re.Error.NetworkRequestTimeout;else if(y){const S=r?Re.Error.NetworkBodyParserFailed:Re.Error.NetworkBadStatus;f.errorType=S,f.status=e.status,f.headers=e.headers}return f},{EventTarget:F0}=Re,N0=(s,e)=>{if(e.endList||!e.serverControl)return s;const i={};if(e.serverControl.canBlockReload){const{preloadSegment:r}=e;let o=e.mediaSequence+e.segments.length;if(r){const c=r.parts||[],f=nf(e)-1;f>-1&&f!==c.length-1&&(i._HLS_part=f),(f>-1||c.length)&&o--}i._HLS_msn=o}if(e.serverControl&&e.serverControl.canSkipUntil&&(i._HLS_skip=e.serverControl.canSkipDateranges?"v2":"YES"),Object.keys(i).length){const r=new(ne()).URL(s);["_HLS_skip","_HLS_msn","_HLS_part"].forEach(function(o){!i.hasOwnProperty(o)||r.searchParams.set(o,i[o])}),s=r.toString()}return s},U0=(s,e)=>{if(!s)return e;const i=$t(s,e);if(s.preloadHints&&!e.preloadHints&&delete i.preloadHints,s.parts&&!e.parts)delete i.parts;else if(s.parts&&e.parts)for(let r=0;r<e.parts.length;r++)s.parts&&s.parts[r]&&(i.parts[r]=$t(s.parts[r],e.parts[r]));return!s.skipped&&e.skipped&&(i.skipped=!1),s.preload&&!e.preload&&(i.preload=!1),i},j0=(s,e,i)=>{const r=s.slice(),o=e.slice();i=i||0;const c=[];let f;for(let y=0;y<o.length;y++){const S=r[y+i],O=o[y];S?(f=S.map||f,c.push(U0(S,O))):(f&&!O.map&&(O.map=f),c.push(O))}return c},yf=(s,e)=>{!s.resolvedUri&&s.uri&&(s.resolvedUri=li(e,s.uri)),s.key&&!s.key.resolvedUri&&(s.key.resolvedUri=li(e,s.key.uri)),s.map&&!s.map.resolvedUri&&(s.map.resolvedUri=li(e,s.map.uri)),s.map&&s.map.key&&!s.map.key.resolvedUri&&(s.map.key.resolvedUri=li(e,s.map.key.uri)),s.parts&&s.parts.length&&s.parts.forEach(i=>{i.resolvedUri||(i.resolvedUri=li(e,i.uri))}),s.preloadHints&&s.preloadHints.length&&s.preloadHints.forEach(i=>{i.resolvedUri||(i.resolvedUri=li(e,i.uri))})},vf=function(s){const e=s.segments||[],i=s.preloadSegment;if(i&&i.parts&&i.parts.length){if(i.preloadHints){for(let r=0;r<i.preloadHints.length;r++)if(i.preloadHints[r].type==="MAP")return e}i.duration=s.targetDuration,i.preload=!0,e.push(i)}return e},Af=(s,e)=>s===e||s.segments&&e.segments&&s.segments.length===e.segments.length&&s.endList===e.endList&&s.mediaSequence===e.mediaSequence&&s.preloadSegment===e.preloadSegment,ph=(s,e,i=Af)=>{const r=$t(s,{}),o=r.playlists[e.id];if(!o||i(o,e))return null;e.segments=vf(e);const c=$t(o,e);if(c.preloadSegment&&!e.preloadSegment&&delete c.preloadSegment,o.segments){if(e.skip){e.segments=e.segments||[];for(let f=0;f<e.skip.skippedSegments;f++)e.segments.unshift({skipped:!0})}c.segments=j0(o.segments,e.segments,e.mediaSequence-o.mediaSequence)}c.segments.forEach(f=>{yf(f,c.resolvedUri)});for(let f=0;f<r.playlists.length;f++)r.playlists[f].id===e.id&&(r.playlists[f]=c);return r.playlists[e.id]=c,r.playlists[e.uri]=c,xl(s,(f,y,S,O)=>{if(!!f.playlists)for(let q=0;q<f.playlists.length;q++)e.id===f.playlists[q].id&&(f.playlists[q]=c)}),r},mh=(s,e)=>{const i=s.segments||[],r=i[i.length-1],o=r&&r.parts&&r.parts[r.parts.length-1],c=o&&o.duration||r&&r.duration;return e&&c?c*1e3:(s.partTargetDuration||s.targetDuration||10)*500},_f=(s,e,i)=>{if(!s)return;const r=[];return s.forEach(o=>{if(!o.attributes)return;const{BANDWIDTH:c,RESOLUTION:f,CODECS:y}=o.attributes;r.push({id:o.id,bandwidth:c,resolution:f,codecs:y})}),{type:e,isLive:i,renditions:r}};class El extends F0{constructor(e,i,r={}){super();if(!e)throw new Error("A non-empty playlist URL or object is required");this.logger_=St("PlaylistLoader");const{withCredentials:o=!1}=r;this.src=e,this.vhs_=i,this.withCredentials=o,this.addDateRangesToTextTrack_=r.addDateRangesToTextTrack;const c=i.options_;this.customTagParsers=c&&c.customTagParsers||[],this.customTagMappers=c&&c.customTagMappers||[],this.llhls=c&&c.llhls,this.dateRangesStorage_=new mf,this.state="HAVE_NOTHING",this.handleMediaupdatetimeout_=this.handleMediaupdatetimeout_.bind(this),this.on("mediaupdatetimeout",this.handleMediaupdatetimeout_),this.on("loadedplaylist",this.handleLoadedPlaylist_.bind(this))}handleLoadedPlaylist_(){const e=this.media();if(!e)return;this.dateRangesStorage_.setOffset(e.segments),this.dateRangesStorage_.setPendingDateRanges(e.dateRanges);const i=this.dateRangesStorage_.getDateRangesToProcess();!i.length||!this.addDateRangesToTextTrack_||this.addDateRangesToTextTrack_(i)}handleMediaupdatetimeout_(){if(this.state!=="HAVE_METADATA")return;const e=this.media();let i=li(this.main.uri,e.uri);this.llhls&&(i=N0(i,e)),this.state="HAVE_CURRENT_METADATA",this.request=this.vhs_.xhr({uri:i,withCredentials:this.withCredentials,requestType:"hls-playlist"},(r,o)=>{if(!!this.request){if(r)return this.playlistRequestError(this.request,this.media(),"HAVE_METADATA");this.haveMetadata({playlistString:this.request.responseText,url:this.media().uri,id:this.media().id})}})}playlistRequestError(e,i,r){const{uri:o,id:c}=i;this.request=null,r&&(this.state=r),this.error={playlist:this.main.playlists[c],status:e.status,message:`HLS playlist request error at URL: ${o}.`,responseText:e.responseText,code:e.status>=500?4:2,metadata:vo({requestType:e.requestType,request:e,error:e.error})},this.trigger("error")}parseManifest_({url:e,manifestString:i}){try{return P0({onwarn:({message:r})=>this.logger_(`m3u8-parser warn for ${e}: ${r}`),oninfo:({message:r})=>this.logger_(`m3u8-parser info for ${e}: ${r}`),manifestString:i,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,llhls:this.llhls})}catch(r){this.error=r,this.error.metadata={errorType:Re.Error.StreamingHlsPlaylistParserError,error:r}}}haveMetadata({playlistString:e,playlistObject:i,url:r,id:o}){this.request=null,this.state="HAVE_METADATA";const c={playlistInfo:{type:"media",uri:r}};this.trigger({type:"playlistparsestart",metadata:c});const f=i||this.parseManifest_({url:r,manifestString:e});f.lastRequest=Date.now(),ff({playlist:f,uri:r,id:o});const y=ph(this.main,f);this.targetDuration=f.partTargetDuration||f.targetDuration,this.pendingMedia_=null,y?(this.main=y,this.media_=this.main.playlists[o]):this.trigger("playlistunchanged"),this.updateMediaUpdateTimeout_(mh(this.media(),!!y)),c.parsedPlaylist=_f(this.main.playlists,c.playlistInfo.type,!this.media_.endList),this.trigger({type:"playlistparsecomplete",metadata:c}),this.trigger("loadedplaylist")}dispose(){this.trigger("dispose"),this.stopRequest(),ne().clearTimeout(this.mediaUpdateTimeout),ne().clearTimeout(this.finalRenditionTimeout),this.dateRangesStorage_=new mf,this.off()}stopRequest(){if(this.request){const e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}media(e,i){if(!e)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);if(typeof e=="string"){if(!this.main.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.main.playlists[e]}if(ne().clearTimeout(this.finalRenditionTimeout),i){const y=(e.partTargetDuration||e.targetDuration)/2*1e3||5*1e3;this.finalRenditionTimeout=ne().setTimeout(this.media.bind(this,e,!1),y);return}const r=this.state,o=!this.media_||e.id!==this.media_.id,c=this.main.playlists[e.id];if(c&&c.endList||e.endList&&e.segments.length){this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=e,o&&(this.trigger("mediachanging"),r==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange"));return}if(this.updateMediaUpdateTimeout_(mh(e,!0)),!o)return;if(this.state="SWITCHING_MEDIA",this.request){if(e.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.pendingMedia_=e;const f={playlistInfo:{type:"media",uri:e.uri}};this.trigger({type:"playlistrequeststart",metadata:f}),this.request=this.vhs_.xhr({uri:e.resolvedUri,withCredentials:this.withCredentials,requestType:"hls-playlist"},(y,S)=>{if(!!this.request){if(e.lastRequest=Date.now(),e.resolvedUri=Ft(e.resolvedUri,S),y)return this.playlistRequestError(this.request,e,r);this.trigger({type:"playlistrequestcomplete",metadata:f}),this.haveMetadata({playlistString:S.responseText,url:e.uri,id:e.id}),r==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange")}})}pause(){this.mediaUpdateTimeout&&(ne().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.stopRequest(),this.state==="HAVE_NOTHING"&&(this.started=!1),this.state==="SWITCHING_MEDIA"?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MAIN_MANIFEST":this.state==="HAVE_CURRENT_METADATA"&&(this.state="HAVE_METADATA")}load(e){this.mediaUpdateTimeout&&(ne().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null);const i=this.media();if(e){const r=i?(i.partTargetDuration||i.targetDuration)/2*1e3:5*1e3;this.mediaUpdateTimeout=ne().setTimeout(()=>{this.mediaUpdateTimeout=null,this.load()},r);return}if(!this.started){this.start();return}i&&!i.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist")}updateMediaUpdateTimeout_(e){this.mediaUpdateTimeout&&(ne().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),!(!this.media()||this.media().endList)&&(this.mediaUpdateTimeout=ne().setTimeout(()=>{this.mediaUpdateTimeout=null,this.trigger("mediaupdatetimeout"),this.updateMediaUpdateTimeout_(e)},e))}start(){if(this.started=!0,typeof this.src=="object"){this.src.uri||(this.src.uri=ne().location.href),this.src.resolvedUri=this.src.uri,setTimeout(()=>{this.setupInitialPlaylist(this.src)},0);return}const e={playlistInfo:{type:"multivariant",uri:this.src}};this.trigger({type:"playlistrequeststart",metadata:e}),this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials,requestType:"hls-playlist"},(i,r)=>{if(!this.request)return;if(this.request=null,i)return this.error={status:r.status,message:`HLS playlist request error at URL: ${this.src}.`,responseText:r.responseText,code:2,metadata:vo({requestType:r.requestType,request:r,error:i})},this.state==="HAVE_NOTHING"&&(this.started=!1),this.trigger("error");this.trigger({type:"playlistrequestcomplete",metadata:e}),this.src=Ft(this.src,r),this.trigger({type:"playlistparsestart",metadata:e});const o=this.parseManifest_({manifestString:r.responseText,url:this.src});e.parsedPlaylist=_f(o.playlists,e.playlistInfo.type,!1),this.trigger({type:"playlistparsecomplete",metadata:e}),this.setupInitialPlaylist(o)})}srcUri(){return typeof this.src=="string"?this.src:this.src.uri}setupInitialPlaylist(e){if(this.state="HAVE_MAIN_MANIFEST",e.playlists){this.main=e,pf(this.main,this.srcUri()),e.playlists.forEach(r=>{r.segments=vf(r),r.segments.forEach(o=>{yf(o,r.resolvedUri)})}),this.trigger("loadedplaylist"),this.request||this.media(this.main.playlists[0]);return}const i=this.srcUri()||ne().location.href;this.main=M0(e,i),this.haveMetadata({playlistObject:e,url:i,id:this.main.playlists[0].id}),this.trigger("loadedmetadata")}updateOrDeleteClone(e,i){const r=this.main,o=e.ID;let c=r.playlists.length;for(;c--;){const f=r.playlists[c];if(f.attributes["PATHWAY-ID"]===o){const y=f.resolvedUri,S=f.id;if(i){const O=this.createCloneURI_(f.resolvedUri,e),q=bl(o,O),de=this.createCloneAttributes_(o,f.attributes),Te=this.createClonePlaylist_(f,q,e,de);r.playlists[c]=Te,r.playlists[q]=Te,r.playlists[O]=Te}else r.playlists.splice(c,1);delete r.playlists[S],delete r.playlists[y]}}this.updateOrDeleteCloneMedia(e,i)}updateOrDeleteCloneMedia(e,i){const r=this.main,o=e.ID;["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(c=>{if(!(!r.mediaGroups[c]||!r.mediaGroups[c][o])){for(const f in r.mediaGroups[c])if(f===o){for(const y in r.mediaGroups[c][f])r.mediaGroups[c][f][y].playlists.forEach((O,q)=>{const de=r.playlists[O.id],Te=de.id,Ie=de.resolvedUri;delete r.playlists[Te],delete r.playlists[Ie]});delete r.mediaGroups[c][f]}}}),i&&this.createClonedMediaGroups_(e)}addClonePathway(e,i={}){const r=this.main,o=r.playlists.length,c=this.createCloneURI_(i.resolvedUri,e),f=bl(e.ID,c),y=this.createCloneAttributes_(e.ID,i.attributes),S=this.createClonePlaylist_(i,f,e,y);r.playlists[o]=S,r.playlists[f]=S,r.playlists[c]=S,this.createClonedMediaGroups_(e)}createClonedMediaGroups_(e){const i=e.ID,r=e["BASE-ID"],o=this.main;["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(c=>{if(!(!o.mediaGroups[c]||o.mediaGroups[c][i]))for(const f in o.mediaGroups[c]){if(f===r)o.mediaGroups[c][i]={};else continue;for(const y in o.mediaGroups[c][f]){const S=o.mediaGroups[c][f][y];o.mediaGroups[c][i][y]=(0,Y.Z)({},S);const O=o.mediaGroups[c][i][y],q=this.createCloneURI_(S.resolvedUri,e);O.resolvedUri=q,O.uri=q,O.playlists=[],S.playlists.forEach((de,Te)=>{const Ie=o.playlists[de.id],ge=hf(c,i,y),je=bl(i,ge);if(Ie&&!o.playlists[je]){const Ke=this.createClonePlaylist_(Ie,je,e),Ye=Ke.resolvedUri;o.playlists[je]=Ke,o.playlists[Ye]=Ke}O.playlists[Te]=this.createClonePlaylist_(de,je,e)})}}})}createClonePlaylist_(e,i,r,o){const c=this.createCloneURI_(e.resolvedUri,r),f={resolvedUri:c,uri:c,id:i};return e.segments&&(f.segments=[]),o&&(f.attributes=o),$t(e,f)}createCloneURI_(e,i){const r=new URL(e);r.hostname=i["URI-REPLACEMENT"].HOST;const o=i["URI-REPLACEMENT"].PARAMS;for(const c of Object.keys(o))r.searchParams.set(c,o[c]);return r.href}createCloneAttributes_(e,i){const r={["PATHWAY-ID"]:e};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(o=>{i[o]&&(r[o]=e)}),r}getKeyIdSet(e){if(e.contentProtection){const i=new Set;for(const r in e.contentProtection){const o=e.contentProtection[r].attributes.keyId;o&&i.add(o.toLowerCase())}return i}}}const gh=function(s,e,i,r){const o=s.responseType==="arraybuffer"?s.response:s.responseText;!e&&o&&(s.responseTime=Date.now(),s.roundTripTime=s.responseTime-s.requestTime,s.bytesReceived=o.byteLength||o.length,s.bandwidth||(s.bandwidth=Math.floor(s.bytesReceived/s.roundTripTime*8*1e3))),i.headers&&(s.responseHeaders=i.headers),e&&e.code==="ETIMEDOUT"&&(s.timedout=!0),!e&&!s.aborted&&i.statusCode!==200&&i.statusCode!==206&&i.statusCode!==0&&(e=new Error("XHR Failed with a response of: "+(s&&(o||s.responseText)))),r(e,s)},$0=(s,e)=>{if(!s||!s.size)return;let i=e;return s.forEach(r=>{i=r(i)}),i},V0=(s,e,i,r)=>{!s||!s.size||s.forEach(o=>{o(e,i,r)})},bf=function(){const s=function e(i,r){i=$t({timeout:45e3},i);const o=e.beforeRequest||Re.Vhs.xhr.beforeRequest,c=e._requestCallbackSet||Re.Vhs.xhr._requestCallbackSet||new Set,f=e._responseCallbackSet||Re.Vhs.xhr._responseCallbackSet;o&&typeof o=="function"&&(Re.log.warn("beforeRequest is deprecated, use onRequest instead."),c.add(o));const y=Re.Vhs.xhr.original===!0?Re.xhr:Re.Vhs.xhr,S=$0(c,i);c.delete(o);const O=y(S||i,function(de,Te){return V0(f,O,de,Te),gh(O,de,Te,r)}),q=O.abort;return O.abort=function(){return O.aborted=!0,q.apply(O,arguments)},O.uri=i.uri,O.requestType=i.requestType,O.requestTime=Date.now(),O};return s.original=!0,s},H0=function(s){let e;const i=s.offset;return typeof s.offset=="bigint"||typeof s.length=="bigint"?e=ne().BigInt(s.offset)+ne().BigInt(s.length)-ne().BigInt(1):e=s.offset+s.length-1,"bytes="+i+"-"+e},yh=function(s){const e={};return s.byterange&&(e.Range=H0(s.byterange)),e},G0=function(s,e){return s.start(e)+"-"+s.end(e)},q0=function(s,e){const i=s.toString(16);return"00".substring(0,2-i.length)+i+(e%2?" ":"")},z0=function(s){return s>=32&&s<126?String.fromCharCode(s):"."},xf=function(s){const e={};return Object.keys(s).forEach(i=>{const r=s[i];un(r)?e[i]={bytes:r.buffer,byteOffset:r.byteOffset,byteLength:r.byteLength}:e[i]=r}),e},tc=function(s){const e=s.byterange||{length:Infinity,offset:0};return[e.length,e.offset,s.resolvedUri].join(",")},Ef=function(s){return s.resolvedUri},Tf=s=>{const e=Array.prototype.slice.call(s),i=16;let r="",o,c;for(let f=0;f<e.length/i;f++)o=e.slice(f*i,f*i+i).map(q0).join(""),c=e.slice(f*i,f*i+i).map(z0).join(""),r+=o+" "+c+`
`;return r};var W0=Object.freeze({__proto__:null,createTransferableMessage:xf,initSegmentId:tc,segmentKeyId:Ef,hexDump:Tf,tagDump:({bytes:s})=>Tf(s),textRanges:s=>{let e="",i;for(i=0;i<s.length;i++)e+=G0(s,i)+" ";return e}});const Sf=.25,K0=(s,e)=>{if(!e.dateTimeObject)return null;const i=e.videoTimingInfo.transmuxerPrependedSeconds,o=e.videoTimingInfo.transmuxedPresentationStart+i,c=s-o;return new Date(e.dateTimeObject.getTime()+c*1e3)},Y0=s=>s.transmuxedPresentationEnd-s.transmuxedPresentationStart-s.transmuxerPrependedSeconds,X0=(s,e)=>{let i;try{i=new Date(s)}catch(S){return null}if(!e||!e.segments||e.segments.length===0)return null;let r=e.segments[0];if(i<new Date(r.dateTimeObject))return null;for(let S=0;S<e.segments.length-1;S++){r=e.segments[S];const O=new Date(e.segments[S+1].dateTimeObject);if(i<O)break}const o=e.segments[e.segments.length-1],c=o.dateTimeObject,f=o.videoTimingInfo?Y0(o.videoTimingInfo):o.duration+o.duration*Sf,y=new Date(c.getTime()+f*1e3);return i>y?null:(i>new Date(c)&&(r=o),{segment:r,estimatedStart:r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationStart:fr.duration(e,e.mediaSequence+e.segments.indexOf(r)),type:r.videoTimingInfo?"accurate":"estimate"})},Q0=(s,e)=>{if(!e||!e.segments||e.segments.length===0)return null;let i=0,r;for(let c=0;c<e.segments.length&&(r=e.segments[c],i=r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationEnd:i+r.duration,!(s<=i));c++);const o=e.segments[e.segments.length-1];if(o.videoTimingInfo&&o.videoTimingInfo.transmuxedPresentationEnd<s)return null;if(s>i){if(s>i+o.duration*Sf)return null;r=o}return{segment:r,estimatedStart:r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationStart:i-r.duration,type:r.videoTimingInfo?"accurate":"estimate"}},J0=(s,e)=>{let i,r;try{i=new Date(s),r=new Date(e)}catch(f){}const o=i.getTime();return(r.getTime()-o)/1e3},Z0=s=>{if(!s.segments||s.segments.length===0)return!1;for(let e=0;e<s.segments.length;e++)if(!s.segments[e].dateTimeObject)return!1;return!0},em=({playlist:s,time:e=void 0,callback:i})=>{if(!i)throw new Error("getProgramTime: callback must be provided");if(!s||e===void 0)return i({message:"getProgramTime: playlist and time must be provided"});const r=Q0(e,s);if(!r)return i({message:"valid programTime was not found"});if(r.type==="estimate")return i({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:r.estimatedStart});const o={mediaSeconds:e},c=K0(e,r.segment);return c&&(o.programDateTime=c.toISOString()),i(null,o)},Cf=({programTime:s,playlist:e,retryCount:i=2,seekTo:r,pauseAfterSeek:o=!0,tech:c,callback:f})=>{if(!f)throw new Error("seekToProgramTime: callback must be provided");if(typeof s=="undefined"||!e||!r)return f({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!e.endList&&!c.hasStarted_)return f({message:"player must be playing a live stream to start buffering"});if(!Z0(e))return f({message:"programDateTime tags must be provided in the manifest "+e.resolvedUri});const y=X0(s,e);if(!y)return f({message:`${s} was not found in the stream`});const S=y.segment,O=J0(S.dateTimeObject,s);if(y.type==="estimate"){if(i===0)return f({message:`${s} is not buffered yet. Try again`});r(y.estimatedStart+O),c.one("seeked",()=>{Cf({programTime:s,playlist:e,retryCount:i-1,seekTo:r,pauseAfterSeek:o,tech:c,callback:f})});return}const q=S.start+O,de=()=>f(null,c.currentTime());c.one("seeked",de),o&&c.pause(),r(q)},vh=(s,e)=>{if(s.readyState===4)return e()},tm=(s,e,i,r)=>{let o=[],c,f=!1;const y=function(de,Te,Ie,ge){return Te.abort(),f=!0,i(de,Te,Ie,ge)},S=function(de,Te){if(f)return;if(de)return de.metadata=vo({requestType:r,request:Te,error:de}),y(de,Te,"",o);const Ie=Te.responseText.substring(o&&o.byteLength||0,Te.responseText.length);if(o=ke(o,Ze(Ie,!0)),c=c||As(o),o.length<10||c&&o.length<c+2)return vh(Te,()=>y(de,Te,"",o));const ge=Ji(o);return ge==="ts"&&o.length<188?vh(Te,()=>y(de,Te,"",o)):!ge&&o.length<376?vh(Te,()=>y(de,Te,"",o)):y(null,Te,ge,o)},q=e({uri:s,beforeSend(de){de.overrideMimeType("text/plain; charset=x-user-defined"),de.addEventListener("progress",function({total:Te,loaded:Ie}){return gh(de,null,{statusCode:de.status},S)})}},function(de,Te){return gh(q,de,Te,S)});return q},{EventTarget:im}=Re,wf=function(s,e){if(!Af(s,e)||s.sidx&&e.sidx&&(s.sidx.offset!==e.sidx.offset||s.sidx.length!==e.sidx.length))return!1;if(!s.sidx&&e.sidx||s.sidx&&!e.sidx||s.segments&&!e.segments||!s.segments&&e.segments)return!1;if(!s.segments&&!e.segments)return!0;for(let i=0;i<s.segments.length;i++){const r=s.segments[i],o=e.segments[i];if(r.uri!==o.uri)return!1;if(!r.byterange&&!o.byterange)continue;const c=r.byterange,f=o.byterange;if(c&&!f||!c&&f||c.offset!==f.offset||c.length!==f.length)return!1}return!0},nm=(s,e,i,r)=>{const o=r.attributes.NAME||i;return`placeholder-uri-${s}-${e}-${o}`},rm=({mainXml:s,srcUrl:e,clientOffset:i,sidxMapping:r,previousManifest:o})=>{const c=Pl(s,{manifestUri:e,clientOffset:i,sidxMapping:r,previousManifest:o});return pf(c,e,nm),c},sm=(s,e)=>{xl(s,(i,r,o,c)=>{c in e.mediaGroups[r][o]||delete s.mediaGroups[r][o][c]})},am=(s,e,i)=>{let r=!0,o=$t(s,{duration:e.duration,minimumUpdatePeriod:e.minimumUpdatePeriod,timelineStarts:e.timelineStarts});for(let c=0;c<e.playlists.length;c++){const f=e.playlists[c];if(f.sidx){const S=On(f.sidx);i&&i[S]&&i[S].sidx&&Xe(f,i[S].sidx,f.sidx.resolvedUri)}const y=ph(o,f,wf);y&&(o=y,r=!1)}return xl(e,(c,f,y,S)=>{if(c.playlists&&c.playlists.length){const O=c.playlists[0].id,q=ph(o,c.playlists[0],wf);q&&(o=q,S in o.mediaGroups[f][y]||(o.mediaGroups[f][y][S]=c),o.mediaGroups[f][y][S].playlists[0]=o.playlists[O],r=!1)}}),sm(o,e),e.minimumUpdatePeriod!==s.minimumUpdatePeriod&&(r=!1),r?null:o},om=(s,e)=>(Boolean(!s.map&&!e.map)||Boolean(s.map&&e.map&&s.map.byterange.offset===e.map.byterange.offset&&s.map.byterange.length===e.map.byterange.length))&&s.uri===e.uri&&s.byterange.offset===e.byterange.offset&&s.byterange.length===e.byterange.length,Lf=(s,e)=>{const i={};for(const r in s){const c=s[r].sidx;if(c){const f=On(c);if(!e[f])break;const y=e[f].sidxInfo;om(y,c)&&(i[f]=e[f])}}return i},lm=(s,e)=>{let r=Lf(s.playlists,e);return xl(s,(o,c,f,y)=>{if(o.playlists&&o.playlists.length){const S=o.playlists;r=$t(r,Lf(S,e))}}),r};class Ah extends im{constructor(e,i,r={},o){super();this.mainPlaylistLoader_=o||this,o||(this.isMain_=!0);const{withCredentials:c=!1}=r;if(this.vhs_=i,this.withCredentials=c,this.addMetadataToTextTrack=r.addMetadataToTextTrack,!e)throw new Error("A non-empty playlist URL or object is required");this.on("minimumUpdatePeriod",()=>{this.refreshXml_()}),this.on("mediaupdatetimeout",()=>{this.refreshMedia_(this.media().id)}),this.state="HAVE_NOTHING",this.loadedPlaylists_={},this.logger_=St("DashPlaylistLoader"),this.isMain_?(this.mainPlaylistLoader_.srcUrl=e,this.mainPlaylistLoader_.sidxMapping_={}):this.childPlaylist_=e}requestErrored_(e,i,r){if(!this.request)return!0;if(this.request=null,e)return this.error=typeof e=="object"&&!(e instanceof Error)?e:{status:i.status,message:"DASH request error at URL: "+i.uri,response:i.response,code:2,metadata:e.metadata},r&&(this.state=r),this.trigger("error"),!0}addSidxSegments_(e,i,r){const o=e.sidx&&On(e.sidx);if(!e.sidx||!o||this.mainPlaylistLoader_.sidxMapping_[o]){this.mediaRequest_=ne().setTimeout(()=>r(!1),0);return}const c=Ft(e.sidx.resolvedUri),f=(S,O)=>{if(this.requestErrored_(S,O,i))return;const q=this.mainPlaylistLoader_.sidxMapping_,{requestType:de}=O;let Te;try{Te=Kn()(wt(O.response).subarray(8))}catch(Ie){Ie.metadata=vo({requestType:de,request:O,parseFailure:!0}),this.requestErrored_(Ie,O,i);return}return q[o]={sidxInfo:e.sidx,sidx:Te},Xe(e,Te,e.sidx.resolvedUri),r(!0)},y="dash-sidx";this.request=tm(c,this.vhs_.xhr,(S,O,q,de)=>{if(S)return f(S,O);if(!q||q!=="mp4"){const ge=q||"unknown";return f({status:O.status,message:`Unsupported ${ge} container type for sidx segment at URL: ${c}`,response:"",playlist:e,internal:!0,playlistExclusionDuration:Infinity,code:2},O)}const{offset:Te,length:Ie}=e.sidx.byterange;if(de.length>=Ie+Te)return f(S,{response:de.subarray(Te,Te+Ie),status:O.status,uri:O.uri});this.request=this.vhs_.xhr({uri:c,responseType:"arraybuffer",requestType:"dash-sidx",headers:yh({byterange:e.sidx.byterange})},f)},y)}dispose(){this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},ne().clearTimeout(this.minimumUpdatePeriodTimeout_),ne().clearTimeout(this.mediaRequest_),ne().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.mediaRequest_=null,this.minimumUpdatePeriodTimeout_=null,this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.off()}hasPendingRequest(){return this.request||this.mediaRequest_}stopRequest(){if(this.request){const e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}media(e){if(!e)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);const i=this.state;if(typeof e=="string"){if(!this.mainPlaylistLoader_.main.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.mainPlaylistLoader_.main.playlists[e]}const r=!this.media_||e.id!==this.media_.id;if(r&&this.loadedPlaylists_[e.id]&&this.loadedPlaylists_[e.id].endList){this.state="HAVE_METADATA",this.media_=e,r&&(this.trigger("mediachanging"),this.trigger("mediachange"));return}!r||(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(e,i,o=>{this.haveMetadata({startingState:i,playlist:e})}))}haveMetadata({startingState:e,playlist:i}){this.state="HAVE_METADATA",this.loadedPlaylists_[i.id]=i,this.mediaRequest_=null,this.refreshMedia_(i.id),e==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange")}pause(){this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.stopRequest(),ne().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.isMain_&&(ne().clearTimeout(this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_),this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_=null),this.state==="HAVE_NOTHING"&&(this.started=!1)}load(e){ne().clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null;const i=this.media();if(e){const r=i?i.targetDuration/2*1e3:5*1e3;this.mediaUpdateTimeout=ne().setTimeout(()=>this.load(),r);return}if(!this.started){this.start();return}i&&!i.endList?(this.isMain_&&!this.minimumUpdatePeriodTimeout_&&(this.trigger("minimumUpdatePeriod"),this.updateMinimumUpdatePeriodTimeout_()),this.trigger("mediaupdatetimeout")):this.trigger("loadedplaylist")}start(){if(this.started=!0,!this.isMain_){this.mediaRequest_=ne().setTimeout(()=>this.haveMain_(),0);return}this.requestMain_((e,i)=>{this.haveMain_(),!this.hasPendingRequest()&&!this.media_&&this.media(this.mainPlaylistLoader_.main.playlists[0])})}requestMain_(e){const i={manifestInfo:{uri:this.mainPlaylistLoader_.srcUrl}};this.trigger({type:"manifestrequeststart",metadata:i}),this.request=this.vhs_.xhr({uri:this.mainPlaylistLoader_.srcUrl,withCredentials:this.withCredentials,requestType:"dash-manifest"},(r,o)=>{if(r){const{requestType:f}=o;r.metadata=vo({requestType:f,request:o,error:r})}if(this.requestErrored_(r,o)){this.state==="HAVE_NOTHING"&&(this.started=!1);return}this.trigger({type:"manifestrequestcomplete",metadata:i});const c=o.responseText!==this.mainPlaylistLoader_.mainXml_;if(this.mainPlaylistLoader_.mainXml_=o.responseText,o.responseHeaders&&o.responseHeaders.date?this.mainLoaded_=Date.parse(o.responseHeaders.date):this.mainLoaded_=Date.now(),this.mainPlaylistLoader_.srcUrl=Ft(this.mainPlaylistLoader_.srcUrl,o),c){this.handleMain_(),this.syncClientServerClock_(()=>e(o,c));return}return e(o,c)})}syncClientServerClock_(e){const i=Ol(this.mainPlaylistLoader_.mainXml_);if(i===null)return this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),e();if(i.method==="DIRECT")return this.mainPlaylistLoader_.clientOffset_=i.value-Date.now(),e();this.request=this.vhs_.xhr({uri:li(this.mainPlaylistLoader_.srcUrl,i.value),method:i.method,withCredentials:this.withCredentials,requestType:"dash-clock-sync"},(r,o)=>{if(!this.request)return;if(r){const{requestType:f}=o;return this.error.metadata=vo({requestType:f,request:o,error:r}),this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),e()}let c;i.method==="HEAD"?!o.responseHeaders||!o.responseHeaders.date?c=this.mainLoaded_:c=Date.parse(o.responseHeaders.date):c=Date.parse(o.responseText),this.mainPlaylistLoader_.clientOffset_=c-Date.now(),e()})}haveMain_(){this.state="HAVE_MAIN_MANIFEST",this.isMain_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)}handleMain_(){this.mediaRequest_=null;const e=this.mainPlaylistLoader_.main,i={manifestInfo:{uri:this.mainPlaylistLoader_.srcUrl}};this.trigger({type:"manifestparsestart",metadata:i});let r;try{r=rm({mainXml:this.mainPlaylistLoader_.mainXml_,srcUrl:this.mainPlaylistLoader_.srcUrl,clientOffset:this.mainPlaylistLoader_.clientOffset_,sidxMapping:this.mainPlaylistLoader_.sidxMapping_,previousManifest:e})}catch(c){this.error=c,this.error.metadata={errorType:Re.Error.StreamingDashManifestParserError,error:c},this.trigger("error")}e&&(r=am(e,r,this.mainPlaylistLoader_.sidxMapping_)),this.mainPlaylistLoader_.main=r||e;const o=this.mainPlaylistLoader_.main.locations&&this.mainPlaylistLoader_.main.locations[0];if(o&&o!==this.mainPlaylistLoader_.srcUrl&&(this.mainPlaylistLoader_.srcUrl=o),(!e||r&&r.minimumUpdatePeriod!==e.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_(),this.addEventStreamToMetadataTrack_(r),r){const{duration:c,endList:f}=r,y=[];r.playlists.forEach(O=>{y.push({id:O.id,bandwidth:O.attributes.BANDWIDTH,resolution:O.attributes.RESOLUTION,codecs:O.attributes.CODECS})});const S={duration:c,isLive:!f,renditions:y};i.parsedManifest=S,this.trigger({type:"manifestparsecomplete",metadata:i})}return Boolean(r)}updateMinimumUpdatePeriodTimeout_(){const e=this.mainPlaylistLoader_;e.createMupOnMedia_&&(e.off("loadedmetadata",e.createMupOnMedia_),e.createMupOnMedia_=null),e.minimumUpdatePeriodTimeout_&&(ne().clearTimeout(e.minimumUpdatePeriodTimeout_),e.minimumUpdatePeriodTimeout_=null);let i=e.main&&e.main.minimumUpdatePeriod;if(i===0&&(e.media()?i=e.media().targetDuration*1e3:(e.createMupOnMedia_=e.updateMinimumUpdatePeriodTimeout_,e.one("loadedmetadata",e.createMupOnMedia_))),typeof i!="number"||i<=0){i<0&&this.logger_(`found invalid minimumUpdatePeriod of ${i}, not setting a timeout`);return}this.createMUPTimeout_(i)}createMUPTimeout_(e){const i=this.mainPlaylistLoader_;i.minimumUpdatePeriodTimeout_=ne().setTimeout(()=>{i.minimumUpdatePeriodTimeout_=null,i.trigger("minimumUpdatePeriod"),i.createMUPTimeout_(e)},e)}refreshXml_(){this.requestMain_((e,i)=>{!i||(this.media_&&(this.media_=this.mainPlaylistLoader_.main.playlists[this.media_.id]),this.mainPlaylistLoader_.sidxMapping_=lm(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.sidxMapping_),this.addSidxSegments_(this.media(),this.state,r=>{this.refreshMedia_(this.media().id)}))})}refreshMedia_(e){if(!e)throw new Error("refreshMedia_ must take a media id");this.media_&&this.isMain_&&this.handleMain_();const i=this.mainPlaylistLoader_.main.playlists,r=!this.media_||this.media_!==i[e];if(r?this.media_=i[e]:this.trigger("playlistunchanged"),!this.mediaUpdateTimeout){const o=()=>{this.media().endList||(this.mediaUpdateTimeout=ne().setTimeout(()=>{this.trigger("mediaupdatetimeout"),o()},mh(this.media(),Boolean(r))))};o()}this.trigger("loadedplaylist")}addEventStreamToMetadataTrack_(e){if(e&&this.mainPlaylistLoader_.main.eventStream){const i=this.mainPlaylistLoader_.main.eventStream.map(r=>({cueTime:r.start,frames:[{data:r.messageData}]}));this.addMetadataToTextTrack("EventStream",i,this.mainPlaylistLoader_.main.duration)}}getKeyIdSet(e){if(e.contentProtection){const i=new Set;for(const r in e.contentProtection){const o=e.contentProtection[r].attributes["cenc:default_KID"];o&&i.add(o.replace(/-/g,"").toLowerCase())}return i}}}var In={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30};const um=s=>{const e=new Uint8Array(new ArrayBuffer(s.length));for(let i=0;i<s.length;i++)e[i]=s.charCodeAt(i);return e.buffer},Df=function(s){return s.on=s.addEventListener,s.off=s.removeEventListener,s},dm=function(s){try{return URL.createObjectURL(new Blob([s],{type:"application/javascript"}))}catch(e){const i=new BlobBuilder;return i.append(s),URL.createObjectURL(i.getBlob())}},kf=function(s){return function(){const e=dm(s),i=Df(new Worker(e));i.objURL=e;const r=i.terminate;return i.on=i.addEventListener,i.off=i.removeEventListener,i.terminate=function(){return URL.revokeObjectURL(e),r.call(this)},i}},If=function(s){return`var browserWorkerPolyFill = ${Df.toString()};
browserWorkerPolyFill(self);
`+s},Rf=function(s){return s.toString().replace(/^function.+?{/,"").slice(0,-1)},cm=If(Rf(function(){var s=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof mt.g!="undefined"?mt.g:typeof self!="undefined"?self:{},e=function(){this.init=function(){var m={};this.on=function(_,w){m[_]||(m[_]=[]),m[_]=m[_].concat(w)},this.off=function(_,w){var T;return m[_]?(T=m[_].indexOf(w),m[_]=m[_].slice(),m[_].splice(T,1),T>-1):!1},this.trigger=function(_){var w,T,R,U;if(w=m[_],!!w)if(arguments.length===2)for(R=w.length,T=0;T<R;++T)w[T].call(this,arguments[1]);else{for(U=[],T=arguments.length,T=1;T<arguments.length;++T)U.push(arguments[T]);for(R=w.length,T=0;T<R;++T)w[T].apply(this,U)}},this.dispose=function(){m={}}}};e.prototype.pipe=function(m){return this.on("data",function(_){m.push(_)}),this.on("done",function(_){m.flush(_)}),this.on("partialdone",function(_){m.partialFlush(_)}),this.on("endedtimeline",function(_){m.endTimeline(_)}),this.on("reset",function(_){m.reset(_)}),m},e.prototype.push=function(m){this.trigger("data",m)},e.prototype.flush=function(m){this.trigger("done",m)},e.prototype.partialFlush=function(m){this.trigger("partialdone",m)},e.prototype.endTimeline=function(m){this.trigger("endedtimeline",m)},e.prototype.reset=function(m){this.trigger("reset",m)};var i=e,r=Math.pow(2,32),o=function(m){var _=new DataView(m.buffer,m.byteOffset,m.byteLength),w;return _.getBigUint64?(w=_.getBigUint64(0),w<Number.MAX_SAFE_INTEGER?Number(w):w):_.getUint32(0)*r+_.getUint32(4)},c={getUint64:o,MAX_UINT32:r},f=c.MAX_UINT32,y,S,O,q,de,Te,Ie,ge,je,Ke,Ye,qe,at,ht,Ue,pt,Vt,Bt,yi,ln,Rn,en,Wt,Oi,zr,la,$a,_o,bo,xo,Eo,To,lc,Sp,Cp,wp;(function(){var m;if(Wt={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},typeof Uint8Array!="undefined"){for(m in Wt)Wt.hasOwnProperty(m)&&(Wt[m]=[m.charCodeAt(0),m.charCodeAt(1),m.charCodeAt(2),m.charCodeAt(3)]);Oi=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),la=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),zr=new Uint8Array([0,0,0,1]),$a=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),_o=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),bo={video:$a,audio:_o},To=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),Eo=new Uint8Array([0,0,0,0,0,0,0,0]),lc=new Uint8Array([0,0,0,0,0,0,0,0]),Sp=lc,Cp=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),wp=lc,xo=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})(),y=function(m){var _=[],w=0,T,R,U;for(T=1;T<arguments.length;T++)_.push(arguments[T]);for(T=_.length;T--;)w+=_[T].byteLength;for(R=new Uint8Array(w+8),U=new DataView(R.buffer,R.byteOffset,R.byteLength),U.setUint32(0,R.byteLength),R.set(m,4),T=0,w=8;T<_.length;T++)R.set(_[T],w),w+=_[T].byteLength;return R},S=function(){return y(Wt.dinf,y(Wt.dref,To))},O=function(m){return y(Wt.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,m.audioobjecttype<<3|m.samplingfrequencyindex>>>1,m.samplingfrequencyindex<<7|m.channelcount<<3,6,1,2]))},q=function(){return y(Wt.ftyp,Oi,zr,Oi,la)},pt=function(m){return y(Wt.hdlr,bo[m])},de=function(m){return y(Wt.mdat,m)},Ue=function(m){var _=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,m.duration>>>24&255,m.duration>>>16&255,m.duration>>>8&255,m.duration&255,85,196,0,0]);return m.samplerate&&(_[12]=m.samplerate>>>24&255,_[13]=m.samplerate>>>16&255,_[14]=m.samplerate>>>8&255,_[15]=m.samplerate&255),y(Wt.mdhd,_)},ht=function(m){return y(Wt.mdia,Ue(m),pt(m.type),Ie(m))},Te=function(m){return y(Wt.mfhd,new Uint8Array([0,0,0,0,(m&4278190080)>>24,(m&16711680)>>16,(m&65280)>>8,m&255]))},Ie=function(m){return y(Wt.minf,m.type==="video"?y(Wt.vmhd,xo):y(Wt.smhd,Eo),S(),Bt(m))},ge=function(m,_){for(var w=[],T=_.length;T--;)w[T]=ln(_[T]);return y.apply(null,[Wt.moof,Te(m)].concat(w))},je=function(m){for(var _=m.length,w=[];_--;)w[_]=qe(m[_]);return y.apply(null,[Wt.moov,Ye(4294967295)].concat(w).concat(Ke(m)))},Ke=function(m){for(var _=m.length,w=[];_--;)w[_]=Rn(m[_]);return y.apply(null,[Wt.mvex].concat(w))},Ye=function(m){var _=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(m&4278190080)>>24,(m&16711680)>>16,(m&65280)>>8,m&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return y(Wt.mvhd,_)},Vt=function(m){var _=m.samples||[],w=new Uint8Array(4+_.length),T,R;for(R=0;R<_.length;R++)T=_[R].flags,w[R+4]=T.dependsOn<<4|T.isDependedOn<<2|T.hasRedundancy;return y(Wt.sdtp,w)},Bt=function(m){return y(Wt.stbl,yi(m),y(Wt.stts,wp),y(Wt.stsc,Sp),y(Wt.stsz,Cp),y(Wt.stco,lc))},function(){var m,_;yi=function(w){return y(Wt.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),w.type==="video"?m(w):_(w))},m=function(w){var T=w.sps||[],R=w.pps||[],U=[],he=[],me,Ae;for(me=0;me<T.length;me++)U.push((T[me].byteLength&65280)>>>8),U.push(T[me].byteLength&255),U=U.concat(Array.prototype.slice.call(T[me]));for(me=0;me<R.length;me++)he.push((R[me].byteLength&65280)>>>8),he.push(R[me].byteLength&255),he=he.concat(Array.prototype.slice.call(R[me]));if(Ae=[Wt.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(w.width&65280)>>8,w.width&255,(w.height&65280)>>8,w.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),y(Wt.avcC,new Uint8Array([1,w.profileIdc,w.profileCompatibility,w.levelIdc,255].concat([T.length],U,[R.length],he))),y(Wt.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],w.sarRatio){var Ee=w.sarRatio[0],Ne=w.sarRatio[1];Ae.push(y(Wt.pasp,new Uint8Array([(Ee&4278190080)>>24,(Ee&16711680)>>16,(Ee&65280)>>8,Ee&255,(Ne&4278190080)>>24,(Ne&16711680)>>16,(Ne&65280)>>8,Ne&255])))}return y.apply(null,Ae)},_=function(w){return y(Wt.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(w.channelcount&65280)>>8,w.channelcount&255,(w.samplesize&65280)>>8,w.samplesize&255,0,0,0,0,(w.samplerate&65280)>>8,w.samplerate&255,0,0]),O(w))}}(),at=function(m){var _=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(m.id&4278190080)>>24,(m.id&16711680)>>16,(m.id&65280)>>8,m.id&255,0,0,0,0,(m.duration&4278190080)>>24,(m.duration&16711680)>>16,(m.duration&65280)>>8,m.duration&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(m.width&65280)>>8,m.width&255,0,0,(m.height&65280)>>8,m.height&255,0,0]);return y(Wt.tkhd,_)},ln=function(m){var _,w,T,R,U,he,me;return _=y(Wt.tfhd,new Uint8Array([0,0,0,58,(m.id&4278190080)>>24,(m.id&16711680)>>16,(m.id&65280)>>8,m.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),he=Math.floor(m.baseMediaDecodeTime/f),me=Math.floor(m.baseMediaDecodeTime%f),w=y(Wt.tfdt,new Uint8Array([1,0,0,0,he>>>24&255,he>>>16&255,he>>>8&255,he&255,me>>>24&255,me>>>16&255,me>>>8&255,me&255])),U=32+20+8+16+8+8,m.type==="audio"?(T=en(m,U),y(Wt.traf,_,w,T)):(R=Vt(m),T=en(m,R.length+U),y(Wt.traf,_,w,T,R))},qe=function(m){return m.duration=m.duration||4294967295,y(Wt.trak,at(m),ht(m))},Rn=function(m){var _=new Uint8Array([0,0,0,0,(m.id&4278190080)>>24,(m.id&16711680)>>16,(m.id&65280)>>8,m.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return m.type!=="video"&&(_[_.length-1]=0),y(Wt.trex,_)},function(){var m,_,w;w=function(T,R){var U=0,he=0,me=0,Ae=0;return T.length&&(T[0].duration!==void 0&&(U=1),T[0].size!==void 0&&(he=2),T[0].flags!==void 0&&(me=4),T[0].compositionTimeOffset!==void 0&&(Ae=8)),[0,0,U|he|me|Ae,1,(T.length&4278190080)>>>24,(T.length&16711680)>>>16,(T.length&65280)>>>8,T.length&255,(R&4278190080)>>>24,(R&16711680)>>>16,(R&65280)>>>8,R&255]},_=function(T,R){var U,he,me,Ae,Ee,Ne;for(Ae=T.samples||[],R+=8+12+16*Ae.length,me=w(Ae,R),he=new Uint8Array(me.length+Ae.length*16),he.set(me),U=me.length,Ne=0;Ne<Ae.length;Ne++)Ee=Ae[Ne],he[U++]=(Ee.duration&4278190080)>>>24,he[U++]=(Ee.duration&16711680)>>>16,he[U++]=(Ee.duration&65280)>>>8,he[U++]=Ee.duration&255,he[U++]=(Ee.size&4278190080)>>>24,he[U++]=(Ee.size&16711680)>>>16,he[U++]=(Ee.size&65280)>>>8,he[U++]=Ee.size&255,he[U++]=Ee.flags.isLeading<<2|Ee.flags.dependsOn,he[U++]=Ee.flags.isDependedOn<<6|Ee.flags.hasRedundancy<<4|Ee.flags.paddingValue<<1|Ee.flags.isNonSyncSample,he[U++]=Ee.flags.degradationPriority&240<<8,he[U++]=Ee.flags.degradationPriority&15,he[U++]=(Ee.compositionTimeOffset&4278190080)>>>24,he[U++]=(Ee.compositionTimeOffset&16711680)>>>16,he[U++]=(Ee.compositionTimeOffset&65280)>>>8,he[U++]=Ee.compositionTimeOffset&255;return y(Wt.trun,he)},m=function(T,R){var U,he,me,Ae,Ee,Ne;for(Ae=T.samples||[],R+=8+12+8*Ae.length,me=w(Ae,R),U=new Uint8Array(me.length+Ae.length*8),U.set(me),he=me.length,Ne=0;Ne<Ae.length;Ne++)Ee=Ae[Ne],U[he++]=(Ee.duration&4278190080)>>>24,U[he++]=(Ee.duration&16711680)>>>16,U[he++]=(Ee.duration&65280)>>>8,U[he++]=Ee.duration&255,U[he++]=(Ee.size&4278190080)>>>24,U[he++]=(Ee.size&16711680)>>>16,U[he++]=(Ee.size&65280)>>>8,U[he++]=Ee.size&255;return y(Wt.trun,U)},en=function(T,R){return T.type==="audio"?m(T,R):_(T,R)}}();var Kg={ftyp:q,mdat:de,moof:ge,moov:je,initSegment:function(m){var _=q(),w=je(m),T;return T=new Uint8Array(_.byteLength+w.byteLength),T.set(_),T.set(w,_.byteLength),T}},Yg=function(m){var _,w,T=[],R=[];for(R.byteLength=0,R.nalCount=0,R.duration=0,T.byteLength=0,_=0;_<m.length;_++)w=m[_],w.nalUnitType==="access_unit_delimiter_rbsp"?(T.length&&(T.duration=w.dts-T.dts,R.byteLength+=T.byteLength,R.nalCount+=T.length,R.duration+=T.duration,R.push(T)),T=[w],T.byteLength=w.data.byteLength,T.pts=w.pts,T.dts=w.dts):(w.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"&&(T.keyFrame=!0),T.duration=w.dts-T.dts,T.byteLength+=w.data.byteLength,T.push(w));return R.length&&(!T.duration||T.duration<=0)&&(T.duration=R[R.length-1].duration),R.byteLength+=T.byteLength,R.nalCount+=T.length,R.duration+=T.duration,R.push(T),R},Xg=function(m){var _,w,T=[],R=[];for(T.byteLength=0,T.nalCount=0,T.duration=0,T.pts=m[0].pts,T.dts=m[0].dts,R.byteLength=0,R.nalCount=0,R.duration=0,R.pts=m[0].pts,R.dts=m[0].dts,_=0;_<m.length;_++)w=m[_],w.keyFrame?(T.length&&(R.push(T),R.byteLength+=T.byteLength,R.nalCount+=T.nalCount,R.duration+=T.duration),T=[w],T.nalCount=w.length,T.byteLength=w.byteLength,T.pts=w.pts,T.dts=w.dts,T.duration=w.duration):(T.duration+=w.duration,T.nalCount+=w.length,T.byteLength+=w.byteLength,T.push(w));return R.length&&T.duration<=0&&(T.duration=R[R.length-1].duration),R.byteLength+=T.byteLength,R.nalCount+=T.nalCount,R.duration+=T.duration,R.push(T),R},Qg=function(m){var _;return!m[0][0].keyFrame&&m.length>1&&(_=m.shift(),m.byteLength-=_.byteLength,m.nalCount-=_.nalCount,m[0][0].dts=_.dts,m[0][0].pts=_.pts,m[0][0].duration+=_.duration),m},Jg=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},Lp=function(m,_){var w=Jg();return w.dataOffset=_,w.compositionTimeOffset=m.pts-m.dts,w.duration=m.duration,w.size=4*m.length,w.size+=m.byteLength,m.keyFrame&&(w.flags.dependsOn=2,w.flags.isNonSyncSample=0),w},Zg=function(m,_){var w,T,R,U,he,me=_||0,Ae=[];for(w=0;w<m.length;w++)for(U=m[w],T=0;T<U.length;T++)he=U[T],R=Lp(he,me),me+=R.size,Ae.push(R);return Ae},ey=function(m){var _,w,T,R,U,he,me=0,Ae=m.byteLength,Ee=m.nalCount,Ne=Ae+4*Ee,Je=new Uint8Array(Ne),kt=new DataView(Je.buffer);for(_=0;_<m.length;_++)for(R=m[_],w=0;w<R.length;w++)for(U=R[w],T=0;T<U.length;T++)he=U[T],kt.setUint32(me,he.data.byteLength),me+=4,Je.set(he.data,me),me+=he.data.byteLength;return Je},ty=function(m,_){var w,T=_||0,R=[];return w=Lp(m,T),R.push(w),R},iy=function(m){var _,w,T=0,R=m.byteLength,U=m.length,he=R+4*U,me=new Uint8Array(he),Ae=new DataView(me.buffer);for(_=0;_<m.length;_++)w=m[_],Ae.setUint32(T,w.data.byteLength),T+=4,me.set(w.data,T),T+=w.data.byteLength;return me},ny={groupNalsIntoFrames:Yg,groupFramesIntoGops:Xg,extendFirstKeyFrame:Qg,generateSampleTable:Zg,concatenateNalData:ey,generateSampleTableForFrame:ty,concatenateNalDataForFrame:iy},Va=[33,16,5,32,164,27],Lh=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],Bi=function(m){for(var _=[];m--;)_.push(0);return _},ry=function(m){return Object.keys(m).reduce(function(_,w){return _[w]=new Uint8Array(m[w].reduce(function(T,R){return T.concat(R)},[])),_},{})},Dh,sy=function(){if(!Dh){var m={96e3:[Va,[227,64],Bi(154),[56]],88200:[Va,[231],Bi(170),[56]],64e3:[Va,[248,192],Bi(240),[56]],48e3:[Va,[255,192],Bi(268),[55,148,128],Bi(54),[112]],44100:[Va,[255,192],Bi(268),[55,163,128],Bi(84),[112]],32e3:[Va,[255,192],Bi(268),[55,234],Bi(226),[112]],24e3:[Va,[255,192],Bi(268),[55,255,128],Bi(268),[111,112],Bi(126),[224]],16e3:[Va,[255,192],Bi(268),[55,255,128],Bi(268),[111,255],Bi(269),[223,108],Bi(195),[1,192]],12e3:[Lh,Bi(268),[3,127,248],Bi(268),[6,255,240],Bi(268),[13,255,224],Bi(268),[27,253,128],Bi(259),[56]],11025:[Lh,Bi(268),[3,127,248],Bi(268),[6,255,240],Bi(268),[13,255,224],Bi(268),[27,255,192],Bi(268),[55,175,128],Bi(108),[112]],8e3:[Lh,Bi(268),[3,121,16],Bi(47),[7]]};Dh=ry(m)}return Dh},kh=9e4,Ih,Rh,uc,Ph,Dp,kp,Ip;Ih=function(m){return m*kh},Rh=function(m,_){return m*_},uc=function(m){return m/kh},Ph=function(m,_){return m/_},Dp=function(m,_){return Ih(Ph(m,_))},kp=function(m,_){return Rh(uc(m),_)},Ip=function(m,_,w){return uc(w?m:m-_)};var Ki={ONE_SECOND_IN_TS:kh,secondsToVideoTs:Ih,secondsToAudioTs:Rh,videoTsToSeconds:uc,audioTsToSeconds:Ph,audioTsToVideoTs:Dp,videoTsToAudioTs:kp,metadataTsToSeconds:Ip},ay=sy,dc=Ki,oy=function(m){var _,w,T=0;for(_=0;_<m.length;_++)w=m[_],T+=w.data.byteLength;return T},ly=function(m,_,w,T){var R,U=0,he=0,me=0,Ae=0,Ee,Ne,Je;if(!!_.length&&(R=dc.audioTsToVideoTs(m.baseMediaDecodeTime,m.samplerate),U=Math.ceil(dc.ONE_SECOND_IN_TS/(m.samplerate/1024)),w&&T&&(he=R-Math.max(w,T),me=Math.floor(he/U),Ae=me*U),!(me<1||Ae>dc.ONE_SECOND_IN_TS/2))){for(Ee=ay()[m.samplerate],Ee||(Ee=_[0].data),Ne=0;Ne<me;Ne++)Je=_[0],_.splice(0,0,{data:Ee,dts:Je.dts-U,pts:Je.pts-U});return m.baseMediaDecodeTime-=Math.floor(dc.videoTsToAudioTs(Ae,m.samplerate)),Ae}},uy=function(m,_,w){return _.minSegmentDts>=w?m:(_.minSegmentDts=Infinity,m.filter(function(T){return T.dts>=w?(_.minSegmentDts=Math.min(_.minSegmentDts,T.dts),_.minSegmentPts=_.minSegmentDts,!0):!1}))},dy=function(m){var _,w,T=[];for(_=0;_<m.length;_++)w=m[_],T.push({size:w.data.byteLength,duration:1024});return T},cy=function(m){var _,w,T=0,R=new Uint8Array(oy(m));for(_=0;_<m.length;_++)w=m[_],R.set(w.data,T),T+=w.data.byteLength;return R},hy={prefixWithSilence:ly,trimAdtsFramesByEarliestDts:uy,generateSampleTable:dy,concatenateFrameData:cy},fy=Ki.ONE_SECOND_IN_TS,py=function(m,_){typeof _.pts=="number"&&(m.timelineStartInfo.pts===void 0&&(m.timelineStartInfo.pts=_.pts),m.minSegmentPts===void 0?m.minSegmentPts=_.pts:m.minSegmentPts=Math.min(m.minSegmentPts,_.pts),m.maxSegmentPts===void 0?m.maxSegmentPts=_.pts:m.maxSegmentPts=Math.max(m.maxSegmentPts,_.pts)),typeof _.dts=="number"&&(m.timelineStartInfo.dts===void 0&&(m.timelineStartInfo.dts=_.dts),m.minSegmentDts===void 0?m.minSegmentDts=_.dts:m.minSegmentDts=Math.min(m.minSegmentDts,_.dts),m.maxSegmentDts===void 0?m.maxSegmentDts=_.dts:m.maxSegmentDts=Math.max(m.maxSegmentDts,_.dts))},my=function(m){delete m.minSegmentDts,delete m.maxSegmentDts,delete m.minSegmentPts,delete m.maxSegmentPts},gy=function(m,_){var w,T,R=m.minSegmentDts;return _||(R-=m.timelineStartInfo.dts),w=m.timelineStartInfo.baseMediaDecodeTime,w+=R,w=Math.max(0,w),m.type==="audio"&&(T=m.samplerate/fy,w*=T,w=Math.floor(w)),w},yy={clearDtsInfo:my,calculateTrackBaseMediaDecodeTime:gy,collectDtsInfo:py},Rp=4,vy=128,Ay=function(m){for(var _=0,w={payloadType:-1,payloadSize:0},T=0,R=0;_<m.byteLength&&m[_]!==vy;){for(;m[_]===255;)T+=255,_++;for(T+=m[_++];m[_]===255;)R+=255,_++;if(R+=m[_++],!w.payload&&T===Rp){var U=String.fromCharCode(m[_+3],m[_+4],m[_+5],m[_+6]);if(U==="GA94"){w.payloadType=T,w.payloadSize=R,w.payload=m.subarray(_,_+R);break}else w.payload=void 0}_+=R,T=0,R=0}return w},_y=function(m){return m.payload[0]!==181||(m.payload[1]<<8|m.payload[2])!=49||String.fromCharCode(m.payload[3],m.payload[4],m.payload[5],m.payload[6])!=="GA94"||m.payload[7]!==3?null:m.payload.subarray(8,m.payload.length-1)},by=function(m,_){var w=[],T,R,U,he;if(!(_[0]&64))return w;for(R=_[0]&31,T=0;T<R;T++)U=T*3,he={type:_[U+2]&3,pts:m},_[U+2]&4&&(he.ccData=_[U+3]<<8|_[U+4],w.push(he));return w},xy=function(m){for(var _=m.byteLength,w=[],T=1,R,U;T<_-2;)m[T]===0&&m[T+1]===0&&m[T+2]===3?(w.push(T+2),T+=2):T++;if(w.length===0)return m;R=_-w.length,U=new Uint8Array(R);var he=0;for(T=0;T<R;he++,T++)he===w[0]&&(he++,w.shift()),U[T]=m[he];return U},Pp={parseSei:Ay,parseUserData:_y,parseCaptionPackets:by,discardEmulationPreventionBytes:xy,USER_DATA_REGISTERED_ITU_T_T35:Rp},Oh=i,cc=Pp,pr=function(m){m=m||{},pr.prototype.init.call(this),this.parse708captions_=typeof m.parse708captions=="boolean"?m.parse708captions:!0,this.captionPackets_=[],this.ccStreams_=[new tn(0,0),new tn(0,1),new tn(1,0),new tn(1,1)],this.parse708captions_&&(this.cc708Stream_=new Ui({captionServices:m.captionServices})),this.reset(),this.ccStreams_.forEach(function(_){_.on("data",this.trigger.bind(this,"data")),_.on("partialdone",this.trigger.bind(this,"partialdone")),_.on("done",this.trigger.bind(this,"done"))},this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))};pr.prototype=new Oh,pr.prototype.push=function(m){var _,w,T;if(m.nalUnitType==="sei_rbsp"&&(_=cc.parseSei(m.escapedRBSP),!!_.payload&&_.payloadType===cc.USER_DATA_REGISTERED_ITU_T_T35&&(w=cc.parseUserData(_),!!w))){if(m.dts<this.latestDts_){this.ignoreNextEqualDts_=!0;return}else if(m.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--,this.numSameDts_||(this.ignoreNextEqualDts_=!1);return}T=cc.parseCaptionPackets(m.pts,w),this.captionPackets_=this.captionPackets_.concat(T),this.latestDts_!==m.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=m.dts}},pr.prototype.flushCCStreams=function(m){this.ccStreams_.forEach(function(_){return m==="flush"?_.flush():_.partialFlush()},this)},pr.prototype.flushStream=function(m){if(!this.captionPackets_.length){this.flushCCStreams(m);return}this.captionPackets_.forEach(function(_,w){_.presortIndex=w}),this.captionPackets_.sort(function(_,w){return _.pts===w.pts?_.presortIndex-w.presortIndex:_.pts-w.pts}),this.captionPackets_.forEach(function(_){_.type<2?this.dispatchCea608Packet(_):this.dispatchCea708Packet(_)},this),this.captionPackets_.length=0,this.flushCCStreams(m)},pr.prototype.flush=function(){return this.flushStream("flush")},pr.prototype.partialFlush=function(){return this.flushStream("partialFlush")},pr.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(m){m.reset()})},pr.prototype.dispatchCea608Packet=function(m){this.setsTextOrXDSActive(m)?this.activeCea608Channel_[m.type]=null:this.setsChannel1Active(m)?this.activeCea608Channel_[m.type]=0:this.setsChannel2Active(m)&&(this.activeCea608Channel_[m.type]=1),this.activeCea608Channel_[m.type]!==null&&this.ccStreams_[(m.type<<1)+this.activeCea608Channel_[m.type]].push(m)},pr.prototype.setsChannel1Active=function(m){return(m.ccData&30720)==4096},pr.prototype.setsChannel2Active=function(m){return(m.ccData&30720)==6144},pr.prototype.setsTextOrXDSActive=function(m){return(m.ccData&28928)==256||(m.ccData&30974)==4138||(m.ccData&30974)==6186},pr.prototype.dispatchCea708Packet=function(m){this.parse708captions_&&this.cc708Stream_.push(m)};var Ey={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},Ty=function(m){var _=Ey[m]||m;return m&4096&&m===_?"":String.fromCharCode(_)},hc=function(m){return 32<=m&&m<=127||160<=m&&m<=255},ua=function(m){this.windowNum=m,this.reset()};ua.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},ua.prototype.getText=function(){return this.rows.join(`
`)},ua.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},ua.prototype.newLine=function(m){for(this.rows.length>=this.virtualRowCount&&typeof this.beforeRowOverflow=="function"&&this.beforeRowOverflow(m),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},ua.prototype.isEmpty=function(){return this.rows.length===0?!0:this.rows.length===1?this.rows[0]==="":!1},ua.prototype.addText=function(m){this.rows[this.rowIdx]+=m},ua.prototype.backspace=function(){if(!this.isEmpty()){var m=this.rows[this.rowIdx];this.rows[this.rowIdx]=m.substr(0,m.length-1)}};var fc=function(m,_,w){this.serviceNum=m,this.text="",this.currentWindow=new ua(-1),this.windows=[],this.stream=w,typeof _=="string"&&this.createTextDecoder(_)};fc.prototype.init=function(m,_){this.startPts=m;for(var w=0;w<8;w++)this.windows[w]=new ua(w),typeof _=="function"&&(this.windows[w].beforeRowOverflow=_)},fc.prototype.setCurrentWindow=function(m){this.currentWindow=this.windows[m]},fc.prototype.createTextDecoder=function(m){if(typeof TextDecoder=="undefined")this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(m)}catch(_){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+m+" encoding. "+_})}};var Ui=function(m){m=m||{},Ui.prototype.init.call(this);var _=this,w=m.captionServices||{},T={},R;Object.keys(w).forEach(U=>{R=w[U],/^SERVICE/.test(U)&&(T[U]=R.encoding)}),this.serviceEncodings=T,this.current708Packet=null,this.services={},this.push=function(U){U.type===3?(_.new708Packet(),_.add708Bytes(U)):(_.current708Packet===null&&_.new708Packet(),_.add708Bytes(U))}};Ui.prototype=new Oh,Ui.prototype.new708Packet=function(){this.current708Packet!==null&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},Ui.prototype.add708Bytes=function(m){var _=m.ccData,w=_>>>8,T=_&255;this.current708Packet.ptsVals.push(m.pts),this.current708Packet.data.push(w),this.current708Packet.data.push(T)},Ui.prototype.push708Packet=function(){var m=this.current708Packet,_=m.data,w=null,T=null,R=0,U=_[R++];for(m.seq=U>>6,m.sizeCode=U&63;R<_.length;R++)U=_[R++],w=U>>5,T=U&31,w===7&&T>0&&(U=_[R++],w=U),this.pushServiceBlock(w,R,T),T>0&&(R+=T-1)},Ui.prototype.pushServiceBlock=function(m,_,w){var T,R=_,U=this.current708Packet.data,he=this.services[m];for(he||(he=this.initService(m,R));R<_+w&&R<U.length;R++)T=U[R],hc(T)?R=this.handleText(R,he):T===24?R=this.multiByteCharacter(R,he):T===16?R=this.extendedCommands(R,he):128<=T&&T<=135?R=this.setCurrentWindow(R,he):152<=T&&T<=159?R=this.defineWindow(R,he):T===136?R=this.clearWindows(R,he):T===140?R=this.deleteWindows(R,he):T===137?R=this.displayWindows(R,he):T===138?R=this.hideWindows(R,he):T===139?R=this.toggleWindows(R,he):T===151?R=this.setWindowAttributes(R,he):T===144?R=this.setPenAttributes(R,he):T===145?R=this.setPenColor(R,he):T===146?R=this.setPenLocation(R,he):T===143?he=this.reset(R,he):T===8?he.currentWindow.backspace():T===12?he.currentWindow.clearText():T===13?he.currentWindow.pendingNewLine=!0:T===14?he.currentWindow.clearText():T===141&&R++},Ui.prototype.extendedCommands=function(m,_){var w=this.current708Packet.data,T=w[++m];return hc(T)&&(m=this.handleText(m,_,{isExtended:!0})),m},Ui.prototype.getPts=function(m){return this.current708Packet.ptsVals[Math.floor(m/2)]},Ui.prototype.initService=function(m,_){var w="SERVICE"+m,T=this,w,R;return w in this.serviceEncodings&&(R=this.serviceEncodings[w]),this.services[m]=new fc(m,R,T),this.services[m].init(this.getPts(_),function(U){T.flushDisplayed(U,T.services[m])}),this.services[m]},Ui.prototype.handleText=function(m,_,w){var T=w&&w.isExtended,R=w&&w.isMultiByte,U=this.current708Packet.data,he=T?4096:0,me=U[m],Ae=U[m+1],Ee=_.currentWindow,Ne,Je;function kt(lt){return lt.map(ei=>("0"+(ei&255).toString(16)).slice(-2)).join("")}if(R?(Je=[me,Ae],m++):Je=[me],_.textDecoder_&&!T)Ne=_.textDecoder_.decode(new Uint8Array(Je));else if(R){const lt=kt(Je);Ne=String.fromCharCode(parseInt(lt,16))}else Ne=Ty(he|me);return Ee.pendingNewLine&&!Ee.isEmpty()&&Ee.newLine(this.getPts(m)),Ee.pendingNewLine=!1,Ee.addText(Ne),m},Ui.prototype.multiByteCharacter=function(m,_){var w=this.current708Packet.data,T=w[m+1],R=w[m+2];return hc(T)&&hc(R)&&(m=this.handleText(++m,_,{isMultiByte:!0})),m},Ui.prototype.setCurrentWindow=function(m,_){var w=this.current708Packet.data,T=w[m],R=T&7;return _.setCurrentWindow(R),m},Ui.prototype.defineWindow=function(m,_){var w=this.current708Packet.data,T=w[m],R=T&7;_.setCurrentWindow(R);var U=_.currentWindow;return T=w[++m],U.visible=(T&32)>>5,U.rowLock=(T&16)>>4,U.columnLock=(T&8)>>3,U.priority=T&7,T=w[++m],U.relativePositioning=(T&128)>>7,U.anchorVertical=T&127,T=w[++m],U.anchorHorizontal=T,T=w[++m],U.anchorPoint=(T&240)>>4,U.rowCount=T&15,T=w[++m],U.columnCount=T&63,T=w[++m],U.windowStyle=(T&56)>>3,U.penStyle=T&7,U.virtualRowCount=U.rowCount+1,m},Ui.prototype.setWindowAttributes=function(m,_){var w=this.current708Packet.data,T=w[m],R=_.currentWindow.winAttr;return T=w[++m],R.fillOpacity=(T&192)>>6,R.fillRed=(T&48)>>4,R.fillGreen=(T&12)>>2,R.fillBlue=T&3,T=w[++m],R.borderType=(T&192)>>6,R.borderRed=(T&48)>>4,R.borderGreen=(T&12)>>2,R.borderBlue=T&3,T=w[++m],R.borderType+=(T&128)>>5,R.wordWrap=(T&64)>>6,R.printDirection=(T&48)>>4,R.scrollDirection=(T&12)>>2,R.justify=T&3,T=w[++m],R.effectSpeed=(T&240)>>4,R.effectDirection=(T&12)>>2,R.displayEffect=T&3,m},Ui.prototype.flushDisplayed=function(m,_){for(var w=[],T=0;T<8;T++)_.windows[T].visible&&!_.windows[T].isEmpty()&&w.push(_.windows[T].getText());_.endPts=m,_.text=w.join(`

`),this.pushCaption(_),_.startPts=m},Ui.prototype.pushCaption=function(m){m.text!==""&&(this.trigger("data",{startPts:m.startPts,endPts:m.endPts,text:m.text,stream:"cc708_"+m.serviceNum}),m.text="",m.startPts=m.endPts)},Ui.prototype.displayWindows=function(m,_){var w=this.current708Packet.data,T=w[++m],R=this.getPts(m);this.flushDisplayed(R,_);for(var U=0;U<8;U++)T&1<<U&&(_.windows[U].visible=1);return m},Ui.prototype.hideWindows=function(m,_){var w=this.current708Packet.data,T=w[++m],R=this.getPts(m);this.flushDisplayed(R,_);for(var U=0;U<8;U++)T&1<<U&&(_.windows[U].visible=0);return m},Ui.prototype.toggleWindows=function(m,_){var w=this.current708Packet.data,T=w[++m],R=this.getPts(m);this.flushDisplayed(R,_);for(var U=0;U<8;U++)T&1<<U&&(_.windows[U].visible^=1);return m},Ui.prototype.clearWindows=function(m,_){var w=this.current708Packet.data,T=w[++m],R=this.getPts(m);this.flushDisplayed(R,_);for(var U=0;U<8;U++)T&1<<U&&_.windows[U].clearText();return m},Ui.prototype.deleteWindows=function(m,_){var w=this.current708Packet.data,T=w[++m],R=this.getPts(m);this.flushDisplayed(R,_);for(var U=0;U<8;U++)T&1<<U&&_.windows[U].reset();return m},Ui.prototype.setPenAttributes=function(m,_){var w=this.current708Packet.data,T=w[m],R=_.currentWindow.penAttr;return T=w[++m],R.textTag=(T&240)>>4,R.offset=(T&12)>>2,R.penSize=T&3,T=w[++m],R.italics=(T&128)>>7,R.underline=(T&64)>>6,R.edgeType=(T&56)>>3,R.fontStyle=T&7,m},Ui.prototype.setPenColor=function(m,_){var w=this.current708Packet.data,T=w[m],R=_.currentWindow.penColor;return T=w[++m],R.fgOpacity=(T&192)>>6,R.fgRed=(T&48)>>4,R.fgGreen=(T&12)>>2,R.fgBlue=T&3,T=w[++m],R.bgOpacity=(T&192)>>6,R.bgRed=(T&48)>>4,R.bgGreen=(T&12)>>2,R.bgBlue=T&3,T=w[++m],R.edgeRed=(T&48)>>4,R.edgeGreen=(T&12)>>2,R.edgeBlue=T&3,m},Ui.prototype.setPenLocation=function(m,_){var w=this.current708Packet.data,T=w[m],R=_.currentWindow.penLoc;return _.currentWindow.pendingNewLine=!0,T=w[++m],R.row=T&15,T=w[++m],R.column=T&63,m},Ui.prototype.reset=function(m,_){var w=this.getPts(m);return this.flushDisplayed(w,_),this.initService(_.serviceNum,m)};var Sy={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},pc=function(m){return m===null?"":(m=Sy[m]||m,String.fromCharCode(m))},mc=14,Cy=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],So=function(){for(var m=[],_=mc+1;_--;)m.push({text:"",indent:0,offset:0});return m},tn=function(m,_){tn.prototype.init.call(this),this.field_=m||0,this.dataChannel_=_||0,this.name_="CC"+((this.field_<<1|this.dataChannel_)+1),this.setConstants(),this.reset(),this.push=function(w){var T,R,U,he,me;if(T=w.ccData&32639,T===this.lastControlCode_){this.lastControlCode_=null;return}if((T&61440)==4096?this.lastControlCode_=T:T!==this.PADDING_&&(this.lastControlCode_=null),U=T>>>8,he=T&255,T!==this.PADDING_)if(T===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(T===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(w.pts),this.flushDisplayed(w.pts),R=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=R,this.startPts_=w.pts;else if(T===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(w.pts);else if(T===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(w.pts);else if(T===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(w.pts);else if(T===this.CARRIAGE_RETURN_)this.clearFormatting(w.pts),this.flushDisplayed(w.pts),this.shiftRowsUp_(),this.startPts_=w.pts;else if(T===this.BACKSPACE_)this.mode_==="popOn"?this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1):this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1);else if(T===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(w.pts),this.displayed_=So();else if(T===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=So();else if(T===this.RESUME_DIRECT_CAPTIONING_)this.mode_!=="paintOn"&&(this.flushDisplayed(w.pts),this.displayed_=So()),this.mode_="paintOn",this.startPts_=w.pts;else if(this.isSpecialCharacter(U,he))U=(U&3)<<8,me=pc(U|he),this[this.mode_](w.pts,me),this.column_++;else if(this.isExtCharacter(U,he))this.mode_==="popOn"?this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1):this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1),U=(U&3)<<8,me=pc(U|he),this[this.mode_](w.pts,me),this.column_++;else if(this.isMidRowCode(U,he))this.clearFormatting(w.pts),this[this.mode_](w.pts," "),this.column_++,(he&14)==14&&this.addFormatting(w.pts,["i"]),(he&1)==1&&this.addFormatting(w.pts,["u"]);else if(this.isOffsetControlCode(U,he)){const Ee=he&3;this.nonDisplayed_[this.row_].offset=Ee,this.column_+=Ee}else if(this.isPAC(U,he)){var Ae=Cy.indexOf(T&7968);if(this.mode_==="rollUp"&&(Ae-this.rollUpRows_+1<0&&(Ae=this.rollUpRows_-1),this.setRollUp(w.pts,Ae)),Ae!==this.row_&&Ae>=0&&Ae<=14&&(this.clearFormatting(w.pts),this.row_=Ae),he&1&&this.formatting_.indexOf("u")===-1&&this.addFormatting(w.pts,["u"]),(T&16)==16){const Ee=(T&14)>>1;this.column_=Ee*4,this.nonDisplayed_[this.row_].indent+=Ee}this.isColorPAC(he)&&(he&14)==14&&this.addFormatting(w.pts,["i"])}else this.isNormalChar(U)&&(he===0&&(he=null),me=pc(U),me+=pc(he),this[this.mode_](w.pts,me),this.column_+=me.length)}};tn.prototype=new Oh,tn.prototype.flushDisplayed=function(m){const _=T=>{this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+T+"."})},w=[];this.displayed_.forEach((T,R)=>{if(T&&T.text&&T.text.length){try{T.text=T.text.trim()}catch(U){_(R)}T.text.length&&w.push({text:T.text,line:R+1,position:10+Math.min(70,T.indent*10)+T.offset*2.5})}else T==null&&_(R)}),w.length&&this.trigger("data",{startPts:this.startPts_,endPts:m,content:w,stream:this.name_})},tn.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=So(),this.nonDisplayed_=So(),this.lastControlCode_=null,this.column_=0,this.row_=mc,this.rollUpRows_=2,this.formatting_=[]},tn.prototype.setConstants=function(){this.dataChannel_===0?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):this.dataChannel_===1&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=this.CONTROL_|32,this.END_OF_CAPTION_=this.CONTROL_|47,this.ROLL_UP_2_ROWS_=this.CONTROL_|37,this.ROLL_UP_3_ROWS_=this.CONTROL_|38,this.ROLL_UP_4_ROWS_=this.CONTROL_|39,this.CARRIAGE_RETURN_=this.CONTROL_|45,this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|41,this.BACKSPACE_=this.CONTROL_|33,this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44,this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46},tn.prototype.isSpecialCharacter=function(m,_){return m===this.EXT_&&_>=48&&_<=63},tn.prototype.isExtCharacter=function(m,_){return(m===this.EXT_+1||m===this.EXT_+2)&&_>=32&&_<=63},tn.prototype.isMidRowCode=function(m,_){return m===this.EXT_&&_>=32&&_<=47},tn.prototype.isOffsetControlCode=function(m,_){return m===this.OFFSET_&&_>=33&&_<=35},tn.prototype.isPAC=function(m,_){return m>=this.BASE_&&m<this.BASE_+8&&_>=64&&_<=127},tn.prototype.isColorPAC=function(m){return m>=64&&m<=79||m>=96&&m<=127},tn.prototype.isNormalChar=function(m){return m>=32&&m<=127},tn.prototype.setRollUp=function(m,_){if(this.mode_!=="rollUp"&&(this.row_=mc,this.mode_="rollUp",this.flushDisplayed(m),this.nonDisplayed_=So(),this.displayed_=So()),_!==void 0&&_!==this.row_)for(var w=0;w<this.rollUpRows_;w++)this.displayed_[_-w]=this.displayed_[this.row_-w],this.displayed_[this.row_-w]={text:"",indent:0,offset:0};_===void 0&&(_=this.row_),this.topRow_=_-this.rollUpRows_+1},tn.prototype.addFormatting=function(m,_){this.formatting_=this.formatting_.concat(_);var w=_.reduce(function(T,R){return T+"<"+R+">"},"");this[this.mode_](m,w)},tn.prototype.clearFormatting=function(m){if(!!this.formatting_.length){var _=this.formatting_.reverse().reduce(function(w,T){return w+"</"+T+">"},"");this.formatting_=[],this[this.mode_](m,_)}},tn.prototype.popOn=function(m,_){var w=this.nonDisplayed_[this.row_].text;w+=_,this.nonDisplayed_[this.row_].text=w},tn.prototype.rollUp=function(m,_){var w=this.displayed_[this.row_].text;w+=_,this.displayed_[this.row_].text=w},tn.prototype.shiftRowsUp_=function(){var m;for(m=0;m<this.topRow_;m++)this.displayed_[m]={text:"",indent:0,offset:0};for(m=this.row_+1;m<mc+1;m++)this.displayed_[m]={text:"",indent:0,offset:0};for(m=this.topRow_;m<this.row_;m++)this.displayed_[m]=this.displayed_[m+1];this.displayed_[this.row_]={text:"",indent:0,offset:0}},tn.prototype.paintOn=function(m,_){var w=this.displayed_[this.row_].text;w+=_,this.displayed_[this.row_].text=w};var Op={CaptionStream:pr,Cea608Stream:tn,Cea708Stream:Ui},gc={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},wy=i,Ly=8589934592,Dy=4294967296,Bp="shared",Bh=function(m,_){var w=1;for(m>_&&(w=-1);Math.abs(_-m)>Dy;)m+=w*Ly;return m},Mh=function(m){var _,w;Mh.prototype.init.call(this),this.type_=m||Bp,this.push=function(T){if(T.type==="metadata"){this.trigger("data",T);return}this.type_!==Bp&&T.type!==this.type_||(w===void 0&&(w=T.dts),T.dts=Bh(T.dts,w),T.pts=Bh(T.pts,w),_=T.dts,this.trigger("data",T))},this.flush=function(){w=_,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){w=void 0,_=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};Mh.prototype=new wy;var Mp={TimestampRolloverStream:Mh,handleRollover:Bh},ky=(m,_,w)=>{if(!m)return-1;for(var T=w;T<m.length;T++)if(m[T]===_)return T;return-1},Iy={typedArrayIndexOf:ky},yc=Iy.typedArrayIndexOf,vc={Iso88591:0,Utf16:1,Utf16be:2,Utf8:3},Fp=function(m,_,w){var T,R="";for(T=_;T<w;T++)R+="%"+("00"+m[T].toString(16)).slice(-2);return R},Uu=function(m,_,w){return decodeURIComponent(Fp(m,_,w))},ju=function(m,_,w){return unescape(Fp(m,_,w))},$u=function(m){return m[0]<<21|m[1]<<14|m[2]<<7|m[3]},Vu={APIC:function(m){var _=1,w,T,R="-->";m.data[0]===vc.Utf8&&(w=yc(m.data,0,_),!(w<0)&&(m.mimeType=ju(m.data,_,w),_=w+1,m.pictureType=m.data[_],_++,T=yc(m.data,0,_),!(T<0)&&(m.description=Uu(m.data,_,T),_=T+1,m.mimeType===R?m.url=ju(m.data,_,m.data.length):m.pictureData=m.data.subarray(_,m.data.length))))},"T*":function(m){m.data[0]===vc.Utf8&&(m.value=Uu(m.data,1,m.data.length).replace(/\0*$/,""),m.values=m.value.split("\0"))},TXXX:function(m){var _;m.data[0]===vc.Utf8&&(_=yc(m.data,0,1),_!==-1&&(m.description=Uu(m.data,1,_),m.value=Uu(m.data,_+1,m.data.length).replace(/\0*$/,""),m.data=m.value))},"W*":function(m){m.url=ju(m.data,0,m.data.length).replace(/\0.*$/,"")},WXXX:function(m){var _;m.data[0]===vc.Utf8&&(_=yc(m.data,0,1),_!==-1&&(m.description=Uu(m.data,1,_),m.url=ju(m.data,_+1,m.data.length).replace(/\0.*$/,"")))},PRIV:function(m){var _;for(_=0;_<m.data.length;_++)if(m.data[_]===0){m.owner=ju(m.data,0,_);break}m.privateData=m.data.subarray(_+1),m.data=m.privateData}},Ry=function(m){var _,w,T=10,R=0,U=[];if(!(m.length<10||m[0]!=="I".charCodeAt(0)||m[1]!=="D".charCodeAt(0)||m[2]!=="3".charCodeAt(0))){R=$u(m.subarray(6,10)),R+=10;var he=m[5]&64;he&&(T+=4,T+=$u(m.subarray(10,14)),R-=$u(m.subarray(16,20)));do{if(_=$u(m.subarray(T+4,T+8)),_<1)break;w=String.fromCharCode(m[T],m[T+1],m[T+2],m[T+3]);var me={id:w,data:m.subarray(T+10,T+_+10)};me.key=me.id,Vu[me.id]?Vu[me.id](me):me.id[0]==="T"?Vu["T*"](me):me.id[0]==="W"&&Vu["W*"](me),U.push(me),T+=10,T+=_}while(T<R);return U}},Np={parseId3Frames:Ry,parseSyncSafeInteger:$u,frameParsers:Vu},Py=i,Oy=gc,Ha=Np,Ac;Ac=function(m){var _={descriptor:m&&m.descriptor},w=0,T=[],R=0,U;if(Ac.prototype.init.call(this),this.dispatchType=Oy.METADATA_STREAM_TYPE.toString(16),_.descriptor)for(U=0;U<_.descriptor.length;U++)this.dispatchType+=("00"+_.descriptor[U].toString(16)).slice(-2);this.push=function(he){var me,Ae,Ee,Ne,Je,kt;if(he.type==="timed-metadata"){if(he.dataAlignmentIndicator&&(R=0,T.length=0),T.length===0&&(he.data.length<10||he.data[0]!=="I".charCodeAt(0)||he.data[1]!=="D".charCodeAt(0)||he.data[2]!=="3".charCodeAt(0))){this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});return}if(T.push(he),R+=he.data.byteLength,T.length===1&&(w=Ha.parseSyncSafeInteger(he.data.subarray(6,10)),w+=10),!(R<w)){for(me={data:new Uint8Array(w),frames:[],pts:T[0].pts,dts:T[0].dts},Je=0;Je<w;)me.data.set(T[0].data.subarray(0,w-Je),Je),Je+=T[0].data.byteLength,R-=T[0].data.byteLength,T.shift();Ae=10,me.data[5]&64&&(Ae+=4,Ae+=Ha.parseSyncSafeInteger(me.data.subarray(10,14)),w-=Ha.parseSyncSafeInteger(me.data.subarray(16,20)));do{if(Ee=Ha.parseSyncSafeInteger(me.data.subarray(Ae+4,Ae+8)),Ee<1){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping remaining metadata parsing."});break}if(kt=String.fromCharCode(me.data[Ae],me.data[Ae+1],me.data[Ae+2],me.data[Ae+3]),Ne={id:kt,data:me.data.subarray(Ae+10,Ae+Ee+10)},Ne.key=Ne.id,Ha.frameParsers[Ne.id]?Ha.frameParsers[Ne.id](Ne):Ne.id[0]==="T"?Ha.frameParsers["T*"](Ne):Ne.id[0]==="W"&&Ha.frameParsers["W*"](Ne),Ne.owner==="com.apple.streaming.transportStreamTimestamp"){var lt=Ne.data,ei=(lt[3]&1)<<30|lt[4]<<22|lt[5]<<14|lt[6]<<6|lt[7]>>>2;ei*=4,ei+=lt[7]&3,Ne.timeStamp=ei,me.pts===void 0&&me.dts===void 0&&(me.pts=Ne.timeStamp,me.dts=Ne.timeStamp),this.trigger("timestamp",Ne)}me.frames.push(Ne),Ae+=10,Ae+=Ee}while(Ae<w);this.trigger("data",me)}}}},Ac.prototype=new Py;var By=Ac,Fh=i,Nh=Op,us=gc,My=Mp.TimestampRolloverStream,_c,Hu,bc,wl=188,Uh=71;_c=function(){var m=new Uint8Array(wl),_=0;_c.prototype.init.call(this),this.push=function(w){var T=0,R=wl,U;for(_?(U=new Uint8Array(w.byteLength+_),U.set(m.subarray(0,_)),U.set(w,_),_=0):U=w;R<U.byteLength;){if(U[T]===Uh&&U[R]===Uh){this.trigger("data",U.subarray(T,R)),T+=wl,R+=wl;continue}T++,R++}T<U.byteLength&&(m.set(U.subarray(T),0),_=U.byteLength-T)},this.flush=function(){_===wl&&m[0]===Uh&&(this.trigger("data",m),_=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){_=0,this.trigger("reset")}},_c.prototype=new Fh,Hu=function(){var m,_,w,T;Hu.prototype.init.call(this),T=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,m=function(R,U){var he=0;U.payloadUnitStartIndicator&&(he+=R[he]+1),U.type==="pat"?_(R.subarray(he),U):w(R.subarray(he),U)},_=function(R,U){U.section_number=R[7],U.last_section_number=R[8],T.pmtPid=(R[10]&31)<<8|R[11],U.pmtPid=T.pmtPid},w=function(R,U){var he,me,Ae,Ee;if(!!(R[5]&1)){for(T.programMapTable={video:null,audio:null,"timed-metadata":{}},he=(R[1]&15)<<8|R[2],me=3+he-4,Ae=(R[10]&15)<<8|R[11],Ee=12+Ae;Ee<me;){var Ne=R[Ee],Je=(R[Ee+1]&31)<<8|R[Ee+2];Ne===us.H264_STREAM_TYPE&&T.programMapTable.video===null?T.programMapTable.video=Je:Ne===us.ADTS_STREAM_TYPE&&T.programMapTable.audio===null?T.programMapTable.audio=Je:Ne===us.METADATA_STREAM_TYPE&&(T.programMapTable["timed-metadata"][Je]=Ne),Ee+=((R[Ee+3]&15)<<8|R[Ee+4])+5}U.programMapTable=T.programMapTable}},this.push=function(R){var U={},he=4;if(U.payloadUnitStartIndicator=!!(R[1]&64),U.pid=R[1]&31,U.pid<<=8,U.pid|=R[2],(R[3]&48)>>>4>1&&(he+=R[he]+1),U.pid===0)U.type="pat",m(R.subarray(he),U),this.trigger("data",U);else if(U.pid===this.pmtPid)for(U.type="pmt",m(R.subarray(he),U),this.trigger("data",U);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else this.programMapTable===void 0?this.packetsWaitingForPmt.push([R,he,U]):this.processPes_(R,he,U)},this.processPes_=function(R,U,he){he.pid===this.programMapTable.video?he.streamType=us.H264_STREAM_TYPE:he.pid===this.programMapTable.audio?he.streamType=us.ADTS_STREAM_TYPE:he.streamType=this.programMapTable["timed-metadata"][he.pid],he.type="pes",he.data=R.subarray(U),this.trigger("data",he)}},Hu.prototype=new Fh,Hu.STREAM_TYPES={h264:27,adts:15},bc=function(){var m=this,_=!1,w={data:[],size:0},T={data:[],size:0},R={data:[],size:0},U,he=function(Ae,Ee){var Ne;const Je=Ae[0]<<16|Ae[1]<<8|Ae[2];Ee.data=new Uint8Array,Je===1&&(Ee.packetLength=6+(Ae[4]<<8|Ae[5]),Ee.dataAlignmentIndicator=(Ae[6]&4)!=0,Ne=Ae[7],Ne&192&&(Ee.pts=(Ae[9]&14)<<27|(Ae[10]&255)<<20|(Ae[11]&254)<<12|(Ae[12]&255)<<5|(Ae[13]&254)>>>3,Ee.pts*=4,Ee.pts+=(Ae[13]&6)>>>1,Ee.dts=Ee.pts,Ne&64&&(Ee.dts=(Ae[14]&14)<<27|(Ae[15]&255)<<20|(Ae[16]&254)<<12|(Ae[17]&255)<<5|(Ae[18]&254)>>>3,Ee.dts*=4,Ee.dts+=(Ae[18]&6)>>>1)),Ee.data=Ae.subarray(9+Ae[8]))},me=function(Ae,Ee,Ne){var Je=new Uint8Array(Ae.size),kt={type:Ee},lt=0,ei=0,si=!1,En;if(!(!Ae.data.length||Ae.size<9)){for(kt.trackId=Ae.data[0].pid,lt=0;lt<Ae.data.length;lt++)En=Ae.data[lt],Je.set(En.data,ei),ei+=En.data.byteLength;he(Je,kt),si=Ee==="video"||kt.packetLength<=Ae.size,(Ne||si)&&(Ae.size=0,Ae.data.length=0),si&&m.trigger("data",kt)}};bc.prototype.init.call(this),this.push=function(Ae){({pat:function(){},pes:function(){var Ee,Ne;switch(Ae.streamType){case us.H264_STREAM_TYPE:Ee=w,Ne="video";break;case us.ADTS_STREAM_TYPE:Ee=T,Ne="audio";break;case us.METADATA_STREAM_TYPE:Ee=R,Ne="timed-metadata";break;default:return}Ae.payloadUnitStartIndicator&&me(Ee,Ne,!0),Ee.data.push(Ae),Ee.size+=Ae.data.byteLength},pmt:function(){var Ee={type:"metadata",tracks:[]};U=Ae.programMapTable,U.video!==null&&Ee.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+U.video,codec:"avc",type:"video"}),U.audio!==null&&Ee.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+U.audio,codec:"adts",type:"audio"}),_=!0,m.trigger("data",Ee)}})[Ae.type]()},this.reset=function(){w.size=0,w.data.length=0,T.size=0,T.data.length=0,this.trigger("reset")},this.flushStreams_=function(){me(w,"video"),me(T,"audio"),me(R,"timed-metadata")},this.flush=function(){if(!_&&U){var Ae={type:"metadata",tracks:[]};U.video!==null&&Ae.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+U.video,codec:"avc",type:"video"}),U.audio!==null&&Ae.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+U.audio,codec:"adts",type:"audio"}),m.trigger("data",Ae)}_=!1,this.flushStreams_(),this.trigger("done")}},bc.prototype=new Fh;var Up={PAT_PID:0,MP2T_PACKET_LENGTH:wl,TransportPacketStream:_c,TransportParseStream:Hu,ElementaryStream:bc,TimestampRolloverStream:My,CaptionStream:Nh.CaptionStream,Cea608Stream:Nh.Cea608Stream,Cea708Stream:Nh.Cea708Stream,MetadataStream:By};for(var jh in us)us.hasOwnProperty(jh)&&(Up[jh]=us[jh]);var Fy=Up,Ny=i,Uy=Ki.ONE_SECOND_IN_TS,xc,jp=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];xc=function(m){var _,w=0;xc.prototype.init.call(this),this.skipWarn_=function(T,R){this.trigger("log",{level:"warn",message:`adts skiping bytes ${T} to ${R} in frame ${w} outside syncword`})},this.push=function(T){var R=0,U,he,me,Ae,Ee;if(m||(w=0),T.type==="audio"){_&&_.length?(me=_,_=new Uint8Array(me.byteLength+T.data.byteLength),_.set(me),_.set(T.data,me.byteLength)):_=T.data;for(var Ne;R+7<_.length;){if(_[R]!==255||(_[R+1]&246)!=240){typeof Ne!="number"&&(Ne=R),R++;continue}if(typeof Ne=="number"&&(this.skipWarn_(Ne,R),Ne=null),he=(~_[R+1]&1)*2,U=(_[R+3]&3)<<11|_[R+4]<<3|(_[R+5]&224)>>5,Ae=((_[R+6]&3)+1)*1024,Ee=Ae*Uy/jp[(_[R+2]&60)>>>2],_.byteLength-R<U)break;this.trigger("data",{pts:T.pts+w*Ee,dts:T.dts+w*Ee,sampleCount:Ae,audioobjecttype:(_[R+2]>>>6&3)+1,channelcount:(_[R+2]&1)<<2|(_[R+3]&192)>>>6,samplerate:jp[(_[R+2]&60)>>>2],samplingfrequencyindex:(_[R+2]&60)>>>2,samplesize:16,data:_.subarray(R+7+he,R+U)}),w++,R+=U}typeof Ne=="number"&&(this.skipWarn_(Ne,R),Ne=null),_=_.subarray(R)}},this.flush=function(){w=0,this.trigger("done")},this.reset=function(){_=void 0,this.trigger("reset")},this.endTimeline=function(){_=void 0,this.trigger("endedtimeline")}},xc.prototype=new Ny;var jy=xc,$p;$p=function(m){var _=m.byteLength,w=0,T=0;this.length=function(){return 8*_},this.bitsAvailable=function(){return 8*_+T},this.loadWord=function(){var R=m.byteLength-_,U=new Uint8Array(4),he=Math.min(4,_);if(he===0)throw new Error("no bytes available");U.set(m.subarray(R,R+he)),w=new DataView(U.buffer).getUint32(0),T=he*8,_-=he},this.skipBits=function(R){var U;T>R?(w<<=R,T-=R):(R-=T,U=Math.floor(R/8),R-=U*8,_-=U,this.loadWord(),w<<=R,T-=R)},this.readBits=function(R){var U=Math.min(T,R),he=w>>>32-U;return T-=U,T>0?w<<=U:_>0&&this.loadWord(),U=R-U,U>0?he<<U|this.readBits(U):he},this.skipLeadingZeros=function(){var R;for(R=0;R<T;++R)if((w&2147483648>>>R)!=0)return w<<=R,T-=R,R;return this.loadWord(),R+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var R=this.skipLeadingZeros();return this.readBits(R+1)-1},this.readExpGolomb=function(){var R=this.readUnsignedExpGolomb();return 1&R?1+R>>>1:-1*(R>>>1)},this.readBoolean=function(){return this.readBits(1)===1},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};var $y=$p,Vp=i,Vy=$y,Ec,Gu,Hp;Gu=function(){var m=0,_,w;Gu.prototype.init.call(this),this.push=function(T){var R;w?(R=new Uint8Array(w.byteLength+T.data.byteLength),R.set(w),R.set(T.data,w.byteLength),w=R):w=T.data;for(var U=w.byteLength;m<U-3;m++)if(w[m+2]===1){_=m+5;break}for(;_<U;)switch(w[_]){case 0:if(w[_-1]!==0){_+=2;break}else if(w[_-2]!==0){_++;break}m+3!==_-2&&this.trigger("data",w.subarray(m+3,_-2));do _++;while(w[_]!==1&&_<U);m=_-2,_+=3;break;case 1:if(w[_-1]!==0||w[_-2]!==0){_+=3;break}this.trigger("data",w.subarray(m+3,_-2)),m=_-2,_+=3;break;default:_+=3;break}w=w.subarray(m),_-=m,m=0},this.reset=function(){w=null,m=0,this.trigger("reset")},this.flush=function(){w&&w.byteLength>3&&this.trigger("data",w.subarray(m+3)),w=null,m=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}},Gu.prototype=new Vp,Hp={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},Ec=function(){var m=new Gu,_,w,T,R,U,he,me;Ec.prototype.init.call(this),_=this,this.push=function(Ae){Ae.type==="video"&&(w=Ae.trackId,T=Ae.pts,R=Ae.dts,m.push(Ae))},m.on("data",function(Ae){var Ee={trackId:w,pts:T,dts:R,data:Ae,nalUnitTypeCode:Ae[0]&31};switch(Ee.nalUnitTypeCode){case 5:Ee.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:Ee.nalUnitType="sei_rbsp",Ee.escapedRBSP=U(Ae.subarray(1));break;case 7:Ee.nalUnitType="seq_parameter_set_rbsp",Ee.escapedRBSP=U(Ae.subarray(1)),Ee.config=he(Ee.escapedRBSP);break;case 8:Ee.nalUnitType="pic_parameter_set_rbsp";break;case 9:Ee.nalUnitType="access_unit_delimiter_rbsp";break}_.trigger("data",Ee)}),m.on("done",function(){_.trigger("done")}),m.on("partialdone",function(){_.trigger("partialdone")}),m.on("reset",function(){_.trigger("reset")}),m.on("endedtimeline",function(){_.trigger("endedtimeline")}),this.flush=function(){m.flush()},this.partialFlush=function(){m.partialFlush()},this.reset=function(){m.reset()},this.endTimeline=function(){m.endTimeline()},me=function(Ae,Ee){var Ne=8,Je=8,kt,lt;for(kt=0;kt<Ae;kt++)Je!==0&&(lt=Ee.readExpGolomb(),Je=(Ne+lt+256)%256),Ne=Je===0?Ne:Je},U=function(Ae){for(var Ee=Ae.byteLength,Ne=[],Je=1,kt,lt;Je<Ee-2;)Ae[Je]===0&&Ae[Je+1]===0&&Ae[Je+2]===3?(Ne.push(Je+2),Je+=2):Je++;if(Ne.length===0)return Ae;kt=Ee-Ne.length,lt=new Uint8Array(kt);var ei=0;for(Je=0;Je<kt;ei++,Je++)ei===Ne[0]&&(ei++,Ne.shift()),lt[Je]=Ae[ei];return lt},he=function(Ae){var Ee=0,Ne=0,Je=0,kt=0,lt,ei,si,En,Wr,Lo,y0,v0,A0,Qh,_0,pn=[1,1],b0,Do;if(lt=new Vy(Ae),ei=lt.readUnsignedByte(),En=lt.readUnsignedByte(),si=lt.readUnsignedByte(),lt.skipUnsignedExpGolomb(),Hp[ei]&&(Wr=lt.readUnsignedExpGolomb(),Wr===3&&lt.skipBits(1),lt.skipUnsignedExpGolomb(),lt.skipUnsignedExpGolomb(),lt.skipBits(1),lt.readBoolean()))for(_0=Wr!==3?8:12,Do=0;Do<_0;Do++)lt.readBoolean()&&(Do<6?me(16,lt):me(64,lt));if(lt.skipUnsignedExpGolomb(),Lo=lt.readUnsignedExpGolomb(),Lo===0)lt.readUnsignedExpGolomb();else if(Lo===1)for(lt.skipBits(1),lt.skipExpGolomb(),lt.skipExpGolomb(),y0=lt.readUnsignedExpGolomb(),Do=0;Do<y0;Do++)lt.skipExpGolomb();if(lt.skipUnsignedExpGolomb(),lt.skipBits(1),v0=lt.readUnsignedExpGolomb(),A0=lt.readUnsignedExpGolomb(),Qh=lt.readBits(1),Qh===0&&lt.skipBits(1),lt.skipBits(1),lt.readBoolean()&&(Ee=lt.readUnsignedExpGolomb(),Ne=lt.readUnsignedExpGolomb(),Je=lt.readUnsignedExpGolomb(),kt=lt.readUnsignedExpGolomb()),lt.readBoolean()&&lt.readBoolean()){switch(b0=lt.readUnsignedByte(),b0){case 1:pn=[1,1];break;case 2:pn=[12,11];break;case 3:pn=[10,11];break;case 4:pn=[16,11];break;case 5:pn=[40,33];break;case 6:pn=[24,11];break;case 7:pn=[20,11];break;case 8:pn=[32,11];break;case 9:pn=[80,33];break;case 10:pn=[18,11];break;case 11:pn=[15,11];break;case 12:pn=[64,33];break;case 13:pn=[160,99];break;case 14:pn=[4,3];break;case 15:pn=[3,2];break;case 16:pn=[2,1];break;case 255:{pn=[lt.readUnsignedByte()<<8|lt.readUnsignedByte(),lt.readUnsignedByte()<<8|lt.readUnsignedByte()];break}}pn&&pn[0]/pn[1]}return{profileIdc:ei,levelIdc:si,profileCompatibility:En,width:(v0+1)*16-Ee*2-Ne*2,height:(2-Qh)*(A0+1)*16-Je*2-kt*2,sarRatio:pn}}},Ec.prototype=new Vp;var Hy={H264Stream:Ec,NalByteStream:Gu},Gy=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],Gp=function(m,_){var w=m[_+6]<<21|m[_+7]<<14|m[_+8]<<7|m[_+9],T=m[_+5],R=(T&16)>>4;return w=w>=0?w:0,R?w+20:w+10},qp=function(m,_){return m.length-_<10||m[_]!=="I".charCodeAt(0)||m[_+1]!=="D".charCodeAt(0)||m[_+2]!=="3".charCodeAt(0)?_:(_+=Gp(m,_),qp(m,_))},qy=function(m){var _=qp(m,0);return m.length>=_+2&&(m[_]&255)==255&&(m[_+1]&240)==240&&(m[_+1]&22)==16},zp=function(m){return m[0]<<21|m[1]<<14|m[2]<<7|m[3]},zy=function(m,_,w){var T,R="";for(T=_;T<w;T++)R+="%"+("00"+m[T].toString(16)).slice(-2);return R},Wy=function(m,_,w){return unescape(zy(m,_,w))},Ky=function(m,_){var w=(m[_+5]&224)>>5,T=m[_+4]<<3,R=m[_+3]&3<<11;return R|T|w},Yy=function(m,_){return m[_]==="I".charCodeAt(0)&&m[_+1]==="D".charCodeAt(0)&&m[_+2]==="3".charCodeAt(0)?"timed-metadata":m[_]&!0&&(m[_+1]&240)==240?"audio":null},Xy=function(m){for(var _=0;_+5<m.length;){if(m[_]!==255||(m[_+1]&246)!=240){_++;continue}return Gy[(m[_+2]&60)>>>2]}return null},Qy=function(m){var _,w,T,R;_=10,m[5]&64&&(_+=4,_+=zp(m.subarray(10,14)));do{if(w=zp(m.subarray(_+4,_+8)),w<1)return null;if(R=String.fromCharCode(m[_],m[_+1],m[_+2],m[_+3]),R==="PRIV"){T=m.subarray(_+10,_+w+10);for(var U=0;U<T.byteLength;U++)if(T[U]===0){var he=Wy(T,0,U);if(he==="com.apple.streaming.transportStreamTimestamp"){var me=T.subarray(U+1),Ae=(me[3]&1)<<30|me[4]<<22|me[5]<<14|me[6]<<6|me[7]>>>2;return Ae*=4,Ae+=me[7]&3,Ae}break}}_+=10,_+=w}while(_<m.byteLength);return null},$h={isLikelyAacData:qy,parseId3TagSize:Gp,parseAdtsSize:Ky,parseType:Yy,parseSampleRate:Xy,parseAacTimestamp:Qy},Jy=i,Wp=$h,Tc;Tc=function(){var m=new Uint8Array,_=0;Tc.prototype.init.call(this),this.setTimestamp=function(w){_=w},this.push=function(w){var T=0,R=0,U,he,me,Ae;for(m.length?(Ae=m.length,m=new Uint8Array(w.byteLength+Ae),m.set(m.subarray(0,Ae)),m.set(w,Ae)):m=w;m.length-R>=3;){if(m[R]==="I".charCodeAt(0)&&m[R+1]==="D".charCodeAt(0)&&m[R+2]==="3".charCodeAt(0)){if(m.length-R<10||(T=Wp.parseId3TagSize(m,R),R+T>m.length))break;he={type:"timed-metadata",data:m.subarray(R,R+T)},this.trigger("data",he),R+=T;continue}else if((m[R]&255)==255&&(m[R+1]&240)==240){if(m.length-R<7||(T=Wp.parseAdtsSize(m,R),R+T>m.length))break;me={type:"audio",data:m.subarray(R,R+T),pts:_,dts:_},this.trigger("data",me),R+=T;continue}R++}U=m.length-R,U>0?m=m.subarray(R):m=new Uint8Array},this.reset=function(){m=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){m=new Uint8Array,this.trigger("endedtimeline")}},Tc.prototype=new Jy;var Zy=Tc,ev=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],tv=ev,iv=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],nv=iv,Sc=i,qu=Kg,zu=ny,Cc=hy,ds=yy,da=Fy,wc=Ki,Kp=jy,rv=Hy.H264Stream,sv=Zy,av=$h.isLikelyAacData,ov=Ki.ONE_SECOND_IN_TS,Vh=tv,Hh=nv,Wu,Ll,Lc,Co,lv=function(m,_){_.stream=m,this.trigger("log",_)},Yp=function(m,_){for(var w=Object.keys(_),T=0;T<w.length;T++){var R=w[T];R==="headOfPipeline"||!_[R].on||_[R].on("log",lv.bind(m,R))}},Xp=function(m,_){var w;if(m.length!==_.length)return!1;for(w=0;w<m.length;w++)if(m[w]!==_[w])return!1;return!0},Gh=function(m,_,w,T,R,U){var he=w-_,me=T-_,Ae=R-w;return{start:{dts:m,pts:m+he},end:{dts:m+me,pts:m+Ae},prependedContentDuration:U,baseMediaDecodeTime:m}};Ll=function(m,_){var w=[],T,R=0,U=0,he=Infinity;_=_||{},T=_.firstSequenceNumber||0,Ll.prototype.init.call(this),this.push=function(me){ds.collectDtsInfo(m,me),m&&Vh.forEach(function(Ae){m[Ae]=me[Ae]}),w.push(me)},this.setEarliestDts=function(me){R=me},this.setVideoBaseMediaDecodeTime=function(me){he=me},this.setAudioAppendStart=function(me){U=me},this.flush=function(){var me,Ae,Ee,Ne,Je,kt,lt;if(w.length===0){this.trigger("done","AudioSegmentStream");return}me=Cc.trimAdtsFramesByEarliestDts(w,m,R),m.baseMediaDecodeTime=ds.calculateTrackBaseMediaDecodeTime(m,_.keepOriginalTimestamps),lt=Cc.prefixWithSilence(m,me,U,he),m.samples=Cc.generateSampleTable(me),Ee=qu.mdat(Cc.concatenateFrameData(me)),w=[],Ae=qu.moof(T,[m]),Ne=new Uint8Array(Ae.byteLength+Ee.byteLength),T++,Ne.set(Ae),Ne.set(Ee,Ae.byteLength),ds.clearDtsInfo(m),Je=Math.ceil(ov*1024/m.samplerate),me.length&&(kt=me.length*Je,this.trigger("segmentTimingInfo",Gh(wc.audioTsToVideoTs(m.baseMediaDecodeTime,m.samplerate),me[0].dts,me[0].pts,me[0].dts+kt,me[0].pts+kt,lt||0)),this.trigger("timingInfo",{start:me[0].pts,end:me[0].pts+kt})),this.trigger("data",{track:m,boxes:Ne}),this.trigger("done","AudioSegmentStream")},this.reset=function(){ds.clearDtsInfo(m),w=[],this.trigger("reset")}},Ll.prototype=new Sc,Wu=function(m,_){var w,T=[],R=[],U,he;_=_||{},w=_.firstSequenceNumber||0,Wu.prototype.init.call(this),delete m.minPTS,this.gopCache_=[],this.push=function(me){ds.collectDtsInfo(m,me),me.nalUnitType==="seq_parameter_set_rbsp"&&!U&&(U=me.config,m.sps=[me.data],Hh.forEach(function(Ae){m[Ae]=U[Ae]},this)),me.nalUnitType==="pic_parameter_set_rbsp"&&!he&&(he=me.data,m.pps=[me.data]),T.push(me)},this.flush=function(){for(var me,Ae,Ee,Ne,Je,kt,lt=0,ei,si;T.length&&T[0].nalUnitType!=="access_unit_delimiter_rbsp";)T.shift();if(T.length===0){this.resetStream_(),this.trigger("done","VideoSegmentStream");return}if(me=zu.groupNalsIntoFrames(T),Ee=zu.groupFramesIntoGops(me),Ee[0][0].keyFrame||(Ae=this.getGopForFusion_(T[0],m),Ae?(lt=Ae.duration,Ee.unshift(Ae),Ee.byteLength+=Ae.byteLength,Ee.nalCount+=Ae.nalCount,Ee.pts=Ae.pts,Ee.dts=Ae.dts,Ee.duration+=Ae.duration):Ee=zu.extendFirstKeyFrame(Ee)),R.length){var En;if(_.alignGopsAtEnd?En=this.alignGopsAtEnd_(Ee):En=this.alignGopsAtStart_(Ee),!En){this.gopCache_.unshift({gop:Ee.pop(),pps:m.pps,sps:m.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),T=[],this.resetStream_(),this.trigger("done","VideoSegmentStream");return}ds.clearDtsInfo(m),Ee=En}ds.collectDtsInfo(m,Ee),m.samples=zu.generateSampleTable(Ee),Je=qu.mdat(zu.concatenateNalData(Ee)),m.baseMediaDecodeTime=ds.calculateTrackBaseMediaDecodeTime(m,_.keepOriginalTimestamps),this.trigger("processedGopsInfo",Ee.map(function(Wr){return{pts:Wr.pts,dts:Wr.dts,byteLength:Wr.byteLength}})),ei=Ee[0],si=Ee[Ee.length-1],this.trigger("segmentTimingInfo",Gh(m.baseMediaDecodeTime,ei.dts,ei.pts,si.dts+si.duration,si.pts+si.duration,lt)),this.trigger("timingInfo",{start:Ee[0].pts,end:Ee[Ee.length-1].pts+Ee[Ee.length-1].duration}),this.gopCache_.unshift({gop:Ee.pop(),pps:m.pps,sps:m.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),T=[],this.trigger("baseMediaDecodeTime",m.baseMediaDecodeTime),this.trigger("timelineStartInfo",m.timelineStartInfo),Ne=qu.moof(w,[m]),kt=new Uint8Array(Ne.byteLength+Je.byteLength),w++,kt.set(Ne),kt.set(Je,Ne.byteLength),this.trigger("data",{track:m,boxes:kt}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),T=[],this.gopCache_.length=0,R.length=0,this.trigger("reset")},this.resetStream_=function(){ds.clearDtsInfo(m),U=void 0,he=void 0},this.getGopForFusion_=function(me){var Ae=45e3,Ee=1e4,Ne=Infinity,Je,kt,lt,ei,si;for(si=0;si<this.gopCache_.length;si++)ei=this.gopCache_[si],lt=ei.gop,!(!(m.pps&&Xp(m.pps[0],ei.pps[0]))||!(m.sps&&Xp(m.sps[0],ei.sps[0])))&&(lt.dts<m.timelineStartInfo.dts||(Je=me.dts-lt.dts-lt.duration,Je>=-Ee&&Je<=Ae&&(!kt||Ne>Je)&&(kt=ei,Ne=Je)));return kt?kt.gop:null},this.alignGopsAtStart_=function(me){var Ae,Ee,Ne,Je,kt,lt,ei,si;for(kt=me.byteLength,lt=me.nalCount,ei=me.duration,Ae=Ee=0;Ae<R.length&&Ee<me.length&&(Ne=R[Ae],Je=me[Ee],Ne.pts!==Je.pts);){if(Je.pts>Ne.pts){Ae++;continue}Ee++,kt-=Je.byteLength,lt-=Je.nalCount,ei-=Je.duration}return Ee===0?me:Ee===me.length?null:(si=me.slice(Ee),si.byteLength=kt,si.duration=ei,si.nalCount=lt,si.pts=si[0].pts,si.dts=si[0].dts,si)},this.alignGopsAtEnd_=function(me){var Ae,Ee,Ne,Je,kt,lt;for(Ae=R.length-1,Ee=me.length-1,kt=null,lt=!1;Ae>=0&&Ee>=0;){if(Ne=R[Ae],Je=me[Ee],Ne.pts===Je.pts){lt=!0;break}if(Ne.pts>Je.pts){Ae--;continue}Ae===R.length-1&&(kt=Ee),Ee--}if(!lt&&kt===null)return null;var ei;if(lt?ei=Ee:ei=kt,ei===0)return me;var si=me.slice(ei),En=si.reduce(function(Wr,Lo){return Wr.byteLength+=Lo.byteLength,Wr.duration+=Lo.duration,Wr.nalCount+=Lo.nalCount,Wr},{byteLength:0,duration:0,nalCount:0});return si.byteLength=En.byteLength,si.duration=En.duration,si.nalCount=En.nalCount,si.pts=si[0].pts,si.dts=si[0].dts,si},this.alignGopsWith=function(me){R=me}},Wu.prototype=new Sc,Co=function(m,_){this.numberOfTracks=0,this.metadataStream=_,m=m||{},typeof m.remux!="undefined"?this.remuxTracks=!!m.remux:this.remuxTracks=!0,typeof m.keepOriginalTimestamps=="boolean"?this.keepOriginalTimestamps=m.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,Co.prototype.init.call(this),this.push=function(w){if(w.content||w.text)return this.pendingCaptions.push(w);if(w.frames)return this.pendingMetadata.push(w);this.pendingTracks.push(w.track),this.pendingBytes+=w.boxes.byteLength,w.track.type==="video"&&(this.videoTrack=w.track,this.pendingBoxes.push(w.boxes)),w.track.type==="audio"&&(this.audioTrack=w.track,this.pendingBoxes.unshift(w.boxes))}},Co.prototype=new Sc,Co.prototype.flush=function(m){var _=0,w={captions:[],captionStreams:{},metadata:[],info:{}},T,R,U,he=0,me;if(this.pendingTracks.length<this.numberOfTracks){if(m!=="VideoSegmentStream"&&m!=="AudioSegmentStream")return;if(this.remuxTracks)return;if(this.pendingTracks.length===0){this.emittedTracks++,this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0);return}}if(this.videoTrack?(he=this.videoTrack.timelineStartInfo.pts,Hh.forEach(function(Ae){w.info[Ae]=this.videoTrack[Ae]},this)):this.audioTrack&&(he=this.audioTrack.timelineStartInfo.pts,Vh.forEach(function(Ae){w.info[Ae]=this.audioTrack[Ae]},this)),this.videoTrack||this.audioTrack){for(this.pendingTracks.length===1?w.type=this.pendingTracks[0].type:w.type="combined",this.emittedTracks+=this.pendingTracks.length,U=qu.initSegment(this.pendingTracks),w.initSegment=new Uint8Array(U.byteLength),w.initSegment.set(U),w.data=new Uint8Array(this.pendingBytes),me=0;me<this.pendingBoxes.length;me++)w.data.set(this.pendingBoxes[me],_),_+=this.pendingBoxes[me].byteLength;for(me=0;me<this.pendingCaptions.length;me++)T=this.pendingCaptions[me],T.startTime=wc.metadataTsToSeconds(T.startPts,he,this.keepOriginalTimestamps),T.endTime=wc.metadataTsToSeconds(T.endPts,he,this.keepOriginalTimestamps),w.captionStreams[T.stream]=!0,w.captions.push(T);for(me=0;me<this.pendingMetadata.length;me++)R=this.pendingMetadata[me],R.cueTime=wc.metadataTsToSeconds(R.pts,he,this.keepOriginalTimestamps),w.metadata.push(R);for(w.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",w),me=0;me<w.captions.length;me++)T=w.captions[me],this.trigger("caption",T);for(me=0;me<w.metadata.length;me++)R=w.metadata[me],this.trigger("id3Frame",R)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},Co.prototype.setRemux=function(m){this.remuxTracks=m},Lc=function(m){var _=this,w=!0,T,R;Lc.prototype.init.call(this),m=m||{},this.baseMediaDecodeTime=m.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var U={};this.transmuxPipeline_=U,U.type="aac",U.metadataStream=new da.MetadataStream,U.aacStream=new sv,U.audioTimestampRolloverStream=new da.TimestampRolloverStream("audio"),U.timedMetadataTimestampRolloverStream=new da.TimestampRolloverStream("timed-metadata"),U.adtsStream=new Kp,U.coalesceStream=new Co(m,U.metadataStream),U.headOfPipeline=U.aacStream,U.aacStream.pipe(U.audioTimestampRolloverStream).pipe(U.adtsStream),U.aacStream.pipe(U.timedMetadataTimestampRolloverStream).pipe(U.metadataStream).pipe(U.coalesceStream),U.metadataStream.on("timestamp",function(he){U.aacStream.setTimestamp(he.timeStamp)}),U.aacStream.on("data",function(he){he.type!=="timed-metadata"&&he.type!=="audio"||U.audioSegmentStream||(R=R||{timelineStartInfo:{baseMediaDecodeTime:_.baseMediaDecodeTime},codec:"adts",type:"audio"},U.coalesceStream.numberOfTracks++,U.audioSegmentStream=new Ll(R,m),U.audioSegmentStream.on("log",_.getLogTrigger_("audioSegmentStream")),U.audioSegmentStream.on("timingInfo",_.trigger.bind(_,"audioTimingInfo")),U.adtsStream.pipe(U.audioSegmentStream).pipe(U.coalesceStream),_.trigger("trackinfo",{hasAudio:!!R,hasVideo:!!T}))}),U.coalesceStream.on("data",this.trigger.bind(this,"data")),U.coalesceStream.on("done",this.trigger.bind(this,"done")),Yp(this,U)},this.setupTsPipeline=function(){var U={};this.transmuxPipeline_=U,U.type="ts",U.metadataStream=new da.MetadataStream,U.packetStream=new da.TransportPacketStream,U.parseStream=new da.TransportParseStream,U.elementaryStream=new da.ElementaryStream,U.timestampRolloverStream=new da.TimestampRolloverStream,U.adtsStream=new Kp,U.h264Stream=new rv,U.captionStream=new da.CaptionStream(m),U.coalesceStream=new Co(m,U.metadataStream),U.headOfPipeline=U.packetStream,U.packetStream.pipe(U.parseStream).pipe(U.elementaryStream).pipe(U.timestampRolloverStream),U.timestampRolloverStream.pipe(U.h264Stream),U.timestampRolloverStream.pipe(U.adtsStream),U.timestampRolloverStream.pipe(U.metadataStream).pipe(U.coalesceStream),U.h264Stream.pipe(U.captionStream).pipe(U.coalesceStream),U.elementaryStream.on("data",function(he){var me;if(he.type==="metadata"){for(me=he.tracks.length;me--;)!T&&he.tracks[me].type==="video"?(T=he.tracks[me],T.timelineStartInfo.baseMediaDecodeTime=_.baseMediaDecodeTime):!R&&he.tracks[me].type==="audio"&&(R=he.tracks[me],R.timelineStartInfo.baseMediaDecodeTime=_.baseMediaDecodeTime);T&&!U.videoSegmentStream&&(U.coalesceStream.numberOfTracks++,U.videoSegmentStream=new Wu(T,m),U.videoSegmentStream.on("log",_.getLogTrigger_("videoSegmentStream")),U.videoSegmentStream.on("timelineStartInfo",function(Ae){R&&!m.keepOriginalTimestamps&&(R.timelineStartInfo=Ae,U.audioSegmentStream.setEarliestDts(Ae.dts-_.baseMediaDecodeTime))}),U.videoSegmentStream.on("processedGopsInfo",_.trigger.bind(_,"gopInfo")),U.videoSegmentStream.on("segmentTimingInfo",_.trigger.bind(_,"videoSegmentTimingInfo")),U.videoSegmentStream.on("baseMediaDecodeTime",function(Ae){R&&U.audioSegmentStream.setVideoBaseMediaDecodeTime(Ae)}),U.videoSegmentStream.on("timingInfo",_.trigger.bind(_,"videoTimingInfo")),U.h264Stream.pipe(U.videoSegmentStream).pipe(U.coalesceStream)),R&&!U.audioSegmentStream&&(U.coalesceStream.numberOfTracks++,U.audioSegmentStream=new Ll(R,m),U.audioSegmentStream.on("log",_.getLogTrigger_("audioSegmentStream")),U.audioSegmentStream.on("timingInfo",_.trigger.bind(_,"audioTimingInfo")),U.audioSegmentStream.on("segmentTimingInfo",_.trigger.bind(_,"audioSegmentTimingInfo")),U.adtsStream.pipe(U.audioSegmentStream).pipe(U.coalesceStream)),_.trigger("trackinfo",{hasAudio:!!R,hasVideo:!!T})}}),U.coalesceStream.on("data",this.trigger.bind(this,"data")),U.coalesceStream.on("id3Frame",function(he){he.dispatchType=U.metadataStream.dispatchType,_.trigger("id3Frame",he)}),U.coalesceStream.on("caption",this.trigger.bind(this,"caption")),U.coalesceStream.on("done",this.trigger.bind(this,"done")),Yp(this,U)},this.setBaseMediaDecodeTime=function(U){var he=this.transmuxPipeline_;m.keepOriginalTimestamps||(this.baseMediaDecodeTime=U),R&&(R.timelineStartInfo.dts=void 0,R.timelineStartInfo.pts=void 0,ds.clearDtsInfo(R),he.audioTimestampRolloverStream&&he.audioTimestampRolloverStream.discontinuity()),T&&(he.videoSegmentStream&&(he.videoSegmentStream.gopCache_=[]),T.timelineStartInfo.dts=void 0,T.timelineStartInfo.pts=void 0,ds.clearDtsInfo(T),he.captionStream.reset()),he.timestampRolloverStream&&he.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(U){R&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(U)},this.setRemux=function(U){var he=this.transmuxPipeline_;m.remux=U,he&&he.coalesceStream&&he.coalesceStream.setRemux(U)},this.alignGopsWith=function(U){T&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(U)},this.getLogTrigger_=function(U){var he=this;return function(me){me.stream=U,he.trigger("log",me)}},this.push=function(U){if(w){var he=av(U);he&&this.transmuxPipeline_.type!=="aac"?this.setupAacPipeline():!he&&this.transmuxPipeline_.type!=="ts"&&this.setupTsPipeline(),w=!1}this.transmuxPipeline_.headOfPipeline.push(U)},this.flush=function(){w=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}},Lc.prototype=new Sc;var uv={Transmuxer:Lc,VideoSegmentStream:Wu,AudioSegmentStream:Ll,AUDIO_PROPERTIES:Vh,VIDEO_PROPERTIES:Hh,generateSegmentTimingInfo:Gh},dv=function(m){return m>>>0},cv=function(m){return("00"+m.toString(16)).slice(-2)},Dc={toUnsigned:dv,toHexString:cv},hv=function(m){var _="";return _+=String.fromCharCode(m[0]),_+=String.fromCharCode(m[1]),_+=String.fromCharCode(m[2]),_+=String.fromCharCode(m[3]),_},Qp=hv,fv=Dc.toUnsigned,pv=Qp,Jp=function(m,_){var w=[],T,R,U,he,me;if(!_.length)return null;for(T=0;T<m.byteLength;)R=fv(m[T]<<24|m[T+1]<<16|m[T+2]<<8|m[T+3]),U=pv(m.subarray(T+4,T+8)),he=R>1?T+R:m.byteLength,U===_[0]&&(_.length===1?w.push(m.subarray(T+8,he)):(me=Jp(m.subarray(T+8,he),_.slice(1)),me.length&&(w=w.concat(me)))),T=he;return w},Zp=Jp,mv=Dc.toUnsigned,gv=c.getUint64,yv=function(m){var _={version:m[0],flags:new Uint8Array(m.subarray(1,4))};return _.version===1?_.baseMediaDecodeTime=gv(m.subarray(4)):_.baseMediaDecodeTime=mv(m[4]<<24|m[5]<<16|m[6]<<8|m[7]),_},e0=yv,vv=function(m){return{isLeading:(m[0]&12)>>>2,dependsOn:m[0]&3,isDependedOn:(m[1]&192)>>>6,hasRedundancy:(m[1]&48)>>>4,paddingValue:(m[1]&14)>>>1,isNonSyncSample:m[1]&1,degradationPriority:m[2]<<8|m[3]}},Av=vv,t0=Av,_v=function(m){var _={version:m[0],flags:new Uint8Array(m.subarray(1,4)),samples:[]},w=new DataView(m.buffer,m.byteOffset,m.byteLength),T=_.flags[2]&1,R=_.flags[2]&4,U=_.flags[1]&1,he=_.flags[1]&2,me=_.flags[1]&4,Ae=_.flags[1]&8,Ee=w.getUint32(4),Ne=8,Je;for(T&&(_.dataOffset=w.getInt32(Ne),Ne+=4),R&&Ee&&(Je={flags:t0(m.subarray(Ne,Ne+4))},Ne+=4,U&&(Je.duration=w.getUint32(Ne),Ne+=4),he&&(Je.size=w.getUint32(Ne),Ne+=4),Ae&&(_.version===1?Je.compositionTimeOffset=w.getInt32(Ne):Je.compositionTimeOffset=w.getUint32(Ne),Ne+=4),_.samples.push(Je),Ee--);Ee--;)Je={},U&&(Je.duration=w.getUint32(Ne),Ne+=4),he&&(Je.size=w.getUint32(Ne),Ne+=4),me&&(Je.flags=t0(m.subarray(Ne,Ne+4)),Ne+=4),Ae&&(_.version===1?Je.compositionTimeOffset=w.getInt32(Ne):Je.compositionTimeOffset=w.getUint32(Ne),Ne+=4),_.samples.push(Je);return _},i0=_v,bv=function(m){var _=new DataView(m.buffer,m.byteOffset,m.byteLength),w={version:m[0],flags:new Uint8Array(m.subarray(1,4)),trackId:_.getUint32(4)},T=w.flags[2]&1,R=w.flags[2]&2,U=w.flags[2]&8,he=w.flags[2]&16,me=w.flags[2]&32,Ae=w.flags[0]&65536,Ee=w.flags[0]&131072,Ne;return Ne=8,T&&(Ne+=4,w.baseDataOffset=_.getUint32(12),Ne+=4),R&&(w.sampleDescriptionIndex=_.getUint32(Ne),Ne+=4),U&&(w.defaultSampleDuration=_.getUint32(Ne),Ne+=4),he&&(w.defaultSampleSize=_.getUint32(Ne),Ne+=4),me&&(w.defaultSampleFlags=_.getUint32(Ne)),Ae&&(w.durationIsEmpty=!0),!T&&Ee&&(w.baseDataOffsetIsMoof=!0),w},n0=bv,Ku;typeof window!="undefined"?Ku=window:typeof s!="undefined"?Ku=s:typeof self!="undefined"?Ku=self:Ku={};var r0=Ku,xv=Pp.discardEmulationPreventionBytes,Ev=Op.CaptionStream,Yu=Zp,Tv=e0,Sv=i0,Cv=n0,s0=r0,wv=function(m,_){for(var w=m,T=0;T<_.length;T++){var R=_[T];if(w<R.size)return R;w-=R.size}return null},Lv=function(m,_,w){var T=new DataView(m.buffer,m.byteOffset,m.byteLength),R={logs:[],seiNals:[]},U,he,me,Ae;for(he=0;he+4<m.length;he+=me)if(me=T.getUint32(he),he+=4,!(me<=0))switch(m[he]&31){case 6:var Ee=m.subarray(he+1,he+1+me),Ne=wv(he,_);if(U={nalUnitType:"sei_rbsp",size:me,data:Ee,escapedRBSP:xv(Ee),trackId:w},Ne)U.pts=Ne.pts,U.dts=Ne.dts,Ae=Ne;else if(Ae)U.pts=Ae.pts,U.dts=Ae.dts;else{R.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+he+" for trackId "+w+". See mux.js#223."});break}R.seiNals.push(U);break}return R},Dv=function(m,_,w){var T=_,R=w.defaultSampleDuration||0,U=w.defaultSampleSize||0,he=w.trackId,me=[];return m.forEach(function(Ae){var Ee=Sv(Ae),Ne=Ee.samples;Ne.forEach(function(Je){Je.duration===void 0&&(Je.duration=R),Je.size===void 0&&(Je.size=U),Je.trackId=he,Je.dts=T,Je.compositionTimeOffset===void 0&&(Je.compositionTimeOffset=0),typeof T=="bigint"?(Je.pts=T+s0.BigInt(Je.compositionTimeOffset),T+=s0.BigInt(Je.duration)):(Je.pts=T+Je.compositionTimeOffset,T+=Je.duration)}),me=me.concat(Ne)}),me},kv=function(m,_){var w=Yu(m,["moof","traf"]),T=Yu(m,["mdat"]),R={},U=[];return T.forEach(function(he,me){var Ae=w[me];U.push({mdat:he,traf:Ae})}),U.forEach(function(he){var me=he.mdat,Ae=he.traf,Ee=Yu(Ae,["tfhd"]),Ne=Cv(Ee[0]),Je=Ne.trackId,kt=Yu(Ae,["tfdt"]),lt=kt.length>0?Tv(kt[0]).baseMediaDecodeTime:0,ei=Yu(Ae,["trun"]),si,En;_===Je&&ei.length>0&&(si=Dv(ei,lt,Ne),En=Lv(me,si,Je),R[Je]||(R[Je]={seiNals:[],logs:[]}),R[Je].seiNals=R[Je].seiNals.concat(En.seiNals),R[Je].logs=R[Je].logs.concat(En.logs))}),R},Iv=function(m,_,w){var T;if(_===null)return null;T=kv(m,_);var R=T[_]||{};return{seiNals:R.seiNals,logs:R.logs,timescale:w}},Rv=function(){var m=!1,_,w,T,R,U,he;this.isInitialized=function(){return m},this.init=function(me){_=new Ev,m=!0,he=me?me.isPartial:!1,_.on("data",function(Ae){Ae.startTime=Ae.startPts/R,Ae.endTime=Ae.endPts/R,U.captions.push(Ae),U.captionStreams[Ae.stream]=!0}),_.on("log",function(Ae){U.logs.push(Ae)})},this.isNewInit=function(me,Ae){return me&&me.length===0||Ae&&typeof Ae=="object"&&Object.keys(Ae).length===0?!1:T!==me[0]||R!==Ae[T]},this.parse=function(me,Ae,Ee){var Ne;if(this.isInitialized()){if(!Ae||!Ee)return null;if(this.isNewInit(Ae,Ee))T=Ae[0],R=Ee[T];else if(T===null||!R)return w.push(me),null}else return null;for(;w.length>0;){var Je=w.shift();this.parse(Je,Ae,Ee)}return Ne=Iv(me,T,R),Ne&&Ne.logs&&(U.logs=U.logs.concat(Ne.logs)),Ne===null||!Ne.seiNals?U.logs.length?{logs:U.logs,captions:[],captionStreams:[]}:null:(this.pushNals(Ne.seiNals),this.flushStream(),U)},this.pushNals=function(me){if(!this.isInitialized()||!me||me.length===0)return null;me.forEach(function(Ae){_.push(Ae)})},this.flushStream=function(){if(!this.isInitialized())return null;he?_.partialFlush():_.flush()},this.clearParsedCaptions=function(){U.captions=[],U.captionStreams={},U.logs=[]},this.resetCaptionStream=function(){if(!this.isInitialized())return null;_.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){w=[],T=null,R=null,U?this.clearParsedCaptions():U={captions:[],captionStreams:{},logs:[]},this.resetCaptionStream()},this.reset()},Pv=Rv,Ov=function(m){for(var _=0,w=String.fromCharCode(m[_]),T="";w!=="\0";)T+=w,_++,w=String.fromCharCode(m[_]);return T+=w,T},Bv={uint8ToCString:Ov},kc=Bv.uint8ToCString,Mv=c.getUint64,Fv=function(m){var _=4,w=m[0],T,R,U,he,me,Ae,Ee,Ne;if(w===0){T=kc(m.subarray(_)),_+=T.length,R=kc(m.subarray(_)),_+=R.length;var Je=new DataView(m.buffer);U=Je.getUint32(_),_+=4,me=Je.getUint32(_),_+=4,Ae=Je.getUint32(_),_+=4,Ee=Je.getUint32(_),_+=4}else if(w===1){var Je=new DataView(m.buffer);U=Je.getUint32(_),_+=4,he=Mv(m.subarray(_)),_+=8,Ae=Je.getUint32(_),_+=4,Ee=Je.getUint32(_),_+=4,T=kc(m.subarray(_)),_+=T.length,R=kc(m.subarray(_)),_+=R.length}Ne=new Uint8Array(m.subarray(_,m.byteLength));var kt={scheme_id_uri:T,value:R,timescale:U||1,presentation_time:he,presentation_time_delta:me,event_duration:Ae,id:Ee,message_data:Ne};return Uv(w,kt)?kt:void 0},Nv=function(m,_,w,T){return m||m===0?m/_:T+w/_},Uv=function(m,_){var w=_.scheme_id_uri!=="\0",T=m===0&&a0(_.presentation_time_delta)&&w,R=m===1&&a0(_.presentation_time)&&w;return!(m>1)&&T||R},a0=function(m){return m!==void 0||m!==null},jv={parseEmsgBox:Fv,scaleTime:Nv},Ic=Dc.toUnsigned,Xu=Dc.toHexString,fn=Zp,Dl=Qp,qh=jv,$v=n0,Vv=i0,Hv=e0,Gv=c.getUint64,o0,l0,u0,d0,c0,zh,h0,Wh=r0,qv=Np.parseId3Frames;o0=function(m){var _={},w=fn(m,["moov","trak"]);return w.reduce(function(T,R){var U,he,me,Ae,Ee;return U=fn(R,["tkhd"])[0],!U||(he=U[0],me=he===0?12:20,Ae=Ic(U[me]<<24|U[me+1]<<16|U[me+2]<<8|U[me+3]),Ee=fn(R,["mdia","mdhd"])[0],!Ee)?null:(he=Ee[0],me=he===0?12:20,T[Ae]=Ic(Ee[me]<<24|Ee[me+1]<<16|Ee[me+2]<<8|Ee[me+3]),T)},_)},l0=function(m,_){var w;w=fn(_,["moof","traf"]);var T=w.reduce(function(R,U){var he=fn(U,["tfhd"])[0],me=Ic(he[4]<<24|he[5]<<16|he[6]<<8|he[7]),Ae=m[me]||9e4,Ee=fn(U,["tfdt"])[0],Ne=new DataView(Ee.buffer,Ee.byteOffset,Ee.byteLength),Je;Ee[0]===1?Je=Gv(Ee.subarray(4,12)):Je=Ne.getUint32(4);let kt;return typeof Je=="bigint"?kt=Je/Wh.BigInt(Ae):typeof Je=="number"&&!isNaN(Je)&&(kt=Je/Ae),kt<Number.MAX_SAFE_INTEGER&&(kt=Number(kt)),kt<R&&(R=kt),R},Infinity);return typeof T=="bigint"||isFinite(T)?T:0},u0=function(m,_){var w=fn(_,["moof","traf"]),T=0,R=0,U;if(w&&w.length){var he=fn(w[0],["tfhd"])[0],me=fn(w[0],["trun"])[0],Ae=fn(w[0],["tfdt"])[0];if(he){var Ee=$v(he);U=Ee.trackId}if(Ae){var Ne=Hv(Ae);T=Ne.baseMediaDecodeTime}if(me){var Je=Vv(me);Je.samples&&Je.samples.length&&(R=Je.samples[0].compositionTimeOffset||0)}}var kt=m[U]||9e4;typeof T=="bigint"&&(R=Wh.BigInt(R),kt=Wh.BigInt(kt));var lt=(T+R)/kt;return typeof lt=="bigint"&&lt<Number.MAX_SAFE_INTEGER&&(lt=Number(lt)),lt},d0=function(m){var _=fn(m,["moov","trak"]),w=[];return _.forEach(function(T){var R=fn(T,["mdia","hdlr"]),U=fn(T,["tkhd"]);R.forEach(function(he,me){var Ae=Dl(he.subarray(8,12)),Ee=U[me],Ne,Je,kt;Ae==="vide"&&(Ne=new DataView(Ee.buffer,Ee.byteOffset,Ee.byteLength),Je=Ne.getUint8(0),kt=Je===0?Ne.getUint32(12):Ne.getUint32(20),w.push(kt))})}),w},zh=function(m){var _=m[0],w=_===0?12:20;return Ic(m[w]<<24|m[w+1]<<16|m[w+2]<<8|m[w+3])},c0=function(m){var _=fn(m,["moov","trak"]),w=[];return _.forEach(function(T){var R={},U=fn(T,["tkhd"])[0],he,me;U&&(he=new DataView(U.buffer,U.byteOffset,U.byteLength),me=he.getUint8(0),R.id=me===0?he.getUint32(12):he.getUint32(20));var Ae=fn(T,["mdia","hdlr"])[0];if(Ae){var Ee=Dl(Ae.subarray(8,12));Ee==="vide"?R.type="video":Ee==="soun"?R.type="audio":R.type=Ee}var Ne=fn(T,["mdia","minf","stbl","stsd"])[0];if(Ne){var Je=Ne.subarray(8);R.codec=Dl(Je.subarray(4,8));var kt=fn(Je,[R.codec])[0],lt,ei;kt&&(/^[asm]vc[1-9]$/i.test(R.codec)?(lt=kt.subarray(78),ei=Dl(lt.subarray(4,8)),ei==="avcC"&&lt.length>11?(R.codec+=".",R.codec+=Xu(lt[9]),R.codec+=Xu(lt[10]),R.codec+=Xu(lt[11])):R.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(R.codec)?(lt=kt.subarray(28),ei=Dl(lt.subarray(4,8)),ei==="esds"&&lt.length>20&&lt[19]!==0?(R.codec+="."+Xu(lt[19]),R.codec+="."+Xu(lt[20]>>>2&63).replace(/^0/,"")):R.codec="mp4a.40.2"):R.codec=R.codec.toLowerCase())}var si=fn(T,["mdia","mdhd"])[0];si&&(R.timescale=zh(si)),w.push(R)}),w},h0=function(m,_=0){var w=fn(m,["emsg"]);return w.map(T=>{var R=qh.parseEmsgBox(new Uint8Array(T)),U=qv(R.message_data);return{cueTime:qh.scaleTime(R.presentation_time,R.timescale,R.presentation_time_delta,_),duration:qh.scaleTime(R.event_duration,R.timescale),frames:U}})};var Kh={findBox:fn,parseType:Dl,timescale:o0,startTime:l0,compositionStartTime:u0,videoTrackIds:d0,tracks:c0,getTimescaleFromMediaHeader:zh,getEmsgID3:h0},Yh=gc,f0=function(m){var _=m[1]&31;return _<<=8,_|=m[2],_},Rc=function(m){return!!(m[1]&64)},Pc=function(m){var _=0;return(m[3]&48)>>>4>1&&(_+=m[4]+1),_},zv=function(m,_){var w=f0(m);return w===0?"pat":w===_?"pmt":_?"pes":null},Wv=function(m){var _=Rc(m),w=4+Pc(m);return _&&(w+=m[w]+1),(m[w+10]&31)<<8|m[w+11]},Kv=function(m){var _={},w=Rc(m),T=4+Pc(m);if(w&&(T+=m[T]+1),!!(m[T+5]&1)){var R,U,he;R=(m[T+1]&15)<<8|m[T+2],U=3+R-4,he=(m[T+10]&15)<<8|m[T+11];for(var me=12+he;me<U;){var Ae=T+me;_[(m[Ae+1]&31)<<8|m[Ae+2]]=m[Ae],me+=((m[Ae+3]&15)<<8|m[Ae+4])+5}return _}},Yv=function(m,_){var w=f0(m),T=_[w];switch(T){case Yh.H264_STREAM_TYPE:return"video";case Yh.ADTS_STREAM_TYPE:return"audio";case Yh.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},Xv=function(m){var _=Rc(m);if(!_)return null;var w=4+Pc(m);if(w>=m.byteLength)return null;var T=null,R;return R=m[w+7],R&192&&(T={},T.pts=(m[w+9]&14)<<27|(m[w+10]&255)<<20|(m[w+11]&254)<<12|(m[w+12]&255)<<5|(m[w+13]&254)>>>3,T.pts*=4,T.pts+=(m[w+13]&6)>>>1,T.dts=T.pts,R&64&&(T.dts=(m[w+14]&14)<<27|(m[w+15]&255)<<20|(m[w+16]&254)<<12|(m[w+17]&255)<<5|(m[w+18]&254)>>>3,T.dts*=4,T.dts+=(m[w+18]&6)>>>1)),T},Xh=function(m){switch(m){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},Qv=function(m){for(var _=4+Pc(m),w=m.subarray(_),T=0,R=0,U=!1,he;R<w.byteLength-3;R++)if(w[R+2]===1){T=R+5;break}for(;T<w.byteLength;)switch(w[T]){case 0:if(w[T-1]!==0){T+=2;break}else if(w[T-2]!==0){T++;break}R+3!==T-2&&(he=Xh(w[R+3]&31),he==="slice_layer_without_partitioning_rbsp_idr"&&(U=!0));do T++;while(w[T]!==1&&T<w.length);R=T-2,T+=3;break;case 1:if(w[T-1]!==0||w[T-2]!==0){T+=3;break}he=Xh(w[R+3]&31),he==="slice_layer_without_partitioning_rbsp_idr"&&(U=!0),R=T-2,T+=3;break;default:T+=3;break}return w=w.subarray(R),T-=R,R=0,w&&w.byteLength>3&&(he=Xh(w[R+3]&31),he==="slice_layer_without_partitioning_rbsp_idr"&&(U=!0)),U},Jv={parseType:zv,parsePat:Wv,parsePmt:Kv,parsePayloadUnitStartIndicator:Rc,parsePesType:Yv,parsePesTime:Xv,videoPacketContainsKeyFrame:Qv},p0=gc,kl=Mp.handleRollover,Mi={};Mi.ts=Jv,Mi.aac=$h;var wo=Ki.ONE_SECOND_IN_TS,ir=188,Os=71,Zv=function(m,_){for(var w=0,T=ir,R,U;T<m.byteLength;){if(m[w]===Os&&m[T]===Os){switch(R=m.subarray(w,T),U=Mi.ts.parseType(R,_.pid),U){case"pat":_.pid=Mi.ts.parsePat(R);break;case"pmt":var he=Mi.ts.parsePmt(R);_.table=_.table||{},Object.keys(he).forEach(function(me){_.table[me]=he[me]});break}w+=ir,T+=ir;continue}w++,T++}},m0=function(m,_,w){for(var T=0,R=ir,U,he,me,Ae,Ee,Ne=!1;R<=m.byteLength;){if(m[T]===Os&&(m[R]===Os||R===m.byteLength)){switch(U=m.subarray(T,R),he=Mi.ts.parseType(U,_.pid),he){case"pes":me=Mi.ts.parsePesType(U,_.table),Ae=Mi.ts.parsePayloadUnitStartIndicator(U),me==="audio"&&Ae&&(Ee=Mi.ts.parsePesTime(U),Ee&&(Ee.type="audio",w.audio.push(Ee),Ne=!0));break}if(Ne)break;T+=ir,R+=ir;continue}T++,R++}for(R=m.byteLength,T=R-ir,Ne=!1;T>=0;){if(m[T]===Os&&(m[R]===Os||R===m.byteLength)){switch(U=m.subarray(T,R),he=Mi.ts.parseType(U,_.pid),he){case"pes":me=Mi.ts.parsePesType(U,_.table),Ae=Mi.ts.parsePayloadUnitStartIndicator(U),me==="audio"&&Ae&&(Ee=Mi.ts.parsePesTime(U),Ee&&(Ee.type="audio",w.audio.push(Ee),Ne=!0));break}if(Ne)break;T-=ir,R-=ir;continue}T--,R--}},eA=function(m,_,w){for(var T=0,R=ir,U,he,me,Ae,Ee,Ne,Je,kt,lt=!1,ei={data:[],size:0};R<m.byteLength;){if(m[T]===Os&&m[R]===Os){switch(U=m.subarray(T,R),he=Mi.ts.parseType(U,_.pid),he){case"pes":if(me=Mi.ts.parsePesType(U,_.table),Ae=Mi.ts.parsePayloadUnitStartIndicator(U),me==="video"&&(Ae&&!lt&&(Ee=Mi.ts.parsePesTime(U),Ee&&(Ee.type="video",w.video.push(Ee),lt=!0)),!w.firstKeyFrame)){if(Ae&&ei.size!==0){for(Ne=new Uint8Array(ei.size),Je=0;ei.data.length;)kt=ei.data.shift(),Ne.set(kt,Je),Je+=kt.byteLength;if(Mi.ts.videoPacketContainsKeyFrame(Ne)){var si=Mi.ts.parsePesTime(Ne);si?(w.firstKeyFrame=si,w.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}ei.size=0}ei.data.push(U),ei.size+=U.byteLength}break}if(lt&&w.firstKeyFrame)break;T+=ir,R+=ir;continue}T++,R++}for(R=m.byteLength,T=R-ir,lt=!1;T>=0;){if(m[T]===Os&&m[R]===Os){switch(U=m.subarray(T,R),he=Mi.ts.parseType(U,_.pid),he){case"pes":me=Mi.ts.parsePesType(U,_.table),Ae=Mi.ts.parsePayloadUnitStartIndicator(U),me==="video"&&Ae&&(Ee=Mi.ts.parsePesTime(U),Ee&&(Ee.type="video",w.video.push(Ee),lt=!0));break}if(lt)break;T-=ir,R-=ir;continue}T--,R--}},tA=function(m,_){if(m.audio&&m.audio.length){var w=_;(typeof w=="undefined"||isNaN(w))&&(w=m.audio[0].dts),m.audio.forEach(function(U){U.dts=kl(U.dts,w),U.pts=kl(U.pts,w),U.dtsTime=U.dts/wo,U.ptsTime=U.pts/wo})}if(m.video&&m.video.length){var T=_;if((typeof T=="undefined"||isNaN(T))&&(T=m.video[0].dts),m.video.forEach(function(U){U.dts=kl(U.dts,T),U.pts=kl(U.pts,T),U.dtsTime=U.dts/wo,U.ptsTime=U.pts/wo}),m.firstKeyFrame){var R=m.firstKeyFrame;R.dts=kl(R.dts,T),R.pts=kl(R.pts,T),R.dtsTime=R.dts/wo,R.ptsTime=R.pts/wo}}},iA=function(m){for(var _=!1,w=0,T=null,R=null,U=0,he=0,me;m.length-he>=3;){var Ae=Mi.aac.parseType(m,he);switch(Ae){case"timed-metadata":if(m.length-he<10){_=!0;break}if(U=Mi.aac.parseId3TagSize(m,he),U>m.length){_=!0;break}R===null&&(me=m.subarray(he,he+U),R=Mi.aac.parseAacTimestamp(me)),he+=U;break;case"audio":if(m.length-he<7){_=!0;break}if(U=Mi.aac.parseAdtsSize(m,he),U>m.length){_=!0;break}T===null&&(me=m.subarray(he,he+U),T=Mi.aac.parseSampleRate(me)),w++,he+=U;break;default:he++;break}if(_)return null}if(T===null||R===null)return null;var Ee=wo/T,Ne={audio:[{type:"audio",dts:R,pts:R},{type:"audio",dts:R+w*1024*Ee,pts:R+w*1024*Ee}]};return Ne},nA=function(m){var _={pid:null,table:null},w={};Zv(m,_);for(var T in _.table)if(_.table.hasOwnProperty(T)){var R=_.table[T];switch(R){case p0.H264_STREAM_TYPE:w.video=[],eA(m,_,w),w.video.length===0&&delete w.video;break;case p0.ADTS_STREAM_TYPE:w.audio=[],m0(m,_,w),w.audio.length===0&&delete w.audio;break}}return w},rA=function(m,_){var w=Mi.aac.isLikelyAacData(m),T;return w?T=iA(m):T=nA(m),!T||!T.audio&&!T.video?null:(tA(T,_),T)},sA={inspect:rA,parseAudioPes_:m0};const aA=function(m,_){_.on("data",function(w){const T=w.initSegment;w.initSegment={data:T.buffer,byteOffset:T.byteOffset,byteLength:T.byteLength};const R=w.data;w.data=R.buffer,m.postMessage({action:"data",segment:w,byteOffset:R.byteOffset,byteLength:R.byteLength},[w.data])}),_.on("done",function(w){m.postMessage({action:"done"})}),_.on("gopInfo",function(w){m.postMessage({action:"gopInfo",gopInfo:w})}),_.on("videoSegmentTimingInfo",function(w){const T={start:{decode:Ki.videoTsToSeconds(w.start.dts),presentation:Ki.videoTsToSeconds(w.start.pts)},end:{decode:Ki.videoTsToSeconds(w.end.dts),presentation:Ki.videoTsToSeconds(w.end.pts)},baseMediaDecodeTime:Ki.videoTsToSeconds(w.baseMediaDecodeTime)};w.prependedContentDuration&&(T.prependedContentDuration=Ki.videoTsToSeconds(w.prependedContentDuration)),m.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:T})}),_.on("audioSegmentTimingInfo",function(w){const T={start:{decode:Ki.videoTsToSeconds(w.start.dts),presentation:Ki.videoTsToSeconds(w.start.pts)},end:{decode:Ki.videoTsToSeconds(w.end.dts),presentation:Ki.videoTsToSeconds(w.end.pts)},baseMediaDecodeTime:Ki.videoTsToSeconds(w.baseMediaDecodeTime)};w.prependedContentDuration&&(T.prependedContentDuration=Ki.videoTsToSeconds(w.prependedContentDuration)),m.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:T})}),_.on("id3Frame",function(w){m.postMessage({action:"id3Frame",id3Frame:w})}),_.on("caption",function(w){m.postMessage({action:"caption",caption:w})}),_.on("trackinfo",function(w){m.postMessage({action:"trackinfo",trackInfo:w})}),_.on("audioTimingInfo",function(w){m.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:Ki.videoTsToSeconds(w.start),end:Ki.videoTsToSeconds(w.end)}})}),_.on("videoTimingInfo",function(w){m.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:Ki.videoTsToSeconds(w.start),end:Ki.videoTsToSeconds(w.end)}})}),_.on("log",function(w){m.postMessage({action:"log",log:w})})};class g0{constructor(_,w){this.options=w||{},this.self=_,this.init()}init(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new uv.Transmuxer(this.options),aA(this.self,this.transmuxer)}pushMp4Captions(_){this.captionParser||(this.captionParser=new Pv,this.captionParser.init());const w=new Uint8Array(_.data,_.byteOffset,_.byteLength),T=this.captionParser.parse(w,_.trackIds,_.timescales);this.self.postMessage({action:"mp4Captions",captions:T&&T.captions||[],logs:T&&T.logs||[],data:w.buffer},[w.buffer])}probeMp4StartTime({timescales:_,data:w}){const T=Kh.startTime(_,w);this.self.postMessage({action:"probeMp4StartTime",startTime:T,data:w},[w.buffer])}probeMp4Tracks({data:_}){const w=Kh.tracks(_);this.self.postMessage({action:"probeMp4Tracks",tracks:w,data:_},[_.buffer])}probeEmsgID3({data:_,offset:w}){const T=Kh.getEmsgID3(_,w);this.self.postMessage({action:"probeEmsgID3",id3Frames:T,emsgData:_},[_.buffer])}probeTs({data:_,baseStartTime:w}){const T=typeof w=="number"&&!isNaN(w)?w*Ki.ONE_SECOND_IN_TS:void 0,R=sA.inspect(_,T);let U=null;R&&(U={hasVideo:R.video&&R.video.length===2||!1,hasAudio:R.audio&&R.audio.length===2||!1},U.hasVideo&&(U.videoStart=R.video[0].ptsTime),U.hasAudio&&(U.audioStart=R.audio[0].ptsTime)),this.self.postMessage({action:"probeTs",result:U,data:_},[_.buffer])}clearAllMp4Captions(){this.captionParser&&this.captionParser.clearAllCaptions()}clearParsedMp4Captions(){this.captionParser&&this.captionParser.clearParsedCaptions()}push(_){const w=new Uint8Array(_.data,_.byteOffset,_.byteLength);this.transmuxer.push(w)}reset(){this.transmuxer.reset()}setTimestampOffset(_){const w=_.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(Ki.secondsToVideoTs(w)))}setAudioAppendStart(_){this.transmuxer.setAudioAppendStart(Math.ceil(Ki.secondsToVideoTs(_.appendStart)))}setRemux(_){this.transmuxer.setRemux(_.remux)}flush(_){this.transmuxer.flush(),self.postMessage({action:"done",type:"transmuxed"})}endTimeline(){this.transmuxer.endTimeline(),self.postMessage({action:"endedtimeline",type:"transmuxed"})}alignGopsWith(_){this.transmuxer.alignGopsWith(_.gopsToAlignWith.slice())}}self.onmessage=function(m){if(m.data.action==="init"&&m.data.options){this.messageHandlers=new g0(self,m.data.options);return}this.messageHandlers||(this.messageHandlers=new g0(self)),m.data&&m.data.action&&m.data.action!=="init"&&this.messageHandlers[m.data.action]&&this.messageHandlers[m.data.action](m.data)}}));var hm=kf(cm);const fm=(s,e,i)=>{const{type:r,initSegment:o,captions:c,captionStreams:f,metadata:y,videoFrameDtsTime:S,videoFramePtsTime:O}=s.data.segment;e.buffer.push({captions:c,captionStreams:f,metadata:y});const q=s.data.segment.boxes||{data:s.data.segment.data},de={type:r,data:new Uint8Array(q.data,q.data.byteOffset,q.data.byteLength),initSegment:new Uint8Array(o.data,o.byteOffset,o.byteLength)};typeof S!="undefined"&&(de.videoFrameDtsTime=S),typeof O!="undefined"&&(de.videoFramePtsTime=O),i(de)},pm=({transmuxedData:s,callback:e})=>{s.buffer=[],e(s)},mm=(s,e)=>{e.gopInfo=s.data.gopInfo},Pf=s=>{const{transmuxer:e,bytes:i,audioAppendStart:r,gopsToAlignWith:o,remux:c,onData:f,onTrackInfo:y,onAudioTimingInfo:S,onVideoTimingInfo:O,onVideoSegmentTimingInfo:q,onAudioSegmentTimingInfo:de,onId3:Te,onCaptions:Ie,onDone:ge,onEndedTimeline:je,onTransmuxerLog:Ke,isEndOfTimeline:Ye,segment:qe,triggerSegmentEventFn:at}=s,ht={buffer:[]};let Ue=Ye;const pt=Bt=>{e.currentTransmux===s&&(Bt.data.action==="data"&&fm(Bt,ht,f),Bt.data.action==="trackinfo"&&y(Bt.data.trackInfo),Bt.data.action==="gopInfo"&&mm(Bt,ht),Bt.data.action==="audioTimingInfo"&&S(Bt.data.audioTimingInfo),Bt.data.action==="videoTimingInfo"&&O(Bt.data.videoTimingInfo),Bt.data.action==="videoSegmentTimingInfo"&&q(Bt.data.videoSegmentTimingInfo),Bt.data.action==="audioSegmentTimingInfo"&&de(Bt.data.audioSegmentTimingInfo),Bt.data.action==="id3Frame"&&Te([Bt.data.id3Frame],Bt.data.id3Frame.dispatchType),Bt.data.action==="caption"&&Ie(Bt.data.caption),Bt.data.action==="endedtimeline"&&(Ue=!1,je()),Bt.data.action==="log"&&Ke(Bt.data.log),Bt.data.type==="transmuxed"&&(Ue||(e.onmessage=null,pm({transmuxedData:ht,callback:ge}),Of(e))))},Vt=()=>{const Bt={message:"Received an error message from the transmuxer worker",metadata:{errorType:Re.Error.StreamingFailedToTransmuxSegment,segmentInfo:Ao({segment:qe})}};ge(null,Bt)};if(e.onmessage=pt,e.onerror=Vt,r&&e.postMessage({action:"setAudioAppendStart",appendStart:r}),Array.isArray(o)&&e.postMessage({action:"alignGopsWith",gopsToAlignWith:o}),typeof c!="undefined"&&e.postMessage({action:"setRemux",remux:c}),i.byteLength){const Bt=i instanceof ArrayBuffer?i:i.buffer,yi=i instanceof ArrayBuffer?0:i.byteOffset;at({type:"segmenttransmuxingstart",segment:qe}),e.postMessage({action:"push",data:Bt,byteOffset:yi,byteLength:i.byteLength},[Bt])}Ye&&e.postMessage({action:"endTimeline"}),e.postMessage({action:"flush"})},Of=s=>{s.currentTransmux=null,s.transmuxQueue.length&&(s.currentTransmux=s.transmuxQueue.shift(),typeof s.currentTransmux=="function"?s.currentTransmux():Pf(s.currentTransmux))},Bf=(s,e)=>{s.postMessage({action:e}),Of(s)},Mf=(s,e)=>{if(!e.currentTransmux){e.currentTransmux=s,Bf(e,s);return}e.transmuxQueue.push(Bf.bind(null,e,s))},gm=s=>{Mf("reset",s)},ym=s=>{Mf("endTimeline",s)},Ff=s=>{if(!s.transmuxer.currentTransmux){s.transmuxer.currentTransmux=s,Pf(s);return}s.transmuxer.transmuxQueue.push(s)};var _h={reset:gm,endTimeline:ym,transmux:Ff,createTransmuxer:s=>{const e=new hm;e.currentTransmux=null,e.transmuxQueue=[];const i=e.terminate;return e.terminate=()=>(e.currentTransmux=null,e.transmuxQueue.length=0,i.call(e)),e.postMessage({action:"init",options:s}),e}};const Bu=function(s){const e=s.transmuxer,i=s.endAction||s.action,r=s.callback,o=(0,Y.Z)({},s,{endAction:null,transmuxer:null,callback:null}),c=f=>{f.data.action===i&&(e.removeEventListener("message",c),f.data.data&&(f.data.data=new Uint8Array(f.data.data,s.byteOffset||0,s.byteLength||f.data.data.byteLength),s.data&&(s.data=f.data.data)),r(f.data))};if(e.addEventListener("message",c),s.data){const f=s.data instanceof ArrayBuffer;o.byteOffset=f?0:s.data.byteOffset,o.byteLength=s.data.byteLength;const y=[f?s.data:s.data.buffer];e.postMessage(o,y)}else e.postMessage(o)},Rs={FAILURE:2,TIMEOUT:-101,ABORTED:-102},bh=s=>{s.forEach(e=>{e.abort()})},vm=s=>({bandwidth:s.bandwidth,bytesReceived:s.bytesReceived||0,roundTripTime:s.roundTripTime||0}),Am=s=>{const e=s.target,i=Date.now()-e.requestTime,r={bandwidth:Infinity,bytesReceived:0,roundTripTime:i||0};return r.bytesReceived=s.loaded,r.bandwidth=Math.floor(r.bytesReceived/r.roundTripTime*8*1e3),r},xh=(s,e)=>{const{requestType:i}=e,r=vo({requestType:i,request:e,error:s});return e.timedout?{status:e.status,message:"HLS request timed-out at URL: "+e.uri,code:Rs.TIMEOUT,xhr:e,metadata:r}:e.aborted?{status:e.status,message:"HLS request aborted at URL: "+e.uri,code:Rs.ABORTED,xhr:e,metadata:r}:s?{status:e.status,message:"HLS request errored at URL: "+e.uri,code:Rs.FAILURE,xhr:e,metadata:r}:e.responseType==="arraybuffer"&&e.response.byteLength===0?{status:e.status,message:"Empty HLS response at URL: "+e.uri,code:Rs.FAILURE,xhr:e,metadata:r}:null},Nf=(s,e,i,r)=>(o,c)=>{const f=c.response,y=xh(o,c);if(y)return i(y,s);if(f.byteLength!==16)return i({status:c.status,message:"Invalid HLS key at URL: "+c.uri,code:Rs.FAILURE,xhr:c},s);const S=new DataView(f),O=new Uint32Array([S.getUint32(0),S.getUint32(4),S.getUint32(8),S.getUint32(12)]);for(let de=0;de<e.length;de++)e[de].bytes=O;const q={uri:c.uri};return r({type:"segmentkeyloadcomplete",segment:s,keyInfo:q}),i(null,s)},Uf=(s,e)=>{const i=Ji(s.map.bytes);if(i!=="mp4"){const r=s.map.resolvedUri||s.map.uri,o=i||"unknown";return e({internal:!0,message:`Found unsupported ${o} container for initialization segment at URL: ${r}`,code:Rs.FAILURE,metadata:{mediaType:o}})}Bu({action:"probeMp4Tracks",data:s.map.bytes,transmuxer:s.transmuxer,callback:({tracks:r,data:o})=>(s.map.bytes=o,r.forEach(function(c){s.map.tracks=s.map.tracks||{},!s.map.tracks[c.type]&&(s.map.tracks[c.type]=c,typeof c.id=="number"&&c.timescale&&(s.map.timescales=s.map.timescales||{},s.map.timescales[c.id]=c.timescale))}),e(null))})},_m=({segment:s,finishProcessingFn:e,triggerSegmentEventFn:i})=>(r,o)=>{const c=xh(r,o);if(c)return e(c,s);const f=new Uint8Array(o.response);if(i({type:"segmentloaded",segment:s}),s.map.key)return s.map.encryptedBytes=f,e(null,s);s.map.bytes=f,Uf(s,function(y){if(y)return y.xhr=o,y.status=o.status,e(y,s);e(null,s)})},bm=({segment:s,finishProcessingFn:e,responseType:i,triggerSegmentEventFn:r})=>(o,c)=>{const f=xh(o,c);if(f)return e(f,s);r({type:"segmentloaded",segment:s});const y=i==="arraybuffer"||!c.responseText?c.response:um(c.responseText.substring(s.lastReachedChar||0));return s.stats=vm(c),s.key?s.encryptedBytes=new Uint8Array(y):s.bytes=new Uint8Array(y),e(null,s)},xm=({segment:s,bytes:e,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:c,id3Fn:f,captionsFn:y,isEndOfTimeline:S,endedTimelineFn:O,dataFn:q,doneFn:de,onTransmuxerLog:Te,triggerSegmentEventFn:Ie})=>{const ge=s.map&&s.map.tracks||{},je=Boolean(ge.audio&&ge.video);let Ke=r.bind(null,s,"audio","start");const Ye=r.bind(null,s,"audio","end");let qe=r.bind(null,s,"video","start");const at=r.bind(null,s,"video","end"),ht=()=>Ff({bytes:e,transmuxer:s.transmuxer,audioAppendStart:s.audioAppendStart,gopsToAlignWith:s.gopsToAlignWith,remux:je,onData:Ue=>{Ue.type=Ue.type==="combined"?"video":Ue.type,q(s,Ue)},onTrackInfo:Ue=>{i&&(je&&(Ue.isMuxed=!0),i(s,Ue))},onAudioTimingInfo:Ue=>{Ke&&typeof Ue.start!="undefined"&&(Ke(Ue.start),Ke=null),Ye&&typeof Ue.end!="undefined"&&Ye(Ue.end)},onVideoTimingInfo:Ue=>{qe&&typeof Ue.start!="undefined"&&(qe(Ue.start),qe=null),at&&typeof Ue.end!="undefined"&&at(Ue.end)},onVideoSegmentTimingInfo:Ue=>{const pt={pts:{start:Ue.start.presentation,end:Ue.end.presentation},dts:{start:Ue.start.decode,end:Ue.end.decode}};Ie({type:"segmenttransmuxingtiminginfoavailable",segment:s,timingInfo:pt}),o(Ue)},onAudioSegmentTimingInfo:Ue=>{const pt={pts:{start:Ue.start.pts,end:Ue.end.pts},dts:{start:Ue.start.dts,end:Ue.end.dts}};Ie({type:"segmenttransmuxingtiminginfoavailable",segment:s,timingInfo:pt}),c(Ue)},onId3:(Ue,pt)=>{f(s,Ue,pt)},onCaptions:Ue=>{y(s,[Ue])},isEndOfTimeline:S,onEndedTimeline:()=>{O()},onTransmuxerLog:Te,onDone:(Ue,pt)=>{!de||(Ue.type=Ue.type==="combined"?"video":Ue.type,Ie({type:"segmenttransmuxingcomplete",segment:s}),de(pt,s,Ue))},segment:s,triggerSegmentEventFn:Ie});Bu({action:"probeTs",transmuxer:s.transmuxer,data:e,baseStartTime:s.baseStartTime,callback:Ue=>{s.bytes=e=Ue.data;const pt=Ue.result;pt&&(i(s,{hasAudio:pt.hasAudio,hasVideo:pt.hasVideo,isMuxed:je}),i=null),ht()}})},jf=({segment:s,bytes:e,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:c,id3Fn:f,captionsFn:y,isEndOfTimeline:S,endedTimelineFn:O,dataFn:q,doneFn:de,onTransmuxerLog:Te,triggerSegmentEventFn:Ie})=>{let ge=new Uint8Array(e);if(Yn(ge)){s.isFmp4=!0;const{tracks:je}=s.map,Ke={isFmp4:!0,hasVideo:!!je.video,hasAudio:!!je.audio};je.audio&&je.audio.codec&&je.audio.codec!=="enca"&&(Ke.audioCodec=je.audio.codec),je.video&&je.video.codec&&je.video.codec!=="encv"&&(Ke.videoCodec=je.video.codec),je.video&&je.audio&&(Ke.isMuxed=!0),i(s,Ke);const Ye=(qe,at)=>{q(s,{data:ge,type:Ke.hasAudio&&!Ke.isMuxed?"audio":"video"}),at&&at.length&&f(s,at),qe&&qe.length&&y(s,qe),de(null,s,{})};Bu({action:"probeMp4StartTime",timescales:s.map.timescales,data:ge,transmuxer:s.transmuxer,callback:({data:qe,startTime:at})=>{e=qe.buffer,s.bytes=ge=qe,Ke.hasAudio&&!Ke.isMuxed&&r(s,"audio","start",at),Ke.hasVideo&&r(s,"video","start",at),Bu({action:"probeEmsgID3",data:ge,transmuxer:s.transmuxer,offset:at,callback:({emsgData:ht,id3Frames:Ue})=>{if(e=ht.buffer,s.bytes=ge=ht,!je.video||!ht.byteLength||!s.transmuxer){Ye(void 0,Ue);return}Bu({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:s.transmuxer,data:ge,timescales:s.map.timescales,trackIds:[je.video.id],callback:pt=>{e=pt.data.buffer,s.bytes=ge=pt.data,pt.logs.forEach(function(Vt){Te($t(Vt,{stream:"mp4CaptionParser"}))}),Ye(pt.captions,Ue)}})}})}});return}if(!s.transmuxer){de(null,s,{});return}if(typeof s.container=="undefined"&&(s.container=Ji(ge)),s.container!=="ts"&&s.container!=="aac"){i(s,{hasAudio:!1,hasVideo:!1}),de(null,s,{});return}xm({segment:s,bytes:e,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:c,id3Fn:f,captionsFn:y,isEndOfTimeline:S,endedTimelineFn:O,dataFn:q,doneFn:de,onTransmuxerLog:Te,triggerSegmentEventFn:Ie})},$f=function({id:s,key:e,encryptedBytes:i,decryptionWorker:r,segment:o,doneFn:c},f){const y=O=>{if(O.data.source===s){r.removeEventListener("message",y);const q=O.data.decrypted;f(new Uint8Array(q.bytes,q.byteOffset,q.byteLength))}};r.onerror=()=>{const O="An error occurred in the decryption worker",q=Ao({segment:o}),de={message:O,metadata:{error:new Error(O),errorType:Re.Error.StreamingFailedToDecryptSegment,segmentInfo:q,keyInfo:{uri:o.key.resolvedUri||o.map.key.resolvedUri}}};c(de,o)},r.addEventListener("message",y);let S;e.bytes.slice?S=e.bytes.slice():S=new Uint32Array(Array.prototype.slice.call(e.bytes)),r.postMessage(xf({source:s,encrypted:i,key:S,iv:e.iv}),[i.buffer,S.buffer])},Em=({decryptionWorker:s,segment:e,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:c,id3Fn:f,captionsFn:y,isEndOfTimeline:S,endedTimelineFn:O,dataFn:q,doneFn:de,onTransmuxerLog:Te,triggerSegmentEventFn:Ie})=>{Ie({type:"segmentdecryptionstart"}),$f({id:e.requestId,key:e.key,encryptedBytes:e.encryptedBytes,decryptionWorker:s,segment:e,doneFn:de},ge=>{e.bytes=ge,Ie({type:"segmentdecryptioncomplete",segment:e}),jf({segment:e,bytes:e.bytes,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:c,id3Fn:f,captionsFn:y,isEndOfTimeline:S,endedTimelineFn:O,dataFn:q,doneFn:de,onTransmuxerLog:Te,triggerSegmentEventFn:Ie})})},Tm=({activeXhrs:s,decryptionWorker:e,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:c,id3Fn:f,captionsFn:y,isEndOfTimeline:S,endedTimelineFn:O,dataFn:q,doneFn:de,onTransmuxerLog:Te,triggerSegmentEventFn:Ie})=>{let ge=0,je=!1;return(Ke,Ye)=>{if(!je){if(Ke)return je=!0,bh(s),de(Ke,Ye);if(ge+=1,ge===s.length){const qe=function(){if(Ye.encryptedBytes)return Em({decryptionWorker:e,segment:Ye,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:c,id3Fn:f,captionsFn:y,isEndOfTimeline:S,endedTimelineFn:O,dataFn:q,doneFn:de,onTransmuxerLog:Te,triggerSegmentEventFn:Ie});jf({segment:Ye,bytes:Ye.bytes,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:c,id3Fn:f,captionsFn:y,isEndOfTimeline:S,endedTimelineFn:O,dataFn:q,doneFn:de,onTransmuxerLog:Te,triggerSegmentEventFn:Ie})};if(Ye.endOfAllRequests=Date.now(),Ye.map&&Ye.map.encryptedBytes&&!Ye.map.bytes)return Ie({type:"segmentdecryptionstart",segment:Ye}),$f({decryptionWorker:e,id:Ye.requestId+"-init",encryptedBytes:Ye.map.encryptedBytes,key:Ye.map.key,segment:Ye,doneFn:de},at=>{Ye.map.bytes=at,Ie({type:"segmentdecryptioncomplete",segment:Ye}),Uf(Ye,ht=>{if(ht)return bh(s),de(ht,Ye);qe()})});qe()}}}},Sm=({loadendState:s,abortFn:e})=>i=>{i.target.aborted&&e&&!s.calledAbortFn&&(e(),s.calledAbortFn=!0)},Cm=({segment:s,progressFn:e,trackInfoFn:i,timingInfoFn:r,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:c,id3Fn:f,captionsFn:y,isEndOfTimeline:S,endedTimelineFn:O,dataFn:q})=>de=>{if(!de.target.aborted)return s.stats=$t(s.stats,Am(de)),!s.stats.firstBytesReceivedAt&&s.stats.bytesReceived&&(s.stats.firstBytesReceivedAt=Date.now()),e(de,s)},wm=({xhr:s,xhrOptions:e,decryptionWorker:i,segment:r,abortFn:o,progressFn:c,trackInfoFn:f,timingInfoFn:y,videoSegmentTimingInfoFn:S,audioSegmentTimingInfoFn:O,id3Fn:q,captionsFn:de,isEndOfTimeline:Te,endedTimelineFn:Ie,dataFn:ge,doneFn:je,onTransmuxerLog:Ke,triggerSegmentEventFn:Ye})=>{const qe=[],at=Tm({activeXhrs:qe,decryptionWorker:i,trackInfoFn:f,timingInfoFn:y,videoSegmentTimingInfoFn:S,audioSegmentTimingInfoFn:O,id3Fn:q,captionsFn:de,isEndOfTimeline:Te,endedTimelineFn:Ie,dataFn:ge,doneFn:je,onTransmuxerLog:Ke,triggerSegmentEventFn:Ye});if(r.key&&!r.key.bytes){const Bt=[r.key];r.map&&!r.map.bytes&&r.map.key&&r.map.key.resolvedUri===r.key.resolvedUri&&Bt.push(r.map.key);const yi=$t(e,{uri:r.key.resolvedUri,responseType:"arraybuffer",requestType:"segment-key"}),ln=Nf(r,Bt,at,Ye),Rn={uri:r.key.resolvedUri};Ye({type:"segmentkeyloadstart",segment:r,keyInfo:Rn});const en=s(yi,ln);qe.push(en)}if(r.map&&!r.map.bytes){if(r.map.key&&(!r.key||r.key.resolvedUri!==r.map.key.resolvedUri)){const en=$t(e,{uri:r.map.key.resolvedUri,responseType:"arraybuffer",requestType:"segment-key"}),Wt=Nf(r,[r.map.key],at,Ye),Oi={uri:r.map.key.resolvedUri};Ye({type:"segmentkeyloadstart",segment:r,keyInfo:Oi});const zr=s(en,Wt);qe.push(zr)}const yi=$t(e,{uri:r.map.resolvedUri,responseType:"arraybuffer",headers:yh(r.map),requestType:"segment-media-initialization"}),ln=_m({segment:r,finishProcessingFn:at,triggerSegmentEventFn:Ye});Ye({type:"segmentloadstart",segment:r});const Rn=s(yi,ln);qe.push(Rn)}const ht=$t(e,{uri:r.part&&r.part.resolvedUri||r.resolvedUri,responseType:"arraybuffer",headers:yh(r),requestType:"segment"}),Ue=bm({segment:r,finishProcessingFn:at,responseType:ht.responseType,triggerSegmentEventFn:Ye});Ye({type:"segmentloadstart",segment:r});const pt=s(ht,Ue);pt.addEventListener("progress",Cm({segment:r,progressFn:c,trackInfoFn:f,timingInfoFn:y,videoSegmentTimingInfoFn:S,audioSegmentTimingInfoFn:O,id3Fn:q,captionsFn:de,isEndOfTimeline:Te,endedTimelineFn:Ie,dataFn:ge})),qe.push(pt);const Vt={};return qe.forEach(Bt=>{Bt.addEventListener("loadend",Sm({loadendState:Vt,abortFn:o}))}),()=>bh(qe)},Lm=St("CodecUtils"),Dm=function(s){const e=s.attributes||{};if(e.CODECS)return Oe(e.CODECS)},Vf=(s,e)=>{const i=e.attributes||{};return s&&s.mediaGroups&&s.mediaGroups.AUDIO&&i.AUDIO&&s.mediaGroups.AUDIO[i.AUDIO]},km=(s,e)=>{if(!Vf(s,e))return!0;const i=e.attributes||{},r=s.mediaGroups.AUDIO[i.AUDIO];for(const o in r)if(!r[o].uri&&!r[o].playlists)return!0;return!1},ic=function(s){const e={};return s.forEach(({mediaType:i,type:r,details:o})=>{e[i]=e[i]||[],e[i].push(Pe(`${r}${o}`))}),Object.keys(e).forEach(function(i){if(e[i].length>1){Lm(`multiple ${i} codecs found as attributes: ${e[i].join(", ")}. Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs.`),e[i]=null;return}e[i]=e[i][0]}),e},Hf=function(s){let e=0;return s.audio&&e++,s.video&&e++,e},Mu=function(s,e){const i=e.attributes||{},r=ic(Dm(e)||[]);if(Vf(s,e)&&!r.audio&&!km(s,e)){const o=ic(dt(s,i.AUDIO)||[]);o.audio&&(r.audio=o.audio)}return r},nc=St("PlaylistSelector"),Gf=function(s){if(!s||!s.playlist)return;const e=s.playlist;return JSON.stringify({id:e.id,bandwidth:s.bandwidth,width:s.width,height:s.height,codecs:e.attributes&&e.attributes.CODECS||""})},rc=function(s,e){if(!s)return"";const i=ne().getComputedStyle(s);return i?i[e]:""},Tl=function(s,e){const i=s.slice();s.sort(function(r,o){const c=e(r,o);return c===0?i.indexOf(r)-i.indexOf(o):c})},Eh=function(s,e){let i,r;return s.attributes.BANDWIDTH&&(i=s.attributes.BANDWIDTH),i=i||ne().Number.MAX_VALUE,e.attributes.BANDWIDTH&&(r=e.attributes.BANDWIDTH),r=r||ne().Number.MAX_VALUE,i-r},Im=function(s,e){let i,r;return s.attributes.RESOLUTION&&s.attributes.RESOLUTION.width&&(i=s.attributes.RESOLUTION.width),i=i||ne().Number.MAX_VALUE,e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width&&(r=e.attributes.RESOLUTION.width),r=r||ne().Number.MAX_VALUE,i===r&&s.attributes.BANDWIDTH&&e.attributes.BANDWIDTH?s.attributes.BANDWIDTH-e.attributes.BANDWIDTH:i-r};let qf=function(s,e,i,r,o,c){if(!s)return;const f={bandwidth:e,width:i,height:r,limitRenditionByPlayerDimensions:o};let y=s.playlists;fr.isAudioOnly(s)&&(y=c.getAudioTrackPlaylists_(),f.audioOnly=!0);let S=y.map(Ue=>{let pt;const Vt=Ue.attributes&&Ue.attributes.RESOLUTION&&Ue.attributes.RESOLUTION.width,Bt=Ue.attributes&&Ue.attributes.RESOLUTION&&Ue.attributes.RESOLUTION.height;return pt=Ue.attributes&&Ue.attributes.BANDWIDTH,pt=pt||ne().Number.MAX_VALUE,{bandwidth:pt,width:Vt,height:Bt,playlist:Ue}});Tl(S,(Ue,pt)=>Ue.bandwidth-pt.bandwidth),S=S.filter(Ue=>!fr.isIncompatible(Ue.playlist));let O=S.filter(Ue=>fr.isEnabled(Ue.playlist));O.length||(O=S.filter(Ue=>!fr.isDisabled(Ue.playlist)));const q=O.filter(Ue=>Ue.bandwidth*In.BANDWIDTH_VARIANCE<e);let de=q[q.length-1];const Te=q.filter(Ue=>Ue.bandwidth===de.bandwidth)[0];if(o===!1){const Ue=Te||O[0]||S[0];if(Ue&&Ue.playlist){let pt="sortedPlaylistReps";return Te&&(pt="bandwidthBestRep"),O[0]&&(pt="enabledPlaylistReps"),nc(`choosing ${Gf(Ue)} using ${pt} with options`,f),Ue.playlist}return nc("could not choose a playlist with options",f),null}const Ie=q.filter(Ue=>Ue.width&&Ue.height);Tl(Ie,(Ue,pt)=>Ue.width-pt.width);const ge=Ie.filter(Ue=>Ue.width===i&&Ue.height===r);de=ge[ge.length-1];const je=ge.filter(Ue=>Ue.bandwidth===de.bandwidth)[0];let Ke,Ye,qe;je||(Ke=Ie.filter(Ue=>Ue.width>i||Ue.height>r),Ye=Ke.filter(Ue=>Ue.width===Ke[0].width&&Ue.height===Ke[0].height),de=Ye[Ye.length-1],qe=Ye.filter(Ue=>Ue.bandwidth===de.bandwidth)[0]);let at;if(c.leastPixelDiffSelector){const Ue=Ie.map(pt=>(pt.pixelDiff=Math.abs(pt.width-i)+Math.abs(pt.height-r),pt));Tl(Ue,(pt,Vt)=>pt.pixelDiff===Vt.pixelDiff?Vt.bandwidth-pt.bandwidth:pt.pixelDiff-Vt.pixelDiff),at=Ue[0]}const ht=at||qe||je||Te||O[0]||S[0];if(ht&&ht.playlist){let Ue="sortedPlaylistReps";return at?Ue="leastPixelDiffRep":qe?Ue="resolutionPlusOneRep":je?Ue="resolutionBestRep":Te?Ue="bandwidthBestRep":O[0]&&(Ue="enabledPlaylistReps"),nc(`choosing ${Gf(ht)} using ${Ue} with options`,f),ht.playlist}return nc("could not choose a playlist with options",f),null};const zf=function(){let s=this.useDevicePixelRatio&&ne().devicePixelRatio||1;return isNaN(this.customPixelRatio)||(s=this.customPixelRatio),qf(this.playlists.main,this.systemBandwidth,parseInt(rc(this.tech_.el(),"width"),10)*s,parseInt(rc(this.tech_.el(),"height"),10)*s,this.limitRenditionByPlayerDimensions,this.playlistController_)},Rm=function(s){let e=-1,i=-1;if(s<0||s>1)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){let r=this.useDevicePixelRatio&&ne().devicePixelRatio||1;return isNaN(this.customPixelRatio)||(r=this.customPixelRatio),e<0&&(e=this.systemBandwidth,i=this.systemBandwidth),this.systemBandwidth>0&&this.systemBandwidth!==i&&(e=s*this.systemBandwidth+(1-s)*e,i=this.systemBandwidth),qf(this.playlists.main,e,parseInt(rc(this.tech_.el(),"width"),10)*r,parseInt(rc(this.tech_.el(),"height"),10)*r,this.limitRenditionByPlayerDimensions,this.playlistController_)}},Pm=function(s){const{main:e,currentTime:i,bandwidth:r,duration:o,segmentDuration:c,timeUntilRebuffer:f,currentTimeline:y,syncController:S}=s,O=e.playlists.filter(ge=>!fr.isIncompatible(ge));let q=O.filter(fr.isEnabled);q.length||(q=O.filter(ge=>!fr.isDisabled(ge)));const Te=q.filter(fr.hasAttribute.bind(null,"BANDWIDTH")).map(ge=>{const Ke=S.getSyncPoint(ge,o,y,i)?1:2,qe=fr.estimateSegmentRequestTime(c,r,ge)*Ke-f;return{playlist:ge,rebufferingImpact:qe}}),Ie=Te.filter(ge=>ge.rebufferingImpact<=0);return Tl(Ie,(ge,je)=>Eh(je.playlist,ge.playlist)),Ie.length?Ie[0]:(Tl(Te,(ge,je)=>ge.rebufferingImpact-je.rebufferingImpact),Te[0]||null)},Om=function(){const s=this.playlists.main.playlists.filter(fr.isEnabled);return Tl(s,(i,r)=>Eh(i,r)),s.filter(i=>!!Mu(this.playlists.main,i).video)[0]||null},Bm=s=>{let e=0,i;return s.bytes&&(i=new Uint8Array(s.bytes),s.segments.forEach(r=>{i.set(r,e),e+=r.byteLength})),i};function Wf(s){try{return new URL(s).pathname.split("/").slice(-2).join("/")}catch(e){return""}}const Mm=function(s,e,i){if(!s[i]){e.trigger({type:"usage",name:"vhs-608"});let r=i;/^cc708_/.test(i)&&(r="SERVICE"+i.split("_")[1]);const o=e.textTracks().getTrackById(r);if(o)s[i]=o;else{const c=e.options_.vhs&&e.options_.vhs.captionServices||{};let f=i,y=i,S=!1;const O=c[r];O&&(f=O.label,y=O.language,S=O.default),s[i]=e.addRemoteTextTrack({kind:"captions",id:r,default:S,label:f,language:y},!1).track}}},Fm=function({inbandTextTracks:s,captionArray:e,timestampOffset:i}){if(!e)return;const r=ne().WebKitDataCue||ne().VTTCue;e.forEach(o=>{const c=o.stream;o.content?o.content.forEach(f=>{const y=new r(o.startTime+i,o.endTime+i,f.text);y.line=f.line,y.align="left",y.position=f.position,y.positionAlign="line-left",s[c].addCue(y)}):s[c].addCue(new r(o.startTime+i,o.endTime+i,o.text))})},Nm=function(s){Object.defineProperties(s.frame,{id:{get(){return Re.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),s.value.key}},value:{get(){return Re.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),s.value.data}},privateData:{get(){return Re.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),s.value.data}}})},Um=({inbandTextTracks:s,metadataArray:e,timestampOffset:i,videoDuration:r})=>{if(!e)return;const o=ne().WebKitDataCue||ne().VTTCue,c=s.metadataTrack_;if(!c||(e.forEach(q=>{const de=q.cueTime+i;typeof de!="number"||ne().isNaN(de)||de<0||!(de<Infinity)||!q.frames||!q.frames.length||q.frames.forEach(Te=>{const Ie=new o(de,de,Te.value||Te.url||Te.data||"");Ie.frame=Te,Ie.value=Te,Nm(Ie),c.addCue(Ie)})}),!c.cues||!c.cues.length))return;const f=c.cues,y=[];for(let q=0;q<f.length;q++)f[q]&&y.push(f[q]);const S=y.reduce((q,de)=>{const Te=q[de.startTime]||[];return Te.push(de),q[de.startTime]=Te,q},{}),O=Object.keys(S).sort((q,de)=>Number(q)-Number(de));O.forEach((q,de)=>{const Te=S[q],Ie=isFinite(r)?r:q,ge=Number(O[de+1])||Ie;Te.forEach(je=>{je.endTime=ge})})},jm={id:"ID",class:"CLASS",startDate:"START-DATE",duration:"DURATION",endDate:"END-DATE",endOnNext:"END-ON-NEXT",plannedDuration:"PLANNED-DURATION",scte35Out:"SCTE35-OUT",scte35In:"SCTE35-IN"},$m=new Set(["id","class","startDate","duration","endDate","endOnNext","startTime","endTime","processDateRange"]),Vm=({inbandTextTracks:s,dateRanges:e})=>{const i=s.metadataTrack_;if(!i)return;const r=ne().WebKitDataCue||ne().VTTCue;e.forEach(o=>{for(const c of Object.keys(o)){if($m.has(c))continue;const f=new r(o.startTime,o.endTime,"");f.id=o.id,f.type="com.apple.quicktime.HLS",f.value={key:jm[c],data:o[c]},(c==="scte35Out"||c==="scte35In")&&(f.value.data=new Uint8Array(f.value.data.match(/[\da-f]{2}/gi)).buffer),i.addCue(f)}o.processDateRange()})},Kf=(s,e,i)=>{s.metadataTrack_||(s.metadataTrack_=i.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,Re.browser.IS_ANY_SAFARI||(s.metadataTrack_.inBandMetadataTrackDispatchType=e))},Fu=function(s,e,i){let r,o;if(!!i&&!!i.cues)for(r=i.cues.length;r--;)o=i.cues[r],o.startTime>=s&&o.endTime<=e&&i.removeCue(o)},Hm=function(s){const e=s.cues;if(!e)return;const i={};for(let r=e.length-1;r>=0;r--){const o=e[r],c=`${o.startTime}-${o.endTime}-${o.text}`;i[c]?s.removeCue(o):i[c]=o}},Gm=(s,e,i)=>{if(typeof e=="undefined"||e===null||!s.length)return[];const r=Math.ceil((e-i+3)*Qr.ONE_SECOND_IN_TS);let o;for(o=0;o<s.length&&!(s[o].pts>r);o++);return s.slice(o)},qm=(s,e,i)=>{if(!e.length)return s;if(i)return e.slice();const r=e[0].pts;let o=0;for(o;o<s.length&&!(s[o].pts>=r);o++);return s.slice(0,o).concat(e)},zm=(s,e,i,r)=>{const o=Math.ceil((e-r)*Qr.ONE_SECOND_IN_TS),c=Math.ceil((i-r)*Qr.ONE_SECOND_IN_TS),f=s.slice();let y=s.length;for(;y--&&!(s[y].pts<=c););if(y===-1)return f;let S=y+1;for(;S--&&!(s[S].pts<=o););return S=Math.max(S,0),f.splice(S,y-S+1),f},Wm=function(s,e){if(!s&&!e||!s&&e||s&&!e)return!1;if(s===e)return!0;const i=Object.keys(s).sort(),r=Object.keys(e).sort();if(i.length!==r.length)return!1;for(let o=0;o<i.length;o++){const c=i[o];if(c!==r[o]||s[c]!==e[c])return!1}return!0},Km=function(s,e,i){e=e||[];const r=[];let o=0;for(let c=0;c<e.length;c++){const f=e[c];if(s===f.timeline&&(r.push(c),o+=f.duration,o>i))return c}return r.length===0?0:r[r.length-1]},Nu=1,Ym=500,Yf=s=>typeof s=="number"&&isFinite(s),sc=1/60,Xm=(s,e,i)=>s!=="main"||!e||!i?null:!i.hasAudio&&!i.hasVideo?"Neither audio nor video found in segment.":e.hasVideo&&!i.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!e.hasVideo&&i.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null,Qm=(s,e,i)=>{let r=e-In.BACK_BUFFER_LENGTH;s.length&&(r=Math.max(r,s.start(0)));const o=e-i;return Math.min(o,r)},Sl=s=>{const{startOfSegment:e,duration:i,segment:r,part:o,playlist:{mediaSequence:c,id:f,segments:y=[]},mediaIndex:S,partIndex:O,timeline:q}=s,de=y.length-1;let Te="mediaIndex/partIndex increment";s.getMediaInfoForTime?Te=`getMediaInfoForTime (${s.getMediaInfoForTime})`:s.isSyncRequest&&(Te="getSyncSegmentCandidate (isSyncRequest)"),s.independent&&(Te+=` with independent ${s.independent}`);const Ie=typeof O=="number",ge=s.segment.uri?"segment":"pre-segment",je=Ie?nf({preloadSegment:r})-1:0;return`${ge} [${c+S}/${c+de}]`+(Ie?` part [${O}/${je}]`:"")+` segment start/end [${r.start} => ${r.end}]`+(Ie?` part start/end [${o.start} => ${o.end}]`:"")+` startOfSegment [${e}] duration [${i}] timeline [${q}] selected by [${Te}] playlist [${f}]`},Xf=s=>`${s}TimingInfo`,Jm=({segmentTimeline:s,currentTimeline:e,startOfSegment:i,buffered:r,overrideCheck:o})=>!o&&s===e?null:s<e?i:r.length?r.end(r.length-1):i,Qf=({timelineChangeController:s,currentTimeline:e,segmentTimeline:i,loaderType:r,audioDisabled:o})=>{if(e===i)return!1;if(r==="audio"){const c=s.lastTimelineChange({type:"main"});return!c||c.to!==i}if(r==="main"&&o){const c=s.pendingTimelineChange({type:"audio"});return!(c&&c.to===i)}return!1},Jf=s=>{if(!s)return!1;const e=s.pendingTimelineChange({type:"audio"}),i=s.pendingTimelineChange({type:"main"}),r=e&&i,o=r&&e.to!==i.to;return!!(r&&e.from!==-1&&i.from!==-1&&o)},Zf=s=>{!s||(s.pause(),s.resetEverything(),s.load())},Zm=s=>{let e=0;return["video","audio"].forEach(function(i){const r=s[`${i}TimingInfo`];if(!r)return;const{start:o,end:c}=r;let f;typeof o=="bigint"||typeof c=="bigint"?f=ne().BigInt(c)-ne().BigInt(o):typeof o=="number"&&typeof c=="number"&&(f=c-o),typeof f!="undefined"&&f>e&&(e=f)}),typeof e=="bigint"&&e<Number.MAX_SAFE_INTEGER&&(e=Number(e)),e},ep=({segmentDuration:s,maxDuration:e})=>s?Math.round(s)>e+Li:!1,eg=(s,e)=>{if(e!=="hls")return null;const i=Zm({audioTimingInfo:s.audioTimingInfo,videoTimingInfo:s.videoTimingInfo});if(!i)return null;const r=s.playlist.targetDuration,o=ep({segmentDuration:i,maxDuration:r*2}),c=ep({segmentDuration:i,maxDuration:r}),f=`Segment with index ${s.mediaIndex} from playlist ${s.playlist.id} has a duration of ${i} when the reported duration is ${s.duration} and the target duration is ${r}. For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1`;return o||c?{severity:o?"warn":"info",message:f}:null},Ao=({type:s,segment:e})=>{if(!e)return;const i=Boolean(e.key||e.map&&e.map.ke),r=Boolean(e.map&&!e.map.bytes),o=e.startOfSegment===void 0?e.start:e.startOfSegment;return{type:s||e.type,uri:e.resolvedUri||e.uri,start:o,duration:e.duration,isEncrypted:i,isMediaInitialization:r}};class Th extends Re.EventTarget{constructor(e,i={}){super();if(!e)throw new TypeError("Initialization settings are required");if(typeof e.currentTime!="function")throw new TypeError("No currentTime getter specified");if(!e.mediaSource)throw new TypeError("No MediaSource specified");this.bandwidth=e.bandwidth,this.throughput={rate:0,count:0},this.roundTrip=NaN,this.resetStats_(),this.mediaIndex=null,this.partIndex=null,this.hasPlayed_=e.hasPlayed,this.currentTime_=e.currentTime,this.seekable_=e.seekable,this.seeking_=e.seeking,this.duration_=e.duration,this.mediaSource_=e.mediaSource,this.vhs_=e.vhs,this.loaderType_=e.loaderType,this.currentMediaInfo_=void 0,this.startingMediaInfo_=void 0,this.segmentMetadataTrack_=e.segmentMetadataTrack,this.goalBufferLength_=e.goalBufferLength,this.sourceType_=e.sourceType,this.sourceUpdater_=e.sourceUpdater,this.inbandTextTracks_=e.inbandTextTracks,this.state_="INIT",this.timelineChangeController_=e.timelineChangeController,this.shouldSaveSegmentTimingInfo_=!0,this.parse708captions_=e.parse708captions,this.useDtsForTimestampOffset_=e.useDtsForTimestampOffset,this.captionServices_=e.captionServices,this.exactManifestTimings=e.exactManifestTimings,this.addMetadataToTextTrack=e.addMetadataToTextTrack,this.checkBufferTimeout_=null,this.error_=void 0,this.currentTimeline_=-1,this.shouldForceTimestampOffsetAfterResync_=!1,this.pendingSegment_=null,this.xhrOptions_=null,this.pendingSegments_=[],this.audioDisabled_=!1,this.isPendingTimestampOffset_=!1,this.gopBuffer_=[],this.timeMapping_=0,this.safeAppend_=!1,this.appendInitSegment_={audio:!0,video:!0},this.playlistOfLastInitSegment_={audio:null,video:null},this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_={id3:[],caption:[]},this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=null,this.activeInitSegmentId_=null,this.initSegments_={},this.cacheEncryptionKeys_=e.cacheEncryptionKeys,this.keyCache_={},this.decrypter_=e.decrypter,this.syncController_=e.syncController,this.syncPoint_={segmentIndex:0,time:0},this.transmuxer_=this.createTransmuxer_(),this.triggerSyncInfoUpdate_=()=>this.trigger("syncinfoupdate"),this.syncController_.on("syncinfoupdate",this.triggerSyncInfoUpdate_),this.mediaSource_.addEventListener("sourceopen",()=>{this.isEndOfStream_()||(this.ended_=!1)}),this.fetchAtBuffer_=!1,this.logger_=St(`SegmentLoader[${this.loaderType_}]`),Object.defineProperty(this,"state",{get(){return this.state_},set(r){r!==this.state_&&(this.logger_(`${this.state_} -> ${r}`),this.state_=r,this.trigger("statechange"))}}),this.sourceUpdater_.on("ready",()=>{this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}),this.sourceUpdater_.on("codecschange",r=>{this.trigger((0,Y.Z)({type:"codecschange"},r))}),this.loaderType_==="main"&&this.timelineChangeController_.on("pendingtimelinechange",()=>{this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}),this.loaderType_==="audio"&&this.timelineChangeController_.on("timelinechange",r=>{this.trigger((0,Y.Z)({type:"timelinechange"},r)),this.hasEnoughInfoToLoad_()&&this.processLoadQueue_(),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()})}get mediaSequenceSync_(){return this.syncController_.getMediaSequenceSync(this.loaderType_)}createTransmuxer_(){return _h.createTransmuxer({remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,parse708captions:this.parse708captions_,captionServices:this.captionServices_})}resetStats_(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0,this.mediaAppends=0}dispose(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&this.transmuxer_.terminate(),this.resetStats_(),this.checkBufferTimeout_&&ne().clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()}setAudio(e){this.audioDisabled_=!e,e?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())}abort(){if(this.state!=="WAITING"){this.pendingSegment_&&(this.pendingSegment_=null);return}this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()}abort_(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_),this.waitingOnRemove_=!1,ne().clearTimeout(this.quotaExceededErrorRetryTimeout_),this.quotaExceededErrorRetryTimeout_=null}checkForAbort_(e){return this.state==="APPENDING"&&!this.pendingSegment_?(this.state="READY",!0):!this.pendingSegment_||this.pendingSegment_.requestId!==e}error(e){return typeof e!="undefined"&&(this.logger_("error occurred:",e),this.error_=e),this.pendingSegment_=null,this.error_}endOfStream(){this.ended_=!0,this.transmuxer_&&_h.reset(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")}buffered_(){const e=this.getMediaInfo_();if(!this.sourceUpdater_||!e)return zt();if(this.loaderType_==="main"){const{hasAudio:i,hasVideo:r,isMuxed:o}=e;if(r&&i&&!this.audioDisabled_&&!o)return this.sourceUpdater_.buffered();if(r)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()}initSegmentForMap(e,i=!1){if(!e)return null;const r=tc(e);let o=this.initSegments_[r];return i&&!o&&e.bytes&&(this.initSegments_[r]=o={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,tracks:e.tracks,timescales:e.timescales}),o||e}segmentKey(e,i=!1){if(!e)return null;const r=Ef(e);let o=this.keyCache_[r];this.cacheEncryptionKeys_&&i&&!o&&e.bytes&&(this.keyCache_[r]=o={resolvedUri:e.resolvedUri,bytes:e.bytes});const c={resolvedUri:(o||e).resolvedUri};return o&&(c.bytes=o.bytes),c}couldBeginLoading_(){return this.playlist_&&!this.paused()}load(){if(this.monitorBuffer_(),!!this.playlist_){if(this.state==="INIT"&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||this.state!=="READY"&&this.state!=="INIT"||(this.state="READY")}}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}playlist(e,i={}){if(!e)return;const r=this.playlist_,o=this.pendingSegment_;this.playlist_=e,this.xhrOptions_=i,this.state==="INIT"&&(e.syncInfo={mediaSequence:e.mediaSequence,time:0},this.loaderType_==="main"&&this.syncController_.setDateTimeMappingForStart(e));let c=null;if(r&&(r.id?c=r.id:r.uri&&(c=r.uri)),this.logger_(`playlist update [${c} => ${e.id||e.uri}]`),this.mediaSequenceSync_&&(this.mediaSequenceSync_.update(e,this.currentTime_()),this.logger_(`Playlist update:
currentTime: ${this.currentTime_()}
bufferedEnd: ${oh(this.buffered_())}
`,this.mediaSequenceSync_.diagnostics)),this.trigger("syncinfoupdate"),this.state==="INIT"&&this.couldBeginLoading_())return this.init_();if(!r||r.uri!==e.uri){this.mediaIndex!==null&&(!e.endList&&typeof e.partTargetDuration=="number"?this.resetLoader():this.resyncLoader()),this.currentMediaInfo_=void 0,this.trigger("playlistupdate");return}const f=e.mediaSequence-r.mediaSequence;if(this.logger_(`live window shift [${f}]`),this.mediaIndex!==null)if(this.mediaIndex-=f,this.mediaIndex<0)this.mediaIndex=null,this.partIndex=null;else{const y=this.playlist_.segments[this.mediaIndex];if(this.partIndex&&(!y.parts||!y.parts.length||!y.parts[this.partIndex])){const S=this.mediaIndex;this.logger_(`currently processing part (index ${this.partIndex}) no longer exists.`),this.resetLoader(),this.mediaIndex=S}}o&&(o.mediaIndex-=f,o.mediaIndex<0?(o.mediaIndex=null,o.partIndex=null):(o.mediaIndex>=0&&(o.segment=e.segments[o.mediaIndex]),o.partIndex>=0&&o.segment.parts&&(o.part=o.segment.parts[o.partIndex]))),this.syncController_.saveExpiredSegmentInfo(r,e)}pause(){this.checkBufferTimeout_&&(ne().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}paused(){return this.checkBufferTimeout_===null}resetEverything(e){this.ended_=!1,this.activeInitSegmentId_=null,this.appendInitSegment_={audio:!0,video:!0},this.resetLoader(),this.remove(0,Infinity,e),this.transmuxer_&&(this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.transmuxer_.postMessage({action:"reset"}))}resetLoader(){this.fetchAtBuffer_=!1,this.mediaSequenceSync_&&this.mediaSequenceSync_.resetAppendedStatus(),this.resyncLoader()}resyncLoader(){this.transmuxer_&&_h.reset(this.transmuxer_),this.mediaIndex=null,this.partIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1;const e=this.currentMediaInfo_&&this.currentMediaInfo_.isFmp4;this.sourceType_==="hls"&&!e&&(this.shouldForceTimestampOffsetAfterResync_=!0),this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}remove(e,i,r=()=>{},o=!1){if(i===Infinity&&(i=this.duration_()),i<=e){this.logger_("skipping remove because end ${end} is <= start ${start}");return}if(!this.sourceUpdater_||!this.getMediaInfo_()){this.logger_("skipping remove because no source updater or starting media info");return}let c=1;const f=()=>{c--,c===0&&r()};(o||!this.audioDisabled_)&&(c++,this.sourceUpdater_.removeAudio(e,i,f)),(o||this.loaderType_==="main")&&(this.gopBuffer_=zm(this.gopBuffer_,e,i,this.timeMapping_),c++,this.sourceUpdater_.removeVideo(e,i,f));for(const y in this.inbandTextTracks_)Fu(e,i,this.inbandTextTracks_[y]);Fu(e,i,this.segmentMetadataTrack_),f()}monitorBuffer_(){this.checkBufferTimeout_&&ne().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=ne().setTimeout(this.monitorBufferTick_.bind(this),1)}monitorBufferTick_(){this.state==="READY"&&this.fillBuffer_(),this.checkBufferTimeout_&&ne().clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=ne().setTimeout(this.monitorBufferTick_.bind(this),Ym)}fillBuffer_(){if(this.sourceUpdater_.updating())return;const e=this.chooseNextRequest_();if(!e)return;const i={segmentInfo:Ao({type:this.loaderType_,segment:e})};this.trigger({type:"segmentselected",metadata:i}),typeof e.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!1,this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline})),this.loadSegment_(e)}isEndOfStream_(e=this.mediaIndex,i=this.playlist_,r=this.partIndex){if(!i||!this.mediaSource_)return!1;const o=typeof e=="number"&&i.segments[e],c=e+1===i.segments.length,f=!o||!o.parts||r+1===o.parts.length;return i.endList&&this.mediaSource_.readyState==="open"&&c&&f}chooseNextRequest_(){const e=this.buffered_(),i=oh(e)||0,r=lh(e,this.currentTime_()),o=!this.hasPlayed_()&&r>=1,c=r>=this.goalBufferLength_(),f=this.playlist_.segments;if(!f.length||o||c)return null;this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_(),this.loaderType_);const y={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:Boolean(!this.syncPoint_)};if(y.isSyncRequest)y.mediaIndex=Km(this.currentTimeline_,f,i),this.logger_(`choose next request. Can not find sync point. Fallback to media Index: ${y.mediaIndex}`);else if(this.mediaIndex!==null){const Te=f[this.mediaIndex],Ie=typeof this.partIndex=="number"?this.partIndex:-1;y.startOfSegment=Te.end?Te.end:i,Te.parts&&Te.parts[Ie+1]?(y.mediaIndex=this.mediaIndex,y.partIndex=Ie+1):y.mediaIndex=this.mediaIndex+1}else{let Te,Ie,ge;const je=this.fetchAtBuffer_?i:this.currentTime_();if(this.mediaSequenceSync_&&this.logger_(`chooseNextRequest_ request after Quality Switch:
For TargetTime: ${je}.
CurrentTime: ${this.currentTime_()}
BufferedEnd: ${i}
Fetch At Buffer: ${this.fetchAtBuffer_}
`,this.mediaSequenceSync_.diagnostics),this.mediaSequenceSync_&&this.mediaSequenceSync_.isReliable){const Ke=this.getSyncInfoFromMediaSequenceSync_(je);if(!Ke){const Ye="No sync info found while using media sequence sync";return this.error({message:Ye,metadata:{errorType:Re.Error.StreamingFailedToSelectNextSegment,error:new Error(Ye)}}),this.logger_("chooseNextRequest_ - no sync info found using media sequence sync"),null}this.logger_(`chooseNextRequest_ mediaSequence syncInfo (${Ke.start} --> ${Ke.end})`),Te=Ke.segmentIndex,Ie=Ke.partIndex,ge=Ke.start}else{this.logger_("chooseNextRequest_ - fallback to a regular segment selection algorithm, based on a syncPoint.");const Ke=fr.getMediaInfoForTime({exactManifestTimings:this.exactManifestTimings,playlist:this.playlist_,currentTime:je,startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time});Te=Ke.segmentIndex,Ie=Ke.partIndex,ge=Ke.startTime}y.getMediaInfoForTime=this.fetchAtBuffer_?`bufferedEnd ${je}`:`currentTime ${je}`,y.mediaIndex=Te,y.startOfSegment=ge,y.partIndex=Ie,this.logger_(`choose next request. Playlist switched and we have a sync point. Media Index: ${y.mediaIndex} `)}const S=f[y.mediaIndex];let O=S&&typeof y.partIndex=="number"&&S.parts&&S.parts[y.partIndex];if(!S||typeof y.partIndex=="number"&&!O)return null;typeof y.partIndex!="number"&&S.parts&&(y.partIndex=0,O=S.parts[0]);const q=this.vhs_.playlists&&this.vhs_.playlists.main&&this.vhs_.playlists.main.independentSegments||this.playlist_.independentSegments;if(!r&&O&&!q&&!O.independent)if(y.partIndex===0){const Te=f[y.mediaIndex-1],Ie=Te.parts&&Te.parts.length&&Te.parts[Te.parts.length-1];Ie&&Ie.independent&&(y.mediaIndex-=1,y.partIndex=Te.parts.length-1,y.independent="previous segment")}else S.parts[y.partIndex-1].independent&&(y.partIndex-=1,y.independent="previous part");const de=this.mediaSource_&&this.mediaSource_.readyState==="ended";return y.mediaIndex>=f.length-1&&de&&!this.seeking_()?null:(this.shouldForceTimestampOffsetAfterResync_&&(this.shouldForceTimestampOffsetAfterResync_=!1,y.forceTimestampOffset=!0,this.logger_("choose next request. Force timestamp offset after loader resync")),this.generateSegmentInfo_(y))}getSyncInfoFromMediaSequenceSync_(e){if(!this.mediaSequenceSync_)return null;const i=Math.max(e,this.mediaSequenceSync_.start);e!==i&&this.logger_(`getSyncInfoFromMediaSequenceSync_. Pulled target time from ${e} to ${i}`);const r=this.mediaSequenceSync_.getSyncInfoForTime(i);if(!r)return null;if(!r.isAppended)return r;const o=this.mediaSequenceSync_.getSyncInfoForTime(r.end);return o?(o.isAppended&&this.logger_("getSyncInfoFromMediaSequenceSync_: We encounter unexpected scenario where next media sequence sync info is also appended!"),o):null}generateSegmentInfo_(e){const{independent:i,playlist:r,mediaIndex:o,startOfSegment:c,isSyncRequest:f,partIndex:y,forceTimestampOffset:S,getMediaInfoForTime:O}=e,q=r.segments[o],de=typeof y=="number"&&q.parts[y],Te={requestId:"segment-loader-"+Math.random(),uri:de&&de.resolvedUri||q.resolvedUri,mediaIndex:o,partIndex:de?y:null,isSyncRequest:f,startOfSegment:c,playlist:r,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:q.timeline,duration:de&&de.duration||q.duration,segment:q,part:de,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:O,independent:i},Ie=typeof S!="undefined"?S:this.isPendingTimestampOffset_;Te.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:q.timeline,currentTimeline:this.currentTimeline_,startOfSegment:c,buffered:this.buffered_(),overrideCheck:Ie});const ge=oh(this.sourceUpdater_.audioBuffered());return typeof ge=="number"&&(Te.audioAppendStart=ge-this.sourceUpdater_.audioTimestampOffset()),this.sourceUpdater_.videoBuffered().length&&(Te.gopsToAlignWith=Gm(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),Te}timestampOffsetForSegment_(e){return Jm(e)}earlyAbortWhenNeeded_(e){if(this.vhs_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH||Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)return;const i=this.currentTime_(),r=e.bandwidth,o=this.pendingSegment_.duration,c=fr.estimateSegmentRequestTime(o,r,this.playlist_,e.bytesReceived),f=T0(this.buffered_(),i,this.vhs_.tech_.playbackRate())-1;if(c<=f)return;const y=Pm({main:this.vhs_.playlists.main,currentTime:i,bandwidth:r,duration:this.duration_(),segmentDuration:o,timeUntilRebuffer:f,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(!y)return;const O=c-f-y.rebufferingImpact;let q=.5;f<=Li&&(q=1),!(!y.playlist||y.playlist.uri===this.playlist_.uri||O<q)&&(this.bandwidth=y.playlist.attributes.BANDWIDTH*In.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort"))}handleAbort_(e){this.logger_(`Aborting ${Sl(e)}`),this.mediaRequestsAborted+=1}handleProgress_(e,i){this.earlyAbortWhenNeeded_(i.stats),!this.checkForAbort_(i.requestId)&&this.trigger("progress")}handleTrackInfo_(e,i){const{hasAudio:r,hasVideo:o}=i,c={segmentInfo:Ao({type:this.loaderType_,segment:e}),trackInfo:{hasAudio:r,hasVideo:o}};this.trigger({type:"segmenttransmuxingtrackinfoavailable",metadata:c}),this.earlyAbortWhenNeeded_(e.stats),!this.checkForAbort_(e.requestId)&&(this.checkForIllegalMediaSwitch(i)||(i=i||{},Wm(this.currentMediaInfo_,i)||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=i,this.currentMediaInfo_=i,this.logger_("trackinfo update",i),this.trigger("trackinfo")),!this.checkForAbort_(e.requestId)&&(this.pendingSegment_.trackInfo=i,this.hasEnoughInfoToAppend_()&&this.processCallQueue_())))}handleTimingInfo_(e,i,r,o){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;const c=this.pendingSegment_,f=Xf(i);c[f]=c[f]||{},c[f][r]=o,this.logger_(`timinginfo: ${i} - ${r} - ${o}`),this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}handleCaptions_(e,i){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(i.length===0){this.logger_("SegmentLoader received no captions from a caption event");return}if(!this.pendingSegment_.hasAppendedData_){this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,e,i));return}const o=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),c={};i.forEach(f=>{c[f.stream]=c[f.stream]||{startTime:Infinity,captions:[],endTime:0};const y=c[f.stream];y.startTime=Math.min(y.startTime,f.startTime+o),y.endTime=Math.max(y.endTime,f.endTime+o),y.captions.push(f)}),Object.keys(c).forEach(f=>{const{startTime:y,endTime:S,captions:O}=c[f],q=this.inbandTextTracks_;this.logger_(`adding cues from ${y} -> ${S} for ${f}`),Mm(q,this.vhs_.tech_,f),Fu(y,S,q[f]),Fm({captionArray:O,inbandTextTracks:q,timestampOffset:o})}),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}handleId3_(e,i,r){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(!this.pendingSegment_.hasAppendedData_){this.metadataQueue_.id3.push(this.handleId3_.bind(this,e,i,r));return}this.addMetadataToTextTrack(r,i,this.duration_())}processMetadataQueue_(){this.metadataQueue_.id3.forEach(e=>e()),this.metadataQueue_.caption.forEach(e=>e()),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]}processCallQueue_(){const e=this.callQueue_;this.callQueue_=[],e.forEach(i=>i())}processLoadQueue_(){const e=this.loadQueue_;this.loadQueue_=[],e.forEach(i=>i())}hasEnoughInfoToLoad_(){if(this.loaderType_!=="audio")return!0;const e=this.pendingSegment_;return e?this.getCurrentMediaInfo_()&&Qf({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_})?(Jf(this.timelineChangeController_)&&Zf(this),!1):!0:!1}getCurrentMediaInfo_(e=this.pendingSegment_){return e&&e.trackInfo||this.currentMediaInfo_}getMediaInfo_(e=this.pendingSegment_){return this.getCurrentMediaInfo_(e)||this.startingMediaInfo_}getPendingSegmentPlaylist(){return this.pendingSegment_?this.pendingSegment_.playlist:null}hasEnoughInfoToAppend_(){if(!this.sourceUpdater_.ready()||this.waitingOnRemove_||this.quotaExceededErrorRetryTimeout_)return!1;const e=this.pendingSegment_,i=this.getCurrentMediaInfo_();if(!e||!i)return!1;const{hasAudio:r,hasVideo:o,isMuxed:c}=i;return o&&!e.videoTimingInfo||r&&!this.audioDisabled_&&!c&&!e.audioTimingInfo?!1:Qf({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_})?(Jf(this.timelineChangeController_)&&Zf(this),!1):!0}handleData_(e,i){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(this.callQueue_.length||!this.hasEnoughInfoToAppend_()){this.callQueue_.push(this.handleData_.bind(this,e,i));return}const r=this.pendingSegment_;if(this.setTimeMapping_(r.timeline),this.updateMediaSecondsLoaded_(r.part||r.segment),this.mediaSource_.readyState!=="closed"){if(e.map&&(e.map=this.initSegmentForMap(e.map,!0),r.segment.map=e.map),e.key&&this.segmentKey(e.key,!0),r.isFmp4=e.isFmp4,r.timingInfo=r.timingInfo||{},r.isFmp4)this.trigger("fmp4"),r.timingInfo.start=r[Xf(i.type)].start;else{const o=this.getCurrentMediaInfo_(),c=this.loaderType_==="main"&&o&&o.hasVideo;let f;c&&(f=r.videoTimingInfo.start),r.timingInfo.start=this.trueSegmentStart_({currentStart:r.timingInfo.start,playlist:r.playlist,mediaIndex:r.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:c,firstVideoFrameTimeForData:f,videoTimingInfo:r.videoTimingInfo,audioTimingInfo:r.audioTimingInfo})}if(this.updateAppendInitSegmentStatus(r,i.type),this.updateSourceBufferTimestampOffset_(r),r.isSyncRequest){this.updateTimingInfoEnd_(r),this.syncController_.saveSegmentTimingInfo({segmentInfo:r,shouldSaveTimelineMapping:this.loaderType_==="main"});const o=this.chooseNextRequest_();if(o.mediaIndex!==r.mediaIndex||o.partIndex!==r.partIndex){this.logger_("sync segment was incorrect, not appending");return}this.logger_("sync segment was correct, appending")}r.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(r,i)}}updateAppendInitSegmentStatus(e,i){this.loaderType_==="main"&&typeof e.timestampOffset=="number"&&!e.changedTimestampOffset&&(this.appendInitSegment_={audio:!0,video:!0}),this.playlistOfLastInitSegment_[i]!==e.playlist&&(this.appendInitSegment_[i]=!0)}getInitSegmentAndUpdateState_({type:e,initSegment:i,map:r,playlist:o}){if(r){const c=tc(r);if(this.activeInitSegmentId_===c)return null;i=this.initSegmentForMap(r,!0).bytes,this.activeInitSegmentId_=c}return i&&this.appendInitSegment_[e]?(this.playlistOfLastInitSegment_[e]=o,this.appendInitSegment_[e]=!1,this.activeInitSegmentId_=null,i):null}handleQuotaExceededError_({segmentInfo:e,type:i,bytes:r},o){const c=this.sourceUpdater_.audioBuffered(),f=this.sourceUpdater_.videoBuffered();c.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+yo(c).join(", ")),f.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+yo(f).join(", "));const y=c.length?c.start(0):0,S=c.length?c.end(c.length-1):0,O=f.length?f.start(0):0,q=f.length?f.end(f.length-1):0;if(S-y<=Nu&&q-O<=Nu){this.logger_(`On QUOTA_EXCEEDED_ERR, single segment too large to append to buffer, triggering an error. Appended byte length: ${r.byteLength}, audio buffer: ${yo(c).join(", ")}, video buffer: ${yo(f).join(", ")}, `),this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:Infinity}),this.trigger("error");return}this.waitingOnRemove_=!0,this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:e,type:i,bytes:r}));const Te=this.currentTime_()-Nu;this.logger_(`On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to ${Te}`),this.remove(0,Te,()=>{this.logger_(`On QUOTA_EXCEEDED_ERR, retrying append in ${Nu}s`),this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=ne().setTimeout(()=>{this.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue"),this.quotaExceededErrorRetryTimeout_=null,this.processCallQueue_()},Nu*1e3)},!0)}handleAppendError_({segmentInfo:e,type:i,bytes:r},o){if(!!o){if(o.code===gf){this.handleQuotaExceededError_({segmentInfo:e,type:i,bytes:r});return}this.logger_("Received non QUOTA_EXCEEDED_ERR on append",o),this.error({message:`${i} append of ${r.length}b failed for segment #${e.mediaIndex} in playlist ${e.playlist.id}`,metadata:{errorType:Re.Error.StreamingFailedToAppendSegment}}),this.trigger("appenderror")}}appendToSourceBuffer_({segmentInfo:e,type:i,initSegment:r,data:o,bytes:c}){if(!c){const y=[o];let S=o.byteLength;r&&(y.unshift(r),S+=r.byteLength),c=Bm({bytes:S,segments:y})}const f={segmentInfo:Ao({type:this.loaderType_,segment:e})};this.trigger({type:"segmentappendstart",metadata:f}),this.sourceUpdater_.appendBuffer({segmentInfo:e,type:i,bytes:c},this.handleAppendError_.bind(this,{segmentInfo:e,type:i,bytes:c}))}handleSegmentTimingInfo_(e,i,r){if(!this.pendingSegment_||i!==this.pendingSegment_.requestId)return;const o=this.pendingSegment_.segment,c=`${e}TimingInfo`;o[c]||(o[c]={}),o[c].transmuxerPrependedSeconds=r.prependedContentDuration||0,o[c].transmuxedPresentationStart=r.start.presentation,o[c].transmuxedDecodeStart=r.start.decode,o[c].transmuxedPresentationEnd=r.end.presentation,o[c].transmuxedDecodeEnd=r.end.decode,o[c].baseMediaDecodeTime=r.baseMediaDecodeTime}appendData_(e,i){const{type:r,data:o}=i;if(!o||!o.byteLength||r==="audio"&&this.audioDisabled_)return;const c=this.getInitSegmentAndUpdateState_({type:r,initSegment:i.initSegment,playlist:e.playlist,map:e.isFmp4?e.segment.map:null});this.appendToSourceBuffer_({segmentInfo:e,type:r,initSegment:c,data:o})}loadSegment_(e){if(this.state="WAITING",this.pendingSegment_=e,this.trimBackBuffer_(e),typeof e.timestampOffset=="number"&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),!this.hasEnoughInfoToLoad_()){this.loadQueue_.push(()=>{const i=(0,Y.Z)({},e,{forceTimestampOffset:!0});(0,Y.Z)(e,this.generateSegmentInfo_(i)),this.isPendingTimestampOffset_=!1,this.updateTransmuxerAndRequestSegment_(e)});return}this.updateTransmuxerAndRequestSegment_(e)}updateTransmuxerAndRequestSegment_(e){this.shouldUpdateTransmuxerTimestampOffset_(e.timestampOffset)&&(this.gopBuffer_.length=0,e.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e.timestampOffset}));const i=this.createSimplifiedSegmentObj_(e),r=this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex),o=this.mediaIndex!==null,c=e.timeline!==this.currentTimeline_&&e.timeline>0,f=r||o&&c;this.logger_(`Requesting
${Wf(e.uri)}
${Sl(e)}`),i.map&&!i.map.bytes&&(this.logger_("going to request init segment."),this.appendInitSegment_={video:!0,audio:!0}),e.abortRequests=wm({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:i,abortFn:this.handleAbort_.bind(this,e),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",e.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",e.requestId),captionsFn:this.handleCaptions_.bind(this),isEndOfTimeline:f,endedTimelineFn:()=>{this.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this),onTransmuxerLog:({message:y,level:S,stream:O})=>{this.logger_(`${Sl(e)} logged from transmuxer stream ${O} as a ${S}: ${y}`)},triggerSegmentEventFn:({type:y,segment:S,keyInfo:O,trackInfo:q,timingInfo:de})=>{const Ie={segmentInfo:Ao({segment:S})};O&&(Ie.keyInfo=O),q&&(Ie.trackInfo=q),de&&(Ie.timingInfo=de),this.trigger({type:y,metadata:Ie})}})}trimBackBuffer_(e){const i=Qm(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);i>0&&this.remove(0,i)}createSimplifiedSegmentObj_(e){const i=e.segment,r=e.part,o=e.segment.key||e.segment.map&&e.segment.map.key,c=e.segment.map&&!e.segment.map.bytes,f={resolvedUri:r?r.resolvedUri:i.resolvedUri,byterange:r?r.byterange:i.byterange,requestId:e.requestId,transmuxer:e.transmuxer,audioAppendStart:e.audioAppendStart,gopsToAlignWith:e.gopsToAlignWith,part:e.part,type:this.loaderType_,start:e.startOfSegment,duration:e.duration,isEncrypted:o,isMediaInitialization:c},y=e.playlist.segments[e.mediaIndex-1];if(y&&y.timeline===i.timeline&&(y.videoTimingInfo?f.baseStartTime=y.videoTimingInfo.transmuxedDecodeEnd:y.audioTimingInfo&&(f.baseStartTime=y.audioTimingInfo.transmuxedDecodeEnd)),i.key){const S=i.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);f.key=this.segmentKey(i.key),f.key.iv=S}return i.map&&(f.map=this.initSegmentForMap(i.map)),f}saveTransferStats_(e){this.mediaRequests+=1,e&&(this.mediaBytesTransferred+=e.bytesReceived,this.mediaTransferDuration+=e.roundTripTime)}saveBandwidthRelatedStats_(e,i){if(this.pendingSegment_.byteLength=i.bytesReceived,e<sc){this.logger_(`Ignoring segment's bandwidth because its duration of ${e} is less than the min to record ${sc}`);return}const r={bandwidthInfo:{from:this.bandwidth,to:i.bandwidth}};this.trigger({type:"bandwidthupdated",metadata:r}),this.bandwidth=i.bandwidth,this.roundTrip=i.roundTripTime}handleTimeout_(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate"),this.trigger("timeout")}segmentRequestFinished_(e,i,r){if(this.callQueue_.length){this.callQueue_.push(this.segmentRequestFinished_.bind(this,e,i,r));return}if(this.saveTransferStats_(i.stats),!this.pendingSegment_||i.requestId!==this.pendingSegment_.requestId)return;if(e){if(this.pendingSegment_=null,this.state="READY",e.code===Rs.ABORTED)return;if(this.pause(),e.code===Rs.TIMEOUT){this.handleTimeout_();return}this.mediaRequestsErrored+=1,this.error(e),this.trigger("error");return}const o=this.pendingSegment_;this.saveBandwidthRelatedStats_(o.duration,i.stats),o.endOfAllRequests=i.endOfAllRequests,r.gopInfo&&(this.gopBuffer_=qm(this.gopBuffer_,r.gopInfo,this.safeAppend_)),this.state="APPENDING",this.trigger("appending"),this.waitForAppendsToComplete_(o)}setTimeMapping_(e){const i=this.syncController_.mappingForTimeline(e);i!==null&&(this.timeMapping_=i)}updateMediaSecondsLoaded_(e){typeof e.start=="number"&&typeof e.end=="number"?this.mediaSecondsLoaded+=e.end-e.start:this.mediaSecondsLoaded+=e.duration}shouldUpdateTransmuxerTimestampOffset_(e){return e===null?!1:this.loaderType_==="main"&&e!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&e!==this.sourceUpdater_.audioTimestampOffset()}trueSegmentStart_({currentStart:e,playlist:i,mediaIndex:r,firstVideoFrameTimeForData:o,currentVideoTimestampOffset:c,useVideoTimingInfo:f,videoTimingInfo:y,audioTimingInfo:S}){if(typeof e!="undefined")return e;if(!f)return S.start;const O=i.segments[r-1];return r===0||!O||typeof O.start=="undefined"||O.end!==o+c?o:y.start}waitForAppendsToComplete_(e){const i=this.getCurrentMediaInfo_(e);if(!i){this.error({message:"No starting media returned, likely due to an unsupported media format.",playlistExclusionDuration:Infinity}),this.trigger("error");return}const{hasAudio:r,hasVideo:o,isMuxed:c}=i,f=this.loaderType_==="main"&&o,y=!this.audioDisabled_&&r&&!c;if(e.waitingOnAppends=0,!e.hasAppendedData_){!e.timingInfo&&typeof e.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!0),e.timingInfo={start:0},e.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(e),this.processMetadataQueue_()),this.checkAppendsDone_(e);return}f&&e.waitingOnAppends++,y&&e.waitingOnAppends++,f&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,e)),y&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,e))}checkAppendsDone_(e){this.checkForAbort_(e.requestId)||(e.waitingOnAppends--,e.waitingOnAppends===0&&this.handleAppendsDone_())}checkForIllegalMediaSwitch(e){const i=Xm(this.loaderType_,this.getCurrentMediaInfo_(),e);return i?(this.error({message:i,playlistExclusionDuration:Infinity}),this.trigger("error"),!0):!1}updateSourceBufferTimestampOffset_(e){if(e.timestampOffset===null||typeof e.timingInfo.start!="number"||e.changedTimestampOffset||this.loaderType_!=="main")return;let i=!1;e.timestampOffset-=this.getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:e.segment.videoTimingInfo,audioTimingInfo:e.segment.audioTimingInfo,timingInfo:e.timingInfo}),e.changedTimestampOffset=!0,e.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(e.timestampOffset),i=!0),e.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(e.timestampOffset),i=!0),i&&this.trigger("timestampoffset")}getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:e,audioTimingInfo:i,timingInfo:r}){return this.useDtsForTimestampOffset_?e&&typeof e.transmuxedDecodeStart=="number"?e.transmuxedDecodeStart:i&&typeof i.transmuxedDecodeStart=="number"?i.transmuxedDecodeStart:r.start:r.start}updateTimingInfoEnd_(e){e.timingInfo=e.timingInfo||{};const i=this.getMediaInfo_(),o=this.loaderType_==="main"&&i&&i.hasVideo&&e.videoTimingInfo?e.videoTimingInfo:e.audioTimingInfo;!o||(e.timingInfo.end=typeof o.end=="number"?o.end:o.start+e.duration)}handleAppendsDone_(){if(this.pendingSegment_){const S={segmentInfo:Ao({type:this.loaderType_,segment:this.pendingSegment_})};this.trigger({type:"appendsdone",metadata:S})}if(!this.pendingSegment_){this.state="READY",this.paused()||this.monitorBuffer_();return}const e=this.pendingSegment_;e.part&&e.part.syncInfo?e.part.syncInfo.markAppended():e.segment.syncInfo&&e.segment.syncInfo.markAppended(),this.updateTimingInfoEnd_(e),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:this.loaderType_==="main"});const i=eg(e,this.sourceType_);if(i&&(i.severity==="warn"?Re.log.warn(i.message):this.logger_(i.message)),this.recordThroughput_(e),this.pendingSegment_=null,this.state="READY",e.isSyncRequest&&(this.trigger("syncinfoupdate"),!e.hasAppendedData_)){this.logger_(`Throwing away un-appended sync request ${Sl(e)}`);return}this.logger_(`Appended ${Sl(e)}`),this.addSegmentMetadataCue_(e),this.fetchAtBuffer_=!0,this.currentTimeline_!==e.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline}),this.loaderType_==="main"&&!this.audioDisabled_&&this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:e.timeline})),this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate");const r=e.segment,o=e.part,c=r.end&&this.currentTime_()-r.end>e.playlist.targetDuration*3,f=o&&o.end&&this.currentTime_()-o.end>e.playlist.partTargetDuration*3;if(c||f){this.logger_(`bad ${c?"segment":"part"} ${Sl(e)}`),this.resetEverything();return}this.mediaIndex!==null&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=e.mediaIndex,this.partIndex=e.partIndex,this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex)&&this.endOfStream(),this.trigger("appended"),e.hasAppendedData_&&this.mediaAppends++,this.paused()||this.monitorBuffer_()}recordThroughput_(e){if(e.duration<sc){this.logger_(`Ignoring segment's throughput because its duration of ${e.duration} is less than the min to record ${sc}`);return}const i=this.throughput.rate,r=Date.now()-e.endOfAllRequests+1,o=Math.floor(e.byteLength/r*8*1e3);this.throughput.rate+=(o-i)/++this.throughput.count}addSegmentMetadataCue_(e){if(!this.segmentMetadataTrack_)return;const i=e.segment,r=i.start,o=i.end;if(!Yf(r)||!Yf(o))return;Fu(r,o,this.segmentMetadataTrack_);const c=ne().WebKitDataCue||ne().VTTCue,f={custom:i.custom,dateTimeObject:i.dateTimeObject,dateTimeString:i.dateTimeString,programDateTime:i.programDateTime,bandwidth:e.playlist.attributes.BANDWIDTH,resolution:e.playlist.attributes.RESOLUTION,codecs:e.playlist.attributes.CODECS,byteLength:e.byteLength,uri:e.uri,timeline:e.timeline,playlist:e.playlist.id,start:r,end:o},y=JSON.stringify(f),S=new c(r,o,y);S.value=f,this.segmentMetadataTrack_.addCue(S)}}function aa(){}const tp=function(s){return typeof s!="string"?s:s.replace(/./,e=>e.toUpperCase())},tg=["video","audio"],Sh=(s,e)=>{const i=e[`${s}Buffer`];return i&&i.updating||e.queuePending[s]},ig=(s,e)=>{for(let i=0;i<e.length;i++){const r=e[i];if(r.type==="mediaSource")return null;if(r.type===s)return i}return null},Cl=(s,e)=>{if(e.queue.length===0)return;let i=0,r=e.queue[i];if(r.type==="mediaSource"){!e.updating()&&e.mediaSource.readyState!=="closed"&&(e.queue.shift(),r.action(e),r.doneFn&&r.doneFn(),Cl("audio",e),Cl("video",e));return}if(s!=="mediaSource"&&!(!e.ready()||e.mediaSource.readyState==="closed"||Sh(s,e))){if(r.type!==s){if(i=ig(s,e.queue),i===null)return;r=e.queue[i]}if(e.queue.splice(i,1),e.queuePending[s]=r,r.action(s,e),!r.doneFn){e.queuePending[s]=null,Cl(s,e);return}}},ip=(s,e)=>{const i=e[`${s}Buffer`],r=tp(s);!i||(i.removeEventListener("updateend",e[`on${r}UpdateEnd_`]),i.removeEventListener("error",e[`on${r}Error_`]),e.codecs[s]=null,e[`${s}Buffer`]=null)},Ps=(s,e)=>s&&e&&Array.prototype.indexOf.call(s.sourceBuffers,e)!==-1,Cr={appendBuffer:(s,e,i)=>(r,o)=>{const c=o[`${r}Buffer`];if(!!Ps(o.mediaSource,c)){o.logger_(`Appending segment ${e.mediaIndex}'s ${s.length} bytes to ${r}Buffer`);try{c.appendBuffer(s)}catch(f){o.logger_(`Error with code ${f.code} `+(f.code===gf?"(QUOTA_EXCEEDED_ERR) ":"")+`when appending segment ${e.mediaIndex} to ${r}Buffer`),o.queuePending[r]=null,i(f)}}},remove:(s,e)=>(i,r)=>{const o=r[`${i}Buffer`];if(!!Ps(r.mediaSource,o)){r.logger_(`Removing ${s} to ${e} from ${i}Buffer`);try{o.remove(s,e)}catch(c){r.logger_(`Remove ${s} to ${e} from ${i}Buffer failed`)}}},timestampOffset:s=>(e,i)=>{const r=i[`${e}Buffer`];!Ps(i.mediaSource,r)||(i.logger_(`Setting ${e}timestampOffset to ${s}`),r.timestampOffset=s)},callback:s=>(e,i)=>{s()},endOfStream:s=>e=>{if(e.mediaSource.readyState==="open"){e.logger_(`Calling mediaSource endOfStream(${s||""})`);try{e.mediaSource.endOfStream(s)}catch(i){Re.log.warn("Failed to call media source endOfStream",i)}}},duration:s=>e=>{e.logger_(`Setting mediaSource duration to ${s}`);try{e.mediaSource.duration=s}catch(i){Re.log.warn("Failed to set media source duration",i)}},abort:()=>(s,e)=>{if(e.mediaSource.readyState!=="open")return;const i=e[`${s}Buffer`];if(!!Ps(e.mediaSource,i)){e.logger_(`calling abort on ${s}Buffer`);try{i.abort()}catch(r){Re.log.warn(`Failed to abort on ${s}Buffer`,r)}}},addSourceBuffer:(s,e)=>i=>{const r=tp(s),o=nt(e);i.logger_(`Adding ${s}Buffer with codec ${e} to mediaSource`);const c=i.mediaSource.addSourceBuffer(o);c.addEventListener("updateend",i[`on${r}UpdateEnd_`]),c.addEventListener("error",i[`on${r}Error_`]),i.codecs[s]=e,i[`${s}Buffer`]=c},removeSourceBuffer:s=>e=>{const i=e[`${s}Buffer`];if(ip(s,e),!!Ps(e.mediaSource,i)){e.logger_(`Removing ${s}Buffer with codec ${e.codecs[s]} from mediaSource`);try{e.mediaSource.removeSourceBuffer(i)}catch(r){Re.log.warn(`Failed to removeSourceBuffer ${s}Buffer`,r)}}},changeType:s=>(e,i)=>{const r=i[`${e}Buffer`],o=nt(s);if(!Ps(i.mediaSource,r))return;const c=s.substring(0,s.indexOf(".")),f=i.codecs[e];if(f.substring(0,f.indexOf("."))===c)return;const S={codecsChangeInfo:{from:f,to:s}};i.trigger({type:"codecschange",metadata:S}),i.logger_(`changing ${e}Buffer codec from ${f} to ${s}`);try{r.changeType(o),i.codecs[e]=s}catch(O){S.errorType=Re.Error.StreamingCodecsChangeError,S.error=O,O.metadata=S,i.error_=O,i.trigger("error"),Re.log.warn(`Failed to changeType on ${e}Buffer`,O)}}},wr=({type:s,sourceUpdater:e,action:i,doneFn:r,name:o})=>{e.queue.push({type:s,action:i,doneFn:r,name:o}),Cl(s,e)},np=(s,e)=>i=>{const r=e[`${s}Buffered`](),o=wi(r);if(e.logger_(`received "updateend" event for ${s} Source Buffer: `,o),e.queuePending[s]){const c=e.queuePending[s].doneFn;e.queuePending[s]=null,c&&c(e[`${s}Error_`])}Cl(s,e)};class rp extends Re.EventTarget{constructor(e){super();this.mediaSource=e,this.sourceopenListener_=()=>Cl("mediaSource",this),this.mediaSource.addEventListener("sourceopen",this.sourceopenListener_),this.logger_=St("SourceUpdater"),this.audioTimestampOffset_=0,this.videoTimestampOffset_=0,this.queue=[],this.queuePending={audio:null,video:null},this.delayedAudioAppendQueue_=[],this.videoAppendQueued_=!1,this.codecs={},this.onVideoUpdateEnd_=np("video",this),this.onAudioUpdateEnd_=np("audio",this),this.onVideoError_=i=>{this.videoError_=i},this.onAudioError_=i=>{this.audioError_=i},this.createdSourceBuffers_=!1,this.initializedEme_=!1,this.triggeredReady_=!1}initializedEme(){this.initializedEme_=!0,this.triggerReady()}hasCreatedSourceBuffers(){return this.createdSourceBuffers_}hasInitializedAnyEme(){return this.initializedEme_}ready(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()}createSourceBuffers(e){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(e),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())}triggerReady(){this.ready()&&!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))}addSourceBuffer(e,i){wr({type:"mediaSource",sourceUpdater:this,action:Cr.addSourceBuffer(e,i),name:"addSourceBuffer"})}abort(e){wr({type:e,sourceUpdater:this,action:Cr.abort(e),name:"abort"})}removeSourceBuffer(e){if(!this.canRemoveSourceBuffer()){Re.log.error("removeSourceBuffer is not supported!");return}wr({type:"mediaSource",sourceUpdater:this,action:Cr.removeSourceBuffer(e),name:"removeSourceBuffer"})}canRemoveSourceBuffer(){return!Re.browser.IS_FIREFOX&&ne().MediaSource&&ne().MediaSource.prototype&&typeof ne().MediaSource.prototype.removeSourceBuffer=="function"}static canChangeType(){return ne().SourceBuffer&&ne().SourceBuffer.prototype&&typeof ne().SourceBuffer.prototype.changeType=="function"}canChangeType(){return this.constructor.canChangeType()}changeType(e,i){if(!this.canChangeType()){Re.log.error("changeType is not supported!");return}wr({type:e,sourceUpdater:this,action:Cr.changeType(i),name:"changeType"})}addOrChangeSourceBuffers(e){if(!e||typeof e!="object"||Object.keys(e).length===0)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(e).forEach(i=>{const r=e[i];if(!this.hasCreatedSourceBuffers())return this.addSourceBuffer(i,r);this.canChangeType()&&this.changeType(i,r)})}appendBuffer(e,i){const{segmentInfo:r,type:o,bytes:c}=e;if(this.processedAppend_=!0,o==="audio"&&this.videoBuffer&&!this.videoAppendQueued_){this.delayedAudioAppendQueue_.push([e,i]),this.logger_(`delayed audio append of ${c.length} until video append`);return}const f=i;if(wr({type:o,sourceUpdater:this,action:Cr.appendBuffer(c,r||{mediaIndex:-1},f),doneFn:i,name:"appendBuffer"}),o==="video"){if(this.videoAppendQueued_=!0,!this.delayedAudioAppendQueue_.length)return;const y=this.delayedAudioAppendQueue_.slice();this.logger_(`queuing delayed audio ${y.length} appendBuffers`),this.delayedAudioAppendQueue_.length=0,y.forEach(S=>{this.appendBuffer.apply(this,S)})}}audioBuffered(){return Ps(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered?this.audioBuffer.buffered:zt()}videoBuffered(){return Ps(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered?this.videoBuffer.buffered:zt()}buffered(){const e=Ps(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,i=Ps(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return i&&!e?this.audioBuffered():e&&!i?this.videoBuffered():E0(this.audioBuffered(),this.videoBuffered())}setDuration(e,i=aa){wr({type:"mediaSource",sourceUpdater:this,action:Cr.duration(e),name:"duration",doneFn:i})}endOfStream(e=null,i=aa){typeof e!="string"&&(e=void 0),wr({type:"mediaSource",sourceUpdater:this,action:Cr.endOfStream(e),name:"endOfStream",doneFn:i})}removeAudio(e,i,r=aa){if(!this.audioBuffered().length||this.audioBuffered().end(0)===0){r();return}wr({type:"audio",sourceUpdater:this,action:Cr.remove(e,i),doneFn:r,name:"remove"})}removeVideo(e,i,r=aa){if(!this.videoBuffered().length||this.videoBuffered().end(0)===0){r();return}wr({type:"video",sourceUpdater:this,action:Cr.remove(e,i),doneFn:r,name:"remove"})}updating(){return!!(Sh("audio",this)||Sh("video",this))}audioTimestampOffset(e){return typeof e!="undefined"&&this.audioBuffer&&this.audioTimestampOffset_!==e&&(wr({type:"audio",sourceUpdater:this,action:Cr.timestampOffset(e),name:"timestampOffset"}),this.audioTimestampOffset_=e),this.audioTimestampOffset_}videoTimestampOffset(e){return typeof e!="undefined"&&this.videoBuffer&&this.videoTimestampOffset_!==e&&(wr({type:"video",sourceUpdater:this,action:Cr.timestampOffset(e),name:"timestampOffset"}),this.videoTimestampOffset_=e),this.videoTimestampOffset_}audioQueueCallback(e){!this.audioBuffer||wr({type:"audio",sourceUpdater:this,action:Cr.callback(e),name:"callback"})}videoQueueCallback(e){!this.videoBuffer||wr({type:"video",sourceUpdater:this,action:Cr.callback(e),name:"callback"})}dispose(){this.trigger("dispose"),tg.forEach(e=>{this.abort(e),this.canRemoveSourceBuffer()?this.removeSourceBuffer(e):this[`${e}QueueCallback`](()=>ip(e,this))}),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()}}const sp=s=>decodeURIComponent(escape(String.fromCharCode.apply(null,s))),ng=s=>{const e=new Uint8Array(s);return Array.from(e).map(i=>i.toString(16).padStart(2,"0")).join("")},ap=new Uint8Array(`

`.split("").map(s=>s.charCodeAt(0)));class rg extends Error{constructor(){super("Trying to parse received VTT cues, but there is no WebVTT. Make sure vtt.js is loaded.")}}class sg extends Th{constructor(e,i={}){super(e,i);this.mediaSource_=null,this.subtitlesTrack_=null,this.featuresNativeTextTracks_=e.featuresNativeTextTracks,this.loadVttJs=e.loadVttJs,this.shouldSaveSegmentTimingInfo_=!1}createTransmuxer_(){return null}buffered_(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues||!this.subtitlesTrack_.cues.length)return zt();const e=this.subtitlesTrack_.cues,i=e[0].startTime,r=e[e.length-1].startTime;return zt([[i,r]])}initSegmentForMap(e,i=!1){if(!e)return null;const r=tc(e);let o=this.initSegments_[r];if(i&&!o&&e.bytes){const c=ap.byteLength+e.bytes.byteLength,f=new Uint8Array(c);f.set(e.bytes),f.set(ap,e.bytes.byteLength),this.initSegments_[r]=o={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:f}}return o||e}couldBeginLoading_(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}track(e){return typeof e=="undefined"?this.subtitlesTrack_:(this.subtitlesTrack_=e,this.state==="INIT"&&this.couldBeginLoading_()&&this.init_(),this.subtitlesTrack_)}remove(e,i){Fu(e,i,this.subtitlesTrack_)}fillBuffer_(){const e=this.chooseNextRequest_();if(!!e){if(this.syncController_.timestampOffsetForTimeline(e.timeline)===null){const i=()=>{this.state="READY",this.paused()||this.monitorBuffer_()};this.syncController_.one("timestampoffset",i),this.state="WAITING_ON_TIMELINE";return}this.loadSegment_(e)}}timestampOffsetForSegment_(){return null}chooseNextRequest_(){return this.skipEmptySegments_(super.chooseNextRequest_())}skipEmptySegments_(e){for(;e&&e.segment.empty;){if(e.mediaIndex+1>=e.playlist.segments.length){e=null;break}e=this.generateSegmentInfo_({playlist:e.playlist,mediaIndex:e.mediaIndex+1,startOfSegment:e.startOfSegment+e.duration,isSyncRequest:e.isSyncRequest})}return e}stopForError(e){this.error(e),this.state="READY",this.pause(),this.trigger("error")}segmentRequestFinished_(e,i,r){if(!this.subtitlesTrack_){this.state="READY";return}if(this.saveTransferStats_(i.stats),!this.pendingSegment_){this.state="READY",this.mediaRequestsAborted+=1;return}if(e){e.code===Rs.TIMEOUT&&this.handleTimeout_(),e.code===Rs.ABORTED?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,this.stopForError(e);return}const o=this.pendingSegment_;this.saveBandwidthRelatedStats_(o.duration,i.stats),i.key&&this.segmentKey(i.key,!0),this.state="APPENDING",this.trigger("appending");const c=o.segment;if(c.map&&(c.map.bytes=i.map.bytes),o.bytes=i.bytes,typeof ne().WebVTT!="function"&&typeof this.loadVttJs=="function"){this.state="WAITING_ON_VTTJS",this.loadVttJs().then(()=>this.segmentRequestFinished_(e,i,r),()=>this.stopForError({message:"Error loading vtt.js"}));return}c.requested=!0;try{this.parseVTTCues_(o)}catch(f){this.stopForError({message:f.message,metadata:{errorType:Re.Error.StreamingVttParserError,error:f}});return}if(this.updateTimeMapping_(o,this.syncController_.timelines[o.timeline],this.playlist_),o.cues.length?o.timingInfo={start:o.cues[0].startTime,end:o.cues[o.cues.length-1].endTime}:o.timingInfo={start:o.startOfSegment,end:o.startOfSegment+o.duration},o.isSyncRequest){this.trigger("syncinfoupdate"),this.pendingSegment_=null,this.state="READY";return}o.byteLength=o.bytes.byteLength,this.mediaSecondsLoaded+=c.duration,o.cues.forEach(f=>{this.subtitlesTrack_.addCue(this.featuresNativeTextTracks_?new(ne()).VTTCue(f.startTime,f.endTime,f.text):f)}),Hm(this.subtitlesTrack_),this.handleAppendsDone_()}handleData_(){}updateTimingInfoEnd_(){}parseVTTCues_(e){let i,r=!1;if(typeof ne().WebVTT!="function")throw new rg;typeof ne().TextDecoder=="function"?i=new(ne()).TextDecoder("utf8"):(i=ne().WebVTT.StringDecoder(),r=!0);const o=new(ne()).WebVTT.Parser(ne(),ne().vttjs,i);if(e.cues=[],e.timestampmap={MPEGTS:0,LOCAL:0},o.oncue=e.cues.push.bind(e.cues),o.ontimestampmap=f=>{e.timestampmap=f},o.onparsingerror=f=>{Re.log.warn("Error encountered when parsing cues: "+f.message)},e.segment.map){let f=e.segment.map.bytes;r&&(f=sp(f)),o.parse(f)}let c=e.bytes;r&&(c=sp(c)),o.parse(c),o.flush()}updateTimeMapping_(e,i,r){const o=e.segment;if(!i)return;if(!e.cues.length){o.empty=!0;return}const{MPEGTS:c,LOCAL:f}=e.timestampmap,S=c/Qr.ONE_SECOND_IN_TS-f+i.mapping;if(e.cues.forEach(O=>{const q=O.endTime-O.startTime,de=c===0?O.startTime+S:this.handleRollover_(O.startTime+S,i.time);O.startTime=Math.max(de,0),O.endTime=Math.max(de+q,0)}),!r.syncInfo){const O=e.cues[0].startTime,q=e.cues[e.cues.length-1].startTime;r.syncInfo={mediaSequence:r.mediaSequence+e.mediaIndex,time:Math.min(O,q-o.duration)}}}handleRollover_(e,i){if(i===null)return e;let r=e*Qr.ONE_SECOND_IN_TS;const o=i*Qr.ONE_SECOND_IN_TS;let c;for(o<r?c=-8589934592:c=8589934592;Math.abs(r-o)>4294967296;)r+=c;return r/Qr.ONE_SECOND_IN_TS}}const ag=function(s,e){const i=s.cues;for(let r=0;r<i.length;r++){const o=i[r];if(e>=o.adStartTime&&e<=o.adEndTime)return o}return null},og=function(s,e,i=0){if(!s.segments)return;let r=i,o;for(let c=0;c<s.segments.length;c++){const f=s.segments[c];if(o||(o=ag(e,r+f.duration/2)),o){if("cueIn"in f){o.endTime=r,o.adEndTime=r,r+=f.duration,o=null;continue}if(r<o.endTime){r+=f.duration;continue}o.endTime+=f.duration}else if("cueOut"in f&&(o=new(ne()).VTTCue(r,r+f.duration,f.cueOut),o.adStartTime=r,o.adEndTime=r+parseFloat(f.cueOut),e.addCue(o)),"cueOutCont"in f){const[y,S]=f.cueOutCont.split("/").map(parseFloat);o=new(ne()).VTTCue(r,r+f.duration,""),o.adStartTime=r-y,o.adEndTime=o.adStartTime+S,e.addCue(o)}r+=f.duration}};class op{constructor({start:e,end:i,segmentIndex:r,partIndex:o=null,appended:c=!1}){this.start_=e,this.end_=i,this.segmentIndex_=r,this.partIndex_=o,this.appended_=c}isInRange(e){return e>=this.start&&e<this.end}markAppended(){this.appended_=!0}resetAppendedStatus(){this.appended_=!1}get isAppended(){return this.appended_}get start(){return this.start_}get end(){return this.end_}get segmentIndex(){return this.segmentIndex_}get partIndex(){return this.partIndex_}}class lg{constructor(e,i=[]){this.segmentSyncInfo_=e,this.partsSyncInfo_=i}get segmentSyncInfo(){return this.segmentSyncInfo_}get partsSyncInfo(){return this.partsSyncInfo_}get hasPartsSyncInfo(){return this.partsSyncInfo_.length>0}resetAppendStatus(){this.segmentSyncInfo_.resetAppendedStatus(),this.partsSyncInfo_.forEach(e=>e.resetAppendedStatus())}}class lp{constructor(){this.storage_=new Map,this.diagnostics_="",this.isReliable_=!1,this.start_=-Infinity,this.end_=Infinity}get start(){return this.start_}get end(){return this.end_}get diagnostics(){return this.diagnostics_}get isReliable(){return this.isReliable_}resetAppendedStatus(){this.storage_.forEach(e=>e.resetAppendStatus())}update(e,i){const{mediaSequence:r,segments:o}=e;if(this.isReliable_=this.isReliablePlaylist_(r,o),!!this.isReliable_)return this.updateStorage_(o,r,this.calculateBaseTime_(r,i))}getSyncInfoForTime(e){for(const{segmentSyncInfo:i,partsSyncInfo:r}of this.storage_.values())if(r.length){for(const o of r)if(o.isInRange(e))return o}else if(i.isInRange(e))return i;return null}getSyncInfoForMediaSequence(e){return this.storage_.get(e)}updateStorage_(e,i,r){const o=new Map;let c=`
`,f=r,y=i;this.start_=f,e.forEach((S,O)=>{const q=this.storage_.get(y),de=f,Te=de+S.duration,Ie=Boolean(q&&q.segmentSyncInfo&&q.segmentSyncInfo.isAppended),ge=new op({start:de,end:Te,appended:Ie,segmentIndex:O});S.syncInfo=ge;let je=f;const Ke=(S.parts||[]).map((Ye,qe)=>{const at=je,ht=je+Ye.duration,Ue=Boolean(q&&q.partsSyncInfo&&q.partsSyncInfo[qe]&&q.partsSyncInfo[qe].isAppended),pt=new op({start:at,end:ht,appended:Ue,segmentIndex:O,partIndex:qe});return je=ht,c+=`Media Sequence: ${y}.${qe} | Range: ${at} --> ${ht} | Appended: ${Ue}
`,Ye.syncInfo=pt,pt});o.set(y,new lg(ge,Ke)),c+=`${Wf(S.resolvedUri)} | Media Sequence: ${y} | Range: ${de} --> ${Te} | Appended: ${Ie}
`,y++,f=Te}),this.end_=f,this.storage_=o,this.diagnostics_=c}calculateBaseTime_(e,i){return this.storage_.size?this.storage_.has(e)?this.storage_.get(e).segmentSyncInfo.start:i:0}isReliablePlaylist_(e,i){return e!=null&&Array.isArray(i)&&i.length}}class up extends lp{constructor(e){super();this.parent_=e}calculateBaseTime_(e,i){if(!this.storage_.size){const r=this.parent_.getSyncInfoForMediaSequence(e);return r?r.segmentSyncInfo.start:0}return super.calculateBaseTime_(e,i)}}const ug=86400,Ch=[{name:"VOD",run:(s,e,i,r,o)=>i!==Infinity?{time:0,segmentIndex:0,partIndex:null}:null},{name:"MediaSequence",run:(s,e,i,r,o,c)=>{const f=s.getMediaSequenceSync(c);if(!f||!f.isReliable)return null;const y=f.getSyncInfoForTime(o);return y?{time:y.start,partIndex:y.partIndex,segmentIndex:y.segmentIndex}:null}},{name:"ProgramDateTime",run:(s,e,i,r,o)=>{if(!Object.keys(s.timelineToDatetimeMappings).length)return null;let c=null,f=null;const y=dh(e);o=o||0;for(let S=0;S<y.length;S++){const O=e.endList||o===0?S:y.length-(S+1),q=y[O],de=q.segment,Te=s.timelineToDatetimeMappings[de.timeline];if(!Te||!de.dateTimeObject)continue;let ge=de.dateTimeObject.getTime()/1e3+Te;if(de.parts&&typeof q.partIndex=="number")for(let Ke=0;Ke<q.partIndex;Ke++)ge+=de.parts[Ke].duration;const je=Math.abs(o-ge);if(f!==null&&(je===0||f<je))break;f=je,c={time:ge,segmentIndex:q.segmentIndex,partIndex:q.partIndex}}return c}},{name:"Segment",run:(s,e,i,r,o)=>{let c=null,f=null;o=o||0;const y=dh(e);for(let S=0;S<y.length;S++){const O=e.endList||o===0?S:y.length-(S+1),q=y[O],de=q.segment,Te=q.part&&q.part.start||de&&de.start;if(de.timeline===r&&typeof Te!="undefined"){const Ie=Math.abs(o-Te);if(f!==null&&f<Ie)break;(!c||f===null||f>=Ie)&&(f=Ie,c={time:Te,segmentIndex:q.segmentIndex,partIndex:q.partIndex})}}return c}},{name:"Discontinuity",run:(s,e,i,r,o)=>{let c=null;if(o=o||0,e.discontinuityStarts&&e.discontinuityStarts.length){let f=null;for(let y=0;y<e.discontinuityStarts.length;y++){const S=e.discontinuityStarts[y],O=e.discontinuitySequence+y+1,q=s.discontinuities[O];if(q){const de=Math.abs(o-q.time);if(f!==null&&f<de)break;(!c||f===null||f>=de)&&(f=de,c={time:q.time,segmentIndex:S,partIndex:null})}}}return c}},{name:"Playlist",run:(s,e,i,r,o)=>e.syncInfo?{time:e.syncInfo.time,segmentIndex:e.syncInfo.mediaSequence-e.mediaSequence,partIndex:null}:null}];class dg extends Re.EventTarget{constructor(e={}){super();this.timelines=[],this.discontinuities=[],this.timelineToDatetimeMappings={};const i=new lp,r=new up(i),o=new up(i);this.mediaSequenceStorage_={main:i,audio:r,vtt:o},this.logger_=St("SyncController")}getMediaSequenceSync(e){return this.mediaSequenceStorage_[e]||null}getSyncPoint(e,i,r,o,c){if(i!==Infinity)return Ch.find(({name:S})=>S==="VOD").run(this,e,i);const f=this.runStrategies_(e,i,r,o,c);if(!f.length)return null;for(const y of f){const{syncPoint:S,strategy:O}=y,{segmentIndex:q,time:de}=S;if(q<0)continue;const Te=e.segments[q],Ie=de,ge=Ie+Te.duration;if(this.logger_(`Strategy: ${O}. Current time: ${o}. selected segment: ${q}. Time: [${Ie} -> ${ge}]}`),o>=Ie&&o<ge)return this.logger_("Found sync point with exact match: ",S),S}return this.selectSyncPoint_(f,{key:"time",value:o})}getExpiredTime(e,i){if(!e||!e.segments)return null;const r=this.runStrategies_(e,i,e.discontinuitySequence,0);if(!r.length)return null;const o=this.selectSyncPoint_(r,{key:"segmentIndex",value:0});return o.segmentIndex>0&&(o.time*=-1),Math.abs(o.time+Pu({defaultDuration:e.targetDuration,durationList:e.segments,startIndex:o.segmentIndex,endIndex:0}))}runStrategies_(e,i,r,o,c){const f=[];for(let y=0;y<Ch.length;y++){const S=Ch[y],O=S.run(this,e,i,r,o,c);O&&(O.strategy=S.name,f.push({strategy:S.name,syncPoint:O}))}return f}selectSyncPoint_(e,i){let r=e[0].syncPoint,o=Math.abs(e[0].syncPoint[i.key]-i.value),c=e[0].strategy;for(let f=1;f<e.length;f++){const y=Math.abs(e[f].syncPoint[i.key]-i.value);y<o&&(o=y,r=e[f].syncPoint,c=e[f].strategy)}return this.logger_(`syncPoint for [${i.key}: ${i.value}] chosen with strategy [${c}]: [time:${r.time}, segmentIndex:${r.segmentIndex}`+(typeof r.partIndex=="number"?`,partIndex:${r.partIndex}`:"")+"]"),r}saveExpiredSegmentInfo(e,i){const r=i.mediaSequence-e.mediaSequence;if(r>ug){Re.log.warn(`Not saving expired segment info. Media sequence gap ${r} is too large.`);return}for(let o=r-1;o>=0;o--){const c=e.segments[o];if(c&&typeof c.start!="undefined"){i.syncInfo={mediaSequence:e.mediaSequence+o,time:c.start},this.logger_(`playlist refresh sync: [time:${i.syncInfo.time}, mediaSequence: ${i.syncInfo.mediaSequence}]`),this.trigger("syncinfoupdate");break}}}setDateTimeMappingForStart(e){if(this.timelineToDatetimeMappings={},e.segments&&e.segments.length&&e.segments[0].dateTimeObject){const i=e.segments[0],r=i.dateTimeObject.getTime()/1e3;this.timelineToDatetimeMappings[i.timeline]=-r}}saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:i}){const r=this.calculateSegmentTimeMapping_(e,e.timingInfo,i),o=e.segment;r&&(this.saveDiscontinuitySyncInfo_(e),e.playlist.syncInfo||(e.playlist.syncInfo={mediaSequence:e.playlist.mediaSequence+e.mediaIndex,time:o.start}));const c=o.dateTimeObject;o.discontinuity&&i&&c&&(this.timelineToDatetimeMappings[o.timeline]=-(c.getTime()/1e3))}timestampOffsetForTimeline(e){return typeof this.timelines[e]=="undefined"?null:this.timelines[e].time}mappingForTimeline(e){return typeof this.timelines[e]=="undefined"?null:this.timelines[e].mapping}calculateSegmentTimeMapping_(e,i,r){const o=e.segment,c=e.part;let f=this.timelines[e.timeline],y,S;if(typeof e.timestampOffset=="number")f={time:e.startOfSegment,mapping:e.startOfSegment-i.start},r&&(this.timelines[e.timeline]=f,this.trigger("timestampoffset"),this.logger_(`time mapping for timeline ${e.timeline}: [time: ${f.time}] [mapping: ${f.mapping}]`)),y=e.startOfSegment,S=i.end+f.mapping;else if(f)y=i.start+f.mapping,S=i.end+f.mapping;else return!1;return c&&(c.start=y,c.end=S),(!o.start||y<o.start)&&(o.start=y),o.end=S,!0}saveDiscontinuitySyncInfo_(e){const i=e.playlist,r=e.segment;if(r.discontinuity)this.discontinuities[r.timeline]={time:r.start,accuracy:0};else if(i.discontinuityStarts&&i.discontinuityStarts.length)for(let o=0;o<i.discontinuityStarts.length;o++){const c=i.discontinuityStarts[o],f=i.discontinuitySequence+o+1,y=c-e.mediaIndex,S=Math.abs(y);if(!this.discontinuities[f]||this.discontinuities[f].accuracy>S){let O;y<0?O=r.start-Pu({defaultDuration:i.targetDuration,durationList:i.segments,startIndex:e.mediaIndex,endIndex:c}):O=r.end+Pu({defaultDuration:i.targetDuration,durationList:i.segments,startIndex:e.mediaIndex+1,endIndex:c}),this.discontinuities[f]={time:O,accuracy:S}}}}dispose(){this.trigger("dispose"),this.off()}}class cg extends Re.EventTarget{constructor(){super();this.pendingTimelineChanges_={},this.lastTimelineChanges_={}}clearPendingTimelineChange(e){this.pendingTimelineChanges_[e]=null,this.trigger("pendingtimelinechange")}pendingTimelineChange({type:e,from:i,to:r}){return typeof i=="number"&&typeof r=="number"&&(this.pendingTimelineChanges_[e]={type:e,from:i,to:r},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[e]}lastTimelineChange({type:e,from:i,to:r}){if(typeof i=="number"&&typeof r=="number"){this.lastTimelineChanges_[e]={type:e,from:i,to:r},delete this.pendingTimelineChanges_[e];const o={timelineChangeInfo:{from:i,to:r}};this.trigger({type:"timelinechange",metadata:o})}return this.lastTimelineChanges_[e]}dispose(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()}}const hg=If(Rf(function(){var s=function(){function je(){this.listeners={}}var Ke=je.prototype;return Ke.on=function(qe,at){this.listeners[qe]||(this.listeners[qe]=[]),this.listeners[qe].push(at)},Ke.off=function(qe,at){if(!this.listeners[qe])return!1;var ht=this.listeners[qe].indexOf(at);return this.listeners[qe]=this.listeners[qe].slice(0),this.listeners[qe].splice(ht,1),ht>-1},Ke.trigger=function(qe){var at=this.listeners[qe];if(!!at)if(arguments.length===2)for(var ht=at.length,Ue=0;Ue<ht;++Ue)at[Ue].call(this,arguments[1]);else for(var pt=Array.prototype.slice.call(arguments,1),Vt=at.length,Bt=0;Bt<Vt;++Bt)at[Bt].apply(this,pt)},Ke.dispose=function(){this.listeners={}},Ke.pipe=function(qe){this.on("data",function(at){qe.push(at)})},je}();/*! @name pkcs7 @version 1.0.4 @license Apache-2.0 */function e(je){return je.subarray(0,je.byteLength-je[je.byteLength-1])}/*! @name aes-decrypter @version 4.0.1 @license Apache-2.0 */const i=function(){const je=[[[],[],[],[],[]],[[],[],[],[],[]]],Ke=je[0],Ye=je[1],qe=Ke[4],at=Ye[4];let ht,Ue,pt;const Vt=[],Bt=[];let yi,ln,Rn,en,Wt,Oi;for(ht=0;ht<256;ht++)Bt[(Vt[ht]=ht<<1^(ht>>7)*283)^ht]=ht;for(Ue=pt=0;!qe[Ue];Ue^=yi||1,pt=Bt[pt]||1)for(en=pt^pt<<1^pt<<2^pt<<3^pt<<4,en=en>>8^en&255^99,qe[Ue]=en,at[en]=Ue,Rn=Vt[ln=Vt[yi=Vt[Ue]]],Oi=Rn*16843009^ln*65537^yi*257^Ue*16843008,Wt=Vt[en]*257^en*16843008,ht=0;ht<4;ht++)Ke[ht][Ue]=Wt=Wt<<24^Wt>>>8,Ye[ht][en]=Oi=Oi<<24^Oi>>>8;for(ht=0;ht<5;ht++)Ke[ht]=Ke[ht].slice(0),Ye[ht]=Ye[ht].slice(0);return je};let r=null;class o{constructor(Ke){r||(r=i()),this._tables=[[r[0][0].slice(),r[0][1].slice(),r[0][2].slice(),r[0][3].slice(),r[0][4].slice()],[r[1][0].slice(),r[1][1].slice(),r[1][2].slice(),r[1][3].slice(),r[1][4].slice()]];let Ye,qe,at;const ht=this._tables[0][4],Ue=this._tables[1],pt=Ke.length;let Vt=1;if(pt!==4&&pt!==6&&pt!==8)throw new Error("Invalid aes key size");const Bt=Ke.slice(0),yi=[];for(this._key=[Bt,yi],Ye=pt;Ye<4*pt+28;Ye++)at=Bt[Ye-1],(Ye%pt==0||pt===8&&Ye%pt==4)&&(at=ht[at>>>24]<<24^ht[at>>16&255]<<16^ht[at>>8&255]<<8^ht[at&255],Ye%pt==0&&(at=at<<8^at>>>24^Vt<<24,Vt=Vt<<1^(Vt>>7)*283)),Bt[Ye]=Bt[Ye-pt]^at;for(qe=0;Ye;qe++,Ye--)at=Bt[qe&3?Ye:Ye-4],Ye<=4||qe<4?yi[qe]=at:yi[qe]=Ue[0][ht[at>>>24]]^Ue[1][ht[at>>16&255]]^Ue[2][ht[at>>8&255]]^Ue[3][ht[at&255]]}decrypt(Ke,Ye,qe,at,ht,Ue){const pt=this._key[1];let Vt=Ke^pt[0],Bt=at^pt[1],yi=qe^pt[2],ln=Ye^pt[3],Rn,en,Wt;const Oi=pt.length/4-2;let zr,la=4;const $a=this._tables[1],_o=$a[0],bo=$a[1],xo=$a[2],Eo=$a[3],To=$a[4];for(zr=0;zr<Oi;zr++)Rn=_o[Vt>>>24]^bo[Bt>>16&255]^xo[yi>>8&255]^Eo[ln&255]^pt[la],en=_o[Bt>>>24]^bo[yi>>16&255]^xo[ln>>8&255]^Eo[Vt&255]^pt[la+1],Wt=_o[yi>>>24]^bo[ln>>16&255]^xo[Vt>>8&255]^Eo[Bt&255]^pt[la+2],ln=_o[ln>>>24]^bo[Vt>>16&255]^xo[Bt>>8&255]^Eo[yi&255]^pt[la+3],la+=4,Vt=Rn,Bt=en,yi=Wt;for(zr=0;zr<4;zr++)ht[(3&-zr)+Ue]=To[Vt>>>24]<<24^To[Bt>>16&255]<<16^To[yi>>8&255]<<8^To[ln&255]^pt[la++],Rn=Vt,Vt=Bt,Bt=yi,yi=ln,ln=Rn}}class c extends s{constructor(){super(s);this.jobs=[],this.delay=1,this.timeout_=null}processJob_(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null}push(Ke){this.jobs.push(Ke),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))}}const f=function(je){return je<<24|(je&65280)<<8|(je&16711680)>>8|je>>>24},y=function(je,Ke,Ye){const qe=new Int32Array(je.buffer,je.byteOffset,je.byteLength>>2),at=new o(Array.prototype.slice.call(Ke)),ht=new Uint8Array(je.byteLength),Ue=new Int32Array(ht.buffer);let pt,Vt,Bt,yi,ln,Rn,en,Wt,Oi;for(pt=Ye[0],Vt=Ye[1],Bt=Ye[2],yi=Ye[3],Oi=0;Oi<qe.length;Oi+=4)ln=f(qe[Oi]),Rn=f(qe[Oi+1]),en=f(qe[Oi+2]),Wt=f(qe[Oi+3]),at.decrypt(ln,Rn,en,Wt,Ue,Oi),Ue[Oi]=f(Ue[Oi]^pt),Ue[Oi+1]=f(Ue[Oi+1]^Vt),Ue[Oi+2]=f(Ue[Oi+2]^Bt),Ue[Oi+3]=f(Ue[Oi+3]^yi),pt=ln,Vt=Rn,Bt=en,yi=Wt;return ht};class S{constructor(Ke,Ye,qe,at){const ht=S.STEP,Ue=new Int32Array(Ke.buffer),pt=new Uint8Array(Ke.byteLength);let Vt=0;for(this.asyncStream_=new c,this.asyncStream_.push(this.decryptChunk_(Ue.subarray(Vt,Vt+ht),Ye,qe,pt)),Vt=ht;Vt<Ue.length;Vt+=ht)qe=new Uint32Array([f(Ue[Vt-4]),f(Ue[Vt-3]),f(Ue[Vt-2]),f(Ue[Vt-1])]),this.asyncStream_.push(this.decryptChunk_(Ue.subarray(Vt,Vt+ht),Ye,qe,pt));this.asyncStream_.push(function(){at(null,e(pt))})}static get STEP(){return 32e3}decryptChunk_(Ke,Ye,qe,at){return function(){const ht=y(Ke,Ye,qe);at.set(ht,Ke.byteOffset)}}}var O=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof mt.g!="undefined"?mt.g:typeof self!="undefined"?self:{},q;typeof window!="undefined"?q=window:typeof O!="undefined"?q=O:typeof self!="undefined"?q=self:q={};var de=q,Te=function(Ke){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(Ke):Ke&&Ke.buffer instanceof ArrayBuffer},Ie=de.BigInt||Number;Ie("0x1"),Ie("0x100"),Ie("0x10000"),Ie("0x1000000"),Ie("0x100000000"),Ie("0x10000000000"),Ie("0x1000000000000"),Ie("0x100000000000000"),Ie("0x10000000000000000"),function(){var je=new Uint16Array([65484]),Ke=new Uint8Array(je.buffer,je.byteOffset,je.byteLength);return Ke[0]===255?"big":Ke[0]===204?"little":"unknown"}();const ge=function(je){const Ke={};return Object.keys(je).forEach(Ye=>{const qe=je[Ye];Te(qe)?Ke[Ye]={bytes:qe.buffer,byteOffset:qe.byteOffset,byteLength:qe.byteLength}:Ke[Ye]=qe}),Ke};self.onmessage=function(je){const Ke=je.data,Ye=new Uint8Array(Ke.encrypted.bytes,Ke.encrypted.byteOffset,Ke.encrypted.byteLength),qe=new Uint32Array(Ke.key.bytes,Ke.key.byteOffset,Ke.key.byteLength/4),at=new Uint32Array(Ke.iv.bytes,Ke.iv.byteOffset,Ke.iv.byteLength/4);new S(Ye,qe,at,function(ht,Ue){self.postMessage(ge({source:Ke.source,decrypted:Ue}),[Ue.buffer])})}}));var fg=kf(hg);const pg=s=>{let e=s.default?"main":"alternative";return s.characteristics&&s.characteristics.indexOf("public.accessibility.describes-video")>=0&&(e="main-desc"),e},dp=(s,e)=>{s.abort(),s.pause(),e&&e.activePlaylistLoader&&(e.activePlaylistLoader.pause(),e.activePlaylistLoader=null)},wh=(s,e)=>{e.activePlaylistLoader=s,s.load()},mg=(s,e)=>()=>{const{segmentLoaders:{[s]:i,main:r},mediaTypes:{[s]:o}}=e,c=o.activeTrack(),f=o.getActiveGroup(),y=o.activePlaylistLoader,S=o.lastGroup_;if(!(f&&S&&f.id===S.id)&&(o.lastGroup_=f,o.lastTrack_=c,dp(i,o),!(!f||f.isMainPlaylist))){if(!f.playlistLoader){y&&r.resetEverything();return}i.resyncLoader(),wh(f.playlistLoader,o)}},gg=(s,e)=>()=>{const{segmentLoaders:{[s]:i},mediaTypes:{[s]:r}}=e;r.lastGroup_=null,i.abort(),i.pause()},yg=(s,e)=>()=>{const{mainPlaylistLoader:i,segmentLoaders:{[s]:r,main:o},mediaTypes:{[s]:c}}=e,f=c.activeTrack(),y=c.getActiveGroup(),S=c.activePlaylistLoader,O=c.lastTrack_;if(!(O&&f&&O.id===f.id)&&(c.lastGroup_=y,c.lastTrack_=f,dp(r,c),!!y)){if(y.isMainPlaylist){if(!f||!O||f.id===O.id)return;const q=e.vhs.playlistController_,de=q.selectPlaylist();if(q.media()===de)return;c.logger_(`track change. Switching main audio from ${O.id} to ${f.id}`),i.pause(),o.resetEverything(),q.fastQualityChange_(de);return}if(s==="AUDIO"){if(!y.playlistLoader){o.setAudio(!0),o.resetEverything();return}r.setAudio(!0),o.setAudio(!1)}if(S===y.playlistLoader){wh(y.playlistLoader,c);return}r.track&&r.track(f),r.resetEverything(),wh(y.playlistLoader,c)}},ac={AUDIO:(s,e)=>()=>{const{mediaTypes:{[s]:i},excludePlaylist:r}=e,o=i.activeTrack(),c=i.activeGroup(),f=(c.filter(S=>S.default)[0]||c[0]).id,y=i.tracks[f];if(o===y){r({error:{message:"Problem encountered loading the default audio track."}});return}Re.log.warn("Problem encountered loading the alternate audio track.Switching back to default.");for(const S in i.tracks)i.tracks[S].enabled=i.tracks[S]===y;i.onTrackChanged()},SUBTITLES:(s,e)=>()=>{const{mediaTypes:{[s]:i}}=e;Re.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track.");const r=i.activeTrack();r&&(r.mode="disabled"),i.onTrackChanged()}},cp={AUDIO:(s,e,i)=>{if(!e)return;const{tech:r,requestOptions:o,segmentLoaders:{[s]:c}}=i;e.on("loadedmetadata",()=>{const f=e.media();c.playlist(f,o),(!r.paused()||f.endList&&r.preload()!=="none")&&c.load()}),e.on("loadedplaylist",()=>{c.playlist(e.media(),o),r.paused()||c.load()}),e.on("error",ac[s](s,i))},SUBTITLES:(s,e,i)=>{const{tech:r,requestOptions:o,segmentLoaders:{[s]:c},mediaTypes:{[s]:f}}=i;e.on("loadedmetadata",()=>{const y=e.media();c.playlist(y,o),c.track(f.activeTrack()),(!r.paused()||y.endList&&r.preload()!=="none")&&c.load()}),e.on("loadedplaylist",()=>{c.playlist(e.media(),o),r.paused()||c.load()}),e.on("error",ac[s](s,i))}},vg={AUDIO:(s,e)=>{const{vhs:i,sourceType:r,segmentLoaders:{[s]:o},requestOptions:c,main:{mediaGroups:f},mediaTypes:{[s]:{groups:y,tracks:S,logger_:O}},mainPlaylistLoader:q}=e,de=Ou(q.main);(!f[s]||Object.keys(f[s]).length===0)&&(f[s]={main:{default:{default:!0}}},de&&(f[s].main.default.playlists=q.main.playlists));for(const Te in f[s]){y[Te]||(y[Te]=[]);for(const Ie in f[s][Te]){let ge=f[s][Te][Ie],je;if(de?(O(`AUDIO group '${Te}' label '${Ie}' is a main playlist`),ge.isMainPlaylist=!0,je=null):r==="vhs-json"&&ge.playlists?je=new El(ge.playlists[0],i,c):ge.resolvedUri?je=new El(ge.resolvedUri,i,c):ge.playlists&&r==="dash"?je=new Ah(ge.playlists[0],i,c,q):je=null,ge=$t({id:Ie,playlistLoader:je},ge),cp[s](s,ge.playlistLoader,e),y[Te].push(ge),typeof S[Ie]=="undefined"){const Ke=new Re.AudioTrack({id:Ie,kind:pg(ge),enabled:!1,language:ge.language,default:ge.default,label:Ie});S[Ie]=Ke}}}o.on("error",ac[s](s,e))},SUBTITLES:(s,e)=>{const{tech:i,vhs:r,sourceType:o,segmentLoaders:{[s]:c},requestOptions:f,main:{mediaGroups:y},mediaTypes:{[s]:{groups:S,tracks:O}},mainPlaylistLoader:q}=e;for(const de in y[s]){S[de]||(S[de]=[]);for(const Te in y[s][de]){if(!r.options_.useForcedSubtitles&&y[s][de][Te].forced)continue;let Ie=y[s][de][Te],ge;if(o==="hls")ge=new El(Ie.resolvedUri,r,f);else if(o==="dash"){if(!Ie.playlists.filter(Ke=>Ke.excludeUntil!==Infinity).length)return;ge=new Ah(Ie.playlists[0],r,f,q)}else o==="vhs-json"&&(ge=new El(Ie.playlists?Ie.playlists[0]:Ie.resolvedUri,r,f));if(Ie=$t({id:Te,playlistLoader:ge},Ie),cp[s](s,Ie.playlistLoader,e),S[de].push(Ie),typeof O[Te]=="undefined"){const je=i.addRemoteTextTrack({id:Te,kind:"subtitles",default:Ie.default&&Ie.autoselect,language:Ie.language,label:Te},!1).track;O[Te]=je}}}c.on("error",ac[s](s,e))},"CLOSED-CAPTIONS":(s,e)=>{const{tech:i,main:{mediaGroups:r},mediaTypes:{[s]:{groups:o,tracks:c}}}=e;for(const f in r[s]){o[f]||(o[f]=[]);for(const y in r[s][f]){const S=r[s][f][y];if(!/^(?:CC|SERVICE)/.test(S.instreamId))continue;const O=i.options_.vhs&&i.options_.vhs.captionServices||{};let q={label:y,language:S.language,instreamId:S.instreamId,default:S.default&&S.autoselect};if(O[q.instreamId]&&(q=$t(q,O[q.instreamId])),q.default===void 0&&delete q.default,o[f].push($t({id:y},S)),typeof c[y]=="undefined"){const de=i.addRemoteTextTrack({id:q.instreamId,kind:"captions",default:q.default,language:q.language,label:q.label},!1).track;c[y]=de}}}}},hp=(s,e)=>{for(let i=0;i<s.length;i++)if(fh(e,s[i])||s[i].playlists&&hp(s[i].playlists,e))return!0;return!1},Ag=(s,e)=>i=>{const{mainPlaylistLoader:r,mediaTypes:{[s]:{groups:o}}}=e,c=r.media();if(!c)return null;let f=null;c.attributes[s]&&(f=o[c.attributes[s]]);const y=Object.keys(o);if(!f)if(s==="AUDIO"&&y.length>1&&Ou(e.main))for(let S=0;S<y.length;S++){const O=o[y[S]];if(hp(O,c)){f=O;break}}else o.main?f=o.main:y.length===1&&(f=o[y[0]]);return typeof i=="undefined"?f:i===null||!f?null:f.filter(S=>S.id===i.id)[0]||null},_g={AUDIO:(s,e)=>()=>{const{mediaTypes:{[s]:{tracks:i}}}=e;for(const r in i)if(i[r].enabled)return i[r];return null},SUBTITLES:(s,e)=>()=>{const{mediaTypes:{[s]:{tracks:i}}}=e;for(const r in i)if(i[r].mode==="showing"||i[r].mode==="hidden")return i[r];return null}},bg=(s,{mediaTypes:e})=>()=>{const i=e[s].activeTrack();return i?e[s].activeGroup(i):null},xg=s=>{["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(O=>{vg[O](O,s)});const{mediaTypes:e,mainPlaylistLoader:i,tech:r,vhs:o,segmentLoaders:{["AUDIO"]:c,main:f}}=s;["AUDIO","SUBTITLES"].forEach(O=>{e[O].activeGroup=Ag(O,s),e[O].activeTrack=_g[O](O,s),e[O].onGroupChanged=mg(O,s),e[O].onGroupChanging=gg(O,s),e[O].onTrackChanged=yg(O,s),e[O].getActiveGroup=bg(O,s)});const y=e.AUDIO.activeGroup();if(y){const O=(y.filter(de=>de.default)[0]||y[0]).id;e.AUDIO.tracks[O].enabled=!0,e.AUDIO.onGroupChanged(),e.AUDIO.onTrackChanged(),e.AUDIO.getActiveGroup().playlistLoader?(f.setAudio(!1),c.setAudio(!0)):f.setAudio(!0)}i.on("mediachange",()=>{["AUDIO","SUBTITLES"].forEach(O=>e[O].onGroupChanged())}),i.on("mediachanging",()=>{["AUDIO","SUBTITLES"].forEach(O=>e[O].onGroupChanging())});const S=()=>{e.AUDIO.onTrackChanged(),r.trigger({type:"usage",name:"vhs-audio-change"})};r.audioTracks().addEventListener("change",S),r.remoteTextTracks().addEventListener("change",e.SUBTITLES.onTrackChanged),o.on("dispose",()=>{r.audioTracks().removeEventListener("change",S),r.remoteTextTracks().removeEventListener("change",e.SUBTITLES.onTrackChanged)}),r.clearTracks("audio");for(const O in e.AUDIO.tracks)r.audioTracks().addTrack(e.AUDIO.tracks[O])},Eg=()=>{const s={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(e=>{s[e]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:aa,activeTrack:aa,getActiveGroup:aa,onGroupChanged:aa,onTrackChanged:aa,lastTrack_:null,logger_:St(`MediaGroups[${e}]`)}}),s};class fp{constructor(){this.priority_=[],this.pathwayClones_=new Map}set version(e){e===1&&(this.version_=e)}set ttl(e){this.ttl_=e||300}set reloadUri(e){e&&(this.reloadUri_=li(this.reloadUri_,e))}set priority(e){e&&e.length&&(this.priority_=e)}set pathwayClones(e){e&&e.length&&(this.pathwayClones_=new Map(e.map(i=>[i.ID,i])))}get version(){return this.version_}get ttl(){return this.ttl_}get reloadUri(){return this.reloadUri_}get priority(){return this.priority_}get pathwayClones(){return this.pathwayClones_}}class Tg extends Re.EventTarget{constructor(e,i){super();this.currentPathway=null,this.defaultPathway=null,this.queryBeforeStart=!1,this.availablePathways_=new Set,this.steeringManifest=new fp,this.proxyServerUrl_=null,this.manifestType_=null,this.ttlTimeout_=null,this.request_=null,this.currentPathwayClones=new Map,this.nextPathwayClones=new Map,this.excludedSteeringManifestURLs=new Set,this.logger_=St("Content Steering"),this.xhr_=e,this.getBandwidth_=i}assignTagProperties(e,i){this.manifestType_=i.serverUri?"HLS":"DASH";const r=i.serverUri||i.serverURL;if(!r){this.logger_(`steering manifest URL is ${r}, cannot request steering manifest.`),this.trigger("error");return}if(r.startsWith("data:")){this.decodeDataUriManifest_(r.substring(r.indexOf(",")+1));return}this.steeringManifest.reloadUri=li(e,r),this.defaultPathway=i.pathwayId||i.defaultServiceLocation,this.queryBeforeStart=i.queryBeforeStart,this.proxyServerUrl_=i.proxyServerURL,this.defaultPathway&&!this.queryBeforeStart&&this.trigger("content-steering")}requestSteeringManifest(e){const i=this.steeringManifest.reloadUri;if(!i)return;const r=e?i:this.getRequestURI(i);if(!r){this.logger_("No valid content steering manifest URIs. Stopping content steering."),this.trigger("error"),this.dispose();return}const o={contentSteeringInfo:{uri:r}};this.trigger({type:"contentsteeringloadstart",metadata:o}),this.request_=this.xhr_({uri:r,requestType:"content-steering-manifest"},(c,f)=>{if(c){if(f.status===410){this.logger_(`manifest request 410 ${c}.`),this.logger_(`There will be no more content steering requests to ${r} this session.`),this.excludedSteeringManifestURLs.add(r);return}if(f.status===429){const O=f.responseHeaders["retry-after"];this.logger_(`manifest request 429 ${c}.`),this.logger_(`content steering will retry in ${O} seconds.`),this.startTTLTimeout_(parseInt(O,10));return}this.logger_(`manifest failed to load ${c}.`),this.startTTLTimeout_();return}this.trigger({type:"contentsteeringloadcomplete",metadata:o});let y;try{y=JSON.parse(this.request_.responseText)}catch(O){const q={errorType:Re.Error.StreamingContentSteeringParserError,error:O};this.trigger({type:"error",metadata:q})}this.assignSteeringProperties_(y);const S={contentSteeringInfo:o.contentSteeringInfo,contentSteeringManifest:{version:this.steeringManifest.version,reloadUri:this.steeringManifest.reloadUri,priority:this.steeringManifest.priority}};this.trigger({type:"contentsteeringparsed",metadata:S}),this.startTTLTimeout_()})}setProxyServerUrl_(e){const i=new(ne()).URL(e),r=new(ne()).URL(this.proxyServerUrl_);return r.searchParams.set("url",encodeURI(i.toString())),this.setSteeringParams_(r.toString())}decodeDataUriManifest_(e){const i=JSON.parse(ne().atob(e));this.assignSteeringProperties_(i)}setSteeringParams_(e){const i=new(ne()).URL(e),r=this.getPathway(),o=this.getBandwidth_();if(r){const c=`_${this.manifestType_}_pathway`;i.searchParams.set(c,r)}if(o){const c=`_${this.manifestType_}_throughput`;i.searchParams.set(c,o)}return i.toString()}assignSteeringProperties_(e){if(this.steeringManifest.version=e.VERSION,!this.steeringManifest.version){this.logger_(`manifest version is ${e.VERSION}, which is not supported.`),this.trigger("error");return}this.steeringManifest.ttl=e.TTL,this.steeringManifest.reloadUri=e["RELOAD-URI"],this.steeringManifest.priority=e["PATHWAY-PRIORITY"]||e["SERVICE-LOCATION-PRIORITY"],this.steeringManifest.pathwayClones=e["PATHWAY-CLONES"],this.nextPathwayClones=this.steeringManifest.pathwayClones,this.availablePathways_.size||(this.logger_("There are no available pathways for content steering. Ending content steering."),this.trigger("error"),this.dispose());const r=(o=>{for(const c of o)if(this.availablePathways_.has(c))return c;return[...this.availablePathways_][0]})(this.steeringManifest.priority);this.currentPathway!==r&&(this.currentPathway=r,this.trigger("content-steering"))}getPathway(){return this.currentPathway||this.defaultPathway}getRequestURI(e){if(!e)return null;const i=o=>this.excludedSteeringManifestURLs.has(o);if(this.proxyServerUrl_){const o=this.setProxyServerUrl_(e);if(!i(o))return o}const r=this.setSteeringParams_(e);return i(r)?null:r}startTTLTimeout_(e=this.steeringManifest.ttl){const i=e*1e3;this.ttlTimeout_=ne().setTimeout(()=>{this.requestSteeringManifest()},i)}clearTTLTimeout_(){ne().clearTimeout(this.ttlTimeout_),this.ttlTimeout_=null}abort(){this.request_&&this.request_.abort(),this.request_=null}dispose(){this.off("content-steering"),this.off("error"),this.abort(),this.clearTTLTimeout_(),this.currentPathway=null,this.defaultPathway=null,this.queryBeforeStart=null,this.proxyServerUrl_=null,this.manifestType_=null,this.ttlTimeout_=null,this.request_=null,this.excludedSteeringManifestURLs=new Set,this.availablePathways_=new Set,this.steeringManifest=new fp}addAvailablePathway(e){e&&this.availablePathways_.add(e)}clearAvailablePathways(){this.availablePathways_.clear()}excludePathway(e){return this.availablePathways_.delete(e)}didDASHTagChange(e,i){return!i&&this.steeringManifest.reloadUri||i&&(li(e,i.serverURL)!==this.steeringManifest.reloadUri||i.defaultServiceLocation!==this.defaultPathway||i.queryBeforeStart!==this.queryBeforeStart||i.proxyServerURL!==this.proxyServerUrl_)}getAvailablePathways(){return this.availablePathways_}}const Sg=10;let oa;const Cg=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred","mediaAppends"],wg=function(s){return this.audioSegmentLoader_[s]+this.mainSegmentLoader_[s]},Lg=function({currentPlaylist:s,buffered:e,currentTime:i,nextPlaylist:r,bufferLowWaterLine:o,bufferHighWaterLine:c,duration:f,bufferBasedABR:y,log:S}){if(!r)return Re.log.warn("We received no playlist to switch to. Please check your stream."),!1;const O=`allowing switch ${s&&s.id||"null"} -> ${r.id}`;if(!s)return S(`${O} as current playlist is not set`),!0;if(r.id===s.id)return!1;const q=Boolean(xn(e,i).length);if(!s.endList)return!q&&typeof s.partTargetDuration=="number"?(S(`not ${O} as current playlist is live llhls, but currentTime isn't in buffered.`),!1):(S(`${O} as current playlist is live`),!0);const de=lh(e,i),Te=y?In.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:In.MAX_BUFFER_LOW_WATER_LINE;if(f<Te)return S(`${O} as duration < max low water line (${f} < ${Te})`),!0;const Ie=r.attributes.BANDWIDTH,ge=s.attributes.BANDWIDTH;if(Ie<ge&&(!y||de<c)){let je=`${O} as next bandwidth < current bandwidth (${Ie} < ${ge})`;return y&&(je+=` and forwardBuffer < bufferHighWaterLine (${de} < ${c})`),S(je),!0}if((!y||Ie>ge)&&de>=o){let je=`${O} as forwardBuffer >= bufferLowWaterLine (${de} >= ${o})`;return y&&(je+=` and next bandwidth > current bandwidth (${Ie} > ${ge})`),S(je),!0}return S(`not ${O} as no switching criteria met`),!1};class Dg extends Re.EventTarget{constructor(e){super();const{src:i,withCredentials:r,tech:o,bandwidth:c,externVhs:f,useCueTags:y,playlistExclusionDuration:S,enableLowInitialPlaylist:O,sourceType:q,cacheEncryptionKeys:de,bufferBasedABR:Te,leastPixelDiffSelector:Ie,captionServices:ge}=e;if(!i)throw new Error("A non-empty playlist URL or JSON manifest string is required");let{maxPlaylistRetries:je}=e;(je===null||typeof je=="undefined")&&(je=Infinity),oa=f,this.bufferBasedABR=Boolean(Te),this.leastPixelDiffSelector=Boolean(Ie),this.withCredentials=r,this.tech_=o,this.vhs_=o.vhs,this.player_=e.player_,this.sourceType_=q,this.useCueTags_=y,this.playlistExclusionDuration=S,this.maxPlaylistRetries=je,this.enableLowInitialPlaylist=O,this.useCueTags_&&(this.cueTagsTrack_=this.tech_.addTextTrack("metadata","ad-cues"),this.cueTagsTrack_.inBandMetadataTrackDispatchType=""),this.requestOptions_={withCredentials:r,maxPlaylistRetries:je,timeout:null},this.on("error",this.pauseLoading),this.mediaTypes_=Eg(),this.mediaSource=new(ne()).MediaSource,this.handleDurationChange_=this.handleDurationChange_.bind(this),this.handleSourceOpen_=this.handleSourceOpen_.bind(this),this.handleSourceEnded_=this.handleSourceEnded_.bind(this),this.mediaSource.addEventListener("durationchange",this.handleDurationChange_),this.mediaSource.addEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.addEventListener("sourceended",this.handleSourceEnded_),this.seekable_=zt(),this.hasPlayed_=!1,this.syncController_=new dg(e),this.segmentMetadataTrack_=o.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,this.decrypter_=new fg,this.sourceUpdater_=new rp(this.mediaSource),this.inbandTextTracks_={},this.timelineChangeController_=new cg,this.keyStatusMap_=new Map;const Ke={vhs:this.vhs_,parse708captions:e.parse708captions,useDtsForTimestampOffset:e.useDtsForTimestampOffset,captionServices:ge,mediaSource:this.mediaSource,currentTime:this.tech_.currentTime.bind(this.tech_),seekable:()=>this.seekable(),seeking:()=>this.tech_.seeking(),duration:()=>this.duration(),hasPlayed:()=>this.hasPlayed_,goalBufferLength:()=>this.goalBufferLength(),bandwidth:c,syncController:this.syncController_,decrypter:this.decrypter_,sourceType:this.sourceType_,inbandTextTracks:this.inbandTextTracks_,cacheEncryptionKeys:de,sourceUpdater:this.sourceUpdater_,timelineChangeController:this.timelineChangeController_,exactManifestTimings:e.exactManifestTimings,addMetadataToTextTrack:this.addMetadataToTextTrack.bind(this)};this.mainPlaylistLoader_=this.sourceType_==="dash"?new Ah(i,this.vhs_,$t(this.requestOptions_,{addMetadataToTextTrack:this.addMetadataToTextTrack.bind(this)})):new El(i,this.vhs_,$t(this.requestOptions_,{addDateRangesToTextTrack:this.addDateRangesToTextTrack_.bind(this)})),this.setupMainPlaylistLoaderListeners_(),this.mainSegmentLoader_=new Th($t(Ke,{segmentMetadataTrack:this.segmentMetadataTrack_,loaderType:"main"}),e),this.audioSegmentLoader_=new Th($t(Ke,{loaderType:"audio"}),e),this.subtitleSegmentLoader_=new sg($t(Ke,{loaderType:"vtt",featuresNativeTextTracks:this.tech_.featuresNativeTextTracks,loadVttJs:()=>new Promise((at,ht)=>{function Ue(){o.off("vttjserror",pt),at()}function pt(){o.off("vttjsloaded",Ue),ht()}o.one("vttjsloaded",Ue),o.one("vttjserror",pt),o.addWebVttScript_()})}),e);const Ye=()=>this.mainSegmentLoader_.bandwidth;this.contentSteeringController_=new Tg(this.vhs_.xhr,Ye),this.setupSegmentLoaderListeners_(),this.bufferBasedABR&&(this.mainPlaylistLoader_.one("loadedplaylist",()=>this.startABRTimer_()),this.tech_.on("pause",()=>this.stopABRTimer_()),this.tech_.on("play",()=>this.startABRTimer_())),Cg.forEach(at=>{this[at+"_"]=wg.bind(this,at)}),this.logger_=St("pc"),this.triggeredFmp4Usage=!1,this.tech_.preload()==="none"?(this.loadOnPlay_=()=>{this.loadOnPlay_=null,this.mainPlaylistLoader_.load()},this.tech_.one("play",this.loadOnPlay_)):this.mainPlaylistLoader_.load(),this.timeToLoadedData__=-1,this.mainAppendsToLoadedData__=-1,this.audioAppendsToLoadedData__=-1;const qe=this.tech_.preload()==="none"?"play":"loadstart";this.tech_.one(qe,()=>{const at=Date.now();this.tech_.one("loadeddata",()=>{this.timeToLoadedData__=Date.now()-at,this.mainAppendsToLoadedData__=this.mainSegmentLoader_.mediaAppends,this.audioAppendsToLoadedData__=this.audioSegmentLoader_.mediaAppends})})}mainAppendsToLoadedData_(){return this.mainAppendsToLoadedData__}audioAppendsToLoadedData_(){return this.audioAppendsToLoadedData__}appendsToLoadedData_(){const e=this.mainAppendsToLoadedData_(),i=this.audioAppendsToLoadedData_();return e===-1||i===-1?-1:e+i}timeToLoadedData_(){return this.timeToLoadedData__}checkABR_(e="abr"){const i=this.selectPlaylist();i&&this.shouldSwitchToMedia_(i)&&this.switchMedia_(i,e)}switchMedia_(e,i,r){const o=this.media(),c=o&&(o.id||o.uri),f=e&&(e.id||e.uri);if(c&&c!==f){this.logger_(`switch media ${c} -> ${f} from ${i}`);const y={renditionInfo:{id:f,bandwidth:e.attributes.BANDWIDTH,resolution:e.attributes.RESOLUTION,codecs:e.attributes.CODECS},cause:i};this.trigger({type:"renditionselected",metadata:y}),this.tech_.trigger({type:"usage",name:`vhs-rendition-change-${i}`})}this.mainPlaylistLoader_.media(e,r)}switchMediaForDASHContentSteering_(){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(e=>{const i=this.mediaTypes_[e],r=i?i.activeGroup():null,o=this.contentSteeringController_.getPathway();if(r&&o){const f=(r.length?r[0].playlists:r.playlists).filter(y=>y.attributes.serviceLocation===o);f.length&&this.mediaTypes_[e].activePlaylistLoader.media(f[0])}})}startABRTimer_(){this.stopABRTimer_(),this.abrTimer_=ne().setInterval(()=>this.checkABR_(),250)}stopABRTimer_(){this.tech_.scrubbing&&this.tech_.scrubbing()||(ne().clearInterval(this.abrTimer_),this.abrTimer_=null)}getAudioTrackPlaylists_(){const e=this.main(),i=e&&e.playlists||[];if(!e||!e.mediaGroups||!e.mediaGroups.AUDIO)return i;const r=e.mediaGroups.AUDIO,o=Object.keys(r);let c;if(Object.keys(this.mediaTypes_.AUDIO.groups).length)c=this.mediaTypes_.AUDIO.activeTrack();else{const y=r.main||o.length&&r[o[0]];for(const S in y)if(y[S].default){c={label:S};break}}if(!c)return i;const f=[];for(const y in r)if(r[y][c.label]){const S=r[y][c.label];if(S.playlists&&S.playlists.length)f.push.apply(f,S.playlists);else if(S.uri)f.push(S);else if(e.playlists.length)for(let O=0;O<e.playlists.length;O++){const q=e.playlists[O];q.attributes&&q.attributes.AUDIO&&q.attributes.AUDIO===y&&f.push(q)}}return f.length?f:i}setupMainPlaylistLoaderListeners_(){this.mainPlaylistLoader_.on("loadedmetadata",()=>{const i=this.mainPlaylistLoader_.media(),r=i.targetDuration*1.5*1e3;hh(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=r,i.endList&&this.tech_.preload()!=="none"&&(this.mainSegmentLoader_.playlist(i,this.requestOptions_),this.mainSegmentLoader_.load()),xg({sourceType:this.sourceType_,segmentLoaders:{AUDIO:this.audioSegmentLoader_,SUBTITLES:this.subtitleSegmentLoader_,main:this.mainSegmentLoader_},tech:this.tech_,requestOptions:this.requestOptions_,mainPlaylistLoader:this.mainPlaylistLoader_,vhs:this.vhs_,main:this.main(),mediaTypes:this.mediaTypes_,excludePlaylist:this.excludePlaylist.bind(this)}),this.triggerPresenceUsage_(this.main(),i),this.setupFirstPlay(),!this.mediaTypes_.AUDIO.activePlaylistLoader||this.mediaTypes_.AUDIO.activePlaylistLoader.media()?this.trigger("selectedinitialmedia"):this.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",()=>{this.trigger("selectedinitialmedia")})}),this.mainPlaylistLoader_.on("loadedplaylist",()=>{this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_);let i=this.mainPlaylistLoader_.media();if(!i){this.attachContentSteeringListeners_(),this.initContentSteeringController_(),this.excludeUnsupportedVariants_();let r;if(this.enableLowInitialPlaylist&&(r=this.selectInitialPlaylist()),r||(r=this.selectPlaylist()),!r||!this.shouldSwitchToMedia_(r)||(this.initialMedia_=r,this.switchMedia_(this.initialMedia_,"initial"),!(this.sourceType_==="vhs-json"&&this.initialMedia_.segments)))return;i=this.initialMedia_}this.handleUpdatedMediaPlaylist(i)}),this.mainPlaylistLoader_.on("error",()=>{const i=this.mainPlaylistLoader_.error;this.excludePlaylist({playlistToExclude:i.playlist,error:i})}),this.mainPlaylistLoader_.on("mediachanging",()=>{this.mainSegmentLoader_.abort(),this.mainSegmentLoader_.pause()}),this.mainPlaylistLoader_.on("mediachange",()=>{const i=this.mainPlaylistLoader_.media(),r=i.targetDuration*1.5*1e3;hh(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=r,this.sourceType_==="dash"&&this.mainPlaylistLoader_.load(),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.playlist(i,this.requestOptions_),this.waitingForFastQualityPlaylistReceived_?this.runFastQualitySwitch_():this.mainSegmentLoader_.load(),this.tech_.trigger({type:"mediachange",bubbles:!0})}),this.mainPlaylistLoader_.on("playlistunchanged",()=>{const i=this.mainPlaylistLoader_.media();if(i.lastExcludeReason_==="playlist-unchanged")return;this.stuckAtPlaylistEnd_(i)&&(this.excludePlaylist({error:{message:"Playlist no longer updating.",reason:"playlist-unchanged"}}),this.tech_.trigger("playliststuck"))}),this.mainPlaylistLoader_.on("renditiondisabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"})}),this.mainPlaylistLoader_.on("renditionenabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"})}),["manifestrequeststart","manifestrequestcomplete","manifestparsestart","manifestparsecomplete","playlistrequeststart","playlistrequestcomplete","playlistparsestart","playlistparsecomplete","renditiondisabled","renditionenabled"].forEach(i=>{this.mainPlaylistLoader_.on(i,r=>{this.player_.trigger((0,Y.Z)({},r))})})}handleUpdatedMediaPlaylist(e){this.useCueTags_&&this.updateAdCues_(e),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.waitingForFastQualityPlaylistReceived_&&this.runFastQualitySwitch_(),this.updateDuration(!e.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())}triggerPresenceUsage_(e,i){const r=e.mediaGroups||{};let o=!0;const c=Object.keys(r.AUDIO);for(const f in r.AUDIO)for(const y in r.AUDIO[f])r.AUDIO[f][y].uri||(o=!1);o&&this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),Object.keys(r.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),oa.Playlist.isAes(i)&&this.tech_.trigger({type:"usage",name:"vhs-aes"}),c.length&&Object.keys(r.AUDIO[c[0]]).length>1&&this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"})}shouldSwitchToMedia_(e){const i=this.mainPlaylistLoader_.media()||this.mainPlaylistLoader_.pendingMedia_,r=this.tech_.currentTime(),o=this.bufferLowWaterLine(),c=this.bufferHighWaterLine(),f=this.tech_.buffered();return Lg({buffered:f,currentTime:r,currentPlaylist:i,nextPlaylist:e,bufferLowWaterLine:o,bufferHighWaterLine:c,duration:this.duration(),bufferBasedABR:this.bufferBasedABR,log:this.logger_})}setupSegmentLoaderListeners_(){this.mainSegmentLoader_.on("bandwidthupdate",()=>{this.checkABR_("bandwidthupdate"),this.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("timeout",()=>{this.bufferBasedABR&&this.mainSegmentLoader_.load()}),this.bufferBasedABR||this.mainSegmentLoader_.on("progress",()=>{this.trigger("progress")}),this.mainSegmentLoader_.on("error",()=>{const r=this.mainSegmentLoader_.error();this.excludePlaylist({playlistToExclude:r.playlist,error:r})}),this.mainSegmentLoader_.on("appenderror",()=>{this.error=this.mainSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",()=>{this.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.audioSegmentLoader_.on("appenderror",()=>{this.error=this.audioSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("ended",()=>{this.logger_("main segment loader ended"),this.onEndOfStream()}),this.mainSegmentLoader_.on("earlyabort",r=>{this.bufferBasedABR||(this.delegateLoaders_("all",["abort"]),this.excludePlaylist({error:{message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},playlistExclusionDuration:Sg}))});const e=()=>{if(!this.sourceUpdater_.hasCreatedSourceBuffers())return this.tryToCreateSourceBuffers_();const r=this.getCodecsOrExclude_();!r||this.sourceUpdater_.addOrChangeSourceBuffers(r)};this.mainSegmentLoader_.on("trackinfo",e),this.audioSegmentLoader_.on("trackinfo",e),this.mainSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("ended",()=>{this.logger_("audioSegmentLoader ended"),this.onEndOfStream()}),["segmentselected","segmentloadstart","segmentloaded","segmentkeyloadstart","segmentkeyloadcomplete","segmentdecryptionstart","segmentdecryptioncomplete","segmenttransmuxingstart","segmenttransmuxingcomplete","segmenttransmuxingtrackinfoavailable","segmenttransmuxingtiminginfoavailable","segmentappendstart","appendsdone","bandwidthupdated","timelinechange","codecschange"].forEach(r=>{this.mainSegmentLoader_.on(r,o=>{this.player_.trigger((0,Y.Z)({},o))}),this.audioSegmentLoader_.on(r,o=>{this.player_.trigger((0,Y.Z)({},o))}),this.subtitleSegmentLoader_.on(r,o=>{this.player_.trigger((0,Y.Z)({},o))})})}mediaSecondsLoaded_(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}load(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}fastQualityChange_(e=this.selectPlaylist()){if(e&&e===this.mainPlaylistLoader_.media()){this.logger_("skipping fastQualityChange because new media is same as old");return}this.switchMedia_(e,"fast-quality"),this.waitingForFastQualityPlaylistReceived_=!0}runFastQualitySwitch_(){this.waitingForFastQualityPlaylistReceived_=!1,this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(()=>{this.mainSegmentLoader_.load()})}play(){if(this.setupFirstPlay())return;this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();const e=this.tech_.seekable();if(this.tech_.duration()===Infinity&&this.tech_.currentTime()<e.start(0))return this.tech_.setCurrentTime(e.end(e.length-1))}setupFirstPlay(){const e=this.mainPlaylistLoader_.media();if(!e||this.tech_.paused()||this.hasPlayed_)return!1;if(!e.endList||e.start){const i=this.seekable();if(!i.length)return!1;const r=i.end(0);let o=r;if(e.start){const c=e.start.timeOffset;c<0?o=Math.max(r+c,i.start(0)):o=Math.min(r,c)}this.trigger("firstplay"),this.tech_.setCurrentTime(o)}return this.hasPlayed_=!0,this.load(),!0}handleSourceOpen_(){if(this.tryToCreateSourceBuffers_(),this.tech_.autoplay()){const e=this.tech_.play();typeof e!="undefined"&&typeof e.then=="function"&&e.then(null,i=>{})}this.trigger("sourceopen")}handleSourceEnded_(){if(!this.inbandTextTracks_.metadataTrack_)return;const e=this.inbandTextTracks_.metadataTrack_.cues;if(!e||!e.length)return;const i=this.duration();e[e.length-1].endTime=isNaN(i)||Math.abs(i)===Infinity?Number.MAX_VALUE:i}handleDurationChange_(){this.tech_.trigger("durationchange")}onEndOfStream(){let e=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){const i=this.mainSegmentLoader_.getCurrentMediaInfo_();!i||i.hasVideo?e=e&&this.audioSegmentLoader_.ended_:e=this.audioSegmentLoader_.ended_}!e||(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())}stuckAtPlaylistEnd_(e){if(!this.seekable().length)return!1;const r=this.syncController_.getExpiredTime(e,this.duration());if(r===null)return!1;const o=oa.Playlist.playlistEnd(e,r),c=this.tech_.currentTime(),f=this.tech_.buffered();if(!f.length)return o-c<=Pi;const y=f.end(f.length-1);return y-c<=Pi&&o-y<=Pi}excludePlaylist({playlistToExclude:e=this.mainPlaylistLoader_.media(),error:i={},playlistExclusionDuration:r}){if(e=e||this.mainPlaylistLoader_.media(),r=r||i.playlistExclusionDuration||this.playlistExclusionDuration,!e){this.error=i,this.mediaSource.readyState!=="open"?this.trigger("error"):this.sourceUpdater_.endOfStream("network");return}e.playlistErrors_++;const o=this.mainPlaylistLoader_.main.playlists,c=o.filter(ec),f=c.length===1&&c[0]===e;if(o.length===1&&r!==Infinity)return Re.log.warn(`Problem encountered with playlist ${e.id}. Trying again since it is the only playlist.`),this.tech_.trigger("retryplaylist"),this.mainPlaylistLoader_.load(f);if(f){if(this.main().contentSteering){const ge=this.pathwayAttribute_(e),je=this.contentSteeringController_.steeringManifest.ttl*1e3;this.contentSteeringController_.excludePathway(ge),this.excludeThenChangePathway_(),setTimeout(()=>{this.contentSteeringController_.addAvailablePathway(ge)},je);return}let Ie=!1;o.forEach(ge=>{if(ge===e)return;const je=ge.excludeUntil;typeof je!="undefined"&&je!==Infinity&&(Ie=!0,delete ge.excludeUntil)}),Ie&&(Re.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}let y;e.playlistErrors_>this.maxPlaylistRetries?y=Infinity:y=Date.now()+r*1e3,e.excludeUntil=y,i.reason&&(e.lastExcludeReason_=i.reason),this.tech_.trigger("excludeplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-excluded"});const S=this.selectPlaylist();if(!S){this.error="Playback cannot continue. No available working or supported playlists.",this.trigger("error");return}const O=i.internal?this.logger_:Re.log.warn,q=i.message?" "+i.message:"";O(`${i.internal?"Internal problem":"Problem"} encountered with playlist ${e.id}.${q} Switching to playlist ${S.id}.`),S.attributes.AUDIO!==e.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),S.attributes.SUBTITLES!==e.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]);const de=S.targetDuration/2*1e3||5*1e3,Te=typeof S.lastRequest=="number"&&Date.now()-S.lastRequest<=de;return this.switchMedia_(S,"exclude",f||Te)}pauseLoading(){this.delegateLoaders_("all",["abort","pause"]),this.stopABRTimer_()}delegateLoaders_(e,i){const r=[],o=e==="all";(o||e==="main")&&r.push(this.mainPlaylistLoader_);const c=[];(o||e==="audio")&&c.push("AUDIO"),(o||e==="subtitle")&&(c.push("CLOSED-CAPTIONS"),c.push("SUBTITLES")),c.forEach(f=>{const y=this.mediaTypes_[f]&&this.mediaTypes_[f].activePlaylistLoader;y&&r.push(y)}),["main","audio","subtitle"].forEach(f=>{const y=this[`${f}SegmentLoader_`];y&&(e===f||e==="all")&&r.push(y)}),r.forEach(f=>i.forEach(y=>{typeof f[y]=="function"&&f[y]()}))}setCurrentTime(e){const i=xn(this.tech_.buffered(),e);if(!(this.mainPlaylistLoader_&&this.mainPlaylistLoader_.media())||!this.mainPlaylistLoader_.media().segments)return 0;if(i&&i.length)return e;this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.pause(),this.audioSegmentLoader_.resetEverything()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.pause(),this.subtitleSegmentLoader_.resetEverything()),this.load()}duration(){if(!this.mainPlaylistLoader_)return 0;const e=this.mainPlaylistLoader_.media();return e?e.endList?this.mediaSource?this.mediaSource.duration:oa.Playlist.duration(e):Infinity:0}seekable(){return this.seekable_}onSyncInfoUpdate_(){let e;if(!this.mainPlaylistLoader_)return;let i=this.mainPlaylistLoader_.media();if(!i)return;let r=this.syncController_.getExpiredTime(i,this.duration());if(r===null)return;const o=this.mainPlaylistLoader_.main,c=oa.Playlist.seekable(i,r,oa.Playlist.liveEdgeDelay(o,i));if(c.length===0||this.mediaTypes_.AUDIO.activePlaylistLoader&&(i=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),r=this.syncController_.getExpiredTime(i,this.duration()),r===null||(e=oa.Playlist.seekable(i,r,oa.Playlist.liveEdgeDelay(o,i)),e.length===0)))return;let f,y;if(this.seekable_&&this.seekable_.length&&(f=this.seekable_.end(0),y=this.seekable_.start(0)),e?e.start(0)>c.end(0)||c.start(0)>e.end(0)?this.seekable_=c:this.seekable_=zt([[e.start(0)>c.start(0)?e.start(0):c.start(0),e.end(0)<c.end(0)?e.end(0):c.end(0)]]):this.seekable_=c,this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===f&&this.seekable_.start(0)===y)return;this.logger_(`seekable updated [${ef(this.seekable_)}]`);const S={seekableRanges:this.seekable_};this.trigger({type:"seekablerangeschanged",metadata:S}),this.tech_.trigger("seekablechanged")}updateDuration(e){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),this.mediaSource.readyState!=="open"){this.updateDuration_=this.updateDuration.bind(this,e),this.mediaSource.addEventListener("sourceopen",this.updateDuration_);return}if(e){const o=this.seekable();if(!o.length)return;(isNaN(this.mediaSource.duration)||this.mediaSource.duration<o.end(o.length-1))&&this.sourceUpdater_.setDuration(o.end(o.length-1));return}const i=this.tech_.buffered();let r=oa.Playlist.duration(this.mainPlaylistLoader_.media());i.length>0&&(r=Math.max(r,i.end(i.length-1))),this.mediaSource.duration!==r&&this.sourceUpdater_.setDuration(r)}dispose(){this.trigger("dispose"),this.decrypter_.terminate(),this.mainPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),this.contentSteeringController_.dispose(),this.keyStatusMap_.clear(),this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_),["AUDIO","SUBTITLES"].forEach(e=>{const i=this.mediaTypes_[e].groups;for(const r in i)i[r].forEach(o=>{o.playlistLoader&&o.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.stopABRTimer_(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()}main(){return this.mainPlaylistLoader_.main}media(){return this.mainPlaylistLoader_.media()||this.initialMedia_}areMediaTypesKnown_(){const e=!!this.mediaTypes_.AUDIO.activePlaylistLoader,i=!!this.mainSegmentLoader_.getCurrentMediaInfo_(),r=e?!!this.audioSegmentLoader_.getCurrentMediaInfo_():!0;return!(!i||!r)}getCodecsOrExclude_(){const e={main:this.mainSegmentLoader_.getCurrentMediaInfo_()||{},audio:this.audioSegmentLoader_.getCurrentMediaInfo_()||{}},i=this.mainSegmentLoader_.getPendingSegmentPlaylist()||this.media();e.video=e.main;const r=Mu(this.main(),i),o={},c=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(e.main.hasVideo&&(o.video=r.video||e.main.videoCodec||hi),e.main.isMuxed&&(o.video+=`,${r.audio||e.main.audioCodec||Gt}`),(e.main.hasAudio&&!e.main.isMuxed||e.audio.hasAudio||c)&&(o.audio=r.audio||e.main.audioCodec||e.audio.audioCodec||Gt,e.audio.isFmp4=e.main.hasAudio&&!e.main.isMuxed?e.main.isFmp4:e.audio.isFmp4),!o.audio&&!o.video){this.excludePlaylist({playlistToExclude:i,error:{message:"Could not determine codecs for playlist."},playlistExclusionDuration:Infinity});return}const f=(O,q)=>O?Ht(q):Tt(q),y={};let S;if(["video","audio"].forEach(function(O){if(o.hasOwnProperty(O)&&!f(e[O].isFmp4,o[O])){const q=e[O].isFmp4?"browser":"muxer";y[q]=y[q]||[],y[q].push(o[O]),O==="audio"&&(S=q)}}),c&&S&&i.attributes.AUDIO){const O=i.attributes.AUDIO;this.main().playlists.forEach(q=>{(q.attributes&&q.attributes.AUDIO)===O&&q!==i&&(q.excludeUntil=Infinity)}),this.logger_(`excluding audio group ${O} as ${S} does not support codec(s): "${o.audio}"`)}if(Object.keys(y).length){const O=Object.keys(y).reduce((q,de)=>(q&&(q+=", "),q+=`${de} does not support codec(s): "${y[de].join(",")}"`,q),"")+".";this.excludePlaylist({playlistToExclude:i,error:{internal:!0,message:O},playlistExclusionDuration:Infinity});return}if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){const O=[];if(["video","audio"].forEach(q=>{const de=(Oe(this.sourceUpdater_.codecs[q]||"")[0]||{}).type,Te=(Oe(o[q]||"")[0]||{}).type;de&&Te&&de.toLowerCase()!==Te.toLowerCase()&&O.push(`"${this.sourceUpdater_.codecs[q]}" -> "${o[q]}"`)}),O.length){this.excludePlaylist({playlistToExclude:i,error:{message:`Codec switching not supported: ${O.join(", ")}.`,internal:!0},playlistExclusionDuration:Infinity});return}}return o}tryToCreateSourceBuffers_(){if(this.mediaSource.readyState!=="open"||this.sourceUpdater_.hasCreatedSourceBuffers()||!this.areMediaTypesKnown_())return;const e=this.getCodecsOrExclude_();if(!e)return;this.sourceUpdater_.createSourceBuffers(e);const i=[e.video,e.audio].filter(Boolean).join(",");this.excludeIncompatibleVariants_(i)}excludeUnsupportedVariants_(){const e=this.main().playlists,i=[];Object.keys(e).forEach(r=>{const o=e[r];if(i.indexOf(o.id)!==-1)return;i.push(o.id);const c=Mu(this.main,o),f=[];c.audio&&!Tt(c.audio)&&!Ht(c.audio)&&f.push(`audio codec ${c.audio}`),c.video&&!Tt(c.video)&&!Ht(c.video)&&f.push(`video codec ${c.video}`),c.text&&c.text==="stpp.ttml.im1t"&&f.push(`text codec ${c.text}`),f.length&&(o.excludeUntil=Infinity,this.logger_(`excluding ${o.id} for unsupported: ${f.join(", ")}`))})}excludeIncompatibleVariants_(e){const i=[],r=this.main().playlists,o=ic(Oe(e)),c=Hf(o),f=o.video&&Oe(o.video)[0]||null,y=o.audio&&Oe(o.audio)[0]||null;Object.keys(r).forEach(S=>{const O=r[S];if(i.indexOf(O.id)!==-1||O.excludeUntil===Infinity)return;i.push(O.id);const q=[],de=Mu(this.mainPlaylistLoader_.main,O),Te=Hf(de);if(!(!de.audio&&!de.video)){if(Te!==c&&q.push(`codec count "${Te}" !== "${c}"`),!this.sourceUpdater_.canChangeType()){const Ie=de.video&&Oe(de.video)[0]||null,ge=de.audio&&Oe(de.audio)[0]||null;Ie&&f&&Ie.type.toLowerCase()!==f.type.toLowerCase()&&q.push(`video codec "${Ie.type}" !== "${f.type}"`),ge&&y&&ge.type.toLowerCase()!==y.type.toLowerCase()&&q.push(`audio codec "${ge.type}" !== "${y.type}"`)}q.length&&(O.excludeUntil=Infinity,this.logger_(`excluding ${O.id}: ${q.join(" && ")}`))}})}updateAdCues_(e){let i=0;const r=this.seekable();r.length&&(i=r.start(0)),og(e,this.cueTagsTrack_,i)}goalBufferLength(){const e=this.tech_.currentTime(),i=In.GOAL_BUFFER_LENGTH,r=In.GOAL_BUFFER_LENGTH_RATE,o=Math.max(i,In.MAX_GOAL_BUFFER_LENGTH);return Math.min(i+e*r,o)}bufferLowWaterLine(){const e=this.tech_.currentTime(),i=In.BUFFER_LOW_WATER_LINE,r=In.BUFFER_LOW_WATER_LINE_RATE,o=Math.max(i,In.MAX_BUFFER_LOW_WATER_LINE),c=Math.max(i,In.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(i+e*r,this.bufferBasedABR?c:o)}bufferHighWaterLine(){return In.BUFFER_HIGH_WATER_LINE}addDateRangesToTextTrack_(e){Kf(this.inbandTextTracks_,"com.apple.streaming",this.tech_),Vm({inbandTextTracks:this.inbandTextTracks_,dateRanges:e})}addMetadataToTextTrack(e,i,r){const o=this.sourceUpdater_.videoBuffer?this.sourceUpdater_.videoTimestampOffset():this.sourceUpdater_.audioTimestampOffset();Kf(this.inbandTextTracks_,e,this.tech_),Um({inbandTextTracks:this.inbandTextTracks_,metadataArray:i,timestampOffset:o,videoDuration:r})}pathwayAttribute_(e){return e.attributes["PATHWAY-ID"]||e.attributes.serviceLocation}initContentSteeringController_(){const e=this.main();if(!!e.contentSteering){for(const i of e.playlists)this.contentSteeringController_.addAvailablePathway(this.pathwayAttribute_(i));if(this.contentSteeringController_.assignTagProperties(e.uri,e.contentSteering),this.contentSteeringController_.queryBeforeStart){this.contentSteeringController_.requestSteeringManifest(!0);return}this.tech_.one("canplay",()=>{this.contentSteeringController_.requestSteeringManifest()})}}resetContentSteeringController_(){this.contentSteeringController_.clearAvailablePathways(),this.contentSteeringController_.dispose(),this.initContentSteeringController_()}attachContentSteeringListeners_(){this.contentSteeringController_.on("content-steering",this.excludeThenChangePathway_.bind(this)),["contentsteeringloadstart","contentsteeringloadcomplete","contentsteeringparsed"].forEach(i=>{this.contentSteeringController_.on(i,r=>{this.trigger((0,Y.Z)({},r))})}),this.sourceType_==="dash"&&this.mainPlaylistLoader_.on("loadedplaylist",()=>{const i=this.main();(this.contentSteeringController_.didDASHTagChange(i.uri,i.contentSteering)||(()=>{const c=this.contentSteeringController_.getAvailablePathways(),f=[];for(const y of i.playlists){const S=y.attributes.serviceLocation;if(S&&(f.push(S),!c.has(S)))return!0}return!!(!f.length&&c.size)})())&&this.resetContentSteeringController_()})}excludeThenChangePathway_(){const e=this.contentSteeringController_.getPathway();if(!e)return;this.handlePathwayClones_();const r=this.main().playlists,o=new Set;let c=!1;Object.keys(r).forEach(f=>{const y=r[f],S=this.pathwayAttribute_(y),O=S&&e!==S;y.excludeUntil===Infinity&&y.lastExcludeReason_==="content-steering"&&!O&&(delete y.excludeUntil,delete y.lastExcludeReason_,c=!0);const de=!y.excludeUntil&&y.excludeUntil!==Infinity;!(!o.has(y.id)&&O&&de)||(o.add(y.id),y.excludeUntil=Infinity,y.lastExcludeReason_="content-steering",this.logger_(`excluding ${y.id} for ${y.lastExcludeReason_}`))}),this.contentSteeringController_.manifestType_==="DASH"&&Object.keys(this.mediaTypes_).forEach(f=>{const y=this.mediaTypes_[f];if(y.activePlaylistLoader){const S=y.activePlaylistLoader.media_;S&&S.attributes.serviceLocation!==e&&(c=!0)}}),c&&this.changeSegmentPathway_()}handlePathwayClones_(){const i=this.main().playlists,r=this.contentSteeringController_.currentPathwayClones,o=this.contentSteeringController_.nextPathwayClones;if(!!(r&&r.size||o&&o.size)){for(const[f,y]of r.entries())o.get(f)||(this.mainPlaylistLoader_.updateOrDeleteClone(y),this.contentSteeringController_.excludePathway(f));for(const[f,y]of o.entries()){const S=r.get(f);if(!S){i.filter(q=>q.attributes["PATHWAY-ID"]===y["BASE-ID"]).forEach(q=>{this.mainPlaylistLoader_.addClonePathway(y,q)}),this.contentSteeringController_.addAvailablePathway(f);continue}this.equalPathwayClones_(S,y)||(this.mainPlaylistLoader_.updateOrDeleteClone(y,!0),this.contentSteeringController_.addAvailablePathway(f))}this.contentSteeringController_.currentPathwayClones=new Map(JSON.parse(JSON.stringify([...o])))}}equalPathwayClones_(e,i){if(e["BASE-ID"]!==i["BASE-ID"]||e.ID!==i.ID||e["URI-REPLACEMENT"].HOST!==i["URI-REPLACEMENT"].HOST)return!1;const r=e["URI-REPLACEMENT"].PARAMS,o=i["URI-REPLACEMENT"].PARAMS;for(const c in r)if(r[c]!==o[c])return!1;for(const c in o)if(r[c]!==o[c])return!1;return!0}changeSegmentPathway_(){const e=this.selectPlaylist();this.pauseLoading(),this.contentSteeringController_.manifestType_==="DASH"&&this.switchMediaForDASHContentSteering_(),this.switchMedia_(e,"content-steering")}excludeNonUsablePlaylistsByKeyId_(){if(!this.mainPlaylistLoader_||!this.mainPlaylistLoader_.main)return;let e=0;const i="non-usable";this.mainPlaylistLoader_.main.playlists.forEach(r=>{const o=this.mainPlaylistLoader_.getKeyIdSet(r);!o||!o.size||o.forEach(c=>{const f="usable",y=this.keyStatusMap_.has(c)&&this.keyStatusMap_.get(c)===f,S=r.lastExcludeReason_===i&&r.excludeUntil===Infinity;y?y&&S&&(delete r.excludeUntil,delete r.lastExcludeReason_,this.logger_(`enabling playlist ${r.id} because key ID ${c} is ${f}`)):(r.excludeUntil!==Infinity&&r.lastExcludeReason_!==i&&(r.excludeUntil=Infinity,r.lastExcludeReason_=i,this.logger_(`excluding playlist ${r.id} because the key ID ${c} doesn't exist in the keyStatusMap or is not ${f}`)),e++)})}),e>=this.mainPlaylistLoader_.main.playlists.length&&this.mainPlaylistLoader_.main.playlists.forEach(r=>{const o=r&&r.attributes&&r.attributes.RESOLUTION&&r.attributes.RESOLUTION.height<720,c=r.excludeUntil===Infinity&&r.lastExcludeReason_===i;o&&c&&(delete r.excludeUntil,Re.log.warn(`enabling non-HD playlist ${r.id} because all playlists were excluded due to ${i} key IDs`))})}addKeyStatus_(e,i){const c=(typeof e=="string"?e:ng(e)).slice(0,32).toLowerCase();this.logger_(`KeyStatus '${i}' with key ID ${c} added to the keyStatusMap`),this.keyStatusMap_.set(c,i)}updatePlaylistByKeyStatus(e,i){this.addKeyStatus_(e,i),this.waitingForFastQualityPlaylistReceived_||this.excludeNonUsableThenChangePlaylist_(),this.mainPlaylistLoader_.off("loadedplaylist",this.excludeNonUsableThenChangePlaylist_.bind(this)),this.mainPlaylistLoader_.on("loadedplaylist",this.excludeNonUsableThenChangePlaylist_.bind(this))}excludeNonUsableThenChangePlaylist_(){this.excludeNonUsablePlaylistsByKeyId_(),this.fastQualityChange_()}}const kg=(s,e,i)=>r=>{const o=s.main.playlists[e],c=ch(o),f=ec(o);if(typeof r=="undefined")return f;r?delete o.disabled:o.disabled=!0;const y={renditionInfo:{id:e,bandwidth:o.attributes.BANDWIDTH,resolution:o.attributes.RESOLUTION,codecs:o.attributes.CODECS},cause:"fast-quality"};return r!==f&&!c&&(i(o),r?s.trigger({type:"renditionenabled",metadata:y}):s.trigger({type:"renditiondisabled",metadata:y})),r};class Ig{constructor(e,i,r){const{playlistController_:o}=e,c=o.fastQualityChange_.bind(o);if(i.attributes){const f=i.attributes.RESOLUTION;this.width=f&&f.width,this.height=f&&f.height,this.bandwidth=i.attributes.BANDWIDTH,this.frameRate=i.attributes["FRAME-RATE"]}this.codecs=Mu(o.main(),i),this.playlist=i,this.id=r,this.enabled=kg(e.playlists,i.id,c)}}const Rg=function(s){s.representations=()=>{const e=s.playlistController_.main(),i=Ou(e)?s.playlistController_.getAudioTrackPlaylists_():e.playlists;return i?i.filter(r=>!ch(r)).map((r,o)=>new Ig(s,r,r.id)):[]}},pp=["seeking","seeked","pause","playing","error"];class Pg extends Re.EventTarget{constructor(e){super();this.playlistController_=e.playlistController,this.tech_=e.tech,this.seekable=e.seekable,this.allowSeeksWithinUnsafeLiveWindow=e.allowSeeksWithinUnsafeLiveWindow,this.liveRangeSafeTimeDelta=e.liveRangeSafeTimeDelta,this.media=e.media,this.playedRanges_=[],this.consecutiveUpdates=0,this.lastRecordedTime=null,this.checkCurrentTimeTimeout_=null,this.logger_=St("PlaybackWatcher"),this.logger_("initialize");const i=()=>this.monitorCurrentTime_(),r=()=>this.monitorCurrentTime_(),o=()=>this.techWaiting_(),c=()=>this.resetTimeUpdate_(),f=this.playlistController_,y=["main","subtitle","audio"],S={};y.forEach(q=>{S[q]={reset:()=>this.resetSegmentDownloads_(q),updateend:()=>this.checkSegmentDownloads_(q)},f[`${q}SegmentLoader_`].on("appendsdone",S[q].updateend),f[`${q}SegmentLoader_`].on("playlistupdate",S[q].reset),this.tech_.on(["seeked","seeking"],S[q].reset)});const O=q=>{["main","audio"].forEach(de=>{f[`${de}SegmentLoader_`][q]("appended",this.seekingAppendCheck_)})};this.seekingAppendCheck_=()=>{this.fixesBadSeeks_()&&(this.consecutiveUpdates=0,this.lastRecordedTime=this.tech_.currentTime(),O("off"))},this.clearSeekingAppendCheck_=()=>O("off"),this.watchForBadSeeking_=()=>{this.clearSeekingAppendCheck_(),O("on")},this.tech_.on("seeked",this.clearSeekingAppendCheck_),this.tech_.on("seeking",this.watchForBadSeeking_),this.tech_.on("waiting",o),this.tech_.on(pp,c),this.tech_.on("canplay",r),this.tech_.one("play",i),this.dispose=()=>{this.clearSeekingAppendCheck_(),this.logger_("dispose"),this.tech_.off("waiting",o),this.tech_.off(pp,c),this.tech_.off("canplay",r),this.tech_.off("play",i),this.tech_.off("seeking",this.watchForBadSeeking_),this.tech_.off("seeked",this.clearSeekingAppendCheck_),y.forEach(q=>{f[`${q}SegmentLoader_`].off("appendsdone",S[q].updateend),f[`${q}SegmentLoader_`].off("playlistupdate",S[q].reset),this.tech_.off(["seeked","seeking"],S[q].reset)}),this.checkCurrentTimeTimeout_&&ne().clearTimeout(this.checkCurrentTimeTimeout_),this.resetTimeUpdate_()}}monitorCurrentTime_(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&ne().clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=ne().setTimeout(this.monitorCurrentTime_.bind(this),250)}resetSegmentDownloads_(e){const i=this.playlistController_[`${e}SegmentLoader_`];this[`${e}StalledDownloads_`]>0&&this.logger_(`resetting possible stalled download count for ${e} loader`),this[`${e}StalledDownloads_`]=0,this[`${e}Buffered_`]=i.buffered_()}checkSegmentDownloads_(e){const i=this.playlistController_,r=i[`${e}SegmentLoader_`],o=r.buffered_(),c=S0(this[`${e}Buffered_`],o);if(this[`${e}Buffered_`]=o,c){const f={bufferedRanges:o};i.trigger({type:"bufferedrangeschanged",metadata:f}),this.resetSegmentDownloads_(e);return}this[`${e}StalledDownloads_`]++,this.logger_(`found #${this[`${e}StalledDownloads_`]} ${e} appends that did not increase buffer (possible stalled download)`,{playlistId:r.playlist_&&r.playlist_.id,buffered:yo(o)}),!(this[`${e}StalledDownloads_`]<10)&&(this.logger_(`${e} loader stalled download exclusion`),this.resetSegmentDownloads_(e),this.tech_.trigger({type:"usage",name:`vhs-${e}-download-exclusion`}),e!=="subtitle"&&i.excludePlaylist({error:{message:`Excessive ${e} segment downloading detected.`},playlistExclusionDuration:Infinity}))}checkCurrentTime_(){if(this.tech_.paused()||this.tech_.seeking())return;const e=this.tech_.currentTime(),i=this.tech_.buffered();if(this.lastRecordedTime===e&&(!i.length||e+Pi>=i.end(i.length-1)))return this.techWaiting_();if(this.consecutiveUpdates>=5&&e===this.lastRecordedTime)this.consecutiveUpdates++,this.waiting_();else if(e===this.lastRecordedTime)this.consecutiveUpdates++;else{this.playedRanges_.push(zt([this.lastRecordedTime,e]));const r={playedRanges:this.playedRanges_};this.playlistController_.trigger({type:"playedrangeschanged",metadata:r}),this.consecutiveUpdates=0,this.lastRecordedTime=e}}resetTimeUpdate_(){this.consecutiveUpdates=0}fixesBadSeeks_(){if(!this.tech_.seeking())return!1;const i=this.seekable(),r=this.tech_.currentTime(),o=this.afterSeekableWindow_(i,r,this.media(),this.allowSeeksWithinUnsafeLiveWindow);let c;if(o&&(c=i.end(i.length-1)),this.beforeSeekableWindow_(i,r)){const ge=i.start(0);c=ge+(ge===i.end(0)?0:Pi)}if(typeof c!="undefined")return this.logger_(`Trying to seek outside of seekable at time ${r} with seekable range ${ef(i)}. Seeking to ${c}.`),this.tech_.setCurrentTime(c),!0;const f=this.playlistController_.sourceUpdater_,y=this.tech_.buffered(),S=f.audioBuffer?f.audioBuffered():null,O=f.videoBuffer?f.videoBuffered():null,q=this.media(),de=q.partTargetDuration?q.partTargetDuration:(q.targetDuration-Li)*2,Te=[S,O];for(let ge=0;ge<Te.length;ge++){if(!Te[ge])continue;if(lh(Te[ge],r)<de)return!1}const Ie=Is(y,r);return Ie.length===0?!1:(c=Ie.start(0)+Pi,this.logger_(`Buffered region starts (${Ie.start(0)})  just beyond seek point (${r}). Seeking to ${c}.`),this.tech_.setCurrentTime(c),!0)}waiting_(){if(this.techWaiting_())return;const e=this.tech_.currentTime(),i=this.tech_.buffered(),r=xn(i,e);if(r.length&&e+3<=r.end(0)){this.resetTimeUpdate_(),this.tech_.setCurrentTime(e),this.logger_(`Stopped at ${e} while inside a buffered region [${r.start(0)} -> ${r.end(0)}]. Attempting to resume playback by seeking to the current time.`),this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"});return}}techWaiting_(){const e=this.seekable(),i=this.tech_.currentTime();if(this.tech_.seeking())return!0;if(this.beforeSeekableWindow_(e,i)){const y=e.end(e.length-1);return this.logger_(`Fell out of live window at time ${i}. Seeking to live point (seekable end) ${y}`),this.resetTimeUpdate_(),this.tech_.setCurrentTime(y),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),!0}const r=this.tech_.vhs.playlistController_.sourceUpdater_,o=this.tech_.buffered();if(this.videoUnderflow_({audioBuffered:r.audioBuffered(),videoBuffered:r.videoBuffered(),currentTime:i}))return this.resetTimeUpdate_(),this.tech_.setCurrentTime(i),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),!0;const f=Is(o,i);return f.length>0?(this.logger_(`Stopped at ${i} and seeking to ${f.start(0)}`),this.resetTimeUpdate_(),this.skipTheGap_(i),!0):!1}afterSeekableWindow_(e,i,r,o=!1){if(!e.length)return!1;let c=e.end(e.length-1)+Pi;const f=!r.endList,y=typeof r.partTargetDuration=="number";return f&&(y||o)&&(c=e.end(e.length-1)+r.targetDuration*3),i>c}beforeSeekableWindow_(e,i){return!!(e.length&&e.start(0)>0&&i<e.start(0)-this.liveRangeSafeTimeDelta)}videoUnderflow_({videoBuffered:e,audioBuffered:i,currentTime:r}){if(!e)return;let o;if(e.length&&i.length){const c=xn(e,r-3),f=xn(e,r),y=xn(i,r);y.length&&!f.length&&c.length&&(o={start:c.end(0),end:y.end(0)})}else Is(e,r).length||(o=this.gapFromVideoUnderflow_(e,r));return o?(this.logger_(`Encountered a gap in video from ${o.start} to ${o.end}. Seeking to current time ${r}`),!0):!1}skipTheGap_(e){const i=this.tech_.buffered(),r=this.tech_.currentTime(),o=Is(i,r);if(this.resetTimeUpdate_(),o.length===0||r!==e)return;this.logger_("skipTheGap_:","currentTime:",r,"scheduled currentTime:",e,"nextRange start:",o.start(0)),this.tech_.setCurrentTime(o.start(0)+Li);const c={gapInfo:{from:r,to:o.start(0)}};this.playlistController_.trigger({type:"gapjumped",metadata:c}),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"})}gapFromVideoUnderflow_(e,i){const r=Ru(e);for(let o=0;o<r.length;o++){const c=r.start(o),f=r.end(o);if(i-c<4&&i-c>2)return{start:c,end:f}}return null}}const Og={errorInterval:30,getSource(s){const i=this.tech({IWillNotUseThisInPlugins:!0}).currentSource_||this.currentSource();return s(i)}},mp=function(s,e){let i=0,r=0;const o=$t(Og,e);s.ready(()=>{s.trigger({type:"usage",name:"vhs-error-reload-initialized"})});const c=function(){r&&s.currentTime(r)},f=function(q){q!=null&&(r=s.duration()!==Infinity&&s.currentTime()||0,s.one("loadedmetadata",c),s.src(q),s.trigger({type:"usage",name:"vhs-error-reload"}),s.play())},y=function(){if(Date.now()-i<o.errorInterval*1e3){s.trigger({type:"usage",name:"vhs-error-reload-canceled"});return}if(!o.getSource||typeof o.getSource!="function"){Re.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!");return}return i=Date.now(),o.getSource.call(s,f)},S=function(){s.off("loadedmetadata",c),s.off("error",y),s.off("dispose",S)},O=function(q){S(),mp(s,q)};s.on("error",y),s.on("dispose",S),s.reloadSourceOnError=O},Bg=function(s){mp(this,s)};var gp="3.13.2",Mg="7.0.3",Fg="1.3.0",Ng="7.1.0",Ug="4.0.1";const on={PlaylistLoader:El,Playlist:fr,utils:W0,STANDARD_PLAYLIST_SELECTOR:zf,INITIAL_PLAYLIST_SELECTOR:Om,lastBandwidthSelector:zf,movingAverageBandwidthSelector:Rm,comparePlaylistBandwidth:Eh,comparePlaylistResolution:Im,xhr:bf()};Object.keys(In).forEach(s=>{Object.defineProperty(on,s,{get(){return Re.log.warn(`using Vhs.${s} is UNSAFE be sure you know what you are doing`),In[s]},set(e){if(Re.log.warn(`using Vhs.${s} is UNSAFE be sure you know what you are doing`),typeof e!="number"||e<0){Re.log.warn(`value of Vhs.${s} must be greater than or equal to 0`);return}In[s]=e}})});const yp="videojs-vhs",vp=function(s,e){const i=e.media();let r=-1;for(let o=0;o<s.length;o++)if(s[o].id===i.id){r=o;break}s.selectedIndex_=r,s.trigger({selectedIndex:r,type:"change"})},jg=function(s,e){e.representations().forEach(i=>{s.addQualityLevel(i)}),vp(s,e.playlists)};on.canPlaySource=function(){return Re.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")};const $g=(s,e,i)=>{if(!s)return s;let r={};e&&e.attributes&&e.attributes.CODECS&&(r=ic(Oe(e.attributes.CODECS))),i&&i.attributes&&i.attributes.CODECS&&(r.audio=i.attributes.CODECS);const o=nt(r.video),c=nt(r.audio),f={};for(const y in s)f[y]={},c&&(f[y].audioContentType=c),o&&(f[y].videoContentType=o),e.contentProtection&&e.contentProtection[y]&&e.contentProtection[y].pssh&&(f[y].pssh=e.contentProtection[y].pssh),typeof s[y]=="string"&&(f[y].url=s[y]);return $t(s,f)},Vg=(s,e)=>s.reduce((i,r)=>{if(!r.contentProtection)return i;const o=e.reduce((c,f)=>{const y=r.contentProtection[f];return y&&y.pssh&&(c[f]={pssh:y.pssh}),c},{});return Object.keys(o).length&&i.push(o),i},[]),Hg=({player:s,sourceKeySystems:e,audioMedia:i,mainPlaylists:r})=>{if(!s.eme.initializeMediaKeys)return Promise.resolve();const o=i?r.concat([i]):r,c=Vg(o,Object.keys(e)),f=[],y=[];return c.forEach(S=>{y.push(new Promise((O,q)=>{s.tech_.one("keysessioncreated",O)})),f.push(new Promise((O,q)=>{s.eme.initializeMediaKeys({keySystems:S},de=>{if(de){q(de);return}O()})}))}),Promise.race([Promise.all(f),Promise.race(y)])},Gg=({player:s,sourceKeySystems:e,media:i,audioMedia:r})=>{const o=$g(e,i,r);return o?(s.currentSource().keySystems=o,o&&!s.eme?(Re.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),!1):!0):!1},Ap=()=>{if(!ne().localStorage)return null;const s=ne().localStorage.getItem(yp);if(!s)return null;try{return JSON.parse(s)}catch(e){return null}},qg=s=>{if(!ne().localStorage)return!1;let e=Ap();e=e?$t(e,s):s;try{ne().localStorage.setItem(yp,JSON.stringify(e))}catch(i){return!1}return e},zg=s=>s.toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")===0?JSON.parse(s.substring(s.indexOf(",")+1)):s,_p=(s,e)=>{s._requestCallbackSet||(s._requestCallbackSet=new Set),s._requestCallbackSet.add(e)},bp=(s,e)=>{s._responseCallbackSet||(s._responseCallbackSet=new Set),s._responseCallbackSet.add(e)},xp=(s,e)=>{!s._requestCallbackSet||(s._requestCallbackSet.delete(e),s._requestCallbackSet.size||delete s._requestCallbackSet)},Ep=(s,e)=>{!s._responseCallbackSet||(s._responseCallbackSet.delete(e),s._responseCallbackSet.size||delete s._responseCallbackSet)};on.supportsNativeHls=function(){if(!ve()||!ve().createElement)return!1;const s=ve().createElement("video");return Re.getTech("Html5").isSupported()?["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(i){return/maybe|probably/i.test(s.canPlayType(i))}):!1}(),on.supportsNativeDash=function(){return!ve()||!ve().createElement||!Re.getTech("Html5").isSupported()?!1:/maybe|probably/i.test(ve().createElement("video").canPlayType("application/dash+xml"))}(),on.supportsTypeNatively=s=>s==="hls"?on.supportsNativeHls:s==="dash"?on.supportsNativeDash:!1,on.isSupported=function(){return Re.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")},on.xhr.onRequest=function(s){_p(on.xhr,s)},on.xhr.onResponse=function(s){bp(on.xhr,s)},on.xhr.offRequest=function(s){xp(on.xhr,s)},on.xhr.offResponse=function(s){Ep(on.xhr,s)};const Wg=Re.getComponent("Component");class Tp extends Wg{constructor(e,i,r){super(i,r.vhs);if(typeof r.initialBandwidth=="number"&&(this.options_.bandwidth=r.initialBandwidth),this.logger_=St("VhsHandler"),i.options_&&i.options_.playerId){const o=Re.getPlayer(i.options_.playerId);this.player_=o}if(this.tech_=i,this.source_=e,this.stats={},this.ignoreNextSeekingEvent_=!1,this.setOptions_(),this.options_.overrideNative&&i.overrideNativeAudioTracks&&i.overrideNativeVideoTracks)i.overrideNativeAudioTracks(!0),i.overrideNativeVideoTracks(!0);else if(this.options_.overrideNative&&(i.featuresNativeVideoTracks||i.featuresNativeAudioTracks))throw new Error("Overriding native VHS requires emulated tracks. See https://git.io/vMpjB");this.on(ve(),["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],o=>{const c=ve().fullscreenElement||ve().webkitFullscreenElement||ve().mozFullScreenElement||ve().msFullscreenElement;c&&c.contains(this.tech_.el())?this.playlistController_.fastQualityChange_():this.playlistController_.checkABR_()}),this.on(this.tech_,"seeking",function(){if(this.ignoreNextSeekingEvent_){this.ignoreNextSeekingEvent_=!1;return}this.setCurrentTime(this.tech_.currentTime())}),this.on(this.tech_,"error",function(){this.tech_.error()&&this.playlistController_&&this.playlistController_.pauseLoading()}),this.on(this.tech_,"play",this.play)}setOptions_(e={}){if(this.options_=$t(this.options_,e),this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions!==!1,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.useBandwidthFromLocalStorage=typeof this.source_.useBandwidthFromLocalStorage!="undefined"?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.useForcedSubtitles=this.options_.useForcedSubtitles||!1,this.options_.useNetworkInformationApi=this.options_.useNetworkInformationApi||!1,this.options_.useDtsForTimestampOffset=this.options_.useDtsForTimestampOffset||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,this.options_.llhls=this.options_.llhls!==!1,this.options_.bufferBasedABR=this.options_.bufferBasedABR||!1,typeof this.options_.playlistExclusionDuration!="number"&&(this.options_.playlistExclusionDuration=60),typeof this.options_.bandwidth!="number"&&this.options_.useBandwidthFromLocalStorage){const r=Ap();r&&r.bandwidth&&(this.options_.bandwidth=r.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"})),r&&r.throughput&&(this.options_.throughput=r.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"}))}typeof this.options_.bandwidth!="number"&&(this.options_.bandwidth=In.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===In.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","customPixelRatio","limitRenditionByPlayerDimensions","bandwidth","customTagParsers","customTagMappers","cacheEncryptionKeys","playlistSelector","initialPlaylistSelector","bufferBasedABR","liveRangeSafeTimeDelta","llhls","useForcedSubtitles","useNetworkInformationApi","useDtsForTimestampOffset","exactManifestTimings","leastPixelDiffSelector"].forEach(r=>{typeof this.source_[r]!="undefined"&&(this.options_[r]=this.source_[r])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio;const i=this.options_.customPixelRatio;typeof i=="number"&&i>=0&&(this.customPixelRatio=i)}setOptions(e={}){this.setOptions_(e)}src(e,i){if(!e)return;this.setOptions_(),this.options_.src=zg(this.source_.src),this.options_.tech=this.tech_,this.options_.externVhs=on,this.options_.sourceType=Ai(i),this.options_.seekTo=c=>{this.tech_.setCurrentTime(c)},this.options_.player_=this.player_,this.playlistController_=new Dg(this.options_);const r=$t({liveRangeSafeTimeDelta:Pi},this.options_,{seekable:()=>this.seekable(),media:()=>this.playlistController_.media(),playlistController:this.playlistController_});this.playbackWatcher_=new Pg(r),this.attachStreamingEventListeners_(),this.playlistController_.on("error",()=>{const c=Re.players[this.tech_.options_.playerId];let f=this.playlistController_.error;typeof f=="object"&&!f.code?f.code=3:typeof f=="string"&&(f={message:f,code:3}),c.error(f)});const o=this.options_.bufferBasedABR?on.movingAverageBandwidthSelector(.55):on.STANDARD_PLAYLIST_SELECTOR;this.playlistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):o.bind(this),this.playlistController_.selectInitialPlaylist=on.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.playlistController_.mainPlaylistLoader_,this.mediaSource=this.playlistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get(){return this.playlistController_.selectPlaylist},set(c){this.playlistController_.selectPlaylist=c.bind(this)}},throughput:{get(){return this.playlistController_.mainSegmentLoader_.throughput.rate},set(c){this.playlistController_.mainSegmentLoader_.throughput.rate=c,this.playlistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get(){let c=this.playlistController_.mainSegmentLoader_.bandwidth;const f=ne().navigator.connection||ne().navigator.mozConnection||ne().navigator.webkitConnection,y=1e7;if(this.options_.useNetworkInformationApi&&f){const S=f.downlink*1e3*1e3;S>=y&&c>=y?c=Math.max(c,S):c=S}return c},set(c){this.playlistController_.mainSegmentLoader_.bandwidth=c,this.playlistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get(){const c=1/(this.bandwidth||1);let f;return this.throughput>0?f=1/this.throughput:f=0,Math.floor(1/(c+f))},set(){Re.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:()=>this.bandwidth||0,enumerable:!0},mediaRequests:{get:()=>this.playlistController_.mediaRequests_()||0,enumerable:!0},mediaRequestsAborted:{get:()=>this.playlistController_.mediaRequestsAborted_()||0,enumerable:!0},mediaRequestsTimedout:{get:()=>this.playlistController_.mediaRequestsTimedout_()||0,enumerable:!0},mediaRequestsErrored:{get:()=>this.playlistController_.mediaRequestsErrored_()||0,enumerable:!0},mediaTransferDuration:{get:()=>this.playlistController_.mediaTransferDuration_()||0,enumerable:!0},mediaBytesTransferred:{get:()=>this.playlistController_.mediaBytesTransferred_()||0,enumerable:!0},mediaSecondsLoaded:{get:()=>this.playlistController_.mediaSecondsLoaded_()||0,enumerable:!0},mediaAppends:{get:()=>this.playlistController_.mediaAppends_()||0,enumerable:!0},mainAppendsToLoadedData:{get:()=>this.playlistController_.mainAppendsToLoadedData_()||0,enumerable:!0},audioAppendsToLoadedData:{get:()=>this.playlistController_.audioAppendsToLoadedData_()||0,enumerable:!0},appendsToLoadedData:{get:()=>this.playlistController_.appendsToLoadedData_()||0,enumerable:!0},timeToLoadedData:{get:()=>this.playlistController_.timeToLoadedData_()||0,enumerable:!0},buffered:{get:()=>yo(this.tech_.buffered()),enumerable:!0},currentTime:{get:()=>this.tech_.currentTime(),enumerable:!0},currentSource:{get:()=>this.tech_.currentSource_,enumerable:!0},currentTech:{get:()=>this.tech_.name_,enumerable:!0},duration:{get:()=>this.tech_.duration(),enumerable:!0},main:{get:()=>this.playlists.main,enumerable:!0},playerDimensions:{get:()=>this.tech_.currentDimensions(),enumerable:!0},seekable:{get:()=>yo(this.tech_.seekable()),enumerable:!0},timestamp:{get:()=>Date.now(),enumerable:!0},videoPlaybackQuality:{get:()=>this.tech_.getVideoPlaybackQuality(),enumerable:!0}}),this.tech_.one("canplay",this.playlistController_.setupFirstPlay.bind(this.playlistController_)),this.tech_.on("bandwidthupdate",()=>{this.options_.useBandwidthFromLocalStorage&&qg({bandwidth:this.bandwidth,throughput:Math.round(this.throughput)})}),this.playlistController_.on("selectedinitialmedia",()=>{Rg(this)}),this.playlistController_.sourceUpdater_.on("createdsourcebuffers",()=>{this.setupEme_()}),this.on(this.playlistController_,"progress",function(){this.tech_.trigger("progress")}),this.on(this.playlistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.setupQualityLevels_(),!!this.tech_.el()&&(this.mediaSourceUrl_=ne().URL.createObjectURL(this.playlistController_.mediaSource),this.tech_.src(this.mediaSourceUrl_))}createKeySessions_(){const e=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader;this.logger_("waiting for EME key session creation"),Hg({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:e&&e.media(),mainPlaylists:this.playlists.main.playlists}).then(()=>{this.logger_("created EME key session"),this.playlistController_.sourceUpdater_.initializedEme()}).catch(i=>{this.logger_("error while creating EME key session",i),this.player_.error({message:"Failed to initialize media keys for EME",code:3})})}handleWaitingForKey_(){this.logger_("waitingforkey fired, attempting to create any new key sessions"),this.createKeySessions_()}setupEme_(){const e=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader,i=Gg({player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:e&&e.media()});if(this.player_.tech_.on("keystatuschange",r=>{this.playlistController_.updatePlaylistByKeyStatus(r.keyId,r.status)}),this.handleWaitingForKey_=this.handleWaitingForKey_.bind(this),this.player_.tech_.on("waitingforkey",this.handleWaitingForKey_),!i){this.playlistController_.sourceUpdater_.initializedEme();return}this.createKeySessions_()}setupQualityLevels_(){const e=Re.players[this.tech_.options_.playerId];!e||!e.qualityLevels||this.qualityLevels_||(this.qualityLevels_=e.qualityLevels(),this.playlistController_.on("selectedinitialmedia",()=>{jg(this.qualityLevels_,this)}),this.playlists.on("mediachange",()=>{vp(this.qualityLevels_,this.playlists)}))}static version(){return{"@videojs/http-streaming":gp,"mux.js":Mg,"mpd-parser":Fg,"m3u8-parser":Ng,"aes-decrypter":Ug}}version(){return this.constructor.version()}canChangeType(){return rp.canChangeType()}play(){this.playlistController_.play()}setCurrentTime(e){this.playlistController_.setCurrentTime(e)}duration(){return this.playlistController_.duration()}seekable(){return this.playlistController_.seekable()}dispose(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.playlistController_&&this.playlistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.mediaSourceUrl_&&ne().URL.revokeObjectURL&&(ne().URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),this.tech_&&this.tech_.off("waitingforkey",this.handleWaitingForKey_),super.dispose()}convertToProgramTime(e,i){return em({playlist:this.playlistController_.media(),time:e,callback:i})}seekToProgramTime(e,i,r=!0,o=2){return Cf({programTime:e,playlist:this.playlistController_.media(),retryCount:o,pauseAfterSeek:r,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:i})}setupXhrHooks_(){this.xhr.onRequest=e=>{_p(this.xhr,e)},this.xhr.onResponse=e=>{bp(this.xhr,e)},this.xhr.offRequest=e=>{xp(this.xhr,e)},this.xhr.offResponse=e=>{Ep(this.xhr,e)},this.player_.trigger("xhr-hooks-ready")}attachStreamingEventListeners_(){const e=["seekablerangeschanged","bufferedrangeschanged","contentsteeringloadstart","contentsteeringloadcomplete","contentsteeringparsed"],i=["gapjumped","playedrangeschanged"];e.forEach(r=>{this.playlistController_.on(r,o=>{this.player_.trigger((0,Y.Z)({},o))})}),i.forEach(r=>{this.playbackWatcher_.on(r,o=>{this.player_.trigger((0,Y.Z)({},o))})})}}const oc={name:"videojs-http-streaming",VERSION:gp,canHandleSource(s,e={}){const i=$t(Re.options,e);return oc.canPlayType(s.type,i)},handleSource(s,e,i={}){const r=$t(Re.options,i);return e.vhs=new Tp(s,e,r),e.vhs.xhr=bf(),e.vhs.setupXhrHooks_(),e.vhs.src(s.src,s.type),e.vhs},canPlayType(s,e){const i=Ai(s);if(!i)return"";const r=oc.getOverrideNative(e);return!on.supportsTypeNatively(i)||r?"maybe":""},getOverrideNative(s={}){const{vhs:e={}}=s,i=!(Re.browser.IS_ANY_SAFARI||Re.browser.IS_IOS),{overrideNative:r=i}=e;return r}};(()=>Ht("avc1.4d400d,mp4a.40.2"))()&&Re.getTech("Html5").registerSourceHandler(oc,0),Re.VhsHandler=Tp,Re.VhsSourceHandler=oc,Re.Vhs=on,Re.use||Re.registerComponent("Vhs",on),Re.options.vhs=Re.options.vhs||{},(!Re.getPlugin||!Re.getPlugin("reloadSourceOnError"))&&Re.registerPlugin("reloadSourceOnError",Bg)},5956:function(Kt,Ut,mt){"use strict";var ct=mt(43033),ne=mt(74020),We=mt.n(ne);const ve=ct.Z.getTech("Html5"),ze=ct.Z.mergeOptions||ct.Z.util.mergeOptions,_e={mediaDataSource:{},config:{}};class we extends ve{constructor(te,Y){te=ze(_e,te),super(te,Y)}setSrc(te){this.flvPlayer&&(this.flvPlayer.detachMediaElement(),this.flvPlayer.destroy());const Y=this.options_.mediaDataSource,I=this.options_.config;Y.type=Y.type===void 0?"flv":Y.type,Y.url=te,this.flvPlayer=We().createPlayer(Y,I),this.flvPlayer.attachMediaElement(this.el_),this.flvPlayer.load()}dispose(){this.flvPlayer&&(this.flvPlayer.detachMediaElement(),this.flvPlayer.destroy()),super.dispose()}}we.isSupported=function(){return We()&&We().isSupported()},we.formats={"video/flv":"FLV","video/x-flv":"FLV"},we.canPlayType=function(se){return we.isSupported()&&se in we.formats?"maybe":""},we.canPlaySource=function(se,te){return we.canPlayType(se.type)},we.VERSION="__VERSION__",ct.Z.registerTech("Flvjs",we);var ye=null},13407:function(Kt,Ut,mt){var ct=mt(58908),ne=Kt.exports={WebVTT:mt(63706),VTTCue:mt(22230),VTTRegion:mt(13710)};ct.vttjs=ne,ct.WebVTT=ne.WebVTT;var We=ne.VTTCue,ve=ne.VTTRegion,ze=ct.VTTCue,_e=ct.VTTRegion;ne.shim=function(){ct.VTTCue=We,ct.VTTRegion=ve},ne.restore=function(){ct.VTTCue=ze,ct.VTTRegion=_e},ct.VTTCue||ne.shim()},63706:function(Kt,Ut,mt){var ct=mt(89144),ne=Object.create||function(){function j(){}return function(X){if(arguments.length!==1)throw new Error("Object.create shim only accepts one parameter.");return j.prototype=X,new j}}();function We(j,X){this.name="ParsingError",this.code=j.code,this.message=X||j.message}We.prototype=ne(Error.prototype),We.prototype.constructor=We,We.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};function ve(j){function X(ce,be,Be,Ce){return(ce|0)*3600+(be|0)*60+(Be|0)+(Ce|0)/1e3}var oe=j.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return oe?oe[3]?X(oe[1],oe[2],oe[3].replace(":",""),oe[4]):oe[1]>59?X(oe[1],oe[2],0,oe[4]):X(0,oe[1],oe[2],oe[4]):null}function ze(){this.values=ne(null)}ze.prototype={set:function(j,X){!this.get(j)&&X!==""&&(this.values[j]=X)},get:function(j,X,oe){return oe?this.has(j)?this.values[j]:X[oe]:this.has(j)?this.values[j]:X},has:function(j){return j in this.values},alt:function(j,X,oe){for(var ce=0;ce<oe.length;++ce)if(X===oe[ce]){this.set(j,X);break}},integer:function(j,X){/^-?\d+$/.test(X)&&this.set(j,parseInt(X,10))},percent:function(j,X){var oe;return(oe=X.match(/^([\d]{1,3})(\.[\d]*)?%$/))&&(X=parseFloat(X),X>=0&&X<=100)?(this.set(j,X),!0):!1}};function _e(j,X,oe,ce){var be=ce?j.split(ce):[j];for(var Be in be)if(typeof be[Be]=="string"){var Ce=be[Be].split(oe);if(Ce.length===2){var Le=Ce[0].trim(),Pe=Ce[1].trim();X(Le,Pe)}}}function we(j,X,oe){var ce=j;function be(){var Le=ve(j);if(Le===null)throw new We(We.Errors.BadTimeStamp,"Malformed timestamp: "+ce);return j=j.replace(/^[^\sa-zA-Z-]+/,""),Le}function Be(Le,Pe){var De=new ze;_e(Le,function(Ve,Oe){switch(Ve){case"region":for(var dt=oe.length-1;dt>=0;dt--)if(oe[dt].id===Oe){De.set(Ve,oe[dt].region);break}break;case"vertical":De.alt(Ve,Oe,["rl","lr"]);break;case"line":var Nt=Oe.split(","),It=Nt[0];De.integer(Ve,It),De.percent(Ve,It)&&De.set("snapToLines",!1),De.alt(Ve,It,["auto"]),Nt.length===2&&De.alt("lineAlign",Nt[1],["start","center","end"]);break;case"position":Nt=Oe.split(","),De.percent(Ve,Nt[0]),Nt.length===2&&De.alt("positionAlign",Nt[1],["start","center","end"]);break;case"size":De.percent(Ve,Oe);break;case"align":De.alt(Ve,Oe,["start","center","end","left","right"]);break}},/:/,/\s/),Pe.region=De.get("region",null),Pe.vertical=De.get("vertical","");try{Pe.line=De.get("line","auto")}catch(Ve){}Pe.lineAlign=De.get("lineAlign","start"),Pe.snapToLines=De.get("snapToLines",!0),Pe.size=De.get("size",100);try{Pe.align=De.get("align","center")}catch(Ve){Pe.align=De.get("align","middle")}try{Pe.position=De.get("position","auto")}catch(Ve){Pe.position=De.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},Pe.align)}Pe.positionAlign=De.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},Pe.align)}function Ce(){j=j.replace(/^\s+/,"")}if(Ce(),X.startTime=be(),Ce(),j.substr(0,3)!=="-->")throw new We(We.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+ce);j=j.substr(3),Ce(),X.endTime=be(),Ce(),Be(j,X)}var ye=ct.createElement&&ct.createElement("textarea"),se={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},te={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},Y={v:"title",lang:"lang"},I={rt:"ruby"};function A(j,X){function oe(){if(!X)return null;function It(nt){return X=X.substr(nt.length),nt}var gt=X.match(/^([^<]*)(<[^>]*>?)?/);return It(gt[1]?gt[1]:gt[2])}function ce(It){return ye.innerHTML=It,It=ye.textContent,ye.textContent="",It}function be(It,gt){return!I[gt.localName]||I[gt.localName]===It.localName}function Be(It,gt){var nt=se[It];if(!nt)return null;var Ht=j.document.createElement(nt),Tt=Y[It];return Tt&&gt&&(Ht[Tt]=gt.trim()),Ht}for(var Ce=j.document.createElement("div"),Le=Ce,Pe,De=[];(Pe=oe())!==null;){if(Pe[0]==="<"){if(Pe[1]==="/"){De.length&&De[De.length-1]===Pe.substr(2).replace(">","")&&(De.pop(),Le=Le.parentNode);continue}var Ve=ve(Pe.substr(1,Pe.length-2)),Oe;if(Ve){Oe=j.document.createProcessingInstruction("timestamp",Ve),Le.appendChild(Oe);continue}var dt=Pe.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!dt||(Oe=Be(dt[1],dt[3]),!Oe)||!be(Le,Oe))continue;if(dt[2]){var Nt=dt[2].split(".");Nt.forEach(function(It){var gt=/^bg_/.test(It),nt=gt?It.slice(3):It;if(te.hasOwnProperty(nt)){var Ht=gt?"background-color":"color",Tt=te[nt];Oe.style[Ht]=Tt}}),Oe.className=Nt.join(" ")}De.push(dt[1]),Le.appendChild(Oe),Le=Oe;continue}Le.appendChild(j.document.createTextNode(ce(Pe)))}return Ce}var M=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function k(j){for(var X=0;X<M.length;X++){var oe=M[X];if(j>=oe[0]&&j<=oe[1])return!0}return!1}function V(j){var X=[],oe="",ce;if(!j||!j.childNodes)return"ltr";function be(Le,Pe){for(var De=Pe.childNodes.length-1;De>=0;De--)Le.push(Pe.childNodes[De])}function Be(Le){if(!Le||!Le.length)return null;var Pe=Le.pop(),De=Pe.textContent||Pe.innerText;if(De){var Ve=De.match(/^.*(\n|\r)/);return Ve?(Le.length=0,Ve[0]):De}if(Pe.tagName==="ruby")return Be(Le);if(Pe.childNodes)return be(Le,Pe),Be(Le)}for(be(X,j);oe=Be(X);)for(var Ce=0;Ce<oe.length;Ce++)if(ce=oe.charCodeAt(Ce),k(ce))return"rtl";return"ltr"}function J(j){if(typeof j.line=="number"&&(j.snapToLines||j.line>=0&&j.line<=100))return j.line;if(!j.track||!j.track.textTrackList||!j.track.textTrackList.mediaElement)return-1;for(var X=j.track,oe=X.textTrackList,ce=0,be=0;be<oe.length&&oe[be]!==X;be++)oe[be].mode==="showing"&&ce++;return++ce*-1}function F(){}F.prototype.applyStyles=function(j,X){X=X||this.div;for(var oe in j)j.hasOwnProperty(oe)&&(X.style[oe]=j[oe])},F.prototype.formatStyle=function(j,X){return j===0?0:j+X};function G(j,X,oe){F.call(this),this.cue=X,this.cueDiv=A(j,X.text);var ce={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:X.vertical===""?"horizontal-tb":X.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(ce,this.cueDiv),this.div=j.document.createElement("div"),ce={direction:V(this.cueDiv),writingMode:X.vertical===""?"horizontal-tb":X.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:X.align==="middle"?"center":X.align,font:oe.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(ce),this.div.appendChild(this.cueDiv);var be=0;switch(X.positionAlign){case"start":case"line-left":be=X.position;break;case"center":be=X.position-X.size/2;break;case"end":case"line-right":be=X.position-X.size;break}X.vertical===""?this.applyStyles({left:this.formatStyle(be,"%"),width:this.formatStyle(X.size,"%")}):this.applyStyles({top:this.formatStyle(be,"%"),height:this.formatStyle(X.size,"%")}),this.move=function(Be){this.applyStyles({top:this.formatStyle(Be.top,"px"),bottom:this.formatStyle(Be.bottom,"px"),left:this.formatStyle(Be.left,"px"),right:this.formatStyle(Be.right,"px"),height:this.formatStyle(Be.height,"px"),width:this.formatStyle(Be.width,"px")})}}G.prototype=ne(F.prototype),G.prototype.constructor=G;function $(j){var X,oe,ce,be;if(j.div){oe=j.div.offsetHeight,ce=j.div.offsetWidth,be=j.div.offsetTop;var Be=(Be=j.div.childNodes)&&(Be=Be[0])&&Be.getClientRects&&Be.getClientRects();j=j.div.getBoundingClientRect(),X=Be?Math.max(Be[0]&&Be[0].height||0,j.height/Be.length):0}this.left=j.left,this.right=j.right,this.top=j.top||be,this.height=j.height||oe,this.bottom=j.bottom||be+(j.height||oe),this.width=j.width||ce,this.lineHeight=X!==void 0?X:j.lineHeight}$.prototype.move=function(j,X){switch(X=X!==void 0?X:this.lineHeight,j){case"+x":this.left+=X,this.right+=X;break;case"-x":this.left-=X,this.right-=X;break;case"+y":this.top+=X,this.bottom+=X;break;case"-y":this.top-=X,this.bottom-=X;break}},$.prototype.overlaps=function(j){return this.left<j.right&&this.right>j.left&&this.top<j.bottom&&this.bottom>j.top},$.prototype.overlapsAny=function(j){for(var X=0;X<j.length;X++)if(this.overlaps(j[X]))return!0;return!1},$.prototype.within=function(j){return this.top>=j.top&&this.bottom<=j.bottom&&this.left>=j.left&&this.right<=j.right},$.prototype.overlapsOppositeAxis=function(j,X){switch(X){case"+x":return this.left<j.left;case"-x":return this.right>j.right;case"+y":return this.top<j.top;case"-y":return this.bottom>j.bottom}},$.prototype.intersectPercentage=function(j){var X=Math.max(0,Math.min(this.right,j.right)-Math.max(this.left,j.left)),oe=Math.max(0,Math.min(this.bottom,j.bottom)-Math.max(this.top,j.top)),ce=X*oe;return ce/(this.height*this.width)},$.prototype.toCSSCompatValues=function(j){return{top:this.top-j.top,bottom:j.bottom-this.bottom,left:this.left-j.left,right:j.right-this.right,height:this.height,width:this.width}},$.getSimpleBoxPosition=function(j){var X=j.div?j.div.offsetHeight:j.tagName?j.offsetHeight:0,oe=j.div?j.div.offsetWidth:j.tagName?j.offsetWidth:0,ce=j.div?j.div.offsetTop:j.tagName?j.offsetTop:0;j=j.div?j.div.getBoundingClientRect():j.tagName?j.getBoundingClientRect():j;var be={left:j.left,right:j.right,top:j.top||ce,height:j.height||X,bottom:j.bottom||ce+(j.height||X),width:j.width||oe};return be};function H(j,X,oe,ce){function be(nt,Ht){for(var Tt,Gt=new $(nt),hi=1,ai=0;ai<Ht.length;ai++){for(;nt.overlapsOppositeAxis(oe,Ht[ai])||nt.within(oe)&&nt.overlapsAny(ce);)nt.move(Ht[ai]);if(nt.within(oe))return nt;var Ei=nt.intersectPercentage(oe);hi>Ei&&(Tt=new $(nt),hi=Ei),nt=new $(Gt)}return Tt||Gt}var Be=new $(X),Ce=X.cue,Le=J(Ce),Pe=[];if(Ce.snapToLines){var De;switch(Ce.vertical){case"":Pe=["+y","-y"],De="height";break;case"rl":Pe=["+x","-x"],De="width";break;case"lr":Pe=["-x","+x"],De="width";break}var Ve=Be.lineHeight,Oe=Ve*Math.round(Le),dt=oe[De]+Ve,Nt=Pe[0];Math.abs(Oe)>dt&&(Oe=Oe<0?-1:1,Oe*=Math.ceil(dt/Ve)*Ve),Le<0&&(Oe+=Ce.vertical===""?oe.height:oe.width,Pe=Pe.reverse()),Be.move(Nt,Oe)}else{var It=Be.lineHeight/oe.height*100;switch(Ce.lineAlign){case"center":Le-=It/2;break;case"end":Le-=It;break}switch(Ce.vertical){case"":X.applyStyles({top:X.formatStyle(Le,"%")});break;case"rl":X.applyStyles({left:X.formatStyle(Le,"%")});break;case"lr":X.applyStyles({right:X.formatStyle(Le,"%")});break}Pe=["+y","-x","+x","-y"],Be=new $(X)}var gt=be(Be,Pe);X.move(gt.toCSSCompatValues(oe))}function C(){}C.StringDecoder=function(){return{decode:function(j){if(!j)return"";if(typeof j!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(j))}}},C.convertCueToDOMTree=function(j,X){return!j||!X?null:A(j,X)};var Q=.05,ae="sans-serif",ue="1.5%";C.processCues=function(j,X,oe){if(!j||!X||!oe)return null;for(;oe.firstChild;)oe.removeChild(oe.firstChild);var ce=j.document.createElement("div");ce.style.position="absolute",ce.style.left="0",ce.style.right="0",ce.style.top="0",ce.style.bottom="0",ce.style.margin=ue,oe.appendChild(ce);function be(Ve){for(var Oe=0;Oe<Ve.length;Oe++)if(Ve[Oe].hasBeenReset||!Ve[Oe].displayState)return!0;return!1}if(!be(X)){for(var Be=0;Be<X.length;Be++)ce.appendChild(X[Be].displayState);return}var Ce=[],Le=$.getSimpleBoxPosition(ce),Pe=Math.round(Le.height*Q*100)/100,De={font:Pe+"px "+ae};(function(){for(var Ve,Oe,dt=0;dt<X.length;dt++)Oe=X[dt],Ve=new G(j,Oe,De),ce.appendChild(Ve.div),H(j,Ve,Le,Ce),Oe.displayState=Ve.div,Ce.push($.getSimpleBoxPosition(Ve))})()},C.Parser=function(j,X,oe){oe||(oe=X,X={}),X||(X={}),this.window=j,this.vttjs=X,this.state="INITIAL",this.buffer="",this.decoder=oe||new TextDecoder("utf8"),this.regionList=[]},C.Parser.prototype={reportOrThrowError:function(j){if(j instanceof We)this.onparsingerror&&this.onparsingerror(j);else throw j},parse:function(j){var X=this;j&&(X.buffer+=X.decoder.decode(j,{stream:!0}));function oe(){for(var Ve=X.buffer,Oe=0;Oe<Ve.length&&Ve[Oe]!=="\r"&&Ve[Oe]!==`
`;)++Oe;var dt=Ve.substr(0,Oe);return Ve[Oe]==="\r"&&++Oe,Ve[Oe]===`
`&&++Oe,X.buffer=Ve.substr(Oe),dt}function ce(Ve){var Oe=new ze;if(_e(Ve,function(Nt,It){switch(Nt){case"id":Oe.set(Nt,It);break;case"width":Oe.percent(Nt,It);break;case"lines":Oe.integer(Nt,It);break;case"regionanchor":case"viewportanchor":var gt=It.split(",");if(gt.length!==2)break;var nt=new ze;if(nt.percent("x",gt[0]),nt.percent("y",gt[1]),!nt.has("x")||!nt.has("y"))break;Oe.set(Nt+"X",nt.get("x")),Oe.set(Nt+"Y",nt.get("y"));break;case"scroll":Oe.alt(Nt,It,["up"]);break}},/=/,/\s/),Oe.has("id")){var dt=new(X.vttjs.VTTRegion||X.window.VTTRegion);dt.width=Oe.get("width",100),dt.lines=Oe.get("lines",3),dt.regionAnchorX=Oe.get("regionanchorX",0),dt.regionAnchorY=Oe.get("regionanchorY",100),dt.viewportAnchorX=Oe.get("viewportanchorX",0),dt.viewportAnchorY=Oe.get("viewportanchorY",100),dt.scroll=Oe.get("scroll",""),X.onregion&&X.onregion(dt),X.regionList.push({id:Oe.get("id"),region:dt})}}function be(Ve){var Oe=new ze;_e(Ve,function(dt,Nt){switch(dt){case"MPEGT":Oe.integer(dt+"S",Nt);break;case"LOCA":Oe.set(dt+"L",ve(Nt));break}},/[^\d]:/,/,/),X.ontimestampmap&&X.ontimestampmap({MPEGTS:Oe.get("MPEGTS"),LOCAL:Oe.get("LOCAL")})}function Be(Ve){Ve.match(/X-TIMESTAMP-MAP/)?_e(Ve,function(Oe,dt){switch(Oe){case"X-TIMESTAMP-MAP":be(dt);break}},/=/):_e(Ve,function(Oe,dt){switch(Oe){case"Region":ce(dt);break}},/:/)}try{var Ce;if(X.state==="INITIAL"){if(!/\r\n|\n/.test(X.buffer))return this;Ce=oe();var Le=Ce.match(/^WEBVTT([ \t].*)?$/);if(!Le||!Le[0])throw new We(We.Errors.BadSignature);X.state="HEADER"}for(var Pe=!1;X.buffer;){if(!/\r\n|\n/.test(X.buffer))return this;switch(Pe?Pe=!1:Ce=oe(),X.state){case"HEADER":/:/.test(Ce)?Be(Ce):Ce||(X.state="ID");continue;case"NOTE":Ce||(X.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(Ce)){X.state="NOTE";break}if(!Ce)continue;X.cue=new(X.vttjs.VTTCue||X.window.VTTCue)(0,0,"");try{X.cue.align="center"}catch(Ve){X.cue.align="middle"}if(X.state="CUE",Ce.indexOf("-->")===-1){X.cue.id=Ce;continue}case"CUE":try{we(Ce,X.cue,X.regionList)}catch(Ve){X.reportOrThrowError(Ve),X.cue=null,X.state="BADCUE";continue}X.state="CUETEXT";continue;case"CUETEXT":var De=Ce.indexOf("-->")!==-1;if(!Ce||De&&(Pe=!0)){X.oncue&&X.oncue(X.cue),X.cue=null,X.state="ID";continue}X.cue.text&&(X.cue.text+=`
`),X.cue.text+=Ce.replace(/\u2028/g,`
`).replace(/u2029/g,`
`);continue;case"BADCUE":Ce||(X.state="ID");continue}}}catch(Ve){X.reportOrThrowError(Ve),X.state==="CUETEXT"&&X.cue&&X.oncue&&X.oncue(X.cue),X.cue=null,X.state=X.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){var j=this;try{if(j.buffer+=j.decoder.decode(),(j.cue||j.state==="HEADER")&&(j.buffer+=`

`,j.parse()),j.state==="INITIAL")throw new We(We.Errors.BadSignature)}catch(X){j.reportOrThrowError(X)}return j.onflush&&j.onflush(),this}},Kt.exports=C},22230:function(Kt){var Ut="auto",mt={"":1,lr:1,rl:1},ct={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function ne(ze){if(typeof ze!="string")return!1;var _e=mt[ze.toLowerCase()];return _e?ze.toLowerCase():!1}function We(ze){if(typeof ze!="string")return!1;var _e=ct[ze.toLowerCase()];return _e?ze.toLowerCase():!1}function ve(ze,_e,we){this.hasBeenReset=!1;var ye="",se=!1,te=ze,Y=_e,I=we,A=null,M="",k=!0,V="auto",J="start",F="auto",G="auto",$=100,H="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return ye},set:function(C){ye=""+C}},pauseOnExit:{enumerable:!0,get:function(){return se},set:function(C){se=!!C}},startTime:{enumerable:!0,get:function(){return te},set:function(C){if(typeof C!="number")throw new TypeError("Start time must be set to a number.");te=C,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return Y},set:function(C){if(typeof C!="number")throw new TypeError("End time must be set to a number.");Y=C,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return I},set:function(C){I=""+C,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return A},set:function(C){A=C,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return M},set:function(C){var Q=ne(C);if(Q===!1)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");M=Q,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return k},set:function(C){k=!!C,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return V},set:function(C){if(typeof C!="number"&&C!==Ut)throw new SyntaxError("Line: an invalid number or illegal string was specified.");V=C,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return J},set:function(C){var Q=We(C);Q?(J=Q,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return F},set:function(C){if(C<0||C>100)throw new Error("Position must be between 0 and 100.");F=C,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return G},set:function(C){var Q=We(C);Q?(G=Q,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return $},set:function(C){if(C<0||C>100)throw new Error("Size must be between 0 and 100.");$=C,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return H},set:function(C){var Q=We(C);if(!Q)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");H=Q,this.hasBeenReset=!0}}}),this.displayState=void 0}ve.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},Kt.exports=ve},13710:function(Kt){var Ut={"":!0,up:!0};function mt(We){if(typeof We!="string")return!1;var ve=Ut[We.toLowerCase()];return ve?We.toLowerCase():!1}function ct(We){return typeof We=="number"&&We>=0&&We<=100}function ne(){var We=100,ve=3,ze=0,_e=100,we=0,ye=100,se="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return We},set:function(te){if(!ct(te))throw new Error("Width must be between 0 and 100.");We=te}},lines:{enumerable:!0,get:function(){return ve},set:function(te){if(typeof te!="number")throw new TypeError("Lines must be set to a number.");ve=te}},regionAnchorY:{enumerable:!0,get:function(){return _e},set:function(te){if(!ct(te))throw new Error("RegionAnchorX must be between 0 and 100.");_e=te}},regionAnchorX:{enumerable:!0,get:function(){return ze},set:function(te){if(!ct(te))throw new Error("RegionAnchorY must be between 0 and 100.");ze=te}},viewportAnchorY:{enumerable:!0,get:function(){return ye},set:function(te){if(!ct(te))throw new Error("ViewportAnchorY must be between 0 and 100.");ye=te}},viewportAnchorX:{enumerable:!0,get:function(){return we},set:function(te){if(!ct(te))throw new Error("ViewportAnchorX must be between 0 and 100.");we=te}},scroll:{enumerable:!0,get:function(){return se},set:function(te){var Y=mt(te);Y===!1?console.warn("Scroll: an invalid or illegal string was specified."):se=Y}}})}Kt.exports=ne}}]);
